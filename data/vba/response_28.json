[{"tags": ["vba", "crash", "outlook", "recover"], "comments": [{"owner": {"reputation": 133, "user_id": 4441286, "user_type": "registered", "profile_image": "https://graph.facebook.com/1527633845/picture?type=large", "display_name": "SixSigmaGuy", "link": "https://stackoverflow.com/users/4441286/sixsigmaguy"}, "edited": false, "score": 0, "creation_date": 1437608967, "post_id": 31575899, "comment_id": 51106492, "body": "The full back up was made a day before the Outlook crash."}, {"owner": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "edited": false, "score": 0, "creation_date": 1437610622, "post_id": 31575899, "comment_id": 51106885, "body": "There should be a <b>VbaProject.OTM</b> file in <code>%APPDATA%\\Microsoft\\Outlook</code>, thats where."}], "answers": [{"comments": [{"owner": {"reputation": 133, "user_id": 4441286, "user_type": "registered", "profile_image": "https://graph.facebook.com/1527633845/picture?type=large", "display_name": "SixSigmaGuy", "link": "https://stackoverflow.com/users/4441286/sixsigmaguy"}, "edited": false, "score": 0, "creation_date": 1437613362, "post_id": 31576128, "comment_id": 51107572, "body": "I can&#39;t believe it.  Your answer was right on!!  Thank You! Thank You! Thank You!!!!! :-) :-) :-)  There was one weird thing I wanted to mention.  When I found my old VBAProject.otm, I saw that the file date was from back in 2013.  At first, I thought it couldn&#39;t be my file, so I continued to search with no luck.  Finally, I decided that 2013 was the best I could do, so I copied that file over the new one.  I couldn&#39;t believe my eyes when I opened VBA and saw all my recent code there.  Again, Thank You!!"}, {"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "reply_to_user": {"reputation": 133, "user_id": 4441286, "user_type": "registered", "profile_image": "https://graph.facebook.com/1527633845/picture?type=large", "display_name": "SixSigmaGuy", "link": "https://stackoverflow.com/users/4441286/sixsigmaguy"}, "edited": false, "score": 0, "creation_date": 1437624473, "post_id": 31576128, "comment_id": 51110118, "body": "@SixSigmaGuy remember to accept the answer if it helped you."}], "tags": [], "owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "is_accepted": false, "score": 2, "last_activity_date": 1437610615, "creation_date": 1437610615, "answer_id": 31576128, "question_id": 31575899, "link": "https://stackoverflow.com/questions/31575899/how-can-i-recover-my-outlook-vba-code-after-outlook-crashed-and-i-had-to-reinsta/31576128#31576128", "title": "How can I recover my Outlook VBA code after Outlook crashed and I had to reinstall it?", "body": "<p>VBA code is stored in a file named VBAProject.otm</p>\n\n<p>Search for the new empty VBAProject.otm file. Replace it with the backup version.</p>\n\n<p>Some details here <a href=\"http://www.slipstick.com/developer/how-to-backup-and-save-your-outlook-vba-macros/\" rel=\"nofollow\">http://www.slipstick.com/developer/how-to-backup-and-save-your-outlook-vba-macros/</a></p>\n"}], "owner": {"reputation": 133, "user_id": 4441286, "user_type": "registered", "profile_image": "https://graph.facebook.com/1527633845/picture?type=large", "display_name": "SixSigmaGuy", "link": "https://stackoverflow.com/users/4441286/sixsigmaguy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 868, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1437610615, "creation_date": 1437608899, "question_id": 31575899, "link": "https://stackoverflow.com/questions/31575899/how-can-i-recover-my-outlook-vba-code-after-outlook-crashed-and-i-had-to-reinsta", "title": "How can I recover my Outlook VBA code after Outlook crashed and I had to reinstall it?", "body": "<p>My Outlook crashed and I had to reinstall it.  I had tons of VBA code stored in Outlook and it's all gone.  Fortunately, I made a full backup of my hard drive (from c:).  Is there anyway I can recover my Outlook VBA code from my backup?</p>\n"}, {"tags": ["vba", "email", "outlook", "outlook-2010"], "comments": [{"owner": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "edited": false, "score": 0, "creation_date": 1437610925, "post_id": 31575677, "comment_id": 51106954, "body": "I would use <b>FileSystemObject</b> to retrieve the list of files, add it to an array or ArrayList (.NET), then use it to track which files has been attached, either by count or remove the entry of attached from array."}, {"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "reply_to_user": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "edited": false, "score": 0, "creation_date": 1437612005, "post_id": 31575677, "comment_id": 51107244, "body": "I&#39;m moving the files as I attach them to the msg, I have tried using <code>For I = 1 to 10 loop</code> which works but if i have lest then 10 files left in folder then it gives Error"}, {"owner": {"reputation": 667, "user_id": 4097470, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0e18a78f4c5f640539775e532d78313?s=128&d=identicon&r=PG&f=1", "display_name": "VirtualMichael", "link": "https://stackoverflow.com/users/4097470/virtualmichael"}, "edited": false, "score": 0, "creation_date": 1437615333, "post_id": 31575677, "comment_id": 51107984, "body": "@Omar - Can you post slightly more of your code as you will need to loop outside the actual call to send the email. e.g. What is calling the code you&#39;ve already posted?"}, {"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "reply_to_user": {"reputation": 667, "user_id": 4097470, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0e18a78f4c5f640539775e532d78313?s=128&d=identicon&r=PG&f=1", "display_name": "VirtualMichael", "link": "https://stackoverflow.com/users/4097470/virtualmichael"}, "edited": false, "score": 0, "creation_date": 1437616866, "post_id": 31575677, "comment_id": 51108356, "body": "@VirtualMichael I have added the complete code"}, {"owner": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "edited": false, "score": 0, "creation_date": 1437617969, "post_id": 31575677, "comment_id": 51108646, "body": "How do you invoke this process? The Loop should include CreateItem if you want max of 10 attachments per email. You can do this with VBS."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1437618462, "post_id": 31575677, "comment_id": 51108767, "body": "Add each item to a Collection or Dictionary -- easier usually than implementing an ArrayList object (can be done in VBA as: <code>Dim list as Object: Set list = CreateObject(&quot;System.Collections.ArrayList&quot;)</code>)... ALternatively OP can check the <code>Attachments.Count</code> property and <code>Exit Do</code> in the Loop that does the attaching."}], "answers": [{"comments": [{"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1437618541, "post_id": 31577181, "comment_id": 51108784, "body": "Instead of <code>If (numAttachments &gt;= 10)</code>, why not: <code>If .Attachments.Count &gt;= 10 Then Exit Do</code>?"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 2, "creation_date": 1437618586, "post_id": 31577181, "comment_id": 51108801, "body": "Or, <code>Do While Len(attchFile) &gt; 0 And .Attachments.Count &lt; 10</code> :)  Cheers."}, {"owner": {"reputation": 667, "user_id": 4097470, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0e18a78f4c5f640539775e532d78313?s=128&d=identicon&r=PG&f=1", "display_name": "VirtualMichael", "link": "https://stackoverflow.com/users/4097470/virtualmichael"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 1, "creation_date": 1437618733, "post_id": 31577181, "comment_id": 51108844, "body": "@David Zemens - Indeed, many ways to skin a cat. It was more the basic looping structure I was trying to convey, but +1 for a better loop condition."}, {"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1437619441, "post_id": 31577181, "comment_id": 51108995, "body": "this looks promising, let try and will you know."}], "tags": [], "owner": {"reputation": 667, "user_id": 4097470, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0e18a78f4c5f640539775e532d78313?s=128&d=identicon&r=PG&f=1", "display_name": "VirtualMichael", "link": "https://stackoverflow.com/users/4097470/virtualmichael"}, "is_accepted": true, "score": 2, "last_activity_date": 1437699964, "last_edit_date": 1437699964, "creation_date": 1437618411, "answer_id": 31577181, "question_id": 31575677, "link": "https://stackoverflow.com/questions/31575677/sending-files-via-one-or-more-emails-with-at-most-10-attachments-each/31577181#31577181", "title": "Sending files via one or more emails with at most 10 attachments each", "body": "<p>Try putting the mail creation code within a loop of its own. Get the inner attach loop to abort after adding up to 10 attachments, and the outer loop will abort only once there are no remaining files to add.</p>\n\n<p>The following code modifies your method immediately below the line <code>Set olApp = Outlook.Application</code></p>\n\n<pre><code>attchFile = Dir(attchPath &amp; \"*.*\")\n'// Cancel email if no files to send\nIf Len(attchFile) = 0 Then\n    MsgBox \"There are no reports to attach.\", vbInformation\nElse\n    Do While Len(attchFile) &gt; 0\n\n        '// Create the message.\n        Set olMsg = olApp.CreateItem(olMailItem)\n        With olMsg\n            .Display        '// This line must be retained\n\n            '// Loop to attach files\n            Do While Len(attchFile) &gt; 0 And .Attachments.Count &lt; 10\n                .Attachments.Add attchPath &amp; attchFile\n                sExtension = Right(attchFile, _\n                                     Len(attchFile) - InStrRev(attchFile, Chr(46)))\n\n                '// Check if the file exists and save with unique name\n                oldName = attchFile\n                NewName = FileNameUnique(MovePath, attchFile, sExtension)\n\n                '// Move the files.\n                Name attchPath &amp; oldName As MovePath &amp; NewName\n                '// Look for the next attachment to be added\n                attchFile = Dir(attchPath &amp; \"*.*\")\n            Loop\n\n            '// Add the To recipient(s)\n            Set olRecip = .Recipients.Add(\"Email\")\n            Set olRecip = .Recipients.Add(\"Email\")\n            olRecip.Type = olTo\n\n            '// Add the CC recipient(s)\n            Set olRecip = .Recipients.Add(\"Email\")\n            olRecip.Type = olCC\n\n            '// Set the Subject, Body, and Importance of the message.\n            .Subject = \"Reports - \" &amp; Format(Now, \"Long Date\")\n            .Importance = olImportanceHigh        '// High importance\n            .BodyFormat = olFormatHTML\n\n            '// Edit the message body.\n            Set olInsp = .GetInspector\n            Set wdDoc = olInsp.WordEditor\n\n            '// Set message body (to retain the signature)\n            Set olRng = wdDoc.Range(0, 0)\n\n            '// add the text to message body\n            olRng.Text = \"Attached files has been Completed, Thank you\" &amp; vbCrLf &amp; vbCrLf\n\n            '// Resolve each Recipient's name.\n            For Each olRecip In .Recipients\n                olRecip.Resolve\n                If Not olRecip.Resolve Then\n                    olMsg.Display\n                End If\n            Next\n            '.DeleteAfterSubmit = True\n            .Send\n        End With\n    Loop\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 221, "favorite_count": 0, "accepted_answer_id": 31577181, "answer_count": 1, "score": 0, "last_activity_date": 1593042931, "creation_date": 1437607366, "last_edit_date": 1593042931, "question_id": 31575677, "link": "https://stackoverflow.com/questions/31575677/sending-files-via-one-or-more-emails-with-at-most-10-attachments-each", "title": "Sending files via one or more emails with at most 10 attachments each", "body": "<p>I'm trying to send all files in a folder as email attachments, with at most 10 attachments per message. </p>\n\n<p>So I put together the following macro to attach all files to an email message and send it then move the files, which is working great  </p>\n\n<p>But now that I'm trying to send 10 files per message  then the next 10 files in the folder, repeating until all files are sent.</p>\n\n<p>I have tried several way but did not work.</p>\n\n<p>how do I terminate <strong><code>Do While loop</code></strong> after 10 Attachments and the move the Code to the next statement?</p>\n\n<pre><code>    attchFile = Dir(attchPath &amp; \"*.*\")\n\n    '// Loop to attch\n    Do While Len(attchFile) &gt; 0\n        .Attachments.Add attchPath &amp; attchFile\n        sExtension = Right(attchFile, _\n                             Len(attchFile) - InStrRev(attchFile, Chr(46)))\n\n        '// Check if the file exists and save with unique name\n        oldName = attchFile\n        NewName = FileNameUnique(MovePath, attchFile, sExtension)\n\n        '// Move the files.\n        Name attchPath &amp; oldName As MovePath &amp; NewName\n        attchFile = Dir\n    Loop\n\n    '// Cancell email if no files to send\n    If .Attachments.Count = 0 Then\n        .Close 0\n        .Delete\n    Else\n</code></pre>\n\n<p>If you need complete code, let me know.</p>\n\n<p><strong>Edit</strong> </p>\n\n<p>Here is the complete code.</p>\n\n<pre><code>Option Explicit\nSub SendFiles()\n    Dim olApp As Outlook.Application\n    Dim olMsg As Outlook.MailItem\n    Dim olRecip As Outlook.Recipient\n    Dim attchPath As String\n    Dim MovePath As String\n    Dim olInsp As Outlook.Inspector\n    Dim wdDoc As Object\n    Dim olRng As Object\n    Dim attchFile As String\n    Dim sExtension As String\n    Dim NewName As String\n    Dim oldName As String\n\n    '// Attachments Path.\n    attchPath = \"C:\\Files\\\"\n\n    '// Move Path.\n    MovePath = \"C:\\Completed\\\"\n\n'    On Error GoTo lbl_Exit\n    '// Set Outlook.\n    Set olApp = Outlook.Application\n\n    '// Create the message.\n    Set olMsg = olApp.CreateItem(olMailItem)\n    With olMsg\n        .Display        '// This line must be retained\n\n        attchFile = Dir(attchPath &amp; \"*.*\")\n\n        '// Loop to attch\n        Do While Len(attchFile) &gt; 0\n            .Attachments.Add attchPath &amp; attchFile\n            sExtension = Right(attchFile, _\n                                 Len(attchFile) - InStrRev(attchFile, Chr(46)))\n\n            '// Check if the file exists and save with unique name\n            oldName = attchFile\n            NewName = FileNameUnique(MovePath, attchFile, sExtension)\n\n            '// Move the files.\n            Name attchPath &amp; oldName As MovePath &amp; NewName\n            attchFile = Dir\n        Loop\n\n\n        '// Cancell email if no files to send\n        If .Attachments.Count = 0 Then\n            'MsgBox \"There are no reports to attach.\", vbInformation\n            .Close 0\n            .Delete\n        Else\n\n            '// Add the To recipient(s)\n            Set olRecip = .Recipients.Add(\"Email\")\n            Set olRecip = .Recipients.Add(\"Email\")\n            olRecip.Type = olTo\n\n            '// Add the CC recipient(s)\n            Set olRecip = .Recipients.Add(\"Email\")\n            olRecip.Type = olCC\n\n            '// Set the Subject, Body, and Importance of the message.\n            .Subject = \"Reports - \" &amp; Format(Now, \"Long Date\")\n            .Importance = olImportanceHigh        '// High importance\n            .BodyFormat = olFormatHTML\n\n            '// Edit the message body.\n            Set olInsp = .GetInspector\n            Set wdDoc = olInsp.WordEditor\n\n            '// Set message body (to retain the signature)\n            Set olRng = wdDoc.Range(0, 0)\n\n            '// add the text to message body\n            olRng.text = \"Attached files has been Completed, Thank you\" &amp; vbCrLf &amp; vbCrLf\n\n\n            '// Resolve each Recipient's name.\n            For Each olRecip In .Recipients\n                olRecip.Resolve\n                If Not olRecip.Resolve Then\n                    olMsg.Display\n                End If\n\n            Next\n            '.DeleteAfterSubmit = True\n            .Send '//This line optional\n        End If\n    End With\n\nlbl_Exit:\n\n    Set olMsg = Nothing\n    Set olApp = Nothing\n    Set olInsp = Nothing\n    Set wdDoc = Nothing\n    Set olRng = Nothing\n    Exit Sub\nEnd Sub\n\n'// Check if the file exists\nPrivate Function FileExists(FullName As String) As Boolean\nDim FSO As Object\n    Set FSO = CreateObject(\"Scripting.FileSystemObject\")\n    If FSO.FileExists(FullName) Then\n        FileExists = True\n    Else\n        FileExists = False\n    End If\nlbl_Exit:\n    Exit Function\nEnd Function\n\n'// If the same file name exist in Completed Path folder then add (1)\nPrivate Function FileNameUnique(sPath As String, _\n                               FileName As String, _\n                               sExtension As String) As String\nDim lngF As Long\nDim lngName As Long\n    lngF = 1\n    lngName = Len(FileName) - (Len(sExtension) + 1)\n    FileName = Left(FileName, lngName)\n    Do While FileExists(sPath &amp; FileName &amp; Chr(46) &amp; sExtension) = True\n        FileName = Left(FileName, lngName) &amp; \"(\" &amp; lngF &amp; \")\"\n        lngF = lngF + 1\n    Loop\n    FileNameUnique = FileName &amp; Chr(46) &amp; sExtension\nlbl_Exit:\n    Exit Function\nEnd Function\n</code></pre>\n"}, {"tags": ["database", "vb.net", "ms-access", "visual-studio-2012", "vba"], "comments": [{"owner": {"reputation": 37205, "user_id": 1070452, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/osssV.jpg?s=128&g=1", "display_name": "\u0147\u024fssa P&#248;ngj\u01e3rdenlarp", "link": "https://stackoverflow.com/users/1070452/%c5%87%c9%8fssa-p%c3%b8ngj%c7%a3rdenlarp"}, "edited": false, "score": 2, "creation_date": 1437607699, "post_id": 31575656, "comment_id": 51106174, "body": "a) dont store passwords as plain text, b) use SQL parameters instead of gluing bits of string together  c) dont use a reader to INSERT use ExecuteNonQuery d) Connections and Object should be disposed of e) VB.NET is not vba or access-vba"}, {"owner": {"reputation": 1, "user_id": 5145752, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-DvFDLN1V6kI/AAAAAAAAAAI/AAAAAAAAABM/4aICvRHCl20/photo.jpg?sz=128", "display_name": "iwolverine", "link": "https://stackoverflow.com/users/5145752/iwolverine"}, "reply_to_user": {"reputation": 37205, "user_id": 1070452, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/osssV.jpg?s=128&g=1", "display_name": "\u0147\u024fssa P&#248;ngj\u01e3rdenlarp", "link": "https://stackoverflow.com/users/1070452/%c5%87%c9%8fssa-p%c3%b8ngj%c7%a3rdenlarp"}, "edited": false, "score": 0, "creation_date": 1437608728, "post_id": 31575656, "comment_id": 51106434, "body": "@Plutonix Thanks for your advice, is it possible to post a sample code, it will help me understand, because I am new in this field"}, {"owner": {"reputation": 37205, "user_id": 1070452, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/osssV.jpg?s=128&g=1", "display_name": "\u0147\u024fssa P&#248;ngj\u01e3rdenlarp", "link": "https://stackoverflow.com/users/1070452/%c5%87%c9%8fssa-p%c3%b8ngj%c7%a3rdenlarp"}, "edited": false, "score": 0, "creation_date": 1437609114, "post_id": 31575656, "comment_id": 51106536, "body": "The answer to the question you didnt ask has some <a href=\"https://msdn.microsoft.com/en-us/library/system.data.oledb.oledbcommand.executenonquery(v=vs.110).aspx\" rel=\"nofollow noreferrer\">sample code here</a>...the other things were just being helpful...except for parameters, that&#39;s pretty important on several levels"}], "owner": {"reputation": 1, "user_id": 5145752, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-DvFDLN1V6kI/AAAAAAAAAAI/AAAAAAAAABM/4aICvRHCl20/photo.jpg?sz=128", "display_name": "iwolverine", "link": "https://stackoverflow.com/users/5145752/iwolverine"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 3071, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1594644071, "creation_date": 1437607272, "last_edit_date": 1594644071, "question_id": 31575656, "link": "https://stackoverflow.com/questions/31575656/visual-basic-database-and-registration-form", "title": "Visual Basic Database and registration form", "body": "<p>This is my first time doing VB. I have successfully created the login form, but I am having issues with the User Registration. The moment I  click register, it gives me error that Database connection Failed and cannot INSERT INTO Registration. Please help. \nThanks in advance </p>\n\n<pre><code>If rtxtpassword.Text = \"\" Or rtxtusername.Text = \"\" Or rtxtfname.Text = \"\" Or rtxtlname.Text = \"\" Then\n            MessageBox.Show(\"Please complete the required fields..\", \"Authentication Error\", MessageBoxButtons.OK, MessageBoxIcon.Error)\n        Else\n        End If\n\n        ' Connect to DB\n        Dim conn As New System.Data.OleDb.OleDbConnection()\n        conn.ConnectionString = \"Provider=Microsoft.ACE.OLEDB.12.0;Data Source=C:\\Users\\logan_000\\documents\\visual studio 2013\\Projects\\Point Of Sale Application\\Point Of Sale Application\\database.accdb\"\n\n        Try\n            'Dim sql As String = \"INSERT INTO Registration WHERE username='\" &amp; rtxtusername.Text &amp; \"' AND Password = '\" &amp; rtxtpassword.Text &amp; rtxtfname.Text &amp; \"' AND Fname = '\" &amp; rtxtlname.Text &amp; \"' AND Lname =  '\"\n            Dim sql As String = \"INSERT INTO Registration (username, Password, Fname, Lname) VALUES (\" &amp; rtxtusername.Text &amp; \", \" &amp; rtxtpassword.Text &amp; \", \" &amp; rtxtfname.Text &amp; \", \" &amp; rtxtlname.Text &amp; \")\"\n            'Dim sql As String = \"INSERT INTO Registration (username, Password, Fname, Lname) VALUES('\" &amp; rtxtusername.Text &amp; \"',\" &amp; \"'\" &amp; rtxtpassword.Text &amp; \"',\"\n            Dim sqlCom As New System.Data.OleDb.OleDbCommand(Sql)\n\n            'Open Database Connection\n            sqlCom.Connection = conn\n            conn.Open()\n            Dim sqlRead As System.Data.OleDb.OleDbDataReader = sqlCom.ExecuteReader()\n\n            If sqlRead.Read() Then\n                Form1.Show()\n                'Me.Hide()\n                Me.Close()\n            Else\n                ' If user enter wrong username and password combination\n                ' Throw an error message\n                MessageBox.Show(\"Registration Failed..\", \"Authentication Failure\", MessageBoxButtons.OK, MessageBoxIcon.Exclamation)\n\n                'Clear all fields\n                rtxtusername.Text = \"\"\n                rtxtfname.Text = \"\"\n                rtxtlname.Text = \"\"\n                rtxtpassword.Text = \"\"\n\n                'Focus on Username field\n                rtxtusername.Focus()\n            End If\n            'Connection failure Dialog box\n        Catch ex As Exception\n            MessageBox.Show(\"Failed to connect to Database.. System Error Message:  \" &amp; ex.Message, \"Database Connection Error\", MessageBoxButtons.OK, MessageBoxIcon.Error)\n\n        End Try\n\n    End Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "printing"], "answers": [{"comments": [{"owner": {"reputation": 12931, "user_id": 436976, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/ca5523dd495f8c0a6a6b20db65db2ef4?s=128&d=identicon&r=PG", "display_name": "stevendesu", "link": "https://stackoverflow.com/users/436976/stevendesu"}, "edited": false, "score": 1, "creation_date": 1437662487, "post_id": 31576002, "comment_id": 51133071, "body": "This did not work. It returned &quot;Printer-A on 192.168.0.6&quot;"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 12931, "user_id": 436976, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/ca5523dd495f8c0a6a6b20db65db2ef4?s=128&d=identicon&r=PG", "display_name": "stevendesu", "link": "https://stackoverflow.com/users/436976/stevendesu"}, "edited": false, "score": 0, "creation_date": 1437671789, "post_id": 31576002, "comment_id": 51139878, "body": "That would seem to solve your problem as Ne02 or Ne07 might change from machine to machine but the network printer&#39;s LAN IP address is not going to change. I always used to set my network printer&#39;s IPs by MAC so DHCP didn&#39;t throw them a new one."}, {"owner": {"reputation": 12931, "user_id": 436976, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/ca5523dd495f8c0a6a6b20db65db2ef4?s=128&d=identicon&r=PG", "display_name": "stevendesu", "link": "https://stackoverflow.com/users/436976/stevendesu"}, "edited": false, "score": 0, "creation_date": 1439348183, "post_id": 31576002, "comment_id": 51819495, "body": "Trying to use &quot;Printer-A on 192.168.0.6&quot; in <code>ActivePrinter = ...</code> throws an error for me"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 0, "last_activity_date": 1437609533, "creation_date": 1437609533, "answer_id": 31576002, "question_id": 31575572, "link": "https://stackoverflow.com/questions/31575572/trouble-listing-printers-with-excel-vba/31576002#31576002", "title": "Trouble listing printers with Excel VBA", "body": "<p>The connection is the first part of the enumeration. Essentially <code>.Item(i + 1) &amp; \" on ' &amp; .Item(i)</code>. In your code this would be,</p>\n\n<pre><code>fullName = nwo.EnumPrinterConnections(i * 2 + 1) &amp; \" on \" &amp; nwo.EnumPrinterConnections(i * 2)\n</code></pre>\n\n<p>You will have to fill a list of the similar printers; currently, you are only returning the last match.</p>\n"}, {"comments": [{"owner": {"reputation": 12931, "user_id": 436976, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/ca5523dd495f8c0a6a6b20db65db2ef4?s=128&d=identicon&r=PG", "display_name": "stevendesu", "link": "https://stackoverflow.com/users/436976/stevendesu"}, "edited": false, "score": 0, "creation_date": 1437662573, "post_id": 31576217, "comment_id": 51133168, "body": "This worked! Although I&#39;m not 100% sure how. Whenever I tried copying code with the <code>Private Declare</code> syntax before I got a string of errors. I&#39;ll try this out on a few other computers and make sure I can get the printers working everywhere."}, {"owner": {"reputation": 106, "user_id": 5135721, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-g79q4RQxFOM/AAAAAAAAAAI/AAAAAAAABSk/LMMhL9NMT0M/photo.jpg?sz=128", "display_name": "n0v1c3", "link": "https://stackoverflow.com/users/5135721/n0v1c3"}, "reply_to_user": {"reputation": 12931, "user_id": 436976, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/ca5523dd495f8c0a6a6b20db65db2ef4?s=128&d=identicon&r=PG", "display_name": "stevendesu", "link": "https://stackoverflow.com/users/436976/stevendesu"}, "edited": false, "score": 0, "creation_date": 1437673818, "post_id": 31576217, "comment_id": 51141021, "body": "This is using the registry in Windows. I am pretty sure it will only work on a windows based OS although, I would like to hear otherwise."}, {"owner": {"reputation": 12931, "user_id": 436976, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/ca5523dd495f8c0a6a6b20db65db2ef4?s=128&d=identicon&r=PG", "display_name": "stevendesu", "link": "https://stackoverflow.com/users/436976/stevendesu"}, "edited": false, "score": 0, "creation_date": 1437749745, "post_id": 31576217, "comment_id": 51176980, "body": "It worked on every computer in my house, however when I sent it to the client to try on the actual computers it failed giving an error when trying to call method <code>Application.ActivePrinter</code> (e.g. - the printer name was invalid). Since it worked for me I&#39;m still marking this as correct, as I feel any issues he is having now are either configuration problems or user error."}, {"owner": {"reputation": 106, "user_id": 5135721, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-g79q4RQxFOM/AAAAAAAAAAI/AAAAAAAABSk/LMMhL9NMT0M/photo.jpg?sz=128", "display_name": "n0v1c3", "link": "https://stackoverflow.com/users/5135721/n0v1c3"}, "reply_to_user": {"reputation": 12931, "user_id": 436976, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/ca5523dd495f8c0a6a6b20db65db2ef4?s=128&d=identicon&r=PG", "display_name": "stevendesu", "link": "https://stackoverflow.com/users/436976/stevendesu"}, "edited": false, "score": 0, "creation_date": 1437755950, "post_id": 31576217, "comment_id": 51180788, "body": "@stevendesu I am guessing that your client does not have the name of the printer set correctly (I don&#39;t know how you are getting the name in the first place).  You could always modify the code above to make a list of printers from your client so that you can adjust the name accordingly. Otherwise, you could come up with a way that they can run one script (or an error handler) to set the printer names that the client want to use, and after selected, only those printers will be used in your script. Also, check what OS they are running on. We many need a different solution for full cross platform"}], "tags": [], "owner": {"reputation": 106, "user_id": 5135721, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-g79q4RQxFOM/AAAAAAAAAAI/AAAAAAAABSk/LMMhL9NMT0M/photo.jpg?sz=128", "display_name": "n0v1c3", "link": "https://stackoverflow.com/users/5135721/n0v1c3"}, "is_accepted": true, "score": 2, "last_activity_date": 1437612507, "last_edit_date": 1437612507, "creation_date": 1437611290, "answer_id": 31576217, "question_id": 31575572, "link": "https://stackoverflow.com/questions/31575572/trouble-listing-printers-with-excel-vba/31576217#31576217", "title": "Trouble listing printers with Excel VBA", "body": "<p>Run the Test sub at the bottom:</p>\n\n<pre><code>Option Explicit\nPrivate Const HKEY_CURRENT_USER As Long = &amp;H80000001\nPrivate Const HKCU = HKEY_CURRENT_USER\nPrivate Const KEY_QUERY_VALUE = &amp;H1&amp;\nPrivate Const ERROR_NO_MORE_ITEMS = 259&amp;\nPrivate Const ERROR_MORE_DATA = 234\n\nPrivate Declare Function RegOpenKeyEx Lib \"advapi32\" _\n    Alias \"RegOpenKeyExA\" ( _\n    ByVal HKey As Long, _\n    ByVal lpSubKey As String, _\n    ByVal ulOptions As Long, _\n    ByVal samDesired As Long, _\n    phkResult As Long) As Long\n\nPrivate Declare Function RegEnumValue Lib \"advapi32.dll\" _\n    Alias \"RegEnumValueA\" ( _\n    ByVal HKey As Long, _\n    ByVal dwIndex As Long, _\n    ByVal lpValueName As String, _\n    lpcbValueName As Long, _\n    ByVal lpReserved As Long, _\n    lpType As Long, _\n    lpData As Byte, _\n    lpcbData As Long) As Long\n\nPrivate Declare Function RegCloseKey Lib \"advapi32.dll\" ( _\n    ByVal HKey As Long) As Long\n\nPublic Function GetPrinterFullNames() As String()\nDim Printers() As String ' array of names to be returned\nDim PNdx As Long    ' index into Printers()\nDim HKey As Long    ' registry key handle\nDim Res As Long     ' result of API calls\nDim Ndx As Long     ' index for RegEnumValue\nDim ValueName As String ' name of each value in the printer key\nDim ValueNameLen As Long    ' length of ValueName\nDim DataType As Long        ' registry value data type\nDim ValueValue() As Byte    ' byte array of registry value value\nDim ValueValueS As String   ' ValueValue converted to String\nDim CommaPos As Long        ' position of comma character in ValueValue\nDim ColonPos As Long        ' position of colon character in ValueValue\nDim M As Long               ' string index\n\n' registry key in HCKU listing printers\nConst PRINTER_KEY = \"Software\\Microsoft\\Windows NT\\CurrentVersion\\Devices\"\n\nPNdx = 0\nNdx = 0\n' assume printer name is less than 256 characters\nValueName = String$(256, Chr(0))\nValueNameLen = 255\n' assume the port name is less than 1000 characters\nReDim ValueValue(0 To 999)\n' assume there are less than 1000 printers installed\nReDim Printers(1 To 1000)\n\n' open the key whose values enumerate installed printers\nRes = RegOpenKeyEx(HKCU, PRINTER_KEY, 0&amp;, _\n    KEY_QUERY_VALUE, HKey)\n' start enumeration loop of printers\nRes = RegEnumValue(HKey, Ndx, ValueName, _\n    ValueNameLen, 0&amp;, DataType, ValueValue(0), 1000)\n' loop until all values have been enumerated\nDo Until Res = ERROR_NO_MORE_ITEMS\n    M = InStr(1, ValueName, Chr(0))\n    If M &gt; 1 Then\n        ' clean up the ValueName\n        ValueName = Left(ValueName, M - 1)\n    End If\n    ' find position of a comma and colon in the port name\n    CommaPos = InStr(1, ValueValue, \",\")\n    ColonPos = InStr(1, ValueValue, \":\")\n    ' ValueValue byte array to ValueValueS string\n    On Error Resume Next\n    ValueValueS = Mid(ValueValue, CommaPos + 1, ColonPos - CommaPos)\n    On Error GoTo 0\n    ' next slot in Printers\n    PNdx = PNdx + 1\n    Printers(PNdx) = ValueName &amp; \" on \" &amp; ValueValueS\n    ' reset some variables\n    ValueName = String(255, Chr(0))\n    ValueNameLen = 255\n    ReDim ValueValue(0 To 999)\n    ValueValueS = vbNullString\n    ' tell RegEnumValue to get the next registry value\n    Ndx = Ndx + 1\n    ' get the next printer\n    Res = RegEnumValue(HKey, Ndx, ValueName, ValueNameLen, _\n        0&amp;, DataType, ValueValue(0), 1000)\n    ' test for error\n    If (Res &lt;&gt; 0) And (Res &lt;&gt; ERROR_MORE_DATA) Then\n        Exit Do\n    End If\nLoop\n' shrink Printers down to used size\nReDim Preserve Printers(1 To PNdx)\nRes = RegCloseKey(HKey)\n' Return the result array\nGetPrinterFullNames = Printers\nEnd Function\n\nSub Test()\n    Dim Printers() As String\n    Dim N As Long\n    Dim S As String\n    Printers = GetPrinterFullNames()\n    For N = LBound(Printers) To UBound(Printers)\n        S = S &amp; Printers(N) &amp; vbNewLine\n    Next N\n    MsgBox S, vbOKOnly, \"Printers\"\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 12931, "user_id": 436976, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/ca5523dd495f8c0a6a6b20db65db2ef4?s=128&d=identicon&r=PG", "display_name": "stevendesu", "link": "https://stackoverflow.com/users/436976/stevendesu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6370, "favorite_count": 1, "accepted_answer_id": 31576217, "answer_count": 2, "score": 4, "last_activity_date": 1437612507, "creation_date": 1437606714, "question_id": 31575572, "link": "https://stackoverflow.com/questions/31575572/trouble-listing-printers-with-excel-vba", "title": "Trouble listing printers with Excel VBA", "body": "<p>So here's the original problem:</p>\n\n<p>I have an Excel file with a button that runs a macro. This macro needs to print the sheet to 2 separate network printers. The workbook will be run on multiple different computers on the network.</p>\n\n<p>My current code looks like so:</p>\n\n<pre><code>Application.ActivePrinter = \"Printer-A on Ne02:\"\nActiveWindow.SelectedSheets.PrintOut Copies:=1, Collate:=True, IgnorePrintAreas:=False\nApplication.ActivePrinter = \"Printer-B on Ne05:\"\nActiveWindow.SelectedSheets.PrintOut Copies:=1, Collate:=True, IgnorePrintAreas:=False\n</code></pre>\n\n<p>The problem lies with the <code>on Ne02:</code> and <code>on Ne05:</code>. These values differ from one computer to another. E.g.:</p>\n\n<ul>\n<li>Printer-A on Ne03:</li>\n<li>Printer-B on Ne02:</li>\n<li>Printer-A on Ne07:</li>\n<li>etc</li>\n</ul>\n\n<p>I can circumvent the issue by displaying the \"select a printer\" dialog and forcing users to choose the printer manually, but I would prefer for this to be automatic.</p>\n\n<p>I have tried using the Windows Script Host Object Model to list all of the printers like so:</p>\n\n<pre><code>Function FindPrinter(name As String)\n    Dim nwo As New WshNetwork\n    Dim i As Integer\n    Dim fullName As String\n\n    For i = 0 To (nwo.EnumPrinterConnections.Count / 2) - 1\n        If InStr(nwo.EnumPrinterConnections(i * 2 + 1), name) &gt; 0 Then\n            fullName = nwo.EnumPrinterConnections(i * 2 + 1)\n        End If\n    Next i\n\n    ' Returns the LAST printer that matches\n    FindPrinter = fullName\nEnd Function\n\nSub MyMacro()\n    ActivePrinter = FindPrinter(\"Printer-A\")\nEnd Sub\n</code></pre>\n\n<p>However this fails. If I look at the output of <code>FindPrinter</code>, it's only returning the string \"Printer-A\" without the \"on Ne02:\"</p>\n\n<p>How can I get a full list of printers installed, including this \"on NeXX:\" bit? Or, alternatively, how can I set a printer as active knowing only its name?</p>\n"}, {"tags": ["csv", "ms-access", "vba"], "comments": [{"owner": {"reputation": 4109, "user_id": 4077205, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa824cf184d59d187862336dbae09183?s=128&d=identicon&r=PG&f=1", "display_name": "Clayton Wilkinson", "link": "https://stackoverflow.com/users/4077205/clayton-wilkinson"}, "edited": false, "score": 0, "creation_date": 1437608483, "post_id": 31575554, "comment_id": 51106380, "body": "Probably should add the Access or VBA tag since your question is application specific."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 5145713, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81fc877df359fdd2badbcb27283335cd?s=128&d=identicon&r=PG&f=1", "display_name": "CRogel", "link": "https://stackoverflow.com/users/5145713/crogel"}, "edited": false, "score": 0, "creation_date": 1437704900, "post_id": 31597762, "comment_id": 51153718, "body": "Thanks for the help. I&#39;m trying to create a new database for our fuel system. The fuel system creates a report in only doc, excel and csv. With the current database, they get the doc report and enter all the fields manually. It becomes a pain since there are at times hundreds of transactions. The csv is created by the fuel system. The database has to be updated weekly. Both the doc and excel files are generated like in a gas receipt format."}, {"owner": {"reputation": 1, "user_id": 5145713, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81fc877df359fdd2badbcb27283335cd?s=128&d=identicon&r=PG&f=1", "display_name": "CRogel", "link": "https://stackoverflow.com/users/5145713/crogel"}, "edited": false, "score": 0, "creation_date": 1437704908, "post_id": 31597762, "comment_id": 51153721, "body": "I was looking at the csv file and I see that the first line is the title of the company along with the date query. The second line is the tittles of the things queried (like gas qty, user, date) and the third line are the actual things queried this would be the information i need for the database."}, {"owner": {"reputation": 870, "user_id": 5053667, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/K5A4V.jpg?s=128&g=1", "display_name": "Darren H", "link": "https://stackoverflow.com/users/5053667/darren-h"}, "reply_to_user": {"reputation": 1, "user_id": 5145713, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81fc877df359fdd2badbcb27283335cd?s=128&d=identicon&r=PG&f=1", "display_name": "CRogel", "link": "https://stackoverflow.com/users/5145713/crogel"}, "edited": false, "score": 0, "creation_date": 1437714955, "post_id": 31597762, "comment_id": 51156100, "body": "Sounds like whatever software that controls the output from the fuel system is lying to you about creating a valid CSV. Speak to whoever works with that to modify the output so it is valid. Alternavively write a bit of code that will modify the CSV prior to import. Although I could do this, it opens up a far bigger topic of modules and VBA coding which would require a lot more learning on your part to implement"}], "tags": [], "owner": {"reputation": 870, "user_id": 5053667, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/K5A4V.jpg?s=128&g=1", "display_name": "Darren H", "link": "https://stackoverflow.com/users/5053667/darren-h"}, "is_accepted": false, "score": 0, "last_activity_date": 1437684520, "creation_date": 1437684520, "answer_id": 31597762, "question_id": 31575554, "link": "https://stackoverflow.com/questions/31575554/access-import-csv-file/31597762#31597762", "title": "Access Import CSV file", "body": "<p>Not aware of any way of doing that within access. However CSV is a very specific format and the way yours is laid out is incorrect according to CSV standards. It should be a single record to a line.</p>\n\n<p>Use an advanced text editor such as Sublime or Notepad++ to edit the CSV file such that each newline character actually represents the end of a record.</p>\n"}], "owner": {"reputation": 1, "user_id": 5145713, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81fc877df359fdd2badbcb27283335cd?s=128&d=identicon&r=PG&f=1", "display_name": "CRogel", "link": "https://stackoverflow.com/users/5145713/crogel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 153, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1594644046, "creation_date": 1437606643, "last_edit_date": 1594644046, "question_id": 31575554, "link": "https://stackoverflow.com/questions/31575554/access-import-csv-file", "title": "Access Import CSV file", "body": "<p>I'm trying to import a CSV file into Access. However the way the CSV file is formatted, it creates three lines for the same transaction. Is it possible to tell Access that every three lines belong to the same transaction when creating or appending the table? VBA is fine, if that's the only way possible.</p>\n\n<p>Currently during the import for one transaction, Access creates 8 fields for the first line, 29 fields for the second line, and 8 more for the third line. I would either prefer having the 48 fields for the one transaction or telling access I only need certain fields.  For example, I need only field 2 of the first line, field 11 of the second line and field3 of the third line for each transaction. </p>\n\n<p>Thanks in advance for your help. </p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1437612274, "post_id": 31575540, "comment_id": 51107342, "body": "What errors are you getting?"}], "answers": [{"tags": [], "owner": {"reputation": 106, "user_id": 5135721, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-g79q4RQxFOM/AAAAAAAAAAI/AAAAAAAABSk/LMMhL9NMT0M/photo.jpg?sz=128", "display_name": "n0v1c3", "link": "https://stackoverflow.com/users/5135721/n0v1c3"}, "is_accepted": true, "score": 1, "last_activity_date": 1437616193, "last_edit_date": 1437616193, "creation_date": 1437615794, "answer_id": 31576832, "question_id": 31575540, "link": "https://stackoverflow.com/questions/31575540/how-to-pass-variable-to-pivot-table-parameter/31576832#31576832", "title": "How to pass variable to pivot table parameter?", "body": "<p>Is it a typo? (PivoJtFields). And make sure you are on the sheet with the pivot table and the table has the correct Name.</p>\n\n<p>Try</p>\n\n<pre><code>x = \"*\" + Range(\"Sheet1!h17\").Value + \"*\"\n\nDim PT As PivotTable\nSet PT = ActiveSheet.PivotTables(\"PivotTable2\")\n\nDim PT_PivotFieldNote As PivotField\nSet PT_PivotFieldNote = PT.PivotFields(\"Note\")\n\nPT_PivotFieldNote.ClearAllFilters\nPT_PivotFieldNote.PivotFilters.Add xlCaptionContains, Value1:=x\n</code></pre>\n"}], "owner": {"reputation": 501, "user_id": 4810090, "user_type": "registered", "accept_rate": 91, "profile_image": "https://graph.facebook.com/10153086352247107/picture?type=large", "display_name": "Jimmyn", "link": "https://stackoverflow.com/users/4810090/jimmyn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1842, "favorite_count": 0, "accepted_answer_id": 31576832, "answer_count": 1, "score": 0, "last_activity_date": 1577260638, "creation_date": 1437606586, "last_edit_date": 1577260638, "question_id": 31575540, "link": "https://stackoverflow.com/questions/31575540/how-to-pass-variable-to-pivot-table-parameter", "title": "How to pass variable to pivot table parameter?", "body": "<p>I want to pass a variable into a value filter for a pivot table.</p>\n\n<p>The code gives me errors.</p>\n\n<p>I'm trying to put the x variable into Value1.</p>\n\n<pre><code>Sub Macro1()\n'\n' Macro1 Macro\n'\nx = \"*\" + Range(\"Sheet1!h17\").Value + \"*\"\n\nActiveSheet.PivotTables(\"PivotTable2\").PivoJtFields(\"Note\").ClearAllFilters\nActiveSheet.PivotTables(\"PivotTable2\").PivotFields(\"Note\").PivotFilters.Add _\n  Type:=xlCaptionContains, Value1:=x\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "ms-access", "vba"], "answers": [{"tags": [], "owner": {"reputation": 1187, "user_id": 651740, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e49d25a5b1991c87d2a194c220de1b00?s=128&d=identicon&r=PG", "display_name": "Marc Johnston", "link": "https://stackoverflow.com/users/651740/marc-johnston"}, "is_accepted": false, "score": 0, "last_activity_date": 1437605867, "creation_date": 1437605867, "answer_id": 31575439, "question_id": 31575414, "link": "https://stackoverflow.com/questions/31575414/access-vba-date-function-not-working/31575439#31575439", "title": "Access VBA: Date function not working", "body": "<p>Date is a data type ... use the Now method</p>\n"}, {"comments": [{"owner": {"reputation": 4915, "user_id": 4564432, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/1012918142059352/picture?type=large", "display_name": "Carl", "link": "https://stackoverflow.com/users/4564432/carl"}, "edited": false, "score": 1, "creation_date": 1437606207, "post_id": 31575467, "comment_id": 51105798, "body": "Thank you this worked perfectly. I don&#39;t understand why my code worked before, but I&#39;m glad it works now"}, {"owner": {"reputation": 565, "user_id": 2367343, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/539270c8b6403e30b716df29dfdca450?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Grinder", "link": "https://stackoverflow.com/users/2367343/andrew-grinder"}, "reply_to_user": {"reputation": 4915, "user_id": 4564432, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/1012918142059352/picture?type=large", "display_name": "Carl", "link": "https://stackoverflow.com/users/4564432/carl"}, "edited": false, "score": 0, "creation_date": 1475820814, "post_id": 31575467, "comment_id": 67105688, "body": "@Carl, there must have been an issue with some VBA library over written by another library with the same function calls. eg. Date, Without specifying VBA.Date, code could be compromised."}], "tags": [], "owner": {"reputation": 3740, "user_id": 3064741, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3d1eaeba1b98ecb9d37ccb68c69aec0?s=128&d=identicon&r=PG&f=1", "display_name": "mielk", "link": "https://stackoverflow.com/users/3064741/mielk"}, "is_accepted": true, "score": 6, "last_activity_date": 1437606073, "creation_date": 1437606073, "answer_id": 31575467, "question_id": 31575414, "link": "https://stackoverflow.com/questions/31575414/access-vba-date-function-not-working/31575467#31575467", "title": "Access VBA: Date function not working", "body": "<p>Try this:</p>\n\n<pre><code>MsgBox VBA.Date\n</code></pre>\n\n<p>It should point Access to the VBA built-in function instead of some field called DATE.</p>\n"}], "owner": {"reputation": 4915, "user_id": 4564432, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/1012918142059352/picture?type=large", "display_name": "Carl", "link": "https://stackoverflow.com/users/4564432/carl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3426, "favorite_count": 0, "accepted_answer_id": 31575467, "answer_count": 2, "score": 1, "last_activity_date": 1437606073, "creation_date": 1437605722, "last_edit_date": 1531164843, "question_id": 31575414, "link": "https://stackoverflow.com/questions/31575414/access-vba-date-function-not-working", "title": "Access VBA: Date function not working", "body": "<p>I have a button on a form that displays the current date. Very simple code:</p>\n\n<pre><code>MsgBox DATE\n</code></pre>\n\n<p>This worked for several months, but after some seemingly unrelated changes this stopped working and I get the error: run-time error '2465': Can't find the field \"DATE' referred to in your expression.</p>\n\n<p>Clearly, Access stopped recognizing DATE as a function, and is trying to find it as an object that doesn't exist. DATE() is immediately replaced by DATE by Access in the VBA code.</p>\n\n<p>None of the objects in the form are named Date and none of the fields in the control source table have the name Date so I don't know why Access is confused.</p>\n\n<p>When I create a new form with a button and the same code it works. Any ideas?</p>\n"}, {"tags": ["ms-access", "vba"], "answers": [{"comments": [{"owner": {"reputation": 99, "user_id": 2850838, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/0923095d289c0c5397b134ff449d486d?s=128&d=identicon&r=PG&f=1", "display_name": "knt5784", "link": "https://stackoverflow.com/users/2850838/knt5784"}, "edited": false, "score": 0, "creation_date": 1437669951, "post_id": 31577581, "comment_id": 51138723, "body": "yeah, I tried to print report as documents but I don&#39;t know enough methods in Access VBA to print 1 page of the report at a time. It always print everything in 1 document. That&#39;s why I want to know what methods are available to do what I want to do."}, {"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "reply_to_user": {"reputation": 99, "user_id": 2850838, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/0923095d289c0c5397b134ff449d486d?s=128&d=identicon&r=PG&f=1", "display_name": "knt5784", "link": "https://stackoverflow.com/users/2850838/knt5784"}, "edited": false, "score": 0, "creation_date": 1437699349, "post_id": 31577581, "comment_id": 51152414, "body": "You can filter the report just like you are doing with this form to a particular record. See <a href=\"https://msdn.microsoft.com/en-us/library/office/ff192676.aspx\" rel=\"nofollow noreferrer\">OpenReport method</a>."}, {"owner": {"reputation": 99, "user_id": 2850838, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/0923095d289c0c5397b134ff449d486d?s=128&d=identicon&r=PG&f=1", "display_name": "knt5784", "link": "https://stackoverflow.com/users/2850838/knt5784"}, "edited": false, "score": 0, "creation_date": 1437744962, "post_id": 31577581, "comment_id": 51173497, "body": "yeah, that&#39;s what I did. It just prints out the whole report. I think because I set up the report source to be the table instead of a record. How can I set up the source from a single record instead of the whole table?"}, {"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "reply_to_user": {"reputation": 99, "user_id": 2850838, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/0923095d289c0c5397b134ff449d486d?s=128&d=identicon&r=PG&f=1", "display_name": "knt5784", "link": "https://stackoverflow.com/users/2850838/knt5784"}, "edited": false, "score": 0, "creation_date": 1437769567, "post_id": 31577581, "comment_id": 51187763, "body": "What did you put as your filter? Condition it to return one record at a time like using a primary id or as in this form example with <code>invoiceNumber</code>."}, {"owner": {"reputation": 99, "user_id": 2850838, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/0923095d289c0c5397b134ff449d486d?s=128&d=identicon&r=PG&f=1", "display_name": "knt5784", "link": "https://stackoverflow.com/users/2850838/knt5784"}, "edited": false, "score": 0, "creation_date": 1437875947, "post_id": 31577581, "comment_id": 51212758, "body": "&quot;InvoiceNumber=&quot; &amp; tableName!invoiceNumber"}, {"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "reply_to_user": {"reputation": 99, "user_id": 2850838, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/0923095d289c0c5397b134ff449d486d?s=128&d=identicon&r=PG&f=1", "display_name": "knt5784", "link": "https://stackoverflow.com/users/2850838/knt5784"}, "edited": false, "score": 0, "creation_date": 1437913338, "post_id": 31577581, "comment_id": 51220316, "body": "Several records may be lumped under a particular <code>InvoiceNumber</code>. Consider filtering by primary key or use report grouping that breaks by pages."}], "tags": [], "owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "is_accepted": false, "score": 0, "last_activity_date": 1437621347, "creation_date": 1437621347, "answer_id": 31577581, "question_id": 31575237, "link": "https://stackoverflow.com/questions/31575237/locating-a-record-in-a-table/31577581#31577581", "title": "Locating a record in a table", "body": "<p>First, sort your recordset query by invoice number using the order by clause in the SQL string: <code>ORDER BY invoiceNumber</code></p>\n\n<p>Second, you can use the <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/ms677527%28v=vs.85%29.aspx\" rel=\"nofollow\">MoveLast and MoveFirst</a> methods, just before the loop:</p>\n\n<pre><code>rs.MoveLast\nrs.MoveFirst\n\nSet rs = CurrentDb.OpenRecordset(fileName)\n\n    Do While Not rs.EOF\n    ...\n</code></pre>\n\n<p>Aside, refrain from saving forms as documents. Due to Access Reports print setting, margin, and page structure, they are better objects for any document end use including PDF output. </p>\n"}], "owner": {"reputation": 99, "user_id": 2850838, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/0923095d289c0c5397b134ff449d486d?s=128&d=identicon&r=PG&f=1", "display_name": "knt5784", "link": "https://stackoverflow.com/users/2850838/knt5784"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 28, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1437621347, "creation_date": 1437604617, "question_id": 31575237, "link": "https://stackoverflow.com/questions/31575237/locating-a-record-in-a-table", "title": "Locating a record in a table", "body": "<p>This is written in Access. I have this sub. This is meant to go through a recordset and print out individual pages, individually named based on the invoice number:</p>\n\n<pre><code>Sub printPdfPages(formName As String, fileName As String)\n''print each record into a separate pdf file, named according to invoice number\n\n    Dim rs As DAO.Recordset\n    Dim whereCondition As String\n    Dim saveName As String\n\n    Set rs = CurrentDb.OpenRecordset(fileName)   ''can also pass SQL in as a String\n    Do While Not rs.EOF\n\n       saveName = rs!invoiceNumber &amp; \".pdf\"\n       whereCondition = \"[invoiceNumber]=\" &amp; rs!invoiceNumber\n       '' MsgBox whereCondition\n\n\n       DoCmd.OpenForm formName, acNormal, , whereCondition\n       DoCmd.OutputTo acOutputForm, formName, acFormatPDF, saveName, False, \"\", , acExportQualityPrint\n       rs.MoveNext\n    Loop\n\n    DoCmd.Close acForm, formName\n    rs.Close\n    Set rs = Nothing\nEnd Sub\n</code></pre>\n\n<p>Now I want to modify it so that it will take in a beginning invoice number and an end invoice number.\nThen go to the record of the beginning invoice and print anything between beginning and end.</p>\n\n<p>How can I do that and what method should I use? Any idea?</p>\n"}, {"tags": ["arrays", "vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 4765416, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wndqr.gif?s=128&g=1", "display_name": "Reged", "link": "https://stackoverflow.com/users/4765416/reged"}, "edited": false, "score": 0, "creation_date": 1437641015, "post_id": 31575412, "comment_id": 51117568, "body": "That worked, thank you. Don&#39;t really understand why though."}, {"owner": {"reputation": 3740, "user_id": 3064741, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3d1eaeba1b98ecb9d37ccb68c69aec0?s=128&d=identicon&r=PG&f=1", "display_name": "mielk", "link": "https://stackoverflow.com/users/3064741/mielk"}, "edited": false, "score": 0, "creation_date": 1437641632, "post_id": 31575412, "comment_id": 51117977, "body": "1D arrays are interpreted by VBA as arrays with one row and many columns when it comes to printing. You have selected range <code>Range(&quot;E1:E3000&quot;)</code> to print it - so one column and many rows, and VBA is confused since it got the command to print many columns in a one-column range. So, original array <code>bfb</code> needs to be transponed before printing, in order to have many rows and one column."}], "tags": [], "owner": {"reputation": 3740, "user_id": 3064741, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3d1eaeba1b98ecb9d37ccb68c69aec0?s=128&d=identicon&r=PG&f=1", "display_name": "mielk", "link": "https://stackoverflow.com/users/3064741/mielk"}, "is_accepted": false, "score": 0, "last_activity_date": 1437605715, "creation_date": 1437605715, "answer_id": 31575412, "question_id": 31575214, "link": "https://stackoverflow.com/questions/31575214/excel-vba-error-on-writing-array-to-worksheet/31575412#31575412", "title": "Excel VBA - error on writing array to worksheet", "body": "<p>Try to transpose the array before pasting it into worksheet:</p>\n\n<pre><code>Sheets(\"Cards\").Range(\"E1:E3000\") = Application.WorksheetFunction.Transpose(bfb)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 13, "user_id": 4765416, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wndqr.gif?s=128&g=1", "display_name": "Reged", "link": "https://stackoverflow.com/users/4765416/reged"}, "edited": false, "score": 0, "creation_date": 1437642174, "post_id": 31581610, "comment_id": 51118319, "body": "A very interesting twist. Thanks"}, {"owner": {"reputation": 13, "user_id": 4765416, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wndqr.gif?s=128&g=1", "display_name": "Reged", "link": "https://stackoverflow.com/users/4765416/reged"}, "edited": false, "score": 0, "creation_date": 1437686189, "post_id": 31581610, "comment_id": 51148110, "body": "Ticked this one in the end as it is the way I have gone and works perfectly."}], "tags": [], "owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "is_accepted": true, "score": 0, "last_activity_date": 1437638943, "creation_date": 1437638943, "answer_id": 31581610, "question_id": 31575214, "link": "https://stackoverflow.com/questions/31575214/excel-vba-error-on-writing-array-to-worksheet/31581610#31581610", "title": "Excel VBA - error on writing array to worksheet", "body": "<p>If you know it will go into a column, you can simply use a 2D array to start with:</p>\n\n<pre><code>Dim bfb(1 To 3000, 1 to 1) As Integer\n</code></pre>\n\n<p>and change this:</p>\n\n<pre><code>bfb(n) = BFval\n</code></pre>\n\n<p>to this:</p>\n\n<pre><code>bfb(n, 1) = BFval\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 4765416, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wndqr.gif?s=128&g=1", "display_name": "Reged", "link": "https://stackoverflow.com/users/4765416/reged"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 576, "favorite_count": 0, "accepted_answer_id": 31581610, "answer_count": 2, "score": 0, "last_activity_date": 1437638943, "creation_date": 1437604522, "last_edit_date": 1531164843, "question_id": 31575214, "link": "https://stackoverflow.com/questions/31575214/excel-vba-error-on-writing-array-to-worksheet", "title": "Excel VBA - error on writing array to worksheet", "body": "<p>I am very much an amateur at VBA so the code will probably not impress. The situation is this:</p>\n\n<p>I have a routine that imports a table of information delimited by a tilde from a text file. I need to pass this to a worksheet on my open file. The problem is that some column elements are strings, others numbers. So I thought a workaround would be to repurpose the values in the first array I have created (BFarr) into smaller arrays that could be dumped in the relevant columns on the sheet.</p>\n\n<p>I started off with one column that just has small integers in it. I ended up with the probably rather odd-looking code below. This works up to a point, in that using <code>Msgbox</code> tells me that the correct numbers are turning up in the new array (bfb).</p>\n\n<p><strong>Why do I only get zeros when I dump the array to the worksheet?</strong></p>\n\n<pre><code>Sub BFudnew()\n    Dim x As TextStream\n    Dim BFarr(1 To 3000, 1 To 6) As Variant\n    Dim bfb(1 To 3000) As Integer\n\n    BFile = Sheets(\"Data\").Range(\"Data_GAM\").Value\n\n    Set fs = CreateObject(\"Scripting.FileSystemObject\")\n    Set x = fs.OpenTextFile(BFile)\n\n    y = x.ReadAll\n\n    Z = Split(y, Chr(10))\n\n    For n = 0 To UBound(Z)\n        BFsq = BFsq + 1\n        A = Split(Z(n), \"~\")\n\n        For o = 0 To UBound(A)\n            BFarr(BFsq, o + 1) = A(o)\n        Next o\n\n    Next n\n\n    For n = 1 To 3000\n        BFval = Val(BFarr(n, 5))\n        BFval = CInt(BFval)\n        bfb(n) = BFval\n    Next n\n\n    Sheets(\"Cards\").Range(\"E1:E3000\") = bfb\n\n    x.Close\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 578, "user_id": 3022977, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/92ec594237a4369838eed929d79df8d6?s=128&d=identicon&r=PG&f=1", "display_name": "Sohel", "link": "https://stackoverflow.com/users/3022977/sohel"}, "edited": false, "score": 0, "creation_date": 1437664326, "post_id": 31575196, "comment_id": 51134691, "body": "Thanks for your feedback Jeeped. I have tested the code with your suggestion, but the result seems to be the same, not summing up correctly."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 578, "user_id": 3022977, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/92ec594237a4369838eed929d79df8d6?s=128&d=identicon&r=PG&f=1", "display_name": "Sohel", "link": "https://stackoverflow.com/users/3022977/sohel"}, "edited": false, "score": 0, "creation_date": 1437679339, "post_id": 31575196, "comment_id": 51144327, "body": "It would seem that providing a sampling of redacted data would expedite getting to the root of the problem. The data you have provided does not even match the narrative; e.g. where does *35092 * come into play? Suggest you  post a publicly shared link to a workbook with redacted data that can be used to reproduce the problem."}, {"owner": {"reputation": 578, "user_id": 3022977, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/92ec594237a4369838eed929d79df8d6?s=128&d=identicon&r=PG&f=1", "display_name": "Sohel", "link": "https://stackoverflow.com/users/3022977/sohel"}, "edited": false, "score": 0, "creation_date": 1437679756, "post_id": 31575196, "comment_id": 51144577, "body": "Sure, I will post a link of the data soon. Just added the full code in the question section."}, {"owner": {"reputation": 578, "user_id": 3022977, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/92ec594237a4369838eed929d79df8d6?s=128&d=identicon&r=PG&f=1", "display_name": "Sohel", "link": "https://stackoverflow.com/users/3022977/sohel"}, "edited": false, "score": 0, "creation_date": 1437688884, "post_id": 31575196, "comment_id": 51149302, "body": "Here is the link: <a href=\"https://drive.google.com/file/d/0BzLiHD7QMfVlU004ODFTRFAwZmM/view?usp=sharing\" rel=\"nofollow noreferrer\">drive.google.com/file/d/0BzLiHD7QMfVlU004ODFTRFAwZmM/&hellip;</a>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 578, "user_id": 3022977, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/92ec594237a4369838eed929d79df8d6?s=128&d=identicon&r=PG&f=1", "display_name": "Sohel", "link": "https://stackoverflow.com/users/3022977/sohel"}, "edited": false, "score": 0, "creation_date": 1437690933, "post_id": 31575196, "comment_id": 51150005, "body": "The problem has nothing to do with your formulas. You were sorting column J after assigning all the values, but ONLY column J which puts it out of sync with columns K:O. See above for suggested modification(s)."}, {"owner": {"reputation": 578, "user_id": 3022977, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/92ec594237a4369838eed929d79df8d6?s=128&d=identicon&r=PG&f=1", "display_name": "Sohel", "link": "https://stackoverflow.com/users/3022977/sohel"}, "edited": false, "score": 0, "creation_date": 1437744379, "post_id": 31575196, "comment_id": 51173053, "body": "Thanks for your feedback Jeeped. I will get back to you after testing the modified code. Thank you."}, {"owner": {"reputation": 578, "user_id": 3022977, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/92ec594237a4369838eed929d79df8d6?s=128&d=identicon&r=PG&f=1", "display_name": "Sohel", "link": "https://stackoverflow.com/users/3022977/sohel"}, "edited": false, "score": 0, "creation_date": 1437747958, "post_id": 31575196, "comment_id": 51175713, "body": "Yes, it is working now Jeeped. The modified code following your recommendation has resolved the summing issue. Thank you. I am having another issue for calculated formula. Instead of multiplying all cells with 0.008 and then adding 0.08, it is summing it up first, then multiplying 0.008 and adding 0.08. I will edit my original post with this issue. The original summing problem that I had is resolved with your help, now trying to resolve the next issue."}, {"owner": {"reputation": 578, "user_id": 3022977, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/92ec594237a4369838eed929d79df8d6?s=128&d=identicon&r=PG&f=1", "display_name": "Sohel", "link": "https://stackoverflow.com/users/3022977/sohel"}, "edited": false, "score": 0, "creation_date": 1437750626, "post_id": 31575196, "comment_id": 51177594, "body": "I have resolved the issue by adding if else if logic. Later today I will post the corrected code so that if anyone else is having the similar issue can also get benefit. I appreciate your help very much Jeeped. I couldn&#39;t select &quot;This Answer was useful&quot; as I don&#39;t have the access to do it yet per the Stackoverflow message."}, {"owner": {"reputation": 578, "user_id": 3022977, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/92ec594237a4369838eed929d79df8d6?s=128&d=identicon&r=PG&f=1", "display_name": "Sohel", "link": "https://stackoverflow.com/users/3022977/sohel"}, "edited": false, "score": 0, "creation_date": 1438024317, "post_id": 31575196, "comment_id": 51267333, "body": "I have uploaded a link to the updated file that has the code in the module: <a href=\"https://drive.google.com/file/d/0BzLiHD7QMfVlZlJzS0VTZXNORlU/view?usp=sharing\" rel=\"nofollow noreferrer\">drive.google.com/file/d/0BzLiHD7QMfVlZlJzS0VTZXNORlU/&hellip;</a>  Now the problem lies in how the result is getting presented. For example, for a particular WR# the result should be 2.104 but the calculated result is not. Here is a test result doc: <a href=\"https://drive.google.com/file/d/0BzLiHD7QMfVlOVk5Zk13VXdQUlE/view?usp=sharing\" rel=\"nofollow noreferrer\">drive.google.com/file/d/0BzLiHD7QMfVlOVk5Zk13VXdQUlE/&hellip;</a> The purpose of this calculation is to get line entry for each WR# and then use the formula but the resulting calculation not doing this. Hoping to get any help. Thank you."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 0, "last_activity_date": 1437690915, "last_edit_date": 1437690915, "creation_date": 1437604406, "answer_id": 31575196, "question_id": 31575010, "link": "https://stackoverflow.com/questions/31575010/excel-vba-how-to-add-cells-in-a-rows-based-on-matched-values/31575196#31575196", "title": "Excel VBA: How to add cells in a rows based on matched values", "body": "<p>From your example, it seems you are trying to use wildcarded 'pattern matches' on numerical values. The </p>\n\n<pre><code>Dim rowIndex As Long\nDim calcFormula1 As Double\nDim calcFormula2 As Double\nDim calcFormula3 As Double\nDim calcFormula4 As Double\n\nFor rowIndex = 2 To lr2\n    calcFormula1 = Application.SumIf(Range(\"A:A\"), Cells(rowIndex, \"J\").Value, Range(\"B:B\"))\n    calcFormula2 = Application.SumIf(Range(\"A:A\"), Cells(rowIndex, \"J\").Value, Range(\"C:C\"))\n    calcFormula3 = Application.SumIf(Range(\"A:A\"), Cells(rowIndex, \"J\").Value, Range(\"D:D\"))\n    calcFormula4 = Application.SumIf(Range(\"A:A\"), Cells(rowIndex, \"J\").Value, Range(\"E:E\"))\n\n    Cells(rowIndex, \"K\").Value = calcFormula1\n    Cells(rowIndex, \"L\").Value = calcFormula2\n    Cells(rowIndex, \"M\").Value = calcFormula3\n    Cells(rowIndex, \"N\").Value = calcFormula4\n\n    Cells(rowIndex, \"O\").Value = calcFormula1 + calcFormula2 + calcFormula3 + calcFormula4\n\nNext rowIndex\n</code></pre>\n\n<p>Your original code was producing false positives by finding <em>123</em> inside <em>91234</em>.</p>\n\n<p>Your sort routine is taking column J out of synch wiht columns K:O. Substitute what you have for this,</p>\n\n<pre><code>' Sort values, lowest to highest number WR#\nWith ActiveWorkbook.Worksheets(\"DeanRoberts\")\n    With .Cells(2, 10).CurrentRegion\n        .Cells.Sort Key1:=.Columns(1), Order1:=xlAscending, _\n                    Orientation:=xlTopToBottom, Header:=xlNo\n    End With\nEnd With\n</code></pre>\n\n<p>I would also use the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff840217.aspx\" rel=\"nofollow\">Range.Text property</a> property for the sumifs.</p>\n\n<pre><code>calcFormula1 = Application.SumIf(Range(\"A:A\"), Cells(rowIndex, \"J\").Text, Range(\"B:B\"))\ncalcFormula2 = Application.SumIf(Range(\"A:A\"), Cells(rowIndex, \"J\").Text, Range(\"C:C\"))\ncalcFormula3 = Application.SumIf(Range(\"A:A\"), Cells(rowIndex, \"J\").Text, Range(\"D:D\"))\ncalcFormula4 = Application.SumIf(Range(\"A:A\"), Cells(rowIndex, \"J\").Text, Range(\"E:E\"))\n</code></pre>\n\n<p>This should compensate for the leading zeroes found in the numbers-that-are-actually-text.</p>\n"}], "owner": {"reputation": 578, "user_id": 3022977, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/92ec594237a4369838eed929d79df8d6?s=128&d=identicon&r=PG&f=1", "display_name": "Sohel", "link": "https://stackoverflow.com/users/3022977/sohel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 434, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1438883876, "creation_date": 1437603490, "last_edit_date": 1437679690, "question_id": 31575010, "link": "https://stackoverflow.com/questions/31575010/excel-vba-how-to-add-cells-in-a-rows-based-on-matched-values", "title": "Excel VBA: How to add cells in a rows based on matched values", "body": "<p>I am trying to sum values in rows in column B, C, D and E and output the sum values in column k, l, m and n. The criteria is matching the value between column A and J. </p>\n\n<p>The output is not getting the summation correctly for multiple row entries with the same number. For example, for a specific cell value in column A = 32605 that only has one line entry with the following values as input: </p>\n\n<pre><code>Pr   Pl  La  Sc\n0    1   0   0\n</code></pre>\n\n<p>Output is getting in column K, L, M and N:</p>\n\n<pre><code>Pr   Pl  La  Sc\n17   0   0   1\n</code></pre>\n\n<p>For the above example, the output should be: </p>\n\n<pre><code>Pr   Pl  La  Sc\n0    1   0   0\n</code></pre>\n\n<p>For multiple row entries example, Column A cell value = 35092 and the input: </p>\n\n<pre><code>Pr  Pl  La Sc\n0   1   0   0\n0   2   0   0\n0   1   0   0\n0   3   0   0\n0   2   0   0\n0   1   0   0\n0   1   0   0\n84  0   0   7\n0   2   0   0\n</code></pre>\n\n<p>Output is showing as: </p>\n\n<pre><code>Pr  Pl  La Sc\n\n0   4   0   0\n</code></pre>\n\n<p>The correct output should be: </p>\n\n<pre><code>Pr  Pl  La Sc\n\n84  13  0  7\n</code></pre>\n\n<p>Here is the full code</p>\n\n<pre><code>Sub A1Report()\n\n  ActiveSheet.Name = \"AccessImport\"\n\n' Get the start and end date from the user\n\nDim TheString1 As String, TheString2 As String, TheStartDate As Date, TheEndDate As Date\nDim TotalDaysEntered As Integer\n\n\n\nTheString1 = Application.InputBox(\"Enter the start date:\")\n\nIf IsDate(TheString1) Then\n    TheStartDate = DateValue(TheString1)\nElse\n    MsgBox \"Invalid date entered\"\nEnd If\n\n\nTheString2 = Application.InputBox(\"Enter the end date:\")\n\nIf IsDate(TheString2) Then\n    TheEndDate = DateValue(TheString2)\nElse\n    MsgBox \"Invalid date entered\"\nEnd If\n\n' The following code extracts the data for a specific date range provided by the user.\n\n ActiveSheet.ListObjects(\"Table_ARM_Activity_Tracker\").Range.AutoFilter field:=7, Criteria1:=\"&gt;=\" &amp; TheStartDate, Operator:=xlAnd, Criteria2:=\"&lt;=\" &amp; TheEndDate\n\n' The next block of code fills up all the blank cells found in column A with E4486 or 004486.\n\nDim c As Integer\n\nFor c = 1 To Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n    If Range(\"A\" &amp; c).Value = vbNullString Then\n        Range(\"A\" &amp; c).Value = \"004486\"\n    End If\nNext c\n\nColumns(\"A:W\").HorizontalAlignment = xlCenter\n\n\nDim LastRowFrom As Long\n\nDim LastRowTo As Long\n\nDim i As Long, j As Long\n\nDim temp As Long\n\nDim found As Boolean\n\n\n'determines the last row that contains data in column A\n\nLastRowFrom = Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n\n\n' Copy data from active sheet to another sheet\n\nActiveWorkbook.Worksheets.Add\n\nActiveSheet.Name = \"DeanRoberts\"\n\nWorksheets(\"AccessImport\").Activate\n\nDim mainworkBook As Workbook\nSet mainworkBook = ActiveWorkbook\nmainworkBook.Sheets(\"AccessImport\").UsedRange.Copy\n\nmainworkBook.Sheets(\"DeanRoberts\").Select\n\nmainworkBook.Sheets(\"DeanRoberts\").Range(\"A1\").Select\n\nmainworkBook.Sheets(\"DeanRoberts\").Paste\n\n\n' Find the unique values and place these identified unique values from Column A into Column J\n\nWorksheets(\"DeanRoberts\").Activate\n\nDim d2 As Object, c2 As Variant, i2 As Long, lr2 As Long\n\nSet d2 = CreateObject(\"Scripting.Dictionary\")\n\nlr2 = Cells(Rows.Count, 1).End(xlUp).Row\n\nc2 = Range(\"A2:A\" &amp; lr2)\n\nFor i2 = 1 To UBound(c2, 1)\n  d2(c2(i2, 1)) = 1\nNext i2\n\nRange(\"J2\").Resize(d2.Count) = Application.Transpose(d2.keys)\n\n\n' Clear contents after the last rows with values in column J\n\nWorksheets(\"DeanRoberts\").Activate\n\n' Sum values found in column B for each unique WR# in Column J, output the result on Column K, L, M, N\n\n  Dim rowIndex As Long\n  Dim calcFormula1 As Double\n  Dim calcFormula2 As Double\n  Dim calcFormula3 As Double\n  Dim calcFormula4 As Double\n\nFor rowIndex = 2 To lr2\n    calcFormula1 = Application.SumIf(Range(\"A:A\"), \"*\" &amp; Cells(rowIndex, \"J\").Value &amp; \"*\", Range(\"B:B\"))\n    calcFormula2 = Application.SumIf(Range(\"A:A\"), \"*\" &amp; Cells(rowIndex, \"J\").Value &amp; \"*\", Range(\"C:C\"))\n    calcFormula3 = Application.SumIf(Range(\"A:A\"), \"*\" &amp; Cells(rowIndex, \"J\").Value &amp; \"*\", Range(\"D:D\"))\n    calcFormula4 = Application.SumIf(Range(\"A:A\"), \"*\" &amp; Cells(rowIndex, \"J\").Value &amp; \"*\", Range(\"E:E\"))\n\n    Cells(rowIndex, \"K\").Value = calcFormula1\n    Cells(rowIndex, \"L\").Value = calcFormula2\n    Cells(rowIndex, \"M\").Value = calcFormula3\n    Cells(rowIndex, \"N\").Value = calcFormula4\n\n    Cells(rowIndex, \"O\").Value = calcFormula1 + calcFormula2 + calcFormula3 + calcFormula4\n\nNext rowIndex\n\nFor rowIndex = 2 To lr2\n  Cells(rowIndex, \"P\").Value = (Cells(rowIndex, \"O\").Value * 0.008) + 0.08\nNext rowIndex\n\n\n' Sort values, lowest to highest number WR#\n\n    ActiveWorkbook.Worksheets(\"DeanRoberts\").Sort.SortFields.Clear\n    ActiveWorkbook.Worksheets(\"DeanRoberts\").Sort.SortFields.Add Key:=Range( _\n    \"J:J\"), SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:= _\n    xlSortNormal\n    With ActiveWorkbook.Worksheets(\"DeanRoberts\").Sort\n      .SetRange Range(\"J:J\")\n      .Header = xlYes\n      .MatchCase = False\n      .Orientation = xlTopToBottom\n      .SortMethod = xlPinYin\n      .Apply\n    End With\n\nColumns(\"J:J\").EntireColumn.AutoFit\nRange(\"O1\").Select\nColumns(\"O:O\").EntireColumn.AutoFit\nColumns(\"P:P\").EntireColumn.AutoFit\n\n' Inserting title of the columns\n\nCells(1, \"J\").Value = \"WR#\"\nCells(1, \"K\").Value = \"Prints\"\nCells(1, \"L\").Value = \"Plots\"\nCells(1, \"M\").Value = \"Laminate\"\nCells(1, \"N\").Value = \"Scans\"\nCells(1, \"O\").Value = \"Total Usage\"\nCells(1, \"P\").Value = \"Total Hours\"\n\n' Cells(1, \"P\").Value = \"Grand Total\"\n\n'Cells(2, \"P\").Value = calcTotal\n'avgNumber = calcTotal / TotalDaysEntered\n\n'Cells(1, \"Q\").Value = \"Average\"\n'Cells(2, \"Q\").Value = avgNumber\n\n\nCells(1, 10).Font.Bold = True\nCells(1, 11).Font.Bold = True\nCells(1, 12).Font.Bold = True\nCells(1, 13).Font.Bold = True\nCells(1, 14).Font.Bold = True\nCells(1, 15).Font.Bold = True\nCells(1, 16).Font.Bold = True\nCells(1, 17).Font.Bold = True\nCells(1, 18).Font.Bold = True\n\nColumns(\"A:W\").HorizontalAlignment = xlCenter\n</code></pre>\n\n<p>End Sub</p>\n\n<p>Hoping to get your help. Let me know if more info is needed.</p>\n\n<p>Thank you.\nmk</p>\n"}, {"tags": ["vba", "excel", "countif"], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 5145207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/634f9ae65a3dea1f8a1ddc4496b17936?s=128&d=identicon&r=PG&f=1", "display_name": "MarkDG", "link": "https://stackoverflow.com/users/5145207/markdg"}, "edited": false, "score": 0, "creation_date": 1437603167, "post_id": 31574867, "comment_id": 51104686, "body": "Looks like that&#39;s working! Thanks for the swift, effective response. Out of curiosity, is there any particular advantage to using With/End With instead of just putting Sheets(&quot;WOMade&quot;) right before .Columns?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 11, "user_id": 5145207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/634f9ae65a3dea1f8a1ddc4496b17936?s=128&d=identicon&r=PG&f=1", "display_name": "MarkDG", "link": "https://stackoverflow.com/users/5145207/markdg"}, "edited": false, "score": 0, "creation_date": 1437603328, "post_id": 31574867, "comment_id": 51104758, "body": "Using a <a href=\"https://msdn.microsoft.com/en-us/library/wc500chb.aspx\" rel=\"nofollow noreferrer\">With ... End With statement</a> reduces the code. Your formula would have had to use <code>Sheets(&quot;WOMade&quot;)</code> at least twice in a single formula and possibly other times for commands that involved working with the value returned by the worksheet function. It also makes it harder to forget to explicitly define parentage."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 0, "last_activity_date": 1437602871, "creation_date": 1437602871, "answer_id": 31574867, "question_id": 31574816, "link": "https://stackoverflow.com/questions/31574816/using-countif-function-in-vba-to-count-number-of-entries-with-a-specific-month-a/31574867#31574867", "title": "Using CountIf function in VBA to count number of entries with a specific Month and Year (ignoring Day)", "body": "<p>I would think that the last example was the closest.</p>\n\n<pre><code>dim i as long\nwith Sheets(\"WOMade\")\n    i = WorksheetFunction.CountIfs(.Columns(\"H:H\"), \"&gt;=\"  &amp; dateserial(2015, 6, 1), .Columns(\"H:H\"), \"&lt;\" &amp; dateserial(2015, 7, 1))\n    'or,\n    i = WorksheetFunction.CountIfs(.Columns(\"H:H\"), \"&gt;=\"  &amp; datevalue(\"6/1/2015\"), .Columns(\"H:H\"), \"&lt;\" &amp; datevalue(\"7/1/2015\"))\n    'or,\n    i = WorksheetFunction.CountIfs(.Columns(\"H:H\"), \"&gt;=6/1/2015\", .Columns(\"H:H\"), \"&lt;7/1/2015\")\nend with\n</code></pre>\n"}, {"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1437604058, "post_id": 31575034, "comment_id": 51105060, "body": "Wouldn&#39;t that count all of the dates in Jul-2015 as well as the dates in Jun-2015? The OP stated he wanted to return a count <i>&#39;that have a date in a specific month and year&#39;</i>."}, {"owner": {"reputation": 106, "user_id": 5135721, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-g79q4RQxFOM/AAAAAAAAAAI/AAAAAAAABSk/LMMhL9NMT0M/photo.jpg?sz=128", "display_name": "n0v1c3", "link": "https://stackoverflow.com/users/5135721/n0v1c3"}, "edited": false, "score": 0, "creation_date": 1437604136, "post_id": 31575034, "comment_id": 51105098, "body": "Simply remove the &quot;&gt;=&quot; and replace with &quot;=&quot;"}], "tags": [], "owner": {"reputation": 106, "user_id": 5135721, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-g79q4RQxFOM/AAAAAAAAAAI/AAAAAAAABSk/LMMhL9NMT0M/photo.jpg?sz=128", "display_name": "n0v1c3", "link": "https://stackoverflow.com/users/5135721/n0v1c3"}, "is_accepted": false, "score": 0, "last_activity_date": 1437604325, "last_edit_date": 1437604325, "creation_date": 1437603593, "answer_id": 31575034, "question_id": 31574816, "link": "https://stackoverflow.com/questions/31574816/using-countif-function-in-vba-to-count-number-of-entries-with-a-specific-month-a/31575034#31575034", "title": "Using CountIf function in VBA to count number of entries with a specific Month and Year (ignoring Day)", "body": "<p>Sub Test()\n        Sheets(\"WOMade\").Select</p>\n\n<pre><code>    SetYear = 2015\n    SetMonth = 1\n    Count = 0\n\n    i = 1\n    Do While Cells(i, 8) &lt;&gt; \"\"\n        ' Subtract for TRUE as it is stored as -1\n        Count = Count - (Year(Cells(i, 8)) = SetYear And Month(Cells(i, 8)) = SetMonth)\n\n        i = i + 1\n    Loop\n\n    MsgBox Count\n</code></pre>\n\n<p>End Sub</p>\n"}, {"tags": [], "owner": {"reputation": 5865, "user_id": 4415493, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/CidOV.jpg?s=128&g=1", "display_name": "JamesFaix", "link": "https://stackoverflow.com/users/4415493/jamesfaix"}, "is_accepted": false, "score": 0, "last_activity_date": 1437606110, "creation_date": 1437606110, "answer_id": 31575476, "question_id": 31574816, "link": "https://stackoverflow.com/questions/31574816/using-countif-function-in-vba-to-count-number-of-entries-with-a-specific-month-a/31575476#31575476", "title": "Using CountIf function in VBA to count number of entries with a specific Month and Year (ignoring Day)", "body": "<pre><code>Public Function CountOfYearMonth(r As Range, y As Integer, m As Integer) As Long\n\n    Set r = Intersect(r, r.Parent.UsedRange) 'Don't iterate over more than you have to\n\n    'Technically n is not necessary, you can just use CountOfYearMonth\n    Dim n As Long, _\n        c As Range, _\n        d As Date\n\n    For Each c In r.Cells        \n        If IsDate(c.Value) Then 'Does the cell contain a date?\n            d = CDate(c.Value) 'Convert, if so\n            If month(d) = m And year(d) = y Then 'Check year and month\n                n = n + 1 'If match, increment total\n            End If\n        End If\n    Next c\n\n    CountOfYearMonth = n 'Assign return value\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 5145207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/634f9ae65a3dea1f8a1ddc4496b17936?s=128&d=identicon&r=PG&f=1", "display_name": "MarkDG", "link": "https://stackoverflow.com/users/5145207/markdg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 3318, "favorite_count": 1, "answer_count": 3, "score": 1, "last_activity_date": 1437606110, "creation_date": 1437602668, "question_id": 31574816, "link": "https://stackoverflow.com/questions/31574816/using-countif-function-in-vba-to-count-number-of-entries-with-a-specific-month-a", "title": "Using CountIf function in VBA to count number of entries with a specific Month and Year (ignoring Day)", "body": "<p>I'm fairly new at VBA. Using Excel 2007 VBA, I'm trying to count the number of entries in the \"H\" column of the \"WOMade\" worksheet that have a date in a specific month and year (ignoring the day), but all the methods I've tried aren't working.</p>\n\n<p>Among other ideas, I've tried:</p>\n\n<pre><code>WorksheetFunction.CountIf(Sheets(\"WOMade\").Columns(\"H:H\"), \"June-15\")\n</code></pre>\n\n<p>And</p>\n\n<pre><code>WorksheetFunction.CountIf(Format(Sheets(\"WOMade\").Columns(\"H:H\"), \"mmyyyy\"), \"062015\")\n</code></pre>\n\n<p>And</p>\n\n<pre><code>WorksheetFunction.CountIf(Sheets(\"WOMade\").Columns(\"H:H\"), \"June/\" &amp; \"/2015)\n</code></pre>\n\n<p>And</p>\n\n<pre><code>WorksheetFunction.CountIfs(Sheets(\"WOMade\").Columns(\"H:H\"), \"&gt;=\" 6/1/2015, Sheets(\"WOMade\").Columns(\"H:H\"), &lt; 7/1/2015)\n</code></pre>\n\n<p>Any ideas?</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 106, "user_id": 5135721, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-g79q4RQxFOM/AAAAAAAAAAI/AAAAAAAABSk/LMMhL9NMT0M/photo.jpg?sz=128", "display_name": "n0v1c3", "link": "https://stackoverflow.com/users/5135721/n0v1c3"}, "is_accepted": false, "score": 1, "last_activity_date": 1437609322, "last_edit_date": 1437609322, "creation_date": 1437605579, "answer_id": 31575383, "question_id": 31574806, "link": "https://stackoverflow.com/questions/31574806/avoid-duplicate-sheet-name-error/31575383#31575383", "title": "Avoid duplicate sheet name error", "body": "<pre><code>Sub NewDay()\n\n    Dim CopySheet As Long\n\n    CopySheet = MsgBox(\"New Sheet\", vbYesNo, \"92x4-4xx9 xx INC\")\n    If CopySheet = vbNo Then Exit Sub\n        ActiveSheet.Copy before:=ActiveSheet\n        With ActiveSheet.Range(\"C1\")\n            Dim WS_Sheet As Worksheet\n            On Error Resume Next\n            Set WS_Sheet = Sheets(.Parent.Name = Format(.Value, \"mmm-dd-yyyy\"))\n            On Error GoTo 0\n\n            If WS_Sheet Is Nothing Then ' Worksheet did not exist\n                .Parent.Name = Format(.Value, \"mmm-dd-yyyy\")\n                Worksheets(\"Productions\").Range(\"G6:G56\").ClearContents\n                Worksheets(\"Productions\").Range(\"J6:J56\").ClearContents\n                Worksheets(\"Productions\").Range(\"M6:O56\").ClearContents\n                Worksheets(\"Productions\").Range(\"M63:N63\").ClearContents\n                Worksheets(\"Productions\").Range(\"E59:Q59\").ClearContents\n                Range(\"C1\") = Format(Date - 1)\n                Sheets(\"Productions\").Activate\n                Productions.Range(\"G6\").Select\n                Range(\"C1\") = Format(Date)\n            Else ' Worksheet exists\n                ' Handle the problem here\n            End If\n        End With\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 5583, "user_id": 4556996, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/amIjI.jpg?s=128&g=1", "display_name": "Dan Donoghue", "link": "https://stackoverflow.com/users/4556996/dan-donoghue"}, "is_accepted": false, "score": 0, "last_activity_date": 1437610414, "last_edit_date": 1437610414, "creation_date": 1437609987, "answer_id": 31576049, "question_id": 31574806, "link": "https://stackoverflow.com/questions/31574806/avoid-duplicate-sheet-name-error/31576049#31576049", "title": "Avoid duplicate sheet name error", "body": "<p>Build a routine to trap and deal with errors. Here is an example of how to do it:</p>\n\n<pre><code>Sub SheetError()\n    Dim MySheet As String\n    On Error GoTo ErrorCheck\n    MySheet = ActiveSheet.Name\n    Sheets.Add\n    ActiveSheet.Name = MySheet\n    MsgBox \"I continued the code\"\n    Activsheet.Name = \"XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX\"\n    MsgBox \"I will never get to here in the code\"\n    End\nErrorCheck:\n    If Err.Description = \"Cannot rename a sheet to the same name as another sheet, a referenced object library or a workbook referenced by Visual Basic.\" Then\n        Resume Next\n    Else\n        MsgBox \"Error I am not designed to deal with\"\n    End If\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 5145531, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh5.googleusercontent.com/-2nt3Szcxn3U/AAAAAAAAAAI/AAAAAAAAAmM/qUDbJHcQ5dE/photo.jpg?sz=128", "display_name": "Nguyen Van Hiep", "link": "https://stackoverflow.com/users/5145531/nguyen-van-hiep"}, "is_accepted": false, "score": 0, "last_activity_date": 1437615977, "creation_date": 1437615977, "answer_id": 31576855, "question_id": 31574806, "link": "https://stackoverflow.com/questions/31574806/avoid-duplicate-sheet-name-error/31576855#31576855", "title": "Avoid duplicate sheet name error", "body": "<p>Thx guys I found what I need.</p>\n\n<pre><code> Sub NewDay(control As IRibbonControl)\n\n    Dim CopySheet As Long, ws As Workbook\n\n    CopySheet = MsgBox(\"New Sheet\", vbYesNo, \"xxxxxxxxxx\")\n    If CopySheet = vbNo Then Exit Sub\n        ActiveSheet.Copy before:=ActiveSheet\n        With ActiveSheet.Range(\"C1\")\n            Dim WS_Sheet As Worksheet, intNumber As Integer\n            On Error Resume Next\n            Set WS_Sheet = Sheets(.Parent.Name = Format(.Value, \"mmm-dd-yyyy\"))\n            On Error GoTo errHandler\n\n            intNumber = 0 / 3\n\n            If WS_Sheet Is Nothing Then ' Worksheet did not exist\n                .Parent.Name = Format(.Value, \"mmm-dd-yyyy\")\n                Worksheets(\"Productions\").Range(\"G6:G56\").ClearContents\n                Worksheets(\"Productions\").Range(\"J6:J56\").ClearContents\n                Worksheets(\"Productions\").Range(\"M6:O56\").ClearContents\n                Worksheets(\"Productions\").Range(\"M63:N63\").ClearContents\n                Worksheets(\"Productions\").Range(\"E59:Q59\").ClearContents\n                Range(\"C1\") = Format(Date - 1)\n                Sheets(\"Productions\").Activate\n                Productions.Range(\"G6\").Select\n                Range(\"C1\") = Format(Date)\n            Else ' Worksheet exists\n                ' Handle the problem here\n                Exit Sub\nerrHandler:\n                MsgBox Err.Number &amp; Err.Description\n                SendKeys \"~\"\n                ActiveWindow.SelectedSheets.Delete\n\n            End If\n        End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 5145531, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh5.googleusercontent.com/-2nt3Szcxn3U/AAAAAAAAAAI/AAAAAAAAAmM/qUDbJHcQ5dE/photo.jpg?sz=128", "display_name": "Nguyen Van Hiep", "link": "https://stackoverflow.com/users/5145531/nguyen-van-hiep"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1888, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1437615977, "creation_date": 1437602604, "last_edit_date": 1531164843, "question_id": 31574806, "link": "https://stackoverflow.com/questions/31574806/avoid-duplicate-sheet-name-error", "title": "Avoid duplicate sheet name error", "body": "<p>I have a custom ribbon that attach to a module \"New Day\"</p>\n\n<p>what I want is to avoid duplicate sheetname error, exit sub if sheetname is aready created and adding msg \"name aready exist\" .</p>\n\n<p>My code:</p>\n\n<pre><code> Sub NewDay(control As IRibbonControl)\n\n    Dim CopySheet As Long\n\n    CopySheet = MsgBox(\"New Sheet\", vbYesNo, \"92x4-4xx9 xx INC\")\n    If CopySheet = vbNo Then Exit Sub\n        ActiveSheet.Copy before:=ActiveSheet\n        With ActiveSheet.Range(\"C1\")\n        .Parent.Name = Format(.Value, \"mmm-dd-yyyy\")\n        Worksheets(\"Productions\").Range(\"G6:G56\").ClearContents\n        Worksheets(\"Productions\").Range(\"J6:J56\").ClearContents\n        Worksheets(\"Productions\").Range(\"M6:O56\").ClearContents\n        Worksheets(\"Productions\").Range(\"M63:N63\").ClearContents\n        Worksheets(\"Productions\").Range(\"E59:Q59\").ClearContents\n        Range(\"C1\") = Format(Date - 1)\n        Sheets(\"Productions\").Activate\n        Productions.Range(\"G6\").Select\n        Range(\"C1\") = Format(Date)\n        End With\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["sql", "database", "ms-access", "vba"], "comments": [{"owner": {"reputation": 21, "user_id": 4118527, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/5e2ddc22f9a5cf9a2cb4b6e51e3183fd?s=128&d=identicon&r=PG&f=1", "display_name": "Dylan Kramer", "link": "https://stackoverflow.com/users/4118527/dylan-kramer"}, "reply_to_user": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1437659632, "post_id": 31574715, "comment_id": 51130701, "body": "This returns 0 records. But if I surround the dates in # signs then it returns the record I am looking for. How do I put those into my code? When I try I get an error."}], "answers": [{"tags": [], "owner": {"reputation": 3188, "user_id": 2880366, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5tyAn.jpg?s=128&g=1", "display_name": "AlexB", "link": "https://stackoverflow.com/users/2880366/alexb"}, "is_accepted": false, "score": 0, "last_activity_date": 1437603129, "creation_date": 1437603129, "answer_id": 31574929, "question_id": 31574715, "link": "https://stackoverflow.com/questions/31574715/how-do-you-find-if-a-record-exists/31574929#31574929", "title": "How do you find if a record exists?", "body": "<p>Use the FindFirst method : </p>\n\n<pre><code>myrst.FindFirst \"field = \" &amp; value\n\nIf myrst.NoMatch Then\n      //code when record doesn't exist       \nEnd If\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 21, "user_id": 4118527, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/5e2ddc22f9a5cf9a2cb4b6e51e3183fd?s=128&d=identicon&r=PG&f=1", "display_name": "Dylan Kramer", "link": "https://stackoverflow.com/users/4118527/dylan-kramer"}, "edited": false, "score": 0, "creation_date": 1437658914, "post_id": 31575742, "comment_id": 51130125, "body": "Select tblOrders.lngEmpID, tblOrders.dtmGiveAwayDate1, tblOrders.dtmGiveAwayDate2 FROM tblOrders WHERE tblOrders.lngEmpID = 200832 AND tblOrders.dtmGiveAwayDate1 = 8/17/2015 AND tblOrders.dtmGiveAwayDate2 = 8/18/2015"}, {"owner": {"reputation": 21, "user_id": 4118527, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/5e2ddc22f9a5cf9a2cb4b6e51e3183fd?s=128&d=identicon&r=PG&f=1", "display_name": "Dylan Kramer", "link": "https://stackoverflow.com/users/4118527/dylan-kramer"}, "edited": false, "score": 0, "creation_date": 1437658966, "post_id": 31575742, "comment_id": 51130167, "body": "Above is the sql code that the program spits out. The dates are formatted as short dates in the table. I&#39;m not sure what is going on"}, {"owner": {"reputation": 74, "user_id": 5117215, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f2391d9fbb39b8275de7b5cb307ba32d?s=128&d=identicon&r=PG", "display_name": "Sgr3005", "link": "https://stackoverflow.com/users/5117215/sgr3005"}, "reply_to_user": {"reputation": 21, "user_id": 4118527, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/5e2ddc22f9a5cf9a2cb4b6e51e3183fd?s=128&d=identicon&r=PG&f=1", "display_name": "Dylan Kramer", "link": "https://stackoverflow.com/users/4118527/dylan-kramer"}, "edited": false, "score": 0, "creation_date": 1437673808, "post_id": 31575742, "comment_id": 51141012, "body": "I see below you got it!  Nice. Sorry I couldn&#39;t remember the vba side of formatting dates when I posted that yesterday, I&#39;m glad you got it figured out."}], "tags": [], "owner": {"reputation": 74, "user_id": 5117215, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f2391d9fbb39b8275de7b5cb307ba32d?s=128&d=identicon&r=PG", "display_name": "Sgr3005", "link": "https://stackoverflow.com/users/5117215/sgr3005"}, "is_accepted": false, "score": 0, "last_activity_date": 1437607798, "creation_date": 1437607798, "answer_id": 31575742, "question_id": 31574715, "link": "https://stackoverflow.com/questions/31574715/how-do-you-find-if-a-record-exists/31575742#31575742", "title": "How do you find if a record exists?", "body": "<p>Checking for equality with dates can be tricky.  Since VBA dates can include time to the nanosecond, could it be that one side (SQL/code) has a real time, while the other has the default midnight value?</p>\n"}, {"tags": [], "owner": {"reputation": 21, "user_id": 4118527, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/5e2ddc22f9a5cf9a2cb4b6e51e3183fd?s=128&d=identicon&r=PG&f=1", "display_name": "Dylan Kramer", "link": "https://stackoverflow.com/users/4118527/dylan-kramer"}, "is_accepted": false, "score": 0, "last_activity_date": 1437660163, "creation_date": 1437660163, "answer_id": 31589704, "question_id": 31574715, "link": "https://stackoverflow.com/questions/31574715/how-do-you-find-if-a-record-exists/31589704#31589704", "title": "How do you find if a record exists?", "body": "<pre><code>    Set mydb = CurrentDb\n    Date1 = Format(Me.dtmGiveAwayDate1, \"Short Date\")\n    Date2 = Format(Me.dtmGiveAwayDate2, \"Short Date\")\n    mysql = (\"Select tblOrders.lngEmpID, tblOrders.dtmGiveAwayDate1, tblOrders.dtmGiveAwayDate2 FROM tblOrders WHERE tblOrders.lngEmpID =\" &amp; EmployeeID &amp; \" AND tblOrders.dtmGiveAwayDate1 =\" &amp; \"#\" &amp; Date1 &amp; \"#\" &amp; \" AND tblOrders.dtmGiveAwayDate2 =\" &amp; \"#\" &amp; Date2 &amp; \"#\")\n    MsgBox mysql\n    Set myrst = mydb.OpenRecordset(mysql)\n</code></pre>\n\n<p>This was the code I used and it works now. Thank you.</p>\n"}], "owner": {"reputation": 21, "user_id": 4118527, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/5e2ddc22f9a5cf9a2cb4b6e51e3183fd?s=128&d=identicon&r=PG&f=1", "display_name": "Dylan Kramer", "link": "https://stackoverflow.com/users/4118527/dylan-kramer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 54, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1594644054, "creation_date": 1437602222, "last_edit_date": 1594644054, "question_id": 31574715, "link": "https://stackoverflow.com/questions/31574715/how-do-you-find-if-a-record-exists", "title": "How do you find if a record exists?", "body": "<pre><code>Dim mydb As DAO.Database\nDim myrst As DAO.Recordset\nDim Date1, Date2 As Date\nDim mysql As String\nDim qdf As QueryDef\nDim EmployeeID As String\n\n    EmployeeID = DLookup(\"lngEmpID\", \"tblEmployees\", \"Forms!frmEmployeeOrderForm.cboEmployeeName.Value = EmployeeName\")\n    Me.EmpID = EmployeeID\n    PickupTime = DLookup(\"Pickup\", \"tblEmployees\", \"Forms!frmEmployeeOrderForm.cboEmployeeName.Value = EmployeeName\")\n    Me.PickupDay = PickupTime\n\n    Set mydb = CurrentDb\n    Date1 = Me.dtmGiveAwayDate1\n    Date2 = Me.dtmGiveAwayDate2\n    mysql = (\"Select tblOrders.lngEmpID, tblOrders.dtmGiveAwayDate1, tblOrders.dtmGiveAwayDate2 FROM tblOrders WHERE tblOrders.lngEmpID =\" &amp; EmployeeID &amp; \" AND tblOrders.dtmGiveAwayDate1 =\" &amp; Date1 &amp; \" AND tblOrders.dtmGiveAwayDate2 =\" &amp; Date2)\n    MsgBox mysql\n    Set myrst = mydb.OpenRecordset(mysql)\n\n    If myrst.EOF = False Then\n        MsgBox \"You have already ordered for this PFG.\" &amp; vbCrLf &amp; \"Please see Jody for help.\"\n        cmdCancel_Click\n        Exit Sub\n    End If\n</code></pre>\n\n<p>When I run the program I am trying to prevent employees from entering their name twice for the same dates. To test I tried to duplicate a record for the same employee and it will not trigger the myrst.eof = false and display the message box that says \"You have already ordered for this PFG\". Any help is much appreciated. </p>\n\n<p>Thank you in advance.</p>\n"}, {"tags": ["vba", "excel", "pivot", "pivot-table"], "comments": [{"owner": {"reputation": 3845, "user_id": 4288101, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O0Xld.jpg?s=128&g=1", "display_name": "Byron Wall", "link": "https://stackoverflow.com/users/4288101/byron-wall"}, "edited": false, "score": 0, "creation_date": 1437682718, "post_id": 31574492, "comment_id": 51146228, "body": "<code>it doesn&#39;t work</code> is not a helpful description of the problem.  How does it not work?  Does it give an error?  If so, which line?  If no error, how does the code not produce the result you are looking for?  One thing to be aware of is that you must have at least one visible item in the set of <code>PivotItems</code>.  This is always tricky when you iterate them because it is not necessarily known which ones are hidden/visible.  You can force them all visible first and then run your code to hide them all but one if that is the issue."}], "answers": [{"tags": [], "owner": {"reputation": 706, "user_id": 5173954, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7405cfaae8da31e42411b570c28eabf1?s=128&d=identicon&r=PG&f=1", "display_name": "DiegoAndresJAY", "link": "https://stackoverflow.com/users/5173954/diegoandresjay"}, "is_accepted": false, "score": 0, "last_activity_date": 1438464579, "creation_date": 1438464579, "answer_id": 31766412, "question_id": 31574492, "link": "https://stackoverflow.com/questions/31574492/excel-vba-filter-pivot-table-with-flexible-names/31766412#31766412", "title": "excel VBA filter pivot table with flexible names", "body": "<pre><code>Sub SetPageFilter(WB As String, WS As String, pt As String, fd As String,value as string)\nDim wb_ As Workbook, ws_ As Worksheet, pt_ As PivotTable, fd_ As PivotField\n\nws_ = Application.Workbooks(WB).Sheets(WS)\npt_ = ws_.PivotTables(pt)\nfd_ = pt_.PivotFields(fd)\nWith fd_\n    .Orientation = xlPageField\nEnd With\nApplication.ScreenUpdating = True\n\nDim i As Long\n\n    With fd_\n        .PivotItems(.PivotItems.Count).Visible = True\n        For i = 1 To .PivotItems.Count\n            If .PivotItems(i).Name = Value Then _\n                .PivotItems(i).Visible = True Else _\n                .PivotItems(i).Visible = False\n        Next I\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 5145504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b7ef47d99d49181442a676bae79f5741?s=128&d=identicon&r=PG&f=1", "display_name": "Mikezhu", "link": "https://stackoverflow.com/users/5145504/mikezhu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 278, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1438464579, "creation_date": 1437601306, "question_id": 31574492, "link": "https://stackoverflow.com/questions/31574492/excel-vba-filter-pivot-table-with-flexible-names", "title": "excel VBA filter pivot table with flexible names", "body": "<pre><code>Set Weight_wb = Application.Workbooks(WEIGHTFileName).Sheets(\"TERRY_CAT\")\nSet pt = Weight_wb .PivotTables(\"PivotTable4\")\n\n\nWith Weight_wb .PivotTables(\"PivotTable4\").PivotFields(\"Cat\")\n    .Orientation = xlColumnField\n    .Position = 1\nEnd With\nWith Weight_wb .PivotTables(\"PivotTable4\").PivotFields(\"Cat\")\n    .Orientation = xlColumnField\n    On Error Resume Next\n    .PivotItems(\"black\").Visible = True\n    .PivotItems(\"yellow\").Visible = False\n    .PivotItems(\"brown\").Visible = False\n    .Position = 1\nEnd With\n</code></pre>\n\n<p>I want to change the above code to be more flexible.\nI want to write a more general sub SetClolumnFilter, so that I can simply call:</p>\n\n<pre><code>SetColumnFilter WEIGHTFileName, \"Terry_cat\", \"PivotTable4\", \"CAT\",\"black\"\n</code></pre>\n\n<p>something like (it doesnt work):</p>\n\n<pre><code>Sub SetPageFilter(WB As String, WS As String, pt As String, fd As String,value as string)\nDim wb_ As Workbook, ws_ As Worksheet, pt_ As PivotTable, fd_ As PivotField\n\nws_ = Application.Workbooks(WB).Sheets(WS)\npt_ = ws_.PivotTables(pt)\nfd_ = pt_.PivotFields(fd)\nWith fd_\n.Orientation = xlPageField\nEnd With\nApplication.ScreenUpdating = True\n\nDim i As Long\n\n        .PivotItems(1).Visible = True\n        For i = 2 To Field.PivotItems.Count\n            If .PivotItems(i).Name = Value Then _\n                .PivotItems(i).Visible = True Else _\n                .PivotItems(i).Visible = False\n        Next i\nEnd Sub\n</code></pre>\n\n<p>Thanks a lot!!</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1681, "user_id": 2196075, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/AnmQs.jpg?s=128&g=1", "display_name": "Holmes IV", "link": "https://stackoverflow.com/users/2196075/holmes-iv"}, "edited": false, "score": 2, "creation_date": 1437600477, "post_id": 31574252, "comment_id": 51103517, "body": "Basically you need 2 loops around this macro or in another sub, calling this macro, 1 the loops through all the excel files that are valid, and the second that loops through all the valid sheets."}, {"owner": {"reputation": 10255, "user_id": 1024832, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/954d8559c2d4cd308e4c2795423dd268?s=128&d=identicon&r=PG", "display_name": "Marc", "link": "https://stackoverflow.com/users/1024832/marc"}, "edited": false, "score": 1, "creation_date": 1437600482, "post_id": 31574252, "comment_id": 51103520, "body": "Create the function in a module within one &quot;driving&quot; workbook.  That driving workbook can iterate over the files and sheets you&#39;re interested in and apply the function for each of them."}, {"owner": {"reputation": 415, "user_id": 4992910, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Hwkmo.png?s=128&g=1", "display_name": "ate50eggs", "link": "https://stackoverflow.com/users/4992910/ate50eggs"}, "edited": false, "score": 1, "creation_date": 1437601724, "post_id": 31574252, "comment_id": 51104071, "body": "You&#39;re doing everything on the active sheet. If you want to handle a bunch of sheets (eg. loop through them as suggested) you can reference them by name or number like this. <code>Worksheets(&quot;Sheet2&quot;) </code> so you can do stuff like <code>Worksheets(&quot;Sheet2&quot;).Range(lrng, Cells(lrng.Row, &quot;Y&quot;))</code>"}], "answers": [{"tags": [], "owner": {"reputation": 1396, "user_id": 4691433, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/bce001c90ad26add5d7483b714640c12?s=128&d=identicon&r=PG&f=1", "display_name": "puzzlepiece87", "link": "https://stackoverflow.com/users/4691433/puzzlepiece87"}, "is_accepted": true, "score": 1, "last_activity_date": 1437601625, "creation_date": 1437601625, "answer_id": 31574573, "question_id": 31574252, "link": "https://stackoverflow.com/questions/31574252/vba-calculation-for-multiple-worksheets-workbook/31574573#31574573", "title": "VBA, Calculation for multiple worksheets/workbook", "body": "<p>You can't calculate without opening all the workbooks, but there is a simple command for what you are looking for: <code>Application.CalculateFull</code>. It re-calculates all sheets in all open workbooks. Be aware that this may take a long time and may make Excel seem like it is not responding until it finishes. In addition, if the open sheets are in a different instance of Excel from your macro above, they will not calculate.</p>\n\n<p>So I would imagine your process to look like this:</p>\n\n<ul>\n<li>Run your macro to open all the files</li>\n<li>Run your macro above, with <code>.CalculateFull</code> just after <code>.Calculation = xlCalculationAutomatic</code> and just before <code>End With</code>, <code>End Sub</code></li>\n</ul>\n"}], "owner": {"reputation": 313, "user_id": 5145483, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f0497542b855672427b9653327bbc39b?s=128&d=identicon&r=PG&f=1", "display_name": "Jonathan", "link": "https://stackoverflow.com/users/5145483/jonathan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 574, "favorite_count": 0, "accepted_answer_id": 31574573, "answer_count": 1, "score": 1, "last_activity_date": 1521291196, "creation_date": 1437600275, "last_edit_date": 1521291196, "question_id": 31574252, "link": "https://stackoverflow.com/questions/31574252/vba-calculation-for-multiple-worksheets-workbook", "title": "VBA, Calculation for multiple worksheets/workbook", "body": "<p>I have the following Macro:</p>\n\n<pre><code>Sub PercentCalc()\n\nDim xrng As Range, lrw As Long, lrng As Range, i As Long\n\nWith Application\n    .ScreenUpdating = False\n    .Calculation = xlCalculationManual\nEnd With\n\nFor i = 1 To 25\n    With Columns(i)\n        .TextToColumns Destination:=.Cells(1, 1), DataType:=xlDelimited, TrailingMinusNumbers:=True\n    End With\nNext\n\nlrw = Columns(\"A:Y\").Find(\"*\", , xlValues, , xlRows, xlPrevious).Row\nSet lrng = Range(\"A\" &amp; lrw + 2)\n\nWith Range(\"A2:A\" &amp; lrw)\n    lrng.Formula = \"=COUNTA(\" &amp; .Address(0, 0) &amp; \")/ROWS(\" &amp; .Address(0, 0) &amp; \")\"\nEnd With\n\nSet xrng = Range(lrng, Cells(lrng.Row, \"Y\"))\n\nlrng.AutoFill xrng, Type:=xlFillDefault\nxrng.Style = \"Percent\"\n\nWith Application\n    .ScreenUpdating = True\n    .Calculation = xlCalculationAutomatic\nEnd With \nEnd Sub\n</code></pre>\n\n<p>How can I apply this across multiple worksheets in a workbook? Or multiple workbooks with multiple worksheets? I have a macro to open all Excel files in my directory. Even better if I could bypass opening all Excel files.</p>\n\n<p>Pretty much want to automate this macro within a large amount of files/sheets.</p>\n"}, {"tags": ["excel", "vba", "ms-access-2010", "pivot-table"], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 5145470, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aea553b9c0e4266c882c36bfeb470eef?s=128&d=identicon&r=PG&f=1", "display_name": "Jay Zimmerman", "link": "https://stackoverflow.com/users/5145470/jay-zimmerman"}, "edited": false, "score": 0, "creation_date": 1437654138, "post_id": 31575976, "comment_id": 51126290, "body": "The sheet in excel isn&#39;t an actual pivot table. It is formatted like one, as seen above, but has no pivot table properties."}], "tags": [], "owner": {"reputation": 123, "user_id": 2130154, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/abe714e3293a98afc681e4a91d510c5b?s=128&d=identicon&r=PG", "display_name": "DrakePro", "link": "https://stackoverflow.com/users/2130154/drakepro"}, "is_accepted": false, "score": 0, "last_activity_date": 1437609388, "creation_date": 1437609388, "answer_id": 31575976, "question_id": 31574213, "link": "https://stackoverflow.com/questions/31574213/transfer-excel-pivot-table-to-access/31575976#31575976", "title": "Transfer Excel Pivot table to Access", "body": "<p>Pivot table is just grouped information that feeds from other data set. To find data set:\nClick on pivot table \nYou will see pivot table tools in the ribbon\nClick on Analyze and Change Data source.\nIn Data source you will find location of table or range:\nThis is your un-pivoted table</p>\n\n<p>To export excel sheet in Access:\nClick on external data \nthen select excel.\nSelect import the data into new table.\nSelect your workbook to import.</p>\n"}, {"tags": [], "owner": {"reputation": 123, "user_id": 2130154, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/abe714e3293a98afc681e4a91d510c5b?s=128&d=identicon&r=PG", "display_name": "DrakePro", "link": "https://stackoverflow.com/users/2130154/drakepro"}, "is_accepted": false, "score": 0, "last_activity_date": 1437667945, "creation_date": 1437667945, "answer_id": 31592750, "question_id": 31574213, "link": "https://stackoverflow.com/questions/31574213/transfer-excel-pivot-table-to-access/31592750#31592750", "title": "Transfer Excel Pivot table to Access", "body": "<p>You could also double click on grand total in pivot table to un-pivot it, but if its not pivot table you can't un-pivot it.</p>\n"}], "owner": {"reputation": 21, "user_id": 5145470, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aea553b9c0e4266c882c36bfeb470eef?s=128&d=identicon&r=PG&f=1", "display_name": "Jay Zimmerman", "link": "https://stackoverflow.com/users/5145470/jay-zimmerman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 945, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1437667945, "creation_date": 1437600106, "last_edit_date": 1437654330, "question_id": 31574213, "link": "https://stackoverflow.com/questions/31574213/transfer-excel-pivot-table-to-access", "title": "Transfer Excel Pivot table to Access", "body": "<p>I am currently working with a large set of data in excel, a pivot table of 35X42380. We needed to transfer this data into an access database, but doing this with a line by line macro was a nightmare, after 40 minutes of hanging I gave up.</p>\n\n<p>I was wondering if there is a fast way to unpivot this table to transfer to Access.</p>\n\n<p>the data resembles:</p>\n\n<pre><code>Zip     |   80   |    81   |    82   |\n\n00501   | 1.0040 |  0.8963 |  0.7707 |\n\n00544   | 1.0040 |  0.8963 |  0.7707 |\n\n01001   | 0.6721 |  0.6614 |  0.6342 |\n\n01002   | 0.6721 |  0.6614 |  0.6342 |\n</code></pre>\n\n<p>the big issue i'm having is that the zip column is A3:42380, the 35 ids are AM2:BU2, and the pivot table is AM3:BU42380</p>\n\n<p>What I would like is:</p>\n\n<p>Product |   Zip |   Factor</p>\n\n<p>80   |  00501   |   1.0040</p>\n\n<p>Forgive me in advance for my terrible formatting. </p>\n\n<p>Also, I cannot easily change the format of the table, so avoiding that would be a plus. </p>\n\n<p>Thanks,</p>\n\n<p>Jay</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 132, "user_id": 5087031, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RNp2u.jpg?s=128&g=1", "display_name": "Thrillho", "link": "https://stackoverflow.com/users/5087031/thrillho"}, "edited": false, "score": 0, "creation_date": 1437601346, "post_id": 31574288, "comment_id": 51103915, "body": "Thank you, so far it is great and it is my fault for not explaining the formula. I would like it to sum the values between the second row of the column and the new break that has been added. So something like &quot;=sum(AA2:AAi)&quot;. As you can see this is not my area of expertise"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 132, "user_id": 5087031, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RNp2u.jpg?s=128&g=1", "display_name": "Thrillho", "link": "https://stackoverflow.com/users/5087031/thrillho"}, "edited": false, "score": 0, "creation_date": 1437601670, "post_id": 31574288, "comment_id": 51104046, "body": "I&#39;ve added a <a href=\"https://support.office.com/en-us/article/sum-function-0761ed42-45aa-4267-a9fc-a88a058c1a57\" rel=\"nofollow noreferrer\">SUM function</a> that sums from AA2 to the row immediately above where the formula is placed. The last summation formula at hte bottom did cause me some concern; is it supposed to be summing column Z?"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 0, "last_activity_date": 1437601548, "last_edit_date": 1437601548, "creation_date": 1437600422, "answer_id": 31574288, "question_id": 31574053, "link": "https://stackoverflow.com/questions/31574053/how-do-you-insert-rows-with-a-vba-and-then-write-a-formula-in-them/31574288#31574288", "title": "How do you insert rows with a VBA and then write a formula in them?", "body": "<p>You've made no mention of what sort of formula you would 'like to add formulas to the middle row of the three that I just added' so I've left in a placeholder.</p>\n\n<pre><code>Dim LastRow As Long, i As Long, lr As Long\n\nWith Sheets(\"Sheet5\")   'set this worksheet reference properly!\n    LastRow = .Cells(Rows.Count, \"AA\").End(xlUp).Row\n\n    For i = LastRow To 3 Step -1\n        If .Cells(i, \"AA\").Value &lt;&gt; .Cells(i - 1, \"AA\").Value Then\n            .Cells(i, \"AA\").Resize(3, 1).EntireRow.Insert\n            .Cells(i + 1, \"AA\").Formula = \"=SUM(AA2:AA\" &amp; i &amp; \")\"\n        End If\n    Next i\n\n    lr = .Range(\"AA\" &amp; Rows.Count).End(xlUp).Row\n    .Range(\"AA1:AA\" &amp; lr).Interior.Color = RGB(217, 217, 217)\n    .Range(\"AA\" &amp; lr + 2).Formula = \"=SUM(Z2:Z\" &amp; lr &amp; \")\"\nEnd With\n</code></pre>\n\n<p>There is also no mention of looking for and possibly removing previous summation formula(s) at hte bottom of the column that may have been left from previous run-throughs but I would suppose that this is to be performed on raw data each time.</p>\n"}], "owner": {"reputation": 132, "user_id": 5087031, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RNp2u.jpg?s=128&g=1", "display_name": "Thrillho", "link": "https://stackoverflow.com/users/5087031/thrillho"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 73, "favorite_count": 0, "accepted_answer_id": 31574288, "answer_count": 1, "score": 1, "last_activity_date": 1437601548, "creation_date": 1437599495, "last_edit_date": 1437600030, "question_id": 31574053, "link": "https://stackoverflow.com/questions/31574053/how-do-you-insert-rows-with-a-vba-and-then-write-a-formula-in-them", "title": "How do you insert rows with a VBA and then write a formula in them?", "body": "<p>I don't believe this has already been asked or that anything similar has been asked. I am trying to separate my data set based on the values in a column. I would then like to insert 3 rows between them. Finally I would like to add formulas to the middle row of the three that I just added. My Frankenstein's code (made up from others bits and pieces) is:</p>\n\n<pre><code>Dim LastRow As Long\nDim i As Long\n\nLastRow = Cells(Rows.Count, \"AA\").End(xlUp).Row\n\nFor i = LastRow To 2 Step -1\n    If i = 2 Then\n        'Do nothing\n    ElseIf Cells(i, \"AA\") &lt;&gt; Cells(i - 1, \"AA\") Then\n        Rows(i).Select\n        Selection.Insert Shift:=xlDown\n        Selection.Insert Shift:=xlDown\n        Selection.Insert Shift:=xlDown\n    End If\nNext i\n\nLR = Range(\"AA\" &amp; Rows.Count).End(xlUp).Row\nRange(\"AA1:AA\" &amp; LR &amp; \"\").Interior.Color = RGB(217, 217, 217)\nRange(\"AA\" &amp; LR + 2).Formula = \"=SUM(Z2:Z\" &amp; LR &amp; \")\"\n</code></pre>\n\n<p>As I am sure you'll notice the summation is after the bottom row and is for the whole column.</p>\n\n<p>Thank you for any help you can give</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 6311, "user_id": 5073840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yRIIb.jpg?s=128&g=1", "display_name": "MatthewD", "link": "https://stackoverflow.com/users/5073840/matthewd"}, "reply_to_user": {"reputation": 19, "user_id": 5041719, "user_type": "registered", "accept_rate": 0, "profile_image": "https://graph.facebook.com/10152965320513596/picture?type=large", "display_name": "Elias A. Stern-Rodriguez", "link": "https://stackoverflow.com/users/5041719/elias-a-stern-rodriguez"}, "edited": false, "score": 0, "creation_date": 1437601516, "post_id": 31573781, "comment_id": 51103971, "body": "@Elias A. Stern-Rodriguez No problem, please accept it as the answer."}], "tags": [], "owner": {"reputation": 6311, "user_id": 5073840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yRIIb.jpg?s=128&g=1", "display_name": "MatthewD", "link": "https://stackoverflow.com/users/5073840/matthewd"}, "is_accepted": false, "score": 1, "last_activity_date": 1437598355, "creation_date": 1437598355, "answer_id": 31573781, "question_id": 31573701, "link": "https://stackoverflow.com/questions/31573701/excel-not-keeping-values-as-dates-but-changes-them-to-numbers/31573781#31573781", "title": "Excel not keeping values as dates but changes them to numbers", "body": "<p>Try formatting the columns that have a date.</p>\n\n<pre><code>Sheets(\"Sales\").Range(\"A:A\").NumberFormat = \"yyyy-mm-dd\"\nSheets(\"Sales\").Range(\"E:E\").NumberFormat = \"yyyy-mm-dd\"\n</code></pre>\n\n<p>If you have a header row and you want to not format that you can define start and end rows in your range</p>\n\n<pre><code>Dim lRow as Long\nlRow = ws.UsedRange.Rows.count\n\nSheets(\"Sales\").Range(\"A2:A\" &amp; lRow).NumberFormat = \"yyyy-mm-dd\"\nSheets(\"Sales\").Range(\"E2:E\" &amp; lRow).NumberFormat = \"yyyy-mm-dd\"\n</code></pre>\n"}], "owner": {"reputation": 19, "user_id": 5041719, "user_type": "registered", "accept_rate": 0, "profile_image": "https://graph.facebook.com/10152965320513596/picture?type=large", "display_name": "Elias A. Stern-Rodriguez", "link": "https://stackoverflow.com/users/5041719/elias-a-stern-rodriguez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 42, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1437598355, "creation_date": 1437598100, "question_id": 31573701, "link": "https://stackoverflow.com/questions/31573701/excel-not-keeping-values-as-dates-but-changes-them-to-numbers", "title": "Excel not keeping values as dates but changes them to numbers", "body": "<p>This code is supposed to copy the sales sheet from a sales template, paste this template onto a new sheet, check column BI for a date, and if there is a date, to delete the row containing the date and move it to the new sheet. everything seems to be working except that excel is changing the formatting of column BI from a date to a string of numbers. does anybody know why this is? thanks so much,\nelias</p>\n\n<pre><code>Sheets(\"Sales\").Select\nSheets(\"Salestemplate\").visible = True\nSheets.Add After:=ActiveSheet\nActiveSheet.Select\nActiveSheet.Name = \"Last Month's Sales\"\nSheets(\"Salestemplate\").Select\nCells.Select\nRange(\"AI1\").Activate\nSelection.Copy\nSheets(\"Last Month's Sales\").Select\nRange(\"A1\").Select\nActiveSheet.Paste\nSheets(\"Sales\").Select\nRange(\"BI8\").ClearContents\nColumns(\"BI:BI\").Select\nApplication.CutCopyMode = False\nColumns(\"BI:BI\").Select\nSelection.SpecialCells(xlCellTypeConstants).EntireRow.Select\nSelection.Copy\nSheets(\"Last Month's Sales\").Select\nRange(\"A9\").PasteSpecial Paste:=xlPasteValues\nSheets(\"Sales\").Select\nColumns(\"BI:BI\").Select\nSelection.SpecialCells(xlCellTypeConstants).EntireRow.Delete\nRange(\"B8\").Value = DTA\n</code></pre>\n"}, {"tags": ["sql", "vba", "ms-access", "ms-access-2010"], "comments": [{"owner": {"reputation": 1106495, "user_id": 1144035, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e514b017977ebf742a418cac697d8996?s=128&d=identicon&r=PG", "display_name": "Gordon Linoff", "link": "https://stackoverflow.com/users/1144035/gordon-linoff"}, "edited": false, "score": 1, "creation_date": 1437598049, "post_id": 31573627, "comment_id": 51102259, "body": "MS Access does not support <code>INFORMATION_SCHEMA</code>."}, {"owner": {"reputation": 875, "user_id": 3612914, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/26500b9a2376eaf42a510a6c137ffe43?s=128&d=identicon&r=PG&f=1", "display_name": "sam", "link": "https://stackoverflow.com/users/3612914/sam"}, "reply_to_user": {"reputation": 1106495, "user_id": 1144035, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e514b017977ebf742a418cac697d8996?s=128&d=identicon&r=PG", "display_name": "Gordon Linoff", "link": "https://stackoverflow.com/users/1144035/gordon-linoff"}, "edited": false, "score": 0, "creation_date": 1437598185, "post_id": 31573627, "comment_id": 51102336, "body": "Is there any way to a find a table which contains specified column name in access"}, {"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 1, "creation_date": 1437599929, "post_id": 31573627, "comment_id": 51103263, "body": "Yes, but not with Access SQL."}, {"owner": {"reputation": 10018, "user_id": 1309356, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o45P6.png?s=128&g=1", "display_name": "cha", "link": "https://stackoverflow.com/users/1309356/cha"}, "edited": false, "score": 1, "creation_date": 1437615684, "post_id": 31573627, "comment_id": 51108074, "body": "have a look at the <a href=\"https://msdn.microsoft.com/en-us/library/bb243648%28v=office.12%29.aspx\" rel=\"nofollow noreferrer\">TableDefs</a> collection. Enumerate it to list all tables. Then use the TableDef for each table to lookup for the field in its Fields collection. Example&#39;s <a href=\"https://msdn.microsoft.com/en-us/library/bb177463%28v=office.12%29.aspx\" rel=\"nofollow noreferrer\">here</a>"}], "owner": {"reputation": 875, "user_id": 3612914, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/26500b9a2376eaf42a510a6c137ffe43?s=128&d=identicon&r=PG&f=1", "display_name": "sam", "link": "https://stackoverflow.com/users/3612914/sam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 817, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1534161077, "creation_date": 1437597809, "last_edit_date": 1534161077, "question_id": 31573627, "link": "https://stackoverflow.com/questions/31573627/find-tables-which-contain-a-certain-column-in-an-access-database", "title": "Find tables which contain a certain column in an Access database?", "body": "<p>I'm trying to find specified column named <code>deals</code> in large number of tables that exist in my database by using the below SQL query in VBA. </p>\n\n<pre><code>   fndtble = \"SELECT DISTINCT \" &amp; _\n   \"TABLE_NAME As tblname FROM \" &amp; _\n   \"INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME = 'deals'\"\n</code></pre>\n\n<p>I'm getting this runtime error: </p>\n\n<blockquote>\n  <p>3024 couldn't find file INFORMATION_SCHEMA.mdb</p>\n</blockquote>\n\n<p>Any idea to solve this error?</p>\n"}, {"tags": ["excel", "vba", "debugging"], "comments": [{"owner": {"reputation": 3650, "user_id": 5090027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/904db949ae64fe1a63ea8b4c677e6d57?s=128&d=identicon&r=PG&f=1", "display_name": "Grade &#39;Eh&#39; Bacon", "link": "https://stackoverflow.com/users/5090027/grade-eh-bacon"}, "edited": false, "score": 1, "creation_date": 1437595250, "post_id": 31572772, "comment_id": 51100542, "body": "Have you tried throwing a msgbox / debug.print into your code right after the point where you think it fails, to see how far it gets on its own? ie: put it right before &#39;EXIT SUB&#39;. Does it make it there, or does it error out somewhere before that? Have you tried running it by F8 again, or did it only run fine once? Maybe after you ran it the first time something changed?"}, {"owner": {"reputation": 558, "user_id": 4686873, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/e8ed25ac033b2a31f8d90013d39089ce?s=128&d=identicon&r=PG&f=1", "display_name": "Ihidan", "link": "https://stackoverflow.com/users/4686873/ihidan"}, "reply_to_user": {"reputation": 3650, "user_id": 5090027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/904db949ae64fe1a63ea8b4c677e6d57?s=128&d=identicon&r=PG&f=1", "display_name": "Grade &#39;Eh&#39; Bacon", "link": "https://stackoverflow.com/users/5090027/grade-eh-bacon"}, "edited": false, "score": 0, "creation_date": 1437595460, "post_id": 31572772, "comment_id": 51100674, "body": "I&#39;ve run it several times it always works with F8 never with F5. The code dies at:  Sheets(&quot;Calculos&quot;).Copy Before:=PlanilhaMarkowitz.Sheets(sheetIndex)"}], "answers": [{"comments": [{"owner": {"reputation": 558, "user_id": 4686873, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/e8ed25ac033b2a31f8d90013d39089ce?s=128&d=identicon&r=PG&f=1", "display_name": "Ihidan", "link": "https://stackoverflow.com/users/4686873/ihidan"}, "edited": false, "score": 0, "creation_date": 1437596009, "post_id": 31572917, "comment_id": 51101010, "body": "It is working now.  I am still curious about why this happens."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 558, "user_id": 4686873, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/e8ed25ac033b2a31f8d90013d39089ce?s=128&d=identicon&r=PG&f=1", "display_name": "Ihidan", "link": "https://stackoverflow.com/users/4686873/ihidan"}, "edited": false, "score": 1, "creation_date": 1437596482, "post_id": 31572917, "comment_id": 51101314, "body": "All of the <code>Sheets</code> references relied upon whatever was the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff821871.aspx\" rel=\"nofollow noreferrer\">ActiveWorkbook property</a> to determine what their parent workbook was. As soon as you copied the first, the ActiveWorkbook was changed to the one that just received the first copied worksheet. This switch in the ActiveWorkbook is the default behavior. Subsequent attempts to copy worksheets were looking in the new target workbook for the worksheet to copy. Using the <a href=\"https://msdn.microsoft.com/en-us/library/wc500chb.aspx\" rel=\"nofollow noreferrer\">With ... End With statement</a> defined the parent."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 1, "last_activity_date": 1437595335, "last_edit_date": 1495535059, "creation_date": 1437595335, "answer_id": 31572917, "question_id": 31572772, "link": "https://stackoverflow.com/questions/31572772/code-runs-when-debbuging-f8-but-doesnt-run-normally-f5/31572917#31572917", "title": "Code runs when debbuging (F8) but doesn&#39;t run normally (F5)", "body": "<p>Don't rely on <a href=\"https://msdn.microsoft.com/en-us/library/office/aa220735%28v=office.11%29.aspx\" rel=\"nofollow noreferrer\">.Activate</a>. The action of copying a worksheet to the new workbook is changing the activeworkbook.</p>\n\n<pre><code>Sub GeneratesWorkbook()\n\n    On Error GoTo LabelErro\n\n\n    Dim PlanilhaMarkowitz As Workbook\n    Set PlanilhaMarkowitz = Workbooks.Add\n\n    Dim currentSheet As Worksheet\n    Dim sheetIndex As Integer\n    sheetIndex = 1\n\n    With ThisWorkbook\n        'Changes xlam property to false so I can copy Xlam sheets to new wb\n        .IsAddin = False\n\n        'Copy Xlam's sheets to new workbook\n        .Sheets(\"Hidden\").Visible = True 'this workbook was very hidden so I make it visible to copy\n        .Sheets(\"Hidden\").Copy Before:=PlanilhaMarkowitz.Sheets(sheetIndex)\n        .Sheets(\"Hidden\").Visible = xlVeryHidden\n\n        .Sheets(\"Calculos\").Copy Before:=PlanilhaMarkowitz.Sheets(sheetIndex)\n\n        .Sheets(\"Pesos\").Copy Before:=PlanilhaMarkowitz.Sheets(sheetIndex)\n\n        .Sheets(\"Atributos\").Visible = True 'this workbook was very hidden so I make it visible to copy\n        .Sheets(\"Atributos\").Copy Before:=PlanilhaMarkowitz.Sheets(sheetIndex)\n        .Sheets(\"Atributos\").Visible = xlVeryHidden\n\n        .Sheets(\"Correl\").Copy Before:=PlanilhaMarkowitz.Sheets(sheetIndex)\n\n        .Sheets(\"Fronteira\").Copy Before:=PlanilhaMarkowitz.Sheets(sheetIndex)\n\n        .IsAddin = True\n\n    End With\n\n    Exit Sub\n\nLabelErro:\n\n    ThisWorkbook.IsAddin = True\n\nEnd Sub\n</code></pre>\n\n<p>See <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba-macros\">How to avoid using Select in Excel VBA macros</a> for more methods on getting away from relying on select and activate to accomplish your goals.</p>\n"}], "owner": {"reputation": 558, "user_id": 4686873, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/e8ed25ac033b2a31f8d90013d39089ce?s=128&d=identicon&r=PG&f=1", "display_name": "Ihidan", "link": "https://stackoverflow.com/users/4686873/ihidan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2752, "favorite_count": 0, "accepted_answer_id": 31572917, "answer_count": 1, "score": 0, "last_activity_date": 1437595335, "creation_date": 1437594815, "question_id": 31572772, "link": "https://stackoverflow.com/questions/31572772/code-runs-when-debbuging-f8-but-doesnt-run-normally-f5", "title": "Code runs when debbuging (F8) but doesn&#39;t run normally (F5)", "body": "<p>The following code is triggered when the user press a button from my add-in tab:</p>\n\n<pre><code>Sub OnActionListaMarkowitz(control As IRibbonControl)\n\n    GeneratesWorkbook\n\nEnd Sub\n</code></pre>\n\n<p>In a different modules I have a sub to create a new workbook and copy the sheets in my Xlam file to the new workbook.</p>\n\n<pre><code>Sub GeneratesWorkbook()\n\nOn Error GoTo LabelErro\n\n\nSet PlanilhaMarkowitz = Workbooks.Add\n\nDim currentSheet As Worksheet\nDim sheetIndex As Integer\nsheetIndex = 1\n\n    'Changes xlam property to false so I can copy Xlam sheets to new wb\n    ThisWorkbook.IsAddin = False\n    ThisWorkbook.Activate\n\n    'Copy Xlam's sheets to new workbook \n    Sheets(\"Hidden\").Visible = True 'this workbook was very hidden so I make it visible to copy\n    Sheets(\"Hidden\").Copy Before:=PlanilhaMarkowitz.Sheets(sheetIndex)\n    Sheets(\"Hidden\").Visible = xlVeryHidden\n\n    Sheets(\"Calculos\").Copy Before:=PlanilhaMarkowitz.Sheets(sheetIndex)\n\n    Sheets(\"Pesos\").Copy Before:=PlanilhaMarkowitz.Sheets(sheetIndex)\n\n    Sheets(\"Atributos\").Visible = True 'this workbook was very hidden so I make it visible to copy\n    Sheets(\"Atributos\").Copy Before:=PlanilhaMarkowitz.Sheets(sheetIndex)\n    Sheets(\"Atributos\").Visible = xlVeryHidden\n\n    Sheets(\"Correl\").Copy Before:=PlanilhaMarkowitz.Sheets(sheetIndex)\n\n    Sheets(\"Fronteira\").Copy Before:=PlanilhaMarkowitz.Sheets(sheetIndex)\n\n    ThisWorkbook.IsAddin = True\n\n    Exit Sub\n\nLabelErro:\n\n        ThisWorkbook.IsAddin = True\n\nEnd Sub\n</code></pre>\n\n<p>The odd part of it is that if I execute this code by pressing F8 (step by step) It works perfectly. But If I run this code normally or using F5 it only copy the worksheet(\"Hidden\").</p>\n\n<p>I've set a breakpoint at </p>\n\n<pre><code>Sheets(\"Hidden\").Visible = True\n</code></pre>\n\n<p>Pressing F8 till the end of the two subs makes it work. Pressing F5 doesn't.</p>\n"}, {"tags": ["database", "ms-access", "vba", "ms-access-2007"], "comments": [{"owner": {"reputation": 3145, "user_id": 4560433, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/412786b272a5c096e45967bc79cde0a9?s=128&d=identicon&r=PG&f=1", "display_name": "OpiesDad", "link": "https://stackoverflow.com/users/4560433/opiesdad"}, "edited": false, "score": 0, "creation_date": 1437595392, "post_id": 31572415, "comment_id": 51100634, "body": "I can&#39;t see your picture, and I think I might have answered this incorrectly.  What are the headers and results you are looking for in your table?"}, {"owner": {"reputation": 53, "user_id": 3840272, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/84eb3a4a9502731f244afb55f7722469?s=128&d=identicon&r=PG&f=1", "display_name": "hanznv", "link": "https://stackoverflow.com/users/3840272/hanznv"}, "reply_to_user": {"reputation": 3145, "user_id": 4560433, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/412786b272a5c096e45967bc79cde0a9?s=128&d=identicon&r=PG&f=1", "display_name": "OpiesDad", "link": "https://stackoverflow.com/users/4560433/opiesdad"}, "edited": false, "score": 0, "creation_date": 1437601295, "post_id": 31572415, "comment_id": 51103895, "body": "Is it woking now?:) <a href=\"http://oi57.tinypic.com/161xjde.jpg\" rel=\"nofollow noreferrer\">oi57.tinypic.com/161xjde.jpg</a>"}, {"owner": {"reputation": 3145, "user_id": 4560433, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/412786b272a5c096e45967bc79cde0a9?s=128&d=identicon&r=PG&f=1", "display_name": "OpiesDad", "link": "https://stackoverflow.com/users/4560433/opiesdad"}, "edited": false, "score": 0, "creation_date": 1437601579, "post_id": 31572415, "comment_id": 51103999, "body": "I&#39;m at work all of these sites are blocked, I should have been clearer in my last comment."}, {"owner": {"reputation": 53, "user_id": 3840272, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/84eb3a4a9502731f244afb55f7722469?s=128&d=identicon&r=PG&f=1", "display_name": "hanznv", "link": "https://stackoverflow.com/users/3840272/hanznv"}, "reply_to_user": {"reputation": 3145, "user_id": 4560433, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/412786b272a5c096e45967bc79cde0a9?s=128&d=identicon&r=PG&f=1", "display_name": "OpiesDad", "link": "https://stackoverflow.com/users/4560433/opiesdad"}, "edited": false, "score": 0, "creation_date": 1437601683, "post_id": 31572415, "comment_id": 51104058, "body": "the result table should have 4 columns (code, year 2011, year 2012, year 2013, year 2014). In column code is all unique codes from all tables. In column year 2011 is how many times is code in table Year2011. In column year 2012 is how many times is code in table Year2012."}, {"owner": {"reputation": 53, "user_id": 3840272, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/84eb3a4a9502731f244afb55f7722469?s=128&d=identicon&r=PG&f=1", "display_name": "hanznv", "link": "https://stackoverflow.com/users/3840272/hanznv"}, "reply_to_user": {"reputation": 3145, "user_id": 4560433, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/412786b272a5c096e45967bc79cde0a9?s=128&d=identicon&r=PG&f=1", "display_name": "OpiesDad", "link": "https://stackoverflow.com/users/4560433/opiesdad"}, "edited": false, "score": 0, "creation_date": 1437601854, "post_id": 31572415, "comment_id": 51104131, "body": "In one table can be one code many times. so the result is: code (575674) is in the table 2011 (5X) in 2012 (2X) in 2013 (8X) in 2014 (1X) and i want to do this for all unique codes in all tables ..is that possible?"}, {"owner": {"reputation": 3145, "user_id": 4560433, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/412786b272a5c096e45967bc79cde0a9?s=128&d=identicon&r=PG&f=1", "display_name": "OpiesDad", "link": "https://stackoverflow.com/users/4560433/opiesdad"}, "edited": false, "score": 0, "creation_date": 1437602441, "post_id": 31572415, "comment_id": 51104365, "body": "See edited answer.  That should do it."}], "answers": [{"comments": [{"owner": {"reputation": 53, "user_id": 3840272, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/84eb3a4a9502731f244afb55f7722469?s=128&d=identicon&r=PG&f=1", "display_name": "hanznv", "link": "https://stackoverflow.com/users/3840272/hanznv"}, "edited": false, "score": 0, "creation_date": 1437603363, "post_id": 31572908, "comment_id": 51104778, "body": "thank you very much, you really help me a lot ! :-) if you have time can you please help me.. if i dont want to search by all Code characters, but only firts 8 charakters.. for example original Code is 1234A12345, but in results table is counted Codes with same first characters 1234A123"}, {"owner": {"reputation": 3145, "user_id": 4560433, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/412786b272a5c096e45967bc79cde0a9?s=128&d=identicon&r=PG&f=1", "display_name": "OpiesDad", "link": "https://stackoverflow.com/users/4560433/opiesdad"}, "reply_to_user": {"reputation": 53, "user_id": 3840272, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/84eb3a4a9502731f244afb55f7722469?s=128&d=identicon&r=PG&f=1", "display_name": "hanznv", "link": "https://stackoverflow.com/users/3840272/hanznv"}, "edited": false, "score": 0, "creation_date": 1437659042, "post_id": 31572908, "comment_id": 51130225, "body": "Use the Left() function on the field.  So for instance, SELECT Left(Code, 8) As Code, Count(Left(Code, 8)) As c2014 ..... FROM tbl2014 GROUP BY Left(Code, 8)..."}, {"owner": {"reputation": 3145, "user_id": 4560433, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/412786b272a5c096e45967bc79cde0a9?s=128&d=identicon&r=PG&f=1", "display_name": "OpiesDad", "link": "https://stackoverflow.com/users/4560433/opiesdad"}, "reply_to_user": {"reputation": 53, "user_id": 3840272, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/84eb3a4a9502731f244afb55f7722469?s=128&d=identicon&r=PG&f=1", "display_name": "hanznv", "link": "https://stackoverflow.com/users/3840272/hanznv"}, "edited": false, "score": 0, "creation_date": 1437659056, "post_id": 31572908, "comment_id": 51130235, "body": "Also, please mark this as the answer if it answers your question."}], "tags": [], "owner": {"reputation": 3145, "user_id": 4560433, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/412786b272a5c096e45967bc79cde0a9?s=128&d=identicon&r=PG&f=1", "display_name": "OpiesDad", "link": "https://stackoverflow.com/users/4560433/opiesdad"}, "is_accepted": true, "score": 0, "last_activity_date": 1437602419, "last_edit_date": 1437602419, "creation_date": 1437595284, "answer_id": 31572908, "question_id": 31572415, "link": "https://stackoverflow.com/questions/31572415/ms-access-tables-analysis/31572908#31572908", "title": "MS Access tables analysis", "body": "<p>Make a new query and put this in as the SQL:</p>\n\n<pre><code> SELECT DISTINCT 2014 As Year, tblCombined.Code \n INTO tblNEWTABLE \n FROM (SELECT Code FROM tbl2014 \n       UNION ALL \n       SELECT Code FROM tbl2013 \n       UNION ALL \n       SELECT Code FROM tbl2012 \n       UNION ALL \n       SELECT Code FROM tbl2011) As tblCombined \n</code></pre>\n\n<p>where \"Code\" is the name of the field and \"tbl2014\" etc are the names of the tables.</p>\n\n<p>You may be looking for this:</p>\n\n<pre><code> SELECT tblCombined.Code, Sum(tblCombined.C2014) As Count2014\n        , Sum(tblCombined.C2013) As Count2013\n        , Sum(tblCombined.C2012) As Count2012\n        , Sum(tblCombined.C2011) As Count2011\n INTO tblNEWTABLE \n FROM (SELECT Code, Count(Code) As C2014, 0 As C2013, 0 As C2012, 0 As C2011\n       FROM tbl2014 GROUP BY Code\n       UNION ALL \n       SELECT Code, 0 As C2014, Count(Code) As C2013, 0 As C2012, 0 As C2011\n       FROM tbl2013 GROUP BY Code           \n       UNION ALL \n       SELECT Code, 0 As C2014, 0 As C2013, Count(Code) As C2012, 0 As C2011\n       FROM tbl2012 GROUP BY Code\n       UNION ALL \n       SELECT Code, 0 As C2014, 0 As C2013, 0 As C2012, Count(Code) As C2011\n       FROM tbl2011 GROUP BY Code\n      ) As tblCombined \nGROUP BY tblCombined.Code\n</code></pre>\n\n<p>This should give you the count of records having each code for each year.\nThis is likely not the most efficient way to do this, but it should work.</p>\n\n<p>You could also use a \"CROSSTAB\" query, but this solution will work too.</p>\n"}], "owner": {"reputation": 53, "user_id": 3840272, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/84eb3a4a9502731f244afb55f7722469?s=128&d=identicon&r=PG&f=1", "display_name": "hanznv", "link": "https://stackoverflow.com/users/3840272/hanznv"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 35, "favorite_count": 0, "accepted_answer_id": 31572908, "answer_count": 1, "score": 0, "last_activity_date": 1437602419, "creation_date": 1437593689, "question_id": 31572415, "link": "https://stackoverflow.com/questions/31572415/ms-access-tables-analysis", "title": "MS Access tables analysis", "body": "<p>I have in my database 4 tables (years 2014,2013,2012,2011) and each of them have same column CODE. I would like to create a new table like this :</p>\n\n<p><a href=\"http://i.imgur.com/yeQIfYR.png\" rel=\"nofollow\">TABLE IMG</a></p>\n\n<p>where \n<strong>codes</strong> is: all unique codes in all four tables \nand <strong>year 2014</strong>: how many times is for example code 6602658 in this table ?</p>\n\n<p>Thanks for any advice :-)</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1396, "user_id": 4691433, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/bce001c90ad26add5d7483b714640c12?s=128&d=identicon&r=PG&f=1", "display_name": "puzzlepiece87", "link": "https://stackoverflow.com/users/4691433/puzzlepiece87"}, "edited": false, "score": 0, "creation_date": 1437594390, "post_id": 31572334, "comment_id": 51100023, "body": "stucharo&#39;s answer below is better than what I was going to share, but you may be interested to know that I have never had success applying a formula to a range. I think it can apply to individual cells only. To apply it to an entire range, use a <code>For Each (Range variable) in (Range Variable)</code> loop."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1437598392, "post_id": 31572334, "comment_id": 51102459, "body": "You cannot add addition two-line routines like you have above because you are overwriting the value in A2 and cannot expect to keep reevaluating the original value once you have overwritten it. The formula you are stuffing into A2 is also a circular reference so its a bit of a mystery why it is working at all. While the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff193019.aspx\" rel=\"nofollow noreferrer\">Application.Evaluate method</a> could be used to determine the result of the formula, the method is clunky and the Select Case ... End Select is a much better fit."}], "answers": [{"comments": [{"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1437595049, "post_id": 31572563, "comment_id": 51100412, "body": "The question is why three nested if statements won&#39;t work XD"}, {"owner": {"reputation": 3650, "user_id": 5090027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/904db949ae64fe1a63ea8b4c677e6d57?s=128&d=identicon&r=PG&f=1", "display_name": "Grade &#39;Eh&#39; Bacon", "link": "https://stackoverflow.com/users/5090027/grade-eh-bacon"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1437595427, "post_id": 31572563, "comment_id": 51100651, "body": "@findwindow Using Select Case is somewhat cleaner, because it only declares the testing variable once. This makes it easier to read (once you are familiar with the construct), and also saves a bit of processing power because the formula is calculated once, then stored, and referred to wihtout being evaluated multiple times. Dozens of ways to skin the cat..."}, {"owner": {"reputation": 869, "user_id": 4437159, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a32f5d6d49f7d05252f3fc8cc526763?s=128&d=identicon&r=PG&f=1", "display_name": "stucharo", "link": "https://stackoverflow.com/users/4437159/stucharo"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1437595445, "post_id": 31572563, "comment_id": 51100664, "body": "@findwindow very good, although If we&#39;re being pedantic there ony was a statement that the code wouldn&#39;t work.  The question was how to add multiple rules and a <code>Select Case</code> is by far the easiest.  Plus trying to nest those <code>If</code>&#39;s over any array length was a headache I couldn&#39;t bring myself to attempt :P"}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "reply_to_user": {"reputation": 3650, "user_id": 5090027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/904db949ae64fe1a63ea8b4c677e6d57?s=128&d=identicon&r=PG&f=1", "display_name": "Grade &#39;Eh&#39; Bacon", "link": "https://stackoverflow.com/users/5090027/grade-eh-bacon"}, "edited": false, "score": 0, "creation_date": 1437596631, "post_id": 31572563, "comment_id": 51101418, "body": "@Grade&#39;Eh&#39;Bacon Ahhh, the pros have a grasp of how architecture affects processing power ^_^;"}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1437596637, "post_id": 31572563, "comment_id": 51101422, "body": "@stucharo Yours is definitely better for longevity ^_^"}, {"owner": {"reputation": 61, "user_id": 1981949, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/b888912c657f22b1edfc28aef14a443e?s=128&d=identicon&r=PG", "display_name": "Php Newbie", "link": "https://stackoverflow.com/users/1981949/php-newbie"}, "edited": false, "score": 0, "creation_date": 1437598387, "post_id": 31572563, "comment_id": 51102455, "body": "@stucharo Thank you , it works perfectly but if I wanted to select just the first word in a sentence how would I do that? Eg if Hello I am Bob, and it realises that the word Hello is the first word in the sentence,  and then returns the word value in the Macro."}, {"owner": {"reputation": 869, "user_id": 4437159, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a32f5d6d49f7d05252f3fc8cc526763?s=128&d=identicon&r=PG&f=1", "display_name": "stucharo", "link": "https://stackoverflow.com/users/4437159/stucharo"}, "reply_to_user": {"reputation": 61, "user_id": 1981949, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/b888912c657f22b1edfc28aef14a443e?s=128&d=identicon&r=PG", "display_name": "Php Newbie", "link": "https://stackoverflow.com/users/1981949/php-newbie"}, "edited": false, "score": 0, "creation_date": 1437598852, "post_id": 31572563, "comment_id": 51102694, "body": "@PhpNewbie have a look at the <code>Split()</code> function.  It divdes a string into an array of strings based on a delimiter.  You can then pick the substring you want based on the index of the array."}, {"owner": {"reputation": 61, "user_id": 1981949, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/b888912c657f22b1edfc28aef14a443e?s=128&d=identicon&r=PG", "display_name": "Php Newbie", "link": "https://stackoverflow.com/users/1981949/php-newbie"}, "edited": false, "score": 0, "creation_date": 1437599476, "post_id": 31572563, "comment_id": 51102989, "body": "@stucharo that is way beyond my ability with vba I&#39;ve only started to use it 2 days ago"}, {"owner": {"reputation": 869, "user_id": 4437159, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a32f5d6d49f7d05252f3fc8cc526763?s=128&d=identicon&r=PG&f=1", "display_name": "stucharo", "link": "https://stackoverflow.com/users/4437159/stucharo"}, "reply_to_user": {"reputation": 61, "user_id": 1981949, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/b888912c657f22b1edfc28aef14a443e?s=128&d=identicon&r=PG", "display_name": "Php Newbie", "link": "https://stackoverflow.com/users/1981949/php-newbie"}, "edited": false, "score": 0, "creation_date": 1437599844, "post_id": 31572563, "comment_id": 51103201, "body": "@PhpNewbie that&#39;s ok, everyone has to start somewhere :) I&#39;ve edited my answer to include the <code>Split()</code> function.  The number in brackets following the function accesses that index of the array returned (arrays start at index 0 by default in VBA).  You should try and familiarise yourself with the MSDN reference.  It&#39;s a bit of a godsend sometimes.  The <code>Split()</code> function is described here - <a href=\"https://msdn.microsoft.com/en-us/library/6x627e5f%28v=vs.90%29.aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/6x627e5f%28v=vs.90%29.aspx</a>"}, {"owner": {"reputation": 61, "user_id": 1981949, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/b888912c657f22b1edfc28aef14a443e?s=128&d=identicon&r=PG", "display_name": "Php Newbie", "link": "https://stackoverflow.com/users/1981949/php-newbie"}, "edited": false, "score": 0, "creation_date": 1437600004, "post_id": 31572563, "comment_id": 51103296, "body": "@stucharo You are amazing!! Thank you so much"}, {"owner": {"reputation": 61, "user_id": 1981949, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/b888912c657f22b1edfc28aef14a443e?s=128&d=identicon&r=PG", "display_name": "Php Newbie", "link": "https://stackoverflow.com/users/1981949/php-newbie"}, "edited": false, "score": 0, "creation_date": 1438198642, "post_id": 31572563, "comment_id": 51357226, "body": "@stucharo sorry to be a pain in the bum, if I wanted to use the above for football teams locations in the same area how would I do it, eg Cardiff City vs Manchester United or Newport County vs Everton = Wales. is there a way for it to read everything before the vs I have tried changing the delimiter but it didn&#39;t work. I am trying to spilt teams into certain area of the country, so would need it to read the first team then output the region its in, eg wales, surrey, kent, cardiff, etc Thank you for all your help already, and I know its asking alot to help me again, but I have tried for 5 days."}, {"owner": {"reputation": 869, "user_id": 4437159, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a32f5d6d49f7d05252f3fc8cc526763?s=128&d=identicon&r=PG&f=1", "display_name": "stucharo", "link": "https://stackoverflow.com/users/4437159/stucharo"}, "reply_to_user": {"reputation": 61, "user_id": 1981949, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/b888912c657f22b1edfc28aef14a443e?s=128&d=identicon&r=PG", "display_name": "Php Newbie", "link": "https://stackoverflow.com/users/1981949/php-newbie"}, "edited": false, "score": 0, "creation_date": 1438257793, "post_id": 31572563, "comment_id": 51382794, "body": "@PhpNewbie try changing the delimiter from <code>&quot; &quot;</code> to <code>&quot; vs &quot;</code>.  Index <code>(0)</code> of the reulting array should now be the home team and you can select cases based on that"}, {"owner": {"reputation": 61, "user_id": 1981949, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/b888912c657f22b1edfc28aef14a443e?s=128&d=identicon&r=PG", "display_name": "Php Newbie", "link": "https://stackoverflow.com/users/1981949/php-newbie"}, "edited": false, "score": 0, "creation_date": 1438276020, "post_id": 31572563, "comment_id": 51395497, "body": "@stucharo thank you fro responding, I have tried the following; <code>Select Case Split(Cells(row, 3).Value, &quot;vs&quot;)(0)</code> and &#39;Select Case Split(Cells(row, 3).Value, &quot;vs&quot;).index(0)&#39; and Select Case Split(Cells(row, 3).Value, &quot;vs&quot;.index(0)) all of them throw up an error apart from the first one that doesn&#39;t throw up any error, but doesn&#39;t output anything. Sorry once again, and thank you for all your help, I am trying to learn, but I learn by seeing something working and then I reverse engineer it (if that makes sense."}, {"owner": {"reputation": 869, "user_id": 4437159, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a32f5d6d49f7d05252f3fc8cc526763?s=128&d=identicon&r=PG&f=1", "display_name": "stucharo", "link": "https://stackoverflow.com/users/4437159/stucharo"}, "reply_to_user": {"reputation": 61, "user_id": 1981949, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/b888912c657f22b1edfc28aef14a443e?s=128&d=identicon&r=PG", "display_name": "Php Newbie", "link": "https://stackoverflow.com/users/1981949/php-newbie"}, "edited": false, "score": 0, "creation_date": 1438276711, "post_id": 31572563, "comment_id": 51395935, "body": "@PhpNewbie have you encountered the Immediate Window yet?  If not, hit Ctrl+G in the VBE and it should pop up at the bottom.  You can enter expressions directly (starting with a &#39;?&#39; character) or output data using <code>Debug.Print</code> statements.  You should try placing <code>Debug.Print Cells(row,3).Value</code> on the line preceding the <code>Select Case...</code> and place a breakpoint on the <code>Select Case....</code> line.  This will print out what&#39;s being read by the <code>Cells()</code> property and let you make sure you&#39;re getting what you expect"}, {"owner": {"reputation": 61, "user_id": 1981949, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/b888912c657f22b1edfc28aef14a443e?s=128&d=identicon&r=PG", "display_name": "Php Newbie", "link": "https://stackoverflow.com/users/1981949/php-newbie"}, "edited": false, "score": 0, "creation_date": 1438277904, "post_id": 31572563, "comment_id": 51396618, "body": "@stucharo this is the output I get                                                                        <code>cardiff city v me Brighton and Hove Albion v hove Undy Athletic v New Port County Alfreton\u00a0Town v Derby County Colwyn\u00a0Bay\u00a0v Wrexham</code>"}, {"owner": {"reputation": 869, "user_id": 4437159, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a32f5d6d49f7d05252f3fc8cc526763?s=128&d=identicon&r=PG&f=1", "display_name": "stucharo", "link": "https://stackoverflow.com/users/4437159/stucharo"}, "reply_to_user": {"reputation": 61, "user_id": 1981949, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/b888912c657f22b1edfc28aef14a443e?s=128&d=identicon&r=PG", "display_name": "Php Newbie", "link": "https://stackoverflow.com/users/1981949/php-newbie"}, "edited": false, "score": 0, "creation_date": 1438278595, "post_id": 31572563, "comment_id": 51397033, "body": "@PhpNewbie in that case using <code>&quot; vs &quot;</code> as a delimiter will never work.....the teams are split by <code>&quot; v &quot;</code>.  Try using that instead......<code>Select Case Split(Cells(row, 3).Value, &quot; v &quot;)(0)</code>.  If the delimiter isn&#39;t found then the <code>Split()</code> function returns a single element array containing the entire string in the only element so it&#39;s unlikely that it would have matched any of your <code>Select Case</code>&#39;s."}, {"owner": {"reputation": 61, "user_id": 1981949, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/b888912c657f22b1edfc28aef14a443e?s=128&d=identicon&r=PG", "display_name": "Php Newbie", "link": "https://stackoverflow.com/users/1981949/php-newbie"}, "edited": false, "score": 0, "creation_date": 1438278706, "post_id": 31572563, "comment_id": 51397108, "body": "@stucharo, worked it out, totally my stupidity, I was using &quot;v&quot; instead of using the spaces so now I use  &quot; v &quot; as the delimiter and it works, thank you"}, {"owner": {"reputation": 61, "user_id": 1981949, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/b888912c657f22b1edfc28aef14a443e?s=128&d=identicon&r=PG", "display_name": "Php Newbie", "link": "https://stackoverflow.com/users/1981949/php-newbie"}, "reply_to_user": {"reputation": 869, "user_id": 4437159, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a32f5d6d49f7d05252f3fc8cc526763?s=128&d=identicon&r=PG&f=1", "display_name": "stucharo", "link": "https://stackoverflow.com/users/4437159/stucharo"}, "edited": false, "score": 0, "creation_date": 1438278735, "post_id": 31572563, "comment_id": 51397120, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/84726/discussion-between-php-newbie-and-stucharo\">continue this discussion in chat</a>."}], "tags": [], "owner": {"reputation": 869, "user_id": 4437159, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a32f5d6d49f7d05252f3fc8cc526763?s=128&d=identicon&r=PG&f=1", "display_name": "stucharo", "link": "https://stackoverflow.com/users/4437159/stucharo"}, "is_accepted": true, "score": 3, "last_activity_date": 1437599735, "last_edit_date": 1437599735, "creation_date": 1437594182, "answer_id": 31572563, "question_id": 31572334, "link": "https://stackoverflow.com/questions/31572334/vba-macro-help-need-for-excel/31572563#31572563", "title": "VBA Macro help need for Excel", "body": "<p>If you're going for a VBA approach then there's no real need to use <code>.Formula</code>.  VBA has a <code>Select Case</code> construct that lets you evaluate an expression and carry out a bunch of options based on the outcome of the expression.</p>\n\n<p>Try this:</p>\n\n<pre><code>Sub CheckValues()\n\n    Application.ScreenUpdating = False\n\n    Dim startRow As Integer\n    startRow = 2\n    Dim endRow As Integer\n    endRow = Range(\"A2\").End(xlDown).row\n\n    Dim row As Integer\n    Dim word As String\n\n    For row = startRow To endRow\n\n        Select Case Split(Cells(row, 1).Value, \" \")(0)\n\n            Case \"C\", \"9\"\n                word = \"Word0\"\n            Case \"HELLO\", \"GOODBYE\"\n                word = \"Word1\"\n            Case \"Pink\", \"Yellow\"\n                word = \"Word2\"\n            Case Else\n                word = \"\"\n\n        End Select\n\n        Cells(row, 5).Value = word\n\n    Next row\n\n    Application.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n\n<p>As you add more options for column a, you only need to repeat the <code>Case *expression*</code> pattern.</p>\n"}, {"tags": [], "owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "is_accepted": false, "score": 0, "last_activity_date": 1437601346, "creation_date": 1437601346, "answer_id": 31574502, "question_id": 31572334, "link": "https://stackoverflow.com/questions/31572334/vba-macro-help-need-for-excel/31574502#31574502", "title": "VBA Macro help need for Excel", "body": "<p>Or you could just amend your existing formula and do it without loops:</p>\n\n<pre><code>Sub SO()\n\nWith Range(\"B2:B\" &amp; Cells(Rows.Count, 2).End(xlUp).Row).Offset(, 3)\n    .FormulaR1C1 = \"=IFERROR(\"\"Word\"\"&amp;ROUNDDOWN((MATCH(LEFT(RC[-3],SEARCH(\"\" \"\",RC[-3])-1),{\"\"C\"\",\"\"9\"\",\"\"HELLO\"\",\"\"GOODBYE\"\",\"\"Pink\"\",\"\"Yellow\"\"},0)/2)-0.1,0),\"\"\"\")\"\n    .Value = .Value\nEnd With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 61, "user_id": 1981949, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/b888912c657f22b1edfc28aef14a443e?s=128&d=identicon&r=PG", "display_name": "Php Newbie", "link": "https://stackoverflow.com/users/1981949/php-newbie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 84, "favorite_count": 0, "accepted_answer_id": 31572563, "answer_count": 2, "score": 0, "last_activity_date": 1437601346, "creation_date": 1437593361, "last_edit_date": 1531164843, "question_id": 31572334, "link": "https://stackoverflow.com/questions/31572334/vba-macro-help-need-for-excel", "title": "VBA Macro help need for Excel", "body": "<p>Hello I hope this will make sense,</p>\n\n<p>I have found this script that if a letter or number is in one cell it will input a value in the another cell</p>\n\n<p>I was wondering how I could add multiple rules to this.At the moment if C or 9 is entered in a cell then it produces the sentence \"word here will show up\"</p>\n\n<p>I want it to show up in a different cell not the adjacent one, and also I want to be able to add different letter to the list to output different values.</p>\n\n<p>EG </p>\n\n<p>Cell Has This in Column A     &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  Output when Macro runs in Column E</p>\n\n<p>C or 9       &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                                     \"Word0\"</p>\n\n<p>HELLO OR GOODBYE  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                               \"Word1\"</p>\n\n<p>Pink or Yellow &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                                          \"Word2\"</p>\n\n<p>Etc,\n Any help would be great and appreciated as I am very new to VB and Macros.</p>\n\n<p>The code below only does C or 9 I thought I could just add .Forumula to the code below to add more words but it didn't work</p>\n\n<pre><code>Sub CheckValues()\n    Application.ScreenUpdating = False\n    With Range(\"A2\", Range(\"A\" &amp; Rows.Count).End(xlUp)).Offset(, 1)\n        .Formula = \"=IF(MIN(FIND({\"\"C\"\",9},A2&amp;\"\"C9\"\"))&lt;=LEN(A2),\"\"Word0\"\",\"\"\"\")\"\n        .Value = .Value\n    End With\n    Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "email", "outlook"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 5135576, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72287cc48ad06388844db318214588ec?s=128&d=identicon&r=PG&f=1", "display_name": "AIGeek", "link": "https://stackoverflow.com/users/5135576/aigeek"}, "edited": false, "score": 0, "creation_date": 1437599056, "post_id": 31572904, "comment_id": 51102785, "body": "hi thanks I will add that but the above given vba script is not working in my Outlook VBA. I am having error in &quot;._ folder&quot; please tell assist me with correct script to choose my subfolder named &quot;Delete Trasactions&quot;"}, {"owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "reply_to_user": {"reputation": 1, "user_id": 5135576, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72287cc48ad06388844db318214588ec?s=128&d=identicon&r=PG&f=1", "display_name": "AIGeek", "link": "https://stackoverflow.com/users/5135576/aigeek"}, "edited": false, "score": 0, "creation_date": 1437599144, "post_id": 31572904, "comment_id": 51102828, "body": "Where is the folder located relative to other folders? What is the exact error?"}, {"owner": {"reputation": 572, "user_id": 2497001, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/cb2b8a8f50e8038ea7f9d199b68bf750?s=128&d=identicon&r=PG", "display_name": "Evan", "link": "https://stackoverflow.com/users/2497001/evan"}, "edited": false, "score": 0, "creation_date": 1437650492, "post_id": 31572904, "comment_id": 51123803, "body": "is the <code>_</code> being used as the line continuation character? If it is the line actually is being interperted as <code>Set Items = Session.GetDefaultFolder(olFolderInbox). Folders(&quot;Delete Transactions&quot;).Items</code> which wont work because of the space before <code>Folders</code>. If it is not I doubt there is a Property or method <code>_</code> whcich returns items. <a href=\"https://msdn.microsoft.com/en-us/library/Aa711641(v=VS.71).aspx\" rel=\"nofollow noreferrer\">Here is MSDN on the Line Continuation Character</a>"}], "tags": [], "owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "is_accepted": false, "score": 0, "last_activity_date": 1437595274, "creation_date": 1437595274, "answer_id": 31572904, "question_id": 31572089, "link": "https://stackoverflow.com/questions/31572089/open-a-subfolder-in-outlook-and-open-the-most-recent-email/31572904#31572904", "title": "Open a subfolder in Outlook and open the most recent email?", "body": "<p>Sort the items collection and retrieve the first (or last, depending on how you sort it) item:</p>\n\n<pre><code>Items.Sort(\"ReceivedTime\", true)\nset LatestMessage = Items.GetFirst()\nMsgBox LatestMessage.Subject\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 5135576, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72287cc48ad06388844db318214588ec?s=128&d=identicon&r=PG&f=1", "display_name": "AIGeek", "link": "https://stackoverflow.com/users/5135576/aigeek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 326, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1437595997, "creation_date": 1437592580, "last_edit_date": 1437595997, "question_id": 31572089, "link": "https://stackoverflow.com/questions/31572089/open-a-subfolder-in-outlook-and-open-the-most-recent-email", "title": "Open a subfolder in Outlook and open the most recent email?", "body": "<p>This is what I have so far, I am having error with <code>\"**._**\"</code>  <code>folder(\"Delete Transactions\")</code>.</p>\n\n<pre><code>Sub OpenDeleteTransactions()\n\n   Dim Ns As Outlook.NameSpace\n\n   Set Ns = Application.GetNamespace(\"MAPI\")\n\n   Set Items = Ns.GetDefaultFolder(olFolderInbox).Items\n\n   Set Items = Session.GetDefaultFolder(olFolderInbox)._\n\n   Folders(\"Delete Transactions\").Items\n\n   Set Items = Application.ActiveExplorer.CurrentFolder.Items\n\nEnd Sub\n</code></pre>\n\n<p>The above is not working....</p>\n"}, {"tags": ["excel", "com", "vsto", "installshield", "vba"], "answers": [{"tags": [], "owner": {"reputation": 874, "user_id": 3275384, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/84qKu.jpg?s=128&g=1", "display_name": "Ajit Medhekar", "link": "https://stackoverflow.com/users/3275384/ajit-medhekar"}, "is_accepted": false, "score": 1, "last_activity_date": 1460458633, "creation_date": 1460458633, "answer_id": 36571231, "question_id": 31571784, "link": "https://stackoverflow.com/questions/31571784/vsto-com-add-in-progid/36571231#36571231", "title": "VSTO COM Add-In ProgID", "body": "<p>When we debug the AddIn through the Visual Studio, the entry for AddIn is get added into registry and from there it load that addin. </p>\n\n<p>While installing the AddIn from InstallShield we need to check whether we properly added registry entry for AddIn or not.  </p>\n\n<p>Also check the same registry entry under <code>HKCU</code> branch. Because addin gets loaded from HKCU branch as well of registry.</p>\n"}], "owner": {"reputation": 5302, "user_id": 822426, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/07cd25475959db39afef4ffbc5c5b950?s=128&d=identicon&r=PG", "display_name": "Jack", "link": "https://stackoverflow.com/users/822426/jack"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 665, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1460461470, "creation_date": 1437591606, "last_edit_date": 1531161705, "question_id": 31571784, "link": "https://stackoverflow.com/questions/31571784/vsto-com-add-in-progid", "title": "VSTO COM Add-In ProgID", "body": "<p>I'm having an issue where the <code>ProgID</code> of the Add-in is <strong>MyAddin</strong> whereas I want it to be <strong>MyAddin.Connect</strong> because there's a lot of existing spreadsheets where the VBA references <strong>MyAddin.Connect</strong>.</p>\n\n<p>I've changed every instance of MyAddin to MyAddin.Connect in the <strong>csproj</strong> file, <strong>manifest</strong>, and <strong>vsto</strong> file.  I've changed every instance in the registry.</p>\n\n<blockquote>\n  <p>Even the registry key\n  HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Office\\Excel\\Addins\\MyAddIn<br>\n  to MyAddIn.Connect</p>\n</blockquote>\n\n<p>Still when I check the <code>ProgID</code> through VBA, it says MyAddin (the friendly name in the COM Add-Ins Manager is MyAddin.Connect).</p>\n\n<p>Where exactly is the <code>ProgID</code> loaded from within VBA in Excel? I should note it was working perfectly when I was debugging the AddIn through Visual Studio.  But when I install it through a InstallShield setup, it just refuses to work.</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 1, "creation_date": 1437590411, "post_id": 31570668, "comment_id": 51097589, "body": "Additionally, OP could call the <code>Initialize</code> event programmatically i.e., <code>Call MyUserForm.UserForm_Initialize()</code>.  Usually the UF is only <i>initlialized</i> once, and after it&#39;s been initialized, until it is unloaded when you re-show it, it raises the <code>Activate</code> event.  For most ordinary use-cases, the <code>Activate</code> event is probably preferable to <code>Initialize</code>  -- IOW if OP need to re-populate the form&#39;s controls each time it&#39;s displayed, use the <code>Activate</code> event, because it raises every time the form is shown."}, {"owner": {"reputation": 13, "user_id": 5144781, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/161e2a060059c92568e37a737d4ec387?s=128&d=identicon&r=PG&f=1", "display_name": "Danny", "link": "https://stackoverflow.com/users/5144781/danny"}, "edited": false, "score": 0, "creation_date": 1437653855, "post_id": 31570668, "comment_id": 51126098, "body": "Sorted, @3-14159265358979323846264. Couldn&#39;t use showdialog but the <code>Dim frm As New managementFunction</code> method was the clincher. Thanks"}], "tags": [], "owner": {"reputation": 3108, "user_id": 5040941, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/291199b5e862bf2befb8ee158c6e544e?s=128&d=identicon&r=PG&f=1", "display_name": "3-14159265358979323846264", "link": "https://stackoverflow.com/users/5040941/3-14159265358979323846264"}, "is_accepted": true, "score": 2, "last_activity_date": 1437588032, "creation_date": 1437588032, "answer_id": 31570668, "question_id": 31570426, "link": "https://stackoverflow.com/questions/31570426/excel-userform-not-initialising-after-first-load/31570668#31570668", "title": "Excel Userform not initialising after first load", "body": "<p>You should try</p>\n\n<pre><code>Unload Me\n</code></pre>\n\n<p>instead of</p>\n\n<pre><code>Unload managementFunctions\n</code></pre>\n\n<p>Also, you might want to look at the difference between <code>Form.Show</code> and <code>Form.ShowDialog</code> (<a href=\"https://msdn.microsoft.com/en-us/library/aa984358%28v=vs.71%29.aspx\" rel=\"nofollow\">https://msdn.microsoft.com/en-us/library/aa984358%28v=vs.71%29.aspx</a> ... i realise this is an old page, but the info is still valid!)</p>\n\n<hr>\n\n<p>Furthermore, you might also benefit from creating your form objects as follows:</p>\n\n<pre><code>Dim frm as managementFunctions\nset frm = new managementFunctions\nfrm.Show\n</code></pre>\n\n<p>and then you can use</p>\n\n<pre><code>Me.Hide\n</code></pre>\n\n<p>instead of <code>Unload Me</code></p>\n"}], "owner": {"reputation": 13, "user_id": 5144781, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/161e2a060059c92568e37a737d4ec387?s=128&d=identicon&r=PG&f=1", "display_name": "Danny", "link": "https://stackoverflow.com/users/5144781/danny"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1169, "favorite_count": 0, "accepted_answer_id": 31570668, "answer_count": 1, "score": 1, "last_activity_date": 1437588032, "creation_date": 1437587383, "question_id": 31570426, "link": "https://stackoverflow.com/questions/31570426/excel-userform-not-initialising-after-first-load", "title": "Excel Userform not initialising after first load", "body": "<p>I have a workbook which has multiple layers of userforms.</p>\n\n<p>When the workbook is opened the user is presented with a userform which has two command buttons, one which selects a worksheet with pivottable and slicers and a second which opens another userform containing eight command buttons, seven of which call further individual userforms and the eight which is a close button.</p>\n\n<p>The issue I have is that when I select the command button which opens a new userform, then close the second userform and then reselect the command button to reopen the second userform, the second userform appears but none of the command buttons work nor the close window (X).</p>\n\n<p>The code behind the first command button is as follows:</p>\n\n<pre><code>Private Sub cmd_manageAbsence_Click()\n    splashScreen.Hide\n    Load managementFunctions\n    managementFunctions.Show\nEnd Sub\n</code></pre>\n\n<p>The close and terminate code on the second userform is as follows:</p>\n\n<pre><code>Private Sub cmd_close_Click()\n    Unload managementFunctions\nEnd Sub\n\nPrivate Sub UserForm_Terminate()\n    Sheets(\"Front\").Activate\n    splashScreen.Show\nEnd Sub\n</code></pre>\n\n<p>I am having the same issues with the second layer of userforms, but I guess if I get the first layer sorted I can apply the fix to the rest.</p>\n\n<p>Thanks</p>\n"}, {"tags": ["vba", "excel", "excel-2007"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1437587418, "post_id": 31570355, "comment_id": 51095749, "body": "Since you just want to change any cells in the second table, when cells in the first table are changed, why not (in the second table) create a link to the original cells?  Like in your sheet2, have the cells you want updated linked to their value in Sheet1.  Does that make sense?  That way, changing a value in Sheet1 automatically updates Sheet2, without need for a macro/VB."}, {"owner": {"reputation": 33, "user_id": 5142165, "user_type": "registered", "accept_rate": 25, "profile_image": "https://graph.facebook.com/10153410789239566/picture?type=large", "display_name": "Mohammad Mbydeen", "link": "https://stackoverflow.com/users/5142165/mohammad-mbydeen"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1437638115, "post_id": 31570355, "comment_id": 51115822, "body": "Please can you tell me how to link it ?"}], "answers": [{"tags": [], "owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "is_accepted": false, "score": 0, "last_activity_date": 1437660516, "creation_date": 1437660516, "answer_id": 31589857, "question_id": 31570355, "link": "https://stackoverflow.com/questions/31570355/how-to-transfer-highlighted-cells-in-excel-2007-from-one-table-to-another-in-the/31589857#31589857", "title": "How to transfer highlighted cells in Excel 2007 from one table to another in the same sheet?", "body": "<p>Instead of copying the whole table and using the values to populate the table on the second page, why not (for those items you want to update, as the sheet1 gets updates) just leave a \"link\" back to the original table.  You could either set it literally to the cell it refers to, or more robustly, use something like Index/Match.  See below:</p>\n\n<p>This is an example of Sheet1 (the data you want copied onto a second sheet).  I have highlighted the \"Salary\" column, to reflect that the user is asked to change these.</p>\n\n<p><a href=\"https://i.stack.imgur.com/zl0zQ.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/zl0zQ.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>And in your sheet 2, you can use various ways of \"linking\" back to the first sheet:</p>\n\n<p><a href=\"https://i.stack.imgur.com/7l9J6.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/7l9J6.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>That way, when you go in an edit the salary for Chris or John, it'll update their salary in the second sheet, without needing to run any macros.  Is this what you're looking to do, or am I overlooking/misunderstanding something?</p>\n"}], "owner": {"reputation": 33, "user_id": 5142165, "user_type": "registered", "accept_rate": 25, "profile_image": "https://graph.facebook.com/10153410789239566/picture?type=large", "display_name": "Mohammad Mbydeen", "link": "https://stackoverflow.com/users/5142165/mohammad-mbydeen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 83, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1437660516, "creation_date": 1437587138, "question_id": 31570355, "link": "https://stackoverflow.com/questions/31570355/how-to-transfer-highlighted-cells-in-excel-2007-from-one-table-to-another-in-the", "title": "How to transfer highlighted cells in Excel 2007 from one table to another in the same sheet?", "body": "<p>I would like to create a code that transfer the content of the highlighted cells from one table to another in the same sheet with the content, I use button to copy the content, but I would like to create a macro the transfer the content dynamically by clicking on a button, when the user change the content of the highlighted cells of the first table the content changes automatically in the second table or by clicking on the button again.</p>\n\n<p>I use this code to highlight the cells </p>\n\n<pre><code>' Set of highlighted cells indexed by row number\nDim highlightedCells As New Collection\n\n' Scan existing sheet for any cells coloured 'red' and initialise the\n'  run-time collection of 'highlighted' cells.\nPrivate Sub Worksheet_Activate()\n   ActiveSheet.Unprotect Password:=\"P@ssw0rd\"\n    Dim existingHighlights As Range\n    ' Reset the collection of highlighted cells ready to rebuild it\n    Set highlightedCells = New Collection\n    ' Find the first cell that has its background coloured red\n    Application.FindFormat.Interior.ColorIndex = 3\n    Set existingHighlights = ActiveSheet.Cells.Find(\"\", _\n                                                    LookIn:=xlValues, _\n                                                    LookAt:=xlPart, _\n                                                    SearchOrder:=xlByRows, _\n                                                    SearchDirection:=xlNext, _\n                                                    MatchCase:=False, _\n                                                    SearchFormat:=True)\n    ' Process for as long as we have more matches\n    Do While Not existingHighlights Is Nothing\n        cRow = existingHighlights.Row\n        ' Add a reference only to the first coloured cell if multiple\n        ' exist in a single row (will only occur if background manually set)\n        Err.Clear\n        On Error Resume Next\n            Call highlightedCells.Add(existingHighlights.Address, CStr(cRow))\n        On Error GoTo 0\n        ' Search from the cell after the last match. Note an error in Excel\n        '  appears to prevent the FindNext method from finding formats correctly\n        Application.FindFormat.Interior.ColorIndex = 3\n        Set existingHighlights = ActiveSheet.Cells.Find(\"\", _\n                                                    After:=existingHighlights, _\n                                                    LookIn:=xlValues, _\n                                                    LookAt:=xlPart, _\n                                                    SearchOrder:=xlByRows, _\n                                                    SearchDirection:=xlNext, _\n                                                    MatchCase:=False, _\n                                                    SearchFormat:=True)\n        ' Abort the search if we've looped back to the top of the sheet\n        If (existingHighlights.Row &lt; cRow) Then\n            Exit Do\n        End If\n    Loop\n\n ActiveSheet.Protect Password:=\"P@ssw0rd\"\nEnd Sub\n\nPrivate Sub Worksheet_BeforeDoubleClick(ByVal Target As Range, Cancel As Boolean)\n    ActiveSheet.Unprotect Password:=\"P@ssw0rd\"\n    Dim hCell As String\n    Dim cellAlreadyHighlighted As Boolean\n    hCell = \"\"\n\n    Err.Clear\n    On Error Resume Next\n      hCell = highlightedCells.Item(CStr(Target.Row))\n    On Error GoTo 0\n\n    If (hCell &lt;&gt; \"\") Then\n        ActiveSheet.Range(hCell).Interior.ColorIndex = 2\n        If (hCell = Target.Address) Then\n            Call highlightedCells.Remove(CStr(Target.Row))\n            Target.Interior.ColorIndex = 2\n        Else\n            Call highlightedCells.Remove(CStr(Target.Row))\n            Call highlightedCells.Add(Target.Address, CStr(Target.Row))\n            Target.Interior.ColorIndex = 3\n        End If\n    Else\n        Err.Clear\n        On Error Resume Next\n          highlightedCells.Remove (CStr(Target.Row))\n        On Error GoTo 0\n        Call highlightedCells.Add(Target.Address, CStr(Target.Row))\n        Target.Interior.ColorIndex = 3\n    End If\n    Cancel = True\n      ActiveSheet.Protect Password:=\"P@ssw0rd\"\nEnd Sub\n</code></pre>\n\n<p>And I use this code to copy the highlighted cells:</p>\n\n<pre><code>Sub CopyCat()\n  ActiveSheet.Unprotect Password:=\"P@ssw0rd\"\nDim LR As Long, i As Long, j As Long\nDim c As Range\nj = 1\nLR = Range(\"A\" &amp; Rows.Count).End(xlUp).Row\nFor Each c In Worksheets(\"MB\").Range(\"A1:O\" &amp; LR)\n      If c.Interior.ColorIndex = 3 Then\n            c.Copy Destination:=Worksheets(\"MB\").Range(\"J\" &amp; j)\n        j = j + 1\n        End If\nNext c\n  ActiveSheet.Protect Password:=\"P@ssw0rd\"\n\nEnd Sub\n</code></pre>\n\n<p>Please Help !!!!</p>\n"}, {"tags": ["image", "vba", "excel", "outlook"], "comments": [{"owner": {"reputation": 3650, "user_id": 5090027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/904db949ae64fe1a63ea8b4c677e6d57?s=128&d=identicon&r=PG&f=1", "display_name": "Grade &#39;Eh&#39; Bacon", "link": "https://stackoverflow.com/users/5090027/grade-eh-bacon"}, "edited": false, "score": 0, "creation_date": 1437586626, "post_id": 31570122, "comment_id": 51095303, "body": "Go to Excel. Select your data. CTRL + C. Go to Outlook. ALT then H then V then S then select &quot;Paste as Picture&quot;."}, {"owner": {"reputation": 514, "user_id": 2102895, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OAvoQ.jpg?s=128&g=1", "display_name": "Eddy", "link": "https://stackoverflow.com/users/2102895/eddy"}, "reply_to_user": {"reputation": 3650, "user_id": 5090027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/904db949ae64fe1a63ea8b4c677e6d57?s=128&d=identicon&r=PG&f=1", "display_name": "Grade &#39;Eh&#39; Bacon", "link": "https://stackoverflow.com/users/5090027/grade-eh-bacon"}, "edited": false, "score": 0, "creation_date": 1437642729, "post_id": 31570122, "comment_id": 51118731, "body": "@Grade&#39;Eh&#39;Bacon unless you are suggesting using &quot;sendkeys&quot;, OP specifically stated they are looking for a VBA solution."}, {"owner": {"reputation": 3650, "user_id": 5090027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/904db949ae64fe1a63ea8b4c677e6d57?s=128&d=identicon&r=PG&f=1", "display_name": "Grade &#39;Eh&#39; Bacon", "link": "https://stackoverflow.com/users/5090027/grade-eh-bacon"}, "reply_to_user": {"reputation": 514, "user_id": 2102895, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OAvoQ.jpg?s=128&g=1", "display_name": "Eddy", "link": "https://stackoverflow.com/users/2102895/eddy"}, "edited": false, "score": 0, "creation_date": 1437653543, "post_id": 31570122, "comment_id": 51125877, "body": "Do you actually want this to be a VBA solution? If so, please show your attempt at a VBA solution thus far. However given the trivial nature of the manual solution, I assume this will be sufficient. @Eddy - you will notice that I offered this as a comment, not an answer."}], "answers": [{"tags": [], "owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "is_accepted": false, "score": 1, "last_activity_date": 1437660194, "creation_date": 1437660194, "answer_id": 31589715, "question_id": 31570122, "link": "https://stackoverflow.com/questions/31570122/how-to-paste-excel-data-into-outlook-as-an-image-using-vba/31589715#31589715", "title": "How to paste Excel data into Outlook as an image using VBA?", "body": "<p>The Outlook object model provides three main ways for working with item bodies:</p>\n\n<ol>\n<li><a href=\"https://msdn.microsoft.com/en-us/library/office/ff865304(v=office.15).aspx\" rel=\"nofollow\">Body</a>.</li>\n<li><a href=\"https://msdn.microsoft.com/en-us/library/office/ff868941(v=office.15).aspx\" rel=\"nofollow\">HTMLBody</a>.</li>\n<li>The Word editor. The <a href=\"https://msdn.microsoft.com/en-us/library/office/ff868196(v=office.15).aspx\" rel=\"nofollow\">WordEditor</a> property of the Inspector class returns an instance of the Word Document which represents the message body. So, <strong>you can use the Word object model do whatever you need with the message body</strong>. </li>\n</ol>\n\n<p>For example, you can use the Copy method of the <code>Range</code> class from the Excel object model and then use the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff845105(v=office.15).aspx\" rel=\"nofollow\">Paste</a> method of the Range class from the Word object model to paste the copied data in Excel.</p>\n\n<p>See <a href=\"https://msdn.microsoft.com/en-us/library/dd492012%28v=office.12%29.aspx\" rel=\"nofollow\">Chapter 17: Working with Item Bodies</a> for more information.</p>\n"}], "owner": {"reputation": 19, "user_id": 5140481, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6fb29a3b25e3e933d24fbbaf7b325594?s=128&d=identicon&r=PG&f=1", "display_name": "JT7007", "link": "https://stackoverflow.com/users/5140481/jt7007"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 721, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1437660194, "creation_date": 1437586316, "last_edit_date": 1437659044, "question_id": 31570122, "link": "https://stackoverflow.com/questions/31570122/how-to-paste-excel-data-into-outlook-as-an-image-using-vba", "title": "How to paste Excel data into Outlook as an image using VBA?", "body": "<p>I have an Excel sheet with data in <code>a1:q38</code> that I need to paste into the BODY of an outlook email. Any idea how to do this while not saving the image as a jpg or png?</p>\n"}, {"tags": ["vb.net", "vba", "excel"], "comments": [{"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1437589657, "post_id": 31570011, "comment_id": 51097108, "body": "That error would seem to indicate that the class name <code>&quot;AcroExch.App&quot;</code> is not registered on your machine."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 4873375, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GNIHS.png?s=128&g=1", "display_name": "Vilva Athiban", "link": "https://stackoverflow.com/users/4873375/vilva-athiban"}, "edited": false, "score": 0, "creation_date": 1437595333, "post_id": 31571266, "comment_id": 51100592, "body": "Thank you david for your answer. Can u please let me know how can i register the class name..?"}, {"owner": {"reputation": 1, "user_id": 4873375, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GNIHS.png?s=128&g=1", "display_name": "Vilva Athiban", "link": "https://stackoverflow.com/users/4873375/vilva-athiban"}, "edited": false, "score": 0, "creation_date": 1437636419, "post_id": 31571266, "comment_id": 51114893, "body": "You mean, reinstalling excel..?"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "reply_to_user": {"reputation": 1, "user_id": 4873375, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GNIHS.png?s=128&g=1", "display_name": "Vilva Athiban", "link": "https://stackoverflow.com/users/4873375/vilva-athiban"}, "edited": false, "score": 0, "creation_date": 1437654706, "post_id": 31571266, "comment_id": 51126720, "body": "No, whatever application is associated with <code>AcroEch.App</code>."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "reply_to_user": {"reputation": 1, "user_id": 4873375, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GNIHS.png?s=128&g=1", "display_name": "Vilva Athiban", "link": "https://stackoverflow.com/users/4873375/vilva-athiban"}, "edited": false, "score": 0, "creation_date": 1437661524, "post_id": 31571266, "comment_id": 51132239, "body": "Which version(s) of Adobe Acrobat are currently installed on your machine? This thread suggests you may need Professional, and also that if you have multiple versions installed concurrently, that may be a problem. <a href=\"https://forums.adobe.com/thread/302392\" rel=\"nofollow noreferrer\">forums.adobe.com/thread/302392</a>"}, {"owner": {"reputation": 1, "user_id": 4873375, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GNIHS.png?s=128&g=1", "display_name": "Vilva Athiban", "link": "https://stackoverflow.com/users/4873375/vilva-athiban"}, "edited": false, "score": 0, "creation_date": 1437756608, "post_id": 31571266, "comment_id": 51181133, "body": "i have acrobat 11.0... I dont have multiple versions installed but i dont have professional.. how can i get a professional version?"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "reply_to_user": {"reputation": 1, "user_id": 4873375, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GNIHS.png?s=128&g=1", "display_name": "Vilva Athiban", "link": "https://stackoverflow.com/users/4873375/vilva-athiban"}, "edited": false, "score": 0, "creation_date": 1437756688, "post_id": 31571266, "comment_id": 51181178, "body": "Well, software doesnt grow on trees... maybe you should purchase the professional version?"}, {"owner": {"reputation": 1, "user_id": 4873375, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GNIHS.png?s=128&g=1", "display_name": "Vilva Athiban", "link": "https://stackoverflow.com/users/4873375/vilva-athiban"}, "edited": false, "score": 0, "creation_date": 1437763948, "post_id": 31571266, "comment_id": 51184932, "body": "I guess software grows with tree.. Trees in data structure ;) and thanks for your response David"}], "tags": [], "owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "is_accepted": false, "score": 0, "last_activity_date": 1437589950, "creation_date": 1437589950, "answer_id": 31571266, "question_id": 31570011, "link": "https://stackoverflow.com/questions/31570011/activex-cannot-create-object-error-when-trying-to-convert-pdf-file-to-text-file/31571266#31571266", "title": "ActiveX cannot create object error when trying to convert PDF file to text file", "body": "<p>That error would seem to indicate that the class name <code>\"AcroExch.App\"</code> is not registered on your machine.</p>\n\n<p>Also, you've declared that object of type <code>Acrobat.AcroApp</code>, so you need to make up your mind which class you're using, because I think that will probably raise a Type 13 \"Mismatch\" error even if you do register the AcroExch.App class, because it's returning an object type that differs from the variable's declared type.</p>\n\n<p>I'm not familiar with those object models but you could try:</p>\n\n<pre><code>Set AcroXApp = CreateObject(\"Acrobat.AcroApp\")\n\nSet AcroXAVDoc = CreateObject(\"Acrobat.AcroAVDoc\")\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 4873375, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GNIHS.png?s=128&g=1", "display_name": "Vilva Athiban", "link": "https://stackoverflow.com/users/4873375/vilva-athiban"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1219, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1437589950, "creation_date": 1437585972, "last_edit_date": 1437587847, "question_id": 31570011, "link": "https://stackoverflow.com/questions/31570011/activex-cannot-create-object-error-when-trying-to-convert-pdf-file-to-text-file", "title": "ActiveX cannot create object error when trying to convert PDF file to text file", "body": "<p>When I try to convert my PDF file to text file, I encounter the following error:</p>\n\n<blockquote>\n  <p>Involving Acrobat Error 429 : ActiveX cannot create object</p>\n</blockquote>\n\n<p>My code is:</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n\n    Dim AcroXApp As Acrobat.AcroApp\n    Dim AcroXAVDoc As Acrobat.AcroAVDoc\n    Dim AcroXPDDoc As Acrobat.AcroPDDoc\n    Dim Filename As String\n    Dim jsObj As Object\n    Dim NewFileName As String\n\n    Filename = \"C:\\Users\\Boominathan\\Desktop\\test.pdf\"\n\n    NewFileName = \"C:\\file.txt\"\n\n    Set AcroXApp = CreateObject(\"AcroExch.App\")\n\n    Set AcroXAVDoc = CreateObject(\"AcroExch.AVDoc\")\n\n    AcroXAVDoc.Open Filename, \"Acrobat\"\n\n    Set AcroXPDDoc = AcroXAVDoc.GetPDDoc\n\n    Set jsObj = AcroXPDDoc.GetJSObject\n\n    jsObj.SaveAs NewFileName, \"com.adobe.acrobat.plain-text\"\n\n    AcroXAVDoc.Close False\n\n    AcroXApp.Hide\n\n    AcroXApp.Exit\n\nEnd Sub\n</code></pre>\n\n<p>And the error is in the following line:</p>\n\n<pre><code>Set AcroXApp = CreateObject(\"AcroExch.App\")\n</code></pre>\n\n<p>Can you please help me to resolve it?</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 3108, "user_id": 5040941, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/291199b5e862bf2befb8ee158c6e544e?s=128&d=identicon&r=PG&f=1", "display_name": "3-14159265358979323846264", "link": "https://stackoverflow.com/users/5040941/3-14159265358979323846264"}, "is_accepted": true, "score": 3, "last_activity_date": 1437585216, "creation_date": 1437585216, "answer_id": 31569776, "question_id": 31569637, "link": "https://stackoverflow.com/questions/31569637/refer-to-a-workbooks-by-index-number/31569776#31569776", "title": "Refer to a workbooks by index number", "body": "<p>You can use this to get the last workbook</p>\n\n<pre><code>Set LastWorkbook = Workbooks(Workbooks.Count)\n</code></pre>\n\n<p><strong>BUT</strong> if you already have the <code>NewBook</code> variable, can't you just use that? The reason i say that is because relying on a <code>workbook</code>'s index may not give consistent results.</p>\n"}, {"tags": [], "owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "is_accepted": false, "score": 1, "last_activity_date": 1437585227, "creation_date": 1437585227, "answer_id": 31569783, "question_id": 31569637, "link": "https://stackoverflow.com/questions/31569637/refer-to-a-workbooks-by-index-number/31569783#31569783", "title": "Refer to a workbooks by index number", "body": "<p>For the highest index number, you can just use Worksheets.Count.  That'll return how many sheets you have, thus telling you the highest index.  </p>\n"}], "owner": {"reputation": 558, "user_id": 4686873, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/e8ed25ac033b2a31f8d90013d39089ce?s=128&d=identicon&r=PG&f=1", "display_name": "Ihidan", "link": "https://stackoverflow.com/users/4686873/ihidan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 379, "favorite_count": 0, "accepted_answer_id": 31569776, "answer_count": 2, "score": 1, "last_activity_date": 1437585227, "creation_date": 1437584780, "question_id": 31569637, "link": "https://stackoverflow.com/questions/31569637/refer-to-a-workbooks-by-index-number", "title": "Refer to a workbooks by index number", "body": "<p>I am using </p>\n\n<pre><code>Set NewBook = Workbooks.Add\n</code></pre>\n\n<p>to create a new workbook. I need to refer to this workbook without saving it. So I am using workbook index number to refer to the new workbook, is there a way to retrieve the index number of the last workbook open/created (the highest index number)?  </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 176, "user_id": 5045195, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/56zsk.jpg?s=128&g=1", "display_name": "Gilligan", "link": "https://stackoverflow.com/users/5045195/gilligan"}, "edited": false, "score": 0, "creation_date": 1437584267, "post_id": 31569310, "comment_id": 51093890, "body": "Can you please post the code that you have?"}, {"owner": {"reputation": 181, "user_id": 5067062, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ykZUo.png?s=128&g=1", "display_name": "bdkong", "link": "https://stackoverflow.com/users/5067062/bdkong"}, "edited": false, "score": 0, "creation_date": 1439413291, "post_id": 31569310, "comment_id": 51857303, "body": "@steph if you found my answer acceptable, could you please accept it?"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 5144648, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c9f28214199802090a8fab761613e70?s=128&d=identicon&r=PG&f=1", "display_name": "steph", "link": "https://stackoverflow.com/users/5144648/steph"}, "edited": false, "score": 0, "creation_date": 1437584262, "post_id": 31569463, "comment_id": 51093887, "body": "Doesn&#39;t that run the Macro on Wb1 instead of Wb2?"}, {"owner": {"reputation": 2685, "user_id": 1523914, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/95939ded1fb2423fbe9ba7989a0006ab?s=128&d=identicon&r=PG", "display_name": "Excel Developers", "link": "https://stackoverflow.com/users/1523914/excel-developers"}, "edited": false, "score": 2, "creation_date": 1437584294, "post_id": 31569463, "comment_id": 51093899, "body": "It depends what is in the macro."}, {"owner": {"reputation": 1, "user_id": 5144648, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c9f28214199802090a8fab761613e70?s=128&d=identicon&r=PG&f=1", "display_name": "steph", "link": "https://stackoverflow.com/users/5144648/steph"}, "edited": false, "score": 0, "creation_date": 1437584348, "post_id": 31569463, "comment_id": 51093942, "body": "The macro would loop through the tabs and do some calculations. When I just do an Application.Run, it tries to run the Macro on Wb1. Should I just open Wb2, Run the method, then close Wb2?"}, {"owner": {"reputation": 3108, "user_id": 5040941, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/291199b5e862bf2befb8ee158c6e544e?s=128&d=identicon&r=PG&f=1", "display_name": "3-14159265358979323846264", "link": "https://stackoverflow.com/users/5040941/3-14159265358979323846264"}, "edited": false, "score": 1, "creation_date": 1437584422, "post_id": 31569463, "comment_id": 51093979, "body": "You need to update the macro in <code>Wb2</code> so it uses <code>ThisWorkbook</code> instead of <code>ActiveWorkbook</code>."}], "tags": [], "owner": {"reputation": 3108, "user_id": 5040941, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/291199b5e862bf2befb8ee158c6e544e?s=128&d=identicon&r=PG&f=1", "display_name": "3-14159265358979323846264", "link": "https://stackoverflow.com/users/5040941/3-14159265358979323846264"}, "is_accepted": false, "score": 1, "last_activity_date": 1437584203, "creation_date": 1437584203, "answer_id": 31569463, "question_id": 31569310, "link": "https://stackoverflow.com/questions/31569310/run-macro-on-another-worksheet-from-one-sheet-excel/31569463#31569463", "title": "Run macro on another worksheet from one sheet Excel", "body": "<p>You can use <code>Application.Run</code> to run a macro on a different workbook. Assuming <code>Wb2</code> is already open, and the macro you want to run is called <code>MacroName</code> then you can use the following ...</p>\n\n<pre><code>Application.Run \"Wb2!MacroName\"\n</code></pre>\n\n<p>from within <code>Wb1</code></p>\n"}, {"comments": [{"owner": {"reputation": 3108, "user_id": 5040941, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/291199b5e862bf2befb8ee158c6e544e?s=128&d=identicon&r=PG&f=1", "display_name": "3-14159265358979323846264", "link": "https://stackoverflow.com/users/5040941/3-14159265358979323846264"}, "edited": false, "score": 0, "creation_date": 1437584489, "post_id": 31569547, "comment_id": 51094021, "body": "You mean <code>ThisWorkbook</code>? <code>ActiveWorkbook</code> is making the macro in <code>Wb2</code> run on <code>Wb1</code>"}, {"owner": {"reputation": 181, "user_id": 5067062, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ykZUo.png?s=128&g=1", "display_name": "bdkong", "link": "https://stackoverflow.com/users/5067062/bdkong"}, "reply_to_user": {"reputation": 3108, "user_id": 5040941, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/291199b5e862bf2befb8ee158c6e544e?s=128&d=identicon&r=PG&f=1", "display_name": "3-14159265358979323846264", "link": "https://stackoverflow.com/users/5040941/3-14159265358979323846264"}, "edited": false, "score": 0, "creation_date": 1437584735, "post_id": 31569547, "comment_id": 51094170, "body": "Ah my mistake, I read the question incorrectly. I though @steph wanted to run code from Wb1 in Wb2. Apologies."}, {"owner": {"reputation": 3108, "user_id": 5040941, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/291199b5e862bf2befb8ee158c6e544e?s=128&d=identicon&r=PG&f=1", "display_name": "3-14159265358979323846264", "link": "https://stackoverflow.com/users/5040941/3-14159265358979323846264"}, "edited": false, "score": 1, "creation_date": 1437584916, "post_id": 31569547, "comment_id": 51094294, "body": "No apologies necessary :0) Glad you agree because I was starting to wonder if i knew what i was doing!!"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1437588867, "post_id": 31569547, "comment_id": 51096637, "body": "It may work, but I might look to avoid using Activeworkbook, especially if you are going to be switching between workbooks.  You can use it to set the variable (i.e. <code>Set thisWB = activeworkbook</code>), then use <code>thisWB</code> in the macro."}], "tags": [], "owner": {"reputation": 181, "user_id": 5067062, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ykZUo.png?s=128&g=1", "display_name": "bdkong", "link": "https://stackoverflow.com/users/5067062/bdkong"}, "is_accepted": false, "score": -1, "last_activity_date": 1437589001, "last_edit_date": 1437589001, "creation_date": 1437584456, "answer_id": 31569547, "question_id": 31569310, "link": "https://stackoverflow.com/questions/31569310/run-macro-on-another-worksheet-from-one-sheet-excel/31569547#31569547", "title": "Run macro on another worksheet from one sheet Excel", "body": "<p>You can use <code>ThisWorkbook</code> which will reference the workbook you wrote the code in. A simple way to change this is to use the search function ctrl+f on your code and replace your workbook name with <code>ThisWorkBook</code>.</p>\n\n<p>Credit to @3-14159265358979323846264 for catching my mistake.</p>\n"}], "owner": {"reputation": 1, "user_id": 5144648, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c9f28214199802090a8fab761613e70?s=128&d=identicon&r=PG&f=1", "display_name": "steph", "link": "https://stackoverflow.com/users/5144648/steph"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1489, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1437659215, "creation_date": 1437583767, "last_edit_date": 1437659215, "question_id": 31569310, "link": "https://stackoverflow.com/questions/31569310/run-macro-on-another-worksheet-from-one-sheet-excel", "title": "Run macro on another worksheet from one sheet Excel", "body": "<p>I have two Excel Workbooks (WB1, WB2). I want to be able to run a Macro from WB1 that will run a macro on WB2. The macro I want to run on Wb2 is already in WB2. Basically I want to click a button that will run the WB2 macro on WB2.</p>\n"}, {"tags": ["ms-access", "vba", "ms-access-2010"], "comments": [{"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1437583599, "post_id": 31569054, "comment_id": 51093520, "body": "What is the value of <i>fileName</i> when you encounter that error?"}, {"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1437583790, "post_id": 31569054, "comment_id": 51093635, "body": "Actually seems you should first get an Overflow error at <code>strtemp2 = 25698539646</code> because 25698539646 exceeds the capacity of a Long Integer."}, {"owner": {"reputation": 402, "user_id": 4555708, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/75c3e6254a423100c074be583a775a51?s=128&d=identicon&r=PG&f=1", "display_name": "Gene", "link": "https://stackoverflow.com/users/4555708/gene"}, "edited": false, "score": 0, "creation_date": 1437586737, "post_id": 31569054, "comment_id": 51095360, "body": "&quot;set rs - currentdb...&quot;  post your actual code please....  there&#39;s no way this code actually works.. (includes HansUp&#39;s comment)"}, {"owner": {"reputation": 99, "user_id": 2850838, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/0923095d289c0c5397b134ff449d486d?s=128&d=identicon&r=PG&f=1", "display_name": "knt5784", "link": "https://stackoverflow.com/users/2850838/knt5784"}, "edited": false, "score": 0, "creation_date": 1437594174, "post_id": 31569054, "comment_id": 51099908, "body": "I just updated the post, please look into it. The stremp2 is set in the table as Long Integer, so I put the actual number in the code. (it has been changed)"}, {"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1437596213, "post_id": 31569054, "comment_id": 51101132, "body": "Something is still not right.  The maximum value a Long integer can accept is 2147483647.  (<code>2 ^ 31 -1 = 2147483647</code>)  But your value, 2281821648, exceeds that maximum by 134338001.  (<code>2281821648 - 2147483647 = 134338001</code>)  Therefore I can&#39;t understand how your code does not trigger error #6, <i>&quot;Overflow&quot;</i> at <code>strtemp2 = 2281821648</code>"}, {"owner": {"reputation": 99, "user_id": 2850838, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/0923095d289c0c5397b134ff449d486d?s=128&d=identicon&r=PG&f=1", "display_name": "knt5784", "link": "https://stackoverflow.com/users/2850838/knt5784"}, "edited": false, "score": 0, "creation_date": 1437604143, "post_id": 31569054, "comment_id": 51105102, "body": "yeah, it&#39;s confidential so I changed the number. You can just make a smaller number and test it."}, {"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1437616038, "post_id": 31569054, "comment_id": 51108154, "body": "What is the value of <i>fileName</i> when you encounter the operation not supported error?"}], "answers": [{"tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": false, "score": 0, "last_activity_date": 1437586869, "creation_date": 1437586869, "answer_id": 31570284, "question_id": 31569054, "link": "https://stackoverflow.com/questions/31569054/access-findfirst-findnext-returns-operation-is-not-supported-in-this-type-of-obj/31570284#31570284", "title": "Access FindFirst/FindNext returns Operation is not supported in this type of object", "body": "<p>You can't open a RecordSet from a file name. First open the database, then the recordset.</p>\n"}], "owner": {"reputation": 99, "user_id": 2850838, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/0923095d289c0c5397b134ff449d486d?s=128&d=identicon&r=PG&f=1", "display_name": "knt5784", "link": "https://stackoverflow.com/users/2850838/knt5784"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 383, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1437664772, "creation_date": 1437583054, "last_edit_date": 1437664772, "question_id": 31569054, "link": "https://stackoverflow.com/questions/31569054/access-findfirst-findnext-returns-operation-is-not-supported-in-this-type-of-obj", "title": "Access FindFirst/FindNext returns Operation is not supported in this type of object", "body": "<p>I have this code:</p>\n\n<pre><code>Sub printPdfPagesTest(formName As String, fileName As String)\n''print each record into a separate pdf file, named according to invoice number\n\n    Dim rs As Recordset\n    Dim whereCondition As String\n    Dim saveName As String\n\n    Dim strtemp2 As Long\n    strtemp2 = 2281821648\n\n    Set rs = CurrentDb.OpenRecordset(fileName)   ''can also pass SQL in as a String\n\n    ''add msgbox: create a number for input invoiceNumber\n    ''get value from invoiceNumber  = inputbox (\"enter starting invoice num\"...)\n    ''get value from end invoiceNumber = inputbox(\"enter ending invoice num\"...)\n    ''get a start value for the starting location (findRecord) -----need to plan this step out.\n    ''add an if statement in do while loop. if where condition is not the end invoice number, keep going\n\n    rs.FindNext \"[invoiceNumber]=\" &amp; strtemp2\n\n    DoCmd.Close acForm, formName\n    rs.Close\n    Set rs = Nothing\nEnd Sub\n</code></pre>\n\n<p>What I want is to find the position of <code>strtemp2</code> invoice number in a table and use <code>moveNext</code> and <code>movePrevious</code> on the record to navigate around the table. </p>\n\n<p>I keep getting the error message: </p>\n\n<blockquote>\n  <p>Operation is not supported for this type of object. </p>\n</blockquote>\n\n<p>This happens on this line:</p>\n\n<pre><code>Set rs = CurrentDb.OpenRecordset(fileName)  \n</code></pre>\n\n<p>I tried changing <code>rs</code> to: </p>\n\n<pre><code>Dim rs as Recordset\n</code></pre>\n\n<p>However it still gives me the same error.</p>\n"}, {"tags": ["vba", "text", "colors", "compare"], "comments": [{"owner": {"reputation": 3650, "user_id": 5090027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/904db949ae64fe1a63ea8b4c677e6d57?s=128&d=identicon&r=PG&f=1", "display_name": "Grade &#39;Eh&#39; Bacon", "link": "https://stackoverflow.com/users/5090027/grade-eh-bacon"}, "edited": false, "score": 1, "creation_date": 1437586000, "post_id": 31568953, "comment_id": 51094919, "body": "&quot;It won&#39;t solve&quot; - what is the raw data in the cells, what is the expected output, and what is the actual output? Have you run through the code line by line to determine where a variable becomes somehting you didn&#39;t expect?"}, {"owner": {"reputation": 398, "user_id": 1568996, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/e626621d7b6054a4f491fc974063d8ae?s=128&d=identicon&r=PG", "display_name": "DeerSpotter", "link": "https://stackoverflow.com/users/1568996/deerspotter"}, "reply_to_user": {"reputation": 3650, "user_id": 5090027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/904db949ae64fe1a63ea8b4c677e6d57?s=128&d=identicon&r=PG&f=1", "display_name": "Grade &#39;Eh&#39; Bacon", "link": "https://stackoverflow.com/users/5090027/grade-eh-bacon"}, "edited": false, "score": 0, "creation_date": 1437588686, "post_id": 31568953, "comment_id": 51096534, "body": "just numbers, 001-, 002-, 003-,etc..  Both ranges have same type of numbers just a different type of range. One is on a row and the other in a column."}, {"owner": {"reputation": 398, "user_id": 1568996, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/e626621d7b6054a4f491fc974063d8ae?s=128&d=identicon&r=PG", "display_name": "DeerSpotter", "link": "https://stackoverflow.com/users/1568996/deerspotter"}, "reply_to_user": {"reputation": 3650, "user_id": 5090027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/904db949ae64fe1a63ea8b4c677e6d57?s=128&d=identicon&r=PG&f=1", "display_name": "Grade &#39;Eh&#39; Bacon", "link": "https://stackoverflow.com/users/5090027/grade-eh-bacon"}, "edited": false, "score": 0, "creation_date": 1437588700, "post_id": 31568953, "comment_id": 51096543, "body": "The source range is on the row."}, {"owner": {"reputation": 3650, "user_id": 5090027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/904db949ae64fe1a63ea8b4c677e6d57?s=128&d=identicon&r=PG&f=1", "display_name": "Grade &#39;Eh&#39; Bacon", "link": "https://stackoverflow.com/users/5090027/grade-eh-bacon"}, "edited": false, "score": 1, "creation_date": 1437591931, "post_id": 31568953, "comment_id": 51098591, "body": "<b>Have you run through the code line by line to determine where a variable becomes somehting you didn&#39;t expect?</b> Audit a specific cell that you expect to &quot;solve&quot;. When you run through your code, and get to that cell, what happens? What did you expect to happen? And provide specific instances of where such problems occurred (&quot;Cell A5 = 001, which I expected to be equal to C5, which = 001, but when I ran the code, A5 compared with D5 instead of C5&quot;)."}, {"owner": {"reputation": 398, "user_id": 1568996, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/e626621d7b6054a4f491fc974063d8ae?s=128&d=identicon&r=PG", "display_name": "DeerSpotter", "link": "https://stackoverflow.com/users/1568996/deerspotter"}, "reply_to_user": {"reputation": 3650, "user_id": 5090027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/904db949ae64fe1a63ea8b4c677e6d57?s=128&d=identicon&r=PG&f=1", "display_name": "Grade &#39;Eh&#39; Bacon", "link": "https://stackoverflow.com/users/5090027/grade-eh-bacon"}, "edited": false, "score": 0, "creation_date": 1437597526, "post_id": 31568953, "comment_id": 51101984, "body": "Hey could you check the code i posted below?"}], "answers": [{"comments": [{"owner": {"reputation": 398, "user_id": 1568996, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/e626621d7b6054a4f491fc974063d8ae?s=128&d=identicon&r=PG", "display_name": "DeerSpotter", "link": "https://stackoverflow.com/users/1568996/deerspotter"}, "edited": false, "score": 0, "creation_date": 1490801995, "post_id": 31706583, "comment_id": 73277647, "body": "if you guys have an issue with this, please let me know. I will try to explain it to the best ability i can present to you. This took me months to figure out."}], "tags": [], "owner": {"reputation": 398, "user_id": 1568996, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/e626621d7b6054a4f491fc974063d8ae?s=128&d=identicon&r=PG", "display_name": "DeerSpotter", "link": "https://stackoverflow.com/users/1568996/deerspotter"}, "is_accepted": true, "score": 1, "last_activity_date": 1438188772, "creation_date": 1438188772, "answer_id": 31706583, "question_id": 31568953, "link": "https://stackoverflow.com/questions/31568953/2-different-ranges-compare-from-different-sheets-not-working-vba/31706583#31706583", "title": "2 different Ranges Compare from different Sheets not Working VBA", "body": "<p>Instead of comparing from different sheets, i just brought the range over to the current sheet and made it a requirement to use a selection before the compare initiates. Since the source range is on a row, i used k as the integer for where the source is. The source always changes and is always above the selection. so that line is used for the compare. Of coarse i can probably now even go further and create a selection range from another sheet. But this works for me now. I hope i saved some time for other people struggling with this as i was. </p>\n\n<pre><code>Sub CompareRanges()\napplication.ScreenUpdating = False\n    Dim Report As Worksheet\n    Dim i As Integer, j As Integer, k As Integer\n    Dim lastrow As Integer\n    Dim LastColumn As Integer\n    Dim sht As Worksheet\n    Dim cell As Range\n    Dim x As Long, y As Long\n\n    Set sht = ThisWorkbook.Sheets(\"SAP Output DATA\")\n\n    lastrow = sht.UsedRange.Rows.Count\n    LastColumn = sht.UsedRange.Columns.Count\n\n    'If Selection Is Nothing Then\n    'MsgBox \"nothing selected, please select range.\"\n    'Else\n\n    'x is the first row number of selection, y is the last.\n    x = Selection.Rows(1).row\n    y = Selection.Rows.Count + x - 1\n    'MsgBox x &amp; \"  \" &amp; y\n\n    'give row number of cell above selection.\n    k = Selection.Rows(1).Offset(-1, 0).row\n    'MsgBox k\n\n    For i = x To y 'lastrow\n    'For i = 3 To lastrow 'lastrow\n        For j = 5 To LastColumn\n            If sht.Cells(i, 1).Value &lt;&gt; \"\" Then 'This will omit blank cells at the end (in the event that the column lengths are not equal.\n                'sht.cell (2, j) \"k is the variable for where is the source.\"\n                If InStr(1, sht.Cells(k, j).Value, sht.Cells(i, 1).Value, vbTextCompare) &gt; 0 Then\n                    sht.Cells(i, 1).Interior.Color = RGB(255, 255, 255) 'White background\n                    sht.Cells(i, 1).Font.Color = RGB(0, 0, 0) 'Black font color\n                    Exit For\n                Else\n                    sht.Cells(i, 1).Interior.Color = RGB(156, 0, 6) 'Dark red background\n                    sht.Cells(i, 1).Font.Color = RGB(255, 199, 206) 'Light red font color\n                End If\n            End If\n        Next j\n    Next i\n\n    'End If\napplication.ScreenUpdating = True\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 398, "user_id": 1568996, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/e626621d7b6054a4f491fc974063d8ae?s=128&d=identicon&r=PG", "display_name": "DeerSpotter", "link": "https://stackoverflow.com/users/1568996/deerspotter"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 87, "favorite_count": 0, "accepted_answer_id": 31706583, "answer_count": 1, "score": -1, "last_activity_date": 1438188772, "creation_date": 1437582773, "last_edit_date": 1437590341, "question_id": 31568953, "link": "https://stackoverflow.com/questions/31568953/2-different-ranges-compare-from-different-sheets-not-working-vba", "title": "2 different Ranges Compare from different Sheets not Working VBA", "body": "<p>Why isnt this text Compare working? I'm trying to compare 2 different ranges from different sheets. </p>\n\n<p>Is there a good simple way of doing this? </p>\n\n<pre><code>Sub selecttest()\n\nText3 = Sheets(\"Input DATA\").Range(Cells(2, 2), Cells(2, Columns.Count).End(xlToLeft))\nText4 = Sheets(\"SAP Output DATA\").Range(Cells(3, 1), Cells(Rows.Count, 1).End(xlUp))\n\nIf StrComp(Text3, Text4, vbTextCompare) = 0 Then\n\nElse\n\nCells(Cell.Row, \"A\").Interior.ColorIndex = 26\nCells(Cell.Row, \"B\").Interior.ColorIndex = 26\nCells(Cell.Row, \"C\").Interior.ColorIndex = 26\nCells(Cell.Row, \"D\").Interior.ColorIndex = 26\n\nEnd If\nEnd Sub\n</code></pre>\n\n<p>Is there something that im doing incorrectly? </p>\n\n<p>Also tried this with no errors but it wont solve:</p>\n\n<pre><code>Sub comprangetest()\n\nWith ThisWorkbook.Sheets(\"Input DATA\")\nText3 = Range(Cells(2, 2), Cells(2, Columns.Count).End(xlToLeft)).Select\nEnd With\n\nWith ThisWorkbook.Sheets(\"SAP Output DATA\")\nText4 = Sheets(\"SAP Output DATA\").Range(Cells(3, 1), Cells(Rows.Count, 1).End(xlUp)).Select\nEnd With\n\n'Text3 = Sheets(\"Input DATA\").Range(Cells(2, 2), Cells(2, Columns.Count).End(xlToLeft))\n'Text4 = Sheets(\"SAP Output DATA\").Range(Cells(3, 1), Cells(Rows.Count, 1).End(xlUp))\n\nIf StrComp(Text3, Text4, vbTextCompare) = 0 Then\n\nElse\n\nActiveSheet.Cells(Cell.Row, \"A\").Interior.ColorIndex = 26\nActiveSheet.Cells(Cell.Row, \"B\").Interior.ColorIndex = 26\nActiveSheet.Cells(Cell.Row, \"C\").Interior.ColorIndex = 26\nActiveSheet.Cells(Cell.Row, \"D\").Interior.ColorIndex = 26\n\nEnd If\n\nEnd Sub\n</code></pre>\n\n<p>Am i using the correct method?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2239, "user_id": 1473412, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7ac8599add0ace676200f6d50d6d2ff1?s=128&d=identicon&r=PG", "display_name": "Gravitate", "link": "https://stackoverflow.com/users/1473412/gravitate"}, "edited": false, "score": 0, "creation_date": 1557418994, "post_id": 31568859, "comment_id": 98767534, "body": "I suggest you avoid using VLOOKUP by using an INDEX/MATCH instead. INDEX/MATCH much faster than VLOOKUP when dealing with a large number of cells. So, change <code>&quot;=VLOOKUP(RC[-1], R1C1:R50000C1, 1, False)&quot;</code> for <code>&quot;=INDEX( R1C1:R50000C1,MATCH(RC[-1], R1C1:R50000C1,0))&quot;</code>."}], "answers": [{"tags": [], "owner": {"reputation": 343, "user_id": 5103770, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a5f1c3817c808ae0036a22d25db7853?s=128&d=identicon&r=PG&f=1", "display_name": "Stadem", "link": "https://stackoverflow.com/users/5103770/stadem"}, "is_accepted": true, "score": 4, "last_activity_date": 1437582960, "creation_date": 1437582960, "answer_id": 31569022, "question_id": 31568859, "link": "https://stackoverflow.com/questions/31568859/vlookup-help-needed-cant-seem-to-find-this-answer-elsewhere/31569022#31569022", "title": "Vlookup help needed - Can&#39;t seem to find this answer elsewhere", "body": "<p>You're appending the number 37000 to the string \"J2:J2\", which gives you \"J2:J237000\".</p>\n\n<p>Replace <code>Range(\"J2:J2\" &amp; lr)</code> with <code>Range(\"J2:J\" &amp; lr)</code>. You should be good to go.</p>\n"}], "owner": {"reputation": 23, "user_id": 5144546, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cb93c39ab7ee75b4ceabeddd57b61210?s=128&d=identicon&r=PG&f=1", "display_name": "Toomz", "link": "https://stackoverflow.com/users/5144546/toomz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 117, "favorite_count": 0, "accepted_answer_id": 31569022, "answer_count": 1, "score": 0, "last_activity_date": 1437582960, "creation_date": 1437582499, "last_edit_date": 1531164843, "question_id": 31568859, "link": "https://stackoverflow.com/questions/31568859/vlookup-help-needed-cant-seem-to-find-this-answer-elsewhere", "title": "Vlookup help needed - Can&#39;t seem to find this answer elsewhere", "body": "<p>I'm trying to lookup an ID from column I, in column A. This is the code I'm using: </p>\n\n<p>Dim x As Long</p>\n\n<p>lr = Worksheets(\"Risk Explorer greeks\").Cells(Rows.Count, \"I\").End(xlUp).Row</p>\n\n<p>Range(\"J2:J2\" &amp; lr).FormulaR1C1 = \"=VLOOKUP(RC[-1], R1C1:R50000C1, 1, False)\"</p>\n\n<p>I only have ~40,000 values in column J, however when I run this code it ends up populating all the way down to cell 237,000 - how can I amend the code so that it only looks up column J where it has a value, and doesnt lookup loads of blank cells?</p>\n\n<p>Alternatively if there is a faster way to do this lookup rather than the above formula, then pls suggest - I'd be grateful for any help!</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 5345, "user_id": 3561813, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/958afeca6b11ffa0e83b97b516c88dc7?s=128&d=identicon&r=PG&f=1", "display_name": "basodre", "link": "https://stackoverflow.com/users/3561813/basodre"}, "edited": false, "score": 0, "creation_date": 1437585545, "post_id": 31568636, "comment_id": 51094654, "body": "A couple of questions: (1) Are dates always sorted or do situations arise when the date chronology is mixed? (2) Do you need the function to return the start to the end, or should it start at the cell address and move down? To clarify, if the formula were <code>=cellrange(A9, 2014)</code>, should it return <code>$A$2:$A$23</code> or does it return <code>$A$9:$A$23</code>?"}, {"owner": {"reputation": 2395, "user_id": 1803908, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/RCEu7.jpg?s=128&g=1", "display_name": "Newskooler", "link": "https://stackoverflow.com/users/1803908/newskooler"}, "reply_to_user": {"reputation": 5345, "user_id": 3561813, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/958afeca6b11ffa0e83b97b516c88dc7?s=128&d=identicon&r=PG&f=1", "display_name": "basodre", "link": "https://stackoverflow.com/users/3561813/basodre"}, "edited": false, "score": 0, "creation_date": 1437585640, "post_id": 31568636, "comment_id": 51094717, "body": "Good Questions!  (1) Dates are always sorted (2) It will be best for the function to go from the beginning, however this is not 100% mandatory (it&#39;s more like a very good upgrade). If you can easily implement it, it will be great though! So if the <code>cellrange(A9, 2014)</code> it will be best to return <code>$A$2:$A$23</code>"}], "answers": [{"comments": [{"owner": {"reputation": 2395, "user_id": 1803908, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/RCEu7.jpg?s=128&g=1", "display_name": "Newskooler", "link": "https://stackoverflow.com/users/1803908/newskooler"}, "edited": false, "score": 0, "creation_date": 1437596202, "post_id": 31570861, "comment_id": 51101127, "body": "This is great. One thing I found is that when the cell does not match the date that&#39;s being looked for, it gives an error (as noted by the code). Is there much change that needs to be done, in order for the formula, instead of giving an error, of proving the result. Example: <code>=cellrange(A2, 2014)</code> = <code>$A$2:$A$23</code> &amp; <code>=cellrange(A2, 2015)</code> = <code>$A$24:$A$40</code> instead of an error?"}, {"owner": {"reputation": 5345, "user_id": 3561813, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/958afeca6b11ffa0e83b97b516c88dc7?s=128&d=identicon&r=PG&f=1", "display_name": "basodre", "link": "https://stackoverflow.com/users/3561813/basodre"}, "reply_to_user": {"reputation": 2395, "user_id": 1803908, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/RCEu7.jpg?s=128&g=1", "display_name": "Newskooler", "link": "https://stackoverflow.com/users/1803908/newskooler"}, "edited": false, "score": 0, "creation_date": 1437598259, "post_id": 31570861, "comment_id": 51102380, "body": "@StelianNenkov Check my edit to the original answer. I&#39;ve changed some of the code to allow for the treatment you&#39;ve requested. Let me know if it works ok"}, {"owner": {"reputation": 2395, "user_id": 1803908, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/RCEu7.jpg?s=128&g=1", "display_name": "Newskooler", "link": "https://stackoverflow.com/users/1803908/newskooler"}, "edited": false, "score": 0, "creation_date": 1437599529, "post_id": 31570861, "comment_id": 51103024, "body": "It works great Thank you! It only does not work properly for YTD for some reason! I am start examining the change you did. Thanks again, this was very insightful."}], "tags": [], "owner": {"reputation": 5345, "user_id": 3561813, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/958afeca6b11ffa0e83b97b516c88dc7?s=128&d=identicon&r=PG&f=1", "display_name": "basodre", "link": "https://stackoverflow.com/users/3561813/basodre"}, "is_accepted": false, "score": 1, "last_activity_date": 1437598226, "last_edit_date": 1437598226, "creation_date": 1437588661, "answer_id": 31570861, "question_id": 31568636, "link": "https://stackoverflow.com/questions/31568636/how-to-build-a-dynamic-cell-range-output-function-using-vba/31570861#31570861", "title": "How to build a dynamic cell range output function using VBA", "body": "<p>I've written some code that {I think} captures what it is that you're trying to do. I'll preface it with a few points. (1) The code throws the <code>#Value</code> error if <code>CellA</code> is not a <code>Date</code> value (I think this is for self-explanatory reasons). (2) If the Year entry in the formula doesn't match the year in <code>CellA</code>, it also throws <code>#Value</code>. I'm not sure if you wanted to return this type of treatment, but I personally thought it would be pretty confusing for a user if they point to <code>CellA</code>, with a year of 2014, and they're looking for 2013 dates. Let me know if you want this changed. </p>\n\n<p>Take a look at the code, give it some test cases, and let me know if anything else needs to be modified.</p>\n\n<p>EDITED BASED ON NEW INFORMATION:\nI didn't get as much time to test this code as I normally would, but see if it works better for you.</p>\n\n<pre><code>Function cellrange(cellA As Range, vFilter As Variant) As String\n    Dim rStart As Range\n    Dim rEnd As Range\n    Dim bFinished As Boolean\n    Dim dToday As Date\n    Dim nOffset As Integer\n\n    'Throw an error if cell is not a date cell\n    If Not IsDate(cellA) Then\n        cellrange = CVErr(xlErrValue)\n    End If\n\n    If IsNumeric(vFilter) Then\n        If vFilter = Year(cellA) Then\n            'Below code if there is a year entered as vFilter\n            Set rStart = cellA\n            bFinished = False\n\n            'Loop to find start of year range\n            Do\n                If IsDate(rStart.Offset(-1)) Then\n                    If Year(rStart.Offset(-1)) = vFilter Then\n                        Set rStart = rStart.Offset(-1)\n                    Else\n                        bFinished = True\n                    End If\n                Else\n                    bFinished = True\n                End If\n            Loop While bFinished = False\n\n            'Loop to find end of year range\n            Set rEnd = cellA\n            bFinished = False\n            Do\n                If IsDate(rEnd.Offset(1)) Then\n                    If Year(rEnd.Offset(1)) = vFilter Then\n                        Set rEnd = rEnd.Offset(1)\n                    Else\n                        bFinished = True\n                    End If\n                Else\n                    bFinished = True\n                End If\n            Loop While bFinished = False\n\n            cellrange = rStart.Address &amp; \":\" &amp; rEnd.Address\n        Else\n            If Year(cellA) &gt; vFilter Then\n                nOffset = -1\n            Else\n                nOffset = 1\n            End If\n\n            Set rEnd = cellA\n            bFinished = False\n\n            Do\n                If IsDate(rEnd.Offset(nOffset)) Then\n                    If Year(rEnd.Offset(nOffset)) &lt;&gt; vFilter Then\n                        Set rEnd = rEnd.Offset(nOffset)\n                    Else\n                        Set rEnd = rEnd.Offset(nOffset)\n                        bFinished = True\n                    End If\n                Else\n                    bFinished = True\n                End If\n            Loop While bFinished = False\n\n            Set rStart = rEnd\n            bFinished = False\n\n            Do\n                If IsDate(rStart.Offset(nOffset)) Then\n                    If Year(rStart.Offset(nOffset)) = Year(rStart) Then\n                        Set rStart = rStart.Offset(nOffset)\n                    Else\n                        bFinished = True\n                    End If\n                Else\n                    bFinished = True\n                End If\n            Loop While bFinished = False\n\n\n            If nOffset = -1 Then\n                cellrange = rStart.Address &amp; \":\" &amp; rEnd.Address\n            Else\n                cellrange = rEnd.Address &amp; \":\" &amp; rStart.Address\n            End If\n        End If\n    Else\n        If vFilter = \"YTD\" Then\n            'Below code if there is 'YTD' entered as vFilter\n            Set rStart = cellA\n            bFinished = False\n            dToday = Date\n\n            'Loop to find start of year range\n            Do\n                If IsDate(rStart.Offset(-1)) Then\n                    If Year(rStart.Offset(-1)) = Year(rStart) Then\n                        Set rStart = rStart.Offset(-1)\n                    Else\n                        bFinished = True\n                    End If\n                Else\n                    bFinished = True\n                End If\n            Loop While bFinished = False\n\n            'Loop to find end of year range\n            Set rEnd = cellA\n            bFinished = False\n            Do\n                If rEnd &gt; dToday Then\n                    nOffset = -1\n                    If IsDate(rEnd.Offset(nOffset)) Then\n                        If Year(rEnd.Offset(nOffset)) = Year(rEnd) And rEnd.Offset(nOffset) &gt;= dToday Then\n                            Set rEnd = rEnd.Offset(nOffset)\n                        Else\n                            bFinished = True\n                        End If\n                    Else\n                        bFinished = True\n                    End If\n                Else\n                    nOffset = 1\n\n                    If IsDate(rEnd.Offset(nOffset)) Then\n                        If Year(rEnd.Offset(nOffset)) = Year(rEnd) And rEnd.Offset(nOffset) &lt;= dToday Then\n                            Set rEnd = rEnd.Offset(nOffset)\n                        Else\n                            bFinished = True\n                        End If\n                    Else\n                        bFinished = True\n                    End If\n\n                End If\n\n            Loop While bFinished = False\n\n            cellrange = rStart.Address &amp; \":\" &amp; rEnd.Address\n        Else\n            'Below returns the 'ALL' case\n\n            Set rStart = cellA\n            bFinished = False\n\n            'Loop to find start of year range\n            Do\n                If IsDate(rStart.Offset(-1)) Then\n                    Set rStart = rStart.Offset(-1)\n                Else\n                    bFinished = True\n                End If\n            Loop While bFinished = False\n\n            'Loop to find end of year range\n            Set rEnd = cellA\n            bFinished = False\n            Do\n                If IsDate(rEnd.Offset(1)) Then\n                    Set rEnd = rEnd.Offset(1)\n                Else\n                    bFinished = True\n                End If\n            Loop While bFinished = False\n\n            cellrange = rStart.Address &amp; \":\" &amp; rEnd.Address\n        End If\n    End If\nEnd Function\n</code></pre>\n\n<hr>\n\n<p>Older, pre-edit code</p>\n\n<pre><code>Function cellrange(cellA As Range, vFilter As Variant) As String\n    Dim rStart As Range\n    Dim rEnd As Range\n    Dim bFinished As Boolean\n    Dim dToday As Date\n    Dim nOffset As Integer\n\n    'Throw an error if cell is not a date cell\n    If Not IsDate(cellA) Then\n        cellrange = CVErr(xlErrValue)\n    End If\n\n    'Throw an error if the cell year does not match the value being searched\n    If IsNumeric(vFilter) And vFilter &lt;&gt; Year(cellA) Then\n        cellrange = CVErr(xlErrValue)\n    End If\n\n\n    If IsNumeric(vFilter) Then\n        'Below code if there is a year entered as vFilter\n        Set rStart = cellA\n        bFinished = False\n\n        'Loop to find start of year range\n        Do\n            If IsDate(rStart.Offset(-1)) Then\n                If Year(rStart.Offset(-1)) = vFilter Then\n                    Set rStart = rStart.Offset(-1)\n                Else\n                    bFinished = True\n                End If\n            Else\n                bFinished = True\n            End If\n        Loop While bFinished = False\n\n        'Loop to find end of year range\n        Set rEnd = cellA\n        bFinished = False\n        Do\n            If IsDate(rEnd.Offset(1)) Then\n                If Year(rEnd.Offset(1)) = vFilter Then\n                    Set rEnd = rEnd.Offset(1)\n                Else\n                    bFinished = True\n                End If\n            Else\n                bFinished = True\n            End If\n        Loop While bFinished = False\n\n        cellrange = rStart.Address &amp; \":\" &amp; rEnd.Address\n    Else\n        If vFilter = \"YTD\" Then\n            'Below code if there is 'YTD' entered as vFilter\n            Set rStart = cellA\n            bFinished = False\n            dToday = Date\n\n            'Loop to find start of year range\n            Do\n                If IsDate(rStart.Offset(-1)) Then\n                    If Year(rStart.Offset(-1)) = Year(rStart) Then\n                        Set rStart = rStart.Offset(-1)\n                    Else\n                        bFinished = True\n                    End If\n                Else\n                    bFinished = True\n                End If\n            Loop While bFinished = False\n\n            'Loop to find end of year range\n            Set rEnd = cellA\n            bFinished = False\n            Do\n                If rEnd &gt; dToday Then\n                    nOffset = -1\n                    If IsDate(rEnd.Offset(nOffset)) Then\n                        If Year(rEnd.Offset(nOffset)) = Year(rEnd) And rEnd.Offset(nOffset) &gt;= dToday Then\n                            Set rEnd = rEnd.Offset(nOffset)\n                        Else\n                            bFinished = True\n                        End If\n                    Else\n                        bFinished = True\n                    End If\n                Else\n                    nOffset = 1\n\n                    If IsDate(rEnd.Offset(nOffset)) Then\n                        If Year(rEnd.Offset(nOffset)) = Year(rEnd) And rEnd.Offset(nOffset) &lt;= dToday Then\n                            Set rEnd = rEnd.Offset(nOffset)\n                        Else\n                            bFinished = True\n                        End If\n                    Else\n                        bFinished = True\n                    End If\n\n                End If\n\n'                If IsDate(rEnd.Offset(nOffset)) Then\n'                    If Year(rEnd.Offset(nOffset)) = Year(rEnd) And rEnd.Offset(nOffset) &lt; dToday Then\n'                        Set rEnd = rEnd.Offset(nOffset)\n'                    Else\n'                        bFinished = True\n'                    End If\n'                Else\n'                    bFinished = True\n'                End If\n            Loop While bFinished = False\n\n            cellrange = rStart.Address &amp; \":\" &amp; rEnd.Address\n        Else\n            'Below returns the 'ALL' case\n\n            Set rStart = cellA\n            bFinished = False\n\n            'Loop to find start of year range\n            Do\n                If IsDate(rStart.Offset(-1)) Then\n                    Set rStart = rStart.Offset(-1)\n                Else\n                    bFinished = True\n                End If\n            Loop While bFinished = False\n\n            'Loop to find end of year range\n            Set rEnd = cellA\n            bFinished = False\n            Do\n                If IsDate(rEnd.Offset(1)) Then\n                    Set rEnd = rEnd.Offset(1)\n                Else\n                    bFinished = True\n                End If\n            Loop While bFinished = False\n\n            cellrange = rStart.Address &amp; \":\" &amp; rEnd.Address\n        End If\n    End If\nEnd Function\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2395, "user_id": 1803908, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/RCEu7.jpg?s=128&g=1", "display_name": "Newskooler", "link": "https://stackoverflow.com/users/1803908/newskooler"}, "edited": false, "score": 0, "creation_date": 1437602719, "post_id": 31571932, "comment_id": 51104480, "body": "What you are saying is completely true and thank you for the input, however I am trying to either:  (1) build a formula that can account for all my scenarios; which is actually quite hard to do; or (2) build parts of the most needed parts from the formulas, which is a nice stepping stone I think. Also, when I did it with formula, it was never ending as the complexity increased more and more."}, {"owner": {"user_type": "does_not_exist", "display_name": "user3904868"}, "reply_to_user": {"reputation": 2395, "user_id": 1803908, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/RCEu7.jpg?s=128&g=1", "display_name": "Newskooler", "link": "https://stackoverflow.com/users/1803908/newskooler"}, "edited": false, "score": 0, "creation_date": 1437603430, "post_id": 31571932, "comment_id": 51104808, "body": "Often the fastest solution is using the inbuilt Excel functions, I recommend you measure the performance difference between them. Also, if you decide to use a custom VBA function then make sure you fully qualify your  objects as the other code examples will fail if the sheet containing the data is not selected."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user3904868"}, "is_accepted": false, "score": 0, "last_activity_date": 1437594083, "last_edit_date": 1437594083, "creation_date": 1437592105, "answer_id": 31571932, "question_id": 31568636, "link": "https://stackoverflow.com/questions/31568636/how-to-build-a-dynamic-cell-range-output-function-using-vba/31571932#31571932", "title": "How to build a dynamic cell range output function using VBA", "body": "<p>Most of this can be done easily using just Excel formula.  The same logic can be used to develop a VBA function</p>\n\n<p><a href=\"https://i.stack.imgur.com/HgC1f.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/HgC1f.png\" alt=\"enter image description here\"></a></p>\n\n<p>I just noticed that your dates do not cover the first to last of the month. It shouldn't affect the original YTD/ALL but if you need the first and last date specified then this will work</p>\n\n<p><a href=\"https://i.stack.imgur.com/8cmYP.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/8cmYP.png\" alt=\"enter image description here\"></a></p>\n"}, {"comments": [{"owner": {"reputation": 2395, "user_id": 1803908, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/RCEu7.jpg?s=128&g=1", "display_name": "Newskooler", "link": "https://stackoverflow.com/users/1803908/newskooler"}, "edited": false, "score": 0, "creation_date": 1437606109, "post_id": 31574479, "comment_id": 51105766, "body": "I very much like this solution, however for some reason it does not work. Did you manage to test it yourself?"}, {"owner": {"reputation": 2787, "user_id": 3688861, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54740a77960418f6992ef8e8cf88deba?s=128&d=identicon&r=PG&f=1", "display_name": "Tragamor", "link": "https://stackoverflow.com/users/3688861/tragamor"}, "reply_to_user": {"reputation": 2395, "user_id": 1803908, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/RCEu7.jpg?s=128&g=1", "display_name": "Newskooler", "link": "https://stackoverflow.com/users/1803908/newskooler"}, "edited": false, "score": 0, "creation_date": 1437606455, "post_id": 31574479, "comment_id": 51105865, "body": "Yes - it works for me fine and will also work with non-contiguous dates. What error do you get?"}, {"owner": {"reputation": 2395, "user_id": 1803908, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/RCEu7.jpg?s=128&g=1", "display_name": "Newskooler", "link": "https://stackoverflow.com/users/1803908/newskooler"}, "edited": false, "score": 0, "creation_date": 1437606595, "post_id": 31574479, "comment_id": 51105900, "body": "For example, for current year <code>=cellrange(A2,2)</code> = <code>$A$2:$A$23</code>; whereas it should yield <code>$A$24:$A$40</code>. I see that the formula does not check the Current Year (i.e. in our case 2015), but instead check the year in the cell provided. Also for YTD, it seems to work backwards (upwards) as well. My idea is that using the same cell for <code>SrcCell</code> with different input in <code>DtRange</code> the user can get different results. Did I manage to describe it better?"}, {"owner": {"reputation": 2787, "user_id": 3688861, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54740a77960418f6992ef8e8cf88deba?s=128&d=identicon&r=PG&f=1", "display_name": "Tragamor", "link": "https://stackoverflow.com/users/3688861/tragamor"}, "reply_to_user": {"reputation": 2395, "user_id": 1803908, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/RCEu7.jpg?s=128&g=1", "display_name": "Newskooler", "link": "https://stackoverflow.com/users/1803908/newskooler"}, "edited": false, "score": 0, "creation_date": 1437607143, "post_id": 31574479, "comment_id": 51106041, "body": "There are some slight differences; as you say - the macro uses the year of the reference cell as the input year. If you are looking for just a year then you don&#39;t need to use a reference cell as the range you want would not include the reference cell. YearToDate also works out the range for the first date in the year of your reference cell to the reference cell."}, {"owner": {"reputation": 2395, "user_id": 1803908, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/RCEu7.jpg?s=128&g=1", "display_name": "Newskooler", "link": "https://stackoverflow.com/users/1803908/newskooler"}, "edited": false, "score": 0, "creation_date": 1437607305, "post_id": 31574479, "comment_id": 51106077, "body": "I agree, I still learn a lot from it and I very much like the compactness of this solution. Let&#39;s see if I will be able to build on both. Thanks a lot!"}], "tags": [], "owner": {"reputation": 2787, "user_id": 3688861, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54740a77960418f6992ef8e8cf88deba?s=128&d=identicon&r=PG&f=1", "display_name": "Tragamor", "link": "https://stackoverflow.com/users/3688861/tragamor"}, "is_accepted": false, "score": 1, "last_activity_date": 1437614996, "last_edit_date": 1437614996, "creation_date": 1437601236, "answer_id": 31574479, "question_id": 31568636, "link": "https://stackoverflow.com/questions/31568636/how-to-build-a-dynamic-cell-range-output-function-using-vba/31574479#31574479", "title": "How to build a dynamic cell range output function using VBA", "body": "<p>A slightly more compact function...</p>\n\n<blockquote>\n  <p>To use it in the spreadsheet, the enumerated values won't work; eg. use '=CellRange(C3, 1)'</p>\n</blockquote>\n\n<pre><code>Public Enum xlDateAction\n    xlYearToDate = 1\n    xlCurrentYear = 2\n    xlAll = 3\nEnd Enum\n\nPublic Function CellRange(SrcCell As Range, DtRange As xlDateAction) As String\n\n    Application.ScreenUpdating = False\n    If Not IsDate(SrcCell.Value) Then Exit Function\n\n    Dim CellDate As Date: CellDate = SrcCell.Value\n\n    Dim EndCell As Range\n    Set EndCell = Columns(SrcCell.Column).Find(What:=\"\", After:=[SrcCell]).Offset(-1, 0)\n    Dim StartCell As Range: Set StartCell = SrcCell\n\n    Do Until StartCell.Row = 1 Or Not IsDate(StartCell.Value)\n        Set StartCell = StartCell.Offset(-1, 0)\n    Loop\n    If Not IsDate(StartCell.Value) Then Set StartCell = StartCell.Offset(1, 0)\n\n    If DtRange &lt;&gt; xlAll Then\n        Dim SrcYear As Long: SrcYear = Year(CDate(SrcCell.Value))\n        Do Until StartCell.Address = SrcCell.Address Or Year(CDate(StartCell.Value)) = SrcYear\n            If Year(CDate(StartCell.Value)) &lt; SrcYear Then Set StartCell = StartCell.Offset(1, 0)\n        Loop\n        If DtRange = xlCurrentYear Then\n            Do Until EndCell.Address = SrcCell.Address Or Year(CDate(EndCell.Value)) = SrcYear\n                If Year(CDate(EndCell.Value)) &gt; SrcYear Then Set EndCell = EndCell.Offset(-1, 0)\n            Loop\n        Else\n            Set EndCell = SrcCell\n        End If\n    End If\n\n    CellRange = Range(StartCell, EndCell).Address\n    Application.ScreenUpdating = True\n\nEnd Function\n</code></pre>\n\n<blockquote>\n  <p>******* <strong>UPDATE</strong> *******</p>\n</blockquote>\n\n<p>Added a year override function which I think should therefore now do the range selections you want... (Also tweaked the enum as it makes more sense to me now this way around)</p>\n\n<pre><code>Public Enum xlDateAction\n    xlCurrentYear = 1\n    xlYearToDate = 2\n    xlAll = 3\nEnd Enum\n\nPublic Function CellRange(SrcCell As Range, DtRange As xlDateAction, _\n    Optional YearOverride As Long = 0) As String\n\n    Application.ScreenUpdating = False\n    If Not IsDate(SrcCell.Value) Then Exit Function\n\n    If YearOverride = Year(CDate(SrcCell.Value)) Then YearOverride = 0\n    Dim TargetYear As Long: TargetYear = YearOverride\n    Dim StartCell As Range: Set StartCell = SrcCell\n    Dim EndCell As Range\n    Set EndCell = Columns(SrcCell.Column).Find(What:=\"\", After:=[SrcCell]).Offset(-1, 0)\n\n    Do Until StartCell.Row = 1 Or Not IsDate(StartCell.Value)\n        Set StartCell = StartCell.Offset(-1, 0)\n    Loop\n    If Not IsDate(StartCell.Value) Then Set StartCell = StartCell.Offset(1, 0)\n\n    If TargetYear = 0 Then TargetYear = Year(CDate(SrcCell.Value))\n\n    If DtRange &lt;&gt; xlAll Then\n        Do Until StartCell.Address = EndCell.Address Or Year(CDate(StartCell.Value)) &gt;= TargetYear\n            If Year(CDate(StartCell.Value)) &lt; TargetYear Then Set StartCell = StartCell.Offset(1, 0)\n        Loop\n        If DtRange = xlYearToDate And Year(CDate(StartCell.Value)) &gt;= TargetYear And _\n            TargetYear &gt; Year(CDate(SrcCell.Value)) Then Set StartCell = StartCell.Offset(-1, 0)\n\n        If DtRange = xlCurrentYear Then\n            Do Until EndCell.Address = StartCell.Address Or Year(CDate(EndCell.Value)) &lt;= TargetYear\n                If Year(CDate(EndCell.Value)) &gt; TargetYear Then Set EndCell = EndCell.Offset(-1, 0)\n            Loop\n            ' If target year doesn't exist in dates\n            If Year(CDate(EndCell.Value)) &lt;&gt; TargetYear Then Exit Function\n        Else\n            Set EndCell = SrcCell\n        End If\n    End If\n\n    CellRange = Range(StartCell, EndCell).Address\n    Application.ScreenUpdating = True\n\nEnd Function\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2395, "user_id": 1803908, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/RCEu7.jpg?s=128&g=1", "display_name": "Newskooler", "link": "https://stackoverflow.com/users/1803908/newskooler"}, "edited": false, "score": 0, "creation_date": 1437621037, "post_id": 31577438, "comment_id": 51109323, "body": "Thanks for the input. It does look like a much more elegant solution. I tested it for <code>=cellrange(A2,2015)</code>, <code>=cellrange(A2,2015)</code>, <code>=cellrange(A2,&quot;YTD&quot;)</code> and <code>=cellrange(A2,&quot;ALL&quot;)</code> and unfortunately it does not work on any of them. It seems to be starting from the cell <code>A2</code> instead of searching for the start place like the longer code does."}, {"owner": {"reputation": 12614, "user_id": 3566998, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S7lz6.png?s=128&g=1", "display_name": "Excel Hero", "link": "https://stackoverflow.com/users/3566998/excel-hero"}, "reply_to_user": {"reputation": 2395, "user_id": 1803908, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/RCEu7.jpg?s=128&g=1", "display_name": "Newskooler", "link": "https://stackoverflow.com/users/1803908/newskooler"}, "edited": false, "score": 0, "creation_date": 1437621402, "post_id": 31577438, "comment_id": 51109403, "body": "Strange. Works for me here. The first param needs only be a date in the column you wish to filter... it does not need to be a the first date."}, {"owner": {"reputation": 12614, "user_id": 3566998, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S7lz6.png?s=128&g=1", "display_name": "Excel Hero", "link": "https://stackoverflow.com/users/3566998/excel-hero"}, "reply_to_user": {"reputation": 2395, "user_id": 1803908, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/RCEu7.jpg?s=128&g=1", "display_name": "Newskooler", "link": "https://stackoverflow.com/users/1803908/newskooler"}, "edited": false, "score": 0, "creation_date": 1437621468, "post_id": 31577438, "comment_id": 51109420, "body": "But I will investigate. Is it possible for you to send me a sample sheet where it does not work? My email address in on my profile page."}, {"owner": {"reputation": 12614, "user_id": 3566998, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S7lz6.png?s=128&g=1", "display_name": "Excel Hero", "link": "https://stackoverflow.com/users/3566998/excel-hero"}, "reply_to_user": {"reputation": 2395, "user_id": 1803908, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/RCEu7.jpg?s=128&g=1", "display_name": "Newskooler", "link": "https://stackoverflow.com/users/1803908/newskooler"}, "edited": false, "score": 0, "creation_date": 1437621982, "post_id": 31577438, "comment_id": 51109552, "body": "I&#39;ve done more testing and it has worked in every case. Can you please send me an example of it not working?"}, {"owner": {"reputation": 2395, "user_id": 1803908, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/RCEu7.jpg?s=128&g=1", "display_name": "Newskooler", "link": "https://stackoverflow.com/users/1803908/newskooler"}, "edited": false, "score": 0, "creation_date": 1437623458, "post_id": 31577438, "comment_id": 51109880, "body": "Check your email and let me know if you have some progress or any questions."}], "tags": [], "owner": {"reputation": 12614, "user_id": 3566998, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S7lz6.png?s=128&g=1", "display_name": "Excel Hero", "link": "https://stackoverflow.com/users/3566998/excel-hero"}, "is_accepted": true, "score": 1, "last_activity_date": 1437633838, "last_edit_date": 1437633838, "creation_date": 1437620285, "answer_id": 31577438, "question_id": 31568636, "link": "https://stackoverflow.com/questions/31568636/how-to-build-a-dynamic-cell-range-output-function-using-vba/31577438#31577438", "title": "How to build a dynamic cell range output function using VBA", "body": "<p>Here is a much shorter solution that works for all three scenarios, and does not require the data worksheet to be active:</p>\n\n<pre><code>Public Function cellrange(rDates As Range, vFilter As Variant) As String\n    Dim i As Long, ndx1 As Long, ndx2 As Long, r As Range, vA As Variant, bErr As Boolean, bAll As Boolean    \n    bErr = True\n    If IsDate(rDates) Then\n        With rDates.EntireColumn\n            i = rDates.Parent.Evaluate(\"count(\" &amp; .Address &amp; \")\")\n            Set r = .Cells(1 - i + rDates.Parent.Evaluate(\"index(\" &amp; .Address &amp; \",match(9.9E+307,\" &amp; .Address &amp; \"))\").Row).Resize(i, 1)\n        End With\n        vA = r.Value\n        Select Case LCase(vFilter)\n            Case \"all\": bErr = 0: bAll = 1\n            Case \"ytd\"\n                For i = 1 To UBound(vA)\n                    If ndx1 = 0 And Year(vA(i, 1)) = Year(Date) Then ndx1 = i\n                    If vA(i, 1) &lt;= Date Then ndx2 = i\n                Next\n            Case Else 'year\n                vFilter = Val(vFilter)\n                If vFilter Then\n                    For i = 1 To UBound(vA)\n                        If ndx1 = 0 And Year(vA(i, 1)) = vFilter Then ndx1 = i\n                        If ndx1 And Year(vA(i, 1)) = vFilter Then ndx2 = i\n                    Next\n                End If\n        End Select\n        If Not bAll Then If ndx1 &gt; 0 And ndx2 &gt; 0 Then Set r = r.Range(r.Parent.Cells(ndx1, 1), r.Parent.Cells(ndx2, 1)): bErr = False\n        If Not bErr Then cellrange = r.Address Else cellrange = CVErr(xlErrValue)\n    End If\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 2395, "user_id": 1803908, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/RCEu7.jpg?s=128&g=1", "display_name": "Newskooler", "link": "https://stackoverflow.com/users/1803908/newskooler"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1057, "favorite_count": 0, "accepted_answer_id": 31577438, "answer_count": 4, "score": 2, "last_activity_date": 1437633838, "creation_date": 1437581779, "question_id": 31568636, "link": "https://stackoverflow.com/questions/31568636/how-to-build-a-dynamic-cell-range-output-function-using-vba", "title": "How to build a dynamic cell range output function using VBA", "body": "<p>I am building a function, that when you select a cell, the output is the cell range from the selection to the last filled cell row on the same column.</p>\n\n<p>Here is the code, that works perfectly.</p>\n\n<pre><code>''Get the cell range from selection to last cell\nFunction CellRange(CellA As Range)\n\n    CellRange = CellA.Address + \":\" + CellA.End(xlDown).Address\n\nEnd Function\n</code></pre>\n\n<p><strong>QUESTION:</strong>\nI want to update this code, so that when used for dates, the user can filter with three options: YTD (year to date), ALL (all time - i.e. getting all data), a year (i.e. 2015 / 2014 / 2013 etc.)</p>\n\n<p>My end goal is for the user to select a cell in a range column of dates and input <em>YTD</em> or <em>ALL</em> or a given year (i.e. <em>2014</em>) and get the range with his filter.</p>\n\n<p><strong>EXAMPLE:</strong> The user writes <code>=cellrange(A2,2014)</code>, which should yield <code>$A$2:$A$23</code> and if the user changes to <code>=cellrange(A2,2014)</code> this should yield <code>$A$24:$A$40</code> as seen on the image.</p>\n\n<p><a href=\"https://i.stack.imgur.com/5bxWA.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/5bxWA.png\" alt=\"enter image description here\"></a></p>\n\n<p>I tried various loops or counts but I feel quite lost as none of my tries apparently made any sense.</p>\n\n<p>I am looking for some help: guidance or a solution to the problem preferably, as I want to build up on it after I tackle this one (hence why I am doing it on VBA).</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1437581258, "post_id": 31568417, "comment_id": 51092089, "body": "How do you want the user to select the sheet? By name?"}], "answers": [{"comments": [{"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 0, "creation_date": 1437588848, "post_id": 31568903, "comment_id": 51096626, "body": "Nice installation instructions!"}], "tags": [], "owner": {"reputation": 2324, "user_id": 5094258, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/n4upu.png?s=128&g=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/5094258/tim"}, "is_accepted": false, "score": 1, "last_activity_date": 1437582614, "creation_date": 1437582614, "answer_id": 31568903, "question_id": 31568417, "link": "https://stackoverflow.com/questions/31568417/how-to-prompt-sheet-selection-in-excel-vba/31568903#31568903", "title": "how to prompt sheet selection in excel vba", "body": "<p>Build your replica Activate form: Insert a userform into your project. Set its caption to \"Activate\". Add a label to it that says \"Activate:\". Add a Listbox and two buttons. Label one button Ok and the other Cancel.</p>\n\n<p>In the UserForm_Initialize sub of the userform, Loop through the names of your sheets and add them to the listbox....something like:</p>\n\n<pre><code>Private Sub UserForm_Initialize()\n    Dim oSheet As Worksheet\n\n    For Each oSheet In Worksheets\n        ListBox1.AddItem oSheet.Name\n    Next\nEnd Sub\n\nPrivate Sub CommandButton1_Click()\n    Sheets(ListBox1.Text).Activate\n    Unload Me\nEnd Sub\n\nPrivate Sub CommandButton2_Click()\n    Unload Me\nEnd Sub\n</code></pre>\n\n<p>Now in the ThisWorkbook section of the VBA Project, add a sub to show your userform:</p>\n\n<pre><code>Private Sub ShowActivateForm()\n    UserForm1.Show\nEnd Sub\n</code></pre>\n\n<p>Go back to Excel and click the Macros button on the developer tab. You should see a macro named ShowActivateForm. Select it and click Options to assign it your desired hotkey.</p>\n"}], "owner": {"reputation": 29, "user_id": 5103470, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab0d456b0b2db58a7c84f8016db13509?s=128&d=identicon&r=PG&f=1", "display_name": "wudat", "link": "https://stackoverflow.com/users/5103470/wudat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 540, "favorite_count": 1, "answer_count": 1, "score": 2, "last_activity_date": 1437582614, "creation_date": 1437581196, "question_id": 31568417, "link": "https://stackoverflow.com/questions/31568417/how-to-prompt-sheet-selection-in-excel-vba", "title": "how to prompt sheet selection in excel vba", "body": "<p>When a workbook has many sheets such as 100, you can activate the sheet quickly by right-clicking the arrows on the bottom left and then a prompts shows up by lets you choose which sheet you want to select. However, I want to be able to reach this prompt without clicking and using just the keyboard. So I want to create a simple macro where I can quickly pull up this prompt by assigning to something like ctrl+g. However, I do not know how to do this in vba.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 5103328, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-h7Ud4x-65lA/AAAAAAAAAAI/AAAAAAAAADs/7uT0mDMzaEw/photo.jpg?sz=128", "display_name": "Jody Patterson", "link": "https://stackoverflow.com/users/5103328/jody-patterson"}, "edited": false, "score": 0, "creation_date": 1437583671, "post_id": 31568665, "comment_id": 51093557, "body": "Thanks Matthew but it is still putting the value at the end of the column not beside Value of Work Done and the sum formula keeps throwing errors I changed it to:   Sub Total_Amount() &#39;New_Entry Macro  Dim ws As Excel.Worksheet Dim lRow As Long Dim lLast As Long  Set ws = Worksheets(&quot;PPC 1&quot;) lRow = 11  Do While lRow &lt;= ws.UsedRange.Rows.Count     If ws.Range(&quot;F&quot; &amp; lRow).Value = &quot;Value of Work Done&quot; Then         lLast = lRow         Exit Do     End If lRow = lRow + 1 Loop  ws.Range(&quot;I&quot; &amp; lRow + 1).Formula = Application.Sum(&quot;I11:I&quot; &amp; lLast)  End Sub"}, {"owner": {"reputation": 2285, "user_id": 4916894, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/54ad102d504b32ad99085f6f6ab14d9d?s=128&d=identicon&r=PG&f=1", "display_name": "David G", "link": "https://stackoverflow.com/users/4916894/david-g"}, "reply_to_user": {"reputation": 13, "user_id": 5103328, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-h7Ud4x-65lA/AAAAAAAAAAI/AAAAAAAAADs/7uT0mDMzaEw/photo.jpg?sz=128", "display_name": "Jody Patterson", "link": "https://stackoverflow.com/users/5103328/jody-patterson"}, "edited": false, "score": 0, "creation_date": 1437585675, "post_id": 31568665, "comment_id": 51094734, "body": "@Jody edit the question instead of writing it here in the comments, as it makes it unreadable. You can then notify Matthew it changed by using the comments. Also, look at how I edited your code in your question to put it in the grey rectangle. While submitting your questions/answers, select the part which is code and click &#39;code sample&#39; in the editing tab up top."}, {"owner": {"reputation": 13, "user_id": 5103328, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-h7Ud4x-65lA/AAAAAAAAAAI/AAAAAAAAADs/7uT0mDMzaEw/photo.jpg?sz=128", "display_name": "Jody Patterson", "link": "https://stackoverflow.com/users/5103328/jody-patterson"}, "edited": false, "score": 0, "creation_date": 1437585941, "post_id": 31568665, "comment_id": 51094880, "body": "Thanks David - will do"}, {"owner": {"reputation": 6311, "user_id": 5073840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yRIIb.jpg?s=128&g=1", "display_name": "MatthewD", "link": "https://stackoverflow.com/users/5073840/matthewd"}, "reply_to_user": {"reputation": 13, "user_id": 5103328, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-h7Ud4x-65lA/AAAAAAAAAAI/AAAAAAAAADs/7uT0mDMzaEw/photo.jpg?sz=128", "display_name": "Jody Patterson", "link": "https://stackoverflow.com/users/5103328/jody-patterson"}, "edited": false, "score": 0, "creation_date": 1437586453, "post_id": 31568665, "comment_id": 51095198, "body": "@Jody Patterson.  I have updated the answer with your changes. Are there any remaining issues?"}], "tags": [], "owner": {"reputation": 6311, "user_id": 5073840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yRIIb.jpg?s=128&g=1", "display_name": "MatthewD", "link": "https://stackoverflow.com/users/5073840/matthewd"}, "is_accepted": false, "score": 0, "last_activity_date": 1437586399, "last_edit_date": 1437586399, "creation_date": 1437581891, "answer_id": 31568665, "question_id": 31568342, "link": "https://stackoverflow.com/questions/31568342/subtotal-formula-with-unknown-amount-of-rows-in-a-column-when-the-range-is-based/31568665#31568665", "title": "Subtotal formula with unknown amount of rows in a column when the range is based on a text in another column", "body": "<pre><code>Dim ws as excel.worksheet\nDim lRow As Long\nDim lLast as Long\n\nSet ws = Worksheets(\"PPC 1\")\nlRow = 11\n\nDo While lRow &lt;= ws.UsedRange.Rows.count\n    If ws.Range(\"F\" &amp; lRow).Value = \"Value of Work Done\" then\n        lLast = lRow\n        Exit do\n    End if\nlRow = lRow + 1\nLoop\n</code></pre>\n\n<p>Then write the formula to whatever column you want</p>\n\n<pre><code>ws.Range(\"I\" &amp; lLast).Formula = Application.Sum(\"I11:I\" &amp; lLast)\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 5103328, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-h7Ud4x-65lA/AAAAAAAAAAI/AAAAAAAAADs/7uT0mDMzaEw/photo.jpg?sz=128", "display_name": "Jody Patterson", "link": "https://stackoverflow.com/users/5103328/jody-patterson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 495, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1437659434, "creation_date": 1437580981, "last_edit_date": 1531161705, "question_id": 31568342, "link": "https://stackoverflow.com/questions/31568342/subtotal-formula-with-unknown-amount-of-rows-in-a-column-when-the-range-is-based", "title": "Subtotal formula with unknown amount of rows in a column when the range is based on a text in another column", "body": "<p>I have a subtotal column that starts in cell I11 but I don't know the amount of rows as it will change each time.  At the end of the column are multiply functions based on the subtotal. </p>\n\n<p>I am trying to create a macro that will count the amount of rows starting at I11 and will go until the value in column F equals \"Value of Work Done\"</p>\n\n<p>This is what I have so far:</p>\n\n<pre><code>Sub Total_Amount()\n'New_Entry Macro\n\n Dim PPC1 As Worksheet\n Dim rowNo As Integer\n rowNo = ActiveCell.Row\n\n If PPC1.Range(\"F11:F\").Value = \"VALUE OF WORK DONE\" Then\n\n    With Range(\"I\" &amp; Rows.Count).End(xlUp)\n        .Offset(1).Formula = \"=SUM(I11:\" &amp; .Address(0, 0) &amp; \")\"\n    End With\n End If\n\nEnd Sub\n</code></pre>\n\n<p>The answer still comes up at the end of the column instead of beside \"Value of Work Done\"</p>\n\n<pre><code> Sub Total_Amount()\n 'New_Entry Macro\n\n Dim ws As Excel.Worksheet\n Dim lRow As Long\n Dim lLast As Long\n\n Set ws = Worksheets(\"PPC 1\")\n Row = 11\n\nDo While lRow &lt;= ws.UsedRange.Rows.Count\n    If ws.Range(\"F\" &amp; lRow).Value = \"Value of Work Done\" Then\n        lLast = lRow\n        Exit Do\n    End If\n    lRow = lRow + 1\nLoop\n\nws.Range(\"I\" &amp; lRow + 1).Formula = Application.Sum(\"I11:I\" &amp; lLast)\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1396, "user_id": 4691433, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/bce001c90ad26add5d7483b714640c12?s=128&d=identicon&r=PG&f=1", "display_name": "puzzlepiece87", "link": "https://stackoverflow.com/users/4691433/puzzlepiece87"}, "edited": false, "score": 0, "creation_date": 1437580739, "post_id": 31568077, "comment_id": 51091717, "body": "Three things: 1. Is the sheet you want this to work for active when you fire the macro? If you just use <code>Range(&quot;D4:D1000&quot;)</code> it assumes <code>Activesheet</code> is the sheet you mean. 2. If your cells say, for example, &quot;Building Blocks &quot;, it will register as false, so you might need to do a Trim. 3. Finally, have you opened up your macro and gone through it step by step by pushing F8, hovering your mouse over <code>cell.value</code> after the next line after <code>If cell.value</code> is highlighted, to make sure the cell.value is what you expect?"}, {"owner": {"reputation": 3, "user_id": 5023644, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1901ae3515a3f2b05911797459166ad1?s=128&d=identicon&r=PG&f=1", "display_name": "Nathan ", "link": "https://stackoverflow.com/users/5023644/nathan"}, "reply_to_user": {"reputation": 1396, "user_id": 4691433, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/bce001c90ad26add5d7483b714640c12?s=128&d=identicon&r=PG&f=1", "display_name": "puzzlepiece87", "link": "https://stackoverflow.com/users/4691433/puzzlepiece87"}, "edited": false, "score": 0, "creation_date": 1437580988, "post_id": 31568077, "comment_id": 51091885, "body": "thank you for commenting back."}, {"owner": {"reputation": 1703, "user_id": 1174399, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a14a1c76042e287e36b1c765fb1eaaa5?s=128&d=identicon&r=PG", "display_name": "Don Jewett", "link": "https://stackoverflow.com/users/1174399/don-jewett"}, "edited": false, "score": 0, "creation_date": 1437581169, "post_id": 31568077, "comment_id": 51092024, "body": "The line ActiveCell.Offset is using a different cell than the ones in your range. Use the cell variable you have set"}, {"owner": {"reputation": 3, "user_id": 5023644, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1901ae3515a3f2b05911797459166ad1?s=128&d=identicon&r=PG&f=1", "display_name": "Nathan ", "link": "https://stackoverflow.com/users/5023644/nathan"}, "edited": false, "score": 0, "creation_date": 1437581258, "post_id": 31568077, "comment_id": 51092088, "body": "1. The sheet will be active when the macro is fired. 2. I am not sure what you mean by a Trim? 3. I just have and it seems to be bringing back &quot;Test&quot;. Apologies i havent been studying VB for too long"}], "answers": [{"tags": [], "owner": {"reputation": 2285, "user_id": 4916894, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/54ad102d504b32ad99085f6f6ab14d9d?s=128&d=identicon&r=PG&f=1", "display_name": "David G", "link": "https://stackoverflow.com/users/4916894/david-g"}, "is_accepted": false, "score": 0, "last_activity_date": 1437581276, "creation_date": 1437581276, "answer_id": 31568444, "question_id": 31568077, "link": "https://stackoverflow.com/questions/31568077/vba-loop-to-target-certain-cells-based-on-criteria/31568444#31568444", "title": "VBA Loop to target certain cells based on criteria", "body": "<p>Not sure I understand. This will go through column D, If it finds Building Blocks, it will look in that row, for a second Building Blocks. If it finds it, it will color the cell in colorindex 7. Same idea with find. Not tested.</p>\n\n<pre><code>Sub Validate()\n\nDim rng As Range\nDim row As Range\nDim cell As Range\n\nSet rng = Range(\"D4:D1000\")\n\n\nFor Each cell In rng\n\n\nIf cell.Value = \"Building Blocks\" Then\n    for i = 2 to 50 'Howverlong your row is, could go to the end too if dynamic\n        if cell(,i).value = cell.value then cell(,i).Interior.ColorIndex = 7\n    next\n\n\n\nElseIf cell.Value = \"Test\" Then\n    for i = 2 to 50 'Howverlong your row is, could go to the end too if dynamic\n        if cell(,i).value = cell.value then cell(,i).Interior.ColorIndex = 4        \n    next\n\n\nEnd If\n\nNext\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3108, "user_id": 5040941, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/291199b5e862bf2befb8ee158c6e544e?s=128&d=identicon&r=PG&f=1", "display_name": "3-14159265358979323846264", "link": "https://stackoverflow.com/users/5040941/3-14159265358979323846264"}, "is_accepted": false, "score": 1, "last_activity_date": 1437581280, "creation_date": 1437581280, "answer_id": 31568447, "question_id": 31568077, "link": "https://stackoverflow.com/questions/31568077/vba-loop-to-target-certain-cells-based-on-criteria/31568447#31568447", "title": "VBA Loop to target certain cells based on criteria", "body": "<p>You are referencing the <code>ActiveCell</code> in the following line ...</p>\n\n<pre><code>ActiveCell.Offset(, 16).Interior.ColorIndex = 7\n</code></pre>\n\n<p>What you really want is ...</p>\n\n<pre><code>cell.Offset(, 16).Interior.ColorIndex =7\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 3108, "user_id": 5040941, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/291199b5e862bf2befb8ee158c6e544e?s=128&d=identicon&r=PG&f=1", "display_name": "3-14159265358979323846264", "link": "https://stackoverflow.com/users/5040941/3-14159265358979323846264"}, "edited": false, "score": 0, "creation_date": 1437581386, "post_id": 31568465, "comment_id": 51092156, "body": "What is the point of <code>cell</code> in that code? :0) I mean, surely <code>ActiveCell</code> should be replaced by <code>cell</code> as per my answer!"}, {"owner": {"reputation": 2035, "user_id": 4567411, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97708ca7070a2e4f32bee58c29a54360?s=128&d=identicon&r=PG&f=1", "display_name": "rwilson", "link": "https://stackoverflow.com/users/4567411/rwilson"}, "reply_to_user": {"reputation": 3108, "user_id": 5040941, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/291199b5e862bf2befb8ee158c6e544e?s=128&d=identicon&r=PG&f=1", "display_name": "3-14159265358979323846264", "link": "https://stackoverflow.com/users/5040941/3-14159265358979323846264"}, "edited": false, "score": 0, "creation_date": 1437581627, "post_id": 31568465, "comment_id": 51092298, "body": "I was just using the code that he provided.  All I did was just add a &quot;counter&quot; and make sure D4 was actually selected before he ran the code.  Of course if I was writing it from scratch I personally would of done it different. Case Statement, not selecting cells at all, etc."}, {"owner": {"reputation": 3, "user_id": 5023644, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1901ae3515a3f2b05911797459166ad1?s=128&d=identicon&r=PG&f=1", "display_name": "Nathan ", "link": "https://stackoverflow.com/users/5023644/nathan"}, "edited": false, "score": 0, "creation_date": 1437581750, "post_id": 31568465, "comment_id": 51092378, "body": "@rwilson That was really useful, thankyou very much i understand now. I know where i went wrong."}, {"owner": {"reputation": 3108, "user_id": 5040941, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/291199b5e862bf2befb8ee158c6e544e?s=128&d=identicon&r=PG&f=1", "display_name": "3-14159265358979323846264", "link": "https://stackoverflow.com/users/5040941/3-14159265358979323846264"}, "edited": false, "score": 0, "creation_date": 1437581777, "post_id": 31568465, "comment_id": 51092396, "body": "Fair comment. But surely using the <code>ActiveCell</code> as a basis for the offset is going to produce different results depending on what row is selected when the macro is run?"}, {"owner": {"reputation": 2035, "user_id": 4567411, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97708ca7070a2e4f32bee58c29a54360?s=128&d=identicon&r=PG&f=1", "display_name": "rwilson", "link": "https://stackoverflow.com/users/4567411/rwilson"}, "edited": false, "score": 0, "creation_date": 1437581870, "post_id": 31568465, "comment_id": 51092466, "body": "Exactly, which is why I added Range(&quot;D4&quot;).Select to the code."}, {"owner": {"reputation": 3108, "user_id": 5040941, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/291199b5e862bf2befb8ee158c6e544e?s=128&d=identicon&r=PG&f=1", "display_name": "3-14159265358979323846264", "link": "https://stackoverflow.com/users/5040941/3-14159265358979323846264"}, "edited": false, "score": 0, "creation_date": 1437582106, "post_id": 31568465, "comment_id": 51092619, "body": "Lol. Hadn&#39;t noticed that ... I was just thrown by the fact that <code>cell</code> takes the value of each cell in <code>rng</code> and therefore <code>ActiveCell</code> and <code>counter</code> are not needed. I guess the OP&#39;s approach is down to personal choice."}], "tags": [], "owner": {"reputation": 2035, "user_id": 4567411, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97708ca7070a2e4f32bee58c29a54360?s=128&d=identicon&r=PG&f=1", "display_name": "rwilson", "link": "https://stackoverflow.com/users/4567411/rwilson"}, "is_accepted": true, "score": 1, "last_activity_date": 1437583472, "last_edit_date": 1437583472, "creation_date": 1437581334, "answer_id": 31568465, "question_id": 31568077, "link": "https://stackoverflow.com/questions/31568077/vba-loop-to-target-certain-cells-based-on-criteria/31568465#31568465", "title": "VBA Loop to target certain cells based on criteria", "body": "<p>I didn't want to rewrite your code for you, so I just made a few changes to yours:</p>\n\n<pre><code>Sub Validate()\n\nDim rng As Range\nDim row As Range\nDim cell As Range\nDim counter As Long\n\nSet rng = Range(\"D4:D1000\")\nRange(\"D4\").Select\n\nFor Each cell In rng\n\n\nIf cell.Value = \"Building Blocks\" Then\n    ActiveCell.Offset(counter, 16).Interior.ColorIndex = 7\n\n\n\nElseIf cell.Value = \"Test\" Then\n    ActiveCell.Offset(counter, 16).Interior.ColorIndex = 4\n\n\nEnd If\ncounter = counter + 1\n\nNext\nEnd Sub\n</code></pre>\n\n<p>An even better way as noted by 3-14159265358979323846, would be to just take your original code and change Activecell to Cell:</p>\n\n<p>Sub Validate()</p>\n\n<pre><code>Dim rng As Range\nDim row As Range\nDim cell As Range\n\n\nSet rng = Range(\"D4:D1000\")\n\n\nFor Each cell In rng\n\n\nIf cell.Value = \"Building Blocks\" Then\n    cell.Offset(, 16).Interior.ColorIndex = 7\n\n\n\nElseIf cell.Value = \"Test\" Then\n    cell.Offset(, 16).Interior.ColorIndex = 4\n\n\nEnd If\n\n\nNext\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 5023644, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1901ae3515a3f2b05911797459166ad1?s=128&d=identicon&r=PG&f=1", "display_name": "Nathan ", "link": "https://stackoverflow.com/users/5023644/nathan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6431, "favorite_count": 0, "accepted_answer_id": 31568465, "answer_count": 3, "score": 0, "last_activity_date": 1437659477, "creation_date": 1437580309, "last_edit_date": 1437659477, "question_id": 31568077, "link": "https://stackoverflow.com/questions/31568077/vba-loop-to-target-certain-cells-based-on-criteria", "title": "VBA Loop to target certain cells based on criteria", "body": "<p>I am currently trying to achieve a macro where it loops through Column D and based on its value i want it to color in certain multiple cells on that specific row where the value exists. This needs to happen for each row where it meets a certain criteria but i can only seem to get it to work when the active cell has been selected not an automated process. Here is what i have so far: </p>\n\n<pre><code>Sub Validate()\n\nDim rng As Range\nDim row As Range\nDim cell As Range\n\nSet rng = Range(\"D4:D1000\")\n\nFor Each cell In rng\n    If cell.Value = \"Building Blocks\" Then\n        ActiveCell.Offset(, 16).Interior.ColorIndex = 7\n\n    ElseIf cell.Value = \"Test\" Then\n        cell.Interior.ColorIndex = 4\n\n    End If\nNext\nEnd Sub\n</code></pre>\n\n<p>Any Help would be appreciated.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 164, "user_id": 2577529, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3lCwg.jpg?s=128&g=1", "display_name": "iamstrained", "link": "https://stackoverflow.com/users/2577529/iamstrained"}, "edited": false, "score": 0, "creation_date": 1437582160, "post_id": 31568491, "comment_id": 51092658, "body": "This is the best method. By doing this, you can have your &quot;A2&quot; be things like drop-downs or other filtered datasets (like pivot tables)."}, {"owner": {"reputation": 347, "user_id": 5042378, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/3b85ea1e011e1a16917cfd47ba3853e5?s=128&d=identicon&r=PG&f=1", "display_name": "THAT newbie", "link": "https://stackoverflow.com/users/5042378/that-newbie"}, "edited": false, "score": 0, "creation_date": 1437590489, "post_id": 31568491, "comment_id": 51097635, "body": "This is perfect. Thank you."}], "tags": [], "owner": {"reputation": 2685, "user_id": 1523914, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/95939ded1fb2423fbe9ba7989a0006ab?s=128&d=identicon&r=PG", "display_name": "Excel Developers", "link": "https://stackoverflow.com/users/1523914/excel-developers"}, "is_accepted": true, "score": 3, "last_activity_date": 1437581389, "creation_date": 1437581389, "answer_id": 31568491, "question_id": 31568069, "link": "https://stackoverflow.com/questions/31568069/chart-title-to-change-to-the-text-of-a-cell/31568491#31568491", "title": "Chart title to change to the text of a cell", "body": "<p>The chart title can be linked to a cell, but not to a combination of text and a cell. So if cell A2 contains \"Costco\" say, then you should enter a formula in cell B2 (or some other cell) with a formula like </p>\n\n<pre><code>=\"Last Month Returns: \" &amp; A2\n</code></pre>\n\n<p>Then select the chart title, and while it is selected type into the formula bar:</p>\n\n<pre><code>=B2\n</code></pre>\n\n<p>That should do it.</p>\n"}], "owner": {"reputation": 347, "user_id": 5042378, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/3b85ea1e011e1a16917cfd47ba3853e5?s=128&d=identicon&r=PG&f=1", "display_name": "THAT newbie", "link": "https://stackoverflow.com/users/5042378/that-newbie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 255, "favorite_count": 0, "accepted_answer_id": 31568491, "answer_count": 1, "score": 0, "last_activity_date": 1437581389, "creation_date": 1437580288, "last_edit_date": 1531161705, "question_id": 31568069, "link": "https://stackoverflow.com/questions/31568069/chart-title-to-change-to-the-text-of-a-cell", "title": "Chart title to change to the text of a cell", "body": "<p>I haven't been able to find if this is possible but does anyone know if it is possible to make the chart title change to say whatever is in a cell? For example: the Chart title says \"Last Month Returns: Costco\" but \"Costco\" comes from Cell A2 because it could change to Wal-Mart and the title would then be \"Last Month Returns: Wal-Mart\"</p>\n\n<p>I think it could be done via macro but if I can avoid macros that'd be awesome.</p>\n"}, {"tags": ["excel", "vba", "csv", "powershell", "delimiter"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user3904868"}, "edited": false, "score": 0, "creation_date": 1437593496, "post_id": 31568018, "comment_id": 51099545, "body": "If you turn on Excel Macro recording, then import a CSV using Data/From Text and use the import wizard. You can then define the delimiter which will be recorded as a macro. Use the basis of this to import the remaining files in a VBA routine. This will avoid having to change regional delimiter settings."}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 5141104, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e53e31e1b961a87a4c7c0215c0083cc4?s=128&d=identicon&r=PG&f=1", "display_name": "Mac Marein", "link": "https://stackoverflow.com/users/5141104/mac-marein"}, "edited": false, "score": 0, "creation_date": 1437760554, "post_id": 31568251, "comment_id": 51183226, "body": "this works but I don&#39;t want to change the setting all the time"}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 0, "last_activity_date": 1437580749, "creation_date": 1437580749, "answer_id": 31568251, "question_id": 31568018, "link": "https://stackoverflow.com/questions/31568018/excel-csv-files-delimiter-change/31568251#31568251", "title": "Excel CSV files delimiter change", "body": "<p>In <em>Control Panel</em> > <em>Regional Settings</em> > <em>Additional Settings</em></p>\n\n<p>Set the <em>List Separator</em> to the <strong>semi-colon</strong>:</p>\n\n<p><a href=\"https://i.stack.imgur.com/dZbAV.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/dZbAV.png\" alt=\"enter image description here\"></a></p>\n\n<p>Then, in Excel SaveAs <strong>CSV</strong></p>\n"}, {"tags": [], "owner": {"reputation": 1703, "user_id": 1174399, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a14a1c76042e287e36b1c765fb1eaaa5?s=128&d=identicon&r=PG", "display_name": "Don Jewett", "link": "https://stackoverflow.com/users/1174399/don-jewett"}, "is_accepted": false, "score": 0, "last_activity_date": 1437580919, "creation_date": 1437580919, "answer_id": 31568318, "question_id": 31568018, "link": "https://stackoverflow.com/questions/31568018/excel-csv-files-delimiter-change/31568318#31568318", "title": "Excel CSV files delimiter change", "body": "<p>I would take a different approach. </p>\n\n<p>In a Macro enabled Excel workbook:</p>\n\n<p>1) Create a routine which will import a semi-colon-delimited file. It should take a filename as a parameter and return a workbook.</p>\n\n<p>2) Create a routine which will export a workbook as a CSV. It should take a workbook as a parameter, a file name as a parameter, and export/close the workbook</p>\n\n<p>3) Create a routine which reads a file list from the directory and then runs 1) and 2) on each file.</p>\n\n<p>Additionally, I would not name the semi-colon delimited files CSV if you have any control over the original file names. By definition, CSV means Comma Separated Values. Name them something else. Then your routine only has to find the semi-colon files and can skip the CSVs because those have already been converted to comma separated.</p>\n"}, {"tags": [], "owner": {"reputation": 800, "user_id": 4584279, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/10153084328515309/picture?type=large", "display_name": "Little King", "link": "https://stackoverflow.com/users/4584279/little-king"}, "is_accepted": false, "score": 1, "last_activity_date": 1437581835, "last_edit_date": 1437581835, "creation_date": 1437581024, "answer_id": 31568362, "question_id": 31568018, "link": "https://stackoverflow.com/questions/31568018/excel-csv-files-delimiter-change/31568362#31568362", "title": "Excel CSV files delimiter change", "body": "<p>If you want to use PS, this is the easy quick and dirty. Works like a charm.</p>\n\n<pre><code>$csv = Import-csv \"C:\\initial.csv\"\n$csv | Export-Csv \"C:\\converted.csv\" -NoClobber -NoTypeInformation -Delimiter \";\"\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 174117, "user_id": 1630171, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oIS66.png?s=128&g=1", "display_name": "Ansgar Wiechers", "link": "https://stackoverflow.com/users/1630171/ansgar-wiechers"}, "is_accepted": true, "score": 0, "last_activity_date": 1437581771, "creation_date": 1437581771, "answer_id": 31568633, "question_id": 31568018, "link": "https://stackoverflow.com/questions/31568018/excel-csv-files-delimiter-change/31568633#31568633", "title": "Excel CSV files delimiter change", "body": "<pre><code>param([string]$path)\n$content = [IO.File]::ReadAllText($path) #readParameter\n\nImport-CSV -Path $content  -Delimiter ','|Export-CSV -Path C:\\Users\\Desktop\\temp.csv  -Delimiter ';' -NoTypeInformation\n</code></pre>\n\n<p>Your code reads the <em>content</em> of the CSV (assuming that the path to the CSV is passed via the parameter <code>-Path</code>) and tries to pass that as the <em>path</em> to <code>Import-Csv</code>. Change the above to this:</p>\n\n<pre><code>param([string]$path)\n\nImport-CSV -Path $path |\n   Export-CSV -Path C:\\Users\\Desktop\\temp.csv -Delimiter ';' -NoType\n</code></pre>\n\n<p>You can even replace the content of the file if you run <code>Import-Csv</code> in an expression:</p>\n\n<pre><code>(Import-Csv -Path $path) |\n   Export-Csv -Path $path -Delimiter ';' -NoType\n</code></pre>\n\n<p>I'd recommend keeping the double quotes, but if you must remove them you can do that in the pipeline like this:</p>\n\n<pre><code>(Import-Csv -Path $path) |\n   ConvertTo-Csv -Delimiter ';' -NoType |\n   % { $_ -replace '\"', '' } |\n   Set-Content -Path $path\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 5141104, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e53e31e1b961a87a4c7c0215c0083cc4?s=128&d=identicon&r=PG&f=1", "display_name": "Mac Marein", "link": "https://stackoverflow.com/users/5141104/mac-marein"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2794, "favorite_count": 0, "accepted_answer_id": 31568633, "answer_count": 4, "score": 1, "last_activity_date": 1437581835, "creation_date": 1437580115, "question_id": 31568018, "link": "https://stackoverflow.com/questions/31568018/excel-csv-files-delimiter-change", "title": "Excel CSV files delimiter change", "body": "<p>I'm creating in Excel a sub-folder in a directory and save there multiple CSV-files from a Excel Workbook</p>\n\n<p>My problem is that I need to do this on a system where the list separator is a ','. The CSV files are getting read from a system where the default list separator is a ';'. I cannot change this</p>\n\n<p>So I need to change the ',' in the CSV files into a ';'. My idea is to achieve this using PowerShell.</p>\n\n<p>My first attempt was to change the delimiter of the CSV immediately after creating it in excel by passing to a script the file-name. I manage to change the delimiter for a certain file but I struggle to pass the pathname to the script (no error but also no change in the file):</p>\n\n<p>Script Code:</p>\n\n<pre><code>param([string]$path)\n$content = [IO.File]::ReadAllText($path) #readParameter\n\nImport-CSV -Path $content  -Delimiter ','|Export-CSV -Path C:\\Users\\Desktop\\temp.csv  -Delimiter ';' -NoTypeInformation #Export a CSV-File with ;\n(Get-Content C:\\Users\\Desktop\\temp.csv) | % {$_ -replace '\"', \"\"} | out-file -FilePath C:\\Users\\Desktop\\temp.csv -Force -Encoding ascii #remove \" from file\nRemove-Item -Path $content #remove old CSV-file\nRename-Item -Path C:\\Users\\Desktop\\temp.csv -NewName $content #change file name\n</code></pre>\n\n<p>Excel Call:</p>\n\n<pre><code>Call Shell(\"powershell.exe -ExecutionPolicy Unrestricted -File C:\\Users\\Desktop\\delimiterChange.ps1 -path \"\"\" &amp; location &amp; \"\"\"\", 1)\n</code></pre>\n\n<p>Thank You</p>\n"}, {"tags": ["vba", "excel", "excel-2000"], "comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 1, "creation_date": 1437580277, "post_id": 31567942, "comment_id": 51091374, "body": "The first argument to the Countif function should be: <code>Sheets(2).Range(Sheets(2).Cells(2, j), Sheets(2).Cells(scenario_count, j))</code>"}, {"owner": {"reputation": 1396, "user_id": 4691433, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/bce001c90ad26add5d7483b714640c12?s=128&d=identicon&r=PG&f=1", "display_name": "puzzlepiece87", "link": "https://stackoverflow.com/users/4691433/puzzlepiece87"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1437580384, "post_id": 31567942, "comment_id": 51091466, "body": "To add to what @Rory said, if you don&#39;t specify a sheet, it will assume Activesheet"}], "answers": [{"comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1437580364, "post_id": 31568071, "comment_id": 51091448, "body": "You need to qualify the <code>Cells</code> calls with the worksheet too!"}, {"owner": {"reputation": 3650, "user_id": 5090027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/904db949ae64fe1a63ea8b4c677e6d57?s=128&d=identicon&r=PG&f=1", "display_name": "Grade &#39;Eh&#39; Bacon", "link": "https://stackoverflow.com/users/5090027/grade-eh-bacon"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1437580515, "post_id": 31568071, "comment_id": 51091554, "body": "@Rory Agreed - blatently just pointing to yours now with the full formula."}, {"owner": {"reputation": 5, "user_id": 4787730, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-JXxB6WEITfo/AAAAAAAAAAI/AAAAAAAAADQ/zQv9hnznB-c/photo.jpg?sz=128", "display_name": "A Francis", "link": "https://stackoverflow.com/users/4787730/a-francis"}, "edited": false, "score": 0, "creation_date": 1437997705, "post_id": 31568071, "comment_id": 51249617, "body": "This worked, just needed to add &quot;Sheets(2).&quot; to everything that was in sheets(2)"}], "tags": [], "owner": {"reputation": 3650, "user_id": 5090027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/904db949ae64fe1a63ea8b4c677e6d57?s=128&d=identicon&r=PG&f=1", "display_name": "Grade &#39;Eh&#39; Bacon", "link": "https://stackoverflow.com/users/5090027/grade-eh-bacon"}, "is_accepted": true, "score": 0, "last_activity_date": 1437580559, "last_edit_date": 1437580559, "creation_date": 1437580294, "answer_id": 31568071, "question_id": 31567942, "link": "https://stackoverflow.com/questions/31567942/how-to-specify-the-sheet-a-worksheet-function-should-use-via-a-range-object/31568071#31568071", "title": "How to specify the sheet a worksheet function should use via a range object?", "body": "<p>Where you have 'WorksheetFunction.CountIf(Range(Cells(2, j)', simply insert the sheet before the range reference, like so:</p>\n\n<pre><code>Sheets(2).Range(Sheets(2).Cells(2, j), Sheets(2).Cells(scenario_count, j))\n</code></pre>\n\n<p><strong>EDIT</strong> full formula which references the sheet for both the Cells and the Range functions blatently taken from @Rory's comment.</p>\n"}], "owner": {"reputation": 5, "user_id": 4787730, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-JXxB6WEITfo/AAAAAAAAAAI/AAAAAAAAADQ/zQv9hnznB-c/photo.jpg?sz=128", "display_name": "A Francis", "link": "https://stackoverflow.com/users/4787730/a-francis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 782, "favorite_count": 0, "accepted_answer_id": 31568071, "answer_count": 1, "score": 0, "last_activity_date": 1437580559, "creation_date": 1437579933, "question_id": 31567942, "link": "https://stackoverflow.com/questions/31567942/how-to-specify-the-sheet-a-worksheet-function-should-use-via-a-range-object", "title": "How to specify the sheet a worksheet function should use via a range object?", "body": "<p>I have some code that searches a column of values in sheet(3) in the format of a string \"value1 - value 2\"</p>\n\n<p>value2 is the first value in a column in sheet(2) and value1 is a value in the same column, in a cell further down the sheet.</p>\n\n<p>The setup I have is: </p>\n\n<p>In sheet(1), cells C2:C6 have values a-e respectively</p>\n\n<p>In sheet(2), cell C1 has value \"yes\" and cells C2:C6 have values 1-5 \nrespectively</p>\n\n<p>In sheet(3), cell A2 has the value \"4 - yes\"</p>\n\n<p>So the code should countif a column in sheet2 with the first value being yes and look for cells with the value 4, and put the result in cell B2 on sheet(3)</p>\n\n<p>What it actually does is find the yes column (column C) and search the same column on sheet(1) (so the message boxes show letters rather than numbers). </p>\n\n<p>Is there a way I can more precisely specify the sheet the countif function uses?</p>\n\n<p>I'm using Excel 2000 on Windows 7</p>\n\n<pre><code>Private Sub test_click()\n\nscenario_count = 6\nDim i As Integer\ni = 1\n\nSheets(2).Select\nFor j = 2 To 24\n    If Sheets(2).Cells(1, j).Value = Right(Sheets(3).Cells(i + 1, 1).Value, Len(Sheets(3).Cells(i + 1, 1).Value) - InStrRev(Sheets(3).Cells(i + 1, 1).Value, \"-\") - 1) Then\n        MsgBox (\"number of scenarios is \" &amp; scenario_count)\n        MsgBox (\"value searching for is \" &amp; \"'\" &amp; Left(Sheets(3).Cells(i + 1, 1).Value, InStrRev(Sheets(3).Cells(i + 1, 1).Value, \"-\") - 2) &amp; \"'\")\n        MsgBox (\"Range searched is \" &amp; Range(Cells(2, j), Cells(scenario_count, j)).Address &amp; \" in \" &amp; ActiveSheet.Name)\n        MsgBox (\"Number of occurrences \" &amp; Sheets(2).Application.WorksheetFunction.CountIf(Range(Cells(2, j), Cells(scenario_count, j)), Left(Sheets(3).Cells(i + 1, 1).Value, InStrRev(Sheets(3).Cells(i + 1, 1).Value, \"-\") - 2)))\n\n        Sheets(2).Select\n        Sheets(3).Cells(i + 1, 2).Value = Sheets(2).Application.WorksheetFunction.CountIf(Range(Cells(2, j), Cells(scenario_count, j)), Left(Sheets(3).Cells(i + 1, 1).Value, InStrRev(Sheets(3).Cells(i + 1, 1).Value, \"-\") - 2))\n\n        For Each c In Range(Cells(2, j), Cells(scenario_count, j))\n            MsgBox (\"comparing \" &amp; c.Address &amp; \" \" &amp; c.Value &amp; \" with \" &amp; Left(Sheets(3).Cells(i + 1, 1).Value, InStrRev(Sheets(3).Cells(i + 1, 1).Value, \"-\") - 2))\n        Next c\n\n    GoTo endofif2\n\n    End If\nNext\nendofif2:\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 2, "creation_date": 1437578894, "post_id": 31567514, "comment_id": 51090375, "body": "Are the cells in B and C merged?"}, {"owner": {"reputation": 62, "user_id": 5000828, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/31d6ff99e31207c9a11021b863e24416?s=128&d=identicon&r=PG&f=1", "display_name": "User30923", "link": "https://stackoverflow.com/users/5000828/user30923"}, "edited": false, "score": 0, "creation_date": 1437578902, "post_id": 31567514, "comment_id": 51090379, "body": "Have you tried using <code>&quot;&quot;</code> instead of empty? Double quotes is a different way of saying empty. I&#39;ve heard it&#39;s slower/not always as accurate, but it might work in your situation"}, {"owner": {"reputation": 2832, "user_id": 1161309, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b27b718aa1e9d3835ef807359666eb34?s=128&d=identicon&r=PG", "display_name": "Raystafarian", "link": "https://stackoverflow.com/users/1161309/raystafarian"}, "edited": false, "score": 0, "creation_date": 1437579001, "post_id": 31567514, "comment_id": 51090449, "body": "What about <code>nothing</code>"}, {"owner": {"reputation": 181, "user_id": 5067062, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ykZUo.png?s=128&g=1", "display_name": "bdkong", "link": "https://stackoverflow.com/users/5067062/bdkong"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1437579372, "post_id": 31567514, "comment_id": 51090707, "body": "@Rory Yes, they are merged."}, {"owner": {"reputation": 181, "user_id": 5067062, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ykZUo.png?s=128&g=1", "display_name": "bdkong", "link": "https://stackoverflow.com/users/5067062/bdkong"}, "reply_to_user": {"reputation": 62, "user_id": 5000828, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/31d6ff99e31207c9a11021b863e24416?s=128&d=identicon&r=PG&f=1", "display_name": "User30923", "link": "https://stackoverflow.com/users/5000828/user30923"}, "edited": false, "score": 0, "creation_date": 1437579381, "post_id": 31567514, "comment_id": 51090713, "body": "@User30923 Double quotes was the first thing I tried, it didn&#39;t work either."}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1437579815, "post_id": 31567514, "comment_id": 51091025, "body": "@Rory Good catch. It turns out to be an important point."}], "answers": [{"comments": [{"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1437579684, "post_id": 31567687, "comment_id": 51090938, "body": "I like this approach. I usually use the <code>IsEmpty()</code> approach -- but then I have never had the occasion to do it with a merged cell. I didn&#39;t know before today that <code>IsEmpty(MergedCell)</code> returns False even if the merged cell is in fact blank -- but this <code>CountA</code> approach handles that nicely (although the actual output of the isEmpty in the merged case seems to depend on how you address the range)."}, {"owner": {"reputation": 181, "user_id": 5067062, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ykZUo.png?s=128&g=1", "display_name": "bdkong", "link": "https://stackoverflow.com/users/5067062/bdkong"}, "edited": false, "score": 0, "creation_date": 1437580479, "post_id": 31567687, "comment_id": 51091531, "body": "Thanks! Just out of curiosity, is there a reason other than the merged cells that my code wouldn&#39;t work?"}], "tags": [], "owner": {"reputation": 3740, "user_id": 3064741, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3d1eaeba1b98ecb9d37ccb68c69aec0?s=128&d=identicon&r=PG&f=1", "display_name": "mielk", "link": "https://stackoverflow.com/users/3064741/mielk"}, "is_accepted": true, "score": 5, "last_activity_date": 1437579225, "creation_date": 1437579225, "answer_id": 31567687, "question_id": 31567514, "link": "https://stackoverflow.com/questions/31567514/why-does-empty-not-work-in-this-vba-code/31567687#31567687", "title": "Why does `Empty` not work in this VBA code?", "body": "<p>You can use</p>\n\n<pre><code>If Application.WorksheetFunction.CountA(Range(\"B27:C27\")) = 0 Then\n</code></pre>\n\n<p>instead of</p>\n\n<pre><code>If Range(\"B27:C27\") = Empty Then\n</code></pre>\n\n<hr>\n\n<p>By the way, there is no need to select range before pasting data.</p>\n\n<p>This code</p>\n\n<pre><code>    Range(\"B27:C27\").Select\n    Selection.PasteSpecial Paste:=xlPasteValuesAndNumberFormats, Operation:= _\n        xlNone, SkipBlanks:=False, Transpose:=False\n</code></pre>\n\n<p>can be replaced with</p>\n\n<pre><code>    Range(\"B27:C27\").PasteSpecial Paste:=xlPasteValuesAndNumberFormats, Operation:= _\n        xlNone, SkipBlanks:=False, Transpose:=False\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 6311, "user_id": 5073840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yRIIb.jpg?s=128&g=1", "display_name": "MatthewD", "link": "https://stackoverflow.com/users/5073840/matthewd"}, "is_accepted": false, "score": 0, "last_activity_date": 1437579451, "creation_date": 1437579451, "answer_id": 31567776, "question_id": 31567514, "link": "https://stackoverflow.com/questions/31567514/why-does-empty-not-work-in-this-vba-code/31567776#31567776", "title": "Why does `Empty` not work in this VBA code?", "body": "<p>Try IsEmpty</p>\n\n<pre><code>If IsEmpty(ws.Range(\"A1\").Value) = True Then\n\nEnd if\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 5144119, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b7346bcab6ea2480ebbb9130e8eb8fee?s=128&d=identicon&r=PG&f=1", "display_name": "Viking", "link": "https://stackoverflow.com/users/5144119/viking"}, "is_accepted": false, "score": -2, "last_activity_date": 1437579453, "creation_date": 1437579453, "answer_id": 31567779, "question_id": 31567514, "link": "https://stackoverflow.com/questions/31567514/why-does-empty-not-work-in-this-vba-code/31567779#31567779", "title": "Why does `Empty` not work in this VBA code?", "body": "<p>Have you tried </p>\n\n<p><code>var = nz(YourValue,\"\")</code></p>\n\n<p>and then checking with </p>\n\n<pre><code>If var = \"\" Then 'moar code \n</code></pre>\n\n<p>or just checking with </p>\n\n<pre><code>If nz(YourValue,\"\") = \"\" Then 'moar code \n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "is_accepted": false, "score": 4, "last_activity_date": 1437579562, "creation_date": 1437579562, "answer_id": 31567820, "question_id": 31567514, "link": "https://stackoverflow.com/questions/31567514/why-does-empty-not-work-in-this-vba-code/31567820#31567820", "title": "Why does `Empty` not work in this VBA code?", "body": "<p>The use of <code>Empty</code> or <code>IsEmpty()</code> in VBA is primarily to see if a variable has been initialized however it is commonly misused to check if a Range has a value.</p>\n\n<p>If you want to see if a Range is 'empty' then use:</p>\n\n<pre><code>If Range(\"B27\").Value = vbNullString Then\n    '// Do Something\nEnd If\n</code></pre>\n\n<p>If you want to check that a Range with more than one cell is empty then you can use a <code>COUNTA()</code> argument:</p>\n\n<pre><code>If [COUNTA(B27:C27)=0] Then\n    '// Do Something\nEnd If\n</code></pre>\n\n<p><em>(or the same thing using the WorksheetFunction class...)</em>  </p>\n\n<pre><code>If WorksheetFunction.CountA(Range(\"B27:C27\")) = 0 Then\n    '// Do Something\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 181, "user_id": 5067062, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ykZUo.png?s=128&g=1", "display_name": "bdkong", "link": "https://stackoverflow.com/users/5067062/bdkong"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 625, "favorite_count": 0, "accepted_answer_id": 31567687, "answer_count": 4, "score": 2, "last_activity_date": 1438003024, "creation_date": 1437578758, "last_edit_date": 1438003024, "question_id": 31567514, "link": "https://stackoverflow.com/questions/31567514/why-does-empty-not-work-in-this-vba-code", "title": "Why does `Empty` not work in this VBA code?", "body": "<p>The code below is supposed to check if a cell is empty and, if it is empty, paste the contents of B26 into that cell. If the cell is not empty, it moves on to check the cell below it. I tried using <code>IsEmpty</code> but that didn't work, so I figured Excel was defaulting all empty cells to 0. So I tried using <code>Empty</code>(as shown in the code below) but that doesn't work either. </p>\n\n<pre><code>Sub Part1_Component_1_Foam_Color()\n'\n' Transfers Component 1 Data if Foam or color\n'\n\n'\nWindows(\"Transfer Template.xlsm\").Activate\nRange(\"B26\").Select\nSelection.Copy\nWindows(\"Protected_JD_Form.xls\").Activate\n    If Range(\"B27:C27\") = Empty Then\n        Range(\"B27:C27\").Select\n        Selection.PasteSpecial Paste:=xlPasteValuesAndNumberFormats, Operation:= _\n            xlNone, SkipBlanks:=False, Transpose:=False\n            Exit Sub\n    ElseIf Range(\"B28:C28\") = Empty Then\n        Range(\"B28:C28\").Select\n        Selection.PasteSpecial Paste:=xlPasteValuesAndNumberFormats, Operation:= _\n            xlNone, SkipBlanks:=False, Transpose:=False\n            Exit Sub\n    ElseIf Range(\"B29:C29\") = Empty Then\n        Range(\"B29:C29\").Select\n        Selection.PasteSpecial Paste:=xlPasteValuesAndNumberFormats, Operation:= _\n            xlNone, SkipBlanks:=False, Transpose:=False\n            Exit Sub\n    ElseIf Range(\"B30:C30\") = Empty Then\n        Range(\"B30:C30\").Select\n        Selection.PasteSpecial Paste:=xlPasteValuesAndNumberFormats, Operation:= _\n            xlNone, SkipBlanks:=False, Transpose:=False\n            Exit Sub\n    End If\nWindows(\"Transfer Template.xlsm\").Activate\nRange(\"A1\").Select\nEnd Sub\n</code></pre>\n"}, {"tags": ["xml", "vba", "excel", "xslt"], "comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 1, "creation_date": 1437578847, "post_id": 31566990, "comment_id": 51090336, "body": "Have you tried: <code>Workbooks.OpenXML Filename:=Name_file, StyleSheets:=Array(1)</code>"}, {"owner": {"reputation": 11, "user_id": 5101727, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/dba599451a94c2d823b0a011a095defe?s=128&d=identicon&r=PG&f=1", "display_name": "Oliv Sem", "link": "https://stackoverflow.com/users/5101727/oliv-sem"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1437580108, "post_id": 31566990, "comment_id": 51091240, "body": "Perfect ! Thank you !"}, {"owner": {"reputation": 33642, "user_id": 620097, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/820980fd43f2607a815c1f3dbfe152cc?s=128&d=identicon&r=PG", "display_name": "shellter", "link": "https://stackoverflow.com/users/620097/shellter"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1437605430, "post_id": 31566990, "comment_id": 51105563, "body": "@Rory : post as an answer and I&#39;ll up-vote it. Good luck to all!"}], "answers": [{"tags": [], "owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "is_accepted": true, "score": 1, "last_activity_date": 1437638684, "creation_date": 1437638684, "answer_id": 31581516, "question_id": 31566990, "link": "https://stackoverflow.com/questions/31566990/vba-open-xml-file-with-xsl-in-excel/31581516#31581516", "title": "VBA : Open XML file with XSL in Excel", "body": "<p>You need to use the <code>OpenXML</code> method instead:</p>\n\n<pre><code>Workbooks.OpenXML Filename:=Name_file, StyleSheets:=Array(1)\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 5101727, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/dba599451a94c2d823b0a011a095defe?s=128&d=identicon&r=PG&f=1", "display_name": "Oliv Sem", "link": "https://stackoverflow.com/users/5101727/oliv-sem"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 790, "favorite_count": 0, "accepted_answer_id": 31581516, "answer_count": 1, "score": 0, "last_activity_date": 1437638684, "creation_date": 1437577450, "last_edit_date": 1531164843, "question_id": 31566990, "link": "https://stackoverflow.com/questions/31566990/vba-open-xml-file-with-xsl-in-excel", "title": "VBA : Open XML file with XSL in Excel", "body": "<p>I would like to open a XML file with VBA language on Excel, but when I do it, it like the XSL is ignored. \nHere is my code :</p>\n\n<pre><code>Sub OpenFile()\n'\n' OpenFile Macro\n'\nName_file = Application.GetOpenFilename(\"XML files (*.xml), *.xml\")\nIf Name_file &lt;&gt; False Then\n    Workbooks.Open Filename:=Name_file\nEnd If\n'\nEnd Sub\n</code></pre>\n\n<p>Thank you for your answers</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 3650, "user_id": 5090027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/904db949ae64fe1a63ea8b4c677e6d57?s=128&d=identicon&r=PG&f=1", "display_name": "Grade &#39;Eh&#39; Bacon", "link": "https://stackoverflow.com/users/5090027/grade-eh-bacon"}, "edited": false, "score": 4, "creation_date": 1437577199, "post_id": 31566743, "comment_id": 51089047, "body": "Have you tried running through the code when you do it for &#39;tab 10&#39; to see what it does, line by line? Doing it like this will show you your problem if you expect a result and don&#39;t get it. ie: &quot;I expected row 5 to show up as &#39;not hidden&#39; - so why did Excel think it was hidden and delete it?&quot;"}, {"owner": {"reputation": 5345, "user_id": 3561813, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/958afeca6b11ffa0e83b97b516c88dc7?s=128&d=identicon&r=PG&f=1", "display_name": "basodre", "link": "https://stackoverflow.com/users/3561813/basodre"}, "edited": false, "score": 3, "creation_date": 1437577767, "post_id": 31566743, "comment_id": 51089475, "body": "The first thing that pops out at me is that you are first filtering by the <code>ActiveSheet</code>, then working with a different sheet (in your case <code>Sheet(&quot;3&quot;)</code>. If <code>3</code> is not the active sheet, then it too is not the sheet that will be filtered. Did you notice this limitation, and is it done this way by design?"}, {"owner": {"reputation": 1396, "user_id": 4691433, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/bce001c90ad26add5d7483b714640c12?s=128&d=identicon&r=PG&f=1", "display_name": "puzzlepiece87", "link": "https://stackoverflow.com/users/4691433/puzzlepiece87"}, "edited": false, "score": 0, "creation_date": 1437578666, "post_id": 31566743, "comment_id": 51090201, "body": "Do you know that you can do &quot;For Each (Worksheet Variable) in (Workbook Name).Sheets&quot;?"}, {"owner": {"reputation": 3845, "user_id": 4288101, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O0Xld.jpg?s=128&g=1", "display_name": "Byron Wall", "link": "https://stackoverflow.com/users/4288101/byron-wall"}, "reply_to_user": {"reputation": 5345, "user_id": 3561813, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/958afeca6b11ffa0e83b97b516c88dc7?s=128&d=identicon&r=PG&f=1", "display_name": "basodre", "link": "https://stackoverflow.com/users/3561813/basodre"}, "edited": false, "score": 0, "creation_date": 1437685318, "post_id": 31566743, "comment_id": 51147660, "body": "Going further with @user3561813, beware that you have likely deleted content from all of those other sheets if indeed you ran this code with a different sheet active than the one intended."}, {"owner": {"reputation": 11, "user_id": 5144028, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e179cf58816f1af134322a619a27976f?s=128&d=identicon&r=PG&f=1", "display_name": "Enlsem2015", "link": "https://stackoverflow.com/users/5144028/enlsem2015"}, "edited": false, "score": 0, "creation_date": 1438943198, "post_id": 31566743, "comment_id": 51668611, "body": "Hi, sorry for the delay in responding and thank you to everyone for their comments.  I realized that the issue was that on Tab 10, the first column didn&#39;t have a filter on it, so the macro kept trying to filter the 6th FILTERED column which was the seventh overall column, which was screwing it up. I appreciate that I should&#39;ve solved this on my own.  Secondly, I am greatly interested in being able to just run the macro once and have it work on all sheets, which seems to be what people are saying in the comments I could do, but I&#39;m not sure how to implement. Could you elaborate further on how?"}, {"owner": {"reputation": 11, "user_id": 5144028, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e179cf58816f1af134322a619a27976f?s=128&d=identicon&r=PG&f=1", "display_name": "Enlsem2015", "link": "https://stackoverflow.com/users/5144028/enlsem2015"}, "edited": false, "score": 0, "creation_date": 1438943432, "post_id": 31566743, "comment_id": 51668753, "body": "Essentially I&#39;d like to just have the user enter the Raw Input once and then have it filter on all sheets, and have it delete the hidden rows. But using what I found here on SO (I am not sophisticated/skilled enough to write something like this myself yet), I wasn&#39;t able to find anything to help me do that as quickly as this did. So if that is something that would be possible, I would very much like to know how to do so."}], "owner": {"reputation": 11, "user_id": 5144028, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e179cf58816f1af134322a619a27976f?s=128&d=identicon&r=PG&f=1", "display_name": "Enlsem2015", "link": "https://stackoverflow.com/users/5144028/enlsem2015"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1031, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1437576864, "creation_date": 1437576864, "question_id": 31566743, "link": "https://stackoverflow.com/questions/31566743/delete-hidden-invisible-rows-after-autofilter-excel-vba-part-ii", "title": "Delete Hidden/Invisible Rows after Autofilter Excel VBA Part II", "body": "<p>New poster here.</p>\n\n<p>I am using the below code in order to filter by the name of the firm in my workbook. I have multiple tabs labelled 1-11 that I'd like to do so in. </p>\n\n<pre><code>Sub FilterByFirm()\n\n' FilterByFirm Macro\n\n\n\nActiveSheet.Range(\"$A$5:$QP$8000\").AutoFilter Field:=6, Criteria1:= _\n    \"UBS Global Asset Management\"\n\nDim oRow As Range, rng As Range\nDim myRows As Range\nWith Sheets(\"3\")\n    Set myRows = Intersect(.Range(\"A:A\").EntireRow, .UsedRange)\n    If myRows Is Nothing Then Exit Sub\nEnd With\n\nFor Each oRow In myRows.Columns(1).Cells\n    If oRow.EntireRow.Hidden Then\n        If rng Is Nothing Then\n            Set rng = oRow\n        Else\n            Set rng = Union(rng, oRow)\n        End If\n    End If\nNext\n\nIf Not rng Is Nothing Then rng.EntireRow.Delete\nEnd Sub\n</code></pre>\n\n<p>I have been going through and updating the Sheets(\"3\") to the tab that I am currently working in because this seemed to be how to make things work. However, this did not work in tab 10 (called \"10\"). It worked in every other tab, and I am not sure why. Instead of filtering and then deleting hidden rows, the macro has been simply deleting all the rows.</p>\n\n<p>How can I correct this? And I can confirm that UBS appears in tab 10, so this is not the issue.</p>\n\n<p>Thank you very much!</p>\n"}, {"tags": ["excel", "range", "vba"], "comments": [{"owner": {"reputation": 3650, "user_id": 5090027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/904db949ae64fe1a63ea8b4c677e6d57?s=128&d=identicon&r=PG&f=1", "display_name": "Grade &#39;Eh&#39; Bacon", "link": "https://stackoverflow.com/users/5090027/grade-eh-bacon"}, "edited": false, "score": 0, "creation_date": 1437580399, "post_id": 31566619, "comment_id": 51091476, "body": "Define &quot;not pulling the correct value&quot;. Show what you expect the value to be, and what it actually comes up as."}, {"owner": {"reputation": 125, "user_id": 4944966, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/sGUeJ.png?s=128&g=1", "display_name": "Jay", "link": "https://stackoverflow.com/users/4944966/jay"}, "reply_to_user": {"reputation": 3650, "user_id": 5090027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/904db949ae64fe1a63ea8b4c677e6d57?s=128&d=identicon&r=PG&f=1", "display_name": "Grade &#39;Eh&#39; Bacon", "link": "https://stackoverflow.com/users/5090027/grade-eh-bacon"}, "edited": false, "score": 0, "creation_date": 1437581240, "post_id": 31566619, "comment_id": 51092077, "body": "Lets say rngUniques2 is a table of the alphabet, i.e. 26 cells with a single letter each, and rngUniques is a list of numbers 1 to 26. The first time thru the For loop it will correctly pull &quot;A&quot; from rngUniques2. After that it will progress thru the range at a different step than rngUniques. For example it will be something like this: 1-A  2-A  3-B  4-C  5-C etc...  You can see how the second range gets away from the first in the loop."}, {"owner": {"reputation": 125, "user_id": 4944966, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/sGUeJ.png?s=128&g=1", "display_name": "Jay", "link": "https://stackoverflow.com/users/4944966/jay"}, "reply_to_user": {"reputation": 3650, "user_id": 5090027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/904db949ae64fe1a63ea8b4c677e6d57?s=128&d=identicon&r=PG&f=1", "display_name": "Grade &#39;Eh&#39; Bacon", "link": "https://stackoverflow.com/users/5090027/grade-eh-bacon"}, "edited": false, "score": 0, "creation_date": 1437585352, "post_id": 31566619, "comment_id": 51094536, "body": "So far, I have been able to brute force this to work for me by just combining column A and B into column A. The macro works fine when just using rngUniques by itself. However, there are 15000+ lines in the file, so I know it is not the most efficient approach, especially since it has to do the string manipulation for each row."}, {"owner": {"reputation": 3650, "user_id": 5090027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/904db949ae64fe1a63ea8b4c677e6d57?s=128&d=identicon&r=PG&f=1", "display_name": "Grade &#39;Eh&#39; Bacon", "link": "https://stackoverflow.com/users/5090027/grade-eh-bacon"}, "edited": false, "score": 0, "creation_date": 1437585523, "post_id": 31566619, "comment_id": 51094639, "body": "I must confess I still don&#39;t understand the issue. Please edit your question to include all details include a sample of your data and the expected vs actual outputs."}], "answers": [{"comments": [{"owner": {"reputation": 125, "user_id": 4944966, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/sGUeJ.png?s=128&g=1", "display_name": "Jay", "link": "https://stackoverflow.com/users/4944966/jay"}, "edited": false, "score": 0, "creation_date": 1437674118, "post_id": 31588641, "comment_id": 51141197, "body": "Column B will always be the same for unique value in A. The reason for the code above, is because column B is actually a long company name that includes an ID number. The code strips out the number only as this is actually what I need to put on the tab name. This is why I needed to be able to work with that value by itself. This also means that I cannot just concatenate the values like you suggested."}, {"owner": {"reputation": 3650, "user_id": 5090027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/904db949ae64fe1a63ea8b4c677e6d57?s=128&d=identicon&r=PG&f=1", "display_name": "Grade &#39;Eh&#39; Bacon", "link": "https://stackoverflow.com/users/5090027/grade-eh-bacon"}, "reply_to_user": {"reputation": 125, "user_id": 4944966, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/sGUeJ.png?s=128&g=1", "display_name": "Jay", "link": "https://stackoverflow.com/users/4944966/jay"}, "edited": false, "score": 0, "creation_date": 1437674341, "post_id": 31588641, "comment_id": 51141336, "body": "@Jay All of these details that I&#39;ve needed to pull from you have been necessary to answer your question. Please re-edit your question to include a sample of your data <b>including the way it is actually formatted in your source workbooks</b>, along with all specific assumptions and notes that have been posted as comments along the way."}, {"owner": {"reputation": 125, "user_id": 4944966, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/sGUeJ.png?s=128&g=1", "display_name": "Jay", "link": "https://stackoverflow.com/users/4944966/jay"}, "edited": false, "score": 0, "creation_date": 1437740921, "post_id": 31588641, "comment_id": 51170661, "body": "Thanks for your help. However, I am going to just use the workaround that I mentioned above. It is a little inefficient, but it gets the job done. I needed to hve this working today, so I am satisfied with it."}], "tags": [], "owner": {"reputation": 3650, "user_id": 5090027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/904db949ae64fe1a63ea8b4c677e6d57?s=128&d=identicon&r=PG&f=1", "display_name": "Grade &#39;Eh&#39; Bacon", "link": "https://stackoverflow.com/users/5090027/grade-eh-bacon"}, "is_accepted": false, "score": 0, "last_activity_date": 1437657688, "creation_date": 1437657688, "answer_id": 31588641, "question_id": 31566619, "link": "https://stackoverflow.com/questions/31566619/trouble-accessing-dual-ranges/31588641#31588641", "title": "Trouble accessing dual ranges", "body": "<p>Okay thanks, that last edit does help quite a bit. </p>\n\n<p>Final clarification: If the text in column A is always, say \"2\", is the text in column B always, say, \"B\"? Or are there times when ColumnA might be 2 but column B might be \"C\"? Because to me, I think you are overcomplicating things by doing any checking of rnguniques2 at all. </p>\n\n<p>Assuming Column B is the same for each unique column A value, you can delete all references to rnguniques2 except for the initial \"set = column B\", and then when setting the name of the sheet, just go \"rnguniques(counter,1).value &amp; \" - \" &amp; rnguniques(counter,2).value\"</p>\n\n<p>I can't really see the point of this section of the code here:</p>\n\n<pre><code>xValue = rngUniques2(counter, 1).Value\n\nDebug.Print xValue\n\nOutValue = \"\"\n\nFor xIndex = 1 To VBA.Len(xValue)\n    If (VBA.Mid(xValue, xIndex, 1) &lt;&gt; \"-\") Then\n            If VBA.IsNumeric(VBA.Mid(xValue, xIndex, 1)) Then\n                OutValue = OutValue &amp; VBA.Mid(xValue, xIndex, 1)\n            End If\n    Else: Exit For\n    End If\nNext\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 125, "user_id": 4944966, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/sGUeJ.png?s=128&g=1", "display_name": "Jay", "link": "https://stackoverflow.com/users/4944966/jay"}, "is_accepted": true, "score": 0, "last_activity_date": 1437740961, "creation_date": 1437740961, "answer_id": 31610585, "question_id": 31566619, "link": "https://stackoverflow.com/questions/31566619/trouble-accessing-dual-ranges/31610585#31610585", "title": "Trouble accessing dual ranges", "body": "<p>I have been able to brute force this to work for me by just combining column A and B into column A. </p>\n"}], "owner": {"reputation": 125, "user_id": 4944966, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/sGUeJ.png?s=128&g=1", "display_name": "Jay", "link": "https://stackoverflow.com/users/4944966/jay"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 74, "favorite_count": 0, "accepted_answer_id": 31610585, "answer_count": 2, "score": 0, "last_activity_date": 1437740961, "creation_date": 1437576564, "last_edit_date": 1531164843, "question_id": 31566619, "link": "https://stackoverflow.com/questions/31566619/trouble-accessing-dual-ranges", "title": "Trouble accessing dual ranges", "body": "<p>I found the majority of the following code online and it works awesome for me. The part I have added is the creation of the second range rngUniques2 and the use of that range for some string manipulation. The problem I am having is that when I try to access that range, it is not pulling the correct value except for the first time. I am thinking I am using the counter wrong, but I have not been able to get it correct. I know the range has the correct values in it as I did a For Each Cell debug print. </p>\n\n<pre><code>Sub Extract_All_Data()\n\n'this macro assumes that your first row of data is a header row.\n'will copy all filtered rows from one worksheet, to another blank workbook\n'each unique filtered value will be copied to it's own sheet\n\n'Variables used by the macro\nDim wbOrig, wbDest As Workbook\nDim rngFilter As Range, rngUniques, rngUniques2 As Range\nDim cell As Range, counter As Integer\nDim xValue, OutValue As String\n\n ' Prompt user to choose file and open it\nMsgBox \"Please select the file that will be split.\"\nstrFileToOpen = Application.GetOpenFilename(Title:=\"Please select the file that will be split.\", FileFilter:=\"Excel Files *.xls* (*.xls*),\")\n\nIf strFileToOpen = \"False\" Then\n    MsgBox \"No file selected.\", vbExclamation, \"Sorry!\"\n    Exit Sub\nElse\n    Set wbOrig = Workbooks.Open(Filename:=strFileToOpen)\nEnd If\n\n\nSheets(\"HTPN\").Activate\n\n' Set the filter range (from A1 to the last used cell in column A)\nSet rngFilter = Range(\"A1\", Range(\"A\" &amp; Rows.Count).End(xlUp))\n\nApplication.ScreenUpdating = False\n\nWith rngFilter\n\n    ' Filter column A to show only one of each item (uniques) in column A\n    .AdvancedFilter Action:=xlFilterInPlace, Unique:=True\n\n    ' Set a variable to the Unique values (one for ClientID and one for Client Name)\n    Set rngUniques = Range(\"A2\", Range(\"A\" &amp; Rows.Count).End(xlUp)).SpecialCells(xlCellTypeVisible)\n    Set rngUniques2 = Range(\"B2\", Range(\"B\" &amp; Rows.Count).End(xlUp)).SpecialCells(xlCellTypeVisible)\n\n    ' Clear the filter\n    ActiveSheet.ShowAllData\n\nEnd With\n\n' Create a new workbook with a sheet for each unique value\nApplication.SheetsInNewWorkbook = rngUniques.Count\nSet wbDest = Workbooks.Add\nApplication.SheetsInNewWorkbook = 3\n\n' Filter, Copy, and Paste each unique to its' own sheet in the new workbook\nFor Each cell In rngUniques\n\n    counter = counter + 1\n\n    'NOTE - this filter is on column A (field:=1), to change\n    'to a different column you need to change the field number\n    rngFilter.AutoFilter field:=1, Criteria1:=cell.Value\n\n    ' Copy and paste the filtered data to it's unique sheet\n    rngFilter.Resize(, 30).SpecialCells(xlCellTypeVisible).Copy Destination:=wbDest.Sheets(counter).Range(\"A1\")\n\n    ' Name the destination sheet\n    ' Strip Client name to extract the AU #\n    xValue = rngUniques2(counter, 1).Value\n\n    Debug.Print xValue\n\n    OutValue = \"\"\n\n    For xIndex = 1 To VBA.Len(xValue)\n        If (VBA.Mid(xValue, xIndex, 1) &lt;&gt; \"-\") Then\n                If VBA.IsNumeric(VBA.Mid(xValue, xIndex, 1)) Then\n                    OutValue = OutValue &amp; VBA.Mid(xValue, xIndex, 1)\n                End If\n        Else: Exit For\n        End If\n    Next\n\n    wbDest.Sheets(counter).Name = cell.Value &amp; \" - \" &amp; OutValue\n    wbDest.Sheets(counter).Cells.Columns.AutoFit\n\nNext cell\n\nrngFilter.Parent.AutoFilterMode = False\nApplication.ScreenUpdating = True    \n\nEnd Sub\n</code></pre>\n\n<p>EDIT TO EXPLAIN</p>\n\n<p>Sample data:</p>\n\n<p>A     B</p>\n\n<p>1     A</p>\n\n<p>1     A</p>\n\n<p>1     A</p>\n\n<p>2     B</p>\n\n<p>2     B</p>\n\n<p>3     C</p>\n\n<p>3     C</p>\n\n<p>3     C</p>\n\n<p>3     C</p>\n\n<p>4     D</p>\n\n<p>4     D</p>\n\n<p>4     D</p>\n\n<p>The program copies all rows of each unique item in column A to separate tabs and attempts to name the tab correctly. It is the naming of the tab that is causing me troubles. I am trying to get the tab name in the following format \"A value - B value\", so for the above example, there would be four tabs named:</p>\n\n<p>1 - A</p>\n\n<p>2 - B</p>\n\n<p>3 - C</p>\n\n<p>4 - D</p>\n\n<p>rngUniques contains the unique values from column A and rngUniques2 contains the corresponding values from column B. I am trying to read from both ranges in the same For Each Loop, but it is not accessing the correct data in rngUniques2. For example when I run the macro, it would name the tabs:</p>\n\n<p>1 - A</p>\n\n<p>2 - A </p>\n\n<p>3 - B</p>\n\n<p>4 - C</p>\n\n<p>The small sample size above makes it look like it is only one item off, but it gets further off as it goes. My actual data creates 110 separate tabs. I am assuming the error comes from the way I am trying to access the data below. </p>\n\n<pre><code>xValue = rngUniques2(counter, 1).Value\n</code></pre>\n\n<p>How would I progress through the data of another range while using a For Each Loop on a different range?</p>\n"}, {"tags": ["excel", "excel-formula", "combinations", "mathematical-optimization", "vba"], "comments": [{"owner": {"reputation": 8830, "user_id": 5336948, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/YqCFK.jpg?s=128&g=1", "display_name": "Forward Ed", "link": "https://stackoverflow.com/users/5336948/forward-ed"}, "edited": false, "score": 0, "creation_date": 1464373846, "post_id": 31566569, "comment_id": 62476622, "body": "Since you like formulas rolled up into one cell, I thought you might find <a href=\"http://stackoverflow.com/questions/37475961/how-to-autogenerate-certain-excel-strings-from-certain-inputs-as-given-in-exampl/37489151#37489151\">the formula in column L</a> up your alley"}], "answers": [{"comments": [{"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1437583631, "post_id": 31567957, "comment_id": 51093532, "body": "Not bad. Actually brilliant. But only in theory? A mason wouldn&#39;t chop up his tiles into 1x1 squares XD It makes perfect (mathematical) sense but with a CONSTANT rectangle, wouldn&#39;t orientation matter? Depending on the space, lying it horizontally vs vertically, it has to make a difference? I would include example but I think we can both picture it without. Still +1 for theory/logic."}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 1, "creation_date": 1437584194, "post_id": 31567957, "comment_id": 51093846, "body": "@findwindow What is critical is that both the length &amp; width of the big surface must be <b>integer</b> units...that is, not something like <i>1345&amp;1/4</i>  That way the big surface can be entirely filed by <i>1x1</i>&#39;s"}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1437584369, "post_id": 31567957, "comment_id": 51093951, "body": "Excellent point. I made that presumption but in practice, spaces are rarely integers XD That&#39;s an additional curveball! Edit: Actually, it&#39;s only critical because space isn&#39;t a square?"}, {"owner": {"reputation": 8830, "user_id": 5336948, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/YqCFK.jpg?s=128&g=1", "display_name": "Forward Ed", "link": "https://stackoverflow.com/users/5336948/forward-ed"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1464373606, "post_id": 31567957, "comment_id": 62476495, "body": "@findwindow What if you are placing your rectangle in a herringbone pattern?"}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "reply_to_user": {"reputation": 8830, "user_id": 5336948, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/YqCFK.jpg?s=128&g=1", "display_name": "Forward Ed", "link": "https://stackoverflow.com/users/5336948/forward-ed"}, "edited": false, "score": 0, "creation_date": 1464373734, "post_id": 31567957, "comment_id": 62476562, "body": "@ForwardEd so you&#39;re the one trolling me =P Actually, I am placing it in a star shape."}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 0, "last_activity_date": 1437579973, "creation_date": 1437579973, "answer_id": 31567957, "question_id": 31566569, "link": "https://stackoverflow.com/questions/31566569/least-number-of-whole-tiles-to-use-to-fill-a-space/31567957#31567957", "title": "Least number of whole tiles to use to fill a space", "body": "<p>Unless the big surface is an even multiple of the tile dimensions, you will have to cut <strong>some</strong> tiles and there will be <strong>some</strong> waste.  Say we have a perfect saw that can cut a tile with zero waste.  We cut each 96 x 48  tile into 4608 1 x 1 squares.  To determine the number of tiles we need, we divide the total area of the big surface by 4608 and round up to the nearest integer tile!</p>\n"}], "owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 94, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1437579973, "creation_date": 1437576453, "last_edit_date": 1531161705, "question_id": 31566569, "link": "https://stackoverflow.com/questions/31566569/least-number-of-whole-tiles-to-use-to-fill-a-space", "title": "Least number of whole tiles to use to fill a space", "body": "<p>Per <a href=\"https://stackoverflow.com/questions/31542620/constant-rectangles-to-fill-variable-rectangular-space\">this thread</a>, Tim makes a good point so trying this again. He writes,</p>\n\n<blockquote>\n  <p>The problem of minimizing the total number of smaller rectangles used\n  to fill the total space is a very real world problem. Just take a look\n  at the floor of your bathroom and you'll see why. A mason needs to\n  know how he can cover a space destroying the least number of tiles,\n  and depending on the algorithm used he will get different results.</p>\n</blockquote>\n\n<p>So, if you have a space of W width and L length and a constant rectangle of 48 width and 96 length, what's the best way to fill said space with minimum waste?</p>\n\n<p>There's <a href=\"https://stackoverflow.com/questions/19760755/number-of-ways-to-fill-a-nxm-grid\">this</a> which gives all combinations so I could run through it all and pick best solution. I don't understand the answer/java though XD</p>\n"}, {"tags": ["vba", "excel", "rgb"], "answers": [{"tags": [], "owner": {"reputation": 3740, "user_id": 3064741, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3d1eaeba1b98ecb9d37ccb68c69aec0?s=128&d=identicon&r=PG&f=1", "display_name": "mielk", "link": "https://stackoverflow.com/users/3064741/mielk"}, "is_accepted": true, "score": 1, "last_activity_date": 1437576283, "creation_date": 1437576283, "answer_id": 31566493, "question_id": 31566404, "link": "https://stackoverflow.com/questions/31566404/assign-cell-background-color-to-rgb-from-referenced-cells/31566493#31566493", "title": "Assign cell background color to rgb from referenced cells", "body": "<p>Try this:</p>\n\n<pre><code>Range(\"F1\").Interior.Color = RGB(Range(\"C1\"), Range(\"D1\"), Range(\"E1\"))\n</code></pre>\n\n<p>In your version of code <code>C1</code>, <code>D1</code>, <code>E1</code> are taken as variables and they have default value 0, so macro assign color equal to RGB(0, 0, 0) which is black. </p>\n"}], "owner": {"reputation": 730, "user_id": 4449777, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/f8de45e8675a994afd4da053a37f868d?s=128&d=identicon&r=PG&f=1", "display_name": "willpower2727", "link": "https://stackoverflow.com/users/4449777/willpower2727"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1075, "favorite_count": 0, "accepted_answer_id": 31566493, "answer_count": 1, "score": 0, "last_activity_date": 1437576412, "creation_date": 1437576075, "question_id": 31566404, "link": "https://stackoverflow.com/questions/31566404/assign-cell-background-color-to-rgb-from-referenced-cells", "title": "Assign cell background color to rgb from referenced cells", "body": "<p>I'm working in excel on programatically setting a cell's background color to be a specific RGB color that is referenced in nearby cells. Here's what I'm trying to do:</p>\n\n<p><a href=\"https://i.stack.imgur.com/yRgPo.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/yRgPo.png\" alt=\"enter image description here\"></a></p>\n\n<p>You can see that I manually set the background color to be the RGB values specified in the cells in the same row on the left, as highlighted in the picture. The first purple cell has RGB (148,91,128).</p>\n\n<p>I want to do this in VBA or maybe even conditional formatting if possible. So far I have tried this simple vba line of code to see if it would work:</p>\n\n<pre><code>Range(\"F1\").Interior.Color = RGB(C1, D1, E1)\n</code></pre>\n\n<p>However this line of code sets the cell to have a black background like this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/b0FWx.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/b0FWx.png\" alt=\"enter image description here\"></a></p>\n\n<p>If the code had worked correctly, this cell should have been a nearly white color, not black. Any ideas on why this isn't working? Am I making a mistake is the way I reference the cells for RGB?</p>\n\n<p>It would be nice to be able to assign the range \"F1:F__\" to reference the cells to the left on each row too, not just one cell. Thanks!</p>\n"}, {"tags": ["sql-server", "excel", "export-to-excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 5144066, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Omu6U.jpg?s=128&g=1", "display_name": "Smash", "link": "https://stackoverflow.com/users/5144066/smash"}, "edited": false, "score": 0, "creation_date": 1437587894, "post_id": 31570402, "comment_id": 51096034, "body": "Thanks, jradich1234.  Your solution is a little difficult to accomplish on this end simply because I&#39;ve got 500 spreadsheets.  I&#39;d have to get a loop where the SQL processed and then got the excel to do the import==&gt; one at a time.  That seems cumbersome."}, {"owner": {"reputation": 1, "user_id": 5144066, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Omu6U.jpg?s=128&g=1", "display_name": "Smash", "link": "https://stackoverflow.com/users/5144066/smash"}, "edited": false, "score": 0, "creation_date": 1437659165, "post_id": 31570402, "comment_id": 51130318, "body": "I suppose I could build an On_Open event into an xls-type and get it into the loop that way?  I dunno.  It seems like that will take forever and be a big rickety process like we already have...I guess it&#39;s time to go the third-party route."}, {"owner": {"reputation": 1330, "user_id": 4554876, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/0oszf.png?s=128&g=1", "display_name": "jradich1234", "link": "https://stackoverflow.com/users/4554876/jradich1234"}, "reply_to_user": {"reputation": 1, "user_id": 5144066, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Omu6U.jpg?s=128&g=1", "display_name": "Smash", "link": "https://stackoverflow.com/users/5144066/smash"}, "edited": false, "score": 0, "creation_date": 1437659629, "post_id": 31570402, "comment_id": 51130697, "body": "My best advice would be to code something in a real object oriented coding environment.  At that point you could spin up worker threads to create multiple of what ever your output needs to be simultaneously.  That&#39;s going to be best combination of speed and custom tailored to meet your needs."}], "tags": [], "owner": {"reputation": 1330, "user_id": 4554876, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/0oszf.png?s=128&g=1", "display_name": "jradich1234", "link": "https://stackoverflow.com/users/4554876/jradich1234"}, "is_accepted": false, "score": 0, "last_activity_date": 1437587314, "creation_date": 1437587314, "answer_id": 31570402, "question_id": 31566345, "link": "https://stackoverflow.com/questions/31566345/automated-export-of-a-table-query-from-sql-svr-2012-into-excel-2007-and-subseque/31570402#31570402", "title": "Automated export of a table/query from SQL SVR 2012 into Excel 2007 and subsequent VBA formatting macro?", "body": "<p>You could write some VBA code in an Excel Spreadsheet to go get the data from your database and then do the formatting VBA after.  The below code should be a good starting point.  </p>\n\n<p>Please note that you will have to add a Reference to <code>Microsoft ActiveX Data Objects Library</code> for this code to function.  Also, you may need to change the Provider in you connection string deepening on you systems configuration.  The below code utilizes the SQL Server Native Client 11.</p>\n\n<pre><code>Dim cn As New ADODB.Connection\nDim SQLrs As New ADODB.Recordset\nDim SQLCommand As String\n\nSQLCommand = \"SELECT...FROM...\"\n\ncn.ConnectionString = \"Provider=SQLNCLI11;Server=xxxxxxx;DataBase=xxxxxx;Trusted_Connection=yes;\"\ncn.Open\ncn.Execute \"SET NOCOUNT ON\" ''required for complex T-SQL queries\n\nSQLrs.CursorLocation = adUseClient\nCall SQLrs.Open(SQLCommand, cn, adOpenStatic, adLockBatchOptimistic)\n\nActiveWorkbook.Sheets(\"sheet1\").Range(\"a1\").CopyFromRecordset SQLrs\n\nSQLrs.Close\nSet SQLrs = Nothing\ncn.Close\nSet cn = Nothing\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 5144066, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Omu6U.jpg?s=128&g=1", "display_name": "Smash", "link": "https://stackoverflow.com/users/5144066/smash"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 463, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1438242654, "creation_date": 1437575918, "last_edit_date": 1531161705, "question_id": 31566345, "link": "https://stackoverflow.com/questions/31566345/automated-export-of-a-table-query-from-sql-svr-2012-into-excel-2007-and-subseque", "title": "Automated export of a table/query from SQL SVR 2012 into Excel 2007 and subsequent VBA formatting macro?", "body": "<p>I\u2019ve been given the task of updating some code which isn\u2019t working after our SQL SVR 200 to SQL SVR 2012 (don't laugh) conversion.  We have an automated task that creates 500ish xls files in a line-by-line manner by using the old sp_OACreate command.  In 2000, this job always takes hours and is rickety at best.  Needless to say, it doesn\u2019t work at all in 2012.  That's what you get for never upgrading?</p>\n\n<p>I rewrote the job by constructing a table, adding info into the table, &amp; doing a bulk export into xls (using OpenRowSet).  The new task ran in less than 15 minutes and I was ecstatic.  Then Ops complained that the new files weren\u2019t formatted\u2026</p>\n\n<p>I looped back and tried to get the formatting into the automation.  That\u2019s where everything fell apart.</p>\n\n<ol>\n<li><p>Use OpenRowSet and export into an \u201cxls template file\u201d that has an autorun vba code to do the formatting when the file is opened for the first time.  Didn\u2019t work.</p></li>\n<li><p>Use OpenRowSet and export into an \u201cxlsm template file\u201d that has an autorun vba code to do the formatting when the file is opened for the first time.  Didn\u2019t work.</p></li>\n<li><p>Use BCP and export into an \u201cxls template file\u201d that has an autorun vba code to do the formatting when the file is opened for the first time.  Didn\u2019t work.</p></li>\n<li><p>Use BCP and export into an \u201cxlsm template file\u201d that has an autorun vba code to do the formatting when the file is opened for the first time.  Didn\u2019t work.</p></li>\n<li><p>Use BCP/OpenRowSet and export into xls/xlsx and try to execute a vba code from another workbook\u2026Didn\u2019t work.</p></li>\n<li><p>Use BCP/OpenRowSet, export into a \u201cdummy\u201d xls/xlsx, use a bat file to recopy the file, resave, etc\u2026Didn\u2019t work.</p></li>\n<li><p>Use BCP/OpenRowSet, export into a \u201cdummy\u201d txt/csv, use a bat file to convert the file into excel, resave, etc\u2026Didn\u2019t work.</p></li>\n<li><p>Etc.  Didn't work.</p></li>\n</ol>\n\n<p>I tried every combination, every export method, every filetype, etc.  Certain methods allowed me to export but no formatting.  Other methods wouldn\u2019t even export anything.  No method permitted the export/format, though.</p>\n\n<p>Then I discovered the \u201cREAL\u201d problem ==> When I export using BCP/OpenRowSet and then try to open the file, I always get the \u201cfile you are trying to open is in a different format than specified by the file extension\u201d error (FYI Using Excel 2007).  I had sort of ignored this error, but after days of banging my head against the wall I can now see that this error was leading me to the real problem all along.  The export file (regardless of xls/xlsm/xlsx) is not an actual excel file; it\u2019s really just a bunch of html tags.  This is why the formatting vba code won\u2019t work; it\u2019s not an actual excel file!  No matter what I do, it\u2019s still not a real excel file.  Formatting will never work because it's simply not a real excel file.</p>\n\n<p>So, I need an automated method to export a table to some sort of excel format (xls/xlsm/xlsx) and then execute a vba code to format (bold, column width, number/date formatting, etc.) the newly-exported file.  This seems like such a routine task\u2026but I see now that routine &lt;> easy.  I\u2019ve seen references to NPOI and ClosedXML in forums, but I simply can\u2019t believe that I need additional 3rd party software to accomplish this task.</p>\n"}, {"tags": ["html", "vba"], "comments": [{"owner": {"reputation": 3413, "user_id": 4857255, "user_type": "registered", "profile_image": "https://graph.facebook.com/914125558644955/picture?type=large", "display_name": "Lance", "link": "https://stackoverflow.com/users/4857255/lance"}, "edited": false, "score": 0, "creation_date": 1437575988, "post_id": 31566179, "comment_id": 51088085, "body": "What are you really trying to do here, and why so many empty cells?"}, {"owner": {"reputation": 5712, "user_id": 2730554, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/d6682e696c4f9438678b6638f271230a?s=128&d=identicon&r=PG&f=1", "display_name": "mHelpMe", "link": "https://stackoverflow.com/users/2730554/mhelpme"}, "reply_to_user": {"reputation": 3413, "user_id": 4857255, "user_type": "registered", "profile_image": "https://graph.facebook.com/914125558644955/picture?type=large", "display_name": "Lance", "link": "https://stackoverflow.com/users/4857255/lance"}, "edited": false, "score": 0, "creation_date": 1437576108, "post_id": 31566179, "comment_id": 51088181, "body": "I was using the empty cells so the headers wouldn&#39;t be so close to each other. I&#39;m guessing there is some kind of padding function I can use? I would like the &quot;Premium / (Discount)&quot; header to centre over the Bid % and Ask % column headers"}], "answers": [{"comments": [{"owner": {"reputation": 5712, "user_id": 2730554, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/d6682e696c4f9438678b6638f271230a?s=128&d=identicon&r=PG&f=1", "display_name": "mHelpMe", "link": "https://stackoverflow.com/users/2730554/mhelpme"}, "edited": false, "score": 0, "creation_date": 1437577606, "post_id": 31566538, "comment_id": 51089347, "body": "thanks that&#39;s much better than what I had written. The cellpadding obviously works in all directions. Is there a way just to space the headings. I.e. the rows in my table and now spaced out"}, {"owner": {"reputation": 309, "user_id": 5144025, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/08e7ca4817b1c4f1048c0ffe79339002?s=128&d=identicon&r=PG", "display_name": "ZeusInTexas", "link": "https://stackoverflow.com/users/5144025/zeusintexas"}, "reply_to_user": {"reputation": 5712, "user_id": 2730554, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/d6682e696c4f9438678b6638f271230a?s=128&d=identicon&r=PG&f=1", "display_name": "mHelpMe", "link": "https://stackoverflow.com/users/2730554/mhelpme"}, "edited": false, "score": 1, "creation_date": 1437577969, "post_id": 31566538, "comment_id": 51089662, "body": "I&#39;m affraid it&#39;s not possible since it adds a padding to the whole column, and not for each cells... You cannot have a header cell with a different width than the cells from the others row and in the same column"}], "tags": [], "owner": {"reputation": 309, "user_id": 5144025, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/08e7ca4817b1c4f1048c0ffe79339002?s=128&d=identicon&r=PG", "display_name": "ZeusInTexas", "link": "https://stackoverflow.com/users/5144025/zeusintexas"}, "is_accepted": true, "score": 2, "last_activity_date": 1437576401, "creation_date": 1437576401, "answer_id": 31566538, "question_id": 31566179, "link": "https://stackoverflow.com/questions/31566179/create-html-table-and-have-table-header-span-more-than-one-column/31566538#31566538", "title": "create html table and have table header span more than one column", "body": "<p>According to your code, your table has a total of 14 columns, so your colspan should be of <code>14</code> instead of <code>2</code>.</p>\n\n<p>Also, you're using some of these columns as space : <code>&lt;th&gt;&amp;nbsp;&lt;/th&gt;</code>. Note that you can do it better by adding a cell-padding value (in pixels) to your <code>&lt;table&gt;</code>, so your table will look like this : <a href=\"http://cssdeck.com/labs/qyh7ytdi\" rel=\"nofollow\">http://cssdeck.com/labs/qyh7ytdi</a>.</p>\n\n<p>Here is the code that should do the trick:</p>\n\n<pre><code>msg = \"&lt;table style='font-size: 12pt;' cellpadding='5'&gt;\" &amp; _\n      \"&lt;tr&gt;&lt;th colspan='3'&gt;&lt;/th&gt;&lt;th colspan='2'&gt;Premium /(Discount)&lt;/th&gt;&lt;/tr&gt;\" &amp; _\n      \"&lt;tr&gt;&lt;th align='left'&gt;Fund&lt;/th&gt;\" &amp; _\n      \"&lt;th align='left'&gt;Market Spread %&lt;/th&gt;\" &amp; _\n      \"&lt;th align='left'&gt;Tolerance&lt;/th&gt;\" &amp; _\n      \"&lt;th align='left'&gt;Bid %&lt;/th&gt;\" &amp; _\n      \"&lt;th align='left'&gt;Ask %&lt;/th&gt;\" &amp; _\n      \"&lt;th align='left'&gt;Tolerance&lt;/th&gt;\" &amp; _\n      \"&lt;th align='left'&gt;Extra Notes&lt;/th&gt;&lt;/tr&gt;\"\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 92, "user_id": 4057926, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/226eed698c1c0d2f27cc70a482dc623f?s=128&d=identicon&r=PG&f=1", "display_name": "Anshul", "link": "https://stackoverflow.com/users/4057926/anshul"}, "is_accepted": false, "score": 1, "last_activity_date": 1437576953, "creation_date": 1437576953, "answer_id": 31566778, "question_id": 31566179, "link": "https://stackoverflow.com/questions/31566179/create-html-table-and-have-table-header-span-more-than-one-column/31566778#31566778", "title": "create html table and have table header span more than one column", "body": "<pre><code>&lt;html&gt;\n&lt;body&gt;&lt;table style='font-size: 12pt;'&gt;&lt;tr&gt;\n    &lt;th&gt;&lt;/th&gt;&lt;th&gt;&lt;/th&gt;&lt;th&gt;&lt;/th&gt;&lt;th colspan='2'&gt;Premium /(Discount)&lt;/th&gt;&lt;th&gt;&lt;/th&gt;&lt;th&gt;&lt;/th&gt;&lt;/tr&gt;\n    &lt;tr&gt;&lt;th align='left'&gt;Fund&lt;/th&gt;\n    &lt;th align='left'&gt;Market Spread %&lt;/th&gt;\n    &lt;th align='left'&gt;Tolerance&lt;/th&gt;\n    &lt;th align='left'&gt;Bid %&lt;/th&gt;\n    &lt;th align='left'&gt;Ask %&lt;/th&gt;\n    &lt;th align='left'&gt;Tolerance&lt;/th&gt;\n    &lt;th align='left'&gt;Extra Notes&lt;/th&gt;&lt;/tr&gt;\n&lt;/table&gt;\n&lt;/body&gt;\n&lt;/html&gt;\n</code></pre>\n\n<p>This will help \"Premium / (Discount)\" header to centre over the Bid % and Ask % column headers no matter the width of the columns.</p>\n\n<p><strong>NOTE: It won't center it the whole table.</strong></p>\n"}], "owner": {"reputation": 5712, "user_id": 2730554, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/d6682e696c4f9438678b6638f271230a?s=128&d=identicon&r=PG&f=1", "display_name": "mHelpMe", "link": "https://stackoverflow.com/users/2730554/mhelpme"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 165, "favorite_count": 0, "accepted_answer_id": 31566538, "answer_count": 2, "score": 0, "last_activity_date": 1437576953, "creation_date": 1437575536, "question_id": 31566179, "link": "https://stackoverflow.com/questions/31566179/create-html-table-and-have-table-header-span-more-than-one-column", "title": "create html table and have table header span more than one column", "body": "<p>I am sending an e-mail from excel using outlook. For the body of the e-mail I am making use of HTML.</p>\n\n<p>I had a table which was working fine. However I have been asked to add a header above the current header of my table. The header is called \"Premium / (Discount)\". So the code below does that fine. However I would like for this header to span across two columns and centre.</p>\n\n<p>I am using the line below but it is not working, why?</p>\n\n<pre><code>\"&lt;th colspan='2'&gt;Premium /(Discount)&lt;/th&gt;\n\n\nmsg = \"&lt;table style='font-size: 12pt;'&gt;&lt;tr&gt;&lt;th&gt;&amp;nbsp&lt;/th&gt;&lt;th&gt;&amp;nbsp&lt;/th&gt;&lt;th&gt;&amp;nbsp&lt;/th&gt;&lt;th&gt;&amp;nbsp&lt;/th&gt;&lt;th&gt;&amp;nbsp&lt;/th&gt;&lt;th&gt;&amp;nbsp&lt;/th&gt;\" &amp; _\n    \"&lt;th colspan='2'&gt;Premium /(Discount)&lt;/th&gt;&lt;th&gt;&amp;nbsp&lt;/th&gt;&lt;th&gt;&amp;nbsp&lt;/th&gt;&lt;th&gt;&amp;nbsp&lt;/th&gt;&lt;th&gt;&amp;nbsp&lt;/th&gt;&lt;/tr&gt;\" &amp; _\n    \"&lt;tr&gt;&lt;th align='left'&gt;Fund&lt;/th&gt;&lt;th&gt;&amp;nbsp;&lt;/th&gt;\" &amp; _\n    \"&lt;th align='left'&gt;Market Spread %&lt;/th&gt;&lt;th&gt;&amp;nbsp;&lt;/th&gt;\" &amp; _\n    \"&lt;th align='left'&gt;Tolerance&lt;/th&gt;&lt;th&gt;&amp;nbsp;&lt;/th&gt;\" &amp; _\n    \"&lt;th align='left'&gt;Bid %&lt;/th&gt;&lt;th&gt;&amp;nbsp;&lt;/th&gt;\" &amp; _\n    \"&lt;th align='left'&gt;Ask %&lt;/th&gt;&lt;th&gt;&amp;nbsp;&lt;/th&gt;\" &amp; _\n    \"&lt;th align='left'&gt;Tolerance&lt;/th&gt;&lt;th&gt;&amp;nbsp;&lt;/th&gt;\" &amp; _\n    \"&lt;th align='left'&gt;Extra Notes&lt;/th&gt;&lt;th&gt;&amp;nbsp;&lt;/th&gt;&lt;/tr&gt;\"\n</code></pre>\n"}, {"tags": ["vba", "outlook", "outlook-2013"], "answers": [{"tags": [], "owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "is_accepted": false, "score": 0, "last_activity_date": 1437577273, "creation_date": 1437577273, "answer_id": 31566914, "question_id": 31565849, "link": "https://stackoverflow.com/questions/31565849/how-do-i-reference-outlook-custom-form-userdefined-fields-in-vb-code/31566914#31566914", "title": "How do I reference outlook custom form userdefined fields in vb code?", "body": "<p>If the property was added to the user properties, you can use TaslkItem.UserPropertiers.Find or using TaskItem.PropertyAccessor.GetProperty. The latter will work both for user properties and for the properties set using TaskItem.PropertyAccessor.SetProperty.</p>\n\n<p>To figure out the DASL names of the custom properties, take a look at an item with these properties set using <a href=\"http://www.dimastr.com/outspy/\" rel=\"nofollow\">OutlookSpy</a> - click IMessage button on the OutlookSpy ribbon, select the property, look at the DASL edit box.</p>\n"}], "owner": {"reputation": 3, "user_id": 5144005, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/633f1ccad8f34c8cbde37dc9536eb9ad?s=128&d=identicon&r=PG&f=1", "display_name": "Ericka Miller", "link": "https://stackoverflow.com/users/5144005/ericka-miller"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 339, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1593306784, "creation_date": 1437574849, "last_edit_date": 1593306784, "question_id": 31565849, "link": "https://stackoverflow.com/questions/31565849/how-do-i-reference-outlook-custom-form-userdefined-fields-in-vb-code", "title": "How do I reference outlook custom form userdefined fields in vb code?", "body": "<p>I have a custom form that has userdefined fields unique to my projects. The form works perfectly but would like to make it more useful by emailing or printing referencing the userdefined field. For example field \"AccountNo\". I have tried olTsk.userdefined(\"AccountNo\"): Tsk.userdefined(\"AccountNo\"); (\"AccountNo\") preceded by Dim userdefined fields as Strng; I have seemed to try every variation Google could find for me. I have outlook 2013 at work. I can get it to work on older version at home but nothing seems to work at work. Any help would be appreciated.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 3650, "user_id": 5090027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/904db949ae64fe1a63ea8b4c677e6d57?s=128&d=identicon&r=PG&f=1", "display_name": "Grade &#39;Eh&#39; Bacon", "link": "https://stackoverflow.com/users/5090027/grade-eh-bacon"}, "edited": false, "score": 0, "creation_date": 1437574144, "post_id": 31565314, "comment_id": 51086538, "body": "Where does it result in the error? Have you run your code line by line to find out?"}, {"owner": {"reputation": 1949, "user_id": 1723119, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/8182f3271d9881acad7c1a4d8844ca15?s=128&d=identicon&r=PG", "display_name": "99moorem", "link": "https://stackoverflow.com/users/1723119/99moorem"}, "edited": false, "score": 0, "creation_date": 1437575044, "post_id": 31565314, "comment_id": 51087309, "body": "JK = Range(&quot;RD&quot;).Columns.Count would result in an error itself &quot;RD&quot; is not a valid range. Range(&quot;D:R&quot;) would be a valid range for columns D - R.  unless you have a named range called RD"}, {"owner": {"reputation": 5345, "user_id": 3561813, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/958afeca6b11ffa0e83b97b516c88dc7?s=128&d=identicon&r=PG&f=1", "display_name": "basodre", "link": "https://stackoverflow.com/users/3561813/basodre"}, "reply_to_user": {"reputation": 1949, "user_id": 1723119, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/8182f3271d9881acad7c1a4d8844ca15?s=128&d=identicon&r=PG", "display_name": "99moorem", "link": "https://stackoverflow.com/users/1723119/99moorem"}, "edited": false, "score": 0, "creation_date": 1437575908, "post_id": 31565314, "comment_id": 51088025, "body": "@99moorem It looks like he sets a named range <code>RD</code> in the first line of his code."}, {"owner": {"reputation": 1949, "user_id": 1723119, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/8182f3271d9881acad7c1a4d8844ca15?s=128&d=identicon&r=PG", "display_name": "99moorem", "link": "https://stackoverflow.com/users/1723119/99moorem"}, "reply_to_user": {"reputation": 5345, "user_id": 3561813, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/958afeca6b11ffa0e83b97b516c88dc7?s=128&d=identicon&r=PG&f=1", "display_name": "basodre", "link": "https://stackoverflow.com/users/3561813/basodre"}, "edited": false, "score": 0, "creation_date": 1437579602, "post_id": 31565314, "comment_id": 51090885, "body": "@user3561813 yeah ignore my comment lol, I only reed after the dims. Coding practices dim eveything first"}, {"owner": {"reputation": 5345, "user_id": 3561813, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/958afeca6b11ffa0e83b97b516c88dc7?s=128&d=identicon&r=PG&f=1", "display_name": "basodre", "link": "https://stackoverflow.com/users/3561813/basodre"}, "reply_to_user": {"reputation": 1949, "user_id": 1723119, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/8182f3271d9881acad7c1a4d8844ca15?s=128&d=identicon&r=PG", "display_name": "99moorem", "link": "https://stackoverflow.com/users/1723119/99moorem"}, "edited": false, "score": 0, "creation_date": 1437579704, "post_id": 31565314, "comment_id": 51090949, "body": "@99moorem I understand. It is also a bit nonstandard to create a named range within code just to use it in lieu of a variable. I gave an alternate solution using variables. Hopefully that more closely meets the poster&#39;s needs"}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 5143939, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e326ebc5cac4aa5c5d91de651ae81803?s=128&d=identicon&r=PG&f=1", "display_name": "ageng saputro", "link": "https://stackoverflow.com/users/5143939/ageng-saputro"}, "edited": false, "score": 0, "creation_date": 1437577994, "post_id": 31566547, "comment_id": 51089679, "body": "superb, your code worked fine but it just create a single &quot;Scripting.Dictionary&quot; so it produce unique values of whole columns instead of each one."}, {"owner": {"reputation": 5345, "user_id": 3561813, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/958afeca6b11ffa0e83b97b516c88dc7?s=128&d=identicon&r=PG&f=1", "display_name": "basodre", "link": "https://stackoverflow.com/users/3561813/basodre"}, "reply_to_user": {"reputation": 11, "user_id": 5143939, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e326ebc5cac4aa5c5d91de651ae81803?s=128&d=identicon&r=PG&f=1", "display_name": "ageng saputro", "link": "https://stackoverflow.com/users/5143939/ageng-saputro"}, "edited": false, "score": 0, "creation_date": 1437579611, "post_id": 31566547, "comment_id": 51090893, "body": "@agengsaputro  Sorry! I misunderstood your post and thought you needed unique entries across all columns. Please see amended code. It takes unique values from <i>each</i> column, and puts them all into a new column. Let me know if this more closely resembles what you need."}, {"owner": {"reputation": 11, "user_id": 5143939, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e326ebc5cac4aa5c5d91de651ae81803?s=128&d=identicon&r=PG&f=1", "display_name": "ageng saputro", "link": "https://stackoverflow.com/users/5143939/ageng-saputro"}, "edited": false, "score": 0, "creation_date": 1437601474, "post_id": 31566547, "comment_id": 51103958, "body": "@ user3561813 great, thats what im looking for..thank you very much"}], "tags": [], "owner": {"reputation": 5345, "user_id": 3561813, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/958afeca6b11ffa0e83b97b516c88dc7?s=128&d=identicon&r=PG&f=1", "display_name": "basodre", "link": "https://stackoverflow.com/users/3561813/basodre"}, "is_accepted": false, "score": 1, "last_activity_date": 1437579543, "last_edit_date": 1437579543, "creation_date": 1437576411, "answer_id": 31566547, "question_id": 31565314, "link": "https://stackoverflow.com/questions/31565314/loop-to-create-object-excel-vba/31566547#31566547", "title": "Loop to create Object excel vba", "body": "<p>I'm adding some code below to help loop through a list, looking for unique values, and adding them to a new column. In my example, I enclose the entire functionality into a single <code>loop</code> for efficiency. I'm also adding the unique values to a new column in <code>Sheet2</code> starting with cell <code>A1</code>. </p>\n\n<p>Let me know if you need any additional help.</p>\n\n<p>EDITED CODE BASED ON A MISUNDERSTANDING:</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n    Dim oDict As Object\n    Dim rngToScrub As Range\n    Dim rngNewColumnToStoreUnique As Range\n    Dim oCol As Range\n    Dim cel As Range\n\n    Set rngToScrub = Range(Me.RefEdit1.Value)\n    Set rngNewColumnToStoreUnique = Sheet2.Range(\"A1\")\n\n    For Each oCol In rngToScrub.Columns\n        Set oDict = CreateObject(\"Scripting.Dictionary\")\n\n        For Each cel In oCol.Cells\n            If oDict.exists(cel.Value) Then\n                'Do Nothing for Now\n            Else\n                oDict.Add cel.Value, 0\n                rngNewColumnToStoreUnique.Value = cel.Value\n                Set rngNewColumnToStoreUnique = rngNewColumnToStoreUnique.Offset(1)\n            End If\n        Next cel\n\n        Set oDict = Nothing\n    Next oCol\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p>Old code: Misunderstood requirements</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n    Dim oDict As Object\n    Dim rngToScrub As Range\n    Dim rngNewColumnToStoreUnique As Range\n    Dim cel As Range\n\n    Set oDict = CreateObject(\"Scripting.Dictionary\")\n    Set rngToScrub = Range(Me.RefEdit1.Value)\n    Set rngNewColumnToStoreUnique = Sheet2.Range(\"A1\")\n\n    For Each cel In rngToScrub\n        If oDict.exists(cel.Value) Then\n            'Do Nothing for Now\n        Else\n            oDict.Add cel.Value, 0\n            rngNewColumnToStoreUnique.Value = cel.Value\n            Set rngNewColumnToStoreUnique = rngNewColumnToStoreUnique.Offset(1)\n        End If\n    Next cel\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 5143939, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e326ebc5cac4aa5c5d91de651ae81803?s=128&d=identicon&r=PG&f=1", "display_name": "ageng saputro", "link": "https://stackoverflow.com/users/5143939/ageng-saputro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1006, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1437580939, "creation_date": 1437573480, "last_edit_date": 1531161705, "question_id": 31565314, "link": "https://stackoverflow.com/questions/31565314/loop-to-create-object-excel-vba", "title": "Loop to create Object excel vba", "body": "<p>I tried to get the unique value of each column in the range \"RD\" and display them in single column. I need to create an object (\"scripting.Dictionary\") where there are just as many as the number of columns in Range \"RD\". I tried this code but it resulted in \"Run time error 13\".</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n\nRange(Me.RefEdit1).Name = \"RD\"\nRange(Me.RefEdit2).Name = \"OT\"\nDim d As Object, c As Variant, i As Long, s As Long\nDim JK As Long\nDim o As Collection\nJK = Range(\"RD\").Columns.Count\nSet d = CreateObject(\"Scripting.Dictionary\")\n\nFor k = 0 To JK + 1\n    d.Item(k) = CreateObject(\"Scripting.Dictionary\").Item(k)\n    c = Range(\"RD\").Columns(k + 1)\n\n    If d.Exists(k) Then\n        d.Item(k) = d.Item(k) + 1 'increment\n    Else\n        d.Item(k) = 1 'set as 1st occurence\n    End If\n\n    For i = 1 To UBound(c, 1)\n        d.Item(k)(c(i, 1)) = 1\n    Next i\n\n    Range(\"OT\").Cells((k * 5) + 2, 2).Resize(d.Item(k).Count) = Application.Transpose(d.Item(k).Keys)\n    Range(\"OT\").Cells((k * 5) + 2, 2).Resize(d.Item(k).Count).Sort Key1:=Range(\"OT\").Cells((k * 5) + 2, 2).Resize(d.Item(k).Count)\nNext k\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 6311, "user_id": 5073840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yRIIb.jpg?s=128&g=1", "display_name": "MatthewD", "link": "https://stackoverflow.com/users/5073840/matthewd"}, "edited": false, "score": 1, "creation_date": 1437573574, "post_id": 31565231, "comment_id": 51086022, "body": "Please post your code that does it in VB"}, {"owner": {"reputation": 3650, "user_id": 5090027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/904db949ae64fe1a63ea8b4c677e6d57?s=128&d=identicon&r=PG&f=1", "display_name": "Grade &#39;Eh&#39; Bacon", "link": "https://stackoverflow.com/users/5090027/grade-eh-bacon"}, "edited": false, "score": 3, "creation_date": 1437574042, "post_id": 31565231, "comment_id": 51086456, "body": "Copy your VB module into Excel. Make the main sub public. Add a macro. Tell the macro to run your sub. If you can&#39;t do that, there is the sliiiiiight possibility that you did not write your VB code."}, {"owner": {"reputation": 35, "user_id": 4529001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e56093e5a0eed8ac99eb974ebcb8d552?s=128&d=identicon&r=PG&f=1", "display_name": "newusercitrix", "link": "https://stackoverflow.com/users/4529001/newusercitrix"}, "edited": false, "score": 0, "creation_date": 1437577948, "post_id": 31565231, "comment_id": 51089638, "body": "OKay. U&#39;ll try that and let you know. Does it mean that my timer event from the VB will also work in the Excel?"}], "answers": [{"tags": [], "owner": {"reputation": 2754, "user_id": 996908, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/8f97d264193fb479fd7eb10cce0a55a1?s=128&d=identicon&r=PG", "display_name": "Mr Smith", "link": "https://stackoverflow.com/users/996908/mr-smith"}, "is_accepted": false, "score": 0, "last_activity_date": 1437575052, "creation_date": 1437575052, "answer_id": 31565945, "question_id": 31565231, "link": "https://stackoverflow.com/questions/31565231/excel-macro-needed-which-can-check-the-downloads-folder-and-delete-all-the-files/31565945#31565945", "title": "Excel Macro needed which can check the downloads folder and delete all the files except the latest downloaded file", "body": "<p>Set a reference to the Microsoft Scripting Runtime.  The images below shows the classes available in the Object Browser.  I usually use this for file-related tasks in VBA.  I did some research &amp; the Microsoft Scripting Runtime is standard on Windows so everyone should have it</p>\n\n<p><a href=\"https://i.stack.imgur.com/pOL1D.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/pOL1D.jpg\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 35, "user_id": 4529001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e56093e5a0eed8ac99eb974ebcb8d552?s=128&d=identicon&r=PG&f=1", "display_name": "newusercitrix", "link": "https://stackoverflow.com/users/4529001/newusercitrix"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 241, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1462526034, "creation_date": 1437573275, "last_edit_date": 1462526034, "question_id": 31565231, "link": "https://stackoverflow.com/questions/31565231/excel-macro-needed-which-can-check-the-downloads-folder-and-delete-all-the-files", "title": "Excel Macro needed which can check the downloads folder and delete all the files except the latest downloaded file", "body": "<p>I want to make an excel file which would do the following steps:</p>\n\n<ol>\n<li>Delete all the excel files from the downloads folder except for the one latest downloaded file.</li>\n<li>Make a copy of that excel file names as \"Data.xls\" and system makes a \"Beep\" sound</li>\n<li>Repeat the above mentioned two steps every 15 minutes</li>\n</ol>\n\n<p>I can do this in Visual Basic but unable to implement that in Excel Macro...</p>\n\n<p>Please help.. My promotion depends on that  :-)</p>\n"}, {"tags": ["vba", "ms-access", "dao", "recordset"], "answers": [{"comments": [{"owner": {"reputation": 41, "user_id": 5143817, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/efc73c3a05bd465126bd7c43963b9e2b?s=128&d=identicon&r=PG&f=1", "display_name": "aPere", "link": "https://stackoverflow.com/users/5143817/apere"}, "edited": false, "score": 0, "creation_date": 1437632763, "post_id": 31568022, "comment_id": 51112865, "body": "This code is running inside a class. I tried it anyway, and it didn&#39;t change anything, the recordset keep changing by itself...."}], "tags": [], "owner": {"reputation": 1703, "user_id": 1174399, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a14a1c76042e287e36b1c765fb1eaaa5?s=128&d=identicon&r=PG", "display_name": "Don Jewett", "link": "https://stackoverflow.com/users/1174399/don-jewett"}, "is_accepted": false, "score": 0, "last_activity_date": 1437580133, "creation_date": 1437580133, "answer_id": 31568022, "question_id": 31565183, "link": "https://stackoverflow.com/questions/31565183/dao-recordset-changing-by-itself-on-edit-or-update/31568022#31568022", "title": "DAO Recordset Changing by itself on Edit or Update", "body": "<p>If you are running this code inside of a Form, there is already an object named Recordset which is a Form property. The compiler is probably getting confused.</p>\n\n<p>Change your variable name to oRecordset (or my favorite, rs)</p>\n\n<pre><code>Dim rs as DAO.Recordset\nSet rs = CurrentDb.OpenRecordset(\"query\", dbOpenDynaset)\n\nWith rs\n    .Edit\n    .Fields(\"field\").Value = \"\"\n    .Update\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 41, "user_id": 5143817, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/efc73c3a05bd465126bd7c43963b9e2b?s=128&d=identicon&r=PG&f=1", "display_name": "aPere", "link": "https://stackoverflow.com/users/5143817/apere"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 406, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1474502104, "creation_date": 1437573180, "last_edit_date": 1437574357, "question_id": 31565183, "link": "https://stackoverflow.com/questions/31565183/dao-recordset-changing-by-itself-on-edit-or-update", "title": "DAO Recordset Changing by itself on Edit or Update", "body": "<p>I'm experimenting an issue when trying to <code>.edit</code> or <code>.update</code> a DAO.Recordset on a VBA/Access project.  I'm actually using CodeVBA extension to create classes from tables automatically.  The issue occurs on a class created this way.</p>\n\n<p>The Recordset variable is declared this way:</p>\n\n<pre><code>Dim Recordset as DAO.Recordset\nSet Recordset = CurrentDb.OpenRecordset(\"Ordres de travail\", dbOpenDynaset)\n</code></pre>\n\n<p>I have those two lines in my code:</p>\n\n<pre><code>    Recordset.Edit\n    Recordset.Fields(\"Commentaire indisponibilit\u00e9\").Value = NullIfEmptyString(Me.Commentaireindisponibilit\u00e9)\n</code></pre>\n\n<p>During the execution, I am monitoring the selected record by looking at the value of primary key in the local variables panel.  Before the execution of the first line, the primary key value is 1409, but during, and after, it moves to record 91! With no steps missed (I'm using step by step execution).</p>\n\n<p>I'm quite disappointed by this, and I can't get to have the right record edited.</p>\n\n<p>If any of you have an idea of what is going on, I'll be glad to know!</p>\n"}, {"tags": ["database", "ms-access", "vba", "ms-access-2007", "auto-populate"], "answers": [{"tags": [], "owner": {"reputation": 158, "user_id": 4342816, "user_type": "registered", "profile_image": "https://graph.facebook.com/729471028/picture?type=large", "display_name": "Billy Norbu", "link": "https://stackoverflow.com/users/4342816/billy-norbu"}, "is_accepted": false, "score": 0, "last_activity_date": 1437577656, "creation_date": 1437577656, "answer_id": 31567076, "question_id": 31565145, "link": "https://stackoverflow.com/questions/31565145/autopopulate-a-field-in-a-form-based-on-what-user-is-logged-in/31567076#31567076", "title": "Autopopulate a field in a form based on what user is logged in", "body": "<p>You might want to check out the \"OnLoad\" property of the form. Go to the properties section of the job sheet and click on its \"on load\" event. Select VBA code. Type the following:-</p>\n\n<p>me.<em>fieldname</em> = [Forms]![<em>FirstFormWhereLoginDropdownPresent</em>].<em>DropDownName</em>.Value</p>\n\n<p>Hope this helps</p>\n"}], "owner": {"reputation": 1, "user_id": 5077157, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1fa991e26e22d680ab8ce3dd0483436e?s=128&d=identicon&r=PG&f=1", "display_name": "Ibby", "link": "https://stackoverflow.com/users/5077157/ibby"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 83, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1594644079, "creation_date": 1437573098, "last_edit_date": 1594644079, "question_id": 31565145, "link": "https://stackoverflow.com/questions/31565145/autopopulate-a-field-in-a-form-based-on-what-user-is-logged-in", "title": "Autopopulate a field in a form based on what user is logged in", "body": "<p>I've created an access database using access 2007 for one of the teams I work with and I'm fairly new to access so would like some help. The database is being used to log jobs for engineers so I have a login system where a user selects their name from a drop down and enters their password, and depending on their access levels they get directed to their own user menus etc. Now what I would like is once the user has logged in they will click on the job sheet button will then direct them to a list of jobs raised from here they click on new and then a pop of the Job Sheet where they can enter details from the call pops up what i want is in this job sheet for their name to auto-populate in the field labelled user, how do I get the user who has logged in their name to just auto populate in the field once they have accessed it. </p>\n"}, {"tags": ["arrays", "vba", "excel"], "comments": [{"owner": {"reputation": 6311, "user_id": 5073840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yRIIb.jpg?s=128&g=1", "display_name": "MatthewD", "link": "https://stackoverflow.com/users/5073840/matthewd"}, "edited": false, "score": 0, "creation_date": 1437573177, "post_id": 31565084, "comment_id": 51085687, "body": "What is the problem? Are you getting an error?"}, {"owner": {"reputation": 2285, "user_id": 4916894, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/54ad102d504b32ad99085f6f6ab14d9d?s=128&d=identicon&r=PG&f=1", "display_name": "David G", "link": "https://stackoverflow.com/users/4916894/david-g"}, "edited": false, "score": 0, "creation_date": 1437573381, "post_id": 31565084, "comment_id": 51085858, "body": "Only the last dimension can be changed, unfortunately."}], "answers": [{"tags": [], "owner": {"reputation": 3740, "user_id": 3064741, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3d1eaeba1b98ecb9d37ccb68c69aec0?s=128&d=identicon&r=PG&f=1", "display_name": "mielk", "link": "https://stackoverflow.com/users/3064741/mielk"}, "is_accepted": true, "score": 6, "last_activity_date": 1437656748, "last_edit_date": 1437656748, "creation_date": 1437573271, "answer_id": 31565228, "question_id": 31565084, "link": "https://stackoverflow.com/questions/31565084/redim-size-of-array-in-vba-excel/31565228#31565228", "title": "Redim size of array in VBA Excel", "body": "<p>When using <code>Preserve</code> keyword; you can change size only for the last dimension. The size of other dimensions once declared must remain unaltered.</p>\n\n<p>The code below should work:</p>\n\n<pre><code>ReDim Preserve table_data(LBound(table_data, 1) To UBound(table_data, 1), 0 To dim2)\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 5074409, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/73aaba0aa71a116c08973c3e26b6e2fb?s=128&d=identicon&r=PG&f=1", "display_name": "mateaus", "link": "https://stackoverflow.com/users/5074409/mateaus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1116, "favorite_count": 0, "accepted_answer_id": 31565228, "answer_count": 1, "score": 1, "last_activity_date": 1437656748, "creation_date": 1437572938, "last_edit_date": 1437656717, "question_id": 31565084, "link": "https://stackoverflow.com/questions/31565084/redim-size-of-array-in-vba-excel", "title": "Redim size of array in VBA Excel", "body": "<p>I have some problem to use the function <code>redim</code> preserve in VBA Excel.</p>\n\n<p>I would like to <code>redim</code> an array I already use in the macro before without clear the data already inside.</p>\n\n<p>My macro is looking like that :</p>\n\n<pre><code>Dim table_data As Variant\n...\nReDim table_data(2 * n + 2 * m + 2 * n, table_case.ListColumns.Count - 1)\n...\ndim1 = UBound(table_data, 1)\ndim2 = UBound(table_data, 2)\nReDim Preserve table_data(0 To dim1 + 2 * n, 0 To dim2)\n</code></pre>\n\n<p>Do you have any idea what I should modify?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1437573246, "post_id": 31565028, "comment_id": 51085743, "body": "Where does your table start? Or do you want to search ALL columns for a color?"}, {"owner": {"reputation": 5, "user_id": 4620484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/753c96ec8b4f6eca1a9717f427497530?s=128&d=identicon&r=PG&f=1", "display_name": "Abhinath Kumar", "link": "https://stackoverflow.com/users/4620484/abhinath-kumar"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1437573348, "post_id": 31565028, "comment_id": 51085822, "body": "I want to start searching from the 3rd column onwards"}, {"owner": {"reputation": 5, "user_id": 4620484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/753c96ec8b4f6eca1a9717f427497530?s=128&d=identicon&r=PG&f=1", "display_name": "Abhinath Kumar", "link": "https://stackoverflow.com/users/4620484/abhinath-kumar"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1437573438, "post_id": 31565028, "comment_id": 51085912, "body": "So basically from Column C onwards"}], "answers": [{"comments": [{"owner": {"reputation": 5, "user_id": 4620484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/753c96ec8b4f6eca1a9717f427497530?s=128&d=identicon&r=PG&f=1", "display_name": "Abhinath Kumar", "link": "https://stackoverflow.com/users/4620484/abhinath-kumar"}, "edited": false, "score": 1, "creation_date": 1437574562, "post_id": 31565556, "comment_id": 51086916, "body": "Do not have enough reputation points as I do not use this much.....so cant post an image...ill explain more clearly"}, {"owner": {"reputation": 3650, "user_id": 5090027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/904db949ae64fe1a63ea8b4c677e6d57?s=128&d=identicon&r=PG&f=1", "display_name": "Grade &#39;Eh&#39; Bacon", "link": "https://stackoverflow.com/users/5090027/grade-eh-bacon"}, "edited": false, "score": 1, "creation_date": 1437574616, "post_id": 31565556, "comment_id": 51086959, "body": "Is it advisable to provide such a thorough answer to a question which hasn&#39;t yet been attempted by the OP? I feel there are a lot of examples of &#39;super-user&#39; type questions asked in the Excel tag where people without any VBA exposure just want a button that does what they ask, and this decreases the quality of the tag in general."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 5, "user_id": 4620484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/753c96ec8b4f6eca1a9717f427497530?s=128&d=identicon&r=PG&f=1", "display_name": "Abhinath Kumar", "link": "https://stackoverflow.com/users/4620484/abhinath-kumar"}, "edited": false, "score": 0, "creation_date": 1437574624, "post_id": 31565556, "comment_id": 51086963, "body": "@AbhinathKumar - ah.  Is your table MOSTLY colored?  When you say you want the begenning and end rows, do you mean for each column, you want the FIRST row (starting row 1, going down) and the LAST row in that column that are colored?"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 3650, "user_id": 5090027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/904db949ae64fe1a63ea8b4c677e6d57?s=128&d=identicon&r=PG&f=1", "display_name": "Grade &#39;Eh&#39; Bacon", "link": "https://stackoverflow.com/users/5090027/grade-eh-bacon"}, "edited": false, "score": 0, "creation_date": 1437574699, "post_id": 31565556, "comment_id": 51087024, "body": "@Grade&#39;Eh&#39;Bacon - I worked through that VBA before realizing I wasn&#39;t sure what he meant.  But I do agree, that is perhaps a premature answer."}, {"owner": {"reputation": 5, "user_id": 4620484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/753c96ec8b4f6eca1a9717f427497530?s=128&d=identicon&r=PG&f=1", "display_name": "Abhinath Kumar", "link": "https://stackoverflow.com/users/4620484/abhinath-kumar"}, "edited": false, "score": 1, "creation_date": 1437574750, "post_id": 31565556, "comment_id": 51087051, "body": "Basically, there is table with horizontal axis(Column Headers) stating dates like a timeline, and the vertical axis stating names of people(Row Headers). The people have done activities on certain dates (e.g from 12/05/15 to 19/05/15)....the cells under these dates will be coloured....I want the code to automatically tell me the start and end date (where the colour starts and ends)"}, {"owner": {"reputation": 5, "user_id": 4620484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/753c96ec8b4f6eca1a9717f427497530?s=128&d=identicon&r=PG&f=1", "display_name": "Abhinath Kumar", "link": "https://stackoverflow.com/users/4620484/abhinath-kumar"}, "edited": false, "score": 1, "creation_date": 1437575045, "post_id": 31565556, "comment_id": 51087311, "body": "Thank you very much for the previous answer anyway, but when I run it, it says run-time error 6 overflow..and the line &#39;&#39; endRow = .Cells(startRow, k).End(xlDown).Row&#39;&#39; is highlighted"}, {"owner": {"reputation": 3650, "user_id": 5090027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/904db949ae64fe1a63ea8b4c677e6d57?s=128&d=identicon&r=PG&f=1", "display_name": "Grade &#39;Eh&#39; Bacon", "link": "https://stackoverflow.com/users/5090027/grade-eh-bacon"}, "reply_to_user": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "edited": false, "score": 1, "creation_date": 1437575319, "post_id": 31565556, "comment_id": 51087543, "body": "@pnuts Agreed completely."}, {"owner": {"reputation": 5, "user_id": 4620484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/753c96ec8b4f6eca1a9717f427497530?s=128&d=identicon&r=PG&f=1", "display_name": "Abhinath Kumar", "link": "https://stackoverflow.com/users/4620484/abhinath-kumar"}, "reply_to_user": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "edited": false, "score": 1, "creation_date": 1437575500, "post_id": 31565556, "comment_id": 51087689, "body": "I have already tried writing the code, but I keep hitting a dead end...im not asking for the whole answer, but just want some ideas on how to do this. @pnuts so not really relevant"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1437575594, "post_id": 31565556, "comment_id": 51087763, "body": "You could just write a script that takes a range (the range being each row), search in that row for a color, note that cell value, then find the next color, note that value.  Now you have your start and end dates.  Also, regarind that Overflow, change the &quot;endRow&quot;, &quot;startRow&quot; to <code>Long</code> instead of <code>Integer</code>.  Can you please post the code you have so far?"}, {"owner": {"reputation": 5, "user_id": 4620484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/753c96ec8b4f6eca1a9717f427497530?s=128&d=identicon&r=PG&f=1", "display_name": "Abhinath Kumar", "link": "https://stackoverflow.com/users/4620484/abhinath-kumar"}, "edited": false, "score": 1, "creation_date": 1437575880, "post_id": 31565556, "comment_id": 51088000, "body": "The problem is...sorry for unclear explanation... all the cells between those two dates are coloured, so I cant just locate the next coloured cell....or could I locate the next uncoloured cell?"}, {"owner": {"reputation": 5, "user_id": 4620484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/753c96ec8b4f6eca1a9717f427497530?s=128&d=identicon&r=PG&f=1", "display_name": "Abhinath Kumar", "link": "https://stackoverflow.com/users/4620484/abhinath-kumar"}, "edited": false, "score": 1, "creation_date": 1437576472, "post_id": 31565556, "comment_id": 51088471, "body": "Function SumByColor(CellColor As Range, SumRange As Range)      Dim myCell As Range      Dim iCol As Integer      Dim myTotal      iCol = CellColor.Interior.ColorIndex &#39;get the target color     For Each myCell In SumRange &#39;look at each cell in the designated range         If myCell.Interior.ColorIndex = iCol Then &#39;if the cell color matches the target Color             myTotal = WorksheetFunction.Sum(myCell) + myTotal &#39;add the value in the cell to the total         End If      Next myCell      SumByColor = myTotal  End Function"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 5, "user_id": 4620484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/753c96ec8b4f6eca1a9717f427497530?s=128&d=identicon&r=PG&f=1", "display_name": "Abhinath Kumar", "link": "https://stackoverflow.com/users/4620484/abhinath-kumar"}, "edited": false, "score": 0, "creation_date": 1437577656, "post_id": 31565556, "comment_id": 51089391, "body": "@AbhinathKumar - I have updated the code in my OP.  This now creates two additional columns which stores your dates.  You should be able to take it from here.  Also, for your code, it&#39;s better to put it in your original post, as it doesn&#39;t format down here and you&#39;re limited by character limits."}, {"owner": {"reputation": 5, "user_id": 4620484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/753c96ec8b4f6eca1a9717f427497530?s=128&d=identicon&r=PG&f=1", "display_name": "Abhinath Kumar", "link": "https://stackoverflow.com/users/4620484/abhinath-kumar"}, "edited": false, "score": 0, "creation_date": 1437577846, "post_id": 31565556, "comment_id": 51089548, "body": "Thank you very much @user3578951"}, {"owner": {"reputation": 5, "user_id": 4620484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/753c96ec8b4f6eca1a9717f427497530?s=128&d=identicon&r=PG&f=1", "display_name": "Abhinath Kumar", "link": "https://stackoverflow.com/users/4620484/abhinath-kumar"}, "edited": false, "score": 1, "creation_date": 1437578080, "post_id": 31565556, "comment_id": 51089744, "body": "Very sorry, however the same error is occurring, except this line is highlighted &#39;noColorCells = noColorCells + 1&#39; @user3578951"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1437578198, "post_id": 31565556, "comment_id": 51089846, "body": "How big is your table?  Change the noColorCells to <code>Long</code> instead of <code>Integer</code> too."}, {"owner": {"reputation": 5, "user_id": 4620484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/753c96ec8b4f6eca1a9717f427497530?s=128&d=identicon&r=PG&f=1", "display_name": "Abhinath Kumar", "link": "https://stackoverflow.com/users/4620484/abhinath-kumar"}, "edited": false, "score": 1, "creation_date": 1437579781, "post_id": 31565556, "comment_id": 51091002, "body": "I fixed the other problem, but it now seems to say &#39;&#39;run-time error 1004 Application-defined or object-defined error&#39;&#39; @user3578951"}, {"owner": {"reputation": 5, "user_id": 4620484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/753c96ec8b4f6eca1a9717f427497530?s=128&d=identicon&r=PG&f=1", "display_name": "Abhinath Kumar", "link": "https://stackoverflow.com/users/4620484/abhinath-kumar"}, "edited": false, "score": 1, "creation_date": 1437580039, "post_id": 31565556, "comment_id": 51091194, "body": "Cells(startRow - 1, endCol + 2).Value = &quot;Start Date&quot;   this is highlighted"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1437581350, "post_id": 31565556, "comment_id": 51092132, "body": "If you click &quot;Debug&quot; and hover the mouse over &quot;startRow&quot; and &quot;endCol&quot;, what pops up? It should be a number."}, {"owner": {"reputation": 5, "user_id": 4620484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/753c96ec8b4f6eca1a9717f427497530?s=128&d=identicon&r=PG&f=1", "display_name": "Abhinath Kumar", "link": "https://stackoverflow.com/users/4620484/abhinath-kumar"}, "edited": false, "score": 1, "creation_date": 1437642039, "post_id": 31565556, "comment_id": 51118239, "body": "Yes when I Debug, &quot;startRow&quot; = 4 and &#39;EndCol&#39; = 16384 @BruceWayne"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1437660967, "post_id": 31565556, "comment_id": 51131784, "body": "hm - do you actually have data in cell XFD4?  I have a feeling the code is doing something that doesn&#39;t correctly get the last column number.  From your starting cell in the table (the top left most cell), if you go right are there any gaps, skips, or empty cells until the end of the table?"}, {"owner": {"reputation": 5, "user_id": 4620484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/753c96ec8b4f6eca1a9717f427497530?s=128&d=identicon&r=PG&f=1", "display_name": "Abhinath Kumar", "link": "https://stackoverflow.com/users/4620484/abhinath-kumar"}, "edited": false, "score": 0, "creation_date": 1437726318, "post_id": 31565556, "comment_id": 51161636, "body": "Nope, no data in XFD, a the moment data only goes up to the x column, and the rows that I need to detect start from column D @BruceWayne"}, {"owner": {"reputation": 5, "user_id": 4620484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/753c96ec8b4f6eca1a9717f427497530?s=128&d=identicon&r=PG&f=1", "display_name": "Abhinath Kumar", "link": "https://stackoverflow.com/users/4620484/abhinath-kumar"}, "edited": false, "score": 0, "creation_date": 1437726636, "post_id": 31565556, "comment_id": 51161805, "body": "is there any other way I could send you an image of my table, Maybe an e-mail or something as this is very important"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1437745923, "post_id": 31565556, "comment_id": 51174242, "body": "You can upload it to imgur.com and put a link here."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1438092422, "post_id": 31565556, "comment_id": 51299119, "body": "Is your sheet ALWAYS going to look like that (i.e. headers start in B1, and rows start in A2)?  If so, use this for <code>endCol</code>: <code>endCol = .Cells(1,2).End(xlToRight).Column</code> . This will start in B1, then go all the way to the right until a gap in the headers, which would typically be the last of your table headers."}, {"owner": {"reputation": 5, "user_id": 4620484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/753c96ec8b4f6eca1a9717f427497530?s=128&d=identicon&r=PG&f=1", "display_name": "Abhinath Kumar", "link": "https://stackoverflow.com/users/4620484/abhinath-kumar"}, "edited": false, "score": 0, "creation_date": 1438163586, "post_id": 31565556, "comment_id": 51333679, "body": "yes it does, the code ran with no problems and it said done, however no data was outputted (i.e the start date and end date), now when I run it a second time it says &#39;&#39;runtime error 6 overflow&#39;&#39;, and highlights &#39; nocolourcells = nocolourcells + 1&#39;&#39; @BruceWayne"}, {"owner": {"reputation": 5, "user_id": 4620484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/753c96ec8b4f6eca1a9717f427497530?s=128&d=identicon&r=PG&f=1", "display_name": "Abhinath Kumar", "link": "https://stackoverflow.com/users/4620484/abhinath-kumar"}, "edited": false, "score": 0, "creation_date": 1438163638, "post_id": 31565556, "comment_id": 51333708, "body": "could you try recreating the same table on your computer and try and run the code and locate the problem please, because a new error pops up everytime when I run it?....thanks @BruceWayne"}, {"owner": {"reputation": 5, "user_id": 4620484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/753c96ec8b4f6eca1a9717f427497530?s=128&d=identicon&r=PG&f=1", "display_name": "Abhinath Kumar", "link": "https://stackoverflow.com/users/4620484/abhinath-kumar"}, "edited": false, "score": 0, "creation_date": 1438164037, "post_id": 31565556, "comment_id": 51333973, "body": "sorry ...this line is highlighted now, &#39;&#39; For k = startRow To endRow&#39;&#39; @BruceWayne"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1438178532, "post_id": 31565556, "comment_id": 51344079, "body": "What error occurs when it stops there? Hover the mouse over <code>startRow</code> and <code>endRow</code>. There should be integers that pop up for you showing the values of those two Variables."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1438179149, "post_id": 31565556, "comment_id": 51344544, "body": "Do you have data in those blank yellow cells? Or is it literally just a blank table with highlighted cells?"}, {"owner": {"reputation": 5, "user_id": 4620484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/753c96ec8b4f6eca1a9717f427497530?s=128&d=identicon&r=PG&f=1", "display_name": "Abhinath Kumar", "link": "https://stackoverflow.com/users/4620484/abhinath-kumar"}, "edited": false, "score": 0, "creation_date": 1438180977, "post_id": 31565556, "comment_id": 51345993, "body": "starttrow = 4.....endrow = 1048576, and no the  cells have no data in them @BruceWayne"}, {"owner": {"reputation": 5, "user_id": 4620484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/753c96ec8b4f6eca1a9717f427497530?s=128&d=identicon&r=PG&f=1", "display_name": "Abhinath Kumar", "link": "https://stackoverflow.com/users/4620484/abhinath-kumar"}, "edited": false, "score": 0, "creation_date": 1438181021, "post_id": 31565556, "comment_id": 51346042, "body": "If I close excel and restart it..on the first attempt the code runs with no errors but start date and end date are not displayed...However on the second attempt errors occur"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1438182620, "post_id": 31565556, "comment_id": 51347269, "body": "I added some newer code, that should work even without data in your table. I think that&#39;s what was giving you grief on the start and endrow for sure.  Let me know how it works.  Also, was it the columns you wanted? I have it currently returning the index (number) of the column.  If you need Letter, let me know."}, {"owner": {"reputation": 5, "user_id": 4620484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/753c96ec8b4f6eca1a9717f427497530?s=128&d=identicon&r=PG&f=1", "display_name": "Abhinath Kumar", "link": "https://stackoverflow.com/users/4620484/abhinath-kumar"}, "edited": false, "score": 0, "creation_date": 1438184532, "post_id": 31565556, "comment_id": 51348778, "body": "Yeah It worked great!!!!....however you are right I wanted it to return the column header (Start Date)  which the colour starts and the column header(End Date), which the colour ends for each row(person name), but you can just do the first row and ill do the rest....thank you so much @BruceWayne"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 5, "user_id": 4620484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/753c96ec8b4f6eca1a9717f427497530?s=128&d=identicon&r=PG&f=1", "display_name": "Abhinath Kumar", "link": "https://stackoverflow.com/users/4620484/abhinath-kumar"}, "edited": false, "score": 0, "creation_date": 1438184896, "post_id": 31565556, "comment_id": 51349037, "body": "@AbhinathKumar - so instead of the columns themselves (&quot;A&quot;, &quot;B&quot;, etc.) you want to know the dates where the color starts and end? So in your <a href=\"http://imgur.com/qs2rizV\" rel=\"nofollow noreferrer\">image you linked to</a>, for row 3, you&#39;d want to just output something like &quot;02/01/2015 to 09/01/2015&quot;?"}, {"owner": {"reputation": 5, "user_id": 4620484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/753c96ec8b4f6eca1a9717f427497530?s=128&d=identicon&r=PG&f=1", "display_name": "Abhinath Kumar", "link": "https://stackoverflow.com/users/4620484/abhinath-kumar"}, "edited": false, "score": 0, "creation_date": 1438185006, "post_id": 31565556, "comment_id": 51349116, "body": "So, yeah only 2 values(Start Date &amp; end Date) need to be returned, not all columns containing the colour"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 5, "user_id": 4620484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/753c96ec8b4f6eca1a9717f427497530?s=128&d=identicon&r=PG&f=1", "display_name": "Abhinath Kumar", "link": "https://stackoverflow.com/users/4620484/abhinath-kumar"}, "edited": false, "score": 0, "creation_date": 1438188520, "post_id": 31565556, "comment_id": 51351292, "body": "@AbhinathKumar - I updated the second code again, now it&#39;ll place the start and end date in columns B and C for each person."}, {"owner": {"reputation": 5, "user_id": 4620484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/753c96ec8b4f6eca1a9717f427497530?s=128&d=identicon&r=PG&f=1", "display_name": "Abhinath Kumar", "link": "https://stackoverflow.com/users/4620484/abhinath-kumar"}, "edited": false, "score": 0, "creation_date": 1438243742, "post_id": 31565556, "comment_id": 51373812, "body": "Thank you so much!!!, worked perfectly, I can now apply this to a simulation model, Thanks again for the hard work @BruceWayne"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 5, "user_id": 4620484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/753c96ec8b4f6eca1a9717f427497530?s=128&d=identicon&r=PG&f=1", "display_name": "Abhinath Kumar", "link": "https://stackoverflow.com/users/4620484/abhinath-kumar"}, "edited": false, "score": 0, "creation_date": 1438265603, "post_id": 31565556, "comment_id": 51388401, "body": "@AbhinathKumar - Yay! I&#39;m glad we were able to solve the issue.  More than happy to help!"}], "tags": [], "owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "is_accepted": true, "score": 0, "last_activity_date": 1438188490, "last_edit_date": 1438188490, "creation_date": 1437574138, "answer_id": 31565556, "question_id": 31565028, "link": "https://stackoverflow.com/questions/31565028/excel-vba-finding-the-beginning-and-end-of-coloured-rows/31565556#31565556", "title": "Excel VBA - Finding the beginning and end of coloured rows", "body": "<p>How's this?</p>\n\n<pre><code>Sub findColoredRows()\nDim startCol As Integer, endCol As Integer, o As Integer\nDim ws            As Worksheet\nDim i As Integer, k As Integer\nDim startRow As Long, endRow As Long\nDim cellColor As String, noColor As String\nDim cel           As Range\n\nnoColor = -4142              ' this is the color index of NO coloring\n\nk = 3\n\nSet ws = ActiveSheet\nWith ws\n    startRow = .Cells(1, 3).End(xlDown).Row\n    startCol = .Cells(1, 3).Column\n    Do While startRow &gt; 100  ' I assume your table starts before row 100.  So, if there's no data before row 100, check next column\n        k = k + 1\n        startRow = .Cells(1, k).End(xlDown).Row\n        startCol = k\n    Loop\n\n    'Now, we have our starting row - get end row.\n    endRow = .Cells(startRow, k).End(xlDown).Row\n\n    endCol = .Cells(startRow, startCol).End(xlToRight).Column\n    Debug.Print \"Start row: \" &amp; startRow &amp; \", start column: \" &amp; startCol\n\n    ' How many non colored cells is there in our range?\n    Dim noColorCells As Integer\n    For Each cel In .Range(.Cells(startRow, startCol), .Cells(endRow, endCol))\n        If cel.Interior.ColorIndex = noColor Then\n            noColorCells = noColorCells + 1\n        End If\n    Next cel\n    Debug.Print \"There are \" &amp; noColorCells &amp; \" non colored cells.\"\n\n    .Cells(startRow - 1, endCol + 2).Value = \"Start Date\"\n    .Cells(startRow - 1, endCol + 3).Value = \"End Date\"\n\n    'reDim the array to fit the colored cells\n    ReDim tDates(1 To noColorCells + 1)\n    i = 1                    'index starts at 1, so set this to 1\n\n    For k = startRow To endRow\n        For o = startCol To endCol\n            If .Cells(k, o).Interior.ColorIndex = noColor And .Cells(k, endCol + 2) = \"\" Then\n                .Cells(k, endCol + 2).Value = .Cells(k, o).Value\n            ElseIf .Cells(k, o).Interior.ColorIndex = noColor And .Cells(k, endCol + 2) Then\n                i = i + i\n                .Cells(k, endCol + 3).Value = .Cells(k, o).Value\n            End If\n            ' i = i + 1\n        Next o\n\n        i = i + 1\n    Next k\n\nEnd With\n\nMsgBox (\"Done!\")\n\nEnd Sub\n</code></pre>\n\n<p>This sub will find the addresses of any colored cells.  If you can explain more what you mean by \"locate the beginning and the end of coloured rows in a table.\" I can tweak this.  Can you post an image of a sample table maybe? </p>\n\n<p>Edit: Per discussion below, try this in case there's not always data in the table, but you want the columns of the colored cells:</p>\n\n<pre><code>Sub findColoredBGCells()\nDim startRow As Integer, endRow As Integer, i As Integer, k As Integer, startCol As Integer, endCol As Integer\nDim cellColor As String, noColor As String\nDim ws As Worksheet\n\nSet ws = ActiveSheet\nnoColor = -4142\n\nWith ws\n    'Get the starting row\n    startRow = .Cells(1, 1).End(xlDown).Row\n    endRow = .Cells(startRow, 1).End(xlDown).Row\n\n    ' Since we know where the names start and end (less ONE for the \"Names\" part), let's count how many names we have\n    Dim noNames As Integer\n    noNames = endRow - startRow\n    If Not IsEmpty(.Cells(1, 1)) Then ' Get the first used column with data\n        startCol = 1\n    ElseIf IsEmpty(.Cells(1, 1)) Then\n        startCol = .Cells(1, 1).End(xlToRight).Column\n    End If\n\n    endCol = .Cells(1, startCol).End(xlToRight).Column\n\n    'Now we have our range, let's use it to loop for blank cells, and add those to an array\n    Dim coloredCells() As Variant\n    ReDim coloredCells(1 To noNames, 2)\n    Dim rng As Range, cel As Range\n    Set rng = .Range(.Cells(startRow, startCol), .Cells(endRow, endCol))\n    'rng.Select\n\n    'Now, count how many cells are not blank background\n    Dim cnt As Integer, celRow As Integer, lastCelRow As Integer\n    i = 1\n\n    lastCelRow = 2\n    For Each cel In rng\n        cel.Select\n        celRow = cel.Row\n        If cel.Row &lt;&gt; lastCelRow Then 'This is so we can change the first dimension in the array\n            k = k + 1\n            coloredCells(k, 0) = .Cells(cel.Row, 1).Value\n            i = 1\n           ' i = i + 1\n        End If\n\n        If cel.Interior.ColorIndex &lt;&gt; noColor Then\n            cnt = cnt + 1\n            If i &gt; 2 Then i = 2 'Since it's only two dimensions we need, only go up to '1'\n           ' ReDim Preserve coloredCells(noNames, i) 'resize the array to hold the new column\n            coloredCells(k, i) = .Cells(1, cel.Column).Value\n            i = i + 1\n        End If\n        lastCelRow = celRow\n    Next cel\n\nFor k = 1 To UBound(coloredCells)\n        Debug.Print coloredCells(k, 0) &amp; \" Start Date: \" &amp; coloredCells(k, 1) &amp; \", end date: \" &amp; coloredCells(k, 2) &amp; \".\"\n        .Cells(2 + k, 2).Value = coloredCells(k, 1)\n        .Cells(2 + k, 3).Value = coloredCells(k, 2)\nNext k\n\nEnd With\n\nMsgBox (\"Done!\")\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 5, "user_id": 4620484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/753c96ec8b4f6eca1a9717f427497530?s=128&d=identicon&r=PG&f=1", "display_name": "Abhinath Kumar", "link": "https://stackoverflow.com/users/4620484/abhinath-kumar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 543, "favorite_count": 0, "accepted_answer_id": 31565556, "answer_count": 1, "score": -3, "last_activity_date": 1438260344, "creation_date": 1437572816, "last_edit_date": 1438260344, "question_id": 31565028, "link": "https://stackoverflow.com/questions/31565028/excel-vba-finding-the-beginning-and-end-of-coloured-rows", "title": "Excel VBA - Finding the beginning and end of coloured rows", "body": "<p>I am trying to create a code in Excel VBA, to locate the <strong>beginning</strong> (Cell Address) and the <strong>end</strong> (Cell Address) of coloured rows in a table. The table is a timeline(Horizontal axis- Dates, Vertical axis - General Text). The coloured rows all do not start in the first column, but start in different columns. \nAny help?</p>\n"}, {"tags": ["vba", "ms-access-2010", "recordset", "attachment-field"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2140173"}, "edited": false, "score": 0, "creation_date": 1437573242, "post_id": 31564853, "comment_id": 51085738, "body": "have you seen <a href=\"http://stackoverflow.com/a/25554406/2140173\">THIS</a>? I am not quite sure it will work with the attachments but its worth testing yourself"}, {"owner": {"reputation": 1923, "user_id": 3143339, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04c9eddec9e044b2b10e27b1cc089e88?s=128&d=identicon&r=PG&f=1", "display_name": "donPablo", "link": "https://stackoverflow.com/users/3143339/donpablo"}, "edited": false, "score": 0, "creation_date": 1538085748, "post_id": 31564853, "comment_id": 92031275, "body": "Which line of code??  Gives what Error message?"}], "owner": {"reputation": 11, "user_id": 5143852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b2f58a0dc21d349b21b0bc438a55f47?s=128&d=identicon&r=PG&f=1", "display_name": "killo watt", "link": "https://stackoverflow.com/users/5143852/killo-watt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 82, "favorite_count": 1, "answer_count": 0, "score": 1, "last_activity_date": 1538080259, "creation_date": 1437572407, "last_edit_date": 1538080259, "question_id": 31564853, "link": "https://stackoverflow.com/questions/31564853/clone-a-recordset-which-has-some-attachments", "title": "clone a recordset which has some attachments", "body": "<p>I wanted to copy a recordset to an another.</p>\n\n<p>I found this code: </p>\n\n<pre><code>Do While Not rs(1).EOF\n    ' You can place if condition here\n    rs(2).AddNew\n    For i = 0 To rs(1).Fields.Count - 1\n        rs(2).Fields(rs(1).Fields(i).name) = rs(1).Fields(i).Value\n    Next i\n    rs(2).update\n    rs(1).MoveNext\nLoop\n</code></pre>\n\n<p>It works, but the problem is that I have some attachments fields in my recordsets and the loop block on them.  Does anybody have a solution? </p>\n"}, {"tags": ["vba", "function", "return-value"], "answers": [{"comments": [{"owner": {"reputation": 131, "user_id": 645414, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b4d59710744648bd74c3ef7e117e6d2?s=128&d=identicon&r=PG", "display_name": "Tom the Toolman", "link": "https://stackoverflow.com/users/645414/tom-the-toolman"}, "edited": false, "score": 9, "creation_date": 1585230506, "post_id": 31565054, "comment_id": 107692799, "body": "This explanation is not correct. As coded, getStats is a function that takes no arguments and returns a variant, which may be an array but could just as well be an integer, a string, etc."}], "tags": [], "owner": {"reputation": 2324, "user_id": 5094258, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/n4upu.png?s=128&g=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/5094258/tim"}, "is_accepted": true, "score": 8, "last_activity_date": 1437572879, "creation_date": 1437572879, "answer_id": 31565054, "question_id": 31564846, "link": "https://stackoverflow.com/questions/31564846/return-array-from-function-in-vba/31565054#31565054", "title": "return array from function in VBA", "body": "<pre><code>Function getStats() As Variant\n</code></pre>\n\n<p>getStats is now an Array and not an Integer</p>\n"}, {"comments": [{"owner": {"reputation": 141, "user_id": 2606742, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/a32777abeb51c4fcd15537e5c18c3df1?s=128&d=identicon&r=PG", "display_name": "hansa", "link": "https://stackoverflow.com/users/2606742/hansa"}, "edited": false, "score": 6, "creation_date": 1529418085, "post_id": 31565124, "comment_id": 88860349, "body": "Are both answers robust in their use? Or is one preferred over the other/do they have differing properties that lead to certain use cases in which one may be advantageous or disadavantageous?"}, {"owner": {"reputation": 1407, "user_id": 5835002, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/mnMDz.jpg?s=128&g=1", "display_name": "SendETHToThisAddress", "link": "https://stackoverflow.com/users/5835002/sendethtothisaddress"}, "edited": false, "score": 0, "creation_date": 1612392907, "post_id": 31565124, "comment_id": 116756686, "body": "This code originally did not work. 10 days after I posted my answer this code was modified based on working code from my answer."}], "tags": [], "owner": {"reputation": 4085, "user_id": 4185106, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/er5li.png?s=128&g=1", "display_name": "moffeltje", "link": "https://stackoverflow.com/users/4185106/moffeltje"}, "is_accepted": false, "score": 43, "last_activity_date": 1588145769, "last_edit_date": 1588145769, "creation_date": 1437573046, "answer_id": 31565124, "question_id": 31564846, "link": "https://stackoverflow.com/questions/31564846/return-array-from-function-in-vba/31565124#31565124", "title": "return array from function in VBA", "body": "<p>Give the function the type as an array:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>function getStats() as Integer()    \n    dim returnVal(0 to 3) as integer\n\n    returnVal(0) = c2percent14\n    returnVal(1) = c3percent14\n    returnVal(2) = c4percent14\n    returnVal(3) = c5percent14\n\n    getStats = returnVal\nend function\n\nSub mysub()\n   Dim myArray() As Integer\n\n   myArray = getStats()\n\n   msgbox myArray(3)\nend sub \n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1588147243, "post_id": 61299944, "comment_id": 108784743, "body": "<code>Any attempt to ReDim getStats as an array will also throw an error</code> - not really. True, you cannot assign <code>getStats(2) = 1</code> from inside of <code>getStats</code>, but that&#39;s only because the compiler confuses it with recursively calling <code>getStats</code> (even though the arguments don&#39;t match). But you can do <code>Redim getStats(2)</code>, and you then can pass <code>getStats</code> to some other function that accepts an integer array. So the name variable works, it&#39;s just you can&#39;t access its elements directly."}, {"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1588147375, "post_id": 61299944, "comment_id": 108784810, "body": "<code>The temp array has to be declared with length</code> - not really either; it has to have a length at the point of accessing its elements, but it doesn&#39;t have to be a <i>fixed</i> array (whose length cannot be changed). So you can declare <code>Dim returnVal() As Integer</code>, you just need to <code>ReDim returnVal(2)</code> before assigning the elements."}, {"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1588147604, "post_id": 61299944, "comment_id": 108784932, "body": "<code>Remember that an array declared (2) will hold 3 values, 0-2</code> - the default array lower bound is controlled with <a href=\"https://docs.microsoft.com/en-us/office/vba/language/reference/user-interface-help/option-base-statement\" rel=\"nofollow noreferrer\"><code>Option Base</code></a> which can be either 0 or 1, so a <code>(2)</code> array may contain two or three elements. I&#39;ve always preferred to explicitly list the boundaries for this reason, <code>Dim returnVal(0 To 2)</code>, or <code>Dim returnVal(11 To 42)</code>."}, {"owner": {"reputation": 1407, "user_id": 5835002, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/mnMDz.jpg?s=128&g=1", "display_name": "SendETHToThisAddress", "link": "https://stackoverflow.com/users/5835002/sendethtothisaddress"}, "reply_to_user": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1588147811, "post_id": 61299944, "comment_id": 108785029, "body": "@GSerg on your first comment that&#39;s what I meant, you can&#39;t assign values directly to the function name like you could with a function that returns a Boolean or String. On your second comment yes that&#39;s what I meant is you have to declare the length at some point, so might as well do it at the variable declaration right?"}, {"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 1, "creation_date": 1588148124, "post_id": 61299944, "comment_id": 108785186, "body": "<code>you have to declare the length at some point, so might as well do it at the variable declaration right?</code> - the side effects differ, which may or may not matter. <code>Dim returnVal(2)</code> creates an array that cannot be resized. If you need to adjust it in your function later, you can&#39;t. <code>Dim returnVal() : ReDim returnVal(2)</code> creates an array that can be resized. It does not matter after returning the array, because then it can be resized anyway."}], "tags": [], "owner": {"reputation": 1407, "user_id": 5835002, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/mnMDz.jpg?s=128&g=1", "display_name": "SendETHToThisAddress", "link": "https://stackoverflow.com/users/5835002/sendethtothisaddress"}, "is_accepted": false, "score": 4, "last_activity_date": 1587273945, "creation_date": 1587273945, "answer_id": 61299944, "question_id": 31564846, "link": "https://stackoverflow.com/questions/31564846/return-array-from-function-in-vba/61299944#61299944", "title": "return array from function in VBA", "body": "<p>I'm going to add an answer here because I'm happy to say, after hours of frustration and bad information, I finally know how to return arrays! Here is how you return an array from a function:</p>\n\n<pre><code>Sub mysub()\n    Dim i As Integer, s As String\n    Dim myArray() As Integer 'if you declare a size here you will get \"Compile error, can't assign to array\"\n    myArray = getStats()\n\n    s = \"Array values returned:\" &amp; vbCrLf\n    For i = 0 To UBound(myArray)\n        s = (s &amp; myArray(i) &amp; \" \")\n    Next\n    MsgBox s\nEnd Sub\n\nFunction getStats() As Integer() 'The return type must be EXACTLY the same as the type declared in the calling sub.\n    Dim returnVal(2) As Integer 'if you DON'T declare a size here you will get \"Run-time error '9': Subscript out of range\"\n\n    returnVal(0) = 0\n    returnVal(1) = 1\n    returnVal(2) = 2\n    'returnVal(3) = 3 This will throw an error. Remember that an array declared (2) will hold 3 values, 0-2.\n    getStats = returnVal\nEnd Function\n</code></pre>\n\n<p>Output:\n<a href=\"https://i.stack.imgur.com/rOTmq.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/rOTmq.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>The comments I included here are very important. Although VBA is usually pretty lax, this particular thing is very picky. These are required for your function, assignment, and return to work:</p>\n\n<ul>\n<li>The array declared in the calling sub has to be of undeclared length.</li>\n<li>The function that returns an array has to be of EXACTLY same type. Even if you declare the array in the sub as a Variant and the function returns an Integer array that will not work either.</li>\n<li>You have to use a temporary array in the function. You cannot assign values to the function name (getStats) like you normally would in a function; you can only assign the temporary array to the function name once you have assigned all the values to the temp array. Any attempt to ReDim getStats as an array will also throw an error.</li>\n<li>The temp array has to be declared with length. In VBA you cannot assign values to an array at an index until you declare the length.</li>\n</ul>\n"}], "owner": {"reputation": 1566, "user_id": 682355, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/59191ba50eff53600102e0bbb74c75ba?s=128&d=identicon&r=PG", "display_name": "Rik", "link": "https://stackoverflow.com/users/682355/rik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 90510, "favorite_count": 1, "accepted_answer_id": 31565054, "answer_count": 3, "score": 19, "last_activity_date": 1588145769, "creation_date": 1437572379, "last_edit_date": 1526550922, "question_id": 31564846, "link": "https://stackoverflow.com/questions/31564846/return-array-from-function-in-vba", "title": "return array from function in VBA", "body": "<p>All,</p>\n\n<p>I would like to write a function to return an array of integers so I can index them, but I am not aware of the syntax for VBA. Here is the pseudo code:</p>\n\n<pre><code>function getStats() as integer\n    dim returnVal(4) as integer\n    returnVal(0)=c2percent14\n    returnVal(1)=c3percent14\n    returnVal(2)=c4percent14\n    returnVal(3)=c5percent14\n    getStats=returnVal\nend function\n\nmsgbox getStats(3)\n</code></pre>\n\n<p>where these values are all integers, or should be, and then I can index the return array for the stat that I want. Thanks.</p>\n\n<p>-Rik</p>\n"}, {"tags": ["ms-access", "vba"], "answers": [{"comments": [{"owner": {"reputation": 4022, "user_id": 4413676, "user_type": "registered", "accept_rate": 70, "profile_image": "https://lh6.googleusercontent.com/-voVpW4gy9dA/AAAAAAAAAAI/AAAAAAAACqY/6b-0Iza8ws8/photo.jpg?sz=128", "display_name": "HarveyFrench", "link": "https://stackoverflow.com/users/4413676/harveyfrench"}, "edited": false, "score": 0, "creation_date": 1437595633, "post_id": 31566215, "comment_id": 51100782, "body": "Thanks. I suspected as much but I&#39;ve never used the properties collection before.  Have you any idea why is is not listed on the MSDN helppages?  Are there other properties like this that can be access in the properteis collection that are not on the MSDN help pages?"}, {"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "reply_to_user": {"reputation": 4022, "user_id": 4413676, "user_type": "registered", "accept_rate": 70, "profile_image": "https://lh6.googleusercontent.com/-voVpW4gy9dA/AAAAAAAAAAI/AAAAAAAACqY/6b-0Iza8ws8/photo.jpg?sz=128", "display_name": "HarveyFrench", "link": "https://stackoverflow.com/users/4413676/harveyfrench"}, "edited": false, "score": 0, "creation_date": 1437595896, "post_id": 31566215, "comment_id": 51100934, "body": "No idea why it&#39;s not listed.  I never paid attention to <i>ShowPageHeaderAndPageFooter</i> until I saw your question.  I&#39;m not sure about other properties.  If you want to investigate, you can list the names of all the properties in the subform control&#39;s <code>Properties</code> collection with this as one line in the Immediate window: <code>for each prp in forms!YourForm!YourSubformControl.Properties : ? prp.name : next</code>  That is what I used to find <i>ShowPageHeaderAndPageFooter</i>."}, {"owner": {"reputation": 4022, "user_id": 4413676, "user_type": "registered", "accept_rate": 70, "profile_image": "https://lh6.googleusercontent.com/-voVpW4gy9dA/AAAAAAAAAAI/AAAAAAAACqY/6b-0Iza8ws8/photo.jpg?sz=128", "display_name": "HarveyFrench", "link": "https://stackoverflow.com/users/4413676/harveyfrench"}, "edited": false, "score": 1, "creation_date": 1437606321, "post_id": 31566215, "comment_id": 51105825, "body": "I though you might say that... I think MS should be paying someone to find  all their missing documentation for them!    That might be a long list!   Thanks for your help."}], "tags": [], "owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "is_accepted": true, "score": 2, "last_activity_date": 1437575618, "creation_date": 1437575618, "answer_id": 31566215, "question_id": 31564684, "link": "https://stackoverflow.com/questions/31564684/can-the-access-subform-control-property-show-page-header-and-page-footer-be-se/31566215#31566215", "title": "Can the Access Subform control property &quot;show page header and page footer&quot; be set using VBA", "body": "<p>The name of that property is <em>ShowPageHeaderAndPageFooter</em>.  In order to access its value, you must reference it via the subform control's <code>Properties</code> collection:</p>\n\n\n\n<pre class=\"lang-vb prettyprint-override\"><code>? Forms!Form2!Child0.Properties(\"ShowPageHeaderAndPageFooter\").Value\nFalse\n</code></pre>\n\n<p>However, if you want to change that property value, the form must be open in Design View:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>DoCmd.OpenForm \"Form2\", acDesign\nForms!Form2!Child0.Properties(\"ShowPageHeaderAndPageFooter\").Value = True\n? Forms!Form2!Child0.Properties(\"ShowPageHeaderAndPageFooter\").Value\nTrue\n</code></pre>\n\n<p>If you attempt to alter its value when the form is not in Design View, Access throws error #2136, <em>\"To set this property, open the form or report in Design view.\"</em></p>\n"}], "owner": {"reputation": 4022, "user_id": 4413676, "user_type": "registered", "accept_rate": 70, "profile_image": "https://lh6.googleusercontent.com/-voVpW4gy9dA/AAAAAAAAAAI/AAAAAAAACqY/6b-0Iza8ws8/photo.jpg?sz=128", "display_name": "HarveyFrench", "link": "https://stackoverflow.com/users/4413676/harveyfrench"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 352, "favorite_count": 0, "accepted_answer_id": 31566215, "answer_count": 1, "score": 2, "last_activity_date": 1437575775, "creation_date": 1437571997, "last_edit_date": 1437575775, "question_id": 31564684, "link": "https://stackoverflow.com/questions/31564684/can-the-access-subform-control-property-show-page-header-and-page-footer-be-se", "title": "Can the Access Subform control property &quot;show page header and page footer&quot; be set using VBA", "body": "<p>The \"show page header and page footer\" property appears in the properties panel but I can't find it on the MSDN help pages: <a href=\"https://msdn.microsoft.com/en-us/library/office/ff821725.aspx\" rel=\"nofollow\">SubForm.Properties</a></p>\n\n<p>How can I set the value of this property using VBA?</p>\n"}, {"tags": ["vba", "excel", "hyperlink"], "comments": [{"owner": {"reputation": 2282, "user_id": 3704475, "user_type": "registered", "accept_rate": 96, "profile_image": "https://lh6.googleusercontent.com/-F8g5oQDP6i4/AAAAAAAAAAI/AAAAAAAABys/zMyix6hW-5s/photo.jpg?sz=128", "display_name": "Amen Jlili", "link": "https://stackoverflow.com/users/3704475/amen-jlili"}, "edited": false, "score": 0, "creation_date": 1437571853, "post_id": 31564495, "comment_id": 51084670, "body": "I suggest looking at the <code>worksheet_changed</code> event and adding instructions to tell VBA to activate X sheet once its name is selected from your contents sheet."}, {"owner": {"reputation": 3108, "user_id": 5040941, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/291199b5e862bf2befb8ee158c6e544e?s=128&d=identicon&r=PG&f=1", "display_name": "3-14159265358979323846264", "link": "https://stackoverflow.com/users/5040941/3-14159265358979323846264"}, "reply_to_user": {"reputation": 2282, "user_id": 3704475, "user_type": "registered", "accept_rate": 96, "profile_image": "https://lh6.googleusercontent.com/-F8g5oQDP6i4/AAAAAAAAAAI/AAAAAAAABys/zMyix6hW-5s/photo.jpg?sz=128", "display_name": "Amen Jlili", "link": "https://stackoverflow.com/users/3704475/amen-jlili"}, "edited": false, "score": 0, "creation_date": 1437573056, "post_id": 31564495, "comment_id": 51085589, "body": "@Jelly I think the OP is actually asking about adding hyperlinks to his contents sheet that will allow him to navigate to all the named sheets."}], "answers": [{"comments": [{"owner": {"reputation": 83, "user_id": 4730286, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f7d8a2266957c5eca74232e1520dc93e?s=128&d=identicon&r=PG&f=1", "display_name": "davedave1919", "link": "https://stackoverflow.com/users/4730286/davedave1919"}, "edited": false, "score": 0, "creation_date": 1437576115, "post_id": 31564830, "comment_id": 51088186, "body": "I&#39;ve added a line into the For each Ki In ListSh section:   Sheets(&quot;Contents&quot;).Hyperlinks.Add Anchor:=Sheets(&quot;Contents&quot;).Range(&quot;L11&quot;), Address:=&quot;&quot;, SubAddress:= _              ActiveSheet.Name, TextToDisplay:=ActiveSheet.Name  This results in the name of the final worksheet from the list being left as a hyperlink in cell L11, but nothing else. I assume I need to add a loop somewhere but I&#39;m not certain where. Apologies I&#39;m quite new to VBA"}, {"owner": {"reputation": 83, "user_id": 4730286, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f7d8a2266957c5eca74232e1520dc93e?s=128&d=identicon&r=PG&f=1", "display_name": "davedave1919", "link": "https://stackoverflow.com/users/4730286/davedave1919"}, "edited": false, "score": 0, "creation_date": 1437579204, "post_id": 31564830, "comment_id": 51090599, "body": "For some reason that doesn&#39;t appear to be adding anything at all, apologies once again."}, {"owner": {"reputation": 3108, "user_id": 5040941, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/291199b5e862bf2befb8ee158c6e544e?s=128&d=identicon&r=PG&f=1", "display_name": "3-14159265358979323846264", "link": "https://stackoverflow.com/users/5040941/3-14159265358979323846264"}, "reply_to_user": {"reputation": 83, "user_id": 4730286, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f7d8a2266957c5eca74232e1520dc93e?s=128&d=identicon&r=PG&f=1", "display_name": "davedave1919", "link": "https://stackoverflow.com/users/4730286/davedave1919"}, "edited": false, "score": 0, "creation_date": 1437579467, "post_id": 31564830, "comment_id": 51090774, "body": "Can you update you question with the code you are using now ... it will be easier to fix if I can see exactly what you are doing."}], "tags": [], "owner": {"reputation": 3108, "user_id": 5040941, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/291199b5e862bf2befb8ee158c6e544e?s=128&d=identicon&r=PG&f=1", "display_name": "3-14159265358979323846264", "link": "https://stackoverflow.com/users/5040941/3-14159265358979323846264"}, "is_accepted": true, "score": 1, "last_activity_date": 1437585854, "last_edit_date": 1437585854, "creation_date": 1437572345, "answer_id": 31564830, "question_id": 31564495, "link": "https://stackoverflow.com/questions/31564495/vba-to-create-hyperlinks-from-a-list/31564830#31564830", "title": "VBA to create hyperlinks from a list", "body": "<p>You can add hyperlinks in your workbook that refer to other sheets as follows ...</p>\n\n<pre><code>ActiveSheet.Hyperlinks.Add Anchor:=Selection, Address:=\"\", SubAddress:= _\n    \"Sheet2!A1\", TextToDisplay:=\"Sheet2!A1\"\n</code></pre>\n\n<p>So for instance, if you had a sheet called <code>John</code> you would use the following to add a link into cell <code>L8</code> on the <code>Contents</code> sheet...</p>\n\n<pre><code>Sheets(\"Contents\").Hyperlinks.Add Anchor:=Sheets(\"Contents\").Range(\"L8\"), Address:=\"\", SubAddress:= _\n    \"John!A1\", TextToDisplay:=\"John\"\n</code></pre>\n\n<p>You should be able to put a line of code similar to this (obviously without hard coding the <code>SubAddress</code> and <code>TextToDisplay</code> parameters) in the loop that creates the worksheets.</p>\n\n<hr>\n\n<p>You also need to update the <code>Anchor</code> parameter. Let's assume the following loop</p>\n\n<pre><code>Dim iLinkRow as Integer\niLinkRow = 11\nFor Each Ki in ListSh\n    'your code that creates the sheet\n    Sheets(\"Contents\").Hyperlinks.Add Anchor:=Sheets(\"Contents\").Cells(iLinkRow, 8), Address:=\"\", SubAddress:= _ ActiveSheet.Name, TextToDisplay:=ActiveSheet.Name\n    iLinkRow = iLinkRow + 1\nNext Ki\n</code></pre>\n\n<p>Here, I am using <code>Cells(y,x)</code> (rather than <code>Range</code>) which accepts two integers <strong>row,column</strong>. The column number will always be 8 (<code>L</code> is the 8th column) and the row (<code>iLinkRow</code>) will be increased by 1 for each sheet.</p>\n\n<hr>\n\n<p>Update the code as follows ...</p>\n\n<pre><code>On Error Resume Next\niLinkRow = 11\nFor Each Ki In ListSh\nIf Len(Trim(Ki.Value)) &gt; 0 Then\n    If Len(Worksheets(Ki.Value).Name) = 0 Then\n     Worksheets.Add(After:=Worksheets(Worksheets.Count)).Name = Ki.Value\n     ActiveSheet.[a1] = ActiveSheet.Name\n     Sheets(\"Contents\").Hyperlinks.Add Anchor:=Sheets(\"Contents\").Cells(iLinkRow, 8), Address:=ActiveSheet.Name, SubAddress:=ActiveSheet.Name, TextToDisplay:=ActiveSheet.Name\n     iLinkRow = iLinkRow + 1\n</code></pre>\n\n<p>You need to set <code>iLinkRow = 11</code> before the loop starts!</p>\n"}], "owner": {"reputation": 83, "user_id": 4730286, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f7d8a2266957c5eca74232e1520dc93e?s=128&d=identicon&r=PG&f=1", "display_name": "davedave1919", "link": "https://stackoverflow.com/users/4730286/davedave1919"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 983, "favorite_count": 0, "accepted_answer_id": 31564830, "answer_count": 1, "score": 0, "last_activity_date": 1437585854, "creation_date": 1437571491, "last_edit_date": 1437579844, "question_id": 31564495, "link": "https://stackoverflow.com/questions/31564495/vba-to-create-hyperlinks-from-a-list", "title": "VBA to create hyperlinks from a list", "body": "<p>I have the below VBA: </p>\n\n<pre><code>Sub List_creator()\n'\n' List_creator Macro\n' Creates list of Names which will then become tab names\n'\n\n'\nSheets(\"ALL Scheme Derivatives\").Select\nActiveSheet.Range(\"$A$1:$Q$64944\").AutoFilter Field:=9, Criteria1:=Array( _\n    \"A - Mini\", \"B - Supermini\", \"C - Lower Medium\", \"D - Upper Medium\", _\n    \"E - Executive\", \"G - Specialist Sports\", \"H - MPV\", \"I - 4 x 4\", \"Y - LCV\", \"=\"), _\n    Operator:=xlFilterValues\nColumns(\"B:B\").Select\nSelection.SpecialCells(xlCellTypeVisible).Select\nSelection.Copy\nSheets(\"List\").Select\nSheets(\"List\").Name = \"List\"\nRange(\"A1\").Select\nSelection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n    :=False, Transpose:=False\nApplication.CutCopyMode = False\nActiveSheet.Range(\"$A$1:$A$1047980\").RemoveDuplicates Columns:=1, Header:= _\n    xlNo\n\nDim ws As Worksheet\nDim Ki As Range\nDim ListSh As Range\n\nWith Worksheets(\"List\")\n    Set ListSh = .Range(\"A2:A\" &amp; .Cells(.Rows.Count, \"A\").End(xlUp).Row)\nEnd With\n\nOn Error Resume Next\nFor Each Ki In ListSh\n    If Len(Trim(Ki.Value)) &gt; 0 Then\n        If Len(Worksheets(Ki.Value).Name) = 0 Then\n            Worksheets.Add(After:=Worksheets(Worksheets.Count)).Name = Ki.Value\n         ActiveSheet.[a1] = ActiveSheet.Name\n         'Copy from sheet Helper\n        Sheets(\"Helper\").Range(\"A2:K92\").Copy Destination:=ActiveSheet.Range(\"A2\")\n        ' Sets column widths\n        Columns(\"B:C\").ColumnWidth = 10.71\n        Columns(\"D\").ColumnWidth = 70.71\n        Columns(\"E:J\").ColumnWidth = 10.71\n        ' Deletes all rows which aren't needed\n        Dim LR As Long, Found As Range\n        LR = Range(\"C\" &amp; Rows.Count).End(xlUp).Row\n        Set Found = Columns(\"C\").Find(what:=\"-\", LookIn:=xlValues, lookat:=xlWhole)\n        If Not Found Is Nothing Then Rows(Found.Row &amp; \":\" &amp; LR).Delete\n        End If\n    End If\nNext Ki\n\n' Return to Manual\n\nSheets(\"MANUAL\").Select\nEnd Sub\n</code></pre>\n\n<p>This creates a list of names (removing any duplicates) and then for each name in the list, a new worksheet is added to the workbook. These new worksheets have the exact name as it would appear in the aforementioned created list. Is there a way in which I could then create a hyperlink to each of these created worksheets on a separate worksheet named \"Contents\" (starting in cell L8, having one hyperlink per row).</p>\n\n<p>Thanks!</p>\n\n<p>EDIT:</p>\n\n<pre><code>Sub List_creator()\n'\n' List_creator Macro\n' Creates list of Names which will then become tab names\n'\n\n'\nSheets(\"ALL Scheme Derivatives\").Select\nActiveSheet.Range(\"$A$1:$Q$64944\").AutoFilter Field:=9, Criteria1:=Array( _\n    \"A - Mini\", \"B - Supermini\", \"C - Lower Medium\", \"D - Upper Medium\", _\n    \"E - Executive\", \"G - Specialist Sports\", \"H - MPV\", \"I - 4 x 4\", \"Y - LCV\", \"=\"), _\n    Operator:=xlFilterValues\nColumns(\"B:B\").Select\nSelection.SpecialCells(xlCellTypeVisible).Select\nSelection.Copy\nSheets(\"List\").Select\nSheets(\"List\").Name = \"List\"\nRange(\"A1\").Select\nSelection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n    :=False, Transpose:=False\nApplication.CutCopyMode = False\nActiveSheet.Range(\"$A$1:$A$1047980\").RemoveDuplicates Columns:=1, Header:= _\n    xlNo\n\n\nDim ws As Worksheet\nDim Ki As Range\nDim ListSh As Range\nDim iLinkRow As Integer\n\n\nWith Worksheets(\"List\")\n    Set ListSh = .Range(\"A2:A\" &amp; .Cells(.Rows.Count, \"A\").End(xlUp).Row)\nEnd With\n\nOn Error Resume Next\nFor Each Ki In ListSh\n    If Len(Trim(Ki.Value)) &gt; 0 Then\n        If Len(Worksheets(Ki.Value).Name) = 0 Then\n         Worksheets.Add(After:=Worksheets(Worksheets.Count)).Name = Ki.Value\n         ActiveSheet.[a1] = ActiveSheet.Name\n         iLinkRow = 11\n         Sheets(\"Contents\").Hyperlinks.Add Anchor:=Sheets(\"Contents\").Cells(iLinkRow, 8), Address:=ActiveSheet.Name, SubAddress:=ActiveSheet.Name, TextToDisplay:=ActiveSheet.Name\n         iLinkRow = iLinkRow + 1\n        'Copy from sheet Helper\n        Sheets(\"Helper\").Range(\"A2:K92\").Copy Destination:=ActiveSheet.Range(\"A2\")\n        ' Sets column widths\n        Columns(\"B:C\").ColumnWidth = 10.71\n        Columns(\"D\").ColumnWidth = 70.71\n        Columns(\"E:J\").ColumnWidth = 10.71\n        ' Deletes all rows which aren't needed\n        Dim LR As Long, Found As Range\n        LR = Range(\"C\" &amp; Rows.Count).End(xlUp).Row\n        Set Found = Columns(\"C\").Find(what:=\"-\", LookIn:=xlValues, lookat:=xlWhole)\n        If Not Found Is Nothing Then Rows(Found.Row &amp; \":\" &amp; LR).Delete\n        End If\n    End If\nNext Ki\n\n' Return to Manual\n\nSheets(\"MANUAL\").Select\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 6311, "user_id": 5073840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yRIIb.jpg?s=128&g=1", "display_name": "MatthewD", "link": "https://stackoverflow.com/users/5073840/matthewd"}, "edited": false, "score": 0, "creation_date": 1437572669, "post_id": 31564494, "comment_id": 51085287, "body": "This will create a loop. After your textbox updates, you are updating it again which will cause afterupdate to fire again.  When you say it will fail, what error are you getting?"}], "answers": [{"comments": [{"owner": {"reputation": 590, "user_id": 1898502, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/EjCdZ.jpg?s=128&g=1", "display_name": "uranibaba", "link": "https://stackoverflow.com/users/1898502/uranibaba"}, "edited": false, "score": 0, "creation_date": 1437631399, "post_id": 31567334, "comment_id": 51112285, "body": "Thanks! Works perfect, just what I wanted. There was only one problem and that was that I did not know I had to declare mbEventsDisabled at the top of all the code (saying this in case another beginner have the same problem)."}], "tags": [], "owner": {"reputation": 31052, "user_id": 4280, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bc588d9f099467ce6bc6fc68426119aa?s=128&d=identicon&r=PG", "display_name": "Dick Kusleika", "link": "https://stackoverflow.com/users/4280/dick-kusleika"}, "is_accepted": true, "score": 5, "last_activity_date": 1437655348, "last_edit_date": 1437655348, "creation_date": 1437578336, "answer_id": 31567334, "question_id": 31564494, "link": "https://stackoverflow.com/questions/31564494/format-string-from-textbox-to-timevalue-in-excel-vba/31567334#31567334", "title": "Format String from TextBox to TimeValue in Excel VBA", "body": "<p>As @MatthewD commented, you're creating an infinite loop by updating the textbox inside the update event. Eventually VBA quits looping, so it's not quite infinite. You keep getting the current time because you don't <code>Exit Sub</code> prior to your <code>ErrorHandler:</code>. The code under your error handling label gets executed 100% of the time.</p>\n\n<p>If you put <code>Exit Sub</code> on the line above <code>ErrorHandler:</code> then the code below will only get executed if there's an error.</p>\n\n<p>However, I'll propose a different way.</p>\n\n<pre><code>Private mbEventsDisabled As Boolean\n\nPrivate Sub TimeTextBox_AfterUpdate()\n\n    Dim dtTime As Date\n\n    'See if you can convert the text into a time\n    On Error Resume Next\n        dtTime = TimeValue(Me.TimeTextBox.Value)\n    On Error GoTo 0\n\n    'if you can't, the variable will be zero and you set\n    'it to the current time\n    If dtTime = 0 Then dtTime = Now\n\n    'To prevent recursive calling, see if you've disabled events\n    If Not mbEventsDisabled Then\n\n        'disable events so you can update the textbox\n        mbEventsDisabled = True\n\n        'now this line will trigger AfterUpdate again, but it won't\n        'execute this if block because of the variable\n        Me.TimeTextBox.Value = Format(dtTime, \"hh:mm\")\n\n        'now re-enable events\n        mbEventsDisabled = False\n    End If\n\nEnd Sub\n</code></pre>\n\n<p>You can't disable events in a userform with <code>Application.EnableEvents</code>, so you have to do it yourself. I create a module level variable called <code>mbEventsDisabled</code> that will keep track of whether events are enabled (Module level variables are declared in the declarations section of the module, outside of and above any procedures). It's best to name this variable in the negative because a Boolean variable will be False by default and you want disabled=false unless you set it otherwise.</p>\n\n<p>Instead of updating the textbox in the main code and in an error handler, I just only update it in one spot. It makes the code cleaner I think.</p>\n"}], "owner": {"reputation": 590, "user_id": 1898502, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/EjCdZ.jpg?s=128&g=1", "display_name": "uranibaba", "link": "https://stackoverflow.com/users/1898502/uranibaba"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3443, "favorite_count": 0, "accepted_answer_id": 31567334, "answer_count": 1, "score": 2, "last_activity_date": 1437655348, "creation_date": 1437571491, "last_edit_date": 1531161705, "question_id": 31564494, "link": "https://stackoverflow.com/questions/31564494/format-string-from-textbox-to-timevalue-in-excel-vba", "title": "Format String from TextBox to TimeValue in Excel VBA", "body": "<p>I have a TextBox in a UserForm. using the event _AfterUpdate(), I want to update the format to TimeValue, \"hh:mm\" using this code. </p>\n\n<pre><code>Private Sub TimeTextBox_AfterUpdate()\nOn Error GoTo ErrorHandler\n\nWith TimeTextBox\n    .Value = Format(TimeValue(.Value), \"hh:mm\")\nErrorHandler:\n    .Value = Format(TimeValue(Now), \"hh:mm\")\nEnd With\n\nEnd Sub\n</code></pre>\n\n<p>The problem: it will always fail, even if I enter 13:13 in the box. How do I solve this?</p>\n"}, {"tags": ["excel", "vba", "pipe", "named-pipes", "kernel32"], "comments": [{"owner": {"reputation": 1949, "user_id": 1723119, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/8182f3271d9881acad7c1a4d8844ca15?s=128&d=identicon&r=PG", "display_name": "99moorem", "link": "https://stackoverflow.com/users/1723119/99moorem"}, "edited": false, "score": 0, "creation_date": 1437568866, "post_id": 31563379, "comment_id": 51082438, "body": "I take it you have tried stepping through the code? Do you get an error message? Does this help <a href=\"https://support.microsoft.com/en-us/kb/177696\" rel=\"nofollow noreferrer\">support.microsoft.com/en-us/kb/177696</a>"}, {"owner": {"reputation": 4362, "user_id": 3890586, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/uk42f.png?s=128&g=1", "display_name": "AnalystCave.com", "link": "https://stackoverflow.com/users/3890586/analystcave-com"}, "reply_to_user": {"reputation": 1949, "user_id": 1723119, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/8182f3271d9881acad7c1a4d8844ca15?s=128&d=identicon&r=PG", "display_name": "99moorem", "link": "https://stackoverflow.com/users/1723119/99moorem"}, "edited": false, "score": 0, "creation_date": 1437569382, "post_id": 31563379, "comment_id": 51082815, "body": "Yes I have but the code simply hangs on the line above. Yes I am taking the code from the shared link - but the client is created within a separate thread (which I don&#39;t think should make any difference). I would appreciate even a VBS working namedpipe example."}, {"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1437570474, "post_id": 31563379, "comment_id": 51083680, "body": "Concerning ConnectNamedPipe, the documentation says <i>If hNamedPipe was not opened with FILE_FLAG_OVERLAPPED, the function does not return until a client is connected or an error occurs. Successful synchronous operations result in the function returning a nonzero value if a client connects after the function is called.</i> So it seems thec lient doesn&#39;t connect. In the client part you could specify NMPWAIT_NOWAIT (0x00000001) to return immediately and not wait for the pipe."}, {"owner": {"reputation": 4362, "user_id": 3890586, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/uk42f.png?s=128&g=1", "display_name": "AnalystCave.com", "link": "https://stackoverflow.com/users/3890586/analystcave-com"}, "edited": false, "score": 0, "creation_date": 1437573194, "post_id": 31563379, "comment_id": 51085703, "body": "Yes that is my guess that the Client is not connecting for some reason.  I will try to experiment with the flags. But not sure if this will change anything as this is a viable example and should work as is according to my understanding."}, {"owner": {"reputation": 4362, "user_id": 3890586, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/uk42f.png?s=128&g=1", "display_name": "AnalystCave.com", "link": "https://stackoverflow.com/users/3890586/analystcave-com"}, "edited": false, "score": 0, "creation_date": 1437658736, "post_id": 31563379, "comment_id": 51129933, "body": "Unfortunately no luck with changing the flags. The pipe is definitely created but even within a single VBA process I am not able to read / write to the Pipe handle using ReadFile and WriteFile operations. Any ideas?"}], "owner": {"reputation": 4362, "user_id": 3890586, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/uk42f.png?s=128&g=1", "display_name": "AnalystCave.com", "link": "https://stackoverflow.com/users/3890586/analystcave-com"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2788, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1437568578, "creation_date": 1437568578, "question_id": 31563379, "link": "https://stackoverflow.com/questions/31563379/excel-vba-communicating-via-named-pipe", "title": "Excel VBA: Communicating via named pipe", "body": "<p>I am trying to setup communication via a <code>named pipe</code> in VBA unfortunately for some reason it never gets to the line <code>Debug.Print \"Connected</code> in the server, nor does the client connect. Seems like a simple scenario but been trying to get this going for hours.</p>\n\n<h2>Server</h2>\n\n<pre><code>Public Sub Server()\n      Const szPipeName = \"\\\\.\\pipe\\bigtest\"\n      Dim hPipe As Long, readVal As Long, readBytes As Long, sendVal As Long, sentBytes As Long\n      Dim sa As SECURITY_ATTRIBUTES\n\n      'Create the NULL security token for the pipe\n      pSD = GlobalAlloc(GPTR, SECURITY_DESCRIPTOR_MIN_LENGTH)\n      res = InitializeSecurityDescriptor(pSD, SECURITY_DESCRIPTOR_REVISION)\n      res = SetSecurityDescriptorDacl(pSD, -1, 0, 0)\n      sa.nLength = LenB(sa)\n      sa.lpSecurityDescriptor = pSD\n      sa.bInheritHandle = True\n\n      'Create the Named Pipe\n      hPipe = CreateNamedPipe(szPipeName, PIPE_ACCESS_DUPLEX, PIPE_WAIT Or PIPE_TYPE_MESSAGE Or PIPE_READMODE_MESSAGE, 10, 1000, 1000, 10000, sa)\n\n      'Create separate thread as client\n      ID = CreateThread(nil, 0, AddressOf ClientThread, nil, 0, nil)\n\n      Debug.Print \"Created thread: \" &amp; ID\n      Debug.Print \"Connecting named pipe: \" &amp; hPipe\n\n      res = ConnectNamedPipe(hPipe, ByVal 0)\n      'XXXXXXXXXXXXXXXXX NEVER GETS HERE XXXXXXXXXXXXXXXXXXx\n      Debug.Print \"Connected\"\n      'Read/Write data over the pipe\n\n      res = ReadFile(hPipe, readVal, LenB(readVal), readBytes, ByVal 0)\n      Debug.Print \"Read file: \" &amp; readVal\n\n      'res = WriteFile(hPipe, sendVal , LenB(sendVal ), sendBytes, ByVal 0)\n      res = FlushFileBuffers(hPipe)\n      res = DisconnectNamedPipe(hPipe)\n\n      'Close the pipe handle\n      CloseHandle hPipe\n      GlobalFree (pSD)\n\n   End Sub\n</code></pre>\n\n<h2>Client</h2>\n\n<pre><code>Public Sub ClientThread()\n      Const szPipeName As String = \"\\\\.\\pipe\\bigtest\"\n      Dim sentBytes As Long, sendVal As Long, fSuccess As Boolean, readVal As Long, readBytes As Long\n\n      sendVal = 500\n\n      'Give server time to ConnectNamedPipe\n      Sleep 2000\n      Debug.Print \"Connecting to pipe...\"\n      fSuccess= CallNamedPipe(szPipeName, sendVal, LenB(sendVal), readVal, LenB(readVal), readBytes, 5000)\n      'XXXXXXXXXXXXXX NEVER GETS HERE XXXXXXXXXXXXXX\n      Debug.Print \"Successful: \" &amp; fSuccess\n\n      '...\n   End Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2832, "user_id": 1161309, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b27b718aa1e9d3835ef807359666eb34?s=128&d=identicon&r=PG", "display_name": "Raystafarian", "link": "https://stackoverflow.com/users/1161309/raystafarian"}, "edited": false, "score": 0, "creation_date": 1437568572, "post_id": 31563146, "comment_id": 51082223, "body": "Have you tried the <code>.parentfolder</code> property?"}, {"owner": {"reputation": 35, "user_id": 3977872, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/fb9f5f776bd1e777342763bc1a696d93?s=128&d=identicon&r=PG&f=1", "display_name": "nihal idiot", "link": "https://stackoverflow.com/users/3977872/nihal-idiot"}, "reply_to_user": {"reputation": 2832, "user_id": 1161309, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b27b718aa1e9d3835ef807359666eb34?s=128&d=identicon&r=PG", "display_name": "Raystafarian", "link": "https://stackoverflow.com/users/1161309/raystafarian"}, "edited": false, "score": 0, "creation_date": 1437574165, "post_id": 31563146, "comment_id": 51086564, "body": "I haven&#39;t tried .parentfolder property Raystafarian. Can you please tell me how to use it?"}], "answers": [{"comments": [{"owner": {"reputation": 35, "user_id": 3977872, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/fb9f5f776bd1e777342763bc1a696d93?s=128&d=identicon&r=PG&f=1", "display_name": "nihal idiot", "link": "https://stackoverflow.com/users/3977872/nihal-idiot"}, "edited": false, "score": 0, "creation_date": 1437579135, "post_id": 31563589, "comment_id": 51090547, "body": "Paul, I tried to fetch table data from word document from sub-folder. But failing to read that word document. Below is my &quot;Sub OpenFilesInSubFolders(fsoPFolder As Object) &quot; code part."}, {"owner": {"reputation": 35, "user_id": 3977872, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/fb9f5f776bd1e777342763bc1a696d93?s=128&d=identicon&r=PG&f=1", "display_name": "nihal idiot", "link": "https://stackoverflow.com/users/3977872/nihal-idiot"}, "edited": false, "score": 0, "creation_date": 1437579209, "post_id": 31563589, "comment_id": 51090602, "body": "For Each fileDoc In fsoSFolder.Files             If fileDoc.Name Like FileToOpen Then             Set wrdDoc = wrdApp.Documents.Open(fileDoc.Path)             With wrdApp                .ActiveDocument.Tables(1).Select                .Selection.Copy                ThisWorkbook.Worksheets(&quot;Sheet1&quot;).Cells(Rows.Count, &quot;A&quot;).End(xlUp)(2).PasteSpecial xlPasteValues            End With            wrdDoc.Close False            &#39;wrdApp.Quit            End If"}, {"owner": {"reputation": 35, "user_id": 3977872, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/fb9f5f776bd1e777342763bc1a696d93?s=128&d=identicon&r=PG&f=1", "display_name": "nihal idiot", "link": "https://stackoverflow.com/users/3977872/nihal-idiot"}, "edited": false, "score": 0, "creation_date": 1437579226, "post_id": 31563589, "comment_id": 51090612, "body": "(cont) Next fileDoc        Debug.Print fsoSFolder        OpenFilesInSubFolders fsoSFolder      Next fsoSFolder End Sub"}, {"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "reply_to_user": {"reputation": 35, "user_id": 3977872, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/fb9f5f776bd1e777342763bc1a696d93?s=128&d=identicon&r=PG&f=1", "display_name": "nihal idiot", "link": "https://stackoverflow.com/users/3977872/nihal-idiot"}, "edited": false, "score": 0, "creation_date": 1437580498, "post_id": 31563589, "comment_id": 51091548, "body": "You are trying to open the Path. You must use the <code>Name</code> property (possibly prepended by the <code>Path</code> property)."}, {"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "reply_to_user": {"reputation": 35, "user_id": 3977872, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/fb9f5f776bd1e777342763bc1a696d93?s=128&d=identicon&r=PG&f=1", "display_name": "nihal idiot", "link": "https://stackoverflow.com/users/3977872/nihal-idiot"}, "edited": false, "score": 1, "creation_date": 1437582606, "post_id": 31563589, "comment_id": 51092921, "body": "The logic of your <code>OpenFilesInSubFolders</code> is wrong. You never process the first parent directory. I will edit my answer to show you. And you must start using the debugger. You could have caught this error yourself!"}, {"owner": {"reputation": 35, "user_id": 3977872, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/fb9f5f776bd1e777342763bc1a696d93?s=128&d=identicon&r=PG&f=1", "display_name": "nihal idiot", "link": "https://stackoverflow.com/users/3977872/nihal-idiot"}, "edited": false, "score": 0, "creation_date": 1437632723, "post_id": 31563589, "comment_id": 51112848, "body": "after reading all the word documents in a sub-folder, it is reading for a word document starting with &quot;~$......doc&quot; which I don&#39;t have it in my path. So, it is now reading only one sub-folder in my OpenFilesInSubFolders logic. Can you give me the correct one please."}, {"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "reply_to_user": {"reputation": 35, "user_id": 3977872, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/fb9f5f776bd1e777342763bc1a696d93?s=128&d=identicon&r=PG&f=1", "display_name": "nihal idiot", "link": "https://stackoverflow.com/users/3977872/nihal-idiot"}, "edited": false, "score": 1, "creation_date": 1437640402, "post_id": 31563589, "comment_id": 51117191, "body": "Probably a hidden file. If it opens the file, then it is there and meets your filespec.Use a debugger, adapt your FileToOpen, check for a $ sign or whatever. I am not your code monkey."}], "tags": [], "owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "is_accepted": true, "score": 1, "last_activity_date": 1437583382, "last_edit_date": 1437583382, "creation_date": 1437569225, "answer_id": 31563589, "question_id": 31563146, "link": "https://stackoverflow.com/questions/31563146/how-to-get-out-from-sub-folder-reach-to-main-folder-using-vba/31563589#31563589", "title": "How to get out from sub folder &amp; reach to main folder using VBA?", "body": "<p>I modified your code a little bit so it would run on my Office Word 2007, and it ran wonderfully... Below is the minimal loop to traverse all folders.</p>\n\n<p>Note also that you forget to process the files of the folder in the first call to <code>OpenFilesInSubFolders</code>.</p>\n\n<pre><code>Dim wrdApp As Object\nDim FileToOpen As String\n\nSub FindFilesInSubFolders()\nDim FSO As Object\nDim strFolderName As String\nDim FileToOpen As String\nDim fsoFolder As Object\n\n    FileToOpen = \"*v2.1.doc*\"\n\n    If FSO Is Nothing Then\n       Set FSO = CreateObject(\"Scripting.FileSystemObject\")\n    End If\n    Set wrdApp = CreateObject(\"Word.Application\")\n\n    'Set the parent folder for the new subfolders\n\n    strFolderName = \"C:\\test\"\n    Set fsoFolder = FSO.GetFolder(strFolderName)\n\n    OpenFilesInSubFolders fsoFolder\n End Sub\n\nSub OpenFilesInSubFolders(fsoFolder As Object)\nDim fsoSFolder As Object\nDim fileDoc As Object\nDim wrdDoc As Object\n    '\n    ' First process the files of the curent directory, ...\n    '\n    For Each fileDoc In fsoFolder.Files\n        If fileDoc.Name Like FileToOpen Then\n            Debug.Print fileDoc.Path\n            Set wrdDoc = wrdApp.Documents.Open(fileDoc.Path)\n            With wrdApp\n            .ActiveDocument.Tables(1).Select\n                .Selection.Copy\n                ThisWorkbook.Worksheets(\"Sheet1\").Cells(Rows.Count, \"A\").End(xlUp)(2).PasteSpecial xlPasteValues\n            End With\n            wrdDoc.Close False\n        End If\n    Next fileDoc\n    '\n    ' ...then process all subdirectories\n    '\n    For Each fsoSFolder In fsoFolder.SubFolders\n        OpenFilesInSubFolders fsoSFolder\n    Next fsoSFolder\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "is_accepted": false, "score": 1, "last_activity_date": 1437571374, "creation_date": 1437571374, "answer_id": 31564445, "question_id": 31563146, "link": "https://stackoverflow.com/questions/31563146/how-to-get-out-from-sub-folder-reach-to-main-folder-using-vba/31564445#31564445", "title": "How to get out from sub folder &amp; reach to main folder using VBA?", "body": "<p>Why not just search the directory using windows shell and iterate through the output instead?</p>\n\n<pre><code>Sub SO()\n\nDim files As Variant, file As Variant\n\nfiles = Filter(Split(CreateObject(\"WScript.Shell\").Exec(\"CMD /C DIR \"\"C:\\test\\*v2.1.doc*\"\" /S /B /A:-D\").StdOut.ReadAll,vbCrLf), \".\")\n\nFor Each file In files\n    Debug.Print CStr(file)\nNext\n\nEnd Sub\n</code></pre>\n\n<p>No need to loop through all the folders, just get the files in one hit.</p>\n"}], "owner": {"reputation": 35, "user_id": 3977872, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/fb9f5f776bd1e777342763bc1a696d93?s=128&d=identicon&r=PG&f=1", "display_name": "nihal idiot", "link": "https://stackoverflow.com/users/3977872/nihal-idiot"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 178, "favorite_count": 0, "accepted_answer_id": 31563589, "answer_count": 2, "score": 1, "last_activity_date": 1437656674, "creation_date": 1437568044, "last_edit_date": 1437656674, "question_id": 31563146, "link": "https://stackoverflow.com/questions/31563146/how-to-get-out-from-sub-folder-reach-to-main-folder-using-vba", "title": "How to get out from sub folder &amp; reach to main folder using VBA?", "body": "<p>I have a code which it loops in sub folder &amp; fetches data from word document. But after looping and reaching the last document in sub folder, control is not going back to main folder &amp; then next subfolder. Please see my code. Help me where I am making wrong.</p>\n\n<pre><code>Option Explicit\n\nDim FSO As Scripting.FileSystemObject\nDim strFolderName As String\nDim wrdApp As Word.Application\nDim wrdDoc As Word.Document\nDim FileToOpen As String\n\nSub FindFilesInSubFolders()\n    Dim fsoFolder As Scripting.Folder\n\n    FileToOpen = \"*v2.1.doc*\"\n\n    If FSO Is Nothing Then\n       Set FSO = New Scripting.FileSystemObject\n    End If\n\n    'Set the parent folder for the new subfolders\n\n    strFolderName = \"C:\\Test\"\n    Set fsoFolder = FSO.GetFolder(strFolderName)\n    Set wrdApp = CreateObject(\"Word.Application\")\n\n    OpenFilesInSubFolders fsoFolder\n    wrdApp.Quit\nEnd Sub\n\nSub OpenFilesInSubFolders(fsoPFolder As Scripting.Folder)\n    Dim fsoSFolder As Scripting.Folder\n    Dim fileDoc As Scripting.File\n\n    For Each fsoSFolder In fsoPFolder.SubFolders\n\n        For Each fileDoc In fsoSFolder.Files\n            If fileDoc.Name Like FileToOpen Then\n            Set wrdDoc = wrdApp.Documents.Open(fileDoc.Path)\n            With wrdApp\n               .ActiveDocument.Tables(1).Select\n               .Selection.Copy\n               ThisWorkbook.Worksheets(\"Sheet1\").Cells(Rows.Count, \"A\").End(xlUp)(2).PasteSpecial xlPasteValues\n           End With\n           wrdDoc.Close False\n           'wrdApp.Quit\n           End If\n       Next fileDoc\n\n       OpenFilesInSubFolders fsoSFolder\n    Next fsoSFolder\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 3650, "user_id": 5090027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/904db949ae64fe1a63ea8b4c677e6d57?s=128&d=identicon&r=PG&f=1", "display_name": "Grade &#39;Eh&#39; Bacon", "link": "https://stackoverflow.com/users/5090027/grade-eh-bacon"}, "edited": false, "score": 0, "creation_date": 1437567390, "post_id": 31562755, "comment_id": 51081346, "body": "Are you using &quot;? Because when you actually search, you need to omit the &quot;."}, {"owner": {"reputation": 824, "user_id": 5023092, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FNreo.png?s=128&g=1", "display_name": "Gordon K", "link": "https://stackoverflow.com/users/5023092/gordon-k"}, "edited": false, "score": 0, "creation_date": 1437567455, "post_id": 31562755, "comment_id": 51081401, "body": "When you use the &lt;ctrl&gt;-F you need &quot;Look In: Formulas&quot; selected, rather than &quot;Look in: Values&quot;"}, {"owner": {"reputation": 151, "user_id": 4875502, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0661f60482d1ff5116f26ab631cc17f7?s=128&d=identicon&r=PG&f=1", "display_name": "Kelbe", "link": "https://stackoverflow.com/users/4875502/kelbe"}, "reply_to_user": {"reputation": 3650, "user_id": 5090027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/904db949ae64fe1a63ea8b4c677e6d57?s=128&d=identicon&r=PG&f=1", "display_name": "Grade &#39;Eh&#39; Bacon", "link": "https://stackoverflow.com/users/5090027/grade-eh-bacon"}, "edited": false, "score": 0, "creation_date": 1437567994, "post_id": 31562755, "comment_id": 51081801, "body": "@Grade&#39;Eh&#39;Bacon I am trying to search for the ) then multiplying sign *..............Please look at the example formula I gave in my question as well as the screenshot"}, {"owner": {"reputation": 3650, "user_id": 5090027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/904db949ae64fe1a63ea8b4c677e6d57?s=128&d=identicon&r=PG&f=1", "display_name": "Grade &#39;Eh&#39; Bacon", "link": "https://stackoverflow.com/users/5090027/grade-eh-bacon"}, "edited": false, "score": 0, "creation_date": 1437568113, "post_id": 31562755, "comment_id": 51081880, "body": "Ah - well the problem there is that &#39;*&#39; is a wildcard. Excel uses it to mean &quot;any character&quot;, not &quot;asterisk&quot;. Take a look at this article: <a href=\"http://www.mrexcel.com/archive/General/29013.html\" rel=\"nofollow noreferrer\">mrexcel.com/archive/General/29013.html</a>"}], "answers": [{"comments": [{"owner": {"reputation": 151, "user_id": 4875502, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0661f60482d1ff5116f26ab631cc17f7?s=128&d=identicon&r=PG&f=1", "display_name": "Kelbe", "link": "https://stackoverflow.com/users/4875502/kelbe"}, "edited": false, "score": 0, "creation_date": 1437567678, "post_id": 31562890, "comment_id": 51081577, "body": "I have a * multiplying sign that I am also trying to find....I don&#39;t want to replace all the formulas with ) but ones with )* with )^2* meaning square then multiply."}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 2, "last_activity_date": 1437568486, "last_edit_date": 1437568486, "creation_date": 1437567423, "answer_id": 31562890, "question_id": 31562755, "link": "https://stackoverflow.com/questions/31562755/excel-using-replace-on-formulas/31562890#31562890", "title": "Excel using Replace on Formulas", "body": "<p>Make sure the <em>Look in</em> option is set to <em>Formulas</em>:</p>\n\n<p><a href=\"https://i.stack.imgur.com/kmg31.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/kmg31.png\" alt=\"enter image description here\"></a></p>\n\n<p><strong>EDIT#1:</strong></p>\n\n<p>As per your comment, you must use <strong>tilda</strong> in the <em>Find</em> string:</p>\n\n<p><a href=\"https://i.stack.imgur.com/xNbae.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/xNbae.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": [], "owner": {"reputation": 151, "user_id": 4875502, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0661f60482d1ff5116f26ab631cc17f7?s=128&d=identicon&r=PG&f=1", "display_name": "Kelbe", "link": "https://stackoverflow.com/users/4875502/kelbe"}, "is_accepted": false, "score": 1, "last_activity_date": 1437568130, "creation_date": 1437568130, "answer_id": 31563187, "question_id": 31562755, "link": "https://stackoverflow.com/questions/31562755/excel-using-replace-on-formulas/31563187#31563187", "title": "Excel using Replace on Formulas", "body": "<p>Find and search using:</p>\n\n<pre><code>)~*\n</code></pre>\n\n<p>What I was having difficulty with was the * and I found the solution is to just use a ~ and it will fix the problem.</p>\n"}, {"tags": [], "owner": {"reputation": 3650, "user_id": 5090027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/904db949ae64fe1a63ea8b4c677e6d57?s=128&d=identicon&r=PG&f=1", "display_name": "Grade &#39;Eh&#39; Bacon", "link": "https://stackoverflow.com/users/5090027/grade-eh-bacon"}, "is_accepted": false, "score": 0, "last_activity_date": 1437568176, "creation_date": 1437568176, "answer_id": 31563214, "question_id": 31562755, "link": "https://stackoverflow.com/questions/31562755/excel-using-replace-on-formulas/31563214#31563214", "title": "Excel using Replace on Formulas", "body": "<p>In summary of the article I left as a comment (<a href=\"http://www.mrexcel.com/archive/General/29013.html\" rel=\"nofollow\">http://www.mrexcel.com/archive/General/29013.html</a>), you need to use ~ [the character to the left of the 1 on a standard English QWERTY keyboard] before *, in order to specifically tell excel that you want to look for an asterisk, not use the asterisk as a wildcard.</p>\n"}], "owner": {"reputation": 151, "user_id": 4875502, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0661f60482d1ff5116f26ab631cc17f7?s=128&d=identicon&r=PG&f=1", "display_name": "Kelbe", "link": "https://stackoverflow.com/users/4875502/kelbe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 95, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1437568486, "creation_date": 1437567033, "last_edit_date": 1437567592, "question_id": 31562755, "link": "https://stackoverflow.com/questions/31562755/excel-using-replace-on-formulas", "title": "Excel using Replace on Formulas", "body": "<p>I have a bunch of formulas all over different rows and columns in my Excel sheet. Some of the formulas are of the form: <code>=($B$12-G12)*$B$3*G3</code></p>\n\n<p>All I want to do is replace the \")<em>\" with \")^2</em>\". I tried using the Ctrl + F -> Replace section to look in Formulas but for some reason Excel says cannot find a match...All the cells I am trying to replace are of the form:</p>\n\n<pre><code>=(Cell1-Cell2)*Cell 3*Cell4\n</code></pre>\n\n<p>I just want to replace that )* by ^2*</p>\n\n<p>What can I do?</p>\n\n<p>This is what I have tried searching:</p>\n\n<p><a href=\"https://i.stack.imgur.com/dLjqn.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/dLjqn.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 3812, "user_id": 1481116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d0c940ad90baf5f93d7ab07933d2e17?s=128&d=identicon&r=PG", "display_name": "Luuklag", "link": "https://stackoverflow.com/users/1481116/luuklag"}, "edited": false, "score": 1, "creation_date": 1437567641, "post_id": 31562913, "comment_id": 51081550, "body": "I was bending my mind a bit, therefore a lot of edits, but this version should work. Although I haven&#39;t tried it out, so no guarantees there ;)"}, {"owner": {"reputation": 2406, "user_id": 2482186, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/7Jtw1.jpg?s=128&g=1", "display_name": "R.Katnaan", "link": "https://stackoverflow.com/users/2482186/r-katnaan"}, "edited": false, "score": 1, "creation_date": 1437569277, "post_id": 31562913, "comment_id": 51082720, "body": "I made small modification to your answer for more useful."}, {"owner": {"reputation": 313, "user_id": 4252721, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8c4614b13fef92c794fe2d0833d0b2a4?s=128&d=identicon&r=PG", "display_name": "AMorton1989", "link": "https://stackoverflow.com/users/4252721/amorton1989"}, "edited": false, "score": 0, "creation_date": 1437573895, "post_id": 31562913, "comment_id": 51086328, "body": "Thanks all. Currently having issues with the following line --&gt;                      Rows(row:row).Select"}, {"owner": {"reputation": 313, "user_id": 4252721, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8c4614b13fef92c794fe2d0833d0b2a4?s=128&d=identicon&r=PG", "display_name": "AMorton1989", "link": "https://stackoverflow.com/users/4252721/amorton1989"}, "edited": false, "score": 0, "creation_date": 1437573946, "post_id": 31562913, "comment_id": 51086375, "body": "I assume this is because row here --&gt; For row = 2 To LastRow   --- will become capitalized."}, {"owner": {"reputation": 3812, "user_id": 1481116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d0c940ad90baf5f93d7ab07933d2e17?s=128&d=identicon&r=PG", "display_name": "Luuklag", "link": "https://stackoverflow.com/users/1481116/luuklag"}, "reply_to_user": {"reputation": 313, "user_id": 4252721, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8c4614b13fef92c794fe2d0833d0b2a4?s=128&d=identicon&r=PG", "display_name": "AMorton1989", "link": "https://stackoverflow.com/users/4252721/amorton1989"}, "edited": false, "score": 0, "creation_date": 1437574186, "post_id": 31562913, "comment_id": 51086592, "body": "@AMorton1989 row will not become capitalised. I copied this from the code you had and replaced 40 with row. Try Rows(row).Select, perhaps that works better."}, {"owner": {"reputation": 313, "user_id": 4252721, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8c4614b13fef92c794fe2d0833d0b2a4?s=128&d=identicon&r=PG", "display_name": "AMorton1989", "link": "https://stackoverflow.com/users/4252721/amorton1989"}, "edited": false, "score": 0, "creation_date": 1437574302, "post_id": 31562913, "comment_id": 51086696, "body": "Ah I have just realised what the issue is. When you put a variable within Rows.Select, it needs to be in the following format. --&gt; Rows(Row &amp; &quot;:&quot; &amp; Row).Select"}, {"owner": {"reputation": 3812, "user_id": 1481116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d0c940ad90baf5f93d7ab07933d2e17?s=128&d=identicon&r=PG", "display_name": "Luuklag", "link": "https://stackoverflow.com/users/1481116/luuklag"}, "reply_to_user": {"reputation": 313, "user_id": 4252721, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8c4614b13fef92c794fe2d0833d0b2a4?s=128&d=identicon&r=PG", "display_name": "AMorton1989", "link": "https://stackoverflow.com/users/4252721/amorton1989"}, "edited": false, "score": 0, "creation_date": 1437574442, "post_id": 31562913, "comment_id": 51086811, "body": "@AMorton1989 yes that is also true if you want to retain that layout. Now as I come to think of it your row will probably capitalize as you have declared it in that way, and I declared it without a capital R, hence the difference. The makeup you now use for Rows().Select is more used when you want to select multiple rows, if you only select one row you can do with Rows(Row).Select. Also see: <a href=\"http://www.excel-easy.com/vba/examples/entire-rows-columns.html\" rel=\"nofollow noreferrer\">excel-easy.com/vba/examples/entire-rows-columns.html</a>"}, {"owner": {"reputation": 3812, "user_id": 1481116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d0c940ad90baf5f93d7ab07933d2e17?s=128&d=identicon&r=PG", "display_name": "Luuklag", "link": "https://stackoverflow.com/users/1481116/luuklag"}, "edited": false, "score": 0, "creation_date": 1437574971, "post_id": 31562913, "comment_id": 51087246, "body": "I also fixed the problem with the Rows().Select in my answer."}], "tags": [], "owner": {"reputation": 3812, "user_id": 1481116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d0c940ad90baf5f93d7ab07933d2e17?s=128&d=identicon&r=PG", "display_name": "Luuklag", "link": "https://stackoverflow.com/users/1481116/luuklag"}, "is_accepted": true, "score": 2, "last_activity_date": 1437574694, "last_edit_date": 1437574694, "creation_date": 1437567487, "answer_id": 31562913, "question_id": 31562403, "link": "https://stackoverflow.com/questions/31562403/select-rows-which-have-a-numeric-value-in-the-first-cell-column-a/31562913#31562913", "title": "Select rows which have a numeric value in the first cell (Column A)", "body": "<pre><code>Dim LastRow as Integer\n\nLastRow = ActiveSheet.UsedRange.Rows.Count    \n\nFor row = 2 To LastRow\n    If Not IsNumeric(Cells(row, 1)) Then\n        row = row+1\n        Rows(row).Select\n        Range(Selection, Selection.End(xlDown)).Select\n        Application.CutCopyMode = False\n        Selection.Delete Shift:=xlUp\n    End If\nNext row\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 313, "user_id": 4252721, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8c4614b13fef92c794fe2d0833d0b2a4?s=128&d=identicon&r=PG", "display_name": "AMorton1989", "link": "https://stackoverflow.com/users/4252721/amorton1989"}, "is_accepted": false, "score": 0, "last_activity_date": 1437577001, "last_edit_date": 1437577001, "creation_date": 1437574551, "answer_id": 31565730, "question_id": 31562403, "link": "https://stackoverflow.com/questions/31562403/select-rows-which-have-a-numeric-value-in-the-first-cell-column-a/31565730#31565730", "title": "Select rows which have a numeric value in the first cell (Column A)", "body": "<p>Final result. </p>\n\n<pre><code>    Dim LastRow As Integer\n    LastRow = ActiveSheet.UsedRange.Rows.Count\n\n'In this instance I am starting from row 6.\nFor Row = 6 To LastRow\n    If Not IsNumeric(Cells(row, 1)) Then\n\n        Rows(Row &amp; \":\" &amp; Row).Select\n        Range(Selection, Selection.End(xlDown)).Select\n        Application.CutCopyMode = False\n        Selection.Delete Shift:=xlUp\n    End If\nNext Row\n</code></pre>\n"}], "owner": {"reputation": 313, "user_id": 4252721, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8c4614b13fef92c794fe2d0833d0b2a4?s=128&d=identicon&r=PG", "display_name": "AMorton1989", "link": "https://stackoverflow.com/users/4252721/amorton1989"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 921, "favorite_count": 0, "accepted_answer_id": 31562913, "answer_count": 2, "score": 0, "last_activity_date": 1437577001, "creation_date": 1437566182, "last_edit_date": 1531164843, "question_id": 31562403, "link": "https://stackoverflow.com/questions/31562403/select-rows-which-have-a-numeric-value-in-the-first-cell-column-a", "title": "Select rows which have a numeric value in the first cell (Column A)", "body": "<p>I am using Excel VBA to try and select a range of rows on my spread sheet which are located below the last row with a numeric value in column A. Row 40 is where I need to select from, but this location will change. How do I perform a selection based on a non numeric value. Currently I am selecting the range of rows and deleting them using the following </p>\n\n<pre><code>Rows(\"40:40\").Select\nRange(Selection, Selection.End(xlDown)).Select\nApplication.CutCopyMode = False\nSelection.Delete Shift:=xlUp\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 693, "user_id": 4859229, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/49cfd1f1a4275533311faafc9920d436?s=128&d=identicon&r=PG&f=1", "display_name": "Krishn", "link": "https://stackoverflow.com/users/4859229/krishn"}, "edited": false, "score": 0, "creation_date": 1437562288, "post_id": 31560885, "comment_id": 51077853, "body": "Hi, I know how to use the conditional formatting method however, I want to use a method in vba"}], "tags": [], "owner": {"reputation": 21, "user_id": 5143116, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e9946e9e483b84b1fd31c5e6b773ce62?s=128&d=identicon&r=PG&f=1", "display_name": "Neha Verma", "link": "https://stackoverflow.com/users/5143116/neha-verma"}, "is_accepted": false, "score": 2, "last_activity_date": 1437561919, "creation_date": 1437561919, "answer_id": 31560885, "question_id": 31560790, "link": "https://stackoverflow.com/questions/31560790/alternative-method-for-finding-duplicates/31560885#31560885", "title": "Alternative method for finding duplicates", "body": "<p>we can also find values by below statement in excel.</p>\n\n<p>Home-->Conditional Formatting-->Highlights Cell rules-->Duplicate Values</p>\n"}, {"tags": [], "owner": {"reputation": 3740, "user_id": 3064741, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3d1eaeba1b98ecb9d37ccb68c69aec0?s=128&d=identicon&r=PG&f=1", "display_name": "mielk", "link": "https://stackoverflow.com/users/3064741/mielk"}, "is_accepted": true, "score": 2, "last_activity_date": 1437563163, "creation_date": 1437563163, "answer_id": 31561336, "question_id": 31560790, "link": "https://stackoverflow.com/questions/31560790/alternative-method-for-finding-duplicates/31561336#31561336", "title": "Alternative method for finding duplicates", "body": "<p>Dictionary object is the most suitable for this task.\nBelow is the code using object of dictionary type for checking if item already exists.</p>\n\n<pre><code>Sub Unique_vals()\n    Const FIRST_ROW As Long = 12\n    Dim wks As Excel.Worksheet\n    Dim lastRow As Long\n    Dim dict As Object\n    Dim rng As Excel.Range\n    Dim cell As Excel.Range\n    Dim value As String\n    '-------------------------------------------------------------------------------\n\n\n    'Initialize dictionary.\n    Set dict = VBA.CreateObject(\"Scripting.Dictionary\")\n\n\n    Set wks = Excel.ActiveSheet\n    With wks\n        lastRow = .Cells(.Rows.Count, 3).End(xlUp).Row\n        If lastRow &lt;= FIRST_ROW Then Exit Sub\n        Set rng = .Range(.Cells(FIRST_ROW, 11), .Cells(lastRow, 11))   '&lt;--- 11 is index of column K.\n    End With\n\n\n\n    For Each cell In rng.Cells\n        With cell\n            value = .Offset(0, -8) &amp; .Offset(0, -7) &amp; .Offset(0, -6) &amp; .Offset(0, -5) &amp; .Offset(0, -4)\n\n            'Check if there is already item with such key in dictionary [dict].\n            If dict.exists(value) Then\n                'Duplicate\n                cell.Offset(0, 1).value = \"Duplicate\"\n            Else\n                'Unique value, add it to the dictionary.\n                Call dict.Add(value, 0)\n            End If\n\n        End With\n    Next cell\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2406, "user_id": 2482186, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/7Jtw1.jpg?s=128&g=1", "display_name": "R.Katnaan", "link": "https://stackoverflow.com/users/2482186/r-katnaan"}, "is_accepted": false, "score": 1, "last_activity_date": 1437563695, "creation_date": 1437563695, "answer_id": 31561539, "question_id": 31560790, "link": "https://stackoverflow.com/questions/31560790/alternative-method-for-finding-duplicates/31561539#31561539", "title": "Alternative method for finding duplicates", "body": "<p>I made small modification to your code. If it is not OK, let me know what is wrong. Try this:</p>\n\n<pre><code>Sub Unique_vals()\n\n    Dim lastRange, cell As Range\n\n    Set lastRange = Range(\"C1048576\").End(xlUp).Offset(0, 8)\n\n    If Range(\"K12\").Address = lastRange.Address Then\n        Exit Sub\n    End If\n\n    'populates cells with offset value\n    For Each cell In Range(\"K12\", lastRange)\n\n        cell.Value = cell.Offset(0, -8) &amp; cell.Offset(0, -7) &amp; cell.Offset(0, -6) &amp; cell.Offset(0, -5) &amp; cell.Offset(0, -4)\n\n    Next cell\n\n    'from K13 down this check if there is a match above\n    For Each cell In Range(\"K13\", lastRange)\n\n        If Application.WorksheetFunction.CountIf(Range(\"K12\", cell.Offset(-1, 0)), cell) Then\n\n           cell.Offset(0, 1).Value = \"Duplicate\"\n\n        End If\n\n    Next cell\n\nEnd Sub\n</code></pre>\n\n<p>I already tested my code. It work well for me.</p>\n"}], "owner": {"reputation": 693, "user_id": 4859229, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/49cfd1f1a4275533311faafc9920d436?s=128&d=identicon&r=PG&f=1", "display_name": "Krishn", "link": "https://stackoverflow.com/users/4859229/krishn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 110, "favorite_count": 0, "accepted_answer_id": 31561336, "answer_count": 3, "score": 0, "last_activity_date": 1437563695, "creation_date": 1437561679, "last_edit_date": 1531164843, "question_id": 31560790, "link": "https://stackoverflow.com/questions/31560790/alternative-method-for-finding-duplicates", "title": "Alternative method for finding duplicates", "body": "<p>I have the below code to find duplicate values and this works very well, however my preference is to use the same process without populate cells with the concatenation. Please can someone assist?</p>\n\n<pre><code>Sub Unique_vals()\n\n    Dim rng, lastr, cel As Range, rng1 As Range\n    Set lastr = Range(\"C1048576\").End(xlUp).Offset(0, 8)\n    Set rng = Range(\"K12\", lastr)\n    Set rng1 = Range(\"K13\", lastr)\n\n    If Range(\"k12\").Address = lastr.Address Then \n        Exit Sub\n\n    'populates cells with offset value\n    For Each cel In rng\n\n        cel.Value = cel.Offset(0, -8) &amp; cel.Offset(0, -7) &amp; cel.Offset(0, -6) &amp; cel.Offset(0, -5) &amp; cel.Offset(0, -4)\n\n    Next cel\n\n    'from k13 down this check if there is a match above\n    For Each cel In rng1\n\n        If Application.WorksheetFunction.CountIf(Range(\"K12\", cel.Offset(-1, 0)), cel) Then \n           cel.Offset(0, 1).Value = \"Duplicate\"\n\n    Next cel\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "autofilter"], "answers": [{"comments": [{"owner": {"reputation": 61, "user_id": 3869544, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/d4ed879467661fd30f01f50afdea3fec?s=128&d=identicon&r=PG&f=1", "display_name": "GtDriver", "link": "https://stackoverflow.com/users/3869544/gtdriver"}, "edited": false, "score": 0, "creation_date": 1437561523, "post_id": 31560607, "comment_id": 51077368, "body": "Thanks for this -- it still doesnt provide the result i need. to be clear, field 10 needs to filter for dates more than 7 days old. Therefore, anything older than seven days will be shown. However, i also need dates in advance of today/now... this isnt happening."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 61, "user_id": 3869544, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/d4ed879467661fd30f01f50afdea3fec?s=128&d=identicon&r=PG&f=1", "display_name": "GtDriver", "link": "https://stackoverflow.com/users/3869544/gtdriver"}, "edited": false, "score": 0, "creation_date": 1437561752, "post_id": 31560607, "comment_id": 51077514, "body": "You would need to cycle through the dates and build an array of all dates excluding the 7 day period but including Unknown then filter on the array."}, {"owner": {"reputation": 61, "user_id": 3869544, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/d4ed879467661fd30f01f50afdea3fec?s=128&d=identicon&r=PG&f=1", "display_name": "GtDriver", "link": "https://stackoverflow.com/users/3869544/gtdriver"}, "edited": false, "score": 0, "creation_date": 1437563509, "post_id": 31560607, "comment_id": 51078676, "body": "Awesome -- thanks. I&#39;ve been playing aroud with the spreadsheet in the interim... i rekeyed some of the offending dates... and guess what... autofilter is working correctly. !? I cant figure out what has happened... other than someone might have changed the date format (although it looks the same as it ever did). Is this an issue with Excel???"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 0, "last_activity_date": 1437563083, "last_edit_date": 1437563083, "creation_date": 1437561157, "answer_id": 31560607, "question_id": 31560432, "link": "https://stackoverflow.com/questions/31560432/vba-excel-filter-multiple-fields/31560607#31560607", "title": "VBA Excel - Filter multiple fields", "body": "<p>Define your range as well as your worksheet in a <a href=\"https://msdn.microsoft.com/en-us/library/wc500chb.aspx\" rel=\"nofollow\">With ... End With statement</a> then use the range definition to set all three filters.</p>\n\n<pre><code>Dim lr As Long, dat As Range, vDATEs As Variant\nReDim vDATEs(1 To 1)\nvDATEs(1) = \"Unknown\"\nWith Sheets(\"Sheet3\")\n    If .AutoFilterMode Then .AutoFilterMode = False\n    lr = .Cells(Rows.Count, 10).End(xlUp).Row\n    With .Range(\"$A:$S\").Resize(lr, 19)\n        .AutoFilter field:=1, Criteria1:=Array(\"Ongoing\", \"Completed\"), Operator:=xlFilterValues\n        .AutoFilter field:=4, Criteria1:=Array(\"AQs\", \"Prop\", \"RF\", \"RP\", \"SQs\"), Operator:=xlFilterValues\n        With .Resize(.Rows.Count - 1, .Columns.Count).Offset(1, 0)\n            If CBool(Application.Subtotal(103, .Columns(10))) Then\n                For Each dat In Intersect(.SpecialCells(xlCellTypeVisible), .Columns(10))\n                    If IsDate(dat) Then\n                        If dat.Value &lt; (Date - 7) Or dat.Value &gt; Date Then\n                            ReDim Preserve vDATEs(LBound(vDATEs) To UBound(vDATEs) + 1)\n                            vDATEs(UBound(vDATEs)) = Format(dat.Value, \"mm/dd/yyyy\")\n                        End If\n                    End If\n                Next dat\n            End If\n        End With\n        .AutoFilter field:=10, Criteria1:=(vDATEs), Operator:=xlFilterValues\n    End With\n    'If .AutoFilterMode Then .AutoFilterMode = False\nEnd With\n</code></pre>\n\n<p>You cannot have three criteria on an Autofilter field without resorting to an array. Build the array from the values showing and then use that array to filter your final field.</p>\n"}], "owner": {"reputation": 61, "user_id": 3869544, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/d4ed879467661fd30f01f50afdea3fec?s=128&d=identicon&r=PG&f=1", "display_name": "GtDriver", "link": "https://stackoverflow.com/users/3869544/gtdriver"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 4907, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1437567646, "creation_date": 1437560699, "last_edit_date": 1437567646, "question_id": 31560432, "link": "https://stackoverflow.com/questions/31560432/vba-excel-filter-multiple-fields", "title": "VBA Excel - Filter multiple fields", "body": "<p>I'm trying to filter three column. Please see the following code:</p>\n\n<pre><code>.Range(\"$A:$S\").AutoFilter field:=1, Criteria1:=Array(\"Ongoing\", \"Completed\"), Operator:=xlFilterValues\n\n.Range(\"$A:$S\").AutoFilter field:=4, Criteria1:=Array(\"AQs\", \"Prop\", \"RF\", \"RP\", \"SQs\"), Operator:=xlFilterValues\n\n.Range(\"$A$1:$S$\" &amp; ActiveSheet.UsedRange.Rows.Count).AutoFilter field:=10, Criteria1:=\"&gt;\" &amp; _\n  Format(Date - 7, \"mm/dd/yyyy\"), Operator:=xlOr, Criteria2:=\"=Not Known\", Operator:=xlOr\n</code></pre>\n\n<p>Basically, i'm filtering field 1 based on 'ongoing' and 'complete'; field 4 on 'aqs', 'prop', 'rf', 'rp', etc. Finally i want to filter all of that for dates within a week of now AND the value 'Not known'.</p>\n\n<p>It filters through the first two fields fine... but the last filter line doesnt work correctly. I get the 'Not Known' values and i get everything that is within a week of today BUT i dont get anything which is in advance of today... this is a problem.</p>\n\n<p>Can anyone help?</p>\n"}, {"tags": ["vba", "filesystemobject"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2140173"}, "edited": false, "score": 0, "creation_date": 1437560572, "post_id": 31560139, "comment_id": 51076739, "body": "You&#39;re just missing a <code>Set</code> keyword in front of <code>objTXT = ...</code> <a href=\"https://msdn.microsoft.com/en-us/library/aa265347(v=vs.60).aspx\" rel=\"nofollow noreferrer\">MSDN Reference to OpenTextFile</a> and a <a href=\"http://stackoverflow.com/q/349613/2140173\">bit more here on SO</a>"}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2140173"}, "edited": false, "score": 3, "creation_date": 1437560395, "post_id": 31560295, "comment_id": 51076634, "body": "That&#39;s an alternative but doesn&#39;t really answer the question asked."}], "tags": [], "owner": {"reputation": 3740, "user_id": 3064741, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3d1eaeba1b98ecb9d37ccb68c69aec0?s=128&d=identicon&r=PG&f=1", "display_name": "mielk", "link": "https://stackoverflow.com/users/3064741/mielk"}, "is_accepted": false, "score": 1, "last_activity_date": 1437560262, "creation_date": 1437560262, "answer_id": 31560295, "question_id": 31560139, "link": "https://stackoverflow.com/questions/31560139/how-to-use-the-filesystemobject-in-vba/31560295#31560295", "title": "How to use the FileSystemObject in VBA", "body": "<p>You don't need <code>FileSystemObject</code> to read textfile.\nYou can do it like that (without any external libraries):</p>\n\n<pre><code>Public Sub readTextFile(filepath As String)\n    Dim intFile As Integer\n    Dim text As String\n    '------------------------------------------------------------------------------------------------------\n\n    intFile = VBA.FreeFile()\n\n    Open filepath For Input As #intFile\n    Line Input #intFile, text\n    Close intFile\n\n    Call MsgBox(text)\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2406, "user_id": 2482186, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/7Jtw1.jpg?s=128&g=1", "display_name": "R.Katnaan", "link": "https://stackoverflow.com/users/2482186/r-katnaan"}, "is_accepted": true, "score": 1, "last_activity_date": 1437560408, "creation_date": 1437560408, "answer_id": 31560339, "question_id": 31560139, "link": "https://stackoverflow.com/questions/31560139/how-to-use-the-filesystemobject-in-vba/31560339#31560339", "title": "How to use the FileSystemObject in VBA", "body": "<p>The problem is not use <code>Set</code> for opening. Try as follow:</p>\n\n<pre><code>Set objTXT = objFSO.OpenTextFile(\"C:\\...\", ForReading)\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 5103564, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b1851b846bcc984009b5d90003f31f71?s=128&d=identicon&r=PG&f=1", "display_name": "Tabitha", "link": "https://stackoverflow.com/users/5103564/tabitha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 340, "favorite_count": 0, "accepted_answer_id": 31560339, "answer_count": 2, "score": 2, "last_activity_date": 1437560425, "creation_date": 1437559821, "last_edit_date": 1437560425, "question_id": 31560139, "link": "https://stackoverflow.com/questions/31560139/how-to-use-the-filesystemobject-in-vba", "title": "How to use the FileSystemObject in VBA", "body": "<p>So I'm quite new to VB and I'm just trying to create something that will open up a .txt file then read the first line and output it.\nI've put my code below but when I run it I get the error</p>\n\n<blockquote>\n  <p>Object variable or with block variable not set</p>\n</blockquote>\n\n<p>because of the line</p>\n\n<pre><code>objTXT=objFSO.OpenTextFile(\"C:\\...\",ForReading)\n</code></pre>\n\n<p>Any help, I feel like I'm missing something quite basic.</p>\n\n<pre><code>Private Sub Text_Reader()\n\n    Dim objFSO As FileSystemObject\n    Dim objTXT As TextStream\n    Dim str$\n\n    Set objFSO = New FileSystemObject\n\n    objTXT = objFSO.OpenTextFile(\"C:\\...\", ForReading)\n    str = objTXT.ReadLine\n    MsgBox (str)\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["c#", "vba", "visual-studio", "excel"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2140173"}, "edited": false, "score": 1, "creation_date": 1437562985, "post_id": 31559790, "comment_id": 51078342, "body": "<a href=\"http://stackoverflow.com/q/6340041/2140173\">Using a C# dll inside EXCEL VBA</a> and <a href=\"http://stackoverflow.com/q/5933352/2140173\">Call unregistered .net DLL from Excel</a>"}], "answers": [{"tags": [], "owner": {"reputation": 841, "user_id": 3633799, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bf3c5795e0c55e5c31ed7fa75abc8da5?s=128&d=identicon&r=PG&f=1", "display_name": "Jane", "link": "https://stackoverflow.com/users/3633799/jane"}, "is_accepted": true, "score": 1, "last_activity_date": 1437563593, "creation_date": 1437563593, "answer_id": 31561504, "question_id": 31559790, "link": "https://stackoverflow.com/questions/31559790/communication-between-vba-and-c-with-portability-and-no-admin-privilege/31561504#31561504", "title": "Communication between VBA and C#, with portability and no Admin Privilege", "body": "<p>You could write a C# Console Application which accepts command-line arguments, then call this using the Shell command. </p>\n\n<p>Here's a sample Console application which handles the input parameters:\n    using System;</p>\n\n<pre><code>namespace ConsoleAppWithParams\n{\n    class Program\n    {\n        public static void Main(string[] args)\n        {\n            Console.WriteLine(\"Number of command line parameters = {0}\",\n               args.Length);\n            foreach (string s in args)\n            {\n                Console.WriteLine(s);\n            }\n            Console.ReadLine();\n        }\n    }\n}\n</code></pre>\n\n<p>Note that the parameters are coming from the command-line, so they are strings. You'd need to validate and convert the parameters if you need other data types. </p>\n\n<p>You can call this from Excel VBA as follows:</p>\n\n<pre><code>Sub UseCSharpApp()\n    Shell \"D:\\Documents\\ConsoleAppWithParams.exe Tom Dick Harry\"\nEnd Sub\n</code></pre>\n\n<p>If your C# application is fairly straightforward, then the only requirement would be for it to be copied to the expected directory, and for the correct version (or a more recent version) of the .NET Framework to be installed on the PC. If the C# app is written to target .NET Framework 2.0, then it's likely that most Windows PCs in a business environment would be able to use this, but obviously you should check whether that's the case in your environment.</p>\n\n<p>Note that with this approach, you're limited to passing in values when first calling the application. This wouldn't be a useful solution in all scenarios, but might work if that's all you need to do. </p>\n"}], "owner": {"reputation": 55, "user_id": 4853750, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c71d4e6d467d1f3bdc3f15b804bce2de?s=128&d=identicon&r=PG&f=1", "display_name": "user4853750", "link": "https://stackoverflow.com/users/4853750/user4853750"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 187, "favorite_count": 1, "accepted_answer_id": 31561504, "answer_count": 1, "score": 0, "last_activity_date": 1437563593, "creation_date": 1437558971, "last_edit_date": 1531164843, "question_id": 31559790, "link": "https://stackoverflow.com/questions/31559790/communication-between-vba-and-c-with-portability-and-no-admin-privilege", "title": "Communication between VBA and C#, with portability and no Admin Privilege", "body": "<p>I am trying to write something that would access methods I have written in a WPF c# application, from a vba worksheet, an intermediary would be acceptable, as well as any command line solution, as long as I can run this intermediary from excel where the data I need to send will be kept. </p>\n\n<p>Does anyone know any decent solutions for sending data to a c# without registering the dll, and preferably in a portable way that I can move to other machines easily?</p>\n\n<p>Any help in that matter would be greatly appreciated, I am looking for pointers in the right direction as a COM solution is not viable right now. </p>\n\n<p>Cheers.</p>\n"}, {"tags": ["excel", "type-mismatch", "vba"], "answers": [{"comments": [{"owner": {"reputation": 103, "user_id": 4910875, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/830ba16f7770d9258b6e61b46cd0f44e?s=128&d=identicon&r=PG&f=1", "display_name": "excel", "link": "https://stackoverflow.com/users/4910875/excel"}, "edited": false, "score": 0, "creation_date": 1437559767, "post_id": 31560006, "comment_id": 51076190, "body": "There&#39;s not even one data copied...all the date format is like <code>Jan-15</code>, I wonder why this is not considered date"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "reply_to_user": {"reputation": 103, "user_id": 4910875, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/830ba16f7770d9258b6e61b46cd0f44e?s=128&d=identicon&r=PG&f=1", "display_name": "excel", "link": "https://stackoverflow.com/users/4910875/excel"}, "edited": false, "score": 0, "creation_date": 1437560138, "post_id": 31560006, "comment_id": 51076433, "body": "That&#39;s not a date - a date requires a day. I&#39;ll amend the code to cater for that too. Edit: done. I also removed the <code>Do..Loop</code> as I couldn&#39;t see the point of it."}, {"owner": {"reputation": 103, "user_id": 4910875, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/830ba16f7770d9258b6e61b46cd0f44e?s=128&d=identicon&r=PG&f=1", "display_name": "excel", "link": "https://stackoverflow.com/users/4910875/excel"}, "edited": false, "score": 0, "creation_date": 1437561153, "post_id": 31560006, "comment_id": 51077146, "body": "I get error message of <code>Type Mismatch</code> at line of <code>ElseIf IsDate(&quot;01-&quot; &amp; .Range(&quot;AJ&quot; &amp; X).Value2) Then</code>"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "reply_to_user": {"reputation": 103, "user_id": 4910875, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/830ba16f7770d9258b6e61b46cd0f44e?s=128&d=identicon&r=PG&f=1", "display_name": "excel", "link": "https://stackoverflow.com/users/4910875/excel"}, "edited": false, "score": 0, "creation_date": 1437563975, "post_id": 31560006, "comment_id": 51078981, "body": "@excel Perhaps you have errors in some cells? I&#39;ve added a test for that too."}, {"owner": {"reputation": 103, "user_id": 4910875, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/830ba16f7770d9258b6e61b46cd0f44e?s=128&d=identicon&r=PG&f=1", "display_name": "excel", "link": "https://stackoverflow.com/users/4910875/excel"}, "edited": false, "score": 0, "creation_date": 1437630993, "post_id": 31560006, "comment_id": 51112156, "body": "I have updated screenshot of my sample data for your reference:)\t Now there&#39;s no errors but just nothing is copied over to the worksheet, it means there&#39;s some errors in all data format of the cells, I&#39;m wondering what&#39;s wrong with them"}], "tags": [], "owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "is_accepted": true, "score": 2, "last_activity_date": 1437563953, "last_edit_date": 1437563953, "creation_date": 1437559480, "answer_id": 31560006, "question_id": 31559731, "link": "https://stackoverflow.com/questions/31559731/type-mismatch-for-getting-year-value/31560006#31560006", "title": "Type Mismatch for getting year value", "body": "<p>You should check if the cell contains a date first:</p>\n\n<pre><code>For X = 2 To wSlastRow\n    'insert wSlastRow no of rows to worksheet Summary\n    'wSheet1.Rows(wSlastRow).Insert Shift:=xlDown\n    If Not IsError(.Range(\"AJ\" &amp; X).Value2) Then\n        If IsDate(.Range(\"AJ\" &amp; X).Value2) Then\n            If Year(.Range(\"AJ\" &amp; X).Value2) = 2015 Then\n                .Range(\"B\" &amp; X).Copy Destination:=wSheet2.Range(\"B\" &amp; X)\n                .Range(\"AJ\" &amp; X).Copy Destination:=wSheet2.Range(\"J\" &amp; X)\n            End If\n        ElseIf IsDate(\"01-\" &amp; .Range(\"AJ\" &amp; X).Value2) Then\n            If Year(\"01-\" &amp; .Range(\"AJ\" &amp; X).Value2) = 2015 Then\n                .Range(\"B\" &amp; X).Copy Destination:=wSheet2.Range(\"B\" &amp; X)\n                .Range(\"AJ\" &amp; X).Copy Destination:=wSheet2.Range(\"J\" &amp; X)\n            End If\n        End If\n    End If\nNext X\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2406, "user_id": 2482186, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/7Jtw1.jpg?s=128&g=1", "display_name": "R.Katnaan", "link": "https://stackoverflow.com/users/2482186/r-katnaan"}, "is_accepted": false, "score": 0, "last_activity_date": 1437635467, "creation_date": 1437635467, "answer_id": 31580489, "question_id": 31559731, "link": "https://stackoverflow.com/questions/31559731/type-mismatch-for-getting-year-value/31580489#31580489", "title": "Type Mismatch for getting year value", "body": "<p>I think that we don't need so many checking. If your cell type is <code>Date</code>, this code also should be work:</p>\n\n<pre><code>For X = 2 To wSlastRow\n    If IsDate(.Range(\"AJ\" &amp; X)) Then\n        If Year(.Range(\"AJ\" &amp; X)) = 2015 Then\n            .Range(\"B\" &amp; X).Copy Destination:=wSheet2.Range(\"B\" &amp; X)\n            .Range(\"AJ\" &amp; X).Copy Destination:=wSheet2.Range(\"J\" &amp; X)\n        End If\n    End If\nNext X\n</code></pre>\n"}], "owner": {"reputation": 103, "user_id": 4910875, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/830ba16f7770d9258b6e61b46cd0f44e?s=128&d=identicon&r=PG&f=1", "display_name": "excel", "link": "https://stackoverflow.com/users/4910875/excel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 34, "favorite_count": 0, "accepted_answer_id": 31560006, "answer_count": 2, "score": 1, "last_activity_date": 1437635467, "creation_date": 1437558800, "last_edit_date": 1531164843, "question_id": 31559731, "link": "https://stackoverflow.com/questions/31559731/type-mismatch-for-getting-year-value", "title": "Type Mismatch for getting year value", "body": "<p>I have the error message of </p>\n\n<blockquote>\n  <p>Type Mismatch</p>\n</blockquote>\n\n<p>at the line of <code>If Year(.Range(\"AJ\" &amp; X).Value2) = 2015 Then</code></p>\n\n<p>macro shows <code>Year(.Range(\"AJ\" &amp; X).Value2)</code> equals to Error 2042, I'm not sure what to do with this.</p>\n\n<p>The full code is here:</p>\n\n<pre><code>Sub WintelPatch()\n'// Declare your variables.\nDim wSheet1 As Worksheet, _\nwSheet2 As Worksheet, _\nwSlastRow As Long, _\nX As Long, _\nwkbSourceBook As Workbook, _\nwkbCrntWorkBook As Workbook, _\nworksheetName As String, _\nDefault As String\n\nSet wkbCrntWorkBook = ActiveWorkbook\n'// Set here Workbook(Sheets) names\nSet wSheet2 = wkbCrntWorkBook.ActiveSheet\n\n'extract data from another excel file\nWith Application.FileDialog(msoFileDialogOpen)\n.Filters.Clear\n.Filters.Add \"Excel 2007-13\", \"*.xlsx; *.xlsm; *.xls\"\n.AllowMultiSelect = False\n.Show\nIf .SelectedItems.Count &gt; 0 Then\n\n    'Prompts user to choose which Worksheet they want to copy from\n    MSG1 = MsgBox(\"Do you wish to copy from 'Overall details' ?\", vbYesNo, \"Name of Worksheet\")\n    If MSG1 = vbYes Then\n        worksheetName = \"Overall details\"\n    Else\n        Default = \"Sheet\"\n        worksheetName = Application.InputBox(\"Enter the name of Worksheet (Case-sensitive)\", Default, Default)\n    'End of first If statement\n    End If\n\n    Set wkbSourceBook = Workbooks.Open(.SelectedItems(1))\n    Set wSheet1 = wkbSourceBook.Sheets(worksheetName)\n\n    With wSheet1\n    '// Here lets Find the last row of data\n    wSlastRow = .Rows(.Range(\"B:B\").Rows.Count).End(xlUp).Row\n\n    '// Now Loop through each row\n    For X = 2 To wSlastRow\n    'insert wSlastRow no of rows to worksheet Summary\n    'wSheet1.Rows(wSlastRow).Insert Shift:=xlDown\n    If Not IsError(.Range(\"AJ\" &amp; X).Value2) Then\n        If IsDate(.Range(\"AJ\" &amp; X).Value2) Then\n            If Year(.Range(\"AJ\" &amp; X).Value2) = 2015 Then\n                .Range(\"B\" &amp; X).Copy Destination:=wSheet2.Range(\"B\" &amp; X)\n                .Range(\"AJ\" &amp; X).Copy Destination:=wSheet2.Range(\"J\" &amp; X)\n            End If\n        ElseIf IsDate(\"01-\" &amp; .Range(\"AJ\" &amp; X).Value2) Then\n            If Year(\"01-\" &amp; .Range(\"AJ\" &amp; X).Value2) = 2015 Then\n                .Range(\"B\" &amp; X).Copy Destination:=wSheet2.Range(\"B\" &amp; X)\n                .Range(\"AJ\" &amp; X).Copy Destination:=wSheet2.Range(\"J\" &amp; X)\n            End If\n        End If\n    End If\n    Next X\n\n    End With\n    wkbSourceBook.Close False\nEnd If\nEnd With\n\n'Free objects\nSet wkbCrntWorkBook = Nothing\nSet wSheet2 = Nothing\nSet wkbSourceBook = Nothing\nSet wSheet1 = Nothing\n\n'// Simple Msg Box\nMsgBox \"Copy &amp; Paste is Done.\"\nEnd Sub\n</code></pre>\n\n<p>Here's the data in column B and AJ which are hostnames and dates my macro need to copy over another worksheet (sample data for your reference):</p>\n\n<p><a href=\"https://i.stack.imgur.com/xMIRr.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/xMIRr.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 0, "creation_date": 1437558468, "post_id": 31559498, "comment_id": 51075227, "body": "I&#39;d be careful with that, might be less a problem for the workbook&#39;s name, but I did that once for the sheet&#39;s name and I could never open back my workbook and lost all the work I already had done on that file..."}, {"owner": {"reputation": 45, "user_id": 5039832, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ibCJY.jpg?s=128&g=1", "display_name": "JBear", "link": "https://stackoverflow.com/users/5039832/jbear"}, "reply_to_user": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 0, "creation_date": 1437558549, "post_id": 31559498, "comment_id": 51075288, "body": "That&#39;s not an issue for me really. This is part of a much bigger macro that takes last weeks report. updates it and does a saves as with the new date. So if it crashes i&#39;ll just reproduce the same doc"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1437558638, "post_id": 31559498, "comment_id": 51075359, "body": "I believe that the reason the code won&#39;t write the file is an attempt at cross-compatibility with <code>office-mac-vba</code>."}, {"owner": {"reputation": 45, "user_id": 5039832, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ibCJY.jpg?s=128&g=1", "display_name": "JBear", "link": "https://stackoverflow.com/users/5039832/jbear"}, "edited": false, "score": 0, "creation_date": 1437558692, "post_id": 31559498, "comment_id": 51075408, "body": "mac hasn&#39;t been associated with this file at all???"}], "answers": [{"comments": [{"owner": {"reputation": 45, "user_id": 5039832, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ibCJY.jpg?s=128&g=1", "display_name": "JBear", "link": "https://stackoverflow.com/users/5039832/jbear"}, "edited": false, "score": 0, "creation_date": 1437559767, "post_id": 31559920, "comment_id": 51076189, "body": "It may not be pretty but it works. Set it to Save with the new date, Close, Name, Reopen. Many thanks @Iturner"}, {"owner": {"reputation": 2765, "user_id": 4646304, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/cb7e0e8a97f18e0cc2ddfb28552ff6d5?s=128&d=identicon&r=PG&f=1", "display_name": "luke_t", "link": "https://stackoverflow.com/users/4646304/luke-t"}, "reply_to_user": {"reputation": 45, "user_id": 5039832, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ibCJY.jpg?s=128&g=1", "display_name": "JBear", "link": "https://stackoverflow.com/users/5039832/jbear"}, "edited": false, "score": 0, "creation_date": 1437559928, "post_id": 31559920, "comment_id": 51076297, "body": "Yeah, very inconvenient.. but glad to help."}], "tags": [], "owner": {"reputation": 2765, "user_id": 4646304, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/cb7e0e8a97f18e0cc2ddfb28552ff6d5?s=128&d=identicon&r=PG&f=1", "display_name": "luke_t", "link": "https://stackoverflow.com/users/4646304/luke-t"}, "is_accepted": true, "score": 3, "last_activity_date": 1437559297, "creation_date": 1437559297, "answer_id": 31559920, "question_id": 31559498, "link": "https://stackoverflow.com/questions/31559498/vba-save-as-special-character-error/31559920#31559920", "title": "VBA Save As special character error", "body": "<p>The only workaround I can think of is renaming the file once it is closed.</p>\n\n<p>To do this you can use the <code>Name</code> statement. See <a href=\"https://msdn.microsoft.com/en-us/library/aa266171(v=vs.60).aspx\" rel=\"nofollow\">MSDN documentation</a>.</p>\n\n<pre><code>Name \"C:\\Users\\lturner\\Documents\\myWorkbook.xlsb\" As \"C:\\Users\\lturner\\Documents\\[1]myWorkbook.xlsb\"\n</code></pre>\n\n<p>Aside from this, I don't think it's possible to save the workbook with square brackets in the name.</p>\n"}, {"comments": [{"owner": {"reputation": 45, "user_id": 5039832, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ibCJY.jpg?s=128&g=1", "display_name": "JBear", "link": "https://stackoverflow.com/users/5039832/jbear"}, "edited": false, "score": 0, "creation_date": 1437560449, "post_id": 31560181, "comment_id": 51076666, "body": "Ohhh I see the logic. Shouldn&#39;t affect me here but will need to remember going forward. Thanks @Carl Fried Rice Gauss"}, {"owner": {"reputation": 5865, "user_id": 4415493, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/CidOV.jpg?s=128&g=1", "display_name": "JamesFaix", "link": "https://stackoverflow.com/users/4415493/jamesfaix"}, "reply_to_user": {"reputation": 45, "user_id": 5039832, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ibCJY.jpg?s=128&g=1", "display_name": "JBear", "link": "https://stackoverflow.com/users/5039832/jbear"}, "edited": false, "score": 0, "creation_date": 1453396379, "post_id": 31560181, "comment_id": 57593216, "body": "Also, watch out for single quotes.  These are also legal in windows, but are used in Excel when workbook or worksheet names have spaces in them.  (ex. =&#39;[My Book Name.xlsx]My Sheet Name&#39;!A1)  I suggest creating a class that can do regex tests against strings to test for valid workbook names, valid worksheet names, and valid windows file names."}], "tags": [], "owner": {"reputation": 5865, "user_id": 4415493, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/CidOV.jpg?s=128&g=1", "display_name": "JamesFaix", "link": "https://stackoverflow.com/users/4415493/jamesfaix"}, "is_accepted": false, "score": 2, "last_activity_date": 1437559922, "creation_date": 1437559922, "answer_id": 31560181, "question_id": 31559498, "link": "https://stackoverflow.com/questions/31559498/vba-save-as-special-character-error/31560181#31560181", "title": "VBA Save As special character error", "body": "<p>Square brackets are legal characters for windows file names, but are treated specially by Excel, and hence VBA.</p>\n\n<p>To see why, open two workbooks and in the first pick a cell and enter the formula \"=SUM(\", then click a cell in the second workbook.  Your formula will now look something like this \"=SUM([Workbook2]Sheet1!A1)\". Square brackets are used as workbook name delimiters.</p>\n"}], "owner": {"reputation": 45, "user_id": 5039832, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ibCJY.jpg?s=128&g=1", "display_name": "JBear", "link": "https://stackoverflow.com/users/5039832/jbear"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1204, "favorite_count": 0, "accepted_answer_id": 31559920, "answer_count": 2, "score": 1, "last_activity_date": 1437559922, "creation_date": 1437558205, "last_edit_date": 1531164843, "question_id": 31559498, "link": "https://stackoverflow.com/questions/31559498/vba-save-as-special-character-error", "title": "VBA Save As special character error", "body": "<p>This code below was running perfect.\nFor internal report tracking purposes I've appended \"[1944] \" to the front of the file name.\nIt's now kicking back \"Run-time error '1004'\" at me.</p>\n\n<p><b>Error 1004 Checklist</b></p>\n\n<ul>\n<li>Folder exists</li>\n<li>File is not read-only</li>\n<li>Len(file path) &lt; 218</li>\n</ul>\n\n<p>Last section references not using the following characters\n&lt; > ? [ ] : | or *</p>\n\n<p>But if I go to the folder location I can rename it using [ ] no problem.\nI can even title a file with this and launch it using VBA\nSo why can't I save a file with it in.</p>\n\n<p>Anyone got a work around for me?</p>\n\n<p>Many thanks!</p>\n\n<pre><code>ActiveWorkbook.SaveAs Filename:= _\n    strfilepath &amp; \"[1944] TSA34_MI_\" &amp; strdt &amp; \".xlsb\" _\n    , FileFormat:=xlExcel12, Password:=\"\", WriteResPassword:=\"\", _\n    ReadOnlyRecommended:=False, CreateBackup:=False\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 5142822, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc5d66f4f8165c4fe03c07d018f921d3?s=128&d=identicon&r=PG&f=1", "display_name": "Sandeep Shivaraman", "link": "https://stackoverflow.com/users/5142822/sandeep-shivaraman"}, "edited": false, "score": 0, "creation_date": 1437560205, "post_id": 31559400, "comment_id": 51076490, "body": "Tom its not working still&lt; giving error invalid qualifier MyStringVar1.Select"}], "tags": [], "owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "is_accepted": false, "score": 1, "last_activity_date": 1437557976, "creation_date": 1437557976, "answer_id": 31559400, "question_id": 31559325, "link": "https://stackoverflow.com/questions/31559325/jump-to-cell-clicking-on-button/31559400#31559400", "title": "Jump to cell clicking on button", "body": "<p>Have you tried using <code>select</code> instead of <code>msgbox</code></p>\n\n<pre><code>Private Sub CommandButton3_Click()  \n\nSheets(\"Sheet2\").Activate  \n\nDim rng As Range  \nDim ws1, ws2 As Worksheet  \nDim MyStringVar1 As String  \n\nSet ws1 = ThisWorkbook.Sheets(\"Sheet1\")   \nSet ws2 = ThisWorkbook.Sheets(\"Sheet2\")   \nSet rng = ws1.Range(\"c4\")   \n\nWith ws1     \n\n   MyStringVar1 = Application.WorksheetFunction.VLookup(rng, ws2.Range(\"b3:n13\").Value, 5, False)   \n\n    On Error GoTo 0    \n   If MyStringVar1 = \"\" Then MsgBox \"Item not found\" Else MyStringVar1.Select\n\nEnd With    \n\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 21, "user_id": 5142822, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc5d66f4f8165c4fe03c07d018f921d3?s=128&d=identicon&r=PG&f=1", "display_name": "Sandeep Shivaraman", "link": "https://stackoverflow.com/users/5142822/sandeep-shivaraman"}, "edited": false, "score": 0, "creation_date": 1437560630, "post_id": 31559657, "comment_id": 51076777, "body": "Sorry Davesexcel, I want to tell u that I have value in cell C4 in Sheet1 which is an employee number, and when button in sheet1 is clicked it will look for the the value in  Sheet2 and when that employee number found the cursor will go to the coloumn no. 5 ..."}, {"owner": {"reputation": 21, "user_id": 5142822, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc5d66f4f8165c4fe03c07d018f921d3?s=128&d=identicon&r=PG&f=1", "display_name": "Sandeep Shivaraman", "link": "https://stackoverflow.com/users/5142822/sandeep-shivaraman"}, "edited": false, "score": 0, "creation_date": 1437560973, "post_id": 31559657, "comment_id": 51077014, "body": "Sorry Davesexcel, I want to tell u that I have value in cell C4 in Sheet1 which is an employee number, and when button in sheet1 is clicked it will look for the the value in  Sheet2 and when that employee number found the cursor will go to the coloumn no. 5 ..."}, {"owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "reply_to_user": {"reputation": 21, "user_id": 5142822, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc5d66f4f8165c4fe03c07d018f921d3?s=128&d=identicon&r=PG&f=1", "display_name": "Sandeep Shivaraman", "link": "https://stackoverflow.com/users/5142822/sandeep-shivaraman"}, "edited": false, "score": 0, "creation_date": 1437569632, "post_id": 31559657, "comment_id": 51083031, "body": "Oh yes, I changed it to search column B and then it should go to column &quot;F&quot;"}, {"owner": {"reputation": 21, "user_id": 5142822, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc5d66f4f8165c4fe03c07d018f921d3?s=128&d=identicon&r=PG&f=1", "display_name": "Sandeep Shivaraman", "link": "https://stackoverflow.com/users/5142822/sandeep-shivaraman"}, "edited": false, "score": 0, "creation_date": 1437736788, "post_id": 31559657, "comment_id": 51168034, "body": "The same thing i am doing with userform in excel. Now I have a textbox1 for employee number and textbox2 for employee name, the same is in sheet2 with ColumnA and ColumnB&gt; Now when i enter the employee number in textbox1 the name is appearing in textbox2 and also a button to change the value of textbox2. I want the button when clicked go to the    corresponding name field.."}, {"owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "reply_to_user": {"reputation": 21, "user_id": 5142822, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc5d66f4f8165c4fe03c07d018f921d3?s=128&d=identicon&r=PG&f=1", "display_name": "Sandeep Shivaraman", "link": "https://stackoverflow.com/users/5142822/sandeep-shivaraman"}, "edited": false, "score": 0, "creation_date": 1437740004, "post_id": 31559657, "comment_id": 51170078, "body": "&quot;Thanks Davesexcel, this code is working for button in sheet.... Thanks&quot;- You could mark my answer as the answer, then ask a new question."}], "tags": [], "owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "is_accepted": false, "score": 0, "last_activity_date": 1437569543, "last_edit_date": 1437569543, "creation_date": 1437558613, "answer_id": 31559657, "question_id": 31559325, "link": "https://stackoverflow.com/questions/31559325/jump-to-cell-clicking-on-button/31559657#31559657", "title": "Jump to cell clicking on button", "body": "<p>Try find instead.</p>\n\n<pre><code>Sub UsingFind()\n    Dim ws As Worksheet, sh As Worksheet\n    Dim Rws As Long, Rng As Range, c As Range, lookRng As Range\n\n    Set ws = Worksheets(\"Sheet1\")\n    Set sh = Worksheets(\"Sheet2\")\n\n    With sh\n        Rws = .Cells(Rows.Count, \"B\").End(xlUp).Row\n        Set Rng = .Range(.Cells(1, \"B\"), .Cells(Rws, \"B\"))\n    End With\n\n    Set lookRng = ws.Range(\"C4\")\n    Set c = Rng.Find(what:=lookRng, lookat:=xlWhole)\n\n    If Not c Is Nothing Then\n        Application.Goto Reference:=c.OFFSET(0,4)\n    Else: MsgBox \"Not Found\"\n        Exit Sub\n    End If\nEnd Sub\n</code></pre>\n\n<p><a href=\"http://www.xlorate.com/vba-examples.html#Find%20Data%20in%20other%20Sheet\" rel=\"nofollow\">Find data in another sheet</a></p>\n"}, {"comments": [{"owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "edited": false, "score": 0, "creation_date": 1437740124, "post_id": 31561192, "comment_id": 51170152, "body": "@nad- My answer is VBA only."}], "tags": [], "owner": {"reputation": 41, "user_id": 4935612, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iniZ3.jpg?s=128&g=1", "display_name": "nad", "link": "https://stackoverflow.com/users/4935612/nad"}, "is_accepted": false, "score": 0, "last_activity_date": 1437562743, "creation_date": 1437562743, "answer_id": 31561192, "question_id": 31559325, "link": "https://stackoverflow.com/questions/31559325/jump-to-cell-clicking-on-button/31561192#31561192", "title": "Jump to cell clicking on button", "body": "<p>i would advice you to depend strictly on VB code by using for loop\nscanning sheet2 column 1 for the equal value, once found it will set the focus on the same row column 5, in the below example code will check for only 10 rows you can adjust that as you like. </p>\n\n<pre><code>Sub usingvbonly()\nDim key As String\nSheets(\"sheet1\").Select\nkey = Cells(4, 3).Value 'Value in sheet1 range(\"C4\")\nSheets(\"sheet2\").Select\nFor i = 1 To 10 Step 1\nIf Cells(i, 1).Value = key Then\nCells(i, 5).Select\nEnd If\nNext i\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 5142822, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc5d66f4f8165c4fe03c07d018f921d3?s=128&d=identicon&r=PG&f=1", "display_name": "Sandeep Shivaraman", "link": "https://stackoverflow.com/users/5142822/sandeep-shivaraman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1238, "favorite_count": 0, "answer_count": 3, "score": 2, "last_activity_date": 1437569543, "creation_date": 1437557755, "last_edit_date": 1531161705, "question_id": 31559325, "link": "https://stackoverflow.com/questions/31559325/jump-to-cell-clicking-on-button", "title": "Jump to cell clicking on button", "body": "<p>I have a excel vb code in which i made a button in excel when clicked go to next sheet and search for the value based on employee number. I used Vlookup in this code. My problem is the cursor should go to the searched cell directly. My code goes below:-</p>\n\n<pre><code>Private Sub CommandButton3_Click()  \n Sheets(\"Sheet2\").Activate  \n\nDim rng As Range  \nDim ws1, ws2 As Worksheet  \nDim MyStringVar1 As String  \n\nSet ws1 = ThisWorkbook.Sheets(\"Sheet1\")   \nSet ws2 = ThisWorkbook.Sheets(\"Sheet2\")   \nSet rng = ws1.Range(\"c4\")   \n\nWith ws1     \n\n   MyStringVar1 = Application.WorksheetFunction.VLookup(rng, ws2.Range(\"b3:n13\").Value, 5, False)   \n\n    On Error GoTo 0    \n   If MyStringVar1 = \"\" Then MsgBox \"Item not found\" Else MsgBox MyStringVar1   \n\nEnd With    \n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 3812, "user_id": 1481116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d0c940ad90baf5f93d7ab07933d2e17?s=128&d=identicon&r=PG", "display_name": "Luuklag", "link": "https://stackoverflow.com/users/1481116/luuklag"}, "edited": false, "score": 0, "creation_date": 1437557545, "post_id": 31559086, "comment_id": 51074604, "body": "Range(Cells(row1, 11).Address, Cells(row1, 23).Address) = Application.Index(Agron_Array(row, Array(5, 6, 7, 8, 9, 10, 11, 12, 13, 15, 16, 17, 18)))"}, {"owner": {"reputation": 3812, "user_id": 1481116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d0c940ad90baf5f93d7ab07933d2e17?s=128&d=identicon&r=PG", "display_name": "Luuklag", "link": "https://stackoverflow.com/users/1481116/luuklag"}, "edited": false, "score": 0, "creation_date": 1437557594, "post_id": 31559086, "comment_id": 51074641, "body": "This is what I made out of it, as it was expecting those brackets after Index, however I get an Run-time error 13: Type mismatch now."}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "reply_to_user": {"reputation": 3812, "user_id": 1481116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d0c940ad90baf5f93d7ab07933d2e17?s=128&d=identicon&r=PG", "display_name": "Luuklag", "link": "https://stackoverflow.com/users/1481116/luuklag"}, "edited": false, "score": 0, "creation_date": 1437557766, "post_id": 31559086, "comment_id": 51074739, "body": "Sorry - I just corrected the typos in my answer. Please try the amended code."}], "tags": [], "owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "is_accepted": true, "score": 1, "last_activity_date": 1437557727, "last_edit_date": 1437557727, "creation_date": 1437557128, "answer_id": 31559086, "question_id": 31558932, "link": "https://stackoverflow.com/questions/31558932/pasting-certain-columns-from-an-array-into-1-range/31559086#31559086", "title": "Pasting certain columns from an array into 1 range", "body": "<p>You can use <code>Index</code> with an array of column indices:</p>\n\n<pre><code>Range(Cells(row1,11).Address,Cells(row1,23).Address) = _\nApplication.Index(Agron_Array, row, Array(5, 6, 7, 8, 9, 10, 11, 12, 13, 15, 16, 17, 18))\n</code></pre>\n"}], "owner": {"reputation": 3812, "user_id": 1481116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d0c940ad90baf5f93d7ab07933d2e17?s=128&d=identicon&r=PG", "display_name": "Luuklag", "link": "https://stackoverflow.com/users/1481116/luuklag"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1418, "favorite_count": 1, "accepted_answer_id": 31559086, "answer_count": 1, "score": 0, "last_activity_date": 1437557727, "creation_date": 1437556686, "last_edit_date": 1531164843, "question_id": 31558932, "link": "https://stackoverflow.com/questions/31558932/pasting-certain-columns-from-an-array-into-1-range", "title": "Pasting certain columns from an array into 1 range", "body": "<p>Is there a way to copy certain columns from 1 array into 1 range. My problem is that not only the first few columns I want to omit, which should be easy, but also one column in the middle. However I need that column in the middle to validate against. Is there an easy way to skip that column when copying a row from the array into a worksheet? Or is the only way around to make that column the first or the last column when building the array?</p>\n\n<p>The code I have until now is:</p>\n\n<pre><code>For row1 = 2 To TotalRowsMerged\n    For row = 2 To TotalRowsAgron\n        If Cells(row1, 1) = Agron_Array(row, 1) And Cells(row1, 2) = Agron_Array(row, 2) Then\n            Range(Cells(row1,11).Address,Cells(row1,23).Address) = Agron_Array(row,\n</code></pre>\n\n<p>The columns that I need are: 5 to 13 and 15 to 18, so in total 13, which is the same size as my range.</p>\n"}, {"tags": ["vba", "excel", "compiler-errors"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2140173"}, "edited": false, "score": 1, "creation_date": 1437556430, "post_id": 31558718, "comment_id": 51073810, "body": "what&#39;s the actual value of <code>lastRow</code>? Also I don&#39;t know if it&#39;s just a typo but you&#39;re missing double quotes for <code>AH2</code>,<code>AI2</code>,<code>AJ2</code>,<code>AK2</code>,AL2`"}, {"owner": {"reputation": 25, "user_id": 5092932, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RnUAi.jpg?s=128&g=1", "display_name": "Ben0708", "link": "https://stackoverflow.com/users/5092932/ben0708"}, "edited": false, "score": 0, "creation_date": 1437556496, "post_id": 31558718, "comment_id": 51073844, "body": "It changes dependent on the values pulled from database, hence why i tried to make it line up to column B as this is the column pulled that is guaranteed to have data in."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1437556570, "post_id": 31558718, "comment_id": 51073909, "body": "All of the <code>Range(AH2).Formula = ...</code> should be <code>Range(&quot;AH2&quot;).Formula = ...</code>."}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 3, "creation_date": 1437556723, "post_id": 31558718, "comment_id": 51074035, "body": "FWIW it would be much more efficient to use one MATCH formula for each row and then several INDEX formulas rather than using multiple VLOOKUPs which have to lookup the same value 6 times for each row."}, {"owner": {"reputation": 25, "user_id": 5092932, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RnUAi.jpg?s=128&g=1", "display_name": "Ben0708", "link": "https://stackoverflow.com/users/5092932/ben0708"}, "edited": false, "score": 0, "creation_date": 1437556827, "post_id": 31558718, "comment_id": 51074088, "body": "Ok that&#39;s solved that problem. Now how can i make it run for the column length of B of a separate sheet?"}, {"owner": {"reputation": 25, "user_id": 5092932, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RnUAi.jpg?s=128&g=1", "display_name": "Ben0708", "link": "https://stackoverflow.com/users/5092932/ben0708"}, "edited": false, "score": 0, "creation_date": 1437556941, "post_id": 31558718, "comment_id": 51074179, "body": "Also thanks Rory i&#39;ll try setting it up with a match too. I&#39;m completely new to VBA and well anything beyond simple excel as just graduated university and first job, kind of learning the ropes as i go."}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 2, "creation_date": 1437557403, "post_id": 31559093, "comment_id": 51074527, "body": "You should be putting those into the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff838835.aspx\" rel=\"nofollow noreferrer\">Range.Formula property</a>. If the cell was formatted as text, it would show the formula  as a text string."}], "tags": [], "owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "is_accepted": false, "score": 0, "last_activity_date": 1437557159, "creation_date": 1437557159, "answer_id": 31559093, "question_id": 31558718, "link": "https://stackoverflow.com/questions/31558718/error-400-message-dont-know-how-to-solve-it-for-formula/31559093#31559093", "title": "Error 400 Message - Don&#39;t know how to solve it for formula", "body": "<p>As mentioned the quotes are missing.</p>\n\n<p>You can also make the code more readable by just using one line for each formula.\nFor example:</p>\n\n<pre><code>Dim LastRow As Long\n\nLastRow = Range(\"B\" &amp; Rows.Count).End(xlUp).Row\n\nRange(\"AF2:AF\" &amp; LastRow) = \"=firstPart($G2)\"\nRange(\"AG2:AG\" &amp; LastRow) = \"=VLOOKUP($AF2,'Naming Lookup'!$A$2:$G$10815,2,FALSE)\"\nRange(\"AH2:AH\" &amp; LastRow) = \"=VLOOKUP($AF2,'Naming Lookup'!$A$2:$G$10815,3,FALSE)\"\nRange(\"AI2:AI\" &amp; LastRow) = \"=VLOOKUP($AF2,'Naming Lookup'!$A$2:$G$10815,4,FALSE)\"\n'ect\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 25, "user_id": 5092932, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RnUAi.jpg?s=128&g=1", "display_name": "Ben0708", "link": "https://stackoverflow.com/users/5092932/ben0708"}, "edited": false, "score": 0, "creation_date": 1437557780, "post_id": 31559299, "comment_id": 51074746, "body": "Thanks Rory that&#39;s perfect exactly what i needed to use another sheet."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2140173"}, "edited": false, "score": 0, "creation_date": 1437557967, "post_id": 31559299, "comment_id": 51074891, "body": "Rory, as far as I remember the <code>.ScreenUpdating</code> is automatically turned back ON when a macro stops running. Besides that ++"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 1, "creation_date": 1437558406, "post_id": 31559299, "comment_id": 51075174, "body": "@Meehow Generally yes, unless you end the code manually. My rule is to <b>explicitly</b> turn stuff back on if you turned it off."}, {"owner": {"reputation": 25, "user_id": 5092932, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RnUAi.jpg?s=128&g=1", "display_name": "Ben0708", "link": "https://stackoverflow.com/users/5092932/ben0708"}, "edited": false, "score": 0, "creation_date": 1437559035, "post_id": 31559299, "comment_id": 51075646, "body": "@Rory This might be a bit simple but what does the lCalc part do?"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "reply_to_user": {"reputation": 25, "user_id": 5092932, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RnUAi.jpg?s=128&g=1", "display_name": "Ben0708", "link": "https://stackoverflow.com/users/5092932/ben0708"}, "edited": false, "score": 1, "creation_date": 1437559323, "post_id": 31559299, "comment_id": 51075857, "body": "@Ben0708 It stores the current calculation setting so it can be reinstated at the end. It&#39;s better than assuming it should be automatic."}, {"owner": {"reputation": 25, "user_id": 5092932, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RnUAi.jpg?s=128&g=1", "display_name": "Ben0708", "link": "https://stackoverflow.com/users/5092932/ben0708"}, "edited": false, "score": 0, "creation_date": 1437562442, "post_id": 31559299, "comment_id": 51077954, "body": "Ah thanks that&#39;s perfect. Also think the formula range at the last section should be AF2 not AG2, unless the AF is covered previously."}], "tags": [], "owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "is_accepted": true, "score": 4, "last_activity_date": 1437563823, "last_edit_date": 1437563823, "creation_date": 1437557684, "answer_id": 31559299, "question_id": 31558718, "link": "https://stackoverflow.com/questions/31558718/error-400-message-dont-know-how-to-solve-it-for-formula/31559299#31559299", "title": "Error 400 Message - Don&#39;t know how to solve it for formula", "body": "<p>I would do it something like this:</p>\n\n<pre><code>Sub FillWorksheet1()\n    Dim lastRow               As Long\n    Dim lCalc                 As XlCalculation\n\n    With Application\n        .ScreenUpdating = False\n        lCalc = .Calculation\n        .Calculation = xlCalculationManual\n    End With\n\n    lastRow = Sheets(\"some other sheet\").Range(\"B\" &amp; Rows.Count).End(xlUp).Row\n\n    Range(\"AF2\").Formula = \"=firstPart($G2)\"\n    Range(\"AG2\").Formula = \"=MATCH($AF2,'Naming Lookup'!$A$2:$A$10815,0)\"\n    Range(\"AH2:AM2\").Formula = \"=INDEX('Naming Lookup'!B$2:B$10815,$AG2)\"\n    Range(\"AF2:AM2\").AutoFill Destination:=Range(\"AF2:AM\" &amp; lastRow)\n    ActiveSheet.AutoFilterMode = False\n\n    With Application\n        .Calculation = lCalc\n        .ScreenUpdating = True\n    End With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 5092932, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RnUAi.jpg?s=128&g=1", "display_name": "Ben0708", "link": "https://stackoverflow.com/users/5092932/ben0708"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 753, "favorite_count": 1, "accepted_answer_id": 31559299, "answer_count": 2, "score": 1, "last_activity_date": 1462526864, "creation_date": 1437556093, "last_edit_date": 1462526864, "question_id": 31558718, "link": "https://stackoverflow.com/questions/31558718/error-400-message-dont-know-how-to-solve-it-for-formula", "title": "Error 400 Message - Don&#39;t know how to solve it for formula", "body": "<p>Hi I've put together this VBA from looking through posts on this website which enables me to run a formula down a sheet for all the values. However everytime i run it i get an error 400 message. Where have i done it wrong furthermore how would i make this vba work for using a length determined by a column on another sheet.</p>\n\n<pre><code>Sub FillWorksheet1()\n\nApplication.ScreenUpdating = False\n\nlastRow = Range(\"B\" &amp; Rows.Count).End(xlUp).Row\n\nRange(\"AF2\").Formula = \"=firstPart($G2)\"\nRange(\"AF2\").AutoFill Destination:=Range(\"AF2:AF\" &amp; lastRow)\n\nRange(\"AG2\").Formula = \"=VLOOKUP($AF2,'Naming Lookup'!$A$2:$G$10815,2,FALSE)\"\nRange(\"AG2\").AutoFill Destination:=Range(\"AG2:AG\" &amp; lastRow)\n\nRange(AH2).Formula = \"=VLOOKUP($AF2,'Naming Lookup'!$A$2:$G$10815,3,FALSE)\"\nRange(\"AH2\").AutoFill Destination:=Range(\"AH2:AH\" &amp; lastRow)\n\nRange(AI2).Formula = \"=VLOOKUP($AF2,'Naming Lookup'!$A$2:$G$10815,4,FALSE)\"\nRange(\"AI2\").AutoFill Destination:=Range(\"AI2:AI\" &amp; lastRow)\n\nRange(AJ2).Formula = \"=VLOOKUP($AF2,'Naming Lookup'!$A$2:$G$10815,5,FALSE)\"\nRange(\"AJ2\").AutoFill Destination:=Range(\"AJ2:AJ\" &amp; lastRow)\n\nRange(AK2).Formula = \"=VLOOKUP($AF2,'Naming Lookup'!$A$2:$G$10815,6,FALSE)\"\nRange(\"AK2\").AutoFill Destination:=Range(\"AK2:AK\" &amp; lastRow)\n\nRange(AL2).Formula = \"=VLOOKUP($AF2,'Naming Lookup'!$A$2:$G$10815,7,FALSE)\"\nRange(\"AL2\").AutoFill Destination:=Range(\"AL2:AL\" &amp; lastRow)\nActiveSheet.AutoFilterMode = False\n\nApplication.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n\n<p>Any help would be much appreciated.</p>\n\n<p>The firstPart formula was created by a VBA to remove text following numbers to allow product codes to be gathered not just customer specific ones.</p>\n"}, {"tags": ["excel", "excel-formula", "excel-2007", "vba"], "answers": [{"comments": [{"owner": {"reputation": 905, "user_id": 4546587, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/VXhNQ.jpg?s=128&g=1", "display_name": "Linga", "link": "https://stackoverflow.com/users/4546587/linga"}, "edited": false, "score": 0, "creation_date": 1437558593, "post_id": 31559096, "comment_id": 51075328, "body": "Thanks a lot Gordon K :)"}], "tags": [], "owner": {"reputation": 824, "user_id": 5023092, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FNreo.png?s=128&g=1", "display_name": "Gordon K", "link": "https://stackoverflow.com/users/5023092/gordon-k"}, "is_accepted": true, "score": 1, "last_activity_date": 1437557161, "creation_date": 1437557161, "answer_id": 31559096, "question_id": 31558421, "link": "https://stackoverflow.com/questions/31558421/generating-serial-no-based-on-two-criterias/31559096#31559096", "title": "Generating serial no based on two criterias", "body": "<p>Highlight your ID and description columns and go to the data tab on the ribbon and select <strong>Advanced</strong> in the Sort &amp; Filter section.</p>\n\n<p>Choose <em>Copy to another location</em>, tick the <em>Unique records only</em> box, select somewhere to the right of your data as the <em>Copy to</em> location and press <em>OK</em>.</p>\n\n<p>This will give you a set of all the combinations which can then be numbered sequentially.</p>\n"}], "owner": {"reputation": 905, "user_id": 4546587, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/VXhNQ.jpg?s=128&g=1", "display_name": "Linga", "link": "https://stackoverflow.com/users/4546587/linga"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 31, "favorite_count": 0, "accepted_answer_id": 31559096, "answer_count": 1, "score": 0, "last_activity_date": 1437557161, "creation_date": 1437555295, "last_edit_date": 1531161705, "question_id": 31558421, "link": "https://stackoverflow.com/questions/31558421/generating-serial-no-based-on-two-criterias", "title": "Generating serial no based on two criterias", "body": "<p>I have Prod_ID which is unique and description which will be same for different prod_ID. I need to generate serial no like Group 1, Group 2 based on both criteria . Serial no should be unique for one prod_ID &amp; description. Is there any formula or macro to do this asap, because i have 50,000 + rows.</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>Serial\tID\tDescription\r\nGroup 1\t30-0661\tMedium\r\nGroup 1\t30-0661\tMedium\r\nGroup 1\t30-0661\tMedium\r\nGroup 1\t30-0661\tMedium\r\nGroup 2\t30-0661\tNarrow\r\nGroup 2\t30-0661\tNarrow\r\nGroup 2\t30-0661\tNarrow\r\nGroup 3\t30-0661\tWide\r\nGroup 3\t30-0661\tWide\r\nGroup 3\t30-0661\tWide\r\nGroup 3\t30-0661\tWide\r\nGroup 3\t30-0661\tWide\r\nGroup 4\t30-0661\tExtra Wide\r\nGroup 4\t30-0661\tExtra Wide\r\nGroup 4\t30-0661\tExtra Wide\r\nGroup 4\t30-0661\tExtra Wide\r\nGroup 4\t30-0661\tExtra Wide\r\nGroup 5\t30-0662\tMedium\r\nGroup 5\t30-0662\tMedium\r\nGroup 5\t30-0662\tMedium\r\nGroup 5\t30-0662\tMedium\r\nGroup 5\t30-0662\tMedium\r\nGroup 5\t30-0662\tMedium\r\nGroup 5\t30-0662\tMedium\r\nGroup 5\t30-0662\tMedium\r\nGroup 6\t30-0662\tNarrow\r\nGroup 6\t30-0662\tNarrow\r\nGroup 6\t30-0662\tNarrow\r\nGroup 6\t30-0662\tNarrow\r\nGroup 6\t30-0662\tNarrow\r\nGroup 6\t30-0662\tNarrow\r\nGroup 6\t30-0662\tNarrow\r\nGroup 6\t30-0662\tNarrow</code></pre>\r\n</div>\r\n</div>\r\n</p>\n"}, {"tags": ["vba", "excel", "excel-2007"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2140173"}, "edited": false, "score": 0, "creation_date": 1437555118, "post_id": 31558274, "comment_id": 51072877, "body": "Look up <a href=\"https://msdn.microsoft.com/en-us/library/office/ff822605.aspx\" rel=\"nofollow noreferrer\"><b><code>Borders</code></b> property of <code>Range</code> class</a> and set it to like <code>Range(&quot;yourNamedRange&quot;).Borders.LineStyle = xlNone</code>. When you are using <code>Selection.Delete</code> you are literally deleting everything in the selected area along with formulas and formatting - probably something you want to avoid assuming you want to keep the formulas?"}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2140173"}, "edited": false, "score": 0, "creation_date": 1437556041, "post_id": 31558537, "comment_id": 51073550, "body": "Good stuff ++ Iturner"}], "tags": [], "owner": {"reputation": 2765, "user_id": 4646304, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/cb7e0e8a97f18e0cc2ddfb28552ff6d5?s=128&d=identicon&r=PG&f=1", "display_name": "luke_t", "link": "https://stackoverflow.com/users/4646304/luke-t"}, "is_accepted": true, "score": 2, "last_activity_date": 1437556020, "last_edit_date": 1437556020, "creation_date": 1437555605, "answer_id": 31558537, "question_id": 31558274, "link": "https://stackoverflow.com/questions/31558274/delete-rows-without-loosing-the-formula-in-excel-using-vba/31558537#31558537", "title": "delete rows without loosing the formula in excel using vba", "body": "<p>You can use the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff196576.aspx\" rel=\"nofollow\"><code>ClearFormats()</code> method</a>, this will remove the table border.</p>\n\n<p>Also, to clear contents, you do not have to first select the range. Take an advantage of the <a href=\"https://msdn.microsoft.com/en-us/library/wc500chb.aspx\" rel=\"nofollow\"><code>With</code> statement</a> </p>\n\n<pre><code>With Range(\"X\")\n    .ClearContents\n    .ClearFormats\nEnd With\n</code></pre>\n\n<p>The above should achieve what you're after.</p>\n"}], "owner": {"reputation": 231, "user_id": 4144995, "user_type": "registered", "accept_rate": 41, "profile_image": "https://lh3.googleusercontent.com/-O_Mtu9ao818/AAAAAAAAAAI/AAAAAAAAAJ0/gqZrykBXfzs/photo.jpg?sz=128", "display_name": "S K padala", "link": "https://stackoverflow.com/users/4144995/s-k-padala"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 877, "favorite_count": 0, "accepted_answer_id": 31558537, "answer_count": 1, "score": 1, "last_activity_date": 1437556020, "creation_date": 1437554906, "question_id": 31558274, "link": "https://stackoverflow.com/questions/31558274/delete-rows-without-loosing-the-formula-in-excel-using-vba", "title": "delete rows without loosing the formula in excel using vba", "body": "<p>I have an excel sheet in which there is one table with a drop down and one normal excel cell. I try to clear the contents of the table and I have done it through</p>\n\n<pre><code>range(\"X\").ClearContents\n</code></pre>\n\n<p>but the problem with it is it is going to clearing the content but I'm able to see the table borders with it.</p>\n\n<p>When I have used </p>\n\n<pre><code>Range(\"X\").Select\nApplication.DisplayAlerts = False\nSelection.Delete\nApplication.DisplayAlerts = True\nRange(\"X\").Select\nSelection.ClearContents\n</code></pre>\n\n<p>It deletes the table (both content and borders) but it I can see the formula in the drop down is missing ie the drop down cell has become normal cell.</p>\n\n<p>Thanks in Advance!</p>\n"}, {"tags": ["vba", "ms-word"], "answers": [{"comments": [{"owner": {"reputation": 2653, "user_id": 1068470, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/b479cae944c0938546a8af85141e401a?s=128&d=identicon&r=PG&f=1", "display_name": "ThePerson", "link": "https://stackoverflow.com/users/1068470/theperson"}, "edited": false, "score": 0, "creation_date": 1437570853, "post_id": 31559274, "comment_id": 51083938, "body": "Many thanks for these ideas, they gave me another thing to look at. In the end, I found even if I copy/pasted a character from another location into the document that it was changing to font to Calibri. When creating a new document, I had the same issue. However, I have an old document that was created around 2003 and I found even on the same version of office (2013 I am on), the macro works. I think something is going on when creating word documents, perhaps some setting to do with unicode or some internal format differneces, as my above macros work fine on the old document."}, {"owner": {"reputation": 2653, "user_id": 1068470, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/b479cae944c0938546a8af85141e401a?s=128&d=identicon&r=PG&f=1", "display_name": "ThePerson", "link": "https://stackoverflow.com/users/1068470/theperson"}, "edited": false, "score": 0, "creation_date": 1437570941, "post_id": 31559274, "comment_id": 51083993, "body": "My final solution is to use the old document, copy all my macros into it, and it works fine. I am still totally at a loss as to why this is. I can still create new documents, on which my macro does not work. Both files are .dotm, the only difference is the machine they were originally created on the version of office. Upvote given though as your answer was sensible and some good things to try, many thanks."}], "tags": [], "owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "is_accepted": false, "score": 1, "last_activity_date": 1437557628, "creation_date": 1437557628, "answer_id": 31559274, "question_id": 31558157, "link": "https://stackoverflow.com/questions/31558157/vba-word-selection-typetext-changing-font/31559274#31559274", "title": "VBA Word Selection.TypeText changing font?", "body": "<p>This is only an idea: there is a difference between a paragraph having a font and a [sequence of] letter[s] having a font. If the paragraph has your <code>myFont</code> font, then the inserted text should be your font; otherwise it may revert to the paragraph's font (default for all text of the paragraph unless set to a different font).</p>\n\n<p>If the selection is empty, i.e. you are refering to the insertion point, and you set the font, then the font for the next character is set. However, the <code>TypeText</code> method inserts it <em>before</em> the insertion point, so your set font has no effect.</p>\n\n<p>As for your last attempt, to select the inserted character and set its font, I have no idea why that shouldn't work. Try following setting the font to print the size and font name of the selection (the selection should now be 1 characters in size).</p>\n\n<p>You might also try using the <code>InsertAfter</code> or <code>InsertBefore</code> methods of the <code>Selection</code> object.</p>\n"}, {"tags": [], "owner": {"reputation": 2709, "user_id": 4579015, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/56bbb7da70756a6470a57e2ee5ca341f?s=128&d=identicon&r=PG&f=1", "display_name": "LocEngineer", "link": "https://stackoverflow.com/users/4579015/locengineer"}, "is_accepted": false, "score": 1, "last_activity_date": 1437570611, "creation_date": 1437570611, "answer_id": 31564140, "question_id": 31558157, "link": "https://stackoverflow.com/questions/31558157/vba-word-selection-typetext-changing-font/31564140#31564140", "title": "VBA Word Selection.TypeText changing font?", "body": "<p>If you want to use Selection, this here worked just fine for me:</p>\n\n<pre><code>With Selection\n    .Font.Name = \"Arial Unicode MS\"\n    .Text = \"Umlaut test \u00e4 \u00f6 \u00fc \u00df\"\nEnd With\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2653, "user_id": 1068470, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/b479cae944c0938546a8af85141e401a?s=128&d=identicon&r=PG&f=1", "display_name": "ThePerson", "link": "https://stackoverflow.com/users/1068470/theperson"}, "is_accepted": false, "score": 0, "last_activity_date": 1437571137, "creation_date": 1437571137, "answer_id": 31564345, "question_id": 31558157, "link": "https://stackoverflow.com/questions/31558157/vba-word-selection-typetext-changing-font/31564345#31564345", "title": "VBA Word Selection.TypeText changing font?", "body": "<p>Many thanks for these ideas, they gave me another thing to look at. In the end, I found even if I copy/pasted a character from another location into the document that it was changing to font to Calibri. When creating a brand new document with nothing else into it and running the macro in my question, I had the same issue. However, I have an old document that was created around 2003 and I found when running even on the same version of office (2013 I am on), the macro works. I think something is going on when creating word documents, perhaps some default setting or perhaps some internal format differences, as my above macros work fine on the old document but not on any new documents I create. </p>\n\n<p>My final solution is to use the old document, copy all my macros into it, and it works fine, even saved as a dotm file and when saved using my 2013 version of office. I am still totally at a loss as to why this is. I can still create new documents on which my macro does not work. Both files are .dotm, the only difference is the machine they were originally created on the version of office. </p>\n\n<p>I hope this helps anyone else with the same problem, it's cost me about a day of pulling my hair out.</p>\n"}], "owner": {"reputation": 2653, "user_id": 1068470, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/b479cae944c0938546a8af85141e401a?s=128&d=identicon&r=PG&f=1", "display_name": "ThePerson", "link": "https://stackoverflow.com/users/1068470/theperson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4228, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1437571137, "creation_date": 1437554536, "question_id": 31558157, "link": "https://stackoverflow.com/questions/31558157/vba-word-selection-typetext-changing-font", "title": "VBA Word Selection.TypeText changing font?", "body": "<p>I have a font which has lots of special unicode characters in, I would like to type them into a word document using a macro. </p>\n\n<p>A very simplified version looks like this:</p>\n\n<pre><code>Sub Macro2()\n    Selection.TypeText (ChrW(58081))\nEnd Sub\n</code></pre>\n\n<p>I can see using BabelMap (a font viewer), that the character at decimal 58081 is the one I want to enter.</p>\n\n<p><strong>The Issue</strong></p>\n\n<p>When I run this macro, the font changes from the font with the special characters to \"Calibri\" which is the default. This causes the character to show up as a square box similar to \ue2e1</p>\n\n<p>If I then manually highlight the square box and change it to my desired font, it corrects itself and shows up.</p>\n\n<p><strong>What I have tried</strong></p>\n\n<p>I have tried setting the font again before typing the text, it doesn't make a difference:</p>\n\n<pre><code>With Selection\n        .font.Name = \"MyFont\"\nEnd With\nSelection.TypeText (ChrW(58081))\n</code></pre>\n\n<p>I have also tried adding to the macro to go back and change the font after inserting it. This doesn't make a difference either, the code I use is this:</p>\n\n<pre><code>With Selection\n        .font.Name = \"MyFont\"\nEnd With\n\nSelection.TypeText (ChrW(58081))\n\nSelection.MoveLeft Unit:=wdCharacter, Count:=1, Extend:=wdExtend\nSelection.font.Name = \"MyFont\"\nSelection.MoveRight Unit:=wdCharacter, Count:=1\n</code></pre>\n\n<p><strong>A useful observation</strong></p>\n\n<p>When I enter a character within a normal set, e.g:</p>\n\n<pre><code>Selection.TypeText (ChrW(97))\n</code></pre>\n\n<p>This works without changing the font as I expect - why does the font change when I enter 58081?</p>\n"}, {"tags": ["vba", "excel", "range", "inputbox"], "comments": [{"owner": {"reputation": 2605, "user_id": 4846598, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/56c681dc497676a33de782f84bc7a87f?s=128&d=identicon&r=PG&f=1", "display_name": "Hearner", "link": "https://stackoverflow.com/users/4846598/hearner"}, "edited": false, "score": 0, "creation_date": 1437553008, "post_id": 31557388, "comment_id": 51071600, "body": "You want a sheet a year ? Or you want to copy-paste everything"}], "answers": [{"tags": [], "owner": {"reputation": 1949, "user_id": 1723119, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/8182f3271d9881acad7c1a4d8844ca15?s=128&d=identicon&r=PG", "display_name": "99moorem", "link": "https://stackoverflow.com/users/1723119/99moorem"}, "is_accepted": true, "score": 0, "last_activity_date": 1437553462, "creation_date": 1437553462, "answer_id": 31557723, "question_id": 31557388, "link": "https://stackoverflow.com/questions/31557388/copy-multiple-ranges-indicated-by-inputbox/31557723#31557723", "title": "Copy multiple ranges indicated by inputbox", "body": "<p>Use below. Years entered like 2001,2002,2003,2004 etc</p>\n\n<pre><code>Sub Copyyear()\nDim Forecastyear As String\nDim Rng As Range\nDim cell As Range\n\nForecastyear = InputBox(\"Enter year(s) to forecast, for multiple year input as 2001,2002,2003 etc\")\n\nIf InStr(1, Forecastyear, \",\") &gt; 0 Then\n    sp = Split(Forecastyear, \",\")\n    For i = 0 To UBound(sp)\n        If Trim(sp(i)) &lt;&gt; \"\" Then\n            With Sheets(2)\n                For Each cell In .Range(\"A:A\")\n                    If cell.Value = CInt(sp(i)) Then 'find first occurrence of year\n                        Set Rng = cell\n                        Exit For\n                    End If\n                Next\n                '.Range(Rng.Address).Resize(52, 5).Select 'resize for 52 rows and 5 columns\n                Rng.Resize(52, 5).Copy Destination:=Sheets(\"Moving Average\").Range(\"A2\").Offset(0 + (52 * i), 0)\n            End With\n        End If\n    Next\nElse\n    If Trim(Forecastyear) &lt;&gt; \"\" Then\n        With Sheets(2)\n            For Each cell In .Range(\"A:A\")\n                If cell.Value = Forecastyear Then 'find first occurrence of year\n                    Set Rng = cell\n                    Exit For\n                End If\n            Next\n            '.Range(Rng.Address).Resize(52, 5).Select 'resize for 52 rows and 5 columns\n            Rng.Resize(52, 5).Copy Destination:=Sheets(\"Moving Average\").Range(\"A2\")\n        End With\n    End If\nEnd If\n\n'   Record in new sheet\nwith Worksheets(\"Moving Average\")\n    .Range(\"A1\").Value = \"YEAR\"\n    .Range(\"B1\").Value = \"WEEK\"\n    .Range(\"C1\").Value = \"AMOUNT\"\n    .Range(\"D1\").Value = \"TIME\"\n    .Range(\"E1\").Value = \"FORECAST\"\nend with\n\n'   next macro\n    AddForecastPerformance\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 5101981, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/0eb70673ab6c590caad256ffdb98e004?s=128&d=identicon&r=PG&f=1", "display_name": "vba_interested", "link": "https://stackoverflow.com/users/5101981/vba-interested"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 317, "favorite_count": 0, "accepted_answer_id": 31557723, "answer_count": 1, "score": 0, "last_activity_date": 1437553462, "creation_date": 1437552492, "question_id": 31557388, "link": "https://stackoverflow.com/questions/31557388/copy-multiple-ranges-indicated-by-inputbox", "title": "Copy multiple ranges indicated by inputbox", "body": "<p>Until now I have a Macro to look up a year and copy that to a new sheet. However, I may want this for multiple years. My dataset is structured as follow:</p>\n\n<pre><code>Col A   Col B   Col C   Col D   ColE\nYear    Week    Amount  time    forecast\n2000    1       368     2000w1  400\n2000    2       8646    2000w2  8500\nuntil...\n2014    52      46546   2014w52 47000\n</code></pre>\n\n<p>Until now, my macro is:</p>\n\n<pre><code>Sub Copyyear()\nDim Forecastyear As String\nDim Rng As Range\nDim cell As Range\n\nForecastyear = InputBox(\"Enter a year to forecast\")\n\nIf Trim(Forecastyear) &lt;&gt; \"\" Then\n    With Sheets(2)\n        For Each cell In .Range(\"A:A\")\n            If cell.Value = Forecastyear Then 'find first occurrence of year\n                Set Rng = cell\n                Exit For\n            End If\n        Next\n        '.Range(Rng.Address).Resize(52, 5).Select 'resize for 52 rows and 5 columns\n        Rng.Resize(52, 5).Copy Destination:=Sheets(\"Moving Average\").Range(\"A2\")\n    End With\nEnd If\n\n'   Record in new sheet\nWorksheets(\"Moving Average\").Select\n    Range(\"A1\").Value = \"YEAR\"\n    Range(\"B1\").Value = \"WEEK\"\n    Range(\"C1\").Value = \"AMOUNT\"\n    Range(\"D1\").Value = \"TIME\"\n    Range(\"E1\").Value = \"FORECAST\"\n\n'   next macro\n    AddForecastPerformance\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "outlook", "vbe"], "comments": [{"owner": {"reputation": 77, "user_id": 4755869, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/ad510cbdc79c8c1de004caf18257de29?s=128&d=identicon&r=PG&f=1", "display_name": "Kenneth Berg", "link": "https://stackoverflow.com/users/4755869/kenneth-berg"}, "edited": false, "score": 0, "creation_date": 1437549147, "post_id": 31556025, "comment_id": 51069410, "body": "I tried to add an outlook-vbe tag, but I don&#39;t have sufficient reputation points.  There seem to be sufficient issues with the vba editor that a vbe tag is warranted."}], "answers": [{"tags": [], "owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "is_accepted": false, "score": 0, "last_activity_date": 1437563796, "creation_date": 1437563796, "answer_id": 31561570, "question_id": 31556025, "link": "https://stackoverflow.com/questions/31556025/outlook-2013-vba-vbe-f8-sometimes-doesnt-work/31561570#31561570", "title": "Outlook 2013 VBA VBE F8 Sometimes Doesn&#39;t Work", "body": "<p>Most keyboards have the <strong>F Lock</strong> button which blocks all <strong>F</strong> buttons on the keyboard.</p>\n"}], "owner": {"reputation": 77, "user_id": 4755869, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/ad510cbdc79c8c1de004caf18257de29?s=128&d=identicon&r=PG&f=1", "display_name": "Kenneth Berg", "link": "https://stackoverflow.com/users/4755869/kenneth-berg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 95, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1593306523, "creation_date": 1437548421, "last_edit_date": 1593306523, "question_id": 31556025, "link": "https://stackoverflow.com/questions/31556025/outlook-2013-vba-vbe-f8-sometimes-doesnt-work", "title": "Outlook 2013 VBA VBE F8 Sometimes Doesn&#39;t Work", "body": "<p>When debugging code in the Outlook 2013 VBA Visual Basic Editor, sometimes the function key <strong>F8 Step Into</strong> is totally ignored.  The Debug Toolbar Step Into works just fine.  When this occurs it seems to go on for many lines of code, and then sometimes the F8 key will start to work again.  </p>\n"}, {"tags": ["sql-server", "ms-access", "vba", "ms-access-2007"], "comments": [{"owner": {"reputation": 710, "user_id": 5021236, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16637c5be814c194e7dde84f653d36d7?s=128&d=identicon&r=PG&f=1", "display_name": "jhTuppeny", "link": "https://stackoverflow.com/users/5021236/jhtuppeny"}, "edited": false, "score": 0, "creation_date": 1437592769, "post_id": 31555943, "comment_id": 51099104, "body": "Is the form bound to one or more recordsets? Have you tried using pass through queries in Access or views set up in SQL server to give you the recordset that you need?"}, {"owner": {"reputation": 179, "user_id": 1175126, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/ab4b2c2be2d15a8de913736575b61706?s=128&d=identicon&r=PG", "display_name": "user1175126", "link": "https://stackoverflow.com/users/1175126/user1175126"}, "reply_to_user": {"reputation": 710, "user_id": 5021236, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16637c5be814c194e7dde84f653d36d7?s=128&d=identicon&r=PG&f=1", "display_name": "jhTuppeny", "link": "https://stackoverflow.com/users/5021236/jhtuppeny"}, "edited": false, "score": 0, "creation_date": 1437637656, "post_id": 31555943, "comment_id": 51115575, "body": "Yes a lot of fields are bound. I see that the table gets locked in SQL with type LCK_M_IX. I haven&#39;t tried pass through queries. I&#39;ll see if I can create a view."}], "answers": [{"comments": [{"owner": {"reputation": 179, "user_id": 1175126, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/ab4b2c2be2d15a8de913736575b61706?s=128&d=identicon&r=PG", "display_name": "user1175126", "link": "https://stackoverflow.com/users/1175126/user1175126"}, "edited": false, "score": 0, "creation_date": 1437640874, "post_id": 31581909, "comment_id": 51117490, "body": "Are pass through queries good for update of tables? I hear they work well on select statements."}, {"owner": {"reputation": 710, "user_id": 5021236, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16637c5be814c194e7dde84f653d36d7?s=128&d=identicon&r=PG&f=1", "display_name": "jhTuppeny", "link": "https://stackoverflow.com/users/5021236/jhtuppeny"}, "reply_to_user": {"reputation": 179, "user_id": 1175126, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/ab4b2c2be2d15a8de913736575b61706?s=128&d=identicon&r=PG", "display_name": "user1175126", "link": "https://stackoverflow.com/users/1175126/user1175126"}, "edited": false, "score": 0, "creation_date": 1437641397, "post_id": 31581909, "comment_id": 51117833, "body": "The difference between a pass through query and a standard one is simply that it&#39;s sent straight through to the server database. You can do any type of operation with a pass through including updates."}, {"owner": {"reputation": 179, "user_id": 1175126, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/ab4b2c2be2d15a8de913736575b61706?s=128&d=identicon&r=PG", "display_name": "user1175126", "link": "https://stackoverflow.com/users/1175126/user1175126"}, "edited": false, "score": 0, "creation_date": 1437738042, "post_id": 31581909, "comment_id": 51168826, "body": "Wouldn&#39;t Access save all the bound controls automatically, which will not do away with the delay?"}, {"owner": {"reputation": 710, "user_id": 5021236, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16637c5be814c194e7dde84f653d36d7?s=128&d=identicon&r=PG&f=1", "display_name": "jhTuppeny", "link": "https://stackoverflow.com/users/5021236/jhtuppeny"}, "reply_to_user": {"reputation": 179, "user_id": 1175126, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/ab4b2c2be2d15a8de913736575b61706?s=128&d=identicon&r=PG", "display_name": "user1175126", "link": "https://stackoverflow.com/users/1175126/user1175126"}, "edited": false, "score": 0, "creation_date": 1437742849, "post_id": 31581909, "comment_id": 51171895, "body": "You need to control the display and editing of the data in order to improve the performance. Binding the controls gives you no scope to manage this. Have you tried unbinding the controls?"}, {"owner": {"reputation": 179, "user_id": 1175126, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/ab4b2c2be2d15a8de913736575b61706?s=128&d=identicon&r=PG", "display_name": "user1175126", "link": "https://stackoverflow.com/users/1175126/user1175126"}, "edited": false, "score": 0, "creation_date": 1437924903, "post_id": 31581909, "comment_id": 51223998, "body": "So I&#39;m looking for latebinding of controls? No, I haven&#39;t tried that because there are about 45 of them. There&#39;s no subform here, and the data needs to be displayed, too. I have tried unbinding only for comboboxes."}], "tags": [], "owner": {"reputation": 710, "user_id": 5021236, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16637c5be814c194e7dde84f653d36d7?s=128&d=identicon&r=PG&f=1", "display_name": "jhTuppeny", "link": "https://stackoverflow.com/users/5021236/jhtuppeny"}, "is_accepted": false, "score": 0, "last_activity_date": 1437639813, "creation_date": 1437639813, "answer_id": 31581909, "question_id": 31555943, "link": "https://stackoverflow.com/questions/31555943/ms-access-taking-too-long-to-save-form/31581909#31581909", "title": "MS Access taking too long to save form", "body": "<p>Change the data source for the form so that it isn't bound to the tables in SQL Server. Populate the form using Pass Through queries or set up a view in the SQL Server database.</p>\n"}], "owner": {"reputation": 179, "user_id": 1175126, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/ab4b2c2be2d15a8de913736575b61706?s=128&d=identicon&r=PG", "display_name": "user1175126", "link": "https://stackoverflow.com/users/1175126/user1175126"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 257, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1594644067, "creation_date": 1437548137, "last_edit_date": 1594644067, "question_id": 31555943, "link": "https://stackoverflow.com/questions/31555943/ms-access-taking-too-long-to-save-form", "title": "MS Access taking too long to save form", "body": "<p>I have a form in MS Access that takes too long to save. It's a multiuser environment and the time to save the form increases. There was some improvement witnessed when I moved all record/rowsources to be set on runtime. However, when there are multiple users access the form, there's lag of 2-3 minutes or more. There are about 15-20 users accessing the application.\nThere are about 40 to 45 textboxes/comboboxes on the form. The backend is SQL Server.\nI have also tried rebuilding one of the indexes which was fragmented about 58%.\nWhat can I do improve the performance of the app?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2406, "user_id": 2482186, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/7Jtw1.jpg?s=128&g=1", "display_name": "R.Katnaan", "link": "https://stackoverflow.com/users/2482186/r-katnaan"}, "edited": false, "score": 1, "creation_date": 1437548556, "post_id": 31555934, "comment_id": 51069084, "body": "You are looping and setting values to variables, so you will get that last two cell values which are G40 and H40. Now, I want to confirm is how you want all values of cell from that column. I means what format. Is this OK? <code>rtext1 = G1 &amp; &quot; &quot; &amp; G2 &amp; &quot; &quot; &amp; G3 &amp; ... , text1 =  H1 &amp; &quot; &quot; &amp; H2 &amp; &quot; &quot; &amp; H3 &amp; ...</code> Let me know.!"}, {"owner": {"reputation": 37, "user_id": 5055186, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/db0d42e64734f96aadd139ed61f62528?s=128&d=identicon&r=PG&f=1", "display_name": "dab1984", "link": "https://stackoverflow.com/users/5055186/dab1984"}, "reply_to_user": {"reputation": 2406, "user_id": 2482186, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/7Jtw1.jpg?s=128&g=1", "display_name": "R.Katnaan", "link": "https://stackoverflow.com/users/2482186/r-katnaan"}, "edited": false, "score": 0, "creation_date": 1437549241, "post_id": 31555934, "comment_id": 51069473, "body": "No before the &quot;Next i&quot; I have another loop which uses rtext1 and text1 variables. once that secondary loop finishes again the second cell values should be assigned to variables. My whole code can be seen here : <a href=\"http://s000.tinyupload.com/?file_id=44263919873005524050\" rel=\"nofollow noreferrer\">s000.tinyupload.com/?file_id=44263919873005524050</a> , I&#39;m working with unicodes and all other codes are working fine but the loop to get the cell values assign to variables."}, {"owner": {"reputation": 2406, "user_id": 2482186, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/7Jtw1.jpg?s=128&g=1", "display_name": "R.Katnaan", "link": "https://stackoverflow.com/users/2482186/r-katnaan"}, "edited": false, "score": 0, "creation_date": 1437553721, "post_id": 31555934, "comment_id": 51072043, "body": "I checked your code. I found nothing wrong in it. Where did you got wrong. I mean which line of code. Let me know..!"}], "answers": [{"comments": [{"owner": {"reputation": 37, "user_id": 5055186, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/db0d42e64734f96aadd139ed61f62528?s=128&d=identicon&r=PG&f=1", "display_name": "dab1984", "link": "https://stackoverflow.com/users/5055186/dab1984"}, "edited": false, "score": 0, "creation_date": 1437550026, "post_id": 31556278, "comment_id": 51069879, "body": "It&#39;s not working It seems that two variables are not getting the cell values in my macro. what is the command to get cell value to macro and assign it to a variable?"}, {"owner": {"reputation": 2406, "user_id": 2482186, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/7Jtw1.jpg?s=128&g=1", "display_name": "R.Katnaan", "link": "https://stackoverflow.com/users/2482186/r-katnaan"}, "reply_to_user": {"reputation": 37, "user_id": 5055186, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/db0d42e64734f96aadd139ed61f62528?s=128&d=identicon&r=PG&f=1", "display_name": "dab1984", "link": "https://stackoverflow.com/users/5055186/dab1984"}, "edited": false, "score": 0, "creation_date": 1437551248, "post_id": 31556278, "comment_id": 51070575, "body": "No, <code>Cells(i,j).Value</code> can get value. Somethings is wrong in your code. I don&#39;t know what because it is too much codes and can&#39;t understand the logic and flow. If not sure you can check as <code>MsgBox(rtext1 &amp; &quot; &quot; &amp; text1)</code>."}, {"owner": {"reputation": 37, "user_id": 5055186, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/db0d42e64734f96aadd139ed61f62528?s=128&d=identicon&r=PG&f=1", "display_name": "dab1984", "link": "https://stackoverflow.com/users/5055186/dab1984"}, "edited": false, "score": 0, "creation_date": 1437554318, "post_id": 31556278, "comment_id": 51072382, "body": "You are correct, It&#39;s getting the values to variables. But I don&#39;t understand why it&#39;s still not working. When I manually assign values to same variables it works. but when the loop runs nothing works. did i do any thing wrong with the loop commands?"}, {"owner": {"reputation": 2406, "user_id": 2482186, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/7Jtw1.jpg?s=128&g=1", "display_name": "R.Katnaan", "link": "https://stackoverflow.com/users/2482186/r-katnaan"}, "reply_to_user": {"reputation": 37, "user_id": 5055186, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/db0d42e64734f96aadd139ed61f62528?s=128&d=identicon&r=PG&f=1", "display_name": "dab1984", "link": "https://stackoverflow.com/users/5055186/dab1984"}, "edited": false, "score": 0, "creation_date": 1437555468, "post_id": 31556278, "comment_id": 51073128, "body": "No, there is no error in looping. I can&#39;t fully tested your code because I have no data. You should also post excel data. So, I can think more."}, {"owner": {"reputation": 37, "user_id": 5055186, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/db0d42e64734f96aadd139ed61f62528?s=128&d=identicon&r=PG&f=1", "display_name": "dab1984", "link": "https://stackoverflow.com/users/5055186/dab1984"}, "edited": false, "score": 0, "creation_date": 1437555797, "post_id": 31556278, "comment_id": 51073371, "body": "Here is the data : <a href=\"http://s000.tinyupload.com/?file_id=56040525472278918457\" rel=\"nofollow noreferrer\">s000.tinyupload.com/?file_id=56040525472278918457</a> In column B those Sinhala language words should be turned into english acording to the replace macro and values in column G and H"}, {"owner": {"reputation": 2406, "user_id": 2482186, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/7Jtw1.jpg?s=128&g=1", "display_name": "R.Katnaan", "link": "https://stackoverflow.com/users/2482186/r-katnaan"}, "reply_to_user": {"reputation": 37, "user_id": 5055186, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/db0d42e64734f96aadd139ed61f62528?s=128&d=identicon&r=PG&f=1", "display_name": "dab1984", "link": "https://stackoverflow.com/users/5055186/dab1984"}, "edited": false, "score": 0, "creation_date": 1437556971, "post_id": 31556278, "comment_id": 51074203, "body": "What is font name. I can&#39;t do anything without font. Let me know."}, {"owner": {"reputation": 37, "user_id": 5055186, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/db0d42e64734f96aadd139ed61f62528?s=128&d=identicon&r=PG&f=1", "display_name": "dab1984", "link": "https://stackoverflow.com/users/5055186/dab1984"}, "edited": false, "score": 0, "creation_date": 1437557709, "post_id": 31556278, "comment_id": 51074702, "body": "Here is the Font  <a href=\"http://s000.tinyupload.com/?file_id=19416637771808598064\" rel=\"nofollow noreferrer\">s000.tinyupload.com/?file_id=19416637771808598064</a> (Iskoola Potha)"}, {"owner": {"reputation": 2406, "user_id": 2482186, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/7Jtw1.jpg?s=128&g=1", "display_name": "R.Katnaan", "link": "https://stackoverflow.com/users/2482186/r-katnaan"}, "reply_to_user": {"reputation": 37, "user_id": 5055186, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/db0d42e64734f96aadd139ed61f62528?s=128&d=identicon&r=PG&f=1", "display_name": "dab1984", "link": "https://stackoverflow.com/users/5055186/dab1984"}, "edited": false, "score": 0, "creation_date": 1437558438, "post_id": 31556278, "comment_id": 51075202, "body": "I got that the main problem, VBA don&#39;t know the font(unicode). You need to solve this first."}, {"owner": {"reputation": 2406, "user_id": 2482186, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/7Jtw1.jpg?s=128&g=1", "display_name": "R.Katnaan", "link": "https://stackoverflow.com/users/2482186/r-katnaan"}, "reply_to_user": {"reputation": 37, "user_id": 5055186, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/db0d42e64734f96aadd139ed61f62528?s=128&d=identicon&r=PG&f=1", "display_name": "dab1984", "link": "https://stackoverflow.com/users/5055186/dab1984"}, "edited": false, "score": 0, "creation_date": 1437559245, "post_id": 31556278, "comment_id": 51075795, "body": "When editor don&#39;t know the font, everytime you take the cell values, it will got &quot;?????&quot; always. So, if you fixed this, it will work well. This <a href=\"https://social.msdn.microsoft.com/Forums/en-US/78eeab51-f39e-423c-8afc-ebd218d658c3/how-to-make-vba-to-read-and-understand-characters-in-other-keyboard-language?forum=isvvba\" rel=\"nofollow noreferrer\">site</a> is for reference."}, {"owner": {"reputation": 37, "user_id": 5055186, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/db0d42e64734f96aadd139ed61f62528?s=128&d=identicon&r=PG&f=1", "display_name": "dab1984", "link": "https://stackoverflow.com/users/5055186/dab1984"}, "edited": false, "score": 0, "creation_date": 1437559415, "post_id": 31556278, "comment_id": 51075926, "body": "I found the issue. when the value taken from Column H it take as whole text but It needs to be the unicode character after adding following statements it got resolved ,     For i = 1 To 38 Step 1          rtext1 = Sheets(&quot;Sheet1&quot;).Cells(i, &quot;G&quot;).Value          text = Sheets(&quot;Sheet1&quot;).Cells(i, &quot;H&quot;).Value       For Each cl In Range(&quot;$B$2:$B&quot; &amp; Range(&quot;$B100&quot;).End(xlUp).Row)      &#39;MsgBox (rtext1 &amp; &quot; &quot; &amp; ChrW(text1))     text1 = ChrW(text)"}, {"owner": {"reputation": 2406, "user_id": 2482186, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/7Jtw1.jpg?s=128&g=1", "display_name": "R.Katnaan", "link": "https://stackoverflow.com/users/2482186/r-katnaan"}, "reply_to_user": {"reputation": 37, "user_id": 5055186, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/db0d42e64734f96aadd139ed61f62528?s=128&d=identicon&r=PG&f=1", "display_name": "dab1984", "link": "https://stackoverflow.com/users/5055186/dab1984"}, "edited": false, "score": 0, "creation_date": 1437559665, "post_id": 31556278, "comment_id": 51076118, "body": "Glad to here that. You are welcome. Let me know that anything I can help for you."}, {"owner": {"reputation": 2406, "user_id": 2482186, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/7Jtw1.jpg?s=128&g=1", "display_name": "R.Katnaan", "link": "https://stackoverflow.com/users/2482186/r-katnaan"}, "reply_to_user": {"reputation": 37, "user_id": 5055186, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/db0d42e64734f96aadd139ed61f62528?s=128&d=identicon&r=PG&f=1", "display_name": "dab1984", "link": "https://stackoverflow.com/users/5055186/dab1984"}, "edited": false, "score": 0, "creation_date": 1437559788, "post_id": 31556278, "comment_id": 51076207, "body": "Actually, you don&#39;t need second loop because you use <code>Range(B:B)</code> to replace text. So, it is not need. Just remove it. After that it will also OK."}], "tags": [], "owner": {"reputation": 2406, "user_id": 2482186, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/7Jtw1.jpg?s=128&g=1", "display_name": "R.Katnaan", "link": "https://stackoverflow.com/users/2482186/r-katnaan"}, "is_accepted": true, "score": 0, "last_activity_date": 1437549883, "last_edit_date": 1437549883, "creation_date": 1437549243, "answer_id": 31556278, "question_id": 31555934, "link": "https://stackoverflow.com/questions/31555934/get-cell-values-in-two-columns-to-two-variables-using-macro/31556278#31556278", "title": "Get cell values in two columns to two variables using macro", "body": "<p>I tested your code. It works well. I think that when you run code, ActiveSheet is not your desired sheets. So, you not get the right value. Try this one:</p>\n\n<pre><code>For i= 1 To 40 Step 1\n\n    rtext1 = Sheets(\"sheetname\").Cells(i, \"G\").Value\n\n    text1 = Sheets(\"sheetname\").Cells(i, \"H\").Value\n\nNext i\n</code></pre>\n"}], "owner": {"reputation": 37, "user_id": 5055186, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/db0d42e64734f96aadd139ed61f62528?s=128&d=identicon&r=PG&f=1", "display_name": "dab1984", "link": "https://stackoverflow.com/users/5055186/dab1984"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 525, "favorite_count": 0, "accepted_answer_id": 31556278, "answer_count": 1, "score": 0, "last_activity_date": 1437656623, "creation_date": 1437548106, "last_edit_date": 1531161705, "question_id": 31555934, "link": "https://stackoverflow.com/questions/31555934/get-cell-values-in-two-columns-to-two-variables-using-macro", "title": "Get cell values in two columns to two variables using macro", "body": "<p>I have two columns \"G\" and \"H\" in the same sheet. I want the cell values on those two columns assigned into a two variables. I have wrote a macro as follows </p>\n\n<pre><code>For i = 1 To 40\nrtext1 = Cells(i, \"G\").Value\ntext1 = Cells(i, \"H\").Value\nNext i\n</code></pre>\n\n<p>But  I'm not getting the correct cell value to relevant variable. What is the best way to do this? </p>\n"}, {"tags": ["excel", "vba", "vb6"], "comments": [{"owner": {"reputation": 1341, "user_id": 2922414, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/RMzW0.jpg?s=128&g=1", "display_name": "AdorableVB", "link": "https://stackoverflow.com/users/2922414/adorablevb"}, "reply_to_user": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "edited": false, "score": 0, "creation_date": 1437550042, "post_id": 31555815, "comment_id": 51069884, "body": "oh. that kinda works. geez. It repeats itself if you selected all the rows in Worker column. Why didn&#39;t I think of that. Thanks, that&#39;s one way to answer my question, but I still would like to see others approach in this. Something more like a click away to allocate them all."}, {"owner": {"reputation": 1341, "user_id": 2922414, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/RMzW0.jpg?s=128&g=1", "display_name": "AdorableVB", "link": "https://stackoverflow.com/users/2922414/adorablevb"}, "reply_to_user": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "edited": false, "score": 0, "creation_date": 1437550734, "post_id": 31555815, "comment_id": 51070262, "body": "I feel like it doesnt need to be the same as the result I am looking for, the important factor is for me to allocate the workloads, if not equally, to the pool of workers. Your first comment actually solves the problem, but for the sake of the question, if you have the VBA solution, I think it would be a much better approach as I will be able to do more things in future perspective, am I right?"}, {"owner": {"reputation": 1341, "user_id": 2922414, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/RMzW0.jpg?s=128&g=1", "display_name": "AdorableVB", "link": "https://stackoverflow.com/users/2922414/adorablevb"}, "reply_to_user": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "edited": false, "score": 0, "creation_date": 1437551240, "post_id": 31555815, "comment_id": 51070567, "body": "^probably, but I don&#39;t really know how since this will be my first time to code in excel, but I know how to in desktop IDEs VB6 and VB.Net &#39;For Each Worker in Pool blah blah&#39; - just don&#39;t know how to incorporate it in excel rows and columns.. I just need something like a sample draft that I can follow through, then google will do the rest. lol :)"}], "answers": [{"comments": [{"owner": {"reputation": 1341, "user_id": 2922414, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/RMzW0.jpg?s=128&g=1", "display_name": "AdorableVB", "link": "https://stackoverflow.com/users/2922414/adorablevb"}, "edited": false, "score": 0, "creation_date": 1437866074, "post_id": 31563914, "comment_id": 51211223, "body": "Sorry for the late response, just to let you know, tried the formula above, but it doesn&#39;t add Carl to the workload. Understanding this will take a long time for me as I am busy this week since my grandpa died, but will study this as soon as I&#39;m free. Thank you for the input."}, {"owner": {"reputation": 15405, "user_id": 2237785, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iXptK.png?s=128&g=1", "display_name": "Bond", "link": "https://stackoverflow.com/users/2237785/bond"}, "reply_to_user": {"reputation": 1341, "user_id": 2922414, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/RMzW0.jpg?s=128&g=1", "display_name": "AdorableVB", "link": "https://stackoverflow.com/users/2922414/adorablevb"}, "edited": false, "score": 0, "creation_date": 1437930721, "post_id": 31563914, "comment_id": 51225907, "body": "Should work fine, as long as your data matches what you&#39;ve shown in your post (i.e., one header row, pool in column C, etc.). I did make one small change to ensure that workers are assigned, round-robin style, in the order listed in the workbook. <a href=\"http://i.imgur.com/RZdo50u.png\" rel=\"nofollow noreferrer\">Here&#39;s a screenshot</a> showing my results using the formula shown above."}], "tags": [], "owner": {"reputation": 15405, "user_id": 2237785, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iXptK.png?s=128&g=1", "display_name": "Bond", "link": "https://stackoverflow.com/users/2237785/bond"}, "is_accepted": true, "score": 0, "last_activity_date": 1437930522, "last_edit_date": 1437930522, "creation_date": 1437570029, "answer_id": 31563914, "question_id": 31555815, "link": "https://stackoverflow.com/questions/31555815/how-to-allocate-rows-to-a-list-in-excel/31563914#31563914", "title": "How to allocate rows to a list in excel", "body": "<p>This formula will do what you need. Enter it in <code>B2</code> and fill it down the column:</p>\n\n<pre><code>=INDEX(C:C,MOD(ROW()-2,COUNTA(C:C)-1)+2)\n</code></pre>\n\n<p>Breaking it down:</p>\n\n<pre><code>INDEX(C:C,[row])    -- Return the value at [row] in column C\n</code></pre>\n\n<p>Where <code>[row]</code> is:</p>\n\n<pre><code>MOD(ROW()-2,COUNTA(C:C)-1)+2\n</code></pre>\n\n<p>Breaking this down:</p>\n\n<pre><code>ROW()-2        -- Current row number in column B - offset to zero-base\nCOUNTA(C:C)-1  -- Number of workers in column C (-1 removes header)\nMOD()          -- Converts B row number into value in range [0 - # of Workers)\n+2             -- Offsets [0-workers) to [2-workers+2) to account for positioning in col C\n</code></pre>\n\n<p>If you only want names to appear in column B if there's a task to perform, you can wrap the formula in an <code>IF</code>:</p>\n\n<pre><code>=IF(LEN(A2)&gt;0,INDEX(C:C,MOD(ROW()-2,COUNTA(C:C)-1)+2),\"\")\n</code></pre>\n\n<p>Then you can fill this formula down hundreds of rows and names will get added automatically as you add work.</p>\n"}], "owner": {"reputation": 1341, "user_id": 2922414, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/RMzW0.jpg?s=128&g=1", "display_name": "AdorableVB", "link": "https://stackoverflow.com/users/2922414/adorablevb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1614, "favorite_count": 0, "accepted_answer_id": 31563914, "answer_count": 1, "score": 1, "last_activity_date": 1437930522, "creation_date": 1437547769, "question_id": 31555815, "link": "https://stackoverflow.com/questions/31555815/how-to-allocate-rows-to-a-list-in-excel", "title": "How to allocate rows to a list in excel", "body": "<p>I wanted to allocate the work to the number of people that can work on the task.</p>\n\n<p>From the left table (raw data), I will input the names of the available workers. Then as a result, right table, the 5 people was then allocated 3 each. The work for each person is determined by the user, <em>(much better if it will be automatically calculated to be allocated to each person equally, eg. 10 workloads to 5 people = 2 workload each, 100WL to 5P = 20WL each, and so on. hope you get the gist)</em></p>\n\n<p><img src=\"https://i.stack.imgur.com/pNYRm.png\" alt=\"enter image description here\"></p>\n\n<p>I am not familiar to excel, the processes and computations that it can do, but I am familiar to VB6 as it seems to be the backend coding of excel, so I will go down the coding path to execute this command. If possible, it will be greatly appreciated if one can provide me a sample in excel, so I can study, edit and tweak it a tad better as I am new(first time) to using VB6 in excel.</p>\n"}, {"tags": ["vba", "excel", "excel-2007", "highlight"], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 5142165, "user_type": "registered", "accept_rate": 25, "profile_image": "https://graph.facebook.com/10153410789239566/picture?type=large", "display_name": "Mohammad Mbydeen", "link": "https://stackoverflow.com/users/5142165/mohammad-mbydeen"}, "edited": false, "score": 0, "creation_date": 1437558760, "post_id": 31555769, "comment_id": 51075457, "body": "Its working, but it place the reference of the highlighted cell in the first cell of the row, and I don&#39;t want that, please do you have another solution ?"}, {"owner": {"reputation": 667, "user_id": 4097470, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0e18a78f4c5f640539775e532d78313?s=128&d=identicon&r=PG&f=1", "display_name": "VirtualMichael", "link": "https://stackoverflow.com/users/4097470/virtualmichael"}, "reply_to_user": {"reputation": 33, "user_id": 5142165, "user_type": "registered", "accept_rate": 25, "profile_image": "https://graph.facebook.com/10153410789239566/picture?type=large", "display_name": "Mohammad Mbydeen", "link": "https://stackoverflow.com/users/5142165/mohammad-mbydeen"}, "edited": false, "score": 0, "creation_date": 1437560196, "post_id": 31555769, "comment_id": 51076482, "body": "@Mohammad Mbydeen - I&#39;ve posted an alternative that stores the highlighted cells in memory as a separate answer."}], "tags": [], "owner": {"reputation": 667, "user_id": 4097470, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0e18a78f4c5f640539775e532d78313?s=128&d=identicon&r=PG&f=1", "display_name": "VirtualMichael", "link": "https://stackoverflow.com/users/4097470/virtualmichael"}, "is_accepted": false, "score": 0, "last_activity_date": 1437549739, "last_edit_date": 1437549739, "creation_date": 1437547577, "answer_id": 31555769, "question_id": 31555647, "link": "https://stackoverflow.com/questions/31555647/highlight-cells-in-ms-excel-2007-by-double-click/31555769#31555769", "title": "Highlight cells in MS excel 2007 by double click", "body": "<p>Suggest you use the <code>Worksheet_BeforeDoubleClick</code> method to keep track of the 'highlighted' cell by placing the double clicked cell's reference on a hidden sheet, then either use conditional formatting or explicit checks in your event handler to highlight the relevant cell (or \"cells\" if you are allowing a single cell on multiple rows to be selected) based on the value(s) on the hidden sheet. If you choose to use conditional formatting, whenever a new cell is 'double clicked', the reference is updated on the hidden sheet and conditional formatting is automatically recalculated. Only one cell on a given row will ever remain 'highlighted'.</p>\n\n<p>Alternatively, you could do it explicitly by adjusting your double click event handling code along the lines of the following:</p>\n\n<pre><code>Private Sub Worksheet_BeforeDoubleClick(ByVal Target As Range, Cancel As Boolean)\n    If (Not (IsEmpty(Worksheets(\"Sheet2\").Cells(1, 1).Value))) Then\n        ActiveSheet.Range(Worksheets(\"Sheet2\").Cells(1, 1).Value).Interior.ColorIndex = 0\n    End If\n    Worksheets(\"Sheet2\").Cells(1, 1).Value = Target.Address\n    ActiveSheet.Range(Worksheets(\"Sheet2\").Cells(1, 1).Value).Interior.ColorIndex = 3\nEnd Sub\n</code></pre>\n\n<p>This way you could also check for any highlighted cell(s) upon loading the sheet and reset them if appropriate (assuming the user is permitted to save changes).</p>\n\n<p>To highlight just one cell on any given row (but allowing multiple rows to have a single highlighted cell), you could use the following (this also toggles the highlight in an already highlighted cell):</p>\n\n<pre><code>Private Sub Worksheet_BeforeDoubleClick(ByVal Target As Range, Cancel As Boolean)\n    If (Not (IsEmpty(Worksheets(\"Sheet2\").Cells(Target.Row, 1).Value))) Then\n        ActiveSheet.Range(Worksheets(\"Sheet2\").Cells(Target.Row, 1).Value).Interior.ColorIndex = 0\n        If (Worksheets(\"Sheet2\").Cells(Target.Row, 1).Value = Target.Address) Then\n            Worksheets(\"Sheet2\").Cells(Target.Row, 1).Value = \"\"\n            Target.Interior.ColorIndex = 0\n        Else\n            Worksheets(\"Sheet2\").Cells(Target.Row, 1).Value = Target.Address\n            Target.Interior.ColorIndex = 3\n        End If\n    Else\n        Worksheets(\"Sheet2\").Cells(Target.Row, 1).Value = Target.Address\n        Target.Interior.ColorIndex = 3\n    End If\n    Cancel = True\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 33, "user_id": 5142165, "user_type": "registered", "accept_rate": 25, "profile_image": "https://graph.facebook.com/10153410789239566/picture?type=large", "display_name": "Mohammad Mbydeen", "link": "https://stackoverflow.com/users/5142165/mohammad-mbydeen"}, "edited": false, "score": 0, "creation_date": 1437556899, "post_id": 31555838, "comment_id": 51074149, "body": "Thank you !! but this code just for one column, I wanted to range of rows, could you please help ?"}, {"owner": {"reputation": 2406, "user_id": 2482186, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/7Jtw1.jpg?s=128&g=1", "display_name": "R.Katnaan", "link": "https://stackoverflow.com/users/2482186/r-katnaan"}, "reply_to_user": {"reputation": 33, "user_id": 5142165, "user_type": "registered", "accept_rate": 25, "profile_image": "https://graph.facebook.com/10153410789239566/picture?type=large", "display_name": "Mohammad Mbydeen", "link": "https://stackoverflow.com/users/5142165/mohammad-mbydeen"}, "edited": false, "score": 0, "creation_date": 1437557223, "post_id": 31555838, "comment_id": 51074394, "body": "Not clear your requirement. Say more with some examples. I will try it."}, {"owner": {"reputation": 33, "user_id": 5142165, "user_type": "registered", "accept_rate": 25, "profile_image": "https://graph.facebook.com/10153410789239566/picture?type=large", "display_name": "Mohammad Mbydeen", "link": "https://stackoverflow.com/users/5142165/mohammad-mbydeen"}, "edited": false, "score": 0, "creation_date": 1437559126, "post_id": 31555838, "comment_id": 51075709, "body": "Here is the problem, I have a table with white background and the user is able to add rows and columns to the table by clicking a buttons that assigned to macros, I want the user just be able to highlight the cell inside the table because the background of the table is white and the background of the whole sheet is grey, using your code it changes the background for the whole row.the table is from A:G and can be extended"}, {"owner": {"reputation": 2406, "user_id": 2482186, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/7Jtw1.jpg?s=128&g=1", "display_name": "R.Katnaan", "link": "https://stackoverflow.com/users/2482186/r-katnaan"}, "reply_to_user": {"reputation": 33, "user_id": 5142165, "user_type": "registered", "accept_rate": 25, "profile_image": "https://graph.facebook.com/10153410789239566/picture?type=large", "display_name": "Mohammad Mbydeen", "link": "https://stackoverflow.com/users/5142165/mohammad-mbydeen"}, "edited": false, "score": 0, "creation_date": 1437559841, "post_id": 31555838, "comment_id": 51076246, "body": "Ok, I got you. I modify my answer for you. Try it. If it is work, accept the answer,. Thanks.!"}], "tags": [], "owner": {"reputation": 2406, "user_id": 2482186, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/7Jtw1.jpg?s=128&g=1", "display_name": "R.Katnaan", "link": "https://stackoverflow.com/users/2482186/r-katnaan"}, "is_accepted": false, "score": 0, "last_activity_date": 1437559910, "last_edit_date": 1437559910, "creation_date": 1437547844, "answer_id": 31555838, "question_id": 31555647, "link": "https://stackoverflow.com/questions/31555647/highlight-cells-in-ms-excel-2007-by-double-click/31555838#31555838", "title": "Highlight cells in MS excel 2007 by double click", "body": "<p>Try this one:</p>\n\n<pre><code>Private Sub Worksheet_BeforeDoubleClick(ByVal Target As Range, Cancel As Boolean)\n\n    'Target must be between column \"A\" which is 1 &amp; \"G\" which is 7 and also between row 1 and 10.\n    'I also add checking for row. If you don't need, remove it.\n    If Target.Column &gt;= 1 And Target.Column &lt;= 7 And Target.row &gt;= 1 And Target.row &lt;= 10 Then\n\n      If Target.Interior.ColorIndex = 3 Then\n            ' if cell is already red, remove the color:\n            Target.Interior.ColorIndex = 2\n      Else\n            ' make the cell red:\n            Target.Interior.ColorIndex = 3\n      End If\n\n      ' true to cancel the 'editing' mode of a cell:\n      Cancel = True\n\n    End If\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 33, "user_id": 5142165, "user_type": "registered", "accept_rate": 25, "profile_image": "https://graph.facebook.com/10153410789239566/picture?type=large", "display_name": "Mohammad Mbydeen", "link": "https://stackoverflow.com/users/5142165/mohammad-mbydeen"}, "edited": false, "score": 0, "creation_date": 1437556832, "post_id": 31555868, "comment_id": 51074095, "body": "Thank you, but your code changed the table background and the background of the entire row in the worksheet, I don&#39;t want to change the background for the entire row. when the user click to highlight the cell, it just highlighted to red and de-highlighted to white. please could you help ??"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 33, "user_id": 5142165, "user_type": "registered", "accept_rate": 25, "profile_image": "https://graph.facebook.com/10153410789239566/picture?type=large", "display_name": "Mohammad Mbydeen", "link": "https://stackoverflow.com/users/5142165/mohammad-mbydeen"}, "edited": false, "score": 0, "creation_date": 1437557896, "post_id": 31555868, "comment_id": 51074831, "body": "It is unclear on how wide you want to set the cell fill to white but if that is preferred then I&#39;ve adjusted the code above to backfill the entire row white in order that two cells cannot be red at the same time in the same row."}, {"owner": {"reputation": 33, "user_id": 5142165, "user_type": "registered", "accept_rate": 25, "profile_image": "https://graph.facebook.com/10153410789239566/picture?type=large", "display_name": "Mohammad Mbydeen", "link": "https://stackoverflow.com/users/5142165/mohammad-mbydeen"}, "edited": false, "score": 0, "creation_date": 1437558601, "post_id": 31555868, "comment_id": 51075333, "body": "Here is the problem, I have a table with white background and the user is able to add rows and columns to the table by clicking a buttons that assigned to macros, I want the user just be able to highlight the cell inside the table because the background of the table is white and the background of the whole sheet is grey, using your code it changes the background for the whole row.the table is from A:G and can be extended"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 33, "user_id": 5142165, "user_type": "registered", "accept_rate": 25, "profile_image": "https://graph.facebook.com/10153410789239566/picture?type=large", "display_name": "Mohammad Mbydeen", "link": "https://stackoverflow.com/users/5142165/mohammad-mbydeen"}, "edited": false, "score": 0, "creation_date": 1437560013, "post_id": 31555868, "comment_id": 51076353, "body": "The fact that you were dealing with a listobject table would have been good to know."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 1, "last_activity_date": 1437559986, "last_edit_date": 1437559986, "creation_date": 1437547933, "answer_id": 31555868, "question_id": 31555647, "link": "https://stackoverflow.com/questions/31555647/highlight-cells-in-ms-excel-2007-by-double-click/31555868#31555868", "title": "Highlight cells in MS excel 2007 by double click", "body": "<p>I believe you want to reset the cell color to a normal cell, not specifically fill it with a white background.</p>\n\n<pre><code>Private Sub Worksheet_BeforeDoubleClick(ByVal Target As Range, Cancel As Boolean)\n\n    Cancel = True\n    Dim iCOLOR As Long\n    If Target.Interior.ColorIndex &lt;&gt; 3 Then _\n        iCOLOR = 3\n    Rows(Target.Row).Interior.Pattern = xlNone\n    If iCOLOR = 3 Then _\n        Target.Interior.ColorIndex = iCOLOR\n\nEnd Sub\n</code></pre>\n\n<p>The method for removing a fill is to set the <code>.Interior.Pattern = xlNone</code>.</p>\n\n<p>If a solid white cell fill is desired when not red then it can be switched on and off with this.</p>\n\n<pre><code>Private Sub Worksheet_BeforeDoubleClick(ByVal Target As Range, Cancel As Boolean)\n\n    Cancel = True\n    Dim iCOLOR As Long\n    iCOLOR = 3 + CBool(Target.Interior.ColorIndex = 3)\n    Rows(Target.Row).Cells.Interior.ColorIndex = 2\n    Target.Interior.ColorIndex = iCOLOR\n\nEnd Sub\n</code></pre>\n\n<p>Of course, a <a href=\"https://msdn.microsoft.com/en-us/library/office/aa174247%28v=office.11%29.aspx\" rel=\"nofollow\">ListObject</a> presents a different set of problems.</p>\n\n<pre><code>Private Sub Worksheet_BeforeDoubleClick(ByVal Target As Range, Cancel As Boolean)\n\n    If Not Intersect(Target, ListObjects(\"Table1\").DataBodyRange) Is Nothing Then\n        Cancel = True\n        Dim iCOLOR As Long\n        iCOLOR = 3 + CBool(Target.Interior.ColorIndex = 3)\n        Intersect(Rows(Target.Row), ListObjects(\"Table1\").DataBodyRange).Interior.ColorIndex = 2\n        Target.Interior.ColorIndex = iCOLOR\n    End If\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 667, "user_id": 4097470, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0e18a78f4c5f640539775e532d78313?s=128&d=identicon&r=PG&f=1", "display_name": "VirtualMichael", "link": "https://stackoverflow.com/users/4097470/virtualmichael"}, "reply_to_user": {"reputation": 33, "user_id": 5142165, "user_type": "registered", "accept_rate": 25, "profile_image": "https://graph.facebook.com/10153410789239566/picture?type=large", "display_name": "Mohammad Mbydeen", "link": "https://stackoverflow.com/users/5142165/mohammad-mbydeen"}, "edited": false, "score": 0, "creation_date": 1437611728, "post_id": 31560249, "comment_id": 51107179, "body": "Glad to hear it @Mohammad Mbydeen. Perhaps you could up-vote it as a thanks :)"}], "tags": [], "owner": {"reputation": 667, "user_id": 4097470, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0e18a78f4c5f640539775e532d78313?s=128&d=identicon&r=PG&f=1", "display_name": "VirtualMichael", "link": "https://stackoverflow.com/users/4097470/virtualmichael"}, "is_accepted": true, "score": 2, "last_activity_date": 1437560093, "creation_date": 1437560093, "answer_id": 31560249, "question_id": 31555647, "link": "https://stackoverflow.com/questions/31555647/highlight-cells-in-ms-excel-2007-by-double-click/31560249#31560249", "title": "Highlight cells in MS excel 2007 by double click", "body": "<p>Rather than storing the selected cell references on a separate or hidden sheet, the highlighted cell references could be stored in-memory. They just need to be initialized upon loading the sheet (via a <code>Worksheet_Activate()</code> method), but will otherwise work in a similar way.</p>\n\n<p>Add the following code to the relevant Sheet within the Workbook:</p>\n\n<pre><code>' Set of highlighted cells indexed by row number\nDim highlightedCells As New Collection\n\n' Scan existing sheet for any cells coloured 'red' and initialise the\n'  run-time collection of 'highlighted' cells.\nPrivate Sub Worksheet_Activate()\n    Dim existingHighlights As Range\n    ' Reset the collection of highlighted cells ready to rebuild it\n    Set highlightedCells = New Collection\n    ' Find the first cell that has its background coloured red\n    Application.FindFormat.Interior.ColorIndex = 3\n    Set existingHighlights = ActiveSheet.Cells.Find(\"\", _\n                                                    LookIn:=xlValues, _\n                                                    LookAt:=xlPart, _\n                                                    SearchOrder:=xlByRows, _\n                                                    SearchDirection:=xlNext, _\n                                                    MatchCase:=False, _\n                                                    SearchFormat:=True)\n    ' Process for as long as we have more matches\n    Do While Not existingHighlights Is Nothing\n        cRow = existingHighlights.Row\n        ' Add a reference only to the first coloured cell if multiple\n        ' exist in a single row (will only occur if background manually set)\n        Err.Clear\n        On Error Resume Next\n            Call highlightedCells.Add(existingHighlights.Address, CStr(cRow))\n        On Error GoTo 0\n        ' Search from the cell after the last match. Note an error in Excel\n        '  appears to prevent the FindNext method from finding formats correctly\n        Application.FindFormat.Interior.ColorIndex = 3\n        Set existingHighlights = ActiveSheet.Cells.Find(\"\", _\n                                                    After:=existingHighlights, _\n                                                    LookIn:=xlValues, _\n                                                    LookAt:=xlPart, _\n                                                    SearchOrder:=xlByRows, _\n                                                    SearchDirection:=xlNext, _\n                                                    MatchCase:=False, _\n                                                    SearchFormat:=True)\n        ' Abort the search if we've looped back to the top of the sheet\n        If (existingHighlights.Row &lt; cRow) Then\n            Exit Do\n        End If\n    Loop\n\nEnd Sub\n\n\nPrivate Sub Worksheet_BeforeDoubleClick(ByVal Target As Range, Cancel As Boolean)\n    Dim hCell As String\n    Dim cellAlreadyHighlighted As Boolean\n    hCell = \"\"\n\n    Err.Clear\n    On Error Resume Next\n      hCell = highlightedCells.Item(CStr(Target.Row))\n    On Error GoTo 0\n\n    If (hCell &lt;&gt; \"\") Then\n        ActiveSheet.Range(hCell).Interior.ColorIndex = 0\n        If (hCell = Target.Address) Then\n            Call highlightedCells.Remove(CStr(Target.Row))\n            Target.Interior.ColorIndex = 0\n        Else\n            Call highlightedCells.Remove(CStr(Target.Row))\n            Call highlightedCells.Add(Target.Address, CStr(Target.Row))\n            Target.Interior.ColorIndex = 3\n        End If\n    Else\n        Err.Clear\n        On Error Resume Next\n          highlightedCells.Remove (CStr(Target.Row))\n        On Error GoTo 0\n        Call highlightedCells.Add(Target.Address, CStr(Target.Row))\n        Target.Interior.ColorIndex = 3\n    End If\n    Cancel = True\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 5142165, "user_type": "registered", "accept_rate": 25, "profile_image": "https://graph.facebook.com/10153410789239566/picture?type=large", "display_name": "Mohammad Mbydeen", "link": "https://stackoverflow.com/users/5142165/mohammad-mbydeen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 949, "favorite_count": 0, "accepted_answer_id": 31560249, "answer_count": 4, "score": 3, "last_activity_date": 1437560093, "creation_date": 1437547141, "last_edit_date": 1437547517, "question_id": 31555647, "link": "https://stackoverflow.com/questions/31555647/highlight-cells-in-ms-excel-2007-by-double-click", "title": "Highlight cells in MS excel 2007 by double click", "body": "<p>I want the user to be able to just highlight one cell on each row</p>\n\n<p>This code highlights the cells in excel 2007, but my problem is that I can't write a code the restrict the user to highlight just one cell on a row, </p>\n\n<p>here is the code:</p>\n\n<pre><code>Private Sub Worksheet_BeforeDoubleClick( _\n\n\n     ByVal Target As Range, Cancel As Boolean)\n\n' This macro is activated when you doubleclick\n' on a cell on a worksheet.\n' Purpose: color or decolor the cell when clicked on again\n' by default color number 3 is red\n      If Target.Interior.ColorIndex = 3 Then\n            ' if cell is already red, remove the color:\n            Target.Interior.ColorIndex = 2\n      Else\n            ' make the cell red:\n            Target.Interior.ColorIndex = 3\n      End If\n      ' true to cancel the 'editing' mode of a cell:\n      Cancel = True\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1437547143, "post_id": 31555282, "comment_id": 51068360, "body": "To clarify: you want to put the first value found in column E from the 3APD032FA.ilv worksheet into C402 on the Issues worksheet. What if there are other values in 3APD032FA.ilv&#39;s column E? Should be next go to D402 and so on?"}, {"owner": {"reputation": 13, "user_id": 5013542, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df0f60680a8684fd6ca12d9ad7cb9419?s=128&d=identicon&r=PG&f=1", "display_name": "MisterYUE", "link": "https://stackoverflow.com/users/5013542/misteryue"}, "edited": false, "score": 0, "creation_date": 1437547303, "post_id": 31555282, "comment_id": 51068432, "body": "Not only the first value but everything I find in column E. I&#39;d like them to be in the same cell, C402 for 3APD032FA.ilv, that&#39;s why I tried Formula instead of Value (heard it acted as a +=  operator)"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1437548709, "post_id": 31555282, "comment_id": 51069167, "body": "I gather that each of the 3APXXXXXXX.ilv worksheets has a header row? There is a column header label in E1?"}, {"owner": {"reputation": 13, "user_id": 5013542, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df0f60680a8684fd6ca12d9ad7cb9419?s=128&d=identicon&r=PG&f=1", "display_name": "MisterYUE", "link": "https://stackoverflow.com/users/5013542/misteryue"}, "edited": false, "score": 0, "creation_date": 1437549018, "post_id": 31555282, "comment_id": 51069342, "body": "Yes they do, they all do, but that&#39;s not a big problem, I would change their value if I really need to."}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1437550452, "post_id": 31556476, "comment_id": 51070102, "body": "Note that I have modified the code to check for a counta of <i>more than 1</i> in column E of the child worksheets. I had originally written it for any value but if there is a column header label then there will always be at least 1 value."}, {"owner": {"reputation": 13, "user_id": 5013542, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df0f60680a8684fd6ca12d9ad7cb9419?s=128&d=identicon&r=PG&f=1", "display_name": "MisterYUE", "link": "https://stackoverflow.com/users/5013542/misteryue"}, "edited": false, "score": 0, "creation_date": 1437551050, "post_id": 31556476, "comment_id": 51070443, "body": "Impressive thank you ! I&#39;m trying it now and also trying to understand it haha.  How do you turn off the screen update by the way ?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 13, "user_id": 5013542, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df0f60680a8684fd6ca12d9ad7cb9419?s=128&d=identicon&r=PG&f=1", "display_name": "MisterYUE", "link": "https://stackoverflow.com/users/5013542/misteryue"}, "edited": false, "score": 0, "creation_date": 1437551561, "post_id": 31556476, "comment_id": 51070751, "body": "I&#39;ve added appropriate error control and application environment code above."}, {"owner": {"reputation": 13, "user_id": 5013542, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df0f60680a8684fd6ca12d9ad7cb9419?s=128&d=identicon&r=PG&f=1", "display_name": "MisterYUE", "link": "https://stackoverflow.com/users/5013542/misteryue"}, "edited": false, "score": 0, "creation_date": 1437552831, "post_id": 31556476, "comment_id": 51071515, "body": "Just tried it, it seems to work but it also takes the headers into the cell (not big issue), the bigger issue is that the value into the cells doesn&#39;t reset after each loop and I get the previous value as well as the new values. Maybe if I put value = &quot; &quot; at the end of the loop it could solve this ?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 13, "user_id": 5013542, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df0f60680a8684fd6ca12d9ad7cb9419?s=128&d=identicon&r=PG&f=1", "display_name": "MisterYUE", "link": "https://stackoverflow.com/users/5013542/misteryue"}, "edited": false, "score": 0, "creation_date": 1437553972, "post_id": 31556476, "comment_id": 51072182, "body": "My apologies; that was an oversight. To zero the string, use <code>str = vbnullstring</code> for each new worksheet (modified above). It shouldn&#39;t take the headers. Can you provide a better example of the child worksheets?"}, {"owner": {"reputation": 13, "user_id": 5013542, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df0f60680a8684fd6ca12d9ad7cb9419?s=128&d=identicon&r=PG&f=1", "display_name": "MisterYUE", "link": "https://stackoverflow.com/users/5013542/misteryue"}, "edited": false, "score": 0, "creation_date": 1437554695, "post_id": 31556476, "comment_id": 51072607, "body": "<a href=\"http://i.imgur.com/SBmOO23.png\" rel=\"nofollow noreferrer\">i.imgur.com/SBmOO23.png</a> Here you go, should have sent this from the beginning. The code above is taking Comment/Defect. I could just it disappear actually with some simple code"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 13, "user_id": 5013542, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df0f60680a8684fd6ca12d9ad7cb9419?s=128&d=identicon&r=PG&f=1", "display_name": "MisterYUE", "link": "https://stackoverflow.com/users/5013542/misteryue"}, "edited": false, "score": 0, "creation_date": 1437555348, "post_id": 31556476, "comment_id": 51073034, "body": "Is E3 part of a merged cell that includes General Check or is  it an individual blank cell with a blue background?"}, {"owner": {"reputation": 13, "user_id": 5013542, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df0f60680a8684fd6ca12d9ad7cb9419?s=128&d=identicon&r=PG&f=1", "display_name": "MisterYUE", "link": "https://stackoverflow.com/users/5013542/misteryue"}, "edited": false, "score": 0, "creation_date": 1437555604, "post_id": 31556476, "comment_id": 51073223, "body": "Just background, General Check is on B3, E3 should be empty so I guess it can be ignored"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 13, "user_id": 5013542, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df0f60680a8684fd6ca12d9ad7cb9419?s=128&d=identicon&r=PG&f=1", "display_name": "MisterYUE", "link": "https://stackoverflow.com/users/5013542/misteryue"}, "edited": false, "score": 0, "creation_date": 1437555772, "post_id": 31556476, "comment_id": 51073351, "body": "OK, if you switch the counta to <i>greater than 2</i> and move the autofilter down a row so that it starts on row 2 then it shouldn&#39;t collect the header labels. Modified above."}, {"owner": {"reputation": 13, "user_id": 5013542, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df0f60680a8684fd6ca12d9ad7cb9419?s=128&d=identicon&r=PG&f=1", "display_name": "MisterYUE", "link": "https://stackoverflow.com/users/5013542/misteryue"}, "edited": false, "score": 0, "creation_date": 1437556023, "post_id": 31556476, "comment_id": 51073537, "body": "I see, I also understand the code much better now. Thank you a lot !"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 1, "last_activity_date": 1437555673, "last_edit_date": 1437555673, "creation_date": 1437549890, "answer_id": 31556476, "question_id": 31555282, "link": "https://stackoverflow.com/questions/31555282/collect-cell-values-from-column-in-other-worksheet-of-the-same-workbook/31556476#31556476", "title": "Collect Cell Values from Column in Other Worksheet of the same WorkBook", "body": "<p>The column header label in each of the child worksheets is important as it will be used as the filter header to filter out blanks from column E and collect all visible values (e.g. <em>issue statements</em>).</p>\n\n<pre><code>Sub macro()\n    Dim wsI As Worksheet, ws As Worksheet\n    Dim i As Long, rng As Range, str As String\n\n    on error goto Safe_Exit\n    application.screenupdating = false\n    application.enableevents = false\n\n    Set wsI = Worksheets(\"Issues\")\n\n    For Each ws In ActiveWorkbook.Worksheets\n        With ws\n            str = vbnullstring\n            If .AutoFilterMode Then .AutoFilterMode = False\n            If CBool(Application.CountIf(wsI.Columns(2), .Name)) And _\n              Application.CountA(.Columns(5)) &gt; 2 Then\n                With .Range(.Cells(2, 5), .Cells(Rows.Count, 5).End(xlUp))\n                    .AutoFilter Field:=1, Criteria1:=\"&lt;&gt;\"\n                    With .Resize(.Rows.Count - 1, 1).Offset(1, 0)\n                        For Each rng In .SpecialCells(xlCellTypeVisible).Cells\n                            str = str &amp; rng.Value &amp; Chr(10)\n                        Next rng\n                    End With\n                    .AutoFilter Field:=1\n                End With\n                wsI.Cells(Application.Match(.Name, wsI.Columns(2), 0), 3) = Left(str, Len(str) - 1)\n            End If\n            If .AutoFilterMode Then .AutoFilterMode = False\n        End With\n    Next ws\n\nSafe_Exit:\n    application.enableevents = true\n    application.screenupdating = true\nEnd Sub\n</code></pre>\n\n<p>I've collected together any statments found in column E and joined them with a <code>CHr(10)</code> (aka vbLF or line feed character).</p>\n\n<p>This could be speeded up by turning off screen updating and enable events but it should run reasonably quick as is.</p>\n"}], "owner": {"reputation": 13, "user_id": 5013542, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df0f60680a8684fd6ca12d9ad7cb9419?s=128&d=identicon&r=PG&f=1", "display_name": "MisterYUE", "link": "https://stackoverflow.com/users/5013542/misteryue"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 269, "favorite_count": 0, "accepted_answer_id": 31556476, "answer_count": 1, "score": 1, "last_activity_date": 1437555673, "creation_date": 1437545776, "last_edit_date": 1437550496, "question_id": 31555282, "link": "https://stackoverflow.com/questions/31555282/collect-cell-values-from-column-in-other-worksheet-of-the-same-workbook", "title": "Collect Cell Values from Column in Other Worksheet of the same WorkBook", "body": "<p>I'm new to VBA and I'm currently working on some Excel Files.</p>\n\n<p>The File I'm looking at now has a thousand of sheets. Except for the first sheet, they all look the same, something like :</p>\n\n<p><a href=\"http://i.imgur.com/t5UMte3.png\" rel=\"nofollow\">http://i.imgur.com/t5UMte3.png</a></p>\n\n<p>The first sheet has the name of each sheet in each row of col B:</p>\n\n<p><a href=\"http://i.imgur.com/AlH3pm5.png\" rel=\"nofollow\">http://i.imgur.com/AlH3pm5.png</a></p>\n\n<p>What I am trying to do is, for each cells in col E that has been filled, to write the value into the first-sheet, in its corresponding row. It's like writing a report into the first-sheet for each sheets.\nHope I was clear enough ...</p>\n\n<h2>Here is my code: Right now it could only change the very first value of column B.</h2>\n\n<pre><code>Sub macro()\n\n    Dim c As Range\n    Dim ws As Worksheet\n    Dim d As Range\n    Dim I As Integer\n\n    For Each c In Feuil1322.UsedRange.Columns(\"B\").Cells\n\n        For Each ws In ActiveWorkbook.Worksheets\n\n            If c.Value = ws.Name Then\n\n                For Each d In ws.UsedRange.Columns(\"E\").Cells\n                    If Not IsEmpty(d.Value) Then\n                    Feuil1322.Cells(c.End(xlUp).Row, 3).Formula = d.Value\n                    End If\n                Next\n\n            End If\n\n        Next\n\n    Next\n\nEnd Sub\n</code></pre>\n\n<hr>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2780, "user_id": 1294909, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/OZWPz.jpg?s=128&g=1", "display_name": "Moosli", "link": "https://stackoverflow.com/users/1294909/moosli"}, "edited": false, "score": 0, "creation_date": 1437551862, "post_id": 31555168, "comment_id": 51070938, "body": "This is a Q&amp;A site; what is your question? To start with, what have you tried so far?"}, {"owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "reply_to_user": {"reputation": 2780, "user_id": 1294909, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/OZWPz.jpg?s=128&g=1", "display_name": "Moosli", "link": "https://stackoverflow.com/users/1294909/moosli"}, "edited": false, "score": 0, "creation_date": 1437556205, "post_id": 31555168, "comment_id": 51073662, "body": "@Moosli - the OP doesn&#39;t know what to try, that is why he is asking."}, {"owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "edited": false, "score": 0, "creation_date": 1437556322, "post_id": 31555168, "comment_id": 51073746, "body": "Autofilter would be the best bet. Don&#39;t know your layout situation so really can&#39;t come up with an answer."}, {"owner": {"reputation": 514, "user_id": 2102895, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OAvoQ.jpg?s=128&g=1", "display_name": "Eddy", "link": "https://stackoverflow.com/users/2102895/eddy"}, "edited": false, "score": 0, "creation_date": 1437560976, "post_id": 31555168, "comment_id": 51077018, "body": "Welcome to Stack Overflow, @MS123 . It would be helpful if you edited your post to include the code, it doesn&#39;t format very nicely in comments. Are you able to print to PDF?"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 5142022, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/031548ee19883499f3d42a1b49211d8f?s=128&d=identicon&r=PG&f=1", "display_name": "MS123", "link": "https://stackoverflow.com/users/5142022/ms123"}, "edited": false, "score": 0, "creation_date": 1437567455, "post_id": 31562693, "comment_id": 51081400, "body": "eddy i just dont want to print my data, i want to sum the marks also. The data is dynamic, so i cant hardcode the ranges"}, {"owner": {"reputation": 1, "user_id": 5142022, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/031548ee19883499f3d42a1b49211d8f?s=128&d=identicon&r=PG&f=1", "display_name": "MS123", "link": "https://stackoverflow.com/users/5142022/ms123"}, "edited": false, "score": 0, "creation_date": 1437567611, "post_id": 31562693, "comment_id": 51081532, "body": "my pdf will be like                                                                                           PETER                                                                                                                       24.5  Science                                                                                                         33     Geography"}, {"owner": {"reputation": 514, "user_id": 2102895, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OAvoQ.jpg?s=128&g=1", "display_name": "Eddy", "link": "https://stackoverflow.com/users/2102895/eddy"}, "reply_to_user": {"reputation": 1, "user_id": 5142022, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/031548ee19883499f3d42a1b49211d8f?s=128&d=identicon&r=PG&f=1", "display_name": "MS123", "link": "https://stackoverflow.com/users/5142022/ms123"}, "edited": false, "score": 0, "creation_date": 1437569607, "post_id": 31562693, "comment_id": 51083010, "body": "@MS123 I see you&#39;ve changed your question somewhat. OK.. My answer gives you a very clear way to print each row of your worksheet onto a separate page, which was your original question. Your next step is to add those totals - you can&#39;t print something that isn&#39;t there. I suggest you use a clean worksheet, and have your macro write the names &amp; totals to it, then print it as laid out above."}], "tags": [], "owner": {"reputation": 514, "user_id": 2102895, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OAvoQ.jpg?s=128&g=1", "display_name": "Eddy", "link": "https://stackoverflow.com/users/2102895/eddy"}, "is_accepted": false, "score": 0, "last_activity_date": 1437569185, "last_edit_date": 1437569185, "creation_date": 1437566882, "answer_id": 31562693, "question_id": 31555168, "link": "https://stackoverflow.com/questions/31555168/convert-excel-rows-to-pdf-pages-using-vba/31562693#31562693", "title": "Convert Excel rows to PDF pages using VBA", "body": "<p>If you print multiple selected ranges, then each range will be printed to a different page. If you were printing multiple areas on a single page, this would be as simple as:</p>\n\n<pre><code>Range(\"Sheet1!C5:D6,Sheet1!D13:E14\").Select\nActiveWindow.SelectedSheets.PrintOut Copies:=1\n</code></pre>\n\n<p>So if you want each row to be printed to a different page, just use a FOR loop to define the ranges and print the sheet like this...</p>\n\n<pre><code>myrange = \"A1:C1\"\nlastRow = Range(\"A\" &amp; ActiveSheet.Rows.Count).End(xlUp).Row\nFor myRow = 2 To lastRow\n   myrange = myrange &amp; \",A\" &amp; myRow &amp; \":C\" &amp; myRow\nNext\nRange(myrange).Select\nApplication.Dialogs(xlDialogPrint).Show\n</code></pre>\n\n<p>This will open a print dialog, and you can select the printer of your choice (including PDF). I assume that you have the ability to print to PDF in some way - if you have Excel 2010, for example, you can simply select \"Adobe PDF\" as your printer.</p>\n\n<p>Be sure to select \"print selection\" and not the entire worksheet :) </p>\n"}], "owner": {"reputation": 1, "user_id": 5142022, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/031548ee19883499f3d42a1b49211d8f?s=128&d=identicon&r=PG&f=1", "display_name": "MS123", "link": "https://stackoverflow.com/users/5142022/ms123"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2655, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1437656577, "creation_date": 1437545421, "last_edit_date": 1531164843, "question_id": 31555168, "link": "https://stackoverflow.com/questions/31555168/convert-excel-rows-to-pdf-pages-using-vba", "title": "Convert Excel rows to PDF pages using VBA", "body": "<p>I have data in Excel with student names and their marks.\nI want to export the data to PDF using VBA macro where each student details appear on a different PDF page. So if there are 20 students then there will be 20 pages in single PDF. Each student name will form heading of the PDF page and their marks will appear in a table below the heading.</p>\n\n<p>I have a table like this in Excel</p>\n\n<pre><code>student name  -  erp  -    science marks        -geography marks\n                           test1  test2          test1  test2  test3\npeter         -  12        15      9.5           15      7      11\njack          -  13        16      11            10      9      13\n</code></pre>\n\n<p>How can I export this data in a PDF like <code>student.pdf</code>, where page1 will have peter name as heading and the sum of his science marks and geography marks. Similarly, page2 will have jack's name and sum of his marks. How can I do that?</p>\n\n<p>Also, the number of students is dynamic. So I have to count the number of students and that will be the count of my PDF. How do I do that?</p>\n\n<p>code so far</p>\n\n<pre><code>Sub convertTopdf()\nDim ws As Worksheet\nDim lastRow As Long\n\nChDir \"C:\\Users\\Dell\\Desktop\"\nActiveSheet.ExportAsFixedFormat Type:=xlTypePDF, Filename:= _\n    \"C:\\Users\\Dell\\Desktop\\task_excel\\POD.pdf\", OpenAfterPublish:=True\n\nSet ws = ActiveWorkbook.ActiveSheet\nWith ws\n    lastRow = .Range(\"A\" &amp; .Rows.Count).End(xlUp).Row\nEnd With\n\nMsgBox \"The last row which has data in Col A of Sheet1 is \" &amp; lastRow\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "if-statement", "excel-formula"], "comments": [{"owner": {"reputation": 2065, "user_id": 3195451, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/9f1955e912e631e239d4389e54c9cc47?s=128&d=identicon&r=PG", "display_name": "Daniel", "link": "https://stackoverflow.com/users/3195451/daniel"}, "edited": false, "score": 0, "creation_date": 1437549551, "post_id": 31554266, "comment_id": 51069632, "body": "My pleasure @Courtenay Lee Shoy.  Don&#39;t forget to vote up an answer if you found it helpful, and accept one if it answers your question so the rest of the community can learn from it.  Welcome to SO."}], "answers": [{"comments": [{"owner": {"reputation": 2065, "user_id": 3195451, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/9f1955e912e631e239d4389e54c9cc47?s=128&d=identicon&r=PG", "display_name": "Daniel", "link": "https://stackoverflow.com/users/3195451/daniel"}, "edited": false, "score": 0, "creation_date": 1437545064, "post_id": 31554336, "comment_id": 51067382, "body": "The <code>ISNA()</code> formula returns true/false if the value refers to &quot;#N/A&quot;, not &quot;N/A&quot;."}, {"owner": {"reputation": 55, "user_id": 5118276, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/abKeH.jpg?s=128&g=1", "display_name": "Courtenay L", "link": "https://stackoverflow.com/users/5118276/courtenay-l"}, "edited": false, "score": 0, "creation_date": 1437548237, "post_id": 31554336, "comment_id": 51068905, "body": "Daniel - thank you for the clarification re: the&quot;#&quot; - I was wondering why the conditional format was not being applied. telyyn - thank you also for the response. I can use &quot;#NA&quot; instead of &quot;N/A&quot; so your solution works nicely."}, {"owner": {"reputation": 2065, "user_id": 3195451, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/9f1955e912e631e239d4389e54c9cc47?s=128&d=identicon&r=PG", "display_name": "Daniel", "link": "https://stackoverflow.com/users/3195451/daniel"}, "edited": false, "score": 1, "creation_date": 1437549660, "post_id": 31554336, "comment_id": 51069694, "body": "My pleasure.  Also, on SO the best way to say &quot;thanks&quot; is to vote up and/or accept an answer."}], "tags": [], "owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "is_accepted": true, "score": 1, "last_activity_date": 1437542016, "creation_date": 1437542016, "answer_id": 31554336, "question_id": 31554266, "link": "https://stackoverflow.com/questions/31554266/colour-a-cell-range-based-on-another-cells-value/31554336#31554336", "title": "Colour a cell range based on another cell&#39;s value?", "body": "<p>Select cells F3 to N3. On the Home Ribbon click Conditional Formatting > New Rule > Use a formula to....</p>\n\n<p>Use this formula</p>\n\n<p><code>=isna($e3)</code></p>\n\n<p>Note the placement of the $ sign. Select the Format button and apply a format. Confirm all dialogs.</p>\n"}, {"tags": [], "owner": {"reputation": 667, "user_id": 4097470, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0e18a78f4c5f640539775e532d78313?s=128&d=identicon&r=PG&f=1", "display_name": "VirtualMichael", "link": "https://stackoverflow.com/users/4097470/virtualmichael"}, "is_accepted": false, "score": 0, "last_activity_date": 1437542635, "creation_date": 1437542635, "answer_id": 31554458, "question_id": 31554266, "link": "https://stackoverflow.com/questions/31554266/colour-a-cell-range-based-on-another-cells-value/31554458#31554458", "title": "Colour a cell range based on another cell&#39;s value?", "body": "<p>If you wish to do this with Excel VBA (as per your question tags), then you can use the <code>Interior.Color</code> property of a cell range:</p>\n\n<pre><code>ActiveSheet.Range(\"F3:N3\").Interior.Color = RGB(0,0,0)\n</code></pre>\n\n<p>If you need to clear the background if cell E3 is not \"N/A\" then use</p>\n\n<pre><code>ActiveSheet.Range(\"F3:N3\").Interior.ColorIndex = 0\n</code></pre>\n"}], "owner": {"reputation": 55, "user_id": 5118276, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/abKeH.jpg?s=128&g=1", "display_name": "Courtenay L", "link": "https://stackoverflow.com/users/5118276/courtenay-l"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 874, "favorite_count": 0, "accepted_answer_id": 31554336, "answer_count": 2, "score": 1, "last_activity_date": 1437547189, "creation_date": 1437541612, "last_edit_date": 1437547189, "question_id": 31554266, "link": "https://stackoverflow.com/questions/31554266/colour-a-cell-range-based-on-another-cells-value", "title": "Colour a cell range based on another cell&#39;s value?", "body": "<p>I am trying to write a statement in MS Excel 2013 that does the following:</p>\n\n<p><code>If cell E3 = \"N/A\"</code>, make the background colour of cell range F3:N3 = black</p>\n\n<p><code>If cell E3 = anything else</code>, do nothing</p>\n\n<p>Some sort of conditional formatting? I tried a few options but couldn't get it going? :(</p>\n\n<p>Any suggestions?</p>\n"}, {"tags": ["vba", "text", "charts", "directions"], "answers": [{"tags": [], "owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "is_accepted": true, "score": 2, "last_activity_date": 1437542430, "creation_date": 1437542430, "answer_id": 31554412, "question_id": 31553808, "link": "https://stackoverflow.com/questions/31553808/excel-pivotchart-text-directions-of-multi-level-label/31554412#31554412", "title": "Excel PivotChart text directions of multi level label", "body": "<p>Only the inner-most set of a multi level category axis can be controlled, either through the UI or VBA. You cannot set the orientation of the outer category. There is no UI control for that and nothing in the VBA object model.</p>\n\n<p>I know it sucks. Don't shoot the messenger. </p>\n"}], "owner": {"reputation": 175, "user_id": 4772433, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9472cd26845f7c8b43be8d0c1c00df42?s=128&d=identicon&r=PG&f=1", "display_name": "Mohsen", "link": "https://stackoverflow.com/users/4772433/mohsen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2383, "favorite_count": 0, "accepted_answer_id": 31554412, "answer_count": 1, "score": 1, "last_activity_date": 1437542430, "creation_date": 1437538826, "question_id": 31553808, "link": "https://stackoverflow.com/questions/31553808/excel-pivotchart-text-directions-of-multi-level-label", "title": "Excel PivotChart text directions of multi level label", "body": "<p>I have a PivotChart which has two row fields, so there are two level labels in x-axis. I want to change the text direction of both levels, however, it only works for the first label, not the second, as shown below:</p>\n\n<p><img src=\"https://i.stack.imgur.com/PEzEi.jpg\" alt=\"enter image description here\"></p>\n\n<p>VBA codes can be useful too. The following is for the first Label:</p>\n\n<pre><code>ActiveChart.Axes(xlCategory).TickLabels.Orientation = 90 ' degrees\n</code></pre>\n\n<p>How can I change the second level label???</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 51, "user_id": 4873141, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ec3bb99f7e50f487cdc861c3917f0989?s=128&d=identicon&r=PG&f=1", "display_name": "dtk142", "link": "https://stackoverflow.com/users/4873141/dtk142"}, "is_accepted": false, "score": 0, "last_activity_date": 1437540397, "creation_date": 1437540397, "answer_id": 31554046, "question_id": 31553781, "link": "https://stackoverflow.com/questions/31553781/script-out-of-range-error-in-excel-vba-code/31554046#31554046", "title": "Script Out of range Error in excel vba code", "body": "<p>The way you check worksheet exist is wrong. If the sheet isn't exist then it cannot take the name of the worksheet then it will alert \"script out of range\"</p>\n\n<p>You can try this </p>\n\n<pre><code>Dim ws As Worksheet\nOn Error Resume Next\nSet ws = Worksheets(dst)\nIf Not ws Is Nothing Then\n   MsgBox (\"Worksheet Exists!\")\nElse\n   MsgBox (\"Worksheet Dosent Exist!\")\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 5010087, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5a66b380d1596afa7383230906b7542?s=128&d=identicon&r=PG&f=1", "display_name": "Jastin Mathew.R", "link": "https://stackoverflow.com/users/5010087/jastin-mathew-r"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1034, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1437546550, "creation_date": 1437538688, "last_edit_date": 1437546550, "question_id": 31553781, "link": "https://stackoverflow.com/questions/31553781/script-out-of-range-error-in-excel-vba-code", "title": "Script Out of range Error in excel vba code", "body": "<p>I'm getting on following code</p>\n\n<blockquote>\n  <p>\"SCRIPT OUT OF RANGE\"</p>\n</blockquote>\n\n<pre><code>Workbooks.Open Filename:=\"XXX/XXXXX/XXXX/XX.xlsx\"\ndet =DateAdd(\"d\",-1,da)\ndst =Format(det,\"d-M-YYYY\")\nif(Worksheets(dst).Name &lt;&gt; \"\") then\n  msgbox(\"Worksheet Exists!\")\nelse\n  msgbox(\"Worksheet Dosent Exist!\")\nEnd if\n</code></pre>\n"}, {"tags": ["vba", "excel", "combobox"], "answers": [{"comments": [{"owner": {"reputation": 5, "user_id": 4552480, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a890abf112440d0da53b6345617c388?s=128&d=identicon&r=PG&f=1", "display_name": "Sir_Edward", "link": "https://stackoverflow.com/users/4552480/sir-edward"}, "edited": false, "score": 0, "creation_date": 1437950745, "post_id": 31559437, "comment_id": 51232045, "body": "Thank you very much! Solved my issue, I thought it would be something simple. I&#39;ll have to look at compatibility with some of the ActiveX controls now."}], "tags": [], "owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "is_accepted": true, "score": 0, "last_activity_date": 1437558090, "creation_date": 1437558090, "answer_id": 31559437, "question_id": 31553326, "link": "https://stackoverflow.com/questions/31553326/add-a-i-to-combobox-if-m-i-has-a-value/31559437#31559437", "title": "Add (A,i) to combobox if (M,i) has a value", "body": "<p>In facts, if you go to see the <em>Format Control</em>, in the <em>Control</em> tab, you'll see that for the form that you inserted can only take a range as an input for the values proposed in the list.</p>\n\n<p>If you go ahead and use the <em>Macro recorder</em>, you'll see that these objects are actually called <strong>DropDown</strong> as seen in the code you posted.</p>\n\n<p>So if you want to stick to that object for a particular reason, you'll have to :</p>\n\n<ol>\n<li>Pre-extract the values to add, </li>\n<li>Paste them in adjacents cells to use the range in the next step,</li>\n<li>Set the <code>ActiveSheet.Shapes.Range(\"Drop Down 35\").ListFillRange</code> with the address of the previous range</li>\n</ol>\n\n<hr>\n\n<p>Now if you can change, to a real <strong>ComboBox</strong> (from Developer>Insert>ActiveX>ComboBox) :</p>\n\n<p>You can use a structure like the one you posted :</p>\n\n<pre><code>Dim ValA As String, _\n    Ws As Worksheet\n\nSet Ws = ThisWorkbook.Sheets(\"MASTER SHEET\")\n\nFor i = 10 To 239\n    If Ws.Cells(i, \"M\").Value &lt;&gt; vbNullString Then _\n        Ws.Shapes.Range(\"ComboBox1\").AddItem Ws.Cells(i, \"A\") &amp; \" \" &amp; Ws.Cells(i, \"B\")\nNext i\n\nSet Ws = Nothing\n</code></pre>\n"}], "owner": {"reputation": 5, "user_id": 4552480, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a890abf112440d0da53b6345617c388?s=128&d=identicon&r=PG&f=1", "display_name": "Sir_Edward", "link": "https://stackoverflow.com/users/4552480/sir-edward"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 27, "favorite_count": 0, "accepted_answer_id": 31559437, "answer_count": 1, "score": 0, "last_activity_date": 1437558090, "creation_date": 1437535691, "last_edit_date": 1437557128, "question_id": 31553326, "link": "https://stackoverflow.com/questions/31553326/add-a-i-to-combobox-if-m-i-has-a-value", "title": "Add (A,i) to combobox if (M,i) has a value", "body": "<p>I've got a problem :</p>\n\n<p>Inside my Excel spreadsheet, I have a ComboBox (from <em>Developer>insert>form>combobox</em>)</p>\n\n<p>I want to <strong>populate this combobox with values from the A column IF the same number in the M column has a value</strong>.</p>\n\n<p>What VBA code would I use for it?</p>\n\n<p>See below some that i made up (which obviously doesn't work)</p>\n\n<p>Thanks in advance!</p>\n\n<pre><code>For i = 10 To 239\n    cell1temp = i\n    If Sheets(\"MASTER SHEET\").cell(M, cell1temp).Value &lt;&gt; \"\" Then\n        DropDown35.AddItem \"\" &amp; Worksheets(\"MASTER SHEET\").Cells(A, cell1temp) &amp; _\n        \" \" &amp; Worksheets(\"MASTER SHEET\").Cells(B, cell1temp)\n    End If\n\nNext i\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 2406, "user_id": 2482186, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/7Jtw1.jpg?s=128&g=1", "display_name": "R.Katnaan", "link": "https://stackoverflow.com/users/2482186/r-katnaan"}, "is_accepted": true, "score": 2, "last_activity_date": 1437539525, "last_edit_date": 1437539525, "creation_date": 1437538712, "answer_id": 31553785, "question_id": 31552788, "link": "https://stackoverflow.com/questions/31552788/store-value-from-userform-into-excel-table/31553785#31553785", "title": "Store value from Userform into Excel Table", "body": "<p>Try this one:</p>\n\n<pre><code>Table5.DataBodyRange.Cells(lRow, Table5.ListColumns(\"BLDG\").Index) = TxBox_Building.Text\n</code></pre>\n\n<p>If <strong>Table5</strong> is not working, you can use as follow:</p>\n\n<pre><code>Sheets(\"sheetname\").ListObjects(\"Table5\")\n</code></pre>\n"}], "owner": {"reputation": 674, "user_id": 289136, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/9c16066d18872bc17c561c64d017cac8?s=128&d=identicon&r=PG", "display_name": "Chris Young", "link": "https://stackoverflow.com/users/289136/chris-young"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 511, "favorite_count": 1, "accepted_answer_id": 31553785, "answer_count": 1, "score": 0, "last_activity_date": 1437539525, "creation_date": 1437531592, "last_edit_date": 1437532743, "question_id": 31552788, "link": "https://stackoverflow.com/questions/31552788/store-value-from-userform-into-excel-table", "title": "Store value from Userform into Excel Table", "body": "<p>First off I'm very sorry if this is a duplicate, I've been searching <strong>Stackoverflow</strong> and <strong>Google</strong> but not having much luck finding what I need.</p>\n\n<p>How do I store the value from a <strong><code>Userform</code></strong> text box into a Table in Excel with VBA?</p>\n\n<p>My Vars are called:</p>\n\n<pre><code>Userform text box - TxBox_Building.text\nTable Range - Range(\"Table5[BLDG]\")  \nTable Row long - lRow\n</code></pre>\n\n<p>So in Table5 Column with Heading BLDG, at row lRow I would like to put the value of TxBox_Building.text</p>\n\n<p>I'm just not sure how to reference the correct cell.\nI've seen many ways to store Userform data with direct references ( ie. <code>Sheet1 cell A5</code>)</p>\n\n<p>But don't know how to use a Formatted Table.</p>\n"}, {"tags": ["excel", "excel-2007", "pivot-table", "vba"], "comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1437548753, "post_id": 31552777, "comment_id": 51069182, "body": "You can&#39;t do that with or without VBA. A simple solution is to add month and year fields to your source data."}, {"owner": {"reputation": 57, "user_id": 2537150, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/cF5p1.gif?s=128&g=1", "display_name": "funSizes", "link": "https://stackoverflow.com/users/2537150/funsizes"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1437605900, "post_id": 31552777, "comment_id": 51105704, "body": "Thanks! I got it working now!"}, {"owner": {"reputation": 3845, "user_id": 4288101, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O0Xld.jpg?s=128&g=1", "display_name": "Byron Wall", "link": "https://stackoverflow.com/users/4288101/byron-wall"}, "edited": false, "score": 0, "creation_date": 1437681904, "post_id": 31552777, "comment_id": 51145789, "body": "Please add your solution and mark it answered.  It helps others and those of us looking for unanswered questions."}], "answers": [{"tags": [], "owner": {"reputation": 57, "user_id": 2537150, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/cF5p1.gif?s=128&g=1", "display_name": "funSizes", "link": "https://stackoverflow.com/users/2537150/funsizes"}, "is_accepted": true, "score": 0, "last_activity_date": 1438371090, "creation_date": 1438371090, "answer_id": 31753835, "question_id": 31552777, "link": "https://stackoverflow.com/questions/31552777/excel-2007-error-you-cannot-add-a-calculated-item-to-a-grouped-field-can-i-wor/31753835#31753835", "title": "Excel 2007 error: You cannot add a calculated item to a grouped field. Can I work around this in anyway? VBA maybe?", "body": "<p>The solution was to make the individual items into columns. There isn't a way to calculate items with grouped data. I don't have code to post I had to do it manually.</p>\n"}], "owner": {"reputation": 57, "user_id": 2537150, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/cF5p1.gif?s=128&g=1", "display_name": "funSizes", "link": "https://stackoverflow.com/users/2537150/funsizes"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1015, "favorite_count": 0, "accepted_answer_id": 31753835, "answer_count": 1, "score": 0, "last_activity_date": 1438371090, "creation_date": 1437531483, "last_edit_date": 1531164843, "question_id": 31552777, "link": "https://stackoverflow.com/questions/31552777/excel-2007-error-you-cannot-add-a-calculated-item-to-a-grouped-field-can-i-wor", "title": "Excel 2007 error: You cannot add a calculated item to a grouped field. Can I work around this in anyway? VBA maybe?", "body": "<p>I have tried to divide an item by another item. I group Date by Month and year and then I get this error \"You cannot add a calculated item to a grouped field\". I have tried everything except VBA.</p>\n\n<p>Is there a way around this without VBA or is VBA my answer!</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1437528953, "post_id": 31552405, "comment_id": 51062993, "body": "So what have you tried so far? You can use the <code>.Find</code> method on a range object, but you&#39;ll need to use some error-handling to account for what happens if the value is not found."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 2, "creation_date": 1437528975, "post_id": 31552405, "comment_id": 51063001, "body": "The <a href=\"https://support.office.com/en-us/article/index-function-0ee99cef-a811-4762-8cfb-a222dd31368a\" rel=\"nofollow noreferrer\">INDEX function</a> with a wildcarded <a href=\"https://support.office.com/en-us/article/match-function-0600e189-9f3c-4e4f-98c1-943a0eb427ca\" rel=\"nofollow noreferrer\">MATCH</a> can return the value from column A. Are you sure that VBA is required? Hmmm... perhaps columns B:T is too wide a range to make that practical."}], "answers": [{"tags": [], "owner": {"reputation": 142, "user_id": 5005877, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/58c26a1e401637d8fdb37b71a38339a9?s=128&d=identicon&r=PG&f=1", "display_name": "John F", "link": "https://stackoverflow.com/users/5005877/john-f"}, "is_accepted": false, "score": 0, "last_activity_date": 1437537603, "creation_date": 1437537603, "answer_id": 31553630, "question_id": 31552405, "link": "https://stackoverflow.com/questions/31552405/excel-2010-searching-a-range/31553630#31553630", "title": "Excel 2010 - Searching a range", "body": "<p>The Find method searches a range for a specific keyword/value</p>\n\n<pre><code>ThisWorkbook.Sheet1.Range(\"B:T\").Find(What:=\"*15-1050*\")\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 5141467, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7975a222febff3af8692843d867b6fa0?s=128&d=identicon&r=PG&f=1", "display_name": "Scorp1120", "link": "https://stackoverflow.com/users/5141467/scorp1120"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 46, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1437656473, "creation_date": 1437528662, "last_edit_date": 1437656473, "question_id": 31552405, "link": "https://stackoverflow.com/questions/31552405/excel-2010-searching-a-range", "title": "Excel 2010 - Searching a range", "body": "<p>I would like to search a table array for text and if that text is found, return the value in a corresponding cell for each occurrence.</p>\n\n<p>Example: \nSearch columns B:T for \"<em>15-1050</em>\"  if it is found, return the value of the  cell in column A of the row the occurrence was found.</p>\n\n<p>I have a schedule of projects. I need to know which employees are working on each project.  There are several employees assigned to a project.  Column A of the sheet lists the employee name and each project that the are schedule for is listed horizontally in a cell across the row.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1281, "user_id": 4106771, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/ec18b9c0947a0dcc3eaa9b4bbbb5e71f?s=128&d=identicon&r=PG&f=1", "display_name": "CBRF23", "link": "https://stackoverflow.com/users/4106771/cbrf23"}, "edited": false, "score": 0, "creation_date": 1437526243, "post_id": 31551700, "comment_id": 51062325, "body": "Are you using excel 2010? .xlsx format?"}, {"owner": {"reputation": 1281, "user_id": 4106771, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/ec18b9c0947a0dcc3eaa9b4bbbb5e71f?s=128&d=identicon&r=PG&f=1", "display_name": "CBRF23", "link": "https://stackoverflow.com/users/4106771/cbrf23"}, "edited": false, "score": 0, "creation_date": 1437526636, "post_id": 31551700, "comment_id": 51062412, "body": "Sorry, noticed your format is .xls in the code sample above - still, is this 2010? I think I may have a solution for you if it is."}, {"owner": {"reputation": 23, "user_id": 5141246, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffe850f7450ca3b4b19f824ab5ef7637?s=128&d=identicon&r=PG&f=1", "display_name": "SarahVBA", "link": "https://stackoverflow.com/users/5141246/sarahvba"}, "reply_to_user": {"reputation": 1281, "user_id": 4106771, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/ec18b9c0947a0dcc3eaa9b4bbbb5e71f?s=128&d=identicon&r=PG&f=1", "display_name": "CBRF23", "link": "https://stackoverflow.com/users/4106771/cbrf23"}, "edited": false, "score": 0, "creation_date": 1437527803, "post_id": 31551700, "comment_id": 51062700, "body": "@CBRF23 yes I am using excel 2010"}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 5141246, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffe850f7450ca3b4b19f824ab5ef7637?s=128&d=identicon&r=PG&f=1", "display_name": "SarahVBA", "link": "https://stackoverflow.com/users/5141246/sarahvba"}, "edited": false, "score": 3, "creation_date": 1437533323, "post_id": 31552526, "comment_id": 51063954, "body": "Thank you, it&#39;s a strange workaround but option 1 worked with the following adjustment: <code>If Book.name &lt;&gt; ThisWorkbook.name then Book.Close False</code>"}, {"owner": {"reputation": 1281, "user_id": 4106771, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/ec18b9c0947a0dcc3eaa9b4bbbb5e71f?s=128&d=identicon&r=PG&f=1", "display_name": "CBRF23", "link": "https://stackoverflow.com/users/4106771/cbrf23"}, "reply_to_user": {"reputation": 23, "user_id": 5141246, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffe850f7450ca3b4b19f824ab5ef7637?s=128&d=identicon&r=PG&f=1", "display_name": "SarahVBA", "link": "https://stackoverflow.com/users/5141246/sarahvba"}, "edited": false, "score": 0, "creation_date": 1437533727, "post_id": 31552526, "comment_id": 51064052, "body": "@SarahVBA - I just edited my code, see if it works using the <code>IS</code> operator for the boolean comparison of objects.  If it still doesn&#39;t work and you need to rely on comparing properties, I would suggest using <code>FullName</code> over <code>Name</code> in case you ever have two workbooks with the same name open from different paths."}], "tags": [], "owner": {"reputation": 1281, "user_id": 4106771, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/ec18b9c0947a0dcc3eaa9b4bbbb5e71f?s=128&d=identicon&r=PG&f=1", "display_name": "CBRF23", "link": "https://stackoverflow.com/users/4106771/cbrf23"}, "is_accepted": true, "score": 1, "last_activity_date": 1437533773, "last_edit_date": 1437533773, "creation_date": 1437529575, "answer_id": 31552526, "question_id": 31551700, "link": "https://stackoverflow.com/questions/31551700/excel-vba-code-to-move-worksheets-with-image-add-screen-updating-and-it-errors/31552526#31552526", "title": "Excel VBA code to move worksheets with image add screen updating and it errors", "body": "<p>Okay, so I don't know the exact cause (sorry - I have not seen an explanation for this yet) but I do know there is an issue with this in 2010.  I know of two possible workarounds:  </p>\n\n<p>1) you can try not closing the source workbooks until <em>after</em> you turn on screen updating.  This to me feels a little cargo cultish as I don't know the exact mechanism behind why this works.  Also, IIRC I don't think it works with images inserted as links.<br>\n2) you can try using Range.Copy, which should work with any image </p>\n\n<hr>\n\n<h2>Code Examples:</h2>\n\n<p><em>Code examples are totally untested</em><br>\nOption 1:  </p>\n\n<pre><code>Sub GetSheets()\n\nApplication.DisplayAlerts = False\nApplication.ScreenUpdating = False\n\nPath = \"G:\\Project Dashboards\\Testing Folder\\\"\n\nFilename = Dir(Path &amp; \"*.xls\")\nDo While Filename &lt;&gt; \"\"\n\n    Workbooks.Open Filename:=Path &amp; Filename, UpdateLinks:=True, ReadOnly:=True\n    Workbooks(Filename).Activate\n\n    Sheets(1).Move (after:=ThisWorkbook.Sheets(1)).Name = ActiveSheet.Cells(2, 17).Value\n\n    'Workbooks(Filename).Close False\n    Filename = Dir()\nLoop\n\nThisWorkbook.Save\nApplication.ScreenUpdating = True\n\nDim Book as Workbook\nFor Each Book in Workbooks\n    If Not Book Is ThisWorkbook then Book.Close False\nNext\n\nEnd Sub\n</code></pre>\n\n<p>option 2: </p>\n\n<pre><code>Sub GetSheets()\n\nApplication.DisplayAlerts = False\nApplication.ScreenUpdating = False\n\nPath = \"G:\\Project Dashboards\\Testing Folder\\\"\n\nDim SourceBook as Workbook\nDim TargetBook as Workbook\nDim OldSheet as Worksheet\nDim NewSheet as Worksheet\n\nFilename = Dir(Path &amp; \"*.xls\")\nDo While Filename &lt;&gt; \"\"\n    Set TargetBook=ThisWorkbook\n    Set Sourcebook=Workbooks.Open Filename:=Path &amp; Filename, UpdateLinks:=True, ReadOnly:=True\n    'Workbooks(Filename).Activate\n    Set OldSheet=Sourcebook.Sheets(1)\n    Set NewSheet=TargetBook.Worksheets.Add (After:=TargetBook.Sheets(1))\n    NewSheet.Name = OldSheet.Cells(2, 17).Value\n    OldSheet.Cells.Copy Destination:=NewSheet.Cells(1,1)\n    Sourcebook.Close False\n    Filename = Dir()\nLoop\n\nTargetBook.Save 'I assumed you wanted to save the workbook you added sheets to\nApplication.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 5141246, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffe850f7450ca3b4b19f824ab5ef7637?s=128&d=identicon&r=PG&f=1", "display_name": "SarahVBA", "link": "https://stackoverflow.com/users/5141246/sarahvba"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 663, "favorite_count": 0, "accepted_answer_id": 31552526, "answer_count": 1, "score": 2, "last_activity_date": 1437533773, "creation_date": 1437523536, "last_edit_date": 1437531532, "question_id": 31551700, "link": "https://stackoverflow.com/questions/31551700/excel-vba-code-to-move-worksheets-with-image-add-screen-updating-and-it-errors", "title": "Excel VBA code to move worksheets with image add screen updating and it errors", "body": "<p>I have an Excel 2010 macro that opens all workbooks in a given folder and moves Sheet1 from the new workbooks into a Master Workbook, which was working but extremely slow.  Today I updated it to include <code>Application.ScreenUpdating = False</code> to cut down on the processing time. There is a logo on Sheet1 and with the screen updating addition the logo is now showing the following error:</p>\n\n<p>\"This image cannot currently be displayed.\"</p>\n\n<p>I have done some research and have not found anything on this specific error. One solution suggested that I change to a blank page during the processing without screen updating, however it did not work. Based on other posts the error occurs frequently if you copy a worksheet, rather than move it, because the image is not part of a cell.</p>\n\n<p>Below is a simplified version of the code I am using that still causes the error:</p>\n\n<pre><code>Sub GetSheets()\n\nApplication.DisplayAlerts = False\nApplication.ScreenUpdating = False\n\nPath = \"G:\\Project Dashboards\\Testing Folder\\\"\n\nFilename = Dir(Path &amp; \"*.xls\")\nDo While Filename &lt;&gt; \"\"\n\nWorkbooks.Open Filename:=Path &amp; Filename, UpdateLinks:=True, ReadOnly:=True\nWorkbooks(Filename).Activate\n\nSheets(1).Move after:=ThisWorkbook.Sheets(1)\nActiveSheet.Name = ActiveSheet.Cells(2, 17).Value\n\nWorkbooks(Filename).Close False\nFilename = Dir()\nLoop\n\nActiveWorkbook.Save\nApplication.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n\n<p>If you comment out <code>Application.ScreenUpdating = False</code> the image is moved with the worksheet as desired.</p>\n"}, {"tags": ["vba", "ms-word", "cursor-position"], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 4342530, "user_type": "registered", "accept_rate": 20, "profile_image": "https://graph.facebook.com/1111038641/picture?type=large", "display_name": "Vince Earl", "link": "https://stackoverflow.com/users/4342530/vince-earl"}, "edited": false, "score": 0, "creation_date": 1437596631, "post_id": 31560111, "comment_id": 51101417, "body": "Thanks @Paul Ogilvie. Very helpful. I agree about authors making minor variations, but this will greatly help our editors make sure acronyms are properly defined, especially given that the vast majority of acronyms aren&#39;t defined by the authors of our documents. Running this program and then spending five minutes cleaning up in track changes is much better than spending 2-4 hours defining acronyms."}], "tags": [], "owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "is_accepted": true, "score": 0, "last_activity_date": 1437565279, "last_edit_date": 1437565279, "creation_date": 1437559741, "answer_id": 31560111, "question_id": 31551372, "link": "https://stackoverflow.com/questions/31551372/vba-compare-positions-of-two-words-in-a-word-document/31560111#31560111", "title": "VBA Compare positions of two words in a Word document", "body": "<p>I think the following code snippet can help you:</p>\n\n<pre><code>Sub example(acronym, definition)\n\n    Selection.Find.ClearFormatting\n    With Selection.Find\n        .Replacement.Text = \"\"\n        .Forward = True\n        .Wrap = wdFindStop\n        .Format = False\n        .MatchWholeWord = False\n        .MatchWildcards = False\n        .MatchAllWordForms = False\n    End With\n\n    ActiveDocument.Range(0, 0).Select      ' go to beginning of document\n    Selection.Find.Text = acronym\n    Selection.MatchSoundsLike = False\n    If (Not Selection.Find.Execute) Then\n        ' acronym not found in this document\n        Exit Sub\n    End If\n\n    ActiveDocument.Range(0, 0).Select      ' go to beginning of document\n    Selection.Find.Text = definition\n    Selection.MatchCase = False\n    Selection.MatchSoundsLike = True\n\n    While (Selection.Find.Execute)\n        '\n        Selection.Delete                    ' delete all definitions\n        '\n    Wend\n\n    ActiveDocument.Range(0, 0).Select       ' go to beginning of document\n    Selection.Find.Text = acronym\n    Selection.MatchSoundsLike = False\n    If (Selection.Find.Execute) Then\n        Selection.InsertBefore \"(\" &amp; definition &amp; \")\"\n    End If\n\nEnd Sub\n</code></pre>\n\n<p>Note: I also found that authors make mistakes in the definitions (minor variations) and even an extra unintended space messes up the find.</p>\n"}], "owner": {"reputation": 33, "user_id": 4342530, "user_type": "registered", "accept_rate": 20, "profile_image": "https://graph.facebook.com/1111038641/picture?type=large", "display_name": "Vince Earl", "link": "https://stackoverflow.com/users/4342530/vince-earl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 641, "favorite_count": 0, "accepted_answer_id": 31560111, "answer_count": 1, "score": 0, "last_activity_date": 1437565279, "creation_date": 1437521256, "question_id": 31551372, "link": "https://stackoverflow.com/questions/31551372/vba-compare-positions-of-two-words-in-a-word-document", "title": "VBA Compare positions of two words in a Word document", "body": "<p>I'm writing a module for defining acronyms in Word documents. The script gets the acronym and definition from an Excel document. What I'm having trouble with is comparing the location of the first instance of the acronym with the location of the first instance of the full definition.\nUltimately, I need to make sure the first instance of the acronym occurs immediately after the first instance of the definition, enclosed in parentheses. After this is done, the script will need to remove subsequent instances of the definition, so I also need to figure out how to remove all but the first instance of a definition.</p>\n\n<p>The end result should look something like this:</p>\n\n<blockquote>\n  <p>....This document is about software as a service (SaaS). SaaS is software that is hosted by someone else. Rather than installing it on your own computer, you access it through a Web browser. There are many types of SaaS.\n  ....</p>\n</blockquote>\n\n<p>How can I get the positions of these two elements and or compare their positions?</p>\n\n<p>In the example above, how would I find the first instance of \"SaaS\" and make sure it occurred exactly two positions after (space, open parentheses) the definition (assuming the definition actually appears in the document)?</p>\n\n<pre><code>'Selects first instance of acronym. Get start and end positions of first instance of acronym.\n    Selection.HomeKey Unit:=wdStory\n    Selection.Find.Execute Acronym 'Acronym is a variable. Now that it's selected, I need to get it's start position (or the position of the cursor if the cursor is at the start of the acronym) or find a way to compare it's position to the UserSelection variable.\n\n    'Is the definition in the document?\n\n        'If no, add definition before first instance of acronym.\n\n        'If yes, get start and end positions of first instance of definition.\n\n    'Is end position of first instance of definition adjacent to start position of first instance of acronym? If not, which is first?\n\n        'If definition is first, add acronym behind definition.\n\n        'If acronym is first, add definition in front of acronym and delete remaining instances of definition.\n\n    'Highlights all instances of the acronym in green\n        With ActiveDocument.Content.Find\n            .MatchCase = True\n            .MatchWholeWord = False\n            With .Replacement\n                .Highlight = True\n            End With\n            .Execute Replace:=wdReplaceAll, Wrap:=wdFindContinue, FindText:=Acronym, ReplaceWith:=Acronym\n        End With\n</code></pre>\n\n<p>Any help or insight would be appreciated, as I'm completely at a loss and having no luck with Google.</p>\n\n<p>-Vince</p>\n"}, {"tags": ["vba", "excel", "size", "range"], "comments": [{"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1437522515, "post_id": 31550759, "comment_id": 51061416, "body": "To draw a thick line <code>Range(&quot;C20:C21&quot;).Borders(xlEdgeBottom).LineStyle = xlContinuous</code> &amp; <code>xlEdgeTop</code> &amp; <code>Bottom</code> for the height and width use  <code>Range(&quot;C20:C21&quot;).ColumnWidth = 4</code> &amp; <code>Rows(&quot;3&quot;).RowHeight = 4</code>"}, {"owner": {"reputation": 31, "user_id": 5141173, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be255064f542f2fcfd9920f5ec4af1da?s=128&d=identicon&r=PG&f=1", "display_name": "alanjf", "link": "https://stackoverflow.com/users/5141173/alanjf"}, "reply_to_user": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1437523480, "post_id": 31550759, "comment_id": 51061647, "body": "@Omar Thanks, but I wasn&#39;t asking how to draw but how to get the width and height of ranges with the size of the boarders in between cells factored in."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1437523992, "post_id": 31550759, "comment_id": 51061773, "body": "In a quick test, adding a thick bottom border increased the reported height  of a single cell selection from 15 to 15.75   Maybe you could give some more detail around what the exact problem is?"}, {"owner": {"reputation": 31, "user_id": 5141173, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be255064f542f2fcfd9920f5ec4af1da?s=128&d=identicon&r=PG&f=1", "display_name": "alanjf", "link": "https://stackoverflow.com/users/5141173/alanjf"}, "edited": false, "score": 0, "creation_date": 1437526277, "post_id": 31550759, "comment_id": 51062334, "body": "What I&#39;m trying to do is create a ComboBox control and place it vertically exactly half way between two cells, like <code>testCB.Height = 16.5: testCB.Top = testCB.Top + ((r.Height &#47; 2) - (testCB.Height) &#47; 2)</code> but it ends up slightly off. It seemed that something was throwing off the calculation and I thought it was a border (maybe an outer one?)"}], "answers": [{"tags": [], "owner": {"reputation": 2239, "user_id": 2501529, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/5a02988d56793ff9794afab6d8d35af2?s=128&d=identicon&r=PG", "display_name": "Abe Gold", "link": "https://stackoverflow.com/users/2501529/abe-gold"}, "is_accepted": false, "score": 0, "last_activity_date": 1437534177, "creation_date": 1437534177, "answer_id": 31553132, "question_id": 31550759, "link": "https://stackoverflow.com/questions/31550759/how-to-get-full-height-and-width-of-range-including-borders/31553132#31553132", "title": "How to get full height and width of range, including borders?", "body": "<p>I think your calculation should be </p>\n\n<pre><code>testCB.Top = testCB.Top + ((r.Height - testCB.Height) / 2))\n</code></pre>\n\n<p>Or rather (not sure what your version even means)</p>\n\n<pre><code>testCB.Top = r.Top + ((r.Height - testCB.Height) / 2))\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2406, "user_id": 2482186, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/7Jtw1.jpg?s=128&g=1", "display_name": "R.Katnaan", "link": "https://stackoverflow.com/users/2482186/r-katnaan"}, "is_accepted": false, "score": 0, "last_activity_date": 1437537103, "creation_date": 1437537103, "answer_id": 31553552, "question_id": 31550759, "link": "https://stackoverflow.com/questions/31550759/how-to-get-full-height-and-width-of-range-including-borders/31553552#31553552", "title": "How to get full height and width of range, including borders?", "body": "<p>This can get the weight of border.</p>\n\n<pre><code>'If all borders are equal, you can take the weight as follow:\nRange(\"C20:C21\").Borders.Value\n\n'If you want a specific border, you can use as follow:\nRange(\"C20:C21\").Borders(xlEdgeLeft).Weight\n</code></pre>\n\n<p>If this is work for you, your calculation will be as follow:</p>\n\n<pre><code>height = Range(\"C20:C21\").Height + _\n         Range(\"C20:C21\").Borders(xlEdgeBottom).Weight + _\n         Range(\"C20:C21\").Borders(xlEdgeTop).Weight\n\nwidth = Range(\"C20:C21\").Width + _\n        Range(\"C20:C21\").Borders(xlEdgeLeft).Weight + _\n        Range(\"C20:C21\").Borders(xlEdgeRight).Weight\n</code></pre>\n\n<p>And If you also want border between two cell for height, you can use as follow:</p>\n\n<pre><code>height = Range(\"C20:C21\").Height + _\n         Range(\"C20:C21\").Borders(xlEdgeBottom).Weight + _\n         Range(\"C20:C21\").Borders(xlEdgeTop).Weight + _\n         Range(\"C20:C21\").Borders(xlInsideVertical).Weight\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 5141173, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be255064f542f2fcfd9920f5ec4af1da?s=128&d=identicon&r=PG&f=1", "display_name": "alanjf", "link": "https://stackoverflow.com/users/5141173/alanjf"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 467, "favorite_count": 1, "answer_count": 2, "score": 3, "last_activity_date": 1437537103, "creation_date": 1437517820, "question_id": 31550759, "link": "https://stackoverflow.com/questions/31550759/how-to-get-full-height-and-width-of-range-including-borders", "title": "How to get full height and width of range, including borders?", "body": "<p>I can't seem to find an answer to this anywhere.</p>\n\n<p>In VBA, given <code>Dim r As Range: Set r = Range(\"C20:C21\")</code> I can get <code>r.height</code> and <code>r.width</code>, where the former is the combined height of cells C20 and C21 but this doesn't include the size of the borders in between them.</p>\n\n<p>Is there a reliable method of obtaining the full combined height and width (e.g.: height and width of cells + size of the borders in between those cells) ?</p>\n\n<p>Thanks.</p>\n"}, {"tags": ["c++", "vba", "excel", "dll"], "answers": [{"comments": [{"owner": {"reputation": 37, "user_id": 5117046, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oYljK.jpg?s=128&g=1", "display_name": "Chris Iriarte", "link": "https://stackoverflow.com/users/5117046/chris-iriarte"}, "edited": false, "score": 0, "creation_date": 1437670914, "post_id": 31556455, "comment_id": 51139307, "body": "Thanks Charles, that sounds like the way to go.  -Chris"}], "tags": [], "owner": {"reputation": 21725, "user_id": 88173, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/114b7dea411e3648a54fa459c89bed40?s=128&d=identicon&r=PG", "display_name": "Charles Williams", "link": "https://stackoverflow.com/users/88173/charles-williams"}, "is_accepted": false, "score": 0, "last_activity_date": 1437549830, "creation_date": 1437549830, "answer_id": 31556455, "question_id": 31550683, "link": "https://stackoverflow.com/questions/31550683/turning-a-dll-and-associated-vba-into-an-xll/31556455#31556455", "title": "Turning a DLL (and associated VBA) into an XLL", "body": "<p>The XLL interface does not cover as much of the Excel object model as VBA, and is less productive for user interface tasks. But it has many advantages over VBA for building UDFs (performance, UDF registration, multithreading etc).</p>\n\n<p>So my recommendation would be to convert all the UDFs to XLL but keep the function wizards and any other user interface stuff in a VBA XLAM.</p>\n"}], "owner": {"reputation": 37, "user_id": 5117046, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oYljK.jpg?s=128&g=1", "display_name": "Chris Iriarte", "link": "https://stackoverflow.com/users/5117046/chris-iriarte"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 272, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1437549830, "creation_date": 1437517445, "question_id": 31550683, "link": "https://stackoverflow.com/questions/31550683/turning-a-dll-and-associated-vba-into-an-xll", "title": "Turning a DLL (and associated VBA) into an XLL", "body": "<p>As a summer project, I got handed a large C++ file with numerous (over 50) functions and was asked to make it interface with Excel.  I created a DLL from the C++ file and wrote some VBA procedures to create function wrappers, function wizards, and populate cell ranges with the correct data.</p>\n\n<p>As I have to hand this off to someone else, I would like to turn this into an XLL add-in so the pathway to the DLL in the VBA \"Declare Function\" doesn't get broken, as well as having a cleaner setup.</p>\n\n<p>My question is, what becomes of the VBA code in the process of turning this into an XLL add-in?  Do those functions have to be re-written into the C++ file?</p>\n\n<p>Chris</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2035, "user_id": 4567411, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97708ca7070a2e4f32bee58c29a54360?s=128&d=identicon&r=PG&f=1", "display_name": "rwilson", "link": "https://stackoverflow.com/users/4567411/rwilson"}, "edited": false, "score": 0, "creation_date": 1437517633, "post_id": 31550407, "comment_id": 51059879, "body": "How are you calling the function? What do you pass inside LastCell?"}, {"owner": {"reputation": 2395, "user_id": 1803908, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/RCEu7.jpg?s=128&g=1", "display_name": "Newskooler", "link": "https://stackoverflow.com/users/1803908/newskooler"}, "reply_to_user": {"reputation": 2035, "user_id": 4567411, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97708ca7070a2e4f32bee58c29a54360?s=128&d=identicon&r=PG&f=1", "display_name": "rwilson", "link": "https://stackoverflow.com/users/4567411/rwilson"}, "edited": false, "score": 0, "creation_date": 1437517767, "post_id": 31550407, "comment_id": 51059915, "body": "Let&#39;s say I have a column from <code>A1:A400</code> filled with dates. I wish to be able to get the value in cell <code>A400</code> by inputting the value in cell <code>A1</code>, so my formula should look like this: <code>LastCell(A1)</code> should equal to the value in cell <code>A400</code>"}, {"owner": {"reputation": 2035, "user_id": 4567411, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97708ca7070a2e4f32bee58c29a54360?s=128&d=identicon&r=PG&f=1", "display_name": "rwilson", "link": "https://stackoverflow.com/users/4567411/rwilson"}, "edited": false, "score": 0, "creation_date": 1437518062, "post_id": 31550407, "comment_id": 51060024, "body": "You are going to need to put quotes around A1. So it should be LastCell(&quot;A1&quot;)."}, {"owner": {"reputation": 2395, "user_id": 1803908, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/RCEu7.jpg?s=128&g=1", "display_name": "Newskooler", "link": "https://stackoverflow.com/users/1803908/newskooler"}, "reply_to_user": {"reputation": 2035, "user_id": 4567411, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97708ca7070a2e4f32bee58c29a54360?s=128&d=identicon&r=PG&f=1", "display_name": "rwilson", "link": "https://stackoverflow.com/users/4567411/rwilson"}, "edited": false, "score": 0, "creation_date": 1437518227, "post_id": 31550407, "comment_id": 51060095, "body": "@rwilson it did work with my code and your input about putting the quotes. How can I get rid of them though?"}, {"owner": {"reputation": 2035, "user_id": 4567411, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97708ca7070a2e4f32bee58c29a54360?s=128&d=identicon&r=PG&f=1", "display_name": "rwilson", "link": "https://stackoverflow.com/users/4567411/rwilson"}, "edited": false, "score": 0, "creation_date": 1437518603, "post_id": 31550407, "comment_id": 51060218, "body": "I don&#39;t know if you can. If you don&#39;t have the quotes &quot;Option Explicit&quot; sees it as a variable not defined."}, {"owner": {"reputation": 2395, "user_id": 1803908, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/RCEu7.jpg?s=128&g=1", "display_name": "Newskooler", "link": "https://stackoverflow.com/users/1803908/newskooler"}, "reply_to_user": {"reputation": 2035, "user_id": 4567411, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97708ca7070a2e4f32bee58c29a54360?s=128&d=identicon&r=PG&f=1", "display_name": "rwilson", "link": "https://stackoverflow.com/users/4567411/rwilson"}, "edited": false, "score": 0, "creation_date": 1437518685, "post_id": 31550407, "comment_id": 51060248, "body": "I see, well I will keep searching for a way, as it does make a big difference. Thanks for the input!"}], "answers": [{"comments": [{"owner": {"reputation": 2395, "user_id": 1803908, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/RCEu7.jpg?s=128&g=1", "display_name": "Newskooler", "link": "https://stackoverflow.com/users/1803908/newskooler"}, "edited": false, "score": 0, "creation_date": 1437517009, "post_id": 31550586, "comment_id": 51059656, "body": "Thank you for the input Jeepad, however I am looking for a VBA solution, as I wish to add some filters once I have the basic in place."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 1, "last_activity_date": 1437516932, "creation_date": 1437516932, "answer_id": 31550586, "question_id": 31550407, "link": "https://stackoverflow.com/questions/31550407/function-that-finds-last-row-in-excel-using-vba/31550586#31550586", "title": "Function that finds last row in Excel using VBA", "body": "<p>Your lookup is fine with numbers but will return <code>#N/A</code> if the column contains only text or possibly the wrong answer if mixed text and numbers. A more definitive formula might be,</p>\n\n<pre><code>=max(iferror(match(1e99, B:B), 0), iferror(match(\"\u017e\u017e\u017e\", B:B), 0))\n</code></pre>\n\n<p>That will identify the row with the last number, date or text value. Errors are ignored.</p>\n"}, {"tags": [], "owner": {"reputation": 2035, "user_id": 4567411, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97708ca7070a2e4f32bee58c29a54360?s=128&d=identicon&r=PG&f=1", "display_name": "rwilson", "link": "https://stackoverflow.com/users/4567411/rwilson"}, "is_accepted": false, "score": 0, "last_activity_date": 1437518172, "last_edit_date": 1437518172, "creation_date": 1437517742, "answer_id": 31550743, "question_id": 31550407, "link": "https://stackoverflow.com/questions/31550407/function-that-finds-last-row-in-excel-using-vba/31550743#31550743", "title": "Function that finds last row in Excel using VBA", "body": "<p>When calling the function try:</p>\n\n<pre><code>MsgBox LastCell(ActiveCell.Address)\n</code></pre>\n\n<p>In the example you gave, you need to call the function like this:</p>\n\n<pre><code>LastCell(\"A1\")\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2395, "user_id": 1803908, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/RCEu7.jpg?s=128&g=1", "display_name": "Newskooler", "link": "https://stackoverflow.com/users/1803908/newskooler"}, "edited": false, "score": 0, "creation_date": 1437518069, "post_id": 31550747, "comment_id": 51060028, "body": "This looks like you understand what I am trying to do, however it gives me a Compile error: Invalid qualifier"}, {"owner": {"reputation": 2035, "user_id": 4567411, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97708ca7070a2e4f32bee58c29a54360?s=128&d=identicon&r=PG&f=1", "display_name": "rwilson", "link": "https://stackoverflow.com/users/4567411/rwilson"}, "edited": false, "score": 0, "creation_date": 1437518103, "post_id": 31550747, "comment_id": 51060043, "body": "It&#39;s just the way your calling it."}, {"owner": {"reputation": 5583, "user_id": 4556996, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/amIjI.jpg?s=128&g=1", "display_name": "Dan Donoghue", "link": "https://stackoverflow.com/users/4556996/dan-donoghue"}, "edited": false, "score": 0, "creation_date": 1437519812, "post_id": 31550747, "comment_id": 51060639, "body": "In the sheet enter =LastCell(&quot;A1&quot;) or in VBA code use MsgBox LastCell(Range(&quot;A1&quot;))"}], "tags": [], "owner": {"reputation": 5583, "user_id": 4556996, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/amIjI.jpg?s=128&g=1", "display_name": "Dan Donoghue", "link": "https://stackoverflow.com/users/4556996/dan-donoghue"}, "is_accepted": false, "score": 0, "last_activity_date": 1437517760, "creation_date": 1437517760, "answer_id": 31550747, "question_id": 31550407, "link": "https://stackoverflow.com/questions/31550407/function-that-finds-last-row-in-excel-using-vba/31550747#31550747", "title": "Function that finds last row in Excel using VBA", "body": "<p>This will work, Come from the bottom up rather than the top down:</p>\n\n<pre><code>LastCell = cells(rows.count,CellA.column).End(xlUp).Value\n</code></pre>\n\n<p>This returns the value of the last cell (Similar to your code), if you want the address then change .Value to .Address.</p>\n\n<p>Edit: Also change the dim of CellA from String to Range</p>\n"}, {"comments": [{"owner": {"reputation": 2395, "user_id": 1803908, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/RCEu7.jpg?s=128&g=1", "display_name": "Newskooler", "link": "https://stackoverflow.com/users/1803908/newskooler"}, "edited": false, "score": 0, "creation_date": 1437559643, "post_id": 31556594, "comment_id": 51076096, "body": "Thank you, this is what I was looking for!"}], "tags": [], "owner": {"reputation": 21725, "user_id": 88173, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/114b7dea411e3648a54fa459c89bed40?s=128&d=identicon&r=PG", "display_name": "Charles Williams", "link": "https://stackoverflow.com/users/88173/charles-williams"}, "is_accepted": true, "score": 1, "last_activity_date": 1437550243, "creation_date": 1437550243, "answer_id": 31556594, "question_id": 31550407, "link": "https://stackoverflow.com/questions/31550407/function-that-finds-last-row-in-excel-using-vba/31556594#31556594", "title": "Function that finds last row in Excel using VBA", "body": "<p>Try this code<br></p>\n\n<pre><code>Option Explicit\nFunction LastCell(CellA As range)\n    LastCell = CellA.End(xlDown).Value\nEnd Function\n</code></pre>\n\n<p>use it as =LastCell(B1)</p>\n\n<p>Note that this method does not work well with hidden or filtered rows or merged cells.</p>\n"}], "owner": {"reputation": 2395, "user_id": 1803908, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/RCEu7.jpg?s=128&g=1", "display_name": "Newskooler", "link": "https://stackoverflow.com/users/1803908/newskooler"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 679, "favorite_count": 0, "accepted_answer_id": 31556594, "answer_count": 4, "score": 1, "last_activity_date": 1437550243, "creation_date": 1437516143, "last_edit_date": 1437516572, "question_id": 31550407, "link": "https://stackoverflow.com/questions/31550407/function-that-finds-last-row-in-excel-using-vba", "title": "Function that finds last row in Excel using VBA", "body": "<p>I am trying to build a simple function that has 1 cell input based on which, it offsets the last consecutively filled cell in this roll.</p>\n\n<pre><code>Option Explicit\nFunction LastCell(CellA As String)\n\n    LastCell = Range(CellA).End(xlDown).Value\n\nEnd Function\n</code></pre>\n\n<p>For some reason, it is not work...</p>\n\n<p>Without VBA, I achieve the desired result through: <code>=LOOKUP(9E+50,B:B)</code> for example. </p>\n\n<p>Not a very elegant and not always useful. </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 4, "creation_date": 1437516169, "post_id": 31550311, "comment_id": 51059303, "body": "Okay what is messing around? <code>VBA Code?</code> may we see it what have you tried so far, and where your attempt  fail?"}, {"owner": {"reputation": 3, "user_id": 5141098, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/182c83fd061e37f97e257def434df942?s=128&d=identicon&r=PG&f=1", "display_name": "jdahl32", "link": "https://stackoverflow.com/users/5141098/jdahl32"}, "reply_to_user": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1437661842, "post_id": 31550311, "comment_id": 51132492, "body": "Sorry for not posting what I had, I have never used this site and I am just breaking into some basic macro to help out my company.  From now on, I will post what I have attempted.  @Omar"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 5141098, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/182c83fd061e37f97e257def434df942?s=128&d=identicon&r=PG&f=1", "display_name": "jdahl32", "link": "https://stackoverflow.com/users/5141098/jdahl32"}, "edited": false, "score": 0, "creation_date": 1437661643, "post_id": 31554056, "comment_id": 51132327, "body": "Thanks for the feedback! This is what I ended up figuring out prior to the answers:    LastRow = Sheets(&quot;Prod Data Pivot&quot;).Range(&quot;E&quot; &amp; Rows.Count).End(xlUp).Row  LastCol = Range(&quot;A1&quot;).End(xlToRight).Column  Sheets(&quot;Prod Data Pivot&quot;).Range(&quot;E6:E&quot; &amp; LastRow).Copy  Sheets(1).Range(&quot;G15&quot;).PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=False  @AndrewT"}, {"owner": {"reputation": 438, "user_id": 3007188, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WbZIr.jpg?s=128&g=1", "display_name": "AndrewT", "link": "https://stackoverflow.com/users/3007188/andrewt"}, "reply_to_user": {"reputation": 3, "user_id": 5141098, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/182c83fd061e37f97e257def434df942?s=128&d=identicon&r=PG&f=1", "display_name": "jdahl32", "link": "https://stackoverflow.com/users/5141098/jdahl32"}, "edited": false, "score": 0, "creation_date": 1437968158, "post_id": 31554056, "comment_id": 51235552, "body": "@jdahl32 no problem, so has that solved your problem? if so check the box otherwise let me know if I can help further."}], "tags": [], "owner": {"reputation": 438, "user_id": 3007188, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WbZIr.jpg?s=128&g=1", "display_name": "AndrewT", "link": "https://stackoverflow.com/users/3007188/andrewt"}, "is_accepted": true, "score": 0, "last_activity_date": 1437540449, "creation_date": 1437540449, "answer_id": 31554056, "question_id": 31550311, "link": "https://stackoverflow.com/questions/31550311/copy-paste-1-column-dynamic-range-into-separate-worksheet/31554056#31554056", "title": "Copy/paste 1 column, dynamic range, into separate worksheet", "body": "<p>Welcome to stackoverflow :)</p>\n\n<pre><code>Range(\"E6\", Range(\"E\" &amp; ActiveSheet.Rows.Count).End(xlUp)).Copy\nRange(\"G\" &amp; ActiveSheet.Rows.Count).End(xlUp).Offset(1, 0).PasteSpecial\n</code></pre>\n\n<p>Looks confusing but this is what it means:</p>\n\n<p>Range of E6 to bottom of the row Ctrl+Up arrow</p>\n\n<p>Copy</p>\n\n<p>Bottom of row G ctrl+up arrow then down one to the next blank</p>\n\n<p>Paste </p>\n\n<p>In future if you want help make sure to show enough detail to prove you have had a go and are not just wanting it written for you, that is what the comment above is on about.</p>\n\n<p>Good luck</p>\n"}], "owner": {"reputation": 3, "user_id": 5141098, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/182c83fd061e37f97e257def434df942?s=128&d=identicon&r=PG&f=1", "display_name": "jdahl32", "link": "https://stackoverflow.com/users/5141098/jdahl32"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 830, "favorite_count": 1, "accepted_answer_id": 31554056, "answer_count": 1, "score": -3, "last_activity_date": 1437540449, "creation_date": 1437515761, "question_id": 31550311, "link": "https://stackoverflow.com/questions/31550311/copy-paste-1-column-dynamic-range-into-separate-worksheet", "title": "Copy/paste 1 column, dynamic range, into separate worksheet", "body": "<p>I'm looking to copy a dynamically changing range of values from column E, starting at row 6, and paste into another worksheet (starting at column G row 15).  The numbers can be pasted as values.</p>\n\n<p>Essentially, I would like the copy function to stop when the row becomes blank.</p>\n\n<p>Pretty much a newbie with VBA but I have done some messing around with it.</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 6025, "user_id": 3053082, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/cf7725958a43181e6b2b4c0f5f02b91b?s=128&d=identicon&r=PG&f=1", "display_name": "Kapol", "link": "https://stackoverflow.com/users/3053082/kapol"}, "edited": false, "score": 0, "creation_date": 1437516946, "post_id": 31550210, "comment_id": 51059632, "body": "Please show what you&#39;ve tried."}], "answers": [{"tags": [], "owner": {"reputation": 1703, "user_id": 1174399, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a14a1c76042e287e36b1c765fb1eaaa5?s=128&d=identicon&r=PG", "display_name": "Don Jewett", "link": "https://stackoverflow.com/users/1174399/don-jewett"}, "is_accepted": false, "score": 0, "last_activity_date": 1437522552, "creation_date": 1437522552, "answer_id": 31551556, "question_id": 31550210, "link": "https://stackoverflow.com/questions/31550210/type-check-using-vba/31551556#31551556", "title": "Type Check using VBA", "body": "<p>You could use the Val function to get the numeric part of a string. Val will also return 0 if the value is not numeric or empty string. You could combine this with IsNumeric in your While condition.</p>\n\n<pre><code>Dim vVal As Variant\nDim nVal As Long\n\nvVal = Worksheets(\"Shifts\").Cells(6, \"K\").Value\nnVal = Val(vVal)\n\nWhile duration &lt; nVal &amp;&amp; IsNumeric(vVal)\n    ...\nWend\n</code></pre>\n\n<p>References:</p>\n\n<ul>\n<li><a href=\"https://support.office.com/en-nz/article/Val-Function-e5e1f21b-22f9-41c9-bd0a-fe55b767f603\" rel=\"nofollow\">Val Function - VBA</a></li>\n<li><a href=\"https://support.office.com/en-za/article/IsNumeric-Function-67795d2f-e53e-47a3-b107-c39df0ae2559\" rel=\"nofollow\">IsNumeric Function - VBA</a></li>\n</ul>\n"}], "owner": {"reputation": 33, "user_id": 5025206, "user_type": "registered", "profile_image": "https://graph.facebook.com/1092910807390080/picture?type=large", "display_name": "Christian Gatmaitan", "link": "https://stackoverflow.com/users/5025206/christian-gatmaitan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 136, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1437522552, "creation_date": 1437515314, "last_edit_date": 1437515724, "question_id": 31550210, "link": "https://stackoverflow.com/questions/31550210/type-check-using-vba", "title": "Type Check using VBA", "body": "<p>I have written some code that reads a spreadsheet that is filled with procedures that will be carried out by workers and divides them into \"shifts\" based on the duration of each activity so that preparation for certain steps can be made before. </p>\n\n<p>I am looking for some help, as if someone inputs text that is not an integer (a note or something) into the \"duration\" tab, (which is stored as <strong><code>\"X\"</code></strong> in this code) the macro stops prematurely. </p>\n\n<p>I was thinking I could use an if statement to check this, perhaps the <strong><code>\"IsNumeric()\"</code></strong> function, but it would not run and I knew I was not doing it correctly.</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n\n'define variables\nDim duration As Integer, n As Long, i As Integer, x As Integer, m As Long\nDim toolRange As Range, partRange As Range, perRange As Range, workRange As Range, ppeRange As Range\n\nn = 3 'indicates row\nm = 3 'concatenation counter\nduration = 0 'duration counter\nx = 0 'duration placeholder\n\nFor i = 1 To 100 'Assumed max 50 shifts (This can be changed or solved with more code, but should be set higher than predicted # of shifts)\n\n    duration = 0 'resets duration for next count\n\n        While duration &lt; Worksheets(\"Shifts\").Cells(6, \"K\").Value 'shift length can be altered\n\n            x = Worksheets(\"SR060-SR070\").Cells(n, \"F\").Value\n                    duration = duration + x 'adds duration until it is over 320\n                    n = n + 1\n        Wend\n\n    With Worksheets(\"SR060-SR070\")\n        Set toolRange = .Range(.Cells(m, \"H\"), .Cells(n, \"H\")) 'creates tool range\n    End With\n\n    With Worksheets(\"SR060-SR070\")\n        Set partRange = .Range(.Cells(m, \"I\"), .Cells(n, \"I\")) 'creates part range\n    End With\n\n    With Worksheets(\"SR060-SR070\")\n        Set perRange = .Range(.Cells(m, \"E\"), .Cells(n, \"E\")) 'creates per range\n    End With\n\n    With Worksheets(\"SR060-SR070\")\n        Set workRange = .Range(.Cells(m, \"P\"), .Cells(n, \"P\")) 'creates permit range\n    End With\n\n    With Worksheets(\"SR060-SR070\")\n        Set ppeRange = .Range(.Cells(m, \"Q\"), .Cells(n, \"Q\")) 'creates ppe range\n    End With\n\n    Worksheets(\"Shifts\").Cells(i + 1, 1).Value = i 'creates shift\n    Worksheets(\"Shifts\").Cells(i + 1, 2).Value = Application.Max(perRange) 'creates max per\n    Worksheets(\"Shifts\").Cells(i + 1, 3).Value = duration 'creates duration\n    'Worksheets(\"Shifts\").Cells(i + 1, 4).Value = ConcatenateAllCellValuesInRange(toolRange) 'inputs tools\n    Worksheets(\"Shifts\").Cells(i + 1, 4).Value = ConcatUniq(toolRange, \" \") 'inputs tools\n    'Worksheets(\"Shifts\").Cells(i + 1, 5).Value = ConcatenateAllCellValuesInRange(partRange) 'inputs parts\n    Worksheets(\"Shifts\").Cells(i + 1, 5).Value = ConcatUniq(partRange, \" \") 'inputs parts\n    'Worksheets(\"Shifts\").Cells(i + 1, 6).Value = ConcatenateAllCellValuesInRange(workRange) 'inputs permits\n    Worksheets(\"Shifts\").Cells(i + 1, 6).Value = ConcatUniq(workRange, \" \") 'inputs permits\n    'Worksheets(\"Shifts\").Cells(i + 1, 7).Value = ConcatenateAllCellValuesInRange(ppeRange) 'inputs ppe\n    Worksheets(\"Shifts\").Cells(i + 1, 7).Value = ConcatUniq(ppeRange, \" \") 'inputs ppe\n    m = n 'Allows it to segement down page\n\n\nNext i 'goes to next shift\n\nEnd Sub\n\n'Concatenate function\nFunction ConcatUniq(ByRef rng As Range, _\n    ByVal myJoin As String) As String\n    Dim r As Range\n    Static dic As Object\n    If dic Is Nothing Then _\n    Set dic = CreateObject(\"Scripting.Dictionary\")\n    For Each r In rng\n        dic(r.Value) = Empty\n    Next\n    ConcatUniq = Join$(dic.keys, myJoin)\n    dic.RemoveAll\nEnd Function\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 158, "user_id": 5140522, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f20dbde4800427532201c142e97a25b3?s=128&d=identicon&r=PG&f=1", "display_name": "JJJJ", "link": "https://stackoverflow.com/users/5140522/jjjj"}, "edited": false, "score": 0, "creation_date": 1437514195, "post_id": 31549861, "comment_id": 51058414, "body": "I just did... it didn&#39;t work...I think I&#39;ll just have to do a one laaarrrrrgggeee single line... Thank you!"}, {"owner": {"reputation": 1135, "user_id": 5063263, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b9dadb72e3e03e28dc7f64b43353f1e5?s=128&d=identicon&r=PG&f=1", "display_name": "ivan", "link": "https://stackoverflow.com/users/5063263/ivan"}, "reply_to_user": {"reputation": 158, "user_id": 5140522, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f20dbde4800427532201c142e97a25b3?s=128&d=identicon&r=PG&f=1", "display_name": "JJJJ", "link": "https://stackoverflow.com/users/5140522/jjjj"}, "edited": false, "score": 0, "creation_date": 1437514200, "post_id": 31549861, "comment_id": 51058418, "body": "yeap just tested it with the + instead of the &quot;_&quot; it does works for me in VB you just have to add the &quot; in every string separating each line by a + ill edit my answer to show you an example good luck btw"}, {"owner": {"reputation": 1703, "user_id": 1174399, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a14a1c76042e287e36b1c765fb1eaaa5?s=128&d=identicon&r=PG", "display_name": "Don Jewett", "link": "https://stackoverflow.com/users/1174399/don-jewett"}, "edited": false, "score": 1, "creation_date": 1437514328, "post_id": 31549861, "comment_id": 51058471, "body": "That&#39;s correct, ivan, with some corrections noted here: 1) Use &amp; rather than + for string concatenation. 2) use the _ to continue the line."}, {"owner": {"reputation": 1135, "user_id": 5063263, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b9dadb72e3e03e28dc7f64b43353f1e5?s=128&d=identicon&r=PG&f=1", "display_name": "ivan", "link": "https://stackoverflow.com/users/5063263/ivan"}, "edited": false, "score": 0, "creation_date": 1437514380, "post_id": 31549861, "comment_id": 51058501, "body": "nah, go ahead all yours :P"}, {"owner": {"reputation": 1703, "user_id": 1174399, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a14a1c76042e287e36b1c765fb1eaaa5?s=128&d=identicon&r=PG", "display_name": "Don Jewett", "link": "https://stackoverflow.com/users/1174399/don-jewett"}, "edited": false, "score": 0, "creation_date": 1437514418, "post_id": 31549861, "comment_id": 51058522, "body": "You may also want to mention using vbCrLf to format the SQL with lines, which it appears OP is trying to do."}, {"owner": {"reputation": 1135, "user_id": 5063263, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b9dadb72e3e03e28dc7f64b43353f1e5?s=128&d=identicon&r=PG&f=1", "display_name": "ivan", "link": "https://stackoverflow.com/users/5063263/ivan"}, "edited": false, "score": 0, "creation_date": 1437514583, "post_id": 31549861, "comment_id": 51058601, "body": "heres the vbCrLf info i read it a while ago... <a href=\"http://stackoverflow.com/a/27223391/5063263\">stackoverflow.com/a/27223391/5063263</a>"}, {"owner": {"reputation": 1135, "user_id": 5063263, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b9dadb72e3e03e28dc7f64b43353f1e5?s=128&d=identicon&r=PG&f=1", "display_name": "ivan", "link": "https://stackoverflow.com/users/5063263/ivan"}, "edited": false, "score": 0, "creation_date": 1437515215, "post_id": 31549861, "comment_id": 51058891, "body": "thanks for the edit. i really need to learn how to keep my work clean"}, {"owner": {"reputation": 2177, "user_id": 1211997, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/289e883b1531a6c68ce799642e3b918e?s=128&d=identicon&r=PG", "display_name": "rheitzman", "link": "https://stackoverflow.com/users/1211997/rheitzman"}, "edited": false, "score": 1, "creation_date": 1437515529, "post_id": 31549861, "comment_id": 51059039, "body": "I suggest you always begin your continued lines with a space e.g.       &amp; &quot; FROM... &quot; It is very easy to not see a missing space at the end of  a line that may be off screen."}, {"owner": {"reputation": 1703, "user_id": 1174399, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a14a1c76042e287e36b1c765fb1eaaa5?s=128&d=identicon&r=PG", "display_name": "Don Jewett", "link": "https://stackoverflow.com/users/1174399/don-jewett"}, "edited": false, "score": 0, "creation_date": 1437515559, "post_id": 31549861, "comment_id": 51059047, "body": "No problem. You might also want to break that long line so it doesn&#39;t scroll. The answer kind of gets lost."}], "tags": [], "owner": {"reputation": 1135, "user_id": 5063263, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b9dadb72e3e03e28dc7f64b43353f1e5?s=128&d=identicon&r=PG&f=1", "display_name": "ivan", "link": "https://stackoverflow.com/users/5063263/ivan"}, "is_accepted": true, "score": 4, "last_activity_date": 1565796206, "last_edit_date": 1565796206, "creation_date": 1437513790, "answer_id": 31549861, "question_id": 31549809, "link": "https://stackoverflow.com/questions/31549809/the-use-of-in-vba-always-get-error/31549861#31549861", "title": "The use of &quot;_&quot; in vba always get error", "body": "<p>The _ character continues the line so you can use &amp; to join more strings. </p>\n\n<p>Have you tried it doing it like this? </p>\n\n<pre><code>  sqlString = \"SELECT ISNULL([Yes Def],0), ISNULL(totalcount,0),\" _\n    &amp; \" ISNULL(([Yes Def]+0.0)/(totalcount+0.0) * 100,0) \" _\n    &amp; \" FROM [WAREHOUSE].[dbo].[SurveyQuestionDim]\" _\n    &amp; \" LEFT OUTER JOIN\" \n</code></pre>\n\n<p>Another example:</p>\n\n<pre><code>\"Data Source=1xx.1xx.1.1xx\\SERVER123,1433;Initial Catalog=DB;\" _\n    &amp; \"Persist Security Info=True;User ID=ANYID;Password=\"\n</code></pre>\n\n<p>You have to have a space before the _ to continue the line and then the &amp; concatenates the next line.</p>\n"}, {"comments": [{"owner": {"reputation": 1703, "user_id": 1174399, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a14a1c76042e287e36b1c765fb1eaaa5?s=128&d=identicon&r=PG", "display_name": "Don Jewett", "link": "https://stackoverflow.com/users/1174399/don-jewett"}, "edited": false, "score": 2, "creation_date": 1437515456, "post_id": 31550011, "comment_id": 51059012, "body": "IMO placing the &amp; on the following line makes it clearer what is happening, especially to a new coder. Then the _ visually does what it logically does (break the line) and the &amp; visually does what it logically does, concatenate the following string."}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 1, "last_activity_date": 1437515279, "last_edit_date": 1437515279, "creation_date": 1437514438, "answer_id": 31550011, "question_id": 31549809, "link": "https://stackoverflow.com/questions/31549809/the-use-of-in-vba-always-get-error/31550011#31550011", "title": "The use of &quot;_&quot; in vba always get error", "body": "<p>As noted in the <a href=\"https://msdn.microsoft.com/en-us/library/ba9sxbw4.aspx\" rel=\"nofollow\">MSDN Reference</a>, you can't continue in the middle of a string. You must continue the line and concatenate the strings. Therefore you need to use both the string concatenation character <code>&amp;</code> and the line continuation character <code>_</code>.</p>\n\n<pre><code>sqlString = _\n       \"text text text text text text text text \" &amp; _\n       \"text text text text text text text text \" &amp; _\n       \"text text text text text text\"\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 5583, "user_id": 4556996, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/amIjI.jpg?s=128&g=1", "display_name": "Dan Donoghue", "link": "https://stackoverflow.com/users/4556996/dan-donoghue"}, "is_accepted": false, "score": 1, "last_activity_date": 1437517949, "creation_date": 1437517949, "answer_id": 31550777, "question_id": 31549809, "link": "https://stackoverflow.com/questions/31549809/the-use-of-in-vba-always-get-error/31550777#31550777", "title": "The use of &quot;_&quot; in vba always get error", "body": "<p>This is how I do it, it keeps it really nicely formatted so if I need to drop it in a query analyser it is formatted.</p>\n\n<pre><code>    sqlText = \"Select trim(customer.cmpy_code) || trim(customer.cust_code) cust_code,\"\n    sqlText = sqlText &amp; vbLf &amp; \"    trim(Customer.name_text) name_text,\"\n    sqlText = sqlText &amp; vbLf &amp; \"    salesstat.ord_ind,\"\n    sqlText = sqlText &amp; vbLf &amp; \"    sum(salesstat.net_amt-salesstat.return_net_amt) Gross_Revenue\"\n    sqlText = sqlText &amp; vbLf &amp; \"from    Customer,\"\n    sqlText = sqlText &amp; vbLf &amp; \"    salesstat,\"\n    sqlText = sqlText &amp; vbLf &amp; \"    warereptdetl\"\n    sqlText = sqlText &amp; vbLf &amp; \"Where   salesstat.cmpy_code = '\" &amp; QueryType &amp; \"'\"\n    sqlText = sqlText &amp; vbLf &amp; \"and customer.cmpy_code = '\" &amp; QueryType &amp; \"'\"\n    sqlText = sqlText &amp; vbLf &amp; \"and customer.cust_code = salesstat.cust_code\"\n    sqlText = sqlText &amp; vbLf &amp; \"and salesstat.rept_code = '0'\"\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1302, "user_id": 5516239, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/OGWVo.png?s=128&g=1", "display_name": "Nathangrad", "link": "https://stackoverflow.com/users/5516239/nathangrad"}, "is_accepted": false, "score": 0, "last_activity_date": 1470153795, "creation_date": 1470153795, "answer_id": 38725447, "question_id": 31549809, "link": "https://stackoverflow.com/questions/31549809/the-use-of-in-vba-always-get-error/38725447#38725447", "title": "The use of &quot;_&quot; in vba always get error", "body": "<p>Even though this question has already been answered, I just want to suggest to anyone viewing this post to use Stored Procedures as opposed to writing large SQL queries as strings in C# or VB code.<br><br>\nHow it would be done in this specific example:</p>\n\n<pre><code>CREATE PROCEDURE ProcedureName AS \nSELECT ISNULL([Yes Def],0), ISNULL(totalcount,0), \nISNULL(([Yes Def]+0.0)/(totalcount+0.0) * 100,0) \nFROM [WAREHOUSE].[dbo].[SurveyQuestionDim] \nLEFT OUTER JOIN (SELECT SurveyQuestionKey, SUM(CASE WHEN Response = \n'Yes, definitely' THEN 1 ELSE 0 END) AS [Yes Def], COUNT(1) AS totalcount \nFROM [WAREHOUSE].[dbo].[SurveyAnswerFact] WHERE ([providerkey] = 26387) \nAND ([SurveyQuestionKey] IN (470,477,479,481,483)) \nAND ([ResponseDateKey] BETWEEN 20140601 AND 20150531) \nGROUP BY SurveyQuestionKey ) t1 ON t1.[SurveyQuestionKey] = \n[WAREHOUSE].[dbo].[SurveyQuestionDim].[SurveyQuestionKey] \nWHERE [WAREHOUSE].[dbo].[SurveyQuestionDim].[SurveyQuestionKey] IN \n(470,477,479,481,483) ORDER BY [WAREHOUSE].[dbo].[SurveyQuestionDim].[SurveyQuestionKey]\n</code></pre>\n"}], "owner": {"reputation": 158, "user_id": 5140522, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f20dbde4800427532201c142e97a25b3?s=128&d=identicon&r=PG&f=1", "display_name": "JJJJ", "link": "https://stackoverflow.com/users/5140522/jjjj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 481, "favorite_count": 0, "accepted_answer_id": 31549861, "answer_count": 4, "score": 1, "last_activity_date": 1565796206, "creation_date": 1437513613, "last_edit_date": 1531164843, "question_id": 31549809, "link": "https://stackoverflow.com/questions/31549809/the-use-of-in-vba-always-get-error", "title": "The use of &quot;_&quot; in vba always get error", "body": "<p>My SQL query is really long so I tried to use _ to make them in separate lines. But I always got \"compile error: Expected: end of statement\" at \"FROM\" in the 3rd line. But I don't know where I got it wrong. Thanks everyone.</p>\n\n<pre><code>sqlString = _\n\"SELECT ISNULL([Yes Def],0), ISNULL(totalcount,0), ISNULL(([Yes Def]+0.0)/(totalcount+0.0) * 100,0) _\nFROM [WAREHOUSE].[dbo].[SurveyQuestionDim] _\nleft outer join _\n( _\nSELECT SurveyQuestionKey,  sum(case when Response = 'Yes, definitely' then 1 else 0 end) as [Yes Def], count(1) as totalcount _\nFROM [WAREHOUSE].[dbo].[SurveyAnswerFact] _\nWHERE ([providerkey] = 26387) _\nAND ([SurveyQuestionKey] IN (470,477,479,481,483)) _\nAND ([ResponseDateKey] BETWEEN 20140601 AND 20150531) _\nGROUP BY SurveyQuestionKey ) t1 _\non t1.[SurveyQuestionKey] = [WAREHOUSE].[dbo].[SurveyQuestionDim].[SurveyQuestionKey] _\nWHERE [WAREHOUSE].[dbo].[SurveyQuestionDim].[SurveyQuestionKey] IN (470,477,479,481,483) _\nORDER BY [WAREHOUSE].[dbo].[SurveyQuestionDim].[SurveyQuestionKey] \"\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 5140913, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b5f8af98c9486d1a3281fc523bbb8c68?s=128&d=identicon&r=PG&f=1", "display_name": "milkaw", "link": "https://stackoverflow.com/users/5140913/milkaw"}, "edited": false, "score": 0, "creation_date": 1437583135, "post_id": 31549832, "comment_id": 51093249, "body": "Ok, found this to complete the installation <a href=\"http://www.mrexcel.com/forum/excel-questions/467397-morefunc-release-excel-2010-a.html\" rel=\"nofollow noreferrer\">link</a>"}], "tags": [], "owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "is_accepted": false, "score": 0, "last_activity_date": 1437513696, "creation_date": 1437513696, "answer_id": 31549832, "question_id": 31549775, "link": "https://stackoverflow.com/questions/31549775/alternative-to-excel-indirect-that-works-on-closed-files-and-links-to-workbook/31549832#31549832", "title": "Alternative to Excel INDIRECT that works on closed files, and links to workbook based on cell value?", "body": "<p>The free add-in <a href=\"http://download.cnet.com/Morefunc/3000-2077_4-10423159.html\" rel=\"nofollow\">morefunc.xll</a> contains a function called Indirect.Ext, which works with closed worbooks. </p>\n"}], "owner": {"reputation": 1, "user_id": 5140913, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b5f8af98c9486d1a3281fc523bbb8c68?s=128&d=identicon&r=PG&f=1", "display_name": "milkaw", "link": "https://stackoverflow.com/users/5140913/milkaw"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1890, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1437513696, "creation_date": 1437513488, "question_id": 31549775, "link": "https://stackoverflow.com/questions/31549775/alternative-to-excel-indirect-that-works-on-closed-files-and-links-to-workbook", "title": "Alternative to Excel INDIRECT that works on closed files, and links to workbook based on cell value?", "body": "<p>I've seen many questions on this forum about linking Excel files based on cell values and INDIRECT always pops up as an answer, and it does do function and fill my sheet the way that I want, but I need to find a way to work with the source file being closed. My problem when it comes to linking, is that the file path to pull the data from will not be known until part of the file name is entered into a cell. </p>\n\n<p>For example, in 'Print Summary' workbook, Sheet1 Cell A2 is where the file name is entered as a number 12345 (and gets auto-formatted to place 'WIP' in front) which represents WIP12345.xls. WIP12345.xls is a form that holds information that needs to populate certain columns across row 2. WIP12345.xls is an order form and completed days ahead. Once it has been approved, the summary workbook is updated with the WIP#.</p>\n\n<p>I did CONCATENATE WIP12345 and .xls to create the file name WIP12345.xls on Sheet2, and I have a Macro that copies and pastes special as value to turn the result into text. But, I can't find a way to create a formula that will take this value and lookup the file to pull information from. I need to pull and fill information from  different cells to 10 columns down 43 rows (each row representing a different WIP#####.xls file).</p>\n\n<p>I'm guessing VBA is the only way to go, but I have no idea how to write it. Anyone have a direction they can point me in? I hope I'm coming across clearly.</p>\n"}]