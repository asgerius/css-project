[{"tags": ["excel", "vba", "integration", "powerpoint"], "comments": [{"owner": {"reputation": 12482, "user_id": 1667023, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JXaUt.png?s=128&g=1", "display_name": "Steve Rindsberg", "link": "https://stackoverflow.com/users/1667023/steve-rindsberg"}, "edited": false, "score": 0, "creation_date": 1527779803, "post_id": 50614862, "comment_id": 88265207, "body": "Is there any pattern to which links are updated and which are not?  Also, please indicate which version/edition and build of PPT you&#39;re using."}, {"owner": {"reputation": 1, "user_id": 9872556, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8991f2c7d01ab2c65da475342a788eef?s=128&d=identicon&r=PG&f=1", "display_name": "user691194", "link": "https://stackoverflow.com/users/9872556/user691194"}, "reply_to_user": {"reputation": 12482, "user_id": 1667023, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JXaUt.png?s=128&g=1", "display_name": "Steve Rindsberg", "link": "https://stackoverflow.com/users/1667023/steve-rindsberg"}, "edited": false, "score": 0, "creation_date": 1527804193, "post_id": 50614862, "comment_id": 88277113, "body": "Yes, all worksheet objects are updated but none of the charts. i.e. when you call the Excel Edit Links window, all of &quot;Type: Chart&quot; are NOT updated, and all other links, i.e. &quot;Type: Worksheet&quot; are updated. Also, the macro runs super slow - any advise on speed optimization? I am using Office 2016/365, version 1708, Build 8431.2250"}, {"owner": {"reputation": 12482, "user_id": 1667023, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JXaUt.png?s=128&g=1", "display_name": "Steve Rindsberg", "link": "https://stackoverflow.com/users/1667023/steve-rindsberg"}, "edited": false, "score": 0, "creation_date": 1527869067, "post_id": 50614862, "comment_id": 88305149, "body": "I thought that might be the case. msoChart objects are native PowerPoint charts, not linked Excel chart objects. Here, if I select one of these and try e.g. MsgBox ActiveWindow.Selection.ShapeRange(1).LinkFormat.SourceFullna&zwnj;&#8203;me I get an error message: LinkFormat (unknown member): Invalid request. This operation requires a linked object."}, {"owner": {"reputation": 12482, "user_id": 1667023, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JXaUt.png?s=128&g=1", "display_name": "Steve Rindsberg", "link": "https://stackoverflow.com/users/1667023/steve-rindsberg"}, "edited": false, "score": 0, "creation_date": 1527869300, "post_id": 50614862, "comment_id": 88305245, "body": "Re the macro running slowly:  Probably because it&#39;s firing up Excel each time you call Update (and possibly also when you change the link&#39;s source file name).  Add a break point when you start updating the links and watch for instances of Excel in TaskManager as you step through the code.  Then try manually opening the chosen Excel file before running the code, see if that substantially speeds things up."}], "owner": {"reputation": 1, "user_id": 9872556, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8991f2c7d01ab2c65da475342a788eef?s=128&d=identicon&r=PG&f=1", "display_name": "user691194", "link": "https://stackoverflow.com/users/9872556/user691194"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 556, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1527724742, "creation_date": 1527724742, "question_id": 50614862, "link": "https://stackoverflow.com/questions/50614862/strange-behavior-on-running-powerpoint-vba-updating-excel-links", "title": "Strange behavior on running Powerpoint VBA updating Excel links", "body": "<p>I need some help with some bizzare VBA code behavior in Powerpoint. Purpose is simple - update Excel links on a Powerpoint presentation. I have a presentation with objects linked to an Excel file. On running the code from Powerpoint, a user is prompted to select the source Excel file on the harddrive, and the location of this Excel file is used to replace the previous location of the Excel file, already saved in the PowerPoint presentation.\nYou run the macro, check the links, their path is updated. You click save, close the presentation. You open the presentation and all is good.\nNow let\u2019s say you change the name of the Excel file. You run the macro, check the links, their path is updated. You click save, close the presentation. You open the presentation and ONLY HALF THE LINKS ARE UPDATED. Could somebody take a look? Thanks!</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n\nDim xlApp As Object\nDim xlWorkBook As Object\n\nDim pptSlide As Slide\nDim pptShape As Shape\n\nDim oldString, tempString, newString As String\nDim intLength As Integer\n\nDim sPath As String\n\nDim ExcelFileName As String\n\nDim fd As Office.FileDialog\n\n    Set fd = Application.FileDialog(msoFileDialogFilePicker)\n\n           With fd\n\n              .AllowMultiSelect = False\n\n              ' Set the title of the dialog box.\n              .Title = \"Please select the file to update links in the presentation\"\n\n              ' Clear out the current filters, and add our own.\n              .Filters.Clear\n              .Filters.Add \"Excel Workbook\", \"*.xlsx\"\n\n\n              ' Show the dialog box. If the .Show method returns True, the\n              ' user picked at least one file. If the .Show method returns\n              ' False, the user clicked Cancel.\n                  If .Show = True Then\n                    newString = .SelectedItems(1) 'replace txtFileName with your textbox\n\n                  End If\n           End With\n\n'show \"macro running\" screen\n    UserForm1.Show False\n\n'open excel file with links\n    Set xlApp = CreateObject(\"Excel.Application\")\n    Set xlWorkBook = xlApp.Workbooks.Open(newString, True, False)\n\n'grab old full path to replace link in objects\n\n    For Each pptSlide In ActivePresentation.Slides\n        For Each pptShape In pptSlide.Shapes\n            If pptShape.Type = msoLinkedOLEObject Then\n                    tempString = pptShape.LinkFormat.SourceFullName\n                    intLength = InStr(tempString, \"!\")\n                    oldString = Mid(tempString, 1, intLength - 1)\n                GoTo 1\n            End If\n            If pptShape.Type = msoChart Then\n                oldString = pptShape.LinkFormat.SourceFullName\n                GoTo 1\n            End If\n        Next pptShape\n    Next pptSlide\n1\n\n'replace old full path to new full path\n    For Each pptSlide In ActivePresentation.Slides\n        For Each pptShape In pptSlide.Shapes\n            If pptShape.Type = msoLinkedOLEObject Or pptShape.Type = msoChart Then\n                With pptShape.LinkFormat\n                    If InStr(1, UCase(.SourceFullName), UCase(oldString)) Then\n                        .SourceFullName = Replace(.SourceFullName, oldString, newString)\n                    End If\n                End With\n            pptShape.LinkFormat.Update\n            End If\n        'DoEvents\n        Next pptShape\n    'DoEvents\n    Next pptSlide\n\n'close excel file with links\n    xlWorkBook.Close (False)\n\n    xlApp.Quit\n\n    Set xlApp = Nothing\n    Set xlWorkBook = Nothing\n\n'hide \"macro running\" screen\nUserForm1.Hide\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "error-handling", "range", "cells"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1527724682, "post_id": 50614620, "comment_id": 88239489, "body": "When <code>rr</code> is zero then <code>rr*2</code> is still zero, and there&#39;s no column zero..."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1527725684, "post_id": 50614620, "comment_id": 88239762, "body": "Which should be the first column populated with &quot;EMPTY&quot; ?"}, {"owner": {"reputation": 11, "user_id": 9571787, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9ab28c62f7bf79173a0875a1aab3cfb?s=128&d=identicon&r=PG&f=1", "display_name": "Katherine. E", "link": "https://stackoverflow.com/users/9571787/katherine-e"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1527725974, "post_id": 50614620, "comment_id": 88239820, "body": "Oh I should have caught that. I fixed with rr = 1 to #. It should be column B. Thank you!"}], "owner": {"reputation": 11, "user_id": 9571787, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9ab28c62f7bf79173a0875a1aab3cfb?s=128&d=identicon&r=PG&f=1", "display_name": "Katherine. E", "link": "https://stackoverflow.com/users/9571787/katherine-e"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 15, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1527722811, "creation_date": 1527722811, "question_id": 50614620, "link": "https://stackoverflow.com/questions/50614620/application-defined-or-object-defined-error-with-range-and-cells", "title": "Application-defined or Object-defined Error with Range and Cells", "body": "<p>I'm trying to use VBA to update cells in a sheet \"Allocation TEST\" in a variable number of columns, found in sheet \"Worksheet\". The code is saved in Module1.</p>\n\n<p>I'm getting an error at the .Range line. What am I doing wrong? </p>\n\n<pre><code>Sub resetDoors()\nDim TotalDoorsR As Integer\nDim rr As Integer\n\nTotalDoorsR = ThisWorkbook.Sheets(\"Worksheet\").Range(\"C14\").Value\n\nFor rr = 0 To TotalDoorsR\n    With ThisWorkbook.Sheets(\"Allocation TEST\")\n        .Range(.Cells(4, rr * 2), .Cells(18, rr * 2)).Value = \"EMPTY\"\n    End With\n    Next\n\nOn Error Resume Next\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "declare", "vba"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 1, "creation_date": 1527722037, "post_id": 50614408, "comment_id": 88238889, "body": "What you&#39;re asking cannot be done in VBA although it can be doe in <a href=\"https://stackoverflow.com/questions/tagged/asp-classic\">asp-classic</a> and I think <a href=\"https://stackoverflow.com/questions/tagged/vbscript\">vbscript</a>. You need to work with arrays or possibly named ranges."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1527722343, "post_id": 50614408, "comment_id": 88238955, "body": "btw, your loop creates A1:A2, A1:B4, A1:C6, etc."}, {"owner": {"reputation": 3359, "user_id": 4604845, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/88d81c9b06f65d860bb60c31ab062e7e?s=128&d=identicon&r=PG&f=1", "display_name": "Vegard", "link": "https://stackoverflow.com/users/4604845/vegard"}, "edited": false, "score": 1, "creation_date": 1527724385, "post_id": 50614408, "comment_id": 88239426, "body": "Have a look at <code>Scripting.Dictionary</code>. The syntax would be a little more verbose, but (based on your example) it should be able to give you very similar functionality."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1527725767, "post_id": 50614408, "comment_id": 88239778, "body": "Use an array of type Range, dimensioned from 1 to n.  You can&#39;t have variable variable names in VBA, and since it seems <code>i</code>is the real key here, you can just use that directly against an array."}], "owner": {"reputation": 34, "user_id": 9588300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/170090a148fbde6f625387e15f0b6437?s=128&d=identicon&r=PG&f=1", "display_name": "Eugenio.Gastelum96", "link": "https://stackoverflow.com/users/9588300/eugenio-gastelum96"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 5073, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1527721165, "creation_date": 1527721165, "last_edit_date": 1531164843, "question_id": 50614408, "link": "https://stackoverflow.com/questions/50614408/set-variable-name-with-string-variable-in-vba", "title": "Set variable name with string variable in VBA", "body": "<p>I have to create many variables inside a loop, so I need to create generic variable names (note, for the purpose of my code, i can't just append the objects i want to create to a list or collection)</p>\n\n<p>The code I was thinking looks something like this (n is a user defined variable, and its an integer)</p>\n\n<pre><code>Dim var_name As String\n\nFor i = 1 To n\n    var_name = \"test\" &amp; i\n    Set var_name = Range(Cells(1, 1), Cells(i * 2, i))\nNext i\n</code></pre>\n\n<p>I would like to obtain variables like this:</p>\n\n<ul>\n<li>test1 being a range from A1 to B2</li>\n<li>test2 being a range from A1 to C4</li>\n<li>test3 being a range from A1 to D6</li>\n<li>.... testn being a range from A1 to whatever</li>\n</ul>\n\n<p>They dont necesarily have to be range, <strong>all I really want is to declare a variable name using a string stored in another variable</strong></p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1527719673, "post_id": 50614124, "comment_id": 88238262, "body": "If the editors aren&#39;t adding/removing rows or columns then you could use a hidden copy of the original sheet and conditional formatting to compare the cell content between the two sheets."}, {"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 1, "creation_date": 1527719853, "post_id": 50614124, "comment_id": 88238313, "body": "Yes, you can use the target and event change features to trigger a formatting. I would personally not highlight and have the macro build a table on a hidden sheet that just lists all cells that have been changed. But, that\u2019s just preference. Changing colors may incentivize some unexpected behaviors. Regardless, I\u2019m positive this is a duplicate question to an extent. Have you done any research?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1527721687, "post_id": 50614124, "comment_id": 88238792, "body": "Why isn&#39;t Track Changes an option?"}, {"owner": {"reputation": 707, "user_id": 6404012, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-nccfgilpFMs/AAAAAAAAAAI/AAAAAAAAAbY/Om5Ipcplj7U/photo.jpg?sz=128", "display_name": "Eitel Dagnin", "link": "https://stackoverflow.com/users/6404012/eitel-dagnin"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1527755663, "post_id": 50614124, "comment_id": 88249666, "body": "@TimWilliams thank you for your reply, I actually received that exact response from a user on the other forum. Posted the answer below. :)"}, {"owner": {"reputation": 707, "user_id": 6404012, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-nccfgilpFMs/AAAAAAAAAAI/AAAAAAAAAbY/Om5Ipcplj7U/photo.jpg?sz=128", "display_name": "Eitel Dagnin", "link": "https://stackoverflow.com/users/6404012/eitel-dagnin"}, "edited": false, "score": 0, "creation_date": 1527755709, "post_id": 50614124, "comment_id": 88249691, "body": "@Jeeped I am not familiar with &#39;Track Changes&#39;. I will look into it  though. For now, the answer I found to be working is below. :)"}, {"owner": {"reputation": 707, "user_id": 6404012, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-nccfgilpFMs/AAAAAAAAAAI/AAAAAAAAAbY/Om5Ipcplj7U/photo.jpg?sz=128", "display_name": "Eitel Dagnin", "link": "https://stackoverflow.com/users/6404012/eitel-dagnin"}, "reply_to_user": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1527756098, "post_id": 50614124, "comment_id": 88249907, "body": "@urdearboy Yes I have done research and yes I agree to a certain extent this could be seen as a duplicate question, but so can pretty much any question that is asked. However, my lack in knowledge on the subject lead me to asking the question for guidance on how to solve my issue. Regardless, thank you for your reply."}], "answers": [{"tags": [], "owner": {"reputation": 707, "user_id": 6404012, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-nccfgilpFMs/AAAAAAAAAAI/AAAAAAAAAbY/Om5Ipcplj7U/photo.jpg?sz=128", "display_name": "Eitel Dagnin", "link": "https://stackoverflow.com/users/6404012/eitel-dagnin"}, "is_accepted": false, "score": 0, "last_activity_date": 1527756215, "creation_date": 1527756215, "answer_id": 50620153, "question_id": 50614124, "link": "https://stackoverflow.com/questions/50614124/excel-conditional-formatting-fo-when-any-cell-in-usedrange-changes-value/50620153#50620153", "title": "Excel - Conditional Formatting fo When Any Cell in UsedRange Changes Value", "body": "<p>Answer received here and working perfectly:</p>\n\n<p><a href=\"https://www.tek-tips.com/viewthread.cfm?qid=1787250\" rel=\"nofollow noreferrer\">https://www.tek-tips.com/viewthread.cfm?qid=1787250</a></p>\n\n<p><em>COPY the SHEET and name it Review, for instance.</em></p>\n\n<p><em>Then HIDE the original sheet.</em></p>\n\n<p><em>Given that the original (hidden) sheet name is Original, in the Review sheet:</em></p>\n\n<p><em>Select the Used Range. The TOP LEFT cell in my selection is A2.</em></p>\n\n<p><em>Open the CF Wizard</em></p>\n\n<p><em>Use a formula to determine which cell to format</em></p>\n\n<p><em>=A2&lt;>Original!A2</em></p>\n\n<p><em>...and select a FORMAT.</em></p>\n"}], "owner": {"reputation": 707, "user_id": 6404012, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-nccfgilpFMs/AAAAAAAAAAI/AAAAAAAAAbY/Om5Ipcplj7U/photo.jpg?sz=128", "display_name": "Eitel Dagnin", "link": "https://stackoverflow.com/users/6404012/eitel-dagnin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 156, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1527756215, "creation_date": 1527719002, "question_id": 50614124, "link": "https://stackoverflow.com/questions/50614124/excel-conditional-formatting-fo-when-any-cell-in-usedrange-changes-value", "title": "Excel - Conditional Formatting fo When Any Cell in UsedRange Changes Value", "body": "<p>Also posted here:</p>\n\n<p><a href=\"https://www.tek-tips.com/viewthread.cfm?qid=1787250\" rel=\"nofollow noreferrer\">https://www.tek-tips.com/viewthread.cfm?qid=1787250</a></p>\n\n<p>I have to send workbooks off to managers in different departments and in each workbook, the managers might amend/change certain fields. The fields are not necessarily the same all the time, for example:</p>\n\n<p>Manager 1 - Changes 3 fields in column A, 2 fields in column M and nothing on the rest of the sheet</p>\n\n<p>Manager 2 - Changes 1 field in columns C - F, 5 fields in column J and 7 fields in column Y</p>\n\n<p>Manager 3 - Changes 2 fields in column A, 4 fields in column B and nothing on the rest of the sheet</p>\n\n<p>So I have a macro I am using in another workbook that will compare an 'original' version of a workbook with an 'updated' version but it only looks for differences in one specific column - so perhaps I could modify that macro to accomplish this task.</p>\n\n<p>Here is the link to the macro I am referring to:</p>\n\n<p><a href=\"https://stackoverflow.com/questions/50386657/vba-copy-cells-from-column-a-and-b-and-paste-in-new-sheet\">VBA - Copy Cells from Column A and B and Paste in New Sheet</a></p>\n\n<p>I was however wondering, is there no kind of conditional formatting rule that can be applied to the workbooks - BEFORE they are sent to the managers - that highlights a row when a value in that row has been changed and changes the colour of the text in that cell? If there is even something like that which exists...</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 8541, "user_id": 8366499, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/z9t89.jpg?s=128&g=1", "display_name": "divibisan", "link": "https://stackoverflow.com/users/8366499/divibisan"}, "edited": false, "score": 0, "creation_date": 1527716914, "post_id": 50613523, "comment_id": 88237474, "body": "Where will the macro be located (on many users individual computers or on a single server)? Where will you need to store/access the information (from within the macro? In a database? To satisfy your personal curiosity?)"}, {"owner": {"reputation": 19, "user_id": 9872785, "user_type": "registered", "profile_image": "https://graph.facebook.com/10211681191841674/picture?type=large", "display_name": "Caleb Edwards", "link": "https://stackoverflow.com/users/9872785/caleb-edwards"}, "reply_to_user": {"reputation": 8541, "user_id": 8366499, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/z9t89.jpg?s=128&g=1", "display_name": "divibisan", "link": "https://stackoverflow.com/users/8366499/divibisan"}, "edited": false, "score": 0, "creation_date": 1527717629, "post_id": 50613523, "comment_id": 88237709, "body": "It will end up being on a handful of individual computers on a singular server.  The purpose is really just to verify that the people using the document are using the Macros and not carrying over old, un-validated information."}], "answers": [{"comments": [{"owner": {"reputation": 19, "user_id": 9872785, "user_type": "registered", "profile_image": "https://graph.facebook.com/10211681191841674/picture?type=large", "display_name": "Caleb Edwards", "link": "https://stackoverflow.com/users/9872785/caleb-edwards"}, "edited": false, "score": 0, "creation_date": 1527716891, "post_id": 50613600, "comment_id": 88237462, "body": "I&#39;m going to attempt to break down my code in terms that don&#39;t make me sound completely new to technology...  I have a &quot;MAIN&quot; Module that runs two separate Macros; one clears out all data in the worksheet, the other clears out more specific data.  The &quot;MAIN&quot; module references to other Modules to perform this.  I created the code you recommended in my &quot;MAIN&quot;, and it created the MsgBox, but only when I step through it in VBA, not when I select either ClickButton.  I attempted putting the code in the two other Modules but was unsuccessful there.  Any further advice?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1527719941, "post_id": 50613600, "comment_id": 88238336, "body": "This only counts during a single session - as soon as the VB project is reset (due to a code error for example) or (eg) the file is closed, the value is lost."}], "tags": [], "owner": {"reputation": 2003, "user_id": 6414203, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9b25f1c657b4306a0d459c874e859789?s=128&d=identicon&r=PG&f=1", "display_name": "Alan", "link": "https://stackoverflow.com/users/6414203/alan"}, "is_accepted": false, "score": 0, "last_activity_date": 1527715768, "creation_date": 1527715768, "answer_id": 50613600, "question_id": 50613523, "link": "https://stackoverflow.com/questions/50613523/vba-adding-counter-for-tracking/50613600#50613600", "title": "VBA - Adding Counter For Tracking", "body": "<p>Use <code>static</code> when declaring your variable.</p>\n\n<p>From <a href=\"https://onestopanalytics.wordpress.com/2009/01/14/static-public-arrays-in-vba/\" rel=\"nofollow noreferrer\">\"EXCEL\" Ytics</a>:</p>\n\n<h1>Can we declare a variable to retain its value from a previous run?</h1>\n\n<p>Static Declaration within a procedure limits the variable to that procedure \u2013 but helps retain values of variables from previous runs, until forcefully reinitialized by explicit declaration using \u2018ReDim\u2019 or value setting.</p>\n\n<pre><code>Sub MySub( )\n    Static Cnt As Integer\n    Dim Msg As String\n    Cnt = Cnt + 1\n    Msg = \u201cYou\u2019ve run the procedure \u201d &amp; Cnt &amp; \u201d times\u201d\n    MsgBox Msg\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 19, "user_id": 9872785, "user_type": "registered", "profile_image": "https://graph.facebook.com/10211681191841674/picture?type=large", "display_name": "Caleb Edwards", "link": "https://stackoverflow.com/users/9872785/caleb-edwards"}, "edited": false, "score": 0, "creation_date": 1527716979, "post_id": 50613609, "comment_id": 88237497, "body": "I placed this code in mine and attempted to step through it, but it failed at the line &quot;Set counterWS = ThisWorkbook.Worksheets(&quot;Counter&quot;).  Do you have any advice on how to debug this?  I&#39;m not sure if this makes a difference or not, but my code is in a Module..."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 19, "user_id": 9872785, "user_type": "registered", "profile_image": "https://graph.facebook.com/10211681191841674/picture?type=large", "display_name": "Caleb Edwards", "link": "https://stackoverflow.com/users/9872785/caleb-edwards"}, "edited": false, "score": 1, "creation_date": 1527720000, "post_id": 50613609, "comment_id": 88238359, "body": "@CalebEdwards -  You probably don&#39;t have a worksheet named &quot;Counter&quot;"}, {"owner": {"reputation": 19, "user_id": 9872785, "user_type": "registered", "profile_image": "https://graph.facebook.com/10211681191841674/picture?type=large", "display_name": "Caleb Edwards", "link": "https://stackoverflow.com/users/9872785/caleb-edwards"}, "edited": false, "score": 0, "creation_date": 1527727319, "post_id": 50613609, "comment_id": 88240111, "body": "@TFrazee and TimWilliams - thank you both.  I was able to add this into my code and achieved the desired result.  I did make some minor modifications with help from a co-worker:   &#39;Dim runCount1 As Integer Dim counterWS As Worksheet Set counterWS = ThisWorkbook.Worksheets(&quot;MoWCount&quot;)  &#39;If counterWS.Cells(1, 1) &lt;&gt; vbNullString And IsNumeric(counterWS.Cells(1, 1)) Then     runCount1 = runCount1 + 1 &#39;Else &#39;    runCount1 = 1 &#39;End If  counterWS.Cells(1, 1) = runCount1"}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1527780057, "post_id": 50613609, "comment_id": 88265366, "body": "Rather than just hiding the sheet, might as well very hide it.  A hidden sheet can be unhid(<i>is that even a word?</i>) through the menus, a very hidden sheet can only be unhid using VBA or through the VBEditor (can be found in the <i>Properties</i> of the sheet)."}], "tags": [], "owner": {"reputation": 677, "user_id": 3692993, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df58980e773a17b1c4258c5c143bb0e0?s=128&d=identicon&r=PG&f=1", "display_name": "TFrazee", "link": "https://stackoverflow.com/users/3692993/tfrazee"}, "is_accepted": false, "score": 1, "last_activity_date": 1527777765, "last_edit_date": 1527777765, "creation_date": 1527715806, "answer_id": 50613609, "question_id": 50613523, "link": "https://stackoverflow.com/questions/50613523/vba-adding-counter-for-tracking/50613609#50613609", "title": "VBA - Adding Counter For Tracking", "body": "<p>Excel VBA doesn't have any built-in storage that persists across sessions - when the application is closed, all variables are released.  However you do have a readily available source of storage - the workbook itself.  Here's one way to do it:</p>\n\n<p>Make a worksheet called <code>Counter</code> (or something). Optionally, hide it so no one messes with it.  Then, when your macro runs, increment the value of <code>Cell(1,1)</code>, which will hold your counter value.</p>\n\n<pre><code>Dim runCount As Integer\nDim counterWS As Worksheet\nSet counterWS = ThisWorkbook.Worksheets(\"Counter\")\n\nIf counterWS.Cells(1,1) &lt;&gt; vbNullString And IsNumeric(counterWS.Cells(1,1)) Then\n    runCount = counterWS.Cells(1,1) + 1\nElse\n    runCount = 1\nEnd If\n\ncounterWS.Cells(1,1) = runCount\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 19, "user_id": 9872785, "user_type": "registered", "profile_image": "https://graph.facebook.com/10211681191841674/picture?type=large", "display_name": "Caleb Edwards", "link": "https://stackoverflow.com/users/9872785/caleb-edwards"}, "edited": false, "score": 0, "creation_date": 1527726434, "post_id": 50614510, "comment_id": 88239910, "body": "I attempted this one, but every time I run my macro, it is deleting the &quot;MacroCount&quot; sheet I created... Any advice going forward?  @urdearboy"}, {"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "reply_to_user": {"reputation": 19, "user_id": 9872785, "user_type": "registered", "profile_image": "https://graph.facebook.com/10211681191841674/picture?type=large", "display_name": "Caleb Edwards", "link": "https://stackoverflow.com/users/9872785/caleb-edwards"}, "edited": false, "score": 0, "creation_date": 1527727319, "post_id": 50614510, "comment_id": 88240110, "body": "It\u2019s not deleting it. It\u2019s hiding the sheet! This way nobody notices anything different"}, {"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "reply_to_user": {"reputation": 19, "user_id": 9872785, "user_type": "registered", "profile_image": "https://graph.facebook.com/10211681191841674/picture?type=large", "display_name": "Caleb Edwards", "link": "https://stackoverflow.com/users/9872785/caleb-edwards"}, "edited": false, "score": 0, "creation_date": 1527728174, "post_id": 50614510, "comment_id": 88240328, "body": "Right click on any sheet and select \u201cunhide.\u201d If you don\u2019t like that part of the code delete both lines that see \u201cWS.Visible\u201d (one for true and one for false)"}, {"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1527780894, "post_id": 50614510, "comment_id": 88265891, "body": "You know, looking back, I cant figure out for the life of me why I did that in the first place. Maybe I was mistakenly thinking it had to be visible to be edited at the time?"}], "tags": [], "owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "is_accepted": false, "score": 0, "last_activity_date": 1527729071, "last_edit_date": 1527729071, "creation_date": 1527721891, "answer_id": 50614510, "question_id": 50613523, "link": "https://stackoverflow.com/questions/50613523/vba-adding-counter-for-tracking/50614510#50614510", "title": "VBA - Adding Counter For Tracking", "body": "<p>This will build a table for you on a hidden sheet showing all historical uses of the macro up to the <strong>n</strong>th time the macro was used along with a time stamp so you know <strong>when</strong> the macro was used. With this, you can use equations to extract exact data that you want as well. If you want a cell to show usage count, just to \"Countif(\"A:A\",\"*\")-1\u201d ... (minus 1 to ignore the header in A1) </p>\n\n<p>To Implement this macro:<br>\nCreate a new sheet titled \"MacroCount\"<br>\nSet A1 = \"Instance\"<br>\nSet B1 = \"Time Stamp\"  </p>\n\n<p>I would personally make this the last thing the macro does so it will only count the instance <em>once the macro completes all of its assigned duties.</em> </p>\n\n<p>Also, Remove the \"Sub MacroCount()\" &amp; \"End Sub\" from the below code. </p>\n\n<pre><code>Sub MacroCount()\n\nDim WS As Worksheet\nSet WS = ThisWorkbook.Sheets(\"MacroCount\")\n\nApplication.Screenupdating = False\nWS.Visible = True\nDim LRow As Long\nLRow = WS.Range(\"A\" &amp; Rows.Count).End(xlUp).Offset(1).Row\n\nWS.Range(\"A\" &amp; LRow).Value = LRow - 1\nWS.Range(\"B\" &amp; LRow).Value = Now()\nWS.Visible = False\nApplication.Screenupdating = True\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 19, "user_id": 9872785, "user_type": "registered", "profile_image": "https://graph.facebook.com/10211681191841674/picture?type=large", "display_name": "Caleb Edwards", "link": "https://stackoverflow.com/users/9872785/caleb-edwards"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1432, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1527777765, "creation_date": 1527715336, "question_id": 50613523, "link": "https://stackoverflow.com/questions/50613523/vba-adding-counter-for-tracking", "title": "VBA - Adding Counter For Tracking", "body": "<p>New to writing code in VBA, and I need to add in a way to count/track how often a macro is used.  I'm struggling to find any examples of a code that would perform this function.  Requesting any examples there might be for this.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 4245, "user_id": 8276474, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sm6MV.jpg?s=128&g=1", "display_name": "PGSystemTester", "link": "https://stackoverflow.com/users/8276474/pgsystemtester"}, "edited": false, "score": 0, "creation_date": 1527715101, "post_id": 50613446, "comment_id": 88236820, "body": "ISn&#39;t row 1 blank?"}, {"owner": {"reputation": 19, "user_id": 7926114, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa9b0f16394264dc875d5d79988d8689?s=128&d=identicon&r=PG&f=1", "display_name": "Goal7", "link": "https://stackoverflow.com/users/7926114/goal7"}, "reply_to_user": {"reputation": 4245, "user_id": 8276474, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sm6MV.jpg?s=128&g=1", "display_name": "PGSystemTester", "link": "https://stackoverflow.com/users/8276474/pgsystemtester"}, "edited": false, "score": 0, "creation_date": 1527715316, "post_id": 50613446, "comment_id": 88236896, "body": "Yes. my bad i meat for row 2. i will update it now"}, {"owner": {"reputation": 4245, "user_id": 8276474, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sm6MV.jpg?s=128&g=1", "display_name": "PGSystemTester", "link": "https://stackoverflow.com/users/8276474/pgsystemtester"}, "edited": false, "score": 0, "creation_date": 1527735160, "post_id": 50613446, "comment_id": 88241807, "body": "Your instructions seem off compared to the diagram. Row 2 makes sense. In row 4 you want to repeat AFTER column J or starting in Column J? Row 5 has no value in column I. Do you mean put the value of column H in Column I?"}, {"owner": {"reputation": 19, "user_id": 7926114, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa9b0f16394264dc875d5d79988d8689?s=128&d=identicon&r=PG&f=1", "display_name": "Goal7", "link": "https://stackoverflow.com/users/7926114/goal7"}, "reply_to_user": {"reputation": 4245, "user_id": 8276474, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sm6MV.jpg?s=128&g=1", "display_name": "PGSystemTester", "link": "https://stackoverflow.com/users/8276474/pgsystemtester"}, "edited": false, "score": 1, "creation_date": 1527771336, "post_id": 50613446, "comment_id": 88259608, "body": "@PGCodeRider for row 4, i want to repeat STARTING in column J. Yes for row 5, i mean to put the value of column H in column I. Thank you for all the help."}], "answers": [{"comments": [{"owner": {"reputation": 19, "user_id": 7926114, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa9b0f16394264dc875d5d79988d8689?s=128&d=identicon&r=PG&f=1", "display_name": "Goal7", "link": "https://stackoverflow.com/users/7926114/goal7"}, "edited": false, "score": 0, "creation_date": 1527716743, "post_id": 50613544, "comment_id": 88237412, "body": "i get an &quot;overflow&quot; error while trying to run the code"}, {"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1527718971, "post_id": 50613544, "comment_id": 88238065, "body": "Try changing all instances of \u201cInteger\u201d to \u201cLong\u201d although with a row count of 3000 integer SHOULD do just fine."}, {"owner": {"reputation": 19, "user_id": 7926114, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa9b0f16394264dc875d5d79988d8689?s=128&d=identicon&r=PG&f=1", "display_name": "Goal7", "link": "https://stackoverflow.com/users/7926114/goal7"}, "edited": false, "score": 0, "creation_date": 1527723588, "post_id": 50613544, "comment_id": 88239247, "body": "i already tried changing the instances. &quot;answer&quot; is where the issue is."}, {"owner": {"reputation": 4245, "user_id": 8276474, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sm6MV.jpg?s=128&g=1", "display_name": "PGSystemTester", "link": "https://stackoverflow.com/users/8276474/pgsystemtester"}, "reply_to_user": {"reputation": 19, "user_id": 7926114, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa9b0f16394264dc875d5d79988d8689?s=128&d=identicon&r=PG&f=1", "display_name": "Goal7", "link": "https://stackoverflow.com/users/7926114/goal7"}, "edited": false, "score": 0, "creation_date": 1527735524, "post_id": 50613544, "comment_id": 88241897, "body": "@Goal7 I think this latest version should do the trick. Please accept the answer if it works for you. Thanks."}, {"owner": {"reputation": 19, "user_id": 7926114, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa9b0f16394264dc875d5d79988d8689?s=128&d=identicon&r=PG&f=1", "display_name": "Goal7", "link": "https://stackoverflow.com/users/7926114/goal7"}, "edited": false, "score": 0, "creation_date": 1527771704, "post_id": 50613544, "comment_id": 88259851, "body": "@PGCodeRider the code works great but i have a question. if i have an odd number like 1470 in column H and the value in column I is 300, the code will put 300 at the end of the string 5 times summing it to 1500. Is there anyway to modify the code to limit it to 1470?"}, {"owner": {"reputation": 4245, "user_id": 8276474, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sm6MV.jpg?s=128&g=1", "display_name": "PGSystemTester", "link": "https://stackoverflow.com/users/8276474/pgsystemtester"}, "reply_to_user": {"reputation": 19, "user_id": 7926114, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa9b0f16394264dc875d5d79988d8689?s=128&d=identicon&r=PG&f=1", "display_name": "Goal7", "link": "https://stackoverflow.com/users/7926114/goal7"}, "edited": false, "score": 0, "creation_date": 1527777077, "post_id": 50613544, "comment_id": 88263454, "body": "@goal7 probably but you gotta at least mark my answer as useful. This wasn&#39;t part of your question and this is what&#39;s known as stringing people along with more requirements after they&#39;ve already answered the question you supplied. I&#39;ll knock it out later when I&#39;m at the airport bar, but explain exactly what you want in your question. Like 300, 300, 270 or something?"}, {"owner": {"reputation": 19, "user_id": 7926114, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa9b0f16394264dc875d5d79988d8689?s=128&d=identicon&r=PG&f=1", "display_name": "Goal7", "link": "https://stackoverflow.com/users/7926114/goal7"}, "edited": false, "score": 1, "creation_date": 1527778494, "post_id": 50613544, "comment_id": 88264412, "body": "@PGCodeRider thank you again for your help. I just want to make sure the total amount in column H is equal to the no. of times the data repeats * the value in column I. currently this is what happens  1470(Column H)/300(column I) = ~5 time to repeat 300 starting column J.  This results in total of 1500 instead of 1470 that was in column H.  is there some how we can keep it to 1470 which would mean the data gets repeated 300,300, 300, 300, 270. Does this make sense?"}, {"owner": {"reputation": 4245, "user_id": 8276474, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sm6MV.jpg?s=128&g=1", "display_name": "PGSystemTester", "link": "https://stackoverflow.com/users/8276474/pgsystemtester"}, "reply_to_user": {"reputation": 19, "user_id": 7926114, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa9b0f16394264dc875d5d79988d8689?s=128&d=identicon&r=PG&f=1", "display_name": "Goal7", "link": "https://stackoverflow.com/users/7926114/goal7"}, "edited": false, "score": 0, "creation_date": 1527779714, "post_id": 50613544, "comment_id": 88265146, "body": "@goal7 thanks for accepting the answer. It&#39;d be easier to split evenly with 294. That work?"}, {"owner": {"reputation": 19, "user_id": 7926114, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa9b0f16394264dc875d5d79988d8689?s=128&d=identicon&r=PG&f=1", "display_name": "Goal7", "link": "https://stackoverflow.com/users/7926114/goal7"}, "edited": false, "score": 0, "creation_date": 1527780182, "post_id": 50613544, "comment_id": 88265436, "body": "@PGCodeRider yes that works too as long as the sum remains the same as column H. Thank you again"}, {"owner": {"reputation": 4245, "user_id": 8276474, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sm6MV.jpg?s=128&g=1", "display_name": "PGSystemTester", "link": "https://stackoverflow.com/users/8276474/pgsystemtester"}, "reply_to_user": {"reputation": 19, "user_id": 7926114, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa9b0f16394264dc875d5d79988d8689?s=128&d=identicon&r=PG&f=1", "display_name": "Goal7", "link": "https://stackoverflow.com/users/7926114/goal7"}, "edited": false, "score": 0, "creation_date": 1527783532, "post_id": 50613544, "comment_id": 88267366, "body": "@goal7 all good! So far nobody at the airport bar is remotely impressed by this code, but hopefully you drop me a <code>useful</code> tick! You have yourself a good afternoon!!"}], "tags": [], "owner": {"reputation": 4245, "user_id": 8276474, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sm6MV.jpg?s=128&g=1", "display_name": "PGSystemTester", "link": "https://stackoverflow.com/users/8276474/pgsystemtester"}, "is_accepted": true, "score": 0, "last_activity_date": 1527783416, "last_edit_date": 1527783416, "creation_date": 1527715440, "answer_id": 50613544, "question_id": 50613446, "link": "https://stackoverflow.com/questions/50613446/inserting-calculated-values-at-the-end-of-row-with-values/50613544#50613544", "title": "inserting calculated values at the end of row with values", "body": "<p>This should meet your requirements:</p>\n\n<pre><code>Sub DoThisThing()\nDim rCell As Range, OrCell As Range, startCol As Integer, dividingIntger As Integer, _\nanswer As Double, searchRng As Range, WS As Worksheet\n\nSet WS = Sheets(ActiveSheet.Name) 'Or use actual sheet name i.e. Set WS = Sheets(\"Sheet1\")\nSet searchRng = WS.Range(\"H1:H3000\") 'sets the range to search through.\n\nFor Each rCell In searchRng.Cells\n\n    'If Column H is a numeric value, but not empty\n    If IsNumeric(rCell) And Not IsEmpty(rCell) Then\n\n        'Establishes offset cell being used\n        Set OrCell = rCell.Offset(0, 1)\n\n        'If column I has a numeric value that's not zero or blank\n        If IsNumeric(OrCell) And OrCell.Value2 &lt;&gt; 0 Then\n\n            'Number of columns to offset (rounded up)\n            dividingIntger = Application.WorksheetFunction.RoundUp(rCell.Value2 / OrCell.Value2, 0)\n\n            'Exact answer (decimals okay)\n            answer = rCell.Value2 / dividingIntger\n\n            'Finds which column to start entering values\n            startCol = WS.Cells(rCell.Row, Columns.Count).End(xlToLeft).Column + 1\n\n            'sets answer value into the starting column and over (less 1)\n            Range(WS.Cells(rCell.Row, startCol), WS.Cells(rCell.Row, startCol).Offset(0, dividingIntger - 1)).Value2 = answer\n\n        'If column I is zero or blank\n        ElseIf IsNumeric(OrCell) Then\n\n            'Sets Column I = to Column H\n            OrCell.Value2 = rCell.Value2\n\n        End If\n\n    End If\n\nNext rCell\n\nEnd Sub\n '\u2620\u2620\u2620\u2620system tested!\ud83d\udc4d\ud83d\udc4d\u2604\u26a1\u2728\ud83d\udca5\n</code></pre>\n"}], "owner": {"reputation": 19, "user_id": 7926114, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa9b0f16394264dc875d5d79988d8689?s=128&d=identicon&r=PG&f=1", "display_name": "Goal7", "link": "https://stackoverflow.com/users/7926114/goal7"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 42, "favorite_count": 0, "accepted_answer_id": 50613544, "answer_count": 1, "score": 1, "last_activity_date": 1527783416, "creation_date": 1527714957, "last_edit_date": 1527781514, "question_id": 50613446, "link": "https://stackoverflow.com/questions/50613446/inserting-calculated-values-at-the-end-of-row-with-values", "title": "inserting calculated values at the end of row with values", "body": "<p>My data set column is H through BQ with 3000 rows.\nI have column H with values in some rows and no value in others. First,  I am trying to find the row with value. Once I do that I want to  divide that value by the corresponding value in column I to get the answer X. Finally, I then want to repeat the value in column I \u2013 X times at the end of that row which has any value</p>\n\n<p>For example: </p>\n\n<pre><code>Row Number  Column H    Column I    Column J    Column K    Column L    \n   1                                    \n   2          1400        200        300            200        200              \n   3                                    \n   4          2000        1000                          \n   5           400  \n</code></pre>\n\n<p>Expected results:</p>\n\n<p><strong>Row 2:</strong> \n1400/200 = 7. I want to repeat the value in <code>Column I</code>(200) 7 times after <code>Column L</code></p>\n\n<p><strong>Row 4:</strong>,\n2000/1000 = 2. I want to repeat the value in <code>Column I</code> (1000) 2 times starting in <code>Column J</code></p>\n\n<p><strong>Row 5:</strong> 400/0 = <em>Error</em>. In this case repeat the value in <code>Column H</code> (400) once in <code>Column I</code>.</p>\n"}, {"tags": ["excel", "ms-access", "vba", "office365"], "answers": [{"tags": [], "owner": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "is_accepted": false, "score": 1, "last_activity_date": 1527718157, "creation_date": 1527718157, "answer_id": 50614005, "question_id": 50613341, "link": "https://stackoverflow.com/questions/50613341/running-excel-range-find-method-from-access-vba-module-fails-error/50614005#50614005", "title": "Running Excel range.find method from Access vba module fails/error", "body": "<p>I think the order of your parameters is wrong - this only matters when you're not using named parameters (as in your example).  I assume that's because you don't have a reference to Excel? </p>\n\n<p>In any case have you checked the implicit order of the parameters to make sure you have them in the right order? </p>\n\n<p>By default the order is defined as:</p>\n\n<p><code>expression.Find( What , After , LookIn , LookAt , SearchOrder , SearchDirection , MatchCase , MatchByte , SearchFormat )</code></p>\n\n<p>It looks like you have <code>LookIn</code> coming after <code>LookAt</code></p>\n\n<p><strong>Try changing it to:</strong> </p>\n\n<pre><code>Set rFound = ws.Cells.Find(\"*\", ws.Cells(1, 1), _                        \n                    xlFormulas, xlPart, _\n                    xlByRows, xlNext, False)\n</code></pre>\n\n<p><a href=\"https://msdn.microsoft.com/en-us/vba/excel-vba/articles/range-find-method-excel\" rel=\"nofollow noreferrer\">For reference</a></p>\n"}], "owner": {"reputation": 425, "user_id": 1231560, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/bce919d33987a5e15f41ce6f325ecc13?s=128&d=identicon&r=PG", "display_name": "Jose R", "link": "https://stackoverflow.com/users/1231560/jose-r"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 532, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1527718157, "creation_date": 1527714296, "question_id": 50613341, "link": "https://stackoverflow.com/questions/50613341/running-excel-range-find-method-from-access-vba-module-fails-error", "title": "Running Excel range.find method from Access vba module fails/error", "body": "<p>Win10x64, office 365 x64\nI am running an Access macro.\nI'm opening an excel workbook, and then finding the last non-blank cell, or the first non-blank cell.\nAll constants are defined like this</p>\n\n<pre><code>xlPart = 2\nxlFormulas = -4123\nxlByRows = 1\nxlNext = 1\n</code></pre>\n\n<p><code>ws</code> is a Worksheet object.  I can select and activate the worksheet and a range without error e.g. these lines run fine</p>\n\n<pre><code>ws.Activate\nws.select\nws.Cells(1, 1).select\nws.Cells(1, 1).Activate\n</code></pre>\n\n<p>When I run this code I get a <code>Run-time error '9': Subscript out of range.</code> error</p>\n\n<pre><code>Set rFound = ws.Cells.Find(\"*\", ws.Cells(1, 1), _\n                    xlPart, _\n                    xlFormulas, _\n                    xlByRows, _\n                    xlNext, _\n                    False)\n</code></pre>\n\n<p>But if i run this code, it works fine:</p>\n\n<pre><code>Set rFound = ws.Cells.Find(\"*\", ws.Cells(1, 1))\n</code></pre>\n\n<p>How can i pass the parameters from Access VBA to Excel Range.Find method.\n<strong>Please don't suggest other methods for finding non-blank cells</strong>, I am doing that to complete this DB, but please try to answer the question on how making this particular method work from Access.</p>\n\n<p>Thanks,</p>\n"}, {"tags": ["excel", "loops", "hyperlink", "excel-formula", "vba"], "comments": [{"owner": {"reputation": 11192, "user_id": 5514747, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/db1a440aac7d279213c66bcdb1c1984a?s=128&d=identicon&r=PG", "display_name": "Harun24HR", "link": "https://stackoverflow.com/users/5514747/harun24hr"}, "edited": false, "score": 1, "creation_date": 1527716232, "post_id": 50613239, "comment_id": 88237233, "body": "How we will know, why it saying so? Seeing your code may give us a view of error to help you."}, {"owner": {"reputation": 1026, "user_id": 8788388, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-j4tnBdMaXfk/AAAAAAAAAAI/AAAAAAACwcU/Jg67BYcCeW0/photo.jpg?sz=128", "display_name": "Hakan ERDOGAN", "link": "https://stackoverflow.com/users/8788388/hakan-erdogan"}, "edited": false, "score": 0, "creation_date": 1527750143, "post_id": 50613239, "comment_id": 88246651, "body": "Normally <code>HYPERLINK</code> formula would work for this. Could you share a screenshot of your workbook, your <code>HYPERLINK</code> formula and also one of the formula Excel copy-created by dragging?"}, {"owner": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "edited": false, "score": 0, "creation_date": 1527770471, "post_id": 50613239, "comment_id": 88258956, "body": "If you go &quot;Formulas&quot; &gt; &quot;Evaluate Formula&quot;, you can check what the output hyperlink path is (of course, if you have not specified a <code>[friendly_name]</code> then you can just read it out of the cell value) - is this a valid path to your file?"}, {"owner": {"reputation": 313, "user_id": 9711276, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lHtza.png?s=128&g=1", "display_name": "Kenny", "link": "https://stackoverflow.com/users/9711276/kenny"}, "reply_to_user": {"reputation": 11192, "user_id": 5514747, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/db1a440aac7d279213c66bcdb1c1984a?s=128&d=identicon&r=PG", "display_name": "Harun24HR", "link": "https://stackoverflow.com/users/5514747/harun24hr"}, "edited": false, "score": 0, "creation_date": 1527775215, "post_id": 50613239, "comment_id": 88262253, "body": "@Harun24HR i edited my question with some code and a formula"}, {"owner": {"reputation": 313, "user_id": 9711276, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lHtza.png?s=128&g=1", "display_name": "Kenny", "link": "https://stackoverflow.com/users/9711276/kenny"}, "reply_to_user": {"reputation": 1026, "user_id": 8788388, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-j4tnBdMaXfk/AAAAAAAAAAI/AAAAAAACwcU/Jg67BYcCeW0/photo.jpg?sz=128", "display_name": "Hakan ERDOGAN", "link": "https://stackoverflow.com/users/8788388/hakan-erdogan"}, "edited": false, "score": 0, "creation_date": 1527775765, "post_id": 50613239, "comment_id": 88262621, "body": "@HakanERDOGAN unfortunately i cannot screenshot, but i&#39;m referencing a column in a table one called SITE and the other called FULLNAME and referencing a path spelled out in B2. I need column B Filled starting at the first row of the table (B5)."}, {"owner": {"reputation": 313, "user_id": 9711276, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lHtza.png?s=128&g=1", "display_name": "Kenny", "link": "https://stackoverflow.com/users/9711276/kenny"}, "reply_to_user": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "edited": false, "score": 0, "creation_date": 1527795683, "post_id": 50613239, "comment_id": 88273275, "body": "@Chronocidal After looking at this again with a night&#39;s rest, It appears that the path reference changes(moves down a row) for every cell auto populated. How do I ensure the formula stays on B2 for the Formula but still have Excel auto poplulate?"}, {"owner": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "edited": false, "score": 1, "creation_date": 1527802792, "post_id": 50613239, "comment_id": 88276586, "body": "Use <code>B$2</code> if you want it to stay on row 2, <code>$B2</code> if you want it to stay in column B, or <code>$B$2</code> if you want it to stay in column B, row 2.  The <code>$</code> &#39;locks&#39; the reference so that it doesn&#39;t move when the formula does"}], "owner": {"reputation": 313, "user_id": 9711276, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lHtza.png?s=128&g=1", "display_name": "Kenny", "link": "https://stackoverflow.com/users/9711276/kenny"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 553, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1527775145, "creation_date": 1527713792, "last_edit_date": 1531161705, "question_id": 50613239, "link": "https://stackoverflow.com/questions/50613239/how-to-create-hyperlinks-using-path-and-cell-value-with-vba-loop", "title": "How to Create Hyperlinks using path and cell value with VBA loop", "body": "<p>I am having problems creating a loop to create the hyperlinks to open a folder.\nThe Folder Name I'm trying to open is in column A, starting on row 5. </p>\n\n<p>The path is to a folder on the Desktop</p>\n\n<p>I need the loop to correctly create hyperlinks to each folder corresponding to the Value in column A</p>\n\n<p>I originally created a Hyperlink formula and excel auto completed the column but for some reason only the first hyperlink works while the others all say \"can not open specified file\".</p>\n\n<p>here's the code i entered into the end of a marcro...</p>\n\n<pre><code>''CREATE HYPERLINKS\nRange(\"B2\").Select\nActiveCell.FormulaR1C1 = \"C:\\Users\\tfd\\Desktop\\The FILES\\theFILES\"\nSelection.Font.Bold = False\nRange(\"B5\").Select\nActiveCell.FormulaR1C1 = \"=HYPERLINK(R[-3]C&amp;\"\"\\\"\"&amp;[@SITE],[@FULLNAME])\"\nRange(\"A1\").Select\n\nEnd Sub\n</code></pre>\n\n<p>and the hyperlink I manually entered into cell B5 was...</p>\n\n<pre><code>=HYPERLINK(B2&amp;\"\\\"&amp;[@SITE],[@FULLNAME]) \n</code></pre>\n\n<p>Any and All help would be greatly appreciated.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1527713334, "post_id": 50613042, "comment_id": 88236154, "body": "Will the searched column names appear only once per worksheet?"}], "answers": [{"tags": [], "owner": {"reputation": 1444, "user_id": 9122140, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6207fe125b0cbaefce70e98e5ce2c6f?s=128&d=identicon&r=PG&f=1", "display_name": "AcsErno", "link": "https://stackoverflow.com/users/9122140/acserno"}, "is_accepted": false, "score": 0, "last_activity_date": 1527852524, "creation_date": 1527852524, "answer_id": 50642428, "question_id": 50613042, "link": "https://stackoverflow.com/questions/50613042/how-do-i-create-a-vba-module-that-will-highlight-two-columns-that-are-not-next-t/50642428#50642428", "title": "How do I create a vba module that will highlight two columns that are not next to one another based on the header name", "body": "<p>Wrong order of commands. You overwrite xRg  with <code>.FindNext</code> before unioning. Try this way: </p>\n\n<pre><code> If Not xRg Is Nothing Then\n    xFirstAddress = xRg.Address\n    Do\n        ' Set xRg = Range(\"A1:P1\").FindNext(xRg)   --- moved below\n        If xRgUni Is Nothing Then\n            Set xRgUni = xRg\n        Else\n            Set xRgUni = Application.Union(xRgUni, xRg)\n        End If\n        Set xRg = Range(\"A1:P1\").FindNext(xRg)   ' --- moved here\n    Loop While (Not xRg Is Nothing) And (xRg.Address &lt;&gt; xFirstAddress)\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 9872610, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Dametre Thunberg", "link": "https://stackoverflow.com/users/9872610/dametre-thunberg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 83, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1527852524, "creation_date": 1527712856, "last_edit_date": 1531164843, "question_id": 50613042, "link": "https://stackoverflow.com/questions/50613042/how-do-i-create-a-vba-module-that-will-highlight-two-columns-that-are-not-next-t", "title": "How do I create a vba module that will highlight two columns that are not next to one another based on the header name", "body": "<p>New to this, but right now I need to sort lots of pages of data, I would love to be able to highlight two specific columns based on the header name. Right now I have this which I found online, which is fine, aside from the fact that I have to search for two different columns. any help would be appreciated</p>\n\n<pre><code>Sub FindAddressColumn()\n\n   'Updateby Extendoffcie\n\n    Dim xRg As Range\n    Dim xRgUni As Range\n    Dim xFirstAddress As String\n    Dim xStr As String\n    On Error Resume Next\n    xStr = \"Name\"\n    Set xRg = Range(\"A1:P1\").Find(xStr, , xlValues, xlWhole, , , True)\n    If Not xRg Is Nothing Then\n        xFirstAddress = xRg.Address\n        Do\n            Set xRg = Range(\"A1:P1\").FindNext(xRg)\n            If xRgUni Is Nothing Then\n                Set xRgUni = xRg\n            Else\n                Set xRgUni = Application.Union(xRgUni, xRg)\n            End If\n        Loop While (Not xRg Is Nothing) And (xRg.Address &lt;&gt; xFirstAddress)\n    End If\n    xRgUni.EntireColumn.Select\nEnd Sub\n</code></pre>\n"}, {"tags": ["html", "vba", "web-scraping"], "answers": [{"comments": [{"owner": {"reputation": 325, "user_id": 9640782, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/777f5981ccbedfef10d48ccdebc34735?s=128&d=identicon&r=PG&f=1", "display_name": "Arkadiusz", "link": "https://stackoverflow.com/users/9640782/arkadiusz"}, "edited": false, "score": 0, "creation_date": 1527714644, "post_id": 50613063, "comment_id": 88236647, "body": "This line : .querySelector(&quot;button span&quot;).innerText = &quot;polskiego&quot; works but I want to choose language from and to so when I use these: .querySelectorAll(&quot;button span&quot;)(0).innerText = &quot;polskiego&quot; .querySelectorAll(&quot;button span&quot;)(1).innerText = &quot;angielskiego&quot; I received an error &quot;Automation error&quot;"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 325, "user_id": 9640782, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/777f5981ccbedfef10d48ccdebc34735?s=128&d=identicon&r=PG&f=1", "display_name": "Arkadiusz", "link": "https://stackoverflow.com/users/9640782/arkadiusz"}, "edited": false, "score": 0, "creation_date": 1527714994, "post_id": 50613063, "comment_id": 88236786, "body": "It works fine my end.  Can you tell me a bit more about the error?"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 325, "user_id": 9640782, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/777f5981ccbedfef10d48ccdebc34735?s=128&d=identicon&r=PG&f=1", "display_name": "Arkadiusz", "link": "https://stackoverflow.com/users/9640782/arkadiusz"}, "edited": false, "score": 0, "creation_date": 1527715041, "post_id": 50613063, "comment_id": 88236806, "body": "That&#39;s ok. We are here to help. Please feel free to ask questions. QuerySelector is for IE9+ I think."}, {"owner": {"reputation": 325, "user_id": 9640782, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/777f5981ccbedfef10d48ccdebc34735?s=128&d=identicon&r=PG&f=1", "display_name": "Arkadiusz", "link": "https://stackoverflow.com/users/9640782/arkadiusz"}, "edited": false, "score": 0, "creation_date": 1527715462, "post_id": 50613063, "comment_id": 88236954, "body": "Well, I don&#39;t understand this syntax. I&#39;ve been studying VBA for a couple of months but I don&#39;t know HTML at all. Now I get an error: &quot;Object doesn&#39;t support this property or method&quot;"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 325, "user_id": 9640782, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/777f5981ccbedfef10d48ccdebc34735?s=128&d=identicon&r=PG&f=1", "display_name": "Arkadiusz", "link": "https://stackoverflow.com/users/9640782/arkadiusz"}, "edited": false, "score": 0, "creation_date": 1527715557, "post_id": 50613063, "comment_id": 88236985, "body": "What version of IE are you running?"}, {"owner": {"reputation": 325, "user_id": 9640782, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/777f5981ccbedfef10d48ccdebc34735?s=128&d=identicon&r=PG&f=1", "display_name": "Arkadiusz", "link": "https://stackoverflow.com/users/9640782/arkadiusz"}, "edited": false, "score": 0, "creation_date": 1527716831, "post_id": 50613063, "comment_id": 88237439, "body": "I think that the problem is that I use late binding. So I wrote:  Set IE = CreateObject(&quot;InternetExplorer.Application&quot;) and it&#39;s OK but I don&#39;t know how to create HTML object. I wrote:  Set html = CreateObject(&quot;HTMLDocument&quot;) but I got an error: ActiveX component can&#39;t create object."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 325, "user_id": 9640782, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/777f5981ccbedfef10d48ccdebc34735?s=128&d=identicon&r=PG&f=1", "display_name": "Arkadiusz", "link": "https://stackoverflow.com/users/9640782/arkadiusz"}, "edited": false, "score": 0, "creation_date": 1527717112, "post_id": 50613063, "comment_id": 88237544, "body": "Are you allowed to add the reference to HTML Object library?"}, {"owner": {"reputation": 325, "user_id": 9640782, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/777f5981ccbedfef10d48ccdebc34735?s=128&d=identicon&r=PG&f=1", "display_name": "Arkadiusz", "link": "https://stackoverflow.com/users/9640782/arkadiusz"}, "edited": false, "score": 0, "creation_date": 1527717178, "post_id": 50613063, "comment_id": 88237566, "body": "Well, I have to use late binding because I don&#39;t know the version of Excel on computer on which my application will be used. How can I chage that?"}, {"owner": {"reputation": 325, "user_id": 9640782, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/777f5981ccbedfef10d48ccdebc34735?s=128&d=identicon&r=PG&f=1", "display_name": "Arkadiusz", "link": "https://stackoverflow.com/users/9640782/arkadiusz"}, "edited": false, "score": 0, "creation_date": 1527717779, "post_id": 50613063, "comment_id": 88237739, "body": "No, I&#39;m not allowed."}, {"owner": {"reputation": 325, "user_id": 9640782, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/777f5981ccbedfef10d48ccdebc34735?s=128&d=identicon&r=PG&f=1", "display_name": "Arkadiusz", "link": "https://stackoverflow.com/users/9640782/arkadiusz"}, "edited": false, "score": 0, "creation_date": 1527718737, "post_id": 50613063, "comment_id": 88238017, "body": "You are amazing! It works! I don&#39;t know this site very well but I&#39;d like to thank You as much as I can."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 325, "user_id": 9640782, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/777f5981ccbedfef10d48ccdebc34735?s=128&d=identicon&r=PG&f=1", "display_name": "Arkadiusz", "link": "https://stackoverflow.com/users/9640782/arkadiusz"}, "edited": false, "score": 0, "creation_date": 1527719321, "post_id": 50613063, "comment_id": 88238166, "body": "I have updated your other question with a late bound as well."}, {"owner": {"reputation": 325, "user_id": 9640782, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/777f5981ccbedfef10d48ccdebc34735?s=128&d=identicon&r=PG&f=1", "display_name": "Arkadiusz", "link": "https://stackoverflow.com/users/9640782/arkadiusz"}, "edited": false, "score": 0, "creation_date": 1527723775, "post_id": 50613063, "comment_id": 88239295, "body": "It&#39;s strange, I use your code (late binding) and I want to translate sth from Polish to English but it seems to me that &quot;Przet\u0142umacz&quot; (translate) button doesn&#39;t work. Instead website is refreshed and languages from and to are changed for Arabic and German."}, {"owner": {"reputation": 325, "user_id": 9640782, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/777f5981ccbedfef10d48ccdebc34735?s=128&d=identicon&r=PG&f=1", "display_name": "Arkadiusz", "link": "https://stackoverflow.com/users/9640782/arkadiusz"}, "edited": false, "score": 0, "creation_date": 1527725816, "post_id": 50613063, "comment_id": 88239791, "body": "Well, I had to change website for <a href=\"https://pl.pons.com/t%C5%82umaczenie\" rel=\"nofollow noreferrer\">pl.pons.com/t%C5%82umaczenie</a>, I changed my code but I need to refer to the first field of translated word."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 325, "user_id": 9640782, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/777f5981ccbedfef10d48ccdebc34735?s=128&d=identicon&r=PG&f=1", "display_name": "Arkadiusz", "link": "https://stackoverflow.com/users/9640782/arkadiusz"}, "edited": false, "score": 0, "creation_date": 1527748875, "post_id": 50613063, "comment_id": 88245983, "body": "@Arkadiusz Can you do a <a href=\"https://pastebin.com/\" rel=\"nofollow noreferrer\">pastebin.com</a> of your code so I can run it. And can you include in the pastebin the expected output."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 325, "user_id": 9640782, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/777f5981ccbedfef10d48ccdebc34735?s=128&d=identicon&r=PG&f=1", "display_name": "Arkadiusz", "link": "https://stackoverflow.com/users/9640782/arkadiusz"}, "edited": false, "score": 0, "creation_date": 1527754538, "post_id": 50613063, "comment_id": 88249043, "body": "I have done a new edit at the bottom of the question for you to try."}, {"owner": {"reputation": 2031, "user_id": 6097926, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/187bc2674bbdf7651e7137e1427b9bd6?s=128&d=identicon&r=PG&f=1", "display_name": "Ryszard J\u0119draszyk", "link": "https://stackoverflow.com/users/6097926/ryszard-j%c4%99draszyk"}, "edited": false, "score": 0, "creation_date": 1527756399, "post_id": 50613063, "comment_id": 88250090, "body": "I have updated my answer here: <a href=\"https://stackoverflow.com/questions/50598496/searching-websites-using-vba/50599043#50599043\" title=\"searching websites using vba\">stackoverflow.com/questions/50598496/&hellip;</a> It now also contains processing of JSON response on this particular website."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 2031, "user_id": 6097926, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/187bc2674bbdf7651e7137e1427b9bd6?s=128&d=identicon&r=PG&f=1", "display_name": "Ryszard J\u0119draszyk", "link": "https://stackoverflow.com/users/6097926/ryszard-j%c4%99draszyk"}, "edited": false, "score": 0, "creation_date": 1527756437, "post_id": 50613063, "comment_id": 88250108, "body": "hello @RyszardJ\u0119draszyk ! :-)"}, {"owner": {"reputation": 325, "user_id": 9640782, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/777f5981ccbedfef10d48ccdebc34735?s=128&d=identicon&r=PG&f=1", "display_name": "Arkadiusz", "link": "https://stackoverflow.com/users/9640782/arkadiusz"}, "edited": false, "score": 0, "creation_date": 1527767922, "post_id": 50613063, "comment_id": 88257332, "body": "@QHarr I have just pasted my code on pastebin.com, my login: ArkadiuszWarsaw"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1527768140, "post_id": 50613063, "comment_id": 88257488, "body": "Cool. Please also try the latest edit. You also need to share the link that is generated from pastebin.com"}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": true, "score": 2, "last_activity_date": 1527754414, "last_edit_date": 1527754414, "creation_date": 1527712957, "answer_id": 50613063, "question_id": 50612961, "link": "https://stackoverflow.com/questions/50612961/changing-span-element-on-the-website-vba/50613063#50613063", "title": "Changing span element on the website - VBA", "body": "<p>In line with my earlier <a href=\"https://stackoverflow.com/a/50599203/6241235\">answer</a> to this here is how you change the languages.</p>\n\n<p><strong>Note:</strong></p>\n\n<p>Late binding won't offer you the interface for <code>.querySelector</code>. It has to be with early binding i.e. reference added for <code>HTML Object Library</code>. </p>\n\n<p>Additional reference is <code>Microsoft Internet Controls</code> though this doesn't affect <code>.querySelector</code>.</p>\n\n<hr>\n\n<p>To do from and to languages use:</p>\n\n<pre><code>.querySelectorAll(\"button span\")(0).innerText = \"bulgarski\" '&lt;== To\n.querySelectorAll(\"button span\")(1).innerText = \"arabskiego\" '&lt;== From\n</code></pre>\n\n<p>Or more targeted:</p>\n\n<pre><code>.querySelectorAll(\"button[class = \"\"btn dropdown-toggle\"\"]\")(0).innerText = \"chinskiego\"\n.querySelectorAll(\"button[class = \"\"btn dropdown-toggle\"\"]\")(1).innerText = \"bulgarski\"\n</code></pre>\n\n<p>Or even:</p>\n\n<pre><code>.querySelectorAll(\"button.btn.dropdown-toggle span\")(0).innerText = \"chinskiego\"\n.querySelectorAll(\"button.btn.dropdown-toggle span\")(1).innerText = \"arabskiego\"\n</code></pre>\n\n<hr>\n\n<p>The methods above use CSS selectors i.e. that make use of the page styling to select the items of interest.</p>\n\n<p><code>querySelectorAll</code> returns a <code>NodeList</code> of all nodes matching the specified CSS selector. The <code>NodeList</code> items are then accessed by index e.g. 0, 1.</p>\n\n<hr>\n\n<p>CSS Selectors:</p>\n\n<ol>\n<li><a href=\"https://developer.mozilla.org/en-US/docs/Web/CSS/CSS_Selectors\" rel=\"nofollow noreferrer\">CSS selectors</a></li>\n<li><a href=\"https://www.w3schools.com/cssref/css_selectors.asp\" rel=\"nofollow noreferrer\">CSS Selector Reference</a></li>\n</ol>\n\n<hr>\n\n<p><strong>Code:</strong></p>\n\n<pre><code>Option Explicit\n\nPublic Sub GetInfo()\n    Dim IE As New InternetExplorer, html As HTMLDocument, translation As String\n    Const TRANSLATION_STRING As String = \"Hello\"\n\n    With IE\n        .Visible = True\n        .navigate \"https://pl.pons.com/t%C5%82umaczenie-tekstu\"\n\n        While .Busy Or .readyState &lt; 4: DoEvents: Wend\n\n        Set html = .document\n\n        With html\n\n            .querySelectorAll(\"button span\")(0).innerText = \"polskiego\"\n            .querySelectorAll(\"button span\")(1).innerText = \"angielskiego\"\n\n'            .querySelectorAll(\"button[class = \"\"btn dropdown-toggle\"\"]\")(0).innerText = \"chinskiego\"\n'            .querySelectorAll(\"button[class = \"\"btn dropdown-toggle\"\"]\")(1).innerText = \"bulgarski\"\n'\n'            .querySelectorAll(\"button span\")(0).innerText = \"chinskiego\"\n'            .querySelectorAll(\"button span\")(1).innerText = \"chinskiego\"\n''\n'            .querySelectorAll(\"button.btn.dropdown-toggle span\")(0).innerText = \"chinskiego\"\n'            .querySelectorAll(\"button.btn.dropdown-toggle span\")(1).innerText = \"arabskiego\"\n\nStop\n\n            .querySelector(\"textarea.text-translation-source.source\").Value = TRANSLATION_STRING\n            .querySelector(\"button.btn.btn-primary.submit\").Click\n            Application.Wait Now + TimeSerial(0, 0, 3)\n            translation = .querySelector(\"div.translated_text\").innerText\n        End With\n\n        Debug.Print translation\n        'Quit '&lt;== Remember to quit application\n    End With\n\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p><strong>Example run:</strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/whz2u.gif\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/whz2u.gif\" alt=\"Test run\"></a></p>\n\n<hr>\n\n<p><strong>Edit:</strong></p>\n\n<p>This is not robust but you may be able to do, for late binding with HTML file</p>\n\n<pre><code>.getElementsByTagName(\"span\")(0).innerText = \"chinskiego\"  '&lt;== from\n.getElementsByTagName(\"span\")(26).innerText = \"bulgarski\" '&lt;== to\n</code></pre>\n\n<p><strong>Late bound:</strong></p>\n\n<pre><code>Option Explicit\nPublic Sub GetInfo()\n    Dim IE As Object, html As Object\n\n    With CreateObject(\"InternetExplorer.Application\")\n        .Visible = True\n        .navigate \"https://pl.pons.com/t%C5%82umaczenie-tekstu\"\n\n        While .Busy Or .readyState &lt; 4: DoEvents: Wend\n\n        Set html = CreateObject(\"htmlfile\")\n        Set html = .document\n\n        With html\n\n            .getElementsByTagName(\"span\")(0).innerText = \"chinskiego\"\n            .getElementsByTagName(\"span\")(26).innerText = \"bulgarski\"\n\n            Stop\n        End With\n        .Quit\n    End With\n\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p>Don't really want this answer to go on forever (so apologies for current length)... In response to OPs later question regarding sometimes values not held in late bound translation.</p>\n\n<p>Please see more <strong>fragile</strong> version. In the version below I have first looped all the span elements and found out which index relates to which language selection and in which box:</p>\n\n<p>Mini guide to spans:</p>\n\n<p><a href=\"https://i.stack.imgur.com/q9m7h.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/q9m7h.png\" alt=\"span elements with index\"></a></p>\n\n<p><strong>Code:</strong></p>\n\n<pre><code>Option Explicit\nPublic Sub GetInfo()\n    Dim IE As Object, html As Object, translation As String\n\n    With CreateObject(\"InternetExplorer.Application\")\n        .Visible = True\n        .navigate \"https://pl.pons.com/t%C5%82umaczenie-tekstu\"\n\n        While .Busy Or .readyState &lt; 4: DoEvents: Wend\n\n        Set html = CreateObject(\"htmlfile\")\n        Set html = .document\n\n        Dim i As Long\n        'Dim listOfSpanElements As Worksheet\n        'Set listOfSpanElements = Worksheets.Add\n\n'        With listOfSpanElements ''&lt;== This was used to ascertain position of all the span elements and hence which span to click on to select a language.\n'\n'            For i = 0 To html.getElementsByTagName(\"span\").Length - 1\n'                Cells(i + 1, 1) = html.getElementsByTagName(\"span\")(i).innerText\n'            Next i\n'\n'        End With\n\n\n        With html\n\n            .getElementsByTagName(\"button\")(1).Focus\n            .getElementsByTagName(\"button\")(1).Click\n            .getElementsByClassName(\"text-translation-source source\")(0).innerText = \"Sponsorowane\"\n            .getElementsByTagName(\"span\")(15).Click 'FROM polskiego\n            .getElementsByTagName(\"span\")(47).Click 'TO angielski\n            .getElementsByClassName(\"btn btn-primary submit\")(0).Click\n            Application.Wait Now + TimeSerial(0, 0, 4)\n           Stop\n\n            For i = 0 To .getElementsByClassName(\"text-translation-target target\").Length - 1\n               Debug.Print .getElementsByClassName(\"text-translation-target target\")(i).innerText '&lt;==later remove \"Trwa ladowanie...\"\n            Next i\n        End With\n        .Quit\n    End With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 325, "user_id": 9640782, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/777f5981ccbedfef10d48ccdebc34735?s=128&d=identicon&r=PG&f=1", "display_name": "Arkadiusz", "link": "https://stackoverflow.com/users/9640782/arkadiusz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1488, "favorite_count": 1, "accepted_answer_id": 50613063, "answer_count": 1, "score": 0, "last_activity_date": 1575367465, "creation_date": 1527712474, "last_edit_date": 1575367465, "question_id": 50612961, "link": "https://stackoverflow.com/questions/50612961/changing-span-element-on-the-website-vba", "title": "Changing span element on the website - VBA", "body": "<p>I need to change span element on the website, I mean I have to change a language on the pons website. Here's my code:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Sub www()\n\n    Set objIE = CreateObject(\"InternetExplorer.Application\")\n\n    objIE.Top = 0\n    objIE.Left = 0\n    objIE.Width = 800\n    objIE.Height = 600\n    objIE.AddressBar = 0\n    objIE.StatusBar = 0\n    objIE.Toolbar = 0\n    objIE.Visible = True\n    objIE.Navigate (\"https://pl.pons.com/t\u0142umaczenie-tekstu\")\n\n    Do\n    DoEvents\n    Loop Until objIE.ReadyState = 4\n    pagesource = objIE.Document.Body.Outerhtml\n    objIE.Document.GetElementsByTagName(\"TEXTAREA\")(0).Value = \"pi\u0142ka\"\n    objIE.Document.GetElementsByTagName(\"BUTTON\")(5).Click\n\n    Do\n    DoEvents\n    Loop Until objIE.ReadyState = 4\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2334, "user_id": 7948962, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b64557f8a617effccaf4426f16e9035?s=128&d=identicon&r=PG&f=1", "display_name": "Jacob H", "link": "https://stackoverflow.com/users/7948962/jacob-h"}, "edited": false, "score": 4, "creation_date": 1527711689, "post_id": 50612776, "comment_id": 88235519, "body": "<a href=\"https://stackoverflow.com/questions/588004/is-floating-point-math-broken\">Is floating point math broken?</a>"}, {"owner": {"reputation": 2334, "user_id": 7948962, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b64557f8a617effccaf4426f16e9035?s=128&d=identicon&r=PG&f=1", "display_name": "Jacob H", "link": "https://stackoverflow.com/users/7948962/jacob-h"}, "edited": false, "score": 1, "creation_date": 1527711893, "post_id": 50612776, "comment_id": 88235623, "body": "Your Diff also does not equal 0 here, floating point math issues aside."}, {"owner": {"reputation": 25, "user_id": 9232085, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e5fe118cc95e3ef6707db43fb773739?s=128&d=identicon&r=PG&f=1", "display_name": "J. Mill", "link": "https://stackoverflow.com/users/9232085/j-mill"}, "edited": false, "score": 0, "creation_date": 1527711932, "post_id": 50612776, "comment_id": 88235643, "body": "I tried rounding Diff   &#39;Round(43892.98-4117.34-256.64+0.000001,2)&#39; and still have the error (the extra 0.0000001 is to avoid Banker&#39;s rounding)."}, {"owner": {"reputation": 25, "user_id": 9232085, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e5fe118cc95e3ef6707db43fb773739?s=128&d=identicon&r=PG&f=1", "display_name": "J. Mill", "link": "https://stackoverflow.com/users/9232085/j-mill"}, "edited": false, "score": 0, "creation_date": 1527712044, "post_id": 50612776, "comment_id": 88235690, "body": "Should be 4382.98, not 43892.98."}, {"owner": {"reputation": 49589, "user_id": 109122, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/11646005668a23c7cb18912713b1235b?s=128&d=identicon&r=PG", "display_name": "RBarryYoung", "link": "https://stackoverflow.com/users/109122/rbarryyoung"}, "edited": false, "score": 0, "creation_date": 1527712896, "post_id": 50612776, "comment_id": 88236002, "body": "Yeah, that equals <code>8.99999999999943</code>.  Not zero."}, {"owner": {"reputation": 25, "user_id": 9232085, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e5fe118cc95e3ef6707db43fb773739?s=128&d=identicon&r=PG&f=1", "display_name": "J. Mill", "link": "https://stackoverflow.com/users/9232085/j-mill"}, "edited": false, "score": 0, "creation_date": 1527713011, "post_id": 50612776, "comment_id": 88236033, "body": "Wow, I&#39;m having issues typing. It should also be 265.64, not 256.64. I&#39;ve learned a valuable lesson in proofreading."}, {"owner": {"reputation": 49589, "user_id": 109122, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/11646005668a23c7cb18912713b1235b?s=128&d=identicon&r=PG", "display_name": "RBarryYoung", "link": "https://stackoverflow.com/users/109122/rbarryyoung"}, "edited": false, "score": 0, "creation_date": 1527713387, "post_id": 50612776, "comment_id": 88236172, "body": "And that also is not zero, it is <code>-5.6843418860808E-13</code>.  Try adding a <code>Debug.Print Diff</code> statement right before your IF statement."}, {"owner": {"reputation": 49589, "user_id": 109122, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/11646005668a23c7cb18912713b1235b?s=128&d=identicon&r=PG", "display_name": "RBarryYoung", "link": "https://stackoverflow.com/users/109122/rbarryyoung"}, "edited": false, "score": 0, "creation_date": 1527713506, "post_id": 50612776, "comment_id": 88236224, "body": "To make a very long story short, try following the link that Jacob H posted and reading that.  The bottom line is, unless you keep everything in integer values, <b><i>you should never test floating-point values for equality!</i></b>"}], "answers": [{"tags": [], "owner": {"reputation": 25, "user_id": 9232085, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e5fe118cc95e3ef6707db43fb773739?s=128&d=identicon&r=PG&f=1", "display_name": "J. Mill", "link": "https://stackoverflow.com/users/9232085/j-mill"}, "is_accepted": false, "score": 0, "last_activity_date": 1527713307, "creation_date": 1527713307, "answer_id": 50613144, "question_id": 50612776, "link": "https://stackoverflow.com/questions/50612776/if-statement-returning-not-equal-to-0-when-value-equals-0/50613144#50613144", "title": "If statement returning not equal to 0 when value equals 0", "body": "<p>I stored Diff As Currency instead of Double and the issue cleared up.</p>\n"}, {"tags": [], "owner": {"reputation": 365, "user_id": 6698332, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/394297b64c4b4332e72ea15b93f86187?s=128&d=identicon&r=PG&f=1", "display_name": "user6698332", "link": "https://stackoverflow.com/users/6698332/user6698332"}, "is_accepted": true, "score": 0, "last_activity_date": 1527714798, "creation_date": 1527714798, "answer_id": 50613420, "question_id": 50612776, "link": "https://stackoverflow.com/questions/50612776/if-statement-returning-not-equal-to-0-when-value-equals-0/50613420#50613420", "title": "If statement returning not equal to 0 when value equals 0", "body": "<ol>\n<li><p>Never, NEVER, <strong>NE-VER compare doubles on equity!</strong> (vars of floating point type)<br>\nLet even just in the mind only - never...<br>\nAnd you do right - your compare is \"&lt;>\" - and you got the right result.</p></li>\n<li><p>Currency is INTEGER type, i.e. not-floating point var.</p>\n\n<ul>\n<li>values, exceeded 4 digits after point, are rounding internally;  </li>\n<li>compare on equity is correct.<br>\n.</li>\n</ul></li>\n</ol>\n"}], "owner": {"reputation": 25, "user_id": 9232085, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e5fe118cc95e3ef6707db43fb773739?s=128&d=identicon&r=PG&f=1", "display_name": "J. Mill", "link": "https://stackoverflow.com/users/9232085/j-mill"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 354, "favorite_count": 0, "accepted_answer_id": 50613420, "answer_count": 2, "score": 1, "last_activity_date": 1527714798, "creation_date": 1527711541, "last_edit_date": 1531164843, "question_id": 50612776, "link": "https://stackoverflow.com/questions/50612776/if-statement-returning-not-equal-to-0-when-value-equals-0", "title": "If statement returning not equal to 0 when value equals 0", "body": "<p>I have a variable, Diff as a double. (values are a sample from my Workbook)</p>\n\n<pre><code>Dim Diff As Double\nSheets(Sheet1).Activate\nDiff = 4382.98-4117.34-265.64\n</code></pre>\n\n<p>Values for calculating Diff come from cells formatted as numbers.\nI then use Diff as an argument in an if statement.</p>\n\n<pre><code>If Diff &lt;&gt; 0 Then\n    ActiveSheet.Range(A2).Value = 265.64 + Diff\nEnd If\n</code></pre>\n\n<p>Diff should equal 0, but the if statement is proceeding as if the condition is true. I have similar if statements that do not have problems like this. Do I need to format my values differently?</p>\n\n<p>Edit: Had 43892.98 instead of 4382.98\nEdit2: Had 256.64 instead of 265.64</p>\n"}, {"tags": ["vba", "ms-access"], "comments": [{"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1527711541, "post_id": 50612496, "comment_id": 88235461, "body": "Please don&#39;t ask multi-barreled questions. Changing the variable type is a very different issue from changing the formatting. Some properties can be changed, others can&#39;t, and for those that can&#39;t, there are workarounds. But one at a time, please."}, {"owner": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "edited": false, "score": 0, "creation_date": 1527733850, "post_id": 50612496, "comment_id": 88241489, "body": "Why don&#39;t you change it in the query <code>CCur([SumOfSomething])</code> - just because you can see the property doesn&#39;t mean you have the right to change it - may have heard of read-only? You can also change the qdf SQL on the fly if you have your heart set on changing it after creation."}, {"owner": {"reputation": 81, "user_id": 2415642, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18b7f97a271b4560a8e9556645a7ff5d?s=128&d=identicon&r=PG", "display_name": "CedL", "link": "https://stackoverflow.com/users/2415642/cedl"}, "reply_to_user": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1527773693, "post_id": 50612496, "comment_id": 88261174, "body": "@ErikvonAsmuth Sorry, i now have change my question to only the main problem. Rounding in my query definition actually does the same thing as far as i know so i got that problem out of the way.  So my main problem now is showing result as Currency in my query. I am able to change it by hand just by going in the desing view and change the format to currency, but i&#39;m wondering if there is a way to do it in VBA."}, {"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1527774140, "post_id": 50612496, "comment_id": 88261490, "body": "@CedL Do you mean <i>formatting as currency</i> or <i>changing the data type to currency</i>? Those are very different things."}, {"owner": {"reputation": 81, "user_id": 2415642, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18b7f97a271b4560a8e9556645a7ff5d?s=128&d=identicon&r=PG", "display_name": "CedL", "link": "https://stackoverflow.com/users/2415642/cedl"}, "reply_to_user": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1527774599, "post_id": 50612496, "comment_id": 88261810, "body": "@ErikvonAsmuth I would say format it? Like for exemple, you can show the data as percent or euro or, as i&#39;d like, currency. So this way it will show the value with a dollar sign"}], "answers": [{"tags": [], "owner": {"reputation": 23837, "user_id": 10527, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/53cb42e8d0af98015cc089bf2e5908a7?s=128&d=identicon&r=PG", "display_name": "Albert D. Kallal", "link": "https://stackoverflow.com/users/10527/albert-d-kallal"}, "is_accepted": false, "score": 0, "last_activity_date": 1527736562, "creation_date": 1527736562, "answer_id": 50616118, "question_id": 50612496, "link": "https://stackoverflow.com/questions/50612496/can-we-format-in-vba-a-query-field-properties-after-it-is-create/50616118#50616118", "title": "Can we format, in VBA, a query field properties after it is create?", "body": "<p>We have to be clear here on the goal. Do you want to \u201cjust\u201d cast or change the column type returned in a query, or do you want to modify the actual column type in the database table? These are two VERY different goals.</p>\n\n<p>To use code to modify a column type, you have to create (add) the new column type, transfer the data, and then delete the old column, and then re-name the column back to the old type.</p>\n\n<p>In other words, you can\u2019t just change the data type, since Access will THEN have to update each and every row to the new data type.</p>\n\n<p>The UI system in fact does the above behind the scenes.</p>\n\n<p>If you use DAO code, then you need the following code outlined here:</p>\n\n<p><a href=\"http://accessblog.net/2007/03/how-to-change-field-type-using-dao.html\" rel=\"nofollow noreferrer\">http://accessblog.net/2007/03/how-to-change-field-type-using-dao.html</a></p>\n\n<p>However, above is quite a bit of code. In place of DAO code to add the column, you CAN use a DDL command.</p>\n\n<p>(SQL data definition language) to modify the type. Thus in code you can do this:</p>\n\n<pre><code>Dim db         As dao.Database\nDim strSQL     As String\n\nSet db = CurrentDb\n\nstrSQL = \"ALTER TABLE dbo_tblHotels1 ALTER COLUMN MyAmount currency\"\ndb.Execute strSQL, dbFailOnError\n</code></pre>\n\n<p>So in above, we change the column \"MyAmount\" to currency type.</p>\n"}, {"comments": [{"owner": {"reputation": 81, "user_id": 2415642, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18b7f97a271b4560a8e9556645a7ff5d?s=128&d=identicon&r=PG", "display_name": "CedL", "link": "https://stackoverflow.com/users/2415642/cedl"}, "edited": false, "score": 0, "creation_date": 1527777487, "post_id": 50626274, "comment_id": 88263735, "body": "Just to make sure, <code>&quot;\u20ac #,##0.00;\u20ac #,##0.00-&quot;</code>  means we allow 2 decimal, every 3 number (sorry, cant remember the term) are divided by comma and the money sign is on front?"}, {"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "reply_to_user": {"reputation": 81, "user_id": 2415642, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18b7f97a271b4560a8e9556645a7ff5d?s=128&d=identicon&r=PG", "display_name": "CedL", "link": "https://stackoverflow.com/users/2415642/cedl"}, "edited": false, "score": 1, "creation_date": 1527778208, "post_id": 50626274, "comment_id": 88264203, "body": "@CedL Honestly, it corresponds with the <i>Currency</i> format option in the dropdown for my locale, but I haven&#39;t analyzed it. You can see at the bottom how I acquired it. It&#39;s also identical to the <i>Euro</i> format option. I suggest you first print out the formatting for your locale, and then just use that."}, {"owner": {"reputation": 81, "user_id": 2415642, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18b7f97a271b4560a8e9556645a7ff5d?s=128&d=identicon&r=PG", "display_name": "CedL", "link": "https://stackoverflow.com/users/2415642/cedl"}, "edited": false, "score": 0, "creation_date": 1527783882, "post_id": 50626274, "comment_id": 88267548, "body": "Aside from # , the rest is pretty easy to understand. Left side is how you show the positive value, right one for negative. Money sign for where it should be. The zeroes are pretty much what you would think. Imagine having 0,21 but you setted your format at 00.00 , it will show 00,21"}], "tags": [], "owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "is_accepted": true, "score": 1, "last_activity_date": 1527775667, "creation_date": 1527775667, "answer_id": 50626274, "question_id": 50612496, "link": "https://stackoverflow.com/questions/50612496/can-we-format-in-vba-a-query-field-properties-after-it-is-create/50626274#50626274", "title": "Can we format, in VBA, a query field properties after it is create?", "body": "<p>Your question appears to be simple, but as you've probably guessed by now, it isn't.</p>\n\n<p>The format property is a custom property of a field. They can be present, and if they are, they should be changed using the <code>Field.Properties</code> collection, but if they aren't, they need to be created using <code>Field.CreateProperty</code> method and then appended to the <code>Fields.Properties</code> collection</p>\n\n<pre><code>Const currencyFormat As String = \"\u20ac #,##0.00;\u20ac #,##0.00-\"'Dutch currency format, you need to set this for your locale\nDim qd As DAO.QueryDef\nSet qd = CurrentDb.QueryDefs(\"TestQuery\")\nOn Error Resume Next\nqd.Fields(\"SumOfSomething\").Properties!Format = currencyFormat\nIf Err.Number = 3270 Then 'Property not found, field had no format set\n    qd.Fields(\"SumOfSomething\").Properties.Append qd.Fields(\"SumOfSomething\").CreateProperty(\"Format\", dbText, currencyFormat)\nEnd If\nOn Error GoTo 0\n</code></pre>\n\n<p>You can get the currency format for your locale by setting a field to use it, and then using <code>?CurrentDb.QueryDefs(\"TestQuery\").Fields(\"SumOfSomething\").Properties!Format</code></p>\n"}], "owner": {"reputation": 81, "user_id": 2415642, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18b7f97a271b4560a8e9556645a7ff5d?s=128&d=identicon&r=PG", "display_name": "CedL", "link": "https://stackoverflow.com/users/2415642/cedl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1256, "favorite_count": 0, "accepted_answer_id": 50626274, "answer_count": 2, "score": 1, "last_activity_date": 1527775667, "creation_date": 1527710073, "last_edit_date": 1527775451, "question_id": 50612496, "link": "https://stackoverflow.com/questions/50612496/can-we-format-in-vba-a-query-field-properties-after-it-is-create", "title": "Can we format, in VBA, a query field properties after it is create?", "body": "<p>In Access, when creating a new query using vba, some of the data I'm getting are currency, but it comes by default as <em>General Number</em>. I would like to change it's format like we can do in the <em>Property Sheet</em>, but I can't seem to find a way.</p>\n\n<p>I have tried </p>\n\n<pre><code>db.QueryDefs(\"TestQuery\").Fields(\"SumOfSomething\").Type = DAO.dbCurrency\n</code></pre>\n\n<p>But then I get: <code>Run-time error '3219': Invalid operation.</code> </p>\n\n<p>I have searched around a bit and found a similar question (but couldn't find it back) to which the answer was that you can't change that after it is created. I fail to see the point of having the possibility to change the type if we can't actually do it. </p>\n\n<p>So, in the end, can we change (in VBA) the properties of a field after the query is created?</p>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 1, "creation_date": 1527710155, "post_id": 50612415, "comment_id": 88234903, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/50595765/how-to-specify-current-user-desktop-for-docmd-transfertext\">How to specify current user desktop for DoCmd.TransferText</a>"}, {"owner": {"reputation": 6200, "user_id": 7923463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8063a07902a59be5f26d31626600dee?s=128&d=identicon&r=PG&f=1", "display_name": "Kostas K.", "link": "https://stackoverflow.com/users/7923463/kostas-k"}, "edited": false, "score": 0, "creation_date": 1527764235, "post_id": 50612415, "comment_id": 88255051, "body": "Try: <code>DesktopPath = CreateObject(&quot;WScript.Shell&quot;).SpecialFolders(&quot;Desktop&quot;) &amp; &quot;\\&quot;</code>"}], "answers": [{"comments": [{"owner": {"reputation": 375, "user_id": 3216034, "user_type": "registered", "accept_rate": 26, "profile_image": "https://www.gravatar.com/avatar/eb061981ca8df90d46d66da96a0b0577?s=128&d=identicon&r=PG&f=1", "display_name": "jpl458", "link": "https://stackoverflow.com/users/3216034/jpl458"}, "edited": false, "score": 0, "creation_date": 1527790469, "post_id": 50616090, "comment_id": 88270770, "body": "Well answered.  Really liked the last suggestion. Everything working as it should, so thank you for the explanation.  Appreciate the time you took. Thanks again."}], "tags": [], "owner": {"reputation": 473, "user_id": 9513577, "user_type": "registered", "profile_image": "https://graph.facebook.com/10157931990617524/picture?type=large", "display_name": "Isaac Reefman", "link": "https://stackoverflow.com/users/9513577/isaac-reefman"}, "is_accepted": true, "score": 1, "last_activity_date": 1527736252, "creation_date": 1527736252, "answer_id": 50616090, "question_id": 50612415, "link": "https://stackoverflow.com/questions/50612415/inserr-user-name-into-path-to-desktp/50616090#50616090", "title": "inserr User name into path to Desktp", "body": "<p>It really looks to me like you've just not got the right combination of quotes and ampersands...</p>\n\n<p>Try: </p>\n\n<pre><code>UseName = Environ(\"UserName\")\nDoCmd.TransferSpreadsheet _\nacExport, _\nacSpreadsheetTypeExcel12Xml, _\n\"RevbyYrbyMo\", _\n\"C:\\Users\\\" &amp; UseName &amp; \"\\Desktop\\RSExcel.xlsx\", _\nTrue\n</code></pre>\n\n<p>Alternatively you could specify the whole name and path as that variable, something like:</p>\n\n<pre><code>FileName = \"C:\\Users\\\" &amp; Environ(\"UserName\") &amp; \"\\Desktop\\RSExcel.xlsx\"\n</code></pre>\n\n<p>You can take that idea as far as you like - often a good way to deal with this sort of thing to make it really nice and clear is to turn every element of the method into a variable:</p>\n\n<pre><code>Dim TransferType As AcDataTransferType\nDim SpreadsheetType As AcSpreadSheetType\nDim TableName As String\nDim FileName As String\nDim HasFieldNames As Boolean\n\nTransferType = acExport\nSpreadsheetType = acSpreadsheetTypeExcel12Xml\nTableName = \"RevbyYrbyMo\"\nFileName = \"C:\\Users\\\" &amp; Environ(\"UserName\") &amp; \"\\Desktop\\RSExcel.xlsx\"\nHasFieldNames = True\n\nDoCmd.TransferSpreadsheet TransferType, SpreadsheetType, TableName, FileName, HasFieldNames\n</code></pre>\n\n<p>Also means it's really clear for later revision, troubleshooting or extension.</p>\n"}], "owner": {"reputation": 375, "user_id": 3216034, "user_type": "registered", "accept_rate": 26, "profile_image": "https://www.gravatar.com/avatar/eb061981ca8df90d46d66da96a0b0577?s=128&d=identicon&r=PG&f=1", "display_name": "jpl458", "link": "https://stackoverflow.com/users/3216034/jpl458"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 44, "favorite_count": 0, "accepted_answer_id": 50616090, "answer_count": 1, "score": 0, "last_activity_date": 1594634539, "creation_date": 1527709786, "last_edit_date": 1594634539, "question_id": 50612415, "link": "https://stackoverflow.com/questions/50612415/inserr-user-name-into-path-to-desktp", "title": "inserr User name into path to Desktp", "body": "<p>Have this bit of code and I want to get the user name from environ and insert it into the path to the desktop in the code;</p>\n\n<pre><code>UseName = Environ(\"UserName\")\nDoCmd.TransferSpreadsheet _\nacExport, _\nacSpreadsheetTypeExcel12Xml, _\n\"RevbyYrbyMo\", _\n\"C:\\Users\\UseName\\Desktop\\RSExcel.xlsx\", _\nTrue\n</code></pre>\n\n<p>Tried ampersands, quotes etc, nothing works. Want the spreadsheet to be on the desktop of the user automatically.</p>\n\n<p>Thanks</p>\n"}, {"tags": ["sql", "vba", "excel", "odbc"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1527720160, "post_id": 50612291, "comment_id": 88238407, "body": "ADO doesn&#39;t support the full SQL server SQL syntax, so <code>EXCEPT</code> may not be available to you."}, {"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1527782118, "post_id": 50612291, "comment_id": 88266661, "body": "@TimWilliams ... OP is not using SQL Server but running SQL on Excel sheets, hence using the JET/ACE SQL syntax which does not support <code>EXCEPT</code>."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1527793198, "post_id": 50612291, "comment_id": 88272125, "body": "That&#39;s what I meant - they are trying to use SQL server (T-sql) syntax which is not supported via ADO [against Excel files as datasource]"}], "answers": [{"tags": [], "owner": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "is_accepted": true, "score": 2, "last_activity_date": 1527782190, "last_edit_date": 1527782190, "creation_date": 1527778832, "answer_id": 50627295, "question_id": 50612291, "link": "https://stackoverflow.com/questions/50612291/vba-ado-excel-driver-sql-except-minus-operator/50627295#50627295", "title": "VBA ADO Excel Driver SQL Except/Minus operator", "body": "<p>You need to do a <code>LEFT JOIN</code> between the two tables and then select only those rows in <em>NewTable</em> that have no corresponding entries in <em>OldTable</em>. To do this you will need to work out which fields correspond to each other in the two tables.</p>\n\n<pre class=\"lang-sql prettyprint-override\"><code>SELECT * FROM NewTable \nLEFT JOIN OldTable ON NewTable.Field1 = OldTable.Field1\nWHERE OldTable.Field1 IS NULL\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 2226955, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/43f3f8b261465789cfc728321d2c94a7?s=128&d=identicon&r=PG", "display_name": "KristofDM", "link": "https://stackoverflow.com/users/2226955/kristofdm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 650, "favorite_count": 0, "accepted_answer_id": 50627295, "answer_count": 1, "score": 1, "last_activity_date": 1527782190, "creation_date": 1527709208, "question_id": 50612291, "link": "https://stackoverflow.com/questions/50612291/vba-ado-excel-driver-sql-except-minus-operator", "title": "VBA ADO Excel Driver SQL Except/Minus operator", "body": "<p>I have 2 tables (new data and old data) and want to query all new rows that are not present in the old data. </p>\n\n<pre><code>SELECT * FROM new \nEXCEPT \nSELECT * FROM prev\n</code></pre>\n\n<p>I wanted to do this with the 'EXCEPT/MINUS' operator in VBA ADO(using Excel sheets as tables), however it seems that EXCEPT is not an accepted operator? </p>\n\n<p>I get a run-time error </p>\n\n<pre><code>[Microsoft][ODBC Excel Driver] Syntax error in FROM clause.\n</code></pre>\n\n<p>Is it just a feature that is not available in the ADO ODBC Excel Driver?\nOther queries work just fine.</p>\n\n<p>Thanks in advance!</p>\n"}, {"tags": ["vba", "excel", "checkbox", "userform"], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 9814517, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3dc0e5090bba35a829e4bf5753152a0?s=128&d=identicon&r=PG&f=1", "display_name": "MickeyMe", "link": "https://stackoverflow.com/users/9814517/mickeyme"}, "edited": false, "score": 0, "creation_date": 1527711357, "post_id": 50612595, "comment_id": 88235391, "body": "Is that all?  I didn&#39;t know the word of the &quot;checkbox&quot; can be deleted in the code. Thank you."}, {"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1527711427, "post_id": 50612595, "comment_id": 88235414, "body": "Exactly, beaten me to it. However if you just want to count checkboxes you will have to loop through the controls on your page and check if Typename(ctl) = \u201cCheckbox\u201d"}, {"owner": {"reputation": 4047, "user_id": 3246362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6da9a197d0f0e5f19875d8a97550e58e?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/3246362/sam"}, "edited": false, "score": 0, "creation_date": 1527711835, "post_id": 50612595, "comment_id": 88235595, "body": "Oops. Update coming. Thanks!"}, {"owner": {"reputation": 11, "user_id": 9814517, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3dc0e5090bba35a829e4bf5753152a0?s=128&d=identicon&r=PG&f=1", "display_name": "MickeyMe", "link": "https://stackoverflow.com/users/9814517/mickeyme"}, "edited": false, "score": 0, "creation_date": 1527712120, "post_id": 50612595, "comment_id": 88235719, "body": "Could you also give me an advice using &quot;IF&quot; statement?  If I want on only select, I want to only count checkboxes in Page1.  The one below still  works when I am selecting &quot;Page2&quot;.      If Me.MultiPage1..Pages(0).Enabled = True Then            cnt = Me.MultiPage1.Pages(0).Controls.Count        MsgBox cnt        End If"}, {"owner": {"reputation": 11, "user_id": 9814517, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3dc0e5090bba35a829e4bf5753152a0?s=128&d=identicon&r=PG&f=1", "display_name": "MickeyMe", "link": "https://stackoverflow.com/users/9814517/mickeyme"}, "edited": false, "score": 0, "creation_date": 1527712701, "post_id": 50612595, "comment_id": 88235930, "body": "Thank you,It worked. I wonder why it is not &quot;Me.MultiPage1.Value = 1&quot;"}, {"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1527712935, "post_id": 50612595, "comment_id": 88236012, "body": "Unlike most VBA controls, the MultiPage control\u2019s indices are 0-based. It\u2019s peculiar..."}], "tags": [], "owner": {"reputation": 4047, "user_id": 3246362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6da9a197d0f0e5f19875d8a97550e58e?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/3246362/sam"}, "is_accepted": false, "score": 4, "last_activity_date": 1527712001, "last_edit_date": 1527712001, "creation_date": 1527710656, "answer_id": 50612595, "question_id": 50612032, "link": "https://stackoverflow.com/questions/50612032/how-can-i-count-checkboxes-in-only-page1-in-the-userform1/50612595#50612595", "title": "How can I count &quot;Checkboxes&quot; in only Page1 in the UserForm1?", "body": "<p>You will find them here:</p>\n\n<pre><code>Me.MultiPage1.Pages(0).Controls\n</code></pre>\n\n<p>If you just want the number:</p>\n\n<pre><code>MsgBox Me.MultiPage1.Pages(0).Controls.Count\n</code></pre>\n\n<p><strong>UPDATE</strong><br>\nNow actually counting the checkboxes</p>\n\n<pre><code>For Each ctrl In Me.MultiPage1.Pages(0).Controls\n    If TypeOf ctrl Is msforms.CheckBox Then\n        cnt = cnt + 1\n    End If\nNext\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 9814517, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3dc0e5090bba35a829e4bf5753152a0?s=128&d=identicon&r=PG&f=1", "display_name": "MickeyMe", "link": "https://stackoverflow.com/users/9814517/mickeyme"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 50, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1527712001, "creation_date": 1527708076, "last_edit_date": 1527709087, "question_id": 50612032, "link": "https://stackoverflow.com/questions/50612032/how-can-i-count-checkboxes-in-only-page1-in-the-userform1", "title": "How can I count &quot;Checkboxes&quot; in only Page1 in the UserForm1?", "body": "<p>How can I count  \"Checkboxes\" only in Page1 in the UserForm1 with VBA?\nMine here below counts all in Page2 and Page3. Thanks.</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n    Dim cnt As Integer\n    cnt = Count.CheckBox()\n    If Me.MultiPage1.Enabled = True Then\n        Dim ctrl As msforms.Control, cnt As Long    \n        cnt = 0\n        For Each ctrl In UserForm1.Controls\n            If TypeOf ctrl Is msforms.CheckBox Then\n                cnt = cnt + 1\n            End If\n        Next\n        MsgBox cnt\n     End If\n</code></pre>\n"}, {"tags": ["vba", "timestamp", "vlookup"], "comments": [{"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1527707211, "post_id": 50611780, "comment_id": 88233579, "body": "Unfortunately, You will need to write a macro that will check the cells value on a consistent time interval (every 10 seconds? Minute? Half hour?) depends on how accurate you want your time stamp."}, {"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1527707262, "post_id": 50611780, "comment_id": 88233610, "body": "Edit your question, add 4 leading spaces to each line that should appear in code. Or highlight all of your code and hit CTRL+K"}, {"owner": {"reputation": 1, "user_id": 9872217, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/761bc1dad2cef3324cb1c1d36d57ca1e?s=128&d=identicon&r=PG&f=1", "display_name": "Jppatter", "link": "https://stackoverflow.com/users/9872217/jppatter"}, "reply_to_user": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1527771968, "post_id": 50611780, "comment_id": 88260030, "body": "Thanks for the tip!, and I would say maybe to have it look every 1 minute would be an ideal rate for it to check. Would the code for this be very extensive?"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1527775472, "post_id": 50611780, "comment_id": 88262438, "body": "Are you entering the values in column &quot;quantity&quot; as part of another macro? I think so, but not sure. If so, couldn&#39;t you add the timestamp step to that macro? Otherwise disregard the suggestion."}, {"owner": {"reputation": 1, "user_id": 9872217, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/761bc1dad2cef3324cb1c1d36d57ca1e?s=128&d=identicon&r=PG&f=1", "display_name": "Jppatter", "link": "https://stackoverflow.com/users/9872217/jppatter"}, "edited": false, "score": 0, "creation_date": 1528291773, "post_id": 50611780, "comment_id": 88451729, "body": "I did end up adding in the timestamp to my existing macro, i just didn\u2019t know how to write the code to make it timestamp but I have figured it out now. Thanks!"}], "owner": {"reputation": 1, "user_id": 9872217, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/761bc1dad2cef3324cb1c1d36d57ca1e?s=128&d=identicon&r=PG&f=1", "display_name": "Jppatter", "link": "https://stackoverflow.com/users/9872217/jppatter"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 86, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1527708561, "creation_date": 1527706992, "last_edit_date": 1527708561, "question_id": 50611780, "link": "https://stackoverflow.com/questions/50611780/vba-coding-to-timestamp-an-adjacent-cell-when-it-s-value-changes-via-vlookup", "title": "VBA coding to timestamp an adjacent cell when it\u2019s value changes via vLookup", "body": "<p>I have a spreadsheet I am working on that has some coding done to it in VBA. I have a column labeled quantity and a column 2 columns to the right called \"out date\" that I want it to timestamp when \"quantity\" is populated</p>\n\n<p>The values in column \"quantity\" are filled in via vlookup from another sheet in the workbook.</p>\n\n<p>I noticed that if I manually enter a value in the \u201cquantity column the timestamp works perfectly, yet once I set it up via vlookup it no longer enters the timestamp in column \"out date\".</p>\n\n<p>My code for this process currently is as follows:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    Dim xCellColumn As Integer\n    Dim xTimecolumn As Integer\n    Dim xRow, xCol As Integer\n\n    xCellColumn = 11\n    xTimecolumn = 13\n    xRow = Target.Row\n    xCol = Target.Column\n\n    If Target.Text &lt;&gt; \"\" Then\n        If xCol = xColumn Then\n            Cells(xRow, xTimecolumn) = Now()\n        End If\n    End If\nEnd Sub\n</code></pre>\n\n<p>Is it possible to still have a timestamp automatically entered when the value is entered via vlookup?</p>\n\n<p>I've done some extensive searching and all I can find is how to timestamp when a cell value changes by entering it</p>\n"}, {"tags": ["excel", "vba", "message", "alarm"], "answers": [{"tags": [], "owner": {"reputation": 483, "user_id": 2708741, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/845133c785e2d656ce763ddd930bfd7f?s=128&d=identicon&r=PG&f=1", "display_name": "Huy Pham", "link": "https://stackoverflow.com/users/2708741/huy-pham"}, "is_accepted": false, "score": 1, "last_activity_date": 1536852358, "last_edit_date": 1536852358, "creation_date": 1527713573, "answer_id": 50613192, "question_id": 50610999, "link": "https://stackoverflow.com/questions/50610999/vba-excel-running-list-of-alarm-messages-based-on-cell-value/50613192#50613192", "title": "VBA Excel Running List of Alarm Messages Based on Cell Value", "body": "<p>Easier this way:</p>\n\n<pre><code>&lt;code&gt;\nFunction AlarmDescriptions(Val As Integer) As String\n    Dim alarmMsg As String\n\n    Select Case Val\n      Case 0\n         alarmMsg = \"No Active Alarms\"\n      Case 1\n         alarmMsg = \"Proofer Output Failure Safety\"\n      Case Else\n         alarmMsg = \"Main Drive Overload\"\n    End Select\n\n    AlarmDescriptions = alarmMsg\nEnd Function\n\nPublic Function Msg(Val As Integer) As String\n   Dim Timestamp As Date\n\n   Timestamp = Now\n   Msg = Now &amp; \" - \" &amp; Val &amp; \" - \" &amp; AlarmDescriptions(Val)\nEnd Function\n&lt;/code&gt;\n</code></pre>\n\n<p>Then from any cell, just type in formula: <code>=Msg(H5)</code>\nand the message will display in that cell</p>\n"}], "owner": {"reputation": 1, "user_id": 9866962, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-eREx4vsafwA/AAAAAAAAAAI/AAAAAAAAJG0/5ZRNa2MKvnU/photo.jpg?sz=128", "display_name": "GEstrada", "link": "https://stackoverflow.com/users/9866962/gestrada"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 211, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1536852410, "creation_date": 1527703681, "last_edit_date": 1536852410, "question_id": 50610999, "link": "https://stackoverflow.com/questions/50610999/vba-excel-running-list-of-alarm-messages-based-on-cell-value", "title": "VBA Excel Running List of Alarm Messages Based on Cell Value", "body": "<p>I have a list of alarm messages, that I want to display in cell K5, depending on the value in cell H5. I have this code in the module. </p>\n\n<pre><code>Sub Display_Alarm_Descriptions()\n    Dim alarmNumber As Integer, alarmMsg As String\n    alarmNumber = Range(\"H5\").Value\n    If alarmNumber = 0 Then alarmMsg = \"No Active Alarms\"\n    If alarmNumber = 1 Then alarmMsg = \"Proofer Output Failure Safety\"\n    If alarmNumber = 2 Then alarmMsg = \"Main Drive Overload\"\n    Range(\"K5\").Value = alarmMsg\n\nEnd Sub\n</code></pre>\n\n<p>What I would like to add is a running list of the timestamp when the value in H5 changes, what the new value of H5 is and the associated alarm message from K5. If H5 changes, I want the new information(time stamp, H5 value and alarm message) in the next available cells below.</p>\n"}, {"tags": ["json", "vba"], "answers": [{"tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": true, "score": 2, "last_activity_date": 1527704449, "creation_date": 1527704449, "answer_id": 50611193, "question_id": 50610937, "link": "https://stackoverflow.com/questions/50610937/extracting-one-specific-line-from-parsed-json-string/50611193#50611193", "title": "Extracting one specific line from parsed JSON string", "body": "<p>Use </p>\n\n<pre><code>parsedResult(\"From\")(\"Chocolate\")(\"AsAtDate\")\n</code></pre>\n\n<p>Or more generally to get all:</p>\n\n<pre><code>parsedResult(\"From\")(item)(\"AsAtDate\")\n</code></pre>\n"}], "owner": {"reputation": 716, "user_id": 6819959, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/53e270754d794040cf238ecd9093c6eb?s=128&d=identicon&r=PG&f=1", "display_name": "S31", "link": "https://stackoverflow.com/users/6819959/s31"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 23, "favorite_count": 0, "accepted_answer_id": 50611193, "answer_count": 1, "score": 0, "last_activity_date": 1527704449, "creation_date": 1527703389, "last_edit_date": 1527703932, "question_id": 50610937, "link": "https://stackoverflow.com/questions/50610937/extracting-one-specific-line-from-parsed-json-string", "title": "Extracting one specific line from parsed JSON string", "body": "<p>Trying to pull first value from a parsed JSON string using the JsonConverter library. </p>\n\n<p>What I currently have is:</p>\n\n<pre><code>result = objHTTP.responseText\n\nSet parsedResult = JsonConverter.ParseJson(result)\n\ni = 3\nFor Each Item In parsedResult(\"From\")\n    wsSheet0.Cells(i, 12) = parsedResult(\"From\")(Item)(\"Price\")\n    i = i + 1\nNext\n\nWith parsedResult(\"From\")\nwsSheet0.Cells(11, 12) = parsedResult(\"From\")(\"Chocolate\")(\"Price\")(\"AsAtDate\")\nEnd With\n</code></pre>\n\n<p>The last line of this gets a <code>type mismatch</code> error, so I'm still trying to figure out how to just pull that one line item. </p>\n\n<p>For the sake of clarity, the parsed JSON string looks like: </p>\n\n<pre><code>{  \n   \"From\":{  \n      \"Chocolate\":{  \n         \"Price\":1.0,\n         \"AsAtDate\":\"2018-05-04T00:00:00\"\n      },\n      \"Lime\":{  \n         \"Price\":1.35415115,\n         \"AsAtDate\":\"2018-05-04T00:00:00\"\n      },\n      \"Strawberry\":{  \n         \"Price\":1.19517151,\n         \"AsAtDate\":\"2018-05-04T00:00:00\"\n      },\n      \"Vanilla\":{  \n         \"Price\":0.77522986,\n         \"AsAtDate\":\"2018-05-04T00:00:00\"\n      },\n      \"Blueberry\":{  \n         \"Price\":1.00084071,\n         \"AsAtDate\":\"2018-05-04T00:00:00\"\n      },\n      \"Lemon\":{  \n         \"Price\":0.75030012,\n         \"AsAtDate\":\"2018-05-04T00:00:00\"\n      }\n   },\n   \"To\":\"Chocolate\",\n   \"RequestedDate\":\"2018-05-22T08:26:16\"\n}\n</code></pre>\n"}, {"tags": ["ms-access", "vba", "ms-access-2010"], "comments": [{"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 2, "creation_date": 1527702893, "post_id": 50610746, "comment_id": 88231486, "body": "And the $64 million dollar question: why close the Main Menu? Tables and queries are not user interface objects and normally are not opened directly for the user. Consider using a datasheet form of table."}, {"owner": {"reputation": 569, "user_id": 4564588, "user_type": "registered", "accept_rate": 45, "profile_image": "https://i.stack.imgur.com/4flFk.jpg?s=128&g=1", "display_name": "Arsee", "link": "https://stackoverflow.com/users/4564588/arsee"}, "reply_to_user": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1527710514, "post_id": 50610746, "comment_id": 88235072, "body": "I have the table to load.  The step process is the main menu load then the user click the button to load the table to edit. The main menu is closed when the table load. When the user close the table I want the main menu to open again to select.  Because if I don&#39;t close the main menu and the table opens the main menu is in the front of the table."}, {"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 2, "creation_date": 1527714065, "post_id": 50610746, "comment_id": 88236433, "body": "Once again use a datasheet bound to table and then you will have a VBA event to use. Datasheets can look very similar to tables."}, {"owner": {"reputation": 473, "user_id": 9513577, "user_type": "registered", "profile_image": "https://graph.facebook.com/10157931990617524/picture?type=large", "display_name": "Isaac Reefman", "link": "https://stackoverflow.com/users/9513577/isaac-reefman"}, "reply_to_user": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1527736667, "post_id": 50610746, "comment_id": 88242176, "body": "what @Parfait said, unless for some reason the user needs to be able to edit the structure of the table. Which would be pretty unusual, and personally I&#39;d rather give the user an interface of dialog boxes walking them through set kinds of table alterations to keep it limited, rather than let someone who may or may not know what they&#39;re doing have virtually direct and unlimited access/permissions on the raw data..."}], "answers": [{"tags": [], "owner": {"reputation": 473, "user_id": 9513577, "user_type": "registered", "profile_image": "https://graph.facebook.com/10157931990617524/picture?type=large", "display_name": "Isaac Reefman", "link": "https://stackoverflow.com/users/9513577/isaac-reefman"}, "is_accepted": true, "score": 1, "last_activity_date": 1527737110, "creation_date": 1527737110, "answer_id": 50616174, "question_id": 50610746, "link": "https://stackoverflow.com/questions/50610746/access-vba-opening-a-form-after-closing-table/50616174#50616174", "title": "Access VBA - Opening a Form after Closing Table", "body": "<p>As <a href=\"https://stackoverflow.com/users/1422451/parfait\">Parfait</a> said in the comments, giving the user direct access to the table itself is rarely a good idea. I'd recommend creating a datasheet version of the table so they can view the data in a table-like layout.</p>\n\n<p>Specifically, you want to create a form that defaults to datasheet view. There are many ways to do this, but the easiest way in Access 2010 is to open the table you wish to link to, and in the forms group of the Create tab, click \"more forms\" and then \"datasheet\". </p>\n\n<p>All you need to do then is save the table, and then link to <em>that</em> with the button on your main menu, instead of the original table. You won't need to close the main menu, as it'll hide behind the new form, and closing the new form will reveal it again behind.</p>\n"}], "owner": {"reputation": 569, "user_id": 4564588, "user_type": "registered", "accept_rate": 45, "profile_image": "https://i.stack.imgur.com/4flFk.jpg?s=128&g=1", "display_name": "Arsee", "link": "https://stackoverflow.com/users/4564588/arsee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 481, "favorite_count": 0, "accepted_answer_id": 50616174, "answer_count": 1, "score": -1, "last_activity_date": 1594634519, "creation_date": 1527702615, "last_edit_date": 1594634519, "question_id": 50610746, "link": "https://stackoverflow.com/questions/50610746/access-vba-opening-a-form-after-closing-table", "title": "Access VBA - Opening a Form after Closing Table", "body": "<p>I have an access database where I created a Main Menu to Open a table then closed the main menu.  I'm having issue when the table is closed I need to open the main menu form, and I'm not sure where to put the vba code.</p>\n"}, {"tags": ["json", "vba", "ms-access", "oauth-2.0", "http-status-code-401"], "comments": [{"owner": {"reputation": 97, "user_id": 7469948, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ed61ca128d14949852799e1a9d93083?s=128&d=identicon&r=PG&f=1", "display_name": "Gregory", "link": "https://stackoverflow.com/users/7469948/gregory"}, "edited": false, "score": 1, "creation_date": 1528204686, "post_id": 50610609, "comment_id": 88411386, "body": "Solved, api key provided by the supplier was wrong. <i>eye-roller</i>"}], "owner": {"reputation": 97, "user_id": 7469948, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ed61ca128d14949852799e1a9d93083?s=128&d=identicon&r=PG&f=1", "display_name": "Gregory", "link": "https://stackoverflow.com/users/7469948/gregory"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 4160, "favorite_count": 2, "answer_count": 0, "score": 2, "last_activity_date": 1593644232, "creation_date": 1527701982, "last_edit_date": 1593644232, "question_id": 50610609, "link": "https://stackoverflow.com/questions/50610609/vba-authorization-oauth2-api", "title": "VBA Authorization oauth2 API", "body": "<p>Been stuck on this for a few days now.\nTrying to obtain access token from an API with oauth2 authentication.</p>\n\n<p>But I keep getting '401 Unauthorized',\n\"Full authentication is required'</p>\n\n<p>My gues is i'm doing something wrong with the </p>\n\n<pre><code> .SetRequestHeder \"Authorization\", \"basic \" + (base64 encoded)\n</code></pre>\n\n<p>Here's the code so far: (worked with another API)</p>\n\n<pre><code>Username = \"myusername\"\nPassword = \"myclientsecret\"\n\nPasswordnUsername = Password &amp; \":\" &amp; Username\n\n    argumentString = \"?grant_type=password&amp;username=myusername&amp;password=mypassword\"\n\nSet xmlhttp = CreateObject(\"MSXML2.XMLHTTP.6.0\")\n    xmlhttp.Open \"POST\", \"https://api.url/partner/oauth/token\", False\n    xmlhttp.SetRequestHeader \"Authorization\", \"basic \" + mdl_API_MB_ACCESS_TOKEN.Base64Encode(PasswordnUsername)\n    xmlhttp.SetRequestHeader \"x-api-key\", \"myxapicode\"\n    xmlhttp.Send (argumentString)\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1527701231, "post_id": 50610363, "comment_id": 88230578, "body": "You can do this using conditional formatting - do you absolutely need to use VBA?"}, {"owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 0, "creation_date": 1527701404, "post_id": 50610363, "comment_id": 88230691, "body": "If you must use VBA, be aware that <code>cells that has value &gt; 0</code> is not equivalent to <code>cell.Value &lt;&gt; &quot;&quot;</code>, you should use <code>cell.Value &gt; 0</code> instead. But as BigBen mentions, conditional formating does exactly what you ask for."}, {"owner": {"reputation": 19, "user_id": 7926114, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa9b0f16394264dc875d5d79988d8689?s=128&d=identicon&r=PG&f=1", "display_name": "Goal7", "link": "https://stackoverflow.com/users/7926114/goal7"}, "edited": false, "score": 0, "creation_date": 1527701407, "post_id": 50610363, "comment_id": 88230693, "body": "Yes! so i can have the process repeatable and can implement for other text"}, {"owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 0, "creation_date": 1527701548, "post_id": 50610363, "comment_id": 88230788, "body": "@Goal7 Then instead of hardcoding the text in the formula for your conditional formating, refer to a cell instead. Change the value of the cell, different cells get highlighted"}, {"owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "edited": false, "score": 0, "creation_date": 1527701653, "post_id": 50610363, "comment_id": 88230853, "body": "Did you mean for the cell to &quot;Contain X&quot; or to equal &quot;X&quot;?"}, {"owner": {"reputation": 19, "user_id": 7926114, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa9b0f16394264dc875d5d79988d8689?s=128&d=identicon&r=PG&f=1", "display_name": "Goal7", "link": "https://stackoverflow.com/users/7926114/goal7"}, "reply_to_user": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "edited": false, "score": 0, "creation_date": 1527701739, "post_id": 50610363, "comment_id": 88230905, "body": "@Davesexcel Contain text &quot;X&quot; . For example Goal X . i updated the columns to A through BQ"}], "answers": [{"comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 19, "user_id": 7926114, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa9b0f16394264dc875d5d79988d8689?s=128&d=identicon&r=PG&f=1", "display_name": "Goal7", "link": "https://stackoverflow.com/users/7926114/goal7"}, "edited": false, "score": 0, "creation_date": 1527703575, "post_id": 50610599, "comment_id": 88231836, "body": "Be aware that my solution explicitly checks for an actual capital X in the cell not just any x. So be sure which you are after. Any x or X. Simply converting to upper case before testing is not the same. Depends what you are after."}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": false, "score": 0, "last_activity_date": 1527702328, "last_edit_date": 1527702328, "creation_date": 1527701945, "answer_id": 50610599, "question_id": 50610363, "link": "https://stackoverflow.com/questions/50610363/highlighting-cell-values-based-on-column-text/50610599#50610599", "title": "Highlighting cell values based on column text", "body": "<p>This isn't optimized but looks for capitalized \"X\" within the column F of rows in the range. If present, it goes on to look at each cell in the other columns and if Isnumeric and > 0 it gets coloured.</p>\n\n<pre><code>Option Explicit\n\nPublic Sub ConCol()\n    Application.ScreenUpdating = False\n    Dim currentRow As Range, loopRange As Range, currentCell As Range\n\n    With ActiveSheet\n\n        Set loopRange = .Range(\"F2:BQ3000\")\n\n        For Each currentRow In loopRange.Rows\n            If InStr(1, currentRow.Columns(1).Value, \"X\", vbBinaryCompare) &gt; 0 Then\n                For Each currentCell In currentRow.Cells\n                    If IsNumeric(currentCell.Value) And currentCell &gt; 0 Then\n                        currentCell.Interior.Color = RGB(255, 105, 108)\n                    End If\n                Next currentCell\n            End If\n        Next\n\n    End With\n\n    Application.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "is_accepted": true, "score": 0, "last_activity_date": 1527702406, "creation_date": 1527702406, "answer_id": 50610690, "question_id": 50610363, "link": "https://stackoverflow.com/questions/50610363/highlighting-cell-values-based-on-column-text/50610690#50610690", "title": "Highlighting cell values based on column text", "body": "<p>There will be several variations:</p>\n\n<pre><code>Sub Button2_Click()\n    Dim LstRw As Long, Rng As Range, Sh As Worksheet, c As Range\n\n    Set Sh = ActiveSheet\n    With Sh\n        LstRw = .Cells(.Rows.Count, \"F\").End(xlUp).Row\n        Set Rng = .Range(\"G2:BQ\" &amp; LstRw)\n        For Each c In Rng.SpecialCells(xlCellTypeConstants, 1)\n            If c &gt; 0 Then\n                If InStr(UCase(.Cells(c.Row, \"F\")), \"X\") Then\n                    c.Interior.Color = RGB(255, 105, 108)\n                End If\n            End If\n        Next c\n    End With\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1236, "user_id": 9839748, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sUzkp.jpg?s=128&g=1", "display_name": "JC Guidicelli", "link": "https://stackoverflow.com/users/9839748/jc-guidicelli"}, "is_accepted": false, "score": 1, "last_activity_date": 1527703085, "last_edit_date": 1527703085, "creation_date": 1527702417, "answer_id": 50610695, "question_id": 50610363, "link": "https://stackoverflow.com/questions/50610363/highlighting-cell-values-based-on-column-text/50610695#50610695", "title": "Highlighting cell values based on column text", "body": "<p>Try this code, it's work fine in my side.\nIf column F contain X, I highlight all cells in a row that contain X also.</p>\n\n<pre><code>Sub ConCol()\n\n'loop on each row\nFor i = 1 To 3000 ' row\n\n    If InStr(1, ActiveSheet.Cells(i, 6).Value, \"X\") &gt; 0 Then ' first condition : if col F contain X\n        'loop on each column BQ = 69\n        For j = 1 To 69\n\n        If InStr(1, ActiveSheet.Cells(i, j).Value, \"x\") &gt; 0 Then 'second condition : in each cell a selected row, if contain X\n        ActiveSheet.Cells(i, j).Interior.Color = RGB(255, 105, 108)\n        End If\n\n        Next j\n\n    End If\n\nNext i\n\nEnd Sub\n</code></pre>\n\n<p>Or this version, I highlight only column F :</p>\n\n<pre><code>Sub ConCol2()\n\n'loop on each row\nFor i = 1 To 3000 ' row\n\n    If InStr(1, ActiveSheet.Cells(i, 6).Value, \"X\") &gt; 0 Then\n\n        ActiveSheet.Cells(i, 6).Interior.Color = RGB(255, 105, 108)\n\n    End If\n\nNext i\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 19, "user_id": 7926114, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa9b0f16394264dc875d5d79988d8689?s=128&d=identicon&r=PG&f=1", "display_name": "Goal7", "link": "https://stackoverflow.com/users/7926114/goal7"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 76, "favorite_count": 0, "accepted_answer_id": 50610690, "answer_count": 3, "score": 0, "last_activity_date": 1527703085, "creation_date": 1527701016, "last_edit_date": 1527701670, "question_id": 50610363, "link": "https://stackoverflow.com/questions/50610363/highlighting-cell-values-based-on-column-text", "title": "Highlighting cell values based on column text", "body": "<p>I have an excel sheet with 3000 rows and column F through BQ. I want to highlight specific cells that has value > 0 where the text in column F contains \"X\" . how do i write a VBA macro for it?</p>\n\n<p>I tried the below code but i am not successful :</p>\n\n<pre><code>Sub ConCol()\nSet iRow = Range(\"F2:BQ3000\")\n\nFor Each cell In iRow\n  If cell.Value &lt;&gt; \"\" And Columns(\"$F\") = \"X\" Then\ncell.Interior.Color = RGB(255, 105, 108)\nEnd If\nNext\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 121, "user_id": 6313911, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/121c386080f71b7bcab2235aad26466b?s=128&d=identicon&r=PG&f=1", "display_name": "Lee", "link": "https://stackoverflow.com/users/6313911/lee"}, "edited": false, "score": 0, "creation_date": 1527701825, "post_id": 50610450, "comment_id": 88230943, "body": "I get a bad filename or number on the print line at the bottom"}, {"owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "reply_to_user": {"reputation": 121, "user_id": 6313911, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/121c386080f71b7bcab2235aad26466b?s=128&d=identicon&r=PG&f=1", "display_name": "Lee", "link": "https://stackoverflow.com/users/6313911/lee"}, "edited": false, "score": 0, "creation_date": 1527702145, "post_id": 50610450, "comment_id": 88231109, "body": "Yes, of course. Sorry, you have to close the file after five lines have been written. Are you able to fix that?"}, {"owner": {"reputation": 121, "user_id": 6313911, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/121c386080f71b7bcab2235aad26466b?s=128&d=identicon&r=PG&f=1", "display_name": "Lee", "link": "https://stackoverflow.com/users/6313911/lee"}, "edited": false, "score": 0, "creation_date": 1527702269, "post_id": 50610450, "comment_id": 88231177, "body": "I did try but I either put it in the wrong place or the issue is somewhere else"}, {"owner": {"reputation": 121, "user_id": 6313911, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/121c386080f71b7bcab2235aad26466b?s=128&d=identicon&r=PG&f=1", "display_name": "Lee", "link": "https://stackoverflow.com/users/6313911/lee"}, "edited": false, "score": 0, "creation_date": 1527702706, "post_id": 50610450, "comment_id": 88231405, "body": "Thanks but the first file has the header repeated twice and still only 4 data rows"}, {"owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "reply_to_user": {"reputation": 121, "user_id": 6313911, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/121c386080f71b7bcab2235aad26466b?s=128&d=identicon&r=PG&f=1", "display_name": "Lee", "link": "https://stackoverflow.com/users/6313911/lee"}, "edited": false, "score": 0, "creation_date": 1527706252, "post_id": 50610450, "comment_id": 88233108, "body": "Changed the code, that means I also adjusted the offset of j in cells. Please mention next time that the code is not yours."}], "tags": [], "owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "is_accepted": true, "score": 0, "last_activity_date": 1527706164, "last_edit_date": 1527706164, "creation_date": 1527701337, "answer_id": 50610450, "question_id": 50610173, "link": "https://stackoverflow.com/questions/50610173/excel-vba-export-to-csv-in-batches-of-5/50610450#50610450", "title": "Excel VBA export to csv in batches of 5", "body": "<p>Maybe it's better to do everything in the loop</p>\n\n<pre><code>Option Explicit\n\nSub Export()\nDim FileNum As Integer\nDim Last_Row As Long\nDim My_Range As Range\nDim TotalFileNum As Integer\nDim myStr As String\nDim MYFILE As String\nDim i As Integer\nDim j As Long\n\n    MYFILE = ThisWorkbook.Path &amp; \"\\\"    \n\n    Last_Row = Cells(Rows.Count, 1).End(xlUp).Row\n    Set My_Range = ActiveSheet.Range(\"A2:J\" &amp; Last_Row)\n\n    For j = 1 To Last_Row\n\n        If j = Last_Row Then\n            Close #FileNum\n            Exit For\n        End If\n\n        If (j - 1) Mod 5 = 0 Then\n\n            FileNum = FreeFile\n            Open MYFILE &amp; \"Litch \" &amp; ((j - 1) \\ 5) &amp; \".csv\" For Output As #FileNum\n\n            'Put out the headers\n            myStr = Cells(1, 1).Value\n            For i = 2 To 10\n                myStr = myStr &amp; \",\" &amp; Cells(1, i).Value\n            Next i\n            Print #FileNum, myStr\n            TotalFileNum = (j \\ 5) + 1\n\n        End If\n\n        'Put out the values\n        myStr = Cells(j + 1, 1).Value\n        For i = 2 To 10\n            myStr = myStr &amp; \",\" &amp; Cells(j + 1, i).Value\n        Next i\n\n        Print #FileNum, myStr\n\n        If j Mod 5 = 0 Then\n            Close #FileNum\n        End If\n\n    Next j\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 121, "user_id": 6313911, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/121c386080f71b7bcab2235aad26466b?s=128&d=identicon&r=PG&f=1", "display_name": "Lee", "link": "https://stackoverflow.com/users/6313911/lee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 0, "accepted_answer_id": 50610450, "answer_count": 1, "score": 0, "last_activity_date": 1527706164, "creation_date": 1527700265, "last_edit_date": 1531164843, "question_id": 50610173, "link": "https://stackoverflow.com/questions/50610173/excel-vba-export-to-csv-in-batches-of-5", "title": "Excel VBA export to csv in batches of 5", "body": "<p>I'm trying to export some excel data to .csv in batches of 5 data rows plus 1 header.</p>\n\n<p>My first file has 4 data rows which should be 5 plus the header as shown below</p>\n\n<pre><code>latitude,longitude,altitude(m),heading(deg),curvesize(m),rotationdir,gimbalmode,gimbalpitchangle,actiontype1,actionparam1\n1,-0.5643113,100,0,0,0,2,-90,1,0\n2,-0.56499336,100,180,0,0,2,-90,1,0\n3,-0.56499336,100,180,0,0,2,-90,1,0\n4,-0.56499336,100,180,0,0,2,-90,1,0\n</code></pre>\n\n<p>Whereas the remaining files have 5 data rows (which is correct)</p>\n\n<pre><code>latitude,longitude,altitude(m),heading(deg),curvesize(m),rotationdir,gimbalmode,gimbalpitchangle,actiontype1,actionparam1\n5,-0.56499336,100,180,0,0,2,-90,1,0\n6,-0.56815177,100,0,0,0,2,-90,1,0\n7,-0.56815177,100,0,0,0,2,-90,1,0\n8,-0.56815177,100,0,0,0,2,-90,1,0\n9,-0.56815177,100,0,0,0,2,-90,1,0\n</code></pre>\n\n<p>Any ideas where I have gone wrong?</p>\n\n<pre><code>Sub Export()\n    Dim FileNum As Integer\n    Dim Last_Row As Long\n    Dim My_Range As Range\n    Dim TotalFileNum As Integer\n    Dim myStr As String\n    Dim MYFILE As String\n    Dim i As Integer\n    Dim j As Long\n\n    MYFILE = ThisWorkbook.Path &amp; \"\\\"\n\n    FileNum = FreeFile\n    Last_Row = Cells(Rows.Count, 1).End(xlUp).Row\n    Set My_Range = ActiveSheet.Range(\"A2:J\" &amp; Last_Row)\n\n    Open MYFILE &amp; \"Litch 0.csv\" For Output As #FileNum\n\n    'Put out the headers\n    myStr = Cells(1, 1).Value\n    For i = 2 To 10\n        myStr = myStr &amp; \",\" &amp; Cells(1, i).Value\n    Next i\n    Print #FileNum, myStr\n\n\n\n    For j = 2 To Last_Row\n        If (j - 1) Mod 5 = 0 Then\n            Close #FileNum\n            Open MYFILE &amp; \"Litch \" &amp; ((j - 1) \\ 5) &amp; \".csv\" For Output As #FileNum\n\n            'Put out the headers\n            myStr = Cells(1, 1).Value\n            For i = 2 To 10\n                myStr = myStr &amp; \",\" &amp; Cells(1, i).Value\n            Next i\n            Print #FileNum, myStr\n            TotalFileNum = (j \\ 5) + 1\n        End If\n\n        'Put out the values\n        myStr = Cells(j, 1).Value\n        For i = 2 To 10\n            myStr = myStr &amp; \",\" &amp; Cells(j, i).Value\n        Next i\n        Print #FileNum, myStr\n\n    Next j\n    Close #FileNum\nEnd Sub\n</code></pre>\n\n<p>Thanks in advance for the help</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 3, "user_id": 9324008, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/57624a1b21a4c5346840a231f6767e6f?s=128&d=identicon&r=PG&f=1", "display_name": "SDenison", "link": "https://stackoverflow.com/users/9324008/sdenison"}, "edited": false, "score": 0, "creation_date": 1527700326, "post_id": 50610142, "comment_id": 88230066, "body": "I forgot to mention, the reason for the Find &quot;Component Discs&quot; is because each worksheet has discs listed after that heading but searching column B:B for &quot;Discs/&quot; would work too."}], "answers": [{"tags": [], "owner": {"reputation": 182, "user_id": 4723652, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a83d76e4d118165936de6866d5f42004?s=128&d=identicon&r=PG&f=1", "display_name": "Techie", "link": "https://stackoverflow.com/users/4723652/techie"}, "is_accepted": false, "score": 0, "last_activity_date": 1527701326, "creation_date": 1527701326, "answer_id": 50610447, "question_id": 50610142, "link": "https://stackoverflow.com/questions/50610142/search-all-worksheets-in-specific-cloumn-for-specific-text-and-paste-to-another/50610447#50610447", "title": "Search all worksheets in specific cloumn for specific text and paste to another sheet", "body": "<p>Hi @SDension modified code hope this works</p>\n\n<p>mention sheet obj.</p>\n\n<pre><code>  sh.Columns(\"B:B\").Select\n\n sh.Cells.Find(What:=\"Component Discs\", After:=ActiveCell, LookIn:=xlFormulas, LookAt:= _\nxlPart, SearchOrder:=xlByColumns, SearchDirection:=xlNext, MatchCase:= _\nFalse, SearchFormat:=False).Select   \n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 9324008, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/57624a1b21a4c5346840a231f6767e6f?s=128&d=identicon&r=PG&f=1", "display_name": "SDenison", "link": "https://stackoverflow.com/users/9324008/sdenison"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 31, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1527701326, "creation_date": 1527700167, "last_edit_date": 1527700778, "question_id": 50610142, "link": "https://stackoverflow.com/questions/50610142/search-all-worksheets-in-specific-cloumn-for-specific-text-and-paste-to-another", "title": "Search all worksheets in specific cloumn for specific text and paste to another sheet", "body": "<p>I'm so new to vba that I have searched for this topic and though I have found similar questions I'm still having a hard time understanding the formulas so I hope someone can help.</p>\n\n<p>I want to search Column B in all worksheets in my workbook for any cell that contains \"Disc\" within its text. I then want to copy and paste all the info from the row that it is found in, or if not the entire row, at the very least the info in columns B &amp; C.</p>\n\n<p>This is what I have tried so far but when I get to Select B:B, it is selecting the column on my \"Discs\" sheet instead of the worksheets it should be looping through.</p>\n\n<pre><code>Sub DiscFill()\n '\n '\n ' Keyboard Shortcut: Ctrl+Shift+D\n   Dim DiscsSh As Worksheet\n    Dim sh As Worksheet\n    Dim I As Integer\n\n'add new sheet at the end'\nSet DiscsSh = Worksheets.Add(After:=Worksheets(Worksheets.Count))\n'rename it'\nDiscsSh.Name = \"Discs\"\n\n 'loop through all sheets'\n For Each sh In Worksheets\n    'if sh is not Discs sheet, then'\n     If sh.Name &lt;&gt; DiscsSh.Name Then\n\n\n'Select Column Range and Search for Discs\nColumns(\"B:B\").Select\n\nCells.Find(What:=\"Component Discs\", After:=ActiveCell, LookIn:=xlFormulas, LookAt:= _\n    xlPart, SearchOrder:=xlByColumns, SearchDirection:=xlNext, MatchCase:= _\n    False, SearchFormat:=False).Select\n\n'Finds Row from Search and Adds 1 to start in the correct Row/sku#\nstartRow = Selection.Row + 1\n'Go back to new sheet to start inputing data\nSheets(\"Discs\").Select\n\n'this tells you how far you can potentially go\nFor j = startRow To 999\n        'if blank cell then the loop stops\n        If Sheets(I).Cells(j, 3).Value = \"\" Then\n        Exit For\n    Else\n                mat_num = Sheets(I).Cells(j, 3).Value\n                TitleDescrip = Sheets(I).Cells(j, 2).Value\n                Cells(counter, 1).Value = mat_num\n                Cells(counter, 2).Value = TitleDescrip\n                counter = counter + 1\n        End If\nNext j\n\n    End If\nNext\n\n End Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "sorting"], "answers": [{"tags": [], "owner": {"reputation": 4047, "user_id": 3246362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6da9a197d0f0e5f19875d8a97550e58e?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/3246362/sam"}, "is_accepted": false, "score": 1, "last_activity_date": 1527699366, "creation_date": 1527699366, "answer_id": 50609932, "question_id": 50609770, "link": "https://stackoverflow.com/questions/50609770/macro-to-sort-excel-only-on-highlighted-text/50609932#50609932", "title": "Macro to sort Excel only on highlighted text", "body": "<p>If you can name the ranges of each data set you can do something like this:</p>\n\n<pre><code>Sub SortRanges()\n    Dim TargetSheet As Worksheet\n    Dim RangeName As Variant\n    Dim CurrentRange As Range\n    Set TargetSheet = ThisWorkbook.Worksheets(1)\n    For Each RangeName In Array(\"Range1\", \"Range2\", \"Range3\")\n        Set CurrentRange = TargetSheet.Range(RangeName)\n        CurrentRange.Sort key1:=CurrentRange.Columns(2), key2:=CurrentRange.Columns(4)\n    Next\nEnd Sub\n</code></pre>\n\n<p>It will take the list of range names and sort them one by one on column 2 and 4. If you can't name the ranges, make an array of ranges in your code instead.</p>\n"}, {"comments": [{"owner": {"reputation": 451, "user_id": 7948756, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/10156004697868475/picture?type=large", "display_name": "Christopher Cass", "link": "https://stackoverflow.com/users/7948756/christopher-cass"}, "edited": false, "score": 0, "creation_date": 1527704707, "post_id": 50610166, "comment_id": 88232384, "body": "Thanks.  Unfortunately, that seems to sort the entire sheet, combining all of my sections.  My goal is to sort only a section at a time, but the size of that section changes because we&#39;re constantly adding lines."}, {"owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "reply_to_user": {"reputation": 451, "user_id": 7948756, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/10156004697868475/picture?type=large", "display_name": "Christopher Cass", "link": "https://stackoverflow.com/users/7948756/christopher-cass"}, "edited": false, "score": 0, "creation_date": 1527708323, "post_id": 50610166, "comment_id": 88234068, "body": "I changed it to sort individual columns"}], "tags": [], "owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "is_accepted": false, "score": 1, "last_activity_date": 1527708298, "last_edit_date": 1527708298, "creation_date": 1527700239, "answer_id": 50610166, "question_id": 50609770, "link": "https://stackoverflow.com/questions/50609770/macro-to-sort-excel-only-on-highlighted-text/50610166#50610166", "title": "Macro to sort Excel only on highlighted text", "body": "<p>You can sort the entire column.\nI don't know if you have to clear the sort fields, I just left it in there.</p>\n\n<pre><code>Sub CDER()\n    Dim sh As Worksheet\n    Set sh = Sheets(\"Sheet1\")\n\n    With sh\n        .Sort.SortFields.Clear\n        .Range(\"B:B\").Sort key1:=.Range(\"B:B\"), order1:=xlAscending, Header:=xlYes\n        .Range(\"G:G\").Sort key1:=.Range(\"G:G\"), order1:=xlAscending, Header:=xlYes\n    End With\n\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 451, "user_id": 7948756, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/10156004697868475/picture?type=large", "display_name": "Christopher Cass", "link": "https://stackoverflow.com/users/7948756/christopher-cass"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1528093280, "creation_date": 1527698610, "last_edit_date": 1528093280, "question_id": 50609770, "link": "https://stackoverflow.com/questions/50609770/macro-to-sort-excel-only-on-highlighted-text", "title": "Macro to sort Excel only on highlighted text", "body": "<p>So this is literally the first time I've ever attempted to create a macro in Excel, so wondering if anyone can help me out.  I've got a spreadsheet that is several pages long, with several different, yet similar sets of data.  The different data sets are for different customers, and I need to keep them separate, but I'd like to create a macro to organize the different sets of data by column B, then by column D.  I started with this macro:</p>\n\n<pre><code>Sub Sort_Twice()\n'\n' Sort_Twice Macro\n'\n\n'\n    ActiveWorkbook.Worksheets(\"Sheet1\").Sort.SortFields.Clear\n    ActiveWorkbook.Worksheets(\"Sheet1\").Sort.SortFields.Add Key:=Range(\"B2:B12\") _\n        , SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:=xlSortNormal\n    ActiveWorkbook.Worksheets(\"Sheet1\").Sort.SortFields.Add Key:=Range(\"D2:D12\") _\n        , SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:=xlSortNormal\n    With ActiveWorkbook.Worksheets(\"Sheet1\").Sort\n        .SetRange Range(\"A1:G12\")\n        .Header = xlYes\n        .MatchCase = False\n        .Orientation = xlTopToBottom\n        .SortMethod = xlPinYin\n        .Apply\n    End With\nEnd Sub\n</code></pre>\n\n<p>So this will sort everything between A1 and G12 because that's what I had highlighted when I started recording.  Any suggestion on how to get to allow me to highlight a new block and run the macro only on those fields?  The only things I can find say to change the the cells listed in the rangers here, but that seems very counterintuitive to what I'm trying to do.</p>\n"}, {"tags": ["arrays", "excel", "vba", "filter"], "comments": [{"owner": {"reputation": 182, "user_id": 4723652, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a83d76e4d118165936de6866d5f42004?s=128&d=identicon&r=PG&f=1", "display_name": "Techie", "link": "https://stackoverflow.com/users/4723652/techie"}, "edited": false, "score": 0, "creation_date": 1527699962, "post_id": 50609361, "comment_id": 88229856, "body": "just remove line   arrNom(i) = &quot;=&quot; &amp; arrNom(i) and try..."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 182, "user_id": 4723652, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a83d76e4d118165936de6866d5f42004?s=128&d=identicon&r=PG&f=1", "display_name": "Techie", "link": "https://stackoverflow.com/users/4723652/techie"}, "edited": false, "score": 0, "creation_date": 1527701245, "post_id": 50609361, "comment_id": 88230586, "body": "Do you intend to show one filter at a time? Or apply all values into filter? If former, then yes, as per @HA560, get rid of that line"}, {"owner": {"reputation": 1, "user_id": 9805960, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/645622ed2b4b0599f1bb4ea320dd263a?s=128&d=identicon&r=PG&f=1", "display_name": "JimmyCobblers", "link": "https://stackoverflow.com/users/9805960/jimmycobblers"}, "reply_to_user": {"reputation": 182, "user_id": 4723652, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a83d76e4d118165936de6866d5f42004?s=128&d=identicon&r=PG&f=1", "display_name": "Techie", "link": "https://stackoverflow.com/users/4723652/techie"}, "edited": false, "score": 0, "creation_date": 1527762989, "post_id": 50609361, "comment_id": 88254241, "body": "@HA560     Thanks for your replies. I managed to resolve it by adding wildcards.                                                                            arrNom(i) = &quot; * &quot; &amp; arrNom(i) &amp; &quot; * &quot;.                                                      I was incorrect in stating numeric values, I was looking for a string within a string. The macro recorder added the whole string inside &quot;...&quot;, I assumed I could add the values I need to filter by in them. Cheers."}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 9805960, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/645622ed2b4b0599f1bb4ea320dd263a?s=128&d=identicon&r=PG&f=1", "display_name": "JimmyCobblers", "link": "https://stackoverflow.com/users/9805960/jimmycobblers"}, "is_accepted": false, "score": 0, "last_activity_date": 1527763287, "creation_date": 1527763287, "answer_id": 50622406, "question_id": 50609361, "link": "https://stackoverflow.com/questions/50609361/autofilter-method-fails-when-trying-to-use-an-array-of-numeric-values/50622406#50622406", "title": "Autofilter method fails when trying to use an Array of Numeric Values", "body": "<p>I managed to resolve it by adding wildcards.                                                                            arrNom(i) = \" * \" &amp; arrNom(i) &amp; \" * \".<br>\nThe macro recorder added the whole string inside \"...\", I assumed I could add the values I need to filter by in them. </p>\n"}], "owner": {"reputation": 1, "user_id": 9805960, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/645622ed2b4b0599f1bb4ea320dd263a?s=128&d=identicon&r=PG&f=1", "display_name": "JimmyCobblers", "link": "https://stackoverflow.com/users/9805960/jimmycobblers"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 28, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1527763287, "creation_date": 1527697092, "last_edit_date": 1527703368, "question_id": 50609361, "link": "https://stackoverflow.com/questions/50609361/autofilter-method-fails-when-trying-to-use-an-array-of-numeric-values", "title": "Autofilter method fails when trying to use an Array of Numeric Values", "body": "<p>I would like to loop through an array of numeric values to use for Criteria1  parameter and display the filtered results. However, the filter returns nothing using my code below.\nCan anyone offer any advice? Cheers.</p>\n\n<pre><code>Sub test()\n\n    Dim arrNom() As Variant\n    Dim i As Integer\n\n    arrNom = Array   (\"693.715\", \"710.875\", \"722.55\", \"730.605\", \"732.75\", \"732.82\")\n\n    For i = LBound(arrNom) To UBound(arrNom)\n        arrNom(i) = \"=\" &amp; arrNom(i)\n        Sheet4.Range(\"A1\").AutoFilter _\n        Field:=1, _\n        Criteria1:=arrNom(i), _ \n        Operator:=xlFilterValues\n    Next i\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "algorithm", "excel", "matrix"], "comments": [{"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 0, "creation_date": 1527697696, "post_id": 50609317, "comment_id": 88228727, "body": "Just to be clear...you want to put the total in column <b>A</b> and the end-month in column <b>F</b> and want a method to automatically fill in columns <b>B</b> through <b>E</b> ??"}, {"owner": {"reputation": 33, "user_id": 9020702, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8523f6915360904d889e7342f9268254?s=128&d=identicon&r=PG&f=1", "display_name": "Rafael Pacheco", "link": "https://stackoverflow.com/users/9020702/rafael-pacheco"}, "reply_to_user": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 0, "creation_date": 1527700787, "post_id": 50609317, "comment_id": 88230345, "body": "@Gary&#39;sStudent That is correct! It shall respect the end-month, the hours in the line and the percentage of each month!"}], "answers": [{"tags": [], "owner": {"reputation": 30, "user_id": 8212208, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154850504861902/picture?type=large", "display_name": "tobifjellner", "link": "https://stackoverflow.com/users/8212208/tobifjellner"}, "is_accepted": false, "score": 0, "last_activity_date": 1527697280, "creation_date": 1527697280, "answer_id": 50609412, "question_id": 50609317, "link": "https://stackoverflow.com/questions/50609317/matricial-distribution/50609412#50609412", "title": "Matricial distribution", "body": "<p>I guess you need to think \"backwards\".\nFirst distribute hours among active projects in month <em>n</em> (December).\nDeduct these hours from respective project and move to month <em>n-1</em>, etc.</p>\n"}, {"comments": [{"owner": {"reputation": 33, "user_id": 9020702, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8523f6915360904d889e7342f9268254?s=128&d=identicon&r=PG&f=1", "display_name": "Rafael Pacheco", "link": "https://stackoverflow.com/users/9020702/rafael-pacheco"}, "edited": false, "score": 0, "creation_date": 1527859093, "post_id": 50627080, "comment_id": 88298991, "body": "Sorry if I couldn&#39;t managed to be clear. This is a calendarization of hours for projects, so the total hours are already set and needed to be distributed throughout the months, respecting the proportion of hours determined by the month and the end of the project. See the solution from @jblood94, those matricial formulas are magical."}, {"owner": {"reputation": 5229, "user_id": 5512705, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/OoYN6.png?s=128&g=1", "display_name": "Samuel Hulla", "link": "https://stackoverflow.com/users/5512705/samuel-hulla"}, "reply_to_user": {"reputation": 33, "user_id": 9020702, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8523f6915360904d889e7342f9268254?s=128&d=identicon&r=PG&f=1", "display_name": "Rafael Pacheco", "link": "https://stackoverflow.com/users/9020702/rafael-pacheco"}, "edited": false, "score": 0, "creation_date": 1527860347, "post_id": 50627080, "comment_id": 88299813, "body": "Hello, alright, albeit the solution by @jblood94 while elegant, will not work if you have to distribute the time unevenly (if the projects dont start at the same time, which seems like a realistic scenario with differnet projects). I tried being descriptive in my code with comments, so hopefully you should be able to tweak it to your needs. If the starting times are static, then more power to you and simply use jblood94&#39;s solution :)"}, {"owner": {"reputation": 33, "user_id": 9020702, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8523f6915360904d889e7342f9268254?s=128&d=identicon&r=PG&f=1", "display_name": "Rafael Pacheco", "link": "https://stackoverflow.com/users/9020702/rafael-pacheco"}, "edited": false, "score": 0, "creation_date": 1527865125, "post_id": 50627080, "comment_id": 88302863, "body": "At this point, all projects are starting the same month, but it&#39;s true what you said. I will study both your code and the @jblood94 formula to see if I can mix them together to achieve a final solution. Thanks again for your help!"}], "tags": [], "owner": {"reputation": 5229, "user_id": 5512705, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/OoYN6.png?s=128&g=1", "display_name": "Samuel Hulla", "link": "https://stackoverflow.com/users/5512705/samuel-hulla"}, "is_accepted": false, "score": 2, "last_activity_date": 1527778616, "last_edit_date": 1527778616, "creation_date": 1527778102, "answer_id": 50627080, "question_id": 50609317, "link": "https://stackoverflow.com/questions/50609317/matricial-distribution/50627080#50627080", "title": "Matricial distribution", "body": "<p>I'm not 100% sure I got your question right, but hopefully yes because it took me quite a lot of time. It actually looks deceptively easy, but is in fact quite tricky.</p>\n\n<p>So let's presume we have this table:</p>\n\n<p><a href=\"https://i.stack.imgur.com/wONHE.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/wONHE.png\" alt=\"enter image description here\"></a></p>\n\n<blockquote>\n  <p>Now if I got it right, we basically want to count, how many hours we\n  used up already, and now we want to distribute what we have left\n  depending on the unused (empty) months</p>\n</blockquote>\n\n<p>So, for example, in Row 3 (100 hours) we don't want to distribute any hours, because we already used up all 100 out of 100 hours</p>\n\n<p>In the next row (4), we want to distribute 115 hours (200-85) to the remaining 2 cells => which would leave us with 57.5 hours per month left on shift</p>\n\n<p>and et cetera...</p>\n\n<p>Under presumption, that's what you want the algorhytm to do:</p>\n\n<pre><code>Private Sub divide_time()\n\nDim tbl As ListObject: Set tbl = Sheets(\"Sheet1\").ListObjects(\"Table1\")\nDim hour_dist() As Integer\nReDim hour_dist(1 To 3)\n\n' first we need to learn how many hours total we have available per project\nFor i = 1 To 3\n    With tbl.ListColumns(1)\n        hour_dist(i) = .Range(i + 1) ' we store each value into an array per project\n    End With\nNext i\n\nDim current As Double\nDim sumof As Double\nDim hours_left As Double\nDim empty_counter As Integer\n\nFor i = 1 To 3\n\n    'we reset all of the counters per row\n    sumof = 0\n    empty_counter = 0\n\n    'looping through all the column values in the row\n    For j = 2 To 6\n        current = tbl.ListRows(1).Range(i, j)\n        sumof = sumof + current ' we get a sum of the current values in the row\n        If (current = 0) Then 'if there is an empty cell, we keep track of it _\n        (so we know into how many cells we can still divide the remaining time)\n            empty_counter = empty_counter + 1\n        End If\n    Next j\n\n    ' so we get how many hours we have left for the project _\n    in comparison to  how many  months are free to distribute\n    hours_left = (hour_dist(i) - sumof)\n\n    'if we also want to store the info, _ \n    'what month we ended on before we distribute the remaining hours\n    If (hours_left = 0) Then\n    Select Case empty_counter\n        Case 0\n            tbl.ListRows(1).Range(i, 7) = \"Dec\"\n        Case 1\n            tbl.ListRows(1).Range(i, 7) = \"Nov\"\n        Case 2\n            tbl.ListRows(1).Range(i, 7) = \"Oct\"\n        Case 3\n            tbl.ListRows(1).Range(i, 7) = \"Sep\"\n        Case 4\n            tbl.ListRows(1).Range(i, 7) = \"Aug\"\n    End Select\n    Else\n        tbl.ListRows(1).Range(i, 7) = \"Dec\"\n    End if\n\n    If (empty_counter &lt;&gt; 0) Then '( we dont want to be dividing by 0 )\n    For n = 6 To (6 - empty_counter + 1) Step -1\n\n        'for each month we divide what we have left _\n         depending on the % of the months available\n        tbl.ListRows(1).Range(i, n) = (hours_left / empty_counter)\n\n    Next n\n    End If\n\n\n\n' and we loop it for each and every row\nNext i\n\nEnd Sub\n</code></pre>\n\n<p>The resulting table will look like this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/ZBRPR.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ZBRPR.png\" alt=\"enter image description here\"></a></p>\n"}, {"comments": [{"owner": {"reputation": 33, "user_id": 9020702, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8523f6915360904d889e7342f9268254?s=128&d=identicon&r=PG&f=1", "display_name": "Rafael Pacheco", "link": "https://stackoverflow.com/users/9020702/rafael-pacheco"}, "edited": false, "score": 0, "creation_date": 1527858772, "post_id": 50630590, "comment_id": 88298791, "body": "you nailed it! That&#39;s exactly what I wanted, thanks a lot!  I&#39;ll study what you&#39;ve done here so I can improve my knowledges, I&#39;ve never used matricial formulas before.  Again, thanks a lot!"}], "tags": [], "owner": {"reputation": 1742, "user_id": 9463489, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "jblood94", "link": "https://stackoverflow.com/users/9463489/jblood94"}, "is_accepted": true, "score": 2, "last_activity_date": 1527791189, "creation_date": 1527791189, "answer_id": 50630590, "question_id": 50609317, "link": "https://stackoverflow.com/questions/50609317/matricial-distribution/50630590#50630590", "title": "Matricial distribution", "body": "<p>See the image below. Once you have the marginal sums filled in, enter this formula into B2 and fill in the rest of the table (enter it as an array formula with <kbd>ctrl</kbd>+<kbd>shift</kbd>+<kbd>enter</kbd>):</p>\n\n<pre><code>=IF(MATCH($H2,$B$1:$F$1,0)&lt;COLUMNS($B$1:B$1),0,($A2-SUM(C2:$G2))/(SUM(IF(MATCH($H$2:$H$4,$B$1:$F$1,0)&lt;COLUMNS($B$1:B$1),0,$A$2:$A$4))-SUM(IF(MATCH($H$2:$H$4,$B$1:$F$1,0)&lt;COLUMNS($B$1:B$1),0,C$2:$G$4)))*B$5)\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/NeVIl.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/NeVIl.png\" alt=\"enter image description here\"></a></p>\n\n<p>The example given will not have a unique solution, so the aim with the above formula is to <em>balance</em> the hours by starting at the end and moving backwards in time while applying hours proportionally to how many hours are left on each project. For example, after resolving Dec, the project on row 2 still has 200 hours to allocate and the project on row 3 still has 180 hours to allocate. The formula will therefore apply 120 * 200 / (200 + 180) hours in Nov from the project on row 2 and 120 * 180 / (200 + 180) hours from the project in row 3.</p>\n\n<p>This methodology assumes that all projects start at the same time. If this assumption doesn't hold, VBA would probably be the way to go. I would sort the months by the number of active projects, smallest to largest, then apply the same sort of calculation as here.</p>\n"}], "owner": {"reputation": 33, "user_id": 9020702, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8523f6915360904d889e7342f9268254?s=128&d=identicon&r=PG&f=1", "display_name": "Rafael Pacheco", "link": "https://stackoverflow.com/users/9020702/rafael-pacheco"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 64, "favorite_count": 1, "accepted_answer_id": 50630590, "answer_count": 3, "score": 3, "last_activity_date": 1528582559, "creation_date": 1527696924, "last_edit_date": 1528582559, "question_id": 50609317, "link": "https://stackoverflow.com/questions/50609317/matricial-distribution", "title": "Matricial distribution", "body": "<p>I have a list of projects with hours to be consumed, distributed linearly through the months:</p>\n\n<pre><code>Hours  Aug  Sep  Oct  Nov  Dec\n100    20   20   20   20   20\n200    40   40   40   40   40\n300    60   60   60   60   60\n\n600    120  120  120  120  120\n</code></pre>\n\n<p>Some projects will end in different months, so it shoudn't mark any hour in the next months (must be 0):</p>\n\n<pre><code>Hours  Aug    Sep    Oct    Nov   Dec  End\n100    33.3   33.3   33.3   0     0    Oct\n200    50     50     50     50    0    Nov\n300    60     60     60     60    60   Dec\n\n600    143.3  143.3  143.3  110   60\n</code></pre>\n\n<p>However, we have to keep the proportion of 20% of the sum (20% * 600 = 120. I've put 20% because we have 5 months, but it could be different percentages) on each month, so:</p>\n\n<pre><code>Hours  Aug    Sep    Oct    Nov   Dec  End\n100    20     30     50     0     0    Oct\n200    60     50     30     60    0    Nov\n300    40     40     40     60    120  Dec\n\n600    120    120    120    120   120\n</code></pre>\n\n<p>I have a Sudoku-like problem here, where I need to respect the proportion of the column and keep the sum of the line on each project. I've tried in many ways (VBA or functions) to make this distribution, but I've failed so far. I believe someone has crossed with this problem before, so is there a way of doing this distribution programatically? Is there a name for this kind of distribution?</p>\n"}, {"tags": ["excel", "vba", "import", "paste", "freeze"], "comments": [{"owner": {"reputation": 182, "user_id": 4723652, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a83d76e4d118165936de6866d5f42004?s=128&d=identicon&r=PG&f=1", "display_name": "Techie", "link": "https://stackoverflow.com/users/4723652/techie"}, "edited": false, "score": 0, "creation_date": 1527700341, "post_id": 50609237, "comment_id": 88230078, "body": "Hi @james code seems to be fine try closing other opened excel files and try."}, {"owner": {"reputation": 65, "user_id": 9866266, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a4980b147c78569022b5406d927ec0d9?s=128&d=identicon&r=PG&f=1", "display_name": "James", "link": "https://stackoverflow.com/users/9866266/james"}, "reply_to_user": {"reputation": 182, "user_id": 4723652, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a83d76e4d118165936de6866d5f42004?s=128&d=identicon&r=PG&f=1", "display_name": "Techie", "link": "https://stackoverflow.com/users/4723652/techie"}, "edited": false, "score": 0, "creation_date": 1527701635, "post_id": 50609237, "comment_id": 88230839, "body": "I created a new excel document and added this code to it then ran it and it still had errors with the ActiveSheet.PasteSpecial but the feezing/ clicking problems did disappear."}], "owner": {"reputation": 65, "user_id": 9866266, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a4980b147c78569022b5406d927ec0d9?s=128&d=identicon&r=PG&f=1", "display_name": "James", "link": "https://stackoverflow.com/users/9866266/james"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 37, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1527707921, "creation_date": 1527696628, "last_edit_date": 1527707921, "question_id": 50609237, "link": "https://stackoverflow.com/questions/50609237/importing-cell-data-from-other-excel-documents", "title": "Importing cell data from other excel documents", "body": "<p>I am trying to create a macro which takes horizontal data from ImportTestFile and pastes it into another file vertically using the new files format. The data in ImportTestFile may become longer as it is updated (which is why I used the count). </p>\n\n<p>My problem is that I get an error whenever I use Paste special, and when I just use ActiveSheet.Paste the excel file i'm importing into it stops allowing me to click on cells. \nEventually, I want to copy multiple lines of data from ImportTestFile but for now i'm just trying to get one line right first. </p>\n\n<p>ImportTestFile is 2.3Mb, if you think that is the reason for the clicking problems do you know a way I could still import data from it without this problem occurring?</p>\n\n<pre><code>Sub copydata()\nDim erow, eColumn As Long, rowUsed As Long, lastcolumn As Long, firstColumn As Long\nDim managerName, managerLetter, fileName, fileLocation, fileType As String\n\nWorkbooks.Open fileName:=\"/Users/james/Desktop/ImportTestFile.xlsx\"\nWorksheets(1).Select\nrowUsed = 28\nfirstColumn = 4\nlastcolumn = ActiveSheet.Cells(28, Columns.Count).End(xlToLeft).Column\nRange(Cells(rowUsed, firstColumn), Cells(rowUsed, lastcolumn)).Copy\nActiveWorkbook.Close\n\nWorksheets(1).Select\nCells(1, 1).Select\nActiveSheet.PasteSpecial Paste:=xlPasteValues, Transpose:=True\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1527696483, "post_id": 50609112, "comment_id": 88228065, "body": "The VBA trigger would most likely need to be a Change Event.  The combo box itself could be made wiht a data-validation list (using a named range or actual range reference), and the change event triggers as such."}, {"owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "edited": false, "score": 0, "creation_date": 1527696498, "post_id": 50609112, "comment_id": 88228073, "body": "Are you referring to a dataValidation dropdown? or what kind of ComboBox are you using?"}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1527696569, "post_id": 50609112, "comment_id": 88228112, "body": "Here is how to set data-validation ranges with vba: <a href=\"https://stackoverflow.com/questions/36357337/update-data-validation-list-range\" title=\"update data validation list range\">stackoverflow.com/questions/36357337/&hellip;</a>"}, {"owner": {"reputation": 165, "user_id": 7346117, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-CXzhSH-pYtI/AAAAAAAAAAI/AAAAAAAAAMs/pUmsWxBdBNk/photo.jpg?sz=128", "display_name": "Mikael Kajander", "link": "https://stackoverflow.com/users/7346117/mikael-kajander"}, "edited": false, "score": 0, "creation_date": 1527698983, "post_id": 50609112, "comment_id": 88229382, "body": "Try wsTarget.ComboBox1.Value = &quot;No&quot; and so on. You will probably be better off by looping through all the comboboxes in the sheet and setting their values with this method. <code>For each ctrl in wsTarger.OLEObjects</code> and <code>ctrl.Name</code> might do the trick."}, {"owner": {"reputation": 3, "user_id": 9871331, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e0cd451496d3e4e3fe2c44d902e2e84?s=128&d=identicon&r=PG&f=1", "display_name": "Fammerjammer", "link": "https://stackoverflow.com/users/9871331/fammerjammer"}, "reply_to_user": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "edited": false, "score": 0, "creation_date": 1527772499, "post_id": 50609112, "comment_id": 88260368, "body": "@Davesexcel I believe it is an ActiveX Control ComboBox"}, {"owner": {"reputation": 3, "user_id": 9871331, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e0cd451496d3e4e3fe2c44d902e2e84?s=128&d=identicon&r=PG&f=1", "display_name": "Fammerjammer", "link": "https://stackoverflow.com/users/9871331/fammerjammer"}, "reply_to_user": {"reputation": 165, "user_id": 7346117, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-CXzhSH-pYtI/AAAAAAAAAAI/AAAAAAAAAMs/pUmsWxBdBNk/photo.jpg?sz=128", "display_name": "Mikael Kajander", "link": "https://stackoverflow.com/users/7346117/mikael-kajander"}, "edited": false, "score": 0, "creation_date": 1527772646, "post_id": 50609112, "comment_id": 88260476, "body": "@MikaelKajander wsTarget.OLEObjects(&quot;ComboBox1&quot;).Object.Value did not create any error but did not change the value of the ComboBox either. Any other idea? Thanks!"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 9871331, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e0cd451496d3e4e3fe2c44d902e2e84?s=128&d=identicon&r=PG&f=1", "display_name": "Fammerjammer", "link": "https://stackoverflow.com/users/9871331/fammerjammer"}, "edited": false, "score": 0, "creation_date": 1527779278, "post_id": 50625752, "comment_id": 88264896, "body": "The calculation is based on the value in the ComboBox, and a report is created based on the output of the calc. It appears that the value in the ComboBox is updated now and so the calculation is actually correct using the correct input. BUT, when the PDF report is populated, it shows the initial value in the ComboBox, not the desired correct new input. And I see the ComboBox value is changed to the correct input AFTER the PDF is populated. This creates a problem as I have the correct outputs but misleading inputs in my reports. Thanks for the Help!"}, {"owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "reply_to_user": {"reputation": 3, "user_id": 9871331, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e0cd451496d3e4e3fe2c44d902e2e84?s=128&d=identicon&r=PG&f=1", "display_name": "Fammerjammer", "link": "https://stackoverflow.com/users/9871331/fammerjammer"}, "edited": false, "score": 0, "creation_date": 1527781265, "post_id": 50625752, "comment_id": 88266159, "body": "Could you edit your question with these added details"}], "tags": [], "owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "is_accepted": false, "score": 0, "last_activity_date": 1527774107, "creation_date": 1527774107, "answer_id": 50625752, "question_id": 50609112, "link": "https://stackoverflow.com/questions/50609112/excel-vba-how-can-i-change-the-value-in-combobox-before-populating-pdf-view-de/50625752#50625752", "title": "Excel VBA: how can I change the value in ComboBox before populating PDF (view detail)", "body": "<p>This does not work for me.....</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n    Dim sh As Worksheet\n    Set sh = Sheets(\"Sheet1\")\n    sh.ComboBox1.Value = \"Run\"\n\nEnd Sub\n</code></pre>\n\n<p>But this does work for me...</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n\n    Sheets(\"Sheet1\").ComboBox1.Value = \"Run\"\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 9871331, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e0cd451496d3e4e3fe2c44d902e2e84?s=128&d=identicon&r=PG&f=1", "display_name": "Fammerjammer", "link": "https://stackoverflow.com/users/9871331/fammerjammer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 154, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1527781778, "creation_date": 1527696206, "last_edit_date": 1527781778, "question_id": 50609112, "link": "https://stackoverflow.com/questions/50609112/excel-vba-how-can-i-change-the-value-in-combobox-before-populating-pdf-view-de", "title": "Excel VBA: how can I change the value in ComboBox before populating PDF (view detail)", "body": "<p>I am trying to build an automation tool to read inputs from a master data file with numerous cases, and for each case, do the necessary calculations and produce a report. </p>\n\n<p>But, there are a few ComboBox in the input fields.</p>\n\n<p>The calculation is based on the value in the ComboBox, and a report is created based on the output of the calc. It appears that the value in the ComboBox is updated now and so the calculation is actually correct using the correct input. BUT, when the PDF report is populated, it shows the initial value in the ComboBox, not the desired correct new input. And I see the ComboBox value is changed to the correct input AFTER the PDF is populated. This creates a problem as I have the correct outputs but misleading inputs in my reports. Is there any way I can have the value in the ComboBox changed BEFORE the PDF is populated?</p>\n\n<pre><code>Sheet7.ComboBox1.Value = \"No\"\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 83, "user_id": 4979388, "user_type": "registered", "accept_rate": 40, "profile_image": "https://lh5.googleusercontent.com/-l_C1h9b2Z24/AAAAAAAAAAI/AAAAAAAAAS8/BeoTzgvpZIc/photo.jpg?sz=128", "display_name": "Adam", "link": "https://stackoverflow.com/users/4979388/adam"}, "edited": false, "score": 0, "creation_date": 1527696177, "post_id": 50608955, "comment_id": 88227871, "body": "Wow, this Is really great. It works perfect.  Thank you so much!"}, {"owner": {"reputation": 83, "user_id": 4979388, "user_type": "registered", "accept_rate": 40, "profile_image": "https://lh5.googleusercontent.com/-l_C1h9b2Z24/AAAAAAAAAAI/AAAAAAAAAS8/BeoTzgvpZIc/photo.jpg?sz=128", "display_name": "Adam", "link": "https://stackoverflow.com/users/4979388/adam"}, "edited": false, "score": 0, "creation_date": 1527696264, "post_id": 50608955, "comment_id": 88227932, "body": "quick question, is there a way to specify column AA instead of (cll.row, 27)  for example? Just curious. thank you!"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 83, "user_id": 4979388, "user_type": "registered", "accept_rate": 40, "profile_image": "https://lh5.googleusercontent.com/-l_C1h9b2Z24/AAAAAAAAAAI/AAAAAAAAAS8/BeoTzgvpZIc/photo.jpg?sz=128", "display_name": "Adam", "link": "https://stackoverflow.com/users/4979388/adam"}, "edited": false, "score": 0, "creation_date": 1527698676, "post_id": 50608955, "comment_id": 88229231, "body": "You can write some user defined function, which reads <code>AA</code>, converts it to a string, reads it char-by-char, coverts it to a number with <code>ACS()</code> and returns the sum. Thus <code>ACS(&quot;A&quot;)</code> is <code>65</code>, but you are going to remove 64, thus it would be <code>1</code>. Give it a try!"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 2, "creation_date": 1527702486, "post_id": 50608955, "comment_id": 88231282, "body": "@Vityata - maybe I&#39;m misunderstanding, but couldn&#39;t OP just use <code>Cells(cll.Row, &quot;AA&quot;)</code> - i.e. the column index can be a number or string?"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 83, "user_id": 4979388, "user_type": "registered", "accept_rate": 40, "profile_image": "https://lh5.googleusercontent.com/-l_C1h9b2Z24/AAAAAAAAAAI/AAAAAAAAAS8/BeoTzgvpZIc/photo.jpg?sz=128", "display_name": "Adam", "link": "https://stackoverflow.com/users/4979388/adam"}, "edited": false, "score": 1, "creation_date": 1527702595, "post_id": 50608955, "comment_id": 88231338, "body": "@Adam - take a look at the comment above."}, {"owner": {"reputation": 83, "user_id": 4979388, "user_type": "registered", "accept_rate": 40, "profile_image": "https://lh5.googleusercontent.com/-l_C1h9b2Z24/AAAAAAAAAAI/AAAAAAAAAS8/BeoTzgvpZIc/photo.jpg?sz=128", "display_name": "Adam", "link": "https://stackoverflow.com/users/4979388/adam"}, "edited": false, "score": 1, "creation_date": 1527712887, "post_id": 50608955, "comment_id": 88235997, "body": "&quot;AA&quot; worked. Thank you both for being rockstars, very very much appreciated!"}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 2, "last_activity_date": 1527695649, "creation_date": 1527695649, "answer_id": 50608955, "question_id": 50608845, "link": "https://stackoverflow.com/questions/50608845/vba-macro-to-extract-hyperlink-from-one-cell-to-another/50608955#50608955", "title": "VBA macro to extract Hyperlink from one cell to another", "body": "<p><code>Select Case</code> can improve your code. Just make sure that you fix the Magic Numbers within as you wish:</p>\n\n<pre><code>Sub Hyper()\n    Dim sht As Worksheet: Set sht = Worksheets(\"Sheet1\")\n    Dim cll As Range\n    For Each cll In sht.Range(\"B2:H2000\")\n        If cll.Hyperlinks.Count &gt; 0 Then\n            Select Case cll.Column\n\n            Case Range(\"A1\").Column:\n                sht.Cells(cll.Row, 15).Value = cll.Hyperlinks(1).Address\n            Case Range(\"E1\").Column\n                sht.Cells(cll.Row, 20).Value = cll.Hyperlinks(1).Address\n            Case Range(\"G1\").Column\n                sht.Cells(cll.Row, 25).Value = cll.Hyperlinks(1).Address\n\n            End Select\n        End If\n    Next cll\n    MsgBox \"The macro has completed running\"\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 83, "user_id": 4979388, "user_type": "registered", "accept_rate": 40, "profile_image": "https://lh5.googleusercontent.com/-l_C1h9b2Z24/AAAAAAAAAAI/AAAAAAAAAS8/BeoTzgvpZIc/photo.jpg?sz=128", "display_name": "Adam", "link": "https://stackoverflow.com/users/4979388/adam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2796, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1527695649, "creation_date": 1527695214, "question_id": 50608845, "link": "https://stackoverflow.com/questions/50608845/vba-macro-to-extract-hyperlink-from-one-cell-to-another", "title": "VBA macro to extract Hyperlink from one cell to another", "body": "<p>I have the following code that extracts a hyperlink from a cell and then moves it to an adjacent cell. My goal is to be able to specify multiple columns and the exact column the cells should move to.</p>\n\n<p>As you can see, the code is taking the hyperlink value from columns B1 to B2000 and copying the hyperlink value to column C (cll.Column + 1), but I would like to specify the exact column I want to copy the hyperlink to. </p>\n\n<p>For example: I want all hyperlinks to copy from B to G; D to F; and E to H. </p>\n\n<pre><code>Sub hyper()\n Dim sht As Worksheet: Set sht = Worksheets(\"Sheet1\")\n Dim cll As Range\n For Each cll In sht.Range(\"B2:B2000\")\n If cll.Hyperlinks.Count &gt; 0 Then\n     sht.Cells(cll.Row, cll.Column + 1).Value = cll.Hyperlinks(1).Address\n End If\n   Next cll\n msgbox \"The macro has completed running\"\n End Sub\n</code></pre>\n\n<p>I don't much about VBA macros so any help is appreciated.  Thank you very much!\n~Adam</p>\n"}, {"tags": ["oracle", "excel", "adodb", "vba"], "comments": [{"owner": {"reputation": 38299, "user_id": 3027266, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3249486ec6096e443cb8e93489fe0a09?s=128&d=identicon&r=PG&f=1", "display_name": "Wernfried Domscheit", "link": "https://stackoverflow.com/users/3027266/wernfried-domscheit"}, "edited": false, "score": 0, "creation_date": 1527700273, "post_id": 50608728, "comment_id": 88230035, "body": "That&#39;s no problem. Do you have an example with IN parameter? btw, you may prefer to write a <code>FUNCTION</code> rather than a <code>PROCEDURE</code>."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 9871215, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/288b67ac387d86ae2dd10033e629ad24?s=128&d=identicon&r=PG&f=1", "display_name": "dan", "link": "https://stackoverflow.com/users/9871215/dan"}, "edited": false, "score": 0, "creation_date": 1527787274, "post_id": 50619562, "comment_id": 88269209, "body": "Thanks. I figured it out. I had forgotten the prefix/alias in my stored procedure name when calling it Prefix.stored_proc_name and once the prefix was added it worked fine. The VBA code I use to call the stored procedure, coincidentally is almost exactly as the code in your post. Thank you so much for your reply. Hopefully, this code will help another. Also, thanks for the links."}], "tags": [], "owner": {"reputation": 38299, "user_id": 3027266, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3249486ec6096e443cb8e93489fe0a09?s=128&d=identicon&r=PG&f=1", "display_name": "Wernfried Domscheit", "link": "https://stackoverflow.com/users/3027266/wernfried-domscheit"}, "is_accepted": true, "score": 0, "last_activity_date": 1527753930, "creation_date": 1527753930, "answer_id": 50619562, "question_id": 50608728, "link": "https://stackoverflow.com/questions/50608728/calling-an-oracle-stored-procedure-with-no-parameters-adodb/50619562#50619562", "title": "Calling an oracle stored procedure with no parameters ADODB", "body": "<p>Transform your procedure to a function:</p>\n\n<pre><code>CREATE OR REPLACE FUNCTION Get_Data RETURN SYS_REFCURSOR IS\nres SYS_REFCURSOR;\n\nBEGIN\n\nOPEN OUTPUT FOR \nSELECT DISTINCT\n       B.ITEM_ID\n       B.ITEM_DESC\n    FROM ITEM_FILE B\nWHERE ITEM_ID IS NOT NULL\nORDER BY B.ITEM_ID;  \nRETURN res;\n\nEND Get_Data;\n/\n</code></pre>\n\n<p>Call in VBA would be as this:</p>\n\n<pre><code>cmd.CommandText = \"{CALL Get_Data()}\"\ncmd.Properties(\"PLSQLRSet\") = True\nSet Rst1 = cmd.Execute \ncmd.Properties(\"PLSQLRSet\") = False\n</code></pre>\n\n<p>Note, by default an OUT parameters are used like this:</p>\n\n<pre><code>cmd.Parameters.Append cmd.CreateParameter(\"OUTPUT\", adVarChar, adParamOutput, 100)\n</code></pre>\n\n<p>However, for RefCursor parameters you must not declare them with <code>cmd.Parameters.Append</code>.</p>\n\n<p>Have a look at <a href=\"https://docs.oracle.com/database/121/OLEDB/using.htm#OLEDB003\" rel=\"nofollow noreferrer\">Provider for OLE DB Developer's Guide</a>, it contains several examples. Chapter <a href=\"https://docs.oracle.com/database/121/OLEDB/using.htm#sthref132\" rel=\"nofollow noreferrer\">Stored Procedures and Functions Returning Rowsets</a> should be the most relevant for you.</p>\n"}], "owner": {"reputation": 3, "user_id": 9871215, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/288b67ac387d86ae2dd10033e629ad24?s=128&d=identicon&r=PG&f=1", "display_name": "dan", "link": "https://stackoverflow.com/users/9871215/dan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 418, "favorite_count": 0, "accepted_answer_id": 50619562, "answer_count": 1, "score": 0, "last_activity_date": 1527753930, "creation_date": 1527694866, "last_edit_date": 1531164843, "question_id": 50608728, "link": "https://stackoverflow.com/questions/50608728/calling-an-oracle-stored-procedure-with-no-parameters-adodb", "title": "Calling an oracle stored procedure with no parameters ADODB", "body": "<p>I have not found anywhere on how to call an Oracle stored procedure using ADODB from Excel where the stored procedure has no input parameters. </p>\n\n<p>Fake example to illustrate lack of input parameters: </p>\n\n<pre><code>CREATE OR REPLACE PROCEDURE Get_Data\n(OUTPUT OUT SYS_REFCURSOR) IS\n\n******************************************************************************/\nBEGIN\n\nOPEN OUTPUT FOR \n\nSELECT DISTINCT\n       B.ITEM_ID\n       B.ITEM_DESC\n    FROM ITEM_FILE B\nWHERE ITEM_ID IS NOT NULL\n ORDER BY B.ITEM_ID\n; \n\nEND Get_Data;\n/\n</code></pre>\n\n<p>Oh, and the stored procedure is required because we don't want to give users SQL access to create whatever SQL they want.</p>\n\n<p>Is this even possible? And if so, what kind of code would it take to call it?</p>\n\n<p>Thanks,\nDan</p>\n"}, {"tags": ["vba", "excel", "office365", "pivot-table"], "comments": [{"owner": {"reputation": 4047, "user_id": 3246362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6da9a197d0f0e5f19875d8a97550e58e?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/3246362/sam"}, "edited": false, "score": 0, "creation_date": 1527694964, "post_id": 50608641, "comment_id": 88227161, "body": "That is way too much code to look through! Do you have same input in your different versions? What about date and number formats?"}, {"owner": {"reputation": 113, "user_id": 6525460, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-TtuRYZl-wt8/AAAAAAAAAAI/AAAAAAAAABI/LGJ7UM8bIIw/photo.jpg?sz=128", "display_name": "Myriam Diaz Martinez", "link": "https://stackoverflow.com/users/6525460/myriam-diaz-martinez"}, "reply_to_user": {"reputation": 4047, "user_id": 3246362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6da9a197d0f0e5f19875d8a97550e58e?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/3246362/sam"}, "edited": false, "score": 0, "creation_date": 1527700627, "post_id": 50608641, "comment_id": 88230256, "body": "Sam, I cut the code down to the part where I apply the Pivot Table Code. I have the same input in both in Mac 365 and Professional Pro. I only have number formats but I don&#39;t understand the connection..."}, {"owner": {"reputation": 4047, "user_id": 3246362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6da9a197d0f0e5f19875d8a97550e58e?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/3246362/sam"}, "edited": false, "score": 1, "creation_date": 1527701227, "post_id": 50608641, "comment_id": 88230577, "body": "The first thing to do is to remove the <code>On Error Resume Next</code>. That statement tells VBA to ignore all errors - which is exactly what you don&#39;t want."}, {"owner": {"reputation": 113, "user_id": 6525460, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-TtuRYZl-wt8/AAAAAAAAAAI/AAAAAAAAABI/LGJ7UM8bIIw/photo.jpg?sz=128", "display_name": "Myriam Diaz Martinez", "link": "https://stackoverflow.com/users/6525460/myriam-diaz-martinez"}, "reply_to_user": {"reputation": 4047, "user_id": 3246362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6da9a197d0f0e5f19875d8a97550e58e?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/3246362/sam"}, "edited": false, "score": 0, "creation_date": 1527702638, "post_id": 50608641, "comment_id": 88231363, "body": "Now I get another error [Run-time error &#39;1004&#39;: Application-defined or object defined error] on the loop  <code>If Worksheets(1).Cells(x, 13) = &quot;&quot; Then     Worksheets(1).Cells(x, 18) = &quot;(blank)&quot;     ElseIf (Worksheets(1).Cells(x, 13) &gt;= 0 And Worksheets(1).Cells(x, 13) &lt;= 9) Then     Worksheets(1).Cells(x, 18) = &quot;0-9&quot;     ElseIf (Worksheets(1).Cells(x, 13) &gt;= 10 And Worksheets(1).Cells(x, 13) &lt;= 19) Then     Worksheets(1).Cells(x, 18) = &quot;10-19&quot;          End If Next x</code>"}, {"owner": {"reputation": 4047, "user_id": 3246362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6da9a197d0f0e5f19875d8a97550e58e?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/3246362/sam"}, "edited": false, "score": 0, "creation_date": 1527703090, "post_id": 50608641, "comment_id": 88231587, "body": "Please work in your code in your question - it is not easy to read code in comments. After that - check the value of x. Is it perhaps 0?"}, {"owner": {"reputation": 113, "user_id": 6525460, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-TtuRYZl-wt8/AAAAAAAAAAI/AAAAAAAAABI/LGJ7UM8bIIw/photo.jpg?sz=128", "display_name": "Myriam Diaz Martinez", "link": "https://stackoverflow.com/users/6525460/myriam-diaz-martinez"}, "reply_to_user": {"reputation": 4047, "user_id": 3246362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6da9a197d0f0e5f19875d8a97550e58e?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/3246362/sam"}, "edited": false, "score": 0, "creation_date": 1527704062, "post_id": 50608641, "comment_id": 88232062, "body": "The value of x = 2 and I declare the Dim as Long."}], "owner": {"reputation": 113, "user_id": 6525460, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-TtuRYZl-wt8/AAAAAAAAAAI/AAAAAAAAABI/LGJ7UM8bIIw/photo.jpg?sz=128", "display_name": "Myriam Diaz Martinez", "link": "https://stackoverflow.com/users/6525460/myriam-diaz-martinez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 337, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1527700674, "creation_date": 1527694631, "last_edit_date": 1531164843, "question_id": 50608641, "link": "https://stackoverflow.com/questions/50608641/vba-code-to-create-pivot-tables-works-on-excel-365-mac-but-not-on-excel-profes", "title": "VBA code to create Pivot Tables works on Excel 365 [Mac] but not on Excel Professional Pro Suite [PC]", "body": "<p>I am having a difficulty trying to get my code to work on the Excel Professional Pro for PC. I have changed a lot of the settings regarding the compatibility of the code between 365 and Professional Pro and have learned that the 365 automatically updates while the Professional Pro doesn't. Also, the weirdest thing is that I developed a code similar to the one below and it works. I have saved the workbook as Excel Enabled-Macro Workbook as well as Excel Enabled-Macro Template. I have no idea what to do. Please help. The code works as a button [Not an ActiveX button].</p>\n\n<pre><code>Sub Button1_Click()\n\n'Declare Variables\nDim PSheet As Worksheet\nDim DSheet As Worksheet\nDim PCache As PivotCache\nDim PTable As PivotTable\nDim PRange As Range\nDim LastRow As Long\nDim LastCol As Long\n\n\n'Insert a New Blank Worksheet\nOn Error Resume Next\nApplication.DisplayAlerts = False\nWorksheets(\"US MASTER\").Delete\nSheets.Add Before:=ActiveSheet\nActiveSheet.Name = \"US MASTER\"\nApplication.DisplayAlerts = True\nSet PSheet = Worksheets(\"US MASTER\")\nSet DSheet = Worksheets(\"US Master Macro\")\n\n'Define Data Range\nLastRow = DSheet.Cells(Rows.Count, 1).End(xlUp).Row\nLastCol = DSheet.Cells(1, Columns.Count).End(xlToLeft).Column\nSet PRange = DSheet.Cells(1, 1).Resize(LastRow, LastCol)\n\n'\n'Pivot Table 1\n'\n\n'Define Pivot Cache\nSet PCache = ActiveWorkbook.PivotCaches.Create _\n(SourceType:=xlDatabase, SourceData:=PRange, Version:=xlPivotTableVersion14). _\nCreatePivotTable(TableDestination:=PSheet.Range(\"B3\"), _\nTableName:=\"Total Backlog\", DefaultVersion:=xlPivotTableVersion14)\n\n'Insert Blank Pivot Table\nSet PTable = PCache.CreatePivotTable _\n(TableDestination:=PSheet.Range(\"B3\"), TableName:=\"Total Backlog\")\n\n'Add PR ID to Values Field\nWith PSheet.PivotTables(\"Total Backlog\").PivotFields(\"PR ID\")\n.Orientation = xlDataField\n.Function = xlCount\n.Position = 1\nEnd With\n\n'Add Classified Cases in Ranges to Row Field\nPSheet.PivotTables(\"Total Backlog\").AddFields _\nRowFields:=Array(\"Classified Cases in Ranges\")\n\n'Sort Pivot Table\nWith PSheet\n.Range(\"C4:C100\").Sort Key1:=.Range(\"C4\"), Order1:=xlDescending, Header:=xlNo\nEnd With\n\n'Add Total Backlog\nPSheet.Range(\"B2\").Value = \"Total Backlog\"\nPSheet.Range(\"B3\").Value = \"Days\"\n'Color\nPSheet.Range(\"B2\").Interior.ColorIndex = 4\n'Merge\nPSheet.Range(\"B2:C2\").Merge\n\n'Change the Color\nPSheet.Range(\"B3\").Interior.ColorIndex = 4\nPSheet.Range(\"C3\").Interior.ColorIndex = 4\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["regex", "excel", "vba"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1527695090, "post_id": 50608455, "comment_id": 88227244, "body": "So from the above sample; what data exactly are you expecting back? Can you show (not only describe) please?"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1527695203, "post_id": 50608455, "comment_id": 88227308, "body": "Please <a href=\"https://stackoverflow.com/posts/50608455/edit\">edit</a> into question. Regex it is really important to know layout and exactly what characters are involved e.g. are there newlines?"}, {"owner": {"reputation": 53, "user_id": 5811206, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5fbd6c98d17acbb836a6ed257f0d4c94?s=128&d=identicon&r=PG&f=1", "display_name": "tsuimark", "link": "https://stackoverflow.com/users/5811206/tsuimark"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1527695344, "post_id": 50608455, "comment_id": 88227402, "body": "the tables can be any number of rows, from 1 to 30,000+ there are new lines at the end of each row."}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1527695959, "post_id": 50608455, "comment_id": 88227748, "body": "Why not just loop through the range, and delete the rows that start with a dash?"}, {"owner": {"reputation": 53, "user_id": 5811206, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5fbd6c98d17acbb836a6ed257f0d4c94?s=128&d=identicon&r=PG&f=1", "display_name": "tsuimark", "link": "https://stackoverflow.com/users/5811206/tsuimark"}, "edited": false, "score": 0, "creation_date": 1527697264, "post_id": 50608455, "comment_id": 88228514, "body": "Hi Ron, started out that way but it wasn&#39;t very scalable as I&#39;m also doing several other operations on the data so it&#39;s getting populated into an array which is more efficient. It&#39;s obviously easier to get the data into the array after removing the dash rows and header/ footer sections"}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1527710010, "post_id": 50608455, "comment_id": 88234836, "body": "It&#39;s not clear to me what you want to do.  But to create a VBA array consisting of your desired data, you merely need to: Populate array1 in single step:  <code>array1 = range</code>: Loop through <code>array1</code> and only populate <code>array2</code> with lines that start with a <code>pipe</code>. Do your array work on <code>array2</code>."}], "answers": [{"comments": [{"owner": {"reputation": 53, "user_id": 5811206, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5fbd6c98d17acbb836a6ed257f0d4c94?s=128&d=identicon&r=PG&f=1", "display_name": "tsuimark", "link": "https://stackoverflow.com/users/5811206/tsuimark"}, "edited": false, "score": 0, "creation_date": 1527695517, "post_id": 50608848, "comment_id": 88227515, "body": "we have been pasting directly into excel but there is some formatting and tiding up to do to make the data useful. I thought creating a right click menu entry and handing the clean up with a macro might make our lives easier."}], "tags": [], "owner": {"reputation": 182, "user_id": 4723652, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a83d76e4d118165936de6866d5f42004?s=128&d=identicon&r=PG&f=1", "display_name": "Techie", "link": "https://stackoverflow.com/users/4723652/techie"}, "is_accepted": false, "score": 0, "last_activity_date": 1527695222, "creation_date": 1527695222, "answer_id": 50608848, "question_id": 50608455, "link": "https://stackoverflow.com/questions/50608455/excel-vba-use-regex-to-return-information-between-indicators/50608848#50608848", "title": "excel vba - use regex to return information between indicators", "body": "<p>Hi @tsuimark have you treid copying Clipboard data to directly to excel.?\ntried and attched screenshot. and remove unwanted rows in sheet.</p>\n\n<p>Thanks.</p>\n\n<p><a href=\"https://i.stack.imgur.com/7IuFg.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/7IuFg.png\" alt=\"enter image description here\"></a></p>\n"}, {"comments": [{"owner": {"reputation": 53, "user_id": 5811206, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5fbd6c98d17acbb836a6ed257f0d4c94?s=128&d=identicon&r=PG&f=1", "display_name": "tsuimark", "link": "https://stackoverflow.com/users/5811206/tsuimark"}, "edited": false, "score": 0, "creation_date": 1527762835, "post_id": 50612778, "comment_id": 88254156, "body": "I went with loading the data into a string variable and parsing that into an array as there can be over 300K rows of data so I wanted to keep read/writing to the spreadsheet to a minimum. hence stripping off the unwanted parts of the string to make it easier to work with."}], "tags": [], "owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "is_accepted": true, "score": 0, "last_activity_date": 1527711545, "creation_date": 1527711545, "answer_id": 50612778, "question_id": 50608455, "link": "https://stackoverflow.com/questions/50608455/excel-vba-use-regex-to-return-information-between-indicators/50612778#50612778", "title": "excel vba - use regex to return information between indicators", "body": "<p>To answer your question, for a regex that will take your text as a block (multi-line variable) and only return the desired lines, try:</p>\n\n<pre><code>^(?:(?:(?:(?=-).)+)|(?:[^|]+))\\n?\n</code></pre>\n\n<p>There may be better ways to accomplish your overall goal, but this accomplishes what you requested.</p>\n\n<pre><code>Option Explicit\nFunction PipedLines(S As String)\n    Dim RE As Object\n    Const sPat As String = \"^(?:(?:(?:(?=-).)+)|(?:[^|]+))\\n?\"\n\n    Set RE = CreateObject(\"vbscript.regexp\")\n    With RE\n        .Global = True\n        .MultiLine = True\n        .Pattern = sPat\n        PipedLines = .Replace(S, \"\")\n    End With\nEnd Function\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/aW3X8.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/aW3X8.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 53, "user_id": 5811206, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5fbd6c98d17acbb836a6ed257f0d4c94?s=128&d=identicon&r=PG&f=1", "display_name": "tsuimark", "link": "https://stackoverflow.com/users/5811206/tsuimark"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 41, "favorite_count": 1, "accepted_answer_id": 50612778, "answer_count": 2, "score": 1, "last_activity_date": 1527711545, "creation_date": 1527694103, "last_edit_date": 1527695419, "question_id": 50608455, "link": "https://stackoverflow.com/questions/50608455/excel-vba-use-regex-to-return-information-between-indicators", "title": "excel vba - use regex to return information between indicators", "body": "<p>I have an app which returns data in the form of a table copied into the clipboard. </p>\n\n<p>the table takes the form of:</p>\n\n<pre>\ntable name\nother info\n-------------------------------\n|heading 1|heading 2|heading 3|\n-------------------------------\n|data|date|other Data|\n|data|date|other Data|\n-------------------------------\ntime stamp\netc\n</pre>\n\n<p>I'm looking to pull back only the heading and data rows, minus the horizontal rows which are represented by dashes (---) in my data.\nI need the pipes (|) as they are used to split the rows for passing back to excel.</p>\n\n<p>I've used the following regex attempts</p>\n\n<pre><code>strPattern = \"(?&lt;=\\|)[^|]++(?=\\|)\"\nstrPattern = \"(\\|[^|]++(\\|)\"\nstrPattern = \"(^\\s\\|[\\d\\D]+?\\|\\s$)\"\nstrPattern = \"(^\\s\\|[\\d\\D]*\\|\\s$)\"\nstrReplace = \"$1\"\n</code></pre>\n\n<p>thinking that the above uses the pipes as bookends and returns any digit or non digit character between the pipes. none of these work and at best it returns the entire string (I know I don't have anything removing the dashes yet) </p>\n\n<p>looking for:</p>\n\n<pre>\n|heading 1|heading 2|heading 3|\n|data|date|other Data|\n|data|date|other Data|\n</pre>\n\n<p>Thanks in advance for any help</p>\n"}, {"tags": ["vba", "excel", "export-to-csv"], "comments": [{"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1527697055, "post_id": 50608425, "comment_id": 88228388, "body": "Remove WorkRng and replace with your defined range.  Your second question is kind of confusing... you want a CSV file saved, then add the CSV file to an XLSX/XLSM/XLSB file?  Looks like you&#39;re already saving to the same file extension."}], "answers": [{"tags": [], "owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "is_accepted": false, "score": 1, "last_activity_date": 1527697397, "creation_date": 1527697397, "answer_id": 50609451, "question_id": 50608425, "link": "https://stackoverflow.com/questions/50608425/api-put-in-vba-exporting-a-csv-from-range-of-cells-microsoft-excel/50609451#50609451", "title": "API PUT in VBA, exporting a CSV from range of cells (Microsoft Excel)", "body": "<p>To build on my comment: </p>\n\n<pre><code>Sub ExportRangetoFile()\n'Update 20150628\n    Dim Rng As Range, s_row as long, s_col as long, e_row as long e_col as long\n    Dim xFile As Variant\n    Dim xFileString As String\n    'define range\n    s_row = 1    'start row\n    s_col = 1    'start column\n    e_row = 200  'end row\n    e_col = 5    'end column\n    'back to normal code\n    On Error Resume Next\n    xTitleId = \"KutoolsforExcel\"\n    Application.ActiveSheet.Copy\n    Application.ActiveSheet.Cells.Clear\n    'using defined range to copy, then paste\n    Range(Cells(s_row,s_col),Cells(e_row,e_col)).Copy Application.ActiveSheet.Range(\"A1\")\n    Set xFile = CreateObject(\"Scripting.FileSystemObject\")\n    xFileString = Application.GetSaveAsFilename(\"\", filefilter:=\"Comma     Separated Text (*.CSV), *.CSV\")\n    Application.ActiveWorkbook.SaveAs Filename:=xFileString, FileFormat:=xlCSV, \n    CreateBackup:=False\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 182, "user_id": 4723652, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a83d76e4d118165936de6866d5f42004?s=128&d=identicon&r=PG&f=1", "display_name": "Techie", "link": "https://stackoverflow.com/users/4723652/techie"}, "is_accepted": false, "score": 0, "last_activity_date": 1527697490, "creation_date": 1527697490, "answer_id": 50609476, "question_id": 50608425, "link": "https://stackoverflow.com/questions/50608425/api-put-in-vba-exporting-a-csv-from-range-of-cells-microsoft-excel/50609476#50609476", "title": "API PUT in VBA, exporting a CSV from range of cells (Microsoft Excel)", "body": "<p>Hi @Gene below is modified code<br>\nnote: modify somename as your requirment and date format\nand range in  Set WorkRng = workbook.sheet1.range(\"<strong>A1:D</strong> \" &amp; lastrow &amp; \"\")\nhope this will works for you.</p>\n\n<pre><code>Sub ExportRangetoFile()\n'Update 20150628\n\nDim Rng As Range\n\nDim WorkRng As Range\n\nDim xFile As Variant\n\nDim xFileString As String\n\nOn Error Resume Next\nxTitleId = \"KutoolsforExcel\"\n lastrow= workbook.sheet1.range(\"A \"&amp; rows.count &amp; \"\").end(xlup).row \n Set WorkRng = workbook.sheet1.range(\"A1:D \" &amp; lastrow &amp; \"\")\n'Set WorkRng = Application.InputBox(\"Range\", xTitleId, WorkRng.Address, \nType:=8)\nApplication.ActiveSheet.Copy\nApplication.ActiveSheet.Cells.Clear\nWorkRng.Copy Application.ActiveSheet.Range(\"A1\")\nSet xFile = CreateObject(\"Scripting.FileSystemObject\")\nxFileString = \"somename\"&amp; format(now(),\"ddmmyyyy\")\n'Application.GetSaveAsFilename(\"\", filefilter:=\"Comma         Separated \nText (*.CSV), *.CSV\")\nApplication.ActiveWorkbook.SaveAs Filename:=xFileString, FileFormat:=xlCSV, \nCreateBackup:=False\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 113, "user_id": 8003362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/02bf9806119de16684ab3d083e3a6f6a?s=128&d=identicon&r=PG&f=1", "display_name": "Gene", "link": "https://stackoverflow.com/users/8003362/gene"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 162, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1527697490, "creation_date": 1527694021, "last_edit_date": 1531164843, "question_id": 50608425, "link": "https://stackoverflow.com/questions/50608425/api-put-in-vba-exporting-a-csv-from-range-of-cells-microsoft-excel", "title": "API PUT in VBA, exporting a CSV from range of cells (Microsoft Excel)", "body": "<p>I am trying to export a bit of data from an excel workbook via API PUT.  The specific API that I am using requires the data to be in CSV. </p>\n\n<p>I have code from this <a href=\"https://www.extendoffice.com/documents/excel/2897-excel-export-range-to-csv.html\" rel=\"nofollow noreferrer\">site</a> that converts a range of cells into a CSV.</p>\n\n<pre><code>Sub ExportRangetoFile()\n'Update 20150628\nDim Rng As Range\nDim WorkRng As Range\nDim xFile As Variant\nDim xFileString As String\nOn Error Resume Next\nxTitleId = \"KutoolsforExcel\"\nSet WorkRng = Application.Selection\nSet WorkRng = Application.InputBox(\"Range\", xTitleId, WorkRng.Address, \nType:=8)\nApplication.ActiveSheet.Copy\nApplication.ActiveSheet.Cells.Clear\nWorkRng.Copy Application.ActiveSheet.Range(\"A1\")\nSet xFile = CreateObject(\"Scripting.FileSystemObject\")\nxFileString = Application.GetSaveAsFilename(\"\", filefilter:=\"Comma Separated \nText (*.CSV), *.CSV\")\nApplication.ActiveWorkbook.SaveAs Filename:=xFileString, FileFormat:=xlCSV, \nCreateBackup:=False\nEnd Sub\n</code></pre>\n\n<p><strong>1st Issue:</strong>\n<a href=\"https://www.extendoffice.com/documents/excel/2897-excel-export-range-to-csv.html\" rel=\"nofollow noreferrer\">This</a> example requires a couple extra steps after running; selecting the range and saving/naming the file. I have a constant range of cells that will be converted to CSV (although they do not have constant value) and I don't really want the user to do anything with the CSV. I am trying to make this as automated as possible so others can just click a button in the workbook to do this export. <strong>How can I do what this site shows but completely automated via macros and/or modules in VBA?</strong></p>\n\n<p><strong>2nd Issue:</strong>\n<strong>If a solution to issue 1 is found, and a CSV file is saved after every time running that macro, is it possible to PUT that CSV via the API call in the same workbook the file was created?</strong> Again I am trying to make everything automated to make it as easy as possible for the people who will be using this workbook the most. Perhaps all of these things can be done in one macro or module.</p>\n\n<p><strong>Clarification</strong></p>\n\n<p>I am asking for help with creating a CSV from a range of cells by just running a macro and not clicking any saves or file naming. Secondly, I am just asking if it is possible and if it is best practice to send this CSV file through an API call in the same workbook or even the same macro where it can all be done with just one form click. I don't need help with the API call specifics... yet.</p>\n"}, {"tags": ["vba", "powerpoint"], "comments": [{"owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 0, "creation_date": 1527693578, "post_id": 50608084, "comment_id": 88226277, "body": "What are you expecting <code>Table = Array(j, i - 4)</code> to do? I speculate you want to define a 2D array of dimensions j and i-4, but you are creating an array with two value, j and i-4. I think you wanted to use <code>ReDim</code>."}, {"owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 0, "creation_date": 1527693816, "post_id": 50608084, "comment_id": 88226448, "body": "See <a href=\"https://msdn.microsoft.com/en-us/VBA/language-reference-vba/articles/array-function\" rel=\"nofollow noreferrer\">Array</a> and <a href=\"https://msdn.microsoft.com/en-us/vba/language-reference-vba/articles/redim-statement\" rel=\"nofollow noreferrer\">ReDim</a>"}, {"owner": {"reputation": 1, "user_id": 9871028, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/09b72d1202b2118d49a7e10233d6e560?s=128&d=identicon&r=PG&f=1", "display_name": "user9871028", "link": "https://stackoverflow.com/users/9871028/user9871028"}, "reply_to_user": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 0, "creation_date": 1527696517, "post_id": 50608084, "comment_id": 88228085, "body": "Yes I would like to define a 2D array of dimensions j and i-4. How would I use ReDim to do that?    ReDim Table (j, i-4) ?"}, {"owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 0, "creation_date": 1527696861, "post_id": 50608084, "comment_id": 88228282, "body": "Change Table definition to <code>Dim Table() as Variant</code> to make it a dynamic array, then use <code>Redim Table(j, i-4)</code> to resize it as required."}], "answers": [{"tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 0, "last_activity_date": 1527693576, "last_edit_date": 1527693576, "creation_date": 1527693186, "answer_id": 50608171, "question_id": 50608084, "link": "https://stackoverflow.com/questions/50608084/powerpoint-vba-subscript-out-of-range-when-looping-array/50608171#50608171", "title": "PowerPoint: VBA Subscript out of range when looping array", "body": "<p><code>Table</code> is a single dimensional array:</p>\n\n<p><a href=\"https://i.stack.imgur.com/6Voau.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/6Voau.png\" alt=\"enter image description here\"></a></p>\n\n<p>On this line <code>Table(j, i - 4)</code>, you are using it, as if it is a multidimensional one.</p>\n\n<p>Try something as small as this one to get the meaning:</p>\n\n<pre><code>Option Explicit\n\nPublic Sub TestMe()\n\n    Dim i As Long, j As Long\n    For i = 5 To 9\n\n        Dim inputArray As Variant\n        Dim Table As Variant\n\n        inputArray = Array(0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9)\n\n        For j = 0 To 1\n            Table = Array(j, i - 4)\n            Table(j) = inputArray(i - 4)\n            Debug.Print Table(j)\n        Next j\n    Next i\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 9871028, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/09b72d1202b2118d49a7e10233d6e560?s=128&d=identicon&r=PG&f=1", "display_name": "user9871028", "link": "https://stackoverflow.com/users/9871028/user9871028"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 53, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1527696247, "creation_date": 1527692971, "last_edit_date": 1527696247, "question_id": 50608084, "link": "https://stackoverflow.com/questions/50608084/powerpoint-vba-subscript-out-of-range-when-looping-array", "title": "PowerPoint: VBA Subscript out of range when looping array", "body": "<p>I am trying to use a loop to split a 1d array into a 2d array and populate text boxes in VBA. I get the error, subscript out of range for Table(j, i - 4) in the line that says: \nTable(j, i - 4) = inputArray(10 * (i - 4 - 1) + (j - 1))\nPlease let me know if there is a better way to do this, any help is appreciated</p>\n\n<p>Part of the code is below</p>\n\n<pre><code>For i = 5 to 9 \n\nDim inputArray As Variant\nDim Table As Variant\n\ninputArray = Array(0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9, 1, 1.1, 1.2, 1.3, 1.4, 1.5, 1.6, 1.7, 1.8, 1.9)\n\nFor j = 1 To UBound(inputArray)\n    Table = Array(j, i - 4)\n    Table(j, i - 4) = inputArray(10 * (i - 4 - 1) + (j - 1))\nNext j\n\nSet oPicture = oSl.Shapes.AddTextbox(msoTextOrientationHorizontal, _\n        Left:=TBLeft1, Top:=TBTop1, _\n        Width:=TBWidth1, Height:=TBHeight1)\n    oPicture.TextFrame.TextRange.Text = Table(1, (i - 4))\n    With oPicture\n    .ZOrder msoBringInFrontOfText\n    End With\nSet oPicture = oSl.Shapes.AddTextbox(msoTextOrientationHorizontal, _\n        Left:=TBLeft2, Top:=TBTop2, _\n        Width:=TBWidth2, Height:=TBHeight2)\n    oPicture.TextFrame.TextRange.Text = Table(2, (i - 4))\n    With oPicture\n    .ZOrder msoBringInFrontOfText\n    End With\n\nNext i\n</code></pre>\n"}, {"tags": ["excel", "date", "vba"], "answers": [{"comments": [{"owner": {"reputation": 35, "user_id": 9664728, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Stephen", "link": "https://stackoverflow.com/users/9664728/stephen"}, "edited": false, "score": 0, "creation_date": 1527781938, "post_id": 50608417, "comment_id": 88266570, "body": "Thanks for the comment - this does not seem to work - I have copied the function however the formula returns &quot;#VALUE!&quot; - is the syntax correct in the formula?"}, {"owner": {"reputation": 35, "user_id": 9664728, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Stephen", "link": "https://stackoverflow.com/users/9664728/stephen"}, "edited": false, "score": 0, "creation_date": 1527783126, "post_id": 50608417, "comment_id": 88267164, "body": "Also I dont have much experience with functions - one other question is that my hard coded data will go in to columns A-C. Should the formula using the function go in to D or E? The formula and screenshot you provided would lead me to think D however you mentioned E. Thanks in advance."}, {"owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "reply_to_user": {"reputation": 35, "user_id": 9664728, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Stephen", "link": "https://stackoverflow.com/users/9664728/stephen"}, "edited": false, "score": 0, "creation_date": 1527786124, "post_id": 50608417, "comment_id": 88268701, "body": "Yes, you are right, it should beD. The data will go into A to C and then you put the formula in D. The syntax is correct for a german version of excel, you probaly have to replace the ; with a , <code>=IncDate(TODAY(),B4,C4)</code>"}, {"owner": {"reputation": 35, "user_id": 9664728, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Stephen", "link": "https://stackoverflow.com/users/9664728/stephen"}, "edited": false, "score": 0, "creation_date": 1527786649, "post_id": 50608417, "comment_id": 88268940, "body": "Perfect that worked. Regards ensuring the date generated is a day between Monday - Friday so if the date resultant from the initial function is Sat or Sunday how do I move the date forward to the following Monday?"}, {"owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "reply_to_user": {"reputation": 35, "user_id": 9664728, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Stephen", "link": "https://stackoverflow.com/users/9664728/stephen"}, "edited": false, "score": 0, "creation_date": 1527786875, "post_id": 50608417, "comment_id": 88269039, "body": "I think this a new request. Try something on your own and if you get stuck create a new post"}, {"owner": {"reputation": 35, "user_id": 9664728, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Stephen", "link": "https://stackoverflow.com/users/9664728/stephen"}, "edited": false, "score": 0, "creation_date": 1527842937, "post_id": 50608417, "comment_id": 88289035, "body": "Thanks I have created what I require in Excel and created a new post - <a href=\"https://stackoverflow.com/questions/50639504/retutn-only-buisness-days-in-custom-date-function-in-excel\" title=\"retutn only buisness days in custom date function in excel\">stackoverflow.com/questions/50639504/&hellip;</a>"}], "tags": [], "owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "is_accepted": false, "score": 1, "last_activity_date": 1527786014, "last_edit_date": 1527786014, "creation_date": 1527693996, "answer_id": 50608417, "question_id": 50608032, "link": "https://stackoverflow.com/questions/50608032/increment-a-date-by-a-number-of-days-months-or-years/50608417#50608417", "title": "Increment a date by a number of days, months or years", "body": "<p>I would create a user defined function, somthing like that</p>\n\n<pre><code>Function IncDate(ByVal dt As Date, ByVal add As Long, ByVal dmy As String) As Date\n\n    Select Case UCase(dmy)\n        Case \"DAY\"\n            IncDate = DateAdd(\"d\", add, dt)\n        Case \"MONTH\"\n                IncDate = DateAdd(\"m\", add, dt)\n        Case \"YEAR\"\n                IncDate = DateAdd(\"yyyy\", add, dt)\n        Case Else\n                IncDate = dt\n    End Select\nEnd Function\n</code></pre>\n\n<p>And then you could write in D</p>\n\n<pre><code>=IncDate(TODAY();B4;C4)\n</code></pre>\n\n<p>You then need to format the cell to your needs. </p>\n\n<p>Result would look like that</p>\n\n<p><a href=\"https://i.stack.imgur.com/p9dYE.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/p9dYE.jpg\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 35, "user_id": 9664728, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Stephen", "link": "https://stackoverflow.com/users/9664728/stephen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1103, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1527786014, "creation_date": 1527692795, "last_edit_date": 1531161705, "question_id": 50608032, "link": "https://stackoverflow.com/questions/50608032/increment-a-date-by-a-number-of-days-months-or-years", "title": "Increment a date by a number of days, months or years", "body": "<p>I have a date which I will need to increment the date by a day, month or year from the actual date. This is based of a list of fields below and is different per the input. Also each resultant date has to be a business day i.e not a weekend day or a bank holiday. I will forgo the Bank Holiday requirement now. </p>\n\n<p>I am using the formula <code>=DATE(YEAR($A$1),MONTH($A$1),DAY($A$1))</code> and hard coding the increment value in each row based of the value in B4 below.\nAlso once we get past SP in column A4 the formula changes to reference the date created by using the value at the SP value. </p>\n\n<p>So if we put the results in to column E the formula will change to <code>=DATE(YEAR($E$6),MONTH($E$6),DAY($E$6))</code>\nThe date also needs to be in the format <code>text(xx,\"mm/dd/yyyy\")</code></p>\n\n<p>Any suggestions on how to create this in Excel of VIA a VBA solution macro would be appreciated </p>\n\n<pre><code>A1\n=today()\n\nA4 B4\nON  1 Day\nTN  2 Day\nSP  2 Day\nSN  2 Day\n1W  7 Day\n2W  14 Day\n3W  21 Day\n1M  1 Month\n2M  2 Month\n3M  3 Month\n4M  4 Month\n5M  5 Month\n6M  6 Month\n7M  7 Month\n8M  8 Month\n9M  9 Month\n10M 10 Month\n11M 11 Month\n1Y  1 Year\n15M 15 Month\n18M 18 Month\n21M 21 Month\n2Y  2 Year\n3Y  3 Year\n4Y  4 Year\n5Y  5 Year\n6Y  6 Year\n7Y  7 Year\n8Y  8 Year\n9Y  9 Year\n10Y 10 Year\n15Y 15 Year\n20Y 20 Year\n25Y 25 Year\n30Y 30 Year\n</code></pre>\n"}, {"tags": ["vba", "excel", "ms-word"], "answers": [{"tags": [], "owner": {"reputation": 4047, "user_id": 3246362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6da9a197d0f0e5f19875d8a97550e58e?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/3246362/sam"}, "is_accepted": false, "score": 0, "last_activity_date": 1527694527, "creation_date": 1527694527, "answer_id": 50608599, "question_id": 50607961, "link": "https://stackoverflow.com/questions/50607961/how-to-copy-a-formatted-paragraph-from-word-2013-to-excel/50608599#50608599", "title": "How to copy a formatted paragraph from Word 2013 to Excel?", "body": "<p>The answer will be a bit ugly. This way is normally not how you should write Excel macros, but here it goes:</p>\n\n<pre><code>...\nSheets(FileName).Cells(ParaCount, 1).Select\nSheets(FileName).Paste\n...\n</code></pre>\n\n<p>Don't use <code>.Select</code> unless you need to.</p>\n"}, {"tags": [], "owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "is_accepted": true, "score": 3, "last_activity_date": 1527703918, "creation_date": 1527703918, "answer_id": 50611074, "question_id": 50607961, "link": "https://stackoverflow.com/questions/50607961/how-to-copy-a-formatted-paragraph-from-word-2013-to-excel/50611074#50611074", "title": "How to copy a formatted paragraph from Word 2013 to Excel?", "body": "<p>There are a couple tricks to this and some things to keep in mind. First, the code:</p>\n\n<pre><code>Option Explicit\n\nSub ParaCopy()\n    Dim wApp As Word.Application\n    Dim wDoc As Word.Document\n    Set wApp = CreateObject(\"Word.Application\")\n    Set wDoc = wApp.Documents.Open(\"C:\\Temp\\testdoc.docx\", ReadOnly:=True)\n\n    Dim i As Long\n    i = 0\n    Dim wPara As Word.Paragraph\n    For Each wPara In wDoc.Paragraphs\n        If wPara.Range.Words.Count &gt; 1 Then\n            wPara.Range.Copy\n            Sheet1.Range(\"A1\").Offset(i, 0).Activate\n            Sheet1.Paste\n            i = i + 1\n        End If\n    Next wPara\n\n    wDoc.Close\n    wApp.Quit\nEnd Sub\n</code></pre>\n\n<p>So this works from two aspects:</p>\n\n<ol>\n<li>We're using the <code>Range.Copy</code> method of the Word <code>Paragraph</code>. This captures all of the attributes of the paragraph including the formatting.</li>\n<li>To copy into a specific cell, this is one of the rare instances in which using <code>Activate</code> is necessary. This signals to Excel that the upcoming <code>Copy</code> operation will apply <em>all</em> of attributes of the incoming object (which is a Word paragraph object in this case).</li>\n</ol>\n\n<p>Make sure you check that the paragraph has at least one word in it. Otherwise the paste operation will fail.</p>\n\n<p>Here's my test Word document:</p>\n\n<p><a href=\"https://i.stack.imgur.com/6VWsY.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/6VWsY.png\" alt=\"enter image description here\"></a></p>\n\n<p>And here is the workbook Sheet1 after the Paste:</p>\n\n<p><a href=\"https://i.stack.imgur.com/8rbQn.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/8rbQn.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": [], "owner": {"reputation": 41, "user_id": 9871054, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156398535140486/picture?type=large", "display_name": "Rod Naugler", "link": "https://stackoverflow.com/users/9871054/rod-naugler"}, "is_accepted": false, "score": 0, "last_activity_date": 1527782506, "creation_date": 1527782506, "answer_id": 50628420, "question_id": 50607961, "link": "https://stackoverflow.com/questions/50607961/how-to-copy-a-formatted-paragraph-from-word-2013-to-excel/50628420#50628420", "title": "How to copy a formatted paragraph from Word 2013 to Excel?", "body": "<p>For reference, the updated sub code is:</p>\n\n<pre><code>   Private Sub Load_Schedule()\n    Dim ParaCount As Integer\n    Sheets(FileName).Activate\n    Sheets(FileName).Columns(1).AutoFit\n    For ParaCount = 1 To wDoc.Paragraphs.Count\n        wDoc.Paragraphs(ParaCount).Range.Copy\n        Sheets(FileName).Range(\"A1\").Offset(ParaCount, 0).Activate\n        Sheets(FileName).Paste\n    Next ParaCount\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 41, "user_id": 9871054, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156398535140486/picture?type=large", "display_name": "Rod Naugler", "link": "https://stackoverflow.com/users/9871054/rod-naugler"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1891, "favorite_count": 1, "accepted_answer_id": 50611074, "answer_count": 3, "score": 4, "last_activity_date": 1527783132, "creation_date": 1527692601, "last_edit_date": 1527783132, "question_id": 50607961, "link": "https://stackoverflow.com/questions/50607961/how-to-copy-a-formatted-paragraph-from-word-2013-to-excel", "title": "How to copy a formatted paragraph from Word 2013 to Excel?", "body": "<p>I want to open a Word document and copy each formatted paragraph into its own cell in an Excel worksheet, retaining the formatting for further processing.\nI have been able to copy each paragraph into its own cell, and even have the bullet/list retained in an adjacent cell. </p>\n\n<p>However, I can either have the paragraph copied as an object, not formatted text, or as plain text. I have not been able to get the formatted text copied over.</p>\n\n<p>Here is my Subroutine code that does the copying:</p>\n\n<pre><code>Private Sub Load_Schedule()\n    Dim ParaCount As Integer\n    Sheets(FileName).Activate\n    Sheets(FileName).Columns(1).AutoFit\n    For ParaCount = 1 To wDoc.Paragraphs.Count\n        wDoc.Paragraphs(ParaCount).Range.FormattedText.Copy\n        Sheets(FileName).Cells(ParaCount, 1).PasteSpecial Paste:=xlPasteFormats\n    Next ParaCount\nEnd Sub\n</code></pre>\n\n<p>I have tried <code>Range.Copy</code> on the wDoc side and I have tried various Paste:= and just <code>Cells(ParaCount, 1).Paste</code> on the Sheets side. Nothing seems to bring the formatting into the cell.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1472, "user_id": 1726522, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/0DUTN.gif?s=128&g=1", "display_name": "CMArg", "link": "https://stackoverflow.com/users/1726522/cmarg"}, "edited": false, "score": 0, "creation_date": 1527692124, "post_id": 50607751, "comment_id": 88225303, "body": "<code>LastRow</code> or <code>RowCount</code>?"}, {"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 1, "creation_date": 1527692212, "post_id": 50607751, "comment_id": 88225357, "body": "I don&#39;t see where you set the <code>LastRow</code> variable, so it&#39;s just <code>0</code>. Therefore your <code>offset()</code> is moving down 0 rows and adding new data. Which, of course, is always going to be row &quot;A6865&quot;. Perhaps change <code>RowCount = </code> to <code>LastRow = </code> and rerun."}, {"owner": {"reputation": 3, "user_id": 9871006, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Jamie", "link": "https://stackoverflow.com/users/9871006/jamie"}, "edited": false, "score": 0, "creation_date": 1527692559, "post_id": 50607751, "comment_id": 88225606, "body": "I tried, but now nothing happens. How do I better define it?"}, {"owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "edited": false, "score": 0, "creation_date": 1527692724, "post_id": 50607751, "comment_id": 88225713, "body": "I would think you&#39;d use <code>.Offset(LastRow+1</code> to put the data in the next row below the last one. Then, if you&#39;re looping, just <code>LastRow=LastRow+1</code> before the loop starts again and you should be good."}, {"owner": {"reputation": 1688, "user_id": 9259306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EIROY.png?s=128&g=1", "display_name": "Mistella", "link": "https://stackoverflow.com/users/9259306/mistella"}, "edited": false, "score": 0, "creation_date": 1527692910, "post_id": 50607751, "comment_id": 88225845, "body": "Although, if <code>Range(&quot;A6865&quot;)</code> is not part of the same region as <code>Range(&quot;A1&quot;)</code>, it&#39;s possible that <code>RowCount</code> does not hold the expected value, either."}, {"owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "edited": false, "score": 1, "creation_date": 1527693767, "post_id": 50607751, "comment_id": 88226417, "body": "Please provide the full code that includes the <code>LastRow</code> variable. As of now, we are just speculating that you have the variables set."}, {"owner": {"reputation": 3, "user_id": 9871006, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Jamie", "link": "https://stackoverflow.com/users/9871006/jamie"}, "edited": false, "score": 0, "creation_date": 1527694679, "post_id": 50607751, "comment_id": 88226987, "body": "I added the full code, nothing mentioned so far has worked"}, {"owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "edited": false, "score": 0, "creation_date": 1527696663, "post_id": 50607751, "comment_id": 88228164, "body": "Where is your setting for <code>LastRow</code>?"}, {"owner": {"reputation": 3, "user_id": 9871006, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Jamie", "link": "https://stackoverflow.com/users/9871006/jamie"}, "edited": false, "score": 0, "creation_date": 1527698126, "post_id": 50607751, "comment_id": 88228941, "body": "I guess I don&#39;t have one, how do I do that?"}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1527778339, "post_id": 50607751, "comment_id": 88264296, "body": "As has been pointed out - you haven&#39;t defined which row number <code>LastRow</code> is meant to be.  You say you can use column B to find the last row so use <code>LastRow = Worksheets(&quot;Expected Returns&quot;).Cells(Rows.Count, 2).End(xlUp).Row</code> to find the last populated row - add 1 to get the next available row."}, {"owner": {"reputation": 3, "user_id": 9871006, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Jamie", "link": "https://stackoverflow.com/users/9871006/jamie"}, "edited": false, "score": 0, "creation_date": 1527779678, "post_id": 50607751, "comment_id": 88265122, "body": "What if every row is populated, the first and third columns are all filled going all the way down and always are filled?"}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1527780937, "post_id": 50607751, "comment_id": 88265923, "body": "If you want to find the last row using column A or column C then change the <code>Cells(Rows.Count,2)</code> to <code>Cells(Rows.Count,1)</code> for A and <code>Cells(Rows.Count,3)</code> for C - it will then take that as the last row.  If <i>every row</i> is populated how do you want to decide which row to add the data to?"}, {"owner": {"reputation": 3, "user_id": 9871006, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Jamie", "link": "https://stackoverflow.com/users/9871006/jamie"}, "edited": false, "score": 0, "creation_date": 1527787624, "post_id": 50607751, "comment_id": 88269372, "body": "I tried, this makes it not put anything into the sheet at all :/ and a typo, I didn&#39;t mean every I meant just the two columns are filled the rest are empty"}], "answers": [{"comments": [{"owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "edited": false, "score": 4, "creation_date": 1527693641, "post_id": 50608208, "comment_id": 88226318, "body": "This code makes no sense, where does the <code>else</code> or <code>end if</code> come from ? Why would you hide the UserForm?"}, {"owner": {"reputation": 75, "user_id": 7395776, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-XO-DLPFtH-4/AAAAAAAAAAI/AAAAAAAAAVQ/5YVUhPGuqUU/photo.jpg?sz=128", "display_name": "Pedro Gaspar", "link": "https://stackoverflow.com/users/7395776/pedro-gaspar"}, "reply_to_user": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "edited": false, "score": 0, "creation_date": 1528094152, "post_id": 50608208, "comment_id": 88358848, "body": "I Forget to delete that part. Sorry"}], "tags": [], "owner": {"reputation": 75, "user_id": 7395776, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-XO-DLPFtH-4/AAAAAAAAAAI/AAAAAAAAAVQ/5YVUhPGuqUU/photo.jpg?sz=128", "display_name": "Pedro Gaspar", "link": "https://stackoverflow.com/users/7395776/pedro-gaspar"}, "is_accepted": false, "score": -2, "last_activity_date": 1528094118, "last_edit_date": 1528094118, "creation_date": 1527693308, "answer_id": 50608208, "question_id": 50607751, "link": "https://stackoverflow.com/questions/50607751/excel-userform-vba-wont-move-to-next-row/50608208#50608208", "title": "Excel Userform VBA won&#39;t move to next row", "body": "<p>Try this instead...</p>\n\n<pre><code>last = Application.ThisWorkbook.Worksheets(\"YOURSHEET\").Range(\"A65536\").End(xlUp).Row\n\n    Application.ThisWorkbook.Worksheets(\"Yourshee\").Cells(last + 1, 1) = anything()                          'data\n    Application.ThisWorkbook.Worksheets(\"Yoursheet\").Cells(last + 1, 2) = anything            \n    Application.ThisWorkbook.Worksheets(\"Yoursheet\").Cells(last + 1, 3) = anything\n    Application.ThisWorkbook.Worksheets(\"Yoursheet\").Cells(last + 1, 4) = anything            \n    Application.ThisWorkbook.Worksheets(\"Yoursheet\").Cells(last + 1, 5) = anything \n    MsgBox \"Sucess\"\n</code></pre>\n\n<p>You can add na iff statement to have a positive result and a negative result if you want</p>\n"}, {"comments": [{"owner": {"reputation": 3, "user_id": 9871006, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Jamie", "link": "https://stackoverflow.com/users/9871006/jamie"}, "edited": false, "score": 0, "creation_date": 1527699254, "post_id": 50609638, "comment_id": 88229516, "body": "how do I set a tag for each element? (in this case text box)"}, {"owner": {"reputation": 1472, "user_id": 1726522, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/0DUTN.gif?s=128&g=1", "display_name": "CMArg", "link": "https://stackoverflow.com/users/1726522/cmarg"}, "reply_to_user": {"reputation": 3, "user_id": 9871006, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Jamie", "link": "https://stackoverflow.com/users/9871006/jamie"}, "edited": false, "score": 0, "creation_date": 1527699408, "post_id": 50609638, "comment_id": 88229574, "body": "Right click on the element (textbox, checkbox, etc) --&gt; Properies. Then type a number in the Tag property."}, {"owner": {"reputation": 1472, "user_id": 1726522, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/0DUTN.gif?s=128&g=1", "display_name": "CMArg", "link": "https://stackoverflow.com/users/1726522/cmarg"}, "reply_to_user": {"reputation": 3, "user_id": 9871006, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Jamie", "link": "https://stackoverflow.com/users/9871006/jamie"}, "edited": false, "score": 0, "creation_date": 1527700148, "post_id": 50609638, "comment_id": 88229965, "body": "Can you provide more info of what is wrong? Above code is working for me..."}, {"owner": {"reputation": 3, "user_id": 9871006, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Jamie", "link": "https://stackoverflow.com/users/9871006/jamie"}, "edited": false, "score": 0, "creation_date": 1527701820, "post_id": 50609638, "comment_id": 88230939, "body": "It just doesn&#39;t add anything to the sheet at all, compared to before where it would at least just put it in the same row."}, {"owner": {"reputation": 1472, "user_id": 1726522, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/0DUTN.gif?s=128&g=1", "display_name": "CMArg", "link": "https://stackoverflow.com/users/1726522/cmarg"}, "reply_to_user": {"reputation": 3, "user_id": 9871006, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Jamie", "link": "https://stackoverflow.com/users/9871006/jamie"}, "edited": false, "score": 0, "creation_date": 1527704091, "post_id": 50609638, "comment_id": 88232078, "body": "Press F8 to step into the code. Pressing F8 you will go step by step. Hovering the mouse over the variables you are able to see their value."}, {"owner": {"reputation": 3, "user_id": 9871006, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Jamie", "link": "https://stackoverflow.com/users/9871006/jamie"}, "edited": false, "score": 0, "creation_date": 1527706035, "post_id": 50609638, "comment_id": 88233008, "body": "sorry to be a newbie, but can you explain &quot;write to column according to their tag&quot;?"}, {"owner": {"reputation": 1472, "user_id": 1726522, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/0DUTN.gif?s=128&g=1", "display_name": "CMArg", "link": "https://stackoverflow.com/users/1726522/cmarg"}, "reply_to_user": {"reputation": 3, "user_id": 9871006, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Jamie", "link": "https://stackoverflow.com/users/9871006/jamie"}, "edited": false, "score": 0, "creation_date": 1527707241, "post_id": 50609638, "comment_id": 88233598, "body": "Take a close look at the code. For each control (textbox, checkbox, etc) the code gets its tag number and store it in variable i (<code>i=ctl.Tag</code>). Then, in row <code>LastRow</code> and column <code>i</code>, the code writes the control value. So, if you set Tag=3 for <code>txtDevice</code>, the code will write the value of <code>txtDevice</code> in column 3."}, {"owner": {"reputation": 3, "user_id": 9871006, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Jamie", "link": "https://stackoverflow.com/users/9871006/jamie"}, "edited": false, "score": 0, "creation_date": 1527708702, "post_id": 50609638, "comment_id": 88234251, "body": "ok, makes sense. thank you! do I write it in brackets or the quotes?"}, {"owner": {"reputation": 1472, "user_id": 1726522, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/0DUTN.gif?s=128&g=1", "display_name": "CMArg", "link": "https://stackoverflow.com/users/1726522/cmarg"}, "reply_to_user": {"reputation": 3, "user_id": 9871006, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Jamie", "link": "https://stackoverflow.com/users/9871006/jamie"}, "edited": false, "score": 0, "creation_date": 1527709967, "post_id": 50609638, "comment_id": 88234820, "body": "The above code, in its present form,  works fine for me."}, {"owner": {"reputation": 1472, "user_id": 1726522, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/0DUTN.gif?s=128&g=1", "display_name": "CMArg", "link": "https://stackoverflow.com/users/1726522/cmarg"}, "reply_to_user": {"reputation": 3, "user_id": 9871006, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Jamie", "link": "https://stackoverflow.com/users/9871006/jamie"}, "edited": false, "score": 0, "creation_date": 1527777468, "post_id": 50609638, "comment_id": 88263724, "body": "@Jamie its hard to say what is wrong just by &quot;still doesn&#39;t work for me&quot;. We&#39;re blind, since its working for me. Did you try to go step by step pressing F8? Did you check the values of the variables, hovering the mouse over them?"}, {"owner": {"reputation": 3, "user_id": 9871006, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Jamie", "link": "https://stackoverflow.com/users/9871006/jamie"}, "edited": false, "score": 0, "creation_date": 1527777606, "post_id": 50609638, "comment_id": 88263816, "body": "yeah, it runs fine and then empties the form when complete, but there is nothing to show in the sheet itself. It just doesn&#39;t fill in."}, {"owner": {"reputation": 1472, "user_id": 1726522, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/0DUTN.gif?s=128&g=1", "display_name": "CMArg", "link": "https://stackoverflow.com/users/1726522/cmarg"}, "reply_to_user": {"reputation": 3, "user_id": 9871006, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Jamie", "link": "https://stackoverflow.com/users/9871006/jamie"}, "edited": false, "score": 0, "creation_date": 1527777671, "post_id": 50609638, "comment_id": 88263860, "body": "Did you add a tag value to the TextBoxs? You could check this with F8, and holding the mouse over <code>i</code>."}, {"owner": {"reputation": 1688, "user_id": 9259306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EIROY.png?s=128&g=1", "display_name": "Mistella", "link": "https://stackoverflow.com/users/9259306/mistella"}, "reply_to_user": {"reputation": 3, "user_id": 9871006, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Jamie", "link": "https://stackoverflow.com/users/9871006/jamie"}, "edited": false, "score": 0, "creation_date": 1527802214, "post_id": 50609638, "comment_id": 88276380, "body": "@Jamie In the line <code>LastRow = Worksheets(&quot;EXPECTED RETURNS&quot;).Range(&quot;A&quot; &amp; Rows.Count).End(xlUp).Row + 1</code>, try changing &quot;A&quot; to &quot;B&quot;. Since column B is one that you are filling in, and column A is pre-filled, you should try to get the last used row from column B instead of A."}, {"owner": {"reputation": 1472, "user_id": 1726522, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/0DUTN.gif?s=128&g=1", "display_name": "CMArg", "link": "https://stackoverflow.com/users/1726522/cmarg"}, "edited": false, "score": 0, "creation_date": 1527851083, "post_id": 50609638, "comment_id": 88294021, "body": "Try inserting <code>MsgBox (&quot;Starting&quot;)</code> after <code>Dim i As Integer</code>, <code>MsgBox (&quot;LR: &quot; &amp; LastRow)</code> after <code>LasRow=....</code>, and <code>MsgBox (&quot;Tag: &quot; &amp; i &amp; &quot; Value: &quot; &amp; ctl.Value)</code> after <code>i = ctl.Tag</code>. After clicking <code>butOK</code> you should see alerts that may help you to find the error."}], "tags": [], "owner": {"reputation": 1472, "user_id": 1726522, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/0DUTN.gif?s=128&g=1", "display_name": "CMArg", "link": "https://stackoverflow.com/users/1726522/cmarg"}, "is_accepted": true, "score": 0, "last_activity_date": 1527698897, "last_edit_date": 1527698897, "creation_date": 1527698141, "answer_id": 50609638, "question_id": 50607751, "link": "https://stackoverflow.com/questions/50607751/excel-userform-vba-wont-move-to-next-row/50609638#50609638", "title": "Excel Userform VBA won&#39;t move to next row", "body": "<p>The code below will find the last used row in <code>EXPECTED RETURNS</code> sheet and copy data in next row. Also, it assumes that you set a <code>tag</code> number to all your relevant elements in the form: 1 for <code>TextDate</code>, 3 for <code>TextDevice</code> and so on. This way, your code can be reduce to something like the following:</p>\n\n<pre><code>Private Sub butOK_Click()\n    Dim LastRow As Long\n    Dim ctl As Control\n    Dim i As Integer\n\n    'Get last row with data\n    LastRow = Worksheets(\"EXPECTED RETURNS\").Range(\"A\" &amp; Rows.Count).End(xlUp).Row + 1\n\n    'Get all control values, and write to column according to their tag\n    For Each ctl In Me.Controls\n        If ctl.Tag &lt;&gt; \"\" Then\n            i = ctl.Tag\n            Worksheets(\"EXPECTED RETURNS\").Cells(LastRow, i) = ctl.Value\n        End If\n    Next\n\n    'Clear all controls\n    For Each ctl In Me.Controls\n        If TypeName(ctl) = \"TextBox\" Or TypeName(ctl) = \"ComboBox\" Then\n            ctl.Value = \"\"\n        ElseIf TypeName(ctl) = \"CheckBox\" Then\n            ctl.Value = False\n        End If\n    Next ctl\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 9871006, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Jamie", "link": "https://stackoverflow.com/users/9871006/jamie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 432, "favorite_count": 0, "accepted_answer_id": 50609638, "answer_count": 2, "score": 0, "last_activity_date": 1528094118, "creation_date": 1527692005, "last_edit_date": 1527777383, "question_id": 50607751, "link": "https://stackoverflow.com/questions/50607751/excel-userform-vba-wont-move-to-next-row", "title": "Excel Userform VBA won&#39;t move to next row", "body": "<p>My userform works fine to fill in the fields on an excel spreadsheet, but it refuses to move to the next line. I can't do it by asking to find an empty row either, because columns A and C are prefilled. Is there a way to make the userform jump to the next line once it has been complete and submitted and the fields are filled out, maybe by using the B column as a way to know whether the row is open to use? Because no matter what, the A and C columns are filled. Also, once the user is done, saves the document, and comes back to it later, will the userform pick up on whatever line it last left off on? I know i posted this already, but no solutions have worked and I figured I would add more detail. Sorry if some of this seems novice, I am new to VBA. Thank you!</p>\n\n<pre><code>Private Sub butOK_Click()\nDim RowCount As Long\nDim ctl As Control\n\nRowCount = Worksheets(\"EXPECTED RETURNS\").Range(\"A6865\").CurrentRegion.Rows.Count\n With Worksheets(\"EXPECTED RETURNS\").Range(\"A6865\")\n.Offset(LastRow, 1).Value = Me.txtDate.Value\n.Offset(LastRow, 3).Value = Me.txtDevice.Value\n.Offset(LastRow, 4).Value = Me.txtID.Value\n.Offset(LastRow, 5).Value = Me.txtSN.Value\n.Offset(LastRow, 6).Value = Me.txtTrans.Value\n.Offset(LastRow, 7).Value = Me.txtIDTrans.Value\n.Offset(LastRow, 8).Value = Me.txtMS.Value\n.Offset(LastRow, 9).Value = Me.txtCountry.Value\n.Offset(LastRow, 10).Value = Me.txtCamp.Value\n.Offset(LastRow, 11).Value = Me.txtOrig.Value\n.Offset(LastRow, 12).Value = Me.txtProgram.Value\n.Offset(LastRow, 13).Value = Me.txtPOC.Value\n.Offset(LastRow, 14).Value = Me.txtPOCEmail.Value\n.Offset(LastRow, 15).Value = Me.txtDSN.Value\n.Offset(LastRow, 16).Value = Me.txtIR.Value\n.Offset(LastRow, 17).Value = Me.txtEI.Value\nEnd With\n\nFor Each ctl In Me.Controls\nIf TypeName(ctl) = \"TextBox\" Or TypeName(ctl) = \"ComboBox\" Then\nctl.Value = \"\"\nElseIf TypeName(ctl) = \"CheckBox\" Then\nctl.Value = False\nEnd If\nNext ctl\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 187, "user_id": 4495174, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/f4d37f89eb7a16cfd1a2c364919f5985?s=128&d=identicon&r=PG&f=1", "display_name": "dom176", "link": "https://stackoverflow.com/users/4495174/dom176"}, "edited": false, "score": 0, "creation_date": 1527691702, "post_id": 50607612, "comment_id": 88224956, "body": "I&#39;m trying to do using my defined VBA references, which are going to be static. so I can&#39;t just use direct cell references for the first argument."}, {"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "reply_to_user": {"reputation": 187, "user_id": 4495174, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/f4d37f89eb7a16cfd1a2c364919f5985?s=128&d=identicon&r=PG&f=1", "display_name": "dom176", "link": "https://stackoverflow.com/users/4495174/dom176"}, "edited": false, "score": 0, "creation_date": 1527692078, "post_id": 50607612, "comment_id": 88225265, "body": "You can try to add &quot;. Address&quot; after the named range. Instead of &quot;MWS.Cells,&quot; Try &quot;MWS.Address&quot; (in the above format of course)"}], "tags": [], "owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "is_accepted": false, "score": 0, "last_activity_date": 1527691588, "creation_date": 1527691588, "answer_id": 50607612, "question_id": 50607446, "link": "https://stackoverflow.com/questions/50607446/inserting-an-application-worksheetfunction-into-a-cell-as-a-formula/50607612#50607612", "title": "Inserting an Application.worksheetfunction into a cell as a formula", "body": "<p>This is a generic example of how to enter a formula into a cell (you can modify this for a range as needed). </p>\n\n<pre><code>Thisworkbook.Sheets(\"Sheet1\").Range(\"A1\").Formula = \"=VLoookup(A1,B:C,2,0)\"\n</code></pre>\n\n<p>The basic format is below with the following two variables: \"YourRange\" and [Formula] </p>\n\n<blockquote>\n  <p>YourRange.Formula = \"=[Formula]\"</p>\n</blockquote>\n"}, {"comments": [{"owner": {"reputation": 187, "user_id": 4495174, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/f4d37f89eb7a16cfd1a2c364919f5985?s=128&d=identicon&r=PG&f=1", "display_name": "dom176", "link": "https://stackoverflow.com/users/4495174/dom176"}, "edited": false, "score": 0, "creation_date": 1527691883, "post_id": 50607624, "comment_id": 88225118, "body": "I tried this myself as a work around and I keep getting &quot;Application-Defined or object-defined error&quot; and I cant for the life of me figure out why."}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "reply_to_user": {"reputation": 187, "user_id": 4495174, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/f4d37f89eb7a16cfd1a2c364919f5985?s=128&d=identicon&r=PG&f=1", "display_name": "dom176", "link": "https://stackoverflow.com/users/4495174/dom176"}, "edited": false, "score": 0, "creation_date": 1527691923, "post_id": 50607624, "comment_id": 88225149, "body": "@dom176 What is <code>MWS</code> and what is <code>LastMWSR</code>?"}, {"owner": {"reputation": 187, "user_id": 4495174, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/f4d37f89eb7a16cfd1a2c364919f5985?s=128&d=identicon&r=PG&f=1", "display_name": "dom176", "link": "https://stackoverflow.com/users/4495174/dom176"}, "edited": false, "score": 0, "creation_date": 1527692044, "post_id": 50607624, "comment_id": 88225237, "body": "MWS is a worksheet, and LastMWSR is the last row in the worksheet (the preceding code adds more fields to LastMWSR +1 so technically LastMWSR is the second to last row as this point in the code) ."}], "tags": [], "owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "is_accepted": false, "score": 0, "last_activity_date": 1527691615, "creation_date": 1527691615, "answer_id": 50607624, "question_id": 50607446, "link": "https://stackoverflow.com/questions/50607446/inserting-an-application-worksheetfunction-into-a-cell-as-a-formula/50607624#50607624", "title": "Inserting an Application.worksheetfunction into a cell as a formula", "body": "<p>Should be something like this - just note, you need to add a worksheet reference in front of the <code>$A:$A</code>:</p>\n\n<pre><code>Sub Test()\n\nMarkConfirm = \"=IFERROR(VLOOKUP(\" &amp; MWS.Cells(LastMWSR + 1, 3) &amp; \", $A:$A, 1, 0), \"\"Not in Book\"\")\"\nMWS.Cells(LastMWSR + 1, 1).Formula = MarkConfirm\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 33, "user_id": 9869995, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad7026d57e87f00cfedaf37eb3ecb0b2?s=128&d=identicon&r=PG&f=1", "display_name": "Maycl", "link": "https://stackoverflow.com/users/9869995/maycl"}, "is_accepted": false, "score": 0, "last_activity_date": 1527691698, "creation_date": 1527691698, "answer_id": 50607646, "question_id": 50607446, "link": "https://stackoverflow.com/questions/50607446/inserting-an-application-worksheetfunction-into-a-cell-as-a-formula/50607646#50607646", "title": "Inserting an Application.worksheetfunction into a cell as a formula", "body": "<p>Try using the <code>Range.Formula</code> property instead of <code>Range.Value</code>: <a href=\"https://msdn.microsoft.com/en-us/vba/excel-vba/articles/range-formula-property-excel\" rel=\"nofollow noreferrer\">https://msdn.microsoft.com/en-us/vba/excel-vba/articles/range-formula-property-excel</a></p>\n"}, {"tags": [], "owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "is_accepted": false, "score": 0, "last_activity_date": 1527691833, "creation_date": 1527691833, "answer_id": 50607687, "question_id": 50607446, "link": "https://stackoverflow.com/questions/50607446/inserting-an-application-worksheetfunction-into-a-cell-as-a-formula/50607687#50607687", "title": "Inserting an Application.worksheetfunction into a cell as a formula", "body": "<p>Try this. You need to replace HBWS with the relevant sheet name.</p>\n\n<pre><code>MWS.Cells(LastMWSR + 1, 1).Formula = \"=IfError(VLookup(C\" &amp; LastMWSR + 1 &amp; \",HBWS!A:A, 1, 0), \"\"Not in Book\"\"))\"\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 187, "user_id": 4495174, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/f4d37f89eb7a16cfd1a2c364919f5985?s=128&d=identicon&r=PG&f=1", "display_name": "dom176", "link": "https://stackoverflow.com/users/4495174/dom176"}, "edited": false, "score": 0, "creation_date": 1527692246, "post_id": 50607693, "comment_id": 88225383, "body": "That worked perfectly!  Assuming the address function is just filling in that last bit of defining the relevant sheet?"}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "reply_to_user": {"reputation": 187, "user_id": 4495174, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/f4d37f89eb7a16cfd1a2c364919f5985?s=128&d=identicon&r=PG&f=1", "display_name": "dom176", "link": "https://stackoverflow.com/users/4495174/dom176"}, "edited": false, "score": 0, "creation_date": 1527692670, "post_id": 50607693, "comment_id": 88225679, "body": "<code>Address</code> just returns the address of the cell reference.  So  <code>Cells(1,1).Address</code> will return $A$1.  There are various arguments you can add to <code>Address</code> if you want different absolute/relative references - <a href=\"https://msdn.microsoft.com/en-us/vba/excel-vba/articles/range-address-property-excel\" rel=\"nofollow noreferrer\">Range.Address</a>"}], "tags": [], "owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "is_accepted": false, "score": 2, "last_activity_date": 1527692254, "last_edit_date": 1527692254, "creation_date": 1527691853, "answer_id": 50607693, "question_id": 50607446, "link": "https://stackoverflow.com/questions/50607446/inserting-an-application-worksheetfunction-into-a-cell-as-a-formula/50607693#50607693", "title": "Inserting an Application.worksheetfunction into a cell as a formula", "body": "<p>You'll need to add the sheet name to the <code>TableArray</code> argument of the function as it's looking at a different sheet.</p>\n\n<pre><code>MWS.Cells(LastMWSR + 1, 1).Formula = \"=IFERROR(VLOOKUP(\" &amp; MWS.Cells(LastMWSR + 1, 3).Address &amp; \", '\" &amp; HBWS.Name &amp; \"'!\" &amp; HBWS.Range(\"A:A\").Address &amp; \",1,0),\"\"Not in Book\"\")\"  \n</code></pre>\n\n<p>This will give a formula similar to:  </p>\n\n<pre><code>=IFERROR(VLOOKUP($C$19, Sheet2!$A:$A,1,0),\"Not in Book\")  \n</code></pre>\n\n<p>Also note when a string literal is used in the formula the quotes are doubled up:  <code>\"\"Not in Book\"\"</code>  </p>\n\n<p><strong>Edit (after accepted):</strong>  </p>\n\n<p>You could also use the FormulaR1C1 route:  </p>\n\n<pre><code>MWS.Cells(LastMWSR + 2, 1).FormulaR1C1 = \"=IFERROR(VLOOKUP(R\" &amp; LastMWSR + 1 &amp; \"C3,'HBWS_Name'!C1,1,0),\"\"Not In Book\"\")\"\n</code></pre>\n"}], "owner": {"reputation": 187, "user_id": 4495174, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/f4d37f89eb7a16cfd1a2c364919f5985?s=128&d=identicon&r=PG&f=1", "display_name": "dom176", "link": "https://stackoverflow.com/users/4495174/dom176"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 48, "favorite_count": 0, "answer_count": 5, "score": 0, "last_activity_date": 1527692254, "creation_date": 1527691095, "question_id": 50607446, "link": "https://stackoverflow.com/questions/50607446/inserting-an-application-worksheetfunction-into-a-cell-as-a-formula", "title": "Inserting an Application.worksheetfunction into a cell as a formula", "body": "<p>Hello I want the following function  as an actual formula in excel as opposed to a hardcoded number.</p>\n\n<p>Any tips to make that an actual formula that would enter into the appropriate cell in excel? I want it to be able to actively scan my book to detect when something has been removed.</p>\n\n<pre><code>MarkConfirm = Application.WorksheetFunction.IfError(VLookup(MWS.Cells(LastMWSR + 1, 3), HBWS.Range(\"A:A\"), 1, 0), \"Not in Book\")\nMWS.Cells(LastMWSR + 1, 1).Value = MarkConfirm\n</code></pre>\n"}, {"tags": ["excel", "vba", "outlook"], "answers": [{"comments": [{"owner": {"reputation": 7, "user_id": 9864744, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Waleed Malik", "link": "https://stackoverflow.com/users/9864744/waleed-malik"}, "edited": false, "score": 0, "creation_date": 1527704540, "post_id": 50609679, "comment_id": 88232311, "body": "Thank you very much for the help sir. This worked well."}, {"owner": {"reputation": 551, "user_id": 5111757, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Dlhqi.jpg?s=128&g=1", "display_name": "GMan80013", "link": "https://stackoverflow.com/users/5111757/gman80013"}, "reply_to_user": {"reputation": 7, "user_id": 9864744, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Waleed Malik", "link": "https://stackoverflow.com/users/9864744/waleed-malik"}, "edited": false, "score": 0, "creation_date": 1527792434, "post_id": 50609679, "comment_id": 88271745, "body": "Thank you for the feedback.  Please mark this as your answer."}], "tags": [], "owner": {"reputation": 551, "user_id": 5111757, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Dlhqi.jpg?s=128&g=1", "display_name": "GMan80013", "link": "https://stackoverflow.com/users/5111757/gman80013"}, "is_accepted": true, "score": 0, "last_activity_date": 1527792482, "last_edit_date": 1527792482, "creation_date": 1527698270, "answer_id": 50609679, "question_id": 50607265, "link": "https://stackoverflow.com/questions/50607265/how-to-open-an-existing-excel-file/50609679#50609679", "title": "How to open an existing Excel file?", "body": "<p>The code here </p>\n\n<pre><code>Set wkb = xlApp.Workbooks.Add\n</code></pre>\n\n<p>is what opens the new workbook.  Try replacing this line with something like</p>\n\n<pre><code>Set wkb = xlApp.Workbooks.Open(\"C:\\PathToExcel\\File.xlsx\")  \n</code></pre>\n"}], "owner": {"reputation": 7, "user_id": 9864744, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Waleed Malik", "link": "https://stackoverflow.com/users/9864744/waleed-malik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 409, "favorite_count": 0, "accepted_answer_id": 50609679, "answer_count": 1, "score": 0, "last_activity_date": 1592993264, "creation_date": 1527690528, "last_edit_date": 1592993264, "question_id": 50607265, "link": "https://stackoverflow.com/questions/50607265/how-to-open-an-existing-excel-file", "title": "How to open an existing Excel file?", "body": "<p>I am copying a table from Outlook to Excel. The code I have found online copies the table in a new Excel file.</p>\n\n<p>I want to copy the table into an existing Excel file. </p>\n\n<p>Here is the code I am running in Outlook. </p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Sub dd()\nDim item As MailItem, x%\nDim r As Object  'As Word.Range\nDim doc As Object 'As Word.Document\nDim xlApp As Object, wkb As Object\nSet xlApp = CreateObject(\"Excel.Application\")\nSet wkb = xlApp.Workbooks.Add\nxlApp.Visible = True\n\nDim wks As Object\nSet wks = wkb.Sheets(1)\n\nFor Each item In Application.ActiveExplorer.Selection\n    Set doc = item.GetInspector.WordEditor\n    For x = 1 To doc.Tables.Count\n        Set r = doc.Tables(x)\n        r.Range.Copy\n        wks.Paste\n        wks.Cells(wks.Rows.Count, 1).End(3).Offset(1).Select\n    Next\nNext\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "edited": false, "score": 1, "creation_date": 1527690749, "post_id": 50607172, "comment_id": 88224302, "body": "I would check out the Transpose function - simpler to use - one example here - come back afterwards with code you&#39;ve tried <a href=\"https://stackoverflow.com/a/8852772/2419128\">stackoverflow.com/a/8852772/2419128</a>"}, {"owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "edited": false, "score": 0, "creation_date": 1527692825, "post_id": 50607172, "comment_id": 88225792, "body": "Show the code you&#39;ve already tried and we can help you work out the exact problem you&#39;re having."}, {"owner": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "edited": false, "score": 0, "creation_date": 1527706267, "post_id": 50607172, "comment_id": 88233112, "body": "@Mark-Saluta - Added an approach via a datafield array and a reverse loop (better performance than looping through a range)."}], "answers": [{"comments": [{"owner": {"reputation": 547, "user_id": 1551972, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/PblyO.jpg?s=128&g=1", "display_name": "Mark Saluta", "link": "https://stackoverflow.com/users/1551972/mark-saluta"}, "edited": false, "score": 0, "creation_date": 1527769331, "post_id": 50608162, "comment_id": 88258224, "body": "I attempted this. I was able to get the data shifted from horizontally laid out in rows, to vertically, similar to how I&#39;m trying to get it, but wasn&#39;t able to get the titles in cells to the left of the data."}, {"owner": {"reputation": 4047, "user_id": 3246362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6da9a197d0f0e5f19875d8a97550e58e?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/3246362/sam"}, "reply_to_user": {"reputation": 547, "user_id": 1551972, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/PblyO.jpg?s=128&g=1", "display_name": "Mark Saluta", "link": "https://stackoverflow.com/users/1551972/mark-saluta"}, "edited": false, "score": 0, "creation_date": 1527769657, "post_id": 50608162, "comment_id": 88258430, "body": "Did you select all columns? After step 5, what formula do you have? Something like <code>=Table.Unpivot...</code>?"}], "tags": [], "owner": {"reputation": 4047, "user_id": 3246362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6da9a197d0f0e5f19875d8a97550e58e?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/3246362/sam"}, "is_accepted": false, "score": 0, "last_activity_date": 1527693171, "creation_date": 1527693171, "answer_id": 50608162, "question_id": 50607172, "link": "https://stackoverflow.com/questions/50607172/iterate-through-save-and-format-cells-in-vba/50608162#50608162", "title": "Iterate Through, Save, and Format Cells in VBA", "body": "<p>You can do some interesting stuff with Excel's Get &amp; Transform functions. First - here are the manual steps:</p>\n\n<ol>\n<li>Add a row as header with column names</li>\n<li>Select the table and press <kbd>Ctrl</kbd>+<kbd>T</kbd> to create a table</li>\n<li>On the Data Tab, click <em>From Table</em></li>\n<li>In the new editor that pops up, select all columns</li>\n<li>On the Transform tab, click Unpivot</li>\n<li>Save and exit</li>\n</ol>\n\n<p>This isn't as straight forward as a macro, but Get &amp; Transform is very powerful in cases like this.</p>\n"}, {"comments": [{"owner": {"reputation": 547, "user_id": 1551972, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/PblyO.jpg?s=128&g=1", "display_name": "Mark Saluta", "link": "https://stackoverflow.com/users/1551972/mark-saluta"}, "edited": false, "score": 0, "creation_date": 1527696444, "post_id": 50609078, "comment_id": 88228041, "body": "Thanks for that. I ran this code and it came back with &quot;That name is already taken. Try a different one.&quot; on the line:     .Sheets.Add(After:=.Sheets(.Sheets.Count)).Name = sh_template"}, {"owner": {"reputation": 1236, "user_id": 9839748, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sUzkp.jpg?s=128&g=1", "display_name": "JC Guidicelli", "link": "https://stackoverflow.com/users/9839748/jc-guidicelli"}, "reply_to_user": {"reputation": 547, "user_id": 1551972, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/PblyO.jpg?s=128&g=1", "display_name": "Mark Saluta", "link": "https://stackoverflow.com/users/1551972/mark-saluta"}, "edited": false, "score": 0, "creation_date": 1527700512, "post_id": 50609078, "comment_id": 88230180, "body": "Try to change the var sh_template to &#39;&#39;template2&#39;&#39; : Dim sh_template As String sh_template = &quot;template2&quot;.  Also, try to put the code in a new module."}, {"owner": {"reputation": 547, "user_id": 1551972, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/PblyO.jpg?s=128&g=1", "display_name": "Mark Saluta", "link": "https://stackoverflow.com/users/1551972/mark-saluta"}, "edited": false, "score": 0, "creation_date": 1527701618, "post_id": 50609078, "comment_id": 88230821, "body": "I receive the same thing."}], "tags": [], "owner": {"reputation": 1236, "user_id": 9839748, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sUzkp.jpg?s=128&g=1", "display_name": "JC Guidicelli", "link": "https://stackoverflow.com/users/9839748/jc-guidicelli"}, "is_accepted": false, "score": 0, "last_activity_date": 1527696039, "creation_date": 1527696039, "answer_id": 50609078, "question_id": 50607172, "link": "https://stackoverflow.com/questions/50607172/iterate-through-save-and-format-cells-in-vba/50609078#50609078", "title": "Iterate Through, Save, and Format Cells in VBA", "body": "<p>Could you try this code. \nI suppose that your data is in a sheet \"data\".</p>\n\n<pre><code>Sub test()\nApplication.DisplayAlerts = False\n\nDim sh_final As String\nsh_final = \"final\"\n\nDim sh_data As String\nsh_data = \"data\" 'change if different\n\nDim sh_template As String\nsh_template = \"template\"\n\n\n'create sheet template\nDim ws As Worksheet\nFor Each ws In Worksheets\n    If ws.Name = sh_template Then\n    ws.Delete\n    End If\nNext ws\n\n With ThisWorkbook\n     .Sheets.Add(After:=.Sheets(.Sheets.Count)).Name = sh_template\n End With\nWith ThisWorkbook.Sheets(sh_template)\n     .Range(\"A1\").Value = \"Name :\"\n     .Range(\"A2\").Value = \"Date Starting:\"\n     .Range(\"A3\").Value = \"Employee ID#:\"\n     .Range(\"A4\").Value = \"Title :\"\n     .Range(\"A5\").Value = \"Supervisor:\"\n     .Range(\"A6\").Value = \"Bus Ctr:\"\n     .Range(\"A7\").Value = \"Location:\"\n End With\n\n'create sheet final\nFor Each ws In Worksheets\n    If ws.Name = sh_final Then\n    ws.Delete\n    End If\nNext ws\n With ThisWorkbook\n     .Sheets.Add(After:=.Sheets(.Sheets.Count)).Name = sh_final\n End With\n\n'Copy data from sheet data\n    For i = 1 To ThisWorkbook.Sheets(sh_data).Range(\"A\" &amp; ThisWorkbook.Sheets(sh_data).Rows.Count).End(xlUp).Row\n\n    LastRow = ThisWorkbook.Sheets(sh_final).Range(\"A\" &amp; ThisWorkbook.Sheets(sh_final).Rows.Count).End(xlUp).Row + 1\n\n    'Copy the template\n    With ThisWorkbook.Sheets(sh_template)\n    .Activate\n    .Range(\"A1:A7\").Copy\n    End With\n\n    With ThisWorkbook.Sheets(sh_final)\n    .Activate\n    .Range(\"A\" &amp; LastRow).Select\n    End With\n    ActiveSheet.Paste\n\n    'copy the data\n    With ThisWorkbook.Sheets(sh_data)\n        .Activate\n        .Range(\"A\" &amp; i &amp; \":G\" &amp; i).Copy\n    End With\n\n    With ThisWorkbook.Sheets(sh_final)\n        .Activate\n        .Range(\"B\" &amp; LastRow).Select\n    End With\n    Selection.PasteSpecial Paste:=xlPasteAll, Operation:=xlNone, SkipBlanks:= _\n        False, Transpose:=True\n\n    Next i\n\n\nApplication.DisplayAlerts = True\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "is_accepted": true, "score": 0, "last_activity_date": 1527709611, "last_edit_date": 1527709611, "creation_date": 1527705668, "answer_id": 50611484, "question_id": 50607172, "link": "https://stackoverflow.com/questions/50607172/iterate-through-save-and-format-cells-in-vba/50611484#50611484", "title": "Iterate Through, Save, and Format Cells in VBA", "body": "<p><strong>Approach via transposed datafield array</strong></p>\n\n<p>Get data via a <strong>transposed datafield array</strong> (rows and columns changed), <em>rearrange</em> the array structure once after a <strong>reverse loop</strong> (within the same array) and write the array back to a target sheet:</p>\n\n<p><strong>Code example</strong></p>\n\n<p>This code example assumes you have a <strong>header line</strong> in row <code>1:1</code> in your data sheet:</p>\n\n<pre><code>Option Explicit                                      ' declaration head of your code module\n\nSub Iterate()\n  Dim i As Long, j As Long, n As Long\n  Dim nCol As Long, sCol As String\n  Dim v                                               ' short for Dim v As Variant\n  Dim ws As Worksheet, ws2 As Worksheet\n\n  Set ws = ThisWorkbook.Worksheets(\"MyData\")          ' &lt;&lt; change to data sheet name\n  Set ws2 = ThisWorkbook.Worksheets(\"MyTarget\")       ' &lt;&lt; change to target sheet name\n' [1] get last row in column A containing data\n   n = ws.Range(\"A\" &amp; ws.Rows.Count).End(xlUp).Row\n' [2] count header columns A:G (=7) and add one column to receive free line\n   nCol = 7 + 1          ' nCol = ws.Cells(1, ws.Columns.Count).End(xlToLeft).Column + 1\n' [3] get column letter after multiplication of rows with nCol\n   sCol = Split(Cells(1, (n - 1) * nCol).Address, \"$\")(1)\n' [4] get values to transposed one based 2dim array\n   v = Application.Transpose(ws.Range(\"A1:\" &amp; sCol &amp; n).Value)\n' [5] rearrange data by reverse loop\n  For i = n To 2 Step -1\n     For j = 1 To nCol\n       ' assign header (col 1) and data (col 2) to array items\n         v((i - 2) * nCol + j, 1) = v(j, 1)  ' header\n         v((i - 2) * nCol + j, 2) = v(j, i)  ' data\n     Next j\n  Next i\n' [6] write back to target sheet\n  ws2.Range(\"A:B\") = \"\"                         ' clear columns A:B in target sheet\n  ReDim Preserve v(1 To UBound(v), 2)           ' redim array to 2 columns\n  ws2.Range(\"A1\").Resize(UBound(v), 2) = v      ' write back\nEnd Sub\n</code></pre>\n\n<p><strong>Notes</strong></p>\n\n<p>Usually the (not yet transposed) datafield array would contain <code>n</code> data rows and <code>nCol</code> columns.\nAs this example tries to <strong>reuse the original array</strong>, the data range gets greater to include all items multiplied by 8 <em>(i.e. 7 columns plus an empty one)</em>. </p>\n\n<ul>\n<li>As the data range will be transposed, columns change to rows. </li>\n<li>As the total lines have to contain the product rows (n-1, i.e. without header line) * 8, it's necessary to define a greater column range to receive a greater array for later rearrangement - see section [3] with definition of a column letter.</li>\n<li>The array item <code>v((i - 2) * nCol + j,</code><strong>2</strong><code>)</code> rearranges the data items only in column <strong>2</strong> to write them back later to target sheet column <code>B</code>. The new row index <code>((i</code><strong>- 2</strong><code>) * nCol + j</code> has to calculate <code>i-2</code> considering the header line (-1) as well as a start from zero (-1), multiplied by <code>nCol</code> plus column <code>j</code>.  </li>\n</ul>\n"}], "owner": {"reputation": 547, "user_id": 1551972, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/PblyO.jpg?s=128&g=1", "display_name": "Mark Saluta", "link": "https://stackoverflow.com/users/1551972/mark-saluta"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 147, "favorite_count": 0, "accepted_answer_id": 50611484, "answer_count": 3, "score": -1, "last_activity_date": 1527709611, "creation_date": 1527690273, "last_edit_date": 1527691358, "question_id": 50607172, "link": "https://stackoverflow.com/questions/50607172/iterate-through-save-and-format-cells-in-vba", "title": "Iterate Through, Save, and Format Cells in VBA", "body": "<p>I have an automated report that generates a table of values that need to be iterated through and saved to a different format.</p>\n\n<p>Here is the table:</p>\n\n<pre><code>John Smith      5/26/2018   12345   IT Pro     John Gault   Permitting  Sarasota\nWinston Smith   5/30/2018   54321   Henchman   Bob          Licensing   Oceania\n</code></pre>\n\n<p>The format that I'm looking to get that information to is the following:</p>\n\n<pre><code>Name:   John Smith\nDate Starting:  5/26/2018\nEmployee ID#:   12345\nTitle:  IT PRO\nSupervisor: John Gault\nBus Ctr:    Permitting\nLocation:   Oceania\n\nName:   Winston Smith\nDate Starting:  5/30/2018\nEmployee ID#:   54321\nTitle:  Henchman\nSupervisor: Bob\nBus Ctr:    Licensing\nLocation:   Oceania\n</code></pre>\n\n<p>The amount of employees on the report will change on a given day, so I believe a For Each is in order, something to the effect of:</p>\n\n<pre><code>For Each Cell In ActiveSheet.UsedRange.Cells\n</code></pre>\n\n<p>I'm just uncertain what to put into the For loop. </p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 3, "creation_date": 1527690345, "post_id": 50607087, "comment_id": 88223989, "body": "Is is useful if your environment includes several sources for the functions.  It also removes ambiguities like<code>TRIM()</code> vs <code>Application.Trim()</code>"}], "answers": [{"tags": [], "owner": {"reputation": 2630, "user_id": 5749062, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/72aMs.png?s=128&g=1", "display_name": "Bill Hileman", "link": "https://stackoverflow.com/users/5749062/bill-hileman"}, "is_accepted": true, "score": 9, "last_activity_date": 1527690352, "creation_date": 1527690352, "answer_id": 50607195, "question_id": 50607087, "link": "https://stackoverflow.com/questions/50607087/vba-prefix-for-example-vba-randomize-vs-randomize-whats-the-difference/50607195#50607195", "title": "&quot;VBA.&quot; prefix, for example VBA.Randomize vs Randomize, what&#39;s the difference?", "body": "<p>VBA is a reference library which tells the compiler to specifically use the VBA-specific implementation of the method or function which follows.</p>\n\n<p>The reason for this is because there might be other referenced libraries which might have priority by default, and the coder does not know what references you might have or in which order they are.</p>\n\n<p>If you had some other implementation of Randomize and it was higher-up in the order of references, the compiler would expect the parameters to match that particular implementation's format and also use that particular bit of code.</p>\n\n<p>Placing <code>VBA.</code> in front of VBA keywords merely ensures that the version that will be used is the one that the author intended and not some other version.</p>\n"}, {"tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": false, "score": 4, "last_activity_date": 1527690361, "creation_date": 1527690361, "answer_id": 50607198, "question_id": 50607087, "link": "https://stackoverflow.com/questions/50607087/vba-prefix-for-example-vba-randomize-vs-randomize-whats-the-difference/50607198#50607198", "title": "&quot;VBA.&quot; prefix, for example VBA.Randomize vs Randomize, what&#39;s the difference?", "body": "<p>Just one way to make totally sure that if anyone has the very bad idea to use <code>Randomize</code> as a user defined function/procedure name like:</p>\n\n<pre><code>Public Sub Randomize()\n    'do fancy stuff\nEnd Sub\n</code></pre>\n\n<p>That <code>VBA.Randomize</code> will still call the correct function and not the user defined.</p>\n"}], "owner": {"reputation": 2031, "user_id": 6097926, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/187bc2674bbdf7651e7137e1427b9bd6?s=128&d=identicon&r=PG&f=1", "display_name": "Ryszard J\u0119draszyk", "link": "https://stackoverflow.com/users/6097926/ryszard-j%c4%99draszyk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 76, "favorite_count": 0, "accepted_answer_id": 50607195, "answer_count": 2, "score": 4, "last_activity_date": 1578734598, "creation_date": 1527690001, "last_edit_date": 1578734598, "question_id": 50607087, "link": "https://stackoverflow.com/questions/50607087/vba-prefix-for-example-vba-randomize-vs-randomize-whats-the-difference", "title": "&quot;VBA.&quot; prefix, for example VBA.Randomize vs Randomize, what&#39;s the difference?", "body": "<p>I've just checked some GitHub code and it was full of statements preceded by \"VBA.\", which work just fine without it.</p>\n\n<p>What's the reason behind adding \"VBA.\"?</p>\n"}, {"tags": ["vba", "excel", "optimization"], "comments": [{"owner": {"reputation": 1505, "user_id": 9663006, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nXPmC.jpg?s=128&g=1", "display_name": "Samuel Everson", "link": "https://stackoverflow.com/users/9663006/samuel-everson"}, "edited": false, "score": 1, "creation_date": 1527690297, "post_id": 50607065, "comment_id": 88223954, "body": "One tip is to add <code>Application.ScreenUpdating = False</code> at the beginning of your code and then <code>Application.ScreenUpdating = True</code> at the end. See <a href=\"https://stackoverflow.com/questions/47089741/how-to-speed-up-vba-code?utm_medium=organic&amp;utm_source=google_rich_qa&amp;utm_campaign=google_rich_qa\">here for some more pointers on speeding up your code</a>"}, {"owner": {"reputation": 1505, "user_id": 9663006, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nXPmC.jpg?s=128&g=1", "display_name": "Samuel Everson", "link": "https://stackoverflow.com/users/9663006/samuel-everson"}, "edited": false, "score": 1, "creation_date": 1527690402, "post_id": 50607065, "comment_id": 88224041, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/47089741/how-to-speed-up-vba-code\">How To Speed Up VBA Code</a>"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1527690412, "post_id": 50607065, "comment_id": 88224051, "body": "you can definitely clean the code to be more efficient. you have many superfluous if statements. I will post an answer in a few moments."}, {"owner": {"reputation": 659, "user_id": 5202456, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rHy4s.jpg?s=128&g=1", "display_name": "5202456", "link": "https://stackoverflow.com/users/5202456/5202456"}, "edited": false, "score": 1, "creation_date": 1527690572, "post_id": 50607065, "comment_id": 88224185, "body": "Why not import all the filenames into a sheet and then sort the data from there, it will be much quicker then doing it on the fly:  <a href=\"https://stackoverflow.com/a/44068091/5202456\">stackoverflow.com/a/44068091/5202456</a> (this code even calculates the time it took to import the data)"}], "answers": [{"comments": [{"owner": {"reputation": 5, "user_id": 9824735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/db70cccda07c11bc471ccac814559db2?s=128&d=identicon&r=PG&f=1", "display_name": "Astarngo", "link": "https://stackoverflow.com/users/9824735/astarngo"}, "edited": false, "score": 0, "creation_date": 1527693787, "post_id": 50607733, "comment_id": 88226428, "body": "It seems to not be able to find any files, neither the Model files nor the Drawing files. How does it check the files against each other? How does it accommodate for the different file extensions?"}, {"owner": {"reputation": 5, "user_id": 9824735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/db70cccda07c11bc471ccac814559db2?s=128&d=identicon&r=PG&f=1", "display_name": "Astarngo", "link": "https://stackoverflow.com/users/9824735/astarngo"}, "edited": false, "score": 0, "creation_date": 1527694332, "post_id": 50607733, "comment_id": 88226760, "body": "<a href=\"https://postimg.cc/image/utdirxsi5/\" rel=\"nofollow noreferrer\">tempsnip.png</a> The two right most columns are the output I am getting from the new script"}, {"owner": {"reputation": 5, "user_id": 9824735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/db70cccda07c11bc471ccac814559db2?s=128&d=identicon&r=PG&f=1", "display_name": "Astarngo", "link": "https://stackoverflow.com/users/9824735/astarngo"}, "edited": false, "score": 0, "creation_date": 1527705075, "post_id": 50607733, "comment_id": 88232526, "body": "I think the problem is that I do not have the file extensions of the part numbers on the Excel file"}, {"owner": {"reputation": 5, "user_id": 9824735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/db70cccda07c11bc471ccac814559db2?s=128&d=identicon&r=PG&f=1", "display_name": "Astarngo", "link": "https://stackoverflow.com/users/9824735/astarngo"}, "edited": false, "score": 0, "creation_date": 1527706954, "post_id": 50607733, "comment_id": 88233452, "body": "Thanks a bunch for your help so far! The drawing part of the updated code seems to work, but the Model column shows up as all &#39;Y&#39; now"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "reply_to_user": {"reputation": 5, "user_id": 9824735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/db70cccda07c11bc471ccac814559db2?s=128&d=identicon&r=PG&f=1", "display_name": "Astarngo", "link": "https://stackoverflow.com/users/9824735/astarngo"}, "edited": false, "score": 0, "creation_date": 1527769249, "post_id": 50607733, "comment_id": 88258159, "body": "@Astarngo - Fixed that. I forgot to set <code>maCheck</code> back to false after using the condition for each test. (Reason all were yes was because first file was found, variable was set to true and never reset back to false for future tests, so it stayed true)."}, {"owner": {"reputation": 5, "user_id": 9824735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/db70cccda07c11bc471ccac814559db2?s=128&d=identicon&r=PG&f=1", "display_name": "Astarngo", "link": "https://stackoverflow.com/users/9824735/astarngo"}, "edited": false, "score": 0, "creation_date": 1527857266, "post_id": 50607733, "comment_id": 88297777, "body": "Right, I had figured that out too. Thanks for the help!"}], "tags": [], "owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "is_accepted": true, "score": 0, "last_activity_date": 1527769185, "last_edit_date": 1527769185, "creation_date": 1527691947, "answer_id": 50607733, "question_id": 50607065, "link": "https://stackoverflow.com/questions/50607065/excel-vba-loop-runs-well-for-small-data-sets-but-takes-exponentially-longer-wit/50607733#50607733", "title": "Excel VBA loop runs well for small data sets, but takes exponentially longer with larger data sets", "body": "<p>By using the built in FileSystemObject you can check if a file exists in a given path directly, so no need to loop through the file list for each cell. </p>\n\n<p>Give this a whirl and see if it helps, significantly shortened code, improved readability and made the processor work less :)</p>\n\n<pre><code>Option Explicit\n\nSub scanDirectory()\n\n    Application.ScreenUpdating = False\n\n    Dim path As String\n    'put the path to your folder here along with an \\\n    path = \"\\C:\\Users\\joe.blow\\Documents\\\"\n\n    Dim counterA As Integer\n    counterA = 8\n\n    Do Until counterA &gt; 4294\n\n        'grab file name from cell\n        Dim nameOfFile As String\n        nameOfFile = Sheets(\"Sheet0\").Cells(counterA, 2)\n\n        Dim fso As New FileSystemObject 'be sure to check Microsoft Scripting Runtime in Tools &gt; References\n\n        'check for Drawing\n        Sheets(\"Sheet0\").Cells(counterA, 6).Value = IIf(fso.FileExists(path + nameOfFile + \".SLDDRW\"), \"Y\", \"N\")\n\n        'check for Model or Assembly\n        Dim maCheck As Boolean\n        If fso.FileExists(path + nameOfFile + \".SLDPRT\") Or fso.FileExists(path + nameOfFile + \".SLDASM\") Then maCheck = True\n\n        Sheets(\"Sheet0\").Cells(counterA, 5).Value = IIf(maCheck, \"Y\", \"N\")\n        maCheck = False\n\n        counterA = counterA + 1\n\n    Loop  'NextLine\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 5, "user_id": 9824735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/db70cccda07c11bc471ccac814559db2?s=128&d=identicon&r=PG&f=1", "display_name": "Astarngo", "link": "https://stackoverflow.com/users/9824735/astarngo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 99, "favorite_count": 0, "accepted_answer_id": 50607733, "answer_count": 1, "score": 0, "last_activity_date": 1527769185, "creation_date": 1527689950, "question_id": 50607065, "link": "https://stackoverflow.com/questions/50607065/excel-vba-loop-runs-well-for-small-data-sets-but-takes-exponentially-longer-wit", "title": "Excel VBA loop runs well for small data sets, but takes exponentially longer with larger data sets", "body": "<p>I have created a macro in VBA that is supposed to check part numbers on an excel sheet vs the filenames of parts in a file directory. The script is this:</p>\n\n<pre><code>Sub scanDirectory()\n\n    Dim path As String\n    Dim currentPath As String\n    Dim nameOfFile As String\n    Dim counterA As Integer\n    Dim success As Integer\n    Dim endTester As String\n    Dim draw As Integer\n    'put the path to your folder here along with an \\\n    path = \"\\C:\\Users\\joe.blow\\Documents\\\"\n\n    counterA = 8\n    Do Until counterA &gt; 4294\n        nameOfFile = Sheets(\"Sheet0\").Cells(counterA, 2)\n\n        currentPath = Dir(path)\n        success = 0\n        draw = 0\n        Do Until currentPath = vbNullString\n            Debug.Print currentPath\n\n            'Success for Model\n            endTester = nameOfFile + \".SLDPRT\"\n            If currentPath = endTester Then\n                Sheets(\"Sheet0\").Cells(counterA, 5) = \"Y\"\n                success = 1\n            End If\n            endTester = nameOfFile + \".sldprt\"\n            If currentPath = endTester Then\n                Sheets(\"Sheet0\").Cells(counterA, 5) = \"Y\"\n                success = 1\n            End If\n\n            'Success for Assembly\n            endTester = nameOfFile + \".SLDASM\"\n            If currentPath = endTester Then\n                Sheets(\"Sheet0\").Cells(counterA, 5) = \"Y\"\n                success = 1\n            End If\n\n            'Succees for Drawing\n            endTester = nameOfFile + \".SLDDRW\"\n            If currentPath = endTester Then\n                Sheets(\"Sheet0\").Cells(counterA, 6) = \"Y\"\n                draw = 1\n            End If\n            endTester = nameOfFile + \".slddrw\"\n            If currentPath = endTester Then\n                Sheets(\"Sheet0\").Cells(counterA, 6) = \"Y\"\n                draw = 1\n            End If\n\n            If draw = 0 Then\n                Sheets(\"Sheet0\").Cells(counterA, 6) = \"N\"\n            End If\n\n            If success = 0 Then\n                Sheets(\"Sheet0\").Cells(counterA, 5) = \"N\"\n            End If\n\n            currentPath = Dir()\n        Loop\n    counterA = counterA + 1\n    Loop  'NextLine' End Sub\n</code></pre>\n\n<p>It works by going line by line and checking each cell vs the entire file tree, checking every permutation of filename extension. It then puts in an empty column if the file is there or not with a corresponding 'Y' or 'N'. It does this with both Models AND Drawings at the same time.</p>\n\n<p>It works great for data sets &lt;100 but my lists are sometimes 9000+ items long. When I run this on those longer sheets, it will run fine for ~5 seconds, then become unresponsive and (Not Responding). If I then wait for a long time >1hr, then it will finish running even though it was \"Not Responding\". Is there any better way to run this so that it will not take as long or </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 0, "creation_date": 1527690056, "post_id": 50606975, "comment_id": 88223777, "body": "If you have multiple <code>Id</code>s for a single <code>Job</code>, will there always be a single space between them or are they in separate cells ??"}, {"owner": {"reputation": 1, "user_id": 9870722, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-MEm35ABPKyw/AAAAAAAAAAI/AAAAAAAAADA/5iUEySi5I3g/photo.jpg?sz=128", "display_name": "david ", "link": "https://stackoverflow.com/users/9870722/david"}, "reply_to_user": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 0, "creation_date": 1527690487, "post_id": 50606975, "comment_id": 88224117, "body": "There&#39;s a single space, but I can always split the cells first (if that makes the coding easier)"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1527691587, "post_id": 50606975, "comment_id": 88224875, "body": "Your StaffSub function seems redundant. If you are calling a function from the sheet it cannot change anything other than the cell in which it is placed."}, {"owner": {"reputation": 1, "user_id": 9870722, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-MEm35ABPKyw/AAAAAAAAAAI/AAAAAAAAADA/5iUEySi5I3g/photo.jpg?sz=128", "display_name": "david ", "link": "https://stackoverflow.com/users/9870722/david"}, "edited": false, "score": 0, "creation_date": 1527692087, "post_id": 50606975, "comment_id": 88225270, "body": "OK, great - how do I run the <i>sub</i> then? I&#39;ve tried call StaffReplaceAll(B2,A2) within excel and...nothing..."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1527693765, "post_id": 50606975, "comment_id": 88226415, "body": "You can&#39;t call StaffReplaceAll from the sheet because it&#39;s a sub not a function. You need to call the sub from another sub."}, {"owner": {"reputation": 1, "user_id": 9870722, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-MEm35ABPKyw/AAAAAAAAAAI/AAAAAAAAADA/5iUEySi5I3g/photo.jpg?sz=128", "display_name": "david ", "link": "https://stackoverflow.com/users/9870722/david"}, "edited": false, "score": 0, "creation_date": 1527695317, "post_id": 50606975, "comment_id": 88227388, "body": "OK, please point me somewhere - I only started using VBA this week. This issue &quot;can&#39;t call StaffReplaceAll&quot; was why I came up with the StaffSub function, but I was told (above) that I don&#39;t do it that way...I&#39;m lost!"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 9870722, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-MEm35ABPKyw/AAAAAAAAAAI/AAAAAAAAADA/5iUEySi5I3g/photo.jpg?sz=128", "display_name": "david ", "link": "https://stackoverflow.com/users/9870722/david"}, "edited": false, "score": 0, "creation_date": 1527696059, "post_id": 50609032, "comment_id": 88227801, "body": "Thank you! (Great tip on .Replace - I did not know that!). Now, as you can see, I am a complete newbie. How do I call this sub from excel? thanks"}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "reply_to_user": {"reputation": 1, "user_id": 9870722, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-MEm35ABPKyw/AAAAAAAAAAI/AAAAAAAAADA/5iUEySi5I3g/photo.jpg?sz=128", "display_name": "david ", "link": "https://stackoverflow.com/users/9870722/david"}, "edited": false, "score": 0, "creation_date": 1527696168, "post_id": 50609032, "comment_id": 88227861, "body": "@david  See my <b>EDIT#1</b>"}, {"owner": {"reputation": 1, "user_id": 9870722, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-MEm35ABPKyw/AAAAAAAAAAI/AAAAAAAAADA/5iUEySi5I3g/photo.jpg?sz=128", "display_name": "david ", "link": "https://stackoverflow.com/users/9870722/david"}, "edited": false, "score": 0, "creation_date": 1527708667, "post_id": 50609032, "comment_id": 88234239, "body": "Thank you so much. That a) works, and b) I understand why - really appreciate your help (the links are great to).  cheers"}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 0, "last_activity_date": 1527696143, "last_edit_date": 1527696143, "creation_date": 1527695874, "answer_id": 50609032, "question_id": 50606975, "link": "https://stackoverflow.com/questions/50606975/using-replace-to-undo-ids/50609032#50609032", "title": "Using .Replace to undo IDs", "body": "<p>Here I am assuming that on the <em>IDsheet</em>, each <code>Id</code> is in its own cell and this block of <code>Id</code>s goes from <strong>B2</strong> to at most <strong>Z100</strong>.  The code:</p>\n\n<pre><code>Sub david()\n    Dim i As Long, N As Long, r As Range, v1 As String, v2 As String\n    With Sheets(\"Workers\")\n        N = .Cells(Rows.Count, \"A\").End(xlUp).Row\n        For i = 2 To N\n            v1 = .Cells(i, \"A\")\n            v2 = .Cells(i, \"B\")\n            For Each r In Sheets(\"IDsheet\").Range(\"B2:Z100\")\n                If r.Value = v2 Then r.Value = v1\n            Next r\n        Next i\n    End With\nEnd Sub\n</code></pre>\n\n<p>With <em>Workers</em> like:</p>\n\n<p><a href=\"https://i.stack.imgur.com/HqkOC.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/HqkOC.png\" alt=\"enter image description here\"></a></p>\n\n<p>The <em>IDsheet</em> is transformed into:</p>\n\n<p><a href=\"https://i.stack.imgur.com/aaba4.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/aaba4.png\" alt=\"enter image description here\"></a></p>\n\n<p>I am not using <strong>.Replace</strong> because string like <em>S15</em> will match both <em>S1</em> and <em>S15</em>.  I am using individual cells for the <code>Id</code>s for similar reasons.</p>\n\n<p><strong>EDIT#1:</strong></p>\n\n<p>Macros are very easy to install and use:</p>\n\n<ol>\n<li>ALT-F11  brings up the VBE window</li>\n<li>ALT-I\nALT-M opens a fresh module</li>\n<li>paste the stuff in and close the VBE window</li>\n</ol>\n\n<p>If you save the workbook, the macro will be saved with it.\nIf you are using a version of Excel later then 2003, you must save\nthe file as .xlsm rather than .xlsx</p>\n\n<p>To remove the macro:</p>\n\n<ol>\n<li>bring up the VBE window as above</li>\n<li>clear the code out</li>\n<li>close the VBE window</li>\n</ol>\n\n<p>To use the macro from Excel:</p>\n\n<ol>\n<li>ALT-F8</li>\n<li>Select the macro</li>\n<li>Touch RUN</li>\n</ol>\n\n<p>To learn more about macros in general, see:</p>\n\n<p><a href=\"http://www.mvps.org/dmcritchie/excel/getstarted.htm\" rel=\"nofollow noreferrer\">http://www.mvps.org/dmcritchie/excel/getstarted.htm</a></p>\n\n<p>and</p>\n\n<p><a href=\"http://msdn.microsoft.com/en-us/library/ee814735(v=office.14).aspx\" rel=\"nofollow noreferrer\">http://msdn.microsoft.com/en-us/library/ee814735(v=office.14).aspx</a></p>\n\n<p><strong>Macros must be enabled for this to work!</strong></p>\n"}], "owner": {"reputation": 1, "user_id": 9870722, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-MEm35ABPKyw/AAAAAAAAAAI/AAAAAAAAADA/5iUEySi5I3g/photo.jpg?sz=128", "display_name": "david ", "link": "https://stackoverflow.com/users/9870722/david"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 29, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1527696143, "creation_date": 1527689711, "last_edit_date": 1527691450, "question_id": 50606975, "link": "https://stackoverflow.com/questions/50606975/using-replace-to-undo-ids", "title": "Using .Replace to undo IDs", "body": "<p>first time posting here, so apologies if my format is not correct.\nHere's my problem (see below at my attempt to solve):\nI have a list of jobs, with IDs of workers assigned to them.\nex. in one sheet \"IDsheet\"</p>\n\n<pre><code>Job       Id\n\nM1       S1 S4\n\nM2       S15\n\nM3       S2\n\nM4       S6          etc\n</code></pre>\n\n<p>In another sheet \"Workers\" I have</p>\n\n<pre><code>Name    ID\n\nAndy    S1\n\nDave    S2\n\nHilda   S3\n\nKerri   S4            etc\n</code></pre>\n\n<p>I am attempting (failing) to write a little bit of VBA for excel so that I can Replace all S1, S2 etc with the correct \"Name\".</p>\n\n<p>I looked around here and I thought I had found the necessary bit of code, but I have implemented it wrong and my lack of VBA knowledge is probably making me call it incorrectly. </p>\n\n<p>My sub procedure is:</p>\n\n<p>**</p>\n\n<pre><code>Sub StaffReplaceAll(code As String, staffid As String)\n\nDim fnd As String\nDim rplc As String\n\nfnd = code\nrplc = staffid\n\nWorksheets(\"IDsheet\").Cells.Replace _\nwhat:=fnd, Replacement:=rplc, _\nLookAt:=xlPart, SearchOrder:=xlByColumns, MatchCase:=True, _\nSearchFormat:=False, ReplaceFormat:=False\n\nEnd Sub\n</code></pre>\n\n<p>**</p>\n\n<p>and my calling function is:</p>\n\n<p>**</p>\n\n<pre><code>Function StaffSub(inval As String, outval As String) As Integer\n\nCall StaffReplaceAll(inval, outval)\n\nEnd Function\n</code></pre>\n\n<p>**</p>\n\n<p>Where I call \"StaffSub\" I get #VALUE! error, and the IDsheet is unchanged.</p>\n\n<p>Thanks in advance for any help. BTW: I have also looked at using Vlookup, but I'm not sure that really fits with what I am doing here, also saw \n<a href=\"https://stackoverflow.com/questions/9283972/replacing-excel-data-using-another-spreadsheet\">This Page</a> but that just confused me!</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1527689717, "post_id": 50606808, "comment_id": 88223529, "body": "Does value ever exceed the limits of <code>Long</code> variable type?"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 1, "creation_date": 1527689910, "post_id": 50606808, "comment_id": 88223672, "body": "Also, does H3 or beyond actually have data in it? Because if not, the code will be processing the <i>entire rowset of Excel</i>, which will most likely cause that error."}], "answers": [{"tags": [], "owner": {"reputation": 6533, "user_id": 8466523, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JNrm6.jpg?s=128&g=1", "display_name": "Olly", "link": "https://stackoverflow.com/users/8466523/olly"}, "is_accepted": false, "score": 2, "last_activity_date": 1527689683, "creation_date": 1527689683, "answer_id": 50606961, "question_id": 50606808, "link": "https://stackoverflow.com/questions/50606808/vba-capacity-overflow-error/50606961#50606961", "title": "VBA - capacity overflow error", "body": "<p>You've declared <code>value</code> (bad variable name, by the way) as <code>Long</code>. You'll get an overflow error if you try to assign a decimal value to an integer variable (which may well be happening with this line:</p>\n\n<pre><code>value = Cel.Offset(0, -2).value / Cel.Offset(0, -4).value\n</code></pre>\n\n<p>Try declaring <code>value</code> as <code>Double</code></p>\n\n<p>Better still, rename and declare <code>dMyValue</code> as <code>Double</code></p>\n"}], "owner": {"reputation": 1, "user_id": 9870734, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17c3ef883a4fce963354363f3f9120b1?s=128&d=identicon&r=PG&f=1", "display_name": "quannamtran", "link": "https://stackoverflow.com/users/9870734/quannamtran"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 127, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1527689832, "creation_date": 1527689258, "last_edit_date": 1527689486, "question_id": 50606808, "link": "https://stackoverflow.com/questions/50606808/vba-capacity-overflow-error", "title": "VBA - capacity overflow error", "body": "<p>I have the following code that is causing a </p>\n\n<blockquote>\n  <p>capacity overflow error type 6 </p>\n</blockquote>\n\n<p>due to the code between <code>'------------------------------------'</code>. I will appreciate your help :)!</p>\n\n<p>I was not able to solve it with other discussion.</p>\n\n<pre><code>Sub Calculate_Mix()\n    Dim rngUsernameHeader As Range\n    Dim rngHeaders As Range\n    Dim rngAddress As Range\n    Dim rng_R1 As Range\n    Dim rng_delisted As Range\n    Dim ws As Worksheet\n    Dim value As Long\n\n    Set ws = ThisWorkbook.Sheets(\"Sheet1\")\n    Set rngHeaders = Range(\"1:1\") 'Looks in entire first row.\n    Set rngUsernameHeader = rngHeaders.Find(what:=\"VAl MAT'Mar18\", After:=Cells(1, 1))\n\n    rngUsernameHeader.Offset(0, 1).EntireColumn.Insert\n    rngUsernameHeader.Offset(0, 1).value = \"Delisted\"\n\n    rngUsernameHeader.Offset(0, 2).EntireColumn.Insert\n    rngUsernameHeader.Offset(0, 2).value = \"New Launches\"\n\n    rngUsernameHeader.Offset(0, 3).EntireColumn.Insert\n    rngUsernameHeader.Offset(0, 3).value = \"Price_17\"\n\n    rngUsernameHeader.Offset(0, 4).EntireColumn.Insert\n    rngUsernameHeader.Offset(0, 4).value = \"Price_18\"\n\n    For Each Cel In Range(\"F2\", Range(\"F2\").End(xlDown))\n    If Cel &gt; 0 And Cel.Offset(0, 1) = 0 Then\n            Cel.Offset(0, 2).value = Cel.value\n    Else: Cel.Offset(0, 2).value = 0\n    End If\n    If Cel = 0 And Cel.Offset(0, 1) &gt; 0 Then\n            Cel.Offset(0, 3).value = Cel.Offset(0, 1).value\n    Else: Cel.Offset(0, 3).value = 0\n    End If\n    Next Cel\n\n    '------------------------------------'\n    For Each Cel In Range(\"H2\", Range(\"H2\").End(xlDown))\n    If Cel = 0 And Cel.Offset(0, 1) = 0 Then\n        value = Cel.Offset(0, -2).value / Cel.Offset(0, -4).value\n        Cel.Offset(0, 2).value = value\n    Else: Cel.Offset(0, 2).value = 0\n    End If\n    Next Cel\n   '------------------------------------'\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "for-loop", "userform"], "comments": [{"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 3, "creation_date": 1527687922, "post_id": 50606234, "comment_id": 88222172, "body": "I cannot reproduce, works fine for me."}, {"owner": {"reputation": 1, "user_id": 9869090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2668aa3bd350b7ac1e273e665c0cd305?s=128&d=identicon&r=PG&f=1", "display_name": "Jimanjay", "link": "https://stackoverflow.com/users/9869090/jimanjay"}, "reply_to_user": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1527687971, "post_id": 50606234, "comment_id": 88222210, "body": "do you think it could have problems with the rest of the code?"}, {"owner": {"reputation": 1505, "user_id": 9663006, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nXPmC.jpg?s=128&g=1", "display_name": "Samuel Everson", "link": "https://stackoverflow.com/users/9663006/samuel-everson"}, "edited": false, "score": 0, "creation_date": 1527688288, "post_id": 50606234, "comment_id": 88222430, "body": "I also can&#39;t reproduce, was there any specific line or part of the code highlighted when you click &#39;Debug&#39;?"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 1, "creation_date": 1527688320, "post_id": 50606234, "comment_id": 88222455, "body": "I voted to close the question because it cannot be reproduced anymore."}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 9869090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2668aa3bd350b7ac1e273e665c0cd305?s=128&d=identicon&r=PG&f=1", "display_name": "Jimanjay", "link": "https://stackoverflow.com/users/9869090/jimanjay"}, "is_accepted": false, "score": 0, "last_activity_date": 1527688160, "creation_date": 1527688160, "answer_id": 50606415, "question_id": 50606234, "link": "https://stackoverflow.com/questions/50606234/combobox-on-userform-runtime-error-13/50606415#50606415", "title": "ComboBox on Userform Runtime Error &quot;13&quot;", "body": "<p>All right the problem was, that I had a Excel 5.0 Dialog sheet which I had to delete for the combobox not to crash. \nThanks to @dwirony you brought me to the idea!</p>\n"}], "owner": {"reputation": 1, "user_id": 9869090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2668aa3bd350b7ac1e273e665c0cd305?s=128&d=identicon&r=PG&f=1", "display_name": "Jimanjay", "link": "https://stackoverflow.com/users/9869090/jimanjay"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 72, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1527688260, "creation_date": 1527687600, "last_edit_date": 1531164843, "question_id": 50606234, "link": "https://stackoverflow.com/questions/50606234/combobox-on-userform-runtime-error-13", "title": "ComboBox on Userform Runtime Error &quot;13&quot;", "body": "<p>On my code below, I have an Runtime Error 13 (type missmatch). I don't know what the problem is? I have tried to fill the combobox with the sheet names.\nThe error appears on UserForm_Activate().</p>\n\n<pre><code>Private Sub UserForm_Activate()\n    Dim xSheet As Worksheet\n\n    ComboBox2.Clear\n\n    For Each xSheet In ActiveWorkbook.Sheets\n        ComboBox2.AddItem xSheet.Name\n    Next xSheet\nEnd Sub\n\nPrivate Sub UserForm_Initialize()\n    Dim lblName As String\n    Dim lblDate As String\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "web-scraping"], "answers": [{"tags": [], "owner": {"reputation": 137, "user_id": 6906214, "user_type": "registered", "profile_image": "https://graph.facebook.com/1202325113158719/picture?type=large", "display_name": "Radek Piekn&#253;", "link": "https://stackoverflow.com/users/6906214/radek-piekn%c3%bd"}, "is_accepted": false, "score": 0, "last_activity_date": 1527686807, "creation_date": 1527686807, "answer_id": 50605940, "question_id": 50605825, "link": "https://stackoverflow.com/questions/50605825/scraping-website-using-excel-vba-and-xml/50605940#50605940", "title": "Scraping website using Excel VBA and XML", "body": "<p>does this help?</p>\n\n<pre><code>Dim XMLPage As Object\nDim HTMLDoc As Object\n\n\nSet XMLPage = New MSXML2.XMLHTTP60\nSet HTMLDoc = New MSHTML.HTMLDocument\n</code></pre>\n\n<p>There are some articles on stack about when to use new etc. so I am not gonna cover it.</p>\n"}, {"comments": [{"owner": {"reputation": 91, "user_id": 3376509, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f876dac164f875f9e83069faab161fc6?s=128&d=identicon&r=PG&f=1", "display_name": "Anish Ardjoon", "link": "https://stackoverflow.com/users/3376509/anish-ardjoon"}, "edited": false, "score": 0, "creation_date": 1527689220, "post_id": 50606350, "comment_id": 88223141, "body": "Thank you for explanation :)"}], "tags": [], "owner": {"reputation": 2031, "user_id": 6097926, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/187bc2674bbdf7651e7137e1427b9bd6?s=128&d=identicon&r=PG&f=1", "display_name": "Ryszard J\u0119draszyk", "link": "https://stackoverflow.com/users/6097926/ryszard-j%c4%99draszyk"}, "is_accepted": true, "score": 4, "last_activity_date": 1527687960, "creation_date": 1527687960, "answer_id": 50606350, "question_id": 50605825, "link": "https://stackoverflow.com/questions/50605825/scraping-website-using-excel-vba-and-xml/50606350#50606350", "title": "Scraping website using Excel VBA and XML", "body": "<p>You are trying to get <code>innerText</code> property for 2nd <code>Child</code> of collection element obtained through this code:</p>\n\n<pre><code>HTMLDoc.getElementsByClassName(\"price-current\")(0)\n</code></pre>\n\n<p>This error happens, because \"Object\" from error prompt which is <code>HTMLDoc.getElementsByClassName(\"price-current\")(0)</code> does not exist on this page.</p>\n\n<p>You can check it with:</p>\n\n<pre><code>Debug.Print HTMLDoc.getElementsByClassName(\"price-current\").Length\n</code></pre>\n\n<p>It will be 0, meaning no element with this class exists. If it exists for IE automation, it means that this element is part of HTML generated through JavaScript and XMLHTTP request will not have it in its response.</p>\n"}], "owner": {"reputation": 91, "user_id": 3376509, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f876dac164f875f9e83069faab161fc6?s=128&d=identicon&r=PG&f=1", "display_name": "Anish Ardjoon", "link": "https://stackoverflow.com/users/3376509/anish-ardjoon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1012, "favorite_count": 2, "accepted_answer_id": 50606350, "answer_count": 2, "score": 1, "last_activity_date": 1527687960, "creation_date": 1527686472, "question_id": 50605825, "link": "https://stackoverflow.com/questions/50605825/scraping-website-using-excel-vba-and-xml", "title": "Scraping website using Excel VBA and XML", "body": "<p>I am trying to scrape Newegg website to get price of products. When I run this piece of code it does the job.</p>\n\n<pre><code>Sub test()\n\nDim objIE As InternetExplorer\nSet objIE = New InternetExplorer\n\nobjIE.Visible = True\nobjIE.Navigate \"https://www.newegg.com/Product/Product.aspx?item=1TS-000E-083F2\"\n\nDo While objIE.ReadyState &lt;&gt; READYSTATE_COMPLETE\nLoop\n\n    Debug.Print objIE.Document.getElementsByClassName(\"price-current\")(0).Children(1).innerText\n\nEnd Sub\n</code></pre>\n\n<p>However, when I try to use XML for faster executing I am having a <strong>run time error 91: Object variable or With block variable not set</strong></p>\n\n<p>Below is the piece of code I am trying to implement.</p>\n\n<pre><code>Sub testxml()\n\nDim XMLPage As New MSXML2.XMLHTTP60\nDim HTMLDoc As New MSHTML.HTMLDocument\n\n\n\nXMLPage.Open \"GET\", \"https://www.newegg.com/Product/Product.aspx?item=1TS-000E-083F2\", False\nXMLPage.send\n\nHTMLDoc.body.innerHTML = XMLPage.responseText\n\n\nDebug.Print HTMLDoc.getElementsByClassName(\"price-current\")(0).Children(1).innerText\nEnd Sub\n</code></pre>\n"}, {"tags": ["javascript", "node.js", "vba", "vbscript", "activexobject"], "comments": [{"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 1, "creation_date": 1527685966, "post_id": 50605619, "comment_id": 88220632, "body": "Delete <code>On Error Resume Next</code> and <code>CallVBA</code>."}, {"owner": {"reputation": 117, "user_id": 9515299, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Pol Grisart", "link": "https://stackoverflow.com/users/9515299/pol-grisart"}, "reply_to_user": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1527686085, "post_id": 50605619, "comment_id": 88220732, "body": "Hello, I didn&#39;t test the .vbs file yet because the main problem is calling it from the .js file. Thank you anyway for the correction."}, {"owner": {"reputation": 7845, "user_id": 5734311, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7iVq7.jpg?s=128&g=1", "display_name": "Chris G", "link": "https://stackoverflow.com/users/5734311/chris-g"}, "edited": false, "score": 1, "creation_date": 1527686106, "post_id": 50605619, "comment_id": 88220748, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/47218117/run-vbs-script-with-node\">Run .vbs script with node</a>"}, {"owner": {"reputation": 117, "user_id": 9515299, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Pol Grisart", "link": "https://stackoverflow.com/users/9515299/pol-grisart"}, "edited": false, "score": 0, "creation_date": 1527687628, "post_id": 50605619, "comment_id": 88221918, "body": "I tried the program and it works perfectly. However when I apply it to my project with the previous vbs code (without &quot;On Error Resume Next&quot; and &quot;Call VBA&quot;) Nothing happens..."}, {"owner": {"reputation": 10618, "user_id": 2018133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e3fd4734236360fc59fa597dc8f9ffa7?s=128&d=identicon&r=PG", "display_name": "Geert Bellekens", "link": "https://stackoverflow.com/users/2018133/geert-bellekens"}, "edited": false, "score": 0, "creation_date": 1579802855, "post_id": 50605619, "comment_id": 105898179, "body": "If you remove <code>CallVBA</code> then it just defines a sub, but never executes it."}], "answers": [{"tags": [], "owner": {"reputation": 31, "user_id": 1576041, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67928059b0d49ef78f1528a933ff1c5d?s=128&d=identicon&r=PG", "display_name": "peekpoke", "link": "https://stackoverflow.com/users/1576041/peekpoke"}, "is_accepted": false, "score": 3, "last_activity_date": 1579809500, "last_edit_date": 1579809500, "creation_date": 1579796918, "answer_id": 59883108, "question_id": 50605619, "link": "https://stackoverflow.com/questions/50605619/call-vbscript-from-node-js/59883108#59883108", "title": "Call VBScript from Node.js", "body": "<p>Your Node.js is probably 64bit, whilst your Office/Excel is probably the 32bit version.</p>\n\n<p>You need to run the 32bit VBScript interpreter in order to access the 32bit <code>CreateObject(\"Excel.Application\")</code></p>\n\n<pre><code>const { spawn } = require(\"child_process\");\nconst bat = spawn(\"C:\\\\Windows\\\\SysWOW64\\\\wscript.exe\", [\"H:\\\\script.vbs\"]);\n</code></pre>\n"}], "owner": {"reputation": 117, "user_id": 9515299, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Pol Grisart", "link": "https://stackoverflow.com/users/9515299/pol-grisart"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1263, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1579809500, "creation_date": 1527685866, "question_id": 50605619, "link": "https://stackoverflow.com/questions/50605619/call-vbscript-from-node-js", "title": "Call VBScript from Node.js", "body": "<p>To answer a request from the client, Node.js needs to export charts from Excel files in images into a repository.\nI chose to use a VBA Macro because I don't think I have other solutions.\nThe VBA code is working properly (when I call it manually) but I wish I could connect it with Node.js events. \nVBScript allows me to call a VBA Macro in my script.vbs file :</p>\n\n<pre><code>Option Explicit\nOn Error Resume Next\nCallVBA\n\nSub CallVBA() \n\n   Dim ApplicationExcel \n   Dim ClasseurExcel \n\n   Set ApplicationExcel = CreateObject(\"Excel.Application\") \n   Set ClasseurExcel = ApplicationExcel.Workbooks.Open(\"H:/macrosVBA.xlsm\") \n\n   ApplicationExcel.Visible = False       \n   ApplicationExcel.Run \"ChartUpload\" \n   ApplicationExcel.Quit \n\n   Set ClasseurExcel = Nothing \n   Set ApplicationExcel = Nothing \n\nEnd Sub\n</code></pre>\n\n<p>My problem now is to run the VBScript in the JavaScript file :</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-js lang-js prettyprint-override\"><code>var objShell = new ActiveXObject(\"WScript.shell\");\r\nobjShell.run('H:/script.vbs');</code></pre>\r\n</div>\r\n</div>\r\n</p>\n\n<p>I get the error :</p>\n\n<pre><code>ReferenceError: ActiveXObject is not defined\n</code></pre>\n\n<p>Adding <a href=\"https://www.npmjs.com/package/win32ole\" rel=\"nofollow noreferrer\">win32ole</a> and <a href=\"https://www.npmjs.com/package/winax\" rel=\"nofollow noreferrer\">winax</a> doesn't change anything, they don't seem to work anymore.\nI'm looking for your help to have another solution or to fix my error with ActiveXObject.</p>\n\n<p>Thanks in advance</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1527686187, "post_id": 50605505, "comment_id": 88220821, "body": "What is <code>val1</code> and <code>NewSheetName</code>? Are they defined?"}, {"owner": {"reputation": 48, "user_id": 8137603, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d16a406ddbf1b8278db85c23d9c1204?s=128&d=identicon&r=PG&f=1", "display_name": "VBAmazing", "link": "https://stackoverflow.com/users/8137603/vbamazing"}, "edited": false, "score": 0, "creation_date": 1527686407, "post_id": 50605505, "comment_id": 88220980, "body": "Defined in the Public statement above. NewSheetName is derived from an inputbox (that creates a new sheet) and val1 is derived from a field in the userform."}, {"owner": {"reputation": 6533, "user_id": 8466523, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JNrm6.jpg?s=128&g=1", "display_name": "Olly", "link": "https://stackoverflow.com/users/8466523/olly"}, "edited": false, "score": 0, "creation_date": 1527686628, "post_id": 50605505, "comment_id": 88221136, "body": "Title says matching TWO strings... which two? As I understand it, you&#39;re simply searching for val1 in the first row of a specified range?"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1527686730, "post_id": 50605505, "comment_id": 88221214, "body": "<code>cell.End(xlDown).Select</code> selects a single cell."}, {"owner": {"reputation": 48, "user_id": 8137603, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d16a406ddbf1b8278db85c23d9c1204?s=128&d=identicon&r=PG&f=1", "display_name": "VBAmazing", "link": "https://stackoverflow.com/users/8137603/vbamazing"}, "edited": false, "score": 0, "creation_date": 1527686799, "post_id": 50605505, "comment_id": 88221261, "body": "Yes, trying to match &#39;val1&#39; and a cell in range &#39;f&#39;."}, {"owner": {"reputation": 48, "user_id": 8137603, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d16a406ddbf1b8278db85c23d9c1204?s=128&d=identicon&r=PG&f=1", "display_name": "VBAmazing", "link": "https://stackoverflow.com/users/8137603/vbamazing"}, "edited": false, "score": 0, "creation_date": 1527686967, "post_id": 50605505, "comment_id": 88221373, "body": "<code>Range(cell, Range(cell).End(xlDown)).Select</code> is another approach that I&#39;ve tried in place of <code>cell.End(xlDown).Select</code> but it gives me the same error"}], "answers": [{"tags": [], "owner": {"reputation": 24120, "user_id": 5159168, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/r0oiE.jpg?s=128&g=1", "display_name": "Andreas", "link": "https://stackoverflow.com/users/5159168/andreas"}, "is_accepted": false, "score": 0, "last_activity_date": 1527687596, "last_edit_date": 1527687596, "creation_date": 1527686813, "answer_id": 50605942, "question_id": 50605505, "link": "https://stackoverflow.com/questions/50605505/matching-two-strings-in-vba-transporting-other-cell-values-to-a-different-locat/50605942#50605942", "title": "Matching two strings in VBA, transporting other cell values to a different location", "body": "<p>I believe this is what you are looking for.<br>\nI first find <code>match</code> which will be the column letter of what you are searching for.  </p>\n\n<p>Then I copy the column and paste the values.<br>\nNo looping is needed.</p>\n\n<pre><code>on error resume next ' if nothing is found it creates an error\nmatch = Split(Cells(1, Cells(1, 1).EntireRow.Find(what:=val1, LookIn:=xlValues, LookAt:=xlWhole, SearchOrder:=xlByColumns, searchdirection:=xlNext, MatchCase:=True).Column).Address(True, False), \"$\")(0)\non error goto 0\nif match = \"\" or match &gt; \"L\" then\n    msgbox \"nothing found in range\"\nelse\n    Range(match &amp; \":\" &amp; match).Copy ' copies column \"E:E\" for example\n    ThisWorkbook.Sheets(NewSheetName).Range(\"B1\").Select ' selects output cell\n    ActiveSheet.Paste ' paste\nend if\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 0, "last_activity_date": 1527686844, "creation_date": 1527686844, "answer_id": 50605955, "question_id": 50605505, "link": "https://stackoverflow.com/questions/50605505/matching-two-strings-in-vba-transporting-other-cell-values-to-a-different-locat/50605955#50605955", "title": "Matching two strings in VBA, transporting other cell values to a different location", "body": "<ul>\n<li>Build a new Excel Workbook with 2 worksheets;</li>\n<li>On the first one, in range <code>B1:L1</code> write the word \"something\" 3-4 times;</li>\n<li>Write other random things at range <code>B2:L10</code>;</li>\n</ul>\n\n<p>Run this:</p>\n\n<pre><code>Option Explicit\n\nPublic Sub TestMe()\n\n    Dim val1 As String: val1 = \"something\"\n    Dim cell As Range\n    Dim f As Range\n\n    Set f = Worksheets(1).Range(\"B1:L1\")\n\n    For Each cell In f\n        If cell = val1 Then\n            cell.End(xlDown).Copy Destination:=Worksheets(2).Range(cell.Address)\n        End If\n    Next\n\nEnd Sub\n</code></pre>\n\n<p>It loops through <code>Range(B1:L1)</code> of the first worksheet and if it finds the word <code>something</code> there, it copies the range to the second worksheet.</p>\n"}, {"tags": [], "owner": {"reputation": 6533, "user_id": 8466523, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JNrm6.jpg?s=128&g=1", "display_name": "Olly", "link": "https://stackoverflow.com/users/8466523/olly"}, "is_accepted": true, "score": 0, "last_activity_date": 1527687314, "creation_date": 1527687314, "answer_id": 50606125, "question_id": 50605505, "link": "https://stackoverflow.com/questions/50605505/matching-two-strings-in-vba-transporting-other-cell-values-to-a-different-locat/50606125#50606125", "title": "Matching two strings in VBA, transporting other cell values to a different location", "body": "<p>Here's an approach which avoids looping:</p>\n\n<pre><code>Sub foo(ByVal sVal1 As String, ByVal sSheetName As String)\n    Dim c As Range\n\n    Set c = ThisWorkbook.Sheets(1).Range(\"B1:L1\").Find(what:=sVal1)\n    If Not c Is Nothing Then\n        Range(c, c.End(xlDown)).Copy Destination:=ThisWorkbook.Sheets(sSheetName).Range(\"B1\")\n    End If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 48, "user_id": 8137603, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d16a406ddbf1b8278db85c23d9c1204?s=128&d=identicon&r=PG&f=1", "display_name": "VBAmazing", "link": "https://stackoverflow.com/users/8137603/vbamazing"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 95, "favorite_count": 0, "accepted_answer_id": 50606125, "answer_count": 3, "score": 0, "last_activity_date": 1527687596, "creation_date": 1527685553, "last_edit_date": 1527687443, "question_id": 50605505, "link": "https://stackoverflow.com/questions/50605505/matching-two-strings-in-vba-transporting-other-cell-values-to-a-different-locat", "title": "Matching two strings in VBA, transporting other cell values to a different location", "body": "<p>I am writing a macro that utilizes a userform to define a value that I need to reference later on in the program (Val1). The macro needs to go into a particular spreadsheet, look through several headings, and if the values match, it needs to copy all of the data in that column and paste it into a different spreadsheet in the same workbook.</p>\n\n<p>At current, I get a </p>\n\n<blockquote>\n  <p>Run-Time error 1004 'Select Method of Range Class Failed' </p>\n</blockquote>\n\n<p>at the <code>cell.End(xlDown).Select</code></p>\n\n<pre><code>public NewSheetName as string, val1 as string\n    Dim f As Range\nSet f = ThisWorkbook.Sheets(1).Range(\"B1:L1\")\n\nFor Each cell In f\n    If cell = val1 Then\n    cell.End(xlDown).Select\n    selection.Copy Destination:=ThisWorkbook.Sheets(NewSheetName).Range(\"B1\")\n'NewSheetName is defined elsewhere\n    End If\nNext\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1505, "user_id": 9663006, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nXPmC.jpg?s=128&g=1", "display_name": "Samuel Everson", "link": "https://stackoverflow.com/users/9663006/samuel-everson"}, "edited": false, "score": 0, "creation_date": 1527685881, "post_id": 50605415, "comment_id": 88220566, "body": "At which line of your code does the error appear? Have you stepped through it using F8?  Is the code you have posted part of one Sub or are they two separate Sub/Functions?"}, {"owner": {"reputation": 57, "user_id": 6130754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93a2d5b4802368417f19db6b483586ec?s=128&d=identicon&r=PG&f=1", "display_name": "sabarigiri", "link": "https://stackoverflow.com/users/6130754/sabarigiri"}, "reply_to_user": {"reputation": 1505, "user_id": 9663006, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nXPmC.jpg?s=128&g=1", "display_name": "Samuel Everson", "link": "https://stackoverflow.com/users/9663006/samuel-everson"}, "edited": false, "score": 0, "creation_date": 1527743576, "post_id": 50605415, "comment_id": 88243838, "body": "break mode is not working for this code. and the answer is sub and txtboxcount is a separate function which will be called from private sub event handler. the error appear while calling the function. @SamuelEverson"}, {"owner": {"reputation": 1444, "user_id": 9122140, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6207fe125b0cbaefce70e98e5ce2c6f?s=128&d=identicon&r=PG&f=1", "display_name": "AcsErno", "link": "https://stackoverflow.com/users/9122140/acserno"}, "edited": false, "score": 1, "creation_date": 1527854574, "post_id": 50605415, "comment_id": 88296065, "body": "<code>txtcap As Variant</code> can not have lower and upper bounds. Has this code ever run?"}], "owner": {"reputation": 57, "user_id": 6130754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93a2d5b4802368417f19db6b483586ec?s=128&d=identicon&r=PG&f=1", "display_name": "sabarigiri", "link": "https://stackoverflow.com/users/6130754/sabarigiri"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 56, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1527685299, "creation_date": 1527685299, "question_id": 50605415, "link": "https://stackoverflow.com/questions/50605415/access-dynamically-created-user-form-and-controls-in-private-sub", "title": "access dynamically created user form and controls in private sub", "body": "<p>I have created user form and added controls to that dynamically in excel VBA. Now I want to count the number of text boxes that I added and also want to capture the text box value once the user enters that. Please help me with this.</p>\n\n<pre><code>   public dynuserform as object\n\n   Sub answer()\n\n   Dim options As Variant      \n   Dim txtbx As MSForms.TextBox\n   Dim cmdbtn As MSForms.CommandButton\n   Dim txtcap As Variant\n   Dim cntl As Control\n   Set dynuserform = ThisWorkbook.VBProject.VBComponents.Add(3)\n   With dynuserform\n    .Properties(\"Height\") = 100\n    .Properties(\"Width\") = 200\n   End With   \n   with dynuserform    \n    txtcap = \"some array with dynamic size\"\n    For i = LBound(txtcap) To UBound(txtcap)\n        Set txtbx = .designer.Controls.Add(\"forms.Textbox.1\")\n        With txtbx\n            .Left = 180\n            If i = 0 Then\n                .Top = 30\n            Else\n                .Top = (30 * i) + 25\n            End If\n            .Height = 25\n            .Width = 90\n        End With\n    Next i\n   Set cmdbtn = .designer.Controls.Add(\"forms.CommandButton.1\")\n    With cmdbtn\n        .Caption = \"next\"\n        .Height = 25\n        .Left = 190\n        .Top = 80\n    End With\n   end with\n    dynuserform.codemodule.insertlines 1, \"Public ans As String\"\n    dynuserform.codemodule.insertlines 2, \"Private Sub CommandButton1_Click()\"\n    dynuserform.codemodule.insertlines 3, \"     if txtboxcount&gt;1 then\"\n    dynuserform.codemodule.insertlines 4, \"         ans = ansload\"\n    dynuserform.codemodule.insertlines 5, \"     'Else\"\n    dynuserform.codemodule.insertlines 6, \"         'ans = TextBox1.Value\"\n    dynuserform.codemodule.insertlines 7, \"     'End If\"     \n    dynuserform.codemodule.insertlines 8, \"End Sub\"\n    VBA.UserForms.Add(dynuserform.Name).Show\n   end sub\n</code></pre>\n\n<p>Once the user click the command button I want to calculate the count of text box and i defined that in fucntion but it shows me an error object variable not set.\nI want to know how to use the dynuserform object to find the count. PLease help me on this.</p>\n\n<pre><code>  function txtboxcount() as long\n  Dim iCtrl As Long\n  countTextboxes = 0\n   For iCtrl = 0 To dynuserform.designer.Controls.Count - 1\n      If TypeName(dynuserform.designer.Controls(iCtrl)) = \"TextBox\" Then\n    countTextboxes = countTextboxes + 1\n    Debug.Print countTextboxes\n   End If\n   Next iCtrl\n   txtboxcount =  countTextboxes\n   End Sub\n</code></pre>\n"}, {"tags": ["vba", "function", "64-bit"], "comments": [{"owner": {"reputation": 870061, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 1, "creation_date": 1527685712, "post_id": 50605356, "comment_id": 88220435, "body": "The declaration is just wrong.  DWORD in the MSDN documentation is Long in VBA, not LongPtr.  The ip-address is Long as well."}, {"owner": {"reputation": 445, "user_id": 8307614, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/10154779357916547/picture?type=large", "display_name": "Proximus Seraphim Dimitri Davi", "link": "https://stackoverflow.com/users/8307614/proximus-seraphim-dimitri-davi"}, "reply_to_user": {"reputation": 870061, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 1, "creation_date": 1527687118, "post_id": 50605356, "comment_id": 88221508, "body": "@HansPassant i went and changed that, it still doesn&#39;t resolve the issue of why i am getting a compile error"}, {"owner": {"reputation": 870061, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 0, "creation_date": 1527687472, "post_id": 50605356, "comment_id": 88221788, "body": "Do focus on the line number that produces the compile error.  Notable is that the #End If is placed incorrectly, if Win64 is defined then the compiler will see two End Function statements.  It needs to go after it."}, {"owner": {"reputation": 445, "user_id": 8307614, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/10154779357916547/picture?type=large", "display_name": "Proximus Seraphim Dimitri Davi", "link": "https://stackoverflow.com/users/8307614/proximus-seraphim-dimitri-davi"}, "reply_to_user": {"reputation": 870061, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 1, "creation_date": 1527688707, "post_id": 50605356, "comment_id": 88222768, "body": "@HansPassant Hey hans thanks for the reply, i actually tried that before, but what happens is that if i close the work book and re-open the entire thing crashes and i have to re-open the workbook by disabling macros...  By defining Win64, do you mean declaring it before i use the way i would dim an object?"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 1, "creation_date": 1527697511, "post_id": 50605356, "comment_id": 88228630, "body": "I think <b>all</b> <code>Declare</code> statements have to come before any user defined <code>Sub&#47;Function</code>. Try one <code>#If Win64 Then \u2026 Else \u2026</code> for the declares first and another afterwards for the user defined <code>Ping</code> function"}], "answers": [{"tags": [], "owner": {"reputation": 21, "user_id": 12164559, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5dd9cc60fea1d0c4264ca617d03b8204?s=128&d=identicon&r=PG&f=1", "display_name": "BCW", "link": "https://stackoverflow.com/users/12164559/bcw"}, "is_accepted": false, "score": 2, "last_activity_date": 1570636101, "last_edit_date": 1570636101, "creation_date": 1570624457, "answer_id": 58304246, "question_id": 50605356, "link": "https://stackoverflow.com/questions/50605356/32bit-to-64bit-declaring-functions-in-64-bit-office/58304246#58304246", "title": "32bit to 64bit Declaring Functions in 64 bit office", "body": "<p>I think our problem here is that <strong>32bit</strong> Excel changes data type Integer to Long data type.<br>\nTry replacing <code>Integer</code> with <code>LongPtr</code>.  </p>\n\n<ul>\n<li><code>Long</code> only works for <strong>32bit</strong> Excel</li>\n<li><code>LongLong</code> only works for <strong>64bit</strong> Excel</li>\n<li><code>LongPtr</code> works for both <strong>32bit</strong> and <strong>64bit</strong> as per <a href=\"https://docs.microsoft.com/en-us/office/vba/language/concepts/getting-started/64-bit-visual-basic-for-applications-overview\" rel=\"nofollow noreferrer\">https://docs.microsoft.com/en-us/office/vba/language/concepts/getting-started/64-bit-visual-basic-for-applications-overview</a></li>\n</ul>\n"}], "owner": {"reputation": 445, "user_id": 8307614, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/10154779357916547/picture?type=large", "display_name": "Proximus Seraphim Dimitri Davi", "link": "https://stackoverflow.com/users/8307614/proximus-seraphim-dimitri-davi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5166, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1570636101, "creation_date": 1527685103, "last_edit_date": 1527685819, "question_id": 50605356, "link": "https://stackoverflow.com/questions/50605356/32bit-to-64bit-declaring-functions-in-64-bit-office", "title": "32bit to 64bit Declaring Functions in 64 bit office", "body": "<p>So I had to go in and add in <code>PtrSafe</code> before function calls since I am now using 64bit Excel.  So far doing the <code>PtrSafe</code> changes has worked fine except for my <code>mod_Ping</code>.  I had to do a <code>#If Win64 Then</code> \u2026 <code>#else</code> \u2026 <code>#end if</code> statements to make this code work in my macros because it would not work in this part if I had just added in the <code>PtrSafe</code> before each function call. </p>\n\n<pre><code>#If Win64 Then\nPrivate Declare PtrSafe Function GetHostByName Lib \"wsock32.dll\" Alias \"gethostbyname\" (ByVal HostName As String) As LongPtr\nPrivate Declare PtrSafe Function WSAStartup Lib \"wsock32.dll\" (ByVal wVersionRequired&amp;, lpWSAdata As WSAdata) As LongPtr\nPrivate Declare PtrSafe Function WSACleanup Lib \"wsock32.dll\" () As LongPtr\nPrivate Declare PtrSafe Sub CopyMemory Lib \"kernel32\" Alias \"RtlMoveMemory\" (hpvDest As Any, hpvSource As Any, ByVal cbCopy As LongPtr)\nPrivate Declare PtrSafe Function IcmpCreateFile Lib \"icmp.dll\" () As LongPtr\nPrivate Declare PtrSafe Function IcmpCloseHandle Lib \"icmp.dll\" (ByVal HANDLE As LongPtr) As Boolean\nPrivate Declare PtrSafe Function IcmpSendEcho Lib \"ICMP\" (ByVal IcmpHandle As LongPtr, ByVal DestAddress As LongPtr, ByVal RequestData As String, ByVal RequestSize As Integer, RequestOptns As IP_OPTION_INFORMATION, ReplyBuffer As IP_ECHO_REPLY, ByVal ReplySize As LongPtr, ByVal Timeout As LongPtr) As Boolean\n\nPublic Function Ping(sAddr As String, Optional Timeout As Integer = 2000) As Integer\n  Dim hFile As LongPtr, lpWSAdata As WSAdata\n  Dim hHostent As Hostent, AddrList As LongPtr\n  Dim Address As LongPtr, rIP As String\n  Dim OptInfo As IP_OPTION_INFORMATION\n  Dim EchoReply As IP_ECHO_REPLY\n\n  Call WSAStartup(&amp;H101, lpWSAdata)\n\n  If GetHostByName(sAddr + String(64 - Len(sAddr), 0)) &lt;&gt; SOCKET_ERROR Then\n      CopyMemory hHostent.h_name, ByVal GetHostByName(sAddr + String(64 - Len(sAddr), 0)), Len(hHostent)\n      CopyMemory AddrList, ByVal hHostent.h_addr_list, 4\n      CopyMemory Address, ByVal AddrList, 4\n  End If\n\n  hFile = IcmpCreateFile()\n\n  If hFile = 0 Then\n      Ping = -2 ' MsgBox \"Unable to Create File Handle\"\n      Exit Function\n  End If\n\n  OptInfo.TTL = 255\n\n  If IcmpSendEcho(hFile, Address, String(32, \"A\"), 32, OptInfo, EchoReply, Len(EchoReply) + 8, Timeout) Then\n      rIP = CStr(EchoReply.Address(0)) + \".\" + CStr(EchoReply.Address(1)) + \".\" + CStr(EchoReply.Address(2)) + \".\" + CStr(EchoReply.Address(3))\n  Else\n      Ping = -1 ' MsgBox \"Timeout\"\n  End If\n\n  If EchoReply.Status = 0 Then\n      Ping = EchoReply.RoundTripTime\n  Else\n      Ping = -3\n  End If\n\n  IcmpCloseHandle hFile\n  WSACleanup\n\nEnd Function\n#Else\n\n\nPrivate Declare  Function GetHostByName Lib \"wsock32.dll\" Alias \"gethostbyname\" (ByVal HostName As String) As Long\nPrivate Declare  Function WSAStartup Lib \"wsock32.dll\" (ByVal wVersionRequired&amp;, lpWSAdata As WSAdata) As Long\nPrivate Declare  Function WSACleanup Lib \"wsock32.dll\" () As Long\nPrivate Declare Sub CopyMemory Lib \"kernel32\" Alias \"RtlMoveMemory\" (hpvDest As Any, hpvSource As Any, ByVal cbCopy As Long)\nPrivate Declare Function IcmpCreateFile Lib \"icmp.dll\" () As Long\nPrivate Declare Function IcmpCloseHandle Lib \"icmp.dll\" (ByVal HANDLE As Long) As Boolean\nPrivate Declare Function IcmpSendEcho Lib \"ICMP\" (ByVal IcmpHandle As Long, ByVal DestAddress As Long, ByVal RequestData As String, ByVal RequestSize As Integer, RequestOptns As IP_OPTION_INFORMATION, ReplyBuffer As IP_ECHO_REPLY, ByVal ReplySize As Long, ByVal Timeout As Long) As Boolean\n\nPublic Function Ping(sAddr As String, Optional Timeout As Integer = 2000) As Integer\n  Dim hFile As Long, lpWSAdata As WSAdata\n  Dim hHostent As Hostent, AddrList As Long\n  Dim Address As Long, rIP As String\n  Dim OptInfo As IP_OPTION_INFORMATION\n  Dim EchoReply As IP_ECHO_REPLY\n\n  Call WSAStartup(&amp;H101, lpWSAdata)\n\n  If GetHostByName(sAddr + String(64 - Len(sAddr), 0)) &lt;&gt; SOCKET_ERROR Then\n      CopyMemory hHostent.h_name, ByVal GetHostByName(sAddr + String(64 - Len(sAddr), 0)), Len(hHostent)\n      CopyMemory AddrList, ByVal hHostent.h_addr_list, 4\n      CopyMemory Address, ByVal AddrList, 4\n  End If\n\n  hFile = IcmpCreateFile()\n\n  If hFile = 0 Then\n      Ping = -2 ' MsgBox \"Unable to Create File Handle\"\n      Exit Function\n  End If\n\n  OptInfo.TTL = 255\n\n  If IcmpSendEcho(hFile, Address, String(32, \"A\"), 32, OptInfo, EchoReply, Len(EchoReply) + 8, Timeout) Then\n      rIP = CStr(EchoReply.Address(0)) + \".\" + CStr(EchoReply.Address(1)) + \".\" + CStr(EchoReply.Address(2)) + \".\" + CStr(EchoReply.Address(3))\n  Else\n      Ping = -1 ' MsgBox \"Timeout\"\n  End If\n\n  If EchoReply.Status = 0 Then\n      Ping = EchoReply.RoundTripTime\n  Else\n      Ping = -3\n  End If\n\n  IcmpCloseHandle hFile\n  WSACleanup\n#End If\nEnd Function\n</code></pre>\n\n<p>As you can see I had to also change the longs to <code>LongPtr</code> as well.  </p>\n\n<p>When I open up this work book it gives me  error only comments may appear after end sub end function or end property.  The strange thing is, if i just ignore this and close out the debugger the workbook works fine.  </p>\n\n<p>I mean the <code>#End if</code> should be there to end the initial <code>#If</code> calling so I don't know why I would get a compile error for it.  Is there something I am not seeing? </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1527684714, "post_id": 50605165, "comment_id": 88219700, "body": "What was the input of the first 10 rows of the sheet?"}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1527684911, "post_id": 50605165, "comment_id": 88219840, "body": "You are calculating <code>lr</code> but then never using it. Your code as is doesn&#39;t make much sense."}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 1, "creation_date": 1527684949, "post_id": 50605165, "comment_id": 88219879, "body": "@JohnColeman - <code>lr</code> was used in the other &quot;editions&quot; of the question."}, {"owner": {"reputation": 13, "user_id": 4371360, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/165023519ccd6b53093f501310fb7b35?s=128&d=identicon&r=PG&f=1", "display_name": "&#199;ova", "link": "https://stackoverflow.com/users/4371360/%c3%87ova"}, "edited": false, "score": 0, "creation_date": 1527684978, "post_id": 50605165, "comment_id": 88219906, "body": "Column A has to concat values from column B and E .In column B i have a number 2, and in column E i have a name &#39;TEST&#39;, so column A should be &#39;2TEST&#39; , but in fact it was very different , example : &#39;11NOTHING&#39; . Im really surprised with this , because this failed only for 78 first rows of the sheet , and for the rest is ok."}, {"owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "edited": false, "score": 1, "creation_date": 1527685135, "post_id": 50605165, "comment_id": 88220033, "body": "The code only works for one cell A2, what other rows are you referring to?"}, {"owner": {"reputation": 1026, "user_id": 8788388, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-j4tnBdMaXfk/AAAAAAAAAAI/AAAAAAACwcU/Jg67BYcCeW0/photo.jpg?sz=128", "display_name": "Hakan ERDOGAN", "link": "https://stackoverflow.com/users/8788388/hakan-erdogan"}, "edited": false, "score": 1, "creation_date": 1527685366, "post_id": 50605165, "comment_id": 88220188, "body": "How did the code failed, is there any error code etc? And how do you loop through the rows, can you provide that part too?"}], "answers": [{"tags": [], "owner": {"reputation": 6533, "user_id": 8466523, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JNrm6.jpg?s=128&g=1", "display_name": "Olly", "link": "https://stackoverflow.com/users/8466523/olly"}, "is_accepted": true, "score": 1, "last_activity_date": 1527685385, "creation_date": 1527685385, "answer_id": 50605451, "question_id": 50605165, "link": "https://stackoverflow.com/questions/50605165/excel-macro-cells-why-fail/50605451#50605451", "title": "Excel Macro -Cells() why fail?", "body": "<p>Try this:</p>\n\n<pre><code>Sub FiXCrossSell()\n    Dim lr As Long\n    With Worksheets(\"CrossSell\")\n        lr = .Cells(Rows.Count, 2).End(xlUp).Row\n        With .Range(\"A2:A\" &amp; lr)\n            .FormulaR1C1 = \"=rc2&amp;rc5\"\n            .Value = .Value\n        End With\n    End With\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "is_accepted": false, "score": 0, "last_activity_date": 1527688033, "creation_date": 1527688033, "answer_id": 50606369, "question_id": 50605165, "link": "https://stackoverflow.com/questions/50605165/excel-macro-cells-why-fail/50606369#50606369", "title": "Excel Macro -Cells() why fail?", "body": "<p>Probably just count the cells in column B, then place the Formula in Column A</p>\n\n<pre><code>  Sub Button1_Click()\n    Dim LstRw As Long, Rng As Range, Sh As Worksheet\n\n    Set Sh = Sheets(\"CrossSell\")\n    With Sh\n        LstRw = .Cells(.Rows.Count, \"B\").End(xlUp).Row\n        Set Rng = .Range(\"A2:A\" &amp; LstRw)\n        Rng = \"=B2&amp;E2\"\n    End With\nEnd Sub\n</code></pre>\n\n<p>Ah.. I see someone else answered this while I was thinking about it.</p>\n"}], "owner": {"reputation": 13, "user_id": 4371360, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/165023519ccd6b53093f501310fb7b35?s=128&d=identicon&r=PG&f=1", "display_name": "&#199;ova", "link": "https://stackoverflow.com/users/4371360/%c3%87ova"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 50, "favorite_count": 0, "accepted_answer_id": 50605451, "answer_count": 2, "score": 0, "last_activity_date": 1527688033, "creation_date": 1527684568, "last_edit_date": 1527685423, "question_id": 50605165, "link": "https://stackoverflow.com/questions/50605165/excel-macro-cells-why-fail", "title": "Excel Macro -Cells() why fail?", "body": "<p>I am very new to macro . Iam using this code for concatenating two column values into one column. This code today failed , for 10 first rows of the sheet , and it worked for the rest of the rows.Why happened like this , i havent changed anything at all !\nThanks.</p>\n\n<pre><code>Sub FixCrossSell()\n    Dim wb As Workbook\n    Dim lr As Long\n\n    Set wb = ThisWorkbook\n    wb.Worksheets(\"CrossSell\").Activate\n\n    Cells(2, 1).Value = \"=B2&amp;E2\"\n\n    lr = Cells(Rows.Count, 2).End(xlUp).Row\n    Range(\"A2\").Select\n    Selection.Copy\n\n    Range(\"A3:A\" &amp; lr).Select\n    Selection.PasteSpecial Paste:=xlPasteFormulas, Operation:=xlNone, _\n        SkipBlanks:=False, Transpose:=False\n\n    Application.Calculate\n\n    Range(\"A2:A\" &amp; lr).Select\n    Selection.Copy\n    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n        :=False, Transpose:=False\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 1472, "user_id": 1726522, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/0DUTN.gif?s=128&g=1", "display_name": "CMArg", "link": "https://stackoverflow.com/users/1726522/cmarg"}, "is_accepted": true, "score": 0, "last_activity_date": 1527689507, "creation_date": 1527689507, "answer_id": 50606899, "question_id": 50605069, "link": "https://stackoverflow.com/questions/50605069/how-to-copy-range-of-cells-to-last-empty-row-on-new-worksheet-at-specific-time-o/50606899#50606899", "title": "How to copy range of cells to last empty row on new worksheet at specific time of day", "body": "<p>I really don't know anything about <code>OnTime</code> or <code>TimeSerial</code>, but you said your problem was with pasting data. If that is the case, try the following.</p>\n\n<pre><code>Sub CaptureHeadlines()\n\n    Dim copySheet As Worksheet\n    Dim pasteSheet As Worksheet\n    Dim LastRowPasteSheet As Long\n\n    Set copySheet = Worksheets(\"Summary\")\n    Set pasteSheet = Worksheets(\"Data capture\")\n    LastRowPasteSheet = pasteSheet.Range(\"A\" &amp; Rows.Count).End(xlUp).Row + 1\n\n    copySheet.Range(\"B21:O37\").Copy\n    pasteSheet.Range(\"A\" &amp; LastRowPasteSheet).PasteSpecial Paste:=xlPasteAll\n    Application.CutCopyMode = False\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 2074, "user_id": 9870211, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLEjk.png?s=128&g=1", "display_name": "Dean", "link": "https://stackoverflow.com/users/9870211/dean"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 56, "favorite_count": 0, "accepted_answer_id": 50606899, "answer_count": 1, "score": 0, "last_activity_date": 1527689507, "creation_date": 1527684316, "last_edit_date": 1531161705, "question_id": 50605069, "link": "https://stackoverflow.com/questions/50605069/how-to-copy-range-of-cells-to-last-empty-row-on-new-worksheet-at-specific-time-o", "title": "How to copy range of cells to last empty row on new worksheet at specific time of day", "body": "<p>This is my first post so all help would be greatly appreciated! </p>\n\n<p>Basically what I am trying to do.. I would like a macro to copy a range of cells (\"Summary\" sheet) that hold dynamic data (RTD), to a new worksheet (\"Capture data\") at a specific time. Now, I am by no means a VBA expert but I do have some programming experience. I have had a fair look around on the internet too and below is what I have managed to salvage, but it does not copy all the cells in the range, it only copies the first cell. </p>\n\n<p>This block of code is in the \"ThisWorkbook\" object, which is to run macro on time:</p>\n\n<pre><code>Private Sub Workbook_Open()\ndNextTime = TimeSerial(14, 30, 0)\ndNextTime = Date + dNextTime + IIf(Now &gt; (Date + dNextTime), 1, 0)\nApplication.OnTime dNextTime, \"CaptureHeadlines\"\nEnd Sub\n\nPrivate Sub Workbook_BeforeClose(Cancel As Boolean)\nOn Error Resume Next\nApplication.OnTime dNextTime, \"CaptureHeadlines\", Schedule:=False\nOn Error GoTo 0\nEnd Sub\n</code></pre>\n\n<p>And the below block of code is in the \"Module1\" folder which is to copy the contents of the range of cells across to the new sheet:</p>\n\n<pre><code>Public dNextTime As Double\n\nSub CaptureHeadlines()\n\nDim copySheet As Worksheet\nDim pasteSheet As Worksheet\n\nSet copySheet = Worksheets(\"Summary\")\nSet pasteSheet = Worksheets(\"Data capture\")\n\ncopySheet.Range(\"B21:O37\").Copy\npasteSheet.Range(Rows.Count, 1).End(xlUp).Offset(1, 0).PasteSpecial \nPaste:=xlPasteAll\n\nApplication.CutCopyMode = False\n\ndNextTime = dNextTime + 1\nApplication.OnTime dNextTime, \"CaptureHeadlines\"\n\nEnd Sub\n</code></pre>\n\n<p>Again, any help is greatly appreciated!</p>\n"}, {"tags": ["vba", "excel", "dictionary"], "answers": [{"tags": [], "owner": {"reputation": 1688, "user_id": 9259306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EIROY.png?s=128&g=1", "display_name": "Mistella", "link": "https://stackoverflow.com/users/9259306/mistella"}, "is_accepted": false, "score": 0, "last_activity_date": 1527691002, "creation_date": 1527691002, "answer_id": 50607418, "question_id": 50604888, "link": "https://stackoverflow.com/questions/50604888/trimming-the-contents-of-a-dictionary-in-vba/50607418#50607418", "title": "Trimming the contents of a dictionary in VBA", "body": "<p>There are three options:</p>\n\n<ol>\n<li>Split the string before storing it in the dictionary</li>\n<li>Edit the dictionary contents</li>\n<li>Split the strings as they're extracted from the dictionary</li>\n</ol>\n\n<p>For most code, I would believe that using option 1) would make the most sense. Mostly because dictionaries may get used multiple times. Also, this method allows for if the string you want to edit works as a key.</p>\n\n<p>Depending on the dictionary structure, option 2) could be the simplest, or the most complicated. (With your nested dictionaries -- and possibly different rules for which word to save -- , this would probably be more complicated). However, if you wanted to go this method, be aware that you would have to overwrite an old item with the new one (and if you're changing key values, you'll only be adding keys -- not overwriting them)</p>\n\n<p>If you're only extracting the values from a dictionary once, it may be simplest to edit the string right before using it where desired.</p>\n\n<hr>\n\n<p>I believe for your code, you may wish to make the edit before storing the value(s) in the dictionary.</p>\n\n<p>Which, I believe, would be primarily in this section of your code:</p>\n\n<pre><code>For i = 1 To finalrow1\n        'Basic info in column A\n        SearchString = datasheet.Range(\"A\" &amp; i)\n\n        If InStr(1, SearchString, \"Change number\") Then\n            chNum = datasheet.Cells(i, 1)\n\n            ChangeNumbers.Add chNum, New Dictionary 'For ticket numbers\n        ElseIf InStr(1, SearchString, \"Change subject\") Then\n            chSub = datasheet.Cells(i, 1)\n            ChangeNumbers.Item(chNum).Add chSub, New Dictionary 'For change subjects\n        ElseIf InStr(1, SearchString, \"Report-\") Then\n            rptNum = datasheet.Cells(i, 1)\n            ChangeNumbers.Item(chNum).Item(chSub).Add rptNum, New Dictionary 'For analysis\n\n            'Loop for the details (requirements, tech.specs, impl. and testing)\n            j = 0\n            'Verifies that the details belong to the current report\n            'String checks are included after locating a report to maintain a connection between the report and its details\n            Do While IsEmpty(datasheet.Cells(i + j, 1)) Or datasheet.Cells(i + j, 1) = rptNum\n                If InStr(1, datasheet.Cells(i + j, 2), \"Priority\") Then\n                    ' The 4 after \".Add\" is the column number for this detail in sheet2\n                    ChangeNumbers.Item(chNum).Item(chSub).Item(rptNum).Add 4, datasheet.Cells(i + j, 2) ' the detail #1\n                ElseIf InStr(1, datasheet.Cells(i + j, 2), \"Workload\") Then\n                    ' The 5 after \".Add\" is the column number for this detail in sheet2\n                    ChangeNumbers.Item(chNum).Item(chSub).Item(rptNum).Add 5, datasheet.Cells(i + j, 2) ' the detail #2\n                ElseIf InStr(1, datasheet.Cells(i + j, 2), \"Deadline\") Then\n                    ' The 6 after \".Add\" is the column number for this detail in sheet2\n                    ChangeNumbers.Item(chNum).Item(chSub).Item(rptNum).Add 6, datasheet.Cells(i + j, 2) ' the detail #3\n                End If\n\n                j = j + 1\n            Loop\n        End If\n    Next i\n</code></pre>\n\n<hr>\n\n<p>The split-line example you provided:</p>\n\n<pre><code>Split(Sheets(\"reportsheet\").Range(\"A1\").Value, \" \")(wordNumber - 1)\n</code></pre>\n\n<p>has a <code>wordNumber</code> variable which I don't see anywhere in your existing code; so I will assume it's a pseudo (place-holder) variable, for now.</p>\n\n<hr>\n\n<p>I would probably attempt to add the splitting like so:</p>\n\n<p>Instead of </p>\n\n<pre><code>chNum = datasheet.Cells(i, 1)\n</code></pre>\n\n<p>add the split to make it</p>\n\n<pre><code>chNum = Split(datasheet.Cells(i, 1),\" \")(wordNumber - 1)\n</code></pre>\n\n<p>Instead of</p>\n\n<pre><code>ChangeNumbers.Item(chNum).Item(chSub).Item(rptNum).Add 4, datasheet.Cells(i + j, 2) ' the detail #1\n</code></pre>\n\n<p>add the split to make it</p>\n\n<pre><code>ChangeNumbers.Item(chNum).Item(chSub).Item(rptNum).Add 4, Split(datasheet.Cells(i + j, 2),\" \")(wordNumber - 1) ' the detail #1\n</code></pre>\n\n<p>And so on, through the other applicable sections of code.</p>\n\n<hr>\n\n<p>Note for the first example above, if you added the split here:</p>\n\n<pre><code>ChangeNumbers.Add chNum, New Dictionary 'For ticket numbers\n</code></pre>\n\n<p>--></p>\n\n<pre><code>ChangeNumbers.Add Split(chNum,\" \")(wordNumber - 1), New Dictionary 'For ticket numbers\n</code></pre>\n\n<p>I believe you would cause errors, as a line such as:</p>\n\n<pre><code>ChangeNumbers.Item(chNum).Item(chSub).Item(rptNum).Add 4, datasheet.Cells(i + j, 2) ' the detail #1\n</code></pre>\n\n<p>would no longer reference a valid key in the <code>ChangeNumbers</code> dictionary (<code>chNum</code> would no longer be equal to the key assigned here, <code>ChangeNumbers.Add Split(chNum,\" \")(wordNumber - 1), New Dictionary 'For ticket numbers</code> (key --> <code>Split(chNum,\" \")(wordNumber - 1)</code>)</p>\n"}], "owner": {"reputation": 1, "user_id": 2859557, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c866d3585d593a6babddae7e3965fbef?s=128&d=identicon&r=PG&f=1", "display_name": "user2859557", "link": "https://stackoverflow.com/users/2859557/user2859557"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 74, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1532106278, "creation_date": 1527683852, "question_id": 50604888, "link": "https://stackoverflow.com/questions/50604888/trimming-the-contents-of-a-dictionary-in-vba", "title": "Trimming the contents of a dictionary in VBA", "body": "<p>I have an Excel formula that finds the <strong>Nth to last word</strong> in a cell and outputs it. However, now I use a VBA macro to output badly ordered data from Sheet1 to Sheet2 in a more formatted form.</p>\n\n<p>What I am trying to do now is to modify the contents of the data structure that I store the data in before it gets copied to the 2nd sheet. In the 2nd sheet I would like to only have specific things (like 2nd/3rd to last word or only the numbers). The data structure that is being used is dictionary.</p>\n\n<p>I know the basic way to do this in VBA is:</p>\n\n<pre><code>Split(Sheets(\"reportsheet\").Range(\"A1\").Value, \" \")(wordNumber - 1)\n</code></pre>\n\n<p>However, I really am lost on how to apply this in my case. The VBA code is as follows: </p>\n\n<pre><code>Sub findData()\n\n    Dim datasheet As Worksheet\n    Dim reportsheet As Worksheet\n\n    Dim SearchString As String\n    Dim i As Integer\n    Dim j As Integer\n\n    Set datasheet = Sheet1\n    Set reportsheet = Sheet2\n\n    Dim chNum As String 'Ticket number\n    Dim chSub As String 'Change subject\n    Dim rptNum As String 'analysis number\n    Dim ChangeNumbers As New Dictionary 'dictionary that holds all of the info (ticket number, change subject, analysis number and details)\n\n    Dim dictKey1 As Variant\n    Dim dictKey2 As Variant\n    Dim dictKey3 As Variant\n    Dim dictKey4 As Variant\n\n    Dim formula1 As String\n    Dim formula2 As String\n\n    reportsheet.Range(\"A1:H200\").ClearContents\n    finalrow1 = datasheet.Cells(datasheet.Rows.Count, 1).End(xlUp).Row\n\n    'Loop that finds the required pieces of text from the data-sheet\n    For i = 1 To finalrow1\n        'Basic info in column A\n        SearchString = datasheet.Range(\"A\" &amp; i)\n\n        If InStr(1, SearchString, \"Change number\") Then\n            chNum = datasheet.Cells(i, 1)\n\n            ChangeNumbers.Add chNum, New Dictionary 'For ticket numbers\n        ElseIf InStr(1, SearchString, \"Change subject\") Then\n            chSub = datasheet.Cells(i, 1)\n            ChangeNumbers.Item(chNum).Add chSub, New Dictionary 'For change subjects\n        ElseIf InStr(1, SearchString, \"Report-\") Then\n            rptNum = datasheet.Cells(i, 1)\n            ChangeNumbers.Item(chNum).Item(chSub).Add rptNum, New Dictionary 'For analysis\n\n            'Loop for the details (requirements, tech.specs, impl. and testing)\n            j = 0\n            'Verifies that the details belong to the current report\n            'String checks are included after locating a report to maintain a connection between the report and its details\n            Do While IsEmpty(datasheet.Cells(i + j, 1)) Or datasheet.Cells(i + j, 1) = rptNum\n                If InStr(1, datasheet.Cells(i + j, 2), \"Priority\") Then\n                    ' The 4 after \".Add\" is the column number for this detail in sheet2\n                    ChangeNumbers.Item(chNum).Item(chSub).Item(rptNum).Add 4, datasheet.Cells(i + j, 2) ' the detail #1\n                ElseIf InStr(1, datasheet.Cells(i + j, 2), \"Workload\") Then\n                    ' The 5 after \".Add\" is the column number for this detail in sheet2\n                    ChangeNumbers.Item(chNum).Item(chSub).Item(rptNum).Add 5, datasheet.Cells(i + j, 2) ' the detail #2\n                ElseIf InStr(1, datasheet.Cells(i + j, 2), \"Deadline\") Then\n                    ' The 6 after \".Add\" is the column number for this detail in sheet2\n                    ChangeNumbers.Item(chNum).Item(chSub).Item(rptNum).Add 6, datasheet.Cells(i + j, 2) ' the detail #3\n                End If\n\n                j = j + 1\n            Loop\n        End If\n    Next i\n\n    i = 1\n    For Each dictKey1 In ChangeNumbers.Keys\n        reportsheet.Cells(i, 1) = dictKey1 'Change Ticket Number\n\n        If ChangeNumbers.Item(dictKey1).Count &gt; 0 Then\n            For Each dictKey2 In ChangeNumbers.Item(dictKey1).Keys\n                reportsheet.Cells(i, 2) = dictKey2 'Change Subject; assuming in column B on same row as Change Number\n\n                If ChangeNumbers.Item(dictKey1).Item(dictKey2).Count &gt; 0 Then\n                    For Each dictKey3 In ChangeNumbers.Item(dictKey1).Item(dictKey2).Keys 'Analysis number\n                        reportsheet.Cells(i, 3) = dictKey3\n                        'reportsheet.Cells(i, 2) = dictKey2 'Uncomment if you want change subject in every row w/ matching report\n\n                        For Each dictKey4 In ChangeNumbers.Item(dictKey1).Item(dictKey2).Item(dictKey3).Keys\n                            reportsheet.Cells(i, dictKey4) = ChangeNumbers.Item(dictKey1).Item(dictKey2).Item(dictKey3).Item(dictKey4)\n                        Next dictKey4\n                        i = i + 1 'moves to new row for new report (or next change number)\n                    Next dictKey3\n                Else\n                    i = i + 1 'no reports, so moves down to prevent overwriting change number\n                End If\n            Next dictKey2\n        Else\n            i = i + 1 'no change subject, so moves down to prevent overwriting change number\n        End If\n    Next dictKey1\n\n\nEnd Sub\n</code></pre>\n\n<p>I find the documentation on VBA functions to be extremely hard to follow. I couldn't find an answer on how to apply this in practice. I tried to change everything after it was stored in the dictionary but this didn't seem to work. All my efforts have either resulted in the loop stopping or errors. </p>\n\n<p>Someone can give me tips on where to start?</p>\n"}, {"tags": ["excel", "foreach", "copy-paste", "vba"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 9869887, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7c97360e8287eb474cf7d828803c9ba?s=128&d=identicon&r=PG&f=1", "display_name": "BibiC", "link": "https://stackoverflow.com/users/9869887/bibic"}, "edited": false, "score": 0, "creation_date": 1527683931, "post_id": 50604771, "comment_id": 88219114, "body": "Thx, Now the program is running but it still copy paste only the header"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 3, "user_id": 9869887, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7c97360e8287eb474cf7d828803c9ba?s=128&d=identicon&r=PG&f=1", "display_name": "BibiC", "link": "https://stackoverflow.com/users/9869887/bibic"}, "edited": false, "score": 0, "creation_date": 1527684165, "post_id": 50604771, "comment_id": 88219268, "body": "Well, it seems the destination to which you are pasting is not changed in the loop - it is always <code>Range(&quot;A2&quot;)</code> - <code>consh.Range(&quot;A&quot; &amp; i).Copy wbtarget.Sheets(1).Range(&quot;A2&quot;)</code> Try to change it somehow, like, the Copy destination."}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": true, "score": 0, "last_activity_date": 1527683557, "creation_date": 1527683557, "answer_id": 50604771, "question_id": 50604625, "link": "https://stackoverflow.com/questions/50604625/loop-and-copy-paste-all-rows-equaling-a-variable-into-a-new-excel-file/50604771#50604771", "title": "Loop and Copy/Paste all Rows equaling a variable into a new Excel File", "body": "<p>Your error is here:</p>\n\n<pre><code>consh.Rows(\"A\" &amp; i).Copy wbtarget.Sheets(1).Range(\"A2\")\n</code></pre>\n\n<p>It should be not <code>rows</code>, but <code>Range</code>:</p>\n\n<pre><code>consh.Range(\"A\" &amp; i).Copy wbtarget.Sheets(1).Range(\"A2\")\n</code></pre>\n\n<p>or without the <code>A</code>:</p>\n\n<pre><code>consh.Rows(i).Copy wbtarget.Sheets(1).Range(\"A2\")\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 9869887, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7c97360e8287eb474cf7d828803c9ba?s=128&d=identicon&r=PG&f=1", "display_name": "BibiC", "link": "https://stackoverflow.com/users/9869887/bibic"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 97, "favorite_count": 0, "accepted_answer_id": 50604771, "answer_count": 1, "score": 0, "last_activity_date": 1527683557, "creation_date": 1527683051, "last_edit_date": 1531164843, "question_id": 50604625, "link": "https://stackoverflow.com/questions/50604625/loop-and-copy-paste-all-rows-equaling-a-variable-into-a-new-excel-file", "title": "Loop and Copy/Paste all Rows equaling a variable into a new Excel File", "body": "<p>I'm new to vba so will really appreciate any help .\nAfter a long unfruitful search I can't find why my code won't work.</p>\n\n<p>To explain the problem, I have an Excel File with a bunch of data sorted by an index called Prod.Type in column A.</p>\n\n<p>Here's an example of what I'm trying to do:\n<a href=\"https://i.stack.imgur.com/njXB2.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/njXB2.png\" alt=\"enter image description here\"></a></p>\n\n<p>The code is supposed to:</p>\n\n<p>in a loop to check all Rows value of Prod.Type and \nIf the checked row is equals the variable prodNum then it copy the row into a new excel file.</p>\n\n<p>Else it close the file and increment prodNum and loop again until the whole column has been checked, of course it will create a new Excel file for each produNum which prove to be true.</p>\n\n<p>The result for prodNum = 2 should show only the header and the rows which equals 2</p>\n\n<p>But the result I get is only the headers row getting paste</p>\n\n<p>Here's the code I have made</p>\n\n<pre><code>Sub test()\n\n\n   Dim wbtarget As Excel.Workbook\n   Dim consh As Worksheet\n   Dim prodNum As Long\n   Dim i As Long\n   Dim shnum As Long\n\n   Set consh = ThisWorkbook.Sheets(\"Sheet1\")\n\n   For counter = 1 To 20\n\n   Set wbtarget = Workbooks.Add\n   consh.Rows(1).Copy wbtarget.Sheets(1).Range(\"A1\")\n      For i = 1 To ActiveSheet.Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n          If Range(\"A\" &amp; i).Value = prodNum Then\n              consh.Rows(\"A\" &amp; i).Copy wbtarget.Sheets(1).Range(\"A2\")\n                  Else\n                  wbtarget.SaveAs \"C:\\Users\\Anon\\Desktop\\Project\\\" &amp; shnum &amp; \".xlsx\" 'path to save file\n                  prodNum = prodNum + 1\n                  shnum = shnum + 1\n          End If\n      Next\n   Next counter\nEnd Sub\n</code></pre>\n\n<p>The \"For counter = 1 To 20\" is for testing purpose, I have more than 6000 rows of data to copy paste.</p>\n\n<p>Thanks in advance for any help!</p>\n"}, {"tags": ["excel", "vba", "ibm-midrange", "iseries-navigator"], "comments": [{"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1527692769, "post_id": 50604615, "comment_id": 88225744, "body": "Try a loop like this to force the code to wait -&gt; <code>Do While oIE.ReadyState = 4: WScript.Sleep 100: Loop</code>, until the value is not loaded."}, {"owner": {"reputation": 1032, "user_id": 3175562, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/866fd7f2263cbabce6395353970679ae?s=128&d=identicon&r=PG&f=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/3175562/mike"}, "edited": false, "score": 0, "creation_date": 1534194265, "post_id": 50604615, "comment_id": 90615416, "body": "A solution for this kind of timing issue can be found <a href=\"https://stackoverflow.com/q/33309939/3175562\">here</a>."}], "owner": {"reputation": 31, "user_id": 5979831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/faa6753acb3e221b8ab21e313e0aeee3?s=128&d=identicon&r=PG&f=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/5979831/chris"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 667, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1534219895, "creation_date": 1527683003, "last_edit_date": 1534219895, "question_id": 50604615, "link": "https://stackoverflow.com/questions/50604615/vba-pcomm-macro-runs-in-f8-but-not-in-f5", "title": "VBA-PCOMM Macro runs in F8 but not in F5", "body": "<p>I've been working on PCOMM-VBA macros for a couple of months now. This issue is mostly happens with every macros I write. Although not every cases when I try to run the macro.</p>\n\n<p>I am quite suspicious that the source of the problem is PCOMM cannot keep up with excel hence some parts of the code will be skipped. However reading a couple of posts make me feel maybe excel have some problems with the loops and activesheet in my code. I am not sure what causes the issue but I hope you can direct me to the answer.</p>\n\n<p>The macro's purpose is to update suppliers' email address. To select the suppliers I've created a template which contains the supplier code and couple additional information along with the email address needs to be uploaded.(4 column with a simple .xls) </p>\n\n<p><strong>So be brief: When I run the code in F8 the code runs through without any errors. When I try to run it in F5 the compiler will skip some lines and make an infinite loop (as the requested data will never appear in the field) or worse case actually update it with the wrong data.</strong></p>\n\n<p>Here is the actual code:</p>\n\n<pre><code>Sub email_upload()\n\nDim appExcel As Excel.Application\nDim appWb As Excel.Workbook\nDim appWs As Excel.Worksheet\n\n'This part creates a connection between an existing PCOMM session and Excel\nSet autECLConnMgrObj = CreateObject(\"PCOMM.autECLConnMgr\")\nSet autECLOIAObj = CreateObject(\"PCOMM.autECLOIA\")\nSet autECLSessionObj = CreateObject(\"PCOMM.autECLSession\")\nSet autECLPSObj = CreateObject(\"PCOMM.autECLPS\")\nSet autECLConnList = CreateObject(\"PCOMM.autECLConnList\")\n\nautECLOIAObj.SetConnectionByHandle (autECLConnList(1).Handle)\nautECLPSObj.SetConnectionByHandle (autECLConnList(1).Handle)\nautECLConnList.Refresh\n\n'Opens the template where the supplier codes are in (normal .xls)\nWith Application.FileDialog(1)\n    .Title = \"Please select a file to import!\"\n    .AllowMultiSelect = False\n    If .Show &lt;&gt; -1 Then\n        Exit Sub\n    End If\n    FileSelected = .SelectedItems(1)\nEnd With\n\nfileName = FileSelected\n\nSet appExcel = Excel.Application\nSet appWb = appExcel.Workbooks.Open(fileName:=fileName)\nSet appWs = appWb.Worksheets(\"input\")\n\nappExcel.Visible = True\nappWb.Worksheets(\"input\").Activate\n\nWith appWs\n\nautECLOIAObj.WaitForAppAvailable\n\n'Loop thru every row in the template worksheet \nFor i = 2 To Cells(Rows.Count, \"A\").End(xlUp).Row Step 1\n\n'Start system navigation in AS/400\nautECLPSObj.SetCursorPos 6, 23\nautECLPSObj.SendKeys Cells(i, \"A\")\nautECLPSObj.WaitForAttrib 6, 23, \"00\", \"3c\", 3, 10000\nautECLOIAObj.WaitForInputReady\nautECLOIAObj.WaitForAppAvailable\nautECLPSObj.SendKeys \"[enter]\"\nautECLOIAObj.WaitForInputReady\nautECLOIAObj.WaitForAppAvailable\nautECLPSObj.SendKeys \"[pf13]\"\nautECLOIAObj.WaitForInputReady\nautECLOIAObj.WaitForAppAvailable\nautECLPSObj.SendKeys \"[pf10]\"\nautECLOIAObj.WaitForInputReady\nautECLOIAObj.WaitForAppAvailable\nautECLPSObj.SetCursorPos 13, 24\nautECLPSObj.SendKeys Cells(i, \"B\")\nautECLPSObj.WaitForAttrib 13, 24, \"00\", \"3c\", 3, 10000\nautECLOIAObj.WaitForInputReady\nautECLOIAObj.WaitForAppAvailable\nautECLPSObj.SendKeys \"[enter]\"\nautECLOIAObj.WaitForInputReady\nautECLOIAObj.WaitForAppAvailable\nautECLPSObj.SendKeys \"[pf8]\"\nautECLOIAObj.WaitForInputReady\nautECLOIAObj.WaitForAppAvailable\n\nIf Cells(i, \"C\") = \"\" Then\n    autECLPSObj.SetCursorPos 13, 21\n    autECLPSObj.SendKeys \"1\"\n    autECLPSObj.WaitForAttrib 13, 21, \"00\", \"3c\", 3, 10000\n    autECLOIAObj.WaitForInputReady\n    autECLOIAObj.WaitForAppAvailable\n\nElse\n    autECLPSObj.SetCursorPos 13, 21\n    autECLPSObj.SendKeys Cells(i, \"C\")\n    autECLPSObj.WaitForAttrib 13, 21, \"00\", \"3c\", 3, 10000\n    autECLOIAObj.WaitForInputReady\n    autECLOIAObj.WaitForAppAvailable\nEnd If\n\nautECLPSObj.SetCursorPos 21, 1\nautECLPSObj.SendKeys Cells(i, \"D\")\nautECLPSObj.WaitForAttrib 21, 1, \"00\", \"3c\", 3, 10000\nautECLOIAObj.WaitForInputReady\nautECLOIAObj.WaitForAppAvailable\nautECLPSObj.SendKeys \"[pf8]\"\nautECLOIAObj.WaitForInputReady\nautECLOIAObj.WaitForAppAvailable\nautECLPSObj.SendKeys \"[pf12]\"\nautECLOIAObj.WaitForInputReady\nautECLOIAObj.WaitForAppAvailable\nautECLPSObj.SendKeys \"[pf12]\"\nautECLOIAObj.WaitForInputReady\nautECLOIAObj.WaitForAppAvailable\n\nNext i\n\nEnd With\n\nappWb.Close\nMsgBox (\"Input done!\")\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "listobject"], "comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 3, "creation_date": 1527682548, "post_id": 50604231, "comment_id": 88218138, "body": "It&#39;s a bug. I&#39;ve reported it before but no response as yet."}, {"owner": {"reputation": 33, "user_id": 9869995, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad7026d57e87f00cfedaf37eb3ecb0b2?s=128&d=identicon&r=PG&f=1", "display_name": "Maycl", "link": "https://stackoverflow.com/users/9869995/maycl"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1527684708, "post_id": 50604231, "comment_id": 88219695, "body": "Thanks for the info (and an extremely swift answer)! Well, that sucks, but at least now I don&#39;t need to worry about having missed something obvious:)"}], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 9869995, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad7026d57e87f00cfedaf37eb3ecb0b2?s=128&d=identicon&r=PG&f=1", "display_name": "Maycl", "link": "https://stackoverflow.com/users/9869995/maycl"}, "edited": false, "score": 0, "creation_date": 1527779897, "post_id": 50614907, "comment_id": 88265261, "body": "Thanks for your answer! Your solution has a bit of an advantage over the other one in that it doesn&#39;t delete the whole row when the table is unfiltered. Mark&#39;s answer gave more clarity though, so I&#39;m accepting his. In case anyone else is curious, with this solution, when you omit the <code>Application.DisplayAlerts = False</code> and the table is filtered, it asks you whether you want to delete the whole row. So in effect, it does the same as the other answer when the table is filtered, and deletes just the columns within the table otherwise."}], "tags": [], "owner": {"reputation": 79, "user_id": 6084409, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c2e6abc157d5b0d5a1a0dce6d56dac29?s=128&d=identicon&r=PG&f=1", "display_name": "MiS", "link": "https://stackoverflow.com/users/6084409/mis"}, "is_accepted": false, "score": 1, "last_activity_date": 1527725098, "creation_date": 1527725098, "answer_id": 50614907, "question_id": 50604231, "link": "https://stackoverflow.com/questions/50604231/listrow-delete-method-doesnt-work-on-filtered-table/50614907#50614907", "title": "ListRow.Delete method doesn&#39;t work on filtered table", "body": "<p>See if this works:</p>\n\n<pre><code>Sub FixErrors()\n\n   Dim tbl As ListObject\n   Dim x As Long\n   Set tbl = ActiveSheet.ListObjects(\"Kontakty\")\n\n   Application.DisplayAlerts = False\n\n   For x = tbl.ListRows.Count To 1 Step -1\n       If tbl.ListRows(x).Range.Columns(tbl.ListColumns(\"AutoCheck\").Index) = False Then\n          tbl.ListRows(x).Range.Delete\n       End If\n   Next x\n\n   Application.DisplayAlerts = True\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 33, "user_id": 9869995, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad7026d57e87f00cfedaf37eb3ecb0b2?s=128&d=identicon&r=PG&f=1", "display_name": "Maycl", "link": "https://stackoverflow.com/users/9869995/maycl"}, "edited": false, "score": 0, "creation_date": 1527779226, "post_id": 50615536, "comment_id": 88264861, "body": "Thank you for the clarifications! It is strange though that you&#39;re getting that error with my code, it doesn&#39;t get thown for me (Office Professional Plus 2016, don&#39;t know if there&#39;s a difference in version, some settings or what). Anyway, your solution works for me! I don&#39;t have anything next to the table, so deleting a whole row is ok, even though it would have been nicer to not have the macro affecting any area outside the table itself."}], "tags": [], "owner": {"reputation": 2953, "user_id": 2801253, "user_type": "registered", "profile_image": "https://graph.facebook.com/1332362525/picture?type=large", "display_name": "Mark Fitzgerald", "link": "https://stackoverflow.com/users/2801253/mark-fitzgerald"}, "is_accepted": true, "score": 2, "last_activity_date": 1527731388, "creation_date": 1527731388, "answer_id": 50615536, "question_id": 50604231, "link": "https://stackoverflow.com/questions/50604231/listrow-delete-method-doesnt-work-on-filtered-table/50615536#50615536", "title": "ListRow.Delete method doesn&#39;t work on filtered table", "body": "<p>This behaviour in Tables seems to be by design.  I'm not sure why it is so or what the consequences of allowing filtered table row deletion may be.  If you right-click a filtered table cell then go to Delete, your options are Table Columns or Entire Sheet Row.</p>\n\n<p>Running your code throws a run-time 1004 at the <code>tbl.ListRows(x).Range.Delete</code> line:</p>\n\n<p><a href=\"https://i.stack.imgur.com/UaLu0.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/UaLu0.jpg\" alt=\"Can&#39;t move cells\"></a></p>\n\n<p>However, given the right-click Delete options described above, it should be possible to delete the <code>EntireRow</code>:</p>\n\n<pre><code>Sub FixErrors()\nDim tbl As ListObject\nDim x As Long\n\n    Set tbl = ActiveSheet.ListObjects(\"Kontakty\")\n\n    For x = tbl.ListRows.Count To 1 Step -1\n        If tbl.ListRows(x).Range.Columns(tbl.ListColumns(\"AutoCheck\").Index) = False Then\n            tbl.ListRows(x).Range.EntireRow.Delete\n        End If\n    Next x\n\nEnd Sub\n</code></pre>\n\n<p>Tested in Excel 365 and it works!</p>\n"}], "owner": {"reputation": 33, "user_id": 9869995, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad7026d57e87f00cfedaf37eb3ecb0b2?s=128&d=identicon&r=PG&f=1", "display_name": "Maycl", "link": "https://stackoverflow.com/users/9869995/maycl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1437, "favorite_count": 0, "accepted_answer_id": 50615536, "answer_count": 2, "score": 3, "last_activity_date": 1527731388, "creation_date": 1527681827, "question_id": 50604231, "link": "https://stackoverflow.com/questions/50604231/listrow-delete-method-doesnt-work-on-filtered-table", "title": "ListRow.Delete method doesn&#39;t work on filtered table", "body": "<p>I am trying to figure out why the VBA <code>ListRow.Delete</code> method seems to work differently when my table is filtered and when it isn't.</p>\n\n<p>I have a table with e-mail addresses, and have a column called <code>AutoCheck</code> with a formula that checks if the address fulfills my validity criteria. I also have a macro (tied to some buttons) that removes all the rows of the table that have the <code>AutoCheck</code> value at <code>False</code>:</p>\n\n<pre><code>Sub FixErrors()\n\n    Dim tbl As ListObject\n    Dim x As Long\n    Set tbl = ActiveSheet.ListObjects(\"Kontakty\")\n\n    For x = tbl.ListRows.Count To 1 Step -1\n        If tbl.ListRows(x).Range.Columns(tbl.ListColumns(\"AutoCheck\").Index) = False Then\n            tbl.ListRows(x).Delete\n        End If\n    Next x\n\n\nEnd Sub\n</code></pre>\n\n<p>This works like a charm when I have the whole table displayed, but when I apply a filter and display only some entries (whether the offending rows are filtered out or not), the macro suddenly stops working! I have tried some debugging and remain completely baffled. I set a breakpoint at the line of <code>tbl.ListRows(x).Delete</code>, and it correctly identifies the offending row (a watch for <code>tbl.ListRows(x).Range.Columns(tbl.ListColumns(\"Email\").Index)</code> displays the correct email I need to remove), but the <code>tbl.ListRows(x).Delete</code> just doesn't do anything, I step through it and nothing changes!</p>\n\n<p>I'm sure I'm missing something here, I'd appreciate any help.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "edited": false, "score": 0, "creation_date": 1527681461, "post_id": 50603733, "comment_id": 88217361, "body": "what is <code>d105TicksheetNightsFigures</code> ?"}, {"owner": {"reputation": 39, "user_id": 7863160, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154308644155894/picture?type=large", "display_name": "Lee Read", "link": "https://stackoverflow.com/users/7863160/lee-read"}, "reply_to_user": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "edited": false, "score": 0, "creation_date": 1527681563, "post_id": 50603733, "comment_id": 88217433, "body": "Its an 2 dimensional array that ive passed data from a Table in an external workbook."}], "answers": [{"comments": [{"owner": {"reputation": 39, "user_id": 7863160, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154308644155894/picture?type=large", "display_name": "Lee Read", "link": "https://stackoverflow.com/users/7863160/lee-read"}, "edited": false, "score": 0, "creation_date": 1527681855, "post_id": 50604167, "comment_id": 88217640, "body": "Thanks I will try, however i dont need the 1st column in the table hence why only 9 columns are in the code. I will see if i can adjust the code to only read columns 2-10 then drop to next row"}, {"owner": {"reputation": 2031, "user_id": 6097926, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/187bc2674bbdf7651e7137e1427b9bd6?s=128&d=identicon&r=PG&f=1", "display_name": "Ryszard J\u0119draszyk", "link": "https://stackoverflow.com/users/6097926/ryszard-j%c4%99draszyk"}, "reply_to_user": {"reputation": 39, "user_id": 7863160, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154308644155894/picture?type=large", "display_name": "Lee Read", "link": "https://stackoverflow.com/users/7863160/lee-read"}, "edited": false, "score": 0, "creation_date": 1527681902, "post_id": 50604167, "comment_id": 88217669, "body": "I &#39;ve adjusted it."}, {"owner": {"reputation": 39, "user_id": 7863160, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154308644155894/picture?type=large", "display_name": "Lee Read", "link": "https://stackoverflow.com/users/7863160/lee-read"}, "edited": false, "score": 0, "creation_date": 1527682133, "post_id": 50604167, "comment_id": 88217828, "body": "Thanks ill give it a go, and let you know. Really appreaciate the quick reply"}, {"owner": {"reputation": 39, "user_id": 7863160, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154308644155894/picture?type=large", "display_name": "Lee Read", "link": "https://stackoverflow.com/users/7863160/lee-read"}, "edited": false, "score": 0, "creation_date": 1527682511, "post_id": 50604167, "comment_id": 88218121, "body": "Great! it works like a charm and solves the next problem I was going to have. I&#39;ll try and understand it and hopefully I&#39;ll stop running into these same kind of problems in the future."}], "tags": [], "owner": {"reputation": 2031, "user_id": 6097926, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/187bc2674bbdf7651e7137e1427b9bd6?s=128&d=identicon&r=PG&f=1", "display_name": "Ryszard J\u0119draszyk", "link": "https://stackoverflow.com/users/6097926/ryszard-j%c4%99draszyk"}, "is_accepted": true, "score": 2, "last_activity_date": 1527681880, "last_edit_date": 1527681880, "creation_date": 1527681662, "answer_id": 50604167, "question_id": 50603733, "link": "https://stackoverflow.com/questions/50603733/confused-with-nested-loops-vba-again/50604167#50604167", "title": "Confused with nested Loops VBA Again", "body": "<p>Try this code (transfers data starting from 2nd column):   </p>\n\n<pre><code>Const tRows as Long = 4\nConst tColumns as Long = 10    \n\nDim i as Long, rowCounter as Long, colCounter as Long, outStart as Long\noutStart = 132\n\nWith ActiveSheet.ListObjects(\"d105WeeklyTable\")\n    For i = 1 To .ListRows.Count\n        If .DataBodyRange(i, 2).Value = wkComm Then\n            For rowCounter = 1 to tRows\n                For colCounter = 2 to tColumns                        \n                    .DataBodyRange(i, outStart).Value = d105TicksheetNightsFigures(rowCounter, colCounter)\n                    outStart = outStart + 1                        \n                Next colCounter\n            Next rowCounter\n        End If\n    Next i\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 39, "user_id": 7863160, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154308644155894/picture?type=large", "display_name": "Lee Read", "link": "https://stackoverflow.com/users/7863160/lee-read"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 44, "favorite_count": 0, "accepted_answer_id": 50604167, "answer_count": 1, "score": 3, "last_activity_date": 1527681880, "creation_date": 1527680383, "question_id": 50603733, "link": "https://stackoverflow.com/questions/50603733/confused-with-nested-loops-vba-again", "title": "Confused with nested Loops VBA Again", "body": "<p>Once again I've got myself into trouble with something that should be rather basic. I know there is a faster solution to this problem, however I cant seem to get the loops right. </p>\n\n<p>Essentially I would like to shorten this code, as I have a larger table and array to deal with next and my current solution below would require numerous lines. </p>\n\n<p>The source table has 10 columns and 4 rows.. I need to read data from the source table and assign it to one line of the destination table \"d105WeeklyTable\" </p>\n\n<p>Any help would be greatly appreciated.</p>\n\n<pre><code>With ActiveSheet.ListObjects(\"d105WeeklyTable\")\n    For i = 1 To .ListRows.Count\n        If .DataBodyRange(i, 2).Value = wkComm Then\n\n                .DataBodyRange(i, 132).Value = d105TicksheetNightsFigures(1, 2)\n                .DataBodyRange(i, 133).Value = d105TicksheetNightsFigures(1, 3)\n                .DataBodyRange(i, 134).Value = d105TicksheetNightsFigures(1, 4)\n                .DataBodyRange(i, 135).Value = d105TicksheetNightsFigures(1, 5)\n                .DataBodyRange(i, 136).Value = d105TicksheetNightsFigures(1, 6)\n                .DataBodyRange(i, 137).Value = d105TicksheetNightsFigures(1, 7)\n                .DataBodyRange(i, 138).Value = d105TicksheetNightsFigures(1, 8)\n                .DataBodyRange(i, 139).Value = d105TicksheetNightsFigures(1, 9)\n                .DataBodyRange(i, 140).Value = d105TicksheetNightsFigures(1, 10)\n\n                .DataBodyRange(i, 141).Value = d105TicksheetNightsFigures(2, 2)\n                .DataBodyRange(i, 142).Value = d105TicksheetNightsFigures(2, 3)\n                .DataBodyRange(i, 143).Value = d105TicksheetNightsFigures(2, 4)\n                .DataBodyRange(i, 144).Value = d105TicksheetNightsFigures(2, 5)\n                .DataBodyRange(i, 145).Value = d105TicksheetNightsFigures(2, 6)\n                .DataBodyRange(i, 146).Value = d105TicksheetNightsFigures(2, 7)\n                .DataBodyRange(i, 147).Value = d105TicksheetNightsFigures(2, 8)\n                .DataBodyRange(i, 148).Value = d105TicksheetNightsFigures(2, 9)\n                .DataBodyRange(i, 149).Value = d105TicksheetNightsFigures(2, 10)\n\n                .DataBodyRange(i, 150).Value = d105TicksheetNightsFigures(3, 2)\n                .DataBodyRange(i, 151).Value = d105TicksheetNightsFigures(3, 3)\n                .DataBodyRange(i, 152).Value = d105TicksheetNightsFigures(3, 4)\n                .DataBodyRange(i, 153).Value = d105TicksheetNightsFigures(3, 5)\n                .DataBodyRange(i, 154).Value = d105TicksheetNightsFigures(3, 6)\n                .DataBodyRange(i, 155).Value = d105TicksheetNightsFigures(3, 7)\n                .DataBodyRange(i, 156).Value = d105TicksheetNightsFigures(3, 8)\n                .DataBodyRange(i, 157).Value = d105TicksheetNightsFigures(3, 9)\n                .DataBodyRange(i, 158).Value = d105TicksheetNightsFigures(3, 10)\n\n                .DataBodyRange(i, 159).Value = d105TicksheetNightsFigures(4, 2)\n                .DataBodyRange(i, 160).Value = d105TicksheetNightsFigures(4, 3)\n                .DataBodyRange(i, 161).Value = d105TicksheetNightsFigures(4, 4)\n                .DataBodyRange(i, 162).Value = d105TicksheetNightsFigures(4, 5)\n                .DataBodyRange(i, 163).Value = d105TicksheetNightsFigures(4, 6)\n                .DataBodyRange(i, 164).Value = d105TicksheetNightsFigures(4, 7)\n                .DataBodyRange(i, 165).Value = d105TicksheetNightsFigures(4, 8)\n                .DataBodyRange(i, 166).Value = d105TicksheetNightsFigures(4, 9)\n                .DataBodyRange(i, 167).Value = d105TicksheetNightsFigures(4, 10)\n\n        End If\n\n    Next i\nEnd With\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 77, "user_id": 9629100, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/25a6c223df08541e7445ba60e1a935d5?s=128&d=identicon&r=PG&f=1", "display_name": "Juan", "link": "https://stackoverflow.com/users/9629100/juan"}, "edited": false, "score": 0, "creation_date": 1527688448, "post_id": 50604155, "comment_id": 88222560, "body": "Thanks for your answer. I&#39;m sorry, I&#39;m new at this. <code>inicio</code> is the page&#39;s name. I want to get the <code>InputBox</code> when clicking in the page tab. I just paste your code at <b>ThisWorkbook</b> and its does nothing. What am I doing wrong?"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 77, "user_id": 9629100, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/25a6c223df08541e7445ba60e1a935d5?s=128&d=identicon&r=PG&f=1", "display_name": "Juan", "link": "https://stackoverflow.com/users/9629100/juan"}, "edited": false, "score": 0, "creation_date": 1527689196, "post_id": 50604155, "comment_id": 88223126, "body": "@Juan - do you have a worksheet named <code>Sheet1</code>? What happens when you select it?"}, {"owner": {"reputation": 77, "user_id": 9629100, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/25a6c223df08541e7445ba60e1a935d5?s=128&d=identicon&r=PG&f=1", "display_name": "Juan", "link": "https://stackoverflow.com/users/9629100/juan"}, "edited": false, "score": 0, "creation_date": 1527689475, "post_id": 50604155, "comment_id": 88223342, "body": "<i>do you have a worksheet named Sheet1?</i> -no, I don&#39;t. But I wrote inicio instead. <i>What happens when you select it?</i> - nothing, it opens normally"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 77, "user_id": 9629100, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/25a6c223df08541e7445ba60e1a935d5?s=128&d=identicon&r=PG&f=1", "display_name": "Juan", "link": "https://stackoverflow.com/users/9629100/juan"}, "edited": false, "score": 0, "creation_date": 1527689507, "post_id": 50604155, "comment_id": 88223364, "body": "@Juan - and when you select the <code>inicio</code> sheet nothing happens?"}, {"owner": {"reputation": 77, "user_id": 9629100, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/25a6c223df08541e7445ba60e1a935d5?s=128&d=identicon&r=PG&f=1", "display_name": "Juan", "link": "https://stackoverflow.com/users/9629100/juan"}, "edited": false, "score": 0, "creation_date": 1527689832, "post_id": 50604155, "comment_id": 88223610, "body": "it works now! I didn&#39;t change nothing haha thank you! One more question: if I want to use different pass for each worksheet, is fine if I just copy-pase in ThisWorkbook changing values?"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 77, "user_id": 9629100, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/25a6c223df08541e7445ba60e1a935d5?s=128&d=identicon&r=PG&f=1", "display_name": "Juan", "link": "https://stackoverflow.com/users/9629100/juan"}, "edited": false, "score": 1, "creation_date": 1527689951, "post_id": 50604155, "comment_id": 88223702, "body": "@Juan - for different passwords, the easiest way is to declare an array in the <code>ThisWorkbook</code> and every time to refer to a different element, depending on the sheet. Something like <code>Array(Sheet1,Sheet3,Sheet4)</code> and <code>Array(pwd1, pwd3,pwd4)</code>. Thus, for <code>Sheet4</code> the password would be <code>pwd4</code>."}, {"owner": {"reputation": 77, "user_id": 9629100, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/25a6c223df08541e7445ba60e1a935d5?s=128&d=identicon&r=PG&f=1", "display_name": "Juan", "link": "https://stackoverflow.com/users/9629100/juan"}, "edited": false, "score": 0, "creation_date": 1527690118, "post_id": 50604155, "comment_id": 88223814, "body": "Thanks a lot! @Vityata"}, {"owner": {"reputation": 77, "user_id": 9629100, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/25a6c223df08541e7445ba60e1a935d5?s=128&d=identicon&r=PG&f=1", "display_name": "Juan", "link": "https://stackoverflow.com/users/9629100/juan"}, "edited": false, "score": 0, "creation_date": 1527692196, "post_id": 50604155, "comment_id": 88225349, "body": "one last question, seriously. What can I do to ask for password to open other worksheet and only show it if the pass is correct? The way you gave asks for pass to work in the worksheet, but it shows anyway. I need to display an InputBox on worksheet click. I&#39;m sorry if I&#39;m explaining bad"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 77, "user_id": 9629100, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/25a6c223df08541e7445ba60e1a935d5?s=128&d=identicon&r=PG&f=1", "display_name": "Juan", "link": "https://stackoverflow.com/users/9629100/juan"}, "edited": false, "score": 0, "creation_date": 1527692485, "post_id": 50604155, "comment_id": 88225549, "body": "<code>Sh.Visible = CBool(response = &quot;abc&quot;)</code> should be only visible if the password is <code>abc</code>, I do not get it."}, {"owner": {"reputation": 77, "user_id": 9629100, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/25a6c223df08541e7445ba60e1a935d5?s=128&d=identicon&r=PG&f=1", "display_name": "Juan", "link": "https://stackoverflow.com/users/9629100/juan"}, "edited": false, "score": 0, "creation_date": 1527693986, "post_id": 50604155, "comment_id": 88226564, "body": "sorry, I mean: by that way it asks for pass when I click on the worksheet, but showing the page while InputBox. I want the same but showing the page <b>after</b> inserting the password. Did I explain ok?"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 77, "user_id": 9629100, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/25a6c223df08541e7445ba60e1a935d5?s=128&d=identicon&r=PG&f=1", "display_name": "Juan", "link": "https://stackoverflow.com/users/9629100/juan"}, "edited": false, "score": 0, "creation_date": 1527694067, "post_id": 50604155, "comment_id": 88226607, "body": "@Juan - write         <code>If Sh.Count &gt;1 Then Sh.Visible = False</code> somewhere on the top."}, {"owner": {"reputation": 77, "user_id": 9629100, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/25a6c223df08541e7445ba60e1a935d5?s=128&d=identicon&r=PG&f=1", "display_name": "Juan", "link": "https://stackoverflow.com/users/9629100/juan"}, "edited": false, "score": 0, "creation_date": 1527694516, "post_id": 50604155, "comment_id": 88226896, "body": "it doesn&#39;t work, but don&#39;t worry, you did help a lot at this point! I will post a solution for this when I solve it. Thank you!"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 77, "user_id": 9629100, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/25a6c223df08541e7445ba60e1a935d5?s=128&d=identicon&r=PG&f=1", "display_name": "Juan", "link": "https://stackoverflow.com/users/9629100/juan"}, "edited": false, "score": 0, "creation_date": 1527694758, "post_id": 50604155, "comment_id": 88227039, "body": "@Juan -  I am not worried, thank you. In general, you may ask a separate question, although it should be working..."}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": true, "score": 1, "last_activity_date": 1527694728, "last_edit_date": 1527694728, "creation_date": 1527681624, "answer_id": 50604155, "question_id": 50603647, "link": "https://stackoverflow.com/questions/50603647/excel-vba-set-pass-for-each-page-tab/50604155#50604155", "title": "excel-vba set pass for each page tab", "body": "<p>Use <code>Option Explicit</code>. Then you would notice, that <code>inicio</code> is a variable, and not a name. In general, your code should work, if you write <code>\"inicio\"</code>.</p>\n\n<p>Or something like this, if you ignore the <code>inicio</code> and use the <code>MySheet</code> string variable that you have already declared:</p>\n\n<pre><code>Option Explicit\n\nPrivate Sub Workbook_SheetActivate(ByVal Sh As Object)\n\n    Dim MySheet As String, Response As String\n    MySheet = \"Sheet1\"\n\n    If ActiveSheet.Name = MySheet Then\n        ActiveSheet.Visible = False\n        Response = InputBox(\"Enter password to view sheet\")\n        If Response = \"abc\" Then\n            Sheets(MySheet).Visible = True\n            Application.EnableEvents = False\n            Sheets(MySheet).Select\n            Application.EnableEvents = True\n        End If\n    End If\n\nEnd Sub\n</code></pre>\n\n<p>Or this way, if you want to do it a bit smaller, using the <code>Sh</code> parameter and not <code>ActiveSheet</code>:</p>\n\n<pre><code>Private Sub Workbook_SheetActivate(ByVal Sh As Object)\n\n    Dim mySheet As String: mySheet = \"Sheet1\"\n    Dim response As String\n\n    If Sh.Name = mySheet Then\n        response = InputBox(\"Enter password to view sheet\")\n        Sh.Visible = CBool(response = \"abc\")\n    End If\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 77, "user_id": 9629100, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/25a6c223df08541e7445ba60e1a935d5?s=128&d=identicon&r=PG&f=1", "display_name": "Juan", "link": "https://stackoverflow.com/users/9629100/juan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 24, "favorite_count": 1, "accepted_answer_id": 50604155, "answer_count": 1, "score": 1, "last_activity_date": 1527694728, "creation_date": 1527680118, "last_edit_date": 1531161705, "question_id": 50603647, "link": "https://stackoverflow.com/questions/50603647/excel-vba-set-pass-for-each-page-tab", "title": "excel-vba set pass for each page tab", "body": "<p>I'm trying to add a password to each page of the book, so when I click one page tab, I get an inputBox asking for its pass. Each page has unique password. How can I do it? I tried writing this code at vba ThisWorkbook but it does nothing:</p>\n\n<pre><code>Private Sub Workbook_SheetActivate(ByVal Sh As Object)\nDim MySheets As String, Response As String\nMySheet = \"Sheet1\"\nIf ActiveSheet.Name = inicio Then\nActiveSheet.Visible = False\nResponse = InputBox(\"Enter password to view sheet\")\n    If Response = \"abc\" Then\n        Sheets(MySheet).Visible = True\n        Application.EnableEvents = False\n        Sheets(MySheet).Select\n        Application.EnableEvents = True\n    End If\nEnd If\nSheets(MySheet).Visible = True\nEnd Sub\n</code></pre>\n\n<p>Thanks in advance!</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 21459, "user_id": 3894917, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/41Fan.jpg?s=128&g=1", "display_name": "Tom Sharpe", "link": "https://stackoverflow.com/users/3894917/tom-sharpe"}, "edited": false, "score": 0, "creation_date": 1527681738, "post_id": 50603342, "comment_id": 88217545, "body": "Neat! Must admit I was struggling with this when I tried to write an answer because Application.Transpose didn&#39;t seem to return a range so I couldn&#39;t then use range.copy. Could you comment plz? Maybe it&#39;s a separate question?"}, {"owner": {"reputation": 6533, "user_id": 8466523, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JNrm6.jpg?s=128&g=1", "display_name": "Olly", "link": "https://stackoverflow.com/users/8466523/olly"}, "reply_to_user": {"reputation": 21459, "user_id": 3894917, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/41Fan.jpg?s=128&g=1", "display_name": "Tom Sharpe", "link": "https://stackoverflow.com/users/3894917/tom-sharpe"}, "edited": false, "score": 0, "creation_date": 1527681990, "post_id": 50603342, "comment_id": 88217736, "body": "@TomSharpe Application.Transpose transposes an array - so the line of code above effectively reads in an array from the (&quot;A&quot;) specified range, transposes that array, then writes it back to the (&quot;D&quot;) specified range."}, {"owner": {"reputation": 21459, "user_id": 3894917, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/41Fan.jpg?s=128&g=1", "display_name": "Tom Sharpe", "link": "https://stackoverflow.com/users/3894917/tom-sharpe"}, "edited": false, "score": 0, "creation_date": 1527683028, "post_id": 50603342, "comment_id": 88218472, "body": "OK, thanks, got it now, to make my version work I would have had to put rt.value=application.transpose(r) where r is my input range and rt is my output range - embarrassingly basic!"}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 0, "creation_date": 1527683499, "post_id": 50603342, "comment_id": 88218810, "body": "Sweet Code! Both answers are good examples of <i>Resize()</i> and <i>Offset()</i>............also show imaginative looping"}], "tags": [], "owner": {"reputation": 6533, "user_id": 8466523, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JNrm6.jpg?s=128&g=1", "display_name": "Olly", "link": "https://stackoverflow.com/users/8466523/olly"}, "is_accepted": false, "score": 4, "last_activity_date": 1527679155, "creation_date": 1527679155, "answer_id": 50603342, "question_id": 50603202, "link": "https://stackoverflow.com/questions/50603202/vba-code-to-copy-group-of-3-cells-from-a-column-to-row/50603342#50603342", "title": "VBA code to copy group of 3 cells from a column to row", "body": "<p>You don't need to <code>Select</code>, or even <code>Copy / Paste</code>. This will be faster:</p>\n\n<pre><code>Dim l As Long\nFor l = 1 To 200\n    With Sheet1\n        .Cells(l, \"D\").Resize(1, 3) = Application.Transpose(.Cells(l * 4, \"A\").Resize(3, 1))\n    End With\nNext l\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 21, "user_id": 9869814, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2fd8c9872ecad473dd9b1f9337e12e0c?s=128&d=identicon&r=PG&f=1", "display_name": "Archit", "link": "https://stackoverflow.com/users/9869814/archit"}, "edited": false, "score": 1, "creation_date": 1527681852, "post_id": 50603386, "comment_id": 88217635, "body": "thanks for this suggestion Vityata! going forward will use .offset()"}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 3, "last_activity_date": 1527685032, "last_edit_date": 1527685032, "creation_date": 1527679293, "answer_id": 50603386, "question_id": 50603202, "link": "https://stackoverflow.com/questions/50603202/vba-code-to-copy-group-of-3-cells-from-a-column-to-row/50603386#50603386", "title": "VBA code to copy group of 3 cells from a column to row", "body": "<p>This is really a must-read for everyone in the <a href=\"/questions/tagged/vba\" class=\"post-tag\" title=\"show questions tagged &#39;vba&#39;\" rel=\"tag\">vba</a> in StackOverflow: <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">How to avoid using Select in Excel VBA</a></p>\n\n<p>Following its rules and using <code>.Offset()</code>:</p>\n\n<pre><code>Public Sub TestMe()\n\n    Dim cnt As Long\n    Dim ws As Worksheet: Set ws = Worksheets(1)\n\n    Dim copiedRange As Range: Set copiedRange = ws.Range(\"A4:A6\")\n    Dim targetRange As Range: Set targetRange = ws.Range(\"D1\")\n\n    For cnt = 1 To 20 'or 200\n        copiedRange.Copy\n        targetRange.PasteSpecial Paste:=xlPasteAll, Transpose:=True\n\n        Set copiedRange = copiedRange.Offset(4)\n        Set targetRange = targetRange.Offset(1)\n\n    Next cnt\n    Application.CutCopyMode = False\n\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://msdn.microsoft.com/en-us/vba/excel-vba/articles/range-offset-property-excel\" rel=\"nofollow noreferrer\">MSDN Range.Offset Property</a></p>\n"}], "owner": {"reputation": 21, "user_id": 9869814, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2fd8c9872ecad473dd9b1f9337e12e0c?s=128&d=identicon&r=PG&f=1", "display_name": "Archit", "link": "https://stackoverflow.com/users/9869814/archit"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 88, "favorite_count": 1, "answer_count": 2, "score": 2, "last_activity_date": 1530288085, "creation_date": 1527678728, "last_edit_date": 1530288085, "question_id": 50603202, "link": "https://stackoverflow.com/questions/50603202/vba-code-to-copy-group-of-3-cells-from-a-column-to-row", "title": "VBA code to copy group of 3 cells from a column to row", "body": "<p>This is my first day VBA coding, I am trying to copy multiple groups of 3 cells to another location on worksheet and transpose them. Please look the following code for reference:</p>\n\n<pre><code>Range(\"A4:A6\").Select\nSelection.Copy\nRange(\"D1\").Select\nSelection.PasteSpecial Paste:=xlPasteAll, Operation:=xlNone, SkipBlanks:= _\n    False, Transpose:=True\nRange(\"A8:A10\").Select\nSelection.Copy\nRange(\"D2\").Select\nSelection.PasteSpecial Paste:=xlPasteAll, Operation:=xlNone, SkipBlanks:= _\n    False, Transpose:=True\nRange(\"A12:A14\").Select\nSelection.Copy\nRange(\"D3\").Select\nSelection.PasteSpecial Paste:=xlPasteAll, Operation:=xlNone, SkipBlanks:= _\n    False, Transpose:=True\nRange(\"A16:A18\").Select\nSelection.Copy\nRange(\"D4\").Select\nSelection.PasteSpecial Paste:=xlPasteAll, Operation:=xlNone, SkipBlanks:= _\n    False, Transpose:=True\nRange(\"A20:A22\").Select\nSelection.Copy\nRange(\"D5\").Select\nSelection.PasteSpecial Paste:=xlPasteAll, Operation:=xlNone, SkipBlanks:= _\n    False, Transpose:=True\n</code></pre>\n\n<p>So I want to run this code for next 200 cells. Any suggestions?</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 1026, "user_id": 8788388, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-j4tnBdMaXfk/AAAAAAAAAAI/AAAAAAACwcU/Jg67BYcCeW0/photo.jpg?sz=128", "display_name": "Hakan ERDOGAN", "link": "https://stackoverflow.com/users/8788388/hakan-erdogan"}, "is_accepted": false, "score": 0, "last_activity_date": 1527685053, "creation_date": 1527685053, "answer_id": 50605343, "question_id": 50602967, "link": "https://stackoverflow.com/questions/50602967/how-can-i-export-a-chart-and-multiple-rows-from-an-excel-sheet-to-pdf/50605343#50605343", "title": "How can i export a chart and multiple rows from an excel sheet to pdf", "body": "<p>Select everything you want to be exported. Select <strong>Right Click</strong> / <strong>Set Print Area</strong>. This way you should be able to export what you have selected explicitly.</p>\n\n<p>If you have difficulty printing everything on one page, play around with <strong>Scaling</strong> properties on the <strong>Print Preview</strong> page and try exporting again.</p>\n"}], "owner": {"reputation": 1, "user_id": 9869736, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/41d7673f675277e4c6f1537fb99ffa31?s=128&d=identicon&r=PG&f=1", "display_name": "mayank", "link": "https://stackoverflow.com/users/9869736/mayank"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 25, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1527693205, "creation_date": 1527677988, "last_edit_date": 1527693205, "question_id": 50602967, "link": "https://stackoverflow.com/questions/50602967/how-can-i-export-a-chart-and-multiple-rows-from-an-excel-sheet-to-pdf", "title": "How can i export a chart and multiple rows from an excel sheet to pdf", "body": "<p>I have an organogram chart in excel and few rows based on which this organogram chart is constructed. Both the chart and data rows are in the same worksheet.   </p>\n\n<p>I need to get this chart printed on the upper half of the pdf and the data rows just below the chart. </p>\n\n<p>I have figured out how to get both chart and data rows printed individually in the pdf but i am unable to figure out how to get the data rows printed below the chart on the same page.</p>\n"}, {"tags": ["c#", "excel", "vba", "dll", "activex"], "comments": [{"owner": {"reputation": 158803, "user_id": 246342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8ba0aea3f521082f18dd7c186e7d4c3?s=128&d=identicon&r=PG", "display_name": "Alex K.", "link": "https://stackoverflow.com/users/246342/alex-k"}, "edited": false, "score": 0, "creation_date": 1527678086, "post_id": 50602888, "comment_id": 88215018, "body": "Use regasm.exe on the failing machine to manually register the DLL, if that makes it work your installer is not registering the DLL correctly."}, {"owner": {"reputation": 535, "user_id": 3668759, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/9f071fe3e57f795555dfa339ca70ed7d?s=128&d=identicon&r=PG&f=1", "display_name": "Gadziu", "link": "https://stackoverflow.com/users/3668759/gadziu"}, "reply_to_user": {"reputation": 158803, "user_id": 246342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8ba0aea3f521082f18dd7c186e7d4c3?s=128&d=identicon&r=PG", "display_name": "Alex K.", "link": "https://stackoverflow.com/users/246342/alex-k"}, "edited": false, "score": 0, "creation_date": 1527678697, "post_id": 50602888, "comment_id": 88215464, "body": "I registered it manually. I got <i>Types registered successfully Assembly exported to &#39;PATH&#39;, and the type library was registered successfully</i>, but the problem is still there."}, {"owner": {"reputation": 158803, "user_id": 246342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8ba0aea3f521082f18dd7c186e7d4c3?s=128&d=identicon&r=PG", "display_name": "Alex K.", "link": "https://stackoverflow.com/users/246342/alex-k"}, "edited": false, "score": 0, "creation_date": 1527678906, "post_id": 50602888, "comment_id": 88215602, "body": "The bitness of the DLL &amp; Office match?"}, {"owner": {"reputation": 535, "user_id": 3668759, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/9f071fe3e57f795555dfa339ca70ed7d?s=128&d=identicon&r=PG&f=1", "display_name": "Gadziu", "link": "https://stackoverflow.com/users/3668759/gadziu"}, "reply_to_user": {"reputation": 158803, "user_id": 246342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8ba0aea3f521082f18dd7c186e7d4c3?s=128&d=identicon&r=PG", "display_name": "Alex K.", "link": "https://stackoverflow.com/users/246342/alex-k"}, "edited": false, "score": 0, "creation_date": 1527678996, "post_id": 50602888, "comment_id": 88215660, "body": "Hmm, I&#39;m not sure. How to check bitness of DLL?"}, {"owner": {"reputation": 158803, "user_id": 246342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8ba0aea3f521082f18dd7c186e7d4c3?s=128&d=identicon&r=PG", "display_name": "Alex K.", "link": "https://stackoverflow.com/users/246342/alex-k"}, "edited": false, "score": 0, "creation_date": 1527679037, "post_id": 50602888, "comment_id": 88215689, "body": "If your using 64 bit Excel the DLL must be (compiled as) 64 bit, ditto for 32 bit."}, {"owner": {"reputation": 535, "user_id": 3668759, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/9f071fe3e57f795555dfa339ca70ed7d?s=128&d=identicon&r=PG&f=1", "display_name": "Gadziu", "link": "https://stackoverflow.com/users/3668759/gadziu"}, "reply_to_user": {"reputation": 158803, "user_id": 246342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8ba0aea3f521082f18dd7c186e7d4c3?s=128&d=identicon&r=PG", "display_name": "Alex K.", "link": "https://stackoverflow.com/users/246342/alex-k"}, "edited": false, "score": 0, "creation_date": 1527787172, "post_id": 50602888, "comment_id": 88269152, "body": "@AlexK. New info above"}, {"owner": {"reputation": 870061, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 1, "creation_date": 1527787706, "post_id": 50602888, "comment_id": 88269412, "body": "The Codebase value is very important.  If it is missing then the assembly must to stored in the GAC."}, {"owner": {"reputation": 535, "user_id": 3668759, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/9f071fe3e57f795555dfa339ca70ed7d?s=128&d=identicon&r=PG&f=1", "display_name": "Gadziu", "link": "https://stackoverflow.com/users/3668759/gadziu"}, "edited": false, "score": 0, "creation_date": 1527788172, "post_id": 50602888, "comment_id": 88269665, "body": "Can give mem more information, what I should to do?"}, {"owner": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "edited": false, "score": 0, "creation_date": 1529169622, "post_id": 50602888, "comment_id": 88781236, "body": "Is this really an &quot;addin&quot; (there is a specific VS project type) or is it a &#39;Class Library&#39; (otherwise known as Assemblt/DLL)?"}, {"owner": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "edited": false, "score": 0, "creation_date": 1529169996, "post_id": 50602888, "comment_id": 88781321, "body": "Check out this Q&amp;A to see RegAsm.exe explained <a href=\"https://stackoverflow.com/questions/3534600/what-does-register-for-com-interop-actually-do\" title=\"what does register for com interop actually do\">stackoverflow.com/questions/3534600/&hellip;</a>"}, {"owner": {"reputation": 535, "user_id": 3668759, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/9f071fe3e57f795555dfa339ca70ed7d?s=128&d=identicon&r=PG&f=1", "display_name": "Gadziu", "link": "https://stackoverflow.com/users/3668759/gadziu"}, "reply_to_user": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "edited": false, "score": 0, "creation_date": 1529319584, "post_id": 50602888, "comment_id": 88815686, "body": "@SMeaden Yes, it is really an addin (specyfic project in VS)"}], "answers": [{"tags": [], "owner": {"reputation": 535, "user_id": 3668759, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/9f071fe3e57f795555dfa339ca70ed7d?s=128&d=identicon&r=PG&f=1", "display_name": "Gadziu", "link": "https://stackoverflow.com/users/3668759/gadziu"}, "is_accepted": true, "score": 1, "last_activity_date": 1529321404, "creation_date": 1529321404, "answer_id": 50908511, "question_id": 50602888, "link": "https://stackoverflow.com/questions/50602888/error-429-activex-component-cant-create-object-while-using-self-create-referenc/50908511#50908511", "title": "Error 429 activex component can&#39;t create object while using self create reference", "body": "<p>After long seeking I found the solution. It's kind of partial, because for 64 bit Excel we need to register library manually (maybe someone knows, how to add bat file to installation file). </p>\n\n<p>I found the answer on this <a href=\"https://christopherjmcclellan.wordpress.com/2015/02/25/registering-a-com-add-in-with-installsheild-le/\" rel=\"nofollow noreferrer\">site</a>.</p>\n\n<p>While creating Install Shield instalation file we need to do two things.</p>\n\n<ol>\n<li>Add .tlb file to application files (this step was done by me, before posting on stackoverflow)</li>\n<li>Click right on project.Primary output file and choose properities like in screenshot (for *.tlb file we need to check the same, but without \"COM Interop\")\n<a href=\"https://i.stack.imgur.com/PMZWI.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/PMZWI.png\" alt=\"enter image description here\"></a> </li>\n</ol>\n\n<p><strong>Without this the installer will not properlly register add-in in registry.</strong></p>\n\n<p>Install file created like this would register add-in for <strong>32-bit excel only</strong>. If you want to use it also in 64-bit Excel you need to register library manually. I created simple bat file like this:</p>\n\n<pre><code>c:\ncd C:\\Windows\\Microsoft.NET\\Framework64\\v4.0.30319\nregasm.exe \"[pathToDLL]\\AddInName.dll\" /tlb:\"[pathToDLL]\\AddInName.tlb\" /codebase \npause\n</code></pre>\n\n<p>Remember, that you need to run it with admin rights.</p>\n"}], "owner": {"reputation": 535, "user_id": 3668759, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/9f071fe3e57f795555dfa339ca70ed7d?s=128&d=identicon&r=PG&f=1", "display_name": "Gadziu", "link": "https://stackoverflow.com/users/3668759/gadziu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3776, "favorite_count": 1, "accepted_answer_id": 50908511, "answer_count": 1, "score": 1, "last_activity_date": 1529321404, "creation_date": 1527677751, "last_edit_date": 1528889738, "question_id": 50602888, "link": "https://stackoverflow.com/questions/50602888/error-429-activex-component-cant-create-object-while-using-self-create-referenc", "title": "Error 429 activex component can&#39;t create object while using self create reference", "body": "<p>I created some add-in for excel in C#. In it is one public class for using in VBA. On my machine all works ok. When I install add-in on tester computer (I'm using InstallShield 2015 Limited Edition for Visual Studio to create setup file) I can't set object.</p>\n\n<p>C# code</p>\n\n<pre class=\"lang-cs prettyprint-override\"><code>using System;\nusing Excel = Microsoft.Office.Interop.Excel;\nusing System.Runtime.InteropServices;\nusing Microsoft.Win32;\n\nnamespace PMTAddin\n{\n    [Guid(\"B2350EC1-522E-4B75-BB02-86BB0FD1A60E\")]\n    [ClassInterface(ClassInterfaceType.AutoDual)]\n    [ComVisible(true)]\n    public class PublicClass\n    {\n        public void test()\n        {\n            System.Windows.Forms.MessageBox.Show(\n                        \"test.\"\n                    , \"test\"\n                    , System.Windows.Forms.MessageBoxButtons.OK\n                    , System.Windows.Forms.MessageBoxIcon.Error\n                );\n        }\n\n        private int GetWorksheetID(Excel.Workbook wb, string worksheetName)\n        {\n            int result = 0;\n\n\n            foreach (Excel.Worksheet ws in wb.Worksheets)\n            {\n                if (ws.Name == worksheetName)\n                {\n                    result = ws.Index;\n                    break;\n                }\n\n            }\n\n            return result;\n        }\n\n        [ComRegisterFunctionAttribute]\n        public static void RegisterFunction(Type type)\n        {\n            Registry.ClassesRoot.CreateSubKey(GetSubKeyName(type, \"Programmable\"));\n            RegistryKey key = Registry.ClassesRoot.OpenSubKey(GetSubKeyName(type, \"InprocServer32\"), true);\n            key.SetValue(\"\", System.Environment.SystemDirectory + @\"\\mscoree.dll\", RegistryValueKind.String);\n        }\n\n        [ComUnregisterFunctionAttribute]\n        public static void UnregisterFunction(Type type)\n        {\n            Registry.ClassesRoot.DeleteSubKey(GetSubKeyName(type, \"Programmable\"), false);\n        }\n\n        private static string GetSubKeyName(Type type, string subKeyName)\n        {\n            System.Text.StringBuilder s = new System.Text.StringBuilder();\n            s.Append(@\"CLSID\\{\");\n            s.Append(type.GUID.ToString().ToUpper());\n            s.Append(@\"}\\\");\n            s.Append(subKeyName);\n            return s.ToString();\n        }\n    }\n}\n</code></pre>\n\n<p>In VBA project I checked reference to it on the list. It calls PMT.</p>\n\n<p>VBA</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Sub dsf()\n    Dim o As PMT.PublicClass\n    Set o = New PMT.PublicClass 'at this lane on other computer I got error 429. On my computer all work smoothly and method test is running.\n\n    o.test\nEnd Sub\n</code></pre>\n\n<p>I thought that maybe it was something .NET Framework, but it is installed. Any ideas?</p>\n\n<p><strong>EDIT:</strong></p>\n\n<p>I create two diffrent version for bittnes, but the same error.</p>\n\n<p>But I found some new info. In registry on my computer it looks like this\n<a href=\"https://i.stack.imgur.com/aGLsE.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/aGLsE.png\" alt=\"Registry on dev machine\"></a></p>\n\n<p>and on tester machine it looks like this\n<a href=\"https://i.stack.imgur.com/T2mxX.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/T2mxX.png\" alt=\"Registry on test machine\"></a></p>\n\n<p>There are no CodeBase value... Do you think this is the problem? If it is, how I need to modify RegisterFunction method to correct this?</p>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 1505, "user_id": 9663006, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nXPmC.jpg?s=128&g=1", "display_name": "Samuel Everson", "link": "https://stackoverflow.com/users/9663006/samuel-everson"}, "edited": false, "score": 0, "creation_date": 1527681049, "post_id": 50602786, "comment_id": 88217066, "body": "Your variables <code>LastRow</code>, <code>eRow</code>,<code>eRow2</code> and <code>eRow3</code> are declared as variable type <code>Long</code> which is an integer type. <code>Set</code> can only be used when assigning a value to an <code>Object</code>.   Remove the word <code>Set</code> from your variable assignments and you won&#39;t get the compile error any longer.    See <a href=\"https://stackoverflow.com/questions/28564505/vba-excel-compile-error-object-required?utm_medium=organic&amp;utm_source=google_rich_qa&amp;utm_campaign=google_rich_qa\">this answer here</a> which shows the same issue you have."}, {"owner": {"reputation": 1505, "user_id": 9663006, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nXPmC.jpg?s=128&g=1", "display_name": "Samuel Everson", "link": "https://stackoverflow.com/users/9663006/samuel-everson"}, "edited": false, "score": 0, "creation_date": 1527681460, "post_id": 50602786, "comment_id": 88217359, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/28564505/vba-excel-compile-error-object-required\">VBA Excel &quot;Compile error: Object Required&quot;</a>"}, {"owner": {"reputation": 19, "user_id": 9858761, "user_type": "registered", "profile_image": "https://graph.facebook.com/1962450507152892/picture?type=large", "display_name": "Pedro Montanari", "link": "https://stackoverflow.com/users/9858761/pedro-montanari"}, "reply_to_user": {"reputation": 1505, "user_id": 9663006, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nXPmC.jpg?s=128&g=1", "display_name": "Samuel Everson", "link": "https://stackoverflow.com/users/9663006/samuel-everson"}, "edited": false, "score": 0, "creation_date": 1527755975, "post_id": 50602786, "comment_id": 88249826, "body": "Thanks for the fast answer man but actually when I remove all my <code>Set</code> Excel continues with the <code>Object Required</code> error, and it says the problem is the <code>LastRow = SelectedSheets.Range(&quot;A&quot; &amp; Rows.Count).End(xlUp).Row</code> part. I&#39;ve read the other answer about this error but still I can&#39;t understand what&#39;s happening"}, {"owner": {"reputation": 1505, "user_id": 9663006, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nXPmC.jpg?s=128&g=1", "display_name": "Samuel Everson", "link": "https://stackoverflow.com/users/9663006/samuel-everson"}, "edited": false, "score": 0, "creation_date": 1527756288, "post_id": 50602786, "comment_id": 88250023, "body": "hmmm I did test lastnight and it compiled when <code>Set</code> was removed. I can have another look when im home."}, {"owner": {"reputation": 1505, "user_id": 9663006, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nXPmC.jpg?s=128&g=1", "display_name": "Samuel Everson", "link": "https://stackoverflow.com/users/9663006/samuel-everson"}, "edited": false, "score": 0, "creation_date": 1527766733, "post_id": 50602786, "comment_id": 88256571, "body": "<code>Set</code> is only used with an <code>Object</code> so you shouldn&#39;t be using <code>Set</code> for these variables. When you say you&#39;re still getting the <code>Object required</code> error after removing <code>Set</code>, is it still a <code>Compile error</code> <i>OR</i> is it now a <code>Runtime Error &#39;424&#39;</code>?"}, {"owner": {"reputation": 1505, "user_id": 9663006, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nXPmC.jpg?s=128&g=1", "display_name": "Samuel Everson", "link": "https://stackoverflow.com/users/9663006/samuel-everson"}, "edited": false, "score": 0, "creation_date": 1527770188, "post_id": 50602786, "comment_id": 88258774, "body": "On closer inspectionThere are a lot of issues within your code, which is understandable if you&#39;re new to VBA.   Your code will need to be re-written as each time I&#39;ve managed to fix one error a new one is presented at the next line (I got as far as the first paste line trying a few different things).   I&#39;d recommend to read some VBA documentation (I&#39;ll leave some links in another comment) about <code>Range</code>, <code>Copy</code> and <code>Paste</code> (if required).   Also it might be useful to read about how to avoid using <code>Select</code> and <code>Copy&#47;Paste</code> in VBA."}, {"owner": {"reputation": 1505, "user_id": 9663006, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nXPmC.jpg?s=128&g=1", "display_name": "Samuel Everson", "link": "https://stackoverflow.com/users/9663006/samuel-everson"}, "edited": false, "score": 0, "creation_date": 1527770506, "post_id": 50602786, "comment_id": 88258984, "body": "<a href=\"https://msdn.microsoft.com/en-us/vba/excel-vba/articles/range-object-excel\" rel=\"nofollow noreferrer\">Range</a>, <a href=\"https://msdn.microsoft.com/en-us/vba/excel-vba/articles/range-copy-method-excel\" rel=\"nofollow noreferrer\">Copy</a>, <a href=\"https://msdn.microsoft.com/en-us/vba/excel-vba/articles/range-pastespecial-method-excel\" rel=\"nofollow noreferrer\">Paste</a>, <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">How to avoid Select in VBA</a>."}, {"owner": {"reputation": 19, "user_id": 9858761, "user_type": "registered", "profile_image": "https://graph.facebook.com/1962450507152892/picture?type=large", "display_name": "Pedro Montanari", "link": "https://stackoverflow.com/users/9858761/pedro-montanari"}, "reply_to_user": {"reputation": 1505, "user_id": 9663006, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nXPmC.jpg?s=128&g=1", "display_name": "Samuel Everson", "link": "https://stackoverflow.com/users/9663006/samuel-everson"}, "edited": false, "score": 0, "creation_date": 1527837342, "post_id": 50602786, "comment_id": 88285935, "body": "Thanks man, I think I&#39;ll read the documentation first and then I&#39;ll try to code differently from other approaches"}], "owner": {"reputation": 19, "user_id": 9858761, "user_type": "registered", "profile_image": "https://graph.facebook.com/1962450507152892/picture?type=large", "display_name": "Pedro Montanari", "link": "https://stackoverflow.com/users/9858761/pedro-montanari"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 33, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1527677447, "creation_date": 1527677447, "question_id": 50602786, "link": "https://stackoverflow.com/questions/50602786/command-button-sub-object-error", "title": "Command button sub object error", "body": "<p>I am trying to write a code where the user clicks the button and he gets data from the current day from one Excel file, then copy and transpose in another file automatically. The debugger says I have an error in the beginning of the code - <code>Compile error: Object required</code>- in the <code>Public Sub CommandButton1_Click()</code> part. I am new to VBA and I don't have a clue on what's happening. I already tried searching for answers about Sub errors but I couldn't find anything similar to my problem.</p>\n\n<p>Thanks in advance! Here is my code for the moment: </p>\n\n<pre><code>    Public Sub CommandButton1_Click()\n\n    'Variables\n\n    Sheets(\"Today_Data\").Select\n    Dim LastRow As Long, nRow As Long, eRow As Long, eRow2 As Long, eRow3 As Long\n    Set LastRow = SelectedSheets.Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n\n'''verify where is the last row updated today'\n\n    For nRow = 5 To LastRow Step 1\n    If Cells(nRow, 1).Value = Date Then\n\n       '''copy and paste only the cells that have been updated today\n\n        ''Copy and paste columns 1-4 WITHOUT transposing\n        SelectedSheets.Range(SelectedSheets.Cells(nRow, 1), SelectedSheets.Cells(nRow, 2), SelectedSheets.Cells(nRow, 3), SelectedSheets.Cells(nRow, 4)).Select\n        Selection.Copy\n\n        'verify where is the next empty row on the destiny sheet to paste\n        Set eRow = Worksheets(\"Test\").Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n\n        SelectedSheets.PasteSpecial Paste:=xlPasteValuesAndNumberFormats, Operation:=xlNone, SkipBlanks_:=False, Transpose:=False, Destination:=Worksheets(\"Test\").Range(Cells(eRow, 1), Cells(eRow, 2), Cells(eRow, 3), Cells(eRow, 4))\n\n        ''Copy and paste odd columns 7-19 transposing\n        SelectedSheets.Range(ActiveSheet.Cells(nRow, 7), SelectedSheets.Cells(nRow, 9), SelectedSheets.Cells(nRow, 11), SelectedSheets.Cells(nRow, 13), SelectedSheets.Cells(nRow, 15), SelectedSheets.Cells(nRow, 17), SelectedSheets.Cells(nRow, 19)).Select\n        Application.CutCopyMode = False\n        Selection.Copy\n\n        'verify where is the next empty row on the destiny sheet to paste\n        Set eRow2 = Worksheets(\"Test\").Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n\n        SelectedSheets.PasteSpecial Paste:=xlPasteValuesAndNumberFormats, Operation:=xlNone, SkipBlanks_:=False, Transpose:=True, Destination:=Worksheets(\"Test\").Range(Cells(eRow2, 7), Cells(eRow2, 9), Cells(eRow2, 11), Cells(eRow2, 13), Cells(eRow2, 15), Cells(eRow2, 17), Cells(eRow2, 19))\n\n        ''Copy and paste even columns 6-20 transposing\n        SelectedSheets.Range(ActiveSheet.Cells(nRow, 6), SelectedSheets.Cells(nRow, 8), SelectedSheets.Cells(nRow, 10), SelectedSheets.Cells(nRow, 12), SelectedSheets.Cells(nRow, 14), SelectedSheets.Cells(nRow, 16), SelectedSheets.Cells(nRow, 18), SelectedSheets.Cells(nRow, 20)).Select\n        Application.CutCopyMode = False\n        Selection.Copy\n\n        'verify where is the next empty row on the destiny sheet to paste\n        Set eRow3 = Worksheets(\"Test\").Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n\n        SelectedSheets.PasteSpecial Paste:=xlPasteValuesAndNumberFormats, Operation:=xlNone, SkipBlanks_:=False, Transpose:=True, Destination:=Worksheets(\"Test\").Range(Cells(eRow3, 6), Cells(eRow3, 8), Cells(eRow3, 10), Cells(eRow3, 12), Cells(eRow3, 14), Cells(eRow3, 16), Cells(eRow3, 18), Cells(eRow3, 20))\n\n    End If\n\n    Next\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 6533, "user_id": 8466523, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JNrm6.jpg?s=128&g=1", "display_name": "Olly", "link": "https://stackoverflow.com/users/8466523/olly"}, "edited": false, "score": 1, "creation_date": 1527677147, "post_id": 50602659, "comment_id": 88214392, "body": "What have you researched / tried so far? <a href=\"http://idownvotedbecau.se/noattempt/\" rel=\"nofollow noreferrer\">It appears you have made no attempt at all</a>"}], "answers": [{"tags": [], "owner": {"reputation": 467, "user_id": 9490000, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a996f5c51b98710f55f20aaf72f376b?s=128&d=identicon&r=PG&f=1", "display_name": "DirtyDeffy", "link": "https://stackoverflow.com/users/9490000/dirtydeffy"}, "is_accepted": false, "score": 0, "last_activity_date": 1527681573, "creation_date": 1527681573, "answer_id": 50604142, "question_id": 50602659, "link": "https://stackoverflow.com/questions/50602659/copy-relevant-rows-and-paste-to-new-worksheet/50604142#50604142", "title": "Copy relevant rows and paste to new worksheet", "body": "<p>You've defined and explained what you want to do nicely. So the next step would be to start researching the actions you want the code to do: </p>\n\n<p>Start with how to copy rows:<br>\n<a href=\"http://www.bluepecantraining.com/copying-moving-rows-columns-excel-vba/\" rel=\"nofollow noreferrer\">http://www.bluepecantraining.com/copying-moving-rows-columns-excel-vba/</a></p>\n\n<p>Next is how to find the last used row in a worksheet:<br>\n<a href=\"https://powerspreadsheets.com/excel-vba-last-row/\" rel=\"nofollow noreferrer\">https://powerspreadsheets.com/excel-vba-last-row/</a></p>\n\n<p>Next is to apply your condition on what rows to copy:<br>\n<a href=\"https://stackoverflow.com/questions/35495266/using-vba-to-check-if-a-date-is-between-two-dates\">Using VBA to check if a date is between two dates</a></p>\n\n<p>Next is how to create a <code>for loop</code> that runs the code the desired number of times:<br>\n<a href=\"https://www.excel-easy.com/vba/loop.html\" rel=\"nofollow noreferrer\">https://www.excel-easy.com/vba/loop.html</a> (a tip is to use the <code>LastRow</code> that you defined via the second link i posted. eg: \"<code>For x  = 1 To LastRow</code>\")</p>\n\n<p>And lastly is how to assign a macro to a button or shape:<br>\n<a href=\"https://wellsr.com/vba/2017/excel/how-to-assign-a-macro-to-a-shape-in-excel/\" rel=\"nofollow noreferrer\">https://wellsr.com/vba/2017/excel/how-to-assign-a-macro-to-a-shape-in-excel/</a></p>\n\n<p>Try to build a code with the help of these links. If you get stuck, come back and show us what you've created and where the problem is. I (aswell as and many others) would love to help you on from there.</p>\n"}], "owner": {"reputation": 1, "user_id": 9869673, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a83553f27bf4653d40b818f334af7bb3?s=128&d=identicon&r=PG&f=1", "display_name": "A Bull", "link": "https://stackoverflow.com/users/9869673/a-bull"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 134, "favorite_count": 0, "answer_count": 1, "score": -6, "last_activity_date": 1527681573, "creation_date": 1527677040, "question_id": 50602659, "link": "https://stackoverflow.com/questions/50602659/copy-relevant-rows-and-paste-to-new-worksheet", "title": "Copy relevant rows and paste to new worksheet", "body": "<p>I have multiple sheets which I am looking to copy and paste the relevant cells from rows into a new worksheet.  The defining factor is whether the rows are \"Live\" which is determined by whether today falls between the \"start date\" and \"end date\" columns. For all rows that are \"live\" certain cells on that row should then be copy pasted to the bottom of the list on the new worksheet.  I would then repeat these steps for the other worksheets so that the new worksheet essentially contains a summary of all \"live\" lines from the other sheets.</p>\n\n<p>I then ultimately need to create a button so I can re-run this at the end of each day.</p>\n\n<p>Hoping you can help!</p>\n"}, {"tags": ["excel", "excel-formula", "vba"], "comments": [{"owner": {"reputation": 3907, "user_id": 4961700, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f80e4233c80b9ba42b3b39cf704804dc?s=128&d=identicon&r=PG&f=1", "display_name": "Solar Mike", "link": "https://stackoverflow.com/users/4961700/solar-mike"}, "edited": false, "score": 0, "creation_date": 1527680659, "post_id": 50602453, "comment_id": 88216774, "body": "Is your &quot;total step no?Patient no&quot; 20 or 1, 2, 3 ? The third column is headed &quot;total step no?Patient no&quot; but you refer to numbers in the second column...."}, {"owner": {"reputation": 17346, "user_id": 1693085, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/89d96f4a92f0053e9f2c9a8b06c011a0?s=128&d=identicon&r=PG", "display_name": "John Bustos", "link": "https://stackoverflow.com/users/1693085/john-bustos"}, "edited": false, "score": 0, "creation_date": 1527684887, "post_id": 50602453, "comment_id": 88219819, "body": "<a href=\"https://www.extendoffice.com/documents/excel/1705-excel-sum-average-unique-values.html\" rel=\"nofollow noreferrer\">extendoffice.com/documents/excel/&hellip;</a> - Give implementing that a try and then come back with any issues you may have."}], "answers": [{"tags": [], "owner": {"reputation": 341, "user_id": 6581671, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b2a9d63e8f02894d76620754c080f16c?s=128&d=identicon&r=PG&f=1", "display_name": "Christopher", "link": "https://stackoverflow.com/users/6581671/christopher"}, "is_accepted": false, "score": 0, "last_activity_date": 1527687027, "creation_date": 1527687027, "answer_id": 50606022, "question_id": 50602453, "link": "https://stackoverflow.com/questions/50602453/macros-to-sum-unique-values-related-to-another-column/50606022#50606022", "title": "Macros to sum unique values related to another column", "body": "<p>So if I understand the question, you want to sum the unique values in column B. The following will do the trick. </p>\n\n<p>Note, you will need to adgust the range as necessary. Right now the range is set to B2:B20 as in your sample table.</p>\n\n<pre><code>Sub unique()\n    Dim arr() As Variant\n    Dim arrElem As Variant\n    Dim Rng As Range\n    Dim elem As Range\n    Dim i As Long\n    Dim stepSum As Long\n    Dim match As Boolean\n\n    Set Rng = Range(\"B2:B20\") 'Edit this so that it fits your array\n\n    'this sets up an array to store unique variables\n    ReDim Preserve arr(1 To 1) As Variant\n    arr(1) = 0\n\n    'this loops through each number in the identified range\n    For Each elem In Rng\n\n      'this is a boolean, false means the current number is unique (so far) true means the number has been seen previously.\n      match = False\n\n      'this checks the current number against all the unique values stored in the array\n      For Each arrElem In arr\n          'If it finds a match, it changes the boolean to true\n          If arrElem = elem Then match = True\n      Next arrElem\n\n      'If not match was found, we store the current number as a new unique value in the array\n      If match = False Then\n        'this adds another row to the array\n        ReDim Preserve arr(1 To UBound(arr) + 1) As Variant\n        'this adds the unique value\n        arr(UBound(arr)) = elem.Value\n      End If\n\n    Next elem\n\n    'this sums the unique numbers we stored in the array\n    For i = 1 To UBound(arr)\n        stepSum = stepSum + arr(i)\n    Next i\n\n    'this reports the sum of unique elements\n    MsgBox stepSum\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 9869426, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Hariprasad G Iyer", "link": "https://stackoverflow.com/users/9869426/hariprasad-g-iyer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 445, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1527687027, "creation_date": 1527676372, "last_edit_date": 1531164843, "question_id": 50602453, "link": "https://stackoverflow.com/questions/50602453/macros-to-sum-unique-values-related-to-another-column", "title": "Macros to sum unique values related to another column", "body": "<p>I need to create macros to populate in \"Metrics calculator\" tab, the sum of \"No of test steps\"(Column G) for each \"study\" (Column D). The sum should consider unique values only. Please see the table below:\n<img src=\"https://i.stack.imgur.com/5cDDj.jpg\" alt=\"Table\"></p>\n\n<p>In this Study no '1111', total step no/patient no '20' repeated 3 times, '15' repeated 4 times and '30'  3 times- i need the macros just to take unique values and add,i.e just 20+15+30=65.</p>\n\n<p>In Metrics calculator tab\"- It should come with output as </p>\n\n<p>Study no    Total no of steps\n1111    65</p>\n"}, {"tags": ["vba", "ms-word"], "comments": [{"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1527674093, "post_id": 50601441, "comment_id": 88212412, "body": "You don&#39;t provide enough accurate information: I assume the code you do give us is not all in the same module? Please separate it and indicate in what modules the various procedures are located."}, {"owner": {"reputation": 13, "user_id": 9869096, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0f024f74ab5df7327c6085c172e7fa2?s=128&d=identicon&r=PG&f=1", "display_name": "Eigen", "link": "https://stackoverflow.com/users/9869096/eigen"}, "reply_to_user": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1527690864, "post_id": 50601441, "comment_id": 88224388, "body": "I upload the test file to google drive .<a href=\"https://drive.google.com/open?id=1aCwSQY4TCWWsU73fLVuNdloy22H3XW-m\" rel=\"nofollow noreferrer\">drive.google.com/open?id=1aCwSQY4TCWWsU73fLVuNdloy22H3XW-m</a>"}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1527697449, "post_id": 50601441, "comment_id": 88228604, "body": "I&#39;m not going to download your document that contains macros. Please use the <a href=\"https://stackoverflow.com/posts/50601441/edit\">edit</a> link to amend your original question with the information about in which modules the various procedures are stored - they certainly are not all in one module?"}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1527698886, "post_id": 50601441, "comment_id": 88229336, "body": "See my edited answer, and you&#39;ll understand why I asked my original question."}], "answers": [{"tags": [], "owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "is_accepted": true, "score": 0, "last_activity_date": 1527698859, "last_edit_date": 1527698859, "creation_date": 1527674426, "answer_id": 50601793, "question_id": 50601441, "link": "https://stackoverflow.com/questions/50601441/word-2003-vba-bug-documentbeforeprint-execute-twice/50601793#50601793", "title": "word 2003 vba bug? DocumentBeforePrint execute twice?", "body": "<p>It appears you have put all the code except the printing code in the <code>ThisDocument</code> code module. This is incorrect. Because you put ^Dim X as NewEventClassModule<code>in</code>ThisDocument`, which is, itself, a class module representing <em>each document</em>, multiple instances were being created. Declaring it in a \"plain module\" doesn't cause this problem.</p>\n\n<p>You need three modules:</p>\n\n<p>\"Plain\" module:</p>\n\n<pre><code>Dim X As New EventClassModule\n\nSub Register_Event_Handler()\n  Set X.appWord = Word.Application\nEnd Sub\n</code></pre>\n\n<p>\"ThisDocument\" module:</p>\n\n<pre><code>Private Sub Document_New()\n   Register_Event_Handler\nEnd Sub\n\nPrivate Sub Document_Open()\n   Register_Event_Handler\nEnd Sub\n</code></pre>\n\n<p>\"EventClassModule\"</p>\n\n<pre><code>Public WithEvents appWord As Word.Application\n\nPrivate Sub appWord_DocumentBeforePrint _\n    (ByVal Doc As Document, _\n    Cancel As Boolean)\n\n    MsgBox \"WORKING!\"\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 9869096, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0f024f74ab5df7327c6085c172e7fa2?s=128&d=identicon&r=PG&f=1", "display_name": "Eigen", "link": "https://stackoverflow.com/users/9869096/eigen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 129, "favorite_count": 0, "accepted_answer_id": 50601793, "answer_count": 1, "score": 1, "last_activity_date": 1527698859, "creation_date": 1527673416, "last_edit_date": 1527673871, "question_id": 50601441, "link": "https://stackoverflow.com/questions/50601441/word-2003-vba-bug-documentbeforeprint-execute-twice", "title": "word 2003 vba bug? DocumentBeforePrint execute twice?", "body": "<p>Is this a Word 2003 VBA bug? DocumentBeforePrint executes multiple times?</p>\n\n<p>I reference</p>\n\n<p><a href=\"http://msdn.microsoft.com/en-us/library/office/aa211873(v=office.11).aspx\" rel=\"nofollow noreferrer\">http://msdn.microsoft.com/en-us/library/office/aa211873(v=office.11).aspx</a></p>\n\n<p><a href=\"http://msdn.microsoft.com/en-us/library/office/aa211915(v=office.11).aspx\" rel=\"nofollow noreferrer\">http://msdn.microsoft.com/en-us/library/office/aa211915(v=office.11).aspx</a></p>\n\n<p><a href=\"https://stackoverflow.com/questions/8693798/documentbeforeclose-syntax\">DocumentBeforeClose syntax</a></p>\n\n<p>I make a test.dot with macro DocumentBeforePrint.    </p>\n\n<pre><code>'ref http://msdn.microsoft.com/en-us/library/office/aa211915(v=office.11).aspx\nDim X As New EventClassModule\n\nSub Register_Event_Handler()\nSet X.appWord = Word.Application\nEnd Sub\n\nPrivate Sub Document_New()\n   Call Register_Event_Handler\nEnd Sub\n\nPrivate Sub Document_Open()\n   Call Register_Event_Handler\nEnd Sub\n\n\n'ref http://msdn.microsoft.com/en-us/library/office/aa211873(v=office.11).aspx\n\nPublic WithEvents appWord As Word.Application\n\nPrivate Sub appWord_DocumentBeforePrint _\n    (ByVal Doc As Document, _\n    Cancel As Boolean)\n\n    MsgBox \"WORKING!\"\nEnd Sub\n</code></pre>\n\n<p>When  I press Ctrl+P, the macro executes.</p>\n\n<p>There is a bug. When I double click test.dot to generate two word files (a.doc/b.doc).</p>\n\n<p>Press Ctrl+P,the DocumentBeforePrint will execute <em>twice</em>.</p>\n\n<p>If I generate 3 word files, Press Ctrl+P, the Macro will execute three times.</p>\n\n<p>What's wrong? I just want to execude once.</p>\n"}, {"tags": ["vba", "excel", "web-scraping", "browser-automation", "webautomation"], "answers": [{"comments": [{"owner": {"reputation": 19801, "user_id": 9189799, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/U2hEg.jpg?s=128&g=1", "display_name": "SIM", "link": "https://stackoverflow.com/users/9189799/sim"}, "edited": false, "score": 0, "creation_date": 1527680089, "post_id": 50602971, "comment_id": 88216399, "body": "There is an excellent way of using <code>explicit wait</code> within <code>selenium-vba</code> binding. Check out <a href=\"https://stackoverflow.com/questions/50238062/unable-to-check-for-availability-of-any-element-removing-hardcoded-delay/50241962#50241962\">this link</a> to see the usage."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 19801, "user_id": 9189799, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/U2hEg.jpg?s=128&g=1", "display_name": "SIM", "link": "https://stackoverflow.com/users/9189799/sim"}, "edited": false, "score": 0, "creation_date": 1527680471, "post_id": 50602971, "comment_id": 88216637, "body": "@Topto Thanks. I think you can add it as an argument to the find can&#39;t you? Doesn&#39;t seem to help for first bit but I will have a play."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 19801, "user_id": 9189799, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/U2hEg.jpg?s=128&g=1", "display_name": "SIM", "link": "https://stackoverflow.com/users/9189799/sim"}, "edited": false, "score": 0, "creation_date": 1527680888, "post_id": 50602971, "comment_id": 88216961, "body": "@Topto In the end I went with something experimental which worked which was to loop until IsDisplayed. I added in the explicit waits elsewhere so many thanks for the reminder. Appreciated."}, {"owner": {"reputation": 15, "user_id": 9576651, "user_type": "registered", "profile_image": "https://graph.facebook.com/2099638250061182/picture?type=large", "display_name": "Talal Z. Rana", "link": "https://stackoverflow.com/users/9576651/talal-z-rana"}, "edited": false, "score": 0, "creation_date": 1527752939, "post_id": 50602971, "comment_id": 88248176, "body": "I&#39;m really glade QHarr that showed your interest but I&#39;ve some limitations that I can&#39;t install anything on my PC. and I tried and don&#39;t know how to use Selenium and its seems bit complicated for me as I&#39;m not a programmer. However I tried .findelementbyid command it didn&#39;t work then I changed it to queryselector(&quot;#ID). And I made this code         wp.querySelector(&quot;#Nationality&quot;).Value = &quot;India&quot;         wp.querySelector(&quot;td.ng-binding&quot;).Click but again the problem is same that web page is asking to select nationality. Please help."}, {"owner": {"reputation": 15, "user_id": 9576651, "user_type": "registered", "profile_image": "https://graph.facebook.com/2099638250061182/picture?type=large", "display_name": "Talal Z. Rana", "link": "https://stackoverflow.com/users/9576651/talal-z-rana"}, "edited": false, "score": 0, "creation_date": 1527758460, "post_id": 50602971, "comment_id": 88251380, "body": "Exactly IT doesn&#39;t Allow. So is there any other way around?"}, {"owner": {"reputation": 15, "user_id": 9576651, "user_type": "registered", "profile_image": "https://graph.facebook.com/2099638250061182/picture?type=large", "display_name": "Talal Z. Rana", "link": "https://stackoverflow.com/users/9576651/talal-z-rana"}, "edited": false, "score": 0, "creation_date": 1528014925, "post_id": 50602971, "comment_id": 88339256, "body": "Nop, Nationality part of the code is incorrect always selecting the 1st option &quot;AFGANISTAN&quot;."}, {"owner": {"reputation": 15, "user_id": 9576651, "user_type": "registered", "profile_image": "https://graph.facebook.com/2099638250061182/picture?type=large", "display_name": "Talal Z. Rana", "link": "https://stackoverflow.com/users/9576651/talal-z-rana"}, "edited": false, "score": 0, "creation_date": 1528015025, "post_id": 50602971, "comment_id": 88339283, "body": "This code works but I need cell reference Cells(x,y) instead of its value in code, thats my challenge, HTML.getElementById(&quot;Nationality&quot;).Focus     For Each post In HTML.getElementsByClassName(&quot;ng-scope&quot;)         With post.getElementsByClassName(&quot;ng-binding&quot;)             For i = 0 To .Length - 1                 If .Item(i).innerText = sht.Range(&quot;D&quot; &amp; i) Then &#39;&#39;you can change the country name here to select from dropdown                     .Item(i).Click                     Exit For                 End If             Next i         End With     Next post"}, {"owner": {"reputation": 15, "user_id": 9576651, "user_type": "registered", "profile_image": "https://graph.facebook.com/2099638250061182/picture?type=large", "display_name": "Talal Z. Rana", "link": "https://stackoverflow.com/users/9576651/talal-z-rana"}, "edited": false, "score": 0, "creation_date": 1528015206, "post_id": 50602971, "comment_id": 88339320, "body": "Please add Cells(2,3) for Passport, Cells(2,4) for nationality, and Cells(2,5) for Date. and please add for loop i=0 to lastrow."}, {"owner": {"reputation": 15, "user_id": 9576651, "user_type": "registered", "profile_image": "https://graph.facebook.com/2099638250061182/picture?type=large", "display_name": "Talal Z. Rana", "link": "https://stackoverflow.com/users/9576651/talal-z-rana"}, "edited": false, "score": 0, "creation_date": 1528015897, "post_id": 50602971, "comment_id": 88339476, "body": "It was working with me, check this link:      <a href=\"https://stackoverflow.com/questions/50086005/ie-web-automation-how-to-auto-select-value-from-combo-box-using-excel-vba-xml\" title=\"ie web automation how to auto select value from combo box using excel vba xml\">stackoverflow.com/questions/50086005/&hellip;</a>"}, {"owner": {"reputation": 15, "user_id": 9576651, "user_type": "registered", "profile_image": "https://graph.facebook.com/2099638250061182/picture?type=large", "display_name": "Talal Z. Rana", "link": "https://stackoverflow.com/users/9576651/talal-z-rana"}, "edited": false, "score": 0, "creation_date": 1528016031, "post_id": 50602971, "comment_id": 88339514, "body": "Sorry My mistake, Original code in the link was working but I tried to change the value to cell reference and converted into for loop thats why its not working and this is my challenge right now."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 15, "user_id": 9576651, "user_type": "registered", "profile_image": "https://graph.facebook.com/2099638250061182/picture?type=large", "display_name": "Talal Z. Rana", "link": "https://stackoverflow.com/users/9576651/talal-z-rana"}, "edited": false, "score": 0, "creation_date": 1528017682, "post_id": 50602971, "comment_id": 88339799, "body": "@TalalZ.Rana I have written an updated answer based on the link you provided. Please don&#39;t include personal details in questions."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1528018321, "post_id": 50602971, "comment_id": 88339940, "body": "I have also upvoted SIM&#39;s answer as I have based the second version above on it."}, {"owner": {"reputation": 15, "user_id": 9576651, "user_type": "registered", "profile_image": "https://graph.facebook.com/2099638250061182/picture?type=large", "display_name": "Talal Z. Rana", "link": "https://stackoverflow.com/users/9576651/talal-z-rana"}, "edited": false, "score": 0, "creation_date": 1528018767, "post_id": 50602971, "comment_id": 88340034, "body": "Run-Time error &#39;-2147012894 (80072ee2)&#39;: The Operation Timed Out at .send QueryString, I don&#39;t have mozilla installed on my PC."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 15, "user_id": 9576651, "user_type": "registered", "profile_image": "https://graph.facebook.com/2099638250061182/picture?type=large", "display_name": "Talal Z. Rana", "link": "https://stackoverflow.com/users/9576651/talal-z-rana"}, "edited": false, "score": 0, "creation_date": 1528030523, "post_id": 50602971, "comment_id": 88343176, "body": "@TalalZ.Rana Just comment out that line and it should expect IE and let me know how it goes."}, {"owner": {"reputation": 15, "user_id": 9576651, "user_type": "registered", "profile_image": "https://graph.facebook.com/2099638250061182/picture?type=large", "display_name": "Talal Z. Rana", "link": "https://stackoverflow.com/users/9576651/talal-z-rana"}, "edited": false, "score": 0, "creation_date": 1528091741, "post_id": 50602971, "comment_id": 88357850, "body": "now Run-time Error &#39;9&#39; Subscript out of range the error is coming at ID = Split(Split(Split(res, &quot;Employees&quot;&quot;:&quot;)(1), &quot;ID&quot;&quot;:&quot;&quot;&quot;)(1), &quot;&quot;&quot;,&quot;)(0) And instead of &quot;Personal Number&quot; I need &quot;Work Permit Number&quot;. And I don&#39;t know how to change &quot;Otherdata2&quot; in code to get this.I checked on google didn&#39;t find any related article. Please recommend a link to learn this. Thanks you helped this far."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1528095254, "post_id": 50602971, "comment_id": 88359374, "body": "You should be using the number for Nationality e.g. 100"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1528095951, "post_id": 50602971, "comment_id": 88359677, "body": "I have updated for the work id. For learning see <a href=\"https://codingislove.com/http-requests-excel-vba/\" rel=\"nofollow noreferrer\">codingislove.com/http-requests-excel-vba</a>"}, {"owner": {"reputation": 15, "user_id": 9576651, "user_type": "registered", "profile_image": "https://graph.facebook.com/2099638250061182/picture?type=large", "display_name": "Talal Z. Rana", "link": "https://stackoverflow.com/users/9576651/talal-z-rana"}, "edited": false, "score": 0, "creation_date": 1529737657, "post_id": 50602971, "comment_id": 88991629, "body": "Everything is woking except this code:              Permit = Replace(Split(Split(s, &quot;&quot;&quot;OtherData&quot;&quot;:&quot;&quot;&quot;)(1), &quot;,&quot;)(0), Chr$(34), vbNullString)                  its not splitting the work permit number properly. and can you recommend me any page to learn split function and how to use &quot; inverted commas while creating query string."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1529737708, "post_id": 50602971, "comment_id": 88991640, "body": "Is this now correct? I changed it to return the item you requested."}, {"owner": {"reputation": 15, "user_id": 9576651, "user_type": "registered", "profile_image": "https://graph.facebook.com/2099638250061182/picture?type=large", "display_name": "Talal Z. Rana", "link": "https://stackoverflow.com/users/9576651/talal-z-rana"}, "edited": false, "score": 0, "creation_date": 1529738302, "post_id": 50602971, "comment_id": 88991788, "body": "wow how quick you responded!. I removed extra &quot; inverted commas from querystring and made this code which is not working can you explain whats wrong in this Code:    QueryString = &quot;{PersonPassportNumber:&quot;&quot; &amp; sht.Cells(i, 3) &amp; &quot;&quot;,PersonNationality:&quot;&quot; &amp; sht.Cells(i, 4) &amp; &quot;&quot;,PersonBirthDate:&quot;&quot; &amp; sht.Cells(i, 5) &amp; &quot;&quot;}&quot;"}, {"owner": {"reputation": 15, "user_id": 9576651, "user_type": "registered", "profile_image": "https://graph.facebook.com/2099638250061182/picture?type=large", "display_name": "Talal Z. Rana", "link": "https://stackoverflow.com/users/9576651/talal-z-rana"}, "edited": false, "score": 0, "creation_date": 1529744132, "post_id": 50602971, "comment_id": 88993063, "body": "Can you help me to resolve this problem as well. <a href=\"https://stackoverflow.com/questions/50999540/ie-web-automation-how-to-enter-catcha-while-using-new-xmlhttp-post-request-met\" title=\"ie web automation how to enter catcha while using new xmlhttp post request met\">stackoverflow.com/questions/50999540/&hellip;</a>"}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": true, "score": 2, "last_activity_date": 1528095976, "last_edit_date": 1528095976, "creation_date": 1527677997, "answer_id": 50602971, "question_id": 50601368, "link": "https://stackoverflow.com/questions/50601368/ie-web-automation-how-to-auto-select-web-combo-box-value-matching-with-a-cell/50602971#50602971", "title": "IE Web Automation - How to auto select web combo box value matching with a cell using Excel VBA/XML Macro", "body": "<p><strong>Comments:</strong></p>\n\n<p>Here is an example with selenium basic which should be easy to adapt to a loop or even to re-write for Internet Explorer. </p>\n\n<p>You can play around with adding explicit wait times if you choose ( thanks to @Topto for reminding me of those). Examples shown below. The one case where explicit wait, selenium style, didn't seem to work is with Passport #. Here I added a loop to ensure that it was displayed before attempting to update.</p>\n\n<hr>\n\n<p><strong>References:</strong></p>\n\n<p>The <a href=\"https://github.com/florentbr/SeleniumBasic\" rel=\"nofollow noreferrer\">selenium basic</a> wrapper is free. After installation you go VBE > Tools > References > Selenium type library</p>\n\n<hr>\n\n<p><strong>TODO:</strong></p>\n\n<p>This was to demonstrate the principals. You can easily start the driver and then have your loop pick up variables from the sheet and issue new GET requests.</p>\n\n<hr>\n\n<p><strong>Code:</strong></p>\n\n<pre><code>Option Explicit\n\nPublic Sub MOLScraping()\n    'Tools &gt; references &gt; selenium type library\n\n    Dim d As New ChromeDriver                    '&lt;== can change to other supported driver e.g. IE\n\n    Const URL = \"https://eservices.mol.gov.ae/SmartTasheel/Complain/IndexLogin?lang=en-gb\"\n\n    With d\n        .Start\n        .Get URL\n        .FindElementByCss(\"button[ng-click='showEmployeeSearch()']\").Click\n\n         Do\n             DoEvents\n         Loop Until .FindElementById(\"txtPassportNumber\").IsDisplayed\n\n        .FindElementById(\"txtPassportNumber\", timeout:=20000).SendKeys \"123456\"\n        .FindElementById(\"Nationality\").SendKeys \"ALBANIA\"\n        .FindElementByCss(\"td.ng-binding\").Click\n        .FindElementById(\"txtBirthDate\", timeout:=20000).SendKeys \"12/01/20009\"\n        .FindElementByCss(\"td.active.day\").Click\n        .FindElementByCss(\"button[onclick*='SearchEmployee']\").Click\n\n        Stop\n\n        'QUIT\n    End With\n\nEnd Sub\n</code></pre>\n\n<hr>\n\n<h2>EDIT</h2>\n\n<p>No selenium based answer (based on @SIM's answer you referenced)</p>\n\n<pre><code>Option Explicit\n\nPublic Sub GetData()\n    Dim res As Variant, QueryString As String, Permit As Long, Name As String, i As Long\n\n    Dim passportNumber As String, personNationality As Long, birthdate As String\n\n    Dim sht As Worksheet, lastRow As Long\n    Set sht = ActiveSheet\n\n    With sht\n        lastRow = .Cells(.Rows.Count, \"C\").End(xlUp).Row\n    End With\n\n    For i = 2 To lastRow\n\n        QueryString = \"{\"\"PersonPassportNumber\"\":\"\"\" &amp; sht.Cells(i, 3) &amp; \"\"\",\"\"PersonNationality\"\":\"\"\" &amp; sht.Cells(i, 4) &amp; \"\"\",\"\"PersonBirthDate\"\":\"\"\" &amp; sht.Cells(i, 5) &amp; \"\"\"}\"\n\n        With CreateObject(\"MSXML2.serverXMLHTTP\") 'New XMLHTTP60\n            .Open \"POST\", \"https://eservices.mol.gov.ae/SmartTasheel/Dashboard/GetEmployees\", False\n           ' .setRequestHeader \"User-Agent\", \"Mozilla/5.0\"\n            .setRequestHeader \"Content-Type\", \"application/json\"\n            .send QueryString\n            res = .responseText\n            Debug.Print res\n        End With\n\n        Permit = Replace(Split(Split(s, \"\"\"OtherData\"\":\"\"\")(1), \",\")(0), Chr$(34), vbNullString)\n        Name = Split(Split(Split(res, \"Employees\"\":\")(1), \"OtherData2\"\":\"\"\")(1), \"\"\"}\")(0)\n\n        sht.Cells(i, 1) = Permit: sht.Cells(i, 2) = Name\n    Next i\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 9576651, "user_type": "registered", "profile_image": "https://graph.facebook.com/2099638250061182/picture?type=large", "display_name": "Talal Z. Rana", "link": "https://stackoverflow.com/users/9576651/talal-z-rana"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 269, "favorite_count": 0, "accepted_answer_id": 50602971, "answer_count": 1, "score": 1, "last_activity_date": 1528095976, "creation_date": 1527673210, "last_edit_date": 1592644375, "question_id": 50601368, "link": "https://stackoverflow.com/questions/50601368/ie-web-automation-how-to-auto-select-web-combo-box-value-matching-with-a-cell", "title": "IE Web Automation - How to auto select web combo box value matching with a cell using Excel VBA/XML Macro", "body": "<p>I'm a beginner in VBA and I'm facing problem in selecting country name automatically in web Combo box using cell value from my Excel sheet via loop. It'll be great help if someone could just help me to fix my VBA and XMLHTTP code. My sheet and VBA code is as follows,</p>\n<h2>Sheet, VBA Code, XML Code below,</h2>\n<pre><code>1      PP #           Nationality   DOB           Work Permit Number\n2      REDACTED       Indian        03/01/1978    ?\n3                                                 ?\n4                                                 ?\n5                                                 ?\n\n\nSub MOLScraping()\nDim sht As Worksheet\nDim LastRow As Long\n\nSet sht = ThisWorkbook.sheets(&quot;MOL&quot;)\nLastRow = sht.Cells.SpecialCells(xlCellTypeLastCell).Row\n\nDim IE As New InternetExplorer, HTML As HTMLDocument, post As Object, URL$\n\nURL = &quot;https://eservices.mol.gov.ae/SmartTasheel/Complain/IndexLogin?lang=en-gb&quot;\n\nFor i = 2 To LastRow\n\nWith IE\n    .Visible = True\n    .navigate URL\n    While .Busy = True Or .readyState &lt;&gt; 4: DoEvents: Wend\n    Set HTML = .document\n\nHTML.querySelector(&quot;button[ng-click='showEmployeeSearch()']&quot;).Click\nApplication.Wait Now + TimeValue(&quot;00:00:03&quot;)  ''If for some reason the script fails, make sure to increase the delay\n    \n    HTML.getElementById(&quot;txtPassportNumber&quot;).Value = sht.Range(&quot;C&quot; &amp; i)\n                  \n    HTML.getElementById(&quot;Nationality&quot;).Focus\n    For Each post In HTML.getElementsByClassName(&quot;ng-scope&quot;)\n        With post.getElementsByClassName(&quot;ng-binding&quot;)\n            For i = 0 To .Length - 1\n                If .Item(i).innerText = sht.Range(&quot;D&quot; &amp; i) Then ''you can change the country name here to select from dropdown\n                    .Item(i).Click\n                    Exit For\n                End If\n            Next i\n        End With\n    Next post\n    HTML.getElementById(&quot;txtBirthDate&quot;).Value = sht.Range(&quot;E&quot; &amp; i)\n    \n    HTML.querySelector(&quot;button[onclick='SearchEmployee()']&quot;).Click\n    \n    HTML.getElementById(&quot;TransactionInfo_WorkPermitNumber&quot;).innerText = sht.Range(&quot;G&quot; &amp; i)\n    \nEnd With\nNext x\nEnd Sub\n\n\nSub Get_Data()\nDim res As Variant, QueryString$, ID$, Name$\n\nQueryString = &quot;{&quot;&quot;PersonPassportNumber&quot;&quot;:&quot;&quot;REDACTED&quot;&quot;,&quot;&quot;PersonNationality&quot;&quot;:&quot;&quot;100&quot;&quot;,&quot;&quot;PersonBirthDate&quot;&quot;:&quot;&quot;01/01/1990&quot;&quot;}&quot;\n\nWith New XMLHTTP\n    .Open &quot;POST&quot;, &quot;https://eservices.mol.gov.ae/SmartTasheel/Dashboard/GetEmployees&quot;, False\n    .setRequestHeader &quot;User-Agent&quot;, &quot;Mozilla/5.0&quot;\n    .setRequestHeader &quot;Content-Type&quot;, &quot;application/json&quot;\n    .send QueryString\n    res = .responseText\nEnd With\n\nID = Split(Split(Split(res, &quot;Employees&quot;&quot;:&quot;)(1), &quot;ID&quot;&quot;:&quot;&quot;&quot;)(1), &quot;&quot;&quot;,&quot;)(0)\nName = Split(Split(Split(res, &quot;Employees&quot;&quot;:&quot;)(1), &quot;OtherData2&quot;&quot;:&quot;&quot;&quot;)(1), &quot;&quot;&quot;}&quot;)(0)\n\n[A1] = ID: [B1] = Name\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1527672811, "post_id": 50600891, "comment_id": 88211488, "body": "Move this line <code>Set newWB = Workbooks.Add</code> before your For loop."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 1, "creation_date": 1527672849, "post_id": 50600891, "comment_id": 88211523, "body": "What are you expecting to see happen with  Split(&quot;BW&quot;, &quot;Reason&quot;) ? The delimiter is not present so you will have an array of one item surely? Why not simply say Array(...)"}], "answers": [{"comments": [{"owner": {"reputation": 433, "user_id": 7399669, "user_type": "registered", "accept_rate": 66, "profile_image": "https://graph.facebook.com/913566182119039/picture?type=large", "display_name": "Jenny", "link": "https://stackoverflow.com/users/7399669/jenny"}, "edited": false, "score": 0, "creation_date": 1527673274, "post_id": 50601235, "comment_id": 88211816, "body": "changing this now i could see only one sheet saving.. Not two sheets"}, {"owner": {"reputation": 721, "user_id": 7889129, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0oYIA.jpg?s=128&g=1", "display_name": "Maddy", "link": "https://stackoverflow.com/users/7889129/maddy"}, "reply_to_user": {"reputation": 433, "user_id": 7399669, "user_type": "registered", "accept_rate": 66, "profile_image": "https://graph.facebook.com/913566182119039/picture?type=large", "display_name": "Jenny", "link": "https://stackoverflow.com/users/7399669/jenny"}, "edited": false, "score": 0, "creation_date": 1527673522, "post_id": 50601235, "comment_id": 88212011, "body": "you need to modify your loop. please check mark&#39;s answer."}], "tags": [], "owner": {"reputation": 721, "user_id": 7889129, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0oYIA.jpg?s=128&g=1", "display_name": "Maddy", "link": "https://stackoverflow.com/users/7889129/maddy"}, "is_accepted": false, "score": 3, "last_activity_date": 1527672868, "creation_date": 1527672868, "answer_id": 50601235, "question_id": 50600891, "link": "https://stackoverflow.com/questions/50600891/saving-sheets-in-excel-to-another-excel/50601235#50601235", "title": "Saving sheets in excel to another excel", "body": "<p>Change this line <code>myworksheets = Split(\"BW\", \"Reason\")</code> to <code>myworksheets = Split(\"BW,Reason\", \",\")</code></p>\n"}, {"tags": [], "owner": {"reputation": 2953, "user_id": 2801253, "user_type": "registered", "profile_image": "https://graph.facebook.com/1332362525/picture?type=large", "display_name": "Mark Fitzgerald", "link": "https://stackoverflow.com/users/2801253/mark-fitzgerald"}, "is_accepted": false, "score": 2, "last_activity_date": 1527673092, "creation_date": 1527673092, "answer_id": 50601316, "question_id": 50600891, "link": "https://stackoverflow.com/questions/50600891/saving-sheets-in-excel-to-another-excel/50601316#50601316", "title": "Saving sheets in excel to another excel", "body": "<p>I think your problem is within the loop.  You are creating a new workbook for each sheet then pasting the sheet into it, saving and closing.</p>\n\n<p>Moving the new workbook creation and saving, closing out of the loop should solve your problem.</p>\n\n<pre><code>Sub save()\nDim myworksheets() As String\nDim newWB As Workbook\nDim CurrWB As Workbook\nDim i As Integer\nDim path1, Path2 As String\n    path1 = ThisWorkbook.Path\n    Path2 = path1 &amp; \"\\Saved Files\\SW\\\"\n    Set CurrWB = ThisWorkbook\n    myworksheets = Split(\"BW\", \"Reason\")\n    Set newWB = Workbooks.Add\n    For i = LBound(myworksheets) To UBound(myworksheets)\n        CurrWB.Sheets(Trim(myworksheets(i))).Copy Before:=newWB.Sheets(1)\n    Next i\n    newWB.SaveAs Filename:=Path2 &amp; Format(Now(), \"WW\") &amp; \" CW \" &amp; myworksheets(i) &amp; \".xlsx\"\n    newWB.Close SaveChanges:=True\n    Application.ScreenUpdating = True\n    MsgBox (\"File Saved\")\n End Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2189, "user_id": 8726447, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/961e6112f7d5aac9646ce1469e89fe20?s=128&d=identicon&r=PG&f=1", "display_name": "MarcinSzaleniec", "link": "https://stackoverflow.com/users/8726447/marcinszaleniec"}, "is_accepted": false, "score": 2, "last_activity_date": 1527673329, "creation_date": 1527673329, "answer_id": 50601415, "question_id": 50600891, "link": "https://stackoverflow.com/questions/50600891/saving-sheets-in-excel-to-another-excel/50601415#50601415", "title": "Saving sheets in excel to another excel", "body": "<p>Amend those two lines:</p>\n\n<pre><code>Dim myworksheets() As String\nmyworksheets = Split(\"BW\", \"Reason\")\n</code></pre>\n\n<p>To </p>\n\n<pre><code>Dim myworksheets() \nmyworksheets = Array(\"BW\", \"Reason\")\n</code></pre>\n"}], "owner": {"reputation": 433, "user_id": 7399669, "user_type": "registered", "accept_rate": 66, "profile_image": "https://graph.facebook.com/913566182119039/picture?type=large", "display_name": "Jenny", "link": "https://stackoverflow.com/users/7399669/jenny"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1527673329, "creation_date": 1527671903, "question_id": 50600891, "link": "https://stackoverflow.com/questions/50600891/saving-sheets-in-excel-to-another-excel", "title": "Saving sheets in excel to another excel", "body": "<p>I have a workbook with multiple sheets, and I want to save two sheets from the workbook to another new workbook.</p>\n\n<p>I tried the below code, but it is copying only one sheet from my workbook to another one. </p>\n\n<p>Could anyone tell me where I am going wrong?</p>\n\n<pre><code>Sub save()\nDim myworksheets() As String\nDim newWB As Workbook\nDim CurrWB As Workbook\nDim i As Integer\nDim path1, Path2 As String\npath1 = ThisWorkbook.Path\nPath2 = path1 &amp; \"\\Saved Files\\SW\\\"\nSet CurrWB = ThisWorkbook\nmyworksheets = Split(\"BW\", \"Reason\")\nFor i = LBound(myworksheets) To UBound(myworksheets)\nSet newWB = Workbooks.Add\nCurrWB.Sheets(Trim(myworksheets(i))).Copy Before:=newWB.Sheets(1)\nnewWB.SaveAs filename:=Path2 &amp; Format(Now(), \"WW\") &amp; \" CW \" &amp; myworksheets(i) &amp; \".xlsx\"\nnewWB.Close SaveChanges:=True\nNext i\nApplication.ScreenUpdating = False\nMsgBox (\"File Saved\")\n End Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1527671850, "post_id": 50600802, "comment_id": 88210804, "body": "<code>Interior.Color</code>... you are mixing up syntax. <code>ColorIndex</code> doesn&#39;t use RGB."}, {"owner": {"reputation": 5229, "user_id": 5512705, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/OoYN6.png?s=128&g=1", "display_name": "Samuel Hulla", "link": "https://stackoverflow.com/users/5512705/samuel-hulla"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1527672088, "post_id": 50600802, "comment_id": 88210958, "body": "Damn you&#39;re right, actually the out of Range error was caused by me using the RGB color-coding. The algorhytm / syntax in question works.   Maybe as a sidequestion then, is there a way of using RGB colors for the <code>.ColorIndex</code>  property?"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1527672249, "post_id": 50600802, "comment_id": 88211080, "body": "No, but why do you want to, just use Color?"}, {"owner": {"reputation": 5229, "user_id": 5512705, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/OoYN6.png?s=128&g=1", "display_name": "Samuel Hulla", "link": "https://stackoverflow.com/users/5512705/samuel-hulla"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1527673002, "post_id": 50600802, "comment_id": 88211621, "body": "Ah alright. I presumed the <code>.Color</code> property works like the one in css (so font color in other words)."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1527673580, "post_id": 50600802, "comment_id": 88212051, "body": "This page may not be completely up to date but has quite a few examples <a href=\"http://dmcritchie.mvps.org/excel/colors.htm\" rel=\"nofollow noreferrer\">dmcritchie.mvps.org/excel/colors.htm</a>"}], "answers": [{"tags": [], "owner": {"reputation": 5229, "user_id": 5512705, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/OoYN6.png?s=128&g=1", "display_name": "Samuel Hulla", "link": "https://stackoverflow.com/users/5512705/samuel-hulla"}, "is_accepted": true, "score": 0, "last_activity_date": 1527673134, "creation_date": 1527673134, "answer_id": 50601337, "question_id": 50600802, "link": "https://stackoverflow.com/questions/50600802/proper-syntax-of-dynamic-vba-range-selector/50601337#50601337", "title": "Proper syntax of dynamic vba range selector", "body": "<p>The selector actually works fine.</p>\n\n<p>Subscript out of range error was actually caused by me trying to combine <code>.ColorIndex</code> property with RGB Color-coding.</p>\n\n<p>The line should have looked like either: </p>\n\n<p><code>ws.Range(\"B\" &amp; i &amp; \":D\" &amp; i).Interior.ColorIndex = 15</code></p>\n\n<p>or</p>\n\n<p><code>ws.Range(\"B\" &amp; i &amp; \":D\" &amp; i).Interior.Color = RGB(166, 166, 166)</code></p>\n"}], "owner": {"reputation": 5229, "user_id": 5512705, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/OoYN6.png?s=128&g=1", "display_name": "Samuel Hulla", "link": "https://stackoverflow.com/users/5512705/samuel-hulla"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 26, "favorite_count": 0, "accepted_answer_id": 50601337, "answer_count": 1, "score": 0, "last_activity_date": 1527673134, "creation_date": 1527671650, "last_edit_date": 1592644375, "question_id": 50600802, "link": "https://stackoverflow.com/questions/50600802/proper-syntax-of-dynamic-vba-range-selector", "title": "Proper syntax of dynamic vba range selector", "body": "<p>I'm having some issues with my dynamic range selector.</p>\n<p><em>I've found some other ways of implementation, but for clarity's sake I was unable to find this method of range selecting described and I'm genuinely curious as to why it's not working:</em></p>\n<p>As a test, I want to change color of a range  <code>Range(B20:D25)</code>.</p>\n<p>With the following code</p>\n<pre><code>Private Sub colortest()\n  Dim ws as Worksheet: Set ws = Sheets(&quot;Sheet1&quot;)\n\n  For i = 20 to 25\n    ws.Range(&quot;B&quot; &amp; i &amp; &quot;:D&quot; &amp; i).Interior.ColorIndex = RGB(166, 166, 166)\n  Next i\n\nEnd Sub\n</code></pre>\n<p>Basically I want to go row by row based on indices <em>(dynamic row indices in my actual code, hence this algorthytm with for loop, i need to go row by row as some rows can be skipped)</em> and then fill the Range with color.</p>\n<p>So the expected result would be</p>\n<p><a href=\"https://i.stack.imgur.com/9rxo8.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/9rxo8.png\" alt=\"enter image description here\" /></a></p>\n<p>I get the following error:</p>\n<p><a href=\"https://i.stack.imgur.com/iAo3U.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/iAo3U.png\" alt=\"enter image description here\" /></a></p>\n<p>I presume it has something to do with me using the <code>.Range(&quot;Bi:Di&quot;)</code> selector incorrectly.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 721, "user_id": 7889129, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0oYIA.jpg?s=128&g=1", "display_name": "Maddy", "link": "https://stackoverflow.com/users/7889129/maddy"}, "edited": false, "score": 0, "creation_date": 1527674487, "post_id": 50600705, "comment_id": 88212686, "body": "it might help <a href=\"https://stackoverflow.com/a/10232925/7889129\">stackoverflow.com/a/10232925/7889129</a>"}], "answers": [{"tags": [], "owner": {"reputation": 627, "user_id": 7862492, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/kptDH.jpg?s=128&g=1", "display_name": "Karthick Raju", "link": "https://stackoverflow.com/users/7862492/karthick-raju"}, "is_accepted": true, "score": 0, "last_activity_date": 1527767413, "creation_date": 1527767413, "answer_id": 50623636, "question_id": 50600705, "link": "https://stackoverflow.com/questions/50600705/vba-macro-not-opened-from-vbscript-through-windows-service/50623636#50623636", "title": "VBA Macro not opened from VBScript through Windows Service", "body": "<p>After a long search, found an answer <a href=\"https://social.msdn.microsoft.com/Forums/Lync/en-US/ac2549f5-fc1e-494d-9015-70cb31d3aeb2/opening-excel-workbook-fails-when-run-from-scheduled-task-on-windows-server-2008-rw?forum=exceldev\" rel=\"nofollow noreferrer\">here</a></p>\n\n<p>Solution for the issue is to have directory structure <code>c:\\windows\\syswow64\\config\\systemprofile\\desktop</code></p>\n\n<p>I do not know how it started working for me. Believe me, this helped for lot of people in the <a href=\"https://social.msdn.microsoft.com/Forums/Lync/en-US/ac2549f5-fc1e-494d-9015-70cb31d3aeb2/opening-excel-workbook-fails-when-run-from-scheduled-task-on-windows-server-2008-rw?forum=exceldev\" rel=\"nofollow noreferrer\">blog</a></p>\n"}], "owner": {"reputation": 627, "user_id": 7862492, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/kptDH.jpg?s=128&g=1", "display_name": "Karthick Raju", "link": "https://stackoverflow.com/users/7862492/karthick-raju"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 37, "favorite_count": 1, "accepted_answer_id": 50623636, "answer_count": 1, "score": 0, "last_activity_date": 1527767413, "creation_date": 1527671386, "last_edit_date": 1527739733, "question_id": 50600705, "link": "https://stackoverflow.com/questions/50600705/vba-macro-not-opened-from-vbscript-through-windows-service", "title": "VBA Macro not opened from VBScript through Windows Service", "body": "<p>I have a windows service that calls VBScript. In VBScript, I have a lot of functions and at the end of all execution I call VBA Macro file. Everything is working as expected, expect calling VBA Macro. </p>\n\n<p>Below is the VBScript code to call VBA Macro file</p>\n\n<pre><code>sub OpenVBAMacroFile ()\n   Set xlApp = CreateObject(\"Excel.Application\")\n   Set XlBook = xlApp.Workbooks.Open(\"C:\\VBAMacroFile.xlsm\")\n   xlApp.Run \"DataRefresh2\"   \n   Set xlBook = Nothing\n   Set xlApp = Nothing\nend sub \n</code></pre>\n\n<p>When I run VBScript manually, VBA Macro file is opening successfully. But, when I run through Windows service, VBAM Macro file is not opening.</p>\n\n<p>Any help is highly appreciated.</p>\n"}, {"tags": ["vba", "excel", "combobox"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1527671546, "post_id": 50600671, "comment_id": 88210565, "body": "Have you also formatted your linked cell?"}, {"owner": {"reputation": 385, "user_id": 6434325, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/ZATCi.gif?s=128&g=1", "display_name": "Takichiii", "link": "https://stackoverflow.com/users/6434325/takichiii"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1527671617, "post_id": 50600671, "comment_id": 88210620, "body": "Yes as I mentionned its format is <code>Text</code>. So if I force manually a value (30%) to the Combobox, the LinkedCell retrieves the good format (30%) with no problem."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1527671691, "post_id": 50600671, "comment_id": 88210672, "body": "Format the linked cell as a %. This works for me with your change code."}, {"owner": {"reputation": 385, "user_id": 6434325, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/ZATCi.gif?s=128&g=1", "display_name": "Takichiii", "link": "https://stackoverflow.com/users/6434325/takichiii"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1527671991, "post_id": 50600671, "comment_id": 88210892, "body": "I tried it as well but it still retrieves the value as &quot;0.3&quot;. Moreover the value displayed in the <code>Combobox</code> becomes &quot;0,2%&quot; when choosing &quot;30%&quot; due to the code which is incoherent."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1527672216, "post_id": 50600671, "comment_id": 88211059, "body": "I notice there is no linked cell in your picture above - is that definitely set up correctly."}, {"owner": {"reputation": 385, "user_id": 6434325, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/ZATCi.gif?s=128&g=1", "display_name": "Takichiii", "link": "https://stackoverflow.com/users/6434325/takichiii"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1527672501, "post_id": 50600671, "comment_id": 88211256, "body": "Yes I corrected it thanks"}], "answers": [{"comments": [{"owner": {"reputation": 385, "user_id": 6434325, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/ZATCi.gif?s=128&g=1", "display_name": "Takichiii", "link": "https://stackoverflow.com/users/6434325/takichiii"}, "edited": false, "score": 0, "creation_date": 1527673066, "post_id": 50601176, "comment_id": 88211672, "body": "With the same code I get &quot;0%&quot; as value in the <code>Combobox</code> everytime I select an item, and in the <code>LinkedCell</code> it displays the good item but in this format &quot;0.1&quot;"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 385, "user_id": 6434325, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/ZATCi.gif?s=128&g=1", "display_name": "Takichiii", "link": "https://stackoverflow.com/users/6434325/takichiii"}, "edited": false, "score": 0, "creation_date": 1527673669, "post_id": 50601176, "comment_id": 88212126, "body": "Try setting that up in a new workbook from scratch and see if it works. Perhaps other code is interfering."}, {"owner": {"reputation": 385, "user_id": 6434325, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/ZATCi.gif?s=128&g=1", "display_name": "Takichiii", "link": "https://stackoverflow.com/users/6434325/takichiii"}, "edited": false, "score": 0, "creation_date": 1527674531, "post_id": 50601176, "comment_id": 88212708, "body": "Good idea, I tried starting a new one from scratch but the problem persists. (I updated with new screenshots) Do you have Excel 2016 as well?"}, {"owner": {"reputation": 3078, "user_id": 8537807, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2J8ds.png?s=128&g=1", "display_name": "EvR", "link": "https://stackoverflow.com/users/8537807/evr"}, "edited": false, "score": 0, "creation_date": 1527675262, "post_id": 50601176, "comment_id": 88213184, "body": "Have a look at your system separators, do you have , for decimal? Your combobox will show 0.1 (but in that case you&#39;ll need 0,1 for 10%). Use .list or AddItem to fill your ComboBox, not ListFillrange"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 3078, "user_id": 8537807, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2J8ds.png?s=128&g=1", "display_name": "EvR", "link": "https://stackoverflow.com/users/8537807/evr"}, "edited": false, "score": 0, "creation_date": 1527676503, "post_id": 50601176, "comment_id": 88213976, "body": "Yes that could be the issue @EvR. Takichiii - your screenshots have changed and you now appear to have a comma separator."}, {"owner": {"reputation": 385, "user_id": 6434325, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/ZATCi.gif?s=128&g=1", "display_name": "Takichiii", "link": "https://stackoverflow.com/users/6434325/takichiii"}, "edited": false, "score": 0, "creation_date": 1527683657, "post_id": 50601176, "comment_id": 88218934, "body": "Thank you for your time, I was just about to comment that it&#39;s now working and I don&#39;t know why, but then again it started always displaying 0% when <code>ComboBox1.Value = Format(ComboBox1.Value, &quot;0%&quot;)</code>. I&#39;m very confused I think it&#39;s a bug related to <code>ActiveX</code> component"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 1, "creation_date": 1527684122, "post_id": 50601176, "comment_id": 88219242, "body": "ActiveX is very buggy so you are better off using Forms controls if possible."}], "tags": [], "owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "is_accepted": false, "score": 0, "last_activity_date": 1527672710, "creation_date": 1527672710, "answer_id": 50601176, "question_id": 50600671, "link": "https://stackoverflow.com/questions/50600671/combobox-linkedcell-as-percentage-when-selecting-an-item/50601176#50601176", "title": "Combobox LinkedCell as Percentage when selecting an item", "body": "<p>I can't elaborate in a comment so this is the set up I used. The source range is \"Fred\" - 10%/20%/30%, the linked cell is E1, formatted as % and I used your change code. When I update the combobox E1 changes as in the picture.</p>\n\n<p><a href=\"https://i.stack.imgur.com/Dbf0q.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Dbf0q.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 385, "user_id": 6434325, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/ZATCi.gif?s=128&g=1", "display_name": "Takichiii", "link": "https://stackoverflow.com/users/6434325/takichiii"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 558, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1527674419, "creation_date": 1527671284, "last_edit_date": 1527674419, "question_id": 50600671, "link": "https://stackoverflow.com/questions/50600671/combobox-linkedcell-as-percentage-when-selecting-an-item", "title": "Combobox LinkedCell as Percentage when selecting an item", "body": "<p>I have an <code>Active X Combo box</code> with a list of percentages 10%, 20% etc. \nWhen I choose a value in, the <code>Combo Box</code> (30%) the value of the <code>ComboBox</code> becomes \"0.3\". So the <code>LinkedCell</code> receives the value \"0.3\". </p>\n\n<p>When I enter a percentage manually as a value for the <code>Combobox</code> (eg \"30%\"), the <code>LinkedCell</code> retrieves the same value (\"30%\") (The cell format is <code>Text</code>). </p>\n\n<p>How can i get it to show 10%, 20%, etc in the <code>LinkedCell</code> when I choose an item in the Dropdown?</p>\n\n<p><a href=\"https://i.stack.imgur.com/YTU2q.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/YTU2q.png\" alt=\"enter image description here\"></a></p>\n\n<p><strong>Recommanded solution</strong> :</p>\n\n<p>I tried changing the format as recommanded for this issue everywhere but it does not solve the problem.</p>\n\n<pre><code>Private Sub ComboBox3_Change()\nComboBox3.Value = Format(ComboBox3.Value, \"0.0%\")\nEnd Sub\n</code></pre>\n\n<p>Moreover the result is incoherent :</p>\n\n<p><a href=\"https://i.stack.imgur.com/W4GHi.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/W4GHi.png\" alt=\"enter image description here\"></a></p>\n\n<p><strong>How I populate the Combobox :</strong></p>\n\n<p>The <code>ListFillRange</code> of the <code>Combobox</code> (Developer->Properties) is a <code>Range</code> (Formulas->Name Manager) of percentages that I entered directly in the Sheet.\n<a href=\"https://i.stack.imgur.com/2N9l5.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/2N9l5.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 1595, "user_id": 6847949, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00fc40c71814d3ead488ab90ca84bf76?s=128&d=identicon&r=PG&f=1", "display_name": "Minty", "link": "https://stackoverflow.com/users/6847949/minty"}, "edited": false, "score": 1, "creation_date": 1527671308, "post_id": 50600528, "comment_id": 88210395, "body": "Without seeing the code we are all going to be guessing. Post up the whole routine that is not working, not just the openform line."}, {"owner": {"reputation": 1595, "user_id": 6847949, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00fc40c71814d3ead488ab90ca84bf76?s=128&d=identicon&r=PG&f=1", "display_name": "Minty", "link": "https://stackoverflow.com/users/6847949/minty"}, "edited": false, "score": 0, "creation_date": 1527673527, "post_id": 50600528, "comment_id": 88212013, "body": "You have no criteria in the open form command. Have a read here <a href=\"http://www.baldyweb.com/wherecondition.htm\" rel=\"nofollow noreferrer\">baldyweb.com/wherecondition.htm</a>"}, {"owner": {"reputation": 1, "user_id": 9869115, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a10743933c55331ca27963488909a289?s=128&d=identicon&r=PG&f=1", "display_name": "MischaG", "link": "https://stackoverflow.com/users/9869115/mischag"}, "reply_to_user": {"reputation": 1595, "user_id": 6847949, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00fc40c71814d3ead488ab90ca84bf76?s=128&d=identicon&r=PG&f=1", "display_name": "Minty", "link": "https://stackoverflow.com/users/6847949/minty"}, "edited": false, "score": 0, "creation_date": 1527674819, "post_id": 50600528, "comment_id": 88212918, "body": "I have tried with the criteria and it gets the same result :-("}, {"owner": {"reputation": 1, "user_id": 9869115, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a10743933c55331ca27963488909a289?s=128&d=identicon&r=PG&f=1", "display_name": "MischaG", "link": "https://stackoverflow.com/users/9869115/mischag"}, "reply_to_user": {"reputation": 1595, "user_id": 6847949, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00fc40c71814d3ead488ab90ca84bf76?s=128&d=identicon&r=PG&f=1", "display_name": "Minty", "link": "https://stackoverflow.com/users/6847949/minty"}, "edited": false, "score": 0, "creation_date": 1527676039, "post_id": 50600528, "comment_id": 88213677, "body": "I actually removed it to see if it had any effect.. but with no results"}, {"owner": {"reputation": 1595, "user_id": 6847949, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00fc40c71814d3ead488ab90ca84bf76?s=128&d=identicon&r=PG&f=1", "display_name": "Minty", "link": "https://stackoverflow.com/users/6847949/minty"}, "edited": false, "score": 1, "creation_date": 1527676508, "post_id": 50600528, "comment_id": 88213982, "body": "Okay - so back to my first point, what is the criteria you are trying to set?  And what other code are you running on load. Please show us the whole code - snippets without context mean nothing."}, {"owner": {"reputation": 1, "user_id": 9869115, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a10743933c55331ca27963488909a289?s=128&d=identicon&r=PG&f=1", "display_name": "MischaG", "link": "https://stackoverflow.com/users/9869115/mischag"}, "reply_to_user": {"reputation": 1595, "user_id": 6847949, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00fc40c71814d3ead488ab90ca84bf76?s=128&d=identicon&r=PG&f=1", "display_name": "Minty", "link": "https://stackoverflow.com/users/6847949/minty"}, "edited": false, "score": 0, "creation_date": 1527687689, "post_id": 50600528, "comment_id": 88221963, "body": "The criteria are there.. But I solved it by building the form from scratch again.. and it is working now."}], "answers": [{"tags": [], "owner": {"reputation": 1595, "user_id": 6847949, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00fc40c71814d3ead488ab90ca84bf76?s=128&d=identicon&r=PG&f=1", "display_name": "Minty", "link": "https://stackoverflow.com/users/6847949/minty"}, "is_accepted": false, "score": 0, "last_activity_date": 1527688351, "creation_date": 1527688351, "answer_id": 50606473, "question_id": 50600528, "link": "https://stackoverflow.com/questions/50600528/docmd-open-does-not-load-my-onload-criteria-in-acces-2016/50606473#50606473", "title": "DoCmd.Open Does not load my onload criteria in Acces 2016", "body": "<p>What you are showing isn't criteria to filter a forms content, it is what would go into the current and / or load event, to enable certain controls.</p>\n\n<p>You can simplify your code to;</p>\n\n<pre><code>Me.frmOrderDetails.visible = Me.POOrderFreeEntry \nMe.frmOrderDetailsFreeEntry.visible = Me.POOrderFreeEntry \nMe.frmOrderDetailsLarge.visible =  Not Me.POOrderFreeEntry \nMe.frmOrderDetails.Requery\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 9869115, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a10743933c55331ca27963488909a289?s=128&d=identicon&r=PG&f=1", "display_name": "MischaG", "link": "https://stackoverflow.com/users/9869115/mischag"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 76, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1527688351, "creation_date": 1527670851, "last_edit_date": 1527683631, "question_id": 50600528, "link": "https://stackoverflow.com/questions/50600528/docmd-open-does-not-load-my-onload-criteria-in-acces-2016", "title": "DoCmd.Open Does not load my onload criteria in Acces 2016", "body": "<p>I am opening a form in VBA with the command DoCmd.OpenForm, but when the form opens it is not loading my onload criteria.\nWhen I open the form in any different way it does load the onload criteria set in VBA.\nWhat am I doing wrong?</p>\n\n\n\n<p>I open the form with:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>DoCmd.OpenForm \"frmOrder\", acNormal, \"\", \"\", , acNormal\n</code></pre>\n\n<p>And when the form opens it needs to do the following on On Load:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>If Me.POOrderFreeEntry = True Then\n    Me.frmOrderDetails.visible = True\n    Me.frmOrderDetailsFreeEntry.visible = True\n    Me.frmOrderDetailsLarge.visible = False\n    Me.frmOrderDetails.Requery\nElse\n    Me.frmOrderDetails.visible = False\n    Me.frmOrderDetailsFreeEntry.visible = False\n    Me.frmOrderDetailsLarge.visible = True\n    Me.frmOrderDetailsLarge.Requery\nEnd If\n</code></pre>\n\n<p>However it only works if I open the form with a Macro or any other way.\nWith the DoCmd.OpenForm it is not using the Criteria</p>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1527671062, "post_id": 50600390, "comment_id": 88210221, "body": "Try explicitly referencing the sheet of interest"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1527671119, "post_id": 50600390, "comment_id": 88210268, "body": "Something like ThisWorkbook.worksheets(&quot;Sheet1&quot;).Cells(155, ThisWorkbook.worksheets(&quot;Sheet1&quot;).Columns.Count).End(xlToLef&zwnj;&#8203;t).Column"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 1, "creation_date": 1527671352, "post_id": 50600390, "comment_id": 88210424, "body": "Is the worksheet or workbook password locked?"}], "answers": [{"tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": false, "score": 0, "last_activity_date": 1527671335, "creation_date": 1527671335, "answer_id": 50600692, "question_id": 50600390, "link": "https://stackoverflow.com/questions/50600390/run-time-error-in-vba-code-excel/50600692#50600692", "title": "Run time error in VBA code - excel", "body": "<p>I suggest using explicit sheet reference to ensure working with correct sheet and not implicit activesheet which may fail if workbook not in focus for example</p>\n\n<p>Something like </p>\n\n<pre><code>ThisWorkbook.worksheets(\"Sheet1\").Cells(155, ThisWorkbook.worksheets(\"Sheet1\").Columns.Count).End(xlToLeft).Column \n</code></pre>\n"}], "owner": {"reputation": 63, "user_id": 9869075, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3d9f90a90e5f6ce82e6cfaeb5ee41d4e?s=128&d=identicon&r=PG&f=1", "display_name": "sachin", "link": "https://stackoverflow.com/users/9869075/sachin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 23, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1527671335, "creation_date": 1527670429, "last_edit_date": 1527670669, "question_id": 50600390, "link": "https://stackoverflow.com/questions/50600390/run-time-error-in-vba-code-excel", "title": "Run time error in VBA code - excel", "body": "<p>I am facing <code>run time error 1004 object error</code> while running this code </p>\n\n<pre><code>lC4 = Cells(155, Columns.Count).End(xlToLeft).Column \n</code></pre>\n\n<p>Some advice? Thanks. </p>\n"}, {"tags": ["vba", "ms-word"], "comments": [{"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1527669872, "post_id": 50599879, "comment_id": 88209424, "body": "So that paragraph is formatted as <code>TableHead</code>, but its <a href=\"http://officeopenxml.com/WPparagraphProperties.php\" rel=\"nofollow noreferrer\">paragraph glyph</a> is formatted as <code>Regular, 24 pt</code>."}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 1, "creation_date": 1527670052, "post_id": 50599879, "comment_id": 88209531, "body": "Go to Add/Removes Programs, right click Office, and choose &quot;Change&quot; and then click <code>Repair</code>.  It&#39;s tends to fix little oddities like this. (<a href=\"https://support.office.com/en-us/article/repair-an-office-application-7821d4b6-7c1d-4205-aa0e-a6b40c5bb88b\" rel=\"nofollow noreferrer\">Alternate methods</a>)"}, {"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1527671835, "post_id": 50599879, "comment_id": 88210793, "body": "<code>this would have been removed when the document was prepared</code> - and apparently its paragraph glyph remains. That is a common problem."}], "answers": [{"tags": [], "owner": {"reputation": 280, "user_id": 1844496, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce7e43dfc07547b04318e0240370a2ca?s=128&d=identicon&r=PG", "display_name": "entryton", "link": "https://stackoverflow.com/users/1844496/entryton"}, "is_accepted": false, "score": 0, "last_activity_date": 1528178368, "last_edit_date": 1528178368, "creation_date": 1527676931, "answer_id": 50602625, "question_id": 50599879, "link": "https://stackoverflow.com/questions/50599879/phantom-style-in-word/50602625#50602625", "title": "Phantom style in word", "body": "<p>I have resolved the issue with the below code:</p>\n\n<pre><code>'' remove empty paragraphs\nWith Selection.Find\n    .Text = \"^13{2,}\"\n    .Replacement.Text = \"^p\"\n    .Forward = True\n    .Wrap = wdFindContinue\n    .Format = False\n    .MatchCase = False\n    .MatchWholeWord = False\n    .MatchAllWordForms = False\n    .MatchSoundsLike = False\n    .MatchWildcards = True\n    .Execute Replace:=wdReplaceAll\nEnd With\n'' remove empty paragraphs\n</code></pre>\n\n<p>Thanks @GSerg for your pointer regarding paragraph glyph.</p>\n\n<p>EDIT:\nI was still getting false positives, while using <code>.Style</code>; so I had to change my code as below, with the wildcard <code>&lt;*&gt;</code>:</p>\n\n<pre><code>With Selection.Find\n    .Font.Italic = True\n    .Font.Color = 32768\n    .Text = \"&lt;*&gt;\"\n    .Forward = True\n    .Wrap = wdFindContinue\n    .Format = True\n    .MatchCase = False\n    .MatchWholeWord = False\n    .MatchWildcards = True\n    .MatchSoundsLike = False\n    .MatchAllWordForms = False\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 280, "user_id": 1844496, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce7e43dfc07547b04318e0240370a2ca?s=128&d=identicon&r=PG", "display_name": "entryton", "link": "https://stackoverflow.com/users/1844496/entryton"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 67, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1528178368, "creation_date": 1527668933, "last_edit_date": 1527671312, "question_id": 50599879, "link": "https://stackoverflow.com/questions/50599879/phantom-style-in-word", "title": "Phantom style in word", "body": "<p>I have a Word document on which I run a macro to look for a style <code>Regular</code>.</p>\n\n<p>My code is below:</p>\n\n<pre><code>If styleExisted = False Then\n    For Each oRange1 In ActiveDocument.StoryRanges\n        If oRange1.Characters.count &gt; 0 And found = False Then\n            oRange1.Select\n\n            With Selection.Find\n                .Style = \"Regular\"                  \n            End With\n\n            Selection.Find.Execute\n            If Selection.Find.found = True Then\n                test = Selection.range.Text\n\n                found = True\n                styleExisted = True\n            End If\n        End If\n    Next oRange1\nEnd If\n</code></pre>\n\n<p>However, the macro is giving me a false positive saying that content with the style is present in the document. I cannot find any content when I use the Find dialog with the style selected.</p>\n\n<p>On debugging the code, <code>test</code> gets the first block of text in the document.\nWhen I explicitly added some text with the style, the new text is being selected as expected.</p>\n\n<p>On saving the file as <code>.docx</code> and checking the <code>document.xml</code> file, I find the below contents.</p>\n\n<pre class=\"lang-xml prettyprint-override\"><code>&lt;w:tc&gt;\n    &lt;w:tcPr&gt;\n        &lt;w:tcW w:w=\"1074\" w:type=\"pct\"/&gt;\n    &lt;/w:tcPr&gt;\n    &lt;w:p w:rsidR=\"004B7F7E\" w:rsidRPr=\"006E4FD7\" w:rsidRDefault=\"004B7F7E\" w:rsidP=\"006E4FD7\"&gt;\n        &lt;w:pPr&gt;\n            &lt;w:pStyle w:val=\"TableHead\"/&gt;\n            &lt;w:spacing w:after=\"0\"/&gt;\n            &lt;w:jc w:val=\"left\"/&gt;\n            &lt;w:rPr&gt;\n                &lt;w:rStyle w:val=\"Regular\"/&gt;\n                &lt;w:sz w:val=\"24\"/&gt;\n                &lt;w:szCs w:val=\"24\"/&gt;\n            &lt;/w:rPr&gt;\n        &lt;/w:pPr&gt;\n        &lt;w:r w:rsidRPr=\"006E4FD7\"&gt;\n            &lt;w:rPr&gt;\n                &lt;w:bCs/&gt;\n                &lt;w:sz w:val=\"24\"/&gt;\n                &lt;w:szCs w:val=\"24\"/&gt;\n            &lt;/w:rPr&gt;\n</code></pre>\n\n<p>How can I get around this false positive?</p>\n\n<p>This is happening only for some documents, which is really baffling.</p>\n\n<p>EDIT: When I added some normal content from another document and put it at the beginning, the first block in the new content is being selected.</p>\n\n<p>Also, there would have been some placeholder text(from a custom template) at the beginning in the <code>Regular</code> style; this would have been removed when the document was prepared.</p>\n"}, {"tags": ["vba", "excel", "excel-2010"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1527668368, "post_id": 50599672, "comment_id": 88208452, "body": "If you are getting an error please state where it occurs."}, {"owner": {"reputation": 9, "user_id": 9769263, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6231ff18cecbd872f68b95a4bfb5a25e?s=128&d=identicon&r=PG", "display_name": "Pedro Gaspar", "link": "https://stackoverflow.com/users/9769263/pedro-gaspar"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1527668548, "post_id": 50599672, "comment_id": 88208564, "body": "Error on last = src.Worksheets(Manutencao).Range(&quot;A65536&quot;).End(xlUp).Row"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1527668596, "post_id": 50599672, "comment_id": 88208589, "body": "You have not defined <code>Manutencao</code>."}, {"owner": {"reputation": 5324, "user_id": 8759927, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/B8ktI.jpg?s=128&g=1", "display_name": "shrivallabha.redij", "link": "https://stackoverflow.com/users/8759927/shrivallabha-redij"}, "edited": false, "score": 0, "creation_date": 1527668615, "post_id": 50599672, "comment_id": 88208602, "body": "You have not defined variable <code>Manutencao</code> anywhere in the code. What is it supposed to hold?"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1527668661, "post_id": 50599672, "comment_id": 88208635, "body": "What is Manutencao ? Does it exist as a valid sheet name in src? Sorry for the echo!!"}, {"owner": {"reputation": 9, "user_id": 9769263, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6231ff18cecbd872f68b95a4bfb5a25e?s=128&d=identicon&r=PG", "display_name": "Pedro Gaspar", "link": "https://stackoverflow.com/users/9769263/pedro-gaspar"}, "edited": false, "score": 0, "creation_date": 1527668668, "post_id": 50599672, "comment_id": 88208640, "body": "Manutencao is the worksheet of the workbook i want the data to go"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1527668717, "post_id": 50599672, "comment_id": 88208664, "body": "You are using it like a variable name. Put option explicit at the top of your code to check for this. Literal strings i.e. the actual sheet name, goes between &quot;&quot;."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 1, "creation_date": 1527668717, "post_id": 50599672, "comment_id": 88208667, "body": "If it&#39;s a name it needs quotes as per Olly&#39;s answer."}], "answers": [{"comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1527668912, "post_id": 50599788, "comment_id": 88208790, "body": "You might want to use rows.count rather than 65536 given that&#39;s a bit old hat these days."}], "tags": [], "owner": {"reputation": 6533, "user_id": 8466523, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JNrm6.jpg?s=128&g=1", "display_name": "Olly", "link": "https://stackoverflow.com/users/8466523/olly"}, "is_accepted": true, "score": 2, "last_activity_date": 1527669630, "last_edit_date": 1527669630, "creation_date": 1527668657, "answer_id": 50599788, "question_id": 50599672, "link": "https://stackoverflow.com/questions/50599672/excel-vba-subscript-out-of-range/50599788#50599788", "title": "Excel VBA , subscript out of range", "body": "<p>Assuming 'Manutencao' is the worksheet name, then change this line to:</p>\n\n<pre><code>last = src.Worksheets(\"Manutencao\").Range(\"A65536\").End(xlUp).Row\n</code></pre>\n\n<p>Note the <code>\"\"</code> around the worksheet name. You'll have to change this wherever you reference this worksheet.</p>\n\n<p><strong>EDIT:</strong>  Your code could be rewritten like this, to be a little clearer;</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n    Dim src As Workbook\n    Dim last As Long\n\n    On Error GoTo ErrHandler\n\n    With Application\n        .ScreenUpdating = False\n        .DisplayAlerts = False\n        .EnableEvents = False\n    End With\n\n    Set src = Workbooks.Open(\"U:\\Mec\u00e2nica\\Produ\u00e7\u00e3o\\63177 - Qualidade\\Rejei\u00e7\u00e3o Interna\\Dados\\Gaspar\\Projeto Manuten\u00e7\u00e3o.xlsm\", True, False)\n\n    With src.Worksheets(\"Manutencao\")\n        .Unprotect Password:=\"projmanutencao\"\n        last = .Cells(Rows.Count, \"A\").End(xlUp).Row\n        .Cells(last + 1, 1) = Now()                        'data\n        .Cells(last + 1, 2) = manutencaoexp.ComboBox3      'n\u00ba equipamento\n        .Cells(last + 1, 3) = manutencaoexp.ComboBox5                          'avaria\n        .Cells(last + 1, 4) = manutencaoexp.ComboBox4      'servi\u00e7os\n'        .Cells(last + 1, 5) = Velocidade                   'produtos\n'        .Cells(last + 1, 6) = Qualidade                    'dura\u00e7\u00e3o\n'        .Cells(last + 1, 7) = Data                         'operario\n        .Cells(last + 1, 8) = manutencaoexp.ComboBox6      'tipo de manuten\u00e7\u00e3o\n        .Protect Password:=\"projmanutencao\"\n    End With\n    src.Close True             ' FALSE - DON'T SAVE THE SOURCE FILE.\n    Set src = Nothing\n\nErrHandler:\n    If Err Then\n        Debug.Print \"Error\", Err.Number, Err.Description\n        Err.Clear\n    With Application\n        .EnableEvents = True\n        .ScreenUpdating = True\n        .DisplayAlerts = True\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 9, "user_id": 9769263, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6231ff18cecbd872f68b95a4bfb5a25e?s=128&d=identicon&r=PG", "display_name": "Pedro Gaspar", "link": "https://stackoverflow.com/users/9769263/pedro-gaspar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1797, "favorite_count": 0, "accepted_answer_id": 50599788, "answer_count": 1, "score": -1, "last_activity_date": 1527669630, "creation_date": 1527668318, "last_edit_date": 1527668718, "question_id": 50599672, "link": "https://stackoverflow.com/questions/50599672/excel-vba-subscript-out-of-range", "title": "Excel VBA , subscript out of range", "body": "<p>so i started writting a code that would write from Workbook1 UserForm to WorkBook2 sheet. For some unknown reason it's not copying the data . </p>\n\n<pre><code>Private Sub CommandButton1_Click()\n  On Error GoTo ErrHandler\n  Application.ScreenUpdating = False\n  Dim src As Workbook\n   ' Open EXCEL\nSet src = Workbooks.Open(\"U:\\Mec\u00e2nica\\Produ\u00e7\u00e3o\\63177 - Qualidade\\Rejei\u00e7\u00e3o Interna\\Dados\\Gaspar\\Projeto Manuten\u00e7\u00e3o.xlsm\", True, False)\nWS_Count = src.Worksheets.Count\nFor o = 1 To WS_Count\n src.Worksheets(o).Unprotect password:=\"projmanutencao\"\nNext o\n\nlast = src.Worksheets(Manutencao).Range(\"A65536\").End(xlUp).Row\n\n    ' Write regists\n\n   src.Worksheets(Manutencao).Cells(last + 1, 1) = Now()                        'data\n   src.Worksheets(Manutencao).Cells(last + 1, 2) = manutencaoexp.ComboBox3      'n\u00ba equipamento\n   src.Worksheets(Manutencao).Cells(last + 1, 3) = manutencaoexp.ComboBox5                          'avaria\n   src.Worksheets(Manutencao).Cells(last + 1, 4) = manutencaoexp.ComboBox4      'servi\u00e7os\n'      src.Worksheets(Manutencao).Cells(last + 1, 5) = Velocidade                   'produtos\n'      src.Worksheets(Manutencao).Cells(last + 1, 6) = Qualidade                    'dura\u00e7\u00e3o\n'      src.Worksheets(Manutencao).Cells(last + 1, 7) = Data                         'operario\n   src.Worksheets(Manutencao).Cells(last + 1, 8) = manutencaoexp.ComboBox6      'tipo de manuten\u00e7\u00e3o\n\n      For o = 1 To WS_Count\n src.Worksheets(o).Protect password:=\"projmanutencao\"\n Next o\n\n\n  Application.DisplayAlerts = False 'IT WORKS TO DISABLE ALERT PROMPT\n\n  'SAVES FILE USING THE VARIABLE BOOKNAME AS FILENAME\n  src.Save\n\n  Application.DisplayAlerts = True 'RESETS DISPLAY ALERTS\n\n' CLOSE THE SOURCE FILE.\nsrc.Close True             ' FALSE - DON'T SAVE THE SOURCE FILE.\nSet src = Nothing\n\n\n\nErrHandler:\nApplication.EnableEvents = True\nApplication.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n\n<p>If someone can help fix this piece of code , or maybe have a code that copies from a diferente workbook userform . I'm getting a subscript out of range error in</p>\n\n<p><code>last = src.Worksheets(Manuten\u00e7\u00e3o).Range(\"A65536\").End(x1Up).Row</code></p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1527669353, "post_id": 50599972, "comment_id": 88209106, "body": "This is interesting. But with me (German Excel) <code>arg9:=xlNo</code> still leaves the checkbox."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1527669697, "post_id": 50599972, "comment_id": 88209315, "body": "@Vityata I should have tested first. It didn&#39;t pick up the argument for some reason. So switched to the above."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 1, "creation_date": 1527669939, "post_id": 50599972, "comment_id": 88209464, "body": "@vityata TBH It seems to remember the last setting you put in. I don&#39;t know if this is preserved between sessions, but can one not simply tick this box and it remain in place until unchecked?"}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": true, "score": 2, "last_activity_date": 1527669430, "last_edit_date": 1527669430, "creation_date": 1527669218, "answer_id": 50599972, "question_id": 50599664, "link": "https://stackoverflow.com/questions/50599664/sortdialog-box-vba/50599972#50599972", "title": "Sortdialog Box VBA", "body": "<p>Try</p>\n\n<pre><code>ActiveSheet.Sort.Header = xlYes\nApplication.Dialogs(xlDialogSort).Show \n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 167, "user_id": 9630197, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/31d5cd6a208cf541aea4da0c87ac2e3e?s=128&d=identicon&r=PG&f=1", "display_name": "SB999", "link": "https://stackoverflow.com/users/9630197/sb999"}, "edited": false, "score": 1, "creation_date": 1527670354, "post_id": 50599980, "comment_id": 88209719, "body": "thanks for providing the solution above - This also works well!"}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 1, "last_activity_date": 1527669801, "last_edit_date": 1527669801, "creation_date": 1527669239, "answer_id": 50599980, "question_id": 50599664, "link": "https://stackoverflow.com/questions/50599664/sortdialog-box-vba/50599980#50599980", "title": "Sortdialog Box VBA", "body": "<p>You can perform some workaround and force the <code>.Header</code> in the sort, using <code>.Header = xlYes</code>:</p>\n\n<pre><code>Sub TestMe()\n\n    Dim mySort As Sort\n    Dim myRng As Range: Set myRng = Range(\"A1:B3\")\n    Dim ws As Worksheet: Set ws = Worksheets(1)\n\n    If Application.Dialogs(xlDialogSort).Show Then\n        Set mySort = ws.Sort\n        mySort.SetRange myRng\n        mySort.Header = xlYes\n        mySort.SortMethod = xlPinYin\n        mySort.Apply\n    End If\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 167, "user_id": 9630197, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/31d5cd6a208cf541aea4da0c87ac2e3e?s=128&d=identicon&r=PG&f=1", "display_name": "SB999", "link": "https://stackoverflow.com/users/9630197/sb999"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 56, "favorite_count": 0, "accepted_answer_id": 50599972, "answer_count": 2, "score": 2, "last_activity_date": 1527669801, "creation_date": 1527668292, "last_edit_date": 1531164843, "question_id": 50599664, "link": "https://stackoverflow.com/questions/50599664/sortdialog-box-vba", "title": "Sortdialog Box VBA", "body": "<p>All I have the below code which selects a variable range and displays the user with a sort dialog box. Which enables the user to sort the data. </p>\n\n<p>The issue I face is that the sort dialog appears with the \"My data has headers\" box unticked. I need to force this to always be selected. </p>\n\n<p>Any advice of how to ensure this is ticked would be much appreciated. </p>\n\n<pre><code>OtherExp.Range(\"B3:CE\" &amp; lastrow).Select\n\nOn Error Resume Next\nApplication.Dialogs(xlDialogSort).Show\nIf Err.Number = 1004 Then\n    MsgBox \"Place the cursor in the area to be sorted\"\nEnd If\nErr.Clear\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/tS6pJ.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/tS6pJ.jpg\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["excel", "vba", "concatenation"], "comments": [{"owner": {"reputation": 11114, "user_id": 1712135, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cErYR.png?s=128&g=1", "display_name": "deHaar", "link": "https://stackoverflow.com/users/1712135/dehaar"}, "edited": false, "score": 0, "creation_date": 1527667160, "post_id": 50599113, "comment_id": 88207724, "body": "Please show your code that does not work and the error message or the wrong output."}, {"owner": {"reputation": 1026, "user_id": 8788388, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-j4tnBdMaXfk/AAAAAAAAAAI/AAAAAAACwcU/Jg67BYcCeW0/photo.jpg?sz=128", "display_name": "Hakan ERDOGAN", "link": "https://stackoverflow.com/users/8788388/hakan-erdogan"}, "edited": false, "score": 1, "creation_date": 1527667271, "post_id": 50599113, "comment_id": 88207790, "body": "Do you have to hardcode the formatted ID? Instead you may keep the cells as they are and format them with this string (using right click <b>Format Cells</b> menu): <code>##&quot;.&quot;###-####</code>"}, {"owner": {"reputation": 1026, "user_id": 8788388, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-j4tnBdMaXfk/AAAAAAAAAAI/AAAAAAACwcU/Jg67BYcCeW0/photo.jpg?sz=128", "display_name": "Hakan ERDOGAN", "link": "https://stackoverflow.com/users/8788388/hakan-erdogan"}, "edited": false, "score": 0, "creation_date": 1527667550, "post_id": 50599113, "comment_id": 88207966, "body": "Or you may use CHAR(38) instead of &amp; character in VBA."}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1527674726, "post_id": 50599113, "comment_id": 88212848, "body": "Why use formulas?  Why not either format it in VBA and write the result to the cell; or use Conditional Formatting to do this?"}], "answers": [{"tags": [], "owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "is_accepted": false, "score": 2, "last_activity_date": 1527667260, "creation_date": 1527667260, "answer_id": 50599344, "question_id": 50599113, "link": "https://stackoverflow.com/questions/50599113/how-to-concatenate-in-vba/50599344#50599344", "title": "How to concatenate in vba", "body": "<p>The <code>&amp;</code> you are providing in your code is used as concatenation operator within <em>VBA</em>, concatenating the strings <code>\"=left(SecId,3)\"</code> and <code>.</code>.</p>\n\n<p>You want the <code>&amp;</code> as part of the formula, so simply put it into the string. Now, <em>VBA</em> doesn't see the <code>&amp;</code> as operator but simply as part of the string. It will then be part of the formula in the cell and <em>Excel</em> will interpret it.</p>\n\n<pre><code>cells(i,6).formula = \"=left(SecId,3)&amp;.\"\n</code></pre>\n\n<p>Of course you can use the <code>&amp;</code> within VBA if you need to:</p>\n\n<pre><code>cells(i,6).formula = \"=left(SecId,3)\" &amp; \"&amp;.\"\n</code></pre>\n\n<p>Now the first <code>&amp;</code> is seen by <em>VBA</em> while the second one is part of a string and passed to <em>Excel</em>.</p>\n"}], "owner": {"reputation": 9, "user_id": 3323408, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cfe8dd002f4c4bf7a969495e295ef695?s=128&d=identicon&r=PG&f=1", "display_name": "Peter Grandjean", "link": "https://stackoverflow.com/users/3323408/peter-grandjean"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 157, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1527685735, "creation_date": 1527666499, "last_edit_date": 1527667178, "question_id": 50599113, "link": "https://stackoverflow.com/questions/50599113/how-to-concatenate-in-vba", "title": "How to concatenate in vba", "body": "<p>I have approximately 100000 lines with data from different countries.\nI have to format the national IDs into different formats.\nEg 123456789 should be 12.345-6789\nMy challenge is that if I use</p>\n\n<pre><code>cells(i,6).formula = \"=left(SecId,3)\"\n</code></pre>\n\n<p>It should be followed by &amp;\".\" and so on</p>\n\n<p>But this will not work.</p>\n\n<p>Any suggestions ?</p>\n"}, {"tags": ["vba", "excel", "powerpoint"], "comments": [{"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 1, "creation_date": 1527668719, "post_id": 50599051, "comment_id": 88208670, "body": "If you are asking <i>why</i> the order varies, the answer would be <i>thats a result of how the objects were created or manipulated</i>.  If you are asking <i>how to deal with it</i>  then the answer is you need some other way to identify which object is which.   Perhaps position on the slide?"}, {"owner": {"reputation": 137, "user_id": 7225462, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/zXjhD.jpg?s=128&g=1", "display_name": "SLLegendre", "link": "https://stackoverflow.com/users/7225462/sllegendre"}, "reply_to_user": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 0, "creation_date": 1527669042, "post_id": 50599051, "comment_id": 88208897, "body": "Thank you. Exactly my two questions. So teh Shapes array is tracked by &#39;last edited&#39; ? I could not find that online. Will try and work around with position."}, {"owner": {"reputation": 12482, "user_id": 1667023, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JXaUt.png?s=128&g=1", "display_name": "Steve Rindsberg", "link": "https://stackoverflow.com/users/1667023/steve-rindsberg"}, "edited": false, "score": 1, "creation_date": 1527694801, "post_id": 50599051, "comment_id": 88227066, "body": "@SLLegendre No, not by last edited, but some types of editing (send forward/backward/to back/to front) would change the order. As Chris suggested, a way of uniquely identifying the shapes would help. When you create the shape, you can add a .Tag whose name/value would identify it, then when you go to copy the shape, a function that returns the shape with a given tag would hand you back the shape you&#39;re after.  There&#39;s more detail and sample code on this page in the PPT faq I maintain: Tags <a href=\"http://www.pptfaq.com/FAQ00815_Working_with_Tags_-and_a_bit_about_Functions-.htm\" rel=\"nofollow noreferrer\">pptfaq.com/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 137, "user_id": 7225462, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/zXjhD.jpg?s=128&g=1", "display_name": "SLLegendre", "link": "https://stackoverflow.com/users/7225462/sllegendre"}, "is_accepted": true, "score": 0, "last_activity_date": 1529489643, "creation_date": 1529489643, "answer_id": 50945736, "question_id": 50599051, "link": "https://stackoverflow.com/questions/50599051/copy-powerpoint-shapes-to-excel-identically-looking-slides-different-shape-or/50945736#50945736", "title": "Copy Powerpoint Shapes to Excel - identically looking slides, different shape order", "body": "<p>What helped me in the end was multiplying the left and top position for each textbox. That value was unique enough for the relevant content to end up in the same column for each slide. Ordering the columns themselves in Excel, I still needed to do manually but that was an easy task. The quick sort algorithm I got from another <a href=\"https://stackoverflow.com/questions/152319/vba-array-sort-function\">stackoverflow question</a></p>\n\n<pre><code>Sub CopyFromPowerpoint()\n\n        'Prepare variables\n        Dim PowerPoint As PowerPoint.Application\n        Dim activeSlide As PowerPoint.Slide\n        Dim curShape As PowerPoint.shape\n        Dim RowCounter As Integer\n        Dim ColumnCounter As Integer\n        Dim shapeCounter As Long\n        Dim tmp(20) As String\n        Dim arr(20) As Long\n        Dim tmpMult As Long\n\n        'Set powerPoint\n        Set PowerPoint = GetObject(, \"PowerPoint.Application\")\n\n        RowCounter = 1\n        ColumnCounter = 1\n        For Each Slide In PowerPoint.Presentations(1).Slides\n        Set activeSlide = PowerPoint.Presentations(1).Slides(RowCounter)\n\n           'Loop through shapes, note their position from top and left, multiply them and sort it\n            shapeCounter = LBound(arr)\n            For Each shape In activeSlide.Shapes\n                arr(CInt(shapeCounter)) = shape.Top * shape.Left\n                shapeCounter = shapeCounter + 1\n            Next\n            Call QuickSort(arr, LBound(arr), UBound(arr))\n\n\n\n            'Loop through shapes again and copy shape text into relevant position in text array\n            For Each shape In activeSlide.Shapes\n            If shape.TextFrame.HasText Then\n                For i = LBound(arr) To UBound(arr)\n                    tmpMult = shape.Top * shape.Left\n                    If arr(i) = tmpMult Then tmp(i) = shape.TextFrame.TextRange\n                    tmpMult = 0\n                Next i\n            End If\n\n            Next\n\n            'Loop through text array and paste into worksheet\n            For i = LBound(tmp) To UBound(tmp)\n                Worksheets(\"uebergabe\").Cells(RowCounter, i + 1).Value = tmp(i)\n            Next i\n\n            'Reset for next slide\n            RowCounter = RowCounter + 1\n            shapeCounter = 0\n            For i = LBound(arr) To UBound(arr)\n                arr(i) = 0\n                tmp(i) = \"\"\n            Next i\n\n\n         Next\n\n\nEnd Sub\n\nPublic Sub QuickSort(vArray As Variant, inLow As Long, inHi As Long)\n\n  Dim pivot   As Variant\n  Dim tmpSwap As Variant\n  Dim tmpLow  As Long\n  Dim tmpHi   As Long\n\n  tmpLow = inLow\n  tmpHi = inHi\n\n  pivot = vArray((inLow + inHi) \\ 2)\n\n  While (tmpLow &lt;= tmpHi)\n\n     While (vArray(tmpLow) &lt; pivot And tmpLow &lt; inHi)\n        tmpLow = tmpLow + 1\n     Wend\n\n     While (pivot &lt; vArray(tmpHi) And tmpHi &gt; inLow)\n        tmpHi = tmpHi - 1\n     Wend\n\n     If (tmpLow &lt;= tmpHi) Then\n        tmpSwap = vArray(tmpLow)\n        vArray(tmpLow) = vArray(tmpHi)\n        vArray(tmpHi) = tmpSwap\n        tmpLow = tmpLow + 1\n        tmpHi = tmpHi - 1\n     End If\n\n  Wend\n\n  If (inLow &lt; tmpHi) Then QuickSort vArray, inLow, tmpHi\n  If (tmpLow &lt; inHi) Then QuickSort vArray, tmpLow, inHi\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 137, "user_id": 7225462, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/zXjhD.jpg?s=128&g=1", "display_name": "SLLegendre", "link": "https://stackoverflow.com/users/7225462/sllegendre"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 196, "favorite_count": 0, "accepted_answer_id": 50945736, "answer_count": 1, "score": 0, "last_activity_date": 1529489643, "creation_date": 1527666290, "question_id": 50599051, "link": "https://stackoverflow.com/questions/50599051/copy-powerpoint-shapes-to-excel-identically-looking-slides-different-shape-or", "title": "Copy Powerpoint Shapes to Excel - identically looking slides, different shape order", "body": "<p>I have a presentation with 32 identically looking slides (initally macro generated, later had human touch). </p>\n\n<p>Simplified look:</p>\n\n<p>Title (not formatted as a headline, though)<br>\npicture<br>\nContent1<br>\nContent2<br>\nContent3</p>\n\n<p>I now want to copy the text back to Excel. Although all slides <b>look</b> identical, the order of the shapes in slide.Shapes seems different.</p>\n\n<p>For every slide I want a row, with the colums in the same order:<br> Title, Content1, Content2,Content3<br> but some are <br>Content1,Content3,Title,Content2\n(or any other order)</p>\n\n<p>Why is this? </p>\n\n<p>My code: </p>\n\n<pre><code>    Sub CopyFromPowerpoint()\n\n        'Prepare variables\n        Dim PowerPoint As PowerPoint.Application\n        Dim activeSlide As PowerPoint.Slide\n        Dim curShape As PowerPoint.shape\n        Dim RowCounter As Integer\n        Dim ColumnCounter As Integer\n        Dim tmp As String\n\n        'Set powerPoint\n        Set PowerPoint = GetObject(, \"PowerPoint.Application\")\n\n        tmp = \"XXX\" 'this should never be pasted\n        RowCounter = 1\n        ColumnCounter = 1\n        For Each Slide In PowerPoint.Presentations(1).Slides\n        Set activeSlide = PowerPoint.Presentations(1).Slides(RowCounter)\n            For Each shape In activeSlide.Shapes\n                Set curShape = activeSlide.Shapes(ColumnCounter)\n                If curShape.TextFrame.HasText Then tmp = curShape.TextFrame.TextRange\n                If curShape.TextFrame.HasText Then Worksheets(\"nameofsheet\").Cells(RowCounter, ColumnCounter).Value = tmp\n                ColumnCounter = ColumnCounter + 1\n            Next\n            ColumnCounter = 1\n            RowCounter = RowCounter + 1\n         Next\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["arrays", "vba", "excel", "loops", "email"], "comments": [{"owner": {"reputation": 6232, "user_id": 509977, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/DxOt0.jpg?s=128&g=1", "display_name": "Pitto", "link": "https://stackoverflow.com/users/509977/pitto"}, "edited": false, "score": 1, "creation_date": 1527667580, "post_id": 50598881, "comment_id": 88207986, "body": "Please provide a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>"}, {"owner": {"reputation": 89, "user_id": 9771985, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-RATNx_cZj94/AAAAAAAAAAI/AAAAAAAAAIk/m8nZ46xi8Jk/photo.jpg?sz=128", "display_name": "user1234", "link": "https://stackoverflow.com/users/9771985/user1234"}, "reply_to_user": {"reputation": 6232, "user_id": 509977, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/DxOt0.jpg?s=128&g=1", "display_name": "Pitto", "link": "https://stackoverflow.com/users/509977/pitto"}, "edited": false, "score": 0, "creation_date": 1527670992, "post_id": 50598881, "comment_id": 88210156, "body": "done, added the code and my attempt"}], "answers": [{"tags": [], "owner": {"reputation": 3359, "user_id": 4604845, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/88d81c9b06f65d860bb60c31ab062e7e?s=128&d=identicon&r=PG&f=1", "display_name": "Vegard", "link": "https://stackoverflow.com/users/4604845/vegard"}, "is_accepted": true, "score": 1, "last_activity_date": 1528097805, "last_edit_date": 1528097805, "creation_date": 1527844058, "answer_id": 50639860, "question_id": 50598881, "link": "https://stackoverflow.com/questions/50598881/creating-an-array-to-post-in-email-body/50639860#50639860", "title": "Creating an array to post in email body", "body": "<p>It's not very clear what exactly you are trying to do, so I am doing a little guesswork based on what can be inferred from your code.</p>\n\n<p>Change this</p>\n\n<pre><code>Dim leg(0 To 15) As Range\n\nDim a As Range\nFor a = FirstRange To LastRange\n   leg(a) = \"Leg\" &amp; \"[\" &amp; a &amp; \"]\"\nNext a\n</code></pre>\n\n<p>to something like this:</p>\n\n<pre><code>Dim leg(0 To 15) As String\n\nDim a As Long\nFor a = FirstRange.Row To LastRange.Row\n   leg(a) = \"Leg\" &amp; \"[\" &amp; a &amp; \"]\"\nNext a\n</code></pre>\n\n<p>In order, the problems were:</p>\n\n<ol>\n<li><p><code>a</code> can't be <code>Range</code> datatype when you want to use it as a counter in a <code>For</code>-loop (unless you use <code>For Each</code>). <code>For a = ...</code> means <code>a</code> must be numerical, so <code>Integer</code> or <code>Long</code> in practice.  </p></li>\n<li><p>In the context of the above, VBA doesn't understand what you mean when you say \"go numerically from the first range to the second range\", as a <code>Range</code> object has many properties (the default one being <code>Value</code>, and not <code>Address</code> or <code>Row</code>).  </p></li>\n<li><p>You were trying to assign <code>String</code> values to a <code>Range</code> array. An array can only hold contain items with the same datatype as itself (except for <code>Variant</code> which can hold anything).  </p></li>\n</ol>\n\n<p>In your second attempt you are closer, but #2 from above applies there as well, Additionally, you didn't properly set a size for the array so it was impossible to populate it.</p>\n\n<p><strong>An alternative solution</strong> (though I am making assumptions based on what your dataset looks like, but I think maybe it's closer to what you will need):</p>\n\n<pre><code>Dim leg(0 To 15) As String\nDim a As Range, b As Long: b = 0\n\nFor Each a In xRg\n   leg(b) = \"Leg[\" &amp; a.Value &amp; \"]\"\n   b = b + 1\nNext a\n</code></pre>\n\n<p>Translated to human language:</p>\n\n<ol>\n<li>Look at each element (cell) denoted by <code>a</code>, in the range <code>xRg</code> (which your earlier code has defined as going from <code>FirstRange</code> to <code>LastRange</code>).</li>\n<li>Add some text and the value contained in this element to the array <code>leg()</code>.</li>\n<li>Once a value has been added to <code>leg()</code>, increment the counter that keeps track of what part of the array we're adding values to.</li>\n</ol>\n\n<p>The code contains no errorchecking or array resizing, meaning you will get <code>out of range</code> or similar errors if <code>xRg</code> contains more than 16 cells.</p>\n"}], "owner": {"reputation": 89, "user_id": 9771985, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-RATNx_cZj94/AAAAAAAAAAI/AAAAAAAAAIk/m8nZ46xi8Jk/photo.jpg?sz=128", "display_name": "user1234", "link": "https://stackoverflow.com/users/9771985/user1234"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 258, "favorite_count": 0, "accepted_answer_id": 50639860, "answer_count": 1, "score": 0, "last_activity_date": 1528097805, "creation_date": 1527665725, "last_edit_date": 1527842603, "question_id": 50598881, "link": "https://stackoverflow.com/questions/50598881/creating-an-array-to-post-in-email-body", "title": "Creating an array to post in email body", "body": "<p>I am quite new to vba and was hoping I could get some help.\nI need to create a code that generates an email that depends on the excel sheet.\nCurrently, I managed everything except for the following bit which I am stuck on.\nThe excel contains a list of options, lets call them a,b,c,d...n.\nIn the body of the email I would like it to say:</p>\n\n<pre><code>OPTION1 a\nOPTION2 b\nOPTION3 c\n</code></pre>\n\n<p>So I need the code to also work out the option number it is (the number of options can change, sometimes 8, sometime more) and add it next to the word option. I guess I would need to create some loop but really dont know how to proceed.\nAny help would be greatly appreciated. </p>\n\n<p>This is code, with some sort of attempt at creating the loop. When i add the loop, my email returns a blank.</p>\n\n<pre><code>'Getting the xRg\n\n On Error Resume Next\n    xAddress = ActiveWindow.RangeSelection.Address\n    Set FirstRange = Range(\"A12\")\n    Set LastRange = FirstRange.End(xlDown)\n    Set xRg = Range(FirstRange, LastRange).SpecialCells(xlCellTypeVisible)\n If xRg Is Nothing Then Exit Sub\n Application.ScreenUpdating = False\nSet xOutApp = CreateObject(\"Outlook.Application\")\nSet xMailOut = xOutApp.CreateItem(olMailItem)\nFor I = 1 To xRg.Rows.Count\n    For J = 1 To xRg.Columns.Count\n        xEmailBody = xEmailBody &amp; \"  \" &amp; xRg.Cells(I, J).Value\n    Next\n    xEmailBody = xEmailBody &amp; \"&lt;br/&gt;\"\nNext\nxEmailBody = vbLf &amp; xEmailBody &amp; \"&lt;br/&gt;\"\n\n'Creating a loop for the legs\nDim a As integer\nDim option() As integer\nFor a = FirstRange To LastRange\n    ReDim Preserve leg(a)\n    option(a) = \"leg\" &amp; a\n</code></pre>\n\n<p>Next a</p>\n\n<p>this is edited code for the loop, but still not working...please help</p>\n\n<pre><code>Dim leg(0 To 15) As Range\n\nDim a As Range\nFor a = FirstRange To LastRange\n   leg(a) = \"Leg\" &amp; \"[\" &amp; a &amp; \"]\"\nNext a\n</code></pre>\n\n<p>I get type mismatch</p>\n\n<p>and this just returns nothing in the email:</p>\n\n<pre><code>Dim leg() As Variant\nleg() = Range(FirstRange, LastRange).Value\n\nDim a As Variant\nFor a = FirstRange To LastRange\n    leg(a) = \"Leg\" &amp; \"[\" &amp; a &amp; \"]\"\nNext a\n</code></pre>\n"}, {"tags": ["vba", "excel", "excel-formula"], "comments": [{"owner": {"reputation": 1026, "user_id": 8788388, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-j4tnBdMaXfk/AAAAAAAAAAI/AAAAAAACwcU/Jg67BYcCeW0/photo.jpg?sz=128", "display_name": "Hakan ERDOGAN", "link": "https://stackoverflow.com/users/8788388/hakan-erdogan"}, "edited": false, "score": 0, "creation_date": 1527664868, "post_id": 50598556, "comment_id": 88206298, "body": "Try changing the double quotes with single quotes in your VBA formula string."}, {"owner": {"reputation": 194, "user_id": 8978777, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c516087c61b368e673e81440bf15519?s=128&d=identicon&r=PG&f=1", "display_name": "Kajkrow", "link": "https://stackoverflow.com/users/8978777/kajkrow"}, "edited": false, "score": 0, "creation_date": 1527664878, "post_id": 50598556, "comment_id": 88206305, "body": "your syntax in vba changes. you have to replace &quot; in your normal function by &quot;&quot;&#39;, else vba thinks your string is ending and not that you actually want to write down an &quot;. so try this: reportsheet.Range(&quot;A1&quot;).Formula = &quot;=TRIM(LEFT(RIGHT(&quot;&quot; &quot;&quot; &amp; SUBSTITUTE(TRIM(A20),&quot;&quot; &quot;&quot; ,REPT(&quot;&quot; &quot;&quot;,60)),180),60))&quot;&quot;"}, {"owner": {"reputation": 99, "user_id": 9863726, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "aso im", "link": "https://stackoverflow.com/users/9863726/aso-im"}, "edited": false, "score": 0, "creation_date": 1527665414, "post_id": 50598556, "comment_id": 88206665, "body": "Thank you guys. However, it still overwrites the contents of the cell instead of applying the formula. Is there something else I am missing?"}, {"owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "edited": false, "score": 0, "creation_date": 1527665835, "post_id": 50598556, "comment_id": 88206932, "body": "the content of <i>which</i> cell? <code>A20</code> should be unchanged, <code>A1</code> should show the word you extracted."}, {"owner": {"reputation": 99, "user_id": 9863726, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "aso im", "link": "https://stackoverflow.com/users/9863726/aso-im"}, "edited": false, "score": 0, "creation_date": 1527666064, "post_id": 50598556, "comment_id": 88207080, "body": "I am really sorry, I had a mistake. The code I was testing has A1 in both cases."}, {"owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "edited": false, "score": 0, "creation_date": 1527666530, "post_id": 50598556, "comment_id": 88207354, "body": "You cannot have two different values in one cell at the same time. How should that work? Either it holds the long string or the extracted word. You will get a <i>&quot;circular reference&quot;</i> message from Excel when you do so."}, {"owner": {"reputation": 99, "user_id": 9863726, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "aso im", "link": "https://stackoverflow.com/users/9863726/aso-im"}, "edited": false, "score": 0, "creation_date": 1527666616, "post_id": 50598556, "comment_id": 88207419, "body": "Yea that was my bad for thinking I could do it. I guess my solution is to trim the string before I move it to the other sheet to avoid having to create 2 sheets"}, {"owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "edited": false, "score": 0, "creation_date": 1527667359, "post_id": 50598556, "comment_id": 88207855, "body": "The common solution is to create a helper column holding the formula. You can even hide it"}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 2, "last_activity_date": 1527664851, "creation_date": 1527664851, "answer_id": 50598629, "question_id": 50598556, "link": "https://stackoverflow.com/questions/50598556/how-to-apply-a-excel-formula-in-vba-macro-to-find-the-2nd-to-last-word/50598629#50598629", "title": "How to apply a Excel formula in VBA macro to find the 2nd to last word", "body": "<p>Double up quotes within a quoted string or use alternatives.</p>\n\n<pre><code>reportsheet.Range(\"A1\").Formula = \"=TRIM(LEFT(RIGHT(\"\" \"\" &amp; SUBSTITUTE(TRIM(A20),\"\" \"\" ,REPT(\"\" \"\",60)),180),60))\"\n'alternative\nreportsheet.Range(\"A1\").Formula = \"=TRIM(LEFT(RIGHT(char(32) &amp; SUBSTITUTE(TRIM(A20), char(32), REPT(char(32),60)),180),60))\"\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 99, "user_id": 9863726, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "aso im", "link": "https://stackoverflow.com/users/9863726/aso-im"}, "edited": false, "score": 0, "creation_date": 1527666294, "post_id": 50598864, "comment_id": 88207214, "body": "Thanks. I mostly work with Excel formulas (sometimes to my own detriment) and am fairly clueless with VBA"}, {"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 0, "creation_date": 1527669287, "post_id": 50598864, "comment_id": 88209048, "body": "OP wants <i>n&#39;th to last</i> word, so you should return  <code>arr(UBound(arr) - n + 1)</code>"}], "tags": [], "owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "is_accepted": false, "score": 2, "last_activity_date": 1527665679, "creation_date": 1527665679, "answer_id": 50598864, "question_id": 50598556, "link": "https://stackoverflow.com/questions/50598556/how-to-apply-a-excel-formula-in-vba-macro-to-find-the-2nd-to-last-word/50598864#50598864", "title": "How to apply a Excel formula in VBA macro to find the 2nd to last word", "body": "<p>Doubling the quotes as @Jeeped and the commenters wrote is solving your issue with the formula.\nAs an alternative, you could write a function (\"UDF\") that returns the n-th word of a string. It is rather easy by using the VBA function <code>split</code> that returns an array of strings. Put the following code in a Module:</p>\n\n<pre><code>Public Function getWord(s As String, ByVal n As Integer) As String\n\n    n = n - 1   ' Because Array index will start at 0\n\n    Dim arr() As String\n    arr = Split(s, \" \")\n    If UBound(arr) &gt;= n Then\n        getWord = arr(n)\n    End If\n\nEnd Function\n</code></pre>\n\n<p>In Excel, you write for example <code>=getWord(A20, 3)</code> as formula</p>\n"}], "owner": {"reputation": 99, "user_id": 9863726, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "aso im", "link": "https://stackoverflow.com/users/9863726/aso-im"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 144, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1527666027, "creation_date": 1527664612, "last_edit_date": 1527666027, "question_id": 50598556, "link": "https://stackoverflow.com/questions/50598556/how-to-apply-a-excel-formula-in-vba-macro-to-find-the-2nd-to-last-word", "title": "How to apply a Excel formula in VBA macro to find the 2nd to last word", "body": "<p>I am quite new to VBA but have been working with Excel a bit. I created a formula that does exactly what I need it to do: find the Nth to last word (mostly 2nd or 3rd to last) in a cell. I think my main issue is how to apply a formula to a range of cells without overwriting the cell and how to use excel formulas in VBA. The Excel formula I use is as follows </p>\n\n<pre><code>=TRIM(LEFT(RIGHT(\" \"&amp;SUBSTITUTE(TRIM(A1),\" \",REPT(\" \",60)),180),60))\n</code></pre>\n\n<p>It might not be the most eloquent way but it works pretty well in Excel. Changing the number 180 to 60 will give last word, 120 2nd to last and so on. But in VBA it gives 1st syntax error and when I get it to run without the arguments and with only TRIM(A1) it overwrites the cell. The code I use is as follows (referencing only A1 to test it):</p>\n\n<pre><code>reportsheet.Range(\"A1\").Formula = \"=TRIM(LEFT(RIGHT(\" \" &amp; SUBSTITUTE(TRIM(A1),\" \" ,REPT(\" \",60)),180),60))\"\n</code></pre>\n\n<p>My macro searches and extracts specific data from Sheet1 to Sheet2. Now I would want to apply this (or a similar) formula to the data it extracts to the Sheet2. I have tried a lot of different things from using VBA's own trim to making a completely custom function. None of it seems to work and I think it is down to a misunderstanding on how Excel formulas and VBA play together.</p>\n\n<p>In addition I am trying to find a way to find the only numbers in the cell and trim out everything else. Any help with this would also be appreciated.</p>\n\n<p>EDIT: Sorry guys, I had a mistake in the code I provided, it should have been referring to A1 in both instances.</p>\n"}, {"tags": ["javascript", "html", "vba", "web-scraping"], "comments": [{"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1527666111, "post_id": 50598496, "comment_id": 88207110, "body": "what do you mean by &quot;search websites&quot;? Do you want to search a page&#39;s HTML for specific words, or do you want to search across multiple pages?"}], "answers": [{"comments": [{"owner": {"reputation": 325, "user_id": 9640782, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/777f5981ccbedfef10d48ccdebc34735?s=128&d=identicon&r=PG&f=1", "display_name": "Arkadiusz", "link": "https://stackoverflow.com/users/9640782/arkadiusz"}, "edited": false, "score": 0, "creation_date": 1527668357, "post_id": 50599043, "comment_id": 88208437, "body": "Great!, in the same way I&#39;ve tried to click button &quot;Przet\u0142umacz&quot; but it doesn&#39;t work. (    objIE.Document.GetElementByTagName(&quot;BUTTON&quot;)(5).Click)"}, {"owner": {"reputation": 2031, "user_id": 6097926, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/187bc2674bbdf7651e7137e1427b9bd6?s=128&d=identicon&r=PG&f=1", "display_name": "Ryszard J\u0119draszyk", "link": "https://stackoverflow.com/users/6097926/ryszard-j%c4%99draszyk"}, "reply_to_user": {"reputation": 325, "user_id": 9640782, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/777f5981ccbedfef10d48ccdebc34735?s=128&d=identicon&r=PG&f=1", "display_name": "Arkadiusz", "link": "https://stackoverflow.com/users/9640782/arkadiusz"}, "edited": false, "score": 0, "creation_date": 1527668866, "post_id": 50599043, "comment_id": 88208753, "body": "It&#39;s &quot;Elements&quot; in method name and index of 5th element is 4, because enumeration starts from 0. Use: <code>objIE.Document.GetElementsByTagName(&quot;BUTTON&quot;)(4).Click</code>"}, {"owner": {"reputation": 325, "user_id": 9640782, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/777f5981ccbedfef10d48ccdebc34735?s=128&d=identicon&r=PG&f=1", "display_name": "Arkadiusz", "link": "https://stackoverflow.com/users/9640782/arkadiusz"}, "edited": false, "score": 0, "creation_date": 1527671180, "post_id": 50599043, "comment_id": 88210320, "body": "It turned out to be a problem with &quot;Element&quot; instead of &quot;Elements&quot;. Now I try to change language from default English to Polish. Can I also use &quot;GetElementsByTagName&quot;? I&#39;ve tried objIE.Document.GetElementsByTagName(&quot;BUTTON&quot;)(0).Value = &quot;polskiego&quot; but it neither returns an error nor changes language."}, {"owner": {"reputation": 2031, "user_id": 6097926, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/187bc2674bbdf7651e7137e1427b9bd6?s=128&d=identicon&r=PG&f=1", "display_name": "Ryszard J\u0119draszyk", "link": "https://stackoverflow.com/users/6097926/ryszard-j%c4%99draszyk"}, "reply_to_user": {"reputation": 325, "user_id": 9640782, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/777f5981ccbedfef10d48ccdebc34735?s=128&d=identicon&r=PG&f=1", "display_name": "Arkadiusz", "link": "https://stackoverflow.com/users/9640782/arkadiusz"}, "edited": false, "score": 0, "creation_date": 1527672170, "post_id": 50599043, "comment_id": 88211020, "body": "It&#39;s rather a material for another post, but this button doesn&#39;t have any value. Span element inside it has. Also you can change this text in span manually in browser and then click a button to translate and see what happens - website doesn&#39;t care about value being changed. You must click on dropdown list &lt;a&gt; element."}, {"owner": {"reputation": 325, "user_id": 9640782, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/777f5981ccbedfef10d48ccdebc34735?s=128&d=identicon&r=PG&f=1", "display_name": "Arkadiusz", "link": "https://stackoverflow.com/users/9640782/arkadiusz"}, "edited": false, "score": 0, "creation_date": 1527711187, "post_id": 50599043, "comment_id": 88235324, "body": "Well, to be honest I don&#39;t know how it should look like. I&#39;ve tried several times but I&#39;ve received either an error or no result."}], "tags": [], "owner": {"reputation": 2031, "user_id": 6097926, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/187bc2674bbdf7651e7137e1427b9bd6?s=128&d=identicon&r=PG&f=1", "display_name": "Ryszard J\u0119draszyk", "link": "https://stackoverflow.com/users/6097926/ryszard-j%c4%99draszyk"}, "is_accepted": false, "score": 1, "last_activity_date": 1527756171, "last_edit_date": 1527756171, "creation_date": 1527666259, "answer_id": 50599043, "question_id": 50598496, "link": "https://stackoverflow.com/questions/50598496/searching-websites-using-vba/50599043#50599043", "title": "Searching websites using VBA", "body": "<p>Element with ID \"text-translation-video-ad\" is a DIV which does not have <code>.Value</code> property. You want to access text area which is descendant of mentioned DIV.</p>\n\n<p>There are 2 elements with tag \"textarea\" on page, the one which interests you is 1st element, therefore (0) index. Tags in <code>GetElementsByTagName</code> must be capitalized.</p>\n\n<pre><code>objIE.Document.GetElementsByTagName(\"TEXTAREA\")(0).Value = \"pi\u0142ka\"\n</code></pre>\n\n<p>You can also resign from IE automation and take a faster and more reliable approach, without browser automation, which will give you response in JSON format. Setting reference to Microsoft HTML Object Library is required.</p>\n\n<pre><code>Option Explicit\n\nPublic Sub Scrape()\n\n    Dim WindHttp As Object: Set WindHttp = CreateObject(\"WinHTTP.WinHTTPRequest.5.1\")\n    Dim htmlDoc As New HTMLDocument\n    Dim urlName As String, myWord As String, requestString As String\n    Dim myResults() As String\n    Dim resultNum As Long\n\n    urlName = \"https://pl.pons.com/_translate/translate\"\n    myWord = \"pi\u0142ka\"\n\n    requestString = \"source_language=pl&amp;target_language=en&amp;service=deepl&amp;text=\" &amp; _\n    myWord &amp; _\n    \"&amp;lookup=true&amp;requested_by=Web&amp;source_language_confirmed=true\"\n\n    Set htmlDoc = postDocument(urlName, WindHttp, requestString)\n\n    myResults = Split(Replace(Split(Split(htmlDoc.body.innerText, \",\")(1), \":\")(1), Chr(34), vbNullString), vbCrLf)\n\n    For resultNum = LBound(myResults) To UBound(myResults)\n        Debug.Print myResults(resultNum)\n    Next resultNum\n\nEnd Sub\n\nFunction postDocument(ByVal urlName As String, myRequest As Object, Optional requestString As String) As HTMLDocument\n\n    Set postDocument = New HTMLDocument\n\n    With myRequest\n\n        .Open \"POST\", urlName, False\n        .setRequestHeader \"Cache-Control\", \"no-cache\"\n        .setRequestHeader \"Pragma\", \"no-cache\"\n        .setRequestHeader \"Content-type\", \"application/x-www-form-urlencoded\"\n\n        If requestString = vbNullString Then\n            .send\n        Else\n            .send requestString\n        End If\n\n        postDocument.body.innerHTML = .responseText\n\n    End With\n\nEnd Function\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": false, "score": 4, "last_activity_date": 1527719289, "last_edit_date": 1527719289, "creation_date": 1527666810, "answer_id": 50599203, "question_id": 50598496, "link": "https://stackoverflow.com/questions/50598496/searching-websites-using-vba/50599203#50599203", "title": "Searching websites using VBA", "body": "<p>Without changing any language settings, the following translates \"Hello\"</p>\n\n<p><strong>Code:</strong></p>\n\n<pre><code>Option Explicit\n\nPublic Sub GetInfo()\n    Dim IE As New InternetExplorer, html As HTMLDocument, translation As String\n    Const TRANSLATION_STRING As String = \"Hello\"\n\n    With IE\n        .Visible = True\n        .navigate \"https://pl.pons.com/t%C5%82umaczenie-tekstu\"\n\n        While .Busy Or .readyState &lt; 4: DoEvents: Wend\n\n        Set html = .document\n\n        With html\n            .querySelector(\"textarea.text-translation-source.source\").Value = TRANSLATION_STRING\n            .querySelector(\"button.btn.btn-primary.submit\").Click\n            Application.Wait Now + TimeSerial(0, 0, 3)\n            translation = .querySelector(\"div.translated_text\").innerText\n        End With\n\n        Debug.Print translation\n        'Quit '&lt;== Remember to quit application\n    End With\n\nEnd Sub\n</code></pre>\n\n<p><strong>View:</strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/GaDd3.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/GaDd3.png\" alt=\"Output\"></a></p>\n\n<p><strong>Print out in immediate window:</strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/zHUJn.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/zHUJn.png\" alt=\"Output\"></a></p>\n\n<hr>\n\n<p><strong>Edit:</strong></p>\n\n<p>Late bound version</p>\n\n<pre><code>Option Explicit\n\nPublic Sub GetInfo()\n    Dim IE As Object, html As Object\n\n    With CreateObject(\"InternetExplorer.Application\")\n        .Visible = True\n        .navigate \"https://pl.pons.com/t%C5%82umaczenie-tekstu\"\n\n        While .Busy Or .readyState &lt; 4: DoEvents: Wend\n\n        Set html = CreateObject(\"htmlfile\")\n        Set html = .document\n\n        With html\n\n            .getElementsByClassName(\"text-translation-source source\")(0).innerText = \"Translate\"\n            .getElementsByClassName(\"btn btn-primary submit\")(0).Click\n             Application.Wait Now + TimeSerial(0, 0, 2)\n\n             Dim i As Long\n             For i = 0 To .getElementsByClassName(\"text-translation-target target\").Length - 1\n                 Debug.Print .getElementsByClassName(\"text-translation-target target\")(i).innerText\n             Next i\n\n            Stop\n        End With\n        .Quit\n    End With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 325, "user_id": 9640782, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/777f5981ccbedfef10d48ccdebc34735?s=128&d=identicon&r=PG&f=1", "display_name": "Arkadiusz", "link": "https://stackoverflow.com/users/9640782/arkadiusz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 192, "favorite_count": 2, "answer_count": 2, "score": 0, "last_activity_date": 1557429432, "creation_date": 1527664431, "last_edit_date": 1557429432, "question_id": 50598496, "link": "https://stackoverflow.com/questions/50598496/searching-websites-using-vba", "title": "Searching websites using VBA", "body": "<p>What I would like to do is to search a <a href=\"https://pl.pons.com/t%C5%82umaczenie-tekstu\" rel=\"nofollow noreferrer\">website</a> using VBA, putting some words in the left box and getting results on the right. </p>\n\n<p>The problem is that I don't know HTML and I don't know how to refer to this box. I use <em><code>GetElementByID</code></em> but I received error in line:</p>\n\n<blockquote>\n<pre><code>objIE.Document.GetElementByID(\"text-translation-video-ad\").Value = \"pi\u0142ka\".   \n\"Object doesn't support this property or method\".\n</code></pre>\n</blockquote>\n\n<p>Here's my code:</p>\n\n<pre><code>Sub www()\n\n    Set objIE = CreateObject(\"InternetExplorer.Application\")\n\n    objIE.Top = 0\n    objIE.Left = 0\n    objIE.Width = 800\n    objIE.Height = 600\n    objIE.AddressBar = 0\n    objIE.StatusBar = 0\n    objIE.Toolbar = 0\n    objIE.Visible = True\n    objIE.Navigate (\"https://pl.pons.com/t\u0142umaczenie-tekstu\")\n\n    Do\n        DoEvents\n    Loop Until objIE.ReadyState = 4\n\n    pagesource = objIE.Document.Body.Outerhtml\n    objIE.Document.GetElementByID(\"text-translation-video-ad\").Value = \"pi\u0142ka\"\n    objIE.Document.GetElementByID(\"qKeyboardInputInitiator\").Click\n\n    Do\n        DoEvents\n    Loop Until objIE.ReadyState = 4\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 28228, "user_id": 7132550, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/1063981417044495/picture?type=large", "display_name": "Micha\u0142 Turczyn", "link": "https://stackoverflow.com/users/7132550/micha%c5%82-turczyn"}, "is_accepted": true, "score": 0, "last_activity_date": 1527663989, "creation_date": 1527663989, "answer_id": 50598358, "question_id": 50598308, "link": "https://stackoverflow.com/questions/50598308/vba-how-to-avoid-recusrion-when-using-many-integers/50598358#50598358", "title": "VBA How to avoid recusrion when using many integers", "body": "<p>Set at the beginning: <code>Application.EnableEvents = False</code> and set it to <code>True</code> at the end. Recursion occurs, because you are calling macro on change event of workbook, which also generates this event, thus the method is calling itself, thus recursion.</p>\n"}], "owner": {"reputation": 153, "user_id": 3701825, "user_type": "registered", "profile_image": "https://graph.facebook.com/1670577746/picture?type=large", "display_name": "Hris", "link": "https://stackoverflow.com/users/3701825/hris"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 28, "favorite_count": 0, "accepted_answer_id": 50598358, "answer_count": 1, "score": 0, "last_activity_date": 1527664020, "creation_date": 1527663850, "last_edit_date": 1527664020, "question_id": 50598308, "link": "https://stackoverflow.com/questions/50598308/vba-how-to-avoid-recusrion-when-using-many-integers", "title": "VBA How to avoid recusrion when using many integers", "body": "<p>I am trying to figure out how to avoid the multiple msgboxes which appear when I run my code:</p>\n\n<pre><code>Public Function IsItGood(aWord As Variant) As Boolean\nDim s As String\ns = \"|\"\ntmp = s &amp; aWord &amp; s\npatern = \"\"\n\nFor i = 1 To 100\n    patern = patern &amp; s &amp; i\nNext i\nFor i = 1 To 10\n    patern = patern &amp; s &amp; \"C\" &amp; i\nNext i\npatern = patern &amp; s &amp; \"merge|complete framed|width|border left|border right\" &amp; s\n\nIf InStr(1, patern, tmp) &gt; 0 Then\n    IsItGood = True\nElse\n    IsItGood = False\nEnd If\n\nEnd Function\n</code></pre>\n\n<p>Above is the function which is used in the below worksheet_change:</p>\n\n<pre><code>Sub Worksheet_Change(ByVal Target As Range)\nDim BigS As String\nDim arr As Variant\nDim a As Variant\nIf Intersect(Range(\"G3:G19\"), Target) Is Nothing Then Exit Sub\narr = Split(Target, \" \")\n\n    If IsItGood(a) Then\n    MsgBox (\" In row\" + Target.Address(0, 0)) &amp; vbCrLf &amp; a &amp; vbCrLf + \"are ok\"\n    Else\n        MsgBox Target.Address(0, 0) &amp; vbCrLf &amp; a &amp; vbCrLf &amp; \"has bad stuff\"\n        Application.Undo\n    End If\n\nEnd Sub\n</code></pre>\n\n<p>The first \"for\" loops the 100 integers and the second from C1 to C10 and the msgbox is repeated for each splitted string.Is there a way to prevent the multiple msgboxes so only one msgbox to appear at a time. And also an \"out of stack space\" error  appears because of the recursion.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1527663479, "post_id": 50597985, "comment_id": 88205507, "body": "Can you use a dynamic named range in the sheet and then use that as your list source?"}, {"owner": {"reputation": 6200, "user_id": 7923463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8063a07902a59be5f26d31626600dee?s=128&d=identicon&r=PG&f=1", "display_name": "Kostas K.", "link": "https://stackoverflow.com/users/7923463/kostas-k"}, "edited": false, "score": 0, "creation_date": 1527664228, "post_id": 50597985, "comment_id": 88205887, "body": "Use the <code>IsNull()</code> function to check for null, not <code>&lt;&gt;</code>."}, {"owner": {"reputation": 149, "user_id": 9750254, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Maxim Srour", "link": "https://stackoverflow.com/users/9750254/maxim-srour"}, "edited": false, "score": 0, "creation_date": 1527740548, "post_id": 50597985, "comment_id": 88242987, "body": "The Problem with using <code>IsNull()</code> is that, while it is a better choice for function, it doesn&#39;t fix the issue in which trying to add 2 or more items to the list causes the type mismatch. I ended up using a <code>VarType()</code> method to check whether it was a string or array, and then use an appropriate function to add to the list. I have posted my solution below"}], "answers": [{"tags": [], "owner": {"reputation": 28228, "user_id": 7132550, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/1063981417044495/picture?type=large", "display_name": "Micha\u0142 Turczyn", "link": "https://stackoverflow.com/users/7132550/micha%c5%82-turczyn"}, "is_accepted": false, "score": 1, "last_activity_date": 1527663798, "last_edit_date": 1527663798, "creation_date": 1527663309, "answer_id": 50598144, "question_id": 50597985, "link": "https://stackoverflow.com/questions/50597985/check-if-variant-is-null-or-an-array/50598144#50598144", "title": "Check if variant is Null or an array", "body": "<p>You could try like this:</p>\n\n<pre><code>Dim i As Long\nFor i = LBound(tempj) To UBound(templ)\n    cmb_JobNum.AddItem tempj(i)\nNext\n</code></pre>\n\n<p>This code will loop through your array and add every element in it to the combobox. Thus, if array is empy, then no elelements will be added, when there's >0 elements, then all of them will be added.</p>\n"}, {"comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1527774486, "post_id": 50598452, "comment_id": 88261726, "body": "Any feedback at all?"}, {"owner": {"reputation": 149, "user_id": 9750254, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Maxim Srour", "link": "https://stackoverflow.com/users/9750254/maxim-srour"}, "edited": false, "score": 0, "creation_date": 1527828097, "post_id": 50598452, "comment_id": 88282268, "body": "Unfortunately your method didn&#39;t work for me either. I did end up being able to get it working and posted an answer. Thanks for the help though"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 149, "user_id": 9750254, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Maxim Srour", "link": "https://stackoverflow.com/users/9750254/maxim-srour"}, "edited": false, "score": 0, "creation_date": 1527831273, "post_id": 50598452, "comment_id": 88283235, "body": "Well done on figuring out a solution. Regarding mine:  I had throught you didn&#39;t know whether you would have one item or several (passed in as an array) from the sheet. What about the above doesn&#39;t work please so I can update the answer for future readers?"}, {"owner": {"reputation": 149, "user_id": 9750254, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Maxim Srour", "link": "https://stackoverflow.com/users/9750254/maxim-srour"}, "edited": false, "score": 0, "creation_date": 1528064672, "post_id": 50598452, "comment_id": 88352737, "body": "Well the way my solution works is by checking what type of variable it is, and then assigning the list based on that, so that way a single value or an array can be added without throwing an error. With your solution, I couldn&#39;t quite figure out how to get it working entirely in a userform"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 149, "user_id": 9750254, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Maxim Srour", "link": "https://stackoverflow.com/users/9750254/maxim-srour"}, "edited": false, "score": 0, "creation_date": 1528093700, "post_id": 50598452, "comment_id": 88358641, "body": "Ok. Thanks for getting back to me :-)"}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": false, "score": 1, "last_activity_date": 1528094317, "last_edit_date": 1528094317, "creation_date": 1527664282, "answer_id": 50598452, "question_id": 50597985, "link": "https://stackoverflow.com/questions/50597985/check-if-variant-is-null-or-an-array/50598452#50598452", "title": "Check if variant is Null or an array", "body": "<p>Here is an example using a dynamic named range to set the fill</p>\n\n<pre><code>Option Explicit\n\nPublic Sub test()\n\n    With ThisWorkbook.Worksheets(\"Sheet6\") '&lt;== change as appropriate\n        .ComboBox1.ListFillRange = .Range(\"dynRange\").Address\n    End With\n\nEnd Sub\n</code></pre>\n\n<p><code>dynRange</code> formula added via name manager (Ctrl + F3)</p>\n\n<pre><code>=OFFSET(Sheet6!$A$3,0,0,COUNTA(Sheet6!$A:$A),1)\n</code></pre>\n\n<hr>\n\n<p><strong>Using a worksheet change event to automatically update the combobox:</strong></p>\n\n<p>You could tie this into a Worksheet_Change event on the range A3:A9999 to update automatically the Combobox.</p>\n\n<p>If tying to an event in the code pane of the sheet containing the combobox you could have the following:</p>\n\n<pre><code>Option Explicit\n\nPrivate Sub Worksheet_Change(ByVal Target As Range)\n    If Not Intersect(Target, Range(\"A3:A9999\")) Is Nothing Then\n        Application.EnableEvents = False\n        Me.ComboBox1.ListFillRange = ThisWorkbook.Worksheets(\"Sheet6\").Range(\"dynRange\").Address\n        Application.EnableEvents = True\n    End If\nEnd Sub\n</code></pre>\n\n<p><strong>Example code run:</strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/r3kDh.gif\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/r3kDh.gif\" alt=\"Test run\"></a></p>\n\n<p><strong>Code pane for sheet containing Combobox:</strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/UEJiz.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/UEJiz.png\" alt=\"Code pane\"></a></p>\n\n<hr>\n\n<p><strong>Note:</strong></p>\n\n<p>This is assuming an ActiveX combobox but can easily be update for a Form Control ComboBox.</p>\n\n<p>For a form control swop out lines and use:</p>\n\n<pre><code> With Shapes(\"Drop Down 2\").ControlFormat '&lt;== change to appropriate name\n     .ListFillRange = ThisWorkbook.Worksheets(\"Sheet6\").Range(\"dynRange\").Address\n End With\n</code></pre>\n\n<p>Edit: For UserForm combobox you can populate in the initialize e.g.</p>\n\n<pre><code>Private Sub UserForm_Initialize()\n    cb1.RowSource = Sheet1.Range(\"dynRange\").Address\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 149, "user_id": 9750254, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Maxim Srour", "link": "https://stackoverflow.com/users/9750254/maxim-srour"}, "is_accepted": true, "score": 0, "last_activity_date": 1527740519, "creation_date": 1527740519, "answer_id": 50616603, "question_id": 50597985, "link": "https://stackoverflow.com/questions/50597985/check-if-variant-is-null-or-an-array/50616603#50616603", "title": "Check if variant is Null or an array", "body": "<p>Figured it out</p>\n\n<pre><code>If VarType(tempj) &lt;&gt; 0 Then\n    If VarType(tempj) = 8 Then\n        cmb_JobNum.AddItem tempj\n    Else\n        cmb_JobNum.List = tempj\n    End If\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 149, "user_id": 9750254, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Maxim Srour", "link": "https://stackoverflow.com/users/9750254/maxim-srour"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1150, "favorite_count": 0, "accepted_answer_id": 50616603, "answer_count": 3, "score": 0, "last_activity_date": 1528094317, "creation_date": 1527662787, "last_edit_date": 1527740663, "question_id": 50597985, "link": "https://stackoverflow.com/questions/50597985/check-if-variant-is-null-or-an-array", "title": "Check if variant is Null or an array", "body": "<p>I have a dynamic range that is being used to set a combobox in vba.</p>\n\n<p>The range starts as <code>A3</code> (which will contain nothing to start) and goes all the way to <code>A3:A9999</code>, depending on how many elements are in the range.</p>\n\n<p>The code then pulls in the data from the range and stores it in a local variant.</p>\n\n<p>My code in VBA is this:</p>\n\n<pre><code>If tempj &lt;&gt; Null Then\n    cmb_JobNum.List = tempj\nEnd If\n</code></pre>\n\n<p>When there are 0 elements in the array, <code>tempj = Null</code>, so it does not attempt to set the list.</p>\n\n<p>When there is 1 element in the array, <code>tempj =  [Value of cell]</code>, so it will set the list to that single element.</p>\n\n<p>When there is 2 or more elements in the array, <code>tempj</code> is now an array, so trying to equate it to a single element throws a 'type mismatch' error. I have no clue how to update the code so that it doesn't get caught out by that error, since every time that equate is run it will crash.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 2, "creation_date": 1527661984, "post_id": 50597641, "comment_id": 88204655, "body": "Formulas shouldn&#39;t be the problem. Overwriting seems like being the problem. If you don&#39;t want to overwrite cells with formulas add a test that the cell being written to doesn&#39;t have a formula with HasFormula or Left(cell.value,1) = &quot;=&quot;"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1527662178, "post_id": 50597641, "comment_id": 88204739, "body": "You are also copying an entire row so are you expecting to test whether any cell within the destination row has a formula?"}, {"owner": {"reputation": 361, "user_id": 5775203, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/546d8322a7df2c44d8c551fee3d000ef?s=128&d=identicon&r=PG&f=1", "display_name": "geek2000", "link": "https://stackoverflow.com/users/5775203/geek2000"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1527662581, "post_id": 50597641, "comment_id": 88204963, "body": "Sheet2 is always empty, only contains a bunch of formulas. It is supposed to act like a calculator. It gets input and produces output, and then get cleaned for the new set of values. I want the formulas to stay there. But the code removes formulas."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1527662678, "post_id": 50597641, "comment_id": 88205013, "body": "1) Sheet 2 is therefore not empty (sorry to be pedantic) 2) Why not simply choose to output to a different range where there are no formulas?"}, {"owner": {"reputation": 361, "user_id": 5775203, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/546d8322a7df2c44d8c551fee3d000ef?s=128&d=identicon&r=PG&f=1", "display_name": "geek2000", "link": "https://stackoverflow.com/users/5775203/geek2000"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1527662966, "post_id": 50597641, "comment_id": 88205180, "body": "1) Sorry I meant there are no values in it, only formulas. 2) It just doesn&#39;t look very professional if it jumps to some random place. ;-) I want everything to be in-place. But if there is no way to do it... I should go with your suggestion."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1527663158, "post_id": 50597641, "comment_id": 88205317, "body": "I guess I am finding it hard to visualise your data and desired outcome. That is where providing examples pays dividends. You have formulas - where do those formula point to, to perform their calculations? It shouldn&#39;t be that difficult to work with only used ranges (not entire rows) and output to the side of the formulas (left or right - which ever suits). Just make sure formulas reference new position. And thinking about it....if doing this, why don&#39;t the formulas simply point at the other sheet and avoid copying altogether? It feels like, I don&#39;t know, this could be  a design question."}, {"owner": {"reputation": 361, "user_id": 5775203, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/546d8322a7df2c44d8c551fee3d000ef?s=128&d=identicon&r=PG&f=1", "display_name": "geek2000", "link": "https://stackoverflow.com/users/5775203/geek2000"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1527663880, "post_id": 50597641, "comment_id": 88205700, "body": "You are right! I will provide some examples to make the problem more clear. But it&#39;s too late here... will do it tomorrow! :-)"}, {"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1527673668, "post_id": 50597641, "comment_id": 88212123, "body": "You are copy pasting raw values into cells which contain a formula and expect the formula to still be there after doing so? Not possible and sounds strange, unless you want to loop through each cell in a row and paste cells individually and check for the existence of a formula beforehand. I&#39;ll add an answer below."}], "answers": [{"comments": [{"owner": {"reputation": 361, "user_id": 5775203, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/546d8322a7df2c44d8c551fee3d000ef?s=128&d=identicon&r=PG&f=1", "display_name": "geek2000", "link": "https://stackoverflow.com/users/5775203/geek2000"}, "edited": false, "score": 0, "creation_date": 1527728185, "post_id": 50602052, "comment_id": 88240330, "body": "Thanks. I might go with a combination of your code and @QHarr suggestion. That should put me on the right direction to find the solution."}], "tags": [], "owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "is_accepted": false, "score": 1, "last_activity_date": 1527675167, "creation_date": 1527675167, "answer_id": 50602052, "question_id": 50597641, "link": "https://stackoverflow.com/questions/50597641/copy-values-to-a-sheet-containing-formulas-without-formulas-being-removed/50602052#50602052", "title": "Copy values to a sheet containing formulas without formulas being removed", "body": "<p>This code will not copypaste the whole row but will loop through each cell in your row on the raw data and only copypaste the value when in the same cell on your other sheet no formula excists:</p>\n\n<pre><code>Sub TestForFormula()\n\nDim X As Long\nDim CL As Range, RNG As Range\n\nFor X = 2 To Sheets(1).Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n    Set RNG = ActiveSheet.Range(Cells(X, 1), Cells(X, ActiveSheet.Cells(X, Columns.Count).End(xlToLeft).Column))\n    For Each CL In RNG\n        If Sheets(2).Cells(X, CL.Column).HasFormula = False Then\n            Sheets(2).Cells(X, CL.Column).Value = Sheets(1).Cells(X, CL.Column).Value\n        End If\n    Next CL\nNext X\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 361, "user_id": 5775203, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/546d8322a7df2c44d8c551fee3d000ef?s=128&d=identicon&r=PG&f=1", "display_name": "geek2000", "link": "https://stackoverflow.com/users/5775203/geek2000"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 71, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1527675167, "creation_date": 1527661519, "last_edit_date": 1527661962, "question_id": 50597641, "link": "https://stackoverflow.com/questions/50597641/copy-values-to-a-sheet-containing-formulas-without-formulas-being-removed", "title": "Copy values to a sheet containing formulas without formulas being removed", "body": "<p>I have two Worksheets: Sheet1 and Sheet2. Sheet1 has raw data (without any formulas), Sheet2 has formulas in some cells. Is it possible to copy values from Sheet1 to Sheet2 without formulas being removed from Sheet2?  </p>\n\n<p>I am using the following code to copy values from sheet1 to sheet2. After values are copied, formulas in Sheet2 get removed. </p>\n\n<pre><code>i = 2\n\nWith Sheets(1)\n   'loop column A \n   For Each Cell In .Range(\"A2:A\" &amp; .Cells(.Rows.Count, \"A\").End(xlUp).Row)\n      .Rows(Cell.Row).Copy Destination:=Sheets(2).Range(\"A\" &amp; i)\n      i = i + 1\n   Next Cell\nEnd With\n</code></pre>\n"}, {"tags": ["vba", "ms-word", "cross-reference", "numbered-list"], "comments": [{"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 2, "creation_date": 1527703077, "post_id": 50597203, "comment_id": 88231577, "body": "No, there&#39;s nothing like that. But you could cut down the overhead by iterating throught Document.ListParagraphs, which would leave out unnumbered paragraphs. Or convert all numbering to text so that you can use Find, set a bookmark, then Undo the conversion."}, {"owner": {"reputation": 15409, "user_id": 2877364, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0a101160e41fd7fd75f5fc701f8acb1c?s=128&d=identicon&r=PG", "display_name": "cxw", "link": "https://stackoverflow.com/users/2877364/cxw"}, "edited": false, "score": 0, "creation_date": 1527772717, "post_id": 50597203, "comment_id": 88260525, "body": "I think this might be an XY problem.  Why do you want to do this?  From your question, I think you are trying to autonumber references in dependent claims to parent claims.  Right?  Or are you working on FIG. numbers, part numbers, or table numbers?  (Or several of those?)  In general, I have had more success bookmarking things I want to refer to, and using cross references to the bookmarks, than I have had referring to autonumbers.  (And a hyperlinked reference to a paragraph is just a reference to a hidden bookmark anyway.)"}, {"owner": {"reputation": 167, "user_id": 3643213, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ea0b0b60c78db492442f4eb630c9c7bd?s=128&d=identicon&r=PG", "display_name": "PatentWookiee", "link": "https://stackoverflow.com/users/3643213/patentwookiee"}, "reply_to_user": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1532378759, "post_id": 50597203, "comment_id": 89942968, "body": "@CindyMeister most of the paragraphs in the document are numbered. The numbering format is different for the two different styles, but the referenceitem property ignores the difference and simply numbers all list formatted paragraphs sequentially. Converting to text, using find, setting a bookmark, and then undoing the conversion could work in theory, though it seems like it might be &quot;heavy&quot; to run."}, {"owner": {"reputation": 167, "user_id": 3643213, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ea0b0b60c78db492442f4eb630c9c7bd?s=128&d=identicon&r=PG", "display_name": "PatentWookiee", "link": "https://stackoverflow.com/users/3643213/patentwookiee"}, "reply_to_user": {"reputation": 15409, "user_id": 2877364, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0a101160e41fd7fd75f5fc701f8acb1c?s=128&d=identicon&r=PG", "display_name": "cxw", "link": "https://stackoverflow.com/users/2877364/cxw"}, "edited": false, "score": 0, "creation_date": 1532380089, "post_id": 50597203, "comment_id": 89943518, "body": "@cxw You are correct; I want auto-updating cross references to parent claims. But I don&#39;t want to have to manually add bookmarks to all of the claims, as that would be almost as cumbersome as manually adding a cross reference to the numbered item. I want to type &quot;the apparatus of claim 10&quot;, backselect &quot;claim 10&quot;, hit my macro keystroke, and make the &quot;10&quot; an auto-updating field, so that if I insert claims before claim 10 I don&#39;t have to manually renumber. I just ctrl+A and f9 to update all fields. I don&#39;t care so much about the hyperlinking as the auto-updating, but they go hand-in-hand."}, {"owner": {"reputation": 15409, "user_id": 2877364, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0a101160e41fd7fd75f5fc701f8acb1c?s=128&d=identicon&r=PG", "display_name": "cxw", "link": "https://stackoverflow.com/users/2877364/cxw"}, "edited": false, "score": 0, "creation_date": 1532440525, "post_id": 50597203, "comment_id": 89969156, "body": "PatentWookiee, we should talk shop about our common interests sometime :) .  I think I left you some obfuscated contact information in a comment on a different question (you know how to de-obfuscate it).  If not, do you have a public key that I can use to send you the info?"}, {"owner": {"reputation": 167, "user_id": 3643213, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ea0b0b60c78db492442f4eb630c9c7bd?s=128&d=identicon&r=PG", "display_name": "PatentWookiee", "link": "https://stackoverflow.com/users/3643213/patentwookiee"}, "reply_to_user": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 1, "creation_date": 1535061031, "post_id": 50597203, "comment_id": 90939161, "body": "@CindyMeister I will accept as your answer, if you want to post it, that there is no inverse method to return a Paragraph from its .Range.ListFormat.ListString property, but that a solution for my specific situation is to count the number n of Paragraphs listPara in Document.ListParagraphs with the numbering style [0001] etc. (I tested each listPara.ListFormat.ListString against a regular expression), and to substitute n+&lt;user-entered number&gt; for &lt;user-entered number&gt; in my posted code to insert the desired cross-reference. It works as I intended now."}], "owner": {"reputation": 167, "user_id": 3643213, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ea0b0b60c78db492442f4eb630c9c7bd?s=128&d=identicon&r=PG", "display_name": "PatentWookiee", "link": "https://stackoverflow.com/users/3643213/patentwookiee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 653, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1593731135, "creation_date": 1527659496, "last_edit_date": 1593731135, "question_id": 50597203, "link": "https://stackoverflow.com/questions/50597203/in-ms-word-vba-method-to-insert-cross-reference-to-the-number-of-a-numbered-ite", "title": "In MS Word VBA, method to insert cross reference to the number of a numbered item using the number as it appears", "body": "<p>I have the following code to insert an updating, hyperlinked cross-reference in place of a user-typed plain text number referring to a previous list item:</p>\n\n<pre><code>Selection.InsertCrossReference referencetype:=\"Numbered item\", _\nreferencekind:=wdNumberNoContext, referenceitem:=&lt;user-entered number&gt;, \nInsertAsHyperlink:=True \n</code></pre>\n\n<p>I deal with documents with multiple numbered lists of different formatting, and the trouble is that if the user typed the number 5, the cross reference inserted will be to the 5th numbered item in the entire document, which may be a paragraph numbered \"[0005]\" instead of the user-intended list item numbered \"5.\", which appears much later in the document. I know it is possible to extract the list heading number as it appears for a given numbered item -- it is the ListString property of a ListFormat object; for example, <code>Selection.Range.ListFormat.ListString</code> will return the number as it appears for the selected paragraph. </p>\n\n<p>But does this method have an inverse that will return a numbered item given its heading number as it appears, without having to explicitly iterate through paragraphs and extract the ListString property of each paragraph that is a ListFormat object until a match is found?</p>\n"}, {"tags": ["sql", "ms-access", "vba"], "comments": [{"owner": {"reputation": 381813, "user_id": 1863229, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/4sh1l.png?s=128&g=1", "display_name": "Tim Biegeleisen", "link": "https://stackoverflow.com/users/1863229/tim-biegeleisen"}, "edited": false, "score": 0, "creation_date": 1527658401, "post_id": 50596932, "comment_id": 88203024, "body": "Are you sure that the exact query above gives this error?  It looks correct to me.  The only thing I can imagine which might be causing problems is your total lacks of aliases.  But, aliases should be optional, I think."}, {"owner": {"reputation": 190, "user_id": 6470856, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233040228f8c0d6835a84530ac6113c6?s=128&d=identicon&r=PG&f=1", "display_name": "BData", "link": "https://stackoverflow.com/users/6470856/bdata"}, "edited": false, "score": 0, "creation_date": 1527665834, "post_id": 50596932, "comment_id": 88206930, "body": "Is it local data or linked data?"}, {"owner": {"reputation": 1438, "user_id": 7381844, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/472a02745987037a063febc591fbb937?s=128&d=identicon&r=PG&f=1", "display_name": "jBuchholz", "link": "https://stackoverflow.com/users/7381844/jbuchholz"}, "edited": false, "score": 0, "creation_date": 1527674205, "post_id": 50596932, "comment_id": 88212491, "body": "According to this: [link](    <a href=\"https://social.msdn.microsoft.com/Forums/office/en-US/15c36745-f7a4-4926-9687-7161e5894468/join-expression-not-supported-error-caused-by-unbracketed-join-expression-comprising-string?forum=accessdev\" rel=\"nofollow noreferrer\">social.msdn.microsoft.com/Forums/office/en-US/&hellip;</a>) it might be some missing brackets around the JOIN expressions.  But: in your example you join <code>A_01HWeekEHCalendar.Audit_Product = A_ProductGroup.R_Code</code> and in the next join <code>A_ProductGroup.R_Code = A00_Plant.Plant_Product</code> Which means you could just join <code>A_01HWeekEHCalendar.Audit_Product = A00_Plant.Plant_Product</code> and you don&#39;t need to use the third table."}, {"owner": {"reputation": 39, "user_id": 6713041, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ef9c1b774757b79afdf418ad09d1185?s=128&d=identicon&r=PG&f=1", "display_name": "Warawut Nualplaud", "link": "https://stackoverflow.com/users/6713041/warawut-nualplaud"}, "reply_to_user": {"reputation": 190, "user_id": 6470856, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233040228f8c0d6835a84530ac6113c6?s=128&d=identicon&r=PG&f=1", "display_name": "BData", "link": "https://stackoverflow.com/users/6470856/bdata"}, "edited": false, "score": 0, "creation_date": 1527677211, "post_id": 50596932, "comment_id": 88214435, "body": "@BData thanks. it&#39;s local data."}, {"owner": {"reputation": 39, "user_id": 6713041, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ef9c1b774757b79afdf418ad09d1185?s=128&d=identicon&r=PG&f=1", "display_name": "Warawut Nualplaud", "link": "https://stackoverflow.com/users/6713041/warawut-nualplaud"}, "reply_to_user": {"reputation": 1438, "user_id": 7381844, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/472a02745987037a063febc591fbb937?s=128&d=identicon&r=PG&f=1", "display_name": "jBuchholz", "link": "https://stackoverflow.com/users/7381844/jbuchholz"}, "edited": false, "score": 0, "creation_date": 1527677368, "post_id": 50596932, "comment_id": 88214552, "body": "@JanB A_01HWeekEHCalendar.Audit_Product and A00_Plant.Plant_Product are not matching to each other. i have to add  A_ProductGroup  and that cause the problem."}, {"owner": {"reputation": 39, "user_id": 6713041, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ef9c1b774757b79afdf418ad09d1185?s=128&d=identicon&r=PG&f=1", "display_name": "Warawut Nualplaud", "link": "https://stackoverflow.com/users/6713041/warawut-nualplaud"}, "reply_to_user": {"reputation": 381813, "user_id": 1863229, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/4sh1l.png?s=128&g=1", "display_name": "Tim Biegeleisen", "link": "https://stackoverflow.com/users/1863229/tim-biegeleisen"}, "edited": false, "score": 0, "creation_date": 1527677989, "post_id": 50596932, "comment_id": 88214943, "body": "@TimBiegeleisen I think so. but if i change LEFT JOIN  to INNER JOIN for both of them, it works."}], "answers": [{"tags": [], "owner": {"reputation": 1106495, "user_id": 1144035, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e514b017977ebf742a418cac697d8996?s=128&d=identicon&r=PG", "display_name": "Gordon Linoff", "link": "https://stackoverflow.com/users/1144035/gordon-linoff"}, "is_accepted": true, "score": 2, "last_activity_date": 1527680891, "creation_date": 1527680891, "answer_id": 50603899, "question_id": 50596932, "link": "https://stackoverflow.com/questions/50596932/join-expression-not-supported-with-3-tables/50603899#50603899", "title": "JOIN EXPRESSION NOT SUPPORTED with 3 tables", "body": "<p>You are lucky because you want only one column.  You can work around this problem using a correlated subquery:</p>\n\n<pre><code>SELECT . . .,\n       (SELECT TOP (1) A00_Plant.HCA_StartDate\n        FROM A00_Plant\n        WHERE A_01HWeekEHCalendar.Audit_plantname = A00_Plant.Plant_Name \n AND\n              A_01HWeekEHCalendar.Audit_Plant = A00_Plant.Plant_Code AND \n              A_ProductGroup.R_Code = A00_Plant.Plant_Product\n       ) as HCA_StartDate\nFROM A_01HWeekEHCalendar LEFT JOIN\n     A_ProductGroup\n     ON A_01HWeekEHCalendar.Audit_Product = A_ProductGroup.R_Code ;\n</code></pre>\n"}], "owner": {"reputation": 39, "user_id": 6713041, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ef9c1b774757b79afdf418ad09d1185?s=128&d=identicon&r=PG&f=1", "display_name": "Warawut Nualplaud", "link": "https://stackoverflow.com/users/6713041/warawut-nualplaud"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 46, "favorite_count": 1, "accepted_answer_id": 50603899, "answer_count": 1, "score": 2, "last_activity_date": 1527680891, "creation_date": 1527658128, "last_edit_date": 1527658281, "question_id": 50596932, "link": "https://stackoverflow.com/questions/50596932/join-expression-not-supported-with-3-tables", "title": "JOIN EXPRESSION NOT SUPPORTED with 3 tables", "body": "<p>I'm working with MS Access, trying to join 3 tables together. But i'm getting message \"JOIN EXPRESSION NOT SUPPORTED.\".\n  Basically I want to join just 2 tables which are A_01HWeekEHCalendar and A00_Plant. A00_Plant requires 3 column to join; Plant_Product, Plant_Code, and Plant_Name. Plant_Product, Plant_Code is ok, but there is no column to match Plant_Product. so I have to add A_ProductGroup\n  I'm not sure if it can't be done in one Query or it's error from my SYNTAX. or there will be another way to do that without separate Queries.\n  I also add a picture of what I want and try to run and get error.</p>\n\n<p>Thanks.</p>\n\n<p><a href=\"https://i.stack.imgur.com/NITVL.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/NITVL.png\" alt=\"enter image description here\"></a></p>\n\n<pre><code>SELECT \nA_01HWeekEHCalendar.RunNo_H, \nA_01HWeekEHCalendar.Audit_Week, \nA_01HWeekEHCalendar.CurrentYear, \nA_01HWeekEHCalendar.CurrentWeek, \nA_01HWeekEHCalendar.TTSMonth, \nA_01HWeekEHCalendar.Audit_Plant, \nA_01HWeekEHCalendar.Audit_plantname, \nA_01HWeekEHCalendar.Audit_Qacode, \nA_01HWeekEHCalendar.Audit_Qaname, \nA_01HWeekEHCalendar.Audit_Product, \nA00_Plant.HCA_StartDate\n\n\nFROM \n(A_01HWeekEHCalendar LEFT JOIN A_ProductGroup\nON A_01HWeekEHCalendar.Audit_Product = A_ProductGroup.R_Code) \nLEFT JOIN A00_Plant \nON A_01HWeekEHCalendar.Audit_plantname = A00_Plant.Plant_Name \nAND A_01HWeekEHCalendar.Audit_Plant = A00_Plant.Plant_Code \nAND A_ProductGroup.R_Code = A00_Plant.Plant_Product;\n</code></pre>\n"}, {"tags": ["vba", "excel", "vbscript"], "comments": [{"owner": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "edited": false, "score": 3, "creation_date": 1527652353, "post_id": 50595916, "comment_id": 88201353, "body": "Try <code>returnValue = excelOBJ.Run(&quot;&#39;Variable.xlsm&#39;!.getNum&quot;)</code>"}, {"owner": {"reputation": 23, "user_id": 9867577, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/784b766b4cc272dd267329b12ee978cd?s=128&d=identicon&r=PG&f=1", "display_name": "Nick K", "link": "https://stackoverflow.com/users/9867577/nick-k"}, "reply_to_user": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "edited": false, "score": 0, "creation_date": 1527686960, "post_id": 50595916, "comment_id": 88221369, "body": "Thanks, @PatricK. I tried changing the code as you described, but received the error &quot;Cannot run the macro &#39;&#39;variable.xlsm&#39;!.getNum&#39;. The macro may not be available in this workbook or all macros may be disabled.&quot;  Code:  800A03EC. after the first 2 Wscript.Echo windows. I verified that macros were enabled in the Excel spreadsheet, but still encounter the error"}, {"owner": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "edited": false, "score": 0, "creation_date": 1527691401, "post_id": 50595916, "comment_id": 88224759, "body": "Is your macro in the Worksheet or in a Module? You might need to reference the Sheet name explicitly if the macro is not in a module."}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 9867577, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/784b766b4cc272dd267329b12ee978cd?s=128&d=identicon&r=PG&f=1", "display_name": "Nick K", "link": "https://stackoverflow.com/users/9867577/nick-k"}, "edited": false, "score": 1, "creation_date": 1527694259, "post_id": 50607836, "comment_id": 88226725, "body": "Thank you @dbmitch - I was hoping for a simple solution and this seems to be it. Before, the code was in &quot;VBA Project (Variable.xlsm) &gt; Microsoft Excel Objects &gt; This Workbook&quot;.  After creating a Module (&quot;VBA Project (Variable.xlsm) &gt; Modules &gt; Module1&quot;), placing the code in the Module, and changing the &quot;Run&quot; argument to &quot;Module1.getNum&quot;, it runs properly. The value 1 and TypeName of Integer are returned and displayed. Thank you!"}], "tags": [], "owner": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "is_accepted": true, "score": 3, "last_activity_date": 1527692241, "creation_date": 1527692241, "answer_id": 50607836, "question_id": 50595916, "link": "https://stackoverflow.com/questions/50595916/getting-value-in-vbscript-from-vba-excel-macro-function/50607836#50607836", "title": "Getting value in VBscript from VBA Excel Macro Function", "body": "<p>I'd recommend moving your code to a module if not there already.</p>\n\n<p>This code should be changed</p>\n\n<pre><code>returnValue = excelOBJ.Run(\"ThisWorkbook.getNum\")\n</code></pre>\n\n<p>If code is in a worksheet, this might work assuming your Worksheet is \"Sheet1\"</p>\n\n<pre><code>returnValue = excelOBJ.Run(\"Sheet1.getNum\")\n</code></pre>\n\n<p>Otherwise if it's in a Module, simply use module name</p>\n\n<pre><code>returnValue = excelOBJ.Run(\"Module1.getNum\")\n</code></pre>\n\n<p>If it starts running with this change but you're not getting anything returned you can change your function to pass <code>return value parameter ByRef</code> and check it that way</p>\n"}], "owner": {"reputation": 23, "user_id": 9867577, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/784b766b4cc272dd267329b12ee978cd?s=128&d=identicon&r=PG&f=1", "display_name": "Nick K", "link": "https://stackoverflow.com/users/9867577/nick-k"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1343, "favorite_count": 0, "accepted_answer_id": 50607836, "answer_count": 1, "score": 2, "last_activity_date": 1527692241, "creation_date": 1527650644, "question_id": 50595916, "link": "https://stackoverflow.com/questions/50595916/getting-value-in-vbscript-from-vba-excel-macro-function", "title": "Getting value in VBscript from VBA Excel Macro Function", "body": "<p>Fairly new to VBscript and VBA... hoping for some help and that it's an easy answer...</p>\n\n<p>I'm calling a Macro / Function in Excel VBA from VBscript. The call to the Function should return a number. Using VBA debug in Excel, the function appears to work properly (in this example, it displays a value of 1), but when I call the Macro / Function and attempt to echo the value in VBscript it shows as \"Empty\".  </p>\n\n<p>How can I get the value from VBA back to VBscript?<br>\nThanks for your help</p>\n\n<p>Example of VBscript code:</p>\n\n<pre><code>Set excelOBJ = CreateObject(\"Excel.Application\")\nSet workbookOBJ = excelOBJ.Workbooks.Open(\"C:\\variable.xlsm\")\n\nexcelOBJ.Application.Visible = True\nexcelOBJ.DisplayAlerts = False\n\nREM mostly for testing purposes\n    Dim returnValue\n    returnValue = 10\n\n    Wscript.Echo \"'returnValue' value before call to macro function = \" &amp; returnValue\n    Wscript.Echo \"'returnValue' TypeName before call to macro function = \" &amp; TypeName(returnValue)\n\nreturnValue = excelOBJ.Run(\"ThisWorkbook.getNum\")\n\n    Wscript.Echo \"'returnValue' value after call to macro function = \" &amp; returnValue\n    Wscript.Echo \"'returnValue' TypeName after call to macro function = \" &amp; TypeName(returnValue)\n\nexcelOBJ.quit\n</code></pre>\n\n<p>Example of VBA in Excel:  </p>\n\n<pre><code>Public Function getNum()\n    getNum = 1\n    Debug.Print \"getNum value = \" &amp; getNum\nEnd Function\n</code></pre>\n\n<p>Output:  </p>\n\n<pre><code>'returnValue' value before call to macro function = 10\n'returnValue' TypeName before call to macro function = Integer\n\nREM Inside Excel VBA editor\n    getNum value = 1\n\n'returnValue' value after call to macro function = \n'returnValue' TypeName after call to macro function = Empty\n</code></pre>\n"}, {"tags": ["vba", "excel", "userform"], "comments": [{"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 1, "creation_date": 1527648759, "post_id": 50595442, "comment_id": 88200526, "body": "So your question is &quot;how to copy data from a userform to a worksheet?&quot; or is there something else you&#39;re asking? What part of this is your code getting done, which part are you stuck on, and what have you tried?  (See also, &quot;<a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a>&quot; as well as &quot;<a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>&quot;.)"}, {"owner": {"reputation": 47, "user_id": 6500122, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/0c0ce4bbbd979de5044576cab35fb3f5?s=128&d=identicon&r=PG&f=1", "display_name": "Avi22", "link": "https://stackoverflow.com/users/6500122/avi22"}, "reply_to_user": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1527750513, "post_id": 50595442, "comment_id": 88246834, "body": "The code I wrote is working on regular Macro.. I want to edit it to Userform option with two different bottoms of &quot;Start time&quot;, &quot;End time&quot; and than run it (each button should be able to get date value from the user like &quot;b2&quot; &amp; &quot;b3&quot; cells in my code."}], "answers": [{"comments": [{"owner": {"reputation": 47, "user_id": 6500122, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/0c0ce4bbbd979de5044576cab35fb3f5?s=128&d=identicon&r=PG&f=1", "display_name": "Avi22", "link": "https://stackoverflow.com/users/6500122/avi22"}, "edited": false, "score": 0, "creation_date": 1527750549, "post_id": 50600132, "comment_id": 88246852, "body": "thanks but I have no idea how to edit it to userform view."}], "tags": [], "owner": {"reputation": 1444, "user_id": 9122140, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6207fe125b0cbaefce70e98e5ce2c6f?s=128&d=identicon&r=PG&f=1", "display_name": "AcsErno", "link": "https://stackoverflow.com/users/9122140/acserno"}, "is_accepted": false, "score": 0, "last_activity_date": 1527669686, "creation_date": 1527669686, "answer_id": 50600132, "question_id": 50595442, "link": "https://stackoverflow.com/questions/50595442/userform-how-to-add-date-filter-range/50600132#50600132", "title": "Userform, how to add date filter range", "body": "<p>For copying paste buffer to a new file, add a new file (instead of a sheet): </p>\n\n<pre><code>Set fNew = = Workbooks.Add(xlWBATWorksheet)\n ...\nfNew.SaveAs Filename:=&lt;file specification&gt;\n</code></pre>\n\n<p><code>Paste:=xlPasteValues</code> literally copies values without any formatting, comments, borders, etc. For keeping source format, simply use <code>ActiveSheet.Paste Destination:=Range(\"A1\")</code>. If - for any reason - it does not work, you can try this:</p>\n\n<pre><code>.Range(\"A1\").PasteSpecial Paste:=xlPasteAllUsingSourceTheme, Operation:=xlNone, SkipBlanks:=False, Transpose:=False\n.Range(\"A1\").PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=False\n</code></pre>\n\n<p>For copying only the filtered rows, use this: </p>\n\n<pre><code>Range(\"A1:S3000\").SpecialCells(xlCellTypeVisible).Copy\nfNew.Sheets(1).Range(\"A1\").PasteSpecial\n</code></pre>\n"}], "owner": {"reputation": 47, "user_id": 6500122, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/0c0ce4bbbd979de5044576cab35fb3f5?s=128&d=identicon&r=PG&f=1", "display_name": "Avi22", "link": "https://stackoverflow.com/users/6500122/avi22"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 266, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1527669686, "creation_date": 1527646430, "last_edit_date": 1531164843, "question_id": 50595442, "link": "https://stackoverflow.com/questions/50595442/userform-how-to-add-date-filter-range", "title": "Userform, how to add date filter range", "body": "<p>I wish to use Userform option for date filters, user will enter \"start time\" &amp; \"end time\" and all relevant data will be displayed according to this filter.</p>\n\n<p>I used local Macro that use two different cells for data input but file view is bad and this is the reason I want to use Useform option.</p>\n\n<p>My code:</p>\n\n<pre><code>Public Sub MyFilter()\n    Dim lngStart As Date, lngEnd As Date\n    lngStart = Range(\"b2\").Value 'assume this is the start date\n    lngEnd = Range(\"b3\").Value 'assume this is the end date\n    Range(\"q:q\").AutoFilter Field:=1, _\n        Criteria1:=\"&gt;=\" &amp; lngStart, _\n        Operator:=xlAnd, _\n        Criteria2:=\"&lt;=\" &amp; lngEnd\n\n\n           Range(\"A1:s3000\").Select\n    Range(\"A:A\").Activate\n    Selection.Copy\n    Sheets.Add After:=ActiveSheet\nWith ActiveSheet\n    .Range(\"A1\").PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n    :=False, Transpose:=False\n    .Columns(\"A:A\").EntireColumn.AutoFit\n    .Cells.Select\n    .Cells.EntireColumn.AutoFit\n    .Rows(\"1:1\").Select\n    .Application.CutCopyMode = False\n    With Selection\n         With .Interior\n            .Pattern = xlSolid\n            .PatternColorIndex = xlAutomatic\n            .Color = 15773696\n            .TintAndShade = 0\n            .PatternTintAndShade = 0\n        End With\n        .AutoFilter\n           Columns(\"Q:Q\").Select\n    Selection.NumberFormat = \"[$-409]m/d/yy h:mm AM/PM;@\"\n    End With\n    .Columns(\"A:A\").EntireColumn.AutoFit\n    .Range(\"A2\").Select\nEnd With\n\nEnd Sub\n</code></pre>\n\n<p>The code also copy the data to a new sheet ( any idea how to copy it to a new file?) and changed some cells format.</p>\n\n<p>Thanks!!</p>\n"}, {"tags": ["regex", "excel", "vba"], "comments": [{"owner": {"reputation": 381813, "user_id": 1863229, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/4sh1l.png?s=128&g=1", "display_name": "Tim Biegeleisen", "link": "https://stackoverflow.com/users/1863229/tim-biegeleisen"}, "edited": false, "score": 0, "creation_date": 1527646417, "post_id": 50595433, "comment_id": 88199961, "body": "My guess is that you would need to code something in VBA to do this.  Maybe you should add VBA to your tag list."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 9867327, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-s0Wg-0XdhAw/AAAAAAAAAAI/AAAAAAAAALE/jMOrmWSrhTE/photo.jpg?sz=128", "display_name": "Kyle Ryan", "link": "https://stackoverflow.com/users/9867327/kyle-ryan"}, "edited": false, "score": 0, "creation_date": 1527647350, "post_id": 50595482, "comment_id": 88200195, "body": "That will be a decent patch for now. Thank you."}, {"owner": {"reputation": 1301, "user_id": 6788666, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-f6HonjRYjFU/AAAAAAAAAAI/AAAAAAAAAAs/s90OM-vnfoE/photo.jpg?sz=128", "display_name": "Dylan", "link": "https://stackoverflow.com/users/6788666/dylan"}, "reply_to_user": {"reputation": 1, "user_id": 9867327, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-s0Wg-0XdhAw/AAAAAAAAAAI/AAAAAAAAALE/jMOrmWSrhTE/photo.jpg?sz=128", "display_name": "Kyle Ryan", "link": "https://stackoverflow.com/users/9867327/kyle-ryan"}, "edited": false, "score": 0, "creation_date": 1527682836, "post_id": 50595482, "comment_id": 88218329, "body": "Does this not meet your requirements? If you had a different kind of solution in mind please elaborate."}], "tags": [], "owner": {"reputation": 1301, "user_id": 6788666, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-f6HonjRYjFU/AAAAAAAAAAI/AAAAAAAAAAs/s90OM-vnfoE/photo.jpg?sz=128", "display_name": "Dylan", "link": "https://stackoverflow.com/users/6788666/dylan"}, "is_accepted": false, "score": 0, "last_activity_date": 1527646844, "creation_date": 1527646844, "answer_id": 50595482, "question_id": 50595433, "link": "https://stackoverflow.com/questions/50595433/how-can-i-fill-out-a-table-column-with-specific-text-from-adjacent-column-in-exc/50595482#50595482", "title": "How can I fill out a table column with specific text from adjacent column in Excel?", "body": "<p>You can use a function in column B to get this, as long as every section starts with the word \"Section\" and everything that isn't a section heading doesn't start with the word \"Section\".</p>\n\n<pre><code>=IF(LEFT(C2,7) = \"Section\",C2,B1)\n</code></pre>\n\n<p>In your example, if you pasted this function in cell B2 and fill down (to keep relative references), it should do the trick.</p>\n"}, {"tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": false, "score": 0, "last_activity_date": 1527654703, "creation_date": 1527654703, "answer_id": 50596433, "question_id": 50595433, "link": "https://stackoverflow.com/questions/50595433/how-can-i-fill-out-a-table-column-with-specific-text-from-adjacent-column-in-exc/50596433#50596433", "title": "How can I fill out a table column with specific text from adjacent column in Excel?", "body": "<p>Same thing with VBA</p>\n\n<pre><code>Option Explicit\n\nPublic Sub FillDownInfo()\n\n    Application.ScreenUpdating = False\n    Dim lastRowC As Long, rng As Range\n\n    With ActiveSheet\n\n       lastRowC = .Cells(.Rows.Count, \"C\").End(xlUp).Row\n\n       For Each rng In .Range(\"B2:B\" &amp; lastRowC)\n           If InStr(1, rng.Offset(, 1).Value, \"Section\") &gt; 0 Then\n               rng = rng.Offset(, 1)\n           Else\n              rng = rng.Offset(-1, 0)\n           End If\n       Next rng\n    End With\n\n    Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 9867327, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-s0Wg-0XdhAw/AAAAAAAAAAI/AAAAAAAAALE/jMOrmWSrhTE/photo.jpg?sz=128", "display_name": "Kyle Ryan", "link": "https://stackoverflow.com/users/9867327/kyle-ryan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 42, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1527654703, "creation_date": 1527646285, "last_edit_date": 1527646563, "question_id": 50595433, "link": "https://stackoverflow.com/questions/50595433/how-can-i-fill-out-a-table-column-with-specific-text-from-adjacent-column-in-exc", "title": "How can I fill out a table column with specific text from adjacent column in Excel?", "body": "<p>I am using Excel to house a database for qualitative transcripts (copied from Word). Every transcript follows the same outline, having sections for different topics addressed in questions. When I paste the transcripts, I would like to have a column to the left of the text that recognizes the section title and populates the column with that section header until the next section header comes up. Right now, I am manually typing the section title and dragging it until the next section starts.<a href=\"https://i.stack.imgur.com/Yava7.png\" rel=\"nofollow noreferrer\">enter image description here</a></p>\n"}, {"tags": ["vba", "macos", "powerpoint", "powerpoint2016"], "comments": [{"owner": {"reputation": 12482, "user_id": 1667023, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JXaUt.png?s=128&g=1", "display_name": "Steve Rindsberg", "link": "https://stackoverflow.com/users/1667023/steve-rindsberg"}, "edited": false, "score": 0, "creation_date": 1527695032, "post_id": 50595418, "comment_id": 88227210, "body": "I don&#39;t have a Mac w/2016 handy, but considering that the code works perfectly in Windows PPT, even back to 2010, I&#39;d guess that this is missing in the Mac PPT object model."}, {"owner": {"reputation": 12482, "user_id": 1667023, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JXaUt.png?s=128&g=1", "display_name": "Steve Rindsberg", "link": "https://stackoverflow.com/users/1667023/steve-rindsberg"}, "edited": false, "score": 0, "creation_date": 1527780067, "post_id": 50595418, "comment_id": 88265373, "body": "I see you&#39;ve posted the same question on Microsoft&#39;s Answers forum. John Wilson&#39;s reply confirms my suspicion.  You&#39;ve run into one of the various features that Windows PPT supports, Mac PPT does not. I tried to find a few workarounds (eg setting the hyperlink&#39;s .Address and .Subaddress to blank) but those just revealed MORE bugs."}], "answers": [{"tags": [], "owner": {"reputation": 3, "user_id": 9338836, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd0f2f7f4fbe39cc04f6ca86e7347daf?s=128&d=identicon&r=PG&f=1", "display_name": "quickreactor", "link": "https://stackoverflow.com/users/9338836/quickreactor"}, "is_accepted": true, "score": 0, "last_activity_date": 1528260750, "creation_date": 1528260750, "answer_id": 50712470, "question_id": 50595418, "link": "https://stackoverflow.com/questions/50595418/cant-delete-hyperlinks-with-vba-in-ppt2016-mac-os/50712470#50712470", "title": "Can&#39;t delete hyperlinks with VBA in PPT2016 (MAC OS)", "body": "<p>John SR Wilson over on the Microsoft Answers Forum found a way to workaround this so I decided to post it back here in case anyone was wondering</p>\n\n<pre><code>See if this works on your Mac\n\nSub killMacLinks()\nDim ohl As Hyperlink\nDim osld As Slide\nDim asT As ActionSetting\nSet osld = ActiveWindow.Selection.SlideRange(1)\nFor Each ohl In osld.Hyperlinks\nSet asT = ohl.Parent\nasT.Action = ppActionNone\nNext\nEnd Sub\n\nIf it works you can easily loop through all slides.\nwww.pptalchemy.co.uk\n</code></pre>\n\n<p>All credit to John SR Wilson!</p>\n"}], "owner": {"reputation": 3, "user_id": 9338836, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd0f2f7f4fbe39cc04f6ca86e7347daf?s=128&d=identicon&r=PG&f=1", "display_name": "quickreactor", "link": "https://stackoverflow.com/users/9338836/quickreactor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 43, "favorite_count": 0, "accepted_answer_id": 50712470, "answer_count": 1, "score": 0, "last_activity_date": 1528260750, "creation_date": 1527646200, "question_id": 50595418, "link": "https://stackoverflow.com/questions/50595418/cant-delete-hyperlinks-with-vba-in-ppt2016-mac-os", "title": "Can&#39;t delete hyperlinks with VBA in PPT2016 (MAC OS)", "body": "<p>I have found many example scripts which should work e.g.</p>\n\n<pre><code>Sub DeleteLinks()\n    Dim oSl As Slide\n    Dim x As Long\n\n    For Each oSl In ActivePresentation.Slides\n        For x = oSl.Hyperlinks.Count To 1 Step -1\n            oSl.Hyperlinks(x).Delete\n        Next\n    Next\n\nEnd Sub\n</code></pre>\n\n<p>However when I try to run this on Powerpoint on Mac it gives me this:</p>\n\n<p>Compile Error: Method or data member not found</p>\n\n<p>Does this mean this functionality doesn't exist in Mac PPT VBA?</p>\n"}, {"tags": ["vba", "ms-access", "ms-access-2010", "expressionbuilder"], "comments": [{"owner": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "reply_to_user": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 2, "creation_date": 1528082384, "post_id": 50595276, "comment_id": 88355760, "body": "Remember to mark the answer by @ashleedawg as an ANSWER if it worked for you - as you say it did below. It looks like you have a long history of asking questions and not marking answers as such. Hopefully that&#39;s just an oversight in this case - you can also go back over old questions and see if you missed answers for them too."}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "reply_to_user": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "edited": false, "score": 0, "creation_date": 1528106514, "post_id": 50595276, "comment_id": 88365405, "body": "@dbmitch Wow you&#39;re not kidding"}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 1, "creation_date": 1528106560, "post_id": 50595276, "comment_id": 88365430, "body": "@Mike-S wow yeah, 15 questions this year alone, and you have accepted an answer on a single one of them.  Other users have probably already started avoiding your questions and more will come.  It only take a second to do, and it shows your appreciation, and even earns rep for you too."}], "answers": [{"comments": [{"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "reply_to_user": {"reputation": 266, "user_id": 6158286, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/cdeb0d9ef71c19671a809a0f5f486bd2?s=128&d=identicon&r=PG&f=1", "display_name": "Mike S", "link": "https://stackoverflow.com/users/6158286/mike-s"}, "edited": false, "score": 1, "creation_date": 1527729542, "post_id": 50596087, "comment_id": 88240601, "body": "@MikeS You&#39;re welcome, I&#39;m glad you got it figured out!  (Don&#39;t forget to <b>\u25b2 Upvote</b> answers that are helpful <b><i>and</i></b> to <b>\u2713\uff0b\u25b2 Accept <i>and</i> Upvote</b> an answer that helped you solve your problem!)"}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "reply_to_user": {"reputation": 266, "user_id": 6158286, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/cdeb0d9ef71c19671a809a0f5f486bd2?s=128&d=identicon&r=PG&f=1", "display_name": "Mike S", "link": "https://stackoverflow.com/users/6158286/mike-s"}, "edited": false, "score": 0, "creation_date": 1528962061, "post_id": 50596087, "comment_id": 88706818, "body": "@MikeS - Don&#39;t forget to <b><code>\u2713 Accept</code></b> an answer that helped solve your problem\u2026 You&#39;ll get <b><code>+2</code></b> reputation, and the answer&#39;s author gets <b><code>+15</code></b> rep.  When you&#39;ve reached 15 reputation, you can <i>also</i> <b><code>\u25b2 Upvote</code></b> any answers that are helpful, which also rewards the authors <b>plus</b> your feedback in the form of votes <i>benefits the <a href=\"https://stackoverflow.com\">Stack Overflow</a> community as a whole!</i>  There&#39;s no downside for you to accept answers.  Only upsides."}], "tags": [], "owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "is_accepted": false, "score": 3, "last_activity_date": 1527652320, "last_edit_date": 1527652320, "creation_date": 1527652004, "answer_id": 50596087, "question_id": 50595276, "link": "https://stackoverflow.com/questions/50595276/use-custom-functions-in-the-expression-builder/50596087#50596087", "title": "Use custom functions in the Expression Builder", "body": "<p>I think you're asking how to have custom functions show up in the Expression Builder? (and therefore unrelated to Active Directory or logins).</p>\n\n<p>It's most likely a simple case of <strong>either</strong>:<br>\n - you haven't <strong>saved</strong> the module since pasting the functions in, <strong><em>or</strong>,</em><br>\n - the functions are not located in a public module.</p>\n\n<p><strong>To make sure they're saved:</strong><br>\n 1. Close Access completely (<em>all</em> open databases), <em>and then,</em><br>\n 2. Re-open the database, <em>and,</em><br>\n 3. Open your module (from the \"Modules\" section of the Navigation Bar:</p>\n\n<p><a href=\"https://i.stack.imgur.com/WBDDqm.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/WBDDqm.png\" alt=\"img\"></a></p>\n\n<p>...and confirm your code is there.</p>\n\n<p>Then try the expression builder again.</p>\n\n<hr>\n\n<p>If the module is not showing in the <code>Modules</code> section, then your code is not in a public module.</p>\n\n<p>Note that you don't <em>have to</em> use the Expression Builder.  I've actually never used it, but I just tried it and once the module with my functions was saved, they showed up under:  </p>\n\n<p><code>Functions</code> \u2192 <em><code>My database name</code></em> \u2192 <em><code>My module name</code></em>. </p>\n\n<hr>\n\n<p>This screenshot shows how my function wasn't listed i the Expression Builder until I saved it, and then how I found it in the Builder:</p>\n\n<p><img src=\"https://image.ibb.co/d0UeQy/example.gif\"></p>\n"}], "owner": {"reputation": 266, "user_id": 6158286, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/cdeb0d9ef71c19671a809a0f5f486bd2?s=128&d=identicon&r=PG&f=1", "display_name": "Mike S", "link": "https://stackoverflow.com/users/6158286/mike-s"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 897, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1528106668, "creation_date": 1527644933, "last_edit_date": 1528106668, "question_id": 50595276, "link": "https://stackoverflow.com/questions/50595276/use-custom-functions-in-the-expression-builder", "title": "Use custom functions in the Expression Builder", "body": "<p>I added a function to get the <strong>Active Directory</strong> user login, for an Access DB using VBA, but I'm not sure why I don't see my function listed in the Expression Builder</p>\n\n<p>I defined the functions like in <a href=\"https://stackoverflow.com/questions/9052/is-there-a-way-for-ms-access-to-grab-the-current-active-directory-user\">this question</a> but I can not see the function in the Expression Builder. I plan to use this function to fill an invisible txtBox on my form and log it into db.</p>\n\n<pre><code>    Public Function GetUser(Optional whatpart = \"username\")\n        Dim returnthis As String\n        If whatpart = \"username\" Then GetUser = Environ(\"USERNAME\"): Exit Function\n        Set objSysInfo = CreateObject(\"ADSystemInfo\")\n        Set objUser = GetObject(\"LDAP://\" &amp; objSysInfo.USERNAME)\n        Select Case whatpart\n            Case \"fullname\": returnthis = objUser.FullName\n            Case \"firstname\", \"givenname\": returnthis = objUser.givenName\n            Case \"lastname\": returnthis = objUser.LastName\n            Case Else: returnthis = Environ(\"USERNAME\")\n        End Select\n        GetUser = returnthis\n    End Function\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/XUOik.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/XUOik.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "edited": false, "score": 0, "creation_date": 1527644855, "post_id": 50595233, "comment_id": 88199640, "body": "Hover your mouse over rptVals and ElAr to see which one is giving you the error, I assume it is actually <code>ElAr(chkcount, 1)</code> - can you dump the value of that? It might be the <code>MID</code> function doesn;t like your values"}, {"owner": {"reputation": 17, "user_id": 7989152, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6eeb2fe5a81394e101ca8133d4e4cae2?s=128&d=identicon&r=PG&f=1", "display_name": "webfootedoldman", "link": "https://stackoverflow.com/users/7989152/webfootedoldman"}, "reply_to_user": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "edited": false, "score": 0, "creation_date": 1527657211, "post_id": 50595233, "comment_id": 88202652, "body": "@dbmitch No, I&#39;ve check that and it&#39;s the rptVals that is returning the error. As for the Mid, the String for the worksheet I&#39;m trying to pull data from (FlNm) is &quot;XY               &quot; where XY is an chemical element symbol (Fe, Al, Au, etc). I have not idea why there are all the spaces there and I have no control over how the original is made, but I&#39;m using Mid so it just sees the element symbol."}, {"owner": {"reputation": 17, "user_id": 7989152, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6eeb2fe5a81394e101ca8133d4e4cae2?s=128&d=identicon&r=PG&f=1", "display_name": "webfootedoldman", "link": "https://stackoverflow.com/users/7989152/webfootedoldman"}, "reply_to_user": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "edited": false, "score": 0, "creation_date": 1527660658, "post_id": 50595233, "comment_id": 88203975, "body": "@dbmitch I just noticed that didn&#39;t come out the way I was expecting. the String looks like &quot;XY__________&quot;."}], "answers": [{"comments": [{"owner": {"reputation": 17, "user_id": 7989152, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6eeb2fe5a81394e101ca8133d4e4cae2?s=128&d=identicon&r=PG&f=1", "display_name": "webfootedoldman", "link": "https://stackoverflow.com/users/7989152/webfootedoldman"}, "edited": false, "score": 0, "creation_date": 1527660553, "post_id": 50595301, "comment_id": 88203916, "body": "OK, that work. Thank you! Question though, did rptVals need to be rptVals, 2 because I was looping through values on the row by column? And ElAr needed to be ElAr,1 because I was looping through values in the column by row?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 17, "user_id": 7989152, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6eeb2fe5a81394e101ca8133d4e4cae2?s=128&d=identicon&r=PG&f=1", "display_name": "webfootedoldman", "link": "https://stackoverflow.com/users/7989152/webfootedoldman"}, "edited": false, "score": 0, "creation_date": 1527662336, "post_id": 50595301, "comment_id": 88204807, "body": "Yes, if you are equating the ranks of a 2-D array to the rows and columns on a worksheet, then that is a suitable explanation."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 1, "last_activity_date": 1527645208, "creation_date": 1527645208, "answer_id": 50595301, "question_id": 50595233, "link": "https://stackoverflow.com/questions/50595233/excel-vba-nested-for-loop-returns-run-time-error-9/50595301#50595301", "title": "Excel VBA Nested For Loop Returns Run Time Error 9", "body": "<p>Your For ... Next construction is defaulting to the first rank of your array. You want the second rank.</p>\n\n<pre><code>For rptcount = LBound(rptVals, 2) To UBound(rptVals, 2)\n    For chkcount = LBound(ElAr, 1) To UBound(ElAr, 1)\n</code></pre>\n"}], "owner": {"reputation": 17, "user_id": 7989152, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6eeb2fe5a81394e101ca8133d4e4cae2?s=128&d=identicon&r=PG&f=1", "display_name": "webfootedoldman", "link": "https://stackoverflow.com/users/7989152/webfootedoldman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 57, "favorite_count": 0, "accepted_answer_id": 50595301, "answer_count": 1, "score": 1, "last_activity_date": 1527645208, "creation_date": 1527644442, "question_id": 50595233, "link": "https://stackoverflow.com/questions/50595233/excel-vba-nested-for-loop-returns-run-time-error-9", "title": "Excel VBA Nested For Loop Returns Run Time Error 9", "body": "<p>After the 12th found match of the loop, I have a Run-time Error 9 on the rptVals array. Basically, the rptcount hits 247 - where rptRows has a count of 246. I have tried doubling and quadrupling the size of rptRows, and each time I pass the 12th match I get the error. I tried loading a different data set that has one more row of data than the first workbook, and I get the error there after the 13th match - again regardless of rptRows count size, but always matching report counts maximum count.</p>\n\n<p>Any ideas why this is happening? Also, I'm a chemist, not a programmer, so sorry if this isn't the prettiest code or the most efficient or whatever. If it works, I'm happy. Also, I've been made aware of Dictionaries, but I have a better grasp on arrays and loops than I do dictionaries (which obviosly isn't saying much, but oh well).</p>\n\n<pre><code>Sub PrntFllEle()\n\n    With Workbooks(\"Full Element Analysis Current\").Worksheets(\"All _\n    Samples\")\n\n    rptRows = Range(\"H6:IS6\").Columns.Count  'here is the start of the \n                                             'problem. rptRows = 246\n    'rptrng = rptRows * 2  I made this variable to double/quadruple the _ \n                           size of rptRows count\n    rptVals = .Range(\"H6:IS6\" &amp; rptRows).Value\n\n    End With\n\nWith Workbooks(FlNm).Worksheets(\"Report\")\n    'rEleAn, seen below the range of data captured in a separate sub.\n    'This will also have an associated array ElAr from the other sub.\n\n    chkRows = rEleAn.Rows.Count\n\nEnd With\n\nFor rptcount = LBound(rptVals) To UBound(rptVals)\n    For chkcount = LBound(ElAr) To UBound(ElAr)\n\n        If rptVals(1, rptcount) &lt;&gt; \"\" Then    'I had to include this as _   \n                                               I have some blank cells _   \n                                               in array and this was the _                                               \n                                               quickest way to deal with it.\n        'This next line is where the run-time error occurs. rptVals = _\n         Subscript out of Range and rptcount = 247\n        'Note, the UBound(rptVals) is 6241.\n\n            If rptVals(1, rptcount) = Mid((ElAr(chkcount, 1)), 1, 2) Then\n                MsgBox rptVals(1, rptcount) \n                'MsgBox just a place holder for now.\n\n            End If\n        Else\n            Exit For\n        End If\n\n    Next\nNext\n\nEnd Sub\n</code></pre>\n\n<p>All variables are global, btw. I've check those values, and everything that could affect this is Long. All arrays are Variants as I have strings and numbers to deal with. Ranges are appropriately Dim As Range.</p>\n"}, {"tags": ["excel", "excel-formula", "vba"], "answers": [{"tags": [], "owner": {"reputation": 586, "user_id": 9633414, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a17a4ec5f0dbe53ee0a2153b37138b17?s=128&d=identicon&r=PG&f=1", "display_name": "J.Doe", "link": "https://stackoverflow.com/users/9633414/j-doe"}, "is_accepted": true, "score": 2, "last_activity_date": 1527641683, "creation_date": 1527641683, "answer_id": 50594943, "question_id": 50594833, "link": "https://stackoverflow.com/questions/50594833/summing-if-minutes-shown-as-strings/50594943#50594943", "title": "Summing-if minutes shown as strings", "body": "<p>If your minutes are just stored as text, you can use a <code>SUMPRODUCT()</code> :</p>\n\n<p><a href=\"https://i.stack.imgur.com/6TH4V.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/6TH4V.png\" alt=\"enter image description here\"></a></p>\n\n<p><code>=SUMPRODUCT((Ciriteria_range=\"Criteria\")*Minutes_range*1)</code></p>\n"}], "owner": {"reputation": 337, "user_id": 7634908, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/75c5f60c897d0efbc2a4c5a56844658f?s=128&d=identicon&r=PG&f=1", "display_name": "afora377", "link": "https://stackoverflow.com/users/7634908/afora377"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 31, "favorite_count": 0, "accepted_answer_id": 50594943, "answer_count": 1, "score": 1, "last_activity_date": 1527641683, "creation_date": 1527640693, "last_edit_date": 1531161705, "question_id": 50594833, "link": "https://stackoverflow.com/questions/50594833/summing-if-minutes-shown-as-strings", "title": "Summing-if minutes shown as strings", "body": "<p>I have a range of times in minutes displayed as strings \"30\", \"33\" etc, which I will need to sum to display as the total number of minutes. Plus a value will need to be summed only if a condition is true - hence I will need to use SUMIF if I were in an Excel worksheet proper. </p>\n\n<p>Is there a quick build-in function for summing stringed minutes (ideally a sumif variant) without using extensive VBA manipulations? </p>\n\n<p>Note: I cannot append another column and convert those values to Time - it will have to be done in a single 'summing' cell. </p>\n\n<p>Many thanks!</p>\n"}, {"tags": ["vba", "visual-studio"], "comments": [{"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 1, "creation_date": 1527648486, "post_id": 50594764, "comment_id": 88200462, "body": "There are a number of ways you could go about extracting one string from another.  Which one to choose depend on your situation.  Are you reading from a text file or a text box? (Or a text file named <code>(TextBox3.Text)</code>?)  Will the string <b>always</b> be exactly the same? (ie., 3 items in a row, same order?)  Where is this data getting there?  Is this some form of xml? I f so, where&#39;s the rest of the file?  It would probably make this easier if you share some sample data so it&#39;s clear what you&#39;re trying to do."}, {"owner": {"reputation": 11114, "user_id": 1712135, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cErYR.png?s=128&g=1", "display_name": "deHaar", "link": "https://stackoverflow.com/users/1712135/dehaar"}, "edited": false, "score": 0, "creation_date": 1527667504, "post_id": 50594764, "comment_id": 88207931, "body": "Does the <code>Contains(...)</code> method do the same as <code>InStr(...)</code> does? You could also try splitting the string by &quot; and check the results."}, {"owner": {"reputation": 41, "user_id": 6074695, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-2oVEG8yBENs/AAAAAAAAAAI/AAAAAAAAAnQ/z9X1TJ2Z8hg/photo.jpg?sz=128", "display_name": "Ahmad Yusuf", "link": "https://stackoverflow.com/users/6074695/ahmad-yusuf"}, "edited": false, "score": 0, "creation_date": 1527675436, "post_id": 50594764, "comment_id": 88213302, "body": "the string is not always same.but     i tried  remchar = baris.Replace(&quot;&quot;&quot;&quot;, &quot;&quot;).Replace(&quot;&lt;&quot;, &quot;&quot;).Replace(&quot;/&gt;&quot;, &quot;&quot;).Replace(&quot;data&quot;, &quot;&quot;).Replace(&quot;=&quot;, &quot;&quot;).Replace(&quot;size&quot;, &quot;&quot;).Replace(&quot;path&quot;, &quot;&quot;) and it work perfectly"}], "owner": {"reputation": 41, "user_id": 6074695, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-2oVEG8yBENs/AAAAAAAAAAI/AAAAAAAAAnQ/z9X1TJ2Z8hg/photo.jpg?sz=128", "display_name": "Ahmad Yusuf", "link": "https://stackoverflow.com/users/6074695/ahmad-yusuf"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 22, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1527640055, "creation_date": 1527640055, "question_id": 50594764, "link": "https://stackoverflow.com/questions/50594764/get-multiple-string-with-start-char-in-line-with-visual-basics", "title": "get multiple string with start char in line with visual basics", "body": "<p>i'am trying get multiple string in line,</p>\n\n<p>example string read from text file <code>(TextBox3.Text)</code></p>\n\n<p>code :\n<code>&lt;data size=\"xx\" path=\"path\" filename=\"filename\" /&gt;</code></p>\n\n<p>is there any way to get the  selected strings </p>\n\n<p>my code `  Dim waca() As String = System.IO.File.ReadAllLines(TextBox3.Text)</p>\n\n<pre><code>            For Each baris As String In waca\n\n                If baris.Contains(\"&lt;data\") Then\n                    Dim remchar As String\n\n\n                    MsgBox(remchar)\n\n                End If\n            Next\n</code></pre>\n\n<p>`</p>\n\n<p>i want the output is</p>\n\n<p><code>xx path filename</code> in text file</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1527634301, "post_id": 50593975, "comment_id": 88197278, "body": "You&#39;ll need to show a small example illustrating exactly what you mean by &quot;collapse&quot;.  Do you mean you want to delete empty rows or columns on the sheet, or move data so that empty spaces get filled?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1527639688, "post_id": 50593975, "comment_id": 88198584, "body": "If you loop through each cell in <code>rngRows</code> you can check for intersect with <code>rngCols</code>, rather than trying to loop over <code>Rng</code>  Or vice-versa loop over <code>rngCols</code> and check against <code>rngRows</code>"}], "owner": {"reputation": 13, "user_id": 4213550, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dab2d7be795ac8c5e27f2faed6801d7?s=128&d=identicon&r=PG&f=1", "display_name": "c-dube", "link": "https://stackoverflow.com/users/4213550/c-dube"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 100, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1527638086, "creation_date": 1527633531, "last_edit_date": 1531164843, "question_id": 50593975, "link": "https://stackoverflow.com/questions/50593975/vba-organizing-a-non-rectangular-range-edit", "title": "VBA: Organizing a non rectangular range (edit)", "body": "<p>I have a range of  \"criss crossed\" rows and columns that have been intersected:</p>\n\n<pre><code>Dim rows As Range\nSet rows = Workbooks(insurance).Worksheets(from).Range(rngRows)\n\nDim cols As Range\nSet cols = Workbooks(insurance).Worksheets(from).Range(rngCols)\n\nSet Rng = Application.intersect(rows, cols)\n</code></pre>\n\n<p>I want to \"collapse\" the intersected cells so that there are no spaces between them. Thoughts?</p>\n\n<p>Edit:\nI need to pull data from say the intersection of say rngRows = \"16:24,27:32,35:39\" and rngCols = \"E:E,I:I,M:M\" and then essentially delete all the spaces between them or put it in an array. The problem is that Rng, doesn't order the range by column or row but into a bunch of broken up ranges so I can't loop through an entire columns first and then the next one.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 165, "user_id": 7346117, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-CXzhSH-pYtI/AAAAAAAAAAI/AAAAAAAAAMs/pUmsWxBdBNk/photo.jpg?sz=128", "display_name": "Mikael Kajander", "link": "https://stackoverflow.com/users/7346117/mikael-kajander"}, "edited": false, "score": 0, "creation_date": 1527635879, "post_id": 50593782, "comment_id": 88197694, "body": "Here&#39;s some resources for that: <a href=\"https://stackoverflow.com/questions/4668410/how-do-i-get-the-old-value-of-a-changed-cell-in-excel-vba?utm_medium=organic&amp;utm_source=google_rich_qa&amp;utm_campaign=google_rich_qa\">detecting changes in the values of certain cells</a>"}], "answers": [{"comments": [{"owner": {"reputation": 4245, "user_id": 8276474, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sm6MV.jpg?s=128&g=1", "display_name": "PGSystemTester", "link": "https://stackoverflow.com/users/8276474/pgsystemtester"}, "edited": false, "score": 0, "creation_date": 1527652451, "post_id": 50595886, "comment_id": 88201380, "body": "I&#39;m not sure if the change event would be initiated if it was from an external link. If so, this answer is better than mine. I wrote mine assuming the event would not be triggered by an external reference updating."}], "tags": [], "owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "is_accepted": false, "score": 0, "last_activity_date": 1527651134, "last_edit_date": 1527651134, "creation_date": 1527650349, "answer_id": 50595886, "question_id": 50593782, "link": "https://stackoverflow.com/questions/50593782/vba-excel-create-a-running-list-of-occurences-with-time-stamps/50595886#50595886", "title": "VBA Excel Create a Running List of Occurences with Time Stamps", "body": "<p>This code will only execute when a change occurs in your target cell (B6).</p>\n\n<p>When the value in B6 changes, it will post a time stamp (down to the second) starting at B7 on the first instance, B8 on the next instance, and so on...  </p>\n\n<p>Paste this code on the sheet where your target cell (B6) is. Also, you will need to change all instances of \"Sheet1\" to your sheet name. </p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    Dim KeyCells As Range\n    Set KeyCells = Range(\"B6\")\n\n    Dim WS As Worksheet\n    Set WS = ThisWorkbook.Sheets(\"Sheet1\")\n\n    If Not Application.Intersect(KeyCells, Range(Target.Address)) _\n        Is Nothing Then\n        Dim LRow As Integer\n        LRow = WS.Range(\"B\" &amp; WS.Rows.Count).End(xlUp).Row\n        WS.Range(\"B\" &amp; LRow + 1).Value = Now()\n    End If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 9866962, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-eREx4vsafwA/AAAAAAAAAAI/AAAAAAAAJG0/5ZRNa2MKvnU/photo.jpg?sz=128", "display_name": "GEstrada", "link": "https://stackoverflow.com/users/9866962/gestrada"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 46, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1527652364, "creation_date": 1527632271, "question_id": 50593782, "link": "https://stackoverflow.com/questions/50593782/vba-excel-create-a-running-list-of-occurences-with-time-stamps", "title": "VBA Excel Create a Running List of Occurences with Time Stamps", "body": "<p>I have cell \"B16\" that displays a \"1\" if a particular machine is running or \"0\" if it is not running. These values are updated live, but I want to keep record of the timestamp of when this value changes (whether from 1 to 0 or vice versa) and create a list where the next available cells below are populated with the next status change and time stamp. The purpose of this is to be able to determine when the machine went down, how long it was down for, and when it started to run again.</p>\n\n<p>Thank you,\nGEstrada</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 110, "user_id": 8676713, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/95724206c280d2070460f995332e8788?s=128&d=identicon&r=PG&f=1", "display_name": "yossup", "link": "https://stackoverflow.com/users/8676713/yossup"}, "edited": false, "score": 0, "creation_date": 1527690453, "post_id": 50594770, "comment_id": 88224088, "body": "Thanks for the help ! Going to tweak it a bit for my current code, but this is will work."}], "tags": [], "owner": {"reputation": 543, "user_id": 7420518, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DweYi.png?s=128&g=1", "display_name": "IvenBach", "link": "https://stackoverflow.com/users/7420518/ivenbach"}, "is_accepted": true, "score": 1, "last_activity_date": 1527640099, "creation_date": 1527640099, "answer_id": 50594770, "question_id": 50593603, "link": "https://stackoverflow.com/questions/50593603/can-i-evaluate-two-workbooks-worksheets-names-and-if-they-have-the-same-name-th/50594770#50594770", "title": "Can I evaluate two workbooks worksheets names, and if they have the same name then move on to the next sheet?", "body": "<p>Providing arguments to <code>CopyWorksheets</code> you can now have it copy them if the <code>Name</code>, as shown on the tab, doesn't exist. It avoids a double <code>For ... Loop</code> by using OERN (<code>On Error Resume Next</code>) to continue when <code>Set foundSheet = copySheetTo.Worksheets(ws.Name)</code> would raise an error. If it would raise an error then <code>foundSheet</code> is <code>Nothing</code> and copies it over accordingly. The loop sets <code>foundSheet</code> back to nothing in preparation for the next check.</p>\n\n<pre><code>Sub Testing()\n    Dim wbk4 As Workbook\n    Set wbk4 = Workbooks.Open(\"G:\\Financial\\Facility Work Papers and Financials\\8. Wage Reconcilliations\\Wage Reconciliation 2017\\December 2017 completed\\\" &amp; rngFacility &amp; \" \" &amp; WageRec &amp; \" \" &amp; TwelveThirtyOne &amp; \".xls\")\n\n    Dim newBook As Workbook\n    Set newBook = Workbooks.Add\n    CopyWorksheets wbk4, newBook\nEnd Sub\n\nPublic Sub CopyWorksheets(ByVal sourceBook As Workbook, ByVal copySheetTo As Workbook)\n    On Error Resume Next\n    Dim ws As Worksheet\n    For Each ws In sourceBook.Worksheets\n        Dim foundSheet As Worksheet\n        Set foundSheet = copySheetTo.Worksheets(ws.Name)\n\n        If foundSheet Is Nothing Then\n            ws.Copy After:=copySheetTo.Worksheets(copySheetTo.Worksheets.Count)\n        End If\n        Set foundSheet = Nothing\n    Next\n    On Error GoTo 0\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 110, "user_id": 8676713, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/95724206c280d2070460f995332e8788?s=128&d=identicon&r=PG&f=1", "display_name": "yossup", "link": "https://stackoverflow.com/users/8676713/yossup"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 34, "favorite_count": 0, "accepted_answer_id": 50594770, "answer_count": 1, "score": 0, "last_activity_date": 1527640099, "creation_date": 1527631270, "question_id": 50593603, "link": "https://stackoverflow.com/questions/50593603/can-i-evaluate-two-workbooks-worksheets-names-and-if-they-have-the-same-name-th", "title": "Can I evaluate two workbooks worksheets names, and if they have the same name then move on to the next sheet?", "body": "<p>I have two workbooks with POSSIBLY the same worksheets with the same names in them both. </p>\n\n<p><a href=\"https://i.stack.imgur.com/sgef1.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/sgef1.png\" alt=\"Workbook 1 example\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/roDUU.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/roDUU.png\" alt=\"Workbook 2 example\"></a></p>\n\n<p>My question is, can i evaluate all of the workbooks sheets names against the other, and if there are some missing from the first workbook then copy those over? </p>\n\n<p>my code I have for copying them all over is this:</p>\n\n<pre><code>    Set wbk4 = Workbooks.Open(\"G:\\Financial\\Facility Work Papers and \n Financials\\8. Wage Reconcilliations\\Wage Reconciliation 2017\\December 2017 \ncompleted\\\" &amp; rngFacility &amp; \" \" &amp; WageRec &amp; \" \" &amp; TwelveThirtyOne &amp; \".xls\")\n\nFor Each sh In wbk4.Worksheets\nsh.Copy after:=wbk1.Sheets(wbk1.Sheets.Count)\nNext sh\n</code></pre>\n\n<p>In this case my base workbook would be wbk4.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 0, "creation_date": 1527631181, "post_id": 50593518, "comment_id": 88196403, "body": "You can only select cells on the currently active sheet. How is the data selected? Perhaps the selection process can be built into the macro."}, {"owner": {"reputation": 81, "user_id": 6640090, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/028583cb0274994ce14b2338fd3d3212?s=128&d=identicon&r=PG&f=1", "display_name": "Keizzerweiss", "link": "https://stackoverflow.com/users/6640090/keizzerweiss"}, "reply_to_user": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 0, "creation_date": 1527633732, "post_id": 50593518, "comment_id": 88197119, "body": "@cybernetic.nomad I would like it to be click and drag just how you would do it if you had a range of cells you wanted to look at."}], "answers": [{"comments": [{"owner": {"reputation": 81, "user_id": 6640090, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/028583cb0274994ce14b2338fd3d3212?s=128&d=identicon&r=PG&f=1", "display_name": "Keizzerweiss", "link": "https://stackoverflow.com/users/6640090/keizzerweiss"}, "edited": false, "score": 0, "creation_date": 1527634126, "post_id": 50593843, "comment_id": 88197237, "body": "This is what I&#39;m looking for I think.  So, When I select a group of cells, It will automatically store them as a global variable?  How does one go about setting that up?  Any resources that you think explain this well would be appreciated."}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "reply_to_user": {"reputation": 81, "user_id": 6640090, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/028583cb0274994ce14b2338fd3d3212?s=128&d=identicon&r=PG&f=1", "display_name": "Keizzerweiss", "link": "https://stackoverflow.com/users/6640090/keizzerweiss"}, "edited": false, "score": 0, "creation_date": 1527634646, "post_id": 50593843, "comment_id": 88197389, "body": "@Keizzerweiss  See my <b>EDIT#1</b> .......................I suggest you do some reading first and then jump into the coding."}, {"owner": {"reputation": 81, "user_id": 6640090, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/028583cb0274994ce14b2338fd3d3212?s=128&d=identicon&r=PG&f=1", "display_name": "Keizzerweiss", "link": "https://stackoverflow.com/users/6640090/keizzerweiss"}, "edited": false, "score": 0, "creation_date": 1527710960, "post_id": 50593843, "comment_id": 88235251, "body": "Okay, did some reading.  I think there should be a way to get something to work using an event macro.  There doesn&#39;t seem to be any other way to even come close.  Thanks man."}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 1, "last_activity_date": 1527634580, "last_edit_date": 1527634580, "creation_date": 1527632663, "answer_id": 50593843, "question_id": 50593518, "link": "https://stackoverflow.com/questions/50593518/having-a-sheet-that-contains-buttons-for-macros-that-run-off-of-selections/50593843#50593843", "title": "Having a sheet that contains buttons for macros that run off of selections", "body": "<p>Say there are two types of sheets:</p>\n\n<ul>\n<li>a set of data-sheets</li>\n<li>a single button-sheet which controls processing via macros tied to buttons</li>\n</ul>\n\n<p>We code a single global range variable in a standard module.  We code selection change event macros in <strong>all</strong> the data-sheets.  Then:</p>\n\n<ol>\n<li><strong>We</strong> click on a data-sheet</li>\n<li><strong>We</strong> select cells on the data-sheet</li>\n<li><strong>the event macro</strong> on that data-sheet records the selection in the global variable</li>\n<li><strong>We</strong> click to get on the button-sheet</li>\n<li><strong>We</strong> click on a button</li>\n<li><strong>the button macro</strong> retrieves the global range</li>\n<li><strong>the button macro</strong> determines the sheet associated with the stored range <em>(from the Parent Property)</em> and also the cells on that sheet which we selected</li>\n<li><strong>the button macro</strong> processes the data</li>\n</ol>\n\n<p><strong>EDIT#1:</strong></p>\n\n<p>To learn more about Event Macros (worksheet code), see:</p>\n\n<p><a href=\"http://www.mvps.org/dmcritchie/excel/event.htm\" rel=\"nofollow noreferrer\">http://www.mvps.org/dmcritchie/excel/event.htm</a></p>\n\n<p>Also just Google: <em>Excel VBA Event Macro</em></p>\n\n<p><em>(there are many examples in this forum, for example)</em></p>\n"}, {"tags": [], "owner": {"reputation": 81, "user_id": 6640090, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/028583cb0274994ce14b2338fd3d3212?s=128&d=identicon&r=PG&f=1", "display_name": "Keizzerweiss", "link": "https://stackoverflow.com/users/6640090/keizzerweiss"}, "is_accepted": false, "score": 0, "last_activity_date": 1527800911, "creation_date": 1527800911, "answer_id": 50632808, "question_id": 50593518, "link": "https://stackoverflow.com/questions/50593518/having-a-sheet-that-contains-buttons-for-macros-that-run-off-of-selections/50632808#50632808", "title": "Having a sheet that contains buttons for macros that run off of selections", "body": "<p><a href=\"https://msdn.microsoft.com/en-us/VBA/Excel-VBA/articles/workbook-sheetselectionchange-event-excel\" rel=\"nofollow noreferrer\">https://msdn.microsoft.com/en-us/VBA/Excel-VBA/articles/workbook-sheetselectionchange-event-excel</a></p>\n\n<p>In this link is where I need to start.  Every time that I change my selection it runs an event where I could maybe grab the cell values and store them in an array that will stay static when I change sheets.  If I get it right I'll post it here. 5/31/2018</p>\n"}, {"tags": [], "owner": {"reputation": 81, "user_id": 6640090, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/028583cb0274994ce14b2338fd3d3212?s=128&d=identicon&r=PG&f=1", "display_name": "Keizzerweiss", "link": "https://stackoverflow.com/users/6640090/keizzerweiss"}, "is_accepted": true, "score": 0, "last_activity_date": 1530889406, "creation_date": 1530889406, "answer_id": 51213188, "question_id": 50593518, "link": "https://stackoverflow.com/questions/50593518/having-a-sheet-that-contains-buttons-for-macros-that-run-off-of-selections/51213188#51213188", "title": "Having a sheet that contains buttons for macros that run off of selections", "body": "<p>To Accomplish this I made rng a public variable and stored my selection from sheet2 in it.  Then I used a click event in my buttons to to call the macros that I wanted to run on my range.  Here are some screenshots of the codes in my modules and in my sheets.  This answer is for anyone that finds this in the future.</p>\n\n<p><a href=\"https://imgur.com/a/DJDaQiM\" rel=\"nofollow noreferrer\">https://imgur.com/a/DJDaQiM</a></p>\n\n<p>The Biggest thing to take away from this is that Public Variables in vba only have to be declared once in any of your modules.  NOT IN YOUR SHEET CODE.  This was the biggest thing that held me back from getting this done.  Good luck and contact me with any questions.   </p>\n"}], "owner": {"reputation": 81, "user_id": 6640090, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/028583cb0274994ce14b2338fd3d3212?s=128&d=identicon&r=PG&f=1", "display_name": "Keizzerweiss", "link": "https://stackoverflow.com/users/6640090/keizzerweiss"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 45, "favorite_count": 0, "accepted_answer_id": 51213188, "answer_count": 3, "score": 0, "last_activity_date": 1530889406, "creation_date": 1527630816, "question_id": 50593518, "link": "https://stackoverflow.com/questions/50593518/having-a-sheet-that-contains-buttons-for-macros-that-run-off-of-selections", "title": "Having a sheet that contains buttons for macros that run off of selections", "body": "<p>Is it possible to use <code>Selection</code> to define data used in a macro button that is in another sheet.  </p>\n\n<p>I'm trying to make a template workbook that's first sheet is a bunch of macro buttons.  I want to be able to select data in another sheet, click my button sheet, and click my button to run a macro on the data I have selected in the other sheet.  </p>\n\n<p>The problem that I'm running into is that sheets seem to have independent selections at the same time.  So my macro always runs on the selection from the button sheet instead of the sheet I was on.  Any thoughts on how I can make this work?  The selection of the data needs to be dynamic, so I can't just say .Cells(1,1).value because it might not be the data I need.  </p>\n"}, {"tags": ["vba", "excel", "datepicker", "userform", "lost-focus"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1527634406, "post_id": 50593501, "comment_id": 88197313, "body": "Find some other event to hide the monthview"}, {"owner": {"reputation": 1, "user_id": 9866843, "user_type": "registered", "profile_image": "https://graph.facebook.com/10212652960345986/picture?type=large", "display_name": "Matthew Awkar", "link": "https://stackoverflow.com/users/9866843/matthew-awkar"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1527635799, "post_id": 50593501, "comment_id": 88197667, "body": "Hi Tim, there is no one direct event which would work. The user can either use the MonthView or not use it, they may change the date or the default (today) may not need to be changed, and they can move on to any other control in the form. I did attempt to hide it on when the date is changed, which works when you actually change the date, but if you don&#39;t need to change the date, the MonthView never closes. The only way I can think if making it work is hiding the MonthView by testing for entry on every other control."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1527635923, "post_id": 50593501, "comment_id": 88197709, "body": "It might be easier to force the user to use the monthview to change the date than to give them the option of using it or not..."}, {"owner": {"reputation": 1, "user_id": 9866843, "user_type": "registered", "profile_image": "https://graph.facebook.com/10212652960345986/picture?type=large", "display_name": "Matthew Awkar", "link": "https://stackoverflow.com/users/9866843/matthew-awkar"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1527637148, "post_id": 50593501, "comment_id": 88198007, "body": "I may have to consider that, the only thing really stopping me is that generally the date will not change from the default value and in that case if the user enters the text box and doesn&#39;t change anything, then I will have the same issue as above. Otherwise I can start with no value, so the user will need to click something, but then if they accidentally enter it again and don&#39;t change the value, I have the same issue."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1527639390, "post_id": 50593501, "comment_id": 88198527, "body": "If you typically know what the default date will be, then you can use a label instead of a textbox (or use a disabled textbox), pre-populate the date, and give the user a button to show the monthview if they want to change the date"}], "owner": {"reputation": 1, "user_id": 9866843, "user_type": "registered", "profile_image": "https://graph.facebook.com/10212652960345986/picture?type=large", "display_name": "Matthew Awkar", "link": "https://stackoverflow.com/users/9866843/matthew-awkar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 456, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1527630735, "creation_date": 1527630735, "question_id": 50593501, "link": "https://stackoverflow.com/questions/50593501/monthview-headache-vba", "title": "MonthView Headache VBA", "body": "<p>I'm creating a user form in Vba Excel that is used to manage the issuing, return and log of temporary access passes. As this will be used by some \"inexperienced\" tech users I want to allow as little user error as possible. One part of the form is the card issue date and expected return date, both are input into textboxes with some code to check correct format. To make things easier for the inexperienced I want to have a MonthView control appear when the date box is entered, allow them to put in a date, then hide again when the next field in entered. However I'm having trouble making this work without having the program crash, here is the logic:</p>\n\n<p><code>Initialize : MonthView = false \nDateTXT entered : MonthView = true\nDateTXT exit : MonthView = false\nMonthView Click : DateTXT.Value = MonthView.Value</code></p>\n\n<p>I know this logic is flawed in the context of VBA because the moment you click on the MonthView Control you exit the text box and it tries to close the MonthView. </p>\n\n<p>I'm stumped for a solution, does anyone have any ideas? </p>\n\n<p>Thanks</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 7273, "user_id": 2193968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1beed39f2b04409ff584a0af1d59325c?s=128&d=identicon&r=PG", "display_name": "Jerry Jeremiah", "link": "https://stackoverflow.com/users/2193968/jerry-jeremiah"}, "edited": false, "score": 0, "creation_date": 1527631744, "post_id": 50593432, "comment_id": 88196571, "body": "In one case LastRow is the value of U3 and in the other case it is the integer row number of the last row.  Are you actually trying to find the value a particular cell in the last row?  If so, which cell?"}, {"owner": {"reputation": 626, "user_id": 7350537, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/36e8cff16636c6f272e0cdac18767886?s=128&d=identicon&r=PG&f=1", "display_name": "LFB", "link": "https://stackoverflow.com/users/7350537/lfb"}, "edited": false, "score": 0, "creation_date": 1527631879, "post_id": 50593432, "comment_id": 88196614, "body": "Things appears to be all right with your code. You must make sure that particular line has already run. I.e.: the yellow marker should be below the line <code>Lastrow = Range(&quot;U3&quot;).Value</code>. Is that the case? Alternatively, the problem could be that the range you&#39;re referencing is in another sheet"}, {"owner": {"reputation": 347, "user_id": 5042378, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/3b85ea1e011e1a16917cfd47ba3853e5?s=128&d=identicon&r=PG&f=1", "display_name": "THAT newbie", "link": "https://stackoverflow.com/users/5042378/that-newbie"}, "reply_to_user": {"reputation": 7273, "user_id": 2193968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1beed39f2b04409ff584a0af1d59325c?s=128&d=identicon&r=PG", "display_name": "Jerry Jeremiah", "link": "https://stackoverflow.com/users/2193968/jerry-jeremiah"}, "edited": false, "score": 0, "creation_date": 1527631926, "post_id": 50593432, "comment_id": 88196633, "body": "@Jerry Jeremiah No so the one of the integer row number is what I have used in the past. I am trying to tweak it because now I have a cell (U3) that already tells me what the last row is. So I need it to look at value in cell U3 (558) and use that value as the value for &quot;Lastrow&quot;. In this case... Lastrow = Range(&quot;U3&quot;).value would equal lastrow = 558."}, {"owner": {"reputation": 347, "user_id": 5042378, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/3b85ea1e011e1a16917cfd47ba3853e5?s=128&d=identicon&r=PG&f=1", "display_name": "THAT newbie", "link": "https://stackoverflow.com/users/5042378/that-newbie"}, "reply_to_user": {"reputation": 626, "user_id": 7350537, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/36e8cff16636c6f272e0cdac18767886?s=128&d=identicon&r=PG&f=1", "display_name": "LFB", "link": "https://stackoverflow.com/users/7350537/lfb"}, "edited": false, "score": 0, "creation_date": 1527632006, "post_id": 50593432, "comment_id": 88196658, "body": "@LucianoFerreira The yellow marker when I debug is on that line. It shows 558 for the right side and 0 for the left side. I tried doing a With statement to specify which sheet to look for and it didn&#39;t work.  I&#39;ve also tried subsituting value with text and it wont work."}, {"owner": {"reputation": 626, "user_id": 7350537, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/36e8cff16636c6f272e0cdac18767886?s=128&d=identicon&r=PG&f=1", "display_name": "LFB", "link": "https://stackoverflow.com/users/7350537/lfb"}, "edited": false, "score": 0, "creation_date": 1527632060, "post_id": 50593432, "comment_id": 88196669, "body": "So, move to the next line (F8) and check again. I think it will do. The yellow marker shows the next line to run, so it hasn&#39;t yet assigned the value to the variable"}, {"owner": {"reputation": 347, "user_id": 5042378, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/3b85ea1e011e1a16917cfd47ba3853e5?s=128&d=identicon&r=PG&f=1", "display_name": "THAT newbie", "link": "https://stackoverflow.com/users/5042378/that-newbie"}, "edited": false, "score": 0, "creation_date": 1527632268, "post_id": 50593432, "comment_id": 88196735, "body": "Oh i see what you mean... okay so then my problem lies in this line: Sheet1.Range(&quot;B&quot; &amp; Lastrow + 1).EntireRow.End(xlDown).Delete"}, {"owner": {"reputation": 347, "user_id": 5042378, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/3b85ea1e011e1a16917cfd47ba3853e5?s=128&d=identicon&r=PG&f=1", "display_name": "THAT newbie", "link": "https://stackoverflow.com/users/5042378/that-newbie"}, "edited": false, "score": 0, "creation_date": 1527632295, "post_id": 50593432, "comment_id": 88196744, "body": "This is suppose to grab the row below the last row and everything below it and delete it all."}, {"owner": {"reputation": 347, "user_id": 5042378, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/3b85ea1e011e1a16917cfd47ba3853e5?s=128&d=identicon&r=PG&f=1", "display_name": "THAT newbie", "link": "https://stackoverflow.com/users/5042378/that-newbie"}, "reply_to_user": {"reputation": 626, "user_id": 7350537, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/36e8cff16636c6f272e0cdac18767886?s=128&d=identicon&r=PG&f=1", "display_name": "LFB", "link": "https://stackoverflow.com/users/7350537/lfb"}, "edited": false, "score": 0, "creation_date": 1527633022, "post_id": 50593432, "comment_id": 88196925, "body": "@LucianoFerreira Do you know why everything will work except &quot;Sheet1.Range(&quot;B&quot; &amp; Lastrow + 1).EntireRow.End(xlDown).Delete&quot;"}, {"owner": {"reputation": 626, "user_id": 7350537, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/36e8cff16636c6f272e0cdac18767886?s=128&d=identicon&r=PG&f=1", "display_name": "LFB", "link": "https://stackoverflow.com/users/7350537/lfb"}, "edited": false, "score": 0, "creation_date": 1527633236, "post_id": 50593432, "comment_id": 88196986, "body": "Well, I think the main part of the question (the debug thing) is settled. If other parts of the code are returning errors it is the case of making a new question. Either way, about that last thing, try <code>Sheets(1).</code> instead of <code>Sheet1.</code>"}], "answers": [{"tags": [], "owner": {"reputation": 1529, "user_id": 3648187, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/Am59O.jpg?s=128&g=1", "display_name": "Miqi180", "link": "https://stackoverflow.com/users/3648187/miqi180"}, "is_accepted": false, "score": 0, "last_activity_date": 1527632153, "creation_date": 1527632153, "answer_id": 50593768, "question_id": 50593432, "link": "https://stackoverflow.com/questions/50593432/vba-code-lastrow-cell-value/50593768#50593768", "title": "VBA code Lastrow = cell value", "body": "<p>If I insert \"558\" in cell A3 (not U3) and run this code it produces \"558\" in the immediate window:</p>\n\n<pre><code>Sub test()\n\n    Dim Lastrow As Integer\n    Dim sheet1 As Worksheet\n\n    Set sheet1 = ActiveSheet\n    Lastrow = sheet1.Range(\"A3\").Value2\n    Debug.Print Lastrow\n\nEnd Sub\n</code></pre>\n\n<p>Sure, when you step through it with the debugger and hover over the line where <code>Lastrow</code> is being set, it says \"Lastrow = 0\", but that's just because the variable has not been set yet. Clearly, it is indeed being set correctly as the <code>Debug.Print</code> statement in the next line produces the expected output.</p>\n"}], "owner": {"reputation": 347, "user_id": 5042378, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/3b85ea1e011e1a16917cfd47ba3853e5?s=128&d=identicon&r=PG&f=1", "display_name": "THAT newbie", "link": "https://stackoverflow.com/users/5042378/that-newbie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1160, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1527632153, "creation_date": 1527630381, "last_edit_date": 1531164843, "question_id": 50593432, "link": "https://stackoverflow.com/questions/50593432/vba-code-lastrow-cell-value", "title": "VBA code Lastrow = cell value", "body": "<p>I usually use the following code to find lastrow.</p>\n\n<pre><code>Dim Lastrow As Integer\nLastrow = Sheet2.Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n</code></pre>\n\n<p>This works fine when I don't know what my last row should be. I am trying to use it as this.</p>\n\n<pre><code>Dim Lastrow As Integer\nLastrow = Range(\"U3\").Value\n</code></pre>\n\n<p>When I debug the code and hover over </p>\n\n<blockquote>\n  <p>\"range(\"U3\").Value\"</p>\n</blockquote>\n\n<p>it shows </p>\n\n<blockquote>\n  <p>\"range(\"U3\").Value = 558\"</p>\n</blockquote>\n\n<p>but when I hover over </p>\n\n<blockquote>\n  <p>\"Lastrow\"</p>\n</blockquote>\n\n<p>it says </p>\n\n<blockquote>\n  <p>\"Lastrow = Empty\"</p>\n</blockquote>\n\n<p>instead of 558. </p>\n\n<p>The reason I am trying to use this is because the data is being pulled from a master list so I can't use the Rows.Count feature. I instead did a count of a particular value that I am filtering and using that as my last row. </p>\n\n<p>How do I get it to recognize that I want to set the variable \"Lastrow\" to the value found in U3?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1527628571, "post_id": 50592782, "comment_id": 88195471, "body": "do you have the Key somewhere?  are the values always unique?"}, {"owner": {"reputation": 3, "user_id": 5968376, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-diS_rtDCr8Y/AAAAAAAAAAI/AAAAAAAAAY0/cngG8Aedlxc/photo.jpg?sz=128", "display_name": "Yohanes Isa Ananto Tri Pratiwi", "link": "https://stackoverflow.com/users/5968376/yohanes-isa-ananto-tri-pratiwi"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1527628759, "post_id": 50592782, "comment_id": 88195537, "body": "@ScottCraner yes it is... the value always unique... i just need the position of each facelets... Reference of position is at the first image, the right one (with gray background)"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 5968376, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-diS_rtDCr8Y/AAAAAAAAAAI/AAAAAAAAAY0/cngG8Aedlxc/photo.jpg?sz=128", "display_name": "Yohanes Isa Ananto Tri Pratiwi", "link": "https://stackoverflow.com/users/5968376/yohanes-isa-ananto-tri-pratiwi"}, "edited": false, "score": 0, "creation_date": 1527630243, "post_id": 50593192, "comment_id": 88196114, "body": "hi, thanks for your answer Scott.  I&#39;ve tried your formula and got an error. Is there something wrong with my pasted formula?  <a href=\"https://imgur.com/a/2sajz9l\" rel=\"nofollow noreferrer\">imgur.com/a/2sajz9l</a>"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 3, "user_id": 5968376, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-diS_rtDCr8Y/AAAAAAAAAAI/AAAAAAAAAY0/cngG8Aedlxc/photo.jpg?sz=128", "display_name": "Yohanes Isa Ananto Tri Pratiwi", "link": "https://stackoverflow.com/users/5968376/yohanes-isa-ananto-tri-pratiwi"}, "edited": false, "score": 0, "creation_date": 1527634117, "post_id": 50593192, "comment_id": 88197235, "body": "@YohanesIsaAnantoTriPratiwi you may need to change all the <code>,</code> to <code>;</code> for your local settings."}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 2, "last_activity_date": 1527629195, "creation_date": 1527629195, "answer_id": 50593192, "question_id": 50592782, "link": "https://stackoverflow.com/questions/50592782/match-multiple-lookup-array/50593192#50593192", "title": "Match Multiple Lookup Array", "body": "<p>Using a \"Key\" to return the correct location:</p>\n\n<pre><code>=INDEX($N$1:$Y$9,\n   AGGREGATE(15,6,(ROW($A$1:$L$9)-MIN(ROW($A$1:$L$9))+1)/($A$1:$L$9=AB2),1),\n   AGGREGATE(15,6,(COLUMN($A$1:$L$9)-MIN(COLUMN($A$1:$L$9))+1)/($A$1:$L$9=AB2),1))\n</code></pre>\n\n<p>As long as the two areas are the same size and the values unique this will return the location on the \"Key\"</p>\n\n<p><a href=\"https://i.stack.imgur.com/DBOcf.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/DBOcf.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 3, "user_id": 5968376, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-diS_rtDCr8Y/AAAAAAAAAAI/AAAAAAAAAY0/cngG8Aedlxc/photo.jpg?sz=128", "display_name": "Yohanes Isa Ananto Tri Pratiwi", "link": "https://stackoverflow.com/users/5968376/yohanes-isa-ananto-tri-pratiwi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 376, "favorite_count": 0, "accepted_answer_id": 50593192, "answer_count": 1, "score": 0, "last_activity_date": 1527629195, "creation_date": 1527627244, "last_edit_date": 1531161705, "question_id": 50592782, "link": "https://stackoverflow.com/questions/50592782/match-multiple-lookup-array", "title": "Match Multiple Lookup Array", "body": "<p>Currently working on my final project thesis, i need some excel calculation for manual analytic section on the report.</p>\n\n<p>So here the problem,</p>\n\n<p>I need to define position of each facelets.</p>\n\n<p>In example position Facelets 1 is 9. (Check picture below)</p>\n\n<p><a href=\"https://i.stack.imgur.com/X05IG.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/X05IG.png\" alt=\"https://i.stack.imgur.com/X05IG.png\"></a></p>\n\n<p>So far, i get the way to reach that by transpose each row to 1 column. Like picture below and use excel function MATCH() to get the relative position.</p>\n\n<p>=MATCH(1;A1:A18;0)</p>\n\n<p><a href=\"https://i.stack.imgur.com/WEDPD.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/WEDPD.png\" alt=\"https://i.stack.imgur.com/WEDPD.png\"></a></p>\n\n<p>Is there a way to get relative position without transpose the lookup array?</p>\n\n<p>I have try use multiselect row (example A1:A3;B1:B3;), but it return errors.</p>\n\n<p>Hope someone can help me.</p>\n"}]