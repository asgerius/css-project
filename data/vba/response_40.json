[{"tags": ["vba", "excel", "debugging"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 1, "creation_date": 1444866248, "post_id": 33137386, "comment_id": 54086417, "body": "tl;dr - Was there a question in all of this?"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1444869509, "post_id": 33137386, "comment_id": 54087238, "body": "+1 for an interesting and thoroughly-researched question --- but you&#39;re trying to combine something that <i>all</i> the experts say literally cannot be done (tooltip in a UDF), with another functionality that nearly all experts say should never be done (using UDF to manipulate other cells)."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1444869583, "post_id": 33137386, "comment_id": 54087259, "body": "Observed an unhandled error when AutoFill&#39;ing this function <code>=sumTwoNumbers(1,3)</code> by dragging it down 5 or 6 rows in a column  which then causes Excel 2013 to crash."}, {"owner": {"reputation": 61, "user_id": 5037832, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SojnO.jpg?s=128&g=1", "display_name": "Marcus Martins", "link": "https://stackoverflow.com/users/5037832/marcus-martins"}, "edited": false, "score": 0, "creation_date": 1444870788, "post_id": 33137386, "comment_id": 54087506, "body": "While a tooltip in a UDF cannot be done, I am satisfied with customizing the Insert Function Wizard. However, I am indeed trying to combine these two functionalities. BDH() function from the Bloomberg Excel API does exactly what I am trying to do and works just fine. Can you provide me some material that explains why making a UDF manipule other cells should never be done?"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1444870886, "post_id": 33137386, "comment_id": 54087527, "body": "When you say &quot;Insert Function Wizard&quot; is that simply the same as registering the function and including a description and description of the parameters?"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 2, "creation_date": 1444871522, "post_id": 33137386, "comment_id": 54087666, "body": "Specifically, UDFs are <i>precluded</i> by design from performing most worksheet/range/object methods, see <a href=\"http://spreadsheetpage.com/index.php/oddity/a_user_define_function_cant_change_the_worksheet_oh_yeah/\" rel=\"nofollow noreferrer\">here</a> for a few exceptions (there are more, IIRC) or see <a href=\"http://stackoverflow.com/questions/23433096/using-a-udf-in-excel-to-update-the-worksheet\">this workaround</a> and also <a href=\"https://sites.google.com/site/e90e50/excel-formula-to-change-the-value-of-another-cell\" rel=\"nofollow noreferrer\">here</a> and <a href=\"https://support.microsoft.com/en-us/kb/170787\" rel=\"nofollow noreferrer\">MSDN</a> for some background on the limitation."}, {"owner": {"reputation": 61, "user_id": 5037832, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SojnO.jpg?s=128&g=1", "display_name": "Marcus Martins", "link": "https://stackoverflow.com/users/5037832/marcus-martins"}, "edited": false, "score": 1, "creation_date": 1444872825, "post_id": 33137386, "comment_id": 54087978, "body": "Yes. It is a description of the function and a description of the parameters. It is the window that can be accessed by Ctr + A when you have &#39;=function( &#39; written in a cell. I have edited the post in order to clarify that."}], "answers": [{"tags": [], "owner": {"reputation": 61, "user_id": 5037832, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SojnO.jpg?s=128&g=1", "display_name": "Marcus Martins", "link": "https://stackoverflow.com/users/5037832/marcus-martins"}, "is_accepted": false, "score": 0, "last_activity_date": 1445209829, "last_edit_date": 1495542746, "creation_date": 1445209829, "answer_id": 33204275, "question_id": 33137386, "link": "https://stackoverflow.com/questions/33137386/the-quest-for-combining-how-to-custom-the-insert-function-wizard-of-a-udf-and-ma/33204275#33204275", "title": "The quest for combining how to custom the Insert Function Wizard of a UDF and make the UDF manipulate other cells", "body": "<p>The question above was unnecessarily long. I could have summarized it by asking how to use the \"Insert Function Wizard\" in UDFs that are able to modify other cells. I had sticked to the concept of an UDF that could modify other cells as I knew it and did not think outside the box. The code of an UDF that can do that, as described here: <a href=\"https://stackoverflow.com/questions/8520732/i-dont-want-my-excel-add-in-to-return-an-array-instead-i-need-a-udf-to-change\">I don&#39;t want my Excel Add-In to return an array (instead I need a UDF to change other cells)</a>, breaks Excel when the user tries to use the \"Insert Function Wizard\". An workaround for this problem was to, instead of creating an UDF that modify external cells, was to create an UDF that auto-resize array outputs. I have found this Add-In: <a href=\"https://colinlegg.wordpress.com/2014/08/25/self-extending-udfs-part-1/\" rel=\"nofollow noreferrer\">https://colinlegg.wordpress.com/2014/08/25/self-extending-udfs-part-1/</a> which gives an implementation of a function called \"=rxlRESIZE()\" that resizes your array output. If you write that function inside your code, applying to your array output immediately before returning it, then you have an UDF that can write in other cells as long as your output is an array. Finally, this prevents Excel from crashing when you use the \"Insert Function Wizard\". For customizing the Insert Function Wizard, I am still using the implementation that I got from this post: <a href=\"https://stackoverflow.com/questions/4262421/how-to-put-a-tooltip-on-a-user-defined-function\">How to put a tooltip on a user-defined function</a></p>\n"}], "owner": {"reputation": 61, "user_id": 5037832, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SojnO.jpg?s=128&g=1", "display_name": "Marcus Martins", "link": "https://stackoverflow.com/users/5037832/marcus-martins"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 453, "favorite_count": 2, "answer_count": 1, "score": 4, "last_activity_date": 1445209829, "creation_date": 1444865377, "last_edit_date": 1495542746, "question_id": 33137386, "link": "https://stackoverflow.com/questions/33137386/the-quest-for-combining-how-to-custom-the-insert-function-wizard-of-a-udf-and-ma", "title": "The quest for combining how to custom the Insert Function Wizard of a UDF and make the UDF manipulate other cells", "body": "<p>This question may be of use for many VBA programmers. It involves implementing two useful independent tasks and making they work concomitantly.</p>\n\n<p>The first task is making an Excel function tooltip for an UDF. Though a definitive solution seems to not have yet been found, for now I am satisfied with the solution of customizing the Insert Function Wizard. You can find the topic regarding the implementation of a way to customize the Insert Function Wizard here: <a href=\"https://stackoverflow.com/questions/4262421/how-to-put-a-tooltip-on-a-user-defined-function\">How to put a tooltip on a user-defined function</a>\n When I say Insert Function Wizard, I mean this window:</p>\n\n<p><a href=\"https://i.stack.imgur.com/Uw3jZ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Uw3jZ.png\" alt=\"Insert Function Wizard\"></a></p>\n\n<p>If you are also interested in the topic regarding the quest for finding a definitive solution for the implementation of a function tooltip, you can go here: <a href=\"https://stackoverflow.com/questions/16903587/the-quest-for-the-excel-custom-function-tooltip\">The quest for the Excel custom function tooltip</a></p>\n\n<p>The second task is making a UDF write in a different cell from which it was called. I have found a great solution for this task here: <a href=\"https://stackoverflow.com/questions/8520732/i-dont-want-my-excel-add-in-to-return-an-array-instead-i-need-a-udf-to-change\">I don&#39;t want my Excel Add-In to return an array (instead I need a UDF to change other cells)</a></p>\n\n<p>Now, here comes the problem: <strong>Excel crashes when trying to implement these two tasks concomitantly. I want to make these two tasks work when calling a single function, preventing excel from crashing</strong>. I want to use a customized Insert Function Wizard for an UDF that can write in a different cell from which it was called. The reason for why I want to do this is that I am writing an AddIn with functions that take several input parameters (so the user need a tooltip for the input parameters) AND I need to write in cells different from the cell which they were called (because I do not want to stick to Macros. I want a function-driven AddIn and not a button-driven one). For those familiar with the Bloomberg Excel API, this is pretty much what the function BDH() does.</p>\n\n<p>I wrote two modules as a guideline for the problem. The first one builds a displayParameters() function that needs to be run before running the main function. It executes through a function-driven way the task of customizing the Insert Function Wizard. The second function is the main function called sumTwoNumbers, which executes the sum of two numbers and displays the result in a cell different from the cell which the function was called. When you try to run the second function ( sumTwoNumbers() ) using the Insert Function Wizard ( ctr + A ), after it was customized ( after you have run displayParameters() ), Excel will crash.</p>\n\n<p>Module 1:</p>\n\n<pre><code>Option Explicit\n\nPrivate Declare Function SetTimer Lib \"user32\" ( _\n      ByVal HWnd As Long, _\n      ByVal nIDEvent As Long, _\n      ByVal uElapse As Long, _\n      ByVal lpTimerFunc As Long _\n   ) As Long\n\nPrivate Declare Function KillTimer Lib \"user32\" ( _\n      ByVal HWnd As Long, _\n      ByVal nIDEvent As Long _\n   ) As Long\n\nPrivate mCalculatedCells As Collection\nPrivate mWindowsTimerID As Long\nPrivate mApplicationTimerTime As Date\n\nPublic Function displayParameters() As Variant\n\n' This is a UDF that returns true when the volscore file is created and starts a windows timer\n' that starts a second Appliction.OnTime timer that performs activities not\n' allowed in a UDF. Do not make this UDF volatile, pass any volatile functions\n' to it, or pass any cells containing volatile formulas/functions or\n' uncontrolled looping will start.\n\n    displayParameters = \"Success\"\n\n    'Cache the caller's reference so it can be dealt with in a non-UDF routine\n   If mCalculatedCells Is Nothing Then Set mCalculatedCells = New Collection\n   On Error Resume Next\n   mCalculatedCells.Add Application.Caller, Application.Caller.Address\n   On Error GoTo 0\n\n   ' Setting/resetting the timer should be the last action taken in the UDF\n   If mWindowsTimerID &lt;&gt; 0 Then KillTimer 0&amp;, mWindowsTimerID\n   mWindowsTimerID = SetTimer(0&amp;, 0&amp;, 1, AddressOf AfterUDFRoutine1_displayParameters)\n\nEnd Function\n\nPublic Sub AfterUDFRoutine1_displayParameters()\n\n' This is the first of two timer routines. This one is called by the Windows\n' timer. Since a Windows timer cannot run code if a cell is being edited or a\n' dialog is open this routine schedules a second safe timer using\n' Application.OnTime which is ignored in a UDF.\n\n   ' Stop the Windows timer\n   On Error Resume Next\n   KillTimer 0&amp;, mWindowsTimerID\n   On Error GoTo 0\n   mWindowsTimerID = 0\n\n   ' Cancel any previous OnTime timers\n   If mApplicationTimerTime &lt;&gt; 0 Then\n      On Error Resume Next\n      Application.OnTime mApplicationTimerTime, \"AfterUDFRoutine2_displayParameters\", , False\n      On Error GoTo 0\n   End If\n\n   ' Schedule timer\n   mApplicationTimerTime = Now\n   Application.OnTime mApplicationTimerTime, \"AfterUDFRoutine2_displayParameters\"\n\nEnd Sub\n\nPublic Sub AfterUDFRoutine2_displayParameters()\n\n' This is the second of two timer routines. Because this timer routine is\n' triggered by Application.OnTime it is safe, i.e., Excel will not allow the\n' timer to fire unless the environment is safe (no open model dialogs or cell\n' being edited).\n\n    Dim sumTwoNumbersArgumentsDescription(1 To 2) As String\n\n    sumTwoNumbersArgumentsDescription(1) = \"Write the first number of a Sum\"\n    sumTwoNumbersArgumentsDescription(2) = \"Write the second number of a Sum\"\n\n    Application.MacroOptions Macro:=\"sumTwoNumbers\", _\n                         ArgumentDescriptions:=sumTwoNumbersArgumentsDescription\n                         'Description:=\"describre the ivol function\"\n\n    MsgBox (\"The formal parameters and instance of actual parameters are now successfully displayed at the Insert Function Dialog Box.\")\n\nEnd Sub\n</code></pre>\n\n<p>Module 2:</p>\n\n<pre><code>Option Explicit\n\n'This global variable is the way I found of passing the output of sumTwoNumbers into the\n'function \"AfterUDFRoutine2\"\nDim outputGlobal As Variant\n\nPrivate Declare Function SetTimer Lib \"user32\" ( _\n      ByVal HWnd As Long, _\n      ByVal nIDEvent As Long, _\n      ByVal uElapse As Long, _\n      ByVal lpTimerFunc As Long _\n   ) As Long\n\nPrivate Declare Function KillTimer Lib \"user32\" ( _\n      ByVal HWnd As Long, _\n      ByVal nIDEvent As Long _\n   ) As Long\n\nPrivate mCalculatedCells As Collection\nPrivate mWindowsTimerID As Long\nPrivate mApplicationTimerTime As Date\n\n'Non-Volatile Function2\nPublic Function sumTwoNumbers(Optional ByVal param1 As Integer _\n                    , Optional ByVal param2 As Integer _\n                     ) As Variant\n\n    sumTwoNumbers = param1 + param2\n    outputGlobal = sumTwoNumbers\n    sumTwoNumbers = \"Success\"\n\n    'Cache the caller's reference so it can be dealt with in a non-UDF routine\n   If mCalculatedCells Is Nothing Then Set mCalculatedCells = New Collection\n   On Error Resume Next\n   mCalculatedCells.Add Application.Caller, Application.Caller.Address\n   On Error GoTo 0\n\n   ' Setting/resetting the timer should be the last action taken in the UDF\n   If mWindowsTimerID &lt;&gt; 0 Then KillTimer 0&amp;, mWindowsTimerID\n   mWindowsTimerID = SetTimer(0&amp;, 0&amp;, 1, AddressOf AfterUDFRoutine1_sumTwoNumbers)\n\nEnd Function\n\nPublic Sub AfterUDFRoutine1_sumTwoNumbers()\n\n' This is the first of two timer routines. This one is called by the Windows\n' timer. Since a Windows timer cannot run code if a cell is being edited or a\n' dialog is open this routine schedules a second safe timer using\n' Application.OnTime which is ignored in a UDF.\n\n   ' Stop the Windows timer\n   On Error Resume Next\n   KillTimer 0&amp;, mWindowsTimerID\n   On Error GoTo 0\n   mWindowsTimerID = 0\n\n   ' Cancel any previous OnTime timers\n   If mApplicationTimerTime &lt;&gt; 0 Then\n      On Error Resume Next\n      Application.OnTime mApplicationTimerTime, \"AfterUDFRoutine2_sumTwoNumbers\", , False\n      On Error GoTo 0\n   End If\n\n   ' Schedule timer\n   mApplicationTimerTime = Now\n   Application.OnTime mApplicationTimerTime, \"AfterUDFRoutine2_sumTwoNumbers\"\n\nEnd Sub\n\nPublic Sub AfterUDFRoutine2_sumTwoNumbers()\n\n' This is the second of two timer routines. Because this timer routine is\n' triggered by Application.OnTime it is safe, i.e., Excel will not allow the\n' timer to fire unless the environment is safe (no open model dialogs or cell\n' being edited).\n\n'Write the output to the sheet\nDim dest\nSet dest = ActiveCell.Offset(0, 1)\ndest.Value = outputGlobal\nSet outputGlobal = Nothing\n\nEnd Sub\n</code></pre>\n\n<p>Progress so far</p>\n\n<p>I have found that the Insert Function Wizard runs your function in the background after each time you fill an input parameter, and outputs the result after the '=' you see in the Wizard. Therefore, if there is an error that is triggered when you run your function with an insufficient number of parameters, that error will also be triggered after you provide the input in the Wizard. If a message box is displayed when you run your function with that number of inputs, a message box will be displayed in front of the Wizard. However, when you are using an UDF modified in order to write the output in a different cell from which it was called and no error is triggered when filling the inputs by the Wizard, excel will break. My guess is that this happens because your function runs in the background, triggering AfterUDFRoutine1_sumTwoNumbers(), then triggering AfterUDFRoutine2_sumTwoNumbers(). When AfterUDFRoutine2_sumTwoNumbers() finally tries to write in the excel Spreadsheet and the Wizard is open, excel breaks because you cannot write in a cell with the Wizard open. One obvious solution for this problem is finding a way to make the Insert Function Wizard stops running the function in the background after each input parameter is provided and make it wait till run the function after you click \"OK\".</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "edited": false, "score": 0, "creation_date": 1444870311, "post_id": 33137282, "comment_id": 54087405, "body": "Your slicer is associated with a normal Pivot table or a with Power Pivot?"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1444896731, "post_id": 33137282, "comment_id": 54096336, "body": "Perhaps you could post the code that didn&#39;t work?"}, {"owner": {"reputation": 23, "user_id": 5447248, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0uFV9.jpg?s=128&g=1", "display_name": "Droz", "link": "https://stackoverflow.com/users/5447248/droz"}, "edited": false, "score": 0, "creation_date": 1444925526, "post_id": 33137282, "comment_id": 54116276, "body": "This is Power Pivot. The data source is a SQL data cube. I suspect that is part of the issue."}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 5447248, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0uFV9.jpg?s=128&g=1", "display_name": "Droz", "link": "https://stackoverflow.com/users/5447248/droz"}, "edited": false, "score": 0, "creation_date": 1444925933, "post_id": 33139399, "comment_id": 54116523, "body": "Thank you for your reply. This matches code I&#39;ve tried to use previously, but I&#39;m stuck with the same issue as method one above. It errors out whenever I try to use &#39;SlicerItems&#39;. I get a Run-time error &#39;1004&#39; at the first line in your solution. Is it possible this is because I&#39;m using Power Pivot?"}, {"owner": {"reputation": 61, "user_id": 5446655, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a82a74858fc7f09ac8d31f49caa496d?s=128&d=identicon&r=PG&f=1", "display_name": "Jess-eye-ca", "link": "https://stackoverflow.com/users/5446655/jess-eye-ca"}, "reply_to_user": {"reputation": 23, "user_id": 5447248, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0uFV9.jpg?s=128&g=1", "display_name": "Droz", "link": "https://stackoverflow.com/users/5447248/droz"}, "edited": false, "score": 0, "creation_date": 1444930607, "post_id": 33139399, "comment_id": 54119107, "body": "That is possible. I tested my solution with a regular piovt table."}], "tags": [], "owner": {"reputation": 61, "user_id": 5446655, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a82a74858fc7f09ac8d31f49caa496d?s=128&d=identicon&r=PG&f=1", "display_name": "Jess-eye-ca", "link": "https://stackoverflow.com/users/5446655/jess-eye-ca"}, "is_accepted": false, "score": 0, "last_activity_date": 1444879968, "creation_date": 1444879968, "answer_id": 33139399, "question_id": 33137282, "link": "https://stackoverflow.com/questions/33137282/programmatically-select-todays-date-on-slicer/33139399#33139399", "title": "Programmatically select today&#39;s date on Slicer", "body": "<p>Selecting a single slicer item, is the opposite of what you expect. Instead of selecting today, you need to deselect all of the other dates.</p>\n\n<p>Give this code a try.\nReplace \"Slicer_Date\" with your cache's name, and change the date format to match your data.</p>\n\n<pre><code>Dim i As Integer\n\nFor i = 1 To ActiveWorkbook.SlicerCaches(\"Slicer_Date\").SlicerItems.Count 'looping through all items\n    If ActiveWorkbook.SlicerCaches(\"Slicer_Date\").SlicerItems(i).Value &lt;&gt; Format(Now(), \"mm/dd/yyyy\") Then 'if date doesn't match then\n        ActiveWorkbook.SlicerCaches(\"Slicer_Date\").SlicerItems(i).Selected = False 'deselects all other dates\n    End If\nNext i\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 5447248, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0uFV9.jpg?s=128&g=1", "display_name": "Droz", "link": "https://stackoverflow.com/users/5447248/droz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 986, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1522649267, "creation_date": 1444864748, "last_edit_date": 1522649267, "question_id": 33137282, "link": "https://stackoverflow.com/questions/33137282/programmatically-select-todays-date-on-slicer", "title": "Programmatically select today&#39;s date on Slicer", "body": "<p>I need to choose a slicer item for today's date via VBA. I have tried two methods:</p>\n\n<ol>\n<li><p>Using the SlicerItems method, but SlicerItems causes a </p>\n\n<blockquote>\n  <p>Run-time error '1004': Application-defined or object-define error </p>\n</blockquote>\n\n<p>error message, even when I use the simplest version:</p>\n\n<pre><code>ActiveWorkbook.SlicerCaches(1).SlicerItems(1).Selected = True\n</code></pre>\n\n<p>I have tried every variation on this that I can, including specifying the cache by name, but I always get the same error.</p></li>\n<li><p>I recorded a macro, which generates a line that does run, and selects the specific slicer item:</p>\n\n<pre><code>ActiveWorkbook.SlicerCaches(\"&lt;NAME&gt;\").VisibleSlicerItemsList = Array(\"[VCC IntervalDate].[Hierarchy].[Year Number].&amp;[2015].&amp;[October].&amp;[2015-10-13T00:00:00]\")\n</code></pre>\n\n<p>I am then able to use a variable to modify the [2015] and [October] values in the array and have a successful result. However I am unable to modify [2015-10-13T00:00:00] using a variable. It returns an OLAP error. </p>\n\n<p>If I modify that value manually to the date I need, and it matches the year/month values set via the variable, it works fine:</p>\n\n<pre><code>ActiveWorkbook.SlicerCaches(\"Slicer_VCC_IntervalDate.Hierarchy\").VisibleSlicerItemsList = Array(\"[VCC IntervalDate].[Hierarchy].[Year Number].&amp;[\" &amp; Year(d) &amp; \"].&amp;[\" &amp; Month(d) &amp; \"].&amp;[2015-10-14T00:00:00]\") \n</code></pre></li>\n</ol>\n\n<p>I have verified the format of the variable outputs the correct format to match <code>2015-10-14T00:00:00</code>, but it does not accept it. I've also tried to modify only the date portion and manually input the <code>T00:00:00</code> section, but that didn't work either. </p>\n\n<p>So I'm officially stumped and welcome any help.</p>\n"}, {"tags": ["vba", "excel", "powerpivot"], "comments": [{"owner": {"reputation": 3513, "user_id": 4382919, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xvBse.jpg?s=128&g=1", "display_name": "greggyb", "link": "https://stackoverflow.com/users/4382919/greggyb"}, "edited": false, "score": 0, "creation_date": 1444868460, "post_id": 33136876, "comment_id": 54086992, "body": "Is there a specific reason you can&#39;t use the built-in drill down and drill up buttons in the pivot table Analyze ribbon menu?"}, {"owner": {"reputation": 407, "user_id": 3931046, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jsanf.png?s=128&g=1", "display_name": "cryocaustik", "link": "https://stackoverflow.com/users/3931046/cryocaustik"}, "reply_to_user": {"reputation": 3513, "user_id": 4382919, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xvBse.jpg?s=128&g=1", "display_name": "greggyb", "link": "https://stackoverflow.com/users/4382919/greggyb"}, "edited": false, "score": 0, "creation_date": 1444922291, "post_id": 33136876, "comment_id": 54114059, "body": "@greggyb We are trying to create a module that would lock out all other menus when a user opens the Excel file. Given that the user base for this product is in experienced with a lot of the newer features, the alternative would be for us to go around and train every user on how to drill up and down. If we are successful at making these buttons, we will be able to lock all other areas down and give the user only the ability to use the features we provided."}, {"owner": {"reputation": 3513, "user_id": 4382919, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xvBse.jpg?s=128&g=1", "display_name": "greggyb", "link": "https://stackoverflow.com/users/4382919/greggyb"}, "edited": false, "score": 1, "creation_date": 1444922682, "post_id": 33136876, "comment_id": 54114342, "body": "Have you recorded macros of using the drill up/down menu buttons, because they do exactly what you want - you should be able to get what you need from the behavior of those buttons and modify minimally. They are cell-selection-sensitive"}, {"owner": {"reputation": 407, "user_id": 3931046, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jsanf.png?s=128&g=1", "display_name": "cryocaustik", "link": "https://stackoverflow.com/users/3931046/cryocaustik"}, "reply_to_user": {"reputation": 3513, "user_id": 4382919, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xvBse.jpg?s=128&g=1", "display_name": "greggyb", "link": "https://stackoverflow.com/users/4382919/greggyb"}, "edited": false, "score": 0, "creation_date": 1444923333, "post_id": 33136876, "comment_id": 54114789, "body": "@greggyb that is actually how I was able to discover the above logic; I used the record feature to identify how the drill up/down features were referenced. Unfortunately as you said, the record feature is cell selection sensitive, which is why I was hoping there is a way to specify the selection prior to execution."}, {"owner": {"reputation": 3513, "user_id": 4382919, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xvBse.jpg?s=128&g=1", "display_name": "greggyb", "link": "https://stackoverflow.com/users/4382919/greggyb"}, "edited": false, "score": 1, "creation_date": 1444923871, "post_id": 33136876, "comment_id": 54115155, "body": "Ah, I see now. Unfortunately VBA is not where I spend most of my play-time. Can you just do some arithmetic on the row number of the active cell, since you know where in the sheet PivotLines(1) is - it&#39;s anchored at the top of the report."}], "answers": [{"comments": [{"owner": {"reputation": 9938, "user_id": 700206, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/jYx9d.jpg?s=128&g=1", "display_name": "whitneyland", "link": "https://stackoverflow.com/users/700206/whitneyland"}, "edited": false, "score": 0, "creation_date": 1489051973, "post_id": 33314078, "comment_id": 72505632, "body": "Nice.  Can it be done using DAX instead so it would work with Power BI?"}, {"owner": {"reputation": 407, "user_id": 3931046, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jsanf.png?s=128&g=1", "display_name": "cryocaustik", "link": "https://stackoverflow.com/users/3931046/cryocaustik"}, "reply_to_user": {"reputation": 9938, "user_id": 700206, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/jYx9d.jpg?s=128&g=1", "display_name": "whitneyland", "link": "https://stackoverflow.com/users/700206/whitneyland"}, "edited": false, "score": 0, "creation_date": 1489053830, "post_id": 33314078, "comment_id": 72506901, "body": "@Lee if you are going to be hosting this on a power pivot enabled library, you can use the standard hierarchy drilling methods. That being said, I do not think you would be able to create custom functions using dax alone."}, {"owner": {"reputation": 9938, "user_id": 700206, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/jYx9d.jpg?s=128&g=1", "display_name": "whitneyland", "link": "https://stackoverflow.com/users/700206/whitneyland"}, "edited": false, "score": 0, "creation_date": 1491770145, "post_id": 33314078, "comment_id": 73688131, "body": "This is possible in Power BI, I&#39;ve got it working nicely.  Hope to follow up with more info but others should not be discouraged."}, {"owner": {"reputation": 407, "user_id": 3931046, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jsanf.png?s=128&g=1", "display_name": "cryocaustik", "link": "https://stackoverflow.com/users/3931046/cryocaustik"}, "reply_to_user": {"reputation": 9938, "user_id": 700206, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/jYx9d.jpg?s=128&g=1", "display_name": "whitneyland", "link": "https://stackoverflow.com/users/700206/whitneyland"}, "edited": false, "score": 0, "creation_date": 1491770762, "post_id": 33314078, "comment_id": 73688382, "body": "@Lee that is awesome; you should post your solution if there are no posts explaining it."}], "tags": [], "owner": {"reputation": 407, "user_id": 3931046, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jsanf.png?s=128&g=1", "display_name": "cryocaustik", "link": "https://stackoverflow.com/users/3931046/cryocaustik"}, "is_accepted": true, "score": 1, "last_activity_date": 1445656358, "last_edit_date": 1445656358, "creation_date": 1445655777, "answer_id": 33314078, "question_id": 33136876, "link": "https://stackoverflow.com/questions/33136876/drill-up-down-using-buttons/33314078#33314078", "title": "Drill Up/Down using buttons", "body": "<p>After dedicating some time to this and getting some ideas from some friends, I was able to write the code that allows you to create custom buttons that will Drill Down, Drill Up and Drill to Top of your pivot hierarchy. </p>\n\n<p>I am by no means an expert in VBA and am open to suggestions on ways to improve this. I found this code to be extremely useful for the product I was making, so I thought I would share in an effort to give something back to the community.</p>\n\n<p>I designed code to be as simple as possible and to be able to reuse the code with minimal modifications; therefore I use a naming prefix of \"Lvl\" and numbered the levels 1-4 (however I coded it so that you could specify your own custom prefix as well). \nGiven that you are able to rename your fields in the actual pivot table without affecting the back end, the hierarchy prefix will not cause any customization issues. </p>\n\n<p>Last note: there are a few sections that need user input of your prefixes, table names, etc. and are marked with \"User entry needed\". Also, this was developed using the AdventureWorks SQL sample database (excel connected to SQL via power query and pulled the data into the Excel data model). </p>\n\n<p>Please feel free to ask if you have any questions and I hope this helps! </p>\n\n<pre><code>Sub DrillDown()\nOn Error GoTo ErrorHandler\n'This code was developed by stackoverflow user CITYINBETWEEN and was posted on the stackoverflow \n'forums for everyone to use free of charge and is not to be sold to others.   \n'\n' Drill Down Macro\n'\n    Dim HrchyPreFix, HrchyLstLvl, MyCurrLocation, MyPivTblName, MyDrillTo\n    '---------- User Entry Needed ----------'\n    ' prefix used for hierarchy levels\n    HrchyPreFix = \"Lvl\"\n    ' set hierarchy last drill down level\n    HrchyLstLvl = \"4\"\n    '---------- End of User Entry ----------'\n\n    ' set pivot table name of active cell\n    MyPivTblName = ActiveCell.PivotTable\n    ' set pivot field selected of active cell\n    MyCurrLocation = ActiveCell.PivotCell.PivotField\n    ' set what hierarchy lvl to drill down to\n    MyDrillTo = ActiveCell.PivotCell.PivotItem\n\n    ' find current hierarchy lvl of active cell. if at the last lvl, if statement goes to BottomOfDrillDownHandler\n    HrchyCurrLvl = (Right(Left(Mid(ActiveCell.PivotField, InStr(1, ActiveCell.PivotField, HrchyPreFix)), 4), 1))\n    ' If at last hierarchy lvl, go to BottomOfDrillDownHandler\n    If HrchyCurrLvl = HrchyLstLvl Then\n        GoTo BottomOfDrillDownHandler\n    End If\n\n    ' drill down code\n    ActiveSheet.PivotTables(MyPivTblName).DrillDown ActiveSheet.PivotTables( _\n        MyPivTblName).PivotFields(MyCurrLocation).PivotItems(MyDrillTo), _\n        ActiveSheet.PivotTables(MyPivTblName).PivotRowAxis.PivotLines(1)\n    Exit Sub\n\n' Error handler for when you cannot drill down any further\nBottomOfDrillDownHandler:\n    Dim ErrMsg1, ErrTitle1\n    ErrMsg1 = \"Unable to Drill Down any further as you're at the bottom of the Drill Down\"\n    ErrTitle1 = \"Drill Down Error\"\n    MsgBox ErrMsg1, , ErrTitle1\n    Exit Sub\n\n' general error handler\nErrorHandler:\n    Dim ErrMsg2, ErrTitle2, ErrMsg3, ErrTitle3\n    If Err.Number = 1004 Then\n        ErrMsg2 = \"Please select a drillable item\"\n        ErrTitle2 = \"Drill Down Error\"\n        MsgBox ErrMsg2, , ErrTitle2\n    ElseIf Err.Number &lt;&gt; 0 Then\n        ErrMsg3 = \"Error # \" &amp; Str(Err.Number) &amp; \" was generated by \" _\n            &amp; Err.Source &amp; Chr(13) &amp; \"Error Line: \" &amp; Erl &amp; Chr(13) &amp; Err.Description\n        ErrTitle3 = \"Error\"\n    MsgBox ErrMsg3, , ErrTitle3, Err.HelpFile, Err.HelpContext\n    End If\nEnd Sub\n\n'--------------------------------------------------------------------\nSub DrillUp()\nOn Error GoTo ErrorHandler\n'This code was developed by stackoverflow user CITYINBETWEEN and was posted on the stackoverflow \n'forums for everyone to use free of charge and is not to be sold to others.   \n'\n' Drill Up 1 level Macro\n'\n    Dim PwrPivTblNm, HrchyNm, HrchyPreFix, HrchyTopLvl, MyCurrLocation, MyPivTblName, MyDrillTo, MyCurrLvl, HrchyPrevLvl As Integer\n\n    '---------- User Entry Needed ----------'\n    ' Name of table in powerpivot where the hierarchy exists\n    PwrPivTblNm = \"vEmployeeDepartment\"\n    ' name given to hierarchy in powerpivot\n    HrchyNm = \"Hierarchy1\"\n    ' prefix used for hierarchy levels\n    HrchyPreFix = \"Lvl\"\n    ' set top hierarchy level\n    HrchyTopLvl = \"1\"\n    '---------- End of User Entry ----------'\n\n    ' set pivot table name of active cell\n    MyPivTblName = ActiveCell.PivotTable\n    ' set pivot field selected of active cell\n    MyCurrLocation = ActiveCell.PivotCell.PivotField\n    ' set from what hierarchy lvl to drill up from\n    MyDrillUpFrom = ActiveCell.PivotCell.PivotItem\n    ' find prev. hierarchy lvl of active cell\n    HrchyPrevLvl = (Right(Left(Mid(ActiveCell.PivotField, InStr(1, ActiveCell.PivotField, HrchyPreFix)), 4), 1) - 1)\n\n    ' find current hierarchy lvl of active cell. if at the top lvl, if statement goes to TopOfDrillUpHandler\n    HrchyCurrLvl = (Right(Left(Mid(ActiveCell.PivotField, InStr(1, ActiveCell.PivotField, HrchyPreFix)), 4), 1))\n    ' If at last hierarchy lvl, go to TopOfDrillUpHandler\n    If HrchyCurrLvl = HrchyTopLvl Then\n        GoTo TopOfDrillUpHandler\n    End If\n\n    ' set hierarchy level to drill up to\n    HrchyLvlDrillTo = \"[\" &amp; PwrPivTblNm &amp; \"].[\" &amp; HrchyNm &amp; \"].[\" &amp; _\n                    Mid(ActiveCell.PivotField, InStr(1, ActiveCell.PivotField, HrchyPreFix), 3) &amp; HrchyPrevLvl _\n                    &amp; \"]\"\n\n    ' drill up code\n    ActiveSheet.PivotTables(MyPivTblName).DrillUp ActiveSheet.PivotTables( _\n        MyPivTblName).PivotFields(MyCurrLocation).PivotItems(MyDrillUpFrom), _\n        ActiveSheet.PivotTables(MyPivTblName).PivotRowAxis.PivotLines(1), HrchyLvlDrillTo\n    Exit Sub\n\n' Error handler for when you cannot drill up any further\nTopOfDrillUpHandler:\n    Dim ErrMsg1, ErrTitle1\n    ErrMsg1 = \"Unable to Drill Up any further as you're at the top of the Drill Up\"\n    ErrTitle1 = \"Drill Up Error\"\n    MsgBox ErrMsg1, , ErrTitle1\n    Exit Sub\n\n' General Error handler\nErrorHandler:\n    Dim ErrMsg2, ErrTitle2, ErrMsg3, ErrTitle3\n    If Err.Number = 1004 Then\n        ErrMsg2 = \"Please select a drillable item\"\n        ErrTitle2 = \"Drill Up Error\"\n        MsgBox ErrMsg2, , ErrTitle2\n    ElseIf Err.Number &lt;&gt; 0 Then\n        ErrMsg3 = \"Error # \" &amp; Str(Err.Number) &amp; \" was generated by \" _\n            &amp; Err.Source &amp; Chr(13) &amp; \"Error Line: \" &amp; Erl &amp; Chr(13) &amp; Err.Description\n        ErrTitle3 = \"Error\"\n    MsgBox ErrMsg3, , ErrTitle3, Err.HelpFile, Err.HelpContext\n    End If\nEnd Sub\n\n\n'--------------------------------------------------------------------\nSub DrillToTop()\nOn Error GoTo ErrorHandler\n'This code was developed by stackoverflow user CITYINBETWEEN and was posted on the stackoverflow \n'forums for everyone to use free of charge and is not to be sold to others.   \n'\n' Dill To Top Macro Macro\n'\n    Dim PwrPivTblNm, HrchyNm, HrchyPreFix, HrchyTopLvl, MyCurrLocation, MyPivTblName, MyDrillTo\n\n    '---------- User Entry Needed ----------'\n    ' Name of table in powerpivot where the hierarchy exists\n    PwrPivTblNm = \"vEmployeeDepartment\"\n    ' name given to hierarchy in powerpivot\n    HrchyNm = \"Hierarchy1\"\n    ' prefix used for hierarchy levels\n    HrchyPreFix = \"Lvl\"\n    ' set top hierarchy level\n    HrchyTopLvl = \"1\"\n    '---------- End of User Entry ----------'\n\n    ' set pivot table name of active cell\n    MyPivTblName = ActiveCell.PivotTable\n    ' set pivot field selected of active cell\n    MyCurrLocation = ActiveCell.PivotCell.PivotField\n    ' set from what hierarchy lvl to drill up from\n    MyDrillUpFrom = ActiveCell.PivotCell.PivotItem\n\n    ' find prev. hierarchy lvl of active cell. if already at top lvl, if statement goes to AlreadyAtTopHandler\n    HrchyPrevLvl = (Right(Left(Mid(ActiveCell.PivotField, InStr(1, ActiveCell.PivotField, \"Lvl\")), 4), 1) - 1)\n    ' If at hierarchy lvl 1, go to TopOfDrillUpHandler\n    If HrchyPrevLvl = \"0\" Then\n        GoTo AlreadyAtTopHandler\n    End If\n\n    ' set top hierarchy level to drill up to\n    HrchyLvlDrillTo = \"[\" &amp; PwrPivTblNm &amp; \"].[\" &amp; HrchyNm &amp; \"].[\" &amp; _\n                    Mid(ActiveCell.PivotField, InStr(1, ActiveCell.PivotField, HrchyPreFix), 3) &amp; HrchyTopLvl _\n                    &amp; \"]\"\n\n    ' drill to top code\n    ActiveSheet.PivotTables(MyPivTblName).DrillUp ActiveSheet.PivotTables( _\n        MyPivTblName).PivotFields(MyCurrLocation).PivotItems(MyDrillUpFrom), _\n        ActiveSheet.PivotTables(MyPivTblName).PivotRowAxis.PivotLines(1), _\n        HrchyLvlDrillTo\n    Exit Sub\n\n' Error handler for when user is already at the top level\nAlreadyAtTopHandler:\n    Dim ErrMsg1, ErrTitle1\n    ErrMsg1 = \"Unable to Drill to Top as you're already at the top level\"\n    ErrTitle1 = \"Drill to Top Error\"\n    MsgBox ErrMsg1, , ErrTitle1\n    Exit Sub\n\n' General Error handler\nErrorHandler:\n    Dim ErrMsg2, ErrTitle2, ErrMsg3, ErrTitle3\n    If Err.Number = 1004 Then\n        ErrMsg2 = \"Please select a drillable item\"\n        ErrTitle2 = \"Drill to Top Error\"\n        MsgBox ErrMsg2, , ErrTitle2\n    ElseIf Err.Number &lt;&gt; 0 Then\n        ErrMsg3 = \"Error # \" &amp; Str(Err.Number) &amp; \" was generated by \" _\n            &amp; Err.Source &amp; Chr(13) &amp; \"Error Line: \" &amp; Erl &amp; Chr(13) &amp; Err.Description\n        ErrTitle3 = \"Error\"\n    MsgBox ErrMsg3, , ErrTitle3, Err.HelpFile, Err.HelpContext\n    End If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 407, "user_id": 3931046, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jsanf.png?s=128&g=1", "display_name": "cryocaustik", "link": "https://stackoverflow.com/users/3931046/cryocaustik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2226, "favorite_count": 0, "accepted_answer_id": 33314078, "answer_count": 1, "score": 1, "last_activity_date": 1445656358, "creation_date": 1444862473, "last_edit_date": 1444929371, "question_id": 33136876, "link": "https://stackoverflow.com/questions/33136876/drill-up-down-using-buttons", "title": "Drill Up/Down using buttons", "body": "<p>I am attempting to create some command buttons that would allow a user to drill down and up in a Power-pivot hierarchy. I have been able to generate the code that drills down when I reference a specific line on the sheet, but I have been unable to adjust it to drill down/p based on the line/cell the user has selected.</p>\n\n<p>Is it possible to change <code>.PivotRowAxis.PivotLines(1)</code> to something like <code>.ActiveCell</code>?</p>\n\n<p>My full code:</p>\n\n<pre><code>Sub DrillDown()\nOn Error GoTo ErrorHandler\n\n    ActiveSheet.PivotTables(\"PivotTable1\").DrillDown ActiveSheet.PivotTables( _\n        \"PivotTable1\").PivotFields(\"[Data].[Dive1].[ASSIGNEDTO]\").PivotItems( _\n        \"[Data].[Dive1].[ASSIGNEDTO].&amp;[Adjustment, MyDB]\"), ActiveSheet.PivotTables( _\n        \"PivotTable1\").PivotRowAxis.PivotLines(1)\n    Exit Sub\n\nErrorHandler:\n    Dim Msg, Style, Title, Notify\n    Msg = \"Unable to Drill Down any further\"\n    Style = vbError\n    Title = \"Drll Down Error\"\n    Notify = MsgBox(Msg, Style, Title)\n\n\nEnd Sub\n\nSub DrillUp()\nOn Error GoTo ErrorHandler\n\n    ActiveSheet.PivotTables(\"PivotTable1\").DrillUp ActiveSheet.PivotTables( _\n        \"PivotTable1\").PivotFields(\"[Data].[Dive1].[ClientID]\").PivotItems( _\n        \"[Data].[Dive1].[ASSIGNEDTO].&amp;[Adjustment, MYDB].&amp;[QMMX123]\"), _\n        ActiveCell.Select\n    Exit Sub\n\nErrorHandler:\n    Dim Msg, Style, Title, Notify\n    Msg = \"Unable to Up any further\"\n    Style = vbError\n    Title = \"Drill Up Error\"\n    Notify = MsgBox(Msg, Style, Title)\n\n\nEnd Sub\n</code></pre>\n\n<p>Thanks for any help in advance! </p>\n"}, {"tags": ["vba", "excel", "infinite-loop"], "comments": [{"owner": {"reputation": 371, "user_id": 1943079, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/48ee4e6cb6918afbe4294c4c8f4a99d1?s=128&d=identicon&r=PG", "display_name": "user1943079", "link": "https://stackoverflow.com/users/1943079/user1943079"}, "reply_to_user": {"reputation": 28153, "user_id": 2521004, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/U6sn4.png?s=128&g=1", "display_name": "Automate This", "link": "https://stackoverflow.com/users/2521004/automate-this"}, "edited": false, "score": 0, "creation_date": 1444859373, "post_id": 33135949, "comment_id": 54083933, "body": "updated the question, and no none of them seem to work for me"}, {"owner": {"reputation": 9743, "user_id": 2127508, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24b1d5bcb39ec4baad76d20c66506318?s=128&d=identicon&r=PG", "display_name": "barrowc", "link": "https://stackoverflow.com/users/2127508/barrowc"}, "edited": false, "score": 0, "creation_date": 1444860030, "post_id": 33135949, "comment_id": 54084240, "body": "What triggers the query to pull in more data? Is it in a loop or does it use &quot;Application.OnTime&quot; or something else?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1444860898, "post_id": 33135949, "comment_id": 54084583, "body": "Are you pulling in ~20-24 columns of data? 2 hours worth of 10 second intervals would try and push columns off the right end of the worksheet if each new data was inserting itself instead of overwriting the existing data."}, {"owner": {"reputation": 371, "user_id": 1943079, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/48ee4e6cb6918afbe4294c4c8f4a99d1?s=128&d=identicon&r=PG", "display_name": "user1943079", "link": "https://stackoverflow.com/users/1943079/user1943079"}, "edited": false, "score": 0, "creation_date": 1444915659, "post_id": 33135949, "comment_id": 54108975, "body": "No, all the new data always overwrites the old."}], "owner": {"reputation": 371, "user_id": 1943079, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/48ee4e6cb6918afbe4294c4c8f4a99d1?s=128&d=identicon&r=PG", "display_name": "user1943079", "link": "https://stackoverflow.com/users/1943079/user1943079"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 3154, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1444860624, "creation_date": 1444858287, "last_edit_date": 1444859343, "question_id": 33135949, "link": "https://stackoverflow.com/questions/33135949/exception-code-c0000005-in-ms-excel", "title": "Exception code c0000005 in MS Excel", "body": "<p>So I have a excel macro-enabled sheet (.xlsm) in excel 2010 that pulls in data every 10 seconds through a query that I run in vba. They data is not on a SQL server which is why I am using vba to pull the data. The sheet works fine initially and then it crashes after ~2 hours or so with a popup saying \"Microsoft excel has stopped working\" and when i click on \"problem details\", i see the following,</p>\n\n<pre><code>Problem signature:\n  Problem Event Name:                        APPCRASH\n  Application Name:                             EXCEL.EXE\n  Application Version:                           14.0.6024.1000\n  Application Timestamp:                     4d83e39d\n  Fault Module Name:                          EXCEL.EXE\n  Fault Module Version:                        14.0.6024.1000\n  Fault Module Timestamp:                  4d83e39d\n  Exception Code:                                  c0000005\n  Exception Offset:                                0000000000286885\n  OS Version:                                          6.1.7601.2.1.0.18.10\n  Locale ID:                                             1033\n\nAdditional information about the problem:\n  LCID:                                                     1033\n  skulcid:                                                 1033\n</code></pre>\n\n<p>Can anyone help me with this issue?</p>\n"}, {"tags": ["vba", "excel", "runtime-error", "series"], "comments": [{"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1444858603, "post_id": 33135848, "comment_id": 54083589, "body": "<code>worksheet</code> has got to be the worst name for a worksheet XD"}, {"owner": {"reputation": 31, "user_id": 5442280, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/969716017bde0add7955ff1de9f66350?s=128&d=identicon&r=PG&f=1", "display_name": "Brad B", "link": "https://stackoverflow.com/users/5442280/brad-b"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1444914413, "post_id": 33135848, "comment_id": 54108025, "body": "Absolutely right, I have changed it to &quot;Master&quot;"}], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 5442280, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/969716017bde0add7955ff1de9f66350?s=128&d=identicon&r=PG&f=1", "display_name": "Brad B", "link": "https://stackoverflow.com/users/5442280/brad-b"}, "edited": false, "score": 0, "creation_date": 1444940589, "post_id": 33136561, "comment_id": 54124569, "body": "Unfortunately it now gives me a error: of &#39;424&#39; It does not compile correctly the      Source.Copy  Command correctly"}, {"owner": {"reputation": 839, "user_id": 5395134, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/egIIe.png?s=128&g=1", "display_name": "Demetri", "link": "https://stackoverflow.com/users/5395134/demetri"}, "reply_to_user": {"reputation": 31, "user_id": 5442280, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/969716017bde0add7955ff1de9f66350?s=128&d=identicon&r=PG&f=1", "display_name": "Brad B", "link": "https://stackoverflow.com/users/5442280/brad-b"}, "edited": false, "score": 0, "creation_date": 1444943858, "post_id": 33136561, "comment_id": 54126237, "body": "It doesn&#39;t look like you set Source to anything?  Maybe you should eliminate that line and add a &quot;MyRange2.Copy&quot; after you finished setting the &quot;MyRange2&quot; range.  I guess it depends on what you are trying to copy?"}], "tags": [], "owner": {"reputation": 839, "user_id": 5395134, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/egIIe.png?s=128&g=1", "display_name": "Demetri", "link": "https://stackoverflow.com/users/5395134/demetri"}, "is_accepted": false, "score": 0, "last_activity_date": 1444861040, "creation_date": 1444861040, "answer_id": 33136561, "question_id": 33135848, "link": "https://stackoverflow.com/questions/33135848/copy-a-series-of-cell-into-multiple-worksheets-named-via-a-cell/33136561#33136561", "title": "Copy a series of cell into multiple worksheets named via a cell", "body": "<p>I think maybe for the below:</p>\n\n<pre><code>ThisWorkbook.Worksheets(i).Select (\"Worksheet\")\n</code></pre>\n\n<p>You actually wanted something like:</p>\n\n<pre><code>ThisWorkbook.Worksheets(Sheets.Count).Select \n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 5442280, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/969716017bde0add7955ff1de9f66350?s=128&d=identicon&r=PG&f=1", "display_name": "Brad B", "link": "https://stackoverflow.com/users/5442280/brad-b"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 77, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1444914377, "creation_date": 1444857878, "last_edit_date": 1444914377, "question_id": 33135848, "link": "https://stackoverflow.com/questions/33135848/copy-a-series-of-cell-into-multiple-worksheets-named-via-a-cell", "title": "Copy a series of cell into multiple worksheets named via a cell", "body": "<p>thank you for taking the time to look at my VBA macro. My goal with this macro is to copy a row of cells (e7:i7) to a duplicated workbook that has a template pasted in the worksheet and named via a series of cells (c7). Then repeating that process with the next row of cells (e8:i8) using (c8) as its name.</p>\n\n<p>I have the template worksheet duplication working, I have the worksheet naming working. My issue is copying the cells from \"Worksheet\" to the newly named worksheet that uses (c7)series as its name. </p>\n\n<p>I am getting</p>\n\n<blockquote>\n  <p>\"Run-time Error '9':\n  Subscript out of range</p>\n</blockquote>\n\n<p>I appreciate your help on this as this is my first VBA project.</p>\n\n<pre><code>Sub NEWSAVINGSTEST1()\n'\n' NEWSAVINGSTEST1 Macro\n'\nDim ws1 As Worksheet\nSet ws1 = ThisWorkbook.Worksheets(\"NEWSAVINGS\")\n\nDim MyCell As Range, MyRange As Range\n\nSet MyRange = Sheets(\"Master\").Range(\"c7\")\nSet MyRange = Range(MyRange, MyRange.End(xlDown))\n\nFor Each MyCell In MyRange\nSheets(\"NEWSAVINGS\").Select\nSheets(\"NEWSAVINGS\").Copy After:=Sheets(Sheets.Count) 'creates a new worksheet\n'ws1.Copy ThisWorkbook.Sheets(Sheets.Count)\nSheets(Sheets.Count).Name = MyCell.Value\n\nThisWorkbook.Worksheets(i).Select (\"Master\") ' just select the sheet\nSource.Copy\nSet MyRange2 = Sheets(\"Master\").Range(\"e7:l7\")\nSet MyRange2 = Range(MyRange, MyRange.End(xlDown))\nActiveSheet.Range(\"d11\").Select\nActiveSheet.Paste\n\nNext MyCell\n\n'\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "excel-formula", "vba"], "comments": [{"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1444858126, "post_id": 33135830, "comment_id": 54083364, "body": "You have been here long enough to know you need to show some code."}], "answers": [{"comments": [{"owner": {"reputation": 1811, "user_id": 3004041, "user_type": "registered", "accept_rate": 34, "profile_image": "https://www.gravatar.com/avatar/e9c675dd9408721a8e8e1106774a9d11?s=128&d=identicon&r=PG&f=1", "display_name": "covfefe", "link": "https://stackoverflow.com/users/3004041/covfefe"}, "edited": false, "score": 0, "creation_date": 1445028946, "post_id": 33136006, "comment_id": 54165990, "body": "Thanks so much! Now I&#39;m able to use the True/False values to filter the rows that I need :)"}], "tags": [], "owner": {"reputation": 72931, "user_id": 2538939, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/876f7ddaf27a16c17a62b8a9705b45f1?s=128&d=identicon&r=PG&f=1", "display_name": "Code Different", "link": "https://stackoverflow.com/users/2538939/code-different"}, "is_accepted": true, "score": 1, "last_activity_date": 1444858574, "creation_date": 1444858574, "answer_id": 33136006, "question_id": 33135830, "link": "https://stackoverflow.com/questions/33135830/function-to-check-if-two-values-in-a-column-are-equal-and-if-one-of-their-corres/33136006#33136006", "title": "Function to check if two values in a column are equal and if one of their corresponding row values is equal", "body": "<p>If both <code>Raw file</code> and <code>Sequences</code> on the current row are replicated, that also implies that the <code>Sequences</code> on the current row is duplicated elsewhere. Hence you can reduce it to only 1 criterion.</p>\n\n<p>Try this:</p>\n\n<pre><code>=COUNTIFS(A:A,A2,B:B,B2)&gt;1\n</code></pre>\n\n<p>I assume <code>Raw file</code> is in column A and <code>Sequences</code> is in column B. The other 2 are irrelevant because there are no criteria on them.</p>\n"}, {"tags": [], "owner": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "is_accepted": false, "score": 0, "last_activity_date": 1445050943, "creation_date": 1445050943, "answer_id": 33182281, "question_id": 33135830, "link": "https://stackoverflow.com/questions/33135830/function-to-check-if-two-values-in-a-column-are-equal-and-if-one-of-their-corres/33182281#33182281", "title": "Function to check if two values in a column are equal and if one of their corresponding row values is equal", "body": "<p>In Excel 2013 there does not seem to be the 15 character limit mentioned, so if filtering both columns for the appropriate colour repeated pairs may be selected.  </p>\n\n<p>An alternative might be to create a PivotTable and observe (or drill down on) values greater than <code>1</code>:  </p>\n\n<p><a href=\"https://i.stack.imgur.com/QxZjD.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/QxZjD.jpg\" alt=\"SO33135830 example\"></a></p>\n"}], "owner": {"reputation": 1811, "user_id": 3004041, "user_type": "registered", "accept_rate": 34, "profile_image": "https://www.gravatar.com/avatar/e9c675dd9408721a8e8e1106774a9d11?s=128&d=identicon&r=PG&f=1", "display_name": "covfefe", "link": "https://stackoverflow.com/users/3004041/covfefe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 688, "favorite_count": 0, "accepted_answer_id": 33136006, "answer_count": 2, "score": 0, "last_activity_date": 1445050943, "creation_date": 1444857791, "last_edit_date": 1531161705, "question_id": 33135830, "link": "https://stackoverflow.com/questions/33135830/function-to-check-if-two-values-in-a-column-are-equal-and-if-one-of-their-corres", "title": "Function to check if two values in a column are equal and if one of their corresponding row values is equal", "body": "<p>I have an Excel spreadsheet that contains <code>Raw file</code>s and <code>Sequences</code> as columns. I want to check the <code>Sequences</code> column to find any duplicate sequences and for all the duplicates to check that their <code>Raw file</code> is also the same. This is what it looks like:</p>\n\n<p>| Raw file  |  Sequences  | otherdata1 | otherdata2 |</p>\n\n<p>| HU_932 |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BLAST &nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;**&amp;<em>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</em>(&amp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|</p>\n\n<p>| WR_235 | &nbsp;&nbsp;&nbsp;&nbsp;HELLO&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#(@&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#@*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|</p>\n\n<p>| HU_932 |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BLAST&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#@(&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(#)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|</p>\n\n<p>| HU_932 |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CHART&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$&amp;@&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;%#*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|</p>\n\n<p>| RT_329 |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BLAST&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;^*)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@$#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|</p>\n\n<p>So in the example above, I want to be able to select only the first and third rows because those are the only rows in which the <code>Sequences</code> are the same and the <code>Raw file</code>s are the same. </p>\n\n<p>In my actual data, the sequence lengths are greater than 15 characters so I can't use the Excel conditional formatting for duplicates. I thought of using the EXACT and MATCH functions but I would also need to know the cell with which it matched in order to compare its <code>Raw file</code> with the matched cell's <code>Raw file</code>.</p>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1444858252, "post_id": 33135755, "comment_id": 54083424, "body": "Open Book1.xlsx to see the new worksheet created by your code."}, {"owner": {"reputation": 1100, "user_id": 5086917, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/63a26c304d80483549e5949c8de2f0c1?s=128&d=identicon&r=PG&f=1", "display_name": "apdm", "link": "https://stackoverflow.com/users/5086917/apdm"}, "reply_to_user": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1444858647, "post_id": 33135755, "comment_id": 54083608, "body": "Haha! Oh wow!  I would NOT have guessed that, thanks!  Along those lines....do you know of how to create a temporary table in this connection, as the <code>#</code> syntax I usually use in SQL is giving a syntax error, as is the <code>CREATE TEMPORARY [tbl1]</code> suggested on the MSDN page <a href=\"https://msdn.microsoft.com/en-us/library/bb177893(v=office.12).aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/bb177893(v=office.12).aspx</a>"}, {"owner": {"reputation": 1100, "user_id": 5086917, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/63a26c304d80483549e5949c8de2f0c1?s=128&d=identicon&r=PG&f=1", "display_name": "apdm", "link": "https://stackoverflow.com/users/5086917/apdm"}, "reply_to_user": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1444858978, "post_id": 33135755, "comment_id": 54083763, "body": "Actually it seems like Access doesn&#39;t support temp tables at all, contrary to what the MSDN page led me to believe"}, {"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1444859069, "post_id": 33135755, "comment_id": 54083813, "body": "Within Access there is no such thing as a temporary table, in the sense you may know about from other databases.  (The documentation is confusing on that point.)  If the provider and target database both support temporary tables, you can do it.  So my guess is it can&#39;t be done with Excel.  And if you want the &quot;temporary&quot; table to disappear after you&#39;re done with it, you must explicitly delete it."}], "answers": [{"tags": [], "owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "is_accepted": true, "score": 1, "last_activity_date": 1444860580, "last_edit_date": 1444860580, "creation_date": 1444859336, "answer_id": 33136175, "question_id": 33135755, "link": "https://stackoverflow.com/questions/33135755/querying-excel-file-through-ado-access-connection-where-are-tables-stored/33136175#33136175", "title": "Querying excel file through ADO Access connection, where are tables stored?", "body": "<p>When you open an ADO connection to an Excel workbook and then execute a <code>CREATE TABLE</code> statement, the \"table\" you create is a new worksheet.</p>\n\n<p>Open <em>Book1.xlsx</em> to see the worksheet created by your code.</p>\n\n<p>When I ran your code with Access 2010 and my workbook, the new sheet was named <em>_tbl</em>.  I don't understand why the name was prefixed with an underscore.  If that's an issue, you could rename the sheet afterward.</p>\n"}], "owner": {"reputation": 1100, "user_id": 5086917, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/63a26c304d80483549e5949c8de2f0c1?s=128&d=identicon&r=PG&f=1", "display_name": "apdm", "link": "https://stackoverflow.com/users/5086917/apdm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 78, "favorite_count": 0, "accepted_answer_id": 33136175, "answer_count": 1, "score": 1, "last_activity_date": 1444860580, "creation_date": 1444857548, "last_edit_date": 1444859437, "question_id": 33135755, "link": "https://stackoverflow.com/questions/33135755/querying-excel-file-through-ado-access-connection-where-are-tables-stored", "title": "Querying excel file through ADO Access connection, where are tables stored?", "body": "<p>Although I have queried Excel worksheets using an Access ADO connection before, I only thought of the ADO connection as abstract - that is, Access wasn't actually creating a table with my worksheet, and everything \"vanished\" once I closed the connection.</p>\n\n<p>My thinking changed when I tried explicitly creating a unique table for the first time, and even after closing the connection and exiting the sub, the table still existed somewhere.  Where in my directory is this table stored and aside from dropping the table through another VBA connection is there any other way to view/delete it?</p>\n\n<p>You can see what I mean if you run this sub twice.  The first time it works fine, and the 2nd time a message comes up saying the table already exists.</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Sub stquestion()\n\nDim acctcon As New ADODB.Connection\nDim acctrec As New ADODB.Recordset\n\nWith acctcon\n    .ConnectionString = \"Provider=Microsoft.ACE.OLEDB.12.0;Data Source=C:\\Users\\name\\Documents\\Book1.xlsx;\" &amp; _\n                            \"Extended Properties=\" &amp; Chr(34) &amp; \"Excel 12.0 Xml;HDR=YES\" &amp; Chr(34) &amp; \";\"\n    querystr = \"CREATE TABLE [tbl1] (cost Numeric(10));\"\n    .Open\n    .Execute querystr\n    .Close\nEnd With\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "validation"], "comments": [{"owner": {"reputation": 2062, "user_id": 1594166, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/37767b7a77ee53e1577c6e4cfdccb843?s=128&d=identicon&r=PG", "display_name": "AxGryndr", "link": "https://stackoverflow.com/users/1594166/axgryndr"}, "edited": false, "score": 0, "creation_date": 1444856920, "post_id": 33135357, "comment_id": 54082826, "body": "With the example on line 7 - are you trying to check every file extention to see if it exists? For example, does \\\\path\\file.bmp exist, if no check \\\\path\\file.csv etc?"}, {"owner": {"reputation": 181, "user_id": 2430498, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/c5597ca46f3288a73b4b4151b4537c39?s=128&d=identicon&r=PG", "display_name": "trueimage", "link": "https://stackoverflow.com/users/2430498/trueimage"}, "reply_to_user": {"reputation": 2062, "user_id": 1594166, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/37767b7a77ee53e1577c6e4cfdccb843?s=128&d=identicon&r=PG", "display_name": "AxGryndr", "link": "https://stackoverflow.com/users/1594166/axgryndr"}, "edited": false, "score": 0, "creation_date": 1444860098, "post_id": 33135357, "comment_id": 54084260, "body": "@AxGryndr no, I pass in two file paths. Long story short, the file will either be on \\\\server1\\path1\\file.txt or \\\\server2\\path2\\file.txt, the filename and path are not changed."}], "answers": [{"comments": [{"owner": {"reputation": 181, "user_id": 2430498, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/c5597ca46f3288a73b4b4151b4537c39?s=128&d=identicon&r=PG", "display_name": "trueimage", "link": "https://stackoverflow.com/users/2430498/trueimage"}, "edited": false, "score": 0, "creation_date": 1444933082, "post_id": 33136338, "comment_id": 54120321, "body": "Ok before noting the location, I&#39;ve added &quot;CreateSheetIf (Temp)&quot; to create the sheet for the categories if it doesn&#39;t exist yet."}, {"owner": {"reputation": 181, "user_id": 2430498, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/c5597ca46f3288a73b4b4151b4537c39?s=128&d=identicon&r=PG", "display_name": "trueimage", "link": "https://stackoverflow.com/users/2430498/trueimage"}, "edited": false, "score": 0, "creation_date": 1444933129, "post_id": 33136338, "comment_id": 54120343, "body": "But, the data always gets copied into row 2 (and it logs that it is in row 1) but it just keeps overwriting."}, {"owner": {"reputation": 181, "user_id": 2430498, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/c5597ca46f3288a73b4b4151b4537c39?s=128&d=identicon&r=PG", "display_name": "trueimage", "link": "https://stackoverflow.com/users/2430498/trueimage"}, "edited": false, "score": 0, "creation_date": 1444933591, "post_id": 33136338, "comment_id": 54120580, "body": "Ok I&#39;ve fixed that by adding the column headers when I create the new sheets. Thanks!"}], "tags": [], "owner": {"reputation": 839, "user_id": 5395134, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/egIIe.png?s=128&g=1", "display_name": "Demetri", "link": "https://stackoverflow.com/users/5395134/demetri"}, "is_accepted": true, "score": 1, "last_activity_date": 1444859985, "creation_date": 1444859985, "answer_id": 33136338, "question_id": 33135357, "link": "https://stackoverflow.com/questions/33135357/how-can-i-sort-and-split-my-validated-excel-data-into-sheets-with-vba/33136338#33136338", "title": "How Can I sort and split my validated Excel Data into Sheets with VBA?", "body": "<p>Perhaps you were looking for something like this:</p>\n\n<pre><code>Sub PrintResults()\n\n    Dim PathRange As Range, Temp As String, Cell As Range\n\n    ' Make sure at least one path exists, and if so, find the range.\n    On Error Resume Next\n    Set PathRange = Intersect(Sheets(\"input\").UsedRange, Sheets(\"input\").UsedRange.Offset(1), Range(\"E:E\"))\n    On Error GoTo 0\n    If PathRange Is Nothing Then Exit Sub\n\n    ' For every path\n    For Each Cell In PathRange\n\n        ' See if the path exists, and mark it, one way or another\n        Temp = FileExists(Cell.Text): Cell.Offset(0, 1).Value = Temp\n        If Temp = \"No Valid Path\" Then\n            ' Note errors\n            Temp = \"error\"\n            Else\n            ' If no error yet, then get size and extension\n            Cell.Offset(0, 2).Value = GetFileSize(Temp)\n            Temp = GetFileExt(Temp): Cell.Offset(0, 3).Value = Temp\n            ' If there is an error with the extension note it\n            If Temp = \"blank\" Then Temp = \"error\"\n        End If\n        If Temp = \"error\" Then Temp = \"bad data\"\n\n        ' Note the location (its equal to the usedrange.rows count, because of the title row)\n        Cell.Offset(0, 4).Value = \"\"\"\" &amp; Temp &amp; \"\"\" row \" &amp; Sheets(Temp).UsedRange.Rows.Count\n\n        ' Copy the data\n        Sheets(\"input\").Range(\"A\" &amp; Cell.Row, Cell).Copy\n        Sheets(Temp).Range(\"A1\").Offset(Sheets(Temp).UsedRange.Rows.Count).PasteSpecial Paste:=xlPasteAll\n        Application.CutCopyMode = False\n\n    Next Cell\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 181, "user_id": 2430498, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/c5597ca46f3288a73b4b4151b4537c39?s=128&d=identicon&r=PG", "display_name": "trueimage", "link": "https://stackoverflow.com/users/2430498/trueimage"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 114, "favorite_count": 0, "accepted_answer_id": 33136338, "answer_count": 1, "score": -1, "last_activity_date": 1444859985, "creation_date": 1444855867, "question_id": 33135357, "link": "https://stackoverflow.com/questions/33135357/how-can-i-sort-and-split-my-validated-excel-data-into-sheets-with-vba", "title": "How Can I sort and split my validated Excel Data into Sheets with VBA?", "body": "<p>I have a large amount of data in 5 columns. I need to do the following based on column E (file path):</p>\n\n<ul>\n<li>verify the path is valid, if not try a secondary path and return the correct one, or an error value if neither are valid</li>\n<li>if there is a valid path, get the file size (size should be >0 )</li>\n<li>if there is a valid path, get the file extension (there are lots of \"bad\" extensions like nothing at all, a period with nothing after it, pdf[1], pdf, etc...) I can create a whitelist for which are \"good\".</li>\n</ul>\n\n<p>Once this is complete, I need to make one new sheet per file extension, and copy over the first 4 columns plus the valid path into the 5th column. There should be a \"bad data\" sheet as well for everything that didn't get \"validated\" as per above. On the original sheet, if it would be possible to create another column mapping to the new location of that row it would be great, but not required.\nHopefully this example will make it a little more clear. I am using Excel 2010, the google spreadsheet is just for a visual example.</p>\n\n<p>Here is my sample data: <a href=\"https://docs.google.com/spreadsheets/d/127H7WRwHljYWX-46AAjzBrOvAlXkh4OcAF6jflaT-lI/edit#gid=0\" rel=\"nofollow\">https://docs.google.com/spreadsheets/d/127H7WRwHljYWX-46AAjzBrOvAlXkh4OcAF6jflaT-lI/edit#gid=0</a></p>\n\n<p>I have functions for the first three items, but the last with moving the data around I'm not sure how to accomplish.</p>\n\n<p>Here is a link to my 3 functions: <a href=\"http://pastebin.com/afRMgvTE\" rel=\"nofollow\">http://pastebin.com/afRMgvTE</a></p>\n\n<pre><code>Private Function FileExists(ByVal sPathName As String, Optional ByVal sPathName2 As String) As String\n    On Error Resume Next\n    If sPathName &lt;&gt; \"\" Then\n        If Dir$(sPathName) &lt;&gt; \"\" Then\n            FileExists = sPathName\n        ElseIf sPathName2 &lt;&gt; \"\" And Dir$(sPathName2) &lt;&gt; \"\" Then\n            FileExists = sPathName2\n        Else\n            FileExists = \"NO VALID URL\"\n        End If\n    End If\nEnd Function\n\nPrivate Function GetFileSize(ByVal sPathName As String) As Long\n    On Error Resume Next\n    GetFileSize = FileLen(sPathName)\nEnd Function\n\nPrivate Function GetFileExt(ByVal sPathName As String) As String\n    On Error Resume Next\n    Dim fso As New Scripting.FileSystemObject\n    Dim currentExtension As String\n\n    currentExtension = fso.GetExtensionName(Trim(sPathName))\n\n    Dim validExtension As Object\n    Set validExtension = CreateObject(\"Scripting.Dictionary\")\n\n    validExtension.Add \"bmp\", 1\n    validExtension.Add \"csv\", 2\n    validExtension.Add \"doc\", 3\n    validExtension.Add \"docm\", 4\n    validExtension.Add \"docx\", 5\n    validExtension.Add \"gif\", 6\n    validExtension.Add \"htm\", 7\n    validExtension.Add \"jpg\", 8\n    validExtension.Add \"msg\", 9\n    validExtension.Add \"pdf\", 10\n    validExtension.Add \"ppt\", 11\n    validExtension.Add \"rtf\", 12\n    validExtension.Add \"tif\", 13\n    validExtension.Add \"txt\", 14\n    validExtension.Add \"vsd\", 15\n    validExtension.Add \"xls\", 16\n    validExtension.Add \"xlsm\", 17\n    validExtension.Add \"xlsx\", 18\n    validExtension.Add \"zip\", 19\n\n    If validExtension.Exists(LCase(currentExtension)) Then\n        GetFileExt = currentExtension\n    Else\n        GetFileExt = \"UNSUPPORTED\"\n    End If\n\nEnd Function\n</code></pre>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 3650, "user_id": 5090027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/904db949ae64fe1a63ea8b4c677e6d57?s=128&d=identicon&r=PG&f=1", "display_name": "Grade &#39;Eh&#39; Bacon", "link": "https://stackoverflow.com/users/5090027/grade-eh-bacon"}, "edited": false, "score": 0, "creation_date": 1444854742, "post_id": 33134982, "comment_id": 54081696, "body": "I recommend you change &quot;.Value&quot; to &quot;.Formula&quot;, as, in short, .Value may provide different results depending on formatting, whereas .Formula is more or less the core numerical / text result itself. Not sure if that fixes your specific problem."}, {"owner": {"reputation": 8006, "user_id": 2753501, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0a5ac280a03c3a9d89488dc33f0ef075?s=128&d=identicon&r=PG&f=1", "display_name": "ZygD", "link": "https://stackoverflow.com/users/2753501/zygd"}, "reply_to_user": {"reputation": 3650, "user_id": 5090027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/904db949ae64fe1a63ea8b4c677e6d57?s=128&d=identicon&r=PG&f=1", "display_name": "Grade &#39;Eh&#39; Bacon", "link": "https://stackoverflow.com/users/5090027/grade-eh-bacon"}, "edited": false, "score": 0, "creation_date": 1444855837, "post_id": 33134982, "comment_id": 54082268, "body": "@Grade&#39;Eh&#39;Bacon - neither .Formula nor .Value2 does not fix the problem."}], "answers": [{"tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 3, "last_activity_date": 1444855660, "last_edit_date": 1444855660, "creation_date": 1444855111, "answer_id": 33135152, "question_id": 33134982, "link": "https://stackoverflow.com/questions/33134982/vba-right-function-returning-wrong-data-type/33135152#33135152", "title": "VBA Right-Function returning wrong data type", "body": "<p>Excel likes to change anything that looks like a possible date to a date.  To force this not to happen put a <code>\"'\"</code> in front of the formula.</p>\n\n<pre><code>ActiveCell.Value = \"'\" &amp; Right((ActiveCell.Offset(0, -1).value), 6)\n</code></pre>\n\n<p>This will force it to stay text.  The down side to this is, if it is a number it will be saved as text.</p>\n"}, {"tags": [], "owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "is_accepted": false, "score": 3, "last_activity_date": 1444855369, "creation_date": 1444855369, "answer_id": 33135213, "question_id": 33134982, "link": "https://stackoverflow.com/questions/33134982/vba-right-function-returning-wrong-data-type/33135213#33135213", "title": "VBA Right-Function returning wrong data type", "body": "<p>Excel likes to try to interpret certain data, rather than just leaving it as is. It especially does that with strings that look like dates, and with numeric entries.</p>\n\n<p>Two ways to workaround are</p>\n\n<ul>\n<li>Put the text prefix character in front of your string. This is usually a single quote.  (see Scott's answer for code)</li>\n<li>Format the cell as Text before you place the value there.</li>\n</ul>\n\n<hr>\n\n<pre><code> Sub foo()\n Range(\"B12\").Activate\n\n    Do\n      ActiveCell.NumberFormat = \"@\"\n      ActiveCell.Value = Right((ActiveCell.Offset(0, -1).Formula), 6)\n      ActiveCell.Offset(1, 0).Activate\n\n    Loop Until ActiveCell.Offset(0, -1).Value = 0\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "is_accepted": false, "score": 0, "last_activity_date": 1444875167, "creation_date": 1444875167, "answer_id": 33138690, "question_id": 33134982, "link": "https://stackoverflow.com/questions/33134982/vba-right-function-returning-wrong-data-type/33138690#33138690", "title": "VBA Right-Function returning wrong data type", "body": "<p>With this simple goal, I don't know why you need VBA looping.</p>\n\n<p>You can just mass set the formular1c1 to <code>=RIGHT(RC[-1],6)</code>.</p>\n\n<pre><code>Option Explicit\n\nSub Right6()\n    Const R6LeftCol = \"=RIGHT(RC[-1],6)\"\n    Dim oRng As Range, lRow As Long\n    lRow = Cells(Rows.Count, \"A\").End(xlUp).Row\n    Set oRng = Range(\"B12\")\n    Range(oRng, Cells(lRow, \"B\")).FormulaR1C1 = R6LeftCol\n    Set oRng = Nothing\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 125, "user_id": 5446609, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0e4acce3784655154d7d87b258372734?s=128&d=identicon&r=PG&f=1", "display_name": "user5446609", "link": "https://stackoverflow.com/users/5446609/user5446609"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 402, "favorite_count": 0, "accepted_answer_id": 33135152, "answer_count": 3, "score": 3, "last_activity_date": 1444875167, "creation_date": 1444854513, "last_edit_date": 1444855354, "question_id": 33134982, "link": "https://stackoverflow.com/questions/33134982/vba-right-function-returning-wrong-data-type", "title": "VBA Right-Function returning wrong data type", "body": "<p>I have written a very simple code which returns the last 6 characters of every active cell within a range.  </p>\n\n<p>The code works pretty good until it finds a particular cell in which the characters to be returned should be: \"MARC01\". Unfortunately it returns a date type character (01.Mrz).</p>\n\n<p>By using the normal excel formula it works fine, that is why I would expect it to work with a Macro as well.</p>\n\n<p>Here you can see my code which takes the strings from column \"A\" and enters it in column \"B\":</p>\n\n<pre><code>    Range(\"B12\").Activate\n\n    Do\n      ActiveCell.Value = Right((ActiveCell.Offset(0, -1).Value), 6)\n      ActiveCell.Offset(1, 0).Activate\n\n    Loop Until ActiveCell.Offset(0, -1).Value = 0\n</code></pre>\n"}, {"tags": ["string", "vba", "unicode", "string-concatenation"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1444855682, "post_id": 33134943, "comment_id": 54082190, "body": "Msgbox is not unicode-capable I think.  Try <code>Debug.Print</code> as a comparison..."}, {"owner": {"reputation": 897, "user_id": 3957327, "user_type": "registered", "accept_rate": 64, "profile_image": "https://graph.facebook.com/509938128/picture?type=large", "display_name": "Juan Ruiz de Castilla", "link": "https://stackoverflow.com/users/3957327/juan-ruiz-de-castilla"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1444855946, "post_id": 33134943, "comment_id": 54082334, "body": "@TimWilliams has reason, but is rare that with left function, works, maybe because that left function Inherited from excel cells and all his capabilities. I want an explanation :) ."}, {"owner": {"reputation": 8006, "user_id": 2753501, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0a5ac280a03c3a9d89488dc33f0ef075?s=128&d=identicon&r=PG&f=1", "display_name": "ZygD", "link": "https://stackoverflow.com/users/2753501/zygd"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1444856139, "post_id": 33134943, "comment_id": 54082439, "body": "@TimWilliams - I will need <code>MsgBox</code>, because it asks for a response from users. Using the same <code>StrConv</code> line, <code>Debug.Print</code> shows different results on 2 separate machines, while <code>MsgBox</code> shows the same letter that I need."}], "answers": [{"comments": [{"owner": {"reputation": 8006, "user_id": 2753501, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0a5ac280a03c3a9d89488dc33f0ef075?s=128&d=identicon&r=PG&f=1", "display_name": "ZygD", "link": "https://stackoverflow.com/users/2753501/zygd"}, "edited": false, "score": 0, "creation_date": 1444857544, "post_id": 33135271, "comment_id": 54083086, "body": "Nice one. Could&#39;ve thought about it myself, but i didn&#39;t :) I knew that Len of the string becomes 2 after using StrConv on one letter. Thanks!"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 8006, "user_id": 2753501, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0a5ac280a03c3a9d89488dc33f0ef075?s=128&d=identicon&r=PG&f=1", "display_name": "ZygD", "link": "https://stackoverflow.com/users/2753501/zygd"}, "edited": false, "score": 0, "creation_date": 1444857706, "post_id": 33135271, "comment_id": 54083166, "body": "@ZygD thanks, glad I could help.  I did a little more research and found the actual problem.  See the edit."}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 2, "last_activity_date": 1444857618, "last_edit_date": 1444857618, "creation_date": 1444855598, "answer_id": 33135271, "question_id": 33134943, "link": "https://stackoverflow.com/questions/33134943/string-concatenation-in-vba-after-using-strconv/33135271#33135271", "title": "String concatenation in VBA after using StrConv", "body": "<p>There is an extra something being placed in the first string.  This is what is not allowing the second part to be seen</p>\n\n<p>Use </p>\n\n<pre><code>MsgBox left(StrConv(\"O\", vbUnicode),1) &amp; \"K\"\n</code></pre>\n\n<p>After some research it is placing a null character after each actual character.</p>\n\n<p>So if you want more than one character at a time use this</p>\n\n<pre><code>Msgbox Replace(StrConv(\"O\", vbUnicode),chr(0),\"\") &amp; \"K\"\n</code></pre>\n\n<p>This will allow more than one character at a time.</p>\n"}, {"comments": [{"owner": {"reputation": 8006, "user_id": 2753501, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0a5ac280a03c3a9d89488dc33f0ef075?s=128&d=identicon&r=PG&f=1", "display_name": "ZygD", "link": "https://stackoverflow.com/users/2753501/zygd"}, "edited": false, "score": 0, "creation_date": 1444857176, "post_id": 33135403, "comment_id": 54082944, "body": "I like really like the approach! It works with &quot;OK&quot;. But for my real data <code>StrConv(ChrW$(240), 64, 1063)</code> returns <code>&#240;</code> instead of <code>\u0161</code> in the MsgBox. I need <code>\u0161</code>"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 8006, "user_id": 2753501, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0a5ac280a03c3a9d89488dc33f0ef075?s=128&d=identicon&r=PG&f=1", "display_name": "ZygD", "link": "https://stackoverflow.com/users/2753501/zygd"}, "edited": false, "score": 1, "creation_date": 1444863487, "post_id": 33135403, "comment_id": 54085642, "body": "I don&#39;t have anything else to offer - this is really not an area where I&#39;m knowledgeable..."}, {"owner": {"reputation": 8006, "user_id": 2753501, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0a5ac280a03c3a9d89488dc33f0ef075?s=128&d=identicon&r=PG&f=1", "display_name": "ZygD", "link": "https://stackoverflow.com/users/2753501/zygd"}, "edited": false, "score": 0, "creation_date": 1444890083, "post_id": 33135403, "comment_id": 54092867, "body": "These unicode things are really complicated for me too. I come back to them time to time, but I still cannot build some lasting knowledge here. I really value your input. There is another machine where I have the most of problems of this kind. So maybe I would need to return to your solution and build something on top of it, if the <code>Left</code> method failed on that machine to return the letters I need. The referenced article is really nice too. Thanks!"}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 4, "last_activity_date": 1444856027, "creation_date": 1444856027, "answer_id": 33135403, "question_id": 33134943, "link": "https://stackoverflow.com/questions/33134943/string-concatenation-in-vba-after-using-strconv/33135403#33135403", "title": "String concatenation in VBA after using StrConv", "body": "<p>From: <a href=\"http://blog.nkadesign.com/2013/vba-unicode-strings-and-the-windows-api/\" rel=\"nofollow\">http://blog.nkadesign.com/2013/vba-unicode-strings-and-the-windows-api/</a></p>\n\n<pre><code>#If VBA7 Then\n    Public Declare PtrSafe Function MessageBoxW Lib \"user32\" _\n                                    (ByVal hwnd As LongPtr, _\n                                     ByVal lpText As String, _\n                                     ByVal lpCaption As String, _\n                                     ByVal wType As Long) As Long\n#Else\n    Public Declare Function MessageBoxW Lib \"user32\" _\n                    (ByVal hwnd As Long, _\n                                 ByVal lpText As String, _\n                                 ByVal lpCaption As String, _\n                                 ByVal wType As Long) As Long\n#End If\n\nSub tt()\n\n\n    Dim g(1) As String, r\n    g(0) = CStr(StrConv(\"O\", vbUnicode))\n    g(1) = \"K\"\n    r = Join(g(), vbNullString)\n\n    MessageBoxW 0, r, StrConv(\"test\", vbUnicode), 0\n\n\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 8006, "user_id": 2753501, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0a5ac280a03c3a9d89488dc33f0ef075?s=128&d=identicon&r=PG&f=1", "display_name": "ZygD", "link": "https://stackoverflow.com/users/2753501/zygd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 293, "favorite_count": 0, "accepted_answer_id": 33135271, "answer_count": 2, "score": -1, "last_activity_date": 1444857618, "creation_date": 1444854369, "question_id": 33134943, "link": "https://stackoverflow.com/questions/33134943/string-concatenation-in-vba-after-using-strconv", "title": "String concatenation in VBA after using StrConv", "body": "<p>I cannot concatenate 2 strings. The first string is the result of <code>StrConv()</code>, and the second is just a simple string like <code>\"K\"</code>.</p>\n\n<p>These do not work:</p>\n\n<pre>MsgBox StrConv(\"O\", vbUnicode) & \"K\"</pre>\n\n<pre>MsgBox StrConv(\"O\", vbUnicode) + \"K\"</pre>\n\n<pre>MsgBox CStr(StrConv(\"O\", vbUnicode)) & \"K\"</pre>\n\n<pre><code>Dim g(1) As String\ng(0) = CStr(StrConv(\"O\", vbUnicode))\ng(1) = CStr(\"K\")\nMsgBox Join(g(), vbNullString)\n</code></pre>\n\n<p>The expected result is \"OK\"</p>\n\n<p>This is a simplified version of <code>StrConv</code> which is enough to see that concatenation is not working. However, my real case would be <code>StrConv(ChrW$(240), 64, 1063)</code></p>\n"}, {"tags": ["vba", "excel", "colors", "format"], "comments": [{"owner": {"reputation": 3650, "user_id": 5090027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/904db949ae64fe1a63ea8b4c677e6d57?s=128&d=identicon&r=PG&f=1", "display_name": "Grade &#39;Eh&#39; Bacon", "link": "https://stackoverflow.com/users/5090027/grade-eh-bacon"}, "edited": false, "score": 0, "creation_date": 1444854202, "post_id": 33134865, "comment_id": 54081387, "body": "Go to the macro recorder and manually change the properties of a row. Then take that knowledge and insert the code as needed into your VBA."}], "answers": [{"comments": [{"owner": {"reputation": 273, "user_id": 5314545, "user_type": "registered", "accept_rate": 62, "profile_image": "https://lh6.googleusercontent.com/-ioQSOathyqE/AAAAAAAAAAI/AAAAAAAAAHg/OBQbChIvN08/photo.jpg?sz=128", "display_name": "Alberto Brown", "link": "https://stackoverflow.com/users/5314545/alberto-brown"}, "edited": false, "score": 0, "creation_date": 1444855511, "post_id": 33135009, "comment_id": 54082106, "body": "I knew I must be close but its almost embarrassing I was that close. Thanks Scott"}], "tags": [], "owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "is_accepted": true, "score": 1, "last_activity_date": 1444854611, "creation_date": 1444854611, "answer_id": 33135009, "question_id": 33134865, "link": "https://stackoverflow.com/questions/33134865/excel-vba-insert-row-and-change-color/33135009#33135009", "title": "excel vba insert row and change color", "body": "<p>You've got it there, you just need one line after \n<code>Rows(lRow).EntireRow.Insert</code> </p>\n\n<p>and that is <code>Range(\"A\" &amp; lRow &amp; \":H\" &amp; lRow).Interior.Color = 5287936</code></p>\n"}], "owner": {"reputation": 273, "user_id": 5314545, "user_type": "registered", "accept_rate": 62, "profile_image": "https://lh6.googleusercontent.com/-ioQSOathyqE/AAAAAAAAAAI/AAAAAAAAAHg/OBQbChIvN08/photo.jpg?sz=128", "display_name": "Alberto Brown", "link": "https://stackoverflow.com/users/5314545/alberto-brown"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2328, "favorite_count": 0, "accepted_answer_id": 33135009, "answer_count": 1, "score": 0, "last_activity_date": 1444854611, "creation_date": 1444854100, "last_edit_date": 1531164843, "question_id": 33134865, "link": "https://stackoverflow.com/questions/33134865/excel-vba-insert-row-and-change-color", "title": "excel vba insert row and change color", "body": "<p>I need to change the color of a row ( or cells A thru H in specific row), that has been inserted by the macro code below. The if statement that scans Col H, is where the color change needs to happen. </p>\n\n<pre><code>Sub SolidWorks()\n\nApplication.ScreenUpdating = False\n\nRange(\"A100000\").End(xlUp).Activate\nRange(\"N1\") = ActiveCell.Row\n\nFor lrow = Cells(Cells.Rows.Count, \"B\").End(xlUp).Row To 1 Step -1\nIf Cells(lrow, \"B\") = 0 Then\n            Rows(lrow).EntireRow.Delete\nEnd If\nNext lrow\n\nFor lrow = Cells(Cells.Rows.Count, \"H\").End(xlUp).Row To 1 Step -1\n    If Cells(lrow, \"H\") &lt;&gt; Cells(lrow - IIf(lrow = 1, 0, 1), \"H\") Then\n            Rows(lrow).EntireRow.Insert  '&lt;---- insert green row, instead of just a blank row\n'.Color = 5287936\n'                With Selection.Interior\n'                .Pattern = xlSolid\n'                .PatternColorIndex = xlAutomatic\n'                .Color = 5287936\n'                .TintAndShade = 0\n'                .PatternTintAndShade = 0\n'                End With\n    End If\nNext lrow\n\nFor lrow = Cells(Cells.Rows.Count, \"G\").End(xlUp).Row To 1 Step -1\n    If Cells(lrow, \"G\") &lt;&gt; Cells(lrow - IIf(lrow = 1, 0, 1), \"G\") Then\n            Rows(lrow).EntireRow.Insert\n    End If\nNext lrow\n\nRange(\"A1\").Select\n\nApplication.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "excel-external-data"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1444853541, "post_id": 33134526, "comment_id": 54080978, "body": "Are you dealing with the same volumes of data as in testing?  Is the data sorted differently?  Difficult to make suggestions to improve your existing code unless you post it here..."}, {"owner": {"reputation": 973, "user_id": 3165854, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/11f6f82651558700823312e4545ff3df?s=128&d=identicon&r=PG&f=1", "display_name": "user3165854", "link": "https://stackoverflow.com/users/3165854/user3165854"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1444854557, "post_id": 33134526, "comment_id": 54081594, "body": "Its approximately 40,000 rows in the first table and 50,000 in the second and each table has 5 columns.  They are sorted by ID."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1444854615, "post_id": 33134526, "comment_id": 54081623, "body": "That doesn&#39;t really answer either of my questions ;-)"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1444854911, "post_id": 33134526, "comment_id": 54081782, "body": "as @TimWilliams said, please post your code. Also, are there calculations in the workbook that are being re-calced all the time during the code execution?"}, {"owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "edited": false, "score": 0, "creation_date": 1444856114, "post_id": 33134526, "comment_id": 54082429, "body": "Is the local data you used for the initial tests the same data you load from the remote databases?  It seems likely the remote data is more complicated to process.  Have you tried adding code to calculate where the time is going?"}, {"owner": {"reputation": 973, "user_id": 3165854, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/11f6f82651558700823312e4545ff3df?s=128&d=identicon&r=PG&f=1", "display_name": "user3165854", "link": "https://stackoverflow.com/users/3165854/user3165854"}, "edited": false, "score": 0, "creation_date": 1444856909, "post_id": 33134526, "comment_id": 54082821, "body": "Its the same data on the local databases as it is on the remote databases.  I&#39;ve added the code.  There is only the tables and this code in the workbook.  I have tried following the IDs to see if one in particular slows it down but all looks like it runs at the same speed.  I could look at timings at each step.  Just baffled to why it doesn&#39;t cause a problem on the local database if its the code and why if it is the remote connection why it is causing a problem when I run the code and not the refresh of the data"}], "answers": [{"tags": [], "owner": {"reputation": 973, "user_id": 3165854, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/11f6f82651558700823312e4545ff3df?s=128&d=identicon&r=PG&f=1", "display_name": "user3165854", "link": "https://stackoverflow.com/users/3165854/user3165854"}, "is_accepted": true, "score": 1, "last_activity_date": 1444859830, "creation_date": 1444859830, "answer_id": 33136299, "question_id": 33134526, "link": "https://stackoverflow.com/questions/33134526/performance-issue-running-a-macro-in-excel-across-two-tables-from-external-data/33136299#33136299", "title": "Performance issue running a macro in Excel across two tables from external data sources", "body": "<p>I think I found the issue.  </p>\n\n<p>Someone had changed the view that populates the table in one database to use the LEFT function which turned a number into a string in the worksheet.  So looked like comparing the string in one table to the number in the other caused the performance issue.  </p>\n\n<p>Surprised it caused it to slow so much, but casting it back to an integer makes it work correctly again.</p>\n\n<p>Thanks for helping</p>\n"}], "owner": {"reputation": 973, "user_id": 3165854, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/11f6f82651558700823312e4545ff3df?s=128&d=identicon&r=PG&f=1", "display_name": "user3165854", "link": "https://stackoverflow.com/users/3165854/user3165854"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 0, "accepted_answer_id": 33136299, "answer_count": 1, "score": 0, "last_activity_date": 1444859859, "creation_date": 1444852800, "last_edit_date": 1444859859, "question_id": 33134526, "link": "https://stackoverflow.com/questions/33134526/performance-issue-running-a-macro-in-excel-across-two-tables-from-external-data", "title": "Performance issue running a macro in Excel across two tables from external data sources", "body": "<p>On a worksheet I have two tables which are populated from two different external sources, one from db2 and the other SQL server.  Once the data in the tables are refreshed I trigger a macro which runs VBA code that loops through the cells in both tables and applies business rules.</p>\n\n<p>Testing it locally it works as expected and the macro completes in seconds.  When I change the connections to point to db2 and SQL server databases on the network, it refreshes the data in a timely manner, but when I trigger the macro it takes approx. 30 minutes to complete.  Only the connections have been changed and I'm using the same workbook for all testing.</p>\n\n<p>First thought was that it is now pulling data from the network and it could be connectivity, but it refreshes the data OK and its only the macro that runs slowly and the VBA code does not use the connections and is just a basic for loop.</p>\n\n<p>I'm lost to what is causing this and wanted to know if anyone has encountered this behaviour before and knows how I could resolve it?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 1, "creation_date": 1444853282, "post_id": 33134518, "comment_id": 54080851, "body": "<i>just a side note:</i> no need for the <code>Else GoTo X</code> and <code>X:</code> in this code, since the <code>If ... End If</code> is sufficient."}, {"owner": {"reputation": 15049, "user_id": 1370425, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/H8yZu.png?s=128&g=1", "display_name": "SeanC", "link": "https://stackoverflow.com/users/1370425/seanc"}, "edited": false, "score": 0, "creation_date": 1444853535, "post_id": 33134518, "comment_id": 54080972, "body": "remove the <code>From:=1, To:=Pdfsheets,</code> - why restrict what pages print?"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 1, "creation_date": 1444853830, "post_id": 33134518, "comment_id": 54081152, "body": "I think you may need to use the <code>ExportAsFixedFormat</code> against each worksheet. So if the users wants 2 worksheets printed, assuming they are sheets 1 and 2, you can write <code>Worksheets(Array(1,2)).Select ActiveSheet.ExportAsFixedFormat ....</code> Not sure it&#39;s the answer, but wanted to provide the possibility."}], "answers": [{"tags": [], "owner": {"reputation": 61, "user_id": 5446655, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a82a74858fc7f09ac8d31f49caa496d?s=128&d=identicon&r=PG&f=1", "display_name": "Jess-eye-ca", "link": "https://stackoverflow.com/users/5446655/jess-eye-ca"}, "is_accepted": true, "score": 0, "last_activity_date": 1444857071, "creation_date": 1444857071, "answer_id": 33135640, "question_id": 33134518, "link": "https://stackoverflow.com/questions/33134518/save-multiple-worksheets-as-pdf/33135640#33135640", "title": "Save multiple worksheets as PDF", "body": "<p>The method I use, is to loop through the worksheets within the workbook and select the ones that meet my criteria. Then I use ExportAsFixedFormat to create my pdf.\nNote you cannot select hidden worksheets, so if the workbook contains them you will need to add an if/then to check visibility.</p>\n\n<pre><code>Pdfsheets = InputBox(\"How many worksheets would you like to include in PDF\")\n    for x=1 to Pdfsheets\n        thisworkbook.sheets(x).select (false) 'use false to select multiple sheets\n    next x\n\n'Prints the number of sheets entered by user--starts at first ACTIVE   \nWorksheet to the result of &lt;Pdfsheets&gt;\nActiveWorkbook.ExportAsFixedFormat Type:=xlTypePDF, FileName:= _\n\"C:\\Users\\\" &amp; WinName &amp; \"\\Documents\\REPORTING\\\" &amp; Database &amp; \"\\\" &amp; ReportYear &amp; \"\\\" &amp; FolderMonth &amp; \"\\\" &amp; Database &amp; \"-\" &amp; Title &amp; \"-\" &amp;    FileDate _\n, Quality:=xlQualityStandard, IncludeDocProperties:=False, _\nIgnorePrintAreas:=False, OpenAfterPublish:=True\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 5446144, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0a390c503b9e82df4d5b421ac4d6f91?s=128&d=identicon&r=PG&f=1", "display_name": "ragin_cajun", "link": "https://stackoverflow.com/users/5446144/ragin-cajun"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 803, "favorite_count": 0, "accepted_answer_id": 33135640, "answer_count": 1, "score": 0, "last_activity_date": 1444871899, "creation_date": 1444852775, "last_edit_date": 1444871899, "question_id": 33134518, "link": "https://stackoverflow.com/questions/33134518/save-multiple-worksheets-as-pdf", "title": "Save multiple worksheets as PDF", "body": "<p>I'm fairly green with using VBA and this is the first time I've posted a question in this forum so bear with me if I'm breaking any posting rules.  </p>\n\n<p>Below is a piece of code I use to print/save 1 or more worksheets from an Excel workbook to PDF. It works fine if the data from each worksheet that I'm exporting fits onto a single page. The problem I'm finding is that if the range of data from my first sheet is larger than 1 page then only the 1st worksheet will be exported, and only up to the first page-break. Any advice or suggestions on how I can resolve this issue?</p>\n\n<pre><code>'Ask user if report needs to be saved as a pdf\nPdfCheck = MsgBox(\"Save report as PDF\", vbYesNo, \"Save PDF\") \n'use result of &lt;PdfCheck&gt; to control if statement\nIf PdfCheck = vbYes Then\n    Pdfsheets = InputBox(\"How many worksheets would you like to include in PDF\")\n\n    'Prints the number of sheets entered by user\n    'starts at first ACTIVE Worksheet to the result of &lt;Pdfsheets&gt;\n    ActiveWorkbook.ExportAsFixedFormat Type:=xlTypePDF, FileName:= _\n    \"C:\\Users\\\" &amp; WinName &amp; \"\\Documents\\REPORTING\\\" &amp; Database &amp; \"\\\" &amp; _\n     ReportYear &amp; \"\\\" &amp; FolderMonth &amp; \"\\\" &amp; Database &amp; \"-\" &amp; Title &amp; \"-\" &amp; FileDate _\n    , Quality:=xlQualityStandard, IncludeDocProperties:=False, _\n    IgnorePrintAreas:=False, From:=1, To:=Pdfsheets, OpenAfterPublish:=True\nElse\n    GoTo X\nEnd If\nX:\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 3325, "user_id": 4941166, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/c2c1101a15e12b67c110510ec6641128?s=128&d=identicon&r=PG&f=1", "display_name": "WNG", "link": "https://stackoverflow.com/users/4941166/wng"}, "is_accepted": false, "score": 0, "last_activity_date": 1444860482, "creation_date": 1444860482, "answer_id": 33136451, "question_id": 33134358, "link": "https://stackoverflow.com/questions/33134358/vba-querytables-how-to-not-take-into-account-textfileotherdelimiter/33136451#33136451", "title": "VBA : QueryTables : how to NOT take into account TextFileOtherDelimiter", "body": "<p>For future reference, I did not find the way to force no other delimiter, but the two following workaround seem to work :</p>\n\n<ul>\n<li><p>forcing the otherdelimiter to the same value as the first one (won't work if you have no first delimiter)</p>\n\n<pre><code>.TextFileOtherDelimiter = \",\"\n</code></pre></li>\n<li><p>using a delimiter that never appears in the file (won't work if any char but the first delimiter could appear in the file)</p>\n\n<pre><code>.TextFileOtherDelimiter = \"|\"\n</code></pre></li>\n</ul>\n\n<p>As none of these two workarounds solves the problem in the general case, I don't mark it as suitable</p>\n"}], "owner": {"reputation": 3325, "user_id": 4941166, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/c2c1101a15e12b67c110510ec6641128?s=128&d=identicon&r=PG&f=1", "display_name": "WNG", "link": "https://stackoverflow.com/users/4941166/wng"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 832, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1444860482, "creation_date": 1444852229, "last_edit_date": 1531164843, "question_id": 33134358, "link": "https://stackoverflow.com/questions/33134358/vba-querytables-how-to-not-take-into-account-textfileotherdelimiter", "title": "VBA : QueryTables : how to NOT take into account TextFileOtherDelimiter", "body": "<p>I got a troubleshooting with VBA for Excel :  When I use </p>\n\n<pre><code>With ActiveSheet.QueryTables.Add(Connection:=ConnString, Destination:=SomeRange)\n    .Name = _\n    \" \"\n    .FieldNames = True\n    .RowNumbers = False\n    .FillAdjacentFormulas = False\n    .PreserveFormatting = True\n    .RefreshOnFileOpen = False\n    .RefreshStyle = xlInsertDeleteCells\n    .SavePassword = False\n    .SaveData = True\n    .AdjustColumnWidth = True\n    .RefreshPeriod = 0\n    .TextFilePromptOnRefresh = False\n    .TextFilePlatform = 65001\n    .TextFileStartRow = 1\n    .TextFileParseType = xlDelimited\n    .TextFileTextQualifier = xlTextQualifierDoubleQuote\n    .TextFileConsecutiveDelimiter = False\n    .TextFileTabDelimiter = False\n    .TextFileSemicolonDelimiter = False\n    .TextFileCommaDelimiter = True\n    .TextFileSpaceDelimiter = False\n    .TextFileColumnDataTypes = Array(1)\n    .TextFileDecimalSeparator = \",\"\n    .TextFileTrailingMinusNumbers = True\n    .Refresh BackgroundQuery:=False\nEnd With\n</code></pre>\n\n<p>the import request automatically carries in this import the \"other delimiter\" that I requested on a manual import.</p>\n\n<p>i.e. I manually imported a file using \"-\" as delimiter and the macro is going to behave as if it included the line :</p>\n\n<pre><code>.TextFileOtherDelimiter = \"-\"\n</code></pre>\n\n<p>I tried to use </p>\n\n<pre><code>.TextFileOtherDelimiter = False\n</code></pre>\n\n<p>but it doesn't work, because it behaves as </p>\n\n<pre><code>.TextFileOtherDelimiter = \"F\"\n</code></pre>\n\n<p>My question : how can I specify that this import should only be parsed with \",\" delimiter and not ANY other one (regardless of any other import that can have occured on the machine before?)</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1444851222, "post_id": 33133955, "comment_id": 54079631, "body": "Can you clarify a little more? Your list from your &quot;Master Sheet&quot; is to be copied in each worksheet, range F:F?  What loop are you missing? Why do you need to grab the sheet names?"}, {"owner": {"reputation": 147, "user_id": 5373207, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/e19d3304226cff2fc35c679235c7a2df?s=128&d=identicon&r=PG&f=1", "display_name": "okmred", "link": "https://stackoverflow.com/users/5373207/okmred"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1444851460, "post_id": 33133955, "comment_id": 54079767, "body": "Yes, I want to copy a unique list from the citys list in the master sheet to the other sheets. (how would I get my unique list to the other sheets with out the names of them??)"}], "answers": [{"comments": [{"owner": {"reputation": 147, "user_id": 5373207, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/e19d3304226cff2fc35c679235c7a2df?s=128&d=identicon&r=PG&f=1", "display_name": "okmred", "link": "https://stackoverflow.com/users/5373207/okmred"}, "edited": false, "score": 0, "creation_date": 1444916633, "post_id": 33134230, "comment_id": 54109672, "body": "How does it avoid over writing the main ws? I also have a hidden ws with additionl data that I don&#39;t want &quot;updated&quot; with this info. Thanks"}], "tags": [], "owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "is_accepted": false, "score": 0, "last_activity_date": 1444919921, "last_edit_date": 1495535227, "creation_date": 1444851825, "answer_id": 33134230, "question_id": 33133955, "link": "https://stackoverflow.com/questions/33133955/update-existing-sheets-with-unique-list-from-column-a-in-master-sheet/33134230#33134230", "title": "Update Existing Sheets with Unique list from Column A in master sheet", "body": "<p>You can shorten your code a little by <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba-macros\">avoiding using .Select</a> and loop through each worksheet.</p>\n\n<pre><code>Sub test()\nDim ws as worksheet, mainWS as worksheet\nDim cityNames as Range\nSet mainWS = Sheets(\"MasterSheet\")\n\ncityNames = mainWS.Range(\"F:F\")\n\n'Let's now loop through each worksheet in your activebook\nFor each ws in ActiveWorkbook.Worksheets\n  With ws\n     If ws.Name &lt;&gt; \"additional\" or ws.Name &lt;&gt; \"MasterSheet\" Then\n      .Range(\"F:F\").Value = cityNames.Value\n      .Range(\"F1:F3125\").AdvancedFilter Action:=xlFilterInPlace, Unique:=True\n     End if\nEnd with\nNext ws\n\nEnd sub\n</code></pre>\n\n<p>This is untested, but should work.  Please let me know if there are any errors, or it doesn't quite work.</p>\n\n<p>You don't need the name of each worksheet, since you can use a <code>For</code> loop.  Do you see how that works in the above?</p>\n"}, {"comments": [{"owner": {"reputation": 147, "user_id": 5373207, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/e19d3304226cff2fc35c679235c7a2df?s=128&d=identicon&r=PG&f=1", "display_name": "okmred", "link": "https://stackoverflow.com/users/5373207/okmred"}, "edited": false, "score": 0, "creation_date": 1444917504, "post_id": 33134565, "comment_id": 54110461, "body": "What if I have more than 1 sheet I want to not add these cities to? I have several hidden sheets with other data that I don&#39;t want to be affected by this . Thanks"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "reply_to_user": {"reputation": 147, "user_id": 5373207, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/e19d3304226cff2fc35c679235c7a2df?s=128&d=identicon&r=PG&f=1", "display_name": "okmred", "link": "https://stackoverflow.com/users/5373207/okmred"}, "edited": false, "score": 0, "creation_date": 1444919149, "post_id": 33134565, "comment_id": 54111722, "body": "I have edited my code to not include hidden sheets in the update. If you need to add more names, you can just and conditions to the <code>If</code> statement. If it is a lot, you may want a different approach ..."}, {"owner": {"reputation": 147, "user_id": 5373207, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/e19d3304226cff2fc35c679235c7a2df?s=128&d=identicon&r=PG&f=1", "display_name": "okmred", "link": "https://stackoverflow.com/users/5373207/okmred"}, "edited": false, "score": 0, "creation_date": 1444920637, "post_id": 33134565, "comment_id": 54112846, "body": "Got it thanks. So how would I sort the list? I have the unique list copied to all the necessary tabs like I want it to be, with the exception the order is mixed up. I see where we have : &quot;Action:=xlFilterInPlace&quot; , would this not be for sorting?"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "reply_to_user": {"reputation": 147, "user_id": 5373207, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/e19d3304226cff2fc35c679235c7a2df?s=128&d=identicon&r=PG&f=1", "display_name": "okmred", "link": "https://stackoverflow.com/users/5373207/okmred"}, "edited": false, "score": 0, "creation_date": 1444920752, "post_id": 33134565, "comment_id": 54112942, "body": "sorting is a different animal. use the macro recorder to get the code for sorting (record a macro of you sorting a random range), then apply it to your code - of course, you may need to make some adjustments to fit your exact code.. If you get stuck on this or have another question, create a new question on SO. Please mark this one as answered so people know its solved. One more tip - You&#39;ll probably be based served sorting the <code>MasterSheet</code> first, then your filter will be sorted as well with the unique values."}, {"owner": {"reputation": 147, "user_id": 5373207, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/e19d3304226cff2fc35c679235c7a2df?s=128&d=identicon&r=PG&f=1", "display_name": "okmred", "link": "https://stackoverflow.com/users/5373207/okmred"}, "edited": false, "score": 0, "creation_date": 1444921728, "post_id": 33134565, "comment_id": 54113660, "body": "Thanks, will do on all counts."}], "tags": [], "owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "is_accepted": true, "score": 0, "last_activity_date": 1444919104, "last_edit_date": 1444919104, "creation_date": 1444852969, "answer_id": 33134565, "question_id": 33133955, "link": "https://stackoverflow.com/questions/33133955/update-existing-sheets-with-unique-list-from-column-a-in-master-sheet/33134565#33134565", "title": "Update Existing Sheets with Unique list from Column A in master sheet", "body": "<p>Here is a solution that provides the loop you need to move through each worksheet and copy the unique cities to column F for each worksheet (not named \"MasterSheet\"). It will leave you with just the unique list and not a unique filtered list on each sheet as well as show the entire data on the MasterSheet as it was before you started.</p>\n\n<p><em>This code assumes the city list in the <code>MasterSheet</code> is a contiguous list of cities starting in cell F1</em></p>\n\n<pre><code>Sub CopyUniqueCityList()\n\nDim rCityList As Range\n\nWith Sheets(\"MasterSheet\")\n    With .Range(.Range(\"F1\"), .Range(\"F1\").End(xlDown))\n        .AdvancedFilter Action:=xlFilterInPlace, Unique:=True\n        Set rCityList = .SpecialCells(xlCellTypeVisible)\n    End With\n    .ShowAllData\nEnd With\n\nDim ws As Worksheet\nFor Each ws In Worksheets\n\n    If ws.Visible = xlSheetVisible And ws.Name &lt;&gt; \"MasterSheet\" Then\n\n        rCityList.Copy ws.Range(\"F1\")\n\n    End If\n\nNext\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 147, "user_id": 5373207, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/e19d3304226cff2fc35c679235c7a2df?s=128&d=identicon&r=PG&f=1", "display_name": "okmred", "link": "https://stackoverflow.com/users/5373207/okmred"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 52, "favorite_count": 0, "accepted_answer_id": 33134565, "answer_count": 2, "score": 0, "last_activity_date": 1444919921, "creation_date": 1444850867, "question_id": 33133955, "link": "https://stackoverflow.com/questions/33133955/update-existing-sheets-with-unique-list-from-column-a-in-master-sheet", "title": "Update Existing Sheets with Unique list from Column A in master sheet", "body": "<p>So I have a workbook with a master sheet column f has my citys.\nI need to copy a unique list of citys from the master sheet to each existing sheet. </p>\n\n<p>I've looked at :</p>\n\n<pre><code>sheets(\"MasterSheet\").Select\n    Columns(\"F:F\").Select\n    Selection.Copy\n    sheets(\"Existingsheet\").Select\n    Columns(\"F:F\").Select\n    ActiveSheet.Paste\n    Application.CutCopyMode = False\n    Range(\"F1:F3125\").AdvancedFilter Action:=xlFilterInPlace, Unique:=True\n</code></pre>\n\n<p>But I'm missing a loop as well as grabbing the existing sheet names dynamically.\nI'm thinking there must be a quicker way to get to where I want to be.</p>\n\n<p>Any direction would be most welcome.\nThanks.</p>\n"}, {"tags": ["vba", "reporting-services", "ssrs-2008"], "comments": [{"owner": {"reputation": 653, "user_id": 3581526, "user_type": "registered", "accept_rate": 48, "profile_image": "https://i.stack.imgur.com/31lGf.png?s=128&g=1", "display_name": "Nickso", "link": "https://stackoverflow.com/users/3581526/nickso"}, "edited": false, "score": 0, "creation_date": 1444920603, "post_id": 33133952, "comment_id": 54112810, "body": "Ok I solved the problem with Page Break. If anyone have the same problem, you must declare your variables as Public Shared as each page break is a new instance and being Public Shared your values will persist. Now onto the problem with the runningvalue"}], "answers": [{"comments": [{"owner": {"reputation": 653, "user_id": 3581526, "user_type": "registered", "accept_rate": 48, "profile_image": "https://i.stack.imgur.com/31lGf.png?s=128&g=1", "display_name": "Nickso", "link": "https://stackoverflow.com/users/3581526/nickso"}, "edited": false, "score": 0, "creation_date": 1444914167, "post_id": 33136694, "comment_id": 54107853, "body": "Hey there Alejandro, I updated my initial thread with a bunch tons of more information."}, {"owner": {"reputation": 653, "user_id": 3581526, "user_type": "registered", "accept_rate": 48, "profile_image": "https://i.stack.imgur.com/31lGf.png?s=128&g=1", "display_name": "Nickso", "link": "https://stackoverflow.com/users/3581526/nickso"}, "edited": false, "score": 0, "creation_date": 1444924951, "post_id": 33136694, "comment_id": 54115893, "body": "That is a great Idea, is there any way to make the same with RowNumber instead of changing the query?"}, {"owner": {"reputation": 13317, "user_id": 2647648, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/be60d7dc56a2cfaf0072a315ca498d7e?s=128&d=identicon&r=PG", "display_name": "alejandro zuleta", "link": "https://stackoverflow.com/users/2647648/alejandro-zuleta"}, "reply_to_user": {"reputation": 653, "user_id": 3581526, "user_type": "registered", "accept_rate": 48, "profile_image": "https://i.stack.imgur.com/31lGf.png?s=128&g=1", "display_name": "Nickso", "link": "https://stackoverflow.com/users/3581526/nickso"}, "edited": false, "score": 0, "creation_date": 1444926340, "post_id": 33136694, "comment_id": 54116753, "body": "@Nickso : No, my approach uses <code>lookup</code> for get the next row group value. <code>Lookup</code> looks for a row in the dataset (RowNumber cannot be used as parameter or parameter expression of lookup function) and returns other column value in that row specified by user. I think this is the only way to know the future row of a dataset. Share your SQL query to help you adding row number, that is simple though"}, {"owner": {"reputation": 653, "user_id": 3581526, "user_type": "registered", "accept_rate": 48, "profile_image": "https://i.stack.imgur.com/31lGf.png?s=128&g=1", "display_name": "Nickso", "link": "https://stackoverflow.com/users/3581526/nickso"}, "edited": false, "score": 0, "creation_date": 1444926904, "post_id": 33136694, "comment_id": 54117084, "body": "It is a huge Query as it&#39;s a Dynamic Query"}], "tags": [], "owner": {"reputation": 13317, "user_id": 2647648, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/be60d7dc56a2cfaf0072a315ca498d7e?s=128&d=identicon&r=PG", "display_name": "alejandro zuleta", "link": "https://stackoverflow.com/users/2647648/alejandro-zuleta"}, "is_accepted": false, "score": 0, "last_activity_date": 1444921588, "last_edit_date": 1444921588, "creation_date": 1444861633, "answer_id": 33136694, "question_id": 33133952, "link": "https://stackoverflow.com/questions/33133952/sum-the-first-element-of-each-group-and-with-runningvalue/33136694#33136694", "title": "Sum the first element of each group and with RunningValue", "body": "<p>I can help you with the first part of your problem so my answer is partial cause I don't get your issue with running value field, so I am trying to guess what you need.</p>\n\n<p>You have to go to <code>report / report properties / code</code> tab and add the following code:</p>\n\n<pre><code>Dim public total as Integer \nDim public prevgroup as String = \"\"\n\nPublic Function AddTotal(ByVal group as String,ByVal value AS Integer ) AS Integer \n    If (group &lt;&gt; prevgroup) Then\n        total = total + value\n        prevgroup = group\n        return total\n    End If\n    return 0                \nEnd Function \n\nPublic Function GetTotal() \n    return total\nEnd Function \n</code></pre>\n\n<p>This is a guess of data arrangement you have.</p>\n\n<p><a href=\"https://i.stack.imgur.com/xgVFO.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/xgVFO.png\" alt=\"enter image description here\"></a></p>\n\n<p>Use this expression in to get the sum of the first values of every distinct group:</p>\n\n<pre><code>=Code.GetTotal()\n</code></pre>\n\n<p>Use this one to get the running value:</p>\n\n<pre><code>=Code.AddTotal(Fields!Group.Value,Fields!Value.Value)\n</code></pre>\n\n<p>It will preview:</p>\n\n<p><a href=\"https://i.stack.imgur.com/yahCF.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/yahCF.png\" alt=\"enter image description here\"></a></p>\n\n<p>The red rectangle represent my dataset, the other data is added by expressions.</p>\n\n<hr>\n\n<p><strong>UPDATE:</strong>  Running value of first values based on user specification.</p>\n\n<p>Let me know if this was helpful.</p>\n\n<p>You can achieve this by adding row number to your dataset query.</p>\n\n<pre><code>select\n    ROW_NUMBER() OVER (Order by (select 1)) as row_num,\n    *\nfrom CTE\n</code></pre>\n\n<p>Note I am just adding row number and selecting all fields from CTE.\nThis is my dataset:</p>\n\n<p><a href=\"https://i.stack.imgur.com/fxHrt.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/fxHrt.png\" alt=\"enter image description here\"></a></p>\n\n<p>Modify the <code>AddTotal</code> function as follows</p>\n\n<pre><code>Dim public total as Integer \nDim public prevgroup as String = \"\"\n\nPublic Function AddTotal(ByVal group as String,ByVal value AS Integer, ByVal nextGroup As String ) AS Integer \n    If (group &lt;&gt; prevgroup) Then\n        total = total + value\n        prevgroup = group\n    End If\n\n    If (group &lt;&gt; nextGroup) Then\n        return total\n    End If\n    return 0         \nEnd Function \n</code></pre>\n\n<p>Configure your tablix as below:</p>\n\n<p><a href=\"https://i.stack.imgur.com/G0hrE.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/G0hrE.png\" alt=\"enter image description here\"></a></p>\n\n<p>In the expression set the following code:</p>\n\n<pre><code>=Code.AddTotal(Fields!Group.Value,Fields!Value.Value,\nlookup(Fields!row_num.Value + 1,Fields!row_num.Value,Fields!Group.Value,\"DataSet5\")\n)\n</code></pre>\n\n<p>Select the expression row and set the <code>Row visibility</code> setting with the following code:</p>\n\n<pre><code>=Iif(Code.AddTotal(Fields!Group.Value,Fields!Value.Value,\nlookup(Fields!row_num.Value + 1,Fields!row_num.Value,Fields!Group.Value,\"DataSet5\")\n)=0,True,False)\n</code></pre>\n\n<p>This will preview the below tablix:</p>\n\n<p><a href=\"https://i.stack.imgur.com/waQ0c.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/waQ0c.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 653, "user_id": 3581526, "user_type": "registered", "accept_rate": 48, "profile_image": "https://i.stack.imgur.com/31lGf.png?s=128&g=1", "display_name": "Nickso", "link": "https://stackoverflow.com/users/3581526/nickso"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1799, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1444921588, "creation_date": 1444850852, "last_edit_date": 1444914137, "question_id": 33133952, "link": "https://stackoverflow.com/questions/33133952/sum-the-first-element-of-each-group-and-with-runningvalue", "title": "Sum the first element of each group and with RunningValue", "body": "<p>I have a report on SSRS with a Dataset that have these 3 Fields:</p>\n\n<pre><code>Fields!MyFirstField.Value\nFields!MySecondField.Value\nFields!MyThirdField.Value\n</code></pre>\n\n<p>The report is divided into a group:\nIn my Row files I have</p>\n\n<pre><code>MyPrimaryGroup\n  MySeconday Group\n</code></pre>\n\n<p>And I have the Field that makes each group:</p>\n\n<pre><code>Fields!Group.Value\n</code></pre>\n\n<p>The idea is to accumulate the first element of each group of each field.</p>\n\n<p>What I did was the following:</p>\n\n<pre><code>Dim Acum as Double\nDim ActualGroup = \"\"\nFunction Accumulator(ByVal MyGroup as String, ByVal value as Double) As Double\n\n\nIf ActualGroup &lt;&gt; MyGroup\n    Acum= Acum + value\n    ActualGroup = MyGroup \n    Return Acum\n    value=0\nEnd If\n\n\nEnd Function\n</code></pre>\n\n<p>After this I made a calculated field like this:</p>\n\n<pre><code>=Code.Accumulator(Fields!Group.Value,Fields!MyFirstField.Value)\n</code></pre>\n\n<p>And put it in a row inside my primary group, the thing is, it is only accumulating the first two, for example:</p>\n\n<p>In this image we have a graphical example, what the code is doing is saving the first element of each group so in this case the Accumulated value should be <code>10+11+12=33</code> but the code is giving me <code>21</code>, is not saving the third value onwards]</p>\n\n<p><a href=\"https://i.stack.imgur.com/vQFuX.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/vQFuX.png\" alt=\"enter image description here\"></a></p>\n\n<p>This is one part of the problem, the other problem is that I cant make this accumulator work with a field that have a running value expression, for example:</p>\n\n<pre><code>FormatNumber(RunningValue(Fields!MySecondField.Value, Sum,\"MyDataset\"), 2)\n</code></pre>\n\n<p>Is there any way to sum the first element of each group and accumulate its value, the same with a field that is in fact a running value?</p>\n\n<p>To Give you more info about what I what to achieve, I screenshot the table:\n<a href=\"https://i.stack.imgur.com/qlesn.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/qlesn.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>Where you see blue circles, is in those Fields inside my group that I want to put the code and MyField3 is the running value and these are the groups:\n<a href=\"https://i.stack.imgur.com/NZ7IU.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/NZ7IU.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>This is more or less the info I have for the first two elements of my group:\n<a href=\"https://i.stack.imgur.com/JIBcY.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/JIBcY.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>So the code should:</p>\n\n<pre><code>If MERCH308 &lt;&gt; \"\" then\n0 = 0 + 6,80\n\"\" = MERCH308\nEnd If\n</code></pre>\n\n<p>On the next group it should do:</p>\n\n<pre><code>If MERCH314 &lt;&gt; MERCH308\n6,80 = 6,80 + 22,28\nMERCH308 = MERCH314\nEnd If\n</code></pre>\n\n<p>And By the next one:</p>\n\n<pre><code>If MERCH314 &lt;&gt; MERCH314\n//It does not enter the if\n</code></pre>\n\n<p>Until it sees a new group different from MERCH314, the problem is, that the only way for the code to function properly (as I investigated further) is to unmark the page break in the tablix and mark the \"Maintain everything in one page if possible\".</p>\n\n<p>And what Im trying to say with the runningvalue problem is the following:</p>\n\n<p>MyFields3 is a running value:</p>\n\n<pre><code>=FormatNumber(RunningValue(Fields!MyFields3.Value, Sum,\"MyDataset\",2)\n</code></pre>\n\n<p>But I can't Apply:</p>\n\n<pre><code>Code.Accumulator(Fields!MyGroup.Value,RunningValue(Fields!MyFields3.Value,Sum,\"Mydataset\")\n</code></pre>\n\n<p>As it says \"have an incorrect number as a parameter for the function RunningValue\"</p>\n\n<p>So the idea is to accumulate the 1st element of each group of an accumulator as \"RunningValue\" is in fact, an accumulator, so the idea is to sum (for my third column) the 6,80 + 29,08. But Remember that 29,08 is the result of a runningvalue.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1444850892, "post_id": 33133884, "comment_id": 54079447, "body": "Can you not use a simple vlookup formula in b and c?"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1444850957, "post_id": 33133884, "comment_id": 54079486, "body": "I think a vlookup (or index/match) formula would work.  Do you mind posting an example of what it should look like in the end?"}, {"owner": {"reputation": 89, "user_id": 5429130, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19417d3430015ddff4bc9eb8d747d94?s=128&d=identicon&r=PG&f=1", "display_name": "ahhn", "link": "https://stackoverflow.com/users/5429130/ahhn"}, "edited": false, "score": 0, "creation_date": 1444852394, "post_id": 33133884, "comment_id": 54080291, "body": "I am new to VBA, so I am not sure if vlookup would work. I can definitely look into that though!"}, {"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 0, "creation_date": 1444852587, "post_id": 33133884, "comment_id": 54080402, "body": "@ahhn VLookup isn&#39;t a VBA method - it&#39;s a worksheet function. <a href=\"https://support.office.com/en-us/article/VLOOKUP-function-0bbc8083-26fe-4963-8ab8-93a18ad188a1?ui=en-US&amp;rs=en-US&amp;ad=US&amp;fromAR=1\" rel=\"nofollow noreferrer\">Have a look at this article</a>"}, {"owner": {"reputation": 89, "user_id": 5429130, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19417d3430015ddff4bc9eb8d747d94?s=128&d=identicon&r=PG&f=1", "display_name": "ahhn", "link": "https://stackoverflow.com/users/5429130/ahhn"}, "edited": false, "score": 0, "creation_date": 1444853060, "post_id": 33133884, "comment_id": 54080698, "body": "I&#39;m not sure then if vlookup would work if it can&#39;t be used in VBA. I have over 2,500 entries in Column A which is why I was looking for a macro to help me to re-organize the output from the database."}], "answers": [{"comments": [{"owner": {"reputation": 89, "user_id": 5429130, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19417d3430015ddff4bc9eb8d747d94?s=128&d=identicon&r=PG&f=1", "display_name": "ahhn", "link": "https://stackoverflow.com/users/5429130/ahhn"}, "edited": false, "score": 0, "creation_date": 1444853875, "post_id": 33134756, "comment_id": 54081182, "body": "That works perfectly! Thank you! Do you mind explaining to me what it is doing?"}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 0, "last_activity_date": 1444853647, "creation_date": 1444853647, "answer_id": 33134756, "question_id": 33133884, "link": "https://stackoverflow.com/questions/33133884/find-non-static-value-and-paste-range-f1g1-next-to-found-cell-excel-vba/33134756#33134756", "title": "Find non-static [value] and paste range (F1:G1) next to &quot;found&quot; cell - Excel VBA", "body": "<p>This vba uses the worksheet function vlookup.</p>\n\n<pre><code>Sub ahhn()\n\nDim ws As Worksheet\nDim cel As Range\n\nSet ws = ActiveSheet\nWith ws\n    For Each cel In .Range(.Range(\"A1\"), .Range(\"A1\").End(xlDown))\n        cel.Offset(0, 1) = WorksheetFunction.IfError(Application.VLookup(cel, .Range(\"F:H\"), 2, 0), \"\")\n        cel.Offset(0, 2) = WorksheetFunction.IfError(Application.VLookup(cel, .Range(\"F:H\"), 3, 0), \"\")\n    Next\nEnd With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 89, "user_id": 5429130, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19417d3430015ddff4bc9eb8d747d94?s=128&d=identicon&r=PG&f=1", "display_name": "ahhn", "link": "https://stackoverflow.com/users/5429130/ahhn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 216, "favorite_count": 0, "accepted_answer_id": 33134756, "answer_count": 1, "score": -1, "last_activity_date": 1444853647, "creation_date": 1444850598, "last_edit_date": 1444852848, "question_id": 33133884, "link": "https://stackoverflow.com/questions/33133884/find-non-static-value-and-paste-range-f1g1-next-to-found-cell-excel-vba", "title": "Find non-static [value] and paste range (F1:G1) next to &quot;found&quot; cell - Excel VBA", "body": "<p>I have a list of query words that I am submitting to a database (Column A) to generate a list of coded matches (Columns F-H). Column F is the original search word (so there is an exact match somewhere in Column A), Column G contains the match, and Column H contains the code for the match. What I need to do is take the query word in Column F and find its partner in Column A. Then I need to take the corresponding match and its code and paste it next to the original search term in Column A (in Columns B&amp;C). </p>\n\n<p>My problem here is getting the information pasted in the correct cell since the copy to and paste from locations change every time -- The list of coded matches in Columns F-H does NOT contain all of the terms in Column A. </p>\n\n<p>I've been searching the internet and I can't seem to figure out what exactly I need to change to allow the paste function to work. </p>\n\n<p>I have attached an image of a simplified version of my spreadsheet and a annotated version of the code I have been working with.</p>\n\n<pre><code>Sub FindMatch()\n\nLastRow = Cells(Rows.Count, 6).End(xlUp).Row\n\nFor i = 1 To LastRow\n    FindMe = Cells(i, 6).Value\n    Set FoundinList = Cells.Find(What:=FindMe, After:=ActiveCell, LookAt:=xlWhole) \n\n    If Not FoundinList Is Nothing Then\n        FoundinList.Select\n        ActiveCell.Offset(0, 1).Select\n\n'At this point the cell I want the information pasted into is selected. Yay! \n'Example: I am trying to find \"abnormal digits\" (F1) in Column A and paste \n'G1:H1 into the appropriate cells in Columns B &amp; C (In this case B15:C15) \n'At this point in the code my cursor is on cell B15 - which is where I need it.\n\n        Range(Cells(i, 7), Cells(i, 8)).Copy\n\n'This selects the appropriate range (G1:H1 in my example).\n\n        ActiveCell.Paste\n\n'This is the problem string. I've tried naming the \"ActiveCell\" before initiating the copy \n'string (ActiveCell.Name = \"PasteHere\") and then pasting into the named cell \n'(Cells(\"PasteHere\").Paste), but that gives me an invalid procedure call or argument on: \n'Cells(\"PasteHere\").Paste    I've also tried pasting into a range:Range(Cells(PasteHere, 2)\n', Cells(PasteHere, 3)).Paste -AND- using the formula that is created when you a record a \n'macro (Application.CutCopyMode = False) but both of those give me an application\n'/object-defined error. \n\n    End If\nNext i\nEnd sub\n</code></pre>\n\n<p>Thank you so much in advance for reading this post and helping me out. </p>\n\n<p><a href=\"http://i.stack.imgur.com/H09df.png\" rel=\"nofollow\">My Spreadsheet</a></p>\n\n<p><a href=\"http://i.stack.imgur.com/3j92C.png\" rel=\"nofollow\">End Product</a></p>\n"}, {"tags": ["vb.net", "vba", "radio-button", "radiobuttonlist"], "comments": [{"owner": {"reputation": 4556, "user_id": 4801920, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/oahFl.jpg?s=128&g=1", "display_name": "Tony Hinkle", "link": "https://stackoverflow.com/users/4801920/tony-hinkle"}, "edited": false, "score": 1, "creation_date": 1444851572, "post_id": 33133751, "comment_id": 54079840, "body": "Copy/paste of <code>rblInspectionStatus.Items.FindByValue(&quot;Fail&quot;).Selected = True</code> works fine for me.  Either the sub this code is in is not running, or something is running after it that is overriding it."}, {"owner": {"reputation": 9028, "user_id": 341762, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/c9e40ea650664809cb82a148b8d86939?s=128&d=identicon&r=PG", "display_name": "NoAlias", "link": "https://stackoverflow.com/users/341762/noalias"}, "reply_to_user": {"reputation": 4556, "user_id": 4801920, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/oahFl.jpg?s=128&g=1", "display_name": "Tony Hinkle", "link": "https://stackoverflow.com/users/4801920/tony-hinkle"}, "edited": false, "score": 0, "creation_date": 1444859294, "post_id": 33133751, "comment_id": 54083904, "body": "I agree with @TonyHinkle - Is the RadioButtonList in an ItemTemplate, in say a Repeater Control or something similar?"}, {"owner": {"reputation": 896, "user_id": 2075992, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/MbXk7.jpg?s=128&g=1", "display_name": "Troy Bryant", "link": "https://stackoverflow.com/users/2075992/troy-bryant"}, "reply_to_user": {"reputation": 4556, "user_id": 4801920, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/oahFl.jpg?s=128&g=1", "display_name": "Tony Hinkle", "link": "https://stackoverflow.com/users/4801920/tony-hinkle"}, "edited": false, "score": 0, "creation_date": 1444910611, "post_id": 33133751, "comment_id": 54105378, "body": "@TonyHinkle this actually was correct.  I thought this the sub that contained the code to set the radio button was last but to my surprise it was not"}], "answers": [{"tags": [], "owner": {"reputation": 570, "user_id": 2914360, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/ZMvPd.jpg?s=128&g=1", "display_name": "eirishainjel", "link": "https://stackoverflow.com/users/2914360/eirishainjel"}, "is_accepted": true, "score": 0, "last_activity_date": 1444878613, "creation_date": 1444878613, "answer_id": 33139187, "question_id": 33133751, "link": "https://stackoverflow.com/questions/33133751/set-radio-button-list-from-vb-code-behind/33139187#33139187", "title": "Set radio button list from vb code behind", "body": "<p>I don't know what you are trying to do in that <code>Sub</code> or as User Tony Hinkle and User NoAlias are trying to say is correct but this is my assumption:</p>\n\n<pre><code>    Protected Sub Page_Load(ByVal sender As Object, ByVal e As System.EventArgs) Handles Me.Load\n            cn.Open() 'Opens the connection\n            cmd = New SqlCommand(\"SELECT PF FROM TABLE WHERE ID = '\" &amp; Session(\"ID\") &amp; \"'\", cn)\n            drr = cmd.ExecuteReader\n            If drr.Read Then\n                rblInspectionStatus.ClearSelection()\n                rblInspectionStatus.Items.FindByValue(drr.Items(\"PF\")).Selected = True\n            'FIELD PF data either Pass or Fail\n            ElseIf Not drr.Read Then\n                rblInspectionStatus.ClearSelection()\n                rblInspectionStatus.SelectedIndex = -1\n            End If\n            cn.Close() 'Close the connection\n        End Sub\n</code></pre>\n"}], "owner": {"reputation": 896, "user_id": 2075992, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/MbXk7.jpg?s=128&g=1", "display_name": "Troy Bryant", "link": "https://stackoverflow.com/users/2075992/troy-bryant"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1472, "favorite_count": 0, "accepted_answer_id": 33139187, "answer_count": 1, "score": 0, "last_activity_date": 1444913171, "creation_date": 1444850090, "last_edit_date": 1444913171, "question_id": 33133751, "link": "https://stackoverflow.com/questions/33133751/set-radio-button-list-from-vb-code-behind", "title": "Set radio button list from vb code behind", "body": "<p>I have a radio button list.  When the page is loaded I have some scripts and other things that run to determine if an ID has passed or failed a test.  So what I am trying to actually do is when that page loads set my radio button to  fail after the script runs</p>\n\n<p>Here is the list:</p>\n\n<pre><code>&lt;asp:radiobuttonlist id=\"rblInspectionStatus\" CssClass=\"descbold\"  runat=\"server\" repeatColumns=\"2\" repeatDirection=\"Horizontal\"&gt;\n       &lt;asp:listitem Value=\"Pass\"&gt;Pass&lt;/asp:listitem&gt;\n       &lt;asp:listitem Value=\"Fail\"&gt;Fail&lt;/asp:listitem&gt;\n&lt;/asp:radiobuttonlist&gt;\n</code></pre>\n\n<p>What I have tried is:</p>\n\n<pre><code>rblInspectionStatus.Items.FindByValue(\"Fail\").Selected = True \nrblInspectionStatus.Items.FindByText(\"Fail\").Selected = True\nrblInspectionStatus.SelectedIndex |SelectedItem | SelectedValue\n</code></pre>\n"}, {"tags": ["ms-access", "vba"], "answers": [{"comments": [{"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1444854113, "post_id": 33134796, "comment_id": 54081325, "body": "Something got hosed.  Your VBA code includes <code>strSQL = strSQL &amp; &quot; WHERE Email = &quot; &amp; &quot;&quot;&quot;&quot; &amp; strEmail &amp; &quot;&quot;&quot;&quot; &amp; &quot;&quot;</code> ... but there is no <code>WHERE</code> clause in this <code>UPDATE</code> statement."}, {"owner": {"reputation": 1, "user_id": 5376903, "user_type": "registered", "profile_image": "https://graph.facebook.com/10205399172239116/picture?type=large", "display_name": "CiscoSteve", "link": "https://stackoverflow.com/users/5376903/ciscosteve"}, "reply_to_user": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1444854406, "post_id": 33134796, "comment_id": 54081513, "body": "Debug.Print strSQL Update tblProspect Set FirstName = &quot;Jon&quot;,LastName = &quot;Snow&quot;,Industry = &quot;Other&quot;,Geography = &quot;&quot;,StrengthofRelationship = &quot;&quot;,School = &quot;&quot;,Company = &quot;&quot;,Title = &quot;&quot;,Status = &quot;Dead&quot;, InfluenceLevel = &quot;&quot;, FormerClient = 0, FormerCoWorker = 0,Email = &quot;jsnow@winterfell&quot;,Phone = &quot;&quot;,ProspectOwner = &quot;&quot;,Notes = &quot;&quot; WHERE Email = &quot;jsnow@winterfell&quot;"}, {"owner": {"reputation": 1, "user_id": 5376903, "user_type": "registered", "profile_image": "https://graph.facebook.com/10205399172239116/picture?type=large", "display_name": "CiscoSteve", "link": "https://stackoverflow.com/users/5376903/ciscosteve"}, "reply_to_user": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1444854427, "post_id": 33134796, "comment_id": 54081522, "body": "^^ That is it with the WHERE clause"}], "tags": [], "owner": {"reputation": 1, "user_id": 5376903, "user_type": "registered", "profile_image": "https://graph.facebook.com/10205399172239116/picture?type=large", "display_name": "CiscoSteve", "link": "https://stackoverflow.com/users/5376903/ciscosteve"}, "is_accepted": false, "score": 0, "last_activity_date": 1444853826, "creation_date": 1444853826, "answer_id": 33134796, "question_id": 33133732, "link": "https://stackoverflow.com/questions/33133732/cannot-update-a-textbox-on-a-form-in-access-vba/33134796#33134796", "title": "Cannot update a textbox on a form in Access vba", "body": "<p>It comes out exactly likely I want it to in Debug.Print, but it does not save that way in the contact profile. </p>\n\n<pre><code>Debug.Print strSQL\nUpdate tblProspect Set FirstName = \"Jon\",LastName = \"Snow\",Industry = \"Other\",Geography = \"\",StrengthofRelationship = \"\",School = \"\",Company = \"\",Title = \"\",Status = \"Dead\", InfluenceLevel = \"\", FormerClient = 0, FormerCoWorker = 0,Email = \"jsnow@winterfell\",Phone = \"\",ProspectOwner = \"\",Notes = \"\"\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 5376903, "user_type": "registered", "profile_image": "https://graph.facebook.com/10205399172239116/picture?type=large", "display_name": "CiscoSteve", "link": "https://stackoverflow.com/users/5376903/ciscosteve"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 168, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1444914082, "creation_date": 1444850042, "question_id": 33133732, "link": "https://stackoverflow.com/questions/33133732/cannot-update-a-textbox-on-a-form-in-access-vba", "title": "Cannot update a textbox on a form in Access vba", "body": "<p>I am working on an Access DB that sorts and tracks my firm's business contacts. We have a form called \"Contact Profile\" whereby the user can select a given contact and view all of his information: First Name, Last Name, Company, Title, Email Address, etc. </p>\n\n<p>On the profile, the user can update a contact's information with the \"Update Info\" button. </p>\n\n<p>Every single field updates just fine--with the exception of Email Address. For example, I can change Joseph Smith, Programmer at Google to Joe Smith, Program Manager at GOOG with no issues. </p>\n\n<p>But if I try to change joesmith@google.com to jsmith@google.com, the change does not save. Code is posted below. Could someone please take a look and let me know if they have any suggestions? Thanks!</p>\n\n<pre><code>Private Sub Command61_Click()\n\nDim strFirstName As String\nDim strLastName As String\nDim strIndustry As String\nDim strCountry As String\nDim strState As String\nDim strCity As String\nDim strCompany As String\nDim strTitle As String\nDim strStatus As String\nDim strPhone As String\nDim strEmail As String\nDim strOwner As String\nDim DateNow As String\n\n'Allow user to leave some fields blank. User must fill in certain fields.\n\nDim VisEnable\n\nIf IsNull(Me.txtFirstName) Then\n    MsgBox (\"Please add First Name for this Prospect\")\n    Me.txtFirstName.SetFocus\n    Exit Sub\nEnd If\n\nIf IsNull(Me.txtLastName) Then\n    MsgBox (\"Please add Last Name for this Prospect\")\n    Me.txtLastName.SetFocus\n    Exit Sub\nEnd If\n\nIf IsNull(Me.cboIndustry) Then\n    Me.cboIndustry = \"\"\nEnd If\n\nIf IsNull(Me.cboGeo) Then\n    Me.cboGeo = \"\"\nEnd If\n\nIf IsNull(Me.cboInfluence) Then\n    Me.cboInfluence = \"\"\nEnd If\n\nIf IsNull(Me.cboSchool) Then\n    Me.cboSchool = \"\"\nEnd If\n\nIf IsNull(Me.cboTier) Then\n    Me.cboTier = \"\"\nEnd If\n\nIf IsNull(Me.cboCompany) Then\n    Me.cboCompany = \"\"\nEnd If\n\nIf IsNull(Me.txtTitle) Then\n    Me.txtTitle = \"\"\nEnd If\n\nIf IsNull(Me.cboStatus) Then\n    Me.cboStatus = \"\"\nEnd If\n\nIf IsNull(Me.cboOwner) Then\n    Me.cboOwner = \"\"\nEnd If\n\nIf IsNull(Me.txtPhone) Then\n    Me.txtPhone = \"\"\nEnd If\n\nIf IsNull(Me.txtEmail) Then\n    MsgBox (\"Please add Email for this Prospect\")\n    Me.txtEmail.SetFocus\n    Exit Sub\nEnd If\n\nIf IsNull(Me.txtNotes) Then\n    Me.txtNotes = \"\"\nEnd If\n\nIf IsNull(Me.txtInitialProspectEmailSentDate) Then\nMe.txtInitialProspectEmailSentDate = \"\"\nEnd If\n\nIf IsNull(Me.txtNextTouchPoint) Then\nMe.txtNextTouchPoint = \"\"\nEnd If\n\nstrFirstName = Me.txtFirstName\nstrLastName = Me.txtLastName\nstrIndustry = Me.cboIndustry\nstrCompany = Me.cboCompany\nstrTitle = Me.txtTitle\nstrStatus = Me.cboStatus\nstrPhone = Me.txtPhone\nstrEmail = Me.txtEmail\nstrNotes = Me.txtNotes\nstrOwner = Me.cboOwner\ndtEmailSent = Me.txtInitialProspectEmailSentDate\ndtNextTouchPoint = Me.txtNextTouchPoint\nstrRegion = Me.cboGeo\nstrSoR = Me.cboTier\nstrInfluence = Me.cboInfluence\nstrClient = Me.ckClient\nstrCoworker = Me.ckCoworker\nstrSchool = Me.cboSchool\n\nstrSQL = \"Update tblProspect Set FirstName = \" &amp; \"\"\"\" &amp; strFirstName &amp; \"\"\"\" &amp; \",LastName = \" &amp; \"\"\"\" &amp; strLastName &amp; \"\"\"\" &amp; \",Industry = \" &amp; \"\"\"\" &amp; strIndustry &amp; \"\"\"\" &amp; \"\" &amp; _\n\",Geography = \" &amp; \"\"\"\" &amp; strRegion &amp; \"\"\"\" &amp; \",StrengthofRelationship = \" &amp; \"\"\"\" &amp; strSoR &amp; \"\"\"\" &amp; \",School = \" &amp; \"\"\"\" &amp; strSchool &amp; \"\"\"\" &amp; \",Company = \" &amp; \"\"\"\" &amp; strCompany &amp; \"\"\"\" &amp; \"\" &amp; _\n\",Title = \" &amp; \"\"\"\" &amp; strTitle &amp; \"\"\"\" &amp; \",Status = \" &amp; \"\"\"\" &amp; strStatus &amp; \"\"\"\" &amp; \", InfluenceLevel = \" &amp; \"\"\"\" &amp; strInfluence &amp; \"\"\"\" &amp; \", FormerClient = \" &amp; strClient &amp; \", FormerCoWorker = \" &amp; strCoworker &amp; \"\" &amp; _\n\",Email = \" &amp; \"\"\"\" &amp; strEmail &amp; \"\"\"\" &amp; \",Phone = \" &amp; \"\"\"\" &amp; strPhone &amp; \"\"\"\" &amp; \",ProspectOwner = \" &amp; \"\"\"\" &amp; strOwner &amp; \"\"\"\" &amp; \",Notes = \" &amp; \"\"\"\" &amp; strNotes &amp; \"\"\"\" &amp; \"\"\n\n\nIf dtNextTouchPoint &lt;&gt; \"\" Then\nstrSQL = strSQL &amp; \" ,NextTouchPoint = #\" &amp; dtNextTouchPoint &amp; \"#\"\nEnd If\n\nIf dtEmailSent &lt;&gt; \"\" Then\nstrSQL = strSQL &amp; \" ,LastEmailDate = #\" &amp; dtEmailSent &amp; \"#\"\nEnd If\nstrSQL = strSQL &amp; \" WHERE Email = \" &amp; \"\"\"\" &amp; strEmail &amp; \"\"\"\" &amp; \"\"\nDoCmd.SetWarnings False\nDoCmd.RunSQL strSQL\nDoCmd.SetWarnings True\n\n\n     Dim ctl As Control\n    For Each ctl In Me.Controls\n        Select Case ctl.ControlType\n            Case acTextBox, acComboBox, acListBox, acCheckBox\n                If ctl.ControlSource = \"\" Then\n                    ctl.Value = Null\n                End If\n            Case Else\n        End Select\n    Next ctl\n\n\nMe.Visible = False\nDoCmd.OpenForm \"frmProspectAdmin\", acNormal, , , acFormEdit, acWindowNormal\n\nDoCmd.RunCommand acCmdSaveRecord\n\nForm_frmProspectProfile.Refresh\n\nForm_frmProspectAdmin.Refresh\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "outlook", "vsto", "visual-studio-2015"], "comments": [{"owner": {"reputation": 971, "user_id": 3177855, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/909e8e34e0ec4b66788e190c7bf1e4f3?s=128&d=identicon&r=PG&f=1", "display_name": "DanL", "link": "https://stackoverflow.com/users/3177855/danl"}, "edited": false, "score": 0, "creation_date": 1444991519, "post_id": 33133431, "comment_id": 54144308, "body": "Can you check if it&#39;s Session or GetDefaultFolder? If it&#39;s Session, you can try to replace the Session reference above with myOlApp.Session."}, {"owner": {"reputation": 65, "user_id": 1351396, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/16d07855156b538d28852b4e6a049101?s=128&d=identicon&r=PG", "display_name": "CWB", "link": "https://stackoverflow.com/users/1351396/cwb"}, "reply_to_user": {"reputation": 971, "user_id": 3177855, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/909e8e34e0ec4b66788e190c7bf1e4f3?s=128&d=identicon&r=PG&f=1", "display_name": "DanL", "link": "https://stackoverflow.com/users/3177855/danl"}, "edited": false, "score": 0, "creation_date": 1445001429, "post_id": 33133431, "comment_id": 54150491, "body": "Alright I gave that a try but I receive the same result. After swapping in the OlApp.Session I get an underlined &quot;olPublicFoldersAllPublicFolders&quot; ---objFolder = myOlApp.Session.GetDefaultFolder(olPublicFoldersAllPublicFol&zwnj;&#8203;ders).Folders(&quot;Share&zwnj;&#8203;d Documents&quot;) ----- Same Null Reference, I see why it would be Null because the value isn&#39;t obtained until the Outlook session feeds the path to the program."}, {"owner": {"reputation": 65, "user_id": 1351396, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/16d07855156b538d28852b4e6a049101?s=128&d=identicon&r=PG", "display_name": "CWB", "link": "https://stackoverflow.com/users/1351396/cwb"}, "reply_to_user": {"reputation": 971, "user_id": 3177855, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/909e8e34e0ec4b66788e190c7bf1e4f3?s=128&d=identicon&r=PG&f=1", "display_name": "DanL", "link": "https://stackoverflow.com/users/3177855/danl"}, "edited": false, "score": 0, "creation_date": 1445001747, "post_id": 33133431, "comment_id": 54150710, "body": "To make clear what I&#39;m doing: I&#39;m trying to open a Custom Form which is stored in the All Public Folders \\ Shared Documents \\ FormName  --Macro does this perfectly fine but I&#39;d like it to be an add-in so I can deploy it as a package along with the other functions that work."}], "answers": [{"tags": [], "owner": {"reputation": 65, "user_id": 1351396, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/16d07855156b538d28852b4e6a049101?s=128&d=identicon&r=PG", "display_name": "CWB", "link": "https://stackoverflow.com/users/1351396/cwb"}, "is_accepted": false, "score": 1, "last_activity_date": 1445003290, "creation_date": 1445003290, "answer_id": 33172138, "question_id": 33133431, "link": "https://stackoverflow.com/questions/33133431/outlook-vba-macro-conversion-to-add-in/33172138#33172138", "title": "Outlook VBA \\ Macro conversion to Add-in", "body": "<p>Alrighty, it's working meow.\nFound this handy dandy webpage in case someone needs some pointers:\n<a href=\"https://support.microsoft.com/en-us/kb/313800\" rel=\"nofollow\">https://support.microsoft.com/en-us/kb/313800</a></p>\n\n<p>When you create a project for Outlook Add-ins it's being coded in VB.Net</p>\n\n<p>Thank you <strong>DanL</strong> for the input, it got me thinking and searching again.</p>\n\n<pre><code>Private Sub Button1_Click(sender As Object, e As RibbonControlEventArgs) Handles Button1.Click\n\n    Dim objOutlook As Outlook._Application\n    objOutlook = New Outlook.Application()\n    Dim objNS As Outlook._NameSpace = objOutlook.Session\n    Dim objFolder As Outlook.MAPIFolder =\n         objNS.GetDefaultFolder(Outlook.OlDefaultFolders.olPublicFoldersAllPublicFolders).Folders(\"Shared Documents\")\n\n    Dim myItem = objFolder.Items.Add(\"IPM.Note.CustomFormName\")\n    myItem.Display()\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 65, "user_id": 1351396, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/16d07855156b538d28852b4e6a049101?s=128&d=identicon&r=PG", "display_name": "CWB", "link": "https://stackoverflow.com/users/1351396/cwb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2632, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1445003290, "creation_date": 1444849026, "question_id": 33133431, "link": "https://stackoverflow.com/questions/33133431/outlook-vba-macro-conversion-to-add-in", "title": "Outlook VBA \\ Macro conversion to Add-in", "body": "<p>I'm in the process of converting some Outlook VBA \\ Macros into add-ins.\nSo far I'm not having a lot of luck piping this code over to VS2015 w\\Office Dev Tools.</p>\n\n<p>I've created a ribbon \\ group \\ buttons \\ I can see it in Outlook and everything looks good but I'm receiving an error.</p>\n\n<p><strong>--ORIGINAL MACRO--</strong></p>\n\n<pre><code>Sub Request()\n  Set myOlApp = CreateObject(\"Outlook.Application\")\n  Set myNameSpace = myOlApp.Application.GetNamespace(\"MAPI\")\n  Set objFolder = Session.GetDefaultFolder(olPublicFoldersAllPublicFolders).Folders(\"Shared Documents\")\n  Set myItem = objFolder.Items.Add(\"IPM.Note.Request\")\n       myItem.Display\nEnd Sub\n</code></pre>\n\n<p>I'm seeing that Set is no longer permitted so they've all been defined.</p>\n\n<p>This particular line seems to be the problem.\nSession and\\or GetDefaultFolder are returning Null and causing a runtime exception.</p>\n\n<p><strong>Error -- \"System.NullReferenceException\" --</strong></p>\n\n<pre><code>    objFolder = Session.GetDefaultFolder(olPublicFoldersAllPublicFolders).Folders(\"Shared Documents\")\n</code></pre>\n\n<p>The suggestion from VS is to use the Sub \"New\" along with a few others that don't seem applicable.</p>\n\n<p>A little help please. :-)\nSeems that I'm getting a mix of programming types mixed up from the VS error resolution suggestions.</p>\n\n<p>Thank you. -Chris</p>\n"}, {"tags": ["excel", "vba", "web"], "comments": [{"owner": {"reputation": 2000, "user_id": 4487286, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YHZoO.jpg?s=128&g=1", "display_name": "milevyo", "link": "https://stackoverflow.com/users/4487286/milevyo"}, "edited": false, "score": 0, "creation_date": 1444848962, "post_id": 33133113, "comment_id": 54078333, "body": "use URLDownloadToFile function of urlmon , there are too many tutorials about that function"}, {"owner": {"reputation": 743, "user_id": 4968696, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/zk5NZ.png?s=128&g=1", "display_name": "WPZA", "link": "https://stackoverflow.com/users/4968696/wpza"}, "reply_to_user": {"reputation": 2000, "user_id": 4487286, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YHZoO.jpg?s=128&g=1", "display_name": "milevyo", "link": "https://stackoverflow.com/users/4487286/milevyo"}, "edited": false, "score": 0, "creation_date": 1444850153, "post_id": 33133113, "comment_id": 54079026, "body": "I need the image on the page at that moment in time, it is an animated gif and resets every time you re-load the page."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 2000, "user_id": 4487286, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YHZoO.jpg?s=128&g=1", "display_name": "milevyo", "link": "https://stackoverflow.com/users/4487286/milevyo"}, "edited": false, "score": 1, "creation_date": 1444850444, "post_id": 33133113, "comment_id": 54079190, "body": "Following @milevyo&#39;s reply, <a href=\"https://www.google.com/search?q=URLDownloadToFile&amp;oq=URLDownloadToFile+&amp;aqs=chrome..69i57&amp;sourceid=chrome&amp;es_sm=93&amp;ie=UTF-8#q=urldownloadtofile+vba\" rel=\"nofollow noreferrer\">Googling around</a> finds many promising pages.  Have you tried looking into that?  Also, see <a href=\"http://www.cpearson.com/excel/downloadfile.aspx\" rel=\"nofollow noreferrer\">Chip Pearson&#39;s</a> page on downloading files."}, {"owner": {"reputation": 2000, "user_id": 4487286, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YHZoO.jpg?s=128&g=1", "display_name": "milevyo", "link": "https://stackoverflow.com/users/4487286/milevyo"}, "edited": false, "score": 0, "creation_date": 1444851775, "post_id": 33133113, "comment_id": 54079939, "body": "what you mean by live image?. an image on every instance or animated gif?"}], "answers": [{"tags": [], "owner": {"reputation": 2000, "user_id": 4487286, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YHZoO.jpg?s=128&g=1", "display_name": "milevyo", "link": "https://stackoverflow.com/users/4487286/milevyo"}, "is_accepted": true, "score": 0, "last_activity_date": 1444851692, "creation_date": 1444851692, "answer_id": 33134191, "question_id": 33133113, "link": "https://stackoverflow.com/questions/33133113/open-webpage-and-save-image/33134191#33134191", "title": "Open webpage and save image", "body": "<pre><code>Private Declare Function URLDownloadToFile Lib \"urlmon\" Alias \"URLDownloadToFileA\" ( _\nByVal pCaller As Long, ByVal szURL As String, ByVal szFileName As String, ByVal dwReserved As Long, ByVal lpfnCB As Long) As Long\n\n\n\n\n\nPrivate Sub Command1_Click()\n    Dim sin As String\n    Dim sout As String\n\n    Dim ret As Long\n\n    sin = \"https://upload.wikimedia.org/wikipedia/commons/0/0e/Balle.gif\"\n    sout = Environ(\"HOMEPATH\") &amp; \"\\Desktop\\\" &amp; \"image.gif\"\n\n    ret = URLDownloadToFile(0, sin, sout, 0, 0)\n    If (ret = 0) Then MsgBox \"Succedded\" Else MsgBox \"failed\"\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 743, "user_id": 4968696, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/zk5NZ.png?s=128&g=1", "display_name": "WPZA", "link": "https://stackoverflow.com/users/4968696/wpza"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1359, "favorite_count": 0, "accepted_answer_id": 33134191, "answer_count": 1, "score": -1, "last_activity_date": 1444929431, "creation_date": 1444847934, "last_edit_date": 1444929431, "question_id": 33133113, "link": "https://stackoverflow.com/questions/33133113/open-webpage-and-save-image", "title": "Open webpage and save image", "body": "<p>I am currently using the following VBA code to open the website on IE:</p>\n\n<pre><code>Set IE = CreateObject(\"internetexplorer.application\")\n    IE.Visible = True\n    IE.Navigate \"http://test.com\"\n</code></pre>\n\n<p>I now need to download an image from the website as a .gif which has the following source (from using inspect element):</p>\n\n<pre><code>&lt;img src=\"test.php\" align=\"left\"&gt;\n</code></pre>\n\n<p>Any advise on how I could do this please?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "edited": false, "score": 2, "creation_date": 1444847534, "post_id": 33132921, "comment_id": 54077473, "body": "Looks like you are missing an <code>end if</code> after <code>end with</code>"}, {"owner": {"reputation": 635, "user_id": 5071216, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh5.googleusercontent.com/-LjxRu3CIx6s/AAAAAAAAAAI/AAAAAAAAABY/D4C4_4oGl2I/photo.jpg?sz=128", "display_name": "Jordan Davis", "link": "https://stackoverflow.com/users/5071216/jordan-davis"}, "reply_to_user": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "edited": false, "score": 0, "creation_date": 1444847942, "post_id": 33132921, "comment_id": 54077732, "body": "No that doesn&#39;t help. It seems to not like the Formula1 parameter"}, {"owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "edited": false, "score": 0, "creation_date": 1444848579, "post_id": 33132921, "comment_id": 54078101, "body": "Remove the brackets: <code>.Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop,Formula1:=&quot;=Enterprise!A1:A6&quot;</code>"}, {"owner": {"reputation": 635, "user_id": 5071216, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh5.googleusercontent.com/-LjxRu3CIx6s/AAAAAAAAAAI/AAAAAAAAABY/D4C4_4oGl2I/photo.jpg?sz=128", "display_name": "Jordan Davis", "link": "https://stackoverflow.com/users/5071216/jordan-davis"}, "reply_to_user": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "edited": false, "score": 0, "creation_date": 1444850023, "post_id": 33132921, "comment_id": 54078954, "body": "@Davesexcel ended up I did need the end if after the end with, but removing the parenthesis was needed first"}], "answers": [{"tags": [], "owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "is_accepted": true, "score": 2, "last_activity_date": 1444848469, "creation_date": 1444848469, "answer_id": 33133271, "question_id": 33132921, "link": "https://stackoverflow.com/questions/33132921/add-validation-to-cell-with-vba/33133271#33133271", "title": "Add Validation to cell with VBA", "body": "<p>There is no need to add the opening and closing parenthesis from this line:</p>\n\n<pre><code>.Add(Type:=xlValidateList, AlertStyle:=xlValidAlertStop,Formula1:=\"=Enterprise!A1:A6\")\n</code></pre>\n\n<p>It should read:</p>\n\n<pre><code>.Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop,Formula1:=\"=Enterprise!A1:A6\"\n</code></pre>\n"}], "owner": {"reputation": 635, "user_id": 5071216, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh5.googleusercontent.com/-LjxRu3CIx6s/AAAAAAAAAAI/AAAAAAAAABY/D4C4_4oGl2I/photo.jpg?sz=128", "display_name": "Jordan Davis", "link": "https://stackoverflow.com/users/5071216/jordan-davis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 145, "favorite_count": 0, "accepted_answer_id": 33133271, "answer_count": 1, "score": 0, "last_activity_date": 1444848469, "creation_date": 1444847296, "last_edit_date": 1531164843, "question_id": 33132921, "link": "https://stackoverflow.com/questions/33132921/add-validation-to-cell-with-vba", "title": "Add Validation to cell with VBA", "body": "<p>I am trying to add a validation list to Excel that changes via the user's response to a message box. </p>\n\n<p>This is what I have: </p>\n\n<pre><code> If Not Application.Intersect(Me.[B9], ActiveCell) Is Nothing Then\n    Worksheets(\"New_Project_Code_Request\").Range(\"B9\").Value = \"\"\n    strYN = MsgBox(Prompt:=\"Is this Project Code Request for Cerner HS?\", Buttons:=vbExclamation + vbYesNo, Title:=\"Cerner HS Project Code Request\")\n    If strYN = vbNo Then\n        With Range(\"B9\").Validation\n       .Delete\n       .Add(Type:=xlValidateList, AlertStyle:=xlValidAlertStop,Formula1:=\"=Enterprise!A1:A6\")\n        End With\n    If strYN = vbYes Then Worksheets(\"Category\").Range(\"E1\").Value = 2\nEnd If\n</code></pre>\n\n<p>I keep getting the error</p>\n\n<p>Compile Error:  Expected: =</p>\n\n<p>I don't know what I am missing. </p>\n"}, {"tags": ["vba", "excel", "outlook"], "comments": [{"owner": {"reputation": 31066, "user_id": 2704659, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/wObcB.jpg?s=128&g=1", "display_name": "rory.ap", "link": "https://stackoverflow.com/users/2704659/rory-ap"}, "edited": false, "score": 0, "creation_date": 1444847011, "post_id": 33132794, "comment_id": 54077192, "body": "So.....what is your question?"}, {"owner": {"reputation": 241, "user_id": 5429649, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh4.googleusercontent.com/-uQe9HBX8x4I/AAAAAAAAAAI/AAAAAAAAAEM/CoSLMAHVowE/photo.jpg?sz=128", "display_name": "Atul Vij", "link": "https://stackoverflow.com/users/5429649/atul-vij"}, "reply_to_user": {"reputation": 31066, "user_id": 2704659, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/wObcB.jpg?s=128&g=1", "display_name": "rory.ap", "link": "https://stackoverflow.com/users/2704659/rory-ap"}, "edited": false, "score": 0, "creation_date": 1444847089, "post_id": 33132794, "comment_id": 54077244, "body": "i want to know why is it not saving excel file what is the code issue and sorry i am new i tried to save code but it got hay wired....."}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1444847130, "post_id": 33132794, "comment_id": 54077269, "body": "<code>f</code> isn&#39;t defined XD"}, {"owner": {"reputation": 241, "user_id": 5429649, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh4.googleusercontent.com/-uQe9HBX8x4I/AAAAAAAAAAI/AAAAAAAAAEM/CoSLMAHVowE/photo.jpg?sz=128", "display_name": "Atul Vij", "link": "https://stackoverflow.com/users/5429649/atul-vij"}, "edited": false, "score": 0, "creation_date": 1444847487, "post_id": 33132794, "comment_id": 54077450, "body": "f = a.Value  EmailAddr = f"}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1444847831, "post_id": 33132794, "comment_id": 54077656, "body": "uh that isn&#39;t in the code you posted and <code>a</code> is also not defined XD"}, {"owner": {"reputation": 241, "user_id": 5429649, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh4.googleusercontent.com/-uQe9HBX8x4I/AAAAAAAAAAI/AAAAAAAAAEM/CoSLMAHVowE/photo.jpg?sz=128", "display_name": "Atul Vij", "link": "https://stackoverflow.com/users/5429649/atul-vij"}, "edited": false, "score": 0, "creation_date": 1444847916, "post_id": 33132794, "comment_id": 54077717, "body": "Actually the code is very big last time i posted people not able to understand i just posted part of it which is creating issue"}, {"owner": {"reputation": 1518, "user_id": 1196076, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/tXSlo.jpg?s=128&g=1", "display_name": "Rick Burns", "link": "https://stackoverflow.com/users/1196076/rick-burns"}, "edited": false, "score": 0, "creation_date": 1444849170, "post_id": 33132794, "comment_id": 54078448, "body": "Please provide the code for each of the variables shown in your code sample so we can help debug."}, {"owner": {"reputation": 241, "user_id": 5429649, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh4.googleusercontent.com/-uQe9HBX8x4I/AAAAAAAAAAI/AAAAAAAAAEM/CoSLMAHVowE/photo.jpg?sz=128", "display_name": "Atul Vij", "link": "https://stackoverflow.com/users/5429649/atul-vij"}, "edited": false, "score": 0, "creation_date": 1444849573, "post_id": 33132794, "comment_id": 54078691, "body": "I can edit but it will be too long for everyone..."}, {"owner": {"reputation": 241, "user_id": 5429649, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh4.googleusercontent.com/-uQe9HBX8x4I/AAAAAAAAAAI/AAAAAAAAAEM/CoSLMAHVowE/photo.jpg?sz=128", "display_name": "Atul Vij", "link": "https://stackoverflow.com/users/5429649/atul-vij"}, "edited": false, "score": 0, "creation_date": 1444849680, "post_id": 33132794, "comment_id": 54078748, "body": "Done now you can see full code"}, {"owner": {"reputation": 1518, "user_id": 1196076, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/tXSlo.jpg?s=128&g=1", "display_name": "Rick Burns", "link": "https://stackoverflow.com/users/1196076/rick-burns"}, "edited": false, "score": 0, "creation_date": 1444849763, "post_id": 33132794, "comment_id": 54078794, "body": "@AtulVij, where is <code>pathDefinition()</code>?"}, {"owner": {"reputation": 241, "user_id": 5429649, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh4.googleusercontent.com/-uQe9HBX8x4I/AAAAAAAAAAI/AAAAAAAAAEM/CoSLMAHVowE/photo.jpg?sz=128", "display_name": "Atul Vij", "link": "https://stackoverflow.com/users/5429649/atul-vij"}, "edited": false, "score": 0, "creation_date": 1444849908, "post_id": 33132794, "comment_id": 54078886, "body": "Its different small Macro for saving but i removed it and edited save file option with wb2.SaveAs FileName:=&quot;D:\\&quot; &amp; f &amp; &quot;.xlsx&quot;, _ FileFormat:=xlOpenXMLWorkbook, CreateBackup:=False wb2.Close Instead of wb2.SaveAs FileName:=var &amp; &quot;\\&quot; &amp; f &amp; &quot;.xlsx&quot;, _ FileFormat:=xlOpenXMLWorkbook, CreateBackup:=False wb2.Close"}, {"owner": {"reputation": 1518, "user_id": 1196076, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/tXSlo.jpg?s=128&g=1", "display_name": "Rick Burns", "link": "https://stackoverflow.com/users/1196076/rick-burns"}, "edited": false, "score": 0, "creation_date": 1444850068, "post_id": 33132794, "comment_id": 54078975, "body": "What version of Office?"}, {"owner": {"reputation": 241, "user_id": 5429649, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh4.googleusercontent.com/-uQe9HBX8x4I/AAAAAAAAAAI/AAAAAAAAAEM/CoSLMAHVowE/photo.jpg?sz=128", "display_name": "Atul Vij", "link": "https://stackoverflow.com/users/5429649/atul-vij"}, "edited": false, "score": 0, "creation_date": 1444850210, "post_id": 33132794, "comment_id": 54079059, "body": "I am using this code in my other macro to save file but this do not work in this outlook version or macro.. might give some help...  wbNam = &quot;BL with comment on &quot; dt = Format(CStr(Now), &quot;dd.mm.yyyy_hh.mm.ss AMPM&quot;) ActiveWorkbook.SaveAs FileName:=wbNam &amp; dt &amp; &quot;.xlsm&quot;"}], "answers": [{"comments": [{"owner": {"reputation": 241, "user_id": 5429649, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh4.googleusercontent.com/-uQe9HBX8x4I/AAAAAAAAAAI/AAAAAAAAAEM/CoSLMAHVowE/photo.jpg?sz=128", "display_name": "Atul Vij", "link": "https://stackoverflow.com/users/5429649/atul-vij"}, "edited": false, "score": 0, "creation_date": 1444851093, "post_id": 33133973, "comment_id": 54079559, "body": "so what i should use in place of this coding also. for me its not poping outlook window also. IS there any way we can auto save it in documents and send email"}, {"owner": {"reputation": 1518, "user_id": 1196076, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/tXSlo.jpg?s=128&g=1", "display_name": "Rick Burns", "link": "https://stackoverflow.com/users/1196076/rick-burns"}, "reply_to_user": {"reputation": 241, "user_id": 5429649, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh4.googleusercontent.com/-uQe9HBX8x4I/AAAAAAAAAAI/AAAAAAAAAEM/CoSLMAHVowE/photo.jpg?sz=128", "display_name": "Atul Vij", "link": "https://stackoverflow.com/users/5429649/atul-vij"}, "edited": false, "score": 0, "creation_date": 1444851367, "post_id": 33133973, "comment_id": 54079715, "body": "@AtulVij without knowing what you&#39;re trying to do with this line, I can only guess, it appears to be comparing some Range against &quot;*&quot;."}, {"owner": {"reputation": 1518, "user_id": 1196076, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/tXSlo.jpg?s=128&g=1", "display_name": "Rick Burns", "link": "https://stackoverflow.com/users/1196076/rick-burns"}, "reply_to_user": {"reputation": 241, "user_id": 5429649, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh4.googleusercontent.com/-uQe9HBX8x4I/AAAAAAAAAAI/AAAAAAAAAEM/CoSLMAHVowE/photo.jpg?sz=128", "display_name": "Atul Vij", "link": "https://stackoverflow.com/users/5429649/atul-vij"}, "edited": false, "score": 0, "creation_date": 1444851800, "post_id": 33133973, "comment_id": 54079959, "body": "@AtulVij please see updated answer for automatic email sending"}, {"owner": {"reputation": 241, "user_id": 5429649, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh4.googleusercontent.com/-uQe9HBX8x4I/AAAAAAAAAAI/AAAAAAAAAEM/CoSLMAHVowE/photo.jpg?sz=128", "display_name": "Atul Vij", "link": "https://stackoverflow.com/users/5429649/atul-vij"}, "edited": false, "score": 0, "creation_date": 1444852077, "post_id": 33133973, "comment_id": 54080119, "body": "actually it combine multiple fields on basis of email id and create 1 workbook and then sent it to that email. Also that saving workbook is right now saving in D drive can we save it to documents.  like this command saves automatically in Documents  ActiveWorkbook.SaveAs FileName:=wbNam &amp; dt &amp; &quot;.xlsm&quot;"}, {"owner": {"reputation": 1518, "user_id": 1196076, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/tXSlo.jpg?s=128&g=1", "display_name": "Rick Burns", "link": "https://stackoverflow.com/users/1196076/rick-burns"}, "reply_to_user": {"reputation": 241, "user_id": 5429649, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh4.googleusercontent.com/-uQe9HBX8x4I/AAAAAAAAAAI/AAAAAAAAAEM/CoSLMAHVowE/photo.jpg?sz=128", "display_name": "Atul Vij", "link": "https://stackoverflow.com/users/5429649/atul-vij"}, "edited": false, "score": 0, "creation_date": 1444852159, "post_id": 33133973, "comment_id": 54080159, "body": "@AtulVij then do the MItem.Send command on one of your outer loops"}, {"owner": {"reputation": 241, "user_id": 5429649, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh4.googleusercontent.com/-uQe9HBX8x4I/AAAAAAAAAAI/AAAAAAAAAEM/CoSLMAHVowE/photo.jpg?sz=128", "display_name": "Atul Vij", "link": "https://stackoverflow.com/users/5429649/atul-vij"}, "edited": false, "score": 0, "creation_date": 1444852267, "post_id": 33133973, "comment_id": 54080228, "body": "Can you specify the command i am not too perfect in it but i can search online."}, {"owner": {"reputation": 1518, "user_id": 1196076, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/tXSlo.jpg?s=128&g=1", "display_name": "Rick Burns", "link": "https://stackoverflow.com/users/1196076/rick-burns"}, "reply_to_user": {"reputation": 241, "user_id": 5429649, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh4.googleusercontent.com/-uQe9HBX8x4I/AAAAAAAAAAI/AAAAAAAAAEM/CoSLMAHVowE/photo.jpg?sz=128", "display_name": "Atul Vij", "link": "https://stackoverflow.com/users/5429649/atul-vij"}, "edited": false, "score": 0, "creation_date": 1444852604, "post_id": 33133973, "comment_id": 54080414, "body": "@AtulVij The send command is already listed, MItem.Send.  Are you referring to something else?"}, {"owner": {"reputation": 241, "user_id": 5429649, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh4.googleusercontent.com/-uQe9HBX8x4I/AAAAAAAAAAI/AAAAAAAAAEM/CoSLMAHVowE/photo.jpg?sz=128", "display_name": "Atul Vij", "link": "https://stackoverflow.com/users/5429649/atul-vij"}, "edited": false, "score": 0, "creation_date": 1444852821, "post_id": 33133973, "comment_id": 54080554, "body": "@UncleRicoI understood.. I Will try and reply again if it works for me.... Thanks for great support and help my friend..."}, {"owner": {"reputation": 1518, "user_id": 1196076, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/tXSlo.jpg?s=128&g=1", "display_name": "Rick Burns", "link": "https://stackoverflow.com/users/1196076/rick-burns"}, "reply_to_user": {"reputation": 241, "user_id": 5429649, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh4.googleusercontent.com/-uQe9HBX8x4I/AAAAAAAAAAI/AAAAAAAAAEM/CoSLMAHVowE/photo.jpg?sz=128", "display_name": "Atul Vij", "link": "https://stackoverflow.com/users/5429649/atul-vij"}, "edited": false, "score": 0, "creation_date": 1444852950, "post_id": 33133973, "comment_id": 54080635, "body": "@AtulVij, do post a new question if you need any further help with the e-mailing, you&#39;ll get more outlook guys looking at it that way."}, {"owner": {"reputation": 241, "user_id": 5429649, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh4.googleusercontent.com/-uQe9HBX8x4I/AAAAAAAAAAI/AAAAAAAAAEM/CoSLMAHVowE/photo.jpg?sz=128", "display_name": "Atul Vij", "link": "https://stackoverflow.com/users/5429649/atul-vij"}, "edited": false, "score": 0, "creation_date": 1444853011, "post_id": 33133973, "comment_id": 54080671, "body": "surely and i will try to post new updated code also."}], "tags": [], "owner": {"reputation": 1518, "user_id": 1196076, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/tXSlo.jpg?s=128&g=1", "display_name": "Rick Burns", "link": "https://stackoverflow.com/users/1196076/rick-burns"}, "is_accepted": true, "score": 1, "last_activity_date": 1444851781, "last_edit_date": 1444851781, "creation_date": 1444850922, "answer_id": 33133973, "question_id": 33132794, "link": "https://stackoverflow.com/questions/33132794/sending-email-through-vba/33133973#33133973", "title": "Sending Email through VBA", "body": "<p>The problem is on this line (don't know what it could be with out a copy of the workbook):</p>\n\n<pre><code>If Left(A, 1) &lt;&gt; \"*\" And A.Value &lt;&gt; 0 And A.Offset(0, 1).Value = 0 Then\n</code></pre>\n\n<p>Changing that line to:</p>\n\n<pre><code>If True Then\n</code></pre>\n\n<p>And then changing:</p>\n\n<pre><code>f = A.Value\n</code></pre>\n\n<p>To:</p>\n\n<pre><code>f = \"newbook\"\n</code></pre>\n\n<p>Yields the following email being popped up for sending:</p>\n\n<p><a href=\"https://i.stack.imgur.com/LMkbr.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/LMkbr.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>So there is no problem with your actual e-mail logic, just your workbook parsing logic.</p>\n\n<p><strong>Per updated comments</strong></p>\n\n<p>To automatically send the message change:</p>\n\n<pre><code>Set myAttachments = MItem.Attachments\nWith MItem\n.To = EmailAddr\n.Subject = Subj\n.Display\nEnd With\n'paste the attachment of new workbooks save on user desktop\nmyAttachments.Add \"D:\\\" &amp; f &amp; \".xlsx\"\n</code></pre>\n\n<p>to:</p>\n\n<pre><code>Set myAttachments = MItem.Attachments\nmyAttachments.Add \"D:\\\" &amp; f &amp; \".xlsx\"\nWith MItem\n.TO = EmailAddr\n.Subject = Subj\n.Display\n.Send\nEnd With\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 241, "user_id": 5429649, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh4.googleusercontent.com/-uQe9HBX8x4I/AAAAAAAAAAI/AAAAAAAAAEM/CoSLMAHVowE/photo.jpg?sz=128", "display_name": "Atul Vij", "link": "https://stackoverflow.com/users/5429649/atul-vij"}, "is_accepted": false, "score": 0, "last_activity_date": 1444852728, "creation_date": 1444852728, "answer_id": 33134508, "question_id": 33132794, "link": "https://stackoverflow.com/questions/33132794/sending-email-through-vba/33134508#33134508", "title": "Sending Email through VBA", "body": "<p>I think something like this work if you say MIem.send option</p>\n\n<pre><code>If GetOutlook = True Then\n    Set mItem = mOutlookApp.CreateItem(olMailItem)\n    mItem.Recipients.Add strRecip\n    mItem.Subject = strSubject\n    mItem.Body = strMsg\n\n\n' This code allows for 1 attachment, but with slight ' modification, you could provide for multiple files.\n\n    If Len(strAttachment) &gt; 0 Then\n        mItem.Attachments.Add strAttachment\n    End If\n\n    mItem.Save\n    mItem.Send\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 241, "user_id": 5429649, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh4.googleusercontent.com/-uQe9HBX8x4I/AAAAAAAAAAI/AAAAAAAAAEM/CoSLMAHVowE/photo.jpg?sz=128", "display_name": "Atul Vij", "link": "https://stackoverflow.com/users/5429649/atul-vij"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 233, "favorite_count": 1, "accepted_answer_id": 33133973, "answer_count": 2, "score": 1, "last_activity_date": 1486413973, "creation_date": 1444846837, "last_edit_date": 1486413973, "question_id": 33132794, "link": "https://stackoverflow.com/questions/33132794/sending-email-through-vba", "title": "Sending Email through VBA", "body": "<p>Trying to send email through outlook but it is not saving the excel file and so it's not able to do attachment. Also my code is not able to pop up outlook window. It was working before but due to network drive it no longer works.</p>\n\n<pre><code>Sub Backup_required()\n  'coded by Atul , Vij\n  Dim OutlookApp, MItem As Object\n  Dim cell As Range\n  Dim Subj As String\n  Dim EmailAddr As String\n  Dim Recipient As String\n  Dim Msg As String\n  Dim ws As Worksheet, ws2 As Worksheet, ws3 As Worksheet\n  Dim wb As Workbook, wb2 As Workbook\n  Dim main_book As String\n  Dim newWorkbook As String\n  Application.DisplayAlerts = False\n  'create outblook object\n  Set OutlookApp = CreateObject(\"Outlook.Application\")\n  Application.ScreenUpdating = False\n  'defines the user name\n  user = Environ(\"username\")\n  main_book = ActiveWorkbook.Name\n  Set wb = Workbooks(main_book)\n  'email subject\n  Subj = \"Blackline Reconciliation - Backup Required!\"\n\n  'coded by Atul , Vij\n\n  Call pathDefinition\n  'operation for all sheets in BS_Download template with comments\n  For Each g In Workbooks(main_book).Worksheets\n    Set ws = wb.Worksheets(g.Name)\n    If g.Name &lt;&gt; \"Sap Data\" And g.Name &lt;&gt; \"Automated BL Import\" Then\n      lastRow = ws.Range(\"B\" &amp; Rows.Count).End(xlUp).Row\n      'select every cells in all sheets in BS_Download template with comments\n      For Each a In ws.Range(\"W2:W\" &amp; lastRow)\n        If Left(a, 1) &lt;&gt; \"*\" And a.Value &lt;&gt; 0 And a.Offset(0, 1).Value = 0 Then\n          B = a.Row\n          f = a.Value\n          'add new book where the cell with met conditions are copied\n          Workbooks.Add\n          newWorkbook = ActiveWorkbook.Name\n          Workbooks(newWorkbook).Worksheets(1).Range(\"A1:AA1\").Value = ws.Range(\"A1:AA1\").Value\n          Set wb2 = Workbooks(newWorkbook)\n          Set ws3 = wb2.Worksheets(1)\n         'select all cells in all sheets in BS_Download template with comments\n          For Each d In Workbooks(main_book).Worksheets\n            If d.Name &lt;&gt; \"Sap Data\" And d.Name &lt;&gt; \"Automated BL Import\" Then\n              Set ws2 = wb.Worksheets(d.Name)\n              'compare if condition is met in all cells in all sheets in BS_Download template with comments\n              lastRow2 = ws2.Range(\"B\" &amp; Rows.Count).End(xlUp).Row\n              For Each e In ws2.Range(\"W2:W\" &amp; lastRow2)\n                C = e.Row\n                If e.Value = f And Left(e, 1) &lt;&gt; \"*\" And e.Offset(0, 1) = 0 Then\n                  lastRow3 = ws3.Range(\"B\" &amp; Rows.Count).End(xlUp).Row + 1\n                  ws3.Range(\"A\" &amp; lastRow3, \"AA\" &amp; lastRow3).Value = ws2.Range(\"A\" &amp; C, \"AA\" &amp; C).Value\n                  e.Value = \"*\" &amp; e.Value\n                  If Left(a, 1) &lt;&gt; \"*\" Then\n                    a.Value = \"*\" &amp; a.Value\n                  End If\n                End If\n              Next e\n            End If\n\n          'coded by Atul , Vij\n\n          Next d\n          ws3.Range(\"A1:AA1\").Interior.Color = RGB(51, 102, 255)\n          ws3.Columns(\"A:AA\").EntireColumn.AutoFit\n          'finally save the new opened workbook with name of compared a cell\n          wb2.SaveAs FileName:=\"D:\\\" &amp; f &amp; \".xlsx\", FileFormat:=xlOpenXMLWorkbook, CreateBackup:=False\n          wb2.Close\n          EmailAddr = f\n          'open new email\n          Set MItem = OutlookApp.CreateItem(olMailItem)\n          Set myAttachments = MItem.Attachments\n          With MItem\n            .To = EmailAddr\n            .Subject = Subj\n            .Display\n          End With\n          'paste the attachment of new workbooks save on user desktop\n          myAttachments.Add \"D:\\\" &amp; f &amp; \".xlsx\"\n        End If\n      Next a\n    End If\n  Next g\n  'erase the first left \"*\" in all the cell in T column\n  For Each a In Workbooks(main_book).Worksheets\n    Set ws = wb.Worksheets(a.Name)\n    If a.Name &lt;&gt; \"Sap Data\" And a.Name &lt;&gt; \"Automated BL Import\" Then\n      lastRow = ws.Range(\"B\" &amp; Rows.Count).End(xlUp).Row\n      For Each B In ws.Range(\"W2:W\" &amp; lastRow)\n        If Left(B, 1) = \"*\" Then\n          B.Value = Right(B, (Len(B.Value) - 1))\n        End If\n      Next B\n    End If\n  Next a\n  Application.DisplayAlerts = True\nEnd Sub\n</code></pre>\n"}, {"tags": ["string", "vba", "excel"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1444851239, "post_id": 33132737, "comment_id": 54079636, "body": "Could you use a replace function: <code>Replace(Selection, Chr(34), Chr(34) &amp; Chr(34))</code>?"}], "answers": [{"comments": [{"owner": {"reputation": 3022, "user_id": 5398127, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/72c4f99e221026a4aeb2ea8278fae858?s=128&d=identicon&r=PG&f=1", "display_name": "Stupid_Intern", "link": "https://stackoverflow.com/users/5398127/stupid-intern"}, "edited": false, "score": 0, "creation_date": 1444892368, "post_id": 33132804, "comment_id": 54093907, "body": "I used the second method it&#39;s easy to implement."}], "tags": [], "owner": {"reputation": 31066, "user_id": 2704659, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/wObcB.jpg?s=128&g=1", "display_name": "rory.ap", "link": "https://stackoverflow.com/users/2704659/rory-ap"}, "is_accepted": true, "score": 1, "last_activity_date": 1444846852, "creation_date": 1444846852, "answer_id": 33132804, "question_id": 33132737, "link": "https://stackoverflow.com/questions/33132737/how-to-include-quotes-in-a-string-vba/33132804#33132804", "title": "How to include quotes in a string vba", "body": "<p>You have two choices: you can either use two instances for each one, e.g.</p>\n\n<pre><code>\"Test1\"\":\"\"Monday\"\",\"\"Test_Abcdef\"\":\"\":\"\n</code></pre>\n\n<p>or you can use <code>Chr(34)</code>:</p>\n\n<pre><code>\"Test1\" &amp; Chr(34) &amp; \":\" &amp; Chr(34) &amp; \"Monday\" &amp; Chr(34) &amp; \",\" &amp; Chr(34) &amp; \"Test_Abcdef\" &amp; Chr(34) &amp; \":\" &amp; Chr(34) &amp; \":\"\n</code></pre>\n"}], "owner": {"reputation": 3022, "user_id": 5398127, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/72c4f99e221026a4aeb2ea8278fae858?s=128&d=identicon&r=PG&f=1", "display_name": "Stupid_Intern", "link": "https://stackoverflow.com/users/5398127/stupid-intern"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 824, "favorite_count": 0, "accepted_answer_id": 33132804, "answer_count": 1, "score": 2, "last_activity_date": 1444847057, "creation_date": 1444846686, "last_edit_date": 1531164843, "question_id": 33132737, "link": "https://stackoverflow.com/questions/33132737/how-to-include-quotes-in-a-string-vba", "title": "How to include quotes in a string vba", "body": "<p>I want to store the following text </p>\n\n<pre><code>\"Test1\":\"Monday\",\"Test_Abcdef\":\":\"\n</code></pre>\n\n<p>All including quotes in a string</p>\n\n<p>I understand that to include a quote in a string I have to include <code>\"\"</code> before a <code>\"</code> but here it's not a very good solution as I have too many of them in a text.</p>\n\n<p>Any Idea how I can do it all at once?</p>\n"}, {"tags": ["excel", "loops", "google-finance", "vba"], "comments": [{"owner": {"reputation": 3650, "user_id": 5090027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/904db949ae64fe1a63ea8b4c677e6d57?s=128&d=identicon&r=PG&f=1", "display_name": "Grade &#39;Eh&#39; Bacon", "link": "https://stackoverflow.com/users/5090027/grade-eh-bacon"}, "edited": false, "score": 0, "creation_date": 1444844752, "post_id": 33132135, "comment_id": 54075811, "body": "Limit the code to the bare minimum required to replicate your problem. The solution is likely quite simple but it&#39;s hard to dig through at the moment."}, {"owner": {"reputation": 3650, "user_id": 5090027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/904db949ae64fe1a63ea8b4c677e6d57?s=128&d=identicon&r=PG&f=1", "display_name": "Grade &#39;Eh&#39; Bacon", "link": "https://stackoverflow.com/users/5090027/grade-eh-bacon"}, "edited": false, "score": 0, "creation_date": 1444845435, "post_id": 33132135, "comment_id": 54076222, "body": "Sorry I don&#39;t see the problem - this looks like it should loop through all of 1 to kal. What is the error that is currently happening? What value did you expect and what did you get?"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 1, "creation_date": 1444845441, "post_id": 33132135, "comment_id": 54076224, "body": "if you qualify the sheet in this line <code>ticker = Cells(io, 1).Value</code> it may help. For example, <code>ticker = Sheets(&quot;Sheet1&quot;).Cells.(io,1).Value</code> <i>where Sheet1 is the needed sheet name</i> If the active sheet is any other than where you desire to get the ticker from, they way you have it written will not work."}, {"owner": {"reputation": 123, "user_id": 3531520, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e827df0547a5145a3bba14295b682e36?s=128&d=identicon&r=PG&f=1", "display_name": "Vaibhav", "link": "https://stackoverflow.com/users/3531520/vaibhav"}, "edited": false, "score": 0, "creation_date": 1444846108, "post_id": 33132135, "comment_id": 54076645, "body": "Excel vba throwing syntax error around the starting bracket of --&gt;   <code>ticker = Sheets(&quot;Symbol&quot;).Cells.(io,1).Value</code>  Also, same syntax error when modified like: <code>Set SymbolSheet = Sheets(&quot;Symbol&quot;) ticker = SymbolSheet.Cells.(io,1).Value </code> Am i doing something wrong here ?"}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 2, "creation_date": 1444846456, "post_id": 33132135, "comment_id": 54076852, "body": "Take out <code>.</code> after <code>cells</code>?"}, {"owner": {"reputation": 123, "user_id": 3531520, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e827df0547a5145a3bba14295b682e36?s=128&d=identicon&r=PG&f=1", "display_name": "Vaibhav", "link": "https://stackoverflow.com/users/3531520/vaibhav"}, "edited": false, "score": 0, "creation_date": 1444847026, "post_id": 33132135, "comment_id": 54077202, "body": "Thanks, i did that. VBA creates a folder and closes off. Does nothing else at all ! Not sure if it is executing the loop. Going to use debug and message box (if that is possible) to get value of the symbol read. If you have any suggestions pls do share."}, {"owner": {"reputation": 123, "user_id": 3531520, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e827df0547a5145a3bba14295b682e36?s=128&d=identicon&r=PG&f=1", "display_name": "Vaibhav", "link": "https://stackoverflow.com/users/3531520/vaibhav"}, "edited": false, "score": 0, "creation_date": 1444848257, "post_id": 33132135, "comment_id": 54077911, "body": "Thanks, the errors have solved and the looping is working fine. Some other error is cropped up into data. Which now needs to be looked into.  Thank you both for helping and giving your time."}], "answers": [{"tags": [], "owner": {"reputation": 123, "user_id": 3531520, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e827df0547a5145a3bba14295b682e36?s=128&d=identicon&r=PG&f=1", "display_name": "Vaibhav", "link": "https://stackoverflow.com/users/3531520/vaibhav"}, "is_accepted": true, "score": 0, "last_activity_date": 1444848420, "creation_date": 1444848420, "answer_id": 33133252, "question_id": 33132135, "link": "https://stackoverflow.com/questions/33132135/excel-vba-loop-setting-a-variables-value-by-looping-on-another-sheets-cells/33133252#33133252", "title": "Excel VBA LOOP - Setting a variable&#39;s value by looping on another sheet&#39;s cells", "body": "<p>The answer has been provided by Scott. Given below:</p>\n\n<p>if you qualify the sheet in this line ticker = Cells(io, 1).Value it may help. For example, ticker = Sheets(\"Sheet1\").Cells(io,1).Value where Sheet1 is the needed sheet name If the active sheet is any other than where you desire to get the ticker from, they way you have it written will not work. \u2013 Scott Holtzman</p>\n"}], "owner": {"reputation": 123, "user_id": 3531520, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e827df0547a5145a3bba14295b682e36?s=128&d=identicon&r=PG&f=1", "display_name": "Vaibhav", "link": "https://stackoverflow.com/users/3531520/vaibhav"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1280, "favorite_count": 0, "accepted_answer_id": 33133252, "answer_count": 1, "score": 0, "last_activity_date": 1444848420, "creation_date": 1444844644, "last_edit_date": 1531164843, "question_id": 33132135, "link": "https://stackoverflow.com/questions/33132135/excel-vba-loop-setting-a-variables-value-by-looping-on-another-sheets-cells", "title": "Excel VBA LOOP - Setting a variable&#39;s value by looping on another sheet&#39;s cells", "body": "<p>Shortened the post. Complete code in the attached excel file.</p>\n\n<p>Need help with correcting the looping code so that Variable gets value from a cell of another sheet repeats after certain process.</p>\n\n<p>What's working correct already:: For a Single run::</p>\n\n<ol>\n<li>Currently, works only on 1 input (saved in ParameterSheet of workbook)</li>\n<li>Downloads data from gfinance</li>\n<li>Modifies data in consumable format (also adjusting time values)</li>\n<li>Exporting as csv</li>\n<li>Importing into another application</li>\n</ol>\n\n<p>(Here's the <a href=\"https://www.dropbox.com/s/iugp3rvwgkianyh/Google%20BackFill%20EQUITIES.xlsm?dl=0\" rel=\"nofollow\">excel file</a> for reference)</p>\n\n<p>Modifying the macro to work in a loop on a list of symbols in SymbolSheet. This list and count of list-items can keep changing.</p>\n\n<p>Below is the code i have tried unsuccessfully :</p>\n\n<pre><code>'Starting Symbol loop --- Will DO STUFF till there are symbols in Symbol sheet\n\nkal = SymbolSheet.Range(\"A1048576\").End(xlUp).Row\n\nFor io = 1 To kal\n\nticker = Cells(io, 1).Value   ' fill ticker with cell value one by one\n\nSymbolll = ticker &amp; \"-EQ\"\n\n\n'DO LOTS OF OTHER WORK\n\n'Below code is coming from top where Ticker value is set\n\n Next io`\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1444844949, "post_id": 33132020, "comment_id": 54075928, "body": "This runs when the workbook is opened.  If you put any data in the &quot;Customers&quot; sheet, range A2:I500, it&#39;s going to be deleted every time you open the book (as will &quot;Prospects&quot; sheet&#39;s info).  Is your manually inputted data in that range?"}, {"owner": {"reputation": 1, "user_id": 5445679, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153590902697254/picture?type=large", "display_name": "Luis Gonzalez Frau", "link": "https://stackoverflow.com/users/5445679/luis-gonzalez-frau"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1444845256, "post_id": 33132020, "comment_id": 54076107, "body": "Thank you Bruce, my manually entered data is on A2 for the fist time the document is edited, and it goes on as we continue entering data. Eg: A3, A4, A5, etc.  So I would like to have the row below the last manually entered data cleared, and have the automated data from Sheet3 pasted below the last row manueally entered row; in this case A5."}, {"owner": {"reputation": 2843, "user_id": 2958401, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/a5dd8c841e767e09bd8c08764dc2319e?s=128&d=identicon&r=PG&f=1", "display_name": "gtwebb", "link": "https://stackoverflow.com/users/2958401/gtwebb"}, "edited": false, "score": 0, "creation_date": 1444846092, "post_id": 33132020, "comment_id": 54076635, "body": "How can you tell the difference between manually entered data and data you want to erase?  Once data is in the cell vba has no way to determine who put it there (or how) so you need a flag to prevent data from being deleted."}, {"owner": {"reputation": 1, "user_id": 5445679, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153590902697254/picture?type=large", "display_name": "Luis Gonzalez Frau", "link": "https://stackoverflow.com/users/5445679/luis-gonzalez-frau"}, "edited": false, "score": 0, "creation_date": 1444847115, "post_id": 33132020, "comment_id": 54077255, "body": "Thank you. How could i flag it so it prevents deliting the data?   Could a specific value in the row below the last manually entered data. Eg &quot;zz&quot; , instruct to delete below this row?  If so, I&#39;d like the automated data to be transfer below &quot;zz&quot; as well"}], "owner": {"reputation": 1, "user_id": 5445679, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153590902697254/picture?type=large", "display_name": "Luis Gonzalez Frau", "link": "https://stackoverflow.com/users/5445679/luis-gonzalez-frau"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 68, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1444844200, "creation_date": 1444844200, "question_id": 33132020, "link": "https://stackoverflow.com/questions/33132020/how-to-transfer-data-from-on-sheet-to-another-below-a-specified-cell-with-a-valu", "title": "How to transfer data from on sheet to another below a specified cell with a value?", "body": "<p>I am transferring data automatically from from Sheet3 to sheet 1, and sheet 2 based on conditional formatting.</p>\n\n<p>I would also like to insert data on sheet1, and sheet 2 manually.</p>\n\n<p>Problem: The manually entered data is being deleted once clear contents</p>\n\n<p>Questions: </p>\n\n<p>1) How can I delete the data on sheet1, and sheet2 below the manually entered data?</p>\n\n<p>2) How can I transfer the data from sheet3 below the last manually entered row on sheets1, or 2.</p>\n\n<p>Here is the code that I have so far:</p>\n\n<pre><code>Private Sub Workbook_Open()\n\n    Dim i, LastRow\n    LastRow = Sheets(\"QUOTES\").Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n    Sheets(\"CUSTOMERS\").Range(\"a2:i500\").ClearContents\n    For i = 2 To LastRow\n    If Sheets(\"QUOTES\").Cells(i, \"d\").Value = \"C\" Then\n    Sheets(\"QUOTES\").Cells(i, \"d\").EntireRow.Copy Destination:=Sheets(\"CUSTOMERS\").Range(\"a\" &amp; Rows.Count).End(xlUp).Offset(1)\n    End If\n    Next i\n    Sheets(\"PROSPECTS\").Range(\"a2:i500\").ClearContents\n    For i = 2 To LastRow\n    If Sheets(\"QUOTES\").Cells(i, \"d\").Value = \"P\" Then\n    Sheets(\"QUOTES\").Cells(i, \"d\").EntireRow.Copy Destination:=Sheets(\"PROSPECTS\").Range(\"a\" &amp; Rows.Count).End(xlUp).Offset(1)\n    End If\n    Next i\n    For i = 2 To LastRow\n    If Sheets(\"PROSPECTS\").Cells(i, \"n\").Value = \"1\" Then\n    Sheets(\"PROSPECTS\").Cells(i, \"n\").EntireRow.Copy Destination:=Sheets(\"CUSTOMERS\").Range(\"a\" &amp; Rows.Count).End(xlUp).Offset(1)\n    End If\n    Next i\n    End Sub\n</code></pre>\n\n<p>Thank you</p>\n"}, {"tags": ["excel", "excel-2013", "vba"], "comments": [{"owner": {"reputation": 956, "user_id": 3469496, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/4jWVm.jpg?s=128&g=1", "display_name": "CactusCake", "link": "https://stackoverflow.com/users/3469496/cactuscake"}, "edited": false, "score": 1, "creation_date": 1444844605, "post_id": 33132012, "comment_id": 54075737, "body": "What have you tried so far? Do you know how to call macros on the workbook open/close events already?"}, {"owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "edited": false, "score": 0, "creation_date": 1445099520, "post_id": 33132012, "comment_id": 54183625, "body": "What does your <code>worksheet_selection</code> code look like, and what does your <code>calendar</code> code look like?"}], "answers": [{"comments": [{"owner": {"reputation": 3650, "user_id": 5090027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/904db949ae64fe1a63ea8b4c677e6d57?s=128&d=identicon&r=PG&f=1", "display_name": "Grade &#39;Eh&#39; Bacon", "link": "https://stackoverflow.com/users/5090027/grade-eh-bacon"}, "edited": false, "score": 0, "creation_date": 1444847334, "post_id": 33132217, "comment_id": 54077362, "body": "Note that it isn&#39;t just the macro that&#39;s an issue - if the user then selects a particular cell before closing the file, the same problem will occur on opening. Solution would need to utilize the OnClose / OnSave property to ensure this (or Jeeped&#39;s solution)."}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "reply_to_user": {"reputation": 3650, "user_id": 5090027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/904db949ae64fe1a63ea8b4c677e6d57?s=128&d=identicon&r=PG&f=1", "display_name": "Grade &#39;Eh&#39; Bacon", "link": "https://stackoverflow.com/users/5090027/grade-eh-bacon"}, "edited": false, "score": 0, "creation_date": 1444847569, "post_id": 33132217, "comment_id": 54077501, "body": "@Grade&#39;Eh&#39;Bacon Uh if the user selects any other cell than the one that triggers the macro during use, then OP wouldn&#39;t have this problem upon opening of book next time. It&#39;s clear that user opens book, click trigger cell and nothing else? Edit: you mean Gary?"}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "reply_to_user": {"reputation": 3650, "user_id": 5090027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/904db949ae64fe1a63ea8b4c677e6d57?s=128&d=identicon&r=PG&f=1", "display_name": "Grade &#39;Eh&#39; Bacon", "link": "https://stackoverflow.com/users/5090027/grade-eh-bacon"}, "edited": false, "score": 1, "creation_date": 1444847961, "post_id": 33132217, "comment_id": 54077742, "body": "Not sure why OP doesn&#39;t build a button XD"}, {"owner": {"reputation": 3650, "user_id": 5090027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/904db949ae64fe1a63ea8b4c677e6d57?s=128&d=identicon&r=PG&f=1", "display_name": "Grade &#39;Eh&#39; Bacon", "link": "https://stackoverflow.com/users/5090027/grade-eh-bacon"}, "edited": false, "score": 1, "creation_date": 1444848167, "post_id": 33132217, "comment_id": 54077856, "body": "Never underestimate the power of a fool when making something foolproof... And yes - mean&#39;t @Gary&#39;sStudent; my apologies."}], "tags": [], "owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "is_accepted": false, "score": 1, "last_activity_date": 1444844878, "creation_date": 1444844878, "answer_id": 33132217, "question_id": 33132012, "link": "https://stackoverflow.com/questions/33132012/set-active-cell-on-close/33132217#33132217", "title": "Set Active Cell on Close", "body": "<p>At the end of your macro, you can simply add one line to the effect of:</p>\n\n<pre><code>activesheet.range(\"ZZ999\").select\n</code></pre>\n\n<p>Pick some cell far out. No need to create a separate sub.</p>\n"}, {"tags": [], "owner": {"reputation": 23, "user_id": 3740736, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/4011bd9cbe2475e66c16c0d975710aad?s=128&d=identicon&r=PG&f=1", "display_name": "user3740736", "link": "https://stackoverflow.com/users/3740736/user3740736"}, "is_accepted": false, "score": 0, "last_activity_date": 1445052773, "last_edit_date": 1445052773, "creation_date": 1444852655, "answer_id": 33134488, "question_id": 33132012, "link": "https://stackoverflow.com/questions/33132012/set-active-cell-on-close/33134488#33134488", "title": "Set Active Cell on Close", "body": "<p>So I created a macro:</p>\n\n<pre><code>Sub NewActiveCell()\n'NewActiveCell Macro\nRange(\"AA8\").Select\nEnd Sub\n</code></pre>\n\n<p>And then</p>\n\n<pre><code>Private Sub Workbook_Open()    \nNewActiveCell    \nEnd Sub\n</code></pre>\n\n<p>I probably made it more complicated than it needs to be, but it worked</p>\n"}, {"tags": [], "owner": {"reputation": 52630, "user_id": 641067, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/n6xVq.png?s=128&g=1", "display_name": "brettdj", "link": "https://stackoverflow.com/users/641067/brettdj"}, "is_accepted": false, "score": 0, "last_activity_date": 1444882818, "creation_date": 1444882818, "answer_id": 33139834, "question_id": 33132012, "link": "https://stackoverflow.com/questions/33132012/set-active-cell-on-close/33139834#33139834", "title": "Set Active Cell on Close", "body": "<p>I prefer <code>Application.Goto</code> to <code>Select</code></p>\n\n<p>So in the <em>ThisWorkbook</em> module:</p>\n\n<pre><code>Private Sub Workbook_Open()\n   Application.Goto Sheets(\"YourSheet\").[A1]\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 3740736, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/4011bd9cbe2475e66c16c0d975710aad?s=128&d=identicon&r=PG&f=1", "display_name": "user3740736", "link": "https://stackoverflow.com/users/3740736/user3740736"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 144, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1445099606, "creation_date": 1444844164, "last_edit_date": 1531161705, "question_id": 33132012, "link": "https://stackoverflow.com/questions/33132012/set-active-cell-on-close", "title": "Set Active Cell on Close", "body": "<p>I have a macro assigned to a specific cell on single click that launches a date picker calendar.</p>\n\n<p>Unfortunately, when my workbook gets closed, that same cell remains the active cell on next open.</p>\n\n<p>This causes the next user to have to click on another cell, then click back to the macro'd cell to launch the calendar.</p>\n\n<p>What I am looking to accomplish is something that will make another cell active on close or save of the workbook. This way, when a person opens the workbook they only need to click once on the macro'd cell to launch the calendar.</p>\n"}, {"tags": ["vba", "excel"], "owner": {"reputation": 3892, "user_id": 1141764, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/52f87e1ff0fd042ee7afde87c1da5cc5?s=128&d=identicon&r=PG", "display_name": "SmashCode", "link": "https://stackoverflow.com/users/1141764/smashcode"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 47, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1444843788, "creation_date": 1444843788, "question_id": 33131916, "link": "https://stackoverflow.com/questions/33131916/add-a-url-image-to-a-cell-where-the-url-is-based-on-input-in-another-cell", "title": "Add a URL image to a cell where the URL is based on input in another cell", "body": "<p>I am moving over a worksheet from GoogleDocs that has to be in Excel now.</p>\n\n<p>It is a barcode generator sheet.</p>\n\n<p>The image cell in GoogleDocs has the formula is </p>\n\n<pre><code>=image(\"www.somebarcodesite.com/image.php?code=\" &amp; A2 &amp; \"&amp;style=197&amp;type=C128B&amp;width=300&amp;height=50&amp;xres=1&amp;font=3\", 3)\n</code></pre>\n\n<p>I've downloaded as Excel but that has not helped (I think due to text concatenation) and additional rows may be need to be added so it's not enough to embed the image once when downloading.</p>\n\n<p>I've seen VB solutions to put an image in a cell, but I'm not sure it would allow the users to add new rows to the worksheet.</p>\n\n<p>Does anyone know where I should start on finding a scalable way to show the image generated at a url, where the url is generated dynamically based on the input of other cells?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 1, "creation_date": 1444842712, "post_id": 33131493, "comment_id": 54074705, "body": "can you pass the correct named range as another argument into the function? If so, I think the code is very easy to update in that case."}, {"owner": {"reputation": 1, "user_id": 5446046, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-IaoEU0QXHCM/AAAAAAAAAAI/AAAAAAAAAAw/MGlHXYNWqns/photo.jpg?sz=128", "display_name": "Quantum", "link": "https://stackoverflow.com/users/5446046/quantum"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1444891580, "post_id": 33131493, "comment_id": 54093551, "body": "sry i dont understand what you mean with &quot;another argument&quot; !?  the problem is that even if i type the name directly into the function it also doesnt work because he some how doesnt get it that it is a range"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1444913377, "post_id": 33131493, "comment_id": 54107238, "body": "I see that you got your answer, but what I was suggesting was to pass the named range into the fix. So instead of just using the two arguments you have in &#39;Matrix` and &#39;name`, you could add a third argument for the named range. Either way, you got what you need :)"}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 5446046, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-IaoEU0QXHCM/AAAAAAAAAAI/AAAAAAAAAAw/MGlHXYNWqns/photo.jpg?sz=128", "display_name": "Quantum", "link": "https://stackoverflow.com/users/5446046/quantum"}, "is_accepted": false, "score": 0, "last_activity_date": 1444897856, "creation_date": 1444897856, "answer_id": 33143554, "question_id": 33131493, "link": "https://stackoverflow.com/questions/33131493/excel-vba-named-range-with-dynamic-created-name/33143554#33143554", "title": "Excel VBA Named Range with dynamic created name", "body": "<p>ok i did it finally !</p>\n\n<pre><code>ElseIf checkboxmech.Value = True Then\n\n    c = checkboxmech.Caption\n    mname = teil &amp; hersteller &amp; c\n    Set go = Worksheets(\"Gruppendatenbank\").Range(mname)\n    Tabelle3.Range(\"C4\").Value = getprice(go, handle)\n</code></pre>\n\n<p>it was immportant to define mname as variant datatype and define also the worksheet of my range.\nthank for the help</p>\n\n<p>statusupdate: solved !</p>\n"}], "owner": {"reputation": 1, "user_id": 5446046, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-IaoEU0QXHCM/AAAAAAAAAAI/AAAAAAAAAAw/MGlHXYNWqns/photo.jpg?sz=128", "display_name": "Quantum", "link": "https://stackoverflow.com/users/5446046/quantum"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 74, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1444897856, "creation_date": 1444842350, "last_edit_date": 1531164843, "question_id": 33131493, "link": "https://stackoverflow.com/questions/33131493/excel-vba-named-range-with-dynamic-created-name", "title": "Excel VBA Named Range with dynamic created name", "body": "<p>i have a problem with my macro. I know its alot of code (sry for that) but i think it could be helpfull. So the basic thing i want to do is, take the value of the combobox and search for it in another worksheet to get the price written in the next column.\neasy so far, but the name im searching for is not unique in the database. the one im searching for is only defined by beeing part of the correct named range (i.e. EngineMercedesDiesel) </p>\n\n<pre><code>Function getprice(Matrix As Range, name As String)\n\nDim i As Integer\nDim row As Variant\nDim col As Variant\nDim price As Variant\n'loop to finde inside the range the name im looking for\nFor i = 1 To Matrix.Rows.Count\n    If Matrix.Cells(i, 1).Value = name Then\n       row = Matrix.Cells(i, 1).Address(RowAbsolute:=True)\n       col = Matrix.Cells(i, 1).Address(ColumnAbsolute:=True)\n       price = Tabelle2.Cells(row, col + 1).Value\n       Exit For\nNext\n\ngetprice = price\n\nEnd Function\n\nPrivate Sub cbschaltung_Change()\n\nDim go As Range\nDim handle As String\n\n'from here it builds the name i.e. EngineMercedesDiesel an there is a Named range with the same titel outside VBA\n\nteil = Range(\"A4\").Value\nhersteller = Range(\"B3\").Value\nhandle = cbschaltung.Value\n\nIf checkboxel.Value = True Then\n\n    c = checkboxel.Caption\n    Set go = teil &amp; hersteller &amp; c  'storing to the variable go, here ocures the error\n    Tabelle3.Range(\"C4\").Value = getprice(go, handle)\n\nElseIf checkboxmech.Value = True Then\n\n    c = checkboxmech.Caption\n    Set go = teil &amp; hersteller &amp; c\n    Tabelle3.Range(\"C4\").Value = getprice(go, handle)\n\nEnd If\n\nEnd Sub\n</code></pre>\n\n<p>I hop you can help me and (hopefully) you have a easy answer for me</p>\n"}, {"tags": ["excel", "vlookup", "conditional-formatting", "vba"], "answers": [{"comments": [{"owner": {"reputation": 81, "user_id": 5278203, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/01e42d1208c184a58e9bbf90ce3006a9?s=128&d=identicon&r=PG&f=1", "display_name": "mdaube", "link": "https://stackoverflow.com/users/5278203/mdaube"}, "edited": false, "score": 0, "creation_date": 1444843150, "post_id": 33131389, "comment_id": 54074949, "body": "=IF(E9&gt;VLOOKUP(B9,&#39;SICE Guide&#39;!$A:$D,L$1,0),&quot;GREEN&quot;,IF(E9&lt;VLOOKUP(B9,&#39;SICE Guide&#39;!$A:$D,L$1,0),&quot;YELLOW&quot;,&quot;&quot;))  My L$1 is your I$1, there&#39;s an additional data set.  So what is the I$1 referenced for?  I just want to be able to explain the function and how it&#39;s working... btw it&#39;s working, I&#39;m going to input more data and see what I get. :)"}, {"owner": {"reputation": 81, "user_id": 5278203, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/01e42d1208c184a58e9bbf90ce3006a9?s=128&d=identicon&r=PG&f=1", "display_name": "mdaube", "link": "https://stackoverflow.com/users/5278203/mdaube"}, "edited": false, "score": 0, "creation_date": 1444844284, "post_id": 33131389, "comment_id": 54075555, "body": "Both methods worked!  You&#39;re a life saver Scott!  Now I just have to apply this to 38 other sheets and back fill three months worth of data!... See you in December when I come up for air! :P"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "reply_to_user": {"reputation": 81, "user_id": 5278203, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/01e42d1208c184a58e9bbf90ce3006a9?s=128&d=identicon&r=PG&f=1", "display_name": "mdaube", "link": "https://stackoverflow.com/users/5278203/mdaube"}, "edited": false, "score": 0, "creation_date": 1444844352, "post_id": 33131389, "comment_id": 54075596, "body": "Great! Glad it worked. Good luck with the dredging ...  The L$1 is referenced to get the vlookup column count. You can see I wrote 2 in that column (and 3, 4 in the columns next to it!)"}, {"owner": {"reputation": 81, "user_id": 5278203, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/01e42d1208c184a58e9bbf90ce3006a9?s=128&d=identicon&r=PG&f=1", "display_name": "mdaube", "link": "https://stackoverflow.com/users/5278203/mdaube"}, "edited": false, "score": 0, "creation_date": 1444844560, "post_id": 33131389, "comment_id": 54075716, "body": "Thanks again!  Couldn&#39;t have done it without ya Scott!"}], "tags": [], "owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "is_accepted": true, "score": 2, "last_activity_date": 1444842529, "last_edit_date": 1444842529, "creation_date": 1444842036, "answer_id": 33131389, "question_id": 33130885, "link": "https://stackoverflow.com/questions/33130885/multi-column-vlookup-conditional-formatting/33131389#33131389", "title": "Multi-column vlookup conditional formatting", "body": "<p>I took the approach below, but you can probably consolidate it even more.</p>\n\n<p><strong>EDIT</strong>: I was able to consolidate it even more.</p>\n\n<p>Apply this formula for conditional formatting for the Range(E3:E9) in Sheet1. Then make an additional rule, but change the formula to <code>&gt;</code> and to fill green. Then you can use the same two formats against columns F and G and you just need to change the column references in your formula and the vlookup column indicator.</p>\n\n<p>So, for column F, the formula would be <code>=F3&lt;vlookup(C3,Sheet2!$A:$D,3,0)</code></p>\n\n<p><a href=\"https://i.stack.imgur.com/9K67D.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/9K67D.png\" alt=\"enter image description here\"></a></p>\n\n<p><strong>LEAVING OLD METHOD IN HERE FOR MORE DETAILED UNDERSTANDING</strong> </p>\n\n<h2>Sheet1</h2>\n\n<p>Enter the formula seen in the formula in cell I3 and drag through the end of the range (K9)\n<a href=\"https://i.stack.imgur.com/shDEl.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/shDEl.png\" alt=\"enter image description here\"></a></p>\n\n<h2>Conditional Formatting</h2>\n\n<p>Select the range from E3:G9 and apply the displayed formulas in the Conditional Formula Rules Manager.\n<a href=\"https://i.stack.imgur.com/XJeDS.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/XJeDS.png\" alt=\"enter image description here\"></a></p>\n\n<p>For reference my sheet2 looks like this (based on your data displayed).</p>\n\n<p><a href=\"https://i.stack.imgur.com/Nz3O9.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Nz3O9.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 81, "user_id": 5278203, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/01e42d1208c184a58e9bbf90ce3006a9?s=128&d=identicon&r=PG&f=1", "display_name": "mdaube", "link": "https://stackoverflow.com/users/5278203/mdaube"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 29030, "favorite_count": 0, "accepted_answer_id": 33131389, "answer_count": 1, "score": 2, "last_activity_date": 1444842529, "creation_date": 1444840437, "last_edit_date": 1531161705, "question_id": 33130885, "link": "https://stackoverflow.com/questions/33130885/multi-column-vlookup-conditional-formatting", "title": "Multi-column vlookup conditional formatting", "body": "<p>I'm looking to create a conditional format for a worksheet based on a couple of things.</p>\n\n<p>Sheet 1:</p>\n\n<p>Reference: \"Date\" = Col1 Row1</p>\n\n<pre><code>    Date    Census          RN's On Schedule                \n            7a  3p  11p     7a  3p  11p     \n    1-Oct   8   8   9       8   8   9       \n    2-Oct   10  14  13      13  16  13      \n    3-Oct   10  12  12      12  12  10      \n    4-Oct   12  10  10      11  11  10      \n    5-Oct   10  11  11      11  12  11      \n    6-Oct   10  11  14      11  12  12      \n    7-Oct   13  12  12      12  14  12      \n</code></pre>\n\n<p>Sheet 2:</p>\n\n<p>Reference: \"Census\" = Col1 Row1</p>\n\n<pre><code>Census  RN Staffing Needs       \n        7a  3p  11p     \n1       2   2   2       \n2       2   2   2       \n3       2   2   2       \n4       3   3   2       \n5       4   4   3       \n6       4.5 5   5       \n7       5   6   6       \n8       6   7   6.5     \n9       7   8   7       \n10      8.5 9   8.5     \n11      10  11  10      \n12      12  12  11.5    \n13      12  12  12      \n14      12  12  12      \n15      13  13  13      \n16      13  13  13      \n17      14  14  14      \n18      14  14  14      \n</code></pre>\n\n<p>So here's the question.</p>\n\n<p>I've got these values in sheet 1 that I'm looking to compare to sheet 2 and use conditional formatting to highlight certain things.  I need excel to look at the census (for reference, 1-Oct census is 8 @ 7a) from sheet one and find it in sheet two.  Then I need it to compare the number in <strong>RN's On Schedule</strong> to the number in <strong>RN Staffing Needs</strong> (RN Staffing Needs, in this case 6 @ 7a; RN's On Schedule, 8).  When the RN's on Schedule value from Sheet 1 (F3 in the case of 1-Oct) is HIGHER than the RN Staffing Needs from Sheet 2 I need a conditional format to highlight that value green.  When it is LOWER I need it to highlight that value yellow.  When there is an exact match nothing needs to happen. </p>\n\n<p>I've tried vlookups and index/matches with nested IF statements and IFERROR's and the like... this one's a little out of my scope of practice.  Any help will be greatly appreciated!!</p>\n"}, {"tags": ["ms-access", "combobox", "vba", "ms-access-2007"], "comments": [{"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1444841662, "post_id": 33130867, "comment_id": 54074080, "body": "It is not clear where your combobox is. This links may help: <a href=\"http://access.mvps.org/access/forms/frm0031.htm\" rel=\"nofollow noreferrer\">access.mvps.org/access/forms/frm0031.htm</a> -- You need to requery the combobox itself."}], "answers": [{"tags": [], "owner": {"reputation": 1070, "user_id": 115065, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/14effc24a9a780e68a23094720cd5d8f?s=128&d=identicon&r=PG", "display_name": "Mark3308", "link": "https://stackoverflow.com/users/115065/mark3308"}, "is_accepted": true, "score": 1, "last_activity_date": 1444849780, "creation_date": 1444849780, "answer_id": 33133656, "question_id": 33130867, "link": "https://stackoverflow.com/questions/33130867/combobox-requery-datasheet-view-after-combobox-addition/33133656#33133656", "title": "Combobox Requery datasheet view after combobox addition", "body": "<p>The code to Requery the sub form control is as follows:</p>\n\n<pre><code>Me.SubFormName.Requery\n</code></pre>\n\n<p>The code to Requery a ComboBox would be as follows:</p>\n\n<pre><code>Me.ComboBoxName.Requery\n</code></pre>\n"}], "owner": {"reputation": 51, "user_id": 4760750, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/083894d34c613cd294267b1cb4253d1d?s=128&d=identicon&r=PG&f=1", "display_name": "EPV", "link": "https://stackoverflow.com/users/4760750/epv"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 135, "favorite_count": 0, "accepted_answer_id": 33133656, "answer_count": 1, "score": -1, "last_activity_date": 1444849780, "creation_date": 1444840378, "question_id": 33130867, "link": "https://stackoverflow.com/questions/33130867/combobox-requery-datasheet-view-after-combobox-addition", "title": "Combobox Requery datasheet view after combobox addition", "body": "<p>I have a subform datasheet view on a main form and it's client field is a combobox from a list of clients. I also have a add new client button above this datasheet view. When I person is not in the client table, the user uses the popup button to add a new client. When the user goes back into the datasheet, it does not requery. </p>\n\n<p>I have tried:</p>\n\n<pre><code>On enter: Code Form.requery\nOn click. clientid datasheet, clientid.requery\non after update: clientid.requery\n</code></pre>\n\n<p>but none of it works. What is the best way to do a query after the combobox has been edited?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1444840289, "post_id": 33130811, "comment_id": 54073310, "body": "This has been answered <a href=\"http://stackoverflow.com/questions/853270/hiding-an-excel-sheet\">here</a>.  You need to use: xlSheetVeryHidden, xlSheetHidden or xlSheetVisible after the <code>=</code> instead of true or false."}, {"owner": {"reputation": 12614, "user_id": 3566998, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S7lz6.png?s=128&g=1", "display_name": "Excel Hero", "link": "https://stackoverflow.com/users/3566998/excel-hero"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1444842047, "post_id": 33130811, "comment_id": 54074325, "body": "@ScottCraner That question&#39;s answers do not address the array component in the title of the question. In addition your comment, while not wrong, is misleading. <code>xlSheetHidden = 0</code>, which is exactly equivalent to False ,   <code>xlSheetVisible = -1</code> which is exactly equivalent to True. So those two visible states can and often are achieved by using the simple Boolean values. <code>xlSheetVeryHidden = 2</code> which can be set either with the constant or the literal or an expression. In any case, nothing from that other question addresses this question."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 12614, "user_id": 3566998, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S7lz6.png?s=128&g=1", "display_name": "Excel Hero", "link": "https://stackoverflow.com/users/3566998/excel-hero"}, "edited": false, "score": 0, "creation_date": 1444842207, "post_id": 33130811, "comment_id": 54074418, "body": "@ExcelHero As always, I bow to your knowledge."}, {"owner": {"reputation": 12614, "user_id": 3566998, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S7lz6.png?s=128&g=1", "display_name": "Excel Hero", "link": "https://stackoverflow.com/users/3566998/excel-hero"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1444842308, "post_id": 33130811, "comment_id": 54074482, "body": "@ScottCraner :) Well no need for that, but the more knowledge we share the better everyone becomes!"}], "answers": [{"tags": [], "owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "is_accepted": false, "score": 1, "last_activity_date": 1444840706, "creation_date": 1444840706, "answer_id": 33130970, "question_id": 33130811, "link": "https://stackoverflow.com/questions/33130811/excel-vba-hide-sheets-with-names-in-array/33130970#33130970", "title": "Excel VBA hide sheets with names in array", "body": "<p>Take out the <code>else</code>. It hides it but on the next loop, it unhides again.</p>\n\n<pre><code>Dim ws As Worksheet\ninvisible = Array(\"ABC\", \"DEF\", \"GHI\")\n\nFor Each ws In ActiveWorkbook.WorkSheets\n\n    For Each nome In invisible\n        If ws.name = nome Then\n            ws.Visible = False\n        End If\n    Next nome\n\nNext ws\n</code></pre>\n"}, {"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user882670"}, "edited": false, "score": 0, "creation_date": 1444841321, "post_id": 33131162, "comment_id": 54073878, "body": "LOL! this is really simple!"}, {"owner": {"user_type": "does_not_exist", "display_name": "user882670"}, "edited": false, "score": 0, "creation_date": 1444841428, "post_id": 33131162, "comment_id": 54073944, "body": "Any other simple way of unhiding anything that isn&#39;t in that array?"}, {"owner": {"reputation": 12614, "user_id": 3566998, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S7lz6.png?s=128&g=1", "display_name": "Excel Hero", "link": "https://stackoverflow.com/users/3566998/excel-hero"}, "edited": false, "score": 0, "creation_date": 1444841517, "post_id": 33131162, "comment_id": 54074001, "body": "Nope. Unhiding requires doing one sheet at a time."}, {"owner": {"user_type": "does_not_exist", "display_name": "user882670"}, "edited": false, "score": 0, "creation_date": 1444841564, "post_id": 33131162, "comment_id": 54074029, "body": "Ok, I&#39;ve unhidden all the sheets one by one and then hidden the ones in the array. Thanks a lot!"}, {"owner": {"reputation": 12614, "user_id": 3566998, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S7lz6.png?s=128&g=1", "display_name": "Excel Hero", "link": "https://stackoverflow.com/users/3566998/excel-hero"}, "edited": false, "score": 0, "creation_date": 1444995554, "post_id": 33131162, "comment_id": 54146720, "body": "Thanks @NunoNogueira."}], "tags": [], "owner": {"reputation": 12614, "user_id": 3566998, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S7lz6.png?s=128&g=1", "display_name": "Excel Hero", "link": "https://stackoverflow.com/users/3566998/excel-hero"}, "is_accepted": true, "score": 2, "last_activity_date": 1444842394, "last_edit_date": 1444842394, "creation_date": 1444841279, "answer_id": 33131162, "question_id": 33130811, "link": "https://stackoverflow.com/questions/33130811/excel-vba-hide-sheets-with-names-in-array/33131162#33131162", "title": "Excel VBA hide sheets with names in array", "body": "<p>To hide the sheets in your <code>invisible</code> array, it is as simple as this:</p>\n\n<pre><code>Sheets(invisible).Visible = False\n</code></pre>\n\n<p>Note: this works well for hiding. To make the sheets visible again, you must set each sheet visible one by one; you cannot use the array in one line like you can for hiding.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user882670"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4746, "favorite_count": 0, "accepted_answer_id": 33131162, "answer_count": 2, "score": 0, "last_activity_date": 1444842394, "creation_date": 1444840199, "question_id": 33130811, "link": "https://stackoverflow.com/questions/33130811/excel-vba-hide-sheets-with-names-in-array", "title": "Excel VBA hide sheets with names in array", "body": "<p>I want to hide all tabs whose names are <code>\"ABC\", \"DEF\", \"GHI\"</code></p>\n\n<p>This is my code:</p>\n\n<pre><code>Sub hideSheets()\nDim ws As Worksheet\ninvisible = Array(\"ABC\", \"DEF\", \"GHI\")\n\nFor Each ws In ActiveWorkbook.Worksheets\n    For Each nome In invisible\n        If ws.Name = nome Then\n            ws.Visible = False\n        Else\n            ws.Visible = True\n        End If\n    Next nome\n\nNext ws\n\nEnd Sub\n</code></pre>\n\n<p>Which isn't hiding any sheet.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1444844929, "post_id": 33130722, "comment_id": 54075911, "body": "is row 21 always going to be a header row? or does it get pasted in with the FTP Results command? Maybe a better question is does <code>Fail_Report_Table</code> always begin at row 21? If its another row, what is it?"}, {"owner": {"reputation": 159, "user_id": 5297447, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/5868b37ff800a1eaa16eaad8257a4632?s=128&d=identicon&r=PG&f=1", "display_name": "Gerasimos.Zap", "link": "https://stackoverflow.com/users/5297447/gerasimos-zap"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1444846329, "post_id": 33130722, "comment_id": 54076774, "body": "Yes, row 21 will always be headers.  The data starts at cell A22.  Fail_Report_Table spans from A22:I47 with headers from A21:I21."}], "answers": [{"tags": [], "owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "is_accepted": true, "score": 0, "last_activity_date": 1444846543, "creation_date": 1444846543, "answer_id": 33132695, "question_id": 33130722, "link": "https://stackoverflow.com/questions/33130722/paste-filtered-results-to-another-sheet/33132695#33132695", "title": "Paste filtered results to another sheet", "body": "<p>Okay, now that I understand that <code>Fail_Report_Table</code> starts at A22, change the line</p>\n\n<pre><code>NextRow = wsFail.Range(\"Fail_Report_Table\").Cells(1, 1).End(xlDown).Offset(1).Row\n</code></pre>\n\n<p>to </p>\n\n<pre><code>NextRow = wsFail.Range(\"Fail_Report_Table\").Cells(1, 1).Offset(-1).End(xlDown).Offset(1).Row\n</code></pre>\n\n<p>For both times it occurs. </p>\n\n<p><em>Note: I know you have been working on this for quite a bit, so it would really serve you to study why these changes are taking place, instead of just copying them into your code and moving on, so you really understand what it is doing, so you can replicate it in the future, or manipulate it as needed.</em></p>\n"}], "owner": {"reputation": 159, "user_id": 5297447, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/5868b37ff800a1eaa16eaad8257a4632?s=128&d=identicon&r=PG&f=1", "display_name": "Gerasimos.Zap", "link": "https://stackoverflow.com/users/5297447/gerasimos-zap"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 83, "favorite_count": 0, "accepted_answer_id": 33132695, "answer_count": 1, "score": 0, "last_activity_date": 1444846543, "creation_date": 1444839905, "question_id": 33130722, "link": "https://stackoverflow.com/questions/33130722/paste-filtered-results-to-another-sheet", "title": "Paste filtered results to another sheet", "body": "<p>I am building a template that has three procedure worksheets(FTP, ATP, CS) and a Failure Report worksheet.  What I am attempting to do is apply an advanced filter to each of those procedure sheets, copy only the filtered results, and paste them in succession in a named range on the Failure Report.</p>\n\n<p>I have the advanced filter working properly, however it causes issues when I attempt to copy the results into the Failure Report.  The FTP results will paste correctly, however the ATP and CS will paste to the bottom of the named range (and expand the range).  I need to tell it to paste in the next empty cell in Column A (within the named range).  I have attached a copy of the results that are returned.<a href=\"https://i.stack.imgur.com/kCB5c.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/kCB5c.png\" alt=\"Failure Report Results\"></a></p>\n\n<pre><code>Sub AdvancedFilterCopyAttempt()\n' Script to apply an advanced filter to multiple worksheets and copy those results to copy to the Failure Report.\n\n 'Declare Variables\nDim rngCopy As Range, rngCopyNotes As Range\nDim NextRow As Long\nDim wsFTP As Worksheet, wsATP As Worksheet, wsFail As Worksheet, wsCS As Worksheet\n\nSet wsFTP = Sheets(\"Results\")\nSet wsATP = Sheets(\"ATP Results\")\nSet wsFail = Sheets(\"Failure Report\")\nSet wsCS = Sheets(\"CS Results\")\n\n Sheets(\"Results\").Activate\n Range(\"Results\").AdvancedFilter Action:=xlFilterInPlace, _\n CriteriaRange:=Range(\"Criteria\"), Unique:=False\n\nSheets(\"ATP Results\").Activate\nRange(\"A:I\").AdvancedFilter Action:=xlFilterInPlace, _\nCriteriaRange:=Range(\"APTCriteria\"), Unique:=True\n\nSheets(\"CS Results\").Activate\nRange(\"A:I\").AdvancedFilter Action:=xlFilterInPlace, _\nCriteriaRange:=Range(\"CSCriteria\"), Unique:=True\n\n\nwsFTP.Activate\n'copy FTP results to Failure Report\nSet rngCopy = wsFTP.Range(\"Results_Part1\").SpecialCells(xlCellTypeVisible)\nSet rngCopyNotes =      wsFTP.Range(\"Results_Part2\").SpecialCells(xlCellTypeVisible)\n\nSheets(\"Failure Report\").Range(\"A:A\").ClearContents\nNextRow = wsFail.Range(\"Fail_Report_Table\").Cells(1, 1).Row\nrngCopy.Copy wsFail.Range(\"A\" &amp; NextRow)\nrngCopyNotes.Copy wsFail.Range(\"H\" &amp; NextRow)\n\n\nwsATP.Activate\n'copy ATP results to Failure Report\nSet rngCopy = wsATP.Range(\"APTResults1\").SpecialCells(xlCellTypeVisible)\nSet rngCopyNotes = wsATP.Range(\"APTResults2\").SpecialCells(xlCellTypeVisible)\n\nNextRow = wsFail.Range(\"Fail_Report_Table\").Cells(1, 1).End(xlDown).Offset(1).Row\nrngCopy.Copy wsFail.Range(\"A\" &amp; NextRow)\nrngCopyNotes.Copy wsFail.Range(\"H\" &amp; NextRow)\n\nwsCS.Activate\nSet rngCopy = wsCS.Range(\"CSResults1\").SpecialCells(xlCellTypeVisible)\nSet rngCopyNotes = wsCS.Range(\"CSResults2\").SpecialCells(xlCellTypeVisible)\n\nNextRow = wsFail.Range(\"Fail_Report_Table\").Cells(1, 1).End(xlDown).Offset(1).Row\nrngCopy.Copy wsFail.Range(\"A\" &amp; NextRow)\nrngCopyNotes.Copy wsFail.Range(\"H\" &amp; NextRow)\n\nSheets(\"Failure Report\").Activate\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1444839518, "post_id": 33130372, "comment_id": 54072852, "body": "<code>rng</code> is an object.  It must use the <code>Set</code> keyword.  So: <code>Set rng = ...</code>.  Also remove the <code>.select</code> at the end of the same statement."}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1444839727, "post_id": 33130372, "comment_id": 54072988, "body": "You can&#39;t do that. It is not possible to create a range that is not on a worksheet. You&#39;d need to change the UDF either to work with discontiguous ranges or to ignoreblank cells, or actually copy the data somewhere."}], "answers": [{"tags": [], "owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "is_accepted": false, "score": 0, "last_activity_date": 1444841837, "last_edit_date": 1444841837, "creation_date": 1444839636, "answer_id": 33130625, "question_id": 33130372, "link": "https://stackoverflow.com/questions/33130372/excel-vba-new-range-from-selection/33130625#33130625", "title": "Excel VBA New range from selection", "body": "<pre><code>Public Function NewRange(ByRef rng As Range) As Range\n    Dim nrC As Range, nrF As Range\n\n    If Len(rng.Value2) = 0 Then Set rng = rng.Parent.UsedRange.Cells(1, 1)\n    Set rng = rng.CurrentRegion\n\n    On Error Resume Next\n    Set nrC = rng.SpecialCells(xlCellTypeConstants)\n    Set nrF = rng.SpecialCells(xlCellTypeFormulas)\n\n    Select Case True\n        Case Not nrC Is Nothing And Not nrF Is Nothing: Set NewRange = Union(nrC, nrF)\n        Case Not nrC Is Nothing:                        Set NewRange = nrC\n        Case Not nrF Is Nothing:                        Set NewRange = nrF\n    End Select\n    If NewRange Is Nothing Then Set NewRange = rng.Parent.Cells(1)\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 5445639, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/611b5f2b267e8adfcb38fc99d55e94b4?s=128&d=identicon&r=PG&f=1", "display_name": "Jean", "link": "https://stackoverflow.com/users/5445639/jean"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 156, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1444927432, "creation_date": 1444838985, "last_edit_date": 1531164843, "question_id": 33130372, "link": "https://stackoverflow.com/questions/33130372/excel-vba-new-range-from-selection", "title": "Excel VBA New range from selection", "body": "<p>I'm working with a complex UserDefined function that works only with a single and contiguous range of data.\nTherfore I would like to create a function, which for a given range, returns me a new range emptied of blank cells, which will serve as input for the initial function. </p>\n\n<p>Here's what what I have unsuccessfuly done so far:</p>\n\n<pre><code>Public Function NewRange(rng) As Range\n\n    rng.SpecialCells(xlCellTypeConstants).Select\n    rng.SpecialCells(xlCellTypeFormulas).Select\n    rng = Union(rng.SpecialCells(xlCellTypeConstants), _\n      rng.SpecialCells(xlCellTypeFormulas)).Select\nSet NewRange = rng\nEnd Function\n</code></pre>\n\n<p>Could you help me please in solving it?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1444838875, "post_id": 33130264, "comment_id": 54072456, "body": "You need to declare <code>vSelection</code> <b>before</b> the first procedure and not in it."}, {"owner": {"reputation": 163, "user_id": 4611636, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/CApZY.png?s=128&g=1", "display_name": "Iluvpresident", "link": "https://stackoverflow.com/users/4611636/iluvpresident"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1444839761, "post_id": 33130264, "comment_id": 54073008, "body": "That did the trick, ty :D"}], "answers": [{"tags": [], "owner": {"reputation": 7422, "user_id": 1586390, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f07270207034d2bcbe347b028edc8f02?s=128&d=identicon&r=PG", "display_name": "Sorceri", "link": "https://stackoverflow.com/users/1586390/sorceri"}, "is_accepted": true, "score": 1, "last_activity_date": 1444839475, "creation_date": 1444839475, "answer_id": 33130561, "question_id": 33130264, "link": "https://stackoverflow.com/questions/33130264/vba-excel-using-a-declared-variable-in-another-sub/33130561#33130561", "title": "vba Excel using a declared variable in another sub", "body": "<p>You need to understand the scope of the variable</p>\n\n<p>Scope   How the variable is declared</p>\n\n<p>Procedure only - By using a Dim or a Static statement in the procedure that uses the variable</p>\n\n<p>Module only - By using a Dim statement before the first Sub or Function statement in the module</p>\n\n<p>All procedures in all modules - By using a Public statement before the first Sub or Function statement in a module</p>\n"}], "owner": {"reputation": 163, "user_id": 4611636, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/CApZY.png?s=128&g=1", "display_name": "Iluvpresident", "link": "https://stackoverflow.com/users/4611636/iluvpresident"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1005, "favorite_count": 0, "accepted_answer_id": 33130561, "answer_count": 1, "score": 0, "last_activity_date": 1444839475, "creation_date": 1444838675, "question_id": 33130264, "link": "https://stackoverflow.com/questions/33130264/vba-excel-using-a-declared-variable-in-another-sub", "title": "vba Excel using a declared variable in another sub", "body": "<p>What I'm trying to do here is use my declared \"vSelection\" in another Sub but it doesn't seem to be working. Maybe anyone can help me out?</p>\n\n<p>This is where I declare it.</p>\n\n<pre><code>Public Sub cmdBladeren_Click()\n</code></pre>\n\n<p><strong></p>\n\n<pre><code>Dim vSelection As Variant\nvSelection = Application.GetOpenFilename(\"Graphics files (*.gif), *.gif\")\n</code></pre>\n\n<p></strong>    </p>\n\n<pre><code>If vSelection = False Then\nMsgBox \"Selecteer een foto!\"\nExit Sub\nEnd If\n\nEnd Sub\n</code></pre>\n\n<p>This is where I want to use it</p>\n\n<pre><code>Private Sub btnOK_Click()\n\nDim rngRange As Range\nDim rngProduct As Range\nDim lTop As Long\nDim lLeft As Long\nDim oShape As Shape   \n\nSet rngRange = Range(\"C2:O100\")\n\nFor intteller = 1 To 7000\n\nIf rngRange.Cells(intteller).Interior.Color = RGB(146, 208, 80) Then\n    Set rngProduct = rngRange.Cells(intteller)\n    rngProduct.Interior.Color = RGB(193, 130, 67)\n    lTop = rngProduct.Top\n    lLeft = rngProduct.Left\n</code></pre>\n\n<p><strong></p>\n\n<pre><code>    Set oShape = ActiveSheet.Shapes.AddPicture(vSelection, True, True,   lLeft, lTop, 100, 192)\n</code></pre>\n\n<p></strong></p>\n\n<pre><code>rngProduct.Offset(1, 0).Value = Me.txtNaamProduct.Value\nExit For\nElse\nEnd If\n\nNext\nUnload frmNieuwProduct\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1444840230, "post_id": 33130196, "comment_id": 54073270, "body": "Curious. How long (seconds) is &quot;very slow&quot;? Basically you are doing a single loop over &lt; 100 items. This should be instantaneous. -- Why do you have separate variables <code>i</code> and <code>index</code>? -- I doubt you gain anything by using <code>rs.GetRows</code> instead of a <code>Do While Not rs.EOF</code> loop. Maybe it&#39;s even the culprit."}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1444841034, "post_id": 33130196, "comment_id": 54073706, "body": "And: How many columns has <code>S31RptSimple</code>? What data types are they? -- You can add some <code>Debug.Print Timer</code> statements in the code, to find out where exactly it is slow. Or <code>Start = Timer  ...  Debug.Print Timer-Start</code>"}, {"owner": {"reputation": 3, "user_id": 5445541, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/635f7658ac7395f2e294baf3dfc55e96?s=128&d=identicon&r=PG&f=1", "display_name": "K Gargiullo", "link": "https://stackoverflow.com/users/5445541/k-gargiullo"}, "reply_to_user": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1444842042, "post_id": 33130196, "comment_id": 54074320, "body": "@HansUp Here <a href=\"http://imgur.com/Szycbj3\" rel=\"nofollow noreferrer\">imgur.com/Szycbj3</a> is a screenshot with the original table on the bottom and the desired output on the top. I had to remove part of the SampleID because privacy, but you get the idea. Most of the code is just checking the values against the fail criteria, which is why it might seem arbitrary.  I and index are two separate variables because I derped, and I never thought to use a Do While Not EOF loop! I&#39;ll give that a shot now, thanks."}, {"owner": {"reputation": 3, "user_id": 5445541, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/635f7658ac7395f2e294baf3dfc55e96?s=128&d=identicon&r=PG&f=1", "display_name": "K Gargiullo", "link": "https://stackoverflow.com/users/5445541/k-gargiullo"}, "reply_to_user": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1444842294, "post_id": 33130196, "comment_id": 54074475, "body": "@Andre451 It&#39;s 5 to 7 seconds, but it&#39;s 5 to 7 seconds every time I scroll or click on something. This table is actually 47 records, it&#39;s the other tables that might go up to 100. S31RptSimple has 9 columns, mostly Single with one short text and one long integer. I&#39;ll try the debug.print Timer if swapping to a Do While Not EOF loop doesn&#39;t fix the problem. Thanks!"}, {"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "edited": false, "score": 0, "creation_date": 1444842632, "post_id": 33130196, "comment_id": 54074648, "body": "Running the loop is a split second only, so &quot;5-7 second every time I scroll or click on something&quot; indicates that something else is going on - like calling this at the OnCurrent event. You leave us guessing."}, {"owner": {"reputation": 3, "user_id": 5445541, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/635f7658ac7395f2e294baf3dfc55e96?s=128&d=identicon&r=PG&f=1", "display_name": "K Gargiullo", "link": "https://stackoverflow.com/users/5445541/k-gargiullo"}, "reply_to_user": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "edited": false, "score": 0, "creation_date": 1444843027, "post_id": 33130196, "comment_id": 54074883, "body": "@Gustav I&#39;m not calling the sub directly in any events, just using it as it&#39;s called through the FailList2 function. I have that function as a field in a query. Could that be the problem, and if so how would I fix it?"}], "answers": [{"comments": [{"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "edited": false, "score": 1, "creation_date": 1444854335, "post_id": 33132070, "comment_id": 54081464, "body": "Well, as said: &quot;something else is going on&quot;."}], "tags": [], "owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "is_accepted": true, "score": 0, "last_activity_date": 1444844379, "creation_date": 1444844379, "answer_id": 33132070, "question_id": 33130196, "link": "https://stackoverflow.com/questions/33130196/vba-module-for-access-painfully-slow/33132070#33132070", "title": "VBA module for Access painfully slow", "body": "<blockquote>\n  <p>I have that function as a field in a query</p>\n</blockquote>\n\n<p>Uh-oh. There is the problem. Just open the Immediate window, open your query and watch the Debug.Print statements roll in. The function will be executed over and over again.</p>\n\n<p>You need to execute the function <strong>once</strong>, write the results not into an array (arrFails), but into a table instead. Use <code>Recordset.AddNew</code> to add records.</p>\n\n<p>Then use that table as input for your query.</p>\n"}], "owner": {"reputation": 3, "user_id": 5445541, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/635f7658ac7395f2e294baf3dfc55e96?s=128&d=identicon&r=PG&f=1", "display_name": "K Gargiullo", "link": "https://stackoverflow.com/users/5445541/k-gargiullo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1151, "favorite_count": 0, "accepted_answer_id": 33132070, "answer_count": 1, "score": 0, "last_activity_date": 1444844379, "creation_date": 1444838461, "question_id": 33130196, "link": "https://stackoverflow.com/questions/33130196/vba-module-for-access-painfully-slow", "title": "VBA module for Access painfully slow", "body": "<p>Doing data analysis for a lab and I have a table of samples that failed and all the criteria they could've failed on. Trying to add a field with a string listing which criteria each sample failed on.</p>\n\n<p>I just learned VBA 2 weeks ago so I don't really know what I'm doing. I used recordset to turn my table into an array, then looped through each record to see if each criteria has failed and add it to a new failure array if it has. Then I print the failure array in an ugly concatenated string. There are less than 100 records but it's still very slow and sometimes crashes Access. Here's my code: </p>\n\n<pre><code>Option Compare Database\nOption Explicit\nDim arrFails() As Variant\nDim db As DAO.Database\nDim rs As DAO.Recordset\nDim HType As Integer\nDim S As Integer\n\nPublic Sub MakeArrs()\n    On Error GoTo ErrorHandler\n    Set db = CurrentDb\n     'Set rs = db.OpenRecordset(\"S\" &amp; HType &amp; \"RptSimple\")\n\n    Set rs = db.OpenRecordset(\"S31RptSimple\")\n\n    rs.MoveLast\n    rs.MoveFirst\n    S = rs.RecordCount - 1\n    Debug.Print S\n    Dim arrRpt() As Variant\n    arrRpt = rs.GetRows(S + 1)\n    Debug.Print arrRpt(0, 0)\n    'This line creates an array arrFails with sample runs as rows, and 9 columns. Each column is a failure criteria.\n    ReDim arrFails(0 To S, 0 To 8) As Variant\n\n\n    Dim i As Long\n    Let i = 0\n    Dim index As Long\n    'This For loop starts at the first record in arrRpt and goes across the row with an If loop for each of the failure criteria.\n    'If the sample failed for that criteria, it populates the new arrFails array with the name of the criteria.\n    'If the sample passed, that spot on the array stays null.\n    'At the end of one loop, we have a row that ONLY has values for the criteria that failed.\n    For index = 0 To S\n        If arrRpt(2, i) &lt; 0.85 Or IsNull(arrRpt(2, i)) = True Then\n        arrFails(i, 0) = \"Correlation, \"\n        End If\n        If arrRpt(3, i) &gt; -0.4 Or arrRpt(3, i) &lt; -2 Or IsNull(arrRpt(3, i)) = True Then\n        arrFails(i, 1) = \"Slope, \"\n        End If\n        If arrRpt(4, i) &lt; 0.5 Or arrRpt(4, i) &gt; 100 Or IsNull(arrRpt(4, i)) = True Then\n        arrFails(i, 2) = \"Slope_Ratio, \"\n        End If\n        If arrRpt(5, i) &lt; 2 Or IsNull(arrRpt(5, i)) = True Then\n        arrFails(i, 3) = \"Valid_Points, \"\n        End If\n        If IsNull(arrRpt(6, i)) = False Then\n        arrFails(i, 4) = \"Fail_Code, \"\n        End If\n        If arrRpt(7, i) &lt; 1.5 Or arrRpt(7, i) &gt; 10 Or IsNull(arrRpt(7, i)) = True Then\n        arrFails(i, 5) = \"DilutionRatio1, \"\n        End If\n        If arrRpt(8, i) &lt; 1.5 Or arrRpt(8, i) &gt; 10 Or IsNull(arrRpt(8, i)) = True Then\n        arrFails(i, 6) = \"DilutionRatio2, \"\n        End If\n        arrFails(i, 8) = arrRpt(0, i)\n        i = i + 1\n\n    Next\n\n    rs.Close\n\n    'This is error handling code, so if something goes wrong it'll gracefully exit the code instead of getting some poor user stuck in debug hell.\nExitSub:\n        Exit Sub\nErrorHandler:\n        MsgBox \"There's been an error.\"\n        Resume ExitSub\n    Set rs = Nothing\n    Set db = Nothing\n\nEnd Sub\n\nPublic Function FailList2(HPVType, UIDFieldname)\n    HType = HPVType\n    Call MakeArrs\n    Dim x As Variant\n    x = 0\n    Do While x &lt; S + 1\n    If UIDFieldname = arrFails(x, 8) Then\n    FailList2 = arrFails(x, 1) &amp; arrFails(x, 0) &amp; arrFails(x, 2) &amp; arrFails(x, 3) &amp; arrFails(x, 4) &amp; arrFails(x, 5) &amp; arrFails(x, 6)\n    Exit Do\n    End If\n    x = x + 1\n    Loop\nEnd Function\n</code></pre>\n\n<p>Help a newbie out? There must be a more efficient way to do this. I tried turning echo off until the end of the FailList2 function but it didn't help. Note that I need to keep 'Htype' in the function. I'm just running this on one table right now, but when I fix it I have 8 more tables to run it on, hence the rs code I commented out at the beginning.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 12614, "user_id": 3566998, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S7lz6.png?s=128&g=1", "display_name": "Excel Hero", "link": "https://stackoverflow.com/users/3566998/excel-hero"}, "edited": false, "score": 0, "creation_date": 1444838812, "post_id": 33130099, "comment_id": 54072413, "body": "You need to specify the RANGE that you want to ensure sums to 100%."}, {"owner": {"reputation": 783, "user_id": 929935, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/4e8306d82f4ea5fe673f449aa049b9db?s=128&d=identicon&r=PG&f=1", "display_name": "Amritha", "link": "https://stackoverflow.com/users/929935/amritha"}, "reply_to_user": {"reputation": 12614, "user_id": 3566998, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S7lz6.png?s=128&g=1", "display_name": "Excel Hero", "link": "https://stackoverflow.com/users/3566998/excel-hero"}, "edited": false, "score": 0, "creation_date": 1444838929, "post_id": 33130099, "comment_id": 54072488, "body": "Its 5 cells, C1:C5. and C6 is SUM(C1:C5). I want to set up a rule which would constantly check if C6 is 100% and if not, pop up an alert."}, {"owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 0, "creation_date": 1444838992, "post_id": 33130099, "comment_id": 54072524, "body": "How do you want the alert to pop up? through a message box?"}, {"owner": {"reputation": 783, "user_id": 929935, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/4e8306d82f4ea5fe673f449aa049b9db?s=128&d=identicon&r=PG&f=1", "display_name": "Amritha", "link": "https://stackoverflow.com/users/929935/amritha"}, "edited": false, "score": 0, "creation_date": 1444839162, "post_id": 33130099, "comment_id": 54072637, "body": "Yes. Through a message box."}, {"owner": {"reputation": 12614, "user_id": 3566998, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S7lz6.png?s=128&g=1", "display_name": "Excel Hero", "link": "https://stackoverflow.com/users/3566998/excel-hero"}, "edited": false, "score": 0, "creation_date": 1444839674, "post_id": 33130099, "comment_id": 54072961, "body": "Have you considered Conditional Formatting for cell C6?"}, {"owner": {"reputation": 339, "user_id": 5042263, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-4GD2iGS817g/AAAAAAAAAAI/AAAAAAAAAd4/o-nfiJZs8Us/photo.jpg?sz=128", "display_name": "Clint Street", "link": "https://stackoverflow.com/users/5042263/clint-street"}, "edited": false, "score": 0, "creation_date": 1444840710, "post_id": 33130099, "comment_id": 54073523, "body": "Why not just use conditional formatting instead of VBA Code? Is that an option for you."}, {"owner": {"reputation": 783, "user_id": 929935, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/4e8306d82f4ea5fe673f449aa049b9db?s=128&d=identicon&r=PG&f=1", "display_name": "Amritha", "link": "https://stackoverflow.com/users/929935/amritha"}, "edited": false, "score": 0, "creation_date": 1444844199, "post_id": 33130099, "comment_id": 54075512, "body": "I am trying to use Data Validation to do this instead of any coding as what I really want is for the users to be unable to change the values of cells if the total changes from 100. Data Validation still is not working. It always seems to throw errors. Anyone have any thoughts on this ?"}, {"owner": {"reputation": 12614, "user_id": 3566998, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S7lz6.png?s=128&g=1", "display_name": "Excel Hero", "link": "https://stackoverflow.com/users/3566998/excel-hero"}, "edited": false, "score": 0, "creation_date": 1444854881, "post_id": 33130099, "comment_id": 54081763, "body": "@Amritha Can you please send me your workbook. I can make the data validation work for you. My email address is:  daniel.ferry@gmail.com"}], "answers": [{"comments": [{"owner": {"reputation": 783, "user_id": 929935, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/4e8306d82f4ea5fe673f449aa049b9db?s=128&d=identicon&r=PG&f=1", "display_name": "Amritha", "link": "https://stackoverflow.com/users/929935/amritha"}, "edited": false, "score": 0, "creation_date": 1444839491, "post_id": 33130454, "comment_id": 54072839, "body": "Thank you for the response. I wanted the alert to pop up as a message box if any of the inputs are changed. All the inputs are on the same sheet."}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "reply_to_user": {"reputation": 783, "user_id": 929935, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/4e8306d82f4ea5fe673f449aa049b9db?s=128&d=identicon&r=PG&f=1", "display_name": "Amritha", "link": "https://stackoverflow.com/users/929935/amritha"}, "edited": false, "score": 0, "creation_date": 1444839920, "post_id": 33130454, "comment_id": 54073115, "body": "In that case use the code I&#39;ve added at the bottom of my reply.  Edit:  Saying that, you want it to check if it&#39;s not 100%.  Using &lt;&gt;1 will throw the error on every input until the total equals 100% which is probably not what you want - as @Vincent said in his answer."}], "tags": [], "owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "is_accepted": false, "score": 0, "last_activity_date": 1444839875, "last_edit_date": 1444839875, "creation_date": 1444839215, "answer_id": 33130454, "question_id": 33130099, "link": "https://stackoverflow.com/questions/33130099/macro-to-limit/33130454#33130454", "title": "Macro to Limit %", "body": "<p>If I've understood your question correctly you'll be able to do this without any code.</p>\n\n<p>For example, your percentage cells are on Sheet3, Sheet4 and Sheet5 in the ranges B2:B6.</p>\n\n<p>On Sheet6 you can use the formula <code>=SUM(Sheet3:Sheet5!$B$2:$B$6)</code><br>\n<em>NB:  This is a 3D formula and works providing Sheet4 is between Sheet3 &amp; Sheet5 in tab order.</em></p>\n\n<p>You can then use conditional formatting on the total - <strong>Format only cells that contain</strong> - <strong>Cell Value is greater than 1</strong>.<br>\nThen format it as something obvious (I generally use bold yellow text with a red background).</p>\n\n<p>Ok, as reply to your comment, add this code to the worksheet code module which will run every time the sheet calculates:</p>\n\n<pre><code>Private Sub Worksheet_Calculate()\n    If Cells(6, 3) &gt; 1 Then\n        MsgBox \"Total is too high\"\n    End If\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 783, "user_id": 929935, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/4e8306d82f4ea5fe673f449aa049b9db?s=128&d=identicon&r=PG&f=1", "display_name": "Amritha", "link": "https://stackoverflow.com/users/929935/amritha"}, "edited": false, "score": 0, "creation_date": 1444839545, "post_id": 33130476, "comment_id": 54072877, "body": "Yes, not while entering. If either of the input % have been changed, I wanted a msgbox to pop and say total does not add to 100."}, {"owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "reply_to_user": {"reputation": 783, "user_id": 929935, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/4e8306d82f4ea5fe673f449aa049b9db?s=128&d=identicon&r=PG&f=1", "display_name": "Amritha", "link": "https://stackoverflow.com/users/929935/amritha"}, "edited": false, "score": 0, "creation_date": 1444893754, "post_id": 33130476, "comment_id": 54094639, "body": "I edited the solution to not send message if some cells of the range are empty."}], "tags": [], "owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "is_accepted": false, "score": 0, "last_activity_date": 1444893689, "last_edit_date": 1444893689, "creation_date": 1444839277, "answer_id": 33130476, "question_id": 33130099, "link": "https://stackoverflow.com/questions/33130099/macro-to-limit/33130476#33130476", "title": "Macro to Limit %", "body": "<p>You can use a UDF to replace the SUM function:</p>\n\n<pre><code>Function SumAndAlert(rng As Range) As Variant\n    SumAndAlert = Application.Sum(rng)\n    If Application.CountBlank(rng) = 0 And SumAndAlert &lt;&gt; 1 Then MsgBox \"not 100%\"\nEnd Function\n</code></pre>\n\n<p>but I think it might be a little annoying to have message boxes poping out while entering data.</p>\n"}, {"comments": [{"owner": {"reputation": 12614, "user_id": 3566998, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S7lz6.png?s=128&g=1", "display_name": "Excel Hero", "link": "https://stackoverflow.com/users/3566998/excel-hero"}, "edited": false, "score": 0, "creation_date": 1444972872, "post_id": 33130878, "comment_id": 54134802, "body": "@Amritha Were you able to get this going?"}], "tags": [], "owner": {"reputation": 12614, "user_id": 3566998, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S7lz6.png?s=128&g=1", "display_name": "Excel Hero", "link": "https://stackoverflow.com/users/3566998/excel-hero"}, "is_accepted": false, "score": 0, "last_activity_date": 1444840403, "creation_date": 1444840403, "answer_id": 33130878, "question_id": 33130099, "link": "https://stackoverflow.com/questions/33130099/macro-to-limit/33130878#33130878", "title": "Macro to Limit %", "body": "<p>I would not use the Worksheet_Calculate event procedure because doing so would cause much too frequent evaluation of the MsgBox condition.</p>\n\n<p>Try to keep that to an absolute minimum like so:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    If Target.Count = 1 Then\n        If Target.Column = 3 Then\n            If Target.Row &lt; 6 Then\n                If Val(Me.[c6]) &gt; 1 Then\n                    MsgBox \"Greater than 100%\"\n                End If\n            End If\n        End If\n    End If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 783, "user_id": 929935, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/4e8306d82f4ea5fe673f449aa049b9db?s=128&d=identicon&r=PG&f=1", "display_name": "Amritha", "link": "https://stackoverflow.com/users/929935/amritha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 135, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1444927069, "creation_date": 1444838188, "last_edit_date": 1444927069, "question_id": 33130099, "link": "https://stackoverflow.com/questions/33130099/macro-to-limit", "title": "Macro to Limit %", "body": "<p>I have an excel spreadsheet which has multiple tabs and cells filled with % values. There are some cells which read 20%, 30%, 40% etc and the format of these cells are 'percentage'. There is a sum cell which sums up all these percentages to equal 100%. I am trying to write a simple macro/rule which would constantly read the sum cell and throw out an alert if it does not equal 100%. I am not sure how to proceed.</p>\n\n<p>I am trying to use Data Validation to do this instead of any coding as what I really want is for the users to be unable to change the values of cells if the total changes from 100. Data Validation still is not working. It always seems to throw errors. Anyone have any thoughts on this ? I have selected the range of numbers and in data validation I am choosing Custom where I am saying = Sum(C5:C10)=100. This is always throwing an error even when the total is 100. Any thoughts ?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 3650, "user_id": 5090027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/904db949ae64fe1a63ea8b4c677e6d57?s=128&d=identicon&r=PG&f=1", "display_name": "Grade &#39;Eh&#39; Bacon", "link": "https://stackoverflow.com/users/5090027/grade-eh-bacon"}, "edited": false, "score": 0, "creation_date": 1444837727, "post_id": 33129862, "comment_id": 54071676, "body": "You need to include the actual mechanism for looping - the code you have doesn&#39;t show where the error would be. Include the entire section of the Sub which contains the problem."}, {"owner": {"reputation": 22957, "user_id": 78522, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3facb4a672d9fbeb9f2ed6b5acc65633?s=128&d=identicon&r=PG", "display_name": "Patrick Honorez", "link": "https://stackoverflow.com/users/78522/patrick-honorez"}, "edited": false, "score": 0, "creation_date": 1444837957, "post_id": 33129862, "comment_id": 54071831, "body": "Shouldn&#39;t it be <code>Sheets(&quot;Sheet2&quot;).Range (&quot;A&quot; &amp; Cells(Rows.Count).Row).</code> ? I don&#39;t understand that &quot;1&quot; after the &quot;A&quot;."}, {"owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "edited": false, "score": 0, "creation_date": 1444846068, "post_id": 33129862, "comment_id": 54076612, "body": "I agree with iDevlop, it should be just &quot;A&quot;"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 5445757, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/09221ca92d137ebe3e8d9ecec58d1c46?s=128&d=identicon&r=PG&f=1", "display_name": "A. Johnson", "link": "https://stackoverflow.com/users/5445757/a-johnson"}, "edited": false, "score": 0, "creation_date": 1444840522, "post_id": 33130221, "comment_id": 54073438, "body": "In the corrected code, where is the initial destination cell on the left-hand side of the assignment statement? (In my example, A1)."}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "reply_to_user": {"reputation": 1, "user_id": 5445757, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/09221ca92d137ebe3e8d9ecec58d1c46?s=128&d=identicon&r=PG&f=1", "display_name": "A. Johnson", "link": "https://stackoverflow.com/users/5445757/a-johnson"}, "edited": false, "score": 0, "creation_date": 1444841049, "post_id": 33130221, "comment_id": 54073717, "body": "@A.Johnson as I understood your OP, you wanted to copy from Sheet1/A1 into Sheet2/first empty cell in column A. The above does that. I probably misunderstood you requirement."}, {"owner": {"reputation": 1, "user_id": 5445757, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/09221ca92d137ebe3e8d9ecec58d1c46?s=128&d=identicon&r=PG&f=1", "display_name": "A. Johnson", "link": "https://stackoverflow.com/users/5445757/a-johnson"}, "edited": false, "score": 0, "creation_date": 1444841390, "post_id": 33130221, "comment_id": 54073924, "body": "Apologies, I gave A1 as an example. In the actual code, a number of origin cells are copied over between sheets. The values in P8, Q8, R8 etc. on Sheet1  are passed to various columns on Sheet2 whose topmost cell is C4, D4, E4 etc."}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "reply_to_user": {"reputation": 1, "user_id": 5445757, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/09221ca92d137ebe3e8d9ecec58d1c46?s=128&d=identicon&r=PG&f=1", "display_name": "A. Johnson", "link": "https://stackoverflow.com/users/5445757/a-johnson"}, "edited": false, "score": 0, "creation_date": 1444841624, "post_id": 33130221, "comment_id": 54074062, "body": "The above code corrects your mistake that occurs after 263 entries. If your Worksheet_Change event is written correctly but had only this error, as in the OP, I think it will work if you apply the (idea of) this correction. :)"}, {"owner": {"reputation": 1, "user_id": 5445757, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/09221ca92d137ebe3e8d9ecec58d1c46?s=128&d=identicon&r=PG&f=1", "display_name": "A. Johnson", "link": "https://stackoverflow.com/users/5445757/a-johnson"}, "edited": false, "score": 0, "creation_date": 1444862133, "post_id": 33130221, "comment_id": 54085091, "body": "It does indeed. The adapted code works perfectly. Part of me still wonders why the original code fails after 263 iterations. But life is short..."}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "reply_to_user": {"reputation": 1, "user_id": 5445757, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/09221ca92d137ebe3e8d9ecec58d1c46?s=128&d=identicon&r=PG&f=1", "display_name": "A. Johnson", "link": "https://stackoverflow.com/users/5445757/a-johnson"}, "edited": false, "score": 0, "creation_date": 1444872500, "post_id": 33130221, "comment_id": 54087908, "body": "I said it in the answer, you were not fetching correctly the last cell of column A. You were using Cells(Rows.count) with only one parameter. This leads to row 63. when this falls into your used area, xlUp takes you back to row 1. OTOH, Cells(Cells(Rows.count, 1) leads to row 1,048,576, which with xlUp is guaranteed to take you to your last used row."}], "tags": [], "owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "is_accepted": false, "score": 0, "last_activity_date": 1444838555, "creation_date": 1444838555, "answer_id": 33130221, "question_id": 33129862, "link": "https://stackoverflow.com/questions/33129862/vba-code-using-cellsrows-count-row-endxlup-fails-after-263-iterations/33130221#33130221", "title": "VBA code using &quot;Cells(Rows.count).Row).End(xlUp)&quot; fails after 263 iterations", "body": "<p>Should be:</p>\n\n<pre><code>Sheets(\"Sheet2\").Cells(Rows.Count, 1).End(xlUp).Offset(1, 0).Value = Sheets(\"Sheet1\").Range(\"A1\").Value\n</code></pre>\n\n<p>Fetching <code>Cells(Rows.Count)</code> with only one parameter does not lead you to the bottom cell of column A, because <code>Cells()</code> will then count items horizontally before moving to next row. After some operations you are falling back to the already used area.</p>\n"}], "owner": {"reputation": 1, "user_id": 5445757, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/09221ca92d137ebe3e8d9ecec58d1c46?s=128&d=identicon&r=PG&f=1", "display_name": "A. Johnson", "link": "https://stackoverflow.com/users/5445757/a-johnson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 3995, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1444838555, "creation_date": 1444837452, "last_edit_date": 1444837667, "question_id": 33129862, "link": "https://stackoverflow.com/questions/33129862/vba-code-using-cellsrows-count-row-endxlup-fails-after-263-iterations", "title": "VBA code using &quot;Cells(Rows.count).Row).End(xlUp)&quot; fails after 263 iterations", "body": "<p>I am using a Sub of the form:</p>\n\n<pre><code>If Not Intersect(Target, Sheets(\"Sheet1\").Range(\"A1\")) Is Nothing Then (+ code)\n</code></pre>\n\n<p>in conjunction with:</p>\n\n<pre><code>Sheets(\"Sheet2\").Range (\"A1\" &amp; Cells(Rows.Count).Row).End(xlUp).Offset(1, 0).Value = Sheets(\"Sheet1\").Range(\"A1\").Value\n</code></pre>\n\n<p>with the intention of copying data from a cell (e.g. A1) on Sheet1, which changes frequently, to a column (e.g. A:) on Sheet2.</p>\n\n<p>This works fine for the first 263 iterations (it is always 263 regardless of the time intervals), but then on the 264th, instead of copying the next value to the next empty cell in the column, it continuously overwrites the value in cell A2. This is unfortunate, as I need to record at least 600 values.</p>\n\n<p>I am using Excel 2013 under Windows 10.</p>\n"}, {"tags": ["excel", "format", "type-conversion", "vba"], "answers": [{"tags": [], "owner": {"reputation": 3650, "user_id": 5090027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/904db949ae64fe1a63ea8b4c677e6d57?s=128&d=identicon&r=PG&f=1", "display_name": "Grade &#39;Eh&#39; Bacon", "link": "https://stackoverflow.com/users/5090027/grade-eh-bacon"}, "is_accepted": true, "score": 0, "last_activity_date": 1444837825, "creation_date": 1444837825, "answer_id": 33129971, "question_id": 33129822, "link": "https://stackoverflow.com/questions/33129822/handling-different-formats-in-the-same-column/33129971#33129971", "title": "Handling different formats in the same column", "body": "<p>Simpler than VBA - go to the Data Ribbon, select the column, and click Text to Columns, then Finish.</p>\n\n<p>This usually auto-detects the presence of numbers formatted as text, and reformats appropriately.</p>\n"}], "owner": {"reputation": 381, "user_id": 4995716, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/ac9a0782abeab1e5b93879cc24d69df5?s=128&d=identicon&r=PG&f=1", "display_name": "Tony", "link": "https://stackoverflow.com/users/4995716/tony"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 39, "favorite_count": 0, "accepted_answer_id": 33129971, "answer_count": 1, "score": 0, "last_activity_date": 1444837825, "creation_date": 1444837341, "last_edit_date": 1531161705, "question_id": 33129822, "link": "https://stackoverflow.com/questions/33129822/handling-different-formats-in-the-same-column", "title": "Handling different formats in the same column", "body": "<p>Run into a bit of an issue, a file that I receive contains a column that consists of numbers and text, currently the format of this column is in text format.  Is there a way to convert the numbers to number format and leave the text as text? I need to be able to do this for comparisons I do later in the code and due to this formatting it shows up as the numbers being different due to them being in text format. </p>\n\n<p>Here is the code I am currently implementing to convert the imported version to text:</p>\n\n<pre><code>Columns(\"T:T\").Select\n    Selection.TextToColumns Destination:=Range(\"T1\"), DataType:=xlDelimited, _\n    TextQualifier:=xlDoubleQuote, ConsecutiveDelimiter:=False, Tab:=False, _\n    Semicolon:=False, Comma:=False, Space:=False, Other:=False, FieldInfo _\n    :=Array(1, 2), TrailingMinusNumbers:=True \n</code></pre>\n\n<p>Thanks for any help/advice!</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1444837477, "post_id": 33129574, "comment_id": 54071512, "body": "The simplest way is to iterate on cells of the date column, create a name string such as <code>&quot;WS_&quot; &amp; cell.Text</code> and check if a sheet with this name already exists, create it of not. Did I miss something?"}, {"owner": {"reputation": 147, "user_id": 5373207, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/e19d3304226cff2fc35c679235c7a2df?s=128&d=identicon&r=PG&f=1", "display_name": "okmred", "link": "https://stackoverflow.com/users/5373207/okmred"}, "reply_to_user": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1444837975, "post_id": 33129574, "comment_id": 54071836, "body": "That&#39;s it exactly, just looking for some sample code to hel me get there....Thanks."}], "answers": [{"comments": [{"owner": {"reputation": 147, "user_id": 5373207, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/e19d3304226cff2fc35c679235c7a2df?s=128&d=identicon&r=PG&f=1", "display_name": "okmred", "link": "https://stackoverflow.com/users/5373207/okmred"}, "edited": false, "score": 0, "creation_date": 1444839913, "post_id": 33130556, "comment_id": 54073110, "body": "gets an error here: For each cell in Worksheets(&quot;MasterSheet&quot;).Range(&quot;A:A&quot;)    I updated to &quot;C:C&quot; as that is my date column, but just errors...."}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "reply_to_user": {"reputation": 147, "user_id": 5373207, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/e19d3304226cff2fc35c679235c7a2df?s=128&d=identicon&r=PG&f=1", "display_name": "okmred", "link": "https://stackoverflow.com/users/5373207/okmred"}, "edited": false, "score": 0, "creation_date": 1444840146, "post_id": 33130556, "comment_id": 54073229, "body": "@okmred ok it is because worksheet name do not accept the &quot;/&quot; character in the name. Try to change the format of the date column to avoid /."}, {"owner": {"reputation": 147, "user_id": 5373207, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/e19d3304226cff2fc35c679235c7a2df?s=128&d=identicon&r=PG&f=1", "display_name": "okmred", "link": "https://stackoverflow.com/users/5373207/okmred"}, "edited": false, "score": 0, "creation_date": 1444841976, "post_id": 33130556, "comment_id": 54074274, "body": "can we not use Day() in the range some how??"}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "reply_to_user": {"reputation": 147, "user_id": 5373207, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/e19d3304226cff2fc35c679235c7a2df?s=128&d=identicon&r=PG&f=1", "display_name": "okmred", "link": "https://stackoverflow.com/users/5373207/okmred"}, "edited": false, "score": 0, "creation_date": 1444842211, "post_id": 33130556, "comment_id": 54074419, "body": "What is the name you want to give to the new ws according to the date? can you give a precise example please?"}, {"owner": {"reputation": 147, "user_id": 5373207, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/e19d3304226cff2fc35c679235c7a2df?s=128&d=identicon&r=PG&f=1", "display_name": "okmred", "link": "https://stackoverflow.com/users/5373207/okmred"}, "edited": false, "score": 0, "creation_date": 1444842580, "post_id": 33130556, "comment_id": 54074616, "body": "I want to use the date of the day. So in the column I have:07/01/2010  I want to have that equal sheet 1, if I have 07/12/2010....I want that to equal sheet 12...."}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "reply_to_user": {"reputation": 147, "user_id": 5373207, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/e19d3304226cff2fc35c679235c7a2df?s=128&d=identicon&r=PG&f=1", "display_name": "okmred", "link": "https://stackoverflow.com/users/5373207/okmred"}, "edited": false, "score": 0, "creation_date": 1444843061, "post_id": 33130556, "comment_id": 54074905, "body": "Ah, so it means you want to ignore the month and year? the edit does that."}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "reply_to_user": {"reputation": 147, "user_id": 5373207, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/e19d3304226cff2fc35c679235c7a2df?s=128&d=identicon&r=PG&f=1", "display_name": "okmred", "link": "https://stackoverflow.com/users/5373207/okmred"}, "edited": false, "score": 0, "creation_date": 1444843159, "post_id": 33130556, "comment_id": 54074955, "body": "But this means if you have two entries with same day but different month or year, they will map to the same worksheet. You know what you are doing, I guess."}, {"owner": {"reputation": 147, "user_id": 5373207, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/e19d3304226cff2fc35c679235c7a2df?s=128&d=identicon&r=PG&f=1", "display_name": "okmred", "link": "https://stackoverflow.com/users/5373207/okmred"}, "edited": false, "score": 0, "creation_date": 1444844023, "post_id": 33130556, "comment_id": 54075418, "body": "new issue...maybe, my dates start on the 2nd row.  (I&#39;m doing this by month, so that part shouldn&#39;t matter)."}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "reply_to_user": {"reputation": 147, "user_id": 5373207, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/e19d3304226cff2fc35c679235c7a2df?s=128&d=identicon&r=PG&f=1", "display_name": "okmred", "link": "https://stackoverflow.com/users/5373207/okmred"}, "edited": false, "score": 0, "creation_date": 1444878695, "post_id": 33130556, "comment_id": 54089351, "body": "@okmred If you have difficulties to modify the code to take into account that it starts at A2, dont hesitate to tell me :)"}, {"owner": {"reputation": 147, "user_id": 5373207, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/e19d3304226cff2fc35c679235c7a2df?s=128&d=identicon&r=PG&f=1", "display_name": "okmred", "link": "https://stackoverflow.com/users/5373207/okmred"}, "edited": false, "score": 0, "creation_date": 1444916458, "post_id": 33130556, "comment_id": 54109549, "body": "All I ended up doing was adding a line to delete the tabs I didn/t want. But I&#39;d be interested in seeing how to change the starting point of the column. Thanks"}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "reply_to_user": {"reputation": 147, "user_id": 5373207, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/e19d3304226cff2fc35c679235c7a2df?s=128&d=identicon&r=PG&f=1", "display_name": "okmred", "link": "https://stackoverflow.com/users/5373207/okmred"}, "edited": false, "score": 0, "creation_date": 1444934038, "post_id": 33130556, "comment_id": 54120797, "body": "You can add an additional test like <code>If Not IsEmpty(Cell) Then ...</code> before creating the Worksheet."}], "tags": [], "owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "is_accepted": false, "score": 0, "last_activity_date": 1444842718, "last_edit_date": 1444842718, "creation_date": 1444839470, "answer_id": 33130556, "question_id": 33129574, "link": "https://stackoverflow.com/questions/33129574/create-new-sheets-based-on-the-date-in-an-existing-sheet-column/33130556#33130556", "title": "Create new sheets based on the date in an existing sheet...column", "body": "<pre><code>Function getSheetByName(sh As String) As Worksheet\n    On Error Resume Next\n    Set getSheetByName = Worksheets(sh)\n    If Err.Number &lt;&gt; 0 Then Set getSheetByName = Nothing\nEnd Function\n\nSub CreateSheetsByUniqueDate()\n   Dim cell As Range, name As String\n   Application.DisplayAlerts = False\n\n   For Each cell In Worksheets(\"MasterSheet\").UsedRange.Columns(3).Cells ' &lt;~~ set to your date column\n       name = \"WS_\" &amp; Format(cell.Text, \"dd\")\n       If getSheetByName(name) Is Nothing Then Worksheets.Add().name = name\n   Next\n   Application.DisplayAlerts = True\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 147, "user_id": 5373207, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/e19d3304226cff2fc35c679235c7a2df?s=128&d=identicon&r=PG&f=1", "display_name": "okmred", "link": "https://stackoverflow.com/users/5373207/okmred"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1334, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1444842718, "creation_date": 1444836692, "question_id": 33129574, "link": "https://stackoverflow.com/questions/33129574/create-new-sheets-based-on-the-date-in-an-existing-sheet-column", "title": "Create new sheets based on the date in an existing sheet...column", "body": "<p>So I have a Master sheet with a date column.\nThe data in the master sheet has duplicate dates. Meaning for what ever month we are taling about I can have 07/01/2010 as many as 100 times, or as few as 2 times.</p>\n\n<p>What I want to do is sift through the date column and create new sheets based on the date (day) in that column, but I only want unique values. </p>\n\n<p>So I have multiple examples of creating a new sheet in VBA, that's not my issue. It's generating the unique list to get the sheets created is where I am having a problem.</p>\n\n<pre><code>Sub Add_Sheets()\nDim WS As Worksheet\nSet WS = sheets.Add(After:=Worksheets(\"MasterSheet\"))\nWS.Name = 1  '&lt;-- Want to call something so as to get the day from Master dynamically'\nEnd Sub\n</code></pre>\n\n<p>This gets me my unique dates, but not days list:</p>\n\n<pre><code>Sub UniqueList()\nDim lastrow As Long\nDim sheets As Worksheet\nSet sheets = ThisWorkbook.Worksheets(\"MasterSheet\")\nlastrow = sheets.Cells(Rows.Count, 3).End(xlUp).Row\nsheets.Range(\"C2:C\" &amp; lastrow).AdvancedFilter Action:=xlFilterCopy, CopyToRange:=sheets.Range(\"G2\"), Unique:=True 'dont prefer this but it works.\nEnd Sub\n</code></pre>\n\n<p>So I'm open to suggestion.\nRecently started this project, so not to far into it to redo all of it. Needs to be VBA, so users can just click buttons.</p>\n\n<p>Thanks for any pointers.</p>\n"}, {"tags": ["vba", "ms-access-2010", "sybase"], "comments": [{"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 1, "creation_date": 1444837778, "post_id": 33129522, "comment_id": 54071713, "body": "This might help: <a href=\"http://stackoverflow.com/questions/24267080/calling-stored-procedure-vba\" title=\"calling stored procedure vba\">stackoverflow.com/questions/24267080/&hellip;</a>"}, {"owner": {"reputation": 97598, "user_id": 2144390, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/6QjmY.jpg?s=128&g=1", "display_name": "Gord Thompson", "link": "https://stackoverflow.com/users/2144390/gord-thompson"}, "edited": false, "score": 0, "creation_date": 1444839452, "post_id": 33129522, "comment_id": 54072813, "body": "Are you familiar with &quot;pass-through queries&quot; in Access?"}, {"owner": {"reputation": 1791, "user_id": 109426, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/eef363e3a0fbeacdc89fbfac05a8f8ef?s=128&d=identicon&r=PG", "display_name": "Bryan", "link": "https://stackoverflow.com/users/109426/bryan"}, "edited": false, "score": 0, "creation_date": 1444839683, "post_id": 33129522, "comment_id": 54072969, "body": "I have no clue what a pass-through query is."}, {"owner": {"reputation": 97598, "user_id": 2144390, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/6QjmY.jpg?s=128&g=1", "display_name": "Gord Thompson", "link": "https://stackoverflow.com/users/2144390/gord-thompson"}, "edited": false, "score": 0, "creation_date": 1444840927, "post_id": 33129522, "comment_id": 54073650, "body": "<a href=\"https://support.office.com/en-us/article/Process-SQL-on-a-database-server-by-using-a-pass-through-query-b775ac23-8a6b-49b2-82e2-6dac62532a42\" rel=\"nofollow noreferrer\">support.office.com/en-us/article/&hellip;</a>"}, {"owner": {"reputation": 97598, "user_id": 2144390, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/6QjmY.jpg?s=128&g=1", "display_name": "Gord Thompson", "link": "https://stackoverflow.com/users/2144390/gord-thompson"}, "edited": false, "score": 1, "creation_date": 1444841131, "post_id": 33129522, "comment_id": 54073769, "body": "<a href=\"https://www.youtube.com/watch?v=TjmadpWeA_M\" rel=\"nofollow noreferrer\">youtube.com/watch?v=TjmadpWeA_M</a>"}], "answers": [{"tags": [], "owner": {"reputation": 1791, "user_id": 109426, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/eef363e3a0fbeacdc89fbfac05a8f8ef?s=128&d=identicon&r=PG", "display_name": "Bryan", "link": "https://stackoverflow.com/users/109426/bryan"}, "is_accepted": true, "score": 0, "last_activity_date": 1444873160, "creation_date": 1444873160, "answer_id": 33138409, "question_id": 33129522, "link": "https://stackoverflow.com/questions/33129522/how-to-execute-sybase-function-stored-procedure-from-ms-access-vba/33138409#33138409", "title": "How to execute Sybase function/stored procedure from MS-Access vba?", "body": "<p>So the last problem I was having is that for whatever reason, I could declare an output parameter if there were no inputs but if there are inputs I had to remove the output parameter declaration. The Function output is in the parameters.item(0) position. Thanks to A.S.H and Gord Thompson for the links and suggestions. Here is the code I ended up with that is working now:</p>\n\n<pre><code>Dim trash As String\nDim conn As ADODB.Connection\nDim cmd1 As ADODB.Command\nDim rs1 As Recordset\n\nSet conn = New ADODB.Connection\nconn.ConnectionString = \"datasource=ODBC;DSN=fna\"\nconn.Open\n\nSet cmd1 = New ADODB.Command\ncmd1.ActiveConnection = conn\ncmd1.CommandType = adCmdStoredProc\ncmd1.CommandText = \"CalcStats\"\ncmd1.Parameters.Refresh\ncmd1.Parameters.Append cmd1.CreateParameter(\"InputValue1\", adInteger, adParamInput, , 3)\n'cmd1.Parameters.Append cmd1.CreateParameter(\"OutputValue3\", adInteger, adParamReturnValue)\n\ncmd1.Execute\n\ntrash = cmd1.Parameters.Item(0).Value\nconn.Close\n</code></pre>\n"}], "owner": {"reputation": 1791, "user_id": 109426, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/eef363e3a0fbeacdc89fbfac05a8f8ef?s=128&d=identicon&r=PG", "display_name": "Bryan", "link": "https://stackoverflow.com/users/109426/bryan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1053, "favorite_count": 0, "accepted_answer_id": 33138409, "answer_count": 1, "score": 0, "last_activity_date": 1444873160, "creation_date": 1444836558, "last_edit_date": 1444862363, "question_id": 33129522, "link": "https://stackoverflow.com/questions/33129522/how-to-execute-sybase-function-stored-procedure-from-ms-access-vba", "title": "How to execute Sybase function/stored procedure from MS-Access vba?", "body": "<p>I have a Access front end that has an ODBC connection titled fna to the Sybase back end on a server. I can easily reference the tables in the Sybase database but in the vba I need to be able to call stored procedures and functions that are in Sybase.</p>\n\n<p>Function name is CalcStats.</p>\n\n<p>Edit:\nAfter reading through some of the links in the comment, I have gotten to the following code which seems to run but I can't figure out how to find the return value the function is providing.</p>\n\n<pre><code>Dim trash As String\nDim conn As ADODB.Connection\nDim cmd1 As ADODB.Command\nDim rs1 As Recordset\nSet conn = New ADODB.Connection\nconn.ConnectionString = \"datasource=ODBC;DSN=fna\"\nconn.Open\n\nSet cmd1 = New ADODB.Command\ncmd1.ActiveConnection = conn\ncmd1.CommandType = adCmdStoredProc\ncmd1.CommandText = \"CalcStats\"\n\ncmd1.Execute\n</code></pre>\n\n<p>Edit 2:\nFinally figured out the output part. Thank you A.S.H for the links and Gord Thompson for the method for getting the connection string that for the ADODB that is needed.</p>\n\n<p>So I can now create a connection, trigger the function and get the return value. However, now I'm working on the last part which is adding input parameters. I've added an input parameter to the function in sybase and saved it but I can't seem to pass an input value into the function on the Access side. </p>\n\n<pre><code>Dim trash As String\nDim conn As ADODB.Connection\nDim cmd1 As ADODB.Command\n\nSet conn = New ADODB.Connection\nconn.ConnectionString = \"datasource=ODBC;DSN=fna\"\nconn.Open\n\nSet cmd1 = New ADODB.Command\ncmd1.ActiveConnection = conn\ncmd1.CommandType = adCmdStoredProc\ncmd1.CommandText = \"CalcStats\"\ncmd1.Parameters.Append cmd1.CreateParameter(\"MeasurementClm\", adInteger, adParamInput, , 3)\ncmd1.Parameters.Append cmd1.CreateParameter(\"OutputValue1\", adInteger, adParamReturnValue)\n\ncmd1.Execute\n\ntrash = cmd1.Parameters.Item(0).Value\nconn.Close\n</code></pre>\n"}, {"tags": ["vba", "outlook"], "comments": [{"owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 0, "creation_date": 1444837802, "post_id": 33129297, "comment_id": 54071728, "body": "Since <code>System.Reflexion</code> is from .NET framework, I&#39;m pretty sure you will have trouble to use it in VBA (which is based on pre- .NET architecture, in this case VB6)."}], "answers": [{"comments": [{"owner": {"reputation": 41430, "user_id": 607407, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5a061a72feb5b6580dadd5dcbc92d3b5?s=128&d=identicon&r=PG", "display_name": "Tom&#225;\u0161 Zato - Reinstate Monica", "link": "https://stackoverflow.com/users/607407/tom%c3%a1%c5%a1-zato-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1444844047, "post_id": 33131558, "comment_id": 54075430, "body": "Wow, thanks a lot for that link, I&#39;ll sure make use of it! +1 For you, although I can hardly accept this as answer on the original question."}, {"owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "reply_to_user": {"reputation": 41430, "user_id": 607407, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5a061a72feb5b6580dadd5dcbc92d3b5?s=128&d=identicon&r=PG", "display_name": "Tom&#225;\u0161 Zato - Reinstate Monica", "link": "https://stackoverflow.com/users/607407/tom%c3%a1%c5%a1-zato-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1444847180, "post_id": 33131558, "comment_id": 54077297, "body": "You can&#39;t really do reflection in VBA - TypeName function is pretty much all you get."}], "tags": [], "owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "is_accepted": false, "score": 1, "last_activity_date": 1444842574, "creation_date": 1444842574, "answer_id": 33131558, "question_id": 33129297, "link": "https://stackoverflow.com/questions/33129297/i-cant-get-system-reflection-to-work-in-outlook-vba/33131558#33131558", "title": "I can&#39;t get System.Reflection to work in Outlook VBA", "body": "<p>What are your trying to investigate? You can either look at the type library, or you can look at the live objects in all their glory with <a href=\"http://www.dimastr.com/outspy/\" rel=\"nofollow\">OutlookSpy</a> - it will show you all the live properties, log events, and let you call methods. </p>\n"}], "owner": {"reputation": 41430, "user_id": 607407, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5a061a72feb5b6580dadd5dcbc92d3b5?s=128&d=identicon&r=PG", "display_name": "Tom&#225;\u0161 Zato - Reinstate Monica", "link": "https://stackoverflow.com/users/607407/tom%c3%a1%c5%a1-zato-reinstate-monica"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1073, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1593042069, "creation_date": 1444835954, "last_edit_date": 1593042069, "question_id": 33129297, "link": "https://stackoverflow.com/questions/33129297/i-cant-get-system-reflection-to-work-in-outlook-vba", "title": "I can&#39;t get System.Reflection to work in Outlook VBA", "body": "<p>Since Microsoft documentation on VBA API sucks, I'm trying to investigate objects with reflection. But that sucks too. I created following code that's supposed to write list of property names in console:</p>\n\n<pre><code>Dim p As System.Reflection.PropertyInfo\nFor Each p In Item.GetType().GetProperties()\n   If p.CanRead Then\n       Debug.Print p.Name\n   End If\nNext\n</code></pre>\n\n<p>It doesn't print anything, instead I get this error:</p>\n\n<p><img src=\"https://i.stack.imgur.com/o1lFE.png\" alt=\"image description\"></p>\n\n<p>For this line:</p>\n\n<pre><code>Dim p As System.Reflection.PropertyInfo\n</code></pre>\n\n<p>When I use object explorer I see there's no such property loaded. So do I have to add a library? How?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 3650, "user_id": 5090027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/904db949ae64fe1a63ea8b4c677e6d57?s=128&d=identicon&r=PG&f=1", "display_name": "Grade &#39;Eh&#39; Bacon", "link": "https://stackoverflow.com/users/5090027/grade-eh-bacon"}, "edited": false, "score": 0, "creation_date": 1444836197, "post_id": 33129292, "comment_id": 54070601, "body": "&quot;I have the macro that adds...&quot; We don&#39;t know what macro you&#39;re talking about. Show the macro you&#39;re using. Have you tried changing anything so the names aren&#39;t always the same? What have you tried, and how did that fail?"}, {"owner": {"reputation": 15, "user_id": 5445761, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f7945ecda92f8512d9a06c28a21839f7?s=128&d=identicon&r=PG&f=1", "display_name": "Saranya Suresh", "link": "https://stackoverflow.com/users/5445761/saranya-suresh"}, "reply_to_user": {"reputation": 3650, "user_id": 5090027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/904db949ae64fe1a63ea8b4c677e6d57?s=128&d=identicon&r=PG&f=1", "display_name": "Grade &#39;Eh&#39; Bacon", "link": "https://stackoverflow.com/users/5090027/grade-eh-bacon"}, "edited": false, "score": 0, "creation_date": 1444836441, "post_id": 33129292, "comment_id": 54070774, "body": "Hi Thx for replying, this is the code - Sheets.Add.Name = &quot;Account&quot;. When I run the macro for the first time, it is adding a sheet and renaming it as Account. BUt when i re-run the macro, it throws an error as there is an existing sheet named Account. What i want is, when i run the macro every time keep naming it Account1, account2 and so on.. hope i am clear. thanks."}], "answers": [{"tags": [], "owner": {"reputation": 3650, "user_id": 5090027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/904db949ae64fe1a63ea8b4c677e6d57?s=128&d=identicon&r=PG&f=1", "display_name": "Grade &#39;Eh&#39; Bacon", "link": "https://stackoverflow.com/users/5090027/grade-eh-bacon"}, "is_accepted": false, "score": 1, "last_activity_date": 1444836801, "creation_date": 1444836801, "answer_id": 33129620, "question_id": 33129292, "link": "https://stackoverflow.com/questions/33129292/creating-new-sheets-and-renaming-them-in-a-loop/33129620#33129620", "title": "Creating new sheets and renaming them in a loop", "body": "<p>Without seeing the rest of your code, see below, which assumes you want to create 10 new tabs, starting with Account1, and ending with Account10. It works by using the counter variable to count down from 10, and each time it creates the new tab, it simply appends the counter's value to \"Account\" for the sheetname.</p>\n\n<pre><code>Sub Sheet_Creation()\n\n    Dim counter As Integer\n\n    For counter = 10 To 1 Step -1\n        Sheets.Add.Name = \"Account\" &amp; counter\n    Next counter\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 15, "user_id": 5445761, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f7945ecda92f8512d9a06c28a21839f7?s=128&d=identicon&r=PG&f=1", "display_name": "Saranya Suresh", "link": "https://stackoverflow.com/users/5445761/saranya-suresh"}, "edited": false, "score": 0, "creation_date": 1444838274, "post_id": 33129625, "comment_id": 54072044, "body": "one more question to go with this one, pls could you answer that too? Sheets(&quot;Control&quot;).Select  Range(&quot;F14&quot;).Select     Selection.copy        Sheets(&quot;Account&quot;).Select     Range(&quot;A2&quot;).Select     Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _         :=False, Transpose:=False         Application.CutCopyMode = False -------------------------- As you can see I am copying a cell from a Sheet called Control and pasting into the newly created sheet called Account. If a re-run the macro again, a new sheet Account1 would be created, so any way to change it dynamically? thx"}, {"owner": {"reputation": 15, "user_id": 5445761, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f7945ecda92f8512d9a06c28a21839f7?s=128&d=identicon&r=PG&f=1", "display_name": "Saranya Suresh", "link": "https://stackoverflow.com/users/5445761/saranya-suresh"}, "edited": false, "score": 0, "creation_date": 1444838958, "post_id": 33129625, "comment_id": 54072506, "body": "The first time I run the macro - it would create sheet named Account and the above code would work. Second time I run the macro sheet Account1 would be created. Now what I want is, the above code to work for Account1? i.e Selection.copy Sheets(&quot;Account&quot;) should change dynamically according to the new sheet that was created. if newly created sheet is Account5, then that code should select the sheet Account5, hope i am clear.. thanks"}, {"owner": {"reputation": 12614, "user_id": 3566998, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S7lz6.png?s=128&g=1", "display_name": "Excel Hero", "link": "https://stackoverflow.com/users/3566998/excel-hero"}, "reply_to_user": {"reputation": 15, "user_id": 5445761, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f7945ecda92f8512d9a06c28a21839f7?s=128&d=identicon&r=PG&f=1", "display_name": "Saranya Suresh", "link": "https://stackoverflow.com/users/5445761/saranya-suresh"}, "edited": false, "score": 0, "creation_date": 1444839401, "post_id": 33129625, "comment_id": 54072778, "body": "@SaranyaSuresh Please see the update at the bottom of my answer."}], "tags": [], "owner": {"reputation": 12614, "user_id": 3566998, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S7lz6.png?s=128&g=1", "display_name": "Excel Hero", "link": "https://stackoverflow.com/users/3566998/excel-hero"}, "is_accepted": true, "score": 0, "last_activity_date": 1444839364, "last_edit_date": 1444839364, "creation_date": 1444836818, "answer_id": 33129625, "question_id": 33129292, "link": "https://stackoverflow.com/questions/33129292/creating-new-sheets-and-renaming-them-in-a-loop/33129625#33129625", "title": "Creating new sheets and renaming them in a loop", "body": "<p>This procedure will add a new worksheet and name it properly:</p>\n\n<pre><code>Sub AddWS()\n    Const WS_NAME = \"Account\"\n    Dim c\n    On Error Resume Next\n    With Sheets.Add(, ActiveSheet)\n        Do\n            .Name = WS_NAME &amp; c\n            If Err = 1004 Then\n                c = c + 1\n                Err.Clear\n            Else\n                Exit Do\n            End If\n            DoEvents\n        Loop\n    End With\nEnd Sub\n</code></pre>\n\n<p>Note: you can manage the base name applied to the newly created worksheet by editing the first line.</p>\n\n<p><strong>UPDATE</strong></p>\n\n<p>Based on your new requirement to be able to access the newest worksheet created at a later point by using the base name ('Account' in your question), please use this version of the above procedure:</p>\n\n<pre><code>Sub AddWS()\n    Const WS_NAME = \"Account\"\n    Dim c\n    On Error Resume Next\n    With Sheets.Add(, ActiveSheet)\n        Do\n            .Name = WS_NAME &amp; c\n            If Err = 1004 Then\n                c = c + 1\n                Err.Clear\n            Else\n                Exit Do\n            End If\n            DoEvents\n        Loop\n        ThisWorkbook.Names.Add \"Newest_\" &amp; WS_NAME, .Name\n    End With\nEnd Sub\n</code></pre>\n\n<p>Now, later on when you wish to select that sheet, you can use this code:</p>\n\n<pre><code>Sheets([Newest_Account]).Select\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 12614, "user_id": 3566998, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S7lz6.png?s=128&g=1", "display_name": "Excel Hero", "link": "https://stackoverflow.com/users/3566998/excel-hero"}, "edited": false, "score": 0, "creation_date": 1444837888, "post_id": 33129851, "comment_id": 54071786, "body": "This is not want OP wanted. You are appending the total number of worksheets to the name. OP wanted numbers only if a worksheet already exists with the name used."}], "tags": [], "owner": {"reputation": 1, "user_id": 5445661, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aeaa0751a70ccbdfdf1b843c556beeba?s=128&d=identicon&r=PG&f=1", "display_name": "Vind2", "link": "https://stackoverflow.com/users/5445661/vind2"}, "is_accepted": false, "score": -1, "last_activity_date": 1444837419, "creation_date": 1444837419, "answer_id": 33129851, "question_id": 33129292, "link": "https://stackoverflow.com/questions/33129292/creating-new-sheets-and-renaming-them-in-a-loop/33129851#33129851", "title": "Creating new sheets and renaming them in a loop", "body": "<pre><code>Private Sub CreateSheet()\n    Dim ws As Worksheet\n    With ActiveWorkbook\n        Set ws = .Sheets.Add(After:=.Sheets(.Sheets.Count))\n        ws.Name = \"Account\" &amp; Worksheets.Count\n    End With\nEnd Sub\n</code></pre>\n\n<p>The above macro will create new sheets named Account#, with # = the total number of sheets.</p>\n"}], "owner": {"reputation": 15, "user_id": 5445761, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f7945ecda92f8512d9a06c28a21839f7?s=128&d=identicon&r=PG&f=1", "display_name": "Saranya Suresh", "link": "https://stackoverflow.com/users/5445761/saranya-suresh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1756, "favorite_count": 0, "accepted_answer_id": 33129625, "answer_count": 3, "score": -1, "last_activity_date": 1444925272, "creation_date": 1444835942, "last_edit_date": 1444925272, "question_id": 33129292, "link": "https://stackoverflow.com/questions/33129292/creating-new-sheets-and-renaming-them-in-a-loop", "title": "Creating new sheets and renaming them in a loop", "body": "<p>I am using Excel 2013. I have the macro that adds a new sheet and renames it. But when I run the macro for the second time, it throws an error because there is a sheet with the name that was just created. For example, I create a sheet and name it Account, the next time when I run the macro I want it to be Account1 and next time Account2 and so on.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1444836453, "post_id": 33129063, "comment_id": 54070779, "body": "What exactly is the question/problem?  Please update your OP to include a question or problem."}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1444836871, "post_id": 33129063, "comment_id": 54071077, "body": "Why not simply rename this from <code>Workbook_Open</code> to <code>Workbook_BeforeClose</code>? You can also envisage to make it a macro or a button action so that the user chooses when to do these copies.."}, {"owner": {"reputation": 1, "user_id": 5445679, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153590902697254/picture?type=large", "display_name": "Luis Gonzalez Frau", "link": "https://stackoverflow.com/users/5445679/luis-gonzalez-frau"}, "edited": false, "score": 0, "creation_date": 1444840213, "post_id": 33129063, "comment_id": 54073262, "body": "Thank you. The problem that I encounter is that the data entered manually on Sheet1, and Sheet2 is being deleted once the document is closed. How could the automated data be transferred below a specific cell with a certain value, say &quot;zz&quot; on sheet1, and sheet2? , and how could only the automated transferred data be clear from those sheets once the document is closed?"}], "owner": {"reputation": 1, "user_id": 5445679, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153590902697254/picture?type=large", "display_name": "Luis Gonzalez Frau", "link": "https://stackoverflow.com/users/5445679/luis-gonzalez-frau"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 71, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1444836532, "creation_date": 1444835305, "last_edit_date": 1444836532, "question_id": 33129063, "link": "https://stackoverflow.com/questions/33129063/how-to-transfer-data-from-one-sheet-to-another-below-a-specified-cell-via-vba", "title": "How to transfer data from one sheet to another below a specified cell via vba?", "body": "<p>I am transferring data automatically from sheet3(\"quotes\") to sheet1(\"customers\"), and sheet2(\"prospects\") based on conditional formatting, and would like to also manually enter  data on sheet1(\"customers\"), and sheet2(\"prospects) without deleting these entries when closing the document, and having the transferred data from sheet3(quotes) below the last value manually entered on either sheet1(\"customers\"), and sheet2(\"prospects\") based on the condition. </p>\n\n<p>Here is the coding that I have so far:</p>\n\n<pre><code>Private Sub Workbook_Open()\nDim i, LastRow\nLastRow = Sheets(\"QUOTES\").Range(\"A\" &amp; Rows.Count).End(xlUp).Row\nFor i = 2 To LastRow\nIf Sheets(\"QUOTES\").Cells(i, \"d\").Value = \"C\" Then\nSheets(\"QUOTES\").Cells(i, \"d\").EntireRow.Copy Destination:=Sheets(\"CUSTOMERS\").Range(\"a\" &amp; Rows.Count).End(xlUp).Offset(1)\nEnd If\nNext i\nSheets(\"PROSPECTS\").Range(\"a2:i500\").ClearContents\nFor i = 2 To LastRow\nIf Sheets(\"QUOTES\").Cells(i, \"d\").Value = \"P\" Then\nSheets(\"QUOTES\").Cells(i, \"d\").EntireRow.Copy Destination:=Sheets(\"PROSPECTS\").Range(\"a\" &amp; Rows.Count).End(xlUp).Offset(1)\nEnd If\nNext i\nFor i = 2 To LastRow\nIf Sheets(\"PROSPECTS\").Cells(i, \"n\").Value = \"1\" Then\nSheets(\"PROSPECTS\").Cells(i, \"n\").EntireRow.Copy Destination:=Sheets(\"CUSTOMERS\").Range(\"a\" &amp; Rows.Count).End(xlUp).Offset(1)\nEnd If\nNext i\nEnd Sub\n</code></pre>\n\n<p>Any hint will be greatly appreciated.</p>\n\n<p>Luis</p>\n"}, {"tags": ["vba", "excel", "vbscript", "filesystemobject"], "answers": [{"comments": [{"owner": {"reputation": 4010, "user_id": 2570957, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/4FrAD.jpg?s=128&g=1", "display_name": "Soulfire", "link": "https://stackoverflow.com/users/2570957/soulfire"}, "reply_to_user": {"reputation": 3, "user_id": 5345682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d2cd04bcc68537274150aacb9030d8?s=128&d=identicon&r=PG&f=1", "display_name": "RobH", "link": "https://stackoverflow.com/users/5345682/robh"}, "edited": false, "score": 2, "creation_date": 1444835644, "post_id": 33128965, "comment_id": 54070244, "body": "No problem!  If this answered your question would you mind clicking the green check mark to accept this as an answer?  It adds to my point total which helps build my reputability around here.  I&#39;d appreciate it!"}, {"owner": {"reputation": 3, "user_id": 5345682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d2cd04bcc68537274150aacb9030d8?s=128&d=identicon&r=PG&f=1", "display_name": "RobH", "link": "https://stackoverflow.com/users/5345682/robh"}, "edited": false, "score": 0, "creation_date": 1444836504, "post_id": 33128965, "comment_id": 54070816, "body": "done. I have another question about moving that file... should i post it anew or add to this one?"}], "tags": [], "owner": {"reputation": 4010, "user_id": 2570957, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/4FrAD.jpg?s=128&g=1", "display_name": "Soulfire", "link": "https://stackoverflow.com/users/2570957/soulfire"}, "is_accepted": true, "score": 2, "last_activity_date": 1444835054, "creation_date": 1444835054, "answer_id": 33128965, "question_id": 33128887, "link": "https://stackoverflow.com/questions/33128887/make-directory-in-vbscript-relative-to-workbook-running-the-macro/33128965#33128965", "title": "Make directory in VBscript relative to workbook running the macro", "body": "<p>You can use</p>\n\n<pre><code>ThisWorkbook.Path\n</code></pre>\n\n<p>To return the path of the current workbook.</p>\n\n<p>Something like this:</p>\n\n<pre><code>Dim oFSO As Object\n\nSet oFSO = CreateObject(\"Scripting.FileSystemObject\")\n\noFSO.CreateFolder ThisWorkbook.Path &amp; \"\\MyFolder\"\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 5345682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d2cd04bcc68537274150aacb9030d8?s=128&d=identicon&r=PG&f=1", "display_name": "RobH", "link": "https://stackoverflow.com/users/5345682/robh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 68, "favorite_count": 0, "accepted_answer_id": 33128965, "answer_count": 1, "score": 0, "last_activity_date": 1444837357, "creation_date": 1444834842, "last_edit_date": 1444837357, "question_id": 33128887, "link": "https://stackoverflow.com/questions/33128887/make-directory-in-vbscript-relative-to-workbook-running-the-macro", "title": "Make directory in VBscript relative to workbook running the macro", "body": "<p>I'm using the following to create a folder:</p>\n\n<pre><code>Dim oFSO\nSet oFSO = CreateObject(\"Scripting.FileSystemObject\")\n' Create a new folder\noFSO.CreateFolder \"C:\\MyFolder\"\n</code></pre>\n\n<p>But I'd like the folder location to be in the same place as the excel workbook running the code. </p>\n"}, {"tags": ["sql", "ms-access", "vba"], "comments": [{"owner": {"reputation": 147, "user_id": 768241, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/7b71e04eac3132597c10b36a80dd35fb?s=128&d=identicon&r=PG", "display_name": "GhostDZ9", "link": "https://stackoverflow.com/users/768241/ghostdz9"}, "edited": false, "score": 0, "creation_date": 1444833614, "post_id": 33128363, "comment_id": 54068789, "body": "The PaymentStatus is either approved or rejected."}], "answers": [{"tags": [], "owner": {"reputation": 1106495, "user_id": 1144035, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e514b017977ebf742a418cac697d8996?s=128&d=identicon&r=PG", "display_name": "Gordon Linoff", "link": "https://stackoverflow.com/users/1144035/gordon-linoff"}, "is_accepted": true, "score": 1, "last_activity_date": 1444833612, "creation_date": 1444833612, "answer_id": 33128418, "question_id": 33128363, "link": "https://stackoverflow.com/questions/33128363/sum-case-sql-syntax-error/33128418#33128418", "title": "Sum Case SQL Syntax error", "body": "<p>MS Access doesn't support <code>case</code>.  Use <code>iif()</code> instead:</p>\n\n<pre><code>SELECT CompanyCode, PaymentStatus, PaymentType, PaySource,    \n       SUM(CCur(PaymentAmount)),\n       SUM(IIF(PaymentStatus = 'APPROVED', 1, 0)) AS Approved,  COUNT(*) \nFROM Detail_Work \nGROUP BY CompanyCode,PaymentType, PaymentStatus, PaySource \nORDER BY CompanyCode, PaymentType, PaymentStatus, PaySource;\n</code></pre>\n\n<p>However, I'm not sure why you have <code>PaymentStatus</code> in the <code>GROUP BY</code>.  Perhaps you intend:</p>\n\n<pre><code>SELECT CompanyCode, PaymentType, PaySource,    \n       SUM(CCur(PaymentAmount)),\n       SUM(IIF(PaymentStatus = 'APPROVED', 1, 0)) AS Approved,  COUNT(*) \nFROM Detail_Work \nGROUP BY CompanyCode,PaymentType, PaySource \nORDER BY CompanyCode, PaymentType, PaySource;\n</code></pre>\n"}], "owner": {"reputation": 147, "user_id": 768241, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/7b71e04eac3132597c10b36a80dd35fb?s=128&d=identicon&r=PG", "display_name": "GhostDZ9", "link": "https://stackoverflow.com/users/768241/ghostdz9"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 974, "favorite_count": 0, "accepted_answer_id": 33128418, "answer_count": 1, "score": 0, "last_activity_date": 1594655885, "creation_date": 1444833478, "last_edit_date": 1594655885, "question_id": 33128363, "link": "https://stackoverflow.com/questions/33128363/sum-case-sql-syntax-error", "title": "Sum Case SQL Syntax error", "body": "<p>I have the following SQL query:</p>\n\n<pre><code>SELECT \n    CompanyCode, PaymentStatus, PaymentType, PaySource,\n    SUM(CCur(PaymentAmount)), \n    SUM(CASE WHEN PaymentStatus='APPROVED' THEN 1 ELSE 0 END) AS Approved,  \n    COUNT(*) \nFROM \n    Detail_Work \nGROUP BY \n    CompanyCode, PaymentType, PaymentStatus, PaySource \nORDER BY \n    CompanyCode, PaymentType, PaymentStatus, PaySource\n</code></pre>\n\n<p>And I get the following error:</p>\n\n<blockquote>\n  <p>Syntax Error (Missing Operator) in query Expression 'SUM(CASE WHEN\n  PaymentStatus='APPROVED' THEN 1 ELSE 0 END)'</p>\n</blockquote>\n"}, {"tags": ["vba", "excel", "replace"], "answers": [{"comments": [{"owner": {"reputation": 85, "user_id": 5239257, "user_type": "registered", "accept_rate": 40, "profile_image": "https://graph.facebook.com/1164805706870215/picture?type=large", "display_name": "Dmitry Vasilyev", "link": "https://stackoverflow.com/users/5239257/dmitry-vasilyev"}, "edited": false, "score": 0, "creation_date": 1444834276, "post_id": 33128529, "comment_id": 54069273, "body": "unfortunately, but no. the format of the date is workable (dd/mm/yyyy), when I apply standard Find &amp; Replace in Excel directly, not via VB......... Edit to your edit: I tried removing this line - same."}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1444834912, "post_id": 33128529, "comment_id": 54069725, "body": "It&#39;s not the number format. VBA defaults to the US regional interpretation whenever possible. You have to loop."}, {"owner": {"reputation": 85, "user_id": 5239257, "user_type": "registered", "accept_rate": 40, "profile_image": "https://graph.facebook.com/1164805706870215/picture?type=large", "display_name": "Dmitry Vasilyev", "link": "https://stackoverflow.com/users/5239257/dmitry-vasilyev"}, "edited": false, "score": 0, "creation_date": 1444836604, "post_id": 33128529, "comment_id": 54070878, "body": "If I loop through 200 columns it takes ages. The code I&#39;m showing here is part of a one huge code where automation takes place. Bringing loop into such basic task would be extremely inefficient. Is there any other workarounds...? I&#39;m sure there is :("}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 85, "user_id": 5239257, "user_type": "registered", "accept_rate": 40, "profile_image": "https://graph.facebook.com/1164805706870215/picture?type=large", "display_name": "Dmitry Vasilyev", "link": "https://stackoverflow.com/users/5239257/dmitry-vasilyev"}, "edited": false, "score": 0, "creation_date": 1444836958, "post_id": 33128529, "comment_id": 54071137, "body": "@DmitryVasilyev - I updated my post with another option, using Text to Columns.  It&#39;s worked for me in the past, hopefully it can help here too."}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1444838722, "post_id": 33128529, "comment_id": 54072353, "body": "If you load your data into an array, process it and then write it back to the sheet, I&#39;d be surprised if it takes very long."}, {"owner": {"reputation": 85, "user_id": 5239257, "user_type": "registered", "accept_rate": 40, "profile_image": "https://graph.facebook.com/1164805706870215/picture?type=large", "display_name": "Dmitry Vasilyev", "link": "https://stackoverflow.com/users/5239257/dmitry-vasilyev"}, "edited": false, "score": 0, "creation_date": 1444838843, "post_id": 33128529, "comment_id": 54072437, "body": "@BruceWayne I also tried your advise with text to columns - it works on manual basis. I included it into the loop, but it doesn&#39;t work, and produces TRUE argument for the next columns whilst changing date of the first cell (T1) in our case. could u advise please?    For Each c In r c.Value = c.TextToColumns(Destination:=Selection, DataType:=xlDelimited, TextQualifier:=xlDoubleQuote, ConsecutiveDelimiter:=False, Tab:=True, Semicolon:=False, Comma:=False, Space:=False, Other:=False, TrailingMinusNumbers:=True) Next c"}, {"owner": {"reputation": 85, "user_id": 5239257, "user_type": "registered", "accept_rate": 40, "profile_image": "https://graph.facebook.com/1164805706870215/picture?type=large", "display_name": "Dmitry Vasilyev", "link": "https://stackoverflow.com/users/5239257/dmitry-vasilyev"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1444839035, "post_id": 33128529, "comment_id": 54072549, "body": "@Rory, could u be so kind as to help with the code...?"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1444839285, "post_id": 33128529, "comment_id": 54072710, "body": "If using <code>TextToColumns</code>, you just call it as a method - you don&#39;t assign the result to the cell. It parses the cell for you"}], "tags": [], "owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "is_accepted": false, "score": 1, "last_activity_date": 1444836937, "last_edit_date": 1444836937, "creation_date": 1444833900, "answer_id": 33128529, "question_id": 33128278, "link": "https://stackoverflow.com/questions/33128278/find-replace-vba-changes-format-of-date/33128529#33128529", "title": "find &amp; replace vba changes format of date", "body": "<p>It's due to the <code>.NumberFormat</code>.  Try changing that to <code>.NumberFormat = \"mm/dd/yyyy\"</code></p>\n\n<p>Edit: Also, maybe just comment out/remove that line, if it's totally unnecessary.</p>\n\n<p>Edit2: The above isn't the issue.  What if, after you have run the macro and have the dates in <code>dd/mm/yyyy</code> format, you do Text to Columns? Highlight the dates, go to Data--> Text to Columns,  choose \"Delimited\" and leave as \"Tab\", but in the next screen (step 3 of 3), choose \"Column data format\" as \"Date: MDY\", and click \"Finish\". </p>\n"}, {"comments": [{"owner": {"reputation": 85, "user_id": 5239257, "user_type": "registered", "accept_rate": 40, "profile_image": "https://graph.facebook.com/1164805706870215/picture?type=large", "display_name": "Dmitry Vasilyev", "link": "https://stackoverflow.com/users/5239257/dmitry-vasilyev"}, "edited": false, "score": 0, "creation_date": 1444844996, "post_id": 33130231, "comment_id": 54075960, "body": "many thanks, kind sir. your code did it&#39;s job, however, I amended the yr = Right(cell, 4) line, since there were only 2 figure-value (2015 as 15). Containing 4 figures the code generated out of year 2000, 2001, etc."}], "tags": [], "owner": {"reputation": 614, "user_id": 2859017, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/c3d02d329d1397065bf3de40261f8a36?s=128&d=identicon&r=PG&f=1", "display_name": "Fabrizio", "link": "https://stackoverflow.com/users/2859017/fabrizio"}, "is_accepted": true, "score": 0, "last_activity_date": 1444838585, "creation_date": 1444838585, "answer_id": 33130231, "question_id": 33128278, "link": "https://stackoverflow.com/questions/33128278/find-replace-vba-changes-format-of-date/33130231#33130231", "title": "find &amp; replace vba changes format of date", "body": "<p>Date() I'm Italian and always quarrel with the date..\nIf the date that you want convert is alway like <code>P.01.10.2015</code> to 1th Oct\ntry the code below, otherwise change the start/end of <code>right(x,x)</code>,<code>mid(x,x,x)</code></p>\n\n<pre><code>Sub find_replace()\nDim cell As Range\nDim yr As String, mnt As String, dy As String\nDim d As Date\nFor Each cell In ActiveSheet.Range(\"T1\", Range(\"T1\").End(xlToRight).Offset(0, -2))\nyr = Right(cell, 4)\nmnt = Mid(cell, 6, 2)\ndy = Mid(cell, 3, 2)\nd = DateSerial(yr, mnt, dy)\nRange(cell.Address) = d\nNext cell\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 85, "user_id": 5239257, "user_type": "registered", "accept_rate": 40, "profile_image": "https://graph.facebook.com/1164805706870215/picture?type=large", "display_name": "Dmitry Vasilyev", "link": "https://stackoverflow.com/users/5239257/dmitry-vasilyev"}, "edited": false, "score": 0, "creation_date": 1444845720, "post_id": 33130618, "comment_id": 54076410, "body": "thanks a bunch, Rory. your code works brilliantly as well as Fabrizio&#39;s. I slightly amended it, added rData.NumberFormat = &quot;dd/mm/yyyy&quot; as it provided date in format of days after 1900 year."}], "tags": [], "owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "is_accepted": false, "score": 0, "last_activity_date": 1444839612, "creation_date": 1444839612, "answer_id": 33130618, "question_id": 33128278, "link": "https://stackoverflow.com/questions/33128278/find-replace-vba-changes-format-of-date/33130618#33130618", "title": "find &amp; replace vba changes format of date", "body": "<p>Here's a loop sample per my comment earlier:</p>\n\n<pre><code>Sub ParseDates()\n    Dim vData\n    Dim rData                       As Range\n    Dim x                           As Long\n    Dim y                           As Long\n    Dim stemp                       As String\n    Set rData = ActiveSheet.Range(\"T1\", Range(\"T1\").End(xlToRight).Offset(0, -2))\n    vData = rData.Value2\n    For x = LBound(vData, 1) To UBound(vData, 1)\n        For y = LBound(vData, 2) To UBound(vData, 2)\n            stemp = Replace$(Replace$(vData(x, y), \"P.\", \"\"), \".\", \"/\")\n            If IsDate(stemp) Then vData(x, y) = CDate(stemp)\n        Next y\n    Next x\n    rData.Value2 = vData\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 85, "user_id": 5239257, "user_type": "registered", "accept_rate": 40, "profile_image": "https://graph.facebook.com/1164805706870215/picture?type=large", "display_name": "Dmitry Vasilyev", "link": "https://stackoverflow.com/users/5239257/dmitry-vasilyev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3879, "favorite_count": 0, "accepted_answer_id": 33130231, "answer_count": 3, "score": 2, "last_activity_date": 1444839612, "creation_date": 1444833253, "question_id": 33128278, "link": "https://stackoverflow.com/questions/33128278/find-replace-vba-changes-format-of-date", "title": "find &amp; replace vba changes format of date", "body": "<p>I have a range of cells with dates, that contain values that have to be replaced. Once I do that using general Find &amp; Replace - it works smoothly. When I do it in VBA, the formatting of the cells is changed and dates are converted to a wrong ones, e.g. 12/10/2015 (12 October), but become 10/12/2015 (10 December). Here's the code: </p>\n\n<pre><code>Sub find_replace()\nActiveSheet.Range(\"T1\", Range(\"T1\").End(xlToRight).Offset(0, -2)).Select\nWith Selection\n.NumberFormat = \"dd/mm/yyyy\"\n.Replace What:=\"P.\", Replacement:=\"\", LookAt:=xlPart,     SearchOrder:=xlByColumns, MatchCase:=False, SearchFormat:=False,   ReplaceFormat:=False\n.Replace What:=\".\", Replacement:=\"/\", LookAt:=xlPart,    SearchOrder:=xlByColumns, MatchCase:=False, SearchFormat:=False,    ReplaceFormat:=False\nEnd With\nEnd Sub\n</code></pre>\n\n<p>Please be so kind as to advise how to get rid of this annoying issue. Thanks.</p>\n"}, {"tags": ["excel", "ms-word", "vba"], "answers": [{"comments": [{"owner": {"reputation": 1287, "user_id": 5383872, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/d36e0367b8929161b2afb4430a6e545f?s=128&d=identicon&r=PG&f=1", "display_name": "Stefan0309", "link": "https://stackoverflow.com/users/5383872/stefan0309"}, "edited": false, "score": 0, "creation_date": 1444833987, "post_id": 33128467, "comment_id": 54069059, "body": "no, I&#39;m affraid not. It is red code, and whem I try to run it, it gives me an error &quot;Syntax error&quot;. I&#39;ve tried to write the code in one line, removing Findtext:= and &quot;_&quot;, as well as End:=, but still I cant m ake it to work."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "reply_to_user": {"reputation": 1287, "user_id": 5383872, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/d36e0367b8929161b2afb4430a6e545f?s=128&d=identicon&r=PG&f=1", "display_name": "Stefan0309", "link": "https://stackoverflow.com/users/5383872/stefan0309"}, "edited": false, "score": 0, "creation_date": 1444834094, "post_id": 33128467, "comment_id": 54069140, "body": "try again. I misspelled paragraphs in the <code>ActiveDocument.Paragraphs.Count</code> syntax. I fixed it."}, {"owner": {"reputation": 1287, "user_id": 5383872, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/d36e0367b8929161b2afb4430a6e545f?s=128&d=identicon&r=PG&f=1", "display_name": "Stefan0309", "link": "https://stackoverflow.com/users/5383872/stefan0309"}, "edited": false, "score": 0, "creation_date": 1444834243, "post_id": 33128467, "comment_id": 54069244, "body": "Still the same, red code and &quot;syntax error&quot;. Maybe we need parenthesis before FIndText ?"}, {"owner": {"reputation": 1287, "user_id": 5383872, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/d36e0367b8929161b2afb4430a6e545f?s=128&d=identicon&r=PG&f=1", "display_name": "Stefan0309", "link": "https://stackoverflow.com/users/5383872/stefan0309"}, "edited": false, "score": 0, "creation_date": 1444834594, "post_id": 33128467, "comment_id": 54069500, "body": "No problem.  Now, it&#39;s error 438 - Object doesn&#39;t support this property or method. :)"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "reply_to_user": {"reputation": 1287, "user_id": 5383872, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/d36e0367b8929161b2afb4430a6e545f?s=128&d=identicon&r=PG&f=1", "display_name": "Stefan0309", "link": "https://stackoverflow.com/users/5383872/stefan0309"}, "edited": false, "score": 0, "creation_date": 1444834968, "post_id": 33128467, "comment_id": 54069768, "body": "Okay. I think I got it now. I misunderstood the <code>.Find</code> method, but just tested my edited code and it worked for me."}], "tags": [], "owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "is_accepted": true, "score": 0, "last_activity_date": 1444834933, "last_edit_date": 1444834933, "creation_date": 1444833739, "answer_id": 33128467, "question_id": 33127926, "link": "https://stackoverflow.com/questions/33127926/find-text-in-word-and-select-content-from-range/33128467#33128467", "title": "Find text in Word, and select content from range", "body": "<p>Does this work for you?</p>\n\n<pre><code>Set myRange = ActiveDocument.Range\nmyRange.Find.Execute \"OPQ32\"\n\nSet myRange = ActiveDocument.Range( _\n    Start:=myRange.Start, _\n    End:=ActiveDocument.Paragraphs(ActiveDocument.Paragraphs.Count).Range.End)\n</code></pre>\n"}], "owner": {"reputation": 1287, "user_id": 5383872, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/d36e0367b8929161b2afb4430a6e545f?s=128&d=identicon&r=PG&f=1", "display_name": "Stefan0309", "link": "https://stackoverflow.com/users/5383872/stefan0309"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1137, "favorite_count": 0, "accepted_answer_id": 33128467, "answer_count": 1, "score": -1, "last_activity_date": 1444837500, "creation_date": 1444832448, "last_edit_date": 1531161705, "question_id": 33127926, "link": "https://stackoverflow.com/questions/33127926/find-text-in-word-and-select-content-from-range", "title": "Find text in Word, and select content from range", "body": "<p>I want to find some word, or sentence within a Word document. Then I want to select whole document below that row which contains word/sentence (including that row). After that, to copy content and to paste it into an excel sheet.</p>\n\n<p>I am stuck with selection of ranges.</p>\n\n<p>Edit: There is only one unique sentence.</p>\n\n<p>Please review my code:</p>\n\n<pre><code>Sub importDocfile()\n    Dim rng0 As Word.Range\n    Dim WordApp As Object, WordDoc As Object\n    Dim myRange As Word.Range\n    Dim strTheText As String\n    Set WordApp = CreateObject(\"Word.Application\")\n    'word ll be close to run\n    WordApp.Visible = True\n    'open the file .doc\n    Set WordDoc = WordApp.Documents.Open(ThisWorkbook.Path &amp; \"\\Personality    analysis and profile.docx\")\n    Set myRange = WordApp.ActiveDocument.Content\n    myRange.Find.Execute FindText:=\"OPQ32\" ' Here I dont know how to declare my start range\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "pdf", "pdf-generation"], "comments": [{"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 2, "creation_date": 1444832567, "post_id": 33127693, "comment_id": 54067974, "body": "Did you check the Page Setup of your Worksheet? It is possible that you have set large margins, a not-appropriate page size, etc. You can also control the print area of the sheet, by selecting View --&gt; Page Layout"}, {"owner": {"reputation": 235, "user_id": 4865342, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wGbby.jpg?s=128&g=1", "display_name": "Charvi", "link": "https://stackoverflow.com/users/4865342/charvi"}, "reply_to_user": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1444832987, "post_id": 33127693, "comment_id": 54068290, "body": "My Page size is A4 and page layout --&gt; Orientation is set to <code>Landscape</code> Thanks for the advise. Now I&#39;ll also check with other page setup, such as scale, will check whether I can convert excel manually to PDF and will come back to you"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1444833327, "post_id": 33127693, "comment_id": 54068543, "body": "Yes, sometimes its just about trial and error until you get it exactly as you need it ... :)"}, {"owner": {"reputation": 235, "user_id": 4865342, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wGbby.jpg?s=128&g=1", "display_name": "Charvi", "link": "https://stackoverflow.com/users/4865342/charvi"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1444833838, "post_id": 33127693, "comment_id": 54068949, "body": "Ya @ScottHoltzman. I tried with decreasing scale till 10% and I was able to publish almost 55 columns in a single page of pdf. Still, I have to publish few more columns in the same page :) And excel automatically changes scale to 10% if I try to lower scale than it :)"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 1, "creation_date": 1444834008, "post_id": 33127693, "comment_id": 54069078, "body": "can you publish it on two pages (at 10% isn&#39;t really unreadable anyway?) if you keep some columns on the left to print for each sheet to identify the row of data on the 2nd sheet?"}, {"owner": {"reputation": 3650, "user_id": 5090027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/904db949ae64fe1a63ea8b4c677e6d57?s=128&d=identicon&r=PG&f=1", "display_name": "Grade &#39;Eh&#39; Bacon", "link": "https://stackoverflow.com/users/5090027/grade-eh-bacon"}, "edited": false, "score": 1, "creation_date": 1444834372, "post_id": 33127693, "comment_id": 54069340, "body": "There is a printing option to force your data to be 1 page wide and/or 1 page high. When you click this [under page layout -&gt; scale to fit], it shows you how much it shrinks your data to fit it on 1 page. If you record a macro of you doing this, it will provide you the VBA code to set that option."}, {"owner": {"reputation": 235, "user_id": 4865342, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wGbby.jpg?s=128&g=1", "display_name": "Charvi", "link": "https://stackoverflow.com/users/4865342/charvi"}, "edited": false, "score": 0, "creation_date": 1444834798, "post_id": 33127693, "comment_id": 54069649, "body": "Ya. Many places were unreadable. To <code>keep some columns on the left to print for each sheet to identify the row of data on the 2nd sheet</code> is a good idea. Only thing is that, I have to adjust such columns manually. If I do not get any other solution, am surely going for it. :)"}], "answers": [{"comments": [{"owner": {"reputation": 1431, "user_id": 4473648, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/5ac0b1e66e69b31e1bede0090a17e28f?s=128&d=identicon&r=PG&f=1", "display_name": "Avidan", "link": "https://stackoverflow.com/users/4473648/avidan"}, "edited": false, "score": 0, "creation_date": 1447745708, "post_id": 33743295, "comment_id": 55270514, "body": "Thank you @neuralgroove for the answer. :) Tried with Trial and error by adding the above code. Tried with creating using <b>two with blocks</b> and also <b>adding the above code in previous with block</b> (combining both the blocks in single with block). Also set margins to &#39;narrow&#39;.   I get same results as prior. Can you tell me, How I can incorporate it with earlier code ?"}], "tags": [], "owner": {"reputation": 740, "user_id": 5424722, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f9517dd60fb9332437cb9ad8aa1cac5f?s=128&d=identicon&r=PG", "display_name": "neuralgroove", "link": "https://stackoverflow.com/users/5424722/neuralgroove"}, "is_accepted": false, "score": 2, "last_activity_date": 1447702878, "creation_date": 1447702878, "answer_id": 33743295, "question_id": 33127693, "link": "https://stackoverflow.com/questions/33127693/all-columns-of-excelsheet-are-not-fitted-in-same-page-of-pdf-while-converting-u/33743295#33743295", "title": "All columns of excelsheet are not fitted in same page of pdf; while converting using Excel VBA", "body": "<p>add this to your code, it will force everything to print on one sheet wide, but still let it print over multiple sheets tall</p>\n\n<pre><code>With Worksheets(\"Sheet1\").PageSetup\n    .FitToPagesWide = 1\n    .FitToPagesTall = False\nEnd With\n</code></pre>\n\n<p>also set your margins to \"Narrow\"</p>\n"}, {"comments": [{"owner": {"reputation": 1431, "user_id": 4473648, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/5ac0b1e66e69b31e1bede0090a17e28f?s=128&d=identicon&r=PG&f=1", "display_name": "Avidan", "link": "https://stackoverflow.com/users/4473648/avidan"}, "edited": false, "score": 0, "creation_date": 1447767853, "post_id": 33757074, "comment_id": 55284426, "body": "Thank you for this answer and explanation. Though still am able to export upto only 50-60 columns (after selecting A3 page size), it helped me to learn how to record a macro to adjust page setup. +1 for it. Few of the columns exported are unreadable; is it possible to widen the width of page? So that, I would be able to read those correctly? (considering - am not going to print generated PDF on paper and I need it only to view as a soft copy)"}, {"owner": {"reputation": 6237, "user_id": 4892468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b9tfr.png?s=128&g=1", "display_name": "EEM", "link": "https://stackoverflow.com/users/4892468/eem"}, "reply_to_user": {"reputation": 1431, "user_id": 4473648, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/5ac0b1e66e69b31e1bede0090a17e28f?s=128&d=identicon&r=PG&f=1", "display_name": "Avidan", "link": "https://stackoverflow.com/users/4473648/avidan"}, "edited": false, "score": 0, "creation_date": 1447771750, "post_id": 33757074, "comment_id": 55287246, "body": "If printing it on A3 paper with minimum zoom (i.e. 10%) still cannot fit everything in one page, then what you intent is not doable. Your original question is about having the worksheet printed in one page, and that what this answer is about. Now you are showing concern about readability, then you need to play with the <code>.FitToPagesWide</code> and <code>.FitToPagesTall</code> and decide what&#39;s the best compression that allows readability."}, {"owner": {"reputation": 6237, "user_id": 4892468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b9tfr.png?s=128&g=1", "display_name": "EEM", "link": "https://stackoverflow.com/users/4892468/eem"}, "reply_to_user": {"reputation": 1431, "user_id": 4473648, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/5ac0b1e66e69b31e1bede0090a17e28f?s=128&d=identicon&r=PG&f=1", "display_name": "Avidan", "link": "https://stackoverflow.com/users/4473648/avidan"}, "edited": false, "score": 0, "creation_date": 1447798995, "post_id": 33757074, "comment_id": 55304182, "body": "@Avidan apologies did not realized the original question is not actually yours. As I said earlier the minimum zoom possible is 10%, try with the adjust page setting and let us know. Questions, 1) how wide is your print area no only in columns number but also addition of the width of all columns; 2) how many rows has the print area and 3) what font size is used. Need this to try to replicate your case. However it will better if you can share your file..."}, {"owner": {"reputation": 1431, "user_id": 4473648, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/5ac0b1e66e69b31e1bede0090a17e28f?s=128&d=identicon&r=PG&f=1", "display_name": "Avidan", "link": "https://stackoverflow.com/users/4473648/avidan"}, "edited": false, "score": 0, "creation_date": 1447841096, "post_id": 33757074, "comment_id": 55320536, "body": "Thank you @EEM for the guidance. I&#39;ll check with properties, <code>.FitToPagesWide</code> and <code>.FitToPagesTall</code> - whether I&#39;ll be able to fit our data into a wider page.  At this point, even I do believe in your sentence: <code>what I intent is not doable.</code>,  but still am curious, whether it&#39;s possible by widening the size(width) of page. (I don&#39;t have to print it physically; only in a softcopy - PDF)"}, {"owner": {"reputation": 1431, "user_id": 4473648, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/5ac0b1e66e69b31e1bede0090a17e28f?s=128&d=identicon&r=PG&f=1", "display_name": "Avidan", "link": "https://stackoverflow.com/users/4473648/avidan"}, "edited": false, "score": 0, "creation_date": 1447841116, "post_id": 33757074, "comment_id": 55320553, "body": "I gone through this post: <a href=\"http://stackoverflow.com/questions/5116828/how-to-find-total-width-of-columns-selected-in-excel\" title=\"how to find total width of columns selected in excel\">stackoverflow.com/questions/5116828/&hellip;</a> and 1) <code>Width of all columns together is 2750 pixels.</code> (total no. of columns - 100). 2) <code>There are around 1500 rows</code>. 3) Arial and Calibri, Font size 11; and am sorry, I won&#39;t be able to share the file as It has some sensitive data.  ...and you don&#39;t have to be apologised. :) I found this question similar to my requirement, so thought of offering bounty instead of asking a new question.  Regards,"}, {"owner": {"reputation": 6237, "user_id": 4892468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b9tfr.png?s=128&g=1", "display_name": "EEM", "link": "https://stackoverflow.com/users/4892468/eem"}, "reply_to_user": {"reputation": 1431, "user_id": 4473648, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/5ac0b1e66e69b31e1bede0090a17e28f?s=128&d=identicon&r=PG&f=1", "display_name": "Avidan", "link": "https://stackoverflow.com/users/4473648/avidan"}, "edited": false, "score": 0, "creation_date": 1447845338, "post_id": 33757074, "comment_id": 55323610, "body": "I checked further and there a much bigger paper size called <code>E Size</code> which is 86.36 cm x 111.76 cm as per the measurements your page should be portrait instead of landscape. I&#39;m updating the procedure to show this alternatives. try and let me know."}, {"owner": {"reputation": 1431, "user_id": 4473648, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/5ac0b1e66e69b31e1bede0090a17e28f?s=128&d=identicon&r=PG&f=1", "display_name": "Avidan", "link": "https://stackoverflow.com/users/4473648/avidan"}, "reply_to_user": {"reputation": 6237, "user_id": 4892468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b9tfr.png?s=128&g=1", "display_name": "EEM", "link": "https://stackoverflow.com/users/4892468/eem"}, "edited": false, "score": 0, "creation_date": 1447845806, "post_id": 33757074, "comment_id": 55323939, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/95440/discussion-between-avidan-and-eem\">continue this discussion in chat</a>."}], "tags": [], "owner": {"reputation": 6237, "user_id": 4892468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b9tfr.png?s=128&g=1", "display_name": "EEM", "link": "https://stackoverflow.com/users/4892468/eem"}, "is_accepted": true, "score": 4, "last_activity_date": 1447846504, "last_edit_date": 1447846504, "creation_date": 1447763641, "answer_id": 33757074, "question_id": 33127693, "link": "https://stackoverflow.com/questions/33127693/all-columns-of-excelsheet-are-not-fitted-in-same-page-of-pdf-while-converting-u/33757074#33757074", "title": "All columns of excelsheet are not fitted in same page of pdf; while converting using Excel VBA", "body": "<p>The problem is with the Page Setup settings, I have done some minor changes to your code and added a procedure to perform the page setup settings, when launching the procedure you can select the paper size, however be aware the minimum zoom allowed is 10% <em>(see <a href=\"https://msdn.microsoft.com/EN-US/library/office/ff841253.aspx\" rel=\"nofollow\">PageSetup Members (Excel)</a>)</em>. Therefore, if even at 10% the Print Area does not fit in one page I suggest to chose a larger paper size (i.e. A3) to generate an one page PDF, then when printing the Pdf select fit to page. The procedure also gives you the change to play with the margins, when generating PDF's I set all margins at 0, but you can changed as it fits your goals.</p>\n\n<pre><code>Sub Wsh_LargePrintArea_To_Pdf()\nDim WshTrg As Worksheet\nDim sFileName As String\n\n    sFileName = Application.GetSaveAsFilename( _\n        InitialFileName:=\"\", _\n        FileFilter:=\"PDF Files (*.pdf), *.pdf\", _\n        Title:=\"Select Path and FileName to save\")\n\n    If sFileName &lt;&gt; \"False\" Then\n\n        Rem Set Worksheet Target\n        Set WshTrg = ActiveWorkbook.Worksheets(\"Sheet1\")\n\n        Rem Procedure Update Worksheet Target Page Setup\n        'To Adjust the Page Setup Zoom select the Paper Size as per your requirements\n        'Call Wsh_Print_Setting_OnePage(WshTrg, xlPaperLetter)\n        'Call Wsh_Print_Setting_OnePage(WshTrg, xlPaperA4)\n        'To Adjust the Page Setup Zoom select the Paper Size as per your requirements\n        'If the Print Still don't fit in one page then use a the largest Paper Size (xlPaperA3)\n        'When printing the Pdf you can still selet to fix to the physical paper size of the printer.\n        'Call Wsh_Print_Setting_OnePage(WshTrg, xlPaperA3)\n        'This is the largest paper i can see in my laptop is 86.36 cm x 111.76 cm\n        Call Wsh_Print_Setting_OnePage(WshTrg, xlPaperEsheet)\n\n        Rem Export Wsh to Pdf\n        WshTrg.ExportAsFixedFormat _\n            Type:=xlTypePDF, _\n            fileName:=sFileName, _\n            Quality:=xlQualityStandard, _\n            IncludeDocProperties:=True, _\n            IgnorePrintAreas:=False, _\n            OpenAfterPublish:=False\n    End If\n\nEnd Sub\n\n\nSub Wsh_Print_Setting_OnePage(WshTrg As Worksheet, ePaperSize As XlPaperSize)\nOn Error Resume Next\n    Application.PrintCommunication = False\n    With ActiveSheet.PageSetup\n        .LeftMargin = Application.InchesToPoints(0)\n        .RightMargin = Application.InchesToPoints(0)\n        .TopMargin = Application.InchesToPoints(0)\n        .BottomMargin = Application.InchesToPoints(0)\n        .HeaderMargin = Application.InchesToPoints(0)\n        .FooterMargin = Application.InchesToPoints(0)\n        '.Orientation = xlLandscape\n        .Orientation = xlPortrait\n        .PaperSize = ePaperSize\n        .Zoom = False\n        .FitToPagesWide = 1\n        .FitToPagesTall = 1\n    End With\n    Application.PrintCommunication = True\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1431, "user_id": 4473648, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/5ac0b1e66e69b31e1bede0090a17e28f?s=128&d=identicon&r=PG&f=1", "display_name": "Avidan", "link": "https://stackoverflow.com/users/4473648/avidan"}, "edited": false, "score": 0, "creation_date": 1447841383, "post_id": 33759753, "comment_id": 55320761, "body": "Buddy, Thanks for the answer. This gives me still the same result though. Am sorry, yesterday someone has downvoted the answer."}, {"owner": {"reputation": 2531, "user_id": 5309373, "user_type": "registered", "accept_rate": 94, "profile_image": "https://lh3.googleusercontent.com/-k6yHporwn6o/AAAAAAAAAAI/AAAAAAAAADQ/1NNWYFs6DwA/photo.jpg?sz=128", "display_name": "Jean-Pierre Oosthuizen", "link": "https://stackoverflow.com/users/5309373/jean-pierre-oosthuizen"}, "reply_to_user": {"reputation": 1431, "user_id": 4473648, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/5ac0b1e66e69b31e1bede0090a17e28f?s=128&d=identicon&r=PG&f=1", "display_name": "Avidan", "link": "https://stackoverflow.com/users/4473648/avidan"}, "edited": false, "score": 0, "creation_date": 1447844826, "post_id": 33759753, "comment_id": 55323251, "body": "@Avidan have a look at the script now, works every time with me"}, {"owner": {"reputation": 1431, "user_id": 4473648, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/5ac0b1e66e69b31e1bede0090a17e28f?s=128&d=identicon&r=PG&f=1", "display_name": "Avidan", "link": "https://stackoverflow.com/users/4473648/avidan"}, "edited": false, "score": 0, "creation_date": 1447845297, "post_id": 33759753, "comment_id": 55323572, "body": "Thank you for the edit :) Still I get same results. <code>I guess, What am trying is may not be doable</code> As, 1) Width of all columns together is 2750 pixels.  2) Total no. of columns - 100.  <code>Is it so?</code> <a href=\"http://stackoverflow.com/questions/33127693/all-columns-of-excelsheet-are-not-fitted-in-same-page-of-pdf-while-converting-u/33757074?noredirect=1#comment55304182_33757074\" title=\"all columns of excelsheet are not fitted in same page of pdf while converting u\">stackoverflow.com/questions/33127693/&hellip;</a>"}, {"owner": {"reputation": 1431, "user_id": 4473648, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/5ac0b1e66e69b31e1bede0090a17e28f?s=128&d=identicon&r=PG&f=1", "display_name": "Avidan", "link": "https://stackoverflow.com/users/4473648/avidan"}, "edited": false, "score": 0, "creation_date": 1447859439, "post_id": 33759753, "comment_id": 55333837, "body": "Thanks for the new edit. I was able to export more columns than the prior. (same as other answer on this question, almost 85 columns. Still 15 columns couldn&#39;t fit in the page) . +1 for it. Also, few of my columns are not readable. Hopefully, using paper size as &#39;E&#39; will solve this problem.  <a href=\"http://stackoverflow.com/questions/33127693/all-columns-of-excelsheet-are-not-fitted-in-same-page-of-pdf-while-converting-u/33757074?noredirect=1#comment55323610_33757074\" title=\"all columns of excelsheet are not fitted in same page of pdf while converting u\">stackoverflow.com/questions/33127693/&hellip;</a>"}, {"owner": {"reputation": 2531, "user_id": 5309373, "user_type": "registered", "accept_rate": 94, "profile_image": "https://lh3.googleusercontent.com/-k6yHporwn6o/AAAAAAAAAAI/AAAAAAAAADQ/1NNWYFs6DwA/photo.jpg?sz=128", "display_name": "Jean-Pierre Oosthuizen", "link": "https://stackoverflow.com/users/5309373/jean-pierre-oosthuizen"}, "reply_to_user": {"reputation": 1431, "user_id": 4473648, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/5ac0b1e66e69b31e1bede0090a17e28f?s=128&d=identicon&r=PG&f=1", "display_name": "Avidan", "link": "https://stackoverflow.com/users/4473648/avidan"}, "edited": false, "score": 1, "creation_date": 1447859897, "post_id": 33759753, "comment_id": 55334197, "body": "Page Size 92x92 is 233cm x 233cm which is bigger than size E. What printer is set as your default  printer? The printer itself could be preventing you if it&#39;s a really printer. In my testing the script worked for a total column  width of more than 2700pxl"}, {"owner": {"reputation": 1431, "user_id": 4473648, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/5ac0b1e66e69b31e1bede0090a17e28f?s=128&d=identicon&r=PG&f=1", "display_name": "Avidan", "link": "https://stackoverflow.com/users/4473648/avidan"}, "edited": false, "score": 0, "creation_date": 1447919778, "post_id": 33759753, "comment_id": 55362219, "body": "Thanks buddy for the information. :) I won&#39;t be printing the exported PDF on paper. I just need it to view as a soft copy. Is it possible to adjust this size of paper in Microsoft excel properties?"}, {"owner": {"reputation": 2531, "user_id": 5309373, "user_type": "registered", "accept_rate": 94, "profile_image": "https://lh3.googleusercontent.com/-k6yHporwn6o/AAAAAAAAAAI/AAAAAAAAADQ/1NNWYFs6DwA/photo.jpg?sz=128", "display_name": "Jean-Pierre Oosthuizen", "link": "https://stackoverflow.com/users/5309373/jean-pierre-oosthuizen"}, "reply_to_user": {"reputation": 1431, "user_id": 4473648, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/5ac0b1e66e69b31e1bede0090a17e28f?s=128&d=identicon&r=PG&f=1", "display_name": "Avidan", "link": "https://stackoverflow.com/users/4473648/avidan"}, "edited": false, "score": 0, "creation_date": 1447920045, "post_id": 33759753, "comment_id": 55362353, "body": "Page layout &gt; Page Setup &gt; Size. What I mean is, the avaiable sizes in PageSize is dependant on what printer is selected. Regardless if you are going to print the page or not. I have PDFCreator set as my default printer to avoid this issue when saving as PDF"}, {"owner": {"reputation": 1431, "user_id": 4473648, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/5ac0b1e66e69b31e1bede0090a17e28f?s=128&d=identicon&r=PG&f=1", "display_name": "Avidan", "link": "https://stackoverflow.com/users/4473648/avidan"}, "reply_to_user": {"reputation": 2531, "user_id": 5309373, "user_type": "registered", "accept_rate": 94, "profile_image": "https://lh3.googleusercontent.com/-k6yHporwn6o/AAAAAAAAAAI/AAAAAAAAADQ/1NNWYFs6DwA/photo.jpg?sz=128", "display_name": "Jean-Pierre Oosthuizen", "link": "https://stackoverflow.com/users/5309373/jean-pierre-oosthuizen"}, "edited": false, "score": 0, "creation_date": 1447921352, "post_id": 33759753, "comment_id": 55363052, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/95529/discussion-between-avidan-and-jean-pierre-oosthuizen\">continue this discussion in chat</a>."}], "tags": [], "owner": {"reputation": 2531, "user_id": 5309373, "user_type": "registered", "accept_rate": 94, "profile_image": "https://lh3.googleusercontent.com/-k6yHporwn6o/AAAAAAAAAAI/AAAAAAAAADQ/1NNWYFs6DwA/photo.jpg?sz=128", "display_name": "Jean-Pierre Oosthuizen", "link": "https://stackoverflow.com/users/5309373/jean-pierre-oosthuizen"}, "is_accepted": false, "score": 2, "last_activity_date": 1447853200, "last_edit_date": 1447853200, "creation_date": 1447771373, "answer_id": 33759753, "question_id": 33127693, "link": "https://stackoverflow.com/questions/33127693/all-columns-of-excelsheet-are-not-fitted-in-same-page-of-pdf-while-converting-u/33759753#33759753", "title": "All columns of excelsheet are not fitted in same page of pdf; while converting using Excel VBA", "body": "<p>The problem is that you need to Select the <code>UsedRange</code> and then use <code>Selection.ExportAsFixedFormat</code></p>\n\n<pre><code>Sub GetSaveAsFilename()\n\nDim fileName As String\n\nfileName = Application.GetSaveAsFilename(InitialFileName:=\"\", _\n                                         FileFilter:=\"PDF Files (*.pdf), *.pdf\", _\n                                         Title:=\"Select Path and FileName to save\")\n\nIf fileName &lt;&gt; \"False\" Then\n\n  'Selecting the Used Range in the Sheet\n  ActiveWorkbook.Worksheets(\"Sheet1\").UsedRange.Select\n\n  'Saving the Selection - Here is where the problem was\n  Selection.ExportAsFixedFormat Type:=xlTypePDF, fileName:=fileName, _\n                                Quality:=xlQualityStandard, IncludeDocProperties:=False, _\n                                IgnorePrintAreas:=False, OpenAfterPublish:=True\nEnd If\n\nEnd Sub\n</code></pre>\n\n<p><strong>EDIT:</strong></p>\n\n<p>The problem was the <code>PageSetup</code>becasue each page size has a maximum pixel limit as you were heading towards in your comment. </p>\n\n<p>The Page Size is set to Oversize A0 which should more than cater for your 100x1500 <code>UsedRange</code>. Here you change the page size with the <code>FitToPages...   = 1</code> to check that your <code>Range</code> is within the print lines.</p>\n\n<p>The <code>FitToPagesWide</code> and <code>FitToPagesTall</code> is to fit everything onto one page.</p>\n\n<pre><code>Sub GetSaveAsFilename()\n\nDim fileName As String\n\nfileName = Application.GetSaveAsFilename(InitialFileName:=\"\", _\n                                         FileFilter:=\"PDF Files (*.pdf), *.pdf\", _\n                                         Title:=\"Select Path and FileName to save\")\n\nIf fileName &lt;&gt; \"False\" Then\n\n  'Suspending Communicaiton with Printer to Edit PageSetup via Scripting\n  Application.PrintCommunication = False\n\n  'Setting Page Setup\n   With ActiveSheet.PageSetup\n    .FitToPagesWide = 1\n    .FitToPagesTall = 1\n    ' Setting Page Size to 92x92 inch Should cater for your data\n    .PaperSize = 159\n   End With\n\n  'Enabling Communicaiton with Printer\n  Application.PrintCommunication = True\n\n\n  'Selecting the Used Range in the Sheet\n  ActiveWorkbook.Worksheets(\"Sheet1\").UsedRange.Select\n\n  'Saving the Selection - Here is where the problem was\n  Selection.ExportAsFixedFormat Type:=xlTypePDF, fileName:=fileName, _\n                                Quality:=xlQualityStandard, IncludeDocProperties:=True, _\n                                IgnorePrintAreas:=True, OpenAfterPublish:=True\nEnd If\n\nEnd Sub\n</code></pre>\n\n<p><strong>Note that the Page will appear Blank, you will need to Zoom in alot to view the data</strong></p>\n"}, {"comments": [{"owner": {"reputation": 1431, "user_id": 4473648, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/5ac0b1e66e69b31e1bede0090a17e28f?s=128&d=identicon&r=PG&f=1", "display_name": "Avidan", "link": "https://stackoverflow.com/users/4473648/avidan"}, "edited": false, "score": 0, "creation_date": 1448258701, "post_id": 33831197, "comment_id": 55493289, "body": "Thank u buddy for the answer. +1, am able to export bit less columns than 79 as for me pixel size is more now."}], "tags": [], "owner": {"reputation": 429, "user_id": 4980571, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/6dd665a9d36a1da523cc706f05a27e4a?s=128&d=identicon&r=PG&f=1", "display_name": "Estevam Garcia", "link": "https://stackoverflow.com/users/4980571/estevam-garcia"}, "is_accepted": false, "score": 4, "last_activity_date": 1448037482, "last_edit_date": 1448037482, "creation_date": 1448035917, "answer_id": 33831197, "question_id": 33127693, "link": "https://stackoverflow.com/questions/33127693/all-columns-of-excelsheet-are-not-fitted-in-same-page-of-pdf-while-converting-u/33831197#33831197", "title": "All columns of excelsheet are not fitted in same page of pdf; while converting using Excel VBA", "body": "<p>First select the range you want to print and set it as PrintArea. And then run this code, this work for me with an 79 columns sheet</p>\n\n<pre><code>Sub saveAsPDF()\n\n    Dim MyPath\n    Dim MyFolder\n\n\n    With Sheet1.PageSetup\n        '.CenterHorizontally = True\n        .CenterVertically = True\n        .Orientation = xlLandscape\n        .Zoom = False\n        .FitToPagesWide = 1\n        .FitToPagesTall = 1\n        .BottomMargin = 0\n        .TopMargin = 0\n        .RightMargin = 0\n        .LeftMargin = 0\n    End With\n\n    MyPath = ThisWorkbook.Path\n    MyFolder = Application.GetSaveAsFilename(MyPath, \"PDF Files (*.pdf),*.pdf\")\n\n    If MyFolder = False Then Exit Sub\n     Sheet1.ExportAsFixedFormat Type:=xlTypePDF, _\n                                    Filename:=MyFolder, _\n                                    Quality:=xlQualityStandard, _\n                                    IncludeDocProperties:=True, _\n                                    IgnorePrintAreas:=False, _\n                                    OpenAfterPublish:=False\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 235, "user_id": 4865342, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wGbby.jpg?s=128&g=1", "display_name": "Charvi", "link": "https://stackoverflow.com/users/4865342/charvi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 21086, "favorite_count": 3, "accepted_answer_id": 33757074, "answer_count": 4, "score": 9, "last_activity_date": 1448282312, "creation_date": 1444831880, "question_id": 33127693, "link": "https://stackoverflow.com/questions/33127693/all-columns-of-excelsheet-are-not-fitted-in-same-page-of-pdf-while-converting-u", "title": "All columns of excelsheet are not fitted in same page of pdf; while converting using Excel VBA", "body": "<p>Am trying to convert microsoft excel file with large number of columns (70+) into pdf using a Excel VBA code.</p>\n\n<p>In active workbook, am trying to save 'Sheet1' to PDF format at required path. I have the following code.</p>\n\n<pre><code>Sub GetSaveAsFilename()\n\nDim fileName As String\n\nfileName = Application.GetSaveAsFilename(InitialFileName:=\"\", _\n                                         FileFilter:=\"PDF Files (*.pdf), *.pdf\", _\n                                         Title:=\"Select Path and FileName to save\")\n\n    If fileName &lt;&gt; \"False\" Then\n\n        With ActiveWorkbook\n\n           .Worksheets(\"Sheet1\").ExportAsFixedFormat Type:=xlTypePDF, fileName:= _\n           fileName, Quality:=xlQualityStandard, _\n           IncludeDocProperties:=True, IgnorePrintAreas:=False, OpenAfterPublish:=False\n\n        End With\n\n    End If\nEnd Sub\n</code></pre>\n\n<p>When am running the VBA code and saving the pdf file, I see that; the whole excelsheet is not fitted in same page. It's displaying some content in next page.</p>\n\n<p>(Only few columns appear in first page, remaining appear on next page and so on..).</p>\n\n<p>I checked with <a href=\"http://answers.microsoft.com/en-us/office/forum/office_2007-excel/excel-2007-how-to-publish-wide-worksheet-in-pdf/93d95d10-fe25-4028-ae77-8d2f2756e7a6?auth=1\">How to publish a wide worksheet in PDF format?</a>.</p>\n\n<p>But, setting page layout to landscape and converting excel file manually to PDF; also displays some columns in next pages.</p>\n\n<p>There are many <strong>Free Excel to PDF Converter</strong>s available online, which give me same results.</p>\n\n<p>Is there any function available in VBA, through which I can fit all the columns in a single page of PDF?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 7422, "user_id": 1586390, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f07270207034d2bcbe347b028edc8f02?s=128&d=identicon&r=PG", "display_name": "Sorceri", "link": "https://stackoverflow.com/users/1586390/sorceri"}, "edited": false, "score": 0, "creation_date": 1444831942, "post_id": 33127637, "comment_id": 54067488, "body": "so once you verify the err.Number why not Err.Clear so you can catch the next one?"}, {"owner": {"reputation": 72931, "user_id": 2538939, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/876f7ddaf27a16c17a62b8a9705b45f1?s=128&d=identicon&r=PG&f=1", "display_name": "Code Different", "link": "https://stackoverflow.com/users/2538939/code-different"}, "edited": false, "score": 0, "creation_date": 1444832022, "post_id": 33127637, "comment_id": 54067541, "body": "It&#39;s usually not a good idea to have your error-handling block to potentially fail and have to catch an error the second time. However, you can use <code>On Error Resume Next</code> to have the following statement check that the previous one has succeeded."}], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 4857472, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/43b1398f787188e4692e7b1ab4b3bfa4?s=128&d=identicon&r=PG&f=1", "display_name": "sandi srkoc", "link": "https://stackoverflow.com/users/4857472/sandi-srkoc"}, "edited": false, "score": 0, "creation_date": 1444845551, "post_id": 33127945, "comment_id": 54076297, "body": "yes, I could do this also..So, if I understand it correctly you can can use on error go to statement within same procedure only once?"}], "tags": [], "owner": {"reputation": 3651, "user_id": 2504785, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/I70ES.png?s=128&g=1", "display_name": "SQL Police", "link": "https://stackoverflow.com/users/2504785/sql-police"}, "is_accepted": false, "score": 0, "last_activity_date": 1444832503, "creation_date": 1444832503, "answer_id": 33127945, "question_id": 33127637, "link": "https://stackoverflow.com/questions/33127637/excel-vba-error-handling/33127945#33127945", "title": "excel vba error handling", "body": "<p>How about putting the code in step 2 into a separate procedure? There, you can do separate error handling with a new <code>on error goto</code> statement.</p>\n"}], "owner": {"reputation": 25, "user_id": 4857472, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/43b1398f787188e4692e7b1ab4b3bfa4?s=128&d=identicon&r=PG&f=1", "display_name": "sandi srkoc", "link": "https://stackoverflow.com/users/4857472/sandi-srkoc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 622, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1444844769, "creation_date": 1444831708, "last_edit_date": 1444844769, "question_id": 33127637, "link": "https://stackoverflow.com/questions/33127637/excel-vba-error-handling", "title": "excel vba error handling", "body": "<p>I'm having trouble with an error handling in VBA excel.\nBasicaly, I have a situation where I'm dealing with multiple errors within same error handling block.</p>\n\n<p>To make things really simple let's just say:</p>\n\n<pre><code>Sub some_function ()\n    On Error go to step1\n    step2:\n        some code which triggers an error\n        Exit Sub\n    step1:\n        Okay, so far so good. \n        Problem is, that in this block of code can also occur an error\n        with the same Err.Number but I have to deal with him on other way\n        which is not specified in this block of code. \n        go to step 2\nEnd sub\n</code></pre>\n\n<p>I'm using SAP session to connect to SAPgui and I cannot predict which error will occur. If I can catch an error within error handling block of code I can solve this situation.</p>\n\n<p>So basicaly I'm blind foilded. If an error occurs I try to do some other things and if it works OK, but if an error occurs second time (within error handling block) it will throw me an error.</p>\n\n<p>Is there any walkaround?</p>\n\n<p><strong>UPDATE:</strong></p>\n\n<p>just thinking out loud.</p>\n\n<p>If I use On Error Resume next statement and do as following:</p>\n\n<pre><code>On Error Resume next\nsome code,\nline of code that could trigger an error\nif Err.Number &lt;&gt; 0 Then\n   try to handle an error\n   Err.Clear\nEnd if\nline of code that could also trigger an error\nIf Err.Number &lt;&gt; 0 Then\n  Try to handle an error\n  Err.Clear\nEnd If\n</code></pre>\n\n<p>Would that be OK? or is there any better solution?    </p>\n\n<p>Is it possible to use Resume next statement within the procedure in only a certain block of code? Let's just say we have a procedure with 20 lines, and I would like to use Resume Next statement between 10th and 15th line.. Is it possible to enable and disable Resume next statement, or on Error line? </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1444831144, "post_id": 33127279, "comment_id": 54066917, "body": "<code>I&#39;m hoping for some VBA code</code> - what you tried yourself? Show us the code you are trying and where it may not be working, then we can help you solve it. SO is not a code writing website."}, {"owner": {"reputation": 73, "user_id": 5402651, "user_type": "registered", "accept_rate": 88, "profile_image": "https://lh6.googleusercontent.com/-8Vw56v6JeXQ/AAAAAAAAAAI/AAAAAAAAAHM/I9kIRajD5Uo/photo.jpg?sz=128", "display_name": "Brandon Patrick", "link": "https://stackoverflow.com/users/5402651/brandon-patrick"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1444832450, "post_id": 33127279, "comment_id": 54067856, "body": "This is the code I have currently based on searches on this website but I&#39;m still pretty new to VBA and don&#39;t quite know how to translate that formula above to fit in here:  Edit:too long to paste here, see above"}], "answers": [{"comments": [{"owner": {"reputation": 73, "user_id": 5402651, "user_type": "registered", "accept_rate": 88, "profile_image": "https://lh6.googleusercontent.com/-8Vw56v6JeXQ/AAAAAAAAAAI/AAAAAAAAAHM/I9kIRajD5Uo/photo.jpg?sz=128", "display_name": "Brandon Patrick", "link": "https://stackoverflow.com/users/5402651/brandon-patrick"}, "edited": false, "score": 0, "creation_date": 1444912062, "post_id": 33136654, "comment_id": 54106311, "body": "Beautiful, thanks Paul. I always get mixed up trying to define ranges."}], "tags": [], "owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "is_accepted": true, "score": 0, "last_activity_date": 1444861431, "creation_date": 1444861431, "answer_id": 33136654, "question_id": 33127279, "link": "https://stackoverflow.com/questions/33127279/filling-in-specific-empty-cells/33136654#33136654", "title": "Filling in Specific Empty Cells", "body": "<p>This will update column B (ActiveSheet.UsedRange) if at least one cell in columns C:I has a number</p>\n\n<pre><code>Option Explicit\n\nPublic Sub setPlaceholderInColB()\n    With ActiveSheet\n        .Range(\"B2\").Formula = \"=IF(COUNT(C2:I2)&gt;0,0,\"\"\"\")\"\n        .Range(\"B2\").AutoFill Destination:=Range(\"B2:B\" &amp; .UsedRange.Rows.Count)\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 73, "user_id": 5402651, "user_type": "registered", "accept_rate": 88, "profile_image": "https://lh6.googleusercontent.com/-8Vw56v6JeXQ/AAAAAAAAAAI/AAAAAAAAAHM/I9kIRajD5Uo/photo.jpg?sz=128", "display_name": "Brandon Patrick", "link": "https://stackoverflow.com/users/5402651/brandon-patrick"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 74, "favorite_count": 0, "accepted_answer_id": 33136654, "answer_count": 1, "score": -1, "last_activity_date": 1444861431, "creation_date": 1444830850, "last_edit_date": 1444855870, "question_id": 33127279, "link": "https://stackoverflow.com/questions/33127279/filling-in-specific-empty-cells", "title": "Filling in Specific Empty Cells", "body": "<p>I'm looking to fill in cells that are missing data in Column B with a placeholder (ie. 0) so they don't get deleted by my other macro. I'm hoping for some VBA code that will emulate the following formula and apply it to all of the rows:</p>\n\n<p>=IF(B2=\"\",IF(COUNT(C2:I2)>0,0,\"\"),\"\")</p>\n\n<p>I want the result of this formula to go into Column B (cell B2 in the example above). The purpose of this formula is to only put the placeholder value in Column B if at least one of the cells in Columns C:I has a number.</p>\n\n<p>Any help/refinements are much appreciated!</p>\n\n<p>Edit: What I've tried to add to the macro</p>\n\n<pre><code>Sub test()\nDim nRows As Integer: nRows = Cells(Rows.Count, 1).End(xlUp).Row\nDim cell As Range, r As Range: Set r = Range(\"A2:A\" &amp; nRows)\nDim r1 As Range: Set r1 = Range(\"B2:B\" &amp; nRows)\nDim r2 As Range: Set r2 = Range(\"I2:I\" &amp; nRows)\n\nFor Each cell In r2\n    If cell.Value &gt; 0 Then\n        For Each cell In r1\n            If cell.Value = \"\" Then cell.Value = 0\nNext cell\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "outlook"], "comments": [{"owner": {"reputation": 158803, "user_id": 246342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8ba0aea3f521082f18dd7c186e7d4c3?s=128&d=identicon&r=PG", "display_name": "Alex K.", "link": "https://stackoverflow.com/users/246342/alex-k"}, "edited": false, "score": 0, "creation_date": 1444830535, "post_id": 33127079, "comment_id": 54066475, "body": "Remove the parentheses?  Office VBA can easily create files without needing to resort to calling .Net over COM"}, {"owner": {"reputation": 41430, "user_id": 607407, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5a061a72feb5b6580dadd5dcbc92d3b5?s=128&d=identicon&r=PG", "display_name": "Tom&#225;\u0161 Zato - Reinstate Monica", "link": "https://stackoverflow.com/users/607407/tom%c3%a1%c5%a1-zato-reinstate-monica"}, "reply_to_user": {"reputation": 158803, "user_id": 246342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8ba0aea3f521082f18dd7c186e7d4c3?s=128&d=identicon&r=PG", "display_name": "Alex K.", "link": "https://stackoverflow.com/users/246342/alex-k"}, "edited": false, "score": 0, "creation_date": 1444830788, "post_id": 33127079, "comment_id": 54066665, "body": "What parentheses? Do I call it as a command line command? And how do I properly separate arguments?"}], "owner": {"reputation": 41430, "user_id": 607407, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5a061a72feb5b6580dadd5dcbc92d3b5?s=128&d=identicon&r=PG", "display_name": "Tom&#225;\u0161 Zato - Reinstate Monica", "link": "https://stackoverflow.com/users/607407/tom%c3%a1%c5%a1-zato-reinstate-monica"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1330, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1593041164, "creation_date": 1444830276, "last_edit_date": 1593041164, "question_id": 33127079, "link": "https://stackoverflow.com/questions/33127079/how-do-i-use-my-computer-filesystem-writealltext-in-vba", "title": "How do I use My.Computer.FileSystem.WriteAllText in VBA?", "body": "<p>I am trying to write data to a file:</p>\n\n<pre><code>Public Sub test()\n    My.Computer.FileSystem.WriteAllText(\"C:\\Users\\username\\Desktop\\outlook.txt\", \"test\", True)\nEnd Sub\n</code></pre>\n\n<p>I get this error popup:</p>\n\n<p><img src=\"https://i.stack.imgur.com/YbV6y.png\" alt=\"image description\"></p>\n\n<p>There's an Add reference window. Do I need to add some library here?</p>\n\n<p><img src=\"https://i.stack.imgur.com/pFkeJ.png\" alt=\"image description\"></p>\n"}, {"tags": ["vba", "catia"], "answers": [{"comments": [{"owner": {"reputation": 376, "user_id": 2564908, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/kWljr.png?s=128&g=1", "display_name": "David Egan", "link": "https://stackoverflow.com/users/2564908/david-egan"}, "edited": false, "score": 0, "creation_date": 1444922837, "post_id": 33151962, "comment_id": 54114440, "body": "Thank you for your help GisMofx, I must try the above out"}, {"owner": {"reputation": 788, "user_id": 997088, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/354c6358174c3e539ca9fe427d25391c?s=128&d=identicon&r=PG", "display_name": "GisMofx", "link": "https://stackoverflow.com/users/997088/gismofx"}, "reply_to_user": {"reputation": 376, "user_id": 2564908, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/kWljr.png?s=128&g=1", "display_name": "David Egan", "link": "https://stackoverflow.com/users/2564908/david-egan"}, "edited": false, "score": 0, "creation_date": 1444923035, "post_id": 33151962, "comment_id": 54114573, "body": "@DavidEgan create a new drawing document and add a few sheets. Just copy and paste the code into a new module in VBA editor. Run UpdateSheetPage() and you&#39;ll see the result on the sheets!"}, {"owner": {"reputation": 376, "user_id": 2564908, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/kWljr.png?s=128&g=1", "display_name": "David Egan", "link": "https://stackoverflow.com/users/2564908/david-egan"}, "edited": false, "score": 0, "creation_date": 1444923609, "post_id": 33151962, "comment_id": 54114979, "body": "much appreciate it GisMofx"}, {"owner": {"reputation": 376, "user_id": 2564908, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/kWljr.png?s=128&g=1", "display_name": "David Egan", "link": "https://stackoverflow.com/users/2564908/david-egan"}, "edited": false, "score": 0, "creation_date": 1445001948, "post_id": 33151962, "comment_id": 54150855, "body": "Tried the above code works perfectly. Some tweaking required. Thanks again GisMofx"}, {"owner": {"reputation": 788, "user_id": 997088, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/354c6358174c3e539ca9fe427d25391c?s=128&d=identicon&r=PG", "display_name": "GisMofx", "link": "https://stackoverflow.com/users/997088/gismofx"}, "reply_to_user": {"reputation": 376, "user_id": 2564908, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/kWljr.png?s=128&g=1", "display_name": "David Egan", "link": "https://stackoverflow.com/users/2564908/david-egan"}, "edited": false, "score": 0, "creation_date": 1445085619, "post_id": 33151962, "comment_id": 54179281, "body": "@DavidEgan great! Would you mind marking this as answered? Another tip: If you have a fixed sheet size, you can make a &quot;template&quot; catdrawing to use as a base titleblock that you would reference when making new drawings."}], "tags": [], "owner": {"reputation": 788, "user_id": 997088, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/354c6358174c3e539ca9fe427d25391c?s=128&d=identicon&r=PG", "display_name": "GisMofx", "link": "https://stackoverflow.com/users/997088/gismofx"}, "is_accepted": false, "score": 1, "last_activity_date": 1444921204, "creation_date": 1444921204, "answer_id": 33151962, "question_id": 33126624, "link": "https://stackoverflow.com/questions/33126624/catia-sheet-no-title-blocks/33151962#33151962", "title": "Catia Sheet No. Title Blocks", "body": "<p>The concept is to loop through all of the <code>DrawingSheet</code> objects in the <code>Sheets</code> collection of the <code>DrawingDocument</code> you should put all title block elements in the \"Background View\". Next we need to update or create existing title block text elements. These are <code>DrawingText</code> objects. We try to access the <code>DrawingText</code> by name(THIS MUST BE UNIQUE!). If it does not exist, we create it. If it does exist, we update the value.</p>\n\n<p>Here's a start to making your title block:</p>\n\n<pre><code>Option Explicit\nSub UpdateSheetPage()\n\n    Dim DrawingDoc As DrawingDocument\n    Dim DSheet As DrawingSheet\n    Dim DView As DrawingView\n    Dim SheetCount As Integer\n    Dim currentSheet As Integer\n\n    'the drawing must be the active docuement window or this will fail. you can do more error checking if needed\n    On Error GoTo ExitSub\n    Set DrawingDoc = CATIA.ActiveDocument\n    SheetCount = DrawingDoc.Sheets.Count\n\n\n\n    currentSheet = 1 'initialize sheet number\n    'loop through all sheets and update or create a sheet number\n    For Each DSheet In DrawingDoc.Sheets\n        UpdatePageNumber DSheet, currentSheet, SheetCount\n        currentSheet = currentSheet + 1\n    Next\n\nExitSub:\nEnd Sub\n\nSub UpdatePageNumber(currentDrawingSheet As DrawingSheet, currentSheetNumber As Integer, totalSheets As Integer)\n    Dim sheetNumber As String\n    Dim xPos, yPos As Long 'mm\n\n    'edit these if needed\n    xPos = 100 'edit this - only use for new creation\n    yPos = 100 'edit this\n    'display format\n    sheetNumber = \"Page \" &amp; currentSheetNumber &amp; \"/\" &amp; totalSheets\n\n    Dim backgroundView As DrawingView\n    Dim dTexts As DrawingTexts\n    Dim currentText As DrawingText\n    Set backgroundView = currentDrawingSheet.Views.Item(\"Background View\")\n    Set dTexts = backgroundView.Texts\n    On Error GoTo CreateNew\n    Set currentText = dTexts.GetItem(\"SheetNumber\")\n    currentText.Text = sheetNumber\n    Exit Sub\n\nCreateNew:\n    Set currentText = dTexts.Add(sheetNumber, xPos, yPos)\n    currentText.Name = \"SheetNumber\" 'so we can access it later for an update\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 376, "user_id": 2564908, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/kWljr.png?s=128&g=1", "display_name": "David Egan", "link": "https://stackoverflow.com/users/2564908/david-egan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1950, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1444921204, "creation_date": 1444829147, "question_id": 33126624, "link": "https://stackoverflow.com/questions/33126624/catia-sheet-no-title-blocks", "title": "Catia Sheet No. Title Blocks", "body": "<p>I would like to get some VBA code which would tell me the number of sheets in a Catia drawing. Each sheet would have a title block placed on it. A text field on each title block would communicates the number of sheets. So if you had three sheets in the drawing you would have 1 of 3 (in the title block sheet 1) 2 of 3 (in the title block shhet 2) and 3 of 3 (in the title block sheet 3). If the macro could update all title blocks on all sheets automatically.</p>\n\n<p>Any help much appreciated.</p>\n"}, {"tags": ["vba", "excel", "error-handling"], "answers": [{"comments": [{"owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 0, "creation_date": 1444829517, "post_id": 33126706, "comment_id": 54065650, "body": "You can look at <a href=\"http://www.cpearson.com/excel/errorhandling.htm\" rel=\"nofollow noreferrer\">this page</a> to get more detailed informations on error handling."}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 1, "creation_date": 1444829824, "post_id": 33126706, "comment_id": 54065909, "body": "Use <code>On Error Goto 0</code>."}, {"owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 0, "creation_date": 1444829829, "post_id": 33126706, "comment_id": 54065915, "body": "There is no &#39;most compact/least arduous&#39; way of doing that ;-) . Just use <code>On Error Goto 0</code> as soon as the error handler is not needed anymore to restore the default."}, {"owner": {"reputation": 477, "user_id": 3894744, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8wZhi.jpg?s=128&g=1", "display_name": "WouldBeNerd", "link": "https://stackoverflow.com/users/3894744/wouldbenerd"}, "edited": false, "score": 0, "creation_date": 1444829912, "post_id": 33126706, "comment_id": 54065987, "body": "Yeah my bad, thanks very much, sorry I had removed my comment. already when i read this. I realized a little late. :/"}, {"owner": {"reputation": 477, "user_id": 3894744, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8wZhi.jpg?s=128&g=1", "display_name": "WouldBeNerd", "link": "https://stackoverflow.com/users/3894744/wouldbenerd"}, "edited": false, "score": 0, "creation_date": 1444829983, "post_id": 33126706, "comment_id": 54066053, "body": "Why does my Stupidity always arrive way sooner than my Common sense!?"}, {"owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 0, "creation_date": 1444830028, "post_id": 33126706, "comment_id": 54066075, "body": "Note that in your particular case, you might want to <code>Resume</code> instead of <code>Resume Next</code> at the end of you error handler, but it is just a guess."}, {"owner": {"reputation": 477, "user_id": 3894744, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8wZhi.jpg?s=128&g=1", "display_name": "WouldBeNerd", "link": "https://stackoverflow.com/users/3894744/wouldbenerd"}, "edited": false, "score": 0, "creation_date": 1444830199, "post_id": 33126706, "comment_id": 54066194, "body": "Thanks, I did realize that, but I was actually kinda using the .select line to see if it exists. I bet there&#39;s a better way of doing that though."}], "tags": [], "owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "is_accepted": true, "score": 4, "last_activity_date": 1444829341, "creation_date": 1444829341, "answer_id": 33126706, "question_id": 33126604, "link": "https://stackoverflow.com/questions/33126604/does-on-error-goto-errorhandler-remain-active-for-the-rest-of-the-sub-if-it-i/33126706#33126706", "title": "Does &quot;On Error GoTo errorHandler:&quot; remain active for the rest of the sub if it is not triggered?", "body": "<p><code>On Error GoTo xxxx</code> error handler will stay active as long as you you don't set another error handler or remove it with <code>On Error Goto 0</code></p>\n"}], "owner": {"reputation": 477, "user_id": 3894744, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8wZhi.jpg?s=128&g=1", "display_name": "WouldBeNerd", "link": "https://stackoverflow.com/users/3894744/wouldbenerd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 104, "favorite_count": 0, "accepted_answer_id": 33126706, "answer_count": 1, "score": 3, "last_activity_date": 1444829357, "creation_date": 1444829105, "last_edit_date": 1531164843, "question_id": 33126604, "link": "https://stackoverflow.com/questions/33126604/does-on-error-goto-errorhandler-remain-active-for-the-rest-of-the-sub-if-it-i", "title": "Does &quot;On Error GoTo errorHandler:&quot; remain active for the rest of the sub if it is not triggered?", "body": "<p>This Code tries to select a checkbox; if it does not exist it will create the checkbox via the errorHandler. I was wondering; if an error occurs later in this sub, will it still be directed to that errorHandler? In other words, will VBA attempt to create a checkbox anytime I have an error during this sub? Or does ErrorHandling only look at the next line that occurs after \"On Error Goto ...:\"</p>\n\n<pre><code>Sub PrepNewPurchaseEntryForm()\n'no relevant VBA happens here   \n\nDim companyCount As Integer:  companyCount = colCount(\"CompanyUserEntries\")\nCall FocusOnSheet(\"NewPurchaseEntry\")\nFor i = 3 To companyCount\n    Dim companyName As String: companyName = Sheets(\"CompanyUserEntries\").Cells(1, i).Value\n    On Error GoTo Err1:\n    ActiveSheet.Shapes.Range(Array(companyName)).Select\n    ''if error occurs here, will Err1 still be called?\nNext i\n    ''if error occurs here, will Err1 still be called?\n    Exit Sub\n\nErr1:\n    Call PlaceCheckBox((\"B\" &amp; (i + 7)), companyName)\n    Resume Next\n\nEnd Sub\n</code></pre>\n\n<p>Sorry this might seem like a stupid question but I have been reading up on ErrorHandling but i couldn't really find anything that explicitly explained this. </p>\n"}, {"tags": ["vba", "excel", "countif"], "comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 3, "creation_date": 1444829631, "post_id": 33126508, "comment_id": 54065740, "body": "Why not just make a pivot table that you can expand and contract and show the counts and then the list that makes up the counts? If you really want code, you create a hyperlink, then use the <code>Worksheet_FollowHyperlink</code> event in your worksheet to filter the data in your next sheet and show it."}, {"owner": {"reputation": 79, "user_id": 3439391, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GqWpK.jpg?s=128&g=1", "display_name": "noobiecderssss", "link": "https://stackoverflow.com/users/3439391/noobiecderssss"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1444830458, "post_id": 33126508, "comment_id": 54066406, "body": "@ScottHoltzman Thanks for the suggestion. I am currently looking into adding a pivot table with my data.  As for the <code>Worksheet_FollowHyperlink</code> , I will give this a try and see if I can get this to work. I&#39;m not quite sure how to add this, but I&#39;ll look it up. Thank you."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 1, "creation_date": 1444831005, "post_id": 33126508, "comment_id": 54066805, "body": "Yes, the pivot table is <b>by far</b> the better option (in a vacuum)."}], "owner": {"reputation": 79, "user_id": 3439391, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GqWpK.jpg?s=128&g=1", "display_name": "noobiecderssss", "link": "https://stackoverflow.com/users/3439391/noobiecderssss"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 268, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1448017926, "creation_date": 1444828884, "last_edit_date": 1448017926, "question_id": 33126508, "link": "https://stackoverflow.com/questions/33126508/cell-anchor-with-countifs-and-filters", "title": "Cell anchor with COUNTIFS and filters", "body": "<p><strong>SOLVED: I'll use a pivot table to circumvent the process I've described below. Thank you, @Scott Holtzman</strong></p>\n\n<hr>\n\n<p>I have 2 Excel sheets within a workbook, and I am trying to link the values in Sheet 1 to go to the corresponding count in Sheet 2.</p>\n\n<p>Example:</p>\n\n<p><strong><em>Goal</em></strong></p>\n\n<ul>\n<li>Click cell A1, A2, etc. to hyperlink to corresponding sheet and display the specific cells matched with A1, A2, etc COUNTIFS</li>\n</ul>\n\n<p><strong><em>Background</em></strong></p>\n\n<ul>\n<li><p>Sheet 1 contains COUNTIFS of applications from Sheet 2 by ranges \"global_region\" and \"country\". This sheet provides a count of the applications by specific region with specific countries</p></li>\n<li><p>Sheet 2 contains the complete list of applications</p></li>\n</ul>\n\n<p><strong><em>Process</em></strong></p>\n\n<ul>\n<li><p>Cell A1 in Sheet 1 has <code>=COUNTIFS(global_region, \"EMEA\")</code> will return a value of <strong>20</strong></p></li>\n<li><p>Cell A2 in Sheet 1 has <code>=COUNTIFS(global_region, \"EMEA\", country, \"Spain\")</code> will return a value of <strong>5</strong></p></li>\n<li><p>Add hyperlink to Cell A1 to show corresponding 20 cells. Same process for Cell A2</p></li>\n</ul>\n\n<p><strong><em>Outcome</em></strong></p>\n\n<ul>\n<li><p>When I click on cell A1 in Sheet 1, I will be redirected to Sheet 2 displaying the <strong>20</strong> applications matching the <code>=COUNTIFS(global_region, \"EMEA\")</code> filter</p></li>\n<li><p>When I click on Cell A2 in Sheet 1, I will be redirected to Sheet 2 displaying the <strong>5</strong> applications matching the <code>=COUNTIFS(global_region, \"EMEA\", country, \"Spain\")</code> filter</p></li>\n</ul>\n\n<p>With some basic Excel knowledge, I was able to link to another sheet within the workbook, without specifically displaying corresponding apps. With a little research it seems I may need to use a little bit of VB scripting to create a macro to add to Cells A1 and A2.</p>\n"}, {"tags": ["excel", "csv", "oledb", "vba"], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 5445237, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d72c2b444d8cdff2fd091ac7b200409f?s=128&d=identicon&r=PG&f=1", "display_name": "Simon Thompson", "link": "https://stackoverflow.com/users/5445237/simon-thompson"}, "edited": false, "score": 0, "creation_date": 1444829829, "post_id": 33126698, "comment_id": 54065914, "body": "Yes I knew creating a schema.ini file would work, but I have around 53 csv files to run through and from what I can gather you cannot use wildcards in a schema file. I think I will create a default schema.ini and change the file name as I run through all of the csv files."}, {"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "reply_to_user": {"reputation": 13, "user_id": 5445237, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d72c2b444d8cdff2fd091ac7b200409f?s=128&d=identicon&r=PG&f=1", "display_name": "Simon Thompson", "link": "https://stackoverflow.com/users/5445237/simon-thompson"}, "edited": false, "score": 0, "creation_date": 1444830087, "post_id": 33126698, "comment_id": 54066120, "body": "I believe that @jeeped suggestion of using <code>Workbooks.OpenText</code> might not be a bad route then. You could pop those things open one by one and grab the values. The only caveat there is if you are doing something more complicated than <code>SELECT * FROM &lt;csvfile&gt;</code>. Another alternative, again a band-aid, would be to use the <code>filesystemobject</code> to move each csv to a seperate folder, quickly rewrite the schema.ini file and move it to that folder, then run the import. You would have to programatically write the schema.ini, but it would scale nicely (nicely for excel and VBA anyway)."}], "tags": [], "owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "is_accepted": true, "score": 2, "last_activity_date": 1444829327, "creation_date": 1444829327, "answer_id": 33126698, "question_id": 33126400, "link": "https://stackoverflow.com/questions/33126400/issue-reading-in-csv-file-and-characters-being-read-as-0/33126698#33126698", "title": "Issue reading in CSV file. + and - Characters being read as 0", "body": "<p>ACE is a beast with this kind of stuff. Unlike a normal database that has field types as part of it's metadata, a CSV is just data. Because of that, ACE has to make a decision about the data type. In your case, ACE is deciding that this is a number since it starts with a <code>+</code> or <code>-</code>. If I recall correctly, ACE and it's JET predecessor only analyzes the top 8 records to determine the field type.</p>\n\n<p>There are two ways around this though. </p>\n\n<ol>\n<li><p>You can use a schema.ini file. Basically this is a text file named <code>schema.ini</code> that you just stick in the same folder as the data you are connecting to. ACE will automatically use the file if it's present. <a href=\"https://msdn.microsoft.com/en-us/library/ms709353.aspx\" rel=\"nofollow\">Here's some info about how to build it</a> (and you can google it and get tons of examples).</p></li>\n<li><p>This is the band-aid approach, which is sometimes easier than the schema.ini depending on your circumstances. Because ACE only analyzes the top 8 records of the CSV to determine the field type, you can just insert 8 new records at the top of the file that have a definitive field type. For example, your field containing <code>+</code> or <code>-</code> just stick a character like <code>S</code>. ACE will then see that this is a non-numeric field and will treat it as a string. <a href=\"http://www.ozgrid.com/forum/showthread.php?t=163510\" rel=\"nofollow\">You can see here how to prepend data to an existing text file using the filesystemobject</a> (and google for more info, it's terribly useful stuff)</p></li>\n</ol>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 1, "last_activity_date": 1444829349, "creation_date": 1444829349, "answer_id": 33126711, "question_id": 33126400, "link": "https://stackoverflow.com/questions/33126400/issue-reading-in-csv-file-and-characters-being-read-as-0/33126711#33126711", "title": "Issue reading in CSV file. + and - Characters being read as 0", "body": "<p>The +/- is forcing a numerical conversion and you are losing the symbol in favor of its purely mathematical equivalent which in both cases is zero.</p>\n\n<p>You could try using an appropriate <a href=\"https://msdn.microsoft.com/en-us/library/ms709353(v=vs.85).aspx\" rel=\"nofollow\">Schema.ini</a> that details the field types. If that is not possible, abandon the ADODB.Connection and use the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff837097.aspx\" rel=\"nofollow\">Workbooks.OpenText method</a>. Specify that column's <a href=\"https://msdn.microsoft.com/en-us/library/bb241018%28v=office.12%29.aspx\" rel=\"nofollow\">xlColumnDataType</a> as xlTextFormat (e.g. <strong>2</strong>).</p>\n"}], "owner": {"reputation": 13, "user_id": 5445237, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d72c2b444d8cdff2fd091ac7b200409f?s=128&d=identicon&r=PG&f=1", "display_name": "Simon Thompson", "link": "https://stackoverflow.com/users/5445237/simon-thompson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 50, "favorite_count": 0, "accepted_answer_id": 33126698, "answer_count": 2, "score": 1, "last_activity_date": 1444829982, "creation_date": 1444828603, "last_edit_date": 1531161705, "question_id": 33126400, "link": "https://stackoverflow.com/questions/33126400/issue-reading-in-csv-file-and-characters-being-read-as-0", "title": "Issue reading in CSV file. + and - Characters being read as 0", "body": "<p>I am experiencing a rather weird issue will reading in a small csv file using the Microsoft.ACE.OLEDB.12.0 engine.</p>\n\n<pre><code>    Dim cN As ADODB.Connection\n    Dim RS As ADODB.Recordset\n    Set cN = New ADODB.Connection\n    Set RS = New ADODB.Recordset\n    cN.Open (\"Provider=Microsoft.ACE.OLEDB.12.0;\" &amp; _\n               \"Data Source=\" &amp; myPath &amp; \";\" &amp; _\n               \"Extended Properties=\"\"Text;HDR=NO;FMT=CSVDelimited\"\"\")\n    RS.ActiveConnection = cN\n   RS.Source = \"select * from \" &amp; myfile\n   RS.Open\n</code></pre>\n\n<p>When calling on RS.Fields(7) which should be \"+\" or a \"-\" it is returning a value of 0?</p>\n\n<p>I have no control over the csv files given so I cannot have the \"+\" or \"-\" characters changed to something else.</p>\n"}, {"tags": ["ms-access", "split", "vba"], "comments": [{"owner": {"reputation": 1482, "user_id": 5043393, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/effb702a40d17cd670f56f051847b33f?s=128&d=identicon&r=PG&f=1", "display_name": "LiamH", "link": "https://stackoverflow.com/users/5043393/liamh"}, "edited": false, "score": 0, "creation_date": 1444828827, "post_id": 33126372, "comment_id": 54065173, "body": "have you tried manually splitting your DB?"}, {"owner": {"reputation": 1482, "user_id": 5043393, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/effb702a40d17cd670f56f051847b33f?s=128&d=identicon&r=PG&f=1", "display_name": "LiamH", "link": "https://stackoverflow.com/users/5043393/liamh"}, "edited": false, "score": 0, "creation_date": 1444829140, "post_id": 33126372, "comment_id": 54065377, "body": "I have submitted an answer"}], "answers": [{"tags": [], "owner": {"reputation": 1482, "user_id": 5043393, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/effb702a40d17cd670f56f051847b33f?s=128&d=identicon&r=PG&f=1", "display_name": "LiamH", "link": "https://stackoverflow.com/users/5043393/liamh"}, "is_accepted": false, "score": 0, "last_activity_date": 1444829122, "creation_date": 1444829122, "answer_id": 33126615, "question_id": 33126372, "link": "https://stackoverflow.com/questions/33126372/splitting-an-access-database-into-back-and-front-end-issues/33126615#33126615", "title": "Splitting an Access Database into back and front end issues", "body": "<p>to manually split your DB. you can do the following:</p>\n\n<p>Copy your database in to the location of the back end. Delete all forms, queries and reports. Just leaving the tables. </p>\n\n<p>Then in what will become your front end  go to External Data>Access and import those tables from your backend. ensure that you click on the \"Link to the data source by creating linked tables\".</p>\n\n<p>Let me know if it works. you should see that the tables(navigation pane) in the frontend now have a little arrow next to them.</p>\n"}], "owner": {"reputation": 347, "user_id": 4606032, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ccbc09dcbb2621ecf5b77d02e242c089?s=128&d=identicon&r=PG&f=1", "display_name": "Brianna Cates", "link": "https://stackoverflow.com/users/4606032/brianna-cates"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 36, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1594651532, "creation_date": 1444828518, "last_edit_date": 1594651532, "question_id": 33126372, "link": "https://stackoverflow.com/questions/33126372/splitting-an-access-database-into-back-and-front-end-issues", "title": "Splitting an Access Database into back and front end issues", "body": "<p>I have been trying to split my access database into a front and back end wiht no avail... I keep getting an error that says \"The database engine could not lock table \"\" because it is already in use by another person or process\". Any help would be greatly appreciated.</p>\n\n<p>Thanks in advance</p>\n"}, {"tags": ["excel", "vba", "combobox", "copy-paste"], "answers": [{"tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": true, "score": 0, "last_activity_date": 1444828143, "creation_date": 1444828143, "answer_id": 33126222, "question_id": 33125995, "link": "https://stackoverflow.com/questions/33125995/copy-sheet-with-combo-boxes/33126222#33126222", "title": "Copy sheet with combo boxes", "body": "<p>Rather than:</p>\n\n<pre><code> Set ws_old = ActiveSheet\n ActiveWorkbook.Worksheets.Add\n Set ws_new = ActiveSheet\n</code></pre>\n\n<p>and doing copies, use:</p>\n\n<pre><code>ActiveSheet.Copy After:=Sheets(Sheets.Count)\n</code></pre>\n\n<p>This will produce a complete copy:</p>\n\n<ol>\n<li>rows</li>\n<li>cells</li>\n<li>Objects, etc.</li>\n</ol>\n"}, {"tags": [], "owner": {"reputation": 75, "user_id": 5414104, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/ca336b791b94112b78f1cac777f49a77?s=128&d=identicon&r=PG&f=1", "display_name": "DSG", "link": "https://stackoverflow.com/users/5414104/dsg"}, "is_accepted": false, "score": 0, "last_activity_date": 1444987636, "last_edit_date": 1444987636, "creation_date": 1444902301, "answer_id": 33145159, "question_id": 33125995, "link": "https://stackoverflow.com/questions/33125995/copy-sheet-with-combo-boxes/33145159#33145159", "title": "Copy sheet with combo boxes", "body": "<p>The answer of <em>Gary's Student</em> to copy the worksheet worked just fine when copying it within the same workbook:   </p>\n\n<pre><code>ActiveSheet.Copy After:=Sheets(Sheets.Count)\n</code></pre>\n\n<p>However this causes a problem when copying the sheet to another (new) workbook as the format differs in colors. To solve this I used the following code before adding a new workbook:</p>\n\n<pre><code>Workbooks.Add Template:=\"Workbook\"\n</code></pre>\n"}], "owner": {"reputation": 75, "user_id": 5414104, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/ca336b791b94112b78f1cac777f49a77?s=128&d=identicon&r=PG&f=1", "display_name": "DSG", "link": "https://stackoverflow.com/users/5414104/dsg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 764, "favorite_count": 0, "accepted_answer_id": 33126222, "answer_count": 2, "score": 0, "last_activity_date": 1444987636, "creation_date": 1444827550, "question_id": 33125995, "link": "https://stackoverflow.com/questions/33125995/copy-sheet-with-combo-boxes", "title": "Copy sheet with combo boxes", "body": "<p>I have a worksheet that is copied and pasted into a new worksheet when the user clicks on a button. I've managed to copy everything in the worksheet (shapes, buttons, etc.) except for the combo boxes that contain dropdown lists using named ranges (which are created with the following code: <a href=\"http://www.contextures.com/xlDataVal11.html\" rel=\"nofollow\">http://www.contextures.com/xlDataVal11.html</a>).</p>\n\n<p>I tried to record a macro for this and got the following (simplified) </p>\n\n<pre><code>ActiveSheet.Shapes.Range(Array(\"ExampleCombo\")).Select\nSelection.Copy\nActiveSheet.Paste\n</code></pre>\n\n<p>With this I understood that the combo box is regarded as a shape. In order to copy all combo boxes and put them in the right position in the new sheet I therefore tried the following:</p>\n\n<pre><code> Sub CopyCombos ()\n\n Dim ws_new As Worksheet\n Dim ws_old As Worksheet\n Dim Special_Shape As Shape\n Dim Special_Shape_COPY As Shape\n Dim Position_Left As Single\n Dim Position_Top As Single\n Dim Position_Width As Single\n Dim Position_Height As Single\n\n Set ws_old = ActiveSheet\n ActiveWorkbook.Worksheets.Add\n Set ws_new = ActiveSheet\n\n For Each Special_Shape In ws_old.Shapes\n     'Copy position\n         Position_Left = Special_Shape.Left\n         Position_Top = Special_Shape.Top\n         Position_Width = Special_Shape.Width\n         Position_Height = Special_Shape.Height\n     'Copy\n         Special_Shape.Copy\n     'Paste\n         ws_new.Paste   '&lt;=== Here's the problem! But why?\n     'Rename\n         Set Special_Shape_COPY = Selection\n     'Put in right place\n         Special_Shape_COPY.Left = Position_Left\n         Special_Shape_COPY.Top = Position_Top\n         Special_Shape_COPY.Width = Position_Width\n         Special_Shape_COPY.Height = Position_Height\n Next Special_Shape\n\n End Sub\n</code></pre>\n\n<p>I get an error message saying \"Can't enter break mode at this time\" directly after pasting the combo box in the new worksheet. How can I solve this? </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1444827621, "post_id": 33125813, "comment_id": 54064277, "body": "when you say that the value should appear as entered, do you mean you want to see it literally as it was written (12/12/15 or 12.12.15 or 12-12-15 or 12-Dec-15), or do you want the numerical representation to appear 42354 for example?"}, {"owner": {"reputation": 3, "user_id": 5445127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ad6cc3fce5fe19db1ae3381779f69c6?s=128&d=identicon&r=PG&f=1", "display_name": "Karthikeya", "link": "https://stackoverflow.com/users/5445127/karthikeya"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1444975238, "post_id": 33125813, "comment_id": 54135615, "body": "I wanted to show literally as it was written and fortunately i am."}], "answers": [{"comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1444827495, "post_id": 33125950, "comment_id": 54064189, "body": "While this is the correct syntax to get true text format, it will not keep the date as entered, but rather turn the date into its numerical equivalent in Excel."}, {"owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 1, "creation_date": 1444828092, "post_id": 33125950, "comment_id": 54064619, "body": "Well, if the format is applied before the date is entered the conversion to date will not happen and the text won&#39;t change."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1444828172, "post_id": 33125950, "comment_id": 54064679, "body": "Yes, that is true. I was going to suggest that to the OP, but I am waiting on his response to my comment so its clear exactly what he needs."}], "tags": [], "owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "is_accepted": true, "score": 1, "last_activity_date": 1444827409, "creation_date": 1444827409, "answer_id": 33125950, "question_id": 33125813, "link": "https://stackoverflow.com/questions/33125813/excel-macro-change-cell-format-to-text-of-protected-sheet/33125950#33125950", "title": "Excel Macro Change Cell Format to Text Of Protected Sheet", "body": "<p>Try:</p>\n\n<pre><code>gSampleSheet.Range(\"K1:K100\").NumberFormat = \"@\"\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 5445127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ad6cc3fce5fe19db1ae3381779f69c6?s=128&d=identicon&r=PG&f=1", "display_name": "Karthikeya", "link": "https://stackoverflow.com/users/5445127/karthikeya"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 479, "favorite_count": 0, "accepted_answer_id": 33125950, "answer_count": 1, "score": 0, "last_activity_date": 1444836681, "creation_date": 1444827025, "last_edit_date": 1444836681, "question_id": 33125813, "link": "https://stackoverflow.com/questions/33125813/excel-macro-change-cell-format-to-text-of-protected-sheet", "title": "Excel Macro Change Cell Format to Text Of Protected Sheet", "body": "<p>I have a requirement to change a protected sheet cell format to Text(from Date) as soon as the sheet is opened. I mean to say the value should appear as it was entered into the sheet. </p>\n\n<p>I have kept my code in Workbook_Open() event of ThisWorkBook, and the sequence of steps given below.</p>\n\n<p><strong>Unprotect the Sheet:</strong> <code>gSampleSheet.Unprotect Password:=\"MyPassword\"</code></p>\n\n<p><strong>Change the Cell format:</strong> <code>gSampleSheet.Range(\"K1:K100\").NumberFormat = \"Text\"</code></p>\n\n<p><strong>Protect the Sheet:</strong> <code>gSampleSheet.Protect DrawingObjects:=False, contents:=True, Scenarios:=True, Password:=\"MyPassword\"</code></p>\n\n<p>When a Date value is entered in the cell then it should be converted to Text format and the value should appear as is. </p>\n\n<p>i.e. If 12/12/15, 12.12.15, 12-12-15, 12-Dec-15 are entered then they should appear as they are entered(instead of changed to Date Format). </p>\n\n<p>However the cell is showing some random values like T2015tx or some other values. Please help me to fix this as I am struggling to find out the root cause. </p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 1, "creation_date": 1444827058, "post_id": 33125760, "comment_id": 54063892, "body": "how about just a pivot table to reorganize the data - then you can copy and paste it if you don&#39;t want to keep the pivot table?"}, {"owner": {"reputation": 909, "user_id": 4274408, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/46c3ba48a771760b978c30df044b20a9?s=128&d=identicon&r=PG&f=1", "display_name": "martinkabe", "link": "https://stackoverflow.com/users/4274408/martinkabe"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1444827322, "post_id": 33125760, "comment_id": 54064084, "body": "Actually I need to do that programmatically in VBA... Any Ideas or piece of example code?"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1444827729, "post_id": 33125760, "comment_id": 54064348, "body": "why do you <i>need</i> to do through VBA? And no, there is no sample code directly available for this specific problem (well, there may be, but you&#39;d have to search for it). If you write some code to do it and get stuck and post what you tried here, we can then help you with it. But this is not a code writing service. That said, if you do need to use code, I would suggest programmatically making a pivot table to organize the data then copy / paste the new structure to where you need to go."}, {"owner": {"reputation": 909, "user_id": 4274408, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/46c3ba48a771760b978c30df044b20a9?s=128&d=identicon&r=PG&f=1", "display_name": "martinkabe", "link": "https://stackoverflow.com/users/4274408/martinkabe"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1444827936, "post_id": 33125760, "comment_id": 54064507, "body": "That&#39;s exactly what I need :-) I was searching through a bunch of sites and without any success :-( I&#39;ll try to place this task somewhere else. Thanks for your time."}], "answers": [{"tags": [], "owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "is_accepted": false, "score": 1, "last_activity_date": 1444832414, "last_edit_date": 1592644375, "creation_date": 1444832414, "answer_id": 33127910, "question_id": 33125760, "link": "https://stackoverflow.com/questions/33125760/how-to-convert-flatten-table-to-2d-excel-table/33127910#33127910", "title": "How to convert flatten table to 2D Excel table", "body": "<p>You can use Index/Match, as an array formula, to fill this in without VBA.  (If you need VBA, record this as a macro to see how the formula is entered, then just apply it to the empty table range):</p>\n<p><code>=INDEX($C$2:$C$6,MATCH($F3&amp;G$2,$A$2:$A$6&amp;$B$2:$B$6,0))</code>\n(enter with CTRL+SHIFT+ENTER)</p>\n<p>Here's how the data's laid out, so you can see where I'm getting the ranges:</p>\n<p><a href=\"https://i.stack.imgur.com/PRj2V.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/PRj2V.jpg\" alt=\"enter image description here\" /></a></p>\n<p>Then you can drag the formula over and down to fill in the rest of the table.  Natrually you would need to adjust the ranges used based on your data.</p>\n"}], "owner": {"reputation": 909, "user_id": 4274408, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/46c3ba48a771760b978c30df044b20a9?s=128&d=identicon&r=PG&f=1", "display_name": "martinkabe", "link": "https://stackoverflow.com/users/4274408/martinkabe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 169, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1444832414, "creation_date": 1444826863, "last_edit_date": 1531161705, "question_id": 33125760, "link": "https://stackoverflow.com/questions/33125760/how-to-convert-flatten-table-to-2d-excel-table", "title": "How to convert flatten table to 2D Excel table", "body": "<p>I have a \"flatten\" table with countries and years in Excel. eg.</p>\n\n<pre><code>Country      Year       Value\nUSA          1961       a\nUSA          1962       x\nUSA          1963       g\nUSA          1964       y\nFrance       1961       u\n              ...\n</code></pre>\n\n<p>And I'd like to have a two dimensional table as following:</p>\n\n<pre><code>        1961        1962        1963        1964\nUSA      a           x            g           y\nFrance   u           e            h           a\nGermany  o           x            n           p\n</code></pre>\n\n<p>Do you happen to know, how to do that programmatically in Excel using VBA. Many thanks in forward for any hint or advice.</p>\n"}, {"tags": ["vba", "excel", "timedelay"], "comments": [{"owner": {"reputation": 9666, "user_id": 1419175, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/PRKSW.jpg?s=128&g=1", "display_name": "Dave Sexton", "link": "https://stackoverflow.com/users/1419175/dave-sexton"}, "edited": false, "score": 1, "creation_date": 1444826793, "post_id": 33125335, "comment_id": 54063720, "body": "So you have loop inside which you do some processing then wait a second, could it be that your extra time is the processing? What happens if you turn off screen updating first then turn it back on at the end using <code>Application.ScreenUpdating = False</code>, does that speed it up?"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 5444783, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7217088c9dfc9a4aad9b4aa492e095e4?s=128&d=identicon&r=PG&f=1", "display_name": "Istv&#225;n", "link": "https://stackoverflow.com/users/5444783/istv%c3%a1n"}, "edited": false, "score": 0, "creation_date": 1444922273, "post_id": 33126078, "comment_id": 54114041, "body": "I really appreciate all the help you gave me. I used Application.OnTime and it works flawlessly. Thank you Jeeped. Thank you Dave."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 1, "last_activity_date": 1444827783, "creation_date": 1444827783, "answer_id": 33126078, "question_id": 33125335, "link": "https://stackoverflow.com/questions/33125335/1-sec-delay-lasts-almost-2-sec/33126078#33126078", "title": "1 sec delay lasts almost 2 sec", "body": "<p>That is only an approximate delay because you really have no idea of what else is going through the message queue and being processed by the <code>DoEvents</code> command (one word btw). An alternative would be to call the procedure from within itself with the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff196165.aspx\" rel=\"nofollow\">Application.OnTime method</a>.</p>\n\n<pre><code>Sub timed_routine()\n    Application.Interactive = False\n    ThisWorkbook.Worksheets(\"Sheet1\").Cells(1, 1) = 1\n    Application.Interactive = True\n    'Debug.Print Timer\n    Application.OnTime Now + TimeSerial(0, 0, 1), \"timed_routine\"\nEnd Sub\n</code></pre>\n\n<p>With the <code>Debug.Print Timer</code> command uncommented and active, this routine was cycling in about 1.015 seconds.</p>\n"}], "owner": {"reputation": 3, "user_id": 5444783, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7217088c9dfc9a4aad9b4aa492e095e4?s=128&d=identicon&r=PG&f=1", "display_name": "Istv&#225;n", "link": "https://stackoverflow.com/users/5444783/istv%c3%a1n"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 64, "favorite_count": 0, "accepted_answer_id": 33126078, "answer_count": 1, "score": 0, "last_activity_date": 1444929721, "creation_date": 1444825776, "last_edit_date": 1444929721, "question_id": 33125335, "link": "https://stackoverflow.com/questions/33125335/1-sec-delay-lasts-almost-2-sec", "title": "1 sec delay lasts almost 2 sec", "body": "<p>I am writing a code to copy data from one spreadsheet to an other one in every second. I have tried Application.Wait and Sleep but they blocked both spreadsheets so I decided to use a do until loop. It works but 1 sec lasts almost 2 sec and I don't know why. So I left only the loop in the code but the test gave the same result (it took ca 95 sec). Any suggestion?  Here is the code: </p>\n\n<pre><code>    Sub Test()\n\n    Dim Delay As Date\n\n    cell = 1\n\n    For i = 1 to 60\n\n     Workbooks(\"Data\").Worksheets(\"Sheet1\").Range(\"C\" &amp; cell).Value = cell\n\n     cell = cell +1\n     Delay = Now() + TimeValue(\"00:00:01\")\n\n     Do Until Now() &gt;= Delay\n\n      Do Events\n\n     Loop\n\n    Next i\n\n    End Sub\n</code></pre>\n"}, {"tags": ["image", "excel", "export", "resolution", "vba"], "answers": [{"comments": [{"owner": {"reputation": 87, "user_id": 5160764, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/1a89de3dd488875b7b3f9a48fed9aa56?s=128&d=identicon&r=PG&f=1", "display_name": "Antares797", "link": "https://stackoverflow.com/users/5160764/antares797"}, "edited": false, "score": 0, "creation_date": 1444986782, "post_id": 33137161, "comment_id": 54141400, "body": "I opted to use the <code>activewindow.zoom</code> method because <code>scaleheight</code> and <code>scalewidth</code> are methods that work for shapes and not for charts or chartobjects. Thanks for the solution."}], "tags": [], "owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "is_accepted": true, "score": 5, "last_activity_date": 1445040311, "last_edit_date": 1445040311, "creation_date": 1444864013, "answer_id": 33137161, "question_id": 33125021, "link": "https://stackoverflow.com/questions/33125021/control-resolution-of-exported-chart/33137161#33137161", "title": "Control resolution of exported chart", "body": "<p>Try this in your CmdLoad</p>\n\n<pre><code>Private Sub CmdLoad_Click()\n    Dim fPath As String, imgName As String, chartID As Long\n\n    If chartDest = \"Select chart destination folder\" Then\n        MsgBox \"Select chart destination\"\n        Exit Sub\n    End If\n    chartID = ChartList.ListIndex + 1\n\n    'saving chart to image\n    imgName = ChartList.Value\n    fPath = chartDest &amp; imgName &amp; \".jpeg\"\n    With ThisWorkbook.Worksheets(\"Blad3\").ChartObjects(chartID)\n        ActiveWindow.Zoom = 175\n        .Chart.Export fPath, \"jpg\"\n        ActiveWindow.Zoom = 100\n    End With\n\n    'loading image\n    UserForm4.ChartImage.Picture = LoadPicture(fPath)\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 87, "user_id": 5160764, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/1a89de3dd488875b7b3f9a48fed9aa56?s=128&d=identicon&r=PG&f=1", "display_name": "Antares797", "link": "https://stackoverflow.com/users/5160764/antares797"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7635, "favorite_count": 0, "accepted_answer_id": 33137161, "answer_count": 1, "score": 3, "last_activity_date": 1445040311, "creation_date": 1444824895, "last_edit_date": 1531161705, "question_id": 33125021, "link": "https://stackoverflow.com/questions/33125021/control-resolution-of-exported-chart", "title": "Control resolution of exported chart", "body": "<p>I have an excel userform which allows you to save excel charts in a certain worksheet to a .jpg image and at the same time show the chart in the userform. However I have found that it is hard to control the resolution of said image. The resolution seems te depend on the amount of zoom on the worksheet. When I zoom in, I get a high quality image and when I zoom out the resolution becomes very poor. Is there a way to control this using vba code?</p>\n\n<p>The code I am using for the export is below:</p>\n\n<pre><code>Private Sub CmdBrowse_Click()\nDim Directory1 As String\n\nWith Application.FileDialog(msoFileDialogFolderPicker)\n  .AllowMultiSelect = False\n  .Show\n  On Error Resume Next\n  Directory1 = .SelectedItems(1)\n  Err.Clear\n  On Error GoTo 0\nEnd With\n\nChartDest.Value = Directory1\nEnd Sub\n\nPrivate Sub CmdLoad_Click()\nDim FilePath As String\nDim Imagename As String\nDim ChartNumber As Integer\n\nIf ChartDest = \"Select chart destination folder\" Then\n    MsgBox \"Select chart destination\"\n    Exit Sub\nEnd If\n\nChartNumber = ChartList.ListIndex + 1\n\n'saving chart to image\nImagename = ChartList.Value\nFilePath = ChartDest &amp; Imagename &amp; \".jpeg\"\nThisWorkbook.Worksheets(\"Blad3\").ChartObjects(ChartNumber).Chart.Export FilePath, \"jpg\"\n'loading image\nUserForm4.ChartImage.Picture = LoadPicture(FilePath)\nEnd Sub\n</code></pre>\n\n<p>ChartDest is a textbox with the destination path.\nChartlist is a listbox with a list of avaiable charts</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 12614, "user_id": 3566998, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S7lz6.png?s=128&g=1", "display_name": "Excel Hero", "link": "https://stackoverflow.com/users/3566998/excel-hero"}, "edited": false, "score": 0, "creation_date": 1444825947, "post_id": 33123786, "comment_id": 54063133, "body": "Rather than storing the token as a global, store it as a defined name, which is persistent. Then simply evaluate the name every time you need the token."}], "answers": [{"comments": [{"owner": {"reputation": 112, "user_id": 5200994, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4158aba18be472c19fe35e35495aa9c0?s=128&d=identicon&r=PG&f=1", "display_name": "Christopher Dermody-Lawrence", "link": "https://stackoverflow.com/users/5200994/christopher-dermody-lawrence"}, "edited": false, "score": 0, "creation_date": 1444827631, "post_id": 33125656, "comment_id": 54064285, "body": "I like the idea, it has potential if i set up a button to click to log in which references the Username and Password cells. But I cant Use ThisWorkbook.Names.Add in a function. The problem i still face is that i might only let tokens last a day for security reasons. So it would be a daily log in. Would there be a way of automating the log in. Which is why i wanted to know if there was a way of calling a onload from an add-in."}, {"owner": {"reputation": 12614, "user_id": 3566998, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S7lz6.png?s=128&g=1", "display_name": "Excel Hero", "link": "https://stackoverflow.com/users/3566998/excel-hero"}, "reply_to_user": {"reputation": 112, "user_id": 5200994, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4158aba18be472c19fe35e35495aa9c0?s=128&d=identicon&r=PG&f=1", "display_name": "Christopher Dermody-Lawrence", "link": "https://stackoverflow.com/users/5200994/christopher-dermody-lawrence"}, "edited": false, "score": 0, "creation_date": 1444828344, "post_id": 33125656, "comment_id": 54064813, "body": "There is no such event. Regarding the age of the token, you can store when the token was obtained in the comments of the defined name, like so:"}, {"owner": {"reputation": 12614, "user_id": 3566998, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S7lz6.png?s=128&g=1", "display_name": "Excel Hero", "link": "https://stackoverflow.com/users/3566998/excel-hero"}, "reply_to_user": {"reputation": 112, "user_id": 5200994, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4158aba18be472c19fe35e35495aa9c0?s=128&d=identicon&r=PG&f=1", "display_name": "Christopher Dermody-Lawrence", "link": "https://stackoverflow.com/users/5200994/christopher-dermody-lawrence"}, "edited": false, "score": 0, "creation_date": 1444828430, "post_id": 33125656, "comment_id": 54064874, "body": "Then, if too old, get a new token."}, {"owner": {"reputation": 12614, "user_id": 3566998, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S7lz6.png?s=128&g=1", "display_name": "Excel Hero", "link": "https://stackoverflow.com/users/3566998/excel-hero"}, "reply_to_user": {"reputation": 112, "user_id": 5200994, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4158aba18be472c19fe35e35495aa9c0?s=128&d=identicon&r=PG&f=1", "display_name": "Christopher Dermody-Lawrence", "link": "https://stackoverflow.com/users/5200994/christopher-dermody-lawrence"}, "edited": false, "score": 0, "creation_date": 1444828541, "post_id": 33125656, "comment_id": 54064939, "body": "When you say function, do you mean UDF? Because there is no reason that you cannot do this from a function."}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1444829108, "post_id": 33125656, "comment_id": 54065361, "body": "As I understood, the OP wanted that once the user is logged in and closes the WB, he will not be prompted again for login <i>even if he opens another WB</i>. Did I misunderstand the requirement?"}, {"owner": {"reputation": 12614, "user_id": 3566998, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S7lz6.png?s=128&g=1", "display_name": "Excel Hero", "link": "https://stackoverflow.com/users/3566998/excel-hero"}, "reply_to_user": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1444829239, "post_id": 33125656, "comment_id": 54065453, "body": "@A.S.H Correct, but with the caveat that this is Add-in code."}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1444829327, "post_id": 33125656, "comment_id": 54065510, "body": "But then why not store this information in some persistent space, i.e. registry, file, DB, etc."}, {"owner": {"reputation": 12614, "user_id": 3566998, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S7lz6.png?s=128&g=1", "display_name": "Excel Hero", "link": "https://stackoverflow.com/users/3566998/excel-hero"}, "edited": false, "score": 0, "creation_date": 1444829502, "post_id": 33125656, "comment_id": 54065641, "body": "That&#39;s an option, but the Names collection of the Add-in is equally persistent."}, {"owner": {"reputation": 112, "user_id": 5200994, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4158aba18be472c19fe35e35495aa9c0?s=128&d=identicon&r=PG&f=1", "display_name": "Christopher Dermody-Lawrence", "link": "https://stackoverflow.com/users/5200994/christopher-dermody-lawrence"}, "edited": false, "score": 0, "creation_date": 1444829526, "post_id": 33125656, "comment_id": 54065656, "body": "When i try to call ThisWorkbook.Names.Add the same way you described it escapes the UDF with no reason. I assumed it was because it was changing something outside of the functions scope. I&#39;m quite new to Excel VBA but I&#39;ve had a similar problem referencing other cells from functions. I have only been able to do that through buttons is there something I&#39;m doing wrong?"}, {"owner": {"reputation": 112, "user_id": 5200994, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4158aba18be472c19fe35e35495aa9c0?s=128&d=identicon&r=PG&f=1", "display_name": "Christopher Dermody-Lawrence", "link": "https://stackoverflow.com/users/5200994/christopher-dermody-lawrence"}, "edited": false, "score": 0, "creation_date": 1444829646, "post_id": 33125656, "comment_id": 54065750, "body": "Something as simple as this doesn&#39;t work <code>Function SetToken(newToken As String) As String ThisWorkbook.Names.Add &quot;Token&quot;, newToken SetToken = &quot;New Token is set to: &quot; + ThisWorkbook.Sheets(1).[Token] End Function</code> it breaks just after its set."}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1444829657, "post_id": 33125656, "comment_id": 54065767, "body": "@ExcelHero Ah ok, I see :)"}, {"owner": {"reputation": 12614, "user_id": 3566998, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S7lz6.png?s=128&g=1", "display_name": "Excel Hero", "link": "https://stackoverflow.com/users/3566998/excel-hero"}, "edited": false, "score": 0, "creation_date": 1444829719, "post_id": 33125656, "comment_id": 54065823, "body": "No, if it is a true UDF being called from a worksheet formula, then you are correct, but why would you do that. A VBA function called from another VBA procedure does not have this restriction and it CAN change the workbook."}, {"owner": {"reputation": 12614, "user_id": 3566998, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S7lz6.png?s=128&g=1", "display_name": "Excel Hero", "link": "https://stackoverflow.com/users/3566998/excel-hero"}, "reply_to_user": {"reputation": 112, "user_id": 5200994, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4158aba18be472c19fe35e35495aa9c0?s=128&d=identicon&r=PG&f=1", "display_name": "Christopher Dermody-Lawrence", "link": "https://stackoverflow.com/users/5200994/christopher-dermody-lawrence"}, "edited": false, "score": 0, "creation_date": 1444830072, "post_id": 33125656, "comment_id": 54066108, "body": "@ChristopherDermody-Lawrence How are you calling the sample function you just posted? I just tested it here and it works fine."}, {"owner": {"reputation": 112, "user_id": 5200994, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4158aba18be472c19fe35e35495aa9c0?s=128&d=identicon&r=PG&f=1", "display_name": "Christopher Dermody-Lawrence", "link": "https://stackoverflow.com/users/5200994/christopher-dermody-lawrence"}, "edited": false, "score": 0, "creation_date": 1444830207, "post_id": 33125656, "comment_id": 54066201, "body": "Thanks very much for all the help. How do you think i should call the functions? a button that takes in defined cells? or is there an easier way to  send the username and password to the UDF add-in"}, {"owner": {"reputation": 112, "user_id": 5200994, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4158aba18be472c19fe35e35495aa9c0?s=128&d=identicon&r=PG&f=1", "display_name": "Christopher Dermody-Lawrence", "link": "https://stackoverflow.com/users/5200994/christopher-dermody-lawrence"}, "edited": false, "score": 0, "creation_date": 1444830260, "post_id": 33125656, "comment_id": 54066236, "body": "@ExcelHero I&#39;m probably calling it all wrong. I literally call in in the cell =SetToken(&quot;fdsfsdfdfa&quot;)"}, {"owner": {"reputation": 12614, "user_id": 3566998, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S7lz6.png?s=128&g=1", "display_name": "Excel Hero", "link": "https://stackoverflow.com/users/3566998/excel-hero"}, "edited": false, "score": 0, "creation_date": 1444830464, "post_id": 33125656, "comment_id": 54066412, "body": "Ahh... Yes, that is the problem. Don&#39;t call from a cell formula. You can call it from any VBA procedure. It can be called from a button click, but probably the best is to call it from the add-in&#39;s Workbook_Open()"}, {"owner": {"reputation": 112, "user_id": 5200994, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4158aba18be472c19fe35e35495aa9c0?s=128&d=identicon&r=PG&f=1", "display_name": "Christopher Dermody-Lawrence", "link": "https://stackoverflow.com/users/5200994/christopher-dermody-lawrence"}, "edited": false, "score": 0, "creation_date": 1444830604, "post_id": 33125656, "comment_id": 54066528, "body": "Perfect that&#39;s exactly what i was looking for thanks"}], "tags": [], "owner": {"reputation": 12614, "user_id": 3566998, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S7lz6.png?s=128&g=1", "display_name": "Excel Hero", "link": "https://stackoverflow.com/users/3566998/excel-hero"}, "is_accepted": true, "score": 2, "last_activity_date": 1444826594, "creation_date": 1444826594, "answer_id": 33125656, "question_id": 33123786, "link": "https://stackoverflow.com/questions/33123786/vba-excel-add-in-initialize-global-variables-on-load-not-in-workbooks/33125656#33125656", "title": "VBA Excel add in -- Initialize global variables on load -- not in workbooks", "body": "<p>Rather than storing the token as a global, store it as a defined name, which is persistent. </p>\n\n<pre><code>ThisWorkbook.Names.Add \"Token\", sToken\n</code></pre>\n\n<p>Then simply evaluate the name every time you need the token.</p>\n\n<pre><code> sToken = ThisWorkbook.Sheets(1).[Token]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 112, "user_id": 5200994, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4158aba18be472c19fe35e35495aa9c0?s=128&d=identicon&r=PG&f=1", "display_name": "Christopher Dermody-Lawrence", "link": "https://stackoverflow.com/users/5200994/christopher-dermody-lawrence"}, "is_accepted": false, "score": 2, "last_activity_date": 1444907716, "creation_date": 1444907716, "answer_id": 33147064, "question_id": 33123786, "link": "https://stackoverflow.com/questions/33123786/vba-excel-add-in-initialize-global-variables-on-load-not-in-workbooks/33147064#33147064", "title": "VBA Excel add in -- Initialize global variables on load -- not in workbooks", "body": "<p>If anyone was curious. I found that you can initialize the global variables with something similar to OnLoad(). </p>\n\n<pre><code>Private WebAddress As String\n\nSub Auto_Open()\n    WebAddress = \"www.stackoverflow.com\"\nEnd Sub\n</code></pre>\n\n<p>Can be in a module, and is called when the workbook opens. </p>\n"}], "owner": {"reputation": 112, "user_id": 5200994, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4158aba18be472c19fe35e35495aa9c0?s=128&d=identicon&r=PG&f=1", "display_name": "Christopher Dermody-Lawrence", "link": "https://stackoverflow.com/users/5200994/christopher-dermody-lawrence"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1158, "favorite_count": 0, "accepted_answer_id": 33125656, "answer_count": 2, "score": 2, "last_activity_date": 1444907716, "creation_date": 1444821149, "last_edit_date": 1444825444, "question_id": 33123786, "link": "https://stackoverflow.com/questions/33123786/vba-excel-add-in-initialize-global-variables-on-load-not-in-workbooks", "title": "VBA Excel add in -- Initialize global variables on load -- not in workbooks", "body": "<p>I am creating an excel add-in that connects to functions and formulas set up on an API. \nTo use the API functions the user needs to log in and receive a Token.</p>\n\n<p>The Token is a global variable that is referenced whenever calling an API function.</p>\n\n<p>This add in will be used by many different workbooks so i'm trying to make it as easy as possible for the user to connect.</p>\n\n<p>At the moment i have a function that connects and stores the details in global variable so they only have to log in once. But every time they close and re open they have to log back in by calling the function and passing in the details.</p>\n\n<p><strong>Is there a way of accessing initialize workbook from an add-in?</strong></p>\n\n<p><strong>an on-load equivalent?</strong></p>\n\n<p><strong>Or getting add-in Functions to run on start up?</strong> without the user having to set up macros or custom functions, they can just add in and auto connect with their details.</p>\n\n<pre><code>'Is their an equivalent of\nSub New() /  Sub OnLoad()\n   Initalize()\nEnd sub\n</code></pre>\n\n<hr/>\n\n<p>I don't want the user to have to worry at all about whats going on behind they just have to load up the page with their username and password in defined cells or a function that references the username and password that even when the page is set to manual calculations it will recalculate on load.</p>\n\n<p>Any help would be appreciated thanks.</p>\n"}, {"tags": ["vba", "outlook"], "comments": [{"owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "edited": false, "score": 0, "creation_date": 1444841016, "post_id": 33123573, "comment_id": 54073697, "body": "I suggest you look for documentation/questions on <code>ActiveExplorer</code> which returns a collection of the currently selected mail items. This would allow you to select the mail items you wish to edit before starting a macro that processed each in turn.  To me this sounds closer to the functionality you seek than your current code."}, {"owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "edited": false, "score": 0, "creation_date": 1444841070, "post_id": 33123573, "comment_id": 54073730, "body": "Do you know the structure of the text bodies and/or html bodies of the mail items you wish to edit? If not my answer to this question may help: <a href=\"http://stackoverflow.com/a/12146315/973283\">How to copy Outlook mail message into excel using VBA or Macros</a>. This macro creates a workbook containing selected properties of mail items including the contents of their text bodies and html bodies."}], "answers": [{"tags": [], "owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "is_accepted": false, "score": 0, "last_activity_date": 1476220378, "creation_date": 1476220378, "answer_id": 39986828, "question_id": 33123573, "link": "https://stackoverflow.com/questions/33123573/how-to-script-outlok-text-editor-using-visual-basic/39986828#39986828", "title": "How to script Outlok text editor using Visual Basic?", "body": "<p>Try the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff868664.aspx\" rel=\"nofollow\">write</a> event. </p>\n\n<pre><code>Private WithEvents myItem As MailItem \n\nPrivate Sub Application_Startup()\n    Set myItem = ActiveInspector.CurrentItem \nEnd Sub\n\nPrivate Sub myItem_Write(Cancel As Boolean) \n    MsgBox \"Nope!\"\n    Cancel = True\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 41430, "user_id": 607407, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5a061a72feb5b6580dadd5dcbc92d3b5?s=128&d=identicon&r=PG", "display_name": "Tom&#225;\u0161 Zato - Reinstate Monica", "link": "https://stackoverflow.com/users/607407/tom%c3%a1%c5%a1-zato-reinstate-monica"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1028, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1593247931, "creation_date": 1444820403, "last_edit_date": 1593247931, "question_id": 33123573, "link": "https://stackoverflow.com/questions/33123573/how-to-script-outlok-text-editor-using-visual-basic", "title": "How to script Outlok text editor using Visual Basic?", "body": "<p>I want to perform some text replacements that are just too complicated for Automatic replacement feature of Microsoft outlook. Microsoft has rather extensive <a href=\"https://github.com/OfficeDev/VBA-content/tree/master/Outlook-VBA\" rel=\"nofollow noreferrer\">documentation on Microsoft Outlook VBA scripting</a> hosted on GitHub.</p>\n\n<p>I started by pressing <kbd>Alt</kbd>+<kbd>F11</kbd> which opened Visual Basic Editor. This is what I see in the project explorer:</p>\n\n<p><img src=\"https://i.stack.imgur.com/7x4zJ.png\" alt=\"image description\"></p>\n\n<p>Please note that I am not VBA programmer, so what I did afterwards probably looks stupid. I figured out that <code>OutlookOutlook</code> namespace represents all Outlook classes, so I just picked one of the classes that sounds like a text field:</p>\n\n<pre><code>Dim WithEvents textField As Outlook.OlkTextBox\n</code></pre>\n\n<p>And I created a dummy event that should fire before change in text field:</p>\n\n<pre><code>Private Sub textField_BeforeUpdate(Cancel As Boolean)\n    MsgBox \"Nope!\"\n    Cancel = True\nEnd Sub\n</code></pre>\n\n<p>Of course, when start outlook and edit message, the script doesn't get executed. So I suppose that for starter, I need to get a refference to actual text editor. How do I do that?</p>\n\n<p>My question basically is, how to get this code execute when I try to edit any outlook message:</p>\n\n<pre><code>    MsgBox \"Nope!\"\n    Cancel = True\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2282, "user_id": 3704475, "user_type": "registered", "accept_rate": 96, "profile_image": "https://lh6.googleusercontent.com/-F8g5oQDP6i4/AAAAAAAAAAI/AAAAAAAABys/zMyix6hW-5s/photo.jpg?sz=128", "display_name": "Amen Jlili", "link": "https://stackoverflow.com/users/3704475/amen-jlili"}, "edited": false, "score": 0, "creation_date": 1444819249, "post_id": 33122116, "comment_id": 54058930, "body": "Your question is not clear. What value are you talking about? Is it in the first or the last cell of data in that column? Please elaborate with an example so SO can help you."}, {"owner": {"reputation": 39, "user_id": 5444462, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7cad21cdaa0a014676b5b15bee29a7ad?s=128&d=identicon&r=PG&f=1", "display_name": "beng", "link": "https://stackoverflow.com/users/5444462/beng"}, "edited": false, "score": 0, "creation_date": 1444828221, "post_id": 33122116, "comment_id": 54064724, "body": "Simple integers such as 7, 8 19, 2 and -1, -2, -3; It would be looping through the values in column D starting at d2 (due to header) and matching against the cell next to it in column E if D is greater than E then delete that row."}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 2, "last_activity_date": 1444820244, "creation_date": 1444820244, "answer_id": 33123524, "question_id": 33122116, "link": "https://stackoverflow.com/questions/33122116/vba-delete-entire-row-if-value-in-1-column-is-greater-than-the-value-in-another/33123524#33123524", "title": "VBA Delete entire row if value in 1 column is greater than the value in another column", "body": "<p>When deleting rows, start at the bottom and work up or you may skip rows due to the renumbering associated with a newly deleted row.</p>\n\n<pre><code>Sub del_D_greater_than_E()\n    Dim rw As Long\n\n    With Worksheets(\"Sheet5\")   '&lt;~~ set this properly!\n        For rw = .Cells(Rows.Count, \"C\").End(xlUp).Row To 2 Step -1\n            If .Cells(rw, \"D\").Value2 &gt; .Cells(rw, \"E\").Value2 Then\n                .Rows(rw).EntireRow.Delete\n            End If\n        Next rw\n    End With\n\nEnd Sub\n</code></pre>\n\n<p>That should be enough to get you started. You may want to turn off screen updating and calculation during the operation.</p>\n"}], "owner": {"reputation": 39, "user_id": 5444462, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7cad21cdaa0a014676b5b15bee29a7ad?s=128&d=identicon&r=PG&f=1", "display_name": "beng", "link": "https://stackoverflow.com/users/5444462/beng"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1039, "favorite_count": 1, "accepted_answer_id": 33123524, "answer_count": 1, "score": 0, "last_activity_date": 1444820244, "creation_date": 1444816336, "question_id": 33122116, "link": "https://stackoverflow.com/questions/33122116/vba-delete-entire-row-if-value-in-1-column-is-greater-than-the-value-in-another", "title": "VBA Delete entire row if value in 1 column is greater than the value in another column", "body": "<p>I am new to VBA for excel and I am stuck with a little problem. I have to delete an entire row if the value in column D is greater than the value in column E.</p>\n\n<p>The list of data is very long and I will need the action to continue until the data in column C ends. Any help would be great!</p>\n"}, {"tags": ["vba", "excel", "listbox", "clipboard"], "answers": [{"tags": [], "owner": {"reputation": 4067, "user_id": 2970789, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dd4ed57e10989bdb3f3ac58326b7354?s=128&d=identicon&r=PG&f=1", "display_name": "Ambie", "link": "https://stackoverflow.com/users/2970789/ambie"}, "is_accepted": true, "score": 2, "last_activity_date": 1444821721, "creation_date": 1444821721, "answer_id": 33123982, "question_id": 33122019, "link": "https://stackoverflow.com/questions/33122019/adding-items-from-a-listbox-into-the-clipboard-in-a-excel-paste-friendly-format/33123982#33123982", "title": "Adding items from a listbox into the clipboard in a excel paste friendly format", "body": "<p>Separate your string with <code>Tab</code> in each line and it'll work. Like so:</p>\n\n<pre><code>Dim I As Long\nDim J As Long\nDim textItem As String\nDim copyText As String\nDim clipboard As DataObject\n\nFor J = 0 To lbIPActions.ListCount - 1\n    For I = 0 To lbIPActions.ColumnCount - 1\n        textItem = vbNullString\n        On Error Resume Next ' Handles null values\n        textItem = lbIPActions.Column(I, J)\n        On Error GoTo 0\n        If I &gt; 0 Then copyText = copyText &amp; vbTab\n        copyText = copyText &amp; textItem\n    Next I\n    If J &lt; lbIPActions.ListCount - 1 Then copyText = copyText &amp; vbNewLine\nNext J\n\nClipBoard_SetData clipboardText\n</code></pre>\n"}], "owner": {"reputation": 155, "user_id": 2953175, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2f0500ba05552072c5d8813884535839?s=128&d=identicon&r=PG&f=1", "display_name": "ppw", "link": "https://stackoverflow.com/users/2953175/ppw"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1685, "favorite_count": 0, "accepted_answer_id": 33123982, "answer_count": 1, "score": 1, "last_activity_date": 1444821721, "creation_date": 1444816091, "question_id": 33122019, "link": "https://stackoverflow.com/questions/33122019/adding-items-from-a-listbox-into-the-clipboard-in-a-excel-paste-friendly-format", "title": "Adding items from a listbox into the clipboard in a excel paste friendly format", "body": "<p><strong>The Aim:</strong> using VBA (excel) to populate the clipboard with a table (from a listbox) in an excel friendly format so that I can then paste (ctrl+V) into excel and the values are split into the correct columns and rows as they were in the original listbox.</p>\n\n<p><strong>The Problem:</strong> I can't seem to get the formatting right; when I paste the contents of my clipboard into excel each row is contained in one cell (the first column) separated with \",\" (which is what I have tried to use as a sort of \"delimiter\" - not sure if this is correct or not?)</p>\n\n<p>I am using the API workaround method to populate the clipboard and I don't want to wall you to death with code but here is the most important bit (I feel anyway - ask me if you need to see more code).</p>\n\n<pre><code>Private Sub btnCopyTable_Click()    \n\nDim I As Long\nDim J As Long\nDim tmp As String\nDim arrItems() As String\nDim clipboard As DataObject\n\nReDim arrItems(0 To lbIPActions.ColumnCount - 1)\nFor J = 0 To lbIPActions.ListCount - 1\n    For I = 0 To lbIPActions.ColumnCount - 1\n        On Error Resume Next ' Handles null values\n        arrItems(I) = lbIPActions.Column(I, J)\n        On Error GoTo 0\n    Next I\n    tmp = tmp &amp; Join(arrItems, \",\") &amp; vbCrLf\nNext J\n\nMsgBox tmp\n\nClipBoard_SetData tmp\n\nEnd sub\n</code></pre>\n\n<p><strong>The Current Output:</strong></p>\n\n<pre><code>1,1,Low,Controls,,LS,Do this,02-Oct-2015,Note 1,Brev\n2,1,Low,Controls,,LS,Do that,02-Oct-2015,Note 2,Brev\n</code></pre>\n\n<p><strong>The Current State:</strong> I have had a little look around and found a way to do it in code to a specific sheet, but my end user requires the freedom to copy it into numerous sheets in a very ad hoc fashion. I know there is always the option to right click -> import text wizard, but again ctrl+V is the preferred method if possible.</p>\n\n<p>As always, any help/advice is appreciated, thanks in advance.</p>\n"}, {"tags": ["vba", "sap-gui"], "answers": [{"tags": [], "owner": {"reputation": 31, "user_id": 7042864, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aa4c23f83005b8f6792e96855915cd91?s=128&d=identicon&r=PG&f=1", "display_name": "Roman Gasser", "link": "https://stackoverflow.com/users/7042864/roman-gasser"}, "is_accepted": false, "score": 3, "last_activity_date": 1606124235, "last_edit_date": 1606124235, "creation_date": 1476886970, "answer_id": 40134150, "question_id": 33121889, "link": "https://stackoverflow.com/questions/33121889/sap-gui-scripting-gridview-find-text-in-a-given-column-and-doubleclick-the-c/40134150#40134150", "title": "SAP GUI scripting - Gridview - Find text in a given column and doubleclick the cell", "body": "<p>You have to select the cell before double clicking:</p>\n<pre><code>If grid.GetCellValue(i, columnname) = texttofind Then\n    grid.SetCurrentCell(i, columnname)\n    grid.DoubleClickCurrentCell\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 2465, "user_id": 2570277, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0483cce5f2ea53671a36477fed79898b?s=128&d=identicon&r=PG", "display_name": "Nick", "link": "https://stackoverflow.com/users/2570277/nick"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 10166, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1610052953, "creation_date": 1444815773, "last_edit_date": 1610052953, "question_id": 33121889, "link": "https://stackoverflow.com/questions/33121889/sap-gui-scripting-gridview-find-text-in-a-given-column-and-doubleclick-the-c", "title": "SAP GUI scripting - Gridview - Find text in a given column and doubleclick the cell", "body": "<p>I m using excel VBA to try and automate some SAP data entry.</p>\n\n<p>I have a gridview control that I m trying to find specific text in a column, then double-clicked that cell to select it.</p>\n\n<p>I m currently using a for loop to find the row but getting some strange result. When I step through the code, I can get to the row but cannot select or double-click it. When the code runs at the usual speed, the row is not even selected!</p>\n\n<p>Is there a better way to go about this?</p>\n\n<p>This is the code is have so far</p>\n\n<pre><code> Function SelectRowOnGrid(grid As SAPFEWSELib.GuiGridView, columnname As String, texttofind As String) \n\n        For i = 0 To grid.RowCount - 1\n\n            If grid.GetCellValue(i, columnname) = texttofind Then\n                grid.DoubleClickCurrentCell\n            End If\n\n        Next i\n\nEnd Function\n</code></pre>\n\n<p>I have also tried the following code:</p>\n\n<pre><code>    Function SelectRowOnGrid(grid As SAPFEWSELib.GuiGridView, columnname As String, texttofind As String)\n\n        For i = 0 To grid.RowCount - 1\n\n          If InStr(1, grid.GetCellValue(i, columnname), texttofind, 1) &gt; 0 Then\n\n            If selectedRows = \"\" Then\n              selectedRows = CStr(i)\n                Else\n              selectedRows = selectedRows + \",\" + CStr(i)\n            End If\n\n          End If\n\n        Next i\n\n    grid.selectedRows = selectedRows\n\nEnd Function\n</code></pre>\n\n<p>Any help is appreciated !</p>\n\n<p>cheers</p>\n"}, {"tags": ["sql", "ms-access", "vba"], "answers": [{"comments": [{"owner": {"reputation": 1482, "user_id": 5043393, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/effb702a40d17cd670f56f051847b33f?s=128&d=identicon&r=PG&f=1", "display_name": "LiamH", "link": "https://stackoverflow.com/users/5043393/liamh"}, "edited": false, "score": 0, "creation_date": 1444818316, "post_id": 33122808, "comment_id": 54058319, "body": "and then I refer to this is as <code>if rs2.recordcount&gt;1</code>?"}, {"owner": {"reputation": 1482, "user_id": 5043393, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/effb702a40d17cd670f56f051847b33f?s=128&d=identicon&r=PG&f=1", "display_name": "LiamH", "link": "https://stackoverflow.com/users/5043393/liamh"}, "edited": false, "score": 0, "creation_date": 1444822679, "post_id": 33122808, "comment_id": 54061035, "body": "it looks to be working perfectly! As in a lot of cases, this turned out to be a lot easier than expected."}], "tags": [], "owner": {"reputation": 22957, "user_id": 78522, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3facb4a672d9fbeb9f2ed6b5acc65633?s=128&d=identicon&r=PG", "display_name": "Patrick Honorez", "link": "https://stackoverflow.com/users/78522/patrick-honorez"}, "is_accepted": true, "score": 0, "last_activity_date": 1444818148, "creation_date": 1444818148, "answer_id": 33122808, "question_id": 33121817, "link": "https://stackoverflow.com/questions/33121817/ms-access-vba-query-select-followed-by-a-count-of-the-result/33122808#33122808", "title": "MS Access VBA query. Select followed by a count of the result", "body": "<p>From memory:</p>\n\n<pre><code>rs.movelast\ndebug.print rs.recordCount\n</code></pre>\n\n<p>You must always <code>Movelast</code> before using <code>RecordCount</code>. I your table/query is big, it can be time consuming.</p>\n"}, {"tags": [], "owner": {"reputation": 933, "user_id": 5345818, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f648ca9f16c3a02a085cf79fa59c282?s=128&d=identicon&r=PG", "display_name": "asdev", "link": "https://stackoverflow.com/users/5345818/asdev"}, "is_accepted": false, "score": 2, "last_activity_date": 1444818224, "creation_date": 1444818224, "answer_id": 33122828, "question_id": 33121817, "link": "https://stackoverflow.com/questions/33121817/ms-access-vba-query-select-followed-by-a-count-of-the-result/33122828#33122828", "title": "MS Access VBA query. Select followed by a count of the result", "body": "<p>There are several ways:</p>\n\n<ol>\n<li>Create a query with COUNT function (similar as you did in refered question) </li>\n<li>Use your query, use the <code>rs2.movelast</code> and read count out with <code>rs2.RecordCount</code></li>\n<li><p>Use domain count </p>\n\n<p><code>Dim lngRows As Long\nlngRows = DCount(\"*\", \"Inventory\", \"Part_ID='\" &amp; rs!Part_ID &amp; \"'\")</code></p></li>\n</ol>\n"}], "owner": {"reputation": 1482, "user_id": 5043393, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/effb702a40d17cd670f56f051847b33f?s=128&d=identicon&r=PG&f=1", "display_name": "LiamH", "link": "https://stackoverflow.com/users/5043393/liamh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 179, "favorite_count": 0, "accepted_answer_id": 33122808, "answer_count": 2, "score": 1, "last_activity_date": 1444818224, "creation_date": 1444815578, "last_edit_date": 1495542579, "question_id": 33121817, "link": "https://stackoverflow.com/questions/33121817/ms-access-vba-query-select-followed-by-a-count-of-the-result", "title": "MS Access VBA query. Select followed by a count of the result", "body": "<p>I have asked a similar <a href=\"https://stackoverflow.com/questions/33081784/select-and-count-query-in-vba-access-2010\">question</a> recently. However, I don't think I knew the extent of what I was wanting to accomplish with my VBA at that time. I am using Access 2010 and creating an on_click command within a form.</p>\n\n<p>So my intention is to create a query, and the approach I was going to take was as follows:</p>\n\n<pre><code>varSQL2 = \"SELECT * FROM Inventory WHERE Part_ID=\" &amp; rs!Part_ID &amp; \";\"\nSet rs2 = db.OpenRecordset(varSQL2, dbOpenDynaset)\nvarStock_Level = rs2!Stock_Level +rs!Quantity\n</code></pre>\n\n<p>the <code>rs!quantity</code> and <code>rs!Part_ID</code> are from another query earlier in my code. <code>stock_level</code> and <code>part_ID</code> are fields in the <code>Inventory</code> table. </p>\n\n<p>I now need to be able to create a query to count how many records came back as a result of varSQL2. so I can do something along the lines of:</p>\n\n<pre><code>varSQL2 = \"SELECT * FROM Inventory WHERE Part_ID=\" &amp; rs!Part_ID &amp; \";\"\nSet rs2 = db.OpenRecordset(varSQL2, dbOpenDynaset)\nvarStock_Level = rs2!Stock_Level +rs!Quantity\n    if count &gt;1 then \n      ....[code]....\n    end if\n</code></pre>\n\n<p>I don't really know where to start with this, slightly confused my self with subqueries. I believe I need 2 queries not one. Any help is appreciated.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 47, "user_id": 5444177, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e85032b621a4b2e3c2655dcc12a3c7e7?s=128&d=identicon&r=PG", "display_name": "quant1", "link": "https://stackoverflow.com/users/5444177/quant1"}, "edited": false, "score": 0, "creation_date": 1444814767, "post_id": 33121170, "comment_id": 54055956, "body": "Hi Martin, Its not clear why this shows this error ?"}, {"owner": {"reputation": 1985, "user_id": 3160820, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/Y9E28.jpg?s=128&g=1", "display_name": "Trimax", "link": "https://stackoverflow.com/users/3160820/trimax"}, "edited": false, "score": 0, "creation_date": 1444824292, "post_id": 33121170, "comment_id": 54061976, "body": "Are you passing all the six arguments in the UDF?"}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1444824445, "post_id": 33121170, "comment_id": 54062080, "body": "Are the two questions you&#39;ve asked not duplicates?  They&#39;re questions based on the same piece of code - <a href=\"http://stackoverflow.com/questions/33120311/duplication-error-in-current-scope-vba-code\" title=\"duplication error in current scope vba code\">stackoverflow.com/questions/33120311/&hellip;</a>"}, {"owner": {"reputation": 2802, "user_id": 5030088, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42b4cbf19eede28c5a89c26349b15b02?s=128&d=identicon&r=PG&f=1", "display_name": "xidgel", "link": "https://stackoverflow.com/users/5030088/xidgel"}, "edited": false, "score": 0, "creation_date": 1444839751, "post_id": 33121170, "comment_id": 54073005, "body": "Could be square root of a negative. Is the function called with negative dt, Actualvol, or nSim? Could the <code>Actualvol = ...</code> line drive Actualvol negative during execution of the the iteration loops?"}, {"owner": {"reputation": 47, "user_id": 5444177, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e85032b621a4b2e3c2655dcc12a3c7e7?s=128&d=identicon&r=PG", "display_name": "quant1", "link": "https://stackoverflow.com/users/5444177/quant1"}, "edited": false, "score": 0, "creation_date": 1444931154, "post_id": 33121170, "comment_id": 54119393, "body": "They are the same type pf codes but not exactly the same Darren."}, {"owner": {"reputation": 47, "user_id": 5444177, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e85032b621a4b2e3c2655dcc12a3c7e7?s=128&d=identicon&r=PG", "display_name": "quant1", "link": "https://stackoverflow.com/users/5444177/quant1"}, "edited": false, "score": 0, "creation_date": 1444931339, "post_id": 33121170, "comment_id": 54119472, "body": "I got it fixed. There was just a line  missing to be added more .i.e. initial value of Actualvol for each simulation.Thanks all."}], "owner": {"reputation": 47, "user_id": 5444177, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e85032b621a4b2e3c2655dcc12a3c7e7?s=128&d=identicon&r=PG", "display_name": "quant1", "link": "https://stackoverflow.com/users/5444177/quant1"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 35, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1444814014, "creation_date": 1444813869, "last_edit_date": 1531164843, "question_id": 33121170, "link": "https://stackoverflow.com/questions/33121170/error-value-in-excel-vba-code", "title": "Error #Value! in Excel VBA code", "body": "<pre><code>Function Heston(Actualvol As Double, m As Double, theta As Double, col As Double, nSim As Long, nStep As Long) As Double\n    Dim FinalVol As Double, VT As Double, i As Integer, j As Integer, dt As Double, sum As Double\n\n    dt = 1 / 252\n\n    For i = 1 To nSim\n        For j = 0 To nStep\n            Actualvol = Actualvol + m * (theta - Actualvol) * dt + col * Sqr(Actualvol) * Application.NormInv(Rnd(), 0, 1) * Sqr(dt)\n        Next\n\n        sum = sum + Actualvol\n    Next\n\n    FinalVol = Sqr(sum)\n    Heston = FinalVol / Sqr(nSim)\nEnd Function\n</code></pre>\n\n<p>Please check this why it shows #Value! in the ExcelSheet ?</p>\n"}, {"tags": ["vba", "excel", "csv"], "comments": [{"owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "edited": false, "score": 0, "creation_date": 1444856521, "post_id": 33120961, "comment_id": 54082639, "body": "What is the file referenced in <code>EOF(1)</code>?  Where do you read data from a file?"}, {"owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "edited": false, "score": 0, "creation_date": 1444857061, "post_id": 33120961, "comment_id": 54082895, "body": "In general it is not possible to update a text file because a new record will be a different length from the old record.  Normal practice is to loop reading records from file A and writing the changed records to file B. File B could have a new version number or file A could be renamed with suffix &quot;Old&quot; while file B is renamed to the original name of file A."}], "answers": [{"tags": [], "owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "is_accepted": false, "score": 1, "last_activity_date": 1444866088, "creation_date": 1444866088, "answer_id": 33137498, "question_id": 33120961, "link": "https://stackoverflow.com/questions/33120961/how-can-i-edit-a-currently-existing-csv-file-at-specific-rows-in-vba/33137498#33137498", "title": "How can I edit a currently existing .csv file at specific rows in VBA?", "body": "<p>This will update line 2 in Test.csv</p>\n\n<pre><code>Option Explicit\n\nPublic Sub updateCSVLine()\n    Dim fName As String, fso As Object, fsoFile As Object, txt As Variant\n\n    Set fso = CreateObject(\"Scripting.FileSystemObject\")\n\n    Set fsoFile = fso.OpenTextFile(\"C:\\Test.csv\", 1)\n    txt = fsoFile.ReadAll\n    fsoFile.Close\n\n    txt = Split(txt, vbNewLine)\n\n    txt(2 - 1) = \".. valX, .. valY, .. valZ\"\n\n    Set fsoFile = fso.OpenTextFile(\"C:\\Test.csv\", 2)\n    fsoFile.Write Join(txt, vbNewLine)\n    fsoFile.Close\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p>Before:</p>\n\n<pre><code>l1 val1, l1 val2, l1 val3\nl2 val1, l2 val2, l2 val3\nl3 val1, l3 val2, l3 val3\n</code></pre>\n\n<p>After:</p>\n\n<pre><code>l1 val1, l1 val2, l1 val3\n.. valX, .. valY, .. valZ\nl3 val1, l3 val2, l3 val3\n</code></pre>\n"}], "owner": {"reputation": 65, "user_id": 5444224, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b868bc8b92c07a45c1758b1d0d1cab36?s=128&d=identicon&r=PG&f=1", "display_name": "Awesomasaurus", "link": "https://stackoverflow.com/users/5444224/awesomasaurus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4733, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1444866088, "creation_date": 1444813242, "question_id": 33120961, "link": "https://stackoverflow.com/questions/33120961/how-can-i-edit-a-currently-existing-csv-file-at-specific-rows-in-vba", "title": "How can I edit a currently existing .csv file at specific rows in VBA?", "body": "<p>So I am trying to write some code in a workbook that will open a file in a certain filepath using VBA, find data that exists in a row with a certain row number and then overwrite those rows given that row number. I am aware of the \"Open File For Input/Output/Append\" functions but \"Input\" only reads, \"Output\" overwrites all the data in my file and \"Append\" only adds data to the end of the file. I have been stuck for a while now and could really use some help. Here is my current code segment:</p>\n\n<pre><code>Open Filepath For Output As #2\n    ExternalRowCount = 0 ' Row number where I want to start writing data.\n    ArrayRef = 0 ' Array Index for data\n\n    Do Until EOF(1)\n        ExternalRowCount = ExternalRowCount + 1\n        If ExternalRowCount &gt;= Found And ExternalRowCount &lt; (Found + 100) Then ' looping through rows to get to my desired location (\"Found\" is my desired row number)\n            CellData = arr1(ArrayRef)\n            CellDataTwo = arr2(ArrayRef)\n            Write #2, CellData, CellDataTwo\n            ArrayRef = ArrayRef + 1\n        End If\n    Loop\nClose #2\n</code></pre>\n\n<p>Any help would be greatly appreciated! Thank you</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 477, "user_id": 3894744, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8wZhi.jpg?s=128&g=1", "display_name": "WouldBeNerd", "link": "https://stackoverflow.com/users/3894744/wouldbenerd"}, "edited": false, "score": 2, "creation_date": 1444813448, "post_id": 33120923, "comment_id": 54055040, "body": "My guess would be a spelling issue, seems most likely judging by the huge sheetname array youve made. Double check the spelling of those. Out of range errors for me usually means I&#39;ve spelled something wrong or I&#39;m trying to iterate over col or row number 0 which dont exist."}, {"owner": {"reputation": 477, "user_id": 3894744, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8wZhi.jpg?s=128&g=1", "display_name": "WouldBeNerd", "link": "https://stackoverflow.com/users/3894744/wouldbenerd"}, "edited": false, "score": 0, "creation_date": 1444813616, "post_id": 33120923, "comment_id": 54055171, "body": "Also you should probably show where in your code &#39;shtSelections&#39; is defined."}, {"owner": {"reputation": 4067, "user_id": 2970789, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dd4ed57e10989bdb3f3ac58326b7354?s=128&d=identicon&r=PG&f=1", "display_name": "Ambie", "link": "https://stackoverflow.com/users/2970789/ambie"}, "reply_to_user": {"reputation": 477, "user_id": 3894744, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8wZhi.jpg?s=128&g=1", "display_name": "WouldBeNerd", "link": "https://stackoverflow.com/users/3894744/wouldbenerd"}, "edited": false, "score": 0, "creation_date": 1444818272, "post_id": 33120923, "comment_id": 54058285, "body": "Agree with @WouldBeNerd, but Err 9 will also be thrown if these sheets are on a different workbook than your active one, so make sure the parent of <code>Worksheets</code> is set too."}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 5442702, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/73252a21a48d05ff7394a90636724ffb?s=128&d=identicon&r=PG", "display_name": "user5442702", "link": "https://stackoverflow.com/users/5442702/user5442702"}, "is_accepted": false, "score": 0, "last_activity_date": 1444813523, "creation_date": 1444813523, "answer_id": 33121067, "question_id": 33120923, "link": "https://stackoverflow.com/questions/33120923/looping-thru-specified-sheets/33121067#33121067", "title": "Looping thru specified sheets", "body": "<p>perhaps will you associate a row with marking flag. So you use the second auto var in loop. <em>intRowCount</em> instad of <em>intStartRow</em>.</p>\n\n<p>.Cells(intRowCount, 1) = shtSelections.Cells(intRowCount, 1)</p>\n"}], "owner": {"reputation": 1, "user_id": 5444287, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7564cb1dd6d3b9d41d239cb3a35c1544?s=128&d=identicon&r=PG&f=1", "display_name": "Adam ", "link": "https://stackoverflow.com/users/5444287/adam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 20, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1444815469, "creation_date": 1444813122, "last_edit_date": 1531164843, "question_id": 33120923, "link": "https://stackoverflow.com/questions/33120923/looping-thru-specified-sheets", "title": "Looping thru specified sheets", "body": "<p>I am trying to loop through specified worksheets in a workbook and assign labels etc. I get the message \"Run-time error '9' Subscript out of range. Here is the code that I am using...</p>\n\n<pre><code>Sub Labels()\n\nDim intStartRow As Integer\nDim intRowCount As Integer\nDim intRow As Integer\nDim WshtNames As Variant\nDim intSheet As Variant\n\nintStartRow = 32\n\nWshtNames = Array(\"shtAngola\", \"shtBotswana\", \"shtMozambique\", \"shtNamibia\", \"shtSA\", \"shtZambia\", \"shtZimbabwe\", \"shtEritrea\", \"shtEthiopia\", \"shtKenya\", \"shtRwanda\", \"shtTanzania\", \"shtUganda\", \"shtAlgeria\", \"shtEgypt\", \"shtMorocco\", \"shtTunisia\", \"shtGhana\", \"shtIvoryCoast\", \"shtMauritius\", \"shtNigeria\", \"shtSenegal\")\n\nFor Each intSheet In WshtNames\n\n   With Worksheets(intSheet)\n\n      For intRowCount = 7 To 21\n           For intRow = 1 To 3\n               .Cells(intStartRow, 1) = shtSelections.Cells(intRowCount, 1)\n</code></pre>\n\n<p>Would be very grateful for your help.</p>\n\n<p>Best,\nAdam</p>\n"}, {"tags": ["excel", "excel-formula", "vba"], "comments": [{"owner": {"reputation": 171, "user_id": 1731551, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/948d680690f1e99f62be249c270f588c?s=128&d=identicon&r=PG", "display_name": "therak", "link": "https://stackoverflow.com/users/1731551/therak"}, "edited": false, "score": 0, "creation_date": 1444813373, "post_id": 33120673, "comment_id": 54054980, "body": "Easy answer: Yes. Not that i want to insinuate something - but this sounds so much like an assigned homework. Please see the <a href=\"http://stackoverflow.com/help/how-to-ask\">How to ask</a> - and explain what you have tried so far (we&#39;re here to help not to do the work for you...)"}], "answers": [{"tags": [], "owner": {"reputation": 3650, "user_id": 5090027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/904db949ae64fe1a63ea8b4c677e6d57?s=128&d=identicon&r=PG&f=1", "display_name": "Grade &#39;Eh&#39; Bacon", "link": "https://stackoverflow.com/users/5090027/grade-eh-bacon"}, "is_accepted": true, "score": 0, "last_activity_date": 1444836574, "creation_date": 1444836574, "answer_id": 33129533, "question_id": 33120673, "link": "https://stackoverflow.com/questions/33120673/show-hide-a-certain-number-of-excel-rows-based-on-cell-value/33129533#33129533", "title": "Show/hide a certain number of Excel rows based on cell value", "body": "<p>Recommendation: Don't bother using VBA to hide rows automatically - instead, use conditional formatting to simply blank any cells which don't have data. This is simpler, and doesn't require your workbook to be macro-enabled.</p>\n\n<p>For example - assume rows 11-22 are months from Jan-Dec. Assume Column A is, for example, the amount of interest paid in that period, based on a formula. We know that if there is no interest paid in the period, that period is not relevant, so the entire row can be hidden based on whether column A = 0. </p>\n\n<p>Select rows 11-22, for as many columns as you have data (let's say column A - column G). Click on the Conditional Formatting button, and Add New Rule. Click the last option of the rule types, 'add custom rule', with the formula:</p>\n\n<pre><code>=$A11=0\n</code></pre>\n\n<p>Whenever column A equals 0, for each specific row, the rule for that row will say TRUE. So go to the Formatting Options of the conditional format rule, and make the font white, and the background white, and the borders gone.</p>\n"}], "owner": {"reputation": 3, "user_id": 4939677, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e15740128c462a83365ae00cd333633?s=128&d=identicon&r=PG&f=1", "display_name": "El Nic", "link": "https://stackoverflow.com/users/4939677/el-nic"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 984, "favorite_count": 0, "accepted_answer_id": 33129533, "answer_count": 1, "score": -1, "last_activity_date": 1444836574, "creation_date": 1444812502, "last_edit_date": 1531161705, "question_id": 33120673, "link": "https://stackoverflow.com/questions/33120673/show-hide-a-certain-number-of-excel-rows-based-on-cell-value", "title": "Show/hide a certain number of Excel rows based on cell value", "body": "<p>I'm creating a loan repayment calculator schedule with Excel 2010, where the user inputs loan amount, interest rate and duration (in months), and the calculator returns the repayment value for each month. I would like the calculator to show/hide rows based on the duration of the loan (es. 12 months=show 12 rows). Is this possible?</p>\n"}, {"tags": ["vba", "ms-word"], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 5443769, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1346a7efae9aa7a19f44072bd0f9901?s=128&d=identicon&r=PG&f=1", "display_name": "Niklas", "link": "https://stackoverflow.com/users/5443769/niklas"}, "edited": false, "score": 0, "creation_date": 1444956690, "post_id": 33155088, "comment_id": 54130592, "body": "Thanks for the suggestions, I&#39;ll try play around with Result.Text as I haven&#39;t tried that yet. Field.Unlink unfortunately removes the field for the changed result as well. What I&#39;m trying to do is copy out the original result as text and retain the new crossreference. I&#39;ve been trying a variation of selecting the field, then doing a Selection.Collapse Direction:=wdCollapseEnd, and Selection.TypeText.  However, for some odd reason the typed text is typed INSIDE the field, so if the field is refreshed all the typed text is removed."}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "reply_to_user": {"reputation": 11, "user_id": 5443769, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1346a7efae9aa7a19f44072bd0f9901?s=128&d=identicon&r=PG&f=1", "display_name": "Niklas", "link": "https://stackoverflow.com/users/5443769/niklas"}, "edited": false, "score": 0, "creation_date": 1445021135, "post_id": 33155088, "comment_id": 54162104, "body": "1) You should be able to insert a new REF field to the same bookmark (those long numbers preceded by an underscore are hidden bookmark names). So if you want to keep the &quot;live&quot; cross-reference, store the bookmark name from the Field.Code before you unlink (delete) it."}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "reply_to_user": {"reputation": 11, "user_id": 5443769, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1346a7efae9aa7a19f44072bd0f9901?s=128&d=identicon&r=PG&f=1", "display_name": "Niklas", "link": "https://stackoverflow.com/users/5443769/niklas"}, "edited": false, "score": 0, "creation_date": 1445021196, "post_id": 33155088, "comment_id": 54162137, "body": "2) It might also work, with Track Changes off, to simply UPDATE the existing field after you&#39;ve &quot;captured&quot; the information you need."}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "reply_to_user": {"reputation": 11, "user_id": 5443769, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1346a7efae9aa7a19f44072bd0f9901?s=128&d=identicon&r=PG&f=1", "display_name": "Niklas", "link": "https://stackoverflow.com/users/5443769/niklas"}, "edited": false, "score": 0, "creation_date": 1445021300, "post_id": 33155088, "comment_id": 54162189, "body": "3) If you press Alt+F9 to toggle on the field codes you&#39;ll see the field&#39;s &quot;structures&quot;. When Selection is inside the field collapsing the Range may/probably leave/s the Selection within those structures. You might see if this gives a better result (pseudocode, and you&#39;ll need to separate this into code lines as Comments don&#39;t support writing code): Dim rng as Word.Range : Set rng = Field.Result : rng.Collapse wdCollapseEnd"}], "tags": [], "owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "is_accepted": false, "score": 0, "last_activity_date": 1444930857, "creation_date": 1444930857, "answer_id": 33155088, "question_id": 33119793, "link": "https://stackoverflow.com/questions/33119793/microsoft-word-vba-macro-to-convert-tracked-changes-to-cross-references-into-tex/33155088#33155088", "title": "Microsoft Word VBA macro to convert tracked changes to cross-references into text", "body": "<p>I haven't worked a lot with Revisions, so my suggestion may have drawbacks, however, it occurs to me that you might be able to do something with Field.Result.</p>\n\n<p>A cross-reference is a REF field, under the covers - press Alt+F9 and you can toggle on the field code view to see it.</p>\n\n<p>When code queries <code>ActiveDocument.Fields([index]).Result</code> a RANGE object is returned (a Range is returned for any Field.Result). <code>Result.Text</code> returns the visible result as plain text - in your example 65. </p>\n\n<p>In and of itself, that's not useful. But if you combine it with, perhaps, <code>Result.Revisions.Count</code> you can find out how many revisions (if any) are stored in the field. Using your example, <code>Count</code> returns two and you know the first (left) is the change and the second (right) is the original. That should let you figure out what the value should be. You could then remove the field (<code>Field.Unlink</code>) and write the desired result to the document?</p>\n"}], "owner": {"reputation": 11, "user_id": 5443769, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1346a7efae9aa7a19f44072bd0f9901?s=128&d=identicon&r=PG&f=1", "display_name": "Niklas", "link": "https://stackoverflow.com/users/5443769/niklas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 741, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1444930857, "creation_date": 1444809600, "last_edit_date": 1444836705, "question_id": 33119793, "link": "https://stackoverflow.com/questions/33119793/microsoft-word-vba-macro-to-convert-tracked-changes-to-cross-references-into-tex", "title": "Microsoft Word VBA macro to convert tracked changes to cross-references into text", "body": "<p>I need to convert tracked changes in Microsoft Word into actual text with the underline/strikethrough. I have had difficulties in dealing with tracked changes with cross-references. </p>\n\n<p>For instance, if a cross reference is updated, from paragraph 5 to 6, it would appear as \"6<strike>5</strike>\" [the 6 is underlined, but stackoverflow doesn't have that formatting option] I want to retain the 5 as raw text only, but keep the 6 as a cross-reference field.</p>\n\n<p>I've gotten as far as the following macro which will do what I want if the cross reference has been /replaced/ with a new cross reference. However, it still does not work properly if the cross reference was only updated. Any help would be greatly appreciated:</p>\n\n<pre><code>Sub TypeAndStrike()\n\nDim chgAdd As Word.Revision\nDim Colour\nColour = RGB(255, 0, 0) ' Set the color to change the changes to.\n'PD Colors: Black (0, 0, 0), Red (255, 0, 0), Green (0, 255, 0), Blue (0, 0, 255), Brown (165, 42, 42)\n\nDim SkipNext As Integer\n\n' disable tracked revisions.\nIf ActiveDocument.Revisions.Count = 0 Then\nMsgBox \"There are no revisions in this document\", vbOKOnly\nElse\nActiveDocument.TrackRevisions = False\n\nFor Each chgAdd In ActiveDocument.Revisions\nIf chgAdd.Type = wdRevisionDelete Then ' It's a deletion, so make it strike through and then reject the change (so the text isn't lost).\n\n    SkipNext = 0\n    chgAdd.Range.Select ' move insertion point\n\n    chgAdd.Range.Font.StrikeThrough = True\n    chgAdd.Range.Font.Color = Colour\n        For Each testRange In Selection.Range.Fields ' Replace cross-refs with &gt;text\n        testRange.Select\n        If Selection.Range = chgAdd.Range Then\n            SkipNext = 1\n        End If\n        Selection.TypeText Text:=Selection.Text\n        Next\n    If SkipNext = 0 Then\n    chgAdd.Range.Select\n    chgAdd.Reject\n    End If\n\nElseIf chgAdd.Type = wdRevisionInsert Then ' It's an addition, so underline it.\n\n    chgAdd.Range.Font.Underline = wdUnderlineSingle\n    chgAdd.Range.Font.Color = Colour\n    chgAdd.Accept\nElse\n    chgAdd.Range.Select ' move insertion point\nEnd If\n\nNext chgAdd\nEnd If\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-word", "openxml", "openxml-sdk"], "answers": [{"comments": [{"owner": {"reputation": 450, "user_id": 416501, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/11d6a52fa2851aba3308c5d8143be6d5?s=128&d=identicon&r=PG", "display_name": "August", "link": "https://stackoverflow.com/users/416501/august"}, "edited": false, "score": 0, "creation_date": 1446984620, "post_id": 33152467, "comment_id": 54962592, "body": "&quot;Bare necessities&quot; is creating a full document :/"}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "reply_to_user": {"reputation": 450, "user_id": 416501, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/11d6a52fa2851aba3308c5d8143be6d5?s=128&d=identicon&r=PG", "display_name": "August", "link": "https://stackoverflow.com/users/416501/august"}, "edited": false, "score": 0, "creation_date": 1447099219, "post_id": 33152467, "comment_id": 55008842, "body": "Full document, server-side: The Open XML (SDK) route is definitely the way to go! If you need to insert complete documents with formatting, look for information on using the &quot;altChunk&quot; technique which supports RTF, HTML and Word file formats. This is simplest to implement. If these are Word documents it&#39;s also fairly simple to &quot;stream&quot; the content into the target document."}], "tags": [], "owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "is_accepted": true, "score": 0, "last_activity_date": 1444922661, "creation_date": 1444922661, "answer_id": 33152467, "question_id": 33119609, "link": "https://stackoverflow.com/questions/33119609/easiest-way-to-add-raw-open-xml-code-to-a-word-document/33152467#33152467", "title": "Easiest way to add raw Open XML code to a Word document", "body": "<p>For the \"bare necessities\" see this MSDN article:\n<a href=\"https://msdn.microsoft.com/en-us/library/office/dn423225.aspx?f=255&amp;MSPPError=-2147217396\" rel=\"nofollow\">https://msdn.microsoft.com/en-us/library/office/dn423225.aspx?f=255&amp;MSPPError=-2147217396</a></p>\n\n<p>It describes what the minimum requirements are for inserting Open XML into an open Word document. Don't worry that the discussion targets Web add-ins - the principle is the same for any API that inserts WordOpenXML into a Word document at run-time.</p>\n\n<p>I may be misunderstanding where \"server-side\" is involved in your process, so forgive me if the following is not relevant to your situation: Note that using VBA server-side is a bad idea - Word is not designed to run in a server environment. Better would be to use the Open XML SDK both to retrieve and write the information between two Word documents.</p>\n"}], "owner": {"reputation": 450, "user_id": 416501, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/11d6a52fa2851aba3308c5d8143be6d5?s=128&d=identicon&r=PG", "display_name": "August", "link": "https://stackoverflow.com/users/416501/august"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1194, "favorite_count": 0, "accepted_answer_id": 33152467, "answer_count": 1, "score": 0, "last_activity_date": 1459761420, "creation_date": 1444809010, "last_edit_date": 1459761420, "question_id": 33119609, "link": "https://stackoverflow.com/questions/33119609/easiest-way-to-add-raw-open-xml-code-to-a-word-document", "title": "Easiest way to add raw Open XML code to a Word document", "body": "<p>I want to insert a chunk of formatted text into a Word document in VBA. Since this will be done server-side, I am not advised take these chunks from another Word document using Office Interop (<a href=\"https://support.microsoft.com/en-us/kb/257757#/en-us/kb/257757\" rel=\"nofollow\">link</a>), so I presume it would be easiest to use Open XML like this <code>&lt;w:p&gt;&lt;w:r&gt;&lt;w:t&gt;String from WriteToWordDoc method.&lt;/w:t&gt;&lt;/w:r&gt;&lt;/w:p&gt;</code> Sadly <code>Application.ActiveDocument.Range.InsertXML</code> fails. So what other quick and dirty alternatives do I have?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 12614, "user_id": 3566998, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S7lz6.png?s=128&g=1", "display_name": "Excel Hero", "link": "https://stackoverflow.com/users/3566998/excel-hero"}, "edited": false, "score": 0, "creation_date": 1444806128, "post_id": 33118607, "comment_id": 54050667, "body": "I see only text in the cells. Are there buttons there?"}, {"owner": {"reputation": 12614, "user_id": 3566998, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S7lz6.png?s=128&g=1", "display_name": "Excel Hero", "link": "https://stackoverflow.com/users/3566998/excel-hero"}, "edited": false, "score": 0, "creation_date": 1444806191, "post_id": 33118607, "comment_id": 54050704, "body": "Do the button names have a space character before the numeric portion?"}, {"owner": {"reputation": 171, "user_id": 5421582, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/3c83280fde3b4628c537a210ef323b42?s=128&d=identicon&r=PG&f=1", "display_name": "Yong", "link": "https://stackoverflow.com/users/5421582/yong"}, "reply_to_user": {"reputation": 12614, "user_id": 3566998, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S7lz6.png?s=128&g=1", "display_name": "Excel Hero", "link": "https://stackoverflow.com/users/3566998/excel-hero"}, "edited": false, "score": 0, "creation_date": 1444806203, "post_id": 33118607, "comment_id": 54050711, "body": "sorry I edited the post"}, {"owner": {"reputation": 171, "user_id": 5421582, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/3c83280fde3b4628c537a210ef323b42?s=128&d=identicon&r=PG&f=1", "display_name": "Yong", "link": "https://stackoverflow.com/users/5421582/yong"}, "reply_to_user": {"reputation": 12614, "user_id": 3566998, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S7lz6.png?s=128&g=1", "display_name": "Excel Hero", "link": "https://stackoverflow.com/users/3566998/excel-hero"}, "edited": false, "score": 0, "creation_date": 1444806230, "post_id": 33118607, "comment_id": 54050728, "body": "no it doesn&#39;t its like &quot;btn11&quot;"}, {"owner": {"reputation": 12614, "user_id": 3566998, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S7lz6.png?s=128&g=1", "display_name": "Excel Hero", "link": "https://stackoverflow.com/users/3566998/excel-hero"}, "edited": false, "score": 0, "creation_date": 1444806244, "post_id": 33118607, "comment_id": 54050735, "body": "If the user clicks a button in a cell, does that cell get selected?"}, {"owner": {"reputation": 171, "user_id": 5421582, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/3c83280fde3b4628c537a210ef323b42?s=128&d=identicon&r=PG&f=1", "display_name": "Yong", "link": "https://stackoverflow.com/users/5421582/yong"}, "reply_to_user": {"reputation": 12614, "user_id": 3566998, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S7lz6.png?s=128&g=1", "display_name": "Excel Hero", "link": "https://stackoverflow.com/users/3566998/excel-hero"}, "edited": false, "score": 0, "creation_date": 1444806287, "post_id": 33118607, "comment_id": 54050753, "body": "no, the button gets activated:)"}, {"owner": {"reputation": 12614, "user_id": 3566998, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S7lz6.png?s=128&g=1", "display_name": "Excel Hero", "link": "https://stackoverflow.com/users/3566998/excel-hero"}, "edited": false, "score": 0, "creation_date": 1444806593, "post_id": 33118607, "comment_id": 54050910, "body": "Is the button a Form Control and have you assigned a macro to it?"}], "answers": [{"comments": [{"owner": {"reputation": 171, "user_id": 5421582, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/3c83280fde3b4628c537a210ef323b42?s=128&d=identicon&r=PG&f=1", "display_name": "Yong", "link": "https://stackoverflow.com/users/5421582/yong"}, "edited": false, "score": 0, "creation_date": 1444807148, "post_id": 33118914, "comment_id": 54051228, "body": "Sorry to bother you again but is there a way to assign the macro to all the buttons without having to do it one by one manually?"}, {"owner": {"reputation": 171, "user_id": 5421582, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/3c83280fde3b4628c537a210ef323b42?s=128&d=identicon&r=PG&f=1", "display_name": "Yong", "link": "https://stackoverflow.com/users/5421582/yong"}, "edited": false, "score": 0, "creation_date": 1444807351, "post_id": 33118914, "comment_id": 54051348, "body": ";P I am not familiar with the site, sorry about that"}, {"owner": {"reputation": 12614, "user_id": 3566998, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S7lz6.png?s=128&g=1", "display_name": "Excel Hero", "link": "https://stackoverflow.com/users/3566998/excel-hero"}, "reply_to_user": {"reputation": 171, "user_id": 5421582, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/3c83280fde3b4628c537a210ef323b42?s=128&d=identicon&r=PG&f=1", "display_name": "Yong", "link": "https://stackoverflow.com/users/5421582/yong"}, "edited": false, "score": 0, "creation_date": 1444808140, "post_id": 33118914, "comment_id": 54051855, "body": "@Yong Are you still there? I have written a procedure for you to automate the process of assigning the macro to all of the buttons."}, {"owner": {"reputation": 171, "user_id": 5421582, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/3c83280fde3b4628c537a210ef323b42?s=128&d=identicon&r=PG&f=1", "display_name": "Yong", "link": "https://stackoverflow.com/users/5421582/yong"}, "edited": false, "score": 0, "creation_date": 1444808320, "post_id": 33118914, "comment_id": 54051971, "body": "Yes, struggling to figure this out:)"}], "tags": [], "owner": {"reputation": 12614, "user_id": 3566998, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S7lz6.png?s=128&g=1", "display_name": "Excel Hero", "link": "https://stackoverflow.com/users/3566998/excel-hero"}, "is_accepted": true, "score": 1, "last_activity_date": 1444808789, "last_edit_date": 1444808789, "creation_date": 1444806838, "answer_id": 33118914, "question_id": 33118607, "link": "https://stackoverflow.com/questions/33118607/vba-button-in-a-cell-msgbox-the-cells-row-and-column/33118914#33118914", "title": "(VBA) button in a cell, msgbox the cell&#39;s row and column", "body": "<p>Place the following routine in a standard code module and assign it as a macro to your buttons:</p>\n\n<pre><code>Sub DeleteButton()\n\n    ActiveSheet.Shapes(Application.Caller).Delete\n\nEnd Sub\n</code></pre>\n\n<p>To assign the above procedure as a macro to all of the buttons on the active sheet, run this procedure:</p>\n\n<pre><code>Sub AssignMacroToAllButtons()\n    Dim b As Shape\n    For Each b In ActiveSheet.Shapes\n        If b.Type = 8 Then\n            b.OnAction = \"DeleteButton\"\n        End If\n    Next\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 171, "user_id": 5421582, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/3c83280fde3b4628c537a210ef323b42?s=128&d=identicon&r=PG&f=1", "display_name": "Yong", "link": "https://stackoverflow.com/users/5421582/yong"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 307, "favorite_count": 0, "accepted_answer_id": 33118914, "answer_count": 1, "score": 2, "last_activity_date": 1444808789, "creation_date": 1444805894, "question_id": 33118607, "link": "https://stackoverflow.com/questions/33118607/vba-button-in-a-cell-msgbox-the-cells-row-and-column", "title": "(VBA) button in a cell, msgbox the cell&#39;s row and column", "body": "<p><a href=\"https://i.stack.imgur.com/YW0yI.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/YW0yI.png\" alt=\"enter image description here\"></a>\nI am writing a VBA that would :\nOnce, I click a button in the cell, extract the location of the cell(i.e. if row is 2 and column is 1, 21) so that I can use it to delete the button\n*the button is filling the entire cell</p>\n\n<p>I tried using </p>\n\n<blockquote>\n<pre><code>  c = ActiveCell.Column &amp; ActiveCell.Row\n  ActiveSheet.Shapes.Range(Array(\"Btn\" &amp; c).Select\n  Selection.Delete\n</code></pre>\n</blockquote>\n\n<p>but doesn't seem to work.</p>\n"}, {"tags": ["excel", "logging", "vba"], "comments": [{"owner": {"reputation": 171, "user_id": 1731551, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/948d680690f1e99f62be249c270f588c?s=128&d=identicon&r=PG", "display_name": "therak", "link": "https://stackoverflow.com/users/1731551/therak"}, "edited": false, "score": 0, "creation_date": 1444808104, "post_id": 33118467, "comment_id": 54051832, "body": "don&#39;t see the real question here - if you run the script what is keeping you from writing the cell value to another sheet after everything is finished?"}], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 5413625, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/b8d046ca34284a7d0420216ee53368d6?s=128&d=identicon&r=PG&f=1", "display_name": "S.Joesan", "link": "https://stackoverflow.com/users/5413625/s-joesan"}, "edited": false, "score": 0, "creation_date": 1444896306, "post_id": 33120489, "comment_id": 54096110, "body": "Doesn&#39;t really work for me. To give more exact information maybe you can modify it? Sheet 1 has a value in cell E15 which updates every hour. This is the production volume / hour at our customer. This needs to be logged since we want to track the ups and downs in the pace. The value needs to be copied once a hour to Sheet 2 A1 and descending. Im not used to vbs scripts and are just trying to modify and add things on demand since I was not the original developer for this workbook."}, {"owner": {"reputation": 33, "user_id": 5413625, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/b8d046ca34284a7d0420216ee53368d6?s=128&d=identicon&r=PG&f=1", "display_name": "S.Joesan", "link": "https://stackoverflow.com/users/5413625/s-joesan"}, "edited": false, "score": 0, "creation_date": 1444979601, "post_id": 33120489, "comment_id": 54137672, "body": "Great! Since it didn&#39;t work in the actual sheet Im using I will have to do some digging. Since we have gpo&#39;s restricting use of unsigned macros I have to open Excel with my admin account in order to run. Nevertheless, I created a new Excel file with only values in the cell and then it works. Thank you very much."}], "tags": [], "owner": {"reputation": 143, "user_id": 5023141, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/73e4102f195847ce8cdd617c722fba4c?s=128&d=identicon&r=PG&f=1", "display_name": "Calum", "link": "https://stackoverflow.com/users/5023141/calum"}, "is_accepted": true, "score": 0, "last_activity_date": 1444897660, "last_edit_date": 1444897660, "creation_date": 1444811909, "answer_id": 33120489, "question_id": 33118467, "link": "https://stackoverflow.com/questions/33118467/log-vaule-in-excel-cell/33120489#33120489", "title": "log vaule in excel cell", "body": "<p>Please see <strong>edited answer</strong></p>\n\n<p>When you open the sheet you hit the start timer button, then when you want it to stop press the stop timer.. this will copy the value from E15 to Sheet 2 A1 and below every 1 hour 1 second.</p>\n\n<p>Taken and edited from <a href=\"http://www.mrexcel.com/forum/excel-questions/379070-simple-copy-update-cell-value-every-minute.html\" rel=\"nofollow\">here</a></p>\n\n<p>Please make sure you make a copy and try it on that first.</p>\n\n<ol>\n<li>Open up your workbook</li>\n<li>Get into VB Editor (Press Alt+F11)</li>\n<li>Insert a new module (Insert > Module)</li>\n<li><p>Copy and Paste in your code </p>\n\n<pre><code>Option Explicit\nPublic dTime As Date\n\nSub ValueStore()\nDim dTime As Date\nWorksheets(\"Sheet2\").Range(\"a\" &amp; Cells(Rows.Count).Row).End(xlUp).Offset(1, 0).Value = Range(\"E15\").Value\nCall StartTimer\nEnd Sub\n\n\nSub StartTimer()\ndTime = Now + TimeValue(\"01:00:01\")\nApplication.OnTime dTime, \"ValueStore\", Schedule:=True\nEnd Sub\n\nSub StopTimer()\nOn Error Resume Next\nApplication.OnTime dTime, \"ValueStore\", Schedule:=False\nEnd Sub\n</code></pre></li>\n<li><p>Get out of VBA (Press Alt+Q)</p></li>\n<li>Save your sheet</li>\n<li>Click on the Control Toolbox Command Button icon</li>\n<li>Draw a button on your worksheet</li>\n<li>Right-click the button and select Properties</li>\n<li>Change the Caption to Start Timer</li>\n<li>Right-click the button and select View Code</li>\n<li><p>Paste in this code for the command button:</p>\n\n<pre><code>Private Sub CommandButton1_Click()\nCall StartTimer\nEnd Sub\n</code></pre></li>\n<li><p>Switch back to your spreadsheet</p></li>\n<li><p>Repeat steps 7-12 to create a Stop Timer button</p>\n\n<pre><code>Private Sub CommandButton2_Click()\nCall StopTimer\nEnd Sub\n</code></pre></li>\n<li><p>Press Alt-Q to close the VBEditor and save your sheet</p></li>\n</ol>\n\n<p>Try the buttons :)</p>\n"}], "owner": {"reputation": 33, "user_id": 5413625, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/b8d046ca34284a7d0420216ee53368d6?s=128&d=identicon&r=PG&f=1", "display_name": "S.Joesan", "link": "https://stackoverflow.com/users/5413625/s-joesan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 529, "favorite_count": 0, "accepted_answer_id": 33120489, "answer_count": 1, "score": 0, "last_activity_date": 1444897660, "creation_date": 1444805456, "last_edit_date": 1531164843, "question_id": 33118467, "link": "https://stackoverflow.com/questions/33118467/log-vaule-in-excel-cell", "title": "log vaule in excel cell", "body": "<p>I have a large excel file with scripts running to collect data from various locations. One of the cells in the sheet generates a two digit number every 10th minute. I would like to collect this number in this specific cell every 10th minute and log the value in a different sheet or a log (doesn't matter which format) Right now we can just read the value as it is displayed, but we keep a log to trace the ups and downs.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 1, "creation_date": 1444805592, "post_id": 33118394, "comment_id": 54050370, "body": "Do you have data that need to be delete in any other column than column A? Doesn&#39;t appear on your image."}, {"owner": {"reputation": 115, "user_id": 4596256, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/69b27071bfefda3e79d439a98ba33a6b?s=128&d=identicon&r=PG&f=1", "display_name": "ksrds", "link": "https://stackoverflow.com/users/4596256/ksrds"}, "reply_to_user": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 0, "creation_date": 1444805989, "post_id": 33118394, "comment_id": 54050580, "body": "Yes! I want to delete the data from column A only."}], "answers": [{"tags": [], "owner": {"reputation": 12614, "user_id": 3566998, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S7lz6.png?s=128&g=1", "display_name": "Excel Hero", "link": "https://stackoverflow.com/users/3566998/excel-hero"}, "is_accepted": true, "score": 2, "last_activity_date": 1444805637, "creation_date": 1444805637, "answer_id": 33118519, "question_id": 33118394, "link": "https://stackoverflow.com/questions/33118394/how-can-i-delete-the-rows-a2-except-a-column-k/33118519#33118519", "title": "How can I delete the rows A2 except a column K?", "body": "<p>Try this:</p>\n\n<pre><code>WSheet.[a2].Delete xlUp\n</code></pre>\n"}], "owner": {"reputation": 115, "user_id": 4596256, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/69b27071bfefda3e79d439a98ba33a6b?s=128&d=identicon&r=PG&f=1", "display_name": "ksrds", "link": "https://stackoverflow.com/users/4596256/ksrds"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 39, "favorite_count": 0, "accepted_answer_id": 33118519, "answer_count": 1, "score": 1, "last_activity_date": 1444805637, "creation_date": 1444805231, "question_id": 33118394, "link": "https://stackoverflow.com/questions/33118394/how-can-i-delete-the-rows-a2-except-a-column-k", "title": "How can I delete the rows A2 except a column K?", "body": "<p>I am doing something &amp; delete the row A2 in every loop, As usually it delete the value in column K. But I want not to delete the value in column K , Because I'll use the data having column K later.\nIs it possible?\nI am using currently:</p>\n\n<pre><code>WSheet.Rows(2).Delete\n</code></pre>\n\n<p>So how can I do the same with skipping the column K.\n<a href=\"https://i.stack.imgur.com/aLUPF.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/aLUPF.jpg\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 98, "user_id": 5441743, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85f949054f50b51c3320031adfcbf979?s=128&d=identicon&r=PG&f=1", "display_name": "Jake", "link": "https://stackoverflow.com/users/5441743/jake"}, "is_accepted": false, "score": 1, "last_activity_date": 1444846150, "creation_date": 1444846150, "answer_id": 33132571, "question_id": 33118372, "link": "https://stackoverflow.com/questions/33118372/excel-is-there-a-way-to-programmatically-change-the-background-colours-of-indiv/33132571#33132571", "title": "Excel: Is there a way to programmatically change the background colours of individual cells in a multi column listbox control", "body": "<p>Excel's built in listbox control doesn't really have formatting options, but you can do quite a bit with the listview control. </p>\n\n<p>You'll have to add a reference to Microsoft Windows Common Controls 6.0 (from VBA window go to Tools and click References, and scroll to find it). There's not an effective way to change the background color of a single cell in the listview table, but you can change the font color and make text bold in specific cells or based on criteria. </p>\n\n<p>The syntax to populate the listview is a bit different than listbox, but there's quite a bit of material online for this if you think its the way to go. Also - I have only used listview in a form, but it should be possible to add this as an ActiveX control in an actual sheet. </p>\n"}], "owner": {"reputation": 1363, "user_id": 705729, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/674f02f2f83509824354950ceb235a09?s=128&d=identicon&r=PG", "display_name": "Franchesca", "link": "https://stackoverflow.com/users/705729/franchesca"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 500, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1444846150, "creation_date": 1444805173, "last_edit_date": 1531161705, "question_id": 33118372, "link": "https://stackoverflow.com/questions/33118372/excel-is-there-a-way-to-programmatically-change-the-background-colours-of-indiv", "title": "Excel: Is there a way to programmatically change the background colours of individual cells in a multi column listbox control", "body": "<p>I have a multi-column list box control embedded in Excel, is there a way to change the background, font, and other attributes of an individual cell (rather than changing all the text in the listbox)?</p>\n\n<p>I don't mind which listbox control I use (activeX or otherwise).</p>\n\n<p>I would also consider using another control that isn't tied into the excel worksheet rows and columns (i.e. I can't use a table).</p>\n"}, {"tags": ["vba", "excel", "excel-2007"], "comments": [{"owner": {"reputation": 2182, "user_id": 4721281, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/9ca3ef336c479bc32997b548b75e7c24?s=128&d=identicon&r=PG&f=1", "display_name": "MGP", "link": "https://stackoverflow.com/users/4721281/mgp"}, "edited": false, "score": 0, "creation_date": 1444804819, "post_id": 33118219, "comment_id": 54049980, "body": "In which column is the data you want to transfer from one sheet to another?"}, {"owner": {"reputation": 148, "user_id": 5358214, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/4abea1cb7447d094bb060ae269ffb7a0?s=128&d=identicon&r=PG&f=1", "display_name": "Uppah", "link": "https://stackoverflow.com/users/5358214/uppah"}, "reply_to_user": {"reputation": 2182, "user_id": 4721281, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/9ca3ef336c479bc32997b548b75e7c24?s=128&d=identicon&r=PG&f=1", "display_name": "MGP", "link": "https://stackoverflow.com/users/4721281/mgp"}, "edited": false, "score": 0, "creation_date": 1444805272, "post_id": 33118219, "comment_id": 54050214, "body": "I need all the data from sheet2, so all the the columns. From sheet2 to sheet1: Column B = D, C=E, D=F, E=G, G=O, H=P, I=Q, J=AA, K=AB, L=AC, M=AD, N=AE."}, {"owner": {"reputation": 2020, "user_id": 3442153, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/hwsHp.jpg?s=128&g=1", "display_name": "K\u1d00\u03c4\u1d22", "link": "https://stackoverflow.com/users/3442153/k%e1%b4%80%cf%84%e1%b4%a2"}, "edited": false, "score": 0, "creation_date": 1444805398, "post_id": 33118219, "comment_id": 54050277, "body": "This is really basic, searching this site will give you tons of answers..."}], "answers": [{"comments": [{"owner": {"reputation": 148, "user_id": 5358214, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/4abea1cb7447d094bb060ae269ffb7a0?s=128&d=identicon&r=PG&f=1", "display_name": "Uppah", "link": "https://stackoverflow.com/users/5358214/uppah"}, "edited": false, "score": 0, "creation_date": 1444806738, "post_id": 33118443, "comment_id": 54050987, "body": "I don&#39;t know if it&#39;s just me being dumb, but when I try to do the formula in Sheet1!B2, I get an error. &quot;This formula you typed contains an error. \u2022 For information about fixing common formula problems, click help. \u2022 To get assistance in entering a function, click Function Wizard (Formulas tab, Function library group). \u2022 If you are not trying to enter a formula, avoid using an equal sign (=) or minus sign (-), or precede it with a single quatation mark (&#39;)"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 148, "user_id": 5358214, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/4abea1cb7447d094bb060ae269ffb7a0?s=128&d=identicon&r=PG&f=1", "display_name": "Uppah", "link": "https://stackoverflow.com/users/5358214/uppah"}, "edited": false, "score": 0, "creation_date": 1444807816, "post_id": 33118443, "comment_id": 54051623, "body": "Do you other formulas use a comma (e.g. <code>,</code>) or a semi-colon (e.g. <code>;</code>) between parameters?"}, {"owner": {"reputation": 148, "user_id": 5358214, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/4abea1cb7447d094bb060ae269ffb7a0?s=128&d=identicon&r=PG&f=1", "display_name": "Uppah", "link": "https://stackoverflow.com/users/5358214/uppah"}, "edited": false, "score": 0, "creation_date": 1444809825, "post_id": 33118443, "comment_id": 54052844, "body": "Jeeped, I really appreciate your help, but it still doesn&#39;t work. It doesn&#39;t get any data from sheet2. When I use the furmula with semi-colon, I don&#39;t get an error, but I don&#39;t get any data either."}, {"owner": {"reputation": 148, "user_id": 5358214, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/4abea1cb7447d094bb060ae269ffb7a0?s=128&d=identicon&r=PG&f=1", "display_name": "Uppah", "link": "https://stackoverflow.com/users/5358214/uppah"}, "edited": false, "score": 0, "creation_date": 1444817692, "post_id": 33118443, "comment_id": 54057866, "body": "Hi again, I&#39;ve found out myself, but I used some of the information you gave me. So +1."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 1, "last_activity_date": 1444808676, "last_edit_date": 1444808676, "creation_date": 1444805387, "answer_id": 33118443, "question_id": 33118219, "link": "https://stackoverflow.com/questions/33118219/vlookup-between-2-sheets/33118443#33118443", "title": "VLookUp between 2 sheets", "body": "<p>In a <a href=\"https://support.office.com/en-us/article/vlookup-function-adceda66-30de-4f26-923b-7257939faa65\" rel=\"nofollow noreferrer\">VLOOKUP function</a> you need to provide the <em>column_num</em> of the value to return. In your case, you can use a <a href=\"https://support.office.com/en-us/article/match-function-0600e189-9f3c-4e4f-98c1-943a0eb427ca\" rel=\"nofollow noreferrer\">MATCH function</a> to find the correct column using the headers.</p>\n\n<p>In Sheet1!B2, use this formula,</p>\n\n<pre><code>=IFERROR(VLOOKUP(--RIGHT($A2, 9), Sheet2!$A:$N, MATCH(B$1, Sheet2!$1:$1, 0), FALSE), IFERROR(VLOOKUP(RIGHT($A2, 9), Sheet2!$A:$N, MATCH(B$1, Sheet2!$1:$1, 0), FALSE), \"\"))\n</code></pre>\n\n<p>It is unclear on whether the values in Sheet2!A:A are text-that-look-like-numbers or actual numbers. The above will look at both. If your system using a semi-colon as a list separator instead of a comma then that would be,</p>\n\n<pre><code>=IFERROR(VLOOKUP(--RIGHT($A2; 9); Sheet2!$A:$N; MATCH(B$1; Sheet2!$1:$1; 0); FALSE); IFERROR(VLOOKUP(RIGHT($A2; 9); Sheet2!$A:$N; MATCH(B$1; Sheet2!$1:$1; 0); FALSE); \"\"))\n</code></pre>\n\n<p>Fill this both right and down. Each formula will try and match the header label in Sheet1 with a header label in Sheet2 in order to return the correct value.</p>\n\n<p>The <a href=\"https://support.office.com/en-us/article/RIGHT-RIGHTB-functions-240267EE-9AFA-4639-A02B-F19E1786CF2F\" rel=\"nofollow noreferrer\">RIGHT function</a> will strip off the <code>S-</code> from the Sagsnr values in Sheet1.</p>\n\n<p>The <a href=\"https://support.office.com/en-us/article/IFERROR-function-F59BACDC-78BD-4924-91DF-A869D0B08CD5\" rel=\"nofollow noreferrer\">IFERROR function</a> will check for a true number and then as text-that-looks-like-a-number. If neither can be matched, it simply returns a zero-length string (e.g. <code>\"\"</code>).</p>\n\n<p>\u00a0\u00a0\u00a0\u00a0<a href=\"https://i.stack.imgur.com/YFAuS.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/YFAuS.png\" alt=\"VLOOKUP with MATCH for column_num\"></a></p>\n"}], "owner": {"reputation": 148, "user_id": 5358214, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/4abea1cb7447d094bb060ae269ffb7a0?s=128&d=identicon&r=PG&f=1", "display_name": "Uppah", "link": "https://stackoverflow.com/users/5358214/uppah"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 294, "favorite_count": 0, "accepted_answer_id": 33118443, "answer_count": 1, "score": 1, "last_activity_date": 1445343129, "creation_date": 1444804513, "last_edit_date": 1445343129, "question_id": 33118219, "link": "https://stackoverflow.com/questions/33118219/vlookup-between-2-sheets", "title": "VLookUp between 2 sheets", "body": "<p>I have 2 sheets, they both have sales order, so I have to do a VLookUp, since the salesorders are placed differently in sheet2 than in sheet 1.</p>\n\n<p>I know I have to do a VLookUp, but I don't know how to do it.</p>\n"}, {"tags": ["excel", "collections", "vba"], "comments": [{"owner": {"reputation": 4067, "user_id": 2970789, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dd4ed57e10989bdb3f3ac58326b7354?s=128&d=identicon&r=PG&f=1", "display_name": "Ambie", "link": "https://stackoverflow.com/users/2970789/ambie"}, "edited": false, "score": 2, "creation_date": 1444809558, "post_id": 33116968, "comment_id": 54052695, "body": "I&#39;ve noticed this too, but if you run a <code>For Each</code> loop the time is linear. Try <code>Dim v as Variant</code>|<code>For Each v In coll</code>|<code>Next</code> and you&#39;ll see what I mean. My uneducated conclusion was that the processor loops through each item to find the index rather than array whose index is, in effect, a memory pointer."}, {"owner": {"reputation": 731, "user_id": 1505019, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/7b88fdc5f054ea6f18af95365a85826b?s=128&d=identicon&r=PG", "display_name": "bmende", "link": "https://stackoverflow.com/users/1505019/bmende"}, "reply_to_user": {"reputation": 4067, "user_id": 2970789, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dd4ed57e10989bdb3f3ac58326b7354?s=128&d=identicon&r=PG&f=1", "display_name": "Ambie", "link": "https://stackoverflow.com/users/2970789/ambie"}, "edited": false, "score": 0, "creation_date": 1444834432, "post_id": 33116968, "comment_id": 54069388, "body": "Wow, please post as answer so I can check it. This speeds up my code infinitely."}, {"owner": {"reputation": 731, "user_id": 1505019, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/7b88fdc5f054ea6f18af95365a85826b?s=128&d=identicon&r=PG", "display_name": "bmende", "link": "https://stackoverflow.com/users/1505019/bmende"}, "reply_to_user": {"reputation": 4067, "user_id": 2970789, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dd4ed57e10989bdb3f3ac58326b7354?s=128&d=identicon&r=PG&f=1", "display_name": "Ambie", "link": "https://stackoverflow.com/users/2970789/ambie"}, "edited": false, "score": 0, "creation_date": 1444837755, "post_id": 33116968, "comment_id": 54071704, "body": "I found the same behavior as well when referencing an object by key vs by index. The time taken to reference by key seems linear, while referencing by index is exponential. The catch seems to be that adding objects with keys in a collection seems to take significantly longer than leaving the key parameter out, but this process of adding objects with keys to a coll is almost completely linear. So with big collections, I suppose referencing by key could be infinitely faster than referencing by index"}, {"owner": {"reputation": 731, "user_id": 1505019, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/7b88fdc5f054ea6f18af95365a85826b?s=128&d=identicon&r=PG", "display_name": "bmende", "link": "https://stackoverflow.com/users/1505019/bmende"}, "reply_to_user": {"reputation": 4067, "user_id": 2970789, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dd4ed57e10989bdb3f3ac58326b7354?s=128&d=identicon&r=PG&f=1", "display_name": "Ambie", "link": "https://stackoverflow.com/users/2970789/ambie"}, "edited": false, "score": 0, "creation_date": 1444838169, "post_id": 33116968, "comment_id": 54071970, "body": "Or you could just use arrays..."}, {"owner": {"reputation": 4067, "user_id": 2970789, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dd4ed57e10989bdb3f3ac58326b7354?s=128&d=identicon&r=PG&f=1", "display_name": "Ambie", "link": "https://stackoverflow.com/users/2970789/ambie"}, "edited": false, "score": 1, "creation_date": 1444952856, "post_id": 33116968, "comment_id": 54129577, "body": "I&#39;ve just converted my comment to an answer for you."}], "answers": [{"tags": [], "owner": {"reputation": 4067, "user_id": 2970789, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dd4ed57e10989bdb3f3ac58326b7354?s=128&d=identicon&r=PG&f=1", "display_name": "Ambie", "link": "https://stackoverflow.com/users/2970789/ambie"}, "is_accepted": true, "score": 4, "last_activity_date": 1444890053, "last_edit_date": 1444890053, "creation_date": 1444889009, "answer_id": 33140997, "question_id": 33116968, "link": "https://stackoverflow.com/questions/33116968/processing-time-is-exponential-not-linear-vba-collections/33140997#33140997", "title": "Processing time is exponential not linear? (VBA Collections)", "body": "<p>I almost feel a fraud answering this question, as I'm a self-learner and much as I'd love to have gone to computer science classes, truth is my knowledge of the mechanics of memory allocation and retrieval is poor.</p>\n\n<p>I often wondered about the difference in speed of retrieval of <code>Collection</code> items by <code>key</code> and <code>index</code> and was hoping a schooled person would answer this question for my own knowledge too.</p>\n\n<p>However, the OP has asked me to convert my comment to an answer so I'm happy to oblige.</p>\n\n<p>My experience of the <code>Collection</code> object is that iterating with a <code>ForEach</code> loop is linear in time, ie 20,000 records takes twice as long as 10,000, whereas iterating with a <code>For</code> loop is exponential, ie 20,000 records takes 4 times as long as 10,000.</p>\n\n<p>So, for a large collection, this ...</p>\n\n<pre><code>Dim v as Variant 'assuming contents of collection is a primitive data type.\nFor Each v In someCollection\n    'process v in some way\nNext\n</code></pre>\n\n<p>will be considerably quicker than this ...</p>\n\n<pre><code>Dim i as Long\nFor i = 1 to someCollection.Count\n    'process someCollection(i) in some way\nNext\n</code></pre>\n\n<p>And that's sort of counter-intuitive, as I've read in several places that the <code>For Each</code> loop is approx. 10% slower than the `For' loop.</p>\n\n<p>My entirely uneducated conclusion was that the <code>Collection</code> object loops through its members from the first to find a specified index, which would explain how time increases exponentially the larger the collection becomes. That would kind of make sense, especially in comparison with an array, since the structure of a <code>Collection</code> object isn't predicated on an order whereas for an array, each index is, in effect, a memory pointer.</p>\n\n<p>But how about this ? ...</p>\n\n<pre><code>Dim i as Long\nFor i = 1 to someCollection.Count\n    'process someCollection(Cstr(i)) in some way\nNext\n</code></pre>\n\n<p>Time for retrieval becomes linear again. In other words, retrieval of a member by key appears to be at a similar speed to an array. I guess people much cleverer than I must have developed some form of really fast key/memory-pointer map so iterations of the collection is not required. As @bmende notes, it would explain why adding an item with a key takes longer than without (though <code>Dictionary</code> adds don't seem to experience this to such a degree).</p>\n\n<p>If people can excuse my presumptuousness in revealing my personal rules about handling <code>Collection</code> objects, then here they are:</p>\n\n<ol>\n<li>Iterations are only done with <code>For Each</code> loops.</li>\n<li>If there is no key, then convert the index to a string and use that (but be wary of member removals as the index string will now be out).</li>\n<li>Avoid referencing a member by its index if at all possible.</li>\n<li>If, once populated, the <code>Collection</code> isn't going to change much, then, instead of adding just the item, I create a class with <code>Item</code> and <code>Index</code> as two properties and add an instance of this class to the collection. That way I can still use a <code>For Each</code> loop and retrieve the index value if I need it.</li>\n</ol>\n\n<p>Like so:</p>\n\n<pre><code>Dim member as cMemberItem\nDim i as Long\nFor Each member in someCollection\n    i = member.Index\nNext\n</code></pre>\n\n<ol start=\"5\">\n<li>If I know I'll need to manuipulate primitive data types of members within the collection, then I, again, use a class. For example, to make the value of Item(3) be value + 1, I'd have to store the value in a temp variable, remove the item, and add a new item containing the modified temp value in the same place. This can become nightmarish if changing every member's value.</li>\n</ol>\n\n<p>Whereas an easier handling of that would be:</p>\n\n<pre><code>Dim member as cMemberItem\nFor Each member in someCollections\n    member.Item = member.Item + 1\nNext\n</code></pre>\n"}], "owner": {"reputation": 731, "user_id": 1505019, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/7b88fdc5f054ea6f18af95365a85826b?s=128&d=identicon&r=PG", "display_name": "bmende", "link": "https://stackoverflow.com/users/1505019/bmende"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 235, "favorite_count": 1, "accepted_answer_id": 33140997, "answer_count": 1, "score": 3, "last_activity_date": 1444890053, "creation_date": 1444798985, "last_edit_date": 1531164843, "question_id": 33116968, "link": "https://stackoverflow.com/questions/33116968/processing-time-is-exponential-not-linear-vba-collections", "title": "Processing time is exponential not linear? (VBA Collections)", "body": "<p>In the following code sample, I would expect the processing time to take twice as long if I change the collection's size from 10000 to 20000. Instead, the processing time is approximately 4 times as long when I make this change. It appears Dictionaries also have this kind of exponential behavior, but Arrays do not.</p>\n\n<p>Does anyone know why this is?</p>\n\n<pre><code>Sub testing()\nDim i As Long\nDim coll As New Collection\nDim startTime As Single\n\n    For i = 1 To 10000 'change this value to 20000 to see nonlinear increase in processing time\n        coll.Add i\n    Next i\n\n    startTime = Timer 'start the clock\n\n    For i = 1 To coll.Count\n        If coll(i) = 1 Then 'do nothing\n        End If\n    Next i\n\n    MsgBox \"Your final time is \" &amp; Round(Timer - startTime, 3)\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "excel-2013"], "comments": [{"owner": {"reputation": 859, "user_id": 2666502, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/zGVE6.gif?s=128&g=1", "display_name": "mtholen", "link": "https://stackoverflow.com/users/2666502/mtholen"}, "edited": false, "score": 0, "creation_date": 1444796914, "post_id": 33115790, "comment_id": 54047140, "body": "Can you provide the full module, as your question would lead to a lot of assumption on the part of anyone who would want to answer it ? Add some example strings that would be analysed by your code. As you insert a number of arrays into other arrays (DataArray(InverterNumber - 1, m(InverterNumber - 1)) where we can&#39;t see how they are built ?"}, {"owner": {"reputation": 1, "user_id": 5443246, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-igQaCkp5hUY/AAAAAAAAAAI/AAAAAAAAAxg/TQzxe76CAug/photo.jpg?sz=128", "display_name": "Voz", "link": "https://stackoverflow.com/users/5443246/voz"}, "reply_to_user": {"reputation": 859, "user_id": 2666502, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/zGVE6.gif?s=128&g=1", "display_name": "mtholen", "link": "https://stackoverflow.com/users/2666502/mtholen"}, "edited": false, "score": 0, "creation_date": 1447196252, "post_id": 33115790, "comment_id": 55056536, "body": "You can download the compiler and the files from this dropbox folder:  <a href=\"https://www.dropbox.com/sh/9sph17eyc2m0gq3/AACunecHXcqpMBAiP5CUEvUJa?dl=0\" rel=\"nofollow noreferrer\">dropbox.com/sh/9sph17eyc2m0gq3/AACunecHXcqpMBAiP5CUEvUJa?dl=&zwnj;&#8203;0</a>"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 5443246, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-igQaCkp5hUY/AAAAAAAAAAI/AAAAAAAAAxg/TQzxe76CAug/photo.jpg?sz=128", "display_name": "Voz", "link": "https://stackoverflow.com/users/5443246/voz"}, "edited": false, "score": 0, "creation_date": 1447196338, "post_id": 33118017, "comment_id": 55056568, "body": "I&#39;ve added in a DropBox folder with the files: <a href=\"https://www.dropbox.com/sh/9sph17eyc2m0gq3/AACunecHXcqpMBAiP5CUEvUJa?dl=0\" rel=\"nofollow noreferrer\">dropbox.com/sh/9sph17eyc2m0gq3/AACunecHXcqpMBAiP5CUEvUJa?dl=&zwnj;&#8203;0</a>  Not sure what you mean by line feed characters, though..."}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 1, "last_activity_date": 1444803754, "creation_date": 1444803754, "answer_id": 33118017, "question_id": 33115790, "link": "https://stackoverflow.com/questions/33115790/equation-in-debug-mode-with-different-value-than-if-not/33118017#33118017", "title": "Equation in debug mode with different value than if not", "body": "<p>This reads a single line from your file, but does not return the newline character(s) which delimit the line:</p>\n\n<pre><code>Line Input #1, LineFromFile\n</code></pre>\n\n<p>Then this:</p>\n\n<pre><code>lineitems = Split(LineFromFile, Chr(10))\n</code></pre>\n\n<p>Do you really have line feed characters within the \"lines\" of your CSV file?  If yes then it would help to show some sample content.</p>\n"}], "owner": {"reputation": 1, "user_id": 5443246, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-igQaCkp5hUY/AAAAAAAAAAI/AAAAAAAAAxg/TQzxe76CAug/photo.jpg?sz=128", "display_name": "Voz", "link": "https://stackoverflow.com/users/5443246/voz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 49, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1489765909, "creation_date": 1444790927, "last_edit_date": 1489765909, "question_id": 33115790, "link": "https://stackoverflow.com/questions/33115790/equation-in-debug-mode-with-different-value-than-if-not", "title": "Equation in debug mode with different value than if not", "body": "<p>So I am writing an excel VBA program that reads all csv files with a specific name into separate sheets on the workbook.</p>\n\n<p>It is reading the files with no issue. The problem comes when it is translating the data from the file onto an array which is meant to contain all the relevant data in all the files of the directory.</p>\n\n<p>To read the files and separating by line, </p>\n\n<p>I am using:</p>\n\n<pre><code>Do Until EOF(1)\n\n        Line Input #1, LineFromFile\n\n        lineitems = Split(LineFromFile, Chr(10))\n</code></pre>\n\n<p>Further down the module, I am passing the lineitems to a data array when a specific criteria within that line of data is met. For clarity, the expression is comparing the date value in the line of the file with the date marker on the name of the file.</p>\n\n<pre><code>ElseIf (Left(lineitems(Line), 8) = Right(Left(FileTime(FileNum), 6), 2) + \"/\" + Right(Left(FileTime(FileNum), 4), 2) + \"/\" + Left(FileTime(FileNum), 2)) Then                 \n\n                Proxy = CStr(lineitems(Line))\n                DataArray(InverterNumber - 1, m(InverterNumber - 1)) = Proxy\n</code></pre>\n\n<p>As you can see, I've added a proxy step to try and ensure the data goes across, to no avail. I've also added a fail-safe to ensure no empty line goes into DataArray:</p>\n\n<pre><code>If Len(DataArray(InverterNumber - 1, m(InverterNumber - 1))) = Len(CStr(lineitems(Line))) Then\n\n                    Test(InverterNumber - 1, m(InverterNumber - 1)) = Len(DataArray(InverterNumber - 1, m(InverterNumber - 1)))\n                    m(InverterNumber - 1) = m(InverterNumber - 1) + 1\n\n                End If\n</code></pre>\n\n<p>Now if I run the program in it's release modus, it will return a series of empty columns, which shouldn't happen because of the failsafe.\nHowever when I run it through the debug mode, and IF I observe that step, it adds the data correctly.</p>\n\n<p>Is there any way I can ensure the values are being translated correctly?</p>\n\n<p>Is there anything I could be doing better?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 9743, "user_id": 2127508, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24b1d5bcb39ec4baad76d20c66506318?s=128&d=identicon&r=PG", "display_name": "barrowc", "link": "https://stackoverflow.com/users/2127508/barrowc"}, "edited": false, "score": 0, "creation_date": 1444787545, "post_id": 33114583, "comment_id": 54044808, "body": "I don&#39;t think you can achieve this with AutoFilter unless you use a helper column. <a href=\"https://support.office.com/en-us/article/Filter-by-using-advanced-criteria-4c9222fe-8529-4cd7-a898-3f16abdff32b#bmexample3\" rel=\"nofollow noreferrer\">Advanced Filter</a> can achieve this if that&#39;s an acceptable solution"}, {"owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "edited": false, "score": 1, "creation_date": 1444789642, "post_id": 33114583, "comment_id": 54045303, "body": "Can you provide minimal test data for before-and-after?"}, {"owner": {"reputation": 967, "user_id": 4539385, "user_type": "registered", "accept_rate": 15, "profile_image": "https://www.gravatar.com/avatar/29be607a88cff96db2b54dd68abada43?s=128&d=identicon&r=PG&f=1", "display_name": "Programmerzzz", "link": "https://stackoverflow.com/users/4539385/programmerzzz"}, "edited": false, "score": 0, "creation_date": 1444792008, "post_id": 33114583, "comment_id": 54045914, "body": "I can use any construct. Since the existing code is using .Autofilter I am just checking if its possible to do using .Autofilter. No Problem using .AdvanceFilter as long as it achieves what I want..:).I made a test file <code>https:&#47;&#47;drive.google.com&#47;open?id=1fvlZnQ12vodFFqjAHaODXcF0CY&zwnj;&#8203;FkahBKGUBE7EMt8Uc</code>"}, {"owner": {"reputation": 967, "user_id": 4539385, "user_type": "registered", "accept_rate": 15, "profile_image": "https://www.gravatar.com/avatar/29be607a88cff96db2b54dd68abada43?s=128&d=identicon&r=PG&f=1", "display_name": "Programmerzzz", "link": "https://stackoverflow.com/users/4539385/programmerzzz"}, "edited": false, "score": 0, "creation_date": 1444792328, "post_id": 33114583, "comment_id": 54045998, "body": "In the sheet, Columns D,E with Word1 and Word2 have Product keyword in column H. I need the Output similar in Sheet3. Sheet 2 is output of my first <code>if</code> statement. Thanks for the help"}], "answers": [{"comments": [{"owner": {"reputation": 967, "user_id": 4539385, "user_type": "registered", "accept_rate": 15, "profile_image": "https://www.gravatar.com/avatar/29be607a88cff96db2b54dd68abada43?s=128&d=identicon&r=PG&f=1", "display_name": "Programmerzzz", "link": "https://stackoverflow.com/users/4539385/programmerzzz"}, "edited": false, "score": 0, "creation_date": 1444796790, "post_id": 33116530, "comment_id": 54047106, "body": "Sry about that let me test and get back"}, {"owner": {"reputation": 967, "user_id": 4539385, "user_type": "registered", "accept_rate": 15, "profile_image": "https://www.gravatar.com/avatar/29be607a88cff96db2b54dd68abada43?s=128&d=identicon&r=PG&f=1", "display_name": "Programmerzzz", "link": "https://stackoverflow.com/users/4539385/programmerzzz"}, "edited": false, "score": 0, "creation_date": 1444842974, "post_id": 33116530, "comment_id": 54074848, "body": "This is not exactly what I want. may be I am not clear in my problem statement as you said.Eg:- In my Dataset  we filter based on column 8 and column 4. I need to separate out the records containing <code>&#39;Product&#39;</code> in Column 8 into Sheet A and records with non product values in Column 8 into Sheet B. Alongside, in Sheet B I need to have records with <code>word1</code> in Column 4 though they have &#39;Product&#39; in column 8.  The <code>.Autofilter</code> condition in my original post does a logical &#39;AND&#39; of my else condition. But I need an &#39;OR&#39; like behavior as I mentioned. Hope I am clear"}, {"owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "reply_to_user": {"reputation": 967, "user_id": 4539385, "user_type": "registered", "accept_rate": 15, "profile_image": "https://www.gravatar.com/avatar/29be607a88cff96db2b54dd68abada43?s=128&d=identicon&r=PG&f=1", "display_name": "Programmerzzz", "link": "https://stackoverflow.com/users/4539385/programmerzzz"}, "edited": false, "score": 0, "creation_date": 1444844915, "post_id": 33116530, "comment_id": 54075904, "body": "I&#39;m still unclear about the expected result (probably because of invalid test data): you are saying <i>non product values in Column 8 in Sheet B</i>, yet your Sheet B contains only one record, which is &quot;product&quot;. I updated your initial post to include the sample data you provided in the external file, but I&#39;d need to have the basic setup: 1) the initial list of records 2) the expected result - 2 outcomes based on 2 criteria, from the initial recordset"}, {"owner": {"reputation": 967, "user_id": 4539385, "user_type": "registered", "accept_rate": 15, "profile_image": "https://www.gravatar.com/avatar/29be607a88cff96db2b54dd68abada43?s=128&d=identicon&r=PG&f=1", "display_name": "Programmerzzz", "link": "https://stackoverflow.com/users/4539385/programmerzzz"}, "edited": false, "score": 0, "creation_date": 1444845920, "post_id": 33116530, "comment_id": 54076527, "body": "Okay, let me rephrase the problem. In Sheet A I want to have the records with <code>Product&#47;product</code> in Column8 . In Sheet B I want all records <b>WITHOUT</b> product in column8(like Assembly, wrox,Citrix) + records with <code>word1</code> in column4 even though they have product in column8. pls let me know if it helps"}, {"owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "reply_to_user": {"reputation": 967, "user_id": 4539385, "user_type": "registered", "accept_rate": 15, "profile_image": "https://www.gravatar.com/avatar/29be607a88cff96db2b54dd68abada43?s=128&d=identicon&r=PG&f=1", "display_name": "Programmerzzz", "link": "https://stackoverflow.com/users/4539385/programmerzzz"}, "edited": false, "score": 0, "creation_date": 1444852362, "post_id": 33116530, "comment_id": 54080272, "body": "I made an update for the AutoFilter to use the Or operator when combining criteria for Col 4 and Col 8"}], "tags": [], "owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "is_accepted": false, "score": 0, "last_activity_date": 1444852925, "last_edit_date": 1444852925, "creation_date": 1444796216, "answer_id": 33116530, "question_id": 33114583, "link": "https://stackoverflow.com/questions/33114583/autofiler-for-or-condition-in-vba/33116530#33116530", "title": "Autofiler for Or Condition in VBA", "body": "<pre><code>Public Sub autoFilter1()    'Column 8 = \"Product\"\n    Dim ws As Worksheet\n\n    Set ws = Worksheets(\"Sheet1\")\n    ws.UsedRange.Rows.EntireRow.Hidden = False\n    If Not ws.AutoFilter Is Nothing Then ws.ShowAllData\n\n    ws.UsedRange.AutoFilter 8, \"product\"\nEnd Sub\n\nPublic Sub autoFilter2()    'Column 8 &lt;&gt; \"Product\" OR Column 4 = \"Word1\"\n    Dim ws As Worksheet, vRng As Range\n\n    Application.ScreenUpdating = False\n    Set ws = Worksheets(\"Sheet1\")\n    ws.UsedRange.Rows.EntireRow.Hidden = False\n    If Not ws.AutoFilter Is Nothing Then ws.ShowAllData\n\n    ws.UsedRange.AutoFilter 8, \"&lt;&gt;product\"\n    Set vRng = ws.UsedRange.SpecialCells(xlCellTypeVisible)\n        ws.ShowAllData\n    ws.UsedRange.AutoFilter 4, \"word1\"\n    Set vRng = Union(vRng, ws.UsedRange.SpecialCells(xlCellTypeVisible))\n    ws.UsedRange.AutoFilter\n\n    ws.UsedRange.Rows.EntireRow.Hidden = True\n    vRng.Rows.EntireRow.Hidden = False\n    Application.ScreenUpdating = True\n    ws.Cells(1).Select\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p><a href=\"https://i.stack.imgur.com/Zfr4w.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Zfr4w.png\" alt=\"multiAutoFilter\"></a></p>\n"}], "owner": {"reputation": 967, "user_id": 4539385, "user_type": "registered", "accept_rate": 15, "profile_image": "https://www.gravatar.com/avatar/29be607a88cff96db2b54dd68abada43?s=128&d=identicon&r=PG&f=1", "display_name": "Programmerzzz", "link": "https://stackoverflow.com/users/4539385/programmerzzz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 126, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1444852925, "creation_date": 1444781121, "last_edit_date": 1444844260, "question_id": 33114583, "link": "https://stackoverflow.com/questions/33114583/autofiler-for-or-condition-in-vba", "title": "Autofiler for Or Condition in VBA", "body": "<p>I am filtering the data using .Autofilter in an Excel Sheet as follows</p>\n\n<pre><code>if bProds = True then\n    .AutoFilter 4,\"&lt;&gt;*strip*\",2,\"&lt;&gt;*Strip*\"\n    .AutoFilter 8,\"Product\",2,\"product\"\nelse\n    .AutoFilter 8, \"&lt;&gt;Product\", 1, \"&lt;&gt;product\"\n    .AutoFilter 4,\"*strip*\",2,\"*Strip*\"\nend if\n</code></pre>\n\n<p>The result set is rows where both the Autofilter criteria met.\nIn the else part I want to make a condition such that result is the rows where it does not contain product/Product in column 8 or if it contains strip/Strip in column 4.</p>\n\n<p>Since autofilters returns if both conditions were met, the above code don't work. Any way to make it work like my requirement?</p>\n\n<p>Test data also available from <a href=\"https://drive.google.com/open?id=1fvlZnQ12vodFFqjAHaODXcF0CYFkahBKGUBE7EMt8Uc\" rel=\"nofollow\">this drive.google.com link</a></p>\n\n<p>Sheet 1:</p>\n\n<pre><code>  Col1      Col2   Col3  Col4    Col5    Col6     Col7     Col8\n---------   ----   ----  -----   -----   ----     ----     -----\n1/07/2015    3      3    Word1   word2   AB       Hello    Product\n1/13/2015    2      1    word2   word1   AB       hello    product\n1/13/2015    2      1    COzier  USA     Bill     Allice   Assembly\n1/14/2015    3      4    TOny    USA     Bill     Allice   Wrox\n1/20/2015    2      1    Shawn   USA     gerard   amy      Product\n1/23/2015    2      1    Wilcox  Sanzer  Francis  Bob      Assembly\n1/26/2015    3      5    Justin  Langer  Go       febrand  Citrix\n</code></pre>\n\n<p>Sheet 2:</p>\n\n<pre><code>  Col1      Col2   Col3  Col4    Col5    Col6     Col7     Col8\n---------   ----   ----  -----   -----   ----     ----     -----\n1/20/2015    2      1    Shawn   USA     gerard   amy      Product\n</code></pre>\n\n<p>Sheet 3:</p>\n\n<pre><code>  Col1      Col2   Col3  Col4    Col5    Col6     Col7     Col8\n---------   ----   ----  -----   -----   ----     ----     -----\n1/07/2015    3      3    Word1   word2   AB       Hello    Product\n1/13/2015    2      1    word2   word1   AB       hello    product\n1/13/2015    2      1    COzier  USA     Bill     Allice   Assembly\n1/14/2015    3      4    TOny    USA     Bill     Allice   Wrox\n1/23/2015    2      1    Wilcox  Sanzer  Francis  Bob      Assembly\n1/26/2015    3      5    Justin  Langer  Go       febrand  Citrix\n</code></pre>\n"}, {"tags": ["excel", "charts", "excel-formula", "vba"], "comments": [{"owner": {"reputation": 2843, "user_id": 2958401, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/a5dd8c841e767e09bd8c08764dc2319e?s=128&d=identicon&r=PG&f=1", "display_name": "gtwebb", "link": "https://stackoverflow.com/users/2958401/gtwebb"}, "edited": false, "score": 0, "creation_date": 1444778403, "post_id": 33114143, "comment_id": 54042665, "body": "What didn&#39;t work with your second solution?  It seems like a legitimate way to determine major intervals.  The biggest issue I could see is that the number between ticks could be odd numbers (not whole days) in which case you will need to optimize the solution with some sort of limits (max 35 ticks, min 30 ticks) and try to optimize a solution that uses whole number intervals (or whole week intervals)."}, {"owner": {"reputation": 195, "user_id": 5441478, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/8m8PX.jpg?s=128&g=1", "display_name": "drLecter", "link": "https://stackoverflow.com/users/5441478/drlecter"}, "reply_to_user": {"reputation": 2843, "user_id": 2958401, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/a5dd8c841e767e09bd8c08764dc2319e?s=128&d=identicon&r=PG&f=1", "display_name": "gtwebb", "link": "https://stackoverflow.com/users/2958401/gtwebb"}, "edited": false, "score": 0, "creation_date": 1444822048, "post_id": 33114143, "comment_id": 54060641, "body": "Hi gtwebb You are probably right.I just put number as 27 because thats the usual number of ticks I end up with. (I dont really care about their number as long as they are not dense and are readable). Solution doesnt work because it happens that I dont see the final date at the end and that is one of the requirements.  Is there a way to add another column and somehow optimize number of ticks as well via formula?"}], "owner": {"reputation": 195, "user_id": 5441478, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/8m8PX.jpg?s=128&g=1", "display_name": "drLecter", "link": "https://stackoverflow.com/users/5441478/drlecter"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 943, "favorite_count": 1, "answer_count": 0, "score": 0, "last_activity_date": 1444778212, "creation_date": 1444778212, "last_edit_date": 1531161705, "question_id": 33114143, "link": "https://stackoverflow.com/questions/33114143/determining-the-optimal-excel-chart-major-unit", "title": "Determining the optimal excel chart major unit", "body": "<p>one of my tasks is updating a presentation with zillion charts. \nSince there are 4 charts per slide it is important that the major unit on a chart is set so that the charts are legible.</p>\n\n<p>I found a way to code some steps and cut the time significantly but one of the missing pieces is determining the major unit of a chart.</p>\n\n<p>So the question is:\n<strong><em>Is there a way to to determine through formulas or vba what should be the major unit in a date type x axis based on the dynamic  start date and end date (I want last date to be shown on a graph)</em></strong></p>\n\n<p>Bellow is the example: </p>\n\n<ul>\n<li>dates are having one week interval</li>\n<li>I need the final date that shows up in pivot to be on the chart</li>\n<li>I need the chart dates to be legible given that it will take quarter of a slide </li>\n</ul>\n\n<p><a href=\"http://i.stack.imgur.com/whqbM.jpg\" rel=\"nofollow\">chart example</a></p>\n\n<p>I tried going through similar questions and one of the solutions (that didnt work for me) was: </p>\n\n<ul>\n<li>using Days360 to calculate number of days between start and end date</li>\n<li>adding 1 to be inclusive of start and end day </li>\n<li>dividing that number of days with number of wanted ticks minus one </li>\n<li>so far I was using 27 as a number of ticks, based on legibility experience</li>\n</ul>\n\n<p>If I find a way to precisely determine a number to be used I will use it as a reference # for my macro that changes all the applicable charts</p>\n\n<p>Could anyone help me out please?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 1, "creation_date": 1444780400, "post_id": 33114140, "comment_id": 54043185, "body": "yep, same here. There must be some workaround... :d"}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 1, "creation_date": 1444780649, "post_id": 33114140, "comment_id": 54043249, "body": "What if we put this in workbook_Activate instead, and we remove it when Workbook_Deactivate?"}], "answers": [{"tags": [], "owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "is_accepted": true, "score": 1, "last_activity_date": 1444782367, "last_edit_date": 1444782367, "creation_date": 1444781044, "answer_id": 33114566, "question_id": 33114140, "link": "https://stackoverflow.com/questions/33114140/hotkey-is-reopening-workbook/33114566#33114566", "title": "Hotkey is reopening workbook", "body": "<p>I confirm, I tried it and it workd correctly if you use the Activate and Deactivate events.</p>\n\n<pre><code>Private Sub Workbook_Activate()\n    Application.OnKey \"^m\", \"abc\"\nEnd Sub\n\n\nPrivate Sub Workbook_Deactivate()\n    Application.OnKey \"^m\"\nEnd Sub\n</code></pre>\n\n<p>When Book2 closes or deactivates, it will remove its OnKey. But then Book1 will activate and set its own OnKey. It works as desired, it will no longer reopen the closed workbook.</p>\n\n<p>I think you cannot remove OnKey from one WB and leave it intact for another, since the OnKey is related to the Application object, not to the WB. But the workaround with Activate/Deactivate seems to work properly. </p>\n"}], "owner": {"reputation": 8724, "user_id": 619177, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/65d2dc7c8d335fa33854172a26fa46f5?s=128&d=identicon&r=PG", "display_name": "sigil", "link": "https://stackoverflow.com/users/619177/sigil"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 75, "favorite_count": 0, "accepted_answer_id": 33114566, "answer_count": 1, "score": 1, "last_activity_date": 1444782367, "creation_date": 1444778196, "last_edit_date": 1531164843, "question_id": 33114140, "link": "https://stackoverflow.com/questions/33114140/hotkey-is-reopening-workbook", "title": "Hotkey is reopening workbook", "body": "<p>I have a workbook <code>Book1</code> which sets a hotkey on opening:</p>\n\n<pre><code>Public Sub workbook_open()\n\nApplication.OnKey \"^m\", \"abc\"\n\nEnd Sub\n</code></pre>\n\n<p>Here is the code for <code>abc()</code>:</p>\n\n<pre><code>Sub abc()\n\nbkName = ActiveWorkbook.Name\nrunString = \"'\" &amp; bkName &amp; \"'!xyz\"\nApplication.Run runString\n\nEnd Sub\n\n\nSub xyz()\n\nMsgBox \"this book: \" &amp; ThisWorkbook.Name &amp; vbNewLine &amp; \"active: \" &amp; ActiveWorkbook.Name    \n\nEnd Sub\n</code></pre>\n\n<p>I have a workbook <code>Book2</code> with identical code.  When I open <code>Book1</code>, then open <code>Book2</code>, then close <code>Book2</code>, and then press <strong>Ctrl</strong>+<strong>m</strong>, <code>Book2</code> opens and I get a message box with:</p>\n\n<pre><code>this book: Book1.xlsm\nactive: Book1.xlsm\n</code></pre>\n\n<p>So <code>Book1</code> is running <code>abc()</code>, but I guess the <code>.OnKey</code> from <code>Book2</code>'s <code>Workbook_Open()</code> is causing <code>Book2</code> to reopen, even though it's not actually calling <code>Book2</code>'s <code>abc()</code>.</p>\n\n<p>How can I prevent <code>Book2</code> from being reopened?  Is there a way to delete its <code>.OnKey</code> but leave <code>Book1</code>'s intact?</p>\n"}, {"tags": ["vba", "excel", "hyperlink"], "comments": [{"owner": {"reputation": 5227, "user_id": 1252820, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/13f7f82a81df5214900a5246c138d1c9?s=128&d=identicon&r=PG", "display_name": "lori_m", "link": "https://stackoverflow.com/users/1252820/lori-m"}, "edited": false, "score": 0, "creation_date": 1445068266, "post_id": 33114093, "comment_id": 54174707, "body": "You can just use <code>#rc</code> for the hyperlink address - no need for a hidden sheet."}, {"owner": {"reputation": 41, "user_id": 5442853, "user_type": "registered", "profile_image": "https://graph.facebook.com/1658664331070328/picture?type=large", "display_name": "Denis Vakula", "link": "https://stackoverflow.com/users/5442853/denis-vakula"}, "reply_to_user": {"reputation": 5227, "user_id": 1252820, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/13f7f82a81df5214900a5246c138d1c9?s=128&d=identicon&r=PG", "display_name": "lori_m", "link": "https://stackoverflow.com/users/1252820/lori-m"}, "edited": false, "score": 0, "creation_date": 1445176550, "post_id": 33114093, "comment_id": 54202391, "body": "oh, thank you lori_m. Works just perfect. But what it means #rc ?"}, {"owner": {"reputation": 5227, "user_id": 1252820, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/13f7f82a81df5214900a5246c138d1c9?s=128&d=identicon&r=PG", "display_name": "lori_m", "link": "https://stackoverflow.com/users/1252820/lori-m"}, "edited": false, "score": 1, "creation_date": 1445201920, "post_id": 33114093, "comment_id": 54211024, "body": "The <code># </code>signifies a reference within a document and any formula that returns a reference can follow in either <code>A1</code> or <code>r1c1</code> notation. Here <code>rc</code> means this cell in <code>r1c1</code>notation. Entering <code>#indirect(rc)</code> into the hyperlink dialog will take you to whatever the text entered in the hyperlink cell refers to eg <code>Sheet1!A1</code>"}, {"owner": {"reputation": 148, "user_id": 10899835, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/74e601b427dec8874fdbaa7738a4926f?s=128&d=identicon&r=PG&f=1", "display_name": "GuidoT", "link": "https://stackoverflow.com/users/10899835/guidot"}, "edited": false, "score": 0, "creation_date": 1594734163, "post_id": 33114093, "comment_id": 111225252, "body": "Possible answer to initial question: <a href=\"https://stackoverflow.com/questions/62896319/run-excel-macro-with-hyperlink-formula?noredirect=1#comment111224826_62896319\" title=\"run excel macro with hyperlink formula\">stackoverflow.com/questions/62896319/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 41, "user_id": 5442853, "user_type": "registered", "profile_image": "https://graph.facebook.com/1658664331070328/picture?type=large", "display_name": "Denis Vakula", "link": "https://stackoverflow.com/users/5442853/denis-vakula"}, "edited": false, "score": 0, "creation_date": 1444781754, "post_id": 33114213, "comment_id": 54043515, "body": "Great idea! You&#39;ve just saved my ass. Thanx"}, {"owner": {"reputation": 41, "user_id": 5442853, "user_type": "registered", "profile_image": "https://graph.facebook.com/1658664331070328/picture?type=large", "display_name": "Denis Vakula", "link": "https://stackoverflow.com/users/5442853/denis-vakula"}, "edited": false, "score": 0, "creation_date": 1444783538, "post_id": 33114213, "comment_id": 54043945, "body": "Sorry Excel Hero, it seems to be wrong way. Worksheet_FollowHyperlink still doesn&#39;t deal with my/your hyperlinks. Have you got any ideas?"}, {"owner": {"reputation": 12614, "user_id": 3566998, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S7lz6.png?s=128&g=1", "display_name": "Excel Hero", "link": "https://stackoverflow.com/users/3566998/excel-hero"}, "reply_to_user": {"reputation": 41, "user_id": 5442853, "user_type": "registered", "profile_image": "https://graph.facebook.com/1658664331070328/picture?type=large", "display_name": "Denis Vakula", "link": "https://stackoverflow.com/users/5442853/denis-vakula"}, "edited": false, "score": 0, "creation_date": 1444786462, "post_id": 33114213, "comment_id": 54044581, "body": "@DenisVakula That is correct. This was never intended to work with Worksheet_FollowHyperlink. This is a different solution. You create your own custom procedure to fire instead. In my answer I named that custom procedure HyperlinkClick() but you can choose any name you like. You do not need Worksheet_FollowHyperlink() at all. Forget about it."}, {"owner": {"reputation": 12614, "user_id": 3566998, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S7lz6.png?s=128&g=1", "display_name": "Excel Hero", "link": "https://stackoverflow.com/users/3566998/excel-hero"}, "reply_to_user": {"reputation": 41, "user_id": 5442853, "user_type": "registered", "profile_image": "https://graph.facebook.com/1658664331070328/picture?type=large", "display_name": "Denis Vakula", "link": "https://stackoverflow.com/users/5442853/denis-vakula"}, "edited": false, "score": 0, "creation_date": 1444974045, "post_id": 33114213, "comment_id": 54135211, "body": "@DenisVakula If you don&#39;t understand how this works, please ask. Creating hyperlinks to a hidden sheet is not recommended."}, {"owner": {"reputation": 1925, "user_id": 592732, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/01a65dad4e2c4793da9ffa56507e3c66?s=128&d=identicon&r=PG", "display_name": "MarioVW", "link": "https://stackoverflow.com/users/592732/mariovw"}, "edited": false, "score": 0, "creation_date": 1585269812, "post_id": 33114213, "comment_id": 107708622, "body": "I am getting a <code>Reference isn&#39;t valid</code> message box every time I click on the hyperlink. @ExcelHero any idea on why could this be happening?"}, {"owner": {"reputation": 399, "user_id": 7251685, "user_type": "registered", "accept_rate": 47, "profile_image": "https://lh5.googleusercontent.com/-cjqIiIyHfBQ/AAAAAAAAAAI/AAAAAAAANac/Wi8QkjBn3YQ/photo.jpg?sz=128", "display_name": "Dumitru Daniel", "link": "https://stackoverflow.com/users/7251685/dumitru-daniel"}, "edited": false, "score": 0, "creation_date": 1586946258, "post_id": 33114213, "comment_id": 108313564, "body": "@ExcelHero Your formula is awsome. thank you for this. If i may go into more details, if i use this formula:&#39;&#39;&#39;=HYPERLINK(&quot;#testSheetFormula(BE76:BE77)&quot;,&quot;Test&quot;)&zwnj;&#8203;&#39;&#39;&#39;, the VBA formula recolonizes the area correctly. Is there a way that would allow me to send the target range by selecting the area in a formula, something like cell(&quot;address&quot;,) but for multiple cells?"}], "tags": [], "owner": {"reputation": 12614, "user_id": 3566998, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S7lz6.png?s=128&g=1", "display_name": "Excel Hero", "link": "https://stackoverflow.com/users/3566998/excel-hero"}, "is_accepted": false, "score": 6, "last_activity_date": 1614717893, "last_edit_date": 1614717893, "creation_date": 1444778641, "answer_id": 33114213, "question_id": 33114093, "link": "https://stackoverflow.com/questions/33114093/excel-hyperlink-to-nothing/33114213#33114213", "title": "excel hyperlink to nothing", "body": "<p>You will be better off using the HYPERLINK() function. You can use it for what you want like this:</p>\n<pre><code>=HYPERLINK(&quot;#HyperlinkClick()&quot;, &quot;Text you want to Display&quot;)\n</code></pre>\n<p>Notice the <strong>#</strong> at the beginning. <strong>This is important</strong>.</p>\n<p>Now create a function called HyperlinkClick:</p>\n<pre><code>Function HyperlinkClick()\n\n    Set HyperlinkClick = Selection\n    'Do whatever you like here...\n    MsgBox &quot;You clicked on cell &quot; &amp; Selection.Address(0, 0)\n\nEnd Function\n</code></pre>\n<p><em><strong>Be sure to place this function in a STANDARD CODE MODULE.</strong></em></p>\n<p>That's it.</p>\n"}, {"comments": [{"owner": {"reputation": 41, "user_id": 5442853, "user_type": "registered", "profile_image": "https://graph.facebook.com/1658664331070328/picture?type=large", "display_name": "Denis Vakula", "link": "https://stackoverflow.com/users/5442853/denis-vakula"}, "edited": false, "score": 1, "creation_date": 1444781477, "post_id": 33114230, "comment_id": 54043437, "body": "thanx, it works but i&#39;m getting &quot;Reference isn&#39;t valid&quot; everytime I click the hyperlink"}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 0, "last_activity_date": 1444778743, "creation_date": 1444778743, "answer_id": 33114230, "question_id": 33114093, "link": "https://stackoverflow.com/questions/33114093/excel-hyperlink-to-nothing/33114230#33114230", "title": "excel hyperlink to nothing", "body": "<p>Select a group of cells and run:</p>\n\n<pre><code>Sub HyperAdder()\n   For Each r In Selection\n      ActiveSheet.Hyperlinks.Add Anchor:=r, Address:=\"\", SubAddress:=r.Parent.Name &amp; \"!\" &amp; r.Address(0, 0), TextToDisplay:=\"myself\"\n   Next r\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 41, "user_id": 5442853, "user_type": "registered", "profile_image": "https://graph.facebook.com/1658664331070328/picture?type=large", "display_name": "Denis Vakula", "link": "https://stackoverflow.com/users/5442853/denis-vakula"}, "is_accepted": false, "score": 0, "last_activity_date": 1444787300, "last_edit_date": 1444787300, "creation_date": 1444786639, "answer_id": 33115239, "question_id": 33114093, "link": "https://stackoverflow.com/questions/33114093/excel-hyperlink-to-nothing/33115239#33115239", "title": "excel hyperlink to nothing", "body": "<p>I've just founded a solution. If I refer my Inserted Hyperlink to some cell in other sheet and then make it very hidden (xlSheetVeryHidden), it works just perfect. Now my hyperlinks refer to the Neverland and the macro captures them as well. Thank you all for your patiense.</p>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 9716021, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-PIWuzlXECjA/AAAAAAAAAAI/AAAAAAAACUw/360UH24fNzI/photo.jpg?sz=128", "display_name": "Simon Martineau", "link": "https://stackoverflow.com/users/9716021/simon-martineau"}, "is_accepted": false, "score": 1, "last_activity_date": 1524964108, "creation_date": 1524964108, "answer_id": 50082480, "question_id": 33114093, "link": "https://stackoverflow.com/questions/33114093/excel-hyperlink-to-nothing/50082480#50082480", "title": "excel hyperlink to nothing", "body": "<p>Good solution Excel Hero but not for everything: I try to make a kind of outline but it's impossible to hide a row in the function: nothing happen! But if a make a direct call to the same code with a button, everything works fine. This is my test:</p>\n\n<pre><code>Function test()\n\nSet test = Selection\n\n Dim i, j, state As Integer\nstate = Selection.Value\ni = Selection.Row + 1\nj = i\n\nIf state = \"6\" Then\n\n    Do Until ActiveSheet.Cells(j, 7).Value = 1 Or ActiveSheet.Cells(j, 4).Value = \"\"\n        j = j + 1\n    Loop\n    ActiveSheet.Rows(i &amp; \":\" &amp; j - 1).EntireRow.Hidden = True\n    Debug.Print \"test group: \" &amp; i &amp; \":\" &amp; j - 1\nElse\n    Do Until ActiveSheet.Cells(j, 7).Value = 1 Or ActiveSheet.Cells(j, 4).Value = \"\"\n        j = j + 1\n    Loop\n    ActiveSheet.Rows(i &amp; \":\" &amp; j - 1).EntireRow.Hidden = False\n    Debug.Print \"test ungroup: \" &amp; i &amp; \":\" &amp; j - 1\nEnd If\n</code></pre>\n\n<p>End Function</p>\n\n<p>My debug.print give me this:</p>\n\n<p>test group: 4:26</p>\n"}], "owner": {"reputation": 41, "user_id": 5442853, "user_type": "registered", "profile_image": "https://graph.facebook.com/1658664331070328/picture?type=large", "display_name": "Denis Vakula", "link": "https://stackoverflow.com/users/5442853/denis-vakula"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4301, "favorite_count": 1, "protected_date": 1569003932, "answer_count": 4, "score": 1, "last_activity_date": 1614717893, "creation_date": 1444777862, "question_id": 33114093, "link": "https://stackoverflow.com/questions/33114093/excel-hyperlink-to-nothing", "title": "excel hyperlink to nothing", "body": "<p>I've got a lot of hyperlinks and I want to assign a macros to each of them and Worksheet_FollowHyperlink captures only Inserted Hyperlinks but not the HYPERLINK() function. So I want my Inserted Hyperlinks refer to nothing so when I press them nothing happens. Or I want them to refer themselves. But when I just copy one to another cell it still refers to its parents cell. So I have to edit a new one so it refers to its new cell. And I've got hundreeds of hyperlinks to be copied and edited as well. I need that because I don't want the hyperlinks skip me to the parent hyperlink's cell.</p>\n\n<p>Thanks in advance</p>\n"}, {"tags": ["database", "forms", "vba", "ms-access", "openform"], "comments": [{"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1444842796, "post_id": 33113854, "comment_id": 54074752, "body": "You would be wise to tell us which line of the code triggers the error.  This could be the culprit: <code>DoCmd.OpenForm (Cancer_Form)</code>  What is <code>Cancer_Form</code>?  <code>OpenForm</code> needs the form name as a string value, so I&#39;ll guess <i>Cancer_Form</i> is the name of a form and you should use: <code>DoCmd.OpenForm &quot;Cancer_Form&quot;</code>  Parentheses not required."}, {"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1444843122, "post_id": 33113854, "comment_id": 54074940, "body": "Add <code>Option Explicit</code> to your code module&#39;s Declarations section.  Then run Debug-&gt;Compile from the VB Editor&#39;s main menu.  Fix anything the compiler complains about, and repeat compile/fix until no more compile errors."}, {"owner": {"reputation": 15, "user_id": 5442854, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aca8740fb7c50d80b9bee84a706cae37?s=128&d=identicon&r=PG&f=1", "display_name": "JRNewm", "link": "https://stackoverflow.com/users/5442854/jrnewm"}, "reply_to_user": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1444843335, "post_id": 33113854, "comment_id": 54075047, "body": "Thank you so much HansUp! I will try this. If there is no underscore in the Form title, should it be &quot;Cancer Form&quot;?"}, {"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1444843512, "post_id": 33113854, "comment_id": 54075143, "body": "Yes, I think so.  Double-check the form name in the Navigation pane.  However it&#39;s displayed there, put the matching text between the quotes here: <code>DoCmd.OpenForm &quot;&lt;form Name&gt;&quot;</code>"}, {"owner": {"reputation": 15, "user_id": 5442854, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aca8740fb7c50d80b9bee84a706cae37?s=128&d=identicon&r=PG&f=1", "display_name": "JRNewm", "link": "https://stackoverflow.com/users/5442854/jrnewm"}, "reply_to_user": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1444843741, "post_id": 33113854, "comment_id": 54075270, "body": "Unfortunately, after I add &quot;Option Explicit&quot;, and correct all the form names after the DoCmd&#39;s, I still receive a type 13 mismatch error on the line &#39;Case &quot;Cancer [140-208]&quot;&#39;- unsure what I am doing incorrectly. Thanks for all your help anyway."}, {"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1444843903, "post_id": 33113854, "comment_id": 54075361, "body": "Hmm.  What does <code>DiagCat</code> actually contain?  What does this tell you? ... <code>MsgBox &quot;DiagCat value: &quot; &amp; DiagCat &amp; &quot;, DiagCat Type: &quot; &amp; TypeName(DiagCat)</code>"}, {"owner": {"reputation": 15, "user_id": 5442854, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aca8740fb7c50d80b9bee84a706cae37?s=128&d=identicon&r=PG&f=1", "display_name": "JRNewm", "link": "https://stackoverflow.com/users/5442854/jrnewm"}, "reply_to_user": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1444844291, "post_id": 33113854, "comment_id": 54075562, "body": "Was unable to run that code in the &quot;Immediate&quot; window, for some reason. But, the specific combo box &quot;DiagCat&quot; is a SQL row-sourced reference from a separate table, &quot;DxCats&quot;, that uses its &quot;DxCat&quot; text-string field to populate the combo box with: Cancer [140-208] Heart Disease [393-398, 402, 410-429] Stroke [430-438] Diabetes [250] Hypertension [401] Elevated Cholesterol [272] Liver Disease [070, 571-573], etc."}, {"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1444844460, "post_id": 33113854, "comment_id": 54075655, "body": "Oops, sorry.  Add that <code>MsgBox</code> statement in a new line in your VBA code just before the <code>Select Case DiagCat</code> line.   Then run the code."}, {"owner": {"reputation": 15, "user_id": 5442854, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aca8740fb7c50d80b9bee84a706cae37?s=128&d=identicon&r=PG&f=1", "display_name": "JRNewm", "link": "https://stackoverflow.com/users/5442854/jrnewm"}, "reply_to_user": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1444844986, "post_id": 33113854, "comment_id": 54075951, "body": "I figured out how to run your code as a macro; strangely, it lists the data type as &quot;empty&quot;- I have no idea why."}, {"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1444845445, "post_id": 33113854, "comment_id": 54076227, "body": "If you can share a copy of your db, I&#39;ll see if I can figure out why it gives you empty instead of one of the expected string values."}, {"owner": {"reputation": 15, "user_id": 5442854, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aca8740fb7c50d80b9bee84a706cae37?s=128&d=identicon&r=PG&f=1", "display_name": "JRNewm", "link": "https://stackoverflow.com/users/5442854/jrnewm"}, "reply_to_user": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1444846172, "post_id": 33113854, "comment_id": 54076688, "body": "No it gives me the same Type 13 mismatch error on your added line of code beginning with &quot;MsgBox&quot;. If this is taking up too much of your time no worries; thanks for all your efforts thus far."}, {"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1444846313, "post_id": 33113854, "comment_id": 54076762, "body": "The time issue is secondary just now.  I just don&#39;t see how to help without examining your db details."}, {"owner": {"reputation": 15, "user_id": 5442854, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aca8740fb7c50d80b9bee84a706cae37?s=128&d=identicon&r=PG&f=1", "display_name": "JRNewm", "link": "https://stackoverflow.com/users/5442854/jrnewm"}, "reply_to_user": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1444849972, "post_id": 33113854, "comment_id": 54078925, "body": "I understand. Thank you."}], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 5442854, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aca8740fb7c50d80b9bee84a706cae37?s=128&d=identicon&r=PG&f=1", "display_name": "JRNewm", "link": "https://stackoverflow.com/users/5442854/jrnewm"}, "edited": false, "score": 0, "creation_date": 1444831865, "post_id": 33118745, "comment_id": 54067437, "body": "Thank you so much! Very grateful!"}, {"owner": {"reputation": 15, "user_id": 5442854, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aca8740fb7c50d80b9bee84a706cae37?s=128&d=identicon&r=PG&f=1", "display_name": "JRNewm", "link": "https://stackoverflow.com/users/5442854/jrnewm"}, "edited": false, "score": 0, "creation_date": 1444834384, "post_id": 33118745, "comment_id": 54069348, "body": "Woops- new to StackOverflow- I clicked the check- I think that accepts it. Thanks again!"}, {"owner": {"reputation": 15, "user_id": 5442854, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aca8740fb7c50d80b9bee84a706cae37?s=128&d=identicon&r=PG&f=1", "display_name": "JRNewm", "link": "https://stackoverflow.com/users/5442854/jrnewm"}, "edited": false, "score": 0, "creation_date": 1444841529, "post_id": 33118745, "comment_id": 54074011, "body": "So unfortunately, even though I think this is the right way to go about this, I am still getting errors. The specific combo box that is used to generate the &quot;select case&quot; DoCmds is actually a drop-down box that uses SQL to generate LookUp values from another independent table. I was trying to have the cases be specific text strings of the categories able to be chosen, but Access/VBA keeps telling me there is a &quot;Type Mismatch&quot;; is there anyway to referenced the table/field/values of the table each look-up value refers to? Am I doing this completely wrong?"}, {"owner": {"reputation": 15, "user_id": 5442854, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aca8740fb7c50d80b9bee84a706cae37?s=128&d=identicon&r=PG&f=1", "display_name": "JRNewm", "link": "https://stackoverflow.com/users/5442854/jrnewm"}, "edited": false, "score": 0, "creation_date": 1444841593, "post_id": 33118745, "comment_id": 54074043, "body": "I also tried moving the &quot;click event&quot; from an independent button to the very drop down combo box control itself, to Open Forms on the After Update event:"}], "tags": [], "owner": {"reputation": 2126, "user_id": 2473577, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/5ed04ad62699997e452172b83f022e96?s=128&d=identicon&r=PG", "display_name": "E Mett", "link": "https://stackoverflow.com/users/2473577/e-mett"}, "is_accepted": true, "score": 0, "last_activity_date": 1444806334, "creation_date": 1444806334, "answer_id": 33118745, "question_id": 33113854, "link": "https://stackoverflow.com/questions/33113854/database-design-open-form-click-event-in-vba-using-access-specific-inquiry/33118745#33118745", "title": "Database Design/Open Form CLICK EVENT in VBA using Access: Specific Inquiry", "body": "<p>The <code>Select Case</code> keyword is what you need to select an action based on multiple values of a field.</p>\n\n<pre><code>Private Sub cmdOpen_Click() 'where cmdOpen is the button control clicked to open the forms\n      Select Case cmbDxCatsID 'assuming cmbDxCatsID is the name of the combobox control on the form\n      Case 1\n          DoCmd.OpenForm(Form1)\n      Case 2\n          DoCmd.OpenForm(Form2)\n      'etc.........\n      End Select\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 5442854, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aca8740fb7c50d80b9bee84a706cae37?s=128&d=identicon&r=PG&f=1", "display_name": "JRNewm", "link": "https://stackoverflow.com/users/5442854/jrnewm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 676, "favorite_count": 0, "accepted_answer_id": 33118745, "answer_count": 1, "score": 0, "last_activity_date": 1444843276, "creation_date": 1444776227, "last_edit_date": 1444843276, "question_id": 33113854, "link": "https://stackoverflow.com/questions/33113854/database-design-open-form-click-event-in-vba-using-access-specific-inquiry", "title": "Database Design/Open Form CLICK EVENT in VBA using Access: Specific Inquiry", "body": "<p>I wish to program a click event in a \"Main Information\" form that will open up to 17 other forms based on values selected in a multiple-answer look-up field combo control (corresponding to a numeric ID field/text string categories related via an independent, separate table) housed within that \"Main Information\" form.</p>\n\n<p>I have learned this is the general code:</p>\n\n<pre><code> Private Sub DiagCat_AfterUpdate()\n   Select Case DiagCat\n     Case \"Cancer [140-208]\"\n       DoCmd.OpenForm (Cancer_Form)\n     Case \"Heart Disease [393-398, 402, 410-429]\"\n       DoCmd.OpenForm (Heart_Disease_Form)\n     Case \"Stroke [430-438]\"\n      DoCmd.OpenForm (Stroke_Form)\n     Case \"Diabetes [250]\"\n      DoCmd.OpenForm (Diabetes_Form)\n     Case \"Hypertension [401]\"\n      DoCmd.OpenForm (Hypertension_Form)\n    Case \"Liver Disease [070, 571-573]\"\n      DoCmd.OpenForm (Elevated_Cholesterol_Form)\n   End Select\n End Sub\n</code></pre>\n\n<p>VBA issues a \"Type Mismatch\" error 13 now; the error executes on the 'Case \"Cancer [140-208]\"' line.</p>\n\n<p>Thank you. Any assistance greatly appreciated.</p>\n"}, {"tags": ["excel", "vba", "excel-formula"], "answers": [{"tags": [], "owner": {"reputation": 6237, "user_id": 4892468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b9tfr.png?s=128&g=1", "display_name": "EEM", "link": "https://stackoverflow.com/users/4892468/eem"}, "is_accepted": false, "score": 0, "last_activity_date": 1444799591, "last_edit_date": 1444799591, "creation_date": 1444797667, "answer_id": 33116757, "question_id": 33113591, "link": "https://stackoverflow.com/questions/33113591/summarizing-text-data-from-columns-to-rows-in-excel/33116757#33116757", "title": "summarizing text data from columns to rows in excel", "body": "<p>Assuming <em>input</em> and <em>output</em> ranges are located at <code>B6:H27</code> and <code>J11:Q27</code> respectively <em>(update ranges in formulas as required)</em> </p>\n\n<p>Try these formulas:</p>\n\n<p><strong>Household ID</strong> : Enter this <code>FormulaArray</code>, to extract unique items, in <code>J7</code> and copy till last record\n<em>(Formulas Array are entered by pressing</em> <code>[Ctrl]</code> <em>+</em> <code>[Shift]</code> <em>+</em> <code>[Enter]</code> <em>simultaneously)</em></p>\n\n<pre><code>=IFERROR(INDEX($B$6:$B$27,MATCH(0,COUNTIF(J6:J$6,$B$6:$B$27),0)*1),\"\")\n</code></pre>\n\n<p><strong>Household Head Name</strong> : Enter this <code>FormulaArray</code>, to extract Head Name corresponding to Household ID, in <code>K7</code> and copy down till last record</p>\n\n<pre><code>=IFERROR(INDEX($D$6:$D$27,MATCH($J7&amp;\"Head\",$B$6:$B$27&amp;$G$6:$G$27,0),0),\"\")\n</code></pre>\n\n<p><strong>Spouse Name</strong> : Enter this <code>FormulaArray</code>, to extract Spouse Name corresponding to Household ID, in <code>L7</code> and copy down till last record</p>\n\n<pre><code>=IFERROR(INDEX($D$6:$D$27,MATCH($J7&amp;\"Spouse\",$B$6:$B$27&amp;$G$6:$G$27,0),0),\"\")\n</code></pre>\n\n<p><strong>Marital Status</strong> : Enter this <code>FormulaArray</code>, to extract Marital Status corresponding to Household ID, in <code>M7</code> and copy down till last record</p>\n\n<pre><code>=IFERROR(INDEX($E$6:$E$27,MATCH($J7&amp;\"Head\",$B$6:$B$27&amp;$G$6:$G$27,0),0),\"\")\n</code></pre>\n\n<p><strong>Women Head of Household</strong> : Enter this <code>FormulaArray</code>, to validate gender of Head Name, in <code>N7</code> and copy down till last record</p>\n\n<pre><code>=IFERROR(IF(INDEX($H$6:$H$27,\nMATCH($J7&amp;\"Head\",$B$6:$B$27&amp;$G$6:$G$27,0),0)=\"Female\",\"Y\",\"N\"),\"\")\n</code></pre>\n\n<p><strong>Number of Male under 18</strong> : Enter this Formula in <code>O7</code> and copy down till last record</p>\n\n<pre><code>=IF(EXACT($J7,\"\"),\"\",\nCOUNTIFS($B$6:$B$27,$J7,$H$6:$H$27,\"Male\",$F$6:$F$27,\"&lt;18\"))\n</code></pre>\n\n<p><strong>Number of Female under 18</strong> : Enter this Formula in <code>P7</code> and copy down till last record</p>\n\n<pre><code>=IF(EXACT($J7,\"\"),\"\",\nCOUNTIFS($B$6:$B$27,$J7,$H$6:$H$27,\"Female\",$F$6:$F$27,\"&lt;18\"))\n</code></pre>\n\n<p><strong>Family Size</strong> : Enter this Formula in <code>Q7</code> and copy down till last record</p>\n\n<pre><code>=IF(EXACT($J7,\"\"),\"\",COUNTIF($B$6:$B$27,$J7))\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/WsWiH.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/WsWiH.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 1, "user_id": 4670059, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e975fe682df929d8a821a57c141e3ae?s=128&d=identicon&r=PG", "display_name": "Kami", "link": "https://stackoverflow.com/users/4670059/kami"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 289, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1444813643, "creation_date": 1444774769, "question_id": 33113591, "link": "https://stackoverflow.com/questions/33113591/summarizing-text-data-from-columns-to-rows-in-excel", "title": "summarizing text data from columns to rows in excel", "body": "<p>I have data in the below mentioned format:\n<a href=\"http://i.stack.imgur.com/cnm87.png\" rel=\"nofollow\">Format in which i have data</a></p>\n\n<p>But i wants to convert it into the below mentioned format:\n<a href=\"http://i.stack.imgur.com/rOA3Y.png\" rel=\"nofollow\">format to which i convert the data</a>\nI checked the questions asked before they are more related to pivot and unpivot this is also a pivot but conditional and i dont know how to do it in excel, while i don't know any programming language. While the number of records is more than 10,000 thats why i cannot do that manually.</p>\n"}, {"tags": ["image", "ms-access", "ms-word", "vba", "word-wrap"], "comments": [{"owner": {"reputation": 1482, "user_id": 5043393, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/effb702a40d17cd670f56f051847b33f?s=128&d=identicon&r=PG&f=1", "display_name": "LiamH", "link": "https://stackoverflow.com/users/5043393/liamh"}, "edited": false, "score": 0, "creation_date": 1444808063, "post_id": 33113445, "comment_id": 54051796, "body": "Could you use a report to generate this or do you require Word?"}, {"owner": {"reputation": 23, "user_id": 3752692, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c9759c2675e69b4286e184e97712d6f6?s=128&d=identicon&r=PG&f=1", "display_name": "David", "link": "https://stackoverflow.com/users/3752692/david"}, "reply_to_user": {"reputation": 1482, "user_id": 5043393, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/effb702a40d17cd670f56f051847b33f?s=128&d=identicon&r=PG&f=1", "display_name": "LiamH", "link": "https://stackoverflow.com/users/5043393/liamh"}, "edited": false, "score": 0, "creation_date": 1444809072, "post_id": 33113445, "comment_id": 54052429, "body": "I can&#39;t make the text wrap along the images in Access report, It doesn&#39;t seem to have that funcationality. Thats why I go for Word. Wrapping saves a lot of space and make it look better."}, {"owner": {"reputation": 23, "user_id": 3752692, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c9759c2675e69b4286e184e97712d6f6?s=128&d=identicon&r=PG&f=1", "display_name": "David", "link": "https://stackoverflow.com/users/3752692/david"}, "reply_to_user": {"reputation": 1482, "user_id": 5043393, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/effb702a40d17cd670f56f051847b33f?s=128&d=identicon&r=PG&f=1", "display_name": "LiamH", "link": "https://stackoverflow.com/users/5043393/liamh"}, "edited": false, "score": 0, "creation_date": 1444825101, "post_id": 33113445, "comment_id": 54062545, "body": "I&#39;ve kind of given upp the above issue since it seems too difficult and looking now for a way to retrieve single postdata from the 2007 Access database through a vb sub, for example like getProductName(28), where 28 is the product ID in the database. Does anyone know how to write that sub in vb?"}], "answers": [{"tags": [], "owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "is_accepted": false, "score": -1, "last_activity_date": 1444922368, "creation_date": 1444922368, "answer_id": 33152378, "question_id": 33113445, "link": "https://stackoverflow.com/questions/33113445/display-access-data-with-image-paths-in-word-document/33152378#33152378", "title": "Display Access data with image paths in Word document", "body": "<p>This is possible, but works better in older versions of Word. Unfortunately, you don't mention which version you're using...</p>\n\n<p>Anyway, the key to the question is to use an IncludePicture field to bring the picture in; pass the file path to the field using the MergeField (nested fields). You can find more information on the internet, for example: <a href=\"http://homepage.swissonline.ch/cindymeister/mergfaq1.htm#DBPic\" rel=\"nofollow\">http://homepage.swissonline.ch/cindymeister/mergfaq1.htm#DBPic</a></p>\n\n<p>The problem with an IncludePicture field is that it can't be wrapped. But if your version of Word is not too old, tables CAN wrap, so you put the IncludePicture field into a table that's a single cell. Position the table, wrap it, etc.</p>\n"}], "owner": {"reputation": 23, "user_id": 3752692, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c9759c2675e69b4286e184e97712d6f6?s=128&d=identicon&r=PG&f=1", "display_name": "David", "link": "https://stackoverflow.com/users/3752692/david"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 392, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1556036692, "creation_date": 1444773944, "last_edit_date": 1556036692, "question_id": 33113445, "link": "https://stackoverflow.com/questions/33113445/display-access-data-with-image-paths-in-word-document", "title": "Display Access data with image paths in Word document", "body": "<p>I would like to make a Word product catalog from data stored in an Access 2007 database. I can of course use the \"mail merge\" function in Word for the text data, but I dont know how to make the images show up! They are they stored as file paths in Access and jpg-files in a directory on the hard drive. The images should have a special size, be right aligned to the text paragraphs so that the text is wrapping on the left side (see attached image).</p>\n\n<p><img src=\"https://i.stack.imgur.com/xogYt.jpg\" alt=\"enter image description here\"></p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 12614, "user_id": 3566998, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S7lz6.png?s=128&g=1", "display_name": "Excel Hero", "link": "https://stackoverflow.com/users/3566998/excel-hero"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1444774916, "post_id": 33113494, "comment_id": 54041561, "body": "@findwindow With the AdvancedFilter, absolutely."}, {"owner": {"reputation": 12614, "user_id": 3566998, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S7lz6.png?s=128&g=1", "display_name": "Excel Hero", "link": "https://stackoverflow.com/users/3566998/excel-hero"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1444809813, "post_id": 33113494, "comment_id": 54052835, "body": "@Ryan_C Do you need help getting this going? Please let me know."}, {"owner": {"reputation": 449, "user_id": 3100879, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/85e6fc486c9ebbc8b742538d5227b921?s=128&d=identicon&r=PG&f=1", "display_name": "Ryan_C", "link": "https://stackoverflow.com/users/3100879/ryan-c"}, "edited": false, "score": 0, "creation_date": 1444835630, "post_id": 33113494, "comment_id": 54070235, "body": "@ExcelHero I&#39;m still thinking of a better way to phrase the question.  There are a lot of variables going on that make this hard phrase properly."}, {"owner": {"reputation": 12614, "user_id": 3566998, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S7lz6.png?s=128&g=1", "display_name": "Excel Hero", "link": "https://stackoverflow.com/users/3566998/excel-hero"}, "reply_to_user": {"reputation": 449, "user_id": 3100879, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/85e6fc486c9ebbc8b742538d5227b921?s=128&d=identicon&r=PG&f=1", "display_name": "Ryan_C", "link": "https://stackoverflow.com/users/3100879/ryan-c"}, "edited": false, "score": 0, "creation_date": 1444836108, "post_id": 33113494, "comment_id": 54070530, "body": "@Ryan_C Fair enough, but I think my solution clearly answers the question posed. Please remember that Stack Overflow is a resource for future visitors seeking help with their questions as well. If you have a differently worded question, please post that as a new question, and accept this answer."}], "tags": [], "owner": {"reputation": 12614, "user_id": 3566998, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S7lz6.png?s=128&g=1", "display_name": "Excel Hero", "link": "https://stackoverflow.com/users/3566998/excel-hero"}, "is_accepted": false, "score": 1, "last_activity_date": 1444836171, "last_edit_date": 1444836171, "creation_date": 1444774225, "answer_id": 33113494, "question_id": 33113372, "link": "https://stackoverflow.com/questions/33113372/using-excel-vba-to-hide-rows-based-on-cell-value/33113494#33113494", "title": "Using Excel VBA To Hide Rows Based on Cell Value", "body": "<p>Try this.</p>\n\n<p>Place this routine in a standard code module.</p>\n\n<pre><code>Public Sub Ryan_C()\n\n    Dim rCrit As Range, rData As Range\n\n    With Sheets(\"Sheet1\").[a1]\n        Set rData = .Resize(.Item(.Parent.Rows.Count).End(xlUp).Row, .Item(, .Parent.Columns.Count).End(xlToLeft).Column)\n    End With\n\n    With Sheets(\"Sheet2\").[a1]\n        Set rCrit = .Resize(.Item(.Parent.Rows.Count).End(xlUp).Row)\n    End With\n\n    rData.AdvancedFilter xlFilterInPlace, rCrit\n\nEnd Sub\n</code></pre>\n\n<p>Note: this assumes the 800 chemical compounds are in Sheet1 and the 200 CAS Registry numbers are in Sheet2. Edit the sheet names as needed.</p>\n\n<p>Note: this assumes the data in both sheets begin in cell A1.</p>\n\n<p>Note: IT ALSO ASSUMES THAT THE CAS HEADER AT THE TOP OF BOTH SHEETS MATCH.</p>\n"}], "owner": {"reputation": 449, "user_id": 3100879, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/85e6fc486c9ebbc8b742538d5227b921?s=128&d=identicon&r=PG&f=1", "display_name": "Ryan_C", "link": "https://stackoverflow.com/users/3100879/ryan-c"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 139, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1444836171, "creation_date": 1444773605, "last_edit_date": 1531161705, "question_id": 33113372, "link": "https://stackoverflow.com/questions/33113372/using-excel-vba-to-hide-rows-based-on-cell-value", "title": "Using Excel VBA To Hide Rows Based on Cell Value", "body": "<p>Alright...back again with another Excel question.</p>\n\n<p>This time around, I have an Excel workbook which has the chemical and physical properties of 800 chemicals/compounds.  I have another workbook that has about 200 of these chemicals.</p>\n\n<p>What I need to do in the workbook with the 800 chemicals is only display the chemicals that are displayed in the smaller workbook.  I could technically go through all 800 chemicals and use the \"Filter\" function to deselect everything I don't want, but obviously that would take forever and there is surely a faster way.</p>\n\n<p><strong>Heres what I'm thinking needs to happen:</strong></p>\n\n<p>In both workbooks, CAS number is one of the columns.  I have copied all of the CAS numbers for the chemicals I <strong><em>want</em></strong> to have displayed into a new column in the larger workbook.  What I would like to do is have some VBA code that basically says this: \"If the CAS number in the larger workbook equals the CAS number in the smaller workbook, display that chemical.  If it doesn't, then don't display it.</p>\n\n<p>If that's difficult to understand then I apologize, it's tough to put into words.</p>\n\n<pre><code>This is what I started doing:\n\n    Sub HideRows()\n\n    BeginRow = 3\n    EndRow = 802\n    ChkCol = 3\n\n    For RowCnt = BeginRow To EndRow\n\n        If Cells(RowCnt, ChkCol).Value = \"A3\" Then\n            Cells(RowCnt, ChkCol).EntireRow.Hidden = True\n        Else\n            Cells(RowCnt, ChkCol).EntireRow.Hidden = False\n        End If\n        Next RowCnt\n\n\n    End Sub\n</code></pre>\n\n<p>I don't think that's right though.  Any ideas?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 13122, "user_id": 1001884, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14116728c7413097a42cf22736503f56?s=128&d=identicon&r=PG", "display_name": "Hambone", "link": "https://stackoverflow.com/users/1001884/hambone"}, "edited": false, "score": 0, "creation_date": 1444773402, "post_id": 33113275, "comment_id": 54040993, "body": "Can you add a button?  Those have events."}], "answers": [{"comments": [{"owner": {"reputation": 361, "user_id": 11738627, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-sVrcM144Qb8/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdf8GVfYBMmDcu1kPwkGrFSZUDOVQ/photo.jpg?sz=128", "display_name": "6diegodiego9", "link": "https://stackoverflow.com/users/11738627/6diegodiego9"}, "edited": false, "score": 0, "creation_date": 1573136876, "post_id": 33113436, "comment_id": 103789939, "body": "This is not exactly the correct answer because it doesn&#39;t trigger if the cell is already (the only cell) selected."}, {"owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "reply_to_user": {"reputation": 361, "user_id": 11738627, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-sVrcM144Qb8/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdf8GVfYBMmDcu1kPwkGrFSZUDOVQ/photo.jpg?sz=128", "display_name": "6diegodiego9", "link": "https://stackoverflow.com/users/11738627/6diegodiego9"}, "edited": false, "score": 0, "creation_date": 1573142727, "post_id": 33113436, "comment_id": 103793330, "body": "@6diegodiego9, This is the answer the OP was looking for. Good thing you showed up 4 yrs later to make a comment."}], "tags": [], "owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "is_accepted": true, "score": 6, "last_activity_date": 1444773903, "creation_date": 1444773903, "answer_id": 33113436, "question_id": 33113275, "link": "https://stackoverflow.com/questions/33113275/vba-click-a-cell-and-action-extremely-simple-but-not-for-me/33113436#33113436", "title": "VBA click a cell and action, extremely simple but not for me", "body": "<p>This code belongs in the worksheet module.</p>\n\n<p>Right click on the sheet tab and select \"View Code\"</p>\n\n<p>Paste this code there:</p>\n\n<pre><code>Private Sub Worksheet_SelectionChange(ByVal Target As Range)\n    If Target.Address = \"$A$1\" Then\n        If Target = 1 Then\n            MsgBox \"hi\"\n        End If\n    End If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 171, "user_id": 5421582, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/3c83280fde3b4628c537a210ef323b42?s=128&d=identicon&r=PG&f=1", "display_name": "Yong", "link": "https://stackoverflow.com/users/5421582/yong"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7203, "favorite_count": 0, "accepted_answer_id": 33113436, "answer_count": 1, "score": 2, "last_activity_date": 1444773903, "creation_date": 1444773096, "question_id": 33113275, "link": "https://stackoverflow.com/questions/33113275/vba-click-a-cell-and-action-extremely-simple-but-not-for-me", "title": "VBA click a cell and action, extremely simple but not for me", "body": "<p>H! \nI am new to VBA.\nThis maybe a too simple of a question, but I am struggling to use VBA:\nwhen a cell(1,1) is clicked as it has 1, the msgbox would show up saying \"hi\"</p>\n\n<pre><code>Sub test()\n\n'click action 'when cell(1,1) is clicked and if cells(1,1) is 1, msgbox saying \"hi\" will show up, if not nothing If Cells(1, 1) = 1 Then\n    MsgBox \"hi\"\n    Else \nEnd If\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "fonts", "statusbar", "vba"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1444775576, "post_id": 33113161, "comment_id": 54041808, "body": "The status bar font size is not handled by Excel. It is set within your Windows Personalization, Advanced Window Color, Item:Menu, Font: Size:. Sometimes a poorly written program&#39;s GUI will override these settings (hopefully temporarily)."}, {"owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "edited": false, "score": 0, "creation_date": 1444792167, "post_id": 33113161, "comment_id": 54045958, "body": "Inadvertently you are achieving what can only be done with API calls :) can you post more context, like the full loop (or the entire function if it&#39;s not too long), and make sure to include how variables <code>iCase</code> , <code>j</code>, and <code>icoljcount</code> are declared (what type) - if the code does it, then you&#39;ll also have control over it when you do intend to change it (I have Windows 7, 2010 Excel 64-bit, &quot;Silver&quot; theme, changed the Theme to Black and can&#39;t reproduce it)"}], "answers": [{"tags": [], "owner": {"reputation": 93, "user_id": 3678108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/27670047e2b681fcd4c84b038e415565?s=128&d=identicon&r=PG&f=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/3678108/chris"}, "is_accepted": false, "score": 3, "last_activity_date": 1445134323, "last_edit_date": 1445134323, "creation_date": 1444855926, "answer_id": 33135371, "question_id": 33113161, "link": "https://stackoverflow.com/questions/33113161/excel-statusbar-font-size-changing-unintentionally/33135371#33135371", "title": "Excel StatusBar Font Size Changing Unintentionally", "body": "<p>I duplicated my macro in a new sub in order to trim it down to the bare minimum that was necessary for people to follow the loop.  To make a long 'answer' short(er), the only line that mattered was:</p>\n\n<pre><code>Application.ScreenUpdating = False\n</code></pre>\n\n<p>As I was preparing this answer I learned even a bit more.  My problem might still be the combination of ScreenUpdating AND calling of the external program.  Here's a sample code of a pretty simple StatusBar with loop...</p>\n\n<pre><code>Sub StatusBarTest()\n\nDim i As Integer\n\nApplication.DisplayStatusBar = True\nApplication.ScreenUpdating = False '&lt;-- toggle on/off to see the effects\n\nFor i = 1 To 5\n\nApplication.StatusBar = \"Loop #\" &amp; i &amp; \" of 5.  Extremely long StatusBar text so as to amplify a font size change.\"\n\n'In my full loop this is where my Application.Run statement goes.\n\nApplication.Wait (Now + TimeValue(\"00:00:02\")) '2 second delay so user has a chance to witness StatusBar\n\nNext i\n\nApplication.StatusBar = False\nApplication.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n\n<p>When I run this sub from Excel I do NOT see any font switching.  But when I step through the code with F8 from VBA I see the larger font for a split second each time the StatusBar is updated, IF screen updating is turned off as written above.  If I comment out the screenupdating line then I don't see the font switch even when stepping through the code.</p>\n\n<p>I really don't understand why VBA/Excel behaves like this, but I believe I've identified the cause/effect pattern.</p>\n"}], "owner": {"reputation": 93, "user_id": 3678108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/27670047e2b681fcd4c84b038e415565?s=128&d=identicon&r=PG&f=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/3678108/chris"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2386, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1551967277, "creation_date": 1444772606, "last_edit_date": 1551967277, "question_id": 33113161, "link": "https://stackoverflow.com/questions/33113161/excel-statusbar-font-size-changing-unintentionally", "title": "Excel StatusBar Font Size Changing Unintentionally", "body": "<p>I've been living with a very strange Excel quirk regarding the StatusBar for almost a year now, and was wondering if anyone had any insight, and possible solutions.  There were about a dozen or so posts about how to update the StatusBar, but nothing quite related specifically to its appearance.  I believe one user asked about changing the font color, but the solution was to use something other than the StatusBar.</p>\n\n<p>Anyway, I use a macro to call a separate modeling software add-in.  We have numerous cases organized in columns and each case may need to be 'run' several times.  So I use the StatusBar to let me know which column it's on, the case #, and which iteration for that specific case.  It looks like this...</p>\n\n<p><a href=\"https://i.stack.imgur.com/nTEe8.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/nTEe8.png\" alt=\"Large Font Version of StatusBar\"></a></p>\n\n<p>This is the single line of code that I use to populate the StatusBar:</p>\n\n<pre><code>Application.StatusBar = \"Processing column \" &amp; Split(Cells(1, icol).Address(True, False), \"$\")(0) &amp; \", Case \" &amp; iCase &amp; \", Iteration (Loop) \" &amp; j &amp; \" of \" &amp; icoljcount\n</code></pre>\n\n<p>The issue I have is that the appearance bounces back and forth between the previous image (Large font) and the following image (Small font):</p>\n\n<p><a href=\"https://i.stack.imgur.com/0PLvD.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/0PLvD.png\" alt=\"Small Font Version of StatusBar\"></a></p>\n\n<p>I included a few tabs in the screen shots so you could see the size change.  I have no idea why it does this.  It doesn't really affect the function, except that it makes your eyes jump if you're watching it.  And I watch it a lot.  It get's annoying.  And I hesitate to add more useful info to the StatusBar if I can't resolve this.</p>\n\n<p>I put in a codebreak and stepped through to see if I could identify which line was being executed when each font size appeared.  Turned out BOTH appeared when I hit F8 on the line above I provided.  The large version appeared first, but only lasted split second before it switched to the small version.  When my macro is running the large version sticks around for a full second - I believe this is because the very next line of code calls the external program, which triggers a recalc of the spreadsheet, and it's a very large spreadsheet.</p>\n\n<p>I may be able to mitigate the annoyance by adding a 100 millisecond 'sleep' before calling the external program.  That might give Excel the split second it needs to flip to the small font version before getting bogged down with the recalc.  But I honestly don't know if that will end up being more or less annoying.</p>\n\n<p>Just in case it matters, I'm using Windows 7, 2010 Excel 32-bit, \"Silver\" Excel theme, and enjoy The High Life, but not at work or this wouldn't annoy me nearly as much.</p>\n\n<p>Sorry for the lengthy question.  Thanks in advance to whoever cracks this one open. </p>\n"}, {"tags": ["excel", "runtime-error", "vba"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1444772639, "post_id": 33113098, "comment_id": 54040675, "body": "It looks like <i>last</i> and/or <i>last1</i> are referencing row 1,048,576. Trying to <code>.Transpose</code> Y2:Y1048576 exceeds the Transpose function limits (I think it is 65,536)."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1444772919, "post_id": 33113098, "comment_id": 54040809, "body": "Change your arrays to variants not strings"}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 5082050, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/e436437d0db4de548ef40ad9d350250d?s=128&d=identicon&r=PG&f=1", "display_name": "Dev", "link": "https://stackoverflow.com/users/5082050/dev"}, "edited": false, "score": 0, "creation_date": 1444810651, "post_id": 33113514, "comment_id": 54053322, "body": "thanks for the info. I changed the code with x1Up and run. Still having same error but now the line is          For c = 1 To UBound(arrayv1)"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 23, "user_id": 5082050, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/e436437d0db4de548ef40ad9d350250d?s=128&d=identicon&r=PG&f=1", "display_name": "Dev", "link": "https://stackoverflow.com/users/5082050/dev"}, "edited": false, "score": 0, "creation_date": 1444811781, "post_id": 33113514, "comment_id": 54053918, "body": "That would be because a single cell value is not an array and does not have a <a href=\"https://msdn.microsoft.com/en-us/library/office/gg278658.aspx\" rel=\"nofollow noreferrer\">UBound</a> property. You could try changing both of them to look like <code>For LBound(Array(arrayv1)) to UBound(Array(arrayv1))</code> but that might just shift the problem further down again. Consider identifying single entries and running a separate process."}, {"owner": {"reputation": 23, "user_id": 5082050, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/e436437d0db4de548ef40ad9d350250d?s=128&d=identicon&r=PG&f=1", "display_name": "Dev", "link": "https://stackoverflow.com/users/5082050/dev"}, "edited": false, "score": 0, "creation_date": 1444833645, "post_id": 33113514, "comment_id": 54068816, "body": "thanks again for the info. I have an idea to bypass this issue and use the original code..I will write a code to insert one row upfront which will have a combination AA - ZZ and write another code for deleting the tab named AA - ZZ at the end of the macro. This should work. I can write the code to insert the row but i donno the code to look for the tab AA-ZZ and delete it. Any luck on that ? Please note the tab can be 2) AA-ZZ , 3) AA-ZZ ...or any number ) AA-ZZ"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 0, "last_activity_date": 1444774333, "creation_date": 1444774333, "answer_id": 33113514, "question_id": 33113098, "link": "https://stackoverflow.com/questions/33113098/run-time-error-13-when-column-doesnt-have-different-values/33113514#33113514", "title": "Run time error 13 when column doesn&#39;t have different values", "body": "<p>If there is only one value Y2 or Z2 downwards then using the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff839539.aspx\" rel=\"nofollow\">Range,End property</a> with an <a href=\"https://msdn.microsoft.com/en-us/library/office/ff820880.aspx\" rel=\"nofollow\">xlDirection</a> of <code>xlDown</code> is going to reference row  1,048,576. The <a href=\"https://msdn.microsoft.com/en-us/library/office/ff196261.aspx\" rel=\"nofollow\">WorksheetFunction.Transpose method</a> has a limit of  65,536. Anything exceeding this limit will result in,</p>\n\n<blockquote>\n  <p>Run-time error '13':<br/>Type mismatch.</p>\n</blockquote>\n\n<p>Change the direction of the last-row-seek to look up from the bottom with <code>xlUp</code>.</p>\n\n<pre><code>last = Range(\"Z\" &amp; rows.count).End(xlUp).Row\narrayv = WorksheetFunction.Transpose(Sheets(1).Range(\"Z2:Z\" &amp; last).Value)\n\n\nlast1 = Range(\"Y\" &amp; rows.count).End(xlUp).Row\narrayv1 = WorksheetFunction.Transpose(Sheets(1).Range(\"Y2:Y\" &amp; last1).Value)\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 5082050, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/e436437d0db4de548ef40ad9d350250d?s=128&d=identicon&r=PG&f=1", "display_name": "Dev", "link": "https://stackoverflow.com/users/5082050/dev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 82, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1444833765, "creation_date": 1444772317, "last_edit_date": 1592644375, "question_id": 33113098, "link": "https://stackoverflow.com/questions/33113098/run-time-error-13-when-column-doesnt-have-different-values", "title": "Run time error 13 when column doesn&#39;t have different values", "body": "<h1>Following is part of my program which does the follwoing function</h1>\n<p>It will look into column K and column L and create tabs according to the combinations. For example if column K has a  cell value &quot;Apple&quot; and column L has one  cell value &quot;Orange&quot; it will create a tab 1) Apple - Orange</p>\n<p>The new tab will have all the rows with this combination\nSo once complete the running of macro , the whole data will get divided to different tabs according to the K - L combination</p>\n<p>My problem is it is giving a run time error when entire column K or entire column L has only one value. For example if entire K column has 10 rows and all column k cells has value Apple it will give error. same goes for column L.</p>\n<pre><code>Dim m As Integer\nDim area As Range\nCount = Range(&quot;K:K&quot;).SpecialCells(xlLastCell).Row\nActiveSheet.Range(&quot;K2:K&quot; &amp; Count).AdvancedFilter Action:=xlFilterCopy,   \nCopyToRange:=ActiveSheet.Range(&quot;Z2&quot;), Unique:=True\n\nColumns(26).RemoveDuplicates Columns:=Array(1)\n\n\nCount1 = Range(&quot;L:L&quot;).SpecialCells(xlLastCell).Row\nActiveSheet.Range(&quot;L2:L&quot; &amp; Count1).AdvancedFilter Action:=xlFilterCopy,    \nCopyToRange:=ActiveSheet.Range(&quot;Y2&quot;), Unique:=True\nColumns(25).RemoveDuplicates Columns:=Array(1)\nDim arrayv As String\n\nDim Text1 As String\n\nDim arrayv1 As String\n\nlast = Range(&quot;Z2&quot;).End(xlDown).Row\n  \narrayv = WorksheetFunction.Transpose(Sheets(1).Range(&quot;Z2:Z&quot; &amp; last).Value)\n\n\nlast1 = Range(&quot;Y2&quot;).End(xlDown).Row\n  \narrayv1 = WorksheetFunction.Transpose(Sheets(1).Range(&quot;Y2:Y&quot; &amp; last1).Value)\n\nColumns(26).EntireColumn.Delete\nColumns(25).EntireColumn.Delete\n\nDim i As Long, j As Long\nDim flag As Variant\nflag = 1\n\nA = 1\ns = 2\nFor c = 1 To UBound(arrayv1)\n\nFor t = 1 To UBound(arrayv)\n\nSheets.Add().Name = &quot;Sheet&quot; &amp; s\nActiveSheet.Move After:=Sheets(ActiveWorkbook.Sheets.Count)\n\nWith Worksheets(&quot;Sheet1&quot;)\nj = 2\n.Rows(1).Copy Destination:=Worksheets(&quot;Sheet&quot; &amp; s).Range(&quot;A&quot; &amp; 1)\nflag = 1\nFor i = 2 To Count\n     If .Cells(i, 11).Value = arrayv(t) Then\n     If .Cells(i, 12).Value = arrayv1(c) Then\n     Text = .Cells(i, 15).Value\n              \n     \n     flag = 0\n\n           .Rows(i).Copy Destination:=Worksheets(&quot;Sheet&quot; &amp; s).Range(&quot;A&quot; &amp; j)\n           \n        \n           j = j + 1\n           End If\n        \n     End If\n  Next i\n\n    If flag = 1 Then\n    \n    Sheets(&quot;Sheet&quot; &amp; s).Delete\n    \n    Else\n    \n   Text1 = Left(Text, 4)\n</code></pre>\n<p>Error line when column K has only one value</p>\n<pre><code> arrayv = WorksheetFunction.Transpose(Sheets(1).Range(&quot;Z2:Z&quot; &amp; last).Value)\n</code></pre>\n<p>Error line when column L has only one value</p>\n<pre><code>arrayv1 = WorksheetFunction.Transpose(Sheets(1).Range(&quot;Y2:Y&quot; &amp; last1).Value)\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 49, "user_id": 1332019, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/eb79c6c769d6c3231a82dfc5721439de?s=128&d=identicon&r=PG", "display_name": "cemg", "link": "https://stackoverflow.com/users/1332019/cemg"}, "edited": false, "score": 0, "creation_date": 1444771074, "post_id": 33112293, "comment_id": 54039877, "body": "Thanks David for the suggestion. My code seem very long is there a way to concise it with all the Dim for the Source File and Prod File."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "reply_to_user": {"reputation": 49, "user_id": 1332019, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/eb79c6c769d6c3231a82dfc5721439de?s=128&d=identicon&r=PG", "display_name": "cemg", "link": "https://stackoverflow.com/users/1332019/cemg"}, "edited": false, "score": 0, "creation_date": 1444771389, "post_id": 33112293, "comment_id": 54040066, "body": "I don&#39;t think there&#39;s anything wrong with your code,  it&#39;s pretty concise already. You can declare multiple vars on a single line, but I don&#39;t like to do that,  e.g., <code>Dim FileNameSource$, FileNameProd$</code> could go on one line."}, {"owner": {"reputation": 49, "user_id": 1332019, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/eb79c6c769d6c3231a82dfc5721439de?s=128&d=identicon&r=PG", "display_name": "cemg", "link": "https://stackoverflow.com/users/1332019/cemg"}, "edited": false, "score": 0, "creation_date": 1444831621, "post_id": 33112293, "comment_id": 54067251, "body": "David thank you for the correction. I was having diffulties running it. I want to concise the codes to a few lines, is too clutter. Thanks once again."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "reply_to_user": {"reputation": 49, "user_id": 1332019, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/eb79c6c769d6c3231a82dfc5721439de?s=128&d=identicon&r=PG", "display_name": "cemg", "link": "https://stackoverflow.com/users/1332019/cemg"}, "edited": false, "score": 0, "creation_date": 1444833043, "post_id": 33112293, "comment_id": 54068327, "body": "Cheers. Do consider up voting or accepting the answer if it&#39;s helpful to solve your problem."}, {"owner": {"reputation": 49, "user_id": 1332019, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/eb79c6c769d6c3231a82dfc5721439de?s=128&d=identicon&r=PG", "display_name": "cemg", "link": "https://stackoverflow.com/users/1332019/cemg"}, "edited": false, "score": 0, "creation_date": 1444835101, "post_id": 33112293, "comment_id": 54069857, "body": "Thanks David. It now works. thanks a lot for the suggestions and corrections"}, {"owner": {"reputation": 49, "user_id": 1332019, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/eb79c6c769d6c3231a82dfc5721439de?s=128&d=identicon&r=PG", "display_name": "cemg", "link": "https://stackoverflow.com/users/1332019/cemg"}, "edited": false, "score": 0, "creation_date": 1445017781, "post_id": 33112293, "comment_id": 54160406, "body": "David, one more question. I added the shtToCopy.copy to ActiveWB.Sheets (thisworkbook.sheets.count) , now I want to copy 6  sheets from wkbSource to activeWB. how do I add the code to copy all 6 consecutively."}, {"owner": {"reputation": 49, "user_id": 1332019, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/eb79c6c769d6c3231a82dfc5721439de?s=128&d=identicon&r=PG", "display_name": "cemg", "link": "https://stackoverflow.com/users/1332019/cemg"}, "edited": false, "score": 0, "creation_date": 1445017822, "post_id": 33112293, "comment_id": 54160434, "body": "Trying to use the For Each, Next but is not coming up right. any light on this issues is greatly appreciated."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "reply_to_user": {"reputation": 49, "user_id": 1332019, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/eb79c6c769d6c3231a82dfc5721439de?s=128&d=identicon&r=PG", "display_name": "cemg", "link": "https://stackoverflow.com/users/1332019/cemg"}, "edited": false, "score": 0, "creation_date": 1445018627, "post_id": 33112293, "comment_id": 54160833, "body": "This all is starting to sound like a separate/new question, while it may be related to this code, it should probably be asked as a new question. Also, in accordance with standard etiquette here, if the above answer has solved your original question, you&#39;re encouraged to upvote or &quot;accept&quot; it..."}, {"owner": {"reputation": 49, "user_id": 1332019, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/eb79c6c769d6c3231a82dfc5721439de?s=128&d=identicon&r=PG", "display_name": "cemg", "link": "https://stackoverflow.com/users/1332019/cemg"}, "edited": false, "score": 1, "creation_date": 1445020411, "post_id": 33112293, "comment_id": 54161737, "body": "David , I have been using this site for a while from time to time, and finally figure it out I have to  press the up/down arrows. Thank you once again."}], "tags": [], "owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "is_accepted": true, "score": 0, "last_activity_date": 1444771485, "last_edit_date": 1444771485, "creation_date": 1444769107, "answer_id": 33112293, "question_id": 33112158, "link": "https://stackoverflow.com/questions/33112158/excel-vba-copy-multiple-worksheets-from-a-source-file-to-production-file/33112293#33112293", "title": "Excel VBA copy multiple worksheets from a Source File to Production file", "body": "<p>I think deleting the prior sheet, if it exists, will be more logical and easier to interpret in the future.  Use a function like so:</p>\n\n<pre><code>Sub DeleteSheet(fromWorkbook as Workbook, sheetName as String)\n    'Deletes a named sheet from a workbook\n    '  error would occur if the sheet doesn't exist (subscript out of range)\n    '  which is ignored by Resume Next\n    On Error Resume Next\n    Application.DisplayAlerts = False\n    fromWorkbook.Sheets(sheetName).Delete\n    Application.DisplayAlerts = True\n    On Error GoTo 0\nEnd Sub\n</code></pre>\n\n<p>Then, in your code where you need to make the copy, do:</p>\n\n<pre><code>Set shtToCopy = wkbSource.Sheets(\"Active US\")\nCall DeleteSheet(wkbProd, \"Active US\")\nshtToCopy.copy wkbProd.Sheets(wkbProd.Sheets.Count)\n</code></pre>\n\n<p>You'll want to remove the double quotes here:</p>\n\n<pre><code>Set wkbSource = Workbooks.Open(DpathSource)\nSet wkbProd = Workbooks.Open(DpathProd)\n</code></pre>\n"}], "owner": {"reputation": 49, "user_id": 1332019, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/eb79c6c769d6c3231a82dfc5721439de?s=128&d=identicon&r=PG", "display_name": "cemg", "link": "https://stackoverflow.com/users/1332019/cemg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 333, "favorite_count": 1, "accepted_answer_id": 33112293, "answer_count": 1, "score": 0, "last_activity_date": 1444771485, "creation_date": 1444768590, "last_edit_date": 1531164843, "question_id": 33112158, "link": "https://stackoverflow.com/questions/33112158/excel-vba-copy-multiple-worksheets-from-a-source-file-to-production-file", "title": "Excel VBA copy multiple worksheets from a Source File to Production file", "body": "<p>I am trying to automate a daily process with Excel VBA to copy 6 worksheets  from the Source File And create the copy in the Prod File and replace the old same name worksheets with the same name.This will become a \u201cdaily repetitive process\u201d where I need to copy the 6 worksheets from the Source File to the Prod File. The worksheets are name the same in both files and want to keep the same worksheet names because I have formulas feeding the Prod File - Main Report.</p>\n\n<p>I am not sure what would be the most Efficient and Effective method to either first Delete the prior worksheets from the Prod File and then copy the current worksheet to the Prod File.</p>\n\n<p>Or</p>\n\n<p>Copy the Source File worksheets to the Prod File, which will create a copy with the number 2, delete the prior worksheet and remove the 2 from the current worksheet name.</p>\n\n<p>Like always I am grateful for this site where solutions are always found.</p>\n\n<p>Here is the Process:</p>\n\n<p>From Source File - I want to Copy the following Worksheets:</p>\n\n<p><em>File Name, Sheet Name and Date convention</em>:</p>\n\n<p>Source FileName: CM Prism MTD ROR MMDDYYYY.xlsx</p>\n\n<p>Worksheets:</p>\n\n<ul>\n<li>Active Globally    </li>\n<li>Active USRR</li>\n<li>Active Indices</li>\n<li>MACO</li>\n<li>Quantile</li>\n<li>HY         </li>\n</ul>\n\n<p>To Prod File \u2013 Worksheets name will stay the same and Replace the prior worksheet.</p>\n\n<p><em>File Name, Sheet Name and Date convention</em></p>\n\n<p>Prod FileName: CM Composite MTD as of MM.DD.xlsm</p>\n\n<p>Worksheets:</p>\n\n<ul>\n<li>Active Globally</li>\n<li>Active USRR</li>\n<li>Active Indices</li>\n<li>MACO</li>\n<li>Quantile</li>\n<li>HY</li>\n</ul>\n\n<p>Also the Source File worksheets has the Valuation Date on Cell \u201cD4\u201d as \u201c09-Oct\u20142015\u201d, where I would like to add a \u201cvaluation date check\u201d to make sure that the worksheets  being copy from the Source file to the Prod file has the same Valuation Date as the Prod File on Cell \u201cD6\u201d as \u201c10/09/2015\u201d.\nSo if the valuation dates are the same copy to Prod file if not don\u2019t copy it.\nThe goal is to add any ALERTS or Triggers that is not for Valuation Date.</p>\n\n<p>This is what I have:</p>\n\n<pre><code>Sub copyNreplaceWorksheets()\n\nApplication.EnableEvents = False\n\nDim DpathSource As String\nDim DpathProd As String\nDim FolderName As String\nDim FileNameSource As String\nDim FileNameProd As String\nDim HolidayList\nDim RptDateSource As Date\nDim RptDateProd As Date\n\nDim wkbSource As Workbook\nDim wkbProd As Workbook\nDim shtToCopy As Worksheet\n\n\nSet HolidayList = Range(\"I77:I86\")\n\n''****Set the Report File Date*****\n'''Source File: CM Prism MTD ROR MMDDYYYY.xlsx\nRptDateSource = Format(WorksheetFunction.WorkDay(Now(), -1, HolidayList), \"mmddyyyy\")\n\n'''Prod File: CM Composite MTD as of MMDD.xlsm\nRptDateProd = Format(WorksheetFunction.WorkDay(Now(), -1, HolidayList), \"mm.dd\")\n\n'''****Set the File Name*****\n'''Source File: CM Prism MTD ROR MMDDYYYY.xlsx\nFileNameSource = \"CM Prism MTD ROR\" &amp; RptDateSource &amp; \".xlsx\"\n\n'''Prod File: Aladdin Composite MTD as of MMDD.xlsm\nFileNameProd = \"CM Composite MTD as of\" &amp; RptDateProd &amp; \".xlsm\"\n\n'''****Set the Directory Path****\nDpathSource = \"U:\\Performance\\CM Performance\\\" &amp; FileNameSource &amp; \"\"\nDpathProd = \"U:\\Performance\\ROR calculations\\2015\\Daily Returns\\\" &amp; FileNameProd &amp; \"\"\n\n\nSet wkbSource = Workbooks.Open(\"DpathSource\")\nSet wkbProd = Workbooks.Open(\"DpathProd\")\nSet shtToCopy = wkbSource.Sheets(\"Active US\")\nshtToCopy.copy wkbProd.Sheets(\"Active US\")\n\nApplication.EnableEvents = True\n</code></pre>\n\n<p>End Sub</p>\n"}, {"tags": ["vba", "excel", "date", "datetime"], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 1, "last_activity_date": 1444768941, "creation_date": 1444768941, "answer_id": 33112237, "question_id": 33112124, "link": "https://stackoverflow.com/questions/33112124/excel-vba-script-format-date-mm-dd-yyyy/33112237#33112237", "title": "Excel VBA Script Format Date MM-DD-YYYY", "body": "<p>You don't need to <code>Set</code> a date. Value assignment with an <code>=</code> is sufficient. Ampersands (e.g. <code>&amp;</code>), not plus signs (e.g. <code>+</code>) are used for string concatenation.</p>\n\n<p>The VBA <code>Format</code> function should be good at returning the correct string.</p>\n\n<pre><code>Dim dtInicio As String, dtFim As String\nstDate = Format(MWS.Cells(1, \"E\").Value, \"mm-dd-yyyy\")\nenDate = Format(MWS.Cells(2, \"E\").Value, \"mm-dd-yyyy\")\n\nwstring = \"exec sp_accessFile '\" &amp; stDate &amp; \"', '\" &amp; enDate &amp; \"'\"\n</code></pre>\n\n<p>The <code>wstring</code> should look like,</p>\n\n<blockquote>\n  <p>exec sp_accessFile '07-19-2015', '08-25-2015'</p>\n</blockquote>\n\n<p>The above assumes that E1:E2 are actual dates.</p>\n"}], "owner": {"reputation": 61, "user_id": 349692, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/29f3823496b8a27ef33d90a01793b3d5?s=128&d=identicon&r=PG", "display_name": "Metal Sonic", "link": "https://stackoverflow.com/users/349692/metal-sonic"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2781, "favorite_count": 0, "accepted_answer_id": 33112237, "answer_count": 1, "score": 0, "last_activity_date": 1444768941, "creation_date": 1444768460, "question_id": 33112124, "link": "https://stackoverflow.com/questions/33112124/excel-vba-script-format-date-mm-dd-yyyy", "title": "Excel VBA Script Format Date MM-DD-YYYY", "body": "<p>I'm need to convert the value of two cells from dd/mm/yyyy to mm-dd-yyyy and append the values to a stored procedure call. My code:</p>\n\n<pre><code>Dim dtInicio As String\nDim dtFim As String\nSet stDate = CStr(MWS.Cells(1, \"E\").Value)\nSet enDate = CStr(MWS.Cells(2, \"E\").Value)\n</code></pre>\n\n<p>I need something like this after the above code:</p>\n\n<pre><code>wstring = \"exec sp_accessFile '\"+stDate+\"', '\"+enDate +\"'\n</code></pre>\n"}, {"tags": ["ms-access", "vba", "directory", "mkdir"], "answers": [{"tags": [], "owner": {"reputation": 6762, "user_id": 845655, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/ySyzL.jpg?s=128&g=1", "display_name": "DeanOC", "link": "https://stackoverflow.com/users/845655/deanoc"}, "is_accepted": true, "score": 1, "last_activity_date": 1444767904, "creation_date": 1444767904, "answer_id": 33111971, "question_id": 33111924, "link": "https://stackoverflow.com/questions/33111924/displaying-folder-name-in-a-specific-format-using-access/33111971#33111971", "title": "Displaying folder name in a specific format using Access", "body": "<pre><code>MkDir (\"C:\\Users\\Desktop\\\" &amp; txtCustomerID.Value &amp; \" - \" &amp; txtFirstName.Value &amp; \" \" &amp;  txtLastName.Value)\n</code></pre>\n\n<p>will add the dash and spaces that you want.</p>\n"}, {"tags": [], "owner": {"reputation": 7422, "user_id": 1586390, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f07270207034d2bcbe347b028edc8f02?s=128&d=identicon&r=PG", "display_name": "Sorceri", "link": "https://stackoverflow.com/users/1586390/sorceri"}, "is_accepted": false, "score": 1, "last_activity_date": 1444767906, "creation_date": 1444767906, "answer_id": 33111972, "question_id": 33111924, "link": "https://stackoverflow.com/questions/33111924/displaying-folder-name-in-a-specific-format-using-access/33111972#33111972", "title": "Displaying folder name in a specific format using Access", "body": "<p>Should be as simple as putting in spaces.....</p>\n\n<pre><code>Private Sub btnCreate_Click()\nDoCmd.RunSQL \"INSERT INTO [Customer] (CustomerID, FirstName, LastName, Phone, Email) VALUES ('\" &amp; Me.txtCustomerID &amp; \"', '\" &amp; Me.txtFirstName &amp; \"', '\" &amp; Me.txtLastName &amp; \"', '\" &amp; Me.txtPhone &amp; \"', '\" &amp; Me.txtEmail &amp; \"')\"\n\nMkDir (\"C:\\Users\\Desktop\\\" &amp; txtCustomerID.Value &amp; \" - \" &amp; txtFirstName.Value &amp; \" \" &amp; txtLastName.Value)\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 387, "user_id": 4971376, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/480da9c324ce828f711b23012b78f0e7?s=128&d=identicon&r=PG&f=1", "display_name": "Ron T", "link": "https://stackoverflow.com/users/4971376/ron-t"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 33, "favorite_count": 0, "accepted_answer_id": 33111971, "answer_count": 2, "score": 1, "last_activity_date": 1444767906, "creation_date": 1444767753, "question_id": 33111924, "link": "https://stackoverflow.com/questions/33111924/displaying-folder-name-in-a-specific-format-using-access", "title": "Displaying folder name in a specific format using Access", "body": "<p>I am a Create Customer form with a button and the following textboxes: txtCustomerID, txtFirstName, txtLastName, txtPhone, txtEmail. When I click the button, the information typed in the textboxes are inserted into [Customer] table and creates a folder based on the value of txtCustomerID, txtFirstName, and txtLastName. For example, if..</p>\n\n<p>txtCustomerID: <em>100</em></p>\n\n<p>txtFirstName: <em>Ron</em></p>\n\n<p>txtLastName: <em>Smith</em></p>\n\n<p>I want the folder name to display \"<strong>100 - Ron Smith</strong>\", but I can't find a solution to do that. </p>\n\n<p>Below is the code that I used and it works perfectly, I just can't get it to the way I want to display the folder name.</p>\n\n\n\n<pre class=\"lang-html prettyprint-override\"><code>Private Sub btnCreate_Click()\n    DoCmd.RunSQL \"INSERT INTO [Customer] (CustomerID, FirstName, LastName, Phone, Email) VALUES ('\" &amp; Me.txtCustomerID &amp; \"', '\" &amp; Me.txtFirstName &amp; \"', '\" &amp; Me.txtLastName &amp; \"', '\" &amp; Me.txtPhone &amp; \"', '\" &amp; Me.txtEmail &amp; \"')\"\n\n    MkDir (\"C:\\Users\\Desktop\\\" &amp; txtCustomerID.Value &amp; txtFirstName.Value &amp; txtLastName.Value)\nEnd Sub\n</code></pre>\n\n\n\n<p>Any help or suggestion would be great. Thank you</p>\n"}, {"tags": ["vba", "ms-access"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 3, "creation_date": 1444765648, "post_id": 33111285, "comment_id": 54036833, "body": "Look <a href=\"https://msdn.microsoft.com/en-us/library/aa227522(v=vs.60).aspx\" rel=\"nofollow noreferrer\">here</a>.  It gives functions to do what you want."}, {"owner": {"reputation": 71, "user_id": 4964096, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/7d1354a992547380365aeb28d945f291?s=128&d=identicon&r=PG&f=1", "display_name": "linuxman", "link": "https://stackoverflow.com/users/4964096/linuxman"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1444766297, "post_id": 33111285, "comment_id": 54037212, "body": "i got the syntax but in the second line it says my argument is not optional"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1444766367, "post_id": 33111285, "comment_id": 54037264, "body": "basically for what you want you only need one line in your function: <code>GetNowLast = Format(DateSerial(Year(Date), Month(Date) + 1, 0), &quot;d&quot;)</code>  This will give you an answer of 31 for this month then when we enter November it will give 30 and so forth."}, {"owner": {"reputation": 71, "user_id": 4964096, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/7d1354a992547380365aeb28d945f291?s=128&d=identicon&r=PG&f=1", "display_name": "linuxman", "link": "https://stackoverflow.com/users/4964096/linuxman"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1444766476, "post_id": 33111285, "comment_id": 54037328, "body": "yeah but year 1900 :D"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1444766538, "post_id": 33111285, "comment_id": 54037377, "body": "If you want the full date then remove the formating <code>GetNowLast = DateSerial(Year(Date), Month(Date) + 1, 0)</code>.  I thought you wanted the last day only.  Sorry."}], "answers": [{"comments": [{"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1556058968, "post_id": 33116871, "comment_id": 98306910, "body": "Please declare your variables... using <code>Option Explicit</code> at the top of every module will help you remember to do so!  (But it&#39;s interesting that <code>dMonth + 1</code> works even if <code>dMonth+1=13</code>.)"}, {"owner": {"reputation": 859, "user_id": 2666502, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/zGVE6.gif?s=128&g=1", "display_name": "mtholen", "link": "https://stackoverflow.com/users/2666502/mtholen"}, "reply_to_user": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1557567716, "post_id": 33116871, "comment_id": 98815021, "body": "@ashleedawg Downvoting for something that is arbitrary seems to be rather pedantic don&#39;t you think? Despite the fact that you -personally- may think it is the best method or even that it might best practice, it is and remains arbitrary and up to the developer to choose whether or not to use the &#39;Option Explicit&#39; declaration. The question was to provide a solution, not to describe the entire environment in which the solution should be deployed."}, {"owner": {"reputation": 273, "user_id": 4140890, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Rf3P8.png?s=128&g=1", "display_name": "tm-", "link": "https://stackoverflow.com/users/4140890/tm"}, "edited": false, "score": 0, "creation_date": 1565685285, "post_id": 33116871, "comment_id": 101420069, "body": "Special thanks for zero as day argument for DateSerial, resulting into last day of previous month. Didn&#39;t know this feature."}, {"owner": {"reputation": 153, "user_id": 7753279, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a80a3c3ee5d2ef3188d576f743b06fc?s=128&d=identicon&r=PG&f=1", "display_name": "Jared", "link": "https://stackoverflow.com/users/7753279/jared"}, "edited": false, "score": 0, "creation_date": 1574107721, "post_id": 33116871, "comment_id": 104105606, "body": "I&#39;m surprised it takes 12, and thus 13, as a proper month."}], "tags": [], "owner": {"reputation": 859, "user_id": 2666502, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/zGVE6.gif?s=128&g=1", "display_name": "mtholen", "link": "https://stackoverflow.com/users/2666502/mtholen"}, "is_accepted": false, "score": 18, "last_activity_date": 1444800043, "last_edit_date": 1495540702, "creation_date": 1444798443, "answer_id": 33116871, "question_id": 33111285, "link": "https://stackoverflow.com/questions/33111285/get-the-last-day-of-month/33116871#33116871", "title": "Get the last day of month", "body": "<p>GD Linuxman,</p>\n\n<p>Let's focus on obtaining the result...:-)</p>\n\n<p>See also: <a href=\"https://msdn.microsoft.com/en-us/library/aa227522%28v=vs.60%29.aspx\" rel=\"noreferrer\">here</a></p>\n\n<p>The comment by @Scott Craner is spot on ! Though strictly speaking there is no need to use the formatting. (Assuming you want to work with the 'Date' object)</p>\n\n<p>To achieve what you want, setup the function as per below:</p>\n\n<pre><code>Function GetNowLast() as Date\n\n    dYear = Year(Now)\n    dMonth = Month(Now)\n\n    getDate = DateSerial(dYear, dMonth + 1, 0)\n\n    GetNowLast = getDate\n\nEnd Function\n</code></pre>\n\n<p>You can call the function in your code as:</p>\n\n<pre><code>Sub findLastDayOfMonth()\n\n    lastDay = GetNowLast()\n\nEnd Sub\n</code></pre>\n\n<p>Alternatively, and neater is likely:</p>\n\n<pre><code>Function GetNowLast(inputDate as Date) as Date\n\n    dYear = Year(inputDate)\n    dMonth = Month(inputDate)\n\n    getDate = DateSerial(dYear, dMonth + 1, 0)\n\n    GetNowLast = getDate\n\nEnd Function\n</code></pre>\n\n<p>You can call that function and pass it an input parameter.</p>\n\n<pre><code>Sub findLastDayOfMonth()\n\nlastDay = GetNowLast(Now()) 'Or any other date you would like to know the last day of the month of.\n\nEnd Sub\n</code></pre>\n\n<p>See also <a href=\"https://stackoverflow.com/questions/17324722/getting-the-first-and-last-dates-in-a-month?rq=1\">this</a> neat solution by @KekuSemau</p>\n"}, {"comments": [{"owner": {"reputation": 1238, "user_id": 553596, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f75aa7b74c7fea29f67d27bca6716453?s=128&d=identicon&r=PG", "display_name": "moggi", "link": "https://stackoverflow.com/users/553596/moggi"}, "edited": false, "score": 0, "creation_date": 1505759420, "post_id": 46285653, "comment_id": 79534992, "body": "You should add some explanation how your code solves the problem mentioned in the question."}], "tags": [], "owner": {"reputation": 41, "user_id": 6084347, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/48b1c0ba91daf6c28cd9c932e8983186?s=128&d=identicon&r=PG&f=1", "display_name": "Bill", "link": "https://stackoverflow.com/users/6084347/bill"}, "is_accepted": false, "score": 4, "last_activity_date": 1505767160, "last_edit_date": 1505767160, "creation_date": 1505758123, "answer_id": 46285653, "question_id": 33111285, "link": "https://stackoverflow.com/questions/33111285/get-the-last-day-of-month/46285653#46285653", "title": "Get the last day of month", "body": "<pre><code>Sub Worksheet_SelectionChange(ByVal Target As Range)\n\n   Dim d1 As String\n\n   Set Rng = Range(\"A2\")\n   d1 = Range(\"a2\").Value2 'put a date in A2 Formatted as date(cell format)\n\n   Dim years\n   Dim months\n   Dim end_month\n   years = year(d1)\n   months = month(d1)\n\n   end_month = Day(DateSerial(years, months + 1, 1 - 1)) 'add one month and subtract one day from the first day of that month\n\n   MsgBox CStr(end_month), vbOKOnly, \"Last day of the month\"\n\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 1, "creation_date": 1556054588, "post_id": 47146716, "comment_id": 98305633, "body": "the title of the question says it&#39;s for MS-Access VBA, not Excel."}], "tags": [], "owner": {"reputation": 29, "user_id": 8635881, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8Q09w.jpg?s=128&g=1", "display_name": "OTA-SAN", "link": "https://stackoverflow.com/users/8635881/ota-san"}, "is_accepted": false, "score": 2, "last_activity_date": 1510011025, "last_edit_date": 1510011025, "creation_date": 1510006384, "answer_id": 47146716, "question_id": 33111285, "link": "https://stackoverflow.com/questions/33111285/get-the-last-day-of-month/47146716#47146716", "title": "Get the last day of month", "body": "<p>I realize this is a bit late into the conversation, but there is an already available worksheet function that gives the end of month date, EoMonth().</p>\n\n<p>Pasting into the Immediate Window:</p>\n\n<pre><code>    ?Format(CDate(WorksheetFunction.EoMonth(Date, 0)), \"dd\")\n</code></pre>\n\n<p>Will return the last day of the month based on current date.<br/><br/></p>\n\n<p>As a UDF, it makes sense to give it a default Argument:</p>\n\n<pre><code>    Function LastDay(Optional DateUsed As Date) As String\n        If DateUsed = Null Then DateUsed = Date\n        LastDay = Format(CDate(WorksheetFunction.EoMonth(DateUsed, 0)), \"dd\")\n        Debug.Print LastDay\n    End Function\n</code></pre>\n\n<p>If you feed it Arguments, be sure that they are <strong>Date Literals</strong> (i.e. Enclosed with <strong>#s</strong>)</p>\n\n<pre><code>LastDay(#3/10#)\nResult: 31\n\nLastDay #2/11/2012#\nResult: 29 '(A leap Year)\n</code></pre>\n\n<p>Note the output Data Type is <em>String</em> (not <em>Date</em>) and that the format of the date can be adjusted as needed (Ex: \"mm/dd/yyyy\" instead of \"dd\").</p>\n\n<p>If the <em>Date</em> Data Type is needed, use:</p>\n\n<pre><code>Function LastDay(Optional DateUsed As Date) As Date\n    If DateUsed = 0 Then DateUsed = Date\n    LastDay = WorksheetFunction.EoMonth(DateUsed, 0)\n    Debug.Print CDate(LastDay)\nEnd Function\n</code></pre>\n\n<p>I hope that helps someone.</p>\n"}, {"comments": [{"owner": {"reputation": 22957, "user_id": 78522, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3facb4a672d9fbeb9f2ed6b5acc65633?s=128&d=identicon&r=PG", "display_name": "Patrick Honorez", "link": "https://stackoverflow.com/users/78522/patrick-honorez"}, "edited": false, "score": 2, "creation_date": 1567500254, "post_id": 55820282, "comment_id": 101971302, "body": "Using a ref to Excel is super slow, so I would either avoid that, or make sure <code>xl</code> is static."}], "tags": [], "owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "is_accepted": false, "score": 0, "last_activity_date": 1556058863, "creation_date": 1556058863, "answer_id": 55820282, "question_id": 33111285, "link": "https://stackoverflow.com/questions/33111285/get-the-last-day-of-month/55820282#55820282", "title": "Get the last day of month", "body": "<p>In Access VBA, you can call Excel's <a href=\"https://support.office.com/article/eomonth-function-7314ffa1-2bc9-4005-9d66-f49db127d628\" rel=\"nofollow noreferrer\"><code>EOMonth</code></a> worksheet function (or almost any of <a href=\"https://docs.microsoft.com/office/vba/api/excel.worksheetfunction#methods\" rel=\"nofollow noreferrer\">Excel's worksheet methods</a>) is by <a href=\"https://support.microsoft.com/help/245115/using-early-binding-and-late-binding-in-automation\" rel=\"nofollow noreferrer\">binding</a> to an Excel application object and a <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.worksheetfunction#example\" rel=\"nofollow noreferrer\"><code>WorksheetFunction</code> object</a>, which can be accomplished in a few ways.</p>\n\n<h2>Calling Excel functions with an Late Bound object</h2>\n\n<p>The shortest method from Access VBA is with a single line of code using a late-bound object. This example returns the date of the last day of the current month:</p>\n\n<pre><code>MsgBox CreateObject(\"Excel.Application\").WorksheetFunction.EOMonth(Now(), 0)\n</code></pre>\n\n<hr>\n\n<p>A more verbose method, as a function:</p>\n\n<pre><code>Function eoMonth_LateBound(dt As Date) As Date\n  Dim xl As Object\n  Set xl = CreateObject(\"Excel.Application\")\n  eoMonth_LateBound = xl.WorksheetFunction.eomonth(dt, 0)\n  Set xl = Nothing\nEnd Function\n</code></pre>\n\n<p>An issue with late-bound references is that VBA takes a second to bind the object each time the function is called.  This can be avoided by using early binding.</p>\n\n<hr>\n\n<h2>Calling Excel functions with an Early Bound object</h2>\n\n<p>If the function is to be used repeatedly, it's more efficient to go with Early Binding and retain the object between calls, for example:</p>\n\n<ul>\n<li><p>Go <strong>Tools</strong> > <strong>References</strong> and <a href=\"https://docs.microsoft.com/office/vba/language/how-to/check-or-add-an-object-library-reference\" rel=\"nofollow noreferrer\">add a reference</a> to \"<code>Microsoft Excel x.xx Object Library</code>\" (use whatever the newest version number is that you have installed).</p></li>\n<li><p>Add this code in a new module:</p>\n\n<pre><code>Option Compare Database\nOption Explicit\n\nDim xl As Excel.Application\n\nFunction eoMonth_EarlyBound(dt As Date) As Date\n  If xl Is Nothing Then Set xl = New Excel.Application\n  eoMonth_EarlyBound = xl.WorksheetFunction.eomonth(dt, 0)\nEnd Function\n\nSub demo()\n  MsgBox eoMonth_EarlyBound(Now())\n  MsgBox eoMonth_EarlyBound(\"4/20/2001\")\nEnd Sub\n</code></pre></li>\n</ul>\n\n<hr>\n\n<h2>Creating a <code>WorksheetFunction</code> object</h2>\n\n<p>If Excel's worksheet functions are to be used lots throughout your code, you could even create a <a href=\"https://support.microsoft.com/help/291309/using-a-worksheet-function-in-a-visual-basic-macro-in-excel\" rel=\"nofollow noreferrer\"><code>WorksheetFunction</code></a> object to simplify the calls.  For example, this could be a simple way to join multiple strings with <a href=\"https://support.office.com/article/textjoin-function-357b449a-ec91-49d0-80c3-0e8fc845691c\" rel=\"nofollow noreferrer\"><code>TEXTJOIN</code></a>, or get a response from an API with <a href=\"https://support.office.com/article/webservice-function-0546a35a-ecc6-4739-aed7-c0b7ce1562c4\" rel=\"nofollow noreferrer\"><code>WEBSERVICE</code></a>:</p>\n\n<pre><code>Sub Examples()\n'requires reference: \"Microsoft Excel x.xx Object Library\"\n  Dim xl As Excel.Application, wsf As Excel.WorksheetFunction\n  Set xl = New Excel.Application\n  Set wsf = xl.WorksheetFunction\n\n  'use EOMONTH to return last date of current month\n  Debug.Print CDate(wsf.eomonth(Now(), 0))\n\n  'use WEBSERVICE return your current IP address from a free JSON API\n  Debug.Print wsf.WebService(\"https://api.ipify.org\")\n\n  'use TEXTJOIN to implode a bunch of values\n  Debug.Print wsf.TextJoin(\" &amp; \", True, \"join\", \"this\", , \"and\", , \"that\", \"too\")\n\n  'always tidy up your mess when finished playing with objects!\n  Set wsf = Nothing\n  Set xl = Nothing\nEnd Sub\n</code></pre>\n\n<p><sub>Note that these functions may require <strong>Excel 2016</strong>+ or Excel 365 (aka: Object Library 16.0+.)</sub></p>\n"}, {"tags": [], "owner": {"reputation": 61, "user_id": 11311561, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ebDz7.jpg?s=128&g=1", "display_name": "CraigD", "link": "https://stackoverflow.com/users/11311561/craigd"}, "is_accepted": false, "score": 1, "last_activity_date": 1605800781, "last_edit_date": 1605800781, "creation_date": 1580241460, "answer_id": 59956115, "question_id": 33111285, "link": "https://stackoverflow.com/questions/33111285/get-the-last-day-of-month/59956115#59956115", "title": "Get the last day of month", "body": "<p>In short, a great and straightforward approach is to find the first day of the following month and then move backward one day.</p>\n<p>Make yourself a little function that does something like this:</p>\n<ol>\n<li>Obtain the month and year in question (the one where you want the last day)</li>\n<li>Use DateSerial to combine the month and the year, along with the day &quot;1&quot; to get the <em>first</em> day of the month in question.</li>\n<li>Use DateAdd to add one month.  This will get you the first day of the <em>next</em> month (which is one day <em>after</em> the date you <em>really</em> want).</li>\n<li>Use DateAdd again to subtract (move back) one day.  This will give you the last day of the month where you started.</li>\n</ol>\n<pre><code>    Function eom(ByVal input_date As Date) As Date\n    \n      ' take the first day of the month from the input date, add one month, \n      ' then back up one day\n      eom = DateAdd(&quot;d&quot;, -1, DateAdd(&quot;m&quot;, 1, DateSerial(Year(input_date), Month(input_date), 1)))\n    \n    End Function\n</code></pre>\n"}], "owner": {"reputation": 71, "user_id": 4964096, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/7d1354a992547380365aeb28d945f291?s=128&d=identicon&r=PG&f=1", "display_name": "linuxman", "link": "https://stackoverflow.com/users/4964096/linuxman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 63903, "favorite_count": 0, "answer_count": 5, "score": 6, "last_activity_date": 1609030439, "creation_date": 1444765412, "last_edit_date": 1609030439, "question_id": 33111285, "link": "https://stackoverflow.com/questions/33111285/get-the-last-day-of-month", "title": "Get the last day of month", "body": "<p>I want to get the last day of the month.</p>\n<p>This is my code. If I want to debug it and compile it to the database it says it has an error in the syntax.</p>\n<pre class=\"lang-vb prettyprint-override\"><code>Public Function GetNowLast() As Date\n    Dim asdfh As Date\n    asdfh = DateValue(&quot;1.&quot; _\n      &amp; IIf(Month(Date) + 1) &gt; 12, Month(Date) + 1 - 12, Month(Date) + 1) _\n      &amp;&quot;.&quot;&amp;IIf(Month(Date)+1)&gt;12 , Year(Date)+1,Year(Date))\n    asdf = DateAdd(&quot;d&quot;, -1, asdf)\n    GetNowLast = asdf\nEnd Function\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 1, "creation_date": 1444761994, "post_id": 33110307, "comment_id": 54034915, "body": "Given that a named range is specific to a sheet and range, yes."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 2, "creation_date": 1444762327, "post_id": 33110307, "comment_id": 54035091, "body": "A named range can be specific to the page, which means only formulas on that page will be able to call it, or workbook specific mean it can be called from anywhere in the workbook.  To see which  go to formulas====&gt;Name Manager and look at the properties of the named range."}, {"owner": {"reputation": 4067, "user_id": 2970789, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dd4ed57e10989bdb3f3ac58326b7354?s=128&d=identicon&r=PG&f=1", "display_name": "Ambie", "link": "https://stackoverflow.com/users/2970789/ambie"}, "edited": false, "score": 0, "creation_date": 1444762972, "post_id": 33110307, "comment_id": 54035441, "body": "Most likely yes. You could check the names&#39; scopes and change to workbook or just get the string addresses of those two ranges and put those addresses in your <code>Range</code> definitions."}, {"owner": {"reputation": 199, "user_id": 2852582, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NBZqc.jpg?s=128&g=1", "display_name": "Bigtree", "link": "https://stackoverflow.com/users/2852582/bigtree"}, "edited": false, "score": 0, "creation_date": 1444762973, "post_id": 33110307, "comment_id": 54035442, "body": "You should be able to avoid these kind of conflicts by specifying the workbook and worksheets in all references. &#39;Thisworkbook.sheets(2).range(&quot;LTSDI&quot;)&#39;"}, {"owner": {"reputation": 6237, "user_id": 4892468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b9tfr.png?s=128&g=1", "display_name": "EEM", "link": "https://stackoverflow.com/users/4892468/eem"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1444790988, "post_id": 33110307, "comment_id": 54045635, "body": "@ScottCraner <code>Defined Names</code> can be used in formulas anywhere in a workbook regardless of their scope, only condition is to include the entire path of the <code>Defined Name</code> in the formula, so let\u2019s say we have a <code>Defined Name</code> called <code>Test1</code> in worksheet <code>Sht 1</code> of workbook <code>Book10</code> the syntax to use that <code>Defined Name</code> in a formula in another workbook is: <code>&#39;[WorkbookName]WorksheetName&#39;!DefinedName</code> i.e. <code>&#39;[Book10]Sht 1&#39;!Test1</code>"}], "answers": [{"tags": [], "owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "is_accepted": false, "score": 5, "last_activity_date": 1444766647, "creation_date": 1444766647, "answer_id": 33111625, "question_id": 33110307, "link": "https://stackoverflow.com/questions/33110307/vba-different-worksheets-same-named-cell-ranges/33111625#33111625", "title": "VBA: Different worksheets, same named cell ranges?", "body": "<p>To be more clear than what the comments above suggest, named ranges work in the following ways.</p>\n\n<p>Named ranges can have 2 scopes: </p>\n\n<ul>\n<li><strong>Workbook Level</strong> </li>\n<li><strong>Sheet Level</strong></li>\n</ul>\n\n<p>Excel allows identical named ranges within the same workbook for <strong>as long as it has a different scope</strong>. In other words, Excel does not allow identical range names at the Workbook Level or Sheet Name. </p>\n\n<p>As an illustration, the following is okay:</p>\n\n<ul>\n<li><strong>myRange</strong> = Sheet1!$A$1 Scope: Workbook</li>\n<li><strong>myRange</strong> = Sheet2!$A$1 Scope: Sheet2</li>\n</ul>\n\n<p>But the following is not:</p>\n\n<ul>\n<li><strong>myRange</strong> = Sheet1!$A$1 Scope: Workbook</li>\n<li><strong>myRange</strong> = Sheet2!$A$1 Scope: Workbook</li>\n</ul>\n\n<p>All that said, the way to refer to named ranges follows:</p>\n\n<p><strong>Workbook Scope Level</strong></p>\n\n<blockquote>\n  <p>From any cell on any sheet: <code>=MyRange</code></p>\n</blockquote>\n\n<p><strong>Worksheet Scope Level</strong></p>\n\n<blockquote>\n  <p>From any cell within the worksheet, and as long as there are no other\n  identical named ranges scoped at the workbook level: <code>=MyRange</code></p>\n  \n  <p>From any cell within any worksheet, or if there is an identical named\n  range scoped at the workbook level: <code>='Sheet1!myRange'</code></p>\n</blockquote>\n\n<p>Lastly, if you do have two identical range names, one scoped at the workbook level and one at the sheet level, if you do not qualify the sheet, the workbook scoped range will be used as default.</p>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 2, "last_activity_date": 1444767859, "creation_date": 1444767859, "answer_id": 33111956, "question_id": 33110307, "link": "https://stackoverflow.com/questions/33110307/vba-different-worksheets-same-named-cell-ranges/33111956#33111956", "title": "VBA: Different worksheets, same named cell ranges?", "body": "<p>Your code is throwing the,</p>\n\n<blockquote>\n  <p>Run-time error '1004':<br/>\n  \u00a0\u00a0\u00a0AutoFill method of Range class failed</p>\n</blockquote>\n\n<p>This is due to the lack of a defined parent worksheet in the latter half of each command.</p>\n\n<pre><code>With Worksheets(2)\n    .Range(\"LTSDI\").AutoFill Destination:=.Range(\"LTSDI:LTEDI\"), Type:=xlFillDefault\nEnd With\n\nWith Worksheets(3)\n    .Range(\"LTSDI\").AutoFill Destination:=.Range(\"LTSDI:LTEDI\"), Type:=xlFillDefault\nEnd With\n</code></pre>\n\n<p>The above defines the parent worksheet with a <a href=\"https://msdn.microsoft.com/en-us/library/wc500chb.aspx\" rel=\"nofollow\">With ... End With statement</a>. Each <a href=\"https://msdn.microsoft.com/en-us/library/office/ff838238.aspx\" rel=\"nofollow\">Range object</a> is prefixed with a period (aka <em>full stop</em> or <code>.</code>) which explicitly references the parent worksheet noted by the With ... End With.</p>\n\n<p>If you opted for the simpler <a href=\"https://msdn.microsoft.com/en-us/library/office/ff838404.aspx\" rel=\"nofollow\">Range.FillDown method</a> you could avoid the With ... End With as the range only has to be referred to once.</p>\n\n<pre><code>Worksheets(2).Range(\"LTSDI:LTEDI\").FillDown\nWorksheets(3).Range(\"LTSDI:LTEDI\").FillDown\n</code></pre>\n\n<p>Finally, the following illustrates what is necessary for your code to work if you choose to repair the original instead of one of the above.</p>\n\n<pre><code>Worksheets(2).Range(\"LTSDI\").AutoFill Destination:=Worksheets(2).Range(\"LTSDI:LTEDI\"), Type:=xlFillDefault\nWorksheets(3).Range(\"LTSDI\").AutoFill Destination:=Worksheets(3).Range(\"LTSDI:LTEDI\"), Type:=xlFillDefault\n</code></pre>\n"}], "owner": {"reputation": 95, "user_id": 5344302, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/af508996124898d0a86e19c443e0f726?s=128&d=identicon&r=PG&f=1", "display_name": "redcase", "link": "https://stackoverflow.com/users/5344302/redcase"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1990, "favorite_count": 0, "answer_count": 2, "score": 4, "last_activity_date": 1444767859, "creation_date": 1444761889, "question_id": 33110307, "link": "https://stackoverflow.com/questions/33110307/vba-different-worksheets-same-named-cell-ranges", "title": "VBA: Different worksheets, same named cell ranges?", "body": "<p>I am using code that returns \"range of object_global failed\" with the second part of the below code (Worksheet 3 code) highlighted. </p>\n\n<p>Would using the same named ranges, but on different worksheets, as I have done below be causing this?</p>\n\n<pre><code>Worksheets(2).Range(\"LTSDI\").AutoFill Destination:=Range(\"LTSDI:LTEDI\"), Type:=xlFillDefault\n\nWorksheets(3).Range(\"LTSDI\").AutoFill Destination:=Range(\"LTSDI:LTEDI\"), Type:=xlFillDefault\n</code></pre>\n\n<p>Thanks for any feedback!</p>\n"}, {"tags": ["sql", "ms-access", "vba", "sql-update"], "comments": [{"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 1, "creation_date": 1444759642, "post_id": 33109507, "comment_id": 54033663, "body": "If the datatype of <code>InternalUse.InvoiceID</code> is numeric instead of text, eliminate the single quotes before and after <code>Me.txtInvoice</code>: <code>&quot; ... WHERE InvoiceID = &quot; &amp; Me.txtInvoice</code>"}, {"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1444759773, "post_id": 33109507, "comment_id": 54033741, "body": "If <code>SoldTax</code> is Yes/No field type, set the value to True instead of &#39;Yes&#39;: <code>SET SoldTax = True</code>"}, {"owner": {"reputation": 387, "user_id": 4971376, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/480da9c324ce828f711b23012b78f0e7?s=128&d=identicon&r=PG&f=1", "display_name": "Ron T", "link": "https://stackoverflow.com/users/4971376/ron-t"}, "reply_to_user": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1444759869, "post_id": 33109507, "comment_id": 54033791, "body": "Thank! @HansUp That solved the problem!"}], "answers": [{"tags": [], "owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "is_accepted": true, "score": 2, "last_activity_date": 1444759941, "creation_date": 1444759941, "answer_id": 33109724, "question_id": 33109507, "link": "https://stackoverflow.com/questions/33109507/updating-record-if-checkbox-is-checked/33109724#33109724", "title": "Updating record if checkbox is checked", "body": "<p>If the datatype of <code>InternalUse.InvoiceID</code> is numeric instead of text, eliminate the single quotes before and after <code>Me.txtInvoice</code>:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>\" ... WHERE InvoiceID = \" &amp; Me.txtInvoice\n</code></pre>\n"}], "owner": {"reputation": 387, "user_id": 4971376, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/480da9c324ce828f711b23012b78f0e7?s=128&d=identicon&r=PG&f=1", "display_name": "Ron T", "link": "https://stackoverflow.com/users/4971376/ron-t"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1405, "favorite_count": 0, "accepted_answer_id": 33109724, "answer_count": 1, "score": 2, "last_activity_date": 1444760041, "creation_date": 1444759228, "last_edit_date": 1444760041, "question_id": 33109507, "link": "https://stackoverflow.com/questions/33109507/updating-record-if-checkbox-is-checked", "title": "Updating record if checkbox is checked", "body": "<p>I am creating a simple POS system but I ran into an error. On the checkout form, it displays an Invoice Id, a subform of the items I have in my [Cart] table, checkout button, and 3 check boxes: Sold no tax, Sold tax, and Internal use. What I want is if you select cboxSoldNoTax and click checkout, all the items in [Cart] would update to 'Yes' under the field \"SoldNoTax.\" But the problem is when I click the checkout button , I would receive this error message:</p>\n\n<p><em>Run-time error '3464':</em></p>\n\n<p><em>Data type mismatch in criteria expression.</em></p>\n\n<p>Below is my vba code:</p>\n\n\n\n<pre><code>Private Sub btnCheckout_Click()\n    txtInvoice.Value = DMax(\"InvoiceID\", \"Invoice\")\n\n    If cboxSoldTax.Value = True Then\n        DoCmd.RunSQL \"UPDATE [Cart] SET SoldTax = 'Yes' WHERE InvoiceID = '\" &amp; Me.txtInvoice &amp; \"'\"\n    End If\n\n    If cboxInternal.Value = True Then\n        DoCmd.RunSQL \"UPDATE [Cart] SET InternalUse = 'Yes' WHERE InvoiceID = '\" &amp; Me.txtInvoice &amp; \"'\"\n    End If\n\n    If cboxSoldNoTax.Value = True Then\n        DoCmd.RunSQL \"UPDATE [Cart] SET SoldNoTax = 'Yes' WHERE InvoiceID = '\" &amp; Me.txtInvoice &amp; \"'\"\n    End If\n\nEnd Sub\n</code></pre>\n\n<p>I also provide a link to the access database. Here is the instructions to using the database: \"Start\" form -> Main Menu -> Flask -> Select quantity -> Add to Cart -> Checkout button -> Select either of the 3 checkbox -> Checkout button.</p>\n\n<p><a href=\"https://drive.google.com/file/d/0Bye-M8FI1tRUYm9QT3o5a0tyMkE/view?usp=sharing\" rel=\"nofollow\">https://drive.google.com/file/d/0Bye-M8FI1tRUYm9QT3o5a0tyMkE/view?usp=sharing</a></p>\n\n<p>Any help or suggestions would be great. Thanks in advance!</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 3650, "user_id": 5090027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/904db949ae64fe1a63ea8b4c677e6d57?s=128&d=identicon&r=PG&f=1", "display_name": "Grade &#39;Eh&#39; Bacon", "link": "https://stackoverflow.com/users/5090027/grade-eh-bacon"}, "edited": false, "score": 0, "creation_date": 1444757402, "post_id": 33108937, "comment_id": 54032394, "body": "That&#39;s a somewhat large ask - have you tried to solve this yourself? Also to clarify: are the years always at the end of the data in the raw format? Also - is this something where new parts would be added all the time, or does your current data set include pretty much everything with a few new ones each year?"}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 1, "creation_date": 1444757701, "post_id": 33108937, "comment_id": 54032543, "body": "Count the number of commas, insert that many rows, fill in inserted rows, use <code>split</code> to get year."}, {"owner": {"reputation": 3650, "user_id": 5090027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/904db949ae64fe1a63ea8b4c677e6d57?s=128&d=identicon&r=PG&f=1", "display_name": "Grade &#39;Eh&#39; Bacon", "link": "https://stackoverflow.com/users/5090027/grade-eh-bacon"}, "edited": false, "score": 0, "creation_date": 1444758454, "post_id": 33108937, "comment_id": 54032957, "body": "Alternately, without VBA, count commas, and have a new column count running total of all commas found in each successive row. Then put in an index which counts from 1-Total Commas on another tab; use INDEX/MATCH to pull in the data from each row on the first tab, and find the years by identifying which year is after that #&#39;s comma."}, {"owner": {"reputation": 21, "user_id": 5441893, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35b55c87408ecc91c35f7be6e84c974e?s=128&d=identicon&r=PG&f=1", "display_name": "Jnowell", "link": "https://stackoverflow.com/users/5441893/jnowell"}, "edited": false, "score": 0, "creation_date": 1444774295, "post_id": 33108937, "comment_id": 54041319, "body": "Yes, I have tried to figure this out. I am not the best on VBA. Thanks for your input."}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 5441893, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35b55c87408ecc91c35f7be6e84c974e?s=128&d=identicon&r=PG&f=1", "display_name": "Jnowell", "link": "https://stackoverflow.com/users/5441893/jnowell"}, "edited": false, "score": 0, "creation_date": 1444774397, "post_id": 33110053, "comment_id": 54041350, "body": "This work somewhat but I have many more fields that need to copy over. I am going to play with the formula and see if I can work it out. I really, really appreciate your help on this. thanks so much. It gives me a starting place."}, {"owner": {"reputation": 142, "user_id": 4971631, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Yv7lbt8gO-0/AAAAAAAAAAI/AAAAAAAAABk/6dOnX_lw3D8/photo.jpg?sz=128", "display_name": "Josh Fierro", "link": "https://stackoverflow.com/users/4971631/josh-fierro"}, "reply_to_user": {"reputation": 21, "user_id": 5441893, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35b55c87408ecc91c35f7be6e84c974e?s=128&d=identicon&r=PG&f=1", "display_name": "Jnowell", "link": "https://stackoverflow.com/users/5441893/jnowell"}, "edited": false, "score": 0, "creation_date": 1444779555, "post_id": 33110053, "comment_id": 54042959, "body": "I updated my answer to include an explanation of what you would need to change to include additional fields."}], "tags": [], "owner": {"reputation": 142, "user_id": 4971631, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Yv7lbt8gO-0/AAAAAAAAAAI/AAAAAAAAABk/6dOnX_lw3D8/photo.jpg?sz=128", "display_name": "Josh Fierro", "link": "https://stackoverflow.com/users/4971631/josh-fierro"}, "is_accepted": false, "score": 0, "last_activity_date": 1444779522, "last_edit_date": 1444779522, "creation_date": 1444761039, "answer_id": 33110053, "question_id": 33108937, "link": "https://stackoverflow.com/questions/33108937/copy-or-duplicate-rows-of-data-based-upon-cell-value/33110053#33110053", "title": "Copy or duplicate rows of data based upon cell value", "body": "<p>If your data exists in columns A:D, your original list is on Sheet1, and you want to create the new list on Sheet2, then the following vba will do what you need with a double loop.  Change up \"Sheet1\" and \"Sheet2\" to suit your actual needs.  Remember to format column C on sheet 2 as text or excel will automatically turn that data into a date...</p>\n\n<pre><code>Sub CreateYearList()\n    Application.ScreenUpdating = False\n    Application.Calculation = xlCalculationManual\n    Sheets(\"Sheet2\").Range(\"A1:D1\").Value = Sheets(\"Sheet1\").Range(\"A1:D1\").Value\n    Dim CmCt As Integer\n    Dim NRwCt As Integer\n    Dim ORwCt As Integer\n    Dim LArray() As String\n    Dim Yr As String\n    ORwCt = WorksheetFunction.CountA(Sheets(\"Sheet1\").Range(\"A:A\"))\n    For i = 2 To ORwCt\n        LArray = Split(Sheets(\"Sheet1\").Range(\"D\" &amp; i).Value, \",\")\n        CmCt = Len(Sheets(\"Sheet1\").Range(\"D\" &amp; i).Value) - Len(Replace(Sheets(\"Sheet1\").Range(\"D\" &amp; i).Value, \",\", \"\"))\n        NRwCt = WorksheetFunction.CountA(Sheets(\"Sheet2\").Range(\"A:A\"))\n        For n = 1 To CmCt + 1\n            Yr = LArray(n - 1)\n            Sheets(\"Sheet2\").Range(\"A\" &amp; NRwCt + n &amp; \":C\" &amp; NRwCt + n).Value = Sheets(\"Sheet1\").Range(\"A\" &amp; i &amp; \":C\" &amp; i).Value\n            Sheets(\"Sheet2\").Range(\"D\" &amp; NRwCt + n).Value = Yr\n        Next n\n    Next i\nApplication.ScreenUpdating = True\nApplication.Calculation = xlCalculationAutomatic\nEnd Sub\n</code></pre>\n\n<p>For additional fields, you can just change the the lines in the n loop to include whatever other fields are in your range.  If they wrap around your Fitment Years column, then you can add an additional copy of the 2nd line in that loop and change it to include whatever range is beyond that column.</p>\n\n<p>For example, let's say your Fitment Years column is actually column in column F and the additional fields go out to column Z.  In that case you would need to change the 2nd line in the loop to go up to the column before Fitment Years (E), and add a copy of the 2nd line that looks at the column after Fitment Years (G) and goes all the way to Z.  You would use these lines instead:</p>\n\n<pre><code>        Sheets(\"Sheet2\").Range(\"A\" &amp; NRwCt + n &amp; \":E\" &amp; NRwCt + n).Value = Sheets(\"Sheet1\").Range(\"A\" &amp; i &amp; \":E\" &amp; i).Value\n        Sheets(\"Sheet2\").Range(\"F\" &amp; NRwCt + n).Value = Yr\n        Sheets(\"Sheet2\").Range(\"G\" &amp; NRwCt + n &amp; \":Z\" &amp; NRwCt + n).Value = Sheets(\"Sheet1\").Range(\"G\" &amp; i &amp; \":Z\" &amp; i).Value\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 21, "user_id": 5441893, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35b55c87408ecc91c35f7be6e84c974e?s=128&d=identicon&r=PG&f=1", "display_name": "Jnowell", "link": "https://stackoverflow.com/users/5441893/jnowell"}, "edited": false, "score": 0, "creation_date": 1444774328, "post_id": 33110110, "comment_id": 54041326, "body": "Thanks for the input, I appreciate the help."}, {"owner": {"reputation": 12614, "user_id": 3566998, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S7lz6.png?s=128&g=1", "display_name": "Excel Hero", "link": "https://stackoverflow.com/users/3566998/excel-hero"}, "reply_to_user": {"reputation": 21, "user_id": 5441893, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35b55c87408ecc91c35f7be6e84c974e?s=128&d=identicon&r=PG&f=1", "display_name": "Jnowell", "link": "https://stackoverflow.com/users/5441893/jnowell"}, "edited": false, "score": 0, "creation_date": 1444780066, "post_id": 33110110, "comment_id": 54043094, "body": "@Jnowell If you need help, please reach out to me. My email address is: daniel.ferry@gmail.com"}, {"owner": {"reputation": 12614, "user_id": 3566998, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S7lz6.png?s=128&g=1", "display_name": "Excel Hero", "link": "https://stackoverflow.com/users/3566998/excel-hero"}, "reply_to_user": {"reputation": 21, "user_id": 5441893, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35b55c87408ecc91c35f7be6e84c974e?s=128&d=identicon&r=PG&f=1", "display_name": "Jnowell", "link": "https://stackoverflow.com/users/5441893/jnowell"}, "edited": false, "score": 0, "creation_date": 1444834981, "post_id": 33110110, "comment_id": 54069773, "body": "@Jnowell Did you get this working? I&#39;m here to help!"}], "tags": [], "owner": {"reputation": 12614, "user_id": 3566998, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S7lz6.png?s=128&g=1", "display_name": "Excel Hero", "link": "https://stackoverflow.com/users/3566998/excel-hero"}, "is_accepted": false, "score": 1, "last_activity_date": 1444761999, "last_edit_date": 1444761999, "creation_date": 1444761215, "answer_id": 33110110, "question_id": 33108937, "link": "https://stackoverflow.com/questions/33108937/copy-or-duplicate-rows-of-data-based-upon-cell-value/33110110#33110110", "title": "Copy or duplicate rows of data based upon cell value", "body": "<p>Try this.</p>\n\n<p>Place the following routine into a standard code module and run it. </p>\n\n<p>IMPORTANT: this does an in-place replacement of your data, so make sure you have a copy before running this.</p>\n\n<pre><code>Sub Jnowell()\n    Dim c&amp;, n&amp;, v, y\n    With [a2]\n        c = 1\n        Do\n            If Len(.Item(c)) Then\n                y = Split(.Item(c, 4), \", \")\n                If UBound(y) Then\n                    .Item(c)(2).Resize(UBound(y), 4).Insert xlDown\n                    v = .Item(c).Resize(, 4)\n                    .Item(c, 4) = y(0)\n                    For n = 1 To UBound(y)\n                        .Item(c)(n + 1).Resize(, 4) = v\n                        .Item(c, 4)(n + 1) = Left$(y(0), Len(y(0)) - 4) &amp; y(n)\n                    Next\n                End If\n            Else\n                Exit Do\n            End If\n            c = c + 1\n        Loop\n    End With\nEnd Sub\n</code></pre>\n\n<p>Note: this routine assumes your data are in columns A, B, C, and D of the currently active sheet.</p>\n"}], "owner": {"reputation": 21, "user_id": 5441893, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35b55c87408ecc91c35f7be6e84c974e?s=128&d=identicon&r=PG&f=1", "display_name": "Jnowell", "link": "https://stackoverflow.com/users/5441893/jnowell"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 705, "favorite_count": 1, "answer_count": 2, "score": 2, "last_activity_date": 1444857265, "creation_date": 1444757247, "last_edit_date": 1531161705, "question_id": 33108937, "link": "https://stackoverflow.com/questions/33108937/copy-or-duplicate-rows-of-data-based-upon-cell-value", "title": "Copy or duplicate rows of data based upon cell value", "body": "<p>I'm attempting to automate Excel in a way that will save me countless hours of tedious data entry. Here's my problem.</p>\n\n<p>We have motorcycle parts that can fit on many different year model vehicles. The file I am working with has a list of the years in a cell. These years may or may not be consecutive. They are separated by a \",\". I need a way to look at how many years are listed and duplicate the row of data that number of times.</p>\n\n<p>I also need it to give only a single year for each of those rows. In the examples below the final column is FITMENT YEARS; As you can see it has 3 different years each separated by a comma. In this instance it is only 3 years it could be 10 different years or it could be just a single year.</p>\n\n<p>THIS IS A SINGLE ROW OF WHAT I HAVE:</p>\n\n<pre><code>P/N Make    Mfg Model   Year Span   Fitment Years\n881612  Aprilia 881965  1000 RSV4 - (SACHS) 10-12   2010, 2011, 2012\n</code></pre>\n\n<p>THIS IS HOW I NEED IT TO BE LISTED:</p>\n\n<pre><code>P/N Make    Mfg Model   YearSpan    Fitment Years\n881612  Aprilia 881965  1000 RSV4 - (SACHS) 10-12   2010\n881612  Aprilia 881965  1000 RSV4 - (SACHS) 10-12   2011\n881612  Aprilia 881965  1000 RSV4 - (SACHS) 10-12   2012\n</code></pre>\n\n<p>I really need someone's help. I'm lost on how to proceed.\nThanks</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 23, "user_id": 6135730, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/abfdcff1d78faa18104a5010e36f3937?s=128&d=identicon&r=PG&f=1", "display_name": "Sohrab", "link": "https://stackoverflow.com/users/6135730/sohrab"}, "is_accepted": false, "score": 0, "last_activity_date": 1471445304, "creation_date": 1471445304, "answer_id": 38999879, "question_id": 33108797, "link": "https://stackoverflow.com/questions/33108797/how-to-pass-the-alm-qc-test-plan-folder-path-in-excel-macro-to-fetch-steps-for-s/38999879#38999879", "title": "How to pass the ALM/QC test plan folder path in excel macro to fetch steps for scripts in a particular folder", "body": "<p>Folder path in QC filters use backslash... try backslash (). </p>\n"}], "owner": {"reputation": 1, "user_id": 5398627, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/57d4f1a8002081edde80d00547d05aa0?s=128&d=identicon&r=PG&f=1", "display_name": "tushar9898", "link": "https://stackoverflow.com/users/5398627/tushar9898"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2696, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1471445304, "creation_date": 1444756809, "last_edit_date": 1444836715, "question_id": 33108797, "link": "https://stackoverflow.com/questions/33108797/how-to-pass-the-alm-qc-test-plan-folder-path-in-excel-macro-to-fetch-steps-for-s", "title": "How to pass the ALM/QC test plan folder path in excel macro to fetch steps for scripts in a particular folder", "body": "<p>I have an excel macro to fetch steps for scripts in ALM/QC test plan. Right now, it is fetching steps for all the scripts and it takes around 5-6 hours. I want to fetch steps for scripts in a particular folder. I am having trouble on how to pass the folder path.</p>\n\n<p>Request to please help me on how to pass the folder path. Also, if possible suggest on how to fetch steps only for a particular script.</p>\n\n<p>I tried 2 ways to give folder path. Both didn't worked.</p>\n\n<p>Way 1: fpath = \"Subject/Release 1/System Test/SCR 12345  Inbound\"</p>\n\n<p>Way 2: fpath = \"^&amp;#92Subject&amp;#92Release 1&amp;#92System Test&amp;#92SCR 12345  Inbound#92^\"</p>\n\n<p>Below is the macro code:</p>\n\n<pre><code>Function EmportTestCases()\n    On Error Resume Next\n    Dim QCConnection\n    Dim sUserName, sPassword\n    Dim sDomain, sProject\n    Dim TstFactory, TestList\n    Dim TestCase\n'Create QC Connection Object to connect to QC\n    Set QCConnection = CreateObject(\"TDApiOle80.TDConnection\")\n\n'    sUserName = InputBox(Prompt:=\"Enter ALM username\", Title:=\"ENTER ALM USERNAME\", Default:=\"\")\n\n    sUserName = \"username\"\n    sPassword = \"xxxxxxx\"\n\n'   sPassword = InputBox(Prompt:=\"Enter Password\", Title:=\"ENTER PASSWORD\", Default:=\"\")\n\n    QCConnection.InitConnectionEx \"QC url till QCBIN\"\n'Authenticate your user ID and Password\n    QCConnection.Login sUserName, sPassword\n'Quit if QC Authentication fails\n    If (QCConnection.LoggedIn &lt;&gt; True) Then\n        MsgBox \"QC User Authentication Failed\"\n        End\n    End If\n    sDomain = \"PROJDOMAIN\"\n    sProject = \"PROJ\"\n'Login to your Domain and Project\n    QCConnection.Connect sDomain, sProject\n'Quit if login fails to specified Domain and Project\n    If (QCConnection.AuthenticationToken = \"\") Then\n        MsgBox \"QC Project Failed to Connect to \" &amp; sProject\n        QCConnection.Disconnect\n        End\n    End If\n'Now successful connection is made to QC\n'Get the test factory\n    Set TstFactory = QCConnection.TestFactory\n' Your QC Project Path for which you want to download\n' the test cases.\n    fpath = InputBox(Prompt:=\"Enter Folder path\", Title:=\"ENTER FOLDER PATH\", Default:=\"\")\n'    fpath = \"Subject/Release 1/System Test/SCR 12345  Inbound\"\n' Entered the above fpath for the folder path.\n\n    Set myfilter = TstFactory.Filter()\n    myfilter.Filter(\"TS_SUBJECT\") = fpath\n'Get a list of all test cases for your specified path\n    Set TestList = myfilter.NewList()\n\n'Format the header before downloading the test cases\n            With ActiveSheet\n           .Range(\"B5\").Select\n            With .Range(\"B4:H4\")\n           .Font.Name = \"Arial\"\n           .Font.FontStyle = \"Bold\"\n           .Font.Size = 10\n           .Font.Bold = True\n           .HorizontalAlignment = xlCenter\n           .VerticalAlignment = xlCenter\n           .Interior.ColorIndex = 15\n           .Width = 20\n       End With\n        .Cells(4, 2) = \"Subject (Folder Name)\"\n        .Cells(4, 3) = \"Test Name (Manual Test Plan Name)\"\n        .Cells(4, 4) = \"Description\"\n        .Cells(4, 5) = \"Status\"\n        .Cells(4, 6) = \"Step Name\"\n        .Cells(4, 7) = \"Step Description(Action)\"\n        .Cells(4, 8) = \"Expected Result\"\n       Dim Row\n        Row = 5 '- set the data row from 5\n'loop through all the test cases.\n        For Each TestCase In TestList\n            .Cells(Row, 2).Value = TestCase.Field(\"TS_SUBJECT\").Path\n            .Cells(Row, 3).Value = TestCase.Field(\"TS_NAME\")\n'QC stores description in html format. So before storing it\n'in to excel, StripHTML() will remove all HTML tags and put\n'texts only. Also new line tag &lt;br&gt; is replaced with new line\n'character chr(10) in excel so that all the new line texts appears properly\n           .Cells(Row, 4).Value = StripHTML(Replace(TestCase.Field(\"TS_DESCRIPTION\"), _\n \"&lt;br&gt;\", Chr(10)))\n'  .Cells(Row, 4).Value = TestCase.Field(\"TS_DESCRIPTION\")\n            .Cells(Row, 5).Value = TestCase.Field(\"TS_EXEC_STATUS\")\n'Get the DesignStepFactory for the this testcase\n            Dim DesignStepFactory, DesignStep, DesignStepList\n            Set DesignStepFactory = TestCase.DesignStepFactory\n            Set DesignStepList = DesignStepFactory.NewList(\"\")\n'Check if design steps exists for the test\n            If DesignStepList.Count &lt;&gt; 0 Then\n'loop for all the steps for this test case\n                For Each DesignStep In DesignStepList\n                    .Cells(Row, 6).Value = DesignStep.StepName\n                    .Cells(Row, 7).Value = StripHTML(Replace(DesignStep.StepDescription, _\n \"&lt;br&gt;\", Chr(10)))\n  '                  .Cells(Row, 7).Value = DesignStep.StepDescription\n\n\n                    .Cells(Row, 8).Value = StripHTML(Replace(DesignStep.StepExpectedResult, _\n \"&lt;br&gt;\", Chr(10)))\n  '                  .Cells(Row, 8).Value = DesignStep.StepExpectedResult\n                    Row = Row + 1\n                Next 'next Step\n            End If\n            ' release the design step objects\n            Set DesignStepFactory = Nothing\n            Set DesignStep = Nothing\n            Set DesignStepList = Nothing\n        Next ' Next test case\n    End With\n    'Release the object\n    Set DesignStepFactory = Nothing\n    Set DesignStep = Nothing\n    Set DesignStepList = Nothing\n    Set TstFactory = Nothing\n    Set TestList = Nothing\n    Set TestCase = Nothing\n    QCConnection.Disconnect\n    MsgBox (\"All Test cases are downloaded with Test Steps\")\nEnd Function\n\n Function StripHTML(sInput As String) As String\n Dim RegEx As Object\n Set RegEx = CreateObject(\"vbscript.regexp\")\n\n Dim sOut As String\n With RegEx\n   .Global = True\n   .IgnoreCase = True\n   .MultiLine = True\n   .Pattern = \"&lt;[^&gt;]+&gt;\" 'Regular Expression for HTML Tags.\n  End With\n\n  sOut = RegEx.Replace(sInput, \"\")\n  StripHTML = sOut\n  Set RegEx = Nothing\nEnd Function\n</code></pre>\n\n<p><strong>strong text</strong></p>\n"}]