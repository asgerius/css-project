[{"tags": ["vba", "excel", "download"], "answers": [{"comments": [{"owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "reply_to_user": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1517444064, "post_id": 48553501, "comment_id": 84103438, "body": "@braX Don&#39;t you hate that? :D"}, {"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1517444110, "post_id": 48553501, "comment_id": 84103452, "body": "Question sits for 45 minutes with no answers and then 2 people simultaneously... It&#39;s ok tho - you need the points more :P"}, {"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 1, "creation_date": 1517444557, "post_id": 48553501, "comment_id": 84103528, "body": "You can also use <code>Environ$(&quot;UserProfile&quot;) &amp; &quot;\\Downloads\\&quot;</code> in case the user set up their profiles in a weird place that isn&#39;t <code>&quot;C:\\Users&quot;</code>"}, {"owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "edited": false, "score": 0, "creation_date": 1517444842, "post_id": 48553501, "comment_id": 84103577, "body": "@Thuunder Looks like your line with <code>MyDir = &quot;C:\\Users\\&quot; &amp; Environ$(&quot;Username&quot;) &amp; &quot;\\Downloads\\&quot;</code>"}], "tags": [], "owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "is_accepted": true, "score": 1, "last_activity_date": 1517443973, "creation_date": 1517443973, "answer_id": 48553501, "question_id": 48553132, "link": "https://stackoverflow.com/questions/48553132/copy-spreadsheet-from-downloads-folder-locally-into-a-main-sheet-on-a-different/48553501#48553501", "title": "Copy spreadsheet from Downloads folder locally into a main sheet on a different spreadsheet", "body": "<p>You can use <code>Environ$(\"Username\")</code> to get the current username. This will return a string.</p>\n\n<p>So your path would look something along the lines of:</p>\n\n<pre><code>\"C:\\Users\\\" &amp; Environ$(\"Username\") &amp; \"\\Downloads\\\"\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "is_accepted": false, "score": 1, "last_activity_date": 1517446411, "creation_date": 1517446411, "answer_id": 48553782, "question_id": 48553132, "link": "https://stackoverflow.com/questions/48553132/copy-spreadsheet-from-downloads-folder-locally-into-a-main-sheet-on-a-different/48553782#48553782", "title": "Copy spreadsheet from Downloads folder locally into a main sheet on a different spreadsheet", "body": "<p>You can also use <code>Environ$(\"UserProfile\") &amp; \"\\Downloads\\\"</code> in case the user set up their profiles in a weird place that isn't <code>\"C:\\Users\"</code></p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user9297102"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 43, "favorite_count": 0, "accepted_answer_id": 48553501, "answer_count": 2, "score": 1, "last_activity_date": 1517446411, "creation_date": 1517441313, "last_edit_date": 1517445848, "question_id": 48553132, "link": "https://stackoverflow.com/questions/48553132/copy-spreadsheet-from-downloads-folder-locally-into-a-main-sheet-on-a-different", "title": "Copy spreadsheet from Downloads folder locally into a main sheet on a different spreadsheet", "body": "<p>I've hit a roadblock and I can't figure it out for the life of me. Here is what I am trying to accomplish:</p>\n\n<ul>\n<li>A program I use exports a snapshot of the data into a spreadsheet (.xls) into the <strong>Downloads</strong> folder locally.</li>\n<li>I need to copy the data of sheet1 of this spreadsheet (<strong>without opening it</strong>) into the main spreadsheet I have saved elsewhere which is the \"main\" sheet and <strong>open</strong>. I have a macro button on the main sheet that runs this code.</li>\n</ul>\n\n<p>The caveat is that I have to make the Downloads folder dynamic in that it is not a specific username, because it is going to be used by multiple users.</p>\n\n<p>This code works perfectly for 1 person:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Sub sbCopyingAFile()\nDim MyFile As String, Str As String, MyDir As String, Wb As Workbook\nDim Rws As Long, Rng As Range\nSet Wb = ThisWorkbook\nMyDir = \"C:\\Users\\{My_Username}\\Downloads\\\"\nMyFile = Dir(MyDir &amp; \"*.xls\")\nChDir MyDir\nApplication.ScreenUpdating = 0\nApplication.DisplayAlerts = 0\n\nDo While MyFile &lt;&gt; \"\"\n    Workbooks.Open (MyFile)\n    With Worksheets(1)\n        Rws = .Cells(Rows.Count, \"A\").End(xlUp).Row\n        Set Rng = Range(.Cells(2, 1), .Cells(Rws, 19))\n        Rng.Copy Wb.Worksheets(\"DUMP\").Cells(Rows.Count, \"B\").End(xlUp).Offset(0, 0)\n        ActiveWorkbook.Close True\n    End With\n    MyFile = Dir()\nLoop\nOn Error Resume Next\n    Kill \"C:\\Users\\{My_Username}\\Downloads\\*.*\"\nOn Error GoTo 0\n\nEnd Sub\n</code></pre>\n\n<p>This was my last attempt at getting any Downloads folder, not specific to a username:</p>\n\n<pre><code>Sub sbCopyingAFile()\nDim MyFile As String, Str As String, Wb As Workbook, MyDir As String\n'Dim fso\nDim Rws As Long, Rng As Range\n'Set fso = CreateObject(\"Scripting.FileSystemObject\")\nSet Wb = ThisWorkbook\nMyDir = CreateObject(\"WScript.Shell\").specialfolders(\"Downloads\")\n'MyDir = \"C:\\Users\\{My_Username}\\Downloads\\\"\nMyFile = Dir(MyDir &amp; \"*.xls\")\nChDir MyDir\nApplication.ScreenUpdating = 0\nApplication.DisplayAlerts = 0\n\nDo While MyFile &lt;&gt; \"\"\nWorkbooks.Open (MyFile)\nWith Worksheets(1)\n    Rws = .Cells(Rows.Count, \"A\").End(xlUp).Row\n    Set Rng = Range(.Cells(2, 1), .Cells(Rws, 19))\n    Rng.Copy Wb.Worksheets(\"DUMP\").Cells(Rows.Count, \"B\").End(xlUp).Offset(0, 0)\n    ActiveWorkbook.Close True\nEnd With\nMyFile = Dir()\nLoop\nOn Error Resume Next\n'Kill \"C:\\Users\\{My_Username}\\Downloads\\*.*\"\nOn Error GoTo 0\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2953, "user_id": 2801253, "user_type": "registered", "profile_image": "https://graph.facebook.com/1332362525/picture?type=large", "display_name": "Mark Fitzgerald", "link": "https://stackoverflow.com/users/2801253/mark-fitzgerald"}, "edited": false, "score": 1, "creation_date": 1517459734, "post_id": 48552851, "comment_id": 84106920, "body": "When you say &quot;clear table formatting&quot; do you mean that you want any tables converted back to ranges?"}, {"owner": {"reputation": 11, "user_id": 9297119, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fcf25fc8bf94c1ac268427f21807d90a?s=128&d=identicon&r=PG&f=1", "display_name": "AGraphcs", "link": "https://stackoverflow.com/users/9297119/agraphcs"}, "reply_to_user": {"reputation": 2953, "user_id": 2801253, "user_type": "registered", "profile_image": "https://graph.facebook.com/1332362525/picture?type=large", "display_name": "Mark Fitzgerald", "link": "https://stackoverflow.com/users/2801253/mark-fitzgerald"}, "edited": false, "score": 0, "creation_date": 1517494587, "post_id": 48552851, "comment_id": 84125481, "body": "Correct. All the tables need to be converted to ranges. Then all cell formatting needs to be removed."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 9297119, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fcf25fc8bf94c1ac268427f21807d90a?s=128&d=identicon&r=PG&f=1", "display_name": "AGraphcs", "link": "https://stackoverflow.com/users/9297119/agraphcs"}, "edited": false, "score": 0, "creation_date": 1517494678, "post_id": 48553145, "comment_id": 84125550, "body": "Regarding &quot;Non-Functional&quot;, if I remove the &quot;Selection.ClearContents&quot; line from the macro, it doesn&#39;t complete any actions when I run it in Excel.  The above code doesn&#39;t seem to perform any actions on these spreadsheets."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 11, "user_id": 9297119, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fcf25fc8bf94c1ac268427f21807d90a?s=128&d=identicon&r=PG&f=1", "display_name": "AGraphcs", "link": "https://stackoverflow.com/users/9297119/agraphcs"}, "edited": false, "score": 0, "creation_date": 1517497118, "post_id": 48553145, "comment_id": 84127297, "body": "Colour a cell yellow, run the code and let me know what happens."}, {"owner": {"reputation": 11, "user_id": 9297119, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fcf25fc8bf94c1ac268427f21807d90a?s=128&d=identicon&r=PG&f=1", "display_name": "AGraphcs", "link": "https://stackoverflow.com/users/9297119/agraphcs"}, "edited": false, "score": 0, "creation_date": 1517498598, "post_id": 48553145, "comment_id": 84128334, "body": "It got rid of the yellow.  All the table formatting is still there.  Maybe we need a clear table?"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 11, "user_id": 9297119, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fcf25fc8bf94c1ac268427f21807d90a?s=128&d=identicon&r=PG&f=1", "display_name": "AGraphcs", "link": "https://stackoverflow.com/users/9297119/agraphcs"}, "edited": false, "score": 0, "creation_date": 1517499155, "post_id": 48553145, "comment_id": 84128706, "body": "Can you try amended code above? Hadn&#39;t realised that formats does not affect tables."}, {"owner": {"reputation": 11, "user_id": 9297119, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fcf25fc8bf94c1ac268427f21807d90a?s=128&d=identicon&r=PG&f=1", "display_name": "AGraphcs", "link": "https://stackoverflow.com/users/9297119/agraphcs"}, "edited": false, "score": 0, "creation_date": 1517500498, "post_id": 48553145, "comment_id": 84129644, "body": "That just freezes excel up.  Is there a way just to clear character formatting?"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 11, "user_id": 9297119, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fcf25fc8bf94c1ac268427f21807d90a?s=128&d=identicon&r=PG&f=1", "display_name": "AGraphcs", "link": "https://stackoverflow.com/users/9297119/agraphcs"}, "edited": false, "score": 0, "creation_date": 1517502169, "post_id": 48553145, "comment_id": 84130784, "body": "Try it on a small workbook. Don&#39;t really see why that should be a problem though. Did it actually crash or just take a long time to finish?"}], "tags": [], "owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "is_accepted": false, "score": 1, "last_activity_date": 1517499136, "last_edit_date": 1517499136, "creation_date": 1517441409, "answer_id": 48553145, "question_id": 48552851, "link": "https://stackoverflow.com/questions/48552851/vba-macro-help-clear-table-and-cell-formatting-from-excel-2016/48553145#48553145", "title": "VBA Macro Help - Clear Table and Cell Formatting from Excel 2016", "body": "<p>Not sure what you mean by non-functional. Anyway you don't need to select or activate anything.</p>\n\n<pre><code>Sub ClearAll()\n\nDim sht As Worksheet, wbook As Workbook, t As ListObject\n\nSet wbook = ActiveWorkbook\n\nFor Each sht In wbook.Worksheets\n    For Each t In sht.ListObjects\n        t.Unlist\n    Next t\n    sht.Cells.ClearFormats\nNext sht\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 9297119, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fcf25fc8bf94c1ac268427f21807d90a?s=128&d=identicon&r=PG&f=1", "display_name": "AGraphcs", "link": "https://stackoverflow.com/users/9297119/agraphcs"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2763, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1517499136, "creation_date": 1517439612, "last_edit_date": 1531164843, "question_id": 48552851, "link": "https://stackoverflow.com/questions/48552851/vba-macro-help-clear-table-and-cell-formatting-from-excel-2016", "title": "VBA Macro Help - Clear Table and Cell Formatting from Excel 2016", "body": "<p>I am trying to clear all Table Formatting and Cell Formatting from entire workbooks.  This code gets me most of the way there, but I do not want to clear cell contents.</p>\n\n<p>I have tried modifying this behavior by removing the Selection.ClearContents string.  This makes the code nonfunctional, however.</p>\n\n<p>Any help would be greatly appreciated.</p>\n\n<p>Thanks!</p>\n\n<pre><code>Sub ClearAll()\n\n    Set wbook = ActiveWorkbook\n\n    For Each sht In wbook.Worksheets\n       sht.Activate\n       sht.Cells.Select\n       Selection.ClearContents\n       Selection.ClearFormats ' edit: clear formats too\n       sht.Cells(1, 1).Select ' edit: select the first cell to cancel selection of the whole sheet\n    Next sht\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "forms", "ms-access-2016"], "owner": {"reputation": 35, "user_id": 8138189, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/57029fe3317e9260d12e2a085c2a1a4b?s=128&d=identicon&r=PG&f=1", "display_name": "TechEng", "link": "https://stackoverflow.com/users/8138189/techeng"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 273, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1517439589, "creation_date": 1517439589, "question_id": 48552845, "link": "https://stackoverflow.com/questions/48552845/openform-form-search-with-condition-on-id-field-to-open-1-of-3-forms-based-on-ty", "title": "OpenForm form Search with condition on ID field to open 1 of 3 forms based on Type field in Search form", "body": "<p>My database is organized with a main central navigation form (\"Main Menu\"). Clicking on any of the nav buttons on the left side will take users to a form with 1 to many subforms. For example, clicking on the Health Claims navigation button will take users to the Health Claims Form with seven tabs (each tab is a different subform). </p>\n\n<p>I have created a Search page with <code>[IDENT_NUM]</code> and [TYPE] that displays different types of claims records-each claim type will go to its specific claim form (one of three options). I am trying to click on the <code>[IDENT_NUM]</code> field in the search table and have it take me to one of the three forms depending on the [TYPE] field. My Search page is a search subform in a \"Search\" Form then dropped into my Main Menu. So, if I click on ID = 123 with Type = Health, I would like to be taken to the Health Claims of ID 123. </p>\n\n<p>My search is set up to show all claims so it can be seen which clients have multiple claims and what types of claims. </p>\n\n<p>My three forms are Credit, Health Claims, Life Claims\nCredit form corresponds to TYPE: \"Policy\" OR \"Certificate\"\nHealth form corresponds to TYPE: \"Health\" \nLife form corresponds to TYPE:\"Disablity\" OR \"Life\"</p>\n\n<p>I tried adding macro and VBA (independent of one another) 'OpenForm' and I could not get the VBA to work at all but the macro would open either a blank form only or an existing record that did not match the <code>[IDENT_NUM]</code> clicked or the type.</p>\n\n<pre><code>Private Sub IDENT_NUM_Click()\nDoCmd.OpenForm\"Health Claims\", , , \n\"IDENT_NUM = '\" &amp; (Me.IDENT_NUM) &amp; \"'\"\nEnd Sub\n</code></pre>\n\n<p>I created an OpenForm macro in the OnClick property of my field IDENT_NUM in my search table with the following <code>Where Condition =[IDENT_NUM]=[Forms]![Main Menu]![Health Claims]![IDENT_NUM].</code> This macro just opens a blank record which will be great when I want to do that (I will use buttons) but for now, I want to go to the applicable form type based on the [IDENT_NUM] and [TYPE] selected in the Search Table. If I change the <code>Where Condition =[IDENT_NUM]</code>, it will take me to the same record regardless of the [IDENT_NUM] selected.  I also tried adding IF, ELSE IF too but nothing worked for actually getting me my results. </p>\n\n<p>I think the problem in the macro is my navigation but I am not positive how to fix it. I also am not sure if I can just open the form or if I need to add the specific subform with the ID field...do I need to do the same for the Type? They are in different subforms currently but I could change that if needed.</p>\n\n<p>I would really appreciate the help and guidance. </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1517438383, "post_id": 48552588, "comment_id": 84101662, "body": "Have you tried mapping to <code>vbNullString</code> instead of <code>&quot;&quot;</code>? Might not work, but maybe receiving a null string pointer can hint <code>OnKey</code> that we&#39;re trying to <i>remove</i> a macro (as opposed to <i>remap</i>) - just thinking out loud, haven&#39;t tried it"}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1517438629, "post_id": 48552588, "comment_id": 84101751, "body": "@Mat&#39;sMug  Thanks for the suggestion............sadly, the behavior is the same."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1517439270, "post_id": 48552588, "comment_id": 84102022, "body": "Interestingly, it looks like <a href=\"https://www.rondebruin.nl/win/s4/win012.htm\" rel=\"nofollow noreferrer\">this post</a> suggests you&#39;re doing everything right. The plot thickens..."}], "answers": [{"comments": [{"owner": {"reputation": 125, "user_id": 9286328, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aeeed8cae4b75e12efcecf28da5d924d?s=128&d=identicon&r=PG&f=1", "display_name": "Mister B", "link": "https://stackoverflow.com/users/9286328/mister-b"}, "edited": false, "score": 0, "creation_date": 1517444723, "post_id": 48553310, "comment_id": 84103555, "body": "@Tim Williams As the &quot;other user&quot; mentioned in line one, I super appreciate the help!"}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 5, "last_activity_date": 1517445065, "last_edit_date": 1517445065, "creation_date": 1517442487, "answer_id": 48553310, "question_id": 48552588, "link": "https://stackoverflow.com/questions/48552588/application-onkey-fails-to-reset-properly/48553310#48553310", "title": "Application.OnKey Fails to Reset Properly", "body": "<p>Using just </p>\n\n<pre><code>Application.OnKey \"{ENTER}\" \n</code></pre>\n\n<p>with no second argument seems to clear the macro mapping and return the default key action (Excel 2013) </p>\n\n<p><a href=\"https://msdn.microsoft.com/en-us/vba/excel-vba/articles/application-onkey-method-excel\" rel=\"nofollow noreferrer\">https://msdn.microsoft.com/en-us/vba/excel-vba/articles/application-onkey-method-excel</a></p>\n\n<pre><code>expression.OnKey( Key , Procedure )\n</code></pre>\n\n<p>The description for the <code>Procedure</code> parameter has this:</p>\n\n<blockquote>\n  <p>A string indicating the name of the procedure to be run. <strong>If Procedure\n  is \"\" (empty text), nothing happens when Key is pressed.</strong> This form of\n  OnKey changes the normal result of keystrokes in Microsoft Excel. <strong>If\n  Procedure is omitted, Key reverts to its normal result in Microsoft\n  Excel</strong>, and any special key assignments made with previous OnKey\n  methods are cleared.</p>\n</blockquote>\n"}], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 949, "favorite_count": 1, "accepted_answer_id": 48553310, "answer_count": 1, "score": 5, "last_activity_date": 1517445065, "creation_date": 1517438174, "last_edit_date": 1517438867, "question_id": 48552588, "link": "https://stackoverflow.com/questions/48552588/application-onkey-fails-to-reset-properly", "title": "Application.OnKey Fails to Reset Properly", "body": "<p>I am trying to help another user in this forum (<a href=\"https://stackoverflow.com/questions/48512147/run-a-macro-in-excel-2010-using-enter-key-whether-worksheet-has-changed-or-not/48512820#48512820\">reference</a>).  The goal is to use the <kbd>Enter</kbd> key on the numeric keypad to trigger a macro rather than use the Worksheet_Change event macro for the same purpose.<br><br>Before anything is run, both <kbd>Enter</kbd> keys work identically.  You type stuff in, touch either key, the material gets placed in the cell and <code>Selection</code> moves downward.  If you just pump either key, <code>Selection</code> just moves downward.</p>\n\n<p>In a standard module I put:</p>\n\n<pre><code>Sub NumericEnter()\n    Application.OnKey \"{ENTER}\", \"InsertIntoTables\"\nEnd Sub\n</code></pre>\n\n<p>and</p>\n\n<pre><code>Sub InsertIntoTables()\n    MsgBox \"Inserting\"\nEnd Sub\n</code></pre>\n\n<p>After I run <code>NumericEnter()</code>, the <kbd>Enter</kbd> key on the numeric keypad calls the proper macro each time it is touched.  The normal <kbd>Enter</kbd> key is not affected.</p>\n\n<p>I then tried to restore the numeric <kbd>Enter</kbd> key by running:</p>\n\n<pre><code>Sub ClearEnter()\n    Application.OnKey \"{ENTER}\", \"\"\nEnd Sub\n</code></pre>\n\n<p>The numeric <kbd>Enter</kbd> key partially reverts to its original behavior.  It no longer calls the macro; it allows data entry into cell, <strong>but it does not move <code>Selection</code> at all!</strong>  <em>(the regular enter key still behaves normally)</em></p>\n\n<p>I have no idea of what I have missed.</p>\n\n<p><strong>What I have looked at:</strong></p>\n\n<ul>\n<li>The normal enter key, the ARROW keys, and the TAB key work just fine at changing <code>Selection</code></li>\n<li>Mouse clicking works fine at changing <code>Selection</code></li>\n<li>the values of <code>Application.MoveAfterReturn</code> and <code>Application.MoveAfterReturnDirection</code> look fine as well.</li>\n</ul>\n"}, {"tags": ["vba", "excel", "loops", "exit-code"], "comments": [{"owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "edited": false, "score": 0, "creation_date": 1517438121, "post_id": 48552510, "comment_id": 84101543, "body": "Why do you even have <code>Exit For</code> to begin with? If you intention is to continue your For statement in its entirety, then you do not need to exit it."}, {"owner": {"reputation": 348, "user_id": 9105621, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/880c2cac0853ab50edc75f8b70802a20?s=128&d=identicon&r=PG&f=1", "display_name": "Mike Mann", "link": "https://stackoverflow.com/users/9105621/mike-mann"}, "reply_to_user": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "edited": false, "score": 0, "creation_date": 1517438385, "post_id": 48552510, "comment_id": 84101664, "body": "@K.D\u1d00\u1d20\u026as it&#39;s setup to <code>exit for</code> if the condition is met that way the <code>else</code> portion isn&#39;t triggered"}, {"owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "edited": false, "score": 0, "creation_date": 1517438407, "post_id": 48552510, "comment_id": 84101673, "body": "It doesn&#39;t trigger if the first statement is true. You should probably <a href=\"https://docs.microsoft.com/en-us/dotnet/visual-basic/language-reference/statements/if-then-else-statement\" rel=\"nofollow noreferrer\">read up on how that works</a>."}, {"owner": {"reputation": 348, "user_id": 9105621, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/880c2cac0853ab50edc75f8b70802a20?s=128&d=identicon&r=PG&f=1", "display_name": "Mike Mann", "link": "https://stackoverflow.com/users/9105621/mike-mann"}, "reply_to_user": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "edited": false, "score": 0, "creation_date": 1517438545, "post_id": 48552510, "comment_id": 84101717, "body": "@K.D\u1d00\u1d20\u026as thanks but it is triggering since the last line of the loop doesn&#39;t always meet the if statement condition"}, {"owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "edited": false, "score": 0, "creation_date": 1517438609, "post_id": 48552510, "comment_id": 84101743, "body": "So you are saying if any line in your for statement is true, then regardless of the rest of the for statement you do not want to pop up your msg? You can add a boolean flag to track this for you."}], "answers": [{"tags": [], "owner": {"reputation": 53, "user_id": 8924904, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/863ab13dfe81df36b2c392675ee8d5ce?s=128&d=identicon&r=PG&f=1", "display_name": "JJB", "link": "https://stackoverflow.com/users/8924904/jjb"}, "is_accepted": false, "score": 1, "last_activity_date": 1517446173, "last_edit_date": 1517446173, "creation_date": 1517438703, "answer_id": 48552695, "question_id": 48552510, "link": "https://stackoverflow.com/questions/48552510/loop-stops-after-one-condition-is-met-even-if-there-are-multiple/48552695#48552695", "title": "Loop stops after one condition is met even if there are multiple", "body": "<p>Echoing K.Davis comment, not sure why you would want to exit?</p>\n\n<p>I made some edits to your code.  Error handling is not included, but the code should complete the loop and tell you if nothing is found.</p>\n\n<pre><code>Private Sub cmdAdd_Click()\n    On Error GoTo Whoa\n    Dim LastRow As Long, i As Long\n    LastRow = ActiveSheet.Range(Me.txtTaskCol.Value &amp; Rows.Count).End(xlUp).Row\n\n'Set a counter so you can message Task Not Found\n    Dim matchCounter as Integer\n    matchCounter = 0\n\n'Copy input values to sheet\n    For i = 1 To LastRow\n        If UCase(CStr(ActiveSheet.Range(Me.txtTaskCol.Value &amp; i).Value)) = _\n        UCase(CStr(Me.txtTask.Value)) Then\n            ActiveSheet.Range(Me.txtUnitCol.Value &amp; i).Value = Me.txtQuantity.Value\n            matchCounter = matchCounter + 1\n        End If\n    Next i\n\nIf matchCounter = 0 then MsgBox \"Nothing Found\"\n\n'Clear input controls\n    Me.txtTask.Value = \"\"\n    Me.txtQuantity.Value = \"\"\n    Exit Sub\n\nEnd Sub\n</code></pre>\n\n<p>Hope it's helpful.</p>\n"}, {"tags": [], "owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "is_accepted": true, "score": 0, "last_activity_date": 1517438984, "last_edit_date": 1517438984, "creation_date": 1517438716, "answer_id": 48552697, "question_id": 48552510, "link": "https://stackoverflow.com/questions/48552510/loop-stops-after-one-condition-is-met-even-if-there-are-multiple/48552697#48552697", "title": "Loop stops after one condition is met even if there are multiple", "body": "<p>Just use a boolean flag that will set the flag to <code>True</code> if your <code>If...Then</code> statement is true one time:</p>\n\n<p>If you are wanting to continue your <code>For...Next</code> statement after you meet the criteria, then you don't want to exit for.</p>\n\n<pre><code>Private Sub cmdAdd_Click()\n    On Error GoTo Whoa\n    Dim LastRow As Long, i As Long, tskFlg As Boolean\n    LastRow = ActiveSheet.Range(Me.txtTaskCol.Value &amp; Rows.Count).End(xlUp).Row\n    'Copy input values to sheet\n    For i = 1 To LastRow\n        If UCase(CStr(ActiveSheet.Range(Me.txtTaskCol.Value &amp; i).Value)) = UCase(CStr(Me.txtTask.Value)) Then\n            ActiveSheet.Range(Me.txtUnitCol.Value &amp; i).Value = Me.txtQuantity.Value\n            tskFlg = True\n        End If\n    Next i\n    If tskFlg = False Then MsgBox \"Task Not Found!\"\n    'Clear input controls\n    Me.txtTask.Value = \"\"\n    Me.txtQuantity.Value = \"\"\n    Exit Sub\n\nWhoa:\n        Select Case Err.Number\n            Case 1004\n                MsgBox \"Check for Valid Column Letters!\"\n        End Select\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 348, "user_id": 9105621, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/880c2cac0853ab50edc75f8b70802a20?s=128&d=identicon&r=PG&f=1", "display_name": "Mike Mann", "link": "https://stackoverflow.com/users/9105621/mike-mann"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 229, "favorite_count": 0, "accepted_answer_id": 48552697, "answer_count": 2, "score": 0, "last_activity_date": 1517446173, "creation_date": 1517437764, "last_edit_date": 1517438848, "question_id": 48552510, "link": "https://stackoverflow.com/questions/48552510/loop-stops-after-one-condition-is-met-even-if-there-are-multiple", "title": "Loop stops after one condition is met even if there are multiple", "body": "<p>The code below will \"exit for\" after it meets its condition once even if there are more in the range that meet the condition. How do I correct this?</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Private Sub cmdAdd_Click()\n    On Error GoTo Whoa\n    Dim LastRow As Long, i As Long\n    LastRow = ActiveSheet.Range(Me.txtTaskCol.Value &amp; Rows.Count).End(xlUp).Row\n    'Copy input values to sheet\n    For i = 1 To LastRow\n        If UCase(CStr(ActiveSheet.Range(Me.txtTaskCol.Value &amp; i).Value)) = UCase(CStr(Me.txtTask.Value)) Then\n            ActiveSheet.Range(Me.txtUnitCol.Value &amp; i).Value = Me.txtQuantity.Value\n            Exit For\n        Else\n            If i = LastRow Then MsgBox \"Task Not Found!\"\n        End If\n    Next i\n    'Clear input controls\n    Me.txtTask.Value = \"\"\n    Me.txtQuantity.Value = \"\"\n    Exit Sub\n\nWhoa:\n        Select Case Err.Number\n            Case 1004\n                MsgBox \"Check for Valid Column Letters!\"\n        End Select\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["arrays", "vba", "excel"], "comments": [{"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1517492862, "post_id": 48552452, "comment_id": 84124270, "body": "You should explain HOW it doesn&#39;t work and what the expected result is when it does work."}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1517496417, "post_id": 48552452, "comment_id": 84126791, "body": "Welcome to SO.  Could you have a read of these links please:  <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a> and <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>.  Also could you paste the actual code so it can be copied rather than a picture of the code"}, {"owner": {"reputation": 11, "user_id": 9297005, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9815775f16e55f7a0cc08f090bf4716?s=128&d=identicon&r=PG&f=1", "display_name": "Nick", "link": "https://stackoverflow.com/users/9297005/nick"}, "edited": false, "score": 0, "creation_date": 1517588256, "post_id": 48552452, "comment_id": 84170474, "body": "Thanks for the advice, I&#39;m learning VBA and am new to all of this stuff."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 9297005, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9815775f16e55f7a0cc08f090bf4716?s=128&d=identicon&r=PG&f=1", "display_name": "Nick", "link": "https://stackoverflow.com/users/9297005/nick"}, "edited": false, "score": 0, "creation_date": 1517588195, "post_id": 48552628, "comment_id": 84170432, "body": "Thanks for your help."}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": true, "score": 2, "last_activity_date": 1517438386, "creation_date": 1517438386, "answer_id": 48552628, "question_id": 48552452, "link": "https://stackoverflow.com/questions/48552452/not-understanding-array-range-reference/48552628#48552628", "title": "Not understanding Array range reference", "body": "<p>The first code creates and uses a <strong>one-dimensional</strong> array.<br>The second code creates a <strong>two-dimensional</strong> array.</p>\n\n<p>That is why <code>Join()</code> fails in the second case.</p>\n"}, {"comments": [{"owner": {"reputation": 11, "user_id": 9297005, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9815775f16e55f7a0cc08f090bf4716?s=128&d=identicon&r=PG&f=1", "display_name": "Nick", "link": "https://stackoverflow.com/users/9297005/nick"}, "edited": false, "score": 0, "creation_date": 1517588179, "post_id": 48553599, "comment_id": 84170421, "body": "Thanks for your help."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 0, "last_activity_date": 1517444767, "creation_date": 1517444767, "answer_id": 48553599, "question_id": 48552452, "link": "https://stackoverflow.com/questions/48552452/not-understanding-array-range-reference/48553599#48553599", "title": "Not understanding Array range reference", "body": "<p>You can use application.transpose once to convert a 2-D array of the values from multiple rows in a single column or use it twice to convert the values from multiple columns in a single row.</p>\n\n<pre><code>Dim na As Variant, fn As String\n\nna = Application.Transpose(Application.Transpose(Range(\"b1:f1\").Value2))\nfn = Join(na, \"-\")\n\nDebug.Print fn\n</code></pre>\n\n<p>p.s. It's always a pleasure to have to retype code that should have been copied from the VBE and pasted into a code block.</p>\n"}], "owner": {"reputation": 11, "user_id": 9297005, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9815775f16e55f7a0cc08f090bf4716?s=128&d=identicon&r=PG&f=1", "display_name": "Nick", "link": "https://stackoverflow.com/users/9297005/nick"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 46, "favorite_count": 0, "closed_date": 1517497457, "accepted_answer_id": 48552628, "answer_count": 2, "score": -6, "last_activity_date": 1517462110, "creation_date": 1517437482, "last_edit_date": 1517462110, "question_id": 48552452, "link": "https://stackoverflow.com/questions/48552452/not-understanding-array-range-reference", "closed_reason": "Not suitable for this site", "title": "Not understanding Array range reference", "body": "<p>I'm not understanding why <code>Sub join_example()</code> works but <code>Sub join_2_example()</code> doesn't work.  </p>\n\n<p><a href=\"https://i.stack.imgur.com/ce7yX.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ce7yX.png\" alt=\"Code Image\"></a></p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 2, "creation_date": 1517437040, "post_id": 48552107, "comment_id": 84101055, "body": "Whenever VBA code doesn&#39;t work as intended, the first thing to do is to remove <code>On Error Resume Next</code> and see what error you&#39;re shoving under the carpet. Don&#39;t use <code>On Error Resume Next</code> like this. Ever."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1517437165, "post_id": 48552107, "comment_id": 84101118, "body": "Hmm, just noticed the other <code>On Error</code> statement. What happens if you remove it as well? The <code>On Error Resume Next</code> statement in your <code>Sheet_Cleanup</code> error-handling subroutine is wrong. Actually the fact that you have an error-handling subroutine executing in the &quot;happy path&quot; feels wrong too. You need to un-tangle the &quot;happy path&quot; and the &quot;error path&quot; and make sure the &quot;error path&quot; only ever runs when there&#39;s an error - and <code>Resume</code> to the cleanup label."}, {"owner": {"reputation": 75, "user_id": 2928706, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/b57fc16033198aa71df0df2e7ca884d0?s=128&d=identicon&r=PG&f=1", "display_name": "Glamador", "link": "https://stackoverflow.com/users/2928706/glamador"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1517492523, "post_id": 48552107, "comment_id": 84124030, "body": "The use of &#39;Resume Next&#39; in this case is so that no user ever sees an error box.  I removed the error code in my testing, and likely should not have included it in the snippet above.  Removing it does nothing to change the outcome."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1517496304, "post_id": 48552107, "comment_id": 84126723, "body": "But it rules out any error that would otherwise have been hidden."}, {"owner": {"reputation": 75, "user_id": 2928706, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/b57fc16033198aa71df0df2e7ca884d0?s=128&d=identicon&r=PG&f=1", "display_name": "Glamador", "link": "https://stackoverflow.com/users/2928706/glamador"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1517510405, "post_id": 48552107, "comment_id": 84135533, "body": "I understand.  I did not do my testing with the error code in place.  Printing err.description gives no additional detail at the time of failure.  Execution just stops with no explanation."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1517510727, "post_id": 48552107, "comment_id": 84135732, "body": "What&#39;s your setting for tools/options/general/error traping? Is it &quot;Break on All Errors&quot;?"}, {"owner": {"reputation": 75, "user_id": 2928706, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/b57fc16033198aa71df0df2e7ca884d0?s=128&d=identicon&r=PG&f=1", "display_name": "Glamador", "link": "https://stackoverflow.com/users/2928706/glamador"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1517522883, "post_id": 48552107, "comment_id": 84141866, "body": "I have created the error conditions in both &quot;All Errors&quot; and &quot;Unhandled Errors&quot; settings.  Same result, no error messages.  I found an old question with a similar issue, but no viable solution here:<a href=\"https://stackoverflow.com/questions/37858167/error-adding-a-new-sheet-to-a-xlsm-macro-excel-file\" title=\"error adding a new sheet to a xlsm macro excel file\">stackoverflow.com/questions/37858167/&hellip;</a>.  I do not believe it is an issue with installation, since the error occurs on multiple users&#39; machines, all running Excel 2007."}], "answers": [{"comments": [{"owner": {"reputation": 75, "user_id": 2928706, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/b57fc16033198aa71df0df2e7ca884d0?s=128&d=identicon&r=PG&f=1", "display_name": "Glamador", "link": "https://stackoverflow.com/users/2928706/glamador"}, "edited": false, "score": 0, "creation_date": 1517492686, "post_id": 48553723, "comment_id": 84124150, "body": "I agree with your changes, there was no cause to encapsulate the cleanup in the successful fork of the If-statement, I just put it there because in the other case there is no worksheet to be deleted.  In any case, that still produces no pop-up and no error.  I put debug code all over the subroutine, and it never even runs the code in sub_error.  Execution just...ceases."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user5326167"}, "is_accepted": false, "score": 0, "last_activity_date": 1517445873, "creation_date": 1517445873, "answer_id": 48553723, "question_id": 48552107, "link": "https://stackoverflow.com/questions/48552107/execution-stops-after-adding-worksheet/48553723#48553723", "title": "Execution Stops After Adding Worksheet", "body": "<p>I can see some logic flaws in the code. You should remove \"On error resume next\" first of all. I reorganized the code as follows. You will get a message box with the error.</p>\n\n<pre><code>Private Function Difference(r1 As Range, r2 As Range) As Range\n'Purpose: Returns a range containing only the cells which are not shared \nbetween the two passed ranges\nOn Error got sub_error\n\nApplication.EnableEvents = False   \nDim s As String\nDim ws As Worksheet\nDim diff As Range, zRng As Range, cRng As Range\n\nIf Not r2 Is Nothing Then\n    If Not (r1.Parent Is r2.Parent) Then GoTo sub_exit\n\n    Set ws = Worksheets.Add\n    For Each a In r1.Areas\n        Set zRng = chkUnion(zRng, ws.Range(a.Address))\n    Next a\n    zRng = 0\n    For Each b In r2.Areas\n        Set cRng = chkUnion(cRng, ws.Range(b.Address))\n    Next b\n    cRng.Clear\n\n    For Each c In ws.UsedRange.SpecialCells(xlCellTypeConstants).Areas\n        Set diff = chkUnion(diff, r1.Parent.Range(c.Address))\n    Next c   \nElse\n    Set diff = r1\nEnd If\nIf Not diff Is Nothing Then Set Difference = diff\n\nsub_exit:\nApplication.DisplayAlerts = False\nif not ws is nothing then ws.Delete\nApplication.DisplayAlerts = True\nexit function\n\nsub_error:\nmsgbox (err.description)\nresume sub_exit\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 75, "user_id": 2928706, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/b57fc16033198aa71df0df2e7ca884d0?s=128&d=identicon&r=PG&f=1", "display_name": "Glamador", "link": "https://stackoverflow.com/users/2928706/glamador"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 136, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1517445873, "creation_date": 1517435861, "last_edit_date": 1517443722, "question_id": 48552107, "link": "https://stackoverflow.com/questions/48552107/execution-stops-after-adding-worksheet", "title": "Execution Stops After Adding Worksheet", "body": "<p>I am using VBA code in a custom ribbon for Excel 2007 to insert a \"helper\" worksheet which is to be deleted after execution concludes.</p>\n\n<p>However, under certain circumstances, execution stops after the \"Worksheet.Add\" function is called with no error, no debug text, and no pop-up message.  I have added my own debug code after every line of code and nothing executes after the add function is called.</p>\n\n<p>Code is below:</p>\n\n<pre><code>Private Function Difference(r1 As Range, r2 As Range) As Range\n'Purpose: Returns a range containing only the cells which are not shared between the two passed ranges\nApplication.EnableEvents = False\nOn Error Resume Next\n    Dim s As String\n    Dim ws As Worksheet\n    Dim diff As Range, zRng As Range, cRng As Range\n\n    If Not r2 Is Nothing Then\n    On Error GoTo Sheet_Cleanup\n        If Not (r1.Parent Is r2.Parent) Then GoTo Exit_Code\n\n        Set ws = Worksheets.Add\n        For Each a In r1.Areas\n            Set zRng = chkUnion(zRng, ws.Range(a.Address))\n        Next a\n        zRng = 0\n        For Each b In r2.Areas\n            Set cRng = chkUnion(cRng, ws.Range(b.Address))\n        Next b\n        cRng.Clear\n\n        For Each c In ws.UsedRange.SpecialCells(xlCellTypeConstants).Areas\n            Set diff = chkUnion(diff, r1.Parent.Range(c.Address))\n        Next c\nSheet_Cleanup:\n        Application.DisplayAlerts = False\n        ws.Delete\n        Application.DisplayAlerts = True\n    On Error Resume Next\n    Else\n        Set diff = r1\n    End If\n    If Not diff Is Nothing Then Set Difference = diff\nExit_Code:\nApplication.EnableEvents = True\nEnd Function\n</code></pre>\n\n<p>This is not a desirable error state, as it leaves the worksheet in place, which must be deleted by the user.</p>\n\n<p>What is more strange is that running the code again immediately after produces no such error event.</p>\n\n<p>I have managed to reproduce the error on a specific worksheet, but it only occurs on the first instance of clicking the ribbon button and will not reoccur until the Excel session is closed and both the worksheet and ribbon add-in re-opened.</p>\n"}, {"tags": ["sql", "vba", "ms-access"], "comments": [{"owner": {"reputation": 5714, "user_id": 1684486, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/6kb2P.jpg?s=128&g=1", "display_name": "Krish", "link": "https://stackoverflow.com/users/1684486/krish"}, "edited": false, "score": 0, "creation_date": 1517525158, "post_id": 48551935, "comment_id": 84142774, "body": "You don&#39;t need to do .requery when assigning recordsources."}, {"owner": {"reputation": 61, "user_id": 7742386, "user_type": "registered", "accept_rate": 0, "profile_image": "https://graph.facebook.com/10154366091691430/picture?type=large", "display_name": "Lara Hronn", "link": "https://stackoverflow.com/users/7742386/lara-hronn"}, "reply_to_user": {"reputation": 5714, "user_id": 1684486, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/6kb2P.jpg?s=128&g=1", "display_name": "Krish", "link": "https://stackoverflow.com/users/1684486/krish"}, "edited": false, "score": 0, "creation_date": 1517594328, "post_id": 48551935, "comment_id": 84173872, "body": "Why do I not have to do .requery?"}], "answers": [{"tags": [], "owner": {"reputation": 3895, "user_id": 1171702, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/41d229f0cb9239e712ce687707b4c7f7?s=128&d=identicon&r=PG", "display_name": "wazz", "link": "https://stackoverflow.com/users/1171702/wazz"}, "is_accepted": false, "score": 0, "last_activity_date": 1517451997, "last_edit_date": 1517451997, "creation_date": 1517442133, "answer_id": 48553263, "question_id": 48551935, "link": "https://stackoverflow.com/questions/48551935/sql-access-one-search-field-for-many-subforms/48553263#48553263", "title": "SQL Access - one search field for many subforms", "body": "<p>Just repeat what you've already done, but change the names</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Private Sub btnName_Click()\n\n    Dim SQL As String\n\n    SQL = \"SELECT dbo_FSDB.Name, dbo_FSDB.Number, dbo_FSDB.RCS, dbo_FSDB.Flag, dbo_FSDB.Type \" _\n    &amp; \"FROM dbo_FSDB \" _\n    &amp; \"WHERE Name LIKE '*\" &amp; Me.txtName &amp; \"*' \" _\n\n    Me.subInfo.Form.RecordSource = SQL\n    Me.subInfo.Form.Requery\n\n    'now replace dbo_FSDB with dbo_HI in the sql statement\n    'and change the field names where necessary.\n    SQL = \"SELECT dbo_FSDB.Name, dbo_FSDB.Number, dbo_FSDB.RCS, dbo_FSDB.Flag, dbo_FSDB.Type \" _\n    &amp; \"FROM dbo_FSDB \" _\n    &amp; \"WHERE Name LIKE '*\" &amp; Me.txtName &amp; \"*' \" _\n\n    'and replace subInfo with subHI.\n    Me.subInfo.Form.RecordSource = SQL\n    Me.subInfo.Form.Requery\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 61, "user_id": 7742386, "user_type": "registered", "accept_rate": 0, "profile_image": "https://graph.facebook.com/10154366091691430/picture?type=large", "display_name": "Lara Hronn", "link": "https://stackoverflow.com/users/7742386/lara-hronn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 33, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1517451997, "creation_date": 1517434990, "last_edit_date": 1517451629, "question_id": 48551935, "link": "https://stackoverflow.com/questions/48551935/sql-access-one-search-field-for-many-subforms", "title": "SQL Access - one search field for many subforms", "body": "<p>I am a complete and total beginner so good explanations would help me in my studies. </p>\n\n<p>I am building a form that searches a few different unrelated tables (partly related though). I have one form with a few subforms for each table (in this case dbo_FSDB and dbo_HI). I have a few fields where you can write the search criteria. I was hoping to be able to write for example 'Name' in the field and it would return the <code>SELECT</code> info of that name in all the subforms. I managed to make it work for one subform but am struggling to have it so that it searches in all of them.</p>\n\n<p>Here is my code:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Option Compare Database\nOption Explicit\n\nPrivate Sub btnName_Click()\n Dim SQL As String\n\n SQL = \"SELECT dbo_FSDB.Name, dbo_FSDB.Number, dbo_FSDB.RCS, dbo_FSDB.Flag, dbo_FSDB.Type \" _\n    &amp; \"FROM dbo_FSDB \" _\n    &amp; \"WHERE Name LIKE '*\" &amp; Me.txtName &amp; \"*' \" _\n\n Me.subInfo.Form.RecordSource = SQL\n Me.subInfo.Form.Requery\nEnd Sub\n</code></pre>\n\n<p>The name of the subform I have working is 'subInfo' that is pulling the info from dbo_FSDB with the 'txtName' criteria. I would like 'txtName' to search the dbo_HI table with the subHI subform.</p>\n\n<p>Thank you</p>\n"}, {"tags": ["vba", "excel", "connection-string", "adodb"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1517436127, "post_id": 48551874, "comment_id": 84100643, "body": "The schema metadata is <i>never</i> part of the result set. Iterate the <code>Fields</code> collection."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1517436254, "post_id": 48551874, "comment_id": 84100703, "body": "What&#39;s the problem with opening the workbook in read-only mode? The file is locked for editing by another process/user - you <i>can&#39;t</i> acquire a write lock on it. Aren&#39;t you <i>reading</i> from it anyway? Does it still pop a message if you specify <code>Mode=read;</code> in the connection string?"}, {"owner": {"reputation": 348, "user_id": 4526276, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/Ss9YJ.jpg?s=128&g=1", "display_name": "Calico", "link": "https://stackoverflow.com/users/4526276/calico"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1517436792, "post_id": 48551874, "comment_id": 84100935, "body": "@Mat&#39;sMug thanks for the replies. Ah ok, i&#39;m very new to dealing with recordsets &amp; connection strings. Two problems here. If I pause the code after executing this line <code>Conn.Open sconnect</code>, then try to open the source file <code>Data Source.xlsx</code> i get the <code>File is Locked by Another User</code> warning message. This is undesirable as I have many people on the network that need Write access to that source file. Not too concerned about a second instance being opened as <code>Read-only</code> if someone ALREADY has the file locked out as I can close it with VBA after."}, {"owner": {"reputation": 348, "user_id": 4526276, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/Ss9YJ.jpg?s=128&g=1", "display_name": "Calico", "link": "https://stackoverflow.com/users/4526276/calico"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1517436862, "post_id": 48551874, "comment_id": 84100965, "body": "In response to your edit. I tried changing the conn string to <code>sconnect = &quot;Provider=MSDASQL.1;DSN=Excel Files;DBQ=&quot; &amp; DBPath &amp; &quot;;HDR=Yes&#39;;Mode=Read;ReadOnly=True;&quot;</code> but still get the same problem of locking out this file while the query is executed."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1517436915, "post_id": 48551874, "comment_id": 84100994, "body": "That&#39;s normal and very very very desirable behavior on Windows. I thought the problem was that your macro was popping up the read-only warning when the file was already opened by someone else."}, {"owner": {"reputation": 348, "user_id": 4526276, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/Ss9YJ.jpg?s=128&g=1", "display_name": "Calico", "link": "https://stackoverflow.com/users/4526276/calico"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1517438038, "post_id": 48551874, "comment_id": 84101507, "body": "Sorry let me explain the two scenarios a bit better. <b>Scenario 1:</b> Code is run. Nobody on the network has the file open. Code locks file whilst being run. No other users can access file at this time. The source file does not open visually on the screen (this is desirable). Can excel not query a read-only version of the sheet? <b>Scenario 2:</b> Code is run. Someone on the network has the file open. The file is opened in read-only mode in another instance of Excel on my screen (the code runner). Read-Only source file remains open once connection is closed."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1517438165, "post_id": 48551874, "comment_id": 84101563, "body": "<code>Set mrs = Nothing</code> and then <code>Set Conn = Nothing</code> after you close both, that should put the final nail in these objects&#39; coffins. TBH the best solution is to put that data where it belongs: in a database. Even MS-Access would do."}, {"owner": {"reputation": 348, "user_id": 4526276, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/Ss9YJ.jpg?s=128&g=1", "display_name": "Calico", "link": "https://stackoverflow.com/users/4526276/calico"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1517439244, "post_id": 48551874, "comment_id": 84102005, "body": "Thanks always a good idea to free up some memory! That doesnt resolve my two problem cases unfortunately. I would love to use a proper database, however, MS Access is hard to come by at my place of work; hence I&#39;m stuck with excel!"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1517439374, "post_id": 48551874, "comment_id": 84102062, "body": "You literally have a legit business case for setting up a proper database here. Surely someone has an Office license with Access that they&#39;re not using, or there&#39;s a file server somewhere that could run SQL Server Express (free). Excel is not a database, and this is exactly the kinds of problems you run into when you treat it like it&#39;s one."}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user5326167"}, "is_accepted": false, "score": 1, "last_activity_date": 1517447378, "last_edit_date": 1517447378, "creation_date": 1517446610, "answer_id": 48553800, "question_id": 48551874, "link": "https://stackoverflow.com/questions/48551874/adodb-connection-header-text-not-extracted-read-only-issue/48553800#48553800", "title": "ADODB Connection - Header text not extracted &amp; read-only issue", "body": "<p>Try this:</p>\n\n<pre><code>Sub sbADO()\n  Dim sSQLQry As String\n  Dim ReturnArray\n  Dim Conn As New ADODB.Connection\n  Dim mrs As New ADODB.Recordset\n  Dim DBPath As String, sconnect As String,i as integer\n\n  'DBPath = ThisWorkbook.FullName\n  DBPath = \"C:\\USERS\\NAME\\DOCUMENTS\\VBA Work\\Data Source.xlsx\"\n  sconnect= \"Provider=Microsoft.ACE.OLEDB.12.0;Data Source=\"\"\" &amp; _\n     DBPath &amp; \"\"\";Extended Properties=\"\"Excel 12.0 Xml;HDR=YES;IMEX = 1\"\"\"\n\n  Conn.Open sconnect\n\n  sSQLQry = \"SELECT * From [Sheet1$]\"\n  mrs.Open sSQLQry, Conn\n  if rs.recordcount&gt;0 then \n     rs.movefirst\n     for i=0 to rs.fields.count-1\n       'read here the headers and add them to your sheet in row 1\n       Sheet3.Cells(1, i + 1) =rs.Fields(i).Name\n     next\n  end if\n  Sheet3.Range(\"A2\").CopyFromRecordset mrs\n  mrs.Close\n  Conn.Close\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 348, "user_id": 4526276, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/Ss9YJ.jpg?s=128&g=1", "display_name": "Calico", "link": "https://stackoverflow.com/users/4526276/calico"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 692, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1517447378, "creation_date": 1517434729, "last_edit_date": 1517436059, "question_id": 48551874, "link": "https://stackoverflow.com/questions/48551874/adodb-connection-header-text-not-extracted-read-only-issue", "title": "ADODB Connection - Header text not extracted &amp; read-only issue", "body": "<p>I am delving into the world of VBA data connections, and would appreciate some assistance. The code below is what I have so far, but there are a couple of oddities I can't figure out. </p>\n\n<pre><code>Sub sbADO()\n    Dim sSQLQry As String\n    Dim ReturnArray\n    Dim Conn As New ADODB.Connection\n    Dim mrs As New ADODB.Recordset\n    Dim DBPath As String, sconnect As String\n\n    DBPath = \"C:\\USERS\\NAME\\DOCUMENTS\\VBA Work\\Data Source.xlsx\"\n    sconnect = \"Provider=MSDASQL.1;DSN=Excel Files;DBQ=\" &amp; DBPath &amp; \";HDR=Yes';\"\n    Conn.Open sconnect\n\n    sSQLQry = \"SELECT * From [Sheet1$]\"\n    mrs.Open sSQLQry, Conn\n    Sheet3.Range(\"A1\").CopyFromRecordset mrs\n    mrs.Close\n    Conn.Close\nEnd Sub\n</code></pre>\n\n<p>This code works, however:</p>\n\n<ol>\n<li>The data pulled in doesn't include Row1 of the dataset (so the headers aren't pulled in)</li>\n<li>If the source workbook 'Data Source.xlsx' is open. The code will cause the workbook to open again but in read-only mode. Can this be avoided?</li>\n<li>Can the connection string be edited so that the source file is never locked out? ie. queried in Read-Only mode other users can open it whilst the query is being completed?</li>\n</ol>\n\n<p>Any help is appreciated\nThanks\nCaleeco</p>\n"}, {"tags": ["vba", "excel", "ie-automation"], "comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 1, "creation_date": 1517434630, "post_id": 48551800, "comment_id": 84099922, "body": "why use <code>j</code> at all? why not just <code>43 + i</code>?"}, {"owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1517434865, "post_id": 48551800, "comment_id": 84100030, "body": "@ScottHoltzman You didn&#39;t know the more mathematical equations your processor has to complete the more efficient it is?"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "reply_to_user": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "edited": false, "score": 0, "creation_date": 1517435068, "post_id": 48551800, "comment_id": 84100138, "body": "@K.D\u1d00\u1d20\u026as - I think I slept through that lecture."}, {"owner": {"reputation": 111, "user_id": 8693026, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/12655b2c145e502abaa3b277ca58c04a?s=128&d=identicon&r=PG&f=1", "display_name": "Guilherme", "link": "https://stackoverflow.com/users/8693026/guilherme"}, "reply_to_user": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "edited": false, "score": 0, "creation_date": 1517439666, "post_id": 48551800, "comment_id": 84102171, "body": "@K.D\u1d00\u1d20\u026as same output. nothing changed"}, {"owner": {"reputation": 111, "user_id": 8693026, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/12655b2c145e502abaa3b277ca58c04a?s=128&d=identicon&r=PG&f=1", "display_name": "Guilherme", "link": "https://stackoverflow.com/users/8693026/guilherme"}, "reply_to_user": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "edited": false, "score": 0, "creation_date": 1517439790, "post_id": 48551800, "comment_id": 84102211, "body": "@K.D\u1d00\u1d20\u026as sorry, i wrote it wrong. i did j = j + 1"}, {"owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "edited": false, "score": 0, "creation_date": 1517440295, "post_id": 48551800, "comment_id": 84102392, "body": "That wasn&#39;t me who provided you with a suggestion... But I will give you a possible solution in a moment."}], "answers": [{"comments": [{"owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "reply_to_user": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "edited": false, "score": 0, "creation_date": 1517448674, "post_id": 48553004, "comment_id": 84104465, "body": "@RyanWildry Updated answer"}, {"owner": {"reputation": 111, "user_id": 8693026, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/12655b2c145e502abaa3b277ca58c04a?s=128&d=identicon&r=PG&f=1", "display_name": "Guilherme", "link": "https://stackoverflow.com/users/8693026/guilherme"}, "edited": false, "score": 0, "creation_date": 1517488749, "post_id": 48553004, "comment_id": 84121571, "body": "@K.Davis it didn&#39;t work. I think the problem is in the lenght of my cells. My range have cells with 200+ caracters. When i changed the cells to 10 caracters at most, it worked just fine.  Can&#39;t figure it out why. I&#39;m running out of options"}, {"owner": {"reputation": 111, "user_id": 8693026, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/12655b2c145e502abaa3b277ca58c04a?s=128&d=identicon&r=PG&f=1", "display_name": "Guilherme", "link": "https://stackoverflow.com/users/8693026/guilherme"}, "edited": false, "score": 0, "creation_date": 1517489270, "post_id": 48553004, "comment_id": 84121904, "body": "@K.Davis Thankkk you so much!!! It did work. I was trying with a different code.   Using &quot;For Each o&quot; instead of &quot;For i = 0 To objCollection.Lenght&quot; doesn&#39;t let the program get lost. Dunno why, but it worked. I&#39;ll update the post with the answer"}, {"owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "reply_to_user": {"reputation": 111, "user_id": 8693026, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/12655b2c145e502abaa3b277ca58c04a?s=128&d=identicon&r=PG&f=1", "display_name": "Guilherme", "link": "https://stackoverflow.com/users/8693026/guilherme"}, "edited": false, "score": 0, "creation_date": 1517496258, "post_id": 48553004, "comment_id": 84126692, "body": "@Guilherme There&#39;s no need to update your question with the answer. Simply mark this one as accepted."}], "tags": [], "owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "is_accepted": false, "score": 1, "last_activity_date": 1517448652, "last_edit_date": 1517448652, "creation_date": 1517440545, "answer_id": 48553004, "question_id": 48551800, "link": "https://stackoverflow.com/questions/48551800/ie-automation-issue/48553004#48553004", "title": "IE Automation Issue", "body": "<p>Instead of using your <code>For i = ...</code> statement, see if a <code>For Each</code> statement would do what you need by iterating through the collection itself.</p>\n\n<pre><code>Dim IE As Object, i as Long\nDim objCollection As Object, o As Object  '  &lt;--- New declaration\n\nSet IE = CreateObject(\"InternetExplorer.Application\")\n\nIE.Visible = True\n\nIE.navigate \"https://mylink.com\"\n\nDo While IE.Busy: DoEvents: Loop\nDo While IE.readyState &lt;&gt; 4: DoEvents: Loop\n\nSet objCollection = IE.document.getElementsByTagName(\"input\")\n\nFor Each o In objCollection\n    i = i + 1\n    o.innerText = \"Test \" &amp; i\nNext o\n\nSet IE = Nothing\nSet objElement = Nothing\nSet objCollection = Nothing\n</code></pre>\n"}], "owner": {"reputation": 111, "user_id": 8693026, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/12655b2c145e502abaa3b277ca58c04a?s=128&d=identicon&r=PG&f=1", "display_name": "Guilherme", "link": "https://stackoverflow.com/users/8693026/guilherme"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 96, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1517496368, "creation_date": 1517434385, "last_edit_date": 1517496368, "question_id": 48551800, "link": "https://stackoverflow.com/questions/48551800/ie-automation-issue", "title": "IE Automation Issue", "body": "<p>I have a code to navigate to a website and fill up a form with 33 inputs.</p>\n\n<p>This is the code:</p>\n\n<pre><code>Dim i As Long\nDim IE As Object\nDim objCollection As Object\n\nSet IE = CreateObject(\"InternetExplorer.Application\")\n\nIE.Visible = True\n\nIE.Navigate \"https://mylink.com\"\n\nDo While IE.Busy: DoEvents: Loop\nDo While IE.ReadyState &lt;&gt; 4: DoEvents: Loop\n\nSet objCollection = IE.Document.getElementsByTagName(\"input\")\n\nFor i = 0 To objCollection.Length\nobjCollection(i).innertext = \"Test \" &amp; i\nNext i\n\nSet IE = Nothing\nSet objElement = Nothing\nSet objCollection = Nothing\n</code></pre>\n\n<p>Now, this works like a charm. Not a single error.</p>\n\n<blockquote>\n  <p>The input 1 receives \"Test 1\"; The input 2 receives \"Test 2\"; ... ;\n  The input 33 receives \"Test 33\";</p>\n</blockquote>\n\n<p>But, the actual data that i need to pass is in my worksheet in the range AI43:AI75</p>\n\n<p>If i change this part</p>\n\n<pre><code> For i = 0 To objCollection.Length\nobjCollection(i).innertext = \"Test \" &amp; i\nNext i\n</code></pre>\n\n<p>To this</p>\n\n<pre><code>j = 1\nFor i = 0 To objCollection.Length\nobjCollection(i).innertext = Range(\"AI\" &amp; 42 + j).Text\nj = j + 1\nNext i\n</code></pre>\n\n<p>The output, each time is different, and always wrong. The order of the inputs go crazy and some inputs stay blank.</p>\n\n<blockquote>\n  <p>Example: input 1 receives \"data 1\", input 2 receives \"data 2\", input 3\n  receives \"data 30\", input 4 receives nothing, input 5 receives \"data\n  10\".</p>\n</blockquote>\n\n<p>And eachtime i run it, the output is different. Any ideas why? Can't figure it out.</p>\n"}, {"tags": ["vba", "excel", "copy-paste", "named-ranges"], "comments": [{"owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "edited": false, "score": 0, "creation_date": 1517434075, "post_id": 48551634, "comment_id": 84099626, "body": "You know this has been asked a couple hundred times this week alone. Did you even attempt to search for your answer? <a href=\"https://stackoverflow.com/questions/38024967/excel-vba-copy-range-from-one-sheet-to-another-next-empty-row?s=1|179.2438\" title=\"excel vba copy range from one sheet to another next empty row\">stackoverflow.com/questions/38024967/&hellip;</a> / <a href=\"https://stackoverflow.com/questions/46771730/vba-copy-variable-range-from-one-sheet-to-another?s=2|160.6739\" title=\"vba copy variable range from one sheet to another\">stackoverflow.com/questions/46771730/&hellip;</a> / <a href=\"https://stackoverflow.com/questions/21862851/copy-range-from-one-sheet-paste-part-of-range-in-same-sheet-based-on-cell-value?s=4|127.1215\" title=\"copy range from one sheet paste part of range in same sheet based on cell value\">stackoverflow.com/questions/21862851/&hellip;</a>"}, {"owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "edited": false, "score": 0, "creation_date": 1517434359, "post_id": 48551634, "comment_id": 84099772, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/28730624/vba-excel-copy-range\">VBA EXCEL copy range</a>"}, {"owner": {"reputation": 998, "user_id": 826642, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0cf18b848932b551cfaeb78ce151dc03?s=128&d=identicon&r=PG", "display_name": "Gros Lalo", "link": "https://stackoverflow.com/users/826642/gros-lalo"}, "edited": false, "score": 0, "creation_date": 1517434417, "post_id": 48551634, "comment_id": 84099805, "body": "Consider adding more tags to you question, this should help refresh the list of already answered questions similar to what you are after."}], "answers": [{"tags": [], "owner": {"reputation": 1300, "user_id": 3005534, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/giBVn.jpg?s=128&g=1", "display_name": "Miguel_Ryu", "link": "https://stackoverflow.com/users/3005534/miguel-ryu"}, "is_accepted": true, "score": 1, "last_activity_date": 1517480734, "creation_date": 1517480734, "answer_id": 48560444, "question_id": 48551634, "link": "https://stackoverflow.com/questions/48551634/copy-a-range-from-sheet1-to-sheet2/48560444#48560444", "title": "Copy a range from sheet1 to sheet2", "body": "<p>To do 3 and 4 you can use the code below:</p>\n\n<pre><code>With Ark1\n    'insert new row in sheet one\n    .Row(\"24\").Insert Shift:=xlDown\n    'fill range A24:C24 with values\n    .Range(\"A24:C24\").Value = Array(\"Your\", \"Values\", \"Here\")\n    ' Or if specific cell values (.cells(row, column).value) Array(.cells(1,1).value, .cells(1,2).value, .cells(1,3).value)\nEnd With\n\nWith Ark2\n    'copy row to retain formulas\n    .Row(23).Copy\n    'insert new row in sheet two\n    .Row(24).Insert Shift:=xlDown\n    'get values from sheet one to sheet 2\n    .Range(\"A24:C24\").Value = Ark1.Range(\"A24:C24\").Value\nEnd With\n</code></pre>\n\n<p>P.S.: As K.D\u1d00\u1d20\u026as mentions in his comments there is a lot of documentation to help you out with issues such as these. K.D\u1d00\u1d20\u026as provided links:</p>\n\n<ul>\n<li><a href=\"https://stackoverflow.com/questions/28730624/vba-excel-copy-range\">VBA EXCEL copy range</a><br></li>\n<li><a href=\"https://stackoverflow.com/questions/21862851/copy-range-from-one-sheet-paste-part-of-range-in-same-sheet-based-on-cell-value\">Copy Range From One Sheet Paste Part of Range In Same Sheet Based On Cell Value On Another Sheet</a></li>\n<li><a href=\"https://stackoverflow.com/questions/46771730/vba-copy-variable-range-from-one-sheet-to-another\">VBA - Copy variable range from one sheet to another</a></li>\n<li><a href=\"https://stackoverflow.com/questions/38024967/excel-vba-copy-range-from-one-sheet-to-another-next-empty-row\">Excel VBA - Copy range from one sheet to another, next empty row</a></li>\n</ul>\n"}], "owner": {"reputation": 3, "user_id": 9296729, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156194818254662/picture?type=large", "display_name": "Henrik Hult&#233;n-Karlsh&#248;j", "link": "https://stackoverflow.com/users/9296729/henrik-hult%c3%a9n-karlsh%c3%b8j"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 407, "favorite_count": 0, "accepted_answer_id": 48560444, "answer_count": 1, "score": 0, "last_activity_date": 1517480734, "creation_date": 1517433653, "last_edit_date": 1517462048, "question_id": 48551634, "link": "https://stackoverflow.com/questions/48551634/copy-a-range-from-sheet1-to-sheet2", "title": "Copy a range from sheet1 to sheet2", "body": "<p>I'm pretty new to VBA, but I hope someone can help me. Here is what I would like to do;</p>\n\n<ol>\n<li>I have a range (\"A4:C500\") in Sheet1 that has some empty cells from eg. row 180</li>\n<li>I would like to copy that entire range to Sheet2</li>\n<li>Afterwards, if I insert a new row in Sheet 1 in eg. \"A24:C24\" and I fill eg \"A24:C24\" with values, I want to first insert an entire new row in \"A24\" in Sheet2 (same row as the new row in Sheet1) and move all existing cells 1 row down in Sheet2. The new row in Sheet2 should copy formulas from the row above (eg. row 24 should copy formulas from row 23)</li>\n<li>After the new row has been inserted in Sheet2, I would then like to copy values from Sheet1 \"A24:C24\" to Sheet2 \"A24:C24\"</li>\n</ol>\n\n<p>Regarding 2. I have tried using some code like;</p>\n\n<pre><code>Sub Copy()\n    Ark1.Range(\"A4:C500\").Copy\n    Ark2.Range(\"A4\").Rows(\"1:1\").Insert Shift:=xlDown\nEnd Sub\n</code></pre>\n\n<p>and that basically takes care of 2.</p>\n\n<p>How can I get 3. and 4. to work? Any ideas for me to try out?</p>\n\n<p>Thanks in advance</p>\n"}, {"tags": ["arrays", "vba", "excel", "ms-word"], "comments": [{"owner": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "edited": false, "score": 0, "creation_date": 1517443584, "post_id": 48551624, "comment_id": 84103325, "body": "The <code>Value</code> in a Dictionary can be anything, even a 2-D array. So, I think your choice is basically between Dictionary and Collection. Read more here: <a href=\"http://analystcave.com/excel-vba-dictionary-arrays-and-other-data-structures/\" rel=\"nofollow noreferrer\">analystcave.com/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 179, "user_id": 9013218, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/1weSs.png?s=128&g=1", "display_name": "V. V. Kozlov", "link": "https://stackoverflow.com/users/9013218/v-v-kozlov"}, "is_accepted": false, "score": 0, "last_activity_date": 1517577028, "last_edit_date": 1517577028, "creation_date": 1517559213, "answer_id": 48578404, "question_id": 48551624, "link": "https://stackoverflow.com/questions/48551624/storing-a-set-of-10-2d-arrays-for-x-people/48578404#48578404", "title": "Storing a set of 10 2D arrays for X people", "body": "<p>Personally, I find VBA's array implementation inflexible and limiting.  However, I imagine you can start with using an ordinary <code>String</code> instead of an array, thus reducing the problem to 10 Strings for X people, or a one-dimensional array.</p>\n\n<p>If it were me, I would start with something like</p>\n\n<pre><code>Dim Application_Person_Names() as String\nReDim Application_Person_Names(10)\n</code></pre>\n\n<p>Initialise all Strings to a value which <strong><em>never</em></strong> appears in the values you're collecting.  I picked <code>vbCr</code>.</p>\n\n<pre><code>Dim i as Integer\n...\nFor i = 0 to Ubound(Application_Person_Names)\n   Application_Person_Names(i) = vbCr\nnext i\n</code></pre>\n\n<p>Then as you work through your documents,</p>\n\n<pre><code>Application_Person_Names(j) = Application_Person_Names(j) = Next_Name &amp; vbcr\n</code></pre>\n\n<p>where <code>j</code> is the relevant group.</p>\n\n<p>If you need to remove duplicates as you go along, you could do</p>\n\n<pre><code>If 0 = InStr(Application_Person_Names(j), vbCr &amp; Next_Name &amp; vbCr) then\n   Application_Person_Names(j) = Application_Person_Names(j) = Next_Name &amp; vbcr\nEnd If\n</code></pre>\n\n<p>Once done, you are left with 10 strings containing zero or more names.  Provided the names are relatively small, the performance of the repeated concatenation <code>Application_Person_Names(j) = Application_Person_Names(j) &amp; Next_Name &amp; vbcr</code> should be good enough.</p>\n\n<p>You can clean up a bit by removing the leading <code>vbCr</code> from each string</p>\n\n<pre><code>For i = 0 to Ubound(Application_Person_Names)\n   Application_Person_Names(i) = Mid(Application_Person_Names(i), 2, Len(Application_Person_Names(i)) - 1)\nnext i\n</code></pre>\n\n<p>And then, if you really want, you can turn these into a real array using the VBA <code>Split</code> function.</p>\n\n<pre><code>Dim a() as String\n...\na = Split(Application_Person_Names(...), vbCr)\n</code></pre>\n\n<p>One unfortunate feature of VBA arrays is that you cannot have an array of zero elements, thus the Split may fail if the string is empty.  However, having empty strings is fine.</p>\n\n<p>Later, once you have something working, you want to try other features like a String Builder (faster concatenation) or Collections.</p>\n\n<p>I hope this helps.</p>\n"}], "owner": {"reputation": 21, "user_id": 9201539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a16a4fa1cdc4c54efe981df62803cc39?s=128&d=identicon&r=PG&f=1", "display_name": "loael", "link": "https://stackoverflow.com/users/9201539/loael"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 43, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1517577028, "creation_date": 1517433612, "last_edit_date": 1531164843, "question_id": 48551624, "link": "https://stackoverflow.com/questions/48551624/storing-a-set-of-10-2d-arrays-for-x-people", "title": "Storing a set of 10 2D arrays for X people", "body": "<p>Basically, I have a scraping function in VBA that scrapes information from ~ 10 different tables on different pages and stores them in 10 2D arrays.</p>\n\n<p>I need to repeat this process for X number of people linked to an application, meaning I need 10 sets of 2D arrays for an unknown amount of people depending on the application.</p>\n\n<p>What is the best way to approach designing this system. There cannot be more than 20 people linked to an application, but do I really need to globally create 200 empty arrays to store the information for a maximum case?</p>\n\n<p>Also, how would I indicate in my scrape function to store a particular set of 10 2D arrays for a specific person, if my 2D array naming convention is as follows:</p>\n\n<pre><code>Application_Person1_Name()\nApplication_Person2_Name()\nApplication_Person3_Name()\n</code></pre>\n\n<p>If I use a for loop to iterate through each linked person and pass a string parameter such as \"Person\" + i in my scrape function, I cannot append it to the base array name of \"Application_\" because VBA does not support concatenation to refer to a variable name.</p>\n\n<p>I'm quite stumped and was looking for some help with this. Anything is appreciated.</p>\n"}, {"tags": ["vba", "outlook", "outlook-2016"], "comments": [{"owner": {"reputation": 21, "user_id": 9115334, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/20d3b5957fa6e1241856513b66be5c86?s=128&d=identicon&r=PG&f=1", "display_name": "JimG", "link": "https://stackoverflow.com/users/9115334/jimg"}, "edited": false, "score": 0, "creation_date": 1517432517, "post_id": 48551325, "comment_id": 84098834, "body": "The code is supposed to be laid out as code, but as usual, that feature didn&#39;t work."}, {"owner": {"reputation": 21, "user_id": 9115334, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/20d3b5957fa6e1241856513b66be5c86?s=128&d=identicon&r=PG&f=1", "display_name": "JimG", "link": "https://stackoverflow.com/users/9115334/jimg"}, "edited": false, "score": 0, "creation_date": 1517434598, "post_id": 48551325, "comment_id": 84099903, "body": "So, Mat, how did you fix that? (Or, more importantly, how can I make it work when I create a post? I highlighted all the code and clicked the button with curly braces, but all it did was indent it. Same thing with ctrl-k."}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 9115334, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/20d3b5957fa6e1241856513b66be5c86?s=128&d=identicon&r=PG&f=1", "display_name": "JimG", "link": "https://stackoverflow.com/users/9115334/jimg"}, "edited": false, "score": 0, "creation_date": 1517434468, "post_id": 48551515, "comment_id": 84099829, "body": "Yeah, but that just move the mail. I want to create a rule for items sent to a person."}, {"owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "reply_to_user": {"reputation": 21, "user_id": 9115334, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/20d3b5957fa6e1241856513b66be5c86?s=128&d=identicon&r=PG&f=1", "display_name": "JimG", "link": "https://stackoverflow.com/users/9115334/jimg"}, "edited": false, "score": 0, "creation_date": 1517435246, "post_id": 48551515, "comment_id": 84100220, "body": "No, setting that properly will move the message <i>after</i> it is sent."}, {"owner": {"reputation": 21, "user_id": 9115334, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/20d3b5957fa6e1241856513b66be5c86?s=128&d=identicon&r=PG&f=1", "display_name": "JimG", "link": "https://stackoverflow.com/users/9115334/jimg"}, "edited": false, "score": 0, "creation_date": 1517435396, "post_id": 48551515, "comment_id": 84100292, "body": "OK, I see that now."}, {"owner": {"reputation": 21, "user_id": 9115334, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/20d3b5957fa6e1241856513b66be5c86?s=128&d=identicon&r=PG&f=1", "display_name": "JimG", "link": "https://stackoverflow.com/users/9115334/jimg"}, "edited": false, "score": 0, "creation_date": 1517435538, "post_id": 48551515, "comment_id": 84100356, "body": "However, I really want to use a rule. I work in a help desk, and when I get a ticket, I create a folder for the person&#39;s emails back-and-forth to me. With this solution, I would have to change the code when a ticket is opened and again when closed. What I want to do is create two rules (one for receiving, one for sending) upon first send or receive to a customer, and then delete them both once the ticket is resolved."}, {"owner": {"reputation": 21, "user_id": 9115334, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/20d3b5957fa6e1241856513b66be5c86?s=128&d=identicon&r=PG&f=1", "display_name": "JimG", "link": "https://stackoverflow.com/users/9115334/jimg"}, "edited": false, "score": 0, "creation_date": 1517435651, "post_id": 48551515, "comment_id": 84100410, "body": "Oh, and I already have the rule-creation macro working for items I receive from my customers."}, {"owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "reply_to_user": {"reputation": 21, "user_id": 9115334, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/20d3b5957fa6e1241856513b66be5c86?s=128&d=identicon&r=PG&f=1", "display_name": "JimG", "link": "https://stackoverflow.com/users/9115334/jimg"}, "edited": false, "score": 0, "creation_date": 1517439158, "post_id": 48551515, "comment_id": 84101957, "body": "I don&#39;t think you can - a send rule only lets you copy to a specified folder. Is writing a short VBA macro an option?"}, {"owner": {"reputation": 21, "user_id": 9115334, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/20d3b5957fa6e1241856513b66be5c86?s=128&d=identicon&r=PG&f=1", "display_name": "JimG", "link": "https://stackoverflow.com/users/9115334/jimg"}, "edited": false, "score": 0, "creation_date": 1517508910, "post_id": 48551515, "comment_id": 84134678, "body": "It could be an option, but it leaves me having to rewrite the code every time I add or remove a customer&#39;s address."}, {"owner": {"reputation": 21, "user_id": 9115334, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/20d3b5957fa6e1241856513b66be5c86?s=128&d=identicon&r=PG&f=1", "display_name": "JimG", "link": "https://stackoverflow.com/users/9115334/jimg"}, "edited": false, "score": 0, "creation_date": 1517509003, "post_id": 48551515, "comment_id": 84134725, "body": "However, I&#39;m going to mark this as the answer, because I only need the &quot;send&quot; rule one time: when I first open the conversation. However, I can&#39;t create the rule before that, because I don&#39;t know the customer&#39;s address. Thus, I don&#39;t need to make a send rule after all."}], "tags": [], "owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "is_accepted": true, "score": 1, "last_activity_date": 1517433101, "creation_date": 1517433101, "answer_id": 48551515, "question_id": 48551325, "link": "https://stackoverflow.com/questions/48551325/how-can-i-use-vba-to-create-a-rule-to-move-sent-items-to-folder/48551515#48551515", "title": "How can I use vba to create a rule to move sent items to folder?", "body": "<p>You can intercept the <code>Application.ItemSend</code> event, check if the recipients are right, then set the <code>MailItem.SaveSentMessageFolder</code> property to the right folder. </p>\n"}, {"tags": [], "owner": {"reputation": 1041, "user_id": 903186, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/cdb804ba983895662392c911f16fd566?s=128&d=identicon&r=PG", "display_name": "Ruut", "link": "https://stackoverflow.com/users/903186/ruut"}, "is_accepted": false, "score": 0, "last_activity_date": 1552466287, "creation_date": 1552466287, "answer_id": 55137483, "question_id": 48551325, "link": "https://stackoverflow.com/questions/48551325/how-can-i-use-vba-to-create-a-rule-to-move-sent-items-to-folder/55137483#55137483", "title": "How can I use vba to create a rule to move sent items to folder?", "body": "<p>This should work</p>\n\n<pre><code>Set colRules = Application.Session.DefaultStore.GetRules()\nSet objRuleSend = colRules.Create(RuleName &amp; \"Send\", olRuleSend)\n\nSet objToCondition = objRuleSend.Conditions.SentTo\nWith objToCondition\n  .Enabled = True\n  .Recipients.Add Address ' &lt;-- this is the line that is fixed.\n  .Recipients.ResolveAll\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 9115334, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/20d3b5957fa6e1241856513b66be5c86?s=128&d=identicon&r=PG&f=1", "display_name": "JimG", "link": "https://stackoverflow.com/users/9115334/jimg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 444, "favorite_count": 0, "accepted_answer_id": 48551515, "answer_count": 2, "score": 1, "last_activity_date": 1592984452, "creation_date": 1517432396, "last_edit_date": 1592984452, "question_id": 48551325, "link": "https://stackoverflow.com/questions/48551325/how-can-i-use-vba-to-create-a-rule-to-move-sent-items-to-folder", "title": "How can I use vba to create a rule to move sent items to folder?", "body": "<p>In Outlook (2016 or 365), I would like to use VBA to create a rule that moves items I send to a specific person.</p>\n\n<p>I've got most of the code done (lifted from a Microsoft code sample), but I can't figure out what the condition fields should get. I know it isn't right (there's no such thing as \".sender\" in that type of object), but I don't know what I SHOULD put there. There are only seven properties on a ToOrFromRuleCondition (Application, Class, ConditionType, Enabled, Parent, Recipients, and Session), and none of them deal with the sender.</p>\n\n<p>In the code below:</p>\n\n<ul>\n<li>colRules, objRuleSend are Outlook.Rules objects</li>\n<li>objToCondition is an Outlook.ToOrFromRuleCondition</li>\n<li>RuleName is a string with only letters in it</li>\n<li>Address is a string variable with a name.name@company.com format.</li>\n</ul>\n\n\n\n<pre><code>Set colRules = Application.Session.DefaultStore.GetRules()\nSet objRuleSend = colRules.Create(RuleName &amp; \"Send\", olRuleSend)\n\nSet objToCondition = objRuleSend.Conditions.SentTo\nWith objToCondition\n  .Enabled = True\n  .Sender = Address ' &lt;-- this is the line that fails.\n  .Recipients.ResolveAll\nEnd With\n</code></pre>\n"}, {"tags": ["vba", "variables", "offset"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 9296681, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d68fa992019811e4fe1288f9e3ecb5ed?s=128&d=identicon&r=PG&f=1", "display_name": "LauraKihlman", "link": "https://stackoverflow.com/users/9296681/laurakihlman"}, "edited": false, "score": 0, "creation_date": 1517493502, "post_id": 48552552, "comment_id": 84124747, "body": "Thanks @r_student, that took care of the error I was getting. Now I&#39;m realizing the cell references must be flawed somehow because the average I&#39;m getting for this range aren&#39;t what I anticipated. What I&#39;m trying to do is create a cell reference that is offset by 7 columns within the same row based on a variable starting row, hence the definition of Y in the code. What am I missing?"}, {"owner": {"reputation": 3, "user_id": 9296681, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d68fa992019811e4fe1288f9e3ecb5ed?s=128&d=identicon&r=PG&f=1", "display_name": "LauraKihlman", "link": "https://stackoverflow.com/users/9296681/laurakihlman"}, "edited": false, "score": 0, "creation_date": 1517495051, "post_id": 48552552, "comment_id": 84125818, "body": "I realize what it is now, but I don&#39;t know how to fix it. I need to be able to describe two discrete cells for which to calculate an average from (in this case &quot;H8&quot; and 7 columns to the left of Y) and everything I&#39;ve written is including all of the cells between them."}, {"owner": {"reputation": 848, "user_id": 9221684, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gcnG9.jpg?s=128&g=1", "display_name": "warner_sc", "link": "https://stackoverflow.com/users/9221684/warner-sc"}, "reply_to_user": {"reputation": 3, "user_id": 9296681, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d68fa992019811e4fe1288f9e3ecb5ed?s=128&d=identicon&r=PG&f=1", "display_name": "LauraKihlman", "link": "https://stackoverflow.com/users/9296681/laurakihlman"}, "edited": false, "score": 0, "creation_date": 1517498975, "post_id": 48552552, "comment_id": 84128596, "body": "Can you give me an example of a range to get the average? as you said <b>H8 and 7 columns to the left</b> equals <code>Range(&quot;H8:A8&quot;)</code> right?"}, {"owner": {"reputation": 3, "user_id": 9296681, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d68fa992019811e4fe1288f9e3ecb5ed?s=128&d=identicon&r=PG&f=1", "display_name": "LauraKihlman", "link": "https://stackoverflow.com/users/9296681/laurakihlman"}, "edited": false, "score": 0, "creation_date": 1517500576, "post_id": 48552552, "comment_id": 84129708, "body": "I need to be able to average the contents of H8 and the last cell in column H (using xlDown). Just those two cells without the contents of the cells from H9-Hn. Using &quot;    Set copyFromRange = sourceSheet.Range(H8:Y)&quot; results in a syntax error"}, {"owner": {"reputation": 848, "user_id": 9221684, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gcnG9.jpg?s=128&g=1", "display_name": "warner_sc", "link": "https://stackoverflow.com/users/9221684/warner-sc"}, "reply_to_user": {"reputation": 3, "user_id": 9296681, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d68fa992019811e4fe1288f9e3ecb5ed?s=128&d=identicon&r=PG&f=1", "display_name": "LauraKihlman", "link": "https://stackoverflow.com/users/9296681/laurakihlman"}, "edited": false, "score": 0, "creation_date": 1517501564, "post_id": 48552552, "comment_id": 84130366, "body": "Check the Address of <code>Y</code> to see if the <b>Range</b> you&#39;re trying to <code>set</code> as <code>copyFromRange</code> is a valid <b>Range</b>, maybe you should try using <code>cells(rows,columns)</code> method, if you want to average the contents of H8 and last cell in column H this would be the syntax: <code>Range(&quot;H8&quot;, Range(&quot;H8&quot;).End(xlDown))</code>"}, {"owner": {"reputation": 3, "user_id": 9296681, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d68fa992019811e4fe1288f9e3ecb5ed?s=128&d=identicon&r=PG&f=1", "display_name": "LauraKihlman", "link": "https://stackoverflow.com/users/9296681/laurakihlman"}, "edited": false, "score": 0, "creation_date": 1517507360, "post_id": 48552552, "comment_id": 84133919, "body": "When I use this &quot; Set copyFromRange = sourceSheet.Range((&quot;H8&quot;), (Range(&quot;H8&quot;).End(xlDown)))&quot; I get an object defined error"}, {"owner": {"reputation": 848, "user_id": 9221684, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gcnG9.jpg?s=128&g=1", "display_name": "warner_sc", "link": "https://stackoverflow.com/users/9221684/warner-sc"}, "reply_to_user": {"reputation": 3, "user_id": 9296681, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d68fa992019811e4fe1288f9e3ecb5ed?s=128&d=identicon&r=PG&f=1", "display_name": "LauraKihlman", "link": "https://stackoverflow.com/users/9296681/laurakihlman"}, "edited": false, "score": 0, "creation_date": 1517509298, "post_id": 48552552, "comment_id": 84134898, "body": "Wrong syntax! Use this code: <code>Set copyFromRange = sourceSheet.Range(&quot;H8&quot;, Range(&quot;H8&quot;).End(xlDown))</code>"}], "tags": [], "owner": {"reputation": 848, "user_id": 9221684, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gcnG9.jpg?s=128&g=1", "display_name": "warner_sc", "link": "https://stackoverflow.com/users/9221684/warner-sc"}, "is_accepted": false, "score": 0, "last_activity_date": 1517437984, "creation_date": 1517437984, "answer_id": 48552552, "question_id": 48551236, "link": "https://stackoverflow.com/questions/48551236/defined-variable-as-a-reference-in-an-offset-range/48552552#48552552", "title": "Defined Variable as a reference in an Offset Range", "body": "<p>Incorrect syntax!</p>\n\n<p>Try this:</p>\n\n<pre><code>copyToRange.Value = Application.WorksheetFunction.Average(copyFromRange)\n</code></pre>\n\n<p>Why?, because you are telling Excel \"copyToRange\" is a RANGE already:</p>\n\n<pre><code>Dim copyFromRange, copyToRange As Range\n</code></pre>\n\n<p>Hope this help you.</p>\n"}], "owner": {"reputation": 3, "user_id": 9296681, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d68fa992019811e4fe1288f9e3ecb5ed?s=128&d=identicon&r=PG&f=1", "display_name": "LauraKihlman", "link": "https://stackoverflow.com/users/9296681/laurakihlman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 140, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1517437984, "creation_date": 1517432032, "last_edit_date": 1517432217, "question_id": 48551236, "link": "https://stackoverflow.com/questions/48551236/defined-variable-as-a-reference-in-an-offset-range", "title": "Defined Variable as a reference in an Offset Range", "body": "<p>I have run into trouble writing a code in VBA that will allow me to describe a range of non-consecutive cells when one of those cells is a variable. When I run this line of code I get an error at the line beginning with <code>Range(copyToRange) = Application.WorksheetFunction.Average(copyFromRange)</code>. Sorry if this is a simple fix, I've been banging my head against a wall all day:</p>\n\n<pre><code>Sub GetPCData()\n\n'Get PC response ratios\n\nPCanalytes = Array(\"Furosemide\", \"Caffeine\", \"Ketoprofen\", \"Phenylbutazone\", \"Flunixin\")\nPCanalytePositions = Array(\"J32\", \"J33\", \"J34\", \"J35\", \"J36\")\n\nSet SQWorkbook = Application.ActiveWorkbook\n\nDim sourceSheet, targetSheet As Worksheet\nDim copyFromRange, copyToRange As Range\nDim Y As Range\n\nSet targetSheet = ThisWorkbook.Sheets(\"QC data\")\n\nFor i = 0 To SQWorkbook.Worksheets.Count\n    Set sourceSheet = SQWorkbook.Worksheets(PCanalytes(i))\n    Set Y = sourceSheet.Range(\"A7\").End(xlDown)\n    Set copyToRange = targetSheet.Range(PCanalytePositions(i))\n    Set copyFromRange = sourceSheet.Range((\"H8\"), Y.Offset(0, 7))\n    Range(copyToRange) = Application.WorksheetFunction.Average(copyFromRange)\nNext i\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 69, "user_id": 3438908, "user_type": "registered", "accept_rate": 60, "profile_image": "https://graph.facebook.com/100003399662910/picture?type=large", "display_name": "user3438908", "link": "https://stackoverflow.com/users/3438908/user3438908"}, "edited": false, "score": 0, "creation_date": 1517432080, "post_id": 48551151, "comment_id": 84098612, "body": "Range1 = Weekend / Range1= normal days of the week and I have another range for holydays"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1517432090, "post_id": 48551151, "comment_id": 84098616, "body": "could use Union to combine the ranges (e.g. the two for range 1) then loop over the .Areas of that adding to a dictionary the cell.value (as key), 1 (as value). If already in dictionary (dict.Exists..) add 1 to existing value for that key."}, {"owner": {"reputation": 69, "user_id": 3438908, "user_type": "registered", "accept_rate": 60, "profile_image": "https://graph.facebook.com/100003399662910/picture?type=large", "display_name": "user3438908", "link": "https://stackoverflow.com/users/3438908/user3438908"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1517432134, "post_id": 48551151, "comment_id": 84098633, "body": "Range1 = Weekend / Range2= normal days of the week and I have another range for holydays"}], "answers": [{"comments": [{"owner": {"reputation": 69, "user_id": 3438908, "user_type": "registered", "accept_rate": 60, "profile_image": "https://graph.facebook.com/100003399662910/picture?type=large", "display_name": "user3438908", "link": "https://stackoverflow.com/users/3438908/user3438908"}, "edited": false, "score": 0, "creation_date": 1517482614, "post_id": 48553649, "comment_id": 84117755, "body": "Thank you, but you still didn&#39;t get what i really want to achieve. First I have two tables let&#39;s call them tableOne and tableTwo. tableOne is for workers guard that is related to dates for example worker one have a guard in 01.01.2018 and another guard on 03.01.2018 and another guard on 07.01.2018 according to this worker one have 3 guards in different dates . for that in tableTwo I have the list of workers and three column one for guard at weekend , one for guard at holydays and another column for guard at normal days."}, {"owner": {"reputation": 69, "user_id": 3438908, "user_type": "registered", "accept_rate": 60, "profile_image": "https://graph.facebook.com/100003399662910/picture?type=large", "display_name": "user3438908", "link": "https://stackoverflow.com/users/3438908/user3438908"}, "edited": false, "score": 0, "creation_date": 1517482625, "post_id": 48553649, "comment_id": 84117763, "body": "I want to count each worker&#39;s guard and write the number of guards in tableTwo according to dates weekend holiday normal days. Is it clear"}, {"owner": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "reply_to_user": {"reputation": 69, "user_id": 3438908, "user_type": "registered", "accept_rate": 60, "profile_image": "https://graph.facebook.com/100003399662910/picture?type=large", "display_name": "user3438908", "link": "https://stackoverflow.com/users/3438908/user3438908"}, "edited": false, "score": 0, "creation_date": 1517488823, "post_id": 48553649, "comment_id": 84121618, "body": "Sorry, but your question was &quot;I am trying to compare values from non-contiguous ranges and then write down the number of the same value occurrence&quot; and that&#39;s what I answered. It&#39;s the first time you say something about the guard, and 2 tables and rest of stuff. That explains why &quot;I did not get it&quot;. Next time you want to ask something, please, put all information you have, explain all slowly and with details and people &quot;will get it&quot;"}, {"owner": {"reputation": 69, "user_id": 3438908, "user_type": "registered", "accept_rate": 60, "profile_image": "https://graph.facebook.com/100003399662910/picture?type=large", "display_name": "user3438908", "link": "https://stackoverflow.com/users/3438908/user3438908"}, "edited": false, "score": 0, "creation_date": 1517502363, "post_id": 48553649, "comment_id": 84130919, "body": "I am sorry for that mistake. I hope to help me"}, {"owner": {"reputation": 69, "user_id": 3438908, "user_type": "registered", "accept_rate": 60, "profile_image": "https://graph.facebook.com/100003399662910/picture?type=large", "display_name": "user3438908", "link": "https://stackoverflow.com/users/3438908/user3438908"}, "edited": false, "score": 0, "creation_date": 1517502372, "post_id": 48553649, "comment_id": 84130923, "body": "I am sorry for that mistake. I hope to help me"}, {"owner": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "reply_to_user": {"reputation": 69, "user_id": 3438908, "user_type": "registered", "accept_rate": 60, "profile_image": "https://graph.facebook.com/100003399662910/picture?type=large", "display_name": "user3438908", "link": "https://stackoverflow.com/users/3438908/user3438908"}, "edited": false, "score": 0, "creation_date": 1517563960, "post_id": 48553649, "comment_id": 84155373, "body": "Please see: <a href=\"http://meta.stackoverflow.com/q/284236\">Why is \u201cCan someone help me?\u201d not an actual question?</a>  and see: <a href=\"https://stackoverflow.com/help/mcve\">How to create a Minimal, Complete, and Verifiable example</a>"}], "tags": [], "owner": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "is_accepted": false, "score": 0, "last_activity_date": 1517445207, "creation_date": 1517445207, "answer_id": 48553649, "question_id": 48551151, "link": "https://stackoverflow.com/questions/48551151/compare-non-contiguous-ranges-values-and-count-values-occurrence/48553649#48553649", "title": "Compare non-contiguous Ranges values and count values occurrence", "body": "<p>Try this function</p>\n\n<pre><code>Function COUNT_THIS_VALUE(ByRef CountThis As Range, ByRef InthisRange As Range) As Double\n\nDim AddressArray() As String\nDim i As Double\nAddressArray = Split(InthisRange.Address(False, False), \",\")\n\nFor i = 0 To UBound(AddressArray) Step 1\n    COUNT_THIS_VALUE = COUNT_THIS_VALUE + Application.WorksheetFunction.CountIf(Range(AddressArray(i)), CountThis.Value)\nNext i\nEnd Function\n</code></pre>\n\n<p>First argument of function is WHAT YOU WANT TO COUNT. It must be a single cell. Second argument of the function is in what range you want to search.</p>\n\n<p>I did a simple table with random values between 1 and 10. Yellow rows are my Range1 and white rows are my Range2. I counted all numbers from 1 to 10 in each range and did a table. Take a look at the image to understand better.</p>\n\n<p><a href=\"https://i.stack.imgur.com/cJhYA.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/cJhYA.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>Hope this helps!</p>\n"}], "owner": {"reputation": 69, "user_id": 3438908, "user_type": "registered", "accept_rate": 60, "profile_image": "https://graph.facebook.com/100003399662910/picture?type=large", "display_name": "user3438908", "link": "https://stackoverflow.com/users/3438908/user3438908"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 118, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1517445207, "creation_date": 1517431661, "last_edit_date": 1531164843, "question_id": 48551151, "link": "https://stackoverflow.com/questions/48551151/compare-non-contiguous-ranges-values-and-count-values-occurrence", "title": "Compare non-contiguous Ranges values and count values occurrence", "body": "<p>I am trying to compare values from non-contiguous ranges and then write down the number of the same value occurrence</p>\n\n<p><a href=\"https://i.stack.imgur.com/k8ONu.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/k8ONu.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>I used this code from last post but it compares only values from the same range</p>\n\n<pre><code>Sub tbl()\n\n  Dim Range1 As Range\n  Dim Range2 As Variant\n  Dim range3() As Variant, j As Long\n\n      Set Range1 = Worksheets(\"Sheet1\").Range(\"A1:C10\")\n      Range2 = Worksheets(\"Sheet2\").Range(\"A1:A10\")\n\n      ReDim range3(1 To UBound(Range2, 1), 1 To 1)\n\n\n         For j = 1 To UBound(Range2, 1)\n          range3(j,1) = Application.WorksheetFunction.CountIf(Range1, \n            Range2(j,1))\n         Next j\n\n        Worksheets(\"Sheet2\").Range(\"B1\").Resize(UBound(range3), 1).Value = \n            range3\n\n\n       End Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 4, "creation_date": 1517431528, "post_id": 48551128, "comment_id": 84098349, "body": "A Long is not a collection of Ranges. That&#39;s why."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 2, "creation_date": 1517431718, "post_id": 48551128, "comment_id": 84098437, "body": "And try to avoid implicit activesheet references. Rather than Cells() have Worksheets(myWorksheetName).Cells()"}], "answers": [{"comments": [{"owner": {"reputation": 348, "user_id": 8387711, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/179019171cbef8a9432fc762a8390305?s=128&d=identicon&r=PG&f=1", "display_name": "cookiemonster", "link": "https://stackoverflow.com/users/8387711/cookiemonster"}, "edited": false, "score": 0, "creation_date": 1517432129, "post_id": 48551164, "comment_id": 84098630, "body": "The code works like a previous one I had but it only fills just one empty column A and B and doesn&#39;t loop."}, {"owner": {"reputation": 6095, "user_id": 1274820, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/620aa435151f022b9c4070eae088d788?s=128&d=identicon&r=PG", "display_name": "user1274820", "link": "https://stackoverflow.com/users/1274820/user1274820"}, "edited": false, "score": 0, "creation_date": 1517433602, "post_id": 48551164, "comment_id": 84099408, "body": "@braX bro, this code is only going to &quot;loop&quot; through one cell. You want to do <code>Set rng = Range(&quot;B1:B&quot; &amp; lastRow)</code> That&#39;s not really what needs to be done at all though as far as I can tell."}, {"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1517433794, "post_id": 48551164, "comment_id": 84099497, "body": "Feel free to edit it if you want, I don&#39;t mind.. I don&#39;t usually do things that way. It was more just to show him that he was defining his variables wrong."}, {"owner": {"reputation": 2538, "user_id": 6388698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7gWUL.png?s=128&g=1", "display_name": "GMalc", "link": "https://stackoverflow.com/users/6388698/gmalc"}, "edited": false, "score": 0, "creation_date": 1517434039, "post_id": 48551164, "comment_id": 84099616, "body": "@braX, I think he wants to &quot;loop through each empty cell in Column B and put the date in all empty cells.  The code should be If cel=&quot;&quot; Then"}], "tags": [], "owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "is_accepted": false, "score": 2, "last_activity_date": 1517433418, "last_edit_date": 1517433418, "creation_date": 1517431726, "answer_id": 48551164, "question_id": 48551128, "link": "https://stackoverflow.com/questions/48551128/vba-for-each-cell-in/48551164#48551164", "title": "VBA For each cell in", "body": "<p>A <code>Long</code> is not a collection of <code>Ranges</code>.</p>\n\n<p>I think you are trying to do something like this:</p>\n\n<pre><code>Sub filldownemptyAB()     \n  Dim cel As Range\n  Dim lastRow As Long\n  lastRow = Cells(Rows.Count, 1).End(xlUp).row\n\n  Dim rng as Range\n  Set rng = Range(\"B\" &amp; lastRow)\n\n  For Each cel In rng\n    With cel\n      .Offset(, 0).Formula = \"=year(today())\"\n      .Offset(, -1).Value = \"Actual\"\n    End With\n  Next cel\nEnd Sub\n</code></pre>\n\n<p>But it's hard to tell.</p>\n"}, {"tags": [], "owner": {"reputation": 6095, "user_id": 1274820, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/620aa435151f022b9c4070eae088d788?s=128&d=identicon&r=PG", "display_name": "user1274820", "link": "https://stackoverflow.com/users/1274820/user1274820"}, "is_accepted": true, "score": 4, "last_activity_date": 1517434220, "last_edit_date": 1517434220, "creation_date": 1517433897, "answer_id": 48551694, "question_id": 48551128, "link": "https://stackoverflow.com/questions/48551128/vba-for-each-cell-in/48551694#48551694", "title": "VBA For each cell in", "body": "<p>I believe you're looking for this:</p>\n\n<p>(I edited a few times to simplify things a bit and to scan column <code>B</code> instead of column <code>A</code>)</p>\n\n<pre><code>Sub FillDownEmptyAB()\nDim c, lr\nlr = ActiveSheet.UsedRange.Rows.CountLarge\nFor Each c In Range(\"B1:B\" &amp; lr)\n    If c.Value = \"\" Then\n        c.Offset(,-1).Value = \"Actual\"\n        c.Formula = \"=YEAR(TODAY())\"\n    End If\nNext c\nEnd Sub\n</code></pre>\n\n<p>Input:</p>\n\n<p><a href=\"https://i.stack.imgur.com/tb59Z.png\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/tb59Z.png\" alt=\"Input\"></a></p>\n\n<p>Output:</p>\n\n<p><a href=\"https://i.stack.imgur.com/4s2nY.png\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/4s2nY.png\" alt=\"Output\"></a></p>\n"}], "owner": {"reputation": 348, "user_id": 8387711, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/179019171cbef8a9432fc762a8390305?s=128&d=identicon&r=PG&f=1", "display_name": "cookiemonster", "link": "https://stackoverflow.com/users/8387711/cookiemonster"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 342, "favorite_count": 0, "accepted_answer_id": 48551694, "answer_count": 2, "score": 0, "last_activity_date": 1517434220, "creation_date": 1517431498, "last_edit_date": 1531164843, "question_id": 48551128, "link": "https://stackoverflow.com/questions/48551128/vba-for-each-cell-in", "title": "VBA For each cell in", "body": "<p>I have a sheet with data in columns A to H. Some cells in column A and B have no values or are empty, but there are values in that rows other columns that is C to H. Now I have this code to do this. loop through each empty cell in B and put in the values. that is my code will fill down till the last non empty cell in B. but I get an error. </p>\n\n<pre><code>Sub filldownemptyAB()     \n Dim cel As Range, rng As Long\nrng = Cells(Rows.Count, 1).End(xlUp).row\n\nFor Each cel In rng.Cells\n With ActiveCell\n .Offset(, 0).Formula = \"=year(today())\"\n.Offset(, -1).Value = \"Actual\"\nEnd With\nNext cel\n  End Sub\n</code></pre>\n\n<p>the error is at this line</p>\n\n<pre><code> For each cel in rng\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1517432053, "post_id": 48551103, "comment_id": 84098602, "body": "Yeah, you cannot put a <code>Next</code> inside of an <code>If&#47;Then</code> like that."}, {"owner": {"reputation": 3423, "user_id": 1738572, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/s0VGr.jpg?s=128&g=1", "display_name": "Greg Viers", "link": "https://stackoverflow.com/users/1738572/greg-viers"}, "edited": false, "score": 1, "creation_date": 1517432314, "post_id": 48551103, "comment_id": 84098728, "body": "Is part of your code missing? You have &quot;For Each cell In Target&quot; but no &quot;Next cell&quot;, and there is no &quot;end sub&quot;"}, {"owner": {"reputation": 1901, "user_id": 3590073, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddae1c2a3e6170997e7eaa0e9854a903?s=128&d=identicon&r=PG&f=1", "display_name": "aucuparia", "link": "https://stackoverflow.com/users/3590073/aucuparia"}, "edited": false, "score": 1, "creation_date": 1517433406, "post_id": 48551103, "comment_id": 84099312, "body": "I don&#39;t think the code in the <code>ElseIf</code> section will ever run as it has the same condition as the initial <code>If</code>. So if that condition is true then the first code will run and if it is false, neither section will run."}, {"owner": {"reputation": 15, "user_id": 9285071, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a7ed952b4eeb89252f42a8d8a32b5f12?s=128&d=identicon&r=PG&f=1", "display_name": "Oilprogramming", "link": "https://stackoverflow.com/users/9285071/oilprogramming"}, "edited": false, "score": 0, "creation_date": 1517436057, "post_id": 48551103, "comment_id": 84100611, "body": "Part of my code was missing &quot;   End If     Next currCell2     End If Next cell      End Sub&quot;"}, {"owner": {"reputation": 1901, "user_id": 3590073, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddae1c2a3e6170997e7eaa0e9854a903?s=128&d=identicon&r=PG&f=1", "display_name": "aucuparia", "link": "https://stackoverflow.com/users/3590073/aucuparia"}, "edited": false, "score": 0, "creation_date": 1517503676, "post_id": 48551103, "comment_id": 84131810, "body": "@Oilprogramming, go ahead and edit that in.  I also think you need to provide more detail as it&#39;s not clear what your asking.  In what way did it &quot;not work&quot;?  What do you want to achieve?"}, {"owner": {"reputation": 15, "user_id": 9285071, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a7ed952b4eeb89252f42a8d8a32b5f12?s=128&d=identicon&r=PG&f=1", "display_name": "Oilprogramming", "link": "https://stackoverflow.com/users/9285071/oilprogramming"}, "edited": false, "score": 0, "creation_date": 1517524222, "post_id": 48551103, "comment_id": 84142413, "body": "I got it to work! Thanks for all your help!"}], "owner": {"reputation": 15, "user_id": 9285071, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a7ed952b4eeb89252f42a8d8a32b5f12?s=128&d=identicon&r=PG&f=1", "display_name": "Oilprogramming", "link": "https://stackoverflow.com/users/9285071/oilprogramming"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 51, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1517435115, "creation_date": 1517431390, "last_edit_date": 1517435115, "question_id": 48551103, "link": "https://stackoverflow.com/questions/48551103/run-multiple-macros-when-cell-detects-change", "title": "Run multiple macros when cell detects change", "body": "<p>I've recently been having difficulty running this macro that auto-runs when it detects a modification to a particular range of cells. So far, the first sub that I have inserted into this macro in the sheet code has run smoothly... i tried to replicate this same macro for the other sub and it did not work.</p>\n\n<p>I'm thinking it might be the Elseif that is not working for this particular sheet code.</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\nDim cell As Range\n\nFor Each cell In Target\n    If Not Intersect(cell, Range(\"C5:C1000\")) Is Nothing Then\n        Dim currCell As Range\n        For Each currCell In ActiveSheet.Range(\"D5:D1000\")\n            If IsEmpty(currCell) And currCell.Offset(0, -1) = \"Open\" Then\n                currCell = Format(Now(), \"dd/mm/yyyy\")\n            End If\n        Next currCell\n    ElseIf Not Intersect(cell, Range(\"C5:C1000\")) Is Nothing Then\n        Dim currCell2 As Range\n        For Each currCell2 In ActiveSheet.Range(\"I5:I1000\")\n            If IsEmpty(currCell2) And currCell2.Offset(0, -5) = \"Closed\" Then\n                currCell2 = Format(Now(), \"dd/mm/yyyy\")\n            End If\n        Next currCell2\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1517430779, "post_id": 48550858, "comment_id": 84097980, "body": "After setting <code>currentCell</code> to S1 you never update it"}, {"owner": {"reputation": 605, "user_id": 6510724, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/b03c3a176706015b1868a736981c4bb8?s=128&d=identicon&r=PG&f=1", "display_name": "Emily Alden", "link": "https://stackoverflow.com/users/6510724/emily-alden"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1517431128, "post_id": 48550858, "comment_id": 84098150, "body": "Shouldn&#39;t the line where <code>currentCell=wsExport.Range(&quot;S&quot; &amp; currentRow)</code> do that? After I offset the currentCell by 1 row on the visible cells?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1517431205, "post_id": 48550858, "comment_id": 84098187, "body": "You&#39;re missing the <code>Set</code> there, so what it does is update the <i>Value</i> of currentCell, instead of setting it to another location"}, {"owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "edited": false, "score": 1, "creation_date": 1517431219, "post_id": 48550858, "comment_id": 84098195, "body": "currentCell is an object (range), not a long"}, {"owner": {"reputation": 605, "user_id": 6510724, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/b03c3a176706015b1868a736981c4bb8?s=128&d=identicon&r=PG&f=1", "display_name": "Emily Alden", "link": "https://stackoverflow.com/users/6510724/emily-alden"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1517431229, "post_id": 48550858, "comment_id": 84098203, "body": "Ohhhhh... So adding Set should fix it? I&#39;ll try that now. @TimWilliams , Edit: That did not work. Same issue."}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1517431335, "post_id": 48550858, "comment_id": 84098249, "body": "@EmilyAlden No you need <code>Set currentCell = wsExport.Range(&quot;S&quot; &amp; i)</code> in your loop."}, {"owner": {"reputation": 605, "user_id": 6510724, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/b03c3a176706015b1868a736981c4bb8?s=128&d=identicon&r=PG&f=1", "display_name": "Emily Alden", "link": "https://stackoverflow.com/users/6510724/emily-alden"}, "edited": false, "score": 0, "creation_date": 1517431433, "post_id": 48550858, "comment_id": 84098311, "body": "I don&#39;t want it to be the Range(&quot;S&quot; &amp; i) though. That would include cells that were not visible.  Maybe I should try <code>Set currentCell=currentCell.Offest(1,0).SpecialCells(xlCellTypeV&zwnj;&#8203;isible)</code>"}], "answers": [{"comments": [{"owner": {"reputation": 605, "user_id": 6510724, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/b03c3a176706015b1868a736981c4bb8?s=128&d=identicon&r=PG&f=1", "display_name": "Emily Alden", "link": "https://stackoverflow.com/users/6510724/emily-alden"}, "edited": false, "score": 0, "creation_date": 1517431897, "post_id": 48551182, "comment_id": 84098522, "body": "I&#39;ll try that. Thanks!"}], "tags": [], "owner": {"reputation": 3423, "user_id": 1738572, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/s0VGr.jpg?s=128&g=1", "display_name": "Greg Viers", "link": "https://stackoverflow.com/users/1738572/greg-viers"}, "is_accepted": false, "score": 1, "last_activity_date": 1517431809, "creation_date": 1517431809, "answer_id": 48551182, "question_id": 48550858, "link": "https://stackoverflow.com/questions/48550858/looping-over-visible-range-issue/48551182#48551182", "title": "Looping over Visible Range Issue", "body": "<p>xlCellTypeVisible does not do what you want when working with an offset from a cell like this. Just use an IF instead:</p>\n\n<pre><code>For i = 1 To cCount\n  currentRow = currentCell.Offset(1, 0).Row\n  Set currentCell = wsExport.Range(\"S\" &amp; currentRow)\n  if currentcell.rowheight &gt; 0 then currentCell.Value = currentCell.Value &amp; \"- \" &amp; iDate\n\nNext i\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 605, "user_id": 6510724, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/b03c3a176706015b1868a736981c4bb8?s=128&d=identicon&r=PG&f=1", "display_name": "Emily Alden", "link": "https://stackoverflow.com/users/6510724/emily-alden"}, "edited": false, "score": 0, "creation_date": 1517432534, "post_id": 48551223, "comment_id": 84098845, "body": "I don&#39;t see where/how strDate gets it&#39;s initial value here... Also what my code should do is append the date 1/20 onto the first two visible lines, 1/21 onto the next two visible lines, etc. until it appends 1/25 twice. Since you complete the loop of dt before looping through the r&#39;s this seems like it would apply 1/25 only."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 605, "user_id": 6510724, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/b03c3a176706015b1868a736981c4bb8?s=128&d=identicon&r=PG&f=1", "display_name": "Emily Alden", "link": "https://stackoverflow.com/users/6510724/emily-alden"}, "edited": false, "score": 0, "creation_date": 1517435459, "post_id": 48551223, "comment_id": 84100322, "body": "<code>strDate</code> has no initial value.  I didn&#39;t get what you were doing with the dates - what if you &quot;run out&quot; of dates before getting to the end of the visible rows: just ignore the remaining ones?  Vice-versa what if you have more dates than you have rows to append them to?"}, {"owner": {"reputation": 605, "user_id": 6510724, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/b03c3a176706015b1868a736981c4bb8?s=128&d=identicon&r=PG&f=1", "display_name": "Emily Alden", "link": "https://stackoverflow.com/users/6510724/emily-alden"}, "edited": false, "score": 0, "creation_date": 1517435684, "post_id": 48551223, "comment_id": 84100425, "body": "If it runs out of dates it should stop. It should also stop at the last row with data (lRow). I&#39;ve been playing around with &quot;Do While&quot; loops, but currently it&#39;s not adding to i correctly. (Updating the first post.)"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 605, "user_id": 6510724, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/b03c3a176706015b1868a736981c4bb8?s=128&d=identicon&r=PG&f=1", "display_name": "Emily Alden", "link": "https://stackoverflow.com/users/6510724/emily-alden"}, "edited": false, "score": 0, "creation_date": 1517441114, "post_id": 48551223, "comment_id": 84102644, "body": "Glad you found a solution."}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 1, "last_activity_date": 1517465811, "last_edit_date": 1517465811, "creation_date": 1517431976, "answer_id": 48551223, "question_id": 48550858, "link": "https://stackoverflow.com/questions/48550858/looping-over-visible-range-issue/48551223#48551223", "title": "Looping over Visible Range Issue", "body": "<p>Here's a simplified example using a different approach to looping over the table:</p>\n\n<p><strong>EDIT</strong>: updated to your actual process of incrementing the date every two rows...</p>\n\n<pre><code>Sub Tester()\n\n    Dim sht As Worksheet, rngTable As Range, rw As Range, r As Long\n    Dim sDate, eDate, dt, i As Long\n\n    Set sht = ActiveSheet\n    Set rngTable = sht.Range(\"A1\").CurrentRegion\n\n    rngTable.AutoFilter                           'clear any previous filter\n    rngTable.AutoFilter field:=4, Criteria1:=\"&gt;3\" 'filter to required rows only\n\n    'some dates...\n    sDate = Date\n    eDate = Date + 3\n\n    dt = sDate 'set date to add\n    i = 0\n\n    For r = 2 To rngTable.Rows.Count\n        Set rw = rngTable.Rows(r)\n        'is the row visible?\n        If Not rw.Hidden Then\n            With rw.Cells(2)\n                .Value = .Value &amp; \" - \" &amp; Format(dt, \"dd/mm/yyyy\")\n            End With\n            i = i + 1\n            If i Mod 2 = 0 Then dt = dt + 1  '&lt;&lt; next date every 2 visible rows\n            If dt &gt; eDate Then Exit For      '&lt;&lt; exit if run out of dates\n        End If\n    Next r\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 605, "user_id": 6510724, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/b03c3a176706015b1868a736981c4bb8?s=128&d=identicon&r=PG&f=1", "display_name": "Emily Alden", "link": "https://stackoverflow.com/users/6510724/emily-alden"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 49, "favorite_count": 0, "accepted_answer_id": 48551223, "answer_count": 2, "score": 2, "last_activity_date": 1517465811, "creation_date": 1517430280, "last_edit_date": 1517438983, "question_id": 48550858, "link": "https://stackoverflow.com/questions/48550858/looping-over-visible-range-issue", "title": "Looping over Visible Range Issue", "body": "<p>The function is supposed to loop over a filtered range appending a certain date to the first \"i\" lines then moving to the next date and repeating. </p>\n\n<p>It is appending everything to the header instead of moving down a row each time. </p>\n\n<p>It is not erroring, just not acting as expected. Where am I going wrong on this? </p>\n\n<pre><code> Sub Function()\n\nDim wsExport As Worksheet\nSet wsExport = Workbooks(\"Export Workbook\").Worksheets(\"Export\")\n\nDim uiStartDate As Variant 'I'm using the prefix ui to be User Input\nDim uiEndDate As Variant\nDim uiCount As Variant\nDim cStartDate As Long 'Converted to date\nDim cEndDate As Long\nDim cCount As Long\nDim iDate As Long 'Counter for the date\nDim i As Long 'Counter for the number of items per day.\nDim j As Long 'Counter for Rows\nDim lRow As Long\n\nlRow = Cells.Find(What:=\"*\", LookAt:=xlPart, _\n                LookIn:=xlFormulas, SearchOrder:=xlByRows, _\n                SearchDirection:=xlPrevious, MatchCase:=False).Row\n\n\n\n'Prompt the user for the start date and end date\n'uiStartDate = InputBox(\"Input the first day of week in the format of 01/20/2018\", \"Start Date User Input\")\n'uiEndDate = InputBox(\"Input the last day of week in the format of 01/25/2018\", \"End Date User Input\")\n'uiCount = InputBox(\"Input the number of items per day.\", \"Installtion Quantity User Input\")\nuiStartDate = \"1/20/2018\" 'This is to speed during testing. Will use the above for actual code\nuiEndDate = \"1/25/2018\"\nuiCount = \"2\"\n\n\n'Convert to their proper data types. (User inputs have to be variants to begin with)\ncStartDate = CDate(uiStartDate)\ncEndDate = CDate(uiEndDate)\ncCount = CLng(uiCount)\n\nWith wsExport.Range(\"A:AP\")\n    .AutoFilter Field:=19, Criteria1:=\"&gt;=\" &amp; uiStartDate\nEnd With\n\niDate = cStartDate\nj = 2\ni = 1\n\nDo While j &lt;= lRow\nDoEvents\nIf Not wsExport.Rows(j).Hidden Then\n    wsExport.Range(\"S\" &amp; j).Value = wsExport.Range(\"S\" &amp; j).Value &amp; \"-\" &amp; iDate\n    i = i + 1\n    End If\n\n    If i &gt; cCount Then\n        i = 1\n        iDate = iDate + 1\n    End If\n\n    If iDate &gt; cEndDate Then\n        j = lRow + 1\n    End If\nj = j + 1\nLoop\n\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["html", "vba", "excel"], "comments": [{"owner": {"reputation": 10010, "user_id": 1894021, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/JXt2j.jpg?s=128&g=1", "display_name": "Isaac", "link": "https://stackoverflow.com/users/1894021/isaac"}, "edited": false, "score": 0, "creation_date": 1517430303, "post_id": 48550842, "comment_id": 84097741, "body": "don&#39;t use your VBA script? Use curl <a href=\"https://en.wikipedia.org/wiki/CURL\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/CURL</a>"}, {"owner": {"reputation": 3423, "user_id": 1738572, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/s0VGr.jpg?s=128&g=1", "display_name": "Greg Viers", "link": "https://stackoverflow.com/users/1738572/greg-viers"}, "edited": false, "score": 0, "creation_date": 1517430577, "post_id": 48550842, "comment_id": 84097875, "body": "Is the performance better to use an excel web query instead of controlling IE?"}, {"owner": {"reputation": 59, "user_id": 8451936, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/933cdeb937ac47b6c60d25c9794fea85?s=128&d=identicon&r=PG&f=1", "display_name": "Tomato", "link": "https://stackoverflow.com/users/8451936/tomato"}, "reply_to_user": {"reputation": 3423, "user_id": 1738572, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/s0VGr.jpg?s=128&g=1", "display_name": "Greg Viers", "link": "https://stackoverflow.com/users/1738572/greg-viers"}, "edited": false, "score": 0, "creation_date": 1517432423, "post_id": 48550842, "comment_id": 84098775, "body": "@GregViers what do you mean?"}, {"owner": {"reputation": 3423, "user_id": 1738572, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/s0VGr.jpg?s=128&g=1", "display_name": "Greg Viers", "link": "https://stackoverflow.com/users/1738572/greg-viers"}, "edited": false, "score": 0, "creation_date": 1517432571, "post_id": 48550842, "comment_id": 84098865, "body": "I mean importing data from the web (see this age)<a href=\"https://support.office.com/en-us/article/overview-of-connecting-importing-data-86551057-0ef4-4104-a6ca-fa619aea904c#bmdata_sources_that_you_can_import\" rel=\"nofollow noreferrer\">support.office.com/en-us/article/&hellip;</a>"}, {"owner": {"reputation": 59, "user_id": 8451936, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/933cdeb937ac47b6c60d25c9794fea85?s=128&d=identicon&r=PG&f=1", "display_name": "Tomato", "link": "https://stackoverflow.com/users/8451936/tomato"}, "reply_to_user": {"reputation": 3423, "user_id": 1738572, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/s0VGr.jpg?s=128&g=1", "display_name": "Greg Viers", "link": "https://stackoverflow.com/users/1738572/greg-viers"}, "edited": false, "score": 0, "creation_date": 1517434655, "post_id": 48550842, "comment_id": 84099938, "body": "@Greg Viers I tried it but for this site is this unusable."}], "owner": {"reputation": 59, "user_id": 8451936, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/933cdeb937ac47b6c60d25c9794fea85?s=128&d=identicon&r=PG&f=1", "display_name": "Tomato", "link": "https://stackoverflow.com/users/8451936/tomato"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 51, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1517431152, "creation_date": 1517430183, "last_edit_date": 1517431152, "question_id": 48550842, "link": "https://stackoverflow.com/questions/48550842/loading-only-html-without-any-style-and-scripts", "title": "Loading only HTML without any style and scripts", "body": "<p>I have one VBA script, that find some data on web (csfd.cz) and put into Excel. But it is quite slow because it takes some time to load the website (in IE) and then extract data. My thought is how to make that IE only loads HTML and it doesn't load any graphics and functional things - only pure HTML. Is it somehow possible? Thanks for help...</p>\n\n<p>here is my code:</p>\n\n<pre><code>Sub InputData()\nDim cursor As String\nDim i As Long\nDim ie As Object\nDim lastRow As Long\nDim releasesLength As Long\nDim releases As Object\nDim oneRelease As Object\nDim datumKino As String\nDim datumDVD As String\nDim origins As String\nDim year As Long\nDim time As Long\nDim name As String\nDim genreLong As String\nDim genre As String\n\n'zapamatov\u00e1n\u00ed kurzoru\ncursor = ActiveCell.Address\n\n'zji\u0161t\u011bn\u00ed posledn\u00edho \u0159\u00e1dku\nWith ActiveSheet\n    lastRow = .Cells(.Rows.Count, \"L\").End(xlUp).Row\nEnd With\n\n'prvn\u00ed viditeln\u00e1 bu\u0148ka\nRange(\"L2\").Select\nActiveCell.Offset(1, 0).Select\nDo Until ActiveCell.Height &lt;&gt; 0\n    ActiveCell.Offset(1, 0).Select\nLoop\n\n'inicializace\nSet ie = CreateObject(\"InternetExplorer.Application\")\n\n'ZA\u010c\u00c1TEK SMY\u010cKY--------------------------------------------------------------\nFor i = ActiveCell.Row To lastRow\nCells(i, 12).Select\n\n'resetov\u00e1n\u00ed prom\u011bn\u00fdch\nreleasesLength = vbNullLong\nSet releases = Nothing\nSet oneRelease = Nothing\ndatumKino = \"\"\ndatumDVD = \"\"\norigins = \"\"\nyear = vbNullLong\ntime = vbNullLong\nname = \"\"\ngenreLong = \"\"\ngenre = \"\"\n\n'vy\u0159azen\u00ed\nIf (InStr(Cells(i, 12).Value, \"csfd.cz\") = 0 Or ActiveCell.Height = 0) Then\nGoTo NextRow\nEnd If\n\n'otev\u0159en\u00ed str\u00e1nky\nie.Visible = False\nie.navigate Cells(i, 12).Value\nApplication.StatusBar = \"Na\u010d\u00edt\u00e1m \u00fadaje. Pros\u00edm po\u010dkejte...\"\nDo While ie.busy\nApplication.Wait DateAdd(\"s\", 1, Now)\nLoop\n\n'\u00faprava procent a datum\u016f\n\nCells(i, 9).Value = ie.document.getElementById(\"rating\").Children(0).innerText\nreleasesLength = ie.document.getElementById(\"releases\").getElementsByClassName(\"content\")(0).getElementsByTagName(\"table\")(0).getElementsByTagName(\"tbody\")(0).Children.Length\nSet releases = ie.document.getElementById(\"releases\").getElementsByClassName(\"content\")(0).getElementsByTagName(\"table\")(0).getElementsByTagName(\"tbody\")(0).Children\nFor j = 0 To releasesLength - 1\n    Set oneRelease = releases(j)\n    If (oneRelease.getElementsByTagName(\"th\")(0).getElementsByTagName(\"img\")(0).getAttribute(\"title\") = \"\u010cesko\") Then\n        If (InStr(oneRelease.getElementsByTagName(\"th\")(0).innerHTML, \"V kinech\")) Then\n            If (datumKino = \"\") Then\n                datumKino = Left(Replace(Replace(Replace(oneRelease.getElementsByTagName(\"td\")(0).innerHTML, \" \", \"\"), vbLf, \"\"), vbTab, \"\"), 10)\n            End If\n        ElseIf (InStr(oneRelease.getElementsByTagName(\"th\")(0).innerHTML, \"Na DVD\")) Then\n            If (datumDVD = \"\") Then\n                datumDVD = Left(Replace(Replace(Replace(oneRelease.getElementsByTagName(\"td\")(0).innerHTML, \" \", \"\"), vbLf, \"\"), vbTab, \"\"), 10)\n            End If\n        ElseIf (InStr(oneRelease.getElementsByTagName(\"th\")(0).innerHTML, \"Na Blu-ray\")) Then\n            If (datumDVD = \"\") Then\n                datumDVD = Left(Replace(Replace(Replace(oneRelease.getElementsByTagName(\"td\")(0).innerHTML, \" \", \"\"), vbLf, \"\"), vbTab, \"\"), 10)\n            End If\n        End If\n    Else\n        GoTo NextRelease\n    End If\nNextRelease:\nNext j\nIf (Len(datumKino) &lt;&gt; 0) Then\nCells(i, 1).Value = datumKino\nEnd If\nIf (Len(datumDVD) &lt;&gt; 0) Then\nCells(i, 2).Value = datumDVD\nEnd If\n\n'1. prvn\u00ed z\u00e1pis do \u0159\u00e1dku\nIf (Cells(i, 4).Value = \"\") Then\n    year = ie.document.getElementsByClassName(\"origin\")(0).getElementsByTagName(\"span\")(0).innerHTML\n    Cells(i, 4).Value = year\n\n    origin = ie.document.getElementsByClassName(\"origin\")(0).innerHTML\n    originSplit = Split(origin, \",\")\n    time = Replace(originSplit(UBound(originSplit)), \" min\", \"\")\n    Cells(i, 10).Value = time\n\n    name = Replace(Replace(ie.document.getElementsByClassName(\"info\")(0).getElementsByClassName(\"header\")(0).getElementsByTagName(\"h1\")(0).innerHTML, vbLf, \"\"), vbTab, \"\")\n    Cells(i, 3).Value = name\n\n    genreLong = ie.document.getElementsByClassName(\"genre\")(0).innerHTML\n    genre = Replace(Replace(Replace(Replace(Replace(Replace(Replace(Replace(Replace(Replace(Replace(Replace(Replace(Replace(genreLong, \" \", \"\"), \"Ak\u010dn\u00ed\", \"Ak\u010d.\"), \"Animovan\u00fd\", \"Anim.\"), \"Dobrodru\u017en\u00fd\", \"Dobr.\"), \"Dokument\u00e1rn\u00ed\", \"Dokument.\"), \"Fantasy\", \"Fant.\"), \"Historick\u00fd\", \"Histor.\"), \"Katastrofick\u00fd\", \"Katastrof.\"), \"Komedie\", \"Kom.\"), \"Mysteri\u00f3zn\u00ed\", \"Myster.\"), \"Rodinn\u00fd\", \"Rod.\"), \"Romantick\u00fd\", \"Romant.\"), \"Thriller\", \"Thril.\"), \"\u017divotopisn\u00fd\", \"\u017divotopis.\")\n    Cells(i, 5).Value = genre\nEnd If\n\n\nNextRow:\nNext i\n'KONEC SMY\u010cKY----------------------------------------------------------------\n\n'Clean\nie.Quit\nSet ie = Nothing\nSet releases = Nothing\nSet oneRelease = Nothing\nApplication.StatusBar = \"\"\n\nRange(cursor).Select\nEnd Sub \n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1517430039, "post_id": 48550535, "comment_id": 84097596, "body": "You will need to incorporate Application.FileDialog(msoFileDialogFilePicker) to your code.  That opens an Explorer window and allows a file to be selected."}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 1, "creation_date": 1517430054, "post_id": 48550535, "comment_id": 84097605, "body": "You can use the <code>Application.GetOpenFilename Method </code> with <code>multi-select= true</code>"}, {"owner": {"reputation": 11, "user_id": 9269869, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff878bec8dd3d4146b33b8a9baa37fbe?s=128&d=identicon&r=PG&f=1", "display_name": "Sirajum Mim", "link": "https://stackoverflow.com/users/9269869/sirajum-mim"}, "reply_to_user": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1517495185, "post_id": 48550535, "comment_id": 84125920, "body": "@RonRosenfeld, I have tried  strPath=Application.GetOpenFilename(MultiSelect:=True) but its giving me error every time"}], "owner": {"reputation": 11, "user_id": 9269869, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff878bec8dd3d4146b33b8a9baa37fbe?s=128&d=identicon&r=PG&f=1", "display_name": "Sirajum Mim", "link": "https://stackoverflow.com/users/9269869/sirajum-mim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 46, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1517428914, "creation_date": 1517428914, "last_edit_date": 1531161705, "question_id": 48550535, "link": "https://stackoverflow.com/questions/48550535/need-to-choose-files-manually-instead-of-directing-the-vb-code-to-a-folderpath", "title": "Need to choose files manually instead of directing the vb code to a folderpath", "body": "<p>I did a vb code which is reading multiple text files from a folder and then parsing specific data from it. In the code I have hard coded a folderpath strPath = \"C:\\Users\\smim\\Desktop\\Mim\\Excel\\\". Now I would like to be able to choose the folder and files manually instead of hard coding the folder path. Here is my code :</p>\n\n<pre><code>Sub Parse()\n\n Dim ws As Worksheet\nDim MyData As String, strData() As String\nDim WriteToRow As Long, i As Long\nDim strCurrentTxtFile As String\nDim count As Variant, yellow As Variant, red As Variant, \nDim YellowC As Variant,RedC As Variant, filecounter As Variant\nDim strPath As String\n Application.ScreenUpdating = False\n count = 0\n red = 0\n yellow = 0\n\nYellowC = 0\nRedC = 0\n strPath = \"C:\\Users\\smim\\Desktop\\Mim\\Excel\\\"\n\n'Set Book3 = Sheets(\"Sheet1\")\nSet ws = Workbooks.Add(xlWBATWorksheet).Worksheets(1)\n\nMsgBox (\"Started\")\n'~~&gt; Start from Row 1\n'WriteToRow = 1\nCells(3, 1) = \"Error\"\nCells(3, 1).Interior.ColorIndex = 3\nCells(3, 2) = \"Warnings\"\nCells(3, 2).Interior.ColorIndex = 6\nCells(1, 3) = \"Error\"\nCells(1, 3).Interior.ColorIndex = 3\nCells(2, 3) = \"Warnings\"\nCells(2, 3).Interior.ColorIndex = 6\n\n strCurrentTxtFile = Dir(strPath &amp; \"test_*.txt\")\n' MsgBox (strCurrentTxtFile)\n'~~&gt; Looping through all text files in a folder\n\nDo While strCurrentTxtFile &lt;&gt; \"\"\n\n    Dim list() As String\n    '~~&gt; Open the file in 1 go to read it into an array\n    Open strPath &amp; strCurrentTxtFile For Binary As #1\n    MyData = Space$(LOF(1))\n    Get #1, , MyData\n    Close #1\n\n    strData() = Split(MyData, vbLf)\n    LineCount = UBound(strData)\n  '  MsgBox (LineCount)\n\n    'Assigning length of the list array\n    ReDim Preserve list(LineCount + 1)\n\n    For x = 0 To (LineCount - 1)\n        'For x = LBound(strData) To UBound(strData)\n       'Parsing each line to get the result only ( after = sign)\n       s = Split(strData(x), \"=\")\n       b = UBound(s)\n\n       'MsgBox (s(1))\n       'Assigning Values to the list array\n      list(x) = s(1)\n\n     Next\n\n        'MsgBox (\"This is list\" &amp; list(2))\n\n     'Active Cell 2\n    Range(\"A2\").Activate\n\n    'Get row number\n    dblRowNo = ActiveCell.Row\n\n    'Get col number\n    dblColNo = ActiveCell.Column\n    'MsgBox (dblColNo)\n\n\n  '  ReDim Preserve list(LineCount)\n\n    For i = 0 To (LineCount - 1)\n           Cells(3, 3 + i + 1).Value = i\n        'Looping and assigning Values to the Cell\n        'For i = LBound(strData) To UBound(strData)\n        tempParsing = Split(list(i), \":\")\n\n       ' MsgBox (tempParsing(0))\n         If tempParsing(0) &gt; 0 And tempParsing(0) &lt; 10 Then\n           Cells(dblRowNo + count + 2, dblColNo + i + 3).Interior.ColorIndex = 6\n           yellow = yellow + 1\n\n           ElseIf tempParsing(0) &gt;= 10 Then\n            Cells(dblRowNo + count + 2, dblColNo + i + 3).Interior.ColorIndex = 3\n             red = red + 1\n           ElseIf tempParsing(0) = 0 Then\n             Cells(dblRowNo + count + 2, dblColNo + i + 3).Interior.ColorIndex = 0\n        End If\n\n   'Looping and assigning Values to the Cell\n      '  For i = LBound(strData) To UBound(strData)\n      Cells(dblRowNo + count + 2, dblColNo + 1) = yellow\n    Cells(dblRowNo + count + 2, dblColNo) = red\n    Cells(dblRowNo + count + 2, dblColNo + i + 3).Value = list(i)\n\n\n\n\n\n\n\n      Next\n      Cells(3 + count + 1, 3).Value = count\n      count = count + 1\n      yellow = 0\n       red = 0\n     strCurrentTxtFile = Dir\n\n\n\n    Loop\n     For t = 4 To 175\n\n    If Cells(t, 1).Value &gt; 0 Then\n\n       Cells(t, 1).Interior.ColorIndex = 3\n\n        End If\n\n If Cells(t, 2).Value &gt; 0 Then\n\n\n    Cells(t, 2).Interior.ColorIndex = 6\n\n  End If\n       Next\n\n\n\n  'Cells(9, 1) = \"linecount = \"\n       'Cells(9, 2) = LineCount\n\n MsgBox \"Done\"\n\n For f = 4 To 175\n\n     If Cells(f, 4).Interior.ColorIndex = 6 Then\n\n           YellowC = YellowC + 1\n\n        ElseIf Cells(f, 4).Interior.ColorIndex = 3 Then\n\n           RedC = RedC + 1\n\n     End If\n  Next\n\n  For g = 4 To 175\n\n   If Cells(g, 7).Interior.ColorIndex = 6 Then\n\n       YellowC = YellowC + 1\n\n   ElseIf Cells(g, 7).Interior.ColorIndex = 3 Then\n\n       RedC = RedC + 1\n\n    End If\n  Next\n\n For u = 0 To (LineCount - 1)\n\n  Cells(dblRowNo, dblColNo + u + 3) = YellowC\n   Cells(1, dblColNo + u + 3) = RedC\n\n  Next\n\n\n  YellowC = 0\n  RedC = 0\n\n\nApplication.ScreenUpdating = True\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "runtime-error"], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 9296484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e81c9dc940dbc767932b92f9d6040917?s=128&d=identicon&r=PG&f=1", "display_name": "cmg", "link": "https://stackoverflow.com/users/9296484/cmg"}, "edited": false, "score": 0, "creation_date": 1517490569, "post_id": 48560750, "comment_id": 84122728, "body": "Thanks. I thing that is still past my current abilities, but I&#39;ll keep trying."}], "tags": [], "owner": {"reputation": 563, "user_id": 7897151, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/132dbf9711a2b39da695e7b5bb5fc225?s=128&d=identicon&r=PG", "display_name": "FrankPl", "link": "https://stackoverflow.com/users/7897151/frankpl"}, "is_accepted": false, "score": 0, "last_activity_date": 1517481619, "creation_date": 1517481619, "answer_id": 48560750, "question_id": 48550473, "link": "https://stackoverflow.com/questions/48550473/run-time-error-13-type-mismatch-error-message/48560750#48560750", "title": "\u201cRun-time error \u201813\u2019: Type mismatch\u201d error message", "body": "<p><code>Target</code> is a Range, and hence it may consist of more than one cell. In that case, the <code>Value</code> property is invalid.</p>\n\n<p>A simple solution would be to ignore changes with more than one cell: For that, we need to add the following before the access to the <code>Value</code> property:</p>\n\n<pre><code>If Target.Count &lt;&gt; 1 Then Exit Sub\n</code></pre>\n\n<p>But that would not show a message if e. g. the user pastes five cells, and one or more of them contain the text. The perfect solution would be looping through the range and check each cell separately. And then you would have to think if you want to show the message more than one time if the text is found in more than one cell. So, I will leave that as an exercise to the reader...</p>\n"}], "owner": {"reputation": 11, "user_id": 9296484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e81c9dc940dbc767932b92f9d6040917?s=128&d=identicon&r=PG&f=1", "display_name": "cmg", "link": "https://stackoverflow.com/users/9296484/cmg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 665, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1517484800, "creation_date": 1517428707, "last_edit_date": 1517484800, "question_id": 48550473, "link": "https://stackoverflow.com/questions/48550473/run-time-error-13-type-mismatch-error-message", "title": "\u201cRun-time error \u201813\u2019: Type mismatch\u201d error message", "body": "<p>Good afternoon. </p>\n\n<p>I\u2019m new at <code>VBA</code>. From my research on the internet, I\u2019ve been able to add some lines that display a message box when an <code>NG</code> is entered into a cell within the range. However, when I try to delete the inputs from several cells, I get a <code>Run-time error \u201813\u2019: Type mismatch</code> message. Any ideas what I\u2019m doing wrong and how to fix it? I\u2019ve added the code that I put in <code>VBA</code> below:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    If Intersect(Target, Range(\"I3:JY30\")) Is Nothing Then Exit Sub\n    If Target.Value &lt;&gt; \"NG\" Then Exit Sub\n    MsgBox \"ATTENTION: If bell cup is No Good, please replace with new cup and notify supervisor/leader for review. Also, document bell cup serial number and concern on worksheet titled Scrap Bell Tracking \"\nEnd Sub\n</code></pre>\n\n<p>Also, when I click Debug, the <code>If Target.Value &lt;&gt; \"NG\" Then</code> is highlighted.</p>\n\n<p>Thank you in advance for your help. </p>\n"}, {"tags": ["excel", "vba", "outlook"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1517432483, "post_id": 48550399, "comment_id": 84098812, "body": "As far as I know, <code>HTMLBody</code> is expecting, well, HTML."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1517432618, "post_id": 48550399, "comment_id": 84098893, "body": "What type is <code>SDest</code>? If it&#39;s not declared, then <code>SDest = &quot;&quot;</code> makes it a <code>Variant&#47;String</code>, then <code>SDest = Cells(...).Value</code> makes it whatever the type of that cell&#39;s <i>value</i> is, and then <code>SDest.Value.Select</code> would definitely blow up - remove that instruction (you don&#39;t need to <code>Select</code> anything anyway)."}], "answers": [{"comments": [{"owner": {"reputation": 55, "user_id": 3492535, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/CZ2Wi.jpg?s=128&g=1", "display_name": "Tayyab", "link": "https://stackoverflow.com/users/3492535/tayyab"}, "edited": false, "score": 0, "creation_date": 1517589791, "post_id": 48551532, "comment_id": 84171461, "body": "i got another workable solution for this but your feedback was helpful as well. Thank you"}], "tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": true, "score": 1, "last_activity_date": 1517433197, "creation_date": 1517433197, "answer_id": 48551532, "question_id": 48550399, "link": "https://stackoverflow.com/questions/48550399/copy-list-of-emails-to-outlook/48551532#48551532", "title": "Copy list of emails to Outlook", "body": "<p>Say you have cells B2:B30 (all in the same column) in Sheet1, containing email addresses. What you want is to grab the <em>values</em> in these cells, and turn them into a one-dimensional array - that's done like this:</p>\n\n<pre><code>Dim values As Variant\nvalues = Application.WorksheetFunction.Transpose(Sheet1.Range(\"B2:B30\").Value)\n</code></pre>\n\n<p>With a one-dimensional array of email addresses, all you need to do is to turn it into a <code>String</code>. The <code>Join</code> function is made exactly for that:</p>\n\n<pre><code>Dim recipients As String\nrecipients = Join(values, \";\")\n</code></pre>\n\n<p>That's all! ...assuming the cells <em>all</em> contain an email address string. If one cell contains an error value, expect trouble. If there are blanks, expect blanks (shouldn't make a difference though). If the range to grab isn't carved in stone, research how to make it more dynamic.</p>\n\n<p>The <code>HtmlBody</code> is expecting an HTML-encoded string that contains HTML markup. If you only have plain text, use the <code>Body</code> property instead.</p>\n"}], "owner": {"reputation": 55, "user_id": 3492535, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/CZ2Wi.jpg?s=128&g=1", "display_name": "Tayyab", "link": "https://stackoverflow.com/users/3492535/tayyab"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 131, "favorite_count": 0, "accepted_answer_id": 48551532, "answer_count": 1, "score": 0, "last_activity_date": 1593073000, "creation_date": 1517428438, "last_edit_date": 1593073000, "question_id": 48550399, "link": "https://stackoverflow.com/questions/48550399/copy-list-of-emails-to-outlook", "title": "Copy list of emails to Outlook", "body": "<p>Can someone help me with below code? Here is a piece of code that is intended to copy a list of emails id's from \"Sheet1\" cells \"B2\" to \"n\" number of rows having data. </p>\n\n<p>I am facing two issues with this. </p>\n\n<p>1) HTMLBody text is not copied to email.<br>\n2) List of email recipient available at Sheet1, B2 onward is not getting copied on email recipient list (\"To\" list).</p>\n\n<p>Thanks in advance!</p>\n\n<pre><code>Sub MeetingMacro()\n'MsgBox Hour(Now)\nIf Weekday(Now, vbMonday) &gt;= 6 And Hour(Now) &gt; 12 Then\nExit Sub\nEnd If\n\nApplication.ScreenUpdating = False\n\nDim pt As PivotTable\nSet pt = ThisWorkbook.Sheets(\"Sheet2\").PivotTables(\"PivotTable\")\npt.RefreshTable\nApplication.CalculateUntilAsyncQueriesDone\nCall saveAsXlsx1\nApplication.CalculateUntilAsyncQueriesDone\nCall savefile\nApplication.CalculateUntilAsyncQueriesDone\nCall Send_Range\n'Call Send_Range\n\n\nEnd Sub\n\nSub Send_Range()\n\n   Dim TBL As ListObject\n     ThisWorkbook.Activate\n\n   ThisWorkbook.EnvelopeVisible = False\n   ThisWorkbook.Sheets(\"Sheet2\").Range(\"A1:B30\").Select\n    ThisWorkbook.Activate\n   With ActiveSheet.MailEnvelope\n\n            SDest = \"\"\n       For iCounter = 2 To WorksheetFunction.CountA(Columns(3))\n           If SDest = \"\" Then\n               SDest = Cells(iCounter, 3).Value\n               SDest.Value.Select\n           Else\n               SDest = SDest &amp; \";\" &amp; Cells(iCounter, 3).Value\n           End If\n       Next iCounter\n\n      .Item.To = SDest\n      .Item.CC = \"someone@example.com\"\n      .Item.Subject = \"[URGENT] Meeting has been cancelled. \"\n      .Item.HTMLBody = \"Hello,\" &amp; vbCrLf &amp; \"Meeting has been cancelled. Fresh invite will be sent soon.\u201d &amp; vbCrLf &amp; \"Regards\"\n      .Item.Attachments.Add \"C:\\Attachment.xlsx\" 'ActiveWorkbook.FullName\n      .Item.Send\n   End With\n\n   'MsgBox (TimeOfDay)\nEnd Sub\n\n\n'MsgBox (TimeOfDay)\nSub savefile()\n Application.ScreenUpdating = False\n     ThisWorkbook.Activate\n     Application.ScreenUpdating = True\nThisWorkbook.Save\nEnd Sub\nSub saveAsXlsx1()\nThisWorkbook.Worksheets(Array(\"Sheet2\")).Copy\nApplication.DisplayAlerts = False\n ActiveSheet.Shapes.Range(\"FetchData\").Delete\nActiveWorkbook.SaveAs Filename:=\"C:\\Attachment.xlsx\"\nActiveWorkbook.Close\nEnd Sub\n\nSub Meeting4()\nThisWorkbook.Application.DisplayAlerts = False\nActiveWorkbook.Save\nThisWorkbook.Close\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 0, "creation_date": 1517432438, "post_id": 48550447, "comment_id": 84098784, "body": "OP is putting the formula over a range of columns (<code>JI</code> to <code>JM</code>), so the Transpose is not required."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 0, "creation_date": 1517441304, "post_id": 48550447, "comment_id": 84102706, "body": "@chrisneilsen -  Thanks I didn&#39;t think that should be necessary but somehow got things backwards..."}, {"owner": {"reputation": 1, "user_id": 9296476, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-yJfs7kIggsE/AAAAAAAAAAI/AAAAAAAAEXg/h-lwn77qdWc/photo.jpg?sz=128", "display_name": "Udit Mittal", "link": "https://stackoverflow.com/users/9296476/udit-mittal"}, "edited": false, "score": 0, "creation_date": 1518112664, "post_id": 48550447, "comment_id": 84381994, "body": "@TimWilliams - Thank you very much. It worked for me."}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 1, "last_activity_date": 1517441259, "last_edit_date": 1517441259, "creation_date": 1517428611, "answer_id": 48550447, "question_id": 48550381, "link": "https://stackoverflow.com/questions/48550381/formula-application-defined-error-or-object-defined-error/48550447#48550447", "title": "Formula Application-defined error or object defined error", "body": "<pre><code>strFormulas(1) = \"=IFERROR(LARGE($B2:$JH2,ROW($1:$1)),\"\")\"\n</code></pre>\n\n<p>(and the others) should be </p>\n\n<pre><code>strFormulas(1) = \"=IFERROR(LARGE($B2:$JH2,ROW($1:$1)),\"\"\"\")\"\n</code></pre>\n\n<p>You need to escape the <code>\"</code> by doubling them up.</p>\n"}, {"tags": [], "owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "is_accepted": false, "score": 0, "last_activity_date": 1517433034, "creation_date": 1517433034, "answer_id": 48551494, "question_id": 48550381, "link": "https://stackoverflow.com/questions/48550381/formula-application-defined-error-or-object-defined-error/48551494#48551494", "title": "Formula Application-defined error or object defined error", "body": "<p>Core issue is not escaping the <code>\"</code>s as others mentioned.</p>\n\n<p>There are a few other issues too, so see inline comments below</p>\n\n<pre><code>Sub Copy_Reason()\n    Dim sh As Worksheet\n    ' specify type for all variables, otherwise they will be Variants\n    Dim lRow As Long, p As Long, q As Long\n    Dim strFormulas(1 To 5) As Variant\n\n    Set sh = ThisWorkbook.Sheets(\"Sum_Reasons\")\n    ' use the worksheet object you just created\n    With sh\n        ' get last row from the required sheet (as it was, it was getting lRow form the Active Sheet)\n        lRow = .Cells(.Rows.Count, 1).End(xlUp).Row\n        MsgBox lRow\n        strFormulas(1) = \"=IFERROR(LARGE($B2:$JH2,ROW($1:$1)),\"\"\"\")\"  ' escape the \"\n        strFormulas(2) = \"=IFERROR(LARGE($B2:$JH2,ROW($2:$2)),\"\"\"\")\"\n        strFormulas(3) = \"=IFERROR(LARGE($B2:$JH2,ROW($3:$3)),\"\"\"\")\"\n        strFormulas(4) = \"=IFERROR(LARGE($B2:$JH2,ROW($4:$4)),\"\"\"\")\"\n        strFormulas(5) = \"=IFERROR(LARGE($B2:$JH2,ROW($5:$5)),\"\"\"\")\"\n\n        .Range(\"JI2:JM\" &amp; lRow).Formula = strFormulas ' FillDown is not needed, this will update the relative references as required\n        ' Note a 1D array will apply correctly to a single row as it does here\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 9296476, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-yJfs7kIggsE/AAAAAAAAAAI/AAAAAAAAEXg/h-lwn77qdWc/photo.jpg?sz=128", "display_name": "Udit Mittal", "link": "https://stackoverflow.com/users/9296476/udit-mittal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 80, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1517441259, "creation_date": 1517428392, "last_edit_date": 1517429599, "question_id": 48550381, "link": "https://stackoverflow.com/questions/48550381/formula-application-defined-error-or-object-defined-error", "title": "Formula Application-defined error or object defined error", "body": "<p>I am trying to run the code, but facing </p>\n\n<blockquote>\n  <p>Application-defined error / object defined error</p>\n</blockquote>\n\n<p>on the line: <code>.Range(\"JI2:JM2\").Formula = strFormulas</code> Please help me to resolve the issue.</p>\n\n<pre><code>Sub Copy_Reason()\n\nDim sh As Worksheet\nDim lRow, p, q As Long\n\nSet sh = ThisWorkbook.Sheets(\"Sum_Reasons\")\nlRow = Cells(Rows.Count, 1).End(xlUp).Row\nMsgBox lRow\n\n    Dim strFormulas(1 To 5) As Variant\n\n    With ThisWorkbook.Sheets(\"Sum_Reasons\")\n        strFormulas(1) = \"=IFERROR(LARGE($B2:$JH2,ROW($1:$1)),\"\")\"\n        strFormulas(2) = \"=IFERROR(LARGE($B2:$JH2,ROW($2:$2)),\"\")\"\n        strFormulas(3) = \"=IFERROR(LARGE($B2:$JH2,ROW($3:$3)),\"\")\"\n        strFormulas(4) = \"=IFERROR(LARGE($B2:$JH2,ROW($4:$4)),\"\")\"\n        strFormulas(5) = \"=IFERROR(LARGE($B2:$JH2,ROW($5:$5)),\"\")\"\n\n        .Range(\"JI2:JM2\").Formula = strFormulas\n        .Range(\"JI2:JM\" &amp; lRow).FillDown\n    End With\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["sql-server", "ms-access", "vba"], "comments": [{"owner": {"reputation": 30515, "user_id": 3813116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DeWnw.png?s=128&g=1", "display_name": "Sean Lange", "link": "https://stackoverflow.com/users/3813116/sean-lange"}, "edited": false, "score": 3, "creation_date": 1517427098, "post_id": 48550021, "comment_id": 84096066, "body": "You really need to start using parameterized queries. Not only does it protect you from sql injection it makes you code far more manageable. I would even say you should convert this to a stored procedure on your sql server and stop doing database work in the front end."}, {"owner": {"reputation": 235, "user_id": 1965279, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/iGHMq.png?s=128&g=1", "display_name": "Remo Williams", "link": "https://stackoverflow.com/users/1965279/remo-williams"}, "reply_to_user": {"reputation": 30515, "user_id": 3813116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DeWnw.png?s=128&g=1", "display_name": "Sean Lange", "link": "https://stackoverflow.com/users/3813116/sean-lange"}, "edited": false, "score": 0, "creation_date": 1517427225, "post_id": 48550021, "comment_id": 84096139, "body": "Noted.  Thanks for the recommendation.  I&#39;ll do some homework and figure that out.  Poor security practices aside (I promise I&#39;m not taking that lightly), do you know what may be causing the error in question?"}, {"owner": {"reputation": 30515, "user_id": 3813116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DeWnw.png?s=128&g=1", "display_name": "Sean Lange", "link": "https://stackoverflow.com/users/3813116/sean-lange"}, "edited": false, "score": 0, "creation_date": 1517427329, "post_id": 48550021, "comment_id": 84096199, "body": "Personally I wouldn&#39;t worry about the error too much. There are so many bad things in this code that simply writing it correctly will eliminate the errors. Things like inserts with no column names, select * are example of sloppy and brittle code. I will post an example shortly of a better way to handle this."}, {"owner": {"reputation": 235, "user_id": 1965279, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/iGHMq.png?s=128&g=1", "display_name": "Remo Williams", "link": "https://stackoverflow.com/users/1965279/remo-williams"}, "reply_to_user": {"reputation": 30515, "user_id": 3813116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DeWnw.png?s=128&g=1", "display_name": "Sean Lange", "link": "https://stackoverflow.com/users/3813116/sean-lange"}, "edited": false, "score": 0, "creation_date": 1517427736, "post_id": 48550021, "comment_id": 84096418, "body": "Thanks man.  If a little humility makes me a safer employee, I&#39;ll take whatever you dish out.  Appreciate it."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1517427985, "post_id": 48550021, "comment_id": 84096526, "body": "@RemoWilliams Protecting against SQL Injection isn&#39;t just about security. It also protects you against stupid embarrassing bugs when Bob O&#39;Neil wants to log into your system, or when Mrs.Null wants to change her password. That said why isn&#39;t <code>Project_ID</code> not a numeric field (or if it is, then why is it quoted)?"}, {"owner": {"reputation": 3238, "user_id": 3042438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b930cad6b909cf6546dfe29bdeb8af88?s=128&d=identicon&r=PG&f=1", "display_name": "SunKnight0", "link": "https://stackoverflow.com/users/3042438/sunknight0"}, "edited": false, "score": 2, "creation_date": 1517434214, "post_id": 48550021, "comment_id": 84099700, "body": "SQL Server SQL and MS Access SQL are not the same. Something can run perfectly fine is SSMS and not work at all in Access and vice versa. To start with, when using VBA, don&#39;t jumble multiple SQL statements into a single string. Format and execute each one in sequence. At the very least you will know which of these work and which give an error."}], "answers": [{"comments": [{"owner": {"reputation": 235, "user_id": 1965279, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/iGHMq.png?s=128&g=1", "display_name": "Remo Williams", "link": "https://stackoverflow.com/users/1965279/remo-williams"}, "edited": false, "score": 0, "creation_date": 1517427944, "post_id": 48550220, "comment_id": 84096505, "body": "Thanks very much.  I&#39;ll work with this and let you know the results ASAP."}, {"owner": {"reputation": 30515, "user_id": 3813116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DeWnw.png?s=128&g=1", "display_name": "Sean Lange", "link": "https://stackoverflow.com/users/3813116/sean-lange"}, "reply_to_user": {"reputation": 235, "user_id": 1965279, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/iGHMq.png?s=128&g=1", "display_name": "Remo Williams", "link": "https://stackoverflow.com/users/1965279/remo-williams"}, "edited": false, "score": 0, "creation_date": 1517428026, "post_id": 48550220, "comment_id": 84096560, "body": "Cool. You will need to add and pass those parameters when calling this procedure from your VBA. One big advantage here is that if you decide to rewrite your front end at some point in something other than Access all you have to do is call the same procedure and it will still do all the data work for you."}, {"owner": {"reputation": 235, "user_id": 1965279, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/iGHMq.png?s=128&g=1", "display_name": "Remo Williams", "link": "https://stackoverflow.com/users/1965279/remo-williams"}, "edited": false, "score": 0, "creation_date": 1517492685, "post_id": 48550220, "comment_id": 84124148, "body": "I had to spend a little time educating myself on passing access form names as parameters in VBA, but it worked great once I got it figured out.  Thanks a lot man!"}], "tags": [], "owner": {"reputation": 30515, "user_id": 3813116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DeWnw.png?s=128&g=1", "display_name": "Sean Lange", "link": "https://stackoverflow.com/users/3813116/sean-lange"}, "is_accepted": true, "score": 2, "last_activity_date": 1517437860, "last_edit_date": 1517437860, "creation_date": 1517427742, "answer_id": 48550220, "question_id": 48550021, "link": "https://stackoverflow.com/questions/48550021/access-vba-sql-3141-error/48550220#48550220", "title": "Access/VBA/SQL 3141 error", "body": "<p>Turning this into a stored procedure would reap many benefits. Your code is more manageable and you would start separating this into a data layer and application layer.</p>\n\n<p>Your code is far more complicated than it needs to be. There is no need for a temp table, just select the data you need in your insert statement. A much simplified version of this as a stored procedure would look something like this.</p>\n\n<pre class=\"lang-sql prettyprint-override\"><code>create procedure BUDGET_ACCESS_Data1_Insert\n(\n    @ProjectID int\n    , @SourceYear int\n    , @DestinationYear int\n) as begin\n\n    set nocount on;\n\n    INSERT INTO ACCTLive1.dbo.BUDGET_ACCESS_Data1\n    (\n        Column1\n        , Column2\n        , Total_Amt\n        , [Year]\n    )\n    SELECT Column1\n        , Column2\n        , Total_Amt * 1.02 --This is a simplified version. \n        , @DestinationYear\n    FROM ACCTLive1.dbo.BUDGET_ACCESS_Data1\n    WHERE Project_ID = @ProjectID\n        AND [Year] = @SourceYear\n\nend\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 235, "user_id": 1965279, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/iGHMq.png?s=128&g=1", "display_name": "Remo Williams", "link": "https://stackoverflow.com/users/1965279/remo-williams"}, "edited": false, "score": 0, "creation_date": 1517493206, "post_id": 48553342, "comment_id": 84124520, "body": "Hey, I really appreciate this information and it was no doubt the cause of the immediate issue.  I will use this info for future reference.  I gave the answer to Sean above, as he provided an elegant solution that worked successfully (and I already accepted it).  thanks again"}, {"owner": {"reputation": 11170, "user_id": 726127, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/TA0YX.jpg?s=128&g=1", "display_name": "Brad", "link": "https://stackoverflow.com/users/726127/brad"}, "reply_to_user": {"reputation": 235, "user_id": 1965279, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/iGHMq.png?s=128&g=1", "display_name": "Remo Williams", "link": "https://stackoverflow.com/users/1965279/remo-williams"}, "edited": false, "score": 0, "creation_date": 1517493362, "post_id": 48553342, "comment_id": 84124643, "body": "@RemoWilliams no problem. Good luck!"}], "tags": [], "owner": {"reputation": 11170, "user_id": 726127, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/TA0YX.jpg?s=128&g=1", "display_name": "Brad", "link": "https://stackoverflow.com/users/726127/brad"}, "is_accepted": false, "score": 1, "last_activity_date": 1517442695, "creation_date": 1517442695, "answer_id": 48553342, "question_id": 48550021, "link": "https://stackoverflow.com/questions/48550021/access-vba-sql-3141-error/48553342#48553342", "title": "Access/VBA/SQL 3141 error", "body": "<p>You're trying to do a <code>SELECT INTO</code>, and <code>UPDATE</code>, another <code>UPDATE</code>, and <code>INSERT</code> and a <code>DROP TABLE</code> on Access tables. And this executing in Access not SQL Server tables because <code>CurrentDb.Execute</code> runs against your accdb not whatever you may have linked (remember you can have any number of linked data sources so it's not making any guesses for you).</p>\n\n<p>Access will only process one statement at a time. Access also doesn't support <code>#Temp</code> tables. </p>\n\n<p>You can execute this in SQL Server as a Pass Through query using ADO and it'll work but you should parameterize it like other answers have suggested already. There are many ways to go about this (stored procedure, ADO pass through query, QueryDef pass through query).</p>\n"}], "owner": {"reputation": 235, "user_id": 1965279, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/iGHMq.png?s=128&g=1", "display_name": "Remo Williams", "link": "https://stackoverflow.com/users/1965279/remo-williams"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 247, "favorite_count": 0, "accepted_answer_id": 48550220, "answer_count": 2, "score": 0, "last_activity_date": 1517442695, "creation_date": 1517426977, "last_edit_date": 1517429274, "question_id": 48550021, "link": "https://stackoverflow.com/questions/48550021/access-vba-sql-3141-error", "title": "Access/VBA/SQL 3141 error", "body": "<p>I have an Access form tied to a linked SQL Server table, and I'm trying to create a utility within access that creates new records in the SQL Server database from existing records; those of which match criteria from three selections in the Access form.</p>\n\n<p>I'm not great with Access, SQL, or VBA, so that's cool, but here's what I have in VBA:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Dim strSQL As String\n\nstrSQL = _\n\"SELECT *\" _\n&amp; \" INTO #MyTempTable\" _\n&amp; \" FROM ACCTLive1.dbo.BUDGET_ACCESS_Data1\" _\n&amp; \" WHERE Project_ID = '\" &amp; Forms!Utilities!comboMoveProjIDPID &amp; \"' \" _\n&amp; \" AND [Year] = '\" &amp; Forms!Utilities!txtMoveProjIDSourceYear &amp; \"' \" _\n&amp; \" UPDATE #MyTempTable\" _\n&amp; \" SET [Year]  = '\" &amp; Forms!Utilities!txtMoveProjIDDestYear &amp; \"' \" _\n&amp; \" UPDATE #MyTempTable\" _\n&amp; \" SET Total_Amt = (([Total_Amt] * .02)+[Total_Amt])\" _\n&amp; \" INSERT INTO ACCTLive1.dbo.BUDGET_ACCESS_Data1\" _\n&amp; \" SELECT *\" _\n&amp; \" FROM #MyTempTable\" _\n&amp; \" DROP TABLE #MyTempTable\"\n\nCurrentDb.Execute strSQL, dbFailOnError\n</code></pre>\n\n<p>I get an error:</p>\n\n<blockquote>\n  <p>Run-time 3141 error: the SELECT statement includes a reserved word or an argument name that is misspelled or missing, or the punctuation is incorrect.</p>\n</blockquote>\n\n<p>I grabbed the SQL query from the Debug Watch, and ran it successfully from SSMS.</p>\n\n<p>I apologize ahead of time, as I know most of these 3141 issues are due to commas in the wrong place, etc, but the fact that the query works fine from SSMS leads me to believe I'm missing something else.</p>\n\n<p>Thank you!</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 2, "creation_date": 1517426231, "post_id": 48549698, "comment_id": 84095602, "body": "<i>labeled with the most recent date</i> - is there some logic that will determine what the most recent date is each time you run the code? like always end of previous month or something like that?"}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 1, "creation_date": 1517426251, "post_id": 48549698, "comment_id": 84095616, "body": "Do you have overlapping years in the same workbook?  If so, how do you tell which Day-Month worksheet is the latest?"}, {"owner": {"reputation": 11, "user_id": 9241349, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a0a2df44b1e16a7367b21da6f4b66ea?s=128&d=identicon&r=PG&f=1", "display_name": "TheBeige", "link": "https://stackoverflow.com/users/9241349/thebeige"}, "edited": false, "score": 0, "creation_date": 1517426821, "post_id": 48549698, "comment_id": 84095903, "body": "The years don&#39;t overlap. Each year the file starts fresh.  Scott is correct. The date labels are generally the last day of the previous month.  I will add an example."}], "answers": [{"comments": [{"owner": {"reputation": 1941, "user_id": 1267370, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/32MVo.jpg?s=128&g=1", "display_name": "mooseman", "link": "https://stackoverflow.com/users/1267370/mooseman"}, "edited": false, "score": 0, "creation_date": 1517433839, "post_id": 48550075, "comment_id": 84099520, "body": "Couldn&#39;t you just focus on the month?  Are there multiple sheets with the same month?"}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "reply_to_user": {"reputation": 1941, "user_id": 1267370, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/32MVo.jpg?s=128&g=1", "display_name": "mooseman", "link": "https://stackoverflow.com/users/1267370/mooseman"}, "edited": false, "score": 0, "creation_date": 1517449061, "post_id": 48550075, "comment_id": 84104531, "body": "@mooseman There are any number of methods to solve this problem which will work. Some require more assumptions than others on the structure of the workbook. Some require more complex coding.  My assumption was that the worksheet name looked like a date in <code>DM</code> type of format, and that all of the worksheets would have been generated for the same year (Jan to Dec). If you make other assumptions, you may be able to produce different code that will work as well or better. Post your answer with your assumptions and code."}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "reply_to_user": {"reputation": 1941, "user_id": 1267370, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/32MVo.jpg?s=128&g=1", "display_name": "mooseman", "link": "https://stackoverflow.com/users/1267370/mooseman"}, "edited": false, "score": 0, "creation_date": 1517449165, "post_id": 48550075, "comment_id": 84104561, "body": "@mooseman You could also assume that the sheets are ordered in such a way so that all you&#39;d have to do is loop backwards from the last sheet to the first that has a <code>DM</code> format.  Seems to me that might not be as robust a solution."}, {"owner": {"reputation": 1941, "user_id": 1267370, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/32MVo.jpg?s=128&g=1", "display_name": "mooseman", "link": "https://stackoverflow.com/users/1267370/mooseman"}, "edited": false, "score": 0, "creation_date": 1517495836, "post_id": 48550075, "comment_id": 84126418, "body": "The asker did say there is only 1 year and that each month a new sheet is added.  I don&#39;t believe I made any assumptions.  Just a simple question."}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "reply_to_user": {"reputation": 1941, "user_id": 1267370, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/32MVo.jpg?s=128&g=1", "display_name": "mooseman", "link": "https://stackoverflow.com/users/1267370/mooseman"}, "edited": false, "score": 0, "creation_date": 1517496513, "post_id": 48550075, "comment_id": 84126867, "body": "As I wrote above <i>There are any number of methods to solve this problem which will work</i>. And focusing just on the months is another method. But you are getting into opinions here, which is off-topic for SO. And since you have not presented your code, I cannot really comment on your approach. But I feel mine might be more robust, and will handle more potential user errors and/or misstatements in the original question. MIne might be easier to code, but without seeing your approach, hard to say for sure."}], "tags": [], "owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "is_accepted": false, "score": 0, "last_activity_date": 1517427212, "creation_date": 1517427212, "answer_id": 48550075, "question_id": 48549698, "link": "https://stackoverflow.com/questions/48549698/how-do-i-activate-an-excel-worksheet-that-has-a-date-label/48550075#48550075", "title": "How do I activate an Excel worksheet that has a date label", "body": "<p>To get the name of the worksheet with the latest date, given the constraint that all of the dates are within the same year, you can do something like the following:</p>\n\n<pre><code>Option Explicit\nSub LatestWorksheet()\n    Dim WB As Workbook, WS As Worksheet\n    Dim wsName As String\n\nSet WB = ThisWorkbook\nFor Each WS In WB.Worksheets\n    If IsDate(WS.Name) Then\n        If wsName = \"\" Then\n            wsName = WS.Name\n        ElseIf DateValue(WS.Name &amp; \" 2012\") &gt; DateValue(wsName &amp; \" 2012\") Then _\n            wsName = WS.Name\n        End If\n    End If\nNext WS\n\nDebug.Print wsName\n\nEnd Sub\n</code></pre>\n\n<p>Note that I fixed the year to 2012 in order to allow for <code>29 Feb</code>.  Otherwise it would alter the proper order.  Given the date/string, VBA would assume the current year.  If the file year were a leap year, and the current year was not, <code>29 Feb</code> would get converted in an undesired manner by the <code>DateValue</code> function.</p>\n"}, {"tags": [], "owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "is_accepted": false, "score": 1, "last_activity_date": 1517428918, "last_edit_date": 1517428918, "creation_date": 1517427214, "answer_id": 48550077, "question_id": 48549698, "link": "https://stackoverflow.com/questions/48549698/how-do-i-activate-an-excel-worksheet-that-has-a-date-label/48550077#48550077", "title": "How do I activate an Excel worksheet that has a date label", "body": "<p>You can use the <code>EOMonth</code> WorksheetFunction inside the VBA code to determine the last day of the previous month:</p>\n\n<pre><code>Dim lastMonth As Date\n\nlastMonth = WorksheetFunction.EoMonth(Date, -1)\nDebug.Print lastMonth\nDebug.Print Format(lastMonth, \"dd mmmm\")\n</code></pre>\n\n<p>Results:</p>\n\n<blockquote>\n  <p>12/31/2017<br>\n  31 December</p>\n</blockquote>\n\n<p>Then </p>\n\n<pre><code>If ws.Name = Format(lastMonth, \"dd mmmm\") Then\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 9241349, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a0a2df44b1e16a7367b21da6f4b66ea?s=128&d=identicon&r=PG&f=1", "display_name": "TheBeige", "link": "https://stackoverflow.com/users/9241349/thebeige"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 144, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1517433023, "creation_date": 1517425724, "last_edit_date": 1517433023, "question_id": 48549698, "link": "https://stackoverflow.com/questions/48549698/how-do-i-activate-an-excel-worksheet-that-has-a-date-label", "title": "How do I activate an Excel worksheet that has a date label", "body": "<p>favorite\nMy current macro pulls in multiple workbooks bringing in roughly 100 worksheets. The macro then filters and pulls in the data from 10 or 11 specific worksheets to create a new sheet with the data I need. Each of the 100 sheets has fairly unique names from \"DataFX GL Data\" to \"SAP_ALL_175031\".</p>\n\n<p>There is one file I am having a hard time selecting. It is labeled with a date. Each month a new sheet is added with a day and month (\"30 November\" for example). I am new to vba and am not certain where to begin so I only have an example of another sheet that I am selecting. How can I select the worksheet labeled with the most recent date?</p>\n\n<pre><code>Dim Deleterow As Long, EndRow As Long \nDim lRow As Variant \nDim rngRow As Range \nDim rngSelection As Range \n\nSet rngSelection = Range(\"A1\").CurrentRegion\n\nFor Each ws In ActiveWorkbook.Worksheets\n\n    With ws\n        If Left(ws.Name, 7) = \"Sheet 1\" Then\n            EndRow = LastRow(ws)\n\n            For Deleterow = EndRow To 2 Step -1\n\n                If .Cells(Deleterow, 9) = .Cells(Deleterow, 12) Then\n                    .Rows(Deleterow).EntireRow.Delete\n                End If\n            Next Deleterow\n        End If\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/58fb9.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/58fb9.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 0, "last_activity_date": 1517427978, "creation_date": 1517427978, "answer_id": 48550268, "question_id": 48549657, "link": "https://stackoverflow.com/questions/48549657/using-vba-cut-cell-text-and-format-with-double-click-then-paste-with-next-click/48550268#48550268", "title": "Using VBA cut cell text and format with double click then paste with next click", "body": "<p>You can delay the cut until the user selects another cell:</p>\n\n<pre><code>Option Explicit\n\nDim CutCell As Range\n\nPrivate Sub Worksheet_BeforeDoubleClick(ByVal Target As Range, Cancel As Boolean)\n\n    Cancel = True\n    Set CutCell = Target\n\nEnd Sub\n\nPrivate Sub Worksheet_SelectionChange(ByVal Target As Range)\n\n    If Not CutCell Is Nothing Then\n        CutCell.Cut Target.Cells(1) '&lt;&lt;&lt;in case of multi-cell selection...\n        Set CutCell = Nothing\n    End If\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 9296137, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b02c79cb900ebf5fa3606f73b5cf0861?s=128&d=identicon&r=PG&f=1", "display_name": "lswk95", "link": "https://stackoverflow.com/users/9296137/lswk95"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 119, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1517430813, "creation_date": 1517425558, "last_edit_date": 1517430813, "question_id": 48549657, "link": "https://stackoverflow.com/questions/48549657/using-vba-cut-cell-text-and-format-with-double-click-then-paste-with-next-click", "title": "Using VBA cut cell text and format with double click then paste with next click", "body": "<p>Trying to set up so a double click in a cell cuts text AND formatting and then a single click in another cell paste the cut text AND format.  Current code only paste un-formatted text into new cell.</p>\n\n<p>here is what I have now</p>\n\n<pre><code>    Option Explicit\n\n    Dim CutValue\n    Dim CutCell As Range\n\n    Private Sub Worksheet_BeforeDoubleClick(ByVal Target As Range, Cancel As Boolean)\n\n        Cancel = True\n        Target.Cut \n        CutValue = Target.Text\n        Set CutCell = Target\n\n    End Sub\n\n    Private Sub Worksheet_SelectionChange(ByVal Target As Range)\n\n        If Not IsEmpty(CutValue) Then\n            Target.FormulaR1C1 = CutValue\n            CutValue = Empty\n            CutCell.Clear\n        End If\n\n    End Sub\n</code></pre>\n\n<p>Big thanks for any help.</p>\n"}, {"tags": ["excel", "oledb", "vba"], "comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1517424249, "post_id": 48548720, "comment_id": 84094561, "body": "Why is it necessary <i>not</i> to open the file? Reason I ask is because there are ways to open a file without making it look like the file is being opened and it&#39;s much easier to do it with an open file. (I doubt it can even be done with an unopen one, but I am not 100% familar with all commands that work against a closed workbook)."}, {"owner": {"reputation": 327, "user_id": 1686416, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/30fb1c13d205be84512e9b502ddb0cd2?s=128&d=identicon&r=PG", "display_name": "Gabriel Caron L&#39;&#201;cuyer", "link": "https://stackoverflow.com/users/1686416/gabriel-caron-l%c3%89cuyer"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1517438803, "post_id": 48548720, "comment_id": 84101815, "body": "The time to open Excel and read the file is too long.  I am actually reading the file in Excel with Excel hidden (Application.Visible = False).  Once the file read, I save the information in a json file so it is faster to access the information after, but the firt-time opening of the Excel file is still too long."}], "owner": {"reputation": 327, "user_id": 1686416, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/30fb1c13d205be84512e9b502ddb0cd2?s=128&d=identicon&r=PG", "display_name": "Gabriel Caron L&#39;&#201;cuyer", "link": "https://stackoverflow.com/users/1686416/gabriel-caron-l%c3%89cuyer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 63, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1517422026, "creation_date": 1517422026, "last_edit_date": 1531161705, "question_id": 48548720, "link": "https://stackoverflow.com/questions/48548720/get-the-indentlevel-property-of-a-cell-in-excel-without-opening-the-file-in-exce", "title": "Get the IndentLevel property of a cell in Excel without opening the file in Excel", "body": "<p>Is it possible to retrieve the IndentLevel property of a cell in Excel without opening the file in Excel (using OleDB or an equivalent). If yes, how?  Thks.</p>\n"}, {"tags": ["c#", "sql-server", "vba", "excel"], "comments": [{"owner": {"reputation": 28373, "user_id": 5015238, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8790f8091d3c6c58fd45664a165117a?s=128&d=identicon&r=PG", "display_name": "jdweng", "link": "https://stackoverflow.com/users/5015238/jdweng"}, "edited": false, "score": 0, "creation_date": 1517421386, "post_id": 48548493, "comment_id": 84092940, "body": "Group the rows in VS then divide the groups so data fits on page."}, {"owner": {"reputation": 560, "user_id": 7434324, "user_type": "registered", "accept_rate": 58, "profile_image": "https://lh5.googleusercontent.com/-cqHPABYeCXw/AAAAAAAAAAI/AAAAAAAAAJI/lhW6nY2HJfc/photo.jpg?sz=128", "display_name": "Rama Krishna", "link": "https://stackoverflow.com/users/7434324/rama-krishna"}, "reply_to_user": {"reputation": 28373, "user_id": 5015238, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8790f8091d3c6c58fd45664a165117a?s=128&d=identicon&r=PG", "display_name": "jdweng", "link": "https://stackoverflow.com/users/5015238/jdweng"}, "edited": false, "score": 0, "creation_date": 1517421470, "post_id": 48548493, "comment_id": 84092995, "body": "I did&#39;t got your answer could you elaborate"}, {"owner": {"reputation": 4047, "user_id": 3246362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6da9a197d0f0e5f19875d8a97550e58e?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/3246362/sam"}, "edited": false, "score": 0, "creation_date": 1517421489, "post_id": 48548493, "comment_id": 84093004, "body": "You need an OLAP cube for that. Once you have that, Excel can show a pivot table."}, {"owner": {"reputation": 560, "user_id": 7434324, "user_type": "registered", "accept_rate": 58, "profile_image": "https://lh5.googleusercontent.com/-cqHPABYeCXw/AAAAAAAAAAI/AAAAAAAAAJI/lhW6nY2HJfc/photo.jpg?sz=128", "display_name": "Rama Krishna", "link": "https://stackoverflow.com/users/7434324/rama-krishna"}, "reply_to_user": {"reputation": 4047, "user_id": 3246362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6da9a197d0f0e5f19875d8a97550e58e?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/3246362/sam"}, "edited": false, "score": 0, "creation_date": 1517421550, "post_id": 48548493, "comment_id": 84093035, "body": "@Sam wow really? can you share the steps to do that?"}, {"owner": {"reputation": 28373, "user_id": 5015238, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8790f8091d3c6c58fd45664a165117a?s=128&d=identicon&r=PG", "display_name": "jdweng", "link": "https://stackoverflow.com/users/5015238/jdweng"}, "edited": false, "score": 0, "creation_date": 1517421667, "post_id": 48548493, "comment_id": 84093101, "body": "Pivot table pivots on data in certain columns.  So if you group the sql query results on same columns as the pivot you will be able to split the data into rows less than 1048756.  Then put each group(s) on a separate page in excel."}, {"owner": {"reputation": 4047, "user_id": 3246362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6da9a197d0f0e5f19875d8a97550e58e?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/3246362/sam"}, "edited": false, "score": 0, "creation_date": 1517421848, "post_id": 48548493, "comment_id": 84093226, "body": "OLAP cubes is something you need to study on your own. Too big to handle here."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 4047, "user_id": 3246362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6da9a197d0f0e5f19875d8a97550e58e?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/3246362/sam"}, "edited": false, "score": 0, "creation_date": 1517422643, "post_id": 48548493, "comment_id": 84093691, "body": "@Sam no, you don&#39;t <i>need</i> an OLAP cube for that."}, {"owner": {"reputation": 4047, "user_id": 3246362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6da9a197d0f0e5f19875d8a97550e58e?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/3246362/sam"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1517422807, "post_id": 48548493, "comment_id": 84093768, "body": "@Mat&#39;sMug True."}], "answers": [{"comments": [{"owner": {"reputation": 560, "user_id": 7434324, "user_type": "registered", "accept_rate": 58, "profile_image": "https://lh5.googleusercontent.com/-cqHPABYeCXw/AAAAAAAAAAI/AAAAAAAAAJI/lhW6nY2HJfc/photo.jpg?sz=128", "display_name": "Rama Krishna", "link": "https://stackoverflow.com/users/7434324/rama-krishna"}, "edited": false, "score": 0, "creation_date": 1517422827, "post_id": 48548753, "comment_id": 84093781, "body": "Can we give data source as C# Data Table?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 560, "user_id": 7434324, "user_type": "registered", "accept_rate": 58, "profile_image": "https://lh5.googleusercontent.com/-cqHPABYeCXw/AAAAAAAAAAI/AAAAAAAAAJI/lhW6nY2HJfc/photo.jpg?sz=128", "display_name": "Rama Krishna", "link": "https://stackoverflow.com/users/7434324/rama-krishna"}, "edited": false, "score": 1, "creation_date": 1517422975, "post_id": 48548753, "comment_id": 84093856, "body": "@RamaKrishna Excel doesn&#39;t speak C# or .NET, so no. But your <code>DataTable</code> came from somewhere - take that source and make it a view, then you can use C#/VSTO to do what you want, by translating the macro-recorder code from VBA to C# (which is well beyond the scope of your question BTW)"}], "tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": false, "score": 2, "last_activity_date": 1517422155, "creation_date": 1517422155, "answer_id": 48548753, "question_id": 48548493, "link": "https://stackoverflow.com/questions/48548493/programatically-creating-pivot-table-in-ms-excel-with-multiple-sheets-as-source/48548753#48548753", "title": "Programatically Creating Pivot Table in MS Excel With Multiple Sheets as Source Via C#", "body": "<p>If you have more than a million rows of data, that data doesn't belong in Excel - don't pivot off a <code>Range</code>, pivot off a <em>query</em> instead.</p>\n\n<p>You can easily get a pivot table to feed from a remote source instead of a range of cells.</p>\n\n<p>From the [Data] Ribbon tab, under the [Get External Data] group, select [From SQL Server] from the [From Other Sources] drop-down:</p>\n\n<p><img src=\"https://i.stack.imgur.com/Xe8Uu.png\" alt=\"Data - Get External Data - From Other Sources - From SQL Server\"></p>\n\n<p>Specify your connection details - you'll have a server-side <em>Table</em> or <em>View</em> that yields the records you want to pivot against.</p>\n\n<p>When the <em>Import Data</em> dialog comes up, select <strong>PivotTable Report</strong>:</p>\n\n<p><img src=\"https://i.stack.imgur.com/Uzpdq.png\" alt=\"&quot;Select how you want to view this data in your workbook&quot;\"></p>\n\n<p>The data now lives in the pivot cache, not on your worksheet.</p>\n\n<p>If you have an OLAP cube rather than a table or view, simply pick \"From Analysis Services\" instead of \"From SQL Server\" in the <em>From Other Sources</em> dropdown.</p>\n\n<p>Record a macro while doing this, to get code to do it programmatically.</p>\n"}], "owner": {"reputation": 560, "user_id": 7434324, "user_type": "registered", "accept_rate": 58, "profile_image": "https://lh5.googleusercontent.com/-cqHPABYeCXw/AAAAAAAAAAI/AAAAAAAAAJI/lhW6nY2HJfc/photo.jpg?sz=128", "display_name": "Rama Krishna", "link": "https://stackoverflow.com/users/7434324/rama-krishna"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 229, "favorite_count": 0, "closed_date": 1517451281, "answer_count": 1, "score": 0, "last_activity_date": 1517422155, "creation_date": 1517421160, "last_edit_date": 1517421219, "question_id": 48548493, "link": "https://stackoverflow.com/questions/48548493/programatically-creating-pivot-table-in-ms-excel-with-multiple-sheets-as-source", "closed_reason": "Needs more focus", "title": "Programatically Creating Pivot Table in MS Excel With Multiple Sheets as Source Via C#", "body": "<p>I have more than one million rows of data, I want to present that in in MS Excel as Pivot table.</p>\n\n<p>But MS Excel having 1048756 rows only, my data is exceeding sheet range.</p>\n\n<p>Is there any possibility to build pivot with data having more than one million records?</p>\n"}, {"tags": ["vba", "outlook"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1517424757, "post_id": 48548203, "comment_id": 84094836, "body": "<i>Everything works beautifully for a day or longer</i> - why? Try closing Outlook when you leave at night, and opening it when you come in the next morning."}, {"owner": {"reputation": 696, "user_id": 5749389, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/75ff2c8ee77dbdaf8bc6e9e63beb7527?s=128&d=identicon&r=PG&f=1", "display_name": "vknowles", "link": "https://stackoverflow.com/users/5749389/vknowles"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1517511409, "post_id": 48548203, "comment_id": 84136079, "body": "Actually, I used to have a good reason to keep Outlook open all the time. Let&#39;s pretend I still do. So closing and reopening Outlook would probably &quot;solve&quot; the problem in the same way that reassigning the <code>goSent</code> object in the <code>ItemSend</code> event handler would probably work. Neither one actually addresses the underlying issue."}, {"owner": {"reputation": 728, "user_id": 8769365, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7aad49df22335ea388301a2461640e0d?s=128&d=identicon&r=PG&f=1", "display_name": "Nacorid", "link": "https://stackoverflow.com/users/8769365/nacorid"}, "edited": false, "score": 0, "creation_date": 1550665323, "post_id": 48548203, "comment_id": 96350895, "body": "Could it possibly have something to do with losing connection to the Exchange Server for a few moments?"}, {"owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "edited": false, "score": 0, "creation_date": 1551119264, "post_id": 48548203, "comment_id": 96515145, "body": "Is that an online or a cached Exchange profile?"}], "answers": [{"comments": [{"owner": {"reputation": 696, "user_id": 5749389, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/75ff2c8ee77dbdaf8bc6e9e63beb7527?s=128&d=identicon&r=PG&f=1", "display_name": "vknowles", "link": "https://stackoverflow.com/users/5749389/vknowles"}, "edited": false, "score": 0, "creation_date": 1551452687, "post_id": 54865098, "comment_id": 96657302, "body": "Sounds like a brute-force solution to an intractable problem. Sometimes, that&#39;s all you can do."}, {"owner": {"reputation": 804, "user_id": 10933223, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b9e51ac9fe82cdffce787e5ae340a8c?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel", "link": "https://stackoverflow.com/users/10933223/daniel"}, "reply_to_user": {"reputation": 696, "user_id": 5749389, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/75ff2c8ee77dbdaf8bc6e9e63beb7527?s=128&d=identicon&r=PG&f=1", "display_name": "vknowles", "link": "https://stackoverflow.com/users/5749389/vknowles"}, "edited": false, "score": 0, "creation_date": 1551717038, "post_id": 54865098, "comment_id": 96732778, "body": "I agree it&#39;s not perfect and I&#39;m not happy with it, but it does the job. Hopefully you&#39;ll find better solution!"}], "tags": [], "owner": {"reputation": 804, "user_id": 10933223, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b9e51ac9fe82cdffce787e5ae340a8c?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel", "link": "https://stackoverflow.com/users/10933223/daniel"}, "is_accepted": false, "score": 1, "last_activity_date": 1551093704, "creation_date": 1551093704, "answer_id": 54865098, "question_id": 48548203, "link": "https://stackoverflow.com/questions/48548203/withevents-object-in-outlook-vba-eventually-fails-to-raise-event/54865098#54865098", "title": "WithEvents object in Outlook VBA eventually fails to raise event", "body": "<p>I had similar issue and never found a proper solution. What I did was I wrote a little batch script that closes and opens outlook app, then I set a task in task scheduler to run it every hour outside of my working hours. You can also do it easily in vbs.</p>\n"}], "owner": {"reputation": 696, "user_id": 5749389, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/75ff2c8ee77dbdaf8bc6e9e63beb7527?s=128&d=identicon&r=PG&f=1", "display_name": "vknowles", "link": "https://stackoverflow.com/users/5749389/vknowles"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 697, "favorite_count": 1, "answer_count": 1, "score": 6, "last_activity_date": 1592900862, "creation_date": 1517420060, "last_edit_date": 1592900862, "question_id": 48548203, "link": "https://stackoverflow.com/questions/48548203/withevents-object-in-outlook-vba-eventually-fails-to-raise-event", "title": "WithEvents object in Outlook VBA eventually fails to raise event", "body": "<p>Okay, looks like someone has encountered this problem before, but I didn't see any further comments or solutions. See the Edit in the accepted answer to <a href=\"https://stackoverflow.com/questions/34720620/problems-with-withevents-in-firtstrigger\">this question</a>.</p>\n\n<p>My situation is like this. </p>\n\n<p>I am running Outlook 2013 under Win10 x64 with an Exchange email account. I sometimes run Outlook for several days to a week or more at a time without closing it.</p>\n\n<p>I want to raise an event when a new item is added to the Sent Mail folder. This needs to occur after the <code>Application ItemSend</code> event because, let's say, I want to delete the message after it is sent, which you cannot do from within the <code>ItemSend</code> event handler.</p>\n\n<p>So I have the following code:</p>\n\n<pre><code>Public WithEvents goSent As Outlook.Items\n\nPrivate Sub Application_Startup()\n\n    'Establish the global object for the folder we want to monitor.\n\n    Set goSent = Session.GetDefaultFolder(olFolderSentMail).Items\n\nEnd Sub\n\nPrivate Sub goSent_ItemAdd(ByVal Item As Object)\n\n    'Do stuff here.\n\nEnd Sub\n</code></pre>\n\n<p>Everything works beautifully for a day or longer, but eventually the <code>ItemAdd</code> event handler stops firing. If I enter the VBA editor and manually run <code>Application_Startup</code>, then it starts working again.</p>\n\n<p>[Edit:] One other bit of information: The \"built-in\" events, like <code>Application ItemSend</code>, always seem to fire reliably no matter how long Outlook has been running.</p>\n\n<p>[Edit 2:] This time, I let things go for a day after the event stopped firing. I opened the VBA editor and put a breakpoint in the <code>Application ItemSend</code> procedure. When it stopped, I queried the <code>goSent</code> object and found that (a) it still existed (rather than being <code>Nothing</code>), but (b) it had only the items in it that were there yesterday, presumably at the time it became \"untethered\" from the Sent Mail items collection. When I submitted a new <code>Set</code> statement in the Immediate window, it immediately began to work again.</p>\n\n<p>[Edit 3:] I noticed that the MSDN documentation says to put event handlers for custom objects--like my <code>ItemAdd</code> event--in <em>class modules</em>. I have mine in ThisOutlookSession, but it was my understanding that ThisOutlookSession <em>is</em> a class module. Is there a problem with that?</p>\n\n<p>Any idea why this would happen and what to do about it? I considered adding an event handler for <code>Application ItemSend</code> and just reassigning the <code>goSent</code> object every time that's fired, but it doesn't address the underlying problem.</p>\n\n<p>[Edit 4:] For a while now, I've had a <code>Set</code> statement in the <code>Application ItemSend</code> handler, and that seems to have <em>mostly</em> taken care of things, even though it's a workaround, not really a solution. It appears to fail when I have delayed delivery on a sent item for an extended time, and I don't send any further messages in the meantime. Then the <code>goSent</code> object disconnects from the Sent Mail collection, and the message is actually sent from the Outbox after that point and before <code>Application ItemSend</code> fires again.</p>\n\n<p>Thanks!</p>\n\n<hr>\n\n<p>[Edit 5:] <strong>Unrelated to original issue:</strong> I discovered that my macros fail to accomplish what I want with an Exchange server that is in <em>online</em> mode (i.e., not cached mode) if I have messages in the Outbox with delayed delivery and Outlook is closed when the delivery time passes. In online mode, Exchange itself sends these messages and adds them to the Sent Mail folder on the server, so when Outlook reopens, the messages are already in the Sent Mail collection and no event fires. Which makes sense. See discussion <a href=\"https://social.technet.microsoft.com/Forums/exchange/en-US/7ced48f4-075d-4079-a050-d56cedab9440/message-will-not-send-if-outlook-is-closed-when-using-delay-delivery-option?forum=exchangesvrclientslegacy\" rel=\"nofollow noreferrer\">here</a>. Looks like I would need to add something to my <code>Application_Startup</code> macro to look for messages sent since Outlook last closed.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 824, "user_id": 5023092, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FNreo.png?s=128&g=1", "display_name": "Gordon K", "link": "https://stackoverflow.com/users/5023092/gordon-k"}, "edited": false, "score": 1, "creation_date": 1517420034, "post_id": 48548140, "comment_id": 84092221, "body": "The formula you are entering is incomplete. There is an open bracket after CONCATENATE, but no closing bracket."}, {"owner": {"reputation": 65, "user_id": 9226292, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d3e330dd3e73989c0297a31bed9d7b72?s=128&d=identicon&r=PG&f=1", "display_name": "J Doe", "link": "https://stackoverflow.com/users/9226292/j-doe"}, "reply_to_user": {"reputation": 824, "user_id": 5023092, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FNreo.png?s=128&g=1", "display_name": "Gordon K", "link": "https://stackoverflow.com/users/5023092/gordon-k"}, "edited": false, "score": 0, "creation_date": 1517420145, "post_id": 48548140, "comment_id": 84092285, "body": "@GordonK k woops.  fixed now!  the macro still won&#39;t work though."}, {"owner": {"reputation": 65, "user_id": 9226292, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d3e330dd3e73989c0297a31bed9d7b72?s=128&d=identicon&r=PG&f=1", "display_name": "J Doe", "link": "https://stackoverflow.com/users/9226292/j-doe"}, "reply_to_user": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "edited": false, "score": 0, "creation_date": 1517420485, "post_id": 48548140, "comment_id": 84092456, "body": "@pnuts I fixed the closing parenthesis but still come up with the same error even with Sam&#39;s fix below.  Any ideas maybe?"}, {"owner": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "edited": false, "score": 1, "creation_date": 1517420540, "post_id": 48548140, "comment_id": 84092482, "body": "<code>LastRow</code> is not declared"}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1517420982, "post_id": 48548140, "comment_id": 84092716, "body": "As Slai said - where is your <code>LastRow</code> value?"}, {"owner": {"reputation": 1941, "user_id": 1267370, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/32MVo.jpg?s=128&g=1", "display_name": "mooseman", "link": "https://stackoverflow.com/users/1267370/mooseman"}, "edited": false, "score": 0, "creation_date": 1517421132, "post_id": 48548140, "comment_id": 84092803, "body": "Your formula is incorrect, what should it look like in the cell?  what are G2 and H2?"}, {"owner": {"reputation": 65, "user_id": 9226292, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d3e330dd3e73989c0297a31bed9d7b72?s=128&d=identicon&r=PG&f=1", "display_name": "J Doe", "link": "https://stackoverflow.com/users/9226292/j-doe"}, "reply_to_user": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1517421281, "post_id": 48548140, "comment_id": 84092880, "body": "@dwirony I&#39;ve tried to declare the LastRow value but it seems to come up with another error - I&#39;m wondering if there&#39;s a better way to do this though.     Would you happen to know how to paste only if a value exists in Column H?"}, {"owner": {"reputation": 65, "user_id": 9226292, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d3e330dd3e73989c0297a31bed9d7b72?s=128&d=identicon&r=PG&f=1", "display_name": "J Doe", "link": "https://stackoverflow.com/users/9226292/j-doe"}, "reply_to_user": {"reputation": 1941, "user_id": 1267370, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/32MVo.jpg?s=128&g=1", "display_name": "mooseman", "link": "https://stackoverflow.com/users/1267370/mooseman"}, "edited": false, "score": 0, "creation_date": 1517421320, "post_id": 48548140, "comment_id": 84092902, "body": "@mooseman G2 and H2 have text values in them.  The formula should bring together the values of both cells with the addition of text &quot;Ck #&quot; in front."}, {"owner": {"reputation": 1941, "user_id": 1267370, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/32MVo.jpg?s=128&g=1", "display_name": "mooseman", "link": "https://stackoverflow.com/users/1267370/mooseman"}, "edited": false, "score": 0, "creation_date": 1517421698, "post_id": 48548140, "comment_id": 84093122, "body": "What column do you want the last row to be found?"}], "answers": [{"comments": [{"owner": {"reputation": 65, "user_id": 9226292, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d3e330dd3e73989c0297a31bed9d7b72?s=128&d=identicon&r=PG&f=1", "display_name": "J Doe", "link": "https://stackoverflow.com/users/9226292/j-doe"}, "edited": false, "score": 0, "creation_date": 1517420251, "post_id": 48548218, "comment_id": 84092348, "body": "Hmm...I did not know that.  I pasted in what you posted directly and it still seems to come up with the same error however. . I&#39;ll edit the main post to include my full code in case something is messing it up.  Debug shows that it is that specific line though."}, {"owner": {"reputation": 1941, "user_id": 1267370, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/32MVo.jpg?s=128&g=1", "display_name": "mooseman", "link": "https://stackoverflow.com/users/1267370/mooseman"}, "edited": false, "score": 0, "creation_date": 1517421651, "post_id": 48548218, "comment_id": 84093095, "body": "&quot;&quot; doesn&#39;t work in VBA to get a &quot;, Try &quot;=CONCATENATE(&quot; &amp; Chr(34) &amp; &quot;Ck #&quot; &amp; Chr(34) &amp; &quot;, G2,&quot; &amp; Chr(34) &amp; &quot; - &quot; &amp; Chr(34) &amp; &quot;, H2)&quot;"}, {"owner": {"reputation": 1941, "user_id": 1267370, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/32MVo.jpg?s=128&g=1", "display_name": "mooseman", "link": "https://stackoverflow.com/users/1267370/mooseman"}, "edited": false, "score": 0, "creation_date": 1517421955, "post_id": 48548218, "comment_id": 84093292, "body": "@Sam: Did you try your code?  I did and so did J Doe and it didn&#39;t work."}, {"owner": {"reputation": 4047, "user_id": 3246362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6da9a197d0f0e5f19875d8a97550e58e?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/3246362/sam"}, "edited": false, "score": 0, "creation_date": 1517422115, "post_id": 48548218, "comment_id": 84093406, "body": "Yes, I have tested it. It works. Try Debug.Print &quot;*&quot;&quot;*&quot;, which will print *&quot;*"}, {"owner": {"reputation": 1941, "user_id": 1267370, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/32MVo.jpg?s=128&g=1", "display_name": "mooseman", "link": "https://stackoverflow.com/users/1267370/mooseman"}, "edited": false, "score": 0, "creation_date": 1517422235, "post_id": 48548218, "comment_id": 84093481, "body": "That is 4 quotes in a row, your answer doesn&#39;t show that.  I prefer CHR(34) since you don&#39;t get problems with &quot;s"}, {"owner": {"reputation": 4047, "user_id": 3246362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6da9a197d0f0e5f19875d8a97550e58e?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/3246362/sam"}, "edited": false, "score": 0, "creation_date": 1517422419, "post_id": 48548218, "comment_id": 84093571, "body": "Oh my. That doesn&#39;t make it wrong. And yes - my answer shows exactly that. You need two quotes to end up with one."}, {"owner": {"reputation": 1941, "user_id": 1267370, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/32MVo.jpg?s=128&g=1", "display_name": "mooseman", "link": "https://stackoverflow.com/users/1267370/mooseman"}, "edited": false, "score": 0, "creation_date": 1517424562, "post_id": 48548218, "comment_id": 84094724, "body": "I does work now.  Not sure why it didn&#39;t before, but you did edit you comment from &quot;&quot;&quot;&quot; to &quot;<i>&quot;&quot;</i>&quot;, there are differences."}], "tags": [], "owner": {"reputation": 4047, "user_id": 3246362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6da9a197d0f0e5f19875d8a97550e58e?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/3246362/sam"}, "is_accepted": false, "score": 0, "last_activity_date": 1517420111, "creation_date": 1517420111, "answer_id": 48548218, "question_id": 48548140, "link": "https://stackoverflow.com/questions/48548140/pasting-a-formula-if-value-exists-in-range/48548218#48548218", "title": "Pasting a formula if value exists in range", "body": "<p>The problem is most likely your quotes in the text. They must be written as <code>\"\"</code> to result in <code>\"</code>. Something like this:</p>\n\n<pre><code>Range(\"I2:I\" &amp; LastRow).Formula = \"=CONCATENATE(\"\"Ck #\"\", G2,\"\" - \"\", H2)\"\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 65, "user_id": 9226292, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d3e330dd3e73989c0297a31bed9d7b72?s=128&d=identicon&r=PG&f=1", "display_name": "J Doe", "link": "https://stackoverflow.com/users/9226292/j-doe"}, "edited": false, "score": 0, "creation_date": 1517422598, "post_id": 48548785, "comment_id": 84093662, "body": "This is exactly what I wanted!!! Thank you SO much.  I was searching all over and mashing together code and editing my old code to see what would work and come back to this perfection.  Again, thank you so much!"}], "tags": [], "owner": {"reputation": 1941, "user_id": 1267370, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/32MVo.jpg?s=128&g=1", "display_name": "mooseman", "link": "https://stackoverflow.com/users/1267370/mooseman"}, "is_accepted": true, "score": 1, "last_activity_date": 1517422257, "creation_date": 1517422257, "answer_id": 48548785, "question_id": 48548140, "link": "https://stackoverflow.com/questions/48548140/pasting-a-formula-if-value-exists-in-range/48548785#48548785", "title": "Pasting a formula if value exists in range", "body": "<p>Here is what I think you want.  Last row calc is for column I, the one you are putting data, if not just change the letter  </p>\n\n<pre><code>  Sub prepn()\n\n    LastRow = Range(\"I\" &amp; Rows.Count).End(xlUp).Row\n    Columns(\"I:L\").Select\n    Selection.Insert Shift:=xlToRight, CopyOrigin:=xlFormatFromLeftOrAbove\n    Range(\"I1\").Value = \"Description\"\n    Range(\"J1\").Value = \"Co\"\n    Range(\"K1\").Value = \"Au\"\n    Range(\"L1\").Value = \"Acct\"\n    Range(\"M1\").Value = \"Comments\"\n    Range(\"I2:I\" &amp; LastRow).Formula = \"=CONCATENATE(\" &amp; Chr(34) &amp; \"Ck #\" &amp; Chr(34) &amp; \", G2,\" &amp; Chr(34) &amp; \" - \" &amp; Chr(34) &amp; \", H2)\"\n\nEnd Sub\n</code></pre>\n\n<p>With g2 = Here and H2 = Also\nyou get This in the cell\n=CONCATENATE(\"Ck #\", G2,\" - \", H2)</p>\n\n<p>I'm betting you don't want G2 and H2 for every cell, but that is another question.</p>\n"}], "owner": {"reputation": 65, "user_id": 9226292, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d3e330dd3e73989c0297a31bed9d7b72?s=128&d=identicon&r=PG&f=1", "display_name": "J Doe", "link": "https://stackoverflow.com/users/9226292/j-doe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 126, "favorite_count": 0, "accepted_answer_id": 48548785, "answer_count": 2, "score": 0, "last_activity_date": 1517422257, "creation_date": 1517419876, "last_edit_date": 1517420334, "question_id": 48548140, "link": "https://stackoverflow.com/questions/48548140/pasting-a-formula-if-value-exists-in-range", "title": "Pasting a formula if value exists in range", "body": "<p>I'm trying to create a macro that will paste a formula into column I if a value exists in column H. </p>\n\n<p>This piece of code is where I'm having problems.  When I run it, it says <code>Run-time error '1004': Method 'Range' of object '_Global' failed.</code>  I know this isn't the most efficient way of accomplishing what I want to do though.  It should only paste that formula if a value exists in column H rather than indiscriminately.  Does anyone know how to do this?</p>\n\n<pre><code>Range(\"I2:I\" &amp; LastRow).Formula = \"=CONCATENATE(\"\"Ck #\"\", G2,\"\" - \"\", H2)\"\n</code></pre>\n\n<hr>\n\n<p>Full code:</p>\n\n<pre><code>Sub prepn()\n\nColumns(\"I:L\").Select\nSelection.Insert Shift:=xlToRight, CopyOrigin:=xlFormatFromLeftOrAbove\nRange(\"I1\").Value = \"Description\"\nRange(\"J1\").Value = \"Co\"\nRange(\"K1\").Value = \"Au\"\nRange(\"L1\").Value = \"Acct\"\nRange(\"M1\").Value = \"Comments\"\nRange(\"I2:I\" &amp; LastRow).Formula = \"=CONCATENATE(\"\"Ck #\"\", G2,\"\" - \"\", H2)\"\nEnd Sub\n</code></pre>\n\n<p>Thank you in advance!</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1517420474, "post_id": 48548124, "comment_id": 84092453, "body": "Are you saying that <code>.NumberFormat = &quot;0000000&quot;</code> wont work in your situation?"}], "answers": [{"tags": [], "owner": {"reputation": 320, "user_id": 9283315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4938a0c001ae9de164c3af1915b13d24?s=128&d=identicon&r=PG", "display_name": "Tevildo", "link": "https://stackoverflow.com/users/9283315/tevildo"}, "is_accepted": true, "score": 2, "last_activity_date": 1517421116, "creation_date": 1517421116, "answer_id": 48548483, "question_id": 48548124, "link": "https://stackoverflow.com/questions/48548124/entering-a-formula-and-stop-a-number-string-loosing-the-first-0/48548483#48548483", "title": "Entering a formula and stop a (number) string loosing the first 0", "body": "<p>If the FDS function needs two string arguments (I'm guessing it's from the FactSet market tracker?), then just enclose the first argument in quotes; change your code to:</p>\n\n<pre><code>WS_Detailed.Cells(CPA_Row_Count, CPA_Column_Count).Offset(1, 0)_\n= \"=FDS(\" &amp; j &amp; Sedol_Check &amp; j &amp; \",\" &amp; j &amp; \"FG_Price(02/14/2017)\" &amp; j &amp; \")\"\n</code></pre>\n\n<p>You can also insert the quotes when you're building Sedol_Check.</p>\n"}], "owner": {"reputation": 83, "user_id": 6920869, "user_type": "registered", "profile_image": "https://graph.facebook.com/10157626562965249/picture?type=large", "display_name": "Jon Smith", "link": "https://stackoverflow.com/users/6920869/jon-smith"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 67, "favorite_count": 0, "accepted_answer_id": 48548483, "answer_count": 1, "score": 0, "last_activity_date": 1517424206, "creation_date": 1517419831, "last_edit_date": 1517420265, "question_id": 48548124, "link": "https://stackoverflow.com/questions/48548124/entering-a-formula-and-stop-a-number-string-loosing-the-first-0", "title": "Entering a formula and stop a (number) string loosing the first 0", "body": "<p>Hard to explain.</p>\n\n<p>I am aiming to write into a cell the following formula: <code>=FDS(0056650,\"FG_Price(02/14/2017)\")</code></p>\n\n<p>The formula works with a COM Add-in and returns a value. The number sequence and date are variables. When I enter this it will default the 0056650 to 556650 even though the string is 0056650.</p>\n\n<p>Code below, j = \" Sedol_check is a string.</p>\n\n<pre><code>WS_Detailed.Cells(CPA_Row_Count, CPA_Column_Count).Offset(1, 0)_\n= \"=FDS(\" &amp; Sedol_Check &amp; \",\" &amp; j &amp; \"FG_Price(02/14/2017)\" &amp; j &amp; \")\"\n</code></pre>\n\n<p>The COM add in won't work if the cell is formatted as text. Any ideas welcome.</p>\n\n<p>Thanks</p>\n"}, {"tags": ["excel", "excel-formula", "excel-2007", "vba"], "comments": [{"owner": {"reputation": 7497, "user_id": 8670372, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ir8a4Lbosmo/AAAAAAAAAAI/AAAAAAAAOtE/2eY5jK1atcc/photo.jpg?sz=128", "display_name": "Xabier", "link": "https://stackoverflow.com/users/8670372/xabier"}, "edited": false, "score": 0, "creation_date": 1517418797, "post_id": 48547712, "comment_id": 84091427, "body": "Why don&#39;t you simply add a counter in file A with an ID such as A001, then A002, etc... and do the same with the other file but instead of prefixing with A, prefix with B, so it would be B001, B002, etc..."}, {"owner": {"reputation": 1, "user_id": 8827518, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/db76d4302ee4c1aef4842ab8b648c956?s=128&d=identicon&r=PG&f=1", "display_name": "cczarnyy_", "link": "https://stackoverflow.com/users/8827518/cczarnyy"}, "reply_to_user": {"reputation": 7497, "user_id": 8670372, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ir8a4Lbosmo/AAAAAAAAAAI/AAAAAAAAOtE/2eY5jK1atcc/photo.jpg?sz=128", "display_name": "Xabier", "link": "https://stackoverflow.com/users/8670372/xabier"}, "edited": false, "score": 0, "creation_date": 1517419059, "post_id": 48547712, "comment_id": 84091587, "body": "It has to be automated. This file will be filled out by many people who do not cooperate with each other. They do not know what will be entered by other people so they will not know whether to use prefix A or B etc"}], "answers": [{"tags": [], "owner": {"reputation": 241, "user_id": 9164717, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3881b75ee2ec0fcc1728ca605235723a?s=128&d=identicon&r=PG&f=1", "display_name": "Chris ", "link": "https://stackoverflow.com/users/9164717/chris"}, "is_accepted": false, "score": 1, "last_activity_date": 1517418927, "creation_date": 1517418927, "answer_id": 48547829, "question_id": 48547712, "link": "https://stackoverflow.com/questions/48547712/unique-identifier-for-each-line-excel/48547829#48547829", "title": "Unique identifier for each line - excel", "body": "<p>Try this.</p>\n\n<pre><code>=CONCATENATE(DEC2HEX(RANDBETWEEN(0,4294967295),8),\"-\",DEC2HEX(RANDBETWEEN(0,65535),4),\"-\",DEC2HEX(RANDBETWEEN(16384,20479),4),\"-\",DEC2HEX(RANDBETWEEN(32768,49151),4),\"-\",DEC2HEX(RANDBETWEEN(0,65535),4),DEC2HEX(RANDBETWEEN(0,4294967295),8))\n</code></pre>\n\n<p>This a copy of <a href=\"https://stackoverflow.com/questions/7031347/how-can-i-generate-guids-in-excel\">How can I generate GUIDs in Excel?</a> with the semi colons replaced with commas.  What you are looking for is a Global Unique Identifier or GUID.  If you search for excel and GUID you can get a lot more options.</p>\n\n<p>If you want to be able to get a reference of the row and/or columns out of this so you can compare the two files, you can append </p>\n\n<pre><code>&amp; \"-\" &amp; ROW()&amp;COLUMN() \n</code></pre>\n\n<p>to the end of the above.  This will effectively give you and address of the row and column being referenced.</p>\n"}, {"tags": [], "owner": {"reputation": 7497, "user_id": 8670372, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ir8a4Lbosmo/AAAAAAAAAAI/AAAAAAAAOtE/2eY5jK1atcc/photo.jpg?sz=128", "display_name": "Xabier", "link": "https://stackoverflow.com/users/8670372/xabier"}, "is_accepted": false, "score": 0, "last_activity_date": 1517420253, "last_edit_date": 1517420253, "creation_date": 1517419288, "answer_id": 48547955, "question_id": 48547712, "link": "https://stackoverflow.com/questions/48547712/unique-identifier-for-each-line-excel/48547955#48547955", "title": "Unique identifier for each line - excel", "body": "<p>Not the most elegant way of doing things, but I believe this somewhat answers your question.</p>\n\n<p>If you can make sure that both files are Macro enabled, the user doesn't need to know how to prefix them, simply use something like below to add the ID to whatever column you want as new data is entered in column B in my example below:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\nDim ws As Worksheet: Set ws = Sheets(\"Sheet1\")\n'declare and set your worksheet, amend as required\nLastRow = ws.Cells(ws.Rows.Count, \"B\").End(xlUp).Row\n'get the last row with data on Column A\nIf Target.Address = \"$B$\" &amp; LastRow Then\n    For i = 2 To LastRow\n        ws.Cells(i, 1).Value = \"A\" &amp; Format(i, \"000\")\n    Next i\nEnd If\nEnd Sub\n</code></pre>\n\n<p>Do the same in the other file, just change the \"A\" to \"B\"</p>\n"}], "owner": {"reputation": 1, "user_id": 8827518, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/db76d4302ee4c1aef4842ab8b648c956?s=128&d=identicon&r=PG&f=1", "display_name": "cczarnyy_", "link": "https://stackoverflow.com/users/8827518/cczarnyy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5149, "favorite_count": 1, "answer_count": 2, "score": -2, "last_activity_date": 1517420253, "creation_date": 1517418533, "last_edit_date": 1531161705, "question_id": 48547712, "link": "https://stackoverflow.com/questions/48547712/unique-identifier-for-each-line-excel", "title": "Unique identifier for each line - excel", "body": "<p>I have a file in excel. For each line, I have to create a unique identifier. It must be created permanently. The problem is for example: I have the same files on computers A and B. I'm filling same lines in each file. But the identifiers of those lines should be different. Please help me. If you know how to do that please give me an example of macro or formula</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 17, "user_id": 9256279, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bc7e5dba802931ce21789ad40307717e?s=128&d=identicon&r=PG&f=1", "display_name": "chefman179", "link": "https://stackoverflow.com/users/9256279/chefman179"}, "edited": false, "score": 0, "creation_date": 1517420268, "post_id": 48547589, "comment_id": 84092354, "body": "Hi Sam, that&#39;s what I&#39;ve tried but I get Type Mismatch on the Set oBkRange"}, {"owner": {"reputation": 4047, "user_id": 3246362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6da9a197d0f0e5f19875d8a97550e58e?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/3246362/sam"}, "reply_to_user": {"reputation": 17, "user_id": 9256279, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bc7e5dba802931ce21789ad40307717e?s=128&d=identicon&r=PG&f=1", "display_name": "chefman179", "link": "https://stackoverflow.com/users/9256279/chefman179"}, "edited": false, "score": 0, "creation_date": 1517420715, "post_id": 48547589, "comment_id": 84092565, "body": "It might be a flaw in the logic. &quot;If Not Exists&quot; is follow by some code that relies on the bookmark to exist. Otherwise, I think your code is fine. I tried it and it works."}], "tags": [], "owner": {"reputation": 4047, "user_id": 3246362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6da9a197d0f0e5f19875d8a97550e58e?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/3246362/sam"}, "is_accepted": false, "score": 0, "last_activity_date": 1520945412, "last_edit_date": 1520945412, "creation_date": 1517418112, "answer_id": 48547589, "question_id": 48547392, "link": "https://stackoverflow.com/questions/48547392/pulling-the-name-of-a-word-bookmark-from-an-excel-range/48547589#48547589", "title": "Pulling the name of a Word bookmark from an excel range", "body": "<p>I'm not sure if I understand the question, but I'll give it a go.</p>\n\n<p>Let's put the bookmark name in cell A1. Then you pick it up like this:</p>\n\n<pre><code>BookmarkName = Worksheets(\"Text\").Range(\"A1\").Value\n</code></pre>\n\n<p>And then you use it in your references like this:</p>\n\n<pre><code>Set oBkmRange = oDocRange.Bookmarks(BookmarkName).Range\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 17, "user_id": 9256279, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bc7e5dba802931ce21789ad40307717e?s=128&d=identicon&r=PG&f=1", "display_name": "chefman179", "link": "https://stackoverflow.com/users/9256279/chefman179"}, "edited": false, "score": 0, "creation_date": 1517419770, "post_id": 48547641, "comment_id": 84092053, "body": "Hi Scott, deleted my previous comment as I was looking at a different file. This seems like it would work, however it doesn&#39;t actually paste into the word document."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "reply_to_user": {"reputation": 17, "user_id": 9256279, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bc7e5dba802931ce21789ad40307717e?s=128&d=identicon&r=PG&f=1", "display_name": "chefman179", "link": "https://stackoverflow.com/users/9256279/chefman179"}, "edited": false, "score": 0, "creation_date": 1517424077, "post_id": 48547641, "comment_id": 84094458, "body": "@chefman179 try <code>oBkmRange.Text = .Range(&quot;D&quot; + Cstr(i)).Value</code> in place of 3 lines in inner most if block. Not sure 100% on syntax but idea is to write the text straight to the bookmark. If that syntax is off, please google setting text in word bookmark via vba. There&#39;s a ton of stuff out there on it."}], "tags": [], "owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "is_accepted": false, "score": 0, "last_activity_date": 1520958387, "last_edit_date": 1520958387, "creation_date": 1517418292, "answer_id": 48547641, "question_id": 48547392, "link": "https://stackoverflow.com/questions/48547392/pulling-the-name-of-a-word-bookmark-from-an-excel-range/48547641#48547641", "title": "Pulling the name of a Word bookmark from an excel range", "body": "<p>Place the setting of the bookmark object inside the loop and assign it to the cell in column of row <em>i</em>.</p>\n\n<pre><code>Option Explicit\n\nSub pop()\n\n    Dim oWord As Word.Application\n    Dim oDoc As Document\n    Dim oDocRange As Word.Range\n    Dim oBkmRange As Word.Range\n\n    Set oWord = New Word.Application\n    Set oDoc = oWord.Documents.Open(\"C:\\Users\\doc.docx\", ReadOnly:=False)\n    Set oDocRange = oDoc.Content\n    oWord.Visible = True\n\n    Dim i As Integer\n\n    For i = 2 To 20\n\n        With Worksheets(\"Text\")\n\n            If .Range(\"B\" + CStr(i)).Value = \"Yes\" Then\n\n                Dim bookmarkName As String\n                bookmarkName = .Range(\"A\" + CStr(i)).Value\n\n                If Not oDoc.Bookmarks.Exists(bookmarkName) Then\n\n                    Set oBkmRange = oDocRange.Bookmarks(bookmarkName).Range\n\n                    .Range(\"D\" + CStr(i)).Copy\n\n                    oBkmRange.Collapse 0\n                    oBkmRange.PasteAndFormat (wdUseDestinationStylesRecovery)\n\n                End If\n\n            End If\n\n        End With\n\n    Next i\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 17, "user_id": 9256279, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bc7e5dba802931ce21789ad40307717e?s=128&d=identicon&r=PG&f=1", "display_name": "chefman179", "link": "https://stackoverflow.com/users/9256279/chefman179"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 193, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1520958387, "creation_date": 1517417563, "last_edit_date": 1520942944, "question_id": 48547392, "link": "https://stackoverflow.com/questions/48547392/pulling-the-name-of-a-word-bookmark-from-an-excel-range", "title": "Pulling the name of a Word bookmark from an excel range", "body": "<p>I'm currently working on something that users fill in on an excel sheet, press a button and it pushes the data to a bookmark in word.</p>\n\n<p>The script works fine, but currently I can only pass data to a location named manually in in VBA code, whereas I want to be able to look up the name of the bookmark from a cell in excel. Basically = IF there's a value in B copy the text in C to the word doc bookmark named in A.</p>\n\n<p>I'm not sure how to achieve this, code below for reference.</p>\n\n<pre><code>Sub pop()\n\nDim oWord As Word.Application\nDim oDoc As Document\nDim oDocRange As Word.Range\nDim oBkmRange As Word.Range\n\nSet oWord = New Word.Application\nSet oDoc = oWord.Documents.Open(\"C:\\Users\\doc.docx\", ReadOnly:=False)\nSet oDocRange = oDoc.Content\noWord.Visible = True\n\n\nDim i As Integer\n\n\nIf Not oDoc.Bookmarks.Exists(\"Bookmark_1\") Then\n    Exit Sub\nEnd If\n\nSet oBkmRange = oDocRange.Bookmarks(\"Bookmark_1\").Range\n\nFor i = 2 To 20\n    If Worksheets(\"Text\").Range(\"B\" + CStr(i)).Value = \"Yes\" Then\n        Worksheets(\"Text\").Range(\"D\" + CStr(i)).Copy\n        oBkmRange.Collapse 0  'WdCollapseDirection.wdCollapseEnd\n        oBkmRange.PasteAndFormat (wdUseDestinationStylesRecovery)\n    End If\nNext i\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["arrays", "excel", "array-formulas", "vba"], "answers": [{"comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 1, "creation_date": 1517417959, "post_id": 48547395, "comment_id": 84090874, "body": "No biggie but you could take out the <code>ws</code> references given the <code>With</code> is there."}, {"owner": {"reputation": 5324, "user_id": 8759927, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/B8ktI.jpg?s=128&g=1", "display_name": "shrivallabha.redij", "link": "https://stackoverflow.com/users/8759927/shrivallabha-redij"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 1, "creation_date": 1517418182, "post_id": 48547395, "comment_id": 84091031, "body": "@SJR the missing dot will give some unexpected results if activesheet is different so it is important in my opinion. Removing <code>ws</code> would be good. Have dropped them."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 1, "creation_date": 1517418246, "post_id": 48547395, "comment_id": 84091087, "body": "Yes, definitely agree that dot was an omission."}], "tags": [], "owner": {"reputation": 5324, "user_id": 8759927, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/B8ktI.jpg?s=128&g=1", "display_name": "shrivallabha.redij", "link": "https://stackoverflow.com/users/8759927/shrivallabha-redij"}, "is_accepted": true, "score": 2, "last_activity_date": 1517418238, "last_edit_date": 1517418238, "creation_date": 1517417566, "answer_id": 48547395, "question_id": 48547146, "link": "https://stackoverflow.com/questions/48547146/array-formula-via-vba-applied-to-blank-cells-giving-error/48547395#48547395", "title": "Array Formula VIa VBA Applied to Blank Cells GIving Error", "body": "<p>Your implementation of Array formula is incorrect and you have also not qualified the range reference correctly as preceding dot is missing.</p>\n\n<p><code>Range(\"CJ\" &amp; i).FormulaArray = \"=index(CJ1:CJ \"\"&amp; LastRow\"\",MATCH(1,INDEX((CL1:CL \"\"&amp; LastRow\"\" = CL \"\"&amp;i\"\")*(CJ1:CJ \"\"&amp; LastRow &lt;&gt;\"\"\"\"),0),0))\"\n</code></p>\n\n<p>Here's updated code which should work for you:</p>\n\n<pre><code>Sub ApplyArrayFormula()\n    Dim ws As Worksheet\n    Dim LastRow As Long\n    Dim i As Long\n\n    Set ws = Worksheets(\"Sheet1\")\n\n    With ws\n\n\n    LastRow = .Range(\"B\" &amp; Rows.Count).End(xlUp).Row\n\n\n        For i = 1 To LastRow\n            If .Range(\"CJ\" &amp; i).Value = \"\" Then\n                .Range(\"CJ\" &amp; i).FormulaArray = \"=INDEX($CJ$1:$CJ$\" &amp; LastRow &amp; \",MATCH(1,INDEX(($CL$1:$CL$\" &amp; LastRow &amp; \"=CL\" &amp; i &amp; \")*($CJ$1:$CJ$\" &amp; LastRow &amp; \"&lt;&gt;\"\"\"\"),0),0))\"\n            End If\n        Next i\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 294, "user_id": 6780162, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/d1072181e553658151be53bb2a0cf16d?s=128&d=identicon&r=PG&f=1", "display_name": "RugsKid", "link": "https://stackoverflow.com/users/6780162/rugskid"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 173, "favorite_count": 0, "accepted_answer_id": 48547395, "answer_count": 1, "score": 1, "last_activity_date": 1517418238, "creation_date": 1517416843, "last_edit_date": 1531161705, "question_id": 48547146, "link": "https://stackoverflow.com/questions/48547146/array-formula-via-vba-applied-to-blank-cells-giving-error", "title": "Array Formula VIa VBA Applied to Blank Cells GIving Error", "body": "<p>I have macro that is attempting to check a column to see if there are any blank cells.  In any blank cells I need to place an array formula.</p>\n\n<p>The array formula functions fine on sheet and it is:</p>\n\n<pre><code>=INDEX($CJ$1:$CJ$100,MATCH(1,INDEX(($CL$1:$CL$100=CL2)*($CJ$1:$CJ$100&lt;&gt;\"\"),0),0))\n</code></pre>\n\n<p>In the macro I cannot use fixed ranges so CJ100 and CL100 Need to be CL \"LastRow\" and CJ \"LastRow\" as the data ranges are dynamic.</p>\n\n<p>Thus far I have this code:</p>\n\n<pre><code>Dim ws as worksheet\n Dim LastRow as long\nDim i As Long\n\nset ws = worksheets(\"Sheet1\")\n\nWith ws\n\n\nLastRow = ws.Range(\"B\" &amp; rows.Count).End(xlUp).Row\n\n\nFor i = 1 To LastRow\n    If ws.Range(\"CJ\" &amp; i).Value = \"\" Then\n\n\nRange(\"CJ\" &amp; i).FormulaArray = \"=index(CJ1:CJ \"\"&amp; LastRow\"\",MATCH(1,INDEX((CL1:CL \"\"&amp; LastRow\"\" = CL \"\"&amp;i\"\")*(CJ1:CJ \"\"&amp; LastRow &lt;&gt;\"\"\"\"),0),0))\"\n\nEnd If\nNext i\nEnd With\n</code></pre>\n\n<p>I am getting an error on this line: <code>Range(\"CJ\" &amp; i).FormulaArray = \"=index(CJ1:CJ \"\"&amp; LastRow\"\",MATCH(1,INDEX((CL1:CL \"\"&amp; LastRow\"\" = CL \"\"&amp;i\"\")*(CJ1:CJ \"\"&amp; LastRow &lt;&gt;\"\"\"\"),0),0))\"</code></p>\n\n<p>The error is the dreaded \"Unable to set the FormulaArray property of the Range class\".</p>\n\n<p>After doing some research, it appeared that because I am applying to formula to one cell at a time, perhaps I do not need to use .FormulaArray  I change the problem line to use <code>.formula = \"-=....</code> but this resulted in a \"Application defined or object defined error\" message.</p>\n\n<p>Thinking the issue may be with my use of <code>range</code> I tried the following variation:</p>\n\n<pre><code>Dim LastRow as long\nDim ws as worksheet\n\nset ws = worksheets(\"Sheet1\")\n\nLastRow = ws.Range(\"B\" &amp; rows.Count).End(xlUp).Row\nSet rng = ws.Range(\"CJ2:CJ\" &amp; LastRow)\n\nFor Each cell In rng\n  'test value in column CJ\n   If cell.Value = \"\" Then\n        'inserts formula\ncell.FormulaArray = \"=index(CJ1:CJ \"\"&amp; LastRow\"\",MATCH(1,INDEX((CL1:CL \"\"&amp; LastRow\"\" = CL2)*(CJ1:CJ \"\"&amp; LastRow &lt;&gt;\"\"\"\"),0),0))\"\n'cell.arrayformula\n    End If\n Next\nEnd With\n</code></pre>\n\n<p>This results in the same Formula Array error as my code at the top of the post.</p>\n\n<p>I don't believe the formula is over 250 characters unless I am counting characters incorrectly?  Perhaps there is a syntax error somewhere?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 7497, "user_id": 8670372, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ir8a4Lbosmo/AAAAAAAAAAI/AAAAAAAAOtE/2eY5jK1atcc/photo.jpg?sz=128", "display_name": "Xabier", "link": "https://stackoverflow.com/users/8670372/xabier"}, "edited": false, "score": 3, "creation_date": 1517417328, "post_id": 48547128, "comment_id": 84090372, "body": "Where is the <code>With</code> to go with the <code>End With</code>? It might be worth sharing the rest of your code, as that&#39;s the only thing that pops up here..."}, {"owner": {"reputation": 136, "user_id": 4074875, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9903b480829907faba4011dfc1a1c147?s=128&d=identicon&r=PG", "display_name": "user4074875", "link": "https://stackoverflow.com/users/4074875/user4074875"}, "edited": false, "score": 0, "creation_date": 1517417991, "post_id": 48547128, "comment_id": 84090892, "body": "Is \\WFSIADMNSF21\\C_MTG_Groups\\DAPLAVA\\Monthly Vendor Files\\Pres\\ definitely a valid path?"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 2, "creation_date": 1517418464, "post_id": 48547128, "comment_id": 84091243, "body": "<i>I have 1500 lines of code between here</i> - time to refactor your code into small subroutines that are called as needed. Sounds like a <b>nightmare</b> to manage / troubleshoot (as you are experiencing)"}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1517418624, "post_id": 48547128, "comment_id": 84091328, "body": "You should also <b>Require Variable Declaration</b> (VBE Tools ~ Options ~ Editor tab).  This will place <code>Option Explicit</code> at the top of each new module you create and force you to declare variables beforehand - such as <code>FilePath</code>."}, {"owner": {"reputation": 1, "user_id": 8722014, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30fa40db6d9ae5328b89f2fe827dc7b8?s=128&d=identicon&r=PG&f=1", "display_name": "degeest12", "link": "https://stackoverflow.com/users/8722014/degeest12"}, "edited": false, "score": 1, "creation_date": 1517418856, "post_id": 48547128, "comment_id": 84091455, "body": "A refactor is probably the way to go. I was hoping there was some nuanced factor I was overlooking, but I guess not. Back to the drawing board, thanks for the posts."}, {"owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "edited": false, "score": 2, "creation_date": 1517419694, "post_id": 48547128, "comment_id": 84092010, "body": "This is why you should properly indent your code. It&#39;s not just there to make your code look pretty."}, {"owner": {"reputation": 1, "user_id": 8722014, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30fa40db6d9ae5328b89f2fe827dc7b8?s=128&d=identicon&r=PG&f=1", "display_name": "degeest12", "link": "https://stackoverflow.com/users/8722014/degeest12"}, "edited": false, "score": 0, "creation_date": 1517420106, "post_id": 48547128, "comment_id": 84092256, "body": "Which part of that was indented incorrectly?"}, {"owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "edited": false, "score": 0, "creation_date": 1517427055, "post_id": 48547128, "comment_id": 84096039, "body": "@degeest12 Well for starters, <code>End With</code> Is way to the left but it&#39;s between your <code>If..Then</code> statement. Also <code>wkb.Close</code> isn&#39;t indented within the same <code>If...Then</code> statement."}, {"owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "edited": false, "score": 2, "creation_date": 1517427419, "post_id": 48547128, "comment_id": 84096248, "body": "And why you even have 1500 lines of code within an IF statement is unknown to me. Once you figure out what is causing your issue then you should probably take your code to <a href=\"https://codereview.stackexchange.com\">Code Review</a>"}, {"owner": {"reputation": 1, "user_id": 8722014, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30fa40db6d9ae5328b89f2fe827dc7b8?s=128&d=identicon&r=PG&f=1", "display_name": "degeest12", "link": "https://stackoverflow.com/users/8722014/degeest12"}, "edited": false, "score": 0, "creation_date": 1517433753, "post_id": 48547128, "comment_id": 84099475, "body": "I don&#39;t think it&#39;s an indentation problem. The if statement is aligned. When I remove the function to test, I got an error for the &quot;Loop&quot; not being linked to &quot;Do&quot;, which is also aligned. The funny thing is I run a nearly identical macro, with just different file path and values, and it works fine."}], "owner": {"reputation": 1, "user_id": 8722014, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30fa40db6d9ae5328b89f2fe827dc7b8?s=128&d=identicon&r=PG&f=1", "display_name": "degeest12", "link": "https://stackoverflow.com/users/8722014/degeest12"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 50, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1517417942, "creation_date": 1517416798, "last_edit_date": 1531164843, "question_id": 48547128, "link": "https://stackoverflow.com/questions/48547128/compile-error-end-if-without-block-if-firing-despite-complete-block", "title": "Compile error: End if without block if - Firing despite complete block", "body": "<p>I have a macro that won't run due to an end if block error. As far as I can tell, the block is complete. When I do attempt to run, the Sub LoopThrough Directory() is highlighted as the error, and I'm not quite sure why.</p>\n\n<pre><code>Sub LoopThroughDirectory()\n\nDim MyFile As Variant\nDim wkb As Workbook\n\nFilepath = \"\\\\WFSIADMNSF21\\C_MTG_Groups\\DAPLAVA\\Monthly Vendor Files\\Pres\\\"\n\nMyFile = Dir(Filepath)\n\nDo While Len(MyFile) &gt; 0\n    If MyFile &lt;&gt; \"PFORMAT.xlsm\" Then\n        Application.DisplayAlerts = True\n        Set wkb = Workbooks.Open(Filepath &amp; MyFile)\n        Application.DisplayAlerts = False\n\n**I have 1500 lines of code between here, but no additional if statements, and nothing matches the indentation of the If statement**\n\n  End With\n    wkb.Close savechanges:=True\n    End If\n\n    MyFile = Dir\n\nLoop\nSheets(\"PFORMAT\").Select\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "loops", "foreach"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 2, "creation_date": 1517416692, "post_id": 48547013, "comment_id": 84089959, "body": "Poor indentation can easily lead to frustratingly hard-to-find compiler errors when nested control structures are involved. Try <a href=\"http://rubberduckvba.com/indentation\" rel=\"nofollow noreferrer\">Rubberduck&#39;s Smart Indenter</a> (disclaimer: I own this website and manage the OSS project it&#39;s for). Note that it will probably not work with the code you&#39;ve provided, since the <code>For</code> block is missing its <code>Next</code> token. Can you <a href=\"https://stackoverflow.com/posts/48547013/edit\">edit</a> your post to include the entire <code>For...Next</code> block?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1517417769, "post_id": 48547013, "comment_id": 84090717, "body": "Why do you want to do this with a <code>For Each</code> loop? Is it because you read somewhere that iterating object collections is faster with a <code>For Each</code> loop (it&#39;s true)? Note that using <code>Select</code> and <code>Activate</code> is likely defeating whatever gain you&#39;d get. The main issue I&#39;m seeing here is <code>Select</code> &amp; <code>Activate</code>, not <code>For...Next</code>."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 9295589, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ctRwoGvqRSc/AAAAAAAAAAI/AAAAAAAAABQ/9z6dvq8ZPns/photo.jpg?sz=128", "display_name": "Juanjo Pi&#241;a G", "link": "https://stackoverflow.com/users/9295589/juanjo-pi%c3%b1a-g"}, "edited": false, "score": 0, "creation_date": 1517692183, "post_id": 48547184, "comment_id": 84200715, "body": "Thank you for your help, I tried doing that however I am getting &quot;Object doestnt support this property or method&quot;  in this line  wsXE.Cells(raw2, 1).Paste, I tried to replace it with wsXE.Cells(raw2 + 1, 1).Select ActiveSheet.Paste but is not working either =("}, {"owner": {"reputation": 7497, "user_id": 8670372, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ir8a4Lbosmo/AAAAAAAAAAI/AAAAAAAAOtE/2eY5jK1atcc/photo.jpg?sz=128", "display_name": "Xabier", "link": "https://stackoverflow.com/users/8670372/xabier"}, "reply_to_user": {"reputation": 3, "user_id": 9295589, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ctRwoGvqRSc/AAAAAAAAAAI/AAAAAAAAABQ/9z6dvq8ZPns/photo.jpg?sz=128", "display_name": "Juanjo Pi&#241;a G", "link": "https://stackoverflow.com/users/9295589/juanjo-pi%c3%b1a-g"}, "edited": false, "score": 0, "creation_date": 1517702431, "post_id": 48547184, "comment_id": 84203377, "body": "@Juanjo please could you mark my response as an answer, if it has helped? Thank you :)"}, {"owner": {"reputation": 3, "user_id": 9295589, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ctRwoGvqRSc/AAAAAAAAAAI/AAAAAAAAABQ/9z6dvq8ZPns/photo.jpg?sz=128", "display_name": "Juanjo Pi&#241;a G", "link": "https://stackoverflow.com/users/9295589/juanjo-pi%c3%b1a-g"}, "edited": false, "score": 0, "creation_date": 1517937553, "post_id": 48547184, "comment_id": 84294608, "body": "Definitely, it was of great help"}, {"owner": {"reputation": 7497, "user_id": 8670372, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ir8a4Lbosmo/AAAAAAAAAAI/AAAAAAAAOtE/2eY5jK1atcc/photo.jpg?sz=128", "display_name": "Xabier", "link": "https://stackoverflow.com/users/8670372/xabier"}, "reply_to_user": {"reputation": 3, "user_id": 9295589, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ctRwoGvqRSc/AAAAAAAAAAI/AAAAAAAAABQ/9z6dvq8ZPns/photo.jpg?sz=128", "display_name": "Juanjo Pi&#241;a G", "link": "https://stackoverflow.com/users/9295589/juanjo-pi%c3%b1a-g"}, "edited": false, "score": 0, "creation_date": 1517937622, "post_id": 48547184, "comment_id": 84294637, "body": "@JuanjoPi&#241;aG Muchas gracias, yes it is marked now thanks! :)"}], "tags": [], "owner": {"reputation": 7497, "user_id": 8670372, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ir8a4Lbosmo/AAAAAAAAAAI/AAAAAAAAOtE/2eY5jK1atcc/photo.jpg?sz=128", "display_name": "Xabier", "link": "https://stackoverflow.com/users/8670372/xabier"}, "is_accepted": true, "score": 0, "last_activity_date": 1517698097, "last_edit_date": 1517698097, "creation_date": 1517416958, "answer_id": 48547184, "question_id": 48547013, "link": "https://stackoverflow.com/questions/48547013/vba-loop-enhancement/48547184#48547184", "title": "VBA loop enhancement", "body": "<p>How about doing it slightly differently:</p>\n\n<pre><code>Sub foo()\nDim wsRAW As Worksheet: Set wsRAW = Worksheets(\"RAW\")\nDim wsXE As Worksheet: Set wsXE = Worksheets(\"XE\")\n\nraw1 = wsRAW.Cells(wsRAW.Rows.Count, 1).End(xlUp).Row\n\nFor i = 4 To raw1\n    If wsRAW.Cells(i, 11).Value = \"True\" Then\n        wsRAW.Range(\"A\" &amp; i &amp; \":J\" &amp; i).Copy\n        raw2 = wsXE.Cells(wsXE.Rows.Count, 1).End(xlUp).Row + 1\n        wsXE.Range(\"A\" &amp; raw2).PasteSpecial xlPasteAll\n        Application.CutCopyMode = False\n    End If\nNext i\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 9295589, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ctRwoGvqRSc/AAAAAAAAAAI/AAAAAAAAABQ/9z6dvq8ZPns/photo.jpg?sz=128", "display_name": "Juanjo Pi&#241;a G", "link": "https://stackoverflow.com/users/9295589/juanjo-pi%c3%b1a-g"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 0, "accepted_answer_id": 48547184, "answer_count": 1, "score": 0, "last_activity_date": 1517698097, "creation_date": 1517416371, "last_edit_date": 1517416986, "question_id": 48547013, "link": "https://stackoverflow.com/questions/48547013/vba-loop-enhancement", "title": "VBA loop enhancement", "body": "<p>Got data from column A to K however I need to copy paste only from A to J to a specific sheet if the Column K = \"TRUE\" , is this possible with a For Each instead?</p>\n\n<pre><code>'if line contains XE copy to XE sheet\nraw1 = Worksheets(\"RAW\").Cells(Rows.Count, 1).End(xlUp).Row\nFor i = 4 To raw1\n    If Worksheets(\"RAW\").Cells(i, 11).Value = \"True\" Then\n    Worksheets(\"RAW\").Rows(i).Copy\n    Worksheets(\"XE\").Activate\n    raw2 = Worksheets(\"XE\").Cells(Rows.Count, 1).End(xlUp).Row\n    Worksheets(\"XE\").Cells(raw2 + 1, 1).Select\n    ActiveSheet.Paste\nEnd If\n</code></pre>\n\n<p>Thank you for you help </p>\n"}, {"tags": ["arrays", "excel", "vba"], "comments": [{"owner": {"reputation": 3791, "user_id": 6032547, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/e60a65e900f599301916e42e2ae043dd?s=128&d=identicon&r=PG&f=1", "display_name": "ryantxr", "link": "https://stackoverflow.com/users/6032547/ryantxr"}, "edited": false, "score": 1, "creation_date": 1517416300, "post_id": 48546793, "comment_id": 84089661, "body": "When asking a question, you will get more help if you provide an reproducible example that someone can actually try out on their own system."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1517417251, "post_id": 48546793, "comment_id": 84090331, "body": "This question needs a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>"}, {"owner": {"reputation": 1444, "user_id": 9122140, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6207fe125b0cbaefce70e98e5ce2c6f?s=128&d=identicon&r=PG&f=1", "display_name": "AcsErno", "link": "https://stackoverflow.com/users/9122140/acserno"}, "edited": false, "score": 0, "creation_date": 1517486721, "post_id": 48546793, "comment_id": 84120218, "body": "Check <code>frmTasks.LboxNames.ColumnCount </code>"}, {"owner": {"reputation": 11, "user_id": 9295488, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/214f4011b9088e7b24b44e1fe7344a45?s=128&d=identicon&r=PG&f=1", "display_name": "PaulZak", "link": "https://stackoverflow.com/users/9295488/paulzak"}, "edited": false, "score": 0, "creation_date": 1517507244, "post_id": 48546793, "comment_id": 84133860, "body": "Thanks for the replies. I thought this was a very simple question, not requiring any more detail.  It appears  Excel&#39;s max column count of 10 for listboxes might be setting the array column count at 9 always (0-9 = 10). So, I&#39;ve gone ahead and written looping code that set&#39;s array column count correctly (&lt; 9) to get this done."}], "owner": {"reputation": 11, "user_id": 9295488, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/214f4011b9088e7b24b44e1fe7344a45?s=128&d=identicon&r=PG&f=1", "display_name": "PaulZak", "link": "https://stackoverflow.com/users/9295488/paulzak"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 46, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1517507665, "creation_date": 1517415684, "last_edit_date": 1517507665, "question_id": 48546793, "link": "https://stackoverflow.com/questions/48546793/loading-userform-listbox-into-array", "title": "Loading userform listbox into array", "body": "<p>I've been using the following <em>brief</em> code to load a form's listbox values into an public array. </p>\n\n<p>Dim arrListboxContents as variant</p>\n\n<pre><code>arrListboxContents = frmTasks.LboxNames.list\n</code></pre>\n\n<p>(The listbox only contains 5 columns.)</p>\n\n<p>The above works and array contains listbox all values but, oddly, the array's column dimension defaults to 9 even though the listbox has only 5 columns. (The row count is correct, with no extras.)</p>\n\n<pre><code>Print Ubound(arrListboxContents,2) = 9 \n</code></pre>\n\n<p>I've tried adding <strong>Redim arrListboxContents (x,5)</strong> before loading it from listbox but after I load it and check array is still:</p>\n\n<p>Guess I'll have to return to code that loads array using a loop, which requires more lines of code. (I've done this many times so I know how to do it.)</p>\n\n<p>Just wondering why the array doesn't automatically match the list's column dimension. Anyone have any ideas???</p>\n"}, {"tags": ["excel", "excel-formula", "sumifs", "vba"], "comments": [{"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 2, "creation_date": 1517415917, "post_id": 48546607, "comment_id": 84089399, "body": "You may want to change the date from the <i>31st February</i>.  :)  Other than that you want it to then return the sum of 34+30 for the 31st and just 38 for the 30th?"}, {"owner": {"reputation": 2685, "user_id": 1523914, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/95939ded1fb2423fbe9ba7989a0006ab?s=128&d=identicon&r=PG", "display_name": "Excel Developers", "link": "https://stackoverflow.com/users/1523914/excel-developers"}, "edited": false, "score": 0, "creation_date": 1517416697, "post_id": 48546607, "comment_id": 84089961, "body": "Add an extra column on each sheet where you apply the IF condition, then sum that column across sheets."}, {"owner": {"reputation": 101, "user_id": 4704812, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/b162f37316b8b00f984b73f6eed7f79c?s=128&d=identicon&r=PG&f=1", "display_name": "Gabriel Dichev", "link": "https://stackoverflow.com/users/4704812/gabriel-dichev"}, "edited": false, "score": 0, "creation_date": 1517416703, "post_id": 48546607, "comment_id": 84089970, "body": "I need to get the SUM of 34+30(the totals) only if the date in their sheet is the same as the one I am providing. And thank you, I will change it to 31-Jan :D"}, {"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 0, "creation_date": 1517416724, "post_id": 48546607, "comment_id": 84089983, "body": "Your going to have sum up 20 sumifs like <code>=Sumif(Sheet1!C2:C100, D1, Sheet1!B2:B100) + Sumif(Sheet2!C2:C100, D1, Sheet2!B2:B100) + ...</code> Or have a sumif on each page that uses the one date then sum those up in your final tab. That, or you will have to write sum VBA, but.. that would get uglier than a good set of formulas to do this."}, {"owner": {"reputation": 101, "user_id": 4704812, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/b162f37316b8b00f984b73f6eed7f79c?s=128&d=identicon&r=PG&f=1", "display_name": "Gabriel Dichev", "link": "https://stackoverflow.com/users/4704812/gabriel-dichev"}, "reply_to_user": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 0, "creation_date": 1517416816, "post_id": 48546607, "comment_id": 84090034, "body": "@JNevill I have thought about that, but I am pretty sure there is an easier way"}, {"owner": {"reputation": 22957, "user_id": 78522, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3facb4a672d9fbeb9f2ed6b5acc65633?s=128&d=identicon&r=PG", "display_name": "Patrick Honorez", "link": "https://stackoverflow.com/users/78522/patrick-honorez"}, "edited": false, "score": 1, "creation_date": 1517416910, "post_id": 48546607, "comment_id": 84090102, "body": "You could consolidate your sheets using a Pivot Table that will be able to filter/group easily"}, {"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 0, "creation_date": 1517417456, "post_id": 48546607, "comment_id": 84090463, "body": "@GabrielDichev It&#39;s probable there is an easier way, but the rub is that a range that spans worksheets like <code>&#39;Sheet1:Sheet2&#39;!C1:C5</code> doesn&#39;t work in a <code>sumif</code>. Perhaps with an array formula using <code>=Sum(If())</code> although I can&#39;t get an array formula to work that has a range spanning multiple sheets i.e. <code>{=SUM(IF(Sheet1:Sheet2!$C$1:$C$3=D1, Sheet1:Sheet2!$B$1:$B$3, 0))}</code>"}], "answers": [{"tags": [], "owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "is_accepted": false, "score": 0, "last_activity_date": 1517418136, "last_edit_date": 1517418136, "creation_date": 1517417533, "answer_id": 48547380, "question_id": 48546607, "link": "https://stackoverflow.com/questions/48546607/microsoft-excel-sum-sheets-depending-on-date/48547380#48547380", "title": "Microsoft Excel SUM sheets depending on date", "body": "<p>As @ExcelDevelopers indicated you could have a calculation on each sheet and then used a 3D formula to sum them across the sheets.  </p>\n\n<p>Using your example sheets as a starting point I'd add a new sheet called something like <code>Results</code>. \nIn <code>B2</code> I type <code>Shoes</code> in <code>C2</code> I type <code>31/01/2018</code>.  </p>\n\n<p>Before your daily sheets I'd add a blank sheet called <code>Start</code> and after your last daily sheet I'd add a blank sheet called <code>End</code>.</p>\n\n<p>In cell D2 of each of the daily sheets I enter the formula: <code>=SUMIFS($B$2:$B$5,$A$2:$A$5,Results!$B$2,$C$2:$C$5,Results!$C$2)</code><br>\nThis will calculate the total for each day based on your criteria.  </p>\n\n<p>In the <code>Results</code> sheet I'd use the 3D formula <code>=SUM(Start:End!$D$2)</code> to sum each of the results from the daily sheets giving the final figure.</p>\n\n<p><strong>Edit:</strong> \nJust realised you're after the Totals and not specific items.<br>\nUse this formula for totals in cell D2 of each daily sheet:  <code>=SUMIF($C$2,Results!$C$2,$B$5)</code> </p>\n"}], "owner": {"reputation": 101, "user_id": 4704812, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/b162f37316b8b00f984b73f6eed7f79c?s=128&d=identicon&r=PG&f=1", "display_name": "Gabriel Dichev", "link": "https://stackoverflow.com/users/4704812/gabriel-dichev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 75, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1517418136, "creation_date": 1517415062, "last_edit_date": 1531161705, "question_id": 48546607, "link": "https://stackoverflow.com/questions/48546607/microsoft-excel-sum-sheets-depending-on-date", "title": "Microsoft Excel SUM sheets depending on date", "body": "<p>I am having a bit of a struggle with excel. I have a workbook with 20 sheets, that all have the same format and identical structure. I have a cell with a date and a table with stocks and their total. I need to SUM all the totals if the date of the cell in the sheet is today(or whatever date i would like). I have already tried with =SUMIF(Sheet1:Sheet!C2, D1(the date i set), Sheet1:Sheet3!B5) and couple of variatons of SUMIF but it keeps returning me #VALUE.</p>\n\n<p>Here is a data example:</p>\n\n<p>Sheet1:</p>\n\n<pre><code>|--|-----------|-----------|-----------|\n|--|     A     |    B      |    C      |\n|1 | Product   | Stock     |           |\n|--|-----------|-----------|-----------|\n|2 |    Shoes  |    34     |31-01-2018 |\n|--|-----------|-----------|-----------|\n|3 |    Hats   |    23     |           |\n|--|-----------|-----------|-----------|\n|4 |  Jackets  |    12     |           |\n|--|-----------|-----------|-----------|\n|5 |   Total   |    69     |           |\n|--|-----------|-----------|-----------|\n</code></pre>\n\n<p>Sheet2:</p>\n\n<pre><code>|--|-----------|-----------|-----------|\n|--|     A     |    B      |    C      |\n|1 | Product   | Stock     |           |\n|--|-----------|-----------|-----------|\n|2 |    Shoes  |    38     |30-01-2018 |\n|--|-----------|-----------|-----------|\n|3 |    Hats   |    25     |           |\n|--|-----------|-----------|-----------|\n|4 |  Jackets  |    16     |           |\n|--|-----------|-----------|-----------|\n|5 |   Total   |    79     |           |\n|--|-----------|-----------|-----------|\n</code></pre>\n\n<p>Sheet3:</p>\n\n<pre><code>|--|-----------|-----------|-----------|\n|--|     A     |    B      |    C      |\n|1 | Product   | Stock     |           |\n|--|-----------|-----------|-----------|\n|2 |    Shoes  |    30     |31-01-2018 |\n|--|-----------|-----------|-----------|\n|3 |    Hats   |    20     |           |\n|--|-----------|-----------|-----------|\n|4 |  Jackets  |    10     |           |\n|--|-----------|-----------|-----------|\n|5 |   Total   |    60     |           |\n|--|-----------|-----------|-----------|\n</code></pre>\n\n<p>May be I should mention that the C2s are date formatted.\nHow can I SUM the <strong>totals</strong> of Sheet1 and Sheet3 depending on the date 31-02-2018?\nI already searched a lot but no success. I am not sure if I am not using SUMIF properly or it's just not the right choice of formula. I would be grateful for any help. Thank you in advance! </p>\n"}, {"tags": ["html", "ms-access", "vba"], "answers": [{"comments": [{"owner": {"reputation": 111, "user_id": 6848927, "user_type": "registered", "accept_rate": 60, "profile_image": "https://lh3.googleusercontent.com/-DwZzRfmqMfI/AAAAAAAAAAI/AAAAAAAAAE0/924UWxjLuYA/photo.jpg?sz=128", "display_name": "Marten Onnink", "link": "https://stackoverflow.com/users/6848927/marten-onnink"}, "edited": false, "score": 0, "creation_date": 1517491256, "post_id": 48547359, "comment_id": 84123212, "body": "Hi Erik, the code you provided works. I had to change .Parent into .ParentElement. Thanks!"}, {"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "reply_to_user": {"reputation": 111, "user_id": 6848927, "user_type": "registered", "accept_rate": 60, "profile_image": "https://lh3.googleusercontent.com/-DwZzRfmqMfI/AAAAAAAAAAI/AAAAAAAAAE0/924UWxjLuYA/photo.jpg?sz=128", "display_name": "Marten Onnink", "link": "https://stackoverflow.com/users/6848927/marten-onnink"}, "edited": false, "score": 0, "creation_date": 1517493420, "post_id": 48547359, "comment_id": 84124684, "body": "That&#39;s somewhat strange. We must be using a different version of IE (I was working with IE11, and using <code>ShDocVw.InternetExplorer</code> with late binding instead of <code>CreateObject</code>). It certainly is <code>.Parent</code> for me. Documentation on IE automation is sparse, and there&#39;s a lot of version incompatibility, so it&#39;s mostly trial and error. Glad it worked."}], "tags": [], "owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "is_accepted": true, "score": 1, "last_activity_date": 1517420825, "last_edit_date": 1517420825, "creation_date": 1517417481, "answer_id": 48547359, "question_id": 48546469, "link": "https://stackoverflow.com/questions/48546469/extracting-data-from-website-using-vba/48547359#48547359", "title": "Extracting data from website using VBA", "body": "<p>Achieving this, starting from the <code>ProjectStatus_Label1</code>, will require some DOM navigation.</p>\n\n<p>Use the following:</p>\n\n<pre><code>Do While ieApp.Busy\n    DoEvents\nLoop\nSet labelSpan = ieApp.Document.getElementById(\"ProjectStatus_Label1\")\nSet tableHeader = labelSpan.Parent\nSet tableRow = tableHeader.Parent\nFor Each child In tableRow.Children\n    If child.tagName = \"TD\" 'This is the element you're looking for\n         Debug.Print child.innerText\n         Exit For\n    End If\nNext\n</code></pre>\n\n<p>Of course, I highly recommend you revise this code and use explicit declarations and <code>Option Explicit</code>, but you haven't in your question so I won't in my answer.</p>\n\n<p>Also, I've used a number of assignments (labelSpan, tableHeader) for demonstrative purposes. You can use <code>Set tableRow = ieApp.Document.getElementById(\"ProjectStatus_Label1\").Parent.Parent</code> and remove those other declarations.</p>\n\n<p>Or you can use the code-golfy, harder-to-understand approach, starting from the <em>ProjectStatus</em> div:</p>\n\n<pre><code>Debug.Print ieApp.Document.getElementById(\"ProjectStatus\").GetElementsByTagName(\"td\")(0).innerText\n</code></pre>\n"}], "owner": {"reputation": 111, "user_id": 6848927, "user_type": "registered", "accept_rate": 60, "profile_image": "https://lh3.googleusercontent.com/-DwZzRfmqMfI/AAAAAAAAAAI/AAAAAAAAAE0/924UWxjLuYA/photo.jpg?sz=128", "display_name": "Marten Onnink", "link": "https://stackoverflow.com/users/6848927/marten-onnink"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 57, "favorite_count": 0, "accepted_answer_id": 48547359, "answer_count": 1, "score": 1, "last_activity_date": 1594654256, "creation_date": 1517414661, "last_edit_date": 1594654256, "question_id": 48546469, "link": "https://stackoverflow.com/questions/48546469/extracting-data-from-website-using-vba", "title": "Extracting data from website using VBA", "body": "<p>I want to extract the projectstatus of a project which I can find on a website. See below for an example how the  html is parsed. I want to extract the text <strong>Start</strong> which is the text between td and /td. See below the html my code.</p>\n\n<pre><code> &lt;div id=\"ProjectStatus\"&gt;\n &lt;tr&gt;\n &lt;th&gt;\n &lt;span id=\"ProjectStatus_Label1\" title=\"De status van het project\"&gt;Projectstatus&lt;/span&gt;\n &lt;/th&gt;\n &lt;td&gt;Start&lt;/td&gt;\n &lt;/tr&gt;\n</code></pre>\n\n<p>Below you'll find the code that I have at this moment. This code only gives me the string \"Projectstatus\", which is not what I want. How can I extract the word \"Start\"?</p>\n\n<pre><code>Private Sub btnClick()\n\nDim ieApp As InternetExplorer\nSet ieApp = New InternetExplorer\nSet ieApp = CreateObject(\"internetexplorer.application\")\n\nWith ieApp\n .Navigate \"url\"\n .Visible = True\nEnd With\n\nDo While ieApp.Busy\n    DoEvents\nLoop \n\nSet getStatus = ieApp.Document.getElementById(\"ProjectStatus_Label1\")\n\nstrStatus = getStatus.innerText\n\nMsgBox (strStatus) 'gives met the text \"Projectstatus, but I need the text \"Start\"\n\nieApp.Quit\nSet ieApp = Nothing\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 2, "creation_date": 1517414524, "post_id": 48546303, "comment_id": 84088442, "body": "change <code>&amp; txt</code> to <code>&amp; .txt</code>. You forgot the <code>.</code>"}, {"owner": {"reputation": 36788, "user_id": 2887618, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e643417e67e5a3bb9f659e4491ed26b0?s=128&d=identicon&r=PG&f=1", "display_name": "Florent B.", "link": "https://stackoverflow.com/users/2887618/florent-b"}, "edited": false, "score": 1, "creation_date": 1517416103, "post_id": 48546303, "comment_id": 84089525, "body": "use <code>Environ$(&quot;USERPROFILE&quot;) &amp; &quot;\\Desktop</code> to get the desktop folder for the current user. To list all the environment variables, execute <code>set</code> in a cmd  console."}], "answers": [{"comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1517415622, "post_id": 48546389, "comment_id": 84089184, "body": "Kudos for the <code>Environ$</code> suggestion (well the whole answer actually)! I&#39;d even go as far as to recommend using <code>Environ$(&quot;temp&quot;)</code>, which gives a path to <code>C:\\Users\\(name)\\AppData\\Local\\Temp</code> (well at least on Win7 Pro), a much more appropriate place to store per-user temp files IMO."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1517416131, "post_id": 48546389, "comment_id": 84089542, "body": "Or if the path must be under <code>\\Desktop</code>, use <code>Environ$(&quot;userprofile&quot;)</code> to reliably get the <code>C:\\Users\\(name)</code> part."}, {"owner": {"reputation": 45, "user_id": 5548686, "user_type": "registered", "accept_rate": 88, "profile_image": "https://lh3.googleusercontent.com/-0FP7Y-hYg1E/AAAAAAAAAAI/AAAAAAAAAVc/4cjG6bCEZQY/photo.jpg?sz=128", "display_name": "saraguchi2316", "link": "https://stackoverflow.com/users/5548686/saraguchi2316"}, "edited": false, "score": 1, "creation_date": 1517425608, "post_id": 48546389, "comment_id": 84095289, "body": "The path was not the problem- I just removed the username for privacy purposes. Using most of what you said, I did <code>ActiveWorkbook.SaveAs Filename:= _     &quot;C:\\Users\\swall\\Desktop\\Temp\\File&quot; &amp; _      Format$(DateAdd(&quot;d&quot;, 2, Date), &quot;mdyy&quot;) &amp; &quot;.txt&quot; _     , FileFormat:=xlText, CreateBackup:=False</code> and it worked beautifully!"}], "tags": [], "owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "is_accepted": true, "score": 2, "last_activity_date": 1517415823, "last_edit_date": 1517415823, "creation_date": 1517414461, "answer_id": 48546389, "question_id": 48546303, "link": "https://stackoverflow.com/questions/48546303/automatically-save-file-as-text-with-fridays-date/48546389#48546389", "title": "Automatically Save File as Text With Friday&#39;s Date", "body": "<p>Does the <code>C:\\Users\\username</code> folder actually exist? You will probably have to change <code>username</code> to your own username, or use <code>Environ$(\"Username\")</code> like this:</p>\n\n<pre><code>\"C:\\Users\\\" &amp; Environ$(\"Username\") &amp; \"\\Desktop\\Temp\\File\" \n</code></pre>\n\n<p>And make sure the folder exists too, or you will get another error.</p>\n\n<p>Also, use <code>DateAdd()</code> to add days:</p>\n\n<pre><code>NewDate = DateAdd(\"d\", 2, Date)\n</code></pre>\n\n<p>And <code>Format$()</code> to format it (<code>Text()</code> is more of a worksheet function)</p>\n\n<p>Once completed, you end up with this:</p>\n\n<pre><code>ActiveWorkbook.SaveAs Filename:= _\n    \"C:\\Users\\\" &amp; Environ$(\"Username\") &amp; \"\\Desktop\\Temp\\File\" &amp; _\n     Format$(DateAdd(\"d\", 2, Date), \"mdyy\") &amp; \".txt\" _\n    , FileFormat:=xlText, CreateBackup:=False\n</code></pre>\n"}], "owner": {"reputation": 45, "user_id": 5548686, "user_type": "registered", "accept_rate": 88, "profile_image": "https://lh3.googleusercontent.com/-0FP7Y-hYg1E/AAAAAAAAAAI/AAAAAAAAAVc/4cjG6bCEZQY/photo.jpg?sz=128", "display_name": "saraguchi2316", "link": "https://stackoverflow.com/users/5548686/saraguchi2316"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 98, "favorite_count": 1, "accepted_answer_id": 48546389, "answer_count": 1, "score": 0, "last_activity_date": 1517417926, "creation_date": 1517414220, "last_edit_date": 1517417926, "question_id": 48546303, "link": "https://stackoverflow.com/questions/48546303/automatically-save-file-as-text-with-fridays-date", "title": "Automatically Save File as Text With Friday&#39;s Date", "body": "<p>I recorded a macro that at the end saves the workbook as a text file and closes.</p>\n\n<p>I would like to change the file name to Friday's date so that every week when I save it, the file name is different.</p>\n\n<p>This is what the macro recorded</p>\n\n<pre><code>ActiveWorkbook.SaveAs Filename:= _\n    \"C:\\Users\\username\\Desktop\\Temp\\\\File2218.txt\" _\n    , FileFormat:=xlText, CreateBackup:=False\n</code></pre>\n\n<p>I tried to change it to </p>\n\n<pre><code>ActiveWorkbook.SaveAs Filename:= _\n    \"C:\\Users\\username\\Desktop\\Temp\\File\" &amp; Text(Today()+2, \"mdyy\")&amp; txt\" _\n    , FileFormat:=xlText, CreateBackup:=False\n</code></pre>\n\n<p>(The reason I did +2 is because it's always done one Wed, therefore +2 = Friday)</p>\n\n<p>But it doesn't work.</p>\n\n<p>Any help would be greatly appreciated!</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 7265593, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/3e3b8c902311c48d11edb819ed01dd71?s=128&d=identicon&r=PG&f=1", "display_name": "Shin", "link": "https://stackoverflow.com/users/7265593/shin"}, "edited": false, "score": 0, "creation_date": 1517414688, "post_id": 48546320, "comment_id": 84088560, "body": "Thanks so much looks like I had that extra bit that was unnecessary and throwing the error"}, {"owner": {"reputation": 7497, "user_id": 8670372, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ir8a4Lbosmo/AAAAAAAAAAI/AAAAAAAAOtE/2eY5jK1atcc/photo.jpg?sz=128", "display_name": "Xabier", "link": "https://stackoverflow.com/users/8670372/xabier"}, "edited": false, "score": 1, "creation_date": 1517414722, "post_id": 48546320, "comment_id": 84088585, "body": "I think this will paste over the last row on column Z, shouldn&#39;t you offset the New_Last to the next row when pasting? Like in my answer below..."}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "reply_to_user": {"reputation": 7497, "user_id": 8670372, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ir8a4Lbosmo/AAAAAAAAAAI/AAAAAAAAOtE/2eY5jK1atcc/photo.jpg?sz=128", "display_name": "Xabier", "link": "https://stackoverflow.com/users/8670372/xabier"}, "edited": false, "score": 0, "creation_date": 1517429753, "post_id": 48546320, "comment_id": 84097430, "body": "@Xabier Great catch, I forgot the +1 after New_Last."}, {"owner": {"reputation": 33, "user_id": 7265593, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/3e3b8c902311c48d11edb819ed01dd71?s=128&d=identicon&r=PG&f=1", "display_name": "Shin", "link": "https://stackoverflow.com/users/7265593/shin"}, "reply_to_user": {"reputation": 7497, "user_id": 8670372, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ir8a4Lbosmo/AAAAAAAAAAI/AAAAAAAAOtE/2eY5jK1atcc/photo.jpg?sz=128", "display_name": "Xabier", "link": "https://stackoverflow.com/users/8670372/xabier"}, "edited": false, "score": 0, "creation_date": 1517434905, "post_id": 48546320, "comment_id": 84100056, "body": "Oh correct, yes I noticed after you shared your Cyril, and just added that myself. Thanks @Xabier"}], "tags": [], "owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "is_accepted": true, "score": 0, "last_activity_date": 1517429730, "last_edit_date": 1517429730, "creation_date": 1517414260, "answer_id": 48546320, "question_id": 48546141, "link": "https://stackoverflow.com/questions/48546141/copy-and-pasting-within-same-column/48546320#48546320", "title": "Copy and pasting within same column", "body": "<p>I believe you've an issue with coping setting a range, but not using it; you have a \"selection\" copy, which may be outside of the range of the selection, e.g., selected 50 rows, but have specified to paste into 40 rows.</p>\n\n<p>You also have the issue that you have Z1:Z&amp;new_last pasting to Z2:Z&amp;new_last, which is the same issue.</p>\n\n<pre><code>With Sheets(\"Project\")\n    Set myRng = .Range(\"Z2:Z\" &amp; New_Last) \n    myRng.Copy .Range(\"Z\" &amp; New_Last + 1)\nEnd With\n</code></pre>\n\n<p>Simplified that you are just coping and pasting to a defined range; you can have a simple cell location to paste to and it will fill to the final row.</p>\n"}, {"tags": [], "owner": {"reputation": 7497, "user_id": 8670372, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ir8a4Lbosmo/AAAAAAAAAAI/AAAAAAAAOtE/2eY5jK1atcc/photo.jpg?sz=128", "display_name": "Xabier", "link": "https://stackoverflow.com/users/8670372/xabier"}, "is_accepted": false, "score": 1, "last_activity_date": 1517414669, "creation_date": 1517414669, "answer_id": 48546473, "question_id": 48546141, "link": "https://stackoverflow.com/questions/48546141/copy-and-pasting-within-same-column/48546473#48546473", "title": "Copy and pasting within same column", "body": "<p>I believe this is what you want:</p>\n\n<pre><code>Dim New_Last As Long, myRng As Range\nNew_Last = Sheets(\"Project\").UsedRange.Rows.Count\n\nWith Sheets(\"Project\")\n    Set myRng = .Range(\"Z2:Z\" &amp; New_Last)\n    myRng.Copy Range(\"Z\" &amp; New_Last + 1)\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 7265593, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/3e3b8c902311c48d11edb819ed01dd71?s=128&d=identicon&r=PG&f=1", "display_name": "Shin", "link": "https://stackoverflow.com/users/7265593/shin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 42, "favorite_count": 0, "accepted_answer_id": 48546320, "answer_count": 2, "score": 0, "last_activity_date": 1517429730, "creation_date": 1517413724, "last_edit_date": 1517414500, "question_id": 48546141, "link": "https://stackoverflow.com/questions/48546141/copy-and-pasting-within-same-column", "title": "Copy and pasting within same column", "body": "<p>I'm currently having difficulty copying the contents of a column and pasting it at the end of the same column. For example, if the column contents are red, orange, blue, green, purple in cells C1:C5 respectively, I'd like rows C6:C10 to have the same contents red, orange, blue, green and purple respectively. I'm having trouble doing so with the following code with an error saying </p>\n\n<blockquote>\n  <p>this object does not support this property or method</p>\n</blockquote>\n\n<p>. Any help would be much appreciated!</p>\n\n<pre><code>Dim New_Last As Long, myRng As Range\nNew_Last = Sheets(\"Project\").UsedRange.Rows.Count\n\nWith Sheets(\"Project\")\n    Set myRng = Sheets(\"Project\").Range(\"Z2:Z\" &amp; New_Last)\n    Selection.Copy Range(\"z2:z\" &amp; New_Last)\n    Selection.Copy\n    Selection.Offset(New_Last, 0).Paste\nEnd With\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "edited": false, "score": 4, "creation_date": 1517413781, "post_id": 48546058, "comment_id": 84087886, "body": "VBA is unnecessary. Use data validation."}, {"owner": {"reputation": 1036, "user_id": 1992793, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d80078958a2b15908d308fb52b16147d?s=128&d=identicon&r=PG", "display_name": "JohnRC", "link": "https://stackoverflow.com/users/1992793/johnrc"}, "edited": false, "score": 2, "creation_date": 1517415651, "post_id": 48546058, "comment_id": 84089205, "body": "Looks to me like you have a missing <code>End If</code> and <code>Next Revisioncell</code> after the Else statement. In fact you could remove the Else statement as there is nothing to do in that case. Also, I would do <code>If Lcase(Revisioncell) = &quot;latest&quot;</code> to avoid having to check different cases. You don&#39;t need to use <code>like</code> unless you are checking for partial content of a string."}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user9272092"}, "edited": false, "score": 0, "creation_date": 1517414224, "post_id": 48546192, "comment_id": 84088219, "body": "Oh awesome thanks - don&#39;t need the VBA. Although I would still be interested to see how to solve it using VBA"}, {"owner": {"reputation": 43423, "user_id": 1011724, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/2JAXi.jpg?s=128&g=1", "display_name": "Dan", "link": "https://stackoverflow.com/users/1011724/dan"}, "edited": false, "score": 1, "creation_date": 1517414495, "post_id": 48546192, "comment_id": 84088421, "body": "@AaronGretton Try do what I have described above with the macro recorder turn on..."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1517415848, "post_id": 48546192, "comment_id": 84089342, "body": "Not sure why this was downvoted. Data validation is <i>the</i> single simplest and most idiomatic way to prevent invalid user input in a cell. How to programmatically implement data validation is well documented already, both here and literally everywhere on the Internet. Search, you&#39;ll find."}, {"owner": {"reputation": 1036, "user_id": 1992793, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d80078958a2b15908d308fb52b16147d?s=128&d=identicon&r=PG", "display_name": "JohnRC", "link": "https://stackoverflow.com/users/1992793/johnrc"}, "edited": false, "score": 0, "creation_date": 1517416310, "post_id": 48546192, "comment_id": 84089668, "body": "@MatsMug I agree this looks like a good approach. It also handles upper/lower/mixed case text. You can also enter your own validation error message such as &#39;You cannot enter &quot;Latest&quot; here&#39;"}], "tags": [], "owner": {"reputation": 43423, "user_id": 1011724, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/2JAXi.jpg?s=128&g=1", "display_name": "Dan", "link": "https://stackoverflow.com/users/1011724/dan"}, "is_accepted": false, "score": 2, "last_activity_date": 1517414465, "last_edit_date": 1517414465, "creation_date": 1517413854, "answer_id": 48546192, "question_id": 48546058, "link": "https://stackoverflow.com/questions/48546058/how-to-prevent-the-input-of-a-specfic-value-into-a-cell/48546192#48546192", "title": "How to prevent the input of a specfic value into a cell", "body": "<p>You can do this without VBA. Under the Data tab on the ribbon chose Data Validation, then choose custom from the drop down and set the formula to (replace <code>M3</code> with the first cell in your selection):</p>\n\n<pre><code>=M3&lt;&gt;\"latest\"\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user9272092"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 42, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1517414465, "creation_date": 1517413501, "question_id": 48546058, "link": "https://stackoverflow.com/questions/48546058/how-to-prevent-the-input-of-a-specfic-value-into-a-cell", "title": "How to prevent the input of a specfic value into a cell", "body": "<p>I'm trying to prevent the input of a specific value (text saying \"latest\") in a column but the code I've got doesn't seem to be functioning, any help would be appreciated, thanks.</p>\n\n<pre><code>Private Sub RevisionInput()\n    Dim Revision As Range\n    Dim Revisioncell As Range\n    Set Revision = Range(\"M3:M500\")\n    For Each Revisioncell In Revision\n    If Revisioncell Like \"Latest\" Or Revsioncell Like \"LATEST\" Or Revisioncell Like \"latest\" Then\n\n\nMsgBox \"Please input correct revision or if one is not available,\" &amp; _\n\" Please type 'To be confirmed'\"\nApplication.EnableEvents = False\nApplication.Undo\nApplication.EnableEvents = True\n\nElse\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 3762, "user_id": 1392490, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8abc9ba3fc894ddce9e4da8f579fc9f4?s=128&d=identicon&r=PG", "display_name": "rollstuhlfahrer", "link": "https://stackoverflow.com/users/1392490/rollstuhlfahrer"}, "edited": false, "score": 1, "creation_date": 1517415051, "post_id": 48545976, "comment_id": 84088796, "body": "What happens? Have you stepped through the function using the debugger?"}], "answers": [{"comments": [{"owner": {"reputation": 51, "user_id": 9295300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/379a83e73aae367cc563d2cc2b71f807?s=128&d=identicon&r=PG&f=1", "display_name": "Ithomson90", "link": "https://stackoverflow.com/users/9295300/ithomson90"}, "edited": false, "score": 0, "creation_date": 1517432044, "post_id": 48546206, "comment_id": 84098597, "body": "Thanks very much, I did think that adding a counter in might have been a bit too much, I had resorted to adding in in because my first few attempts weren&#39;t giving me the result I was hoping for"}], "tags": [], "owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "is_accepted": false, "score": 2, "last_activity_date": 1517413900, "creation_date": 1517413900, "answer_id": 48546206, "question_id": 48545976, "link": "https://stackoverflow.com/questions/48545976/excel-vba-making-a-boolean-function-to-detect-if-any-cells-in-range-are-a-certa/48546206#48546206", "title": "Excel VBA: Making a Boolean Function to detect if any Cells in Range are a certain colour", "body": "<p>The problem is that you are using <code>.Color</code> but testing against the color <em>index</em>. Use <code>.ColorIndex</code> instead. You are also doing too much work:</p>\n\n<pre><code>Function CheckIfRed(Cells As Range) As Boolean\n    Dim currentCell As Range\n\n    For Each currentCell In Cells\n        If currentCell.Interior.ColorIndex = 3 Then\n            CheckIfRed = True\n            Exit Function\n        End If\n    Next currentCell\nEnd Function\n</code></pre>\n\n<p>This code terminates as soon as it finds a single red cell. It also exploits the fact that Booleans have a default value of False which is automatically returned if the loop completes without finding a red. </p>\n\n<p>Be aware that checking the color index is not always sufficient if e.g. the color has been set by conditional formatting.</p>\n"}], "owner": {"reputation": 51, "user_id": 9295300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/379a83e73aae367cc563d2cc2b71f807?s=128&d=identicon&r=PG&f=1", "display_name": "Ithomson90", "link": "https://stackoverflow.com/users/9295300/ithomson90"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 706, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1517413900, "creation_date": 1517413255, "last_edit_date": 1531164843, "question_id": 48545976, "link": "https://stackoverflow.com/questions/48545976/excel-vba-making-a-boolean-function-to-detect-if-any-cells-in-range-are-a-certa", "title": "Excel VBA: Making a Boolean Function to detect if any Cells in Range are a certain colour", "body": "<p>I've been trying to create a function which will return a True or False value based on a range which contains a certain type of colour for any of those cells within that range. In this instance the colour is red (3). I'm trying to build the code so that if one of the cells within the range is red then the value returned will be True.</p>\n\n<p>Does anybody know what is wrong with the code below?</p>\n\n<pre><code>Function CheckIfRed(Cells As Range) As Boolean\n\nDim currentCell As Range\nDim counter As Long\n\nFor Each currentCell In Cells\n    If currentCell.Interior.Color = 3 Then\n        counter = counter + 1\n    End If\nNext currentCell\n\nIf counter &gt; 0 Then\n    CheckIfRed = True\nEnd If\n\nEnd Function\n</code></pre>\n\n<p>Any help would be much appreciated\nThanks</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1517413157, "post_id": 48545765, "comment_id": 84087446, "body": "What are <code>14:00</code> and <code>16:00</code>?"}, {"owner": {"reputation": 92, "user_id": 9184557, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/0212d49fc25078235a3888b31aef159f?s=128&d=identicon&r=PG&f=1", "display_name": "user9184557", "link": "https://stackoverflow.com/users/9184557/user9184557"}, "edited": false, "score": 0, "creation_date": 1517413269, "post_id": 48545765, "comment_id": 84087529, "body": "ya it will be 220 sorry"}, {"owner": {"reputation": 43423, "user_id": 1011724, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/2JAXi.jpg?s=128&g=1", "display_name": "Dan", "link": "https://stackoverflow.com/users/1011724/dan"}, "edited": false, "score": 0, "creation_date": 1517413286, "post_id": 48545765, "comment_id": 84087536, "body": "Why not try edit the <code>.Width</code> and <code>.Height</code> fields of <code>Selection</code> to resize the way you are editing the <code>.Left</code> etc to reposition it?"}, {"owner": {"reputation": 92, "user_id": 9184557, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/0212d49fc25078235a3888b31aef159f?s=128&d=identicon&r=PG&f=1", "display_name": "user9184557", "link": "https://stackoverflow.com/users/9184557/user9184557"}, "edited": false, "score": 0, "creation_date": 1517413303, "post_id": 48545765, "comment_id": 84087551, "body": "14:00 and 16:00 are width of the cell"}], "answers": [{"comments": [{"owner": {"reputation": 43423, "user_id": 1011724, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/2JAXi.jpg?s=128&g=1", "display_name": "Dan", "link": "https://stackoverflow.com/users/1011724/dan"}, "edited": false, "score": 0, "creation_date": 1517413527, "post_id": 48546009, "comment_id": 84087705, "body": "I would guess the auto-resize with the cell sizes is just a property to set on <code>rect1</code> as well"}, {"owner": {"reputation": 92, "user_id": 9184557, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/0212d49fc25078235a3888b31aef159f?s=128&d=identicon&r=PG&f=1", "display_name": "user9184557", "link": "https://stackoverflow.com/users/9184557/user9184557"}, "edited": false, "score": 1, "creation_date": 1517413588, "post_id": 48546009, "comment_id": 84087749, "body": "Thank you @ Vityata, is there a provision to keep it little smaller than the size of the column so that I will get a nice border"}, {"owner": {"reputation": 92, "user_id": 9184557, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/0212d49fc25078235a3888b31aef159f?s=128&d=identicon&r=PG&f=1", "display_name": "user9184557", "link": "https://stackoverflow.com/users/9184557/user9184557"}, "edited": false, "score": 0, "creation_date": 1517413933, "post_id": 48546009, "comment_id": 84087988, "body": "<code>With rect1         .Left = rngToCheck.Left - 7         .Top = rngToCheck.Top - 7         .Width = rngToCheck.Width - 7         .Height = rngToCheck.Height - 7     End With      ActiveSheet.Shapes(&quot;Rectangle 1&quot;).Select &#39;get the object With Selection .Left = Range(&quot;B1:C1&quot;).Left + (Range(&quot;B1:C1&quot;).Width - Selection.Width) &#47; 2 .Top = Range(&quot;B1:C1&quot;).Top + (Range(&quot;B1:C1&quot;).Height - Selection.Height) &#47; 2 End With</code>    this worked for me, thank you once again @Vityata"}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": true, "score": 4, "last_activity_date": 1517414037, "last_edit_date": 1517414037, "creation_date": 1517413370, "answer_id": 48546009, "question_id": 48545765, "link": "https://stackoverflow.com/questions/48545765/how-to-change-the-size-of-a-shape-based-on-cell-width/48546009#48546009", "title": "How to change the size of a shape based on Cell width", "body": "<p>If the idea is to have the shape exactly as the given range, then this is how to do it:</p>\n\n<pre><code>Option Explicit\n\nSub SetShape()\n\n    Dim rect1           As Shape\n    Dim rngToCheck      As Range\n\n    With ActiveSheet\n        Set rect1 = .Shapes(\"Rectangle 1\")\n        Set rngToCheck = .Range(\"B1:C1\")\n    End With\n\n    With rect1\n        .Left = rngToCheck.Left\n        .Top = rngToCheck.Top\n        .Width = rngToCheck.Width\n        .Height = rngToCheck.Height\n    End With\nEnd Sub\n</code></pre>\n\n<p>This is what you would get:</p>\n\n<p><a href=\"https://i.stack.imgur.com/cGnyD.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/cGnyD.png\" alt=\"enter image description here\"></a></p>\n\n<p>The good part is that if you change the size of the cells, the shape changes as well by default:</p>\n\n<p><a href=\"https://i.stack.imgur.com/jAS7a.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/jAS7a.png\" alt=\"enter image description here\"></a></p>\n\n<hr>\n\n<p>If you want to put some border around the shape, it is possible to play a bit like this:</p>\n\n<pre><code>Sub SetShape()\n\n    Dim rect1           As Shape\n    Dim rngToCheck      As Range\n    Dim borderSize      As Double\n\n    borderSize = 0.9\n\n    With ActiveSheet\n        Set rect1 = .Shapes(\"Rectangle 1\")\n        Set rngToCheck = .Range(\"B1:C1\")\n    End With\n\n    With rect1\n        .Width = rngToCheck.Width * borderSize\n        .Height = rngToCheck.Height * borderSize\n        .Left = rngToCheck.Left + (.Width / 2) * (1 - borderSize)\n        .Top = rngToCheck.Top + (.Height / 2) * (1 - borderSize)\n    End With\n\nEnd Sub\n</code></pre>\n\n<p>In this case the border is given as a <code>borderSize</code> and this is the result:\n<a href=\"https://i.stack.imgur.com/oefPm.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/oefPm.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 92, "user_id": 9184557, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/0212d49fc25078235a3888b31aef159f?s=128&d=identicon&r=PG&f=1", "display_name": "user9184557", "link": "https://stackoverflow.com/users/9184557/user9184557"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6860, "favorite_count": 0, "accepted_answer_id": 48546009, "answer_count": 1, "score": 1, "last_activity_date": 1517428324, "creation_date": 1517412600, "last_edit_date": 1517428324, "question_id": 48545765, "link": "https://stackoverflow.com/questions/48545765/how-to-change-the-size-of-a-shape-based-on-cell-width", "title": "How to change the size of a shape based on Cell width", "body": "<p>How to change the size of a shape based on Cell width</p>\n\n<p>For example, my cell B1 having Width: 14:00 (103 Pixels) and C1 having Width: 16:00 (117 Pixels)\nThe shape placed inside that Rage should change its size to 220 Pixels.</p>\n\n<p>And also whenever the width change it should adjust with its size! so there should be a provision to find the cell width.</p>\n\n<p>The code I have will help me to center it</p>\n\n<pre><code>Sub Set_shape()\n\nActiveSheet.Shapes(\"Rectangle 1\").Select 'get the object\nWith Selection\n    .Left = Range(\"B1:C1\").Left + (Range(\"B1:C1\").Width - Selection.Width) / 2\n    .Top = Range(\"B1:C1\").Top + (Range(\"B1:C1\").Height - Selection.Height) / 2\nEnd With\n\nEnd Sub\n</code></pre>\n\n<p>Is it possible? and if yes please help me to modify this code?</p>\n\n<p>Thanks in advance</p>\n"}, {"tags": ["excel", "vba", "decimal"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1517413491, "post_id": 48545668, "comment_id": 84087681, "body": "Either you want a &quot;General&quot; format, or you want a custom one. That said this 3rd-party shouldn&#39;t be sensitive to value formatting. If you can, get this custom program to read cell <i>values</i> rather than their <i>text</i>: the cells&#39; formatted value is just a <i>representation</i> of the values - code that&#39;s treating them verbatim as values, is doing it wrong."}], "answers": [{"tags": [], "owner": {"reputation": 1512, "user_id": 2936675, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/886c2f804bb37c2dbd5d92fb5b3344ce?s=128&d=identicon&r=PG&f=1", "display_name": "nwhaught", "link": "https://stackoverflow.com/users/2936675/nwhaught"}, "is_accepted": false, "score": 0, "last_activity_date": 1517412871, "creation_date": 1517412871, "answer_id": 48545849, "question_id": 48545668, "link": "https://stackoverflow.com/questions/48545668/formatting-a-custom-number-into-a-general-number/48545849#48545849", "title": "Formatting a Custom Number into a General Number", "body": "<p>I don't believe that what you're  attempting is possible. The difference between the two formats is exactly what you are describing. </p>\n"}, {"tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": true, "score": 0, "last_activity_date": 1517414777, "creation_date": 1517414777, "answer_id": 48546512, "question_id": 48545668, "link": "https://stackoverflow.com/questions/48545668/formatting-a-custom-number-into-a-general-number/48546512#48546512", "title": "Formatting a Custom Number into a General Number", "body": "<p>You're tackling the problem from the wrong end. The number formatting of a cell should make absolutely no difference in how a <em>custom program</em> reads cell values... provided that it's reading the cells' <strong>values</strong>.</p>\n\n<p>In all likelihood if it <em>does</em> make a difference, then your <em>custom program</em> is reading the <code>Range.Text</code> property, which is a <em>representation</em> of the cells' values, formatted accordingly with the cells' <code>NumberFormat</code>.</p>\n\n<p>This means that <em>custom program</em> is treating everything it reads as <code>String</code>, and then parses the strings into some numeric value. This is completely backwards and rather inefficient.</p>\n\n<p>Change the <em>custom program</em> to read the <code>Range.Value</code> property, which is <em>the actual underlying value*</em> of the cells, not a <em>representation</em> of it.</p>\n\n<p>And then you can have any number formatting you want on your worksheet, nothing is going to break - and as a bonus your <em>custom program</em> gets to read numbers <em>as numbers</em> and doesn't need to parse decimal separators and deal with the huge mess that comes with treating everything as a <code>String</code>, i.e. it works regardless of the regional settings of the machine it's running on.</p>\n\n<p>The worksheet itself, and the number formats on it, aren't the problem.</p>\n\n<p><sub>*<em>Typed</em> value. If a cell is formatted as currency, the value's type will be <code>Currency</code>. If it's formatted as a date, it will be a <code>Date</code>. This is typically what you would want to read it as - use <code>Value2</code> if you need the actual underlying numeric values, without any type conversion. That will give you e.g. <code>43131</code> for today's date.</sub></p>\n"}], "owner": {"reputation": 13, "user_id": 9295246, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dc5bf8b8894575ce90daa74be6649510?s=128&d=identicon&r=PG&f=1", "display_name": "Kathy Henderson", "link": "https://stackoverflow.com/users/9295246/kathy-henderson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 207, "favorite_count": 0, "accepted_answer_id": 48546512, "answer_count": 2, "score": 1, "last_activity_date": 1517414777, "creation_date": 1517412311, "last_edit_date": 1517412370, "question_id": 48545668, "link": "https://stackoverflow.com/questions/48545668/formatting-a-custom-number-into-a-general-number", "title": "Formatting a Custom Number into a General Number", "body": "<p>I have an excel file that I need to change Column E numbers from a Custom Format into a \"General\" Format. </p>\n\n<p>The end result I'm trying to achieve is the columns two digit numbers must be changed to a decimal format (.000) but maintain general format in order to import into a custom program. </p>\n\n<p>Currently I have code <code>Columns(\"E\").NumberFormat = \".000,\"</code> which works great and columns shows .010.</p>\n\n<p>I tried to add a line to change the code back to \"General\" with code <code>Columns(\"E\").NumberFormat = \"General\"</code> but it removes the .000 format and goes back to two digits. </p>\n\n<p>Any suggestions. </p>\n"}, {"tags": ["arrays", "vba", "excel", "average"], "answers": [{"comments": [{"owner": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "edited": false, "score": 0, "creation_date": 1517414860, "post_id": 48545592, "comment_id": 84088678, "body": "Interesting competition on this question.  Can I say that if there is bad data in a column and you get a #Num! then defining result array as a Double will throw an error."}], "tags": [], "owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "is_accepted": false, "score": 0, "last_activity_date": 1517412101, "creation_date": 1517412101, "answer_id": 48545592, "question_id": 48545184, "link": "https://stackoverflow.com/questions/48545184/storing-an-average-in-an-array/48545592#48545592", "title": "Storing an average in an array", "body": "<p>You can use the <code>WorksheetFunction</code> method for <code>Average()</code>.</p>\n\n<p>From what I understood from your question, you wanted the averages to be stored inside an array, so here you go..</p>\n\n<pre><code>Public Function lastRow(ByVal ws As Worksheet, Optional ByVal col As Variant = 1)\n    With ws\n        lastRow = .Cells(.Rows.Count, col).End(xlUp).Row\n    End With\nEnd Function\n\nSub test()\n\n    Dim ws As Worksheet, aveArr(4) As Double\n    Set ws = ThisWorkbook.Worksheets(1)\n\n    'You said that you wanted to store the values to be inside an array...\n    With WorksheetFunction\n        aveArr(0) = .Average(ws.Range(\"E2:E\" &amp; lastRow(ws, \"E\")))\n        aveArr(1) = .Average(ws.Range(\"F2:E\" &amp; lastRow(ws, \"F\")))\n        aveArr(2) = .Average(ws.Range(\"G2:E\" &amp; lastRow(ws, \"G\")))\n        aveArr(3) = .Average(ws.Range(\"H2:E\" &amp; lastRow(ws, \"H\")))\n    End With\n\n    MsgBox aveArr(0) &amp; vbNewLine &amp; _\n            aveArr(1) &amp; vbNewLine &amp; _\n            aveArr(2) &amp; vbNewLine &amp; _\n            aveArr(3)\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "is_accepted": false, "score": 0, "last_activity_date": 1517412362, "creation_date": 1517412362, "answer_id": 48545689, "question_id": 48545184, "link": "https://stackoverflow.com/questions/48545184/storing-an-average-in-an-array/48545689#48545689", "title": "Storing an average in an array", "body": "<p>My (very similar) solution to the others posted here:</p>\n\n<pre><code>Sub AverageArray()\n\nDim myarray As Variant, sht As Worksheet, lastrow As Long\n\nSet sht = ThisWorkbook.Worksheets(\"Sheet1\")\nlastrow = sht.Cells(sht.Rows.Count, \"E\").End(xlUp).Row 'or F, G, H, etc.\n\nmyarray = Array(Application.Average(Range(\"E2:E\" &amp; lastrow)), _\n                Application.Average(Range(\"F2:F\" &amp; lastrow)), _\n                Application.Average(Range(\"G2:G\" &amp; lastrow)), _\n                Application.Average(Range(\"H2:H\" &amp; lastrow)))\n\nDebug.Print myarray(0)\nDebug.Print myarray(1)\nDebug.Print myarray(2)\nDebug.Print myarray(3)\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2189, "user_id": 8726447, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/961e6112f7d5aac9646ce1469e89fe20?s=128&d=identicon&r=PG&f=1", "display_name": "MarcinSzaleniec", "link": "https://stackoverflow.com/users/8726447/marcinszaleniec"}, "is_accepted": true, "score": 2, "last_activity_date": 1517412655, "creation_date": 1517412655, "answer_id": 48545787, "question_id": 48545184, "link": "https://stackoverflow.com/questions/48545184/storing-an-average-in-an-array/48545787#48545787", "title": "Storing an average in an array", "body": "<p>As far as I know, empty cells doesn't count. So there is no need to define lastrow. Try this: </p>\n\n<pre><code>Sub AvToArray()\n    Dim rng As Range\n    Dim col As Range\n    Dim arrAv()\n    Dim i As Long\n\n    Set rng = Range(\"E:H\")\n    ReDim arrAv(rng.Columns.Count)\n\n    For Each col In rng.Columns\n        arrAv(i) = WorksheetFunction.Average(col)\n        i = i + 1\n    Next col\n\nEnd Sub\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user9103716"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 0, "accepted_answer_id": 48545787, "answer_count": 3, "score": -1, "last_activity_date": 1517412655, "creation_date": 1517410809, "last_edit_date": 1517412495, "question_id": 48545184, "link": "https://stackoverflow.com/questions/48545184/storing-an-average-in-an-array", "title": "Storing an average in an array", "body": "<p>I'm looking for a way to create an array in which it finds the average for columns E, F, G and H and then stores the average in an array. The only issue is the amount of rows in each column varies for each file I will run this array on (all the columns have the same amount of rows though) and so I pressure it'll be a dynamic array, and I also want the averaging to start from the second row as I have titles in the first row.  If anyone knows how to do this the help would be much appreciated as I'm utterly confused. </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1517412975, "post_id": 48545107, "comment_id": 84087330, "body": "Your question is quite unclear, your code is quite long and hard to read. To get a good answer you should ask a <b>technical</b> question here. Asking for support <b>is not asking a question</b>: Please read <a href=\"https://meta.stackoverflow.com/a/284237/3219613\">Why is \u201cCan someone help me?\u201d not an actual question?</a> and <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a>. At least give an example data set, a good explanation how you would calculate that by hand and what the expected result would be."}, {"owner": {"reputation": 4047, "user_id": 3246362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6da9a197d0f0e5f19875d8a97550e58e?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/3246362/sam"}, "edited": false, "score": 0, "creation_date": 1517415484, "post_id": 48545107, "comment_id": 84089073, "body": "As comment above says - too long and too complex. The first thing you need to do is to create a function that breaks out the overlap logic and returns a value you can use in your calculation. I would imagine that you have two date spans as input and number of overlapping days as output. Using this, you can accumulate the spans and subtract the overlaps."}, {"owner": {"reputation": 11, "user_id": 9260691, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-UwK3fnXQ2JA/AAAAAAAAAAI/AAAAAAAA5Z8/RIuNY5mqW1I/photo.jpg?sz=128", "display_name": "Mohammed Ziara", "link": "https://stackoverflow.com/users/9260691/mohammed-ziara"}, "edited": false, "score": 0, "creation_date": 1517423608, "post_id": 48545107, "comment_id": 84094202, "body": "as I have mentioned, I&#39;m really new to programming. Hawver, my issue in the calculation the total live duration in the case of overlapping."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1517469415, "post_id": 48545107, "comment_id": 84110249, "body": "@MohammedZiara we cannot tell you how to calculate something or how your algorithm should look like. This is what you should tell us and then we can help you with the technical / coding part, but for now it is even unclear what you are trying to calculate. We don&#39;t know what to do to calculate the &quot;<i>total live duration</i>&quot; if you don&#39;t tell us how this is calculated. You still didn&#39;t add the requested example in your question: &quot;<i>At least give an example data set, a good explanation how you would calculate that by hand and what the expected result would be.</i>&quot;"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1517469725, "post_id": 48545107, "comment_id": 84110365, "body": "@MohammedZiara In other words, if you don&#39;t know how to calculate it by hand with a calculator, then you cannot calculate it with Excel. Excel is only as smart as you, it cannot do any magical things. You need to tell us how this is calculated by hand first. Then we can help you to find out to tell Excel how to do it."}], "owner": {"reputation": 11, "user_id": 9260691, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-UwK3fnXQ2JA/AAAAAAAAAAI/AAAAAAAA5Z8/RIuNY5mqW1I/photo.jpg?sz=128", "display_name": "Mohammed Ziara", "link": "https://stackoverflow.com/users/9260691/mohammed-ziara"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 48, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1517412480, "creation_date": 1517410575, "last_edit_date": 1517412480, "question_id": 48545107, "link": "https://stackoverflow.com/questions/48545107/overlapping-total-live-duration-calculation", "title": "Overlapping Total Live Duration Calculation", "body": "<p>Am trying to calculate the total duration of Equipment Live Time.\nIn the case of the Equipment has only one serves then there is no overlap between Live Time events. \nThe issue with the orders that have Equipment with mulibel services Each one can overlap with multiple other Time. </p>\n\n<p><a href=\"https://i.stack.imgur.com/7cpSB.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/7cpSB.png\" alt=\"Example\"></a></p>\n\n<p>I need to calculate the total amount of time any each Equipment ID then retain the calculation in Eq. LIVE Time.\nI'm new in programming and I couldn't find a solution for that.\nPlease support</p>\n\n<pre><code>Sub Cul_Eq_Live_Time()\n\nApplication.ScreenUpdating = False\n\n\n Dim n As Long, lr_LT As Integer, lr_data As Integer\n Dim z As Integer, y As Integer, x As Integer, EqID As String, iLoop As Integer, No_CCTs As Integer\n\n Dim xDate As Date, yDate As Date, aDate As Date, bData As Date, iDate As Date, eDate As Date, Diff As Integer, EqLiveT As Long, T As Integer, tRange As Range\n Dim nDate As Date, dDate As Date\n\n\n  lr_LT = Sheets(\"Live Time\").Range(\"F\" &amp; Rows.Count).End(xlUp).Row\n\n  'initial cell in Tuning sheet &amp; range\n\n  T = 2\n  Set tRange = Sheets(\"Tuning\").Range(\"B2:C2000\")\n\n'loop all orders\n\n For n = 3 To lr_LT\n\n 'get new EqID\nEqID = Sheets(\"Live Time\").Cells(n, \"E\").Value\n' find if the cuont EqID is 1 then live time will be the same of the CCT live time.\ny = Application.WorksheetFunction.CountIf(Sheets(\"Live Time\").Range(\"E:E\"), Sheets(\"Live Time\").Cells(n, 5).Value)\nIf y &lt;= 1 Then\nSheets(\"Live Time\").Cells(n, \"P\").Value = Sheets(\"Live Time\").Cells(n, \"K\").Value\nGoTo End_n_Loop\n\nEnd If\n'''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''\n\n' in the cae of Eq. more the one orders\n'''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''\n\n' if live time alredy culculated\nIf Application.WorksheetFunction.CountIf(Sheets(\"Tuning\").Range(\"B:B\"), Sheets(\"Live Time\").Cells(n, \"E\").Value) &gt;= 1 Then\nSheets(\"Live Time\").Cells(n, \"P\").Value = Application.WorksheetFunction.VLookup(EqID, tRange, 2, False)\nGoTo End_n_Loop\nEnd If\n'''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''\n\n' in the caee of above condition not found\n\n'get iDate &amp; eDate\n\niDate = Sheets(\"Live Time\").Cells(n, \"H\").Value\neDate = Sheets(\"Live Time\").Cells(n, \"I\").Value\nDiff = 0\nEqLiveT = 0\nNo_CCTs = 1\nxDate = iDate\nyDate = eDate\n\n\nIf eDate = 0 Then\neDate = Date\nEnd If\n\n' iLoop for the Eq. that have more the one orders\n\nFor iLoop = n + 1 To lr_LT\n\n''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''\n\nIf Sheets(\"Live Time\").Cells(iLoop, \"H\").Value &lt;&gt; EqID Then\nGoTo End_iLoop\nEnd If\n\n' count the nomber of CCt for this Eq.\n\nNo_CCTs = No_CCTs + 1\n\n' in the case of the CCT live eDate = today\nIf Sheets(\"Live Time\").Cells(iLoop, \"I\").Value = 0 Then\ndDate = Date\nEnd If\n\n' update the dates\n\naDate = Sheets(\"Live Time\").Cells(iLoop, \"H\").Value\nbDate = Sheets(\"Live Time\").Cells(iLoop, \"I\").Value\n\n''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''\n\n''''''''''''''' x&lt;--------&gt;y\n\n\n''''''''' a&lt;--------&gt;b\n\nIf xDate &gt;= aDate And xDate &lt; bDate And yDate &gt;= bDate Then\n\nnDate = aDate\ndDate = yDate\nGoTo End_iLoop\n\nEnd If\n\n''''''''''''''' x&lt;--------&gt;y\n\n\n''''''''''''''''''' a&lt;--------&gt;b\nIf CDate(xDate) &lt; CDate(aDate) And CDate(yDate) &gt; CDate(aDate) And CDate(yDate) &lt;= CDate(bDate) Then\n\nnDate = xDate\ndDate = bDate\nGoTo End_iLoop\n\nEnd If\n\n''''''''''''''' x&lt;--------&gt;y\n\n\n''''''''''' a&lt;----------------&gt;b\nIf xDate &gt; aDate And xDate &lt; bDate And yDate &gt;= aDate And yDate &lt;= bDate Then\nnDate = aDate\ndDate = bDate\nGoTo End_iLoop\n\nEnd If\n\n''''''' x&lt;------------------&gt;y\n\n\n''''''''''' a&lt;-----------&gt;b\nIf xDate &lt; aDate And yDate &gt; bDate And aDate &gt; yDate Then\nnDate = xDate\ndDate = yDate\nGoTo End_iLoop\n\nEnd If\n\n''''''' x&lt;------------------&gt;y ''''''''''' a&lt;-----------&gt;b\nIf yDate &gt; aDate And xDate &gt; aDate And bDate &gt; yDate Then\nnDate = xDate\ndDate = yDate\nDiff = Diff + (aDate - yDate)\nGoTo End_iLoop\nEnd If\n\nEnd_iLoop:\n\nNext iLoop\n\n'AfterLoop\n\nEqLiveT = nDate - dDate - Diff\n\n'EqLiveT = EqLiveT - Diff\n\nSheets(\"Live Time\").Cells(n, \"P\").Value = EqLiveT\nSheets(\"Tuning\").Cells(T, \"A\").Value = T - 1\nSheets(\"Tuning\").Cells(T, \"B\").Value = EqID\nSheets(\"Tuning\").Cells(T, \"C\").Value = EqLiveT\nSheets(\"Tuning\").Cells(T, \"D\").Value = No_CCTs\nT = T + 1\n\nEnd_n_Loop:\n\nNext n\n\nMsgBox \"Done\"\n\nApplication.ScreenUpdating = True\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1517411240, "post_id": 48544876, "comment_id": 84086121, "body": "Just curious - why use <code>Select Case</code> when you can write out <code>If IsNumber(c2.Value2) = True Then</code>? Seems to be adding unnecessary extra lines."}, {"owner": {"reputation": 315, "user_id": 9057704, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/92b8098293d8382d61623df795e1aa51?s=128&d=identicon&r=PG&f=1", "display_name": "Gregory", "link": "https://stackoverflow.com/users/9057704/gregory"}, "reply_to_user": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1517418432, "post_id": 48544876, "comment_id": 84091227, "body": "That&#39;s only part of the code, @dwirony. There are over 20 if/else + case statements in there, which is why I brought it down into the function"}], "answers": [{"comments": [{"owner": {"reputation": 315, "user_id": 9057704, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/92b8098293d8382d61623df795e1aa51?s=128&d=identicon&r=PG&f=1", "display_name": "Gregory", "link": "https://stackoverflow.com/users/9057704/gregory"}, "edited": false, "score": 0, "creation_date": 1517418425, "post_id": 48545576, "comment_id": 84091220, "body": "That&#39;s only part of the code, Sam. There are over 20 if/else + case statements in there, which is why I brought it down into the function"}, {"owner": {"reputation": 4047, "user_id": 3246362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6da9a197d0f0e5f19875d8a97550e58e?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/3246362/sam"}, "reply_to_user": {"reputation": 315, "user_id": 9057704, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/92b8098293d8382d61623df795e1aa51?s=128&d=identicon&r=PG&f=1", "display_name": "Gregory", "link": "https://stackoverflow.com/users/9057704/gregory"}, "edited": false, "score": 0, "creation_date": 1517418642, "post_id": 48545576, "comment_id": 84091340, "body": "Ignore the Select statement for now. You are using IsNumber and IsText. Those functions aren&#39;t available in VBA. Is it something you have declared elsewhere?"}, {"owner": {"reputation": 315, "user_id": 9057704, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/92b8098293d8382d61623df795e1aa51?s=128&d=identicon&r=PG&f=1", "display_name": "Gregory", "link": "https://stackoverflow.com/users/9057704/gregory"}, "edited": false, "score": 0, "creation_date": 1517418923, "post_id": 48545576, "comment_id": 84091504, "body": "I have. They&#39;re in the top of the code that I pasted above."}, {"owner": {"reputation": 4047, "user_id": 3246362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6da9a197d0f0e5f19875d8a97550e58e?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/3246362/sam"}, "reply_to_user": {"reputation": 315, "user_id": 9057704, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/92b8098293d8382d61623df795e1aa51?s=128&d=identicon&r=PG&f=1", "display_name": "Gregory", "link": "https://stackoverflow.com/users/9057704/gregory"}, "edited": false, "score": 2, "creation_date": 1517419579, "post_id": 48545576, "comment_id": 84091932, "body": "Sorry. A bit blind. IsEmpty is not what you need. That is used to determine if something has been initialized. Test it with (expression = &quot;&quot;) instead."}, {"owner": {"reputation": 11170, "user_id": 726127, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/TA0YX.jpg?s=128&g=1", "display_name": "Brad", "link": "https://stackoverflow.com/users/726127/brad"}, "edited": false, "score": 0, "creation_date": 1517437763, "post_id": 48545576, "comment_id": 84101384, "body": "Also these evaluations in OP&#39;s question are written as though VBA has short circuit logic evaluation. It doesn&#39;t."}, {"owner": {"reputation": 315, "user_id": 9057704, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/92b8098293d8382d61623df795e1aa51?s=128&d=identicon&r=PG&f=1", "display_name": "Gregory", "link": "https://stackoverflow.com/users/9057704/gregory"}, "reply_to_user": {"reputation": 11170, "user_id": 726127, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/TA0YX.jpg?s=128&g=1", "display_name": "Brad", "link": "https://stackoverflow.com/users/726127/brad"}, "edited": false, "score": 0, "creation_date": 1517508796, "post_id": 48545576, "comment_id": 84134613, "body": "@brad I don&#39;t see the issue here? Please elaborate."}, {"owner": {"reputation": 315, "user_id": 9057704, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/92b8098293d8382d61623df795e1aa51?s=128&d=identicon&r=PG&f=1", "display_name": "Gregory", "link": "https://stackoverflow.com/users/9057704/gregory"}, "edited": false, "score": 0, "creation_date": 1517508830, "post_id": 48545576, "comment_id": 84134630, "body": "@Sam, I got it working. Thank you for the solution. Would you like to submit it as the official answer?"}], "tags": [], "owner": {"reputation": 4047, "user_id": 3246362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6da9a197d0f0e5f19875d8a97550e58e?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/3246362/sam"}, "is_accepted": false, "score": 1, "last_activity_date": 1517516688, "last_edit_date": 1517516688, "creation_date": 1517412056, "answer_id": 48545576, "question_id": 48544876, "link": "https://stackoverflow.com/questions/48544876/vba-not-able-to-discern-between-empty-cells-numeric-cells-and-text/48545576#48545576", "title": "VBA not able to discern between empty cells, numeric cells, and text?", "body": "<p>Updated after discussion below.</p>\n\n<pre><code>Function IsNumber(ByRef expression As Variant) As Boolean    \n    IsNumber = expression &lt;&gt; \"\" And IsNumeric(expression)    \nEnd Function\n\nFunction IsText(ByRef expression As Variant) As Boolean    \n    IsText = expression &lt;&gt; \"\" And Not IsNumeric(expression)    \nEnd Function\n</code></pre>\n\n<p>Original post:</p>\n\n<p>There are some mixed problem in your code. The <code>Select</code> statement have several issues and is very misleading. In this case you can't use <code>Select</code>. <code>If</code> is your best option. Try something like this:</p>\n\n<pre><code>Sub Example()\n    If Len(Value) = 0 Then\n        'Empty\n    ElseIf IsNumeric(Value) Then\n        'Numeric\n    Else\n        'Alphanumeric\n    End If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 315, "user_id": 9057704, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/92b8098293d8382d61623df795e1aa51?s=128&d=identicon&r=PG&f=1", "display_name": "Gregory", "link": "https://stackoverflow.com/users/9057704/gregory"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 622, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1517516688, "creation_date": 1517409892, "last_edit_date": 1517414561, "question_id": 48544876, "link": "https://stackoverflow.com/questions/48544876/vba-not-able-to-discern-between-empty-cells-numeric-cells-and-text", "title": "VBA not able to discern between empty cells, numeric cells, and text?", "body": "<p>I am trying to read cells in VBA and do certain things based on the contents of them. However, VBA is unable to accurately determine if the contents of a cell are blank, numeric, or text. It will think that cells with only a '1' in them are blank, and cells with text are blank. If it makes a difference, I turn off all screen updating and the like when this runs.</p>\n\n<p>Please see code below:</p>\n\n<pre><code>Function IsNumber(ByRef expression As Variant) As Boolean    \n    IsNumber = Not IsEmpty(expression) And IsNumeric(expression)    \nEnd Function\n\nFunction IsText(ByRef expression As Variant) As Boolean    \n    IsText = Not IsEmpty(expression) And Not IsNumeric(expression)    \nEnd Function\n\nSub RA()\n    Dim cell As Range    \n    With ActiveWorkbook.Worksheets(\"Sheet1\")\n        lastrow = .Cells(.Rows.Count, 1).End(xlUp).Row\n        lastCol = .Cells(1, .Columns.Count).End(xlToLeft).Column\n        Set r = Worksheets(\"Sheet1\").Range(Cells(3, 3), Cells(lastrow, lastCol - 1))\n     End With\n\n    For i = 3 To lastrow\n        Set c = Cells(i, 3)\n        Select Case True\n            Case S1_Func(c)\n        End Select\n    Next i\nEnd Sub\n\nFunction S1_Func(c As Variant)\n    Dim SR As Worksheet\n    Set SR = Worksheets(\"Financials\")\n    Dim c2 As Range    \n    Set c2 = c.Offset(0, 1)\n\n    If IsNumber(c2.Value2) Then\n        Select Case True\n            Case SR.Cells(i, 5).Value2 = \"LY\"\n        End Select\n    ElseIf IsText(c2.Value2) Then\n        Cells(i, 72).Value2 = \"Incorrect\"\n    End If\nEnd sub\n</code></pre>\n"}, {"tags": ["python", "excel", "csv", "vba"], "comments": [{"owner": {"reputation": 2454, "user_id": 8784938, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/753bb55c80a644f950a41ae11cfbe48c?s=128&d=identicon&r=PG&f=1", "display_name": "SuperStew", "link": "https://stackoverflow.com/users/8784938/superstew"}, "edited": false, "score": 1, "creation_date": 1517409919, "post_id": 48544859, "comment_id": 84085083, "body": "You can automate a browser with selenium and python. Sounds like it would be easiest solution."}, {"owner": {"reputation": 1995, "user_id": 5015758, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90dcc6a1dbfffa1e3c09bb0222a29507?s=128&d=identicon&r=PG&f=1", "display_name": "yosemite_k", "link": "https://stackoverflow.com/users/5015758/yosemite-k"}, "edited": false, "score": 0, "creation_date": 1517410030, "post_id": 48544859, "comment_id": 84085167, "body": "can you share a sample code showing the structure"}, {"owner": {"reputation": 655, "user_id": 5183031, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ea1e2e43efd4e65f4b06cff36e36f1f6?s=128&d=identicon&r=PG&f=1", "display_name": "Mr.Riply", "link": "https://stackoverflow.com/users/5183031/mr-riply"}, "edited": false, "score": 0, "creation_date": 1517410410, "post_id": 48544859, "comment_id": 84085464, "body": "unfortunately not, like I said the two solutions I had in mind don&#39;t work for the stated reasons. Im not looking for free code, just an idea, a push in the right direction"}], "owner": {"reputation": 655, "user_id": 5183031, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ea1e2e43efd4e65f4b06cff36e36f1f6?s=128&d=identicon&r=PG&f=1", "display_name": "Mr.Riply", "link": "https://stackoverflow.com/users/5183031/mr-riply"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 47, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1517409855, "creation_date": 1517409855, "last_edit_date": 1531164843, "question_id": 48544859, "link": "https://stackoverflow.com/questions/48544859/downloading-a-csv-file-without-a-direct-link-or-api", "title": "downloading a CSV file without a direct link or API", "body": "<p>I am trying to find a solution to download a CSV file from an internal company website. </p>\n\n<p>My first thought was throught the API but it doesn't exit, at least not yet.</p>\n\n<p>Second I figured, I would try a direct link to the CSV file on the website, that's also a No Go as the link is sort of static and even copy pasting to a new tab doesn't work.</p>\n\n<p>My third idea was to record a mouse movement, but that's just too inefficient as I would like this process to happen in the background.</p>\n\n<p>Please, I welcome any ideas, codes, software, anything.... most preferable solution would be in VBA after that python and then anything else.</p>\n\n<p>I'm sorry if this is not stack overflow worthy question :/</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1517413385, "post_id": 48544827, "comment_id": 84087617, "body": "If this cell is formatted by conditional formatting the short answer is you can&#39;t from a udf called from the worksheet. Displayformat does not works called from the worksheet. And only displayformat can see conditional formatting. It would be better to test the rule that causes the formatting than test the formatting."}, {"owner": {"reputation": 1597, "user_id": 3738866, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/9079f27df75b2555bf4f17912013a263?s=128&d=identicon&r=PG&f=1", "display_name": "Spirine", "link": "https://stackoverflow.com/users/3738866/spirine"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1517561699, "post_id": 48544827, "comment_id": 84154140, "body": "@ScottCraner Indeed, I&#39;m using conditional formatting. Is it possible to check a conditional formatting rule without having to write it twice ? The goal is to avoid users having to use VBA when modifying the sheet."}], "answers": [{"comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1517413428, "post_id": 48545737, "comment_id": 84087643, "body": "If the cell is colored through conditional formatting, this will fail to return the color."}], "tags": [], "owner": {"reputation": 24, "user_id": 5809138, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4cc1c7e532ea20350f77458a827f0550?s=128&d=identicon&r=PG&f=1", "display_name": "grab74", "link": "https://stackoverflow.com/users/5809138/grab74"}, "is_accepted": false, "score": 1, "last_activity_date": 1517412476, "creation_date": 1517412476, "answer_id": 48545737, "question_id": 48544827, "link": "https://stackoverflow.com/questions/48544827/unable-to-get-color-of-a-cell-when-calling-function-in-a-formula/48545737#48545737", "title": "Unable to get color of a cell when calling function in a formula", "body": "<p>You can make it work just removing the <code>.DisplayFormat</code> part, so that it becomes <code>get_color = Cells(1, 1).Interior.Color</code>.\nYou can also try the following in order to be able to catch the color of a given cell:</p>\n\n<pre><code>Function get_color(myCell As Range) As Long\n  Dim ws As Worksheet\n  Set ws = ActiveSheet\n  get_color = ws.Cells(myCell.Row, myCell.Column).Interior.Color\nEnd Function\n</code></pre>\n\n<p>You can use it in your code like this: <code>a = get_color(Range(\"A1\"))</code> or in the worksheet like this: <code>=get_color(A1)</code></p>\n"}], "owner": {"reputation": 1597, "user_id": 3738866, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/9079f27df75b2555bf4f17912013a263?s=128&d=identicon&r=PG&f=1", "display_name": "Spirine", "link": "https://stackoverflow.com/users/3738866/spirine"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 239, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1517412476, "creation_date": 1517409763, "question_id": 48544827, "link": "https://stackoverflow.com/questions/48544827/unable-to-get-color-of-a-cell-when-calling-function-in-a-formula", "title": "Unable to get color of a cell when calling function in a formula", "body": "<p>I'm trying to get the display color of a cell in Excel. Thus, I use the following function:</p>\n\n<pre><code>Function get_color()\n  get_color = Cells(1,1).DisplayFormat.Interior.Color\nEnd Function\n</code></pre>\n\n<p>When calling this function from a procedure, it works well. However, I'm unable to assign its return value to a cell. Indeed, writing in B12</p>\n\n<pre><code>=get_color()\n</code></pre>\n\n<p>yields a VALUE error.</p>\n\n<p>Conventionally, the member Color of the class Interior is a <em>Variant</em> object which is in fact a Long, so the problem is not that Excel can't assign an exotic value to a cell.</p>\n\n<p>How am I suppose to get the apparent color of a cell and write it into another cell?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1517409251, "post_id": 48544605, "comment_id": 84084528, "body": "Please include your code in your question."}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 7781784, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/707b8a9d4e125c7be5ef6ee7ae55dbdd?s=128&d=identicon&r=PG&f=1", "display_name": "Gaz", "link": "https://stackoverflow.com/users/7781784/gaz"}, "is_accepted": false, "score": 0, "last_activity_date": 1517475237, "creation_date": 1517475237, "answer_id": 48558689, "question_id": 48544605, "link": "https://stackoverflow.com/questions/48544605/macro-fails-to-run-after-importing-module/48558689#48558689", "title": "Macro Fails to Run After Importing Module", "body": "<p>I found the answer to my own question.</p>\n\n<p>I had accidently changed the codename of a worksheet instead of the name of the sheet itself. I had renamed codename 'wksMain' to Main. I've changed it back to wksMain and it's now working.</p>\n"}], "owner": {"reputation": 1, "user_id": 7781784, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/707b8a9d4e125c7be5ef6ee7ae55dbdd?s=128&d=identicon&r=PG&f=1", "display_name": "Gaz", "link": "https://stackoverflow.com/users/7781784/gaz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 43, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1517475237, "creation_date": 1517409076, "last_edit_date": 1517473967, "question_id": 48544605, "link": "https://stackoverflow.com/questions/48544605/macro-fails-to-run-after-importing-module", "title": "Macro Fails to Run After Importing Module", "body": "<p>I have a private sub procedure called, 'Main', in a module called MMain. It's triggered on the Workbook_Open event and has been working without issue until I imported some modules from another workbook.</p>\n\n<p>The error I am getting when the workbook is opened, or if I attempt to run the procedure from the Immediate window is:  </p>\n\n<blockquote>\n  <p>Run-time error '1004': Application-defined or object-defined error.</p>\n</blockquote>\n\n<p>(The procedure runs fine if I click the Run button within the Main sub.)</p>\n\n<pre><code>Option Explicit\n\nPrivate Sub Workbook_Open()\n    Application.Run \"Main\"\nEnd Sub\n</code></pre>\n\n<p>Main doesn't have any arguments and the above will work if I rename it and the calling sub to 'Main2' for instance.</p>\n\n<p>I can fix it, if I rename the procedure, but to be honest, I'd rather not, and I want to know how to fix it properly...</p>\n\n<p>I suspect that because the other workbook that I imported these other modules from also contains a Main module, this could be what has caused the problem.</p>\n\n<p>How would one fix this, other than using a backup, renaming the procedure, or, copying the code over to a new workbook?</p>\n\n<p>Many thanks</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "is_accepted": false, "score": 2, "last_activity_date": 1517408680, "creation_date": 1517408680, "answer_id": 48544486, "question_id": 48544436, "link": "https://stackoverflow.com/questions/48544436/writing-long-notetext/48544486#48544486", "title": "Writing long NoteText", "body": "<p>To add a note that contains more than 255 characters, use this method once to specify the first 255 characters, and then use it again to append the remainder of the note (no more than 255 characters at a time).</p>\n\n<p><a href=\"https://msdn.microsoft.com/en-us/VBA/excel-vba/articles/range-notetext-method-excel?f1url=https%3A%2F%2Fmsdn.microsoft.com%2Fquery%2Fdev11.query%3FappId%3DDev11IDEF1%26l%3Den-US%26k%3Dk(vbaxl10.chm144166)%3Bk(TargetFrameworkMoniker-Office.Version%3Dv15)%26rd%3Dtrue\" rel=\"nofollow noreferrer\">NoteText Documentation</a></p>\n"}, {"tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 3, "last_activity_date": 1517410701, "last_edit_date": 1517410701, "creation_date": 1517409049, "answer_id": 48544599, "question_id": 48544436, "link": "https://stackoverflow.com/questions/48544436/writing-long-notetext/48544599#48544599", "title": "Writing long NoteText", "body": "<p>This is what I have managed to get:</p>\n\n<pre><code>Sub allWeNeedIsLongComment()\n\n    Dim commentToBeAdded    As String\n    Dim commentSigns        As Long\n    Dim cnt                 As Long\n    Dim addToFixTheLoop     As Long\n\n    commentToBeAdded = \"Here is FatBox Slim....\" &amp; vbCrLf &amp; _\n                       \"1.  Push the tempo! Push the tempo!Push the tempo!\" &amp; vbCrLf &amp; _\n                       \"2.  Push the tempo! Push the tempo!Push the tempo!\" &amp; vbCrLf &amp; _\n                       \"3.  Push the tempo! Push the tempo!Push the tempo!\" &amp; vbCrLf &amp; _\n                       \"4.  Push the tempo! Push the tempo!Push the tempo!\" &amp; vbCrLf &amp; _\n                       \"5.  Push the tempo! Push the tempo!Push the tempo!\" &amp; vbCrLf &amp; _\n                       \"6.  Push the tempo! Push the tempo!Push the tempo!\" &amp; vbCrLf &amp; _\n                       \"7.  Push the tempo! Push the tempo!Push the tempo!\" &amp; vbCrLf &amp; _\n                       \"8.  Push the tempo! Push the tempo!Push the tempo!\" &amp; vbCrLf &amp; _\n                       \"9.  Push the tempo! Push the tempo!Push the tempo!\" &amp; vbCrLf &amp; _\n                       \"10. Push the tempo! Push the tempo!Push the tempo!\" &amp; vbCrLf &amp; _\n                       \"Oh push the tempo!\"\n\n    commentSigns = Len(commentToBeAdded)\n    If Not Range(\"C3\").Comment Is Nothing Then Range(\"C3\").Comment.Delete\n    addToFixTheLoop = commentSigns Mod 255 + 1\n\n    For cnt = 1 To (commentSigns + addToFixTheLoop) Step 255\n        If cnt = 1 Then\n            Range(\"C3\").NoteText Text:=Mid(commentToBeAdded, cnt, 255)\n        Else\n            Range(\"C3\").NoteText Text:=Mid(commentToBeAdded, cnt, 255), Start:=cnt\n\n        End If\n    Next cnt\n\nEnd Sub\n</code></pre>\n\n<p>And this is how it looks like:</p>\n\n<p><a href=\"https://i.stack.imgur.com/6wkYQ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/6wkYQ.png\" alt=\"enter image description here\"></a></p>\n\n<p>Or you can simply use the <code>.Comment</code> and not care about the loops and etc.</p>\n"}, {"comments": [{"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 1, "creation_date": 1517410528, "post_id": 48544938, "comment_id": 84085555, "body": "You have really spoiled my fun! :)"}], "tags": [], "owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "is_accepted": true, "score": 2, "last_activity_date": 1517410092, "creation_date": 1517410092, "answer_id": 48544938, "question_id": 48544436, "link": "https://stackoverflow.com/questions/48544436/writing-long-notetext/48544938#48544938", "title": "Writing long NoteText", "body": "<p>Rather than using the <code>NoteText</code> method, you can directly use the comment object, whose <code>Text</code> method doesn't have that annoying 255 character limit:</p>\n\n<pre><code>Sub test()\n    If Range(\"A1\").Comment Is Nothing Then Range(\"A1\").AddComment\n    Range(\"A1\").Comment.Text String(10000, \"*\")\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 503, "user_id": 4647519, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/f68a634c1a4a4cdfd8ab3452c4c35a2f?s=128&d=identicon&r=PG&f=1", "display_name": "tover", "link": "https://stackoverflow.com/users/4647519/tover"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 566, "favorite_count": 0, "accepted_answer_id": 48544938, "answer_count": 3, "score": 3, "last_activity_date": 1521478178, "creation_date": 1517408553, "last_edit_date": 1521478178, "question_id": 48544436, "link": "https://stackoverflow.com/questions/48544436/writing-long-notetext", "title": "Writing long NoteText", "body": "<p>I am trying to use VBA in Excel to write a comment. If the comment is short enough it works fine, however if it becomes too long it doesn't write a comment at all any more. In the following example it works if I cut the comment after the last ellipses. Is there any solution for that problem?</p>\n\n<pre><code>Sub longComment()\nCells(1, 3).NoteText Text:=\"Hello, I am a very long comment. Why can't I be written as a comment? It seems there is something very strange happening! Does anyone know what's wrong with me? How can I avoid this problem? See what happens when I add another line ... and another one ... and one more still!\"\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-project"], "comments": [{"owner": {"reputation": 6482, "user_id": 1056632, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7TOmD.jpg?s=128&g=1", "display_name": "Rachel Hettinger", "link": "https://stackoverflow.com/users/1056632/rachel-hettinger"}, "edited": false, "score": 0, "creation_date": 1518467737, "post_id": 48544415, "comment_id": 84511014, "body": "Ignore the downvote; it likely came from someone who knows nothing about MS Project. This is a perfectly reasonable MS Project VBA question."}], "answers": [{"tags": [], "owner": {"reputation": 6482, "user_id": 1056632, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7TOmD.jpg?s=128&g=1", "display_name": "Rachel Hettinger", "link": "https://stackoverflow.com/users/1056632/rachel-hettinger"}, "is_accepted": false, "score": 1, "last_activity_date": 1518465052, "creation_date": 1518465052, "answer_id": 48754436, "question_id": 48544415, "link": "https://stackoverflow.com/questions/48544415/getting-duration-time-units-of-a-task-in-vba/48754436#48754436", "title": "Getting Duration Time Units of a task in VBA", "body": "<p>Use the <a href=\"https://msdn.microsoft.com/en-us/vba/project-vba/articles/task-getfield-method-project\" rel=\"nofollow noreferrer\">GetField</a> method to return the task field value as <em>displayed in the user interface</em>. For example:</p>\n\n<pre><code>Public Function GetUnits() As String\n\n    Dim diplayValue As String\n    diplayValue = ActiveProject.Tasks(1).GetField(pjTaskDuration)\n    ' strip off numeric portion\n    GetUnits = Mid$(diplayValue, Len(CStr(Val(diplayValue))) + 1)\n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 59, "user_id": 8972331, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/6bfd8fb7b9d2267069d92e6d4f088902?s=128&d=identicon&r=PG&f=1", "display_name": "Andre Davis", "link": "https://stackoverflow.com/users/8972331/andre-davis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 812, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1593558888, "creation_date": 1517408495, "last_edit_date": 1593558888, "question_id": 48544415, "link": "https://stackoverflow.com/questions/48544415/getting-duration-time-units-of-a-task-in-vba", "title": "Getting Duration Time Units of a task in VBA", "body": "<p>Is there a method in VBA I can call to obtain the time unit (Such as d,ed,hr,min,etc.) of a specific task? I'm currently making a macro that takes a delta between 2 duration fields. I get the correct number but would like to attach a time unit to it.</p>\n"}, {"tags": ["vba", "ms-access", "ms-access-2007"], "comments": [{"owner": {"reputation": 83, "user_id": 5371731, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/86164a9fa7db14a9844aadfb117fff2d?s=128&d=identicon&r=PG&f=1", "display_name": "D.C.", "link": "https://stackoverflow.com/users/5371731/d-c"}, "reply_to_user": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1517428027, "post_id": 48544387, "comment_id": 84096561, "body": "@Andre: Thanks for supervising and the hint! :-)"}], "answers": [{"tags": [], "owner": {"reputation": 83, "user_id": 5371731, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/86164a9fa7db14a9844aadfb117fff2d?s=128&d=identicon&r=PG&f=1", "display_name": "D.C.", "link": "https://stackoverflow.com/users/5371731/d-c"}, "is_accepted": true, "score": 1, "last_activity_date": 1517560797, "creation_date": 1517560797, "answer_id": 48578788, "question_id": 48544387, "link": "https://stackoverflow.com/questions/48544387/user-defined-events-in-access-2007-doesnt-work-properly/48578788#48578788", "title": "User-defined events in Access 2007 doesn&#39;t work properly", "body": "<p>It seems that the <code>Property</code> itself must be declared as <code>Static</code>:</p>\n\n<pre><code>Public Static Property Get objController() As Controller\n    Static c As Controller\n\n    If c Is Nothing Then _\n        Set c = New Controller\n\n    Set objController = c\nEnd Property\n</code></pre>\n\n<p>Since then it works fine.</p>\n"}], "owner": {"reputation": 83, "user_id": 5371731, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/86164a9fa7db14a9844aadfb117fff2d?s=128&d=identicon&r=PG&f=1", "display_name": "D.C.", "link": "https://stackoverflow.com/users/5371731/d-c"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 46, "favorite_count": 0, "accepted_answer_id": 48578788, "answer_count": 1, "score": 2, "last_activity_date": 1517560797, "creation_date": 1517408420, "last_edit_date": 1517425738, "question_id": 48544387, "link": "https://stackoverflow.com/questions/48544387/user-defined-events-in-access-2007-doesnt-work-properly", "title": "User-defined events in Access 2007 doesn&#39;t work properly", "body": "<p>I have some trouble with user-defined events in Access 2007:</p>\n\n<p>The events are declared within a class module - let's name this class <code>Controller</code> - as follows (simplified code examples):</p>\n\n<pre><code>Public Event EventA()\n\n[...]\n\nPublic Property Let PropertyA(RHS As String)\n    mPropertyA = RHS\n    RaiseEvent EventA\nEnd Property\n\n[...]\n</code></pre>\n\n<p>The class is instantiated in a module as a <a href=\"https://accessexperts.com/blog/2011/07/26/self-healing-objects/\" rel=\"nofollow noreferrer\" title=\"SELF-HEALING OBJECTS\">\"self-healing\" object</a> as follows:</p>\n\n<pre><code>Public Property Get objController() As Controller\n    Static c As Controller\n\n    If c Is Nothing Then _\n        Set c = New Controller\n\n    Set objController = c\nEnd Property\n</code></pre>\n\n<p>In a form the <code>Controller</code> class is declared and set within the sub <code>Form_Load()</code> as follows:</p>\n\n<pre><code>Private WithEvents mController  As Controller\n\n[...]\n\nPrivate Sub Form_Load()\n    [...]\n    Set mController = objController\n    [...]\nEnd Sub\n</code></pre>\n\n<p>Within the same form I implemented the event actions:</p>\n\n<pre><code>Private Sub mController_EventA()\n    [...]\n    Me!PropertyA = mController.PropertyA\n    [...]\nEnd Sub\n</code></pre>\n\n<p>After clicking a button on the form a dialog form with a treeview is opened. After clicking a node in the treeview <code>PropertyA</code> in the <code>Controller</code> object is changed:</p>\n\n<pre><code>Private Sub tvwRDS_NodeClick(ByVal node As Object)\n    [...]\n    objController.PropertyA = node.key\n    [...]\nEnd Sub\n</code></pre>\n\n<p>My intention was this:</p>\n\n<ol>\n<li>You click a node.</li>\n<li><code>PropertyA</code> of instantiated class <code>Controller</code> is set, and event <code>EventA()</code> is raised.</li>\n<li>Main form is handling the event; controls in the form are updated.</li>\n</ol>\n\n<p>The first time everything worked as intended. After using the Compact and Repair feature as well as after compiling and creating an ACCDE file the sub <code>mController_EventA()</code> seems to be lost in space: nothing happens after the event was fired. Why that?!</p>\n\n<p>The <code>WithEvents</code> clause is only allowed in object modules. But I need to instantiate self-healing objects from a normal module.</p>\n\n<p>Thanks a lot in advance!</p>\n\n<p>D.C.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "edited": false, "score": 0, "creation_date": 1517410172, "post_id": 48544272, "comment_id": 84085273, "body": "What do you mean with &quot;it crashes&quot;? Do you get an error message?"}, {"owner": {"reputation": 655, "user_id": 5183031, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ea1e2e43efd4e65f4b06cff36e36f1f6?s=128&d=identicon&r=PG&f=1", "display_name": "Mr.Riply", "link": "https://stackoverflow.com/users/5183031/mr-riply"}, "reply_to_user": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "edited": false, "score": 0, "creation_date": 1517410372, "post_id": 48544272, "comment_id": 84085437, "body": "Nope, no error message, literally crashes, stops working and I have to force close Excel"}, {"owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "edited": false, "score": 0, "creation_date": 1517411289, "post_id": 48544272, "comment_id": 84086157, "body": "How many files are in the folder? Not only the ones you see with windows explorer also the hidden ones!"}, {"owner": {"reputation": 655, "user_id": 5183031, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ea1e2e43efd4e65f4b06cff36e36f1f6?s=128&d=identicon&r=PG&f=1", "display_name": "Mr.Riply", "link": "https://stackoverflow.com/users/5183031/mr-riply"}, "reply_to_user": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "edited": false, "score": 0, "creation_date": 1517411581, "post_id": 48544272, "comment_id": 84086349, "body": "About 1500 files, each file on average has 500kb, and every 15/20 min additional files are uploaded/created... I thought  the issue was potentially the way I try to access the network folder"}, {"owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "edited": false, "score": 1, "creation_date": 1517411951, "post_id": 48544272, "comment_id": 84086597, "body": "Your code is working fine for me, so difficult to tell what the problem is, at least for me. 1500 files should be no problem ... but I only have around 100 files in the folder I tested."}, {"owner": {"reputation": 655, "user_id": 5183031, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ea1e2e43efd4e65f4b06cff36e36f1f6?s=128&d=identicon&r=PG&f=1", "display_name": "Mr.Riply", "link": "https://stackoverflow.com/users/5183031/mr-riply"}, "reply_to_user": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "edited": false, "score": 0, "creation_date": 1517412330, "post_id": 48544272, "comment_id": 84086886, "body": "Hmm, it may be the PC.... Thank you for your help, at least I know the code is working :D"}, {"owner": {"reputation": 1444, "user_id": 9122140, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6207fe125b0cbaefce70e98e5ce2c6f?s=128&d=identicon&r=PG&f=1", "display_name": "AcsErno", "link": "https://stackoverflow.com/users/9122140/acserno"}, "edited": false, "score": 0, "creation_date": 1517487725, "post_id": 48544272, "comment_id": 84120864, "body": "The issue may be at the string length as MsgBox is limited to 1024 chars. Though it should not crash... Or you could put some checkpoints in there (<code>Debug.Print</code>) like before <code>For each</code> and after <code>msg = msg &amp;...</code> Or you can try the <code>Dir</code> function."}, {"owner": {"reputation": 655, "user_id": 5183031, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ea1e2e43efd4e65f4b06cff36e36f1f6?s=128&d=identicon&r=PG&f=1", "display_name": "Mr.Riply", "link": "https://stackoverflow.com/users/5183031/mr-riply"}, "edited": false, "score": 0, "creation_date": 1517488265, "post_id": 48544272, "comment_id": 84121244, "body": "well, it shouldn&#39;t be a problem, because the message box will show 6 lines at most, and when I run it with my test file path it works... the issue is that it is a network folder, and I just realized it is an FTP network folder if that makes a difference :/"}, {"owner": {"reputation": 655, "user_id": 5183031, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ea1e2e43efd4e65f4b06cff36e36f1f6?s=128&d=identicon&r=PG&f=1", "display_name": "Mr.Riply", "link": "https://stackoverflow.com/users/5183031/mr-riply"}, "edited": false, "score": 0, "creation_date": 1520521864, "post_id": 48544272, "comment_id": 85357961, "body": "UPDATE after a while. the code above works perfectly. The issue was that the folder it was accessing had way to many files to check which would eventually freeze Excel... Solution posted above"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1520533867, "post_id": 48544272, "comment_id": 85365665, "body": "solution should go as answer"}, {"owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "edited": false, "score": 0, "creation_date": 1577799992, "post_id": 48544272, "comment_id": 105258716, "body": "@Mr.Riply- if you have answered the question, please place it in the answer box, then mark as solved"}], "owner": {"reputation": 655, "user_id": 5183031, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ea1e2e43efd4e65f4b06cff36e36f1f6?s=128&d=identicon&r=PG&f=1", "display_name": "Mr.Riply", "link": "https://stackoverflow.com/users/5183031/mr-riply"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 671, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1520602406, "creation_date": 1517408120, "last_edit_date": 1531164843, "question_id": 48544272, "link": "https://stackoverflow.com/questions/48544272/getting-the-list-of-files-from-a-network-folder", "title": "Getting the list of files from a network folder", "body": "<p>I am having trouble accessing the network folder from which I would like to copy certain files. I have put together the following code, which for now only prints out the specific files created today. </p>\n\n<p>The issue I'm having is accessing the network folder, with the regular file path it works perfectly, but when I swap it for the network mapped folder it crashes.</p>\n\n<pre><code>Sub NetworkFiles()\n        Dim n As String, msg As String, d As Date\n        msg = \"\"\n        Set FSO = CreateObject(\"Scripting.FileSystemObject\")\n        Set fils = FSO.GetFolder(\"\\\\corp-server\\HostingFolder\").Files '(\"C:\\FILES\") works perfectly\n        For Each fil In fils\n\n            n = fil.name\n            n = Left(n, 24)\n            d = fil.DateLastModified   'DateCreated\n\n            If n = \"FILE_CHARACTERS_ARE_RANDOM_AFTER_THIS_POINT\" Then\n                If d &gt;= Date Then\n                    msg = msg &amp; n &amp; vbTab &amp; d &amp; vbCrLf\n                End If\n            End If\n        Next fil\n        If msg = \"\" Then\n            MsgBox \"No new files\"\n        Else\n            MsgBox msg\n        End If\n        Set FSO = Nothing\n    End Sub\n</code></pre>\n\n<p><strong><em>SOLVED</em></strong> - loops extremely quickly through an entire folder with 5k+ files</p>\n\n<p><strong><em>ANSWER</em></strong></p>\n\n<pre><code>Sub LoopThroughFiles()\n\n    Dim file As Variant\n    Dim fso As Object\n\n    Source = \"\\\\networkpath\\test\" \n    file = Dir(Source)\n    destloc = \"C:\\test\\folder\"\n\n\n    msg = \"\"\n\n    While (file &lt;&gt; \"\")\n\n        If InStr(file, \"TEST_partOfTheFileString\" &amp; Format(Date, \"YYYYMMDD\")) &gt; 0 Then\n\n            FileCopy Source &amp; file, destloc &amp; file\n            msg = msg &amp; file &amp; vbCrLf\n\n        End If\n        file = Dir\n\n    Wend\n\n    MsgBox msg &amp; \"Files Copied\"\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1118, "user_id": 8282232, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/775ef4ecf830083680ae6dbae8da395c?s=128&d=identicon&r=PG&f=1", "display_name": "AntiDrondert", "link": "https://stackoverflow.com/users/8282232/antidrondert"}, "edited": false, "score": 0, "creation_date": 1517408011, "post_id": 48544046, "comment_id": 84083589, "body": "Related: <a href=\"https://stackoverflow.com/questions/23087446/excel-vba-wildcard-search\">Excel VBA wildcard search</a>"}], "answers": [{"comments": [{"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 110, "user_id": 7917668, "user_type": "registered", "accept_rate": 92, "profile_image": "https://graph.facebook.com/10155161495649840/picture?type=large", "display_name": "Artur Albert Hamelak", "link": "https://stackoverflow.com/users/7917668/artur-albert-hamelak"}, "edited": false, "score": 0, "creation_date": 1517408216, "post_id": 48544150, "comment_id": 84083737, "body": "@ArturAlbertHamelak  - in my code change <code>A1:A9</code> to <code>C2:C33</code>. Then copy the code 2 more times, changing further to <code>C34:C35</code> and to <code>C36:C43</code>."}, {"owner": {"reputation": 110, "user_id": 7917668, "user_type": "registered", "accept_rate": 92, "profile_image": "https://graph.facebook.com/10155161495649840/picture?type=large", "display_name": "Artur Albert Hamelak", "link": "https://stackoverflow.com/users/7917668/artur-albert-hamelak"}, "edited": false, "score": 0, "creation_date": 1517408415, "post_id": 48544150, "comment_id": 84083896, "body": "but how do i set it in way that <code>MsgBox</code> will show <code>r</code> from original loop and the <code>myCell</code> in the same box?"}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": true, "score": 1, "last_activity_date": 1517407724, "creation_date": 1517407724, "answer_id": 48544150, "question_id": 48544046, "link": "https://stackoverflow.com/questions/48544046/msgbox-value-that-starts-with-4-above-found-value/48544150#48544150", "title": "MsgBox value that starts with 4 above found value.", "body": "<p>Try like this:</p>\n\n<pre><code>Public Sub TestMe()\n\n    Dim bigRange    As Range\n    Dim myCell      As Range\n\n    Set bigRange = Worksheets(2).Range(\"A1:A9\")\n    For Each myCell In bigRange\n        If Left(myCell, 1) = 4 Then\n            MsgBox myCell\n            Exit For\n        End If\n    Next myCell\n\nEnd Sub\n</code></pre>\n\n<p>It will simply loop through the cells in the <code>bigRange</code> and check whether the first character of the cell is <code>4</code>. If it is <code>4</code>, it shows the <code>MsgBox</code> and it exits the loop.</p>\n"}, {"tags": [], "owner": {"reputation": 4627, "user_id": 2572928, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TcMR5.png?s=128&g=1", "display_name": "David Rushton", "link": "https://stackoverflow.com/users/2572928/david-rushton"}, "is_accepted": false, "score": 1, "last_activity_date": 1517409661, "creation_date": 1517409661, "answer_id": 48544797, "question_id": 48544046, "link": "https://stackoverflow.com/questions/48544046/msgbox-value-that-starts-with-4-above-found-value/48544797#48544797", "title": "MsgBox value that starts with 4 above found value.", "body": "<p>I think you want something along these lines.  At a high level the code loops cell in the 1st column of your first sheet, to extract the customer ids.  Each id is searched for in the second sheet.  If found we work our way up (using the <a href=\"https://msdn.microsoft.com/en-us/vba/excel-vba/articles/range-offset-property-excel?f=255&amp;MSPPError=-2147217396\" rel=\"nofollow noreferrer\">offset property</a>) looking for a cell starting 4.</p>\n\n<pre><code>Sub findCustomer()\n    Dim customerWs As Worksheet         ' Ref to the customer worksheet.\n    Dim rawWs As Worksheet              ' Ref to the raw worksheet.\n    Dim currentCustomer As Range        ' Used to loop over all customers.\n    Dim findCustomer As Range           ' Used to search raw for current customer.\n    Dim offsetRow As Integer            ' Used to search above found customer for value starting 4.\n\n    Set customerWs = ThisWorkbook.Sheets(\"Sheet1\")\n    Set rawWs = ThisWorkbook.Sheets(\"Sheet2\")\n\n    ' Assumes all customer ids are located in the first column\n    ' of sheet 1.\n    ' Loop executed once for each cell in that column.\n    For Each currentCustomer In customerWs.UsedRange.Columns(1).Cells\n\n        ' Look for the current customer.\n        Set findCustomer = rawWs.Columns(1).Find(currentCustomer.Value)\n        If Not findCustomer Is Nothing Then\n\n            ' Found one.\n            ' Work up one row at a time looking for 4.\n            For offsetRow = 1 To (findCustomer.Row - 1)\n\n                If findCustomer.Offset(offsetRow * -1, 0).Value Like \"4*\" Then\n\n                    ' Match found.\n                    ' Inform user and exit.\n                    MsgBox \"Customer: \" &amp; findCustomer.Value &amp; \". 4 Found: \" &amp; findCustomer.Offset(offsetRow * -1, 0).Address &amp; \".\"\n                    Exit For\n                End If\n            Next\n        End If\n    Next\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 110, "user_id": 7917668, "user_type": "registered", "accept_rate": 92, "profile_image": "https://graph.facebook.com/10155161495649840/picture?type=large", "display_name": "Artur Albert Hamelak", "link": "https://stackoverflow.com/users/7917668/artur-albert-hamelak"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 43, "favorite_count": 0, "accepted_answer_id": 48544150, "answer_count": 2, "score": 0, "last_activity_date": 1517409661, "creation_date": 1517407451, "question_id": 48544046, "link": "https://stackoverflow.com/questions/48544046/msgbox-value-that-starts-with-4-above-found-value", "title": "MsgBox value that starts with 4 above found value.", "body": "<p>So I'm running a macro to find customer in raw data. Sheet 1 is customer list and sheet 2 is a lot of raw data. In the loop there is a <code>MsgBox</code> that shows if there is a customer in data. The data looks something like this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/CNcQp.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/CNcQp.png\" alt=\"\"></a></p>\n\n<p>How do i get <code>MsgBox</code> to show first value that starts with 4. </p>\n\n<p>Below is the code I'm using. </p>\n\n<pre><code>Public Sub TestMe()\n\nDim r1      As Variant\nDim r2      As Variant\nDim r3      As Variant\n\nDim rData   As Variant\nDim r       As Variant\nDim result  As Variant\n\nrData = Application.Transpose(Worksheets(2).Range(\"A:A\"))\n\nr1 = Application.Transpose(Worksheets(1).Range(\"C2:C33\"))\nr2 = Application.Transpose(Worksheets(1).Range(\"C34:C35\"))\nr3 = Application.Transpose(Worksheets(1).Range(\"C36:C43\"))\n\n\nFor Each r In r1\n    result = Application.Match(r, rData, 0)\n    If Not IsError(result) Then\n        MsgBox r\n    End If\nNext r\n\nFor Each r In r2\n    result = Application.Match(r, rData, 0)\n    If Not IsError(result) Then\n        MsgBox r\n    End If\nNext r\n\nFor Each r In r3\n    result = Application.Match(r, rData, 0)\n    If Not IsError(result) Then\n        MsgBox r\n    End If\nNext r\n\n\nMsgBox \"search ended.\"\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["regex", "vba", "email", "outlook"], "answers": [{"tags": [], "owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "is_accepted": false, "score": 0, "last_activity_date": 1517407348, "creation_date": 1517407348, "answer_id": 48544007, "question_id": 48543937, "link": "https://stackoverflow.com/questions/48543937/save-email-to-a-local-folder/48544007#48544007", "title": "Save email to a local folder", "body": "<p>Call <code>itm.SaveAs(..., olMsg)</code> to save in the MSG format</p>\n"}, {"tags": [], "owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "is_accepted": true, "score": 1, "last_activity_date": 1518132841, "creation_date": 1518132841, "answer_id": 48696525, "question_id": 48543937, "link": "https://stackoverflow.com/questions/48543937/save-email-to-a-local-folder/48696525#48696525", "title": "Save email to a local folder", "body": "<p><em>Try</em></p>\n\n<pre><code>    Dim FileName As String\n        FileName = Format(Date, \"yyyymmdd\") &amp; \"_\" &amp; objAtt.DisplayName\n\n    itm.SaveAs SaveFolder &amp; \"\\\" &amp; FileName &amp; \".msg\", olMsg\n</code></pre>\n\n<p><em>Also Replace invalid characters with empty strings, here I'm using Regex</em></p>\n\n<pre><code>For Each objAtt In itm.Attachments\n    Dim FileName As String\n        FileName = Format(Date, \"yyyymmdd\") &amp; \"_\" &amp; objAtt.DisplayName\n\n    objAtt.SaveAsFile SaveFolder &amp; \"\\\" &amp; FileName\n\n    Dim RegEx As Object\n    Set RegEx = CreateObject(\"vbscript.regexp\")\n    With RegEx\n        .Pattern = \"[^\\w\\@-]\"\n        .IgnoreCase = True\n        .Global = True\n    End With\n\n    FileName = RegEx.Replace(FileName, \" \")\n    itm.SaveAs SaveFolder &amp; \"\\\" &amp; FileName &amp; \".msg\", olMsg\nNext\n</code></pre>\n\n<p><em>Now test your code with <code>Selection.item(1)</code></em></p>\n\n<pre><code>Public Sub Test_Rule()\n    Dim olMsg As Outlook.mailitem\n\n    Set olMsg = ActiveExplorer.Selection.Item(1)\n    saveAttachtoDisk olMsg\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 37, "user_id": 9282994, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e17b26103fd7b7a6d8e9a80799035c57?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Sacek", "link": "https://stackoverflow.com/users/9282994/robin-sacek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 464, "favorite_count": 0, "accepted_answer_id": 48696525, "answer_count": 2, "score": 1, "last_activity_date": 1593071856, "creation_date": 1517407120, "last_edit_date": 1593071856, "question_id": 48543937, "link": "https://stackoverflow.com/questions/48543937/save-email-to-a-local-folder", "title": "Save email to a local folder", "body": "<p>How do I save email <code>(msg)</code>?</p>\n\n<p>This code creates a daily folder structure and saves email attachments but not the email itself.</p>\n\n<pre><code>Option Explicit\nPublic Sub saveAttachtoDisk(itm As Outlook.mailitem)\nDim objAtt As Outlook.Attachment\nDim SaveFolder As String\n\nSaveFolder = \"C:\\Temp\\\" &amp; Year(Date) &amp; \"\\\" &amp; Month(Date) &amp; \"\\\" &amp; Day(Date)\n\n' Check for folder and create if needed\nIf Len(Dir(\"C:\\Temp\\\" &amp; Year(Date), vbDirectory)) = 0 Then\n    MkDir \"C:\\Temp\\\" &amp; Year(Date)\nEnd If\n\nIf Len(Dir(\"C:\\Temp\\\" &amp; Year(Date) &amp; \"\\\" &amp; Month(Date), _\n                                         vbDirectory)) = 0 Then\n    MkDir \"C:\\Temp\\\" &amp; Year(Date) &amp; \"\\\" &amp; Month(Date)\nEnd If\n\nIf Len(Dir(\"C:\\Temp\\\" &amp; Year(Date) &amp; \"\\\" &amp; Month(Date) &amp; \"\\\" &amp; Day(Date), _\n                                                     vbDirectory)) = 0 Then\n    MkDir \"C:\\Temp\\\" &amp; Year(Date) &amp; \"\\\" &amp; Month(Date) &amp; \"\\\" &amp; Day(Date)\nEnd If\n\nFor Each objAtt In itm.Attachments\n    objAtt.SaveAsFile SaveFolder &amp; \"\\\" &amp; Format(Date, \"yyyymmdd\") &amp; \"_\" &amp; _\n                                                         objAtt.DisplayName\nNext\n\nSet objAtt = Nothing\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 145, "user_id": 8938363, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc77aca8ca2e6eabaaff2e84e8fa3dcb?s=128&d=identicon&r=PG&f=1", "display_name": "dadler", "link": "https://stackoverflow.com/users/8938363/dadler"}, "edited": false, "score": 0, "creation_date": 1517408373, "post_id": 48543881, "comment_id": 84083867, "body": "Can&#39;t you use <code>.FormatConditions.Delete</code> on the target range once you copy? Not optimal, but it might be the easier way of implementing it to your code"}, {"owner": {"reputation": 92, "user_id": 9184557, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/0212d49fc25078235a3888b31aef159f?s=128&d=identicon&r=PG&f=1", "display_name": "user9184557", "link": "https://stackoverflow.com/users/9184557/user9184557"}, "reply_to_user": {"reputation": 145, "user_id": 8938363, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc77aca8ca2e6eabaaff2e84e8fa3dcb?s=128&d=identicon&r=PG&f=1", "display_name": "dadler", "link": "https://stackoverflow.com/users/8938363/dadler"}, "edited": false, "score": 0, "creation_date": 1517409762, "post_id": 48543881, "comment_id": 84084972, "body": "i dont get it sorry...."}, {"owner": {"reputation": 145, "user_id": 8938363, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc77aca8ca2e6eabaaff2e84e8fa3dcb?s=128&d=identicon&r=PG&f=1", "display_name": "dadler", "link": "https://stackoverflow.com/users/8938363/dadler"}, "edited": false, "score": 0, "creation_date": 1517412233, "post_id": 48543881, "comment_id": 84086792, "body": "If I understand your problem correctly, you are trying to copy paste vales while keeping the formatting but removing the Conditional Formatting, right? If this is the case, after you paste your values onto <code>Range(&quot;B1:B2&quot;)</code>, do <code>Range(&quot;B1:B2&quot;).FormatConditions.Delete</code> , this should remove the conditional formatting of the range. Or do you wish to copy the cells and preserve the formatting applied by Conditional Formatting without it being conditional?"}, {"owner": {"reputation": 92, "user_id": 9184557, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/0212d49fc25078235a3888b31aef159f?s=128&d=identicon&r=PG&f=1", "display_name": "user9184557", "link": "https://stackoverflow.com/users/9184557/user9184557"}, "reply_to_user": {"reputation": 145, "user_id": 8938363, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc77aca8ca2e6eabaaff2e84e8fa3dcb?s=128&d=identicon&r=PG&f=1", "display_name": "dadler", "link": "https://stackoverflow.com/users/8938363/dadler"}, "edited": false, "score": 0, "creation_date": 1517413012, "post_id": 48543881, "comment_id": 84087344, "body": "I don&#39;t want to change/update the values I have on B1 and B2, I just want to get the color I have under A1 &amp; and A2 to B1 &amp; B2 without merging the cells."}, {"owner": {"reputation": 145, "user_id": 8938363, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc77aca8ca2e6eabaaff2e84e8fa3dcb?s=128&d=identicon&r=PG&f=1", "display_name": "dadler", "link": "https://stackoverflow.com/users/8938363/dadler"}, "edited": false, "score": 0, "creation_date": 1517413316, "post_id": 48543881, "comment_id": 84087567, "body": "If you want the color of a cell after conditional formatting has been applied then you need <code>Cells(1,1).DisplayFormat.Interior.Color</code>"}], "answers": [{"tags": [], "owner": {"reputation": 13, "user_id": 6565252, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-iGp2OO93asA/AAAAAAAAAAI/AAAAAAAAACU/p8bmMM21Pbc/photo.jpg?sz=128", "display_name": "Prem Kumar", "link": "https://stackoverflow.com/users/6565252/prem-kumar"}, "is_accepted": false, "score": 0, "last_activity_date": 1593550035, "creation_date": 1593550035, "answer_id": 62665904, "question_id": 48543881, "link": "https://stackoverflow.com/questions/48543881/copy-colors-but-not-conditional-formatting/62665904#62665904", "title": "Copy Colors but not conditional formatting", "body": "<p>Copy A1:A2 and paste directly in a new ms-word doc. Then again copy this from ms-word and paste it anywhere in excel (say C1:C2). Now copy format from C1:C2 and paste at required range as mentioned B1:B2. Delete C1:C2 now. This is how I manege in such scenario !!</p>\n"}, {"tags": [], "owner": {"reputation": 278, "user_id": 10122801, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/--6lbnJnd-xQ/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7oYuHOsALAxSc_52z-07zYikmrLuQ/mo/photo.jpg?sz=128", "display_name": "Havard Kleven", "link": "https://stackoverflow.com/users/10122801/havard-kleven"}, "is_accepted": false, "score": 0, "last_activity_date": 1593552111, "creation_date": 1593552111, "answer_id": 62666335, "question_id": 48543881, "link": "https://stackoverflow.com/questions/48543881/copy-colors-but-not-conditional-formatting/62666335#62666335", "title": "Copy Colors but not conditional formatting", "body": "<p>I would create a function to detect the backcolor (.Interor) if desired cells, and store these values as your \u201cCopied colors\u201d.</p>\n<p>Example of a function to get the RGB-value of a desired cell:</p>\n<pre><code>Function getRGB(rcell) As String\n    Dim colorVal As String\n\n    colorVal = Right(&quot;000000&quot; &amp; Hex(rcell.Interior.Color), 6)\n    getRGB = Right(colorVal, 2) &amp; Mid(colorVal, 3, 2) &amp; Left(colorVal, 2)\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 92, "user_id": 9184557, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/0212d49fc25078235a3888b31aef159f?s=128&d=identicon&r=PG&f=1", "display_name": "user9184557", "link": "https://stackoverflow.com/users/9184557/user9184557"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2426, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1593563242, "creation_date": 1517406974, "last_edit_date": 1593563242, "question_id": 48543881, "link": "https://stackoverflow.com/questions/48543881/copy-colors-but-not-conditional-formatting", "title": "Copy Colors but not conditional formatting", "body": "<p>Please help me to understand how to Copy Colors from a specific cell but not conditional formatting. </p>\n\n<p>For example</p>\n\n<p>My Range A1 and A2 are merged cell with red color and with some value on it and I have to copy only that red color to Range B1 and B2 which have some different values. Is there any provision to satisfy it?</p>\n\n<p>I tried</p>\n\n<pre><code>Range(\"A1:A2\").Copy\n\nRange(\"B1:B2\").PasteSpecial Paste:=xlPasteFormats, Operation:=xlNone, _\nSkipBlanks:=False, Transpose:=False\n</code></pre>\n\n<p>but this will copy paste and merge the cell B1 and B2</p>\n"}, {"tags": ["vba", "excel", "concatenation"], "comments": [{"owner": {"reputation": 492, "user_id": 7434553, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/s4dbF.png?s=128&g=1", "display_name": "IQV", "link": "https://stackoverflow.com/users/7434553/iqv"}, "edited": false, "score": 0, "creation_date": 1517407178, "post_id": 48543875, "comment_id": 84083023, "body": "What are your input values in J3 and M3?"}, {"owner": {"reputation": 63, "user_id": 9161847, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e63e05c1f21d067780317c2827fcf350?s=128&d=identicon&r=PG&f=1", "display_name": "Mehdi Flame", "link": "https://stackoverflow.com/users/9161847/mehdi-flame"}, "reply_to_user": {"reputation": 492, "user_id": 7434553, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/s4dbF.png?s=128&g=1", "display_name": "IQV", "link": "https://stackoverflow.com/users/7434553/iqv"}, "edited": false, "score": 0, "creation_date": 1517407261, "post_id": 48543875, "comment_id": 84083093, "body": "J3 holds the value 1500.60 and M3 holds the value 700.20"}, {"owner": {"reputation": 492, "user_id": 7434553, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/s4dbF.png?s=128&g=1", "display_name": "IQV", "link": "https://stackoverflow.com/users/7434553/iqv"}, "edited": false, "score": 1, "creation_date": 1517407760, "post_id": 48543875, "comment_id": 84083426, "body": "How are H4, J3 and M3 formatted? Are these numbers or strings?"}, {"owner": {"reputation": 63, "user_id": 9161847, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e63e05c1f21d067780317c2827fcf350?s=128&d=identicon&r=PG&f=1", "display_name": "Mehdi Flame", "link": "https://stackoverflow.com/users/9161847/mehdi-flame"}, "reply_to_user": {"reputation": 492, "user_id": 7434553, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/s4dbF.png?s=128&g=1", "display_name": "IQV", "link": "https://stackoverflow.com/users/7434553/iqv"}, "edited": false, "score": 0, "creation_date": 1517408332, "post_id": 48543875, "comment_id": 84083833, "body": "they were formatted as strings i converted them to numbers (manually) and run the code and it worked like a charm thanks :) . how can avoid this type of problems directly in vba for example can i  i convert the cell value to numbers then use the range(&quot;j3&quot;).value+range(&quot;m3&quot;) diretly while coding ?"}, {"owner": {"reputation": 492, "user_id": 7434553, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/s4dbF.png?s=128&g=1", "display_name": "IQV", "link": "https://stackoverflow.com/users/7434553/iqv"}, "reply_to_user": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1517408415, "post_id": 48543875, "comment_id": 84083895, "body": "Use @braX answer below. The <code>val</code>-function converts strings to numbers."}], "answers": [{"tags": [], "owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "is_accepted": true, "score": 3, "last_activity_date": 1517408014, "creation_date": 1517408014, "answer_id": 48544232, "question_id": 48543875, "link": "https://stackoverflow.com/questions/48543875/numbers-are-being-concatenated-instead-of-being-summed/48544232#48544232", "title": "Numbers are being concatenated instead of being summed", "body": "<p>Use the <code>Val</code> function to convert them to numbers if they are formatted as strings:</p>\n\n<pre><code>worksheet(\"tableau\").Range(\"h4\").Value = Val(worksheet(\"Company\").Range(\"J3\").Value) + Val(worksheet(\"Company\").Range(\"M3\").Value)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 63, "user_id": 9161847, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e63e05c1f21d067780317c2827fcf350?s=128&d=identicon&r=PG&f=1", "display_name": "Mehdi Flame", "link": "https://stackoverflow.com/users/9161847/mehdi-flame"}, "edited": false, "score": 0, "creation_date": 1517408585, "post_id": 48544324, "comment_id": 84084039, "body": "Your code is more cleaner and easier to understand for a beginner like me i ll use this version thanks."}], "tags": [], "owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "is_accepted": false, "score": 1, "last_activity_date": 1517408258, "creation_date": 1517408258, "answer_id": 48544324, "question_id": 48543875, "link": "https://stackoverflow.com/questions/48543875/numbers-are-being-concatenated-instead-of-being-summed/48544324#48544324", "title": "Numbers are being concatenated instead of being summed", "body": "<p>You could specify these values as numbers:</p>\n\n<pre><code>Dim i as Long, j as Long\ni = worksheet(\"Company\").Range(\"J3\").Value\nj = worksheet(\"Company\").Range(\"M3\").Value\nworksheet(\"tableau\").Range(\"h4\").Value = i + j\n</code></pre>\n\n<hr>\n\n<p>Edit: This is similar to @braX comment, just another way of doing the work.</p>\n"}], "owner": {"reputation": 63, "user_id": 9161847, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e63e05c1f21d067780317c2827fcf350?s=128&d=identicon&r=PG&f=1", "display_name": "Mehdi Flame", "link": "https://stackoverflow.com/users/9161847/mehdi-flame"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 30, "favorite_count": 0, "accepted_answer_id": 48544232, "answer_count": 2, "score": 0, "last_activity_date": 1517408258, "creation_date": 1517406955, "last_edit_date": 1531164843, "question_id": 48543875, "link": "https://stackoverflow.com/questions/48543875/numbers-are-being-concatenated-instead-of-being-summed", "title": "Numbers are being concatenated instead of being summed", "body": "<p>I am trying to add the value of cell <code>J3</code> to <code>M3</code> in worksheet \"tableau\" and put the sum in cell <code>H4</code> in worksheet \"Company\". However, when I write this code it returns the concatenated value something like 1500.60700.20 </p>\n\n<p>What could be the issue? I am new to Vba excel so please bear that in mind.</p>\n\n<pre><code>worksheet(\"tableau\").Range(\"h4\").Value = worksheet(\"Company\").Range(\"J3\").Value + worksheet(\"Company\").Range(\"M3\").Value\n</code></pre>\n"}, {"tags": ["sql", "vba", "excel", "ms-access"], "comments": [{"owner": {"reputation": 2334, "user_id": 7948962, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b64557f8a617effccaf4426f16e9035?s=128&d=identicon&r=PG&f=1", "display_name": "Jacob H", "link": "https://stackoverflow.com/users/7948962/jacob-h"}, "edited": false, "score": 0, "creation_date": 1517407035, "post_id": 48543839, "comment_id": 84082927, "body": "There&#39;s probably a more straightforward way to remove duplicates here. What are the table structures, sample data and expected results?"}, {"owner": {"reputation": 17, "user_id": 8951894, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/178326798744d72ebfa1af4ccf2c9d99?s=128&d=identicon&r=PG&f=1", "display_name": "urvashi", "link": "https://stackoverflow.com/users/8951894/urvashi"}, "reply_to_user": {"reputation": 2334, "user_id": 7948962, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b64557f8a617effccaf4426f16e9035?s=128&d=identicon&r=PG&f=1", "display_name": "Jacob H", "link": "https://stackoverflow.com/users/7948962/jacob-h"}, "edited": false, "score": 0, "creation_date": 1517407473, "post_id": 48543839, "comment_id": 84083256, "body": "lets take a example :  Table A : ---------- number 1 2 3   Table B: ---------- Number 1  Table C: ---------- Number 2  expected results : 3"}, {"owner": {"reputation": 17, "user_id": 8951894, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/178326798744d72ebfa1af4ccf2c9d99?s=128&d=identicon&r=PG&f=1", "display_name": "urvashi", "link": "https://stackoverflow.com/users/8951894/urvashi"}, "reply_to_user": {"reputation": 2334, "user_id": 7948962, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b64557f8a617effccaf4426f16e9035?s=128&d=identicon&r=PG&f=1", "display_name": "Jacob H", "link": "https://stackoverflow.com/users/7948962/jacob-h"}, "edited": false, "score": 0, "creation_date": 1517410555, "post_id": 48543839, "comment_id": 84085579, "body": "maybe this will do:  SELECT A.Role FROM (A LEFT JOIN B ON (A.Role=B.Role) WHERE A.Role IS NULL) LEFT JOIN C ON (A.Role=C.Role) WHERE C.Role IS NULL&quot;  But there is some parentheses error i guess"}], "answers": [{"comments": [{"owner": {"reputation": 17, "user_id": 8951894, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/178326798744d72ebfa1af4ccf2c9d99?s=128&d=identicon&r=PG&f=1", "display_name": "urvashi", "link": "https://stackoverflow.com/users/8951894/urvashi"}, "edited": false, "score": 0, "creation_date": 1517417447, "post_id": 48545978, "comment_id": 84090455, "body": "You are the champ brother. thanx a much"}], "tags": [], "owner": {"reputation": 398, "user_id": 5252221, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1542536215d9005daab256039450137b?s=128&d=identicon&r=PG&f=1", "display_name": "Marta B", "link": "https://stackoverflow.com/users/5252221/marta-b"}, "is_accepted": true, "score": 0, "last_activity_date": 1517413273, "creation_date": 1517413273, "answer_id": 48545978, "question_id": 48543839, "link": "https://stackoverflow.com/questions/48543839/issue-while-using-left-join-with-full-outer-join/48545978#48545978", "title": "issue while using left join with full outer join", "body": "<p>If I get it, you have 3 tables: A, B, and C.\nYou want the values of table A that does not exists in B and C.</p>\n\n<p>This is a away:</p>\n\n<pre><code>SELECT  A.Role \nFROM A \n    LEFT JOIN ( SELECT B.Role \n                From B \n                UNION \n                SELECT C.Role \n                From C) D ON\n        D.ROLE = A.ROLE\nWHERE D.ROLE IS NULL\n</code></pre>\n\n<p>Other away:</p>\n\n<pre><code>SELECT  A.Role \nFROM A \nWHERE A.ROLE NOT IN (   SELECT B.Role \n                        From B \n                        UNION \n                        SELECT C.Role \n                        From C)\n</code></pre>\n\n<p>or still:</p>\n\n<pre><code>SELECT  A.Role \nFROM A \n    LEFT JOIN B ON\n        B.ROLE = A.ROLE\n    LEFT JOIN c ON\n        c.ROLE = A.ROLE\nWHERE B.ROLE IS NULL and C.ROLE IS NULL\n</code></pre>\n"}], "owner": {"reputation": 17, "user_id": 8951894, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/178326798744d72ebfa1af4ccf2c9d99?s=128&d=identicon&r=PG&f=1", "display_name": "urvashi", "link": "https://stackoverflow.com/users/8951894/urvashi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 0, "accepted_answer_id": 48545978, "answer_count": 1, "score": 0, "last_activity_date": 1517413273, "creation_date": 1517406855, "last_edit_date": 1531164843, "question_id": 48543839, "link": "https://stackoverflow.com/questions/48543839/issue-while-using-left-join-with-full-outer-join", "title": "issue while using left join with full outer join", "body": "<p>I have the following code :</p>\n\n<pre><code>      Dim rsD As ADODB.Recordset\n      Dim sqlD As String\n      Set rsD = New ADODB.Recordset\n       sqlD = \"SELECT A.Role FROM A LEFT JOIN (SELECT \n            DISTINCT * FROM (SELECT B.Role From B LEFT JOIN \n            C ON(B.Role=C.Role) \n            UNION ALL SELECT C.Role From C LEFT JOIN B\n            ON(C.Role=B.Role))) \n            AS B ON (A.Role=B.Role) WHERE \n            (B.Role IS NULL)\"\n             rsD.Open sqlD, conn, adOpenStatic\n             While Not rsD.EOF\n            wb.Worksheets(3).Range(\"A2\").CopyFromRecordset rsD\n            Wend\n\n             rsD.Close\n\n    Set wb = Nothing\n</code></pre>\n\n<p>What I want to do:  inner select is for FULL OUTER JOIN so it takes the values from both table B and C and remove the duplicates.\nThen the outer select filters out the value which are there in Table A but are not there in Table B and C with the help of left join and NULL.</p>\n\n<p>But i think there is some issue with the outer select due to which proper data is not coming.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 3423, "user_id": 1738572, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/s0VGr.jpg?s=128&g=1", "display_name": "Greg Viers", "link": "https://stackoverflow.com/users/1738572/greg-viers"}, "edited": false, "score": 0, "creation_date": 1517405885, "post_id": 48543468, "comment_id": 84082076, "body": "Can you give an example of what the formula is supposed to look like for a certain NewEngineRowNumber value?"}, {"owner": {"reputation": 293, "user_id": 9057518, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/067764a3e2e917197a58401710c76654?s=128&d=identicon&r=PG&f=1", "display_name": "CptGoodar", "link": "https://stackoverflow.com/users/9057518/cptgoodar"}, "reply_to_user": {"reputation": 3423, "user_id": 1738572, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/s0VGr.jpg?s=128&g=1", "display_name": "Greg Viers", "link": "https://stackoverflow.com/users/1738572/greg-viers"}, "edited": false, "score": 0, "creation_date": 1517405991, "post_id": 48543468, "comment_id": 84082154, "body": "just added a edit Greg, does that help you"}, {"owner": {"reputation": 7497, "user_id": 8670372, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ir8a4Lbosmo/AAAAAAAAAAI/AAAAAAAAOtE/2eY5jK1atcc/photo.jpg?sz=128", "display_name": "Xabier", "link": "https://stackoverflow.com/users/8670372/xabier"}, "edited": false, "score": 0, "creation_date": 1517406078, "post_id": 48543468, "comment_id": 84082230, "body": "You should remove the .Address(0, 0) from your formula..."}, {"owner": {"reputation": 3423, "user_id": 1738572, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/s0VGr.jpg?s=128&g=1", "display_name": "Greg Viers", "link": "https://stackoverflow.com/users/1738572/greg-viers"}, "edited": false, "score": 0, "creation_date": 1517406089, "post_id": 48543468, "comment_id": 84082238, "body": "That&#39;s better, but the formula you show is not a valid formula. If I put =Cells(BX) in the formula bar I&#39;m going to get a NAME error."}], "answers": [{"comments": [{"owner": {"reputation": 293, "user_id": 9057518, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/067764a3e2e917197a58401710c76654?s=128&d=identicon&r=PG&f=1", "display_name": "CptGoodar", "link": "https://stackoverflow.com/users/9057518/cptgoodar"}, "edited": false, "score": 0, "creation_date": 1517407321, "post_id": 48543956, "comment_id": 84083136, "body": "Thank you so much. This was an attempt at editing a previous method that worked which sum a column. I sued Sum as that what I would have written in the cell Manually. Thank you ever so much :) #"}], "tags": [], "owner": {"reputation": 42107, "user_id": 3915431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ad2fe8d0c0e72bdbe3623e85a96b9b4?s=128&d=identicon&r=PG&f=1", "display_name": "Axel Richter", "link": "https://stackoverflow.com/users/3915431/axel-richter"}, "is_accepted": true, "score": 1, "last_activity_date": 1517407403, "last_edit_date": 1517407403, "creation_date": 1517407164, "answer_id": 48543956, "question_id": 48543468, "link": "https://stackoverflow.com/questions/48543468/getting-vba-to-display-a-formula-with-subtracting/48543956#48543956", "title": "Getting VBA to display a formula with Subtracting", "body": "<p>Don't try doing all in one code line. Do separating it in multiple code lines is better for debugging:</p>\n\n<pre><code>With Worksheets(c10)\n sAddress1 = .Cells(NewEngineRowNumber + 6, 2).Address(0, 0)\n sAddress2 = .Cells(NewEngineRowNumber + 2, 2).Address(0, 0)\n sFormula = \"=Sum(\" &amp; sAddress1 &amp; \"-\" &amp; sAddress2 &amp; \")\"\n\n .Cells(NewEngineRowNumber + 3, 2).Formula = sFormula\nEnd With\n</code></pre>\n\n<p>But why are you thinking the <code>SUM</code> is necessary at all?</p>\n\n<pre><code> sFormula = \"=\" &amp; sAddress1 &amp; \"-\" &amp; sAddress2\n</code></pre>\n\n<p>should also work.</p>\n"}], "owner": {"reputation": 293, "user_id": 9057518, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/067764a3e2e917197a58401710c76654?s=128&d=identicon&r=PG&f=1", "display_name": "CptGoodar", "link": "https://stackoverflow.com/users/9057518/cptgoodar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 255, "favorite_count": 0, "accepted_answer_id": 48543956, "answer_count": 1, "score": 0, "last_activity_date": 1517407403, "creation_date": 1517405711, "last_edit_date": 1517406250, "question_id": 48543468, "link": "https://stackoverflow.com/questions/48543468/getting-vba-to-display-a-formula-with-subtracting", "title": "Getting VBA to display a formula with Subtracting", "body": "<p>I asked a question yesterday on how to use VBA to display formulas within cells, which I now can use, except for my attempt at a subtraction. </p>\n\n<p>I have my code here, is anyone able to point me in the right direction to get this to work. </p>\n\n<pre><code>With Worksheets(c10)\n.Cells(NewEngineRowNumber + 3, 2).Formula = \"=Sum((\" &amp; .Range(.Cells(NewEngineRowNumber + 6, 2)).Address(0, 0) &amp; \") - (\" &amp; .Range(.Cells(NewEngineRowNumber + 2, 2)).Address(0, 0) &amp; \"))\" \nEnd With\n</code></pre>\n\n<p>I belived this to be the most likly method after a few different attempt to make it work. </p>\n\n<p>To produce something like in <code>Cells(NewEngineRowNumber+3,2)</code> in the formula bar to display <code>=Cells(BX) - Cells(BY)</code>, where X = NewEngineRowNumber +6 and Y = NewEngineRowNumber +2</p>\n\n<p>Any help in helping me  understand how to edit this to make it work would be much appreciated. </p>\n\n<p>Thanks </p>\n"}, {"tags": ["vba", "oracle", "excel"], "comments": [{"owner": {"reputation": 158803, "user_id": 246342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8ba0aea3f521082f18dd7c186e7d4c3?s=128&d=identicon&r=PG", "display_name": "Alex K.", "link": "https://stackoverflow.com/users/246342/alex-k"}, "edited": false, "score": 0, "creation_date": 1517405403, "post_id": 48543254, "comment_id": 84081703, "body": "You would use an ADODB.Command/ADODB.Parameters see <a href=\"https://support.microsoft.com/en-gb/help/176936/info-visual-basic-accessing-an-oracle-database-using-ado\" rel=\"nofollow noreferrer\">support.microsoft.com/en-gb/help/176936/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "is_accepted": false, "score": 0, "last_activity_date": 1517406998, "creation_date": 1517406998, "answer_id": 48543888, "question_id": 48543254, "link": "https://stackoverflow.com/questions/48543254/sql-query-to-oracle-database-with-cells-as-parameters/48543888#48543888", "title": "SQL Query to Oracle Database with cells as parameters", "body": "<pre><code>dim vbSql$\n\nvbSql = \"SELECT * FROM ORACLE_DB WHERE DATE ='\" &amp; ThisWorkbook.Worksheets(\"SheetX\").Range(\"A2\").Value &amp; \"';\"\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 9294589, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4a5030721c6e48fb8268b923374d7313?s=128&d=identicon&r=PG&f=1", "display_name": "NTPC", "link": "https://stackoverflow.com/users/9294589/ntpc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 957, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1517406998, "creation_date": 1517404974, "last_edit_date": 1517405566, "question_id": 48543254, "link": "https://stackoverflow.com/questions/48543254/sql-query-to-oracle-database-with-cells-as-parameters", "title": "SQL Query to Oracle Database with cells as parameters", "body": "<p>I'm trying to query an Oracle DB from excel. I need to pass values from cells (dates etc.) into the query, this is where I'm having trouble. Say in the below simple example the date is in cell A2 </p>\n\n<pre><code>SELECT * \nFROM ORACLE_DB \nWHERE DATE = A2\n</code></pre>\n\n<p>I've tried following the instructions on <a href=\"https://support.office.com/en-us/article/customize-a-parameter-query-addf7cb7-ddf0-442f-a60c-cd7280e201bd\" rel=\"nofollow noreferrer\">https://support.office.com/en-us/article/customize-a-parameter-query-addf7cb7-ddf0-442f-a60c-cd7280e201bd</a> but it won't work as certain buttons are grey for me such as 'parameters' in the 'definition' tab and seemingly no amount of messing around with it will work.</p>\n\n<p>Other proposed solutions don't work such as changing A2 in the above example to :</p>\n\n<pre><code>Worksheets(\"Sheet\").Range(\"A2\").Value\n</code></pre>\n\n<p>I haven't yet tried writing something in VBA, but surely there's an easier way to do it? Any help on this would be greatly appreciated!</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1517411558, "post_id": 48543103, "comment_id": 84086328, "body": "You could use the Userform&#39;s Activate event or, better IMO, use the property to set the label caption if that is all it&#39;s for."}], "answers": [{"comments": [{"owner": {"reputation": 433, "user_id": 3275224, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/Jb41R.jpg?s=128&g=1", "display_name": "mike7mike", "link": "https://stackoverflow.com/users/3275224/mike7mike"}, "edited": false, "score": 0, "creation_date": 1517405680, "post_id": 48543354, "comment_id": 84081911, "body": "Thanks for your response. I should have been clearer that this is a simplified version of my real problem. I was hoping to be able to pass values so that I can make more significant changes to the form based on the passed value. I will edit the question to reflect this."}, {"owner": {"reputation": 1580, "user_id": 7938503, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OYvg2.jpg?s=128&g=1", "display_name": "Plagon", "link": "https://stackoverflow.com/users/7938503/plagon"}, "reply_to_user": {"reputation": 433, "user_id": 3275224, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/Jb41R.jpg?s=128&g=1", "display_name": "mike7mike", "link": "https://stackoverflow.com/users/3275224/mike7mike"}, "edited": false, "score": 0, "creation_date": 1517406874, "post_id": 48543354, "comment_id": 84082799, "body": "Thats more reasonable. But you can access every object without showing/loading the form, so you should be able to access all objects/properties like i&#39;ve done it here."}], "tags": [], "owner": {"reputation": 1580, "user_id": 7938503, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OYvg2.jpg?s=128&g=1", "display_name": "Plagon", "link": "https://stackoverflow.com/users/7938503/plagon"}, "is_accepted": false, "score": 1, "last_activity_date": 1517405316, "creation_date": 1517405316, "answer_id": 48543354, "question_id": 48543103, "link": "https://stackoverflow.com/questions/48543103/set-values-on-user-form-using-form-properties/48543354#48543354", "title": "Set values on User Form using form properties", "body": "<p>Easiest way: </p>\n\n<pre><code>Sub button()\n   Dim fm As New UserForm1\n   fm.Label1.Caption = \"Hello\"\n   fm.Show\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 45, "user_id": 8552125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4a0d05e85c1bf3b55c9b1677a76301ca?s=128&d=identicon&r=PG&f=1", "display_name": "John John", "link": "https://stackoverflow.com/users/8552125/john-john"}, "is_accepted": false, "score": 0, "last_activity_date": 1517405904, "creation_date": 1517405904, "answer_id": 48543531, "question_id": 48543103, "link": "https://stackoverflow.com/questions/48543103/set-values-on-user-form-using-form-properties/48543531#48543531", "title": "Set values on User Form using form properties", "body": "<p>you should be using the initialize event for this:</p>\n\n<pre><code>Sub OpenForm()\nMyForm.show\nend sub\n</code></pre>\n\n<p>Then in the initialize event of the userform, put this:</p>\n\n<pre><code>Me.LabelName.Caption = \"Your label text\"\n</code></pre>\n\n<p>(double-click the userform to view its code, then select from the top right drop-down \"Initialize\".)</p>\n"}, {"tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": true, "score": 1, "last_activity_date": 1517406870, "last_edit_date": 1517406870, "creation_date": 1517405952, "answer_id": 48543546, "question_id": 48543103, "link": "https://stackoverflow.com/questions/48543103/set-values-on-user-form-using-form-properties/48543546#48543546", "title": "Set values on User Form using form properties", "body": "<p>You probably think that when you call:</p>\n\n<pre><code>fm.ValueToPass = \"Hello\"\n</code></pre>\n\n<p>in <code>Private Sub UserForm_Initialize()</code> it is possible that the <code>myString</code> value is passed before initializing the form. E.g., you are somehow expecting that <code>myString</code> can be something different than <code>\"\"</code> (thus you have the condition). This is not the case - first the <code>_Initialize</code> constructor is executed and then anything else is carried out:</p>\n\n<p><a href=\"https://i.stack.imgur.com/hFDHz.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/hFDHz.png\" alt=\"enter image description here\"></a></p>\n\n<p>With your code, you need somehow to tell the form, that it should update its label. Consider this inside the form:</p>\n\n<pre><code>Public Sub ShowForm()\n\n    Me.Label1 = myString\n    Me.Show\n\nEnd Sub\n</code></pre>\n\n<p>Then in the module, call it like <code>fm.ShowForm</code> instead of <code>fm.Show</code>.</p>\n\n<p>Actually, it is a good idea, if you work with userforms, following the <a href=\"https://msdn.microsoft.com/en-us/library/ff649643.aspx\" rel=\"nofollow noreferrer\">Model-View-Controller</a> pattern. For this you would need a separate class. </p>\n\n<p><a href=\"https://stackoverflow.com/questions/48426349/userform-closes-after-end-sub-without-ever-calling-unload-me/48427044#48427044\">Userform closes after &quot;End Sub&quot; without ever calling &quot;Unload Me&quot;</a></p>\n"}], "owner": {"reputation": 433, "user_id": 3275224, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/Jb41R.jpg?s=128&g=1", "display_name": "mike7mike", "link": "https://stackoverflow.com/users/3275224/mike7mike"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 322, "favorite_count": 0, "accepted_answer_id": 48543546, "answer_count": 3, "score": 2, "last_activity_date": 1517412601, "creation_date": 1517404483, "last_edit_date": 1517412601, "question_id": 48543103, "link": "https://stackoverflow.com/questions/48543103/set-values-on-user-form-using-form-properties", "title": "Set values on User Form using form properties", "body": "<p>Appologies if this has been asked already, but I cannot seem to find an answer. I want to set a do something on a UserForm as it is loaded up based on the value passed to it from a property. What I have is a button on an Excel worksheet which loads the user form as follows:</p>\n\n<pre><code> Sub button()\n   Dim fm As New UserForm1\n   fm.ValueToPass = \"Hello\"\n   fm.Show\n End Sub\n</code></pre>\n\n<p>Behind the form is the following code:</p>\n\n<pre><code>Private myString As String\n\nPublic Property Let ValueToPass(ByVal x As String)\n   myString = x\nEnd Property\n\nPrivate Sub UserForm_Initialize()\n   If myString = \"Hello\" Then\n      'Do something on my form\n   else\n      'Do something else on my form\n   end if\nEnd Sub\n</code></pre>\n\n<p>The problem is that when the form is loaded up, the myString is empty. I believe that the reason is that the form is initialised before the property <code>ValueToPass</code> is set. What is the best solution to this?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1517405957, "post_id": 48543069, "comment_id": 84082127, "body": "Your question is unclear to me.  But, in general, you can try to record a macro while accomplishing your task manually.  Then clean up the macro (e.g. remove all the Selects, Activates, and other useless commands) until you have what you want.  You can do an internet or SO search for information on how to accomplish those tasks."}, {"owner": {"reputation": 13, "user_id": 9294553, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b71b1fab929dcfb42db4c25102188147?s=128&d=identicon&r=PG&f=1", "display_name": "kferenc", "link": "https://stackoverflow.com/users/9294553/kferenc"}, "reply_to_user": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1517406642, "post_id": 48543069, "comment_id": 84082637, "body": "Unfortunately recording won&#39;t work. I load finance data from another report which appear in let&#39;s say cell A1. I need the value only from this cell to appear in e.g cell B1. But I not only need to have the value in B1, but I need to have it incorporated in a formula as described above (i.e =500-b2-b3..etc). If I record the macro it will always enter into the cell one specific number, however the next month I would get a completely different one from finance. I hope this clear a bit up on what I would like to achieve."}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1517407071, "post_id": 48543069, "comment_id": 84082952, "body": "If you have a value in some cell that you want to use as a constant, why does that preclude you from recording a macro?  Just use an absolute addressing mode.  If the value is coming from a data connection; again, why does that preclude you from recording a macro?"}, {"owner": {"reputation": 13, "user_id": 9294553, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b71b1fab929dcfb42db4c25102188147?s=128&d=identicon&r=PG&f=1", "display_name": "kferenc", "link": "https://stackoverflow.com/users/9294553/kferenc"}, "reply_to_user": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1517408466, "post_id": 48543069, "comment_id": 84083946, "body": "I don&#39;t want to just simply link the source value. After I am done with my updates I pass the files (~150 where I need to do this) to other users (with varying excel knowledge). I want the other users the clearly see the number in B1 and the formula as well."}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1517411619, "post_id": 48543069, "comment_id": 84086381, "body": "You should be able to do that when you clean up and edit the recorded macro."}, {"owner": {"reputation": 13, "user_id": 9294553, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b71b1fab929dcfb42db4c25102188147?s=128&d=identicon&r=PG&f=1", "display_name": "kferenc", "link": "https://stackoverflow.com/users/9294553/kferenc"}, "reply_to_user": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1517412279, "post_id": 48543069, "comment_id": 84086846, "body": "Sorry, I probably explaining it wrong, or I don&#39;t understand how I should do this, but when recording and cleaning up I get the following code: Range(&quot;M60&quot;).Select     Selection.Copy     Range(&quot;M9&quot;).Select     Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _         :=False, Transpose:=False     Application.CutCopyMode = False     ActiveCell.FormulaR1C1 = &quot;=4.89402524201477-R[1]C-R[3]C-R[4]C-R[6]C&quot; The problem with this that as you can see no matter what the value will be that I am copying and pasting my formula will leave the old value of 4.89."}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1517422134, "post_id": 48543069, "comment_id": 84093418, "body": "And where did the 4.89 come from?"}, {"owner": {"reputation": 13, "user_id": 9294553, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b71b1fab929dcfb42db4c25102188147?s=128&d=identicon&r=PG&f=1", "display_name": "kferenc", "link": "https://stackoverflow.com/users/9294553/kferenc"}, "reply_to_user": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1517488436, "post_id": 48543069, "comment_id": 84121354, "body": "It is copied from cell M60. But next month it will be in N60, the next int O60, etc. And although the recorded macro would copy it and paste the value of that, but it would always overwrite it with the formula &quot;=4.89402524201477-R[1]C-R[3]C-R[4]C-R[6]C&quot; since that&#39;s what it recoded the first time. So instead of this I want to have the number in a variable. It would take that variable each month from the correct cell, then would write the formula with the variable, with the correct number in it."}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1517488857, "post_id": 48543069, "comment_id": 84121644, "body": "All you need to do is substitute the appropriate cell value.  Dim myVar As Double &#39;change depending on the month    myVar = Range(&quot;M60&quot;) ActiveCell.FormulaR1C1 = &quot;=&quot; &amp; myVar &amp; &quot;-R[1]C-R[3]C-R[4]C-R[6]C&quot;"}, {"owner": {"reputation": 13, "user_id": 9294553, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b71b1fab929dcfb42db4c25102188147?s=128&d=identicon&r=PG&f=1", "display_name": "kferenc", "link": "https://stackoverflow.com/users/9294553/kferenc"}, "reply_to_user": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1517495133, "post_id": 48543069, "comment_id": 84125877, "body": "Thanks a lot! This did solve it. sorry for not being too clear in the beginning so thanks for the extra patience as well."}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 9294553, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b71b1fab929dcfb42db4c25102188147?s=128&d=identicon&r=PG&f=1", "display_name": "kferenc", "link": "https://stackoverflow.com/users/9294553/kferenc"}, "edited": false, "score": 0, "creation_date": 1517495145, "post_id": 48562994, "comment_id": 84125887, "body": "Perfect! I knew this was something easy, but couldn&#39;t get my head around it. Thanks @AcsErno"}], "tags": [], "owner": {"reputation": 1444, "user_id": 9122140, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6207fe125b0cbaefce70e98e5ce2c6f?s=128&d=identicon&r=PG&f=1", "display_name": "AcsErno", "link": "https://stackoverflow.com/users/9122140/acserno"}, "is_accepted": true, "score": 0, "last_activity_date": 1517497495, "last_edit_date": 1517497495, "creation_date": 1517488702, "answer_id": 48562994, "question_id": 48543069, "link": "https://stackoverflow.com/questions/48543069/formula-to-combine-variable-and-cell-references/48562994#48562994", "title": "Formula to combine variable and cell references", "body": "<p>You might want this one: </p>\n\n<pre><code>InVal = 500          ' input value\nCells(\"A1\").FormulaLocal = \"=\" &amp; CStr(InVal) &amp; \"-A2-A3-A4\"\n</code></pre>\n\n<p>or in a loop</p>\n\n<pre><code>Dim InVal() as Variant\nInVal = Range(\"M60:Z60\").Value\n\nFor i = LBound(InVal) to UBound(InVal)\n    Cells(1, i + 1).FormulaLocal = \"=\" &amp; CStr(Val(InVal(i))) &amp; \"-\" &amp; Cells(2, i + 1).Address &amp; \"-\" &amp; Cells(3, i + 1).Address &amp; \"-\" &amp; Cells(4, i + 1).Address \nNext i\n</code></pre>\n\n<p>All you need to do is to play with .Address and the strings to compile the formula.</p>\n"}], "owner": {"reputation": 13, "user_id": 9294553, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b71b1fab929dcfb42db4c25102188147?s=128&d=identicon&r=PG&f=1", "display_name": "kferenc", "link": "https://stackoverflow.com/users/9294553/kferenc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 59, "favorite_count": 0, "accepted_answer_id": 48562994, "answer_count": 1, "score": 0, "last_activity_date": 1517497495, "creation_date": 1517404381, "last_edit_date": 1517404572, "question_id": 48543069, "link": "https://stackoverflow.com/questions/48543069/formula-to-combine-variable-and-cell-references", "title": "Formula to combine variable and cell references", "body": "<p>I have been looking for hours for a solution but couldn't find any. I am an absolute beginner in VBA and couldn't figure this out for myself. The thing I would like to do is that VBA enters in a cell a formula that will contain a value extracted from a variable and then subtracts all the below cells. The cells below could change which would affect the overall value so I need to leave it as dynamic. (e.g: Cell A1 should look like this: =500-A2-A3-A4.. etc).\nThe code looks like this at the moment. So far it only enters the value from the variable</p>\n\n<pre><code>crnt = Cells(5, \"D\").Value\nRange(\"E60\").Select\nActiveCell.Offset(0, crnt - 1).Activate\nrev = ActiveCell.Value\nRange(\"E9\").Select\nActiveCell.Offset(0, crnt - 1).Select\nActiveCell.Value = rev\n</code></pre>\n"}, {"tags": ["ms-access", "parameters", "vba", "report", "ms-access-2010"], "answers": [{"tags": [], "owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "is_accepted": true, "score": 2, "last_activity_date": 1517426100, "creation_date": 1517426100, "answer_id": 48549794, "question_id": 48542935, "link": "https://stackoverflow.com/questions/48542935/docmd-openreport-where-condition-syntax/48549794#48549794", "title": "doCmd.OpenReport where-condition syntax", "body": "<p>This shouldn't even compile *, the double quotes are wrong.</p>\n\n<p><code>WhereCondition</code> must be a string:</p>\n\n \n\n<pre class=\"lang-vb prettyprint-override\"><code>   DoCmd.OpenReport ReportName:=\"Mitarbeiterhonorare\", View:=acViewPreview, _\n        WhereCondition:=\"Referent_Name = \" &amp; Me.Kf_Referentenname\n</code></pre>\n\n<p>and then <code>Referent_Name</code> is probably a text field, so you need additional quotes around the parameter:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>    DoCmd.OpenReport ReportName:=\"Mitarbeiterhonorare\", View:=acViewPreview, _\n        WhereCondition:=\"Referent_Name = '\" &amp; Me.Kf_Referentenname &amp; \"'\"\n</code></pre>\n\n<hr>\n\n<p>(*) Do you have <a href=\"https://msdn.microsoft.com/en-us/library/bw9t3484%28v=vs.84%29.aspx\" rel=\"nofollow noreferrer\"><code>Option Explicit</code></a> at the top of your module?</p>\n\n<p>It enforces variable declaration and reports undeclared or misspelled variables/constants at compile time. \nTo have this automatically in new modules, set the <a href=\"http://www.fmsinc.com/microsoftaccess/modules/options/index.html\" rel=\"nofollow noreferrer\">Require Variable Declaration</a> option in the VBA Editor.<br>\nThis is really a must have for VBA development.</p>\n"}], "owner": {"reputation": 5, "user_id": 9294566, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/853f6f2a24090c5dfff8b44d2a0b867a?s=128&d=identicon&r=PG&f=1", "display_name": "balisto91", "link": "https://stackoverflow.com/users/9294566/balisto91"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5427, "favorite_count": 0, "accepted_answer_id": 48549794, "answer_count": 1, "score": 0, "last_activity_date": 1517426134, "creation_date": 1517403980, "last_edit_date": 1517426134, "question_id": 48542935, "link": "https://stackoverflow.com/questions/48542935/docmd-openreport-where-condition-syntax", "title": "doCmd.OpenReport where-condition syntax", "body": "<p>I have a very small Access database where I'd like to have a button, which opens up a report (\"Mitarbeiterhonorare\") filtered by a chosen value in the combination field \"Kf-Referentenname\". Unfortunately, my where-condition just doesn't seem to work (there has to be some formatting mistake, since it just opens up an empty report). Can anybody help me with the syntax there?</p>\n\n<p>Thanks a lot!</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Private Sub cmdOpenReport_Click()\n    If IsNull(Me.Kf_Referentenname) Then\n        Me.Kf_Referentenname.SetFocus\n        MsgBox \"Bitte einen Mitarbeiter ausw\u00e4hlen!\", vbExclamation\n    Else\n        DoCmd.OpenReport ReportName:=\"Mitarbeiterhonorare\",      View:=acViewPreview, _\n            WhereCondition:=Referent_Name = \"&amp; Me.Kf_Referentenname\"\n    End If\nEnd Sub\n</code></pre>\n\n<p>The query the report is based on Looks like this: </p>\n\n<pre><code>SELECT Sum(Honorare.Betrag) AS Gesamtbetrag_Honorare, Mitarbeiter.Referent_Name FROM Mitarbeiter INNER JOIN Honorare ON Mitarbeiter.Mitarbeiter_ID = Honorare.Mitarbeiter_ID GROUP BY Honorare.Mitarbeiter_ID, Mitarbeiter.Referent_Name;\n</code></pre>\n"}, {"tags": ["excel", "vba", "excel-formula", "runtime-error"], "answers": [{"tags": [], "owner": {"reputation": 79, "user_id": 4872227, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/NTu1d.jpg?s=128&g=1", "display_name": "Chis.Wisselo", "link": "https://stackoverflow.com/users/4872227/chis-wisselo"}, "is_accepted": false, "score": 1, "last_activity_date": 1517403997, "creation_date": 1517403997, "answer_id": 48542941, "question_id": 48542840, "link": "https://stackoverflow.com/questions/48542840/excel-vba-runtime-1004/48542941#48542941", "title": "Excel VBA Runtime 1004", "body": "<p>The additional \") was the trick... </p>\n\n<pre><code>'Adjust date format in temporary column\nRowCount = Range(\"A2\").CurrentRegion.Rows.Count\nFor i = 2 To RowCount\n    Worksheets(\"Data\").Range(\"O\" &amp; i).Formula = \"=TEXT(H\" &amp; i &amp; \",\"\"yyyy-mm-dd\"\")\"\nNext\n</code></pre>\n\n<p>works just fine. </p>\n"}], "owner": {"reputation": 79, "user_id": 4872227, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/NTu1d.jpg?s=128&g=1", "display_name": "Chis.Wisselo", "link": "https://stackoverflow.com/users/4872227/chis-wisselo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 72, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1517404009, "creation_date": 1517403699, "last_edit_date": 1517404009, "question_id": 48542840, "link": "https://stackoverflow.com/questions/48542840/excel-vba-runtime-1004", "title": "Excel VBA Runtime 1004", "body": "<p>For some reason, I am receiving a </p>\n\n<blockquote>\n  <p>runtime error 1004 (Application-defined or object-defined error)</p>\n</blockquote>\n\n<p>while I am trying to insert a formula. The file/ worksheet is active, the worksheet is not protected. The rowcount picks up the correct number of rows. So I am at a loss here. </p>\n\n<pre><code>'Adjust date format in temporary column\nRowCount = Range(\"A2\").CurrentRegion.Rows.Count\nFor i = 2 To RowCount\n    Worksheets(\"Data\").Range(\"O\" &amp; i).Formula = \"=TEXT(H\" &amp; i &amp; \"),\"\"yyyy-mm-dd\"\")\"\nNext\n</code></pre>\n\n<p>Any ideas?</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 105, "user_id": 4680156, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c7c18b7d971b7187e837c75355d1d2c3?s=128&d=identicon&r=PG&f=1", "display_name": "teaspoon", "link": "https://stackoverflow.com/users/4680156/teaspoon"}, "edited": false, "score": 0, "creation_date": 1517412243, "post_id": 48543117, "comment_id": 84086803, "body": "thank you David, indeed, the If is simple  but I get issues with the j function (startrow on line 37) - could you help me review the whole code: <a href=\"https://dotnetfiddle.net/q7HNkq\" rel=\"nofollow noreferrer\">dotnetfiddle.net/q7HNkq</a> (PS. my source data file has the start date - that I want to complete with sequential dates - in column B and variable number of rows)"}, {"owner": {"reputation": 298, "user_id": 5547642, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/X6iJS.jpg?s=128&g=1", "display_name": "David wyatt", "link": "https://stackoverflow.com/users/5547642/david-wyatt"}, "reply_to_user": {"reputation": 105, "user_id": 4680156, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c7c18b7d971b7187e837c75355d1d2c3?s=128&d=identicon&r=PG&f=1", "display_name": "teaspoon", "link": "https://stackoverflow.com/users/4680156/teaspoon"}, "edited": false, "score": 0, "creation_date": 1517419799, "post_id": 48543117, "comment_id": 84092071, "body": "Happy to help, Ive updated my code to fix the inserted row issue (my fault i missed it). by starting at the bottom and looping up you avoid the issue of inserting rows. Looks like i got the wrong end of the stick ad was trying to look up values from another table. in my new example it will add he rows then add missing days incrementing one at a time. i dont know how you calc the end date, hours or day type so just dropped some text in. replace that with the formula you want"}, {"owner": {"reputation": 105, "user_id": 4680156, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c7c18b7d971b7187e837c75355d1d2c3?s=128&d=identicon&r=PG&f=1", "display_name": "teaspoon", "link": "https://stackoverflow.com/users/4680156/teaspoon"}, "edited": false, "score": 0, "creation_date": 1517429507, "post_id": 48543117, "comment_id": 84097306, "body": "David, thanks, I surely like to idea of starting from the bottom, however, there is an issue with some of the calculations and I just can&#39;t make out why, because some of them are ok, and some are not, I am adding a screenshot in my original post of when I run the macro on my sample data -- first 40 hours event (from the bottom) is calculated just fine (green) -- next 2 days event (16 hours) the calculation is fine but the original date (in column B) is overwritten with the End date (red) -- another one (yellow) is again overwritten in col.B by a weird number (why 27 Jan instead of 29 Jan??)"}, {"owner": {"reputation": 298, "user_id": 5547642, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/X6iJS.jpg?s=128&g=1", "display_name": "David wyatt", "link": "https://stackoverflow.com/users/5547642/david-wyatt"}, "reply_to_user": {"reputation": 105, "user_id": 4680156, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c7c18b7d971b7187e837c75355d1d2c3?s=128&d=identicon&r=PG&f=1", "display_name": "teaspoon", "link": "https://stackoverflow.com/users/4680156/teaspoon"}, "edited": false, "score": 0, "creation_date": 1517432295, "post_id": 48543117, "comment_id": 84098721, "body": "Hi, i see what you mean, im not quite sure why the issue is happening. At a guess it might be the resizing insert. Ive updated my code and tried changing it to a standard row insert and it seems a lot more stable for me. Give it ago and let me know"}, {"owner": {"reputation": 105, "user_id": 4680156, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c7c18b7d971b7187e837c75355d1d2c3?s=128&d=identicon&r=PG&f=1", "display_name": "teaspoon", "link": "https://stackoverflow.com/users/4680156/teaspoon"}, "edited": false, "score": 0, "creation_date": 1517502562, "post_id": 48543117, "comment_id": 84131052, "body": "David, it didn&#39;t help, there are still the same errors in calculations. But I found out a much easier approach : once I have inserted the correct number of empty rows, I can just insert an extra column, then go from the top downwards with this formula =IF(C2&gt;0;C2;C1+1) that will fill in the dates from the start days as necessary ... :-) now I just need to figure out how to transport this to VBA so i don&#39;t have to create extra columns manually..."}, {"owner": {"reputation": 298, "user_id": 5547642, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/X6iJS.jpg?s=128&g=1", "display_name": "David wyatt", "link": "https://stackoverflow.com/users/5547642/david-wyatt"}, "reply_to_user": {"reputation": 105, "user_id": 4680156, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c7c18b7d971b7187e837c75355d1d2c3?s=128&d=identicon&r=PG&f=1", "display_name": "teaspoon", "link": "https://stackoverflow.com/users/4680156/teaspoon"}, "edited": false, "score": 0, "creation_date": 1517504475, "post_id": 48543117, "comment_id": 84132256, "body": "Hi, glad you found a way that works, I&#39;ve added how to inset a column and how to fill it with the formula you need (you might need to change columns and worksheets ect)"}], "tags": [], "owner": {"reputation": 298, "user_id": 5547642, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/X6iJS.jpg?s=128&g=1", "display_name": "David wyatt", "link": "https://stackoverflow.com/users/5547642/david-wyatt"}, "is_accepted": true, "score": 1, "last_activity_date": 1517504393, "last_edit_date": 1517504393, "creation_date": 1517404516, "answer_id": 48543117, "question_id": 48542783, "link": "https://stackoverflow.com/questions/48542783/insert-rows-based-on-datediff-fill-in-inserted-rows-with-dates/48543117#48543117", "title": "Insert Rows based on DateDiff (fill in inserted rows with dates)", "body": "<p>you can use an if command to check to see if the dates match, then only run the check if they dont. the code will now add every subsequent date between the start and end date</p>\n\n<pre><code>Public Sub AAA_Format()\n\nDim i As Long\nDim d As Long\nDim LastRow As Long\nDim j As Long\nDim rng As Range, rng2 As Range\nDim startrow As Long, insertedrow As Long\nApplication.CutCopyMode = False\n\nWith Worksheets(\"Data\")\n    LastRow = .UsedRange.Rows.Count\n\n\n    For i = LastRow To 2 Step -1 '' starts at bottom and goes up, that way inserting rows doesn impact it\n        'checks to see if 2 values are the same\n        If Not Cells(i, \"B\") = Cells(i, \"C\") Then\n        Debug.Print Cells(i, \"B\")\n        Debug.Print Cells(i, \"C\")\n\n            d = DateDiff(\"d\", .Cells(i, \"B\"), .Cells(i, \"C\")) '' find differene\n             Debug.Print d\n              insertedrow = i + d\n            .Rows(i + 1 &amp; \":\" &amp; insertedrow).Insert Shift:=xlDown\n        End If\n\n        For j = 1 To d\n            .Cells(i + j, 2) = .Cells((i + j) - 1, 2) + 1\n            .Cells(i + j, 3) = \"what ever you want to calc end date as\"\n            .Cells(i + j, 4) = \"what ever you want to calc hours as\"\n            .Cells(i + j, 5) = \"what ever you want to calc day as\"\n        Next j\n\n    Next i\n\nEnd With\n\nEnd Sub\n</code></pre>\n\n<p>To insert a column you can use</p>\n\n<pre><code>ActiveSheet.Range(\"D:D\").EntireColumn.Insert\n</code></pre>\n\n<p>and to add formula to it you can use</p>\n\n<pre><code>LastRow = ActiveSheet.Range(\"B\" &amp; ActiveSheet.Rows.Count).End(xlUp).Row '' this find bottom row by starting on very last row of sheet and moving up until it finds a cell with a value in it\nRange(\"D2\").Formula = \"=IF(C2&gt;0,C2,C1+1)\"'' you might need to change , for ; depending on your language pack\nRange(\"D2:D\" &amp; LastRow ).FillDown\n</code></pre>\n"}], "owner": {"reputation": 105, "user_id": 4680156, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c7c18b7d971b7187e837c75355d1d2c3?s=128&d=identicon&r=PG&f=1", "display_name": "teaspoon", "link": "https://stackoverflow.com/users/4680156/teaspoon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 411, "favorite_count": 0, "accepted_answer_id": 48543117, "answer_count": 1, "score": 1, "last_activity_date": 1517504393, "creation_date": 1517403515, "last_edit_date": 1517429569, "question_id": 48542783, "link": "https://stackoverflow.com/questions/48542783/insert-rows-based-on-datediff-fill-in-inserted-rows-with-dates", "title": "Insert Rows based on DateDiff (fill in inserted rows with dates)", "body": "<p>I am using a macro from <a href=\"https://stackoverflow.com/questions/36556073/insert-rows-based-on-datediff\">this thread</a> to insert new rows </p>\n\n<p>but the problem is when there is the same <strong>start date</strong> as <strong>end date</strong> I get the </p>\n\n<blockquote>\n  <p>Error 1004</p>\n</blockquote>\n\n<ul>\n<li>can you help modify the VBA to skip those lines that produce the Error?</li>\n<li>is there an easy way how to fill in the column B (marked red) the consequential dates to complete the table (one day per line)?</li>\n</ul>\n\n<p><a href=\"https://i.stack.imgur.com/Kbwaz.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Kbwaz.png\" alt=\"example of table\"></a></p>\n\n<pre><code>Start Date  End Date    Hours   Type\n02-01-18    02-01-18    8   one day\n04-01-18    04-01-18    4   half day\n05-01-18    06-01-18    16  multiple days\n07-01-18    10-01-18    16  multiple days\n11-01-18    11-01-18    8   one day\n</code></pre>\n\n<p><strong>UPDATE:</strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/QxzyQ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/QxzyQ.png\" alt=\"issue with VBA calculations from the bottom up\"></a></p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 4, "creation_date": 1517403244, "post_id": 48542677, "comment_id": 84080286, "body": "If I were you, I&#39;d start accepting some answers to your questions. It is likely to encourage people to help."}, {"owner": {"user_type": "does_not_exist", "display_name": "user8666372"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1517403572, "post_id": 48542677, "comment_id": 84080498, "body": "@SJR i&#39;m trying to test all answers and vote them."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1517404070, "post_id": 48542677, "comment_id": 84080801, "body": "OK that&#39;s good, but why not accept answers too - it is the basis of the how the site works as I understand it."}, {"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1517405859, "post_id": 48542677, "comment_id": 84082057, "body": "Not quite sure what you are trying to do, but there is no such thing as <code>settingsWorkDirectory0</code>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user8666372"}, "reply_to_user": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1517406079, "post_id": 48542677, "comment_id": 84082232, "body": "@braX sorry dude it was happened when i copied from my setting working directory code now it&#39;s ok. settingsWorkDirectory0 is a ActiveX textbox element."}, {"owner": {"user_type": "does_not_exist", "display_name": "user8666372"}, "reply_to_user": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1517406443, "post_id": 48542677, "comment_id": 84082478, "body": "@braX i have 20 textbox with file dialog button, i will push the button and select the database directory and it writes the path this textbox. But as you can see for all 20 dataabase directory i&#39;ll be using same function as you can see above. I&#39;m asking this: i can do it for one database with the code. But i should do it parametric to avoid copy same code 20 times. The key point is reference of textbox settingsWorkDirectory0 it&#39;s unique and i don&#39;t know how can i make it parametric for settingsWorkDirectory01, settingsWorkDirectory2, settingsWorkDirectory3 ...... settingsWorkDirectory20"}], "answers": [{"tags": [], "owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "is_accepted": true, "score": 0, "last_activity_date": 1517406854, "creation_date": 1517406854, "answer_id": 48543838, "question_id": 48542677, "link": "https://stackoverflow.com/questions/48542677/how-to-set-multiple-directories-with-using-one-file-dialog-function/48543838#48543838", "title": "How to set multiple directories with using one file dialog function", "body": "<p>Pass it the control. Something along the lines of this:</p>\n\n<pre><code>Function GetFolder(txt As Control) As String\n    Dim fdo As FileDialog\n    Dim sItem As String\n    Set fdo = Application.FileDialog(msoFileDialogFolderPicker)\n    With fdo\n        .Title = \"Select a Directory\"\n        .AllowMultiSelect = False\n        .InitialFileName = Application.DefaultFilePath\n        If .Show &lt;&gt; -1 Then GoTo NextCode\n        sItem = .SelectedItems(1)\n        txt.Value = sItem \n    End With\nNextCode:\n    GetFolder = sItem\n    Set fdo = Nothing\nEnd Function\n</code></pre>\n\n<p>This pseudo-code demonstrates how to make the function generic. See how I'm passing the control to the function and then referencing that instead of the <code>databaseDirectory0</code>?</p>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user8262209"}, "is_accepted": false, "score": 0, "last_activity_date": 1517407351, "creation_date": 1517407351, "answer_id": 48544009, "question_id": 48542677, "link": "https://stackoverflow.com/questions/48542677/how-to-set-multiple-directories-with-using-one-file-dialog-function/48544009#48544009", "title": "How to set multiple directories with using one file dialog function", "body": "<p>You can return sItem to the parent caller and set </p>\n\n<p>SettingsSheet.databaseDirectory0n.Value = functionName(txt as Control)</p>\n\n<p>Does this make sense?</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user8666372"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 51, "favorite_count": 0, "accepted_answer_id": 48543838, "answer_count": 2, "score": 0, "last_activity_date": 1517407351, "creation_date": 1517403136, "last_edit_date": 1517405997, "question_id": 48542677, "link": "https://stackoverflow.com/questions/48542677/how-to-set-multiple-directories-with-using-one-file-dialog-function", "title": "How to set multiple directories with using one file dialog function", "body": "<p>I'm using function to set database directory at Excel with FileDialog, But I have to set about 20 different database directory</p>\n\n<p>I set up one of it with <code>SettingsSheet.databaseDirectory0 = sItem</code>, but for the others, I don't want to write the same function for each of them isn't there any \nparametric solution to set them to one function?</p>\n\n<pre><code>Function GetFolder() As String\n    Dim fdo As FileDialog\n    Dim sItem As String\n    Set fdo = Application.FileDialog(msoFileDialogFolderPicker)\n    With fdo\n        .Title = \"Select a Directory\"\n        .AllowMultiSelect = False\n        .InitialFileName = Application.DefaultFilePath\n        If .Show &lt;&gt; -1 Then GoTo NextCode\n        sItem = .SelectedItems(1)\n        SettingsSheet.databaseDirectory0.Value = sItem \n    End With\nNextCode:\n    GetFolder = sItem\n    Set fdo = Nothing\nEnd Function\n</code></pre>\n"}, {"tags": ["excel", "rdp", "vba"], "answers": [{"comments": [{"owner": {"reputation": 434, "user_id": 3108065, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/znmeK.png?s=128&g=1", "display_name": "Volkan", "link": "https://stackoverflow.com/users/3108065/volkan"}, "edited": false, "score": 0, "creation_date": 1517581369, "post_id": 48545212, "comment_id": 84165947, "body": "Also, thank you for taking the effort to explain the process and pros and cons. Really useful."}], "tags": [], "owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "is_accepted": true, "score": 4, "last_activity_date": 1517411520, "last_edit_date": 1517411520, "creation_date": 1517410888, "answer_id": 48545212, "question_id": 48542666, "link": "https://stackoverflow.com/questions/48542666/connection-to-rdp-from-excel/48545212#48545212", "title": "Connection to RDP from Excel", "body": "<p>Since you are just calling a command through the shell, you don't really have a handle on the application that is launching programatically (RDP in this case). So you can't do something like:</p>\n\n<pre><code>MyRDP.Password = Range(\"B2\").value\n</code></pre>\n\n<p>You can, however, use <code>Application.Sendkeys</code> to send keypresses to windows which it will blindly apply to where ever your cursor happens to be when you send the command.</p>\n\n<p>Assuming your password is stored in the same row, but on column over (the adjacent cell):</p>\n\n<pre><code>Application.SendKeys (ActiveCell.Offset(, 1).Value &amp; \"{ENTER}\")\n</code></pre>\n\n<p>Sending your password and an \"Enter\" keypress to accept the password.</p>\n\n<p>Because RDP takes a moment to pop up, you can't just toss that line in after calling the shell command. You have to wait some amount of time. 5 seconds works nicely on my compyter, but you computer may be slower or faster so you may have to monkey around a bit here:</p>\n\n<pre><code>Sub OpenRDP()\n    Dim MyRDP As Variant\n    Dim MyLink As String\n\n    MyLink = \"c:\\windows\\system32\\mstsc.exe /v:\" &amp; ActiveCell.Value\n\n    MyRDP = Shell(MyLink, 1)\n\n    'wait five seconds and send password in adjacent cell of same row\n    Application.Wait (Now() + TimeValue(\"0:00:5\"))\n    Application.SendKeys (ActiveCell.Offset(, 1).Value &amp; \"{ENTER}\")\n\nEnd Sub\n</code></pre>\n\n<p>I have no doubt that this could be about 10000x more sophisticated by querying WMI for running processes and waiting for RDP to pop up to do the sendkeys, or hunting down a library to help interact with RDP using code, but... for two lines of code this method will get you pretty far.</p>\n\n<p>Also, (because it's worth saying), storing your passwords in excel is not terribly secure. Anyone gaining access to your workbook will have access to your remote desktops. Even if the workbook is password protected, it can be cracked with the push of a button.</p>\n"}], "owner": {"reputation": 434, "user_id": 3108065, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/znmeK.png?s=128&g=1", "display_name": "Volkan", "link": "https://stackoverflow.com/users/3108065/volkan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5103, "favorite_count": 1, "accepted_answer_id": 48545212, "answer_count": 1, "score": 1, "last_activity_date": 1517411520, "creation_date": 1517403102, "last_edit_date": 1531161705, "question_id": 48542666, "link": "https://stackoverflow.com/questions/48542666/connection-to-rdp-from-excel", "title": "Connection to RDP from Excel", "body": "<p>I see many forums talking about starting Remote Desktop Connection from Excel file. </p>\n\n<p>I also saw this code, which is fine and works.</p>\n\n<pre><code>Sub OpenRDP()\nDim MyRDP As Variant\n\nMyLink = \"c:\\windows\\system32\\mstsc.exe /v:\" &amp; ActiveCell.Value\n\nMyRDP = Shell(MyLink, 1)\n\nEnd Sub\n</code></pre>\n\n<p>However, in my Excel file, in one column I have HOST address, and next to it is a column with passwords. </p>\n\n<p>My question is: is it possible to start RDP and pass to it host IP address and password? If it is, how is it done? </p>\n\n<p>thanks!</p>\n"}, {"tags": ["vba", "excel", "excel-formula"], "comments": [{"owner": {"reputation": 2682, "user_id": 9059424, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Ez4b8InqhCI/AAAAAAAAAAI/AAAAAAAAAWE/IY8n6L2OBQk/photo.jpg?sz=128", "display_name": "aduguid", "link": "https://stackoverflow.com/users/9059424/aduguid"}, "edited": false, "score": 1, "creation_date": 1517402919, "post_id": 48542542, "comment_id": 84080081, "body": "Can you post some example data and your code?"}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 0, "creation_date": 1517402969, "post_id": 48542542, "comment_id": 84080108, "body": "Help us to help you; <b>post your current code.</b>"}, {"owner": {"reputation": 540, "user_id": 7977245, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/75d742b8a8e957e7d15b8b040818fea4?s=128&d=identicon&r=PG&f=1", "display_name": "dre_84w934", "link": "https://stackoverflow.com/users/7977245/dre-84w934"}, "reply_to_user": {"reputation": 2682, "user_id": 9059424, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Ez4b8InqhCI/AAAAAAAAAAI/AAAAAAAAAWE/IY8n6L2OBQk/photo.jpg?sz=128", "display_name": "aduguid", "link": "https://stackoverflow.com/users/9059424/aduguid"}, "edited": false, "score": 0, "creation_date": 1517403139, "post_id": 48542542, "comment_id": 84080214, "body": "@aduguid sure, I&#39;ve just edited my code in"}, {"owner": {"reputation": 540, "user_id": 7977245, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/75d742b8a8e957e7d15b8b040818fea4?s=128&d=identicon&r=PG&f=1", "display_name": "dre_84w934", "link": "https://stackoverflow.com/users/7977245/dre-84w934"}, "reply_to_user": {"reputation": 2682, "user_id": 9059424, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Ez4b8InqhCI/AAAAAAAAAAI/AAAAAAAAAWE/IY8n6L2OBQk/photo.jpg?sz=128", "display_name": "aduguid", "link": "https://stackoverflow.com/users/9059424/aduguid"}, "edited": false, "score": 0, "creation_date": 1517403185, "post_id": 48542542, "comment_id": 84080247, "body": "@aduguid , see my code. let me known if you think my code could be the problem"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1517403846, "post_id": 48542542, "comment_id": 84080663, "body": "Why would you use a UDF rather than native functions, which are almost always faster? BTW it&#39;s DATEDIF in a worksheet."}, {"owner": {"user_type": "does_not_exist", "display_name": "user9167318"}, "edited": false, "score": 0, "creation_date": 1517404318, "post_id": 48542542, "comment_id": 84080968, "body": "how many elements are actually present in your array?"}, {"owner": {"reputation": 42107, "user_id": 3915431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ad2fe8d0c0e72bdbe3623e85a96b9b4?s=128&d=identicon&r=PG&f=1", "display_name": "Axel Richter", "link": "https://stackoverflow.com/users/3915431/axel-richter"}, "edited": false, "score": 1, "creation_date": 1517404392, "post_id": 48542542, "comment_id": 84081026, "body": "The <code>existsInArray</code> can simply be done using a <code>COUNTIF</code>. This will truely be faster. Example <code>=COUNTIF(A1:C100, &quot;xyz&quot;)&gt;0</code> is the same as <code>=existsInArray(A1:C100, &quot;xyz&quot;)</code>"}, {"owner": {"reputation": 540, "user_id": 7977245, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/75d742b8a8e957e7d15b8b040818fea4?s=128&d=identicon&r=PG&f=1", "display_name": "dre_84w934", "link": "https://stackoverflow.com/users/7977245/dre-84w934"}, "edited": false, "score": 0, "creation_date": 1517404440, "post_id": 48542542, "comment_id": 84081055, "body": "@Tanmay Gawankar  like12 cells, 6 of them are empty"}, {"owner": {"reputation": 540, "user_id": 7977245, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/75d742b8a8e957e7d15b8b040818fea4?s=128&d=identicon&r=PG&f=1", "display_name": "dre_84w934", "link": "https://stackoverflow.com/users/7977245/dre-84w934"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1517404522, "post_id": 48542542, "comment_id": 84081112, "body": "@Rory datediff might be in your xl, not in mine, donno why, but that&#39;s the case"}, {"owner": {"user_type": "does_not_exist", "display_name": "user9167318"}, "edited": false, "score": 0, "creation_date": 1517404604, "post_id": 48542542, "comment_id": 84081162, "body": "@dre_84w934 its <code>datedif</code> single <code>f</code>"}, {"owner": {"reputation": 540, "user_id": 7977245, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/75d742b8a8e957e7d15b8b040818fea4?s=128&d=identicon&r=PG&f=1", "display_name": "dre_84w934", "link": "https://stackoverflow.com/users/7977245/dre-84w934"}, "reply_to_user": {"reputation": 42107, "user_id": 3915431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ad2fe8d0c0e72bdbe3623e85a96b9b4?s=128&d=identicon&r=PG&f=1", "display_name": "Axel Richter", "link": "https://stackoverflow.com/users/3915431/axel-richter"}, "edited": false, "score": 0, "creation_date": 1517404639, "post_id": 48542542, "comment_id": 84081189, "body": "@Axel Richter , right, the problem is that I have more than one string value to verify, 6 in total"}, {"owner": {"reputation": 540, "user_id": 7977245, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/75d742b8a8e957e7d15b8b040818fea4?s=128&d=identicon&r=PG&f=1", "display_name": "dre_84w934", "link": "https://stackoverflow.com/users/7977245/dre-84w934"}, "edited": false, "score": 0, "creation_date": 1517404755, "post_id": 48542542, "comment_id": 84081272, "body": "@TanmayGawankar I do not have datedif either, after typing =date, I got 2 options date value or date"}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 1, "creation_date": 1517406464, "post_id": 48542542, "comment_id": 84082494, "body": "@TanmayGawankar <code>DATEDIF</code> is a worksheet function (undocumented for many years); <code>DateDiff</code> is a VBA function."}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1517406672, "post_id": 48542542, "comment_id": 84082664, "body": "This is the kind of problem that requires examining both the data and the code in order to come to a definitive answer. Otherwise we are all just guessing. I suggest you create a workbook (with sensitive information removed) that demonstrates the problem, and then upload it to some public file sharing site (that does not require registration); then edit your question to include a link to the file."}], "answers": [{"tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": true, "score": 2, "last_activity_date": 1517404759, "creation_date": 1517404759, "answer_id": 48543189, "question_id": 48542542, "link": "https://stackoverflow.com/questions/48542542/functions-drastically-slowing-down-calculation-time/48543189#48543189", "title": "Functions drastically slowing down calculation time", "body": "<p>I can't analyze completely without seeing how the UDFs are being used, but having code loop over ranges can be very slow.  For example:</p>\n\n<pre><code>Public Function MyUdf(rng As Range) As Variant\n    Dim r As Range\n    For Each r In rng\n        ' do something that calculates MyUdf\n        MyUdf = 1\n    Next r\nEnd Function\n</code></pre>\n\n<p>will examine and process each cell in <code>rng</code>.  If the user puts something like:</p>\n\n<pre><code>=MyUdf(A:A)\n</code></pre>\n\n<p>in a cell, it will process every cell in the <strong>entire column</strong>.</p>\n\n<p>To limit the extent of the looping, you can use something like:</p>\n\n<pre><code>Public Function MyUdf2(rng As Range) As Variant\n    Dim r As Range, RNG2 As Range\n    Set RNG2 = Intersect(rng, rng.Parent.UsedRange)\n    For Each r In RNG2\n        ' do something that calculates MyUdf\n        MyUdf2 = 1\n    Next r\nEnd Function\n</code></pre>\n\n<p>That way you may end up processing thousands of cells rather than millions.</p>\n\n<p>Anther possible speedup technique is to create VBA arrays to process the data rather than use cells directly.</p>\n"}, {"tags": [], "owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "is_accepted": false, "score": 0, "last_activity_date": 1517602195, "creation_date": 1517602195, "answer_id": 48590186, "question_id": 48542542, "link": "https://stackoverflow.com/questions/48542542/functions-drastically-slowing-down-calculation-time/48590186#48590186", "title": "Functions drastically slowing down calculation time", "body": "<p>Well, by default, UDF's (User Defined Functions) in Excel VBA are not volatile. They are only recalculated when any of the function's arguments change. A volatile function will be recalculated whenever calculation occurs in any cells on the worksheet.  </p>\n\n<p>Turn Off Automatic Calculation</p>\n\n<p>vba performanceSet the Calculation mode to xlCalculationManual so that no calculations are carried out within the Excel Workbook until the Calculation mode is changed back to xlCalculationAutomatic or by running Application.Calculate:</p>\n\n<pre><code>Application.Calculation = xlCalculationManual\n</code></pre>\n\n<p>Turn Off Screen Updating</p>\n\n<p>vba performancePrevent Excel from updating the Excel screen until this option is changed to True:</p>\n\n<pre><code>Application.ScreenUpdating = False\n</code></pre>\n\n<p>The XLSB format vs. XLSM</p>\n\n<p>vba performanceA known way to improve Excel VBA speed and efficiency, especially fore large Excel files, is to save your Workbooks in binary XLSB format.</p>\n"}], "owner": {"reputation": 540, "user_id": 7977245, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/75d742b8a8e957e7d15b8b040818fea4?s=128&d=identicon&r=PG&f=1", "display_name": "dre_84w934", "link": "https://stackoverflow.com/users/7977245/dre-84w934"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 95, "favorite_count": 0, "accepted_answer_id": 48543189, "answer_count": 2, "score": 0, "last_activity_date": 1517602195, "creation_date": 1517402678, "last_edit_date": 1517404125, "question_id": 48542542, "link": "https://stackoverflow.com/questions/48542542/functions-drastically-slowing-down-calculation-time", "title": "Functions drastically slowing down calculation time", "body": "<p>I have an excel table where I'm using my custom made functions, made in <code>VBA</code>. I have to mention that I am using these functions inside cells, not in a macro. Everything works just fine, however, I am noticing a dramatic slowdown in calculation time. To be honest, I am using my function in about 200 cells, but still I don't see how it can reason such a memory hungry spreadsheet. Also my 2 functions are very basic, one is a plain vanilla <code>isExist</code>(value) search in a 5 cells range (no binary or other fast search algos). The other function is a modified <code>dateDiff</code>, so I can use it as a cell function (for some reason dateDiff does not show as a cell formula). Anyways, can someone tell me why a vba function  would be so memory hungry when used in cell as a formula, and how can I optimize this?</p>\n\n<pre><code>Function existsInArray(array_to_search As range, value_to_exist As String) As Boolean\n    For Each value In array_to_search\n        If value_to_exist = value Then\n            existsInArray = True\n            Exit Function\n        End If\n    Next\n    existsInArray = False\nEnd Function\n\n\nFunction dayOfTheYear(begining_of_year_date As Date, to_date As Date) As Integer\n    dayOfTheYear = CInt(DateDiff(\"d\", begining_of_year_date, to_date)) + 1\nEnd Function\n</code></pre>\n"}, {"tags": ["arrays", "vba", "excel", "data-structures"], "comments": [{"owner": {"reputation": 1580, "user_id": 7938503, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OYvg2.jpg?s=128&g=1", "display_name": "Plagon", "link": "https://stackoverflow.com/users/7938503/plagon"}, "edited": false, "score": 0, "creation_date": 1517405037, "post_id": 48542329, "comment_id": 84081480, "body": "Could you add what you currently have? So you have a table that gets filtered by the user and you want to check which rows are removed?"}, {"owner": {"reputation": 3333, "user_id": 6609896, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/Zhi35.jpg?s=128&g=1", "display_name": "Greedo", "link": "https://stackoverflow.com/users/6609896/greedo"}, "reply_to_user": {"reputation": 1580, "user_id": 7938503, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OYvg2.jpg?s=128&g=1", "display_name": "Plagon", "link": "https://stackoverflow.com/users/7938503/plagon"}, "edited": false, "score": 1, "creation_date": 1517405718, "post_id": 48542329, "comment_id": 84081944, "body": "@UGP I was only suggesting quasi-code. i.e. This is the approach I would take - using a collection of arrays to model the <code>listObject</code> within VBA data structures. In terms of <i>how</i> to check which rows were filtered, my current approach is to <code>Filter</code> then compare changes with a Loop, but I&#39;m wondering if there&#39;s a datastructure that either allows me to compare changes between two arrays, or logs what gets filtered. N.B the user isn&#39;t filtering the <code>ListObject</code>; my internal data structure is populated by the <code>ListObject</code>,is filtered, then writes changes back by deleting rows of the <code>listObject</code>"}], "owner": {"reputation": 3333, "user_id": 6609896, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/Zhi35.jpg?s=128&g=1", "display_name": "Greedo", "link": "https://stackoverflow.com/users/6609896/greedo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 67, "favorite_count": 2, "answer_count": 0, "score": 0, "last_activity_date": 1517402022, "creation_date": 1517402022, "question_id": 48542329, "link": "https://stackoverflow.com/questions/48542329/efficient-data-structure-for-comparing-changes", "title": "Efficient data structure for comparing changes", "body": "<p>I have a table of data on a sheet (<code>listObject</code>). I would like to write it to a vba data structure where I filter the columns, and compare the changes so that I can update the <code>listObject</code></p>\n\n<p>Currently my approach is to store the <code>listObject</code> as a <code>Collection</code> of <code>Arrays</code> where each array has a Key representing the column header. I then filter the arrays with <a href=\"http://www.excelfunctions.net/vba-filter-function.html\" rel=\"nofollow noreferrer\"><code>Filter</code></a></p>\n\n<p>Now I have 2 issues;</p>\n\n<ol>\n<li>I don't know which rows were filtered out for a given column [1D changes]\n\n<ul>\n<li>The inefficient solution is of course to loop over the values in original column and check against the filtered array, noting the row numbers where items are now missing</li>\n</ul></li>\n<li>If more than one column is filtered I don't know which rows remain completely untouched [2D changes]\n\n<ul>\n<li>Here I'm referring to those times when a the rows filtered from each column don't match up - like filtering two columns of a table in a spreadsheet</li>\n<li>One solution for this is just to repeat <em>1.</em> over each column, which isn't so inefficient</li>\n</ul></li>\n</ol>\n\n<p>Is there a good vba data-structure which allows changes in either 1D arrays, or 2D arrays/collections of arrays/tables to be tracked? </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 4, "creation_date": 1517401996, "post_id": 48542244, "comment_id": 84079512, "body": "Perhaps you need a semicolon rather than comma: <code>=loopThroughFilesCount2(&quot;C:\\Users\\yalinbah\\Desktop\\20180131_&zwnj;&#8203;120549\\New folder\\ayakkab\u0131\\&quot;;&quot;A2&quot;)</code>"}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1517402318, "post_id": 48542244, "comment_id": 84079722, "body": "That isn&#39;t a VBA error -- it is an error that Excel itself throws before the VBA is even called. @Rory is probably correct as to the source of the error (since it is syntactical rather than semantic)."}, {"owner": {"reputation": 2709, "user_id": 4579015, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/56bbb7da70756a6470a57e2ee5ca341f?s=128&d=identicon&r=PG&f=1", "display_name": "LocEngineer", "link": "https://stackoverflow.com/users/4579015/locengineer"}, "edited": false, "score": 0, "creation_date": 1517405860, "post_id": 48542244, "comment_id": 84082058, "body": "Also I am guessing that you don&#39;t want the quotes around &quot;A2&quot;? You certainly want to find files with the value of <i>cell</i> A2 =&gt; No quotes."}, {"owner": {"reputation": 839, "user_id": 6478363, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/222535f9bbc7882d4d6d49fe6054a8a6?s=128&d=identicon&r=PG&f=1", "display_name": "TotsieMae", "link": "https://stackoverflow.com/users/6478363/totsiemae"}, "reply_to_user": {"reputation": 2709, "user_id": 4579015, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/56bbb7da70756a6470a57e2ee5ca341f?s=128&d=identicon&r=PG&f=1", "display_name": "LocEngineer", "link": "https://stackoverflow.com/users/4579015/locengineer"}, "edited": false, "score": 0, "creation_date": 1517406335, "post_id": 48542244, "comment_id": 84082402, "body": "@LocEngineer, the function defines <code>strToFind</code> as a string, so while it may or may not be looking for what he actually intends, I don&#39;t think that should throw the error. <code>FilesCount</code> also doesn&#39;t appear to be dimensioned anywhere; do you have <code>Option Explicit</code> turned on?"}, {"owner": {"reputation": 2709, "user_id": 4579015, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/56bbb7da70756a6470a57e2ee5ca341f?s=128&d=identicon&r=PG&f=1", "display_name": "LocEngineer", "link": "https://stackoverflow.com/users/4579015/locengineer"}, "reply_to_user": {"reputation": 839, "user_id": 6478363, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/222535f9bbc7882d4d6d49fe6054a8a6?s=128&d=identicon&r=PG&f=1", "display_name": "TotsieMae", "link": "https://stackoverflow.com/users/6478363/totsiemae"}, "edited": false, "score": 0, "creation_date": 1517407274, "post_id": 48542244, "comment_id": 84083108, "body": "@TotsieMae My comment wasn&#39;t about the error, that is probably what Rory said: semicolon instead of comma due to localized Excel. Mine was just an additional remark."}, {"owner": {"reputation": 11, "user_id": 9288493, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-eY7j7gkd0hY/AAAAAAAAAAI/AAAAAAAAEvU/N8p0ahDZ_C4/photo.jpg?sz=128", "display_name": "Bahad\u0131r Yal\u0131n", "link": "https://stackoverflow.com/users/9288493/bahad%c4%b1r-yal%c4%b1n"}, "edited": false, "score": 0, "creation_date": 1517469285, "post_id": 48542244, "comment_id": 84110191, "body": "Thank for your replies, I put &quot;;&quot; instead of &quot;,&quot; and write directly A2 instead of &quot;A2&quot;. My problem is solved thank you a lot."}], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 9288493, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-eY7j7gkd0hY/AAAAAAAAAAI/AAAAAAAAEvU/N8p0ahDZ_C4/photo.jpg?sz=128", "display_name": "Bahad\u0131r Yal\u0131n", "link": "https://stackoverflow.com/users/9288493/bahad%c4%b1r-yal%c4%b1n"}, "is_accepted": false, "score": 0, "last_activity_date": 1517469539, "creation_date": 1517469539, "answer_id": 48557292, "question_id": 48542244, "link": "https://stackoverflow.com/questions/48542244/formula-error-the-formula-you-typed-contains-an-error/48557292#48557292", "title": "Formula error &quot;The formula you typed contains an error&quot;", "body": "<p>Problem is solved. Correct formula is below.</p>\n\n<pre><code>=loopThroughFilesCount2(\"C:\\Users\\yalinbah\\Desktop\\20180131_120549\\New folder\\ayakkab\u0131\\\";A2)\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 9288493, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-eY7j7gkd0hY/AAAAAAAAAAI/AAAAAAAAEvU/N8p0ahDZ_C4/photo.jpg?sz=128", "display_name": "Bahad\u0131r Yal\u0131n", "link": "https://stackoverflow.com/users/9288493/bahad%c4%b1r-yal%c4%b1n"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 112, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1517469539, "creation_date": 1517401762, "last_edit_date": 1517469354, "question_id": 48542244, "link": "https://stackoverflow.com/questions/48542244/formula-error-the-formula-you-typed-contains-an-error", "title": "Formula error &quot;The formula you typed contains an error&quot;", "body": "<p><strong>I use excel 2010.</strong></p>\n\n<p>I have the below formula that returns me an error </p>\n\n<blockquote>\n  <p>The formula you typed contains an error</p>\n</blockquote>\n\n<p>. Is there any way to resolve this? Thanks.</p>\n\n<pre><code>=loopThroughFilesCount2(\"C:\\Users\\yalinbah\\Desktop\\20180131_120549\\New folder\\ayakkab\u0131\\\",\"A2\")\n</code></pre>\n\n<p><strong>Here is my VBA formula</strong></p>\n\n<pre><code>Function loopThroughFilesCount2(dirFolder As String, strToFind As String) As Double\n\n    Dim filePath As Variant\n    filePath = Dir(dirFolder)\n    While (filePath &lt;&gt; \"\")\n        If InStr(filePath, strToFind) &gt; 0 Then\n            filesCount = filesCount + 1\n        End If\n        filePath = Dir\n    Wend\n\n    loopThroughFilesCount2 = filesCount\n\nEnd Function\n</code></pre>\n\n<p>Problem is solved. Correct formula is below.</p>\n\n<pre><code>=loopThroughFilesCount2(\"C:\\Users\\yalinbah\\Desktop\\20180131_120549\\New folder\\ayakkab\u0131\\\";A2)\n</code></pre>\n"}, {"tags": ["arrays", "vba"], "comments": [{"owner": {"reputation": 534, "user_id": 2398630, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/423e9611f4212cb6f66cd30c9da6410f?s=128&d=identicon&r=PG", "display_name": "Siyon DP", "link": "https://stackoverflow.com/users/2398630/siyon-dp"}, "edited": false, "score": 0, "creation_date": 1517402503, "post_id": 48542023, "comment_id": 84079820, "body": "You can (and should for performance reasons) manipulate ranges assigning them to arrays. So, if we have any range <code>Dim rng as Range      Set rng=Range(&quot;A1:A10&quot;) </code> We can assign <code>Dim arr As varient     arr=rng</code>  But we have to treat it as two dimensional array. Because Excel VBA does&#39;nt &quot;know&quot; it is one dimensional. So we can now   <code>For i=1 To 10         arr(i,1) = i   Next</code>"}, {"owner": {"reputation": 123, "user_id": 8660840, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c53802bb4e901e915b1f4ccb125e74f2?s=128&d=identicon&r=PG&f=1", "display_name": "Tanpo", "link": "https://stackoverflow.com/users/8660840/tanpo"}, "reply_to_user": {"reputation": 534, "user_id": 2398630, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/423e9611f4212cb6f66cd30c9da6410f?s=128&d=identicon&r=PG", "display_name": "Siyon DP", "link": "https://stackoverflow.com/users/2398630/siyon-dp"}, "edited": false, "score": 0, "creation_date": 1517402661, "post_id": 48542023, "comment_id": 84079916, "body": "thanks TSion, so it will always be 2 dimensional, just how VBA works?  Unfortunately the namedranges are dynamic (in a table). so this way is super easy. :)"}, {"owner": {"reputation": 534, "user_id": 2398630, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/423e9611f4212cb6f66cd30c9da6410f?s=128&d=identicon&r=PG", "display_name": "Siyon DP", "link": "https://stackoverflow.com/users/2398630/siyon-dp"}, "edited": false, "score": 0, "creation_date": 1517402700, "post_id": 48542023, "comment_id": 84079951, "body": "Excel is a 2 dimensional planet ;-)"}, {"owner": {"reputation": 123, "user_id": 8660840, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c53802bb4e901e915b1f4ccb125e74f2?s=128&d=identicon&r=PG&f=1", "display_name": "Tanpo", "link": "https://stackoverflow.com/users/8660840/tanpo"}, "reply_to_user": {"reputation": 534, "user_id": 2398630, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/423e9611f4212cb6f66cd30c9da6410f?s=128&d=identicon&r=PG", "display_name": "Siyon DP", "link": "https://stackoverflow.com/users/2398630/siyon-dp"}, "edited": false, "score": 0, "creation_date": 1517402845, "post_id": 48542023, "comment_id": 84080041, "body": "Thanks for your clarification :)"}], "answers": [{"tags": [], "owner": {"reputation": 534, "user_id": 2398630, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/423e9611f4212cb6f66cd30c9da6410f?s=128&d=identicon&r=PG", "display_name": "Siyon DP", "link": "https://stackoverflow.com/users/2398630/siyon-dp"}, "is_accepted": true, "score": 0, "last_activity_date": 1517405457, "creation_date": 1517405457, "answer_id": 48543393, "question_id": 48542023, "link": "https://stackoverflow.com/questions/48542023/assigning-a-named-range-to-array/48543393#48543393", "title": "Assigning a named range to array", "body": "<p>If we have any range <br /></p>\n\n<pre><code>Dim rng as Range \nSet rng=Range(\"A1:A10\") \n</code></pre>\n\n<p>We can assign <br /></p>\n\n<pre><code>Dim arr As Varient \narr = rng \n</code></pre>\n\n<p>But we have to treat it as two dimensional array. Because Excel VBA does'nt \"know\" it is one dimensional. <br />\nSo we can now </p>\n\n<pre><code>For i=1 To 10 \n    arr(i,1) = i \nNext\n</code></pre>\n"}], "owner": {"reputation": 123, "user_id": 8660840, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c53802bb4e901e915b1f4ccb125e74f2?s=128&d=identicon&r=PG&f=1", "display_name": "Tanpo", "link": "https://stackoverflow.com/users/8660840/tanpo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 985, "favorite_count": 0, "accepted_answer_id": 48543393, "answer_count": 1, "score": 0, "last_activity_date": 1517405457, "creation_date": 1517401084, "last_edit_date": 1517404293, "question_id": 48542023, "link": "https://stackoverflow.com/questions/48542023/assigning-a-named-range-to-array", "title": "Assigning a named range to array", "body": "<p>I've found something that I don't quite understand. Please help explain.</p>\n\n<p>so I used this code to assign values within named ranges to an array. (see below). </p>\n\n<pre><code>Dim accountStructure As Variant\nReDim accountStructure(2)\naccountStructure(0) = Range(\"namedrange1\")\naccountStructure(1) = Range(\"namedrange2\")\naccountStructure(2) = Range(\"namedrange3\")\n</code></pre>\n\n<p>The code works. However, in order to call the first item in accountstructure(0) I need to type accountStructure(0)(1,1), second item accountStructure(0)(2,1) third item (0)(3,1) and so on. \nI understand why there is (0) there but I don't understand why there is always a 1 after the item number. Please help me understand this.</p>\n"}, {"tags": ["vba", "powerpoint"], "answers": [{"comments": [{"owner": {"reputation": 2189, "user_id": 8726447, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/961e6112f7d5aac9646ce1469e89fe20?s=128&d=identicon&r=PG&f=1", "display_name": "MarcinSzaleniec", "link": "https://stackoverflow.com/users/8726447/marcinszaleniec"}, "edited": false, "score": 0, "creation_date": 1517472089, "post_id": 48546592, "comment_id": 84111497, "body": "I get it, but I think it should be If ActivePresentation.Designs(1).SlideMaster.CustomLayouts(1).B&zwnj;&#8203;ackground.Fill.Type = 6. Or = msoFillPicture."}, {"owner": {"reputation": 12482, "user_id": 1667023, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JXaUt.png?s=128&g=1", "display_name": "Steve Rindsberg", "link": "https://stackoverflow.com/users/1667023/steve-rindsberg"}, "reply_to_user": {"reputation": 2189, "user_id": 8726447, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/961e6112f7d5aac9646ce1469e89fe20?s=128&d=identicon&r=PG&f=1", "display_name": "MarcinSzaleniec", "link": "https://stackoverflow.com/users/8726447/marcinszaleniec"}, "edited": false, "score": 0, "creation_date": 1517520417, "post_id": 48546592, "comment_id": 84140786, "body": "You&#39;re absolutely correct. My apologies.  I&#39;ve edited my answer to correct the mistake. I opted to use 6 rather than msoFillPicture because if someone&#39;s using the same code from e.g. VB rather than VBA in Office, msoFillPicture wouldn&#39;t be defined."}], "tags": [], "owner": {"reputation": 12482, "user_id": 1667023, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JXaUt.png?s=128&g=1", "display_name": "Steve Rindsberg", "link": "https://stackoverflow.com/users/1667023/steve-rindsberg"}, "is_accepted": true, "score": 1, "last_activity_date": 1517520388, "last_edit_date": 1517520388, "creation_date": 1517415029, "answer_id": 48546592, "question_id": 48541954, "link": "https://stackoverflow.com/questions/48541954/check-if-powerpoint-s-customlayout-has-picture-set/48546592#48546592", "title": "Check if PowerPoint\u2019s CustomLayout has picture set", "body": "<p>This'll tell you whether it's picture-filled or not. I don't think there's a way of learning the original name of the picture, but you can force it with .Fill.UserPicture \"full path to picture file\"</p>\n\n<pre><code>If ActivePresentation.Designs(1).SlideMaster.CustomLayouts(1).Background.Fill.Type = 6 Then\n  MsgBox \"Layout 1 has a picture fill\"\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 2189, "user_id": 8726447, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/961e6112f7d5aac9646ce1469e89fe20?s=128&d=identicon&r=PG&f=1", "display_name": "MarcinSzaleniec", "link": "https://stackoverflow.com/users/8726447/marcinszaleniec"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 44, "favorite_count": 0, "accepted_answer_id": 48546592, "answer_count": 1, "score": 0, "last_activity_date": 1517520388, "creation_date": 1517400864, "last_edit_date": 1517404328, "question_id": 48541954, "link": "https://stackoverflow.com/questions/48541954/check-if-powerpoint-s-customlayout-has-picture-set", "title": "Check if PowerPoint\u2019s CustomLayout has picture set", "body": "<p>I am trying to determine if the PowerPoint\u2019s custom layout has user\u2019s picture in the background. I were looking for equivalent of this code:</p>\n\n<pre><code>ActivePresentation.Designs(1).SlideMaster.CustomLayouts(1).Background.Fill.HasPicture\n</code></pre>\n\n<p>But apparently there is not anything like HasPicture property for CustomLayouts.Background.Fill. I wonder if anyone know round about for this problem. </p>\n"}, {"tags": ["vba", "ms-access", "datasheet"], "answers": [{"comments": [{"owner": {"reputation": 468, "user_id": 7858451, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/p36vb.jpg?s=128&g=1", "display_name": "Joe J", "link": "https://stackoverflow.com/users/7858451/joe-j"}, "edited": false, "score": 0, "creation_date": 1517405788, "post_id": 48542614, "comment_id": 84081994, "body": "Yes - I never thought of that. That is simple and effective too. Excellent. Thank you."}], "tags": [], "owner": {"reputation": 6188, "user_id": 5339178, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5DL9b.jpg?s=128&g=1", "display_name": "Sergey S.", "link": "https://stackoverflow.com/users/5339178/sergey-s"}, "is_accepted": true, "score": 3, "last_activity_date": 1517402940, "creation_date": 1517402940, "answer_id": 48542614, "question_id": 48541928, "link": "https://stackoverflow.com/questions/48541928/prevent-user-from-unhiding-datasheet-columns/48542614#48542614", "title": "Prevent User From Unhiding Datasheet Columns", "body": "<p>In MouseUp event You can check if <code>ColumnHidden</code> of hidden column is false (user \"resized\" the column), hide it.</p>\n\n<pre><code>Private Sub Form_MouseUp(Button As Integer, Shift As Integer, X As Single, Y As Single)\nIf Me.MyHiddenColumn.ColumnHidden = False Then\n    Me.MyHiddenColumn.ColumnHidden = True\nEnd If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 468, "user_id": 7858451, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/p36vb.jpg?s=128&g=1", "display_name": "Joe J", "link": "https://stackoverflow.com/users/7858451/joe-j"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 634, "favorite_count": 0, "accepted_answer_id": 48542614, "answer_count": 1, "score": 1, "last_activity_date": 1517404386, "creation_date": 1517400804, "last_edit_date": 1517404386, "question_id": 48541928, "link": "https://stackoverflow.com/questions/48541928/prevent-user-from-unhiding-datasheet-columns", "title": "Prevent User From Unhiding Datasheet Columns", "body": "<p>I have hidden several columns in an access datasheet using the <a href=\"https://msdn.microsoft.com/en-us/library/office/aa224064(v=office.11).aspx\" rel=\"nofollow noreferrer\">ColumnHidden property</a> like this example here:</p>\n\n<pre><code>ColumnName.ColumnHidden = true\n</code></pre>\n\n<p>This works great, but when I view the datasheet, the end user can unhide the column by \"resizing\" the space either side of where the column is hiding:</p>\n\n<p><a href=\"https://i.stack.imgur.com/1JUEf.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/1JUEf.png\" alt=\"enter image description here\"></a></p>\n\n<p>I have found a couple of hacks to resize the columns using the <code>ColumnWidth</code> property via vba on certain events vba etc. but I was wondering whether there is a simple way to disable this \"resize\" feature in the first place for hidden columns only?</p>\n"}, {"tags": ["vba", "excel", "ms-access"], "comments": [{"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1517403438, "post_id": 48541837, "comment_id": 84080405, "body": "<code>Application.Echo True</code> doesn&#39;t hurt if it is already <code>True</code>, so it&#39;s a good rule of thumb to always do this in your procedure exit handler, if you have set it to False anywhere in that procedure."}, {"owner": {"reputation": 5, "user_id": 9257638, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4e4c54cfa78eaf220f98a9b8eda6d0f0?s=128&d=identicon&r=PG&f=1", "display_name": "John", "link": "https://stackoverflow.com/users/9257638/john"}, "reply_to_user": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1517405232, "post_id": 48541837, "comment_id": 84081600, "body": "I already do that in my exit and error handler. Just need to know for other reasons."}, {"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "edited": false, "score": 0, "creation_date": 1517415007, "post_id": 48541837, "comment_id": 84088765, "body": "The short answer is No. I&#39;m not aware of a long answer."}, {"owner": {"reputation": 5, "user_id": 9257638, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4e4c54cfa78eaf220f98a9b8eda6d0f0?s=128&d=identicon&r=PG&f=1", "display_name": "John", "link": "https://stackoverflow.com/users/9257638/john"}, "edited": false, "score": 0, "creation_date": 1517417601, "post_id": 48541837, "comment_id": 84090582, "body": "Well, of all people, you would know. Thanks."}], "owner": {"reputation": 5, "user_id": 9257638, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4e4c54cfa78eaf220f98a9b8eda6d0f0?s=128&d=identicon&r=PG&f=1", "display_name": "John", "link": "https://stackoverflow.com/users/9257638/john"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 309, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1517404412, "creation_date": 1517400564, "last_edit_date": 1531164843, "question_id": 48541837, "link": "https://stackoverflow.com/questions/48541837/return-value-of-echo", "title": "return value of &#39;echo&#39;", "body": "<p>In VBA is there anyway to return the state of 'Echo'?</p>\n\n<p><code>docmd.echo</code>  or <code>Application.Echo</code></p>\n\n<p>Want to know if it's on or off.\nI could write a function that set a global variable, but would prefer if there was a direct way to access the 'echo' value.</p>\n\n<p><a href=\"https://msdn.microsoft.com/en-us/vba/access-vba/articles/application-echo-method-access\" rel=\"nofollow noreferrer\">Application.Echo method in MS Access</a></p>\n"}, {"tags": ["excel", "rest", "api", "vba"], "answers": [{"tags": [], "owner": {"reputation": 356, "user_id": 9187819, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da96a26b9a8b9c848f644009ff4fab76?s=128&d=identicon&r=PG&f=1", "display_name": "tomichel", "link": "https://stackoverflow.com/users/9187819/tomichel"}, "is_accepted": true, "score": 1, "last_activity_date": 1517407714, "creation_date": 1517407714, "answer_id": 48544146, "question_id": 48541597, "link": "https://stackoverflow.com/questions/48541597/inset-3-headers-for-rest-api-tokens/48544146#48544146", "title": "Inset 3 headers for REST API tokens", "body": "<p>So if I get you correct you need to set the headers of you Request with </p>\n\n<pre><code>SetRequestHeader\n</code></pre>\n\n<p>(Documentation here: <a href=\"https://msdn.microsoft.com/de-de/library/windows/desktop/aa384060(v=vs.85).aspx\" rel=\"nofollow noreferrer\">https://msdn.microsoft.com/de-de/library/windows/desktop/aa384060(v=vs.85).aspx</a>)</p>\n\n<p>And here an example for a GET Request:</p>\n\n<pre><code>Dim result As String\nDim URL As String\nDim winHttpReq As Object\nSet winHttpReq = CreateObject(\"WinHttp.WinHttpRequest.5.1\")\n\nURL = \"YOURURL\"\n\nwinHttpReq.Open \"GET\", URL, False\nwinHttpReq.SetRequestHeader \"X-AppSecretToken\", \"YOURTOKEN\"\nwinHttpReq.SetRequestHeader \"X-AgreementGrantToken\", \"YOURTOKEN\" \nwinHttpReq.Send\n\nresult = winHttpReq.responseText\n</code></pre>\n\n<p>Hope this helps</p>\n"}], "owner": {"reputation": 47, "user_id": 5464939, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f40e3e3949e336ad2906df85a9c632d3?s=128&d=identicon&r=PG&f=1", "display_name": "Blab", "link": "https://stackoverflow.com/users/5464939/blab"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 586, "favorite_count": 0, "accepted_answer_id": 48544146, "answer_count": 1, "score": 0, "last_activity_date": 1517407714, "creation_date": 1517399813, "last_edit_date": 1531161705, "question_id": 48541597, "link": "https://stackoverflow.com/questions/48541597/inset-3-headers-for-rest-api-tokens", "title": "Inset 3 headers for REST API tokens", "body": "<p>I'm trying to follow a guide, to connect Excel with a website using REST API, but I'm already stuck. I of course got the Tokens it's mentioning. </p>\n\n<p>The guide writes; \n\"Add these three headers to your first request:</p>\n\n<p>X-AppSecretToken: TheAppSecretToken</p>\n\n<p>X-AgreementGrantToken: TheAgreementGrantToken</p>\n\n<p>Content-Type: application/json\"</p>\n\n<p>But I don't know how to do that in Excel. Does it want me to use Json? </p>\n\n<p>I hope someone is willing and capable to help me with this, thank you very much. </p>\n"}, {"tags": ["vba", "excel", "pdf"], "answers": [{"comments": [{"owner": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "edited": false, "score": 0, "creation_date": 1517442975, "post_id": 48542218, "comment_id": 84103175, "body": "The SaveAs action is initiated by the user&#39;s calling the SaveAs dialog. Then your solution would present him with another SaveAs dialog. Please read the last sentence of my question. You are suggesting a way which I expressly wanted to avoid."}, {"owner": {"reputation": 1300, "user_id": 3005534, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/giBVn.jpg?s=128&g=1", "display_name": "Miguel_Ryu", "link": "https://stackoverflow.com/users/3005534/miguel-ryu"}, "reply_to_user": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "edited": false, "score": 0, "creation_date": 1517472652, "post_id": 48542218, "comment_id": 84111749, "body": "@Variatus, If you&#39;re trying to prevent the user being served two <code>SaveAs</code> <code>File Dialog</code> prompts, you simple need to turn <code>SaveAsUI = False</code> and the original <code>SaveAs action</code> is blocked. To prevent the <code>File Dialog</code> if the user only tries to <code>Save</code>, wrap it with <code>SaveAsUI = False</code> which is the default save event state for the UI. Trying to determine the output of something that didn&#39;t happen seems like the wrong option when you can control the process, as an example you stop needing <code>AfterSave</code> to revert the file, instead create a new file to save as PDF. If not .PDF simply save as intended."}, {"owner": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "edited": false, "score": 0, "creation_date": 1517484152, "post_id": 48542218, "comment_id": 84118662, "body": "Thank you for your effort. I have up-voted your response but can&#39;t accept your answer. Again, here is the sequence: the user clicks SaveAs and selects PDF (or not). I want to know what he selected. Undoing the SaveAs action won&#39;t put the dialog back in the box because it was already shown. The alternative is to give him a button with which to call SaveAs and then everything is easy.  I am resigned to do that now but it isn&#39;t what I was hoping for."}, {"owner": {"reputation": 1300, "user_id": 3005534, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/giBVn.jpg?s=128&g=1", "display_name": "Miguel_Ryu", "link": "https://stackoverflow.com/users/3005534/miguel-ryu"}, "reply_to_user": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "edited": false, "score": 0, "creation_date": 1517492753, "post_id": 48542218, "comment_id": 84124196, "body": "@Variatus, I added an example of how I would implement this, I think it covers most of what you would need. But any way best of luck ^^"}], "tags": [], "owner": {"reputation": 1300, "user_id": 3005534, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/giBVn.jpg?s=128&g=1", "display_name": "Miguel_Ryu", "link": "https://stackoverflow.com/users/3005534/miguel-ryu"}, "is_accepted": false, "score": 4, "last_activity_date": 1517492688, "last_edit_date": 1517492688, "creation_date": 1517401706, "answer_id": 48542218, "question_id": 48541056, "link": "https://stackoverflow.com/questions/48541056/determine-if-saveas-fileformat-is-pdf/48542218#48542218", "title": "Determine if SaveAs FileFormat is PDF", "body": "<p>You can determine the file path and extension by controlling the <code>msoFileDialogSaveAs</code> like this:</p>\n\n<pre><code>Private Sub Workbook_BeforeSave(ByVal SaveAsUI As Boolean, Cancel As Boolean)\n\n    Dim intChoice As Integer\n    Dim strPath As String\n\n    'make the file dialog visible to the user\n    intChoice = Application.FileDialog(msoFileDialogSaveAs).Show\n\n    'determine what choice the user made\n    If intChoice &lt;&gt; 0 Then\n        'get the file path selected by the user\n        strPath = _\n        Application.FileDialog(msoFileDialogSaveAs).SelectedItems(1)\n        'displays the result in a message box\n        Call MsgBox(strPath, vbInformation, \"Save Path\")\n    End If\n\n    SaveAsUI = False\n    Cancel = True\n\nEnd Sub\n</code></pre>\n\n<p>After you have the full path <code>Cancel = True</code> will stop the SaveAs action so you can choose to save or not.</p>\n\n<p>Edit: You determine if the user pressed <code>Save</code> button or <code>SaveAs</code> with <code>SaveAsUI</code>. If <code>Save</code> pressed then <code>SaveAsUI = False</code> if <code>SaveAs</code> then <code>SaveAsUI = True</code></p>\n\n<p>Edit 2: \nThis is an example of how I would implement the above:</p>\n\n<pre><code>Private Sub Workbook_BeforeSave(ByVal SaveAsUI As Boolean, Cancel As Boolean)\n\n    'cancel all default actions by excel application\n    Cancel = True\n\n    'if save was selected instead of SaveAs\n    If (SaveAsUI = False) Then\n        Cancel = False\n\n    'if SaveAs was selected\n    ElseIf (SaveAsUI = True) Then\n\n        SaveAsUI = False\n        Dim intChoice As Integer\n        Dim strPath As String\n\n        'make the file dialog visible to the user\n        intChoice = Application.FileDialog(msoFileDialogSaveAs).Show\n\n        'determine what choice the user made\n        If intChoice &lt;&gt; 0 Then\n            'get the file path selected by the user\n            strPath = Application.FileDialog(msoFileDialogSaveAs).SelectedItems(1)\n\n            'get file extention\n            fileExt = Right(strPath, Len(strPath) - InStr(strPath, \".\") + 1)\n\n            'if pdf is the chosen format\n            If (InStr(strPath, \"PDF\") &gt; 0) Then\n\n                'actions with pdf format\n                Call MsgBox(strPath, vbInformation, \"Save Path\")\n            Else\n\n                With ActiveWorkbook\n                    'on error resume next in case of extention macro free prompt no is selected\n                    'see example by removing on error resume next and saving extention \".xlsx\"\n                    On Error Resume Next\n                    .SaveAs strPath\n                    On Error GoTo 0\n                End With\n\n            End If\n        End If\n\n    End If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 227, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1517492688, "creation_date": 1517398075, "last_edit_date": 1531164843, "question_id": 48541056, "link": "https://stackoverflow.com/questions/48541056/determine-if-saveas-fileformat-is-pdf", "title": "Determine if SaveAs FileFormat is PDF", "body": "<p>I want to make changes to an Excel worksheet before it is saved to PDF and undo those changes after the copy has been created. I thought of using the <code>Workbook_BeforeSave</code> event to implement the changes and the <code>Workbook_AfterSave</code> event to return the worksheet to its original state. </p>\n\n<p>The point at which I got stuck is when I want to determine the output format for the SaveAs instruction. It doesn't seem to be available in the <code>Workbook_BeforeSave</code> event, and I know of no event that I might capture the SaveAs dialog with unless I force the user to use a particular instance of this dialog.</p>\n\n<p>I would like the user to choose SaveAs from Excel's UI and take action if he chose to save as PDF.</p>\n"}, {"tags": ["ms-access", "vba", "ms-access-2010"], "comments": [{"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1517396939, "post_id": 48540466, "comment_id": 84076469, "body": "What do you mean with <i>stored as a %</i>? What is the actual data type?"}, {"owner": {"reputation": 331, "user_id": 6555096, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/USn3a.png?s=128&g=1", "display_name": "dmorgan20", "link": "https://stackoverflow.com/users/6555096/dmorgan20"}, "reply_to_user": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1517397076, "post_id": 48540466, "comment_id": 84076578, "body": "The data type is set to: Number, Double, Percent"}], "answers": [{"comments": [{"owner": {"reputation": 331, "user_id": 6555096, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/USn3a.png?s=128&g=1", "display_name": "dmorgan20", "link": "https://stackoverflow.com/users/6555096/dmorgan20"}, "edited": false, "score": 0, "creation_date": 1517397783, "post_id": 48540834, "comment_id": 84077024, "body": "Thank you for the reply - Its strange as the label strays red at all times for some reason,"}, {"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "reply_to_user": {"reputation": 331, "user_id": 6555096, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/USn3a.png?s=128&g=1", "display_name": "dmorgan20", "link": "https://stackoverflow.com/users/6555096/dmorgan20"}, "edited": false, "score": 0, "creation_date": 1517398514, "post_id": 48540834, "comment_id": 84077482, "body": "That&#39;s something you will have to debug yourself, or you will have to provide enough info for me to do it."}, {"owner": {"reputation": 331, "user_id": 6555096, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/USn3a.png?s=128&g=1", "display_name": "dmorgan20", "link": "https://stackoverflow.com/users/6555096/dmorgan20"}, "edited": false, "score": 0, "creation_date": 1517398764, "post_id": 48540834, "comment_id": 84077629, "body": "Thank you for the efforts. I will spend some time working through it. Spent a few hours already, doh!"}], "tags": [], "owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "is_accepted": false, "score": 0, "last_activity_date": 1517397321, "creation_date": 1517397321, "answer_id": 48540834, "question_id": 48540466, "link": "https://stackoverflow.com/questions/48540466/finding-a-percentage-and-minus-a-percentage-from-it/48540834#48540834", "title": "Finding a percentage and minus a percentage from it", "body": "<p>You can use calculus inside your <code>DLookUp</code>.</p>\n\n<p>Try the following:</p>\n\n<pre><code>If Availability &lt; DLookup(\"[Availability]-0.02\", \"[tbl_RAG]\", \"[Department] = 'Outbound'\") Then RAGAvailability.ForeColor = RGB(192, 0, 0) 'red\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 331, "user_id": 6555096, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/USn3a.png?s=128&g=1", "display_name": "dmorgan20", "link": "https://stackoverflow.com/users/6555096/dmorgan20"}, "edited": false, "score": 0, "creation_date": 1517398513, "post_id": 48540849, "comment_id": 84077481, "body": "Thank you for the reply - Its strange as the label stays red at all times for some reason"}, {"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "reply_to_user": {"reputation": 331, "user_id": 6555096, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/USn3a.png?s=128&g=1", "display_name": "dmorgan20", "link": "https://stackoverflow.com/users/6555096/dmorgan20"}, "edited": false, "score": 0, "creation_date": 1517405444, "post_id": 48540849, "comment_id": 84081730, "body": "You may have to &quot;reset&quot; the colour. See edit, please."}], "tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": true, "score": 1, "last_activity_date": 1517405412, "last_edit_date": 1517405412, "creation_date": 1517397357, "answer_id": 48540849, "question_id": 48540466, "link": "https://stackoverflow.com/questions/48540466/finding-a-percentage-and-minus-a-percentage-from-it/48540849#48540849", "title": "Finding a percentage and minus a percentage from it", "body": "<p>Your second attempt is correct, but perhaps DLookup returns Null? If so:</p>\n\n<pre><code>If Availability &lt; Nz(DLookup(\"[Availability]\", \"[tbl_RAG]\", \"[Department] = 'Outbound'\"), 0) - 0.02 Then \n    RAGAvailability.ForeColor = RGB(192, 0, 0) 'red\nEnd If\n</code></pre>\n\n<p>or you are using Double and not Currency. Then:</p>\n\n<pre><code>If Availability &lt; CCur(Nz(DLookup(\"[Availability]\", \"[tbl_RAG]\", \"[Department] = 'Outbound'\"), 0)) - CCur(0.02) Then \n    RAGAvailability.ForeColor = RGB(192, 0, 0) 'red\nEnd If\n</code></pre>\n\n<p><strong>Edit</strong>:\nTo change colour back and forth:</p>\n\n<pre><code>Dim Color As Long\n\nIf Availability &lt; CCur(Nz(DLookup(\"[Availability]\", \"[tbl_RAG]\", \"[Department] = 'Outbound'\"), 0)) - CCur(0.02) Then \n    Color = vbRed\nElse\n    Color = vbBlack\nEnd If\nRAGAvailability.ForeColor = Color\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "edited": false, "score": 0, "creation_date": 1517415246, "post_id": 48545204, "comment_id": 84088910, "body": "As you will compare strings, that will fail for, say, <code>&quot;10%&quot; &gt; &quot;2%&quot;</code>. Use <i>Currency</i> whenever dealing with amounts."}, {"owner": {"reputation": 331, "user_id": 6555096, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/USn3a.png?s=128&g=1", "display_name": "dmorgan20", "link": "https://stackoverflow.com/users/6555096/dmorgan20"}, "reply_to_user": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "edited": false, "score": 0, "creation_date": 1517820960, "post_id": 48545204, "comment_id": 84233995, "body": "Thank you for the advice"}], "tags": [], "owner": {"reputation": 331, "user_id": 6555096, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/USn3a.png?s=128&g=1", "display_name": "dmorgan20", "link": "https://stackoverflow.com/users/6555096/dmorgan20"}, "is_accepted": false, "score": -1, "last_activity_date": 1517410878, "creation_date": 1517410878, "answer_id": 48545204, "question_id": 48540466, "link": "https://stackoverflow.com/questions/48540466/finding-a-percentage-and-minus-a-percentage-from-it/48545204#48545204", "title": "Finding a percentage and minus a percentage from it", "body": "<p>Thank you for the help. I seem to have corrected the problem using the below code:</p>\n\n<pre><code>Dim db As Database, AvailRs As Recordset\nSet db = CurrentDb\nSet AvailRs = db.OpenRecordset(\"Select * from tbl_RAG\")\n\nSelect Case Availability\n    Case Is &gt; Format(AvailRs!UpperAvailability, \"percent\")\n        RAGAvailability.ForeColor = RGB(0, 176, 80)\n    Case Is &lt; Format(AvailRs!lowerAvailability, \"percent\")\n        RAGAvailability.ForeColor = RGB(192, 0, 0)\n    Case Else\n        RAGAvailability.ForeColor = RGB(255, 192, 0)\nEnd Select\n</code></pre>\n\n<p><strong>What was happening:</strong>\nMy understanding is the code couldn't read the string from <em>Available</em>. I formatted it as percent and put it together using Select Case</p>\n"}], "owner": {"reputation": 331, "user_id": 6555096, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/USn3a.png?s=128&g=1", "display_name": "dmorgan20", "link": "https://stackoverflow.com/users/6555096/dmorgan20"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 25, "favorite_count": 0, "accepted_answer_id": 48540849, "answer_count": 3, "score": 0, "last_activity_date": 1517410878, "creation_date": 1517396220, "question_id": 48540466, "link": "https://stackoverflow.com/questions/48540466/finding-a-percentage-and-minus-a-percentage-from-it", "title": "Finding a percentage and minus a percentage from it", "body": "<p>I have a simple line of code that works fine, shown below:</p>\n\n<pre><code>If Availability &gt;= DLookup(\"[Availability]\", \"[tbl_RAG]\", \"[Department] = 'Outbound'\") Then RAGAvailability.ForeColor = RGB(0, 176, 80) 'green\n</code></pre>\n\n<p>I have modified it slightly to deduct 2% from the figure it finds, shown below (please note the below is the one that's not working:</p>\n\n<p><strong>Code:</strong></p>\n\n<pre><code>If Availability &lt; DLookup(\"[Availability]\", \"[tbl_RAG]\", \"[Department] = 'Outbound'\") - (Format(2, \"percent\")) Then RAGAvailability.ForeColor = RGB(192, 0, 0) 'red\n</code></pre>\n\n<p>I have also tried:</p>\n\n<pre><code>If Availability &lt; DLookup(\"[Availability]\", \"[tbl_RAG]\", \"[Department] = 'Outbound'\") - 0.02 Then RAGAvailability.ForeColor = RGB(192, 0, 0) 'red\n</code></pre>\n\n<p>The table TBL_RAG the data is stored as a % already.</p>\n\n<p>Any ideas what I may be doing wrong</p>\n"}, {"tags": ["c#", "vb.net", "vba", "design-patterns"], "comments": [{"owner": {"reputation": 151, "user_id": 1232509, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/ed7e83e17a61fc9a1d800e11d9bbe9f4?s=128&d=identicon&r=PG", "display_name": "jithu", "link": "https://stackoverflow.com/users/1232509/jithu"}, "reply_to_user": {"reputation": 481661, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1517396389, "post_id": 48540409, "comment_id": 84076059, "body": "@WiktorStribi\u017cew I did not understand, such a case is not mentioned anywhere here: <a href=\"https://docs.microsoft.com/en-us/dotnet/visual-basic/language-reference/operators/like-operator\" rel=\"nofollow noreferrer\">link</a> Could you please type the complete pattern string for me? Thanks a lot"}, {"owner": {"reputation": 151, "user_id": 1232509, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/ed7e83e17a61fc9a1d800e11d9bbe9f4?s=128&d=identicon&r=PG", "display_name": "jithu", "link": "https://stackoverflow.com/users/1232509/jithu"}, "reply_to_user": {"reputation": 481661, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1517396898, "post_id": 48540409, "comment_id": 84076438, "body": "@WiktorStribi\u017cew Unfortunately, prepending the tilde will not escape the astericks in the pattern string. It did not work :("}, {"owner": {"reputation": 151, "user_id": 1232509, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/ed7e83e17a61fc9a1d800e11d9bbe9f4?s=128&d=identicon&r=PG", "display_name": "jithu", "link": "https://stackoverflow.com/users/1232509/jithu"}, "reply_to_user": {"reputation": 481661, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1517397087, "post_id": 48540409, "comment_id": 84076585, "body": "Actually I need to escape the asterisks in the pattern string, since they have a different meaning (&quot;Zero or more characters match&quot;) in the pattern strings."}, {"owner": {"reputation": 481661, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1517398006, "post_id": 48540409, "comment_id": 84077149, "body": "I can help with a regex if you want a regex solution. However, these wildcards are quite OK in this scenario once you use a character set <code>[...]</code>."}, {"owner": {"reputation": 151, "user_id": 1232509, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/ed7e83e17a61fc9a1d800e11d9bbe9f4?s=128&d=identicon&r=PG", "display_name": "jithu", "link": "https://stackoverflow.com/users/1232509/jithu"}, "reply_to_user": {"reputation": 481661, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1517398757, "post_id": 48540409, "comment_id": 84077621, "body": "@WiktorStribi\u017cew I had some problems with the regular expressions in the past while using for the same purpose, hence I decided to go with this functionality!"}], "answers": [{"comments": [{"owner": {"reputation": 151, "user_id": 1232509, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/ed7e83e17a61fc9a1d800e11d9bbe9f4?s=128&d=identicon&r=PG", "display_name": "jithu", "link": "https://stackoverflow.com/users/1232509/jithu"}, "edited": false, "score": 0, "creation_date": 1517398026, "post_id": 48540950, "comment_id": 84077161, "body": "Ahhhhhh, That&#39;s it! Thank&#39;s a lot, so mistake for not reading it properly. Thanks again &quot;A Friend&quot; :)"}, {"owner": {"reputation": 151, "user_id": 1232509, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/ed7e83e17a61fc9a1d800e11d9bbe9f4?s=128&d=identicon&r=PG", "display_name": "jithu", "link": "https://stackoverflow.com/users/1232509/jithu"}, "edited": false, "score": 0, "creation_date": 1517398481, "post_id": 48540950, "comment_id": 84077462, "body": "I am new to the regular expression language, so that I though to keep it simple, better to use the LikeOperator. Do you see any major issue in using this instead of Regex?"}, {"owner": {"reputation": 2669, "user_id": 6144259, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/999de3cfb3d5fc0b10b7d6a85957eb32?s=128&d=identicon&r=PG&f=1", "display_name": "A Friend", "link": "https://stackoverflow.com/users/6144259/a-friend"}, "reply_to_user": {"reputation": 151, "user_id": 1232509, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/ed7e83e17a61fc9a1d800e11d9bbe9f4?s=128&d=identicon&r=PG", "display_name": "jithu", "link": "https://stackoverflow.com/users/1232509/jithu"}, "edited": false, "score": 0, "creation_date": 1517399478, "post_id": 48540950, "comment_id": 84078037, "body": "There&#39;s nothing <i>wrong</i> with it, but Microsoft do advise against using this function directly, even in VB <a href=\"https://msdn.microsoft.com/en-us/library/microsoft.visualbasic.compilerservices.likeoperator.likestring(v=vs.110).aspx\" rel=\"nofollow noreferrer\">(source)</a>. The VB <code>Like</code> operator calls this."}], "tags": [], "owner": {"reputation": 2669, "user_id": 6144259, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/999de3cfb3d5fc0b10b7d6a85957eb32?s=128&d=identicon&r=PG&f=1", "display_name": "A Friend", "link": "https://stackoverflow.com/users/6144259/a-friend"}, "is_accepted": true, "score": 1, "last_activity_date": 1517397714, "creation_date": 1517397714, "answer_id": 48540950, "question_id": 48540409, "link": "https://stackoverflow.com/questions/48540409/patterns-with-special-characters-in-microsoft-visualbasic-compilerservices-likeo/48540950#48540950", "title": "Patterns with special characters in Microsoft.VisualBasic.CompilerServices.LikeOperator.LikeString does not work", "body": "<p>From <a href=\"https://docs.microsoft.com/en-us/dotnet/visual-basic/language-reference/operators/like-operator\" rel=\"nofollow noreferrer\">Like Operator</a> (which you provided):</p>\n\n<blockquote>\n  <p>To match the special characters left bracket ([), question mark (?), number sign (#), and asterisk (*), enclose them in brackets.</p>\n</blockquote>\n\n<p>Therefore you need to wrap your asterisks in [] instead of ():</p>\n\n<pre><code>bool match = LikeOperator.LikeString(\"*test*/fe_quet\", \"[*]test[*]/[*]\", Microsoft.VisualBasic.CompareMethod.Text);\n</code></pre>\n\n<p>You'd probably be better off using Regex instead of the VB namespace.</p>\n"}], "owner": {"reputation": 151, "user_id": 1232509, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/ed7e83e17a61fc9a1d800e11d9bbe9f4?s=128&d=identicon&r=PG", "display_name": "jithu", "link": "https://stackoverflow.com/users/1232509/jithu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 123, "favorite_count": 1, "accepted_answer_id": 48540950, "answer_count": 1, "score": 0, "last_activity_date": 1517397951, "creation_date": 1517396067, "last_edit_date": 1517397951, "question_id": 48540409, "link": "https://stackoverflow.com/questions/48540409/patterns-with-special-characters-in-microsoft-visualbasic-compilerservices-likeo", "title": "Patterns with special characters in Microsoft.VisualBasic.CompilerServices.LikeOperator.LikeString does not work", "body": "<p>I have tried to use the LikeOperator.LikeString functionality for pattern matching as shown below:</p>\n\n<pre><code>    // Usage: bool matchValue = LikeOperator.LikeString(string, pattern, CompareMethod);\n    bool match = LikeOperator.LikeString(\"*test*/fe_quet\", \"(*)test(*)/*\", Microsoft.VisualBasic.CompareMethod.Text);\n</code></pre>\n\n<p>The above should return true as per the documentation, but it simply returns false. I tried to escape the (*) with the brackets, but it does not seem to work in that way. Could anyone please help me to define the pattern string with the special characters?</p>\n\n<p>Thanks</p>\n"}, {"tags": ["vba", "excel", "shell"], "comments": [{"owner": {"reputation": 4801, "user_id": 4713729, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/PL9tu.jpg?s=128&g=1", "display_name": "vacip", "link": "https://stackoverflow.com/users/4713729/vacip"}, "edited": false, "score": 0, "creation_date": 1517396951, "post_id": 48539753, "comment_id": 84076478, "body": "Just a hunch, but what if you turn on &quot;Trust access to the VBA project object model&quot; in Options, Trust Center, Trust Center Settings, Macro Settings?"}, {"owner": {"reputation": 2784, "user_id": 7256873, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/97aae59e027906195415adc6797340f2?s=128&d=identicon&r=PG&f=1", "display_name": "AK88", "link": "https://stackoverflow.com/users/7256873/ak88"}, "reply_to_user": {"reputation": 4801, "user_id": 4713729, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/PL9tu.jpg?s=128&g=1", "display_name": "vacip", "link": "https://stackoverflow.com/users/4713729/vacip"}, "edited": false, "score": 0, "creation_date": 1517397156, "post_id": 48539753, "comment_id": 84076642, "body": "Its already enabled for all macros"}], "answers": [{"tags": [], "owner": {"reputation": 2784, "user_id": 7256873, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/97aae59e027906195415adc6797340f2?s=128&d=identicon&r=PG&f=1", "display_name": "AK88", "link": "https://stackoverflow.com/users/7256873/ak88"}, "is_accepted": true, "score": 0, "last_activity_date": 1517642949, "creation_date": 1517642949, "answer_id": 48595045, "question_id": 48539753, "link": "https://stackoverflow.com/questions/48539753/run-time-error-1004-cannot-run-the-macro-solverinsertfuction/48595045#48595045", "title": "Run-time error 1004: cannot run the macro &#39;Solver[InsertFuction]&#39;", "body": "<p>After many trials the following worked for me:</p>\n\n<p>in front of each <code>Solver</code> function (eg. <code>SolverReset</code>, <code>SolverOptions</code>, etc.) I put <code>Solver.xlam!</code> and ran the code. It didn't work but gave a warning that there was no <code>Solver.XLAM</code> in the directory. So I simply went to the folder <code>C:\\Program Files\\Microsoft Office\\Office15\\Library\\SOLVER</code> and copied both <code>Solver.XLAM</code> and <code>Solver32.DLL</code> to the directory. That was it!</p>\n\n<p>Hope someone finds this useful!</p>\n"}], "owner": {"reputation": 2784, "user_id": 7256873, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/97aae59e027906195415adc6797340f2?s=128&d=identicon&r=PG&f=1", "display_name": "AK88", "link": "https://stackoverflow.com/users/7256873/ak88"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1197, "favorite_count": 0, "accepted_answer_id": 48595045, "answer_count": 1, "score": 0, "last_activity_date": 1517642949, "creation_date": 1517394107, "last_edit_date": 1531164843, "question_id": 48539753, "link": "https://stackoverflow.com/questions/48539753/run-time-error-1004-cannot-run-the-macro-solverinsertfuction", "title": "Run-time error 1004: cannot run the macro &#39;Solver[InsertFuction]&#39;", "body": "<p>Basically, this issues arises from this topic: <a href=\"https://stackoverflow.com/questions/48535436/solveroptions-how-to-find-the-parameter-position-assumenonneg\">SolverOptions: How to find the parameter position (AssumeNonNeg)?</a></p>\n\n<p>When I open a file and import the <code>.bas</code> file and run it, everything works fine. However, when I try to apply the same procedure for all similar files using shell via VB script, I am getting the following error:</p>\n\n<blockquote>\n  <p>Run-time error 1004: cannot run the macro 'SolverReset'. The macro may\n  not be available in this workbook</p>\n</blockquote>\n\n<p>I initially tried without <code>SolverReset</code> and in that case I got an error saying </p>\n\n<blockquote>\n  <p>Run-time error 1004: cannot run the macro 'Solver' The macro may not be available in this workbook.</p>\n</blockquote>\n\n<p>It looks like as if Excel is not activating Solver add-in? What might be the problem here?</p>\n\n<p>Thank you!</p>\n"}, {"tags": ["vba", "forms", "function", "ms-access"], "comments": [{"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1517392734, "post_id": 48539205, "comment_id": 84073572, "body": "What do you mean? You don&#39;t need to change anything if you want to change a sub to a function"}, {"owner": {"reputation": 142, "user_id": 2432125, "user_type": "registered", "accept_rate": 26, "profile_image": "https://www.gravatar.com/avatar/4ecda6d70462899571eab858bc37537c?s=128&d=identicon&r=PG", "display_name": "Tom36", "link": "https://stackoverflow.com/users/2432125/tom36"}, "reply_to_user": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1517392816, "post_id": 48539205, "comment_id": 84073636, "body": "I want to reuse the function for different forms where the controls are named the same so need to be able to use s variable for the form name"}, {"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1517392938, "post_id": 48539205, "comment_id": 84073721, "body": "That doesn&#39;t explain anything..."}, {"owner": {"reputation": 142, "user_id": 2432125, "user_type": "registered", "accept_rate": 26, "profile_image": "https://www.gravatar.com/avatar/4ecda6d70462899571eab858bc37537c?s=128&d=identicon&r=PG", "display_name": "Tom36", "link": "https://stackoverflow.com/users/2432125/tom36"}, "reply_to_user": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1517393527, "post_id": 48539205, "comment_id": 84074165, "body": "The code works as a sub on the form Questions where the line in the code is: <code>code Controls(&quot;WPQ&quot; &amp; n) = ... </code>code the problem I&#39;m having is that to use it as a function where the name of the form will change I need to pass the name of the form to the function, which I do. However it doesn&#39;t actually do anything to the controls on the form. How do I get it to actually put the value from the DLookUp into the controls on the form?"}], "answers": [{"tags": [], "owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "is_accepted": true, "score": 1, "last_activity_date": 1517394050, "creation_date": 1517394050, "answer_id": 48539736, "question_id": 48539205, "link": "https://stackoverflow.com/questions/48539205/passing-form-name-to-function-and-loop-controls/48539736#48539736", "title": "Passing form name to function and loop controls", "body": "<p>Your <code>frm</code> variable is just a string, not a form. If you want to pass the name of the form, you need to get the appropriate form object before you can use it:</p>\n\n<pre><code>Function LoadQuestions(ByVal formName As String)\n    Dim frm As Form\n    Set frm = Application.Forms(formName)\n    n = 1   'n is the control number on the form (e.g. WPQ1)\n    For b = 1 To 6  'b \n    Forms!Home!CPQNo = b    \n\n    QNUM = DLookup(\"[QuestionsTbl]\", \"QuestionTotal\", \"[Count] &gt; 0\") 'Query QuestionTotal gives the total number of questions for the\n                                                                'current question set (question set = the value of variable 'b'\n    On Error Resume Next    'used to catch the instances where there is no value for the DLoopUp to return\n\n        For i = 1 To QNUM       'i is the lower level question number - 1 to Total number of questions from the query\n\n            frm.Controls(\"WPQ\" &amp; n) = DLookup(\"[questionText]\", \"QuestionsTbl\", \"[NoQuest] = \" &amp; b &amp; \" And [LowQ] = \" &amp; i &amp; \"\")\n\n            n = n + 1               'add 1 to n as this is the control number which increments by 1 for each control used\n        Next i\n    Next b\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 142, "user_id": 2432125, "user_type": "registered", "accept_rate": 26, "profile_image": "https://www.gravatar.com/avatar/4ecda6d70462899571eab858bc37537c?s=128&d=identicon&r=PG", "display_name": "Tom36", "link": "https://stackoverflow.com/users/2432125/tom36"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 33, "favorite_count": 0, "accepted_answer_id": 48539736, "answer_count": 1, "score": 0, "last_activity_date": 1517406453, "creation_date": 1517392485, "last_edit_date": 1517406453, "question_id": 48539205, "link": "https://stackoverflow.com/questions/48539205/passing-form-name-to-function-and-loop-controls", "title": "Passing form name to function and loop controls", "body": "<p>I have a form call Questions\nI have a function called LoadQuestions</p>\n\n<p>In the Questions form I have textboxes called WPQ1, WPQ2, WPQ3, WPQ4 etc....</p>\n\n<p>I call the function LoadQuestions using the line:</p>\n\n<pre><code>LoadQuestions (Me.Name)\n</code></pre>\n\n<p>My LoadQuestions function code is:</p>\n\n<pre><code>Function LoadQuestions(ByVal frm As String)\nn = 1   'n is the control number on the form (e.g. WPQ1)\nFor b = 1 To 6  'b \nForms!Home!CPQNo = b    \n\nQNUM = DLookup(\"[QuestionsTbl]\", \"QuestionTotal\", \"[Count] &gt; 0\") 'Query QuestionTotal gives the total number of questions for the\n                                                            'current question set (question set = the value of variable 'b'\nOn Error Resume Next    'used to catch the instances where there is no value for the DLoopUp to return\n\n    For i = 1 To QNUM       'i is the lower level question number - 1 to Total number of questions from the query\n\n        frm![Controls(\"WPQ\" &amp; n)] = DLookup(\"[questionText]\", \"QuestionsTbl\", \"[NoQuest] = \" &amp; b &amp; \" And [LowQ] = \" &amp; i &amp; \"\")\n\n        n = n + 1               'add 1 to n as this is the control number which increments by 1 for each control used\n    Next i\nNext b\nEnd Function\n</code></pre>\n\n<p>I am getting the error </p>\n\n<blockquote>\n  <p>Qualifier must be a collection</p>\n</blockquote>\n\n<p>and the code highlighted is the line:</p>\n\n<pre><code>![Controls(\"WPQ\" &amp; n)] =\n</code></pre>\n\n<p>My question is how do I reference the control on the form? If I run this code as a SUB in the actual form that is using it (with the code</p>\n\n<pre><code>Me.Controls(\"WPQ\" &amp; n) =\n</code></pre>\n\n<p>then it works fine. How do I get it to work in a function?</p>\n\n<p>Thanks</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 7497, "user_id": 8670372, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ir8a4Lbosmo/AAAAAAAAAAI/AAAAAAAAOtE/2eY5jK1atcc/photo.jpg?sz=128", "display_name": "Xabier", "link": "https://stackoverflow.com/users/8670372/xabier"}, "edited": false, "score": 1, "creation_date": 1517393636, "post_id": 48538889, "comment_id": 84074231, "body": "You question is quite ambiguous, Column D gets pasted correctly but what you want is for source data to be pasted after the last non empty row at once? What is the issue? Could you include an image of what is happening and your desired result?"}, {"owner": {"reputation": 19, "user_id": 9293422, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b74a38d868c152143a39a9b263049351?s=128&d=identicon&r=PG&f=1", "display_name": "VenusExcel", "link": "https://stackoverflow.com/users/9293422/venusexcel"}, "reply_to_user": {"reputation": 7497, "user_id": 8670372, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ir8a4Lbosmo/AAAAAAAAAAI/AAAAAAAAOtE/2eY5jK1atcc/photo.jpg?sz=128", "display_name": "Xabier", "link": "https://stackoverflow.com/users/8670372/xabier"}, "edited": false, "score": 0, "creation_date": 1517393789, "post_id": 48538889, "comment_id": 84074320, "body": "I have two different work books named Input.xlsb (Source data) and Lapsed Pipeline.xlsm (destination workbook). I have searched the codes here and found one which helped me partially but the issue with this code is the data of one column gets pasted below the other . Eg:Column D gets pasted correctly in last non empty cell, but data in column M gets pasted in the last row after data in column D and like wise for every columns, i want all the data from the source data to be pasted after the last non empty row at once. below is code i have reedited for my purpose."}, {"owner": {"reputation": 7497, "user_id": 8670372, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ir8a4Lbosmo/AAAAAAAAAAI/AAAAAAAAOtE/2eY5jK1atcc/photo.jpg?sz=128", "display_name": "Xabier", "link": "https://stackoverflow.com/users/8670372/xabier"}, "edited": false, "score": 0, "creation_date": 1517394028, "post_id": 48538889, "comment_id": 84074494, "body": "repeating what was already ambiguous, is not giving us a better understanding, please could you include in your question images of actual result and desired result?"}, {"owner": {"reputation": 1118, "user_id": 8282232, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/775ef4ecf830083680ae6dbae8da395c?s=128&d=identicon&r=PG&f=1", "display_name": "AntiDrondert", "link": "https://stackoverflow.com/users/8282232/antidrondert"}, "edited": false, "score": 0, "creation_date": 1517394302, "post_id": 48538889, "comment_id": 84074689, "body": "@VenusJain Just attach pictures with dummy data if it is confidential."}, {"owner": {"reputation": 19, "user_id": 9293422, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b74a38d868c152143a39a9b263049351?s=128&d=identicon&r=PG&f=1", "display_name": "VenusExcel", "link": "https://stackoverflow.com/users/9293422/venusexcel"}, "edited": false, "score": 0, "creation_date": 1517395283, "post_id": 48538889, "comment_id": 84075291, "body": "Hello Sorry if my comments and questions are not clear, am new to the site and just now uploaded the image"}], "answers": [{"comments": [{"owner": {"reputation": 1118, "user_id": 8282232, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/775ef4ecf830083680ae6dbae8da395c?s=128&d=identicon&r=PG&f=1", "display_name": "AntiDrondert", "link": "https://stackoverflow.com/users/8282232/antidrondert"}, "edited": false, "score": 0, "creation_date": 1517393908, "post_id": 48539637, "comment_id": 84074401, "body": "If OP has more than one table on a worksheet, using <code>.UsedRange</code> will be highly inaccurate, not to mention that <code>.UsedRange</code> includes blank cells with changed format or cells with their content deleted in current session."}, {"owner": {"reputation": 19, "user_id": 9293422, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b74a38d868c152143a39a9b263049351?s=128&d=identicon&r=PG&f=1", "display_name": "VenusExcel", "link": "https://stackoverflow.com/users/9293422/venusexcel"}, "edited": false, "score": 0, "creation_date": 1517395658, "post_id": 48539637, "comment_id": 84075546, "body": "Hello, Am new to VBA, it would be highly helpful if you paste the entire code"}, {"owner": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "edited": false, "score": 0, "creation_date": 1517397153, "post_id": 48539637, "comment_id": 84076637, "body": "The code I wrote just replaces your Copy block - i.e. everything from <code>x.Range(&quot;G2:G&quot; &amp; LastRow).Copy</code> to <code>y.Cells(Rows.Count, &quot;E&quot;).End(xlUp).Offset(1, 0)</code> The rest of your code is fine.  All it does is eliminate cases where you have empty cells at the bottom of a column that <code>End(xlUp)</code> will skip through"}, {"owner": {"reputation": 19, "user_id": 9293422, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b74a38d868c152143a39a9b263049351?s=128&d=identicon&r=PG&f=1", "display_name": "VenusExcel", "link": "https://stackoverflow.com/users/9293422/venusexcel"}, "edited": false, "score": 0, "creation_date": 1517401698, "post_id": 48539637, "comment_id": 84079333, "body": "Hello, I will try using this code as well and let you know if i encountered any issues"}], "tags": [], "owner": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "is_accepted": false, "score": 0, "last_activity_date": 1517396927, "last_edit_date": 1517396927, "creation_date": 1517393764, "answer_id": 48539637, "question_id": 48538889, "link": "https://stackoverflow.com/questions/48538889/copy-multiple-columns-in-different-order-from-a-source-workbook-to-a-destinati/48539637#48539637", "title": "Copy multiple columns (in different order) from a source workbook to a destination workbook and paste it below the last non empty row", "body": "<p>Instead of using <code>Rows.Count</code> and <code>End(xlUp)</code>, store the bottom row of the <code>UsedRange</code> in a variable before you start copying:</p>\n\n<pre><code>Dim PasteRow AS Long\nPasteRow = y.UsedRange.Rows(y.UsedRange.Rows.Count).Row + 1\nx.Range(\"G2:G\" &amp; LastRow).Copy y.Cells(PasteRow, 4)  'Do not change PasteRow\nx.Range(\"I2:I\" &amp; LastRow).Copy y.Cells(PasteRow, 13)  'et cetera\n</code></pre>\n\n<p><strong>{EDIT}</strong> Longer code, removes the requirement for UsedRange, still accepts that some columns may have blank cells:</p>\n\n<pre><code>'This replaces your Copy block - everything before stays as you wrote it\nDim PasteRow As Long, iCheckCol AS Integer\nPasteRow = 0\nFor iCheckCol = 1 to 10 'Check columns A - J\n    If y.Cells(y.Rows.Count, iCheckCol).End(xlUp).Row &gt; PasteRow Then\n        PasteRow = y.Cells(y.Rows.Count, iCheckCol).End(xlUp).Row 'Find lowest bottom of rows\n    End If\nNext iCheckCol\nPasteRow = PasteRow+1 'Go down from the Bottom Row\nx.Range(\"G2:G\" &amp; LastRow).Copy y.Cells(PasteRow, 4)  'Do not change PasteRow\nx.Range(\"I2:I\" &amp; LastRow).Copy y.Cells(PasteRow, 13)  'et cetera\n'Add a line for every column that you want to copy\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 7497, "user_id": 8670372, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ir8a4Lbosmo/AAAAAAAAAAI/AAAAAAAAOtE/2eY5jK1atcc/photo.jpg?sz=128", "display_name": "Xabier", "link": "https://stackoverflow.com/users/8670372/xabier"}, "is_accepted": true, "score": 0, "last_activity_date": 1517396924, "creation_date": 1517396924, "answer_id": 48540698, "question_id": 48538889, "link": "https://stackoverflow.com/questions/48538889/copy-multiple-columns-in-different-order-from-a-source-workbook-to-a-destinati/48540698#48540698", "title": "Copy multiple columns (in different order) from a source workbook to a destination workbook and paste it below the last non empty row", "body": "<p>How about the following, if I understood correctly:</p>\n\n<pre><code>Sub CopyCoverage()\n\nDim x As Worksheet, y As Worksheet, LastRow&amp;, yLastRow&amp;\n\nSet x = Workbooks(\"Input.xlsb\").Worksheets(\"Opportunity\")\nSet y = ThisWorkbook.Worksheets(\"Lapsed Opps\")\n\nLastRow = x.Cells.SpecialCells(xlCellTypeLastCell).Row\nyLastRow = y.Cells(y.Rows.Count, \"A\").End(xlUp).Row + 1\n\nx.Range(\"G2:G\" &amp; LastRow).Copy y.Cells(yLastRow, \"D\").End(xlUp)\nx.Range(\"I2:I\" &amp; LastRow).Copy y.Cells(yLastRow, \"M\").End(xlUp)\nx.Range(\"P2:P\" &amp; LastRow).Copy y.Cells(yLastRow, \"A\").End(xlUp)\nx.Range(\"Y2:Y\" &amp; LastRow).Copy y.Cells(yLastRow, \"C\").End(xlUp)\nx.Range(\"Z2:Z\" &amp; LastRow).Copy y.Cells(yLastRow, \"B\").End(xlUp)\nx.Range(\"AJ2:AJ\" &amp; LastRow).Copy y.Cells(yLastRow, \"G\").End(xlUp)\nx.Range(\"AK2:AK\" &amp; LastRow).Copy y.Cells(yLastRow, \"H\").End(xlUp)\nx.Range(\"AL2:AL\" &amp; LastRow).Copy y.Cells(yLastRow, \"I\").End(xlUp)\nx.Range(\"AM2:AM\" &amp; LastRow).Copy y.Cells(yLastRow, \"J\").End(xlUp)\nx.Range(\"EC2:EC\" &amp; LastRow).Copy y.Cells(yLastRow, \"F\").End(xlUp)\nx.Range(\"EG2:EG\" &amp; LastRow).Copy y.Cells(yLastRow, \"E\").End(xlUp)\n\nApplication.CutCopyMode = False\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 19, "user_id": 9293422, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b74a38d868c152143a39a9b263049351?s=128&d=identicon&r=PG&f=1", "display_name": "VenusExcel", "link": "https://stackoverflow.com/users/9293422/venusexcel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1069, "favorite_count": 0, "accepted_answer_id": 48540698, "answer_count": 2, "score": 0, "last_activity_date": 1517396927, "creation_date": 1517391559, "last_edit_date": 1531164843, "question_id": 48538889, "link": "https://stackoverflow.com/questions/48538889/copy-multiple-columns-in-different-order-from-a-source-workbook-to-a-destinati", "title": "Copy multiple columns (in different order) from a source workbook to a destination workbook and paste it below the last non empty row", "body": "<p>I have two different work books named <code>Input.xlsb</code> (Source data) and Lapsed Pipeline.xlsm (destination workbook). I have searched the codes here and found one which helped me partially but the issue with this code is the data of one column gets pasted below the other . Eg:Column D gets pasted correctly in last non empty cell, but data in column gets pasted in the last row after data in column and like wise for every columns, i want all the data from the source data to be pasted after the last non empty row at once. below is code i have reedited for my purpose.</p>\n\n<p>Example:</p>\n\n<p><a href=\"https://i.stack.imgur.com/11Uuq.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/11Uuq.jpg\" alt=\"enter image description here\"></a></p>\n\n<pre><code>Sub CopyCoverage()\n\nDim x As Worksheet, y As Worksheet, LastRow&amp;\n\nSet x = Workbooks(\"Input.xlsb\").Worksheets(\"Opportunity\")\nSet y = ThisWorkbook.Worksheets(\"Lapsed Opps\")\n\nLastRow = x.Cells.SpecialCells(xlCellTypeLastCell).Row\n\nx.Range(\"G2:G\" &amp; LastRow).Copy y.Cells(Rows.Count, \"D\").End(xlUp).Offset(1, 0)     \nx.Range(\"I2:I\" &amp; LastRow).Copy y.Cells(Rows.Count, \"M\").End(xlUp).Offset(1, 0)    \nx.Range(\"P2:P\" &amp; LastRow).Copy y.Cells(Rows.Count, \"A\").End(xlUp).Offset(1, 0)    \nx.Range(\"Y2:Y\" &amp; LastRow).Copy y.Cells(Rows.Count, \"C\").End(xlUp).Offset(1, 0)    \nx.Range(\"Z2:Z\" &amp; LastRow).Copy y.Cells(Rows.Count, \"B\").End(xlUp).Offset(1, 0)    \nx.Range(\"AJ2:AJ\" &amp; LastRow).Copy y.Cells(Rows.Count, \"G\").End(xlUp).Offset(1, 0)    \nx.Range(\"AK2:AK\" &amp; LastRow).Copy y.Cells(Rows.Count, \"H\").End(xlUp).Offset(1, 0)    \nx.Range(\"AL2:AL\" &amp; LastRow).Copy y.Cells(Rows.Count, \"I\").End(xlUp).Offset(1, 0)    \nx.Range(\"AM2:AM\" &amp; LastRow).Copy y.Cells(Rows.Count, \"J\").End(xlUp).Offset(1, 0)     \nx.Range(\"EC2:EC\" &amp; LastRow).Copy y.Cells(Rows.Count, \"F\").End(xlUp).Offset(1, 0)     \nx.Range(\"EG2:EG\" &amp; LastRow).Copy y.Cells(Rows.Count, \"E\").End(xlUp).Offset(1, 0)     \n\nApplication.CutCopyMode = False\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["arrays", "vba", "excel", "intersection"], "comments": [{"owner": {"reputation": 2287, "user_id": 5267751, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd62e8fd8fbb37abc7e2a39d23828047?s=128&d=identicon&r=PG&f=1", "display_name": "user202729", "link": "https://stackoverflow.com/users/5267751/user202729"}, "edited": false, "score": 0, "creation_date": 1517391354, "post_id": 48538775, "comment_id": 84072612, "body": "&quot;Just do it&quot;. What prevents you from doing it? Find an algorithm, implement it, done."}, {"owner": {"reputation": 1118, "user_id": 8282232, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/775ef4ecf830083680ae6dbae8da395c?s=128&d=identicon&r=PG&f=1", "display_name": "AntiDrondert", "link": "https://stackoverflow.com/users/8282232/antidrondert"}, "edited": false, "score": 0, "creation_date": 1517396694, "post_id": 48538775, "comment_id": 84076281, "body": "Alternatively you can duplicate column and filter 1st column by <code>a1</code> and 2nd column by <code>a2</code>. EDIT: What are arrays&#39; bounds? Are they equal to each other? How do you populate arrays? From <code>.Range.Value</code> or with <code>Split()</code> or manualy?"}], "answers": [{"tags": [], "owner": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "is_accepted": false, "score": 0, "last_activity_date": 1517392154, "creation_date": 1517392154, "answer_id": 48539080, "question_id": 48538775, "link": "https://stackoverflow.com/questions/48538775/intersection-of-two-arrays-of-strings-in-vba/48539080#48539080", "title": "Intersection of two arrays of Strings in VBA", "body": "<p>You could run nested loops - the outer loop goes through one array, and the inner loop checks if the entry exists in the other array.  You can either output to a 3rd array, or use ReDim to expand the first array and add items to the end</p>\n\n<pre><code>Dim aIntersect() As String\nDim iLoop1 As Integer, iLoop2 As Integer\nDim bTest As Boolean\nDim iOutput As Integer\n\n'Copy everything from a1 to aIntersect\niOutput = LBound(aIntersect)\nFor iLoop1 = LBound(a1) To UBound(a1)\n    aIntersect(iOutput) = a1(iLoop1)\n    iOutput = iOutput + 1\nNext iLoop1\n'Add the missing items from a2\nFor iLoop2 = LBound(a2) To UBound(a2)\n    bTest = True ' Reset test\n    For iLoop1 = LBound(a1) To UBound(a1)\n        If a1(iLoop1) = a2(iLoop2) Then\n            bTest = False 'Already exists\n            Exit For 'No need to test further\n        End If\n    Next iLoop1\n    If bTest Then 'If it did not exists, insert it\n        aIntersect(iOutput) = a2(iLoop1)\n        iOutput = iOutput + 1\n    End If\nNext iLoop1\n'aIntersect now contains everything from a1, and anything from a2 that was not already in a1\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1118, "user_id": 8282232, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/775ef4ecf830083680ae6dbae8da395c?s=128&d=identicon&r=PG&f=1", "display_name": "AntiDrondert", "link": "https://stackoverflow.com/users/8282232/antidrondert"}, "is_accepted": false, "score": 2, "last_activity_date": 1517405088, "last_edit_date": 1592644375, "creation_date": 1517402462, "answer_id": 48542477, "question_id": 48538775, "link": "https://stackoverflow.com/questions/48538775/intersection-of-two-arrays-of-strings-in-vba/48542477#48542477", "title": "Intersection of two arrays of Strings in VBA", "body": "<h3>Using dictionary:</h3>\n<pre><code>Dim strDict As Object, i As Integer\nDim a1() As String, a2() As String\nDim strFilter As String\n' ...\n'Creating a dictionary\nSet strDict = CreateObject(&quot;Scripting.Dictionary&quot;)\n'I assumed both of the arrays start either from 1 or 0\n'Populate dictionary with elements of one of the arrays\n'Then check if elements from another array exist in dictionary\n'And add them to a string\nFor i = Lbound(a2) To Ubound(a2)\n    strDict(a2(i)) = a2(i)\nNext\nFor i = Lbound(a1) To Ubound(a1)\n    If strDict.Exists(a1(i)) Then strFilter = a1(i) &amp; &quot;,&quot; &amp; strFilter\nNext\n'...\n.Autofilter Field:=1, _\n            Criterial:=Split(Left(strFilter, Len(strFilter) - 1), &quot;,&quot;), _\n            Operator:=xlFilterValues\n</code></pre>\n<p>Using dictionary save us from using nested loops, number of iterations will be <code>Ubound(a1)</code>+<code>Ubound(a2)</code> instead of <code>Ubound(a1)</code>*<code>Ubound(a2)</code>, which is great, unless arrays are relatively small (&lt;=2).</p>\n"}], "owner": {"reputation": 101, "user_id": 6891099, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/4289d87f8643fc6f6a74d352053639da?s=128&d=identicon&r=PG&f=1", "display_name": "yeehui", "link": "https://stackoverflow.com/users/6891099/yeehui"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2315, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1517405088, "creation_date": 1517391232, "question_id": 48538775, "link": "https://stackoverflow.com/questions/48538775/intersection-of-two-arrays-of-strings-in-vba", "title": "Intersection of two arrays of Strings in VBA", "body": "<p>This question might be a bit similar to this question but it is not.\n<a href=\"https://stackoverflow.com/questions/23683939/intersection-of-two-arrays-of-ranges\">Intersection of two arrays of ranges</a></p>\n\n<p>Okay, I am currently working on a project with VBA and I need to filter a table.\nThere are two filters looks like this (a1 and a2 contain strings for filter):</p>\n\n<pre><code>Dim a1() As String\nDim a2() As String\n\n.Autofilter Field:=1, Criterial:=Array(a1)\n.Autofilter Field:=1, Criterial:=Array(a2)\n</code></pre>\n\n<p>So as you notice, the 2nd line of autofilter just overwrites, in a way, the previous filter and this is not the way I would like the filter to behave. I would like to have an array to have mutual elements of a1 and a2 so that I can filter with the mutual elements of two arrays.</p>\n\n<p>How would you intersect two arrays that contain couple of strings? I prefer not to use cells for this purpose just to reduce the worksheets on my workbook.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 11818, "user_id": 235442, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/6Jdvc.jpg?s=128&g=1", "display_name": "Alex P", "link": "https://stackoverflow.com/users/235442/alex-p"}, "edited": false, "score": 1, "creation_date": 1517391093, "post_id": 48538598, "comment_id": 84072452, "body": "If it is just those three columns and the value is always the first entry then you could use <code>Left(range, 1)</code> to extract the value and sum up. If there are multiple columns and the scores are more than 0 to 9 then VBA could be more appropriate"}, {"owner": {"reputation": 187, "user_id": 2429481, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XcSLs.jpg?s=128&g=1", "display_name": "peedurrr", "link": "https://stackoverflow.com/users/2429481/peedurrr"}, "reply_to_user": {"reputation": 11818, "user_id": 235442, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/6Jdvc.jpg?s=128&g=1", "display_name": "Alex P", "link": "https://stackoverflow.com/users/235442/alex-p"}, "edited": false, "score": 0, "creation_date": 1517393132, "post_id": 48538598, "comment_id": 84073865, "body": "Yes, just those columns and the scores go 0 to 5."}], "answers": [{"comments": [{"owner": {"reputation": 187, "user_id": 2429481, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XcSLs.jpg?s=128&g=1", "display_name": "peedurrr", "link": "https://stackoverflow.com/users/2429481/peedurrr"}, "edited": false, "score": 0, "creation_date": 1517394320, "post_id": 48538902, "comment_id": 84074705, "body": "Many thanks. Similar to Michal&#39;s - saves having the spreadsheet as an xlsm."}], "tags": [], "owner": {"reputation": 11818, "user_id": 235442, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/6Jdvc.jpg?s=128&g=1", "display_name": "Alex P", "link": "https://stackoverflow.com/users/235442/alex-p"}, "is_accepted": false, "score": 1, "last_activity_date": 1517391610, "creation_date": 1517391610, "answer_id": 48538902, "question_id": 48538598, "link": "https://stackoverflow.com/questions/48538598/in-excel-vba-extract-range-text-and-sum-data/48538902#48538902", "title": "In Excel VBA, extract range text and sum data", "body": "<p>Try:</p>\n\n<pre><code>N2 = LEFT(TRIM(K2),1) + LEFT(TRIM(L2),1) + LEFT(TRIM(M2),1)\n</code></pre>\n\n<p>As I said in comments, this solution does not scale so well if it is more than three columns and / or the scores are more than single digit <code>[0-9]</code></p>\n"}, {"comments": [{"owner": {"reputation": 187, "user_id": 2429481, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XcSLs.jpg?s=128&g=1", "display_name": "peedurrr", "link": "https://stackoverflow.com/users/2429481/peedurrr"}, "edited": false, "score": 0, "creation_date": 1517394261, "post_id": 48539107, "comment_id": 84074658, "body": "That&#39;s great - saves me having to macro enable the spreadsheet too."}], "tags": [], "owner": {"reputation": 28228, "user_id": 7132550, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/1063981417044495/picture?type=large", "display_name": "Micha\u0142 Turczyn", "link": "https://stackoverflow.com/users/7132550/micha%c5%82-turczyn"}, "is_accepted": true, "score": 2, "last_activity_date": 1517392226, "creation_date": 1517392226, "answer_id": 48539107, "question_id": 48538598, "link": "https://stackoverflow.com/questions/48538598/in-excel-vba-extract-range-text-and-sum-data/48539107#48539107", "title": "In Excel VBA, extract range text and sum data", "body": "<p>Put this formula in <code>N2</code> cell and drag it all the way down.</p>\n\n<pre><code>=LEFT(K2, FIND(\"-\", K2)  - 2) + LEFT(L2, FIND(\"-\", L2)  - 2) + LEFT(M2, FIND(\"-\", M2)  - 2)\n</code></pre>\n\n<p>For more information see <a href=\"https://exceljet.net/formula/split-text-string-at-specific-character\" rel=\"nofollow noreferrer\">reference</a>. It sum all numbers, that are present before the hyphen (<code>-</code>) in a cell.</p>\n"}, {"tags": [], "owner": {"reputation": 7497, "user_id": 8670372, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ir8a4Lbosmo/AAAAAAAAAAI/AAAAAAAAOtE/2eY5jK1atcc/photo.jpg?sz=128", "display_name": "Xabier", "link": "https://stackoverflow.com/users/8670372/xabier"}, "is_accepted": false, "score": 1, "last_activity_date": 1517392725, "creation_date": 1517392725, "answer_id": 48539295, "question_id": 48538598, "link": "https://stackoverflow.com/questions/48538598/in-excel-vba-extract-range-text-and-sum-data/48539295#48539295", "title": "In Excel VBA, extract range text and sum data", "body": "<p>A VBA solution to do all of your rows and enter the values into Column N:</p>\n\n<pre><code>Sub foo()\nDim ws As Worksheet: Set ws = Sheets(\"Sheet1\")\n'declare and set your worksheet, amend as required\nLastRow = ws.Cells(ws.Rows.Count, \"K\").End(xlUp).Row\n'get the last row with data on Column A\nFor rownumber = 1 To LastRow 'loop through rows\n    For i = 11 To 13 'loop through columns\n    strValue = ws.Cells(rownumber, i).Value 'get text string from cell\n    pos = InStr(strValue, \" -\") 'find the dash - in cell\n        If pos &gt; 0 Then 'if dash found\n            Value = Value + Val(Left(ws.Cells(rownumber, i).Value, pos - 1)) 'remove everything after number\n        End If\n    Next i\n    ws.Cells(rownumber, 14).Value = Value 'write value to column N\n    Value = 0\nNext rownumber\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 187, "user_id": 2429481, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XcSLs.jpg?s=128&g=1", "display_name": "peedurrr", "link": "https://stackoverflow.com/users/2429481/peedurrr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 833, "favorite_count": 0, "accepted_answer_id": 48539107, "answer_count": 3, "score": -1, "last_activity_date": 1517392725, "creation_date": 1517390657, "last_edit_date": 1531161705, "question_id": 48538598, "link": "https://stackoverflow.com/questions/48538598/in-excel-vba-extract-range-text-and-sum-data", "title": "In Excel VBA, extract range text and sum data", "body": "<p>I have a spreadsheet in which there are multiple rows that have three columns (K, L M) that contain text (inserted manually from a dropdown). The inserted text includes a 'score'. For the row shown in the image that score is 3 + 2 + 2 = 7.</p>\n\n<p>What I'd like to be able to do is to have that score automatically calculated and shown in column N.  I'm happy to do the score extraction given the text, but I'm completey unfamiliar with Excel's object model, and how to write a VBA macro that can be triggered across all of the rows.  I assume it would be passed a range somehow, or a string designating a range, but how to do that is beyond me just now. Perhaps I just need a formula? But one that calls a function to strip non-numerical data from the cell?</p>\n\n<p>Any help appreciated.</p>\n\n<p><a href=\"https://i.stack.imgur.com/aYtKR.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/aYtKR.jpg\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["vba", "excel", "ms-word"], "comments": [{"owner": {"reputation": 161252, "user_id": 40347, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ab9833194869e7f99d6e388f4aee76c1?s=128&d=identicon&r=PG", "display_name": "Dirk Vollmar", "link": "https://stackoverflow.com/users/40347/dirk-vollmar"}, "edited": false, "score": 0, "creation_date": 1517391494, "post_id": 48538590, "comment_id": 84072704, "body": "Including headers/footers needs some more specification: How would you like the page-based headers/footers to appear in Excel? What if your Word document contains sections (i.e. multiple different headers/footers). What to do if you have different first page or odd/even headers/footers in your document? At the moment you question is too broad to be answered."}, {"owner": {"reputation": 31, "user_id": 5557976, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/U4sAc.jpg?s=128&g=1", "display_name": "Edge", "link": "https://stackoverflow.com/users/5557976/edge"}, "reply_to_user": {"reputation": 161252, "user_id": 40347, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ab9833194869e7f99d6e388f4aee76c1?s=128&d=identicon&r=PG", "display_name": "Dirk Vollmar", "link": "https://stackoverflow.com/users/40347/dirk-vollmar"}, "edited": false, "score": 1, "creation_date": 1517392527, "post_id": 48538590, "comment_id": 84073413, "body": "The header/footer in Word is just plain text might as well be copied like that. If the PDF file is opened in Word, it creates sections (eg. Header -Section 9-). What I want is to copy as is what it&#39;s like in Word to Excel."}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 1, "creation_date": 1517410563, "post_id": 48538590, "comment_id": 84085585, "body": "Your request is still not making any sense. If you mean to entirely recreate the Word document in Excel (whatever for?), as it appears on-screen or when printed, then you need to loop every section, determine which headers/footers are defined for the section, figure out where each page breaks so that you can associate the correct header/footer (first page, odd page) and essentially transfer the information bit-by-bit. Assuming that&#39;s what you want, this is enough to get you started, but people get paid for working things like this out and writing the amount of code involved - it&#39;s not trivial!"}, {"owner": {"reputation": 31, "user_id": 5557976, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/U4sAc.jpg?s=128&g=1", "display_name": "Edge", "link": "https://stackoverflow.com/users/5557976/edge"}, "edited": false, "score": 0, "creation_date": 1517429153, "post_id": 48538590, "comment_id": 84097128, "body": "Yes, that is what I want, re-create what is seen in the Word document to Excel. I was just hoping someone to help me out even a little bit because this is my current impediment and I just started learning Excel VBA."}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1517494525, "post_id": 48538590, "comment_id": 84125450, "body": "Well, I wrote the steps required - you have to do some research, yourself, now, as to the Word object model required. What you want goes well beyond the scope of the StackOverflow Q&amp;A format - the question is &quot;too broad&quot;. There&#39;s certainly no way to copy/paste in one single step, or even a single step / page."}], "owner": {"reputation": 31, "user_id": 5557976, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/U4sAc.jpg?s=128&g=1", "display_name": "Edge", "link": "https://stackoverflow.com/users/5557976/edge"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1539, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1517467146, "creation_date": 1517390628, "last_edit_date": 1517467146, "question_id": 48538590, "link": "https://stackoverflow.com/questions/48538590/copy-header-from-ms-word-to-excel", "title": "Copy header from MS Word to Excel", "body": "<p>I have an Excel VBA code that copies the content of the MS word file:</p>\n\n<pre><code>'Open PDF file in MS Word\nSet wordApp = CreateObject(\"Word.Application\")\nSet wordDoc = wordApp.Documents.Open(PDFfilepath, ConfirmConversions:=False, ReadOnly:=False)\nWith wordDoc\n         Worksheets.Add(After:=Worksheets(Worksheets.Count)).Name = convertSheetName\n        .Range(.Content.Start, .Content.End).Copy\nEnd With\n\nwordApp.Quit\nconvertedFile_Wb.Activate\nSheets(convertSheetName).Select\nActiveSheet.Paste\nRange(\"A1\").Select\nSheets(convertSheetName).Cells.EntireColumn.AutoFit\nSheets(convertSheetName).Cells.EntireRow.AutoFit\n</code></pre>\n\n<p>How to copy all data including headers and footers even if they are blank or not and paste all of it to Excel?</p>\n\n<p>I don't know if this have something to do with sections in Word.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 145, "user_id": 8938363, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc77aca8ca2e6eabaaff2e84e8fa3dcb?s=128&d=identicon&r=PG&f=1", "display_name": "dadler", "link": "https://stackoverflow.com/users/8938363/dadler"}, "edited": false, "score": 0, "creation_date": 1517390663, "post_id": 48538522, "comment_id": 84072172, "body": "Are you alt-tabbing during execution / switching to another Excel sheet or workbook? ActiveCell can be a little volatile since it depends on the ActiveSheet and Workbook."}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 7844030, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e843c627fcb2f2f51499672435aed0a3?s=128&d=identicon&r=PG&f=1", "display_name": "EBarton", "link": "https://stackoverflow.com/users/7844030/ebarton"}, "edited": false, "score": 0, "creation_date": 1517392535, "post_id": 48538604, "comment_id": 84073420, "body": "Thanks, so using this code, and adding the sheet reference before got it working. &#39;Sheets(&quot;Agency Search&quot;).Range(&quot;L5&quot;).Value = ActiveCell.Value&#39;"}, {"owner": {"reputation": 13, "user_id": 7844030, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e843c627fcb2f2f51499672435aed0a3?s=128&d=identicon&r=PG&f=1", "display_name": "EBarton", "link": "https://stackoverflow.com/users/7844030/ebarton"}, "edited": false, "score": 0, "creation_date": 1517394890, "post_id": 48538604, "comment_id": 84075055, "body": "Ah, replied too fast I am afraid. Seems when running this macro it does the same. This works stepping through, but not when the macro is run. Same as before."}, {"owner": {"reputation": 7497, "user_id": 8670372, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ir8a4Lbosmo/AAAAAAAAAAI/AAAAAAAAOtE/2eY5jK1atcc/photo.jpg?sz=128", "display_name": "Xabier", "link": "https://stackoverflow.com/users/8670372/xabier"}, "reply_to_user": {"reputation": 13, "user_id": 7844030, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e843c627fcb2f2f51499672435aed0a3?s=128&d=identicon&r=PG&f=1", "display_name": "EBarton", "link": "https://stackoverflow.com/users/7844030/ebarton"}, "edited": false, "score": 0, "creation_date": 1517396036, "post_id": 48538604, "comment_id": 84075801, "body": "@EBarton, then the issue might be with the Sub you are calling,.. Could you share your code, so that we can investigate the issue?"}, {"owner": {"reputation": 13, "user_id": 7844030, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e843c627fcb2f2f51499672435aed0a3?s=128&d=identicon&r=PG&f=1", "display_name": "EBarton", "link": "https://stackoverflow.com/users/7844030/ebarton"}, "edited": false, "score": 0, "creation_date": 1517396819, "post_id": 48538604, "comment_id": 84076383, "body": "I have added the called macro in the original post."}, {"owner": {"reputation": 7497, "user_id": 8670372, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ir8a4Lbosmo/AAAAAAAAAAI/AAAAAAAAOtE/2eY5jK1atcc/photo.jpg?sz=128", "display_name": "Xabier", "link": "https://stackoverflow.com/users/8670372/xabier"}, "reply_to_user": {"reputation": 13, "user_id": 7844030, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e843c627fcb2f2f51499672435aed0a3?s=128&d=identicon&r=PG&f=1", "display_name": "EBarton", "link": "https://stackoverflow.com/users/7844030/ebarton"}, "edited": false, "score": 0, "creation_date": 1517397547, "post_id": 48538604, "comment_id": 84076880, "body": "@EBarton You should really consider re-writing your code to omit any select or activate methods, as these will not only slow your code down, but as you haven&#39;t qualified your ranges, it might be picking up the wrong data when you run your code."}, {"owner": {"reputation": 13, "user_id": 7844030, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e843c627fcb2f2f51499672435aed0a3?s=128&d=identicon&r=PG&f=1", "display_name": "EBarton", "link": "https://stackoverflow.com/users/7844030/ebarton"}, "edited": false, "score": 0, "creation_date": 1517397763, "post_id": 48538604, "comment_id": 84077020, "body": "Yeah, I am very new to vba so this is all a learning curve to me. Thanks for your input, I will give it a go"}, {"owner": {"reputation": 7497, "user_id": 8670372, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ir8a4Lbosmo/AAAAAAAAAAI/AAAAAAAAOtE/2eY5jK1atcc/photo.jpg?sz=128", "display_name": "Xabier", "link": "https://stackoverflow.com/users/8670372/xabier"}, "reply_to_user": {"reputation": 13, "user_id": 7844030, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e843c627fcb2f2f51499672435aed0a3?s=128&d=identicon&r=PG&f=1", "display_name": "EBarton", "link": "https://stackoverflow.com/users/7844030/ebarton"}, "edited": false, "score": 0, "creation_date": 1517398401, "post_id": 48538604, "comment_id": 84077401, "body": "@EBarton I&#39;ve updated my answer to include a small sample of how you could re-write without using the Select, hope this points you in the right direction."}, {"owner": {"reputation": 13, "user_id": 7844030, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e843c627fcb2f2f51499672435aed0a3?s=128&d=identicon&r=PG&f=1", "display_name": "EBarton", "link": "https://stackoverflow.com/users/7844030/ebarton"}, "edited": false, "score": 0, "creation_date": 1517405034, "post_id": 48538604, "comment_id": 84081478, "body": "Wow, thanks @Xabier. Looks a lot tidier than mine, and I&#39;d presume proper practice too!"}], "tags": [], "owner": {"reputation": 7497, "user_id": 8670372, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ir8a4Lbosmo/AAAAAAAAAAI/AAAAAAAAOtE/2eY5jK1atcc/photo.jpg?sz=128", "display_name": "Xabier", "link": "https://stackoverflow.com/users/8670372/xabier"}, "is_accepted": true, "score": 4, "last_activity_date": 1517398361, "last_edit_date": 1517398361, "creation_date": 1517390676, "answer_id": 48538604, "question_id": 48538522, "link": "https://stackoverflow.com/questions/48538522/macro-works-when-stepping-through-but-when-running-it-seems-to-skip-steps/48538604#48538604", "title": "Macro works when stepping through, but when running, it seems to skip steps", "body": "<p>It's a advisable not to use Select and Activate methods where possible, pass the value from selected cell to your desired cell like so:</p>\n\n<pre><code>Range(\"L5\").Value = ActiveCell.Value\n'Call macro to run the agency details search\nCall AgencyDetails\n</code></pre>\n\n<p>As Vityata mentioned, it is better to fully qualify your ranges such as:</p>\n\n<p><code>Sheet1.Range(\"L5\").Value</code> or even <code>Sheets(\"Sheet1\").Range(\"L5\").Value</code>, this way your code will not assume ActiveSheet and will take values from the defined ranges.</p>\n\n<p><strong>UPDATE</strong></p>\n\n<pre><code>Sub AgencyDetails()\n\n    Dim BlankCheckAgency As Range\n    Set BlankCheckAgency = Sheets(\"Agency Search Data\").Range(\"AgencyDetails[[#Headers],[Agency ID]]\")\n    Dim BlankCheckWorkers As Range\n    Set BlankCheckWorkers = Range(\"AgencyWorkers[[#Headers],[auto_number]]\")\n'\n\n    Application.ScreenUpdating = False\n    ActiveWorkbook.Sheets(\"Agency Search Data\").Visible = xlSheetVisible\n\n    'Clear Data\n    ActiveSheet.Range(\"G9,L9,G12,I12,G15,I15,G18,L18,Q9,Q12,Q15\").ClearContents\n    LastRow = ActiveSheet.Cells(ActiveSheet.Rows.Count, \"G\").End(xlUp).Row\n    Range(\"G28:G\" &amp; LastRow).ClearContents\n    Range(\"I28:I\" &amp; LastRow).ClearContents\n    Range(\"K28:K\" &amp; LastRow).ClearContents\n\n    'Range(\"L5\").Select\n\n    'Refresh Data\n    ActiveWorkbook.Connections(\"AgencyDetails\").Refresh\n    ActiveWorkbook.Connections(\"AgencyBDM\").Refresh\n    ActiveWorkbook.Connections(\"AgencyAM\").Refresh\n    ActiveWorkbook.Connections(\"AgencySalesRep\").Refresh\n    ActiveWorkbook.Connections(\"AgencyWorkers\").Refresh\n\n    'DataCheck for agency details\n    If IsEmpty(BlankCheckAgency.Offset(1)) = False Then\n        GoTo Data\n    Else\n        GoTo NoData\n    End If\n\nNoData:\n    'Go back to search window and display message\n    Sheets(\"Agency Search\").Select\n    ActiveWorkbook.Sheets(\"Agency Search Data\").Visible = xlSheetVeryHidden\n    Application.ScreenUpdating = True\n    MsgBox \"No agency on record matched the ID you have searched for.\" &amp; vbNewLine &amp; vbNewLine &amp; \"If you think this is wrong, please contact OSD\"\n    GoTo Finish\n\nData:\n    'Agency Name\n    Range(\"AgencyDetails[Agency Name]\").Copy\n    Sheets(\"Agency Search\").Range(\"G9\").PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n        :=False, Transpose:=False\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 3, "last_activity_date": 1517395891, "last_edit_date": 1517395891, "creation_date": 1517390680, "answer_id": 48538606, "question_id": 48538522, "link": "https://stackoverflow.com/questions/48538522/macro-works-when-stepping-through-but-when-running-it-seems-to-skip-steps/48538606#48538606", "title": "Macro works when stepping through, but when running, it seems to skip steps", "body": "<p>The problem with the both codes is that you are not referring to the correct worksheet, but you are assuming the activesheet.</p>\n\n<p>Make sure that you refer it and avoid working with <code>ActiveCell</code>:</p>\n\n<pre><code>Sub TestMe()\n\n    With Worksheets(\"SomeDetails\")\n        .Range(\"A1\").Copy\n        .Range(\"L5\").PasteSpecial Paste:=xlPasteValues\n        Application.CutCopyMode = False\n    End With\n\n    Call AgencyDetails\n\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">How to avoid using Select in Excel VBA</a></p>\n\n<p>Whenever you are copying and pasting in Excel, it is a good practice to use <code>Application.CutCopyMode = False</code>. </p>\n\n<p>It makes sure that the pasted range gets unselected, it is the same as pressing <kbd>Esc</kbd>.</p>\n"}, {"tags": [], "owner": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "is_accepted": false, "score": 1, "last_activity_date": 1517392970, "creation_date": 1517392970, "answer_id": 48539380, "question_id": 48538522, "link": "https://stackoverflow.com/questions/48538522/macro-works-when-stepping-through-but-when-running-it-seems-to-skip-steps/48539380#48539380", "title": "Macro works when stepping through, but when running, it seems to skip steps", "body": "<p>One consideration might be the <code>Application.Calculation</code> mode - if this is <code>xlCalculationManual</code> or <code>xlCalculationSemiautomatic</code> then Excel may not register that $L$5 has been updated when it calls the macro.</p>\n\n<p>You can force recalculation on everything (with <code>Application.Calculate</code>), just the ActiveSheet (<code>ActiveSheet.Calculate</code>) or the specific range (<code>Range(\"L5\").Calculate</code> or <code>Cells(5,12).Calculate</code>)</p>\n\n<p>In big/complicated Macros, setting the Calculation Mode to manual and explicitly deciding when to calculate can save a lot of time, in the same way that setting <code>Application.ScreenUpdating = False</code> to does.  Just remember to reset them both afterwards!  (<em>Very</em> long-running macros probably also need <code>DoEvents</code> somewhere to let Windows know that Excel has not crashed!)</p>\n"}], "owner": {"reputation": 13, "user_id": 7844030, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e843c627fcb2f2f51499672435aed0a3?s=128&d=identicon&r=PG&f=1", "display_name": "EBarton", "link": "https://stackoverflow.com/users/7844030/ebarton"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3968, "favorite_count": 0, "accepted_answer_id": 48538604, "answer_count": 3, "score": 1, "last_activity_date": 1517400245, "creation_date": 1517390402, "last_edit_date": 1517400245, "question_id": 48538522, "link": "https://stackoverflow.com/questions/48538522/macro-works-when-stepping-through-but-when-running-it-seems-to-skip-steps", "title": "Macro works when stepping through, but when running, it seems to skip steps", "body": "<p>I am using the below macro:</p>\n\n<pre><code>'Copy active agency ID and paste into search on Worker Details\n    ActiveCell.Select\n    Selection.Copy\n    Range(\"L5\").Select\n     Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n        :=False, Transpose:=False\n\n    'Call macro to run the agency details search\n    Call AgencyDetails\n</code></pre>\n\n<p>Basically, it uses the active cell, pastes it in the search field, and runs a macro that pulls data based on that criteria.</p>\n\n<p>When stepping through, it copies and pastes the active cell and then the search works fine.</p>\n\n<p>When running the macro, it seems to not copy and paste the active cell to the search field. Or that the called macro runs too early...</p>\n\n<p>I have tried adding pauses and <code>doevents</code> etc, but I assumed <code>doevents</code> was for odbc connections.</p>\n\n<p>To further complicate things. I have another macro that is almost identical, where it copies text into a search field and then returns data based on that criteria:</p>\n\n<pre><code>'Copy active worker ID and paste into search on Worker Details\n    ActiveCell.Select\n    Selection.Copy\n    Sheets(\"Worker Details\").Select\n    Range(\"E5\").Select\n     Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n        :=False, Transpose:=False\n\n    'Call macro to run the worker details search\n    Call WorkerDetails\n</code></pre>\n\n<p>And this works fine.</p>\n\n<p>Any ideas? Probably incredibly simple, as my vba is not brilliant. </p>\n\n<p>Thanks,</p>\n\n<pre><code>Sub AgencyDetails()\n\n    Dim BlankCheckAgency As Range\n    Set BlankCheckAgency = Range(\"AgencyDetails[[#Headers],[Agency ID]]\")\n    Dim BlankCheckWorkers As Range\n    Set BlankCheckWorkers = Range(\"AgencyWorkers[[#Headers],[auto_number]]\")\n\n\n    Application.ScreenUpdating = False\n    ActiveWorkbook.Sheets(\"Agency Search Data\").Visible = xlSheetVisible\n\n    'Clear Data\n    Range(\"G9,L9,G12,I12,G15,I15,G18,L18,Q9,Q12,Q15\").Select\n    Selection.ClearContents\n    Range(\"G28\").Select\n    Range(Selection, Selection.End(xlDown)).Select\n    Selection.ClearContents\n    Range(\"I28\").Select\n    Range(Selection, Selection.End(xlDown)).Select\n    Selection.ClearContents\n    Range(\"K28\").Select\n    Range(Selection, Selection.End(xlDown)).Select\n    Selection.ClearContents\n    Range(\"L5\").Select\n\n    'Refresh Data\n    ActiveWorkbook.Connections(\"AgencyDetails\").Refresh\n    ActiveWorkbook.Connections(\"AgencyBDM\").Refresh\n    ActiveWorkbook.Connections(\"AgencyAM\").Refresh\n    ActiveWorkbook.Connections(\"AgencySalesRep\").Refresh\n    ActiveWorkbook.Connections(\"AgencyWorkers\").Refresh\n\n    'DataCheck for agency details\n    Sheets(\"Agency Search Data\").Select\n    BlankCheckAgency.Select\n    ActiveCell.Offset(1).Select\n    If IsEmpty(ActiveCell) = False Then\n    GoTo Data\n    Else\n    GoTo NoData\n    End If\n\nNoData:\n    'Go back to search window and display message\n    Sheets(\"Agency Search\").Select\n    ActiveWorkbook.Sheets(\"Agency Search Data\").Visible = xlSheetVeryHidden\n    Application.ScreenUpdating = True\n    msgBox \"No agency on record matched the ID you have searched for.\" &amp; vbNewLine &amp; vbNewLine &amp; \"If you think this is wrong, please contact OSD\"\n    GoTo Finish\n\nData:\n    'Agency Name\n    Range(\"AgencyDetails[Agency Name]\").Select\n    Selection.Copy\n    Sheets(\"Agency Search\").Select\n    Range(\"G9\").Select\n    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n        :=False, Transpose:=False\n\n    'Unmerge Address\n    Range(\"L9\").Select\n    With Selection\n        .HorizontalAlignment = xlGeneral\n        .VerticalAlignment = xlBottom\n        .WrapText = True\n        .Orientation = 0\n        .AddIndent = False\n        .IndentLevel = 0\n        .ShrinkToFit = False\n        .ReadingOrder = xlContext\n        .MergeCells = True\n    End With\n    Selection.UnMerge\n\n    'Full Address\n    Sheets(\"Agency Search Data\").Select\n    Range(\"AgencyDetails[Full Address]\").Select\n    Selection.Copy\n    Sheets(\"Agency Search\").Select\n    Range(\"L9\").Select\n    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n        :=False, Transpose:=False\n\n    'Merge Address\n    Range(\"L9:O15\").Select\n    With Selection\n        .HorizontalAlignment = xlLeft\n        .VerticalAlignment = xlTop\n        .WrapText = True\n        .Orientation = 0\n        .AddIndent = False\n        .IndentLevel = 0\n        .ShrinkToFit = False\n        .ReadingOrder = xlContext\n        .MergeCells = False\n    End With\n    Selection.Merge\n\n    'Agency Status\n    Sheets(\"Agency Search Data\").Select\n    Range(\"AgencyDetails[Agency Status 2]\").Select\n    Selection.Copy\n    Sheets(\"Agency Search\").Select\n    Range(\"G15\").Select\n    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n        :=False, Transpose:=False\n\n    'Agency Brand\n    Sheets(\"Agency Search Data\").Select\n    Range(\"AgencyDetails[Brand]\").Select\n    Selection.Copy\n    Sheets(\"Agency Search\").Select\n    Range(\"I15\").Select\n    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n        :=False, Transpose:=False\n\n    'Agency Reg\n    Sheets(\"Agency Search Data\").Select\n    Range(\"AgencyDetails[Agency Reg]\").Select\n    Selection.Copy\n    Sheets(\"Agency Search\").Select\n    Range(\"G12\").Select\n    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n        :=False, Transpose:=False\n\n    'VAT Reg\n    Sheets(\"Agency Search Data\").Select\n    Range(\"AgencyDetails[Vat Reg]\").Select\n    Selection.Copy\n    Sheets(\"Agency Search\").Select\n    Range(\"I12\").Select\n    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n        :=False, Transpose:=False\n\n    'Unmerge GNotes\n    Range(\"G18\").Select\n    With Selection\n        .HorizontalAlignment = xlGeneral\n        .VerticalAlignment = xlBottom\n        .WrapText = True\n        .Orientation = 0\n        .AddIndent = False\n        .IndentLevel = 0\n        .ShrinkToFit = False\n        .ReadingOrder = xlContext\n        .MergeCells = True\n    End With\n    Selection.UnMerge\n\n    'General Notes\n    Sheets(\"Agency Search Data\").Select\n    Range(\"AgencyDetails[General Notes]\").Select\n    Selection.Copy\n    Sheets(\"Agency Search\").Select\n    Range(\"G18\").Select\n    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n        :=False, Transpose:=False\n\n    'Merge GNotes\n    Range(\"G18:J24\").Select\n    With Selection\n        .HorizontalAlignment = xlLeft\n        .VerticalAlignment = xlTop\n        .WrapText = True\n        .Orientation = 0\n        .AddIndent = False\n        .IndentLevel = 0\n        .ShrinkToFit = False\n        .ReadingOrder = xlContext\n        .MergeCells = False\n    End With\n    Selection.Merge\n\n    'Unmerge SNotes\n    Range(\"L18\").Select\n    With Selection\n        .HorizontalAlignment = xlGeneral\n        .VerticalAlignment = xlBottom\n        .WrapText = True\n        .Orientation = 0\n        .AddIndent = False\n        .IndentLevel = 0\n        .ShrinkToFit = False\n        .ReadingOrder = xlContext\n        .MergeCells = True\n    End With\n    Selection.UnMerge\n\n    'Sales Notes\n    Sheets(\"Agency Search Data\").Select\n    Range(\"AgencyDetails[Sales Notes]\").Select\n    Selection.Copy\n    Sheets(\"Agency Search\").Select\n    Range(\"L18\").Select\n    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n        :=False, Transpose:=False\n\n     'Merge SNotes\n    Range(\"L18:O24\").Select\n    With Selection\n        .HorizontalAlignment = xlLeft\n        .VerticalAlignment = xlTop\n        .WrapText = True\n        .Orientation = 0\n        .AddIndent = False\n        .IndentLevel = 0\n        .ShrinkToFit = False\n        .ReadingOrder = xlContext\n        .MergeCells = False\n    End With\n    Selection.Merge\n\n    'BDM\n    Sheets(\"Agency Search Data\").Select\n    Range(\"AgencyBDM[Full Name]\").Select\n    Selection.Copy\n    Sheets(\"Agency Search\").Select\n    Range(\"Q9\").Select\n    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n        :=False, Transpose:=False\n\n    'Sales Rep\n    Sheets(\"Agency Search Data\").Select\n    Range(\"AgencySalesRep[Full Name]\").Select\n    Selection.Copy\n    Sheets(\"Agency Search\").Select\n    Range(\"Q12\").Select\n    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n        :=False, Transpose:=False\n\n    'AM\n    Sheets(\"Agency Search Data\").Select\n    Range(\"AgencyAM[Full Name]\").Select\n    Selection.Copy\n    Sheets(\"Agency Search\").Select\n    Range(\"Q15\").Select\n    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n        :=False, Transpose:=False\n\n    'DataCheck for workers\n    Sheets(\"Agency Search Data\").Select\n    BlankCheckWorkers.Select\n    ActiveCell.Offset(1).Select\n    If IsEmpty(ActiveCell) = False Then\n    GoTo Data2\n    Else\n    GoTo NoData2\n    End If\n\nNoData2:\n    Rows(\"1:1000\").Select\n    Selection.RowHeight = 15\n    Sheets(\"Agency Search\").Select\n    ActiveWorkbook.Sheets(\"Agency Search Data\").Visible = xlSheetVeryHidden\n    Application.ScreenUpdating = True\n    msgBox \"The agency details have been pulled but there are no workers associated with the Agency\" &amp; vbNewLine &amp; vbNewLine &amp; \"If you think this to not be true, please contact OSD\"\n    GoTo Finish\n\nData2:\n    'Pull worker IDs\n    Sheets(\"Agency Search Data\").Select\n    Range(\"AgencyWorkers[auto_number]\").Select\n    Selection.Copy\n    Sheets(\"Agency Search\").Select\n    Range(\"G28\").Select\n    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n        :=False, Transpose:=False\n\n    'Pull worker first name\n    Sheets(\"Agency Search Data\").Select\n    Range(\"AgencyWorkers[first_name]\").Select\n    Selection.Copy\n    Sheets(\"Agency Search\").Select\n    Range(\"I28\").Select\n    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n        :=False, Transpose:=False\n\n    'Pull worker last name\n    Sheets(\"Agency Search Data\").Select\n    Range(\"AgencyWorkers[last_name]\").Select\n    Selection.Copy\n    Sheets(\"Agency Search\").Select\n    Range(\"K28\").Select\n    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n        :=False, Transpose:=False\n    Rows(\"1:1000\").Select\n    Selection.RowHeight = 15\n    Range(\"L5\").Select\n\nFinish:\n    ActiveWorkbook.Sheets(\"Agency Search Data\").Visible = xlSheetVeryHidden\n    Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 175, "user_id": 9282369, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/edf34942883bbc3c51d9c5ce4af5911c?s=128&d=identicon&r=PG", "display_name": "ACatInLove", "link": "https://stackoverflow.com/users/9282369/acatinlove"}, "edited": false, "score": 0, "creation_date": 1517390091, "post_id": 48538363, "comment_id": 84071795, "body": "No. But help explains the difference <a href=\"https://msdn.microsoft.com/en-us/library/aa243356(v=vs.60).aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/aa243356(v=vs.60).aspx</a>."}], "answers": [{"comments": [{"owner": {"reputation": 1408, "user_id": 2900158, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/100000652927227/picture?type=large", "display_name": "Patrick Lepelletier", "link": "https://stackoverflow.com/users/2900158/patrick-lepelletier"}, "edited": false, "score": 1, "creation_date": 1517562176, "post_id": 48538520, "comment_id": 84154354, "body": "<code>End</code> is just unthinkable, unless in debugging. It won&#39;t let <code>terminate</code>or <code>QueryClose</code> launch at the closing of your UserForm."}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": true, "score": 4, "last_activity_date": 1617708047, "last_edit_date": 1617708047, "creation_date": 1517390395, "answer_id": 48538520, "question_id": 48538363, "link": "https://stackoverflow.com/questions/48538363/closing-a-form-with-end-vs-unload-me/48538520#48538520", "title": "Closing a form with End vs Unload me", "body": "<p>No, they do not do the same.</p>\n<ul>\n<li><p><code>End</code> will kill any public or private variable that you have, including any form and any object. Strongly not advisable.</p>\n</li>\n<li><p><code>Unload Me</code> should unload the form.</p>\n</li>\n</ul>\n<p>See here for a reference for the form, <code>Unload Me</code> is actually not the best option for closing a form and to referring to one in general - <a href=\"https://stackoverflow.com/a/48427044/5448626\">https://stackoverflow.com/a/48427044/5448626</a></p>\n"}], "owner": {"reputation": 95, "user_id": 8323673, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b4ec85ed7027324e7f870ecdf3e61e65?s=128&d=identicon&r=PG&f=1", "display_name": "Hola", "link": "https://stackoverflow.com/users/8323673/hola"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3612, "favorite_count": 1, "accepted_answer_id": 48538520, "answer_count": 1, "score": 2, "last_activity_date": 1617708047, "creation_date": 1517389847, "last_edit_date": 1521478477, "question_id": 48538363, "link": "https://stackoverflow.com/questions/48538363/closing-a-form-with-end-vs-unload-me", "title": "Closing a form with End vs Unload me", "body": "<p>It seems both statement works the same. <code>Unload me</code> or <code>End</code></p>\n\n<p>can anyone please explain the difference? and purpose of <code>END</code> statement</p>\n\n<p>Does both statement do the same thing?</p>\n\n<pre><code>Private Sub btn_trial_Click()\nSetUpTrial.ActivateTrial (Activation.getMachineIDIndexNo)\nEnd\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2238, "user_id": 3427079, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/uSYvV.jpg?s=128&g=1", "display_name": "G_V", "link": "https://stackoverflow.com/users/3427079/g-v"}, "edited": false, "score": 1, "creation_date": 1517389463, "post_id": 48538205, "comment_id": 84071441, "body": "What does the OLE DB specification say about the format of initialization strings?"}, {"owner": {"reputation": 1, "user_id": 9292718, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da8d19f66e42105db4e736cb3126fbda?s=128&d=identicon&r=PG&f=1", "display_name": "Alexander Benson", "link": "https://stackoverflow.com/users/9292718/alexander-benson"}, "reply_to_user": {"reputation": 2238, "user_id": 3427079, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/uSYvV.jpg?s=128&g=1", "display_name": "G_V", "link": "https://stackoverflow.com/users/3427079/g-v"}, "edited": false, "score": 0, "creation_date": 1517389602, "post_id": 48538205, "comment_id": 84071520, "body": "actullay that is the exact error that i got."}, {"owner": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "edited": false, "score": 0, "creation_date": 1517415290, "post_id": 48538205, "comment_id": 84088947, "body": "There&#39;s a dedicated website for connection strings <a href=\"https://www.connectionstrings.com/\" rel=\"nofollow noreferrer\">connectionstrings.com</a>"}], "owner": {"reputation": 1, "user_id": 9292718, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da8d19f66e42105db4e736cb3126fbda?s=128&d=identicon&r=PG&f=1", "display_name": "Alexander Benson", "link": "https://stackoverflow.com/users/9292718/alexander-benson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 961, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1517406515, "creation_date": 1517389271, "last_edit_date": 1531164843, "question_id": 48538205, "link": "https://stackoverflow.com/questions/48538205/error-format-of-the-initialization-string-does-not-conform-to-the-ole-db-specif", "title": "Error: Format of the initialization string does not conform to the OLE DB specification", "body": "<p>I am getting an error </p>\n\n<blockquote>\n  <p>Format of the initialization string does not conform to the OLE DB specification.</p>\n</blockquote>\n\n<p>and this code stop on <code>.open</code> line. </p>\n\n<p>How can I fix this problem?</p>\n\n<pre><code>Public Const sDEMAND_ROLE_GUID As String = \"{6AA0B273-2548-49ED-9592-78243D4353AC}\"\n\nPublic Const sSHAREPOINT_SITE As String =\"https://eu001sp.domain.com/sites/\"\nSub TestPullFromSharepoint()\n\nDim cn As ADODB.Connection\nDim rs As ADODB.Recordset\nDim sConn As String\nDim sSQL As String\nDim ID As String\n\nsConn = \"Provider=Microsoft.ACE.OLEDB.12.0;DATABASE=\" &amp; sSHAREPOINT_SITE &amp; \";\" &amp; _\n\"LIST=\" &amp; sDEMAND_ROLE_GUID &amp; \";Extended Properties='Excel 8.0;HDR=YES;IMEX=1;';\"\n\nSet cn = New ADODB.Connection\nSet rs = New ADODB.Recordset\nWith cn\n    .ConnectionString = sConn\n    .Open\nEnd With\nsSQL = \"SELECT tbl.[name] FROM [Library Name] as tbl where tbl.[id] = 14\"\nrs.Open sSQL, cn, adOpenStatic, adLockOptimistic\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "conditional-formatting"], "answers": [{"comments": [{"owner": {"reputation": 545, "user_id": 5094019, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/b6fc28b0f50d14e16263bb64e3772714?s=128&d=identicon&r=PG&f=1", "display_name": "Thanasis", "link": "https://stackoverflow.com/users/5094019/thanasis"}, "edited": false, "score": 0, "creation_date": 1517410746, "post_id": 48539578, "comment_id": 84085741, "body": "Unfortunately this didn&#39;t fix it. What is really bizarre, is that if I use the record function, and type in to cell B1   =A1, the generated code is &quot;=RC[-1]&quot;  and not &quot;=ZS[-1]&quot;."}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 545, "user_id": 5094019, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/b6fc28b0f50d14e16263bb64e3772714?s=128&d=identicon&r=PG&f=1", "display_name": "Thanasis", "link": "https://stackoverflow.com/users/5094019/thanasis"}, "edited": false, "score": 2, "creation_date": 1517411757, "post_id": 48539578, "comment_id": 84086456, "body": "@Thanasis - see the edit, the only change should be in the commas <code>)</code> and not <code>]</code>."}, {"owner": {"reputation": 545, "user_id": 5094019, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/b6fc28b0f50d14e16263bb64e3772714?s=128&d=identicon&r=PG&f=1", "display_name": "Thanasis", "link": "https://stackoverflow.com/users/5094019/thanasis"}, "edited": false, "score": 0, "creation_date": 1517412142, "post_id": 48539578, "comment_id": 84086736, "body": "Perfect!! That change fixed it indeed! Thank you for the super fast response."}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": true, "score": 3, "last_activity_date": 1517411751, "last_edit_date": 1517411751, "creation_date": 1517393629, "answer_id": 48539578, "question_id": 48538108, "link": "https://stackoverflow.com/questions/48538108/conditional-formatting-with-relative-reference-in-vba-not-working-on-german-exce/48539578#48539578", "title": "Conditional formatting with relative reference in VBA not working on German Excel", "body": "<p>Give it a try like this for the German people:</p>\n\n<pre><code>Public Sub TestMe()    \n        ActiveCell.FormatConditions.Add Type:=xlCellValue, _\n                Operator:=xlNotEqual, Formula1:=\"=ZS(-1)\"    \nEnd Sub\n</code></pre>\n\n<p><code>RC</code> should be <code>ZS</code>. </p>\n\n<p><code>Z</code> is <code>Zeile</code>, <code>S</code> is <code>Spalte</code>.</p>\n\n<p>Obviously the conditional formatting likes to support only local formulas.</p>\n"}], "owner": {"reputation": 545, "user_id": 5094019, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/b6fc28b0f50d14e16263bb64e3772714?s=128&d=identicon&r=PG&f=1", "display_name": "Thanasis", "link": "https://stackoverflow.com/users/5094019/thanasis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 430, "favorite_count": 0, "accepted_answer_id": 48539578, "answer_count": 1, "score": 2, "last_activity_date": 1569366666, "creation_date": 1517388942, "last_edit_date": 1569366666, "question_id": 48538108, "link": "https://stackoverflow.com/questions/48538108/conditional-formatting-with-relative-reference-in-vba-not-working-on-german-exce", "title": "Conditional formatting with relative reference in VBA not working on German Excel", "body": "<p>I have this awkward issue:</p>\n\n<p>I am adding the following conditional formatting with relative reference through VBA:</p>\n\n<pre><code>Activecell.FormatConditions.Add Type:=xlCellValue, _\n                                Operator:=xlNotEqual, Formula1:=\"=RC[-1]\"\n</code></pre>\n\n<p>Although it is working fine on my machine with English Office 2010, it doesn't work on German Office 2010.</p>\n\n<p>Do you know what might be the reason for that?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1517388867, "post_id": 48538040, "comment_id": 84071071, "body": "Did you know that COUNT counts only numbers while COUNTA counts numbers and text?"}, {"owner": {"reputation": 51, "user_id": 9162277, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1b54633408c4463ecb9d64af36d97cd9?s=128&d=identicon&r=PG&f=1", "display_name": "Ben", "link": "https://stackoverflow.com/users/9162277/ben"}, "edited": false, "score": 0, "creation_date": 1517389125, "post_id": 48538040, "comment_id": 84071248, "body": "Yup I do. The count function works fine for my worksheet, I just can&#39;t seem to get the range to move on to the next column!"}], "answers": [{"tags": [], "owner": {"reputation": 28228, "user_id": 7132550, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/1063981417044495/picture?type=large", "display_name": "Micha\u0142 Turczyn", "link": "https://stackoverflow.com/users/7132550/micha%c5%82-turczyn"}, "is_accepted": false, "score": 0, "last_activity_date": 1517389968, "creation_date": 1517389968, "answer_id": 48538399, "question_id": 48538040, "link": "https://stackoverflow.com/questions/48538040/making-countif-worksheet-function-variable/48538399#48538399", "title": "Making &quot;Countif&quot; worksheet function variable", "body": "<p>Try this modified version:</p>\n\n<pre><code>Sub Six_Continue()\n\nDim Rng As Range\nDim LastClm As Long, i As Long\nLastClm = Cells(1, Columns.Count).End(xlToLeft).Column\n\nFor i = 1 To LastClm\n    Cells(3, i).Value = Application.WorksheetFunction.CountIf(Range(Cells(1, i), Cells(2, i)), \"&lt;&gt;?\")\nNext\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 51, "user_id": 9162277, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1b54633408c4463ecb9d64af36d97cd9?s=128&d=identicon&r=PG&f=1", "display_name": "Ben", "link": "https://stackoverflow.com/users/9162277/ben"}, "edited": false, "score": 0, "creation_date": 1517391171, "post_id": 48538460, "comment_id": 84072499, "body": "This worked for me. Thanks so much!!  Maybe I didn&#39;t specify, but the numbers in my range were as a result of an array formula. That&#39;s why I used countif and &lt;&gt;?"}], "tags": [], "owner": {"reputation": 145, "user_id": 8938363, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc77aca8ca2e6eabaaff2e84e8fa3dcb?s=128&d=identicon&r=PG&f=1", "display_name": "dadler", "link": "https://stackoverflow.com/users/8938363/dadler"}, "is_accepted": true, "score": 2, "last_activity_date": 1517390178, "creation_date": 1517390178, "answer_id": 48538460, "question_id": 48538040, "link": "https://stackoverflow.com/questions/48538040/making-countif-worksheet-function-variable/48538460#48538460", "title": "Making &quot;Countif&quot; worksheet function variable", "body": "<p>Your <code>CountIf</code> will count cells even if they don't contain a number. Using <code>Count</code> ensures that only cells containing numbers are taken into account.</p>\n\n<pre><code>Sub Six_Continue()\n\n    Dim Rng As Range\n    Dim LastClm As Long\n    Dim myClm As Long\n\n\n    With ActiveSheet\n        LastClm = .Cells(1, .Columns.Count).End(xlToLeft).Column\n        For myClm = 1 To LastClm\n            Set Rng = .Cells(3, myClm)\n            Rng.Value = Application.WorksheetFunction.Count(Range(.Cells(5, myClm), .Cells(.Cells(Rows.Count, myClm).End(xlUp).Row, myClm)))\n        Next myClm\n    End With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 51, "user_id": 9162277, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1b54633408c4463ecb9d64af36d97cd9?s=128&d=identicon&r=PG&f=1", "display_name": "Ben", "link": "https://stackoverflow.com/users/9162277/ben"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 370, "favorite_count": 0, "accepted_answer_id": 48538460, "answer_count": 2, "score": 2, "last_activity_date": 1517406535, "creation_date": 1517388737, "last_edit_date": 1517406535, "question_id": 48538040, "link": "https://stackoverflow.com/questions/48538040/making-countif-worksheet-function-variable", "title": "Making &quot;Countif&quot; worksheet function variable", "body": "<p>I have a code that counts the cell in a range if there's a number. The total number of cell counted will then be shown in row 3. My issue now is that the formula is not variable and I have no idea how to make it too.\nIf I enter this code, row 3 reports all the same result (which is from the first column of data). Hoping somebody can help me here!!</p>\n\n<pre><code>Sub Six_Continue()\n\n    Dim Rng As Range\n    Dim LastClm As Long\n\n\n    With ActiveSheet\n        LastClm = .Cells(1, .Columns.Count).End(xlToLeft).Column\n        Set Rng = Range(.Cells(3, 3), .Cells(3, LastClm))\n        Rng.Value = Application.WorksheetFunction.CountIf(Range(\"C5\", \"C\" &amp; Cells(Rows.Count, 5).End(xlUp).Row), \"&lt;&gt;?\")\n    End With\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1517393306, "post_id": 48537940, "comment_id": 84073985, "body": "So from <code>A8</code> to which one?"}, {"owner": {"reputation": 19, "user_id": 9282316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8e53121c197c81bcc7614e378512a12?s=128&d=identicon&r=PG&f=1", "display_name": "kit38912739", "link": "https://stackoverflow.com/users/9282316/kit38912739"}, "reply_to_user": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1517393968, "post_id": 48537940, "comment_id": 84074450, "body": "Hi Vityata, should be from A6 to A7 at this moment, but user will input rows between that. so i can not fix the row i select to."}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1517394027, "post_id": 48537940, "comment_id": 84074493, "body": "so from the 6. to the first before the first space?"}], "answers": [{"tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 0, "last_activity_date": 1517394850, "last_edit_date": 1517394850, "creation_date": 1517394225, "answer_id": 48539802, "question_id": 48537940, "link": "https://stackoverflow.com/questions/48537940/for-loop-the-table-only-but-not-actually-a-table/48539802#48539802", "title": "For loop the table only, but not actually a table", "body": "<p>This will show you how to refer to <code>A6</code> and <code>A7</code>, considering that your logic is the following: \"Start from 6 and finish before the first empty row\":</p>\n\n<pre><code>    With Worksheets(1)        \n        For cnt = 6 To .Cells(6, \"A\").End(xlDown).Row\n            Debug.Print cnt\n        Next cnt        \n    End With\n</code></pre>\n\n<p>And in case that the <code>6</code> is determined to be \"the first cell with a value after the first empty cell\" then something like this will be of use:</p>\n\n<pre><code>Public Sub TestMe()\n\n    Dim start   As Long\n    Dim cnt     As Long\n\n    With Worksheets(1)        \n        start = .Cells(1, \"A\").End(xlDown).End(xlDown).Row\n        For cnt = start To .Cells(start, \"A\").End(xlDown).Row\n            Debug.Print cnt\n        Next cnt\n    End With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 19, "user_id": 9282316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8e53121c197c81bcc7614e378512a12?s=128&d=identicon&r=PG&f=1", "display_name": "kit38912739", "link": "https://stackoverflow.com/users/9282316/kit38912739"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 22, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1517471853, "creation_date": 1517388372, "last_edit_date": 1531161705, "question_id": 48537940, "link": "https://stackoverflow.com/questions/48537940/for-loop-the-table-only-but-not-actually-a-table", "title": "For loop the table only, but not actually a table", "body": "<pre><code>For b = 6 To .Cells(.Rows.Count, \"A\").End(xlDown).Row\n</code></pre>\n\n<p>I would like to check each row starting from <code>A8</code> to within the table. Please see attached image. How can I make this work?</p>\n\n<p><img src=\"https://i.stack.imgur.com/uL9tB.png\" alt=\"Table like this\"></p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "edited": false, "score": 0, "creation_date": 1517388598, "post_id": 48537825, "comment_id": 84070908, "body": "Your question seems paradoxical. You must know the cell addresses of the list items at the time of adding them to the Cbx list. Therefoe, if you &quot;forgot&quot; them when you want them back again at a later stage the reason might be that you didn&#39;t note them down while you had them, such as in an extra, invisible column in the Cbx itself."}, {"owner": {"user_type": "does_not_exist", "display_name": "user8666372"}, "reply_to_user": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "edited": false, "score": 0, "creation_date": 1517391013, "post_id": 48537825, "comment_id": 84072408, "body": "@Variatus It seems as you mentioned but my goal is like that; I have one sheet which has my lists of documents in one column, and next column it has their filename with their path. I&#39;m choosing my document name from ComboBox. If i know the document&#39;s cell address it&#39;ll be pretty easy to learn it&#39;s filepath with Cell(i,j+1)"}, {"owner": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "edited": false, "score": 0, "creation_date": 1517391220, "post_id": 48537825, "comment_id": 84072535, "body": "Load the entire file name into an invisible second column in the Cbx at the same time as you load the document names. Then, when you need it, take the name from the invisible extra column."}], "answers": [{"comments": [{"owner": {"reputation": 2555, "user_id": 5794172, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd463d10de161a2b8fbf601f51c58d01?s=128&d=identicon&r=PG&f=1", "display_name": "jkpieterse", "link": "https://stackoverflow.com/users/5794172/jkpieterse"}, "edited": false, "score": 0, "creation_date": 1517391837, "post_id": 48538890, "comment_id": 84072925, "body": "I would not recommend using the listfillrange for a combobox on a userform. Instead just fill the list from an array."}, {"owner": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "reply_to_user": {"reputation": 2555, "user_id": 5794172, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd463d10de161a2b8fbf601f51c58d01?s=128&d=identicon&r=PG&f=1", "display_name": "jkpieterse", "link": "https://stackoverflow.com/users/5794172/jkpieterse"}, "edited": false, "score": 1, "creation_date": 1517392290, "post_id": 48538890, "comment_id": 84073250, "body": "@jkpieterse I&#39;m not giving recommendation or anything. OP wants to get the address so I give him a possible solution."}, {"owner": {"user_type": "does_not_exist", "display_name": "user8666372"}, "edited": false, "score": 0, "creation_date": 1517392452, "post_id": 48538890, "comment_id": 84073363, "body": "@L42 you&#39;re great!"}, {"owner": {"user_type": "does_not_exist", "display_name": "user8666372"}, "reply_to_user": {"reputation": 2555, "user_id": 5794172, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd463d10de161a2b8fbf601f51c58d01?s=128&d=identicon&r=PG&f=1", "display_name": "jkpieterse", "link": "https://stackoverflow.com/users/5794172/jkpieterse"}, "edited": false, "score": 0, "creation_date": 1517392520, "post_id": 48538890, "comment_id": 84073410, "body": "@jkpieterse why you&#39;re not recommended listfillrange ?"}, {"owner": {"reputation": 2555, "user_id": 5794172, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd463d10de161a2b8fbf601f51c58d01?s=128&d=identicon&r=PG&f=1", "display_name": "jkpieterse", "link": "https://stackoverflow.com/users/5794172/jkpieterse"}, "edited": false, "score": 0, "creation_date": 1517416522, "post_id": 48538890, "comment_id": 84089842, "body": "Not sure why, my comment seems to have been removed. Because I have had odd behavior with using ListFillRange in the past."}], "tags": [], "owner": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "is_accepted": true, "score": 0, "last_activity_date": 1517391568, "creation_date": 1517391568, "answer_id": 48538890, "question_id": 48537825, "link": "https://stackoverflow.com/questions/48537825/combobox-item-cell-address/48538890#48538890", "title": "Combobox Item Cell Address", "body": "<p>Yes. You can try something like this.</p>\n\n<pre><code>Dim r As Range\nWith Sheet1.ComboBox1 '/* Sheet1 is where the ComboBox is */\n    Set r = Evaluate(.ListFillRange)\n    Debug.Print r.Item(.ListIndex + 1).Address\nEnd With\n</code></pre>\n\n<p>To implement it in your situation (as described in comments), you can try:</p>\n\n<pre><code>'/* will give you the value right next to the selected value's source cell */\nDebug.Print r.Item(.ListIndex + 1).Offser(, 1).Value2\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user8666372"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 928, "favorite_count": 0, "accepted_answer_id": 48538890, "answer_count": 1, "score": 2, "last_activity_date": 1518091613, "creation_date": 1517387996, "last_edit_date": 1518091613, "question_id": 48537825, "link": "https://stackoverflow.com/questions/48537825/combobox-item-cell-address", "title": "Combobox Item Cell Address", "body": "<p>I'm using a ComboBox (ActiveX) and getting List Values from another sheet.</p>\n\n<p>I wonder is that possible to get selected item's cell address?</p>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 1, "creation_date": 1517384714, "post_id": 48536729, "comment_id": 84068848, "body": "Which line is the error occuring on?"}, {"owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "edited": false, "score": 0, "creation_date": 1517384879, "post_id": 48536729, "comment_id": 84068917, "body": "Can you verify that your code matches exactly the same as your friend&#39;s? Because that error would suggest that either <code>sFileName = Application.GetOpenFilename</code> or <code>ActiveSheet.Shapes.AddPicture _</code> has an invalid named argument (which would be something like <code>FileFilter:=</code>, <code>FilterIndex:=</code>, etc)"}, {"owner": {"reputation": 175, "user_id": 9282369, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/edf34942883bbc3c51d9c5ce4af5911c?s=128&d=identicon&r=PG", "display_name": "ACatInLove", "link": "https://stackoverflow.com/users/9282369/acatinlove"}, "edited": false, "score": 0, "creation_date": 1517385162, "post_id": 48536729, "comment_id": 84069062, "body": "You&#39;ll have to step through your code in the debugger. Runtime errors outside the debugger don&#39;t have a line number. <code>448  Runtime ErrorNamed argument not found</code> which indicates it&#39;s on a line <code>something:=somethingelse</code>."}], "owner": {"reputation": 13, "user_id": 8836227, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac1dbbf62901476d880cb4fbb2f84467?s=128&d=identicon&r=PG&f=1", "display_name": "user8836227", "link": "https://stackoverflow.com/users/8836227/user8836227"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 868, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1517406620, "creation_date": 1517383699, "last_edit_date": 1517406620, "question_id": 48536729, "link": "https://stackoverflow.com/questions/48536729/vba-run-time-error-448", "title": "VBA run-time error 448", "body": "<p>I have written a code to insert and size pictures automatically. This works fine at my computer, but a friend receives since a couple of days a</p>\n\n<blockquote>\n  <p>run-time error 448</p>\n</blockquote>\n\n<p>We are both using the same version of Excel 2016. The code was written in Excel 2007 and activates when pressing <kbd>Ctrl</kbd>+<kbd>P</kbd>. What is the problem and solution?</p>\n\n<pre><code>Sub InsertAndSizePhoto()\nDim sFileName As String\nDim oShape As Shape\nIf TypeName(ActiveSheet) &lt;&gt; \"Worksheet\" Then Exit Sub\nDim myPath As String\nDim folderPath As String\nfolderPath = Application.ActiveWorkbook.Path\nsFileName = Application.GetOpenFilename( _\nFileFilter:=\"Images (*.gif;*.jpg;*.png), *.gif;*.jpg;*.png\", _\nFilterIndex:=1, _\nTitle:=\"Insert Picture\", _\nButtonText:=\"Insert\", _\nMultiSelect:=False)\nIf sFileName = \"False\" Then Exit Sub\nWith ActiveCell.MergeArea\nActiveSheet.Shapes.AddPicture _\n        Filename:=sFileName, _\n        LinkToFile:=msoFalse, _\n        SaveWithDocument:=msoTrue, _\n        Left:=.Left, _\n        Top:=.Top, _\n        Width:=.Width, _\n        Height:=.Height\nEnd With\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "is_accepted": true, "score": 1, "last_activity_date": 1517383885, "creation_date": 1517383885, "answer_id": 48536779, "question_id": 48536313, "link": "https://stackoverflow.com/questions/48536313/referring-activex-combobox-from-module/48536779#48536779", "title": "Referring ActiveX Combobox from Module", "body": "<p>The easiest way is to use your <a href=\"https://msdn.microsoft.com/en-us/vba/excel-vba/articles/worksheet-codename-property-excel\" rel=\"nofollow noreferrer\">worksheet's <strong>codename</strong></a>.</p>\n\n<p>This is different from the sheet name as well as the sheet index, so if you are not familiar with codenames at all you might want to read up on it.</p>\n\n<p>In the VBE project explorer, you will see your codenames followed by your sheet names, and it would look something like <code>Sheet1 (Setup Sheet)</code>.</p>\n\n<p>Assuming your <em>Setup Sheet's</em> codename is <code>Sheet1</code>, then you could simply use  </p>\n\n<pre><code>Sheet1.Combobox1.Value\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1118, "user_id": 8282232, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/775ef4ecf830083680ae6dbae8da395c?s=128&d=identicon&r=PG&f=1", "display_name": "AntiDrondert", "link": "https://stackoverflow.com/users/8282232/antidrondert"}, "is_accepted": false, "score": 1, "last_activity_date": 1517384286, "creation_date": 1517384286, "answer_id": 48536888, "question_id": 48536313, "link": "https://stackoverflow.com/questions/48536313/referring-activex-combobox-from-module/48536888#48536888", "title": "Referring ActiveX Combobox from Module", "body": "<p>Try replacing <code>.ComboBox1.Value</code> with <code>Shapes(\"ComboBox1\").DrawingObject.Object.Value</code></p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user8666372"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 569, "favorite_count": 0, "accepted_answer_id": 48536779, "answer_count": 2, "score": 1, "last_activity_date": 1517385148, "creation_date": 1517382079, "question_id": 48536313, "link": "https://stackoverflow.com/questions/48536313/referring-activex-combobox-from-module", "title": "Referring ActiveX Combobox from Module", "body": "<p>I would like to refer ActiveX ComboBox value from module. I put ComboBox which named ComboBox1 into worksheet. This worksheet names is \"Setup Sheet\" and code name \"SetupSheet\". And i want to read value of combo box from my module named SettingsModule.</p>\n\n<pre><code>Debug.Print ThisWorkbook.Sheets(\"Setup Sheet\").ComboBox1.Value\n</code></pre>\n\n<p>but it gives an error <code>Method or Object not found.</code></p>\n\n<p>What's wrong with my code?</p>\n"}, {"tags": ["vba", "excel", "excel-2010"], "comments": [{"owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "edited": false, "score": 0, "creation_date": 1517381352, "post_id": 48535802, "comment_id": 84067309, "body": "Longshot... But why don&#39;t you try <code>Application.EnableEvents = False</code> right after your Double Click event and see what happens."}, {"owner": {"reputation": 29, "user_id": 9292802, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab12286e185dcc2b01a5995e90e78717?s=128&d=identicon&r=PG&f=1", "display_name": "Varsha Khanna", "link": "https://stackoverflow.com/users/9292802/varsha-khanna"}, "reply_to_user": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "edited": false, "score": 0, "creation_date": 1517381866, "post_id": 48535802, "comment_id": 84067547, "body": "I have already applied that at the start of double_click and set it to true at the end."}, {"owner": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "edited": false, "score": 0, "creation_date": 1517388931, "post_id": 48535802, "comment_id": 84071119, "body": "Did you set <code>Cancel = True</code> in the double-click event procedure?"}, {"owner": {"reputation": 29, "user_id": 9292802, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab12286e185dcc2b01a5995e90e78717?s=128&d=identicon&r=PG&f=1", "display_name": "Varsha Khanna", "link": "https://stackoverflow.com/users/9292802/varsha-khanna"}, "reply_to_user": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "edited": false, "score": 0, "creation_date": 1517392053, "post_id": 48535802, "comment_id": 84073077, "body": "@Variatus Yes i have set so.. does it impact in anyway?"}, {"owner": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "edited": false, "score": 0, "creation_date": 1517396786, "post_id": 48535802, "comment_id": 84076362, "body": "Please add a copy of your code that opens the ListBox to your question."}, {"owner": {"reputation": 29, "user_id": 9292802, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab12286e185dcc2b01a5995e90e78717?s=128&d=identicon&r=PG&f=1", "display_name": "Varsha Khanna", "link": "https://stackoverflow.com/users/9292802/varsha-khanna"}, "edited": false, "score": 0, "creation_date": 1517403915, "post_id": 48535802, "comment_id": 84080705, "body": "Updated with code snippet"}], "answers": [{"tags": [], "owner": {"reputation": 29, "user_id": 9292802, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab12286e185dcc2b01a5995e90e78717?s=128&d=identicon&r=PG&f=1", "display_name": "Varsha Khanna", "link": "https://stackoverflow.com/users/9292802/varsha-khanna"}, "is_accepted": true, "score": 1, "last_activity_date": 1517847821, "creation_date": 1517847821, "answer_id": 48626978, "question_id": 48535802, "link": "https://stackoverflow.com/questions/48535802/unable-to-select-any-item-from-activex-listbox-excel-2010/48626978#48626978", "title": "Unable to select any item from activex ListBox Excel 2010", "body": "<p>After some looking around into forums and support questions, I came up with a probable reason why this is happening.\nIt seems like excel and activex objects don't go well together. Whenever an excel file is zoomed in/out or opened on a screen resolution that was different from its original resolution, excel errors out in its size calculations for various activex objects. Thus, there is temporary distortion with these objects that renders the mouse icon as a plus icon.(unable to select any item). So, the solution will be to resize or reset any size parameter of the activex object(width,height) or by scrolling the active window like a refresh action.</p>\n\n<pre><code>ActiveWindow.SmallScroll ToLeft:=1\nActiveWindow.SmallScroll ToRight:=1\n</code></pre>\n"}], "owner": {"reputation": 29, "user_id": 9292802, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab12286e185dcc2b01a5995e90e78717?s=128&d=identicon&r=PG&f=1", "display_name": "Varsha Khanna", "link": "https://stackoverflow.com/users/9292802/varsha-khanna"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 301, "favorite_count": 1, "accepted_answer_id": 48626978, "answer_count": 1, "score": 1, "last_activity_date": 1517847821, "creation_date": 1517380078, "last_edit_date": 1517397622, "question_id": 48535802, "link": "https://stackoverflow.com/questions/48535802/unable-to-select-any-item-from-activex-listbox-excel-2010", "title": "Unable to select any item from activex ListBox Excel 2010", "body": "<p>I have some activex ListBox controls on my worksheet. I have applied a macro that opens the litsbox on double_click on any cell.</p>\n\n<p>The issue is that in excel versions 2010 or less, I am unable to select any item from he listbox as the mouse cursor gets stuck in plus sign.</p>\n\n<p>If I zoom in/out the sheet, the issue works for sometime then again gets back to same plus icon state.</p>\n\n<p>This is issue does not occur in excel version above 2010.</p>\n\n<p>Edit:\nCode snippet:</p>\n\n<pre><code>`Private Sub Worksheet_BeforeDoubleClick(ByVal Target As Range, Cancel As \nBoolean)\nApplication.ScreenUpdating = False\nApplication.EnableEvents = False\n\nDim colName, strRange As String\nstrRange = Target.Address\n\ncolName = Replace(Target(1).Address(0, 0), Target(1).row, \"\")\nstrRange = colName &amp; CStr(1) &amp; \":\" &amp; colName &amp; CStr(6)\n\nIf ctrl Is Nothing Then\nGoTo ExecuteSub\nEnd If\nOn Error GoTo ExitSub\n\nlistBoxName = \"ListBox\" + CStr(Target.Column)\n\nOn Error GoTo ExitSub\nSet ctrl = ActiveSheet.OLEObjects(listBoxName)\n\nIf ctrl Is Nothing Then\nGoTo ExitSub\nElse\nCancel = True\n\nctrl.Enabled = True\nctrl.Top = Target.Top + Target.Height\nctrl.Left = Target.Left\nctrl.Visible =True`\n</code></pre>\n"}, {"tags": ["vba", "performance", "excel", "optimization", "web-scraping"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1517379851, "post_id": 48535558, "comment_id": 84066717, "body": "HTML is not XML, so it&#39;s not clear what you mean.  Are you asking about using XMLHTTP instead of IE?"}, {"owner": {"reputation": 175, "user_id": 9282369, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/edf34942883bbc3c51d9c5ce4af5911c?s=128&d=identicon&r=PG", "display_name": "ACatInLove", "link": "https://stackoverflow.com/users/9282369/acatinlove"}, "edited": false, "score": 1, "creation_date": 1517380026, "post_id": 48535558, "comment_id": 84066789, "body": "Why don&#39;t you insert the web table into excel. Let Excel do the work. <i>Alt + D, D, W</i>. And follow the prompts. Excel can usually tell tables and allow you to select the table only."}, {"owner": {"reputation": 33, "user_id": 9268119, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a40dd631a5af24a2246b0a471f631e80?s=128&d=identicon&r=PG&f=1", "display_name": "Graham Dredt", "link": "https://stackoverflow.com/users/9268119/graham-dredt"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1517405539, "post_id": 48535558, "comment_id": 84081819, "body": "@TimWilliams My apologies, that is from my lack of knowledge on this, i did mean XMLHTTP, and yes this is what i would like to do to convert"}, {"owner": {"reputation": 33, "user_id": 9268119, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a40dd631a5af24a2246b0a471f631e80?s=128&d=identicon&r=PG&f=1", "display_name": "Graham Dredt", "link": "https://stackoverflow.com/users/9268119/graham-dredt"}, "reply_to_user": {"reputation": 175, "user_id": 9282369, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/edf34942883bbc3c51d9c5ce4af5911c?s=128&d=identicon&r=PG", "display_name": "ACatInLove", "link": "https://stackoverflow.com/users/9282369/acatinlove"}, "edited": false, "score": 0, "creation_date": 1517405698, "post_id": 48535558, "comment_id": 84081921, "body": "@ACatInLove I tried the web query route and it looked promising, but I have to do (2) things before the table is presented.  On the webpage, I need to enter and account number (&quot;ctl00_MainContentRegion_tAcct&quot;) from the code above, then click a button (&quot;ctl00_MainContentRegion_btnRunReport&quot;) again from the code above.  I did not see how to do this with a web query.  If there is a way, I&#39;m all ears and would appreciate any insight.  Thanks!"}, {"owner": {"reputation": 33, "user_id": 9268119, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a40dd631a5af24a2246b0a471f631e80?s=128&d=identicon&r=PG&f=1", "display_name": "Graham Dredt", "link": "https://stackoverflow.com/users/9268119/graham-dredt"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1517405893, "post_id": 48535558, "comment_id": 84082084, "body": "@TimWilliams I updated my original question to show XMLHTTP instead of just XML for future clarity. Thanks!"}], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 9268119, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a40dd631a5af24a2246b0a471f631e80?s=128&d=identicon&r=PG&f=1", "display_name": "Graham Dredt", "link": "https://stackoverflow.com/users/9268119/graham-dredt"}, "edited": false, "score": 0, "creation_date": 1517467576, "post_id": 48546859, "comment_id": 84109460, "body": "Can you walk me thorough a little of using MSHTML to grab the data. How do I enter an account number then click a button within MSHTML?"}, {"owner": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "reply_to_user": {"reputation": 33, "user_id": 9268119, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a40dd631a5af24a2246b0a471f631e80?s=128&d=identicon&r=PG&f=1", "display_name": "Graham Dredt", "link": "https://stackoverflow.com/users/9268119/graham-dredt"}, "edited": false, "score": 0, "creation_date": 1517494723, "post_id": 48546859, "comment_id": 84125584, "body": "I have expanded answer."}, {"owner": {"reputation": 33, "user_id": 9268119, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a40dd631a5af24a2246b0a471f631e80?s=128&d=identicon&r=PG&f=1", "display_name": "Graham Dredt", "link": "https://stackoverflow.com/users/9268119/graham-dredt"}, "edited": false, "score": 0, "creation_date": 1517513984, "post_id": 48546859, "comment_id": 84137380, "body": "Thanks!  I am looking at the network tab in chrome.  I am seeing multiple items in the name column, looks like document type has the code I used to manipulate the site.  When i click on the document item a new window with &quot;Headers, Preview, Response, etc...&quot; shows.  I am not sure what I am looking for?  Also, it will be a significant challenge to get the API from IT which is why I used what I knew to do this project.  I am just trying to speed it up and make it more reliable now."}], "tags": [], "owner": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "is_accepted": false, "score": 1, "last_activity_date": 1517494590, "last_edit_date": 1517494590, "creation_date": 1517415888, "answer_id": 48546859, "question_id": 48535558, "link": "https://stackoverflow.com/questions/48535558/need-help-to-convert-internet-explorer-based-web-scraping-to-xmlhttp/48546859#48546859", "title": "Need help to convert Internet Explorer based web scraping to XMLHTTP", "body": "<p>HTML is not XML.  XML is strictly enforced is terms of opening and closing tags whilst HTML is famous for <code>&lt;br&gt;</code> tags without closuing <code>&lt;/br&gt;</code>.  You'd be very lucky if the HTML is XML compliant.</p>\n\n<p>Anyway, if you want to use XMLHTTP because of the HTTP request and still keep your IE based web scraping code then see this article <a href=\"http://exceldevelopmentplatform.blogspot.com/2018/01/vba-xmlhttp-request-xhr-does-not-parse.html\" rel=\"nofollow noreferrer\">http://exceldevelopmentplatform.blogspot.com/2018/01/vba-xmlhttp-request-xhr-does-not-parse.html</a>  It shows how to use XMLHTTP before passing response to MSHTML.</p>\n\n<p>You can use MSHTML independently of IE, see this article <a href=\"http://exceldevelopmentplatform.blogspot.com/2017/12/use-mshtml-to-parse-local-html-file.html\" rel=\"nofollow noreferrer\">Use MSHTML to parse local HTML file without using Internet Explorer (Microsoft HTML Object Library)</a>.  If you read that you will see much of the code that you write against the IE object model is in fact aaginst the MSHTML object model and as such you can decouple and jettison IE.  Enjoy!</p>\n\n<p>EDIT1: <em>Don't forget you can ask your company's IT staff</em></p>\n\n<p>You say it is an intranet site which implies internal to your company, you could ask the programmers who are responsible for that system for a direct API guide.</p>\n\n<p>EDIT2: <em>Folding in feedback about how to mimic a browser...</em></p>\n\n<p><strong>To mimic the browser you need to figure out the traffic that button clicks generate...</strong></p>\n\n<p>To watch network traffic I recommend you switch to Chrome as your browser.  Then, on this web page, right-click mouse button and take \"Inspect\" menu option, this opens the Chrome Developer Tools.  Then, in Developer Tools select the Network tab, then click on a link on this page and you will see the traffic that is generated.  </p>\n\n<p>So, if you want to go pure XMLHTTP and leave browsers behind then you won't have buttons available to click but you can observe the network traffic that happens when a button is clicked in a browser and you can then mimic this in code.  </p>\n\n<p>So for example, in your comment you ask how do I enter an account number and click the button.  I'm guessing that clicking a button will result in a XMLHTTP call of something like <code>http://example.com/dowork/mypage.asp?accountnumber=1233456&amp;otherParams=true</code> so you see account number would be buried in the query parameters.  Once you have that url you can put that in your XMLHTTP request.</p>\n\n<p>One potential problem is that system designers may have chosen to hide account numbers in the body of a HTTP POST because it is sensitive/confidential data.  However, Chrome Developer Tools is very good and should still yield that information but may have to poke around.</p>\n"}], "owner": {"reputation": 33, "user_id": 9268119, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a40dd631a5af24a2246b0a471f631e80?s=128&d=identicon&r=PG&f=1", "display_name": "Graham Dredt", "link": "https://stackoverflow.com/users/9268119/graham-dredt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 376, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1517494590, "creation_date": 1517378975, "last_edit_date": 1517405790, "question_id": 48535558, "link": "https://stackoverflow.com/questions/48535558/need-help-to-convert-internet-explorer-based-web-scraping-to-xmlhttp", "title": "Need help to convert Internet Explorer based web scraping to XMLHTTP", "body": "<p>I am trying to speed up some intranet webscraping as well as make it more reliable.  I am just learning how to implement XMLHTTP and I need some advice on converting my code from IE based scrapping to XMLHTTP.  </p>\n\n<p>I have 2 subs in my module that accomplishes loading up and navigating the intranet site (GetWebTable) and parsing through the data (GetOneTable) to return a table in excel. The subs are as follows:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Sub GetWebTable(sAccountNum As String)\n\nOn Error Resume Next\n\nDim objIE           As Object\nDim strBuffer       As String\nDim thisCol         As Integer\nDim iAcctCount      As Integer\nDim iCounter        As Integer\nDim iNextCounter    As Integer\nDim iAcctCell       As Integer\nDim thisColCustInfo As Integer\nDim iErrorCounter As Integer\n\n    If InStr(1, sAccountNum, \"-\") &lt;&gt; 0 Then\n        sAccountNum = Replace(sAccountNum, \"-\", \"\")\n    End If\n\n    If InStr(1, sAccountNum, \" \") &lt;&gt; 0 Then\n        sAccountNum = Replace(sAccountNum, \" \", \"\")\n    End If\n\n    iErrorCounter = 1\n    TRY_AGAIN:\n\n    'Spawn Internet Explorer\n        Set objIE = GetObject(\"new:{D5E8041D-920F-45e9-B8FB-XXXXXXX}\") \n        DoEvents\n\n        With objIE\n            .Visible = False\n            .Navigate \"http://intranetsite.aspx\"\n\n            While .busy = True Or .readystate &lt;&gt; 4: DoEvents: Wend\n            While .Document.readyState &lt;&gt; \"complete\": DoEvents: Wend\n\n            .Document.getElementById(\"ctl00_MainContentRegion_tAcct\").Value = sAcct\n\n            While .busy = True Or .readyState &lt;&gt; 4: DoEvents: Wend\n            While .Document.readyState &lt;&gt; \"complete\": DoEvents: Wend\n\n            .Document.getElementById(\"ctl00_MainContentRegion_btnRunReport\").Click\n\n            While .busy = True Or .readyState &lt;&gt; 4: DoEvents: Wend\n            While .Document.readyState &lt;&gt; \"complete\": DoEvents: Wend\n\n        End With\n\n            thisCol = 53\n            thisColCustInfo = 53\n\n        GetOneTable objIE.Document, 9, thisCol\n\n        'Cleanup:\n        objIE.Quit\n        Set objIE = Nothing\n\n    GetWebTable_Error:\n    Select Case Err.Number\n        Case 0\n        Case Else\n        Debug.Print Err.Number, Err.Description\n        iErrorCounter = iErrorCounter + 1\n        objIE.Quit\n        Set objIE = Nothing\n        If iErrorCounter &gt; 4 Then On Error Resume Next\n        GoTo TRY_AGAIN\n\n            'Stop\n    End Select\nEnd Sub\n\n\n\nSub GetOneTable(varWebPageDoc, varTableNum, varColInsert)\n\nDim varDocElement   As Object ' the elements of the document\nDim varDocTable     As Object ' the table required\nDim varDocRow       As Object ' the rows of the table\nDim varDocCell      As Object ' the cells of the rows.\nDim Rng             As Range\nDim iCellCount      As Long\nDim iElemCount      As Long\nDim iTableCount     As Long\nDim iRowCount       As Long\nDim iRowCounter As Integer\nDim bTableEndFlag As Boolean\n\nbTableEndFlag = False\n\nFor Each varDocElement In varWebPageDoc.all\n    If varDocElement.nodeName = \"TABLE\" Then\n        iElemCount = iElemCount + 1\n    End If\n\n    If iElemCount = varTableNum Then\n        Set varDocTable = varDocElement\n\n        iTableCount = iTableCount + 1\n        iRowCount = iRowCount + 1\n        Set Rng = Worksheets(\"Sheet1\").Cells(2, varColInsert)\n\n        For Each varDocRow In varDocTable.Rows\n\n            For Each varDocCell In varDocRow.Cells\n                If Left(varDocCell.innerText, 9) = \"Total for\" Then\n                    bTableEndFlag = True\n                    Exit For\n                End If\n                Rng.Value = varDocCell.innerText\n                Set Rng = Rng.Offset(, 1)\n                iCellCount = iCellCount + 1\n            Next varDocCell\n\n            iRowCount = iRowCount + 1\n            Set Rng = Rng.Offset(1, -iCellCount)\n            iCellCount = 0\n\n        Next varDocRow\n\n        Exit For\n\n    End If\n\nNext varDocElement\n\nSet varDocElement = Nothing\nSet varDocTable = Nothing\nSet varDocRow = Nothing\nSet varDocCell = Nothing\nSet Rng = Nothing\n\nEnd Sub\n</code></pre>\n\n<p>Any thoughts?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "edited": false, "score": 0, "creation_date": 1517378999, "post_id": 48535478, "comment_id": 84066367, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/512143/error-could-not-find-installable-isam\">Error: &quot;Could Not Find Installable ISAM&quot;</a>"}, {"owner": {"reputation": 1, "user_id": 9292718, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da8d19f66e42105db4e736cb3126fbda?s=128&d=identicon&r=PG&f=1", "display_name": "Alexander Benson", "link": "https://stackoverflow.com/users/9292718/alexander-benson"}, "reply_to_user": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "edited": false, "score": 0, "creation_date": 1517386077, "post_id": 48535478, "comment_id": 84069553, "body": "I checked that post, but the data source of what I&#39;m working is from a SharePoint."}, {"owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "edited": false, "score": 0, "creation_date": 1517386202, "post_id": 48535478, "comment_id": 84069615, "body": "Can you at least provide some code? You will get better responses when you include a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>. You can review <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a> as well."}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 8872491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6d9e2c0343b564f9439fea3f257de6fd?s=128&d=identicon&r=PG&f=1", "display_name": "LlamaLoney", "link": "https://stackoverflow.com/users/8872491/llamaloney"}, "is_accepted": false, "score": 0, "last_activity_date": 1531196690, "creation_date": 1531196690, "answer_id": 51257257, "question_id": 48535478, "link": "https://stackoverflow.com/questions/48535478/add-list-item-to-sharepoint-list-using-vba/51257257#51257257", "title": "Add list item to sharepoint list using vba", "body": "<p>I know it isn't super pretty, but I have a solution... Make sure that you replace YOURSHAREPOINTSITE with the url of your site.</p>\n\n<p>The beauty of my solution, is that the code allows for:</p>\n\n<ol>\n<li>Creation of new SP list</li>\n<li>Addition of list items with all original column of the list</li>\n<li>Addition of list items with any number of columns of the list (as\nlong as all required columns are represented)</li>\n<li>No link required for the addition of new data (does create a link\nwhen you use #1 but not a syncing link)</li>\n</ol>\n\n<p>Limitations:</p>\n\n<ol>\n<li>Column validation will cause a failed run if you pass data that\nshouldn't go in that column (text to number column)</li>\n<li>Absent required columns cause a failed run</li>\n<li>Untested with lookup, people/group, or other record related column\ntypes... but it would cause invalid data, potentially a failed run\nunless you input the ID of the lookup value... which you probably\ndon't have.</li>\n<li>It does require correct typing of column names and list name in\ninput boxes...</li>\n</ol>\n\n<pre><code>Public Sub PushSPList()\n    Dim lname As String, guid As String\n    Dim arr, arrr\n    Dim NewList As ListObject\n    Dim L As ListObjects\n    ' Get the collection of lists for the active sheet\n    Set L = ThisWorkbook.ActiveSheet.ListObjects\n\n    ' Add a new list\n    If MsgBox(\"Have you selected the new data?\", vbYesNo) = vbNo Then\n        Exit Sub\n    Else\n\n        If MsgBox(\"New?\", vbYesNo) = vbYes Then\n            lname = InputBox(\"What is the name of your new list?\")\n\n            Set NewList = L.Add(xlSrcRange, Selection, , xlYes, True)\n            NewList.Name = lname\n\n            ' Publish it to a SharePoint site\n            NewList.Publish Array(\"https://YOURSHAREPOINTSITE\", lname), False\n\n        Else\n            arr = getSPitems\n            lname = arr(2)\n            guid = arr(1)\n\n            Set NewList = L(1)\n            Set arrr = Selection\n            Call addSPListItem(arrr, lname, guid)\n\n        End If\n    End If\n\n    End Sub\n\n    Sub addSPListItem(rar As Variant, lnme, guid)\n\n    Dim arr, lguid As String, spurl As String, lname As String, uitem As Object\n\n    lguid = guid\n    lname = lnme\n\n    spurl = \"https://YOURSHAREPOINTSITE\"\n\n    Dim cnt As ADODB.Connection\n    Dim rst As ADODB.Recordset 'tb\n\n    Dim mySQL As String\n\n    Set cnt = New ADODB.Connection\n    Set rst = New ADODB.Recordset\n\n    mySQL = \"SELECT * FROM [\" & lname & \"];\"\n\n    With cnt\n        .ConnectionString = _\n        \"Provider=Microsoft.ACE.OLEDB.12.0;WSS;IMEX=0;RetrieveIds=Yes;\" & _\n            \"DATABASE=\" & spurl & _\n            \";LIST=\" & lguid & \";\"\n        .Open\n    End With\n\n    rst.Open mySQL, cnt, adOpenDynamic, adLockOptimistic\n\n\n    Dim fld As Object\n    Dim arrr()\n    i = -1\n    For Each fld In rst.Fields\n    i = i + 1\n    ReDim Preserve arrr(0 To i)\n    arrr(i) = rst.Fields(i).Name\n\n    Next\n\n    Dim clmns\n    clmns = Split(InputBox(\"Select columns, separated by commas, no spaces after commas...    \" & Join(arrr, \", \")), \",\")\n\n    Dim Colmns As Object\n    Set Colmns = CreateObject(\"Scripting.Dictionary\")\n    For i = 0 To UBound(clmns)\n        Colmns(i) = clmns(i)\n    Next\n\n    jj = 1\n    Do While rar(jj, 1)  \"\"\n    rst.AddNew\n        For kk = 0 To UBound(clmns)\n        rst.Fields(Colmns(kk)) = rar(jj, kk + 1)\n        Next\n    jj = jj + 1\n        Loop\n    rst.Update\n\n    If CBool(rst.State And adStateOpen) = True Then rst.Close\n    Set rst = Nothing\n    If CBool(cnt.State And adStateOpen) = True Then cnt.Close\n    Set cnt = Nothing\n    MsgBox \"Done\"\n    End Sub</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 9292718, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da8d19f66e42105db4e736cb3126fbda?s=128&d=identicon&r=PG&f=1", "display_name": "Alexander Benson", "link": "https://stackoverflow.com/users/9292718/alexander-benson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1977, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1575558987, "creation_date": 1517378602, "last_edit_date": 1531164843, "question_id": 48535478, "link": "https://stackoverflow.com/questions/48535478/add-list-item-to-sharepoint-list-using-vba", "title": "Add list item to sharepoint list using vba", "body": "<p>Im trying to create an excel tool that will add list item to sharepoint custom list. I had theinitial code but i am getying an error \"couldnt find installable ISAM\". My excel is 2016 and running in windows 10. How can i fix this issue?</p>\n\n<pre><code>Public Const sDEMAND_ROLE_GUID As String = \"{6AA0B273-2548-49ED-9592-78243D4353AC}\"\nPublic Const sSHAREPOINT_SITE As String = \"https://eu001-sp.domain.com/sites/\"\n\nSub TestPullFromSharepoint()\n\nDim cn As ADODB.Connection\nDim rs As ADODB.Recordset\nDim sConn As String\nDim sSQL As String\nDim ID As String\n\nsConn = \"Provider=Microsoft.ACE.OLEDB.12.0;DATABASE=\" &amp; sSHAREPOINT_SITE &amp; \";\" &amp; _\n\"LIST=\" &amp; sDEMAND_ROLE_GUID &amp; \";Extended Properties='Excel 8.0;HDR=YES;IMEX=1;';\"\n\n    Set cn = New ADODB.Connection\n    Set rs = New ADODB.Recordset\n    With cn\n        .ConnectionString = sConn\n        .Open\n    End With\nsSQL = \"SELECT tbl.[name] FROM [Library Name] as tbl where tbl.[id] = 14\"\nrs.Open sSQL, cn, adOpenStatic, adLockOptimistic\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "solver"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1517400726, "post_id": 48535436, "comment_id": 84078739, "body": "The issue in Update2 might be that the Solver add-in is not activated in Excel. <b>You cannot run any solver actions without a active Solver add-in</b> (see <a href=\"https://msdn.microsoft.com/en-us/library/office/ff196600(v=office.14)?f=255&amp;MSPPError=-2147217396\" rel=\"nofollow noreferrer\">documentation</a>). Therefore make sure the Solver add-in is active before you run your code."}], "answers": [{"comments": [{"owner": {"reputation": 2784, "user_id": 7256873, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/97aae59e027906195415adc6797340f2?s=128&d=identicon&r=PG&f=1", "display_name": "AK88", "link": "https://stackoverflow.com/users/7256873/ak88"}, "edited": false, "score": 0, "creation_date": 1517386290, "post_id": 48536808, "comment_id": 84069661, "body": "thank you for the reply, +1. According to the given list, <code>AssumeNonNeg</code> is the 12th parameter. I have set it to <code>False</code> and re-ran the code... Still no change... Only positive numbers are reported as solution."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 2784, "user_id": 7256873, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/97aae59e027906195415adc6797340f2?s=128&d=identicon&r=PG&f=1", "display_name": "AK88", "link": "https://stackoverflow.com/users/7256873/ak88"}, "edited": false, "score": 0, "creation_date": 1517387194, "post_id": 48536808, "comment_id": 84070134, "body": "Obviously you need to do the same with the <code>SolverOK</code> function. See my edit above. If this doesn&#39;t solve your question please edit your original question and add the code you actually use at the end of your question."}, {"owner": {"reputation": 2784, "user_id": 7256873, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/97aae59e027906195415adc6797340f2?s=128&d=identicon&r=PG&f=1", "display_name": "AK88", "link": "https://stackoverflow.com/users/7256873/ak88"}, "edited": false, "score": 0, "creation_date": 1517387818, "post_id": 48536808, "comment_id": 84070466, "body": "Hmmm, still didn&#39;t work. I&#39;m updating the body of my question to show the current state of the code..."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 2784, "user_id": 7256873, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/97aae59e027906195415adc6797340f2?s=128&d=identicon&r=PG&f=1", "display_name": "AK88", "link": "https://stackoverflow.com/users/7256873/ak88"}, "edited": false, "score": 1, "creation_date": 1517389514, "post_id": 48536808, "comment_id": 84071470, "body": "because you did not copy my code <b>exactly</b>, I explained why surrounding <code>&quot;Cells(LR + 1, 10)&quot;</code> by <code>&quot;&quot;</code> dosn&#39;t make sense but you still have them. Also <code>&quot;0&quot;</code> is a string not a number <code>0</code>. Make sure to copy my code <b>exactly</b>"}, {"owner": {"reputation": 2784, "user_id": 7256873, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/97aae59e027906195415adc6797340f2?s=128&d=identicon&r=PG&f=1", "display_name": "AK88", "link": "https://stackoverflow.com/users/7256873/ak88"}, "edited": false, "score": 0, "creation_date": 1517391887, "post_id": 48536808, "comment_id": 84072961, "body": "I did exactly what you wrote and ... seems like it opened up a different set of problems. Updated my question with Update2"}], "tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": true, "score": 1, "last_activity_date": 1517387169, "last_edit_date": 1517387169, "creation_date": 1517383978, "answer_id": 48536808, "question_id": 48535436, "link": "https://stackoverflow.com/questions/48535436/solveroptions-how-to-find-the-parameter-position-assumenonneg/48536808#48536808", "title": "SolverOptions: How to find the parameter position (AssumeNonNeg)?", "body": "<p>Your issue probably is that </p>\n\n<pre><code>SolverOptions MaxTime:=0, Iterations:=0, Precision:=0.000001, Convergence:= _\n    0.0001, StepThru:=False, Scaling:=True, AssumeNonNeg:=True, Derivatives:=1\nSolverOptions PopulationSize:=100, RandomSeed:=0, MutationRate:=0.075, Multistart _\n    :=False, RequireBounds:=True, MaxSubproblems:=0, MaxIntegerSols:=0, _\n    IntTolerance:=1, SolveWithout:=False, MaxTimeNoImp:=30\n</code></pre>\n\n<p>is not the same as</p>\n\n<pre><code>Application.Run \"SolverOptions\", 0, 0, 0.000001, 0.0001, False, False, False, 1\nApplication.Run \"SolverOptions\", 100, 0, 0.075, False, True, 0, 0, 1, False, 30\n</code></pre>\n\n<h3>Why is this so?</h3>\n\n<p>In the first case you specify each parameter by it's name (eg <code>MaxTime:=0</code>). Therefore it doesn't matter in which order these parameters are.</p>\n\n<p>But in the second case you cannot specify the parameters by name, so you have to specify them by their order. Therefore (according to the documentation of the the <a href=\"https://msdn.microsoft.com/en-us/vba/excel-vba/articles/solveroptions-function\" rel=\"nofollow noreferrer\">SolverOptions Function</a>) the order of the parameters is always the same <code>MaxTime, Iterations, Precision, \u2026</code>. If you now call the <code>SolverOptions</code> function twice you call them with the same parameters but different values.</p>\n\n<p>Here you need to submit all parameters (in their correct order) in <strong>one single</strong> function call:</p>\n\n<pre><code>SolverOptions(MaxTime, Iterations, Precision, AssumeLinear, StepThru, Estimates, Derivatives, SearchOption, IntTolerance, Scaling, Convergence, AssumeNonNeg, PopulationSize, RandomSeed, MultiStart, RequireBounds, MutationRate, MaxSubproblems, MaxIntegerSols, SolveWithout, MaxTimeNoImp)\n</code></pre>\n\n<p>in your case</p>\n\n<pre><code>Application.Run \"SolverOptions\", MaxTime, Iterations, Precision, AssumeLinear, StepThru, Estimates, Derivatives, SearchOption, IntTolerance, Scaling, Convergence, AssumeNonNeg, PopulationSize, RandomSeed, MultiStart, RequireBounds, MutationRate, MaxSubproblems, MaxIntegerSols, SolveWithout, MaxTimeNoImp\n'instead of the parameter names put in your values:\nApplication.Run \"SolverOptions\", 0, 0, 0.000001, False, False, 1, 1, 1, 1, True, 0.0001, True, 100, 0, False, True, 0.075, 0, 0, False, 30\n'I replaced the missing parameter values with their default due to the documentation.\n'Note that the values are re-ordered due to the correct parameter order\n</code></pre>\n\n<p>You need to set a value for <strong>every</strong> parameter in this list if you need them or not, you cannot omit one, otherwise the order gets disordered.</p>\n\n<hr>\n\n<p>The same issue in <code>SolverOK</code></p>\n\n<pre><code>SolverOk SetCell:=\"$J$59\", MaxMinVal:=3, ValueOf:=0, ByChange:=\"$N$4:$Q$4\", _\n    Engine:=1, EngineDesc:=\"GRG Nonlinear\"\n</code></pre>\n\n<p>is not the same as </p>\n\n<pre><code>Application.Run \"SolverOK\", \"Cells(LR + 1, 10)\", 3, \"0\", \"$N$4:$Q$4\"\n</code></pre>\n\n<p>especially when you surround that <code>\"Cells(LR + 1, 10)\"</code> by <code>\"\"</code> it is a string and does not get evaluated as VBA code as expected.</p>\n\n<p>According to the documentation of the <a href=\"https://msdn.microsoft.com/en-us/vba/excel-vba/articles/solverok-function\" rel=\"nofollow noreferrer\">SolverOk Function</a> the order of the parameters is </p>\n\n<pre><code>SolverOk(SetCell, MaxMinVal, ValueOf, ByChange, Engine, EngineDesc)\n</code></pre>\n\n<p>and this should result in something like:</p>\n\n<pre><code>Application.Run \"SolverOK\", Cells(LR + 1, 10), 3, 0, \"$N$4:$Q$4\", 1, \"GRG Nonlinear\"\n</code></pre>\n"}], "owner": {"reputation": 2784, "user_id": 7256873, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/97aae59e027906195415adc6797340f2?s=128&d=identicon&r=PG&f=1", "display_name": "AK88", "link": "https://stackoverflow.com/users/7256873/ak88"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1327, "favorite_count": 0, "accepted_answer_id": 48536808, "answer_count": 1, "score": 2, "last_activity_date": 1517392377, "creation_date": 1517378374, "last_edit_date": 1517392377, "question_id": 48535436, "link": "https://stackoverflow.com/questions/48535436/solveroptions-how-to-find-the-parameter-position-assumenonneg", "title": "SolverOptions: How to find the parameter position (AssumeNonNeg)?", "body": "<p>I have been trying to run a VBA code with Solver problem without manually ticking the box in the <code>References</code> section of the <code>Tools</code> category on VB Editor. In order to do so, I will have to add <code>Application.Run</code> to the lines where I have a Solver function. The following is my code when I run the macro manually:</p>\n\n<pre><code>SolverOK SetCell:=Cells(LR + 1, 10), MaxMinVal:=3, ValueOf:=\"0\", ByChange:=\"$N$4:$Q$4\"\nSolverSolve True\n</code></pre>\n\n<p>And this has been converted to:</p>\n\n<pre><code> Application.Run \"SolverOK\", \"Cells(LR + 1, 10)\", 3, \"0\", \"$N$4:$Q$4\"\n Application.Run \"SolverOptions\", 0, 0, 0.000001, 0.0001, False, False, False, 1\n Application.Run \"SolverOptions\", 100, 0, 0.075, False, True, 0, 0, 1, False, 30\n Application.Run \"SolverSolve\", True\n</code></pre>\n\n<p>But the code is still missing the <code>AssumeNonNeg</code> parameter for some reason. I want the solution to include negatives and making it equal to <code>False</code>. No dice ...</p>\n\n<p>Here is the macro that I recorded manually:</p>\n\n<pre><code>SolverOk SetCell:=\"$J$59\", MaxMinVal:=3, ValueOf:=0, ByChange:=\"$N$4:$Q$4\", _\n        Engine:=1, EngineDesc:=\"GRG Nonlinear\"\n    SolverOptions MaxTime:=0, Iterations:=0, Precision:=0.000001, Convergence:= _\n        0.0001, StepThru:=False, Scaling:=True, AssumeNonNeg:=True, Derivatives:=1\n    SolverOptions PopulationSize:=100, RandomSeed:=0, MutationRate:=0.075, Multistart _\n        :=False, RequireBounds:=True, MaxSubproblems:=0, MaxIntegerSols:=0, _\n        IntTolerance:=1, SolveWithout:=False, MaxTimeNoImp:=30\n    SolverSolve\n</code></pre>\n\n<p>Cannot figure out what exactly am I doing wrong. Thank you for taking a look at my question.</p>\n\n<p>I have Windows 10, MS Office 2013 and the files are MS Excel 97-2003.</p>\n\n<p><strong>Update:</strong></p>\n\n<pre><code>Application.Run \"SolverOK\", \"Cells(LR + 1, 10)\", 3, \"0\", \"$N$4:$Q$4\", 1, \"GRG Nonlinear\"\nApplication.Run \"SolverOptions\", 0, 0, 0.000001, False, False, 1, 1, 1, 1, True, 0.0001, False, 100, 0, False, True, 0.075, 0, 0, False, 30\n\nApplication.Run \"SolverSolve\", True\n</code></pre>\n\n<p><strong>Update2:</strong></p>\n\n<p>Tried copying @Peh's code exactly. It did work for a single file. However, when I run it for other similar files via shell (using VBS), I am getting <code>Run-time error 1004: cannot run the macro 'solverOK'</code>. Searching the web gave the following link -- <a href=\"https://stackoverflow.com/questions/21968981/vba-runtime-error-1004-using-solver\">VBA: Runtime error 1004 using Solver</a></p>\n\n<p>Included <code>Application.Run \"SolverReset\", True</code> at the beginning and got the same error <code>Run-time error 1004: cannot run the macro 'solverReset. The macro may not be available in this workbook...'</code> </p>\n"}, {"tags": ["vba", "outlook"], "answers": [{"tags": [], "owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "is_accepted": true, "score": 0, "last_activity_date": 1517380565, "creation_date": 1517380565, "answer_id": 48535905, "question_id": 48535243, "link": "https://stackoverflow.com/questions/48535243/not-getting-the-outlook-mapifolder-reference-in-vba-project/48535905#48535905", "title": "Not getting the Outlook.MAPIFolder reference in VBA project", "body": "<p><strong><em><a href=\"https://msdn.microsoft.com/en-us/library/microsoft.office.interop.outlook.mapifolder(v=office.12).aspx\" rel=\"nofollow noreferrer\">Per MSDN - MAPIFolder interface</a></strong> is deprecated Instead use the interface <strong><a href=\"https://msdn.microsoft.com/en-us/library/microsoft.office.interop.outlook.folder(v=office.12).aspx\" rel=\"nofollow noreferrer\">Folder</a></strong> to access all method, property, and event members of the COM object <strong><a href=\"https://msdn.microsoft.com/en-us/library/microsoft.office.interop.outlook.folder.aspx\" rel=\"nofollow noreferrer\">Folder</a></strong>, I believe Office 2003 and below Versions use <strong><a href=\"https://msdn.microsoft.com/en-us/library/microsoft.office.interop.outlook.mapifolderevents_12_event.aspx\" rel=\"nofollow noreferrer\">MAPIFolder</a></em></strong></p>\n\n<p><strong><em><a href=\"https://msdn.microsoft.com/en-us/library/office/aa210948(v=office.11).aspx\" rel=\"nofollow noreferrer\">MAPIFolder Object</a></em></strong></p>\n"}], "owner": {"reputation": 10875, "user_id": 145682, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/e90f935b2cbce2f47b0c8e52927cc2a3?s=128&d=identicon&r=PG", "display_name": "deostroll", "link": "https://stackoverflow.com/users/145682/deostroll"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1932, "favorite_count": 0, "accepted_answer_id": 48535905, "answer_count": 1, "score": 1, "last_activity_date": 1593248843, "creation_date": 1517377503, "last_edit_date": 1593248843, "question_id": 48535243, "link": "https://stackoverflow.com/questions/48535243/not-getting-the-outlook-mapifolder-reference-in-vba-project", "title": "Not getting the Outlook.MAPIFolder reference in VBA project", "body": "<p>I am using outlook 2016. The VBA editor gives intellisense for stuff in the Outlook namespace. However, MAPIFolder is not available. </p>\n\n<p><a href=\"https://i.stack.imgur.com/aIJ0a.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/aIJ0a.png\" alt=\"enter image description here\"></a></p>\n\n<p>My first thought, was that it could be a reference problem. Hence checked Tools > References. I only see some IMAPI references.</p>\n\n<p><a href=\"https://i.stack.imgur.com/mOV1j.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/mOV1j.png\" alt=\"enter image description here\"></a></p>\n\n<p>However, adding them did not solve the issue. Further, I thought there must be some dll that does the trick. Hence, googled, and got mapi32.dll. It usually resides in the System32 folder. However, VBA doesn't allow to add that either...</p>\n\n<p>What is the correct reference I must add? How to solve this issue?</p>\n"}]