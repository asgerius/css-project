[{"tags": ["html", "excel", "vba", "internet-explorer", "checkbox"], "comments": [{"owner": {"reputation": 9743, "user_id": 2127508, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24b1d5bcb39ec4baad76d20c66506318?s=128&d=identicon&r=PG", "display_name": "barrowc", "link": "https://stackoverflow.com/users/2127508/barrowc"}, "edited": false, "score": 0, "creation_date": 1486599959, "post_id": 42125623, "comment_id": 71420365, "body": "I don&#39;t think that <code>And ele.Title Like &quot;Select &quot;Basic Access - Computer Logon&quot;&quot;</code> would even compile. Double quotes within a string need to be escaped by putting two double quotes in a row, like this: <code>And ele.Title Like &quot;Select &quot;&quot;Basic Access - Computer Logon&quot;&quot;&quot; Then</code>"}, {"owner": {"reputation": 1028, "user_id": 4763040, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94ab3b2b5edba4e93273a52e170bfccd?s=128&d=identicon&r=PG&f=1", "display_name": "user4749485", "link": "https://stackoverflow.com/users/4763040/user4749485"}, "edited": false, "score": 0, "creation_date": 1486622704, "post_id": 42125623, "comment_id": 71426934, "body": "Set objinputs = aExplorer.document.getElementsByTagName(&quot;<b>input</b>&quot;)"}], "answers": [{"tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": false, "score": 1, "last_activity_date": 1530511740, "creation_date": 1530511740, "answer_id": 51129976, "question_id": 42125623, "link": "https://stackoverflow.com/questions/42125623/vba-checking-checkbox-in-ie/51129976#51129976", "title": "VBA - Checking Checkbox in IE", "body": "<p>Try</p>\n\n<pre><code>aExplorer.document.forms(\"main\").getElementsByName (\"name=\"\"ApplicationSearchGroupsSelect_0\"\"\")(0)\n</code></pre>\n\n<p>Or,</p>\n\n<pre><code>aExplorer.document.getElementsByTagName(\"form\")(0).getElementsByName (\"name=\"\"ApplicationSearchGroupsSelect_0\"\"\")(0)\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 5088629, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-_gG9g6dePqY/AAAAAAAAAAI/AAAAAAAAAWA/1Neyrt6Fq3M/photo.jpg?sz=128", "display_name": "StevenB", "link": "https://stackoverflow.com/users/5088629/stevenb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 807, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1530511740, "creation_date": 1486596963, "last_edit_date": 1486611910, "question_id": 42125623, "link": "https://stackoverflow.com/questions/42125623/vba-checking-checkbox-in-ie", "title": "VBA - Checking Checkbox in IE", "body": "<p>I'm attempting to check a checkbox on a website.</p>\n\n<p>Checkbox HTML:</p>\n\n<pre><code>&lt;input name=\"ApplicationSearchGroupsSelect_0\" title='Select \"Basic Access - Computer Logon\"' type=\"checkbox\" value=\"1\"&gt;\n</code></pre>\n\n<p>HTML Above Checkbox:</p>\n\n<pre><code>&lt;form name=\"main\" id=\"main\" onkeypress=\"return imOnKeyPress(event)\" action=\"?facesViewId=/app/page/screen/standard_search.jsp\" method=\"post\"&gt;\n</code></pre>\n\n<p><strong>Code</strong>:</p>\n\n<pre><code>Set objinputs = aExplorer.document.getElementsByTagName(\"form\")\nFor Each ele In objinputs\n    If ele.Name Like \"ApplicationSearchGroupsSelect_0\" And ele.Title Like \"Select \"Basic Access - Computer Logon\"\" Then\n        ele.Focus\n        ele.Click\n        ele.Selected = True\n        ele.Checked = True\n        ele.FireEvent \"onkeypress\"\n        End If\n    Next\n\n    Do While aExplorer.Busy\n        Application.Wait DateAdd(\"s\", 1, Now)\n    Loop\n\n    aExplorer.document.getElementById(\"main\").FireEvent (\"onkeypress\")\n    Do While aExplorer.Busy\n        Application.Wait DateAdd(\"s\", 1, Now)\n    Loop\n</code></pre>\n\n<p>Nothing happens when I try to run this code (no error message, code completes running and nothing is checked). Beyond firing the javascript event, trying to click the button, check the checkbox, make selected=true, I don't know how to click this checkbox and hours of scouring the web hasn't returned anything. I've also tried changing the value to 0,1,2 and nothing occurs.</p>\n\n<p>Any ideas on how to check a checkbox outside of what I've tried? Thanks!</p>\n"}, {"tags": ["vba", "ms-word"], "answers": [{"comments": [{"owner": {"reputation": 37, "user_id": 7521576, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3437faf240cfcd70c55458d4d5836d39?s=128&d=identicon&r=PG&f=1", "display_name": "ahumble_bumblebee", "link": "https://stackoverflow.com/users/7521576/ahumble-bumblebee"}, "edited": false, "score": 1, "creation_date": 1486603487, "post_id": 42126566, "comment_id": 71421275, "body": "Bingo. Thanks @A.S.H . What I was thinking was opening an instance of Excel, then loading the files in there one after the other, would that not be faster?"}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "reply_to_user": {"reputation": 37, "user_id": 7521576, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3437faf240cfcd70c55458d4d5836d39?s=128&d=identicon&r=PG&f=1", "display_name": "ahumble_bumblebee", "link": "https://stackoverflow.com/users/7521576/ahumble-bumblebee"}, "edited": false, "score": 0, "creation_date": 1486603725, "post_id": 42126566, "comment_id": 71421342, "body": "That&#39;s probable, you can open all the workbooks and close at once the application at the end with <code>objExcel.Quit False</code>. But that&#39;s memory consuming; it all depends on the number and size of the workbooks."}], "tags": [], "owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "is_accepted": true, "score": 1, "last_activity_date": 1486602896, "creation_date": 1486602896, "answer_id": 42126566, "question_id": 42125513, "link": "https://stackoverflow.com/questions/42125513/copy-and-paste-named-ranges-from-excel-workbooks-into-one-word-document/42126566#42126566", "title": "copy and paste named ranges from excel workbooks into one word document", "body": "<p>You're opening the same file every time </p>\n\n<blockquote>\n  <p><code>Set exWb = objExcel.Workbooks.Open(.SelectedItems(1))</code></p>\n</blockquote>\n\n<p>That's why <em>all it does is paste the same range (i.e. from one workbook) multiple times</em>. Change to:</p>\n\n<pre><code>Set exWb = objExcel.Workbooks.Open(vrtSelectedItem)\n</code></pre>\n\n<p>And you'll get a different workbook every time.</p>\n\n<p>Regarding the question about a \"more elegant way\", you <em>need</em> to open and close each and every workbook to copy from, so keep it that way.</p>\n"}], "owner": {"reputation": 37, "user_id": 7521576, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3437faf240cfcd70c55458d4d5836d39?s=128&d=identicon&r=PG&f=1", "display_name": "ahumble_bumblebee", "link": "https://stackoverflow.com/users/7521576/ahumble-bumblebee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 142, "favorite_count": 0, "accepted_answer_id": 42126566, "answer_count": 1, "score": 1, "last_activity_date": 1486603137, "creation_date": 1486596306, "last_edit_date": 1486603137, "question_id": 42125513, "link": "https://stackoverflow.com/questions/42125513/copy-and-paste-named-ranges-from-excel-workbooks-into-one-word-document", "title": "copy and paste named ranges from excel workbooks into one word document", "body": "<p>I am programming a command button in word that copies and pastes (as a picture) a named range from multiple excel spreadsheets into the same (open) word document. With some help from here, I got it to work for a single excel file, but when I try to modify the code for multiple selection, all it does is paste the same range (i.e. from one workbook) multiple times. \nAlso, there must be a more elegant (read: faster) way than to keep opening and closing excel to copy the range...</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n  Dim objExcel As New Excel.Application, exWb As Workbook\n    With Application.FileDialog(msoFileDialogFilePicker)\n      .Title = \"Select Risk Assessment Files\"\n      .Filters.Add \"Macro-Enabled Excel Files\", \"*.xlsm\"\n      .AllowMultiSelect = True\n\n    If .Show &lt;&gt; -1 Then Exit Sub\n    For Each vrtSelectedItem In .SelectedItems\n      Set exWb = objExcel.Workbooks.Open(.SelectedItems(1))\n      '*** Use the values from excel here***\n      exWb.Sheets(\"Risk Assessment\").Range(\"CRA\").CopyPicture_\n         Appearance:=xlScreen, Format:=xlPicture\n\n      '*** Close the opened Excel file\n      exWb.Close Savechanges:=False\n      Set exWb = Nothing\n      Selection.EndKey Unit:=wdStory\n      Selection.Paste\n\n    Next vrtSelectedItem\n  End With\n  Selection.GoTo What:=wdGoToBookmark, Name:=\"insertbutton\"\n  MsgBox (\"Done\")\nEnd Sub\n</code></pre>\n\n<p>Thanks for your help...</p>\n"}, {"tags": ["excel", "vba", "sumifs"], "comments": [{"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 1, "creation_date": 1486596496, "post_id": 42125408, "comment_id": 71419185, "body": "The <code>{&quot;Dog&quot;,&quot;Cat&quot;}</code> string is a <i>string</i>, not an array.  Passing a string, even if it resembles an array, is still a string not an array, so won&#39;t work.  You say you have a VBA function that returns a comma separated list into a cell.  Try changing that to return an array, and calling it in your <code>SUMIFS</code> formula (bypassing returning the list to a cell)"}, {"owner": {"reputation": 1593, "user_id": 4162402, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/Mu78S.png?s=128&g=1", "display_name": "Nick Criswell", "link": "https://stackoverflow.com/users/4162402/nick-criswell"}, "reply_to_user": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 0, "creation_date": 1486597578, "post_id": 42125408, "comment_id": 71419557, "body": "Thanks @chrisneilsen. The function I&#39;m using is a lot like the one in example 2 of the answer listed <a href=\"http://stackoverflow.com/questions/22542834/how-to-use-regular-expressions-regex-in-microsoft-excel-both-in-cell-and-loops\">here</a>. I tried to follow the example <a href=\"http://stackoverflow.com/questions/1815980/excel-vba-function-returning-an-array\">here</a> to return a collection but I am getting an error for &#39;argument not optional&#39; on my output. Any thoughts on how to make sure my function returns the array as desired?"}, {"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 0, "creation_date": 1486597735, "post_id": 42125408, "comment_id": 71419617, "body": "If you post the code and a description of what you want the function to de I can help"}], "answers": [{"comments": [{"owner": {"reputation": 1593, "user_id": 4162402, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/Mu78S.png?s=128&g=1", "display_name": "Nick Criswell", "link": "https://stackoverflow.com/users/4162402/nick-criswell"}, "edited": false, "score": 1, "creation_date": 1486597996, "post_id": 42125766, "comment_id": 71419726, "body": "I was just thinking after my comment to @chris neilson, &quot;Hey, why don&#39;t I just write a VBA function to split a cell string into an array!?&quot; You read my mind. Thank you! This works splendidly."}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "reply_to_user": {"reputation": 1593, "user_id": 4162402, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/Mu78S.png?s=128&g=1", "display_name": "Nick Criswell", "link": "https://stackoverflow.com/users/4162402/nick-criswell"}, "edited": false, "score": 0, "creation_date": 1486598165, "post_id": 42125766, "comment_id": 71419788, "body": "@NickCriswell That&#39;s great. Glad to know it helped :)"}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "reply_to_user": {"reputation": 1593, "user_id": 4162402, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/Mu78S.png?s=128&g=1", "display_name": "Nick Criswell", "link": "https://stackoverflow.com/users/4162402/nick-criswell"}, "edited": false, "score": 1, "creation_date": 1486598230, "post_id": 42125766, "comment_id": 71419818, "body": "By the way, this answer granted me the moderator tools, thank you!!"}, {"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "reply_to_user": {"reputation": 1593, "user_id": 4162402, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/Mu78S.png?s=128&g=1", "display_name": "Nick Criswell", "link": "https://stackoverflow.com/users/4162402/nick-criswell"}, "edited": false, "score": 1, "creation_date": 1486598404, "post_id": 42125766, "comment_id": 71419880, "body": "@NickCriswell Unless you have other uses for the csv list, I still think returning an array rather than a csv list is a better solution"}, {"owner": {"reputation": 1593, "user_id": 4162402, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/Mu78S.png?s=128&g=1", "display_name": "Nick Criswell", "link": "https://stackoverflow.com/users/4162402/nick-criswell"}, "reply_to_user": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 1, "creation_date": 1486598643, "post_id": 42125766, "comment_id": 71419963, "body": "@chrisneilsen, yes, I am going to modify my code so it does the string split before the return-eventually. Your comments and the answer certainly pointed me in the right direction on this one. Appreciate the help."}, {"owner": {"reputation": 1593, "user_id": 4162402, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/Mu78S.png?s=128&g=1", "display_name": "Nick Criswell", "link": "https://stackoverflow.com/users/4162402/nick-criswell"}, "edited": false, "score": 0, "creation_date": 1486661172, "post_id": 42125766, "comment_id": 71452317, "body": "Any idea why this would be returning the SUMIF only subject to the first criteria in the CSV/array? This seems to be occurring."}, {"owner": {"reputation": 1593, "user_id": 4162402, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/Mu78S.png?s=128&g=1", "display_name": "Nick Criswell", "link": "https://stackoverflow.com/users/4162402/nick-criswell"}, "edited": false, "score": 0, "creation_date": 1486661849, "post_id": 42125766, "comment_id": 71452772, "body": "I found the solution to the question I was asking. Once you use the <code>splitCSV</code> function, this all needs to be returned as a Ctrol+Shift+Enter formula rather than a regular spreadsheet function. Guess I should have known that. Thanks!"}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "reply_to_user": {"reputation": 1593, "user_id": 4162402, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/Mu78S.png?s=128&g=1", "display_name": "Nick Criswell", "link": "https://stackoverflow.com/users/4162402/nick-criswell"}, "edited": false, "score": 1, "creation_date": 1486668962, "post_id": 42125766, "comment_id": 71456915, "body": "@NickCriswell sorry for not mentioning it before. Anyway, indeed, you can have it as a normal (non-array) formula by replacing <code>SUM</code> with <code>SUMPRODUCT</code>. The latter when fed a single array will act just like the former but without needing to be an array formula. It&#39;s a fantastic tool in this kind of situations."}, {"owner": {"reputation": 1593, "user_id": 4162402, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/Mu78S.png?s=128&g=1", "display_name": "Nick Criswell", "link": "https://stackoverflow.com/users/4162402/nick-criswell"}, "edited": false, "score": 1, "creation_date": 1486671365, "post_id": 42125766, "comment_id": 71458363, "body": "@A.S.H, thanks for the heads up on the <code>SUMPRODUCT</code> switch. This seems to be improving the performance compared to the CSE function with <code>SUM</code>."}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1486671846, "post_id": 42125766, "comment_id": 71458626, "body": "Yes I expect that, because instead of first computing an array and then summing it up, it multiplies and sums in one go. That&#39;s my proper opinion though,  it is not an admitted fact."}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 1, "creation_date": 1486672041, "post_id": 42125766, "comment_id": 71458743, "body": "I feel that I have to edit the answer to use <code>SUMPRODUCT</code>. That should be the fully correct answer I think."}], "tags": [], "owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "is_accepted": true, "score": 1, "last_activity_date": 1486673184, "last_edit_date": 1486673184, "creation_date": 1486597697, "answer_id": 42125766, "question_id": 42125408, "link": "https://stackoverflow.com/questions/42125408/excel-sumifs-multiple-criteria-cell-value/42125766#42125766", "title": "Excel SUMIFS Multiple Criteria Cell Value", "body": "<p>Seems that the raw comma-separated criteria is in <code>G6</code>, All you need is to split this criteria into an array and feed it to <code>SUMIFS</code>. Splitting is available in VBA,  but not exposed to Excel. All we need is to write a little UDF that does the splitting of the CSV and use it in our formula:</p>\n\n<pre><code>Function splitCSV(str As String)\n    splitCSV = Split(str, \",\")\nEnd Function\n</code></pre>\n\n<p>Now the formula in <code>F10</code> would be:</p>\n\n<pre><code>=SUM(SUMIFS(C3:C10, B3:B10, \"blue\", A3:A10, splitCSV(G6)))\n</code></pre>\n\n<p>EDIT</p>\n\n<p>The above is an array formula (Ctrl+Shift+Enter). To have it a normal formula we can use <code>SUMPRODUCT</code> instead of <code>SUM</code>. This leads to more flexibility (normal formula vs array formula) as well as some \"expected\" performance improvement.</p>\n\n<pre><code>=SUMPRODUCT(SUMIFS(C3:C10, B3:B10, \"blue\", A3:A10, splitCSV(G6)))\n</code></pre>\n"}], "owner": {"reputation": 1593, "user_id": 4162402, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/Mu78S.png?s=128&g=1", "display_name": "Nick Criswell", "link": "https://stackoverflow.com/users/4162402/nick-criswell"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1197, "favorite_count": 0, "accepted_answer_id": 42125766, "answer_count": 1, "score": 2, "last_activity_date": 1486673184, "creation_date": 1486595631, "last_edit_date": 1495539923, "question_id": 42125408, "link": "https://stackoverflow.com/questions/42125408/excel-sumifs-multiple-criteria-cell-value", "title": "Excel SUMIFS Multiple Criteria Cell Value", "body": "<p><a href=\"https://stackoverflow.com/questions/39181858/excel-sumifs-of-cells-based-upon-multiple-criteria\">Similar</a> <a href=\"https://stackoverflow.com/questions/6828814/excel-sumif-with-multiple-criterias\">questions</a> to this have been asked but not exactly like this. There is <a href=\"https://stackoverflow.com/questions/41348112/sumifs-with-multiple-criteria-variable\">one</a> that is very close, but that solution is not working for me. </p>\n\n<p>I have a function which returns comma separated values into a cell. I would like to pass the elements in that cell as criteria to a <code>SUMIFS</code> function using an approach like this <a href=\"https://exceljet.net/formula/sumifs-with-multiple-criteria-and-or-logic\" rel=\"nofollow noreferrer\">one</a>. </p>\n\n<p>My attempt is pictured below:</p>\n\n<p><a href=\"https://i.stack.imgur.com/08eJa.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/08eJa.png\" alt=\"enter image description here\"></a></p>\n\n<p>I believe that this is somehow tied to the way that the function is understanding what is in cell G8. It looks like it is adding some extra quotes. If I highlight G8 in the formula bar and press F9, I get:</p>\n\n<p><a href=\"https://i.stack.imgur.com/BmwPL.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/BmwPL.png\" alt=\"enter image description here\"></a></p>\n\n<p>There are extra quotes on each side of each criteria. </p>\n\n<p>I am open to a custom VBA function solution, but I would prefer something which can be built as a worksheet function. The criteria are returned from a custom VBA function that pulls elements out of a list box and does some regex work to remove extra commas. The number of elements that can be selected is variable so I would like to avoid having to split the criteria into more than one cell. Thanks. </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1486595578, "post_id": 42125258, "comment_id": 71418882, "body": "What line does the error occur on?"}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 1, "creation_date": 1486595722, "post_id": 42125258, "comment_id": 71418934, "body": "<code>While Len(OrderNumber) &lt; 6 Or Len(OrderNumber) &gt; 6</code>... VBA has the <code>&lt;&gt;</code> operator...."}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1486596005, "post_id": 42125258, "comment_id": 71419027, "body": "Very difficult to track your code. Either post a more complete problem description or, better, try to minimize it so we can better understand what you want to achieve."}, {"owner": {"reputation": 9743, "user_id": 2127508, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24b1d5bcb39ec4baad76d20c66506318?s=128&d=identicon&r=PG", "display_name": "barrowc", "link": "https://stackoverflow.com/users/2127508/barrowc"}, "edited": false, "score": 1, "creation_date": 1486599458, "post_id": 42125258, "comment_id": 71420228, "body": "<code>numentries = Worksheets(Sheet1).UsedRange.Rows.Count</code> is wrong. It should be <code>numentries = Worksheets(&quot;Sheet1&quot;).UsedRange.Rows.Count</code>"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1486601047, "post_id": 42125258, "comment_id": 71420662, "body": "Also, what is <code>Cell</code>? <code>= InStr(1, Cell, OrderNumber, vbTextCompare)) Then ...</code>"}, {"owner": {"reputation": 308, "user_id": 2199816, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/nMp9M.jpg?s=128&g=1", "display_name": "Travis", "link": "https://stackoverflow.com/users/2199816/travis"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1486645275, "post_id": 42125258, "comment_id": 71440893, "body": "@BruceWayne copy/pasted it from somewhere.  I probably need to remove <code>Cell</code> from that."}, {"owner": {"reputation": 308, "user_id": 2199816, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/nMp9M.jpg?s=128&g=1", "display_name": "Travis", "link": "https://stackoverflow.com/users/2199816/travis"}, "reply_to_user": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1486645431, "post_id": 42125258, "comment_id": 71441008, "body": "@A.S.H minimized it just to the code I&#39;m looking to improve upon."}], "answers": [{"tags": [], "owner": {"reputation": 96, "user_id": 6728643, "user_type": "registered", "profile_image": "https://graph.facebook.com/10207032731592763/picture?type=large", "display_name": "Craig Gross", "link": "https://stackoverflow.com/users/6728643/craig-gross"}, "is_accepted": true, "score": 1, "last_activity_date": 1486601040, "creation_date": 1486601040, "answer_id": 42126295, "question_id": 42125258, "link": "https://stackoverflow.com/questions/42125258/excel-vba-find-all-values-in-row-and-save-different-column-values-to-variables/42126295#42126295", "title": "Excel VBA find all values in row and save different column values to variables", "body": "<p>I recommend using a multidimensional array. If you've never used arrays before, I strongly suggest reading up on them. </p>\n\n<pre><code>Sub GatherData()\nDim c As Range\nDim aGetData() As Variant 'This is our array\nDim i As Integer\nDim a As Integer\nDim iRowCount As Integer\nDim sRange As String\n\n'Gather data\niRowCount = Worksheets(\"Sheet1\").UsedRange.Rows.Count\nFor Each c In Range(\"A2:A\" &amp; iRowCount)\n  If c.Value = 636779 Then\n    ReDim Preserve aGetData(2, i) 'An array must have a set size but as we\n    'do not know how many order numbers will be found we have to 'resize'\n    'the array to account for how many we do find. Using \"ReDim Preserve\" \n    'keeps any data we have placed into the array while at the same time\n    'changing it's size.\n    For a = 0 To 2 'Our first index will hold each col of data that is why\n                   'it is set to 2 (arrays start at a base of zero, so\n                   '0,1,2 will be each col(A,B,C)\n      aGetData(a, i) = c.Offset(0, a) 'This gets each value from col A,B and C\n    Next a\n    i = i + 1 'Increment for array in case we find another order number\n              'Our second index \"aGetData(index1,index2) is being resized \n              'this represents each order number found on the sheet\n  End If\nNext c\n\n'How to read the array\nFor i = 0 To UBound(aGetData())\n  For a = 0 To 2\n    Debug.Print aGetData(a, i)\n  Next a\nNext i\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 308, "user_id": 2199816, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/nMp9M.jpg?s=128&g=1", "display_name": "Travis", "link": "https://stackoverflow.com/users/2199816/travis"}, "edited": false, "score": 0, "creation_date": 1486667890, "post_id": 42138920, "comment_id": 71456309, "body": "Thank you for the answer.  I had already started working on adapting Craig&#39;s answer and got it working so I didn&#39;t attempt yours."}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "reply_to_user": {"reputation": 308, "user_id": 2199816, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/nMp9M.jpg?s=128&g=1", "display_name": "Travis", "link": "https://stackoverflow.com/users/2199816/travis"}, "edited": false, "score": 1, "creation_date": 1486668210, "post_id": 42138920, "comment_id": 71456508, "body": "@Travis You are welcome. Be aware however that <code>ReDim</code>ing an array as it grows element by element is something to avoid wherever possible; as it can get very slow for large data."}], "tags": [], "owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "is_accepted": false, "score": 1, "last_activity_date": 1486650451, "last_edit_date": 1486650451, "creation_date": 1486649464, "answer_id": 42138920, "question_id": 42125258, "link": "https://stackoverflow.com/questions/42125258/excel-vba-find-all-values-in-row-and-save-different-column-values-to-variables/42138920#42138920", "title": "Excel VBA find all values in row and save different column values to variables", "body": "<p>It seems that the <code>OrderNumber</code> (column <code>A</code>) is sorted. Very good news (if they're not, just sort them ;) ). This simple function will get you the <code>ItemNumber</code>s and <code>QtyOrdered</code> into a bi-dimensional array, where each row is a pair of them.</p>\n\n<pre><code>Function ArrItemQty(ByVal OrderNumber As Long)\nWith Worksheets(\"Sheet1\").UsedRange.Offset(1)\n        .AutoFilter 1, OrderNumber\n        ArrItemQty= .Resize(, 2).Offset(, 1).SpecialCells(xlCellTypeVisible).value\n        .Parent.AutoFilterMode = False\n    End With\nEnd Function\n</code></pre>\n\n<p>And here's a little testing:</p>\n\n<pre><code>Sub Test()\n    Dim i As Long, j As Long, ar\n    ar = ArrItemQty(636779)\n    For i = LBound(ar, 1) To UBound(ar, 1)\n         Debug.Print\n         For j = LBound(ar, 2) To UBound(ar, 2): Debug.Print ar(i, j),: Next\n     Next\nEnd Sub\n</code></pre>\n\n<p>p.s. be aware that the resulting array is 1-based. Use <code>LBound</code> and <code>UBound</code> as indicated is safest.</p>\n"}], "owner": {"reputation": 308, "user_id": 2199816, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/nMp9M.jpg?s=128&g=1", "display_name": "Travis", "link": "https://stackoverflow.com/users/2199816/travis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2562, "favorite_count": 0, "accepted_answer_id": 42126295, "answer_count": 2, "score": 0, "last_activity_date": 1486650451, "creation_date": 1486594763, "last_edit_date": 1486645403, "question_id": 42125258, "link": "https://stackoverflow.com/questions/42125258/excel-vba-find-all-values-in-row-and-save-different-column-values-to-variables", "title": "Excel VBA find all values in row and save different column values to variables", "body": "<p>I've done quite a bit of searching and can't find any code that matches my situation or to a point I can modify except for one.  </p>\n\n<p>Looking at the spreadsheet below.  I want to have the user enter the <code>OrderNumber</code> then search <code>Column A</code> for every value of that number.  As it does I want it to copy the <code>ItemNumber</code> and <code>QtyOrdered</code> to two different variables in order to put them into textboxes later on.  </p>\n\n<p>I want it to \"stack\" the information into the variable so something like <code>ItemNumValues = ItemNumValues + Cell.Value</code>  </p>\n\n<p><a href=\"https://i.stack.imgur.com/COniM.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/COniM.png\" alt=\"Spreadsheet\"></a></p>\n\n<p>I tried to modify code from someone else (\"their code\") but I am getting a mismatch type error.  The rest of the code works.  There are some trace elements in the script from previous features that aren't used and I just haven't removed them yet.</p>\n\n<pre><code>'***********************************************************\n'********** Their Code Follows *****************\n'***********************************************************\n\n    Dim numentries As Integer\n    Dim i As Integer\n    '***********************************************************\n\n    'Get number of entries\n    numentries = Worksheets(Sheet1).UsedRange.Rows.Count\n    '*************************************************************\n\n    'Run loop to cycle through all entries (rows) to copy\n    For i = 1 To numentries\n\n         If (Worksheets(\"Sheet1\").Cells(i + 2, 1).Value = InStr(1, Cell, OrderNumber, vbTextCompare)) Then\n              MsgBox Test\n        End If\n\n    Next i\n\nEnd If   \n\n'***********************************************************\n'********** End Their Code *****************\n'***********************************************************\n</code></pre>\n"}, {"tags": ["html", "excel", "web-scraping", "vba"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 7537131, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/677345c34d7e34bc543bfa61b0ceea9f?s=128&d=identicon&r=PG&f=1", "display_name": "smdavies1983", "link": "https://stackoverflow.com/users/7537131/smdavies1983"}, "edited": false, "score": 0, "creation_date": 1486596041, "post_id": 42125411, "comment_id": 71419031, "body": "Hi Jeremy - I was going to try that approach and it probably does the trick. Just wondered if there was a way of directly referencing it like you can with tags and classes etc. I&#39;m building a football prediction model, and I&#39;ll use the odds to validate any profit gains. Thanks for your suggestion"}, {"owner": {"reputation": 1341, "user_id": 6512922, "user_type": "registered", "accept_rate": 87, "profile_image": "https://graph.facebook.com/1131570370198708/picture?type=large", "display_name": "Jeremy", "link": "https://stackoverflow.com/users/6512922/jeremy"}, "reply_to_user": {"reputation": 1, "user_id": 7537131, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/677345c34d7e34bc543bfa61b0ceea9f?s=128&d=identicon&r=PG&f=1", "display_name": "smdavies1983", "link": "https://stackoverflow.com/users/7537131/smdavies1983"}, "edited": false, "score": 0, "creation_date": 1486596575, "post_id": 42125411, "comment_id": 71419212, "body": "@smdavies1983 I&#39;ve tried building a scraper but my htlm isn&#39;t up to par at the moment to do it with differing page layouts etc.. have you tried the <code>innerHTML</code> property? I&#39;m kinda guessing here, not knowing your code though"}, {"owner": {"reputation": 1, "user_id": 7537131, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/677345c34d7e34bc543bfa61b0ceea9f?s=128&d=identicon&r=PG&f=1", "display_name": "smdavies1983", "link": "https://stackoverflow.com/users/7537131/smdavies1983"}, "edited": false, "score": 0, "creation_date": 1486596778, "post_id": 42125411, "comment_id": 71419283, "body": "Yeah I tried a host of different things - innertext, innerhtml. Outerhtml gave me the output closest to what I needed. Other data on the page was fine because they had defined classes or tags. But data-odd doesn&#39;t seem to be defined in the standard way and might actually be jnjected into the code using javascrips"}], "tags": [], "owner": {"reputation": 1341, "user_id": 6512922, "user_type": "registered", "accept_rate": 87, "profile_image": "https://graph.facebook.com/1131570370198708/picture?type=large", "display_name": "Jeremy", "link": "https://stackoverflow.com/users/6512922/jeremy"}, "is_accepted": false, "score": 0, "last_activity_date": 1486595656, "creation_date": 1486595656, "answer_id": 42125411, "question_id": 42124964, "link": "https://stackoverflow.com/questions/42124964/excel-vba-website-scrape/42125411#42125411", "title": "Excel VBA - Website Scrape", "body": "<p>You could declare it as a string</p>\n\n<p><code>Dim sResult as String</code></p>\n\n<p>and then derive the 5.19 value with this:</p>\n\n<p><code>sResult = Mid(sResult, InStr(sResult, \"data-odd=\"\"\") + Len(\"data-odd=\"\"\"), 4)\n</code> - this assumes that it's always 2 decimal places and it's also stored as a string rather then a double</p>\n\n<p>Out of interest, are you trying to build an arbing screener?</p>\n"}], "owner": {"reputation": 1, "user_id": 7537131, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/677345c34d7e34bc543bfa61b0ceea9f?s=128&d=identicon&r=PG&f=1", "display_name": "smdavies1983", "link": "https://stackoverflow.com/users/7537131/smdavies1983"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 411, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1486595656, "creation_date": 1486593429, "last_edit_date": 1531164843, "question_id": 42124964, "link": "https://stackoverflow.com/questions/42124964/excel-vba-website-scrape", "title": "Excel VBA - Website Scrape", "body": "<p>I have spent hours searching for the answer to this, but I can't find one.</p>\n\n<p>I am trying to extract data from this <a href=\"http://www.betexplorer.com/soccer/england/premier-league/leicester-manchester-united/G0fXjMCK/\" rel=\"nofollow noreferrer\">website</a></p>\n\n<p>I have managed to get most of what I need, but I'm finding it difficult to target a specific data point.</p>\n\n<p>The closest piece of code I've used is:</p>\n\n<pre><code> hDoc.getElementsByClassName(\"table-matches__odds\")(0).outerHTML\n</code></pre>\n\n<p>which outputs the below which isn't what I want</p>\n\n<blockquote>\n  <p>class=table-matches__odds data-odd-max=\"5.50\" data-odd=\"5.19\"</p>\n</blockquote>\n\n<p>I only want the <code>data-odd=</code> part of this, so the 5.19 but can't figure out how to target it. I could use instr to pull the data I need out of that, but is there a more specific way?</p>\n\n<p>The html looks like this for the section i'm trying to extract:</p>\n\n<pre class=\"lang-html prettyprint-override\"><code>&lt;TH class=h-text-left colSpan=8&gt;&lt;A href=\"about:/soccer/england/premier-league/\"&gt;Premier League 2016/2017&lt;/A&gt;&lt;/TH&gt;&lt;/TR&gt;\n&lt;TR data-dt=\"5,2,2017,17,00\"&gt;\n&lt;TD&gt;Leicester&lt;/TD&gt;\n&lt;TD&gt;&lt;STRONG&gt;Manchester United&lt;/STRONG&gt;&lt;/TD&gt;\n&lt;TD class=h-text-center&gt;0:3&lt;/TD&gt;\n&lt;TD class=table-matches__odds data-odd-max=\"5.50\" data-odd=\"5.19\"&gt;&lt;/TD&gt;\n&lt;TD class=table-matches__odds data-odd-max=\"4.00\" data-odd=\"3.79\"&gt;&lt;/TD&gt;\n&lt;TD class=\"table-matches__odds colored\"&gt;&lt;SPAN&gt;&lt;SPAN&gt;&lt;SPAN data-odd-max=\"1.80\" data-odd=\"1.72\"&gt;&lt;/SPAN&gt;&lt;/SPAN&gt;&lt;/SPAN&gt;&lt;/TD&gt;\n&lt;TD&gt;&lt;A href=\"about:/soccer/england/premier-league/leicester-manchester-united/G0fXjMCK/\"&gt;details&lt;/A&gt;&lt;/TD&gt;\n&lt;TD class=h-text-right&gt;05.02.2017&lt;/TD&gt;&lt;/TR&gt;\n&lt;TR data-dt=\"24,9,2016,13,30\"&gt;\n&lt;TD&gt;&lt;STRONG&gt;Manchester United&lt;/STRONG&gt;&lt;/TD&gt;\n&lt;TD&gt;Leicester&lt;/TD&gt;\n&lt;TD class=h-text-center&gt;4:1&lt;/TD&gt;\n&lt;TD class=\"table-matches__odds colored\"&gt;&lt;SPAN&gt;&lt;SPAN&gt;&lt;SPAN data-odd-max=\"1.73\" data-odd=\"1.69\"&gt;&lt;/SPAN&gt;&lt;/SPAN&gt;&lt;/SPAN&gt;&lt;/TD&gt;\n&lt;TD class=table-matches__odds data-odd-max=\"4.05\" data-odd=\"3.85\"&gt;&lt;/TD&gt;\n&lt;TD class=table-matches__odds data-odd-max=\"5.75\" data-odd=\"5.34\"&gt;&lt;/TD&gt;\n&lt;TD&gt;&lt;A href=\"about:/soccer/england/premier-league/manchester-united-leicester/dOBfynxf/\"&gt;details&lt;/A&gt;&lt;/TD&gt;\n&lt;TD class=h-text-right&gt;24.09.2016&lt;/TD&gt;&lt;/TR&gt;\n</code></pre>\n\n<p>Any help would be much appreciated</p>\n\n<p>Thanks</p>\n"}, {"tags": ["excel", "vba", "form-control", "radio-button"], "answers": [{"comments": [{"owner": {"reputation": 85, "user_id": 7370496, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/3228b7ce8618bc620f3e1c67bce9d2db?s=128&d=identicon&r=PG&f=1", "display_name": "ladymrt", "link": "https://stackoverflow.com/users/7370496/ladymrt"}, "edited": false, "score": 0, "creation_date": 1486594723, "post_id": 42125075, "comment_id": 71418539, "body": "Thank you very much! I guess this still gives me the issue of said cell changing when a row is added anyway, but seriously this issue has plagued me for a loooooong time."}], "tags": [], "owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "is_accepted": true, "score": 2, "last_activity_date": 1486593890, "creation_date": 1486593890, "answer_id": 42125075, "question_id": 42124929, "link": "https://stackoverflow.com/questions/42124929/vba-buttons-that-can-move/42125075#42125075", "title": "VBA Buttons that can Move?", "body": "<p>Just get the <code>Left</code> and <code>Top</code> properties from the Range, then pass them to <code>Checkboxes.Add</code>:</p>\n\n<pre><code>With ActiveSheet.CheckBoxes.Add(Range(\"C6\").Left, Range(\"C6\").Top, 72, 18)\n    .Name = \"firstcheckbox\"\n    .Caption = \"CLICK ME\"\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 85, "user_id": 7370496, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/3228b7ce8618bc620f3e1c67bce9d2db?s=128&d=identicon&r=PG&f=1", "display_name": "ladymrt", "link": "https://stackoverflow.com/users/7370496/ladymrt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 828, "favorite_count": 0, "accepted_answer_id": 42125075, "answer_count": 1, "score": 0, "last_activity_date": 1486593890, "creation_date": 1486593307, "question_id": 42124929, "link": "https://stackoverflow.com/questions/42124929/vba-buttons-that-can-move", "title": "VBA Buttons that can Move?", "body": "<p>I am running into a wall when it comes to adding buttons in VBA.</p>\n\n<p>I have a spreadsheet that could potentially have rows expanded or have rows added to it. Right now, the only way I know how to add buttons with a macro (i.e. when you click this button, three more buttons appear below) is with the coordinate system</p>\n\n<pre><code>With ActiveSheet.CheckBoxes.Add(185, 464, 72, 18)\n    .Name = \"firstcheckbox\"\n    .Caption = \"CLICK ME\"\nEnd With\n</code></pre>\n\n<p>However, if someone adds rows above in the form BEFORE they click the button-making button, those coordinates are no longer good and the three buttons show up higher than I'd like them.</p>\n\n<p>I've wracked my brain trying to research this. Is there some obvious way to create these buttons with a cell instead of coordinates so that it doesn't matter how many rows are added above?</p>\n\n<pre><code>With ActiveSheet.CheckBoxes.Add.Range(\"C6\")\n    .Name = \"firstcheckbox\"\n    .Caption = \"CLICK ME\"\nEnd With\n</code></pre>\n\n<p>or something like that? Or am I limited to the coordinate system?</p>\n\n<p>Any help would be greatly appreciated!</p>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 1684, "user_id": 5936117, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/KO8Gd.jpg?s=128&g=1", "display_name": "MoondogsMaDawg", "link": "https://stackoverflow.com/users/5936117/moondogsmadawg"}, "edited": false, "score": 0, "creation_date": 1486610123, "post_id": 42124832, "comment_id": 71422979, "body": "If RequestNum is an autonumber, then it&#39;s a long integer by default. Adjust the data type in your dimension and remove the single quotes from the Dlookup WHERE argument and it should work. If not, what does <code>debug.print Me.lst_AdminDate1.Column(2)</code> yield? If it&#39;s the correct ID, then try coercing to a long int with <code>RequestNum = Clng(Me.lst_AdminDate1.Column(2)</code>. If it isn&#39;t the correct ID, are you referencing the correct column? <code>.Column</code> is zero-indexed, so try <code>.Column(1)</code>."}, {"owner": {"reputation": 23, "user_id": 6316708, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4bb6b384f52ed7dad1b431cea9476c38?s=128&d=identicon&r=PG&f=1", "display_name": "Matt", "link": "https://stackoverflow.com/users/6316708/matt"}, "reply_to_user": {"reputation": 1684, "user_id": 5936117, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/KO8Gd.jpg?s=128&g=1", "display_name": "MoondogsMaDawg", "link": "https://stackoverflow.com/users/5936117/moondogsmadawg"}, "edited": false, "score": 0, "creation_date": 1486647501, "post_id": 42124832, "comment_id": 71442547, "body": "Removing single quotes and adding IDx as variant took care of the issue. Thanks for the input!"}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 6316708, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4bb6b384f52ed7dad1b431cea9476c38?s=128&d=identicon&r=PG&f=1", "display_name": "Matt", "link": "https://stackoverflow.com/users/6316708/matt"}, "edited": false, "score": 0, "creation_date": 1486648668, "post_id": 42135885, "comment_id": 71443397, "body": "This did the trick! Thanks for the answer! Learned something new about trying to use autonumber as a string also."}], "tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": true, "score": 1, "last_activity_date": 1486640779, "creation_date": 1486640779, "answer_id": 42135885, "question_id": 42124832, "link": "https://stackoverflow.com/questions/42124832/ms-access-2013-dlookup-string-criteria-issue/42135885#42135885", "title": "MS Access 2013 Dlookup String Criteria issue", "body": "<p>What may confuse you is, that a listbox always returns strings even if the value was a number and is supposed to be used as such. Also, DLookup may return <em>Null</em>. </p>\n\n<p>Thus, if <code>[RequestNumber]</code> is a Long (which is should be):</p>\n\n<pre><code>Private Sub lst_AdminDate1_DblClick(Cancel As Integer)\n\n    Dim IDx As Variant\n    Dim RequestNum As String\n\n    DoCmd.OpenForm \"Administrative_LeaveCalendar_Detail\"\n    RequestNum = Me.lst_AdminDate1.Column(2)\n    IDx = DLookup(\"[ID]\", \"TimeOffCalendar\", \"[RequestNumber] = \" &amp; RequestNum &amp; \"\")\n    [Forms]![Administrative_LeaveCalendar_Detail]![txtAdminDateDetail_RN] = RequestNum\n    [Forms]![Administrative_LeaveCalendar_Detail]![txtAdminDateDetail_ID] = IDx\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 6316708, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4bb6b384f52ed7dad1b431cea9476c38?s=128&d=identicon&r=PG&f=1", "display_name": "Matt", "link": "https://stackoverflow.com/users/6316708/matt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 200, "favorite_count": 0, "accepted_answer_id": 42135885, "answer_count": 1, "score": 0, "last_activity_date": 1486640779, "creation_date": 1486592906, "last_edit_date": 1486595843, "question_id": 42124832, "link": "https://stackoverflow.com/questions/42124832/ms-access-2013-dlookup-string-criteria-issue", "title": "MS Access 2013 Dlookup String Criteria issue", "body": "<p>It seems this problem should have a rather simplistic solution. When trying to run the dlookup for ID, I return a null value when using the RequestNum string. RequestNum is simply an AutoNumber. RequestNum does write to the popup form that is opening up on its own. Also, if i replace RequestNum with the actual number in the field I get the desired returned result. The only help I've been able to find online is that most people did not use <code>'\" &amp; stringhere &amp; \"'</code> though I obviously am. Any ideas? I'll be happy to supply any additional details if needed. Thanks in advance!</p>\n\n<pre><code>Private Sub lst_AdminDate1_DblClick(Cancel As Integer)\n    Dim IDx As String\n    Dim RequestNum As String\n    DoCmd.OpenForm \"Administrative_LeaveCalendar_Detail\"\n    RequestNum = Me.lst_AdminDate1.Column(2)\n    IDx = DLookup(\"[ID]\", \"TimeOffCalendar\", \"[RequestNumber] = '\" &amp; RequestNum &amp; \"'\")\n    [Forms]![Administrative_LeaveCalendar_Detail]![txtAdminDateDetail_RN] = RequestNum\n    [Forms]![Administrative_LeaveCalendar_Detail]![txtAdminDateDetail_ID] = IDx\n    End Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1486592740, "post_id": 42124751, "comment_id": 71417648, "body": "Wrap it in a text call:  <code>=TEXT(LEFT(RC[2],4), &quot;0000&quot;)</code>"}, {"owner": {"reputation": 580, "user_id": 1046884, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/4397c31a66aaf33dd73431227519ac47?s=128&d=identicon&r=PG", "display_name": "sc1324", "link": "https://stackoverflow.com/users/1046884/sc1324"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1486592884, "post_id": 42124751, "comment_id": 71417713, "body": "when i replaced my codes with yours, it has syntax error. I tried using recording macros, it also telling me to use the same formula as above, .FormulaR1C1 = &quot;=LEFT(RC[2],4)&quot;"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1486593153, "post_id": 42124751, "comment_id": 71417838, "body": "Sorry, you need to double up the quotes <code>=TEXT(LEFT(RC[2],4), &quot;&quot;0000&quot;&quot;)</code>"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 2, "creation_date": 1486593361, "post_id": 42124751, "comment_id": 71417949, "body": "FWIW You&#39;re calling Excel&#39;s <code>LEFT</code> worksheet function, not VBA&#39;s <code>Left</code> function."}], "answers": [{"tags": [], "owner": {"reputation": 1341, "user_id": 6512922, "user_type": "registered", "accept_rate": 87, "profile_image": "https://graph.facebook.com/1131570370198708/picture?type=large", "display_name": "Jeremy", "link": "https://stackoverflow.com/users/6512922/jeremy"}, "is_accepted": false, "score": 0, "last_activity_date": 1486593178, "creation_date": 1486593178, "answer_id": 42124896, "question_id": 42124751, "link": "https://stackoverflow.com/questions/42124751/vba-left-function-doesnt-work-as-planned/42124896#42124896", "title": "vba left function doesnt work as planned", "body": "<p>You need to change the format to text:</p>\n\n<pre><code>Dim lLastRow As Long\nWith Sheets(\"Codes\")\nlLastRow = .Cells(.Rows.Count, \"C\").End(xlUp).Row\n      With .Range(\"A5:A\" &amp; lLastRow)\n         .NumberFormat = \"@\"\n         .FormulaR1C1 = \"=LEFT(RC[2],4)\"\n         .Value = .Value\n      End With\nEnd With\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 743, "user_id": 7386565, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4d17bff6b180e634d412328b6b418f2?s=128&d=identicon&r=PG&f=1", "display_name": "J. Garth", "link": "https://stackoverflow.com/users/7386565/j-garth"}, "is_accepted": true, "score": 1, "last_activity_date": 1486598511, "creation_date": 1486598511, "answer_id": 42125906, "question_id": 42124751, "link": "https://stackoverflow.com/questions/42124751/vba-left-function-doesnt-work-as-planned/42125906#42125906", "title": "vba left function doesnt work as planned", "body": "<p>To stick with your approach, you can add an apostrophe to the formula so that it will format the numbers as text and not remove the leading zeros:</p>\n\n<pre><code>Dim lLastRow As Long\n\nWith Sheets(\"Codes\")\n    lLastRow = .Cells(.Rows.Count, \"C\").End(xlUp).Row\n    With .Range(\"A5:A\" &amp; lLastRow)\n       .FormulaR1C1 = \"= \"\"'\"\" &amp;LEFT(RC[2],4)\"\n       .Value = .Value\n    End With\nEnd With\n</code></pre>\n\n<p>Although the apostrophe won't be visible in the cell, it will still be there.  If that causes problems, then you can use this approach:</p>\n\n<pre><code>Sub foo()\n\n    Dim lLastRow    As Long\n    Dim arrCodes()  As Variant\n    Dim rng         As Range\n    Dim i           As Integer\n\n    With Sheets(\"Codes\")\n        lLastRow = .Cells(.Rows.Count, \"C\").End(xlUp).Row\n\n        Set rng = .Range(\"C5:C\" &amp; lLastRow)\n        arrCodes = rng\n        arrCodes = Application.Transpose(arrCodes)\n\n        For i = LBound(arrCodes) To UBound(arrCodes)\n            arrCodes(i) = Left(arrCodes(i), 4)\n        Next i\n\n        Set rng = .Range(\"A5\")\n        Set rng = rng.Resize(UBound(arrCodes), 1)\n        rng.NumberFormat = \"@\"\n        rng.Value = Application.Transpose(arrCodes)\n    End With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 580, "user_id": 1046884, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/4397c31a66aaf33dd73431227519ac47?s=128&d=identicon&r=PG", "display_name": "sc1324", "link": "https://stackoverflow.com/users/1046884/sc1324"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 489, "favorite_count": 0, "accepted_answer_id": 42125906, "answer_count": 2, "score": 0, "last_activity_date": 1486598511, "creation_date": 1486592553, "question_id": 42124751, "link": "https://stackoverflow.com/questions/42124751/vba-left-function-doesnt-work-as-planned", "title": "vba left function doesnt work as planned", "body": "<p>I am trying to get partial of the Account Code using left function but it seemed like it doesn't work the way I want to. All of my data are in worksheet named Codes. I have Account Name in Column B &amp; Account Code in Column C, and I want to populate the parent code in column A.</p>\n\n<p>Now the code works except when the codes are 0001-xx-xx, it populates in Column A as 1 not 0001. Is there a way to fix it so it shows 0001 or 0022 and such? When I typed out the formula in excel, it will show 0002 or 0022. So I would like to achieve this using vba.</p>\n\n<pre><code>Dim lLastRow As Long\nWith Sheets(\"Codes\")\nlLastRow = .Cells(.Rows.Count, \"C\").End(xlUp).Row\n      With .Range(\"A5:A\" &amp; lLastRow)\n         .FormulaR1C1 = \"=LEFT(RC[2],4)\"\n         .Value = .Value\n      End With\nEnd With\n</code></pre>\n"}, {"tags": ["excel", "worksheet", "inputbox", "vba"], "comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 1, "creation_date": 1486647289, "post_id": 42124612, "comment_id": 71442403, "body": "<code>OutputStrt.Parent.Name</code>"}], "answers": [{"comments": [{"owner": {"reputation": 45, "user_id": 3625221, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14fb75273cccaca62d5ce1415e0703a8?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/3625221/sam"}, "edited": false, "score": 0, "creation_date": 1487450339, "post_id": 42124676, "comment_id": 71794047, "body": "Thank you! .Name was what I needed."}, {"owner": {"reputation": 183, "user_id": 10452645, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Yr8HioiNN0w/AAAAAAAAAAI/AAAAAAAAABA/t7HjQ8S6l_E/photo.jpg?sz=128", "display_name": "MrZH6", "link": "https://stackoverflow.com/users/10452645/mrzh6"}, "edited": false, "score": 1, "creation_date": 1550595513, "post_id": 42124676, "comment_id": 96322746, "body": "Had the same problem. Thanks for the answer. It seems that if you pick another workbook you don&#39;t have to specify it. @Fadi"}], "tags": [], "owner": {"reputation": 3088, "user_id": 4039286, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/vOSnz.jpg?s=128&g=1", "display_name": "Fadi", "link": "https://stackoverflow.com/users/4039286/fadi"}, "is_accepted": true, "score": 2, "last_activity_date": 1486592206, "creation_date": 1486592206, "answer_id": 42124676, "question_id": 42124612, "link": "https://stackoverflow.com/questions/42124612/extract-a-worksheet-name-from-the-range-selected/42124676#42124676", "title": "Extract a worksheet name from the range selected", "body": "<p>Try This:</p>\n\n<pre><code>Sub test()\n    Dim Ws As Worksheet\n    Dim OutputStrt As Range\n    Set OutputStrt = Application.InputBox(\"Select a cell, where the output should be dropped.\", \"Output start cell\", Type:=8)\n    Set Ws = OutputStrt.Worksheet\n    MsgBox Ws.Name\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 289, "user_id": 1403788, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bcebda8ba97ca45dd49aebaec5836f0f?s=128&d=identicon&r=PG", "display_name": "GeoStoneMarten", "link": "https://stackoverflow.com/users/1403788/geostonemarten"}, "is_accepted": false, "score": 0, "last_activity_date": 1597329760, "creation_date": 1597329760, "answer_id": 63397554, "question_id": 42124612, "link": "https://stackoverflow.com/questions/42124612/extract-a-worksheet-name-from-the-range-selected/63397554#63397554", "title": "Extract a worksheet name from the range selected", "body": "<p>You can also call it with <strong>Selection</strong> object</p>\n<pre><code>Dim ws As Workseet\nSet ws = Selection.Worksheet\nDebug.Print &quot;Sheetname: &quot; &amp; ws.Name\n</code></pre>\n"}], "owner": {"reputation": 45, "user_id": 3625221, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14fb75273cccaca62d5ce1415e0703a8?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/3625221/sam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 9497, "favorite_count": 0, "accepted_answer_id": 42124676, "answer_count": 2, "score": 2, "last_activity_date": 1597329760, "creation_date": 1486591905, "last_edit_date": 1531164843, "question_id": 42124612, "link": "https://stackoverflow.com/questions/42124612/extract-a-worksheet-name-from-the-range-selected", "title": "Extract a worksheet name from the range selected", "body": "<p>I have to input the result in the selected cell through InputBox function:</p>\n\n<pre><code>Set OutputStrt = Application.InputBox(\"Select a cell, where the output should be dropped.\", \"Output start cell\", Type:=8)\n</code></pre>\n\n<p>When I ran the code in the different worksheet and want the result in the different worksheet, it drops the result in the worksheet where I initially ran the code. </p>\n\n<p>How do I get the Worksheet name, which I selected through the Application.InputBox ?</p>\n\n<p>For example, when I selected in the Inputbox: Definitions!$F$38 how do I get the name 'Definitions'?</p>\n"}, {"tags": ["vba", "excel", "excel-formula", "finance"], "answers": [{"comments": [{"owner": {"reputation": 27, "user_id": 7409626, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c9f59fb36ed997baa9176dbdd515574e?s=128&d=identicon&r=PG&f=1", "display_name": "orkanoid", "link": "https://stackoverflow.com/users/7409626/orkanoid"}, "edited": false, "score": 0, "creation_date": 1486633594, "post_id": 42130167, "comment_id": 71433050, "body": "Thank you @A.S.H, replacing the comas with semicolons the formula worked perfectly. I manually checked for weeks that have less than five weekdays, i.e. weeks that start-end with weekdays other than 1-5. No problems. It will study the IF and VLOOKUP functions to figure out what this formula actually does, thanks again!"}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "reply_to_user": {"reputation": 27, "user_id": 7409626, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c9f59fb36ed997baa9176dbdd515574e?s=128&d=identicon&r=PG&f=1", "display_name": "orkanoid", "link": "https://stackoverflow.com/users/7409626/orkanoid"}, "edited": false, "score": 0, "creation_date": 1486634044, "post_id": 42130167, "comment_id": 71433330, "body": "@orkanoid Glad to know it helped :). Basically the <code>IF</code> is used to display only at rows that have a new week number. The core is the <code>VLookup</code>, and we relied on the fact that it is guaranteed to return the first matched row."}], "tags": [], "owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "is_accepted": true, "score": 1, "last_activity_date": 1486624142, "last_edit_date": 1486624142, "creation_date": 1486623357, "answer_id": 42130167, "question_id": 42124607, "link": "https://stackoverflow.com/questions/42124607/calculating-weekly-returns-from-daily-time-series-of-prices-v2/42130167#42130167", "title": "Calculating Weekly Returns from Daily Time Series of Prices v2", "body": "<p>It seems to me that you can generate your column <code>E</code> with this formula in <code>E2</code> :</p>\n\n<pre><code>=IF(B2=B1, \"\", (VLOOKUP(1+B2, B3:D9, 3, FALSE) - D2)/D2)\n</code></pre>\n\n<p>It's a VLookup limited on the next 7 rows from each row that declares a new week.</p>\n\n<p>Copying into all cells will give the result indicated in your first tableau. To transform this result into to the list <code>(Week, Return)</code> is a matter of a filter that hides blanks from <code>E</code>.</p>\n\n<p>Notice that a problem could occur if the <code>WeekNum</code> restarts from one when a new year is reached, but since you say that each of your sheets is for one (calendar) year, it shouldn't happen.</p>\n"}], "owner": {"reputation": 27, "user_id": 7409626, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c9f59fb36ed997baa9176dbdd515574e?s=128&d=identicon&r=PG&f=1", "display_name": "orkanoid", "link": "https://stackoverflow.com/users/7409626/orkanoid"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1235, "favorite_count": 0, "accepted_answer_id": 42130167, "answer_count": 1, "score": 0, "last_activity_date": 1486624142, "creation_date": 1486591890, "last_edit_date": 1495539923, "question_id": 42124607, "link": "https://stackoverflow.com/questions/42124607/calculating-weekly-returns-from-daily-time-series-of-prices-v2", "title": "Calculating Weekly Returns from Daily Time Series of Prices v2", "body": "<p>This is a slightly adjusted version of the question here: <a href=\"https://stackoverflow.com/questions/42115152/calculating-weekly-returns-from-daily-time-series-of-prices\">Calculating Weekly Returns from Daily Time Series of Prices</a> which was answered by @Scott Craner: </p>\n\n<p>I want to calculate weekly returns of a mutual fund from a time series of daily prices. My data looks like this:</p>\n\n<pre><code>A        B      C        D        E\nDATE     WEEK   W.DAY    MF.PRICE WEEKLY RETURN\n02/01/12    1    1       2,7587   -0,0108\n03/01/12    1    2       2,7667\n04/01/12    1    3       2,7892\n05/01/12    1    4       2,7666\n06/01/12    1    5       2,7391    \n09/01/12    2    1       2,7288    0,0067\n10/01/12    2    2       2,6707\n11/01/12    2    3       2,7044\n12/01/12    2    4       2,7183\n13/01/12    2    5       2,7619    \n16/01/12    3    1       2,7470    0,0511\n17/01/12    3    2       2,7878\n18/01/12    3    3       2,8156\n19/01/12    3    4       2,8310\n20/01/12    3    5       2,8760 \n23/01/12    4    1       2,8875  \n</code></pre>\n\n<p>The date is (dd/mm/yy) format and \",\" is decimal separator. This would be done by using this formula: (Price for first weekday of next week - Price for first weekday of current week)/(Price for first weekday of current week). For example the return for the first week is (2,7288 - 2,7587)/2,7587 = -0,0108 and for the second is (2,7470 - 2,7288)/2,7288 = 0,0067.</p>\n\n<p>The problem is that the list goes on for a year, and some weeks have less than five working days due to holidays or other reasons. Some weeks start with weekday 2, some end with weekday 3. So I can't simply copy and paste the formula above. I added the extra two columns for week number and week day using WEEKNUM and WEEKDAY functions, thought it might help. I want to automate this with a formula and hope to get a table like this:</p>\n\n<pre><code>WEEK    RETURN\n 1      -0,0108\n 2       0,0067\n 3       0,0511\n.       \n.       \n.       \n</code></pre>\n\n<p>I'm looking for a way to tell excel to \"find the prices that correspond to the min weekdays of two consecutive weeks and apply the formula \"(Price for first weekday of next week - Price for first weekday of current week)/(Price for first weekday of current week)\".</p>\n\n<p>I would appreciate any help! (I have 5 separate worksheets for consecutive years, each with daily prices of 20 mutual funds)</p>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 2, "creation_date": 1486590917, "post_id": 42124252, "comment_id": 71416792, "body": "That&#39;s because <code>Application.Run</code> is basically the same thing as an external call.  What are you using it <i>for</i>?  It&#39;s possible there&#39;s a work-around."}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1486591344, "post_id": 42124252, "comment_id": 71417004, "body": "If it is a relatively small list of subs which might be run, you could use a select-case construction where the various cases call the subs directly"}, {"owner": {"reputation": 207, "user_id": 5017037, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/f3b3deb217af6c347df5b6e73ba554aa?s=128&d=identicon&r=PG", "display_name": "someprogrammer", "link": "https://stackoverflow.com/users/5017037/someprogrammer"}, "edited": false, "score": 0, "creation_date": 1486592854, "post_id": 42124252, "comment_id": 71417705, "body": "Thank you for your responses.  It needs to be more flexible than a select-case construction."}], "answers": [{"comments": [{"owner": {"reputation": 207, "user_id": 5017037, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/f3b3deb217af6c347df5b6e73ba554aa?s=128&d=identicon&r=PG", "display_name": "someprogrammer", "link": "https://stackoverflow.com/users/5017037/someprogrammer"}, "edited": false, "score": 0, "creation_date": 1486592978, "post_id": 42124492, "comment_id": 71417757, "body": "The CallByName looks interesting, but I don&#39;t have ProcRunner available as a Type.  Would you have any idea what the Reference for that is?"}, {"owner": {"reputation": 8811, "user_id": 5757159, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/yxD51.png?s=128&g=1", "display_name": "ThunderFrame", "link": "https://stackoverflow.com/users/5757159/thunderframe"}, "reply_to_user": {"reputation": 207, "user_id": 5017037, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/f3b3deb217af6c347df5b6e73ba554aa?s=128&d=identicon&r=PG", "display_name": "someprogrammer", "link": "https://stackoverflow.com/users/5017037/someprogrammer"}, "edited": false, "score": 0, "creation_date": 1486593378, "post_id": 42124492, "comment_id": 71417957, "body": "@someprogrammer You&#39;d have to add a class of your own, called <code>ProcRunner</code>, an example of which I&#39;ve added to my answer."}], "tags": [], "owner": {"reputation": 8811, "user_id": 5757159, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/yxD51.png?s=128&g=1", "display_name": "ThunderFrame", "link": "https://stackoverflow.com/users/5757159/thunderframe"}, "is_accepted": false, "score": 5, "last_activity_date": 1486593807, "last_edit_date": 1486593807, "creation_date": 1486591341, "answer_id": 42124492, "question_id": 42124252, "link": "https://stackoverflow.com/questions/42124252/application-run-with-error-trapping/42124492#42124492", "title": "Application.Run with Error Trapping", "body": "<p>If the procedure you're calling is inside your VBA project, then you can just call the procedure directly with:</p>\n\n<pre><code>Sub Foo()\n   'Application.Run \"SomeProc\"\n   SomeProc\nEnd Sub\n</code></pre>\n\n<p>If you need to be able to call things dynamically by name, you could explore using classes and <code>CallByName</code>:</p>\n\n<pre><code>'In a standard module\nSub Foo()\n   Dim o as New ProcRunner\n   CallByName o, \"SomeProc\", VbMethod, args\nEnd Sub\n\n'In a class module called ProcRunner\nSub SomeProc()\n   DoSomethingHere\n   'Or, do something in a standard module\n   Module1.SomeOtherProc\nEnd Sub\n</code></pre>\n\n<p>Or, you could write your own dynamic handler, along the lines of:</p>\n\n<pre><code>Sub AppRun(ProcName As String, ParamArray Args)\n  Select Case ProcName\n    Case \"SomeProc\"\n        SomeProc\n    Case \"SomeFunc\"\n        SomeFunc\n  End Select\nEnd Sub\n</code></pre>\n\n<p>If you're calling procedures in another VBA project, you may need to add a reference to that project, depending upon the VBA host.</p>\n\n<p>However, if you're using <code>Application.Run</code> because you're calling functions registered by a DLL or XLL, then you don't have any option other than to use <code>Application.Run</code></p>\n"}, {"comments": [{"owner": {"reputation": 1767, "user_id": 5134722, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/YvI1j.jpg?s=128&g=1", "display_name": "Colm Bhandal", "link": "https://stackoverflow.com/users/5134722/colm-bhandal"}, "edited": false, "score": 0, "creation_date": 1547231394, "post_id": 54152082, "comment_id": 95135287, "body": "Please leave a comment if this code doesn&#39;t work. I don&#39;t know if there are any dependencies to anything else that I&#39;ve left out. You must trust access to the VBA object module for this to work. See link in References."}], "tags": [], "owner": {"reputation": 1767, "user_id": 5134722, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/YvI1j.jpg?s=128&g=1", "display_name": "Colm Bhandal", "link": "https://stackoverflow.com/users/5134722/colm-bhandal"}, "is_accepted": false, "score": 0, "last_activity_date": 1547231151, "creation_date": 1547231151, "answer_id": 54152082, "question_id": 42124252, "link": "https://stackoverflow.com/questions/42124252/application-run-with-error-trapping/54152082#54152082", "title": "Application.Run with Error Trapping", "body": "<p>There is a way to do this. We have a test harness in VBA and need a way of testing whether a procedure throws an error or not, giving a true/false result. We want True to indicate that an error was thrown, and False to indicate that no error was thrown. This only works for public procedures, but you can pass in a variable amount of arguments.</p>\n\n<p>mIsErrorThrownDuringRunProcedure allows you to pass in a proc name and a varags list of arguments. It creates a new module, then writes another procedure to a the new module, calls that other procedure, and returns the result. The other procedure checks whether running the proc with the given args had any errors. When the dynamically created procedure is finished running, the new module is deleted.</p>\n\n<p>An auxiliary function called mCreateCodeToExecute creates the code that is run from the new module to actually get the true/false result.</p>\n\n<pre><code>Public Function mIsErrorThrownDuringRunProcedure(pProcName As String, ParamArray pArgs() As Variant) As Boolean\n    Dim lVbComp As Object\n    Set lVbComp = ThisWorkbook.VBProject.VBComponents.Add(1)\n    Dim lProcNameToExecute As String\n    lProcNameToExecute = \"mIsErrroRunDuringProcedure\" &amp; pProcName\n    Dim lCodeToExecute As String\n    Dim lNumArgs As Integer: lNumArgs = 0\n    Dim lArg As Variant\n    For Each lArg In pArgs\n        lNumArgs = lNumArgs + 1\n    Next\n    lCodeToExecute = mCreateCodeToExecute(pProcName, lProcNameToExecute, lNumArgs)\n    lVbComp.CodeModule.AddFromString lCodeToExecute\n    mIsErrorThrownDuringRunProcedure = Application.Run(lProcNameToExecute, pArgs)\n    ThisWorkbook.VBProject.VBComponents.Remove lVbComp\nEnd Function\n\nPrivate Function mCreateCodeToExecute(pProcName As String, lProcNameToExecute As String, numArgs As Integer)\n    Dim lCodeToExecute As String\n    lCodeToExecute = \"Function \" &amp; lProcNameToExecute &amp; \"(\"\n    lCodeToExecute = lCodeToExecute &amp; \"ParamArray pArgs() As Variant) As Boolean\" &amp; vbCrLf\n    Dim lGoToLabel As String: lGoToLabel = \"gtCodeHadError\"\n    lCodeToExecute = lCodeToExecute &amp; \"  On Error GoTo \" &amp; lGoToLabel &amp; vbCrLf\n    lCodeToExecute = lCodeToExecute &amp; \"  Call \" &amp; pProcName &amp; \"(\"\n    Dim lIndex As Integer\n    lIndex = 0\n    For lIndex = 0 To numArgs - 1\n        lCodeToExecute = lCodeToExecute &amp; \"pArgs(\" &amp; lIndex &amp; \"), \"\n        lIndex = lIndex + 1\n    Next\n    Dim lCutOff As Integer: lCutOff = 2\n    If lIndex = 0 Then lCutOff = 1\n    lCodeToExecute = left(lCodeToExecute, Len(lCodeToExecute) - lCutOff)\n    If lCutOff = 2 Then lCodeToExecute = lCodeToExecute &amp; \")\"\n    lCodeToExecute = lCodeToExecute &amp; vbCrLf &amp; \"  \" &amp; lProcNameToExecute &amp; \"= False\" &amp; vbCrLf &amp; \"  Exit Function\"\n    lCodeToExecute = lCodeToExecute &amp; vbCrLf &amp; lGoToLabel &amp; \":\" &amp; vbCrLf\n    lCodeToExecute = lCodeToExecute &amp; \"  \" &amp; lProcNameToExecute &amp; \"= True\"\n    lCodeToExecute = lCodeToExecute &amp; vbCrLf &amp; \"End Function\"\n    mCreateCodeToExecute = lCodeToExecute\nEnd Function\n</code></pre>\n\n<h1>References</h1>\n\n<p><a href=\"https://stackoverflow.com/questions/43216390/how-to-run-a-string-as-a-command-in-vba\">How to run a string as a command in VBA</a></p>\n"}], "owner": {"reputation": 207, "user_id": 5017037, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/f3b3deb217af6c347df5b6e73ba554aa?s=128&d=identicon&r=PG", "display_name": "someprogrammer", "link": "https://stackoverflow.com/users/5017037/someprogrammer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1119, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1547231151, "creation_date": 1486590382, "question_id": 42124252, "link": "https://stackoverflow.com/questions/42124252/application-run-with-error-trapping", "title": "Application.Run with Error Trapping", "body": "<p>In Access, using VBA, I want to use Application.Run and trap any errors.  Unfortunately, Application.Run seems to hijack error trapping.  Is there a way to fix this?</p>\n\n<pre><code>On Error Resume Next\nApplication.Run ...\n</code></pre>\n\n<p>I never get past Application.Run on an error, even if I specify On Error Resume Next or On Error GoTo ErrCatch.  My error trapping setting is ignored.</p>\n"}, {"tags": ["ms-access", "vba", "duplicates"], "answers": [{"tags": [], "owner": {"reputation": 379, "user_id": 4228193, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/5nPj1.jpg?s=128&g=1", "display_name": "mpag", "link": "https://stackoverflow.com/users/4228193/mpag"}, "is_accepted": false, "score": 0, "last_activity_date": 1486750574, "last_edit_date": 1486750574, "creation_date": 1486688732, "answer_id": 42149830, "question_id": 42124168, "link": "https://stackoverflow.com/questions/42124168/ms-access-lookup-excluding-already-selected-values-check-unique-key-before-rec/42149830#42149830", "title": "MS Access: Lookup excluding already-selected values; check unique key before record entry complete", "body": "<p>\"Solved\" this in VBA.</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Private Sub MyControl_AfterUpdate()\n    newval = Me.MyControl.Value\n    oldval = Me.MyControl.OldValue\n    If newval = oldval Then Exit Sub ' everything's okay\n    Dim rs As Object\n    Set rs = Me.Form.Recordset\n    whereclause = \"MyControl = '\" &amp; newval &amp; \"'\"\n    qry = \"SELECT COUNT(*) as c FROM MyQuery WHERE \" &amp; whereclause\n    qrs = CurrentDb.OpenRecordset(qry)\n    If qrs.Count = 1 Then cnt = qrs(0).Value\n    If cnt &gt;= 1 Then\n        selval = MsgBox(\"Would you like to keep your selection for this record?\" &amp; vbCrLf &amp; \"[yes = change previous record's MyField; no = change MyField for this record]\", vbYesNo Or VbMsgBoxStyle.vbExclamation Or vbSystemModal Or vbDefaultButton2 Or vbMsgBoxSetForeground, \"Duplicate MyField selection encountered\")\n        If selval = vbYes Then\n            ' set focus to the other entry, preserving selection here\n            thissel = Me.MyControl.ListIndex\n            Me.MyControl.Value = \"temp\" ' if a string is okay &amp; so we can jump away from this record\n            thisloc = Me.Form.CurrentRecord ' record number\n            rs.Findfirst (whereclause)\n            thatloc = Me.Form.CurrentRecord\n            Debug.Print (thisloc &amp; \"now  ;  was\" &amp; thatloc)\n            Me.MyControl.Value = \"invalid\"\n            DoCmd.GoToRecord , , acGoTo, thisloc  ' jump to the new row\n            Me.MyControl.Value = newval\n            DoCmd.GoToRecord , , acGoTo, thatloc  ' jump to the one to change\n            If thissel &lt;= 0 Then thissel = 1 ' may not be useful, given the error handling below\n            On Error Resume Next\n            Me.MyControl.ListIndex = thissel - 1\n            On Error GoTo 0\n            Me.MyControl.Dropdown\n        ElseIf selval = vbNo Then\n            Me.MyControl.Value = Me.MyControl.OldValue\n            Me.MyControl.Undo ' for some reason this doesn't clear the \"dirty\" bit, resulting in the edit pencil showing up for the row.\n            Me.MyControl.SetFocus\n        End If\n    Else\n        Debug.Print (\"There were no matches! Das ist gut\")\n    End If\nEnd Sub\n</code></pre>\n\n<p><strong>Residual Issue(s)</strong></p>\n\n<ol>\n<li>Selecting \"Yes\" from the dialogue and then hitting escape puts the invalid \"invalid\" string into the box, which ignores any requirement to restrict the final selection to one in the list (ie <em>Limit to List = 1</em>). Ideally this would \"roll back\" the two rows.</li>\n<li>Maybe I should change this to an OnExit Event so it doesn't trigger before I even leave the cell? Not sure if the primary key violation would happen before this triggers though. OnChange triggers much too frequently (every time you down-arrow through the list).</li>\n</ol>\n"}], "owner": {"reputation": 379, "user_id": 4228193, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/5nPj1.jpg?s=128&g=1", "display_name": "mpag", "link": "https://stackoverflow.com/users/4228193/mpag"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 139, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1486750574, "creation_date": 1486590055, "question_id": 42124168, "link": "https://stackoverflow.com/questions/42124168/ms-access-lookup-excluding-already-selected-values-check-unique-key-before-rec", "title": "MS Access: Lookup excluding already-selected values; check unique key before record entry complete", "body": "<p>I'm currently struggling how to set up validation rules for forms in either Datasheet or Form view that trigger immediately upon going to either another field within the record or to another record entirely.</p>\n\n<p>My form is designed to add records to one destination table where the primary key column needs to match a value of a specific field in any record of a source table. The rest of the fields in the form (and destination table) are for general user input (some DateTime fields, some text, some decimal).</p>\n\n<p>I can get Access to display a standard error dialogue when a user attempts to free-enter a value not on the list immediately after selection of another field or record. The error displayed is </p>\n\n<blockquote>\n  <p><strong>The text you entered isn't an item in the list.</strong><br>\n  Select an item from the list, or enter text that matches one of the listed items\"</p>\n</blockquote>\n\n<p>And if I reselect a lookup value already selected and go to the next record, I get</p>\n\n<blockquote>\n  <p>The changes you requested to the table were not successful because they would create duplicate values in the index, primary key, or relationship. Change the data in the field or fields that contain duplicate data, remove the index, or redefine the index to permit duplicate entries and try again.</p>\n</blockquote>\n\n<p><strong>However, I'd like that error (or similar) to appear immediately if going to another field within the same record.</strong>  In other words, I want it to tell me that it's a duplicate before allowing the user to fill out the rest of the current record in the form or table.</p>\n\n<p>I would like the selection list be restricted to values not previously present in the destination table. Obviously if editing an already-created entry, you should be able to keep the value you had previously (i.e. that value wouldn't be excluded from the dropdown list). </p>\n\n<p>Alternatively there would be a selection dialogue that would appear if an otherwise valid value was duplicated.</p>\n\n<blockquote>\n  <p><strong>Duplicate Value</strong><br>\n  You've already used that value. Would you like to change this record or the previously-entered record.<br>\n  \u2aa1 This One \u2aa2 &lt; Previous ></p>\n</blockquote>\n\n<p>If \"Previous\" is selected, it would jump up to the same field in the indicated record, providing a dropdown list for re-selection (and once done would jump back to the \"current\" record and autoselect the temporarily duplicated value.</p>\n\n<p>I'll edit this post in a bit with my table design details, as well as source setups for the form.</p>\n"}, {"tags": ["vba", "sum", "format", "pivot", "pivot-table"], "comments": [{"owner": {"reputation": 11, "user_id": 7536479, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0163dfab54ba7ba69211b45a72c7670f?s=128&d=identicon&r=PG&f=1", "display_name": "Tuntunman", "link": "https://stackoverflow.com/users/7536479/tuntunman"}, "edited": false, "score": 0, "creation_date": 1486590739, "post_id": 42124100, "comment_id": 71416704, "body": "Hope someone can help me figure out this problem..... It drives me crazy....."}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1486619475, "post_id": 42124100, "comment_id": 71425593, "body": "share the current result you are getting with this code (a screen-shot of the Pivot Table), and add a description how you want it to look like (maybe you can simulate manualy and add another screen-shot of the desired result)"}], "owner": {"reputation": 11, "user_id": 7536479, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0163dfab54ba7ba69211b45a72c7670f?s=128&d=identicon&r=PG&f=1", "display_name": "Tuntunman", "link": "https://stackoverflow.com/users/7536479/tuntunman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 120, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1486605110, "creation_date": 1486589859, "last_edit_date": 1486605110, "question_id": 42124100, "link": "https://stackoverflow.com/questions/42124100/vba-pivot-table-datafields-horizontal-to-vertical", "title": "VBA Pivot Table- Datafields Horizontal to Vertical", "body": "<p>I've been following a book on how to create a pivot table using VBA.\nThe code in the book works fine and it's doing what it's supposed to be doing. But i don't understand how to change how the Datafields are displayed.\nIt's listing the datafields horizontally one on top of the other in One column.\nI want to know how to get the datafields to appear in separate columns (in the datafield area)</p>\n\n<p>Here is the book's code:</p>\n\n<pre><code>Sub CreatePivot2()\n    ' Create pivot table at active cell\n    ' Assumes that the source table is in sheet called Source\n    ActiveSheet.PivotTableWizard _\n    SourceType:=xlDatabase, _\n    SourceData:=\"'Source'!R1C1:R145C7\", _\n    TableName:=\"Sales&amp;Trans2\"\n    ActiveSheet.PivotTables(\"Sales&amp;Trans2\").AddFields _\n    RowFields:=Array(\"Store City\", \"Store Type\"), _\n    ColumnFields:=\"Period\", _\n    PageFields:=\"Year\"\n    With ActiveSheet.PivotTables(\"Sales&amp;Trans2\")\n    With .PivotFields(\"Transactions\")\n        .Orientation = xlDataField\n        .Function = xlSum\n        .Position = 1\n    End With\n    With .PivotFields(\"Sales\")\n        .Orientation = xlDataField\n        .Function = xlSum\n        .Position = 2\n        End With\n    End With\nEnd Sub\n</code></pre>\n\n<p>Can you guys tell me how to do that? </p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 138, "user_id": 5149262, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a3d53f206002493f2d9587a117d14fda?s=128&d=identicon&r=PG", "display_name": "Diego Ribba", "link": "https://stackoverflow.com/users/5149262/diego-ribba"}, "edited": false, "score": 0, "creation_date": 1486584229, "post_id": 42122540, "comment_id": 71413191, "body": "why you want to copy data many times? isn&#39;t one time enough?"}, {"owner": {"reputation": 13, "user_id": 7536281, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f239072d5f353141d221d74b2e075492?s=128&d=identicon&r=PG&f=1", "display_name": "Gonzalo", "link": "https://stackoverflow.com/users/7536281/gonzalo"}, "reply_to_user": {"reputation": 138, "user_id": 5149262, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a3d53f206002493f2d9587a117d14fda?s=128&d=identicon&r=PG", "display_name": "Diego Ribba", "link": "https://stackoverflow.com/users/5149262/diego-ribba"}, "edited": false, "score": 0, "creation_date": 1486584660, "post_id": 42122540, "comment_id": 71413441, "body": "No. I want to do it multiple times to batch copy a large amount of data which has some holes in between"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1486585544, "post_id": 42122540, "comment_id": 71413917, "body": "Are you just trying to copy the range starting from a certain row down to the last used row?  Do you want the &quot;holes&quot; copied as well, or just the non-blank rows?"}, {"owner": {"reputation": 13, "user_id": 7536281, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f239072d5f353141d221d74b2e075492?s=128&d=identicon&r=PG&f=1", "display_name": "Gonzalo", "link": "https://stackoverflow.com/users/7536281/gonzalo"}, "edited": false, "score": 0, "creation_date": 1486586041, "post_id": 42122540, "comment_id": 71414190, "body": "xldown goes to I11 (the first one), then the macro goes 8 columns to the right, copies, goes 8 to the left then pastes that value in another sheet in the last column of the first row  The next value i want to offset copy is I284, then I286 and so on. All those cells are or not between holes. I can select all the values I&#39;m interested in via CTRL+Down, that&#39;s why i used  xldown.  The difficulty here is that when I want to return to the first sheet after pasting it I don&#39;t know how to go back to the last copied row, so I used a fixed reference (X9) and then xldown it multiple times"}, {"owner": {"reputation": 138, "user_id": 5149262, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a3d53f206002493f2d9587a117d14fda?s=128&d=identicon&r=PG", "display_name": "Diego Ribba", "link": "https://stackoverflow.com/users/5149262/diego-ribba"}, "edited": false, "score": 1, "creation_date": 1486586833, "post_id": 42122540, "comment_id": 71414630, "body": "is that data compiled on one column? because if that&#39;s the case, maybe determining last row by xlUp method will suffice. For Example <code>Range(&quot;A1:A&quot; &amp; Range(&quot;A1048576&quot;).end(xlUp).row).Copy</code>"}, {"owner": {"reputation": 13, "user_id": 7536281, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f239072d5f353141d221d74b2e075492?s=128&d=identicon&r=PG&f=1", "display_name": "Gonzalo", "link": "https://stackoverflow.com/users/7536281/gonzalo"}, "edited": false, "score": 0, "creation_date": 1486587302, "post_id": 42122540, "comment_id": 71414878, "body": "No. What I want to do is copy only the values that have holes in column &quot;I&quot; IE between 25 and 35, between 100 and 250 and 252 and 254 (in that case, I&#39;d want Q25, Q35, Q100, Q250, Q252 and Q254) but not in column Q, which is full of values between 10 and 20000"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1486589823, "post_id": 42122540, "comment_id": 71416260, "body": "Don&#39;t use <code>Selection.End(xlDown).Select</code> at all.  Keep track of your target row in a variable (say, <code>lastRow </code>) instead. Then it&#39;s just <code>lastRow = lastRow + i</code>."}], "answers": [{"tags": [], "owner": {"reputation": 31052, "user_id": 4280, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bc588d9f099467ce6bc6fc68426119aa?s=128&d=identicon&r=PG", "display_name": "Dick Kusleika", "link": "https://stackoverflow.com/users/4280/dick-kusleika"}, "is_accepted": true, "score": 0, "last_activity_date": 1486591888, "creation_date": 1486591888, "answer_id": 42124606, "question_id": 42122540, "link": "https://stackoverflow.com/questions/42122540/loop-xldown-many-times/42124606#42124606", "title": "Loop xldown many times", "body": "<p>Assume you have data from A2 to A202 and there are three gaps in the data. Assume also that you know the data doesn't go down to A250 and there is nothing between A250 and the end of your data.</p>\n\n<p>The best way is to use <code>xlUp</code> once from the bottom rather than <code>xlDown</code> multiple times. But you can do both. Here's an example.</p>\n\n<pre><code>Sub LoopDown()\n\n    Dim rStart As Range\n    Dim rEnd As Range\n    Dim i As Long\n\n    Set rStart = Sheet1.Range(\"A2\")\n    Set rEnd = rStart 'set it to rStart initially\n\n    For i = 1 To 7 'go to # of gaps x 2 + 1 (3 x 2 + 1 = 7 for 3 gaps)\n        Set rEnd = rEnd.End(xlDown) 'every time you do an\n                                    'xlDown, you reset rEnd\n    Next i\n\n    'These are the same\n    Debug.Print Range(rStart, rEnd).Address\n    Debug.Print Range(rStart, Range(\"A250\").End(xlUp)).Address\n\nEnd Sub\n</code></pre>\n\n<p>And returns this</p>\n\n<pre><code>$A$2:$A$202\n$A$2:$A$202\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 7536281, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f239072d5f353141d221d74b2e075492?s=128&d=identicon&r=PG&f=1", "display_name": "Gonzalo", "link": "https://stackoverflow.com/users/7536281/gonzalo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1252, "favorite_count": 0, "accepted_answer_id": 42124606, "answer_count": 1, "score": 1, "last_activity_date": 1486591888, "creation_date": 1486584065, "last_edit_date": 1531164843, "question_id": 42122540, "link": "https://stackoverflow.com/questions/42122540/loop-xldown-many-times", "title": "Loop xldown many times", "body": "<p>What I want to do is loop <code>xlDown</code> multiple times</p>\n\n<p>I have in mind something like this:</p>\n\n<pre><code>For i=1 to 2000\n\n   1 x Selection.End(xlDown).Select\nthen copy a range, then pasting it in another worksheet (i already have these functions)\n\nnext\n</code></pre>\n\n<p>The second iteration should do <code>Selection.End(xlDown).Select</code> 2 times, the third 3 times and so on.</p>\n\n<p>Please, I'm stuck with this one and I know it's very easy</p>\n\n<p>Thanks in advance</p>\n"}, {"tags": ["vba", "excel", "for-loop", "pivot", "pivot-table"], "comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 2, "creation_date": 1486584207, "post_id": 42122487, "comment_id": 71413175, "body": "change <code>PivotTable_Name(n) = &quot;PivotTable&quot; &amp; &quot;n&quot;</code> to <code>PivotTable_Name(n) = &quot;PivotTable&quot; &amp; n</code> (take the <code>&quot;</code> out of the <code>n</code>)"}, {"owner": {"reputation": 11, "user_id": 7536479, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0163dfab54ba7ba69211b45a72c7670f?s=128&d=identicon&r=PG&f=1", "display_name": "Tuntunman", "link": "https://stackoverflow.com/users/7536479/tuntunman"}, "reply_to_user": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1486584789, "post_id": 42122487, "comment_id": 71413500, "body": "Thank you Shai~ That works now!"}], "owner": {"reputation": 11, "user_id": 7536479, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0163dfab54ba7ba69211b45a72c7670f?s=128&d=identicon&r=PG&f=1", "display_name": "Tuntunman", "link": "https://stackoverflow.com/users/7536479/tuntunman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 276, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1486584081, "creation_date": 1486583910, "last_edit_date": 1486584081, "question_id": 42122487, "link": "https://stackoverflow.com/questions/42122487/how-to-rename-the-pivottables-in-a-for-loop", "title": "How to rename the PivotTables in a for loop?", "body": "<p>I would like to generate four different pivot tables in one excel sheet by using for loop. However, when I run my vba code, it shows that the name for that pivot table is already used. Then I think maybe I can generate a vector of names and then pick name from that vector each time as the name of a pivottable, but it does not work. I do this way:</p>\n\n<pre><code>For n = 0 To 3\n    PivotTable_Name(n) = \"PivotTable\" &amp; \"n\"\nNext n\n</code></pre>\n\n<p>Also, if I only want to show one result of fieldpage \nCan any one help me to look at it? and give me any suggestion? </p>\n\n<p>Here is my code.</p>\n\n<pre><code>    Dim rngData As Range\n    Dim LastRow As Long\n    Dim LastCol As Long\n    Dim pvtItm As PivotItem\n    Dim ListFields(0 To 5) As String\n    Dim PivotTable_Name(0 To 3) As String\n    Dim i As Integer\n    Dim j As Integer\n    Dim k As Integer\n\n    **For k = 0 To 3\n        For n = 0 To 3\n            PivotTable_Name(n) = \"PivotTable\" &amp; \"n\"\n        Next n\n\n        wsPvtTbl.PivotTables.Add PivotCache:=PvtTblCache, TableDestination:=wsPvtTbl.Cells(3, 1 + 4 * k), TableName:=PivotTable_Name(k), DefaultVersion:=xlPivotTableVersion11\n        Set PvtTbl = wsPvtTbl.PivotTables(PivotTable_Name(k))**\n\n        PvtTbl.ManualUpdate = True\n\n        For j = 0 To LastCol - 1\n            ListFields(j) = wsData.Cells(1, j + 1)\n        Next j\n\n        'add row, column and page (report filter) fields:\n        Set pvtFld = PvtTbl.PivotFields(ListFields(1))\n        pvtFld.Orientation = xlPageField\n\n        Set pvtFld = PvtTbl.PivotFields(ListFields(2))\n        pvtFld.Orientation = xlRowField\n\n        For i = 3 To LastCol - 1\n            With PvtTbl.PivotFields(ListFields(i))\n                .Orientation = xlDataField\n                .Function = xlSum\n                .NumberFormat = \"#,##0\"\n                .Position = i - 2\n            End With\n        Next i                \n        PvtTbl.ManualUpdate = False            \n    Next k\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "vbscript", "ms-word"], "comments": [{"owner": {"reputation": 14608, "user_id": 692942, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c2e501358dbf183e074c2f9a7896fbff?s=128&d=identicon&r=PG&f=1", "display_name": "user692942", "link": "https://stackoverflow.com/users/692942/user692942"}, "edited": false, "score": 2, "creation_date": 1486584211, "post_id": 42122216, "comment_id": 71413179, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/31785613/vba-equivalent-to-vbscripts-setlocale-function\">VBA equivalent to VBScript&#39;s &#39;SetLocale&#39; function?</a>"}, {"owner": {"reputation": 499, "user_id": 3662287, "user_type": "registered", "accept_rate": 48, "profile_image": "https://graph.facebook.com/518096139/picture?type=large", "display_name": "Steve", "link": "https://stackoverflow.com/users/3662287/steve"}, "reply_to_user": {"reputation": 14608, "user_id": 692942, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c2e501358dbf183e074c2f9a7896fbff?s=128&d=identicon&r=PG&f=1", "display_name": "user692942", "link": "https://stackoverflow.com/users/692942/user692942"}, "edited": false, "score": 0, "creation_date": 1486658894, "post_id": 42122216, "comment_id": 71450754, "body": "That question and response refers to Excel VBA and the Evaluate function, which Word VBA does not feature. My question is tagged as ms-word Thank you."}, {"owner": {"reputation": 14608, "user_id": 692942, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c2e501358dbf183e074c2f9a7896fbff?s=128&d=identicon&r=PG&f=1", "display_name": "user692942", "link": "https://stackoverflow.com/users/692942/user692942"}, "edited": false, "score": 0, "creation_date": 1486659329, "post_id": 42122216, "comment_id": 71451077, "body": "In which case the answer is No, sorry. Seen as though you are using VBA you should have access to the Windows APIs which VBScript doesn&#39;t allow. There isn&#39;t much you can&#39;t do with the Windows API."}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 2, "creation_date": 1486664524, "post_id": 42122216, "comment_id": 71454448, "body": "In Word, the language used for dates should reflect the language formatting applied to the document. Most likely, given what you&#39;re seeing, this is German. The trick will be to format these documents as &quot;English&quot;. This is, unfortunately, not as simple a process as it should be. You&#39;ll find some tips here: <a href=\"http://homepage.swissonline.ch/cindymeister/LangFmt.htm\" rel=\"nofollow noreferrer\">homepage.swissonline.ch/cindymeister/LangFmt.htm</a>"}, {"owner": {"reputation": 499, "user_id": 3662287, "user_type": "registered", "accept_rate": 48, "profile_image": "https://graph.facebook.com/518096139/picture?type=large", "display_name": "Steve", "link": "https://stackoverflow.com/users/3662287/steve"}, "edited": false, "score": 0, "creation_date": 1486669832, "post_id": 42122216, "comment_id": 71457444, "body": "Thank you Cindy. That may prove helpful, though it is a bit dated now."}, {"owner": {"reputation": 14608, "user_id": 692942, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c2e501358dbf183e074c2f9a7896fbff?s=128&d=identicon&r=PG&f=1", "display_name": "user692942", "link": "https://stackoverflow.com/users/692942/user692942"}, "edited": false, "score": 0, "creation_date": 1486719528, "post_id": 42122216, "comment_id": 71477502, "body": "@StevenMpls so is programming in Word."}], "answers": [{"comments": [{"owner": {"reputation": 14608, "user_id": 692942, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c2e501358dbf183e074c2f9a7896fbff?s=128&d=identicon&r=PG&f=1", "display_name": "user692942", "link": "https://stackoverflow.com/users/692942/user692942"}, "edited": false, "score": 0, "creation_date": 1486719692, "post_id": 42148472, "comment_id": 71477585, "body": "Inventive approach."}, {"owner": {"reputation": 499, "user_id": 3662287, "user_type": "registered", "accept_rate": 48, "profile_image": "https://graph.facebook.com/518096139/picture?type=large", "display_name": "Steve", "link": "https://stackoverflow.com/users/3662287/steve"}, "reply_to_user": {"reputation": 14608, "user_id": 692942, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c2e501358dbf183e074c2f9a7896fbff?s=128&d=identicon&r=PG&f=1", "display_name": "user692942", "link": "https://stackoverflow.com/users/692942/user692942"}, "edited": false, "score": 0, "creation_date": 1486756695, "post_id": 42148472, "comment_id": 71500276, "body": "The key is the ability to set the locale, something VBScript or JScript can do that Word VBA cannot. Otherwise none of this business would be neccessary."}], "tags": [], "owner": {"reputation": 499, "user_id": 3662287, "user_type": "registered", "accept_rate": 48, "profile_image": "https://graph.facebook.com/518096139/picture?type=large", "display_name": "Steve", "link": "https://stackoverflow.com/users/3662287/steve"}, "is_accepted": false, "score": 1, "last_activity_date": 1486681351, "last_edit_date": 1486681351, "creation_date": 1486681001, "answer_id": 42148472, "question_id": 42122216, "link": "https://stackoverflow.com/questions/42122216/vbscript-getlocale-setlocale-other-uses/42148472#42148472", "title": "VBScript, GetLocale, SetLocale - Other uses", "body": "<p>This was the answer, what I wrote.</p>\n\n<pre><code>Public Function printDateByLocale(inputDate As Date, inputlocale As String) As String\n\nDim codeString As String\nDim scriptControl As Object\n\nSet scriptControl = CreateObject(\"MSScriptControl.ScriptControl\")\n\ncodeString = \"Function getDateByLocale(myDate, locale)\" &amp; vbCrLf &amp; \"SetLocale locale\" &amp; vbCrLf &amp; \"getDateByLocale = FormatDateTime(myDate, vbLongDate) End Function\"\n\nWith scriptControl\n    .Language = \"VBScript\"\n    .addCode codeString\n    printDateByLocale = .Run(\"getDateByLocale\", inputDate, inputlocale)\nEnd With\n\nSet scriptControl = Nothing\n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 499, "user_id": 3662287, "user_type": "registered", "accept_rate": 48, "profile_image": "https://graph.facebook.com/518096139/picture?type=large", "display_name": "Steve", "link": "https://stackoverflow.com/users/3662287/steve"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 957, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1486690327, "creation_date": 1486582916, "last_edit_date": 1486690327, "question_id": 42122216, "link": "https://stackoverflow.com/questions/42122216/vbscript-getlocale-setlocale-other-uses", "title": "VBScript, GetLocale, SetLocale - Other uses", "body": "<p>Note: Contrary to assertions, this question <em>is not</em> a duplicate. My question is tagged as ms-word and the suggestions made point to an ms-excel answer, which in this case does not apply. Word VBA != Excel VBA.</p>\n\n<p>I have a need where I have users in Germany generating English language Word 2016 documents but where the dates are coming through as European styled with German language month and day names. We need them to come through as English date styles and names.</p>\n\n<p>I know of the Content Controls and Date Picker, though that isn't an option at this time (It may be in the future). Changing their local regional settings also isn't an option (obviously it's German). For reasons I won't go into here, we are restricted to .DOC format for legacy reasons. </p>\n\n<p>Happened across the VBScript functions GetLocale and SetLocal. Works perfectly, in the context of VBScript...</p>\n\n<p>Question is how might I be able to reference VBScript as a DLL and make use of that functionality in an Office VBA module? It's not built into Office VBA unfortunately. </p>\n\n<p>I've tried referencing VBScript.dll from the SYsWow64 folder, but the only thing it exposes is VBScript_Global.GlobalObj and SetLocale, GetLocale aren't available (It is referenced in the latest documentation still, it isn't deprecated. <a href=\"https://msdn.microsoft.com/en-us/library/5xf99h19(v=vs.84).aspx\" rel=\"nofollow noreferrer\">https://msdn.microsoft.com/en-us/library/5xf99h19(v=vs.84).aspx</a>).</p>\n\n<p>Any help would be greatly appreciated.</p>\n"}, {"tags": ["excel", "validation", "vba"], "comments": [{"owner": {"reputation": 2193, "user_id": 1820196, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/89367ffb09964465a25d5d493a30ca88?s=128&d=identicon&r=PG", "display_name": "jannagy02", "link": "https://stackoverflow.com/users/1820196/jannagy02"}, "edited": false, "score": 0, "creation_date": 1486582798, "post_id": 42121900, "comment_id": 71412318, "body": "You mean when the string &quot;DBSK&quot; is entered? Or what do you mean by DBSK?"}], "answers": [{"tags": [], "owner": {"reputation": 2193, "user_id": 1820196, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/89367ffb09964465a25d5d493a30ca88?s=128&d=identicon&r=PG", "display_name": "jannagy02", "link": "https://stackoverflow.com/users/1820196/jannagy02"}, "is_accepted": false, "score": 1, "last_activity_date": 1486590194, "last_edit_date": 1486590194, "creation_date": 1486586313, "answer_id": 42123140, "question_id": 42121900, "link": "https://stackoverflow.com/questions/42121900/changing-the-color-of-cell-upon-duplicate-triplicate-entry-in-a-row/42123140#42123140", "title": "Changing the color of cell upon duplicate, triplicate entry in a row", "body": "<p>I do it as an example in the range C2:H10</p>\n\n<p>First select the range like this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/y9fnF.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/y9fnF.png\" alt=\"enter image description here\"></a></p>\n\n<p>Then click on <code>Conditional formatting</code> and select <code>new rule</code>.</p>\n\n<p>Select the last rule type: with formular.</p>\n\n<p>You should edit the rule like this: <strong>Sorry, my excel has Hungarian settings :)</strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/EYfwQ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/EYfwQ.png\" alt=\"enter image description here\"></a></p>\n\n<p>Take a look at the formular:</p>\n\n<pre><code>=\u00c9S(C2=\"DBSK\"; DARABTELI($C2:$H2;\"DBSK\")=2)\n</code></pre>\n\n<p>In English it is something like this, but you can corrert if not good the syntax:</p>\n\n<pre><code>=AND(C2=\"DBSK\", COUNTIF($C2:$H2,\"DBSK\")=2)\n</code></pre>\n\n<p><code>C2</code>: The top-left cell of the range. <strong>Important:</strong> without $</p>\n\n<p><code>$C2:$H2</code>: The first row. <strong>Important:</strong> $ only before the C and H not before the numbers.</p>\n\n<p>After that create the next rule: click on <code>Conditional formatting</code> and select <code>new rule</code> again.</p>\n\n<p>This rule looks like this. </p>\n\n<p><a href=\"https://i.stack.imgur.com/vpprO.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/vpprO.png\" alt=\"enter image description here\"></a></p>\n\n<p>The end result looks like this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/nHvCv.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/nHvCv.png\" alt=\"enter image description here\"></a></p>\n\n<p>After that you can create the first rule for the green formatting similarly with the rule <code>=AND(C2=\"DBSK\", COUNTIF($C2:$H2,\"DBSK\")=1)</code></p>\n"}], "owner": {"reputation": 1, "user_id": 7536416, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c4308d60984ee9f7d311f6cc93bb0e1?s=128&d=identicon&r=PG&f=1", "display_name": "Deal Book", "link": "https://stackoverflow.com/users/7536416/deal-book"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 74, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1487317508, "creation_date": 1486581844, "last_edit_date": 1531164843, "question_id": 42121900, "link": "https://stackoverflow.com/questions/42121900/changing-the-color-of-cell-upon-duplicate-triplicate-entry-in-a-row", "title": "Changing the color of cell upon duplicate, triplicate entry in a row", "body": "<p>I currently have a Conditional Formatting set up to color code the cell Green if DBSK is entered for the first time within a row.  Although, if a second entry of DBSK is entered within the same row, I need that cell to turn Yellow (to alarm the user that this is the second incident) and then if the same entry is made a 3rd time within the row, I need that cell to then turn red (to alarm the user that this is the third and last incident allowed).  Maybe I should eliminate the Conditional Formatting altogether and just have some code written against it?</p>\n"}, {"tags": ["excel", "background-color", "sumifs", "vba"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1486582038, "post_id": 42121898, "comment_id": 71411863, "body": "No formula directly and you will need to write the vba.  Are these cells conditionally formatted to become highlighted?  Is so, what is the rule?"}, {"owner": {"reputation": 170, "user_id": 6801688, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11a37a17d5a095e296eabc8cd88e78a3?s=128&d=identicon&r=PG&f=1", "display_name": "Joe", "link": "https://stackoverflow.com/users/6801688/joe"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1486582243, "post_id": 42121898, "comment_id": 71411962, "body": "Echoing @ScottCraner here. Here&#39;s a fairly comprehensive guide to summing/counting by color (<a href=\"https://www.ablebits.com/office-addins-blog/2013/12/12/count-sum-by-color-excel/\" rel=\"nofollow noreferrer\">ablebits.com/office-addins-blog/2013/12/12/&hellip;</a>). Also as he pointed out, if the highlighting is coming from a conditional highlighting rule, you can just highlight the conditional highlighting rule and SUMIF based on that (it&#39;s more staightforward than tackling the highlighting approach in that case)."}, {"owner": {"reputation": 5, "user_id": 7536420, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c54ed544ca1d83c0093fb1443322315?s=128&d=identicon&r=PG&f=1", "display_name": "Innism", "link": "https://stackoverflow.com/users/7536420/innism"}, "edited": false, "score": 0, "creation_date": 1486583245, "post_id": 42121898, "comment_id": 71412581, "body": "The color is coming from a Macro from a search, which is from this website: <a href=\"http://www.pcadvisor.co.uk/forum/helproom-1/excel-2003-help-how-highlight-search-resukts-305437/\" rel=\"nofollow noreferrer\">pcadvisor.co.uk/forum/helproom-1/&hellip;</a>"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1486583922, "post_id": 42121898, "comment_id": 71412976, "body": "Then in that code keep a running total of the cells as they are highlighted using offset and put the answer in the desired cell when complete."}, {"owner": {"reputation": 5, "user_id": 7536420, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c54ed544ca1d83c0093fb1443322315?s=128&d=identicon&r=PG&f=1", "display_name": "Innism", "link": "https://stackoverflow.com/users/7536420/innism"}, "edited": false, "score": 0, "creation_date": 1486584173, "post_id": 42121898, "comment_id": 71413155, "body": "I&#39;m not familiar with offset, especially in conjunction with coding. Could you provide me with an example or a resource?"}], "answers": [{"tags": [], "owner": {"reputation": 2478, "user_id": 6110371, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/O93Qp.jpg?s=128&g=1", "display_name": "VBA Pete", "link": "https://stackoverflow.com/users/6110371/vba-pete"}, "is_accepted": true, "score": 2, "last_activity_date": 1486584306, "creation_date": 1486584306, "answer_id": 42122607, "question_id": 42121898, "link": "https://stackoverflow.com/questions/42121898/sumif-formula-based-on-background-color-of-adjacent-cell/42122607#42122607", "title": "Sumif formula based on background color of adjacent cell", "body": "<p>You could use a VBA function to sum all cells that are colored:\n<a href=\"https://i.stack.imgur.com/JYGk1.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/JYGk1.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>Code:</p>\n\n<pre><code>Public Function ColorSum(myRange As Range) As Variant\n\nDim rngCell As Range\nDim total As Variant\n\nFor Each rngCell In myRange.Cells\n\n    If rngCell.Interior.ColorIndex &lt;&gt; -4142 Then\n    total = total + rngCell.Offset(0, 1).Value\n    End If\n\nNext rngCell\n\nColorSum = total\n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 5, "user_id": 7536420, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c54ed544ca1d83c0093fb1443322315?s=128&d=identicon&r=PG&f=1", "display_name": "Innism", "link": "https://stackoverflow.com/users/7536420/innism"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2367, "favorite_count": 0, "accepted_answer_id": 42122607, "answer_count": 1, "score": 0, "last_activity_date": 1486584306, "creation_date": 1486581842, "last_edit_date": 1531161705, "question_id": 42121898, "link": "https://stackoverflow.com/questions/42121898/sumif-formula-based-on-background-color-of-adjacent-cell", "title": "Sumif formula based on background color of adjacent cell", "body": "<p>I was wondering if there is a Sumif formula that will sum all the values in Column B based on whether or not the cell next to it in Column A is highlighted. </p>\n\n<p>An example is the cells in A3 and A8 are highlighted yellow so I want the sum of the cells in B3 and B8 to go in F4. Is there a formula, or macro that I have to create to accomplish this?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 1, "creation_date": 1486580673, "post_id": 42121516, "comment_id": 71411137, "body": "Have you checked the number format? it appears that the value is correct, but the way it&#39;s being displayed is altered by formatting."}, {"owner": {"reputation": 63, "user_id": 7536288, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94df43165fca52cef7b8b0b722d947e9?s=128&d=identicon&r=PG&f=1", "display_name": "Climacus", "link": "https://stackoverflow.com/users/7536288/climacus"}, "reply_to_user": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 0, "creation_date": 1486582633, "post_id": 42121516, "comment_id": 71412229, "body": "Thanks Marco Man.   No changes.  It was set as General... Tried Text, Special..    No change."}, {"owner": {"reputation": 63, "user_id": 7536288, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94df43165fca52cef7b8b0b722d947e9?s=128&d=identicon&r=PG&f=1", "display_name": "Climacus", "link": "https://stackoverflow.com/users/7536288/climacus"}, "reply_to_user": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 0, "creation_date": 1486583258, "post_id": 42121516, "comment_id": 71412590, "body": "Sorry, Macro Man.   You did put me on to something...stripping the concatenation back bit by bit.  I found if I got rid of the Chr(13) from the Chr(10) + Chr(13) bit the spaces disappeared.  Can I use Chr(10) alone for hard enters across Windows devices, or may it cause issues?   Thanks."}, {"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 1, "creation_date": 1486583603, "post_id": 42121516, "comment_id": 71412809, "body": "Depends on the purpose of what you&#39;re doing. Generally Chr(10) on its own is fine for Windows."}, {"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 1, "creation_date": 1486583712, "post_id": 42121516, "comment_id": 71412858, "body": "Also, there are vb constants - <code>vbCr</code>, <code>vbLf</code> and <code>vbCrLf</code>/<code>vbNewLine</code> which are carriage return, line feed and carriage return+line feed respectively."}, {"owner": {"reputation": 63, "user_id": 7536288, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94df43165fca52cef7b8b0b722d947e9?s=128&d=identicon&r=PG&f=1", "display_name": "Climacus", "link": "https://stackoverflow.com/users/7536288/climacus"}, "reply_to_user": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 0, "creation_date": 1486585794, "post_id": 42121516, "comment_id": 71414063, "body": "Great! Thanks again Macro Man.  All of those vbConstants worked...it is only when I use Chr(13) that the random spaces before the ) appear. Thanks for that; I&#39;ll use the constants."}], "owner": {"reputation": 63, "user_id": 7536288, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94df43165fca52cef7b8b0b722d947e9?s=128&d=identicon&r=PG&f=1", "display_name": "Climacus", "link": "https://stackoverflow.com/users/7536288/climacus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 63, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1486580535, "creation_date": 1486580535, "last_edit_date": 1531164843, "question_id": 42121516, "link": "https://stackoverflow.com/questions/42121516/hidden-spaces-displayed-but-not-visible-in-cell-contents", "title": "Hidden spaces displayed but not visible in cell contents", "body": "<p>I am working on a VBA script to tidy up a Word table where users start splitting cells which causes problems for an automated assessement program.</p>\n\n<p>So, I may have something like this in a table:</p>\n\n<pre><code>    Write a journal.   HD         D        C         P\n                       (5 marks) (4 marks) \n                                           (3 marks)\n                                                     (2 marks)\n</code></pre>\n\n<p>(a 4 x 5 table)</p>\n\n<p>And want to get to:</p>\n\n<pre><code>    Write a journal.   HD         D        C         P\n                       (5 marks) (4 marks) (3 marks) (2 marks)\n</code></pre>\n\n<p>(a 2 x 5 table)</p>\n\n<p>So I am copying the table to Excel and then running a VBA script to do this.  Why am I not doing it in Word VBA?  Good question.  I started off with Excel as I am more comfortable in it.  May try it in Word once I get it working here.</p>\n\n<p>This is the code I used in a loop over the rows and columns which is at least merging the cells:</p>\n\n<pre><code>    Cells(dblStartRow, dblCurrentColumn).Value = Cells(dblStartRow, dblCurrentColumn).Value + Chr(10) + Chr(13) + Replace(Trim(Cells(dblCurrentRow, dblCurrentColumn).Value), Chr(160), \"\")\n</code></pre>\n\n<p>The issue I have is that it is coming out like this in the spreadsheet:</p>\n\n<pre><code>    Write a journal.   HD           D          C           P\n                       (5 marks  ) (4 marks  ) (3 marks  ) (2 marks  )\n</code></pre>\n\n<p>But if I look in the Excel cell/formula entry box it looks correct (i.e. no spaces before ) ):</p>\n\n<pre><code>    Write a journal.   HD         D        C         P\n                       (5 marks) (4 marks) (3 marks) (2 marks)\n</code></pre>\n\n<p>If I delete the ) the cursor immediately goes behind the \"s\" in marks, so there does not appear to be characters there.  And if I add the ) back in and press Enter then (5 marks) appears now instead of (5 marks  ).  I tried stripping chr(160) as in the formula above after some research, but I cannot find anything else that may be putting in these hidden spaces...   Is it possible the copying from Word is doing something, but then why are these hidden spaces not displayed in the formula bar?</p>\n\n<p>Any ideas?  Thanks.</p>\n"}, {"tags": ["vba", "excel", "excel-2016"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 7, "creation_date": 1486580117, "post_id": 42121272, "comment_id": 71410815, "body": "Remove the parentheses. They&#39;re forcing a call to the default member so you&#39;re actually trying to pass a Variant."}], "answers": [{"comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 6, "creation_date": 1486580557, "post_id": 42121476, "comment_id": 71411081, "body": "Call is actually obsolete syntax left over from the 1980s. Just take the parentheses off the argument."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 2, "creation_date": 1486581504, "post_id": 42121476, "comment_id": 71411557, "body": "^^ <a href=\"http://rubberduckvba.com/Inspections/Details/ObsoleteCallStatementInspection\" rel=\"nofollow noreferrer\">Rubberduck will tell you that</a>, too (both Comintern &amp; I are devs on that OSS project)."}, {"owner": {"reputation": 907, "user_id": 4846776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6624129bc37cb9e0aa313abcf9b74fb3?s=128&d=identicon&r=PG&f=1", "display_name": "PaulG", "link": "https://stackoverflow.com/users/4846776/paulg"}, "edited": false, "score": 0, "creation_date": 1486588668, "post_id": 42121476, "comment_id": 71415668, "body": "Why was that marked down? There is nothing wrong with using call SomeFunc() with parenthesis. This was marked down for this? Using call is a matter of preference, albeit not necessary. I actually prefer to use it because the code is looks cleaner to me. Actually +1 for finding your issue, and posting it. By the way you can pass your Range object Byval unless you wish to reassign the variable. The reference of the Range object is copied and not the huge Range object."}, {"owner": {"reputation": 5595, "user_id": 2832561, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/191d947cf1b55615499091bb17dd2961?s=128&d=identicon&r=PG&f=1", "display_name": "Blackhawk", "link": "https://stackoverflow.com/users/2832561/blackhawk"}, "reply_to_user": {"reputation": 907, "user_id": 4846776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6624129bc37cb9e0aa313abcf9b74fb3?s=128&d=identicon&r=PG&f=1", "display_name": "PaulG", "link": "https://stackoverflow.com/users/4846776/paulg"}, "edited": false, "score": 0, "creation_date": 1486589397, "post_id": 42121476, "comment_id": 71416052, "body": "@PaulG in VBA, if you&#39;re calling a &quot;Sub&quot; (does not return a value), you need to omit parenthesis around the parameters. If you are calling a &quot;Function&quot;, you must include them."}, {"owner": {"reputation": 5595, "user_id": 2832561, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/191d947cf1b55615499091bb17dd2961?s=128&d=identicon&r=PG&f=1", "display_name": "Blackhawk", "link": "https://stackoverflow.com/users/2832561/blackhawk"}, "reply_to_user": {"reputation": 907, "user_id": 4846776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6624129bc37cb9e0aa313abcf9b74fb3?s=128&d=identicon&r=PG&f=1", "display_name": "PaulG", "link": "https://stackoverflow.com/users/4846776/paulg"}, "edited": false, "score": 2, "creation_date": 1486590389, "post_id": 42121476, "comment_id": 71416539, "body": "@PaulG to be more specific, since the parenthesis are not considered part of the Sub function call, they are instead treated as grouping parenthesis, telling VBA to evaluate everything inside of them before proceeding with the rest of that line of code. Unfortunately, if an Object has a default property, VBA treats the parenthetic Object as a call of its default member. In this case, the default member of Range is Value of type Variant. Once VBA has evaluated a Range to obtain its Value (in my simple test, a String), it cannot be then converted back to a Range so VBA complains."}, {"owner": {"reputation": 907, "user_id": 4846776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6624129bc37cb9e0aa313abcf9b74fb3?s=128&d=identicon&r=PG&f=1", "display_name": "PaulG", "link": "https://stackoverflow.com/users/4846776/paulg"}, "reply_to_user": {"reputation": 5595, "user_id": 2832561, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/191d947cf1b55615499091bb17dd2961?s=128&d=identicon&r=PG&f=1", "display_name": "Blackhawk", "link": "https://stackoverflow.com/users/2832561/blackhawk"}, "edited": false, "score": 0, "creation_date": 1486633369, "post_id": 42121476, "comment_id": 71432899, "body": "@Blackhawk. That isn&#39;t true. You can invoke a Sub in two ways: 1. Call SomeRoutine(SomeObject) 2. SomeRoutine SomeObject."}, {"owner": {"reputation": 907, "user_id": 4846776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6624129bc37cb9e0aa313abcf9b74fb3?s=128&d=identicon&r=PG&f=1", "display_name": "PaulG", "link": "https://stackoverflow.com/users/4846776/paulg"}, "edited": false, "score": 0, "creation_date": 1486633942, "post_id": 42121476, "comment_id": 71433273, "body": "I understand Default properties and all that. No idea what you are getting at there mind. When I invoke a routined defined as something like: Public Sub DisplaySomeRange(Byval Data as Range). The Data object is a range. The reference on the call stack is a reference to a range. In the routine it is a range and I code against it as a range. Nothing to do with Default properties. That is used when the Range object is invoked inside the Routine. Is that not true?"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "reply_to_user": {"reputation": 907, "user_id": 4846776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6624129bc37cb9e0aa313abcf9b74fb3?s=128&d=identicon&r=PG&f=1", "display_name": "PaulG", "link": "https://stackoverflow.com/users/4846776/paulg"}, "edited": false, "score": 2, "creation_date": 1486649376, "post_id": 42121476, "comment_id": 71443868, "body": "@PaulG - It has nothing to do with the parameter declaration - it has to do with the how the call is made. When you use <code>Call</code>, the parentheses are treated as enclosing an argument list - otherwise the grammar would be ambiguous, i.e. <code>Call Foo Bar</code>.  When <code>Call</code> is omitted, the parentheses are treated as an expression, and as Blackhawk points out, these are evaluated <i>before the function call</i> and passed <code>ByVal</code>. If it&#39;s a reference type, the default member is resolved. You can demo this with <code>Debug.Print TypeName((Range(&quot;A1&quot;)))</code>."}, {"owner": {"reputation": 5595, "user_id": 2832561, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/191d947cf1b55615499091bb17dd2961?s=128&d=identicon&r=PG&f=1", "display_name": "Blackhawk", "link": "https://stackoverflow.com/users/2832561/blackhawk"}, "reply_to_user": {"reputation": 907, "user_id": 4846776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6624129bc37cb9e0aa313abcf9b74fb3?s=128&d=identicon&r=PG&f=1", "display_name": "PaulG", "link": "https://stackoverflow.com/users/4846776/paulg"}, "edited": false, "score": 1, "creation_date": 1486657544, "post_id": 42121476, "comment_id": 71449858, "body": "@PaulG My experience is the same as Comintern&#39;s - that Call should be considered deprecated - so I didn&#39;t include it in my comment. I will try to clarify in an answer."}, {"owner": {"reputation": 5595, "user_id": 2832561, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/191d947cf1b55615499091bb17dd2961?s=128&d=identicon&r=PG&f=1", "display_name": "Blackhawk", "link": "https://stackoverflow.com/users/2832561/blackhawk"}, "reply_to_user": {"reputation": 907, "user_id": 4846776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6624129bc37cb9e0aa313abcf9b74fb3?s=128&d=identicon&r=PG&f=1", "display_name": "PaulG", "link": "https://stackoverflow.com/users/4846776/paulg"}, "edited": false, "score": 2, "creation_date": 1486660308, "post_id": 42121476, "comment_id": 71451726, "body": "@PaulG take a look at the answer I posted - I give a couple of example in there to see how putting parenthesis around an Object can invoke its default property."}], "tags": [], "owner": {"reputation": 57, "user_id": 684223, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8efe200ae3fa0066011f69438ac8cfb?s=128&d=identicon&r=PG", "display_name": "HadziJo", "link": "https://stackoverflow.com/users/684223/hadzijo"}, "is_accepted": false, "score": -1, "last_activity_date": 1486580411, "creation_date": 1486580411, "answer_id": 42121476, "question_id": 42121272, "link": "https://stackoverflow.com/questions/42121272/how-do-i-pass-a-range-obj-variable-to-a-sub-in-excel-vba-2016/42121476#42121476", "title": "How do I pass a range obj variable to a sub in Excel VBA (2016)", "body": "<p>okay, I knew after I posted this question I'd be struck by lighting and receive an answer.</p>\n\n<p>When passing an object VARIABLE to a sub-function and wishing to use parentheses \"()\", one must use CALL! Thus the correction to my code sample is:</p>\n\n<pre><code>**CALL doSomethingToRows(RegionOfInterest)**\n</code></pre>\n\n<p>Thank you!</p>\n"}, {"tags": [], "owner": {"reputation": 907, "user_id": 4846776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6624129bc37cb9e0aa313abcf9b74fb3?s=128&d=identicon&r=PG&f=1", "display_name": "PaulG", "link": "https://stackoverflow.com/users/4846776/paulg"}, "is_accepted": false, "score": -3, "last_activity_date": 1486652322, "last_edit_date": 1486652322, "creation_date": 1486634872, "answer_id": 42133693, "question_id": 42121272, "link": "https://stackoverflow.com/questions/42121272/how-do-i-pass-a-range-obj-variable-to-a-sub-in-excel-vba-2016/42133693#42133693", "title": "How do I pass a range obj variable to a sub in Excel VBA (2016)", "body": "<p>Maybe we're talking about different things, but here's an example to make it a bit clearer what I mean.</p>\n\n<pre><code>Option Explicit\n\nSub TestDisplay()\nDim r As Range\n\n'Create some range object\nSet r = Range(\"A1\")\n'Invoke with Call.\nCall DisplaySomething(r)\n'Invoke without Call.\nDisplaySomething r\n\nEnd Sub\n\nSub DisplaySomething(ByVal Data As Range)\nDebug.Print \"Hi my type is \" &amp; TypeName(Data)\nEnd Sub\n</code></pre>\n\n<p>Both calls work perfectly. One with Call and the other without.</p>\n\n<p>Edit:\n@Conintern. Thanks for explaining that. I see what is meant now.</p>\n\n<p>However, I still respectively disagree.\nIf I declare the following:</p>\n\n<pre><code>Function DisplaySomething(ByVal Data As String)\nDisplaySomething = \"Hi my type is \" &amp; TypeName(Data)\nEnd Function\n</code></pre>\n\n<p>and invoke it:</p>\n\n<p>Debug.print DisplaySomething(Range(\"A1\"))</p>\n\n<p>I believe that Excel has been clever and converted to a string. It can do that by invoking the Default Parameter and can convert to a string.</p>\n\n<p>However, as in the original parameter example, If I declare the following:</p>\n\n<pre><code>Function DisplaySomething(ByVal Data As Range)\nDisplaySomething = \"Hi my type is \" &amp; TypeName(Data)\nEnd Function\n</code></pre>\n\n<p>There is no call on the Default Parameter, however it is called, because Excel was able to resolve it to that type. </p>\n\n<pre><code>Function DisplaySomething(ByVal Data As Double)\nDisplaySomething = \"Hi my type is \" &amp; TypeName(Data)\nEnd Function\n</code></pre>\n\n<p>will return a double because it was able to coerce to a double.</p>\n\n<p>Indeed in those examples the Default was called.\nBut in this example we are defining as Range. No Default called there however it is invoked - brackets or no brackets. </p>\n\n<p>I believe this is more to do with Excel and data coercion.\nSimilar to the following:</p>\n\n<pre><code>Public Function Test(ByVal i As String) As Integer\nTest = i\nEnd Function\n</code></pre>\n\n<p>and invoking with:\nDebug.print Test(\"1\")</p>\n\n<p>BTW, yes I know this isn't an object without a Default parmeter. Im pointing out data coercion. Excel does its best to resolve it.</p>\n\n<p>Could be wrong mind you...</p>\n"}, {"comments": [{"owner": {"reputation": 907, "user_id": 4846776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6624129bc37cb9e0aa313abcf9b74fb3?s=128&d=identicon&r=PG&f=1", "display_name": "PaulG", "link": "https://stackoverflow.com/users/4846776/paulg"}, "edited": false, "score": 0, "creation_date": 1486665511, "post_id": 42142810, "comment_id": 71455041, "body": "1. I agree with the MS Doc in yellow. Like I said in my earlier post you can call it two ways. If you use the Call you need the (). If not then you don&#39;t, Period. 2. You&#39;re call Set v = (Range(&quot;A1&quot;)) has brackets around it. Excel is trying to evaluate it, yes I get that but thats because you have supplied EXTRA brackets around it. His call DOES NOT supply extra brackets around it, Thats why you are getting the type exception. You are trying to say you are returning an object when you are FORCING the compiler to evaluate the function which will call the default parameters."}, {"owner": {"reputation": 907, "user_id": 4846776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6624129bc37cb9e0aa313abcf9b74fb3?s=128&d=identicon&r=PG&f=1", "display_name": "PaulG", "link": "https://stackoverflow.com/users/4846776/paulg"}, "edited": false, "score": 0, "creation_date": 1486665606, "post_id": 42142810, "comment_id": 71455094, "body": "3. His code does not have any additional parameter around the invocation. Excel is passing the Range object into the parameter. Your example is a totally different invocation. Its forcing it to behave differently. It can&#39;t be calling the default parameter because its casting it to a Range. You would get a type exception if it did."}, {"owner": {"reputation": 5595, "user_id": 2832561, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/191d947cf1b55615499091bb17dd2961?s=128&d=identicon&r=PG&f=1", "display_name": "Blackhawk", "link": "https://stackoverflow.com/users/2832561/blackhawk"}, "reply_to_user": {"reputation": 907, "user_id": 4846776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6624129bc37cb9e0aa313abcf9b74fb3?s=128&d=identicon&r=PG&f=1", "display_name": "PaulG", "link": "https://stackoverflow.com/users/4846776/paulg"}, "edited": false, "score": 1, "creation_date": 1486665808, "post_id": 42142810, "comment_id": 71455212, "body": "@PaulG The OP&#39;s incorrect code is <code>doSomethingToRows (Worksheets(&quot;Sheet1&quot;).Range(&quot;B5:C15&quot;))</code>. <code>doSomethingToRows</code> is a Sub, and therefore it needs to be called without parenthesis around the argument list, like this <code>doSomethingToRows Worksheets(&quot;Sheet1&quot;).Range(&quot;B5:C15&quot;)</code>. However, as you can see they included parenthesis around the Range, which causes VBA to evaluate the Range&#39;s default property."}, {"owner": {"reputation": 907, "user_id": 4846776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6624129bc37cb9e0aa313abcf9b74fb3?s=128&d=identicon&r=PG&f=1", "display_name": "PaulG", "link": "https://stackoverflow.com/users/4846776/paulg"}, "edited": false, "score": 0, "creation_date": 1486665921, "post_id": 42142810, "comment_id": 71455276, "body": "How come my example where I call them two different ways works? The function expects a Range object. There is no way it is not a range object. You cannot cast the default property of a range object to a Range object. There is no default property being called. Your extra bracketed example is forcing this, which he does not do."}, {"owner": {"reputation": 5595, "user_id": 2832561, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/191d947cf1b55615499091bb17dd2961?s=128&d=identicon&r=PG&f=1", "display_name": "Blackhawk", "link": "https://stackoverflow.com/users/2832561/blackhawk"}, "reply_to_user": {"reputation": 907, "user_id": 4846776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6624129bc37cb9e0aa313abcf9b74fb3?s=128&d=identicon&r=PG&f=1", "display_name": "PaulG", "link": "https://stackoverflow.com/users/4846776/paulg"}, "edited": false, "score": 0, "creation_date": 1486666884, "post_id": 42142810, "comment_id": 71455772, "body": "@PaulG ah, I see the confusion! Yes, VBA does attempt implicit conversion of arguments to the types of the expected parameters. If it succeeds, you don&#39;t have any errors and it works as expected."}, {"owner": {"reputation": 5595, "user_id": 2832561, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/191d947cf1b55615499091bb17dd2961?s=128&d=identicon&r=PG&f=1", "display_name": "Blackhawk", "link": "https://stackoverflow.com/users/2832561/blackhawk"}, "reply_to_user": {"reputation": 907, "user_id": 4846776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6624129bc37cb9e0aa313abcf9b74fb3?s=128&d=identicon&r=PG&f=1", "display_name": "PaulG", "link": "https://stackoverflow.com/users/4846776/paulg"}, "edited": false, "score": 1, "creation_date": 1486666943, "post_id": 42142810, "comment_id": 71455799, "body": "@PaulG For your <code>DisplaySomething(ByVal Data As String)</code> example, if you call <i>without</i> parenthesis, VBA takes the Range object and attempts (successfully) an implicit conversion to String. If you call <i>with</i> the extraneous parenthesis, the evaluation of the parenthesized expression evaluates the Range object&#39;s default parameter, yielding a Variant containing a String or Empty or Double, etc. Then VBA attempts to implicitly convert this to a String (the type of the Sub parameter). If this is successful, the subroutine runs and no error occurs."}, {"owner": {"reputation": 907, "user_id": 4846776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6624129bc37cb9e0aa313abcf9b74fb3?s=128&d=identicon&r=PG&f=1", "display_name": "PaulG", "link": "https://stackoverflow.com/users/4846776/paulg"}, "edited": false, "score": 0, "creation_date": 1486667256, "post_id": 42142810, "comment_id": 71455978, "body": "Nice: What about the invocation to the declation DisplaySomething(ByVal Data As Range). as he has defined in his post. It has to accept a Range object or we get a type error. Both calls succeed so both calls are of type Range. Because they are of type range, the default parameter cannot have been called because this would be a different type."}, {"owner": {"reputation": 907, "user_id": 4846776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6624129bc37cb9e0aa313abcf9b74fb3?s=128&d=identicon&r=PG&f=1", "display_name": "PaulG", "link": "https://stackoverflow.com/users/4846776/paulg"}, "edited": false, "score": 0, "creation_date": 1486667397, "post_id": 42142810, "comment_id": 71456061, "body": "Anyway, all that aside, I still refer to my original post. I don&#39;t think this merited a mark down since he posted a solution (valid in my opinion, but not everyone else). If he was incorrect, someone should have just comented.corrected his error. :)"}, {"owner": {"reputation": 5595, "user_id": 2832561, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/191d947cf1b55615499091bb17dd2961?s=128&d=identicon&r=PG&f=1", "display_name": "Blackhawk", "link": "https://stackoverflow.com/users/2832561/blackhawk"}, "reply_to_user": {"reputation": 907, "user_id": 4846776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6624129bc37cb9e0aa313abcf9b74fb3?s=128&d=identicon&r=PG&f=1", "display_name": "PaulG", "link": "https://stackoverflow.com/users/4846776/paulg"}, "edited": false, "score": 1, "creation_date": 1486667836, "post_id": 42142810, "comment_id": 71456282, "body": "@PaulG The OP only calls his function once, incorrectly - which other call are you referring to? If you mean his answer, that is covered by the MSDN documentation: If you use <code>Call</code>, you must also then provide parenthesis around the argument list. VBA interprets these parenthesis as part of the invocation and <i>not</i> grouping parenthesis. However, if you invoke a Sub without <code>Call</code>, you must <i>omit</i> parenthesis. If you include parenthesis, they are not interpreted by VBA as part of the sub invocation. (also, the downvote wasn&#39;t me :P)"}, {"owner": {"reputation": 907, "user_id": 4846776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6624129bc37cb9e0aa313abcf9b74fb3?s=128&d=identicon&r=PG&f=1", "display_name": "PaulG", "link": "https://stackoverflow.com/users/4846776/paulg"}, "edited": false, "score": 0, "creation_date": 1486668231, "post_id": 42142810, "comment_id": 71456517, "body": "Seriously? that is just not in question, I agree. BUT you can call them both ways. Call requires params, No Call doesn&#39;t. Lovely. My question is if his function is  Sub  DisplaySomething(ByVal Data As Range) - notice the RANGE bit. It is invoked both ways  in my example, one with a Call with params and the other without. Both work, no errors, no type exceptions. The type passed in has to be a Range type for both calls. The issue I have is, there is no default parameter being called. To me its impossible. Unless you can explain that. But hey lets just move on. :)"}, {"owner": {"reputation": 5595, "user_id": 2832561, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/191d947cf1b55615499091bb17dd2961?s=128&d=identicon&r=PG&f=1", "display_name": "Blackhawk", "link": "https://stackoverflow.com/users/2832561/blackhawk"}, "reply_to_user": {"reputation": 907, "user_id": 4846776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6624129bc37cb9e0aa313abcf9b74fb3?s=128&d=identicon&r=PG&f=1", "display_name": "PaulG", "link": "https://stackoverflow.com/users/4846776/paulg"}, "edited": false, "score": 0, "creation_date": 1486668548, "post_id": 42142810, "comment_id": 71456691, "body": "@PaulG you called it with and without the <code>Call</code> keyword, both correctly by the msdn documentation. Try calling it incorrectly like this: <code>DisplaySomething(r)</code>, without the <code>Call</code> keyword."}, {"owner": {"reputation": 5595, "user_id": 2832561, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/191d947cf1b55615499091bb17dd2961?s=128&d=identicon&r=PG&f=1", "display_name": "Blackhawk", "link": "https://stackoverflow.com/users/2832561/blackhawk"}, "reply_to_user": {"reputation": 907, "user_id": 4846776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6624129bc37cb9e0aa313abcf9b74fb3?s=128&d=identicon&r=PG&f=1", "display_name": "PaulG", "link": "https://stackoverflow.com/users/4846776/paulg"}, "edited": false, "score": 2, "creation_date": 1486668639, "post_id": 42142810, "comment_id": 71456747, "body": "@PaulG I will leave it at that - we&#39;ve commented the poor OP&#39;s question to heck and back :P But I will leave you with one more resource: the <a href=\"http://interoperability.blob.core.windows.net/files/MS-VBAL/%5BMS-VBAL%5D.pdf\" rel=\"nofollow noreferrer\">VBA Language Specification (VBAL)</a>. See section 5.5 for more information on how VBA performs implicit conversion."}, {"owner": {"reputation": 907, "user_id": 4846776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6624129bc37cb9e0aa313abcf9b74fb3?s=128&d=identicon&r=PG&f=1", "display_name": "PaulG", "link": "https://stackoverflow.com/users/4846776/paulg"}, "edited": false, "score": 0, "creation_date": 1486669197, "post_id": 42142810, "comment_id": 71457053, "body": "Lol that was his issue. He missed off the Call. You&#39;re not supposed to call it like that, which he corrected by putting the call in front.  My code doesn&#39;t call it like that. Its an incorrect call. Mine is not. Take a look. So how does the calls which I&#39;ve called CORRECTLY not get a compilation/run error. Its because the types passed in are Range. No parameter invokation."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 907, "user_id": 4846776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6624129bc37cb9e0aa313abcf9b74fb3?s=128&d=identicon&r=PG&f=1", "display_name": "PaulG", "link": "https://stackoverflow.com/users/4846776/paulg"}, "edited": false, "score": 2, "creation_date": 1486669971, "post_id": 42142810, "comment_id": 71457541, "body": "@PaulG the point &amp; the matter is, extraneous parens cause their contents to be evaluated <b>before</b> the result is passed to the called procedure (and possibly coerced to the parameter&#39;s type). Also, no offense, but Blackhawk and Comintern know their VBA inside out (quite literally), and <code>Call</code> is deprecated/obsolete syntax that has absolutely <a href=\"http://stackoverflow.com/a/22325284/1188513\">zero valid use case</a> in any code written this century. I&#39;m not sure what all this arguing is about, but I&#39;m flagging this whole mess for a cleanup."}, {"owner": {"reputation": 907, "user_id": 4846776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6624129bc37cb9e0aa313abcf9b74fb3?s=128&d=identicon&r=PG&f=1", "display_name": "PaulG", "link": "https://stackoverflow.com/users/4846776/paulg"}, "edited": false, "score": 0, "creation_date": 1486670649, "post_id": 42142810, "comment_id": 71457943, "body": "No offence caused. It was me that said the coersion was happening. Please go ahead and clean up or remove anything belonging to me on this post. BTW I know my VBA as well."}, {"owner": {"reputation": 40613, "user_id": 4099593, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/zweIW.png?s=128&g=1", "display_name": "Bhargav Rao", "link": "https://stackoverflow.com/users/4099593/bhargav-rao"}, "edited": false, "score": 0, "creation_date": 1486710431, "post_id": 42142810, "comment_id": 71472752, "body": "Comments are not for extended discussion; this conversation has been <a href=\"http://chat.stackoverflow.com/rooms/135350/discussion-on-answer-by-blackhawk-how-do-i-pass-a-range-obj-variable-to-a-sub-in\">moved to chat</a>."}], "tags": [], "owner": {"reputation": 5595, "user_id": 2832561, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/191d947cf1b55615499091bb17dd2961?s=128&d=identicon&r=PG&f=1", "display_name": "Blackhawk", "link": "https://stackoverflow.com/users/2832561/blackhawk"}, "is_accepted": false, "score": 5, "last_activity_date": 1486666246, "last_edit_date": 1486666246, "creation_date": 1486660237, "answer_id": 42142810, "question_id": 42121272, "link": "https://stackoverflow.com/questions/42121272/how-do-i-pass-a-range-obj-variable-to-a-sub-in-excel-vba-2016/42142810#42142810", "title": "How do I pass a range obj variable to a sub in Excel VBA (2016)", "body": "<p>From the <a href=\"https://msdn.microsoft.com/en-us/library/office/gg251710.aspx\" rel=\"nofollow noreferrer\">msdn documentation of the Call keyword statement</a>,</p>\n\n<blockquote>\n  <p>Remarks </p>\n  \n  <p>You are not required to use the Call keyword when calling a procedure.\n  However, if you use the Call keyword to call a procedure that requires\n  arguments, argumentlist must be enclosed in parentheses. <strong>If you omit\n  the Call keyword, you also must omit the parentheses around\n  argumentlist</strong>. If you use either Call syntax to call any intrinsic or\n  user-defined function, the function's return value is discarded.</p>\n  \n  <p>To pass a whole array to a procedure, use the array name followed by\n  empty parentheses.</p>\n</blockquote>\n\n<p>From a practical standpoint, even though Subs can be called with or without the \"Call\" keyword, it makes sense to pick one way and stick with it as part of your coding style. I agree with Comintern - it is my opinion, based on observation of modern VBA code, that using the \"Call\" keyword should be considered deprecated. Instead, invoke Subs without parenthesis around the argument list.</p>\n\n<p>And now the answer to the important question: </p>\n\n<p><strong>Why does your code throw an error?</strong></p>\n\n<p>Take for example the following Subroutine:</p>\n\n<pre><code>Public Sub ShowSum(arg1 As Long, arg2 As Long)\n    MsgBox arg1 + arg2\nEnd Sub\n</code></pre>\n\n<p>We have established that, if not using the <code>Call</code> keyword, Subs must be invoked like so:</p>\n\n<p>ShowSum 45, 37</p>\n\n<p>What happens if it were instead called like <code>ShowSum(45, 37)</code>? Well, you wouldn't even be able to compile as VBA immediately complains \"Expected =\". This is because the VBA parser sees the parenthesis and decides that this must be a <strong><code>Function</code></strong> call, and it therefore expects you to be handling the return value with an \"=\" assignment statement.</p>\n\n<p>What about a Sub with only one argument? For example:</p>\n\n<pre><code>Public Sub ShowNum(arg1 As Long)\n    MsgBox arg1\nEnd Sub\n</code></pre>\n\n<p>The correct way to call this Sub is <code>ShowNum 45</code>. But what if you typed this into the VBA IDE: <code>ShowNum(45)</code>? As soon as you move the cursor off of the line, you'll notice that VBA adds a space between the Sub name and the opening parenthesis, giving you a crucial clue as to how the line of code is actually being interpreted:</p>\n\n<pre><code>ShowNum (45)\n</code></pre>\n\n<p>VBA is not treating those parenthesis as if they surrounded the argument list - it is instead treating them as grouping parenthesis. MOST of the time, this wouldn't matter, but it does in the case of Objects which have a default member.</p>\n\n<p>To see the problem this causes, try running the following:</p>\n\n<pre><code>Dim v As Variant\nSet v = Range(\"A1\")\nSet v = (Range(\"A1\"))  '&lt;--- type mismatch here\n</code></pre>\n\n<p>Notice that you get a \"Type Mismatch\" on the marked line. Now add those two statements to the watch window and look at the \"Type\" column:</p>\n\n<pre><code>+-------------+-----+--------------+\n| Expression  |Value|     Type     |\n+-------------+-----+--------------+\n|Range(\"A1\")  |     |Object/Range  |\n|(Range(\"A1\"))|     |Variant/String|\n+-------------+-----+--------------+\n</code></pre>\n\n<p>When you surround an Object with grouping parenthesis, its default property is evaluated - in the case of the Range object, it is the Value property.</p>\n\n<p>So it's really just a coincidence that VBA allowed you to get away with \"putting parenthesis around the argumentlist\" - really, VBA just interprets this as grouping parenthesis and evaluates the value accordingly. You can see by trying the same thing on a Sub with multiple parameters that it is invalid in VBA to invoke a Sub with parenthesis around the argument list.</p>\n\n<p>@PaulG</p>\n\n<p>Try this:</p>\n\n<pre><code>Public Sub Main()\n    Debug.Print TypeName(Range(\"A1\"))\n    Debug.Print TypeName((Range(\"A1\")))\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 57, "user_id": 684223, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8efe200ae3fa0066011f69438ac8cfb?s=128&d=identicon&r=PG", "display_name": "HadziJo", "link": "https://stackoverflow.com/users/684223/hadzijo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2575, "favorite_count": 1, "closed_date": 1486673832, "answer_count": 3, "score": 0, "last_activity_date": 1486666246, "creation_date": 1486579751, "last_edit_date": 1486581065, "question_id": 42121272, "link": "https://stackoverflow.com/questions/42121272/how-do-i-pass-a-range-obj-variable-to-a-sub-in-excel-vba-2016", "closed_reason": "Duplicate", "title": "How do I pass a range obj variable to a sub in Excel VBA (2016)", "body": "<p><strong>Given the following code:</strong>\nI can not seem to successfully pass a <strong>Range</strong> Object Variable from one sub-function to another. I spent an entire day researching, and experimenting before I swallowed pride and came here. </p>\n\n<p>Please read the comments below, and reply with any ideas you have regarding why the LAST two lines will not behave. </p>\n\n<pre><code>Public Sub doSomethingToRows(ROI As Range)\n*'do Something with the cell values within the supplied range*\n\nEnd Sub\n'\nPublic Sub testDoAltRows()\n\n    Dim RegionOfInterest As Range       'is this an object or not?\n\n    '*The following yields: Class doesn't support Automation (Error 430)*\n    '*Set RegionOfInterest = New Worksheet 'this just gives an error*\n\n    Set RegionOfInterest = Worksheets(\"Sheet1\").Range(\"A1\")\n    RegionOfInterest.Value = 1234.56        '*okay, updates cell A1*\n\n    Set RegionOfInterest = Worksheets(\"Sheet1\").Range(\"B5:D15\")\n    RegionOfInterest.Columns(2).Value = \"~~~~~~\"    '*okay*\n\n    'doSomethingToRows (RegionOfInterest)   'why do I get \"OBJECT IS REQUIRED\" error?\n    doSomethingToRows (Worksheets(\"Sheet1\").Range(\"B5:C15\")) 'but this executes okay\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "timezone", "utc", "dst"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1486584994, "post_id": 42120325, "comment_id": 71413611, "body": "Where are you getting the timestamp <i>from</i>? Why is everything declared with a type of <code>Currency</code>?"}, {"owner": {"reputation": 33, "user_id": 7358255, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52c615cfa143b09052912fa1c2383710?s=128&d=identicon&r=PG&f=1", "display_name": "Fang Dong", "link": "https://stackoverflow.com/users/7358255/fang-dong"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1487016372, "post_id": 42120325, "comment_id": 71586514, "body": "I didn&#39;t see any Currency? the UNIX timestamp is from http json text, which is from DB."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 1, "creation_date": 1487016550, "post_id": 42120325, "comment_id": 71586599, "body": "<code>src@</code> is the same thing as <code>src As Currency</code>.  See the <a href=\"http://stackoverflow.com/documentation/vba/877/declaring-variables/2960/type-hints\">documentation page</a> on type hints."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1487016665, "post_id": 42120325, "comment_id": 71586670, "body": "Do you have a sample of the json text and how you&#39;re processing it?"}, {"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 0, "creation_date": 1487018890, "post_id": 42120325, "comment_id": 71587818, "body": "If you&#39;re processing historical data, make sure your routine considers the fact that the date of DST change changed (in the US at least) several years ago. For example, the US goes on DST on 12 Mar 2017, but in the past it would have been 3-4 weeks later on either 2 Apr or 9 Apr (if I recall correctly). No, sorry, don&#39;t remember the year that switch was made, but I believe it was during Bush 2&#39;s administration."}, {"owner": {"reputation": 195413, "user_id": 634824, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/889cf720c96957e615463b5c903a5e18?s=128&d=identicon&r=PG", "display_name": "Matt Johnson-Pint", "link": "https://stackoverflow.com/users/634824/matt-johnson-pint"}, "reply_to_user": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 0, "creation_date": 1487019255, "post_id": 42120325, "comment_id": 71588004, "body": "@FreeMan - Yep.  The <code>FileTimeToLocalFileTime</code> function in the question doesn&#39;t take this into account. The <a href=\"https://msdn.microsoft.com/library/windows/desktop/ms724277.aspx\" rel=\"nofollow noreferrer\">MSDN page for it</a> describes an alternate Win32 approach in the Remarks section.  My answer below already accounts for that just fine.  Thanks."}], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 7358255, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52c615cfa143b09052912fa1c2383710?s=128&d=identicon&r=PG&f=1", "display_name": "Fang Dong", "link": "https://stackoverflow.com/users/7358255/fang-dong"}, "edited": false, "score": 0, "creation_date": 1487086843, "post_id": 42212948, "comment_id": 71620047, "body": "Thanks for your answer! After my verification, you are right."}], "tags": [], "owner": {"reputation": 195413, "user_id": 634824, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/889cf720c96957e615463b5c903a5e18?s=128&d=identicon&r=PG", "display_name": "Matt Johnson-Pint", "link": "https://stackoverflow.com/users/634824/matt-johnson-pint"}, "is_accepted": true, "score": 2, "last_activity_date": 1487017715, "last_edit_date": 1495540903, "creation_date": 1487017715, "answer_id": 42212948, "question_id": 42120325, "link": "https://stackoverflow.com/questions/42120325/in-vba-how-to-convert-a-utc-unix-timestamp-to-local-timezone-date-in-a-simple-w/42212948#42212948", "title": "In VBA, How to convert a UTC UNIX timestamp to Local timezone Date in a simple way?", "body": "<p>Probably the easiest way is via COM Interop to use the <code>DateTime</code> APIs built in to .NET.  There's a good intro to this approach <a href=\"https://stackoverflow.com/a/19955042/634824\">in this answer</a>.</p>\n\n<p>Create a C# class library.  To make things simpler, target .NET Framework 4.6 or higher, so you can use the <code>FromUnixTimeSeconds</code> and <code>ToUnixTimeSeconds</code> methods on the <code>DateTimeOffset</code> class.</p>\n\n<pre class=\"lang-csharp prettyprint-override\"><code>using System;\nusing System.Runtime.InteropServices;\n\nnamespace MyDateTimeLibrary\n{\n    [Serializable]\n    [ComVisible(true)]\n    [ClassInterface(ClassInterfaceType.AutoDual)]\n    public class DateTimeFunctions\n    {\n        public DateTime UnixTimeToDateTime(int unixTimeInSeconds)\n        {\n            return DateTimeOffset.FromUnixTimeSeconds(unixTimeInSeconds).UtcDateTime;\n        }\n\n        public long DateTimeUtcToUnixTime(DateTime utcDateTime)\n        {\n            return new DateTimeOffset(utcDateTime, TimeSpan.Zero).ToUnixTimeSeconds();\n        }\n\n        public DateTime UtcToLocal(DateTime utcDateTime)\n        {\n            return utcDateTime.ToLocalTime();\n        }\n\n        public DateTime LocalToUtc(DateTime localDateTime)\n        {\n            return localDateTime.ToUniversalTime();\n        }\n\n        public DateTime TZSpecificDateTimeToUTC(DateTime sourceDateTime, string sourceTimeZoneId)\n        {\n            var tzi = TimeZoneInfo.FindSystemTimeZoneById(sourceTimeZoneId);\n            return TimeZoneInfo.ConvertTimeToUtc(sourceDateTime, tzi);\n        }\n\n        public DateTime UTCToTZSpecificDateTime(DateTime utcDateTime, string destinationTimeZoneId)\n        {\n            var tzi = TimeZoneInfo.FindSystemTimeZoneById(destinationTimeZoneId);\n            return TimeZoneInfo.ConvertTimeFromUtc(utcDateTime, tzi);\n        }\n    }\n}\n</code></pre>\n\n<p>For what you asked, you really only need the <code>UnixTimeToDateTime</code> and <code>UtcToLocal</code> methods from the above code, but I thought I'd throw a few more in for others that may be in similar situations.  Really, anything you can do in .NET you can do here.  The .NET <code>DateTime</code>, <code>DateTimeOffset</code> and <code>TimeZoneInfo</code> APIs are much easier and more reliable than the Win32 APIs you would need to do similar work.</p>\n\n<p>Check the <code>Register for COM interop</code> option before you build (as mentioned in the answer linked earlier), or otherwise register your DLL with COM via the <code>RegAsm.exe</code> utility if you are deploying to another machine.</p>\n\n<p>Next, add a reference from your VBA project to your newly registered <code>MyDateTimeLibrary</code>.  Then use it, like so (for example):</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Sub Test()\n\n    Dim dtf As New MyDateTimeLibrary.DateTimeFunctions\n    Dim utcDt As Date, localDt As Date\n\n    utcDt = dtf.UnixTimeToDateTime(1487010504)\n    localDt = dtf.UtcToLocal(utcDt)\n\n    MsgBox (\"UTC: \" + CStr(utcDt) + vbCrLf + \"Local: \" + CStr(localDt))\n\n    Set dtf = Nothing\n\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/mutD7.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/mutD7.png\" alt=\"screenshot\"></a></p>\n\n<p>I'm sure you can refactor this to write some useful VBA functions that pass in and out the dates to convert, call those from Excel cells, or whatever your context is.  I'll leave that part up to you.</p>\n"}], "owner": {"reputation": 33, "user_id": 7358255, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52c615cfa143b09052912fa1c2383710?s=128&d=identicon&r=PG&f=1", "display_name": "Fang Dong", "link": "https://stackoverflow.com/users/7358255/fang-dong"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3197, "favorite_count": 2, "accepted_answer_id": 42212948, "answer_count": 1, "score": 2, "last_activity_date": 1535035904, "creation_date": 1486576590, "question_id": 42120325, "link": "https://stackoverflow.com/questions/42120325/in-vba-how-to-convert-a-utc-unix-timestamp-to-local-timezone-date-in-a-simple-w", "title": "In VBA, How to convert a UTC UNIX timestamp to Local timezone Date in a simple way?", "body": "<p>As I know, we can use below to roughly convert a UNIX timestamp to a VB Date</p>\n\n<p><em>CDate([UNIX timestamp]/ 60 / 60 / 24) + \"1/1/1970\"</em></p>\n\n<p>However, the time zone and daylight information are not considered.</p>\n\n<p>Time zone is not a big deal. But I cannot get the daylight bias information for a specific UNIX timestamp. </p>\n\n<p>Though, daylight bias of Date 1/1 is obviously different from Date 6/1, however, for Date 3/12 or Date 11/5, the daylight bias calculation is very complex.</p>\n\n<p>I tried several APIs, like \u201cFileTimeToLocalFileTime\u201d and \u201cGetTimeZoneInformation\u201d , but none of them work.</p>\n\n<p>Here is my code that can not handle daylight bias </p>\n\n<pre><code>Option Explicit\n\n#If VBA7 Then\n  Private Declare PtrSafe Function LocalFileTimeToFileTime Lib \"kernel32\" (src@, tgt@) As Long\n  Private Declare PtrSafe Function FileTimeToLocalFileTime Lib \"kernel32\" (src@, tgt@) As Long\n#Else\n  Private Declare Function LocalFileTimeToFileTime Lib \"kernel32\" (src@, tgt@) As Long\n  Private Declare Function FileTimeToLocalFileTime Lib \"kernel32\" (src@, tgt@) As Long\n#End If\n\nPublic Function ToUTC(ByVal datetime As Date) As Date\n  Dim ftLoc@, ftUtc@\n  ftLoc = (datetime - #1/1/1601#) * 86400000\n  LocalFileTimeToFileTime ftLoc, ftUtc\n  ToUTC = ftUtc / 86400000# + #1/1/1601#\nEnd Function\n\nPublic Function FromUTC(ByVal datetime As Date) As Date\n  Dim ftUtc@, ftLoc@\n  ftUtc = (datetime - #1/1/1601#) * 86400000\n  FileTimeToLocalFileTime ftUtc, ftLoc\n  FromUTC = ftLoc / 86400000# + #1/1/1601#\nEnd Function\n\nFunction getDateFromTimestamp(ByVal value) As Date\n    Dim t1, t2\n    t1 = CDate(value / 60 / 60 / 24) + \"1/1/1970\"\n    t2 = FromUTC(t1)\n    Debug.Print t2 - t1\n    getDateFromTimestamp = t2\nEnd Function\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1486576792, "post_id": 42120316, "comment_id": 71408910, "body": "Just insert <code>ElseIf Range(&quot;R&quot; &amp; rowCounter).Value = 0 Then</code> as an additional condition."}], "answers": [{"tags": [], "owner": {"reputation": 2478, "user_id": 6110371, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/O93Qp.jpg?s=128&g=1", "display_name": "VBA Pete", "link": "https://stackoverflow.com/users/6110371/vba-pete"}, "is_accepted": false, "score": 3, "last_activity_date": 1486577331, "last_edit_date": 1486577331, "creation_date": 1486576806, "answer_id": 42120383, "question_id": 42120316, "link": "https://stackoverflow.com/questions/42120316/excel-vba-protecting-calculation-from-dividing-by-0/42120383#42120383", "title": "Excel VBA protecting calculation from dividing by 0", "body": "<p>How about an extra <strong>ElseIF statement</strong> that check for the value in column R:</p>\n\n<pre><code>Set myRange = Range(\"S3:S20\")\nrowCounter = 3\nFor Each myCell In myRange\n        If Range(\"H1\").Value Like \"*Mon*\" Then\n            myCell.Value = Range(\"Q\" &amp; rowCounter).Value\n            rowCounter = rowCounter + 1\n        ElseIf Range(\"R\" &amp; rowCounter).Value &lt;&gt; \"0\" Then\n            myCell.Value = ((myCell.Value + Range(\"Q\" &amp; rowCounter).Value) / Range(\"R\" &amp; rowCounter).Value)\n            rowCounter = rowCounter + 1\n        Else\n            myCell.Value = 0\n            rowCounter = rowCounter + 1\n        End If\nNext myCell\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2478, "user_id": 6110371, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/O93Qp.jpg?s=128&g=1", "display_name": "VBA Pete", "link": "https://stackoverflow.com/users/6110371/vba-pete"}, "edited": false, "score": 1, "creation_date": 1486577530, "post_id": 42120432, "comment_id": 71409347, "body": "Nice solution. You can also get of <code>Dim rowCounter as Long</code>."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 4, "creation_date": 1486582935, "post_id": 42120432, "comment_id": 71412405, "body": "That comment... is a great example of why good comments should say <i>why</i>, not <i>what</i> - the code says one thing, the comment says another. I&#39;d drop the comment, <code>If foo = 0 Then</code> is pretty self-explanatory."}], "tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": true, "score": 3, "last_activity_date": 1486583088, "last_edit_date": 1486583088, "creation_date": 1486576985, "answer_id": 42120432, "question_id": 42120316, "link": "https://stackoverflow.com/questions/42120316/excel-vba-protecting-calculation-from-dividing-by-0/42120432#42120432", "title": "Excel VBA protecting calculation from dividing by 0", "body": "<p>Try the code below (check if the value in Column R = 0).</p>\n\n<p>Since you are looping with <code>For Each myCell In myRange</code>, there is no need to have another variable (<code>rowCounter</code>)  to keep the row number, just use <code>myCell.Row</code>.</p>\n\n<pre><code>Option Explicit\n\nSub HandleDev_ByZero()\n\nDim myRange As Range, myCell As Range\n\nSet myRange = Range(\"S3:S20\")\nFor Each myCell In myRange\n    If Range(\"H1\").Value Like \"*Mon*\" Then\n        myCell.Value = Range(\"Q\" &amp; myCell.Row).Value\n    Else\n        If Range(\"R\" &amp; myCell.Row).Value = 0 Then ' check if 0\n            myCell.Value = 0\n        Else\n            myCell.Value = ((myCell.Value + Range(\"Q\" &amp; myCell.Row).Value) / Range(\"R\" &amp; myCell.Row).Value)\n        End If\n    End If\nNext myCell\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": false, "score": 5, "last_activity_date": 1486584839, "last_edit_date": 1486584839, "creation_date": 1486579712, "answer_id": 42121256, "question_id": 42120316, "link": "https://stackoverflow.com/questions/42120316/excel-vba-protecting-calculation-from-dividing-by-0/42121256#42121256", "title": "Excel VBA protecting calculation from dividing by 0", "body": "<p>I answer your question along with some other considerations:</p>\n\n<ul>\n<li><p>you can exploit <code>IfError()</code> <code>WorksheetFunction</code> to trap the error</p></li>\n<li><p>it's a logical error to repeat <code>If Range(\"H1\").Value Like \"*Mon*\" Then</code> at every iteration</p>\n\n<p>check it once at the beginning and then proceed accordingly</p></li>\n<li><p>you can avoid <code>counter</code> variable by offsetting the loop range variable</p></li>\n</ul>\n\n<p>for all what above you could code</p>\n\n<pre><code>Sub main()\n    Dim myRange As Range, myCell As Range\n\n    Set myRange = Range(\"S3:S20\")\n    If Range(\"H1\").Value Like \"*Mon*\" Then\n        myRange.Value = myRange.Offset(, -2).Value\n    Else\n        For Each myCell In myRange\n            myCell.FormulaR1C1 = \"=iferror((\" &amp; myCell.Value &amp; \"+ RC[-2])/RC[-1],0)\"\n        Next myCell\n        myRange.Value = myRange.Value\n    End If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 127, "user_id": 6372785, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/bc8c3987229edf961d0be546ee253557?s=128&d=identicon&r=PG&f=1", "display_name": "Josh", "link": "https://stackoverflow.com/users/6372785/josh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 264, "favorite_count": 0, "accepted_answer_id": 42120432, "answer_count": 3, "score": 1, "last_activity_date": 1486584839, "creation_date": 1486576573, "question_id": 42120316, "link": "https://stackoverflow.com/questions/42120316/excel-vba-protecting-calculation-from-dividing-by-0", "title": "Excel VBA protecting calculation from dividing by 0", "body": "<p>I am trying to populate cells with data based on a simple division but there are (and will always be) instances where I have a 0 on one or both ends of the equation. </p>\n\n<p>Is it possible to wrap some kind of protection around the equation so that if it's a division by 0 it just sets the value to 0 rather then error out?</p>\n\n<p>My code</p>\n\n<pre><code>Set myRange = Range(\"S3:S20\")\nrowCounter = 3\nFor Each myCell In myRange\n    If Range(\"H1\").Value Like \"*Mon*\" Then\n        myCell.Value = Range(\"Q\" &amp; rowCounter).Value\n        rowCounter = rowCounter + 1\n\n    Else\n        myCell.Value = ((myCell.Value + Range(\"Q\" &amp; rowCounter).Value) / Range(\"R\" &amp; rowCounter).Value)\n        rowCounter = rowCounter + 1\n\n    End If\nNext myCell\n</code></pre>\n\n<p>Below is the data referenced in the equation</p>\n\n<pre><code>P    Q      R    S\n5   1:03    5   1:03\n0   0:00    0   0:00\n0   0:00    0   0:00\n7   0:19    7   0:19\n0   0:00    0   0:00\n0   0:00    0   0:00\n12  0:26    12  0:26\n3   0:15    3   0:15\n3   1:16    3   1:16\n7   0:29    7   0:29\n9   0:14    9   0:14\n0   0:00    0   0:00\n0   0:00    0   0:00\n6   0:28    6   0:28\n0   0:00    0   0:00\n4   0:15    4   0:15\n0   0:00    0   0:00\n0   0:00    0   0:00\n</code></pre>\n\n<p>Thanks for looking!</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1595, "user_id": 4837035, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdfc11c275ff58678c9c6b7fa93d4119?s=128&d=identicon&r=PG&f=1", "display_name": "Zerk", "link": "https://stackoverflow.com/users/4837035/zerk"}, "edited": false, "score": 0, "creation_date": 1486576770, "post_id": 42120012, "comment_id": 71408893, "body": "Seems an odd error, just as an initial check can you preface the Sheets line with ThisWorkbook and change sheets to worksheets ? so ThisWorkbook.Worksheets(&quot;CALCULATIONS&quot;). Also can you verify that the workbook will always contain a sheet called &quot;SHEET1&quot;?"}, {"owner": {"reputation": 43, "user_id": 7535966, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f77dcc32066cb0d872224c9c4be896cd?s=128&d=identicon&r=PG&f=1", "display_name": "allidoisthrow", "link": "https://stackoverflow.com/users/7535966/allidoisthrow"}, "reply_to_user": {"reputation": 1595, "user_id": 4837035, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdfc11c275ff58678c9c6b7fa93d4119?s=128&d=identicon&r=PG&f=1", "display_name": "Zerk", "link": "https://stackoverflow.com/users/4837035/zerk"}, "edited": false, "score": 0, "creation_date": 1486580288, "post_id": 42120012, "comment_id": 71410915, "body": "I tried that initially, to no avail.  I probably should have said as much in my initial question.  Thanks for looking!"}], "answers": [{"comments": [{"owner": {"reputation": 43, "user_id": 7535966, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f77dcc32066cb0d872224c9c4be896cd?s=128&d=identicon&r=PG&f=1", "display_name": "allidoisthrow", "link": "https://stackoverflow.com/users/7535966/allidoisthrow"}, "edited": false, "score": 0, "creation_date": 1486580241, "post_id": 42120651, "comment_id": 71410890, "body": "I have added the code as suggested, and so far this seems to be holding.  Thanks for the rapid response!"}], "tags": [], "owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "is_accepted": true, "score": 3, "last_activity_date": 1486577685, "creation_date": 1486577685, "answer_id": 42120651, "question_id": 42120012, "link": "https://stackoverflow.com/questions/42120012/method-range-of-object-worksheet-failed-error-2147417848-80010108/42120651#42120651", "title": "Method &#39;Range&#39; of object_Worksheet failed error -2147417848 (80010108)", "body": "<p>While Excel is Busy calculating the cells, you are trying to delete/change the cell, invoking another calculation event. Hence blocking the cell/range access. Same will happen you had a mix of chart sheets with normal sheets.</p>\n\n<p>Just disable the events before making any change/delete and once done re-enable events.</p>\n\n<pre><code>...............\nDim i As Integer\nApplication.EnableEvents = False\nSheets(\"CALCULATIONS\").Range(\"N24\").ClearContents\n.........Your Code....\n.....................\nApplication.ScreenUpdating = True\nEnd If\n\nApplication.EnableEvents = True\n</code></pre>\n\n<p>Another alternative is to wait till CalculationState is <code>xlDone</code> but if you too many lengthy calculation, this might crash your application.</p>\n"}, {"comments": [{"owner": {"reputation": 43, "user_id": 7535966, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f77dcc32066cb0d872224c9c4be896cd?s=128&d=identicon&r=PG&f=1", "display_name": "allidoisthrow", "link": "https://stackoverflow.com/users/7535966/allidoisthrow"}, "edited": false, "score": 0, "creation_date": 1486580179, "post_id": 42121022, "comment_id": 71410848, "body": "I tried this change as suggested, and it threw the same error.  The =N24 was just a (poor) example.  It happens when I try and enter anything that would trigger a calculation.  So far cyboashu&#39;s suggestion seems to be holding.  Thanks for the rapid response!"}], "tags": [], "owner": {"reputation": 164, "user_id": 2988309, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/480c1eeee8de1c80709c57d180eb89dd?s=128&d=identicon&r=PG&f=1", "display_name": "IR_IR", "link": "https://stackoverflow.com/users/2988309/ir-ir"}, "is_accepted": false, "score": 0, "last_activity_date": 1615771412, "last_edit_date": 1615771412, "creation_date": 1486578907, "answer_id": 42121022, "question_id": 42120012, "link": "https://stackoverflow.com/questions/42120012/method-range-of-object-worksheet-failed-error-2147417848-80010108/42121022#42121022", "title": "Method &#39;Range&#39; of object_Worksheet failed error -2147417848 (80010108)", "body": "<p>Of course you can not put reference on Range(&quot;N24&quot;) because you will get an infinite loop.</p>\n<p>The first line of your code is proof for that:</p>\n<pre><code>Sheets(&quot;CALCULATIONS&quot;).Range(&quot;N24&quot;).ClearContents\n</code></pre>\n<p>Why, because you put reference of Range(&quot;N24&quot;) and click ENTER you get fired Change event, than your line for ClearContents erase content and after that you got calculation in your cell with this reference and here we go again fired Change Event because of that. And so on and so on (an infinite loop).</p>\n<p>At your place I tried to do the following.</p>\n<p>For example edit this line of code:</p>\n<pre><code>Sheets(&quot;CALCULATIONS&quot;).Range(&quot;N24&quot;).ClearContents\n</code></pre>\n<p>with this</p>\n<pre><code>If Sheets(&quot;CALCULATIONS&quot;).Range(&quot;N24&quot;) &lt;&gt; &quot;&quot; Then\n    Sheets(&quot;CALCULATIONS&quot;).Range(&quot;N24&quot;).ClearContents\nEnd If\n</code></pre>\n<p>End every part of code with ClearContents edit like above example.</p>\n<p>This would ensure the non-appearance of infinite loop.</p>\n"}], "owner": {"reputation": 43, "user_id": 7535966, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f77dcc32066cb0d872224c9c4be896cd?s=128&d=identicon&r=PG&f=1", "display_name": "allidoisthrow", "link": "https://stackoverflow.com/users/7535966/allidoisthrow"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2496, "favorite_count": 1, "accepted_answer_id": 42120651, "answer_count": 2, "score": 4, "last_activity_date": 1615771412, "creation_date": 1486575583, "last_edit_date": 1615486025, "question_id": 42120012, "link": "https://stackoverflow.com/questions/42120012/method-range-of-object-worksheet-failed-error-2147417848-80010108", "title": "Method &#39;Range&#39; of object_Worksheet failed error -2147417848 (80010108)", "body": "<p>I've googled extensively, but can't seem to find anything on my problem. I have a workbook that has various VBA intermingled with in cell formulas. As it sits now it works fine, but if I try and add or modify a simple cell reference such as &quot;=N24&quot; it breaks my code and throws up the error:</p>\n<blockquote>\n<p>Run-time error '-2147417848 (80010108)': Method 'Range' of object'_Worksheet' failed</p>\n</blockquote>\n<p>This happens whether I'm referencing a calculated cell, a user filled cell, or a blank cell.</p>\n<p>Here's the sheet calculate code, which is the only code on this particular sheet. I know it's rudimentary, but usually simple is good. When it throws this error, it breaks at:</p>\n<pre><code>Sheets(&quot;CALCULATIONS&quot;).Range(&quot;N24&quot;).ClearContents\n</code></pre>\n<p>If I remove that code, then it breaks at the first IF statement line.</p>\n<pre><code>Private Sub Worksheet_Calculate()\nDim SIZE As String\nDim THICKNESS As Single\nDim WIDTH As Single\nDim HEIGHT As Single\nDim WALL As Single\nDim WALL1 As String\nDim OD As Single\nDim FINALROW As Integer\nDim i As Integer\nSheets(&quot;CALCULATIONS&quot;).Range(&quot;N24&quot;).ClearContents\nIf ThisWorkbook.Sheets(&quot;SHEET1&quot;).Range(&quot;E4&quot;) = &quot;STRUCTURAL_I_BEAM&quot; And ThisWorkbook.Sheets(&quot;SHEET1&quot;).Range(&quot;F4&quot;) &lt;&gt; 0 Then\n    \nApplication.ScreenUpdating = False\nSheets(&quot;IBEAM&quot;).Range(&quot;Q2:Q100&quot;).ClearContents\nSIZE = Sheets(&quot;SHEET1&quot;).Range(&quot;F4&quot;).Value\nFINALROW = Sheets(&quot;IBEAM&quot;).Cells(Rows.Count, 2).End(xlUp).Row\n\n    For i = 2 To FINALROW\n        If Worksheets(&quot;IBEAM&quot;).Cells(i, 2) = SIZE Then\n            Worksheets(&quot;IBEAM&quot;).Cells(i, 8).Copy\n            Sheets(&quot;IBEAM&quot;).Range(&quot;Q&quot; &amp; Rows.Count).End(xlUp).Offset(1, 0).PasteSpecial xlPasteValues\n        End If\n    Next i\n    Worksheets(&quot;CALCULATIONS&quot;).Range(&quot;N24&quot;).Value = Worksheets(&quot;IBEAM&quot;).Range(&quot;Q2&quot;).Value\nApplication.ScreenUpdating = True\nEnd If\n\n\nIf ThisWorkbook.Sheets(&quot;SHEET1&quot;).Range(&quot;E4&quot;) = &quot;STRUCTURAL_CHANNEL&quot; And ThisWorkbook.Sheets(&quot;SHEET1&quot;).Range(&quot;F4&quot;) &lt;&gt; 0 Then\n    \nApplication.ScreenUpdating = False\nSheets(&quot;CHANNEL&quot;).Range(&quot;Q2:Q100&quot;).ClearContents\nSIZE = Sheets(&quot;SHEET1&quot;).Range(&quot;F4&quot;).Value\nFINALROW = Sheets(&quot;CHANNEL&quot;).Cells(Rows.Count, 2).End(xlUp).Row\n\n    For i = 2 To FINALROW\n        If Worksheets(&quot;CHANNEL&quot;).Cells(i, 2) = SIZE Then\n            Worksheets(&quot;CHANNEL&quot;).Cells(i, 6).Copy\n            Sheets(&quot;CHANNEL&quot;).Range(&quot;Q&quot; &amp; Rows.Count).End(xlUp).Offset(1, 0).PasteSpecial xlPasteValues\n        End If\n    Next i\n    Worksheets(&quot;CALCULATIONS&quot;).Range(&quot;N24&quot;).Value = Worksheets(&quot;CHANNEL&quot;).Range(&quot;Q2&quot;).Value\nApplication.ScreenUpdating = True\nEnd If\n\n\nIf ThisWorkbook.Sheets(&quot;SHEET1&quot;).Range(&quot;E4&quot;) = &quot;STRUCTURAL_ANGLE&quot; And ThisWorkbook.Sheets(&quot;SHEET1&quot;).Range(&quot;F4&quot;) &lt;&gt; 0 Then\n\n\nApplication.ScreenUpdating = False\nSheets(&quot;ANGLE&quot;).Range(&quot;Q2:Q100&quot;).ClearContents\nWIDTH = Sheets(&quot;SHEET1&quot;).Range(&quot;F4&quot;).Value\nHEIGHT = Sheets(&quot;SHEET1&quot;).Range(&quot;G4&quot;).Value\nTHICKNESS = Sheets(&quot;SHEET1&quot;).Range(&quot;H4&quot;).Value\nFINALROW = Sheets(&quot;ANGLE&quot;).Cells(Rows.Count, 3).End(xlUp).Row\n\n    For i = 2 To FINALROW\n        If Worksheets(&quot;ANGLE&quot;).Cells(i, 3) = WIDTH And Worksheets(&quot;ANGLE&quot;).Cells(i, 4) = HEIGHT And Worksheets(&quot;ANGLE&quot;).Cells(i, 6) = THICKNESS Then\n            Worksheets(&quot;ANGLE&quot;).Cells(i, 7).Copy\n            Sheets(&quot;ANGLE&quot;).Range(&quot;Q&quot; &amp; Rows.Count).End(xlUp).Offset(1, 0).PasteSpecial xlPasteValues\n        End If\n    Next i\n    Worksheets(&quot;CALCULATIONS&quot;).Range(&quot;N24&quot;).Value = Worksheets(&quot;ANGLE&quot;).Range(&quot;Q2&quot;).Value\nApplication.ScreenUpdating = True\nEnd If\n\n\nIf ThisWorkbook.Sheets(&quot;SHEET1&quot;).Range(&quot;E4&quot;) = &quot;TUBE_RECTANGLE&quot; And ThisWorkbook.Sheets(&quot;SHEET1&quot;).Range(&quot;F4&quot;) &lt;&gt; 0 Then\n\n\nApplication.ScreenUpdating = False\nSheets(&quot;RECTTUBE&quot;).Range(&quot;Q2:Q100&quot;).ClearContents\nWIDTH = Sheets(&quot;SHEET1&quot;).Range(&quot;F4&quot;).Value\nHEIGHT = Sheets(&quot;SHEET1&quot;).Range(&quot;G4&quot;).Value\nWALL = Sheets(&quot;SHEET1&quot;).Range(&quot;H4&quot;).Value\nFINALROW = Sheets(&quot;RECTTUBE&quot;).Cells(Rows.Count, 3).End(xlUp).Row\n\n    For i = 2 To FINALROW\n        If Worksheets(&quot;RECTTUBE&quot;).Cells(i, 3) = WIDTH And Worksheets(&quot;RECTTUBE&quot;).Cells(i, 4) = HEIGHT And Worksheets(&quot;RECTTUBE&quot;).Cells(i, 5) = WALL Then\n            Worksheets(&quot;RECTTUBE&quot;).Cells(i, 6).Copy\n            Sheets(&quot;RECTTUBE&quot;).Range(&quot;Q&quot; &amp; Rows.Count).End(xlUp).Offset(1, 0).PasteSpecial xlPasteValues\n        End If\n    Next i\n    Worksheets(&quot;CALCULATIONS&quot;).Range(&quot;N24&quot;).Value = Worksheets(&quot;RECTTUBE&quot;).Range(&quot;Q2&quot;).Value\nApplication.ScreenUpdating = True\nEnd If\n\n\nIf ThisWorkbook.Sheets(&quot;SHEET1&quot;).Range(&quot;E4&quot;) = &quot;TUBE_SQUARE&quot; And ThisWorkbook.Sheets(&quot;SHEET1&quot;).Range(&quot;F4&quot;) &lt;&gt; 0 Then\n\n\nApplication.ScreenUpdating = False\nSheets(&quot;SQUARETUBE&quot;).Range(&quot;Q2:Q100&quot;).ClearContents\nWIDTH = Sheets(&quot;SHEET1&quot;).Range(&quot;F4&quot;).Value\nWALL = Sheets(&quot;SHEET1&quot;).Range(&quot;H4&quot;).Value\nFINALROW = Sheets(&quot;SQUARETUBE&quot;).Cells(Rows.Count, 3).End(xlUp).Row\n\n    For i = 2 To FINALROW\n        If Worksheets(&quot;SQUARETUBE&quot;).Cells(i, 3) = WIDTH And Worksheets(&quot;SQUARETUBE&quot;).Cells(i, 5) = WALL Then\n            Worksheets(&quot;SQUARETUBE&quot;).Cells(i, 6).Copy\n            Sheets(&quot;SQUARETUBE&quot;).Range(&quot;Q&quot; &amp; Rows.Count).End(xlUp).Offset(1, 0).PasteSpecial xlPasteValues\n        End If\n    Next i\n    Worksheets(&quot;CALCULATIONS&quot;).Range(&quot;N24&quot;).Value = Worksheets(&quot;SQUARETUBE&quot;).Range(&quot;Q2&quot;).Value\nApplication.ScreenUpdating = True\nEnd If\n\n\nIf ThisWorkbook.Sheets(&quot;SHEET1&quot;).Range(&quot;E4&quot;) = &quot;TUBE_ROUND&quot; And ThisWorkbook.Sheets(&quot;SHEET1&quot;).Range(&quot;F4&quot;) &lt;&gt; 0 Then\n\n\nApplication.ScreenUpdating = False\nSheets(&quot;ROUNDTUBE&quot;).Range(&quot;Q2:Q100&quot;).ClearContents\nOD = Sheets(&quot;SHEET1&quot;).Range(&quot;F4&quot;).Value\nWALL1 = Sheets(&quot;SHEET1&quot;).Range(&quot;H4&quot;).Value\nFINALROW = Sheets(&quot;ROUNDTUBE&quot;).Cells(Rows.Count, 3).End(xlUp).Row\n\n    For i = 2 To FINALROW\n        If Worksheets(&quot;ROUNDTUBE&quot;).Cells(i, 3) = OD And Worksheets(&quot;ROUNDTUBE&quot;).Cells(i, 4) = WALL1 Then\n            Worksheets(&quot;ROUNDTUBE&quot;).Cells(i, 5).Copy\n            Sheets(&quot;ROUNDTUBE&quot;).Range(&quot;Q&quot; &amp; Rows.Count).End(xlUp).Offset(1, 0).PasteSpecial xlPasteValues\n        End If\n    Next i\n    Worksheets(&quot;CALCULATIONS&quot;).Range(&quot;N24&quot;).Value = Worksheets(&quot;ROUNDTUBE&quot;).Range(&quot;Q2&quot;).Value\nApplication.ScreenUpdating = True\nEnd If\n\n\nIf ThisWorkbook.Sheets(&quot;SHEET1&quot;).Range(&quot;E4&quot;) = &quot;PIPE&quot; And ThisWorkbook.Sheets(&quot;SHEET1&quot;).Range(&quot;F4&quot;) &lt;&gt; 0 Then\n\n\nApplication.ScreenUpdating = False\nSheets(&quot;PIPE&quot;).Range(&quot;Q2:Q100&quot;).ClearContents\nOD = Sheets(&quot;SHEET1&quot;).Range(&quot;F4&quot;).Value\nWALL1 = Sheets(&quot;SHEET1&quot;).Range(&quot;H4&quot;).Value\nFINALROW = Sheets(&quot;PIPE&quot;).Cells(Rows.Count, 3).End(xlUp).Row\n\n    For i = 2 To FINALROW\n        If Worksheets(&quot;PIPE&quot;).Cells(i, 3) = OD And Worksheets(&quot;PIPE&quot;).Cells(i, 4) = WALL1 Then\n            Worksheets(&quot;PIPE&quot;).Cells(i, 5).Copy\n            Sheets(&quot;PIPE&quot;).Range(&quot;Q&quot; &amp; Rows.Count).End(xlUp).Offset(1, 0).PasteSpecial xlPasteValues\n        End If\n    Next i\n    Worksheets(&quot;CALCULATIONS&quot;).Range(&quot;N24&quot;).Value = Worksheets(&quot;PIPE&quot;).Range(&quot;Q2&quot;).Value\nApplication.ScreenUpdating = True\nEnd If\n\n\nIf ThisWorkbook.Sheets(&quot;SHEET1&quot;).Range(&quot;E4&quot;) = &quot;SOLID_ROUND&quot; And ThisWorkbook.Sheets(&quot;SHEET1&quot;).Range(&quot;F4&quot;) &lt;&gt; 0 Then\n\n\nApplication.ScreenUpdating = False\nSheets(&quot;ROUND&quot;).Range(&quot;Q2:Q100&quot;).ClearContents\nOD = Sheets(&quot;SHEET1&quot;).Range(&quot;F4&quot;).Value\nFINALROW = Sheets(&quot;ROUND&quot;).Cells(Rows.Count, 3).End(xlUp).Row\n\n    For i = 2 To FINALROW\n        If Worksheets(&quot;ROUND&quot;).Cells(i, 3) = OD Then\n            Worksheets(&quot;ROUND&quot;).Cells(i, 4).Copy\n            Sheets(&quot;ROUND&quot;).Range(&quot;Q&quot; &amp; Rows.Count).End(xlUp).Offset(1, 0).PasteSpecial xlPasteValues\n        End If\n    Next i\n    Worksheets(&quot;CALCULATIONS&quot;).Range(&quot;N24&quot;).Value = Worksheets(&quot;ROUND&quot;).Range(&quot;Q2&quot;).Value\nApplication.ScreenUpdating = True\nEnd If\n\n\nIf ThisWorkbook.Sheets(&quot;SHEET1&quot;).Range(&quot;E4&quot;) = &quot;SOLID_FLAT&quot; And ThisWorkbook.Sheets(&quot;SHEET1&quot;).Range(&quot;F4&quot;) &lt;&gt; 0 Then\n\n\nApplication.ScreenUpdating = False\nSheets(&quot;FLAT&quot;).Range(&quot;Q2:Q100&quot;).ClearContents\nTHICKNESS = Sheets(&quot;SHEET1&quot;).Range(&quot;F4&quot;).Value\nWIDTH = Sheets(&quot;SHEET1&quot;).Range(&quot;G4&quot;).Value\nFINALROW = Sheets(&quot;FLAT&quot;).Cells(Rows.Count, 3).End(xlUp).Row\n\n    For i = 2 To FINALROW\n        If Worksheets(&quot;FLAT&quot;).Cells(i, 3) = THICKNESS And Worksheets(&quot;FLAT&quot;).Cells(i, 4) = WIDTH Then\n            Worksheets(&quot;FLAT&quot;).Cells(i, 5).Copy\n            Sheets(&quot;FLAT&quot;).Range(&quot;Q&quot; &amp; Rows.Count).End(xlUp).Offset(1, 0).PasteSpecial xlPasteValues\n        End If\n    Next i\n    Worksheets(&quot;CALCULATIONS&quot;).Range(&quot;N24&quot;).Value = Worksheets(&quot;FLAT&quot;).Range(&quot;Q2&quot;).Value\nApplication.ScreenUpdating = True\nEnd If\n\n\nIf ThisWorkbook.Sheets(&quot;SHEET1&quot;).Range(&quot;E4&quot;) = &quot;SOLID_SQUARE&quot; And ThisWorkbook.Sheets(&quot;SHEET1&quot;).Range(&quot;F4&quot;) &lt;&gt; 0 Then\n\n\nApplication.ScreenUpdating = False\nSheets(&quot;SQUARE&quot;).Range(&quot;Q2:Q100&quot;).ClearContents\nWIDTH = Sheets(&quot;SHEET1&quot;).Range(&quot;F4&quot;).Value\nFINALROW = Sheets(&quot;SQUARE&quot;).Cells(Rows.Count, 3).End(xlUp).Row\n\n    For i = 2 To FINALROW\n        If Worksheets(&quot;SQUARE&quot;).Cells(i, 3) = WIDTH Then\n            Worksheets(&quot;SQUARE&quot;).Cells(i, 4).Copy\n            Sheets(&quot;SQUARE&quot;).Range(&quot;Q&quot; &amp; Rows.Count).End(xlUp).Offset(1, 0).PasteSpecial xlPasteValues\n        End If\n    Next i\n    Worksheets(&quot;CALCULATIONS&quot;).Range(&quot;N24&quot;).Value = Worksheets(&quot;SQUARE&quot;).Range(&quot;Q2&quot;).Value\nApplication.ScreenUpdating = True\nEnd If\n\n\nIf ThisWorkbook.Sheets(&quot;SHEET1&quot;).Range(&quot;E4&quot;) = &quot;SOLID_HEX&quot; And ThisWorkbook.Sheets(&quot;SHEET1&quot;).Range(&quot;F4&quot;) &lt;&gt; 0 Then\n\n\nApplication.ScreenUpdating = False\nSheets(&quot;HEX&quot;).Range(&quot;Q2:Q100&quot;).ClearContents\nWIDTH = Sheets(&quot;SHEET1&quot;).Range(&quot;F4&quot;).Value\nFINALROW = Sheets(&quot;HEX&quot;).Cells(Rows.Count, 3).End(xlUp).Row\n\n    For i = 2 To FINALROW\n        If Worksheets(&quot;HEX&quot;).Cells(i, 3) = WIDTH Then\n            Worksheets(&quot;HEX&quot;).Cells(i, 4).Copy\n            Sheets(&quot;HEX&quot;).Range(&quot;Q&quot; &amp; Rows.Count).End(xlUp).Offset(1, 0).PasteSpecial xlPasteValues\n        End If\n    Next i\n    Worksheets(&quot;CALCULATIONS&quot;).Range(&quot;N24&quot;).Value = Worksheets(&quot;HEX&quot;).Range(&quot;Q2&quot;).Value\n    Worksheets(&quot;CALCULATIONS&quot;).Range(&quot;N25&quot;).Value = Worksheets(&quot;CALCULATIONS&quot;).Range(&quot;N8&quot;).Value / 12 * Worksheets(&quot;CALCULATIONS&quot;).Range(&quot;N24&quot;).Value\n    Worksheets(&quot;CALCULATIONS&quot;).Range(&quot;N26&quot;).Value = Worksheets(&quot;CALCULATIONS&quot;).Range(&quot;N25&quot;).Value - ((Worksheets(&quot;CALCULATIONS&quot;).Range(&quot;N6&quot;).Value * Worksheets(&quot;CALCULATIONS&quot;).Range(&quot;N10&quot;).Value / 12) * Worksheets(&quot;CALCULATIONS&quot;).Range(&quot;N24&quot;).Value)\nApplication.ScreenUpdating = True\nEnd If\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1486576021, "post_id": 42119993, "comment_id": 71408426, "body": "I honestly can&#39;t follow your wording, maybe you add some examples"}, {"owner": {"reputation": 53, "user_id": 7535917, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a0e3535e1fdd0a7378f909d10857746b?s=128&d=identicon&r=PG&f=1", "display_name": "Noisewater", "link": "https://stackoverflow.com/users/7535917/noisewater"}, "reply_to_user": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1486594130, "post_id": 42119993, "comment_id": 71418259, "body": "Yeah I can understand why..  So lets say wb.(&quot;One&quot;).Worksheets(&quot;Puppies&quot;).range(&quot;H&quot;) has puppy names. wb.(&quot;Two&quot;).Worksheets(&quot;Growth Chart&quot;).range(&quot;J&quot;) has puppy names. So if there is a match then take their weight (col C) and height (col E) from (&quot;Growth Chart&quot;) and insert it into wb1 col K for weight and col L for height. With multiple puppies having the same name I&#39;m trying to place the other matches in the next two columns but same row. Not sure how else to explain this."}], "answers": [{"comments": [{"owner": {"reputation": 53, "user_id": 7535917, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a0e3535e1fdd0a7378f909d10857746b?s=128&d=identicon&r=PG&f=1", "display_name": "Noisewater", "link": "https://stackoverflow.com/users/7535917/noisewater"}, "edited": false, "score": 0, "creation_date": 1486593156, "post_id": 42122364, "comment_id": 71417841, "body": "This is really close and can get me pointed in the right direction. This gives me an rt error 13 on &quot;If cel1.Value = cel2.Value Then&quot;   But you were correct on your assumptions."}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "reply_to_user": {"reputation": 53, "user_id": 7535917, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a0e3535e1fdd0a7378f909d10857746b?s=128&d=identicon&r=PG&f=1", "display_name": "Noisewater", "link": "https://stackoverflow.com/users/7535917/noisewater"}, "edited": false, "score": 0, "creation_date": 1486594485, "post_id": 42122364, "comment_id": 71418420, "body": "Got it. We need the trailing <code>.Cells</code> in the <code>For Each</code> statements. Pretty sure about it. Basically we were comparing columns not individual cells, --&gt; type mismatch."}, {"owner": {"reputation": 53, "user_id": 7535917, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a0e3535e1fdd0a7378f909d10857746b?s=128&d=identicon&r=PG&f=1", "display_name": "Noisewater", "link": "https://stackoverflow.com/users/7535917/noisewater"}, "edited": false, "score": 1, "creation_date": 1486595026, "post_id": 42122364, "comment_id": 71418673, "body": "That would do it. Thanks a lot!"}, {"owner": {"reputation": 53, "user_id": 7535917, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a0e3535e1fdd0a7378f909d10857746b?s=128&d=identicon&r=PG&f=1", "display_name": "Noisewater", "link": "https://stackoverflow.com/users/7535917/noisewater"}, "edited": false, "score": 0, "creation_date": 1488379717, "post_id": 42122364, "comment_id": 72205109, "body": "How would you avoid duplicate data? I&#39;m assuming comparing the offset but I&#39;m not sure how I would go about this."}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "reply_to_user": {"reputation": 53, "user_id": 7535917, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a0e3535e1fdd0a7378f909d10857746b?s=128&d=identicon&r=PG&f=1", "display_name": "Noisewater", "link": "https://stackoverflow.com/users/7535917/noisewater"}, "edited": false, "score": 0, "creation_date": 1488379897, "post_id": 42122364, "comment_id": 72205235, "body": "Hi @Noisewater. I think that this should the subject of an entirely new question, and it will surely get comprehensive answers. This of posting your updated code and ask about the specific duplicate issue."}], "tags": [], "owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "is_accepted": true, "score": 1, "last_activity_date": 1486594426, "last_edit_date": 1486594426, "creation_date": 1486583511, "answer_id": 42122364, "question_id": 42119993, "link": "https://stackoverflow.com/questions/42119993/excel-vba-import-multiple-matches-into-different-columns-same-row/42122364#42122364", "title": "Excel VBA import multiple matches into different columns same row", "body": "<p>You can do it by keeping track of an offset that you shift by two after each match copied. I'll track this in a variable called <code>offs</code>.\nAlso I suppose that the copying goes <em>from wb2 to wb1</em> as described in the text, not as \"suspected\" in the code.</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n    Dim cel1 As Range, cel2 As Range\n    For Each cel1 In ThisWorkbook.Sheets(\"Data\").UsedRange.Columns(\"H\").Cells\n        Dim offs As Long: offs = 3 ' &lt;-- Initial offset, will increase by 2 after each match\n        For Each cel2 In Workbooks(\"Workbook2\").Worksheets(\"Sheet1\").UsedRange.Columns(\"K\").Cells\n            If cel1.Value = cel2.Value Then\n                cel1.offset(, offs).Value = cel2.offset(, -8).Value ' &lt;- wb2(C) to wb1(K)\n                cel1.offset(, offs + 1).Value = cel2.offset(, -6).Value ' &lt;- wb2(E) to wb1(L)\n                offs = offs + 2 ' &lt;-- now shift the destination column by 2 for next match\n            End If\n        Next\n    Next\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 53, "user_id": 7535917, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a0e3535e1fdd0a7378f909d10857746b?s=128&d=identicon&r=PG&f=1", "display_name": "Noisewater", "link": "https://stackoverflow.com/users/7535917/noisewater"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 106, "favorite_count": 1, "accepted_answer_id": 42122364, "answer_count": 1, "score": 2, "last_activity_date": 1489958160, "creation_date": 1486575522, "last_edit_date": 1489958160, "question_id": 42119993, "link": "https://stackoverflow.com/questions/42119993/excel-vba-import-multiple-matches-into-different-columns-same-row", "title": "Excel VBA import multiple matches into different columns same row", "body": "<p>I'm trying to import cells from another wb. So if cell in wb1 col H matches cell in wb2 col K then wb1 col k and L = wb2 col C and E in match row. Now there may be several matches so I want it to offset to the next column. m and n for next set, o and p for next, and so on.</p>\n\n<p>This is what I have so far:</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n\nDim rcell As Range, sValue As String\nDim lcol As Long, cRow As Long\nDim dRange As Range, sCell As Range\nDim LastRow As Integer\nDim CurrentRow As Integer\n\n\nSet ws1 = ThisWorkbook\nSet ws2 = Workbooks(\"Workbook2\").Worksheets(\"Sheet1\")\nSheet1LastRow = ThisWorkbook.Sheets(\"Data\").Range(\"H2:H50000\").Value 'Search criteria column\nSheet2LastRow = Workbooks(\"Workbook2\").Worksheets(\"Sheet1\").Range(\"Q\" &amp; Rows.Count).End(xlUp).Row 'Where to look for matches\n\n With Workbooks(\"Workbook2\").Worksheets(\"Sheet1\")\n     For j = 1 To Sheet1LastRow\n         For i = 1 To Sheet2LastRow        \n             If ThisWorkbook.Sheets(\"Data\").Range(\"H\").Value =  ws2.Cells(i, 11).Value Then\n                 ws2.Cells(i, 11).Value = ThisWorkbook.Sheets(\"Data\").Range(\"C\").Value\n                 ws2.Cells(i, 12).Value = ThisWorkbook.Sheets(\"Data\").Range(\"E\").Value\n             End If\n             If InStr(1, ws2.Cells.Value, ws1.Cells.Value) And     Trim(ws1.Cells.Value) &lt;&gt; \"\" Then\n                 rcell.Offset(0, lcol).Value = ws2.Cells.Offset(0, 2).Value\n                 lcol = lcol + 1\n             End If\n         Next i\n     Next j\n End With\n\nEnd Sub\n</code></pre>\n\n<p>This doesn't work. I basically gave up since I don't know what I'm missing. </p>\n\n<p>I looked for something like this but only found something a <code>Vlookup</code> or <code>Match</code> could do.</p>\n"}, {"tags": ["vba", "excel", "userform"], "comments": [{"owner": {"reputation": 1018, "user_id": 6706734, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/89cf86a3fd50974771d8041b8f13e5b0?s=128&d=identicon&r=PG&f=1", "display_name": "J_Lard", "link": "https://stackoverflow.com/users/6706734/j-lard"}, "edited": false, "score": 0, "creation_date": 1486586500, "post_id": 42119623, "comment_id": 71414449, "body": "Without a bit more information it will be somewhat difficult to help you here. I can assume that the main issue is your <code>Select Case</code> statement since you&#39;re not doing anything when <code>OK</code> or <code>Cancel</code> is selected. If your datasets are on multiple sheets in the workbook you should just be able to enclose the <code>With</code> statement in a <code>For-Loop</code> to search across you datasets. Then you can say <code>Case vbCancel: Exit For</code>, otherwise continue."}], "answers": [{"comments": [{"owner": {"reputation": 92, "user_id": 7468886, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c1133b85ce992022ebb0e73a8880ba96?s=128&d=identicon&r=PG&f=1", "display_name": "vinayman", "link": "https://stackoverflow.com/users/7468886/vinayman"}, "edited": false, "score": 0, "creation_date": 1486629891, "post_id": 42124462, "comment_id": 71430544, "body": "For other users:  Just one edit; need to declare the strFind, i.e.,:  Dim strFind As string  Thanks, A.S.H!"}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "reply_to_user": {"reputation": 92, "user_id": 7468886, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c1133b85ce992022ebb0e73a8880ba96?s=128&d=identicon&r=PG&f=1", "display_name": "vinayman", "link": "https://stackoverflow.com/users/7468886/vinayman"}, "edited": false, "score": 0, "creation_date": 1486630103, "post_id": 42124462, "comment_id": 71430670, "body": "@vinayman actually I dropped that variable. We have it already in <code>Textbox1.value</code>. (Answer Edited) <code>strFind</code> was only used in the message box anyway, no serious impact on the overall code."}], "tags": [], "owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "is_accepted": true, "score": 0, "last_activity_date": 1486630062, "last_edit_date": 1486630062, "creation_date": 1486591200, "answer_id": 42124462, "question_id": 42119623, "link": "https://stackoverflow.com/questions/42119623/vba-userform-find-multiple-records-display-and-cycle-through/42124462#42124462", "title": "VBA UserForm Find multiple records, display and cycle through", "body": "<p>The code for <code>FindNext_Click</code> uses the fact that the last row showed was set to be the current selection (see <code>anchorCell.Select</code> in <code>updateFields</code>). The problem is that in between these calls the user may have selected another cell or even another worksheet, a runtime error would occur.</p>\n\n<p>I suggest another approach with only two functions, one that counts the matches and initiates the search, Another that is responsible of the updating and nexting\"</p>\n\n<pre><code>Option Explicit\nPrivate anchor As Range ' keeps track of the last shown row\n\nPrivate Sub Find_Click()\n    ' Only Displays the number of matches and delegates the updating to FidNext\n    Dim count As Long\n    count = WorksheetFunction.CountIf(Worksheets(\"Master\").UsedRange.Columns(\"A\"), TextBox1.Value)\n    If count &lt; 1 Then\n        msgBox TextBox1.Value &amp; \" not listed\"\n        FindNext.Enabled = False\n        Exit Sub\n    End If\n    FindNext.Enabled = True\n    Set anchor = Worksheets(\"Master\").Range(\"A65536\").End(xlUp)\n    FindNext_Click ' Now delegate the work to FindNext\nEnd Sub\n\nPrivate Sub FindNext_Click()\n'responsible of updating the userform and scrolling to the next field \n    Set anchor = Worksheets(\"Master\").UsedRange.Columns(\"A\").Find(TextBox1.Value, anchor)\n\n    TextBox2.Value = anchor.offset(0, 2).Value\n    TextBox3.Value = anchor.offset(0, 3).Value\n    TextBox4.Value = anchor.offset(0, 4).Value\n    TextBox6.Value = anchor.offset(0, 13).Value\n    TextBox7.Value = anchor.offset(0, 14).Value\n    TextBox8.Value = anchor.offset(0, 15).Value\n    TextBox9.Value = anchor.offset(0, 16).Value\n    TextBox10.Value = anchor.offset(0, 17).Value\n    TextBox11.Value = anchor.offset(0, 18).Value\n    TextBox12.Value = anchor.offset(0, 19).Value\n    TextBox13.Value = anchor.offset(0, 20).Value\n    TextBox14.Value = anchor.offset(0, 21).Value\n    TextBox20.Value = anchor.offset(0, 22).Value\n\n    Worksheets(\"Master\").Activate\n    anchor.EntireRow.Activate\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 92, "user_id": 7468886, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c1133b85ce992022ebb0e73a8880ba96?s=128&d=identicon&r=PG&f=1", "display_name": "vinayman", "link": "https://stackoverflow.com/users/7468886/vinayman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3018, "favorite_count": 0, "accepted_answer_id": 42124462, "answer_count": 1, "score": 1, "last_activity_date": 1486630062, "creation_date": 1486574333, "question_id": 42119623, "link": "https://stackoverflow.com/questions/42119623/vba-userform-find-multiple-records-display-and-cycle-through", "title": "VBA UserForm Find multiple records, display and cycle through", "body": "<p>I'm creating a userform where it searches for a unique ID on a sheet and displays the associated data located in the same row.</p>\n\n<p>I've used the aid of another StackOverflow question but it's not working exactly for me</p>\n\n<p>There are multiple datasets to the unique ID I'm searching for. The code I've got below, on clicking find, shows the first found record and pops up with a message box telling the user how many records are in the sheet. After clicking OK, the userform closes.</p>\n\n<p>I want to edit it so after clicking OK, the user can click the FindNext button and the userform will show all the other records which match the original search.</p>\n\n<p>Below is the code:</p>\n\n<pre><code>Private Sub FindNext_Click()\n    Dim nextCell As Range\n    Set nextCell = Cells.FindNext(After:=ActiveCell)\n    'FindNext loops round to the initial cell if it finds no other so we test for it\n    If Not nextCell.Address(external:=True) = ActiveCell.Address(external:=True) Then\n        updateFields anchorCell:=nextCell\n    End If\nEnd Sub\n\nPrivate Sub Find_Click()\n    Worksheets(\"Master\").Activate\n    Dim strFind As String\n    Dim FirstAddress As String\n    Dim rSearch As Range\n    Set rSearch = Range(\"a1\", Range(\"a65536\").End(xlUp))\n    Dim f      As Integer\n    Dim c As Object\n\n    strFind = Me.TextBox1.Value\n\n    With rSearch\n        Set c = .Find(strFind, LookIn:=xlValues)\n        If Not c Is Nothing Then\n            updateFields anchorCell:=c\n            FirstAddress = c.Address\n            Do\n                f = f + 1\n               Set c = .FindNext(c)\n            Loop While Not c Is Nothing And c.Address &lt;&gt; FirstAddress\n            If f &gt; 1 Then\n                Select Case MsgBox(\"There are \" &amp; f &amp; \" instances of \" &amp; strFind, vbOKCancel Or vbExclamation Or vbDefaultButton1, \"Multiple entries\")\n\n                    Case vbOK\n                    Case vbCancel\n\n                End Select\n                Me.Height = frmMax\n\n            End If\n        Else: MsgBox strFind &amp; \" not listed\"\n        End If\n    End With\n\nEnd Sub\n\n\nPrivate Sub updateFields(anchorCell As Range)\nanchorCell.Select\nWith Me\n    .TextBox2.Value = anchorCell.Offset(0, 2).Value\n    .TextBox3.Value = anchorCell.Offset(0, 3).Value\n    .TextBox4.Value = anchorCell.Offset(0, 4).Value\n    .TextBox6.Value = anchorCell.Offset(0, 13).Value\n    .TextBox7.Value = anchorCell.Offset(0, 14).Value\n    .TextBox8.Value = anchorCell.Offset(0, 15).Value\n    .TextBox9.Value = anchorCell.Offset(0, 16).Value\n    .TextBox10.Value = anchorCell.Offset(0, 17).Value\n    .TextBox11.Value = anchorCell.Offset(0, 18).Value\n    .TextBox12.Value = anchorCell.Offset(0, 19).Value\n    .TextBox13.Value = anchorCell.Offset(0, 20).Value\n    .TextBox14.Value = anchorCell.Offset(0, 21).Value\n    .TextBox20.Value = anchorCell.Offset(0, 22).Value\nEnd With\nEnd Sub\n</code></pre>\n\n<p>Thanks</p>\n"}, {"tags": ["html", "vba", "excel", "web"], "comments": [{"owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "edited": false, "score": 0, "creation_date": 1486585939, "post_id": 42119406, "comment_id": 71414143, "body": "What&#39;s the page&#39;s URL you are trying to interact with?"}, {"owner": {"reputation": 1, "user_id": 7535846, "user_type": "registered", "profile_image": "https://graph.facebook.com/1856617024611287/picture?type=large", "display_name": "Dany Cardoso", "link": "https://stackoverflow.com/users/7535846/dany-cardoso"}, "reply_to_user": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "edited": false, "score": 0, "creation_date": 1486586423, "post_id": 42119406, "comment_id": 71414399, "body": "<a href=\"http://www4.bcb.gov.br/pec/conversao/conversao.asp\" rel=\"nofollow noreferrer\">www4.bcb.gov.br/pec/conversao/conversao.asp</a>"}, {"owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "edited": false, "score": 0, "creation_date": 1486587599, "post_id": 42119406, "comment_id": 71415061, "body": "I took a look. This control is in an iFrame with security enabled that prevents access via the DOM. Normally you&#39;d access this by <code>ie.document.GetElementsByTagName(&quot;iFrame&quot;)(0).ContentDocumen&zwnj;&#8203;t</code> them from here you can select the element. However I&#39;m getting an Access Denied error."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1529150813, "post_id": 42119406, "comment_id": 88776842, "body": "I have answered this here <a href=\"https://stackoverflow.com/questions/45969316/excel-web-query-submit-issues/50845661#50845661\" title=\"excel web query submit issues\">stackoverflow.com/questions/45969316/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": false, "score": 0, "last_activity_date": 1529731970, "last_edit_date": 1529731970, "creation_date": 1529151321, "answer_id": 50887815, "question_id": 42119406, "link": "https://stackoverflow.com/questions/42119406/vba-input-data-in-the-web-field/50887815#50887815", "title": "VBA input data in the Web field", "body": "<p><strong>tl;dr;</strong></p>\n\n<p>I cannot mark this as a duplicate as there is no accepted answer to where I posted an answer to a similar question. </p>\n\n<p>Not sure of the protocol as simply posting a link in the comments doesn't mean it will be found again.</p>\n\n<p>My full answer is here:  <a href=\"https://stackoverflow.com/questions/45969316/excel-web-query-submit-issues/50845661#50845661\">Excel Web Query Submit Issues</a></p>\n\n<hr>\n\n<p><strong>To summarize:</strong> </p>\n\n<p>You can use the <a href=\"https://dadosabertos.bcb.gov.br/en/\" rel=\"nofollow noreferrer\">bcb.gov.br Open Data Portal</a>.</p>\n\n<p>Send a request for a JSON response with the conversion rates from their Exchange rates \u2013 <a href=\"https://dadosabertos.bcb.gov.br/en/dataset/exchange-rates-daily-bulletins\" rel=\"nofollow noreferrer\">daily bulletins</a>.</p>\n\n<p>With the received response, amongst other methods, you can then:</p>\n\n<ol>\n<li>Use the <a href=\"https://github.com/VBA-tools/VBA-JSON\" rel=\"nofollow noreferrer\">JSON Converter</a> .basa and set the convert the response into a JSON object and work with that</li>\n<li>Parse the response as a string with a regex to get the values</li>\n</ol>\n\n<p>For brevity, I will give you just the second method here and you can view my other answer for both methods:</p>\n\n<pre><code>Public Sub GetInfo2()\n\n    Dim strURL As String, strJSON As String, item As Variant, http As Object, json As Object\n    Const TARGET_CURRENCY As String = \"USD\"\n    Const START_DATE As String = \"06-13-2018\"\n    Const END_DATE As String = \"06-13-2018\"\n\n    strURL = \"https://olinda.bcb.gov.br/olinda/service/PTAX/version/v1/odata/ExchangeRatePeriod(moeda=@moeda,dataInicial=@dataInicial,dataFinalCotacao=@dataFinalCotacao)?%40moeda=%27\" &amp; TARGET_CURRENCY &amp; \"%27&amp;%40dataInicial=%27\" &amp; START_DATE &amp; \"%27&amp;%40dataFinalCotacao=%27\" &amp; END_DATE &amp; \"%27&amp;%24format=json\"\n\n    Set http = CreateObject(\"MSXML2.XMLHTTP\")\n    http.Open \"GET\", strURL, False\n    http.send\n    strJSON = http.responseText\n    Dim Matches As Object\n    With CreateObject(\"VBScript.RegExp\")\n        .Global = True\n        .MultiLine = True\n        .IgnoreCase = False\n        .Pattern = \"\"\"cotacaoCompra\"\":\\d{1,}.\\d{1,}\"  'The pattern I really wanted, \"(?&lt;=\"\"cotacaoCompra\"\":)\\d{1,}.\\d{1,}\", doesn't appear to be supported\n\n        If Not .test(strJSON) Then Exit Sub\n        Set Matches = .Execute(strJSON)\n\n        Dim match As Object\n        For Each match In Matches\n            Debug.Print Replace(match, \"\"\"cotacaoCompra\"\":\", vbNullString)\n        Next\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 7535846, "user_type": "registered", "profile_image": "https://graph.facebook.com/1856617024611287/picture?type=large", "display_name": "Dany Cardoso", "link": "https://stackoverflow.com/users/7535846/dany-cardoso"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 242, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1529731970, "creation_date": 1486573688, "last_edit_date": 1486574097, "question_id": 42119406, "link": "https://stackoverflow.com/questions/42119406/vba-input-data-in-the-web-field", "title": "VBA input data in the Web field", "body": "<p>I am coding vba to open the central bank's website and input the values \u200b\u200band extract the data, I usually do this on the mail site, bank of Brazil etc ...</p>\n\n<p>() of the central bank</p>\n\n<pre><code>I can not give the input value via vba in the textbox I've already tried:\n\n\n\nIe.Document.all.Item(\"valueConverter\").Innertext=\"1\"\nIe.Document.getElementById(\"valueConverter\").Value=\"1\"\nIe.Document.getElementById(\"valueConverter\")(0).Value=\"1\"\nIe.Document.getElementByName(\"valueConverter\").Value = \"1\"\n</code></pre>\n\n<p>The Elements of this site is this:</p>\n\n<pre><code>&lt;Input type = \"text\" name = \"valueConverter\" maxlength = \"17\" size \"20\" value onkeypress = \"return (MascaraMoeda (this, '.', ',', Event)\n</code></pre>\n\n<p>Does anyone know how?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 0, "creation_date": 1486573875, "post_id": 42119369, "comment_id": 71407189, "body": "You will need am <b><i>array</i></b> for <code>strSearch</code>"}, {"owner": {"reputation": 170, "user_id": 6801688, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11a37a17d5a095e296eabc8cd88e78a3?s=128&d=identicon&r=PG&f=1", "display_name": "Joe", "link": "https://stackoverflow.com/users/6801688/joe"}, "edited": false, "score": 0, "creation_date": 1486574243, "post_id": 42119369, "comment_id": 71407413, "body": "Here&#39;s a good question that covers searching for alphabetical characters only (<a href=\"http://stackoverflow.com/questions/29633517/how-can-i-check-if-a-string-only-contains-letters\" title=\"how can i check if a string only contains letters\">stackoverflow.com/questions/29633517/&hellip;</a>). This will almost surely simplify your code if you&#39;re willing to refactor."}, {"owner": {"reputation": 11, "user_id": 6034054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a15b5eac75bfaad068d0c4e689dc57a6?s=128&d=identicon&r=PG&f=1", "display_name": "Imperdiet", "link": "https://stackoverflow.com/users/6034054/imperdiet"}, "edited": false, "score": 0, "creation_date": 1486575047, "post_id": 42119369, "comment_id": 71407843, "body": "Gary- Sorry, I am very in experienced with this, but I did hear array get mentioned alot. Where and how will I incorporate it?"}, {"owner": {"reputation": 11, "user_id": 6034054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a15b5eac75bfaad068d0c4e689dc57a6?s=128&d=identicon&r=PG&f=1", "display_name": "Imperdiet", "link": "https://stackoverflow.com/users/6034054/imperdiet"}, "edited": false, "score": 0, "creation_date": 1486575084, "post_id": 42119369, "comment_id": 71407858, "body": "Joe- I see it highlights it, but how would I remove cells that do not fit the criteria?"}], "answers": [{"comments": [{"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "reply_to_user": {"reputation": 11, "user_id": 6034054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a15b5eac75bfaad068d0c4e689dc57a6?s=128&d=identicon&r=PG&f=1", "display_name": "Imperdiet", "link": "https://stackoverflow.com/users/6034054/imperdiet"}, "edited": false, "score": 0, "creation_date": 1486575013, "post_id": 42119599, "comment_id": 71407825, "body": "too vague a sentence... be more descriptive about what&#39;s not working in detail"}, {"owner": {"reputation": 11, "user_id": 6034054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a15b5eac75bfaad068d0c4e689dc57a6?s=128&d=identicon&r=PG&f=1", "display_name": "Imperdiet", "link": "https://stackoverflow.com/users/6034054/imperdiet"}, "edited": false, "score": 0, "creation_date": 1486576090, "post_id": 42119599, "comment_id": 71408464, "body": "I ran the macro, but nothing happened. I didn&#39;t get any error messages though."}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "reply_to_user": {"reputation": 11, "user_id": 6034054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a15b5eac75bfaad068d0c4e689dc57a6?s=128&d=identicon&r=PG&f=1", "display_name": "Imperdiet", "link": "https://stackoverflow.com/users/6034054/imperdiet"}, "edited": false, "score": 0, "creation_date": 1486576384, "post_id": 42119599, "comment_id": 71408645, "body": "I tested it with column A cells contents like &quot;1abcd&quot;, &quot;abcd1&quot;, &quot;abcd.&quot;, &quot;abcd_&quot;, &quot;abc_d&quot;, &quot;ab.cd&quot;, ... and they all got deleted."}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "reply_to_user": {"reputation": 11, "user_id": 6034054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a15b5eac75bfaad068d0c4e689dc57a6?s=128&d=identicon&r=PG&f=1", "display_name": "Imperdiet", "link": "https://stackoverflow.com/users/6034054/imperdiet"}, "edited": false, "score": 0, "creation_date": 1486576630, "post_id": 42119599, "comment_id": 71408799, "body": "also check the sheet name: I changed it to &quot;Sheet01&quot; not to conflict with other sheet of mine in my test workbook"}], "tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": false, "score": 0, "last_activity_date": 1486574269, "creation_date": 1486574269, "answer_id": 42119599, "question_id": 42119369, "link": "https://stackoverflow.com/questions/42119369/how-do-i-delete-cells-based-on-a-certain-number-of-values/42119599#42119599", "title": "How do I delete cells based on a certain number of values?", "body": "<p>you could try this:</p>\n\n<pre><code>Sub Sample()\n    Dim strSearch As Variant\n\n    strSearch = Array(\"*.*\", \"*0*\", \"*1*\", \"*2*\", \"*3*\", \"*4*\", \"*5*\", \"*6*\", \"*7*\", \"*8*\", \"*9*\", \"*_*\")\n    With Sheets(\"Sheet01\")\n        With .Range(\"A1\", .Cells(.Rows.count, 1).End(xlUp))\n            .AutoFilter Field:=1, Criteria1:=strSearch, Operator:=xlFilterValues\n            If Application.WorksheetFunction.Subtotal(103, .Cells) &gt; 1 Then .Offset(1).Resize(.Rows.count - 1).SpecialCells(xlCellTypeVisible).EntireRow.Delete\n        End With\n        .AutoFilterMode = False\n    End With\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 11, "user_id": 6034054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a15b5eac75bfaad068d0c4e689dc57a6?s=128&d=identicon&r=PG&f=1", "display_name": "Imperdiet", "link": "https://stackoverflow.com/users/6034054/imperdiet"}, "edited": false, "score": 0, "creation_date": 1486577039, "post_id": 42120251, "comment_id": 71409057, "body": "Oh my gosh, this is one that finally works! Thank you! It takes a while, but I don&#39;t mind because it actually works!! :D"}, {"owner": {"reputation": 2235, "user_id": 7535125, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209489062678374/picture?type=large", "display_name": "Brandon Barney", "link": "https://stackoverflow.com/users/7535125/brandon-barney"}, "reply_to_user": {"reputation": 11, "user_id": 6034054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a15b5eac75bfaad068d0c4e689dc57a6?s=128&d=identicon&r=PG&f=1", "display_name": "Imperdiet", "link": "https://stackoverflow.com/users/6034054/imperdiet"}, "edited": false, "score": 0, "creation_date": 1486577430, "post_id": 42120251, "comment_id": 71409290, "body": "Not a problem! Depending on what you are doing, any loop can take a while, especially as you select larger ranges. Something to keep in mind though is that loading your values into memory (like I did with the arrays) is faster than trying to edit the worksheet since editing the worksheet has additional events attached to it."}], "tags": [], "owner": {"reputation": 2235, "user_id": 7535125, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209489062678374/picture?type=large", "display_name": "Brandon Barney", "link": "https://stackoverflow.com/users/7535125/brandon-barney"}, "is_accepted": false, "score": 0, "last_activity_date": 1486576744, "last_edit_date": 1486576744, "creation_date": 1486576335, "answer_id": 42120251, "question_id": 42119369, "link": "https://stackoverflow.com/questions/42119369/how-do-i-delete-cells-based-on-a-certain-number-of-values/42120251#42120251", "title": "How do I delete cells based on a certain number of values?", "body": "<p>It depends on what you are hoping to accomplish with this macro. The below macro would satisfy what you are looking for:</p>\n\n<pre><code>Sub CleanNumerics()\nApplication.ScreenUpdating = False\n\nDim ws As Worksheet\nDim r As Range\nDim cell As Range\n\nDim i As Long\nDim j As Long\n\nDim args() As Variant\n\n' Load your arguments into an array to allow looping\nargs() = Array(\".\", \"0\", \"1\", \"2\", \"3\", \"4\", \"5\", \"6\", \"7\", \"8\", \"9\", \"_\")\n\n' Load your selection into a range variable\nSet r = Selection\n\n' By stepping backwards we wont skip cells as we delete rows.\nFor i = r.Cells.Count To 1 Step -1\n    ' Loop through the number of arguments in our array.\n    For j = 0 To UBound(args())\n        ' If one of the noted characters is in the cell, the row\n        ' is deleted and the loop exits.\n        If InStr(1, r.Cells(i), args(j)) &gt; 0 Then\n            r.Cells(i).EntireRow.Delete\n            Exit For\n        End If\n    Next\nNext\n\n\nEnd Sub\n</code></pre>\n\n<p>The problem with this approach is that you are deleting an entire row which could lead to issues depending on your application. Additionally, if you are doing this with a large dataset it could take a long time. You could use arrays to overcome this, but these can get complicated.</p>\n\n<p>Doing it with an array would look something like this:</p>\n\n<pre><code>Sub ArrayWithoutNumbers()\nApplication.ScreenUpdating = False\n\nDim ws As Worksheet\nDim r As Range\nDim cell As Range\n\nDim i As Long\nDim j As Long\nDim k As Long\nDim m As Long\n\nDim args() As Variant\n\nDim array_1() As Variant\nDim array_2() As Variant\n\nDim flag As Boolean\n\n' Load your arguments into an array to allow looping\nargs() = Array(\".\", \"0\", \"1\", \"2\", \"3\", \"4\", \"5\", \"6\", \"7\", \"8\", \"9\", \"_\")\n\n' Load your selection into a range variable\nOn Error GoTo Err\narray_1() = Selection.Value\nOn Error GoTo 0\n\n' First determine if a two dimensional array has created. If so, loop through rows\n' and columns. If not, go to the other loop.\nIf UBound(array_1, 2) &gt; 1 Then\n    For i = 1 To UBound(array_1, 1)\n        For j = 1 To UBound(array_1, 2)\n            flag = False\n            For k = 0 To UBound(args())\n                If InStr(1, array_1(i, j), args(k)) &gt; 0 Then\n                    flag = True ' Sets a flag so that the item is not added.\n                    Exit For    ' Exit the loop\n                End If\n            Next\n\n            ' If the flag hasn't been raised, resize the array and add the item.\n            If flag = False Then\n                m = m + 1\n                ReDim Preserve array_2(1 To m)\n                array_2(m) = array_1(i, j)\n            End If\n        Next\n    Next\n\n' Loops through only the rows of the array.\n\nElseIf UBound(array_1, 2) = 1 Then\n    For i = 1 To UBound(array_1, 1)\n        For k = 0 To UBound(args())\n            If InStr(1, array_1(i), args(k)) &gt; 0 Then\n                flag = True\n                Exit For\n            End If\n        Next\n        If flag = False Then\n            m = m + 1\n            ReDim Preserve array_2(1 To m)\n            array_2(m) = array_1(i)\n        End If\n    Next\nEnd If\n\n' Adds a worksheet to output to. You can adjust this as needed.\n\nActiveWorkbook.Sheets.Add\nActiveSheet.Range(\"A1\").Resize(UBound(array_2, 1), 1).Value = array_2()\n\nExit Sub\n\nErr:\n\nEnd Sub\n</code></pre>\n\n<p>The benefit to this is that you can clean up multiple rows and columns at once, and spit it back out.</p>\n"}], "owner": {"reputation": 11, "user_id": 6034054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a15b5eac75bfaad068d0c4e689dc57a6?s=128&d=identicon&r=PG&f=1", "display_name": "Imperdiet", "link": "https://stackoverflow.com/users/6034054/imperdiet"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 57, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1486576744, "creation_date": 1486573567, "last_edit_date": 1486573875, "question_id": 42119369, "link": "https://stackoverflow.com/questions/42119369/how-do-i-delete-cells-based-on-a-certain-number-of-values", "title": "How do I delete cells based on a certain number of values?", "body": "<p>I have a large amount of data with some cells having a mixture of numbers, full stops and underscores. However, I want to make a macro that will delete cells that contains numbers etc, so that the only cells left contain letters from the alphabet. Below is the current code I have but it doesn't work properly. How do I fix it?</p>\n\n<pre><code>    Sub Sample()\nDim ws As Worksheet\nDim strSearch As String\nDim Lrow As Long\n\n\nstrSearch = \".\"\nstrSearch = \"0\"\nstrSearch = \"1\"\nstrSearch = \"2\"\nstrSearch = \"3\"\nstrSearch = \"4\"\nstrSearch = \"5\"\nstrSearch = \"6\"\nstrSearch = \"7\"\nstrSearch = \"8\"\nstrSearch = \"9\"\nstrSearch = \".\"\n\n\nSet ws = Sheets(\"Sheet1\")\n\nWith ws\n    Lrow = .Range(\"A\" &amp; .Rows.Count).End(xlUp).Row\n\n    '~~&gt; Remove any filters\n    .AutoFilterMode = False\n\n    '~~&gt; Filter, offset(to exclude headers) and delete visible rows\n    With .Range(\"A1:A\" &amp; Lrow)\n      .AutoFilter Field:=1, Criteria1:=\"=*\" &amp; strSearch &amp; \"*\"\n      .Offset(1, 0).SpecialCells(xlCellTypeVisible).EntireRow.Delete\n    End With\n\n    '~~&gt; Remove any filters\n    .AutoFilterMode = False\nEnd With\nEnd Sub\n</code></pre>\n\n<p>I also have this bit of code which doesn't work properly. Which one of the two should I use and how do I fix them? Also, which one should I use?</p>\n\n<pre><code>    Sub Test()\nDim cell As Range\n\nFor Each cell In Selection\nIf InStr(1, cell, \"1\", vbTextCompare) &gt; 0 Then\n    cell.EntireRow.Delete\n    End If\nNext\nFor Each cell In Selection\nIf InStr(1, cell, \"2\", vbTextCompare) &gt; 0 Then\n    cell.EntireRow.Delete\n    End If\nNext\nFor Each cell In Selection\nIf InStr(1, cell, \"3\", vbTextCompare) &gt; 0 Then\n    cell.EntireRow.Delete\nEnd If\nNext\nFor Each cell In Selection\nIf InStr(1, cell, \"4\", vbTextCompare) &gt; 0 Then\n    cell.EntireRow.Delete\nEnd If\nNext\nFor Each cell In Selection\nIf InStr(1, cell, \"5\", vbTextCompare) &gt; 0 Then\n    cell.EntireRow.Delete\nEnd If\nNext\nFor Each cell In Selection\nIf InStr(1, cell, \"6\", vbTextCompare) &gt; 0 Then\n    cell.EntireRow.Delete\nEnd If\nNext\nFor Each cell In Selection\nIf InStr(1, cell, \"7\", vbTextCompare) &gt; 0 Then\n    cell.EntireRow.Delete\nEnd If\nNext\nFor Each cell In Selection\nIf InStr(1, cell, \"8\", vbTextCompare) &gt; 0 Then\n    cell.EntireRow.Delete\nEnd If\nNext\nFor Each cell In Selection\nIf InStr(1, cell, \"9\", vbTextCompare) &gt; 0 Then\n    cell.EntireRow.Delete\nEnd If\nNext\nFor Each cell In Selection\nIf InStr(1, cell, \"0\", vbTextCompare) &gt; 0 Then\n    cell.EntireRow.Delete\nEnd If\nNext\nFor Each cell In Selection\nIf InStr(1, cell, \".\", vbTextCompare) &gt; 0 Then\n    cell.EntireRow.Delete\nEnd If\nNext\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "variables"], "comments": [{"owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "edited": false, "score": 0, "creation_date": 1486573650, "post_id": 42119350, "comment_id": 71407034, "body": "<code>Formula1:=&quot;=ISBLANK(&quot; &amp; addrss &amp; &quot;)=True&quot;</code>. What ever you put inside <code>&quot;</code> is just string literally."}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1486573662, "post_id": 42119350, "comment_id": 71407040, "body": "try <code>&quot;=ISBLANK(&quot; &amp; addrss &amp; &quot;)=True&quot;</code>"}, {"owner": {"reputation": 1, "user_id": 7535851, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1236fd53b4b2241b32322b6e0a27ad30?s=128&d=identicon&r=PG&f=1", "display_name": "Michael Cox", "link": "https://stackoverflow.com/users/7535851/michael-cox"}, "edited": false, "score": 0, "creation_date": 1486663375, "post_id": 42119350, "comment_id": 71453758, "body": "Awesome those worked perfectly.  Thank you."}], "owner": {"reputation": 1, "user_id": 7535851, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1236fd53b4b2241b32322b6e0a27ad30?s=128&d=identicon&r=PG&f=1", "display_name": "Michael Cox", "link": "https://stackoverflow.com/users/7535851/michael-cox"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 27, "favorite_count": 0, "closed_date": 1486577702, "answer_count": 0, "score": 0, "last_activity_date": 1486573517, "creation_date": 1486573517, "question_id": 42119350, "link": "https://stackoverflow.com/questions/42119350/can-i-use-a-variable-address-in-an-isblank-statement", "closed_reason": "Duplicate", "title": "Can I use a variable address in an ISBLANK() statement", "body": "<p>I'm trying to add conditional formatting into a vba code and am having trouble with my ISBLANK statement.  </p>\n\n<p>Is it possible to use a variable address to define the cell I would like to check?</p>\n\n<p>Here is what I have so far.</p>\n\n<pre><code>`Sub Employee_Training_Record()\nDim lastrow As Long\nDim lastcol As Long\n\nIf Cells(3, 2).Value = \"\" Then\nMsgBox \"No Employees in List\"\nGoTo gohere1:\nElseIf Cells(2, 3).Value = \"\" Then\nMsgBox \"No Training in List\"\nGoTo gohere1:\nEnd If\n\nlastrow = Cells(30, 2).End(xlUp).Row\nlastcol = Cells(2, 30).End(xlToLeft).Column\n\nemployee = InputBox(\"Enter Employee Name\")\nDo While employee = \"\"\nemployee = InputBox(\"Enter Employee Name\")\nLoop\nFor i = 3 To lastrow\n    a = 0\n    If Cells(i, 2).Value = employee Then\n    GoTo gohere:\n    Else\n    a = 1\n    End If\nNext\nIf a = 1 Then\nMsgBox \"Employee Not Found\"\nGoTo gohere1:\nEnd If\ngohere:\n\ntrning = InputBox(\"Enter Training Type\")\nDo While trning = \"\"\ntrning = InputBox(\"Enter Training Type\")\nLoop\nFor i = 3 To lastcol\n    b = 0\n    If Cells(2, i).Value = trning Then\n    GoTo gohere5:\n    Else\n    b = 1\n    End If\nNext\nIf b = 1 Then\nMsgBox \"Training Not Found\"\nGoTo gohere1:\nEnd If\ngohere5:\n\nexprnc = InputBox(\"Enter Expiration Date\")\nFor i = 3 To lastrow\n    If Cells(i, 2).Value = employee Then\n    GoTo gohere3:\n    End If\nNext\ngohere3:\nFor j = 1 To lastcol\n    If Cells(2, j).Value = trning Then\n    j = j + 1\n    GoTo gohere4:\n    End If\nNext\ngohere4:\n\nCells(i, j).Value = exprnc\n\n    Cells(i, j).FormatConditions.Add Type:=xlCellValue, Operator:=xlLess, _\n        Formula1:=\"=NOW()+60\"\n    Cells(i, j).FormatConditions(Selection.FormatConditions.Count).SetFirstPriority\n    With Cells(i, j).FormatConditions(1).Interior\n        .PatternColorIndex = xlAutomatic\n        .Color = 49407\n        .TintAndShade = 0\n    End With\n    Cells(i, j).FormatConditions(1).StopIfTrue = False\n\n    Cells(i, j).FormatConditions.Add Type:=xlCellValue, Operator:=xlLess, _\n        Formula1:=\"=NOW()\"\n    Cells(i, j).FormatConditions(Selection.FormatConditions.Count).SetFirstPriority\n    With Selection.FormatConditions(1).Interior\n        .PatternColorIndex = xlAutomatic\n        .Color = 255\n        .TintAndShade = 0\n    End With\n    Cells(i, j).FormatConditions(1).StopIfTrue = False\n\n    addrss = Cells(i, j).Address\n\n    Cells(i, j).FormatConditions.Add Type:=xlExpression, Formula1:=\"=ISBLANK(addrss)=True\"\n    Cells(i, j).FormatConditions(Selection.FormatConditions.Count).SetFirstPriority\n    Cells(i, j).FormatConditions(1).StopIfTrue = True\n\n    MsgBox \"Cell Address\" &amp; Cells(i, j).Address()\n\ngohere1:\nEnd Sub`\n</code></pre>\n"}, {"tags": ["html", "vba", "internet-explorer"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1486577491, "post_id": 42119189, "comment_id": 71409324, "body": "I can&#39;t check the page source (connection reset), but from the sample table it looks like you can just pull all of the anchor elements."}], "answers": [{"tags": [], "owner": {"reputation": 21, "user_id": 7077360, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-lIL4jB60mKQ/AAAAAAAAAAI/AAAAAAAAACA/DUZdestHE_Q/photo.jpg?sz=128", "display_name": "DukeTogo", "link": "https://stackoverflow.com/users/7077360/duketogo"}, "is_accepted": false, "score": 1, "last_activity_date": 1486626088, "creation_date": 1486626088, "answer_id": 42130849, "question_id": 42119189, "link": "https://stackoverflow.com/questions/42119189/how-to-get-hyperlinks-from-internet-explorer-from-vba/42130849#42130849", "title": "How to get hyperlinks from internet explorer from VBA", "body": "<p>You can do this. It will pull all the links on the page and then you can have it print out the values in cells.</p>\n\n<pre><code>x = 1\nFor Each link In internet.document.Links\n    Cells(x, 1) = link\n    'or you can add your prefix URL and link at the same time\n    Cells(x, 1) = \"https://biz.yahoo.com/p/\" &amp; link\n    x = x + 1\nNext\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "is_accepted": false, "score": 0, "last_activity_date": 1486834333, "creation_date": 1486834333, "answer_id": 42178985, "question_id": 42119189, "link": "https://stackoverflow.com/questions/42119189/how-to-get-hyperlinks-from-internet-explorer-from-vba/42178985#42178985", "title": "How to get hyperlinks from internet explorer from VBA", "body": "<p>This may work for you.</p>\n\n<pre><code>Sub Macro1()\n\n    Range(\"A1\").Select\n    With ActiveSheet.QueryTables.Add(Connection:= _\n        \"URL;https://biz.yahoo.com/p/s_conameu.html\", Destination:=Range(\"$A$1\"))\n        .CommandType = 0\n        .Name = \"s_conameu_1\"\n        .FieldNames = True\n        .RowNumbers = False\n        .FillAdjacentFormulas = False\n        .PreserveFormatting = True\n        .RefreshOnFileOpen = False\n        .BackgroundQuery = True\n        .RefreshStyle = xlInsertDeleteCells\n        .SavePassword = False\n        .SaveData = True\n        .AdjustColumnWidth = True\n        .RefreshPeriod = 0\n        .WebSelectionType = xlSpecifiedTables\n        .WebFormatting = xlWebFormattingNone\n        .WebTables = \"4\"\n        .WebPreFormattedTextToColumns = True\n        .WebConsecutiveDelimitersAsOne = True\n        .WebSingleBlockTextImport = False\n        .WebDisableDateRecognition = False\n        .WebDisableRedirections = False\n        .Refresh BackgroundQuery:=False\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 41, "user_id": 3610196, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/96a0a3ce856e116224ded9ff6d9b6191?s=128&d=identicon&r=PG&f=1", "display_name": "user3610196", "link": "https://stackoverflow.com/users/3610196/user3610196"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 167, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1486834333, "creation_date": 1486573020, "question_id": 42119189, "link": "https://stackoverflow.com/questions/42119189/how-to-get-hyperlinks-from-internet-explorer-from-vba", "title": "How to get hyperlinks from internet explorer from VBA", "body": "<p>I am trying to get the links for the various sectors (Basic materials, Conglomerates, etc) within the <a href=\"https://biz.yahoo.com/p/s_conameu.html\" rel=\"nofollow noreferrer\">https://biz.yahoo.com/p/s_conameu.html</a> website.</p>\n\n<p>I have the code below, but since this site does not use ids to set what these links will be, I don't know how to actually find the links.  Also, the links are actually only partial.  I know what I would need to add to make them full (add <a href=\"https://biz.yahoo.com/p/\" rel=\"nofollow noreferrer\">https://biz.yahoo.com/p/</a> in front of the partial link in the html file.  the first link I see appears on line 238 of the html, but I'm not sure how to actually search and find this as the names of the sectors may change in the future.  I'm trying to make it agnostic where it can always search this list and pull all of the links.  </p>\n\n<p>Here is a snapshot of the html showing the link (starts on line 236):</p>\n\n<pre><code>nowrap\nbgcolor=ffffee&gt;&lt;a\nhref=1conameu.html&gt;&lt;font\nface=arial\nsize=-1&gt;Basic Materials&lt;/a&gt;&lt;/td&gt;&lt;td\nalign=right\nbgcolor=ffffff&gt;&lt;font\nface=arial\nsize=-1&gt;-0.13&lt;/font&gt;&lt;/td&gt;&lt;td\nalign=right\nbgcolor=ffffff&gt;&lt;font\nface=arial\nsize=-1&gt;293348.2B&lt;/font&gt;&lt;/td&gt;&lt;td\nalign=right\nbgcolor=ffffff&gt;&lt;font\nface=arial\nsize=-1&gt;17.42&lt;/font&gt;&lt;/td&gt;&lt;td\nalign=right\nbgcolor=ffffff&gt;&lt;font\nface=arial\nsize=-1&gt;6.50&lt;/font&gt;&lt;/td&gt;&lt;td\nalign=right\nbgcolor=ffffff&gt;&lt;font\nface=arial\nsize=-1&gt;4.12&lt;/font&gt;&lt;/td&gt;&lt;td\nalign=right\nbgcolor=ffffff&gt;&lt;font\nface=arial\nsize=-1&gt;69.76&lt;/font&gt;&lt;/td&gt;&lt;td\nalign=right\nbgcolor=ffffff&gt;&lt;font\nface=arial\nsize=-1&gt;3.09&lt;/font&gt;&lt;/td&gt;&lt;td\nalign=right\nbgcolor=ffffff&gt;&lt;font\nface=arial\nsize=-1&gt;1.35&lt;/font&gt;&lt;/td&gt;&lt;td\nalign=right\nbgcolor=ffffff&gt;&lt;font\nface=arial\nsize=-1&gt;6.48&lt;/font&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td\nnowrap\nbgcolor=ffffee&gt;&lt;a\nhref=2conameu.html&gt;&lt;font\nface=arial\nsize=-1&gt;Conglomerates&lt;/a&gt;&lt;/td&gt;&lt;td\n</code></pre>\n\n<p>Here is the code where I grab the website and get the contents.</p>\n\n<pre><code>Public Sub clicklick()\nDim internet As Object\nDim html As HTMLDocument\nDim internetdata As Object\nDim div_result As Object\nDim header_links As Object\nDim link As Object\nDim URL As String\nDim i As Integer\n\nSet internet = CreateObject(\"InternetExplorer.Application\")\ninternet.Visible = False\n\nURL = \"https://biz.yahoo.com/p/s_conameu.html\"\ninternet.Navigate URL\n\nWhile internet.Busy\n    DoEvents\nWend\n\nApplication.Wait Now + TimeSerial(0, 0, 5)\n\nSet internetdata = internet.Document\nSet div_result = internetdata.getElementById(\"res\")  // This does not work (obviously, but not sure how to really search).  Returns nothing.\n\nSet header_links = div_result.getelementsbytagname(\"h3\")    //This fails because div_result has nothing.\nMsgBox html.DocumentElement.innerHTML\nMsgBox div_result\nSPws.Cells.ClearContents\nFor Each h In header_links\n    Set link = h.ChildNodes.Item(0)\n    SPws.Cells(Range(\"A\" &amp; Rows.count).End(xlUp).row + 1, 1) = link.href\nNext\n\nMsgBox \"done\"\n\nEnd Sub\n</code></pre>\n\n<p>Thank you in advance for any help.  I'm hoping I can do what I want so I can automate some searches.</p>\n\n<p>thank you,\nAlan</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 2478, "user_id": 6110371, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/O93Qp.jpg?s=128&g=1", "display_name": "VBA Pete", "link": "https://stackoverflow.com/users/6110371/vba-pete"}, "reply_to_user": {"reputation": 7, "user_id": 5692225, "user_type": "registered", "profile_image": "https://graph.facebook.com/1245401662141863/picture?type=large", "display_name": "N Halsema", "link": "https://stackoverflow.com/users/5692225/n-halsema"}, "edited": false, "score": 0, "creation_date": 1486585157, "post_id": 42119933, "comment_id": 71413694, "body": "No worries.Don&#39;t forget to tick the answer checkbox if my answer helped!"}], "tags": [], "owner": {"reputation": 2478, "user_id": 6110371, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/O93Qp.jpg?s=128&g=1", "display_name": "VBA Pete", "link": "https://stackoverflow.com/users/6110371/vba-pete"}, "is_accepted": true, "score": 0, "last_activity_date": 1486575339, "creation_date": 1486575339, "answer_id": 42119933, "question_id": 42119122, "link": "https://stackoverflow.com/questions/42119122/excel-vba-reorder-email-content/42119933#42119933", "title": "Excel VBA Reorder Email Content", "body": "<p>There is a Range to HTML function made by Ron de Bruin that would help you with your issue. I have amended your code for his function to work:</p>\n\n<pre><code>Sub SendEmail()\n\nDim msg As String\nSet mailApp = CreateObject(\"Outlook.Application\")\nSet mail = mailApp.createitem(olMailItem)\nDim rng As Range\n\nmsg = \"Good Morning Team, \" &amp; \"&lt;br&gt;&lt;br&gt;\" _\n        &amp; \"Here is this week's Coffee Talk groups. Enjoy!\" &amp; \"&lt;br&gt;\"\n\nSet rng = Sheets(\"Groups\").Range(\"A1:E4\").SpecialCells(xlCellTypeVisible)\n\nWith mail\n    .To = \"someone@gmail.com\"\n    .Subject = \"Coffee Talk \" &amp; Date\n    .HTMLBody = msg &amp; \"&lt;br&gt;\" &amp; RangetoHTML(rng)\n    .display\nEnd With\n\nEnd Sub\n\nFunction RangetoHTML(rng As Range)\n' Changed by Ron de Bruin 28-Oct-2006\n' Working in Office 2000-2016\n    Dim fso As Object\n    Dim ts As Object\n    Dim TempFile As String\n    Dim TempWB As Workbook\n\n    TempFile = Environ$(\"temp\") &amp; \"\\\" &amp; Format(Now, \"dd-mm-yy h-mm-ss\") &amp; \".htm\"\n\n    'Copy the range and create a new workbook to past the data in\n    rng.Copy\n    Set TempWB = Workbooks.Add(1)\n    With TempWB.Sheets(1)\n        .Cells(1).PasteSpecial Paste:=8\n        .Cells(1).PasteSpecial xlPasteValues, , False, False\n        .Cells(1).PasteSpecial xlPasteFormats, , False, False\n        .Cells(1).Select\n        Application.CutCopyMode = False\n        On Error Resume Next\n        .DrawingObjects.Visible = True\n        .DrawingObjects.Delete\n        On Error GoTo 0\n    End With\n\n    'Publish the sheet to a htm file\n    With TempWB.PublishObjects.Add( _\n         SourceType:=xlSourceRange, _\n         Filename:=TempFile, _\n         Sheet:=TempWB.Sheets(1).Name, _\n         Source:=TempWB.Sheets(1).UsedRange.Address, _\n         HtmlType:=xlHtmlStatic)\n        .Publish (True)\n    End With\n\n    'Read all data from the htm file into RangetoHTML\n    Set fso = CreateObject(\"Scripting.FileSystemObject\")\n    Set ts = fso.GetFile(TempFile).OpenAsTextStream(1, -2)\n    RangetoHTML = ts.readall\n    ts.Close\n    RangetoHTML = Replace(RangetoHTML, \"align=center x:publishsource=\", _\n                          \"align=left x:publishsource=\")\n\n    'Close TempWB\n    TempWB.Close savechanges:=False\n\n    'Delete the htm file we used in this function\n    Kill TempFile\n\n    Set ts = Nothing\n    Set fso = Nothing\n    Set TempWB = Nothing\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 7, "user_id": 5692225, "user_type": "registered", "profile_image": "https://graph.facebook.com/1245401662141863/picture?type=large", "display_name": "N Halsema", "link": "https://stackoverflow.com/users/5692225/n-halsema"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 63, "favorite_count": 0, "accepted_answer_id": 42119933, "answer_count": 1, "score": 1, "last_activity_date": 1486580738, "creation_date": 1486572827, "last_edit_date": 1486580738, "question_id": 42119122, "link": "https://stackoverflow.com/questions/42119122/excel-vba-reorder-email-content", "title": "Excel VBA Reorder Email Content", "body": "<p>I have compiled the following code in VBA to send out an email. I want to send a simple message with a Range of cells in a table format. \nThe code below works. But the output is flipped. I want the message text on top and the table on the bottom. (Please see image attached). \nAny time I try to move anything around I get a \"424 Object Required\" error. </p>\n\n<p>Please advise. </p>\n\n<pre><code>Sub SendEmail()\nDim msg As String\nSet mailApp = CreateObject(\"Outlook.Application\")\nSet mail = mailApp.createitem(olMailItem)\n\nmsg = \"Good Morning Team, \" &amp; \"&lt;br&gt;&lt;br&gt;\" _\n        &amp; \"Here is this week's Coffee Talk groups. Enjoy!\" &amp; \"&lt;br&gt;&lt;br&gt;\"\n\nWith mail\n    .To = \"someone@gmail.com\"\n    .Subject = \"Coffee Talk \" &amp; Date\n    .HTMLBody = msg\nEnd With\nmail.display\n\nSet wEditor = mailApp.ActiveInspector.wordEditor\nThisWorkbook.Sheets(\"Groups\").Range(\"A1:E4\").Copy\nwEditor.Application.Selection.Paste\n\nEnd Sub\n</code></pre>\n\n<p><img src=\"https://i.stack.imgur.com/wxqt9.jpg\" alt=\"enter image description here\"></p>\n"}, {"tags": ["vba", "excel", "matrix"], "answers": [{"comments": [{"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "reply_to_user": {"reputation": 23, "user_id": 7535720, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c52a081cb9cc4c2f61237368affd6a17?s=128&d=identicon&r=PG&f=1", "display_name": "jonp", "link": "https://stackoverflow.com/users/7535720/jonp"}, "edited": false, "score": 0, "creation_date": 1486643894, "post_id": 42119329, "comment_id": 71439953, "body": "@jonp   If the answer adequately solves your problem you can mark it as accepted - which gives a certain closure to the question.yup"}, {"owner": {"reputation": 23, "user_id": 7535720, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c52a081cb9cc4c2f61237368affd6a17?s=128&d=identicon&r=PG&f=1", "display_name": "jonp", "link": "https://stackoverflow.com/users/7535720/jonp"}, "edited": false, "score": 0, "creation_date": 1486733921, "post_id": 42119329, "comment_id": 71486491, "body": "Sure - where do I do that?"}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "reply_to_user": {"reputation": 23, "user_id": 7535720, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c52a081cb9cc4c2f61237368affd6a17?s=128&d=identicon&r=PG&f=1", "display_name": "jonp", "link": "https://stackoverflow.com/users/7535720/jonp"}, "edited": false, "score": 0, "creation_date": 1486734699, "post_id": 42119329, "comment_id": 71486994, "body": "@jonp There should be a little check mark somewhere. I don&#39;t ask very many questions so I forget where it is exactly."}], "tags": [], "owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "is_accepted": true, "score": 0, "last_activity_date": 1486574563, "last_edit_date": 1486574563, "creation_date": 1486573431, "answer_id": 42119329, "question_id": 42118901, "link": "https://stackoverflow.com/questions/42118901/type-mimsatch-when-assigning-result-of-mmult-to-an-array-variable/42119329#42119329", "title": "Type mimsatch when assigning result of MMult to an array variable", "body": "<p>If you replace the line</p>\n\n<pre><code>matrix3 = Application.WorksheetFunction.MMult(matrix1, matrix2)\n</code></pre>\n\n<p>By</p>\n\n<pre><code>Debug.Print TypeName(matrix3 = Application.WorksheetFunction.MMult(matrix1, matrix2))\n</code></pre>\n\n<p>The output is:</p>\n\n<pre><code>Variant()\n</code></pre>\n\n<p>Which can't be assigned to an <code>Integer()</code>.</p>\n\n<p>I would recommend replacing </p>\n\n<pre><code>Dim matrix1() As Integer\nDim matrix2() As Integer\nDim matrix3() As Integer\nDim i, j, k As Integer\n</code></pre>\n\n<p>by</p>\n\n<pre><code>Dim matrix1, matrix2, matrix3 As Variant 'note lack of ()\nDim i, j, k As Long 'Integer is borderline obsolete in VBA\n</code></pre>\n\n<p>Variants do a nice job of holding and passing arrays and tend to handle any needed type conversions automatically. When dealing with arrays in VBA, I tend to use them almost exclusively. For one thing, it makes it easy to load arrays from ranges.</p>\n\n<p>Just use <code>ReDim</code> to make the variants hold arrays:</p>\n\n<pre><code>ReDim matrix1(1 to 3, 1 to 3) 'doesn't hurt to be explicit about lower bounds\nReDim matrix2(1 to 3, 1 to 3)\n'load arrays...\n'no need to redim matrix3, just:\nmatrix3 = Application.WorksheetFunction.MMult(matrix1, matrix2)\n</code></pre>\n\n<p>There is an even shorter way of doing what you are trying to do:</p>\n\n<pre><code>matrix1 = Range(\"C5:E7\").Value\nmatrix2 = Range(\"G5:I7\").Value\nmatrix3 = Application.WorksheetFunction.MMult(matrix1, matrix2)\n</code></pre>\n\n<p>In the above code you don't need to use any preliminary <code>ReDim</code>. When you want to load the values of a rectangular range into a variant in VBA, you don't need to loop, which is needlessly slow. Just assign the values in one fell swoop.</p>\n"}], "owner": {"reputation": 23, "user_id": 7535720, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c52a081cb9cc4c2f61237368affd6a17?s=128&d=identicon&r=PG&f=1", "display_name": "jonp", "link": "https://stackoverflow.com/users/7535720/jonp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 728, "favorite_count": 0, "accepted_answer_id": 42119329, "answer_count": 1, "score": 2, "last_activity_date": 1486583966, "creation_date": 1486572313, "last_edit_date": 1531164843, "question_id": 42118901, "link": "https://stackoverflow.com/questions/42118901/type-mimsatch-when-assigning-result-of-mmult-to-an-array-variable", "title": "Type mimsatch when assigning result of MMult to an array variable", "body": "<p>Apologies for the newbie question, but I couldn't find an answer when searching.</p>\n\n<p>I'm fairly new to matrix manipulation in VBA. I keep on getting a type mismatch with the following code. </p>\n\n<pre><code>Sub matrixtest()\n\nDim matrix1() As Integer\nDim matrix2() As Integer\nDim matrix3() As Integer\nDim i, j, k As Integer\n\n'populate matrix1\nReDim matrix1(3, 3)\nFor j = 1 To 3\n    For i = 1 To 3\n        matrix1(i, j) = Range(\"C5\").Offset(i - 1, j - 1)\n    Next i\nNext j\n\n'populate matrix2\nReDim matrix2(3, 3)\nFor j = 1 To 3\n    For i = 1 To 3\n        matrix2(i, j) = Range(\"G5\").Offset(i - 1, j - 1)\n    Next i\nNext j\n\nReDim matrix3(3, 3)\nmatrix3 = Application.WorksheetFunction.MMult(matrix1, matrix2)\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "is_accepted": true, "score": 1, "last_activity_date": 1486572971, "creation_date": 1486572971, "answer_id": 42119171, "question_id": 42118881, "link": "https://stackoverflow.com/questions/42118881/multipage-userform-excel-add-next-button/42119171#42119171", "title": "Multipage UserForm Excel - Add Next Button", "body": "<p><code>Value</code> property of the MultiPage Control, sets/gets the active page.</p>\n\n<hr>\n\n<p><a href=\"https://i.stack.imgur.com/zR7w1.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/zR7w1.png\" alt=\"enter image description here\"></a></p>\n\n<pre><code> Private Sub cmdNext_Click()\n        Dim lCurrentPage As Long\n\n        lCurrentPage = Me.MultiPage1.Value + 1\n\n        If lCurrentPage = Me.MultiPage1.Pages.Count Then\n            MsgBox \"You are on the last page.\"\n        Else\n            Me.MultiPage1.Value = lCurrentPage\n        End If\n\n    End Sub\n</code></pre>\n"}], "owner": {"reputation": 87, "user_id": 7406786, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh4.googleusercontent.com/-iwIOdgYVqTk/AAAAAAAAAAI/AAAAAAAABJQ/X9hnIYvyRUw/photo.jpg?sz=128", "display_name": "David Quetglas", "link": "https://stackoverflow.com/users/7406786/david-quetglas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 919, "favorite_count": 1, "accepted_answer_id": 42119171, "answer_count": 1, "score": 2, "last_activity_date": 1487317526, "creation_date": 1486572241, "last_edit_date": 1487317526, "question_id": 42118881, "link": "https://stackoverflow.com/questions/42118881/multipage-userform-excel-add-next-button", "title": "Multipage UserForm Excel - Add Next Button", "body": "<p>Is it possible to add a button on page one on a Userform with multipages so that it will take you to the other pages? Can sopmeone post a simple code for that?</p>\n"}, {"tags": ["sql", "oracle", "vba", "variables"], "comments": [{"owner": {"reputation": 2393, "user_id": 986846, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/55280bd5ca07d70702cc458f174ade6c?s=128&d=identicon&r=PG&f=1", "display_name": "Renats Stozkovs", "link": "https://stackoverflow.com/users/986846/renats-stozkovs"}, "edited": false, "score": 0, "creation_date": 1486572900, "post_id": 42118844, "comment_id": 71406501, "body": "This is not a complete code. Where are you <code>Dim</code> statements? Where do you actually execute the <code>SQL_String</code>? Please be more complete. No need to share anything proprietary, just be as complete as possible"}, {"owner": {"reputation": 14660, "user_id": 1704458, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/14Imh.jpg?s=128&g=1", "display_name": "T.S.", "link": "https://stackoverflow.com/users/1704458/t-s"}, "edited": false, "score": 1, "creation_date": 1486610565, "post_id": 42118844, "comment_id": 71423067, "body": "<code>Debug.WriteLine(SQL_String)</code> and see if the sql is correct"}, {"owner": {"reputation": 14660, "user_id": 1704458, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/14Imh.jpg?s=128&g=1", "display_name": "T.S.", "link": "https://stackoverflow.com/users/1704458/t-s"}, "edited": false, "score": 0, "creation_date": 1486651946, "post_id": 42118844, "comment_id": 71445742, "body": "If you have new info, edit your question instead of posting false answers. Thank you."}], "owner": {"reputation": 89, "user_id": 6009772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4cae43c5ac135fa5e3c78d20b954022b?s=128&d=identicon&r=PG&f=1", "display_name": "Melvin86", "link": "https://stackoverflow.com/users/6009772/melvin86"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 565, "favorite_count": 0, "closed_date": 1486659260, "answer_count": 0, "score": 2, "last_activity_date": 1486636145, "creation_date": 1486572152, "last_edit_date": 1486575062, "question_id": 42118844, "link": "https://stackoverflow.com/questions/42118844/vba-sql-query-with-dates-as-variable-on-oracle-db", "closed_reason": "Not suitable for this site", "title": "VBA - SQL query with dates as variable on Oracle DB", "body": "<p>I am performing in VBA an SQL query selecting per date. Everything is working until I specify the dates, as the code below:</p>\n\n<pre><code>conn.Open dbConnectStr\n\nStartDate = \"01/01/2015\"\n\nSQL_String = \"SELECT * FROM database \" &amp; _\n             \"WHERE date BETWEEN to_date('01/01/2015','dd/mm/yyyy') and to_date('31/12/2016','dd/mm/yyyy')\"\n\nrecset.Close\nconn.Close\n</code></pre>\n\n<p>But, when I put in a variable instead of dates I obtain an error <code>multiple-step operation completed with one or more errors. Check each status values.</code></p>\n\n<pre><code>conn.Open dbConnectStr\n\nStartDate = \"01/01/2015\"\nEndDate = \"31/12/2016\"\n\nSQL_String = \"SELECT * FROM database \" &amp; _\n             \"WHERE date BETWEEN to_date('\" &amp; StartDate &amp; \"','dd/mm/yyyy') and to_date('\" &amp; EndDate &amp; \"','dd/mm/yyyy')\"\n\nrecset.Close\nconn.Close\n</code></pre>\n\n<p>Anybody could suggest how to proceed?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 4621, "user_id": 4709298, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/fe41ea7cc395df33b3ad744599248d80?s=128&d=identicon&r=PG&f=1", "display_name": "Preston", "link": "https://stackoverflow.com/users/4709298/preston"}, "edited": false, "score": 0, "creation_date": 1486572658, "post_id": 42118824, "comment_id": 71406330, "body": "surely myfile2 = dir is what you mean?"}, {"owner": {"reputation": 75, "user_id": 7329697, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aa2826607270fcb64e9835e7c02a8399?s=128&d=identicon&r=PG&f=1", "display_name": "Patrick", "link": "https://stackoverflow.com/users/7329697/patrick"}, "reply_to_user": {"reputation": 4621, "user_id": 4709298, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/fe41ea7cc395df33b3ad744599248d80?s=128&d=identicon&r=PG&f=1", "display_name": "Preston", "link": "https://stackoverflow.com/users/4709298/preston"}, "edited": false, "score": 0, "creation_date": 1486573603, "post_id": 42118824, "comment_id": 71407009, "body": "The error appears in the third line of this code <code>Dim MyFile2 As String</code>. I could never try the &quot;Do&quot; part because of the error, i will switch it then. Oh yes, this is another mistake <code>myfile2 = dir</code>, thanks!"}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 2, "creation_date": 1486573793, "post_id": 42118824, "comment_id": 71407128, "body": "<code>Dim MyFile2 As Sting</code> -&gt; <code>Dim MyFile2 As String</code>. Use <code>Option Explicit</code> to avoid such mystypes"}, {"owner": {"reputation": 75, "user_id": 7329697, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aa2826607270fcb64e9835e7c02a8399?s=128&d=identicon&r=PG&f=1", "display_name": "Patrick", "link": "https://stackoverflow.com/users/7329697/patrick"}, "edited": false, "score": 0, "creation_date": 1486574981, "post_id": 42118824, "comment_id": 71407805, "body": "Thats&#39;s a very dumb misstyp, I will set this option and correct <code>Sting</code>"}], "answers": [{"tags": [], "owner": {"reputation": 11192, "user_id": 5514747, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/db1a440aac7d279213c66bcdb1c1984a?s=128&d=identicon&r=PG", "display_name": "Harun24HR", "link": "https://stackoverflow.com/users/5514747/harun24hr"}, "is_accepted": false, "score": 1, "last_activity_date": 1486574028, "creation_date": 1486574028, "answer_id": 42119527, "question_id": 42118824, "link": "https://stackoverflow.com/questions/42118824/vba-copy-paste-all-files-in-a-folder/42119527#42119527", "title": "VBA copy paste all files in a folder", "body": "<p>Following sub will copy all files from source folder to destination folder.</p>\n\n<pre><code>    Sub AllFiles()\n    Dim FSO As Object\n    Dim FromPath As String\n    Dim ToPath As String\n\n        FromPath = \"C:\\Users\\Alam\\Music\\Awlad Hossain\"  'Souece Folder\n        ToPath = \"C:\\MyExcelFiles\"    'Destination folder\n\n            If Right(FromPath, 1) = \"\\\" Then\n                FromPath = Left(FromPath, Len(FromPath) - 1)\n            End If\n\n            If Right(ToPath, 1) = \"\\\" Then\n                ToPath = Left(ToPath, Len(ToPath) - 1)\n            End If\n\n        Set FSO = CreateObject(\"scripting.filesystemobject\")\n\n            If FSO.FolderExists(FromPath) = False Then\n                MsgBox FromPath &amp; \" doesn't exist\"\n                Exit Sub\n            End If\n\n        FSO.CopyFolder Source:=FromPath, Destination:=ToPath\n        MsgBox \"You can find the files and subfolders from \" &amp; FromPath &amp; \" in \" &amp; ToPath\n\n    End Sub\n</code></pre>\n\n<p><a href=\"http://www.rondebruin.nl/win/s3/win026.htm\" rel=\"nofollow noreferrer\">More details here:</a></p>\n"}, {"comments": [{"owner": {"reputation": 75, "user_id": 7329697, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aa2826607270fcb64e9835e7c02a8399?s=128&d=identicon&r=PG&f=1", "display_name": "Patrick", "link": "https://stackoverflow.com/users/7329697/patrick"}, "edited": false, "score": 0, "creation_date": 1486575396, "post_id": 42119551, "comment_id": 71408051, "body": "This one is simpler and will be used instead of my code, thanks!"}], "tags": [], "owner": {"reputation": 4621, "user_id": 4709298, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/fe41ea7cc395df33b3ad744599248d80?s=128&d=identicon&r=PG&f=1", "display_name": "Preston", "link": "https://stackoverflow.com/users/4709298/preston"}, "is_accepted": true, "score": 2, "last_activity_date": 1555405195, "last_edit_date": 1555405195, "creation_date": 1486574095, "answer_id": 42119551, "question_id": 42118824, "link": "https://stackoverflow.com/questions/42118824/vba-copy-paste-all-files-in-a-folder/42119551#42119551", "title": "VBA copy paste all files in a folder", "body": "<p>Your code won't work because as @user3598756 said, you spelled string incorrectly.  To improve your form though, use a do while loop to combine the if and do statements like so:</p>\n\n<pre><code>Function Copy()\n   Dim MyFile2 As String\n   Dim myPath2 As String, myPath3 As String\n\n   myPath2 = \"L:\\Host_Export\\Pdf-Kundenmail\\Test\\\"\n   myPath3 = \"L:\\Host_Export\\Pdf-Kundenmail\\\"\n   MyFile2 = Dir(myPath2 &amp; \"*.*\")\n   Do while MyFile2 &lt;&gt; \"\"\n        FileCopy myPath2 &amp; MyFile2, myPath3 &amp; MyFile2\n        myFile2 = Dir\n   Loop\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 75, "user_id": 7329697, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aa2826607270fcb64e9835e7c02a8399?s=128&d=identicon&r=PG&f=1", "display_name": "Patrick", "link": "https://stackoverflow.com/users/7329697/patrick"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 9196, "favorite_count": 2, "accepted_answer_id": 42119551, "answer_count": 2, "score": 4, "last_activity_date": 1555405195, "creation_date": 1486572072, "last_edit_date": 1486573707, "question_id": 42118824, "link": "https://stackoverflow.com/questions/42118824/vba-copy-paste-all-files-in-a-folder", "title": "VBA copy paste all files in a folder", "body": "<p>My macro is running well since 2 months but now I need some help for another issue.\nWe are running an controller on our server which is sending mails to our customer with attached pdf. Now this controller and my macro are running sometimes at the same time and when my macro is creating pdfs the controller wants to send it but is not able to do so because its already in creation.\nNow I thought the macro could save pdf into another folder and after that it will copy paste all files into the right folder for sending.</p>\n\n<p>My code is this:</p>\n\n<pre><code>Function Copy()\n\n   Dim MyFile2 As Sting\n   Dim myPath2 As String, myPath3 As String\n\n   myPath2 = \"L:\\Host_Export\\Pdf-Kundenmail\\Test\\\"\n   myPath3 = \"L:\\Host_Export\\Pdf-Kundenmail\\\"\n   MyFile2 = Dir(myPath2 &amp; \"*.*\")\n   Do\n        If MyFile2 = \"\" Then Exit Do\n        FileCopy myPath2 &amp; MyFile2, myPath3 &amp; MyFile2\n        End If\n        myFile2 = Dir\n    Loop\n\nEnd Function\n</code></pre>\n\n<p>But if I run it there is an error: <code>error on compilation  userdefined typ could not be defined.</code> like this: <a href=\"https://i0.wp.com/www.port135.com/wp-content/uploads/2012/08/error1-1.png\" rel=\"nofollow noreferrer\">https://i0.wp.com/www.port135.com/wp-content/uploads/2012/08/error1-1.png</a>.\nI alredy googled but don't get it how to set up or import something to fix this issue.</p>\n"}, {"tags": ["javascript", "html", "excel", "vba"], "comments": [{"owner": {"reputation": 10875, "user_id": 2392157, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/QEWAU.png?s=128&g=1", "display_name": "miroxlav", "link": "https://stackoverflow.com/users/2392157/miroxlav"}, "edited": false, "score": 0, "creation_date": 1486571820, "post_id": 42118624, "comment_id": 71405755, "body": "See <a href=\"http://stackoverflow.com/questions/15997550/dom-click-is-not-working-on-this-button\">this Q/A</a> for alternative approaches when click() is not working."}, {"owner": {"reputation": 3666, "user_id": 3433716, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/L65ah.jpg?s=128&g=1", "display_name": "nubteens", "link": "https://stackoverflow.com/users/3433716/nubteens"}, "reply_to_user": {"reputation": 10875, "user_id": 2392157, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/QEWAU.png?s=128&g=1", "display_name": "miroxlav", "link": "https://stackoverflow.com/users/2392157/miroxlav"}, "edited": false, "score": 0, "creation_date": 1486640934, "post_id": 42118624, "comment_id": 71437937, "body": "@miroxlav The link given does not seem to be excel-vba related"}, {"owner": {"reputation": 10875, "user_id": 2392157, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/QEWAU.png?s=128&g=1", "display_name": "miroxlav", "link": "https://stackoverflow.com/users/2392157/miroxlav"}, "edited": false, "score": 0, "creation_date": 1486641246, "post_id": 42118624, "comment_id": 71438131, "body": "Sure, but your question does not seem to address anything related to excel-vba. Based on its content, it should be re-tagged <code>html</code> + <code>javascript</code>. Perhaps you can check <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a> and improve the question."}, {"owner": {"reputation": 10875, "user_id": 2392157, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/QEWAU.png?s=128&g=1", "display_name": "miroxlav", "link": "https://stackoverflow.com/users/2392157/miroxlav"}, "edited": false, "score": 0, "creation_date": 1486641800, "post_id": 42118624, "comment_id": 71438486, "body": "Also do not forget to include part of your VBA code (this time as text, not image) where you are trying to perform the click action and errors you are getting."}], "owner": {"reputation": 3666, "user_id": 3433716, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/L65ah.jpg?s=128&g=1", "display_name": "nubteens", "link": "https://stackoverflow.com/users/3433716/nubteens"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 420, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1486737037, "creation_date": 1486571554, "last_edit_date": 1531164843, "question_id": 42118624, "link": "https://stackoverflow.com/questions/42118624/click-a-specific-li-tag-in-excel-vba", "title": "Click a specific &lt;li&gt; tag in Excel VBA", "body": "<p>I am accessing a website using VBA Excel and trying to access the third <code>&lt;li&gt;</code> which is in the <code>search_tab</code> class. How can I click this <code>&lt;li&gt;</code> tag using VBA Excel code?</p>\n\n<p><a href=\"https://i.stack.imgur.com/zBItX.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/zBItX.png\" alt=\"enter image description here\"></a></p>\n\n<p>I have already opened Internet Explorer as <code>IE</code> and tried to the code below but it is not working.</p>\n\n<pre><code>For Each l In IE.document.getElementsByTagName(\"a\")\n    If l.href = \"#SearchTab\" Then\n        l.Click\n        Exit For\n    End If\n    Next\n</code></pre>\n"}, {"tags": ["c++", "vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 151, "user_id": 7535172, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a97fab3e6fdd4a8304afc041194a641?s=128&d=identicon&r=PG", "display_name": "Tulio Carnelossi", "link": "https://stackoverflow.com/users/7535172/tulio-carnelossi"}, "edited": false, "score": 0, "creation_date": 1486575610, "post_id": 42118574, "comment_id": 71408171, "body": "Just tried it and it doesn&#39;t compile,any suggestions?"}], "tags": [], "owner": {"reputation": 164, "user_id": 2988309, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/480c1eeee8de1c80709c57d180eb89dd?s=128&d=identicon&r=PG&f=1", "display_name": "IR_IR", "link": "https://stackoverflow.com/users/2988309/ir-ir"}, "is_accepted": false, "score": 0, "last_activity_date": 1486571421, "creation_date": 1486571421, "answer_id": 42118574, "question_id": 42118272, "link": "https://stackoverflow.com/questions/42118272/pass-a-range-from-vba-to-c/42118574#42118574", "title": "Pass a Range from VBA to C++", "body": "<p>Did you try change </p>\n\n<blockquote>\n  <p>RangePtr</p>\n</blockquote>\n\n<p>to</p>\n\n<blockquote>\n  <p>Range</p>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 151, "user_id": 7535172, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a97fab3e6fdd4a8304afc041194a641?s=128&d=identicon&r=PG", "display_name": "Tulio Carnelossi", "link": "https://stackoverflow.com/users/7535172/tulio-carnelossi"}, "is_accepted": true, "score": 2, "last_activity_date": 1486639149, "last_edit_date": 1486639149, "creation_date": 1486603577, "answer_id": 42126680, "question_id": 42118272, "link": "https://stackoverflow.com/questions/42118272/pass-a-range-from-vba-to-c/42126680#42126680", "title": "Pass a Range from VBA to C++", "body": "<p>I'm not sure if this is exactly the same as the Excel::RangePtr but it works the same purposes, I'de appreciate some comments.</p>\n\n<pre><code>#include &lt;OAIdl.h&gt; // for VARIANT, BSTR etc\n\ndouble __stdcall RangeTest(VARIANT * x)\n{\n\nint cols = 0.0;\nint rows = 0.0;\n\nrows = x-&gt;parray[0].rgsabound[1].cElements;\ncols=x-&gt;parray[0].rgsabound[0].cElements;\n\nofstream outputFile(\"outputFile.txt\");\nlong c= 0;\n\nfor (int i = 0; i &lt; rows; i++)\n    {\n\n     for (int j = 0; j &lt; cols ;j++)\n       {\n\n         outputFile &lt;&lt; ((((tagVARIANT *)(*(x-&gt;parray)).pvData))[i + j*rows]).dblVal &lt;&lt; \" \";\n\n       }\n\n        outputFile &lt;&lt; endl;\n\n     }\n\nreturn 0;\n</code></pre>\n\n<p>}</p>\n"}], "owner": {"reputation": 151, "user_id": 7535172, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a97fab3e6fdd4a8304afc041194a641?s=128&d=identicon&r=PG", "display_name": "Tulio Carnelossi", "link": "https://stackoverflow.com/users/7535172/tulio-carnelossi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 569, "favorite_count": 0, "accepted_answer_id": 42126680, "answer_count": 2, "score": 1, "last_activity_date": 1578433004, "creation_date": 1486570601, "question_id": 42118272, "link": "https://stackoverflow.com/questions/42118272/pass-a-range-from-vba-to-c", "title": "Pass a Range from VBA to C++", "body": "<p>I'm trying to send a Range from a VBA to a VSTO c++ DLL. The code below works fine if I'm using Excel 2010 64 bits but I get an error when I use it for excel 2016, any one knows how to solve it?</p>\n\n<pre><code>#include &lt;fstream&gt;\n#include &lt;iostream&gt;\n#include \"ExcelImports.cpp\"\n#include &lt;vector&gt;\n\nusing namespace std;\nofstream outputFile(\"outputFile.txt\");\n\ndouble __stdcall RangeTest(Excel::RangePtr &amp;pRange, long N1, long N2 )\n{\nlong sum = 0;\n\nfor (int i = 1; i &lt;= N1; i++)\n{\n    for (int j = 1; j &lt;= N2; j++)\n    {\n\n        outputFile &lt;&lt; (((Excel::RangePtr)pRange-&gt;Item[i][j])-&gt;Value).dblVal &lt;&lt; \" \";\n\n\n    }\n\n    outputFile &lt;&lt; endl;\n\n}\n return 0;\n}\n</code></pre>\n\n<p>and the Other cpp file</p>\n\n<pre><code>#ifndef ExcelImports_cpp\n#define ExcelImports_cpp\n\n\n#import \"C:\\Program Files\\Common Files\\Microsoft Shared\\OFFICE14\\MSO.dll\" rename (\"DocumentProperties\",\"DocumentsPropertiesXL\") rename(\"RGB\",\"RGBXL\")\n#import \"C:\\Program Files\\Common Files\\Microsoft Shared\\VBA\\VBE6EXT.OLB\" \n#import \"C:\\Program Files\\Microsoft Office\\Office14\\EXCEL.EXE\" rename (\"DialogBox\",\"DialogBoxXL\") rename(\"RGB\",\"RGBXL\") rename (\"DocumentProperties\",\"DocumentsPropertiesXL\") rename (\"ReplaceText\",\"ReplaceTextXL\") rename (\"CopyFile\",\"CopyFileXL\") no_dual_interfaces\n\n\n#endif\n</code></pre>\n\n<p>the defFile</p>\n\n<pre><code>Library \"Teste\"\nEXPORTS\nRangeTest\n</code></pre>\n"}, {"tags": ["excel", "vba", "ms-access", "import"], "comments": [{"owner": {"reputation": 946, "user_id": 6352151, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-5g0ycA78c-M/AAAAAAAAAAI/AAAAAAAAB1o/uCIlaU9OmdY/photo.jpg?sz=128", "display_name": "Victor Moraes", "link": "https://stackoverflow.com/users/6352151/victor-moraes"}, "edited": false, "score": 0, "creation_date": 1486569823, "post_id": 42117495, "comment_id": 71404246, "body": "Have you seen <a href=\"https://support.microsoft.com/pt-br/help/3041386/-could-not-find-installable-isam-error-when-you-refresh-a-data-table-in-excel\" rel=\"nofollow noreferrer\">this article</a>?"}, {"owner": {"reputation": 129, "user_id": 2660513, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/c17fcf9b57cf4801e345d455093e001b?s=128&d=identicon&r=PG", "display_name": "Bj&#246;rnBogers", "link": "https://stackoverflow.com/users/2660513/bj%c3%b6rnbogers"}, "reply_to_user": {"reputation": 946, "user_id": 6352151, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-5g0ycA78c-M/AAAAAAAAAAI/AAAAAAAAB1o/uCIlaU9OmdY/photo.jpg?sz=128", "display_name": "Victor Moraes", "link": "https://stackoverflow.com/users/6352151/victor-moraes"}, "edited": false, "score": 0, "creation_date": 1486597495, "post_id": 42117495, "comment_id": 71419523, "body": "I don&#39;t have any connections listed in there"}, {"owner": {"reputation": 1077, "user_id": 6792573, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/CL1p0.jpg?s=128&g=1", "display_name": "mgae2m", "link": "https://stackoverflow.com/users/6792573/mgae2m"}, "edited": false, "score": 0, "creation_date": 1504190277, "post_id": 42117495, "comment_id": 78927914, "body": "I have your problem. If you reach solution, help me. my related question is in <a href=\"https://stackoverflow.com/questions/45968735/export-dbf-from-a-table-in-excel-with-consider-and-pay-attention-to-datatype-an\">Here</a>. Thanks. Seems guys not eager for this matter!"}], "owner": {"reputation": 129, "user_id": 2660513, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/c17fcf9b57cf4801e345d455093e001b?s=128&d=identicon&r=PG", "display_name": "Bj&#246;rnBogers", "link": "https://stackoverflow.com/users/2660513/bj%c3%b6rnbogers"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 281, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1513004376, "creation_date": 1486568552, "last_edit_date": 1592644375, "question_id": 42117495, "link": "https://stackoverflow.com/questions/42117495/could-not-find-installable-isam-when-importing-an-excel-file-into-an-access-db", "title": "Could not find installable ISAM when importing an Excel file into an Access db", "body": "<p>I'm currently trying to get the following code to work:</p>\n<pre><code>Dim s As Long: s = ActiveWorkbook.Worksheets(1).Cells(Rows.Count, &quot;A&quot;).End(xlUp).Row\nDim acc As Object\n  Set acc = CreateObject(&quot;Access.Application&quot;)\n  acc.Visible = True\n  acc.OpenCurrentDatabase Application.ActiveWorkbook.Path &amp; &quot;\\Database.accdb&quot;\n  acc.CurrentDb.Execute &quot;DELETE FROM Blad1;&quot;, 128 ' dbFailOnError = 128\n  acc.DoCmd.TransferSpreadsheet _\n        TransferType:=acImport, _\n        SpreadSheetType:=acspreadsheettypeexcel12xml, _\n        TableName:=&quot;Blad1&quot;, _\n        Filename:=Application.ActiveWorkbook.FullName, _\n        HasFieldNames:=True, _\n        Range:=&quot;Sheet1$A1:N&quot; &amp; s\n  acc.CloseCurrentDatabase\n  acc.Quit\n  Set acc = Nothing\n</code></pre>\n<p>I see that the line <code>acc.CurrentDb.Execute &quot;DELETE FROM Blad1;&quot;</code> is working fine since it deletes all the data in the table. Everything seems to run fine until <code>acc.DoCmd.TransferSpreadsheet</code>.</p>\n<p>Microsoft Access opens and the following error appears:\n<a href=\"https://i.stack.imgur.com/doPRk.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/doPRk.png\" alt=\"enter image description here\" /></a></p>\n<p>Which means as much as 'Error 3170: Could not find installable ISAM'</p>\n<p>I've been searching for an answer for quite a while now but I can't seem to find anything that really solves the problem. What do you guys think the solution is?</p>\n"}, {"tags": ["sql", "oracle", "vba", "odbc", "connection-string"], "comments": [{"owner": {"reputation": 38299, "user_id": 3027266, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3249486ec6096e443cb8e93489fe0a09?s=128&d=identicon&r=PG&f=1", "display_name": "Wernfried Domscheit", "link": "https://stackoverflow.com/users/3027266/wernfried-domscheit"}, "edited": false, "score": 1, "creation_date": 1486569282, "post_id": 42117399, "comment_id": 71403872, "body": "You must define the provider, e.g. <code>dbConn.provider = &quot;OraOLEDB.Oracle&quot;</code> in order to use it. Oracle Instant Client does not include any ODBC or OLE DB drivers, you have to install them separately."}, {"owner": {"reputation": 408, "user_id": 5653938, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/f7452e7c8f6cb73fe7be6b813977afed?s=128&d=identicon&r=PG&f=1", "display_name": "Kelaref", "link": "https://stackoverflow.com/users/5653938/kelaref"}, "reply_to_user": {"reputation": 38299, "user_id": 3027266, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3249486ec6096e443cb8e93489fe0a09?s=128&d=identicon&r=PG&f=1", "display_name": "Wernfried Domscheit", "link": "https://stackoverflow.com/users/3027266/wernfried-domscheit"}, "edited": false, "score": 0, "creation_date": 1486716111, "post_id": 42117399, "comment_id": 71475518, "body": "@WernfriedDomscheit Thank you for your reply! I added dbConn.provider = &quot;OraOLEDB.Oracle&quot; before opening the connection, the error now changed. The ODBC driver is also installed."}], "owner": {"reputation": 408, "user_id": 5653938, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/f7452e7c8f6cb73fe7be6b813977afed?s=128&d=identicon&r=PG&f=1", "display_name": "Kelaref", "link": "https://stackoverflow.com/users/5653938/kelaref"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1855, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1486719108, "creation_date": 1486568325, "last_edit_date": 1486719108, "question_id": 42117399, "link": "https://stackoverflow.com/questions/42117399/vba-adodb-connection-to-oracle", "title": "VBA ADODB connection to Oracle", "body": "<p>i am trying to connect to an Oracle database with ADODB.</p>\n\n<p>Following is my code: </p>\n\n<pre><code>Sub TestOracle()\n\nDim cs As String\nDim dbConn As Object, dbCMD As Object\n\nSet dbConn = CreateObject(\"ADODB.Connection\")\nSet dbCMD = CreateObject(\"ADODB.Command\")\n\ncs = \"SERVER=(DESCRIPTION=(ADDRESS=(PROTOCOL=TCP)(HOST=192.xxx.x.xx)(PORT=1521))\" &amp; _\n      \"(CONNECT_DATA=(SERVICE_NAME=MyOracleSID)));\" &amp; \";SERVER=dbserver\" &amp; _\n        \"uid=testing_bibi;pwd=testing;\"\n\ndbConn.ConnectionString = cs\ndbConn.Open\ndbCMD.ActiveConnection = dbConn\n\n'########################\ndbCMD.CommandText = \"CREATE TABLE streets(id INT, direction CHAR(1), A VARCHAR(255), B VARCHAR(255), d INT, PRIMARY KEY (id, direction));\"\ndbCMD.Execute\n\ndbConn.Close\nSet dbConn = Nothing\n\nEnd Sub\n</code></pre>\n\n<p>However i keep getting the following error:</p>\n\n<blockquote>\n  <p>[Microsoft][ODBC Driver Manager] Data source name not found and no\n  default driver specified</p>\n</blockquote>\n\n<p>I have oracle client installed, and the ODBC driver as well.</p>\n\n<p>After adding <code>dbConn.provider = \"OraOLEDB.Oracle\"</code> just before opening the connection, the error changed to:</p>\n\n<blockquote>\n  <p>ORA-12560: TNS: protocol adapter error</p>\n</blockquote>\n\n<p>I am hoping for minimal setup for later deployment.</p>\n\n<p>Thank you for any help.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1486568078, "post_id": 42117201, "comment_id": 71402983, "body": "what&#39;s your goal? do you want to copy/paste all filtered values or only filtered values in a certain row range?"}, {"owner": {"reputation": 5595, "user_id": 2832561, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/191d947cf1b55615499091bb17dd2961?s=128&d=identicon&r=PG&f=1", "display_name": "Blackhawk", "link": "https://stackoverflow.com/users/2832561/blackhawk"}, "edited": false, "score": 1, "creation_date": 1486568128, "post_id": 42117201, "comment_id": 71403027, "body": "First of all, rather than using &quot;.Select&quot; everywhere, use variables to build and store these ranges. Using select is a problem because if you click anywhere in Excel while the code is running, it throws everything off because you&#39;re changing the current selection."}, {"owner": {"reputation": 5595, "user_id": 2832561, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/191d947cf1b55615499091bb17dd2961?s=128&d=identicon&r=PG&f=1", "display_name": "Blackhawk", "link": "https://stackoverflow.com/users/2832561/blackhawk"}, "edited": false, "score": 0, "creation_date": 1486568151, "post_id": 42117201, "comment_id": 71403039, "body": "Second, what is &quot;Active.Workbook&quot;? It should be &quot;ActiveWorkbook&quot;."}, {"owner": {"reputation": 3, "user_id": 7535339, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/275165200681b3e82deb0b11dda93df3?s=128&d=identicon&r=PG&f=1", "display_name": "bagleyboy", "link": "https://stackoverflow.com/users/7535339/bagleyboy"}, "edited": false, "score": 0, "creation_date": 1486568358, "post_id": 42117201, "comment_id": 71403171, "body": "User3598756, I want to copy the filtered data from rows A to T into a template with the headings already in, so I don&#39;t want the headings from the sheet I&#39;m copying from."}, {"owner": {"reputation": 2910, "user_id": 1138898, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/739046acf09bc2a6f921f40694355e03?s=128&d=identicon&r=PG", "display_name": "The Bearded Llama", "link": "https://stackoverflow.com/users/1138898/the-bearded-llama"}, "edited": false, "score": 0, "creation_date": 1486570256, "post_id": 42117201, "comment_id": 71404569, "body": "<a href=\"http://stackoverflow.com/help/how-to-ask\">stackoverflow.com/help/how-to-ask</a>"}], "answers": [{"tags": [], "owner": {"reputation": 1097, "user_id": 5626959, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/a69e414eff81de3460cef89d2c97492f?s=128&d=identicon&r=PG&f=1", "display_name": "RyanL", "link": "https://stackoverflow.com/users/5626959/ryanl"}, "is_accepted": false, "score": 0, "last_activity_date": 1486568376, "creation_date": 1486568376, "answer_id": 42117412, "question_id": 42117201, "link": "https://stackoverflow.com/questions/42117201/cant-select-range/42117412#42117412", "title": "Can&#39;t select Range", "body": "<p>Your reference to the workbook \"Sample Chasers Template .xlsx\" is incorrect.  Try this:</p>\n\n<pre><code>ActiveSheet.Range(\"$A$1:$X$1647\").AutoFilter Field:=14, Criteria1:=\"-333\"\nActiveSheet.Range(\"$A$1:$X$1647\").AutoFilter Field:=17, Criteria1:= _\n    \"rslicenceHolder\"\n\n'Copy Results and Paste into Template\nRange(\"A1082:T1082\").Select\nRange(Selection, Selection.End(xlDown)).Select\nSelection.Copy\n'Active.Workbook(Sample Chasers Template .xlsx\").Activate\nWorkbooks(\"Sample Chasers Template .xlsx\").Activate\n\nSheets(\"RS Chasers\").Select\nRange(\"A4\").Select\nActiveSheet.Paste\n</code></pre>\n\n<p>I should mention though that you'll still be copying and pasting A1082:T1082 and down, regardless of where your filtered results actually are.  You may also want to substitute that piece for something like:</p>\n\n<pre><code>Range(\"A1:T1\").Select\nRange(Selection, Selection.End(xlDown)).Select\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 3, "user_id": 7535339, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/275165200681b3e82deb0b11dda93df3?s=128&d=identicon&r=PG&f=1", "display_name": "bagleyboy", "link": "https://stackoverflow.com/users/7535339/bagleyboy"}, "edited": false, "score": 0, "creation_date": 1486569329, "post_id": 42117456, "comment_id": 71403899, "body": "That works great, but now I&#39;m getting error 9 Subscript out of range, but it is copying it and progress is always good. At the moment I&#39;ve got both workbooks as the following: Dim wkb as Workbook and Dim tmp as Workbook"}, {"owner": {"reputation": 3, "user_id": 7535339, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/275165200681b3e82deb0b11dda93df3?s=128&d=identicon&r=PG&f=1", "display_name": "bagleyboy", "link": "https://stackoverflow.com/users/7535339/bagleyboy"}, "edited": false, "score": 0, "creation_date": 1486569388, "post_id": 42117456, "comment_id": 71403942, "body": "Set tmp = Workbooks.Open(Template.xlsx) and Set wkb = Workbooks.Open(Report.xlsx)"}, {"owner": {"reputation": 2478, "user_id": 6110371, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/O93Qp.jpg?s=128&g=1", "display_name": "VBA Pete", "link": "https://stackoverflow.com/users/6110371/vba-pete"}, "edited": false, "score": 0, "creation_date": 1486570577, "post_id": 42117456, "comment_id": 71404816, "body": "You need to include the full path and quotation marks e.g. <code>Set tmp = Workbooks.Open(&quot;C:\\Desktop\\Template.xlsx&quot;)</code>"}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "reply_to_user": {"reputation": 3, "user_id": 7535339, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/275165200681b3e82deb0b11dda93df3?s=128&d=identicon&r=PG&f=1", "display_name": "bagleyboy", "link": "https://stackoverflow.com/users/7535339/bagleyboy"}, "edited": false, "score": 0, "creation_date": 1486573276, "post_id": 42117456, "comment_id": 71406787, "body": "@bagleyboy, see edited answer to match your actual workbooks names. You just need to change their paths (currently &quot;C\\Desktop\\&quot;) to their actual ones. If this solved your question please mark answer as accepted thank you."}], "tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": false, "score": 0, "last_activity_date": 1486574735, "last_edit_date": 1486574735, "creation_date": 1486568470, "answer_id": 42117456, "question_id": 42117201, "link": "https://stackoverflow.com/questions/42117201/cant-select-range/42117456#42117456", "title": "Can&#39;t select Range", "body": "<p><strong>edited</strong> to include actual workbook names as specified by OP</p>\n\n<p>assuming you want to copy/paste all columns A to T filtered cells excluding headers:</p>\n\n<pre><code>Dim repWB as Workbook, tempWb as Workbook \n\nSet tempWb = Workbooks.Open(\"C:\\Desktop\\Template.xlsx\") '&lt;--| change \"C:\\Desktop\\\" to actual path of template workbook\nSet repWB = Workbooks.Open(\"C:\\Desktop\\Report.xlsx\") '&lt;--| change \"C:\\Desktop\\\" to actual path of report workbook\nWith repWB.Range(\"$A$1:$X$1647\")\n    .AutoFilter Field:=14, Criteria1:=\"-333\"\n    .AutoFilter Field:=17, Criteria1:=\"rslicenceHolder\"\n    If Application.WorksheetFunction.Subtotal(103, .Cells) &gt; 1 Then .Resize(.Rows.count - 1, 20).Offset(1).SpecialCells(xlCellTypeVisible).Copy             tempWb.Sheets(\"RS Chasers\").Range(\"A4\")\n    .Parent.AutoFilterMode = False\nEnd With\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 3, "user_id": 7535339, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/275165200681b3e82deb0b11dda93df3?s=128&d=identicon&r=PG&f=1", "display_name": "bagleyboy", "link": "https://stackoverflow.com/users/7535339/bagleyboy"}, "edited": false, "score": 0, "creation_date": 1486572599, "post_id": 42117656, "comment_id": 71406297, "body": "Thank you! This works like a charm, must always remember to use Dim&#39;s for ranges."}], "tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": false, "score": 2, "last_activity_date": 1486570345, "last_edit_date": 1486570345, "creation_date": 1486568966, "answer_id": 42117656, "question_id": 42117201, "link": "https://stackoverflow.com/questions/42117201/cant-select-range/42117656#42117656", "title": "Can&#39;t select Range", "body": "<p>The code below will copy the Filtered table from your sheet to \"RS Chasers\" sheet in \"Sample Chasers Template .xlsx\" workbook.</p>\n\n<p><strong>Note</strong>: try to avoid using <code>ActiveSheet</code>, <code>Select</code> and <code>Selection</code> and use fully qualified objects instead.</p>\n\n<p><strong>Code</strong></p>\n\n<pre><code>Option Explicit\n\nSub CopyFilterData()\n\nDim Rng As Range, VisRng As Range\n\nWith Worksheets(\"Sheet1\") '&lt;-- modify \"Sheet1\" to your sheet's name\n    Set Rng = .Range(\"$A$1:$X$1647\") ' &lt;-- better use referenced sheet than ActiveSheet\n\n    Rng.AutoFilter Field:=14, Criteria1:=\"-333\"\n    Rng.AutoFilter Field:=17, Criteria1:=\"rslicenceHolder\"\n\n    Set VisRng = Rng.Resize(Rng.Columns(17).SpecialCells(xlCellTypeVisible).Cells.Count, 20).Offset(1, 0) '&lt;-- set visible Range to filtered range\n\n    VisRng.Copy Destination:=Workbooks(\"Chasers Template.xlsx\").Worksheets(\"RS Chasers\").Range(\"A4\")   '&lt;-- copy &gt;&gt; paste in 1 line\nEnd With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 7535339, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/275165200681b3e82deb0b11dda93df3?s=128&d=identicon&r=PG&f=1", "display_name": "bagleyboy", "link": "https://stackoverflow.com/users/7535339/bagleyboy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 959, "favorite_count": 0, "answer_count": 3, "score": -1, "last_activity_date": 1487440361, "creation_date": 1486567822, "last_edit_date": 1487440361, "question_id": 42117201, "link": "https://stackoverflow.com/questions/42117201/cant-select-range", "title": "Can&#39;t select Range", "body": "<p>I'm creating a VBA macro to pull a filtered range of data into a template. I keep getting the Range not Defined error.</p>\n\n<p>I've tried using the Macro Recording tool in Excel but when I try and use it with my written code, it breaks instantly.</p>\n\n<pre><code>'filter to correct range\nActiveSheet.Range(\"$A$1:$X$1647\").AutoFilter Field:=14, Criteria1:=\"-333\"\nActiveSheet.Range(\"$A$1:$X$1647\").AutoFilter Field:=17, Criteria1:= _\n    \"rslicenceHolder\"\n\n'Copy Results and Paste into Template\nRange(\"A1082:T1082\").Select\nRange(Selection, Selection.End(xlDown)).Select\nSelection.Copy\nActive.Workbook(\"Sample Chasers Template .xlsx\").Activate\nSheets(\"RS Chasers\").Select\nRange(\"A4\").Select\nActiveSheet.Paste\n</code></pre>\n"}, {"tags": ["vba", "ms-access", "parameters", "ms-access-2016"], "comments": [{"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "edited": false, "score": 1, "creation_date": 1486568522, "post_id": 42117017, "comment_id": 71403302, "body": "It is <code>Set rst = qdf.OpenRecordset()</code> as @Tom points out."}, {"owner": {"reputation": 1445, "user_id": 6065909, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/59936064c95a62d283737b9e18ad95ae?s=128&d=identicon&r=PG&f=1", "display_name": "marlan", "link": "https://stackoverflow.com/users/6065909/marlan"}, "edited": false, "score": 0, "creation_date": 1486571302, "post_id": 42117017, "comment_id": 71405366, "body": "&#39;Too few parameters&#39; error points out the query expect a parameter it did not receive. I suggest you post the SQL, that&#39;s where the parameter is expected..."}, {"owner": {"reputation": 313, "user_id": 7389351, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/2be6ee1749a4062fbf23192232a4095c?s=128&d=identicon&r=PG&f=1", "display_name": "user7389351", "link": "https://stackoverflow.com/users/7389351/user7389351"}, "reply_to_user": {"reputation": 1445, "user_id": 6065909, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/59936064c95a62d283737b9e18ad95ae?s=128&d=identicon&r=PG&f=1", "display_name": "marlan", "link": "https://stackoverflow.com/users/6065909/marlan"}, "edited": false, "score": 0, "creation_date": 1486747262, "post_id": 42117017, "comment_id": 71495083, "body": "@marlan added the SQL"}, {"owner": {"reputation": 1445, "user_id": 6065909, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/59936064c95a62d283737b9e18ad95ae?s=128&d=identicon&r=PG&f=1", "display_name": "marlan", "link": "https://stackoverflow.com/users/6065909/marlan"}, "edited": false, "score": 0, "creation_date": 1486849397, "post_id": 42117017, "comment_id": 71525890, "body": "Assuming all the fields  in <code>tbl_FilmZipInfo</code> are actually there, and correctly spelled, make sure <code>frm_FilmZip</code> is loaded, and that field <code>Text314</code> is correctly spelled, and has a value."}], "answers": [{"comments": [{"owner": {"reputation": 313, "user_id": 7389351, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/2be6ee1749a4062fbf23192232a4095c?s=128&d=identicon&r=PG&f=1", "display_name": "user7389351", "link": "https://stackoverflow.com/users/7389351/user7389351"}, "edited": false, "score": 0, "creation_date": 1486568399, "post_id": 42117093, "comment_id": 71403211, "body": "The saved query I&#39;m using doesn&#39;t prompt for a parameter. For one of the fields I grab a value from a form by using the &quot;Cirteria&quot; field (in Design View). Is that the same thing as a parameter?"}, {"owner": {"reputation": 1445, "user_id": 6065909, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/59936064c95a62d283737b9e18ad95ae?s=128&d=identicon&r=PG&f=1", "display_name": "marlan", "link": "https://stackoverflow.com/users/6065909/marlan"}, "edited": false, "score": 0, "creation_date": 1486571137, "post_id": 42117093, "comment_id": 71405235, "body": "If the query can&#39;t access the value from the form, it will treat the field as a parameter. Is this form loaded? is the value where in should be?"}], "tags": [], "owner": {"reputation": 4621, "user_id": 4709298, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/fe41ea7cc395df33b3ad744599248d80?s=128&d=identicon&r=PG&f=1", "display_name": "Preston", "link": "https://stackoverflow.com/users/4709298/preston"}, "is_accepted": false, "score": 2, "last_activity_date": 1486567849, "last_edit_date": 1486567849, "creation_date": 1486567502, "answer_id": 42117093, "question_id": 42117017, "link": "https://stackoverflow.com/questions/42117017/too-few-parameters-error-when-trying-to-open-a-recordset-in-access-with-vba/42117093#42117093", "title": "&quot;Too few parameters error&quot; when trying to open a recordset in Access with VBA", "body": "<p>Source: <a href=\"https://msdn.microsoft.com/en-us/library/office/ff820966.aspx\" rel=\"nofollow noreferrer\">https://msdn.microsoft.com/en-us/library/office/ff820966.aspx</a></p>\n\n<p>The only required argument here is the name of the recordset that you want to open.  </p>\n\n<blockquote>\n  <p>expression .OpenRecordset(Name, Type, Options, LockEdit)</p>\n</blockquote>\n\n<p>In a parameter query like yours, you need to use the following syntax:</p>\n\n<pre><code>Dim dbs As DAO.Database\nDim qdf As DAO.QueryDef 'You don't dim your qdf\nDim rst As DAO.Recordset\n\nSet dbs = CurrentDb\n\n'Get the parameter query\nSet qfd = dbs.QueryDefs(\"qryMyParameterQuery\")\n\n'Supply the parameter value\nqdf.Parameters(\"EnterStartDate\") = Date\nqdf.Parameters(\"EnterEndDate\") = Date + 7\n\n'Open a Recordset based on the parameter query\nSet rst = qdf.OpenRecordset() 'Note the brackets here\n</code></pre>\n\n<p>You could also try the following type here:</p>\n\n<pre><code>Dim dbs As DAO.Database\nDim rsTable As DAO.Recordset\nDim rsQuery As DAO.Recordset\n\nSet dbs = CurrentDb\n\n'Open a table-type Recordset\nSet rsTable = dbs.OpenRecordset(\"Table1\", dbOpenTable)\n\n'Open a dynaset-type Recordset using a saved query\nSet rsQuery = dbs.OpenRecordset(\"qryMyQuery\", dbOpenDynaset)\n</code></pre>\n"}], "owner": {"reputation": 313, "user_id": 7389351, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/2be6ee1749a4062fbf23192232a4095c?s=128&d=identicon&r=PG&f=1", "display_name": "user7389351", "link": "https://stackoverflow.com/users/7389351/user7389351"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2321, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1486747238, "creation_date": 1486567248, "last_edit_date": 1495541335, "question_id": 42117017, "link": "https://stackoverflow.com/questions/42117017/too-few-parameters-error-when-trying-to-open-a-recordset-in-access-with-vba", "title": "&quot;Too few parameters error&quot; when trying to open a recordset in Access with VBA", "body": "<p>I found <a href=\"https://stackoverflow.com/questions/5445062/run-time-error-3061-too-few-parameters-expected-1-access-2007#\">another answer on here</a> that addressed this but it didn't help me. I checked the query I am trying to reference and I don't see a problem with any field. I also played around with how I declared and set the objects and stuff but that didn't work either.</p>\n\n<pre><code>Dim dbsCurrent As DAO.Database\nDim rst As DAO.Recordset\n\nSet dbsCurrent = CurrentDb\nSet qdf = CurrentDb.QueryDefs(\"qry_FilmZip\")\nSet rst = qdf.OpenRecordset 'The error points to this line\n\nrad_full = rst!radius_full\n\nMsgBox (\"rad_full:\" + rad_full)\n</code></pre>\n\n<hr>\n\n<p><strong>Update:</strong> I tried giving the .OpenRecordSet method the name of the query like this: <code>Set rst = qdf.OpenRecordset(\"qry_FilmZip\")</code></p>\n\n<p>...but now it gives me a new error: <code>Run-time error 3421: Data type conversion error</code>. Anyone know what is going on? The error points to the same line.</p>\n\n<p>I found out how to resolve the 2nd error. It turns out that I had to do</p>\n\n<pre><code>For Each prm In qdf.Parameters\n    prm.Value = Eval(prm.Name)\nNext prm\n</code></pre>\n\n<p>...but I don't understand what this is really doing. Could someone enlighten me?</p>\n\n<p>The SQL:</p>\n\n<pre><code>SELECT \n\n  tbl_FilmZipInfo.ID, \n  tbl_FilmZipInfo.item, \n  tbl_FilmZipInfo.qty_per_unit, \n  tbl_FilmZipInfo.unit_of_measure, \n  tbl_FilmZipInfo.radius_core, \n  tbl_FilmZipInfo.radius_full, \n  tbl_FilmZipInfo.Lf_value_for_zipper, \n  tbl_FilmZipInfo.S_value_for_zipper, \n  tbl_FilmZipInfo.film_or_zip, \n  tbl_FilmZipInfo.Comments, \n  tbl_FilmZipInfo.physical_description\n\nFROM \n\n  tbl_FilmZipInfo\n\nWHERE \n\n  (((tbl_FilmZipInfo.item)=[Forms]![frm_FilmZip]![Text314]));\n</code></pre>\n"}, {"tags": ["vba", "ms-access"], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 7535270, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6d1408cdb8c059b03324574ce180265?s=128&d=identicon&r=PG&f=1", "display_name": "Leecey5225", "link": "https://stackoverflow.com/users/7535270/leecey5225"}, "edited": false, "score": 0, "creation_date": 1486718973, "post_id": 42117226, "comment_id": 71477193, "body": "That&#39;s worked a treat thanks.  Could you tell me what the &#39;Me.&#39; signifies please (as you can tell I&#39;m a complete beginner!)"}, {"owner": {"reputation": 1097, "user_id": 5626959, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/a69e414eff81de3460cef89d2c97492f?s=128&d=identicon&r=PG&f=1", "display_name": "RyanL", "link": "https://stackoverflow.com/users/5626959/ryanl"}, "reply_to_user": {"reputation": 11, "user_id": 7535270, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6d1408cdb8c059b03324574ce180265?s=128&d=identicon&r=PG&f=1", "display_name": "Leecey5225", "link": "https://stackoverflow.com/users/7535270/leecey5225"}, "edited": false, "score": 0, "creation_date": 1486733494, "post_id": 42117226, "comment_id": 71486203, "body": "@Leecey5225, in this instance &quot;me&quot; refers to the form that has focus and is currently running code.  You can use either the form name that contains the button &#39;TierCalc&#39; or &#39;me&#39; in this scenario -- me acts like an implicitly declared variable."}], "tags": [], "owner": {"reputation": 1097, "user_id": 5626959, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/a69e414eff81de3460cef89d2c97492f?s=128&d=identicon&r=PG&f=1", "display_name": "RyanL", "link": "https://stackoverflow.com/users/5626959/ryanl"}, "is_accepted": false, "score": 0, "last_activity_date": 1486567899, "creation_date": 1486567899, "answer_id": 42117226, "question_id": 42116952, "link": "https://stackoverflow.com/questions/42116952/runtime-424-object-required-in-access-2013/42117226#42117226", "title": "Runtime 424 - Object Required in Access 2013", "body": "<p>Try this:</p>\n\n<pre><code>Private Sub TierCalc_Click()\nDim lastStageValue As Integer\n\nIf Not IsNull(Me.CP6Sum) Then\n    lastStageValue = CP6Sum.value\nEnd If\n\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 7535270, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6d1408cdb8c059b03324574ce180265?s=128&d=identicon&r=PG&f=1", "display_name": "Leecey5225", "link": "https://stackoverflow.com/users/7535270/leecey5225"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 449, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1593956651, "creation_date": 1486567059, "last_edit_date": 1593956651, "question_id": 42116952, "link": "https://stackoverflow.com/questions/42116952/runtime-424-object-required-in-access-2013", "title": "Runtime 424 - Object Required in Access 2013", "body": "<p>I am trying to cycle through a set of Access form fields in order to identify last value and then build a calculation around it.  The code for the first line is as below:</p>\n\n<pre><code>Private Sub TierCalc_Click()\n\nDim lastStageValue As Integer\n\n    If (CP6Sum.Value Is Not Null) Then\n        lastStageValue = CP6Sum.Value\n    End If\n\n\nEnd Sub\n</code></pre>\n\n<p>When I run this, I get the above '424 Runtime Object required' error.\nIf I take out the '.Value' in the code as suggested by other sites it stays the same.\nIf I declare the field (i.e. 'Dim CP6Sum As Integer') I get 'Invalid Qualifier' and if I then take the '.value' out I get 'Type Mismatch' error??</p>\n\n<p>Any ideas please?\nThanks,\nLisa</p>\n"}, {"tags": ["vba", "ms-word", "word-field"], "answers": [{"comments": [{"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 0, "creation_date": 1486719866, "post_id": 42144625, "comment_id": 71477679, "body": "Thx, I&#39;d saw this but I was looking for a simpler solution!^^ I tried around <code>{ = {DocProperty theDate \\@ &quot;dddd&quot; } + 1 }</code> which doesn&#39;t work, though <code>{ = {DocProperty theDate \\@ &quot;dd&quot; } + 1 }</code> works (too bad). Finally, I got my hands dirty with Charles Kenyon&#39;s head spinner, and got it working! I&#39;ll post an answer later explaining it! (Btw, the regional settings impact that too... T_T I&#39;ve got french settings at work and add to change <code>,</code> to <code>;</code> in formulas | as well as <code>.</code> to <code>,</code> for decimal separator!"}, {"owner": {"reputation": 401, "user_id": 14133995, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7U2p9.png?s=128&g=1", "display_name": "Charles Kenyon", "link": "https://stackoverflow.com/users/14133995/charles-kenyon"}, "edited": false, "score": 0, "creation_date": 1609704086, "post_id": 42144625, "comment_id": 115899952, "body": "If you are sticking to field codes, there is NO SIMPLE METHOD. This is due primarily to the Gregorian Calendar and the vanity of certain Roman emperors. The calendar is illogical. I have ceded this area to Paul Edstein. Here is his tutorial: <a href=\"http://www.msofficeforums.com/word/38719-microsoft-word-date-calculation-tutorial.html\" rel=\"nofollow noreferrer\">msofficeforums.com/word/&hellip;</a> -- If you use this, be sure to read the introductory material."}, {"owner": {"reputation": 401, "user_id": 14133995, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7U2p9.png?s=128&g=1", "display_name": "Charles Kenyon", "link": "https://stackoverflow.com/users/14133995/charles-kenyon"}, "edited": false, "score": 0, "creation_date": 1609704562, "post_id": 42144625, "comment_id": 115900114, "body": "Also useful is Graham Mayor&#39;s handy Add-In to translate field codes to/from text. I think it may be based on Cindy Meister&#39;s work. <a href=\"http://www.gmayor.com/export_field.htm\" rel=\"nofollow noreferrer\">gmayor.com/export_field.htm</a> -- He also has work on future dates: <a href=\"http://www.gmayor.com/FutureDateAddIn.htm\" rel=\"nofollow noreferrer\">gmayor.com/FutureDateAddIn.htm</a>"}], "tags": [], "owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "is_accepted": true, "score": 2, "last_activity_date": 1486732292, "last_edit_date": 1486732292, "creation_date": 1486666124, "answer_id": 42144625, "question_id": 42116944, "link": "https://stackoverflow.com/questions/42116944/get-the-next-day-from-the-date-in-the-custom-document-property/42144625#42144625", "title": "Get the next day, from the date in the Custom Document Property", "body": "<p>Charles Kenyon has spent some time gather up the work of many people and made it available on his website: <a href=\"http://www.addbalance.com/word/datefields2.htm\" rel=\"nofollow noreferrer\">http://www.addbalance.com/word/datefields2.htm</a></p>\n\n<p>The underlying trick for calculating with dates is to break them down into day, month and year, which you're attempting, but using the VBA approach that doesn't work in Word fields. Indeed, Word has no \"smarts\" whatsoever when it comes to date calculation - you have to do it all. So, simple example:</p>\n\n<pre><code>theDate + 1 = { DocProperty theDate \\@ \"MMMM\" } { = {DocProperty theDate \\@ \"dd\" } + 1 }, { DocProperty theDate \\@ \"yyyy\" }\n</code></pre>\n\n<p>This is fine, until you hit the last day of the month. And then you have to consider what to do if it's the last day of the year... </p>\n\n<hr>\n\n<p>This is very complex, so I'm just going to copy the information from Charles's site:</p>\n\n<hr>\n\n<p>Here's a head-spinner! What follows is a field that gives you the date two weeks from the day a document is created, in regular written English format:</p>\n\n<ul>\n<li>Creation date: July 9, 2015 - desired field result = July 23, 2015 </li>\n<li>Creation date: July 23, 2014 - desired field result = August 6, 2014 </li>\n<li>Creation date: December 20, 2014 - desired field result = January 3,\n2015  </li>\n<li>Creation date: February 27, 2015 - desired field result = March\n12, 2015  </li>\n<li><p>Creation date: February 27, 2016 - desired field date\nresult = March 13, 2016</p>\n\n<p>{ QUOTE \"{ SET \" Delay\" \"14\"  }\n{  SET \"DaysInMonth\" { IF  { CreateDate \\@ \"MM\" }    &lt;> 2<br>\n {  = ROUND(30.575*{ CreateDate \\@ \"MM\" },0)-\n ROUND(30.575*{ =  { CreateDate \\@ \"MM\" }  -1 },0)  }\n{  IF  {  = MOD( { CreateDate \\@\"yy\" } , 4 ) }  > 0 \"28\" \"29\" } } }\n {  SET \"NextMonth\" {  IF {  CreateDate \\@ \"MM\" }   = 12 \"1/97\" \n \"{ = {  CreateDate \\@ \"MM\" }  + 1 }/97 }  }\n {  IF  {   = {  REF \"Delay\" }  + { CreateDate \\@ \"dd\" }   }  &lt;=  { REF\"DaysInMonth\" }\n { CreateDate \\@ \"MMMM { =  {  REF \"Delay\"  }    + { CreateDate \\@ \"dd\" }   }, yyyy\"}{  QUOTE  { NextMonth \\@ \"MMMM\" } \n { =  { REF \"Delay\" }    + { CreateDate \\@ \"dd\" }  -  { REF\"DaysInMonth\" }   }, \n {  IF { CreateDate \\@ \"MM\" }    &lt;> 12 { CreateDate \\@ \"yyyy\"  }\n { CreateDate \\@ \"{  = 1 +  { CreateDate \\@ \"yyyy\" }    # \"xxxx\"  }\"  } } } }\"  }  </p></li>\n</ul>\n\n<p><em>The colors in the sample field above (below in image!) represent my attempt to match field delimiters and show nesting of fields. Line breaks have been added for clarity and should not be a part of the actual field. I added these modifications help illustrate what the field looks like. Those fields shown in green contain no nested fields but may contain references to bookmark values set by other fields.</em></p>\n\n<p><a href=\"https://i.stack.imgur.com/NP7M4.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/NP7M4.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 506, "favorite_count": 1, "accepted_answer_id": 42144625, "answer_count": 1, "score": 1, "last_activity_date": 1609692818, "creation_date": 1486567021, "last_edit_date": 1609692818, "question_id": 42116944, "link": "https://stackoverflow.com/questions/42116944/get-the-next-day-from-the-date-in-the-custom-document-property", "title": "Get the next day, from the date in the Custom Document Property", "body": "<p>I have Custom Document Properties (defined as date) containing dates.</p>\n<p>I'm trying to get the next day, from the date in the Custom Document Property (Date Field).</p>\n<pre><code>{={  DOCPROPERTY  DateFieldTest  }+1 \\@&quot;d MMMM YYYY&quot;}\n'toggle DOCPROPERTY Field\n{=07/04/2016+1 \\@&quot;d MMMM YYYY&quot;}\n'toggle calculation field\n1\n</code></pre>\n<p>I also tried:</p>\n<pre><code>{=DATE(YEAR({  DOCPROPERTY  DateFieldTest  }),MONTH({  DOCPROPERTY  DateFieldTest  }),DAY({  DOCPROPERTY  DateFieldTest  })+1) \\@&quot;d MMMM YYYY&quot;}\n'toggle DOCPROPERTY Field\n{=DATE(YEAR(07/04/2016),MONTH(07/04/2016),DAY(07/04/2016)+1) \\@&quot;d MMMM YYYY&quot;}\n'toggle calculation field\n!Syntaxe Error, (\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1486566999, "post_id": 42116810, "comment_id": 71402269, "body": "What does the cell value look like? Is it this part, <code>027616716927</code>? Also, check out <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba-macros\">how to avoid using <code>.Select</code>/<code>.Activate</code></a>, and try and use the data directly."}, {"owner": {"reputation": 11, "user_id": 2800313, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3de7d230ce6b1180aa01b8c3aa291564?s=128&d=identicon&r=PG&f=1", "display_name": "vikgoy", "link": "https://stackoverflow.com/users/2800313/vikgoy"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1486567516, "post_id": 42116810, "comment_id": 71402625, "body": "Hello the cell value is <a href=\"http://upctoasin.com/027616716927\" rel=\"nofollow noreferrer\">upctoasin.com/027616716927</a> (with the http), will read up on the select activate also."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 2800313, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3de7d230ce6b1180aa01b8c3aa291564?s=128&d=identicon&r=PG&f=1", "display_name": "vikgoy", "link": "https://stackoverflow.com/users/2800313/vikgoy"}, "edited": false, "score": 0, "creation_date": 1486653594, "post_id": 42119074, "comment_id": 71446987, "body": "This is working flawlessly thank you! Is there a way of it working out the size of the range itself based on the number of records without a gap?"}, {"owner": {"reputation": 11381, "user_id": 2859347, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/00bC9.png?s=128&g=1", "display_name": "CallumDA", "link": "https://stackoverflow.com/users/2859347/callumda"}, "reply_to_user": {"reputation": 11, "user_id": 2800313, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3de7d230ce6b1180aa01b8c3aa291564?s=128&d=identicon&r=PG&f=1", "display_name": "vikgoy", "link": "https://stackoverflow.com/users/2800313/vikgoy"}, "edited": false, "score": 0, "creation_date": 1486654220, "post_id": 42119074, "comment_id": 71447497, "body": "Happy to help :). I&#39;ve updated my answer for your comment/ question. If you find this answers your question please <i>accept</i> by clicking the green tick mark to the left of this answer"}], "tags": [], "owner": {"reputation": 11381, "user_id": 2859347, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/00bC9.png?s=128&g=1", "display_name": "CallumDA", "link": "https://stackoverflow.com/users/2859347/callumda"}, "is_accepted": false, "score": 0, "last_activity_date": 1486654109, "last_edit_date": 1486654109, "creation_date": 1486572723, "answer_id": 42119074, "question_id": 42116810, "link": "https://stackoverflow.com/questions/42116810/vba-open-workbook-from-current-cells-value/42119074#42119074", "title": "VBA Open workbook from current cells value", "body": "<p>I put the link you gave us in rows <code>A1:A10</code> and ran the following code to get loop through each cell and place the value from the link in the cell to it's right. </p>\n\n<p><em>I also tested it with 1000 links and it completed in 279 seconds -- so roughly 4 per second. I'd be interested to see if anyone has a quicker method.</em> </p>\n\n<pre><code>Sub GETASINV2()\n    Application.ScreenUpdating = False\n\n    Dim sht As Worksheet\n    Set sht = ThisWorkbook.Worksheets(\"Sheet1\") 'update for your worksheet name\n\n    Dim inputRange As Range, r As Range\n    Set inputRange = sht.Range(\"A1:A10\") 'update for your range\n\n    For Each r In inputRange\n        With sht.QueryTables.Add(Connection:= _\n            \"URL;\" &amp; r.Value, Destination:=r.Offset(0, 1))\n            .Refresh BackgroundQuery:=False\n            .Delete\n        End With\n    Next r\n\n    Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n\n<p><hr/><strong>Update</strong></p>\n\n<blockquote>\n  <p>Is there a way of it working out the size of the range itself based on the number of records without a gap?</p>\n</blockquote>\n\n<p>Yes, you can replace this:</p>\n\n<pre><code>Set inputRange = sht.Range(\"A1:A10\") \n</code></pre>\n\n<p>With the following: </p>\n\n<pre><code>Set inputRange = Range(sht.Range(\"A1\"), sht.Range(\"A1\").End(xlDown))\n</code></pre>\n\n<p>Where <code>A1</code> is the location of your first link</p>\n"}], "owner": {"reputation": 11, "user_id": 2800313, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3de7d230ce6b1180aa01b8c3aa291564?s=128&d=identicon&r=PG&f=1", "display_name": "vikgoy", "link": "https://stackoverflow.com/users/2800313/vikgoy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 798, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1486654109, "creation_date": 1486566669, "last_edit_date": 1531161705, "question_id": 42116810, "link": "https://stackoverflow.com/questions/42116810/vba-open-workbook-from-current-cells-value", "title": "VBA Open workbook from current cells value", "body": "<p>Hi I have a spreadsheet which I want to use the current cells value to open the url specified there and enter into the column next to it. The URL only contains one set of characters. I tried recording with relative references turned on and got the following:</p>\n\n<pre><code>Sub GETASINV2()\n'\n' GETASINV2 Macro\n'\n\n'\n    Selection.Copy\n    Application.CutCopyMode = False\n    Workbooks.OpenText Filename:=\"http://upctoasin.com/027616716927\", Origin:= _\n        xlMSDOS, StartRow:=1, DataType:=xlDelimited, TextQualifier:=xlDoubleQuote _\n        , ConsecutiveDelimiter:=False, Tab:=True, Semicolon:=False, Comma:= _\n        False, Space:=False, Other:=False, FieldInfo:=Array(1, 1), _\n        TrailingMinusNumbers:=True\n    Selection.Copy\n    ActiveWindow.ActivateNext\n    ActiveCell.Offset(0, 1).Range(\"A1\").Select\n    ActiveSheet.Paste\n    ActiveCell.Offset(1, -1).Range(\"A1\").Select\nEnd Sub\n</code></pre>\n\n<p>As you can see it all seems to be relative apart from the filename where it has picked up the value I entered and not the fact that I \"copy pasted the value\". </p>\n\n<p>Once this is done I want to repeat for the remaining list of urls (around 3000). I can probably find someway of repeating till no more URLS exist but if you know a way would be glad to get help on this part also!</p>\n\n<p>Thank you</p>\n"}, {"tags": ["vba", "excel", "directory"], "comments": [{"owner": {"reputation": 878, "user_id": 7321366, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/8168d183e450bbb72f0c3341c847af5c?s=128&d=identicon&r=PG&f=1", "display_name": "pokemon_Man", "link": "https://stackoverflow.com/users/7321366/pokemon-man"}, "edited": false, "score": 0, "creation_date": 1486566665, "post_id": 42116735, "comment_id": 71401998, "body": "can you put debug.print(folderLevel) after folderLevel = folderLevel &amp; &quot;\\&quot; to see what that value is?"}, {"owner": {"reputation": 1574, "user_id": 6304906, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/783a08c5d7a3ca42d6fb007774a49f45?s=128&d=identicon&r=PG&f=1", "display_name": "Barney", "link": "https://stackoverflow.com/users/6304906/barney"}, "edited": false, "score": 0, "creation_date": 1486567220, "post_id": 42116735, "comment_id": 71402401, "body": "<code>Path</code> is an Excel VBA built-in method, did you not get any error for the <code>Path</code> variable declaration?"}, {"owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "reply_to_user": {"reputation": 1574, "user_id": 6304906, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/783a08c5d7a3ca42d6fb007774a49f45?s=128&d=identicon&r=PG&f=1", "display_name": "Barney", "link": "https://stackoverflow.com/users/6304906/barney"}, "edited": false, "score": 0, "creation_date": 1486568051, "post_id": 42116735, "comment_id": 71402969, "body": "@Barney <code>Path</code> is built in property for few objects but not a built in method in Excel-VBA. Nonetheless not a very good choice as variable name."}, {"owner": {"reputation": 53, "user_id": 7442059, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/d61838d166a956d252e403714f55bc13?s=128&d=identicon&r=PG&f=1", "display_name": "minnow1", "link": "https://stackoverflow.com/users/7442059/minnow1"}, "reply_to_user": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "edited": false, "score": 0, "creation_date": 1486569885, "post_id": 42116735, "comment_id": 71404297, "body": "@cyboashu did not know this. Thanks."}], "answers": [{"comments": [{"owner": {"reputation": 53, "user_id": 7442059, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/d61838d166a956d252e403714f55bc13?s=128&d=identicon&r=PG&f=1", "display_name": "minnow1", "link": "https://stackoverflow.com/users/7442059/minnow1"}, "edited": false, "score": 0, "creation_date": 1486569903, "post_id": 42117168, "comment_id": 71404319, "body": "Works great. Thank you!"}], "tags": [], "owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "is_accepted": true, "score": 5, "last_activity_date": 1486568677, "last_edit_date": 1486568677, "creation_date": 1486567724, "answer_id": 42117168, "question_id": 42116735, "link": "https://stackoverflow.com/questions/42116735/excel-vba-create-directories-and-folders-if-they-are-not-already-there/42117168#42117168", "title": "EXCEL VBA - create directories and folders if they are not already there", "body": "<p>You are creating orphan folders. mkdir \"abc\\\" will create a folder named abc in the WorkBook's directory. If the workbook is not saved then this folder gets created in MyDocuments (most likey, depending on Excel's config). </p>\n\n<p>You need to pass fully qalified path to create a folder at your desired location like \"C:\\Temp\\abc\\\"</p>\n\n<p>In your code the issue is with how you are running your for loop and passing the folder name. </p>\n\n<p>This is how you need to do this:</p>\n\n<pre><code>Sub test()\n\n    Dim strPath  As String\n    Dim lCtr     As Long\n\n    strPath = \"C:\\Temp\\Parent\\Child\\ChildsChild\"\n\n    arrpath = Split(strPath, \"\\\")\n    strPath = arrpath(LBound(arrpath)) &amp; \"\\\"\n\n    For lCtr = LBound(arrpath) + 1 To UBound(arrpath)\n        strPath = strPath &amp; arrpath(lCtr) &amp; \"\\\"            \n        If Dir(strPath, vbDirectory) = \"\" Then\n            MkDir strPath\n        End If\n    Next\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 53, "user_id": 7442059, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/d61838d166a956d252e403714f55bc13?s=128&d=identicon&r=PG&f=1", "display_name": "minnow1", "link": "https://stackoverflow.com/users/7442059/minnow1"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 8203, "favorite_count": 0, "accepted_answer_id": 42117168, "answer_count": 1, "score": 3, "last_activity_date": 1486568677, "creation_date": 1486566464, "question_id": 42116735, "link": "https://stackoverflow.com/questions/42116735/excel-vba-create-directories-and-folders-if-they-are-not-already-there", "title": "EXCEL VBA - create directories and folders if they are not already there", "body": "<p>I have a list of folder locations in column A that define the directory hierarchy I am trying to create (e.g. \"C:\\topFolder\\nextFolder\\lastFolder\\). The code runs with no errors, but no folders are created. What am I doing wrong here?</p>\n\n<pre><code>Sub newDestination()\n    Dim Path As Variant\n    Dim folderLevel As Variant\n\n    For Each Path In Sheet11.Range(\"A:A\")\n        For Each folderLevel In Split(Path.Value, \"\\\")\n            folderLevel = folderLevel &amp; \"\\\"\n            If Len(Dir(folderLevel, vbDirectory)) = 0 Then\n                MkDir folderLevel\n            End If\n        Next folderLevel\n    Next Path\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["javascript", "arrays", "vba", "excel"], "comments": [{"owner": {"reputation": 56607, "user_id": 695364, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CUNjJ.jpg?s=128&g=1", "display_name": "Scott Marcus", "link": "https://stackoverflow.com/users/695364/scott-marcus"}, "edited": false, "score": 2, "creation_date": 1486565022, "post_id": 42116099, "comment_id": 71400775, "body": "Because the property is <code>length</code>, not  <code>lenght</code>"}, {"owner": {"reputation": 56607, "user_id": 695364, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CUNjJ.jpg?s=128&g=1", "display_name": "Scott Marcus", "link": "https://stackoverflow.com/users/695364/scott-marcus"}, "edited": false, "score": 0, "creation_date": 1486565169, "post_id": 42116099, "comment_id": 71400893, "body": "You haven&#39;t shown us the <code>Run()</code> function, so how can we tell you what&#39;s wrong with it?"}, {"owner": {"reputation": 67, "user_id": 5608775, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/9723c2e58be94fd79cfd21d7198eb791?s=128&d=identicon&r=PG&f=1", "display_name": "Jacek Rzadca", "link": "https://stackoverflow.com/users/5608775/jacek-rzadca"}, "reply_to_user": {"reputation": 56607, "user_id": 695364, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CUNjJ.jpg?s=128&g=1", "display_name": "Scott Marcus", "link": "https://stackoverflow.com/users/695364/scott-marcus"}, "edited": false, "score": 0, "creation_date": 1486566570, "post_id": 42116099, "comment_id": 71401927, "body": ".Run is a method of jsObj."}, {"owner": {"reputation": 67, "user_id": 5608775, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/9723c2e58be94fd79cfd21d7198eb791?s=128&d=identicon&r=PG&f=1", "display_name": "Jacek Rzadca", "link": "https://stackoverflow.com/users/5608775/jacek-rzadca"}, "reply_to_user": {"reputation": 56607, "user_id": 695364, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CUNjJ.jpg?s=128&g=1", "display_name": "Scott Marcus", "link": "https://stackoverflow.com/users/695364/scott-marcus"}, "edited": false, "score": 0, "creation_date": 1486567280, "post_id": 42116099, "comment_id": 71402453, "body": "Ok I wrote lenght here, but as you can see in the code it is written properly length. I think the the problem is the function doesn&#39;t see classarray... = Length is null"}], "answers": [{"tags": [], "owner": {"reputation": 67, "user_id": 5608775, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/9723c2e58be94fd79cfd21d7198eb791?s=128&d=identicon&r=PG&f=1", "display_name": "Jacek Rzadca", "link": "https://stackoverflow.com/users/5608775/jacek-rzadca"}, "is_accepted": false, "score": 1, "last_activity_date": 1486567627, "creation_date": 1486567627, "answer_id": 42117139, "question_id": 42116099, "link": "https://stackoverflow.com/questions/42116099/convert-js-array-to-vba-array-how-to-call-array-var/42117139#42117139", "title": "Convert JS Array to VBA Array. How to call array var", "body": "<p>Ok I solved it. In function I replaced \"ja\" with \"classarray\".Sorry for posting a question which I answered by myself,  I tried to find solution whole day. \nAnyway, may someone will use this code for his own purpose. </p>\n"}], "owner": {"reputation": 67, "user_id": 5608775, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/9723c2e58be94fd79cfd21d7198eb791?s=128&d=identicon&r=PG&f=1", "display_name": "Jacek Rzadca", "link": "https://stackoverflow.com/users/5608775/jacek-rzadca"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 416, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1486567627, "creation_date": 1486564855, "last_edit_date": 1531164843, "question_id": 42116099, "link": "https://stackoverflow.com/questions/42116099/convert-js-array-to-vba-array-how-to-call-array-var", "title": "Convert JS Array to VBA Array. How to call array var", "body": "<p>I am working in VBA. I want to convert JS array to VBA array. I almost there. I am filling Array: \"Classarray\" successfully! However I have a problem with calling a function which will convert it to VBA Array. The function which I use is here:</p>\n\n<pre><code>Dim SortedArray As Variant\nDim jsObj As New ScriptControl\njsObj.Language = \"JScript\"    \nWith jsObj\n  .AddCode _\n    \"var classArray = new Array();\" &amp; ArrayString &amp; _\n    \"function setArray(ja) {\" &amp; _\n    \"var dict = new ActiveXObject('Scripting.Dictionary');\" &amp; _\n    \"for (var i=0;i &lt; ja.length; i++ )dict.add(i,ja[i]);\" &amp; _\n    \"return dict.items();}\"\n  SortedArray = .Run(\"setArray\", classArray)\nEnd With\n</code></pre>\n\n<p>The problem is in line \"SortedArray = .Run(\"setArray\",classArray). I have got error \"Error:5007 'lenght' is null or not an object\" In debug mode when point on classarray it display \"empty\", but it isn't! See attached .jpg. Could you tell me what am I doing worng with .Run function?? Thanks. </p>\n\n<p><a href=\"https://i.stack.imgur.com/W0alR.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/W0alR.jpg\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5283, "user_id": 485674, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9720c6f1a3dead1c68d0f42776633d4d?s=128&d=identicon&r=PG", "display_name": "Jon Peltier", "link": "https://stackoverflow.com/users/485674/jon-peltier"}, "edited": false, "score": 0, "creation_date": 1486672046, "post_id": 42116026, "comment_id": 71458750, "body": "Well, you&#39;re adding a new series. Change <code>.SeriesCollection.NewSeries.XValues = Sht1.Range(blah blah)</code> to <code>.SeriesCollection.SeriesCollection(1).XValues = Sht1.Range(blah blah)</code>"}, {"owner": {"reputation": 5283, "user_id": 485674, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9720c6f1a3dead1c68d0f42776633d4d?s=128&d=identicon&r=PG", "display_name": "Jon Peltier", "link": "https://stackoverflow.com/users/485674/jon-peltier"}, "edited": false, "score": 0, "creation_date": 1486672084, "post_id": 42116026, "comment_id": 71458777, "body": "Why not define a rectangular range, including the X values, and pass it to SetSourceData?"}], "answers": [{"tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": true, "score": 1, "last_activity_date": 1486578912, "creation_date": 1486578912, "answer_id": 42121025, "question_id": 42116026, "link": "https://stackoverflow.com/questions/42116026/remove-series-from-chart-legend-and-set-axis-range-in-excel-vba/42121025#42121025", "title": "Remove series from chart legend and set axis range in excel vba", "body": "<p>To remove Series 17 only from the legend (and not from the chart), and also to set the Chart axis from 0 to 100, use the code below:</p>\n\n<pre><code>With MyChtObj.Chart\n    .Legend.LegendEntries(17).Delete  ' delete the legend only\n\n    .Axes(xlValue).MinimumScale = 0 ' set minimum value\n    .Axes(xlValue).MaximumScale = 100  ' set maximum value\nEnd With \n</code></pre>\n"}], "owner": {"reputation": 133, "user_id": 7267457, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/ea371989d65e97bf2f250d7bff7059fd?s=128&d=identicon&r=PG&f=1", "display_name": "M Kaye", "link": "https://stackoverflow.com/users/7267457/m-kaye"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3607, "favorite_count": 0, "accepted_answer_id": 42121025, "answer_count": 1, "score": 2, "last_activity_date": 1486578912, "creation_date": 1486564654, "last_edit_date": 1531164843, "question_id": 42116026, "link": "https://stackoverflow.com/questions/42116026/remove-series-from-chart-legend-and-set-axis-range-in-excel-vba", "title": "Remove series from chart legend and set axis range in excel vba", "body": "<p>I am using VBA and am trying to install a chart and am trying to make the y axis have years as the values. However a new series comes in to play called series 17 which appears in the legend. Is there anyway to delete this from the legend but not remove it as the x axis values. I have already tried \"MyChartObj.Chart.SeriesCollection(17).Delete\" but this removes it as y axis values.</p>\n\n<p>Also does anyone know how to set the range of values on an axis. For example I would like the chart to go between 0 and 100 rather than 0 and 120 which is currently happening.</p>\n\n<p>Here is my code:</p>\n\n<pre><code>Sub orange_weightings_chart()\n\nDim MyChtObj As ChartObject\nDim Sht1 As Worksheet\nDim Sht2 As Worksheet\nDim Sht1Name As String\nDim Sht2Name As String\n\nSet Sht2 = Worksheets(\"Orange Weightings\")\nSet Sht1 = Worksheets(\"Weightings Table\")\nSht1Name = Sht1.Name\nSht2Name = Sht2.Name\nSet MyChtObj = Sht1.ChartObjects.Add(100, 100, 500, 500)\n\nSet a = Sht1.Range(\"A2\", Sht1.Range(\"A2\").End(xlToRight))\nSet b = Sht1.Range(\"A3\", Sht1.Range(\"A3\").End(xlToRight))\nSet c = Sht1.Range(\"A4\", Sht1.Range(\"A4\").End(xlToRight))\nSet d = Sht1.Range(\"A5\", Sht1.Range(\"A5\").End(xlToRight))\nSet e = Sht1.Range(\"A6\", Sht1.Range(\"A6\").End(xlToRight))\nSet f = Sht1.Range(\"A7\", Sht1.Range(\"A7\").End(xlToRight))\nSet g = Sht1.Range(\"A8\", Sht1.Range(\"A8\").End(xlToRight))\nSet h = Sht1.Range(\"A9\", Sht1.Range(\"A9\").End(xlToRight))\nSet i = Sht1.Range(\"A10\", Sht1.Range(\"A10\").End(xlToRight))\nSet j = Sht1.Range(\"A11\", Sht1.Range(\"A11\").End(xlToRight))\nSet k = Sht1.Range(\"A12\", Sht1.Range(\"A12\").End(xlToRight))\nSet l = Sht1.Range(\"A13\", Sht1.Range(\"A13\").End(xlToRight))\nSet m = Sht1.Range(\"A14\", Sht1.Range(\"A14\").End(xlToRight))\nSet n = Sht1.Range(\"A15\", Sht1.Range(\"A15\").End(xlToRight))\nSet o = Sht1.Range(\"A16\", Sht1.Range(\"A16\").End(xlToRight))\nSet p = Sht1.Range(\"A17\", Sht1.Range(\"A17\").End(xlToRight))\nSet InputData = Union(a, b, c, d, e, f, g, h, i, j, k, l, m, n, o, p)\n\nWith MyChtObj.Chart\n    .ChartType = xlBarStacked\n    .SetSourceData InputData\n    .PlotBy = xlRows\n    .HasTitle = True\n    .ChartTitle.Text = \"Original Forecast Parameter Weightings\"\n    .HasLegend = True\n    .SeriesCollection.NewSeries.XValues = Sht1.Range(\"B1\", Sht1.Range(\"B1\").End(xlToRight))\nEnd With\n\nWith MyChtObj\n    .Top = Sht2.Range(\"E15\").Top\n    .Left = Sht2.Range(\"E15\").Left\n    .Width = 1200\n    .Height = 380\nEnd With\n\nEnd Sub\n</code></pre>\n\n<p>Thanks in advance,</p>\n\n<p>Max</p>\n"}, {"tags": ["vba", "excel", "pdf", "ms-word"], "comments": [{"owner": {"reputation": 816, "user_id": 5143876, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/36f1aaff08162453b0791065c9a44b14?s=128&d=identicon&r=PG&f=1", "display_name": "Jbjstam", "link": "https://stackoverflow.com/users/5143876/jbjstam"}, "edited": false, "score": 0, "creation_date": 1486570677, "post_id": 42115861, "comment_id": 71404894, "body": "There is no i variable. You&#39;re probably just overwriting the same file every time.."}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1486666260, "post_id": 42115861, "comment_id": 71455456, "body": "Please describe exactly HOW it &quot;doesn&#39;t work&quot;."}], "answers": [{"tags": [], "owner": {"reputation": 163, "user_id": 8847214, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-RuuQ-rUpOns/AAAAAAAAAAI/AAAAAAAAAJE/9HHcnAR1wb0/photo.jpg?sz=128", "display_name": "Mario Favere", "link": "https://stackoverflow.com/users/8847214/mario-favere"}, "is_accepted": false, "score": 1, "last_activity_date": 1535041385, "creation_date": 1535041385, "answer_id": 51990291, "question_id": 42115861, "link": "https://stackoverflow.com/questions/42115861/excel-vba-word-to-pdf-multiple-times-saveas2/51990291#51990291", "title": "EXCEL VBA word to pdf multiple times SaveAs2", "body": "<p>can you use:</p>\n\n<pre><code>    ActiveDocument.SaveAs2(docname,17);\n</code></pre>\n\n<p>?\n(17 is PDF-format -<a href=\"https://docs.microsoft.com/en-us/dotnet/api/microsoft.office.interop.word.wdsaveformat?redirectedfrom=MSDN&amp;view=word-pia\" rel=\"nofollow noreferrer\">link to fileformats</a>)</p>\n\n<p>Greetz</p>\n"}], "owner": {"reputation": 19, "user_id": 7534966, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1acc0b65dc699771e7bb42486b508675?s=128&d=identicon&r=PG&f=1", "display_name": "rabib", "link": "https://stackoverflow.com/users/7534966/rabib"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 736, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1535041385, "creation_date": 1486564226, "last_edit_date": 1486564303, "question_id": 42115861, "link": "https://stackoverflow.com/questions/42115861/excel-vba-word-to-pdf-multiple-times-saveas2", "title": "EXCEL VBA word to pdf multiple times SaveAs2", "body": "<p>I whould like to fill a word with values and export to pdf multiple times.</p>\n\n<p>If is use a SaveAs2 the firt time it make a pdf but second or third it doesen't  work. </p>\n\n<pre><code>'ActiveDocument.SaveAs2 FileName:=\"C:\\alap\\\" &amp; fajlneve &amp; \".pdf\", FileFormat:=wdFormatPDF\n</code></pre>\n\n<p>If I use the CutePDf printer, the result is the same, first time i=1 it works, but second it doesen't.</p>\n\n<pre><code>Public compname As String\nPublic filename As String\n\n\nFunction FillwordForm()\n\nDim appword As Word.Application\nDim doc As Word.Document\nDim Path As String\n\n\nOn Error Resume Next\nError.Clear\n\n\nSet appword = GetObject(, \"word.application\")\nIf Err.Number &lt;&gt; 0 Then\n\nSet appword = New Word.Application\nappword.Visible = True\n\nEnd If\nPath = \"C:\\pelda\\MINTA.docx\"\nSet doc = appword.Documents.Open(Path, , True)\n\nWith doc\n\n    .formfields(\"szerzCegnev\").result = compname\n\nEnd With\n\nappword.Visible = True\nappword.Activate\n\nSet doc = Nothing\nSet appword = Nothing\n\nappword.ActivePrinter = \"CutePDF Writer\"\n\nActiveDocument.PrintOut OutPutFileName:=\"C:\\pelda\\\" &amp; filename &amp; \".pdf\"\n\nActiveDocument.Close SaveChanges:=wdDoNotSaveChanges\n\nWord.Application.Quit\n\nEnd Function\n\n\n  '---------------------------------------------------------------\n\n\nSub cucc()\n\nFor i = 1 To 2\n\ncompname = Cells(i, 1)\nfilename = Cells(i, 2)\nCall FillwordForm\n\nNext i\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1486564182, "post_id": 42115740, "comment_id": 71400114, "body": "Can you write <code>userform1.repaint</code> before the <code>End Sub</code> line?"}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1486564598, "post_id": 42115740, "comment_id": 71400429, "body": "when you launch this userform is the &quot;separate worksheet&quot; the active one? If not, qualify all your ranges object up to worksheet reference"}, {"owner": {"reputation": 1595, "user_id": 4837035, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdfc11c275ff58678c9c6b7fa93d4119?s=128&d=identicon&r=PG&f=1", "display_name": "Zerk", "link": "https://stackoverflow.com/users/4837035/zerk"}, "edited": false, "score": 0, "creation_date": 1486564617, "post_id": 42115740, "comment_id": 71400449, "body": "why are you setting i as a string and then using it to store numbers? surely you&#39;d dim it as a long?"}], "answers": [{"comments": [{"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1486574893, "post_id": 42116101, "comment_id": 71407756, "body": "@Vicelikeelm, did you get through it?"}, {"owner": {"reputation": 13, "user_id": 7242085, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8e1f388a3664baca4586636f6ac4470?s=128&d=identicon&r=PG&f=1", "display_name": "Vicelikeelm", "link": "https://stackoverflow.com/users/7242085/vicelikeelm"}, "edited": false, "score": 0, "creation_date": 1486658726, "post_id": 42116101, "comment_id": 71450621, "body": "No i have not had any luck with it yet i am still trying to get through it and I still have no clue why its not working."}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "reply_to_user": {"reputation": 13, "user_id": 7242085, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8e1f388a3664baca4586636f6ac4470?s=128&d=identicon&r=PG&f=1", "display_name": "Vicelikeelm", "link": "https://stackoverflow.com/users/7242085/vicelikeelm"}, "edited": false, "score": 0, "creation_date": 1486662368, "post_id": 42116101, "comment_id": 71453106, "body": "step through your code (F8 to step to subsequent statement to be executed yellow highlighted) and use Immediate Window (CTRL+G) to query relevant variables value (e.g. while inside the loop you may type <code>?.Cells(i + 1, 1).Value</code> and press return to see the outcome"}], "tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": false, "score": 0, "last_activity_date": 1486564859, "creation_date": 1486564859, "answer_id": 42116101, "question_id": 42115740, "link": "https://stackoverflow.com/questions/42115740/my-code-will-not-work-with-my-userform-why/42116101#42116101", "title": "My code will not work with my userform, why?", "body": "<p>try qualifying your ranges up to worksheet reference:</p>\n\n<pre><code>Option Explicit\n\nSub GetDataA()\n    Dim id As String, i As String, j As Integer, flag As Boolean\n\n    If Not IsNumeric(UserForm1.TextBox1.Value) Then\n        flag = False\n        i = 0\n        id = UserForm1.TextBox1.Value\n\n        With Worksheets(\"myTableWorksheetName\") '&lt;--| change \"myTableWorksheetName\" to your actual worksheet with table name\n            Do While .Cells(i + 1, 1).Value &lt;&gt; \"\"\n                If .Cells(i + 1, 1).Value = id Then\n                    flag = True\n                    For j = 2 To 7\n                        UserForm1.Controls(\"TextBox\" &amp; j).Value = .Cells(i + 1, j).Value\n                    Next j\n                End If\n                i = i + 1\n            Loop\n        End With\n\n        If flag = False Then\n            For j = 5 To 10\n                UserForm1.Controls(\"TextBox\" &amp; j).Value = \"\"\n            Next j\n        End If\n    End If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 7242085, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8e1f388a3664baca4586636f6ac4470?s=128&d=identicon&r=PG&f=1", "display_name": "Vicelikeelm", "link": "https://stackoverflow.com/users/7242085/vicelikeelm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 170, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1486569323, "creation_date": 1486563934, "last_edit_date": 1486569323, "question_id": 42115740, "link": "https://stackoverflow.com/questions/42115740/my-code-will-not-work-with-my-userform-why", "title": "My code will not work with my userform, why?", "body": "<p>I am trying to set up a user form to do a loop and look up information in my table which is in a separate worksheet within the same workbook. </p>\n\n<p>I want my user form to look up information in my table as I type and then auto fill in the other textboxes so that I can limit keystrokes and duplicates.</p>\n\n<p>I found some code that worked with another user form as desired.  However, when I try to use the same code for my table it goes through the loop like it\u2019s looking but it does not populate the user form. I have tried changing with the user forms textbox names and making sure the names match...  but to no avail.  I also have to skip over a combo box on my user form, can this effect my code? </p>\n\n<pre><code>Option Explicit\n\nDim id As String, i As String, j As Integer, flag As Boolean\n\nSub GetData()\n\nIf Not IsNumeric(UserForm1.TextBox1.Value) Then\n  flag = False\n  i = 0\n  id = UserForm1.TextBox1.Value\n\n  Do While Cells(i + 1, 1).Value &lt;&gt; \"\"\n    If Cells(i + 1, 1).Value = id Then\n      flag = True\n      For j = 4 To 7\n        UserForm1.Controls(\"TextBox\" &amp; j).Value = Cells(i + 1, j).Value\n      Next j\n    End If\n    i = i + 1\n  Loop\n\n  If flag = False Then\n    For j = 2 To 4\n      '  UserForm1.Controls(\"TextBox\" &amp; j).Value = \"\"\n    Next j\n  End If\n\nElse\n\nEnd If\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1486574805, "post_id": 42116524, "comment_id": 71407705, "body": "@beeba, did you get through it?"}], "tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": true, "score": 1, "last_activity_date": 1486565933, "creation_date": 1486565933, "answer_id": 42116524, "question_id": 42115575, "link": "https://stackoverflow.com/questions/42115575/transform-data-by-groups-in-excel/42116524#42116524", "title": "Transform Data by Groups in Excel", "body": "<p>you could expolit <code>Areas</code> property of <code>Range</code> object</p>\n\n<pre><code>Option Explicit\n\nSub main2()\n    Dim iArea As Long\n    Dim serialToScalarTable As Range, cell As Range\n    Dim multiplier As Double\n\n    Set serialToScalarTable = Range(\"A2:B4\") '&lt;--| table where you have serial/scalar correspondence\n\n    With Range(\"D19\", Cells(Rows.count, 4).End(xlUp)).SpecialCells(xlCellTypeConstants, xlNumbers)\n        For iArea = 2 To .Areas.count Step 2\n            multiplier = Application.VLookup(.Areas(iArea - 1).Value, serialToScalarTable, 2, False)\n            For Each cell In .Areas(iArea)\n                cell.Value = cell.Value * multiplier\n            Next\n        Next\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 413, "user_id": 5000695, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/0ed8e240a46a121d1b6b01f000373420?s=128&d=identicon&r=PG&f=1", "display_name": "beeba", "link": "https://stackoverflow.com/users/5000695/beeba"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 51, "favorite_count": 0, "accepted_answer_id": 42116524, "answer_count": 1, "score": 1, "last_activity_date": 1486565933, "creation_date": 1486563508, "question_id": 42115575, "link": "https://stackoverflow.com/questions/42115575/transform-data-by-groups-in-excel", "title": "Transform Data by Groups in Excel", "body": "<p>I have some data in Excel grouped into blocks of data in a single column. Each block has a serial number identifying at the top, then a space, and then the associated data. The format is similar to the following:</p>\n\n<pre><code>    20204\n\n    0.009447773\n    0.008672609\n    0.04769611\n    0.041069839\n    -0.035158783\n    -0.06094639\n    0.059548043\n    0.029640036\n\n    8081\n\n    0.003970223\n    -0.024156246\n    0.063038863\n    0.005341972\n    0.124618374\n    0.005495709\n    0.098642513\n    0.005636186\n    0.063350961\n    0.128130779\n\n\n    106663\n\n    0.115009077\n    0.049194194\n    -0.057100467\n    0.037476741\n    0.063087314\n    0.072773643\n    0.003909923\n    0.000448073\n    0.008006874\n    0.008718021\n    0.009883258\n   -0.022708477\n    0.028655466\n</code></pre>\n\n<p>The blocks occur at regular intervals and are all the same length (spaced by 2007 cells). So the first serial number appears at D19, the next at D2026, then D4033, etc. This extends for several thousand rows. </p>\n\n<p>I want to multiply each of the blocks of numbers by a different amount based on their serial number. So I'd want to multiply everything in the first block by 0.5, everything in the second by 2, everything in the third by 1.2, etc, according to a table such as: </p>\n\n<pre><code>   Serial   Scalar\n    20204   0.5\n    8081    2\n    106663  1.2 \n</code></pre>\n\n<p>What would be the most efficient way to do this, either by VBA or in a formula in an adjacent cell?</p>\n"}, {"tags": ["excel", "sharepoint", "vba"], "comments": [{"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1486563781, "post_id": 42115410, "comment_id": 71399812, "body": "I have a similar situation where I open from SharePoint, but I keep a second log file available with the dates listed.  My filenames are listed as &quot;yyyymmdd TEMPLATE.xlsx.&quot;  In doing this, I first find the last date in the log, then use that to open up the latest version.  Essentially, when you check that log file, you can have it compare the latest date to the latest date of the local file, then it opens the highest based on an IF statement.  If your naming structure is similar to mine, you could have VBA take left(name,8) and compare based on the name, then open."}, {"owner": {"reputation": 51, "user_id": 2237411, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6fe445ade58d0845ab308e7b198bda05?s=128&d=identicon&r=PG", "display_name": "coldice4", "link": "https://stackoverflow.com/users/2237411/coldice4"}, "reply_to_user": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1486710883, "post_id": 42115410, "comment_id": 71472961, "body": "I just realized if the file is a .xlsx or .xlsm file vba opens it without problems. I really hate that kind of undocumented behavior. Thanks for your idea Cyril, I guess I will implement it like that"}], "owner": {"reputation": 51, "user_id": 2237411, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6fe445ade58d0845ab308e7b198bda05?s=128&d=identicon&r=PG", "display_name": "coldice4", "link": "https://stackoverflow.com/users/2237411/coldice4"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 88, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1486563086, "creation_date": 1486563086, "last_edit_date": 1531161705, "question_id": 42115410, "link": "https://stackoverflow.com/questions/42115410/open-workbook-from-sharepoint", "title": "Open Workbook from SharePoint", "body": "<p>I need to open an AddIn that is stored on a SharePoint location with https, to check if it is a newer version than the one locally stored. But</p>\n\n<pre><code>Set AddInRemote = Workbooks.Open(Filename:=AddInRemoteLocation, ReadOnly:=True, UpdateLinks:=False)\n</code></pre>\n\n<p>always returns nothing and does not present any error message. The AddInRemoteLocation looks something like this:</p>\n\n<pre><code>https://example.com/corp/folder/file.xla\n</code></pre>\n\n<p>Is it even possible to open the Workbook like this? If yes what do I do wrong? If not, is there another way?</p>\n"}, {"tags": ["vba", "excel", "excel-formula", "finance"], "answers": [{"comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1486563453, "post_id": 42115447, "comment_id": 71399586, "body": "FWIW: MINIFS and MAXIFS are only available on Office 365 Excel.  If not you will need to use AGGREGATE or an ARRAY MAX(IF()).  Also since none of those are array formulas you can use full column references.  One last note.  Replace the <code>WRONG</code> in the forth criterion of the VLOOKUP with <code>FALSE</code>."}, {"owner": {"reputation": 1850, "user_id": 683977, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aa2e7289a6292b5ee391d7004bb88120?s=128&d=identicon&r=PG", "display_name": "pintxo", "link": "https://stackoverflow.com/users/683977/pintxo"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1486563701, "post_id": 42115447, "comment_id": 71399760, "body": "@ScottCraner thx for the clarification. Sorry for the <code>WRONG</code>, it slipped into while translating into English."}, {"owner": {"reputation": 27, "user_id": 7409626, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c9f59fb36ed997baa9176dbdd515574e?s=128&d=identicon&r=PG&f=1", "display_name": "orkanoid", "link": "https://stackoverflow.com/users/7409626/orkanoid"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1486566240, "post_id": 42115447, "comment_id": 71401703, "body": "I guess I can&#39;t use the MINIFS function. Keeps giving me a #NAME? error. How should I use the AGGREGATE and ARRAY MAX(IF()) functions @ScottCraner?"}], "tags": [], "owner": {"reputation": 1850, "user_id": 683977, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aa2e7289a6292b5ee391d7004bb88120?s=128&d=identicon&r=PG", "display_name": "pintxo", "link": "https://stackoverflow.com/users/683977/pintxo"}, "is_accepted": false, "score": 1, "last_activity_date": 1486564857, "last_edit_date": 1486564857, "creation_date": 1486563172, "answer_id": 42115447, "question_id": 42115152, "link": "https://stackoverflow.com/questions/42115152/calculating-weekly-returns-from-daily-time-series-of-prices/42115447#42115447", "title": "Calculating Weekly Returns from Daily Time Series of Prices", "body": "<p>I would solve it using some lookup formulas to get the values for each week and then do a simple calculation for each week.</p>\n\n<p>Resulting table:</p>\n\n<pre><code>H   I           J           K           L           M     \n    first       last        first val   last val    return\n1   02.01.2012  06.01.2012  2,7587      2,7391      -0,007\n2   09.01.2012  13.01.2012  2,7288      2,7619      0,012\n3   16.01.2012  20.01.2012  2,747       2,876       0,047\n</code></pre>\n\n<p>Formula in column I:</p>\n\n<pre><code>=MINIFS($A:$A;$B:$B;$H2)\n</code></pre>\n\n<p>Fomula in column J:</p>\n\n<pre><code>=MAXIFS($A:$A;$B:$B;$H2)\n</code></pre>\n\n<p>Formula in column K: </p>\n\n<pre><code>=VLOOKUP($I2;$A:$D;4;FALSE)\n</code></pre>\n\n<p>Formula in column L: </p>\n\n<pre><code>=VLOOKUP($J2;$A:$D;4;FALSE)\n</code></pre>\n\n<p>Formula in column M:</p>\n\n<pre><code>=(L2-K2)/K2\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 27, "user_id": 7409626, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c9f59fb36ed997baa9176dbdd515574e?s=128&d=identicon&r=PG&f=1", "display_name": "orkanoid", "link": "https://stackoverflow.com/users/7409626/orkanoid"}, "edited": false, "score": 0, "creation_date": 1486589484, "post_id": 42116700, "comment_id": 71416092, "body": "Thank you @Scott Craner, you saved me lots of time. I would appreciate if you could check the edit I made to my question."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 27, "user_id": 7409626, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c9f59fb36ed997baa9176dbdd515574e?s=128&d=identicon&r=PG&f=1", "display_name": "orkanoid", "link": "https://stackoverflow.com/users/7409626/orkanoid"}, "edited": false, "score": 0, "creation_date": 1486589588, "post_id": 42116700, "comment_id": 71416150, "body": "Do not change the question after getting an answer.  Create a new question.  It opens up the current answers for down votes. @orkanoid"}, {"owner": {"reputation": 27, "user_id": 7409626, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c9f59fb36ed997baa9176dbdd515574e?s=128&d=identicon&r=PG&f=1", "display_name": "orkanoid", "link": "https://stackoverflow.com/users/7409626/orkanoid"}, "edited": false, "score": 0, "creation_date": 1486590023, "post_id": 42116700, "comment_id": 71416353, "body": "Oh sorry, didn&#39;t know that. Should I delete the edit and create a new question now or is it too late?"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 27, "user_id": 7409626, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c9f59fb36ed997baa9176dbdd515574e?s=128&d=identicon&r=PG&f=1", "display_name": "orkanoid", "link": "https://stackoverflow.com/users/7409626/orkanoid"}, "edited": false, "score": 0, "creation_date": 1486590103, "post_id": 42116700, "comment_id": 71416386, "body": "no rollback the edit and ask a new question. @orkanoid"}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 2, "last_activity_date": 1486566391, "creation_date": 1486566391, "answer_id": 42116700, "question_id": 42115152, "link": "https://stackoverflow.com/questions/42115152/calculating-weekly-returns-from-daily-time-series-of-prices/42116700#42116700", "title": "Calculating Weekly Returns from Daily Time Series of Prices", "body": "<p>To do it in one formula:</p>\n\n<pre><code>=(INDEX(D:D,AGGREGATE(15,6,ROW($D$2:$D$16)/(($C$2:$C$16=AGGREGATE(14,6,$C$2:$C$16/($B$2:$B$16=G2),1))*($B$2:$B$16=G2)),1))-INDEX(D:D,MATCH(G2,B:B,0)))/INDEX(D:D,MATCH(G2,B:B,0))\n</code></pre>\n\n<p>You may need to change all the <code>,</code> to <code>;</code> per your local settings.</p>\n\n<p><a href=\"https://i.stack.imgur.com/a4bKf.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/a4bKf.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 27, "user_id": 7409626, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c9f59fb36ed997baa9176dbdd515574e?s=128&d=identicon&r=PG&f=1", "display_name": "orkanoid", "link": "https://stackoverflow.com/users/7409626/orkanoid"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 8108, "favorite_count": 0, "accepted_answer_id": 42116700, "answer_count": 2, "score": 2, "last_activity_date": 1486590238, "creation_date": 1486562403, "last_edit_date": 1486590238, "question_id": 42115152, "link": "https://stackoverflow.com/questions/42115152/calculating-weekly-returns-from-daily-time-series-of-prices", "title": "Calculating Weekly Returns from Daily Time Series of Prices", "body": "<p>I want to calculate weekly returns of a mutual fund from a time series of daily prices. My data looks like this:</p>\n\n<pre><code>A        B      C        D        E\nDATE     WEEK   W.DAY    MF.PRICE WEEKLY RETURN\n02/01/12    1    1       2,7587\n03/01/12    1    2       2,7667\n04/01/12    1    3       2,7892\n05/01/12    1    4       2,7666\n06/01/12    1    5       2,7391    -0,007\n09/01/12    2    1       2,7288\n10/01/12    2    2       2,6707\n11/01/12    2    3       2,7044\n12/01/12    2    4       2,7183\n13/01/12    2    5       2,7619    0,012\n16/01/12    3    1       2,7470\n17/01/12    3    2       2,7878\n18/01/12    3    3       2,8156\n19/01/12    3    4       2,8310\n20/01/12    3    5       2,8760    0,047\n</code></pre>\n\n<p>The date is (dd/mm/yy) format and \",\" is decimal separator. This would be done by using this formula: (Price for last weekday - Price for first weekday)/(Price for first weekday). For example the return for the first week is (2,7391 - 2,7587)/2,7587 = -0,007 and for the second is (2,7619 - 2,7288)/2,7288 = 0,012. </p>\n\n<p>The problem is that the list goes on for a year, and some weeks have less than five working days due to holidays or other reasons. So I can't simply copy and paste the formula above. I added the extra two columns for week number and week day using WEEKNUM and WEEKDAY functions, thought it might help. I want to automate this with a formula or using VBA and hoping to get a table like this:</p>\n\n<pre><code>WEEK    RETURN\n 1     -0,007\n 2      0,012\n 3      0,047\n.       \n.       \n.       \n</code></pre>\n\n<p>As I said some weeks have less than five weekdays, some start with weekday 2 or end with weekday 3 etc. due to holidays or other reasons. So I'm thinking of a way to tell excel to \"find the prices that correspond to the max and min weekday of each week and apply the formula (Price for last weekday - Price for first weekday)/(Price for first weekday)\".</p>\n\n<p>Sorry for the long post, I tried to be be as clear as possible, I would appreciate any help! (I have 5 separate worksheets for consecutive years, each with daily prices of 20 mutual funds)</p>\n"}, {"tags": ["vba", "excel", "if-statement"], "answers": [{"comments": [{"owner": {"reputation": 127, "user_id": 6372785, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/bc8c3987229edf961d0be546ee253557?s=128&d=identicon&r=PG&f=1", "display_name": "Josh", "link": "https://stackoverflow.com/users/6372785/josh"}, "edited": false, "score": 1, "creation_date": 1486563291, "post_id": 42115408, "comment_id": 71399464, "body": "That makes complete sense, I feel like a dummy now haha. Thanks!"}, {"owner": {"reputation": 11030, "user_id": 25515, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/38cf4a5ba714f1706d94fa18cad3aabb?s=128&d=identicon&r=PG", "display_name": "Anders", "link": "https://stackoverflow.com/users/25515/anders"}, "edited": false, "score": 1, "creation_date": 1507043599, "post_id": 42115408, "comment_id": 80049942, "body": "As a quick-and-dirty solution you could potentially just add <code>Step -1</code> to the <code>For</code> loop so it iterates backwards, avoiding the issue of cell 50 becoming cell 49 after the original cell 49 was deleted."}], "tags": [], "owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "is_accepted": true, "score": 13, "last_activity_date": 1486563080, "creation_date": 1486563080, "answer_id": 42115408, "question_id": 42115086, "link": "https://stackoverflow.com/questions/42115086/excel-vba-simple-if-not-statement/42115408#42115408", "title": "Excel VBA simple if not statement", "body": "<p>Its not the <code>Not</code> statement. Your issue is that when you delete the cell, you range changes and so your loop is missing data. If Cell A49 is deleted then the value at A50 moves up to A49 and is never checked. Aggregate your cells which qualify to get deleted and then delete them in one go. </p>\n\n<pre><code>Sub test()\n\n    Dim rngDelete As Range\n\n    Set myrange = Range(\"A1:A3\")\n    For Each mycell In myrange.Cells\n        If mycell Like \"*msn.com*\" Or _\n            mycell Like \"*messaging.microsoft.com*\" Or _\n            Not mycell Like \"*.com*\" Then\n\n            If Not rngDelete Is Nothing Then\n                Set rngDelete = Union(rngDelete, mycell)\n            Else\n                Set rngDelete = mycell\n            End If\n        End If\n    Next mycell\n\n    If Not rngDelete Is Nothing Then\n        rngDelete.Delete\n    End If\n\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 127, "user_id": 6372785, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/bc8c3987229edf961d0be546ee253557?s=128&d=identicon&r=PG&f=1", "display_name": "Josh", "link": "https://stackoverflow.com/users/6372785/josh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 36384, "favorite_count": 3, "accepted_answer_id": 42115408, "answer_count": 1, "score": 5, "last_activity_date": 1486563395, "creation_date": 1486562184, "last_edit_date": 1486562270, "question_id": 42115086, "link": "https://stackoverflow.com/questions/42115086/excel-vba-simple-if-not-statement", "title": "Excel VBA simple if not statement", "body": "<p>I am trying to run a relatively simple loop to pull out values I don't want from a list.</p>\n\n<p>Everything below is working correctly other than my \"Not\" statement which does not create an error... </p>\n\n<p>it just doesn't seem to do anything at all.</p>\n\n<pre><code>Set myRange = Range(\"A49:A150\")\nFor Each myCell In myRange\n    If myCell Like \"*msn.com*\" Or _\n        myCell Like \"*messaging.microsoft.com*\" Or _\n        Not myCell Like \"*.com*\" Then\n        myCell.Delete\n    End If\nNext myCell\n</code></pre>\n\n<p>I am fairly certain I have a simple mistake in here somewhere but I have been unable to find it.</p>\n"}, {"tags": ["excel", "excel-formula", "vba"], "comments": [{"owner": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "edited": false, "score": 0, "creation_date": 1486562267, "post_id": 42114920, "comment_id": 71398724, "body": "Store all prefixes in an array ( or in a range) loop through said range with strings needing manipulation and loop through the array and do a chekc thats like &quot;if cell = array(i) then do soemthing&quot;"}, {"owner": {"reputation": 1008, "user_id": 6894767, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0cac8b20e633ad4ea6819333bf38d120?s=128&d=identicon&r=PG", "display_name": "Werrf", "link": "https://stackoverflow.com/users/6894767/werrf"}, "edited": false, "score": 0, "creation_date": 1486562405, "post_id": 42114920, "comment_id": 71398837, "body": "Are you doing this as a formula inside the cell, or in a macro? Are there always space characters between the prefix and the rest of the name? Is the &#39;body&#39; of the name always a single word?"}, {"owner": {"reputation": 651, "user_id": 4315769, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/36a8ccef18d7fe530fdd36d405fe6b05?s=128&d=identicon&r=PG&f=1", "display_name": "Grafit", "link": "https://stackoverflow.com/users/4315769/grafit"}, "reply_to_user": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "edited": false, "score": 0, "creation_date": 1486562415, "post_id": 42114920, "comment_id": 71398846, "body": "@DougCoats This would mean that for every name (which are around 9000), it has to check if there&#39;s one out of ~20 prefixes present, right? Wouldn&#39;t this be really time-consuming?"}, {"owner": {"reputation": 651, "user_id": 4315769, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/36a8ccef18d7fe530fdd36d405fe6b05?s=128&d=identicon&r=PG&f=1", "display_name": "Grafit", "link": "https://stackoverflow.com/users/4315769/grafit"}, "reply_to_user": {"reputation": 1008, "user_id": 6894767, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0cac8b20e633ad4ea6819333bf38d120?s=128&d=identicon&r=PG", "display_name": "Werrf", "link": "https://stackoverflow.com/users/6894767/werrf"}, "edited": false, "score": 0, "creation_date": 1486562490, "post_id": 42114920, "comment_id": 71398892, "body": "@Werrf Right now I was trying to do this with a formula inside the cells. There is always a space when there&#39;s a prefix. The body of the name can be multiple words."}, {"owner": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "edited": false, "score": 0, "creation_date": 1486565920, "post_id": 42114920, "comment_id": 71401480, "body": "@Grafit Id be willing to bet that it wouldnt take that long. Vba is fairly quick especially if youre working in arrays. Id be willing to bet it takes up to 4 to 5 seconds (if done in vba and not a worksheet thing)."}], "answers": [{"comments": [{"owner": {"reputation": 651, "user_id": 4315769, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/36a8ccef18d7fe530fdd36d405fe6b05?s=128&d=identicon&r=PG&f=1", "display_name": "Grafit", "link": "https://stackoverflow.com/users/4315769/grafit"}, "edited": false, "score": 0, "creation_date": 1486563341, "post_id": 42115293, "comment_id": 71399504, "body": "This formula is a big help! It is definitely going in the right direction. Now I also want only the prefixes in a different column. Can I make this happen with a formula like this as well?"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 651, "user_id": 4315769, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/36a8ccef18d7fe530fdd36d405fe6b05?s=128&d=identicon&r=PG&f=1", "display_name": "Grafit", "link": "https://stackoverflow.com/users/4315769/grafit"}, "edited": false, "score": 0, "creation_date": 1486563576, "post_id": 42115293, "comment_id": 71399672, "body": "Sure just put the <code>INDEX()</code> function part in another column, and enter it with Ctrl-Shift-Enter as it returns the surname to the SUBSTITUTE function."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 651, "user_id": 4315769, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/36a8ccef18d7fe530fdd36d405fe6b05?s=128&d=identicon&r=PG&f=1", "display_name": "Grafit", "link": "https://stackoverflow.com/users/4315769/grafit"}, "edited": false, "score": 0, "creation_date": 1486563684, "post_id": 42115293, "comment_id": 71399748, "body": "Also it is not appropriate on this site to change the question with new requests after getting answers as it nullifies the answers and opens them up for down votes.  Please put your question back to the original.  If my comment above does not answer your second request please ask a new question. @Grafit"}, {"owner": {"reputation": 651, "user_id": 4315769, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/36a8ccef18d7fe530fdd36d405fe6b05?s=128&d=identicon&r=PG&f=1", "display_name": "Grafit", "link": "https://stackoverflow.com/users/4315769/grafit"}, "edited": false, "score": 0, "creation_date": 1486563779, "post_id": 42115293, "comment_id": 71399810, "body": "I tried changing the reference of the <code>INDEX()</code> part to the column with the results I created with your original solution. Works well for the prefixes, but row 4 returns <code>craner</code> right now. I don&#39;t have a column available with only all surnames."}, {"owner": {"reputation": 651, "user_id": 4315769, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/36a8ccef18d7fe530fdd36d405fe6b05?s=128&d=identicon&r=PG&f=1", "display_name": "Grafit", "link": "https://stackoverflow.com/users/4315769/grafit"}, "edited": false, "score": 0, "creation_date": 1486563869, "post_id": 42115293, "comment_id": 71399876, "body": "I didn&#39;t mean to change my question. From your answer I noticed my question was not clear enough since splitting the prefixes was my original wish."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 651, "user_id": 4315769, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/36a8ccef18d7fe530fdd36d405fe6b05?s=128&d=identicon&r=PG&f=1", "display_name": "Grafit", "link": "https://stackoverflow.com/users/4315769/grafit"}, "edited": false, "score": 1, "creation_date": 1486568242, "post_id": 42115293, "comment_id": 71403092, "body": "Next time please ensure all your requirements are present at the start. @Grafit"}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": false, "score": 2, "last_activity_date": 1486567595, "last_edit_date": 1486567595, "creation_date": 1486562766, "answer_id": 42115293, "question_id": 42114920, "link": "https://stackoverflow.com/questions/42114920/split-prefix-and-surname-based-on-array-data/42115293#42115293", "title": "Split prefix and surname (based on array data)", "body": "<p>Put your list <strong><em>in order of the longest surname to the shortest</em></strong>.  I put mine in E1:E3.</p>\n\n<p>Then use this array formula:</p>\n\n<pre><code>=TRIM(IFERROR(SUBSTITUTE(A1,INDEX($E$1:$E$3,MATCH(TRUE,ISNUMBER(SEARCH($E$1:$E$3,A1)),0)),\"\"),A1))\n</code></pre>\n\n<p>Then to get the Surname:</p>\n\n<pre><code>=IFERROR(INDEX($E$1:$E$3,MATCH(TRUE,ISNUMBER(SEARCH($E$1:$E$3,A1)),0)),\"\")\n</code></pre>\n\n<p>Being an array formulas they need to be confirmed with Ctrl-Shift-Enter instead of Enter when exiting edit mode.  If done correctly then Excel will put <code>{}</code> around the formula.</p>\n\n<p><a href=\"https://i.stack.imgur.com/banLs.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/banLs.png\" alt=\"enter image description here\"></a></p>\n"}, {"comments": [{"owner": {"reputation": 651, "user_id": 4315769, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/36a8ccef18d7fe530fdd36d405fe6b05?s=128&d=identicon&r=PG&f=1", "display_name": "Grafit", "link": "https://stackoverflow.com/users/4315769/grafit"}, "edited": false, "score": 0, "creation_date": 1486567360, "post_id": 42116851, "comment_id": 71402508, "body": "Works pretty fine. One question though. When someone&#39;s name is <code>Name1 Demas Name3</code>, the formula thinks <code>Demas Name3</code> is the prefix. Is there a way to make sure it doesn&#39;t mix this up?"}, {"owner": {"reputation": 1029, "user_id": 1474994, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/rOT6j.png?s=128&g=1", "display_name": "UndeadBob", "link": "https://stackoverflow.com/users/1474994/undeadbob"}, "reply_to_user": {"reputation": 651, "user_id": 4315769, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/36a8ccef18d7fe530fdd36d405fe6b05?s=128&d=identicon&r=PG&f=1", "display_name": "Grafit", "link": "https://stackoverflow.com/users/4315769/grafit"}, "edited": false, "score": 0, "creation_date": 1486567590, "post_id": 42116851, "comment_id": 71402661, "body": "Put a space on the end of the <code>de </code> value in your <code>prefix</code> array.  Then change the <b>array formula</b> to <code>=MIN(IF(ISNUMBER(SEARCH(prefix,A2&amp;&quot; &quot;)),SEARCH(prefix,A2&amp;&quot; &quot;)))</code>. ... <i>OH</i> ... and maybe switch the <code>SEARCH</code> function for the <code>FIND</code> function for <b>case-sensitive</b> searching... well, that&#39;ll only help slightly..."}], "tags": [], "owner": {"reputation": 1029, "user_id": 1474994, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/rOT6j.png?s=128&g=1", "display_name": "UndeadBob", "link": "https://stackoverflow.com/users/1474994/undeadbob"}, "is_accepted": true, "score": 2, "last_activity_date": 1486566765, "creation_date": 1486566765, "answer_id": 42116851, "question_id": 42114920, "link": "https://stackoverflow.com/questions/42114920/split-prefix-and-surname-based-on-array-data/42116851#42116851", "title": "Split prefix and surname (based on array data)", "body": "<p>I made the assumption that you wanted to separate the \"van\" and \"de\" <em>prefixes</em> from the rest of the name.  If I misunderstood, please provide more examples of your problem/question...</p>\n\n<p>The following solution requires a helper column to determine where the \"Prefix\" starts, but you can hide it if necessary:</p>\n\n<p><a href=\"https://i.stack.imgur.com/WAoWH.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/WAoWH.png\" alt=\"enter image description here\"></a></p>\n\n<p>First, put my values in <code>A8:A9</code> (<em>van; de</em>) anywhere and name it <code>prefix</code> so it can be referenced in the following formulas.</p>\n\n<p>The formula in <code>C1</code> is an <strong>array formula</strong> (use <em><kbd>Ctrl</kbd>+<kbd>Shift</kbd>+<kbd>Enter</kbd></em>):</p>\n\n<pre><code>=MIN(IF(ISNUMBER(SEARCH(prefix,A1)),SEARCH(prefix,A1)))\n</code></pre>\n\n<p>The formula in <code>D1</code> and <code>E1</code> or normal formulas:</p>\n\n<pre><code>=IF(C1&gt;0,LEFT(A1,C1-2),A1)\n=IF(C1&gt;0,MID(A1,C1,LEN(A1)),\"\")\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2954, "user_id": 6387479, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MU0ok.jpg?s=128&g=1", "display_name": "Glitch_Doctor", "link": "https://stackoverflow.com/users/6387479/glitch-doctor"}, "is_accepted": false, "score": 1, "last_activity_date": 1486631742, "creation_date": 1486631742, "answer_id": 42132504, "question_id": 42114920, "link": "https://stackoverflow.com/questions/42114920/split-prefix-and-surname-based-on-array-data/42132504#42132504", "title": "Split prefix and surname (based on array data)", "body": "<p>I know this has already been answered but I done this yesterday and didn't have time to submit it (had to run for the bus).</p>\n\n<p>All Prefix values have a space before them...</p>\n\n<p><a href=\"https://i.stack.imgur.com/7kHjN.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/7kHjN.png\" alt=\"enter image description here\"></a></p>\n\n<p>Column B formula (Array formula - <kbd>Ctrl</kbd>+<kbd>Shift</kbd>+<kbd>Enter</kbd> in formula bar)\n<code>=INDEX(SUBSTITUTE(A1,Prefix,\"\"),MATCH(SMALL(LEN(SUBSTITUTE(A1,Prefix,\"\")),1),LEN(SUBSTITUTE(A1,Prefix,\"\")),0))</code></p>\n\n<p>Column C formula - <code>=TRIM(SUBSTITUTE(A1,B1,\"\"))</code></p>\n"}], "owner": {"reputation": 651, "user_id": 4315769, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/36a8ccef18d7fe530fdd36d405fe6b05?s=128&d=identicon&r=PG&f=1", "display_name": "Grafit", "link": "https://stackoverflow.com/users/4315769/grafit"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 181, "favorite_count": 0, "accepted_answer_id": 42116851, "answer_count": 3, "score": 2, "last_activity_date": 1486631742, "creation_date": 1486561756, "last_edit_date": 1531161705, "question_id": 42114920, "link": "https://stackoverflow.com/questions/42114920/split-prefix-and-surname-based-on-array-data", "title": "Split prefix and surname (based on array data)", "body": "<p>I have a column of data existing out of names, which may or may not contain a surname prefix. Those prefixes can exist out of multiple words. I have a list of all possible prefixes, but now I need to split the prefix and surname and make 2 columns with the data.</p>\n\n<p>What I did was writing an excel formula like the following:</p>\n\n<pre><code>=IF(\n   RIGHT(A1;7) = \" van de\"\n ;\n   RIGHT(A1;6)\n ;\n   IF(\n     RIGHT(A1;4) = \" van\"\n   ;\n     RIGHT(A1;3)\n   ;\n     IF(\n       RIGHT(A1;3) = \" de\"\n     ;\n       RIGHT(A1;2)\n     ;\n       --Insert more nested If statements here--\n     )\n   )\n )\n</code></pre>\n\n<p>Data of the surnames can look like the following:</p>\n\n<pre><code>Name1 van de\nName1 van\nName1\nName1 Name2 van\nName1-Name2 Name3 van de\nName1 Name2 Name3\n</code></pre>\n\n<p>What I want:</p>\n\n<pre><code>  OriginalName   |  Name  |  Prefix\n-----------------|--------|----------\n      a b        |   a    |    b\n      a b c      |   a    |    b c\n</code></pre>\n\n<p>Firstly this is a pretty inefficient method, but I automated the creating of this formula, so that wasn't a problem anymore. Now I found out there's a limit to the nested If statements one can have, and I have to exceed that limit.</p>\n\n<p>How should I solve this problem?</p>\n\n<p>I have an array with the possible prefixes. Maybe this will help?</p>\n"}, {"tags": ["excel", "vba", "outlook"], "comments": [{"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1486562400, "post_id": 42114883, "comment_id": 71398832, "body": "Would <code>objFolder.Items.Count</code> contain calendar items, task items, etc. It wouldn&#39;t be the same count as just the email items."}], "answers": [{"comments": [{"owner": {"reputation": 9, "user_id": 7534805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51ad32998037fd70a47e6321e5146f70?s=128&d=identicon&r=PG&f=1", "display_name": "Katy", "link": "https://stackoverflow.com/users/7534805/katy"}, "edited": false, "score": 0, "creation_date": 1486719139, "post_id": 42115439, "comment_id": 71477288, "body": "Hi, thanks for this, I am a bit confused as to what to do with it though? What do I change to make it go in to the folders I want it to, and do I do this on a separate sheet in the workbook?"}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "reply_to_user": {"reputation": 9, "user_id": 7534805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51ad32998037fd70a47e6321e5146f70?s=128&d=identicon&r=PG&f=1", "display_name": "Katy", "link": "https://stackoverflow.com/users/7534805/katy"}, "edited": false, "score": 0, "creation_date": 1486722686, "post_id": 42115439, "comment_id": 71479442, "body": "Just add the code to a module in Excel and run the <code>Create Report</code> procedure.  <code>Set mFolderSelected = nNameSpace.PickFolder</code> will ask you to select a folder and it will then count all the emails in that folder and any subfolders within it.  NB:  I&#39;ve added a line of code to the <code>PlaceDetails</code> procedure to autofit column A - the Find didn&#39;t appear to be working when the column was showing ##### rather than the date."}], "tags": [], "owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "is_accepted": false, "score": 0, "last_activity_date": 1486722531, "last_edit_date": 1486722531, "creation_date": 1486563138, "answer_id": 42115439, "question_id": 42114883, "link": "https://stackoverflow.com/questions/42114883/outlook-to-collate-amount-emails-received-on-certain-days/42115439#42115439", "title": "outlook to collate amount emails received on certain days", "body": "<p>I've had this code sitting around for a couple of years - it may need tweaking.<br>\nYou'll need to create a workbook and give a sheet the codename of <code>shtAnalysis</code>.  </p>\n\n<p>Add this code to a normal module within the workbook and run the <code>CreateReport</code> procedure.  </p>\n\n<pre><code>Public Sub CreateReport()\n\n    Dim oOutlook As Object 'Outlook.Application\n    Dim nNameSpace As Object 'Outlook.Namespace\n    Dim mFolderSelected As Object 'Outlook.MAPIFolder\n    Dim oItem As Object\n    Dim rLastCell As Range\n    Dim x As Long\n\n    'Solves the \"Code execution has been interrupted\" problem.\n    Application.EnableCancelKey = xlDisabled\n    Application.EnableCancelKey = xlInterrupt\n\n    Set oOutlook = GetObject(, \"Outlook.Application\")\n    Set nNameSpace = oOutlook.GetNamespace(\"MAPI\")\n\n    Set mFolderSelected = nNameSpace.PickFolder\n\n    shtAnalysis.Cells.Delete Shift:=xlUp\n\n    ProcessFolder mFolderSelected\n\n    Set rLastCell = LastCell(shtAnalysis)\n\n    With shtAnalysis\n        .Columns.ColumnWidth = 100\n        .Cells.EntireColumn.AutoFit\n\n        .Range(.Cells(1, 1), .Cells(rLastCell.Row, rLastCell.Column)).Sort _\n            Key1:=.Range(\"A2\"), Order1:=xlDescending, Header:=xlYes\n\n        'Add totals to row 1 &amp; column A.\n            .Rows(\"1:1\").Insert Shift:=xlDown\n            .Columns(\"A:A\").Insert Shift:=xlToRight\n            For x = 3 To rLastCell.Column\n                With .Cells(1, x)\n                    .FormulaR1C1 = \"=SUM(R3C:R\" &amp; rLastCell.Row &amp; \"C)\"\n                    .NumberFormat = \"General\"\n                    .Font.Bold = True\n                    .Font.ColorIndex = 3\n                End With\n            Next x\n            For x = 3 To rLastCell.Row\n                With .Cells(x, 1)\n                    .FormulaR1C1 = \"=SUM(RC3:RC\" &amp; rLastCell.Column &amp; \")\"\n                    .NumberFormat = \"General\"\n                    .Font.Bold = True\n                    .Font.ColorIndex = 3\n                End With\n            Next x\n            'Add grand total.\n            With .Cells(1, 1)\n                .FormulaR1C1 = \"=SUM(RC3:RC\" &amp; rLastCell.Column &amp; \")\"\n                .NumberFormat = \"General\"\n                .Font.Bold = True\n                .Font.Size = 14\n                .Font.ColorIndex = 3\n            End With\n    End With\n\n    ThisWorkbook.Activate\n    MsgBox \"Complete\", vbOKOnly\n\nEnd Sub\n\nPrivate Sub ProcessFolder(oParent As Object)\n\n    Dim oFolder As Object 'Outlook.MAPIFolder\n    Dim oMail As Object\n    Dim sName As String\n\n    On Error Resume Next\n    For Each oMail In oParent.Items\n        PlaceDetails Int(oMail.SentOn), oParent\n    Next oMail\n\n    If (oParent.Folders.Count &gt; 0) Then\n        For Each oFolder In oParent.Folders\n            ProcessFolder oFolder\n        Next oFolder\n    End If\n    On Error GoTo 0\n\nEnd Sub\n\nPublic Sub PlaceDetails(dDate As Date, oFolders As Object)\n\n    Dim rFoundCell As Range\n    Dim lRow As Long, lColumn As Long\n    Dim sItem As String\n    Dim lLevel As Long\n    Dim x As Long\n\n    sItem = oFolders.FullFolderPath 'User the full path of the folder.\n    If Left(sItem, \"2\") = \"\\\\\" Then\n        sItem = Mid(sItem, 3, Len(sItem)) 'Remove leading backslashes.\n    End If\n    lLevel = Len(sItem) - Len(Replace(sItem, \"\\\", \"\"))\n\n    For x = 1 To lLevel\n        sItem = Left(sItem, InStr(sItem, \"\\\") - 1) &amp; Replace(sItem, \"\\\", Chr(10) &amp; Application.WorksheetFunction.Rept(\" \", x) &amp; Chr(149), InStr(sItem, \"\\\"), 1)\n    Next x\n\n\n    With shtAnalysis\n        .Columns(1).EntireColumn.AutoFit\n\n        'First find the column by looking for sItem in row 1.\n        Set rFoundCell = .Rows(\"1:1\").Cells.Find(What:=sItem, After:=.Cells(1, 1), LookIn:=xlValues, LookAt:=xlWhole, SearchDirection:=xlNext)\n        If Not rFoundCell Is Nothing Then\n            lColumn = rFoundCell.Column\n        Else\n            lColumn = LastCell(shtAnalysis).Column + 1\n        End If\n        Set rFoundCell = Nothing\n\n        'Next find the row by looking for dDate in column A.\n        Set rFoundCell = .Columns(\"A:A\").Cells.Find(What:=dDate, After:=.Cells(2, 1), LookIn:=xlValues, LookAt:=xlWhole, SearchDirection:=xlNext)\n        If Not rFoundCell Is Nothing Then\n            lRow = rFoundCell.Row\n        Else\n            lRow = LastCell(shtAnalysis).Row + 1\n        End If\n        Set rFoundCell = Nothing\n\n        'Place the data.\n        .Cells(lRow, 1).Value = dDate\n        .Cells(1, lColumn).Value = sItem\n        If .Cells(lRow, lColumn) = \"\" Then\n            .Cells(lRow, lColumn).NumberFormat = \"General\"\n            .Cells(lRow, lColumn) = 1\n        Else\n            .Cells(lRow, lColumn) = .Cells(lRow, lColumn) + 1\n        End If\n\n    End With\n\nEnd Sub\n\n' Purpose   : Finds the last cell containing data or a formula within the given worksheet.\n'             If the Optional Col is passed it finds the last row for a specific column.\n'---------------------------------------------------------------------------------------\nPublic Function LastCell(wrkSht As Worksheet, Optional Col As Long = 0) As Range\n\n    Dim lLastCol As Long, lLastRow As Long\n\n    On Error Resume Next\n\n    With wrkSht\n        If Col = 0 Then\n            lLastCol = .Cells.Find(\"*\", , , , xlByColumns, xlPrevious).Column\n            lLastRow = .Cells.Find(\"*\", , , , xlByRows, xlPrevious).Row\n        Else\n            lLastCol = .Cells.Find(\"*\", , , , xlByColumns, xlPrevious).Column\n            lLastRow = .Columns(Col).Find(\"*\", , , , xlByColumns, xlPrevious).Row\n        End If\n\n        If lLastCol = 0 Then lLastCol = 1\n        If lLastRow = 0 Then lLastRow = 1\n\n        Set LastCell = wrkSht.Cells(lLastRow, lLastCol)\n    End With\n    On Error GoTo 0\n\nEnd Function\n</code></pre>\n\n<p>This will give a result like:<br>\n<a href=\"https://i.stack.imgur.com/T4hDU.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/T4hDU.png\" alt=\"enter image description here\"></a></p>\n"}, {"comments": [{"owner": {"reputation": 9, "user_id": 7534805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51ad32998037fd70a47e6321e5146f70?s=128&d=identicon&r=PG&f=1", "display_name": "Katy", "link": "https://stackoverflow.com/users/7534805/katy"}, "edited": false, "score": 0, "creation_date": 1486721250, "post_id": 42145557, "comment_id": 71478506, "body": "Hi, this seems to do something, but never actually updates the figures with anything? Any ideas?"}, {"owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "reply_to_user": {"reputation": 9, "user_id": 7534805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51ad32998037fd70a47e6321e5146f70?s=128&d=identicon&r=PG&f=1", "display_name": "Katy", "link": "https://stackoverflow.com/users/7534805/katy"}, "edited": false, "score": 0, "creation_date": 1486735977, "post_id": 42145557, "comment_id": 71487811, "body": "Describe what happens when you step through to debug the code."}], "tags": [], "owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "is_accepted": false, "score": 0, "last_activity_date": 1486669642, "creation_date": 1486669642, "answer_id": 42145557, "question_id": 42114883, "link": "https://stackoverflow.com/questions/42114883/outlook-to-collate-amount-emails-received-on-certain-days/42145557#42145557", "title": "outlook to collate amount emails received on certain days", "body": "<p>The bigger error is: </p>\n\n<pre><code>On Error Resume Next\n' without\nOn Error GoTo 0\n' to stop bypassing errors.\n</code></pre>\n\n<p>The actual error is likely:</p>\n\n<pre><code>For i = 0 To UBound(arrEmailDates) - 1\n</code></pre>\n\n<p>The code could look like this:</p>\n\n<pre><code>Sub countMail()\n\n    ' Set Variables\n    Dim objOutlook As Object, objnSpace As Object, objFolder As Object\n    Dim EmailCount As Integer, DateCount As Integer, iCount As Integer\n    Dim myDate As Date\n    Dim arrEmailDates()\n\n    Dim i As Long\n    ' Get Outlook Object\n    Set objOutlook = CreateObject(\"Outlook.Application\")\n    Set objnSpace = objOutlook.GetNamespace(\"MAPI\")\n\n    ' Get Folder Object\n    On Error Resume Next\n    Set objFolder = objnSpace.Folders(\"Estates\").Folders(\"Bookings\")\n\n    If Err.Number &lt;&gt; 0 Then\n        Err.Clear\n        MsgBox \"No such folder.\"\n        Set objFolder = Nothing\n        Set objnSpace = Nothing\n        Set objOutlook = Nothing\n        Exit Sub\n    End If\n\n    On Error GoTo 0     ' Turn off error bypass as quickly as possible\n\n    ' Put ReceivedTimes in array\n    EmailCount = objFolder.items.Count\n\n    For iCount = 1 To EmailCount\n\n        With objFolder.items(iCount)\n\n            ReDim Preserve arrEmailDates(iCount - 1)\n\n            ' Bypass error on items without a received date\n            On Error Resume Next\n            arrEmailDates(iCount - 1) = DateSerial(Year(.ReceivedTime), Month(.ReceivedTime), Day(.ReceivedTime))\n            On Error GoTo 0     ' Turn off error bypass as quickly as possible\n\n        End With\n\n    Next iCount\n\n    'For i = 0 To UBound(arrEmailDates) - 1\n    For i = 0 To UBound(arrEmailDates)\n        Debug.Print i &amp; \" - \" &amp; arrEmailDates(i)\n    Next i\n\n    ' Clear Outlook objects\n    Set objFolder = Nothing\n    Set objnSpace = Nothing\n    Set objOutlook = Nothing\n\n    ' Count the emails dates equal to active cell\n    Sheets(\"test email count\").Range(\"e2\").Select\n    Do Until IsEmpty(ActiveCell)\n\n        DateCount = 0\n        myDate = ActiveCell.Value\n        Debug.Print \" mydate: \" &amp; myDate\n\n        'For i = 0 To UBound(arrEmailDates) - 1\n        For i = 0 To UBound(arrEmailDates)\n            If arrEmailDates(i) = myDate Then DateCount = DateCount + 1\n        Next i\n\n        Selection.Offset(0, 1).Activate\n        ActiveCell.Value = DateCount\n        Selection.Offset(1, -1).Activate\n\n    Loop\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 9, "user_id": 7534805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51ad32998037fd70a47e6321e5146f70?s=128&d=identicon&r=PG&f=1", "display_name": "Katy", "link": "https://stackoverflow.com/users/7534805/katy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 192, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1593307169, "creation_date": 1486561640, "last_edit_date": 1593307169, "question_id": 42114883, "link": "https://stackoverflow.com/questions/42114883/outlook-to-collate-amount-emails-received-on-certain-days", "title": "outlook to collate amount emails received on certain days", "body": "<p>I have a code that is supposed to go to an outlook folder, and count how many emails have come in for each date that week. </p>\n\n<p>but at the moment it just doesn't seem to be reading it properly!</p>\n\n<p>Last weeks data and what the code pulls in are as follows:</p>\n\n<pre><code>monday: 21 in folder - counts 10\ntuesday: 10 - 7\nwednesday: 10 -13\nthursday: 9 - 11\nfriday: 2 - 1\n</code></pre>\n\n<p>here is the code:</p>\n\n<pre><code>  ' Set Variables\nDim objOutlook As Object, objnSpace As Object, objFolder As Object\nDim EmailCount As Integer, DateCount As Integer, iCount As Integer\nDim myDate As Date\nDim arrEmailDates()\n\n' Get Outlook Object\nSet objOutlook = CreateObject(\"Outlook.Application\")\nSet objnSpace = objOutlook.GetNamespace(\"MAPI\")\n\n' Get Folder Object\nOn Error Resume Next\nSet objFolder = objnSpace.Folders(\"Estates\").Folders(\"Bookings\")\nIf Err.Number &lt;&gt; 0 Then\n    Err.Clear\n    MsgBox \"No such folder.\"\n    Set objFolder = Nothing\n    Set objnSpace = Nothing\n    Set objOutlook = Nothing\n    Exit Sub\nEnd If\n\n' Put ReceivedTimes in array\nEmailCount = objFolder.Items.Count\nFor iCount = 1 To EmailCount\n    With objFolder.Items(iCount)\n        ReDim Preserve arrEmailDates(iCount - 1)\n        arrEmailDates(iCount - 1) = DateSerial(Year(.ReceivedTime), Month(.ReceivedTime), Day(.ReceivedTime))\n    End With\nNext iCount\n\n' Clear Outlook objects\nSet objFolder = Nothing\nSet objnSpace = Nothing\nSet objOutlook = Nothing\n\n' Count the emails dates equal to active cell\nSheets(\"test email count\").Range(\"e2\").Select\nDo Until IsEmpty(ActiveCell)\n\n    DateCount = 0\n    myDate = ActiveCell.Value\n\n    For i = 0 To UBound(arrEmailDates) - 1\n        If arrEmailDates(i) = myDate Then DateCount = DateCount + 1\n    Next i\n\n    Selection.Offset(0, 1).Activate\n    ActiveCell.Value = DateCount\n    Selection.Offset(1, -1).Activate\nLoop\n</code></pre>\n\n<p>would anyone be able to tell me where i am going wrong? </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 3, "creation_date": 1486561347, "post_id": 42114685, "comment_id": 71397983, "body": "Try to uncheck the last one that is marked as <code>MISSING:</code> and rerun your code"}], "answers": [{"tags": [], "owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "is_accepted": true, "score": 1, "last_activity_date": 1486561995, "creation_date": 1486561995, "answer_id": 42115004, "question_id": 42114685, "link": "https://stackoverflow.com/questions/42114685/xlsm-created-with-excel-2010-cant-find-project-or-library-on-excel-2016/42115004#42115004", "title": "xlsm created with Excel 2010 - &quot;Can&#39;t find project or library&quot; on Excel 2016", "body": "<p>For office 2010 the location for ATPVBAEN.XLAM was C:\\Program Files\\Microsoft Office\\OFFICE14\\Library\\Analysis\\</p>\n\n<p>For Office 2016 (on windows 7) the location is now : C:\\Program Files (x86)\\Microsoft Office\\root\\Office16\\Library\\Analysis</p>\n\n<p>Just uncheck the missing refernce, close the file, re-open and  browse to new location  and set reference. </p>\n\n<p>You can also try to enable Analysis tool pack and it should make the addin available by default.</p>\n\n<p>File--> Add-Ins -->  Excel Add-Ins , Click Go... and check Analysis ToolPak-VBA</p>\n"}], "owner": {"reputation": 527, "user_id": 3647395, "user_type": "registered", "accept_rate": 32, "profile_image": "https://www.gravatar.com/avatar/298087ca02901691bedcc67cd09297c3?s=128&d=identicon&r=PG&f=1", "display_name": "Ian M", "link": "https://stackoverflow.com/users/3647395/ian-m"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 824, "favorite_count": 0, "accepted_answer_id": 42115004, "answer_count": 1, "score": 0, "last_activity_date": 1486561995, "creation_date": 1486561178, "last_edit_date": 1486561313, "question_id": 42114685, "link": "https://stackoverflow.com/questions/42114685/xlsm-created-with-excel-2010-cant-find-project-or-library-on-excel-2016", "title": "xlsm created with Excel 2010 - &quot;Can&#39;t find project or library&quot; on Excel 2016", "body": "<p>I have a VBA macro which was working fine in Excel 2010. When I run it in Excel 2016 I get \"Can't find project or library\" on the line starting \"nCashAdded = Application.InputBox\":</p>\n\n<pre><code>Sub InsertNewHistory()\nDim nCashAddedInPeriod As Long\n\nnCashAdded = Application.InputBox(\"Cash added in previous period:\", \"Cash In Period\", Type:=1)\n</code></pre>\n\n<p>Here are the references that I have set:</p>\n\n<p><a href=\"https://i.stack.imgur.com/Ldntp.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Ldntp.jpg\" alt=\"References\"></a></p>\n\n<p>Should I have any other references set?</p>\n"}, {"tags": ["vba", "email", "outlook"], "comments": [{"owner": {"reputation": 552, "user_id": 2381028, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/1855097c6c29ed8c62fc4c78bccd967e?s=128&d=identicon&r=PG", "display_name": "Shmukko", "link": "https://stackoverflow.com/users/2381028/shmukko"}, "edited": false, "score": 1, "creation_date": 1486560675, "post_id": 42114403, "comment_id": 71397522, "body": "can you try running it without On Error Resume Next? are there errors?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user5521159"}, "reply_to_user": {"reputation": 552, "user_id": 2381028, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/1855097c6c29ed8c62fc4c78bccd967e?s=128&d=identicon&r=PG", "display_name": "Shmukko", "link": "https://stackoverflow.com/users/2381028/shmukko"}, "edited": false, "score": 0, "creation_date": 1486562145, "post_id": 42114403, "comment_id": 71398617, "body": "no errors are coming at all. for one sender, it works perfectly but with another sender, it does not create the log file nor move the email to the intended folder, it just stays in the inbox."}, {"owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "edited": false, "score": 0, "creation_date": 1486583874, "post_id": 42114403, "comment_id": 71412950, "body": "Remove the misused On Error Resume Next whatever the outcome then try  And InStr(UCase(olMailItem.Subject), UCase(&quot;Exception Noted at FTD&quot;)) &gt; 0 Then"}, {"owner": {"user_type": "does_not_exist", "display_name": "user5521159"}, "reply_to_user": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "edited": false, "score": 0, "creation_date": 1486621873, "post_id": 42114403, "comment_id": 71426553, "body": "@niton, I have disabled the On Error Resume Next and added your Ucase but still the issues persist, although it still works for same sender except for other senders."}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user5521159"}, "is_accepted": false, "score": 0, "last_activity_date": 1486632813, "creation_date": 1486632813, "answer_id": 42132927, "question_id": 42114403, "link": "https://stackoverflow.com/questions/42114403/code-not-working-for-other-senders/42132927#42132927", "title": "Code Not Working For Other Senders", "body": "<p>Thank you guys for trying to help me out.  I have found the issue and this is now working perfectly for me.</p>\n\n<p>Earlier version:</p>\n\n<pre><code>If olMailItem.Attachments.Count = 0 _\n    And InStr(olMailItem.Subject, \"Exception Noted at FTD\") &gt; 0 Then\n</code></pre>\n\n<p>Corrected version:</p>\n\n<pre><code>If InStr(olMailItem.Subject, \"Exception Noted at FTD\") &gt; 0 Then\n</code></pre>\n\n<p>With this correction, the code now works for all incoming messages. I don't know why the attachment checking statement is causing the problem. Since I have mandated the staffs concerned to send the email without any attachment and instead put the content in the body itself, this would somehow resolve my issue. Again, thanks for the help.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user5521159"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 54, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1486632813, "creation_date": 1486560335, "last_edit_date": 1486619673, "question_id": 42114403, "link": "https://stackoverflow.com/questions/42114403/code-not-working-for-other-senders", "title": "Code Not Working For Other Senders", "body": "<p>I am creating a log file (text) whenever an email is received with a subject containing specific values and moving the email to a specific folder. The code works on one email sender and does not work when another sender sends with the same subject. The intention is that anyone sending an email with similar subject should be handled by the code. </p>\n\n<p>Below is the code in ThisOutlookSession.</p>\n\n<pre><code>Option Explicit\n\nPrivate WithEvents olInboxItems As Items\n\nPrivate Sub Application_Startup()\n    Set olInboxItems = Session.GetDefaultFolder(olFolderInbox).Items\nEnd Sub\n\nPrivate Sub olInboxItems_ItemAdd(ByVal Item As Object)\n\n    On Error Resume Next\n\n    Dim olMailItem As MailItem\n    Dim strAttachmentName As String\n\n    If TypeOf Item Is MailItem Then\n        Set olMailItem = Item\n\n        If olMailItem.Attachments.Count = 0 _\n        And InStr(olMailItem.Subject, \"Exception Noted at FTD\") &gt; 0 Then\n\n           'Create LogFile to a network folder\n            Dim strFile_Path As String\n\n            strFile_Path = \"\\\\10.53.66.30\\cbd\\Status\\\" &amp; olMailItem.SenderName + \"StaffLogfile.txt\"\n            Open strFile_Path For Append As #1\n            Write #1, Format(olMailItem.ReceivedTime, \"dd-mmm-yyyy | hh:mm | \") + olMailItem.SenderName + \" | \" + olMailItem.Subject\n            Close #1\n\n        End If\n\n        'Move to Exception Folder\n        Dim fldr As Outlook.MAPIFolder\n\n        If olMailItem.Attachments.Count = 0 _\n        And InStr(olMailItem.Subject, \"Exception Noted at FTD\") &gt; 0 Then\n           Set fldr = Outlook.Session.Folders(\"Archives\").Folders(\"Personal Folder\").Folders(\"FTD\").Folders(\"Exception Report\")\n                olMailItem.Move fldr\n        End If\n\n    End If\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1486559446, "post_id": 42113876, "comment_id": 71396619, "body": "The first formula works flawlessly for me - <code>=CLEAR(SUBSTITUTE(E5;&quot;\u2022&quot;;&quot;~&quot;))</code> Are you sure you are referencing correctly?"}, {"owner": {"reputation": 1595, "user_id": 4837035, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdfc11c275ff58678c9c6b7fa93d4119?s=128&d=identicon&r=PG&f=1", "display_name": "Zerk", "link": "https://stackoverflow.com/users/4837035/zerk"}, "edited": false, "score": 0, "creation_date": 1486560111, "post_id": 42113876, "comment_id": 71397095, "body": "Both approaches also work fine on my end, perhaps it is a character/encoding issue?"}, {"owner": {"reputation": 3907, "user_id": 4961700, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f80e4233c80b9ba42b3b39cf704804dc?s=128&d=identicon&r=PG&f=1", "display_name": "Solar Mike", "link": "https://stackoverflow.com/users/4961700/solar-mike"}, "edited": false, "score": 0, "creation_date": 1486570477, "post_id": 42113876, "comment_id": 71404739, "body": "Looking at the original and the answers, is the OP meant to be using commas as separators or semi-colons ? This will depend on his system settings..."}, {"owner": {"reputation": 11, "user_id": 7534545, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ajpYLXoepQw/AAAAAAAAAAI/AAAAAAAAABw/xJgKm6GTSq0/photo.jpg?sz=128", "display_name": "Anshuman saini", "link": "https://stackoverflow.com/users/7534545/anshuman-saini"}, "reply_to_user": {"reputation": 3907, "user_id": 4961700, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f80e4233c80b9ba42b3b39cf704804dc?s=128&d=identicon&r=PG&f=1", "display_name": "Solar Mike", "link": "https://stackoverflow.com/users/4961700/solar-mike"}, "edited": false, "score": 0, "creation_date": 1488874017, "post_id": 42113876, "comment_id": 72413401, "body": "@SolarMike : Thanks for your response could you please let me know where in the system setting ?"}, {"owner": {"reputation": 3907, "user_id": 4961700, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f80e4233c80b9ba42b3b39cf704804dc?s=128&d=identicon&r=PG&f=1", "display_name": "Solar Mike", "link": "https://stackoverflow.com/users/4961700/solar-mike"}, "edited": false, "score": 0, "creation_date": 1488874557, "post_id": 42113876, "comment_id": 72413672, "body": "system preferences : language and region : advanced : number separators at least that is where they are on a mac..."}], "owner": {"reputation": 11, "user_id": 7534545, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ajpYLXoepQw/AAAAAAAAAAI/AAAAAAAAABw/xJgKm6GTSq0/photo.jpg?sz=128", "display_name": "Anshuman saini", "link": "https://stackoverflow.com/users/7534545/anshuman-saini"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 306, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1487317542, "creation_date": 1486558834, "last_edit_date": 1531164843, "question_id": 42113876, "link": "https://stackoverflow.com/questions/42113876/how-to-replace-bullet-points-using-macro-in-excel", "title": "How to replace bullet points using macro in Excel", "body": "<p>I am new to VBA and stuck in one problem, I want to replace Bullet points in excel with the comma, and copy that cell to another workbook Excel.</p>\n\n<p>I have tried <code>CLEAN(SUBSTITUTE(E5,\"\u2022\",\"\"))</code> and <code>(Replace(str40, \"\u2022\", \",\"))</code> but both are not working.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 1, "creation_date": 1486559405, "post_id": 42113661, "comment_id": 71396582, "body": "It means that <code>&quot;Works template.xlsx&quot;</code> was not found. So it could be because it is not opened or because it is open in another instance of Excel! So was it opened when you try this?"}, {"owner": {"reputation": 75, "user_id": 7430783, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/14b68fdb945cc88001fc207ffb442c9b?s=128&d=identicon&r=PG&f=1", "display_name": "kira123", "link": "https://stackoverflow.com/users/7430783/kira123"}, "reply_to_user": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 0, "creation_date": 1486559998, "post_id": 42113661, "comment_id": 71397008, "body": "Thank you, it was supposed to be xlsm at the end, I don&#39;t know how I missed that. But, now I&#39;m getting &quot;Application-defined or object-defined error&quot; for the line Sht.Cells.Offset(0,3).Value = &quot;7.2&quot;"}, {"owner": {"reputation": 204, "user_id": 4443082, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/95b3ea234841839e9cbcd2af365c40ea?s=128&d=identicon&r=PG&f=1", "display_name": "bhnn", "link": "https://stackoverflow.com/users/4443082/bhnn"}, "edited": false, "score": 0, "creation_date": 1486560682, "post_id": 42113661, "comment_id": 71397526, "body": "Some of Excels errors aren&#39;t as descriptive by themselves as they should be. In cases like these, you should start by running your code in single-step mode (default key: F8) and tracking the variables your using (wb1, wb2, Sht, ws, Rng).   Do they all have an assigned value at their time of use? Is that value plausible? Are you assigning them a value that does not fit?  It&#39;s hard to debug this if we just have your code seeing as there could be a thousand things wrong with whatever your code reads in your workbooks."}, {"owner": {"reputation": 75, "user_id": 7430783, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/14b68fdb945cc88001fc207ffb442c9b?s=128&d=identicon&r=PG&f=1", "display_name": "kira123", "link": "https://stackoverflow.com/users/7430783/kira123"}, "edited": false, "score": 0, "creation_date": 1486562579, "post_id": 42113661, "comment_id": 71398966, "body": "Thank you for the reply, I will have a go at what you suggested to find the issue."}], "answers": [{"comments": [{"owner": {"reputation": 75, "user_id": 7430783, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/14b68fdb945cc88001fc207ffb442c9b?s=128&d=identicon&r=PG&f=1", "display_name": "kira123", "link": "https://stackoverflow.com/users/7430783/kira123"}, "edited": false, "score": 0, "creation_date": 1486562521, "post_id": 42114639, "comment_id": 71398916, "body": "Thank you, I will give that a go, but wouldn&#39;t this input the value in the same sheet? the values should be inputted in workbook &quot;works template&quot;, whereas the 1 is in workbook &quot;spreadsheet 2017&quot;"}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "reply_to_user": {"reputation": 75, "user_id": 7430783, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/14b68fdb945cc88001fc207ffb442c9b?s=128&d=identicon&r=PG&f=1", "display_name": "kira123", "link": "https://stackoverflow.com/users/7430783/kira123"}, "edited": false, "score": 0, "creation_date": 1486562776, "post_id": 42114639, "comment_id": 71399093, "body": "@kira123 : Mkay, I missed some parts indeed! Is the name on the same row in <code>Workbooks(&quot;Works template.xlsm&quot;).Worksheets(&quot;Template&quot;)</code>?"}, {"owner": {"reputation": 75, "user_id": 7430783, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/14b68fdb945cc88001fc207ffb442c9b?s=128&d=identicon&r=PG&f=1", "display_name": "kira123", "link": "https://stackoverflow.com/users/7430783/kira123"}, "edited": false, "score": 0, "creation_date": 1486562944, "post_id": 42114639, "comment_id": 71399201, "body": "the names are identical and in the same order, but start on a different row. In &quot;works template&quot; the list of names start on row 5, whereas in the the &quot;spreadsheet 2017&quot; it starts on row 7"}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "reply_to_user": {"reputation": 75, "user_id": 7430783, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/14b68fdb945cc88001fc207ffb442c9b?s=128&d=identicon&r=PG&f=1", "display_name": "kira123", "link": "https://stackoverflow.com/users/7430783/kira123"}, "edited": false, "score": 0, "creation_date": 1486563011, "post_id": 42114639, "comment_id": 71399251, "body": "@kira123 : So a -2 rows, would be enough! :) Let me a sec to update! ;)"}, {"owner": {"reputation": 75, "user_id": 7430783, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/14b68fdb945cc88001fc207ffb442c9b?s=128&d=identicon&r=PG&f=1", "display_name": "kira123", "link": "https://stackoverflow.com/users/7430783/kira123"}, "edited": false, "score": 0, "creation_date": 1486563634, "post_id": 42114639, "comment_id": 71399702, "body": "Your amazing!! thank you once again!! Does this mean that the list of name on &quot;works template&quot; doesn&#39;t have to identical anymore?"}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "reply_to_user": {"reputation": 75, "user_id": 7430783, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/14b68fdb945cc88001fc207ffb442c9b?s=128&d=identicon&r=PG&f=1", "display_name": "kira123", "link": "https://stackoverflow.com/users/7430783/kira123"}, "edited": false, "score": 1, "creation_date": 1486564174, "post_id": 42114639, "comment_id": 71400107, "body": "@kira123 : Nope, at the moment, this work only because your lists are identical with just an offset(), if they are not, you&#39;ll have to use the <code>Find</code> method (see : <a href=\"http://stackoverflow.com/a/30162390/4628637\">stackoverflow.com/a/30162390/4628637</a>)  and replace <code>sht.Range(cell.address).Offset(-2, 0).Offset(0, 0)</code> by <code>cF.Offset(0,1)</code> in the <code>Do</code> loop ;)"}], "tags": [], "owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "is_accepted": true, "score": 1, "last_activity_date": 1486563134, "last_edit_date": 1486563134, "creation_date": 1486561001, "answer_id": 42114639, "question_id": 42113661, "link": "https://stackoverflow.com/questions/42113661/vba-check-criteria-in-1-workbook-input-values-in-another-workbook/42114639#42114639", "title": "VBA check criteria in 1 workbook, input values in another workbook", "body": "<p><code>Sht.Cells</code> refers to all cells in the sheet, so you can't use <code>.Offset()</code> on this.</p>\n\n<pre><code>Sub Summary()\n\n    Dim wb1 As Workbook\n    Dim Sht As Worksheet\n    Dim Rng As Range\n    Dim wb2 As Workbook\n    Dim cell As Range\n    Dim ws As Worksheet\n\n    Set wb1 = Workbooks(\"Works template.xlsm\")\n    Set wb2 = Workbooks(\"Spreadsheet 2017\")\n    Set Sht = wb1.Worksheets(\"Template\") \n    Set ws = wb2.Worksheets(\"January\")\n    Set Rng = ws.Range(\"B7:B\" &amp; Sht.Cells(Sht.Rows.Count, \"B\").End(xlUp).Row)\n\n    For Each cell In Rng\n        If cell.Offset(0, 1).Value = \"1\" Then\n            sht.Range(cell.address).Offset(-2, 0).Offset(0, 0).Value = \"7.2\"\n            sht.Range(cell.address).Offset(-2, 0).Offset(0, 1).Value = \"3.9\"\n            sht.Range(cell.address).Offset(-2, 0).Offset(0, 2).Value = \"74.2\"\n        End If\n    Next\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 75, "user_id": 7430783, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/14b68fdb945cc88001fc207ffb442c9b?s=128&d=identicon&r=PG&f=1", "display_name": "kira123", "link": "https://stackoverflow.com/users/7430783/kira123"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 171, "favorite_count": 0, "accepted_answer_id": 42114639, "answer_count": 1, "score": 1, "last_activity_date": 1486563134, "creation_date": 1486558332, "last_edit_date": 1486560527, "question_id": 42113661, "link": "https://stackoverflow.com/questions/42113661/vba-check-criteria-in-1-workbook-input-values-in-another-workbook", "title": "VBA check criteria in 1 workbook, input values in another workbook", "body": "<p>I am struggling to figure out how to get the code to do what I want, I wrote as much as I could with what I could find online, but for some aspects, I don't know what write. </p>\n\n<p><strong>Purpose of the code</strong></p>\n\n<p>Check \"spreadsheet 2017\" for the number \"1\" next to each name. If there is a \"1\", then enter values in multiple cells in a row in another workbook called \"Dates template\" (in the same row as name in \"spreadsheet 2017\")</p>\n\n<p><strong>Details on what I would like it to do</strong></p>\n\n<ol>\n<li>Column A and B has list first name (A), and surname (B)</li>\n<li>Check through column C for \"1\", next to the names</li>\n<li>If there is a 1, then switch to workbook \"Dates Template\"</li>\n<li>find the same name in column A, and put the values 7.2 (col B), 3.9 (col C) and 74.2 (col D).</li>\n</ol>\n\n<p>This is the basic backbone of the code, in the future I will be looking to add additional conditions, such as 1 in column D for example as well 1 in column C. so maybe a case function would work better, then it would be easier to add in the future. I don't know which is better. </p>\n\n<p>In the code below I only wrote it to scan through the surnames in column B, because there are no duplicates. but in the future, it is likely that there will be names with the same surname, in which case first name will have to be read as well. This is where I'm confused on how to check both. </p>\n\n<p>A bonus would be if its possible to copy the list of names over to the \"Dates template\" and then input those values if the criteria is met. Because at the moment I manually type up the names onto the \"Date Template\" Spreadsheet. </p>\n\n<pre><code>Sub Summary()\n\n    Dim wb1 As Workbook\n    Dim Sht As Worksheet\n    Dim Rng As Range\n    Dim wb2 As Workbook\n    Dim cell As Range\n    Dim ws As Worksheet\n\n    Set wb1 = Workbooks(\"Works template.xlsm\")\n    Set wb2 = Workbooks(\"Spreadsheet 2017\")\n    Set Sht = wb1.Worksheets(\"Template\") \n    Set ws = wb2.Worksheets(\"January\")\n    Set Rng = ws.Range(\"B7:B\" &amp; Sht.Cells(Sht.Rows.Count, \"B\").End(xlUp).Row)\n\n    For Each cell In Rng\n        If cell.Offset(0, 2).Value = \"1\" Then\n            Sht.Cells.Offset(0, 3).Value = \"7.2\" '&lt;--- This is where I get the new error, \"Application-defined or object-defined error\"\n            Sht.Cells.Offset(0, 2).Value = \"3.9\"\n            Sht.Cells.Offset(0, 6).Value = \"74.2\"\n        End If\n    Next\nEnd Sub\n</code></pre>\n\n<p>Thanks a lot!</p>\n"}, {"tags": ["excel", "vba", "charts"], "answers": [{"comments": [{"owner": {"reputation": 4621, "user_id": 4709298, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/fe41ea7cc395df33b3ad744599248d80?s=128&d=identicon&r=PG&f=1", "display_name": "Preston", "link": "https://stackoverflow.com/users/4709298/preston"}, "reply_to_user": {"reputation": 95, "user_id": 5192866, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d39c3255ce535c49a02f2cb6cf06d607?s=128&d=identicon&r=PG&f=1", "display_name": "FredC", "link": "https://stackoverflow.com/users/5192866/fredc"}, "edited": false, "score": 0, "creation_date": 1486647826, "post_id": 42113801, "comment_id": 71442791, "body": "@FredC No worries, don&#39;t forget to hit the green tick next to the answer.  Hope it helps your son!"}], "tags": [], "owner": {"reputation": 4621, "user_id": 4709298, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/fe41ea7cc395df33b3ad744599248d80?s=128&d=identicon&r=PG&f=1", "display_name": "Preston", "link": "https://stackoverflow.com/users/4709298/preston"}, "is_accepted": true, "score": 1, "last_activity_date": 1486558641, "creation_date": 1486558641, "answer_id": 42113801, "question_id": 42113581, "link": "https://stackoverflow.com/questions/42113581/cant-refresh-a-chart-in-excel-vba-excel-2016/42113801#42113801", "title": "Can&#39;t refresh a chart in Excel VBA (Excel 2016)", "body": "<p>Sounds like a <code>DoEvents</code> problem. Just put DoEvents in your code like so:</p>\n\n<pre><code>...\nActiveSheet.ChartObjects(\"Chart 1\").Chart.Refresh\nDoEvents\nSleep (50)\n...\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 14076946, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94545fdeebc5f1ea4e51b7860769f580?s=128&d=identicon&r=PG&f=1", "display_name": "andrew g", "link": "https://stackoverflow.com/users/14076946/andrew-g"}, "is_accepted": false, "score": 0, "last_activity_date": 1597045001, "last_edit_date": 1597045001, "creation_date": 1597002188, "answer_id": 63330638, "question_id": 42113581, "link": "https://stackoverflow.com/questions/42113581/cant-refresh-a-chart-in-excel-vba-excel-2016/63330638#63330638", "title": "Can&#39;t refresh a chart in Excel VBA (Excel 2016)", "body": "<p>It's 2020 and am running Excel 2016 for MAC. I put this subroutine in my code (combined various items I found on the web) and got the chart to update each time the sub is called (be sure to define a cell in your worksheet as &quot;stepper&quot; so the counter data can be stored and updated).\nMy chart was auto-named &quot;chart 8&quot; by excel:</p>\n<pre><code>Sub ChartAnimation3()\n  Dim i As Double\n  For i = 0 To 1000 Step 500\n    ActiveSheet.Range(&quot;Stepper&quot;) = i\n    DoEvents\n    DoEvents\n  Next\n\nActiveSheet.ChartObjects(&quot;Chart 8&quot;).Chart.Refresh\nActiveSheet.ChartObjects(&quot;Chart 8&quot;).Activate\nActiveChart.Refresh\nDoEvents\n\nEnd Sub\n</code></pre>\n<p>There might be some items not needed in this code, but I'm a novice, and it worked, so I am satisfied.</p>\n"}], "owner": {"reputation": 95, "user_id": 5192866, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d39c3255ce535c49a02f2cb6cf06d607?s=128&d=identicon&r=PG&f=1", "display_name": "FredC", "link": "https://stackoverflow.com/users/5192866/fredc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2322, "favorite_count": 0, "accepted_answer_id": 42113801, "answer_count": 2, "score": 1, "last_activity_date": 1597045001, "creation_date": 1486558114, "question_id": 42113581, "link": "https://stackoverflow.com/questions/42113581/cant-refresh-a-chart-in-excel-vba-excel-2016", "title": "Can&#39;t refresh a chart in Excel VBA (Excel 2016)", "body": "<p>My son (15 y) is studying pendulum at school, physics lessons.  I am trying to help him with a simulated pendulum in Excel, using 2 points chart, one fix (where the \"cord\" of the pendulum is attached, one moving in time (the pendulum).</p>\n\n<p>Computations are ok, but I can't figure out why the chart is not refreshing: the \"pendulum\" does not move...  I read the multiple posts on stack overflow over refreshing an Excel chart, but none of them could help me solving it...  Any idea?</p>\n\n<p>Here is the code (OK, I am not a IT pro...!)</p>\n\n<pre><code>Option Explicit\nPublic Declare Sub Sleep Lib \"kernel32\" (ByVal dwMilliseconds As Long)\nConst g = 9.80665 'gravity constant\nConst PI = 3.14159265358979\n\nSub TestSimple()\n\n'Declare variables\nDim l 'lenght of pendulum\nDim T\u00f41 'start angle\nDim T\u00f4i 'angle of pendulum at time i\nDim x 'coordonnates of pendulum on x axis\nDim y 'coordonnates of pendulum on y axis\nDim Omega 'Sqr(g / l)\nDim t 'time\nDim s, phi\n\n\n'-1- Initialization of variables\nl = 0.7   'length is 70 cm\nOmega = Sqr(g / l)\nT\u00f41 = PI / 6 '30 degrees at start\n\n'**** NOTE ****\n'Equation of pendulum angle in function of time is\n'T\u00f4(t)=T\u00f41*cos(Wo.t) were Wo = sqrt(g/l) = Omega\n'**************\n\n\n'Calculation of time needed for 1 calculation\ns = Timer\nt = 2\nT\u00f4i = T\u00f41 * Cos(Omega * t)\nx = l * Sin(T\u00f4i)\ny = 1 - l * Cos(T\u00f4i)\n\n'paste x and y value into spreadsheet\nWorksheets(1).Range(\"A3\").Value = x\nWorksheets(1).Range(\"B3\").Value = y\n'refresh chart\nActiveSheet.ChartObjects(\"Chart 1\").Chart.Refresh\n\nphi = Timer - s\n\n\n'-2- Simulation for 10 seconds\nFor t = 0 To 10 Step phi\n\n    'position of pendulum in function of time\n        T\u00f4i = T\u00f41 * Cos(Omega * t)\n        x = l * Sin(T\u00f4i)\n        y = 1 - l * Cos(T\u00f4i)\n\n    'paste x and y in spreadsheet\n    Worksheets(1).Range(\"A3\").Value = x\n    Worksheets(1).Range(\"B3\").Value = y\n    'refresh of chart\n\n    ActiveSheet.ChartObjects(\"Chart 1\").Chart.Refresh\n\n    Sleep (50) 'let machine sleeps for 50 milliseconds, for a smoother look\nNext t\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["regex", "excel", "vba", "outlook", "pattern-matching"], "comments": [{"owner": {"reputation": 481661, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1486557810, "post_id": 42113424, "comment_id": 71395537, "body": "Try <code>The Serial Number\\s*([0-9a-zA-Z]{7})\\s*\\w+</code> if you just need <code>XXXX0XX</code>. If you need <code>XXXX0XX 0000000</code>, use <code>The Serial Number\\s*([0-9a-zA-Z]{7}\\s*\\w+)</code>"}, {"owner": {"reputation": 204, "user_id": 4443082, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/95b3ea234841839e9cbcd2af365c40ea?s=128&d=identicon&r=PG&f=1", "display_name": "bhnn", "link": "https://stackoverflow.com/users/4443082/bhnn"}, "edited": false, "score": 0, "creation_date": 1486558463, "post_id": 42113424, "comment_id": 71395969, "body": "When in doubt, use an online regex debugger (e.g. <a href=\"https://regex101.com/\" rel=\"nofollow noreferrer\">regex101.com</a>) to see if your pattern does what you think it does."}, {"owner": {"reputation": 481661, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1486564653, "post_id": 42113424, "comment_id": 71400468, "body": "@wittman: Instead of posting the entire code, you could just post the minimal complete verifiable example. What is the exact input and what is the expected output?"}], "answers": [{"comments": [{"owner": {"reputation": 225, "user_id": 5783057, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/67730c2f730fad68b89c395588c2243e?s=128&d=identicon&r=PG&f=1", "display_name": "wittman", "link": "https://stackoverflow.com/users/5783057/wittman"}, "edited": false, "score": 0, "creation_date": 1486563715, "post_id": 42113586, "comment_id": 71399770, "body": "Thank you for the link it is really helpful but the pattern didn&#39;t work"}, {"owner": {"reputation": 481661, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "reply_to_user": {"reputation": 225, "user_id": 5783057, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/67730c2f730fad68b89c395588c2243e?s=128&d=identicon&r=PG&f=1", "display_name": "wittman", "link": "https://stackoverflow.com/users/5783057/wittman"}, "edited": false, "score": 0, "creation_date": 1486564027, "post_id": 42113586, "comment_id": 71400001, "body": "Why? What did you get and what did you expect to get?"}, {"owner": {"reputation": 481661, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "reply_to_user": {"reputation": 225, "user_id": 5783057, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/67730c2f730fad68b89c395588c2243e?s=128&d=identicon&r=PG&f=1", "display_name": "wittman", "link": "https://stackoverflow.com/users/5783057/wittman"}, "edited": false, "score": 0, "creation_date": 1486564727, "post_id": 42113586, "comment_id": 71400524, "body": "Try <a href=\"https://regex101.com/r/jX2VOu/3\" rel=\"nofollow noreferrer\"><code>The Serial Number\\s+([a-zA-Z]{4}[0-9][a-zA-Z]{2}\\s+[0-9]{7})</code></a>."}], "tags": [], "owner": {"reputation": 481661, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "is_accepted": false, "score": 1, "last_activity_date": 1486558122, "creation_date": 1486558122, "answer_id": 42113586, "question_id": 42113424, "link": "https://stackoverflow.com/questions/42113424/pattern-in-email-body-not-exported-in-excel/42113586#42113586", "title": "Pattern in email body not exported in excel", "body": "<p>Note that in your pattern, you quantified the <em>group</em> rather than the character class, so you only capture each <code>[0-9a-zA-Z]</code> 7 times and only the last captured letter/digit is stored in <code>Submatch(1)</code>. You need to put the limiting quantifier inside the group:</p>\n\n<pre><code>The Serial Number+\\s*([0-9a-zA-Z]{7})\\s*\\w*\\s*\n                                 ^^^^\n</code></pre>\n\n<p>See the <a href=\"https://regex101.com/r/jX2VOu/1\" rel=\"nofollow noreferrer\">regex demo</a></p>\n\n<p>Actually, <code>\\s*\\w*\\s*</code> are not used in your current code and seem redundant.</p>\n"}, {"tags": [], "owner": {"reputation": 276, "user_id": 3752769, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91b8da84b24c97eaf05897d3b65d4909?s=128&d=identicon&r=PG&f=1", "display_name": "sn152", "link": "https://stackoverflow.com/users/3752769/sn152"}, "is_accepted": false, "score": 0, "last_activity_date": 1486558390, "creation_date": 1486558390, "answer_id": 42113688, "question_id": 42113424, "link": "https://stackoverflow.com/questions/42113424/pattern-in-email-body-not-exported-in-excel/42113688#42113688", "title": "Pattern in email body not exported in excel", "body": "<p>Try this. </p>\n\n<p>if your pattern is 4 letters, 1 number, 1 space, 7 numbers, 1 space, then use the below line</p>\n\n<pre><code>[a-zA-Z]{4}[0-9 ]{1}[0-9 ]{7}\n</code></pre>\n\n<p>if your pattern is 4 letters, 1 number, 2 letters, 1 space, 7 numbers, 1 space, then use the below line</p>\n\n<pre><code>[a-zA-Z]{4}[0-9]{1}[a-zA-Z ]{2}[0-9 ]{7}\n</code></pre>\n"}], "owner": {"reputation": 225, "user_id": 5783057, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/67730c2f730fad68b89c395588c2243e?s=128&d=identicon&r=PG&f=1", "display_name": "wittman", "link": "https://stackoverflow.com/users/5783057/wittman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 102, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1592694017, "creation_date": 1486557656, "last_edit_date": 1592694017, "question_id": 42113424, "link": "https://stackoverflow.com/questions/42113424/pattern-in-email-body-not-exported-in-excel", "title": "Pattern in email body not exported in excel", "body": "<p>I have a pattern in emails that i want to extract in a excel file.</p>\n\n<p>The Serial Number XXXX0XX 0000000<br>\n(4 letters, 1 number,2 letters, 1 space, 7 numbers, 1 space) </p>\n\n<p>Regex : \\s*([0-9a-zA-Z]{7})\\s*\\w*\\s*</p>\n\n<p>The problem is that it doesn't gets the whole pattern, it takes just the last 7 digits.</p>\n\n<pre><code>Dim Reg1 As RegExp\nDim M1 As MatchCollection\nDim M As Match\n\n    Set Reg1 = New RegExp\n\nWith Reg1\n    .pattern = \"The Serial Number+\\s*([0-9a-zA-Z]){7}\\s*\\w*\\s*\" \n    .Global = True\nEnd With\nIf Reg1.test(msg.Body) Then\n\n    Set M1 = Reg1.Execute(msg.Body)\n    For Each M In M1\n\n        Set rng = wks.Cells(i, j)\n\n        Dim strSubject As String\n        Debug.Print M.SubMatches(1)\n        strSubject = M.SubMatches(1)\n        rng.Value = strSubject\n        j = j + 1\n\n\n    Next\nEnd If\n</code></pre>\n\n<p>Where rng.Value is the cell from excel.</p>\n\n<p>Here is the entire code :</p>\n\n<pre><code>Sub SaveMessagesToExcel()\n\n\n    Dim appExcel As Excel.Application\n    Dim wkb As Excel.Workbook\n    Dim wks As Excel.Worksheet\n    Dim rng As Excel.Range\n    Dim strSheet As String\n    Dim i As Integer\n    Dim j As Integer\n    Dim lngCount As Long\n    Dim msg As Outlook.MailItem\n    Dim nms As Outlook.NameSpace\n    Dim fld As Outlook.MAPIFolder\n    Dim nColonCharIndex As Integer\n    Dim nBodyLength As Integer\n    Dim nNewLineCharIndex As Integer\n    Dim nOutputRow, nOutputColumn As Integer\n    Dim itm As Object\n    Dim strTitle As String\n    Dim strPrompt As String\n    strTemplatesPath = \"C:\\serials\\\"\n    strSheet = \"not valid.xlsm\"\n    strSheet = strTemplatesPath &amp; strSheet\n    Debug.Print \"Excel workbook: \" &amp; strSheet\n    If TestFileExists(strSheet) = False Then\n        strTitle = \"Worksheet file not found\"\n        strPrompt = strSheet &amp; _\n        \" not found; please copy Messages.xls to this folder and try again\"\n        MsgBox strPrompt, vbCritical + vbOKOnly, strTitle\n\n    End If\n\n    Set appExcel = CreateObject(\"Excel.Application\")\n    appExcel.Workbooks.Open (strSheet)\n    Set wkb = appExcel.ActiveWorkbook\n    Set wks = wkb.Sheets(1)\n    wks.Activate\n    wks.Range(\"A2:C300\").Cells.Clear\n    Set nms = Application.GetNamespace(\"MAPI\")\n    Const FOLDER_PATH = \"\\\\Mailbox - me\\Inbox\\serial\"\n    Set fld = OpenOutlookFolder(FOLDER_PATH)\n    If fld Is Nothing Then\n\n    End If\n\n\n    If fld.DefaultItemType &lt;&gt; olMailItem Then\n        MsgBox \"Folder does not contain mail messages\"\n\n    End If\n\n    lngCount = fld.Items.Count\n\n    If lngCount = 0 Then\n        MsgBox \"No messages to export\"\n\n    Else\n        Debug.Print lngCount &amp; \" messages to export\"\n    End If\n\n\n    i = 3\n\n    For Each itm In fld.Items\n        If itm.Class = olMail Then\n\n            Set msg = itm\n            i = i + 1\n\n            j = 1\n\n            Set rng = wks.Cells(i, j)\n            If InStr(1, msg.Body, \"is not valid\") Then rng.Value = msg.Subject\n            j = j + 1\n\n            Set rng = wks.Cells(i, j)\n            If InStr(1, msg.Body, \"is not valid\") Then rng.Value = msg.ReceivedTime\n            j = j + 1\n\n    Dim Reg1 As RegExp\n    Dim M1 As MatchCollection\n    Dim M As Match\n\n        Set Reg1 = New RegExp\n\n    With Reg1\n        .pattern = \"The Serial Number+([a-zA-Z]{4}[0-9]{1}[a-zA-Z]{2}[0-9]{7})\"  ' +\\s*\\w*\\s*\\w*\\s*  [a-zA-Z]{4}[0-9]{1}[a-zA-Z ]{2}[0-9 ]{7}  \\s*[a-zA-Z0-9]{7}\\s*[0-9]{7}\\s*\n        .Global = True\n    End With\n    If Reg1.test(msg.Body) Then\n\n        Set M1 = Reg1.Execute(msg.Body)\n\n\n            Set rng = wks.Cells(i, j)\n\n            Dim strSubject As String\n            Debug.Print M.SubMatches(1)\n            strSubject = M.SubMatches(1)\n            rng.Value = strSubject\n            j = j + 1\n\n    End If\n    End If\n    Next itm\n\n\n        wkb.Save\n        wkb.Close\n    MsgBox \"DONE\"\n\n    appExcel.Application.Visible = True\n    Set appExcel = GetObject(, \"Excel.Application\")\n    appExcel.Workbooks.Open (strSheet)\n    Set wkb = appExcel.ActiveWorkbook\n    Set wks = wkb.Sheets(1)\n    wks.Activate\n\n\nEnd Sub \n</code></pre>\n\n<p>If i use +\\s*(\\w*)\\s*(\\w*)\\s* it will write only the last 7 digits from the entire pattern. If i use ANYTHING else it just gives me object variable or with block variable not set (error 91) on line: Debug.Print M.SubMatches(1) </p>\n"}, {"tags": ["vba", "excel", "connection", "connection-string"], "answers": [{"comments": [{"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 1, "creation_date": 1486558088, "post_id": 42113498, "comment_id": 71395711, "body": "I think that you missed the point here : <i>location(s) where connections are used (sheet name or range would be useful)</i> The idea is to list the places in the workbook in which the connections are used"}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 1, "last_activity_date": 1486559524, "last_edit_date": 1486559524, "creation_date": 1486557866, "answer_id": 42113498, "question_id": 42113354, "link": "https://stackoverflow.com/questions/42113354/find-locations-where-connections-are-used-excel-vba/42113498#42113498", "title": "Find locations where connections are used Excel VBA", "body": "<p>The code looks like ok to me. Can you try it like this to see whether you have connections at all:</p>\n\n<pre><code>Public Sub TestMePlease()\n\n    Dim conn As WorkbookConnection\n\n    If ActiveWorkbook.Connections.Count &gt; 0 Then\n        For Each conn In ActiveWorkbook.Connections\n            Debug.Print conn.Name\n        Next conn\n    Else\n        Debug.Print \"No connection found\"\n    End If\n\nEnd Sub\n</code></pre>\n\n<p>Edit:\nMore information about connection is in the library. To see it, press ctrl + space like this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/4DX25.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/4DX25.png\" alt=\"enter image description here\"></a></p>\n\n<p>Concerning the sheet name, it is here:</p>\n\n<pre><code>    Debug.Print conn.Ranges.Item(1).Parent.Name\n</code></pre>\n\n<p>Concerning the connection string, Microsoft would not give you a possibility to access such information from VBA. If it is available it should be a giant security problem.</p>\n"}, {"comments": [{"owner": {"reputation": 65, "user_id": 7374678, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/34f5418f582d13289ffc8eede81e6fc4?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle Gorf", "link": "https://stackoverflow.com/users/7374678/kyle-gorf"}, "edited": false, "score": 0, "creation_date": 1486559508, "post_id": 42113970, "comment_id": 71396656, "body": "Thanks R3uK , that&#39;s exactly what I needed. I couldn&#39;t see how to use the range object."}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "reply_to_user": {"reputation": 65, "user_id": 7374678, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/34f5418f582d13289ffc8eede81e6fc4?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle Gorf", "link": "https://stackoverflow.com/users/7374678/kyle-gorf"}, "edited": false, "score": 0, "creation_date": 1486559676, "post_id": 42113970, "comment_id": 71396785, "body": "@KyleGorf : you are welcome! Just to see how this works, place a breakpoint in the loop, and right click on <code>wC</code>, and <b>add a spy</b>! Now you can browse it to see how the data inside is structured! ;)"}], "tags": [], "owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "is_accepted": true, "score": 6, "last_activity_date": 1486559078, "creation_date": 1486559078, "answer_id": 42113970, "question_id": 42113354, "link": "https://stackoverflow.com/questions/42113354/find-locations-where-connections-are-used-excel-vba/42113970#42113970", "title": "Find locations where connections are used Excel VBA", "body": "<p>Expected output :</p>\n\n<pre><code>(Connection's Name): Sheet'sName|1st Cell of Range\nConnection's ODBC Command Text\n(Connection's Name): Sheet'sName|1st Cell of 1st Range // Sheet'sName|1st Cell of 2nd Range\n</code></pre>\n\n<p>Here you go :</p>\n\n<pre><code>Private Sub List_Connections_Ranges()\n\nDim wC As WorkbookConnection\nDim rG As Range\nDim TpStr As String\n\nFor Each wC In ActiveWorkbook.Connections\n    TpStr = \"(\" &amp; wC.Name &amp; \") found on : \"\n    For Each rG In wC.Ranges\n        TpStr = TpStr &amp; rG.Parent.Name &amp; \"|\" &amp; rG.Cells(1, 1).Address(0, 0) &amp; \" // \"\n    Next rG\n    Debug.Print Left(TpStr, Len(TpStr) - 4)\n    Debug.Print wC.ODBCConnection.CommandText\nNext wC\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 65, "user_id": 7374678, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/34f5418f582d13289ffc8eede81e6fc4?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle Gorf", "link": "https://stackoverflow.com/users/7374678/kyle-gorf"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3697, "favorite_count": 0, "accepted_answer_id": 42113970, "answer_count": 2, "score": 3, "last_activity_date": 1486559524, "creation_date": 1486557459, "question_id": 42113354, "link": "https://stackoverflow.com/questions/42113354/find-locations-where-connections-are-used-excel-vba", "title": "Find locations where connections are used Excel VBA", "body": "<p>I have a raft of Excel 2013 workbooks that I have to refine, each with multiple sheets and multiple data connections and I am looking for a quick way to list:</p>\n\n<ul>\n<li>connection name</li>\n<li>connection string</li>\n<li>location(s) where connections are used (sheet name or range would be useful)</li>\n</ul>\n\n<p>I can see all this information in the connections dialogs but am having trouble tracking them down programmatically. I want to do this one file at a time so am not worried about running code across all the files, just something I can drop in a module as I start work on the file concerned. So far I have found this on this site:</p>\n\n<pre><code>Dim conn As WorkbookConnection\nFor Each conn In ActiveWorkbook.Connections\nDebug.Print conn.Name\nNext conn\n</code></pre>\n\n<p>but I can't find the location information to go alongside this. Any pointers would be very gratefully received.</p>\n\n<p>Cheers</p>\n\n<p>Kyle</p>\n"}, {"tags": ["excel", "ms-access", "vba"], "comments": [{"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1486556973, "post_id": 42113082, "comment_id": 71394922, "body": "Are you sure that before starting the macro you do not have any other <code>Excel</code> running?"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1486557077, "post_id": 42113082, "comment_id": 71394997, "body": "You can try by adding <code>Application.Quit</code> in stead of <code>XL.Quit</code> just to see how it would work."}, {"owner": {"reputation": 6188, "user_id": 5339178, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5DL9b.jpg?s=128&g=1", "display_name": "Sergey S.", "link": "https://stackoverflow.com/users/5339178/sergey-s"}, "edited": false, "score": 0, "creation_date": 1486557695, "post_id": 42113082, "comment_id": 71395449, "body": "Also try to save changed workbook explicitly before closing"}, {"owner": {"reputation": 1148, "user_id": 7231593, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kvB-QD-A2Xs/AAAAAAAAAAI/AAAAAAAAAE4/LRTmHQQqx44/photo.jpg?sz=128", "display_name": "John Muggins", "link": "https://stackoverflow.com/users/7231593/john-muggins"}, "edited": false, "score": 0, "creation_date": 1486560446, "post_id": 42113082, "comment_id": 71397325, "body": "Put the command Application.Quit after your close command"}, {"owner": {"reputation": 49, "user_id": 3324308, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EstxT.jpg?s=128&g=1", "display_name": "Cinetyk", "link": "https://stackoverflow.com/users/3324308/cinetyk"}, "reply_to_user": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 1, "creation_date": 1486565869, "post_id": 42113082, "comment_id": 71401439, "body": "@Vityata: Yes, Excel.exe was not running nor showing in Task Manager prior to running the Sub in Access.  Using Application.Quit quits MS Access, which is not desired. Though, that does make &quot;EXCEL.EXE&quot; disappear from the Task Manager, which makes sense since it&#39;s Access that&#39;s not closing Excel properly because my Sub isn&#39;t right."}, {"owner": {"reputation": 49, "user_id": 3324308, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EstxT.jpg?s=128&g=1", "display_name": "Cinetyk", "link": "https://stackoverflow.com/users/3324308/cinetyk"}, "reply_to_user": {"reputation": 6188, "user_id": 5339178, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5DL9b.jpg?s=128&g=1", "display_name": "Sergey S.", "link": "https://stackoverflow.com/users/5339178/sergey-s"}, "edited": false, "score": 0, "creation_date": 1486565873, "post_id": 42113082, "comment_id": 71401445, "body": "@SergeyS. Using &quot;XL.ActiveWorkbook.Save&quot; explicitly didn&#39;t solve my problem."}], "answers": [{"comments": [{"owner": {"reputation": 49, "user_id": 3324308, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EstxT.jpg?s=128&g=1", "display_name": "Cinetyk", "link": "https://stackoverflow.com/users/3324308/cinetyk"}, "edited": false, "score": 1, "creation_date": 1486566176, "post_id": 42114289, "comment_id": 71401655, "body": "Gustav, that did it. Thanks a lot. Looking at your answer, now, it makes sense: declaring objects explicity makes it so I can &quot;close&quot; and Set them to nothing explicity. I was leaving using some variables defined implicity and thus those weren&#39;t being &quot;closed&quot;, probably the links to them in memory remained.   I&#39;m learning VBA as I go, this was a good lesson, thanks a lot again. Also thanks for everyone that took the time to read and comment."}, {"owner": {"reputation": 28384, "user_id": 648265, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/4d98e414a47934d66cb78bf73d0845ba?s=128&d=identicon&r=PG", "display_name": "ivan_pozdeev", "link": "https://stackoverflow.com/users/648265/ivan-pozdeev"}, "edited": false, "score": 0, "creation_date": 1538261100, "post_id": 42114289, "comment_id": 92082627, "body": "Upvoted the comment instead of the answer because it explains the cause while the answer doesn&#39;t. Without explaining the error mechanism, the answer is useless because you&#39;ll never know if you eliminated the error and which of the lines did it."}], "tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": true, "score": 2, "last_activity_date": 1486568274, "last_edit_date": 1486568274, "creation_date": 1486559966, "answer_id": 42114289, "question_id": 42113082, "link": "https://stackoverflow.com/questions/42113082/excel-application-object-quit-leaves-excel-exe-running/42114289#42114289", "title": "Excel.Application Object .Quit leaves EXCEL.EXE running", "body": "<p>Declare and use a specific <em>Workbook</em> object - as you do for <em>Worksheet</em> and <em>Range</em>, like this:</p>\n\n<pre><code>    Dim xls \u00a0 \u00a0 As Excel.Application\n\u00a0 \u00a0 Dim wkb \u00a0 \u00a0 As Excel.Workbook\n\u00a0 \u00a0 Dim wks \u00a0 \u00a0 As Excel.Worksheet\n    Dim rng     As Range\n\u00a0 \u00a0 \n\u00a0 \u00a0 Set xls = New Excel.Application\n\u00a0 \u00a0 Set wkb = xls.Workbooks.Open(\"c:\\test\\workbook1.xlsx\")\n\u00a0 \u00a0 Set wks = wkb.Worksheets(1)\n    Set rng = wks.Range(&lt;something&gt;)\n\u00a0 \u00a0 \n    ' Do stuff.\n\u00a0 \u00a0 wks.Name = \"My New Name\"\n    With rng\n         ' Do more.\n    End With\n\n\u00a0 \u00a0 wkb.Close True\n\u00a0 \u00a0 \n    Set rng = Nothing\n\u00a0 \u00a0 Set wks = Nothing\n\u00a0 \u00a0 Set wkb = Nothing\n\u00a0 \u00a0 \n\u00a0 \u00a0 xls.Quit\n\u00a0 \u00a0 \n\u00a0 \u00a0 Set xls = Nothing\n</code></pre>\n\n<p>Also, don't use Select, that's for visible use only. Define ranges instead.</p>\n\n<hr>\n\n<p>Cinetyk's EDIT:</p>\n\n<p>Using @Gustav 's indications, the code that does what I wanted and solves the problem is:</p>\n\n<pre><code>Sub changeXLcolumnFormatting()\n\nDim XL As Excel.Application\nDim sht As Excel.Worksheet\nDim wkb As Excel.Workbook\nDim rng As Range\n\nSet XL = New Excel.Application\nXL.Visible = False\nXL.DisplayAlerts = False\n\nSet wkb = XL.Workbooks.Open(\"C:\\Users\\640344\\Desktop\\rawDataTest.XLSX\")\nSet sht = wkb.Worksheets(1)\n\nDim i As Integer, j As Integer\n\nfield_names = Split(\"datasistema|Data de Registo|Data Registo CMVM\", \"|\")\nend_of_table = sht.UsedRange.Columns.Count\n\nFor j = 0 To UBound(field_names)\n    For i = 1 To end_of_table\n        Set rng = sht.Cells(1, i)\n        If InStr(rng.Text, field_names(j)) &gt; 0 Then\n            sht.Columns(i).NumberFormat = \"yyyy-mm-dd  HH:MM:ss\"\n        End If\n    Next i\nNext j\n\nwkb.Close (True)\nSet rng = Nothing\nSet sht = Nothing\n\nXL.Quit\nSet XL = Nothing\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 49, "user_id": 3324308, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EstxT.jpg?s=128&g=1", "display_name": "Cinetyk", "link": "https://stackoverflow.com/users/3324308/cinetyk"}, "edited": false, "score": 0, "creation_date": 1486646702, "post_id": 42116918, "comment_id": 71441979, "body": "welcome, @Cinetyk. Unfortunately, it does not work exactly as in C#, where the <code>Using()</code> would take care to fully destroy and release the object, but it is still nice."}, {"owner": {"reputation": 49, "user_id": 3324308, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EstxT.jpg?s=128&g=1", "display_name": "Cinetyk", "link": "https://stackoverflow.com/users/3324308/cinetyk"}, "edited": false, "score": 1, "creation_date": 1486655286, "post_id": 42116918, "comment_id": 71448281, "body": "But on running it MS Access, excel.exe doesn&#39;t remain in background after using that code, so it works for me."}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 49, "user_id": 3324308, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EstxT.jpg?s=128&g=1", "display_name": "Cinetyk", "link": "https://stackoverflow.com/users/3324308/cinetyk"}, "edited": false, "score": 0, "creation_date": 1486655484, "post_id": 42116918, "comment_id": 71448429, "body": "@Cinetyk - Because you have the <code>.Quit</code> in the code. But in the best case scenario, if VBA was a bit better, it should have closed by itself, without needing the <code>.Quit</code>."}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 1, "last_activity_date": 1506028903, "last_edit_date": 1506028903, "creation_date": 1486566918, "answer_id": 42116918, "question_id": 42113082, "link": "https://stackoverflow.com/questions/42113082/excel-application-object-quit-leaves-excel-exe-running/42116918#42116918", "title": "Excel.Application Object .Quit leaves EXCEL.EXE running", "body": "<p>Here is a fancy way to solve that problem - using <code>with new Excel.Application</code>:</p>\n\n<pre><code>Option Compare Database\nOption Explicit\n\nPublic Sub TestMe()\n\n    Dim wkb     As Object\n    Dim wks     As Object\n\n    With New Excel.Application\n\n        Set wkb = .Workbooks.Open(\"C:\\Users\\vityata\\Desktop\\myTest.xlsx\")\n        Set wks = wkb.Worksheets(1)\n\n        wkb.Close True\n\n        Set wks = Nothing\n        Set wkb = Nothing\n        .Quit\n\n    End With\n\nEnd Sub\n</code></pre>\n\n<p>In C# this is a standard with <code>Using</code>, in VBA very few people use it - I have never seen it production code. </p>\n\n<hr>\n\n<p>Cinetyk's EDIT:</p>\n\n<p>Using Vityata's indications, the code that works as I intended is:</p>\n\n<pre><code>Option Compare Database\nOption Explicit\n\nPublic Sub changeXLcolumnFormattingV2()\n\nDim sht As Object\nDim wkb As Object\n\nWith New Excel.Application\n    .Visible = False\n    .DisplayAlerts = False\n\n    Set wkb = .Workbooks.Open(\"C:\\Users\\640344\\Desktop\\rawDataTESTING.XLSX\")\n    Set wks = wkb.Worksheets(1)\n\n    field_names = Split(\"datasistema|Data de Registo|Data Registo CMVM\", \"|\")\n    end_of_table = wks.UsedRange.Columns.Count\n\n    For j = 0 To UBound(field_names)\n        For i = 1 To end_of_table\n            Set rng = wks.Cells(1, i)\n            If InStr(rng.Text, field_names(j)) &gt; 0 Then\n                wks.Columns(i).NumberFormat = \"yyyy-mm-dd  HH:MM:ss\"\n            End If\n        Next i\n    Next j\n\n    wkb.Close True\n\n    Set wks = Nothing\n    Set wkb = Nothing\n    .Quit\n\nEnd With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 49, "user_id": 3324308, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EstxT.jpg?s=128&g=1", "display_name": "Cinetyk", "link": "https://stackoverflow.com/users/3324308/cinetyk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 12644, "favorite_count": 1, "accepted_answer_id": 42114289, "answer_count": 2, "score": 3, "last_activity_date": 1506028903, "creation_date": 1486556732, "question_id": 42113082, "link": "https://stackoverflow.com/questions/42113082/excel-application-object-quit-leaves-excel-exe-running", "title": "Excel.Application Object .Quit leaves EXCEL.EXE running", "body": "<p>I'm working within MS Access 2013 on Windows 10 and I'm simply trying to write a Sub that opens an Excel file on disk, changes the column formatting and some columns, saves and quits. \nThe Sub runs and does as intended, but the problem is that even after the .Quit command, \"EXCEL.EXE\" keeps running and subsequent calls to that Sub will result in run-time errors. \nIf I close Access after running the sub, \"EXCEL.EXE\" disappears on the Task Manager, but not if I do \"Compact and Repair\" the database.</p>\n\n<p>I've done one other Sub that simply opens an Excel file on disk and alters te width of all columns to \"auto-width\", then closes, which works fine and doesn't leave \"EXCEL.EXE\" running.</p>\n\n<p>What am I doing wrong? Is it possible in VBA to make sure that \"EXCEL.EXE\" correctly quits?</p>\n\n<p>I tried a lot of different line order on Dims and Sets to Nothing, Workbook Closes, etc etc. Also, I searched here and on other sites on how to solve this, but after 2h the only suggestions I've seen for VBA is using something like ThisWorkbook.Saved = True, but I tried that before and after .Quit to no effect.\nOther than that, I only find solutions for VB.NET or other environments that I'm not using and now next to nothing of.</p>\n\n<p>Thanks for reading this.</p>\n\n<p>Code follows:</p>\n\n<pre><code>Sub changeXLcolumnFormatting()\n\nDim XL As Object\nSet XL = CreateObject(\"Excel.Application\")\nXL.Visible = False\nXL.DisplayAlerts = False\nXL.Workbooks.Open \"C:\\Users\\640344\\Desktop\\rawDataTest.XLSX\"\nDim sht As Worksheet\n\nWith XL\nSet sht = ActiveWorkbook.Worksheets(1)\n\nDim rng As Range\nDim i As Integer, j As Integer\n\nfield_names = Split(\"datasistema|Data de Registo|Data Registo CMVM\", \"|\")\nsht.Select\nend_of_table = sht.UsedRange.Columns.Count\n\nFor j = 0 To UBound(field_names)\n    For i = 1 To end_of_table\n        Set rng = sht.Cells(1, i)\n        If InStr(rng.Text, field_names(j)) &gt; 0 Then\n            sht.Columns(i).NumberFormat = \"yyyy-mm-dd  HH:MM:ss\"\n        End If\n    Next i\nNext j\n\nEnd With\n\nSet rng = Nothing\nSet sht = Nothing\nXL.ActiveWorkbook.Close (True)\n\nXL.Quit\nSet XL = Nothing\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["html", "excel", "vba"], "comments": [{"owner": {"reputation": 4114, "user_id": 5751805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da1c3545802a510a9b283f706d74283a?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan", "link": "https://stackoverflow.com/users/5751805/jordan"}, "edited": false, "score": 0, "creation_date": 1486558677, "post_id": 42113004, "comment_id": 71396105, "body": "If <code>i = 4</code>, you are clicking the 5th element as you&#39;re using the index rather than the occurrence of that element. Try looping through all the <code>Input</code> elements and <code>Debug.Print</code> their <code>outerHTML</code>"}, {"owner": {"reputation": 367, "user_id": 7325296, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/53c7dc31dab598186da3730f18197086?s=128&d=identicon&r=PG&f=1", "display_name": "sagar", "link": "https://stackoverflow.com/users/7325296/sagar"}, "reply_to_user": {"reputation": 4114, "user_id": 5751805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da1c3545802a510a9b283f706d74283a?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan", "link": "https://stackoverflow.com/users/5751805/jordan"}, "edited": false, "score": 0, "creation_date": 1486559884, "post_id": 42113004, "comment_id": 71396935, "body": "@Jordan Sir, I have tried looping through all the Input elements.but still I am getting the same result, while 4th and 5th loop same window of 4th  element has been appeared twice.please help"}, {"owner": {"reputation": 1148, "user_id": 7231593, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kvB-QD-A2Xs/AAAAAAAAAAI/AAAAAAAAAE4/LRTmHQQqx44/photo.jpg?sz=128", "display_name": "John Muggins", "link": "https://stackoverflow.com/users/7231593/john-muggins"}, "edited": false, "score": 1, "creation_date": 1486560777, "post_id": 42113004, "comment_id": 71397582, "body": "Put the html code here for the login button.  I don&#39;t understand what you mean by co-related.  If an input field is being used as a button then it probably has javascript controlling it."}, {"owner": {"reputation": 367, "user_id": 7325296, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/53c7dc31dab598186da3730f18197086?s=128&d=identicon&r=PG&f=1", "display_name": "sagar", "link": "https://stackoverflow.com/users/7325296/sagar"}, "reply_to_user": {"reputation": 4114, "user_id": 5751805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da1c3545802a510a9b283f706d74283a?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan", "link": "https://stackoverflow.com/users/5751805/jordan"}, "edited": false, "score": 0, "creation_date": 1486616042, "post_id": 42113004, "comment_id": 71424445, "body": "@Jordan Sir, I have Updated My Question with HTML codes."}], "owner": {"reputation": 367, "user_id": 7325296, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/53c7dc31dab598186da3730f18197086?s=128&d=identicon&r=PG&f=1", "display_name": "sagar", "link": "https://stackoverflow.com/users/7325296/sagar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 52, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1486615989, "creation_date": 1486556508, "last_edit_date": 1486615989, "question_id": 42113004, "link": "https://stackoverflow.com/questions/42113004/repetition-while-execution-of-getelementsbytagname-code", "title": "Repetition while execution of getElementsByTagName code", "body": "<p>Respected Expert, In my URL HTML code the <strong>input</strong> Element is available 5 times,And the Element has been counted as 0 to 4. I want to click <strong>login Button</strong> which is co-related with 4th input element html code. So My Query is if I assigned the value of <strong>i = 3 or i = 4</strong> in both the cases i got the same result which executed the code of 3rd input element code,where I required to execute the 4 input element code which help me to click on <strong>login Button</strong>.In-short My code is stuck on 3rd element button only and not allow me use the further element html code to execute my query.please help me....</p>\n\n<pre><code> Sub GoToWebsiteTest()\n    Dim appIE As InternetExplorerMedium\n    Dim tags As Object\n    Dim tagx As Object\n    Dim Element As HTMLButtonElement\n    i = 4\n    Set appIE = New InternetExplorerMedium\n    sURL = \"http://myurl/blink/\"\n    With appIE\n        .navigate sURL\n            .Visible = True\n        End With\n\n        Do While appIE.Busy Or appIE.READYSTATE &lt;&gt; 4\n            DoEvents\n        Loop\n\n            appIE.document.getElementById(\"Username\").Value = \"xxx\"\n            appIE.document.getElementById(\"Pwd\").Value = \"xxxx\"\n           Set tags = appIE.document.getElementsByTagName(\"Input\")\n           tags(i).Click\n</code></pre>\n\n<p>Dear Sir Please find the Below HTML code which contain the 5 input Elements and As u check the 2nd last element is belongs to error massage so as I mention even I assigned the value of <strong>i = 3 or i = 4</strong> in both the cases the <strong>error massage</strong> button is executed and I am not able to execute the last element button of login.</p>\n\n<pre><code>&lt;input type=\"hidden\" name=\"dummyField\" id=\"dummyField\" value=\"\"&gt;\n\n&lt;input id=\"userName\" name=\"userName\" title=\"Username\" autocomplete=\"off\" onkeypress=\"if(event.keyCode == 13)\n{if(!(document.loginForm.userName.value=='')){document.loginForm.dummyField.value='dummyvalue';}\nelse{document.loginForm.dummyField.value='';}}\"&gt;\n\n\n&lt;input type=\"password\" id=\"pwd\" name=\"pwd\" autocomplete=\"off\" onkeypress=\"if(event.keyCode == 13)\n{if(!(document.loginForm.pwd.value=='' || document.loginForm.userName.value=='' )){return submitenter(this,event)\n;}else if(!(document.loginForm.pwd.value=='' &amp;amp;&amp;amp; document.loginForm.userName.value=='' )){document.loginForm.dummyField.value='dummyValue';}\nelse{document.loginForm.dummyField.value='';}}if(!event.keyCode == 13){if(!(document.loginForm.pwd.value=='' &amp;amp;&amp;amp; document.loginForm.userName.value=='' ))\n{document.loginForm.dummyField.value='dummyValue';}else{document.loginForm.dummyField.value='';}}\"&gt;\n\n&lt;label class=\"errormessage\"&gt;&lt;/label&gt;\n&lt;div style=\"display: none;\"&gt;\n&lt;input type=\"submit\"&gt;\n\n&lt;button onclick=\"if(!(document.loginForm.pwd.value=='' || document.loginForm.userName.value=='' ))\n{ document.loginForm.pwd.value= hex_sha1(document.loginForm.pwd.value);document.loginForm.pwd.value= hex_sha1\n(document.loginForm.pwd.value+'HtfWAXkcpfff');javascript:document.loginForm.submit();}validateMandatoryFields();\"&gt;Login&lt;/button&gt;\n&lt;div style=\"display: none;\"&gt;\n&lt;input type=\"submit\"&gt;\n</code></pre>\n"}, {"tags": ["vba", "excel", "excel-formula"], "comments": [{"owner": {"reputation": 2954, "user_id": 6387479, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MU0ok.jpg?s=128&g=1", "display_name": "Glitch_Doctor", "link": "https://stackoverflow.com/users/6387479/glitch-doctor"}, "edited": false, "score": 1, "creation_date": 1486556779, "post_id": 42112818, "comment_id": 71394777, "body": "There is a way to do this in VBA, but it will take you some research. Look at IE automation, web parsing / web scraping and see what you can knock up. Happy to help you out once you have something to work with."}, {"owner": {"reputation": 2176, "user_id": 2846794, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/muUw2.png?s=128&g=1", "display_name": "Godinall", "link": "https://stackoverflow.com/users/2846794/godinall"}, "reply_to_user": {"reputation": 2954, "user_id": 6387479, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MU0ok.jpg?s=128&g=1", "display_name": "Glitch_Doctor", "link": "https://stackoverflow.com/users/6387479/glitch-doctor"}, "edited": false, "score": 0, "creation_date": 1486558454, "post_id": 42112818, "comment_id": 71395963, "body": "Thanks @Glitch_Doctor, I can get vba to do one cell, but I don&#39;t know how to get all cells automatically. I know PHP but VBA is not my back yard."}, {"owner": {"reputation": 2954, "user_id": 6387479, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MU0ok.jpg?s=128&g=1", "display_name": "Glitch_Doctor", "link": "https://stackoverflow.com/users/6387479/glitch-doctor"}, "edited": false, "score": 0, "creation_date": 1486561961, "post_id": 42112818, "comment_id": 71398469, "body": "Ah I see, that would be by using a loop and a counter. quite a bit of work but I see you got a sweet UDF from @AxelRichter that is much better than going through the pain of all that."}, {"owner": {"reputation": 2176, "user_id": 2846794, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/muUw2.png?s=128&g=1", "display_name": "Godinall", "link": "https://stackoverflow.com/users/2846794/godinall"}, "reply_to_user": {"reputation": 2954, "user_id": 6387479, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MU0ok.jpg?s=128&g=1", "display_name": "Glitch_Doctor", "link": "https://stackoverflow.com/users/6387479/glitch-doctor"}, "edited": false, "score": 0, "creation_date": 1486566616, "post_id": 42112818, "comment_id": 71401967, "body": "Hi @Glitch_Doctor, thanks for your  help anyway. Yes Axel Richter did provide a very good solution, I only need to tweak my forms a little bit and all should work seamlessly."}], "answers": [{"comments": [{"owner": {"reputation": 2176, "user_id": 2846794, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/muUw2.png?s=128&g=1", "display_name": "Godinall", "link": "https://stackoverflow.com/users/2846794/godinall"}, "edited": false, "score": 0, "creation_date": 1486558952, "post_id": 42113621, "comment_id": 71396305, "body": "Thank you @Axel Richter, just tried your solution in Excel and it says &quot;The formula contains unrecognized text&quot;, and give a #NAME? in the cell. I&#39;m on Windows 10 with Office 2013 FYI."}, {"owner": {"reputation": 42107, "user_id": 3915431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ad2fe8d0c0e72bdbe3623e85a96b9b4?s=128&d=identicon&r=PG&f=1", "display_name": "Axel Richter", "link": "https://stackoverflow.com/users/3915431/axel-richter"}, "reply_to_user": {"reputation": 2176, "user_id": 2846794, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/muUw2.png?s=128&g=1", "display_name": "Godinall", "link": "https://stackoverflow.com/users/2846794/godinall"}, "edited": false, "score": 1, "creation_date": 1486559227, "post_id": 42113621, "comment_id": 71396473, "body": "The function needs to be placed within a default VBA Module."}, {"owner": {"reputation": 2176, "user_id": 2846794, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/muUw2.png?s=128&g=1", "display_name": "Godinall", "link": "https://stackoverflow.com/users/2846794/godinall"}, "edited": false, "score": 0, "creation_date": 1486559837, "post_id": 42113621, "comment_id": 71396899, "body": "you are a star! Working perfectly!"}], "tags": [], "owner": {"reputation": 42107, "user_id": 3915431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ad2fe8d0c0e72bdbe3623e85a96b9b4?s=128&d=identicon&r=PG&f=1", "display_name": "Axel Richter", "link": "https://stackoverflow.com/users/3915431/axel-richter"}, "is_accepted": true, "score": 2, "last_activity_date": 1486559404, "last_edit_date": 1486559404, "creation_date": 1486558227, "answer_id": 42113621, "question_id": 42112818, "link": "https://stackoverflow.com/questions/42112818/excel-2010-replacing-webservice-with-vba/42113621#42113621", "title": "Excel 2010 replacing WEBSERVICE() with VBA", "body": "<p>The simplest version of a VBA <code>WEBSERVICE</code> equivalent would be:</p>\n\n<pre><code>Public Function myWEBSERVICE(strURL As String) As String\n Dim oWinHttp As Object\n\n Set oWinHttp = CreateObject(\"MSXML2.XMLHTTP\")\n\n oWinHttp.Open \"GET\", strURL, False\n oWinHttp.send \"\"\n\n myWEBSERVICE = oWinHttp.ResponseText\n\nEnd Function\n</code></pre>\n\n<p>Used as UDF (User Defined Function) as a cell formula like:</p>\n\n<pre><code>=mywebservice(\"http://api.fixer.io/\"&amp;TEXT(A1,\"yyyy-mm-dd\")&amp;\"?base=USD&amp;symbols=CNY\")\n</code></pre>\n\n<p>where <code>A1</code>contains a date.</p>\n\n<p>For a reference see <a href=\"https://msdn.microsoft.com/en-us/library/ms762275%28v=vs.85%29.aspx\" rel=\"nofollow noreferrer\">responseText Property (IXMLHTTPRequest)</a>. Examples there are in JScript and must be converted to VBA.</p>\n"}], "owner": {"reputation": 2176, "user_id": 2846794, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/muUw2.png?s=128&g=1", "display_name": "Godinall", "link": "https://stackoverflow.com/users/2846794/godinall"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 499, "favorite_count": 1, "accepted_answer_id": 42113621, "answer_count": 1, "score": 0, "last_activity_date": 1486559404, "creation_date": 1486555966, "last_edit_date": 1486556149, "question_id": 42112818, "link": "https://stackoverflow.com/questions/42112818/excel-2010-replacing-webservice-with-vba", "title": "Excel 2010 replacing WEBSERVICE() with VBA", "body": "<p>I have a spreadsheet that converts USD into EURO.</p>\n\n<p>I designed it with Excel 2013 and I use the new function WEBSERVICE to retrieve historical exchange rates from internet, API here:</p>\n\n<p><a href=\"http://api.fixer.io/2017-01-07?base=USD&amp;symbols=EUR\" rel=\"nofollow noreferrer\">http://api.fixer.io/2017-01-07?base=USD&amp;symbols=EUR</a></p>\n\n<p>And my formula look like below:</p>\n\n<pre><code>=IF(OFFSET(INDIRECT(\"R[0]C\",),0,-2)&lt;&gt;\"\",SUBSTITUTE(MID(WEBSERVICE(\"http://api.fixer.io/\"&amp;TEXT(EOMONTH(OFFSET(INDIRECT(\"R[0]C\",),0,-2),0),\"yyyy-mm-dd\")&amp;\"?base=USD&amp;symbols=CNY\"),50,6),\"}\",\"\"),\"\")\n</code></pre>\n\n<p>Explain:\nIf the second cell to the left of the current cell is not empty, then fill it with the web data. The parameter in the formula is the month end date, also calculated by a cell in this table.</p>\n\n<p>The table has multiple rows, and this is working perfectly for us, only problem is that some users are still on Excel 2010 or older, is there a way of doing this in VBA? </p>\n"}, {"tags": ["vba", "date", "email", "outlook", "sendmail"], "comments": [{"owner": {"reputation": 2104, "user_id": 949044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c84ec01bed6dea2f97aad7cc5d4e495c?s=128&d=identicon&r=PG", "display_name": "Lyth", "link": "https://stackoverflow.com/users/949044/lyth"}, "edited": false, "score": 0, "creation_date": 1486556820, "post_id": 42112716, "comment_id": 71394805, "body": "Welcome to StackOverflow! Does the script display any errors? Is it possible that regional settings (e.g. date format) have changed?"}, {"owner": {"reputation": 31052, "user_id": 4280, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bc588d9f099467ce6bc6fc68426119aa?s=128&d=identicon&r=PG", "display_name": "Dick Kusleika", "link": "https://stackoverflow.com/users/4280/dick-kusleika"}, "edited": false, "score": 0, "creation_date": 1486562026, "post_id": 42112716, "comment_id": 71398513, "body": "Hashes are not the comment indicators in VBA so this wouldn&#39;t compile. Which has me a little confused.  There is a module in Outlook called <code>ThisOutlookSession</code>. What&#39;s in there? I assume you were using the <code>ItemSend</code> event to trigger all this other code and something happened to that."}, {"owner": {"reputation": 11, "user_id": 7534207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/175fdba203a507f7c2a1d84129f85763?s=128&d=identicon&r=PG&f=1", "display_name": "metaljay", "link": "https://stackoverflow.com/users/7534207/metaljay"}, "reply_to_user": {"reputation": 2104, "user_id": 949044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c84ec01bed6dea2f97aad7cc5d4e495c?s=128&d=identicon&r=PG", "display_name": "Lyth", "link": "https://stackoverflow.com/users/949044/lyth"}, "edited": false, "score": 0, "creation_date": 1486562691, "post_id": 42112716, "comment_id": 71399040, "body": "@Lyth no settings have changed, everything Is still in the same format (dd/MM/yyyy and h:mm:ss tt"}, {"owner": {"reputation": 11, "user_id": 7534207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/175fdba203a507f7c2a1d84129f85763?s=128&d=identicon&r=PG&f=1", "display_name": "metaljay", "link": "https://stackoverflow.com/users/7534207/metaljay"}, "reply_to_user": {"reputation": 31052, "user_id": 4280, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bc588d9f099467ce6bc6fc68426119aa?s=128&d=identicon&r=PG", "display_name": "Dick Kusleika", "link": "https://stackoverflow.com/users/4280/dick-kusleika"}, "edited": false, "score": 0, "creation_date": 1486562816, "post_id": 42112716, "comment_id": 71399125, "body": "@DickKusleika I just have &quot;Micosoft Outlook Objects&quot; and within that &quot;ThisOutlookSession&quot; which has the macro in, is this not how it should be? Even if I manually run the macro it doesn&#39;t move the emails, how would I check if ItemSend is broken?"}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 7534207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/175fdba203a507f7c2a1d84129f85763?s=128&d=identicon&r=PG&f=1", "display_name": "metaljay", "link": "https://stackoverflow.com/users/7534207/metaljay"}, "edited": false, "score": 0, "creation_date": 1486571101, "post_id": 42117878, "comment_id": 71405210, "body": "there is already a comment for this in the macro:     If month &lt; 2 Then  &#39; checks if 2 months ago is in previous year and corrects for this    year = year - 1    month = 10 + month"}, {"owner": {"reputation": 11, "user_id": 7534207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/175fdba203a507f7c2a1d84129f85763?s=128&d=identicon&r=PG&f=1", "display_name": "metaljay", "link": "https://stackoverflow.com/users/7534207/metaljay"}, "edited": false, "score": 0, "creation_date": 1486572178, "post_id": 42117878, "comment_id": 71406017, "body": "thanks for the help, it runs if I run it via VBA editor, but within Outlook it still doesn&#39;t work if upon pressing send"}, {"owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "reply_to_user": {"reputation": 11, "user_id": 7534207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/175fdba203a507f7c2a1d84129f85763?s=128&d=identicon&r=PG&f=1", "display_name": "metaljay", "link": "https://stackoverflow.com/users/7534207/metaljay"}, "edited": false, "score": 0, "creation_date": 1486739015, "post_id": 42117878, "comment_id": 71489940, "body": "You should have ItemSend code in ThisOutlookSession that calls MoveEmails. Put a breakpoint at MoveEmails in ItemSend and see if you get to that line."}], "tags": [], "owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "is_accepted": false, "score": 1, "last_activity_date": 1486569567, "creation_date": 1486569567, "answer_id": 42117878, "question_id": 42112716, "link": "https://stackoverflow.com/questions/42112716/outlook-vba-not-running/42117878#42117878", "title": "Outlook VBA not running", "body": "<p>In February the month calculates to zero in the TwoMonths function</p>\n\n<p>Add this:</p>\n\n<pre><code>If month = 0 Then\n    month = 12\n    year = year - 1\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 7534207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/175fdba203a507f7c2a1d84129f85763?s=128&d=identicon&r=PG&f=1", "display_name": "metaljay", "link": "https://stackoverflow.com/users/7534207/metaljay"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 131, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1487055216, "creation_date": 1486555681, "last_edit_date": 1487055216, "question_id": 42112716, "link": "https://stackoverflow.com/questions/42112716/outlook-vba-not-running", "title": "Outlook VBA not running", "body": "<p>I am not an VBA expert, but a friend has written a macro that upon sending an email to a person from a list (MoveList) it would automatically move the email from 'Sent Items' to another folder.</p>\n\n<p>Up until today, this worked fine - I have checked the macro settings in outlook (changed to run all macros) and it still doesn't work.</p>\n\n<p>Any ideas? (I struggled to paste the macro, it kept complaining about formatting, so ive uploaded it here)</p>\n\n<pre><code>Option Explicit\nDim objXL As Object\nDim objWB As Object\nDim objWS As Object\nDim objRange As Object\n\nPrivate Function InList(ByVal ToList As String, ByVal DistList As Outlook.DistListItem) As Boolean\n###################################################\n## this function checks if the To list contains   #\n## Any of the names in the supplied Distribution  #\n## list using a string compare                    #\n###################################################\nDim i As Integer\nDim test As String\nInList = False\n\n   For i = 1 To DistList.MemberCount   # check if each name is in the to list\n       test = DistList.GetMember(i).Name\n       If InStr(1, ToList, test) Then\n          InList = True       # if name is in the to list then set function to true\n       End If\n   Next i\n\nEnd Function\n\nPrivate Function TwoMonths() As String\n###################################################\n## this function returns the date 2 months before #\n## today. This does not return the time elelment  #\n##                                                #\n###################################################\n\nDim today As String\nDim day As Integer\nDim month As Integer\nDim year As Integer\n\ntoday = Now   #now returns todays date in the format dd/mm/yyyy hh:mm:ss\n\nday = Left(today, 2)\nmonth = Mid(today, 4, 2)\nyear = Mid(today, 7, 4)\n\nIf month &lt; 2 Then  # checks if 2 months ago is in previous year and corrects for this\n   year = year - 1\n   month = 10 + month\nElse\n  month = month - 2\nEnd If\n\nTwoMonths = day &amp; \"/\" &amp; month &amp; \"/\" &amp; year\n\nEnd Function\n\nSub MoveEmails() #(ByVal MoveFrom As String, ByVal MoveTo As String, Distributionlist As String)\n\n####################################################\n## This subroutine will move any mail that is sent #\n## any person in the distribution list MoveList in #\n## the last 2 months from the Sent folders         #\n####################################################\n\n\n    Dim DefaultInbox As Outlook.Folder\n    Dim folDefaultSentItems As Outlook.Folder\n    Dim folDestFolder As Outlook.Folder\n    Dim DefaultContacts As Outlook.Folder\n    Dim dlContactList As Outlook.DistListItem\n    Dim TopFolder As Outlook.Folder\n    Dim itSentEmails As Outlook.Items\n    Dim myItem As Object\n    Dim i As Long\n    Dim counter As Integer\n    Dim filterCriteria As String\n    Dim filteredItemsCollection As Outlook.Items\n    Dim Last2Months As String\n    Dim imail\n    Dim mynamespace\n\n      Set mynamespace = Application.GetNamespace(\"MAPI\")\n\n      Set DefaultInbox = mynamespace.Folders(\"my email@email.com\") # Change for your primary inbox name\n      Set DefaultContacts = mynamespace.GetDefaultFolder(olFolderContacts)\n\n      Set folDefaultSentItems = DefaultInbox.Folders(\"Sent Items\") #selects \"Sent Items\" folder to move from\n\n      Set TopFolder = mynamespace.Folders(\"Misc\") # Change for your Second inbox name\n\n      Set folDestFolder = TopFolder.Folders(\"Sent (Other)\")    # Set destination folder\n\n      Set dlContactList = DefaultContacts.Items(\"MoveList\")    # Selects the distribution list to use for check\n\n      Set itSentEmails = folDefaultSentItems.Items     # select all items in \"Sent Items\"\n\n      # the next section restricts search to only items sent in the last 2 months\n      # This is to limit the number of emails checked. Assumes that\n      # this macro is run at a frequency less than 2 months\n\n      Last2Months = TwoMonths\n      filterCriteria = \"[ReceivedTime] &gt; \"\"\" &amp; Last2Months &amp; \" 12:00 AM\"\"\"\n      Set filteredItemsCollection = itSentEmails.Restrict(filterCriteria)\n\n    #loop until all emails are checked\n\n      i = 1\n      While i &lt;= filteredItemsCollection.Count      \n    #loop until all emails are checked\n\n\n    # check if it is a mail item\n         If filteredItemsCollection(i).Class = olMail Then\n\n    # check if to list contains one of the emails in the distribution list\n\n            If InList(filteredItemsCollection(i).To, dlContactList) Then\n\n    # If it is in the list move the email to the destination folder\n\n               filteredItemsCollection(i).Move folDestFolder\n\n    # Reset the restricted list. When the email list is moved it changes the indexing\n    # in the restricted list so the index loop needs to be decramented and the restriction\n    # list reset. (Error cataching)\n\n               Set filteredItemsCollection = itSentEmails.Restrict(filterCriteria)\n               i = i - 1\n\n            End If\n\n         End If\n         i = i + 1   # incrament index reference\n       Wend\n    End Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "vsto", "surface-pro"], "answers": [{"tags": [], "owner": {"reputation": 308, "user_id": 1761974, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f470e4667fcd8b568db18f833d6f143a?s=128&d=identicon&r=PG", "display_name": "Ste Griffiths", "link": "https://stackoverflow.com/users/1761974/ste-griffiths"}, "is_accepted": false, "score": 0, "last_activity_date": 1507810086, "creation_date": 1507810086, "answer_id": 46709237, "question_id": 42112514, "link": "https://stackoverflow.com/questions/42112514/buttons-embedded-in-excel-sheet-becoming-pixellated-after-click-on-surface-pro-4/46709237#46709237", "title": "Buttons embedded in Excel sheet becoming pixellated after click on Surface Pro 4", "body": "<p>I eventually solved this problem by replacing all of the buttons with Rectangle Shapes. These can still have macros assigned and even turn the cursor to a hand when the user hovers over them.</p>\n\n<p>I think that the pixellation problem is peculiar to embedded ActiveX controls  on worksheets, and it can be avoided by using other tools when possible. I don't think there's any other way!</p>\n\n<p>To reimplement buttons as shapes, I wrote a ShapeButtons module (in VBA side) with some helpful functions for showing/hiding buttons and getting/setting text. All of the buttons in our worksheet are on a page called <code>ControlSheet</code>. Please excuse my highly defensive error handling:</p>\n\n<pre><code>Public Sub SetShapeBtnText(name As String, newText As String)\nOn Error GoTo errorHandler\n    Dim btn As Shape\n    Set btn = GetShapeBtn(name)\n    btn.TextFrame2.TextRange.text = newText\n    Exit Sub\nerrorHandler:\n    WriteDebugError (\"SetShapeBtnText Exception for \" &amp; name &amp; \" with \" &amp; newText)\nEnd Sub\n\nPublic Sub ShowShapeBtn(name As String)\nOn Error GoTo errorHandler\n    ControlSheet.Shapes(name).Visible = True\n    Exit Sub\nerrorHandler:\n    WriteDebugError (\"ShowShapeBtn Exception for \" &amp; name)\nEnd Sub\n\nPublic Sub HideShapeBtn(name As String)\nOn Error GoTo errorHandler\n    ControlSheet.Shapes(name).Visible = False\n    Exit Sub\nerrorHandler:\n    WriteDebugError (\"HideShapeBtn Exception for \" &amp; name)\nEnd Sub\n\nPublic Function ShapeBtnIsVisible(name As String) As Boolean\nOn Error GoTo errorHandler\n    ShapeBtnIsVisible = ControlSheet.Shapes(name).Visible\n    Exit Function\nerrorHandler:\n    WriteDebugError (\"ShapeBtnIsVisible Exception for \" &amp; name)\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 308, "user_id": 1761974, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f470e4667fcd8b568db18f833d6f143a?s=128&d=identicon&r=PG", "display_name": "Ste Griffiths", "link": "https://stackoverflow.com/users/1761974/ste-griffiths"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 60, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1507810086, "creation_date": 1486555126, "question_id": 42112514, "link": "https://stackoverflow.com/questions/42112514/buttons-embedded-in-excel-sheet-becoming-pixellated-after-click-on-surface-pro-4", "title": "Buttons embedded in Excel sheet becoming pixellated after click on Surface Pro 4", "body": "<p>I have a workbook which works with lots of VBA and a custom add-in to create reports for customers. The workbook has a series of buttons on the front sheet, which control the operation of the report \"app\":</p>\n\n<p><a href=\"https://i.stack.imgur.com/6CWqd.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/6CWqd.png\" alt=\"Buttons before click\"></a></p>\n\n<p>This is mostly deployed on Surface Pro 3s and 4s. One of the users reports that any time they click a button, it becomes pixellated (pictured below) and can no longer be read. I haven't seen this on other units, and it may be relevant that this user has an external display which duplicates what is on his Surface screen. The effect happens on both screens:</p>\n\n<p><a href=\"https://i.stack.imgur.com/lHVK8.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/lHVK8.png\" alt=\"Pixellated buttons\"></a></p>\n\n<p>The office version is Excel 2016 MSO 32-bit.</p>\n\n<p>Has anyone seen this and does anyone know why it happens?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 0, "creation_date": 1486555557, "post_id": 42112486, "comment_id": 71393904, "body": "Use <code>Debug.Print dateArray(0)</code> the row before the error."}, {"owner": {"reputation": 121, "user_id": 7468305, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/b97cbb2e461556a15cec2ebebf109413?s=128&d=identicon&r=PG&f=1", "display_name": "good.learner", "link": "https://stackoverflow.com/users/7468305/good-learner"}, "reply_to_user": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 0, "creation_date": 1486555895, "post_id": 42112486, "comment_id": 71394137, "body": "@R3uk it says <code>&quot;31&quot;</code>"}], "answers": [{"tags": [], "owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "is_accepted": true, "score": 2, "last_activity_date": 1486555825, "creation_date": 1486555825, "answer_id": 42112766, "question_id": 42112486, "link": "https://stackoverflow.com/questions/42112486/type-mismatch-error-excel-vba/42112766#42112766", "title": "Type mismatch error - Excel VBA", "body": "<p>You should not use <code>Day</code> as variable, because it is a keyword (actually a function!)</p>\n\n<p>And further more, it is the function that you should be using rather than reinventing the wheel! ;)</p>\n\n<pre><code>Dim vDay as Integer\nDim vMonth as Integer\nDim vYear as Integer\nDim dateRow as Range\nDim cEndDate as Date\n\nFor Each dateRow In ThisWorkbook.Sheets(1).Range(\"G8:G153\").Cells\n    cEndDate = DateValue(dateRow.Value)\n    vDay = Day(cEndDate)\n    vMonth = Month(cEndDate)\n    vYear = Year(cEndDate)\n\n\n    '&lt;- more code -&gt;\nNext dateRow\n</code></pre>\n"}], "owner": {"reputation": 121, "user_id": 7468305, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/b97cbb2e461556a15cec2ebebf109413?s=128&d=identicon&r=PG&f=1", "display_name": "good.learner", "link": "https://stackoverflow.com/users/7468305/good-learner"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 137, "favorite_count": 0, "accepted_answer_id": 42112766, "answer_count": 1, "score": 1, "last_activity_date": 1486555825, "creation_date": 1486555079, "last_edit_date": 1486555273, "question_id": 42112486, "link": "https://stackoverflow.com/questions/42112486/type-mismatch-error-excel-vba", "title": "Type mismatch error - Excel VBA", "body": "<p>I have the following code. But it is giving me a type mismatch error on <code>Excel 2013</code> but works fine in <code>Excel 2010</code>.</p>\n\n<pre><code>For Each dateRow In ThisWorkbook.Sheets(1).Range(\"G8:G153\").Cells\n    cEndDate = DateValue(dateRow)\n    dateArray = Split(cEndDate , \"-\")\n    Day = CInt(dateArray(0)) 'I get the error here\n    '&lt;- more code -&gt;\nNext\n</code></pre>\n\n<p>This is working fine with no error in <code>Excel 2010</code>.</p>\n"}, {"tags": ["sql-server", "vba", "excel", "sql-server-express"], "comments": [{"owner": {"reputation": 714, "user_id": 7317515, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sYZzr.jpg?s=128&g=1", "display_name": "M84", "link": "https://stackoverflow.com/users/7317515/m84"}, "edited": false, "score": 0, "creation_date": 1486554332, "post_id": 42112073, "comment_id": 71393137, "body": "which is the error message? can you connect usign SSMS?"}, {"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1486556875, "post_id": 42112073, "comment_id": 71394846, "body": "Have a look at these solutions I provided some time ago: <a href=\"http://stackoverflow.com/questions/30289095/connection-to-a-microsoft-sql-database-via-vba-adodb-with-the-lowest-risk-to-h/30299444#30299444\" title=\"connection to a microsoft sql database via vba adodb with the lowest risk to h\">stackoverflow.com/questions/30289095/&hellip;</a> AND <a href=\"http://stackoverflow.com/questions/38744688/vba-macro-save-sql-query-in-a-csv-file/38747334#38747334\" title=\"vba macro save sql query in a csv file\">stackoverflow.com/questions/38744688/&hellip;</a> One solution is for integrated security <code>SSPI</code> as you have it and the other one allows for connections with username and password. Also, the code is very detailed and captures the different errors: (1) error reaching server (2) error connecting to server (3) error connecting to DB on server."}, {"owner": {"reputation": 171, "user_id": 1786307, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/023c0c1166acbc339c74da57434b3598?s=128&d=identicon&r=PG", "display_name": "MillhouseD", "link": "https://stackoverflow.com/users/1786307/millhoused"}, "edited": false, "score": 0, "creation_date": 1486560942, "post_id": 42112073, "comment_id": 71397707, "body": "Use SQL Configuration manager and look at SQL Server Network Configuration, Protocols for SQLEXPRESS. Is TCP/IP or Named Pipes enabled? I have found several instances where SQL Express had these protocols disabled."}], "owner": {"reputation": 169, "user_id": 3933823, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1c335d7b8903ceb8a370ae5422b6c221?s=128&d=identicon&r=PG&f=1", "display_name": "prgSRR", "link": "https://stackoverflow.com/users/3933823/prgsrr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 141, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1486553875, "creation_date": 1486553875, "last_edit_date": 1531164843, "question_id": 42112073, "link": "https://stackoverflow.com/questions/42112073/cannot-connect-to-ms-sql-db-from-machines-other-than-local", "title": "Cannot connect to MS SQL db from machines other than local", "body": "<p>I am running an <code>MSSQLServer 2014 Express</code> instance on my machine with one database that contains one table. I have an Excel VBA application that connects to this DB and retrieves/updates records. This Excel VBA script only connects to the DB from the same machine on which the database is hosted and not from any other client/computer. </p>\n\n<p>I have checked and eliminated possibility of network issues, in that I can successfully ping and telnet into MyIPAddress:1433 from these client machines. </p>\n\n<p>Following are the combinations of connection string that I have tried, none of which works from another machine than the one which hosts the SQL DB. Help appreciated! </p>\n\n<p><code>ConnectionStringSQL = \"Provider=SQLOLEDB;Data Source=10.0.0.2,1433;Network Library=DBMSSOCN;Initial Catalog=MyDBName;Integrated Security=SSPI\"</code></p>\n\n<p><code>ConnectionStringSQL = \"Provider=SQLOLEDB;Data Source=10.0.0.2,1433;Network Library=DBMSSOCN;Initial Catalog=MyDBName;Username=MyUsername;Password=MyPassword\"</code></p>\n\n<p><code>ConnectionStringSQL = \"Provider=SQLOLEDB;Data Source=PCName;Network Library=DBMSSOCN;Initial Catalog=MyDBName;Integrated Security=SSPI\"</code></p>\n\n<p><code>ConnectionStringSQL = \"Provider=SQLOLEDB;Data Source=PCName\\MSSQLSERVER;Network Library=DBMSSOCN;Initial Catalog=MyDBName;Username=MyUsername;Password=MyPassword\"</code></p>\n\n<p><code>ConnectionStringSQL = \"Provider=SQLOLEDB;Data Source=PCName\\SQLEXPRESS;Network Library=DBMSSOCN;Initial Catalog=MyDBName;Username=MyUsername;Password=MyPassword\"</code></p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 175, "user_id": 7529656, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/6acd96735e5bfc5d3f0721389a65ab1d?s=128&d=identicon&r=PG&f=1", "display_name": "Robin_Hcp", "link": "https://stackoverflow.com/users/7529656/robin-hcp"}, "edited": false, "score": 0, "creation_date": 1486556966, "post_id": 42112373, "comment_id": 71394916, "body": "Thanks a lot ! I was completely lost with this one.. it really helped me understand"}, {"owner": {"reputation": 138, "user_id": 5149262, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a3d53f206002493f2d9587a117d14fda?s=128&d=identicon&r=PG", "display_name": "Diego Ribba", "link": "https://stackoverflow.com/users/5149262/diego-ribba"}, "reply_to_user": {"reputation": 175, "user_id": 7529656, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/6acd96735e5bfc5d3f0721389a65ab1d?s=128&d=identicon&r=PG&f=1", "display_name": "Robin_Hcp", "link": "https://stackoverflow.com/users/7529656/robin-hcp"}, "edited": false, "score": 0, "creation_date": 1486557859, "post_id": 42112373, "comment_id": 71395559, "body": "i&#39;m glad i could help. i added some tags to make understanding each line easier. sorry if my english is not that good."}], "tags": [], "owner": {"reputation": 138, "user_id": 5149262, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a3d53f206002493f2d9587a117d14fda?s=128&d=identicon&r=PG", "display_name": "Diego Ribba", "link": "https://stackoverflow.com/users/5149262/diego-ribba"}, "is_accepted": true, "score": 0, "last_activity_date": 1486554777, "creation_date": 1486554777, "answer_id": 42112373, "question_id": 42111721, "link": "https://stackoverflow.com/questions/42111721/vba-code-to-transpose-one-multiple-data-column-into-several-columns/42112373#42112373", "title": "VBA code to transpose one multiple data column into several columns", "body": "<p>Assuming that the data structure is always the same (12 months of data and 3 rows for data set id's). Change Sheet Name on Code Line 9 to suit your Sheet Name</p>\n\n<p><code>Sub TRANSPOSE_DATA()\nDim lRow, i, x As Long\n'------------------\nWith ThisWorkbook\n'ADD OUTPUT WORKSHEET\n    .Sheets.Add After:=.Sheets(.Sheets.Count) 'add a sheet for output\n    .ActiveSheet.Name = \"OUTPUT\" 'sheet rename\n'COPY DATA\n    With .Sheets(\"Hoja1\") 'Change sheet name for yours\n        lRow = .Range(\"A1048576\").End(xlUp).Row 'last row definition\n        .Range(\"A1:B15\").Copy Destination:=ThisWorkbook.Sheets(\"OUTPUT\").Range(\"A1\") 'First dataset copy (including headers)\n        x = 3 'first iteration column definition\n        For i = 16 To lRow - 14\n            .Range(\"B\" &amp; i &amp; \":B\" &amp; i + 14).Copy Destination:=ThisWorkbook.Sheets(\"OUTPUT\").Cells(1, x) 'copy data from each iteration\n            x = x + 1 'transpose 1 column for next iteration\n            i = i + 14 'transpose 12 months plus header rows for next iteration\n        Next i\n    End With\nEnd With\nEnd Sub</code></p>\n"}], "owner": {"reputation": 175, "user_id": 7529656, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/6acd96735e5bfc5d3f0721389a65ab1d?s=128&d=identicon&r=PG&f=1", "display_name": "Robin_Hcp", "link": "https://stackoverflow.com/users/7529656/robin-hcp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 113, "favorite_count": 0, "closed_date": 1486569415, "accepted_answer_id": 42112373, "answer_count": 1, "score": -3, "last_activity_date": 1486554777, "creation_date": 1486552849, "last_edit_date": 1531164843, "question_id": 42111721, "link": "https://stackoverflow.com/questions/42111721/vba-code-to-transpose-one-multiple-data-column-into-several-columns", "closed_reason": "Needs more focus", "title": "VBA code to transpose one multiple data column into several columns", "body": "<p>Hello I have a list of 65000 rows of stocks price for one column, and I would like to adapt it like in the second pic, anyone has any idea how to code it with vba ? Thank you!</p>\n\n<p><img src=\"https://i.stack.imgur.com/eS6it.png\" alt=\"enter image description here\"></p>\n\n<p><img src=\"https://i.stack.imgur.com/E5ZNa.png\" alt=\"enter image description here\"></p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 7534021, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/638df90a1458515b2e0a79688ca66342?s=128&d=identicon&r=PG&f=1", "display_name": "brianabrownesq", "link": "https://stackoverflow.com/users/7534021/brianabrownesq"}, "edited": false, "score": 0, "creation_date": 1486561500, "post_id": 42114260, "comment_id": 71398103, "body": "Thanks for the reply. I tried running it, but was taken directly to  a wizard to select the file location. For some reason, none of my files showed up... Is there a way to configure it so I can add in my folder location and have it dig down into all sub-folders to pull out the workbooks? Appreciate the help!"}, {"owner": {"reputation": 11192, "user_id": 5514747, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/db1a440aac7d279213c66bcdb1c1984a?s=128&d=identicon&r=PG", "display_name": "Harun24HR", "link": "https://stackoverflow.com/users/5514747/harun24hr"}, "reply_to_user": {"reputation": 3, "user_id": 7534021, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/638df90a1458515b2e0a79688ca66342?s=128&d=identicon&r=PG&f=1", "display_name": "brianabrownesq", "link": "https://stackoverflow.com/users/7534021/brianabrownesq"}, "edited": false, "score": 0, "creation_date": 1486573075, "post_id": 42114260, "comment_id": 71406648, "body": "@brianabrownesq Try edited codes. I tested it. Change you directory in this line <code>filepath = &quot;C:\\MyExcelFiles\\&quot;</code> Make sure you added <code>&quot;\\&quot;</code> backward slash at the end of <code>directory</code> or <code>folder</code> path."}, {"owner": {"reputation": 3, "user_id": 7534021, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/638df90a1458515b2e0a79688ca66342?s=128&d=identicon&r=PG&f=1", "display_name": "brianabrownesq", "link": "https://stackoverflow.com/users/7534021/brianabrownesq"}, "edited": false, "score": 0, "creation_date": 1486648845, "post_id": 42114260, "comment_id": 71443522, "body": "That did the trick, thank you! What I really need to be able to do is supply it with a root directory and have it dig through our various folders and sub folders to perform the action on the excel files inside. Do you know how I can alter the code to do that? Sorry for all the questions- I&#39;m just beginning to learn and I&#39;m in over my head."}], "tags": [], "owner": {"reputation": 11192, "user_id": 5514747, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/db1a440aac7d279213c66bcdb1c1984a?s=128&d=identicon&r=PG", "display_name": "Harun24HR", "link": "https://stackoverflow.com/users/5514747/harun24hr"}, "is_accepted": true, "score": 1, "last_activity_date": 1486572947, "last_edit_date": 1486572947, "creation_date": 1486559875, "answer_id": 42114260, "question_id": 42111661, "link": "https://stackoverflow.com/questions/42111661/find-and-list-sheets-for-all-workbooks-in-a-directory-excel-vba/42114260#42114260", "title": "Find and List Sheets for All Workbooks in a Directory- Excel, VBA", "body": "<p>Try following sub. Hope it will help you.</p>\n\n<pre><code>    Sub EachSHinEachBook()\n    Dim FolderNme As String\n        FileType = \"*.xls*\"     'The file type to search for\n        OutputRow = 2   'The first row of the active sheet to start writing to                 \n\n        filepath = \"C:\\MyExcelFiles\\\" 'The folder to search\n\n        ThisWorkbook.ActiveSheet.Range(\"A\" &amp; OutputRow).Activate\n        OutputRow = OutputRow + 1\n        Curr_File = Dir(filepath &amp; FileType)\n        Do Until Curr_File = \"\"\n            Set FldrWkbk = Workbooks.Open(filepath &amp; Curr_File, False, True)\n            ThisWorkbook.ActiveSheet.Range(\"A\" &amp; OutputRow) = Curr_File\n            ThisWorkbook.ActiveSheet.Range(\"B\" &amp; OutputRow).ClearContents   'Clear any previous values\n            OutputRow = OutputRow + 1\n\n            For Each Sht In FldrWkbk.Sheets\n                ThisWorkbook.ActiveSheet.Range(\"B\" &amp; OutputRow) = Sht.Name\n                ThisWorkbook.ActiveSheet.Range(\"A\" &amp; OutputRow).ClearContents 'Clear any previous values\n                OutputRow = OutputRow + 1\n            Next Sht\n            FldrWkbk.Close SaveChanges:=False\n            Curr_File = Dir\n        Loop\n        Set FldrWkbk = Nothing\n    End Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 7534021, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/638df90a1458515b2e0a79688ca66342?s=128&d=identicon&r=PG&f=1", "display_name": "brianabrownesq", "link": "https://stackoverflow.com/users/7534021/brianabrownesq"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1605, "favorite_count": 1, "accepted_answer_id": 42114260, "answer_count": 1, "score": 0, "last_activity_date": 1487317590, "creation_date": 1486552660, "last_edit_date": 1487317590, "question_id": 42111661, "link": "https://stackoverflow.com/questions/42111661/find-and-list-sheets-for-all-workbooks-in-a-directory-excel-vba", "title": "Find and List Sheets for All Workbooks in a Directory- Excel, VBA", "body": "<p>I am currently trying to compile a list of all the names of the Worksheets from multiple Workbooks in a directory. So far, I have found and edited some code (see below) that will give me the desired result, but just for one Workbook at a time. There are easily 400 workbooks I need to pull from, and I'm trying to work a bit smarter rather than harder on this one. Unfortunately, these Workbooks could be stored in any folder or subfolder in the directory, with the only consistency being that they are the only .xlsm files. Would there be a way to do this and have each Workbook's Worksheet titles listed in separate columns?\nAny help greatly appreciated!!</p>\n\n<pre><code>    Sub ListSheets()\n\n'enter my directory\n    Workbooks.Open Filename:=\"path\"\n    Dim ws As Worksheet\n    Dim i As Integer\n    With ThisWorkbook.Worksheets(\"Sheet1\")\n    .Range(\"a:a\").ClearContents\n    For Each ws In ActiveWorkbook.Worksheets\n    i = i + 1\n    .Range(\"a\" &amp; i) = ws.Name\n    Next ws\n    End With\n'Enter my workbook below\n    Workbooks(\"\").Close True\n\n    End Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "colors", "conditional-formatting"], "comments": [{"owner": {"reputation": 1595, "user_id": 4837035, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdfc11c275ff58678c9c6b7fa93d4119?s=128&d=identicon&r=PG&f=1", "display_name": "Zerk", "link": "https://stackoverflow.com/users/4837035/zerk"}, "edited": false, "score": 0, "creation_date": 1486552483, "post_id": 42111562, "comment_id": 71391894, "body": "What error are you getting? what is causing the issue? As an initial recommendation i&#39;d recommend using instr, and sticking to .value (this is the default property so is redundant to state). Usage would be if instr(1,fcell,&quot;.pdf&quot;) &gt; 0 then"}, {"owner": {"reputation": 4114, "user_id": 5751805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da1c3545802a510a9b283f706d74283a?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan", "link": "https://stackoverflow.com/users/5751805/jordan"}, "edited": false, "score": 1, "creation_date": 1486553334, "post_id": 42111562, "comment_id": 71392461, "body": "Why don&#39;t you just use <a href=\"https://support.office.com/en-us/article/Use-a-formula-to-apply-conditional-formatting-FED60DFA-1D3F-4E13-9ECB-F1951FF89D7F\" rel=\"nofollow noreferrer\">Conditional Formatting</a>?"}], "answers": [{"tags": [], "owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "is_accepted": true, "score": 2, "last_activity_date": 1486553696, "creation_date": 1486553696, "answer_id": 42112008, "question_id": 42111562, "link": "https://stackoverflow.com/questions/42111562/vba-format-cell-fill-color-based-on-content-file-type/42112008#42112008", "title": "VBA Format cell fill color based on content file type", "body": "<p>Few improvements :</p>\n\n<ol>\n<li>Define the sheet in which you work (change  <em>Sheet's name</em> in the line <code>Set wS = ...</code></li>\n<li>Use of <code>With</code></li>\n<li>Use of <code>Select Case</code> and <code>Like</code>, on the lowered case cell's value (<code>LCase()</code>)</li>\n</ol>\n\n<p>Working solution :</p>\n\n<pre><code>Public Sub Master_JoaoTS()\n    Dim wS As Worksheet\n    Dim TdCel As Range, FCell As Range, CellVal As String\n    Set wS = ThisWorkbook.Sheets(\"Sheet's Name\")\n    Set TdCel = wS.Range(\"A1:A25\")\n\n    For Each FCell In TdCel\n        With FCell\n            CellVal = LCase(.Value)\n            With .Interior\n                Select Case True\n                    Case CellVal Like \"*.pdf\"\n                        .ColorIndex = 10\n                    Case CellVal Like \"*.doc*\"\n                        .ColorIndex = 9\n                    Case CellVal Like \"*.jpg\"\n                        .ColorIndex = 8\n                    Case Else\n                        .Pattern = xlNone\n                End Select\n            End With '.Interior\n        End With 'FCell\n    Next FCell\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 555, "user_id": 7529405, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2304c31772fc744f9b1487a4a5f155e9?s=128&d=identicon&r=PG&f=1", "display_name": "Chris Hamilton", "link": "https://stackoverflow.com/users/7529405/chris-hamilton"}, "is_accepted": false, "score": 0, "last_activity_date": 1486554321, "creation_date": 1486554321, "answer_id": 42112214, "question_id": 42111562, "link": "https://stackoverflow.com/questions/42111562/vba-format-cell-fill-color-based-on-content-file-type/42112214#42112214", "title": "VBA Format cell fill color based on content file type", "body": "<p>Here is a solution not too far from your original code, using the InStr function to find the substrings \".pdf\", \".doc\", and \".jpg\".</p>\n\n<pre><code>Public Sub Master()\n\n  Dim TdCel As Range, FCell As Range\n\n  Set TdCel = Range(\"A1:A25\")\n\n  For Each FCell In TdCel\n\n    If InStr(FCell, \".pdf\") Then\n      FCell.Interior.ColorIndex = 10\n    ElseIf InStr(FCell, \".doc\") Then\n      FCell.Interior.ColorIndex = 9\n    ElseIf InStr(FCell, \".jpg\") Then\n      FCell.Interior.ColorIndex = 8\n    Else\n      FCell.Interior.Color = vbWhite\n    End If\n\n  Next\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 0, "creation_date": 1486638272, "post_id": 42117103, "comment_id": 71436196, "body": "Nice! I&#39;ve never saw that, might be handy sometimes! :)"}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "reply_to_user": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 0, "creation_date": 1486641186, "post_id": 42117103, "comment_id": 71438093, "body": "@R3uK, edited to make it even nicer and ... hoping you appreciate it!"}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 0, "creation_date": 1486641315, "post_id": 42117103, "comment_id": 71438180, "body": "I love it! :) But I can&#39;t upvote it more! BTW, if have you some notions in Word (not VBA though...) : <a href=\"http://stackoverflow.com/questions/42116944/calculation-fields-not-working-with-dates\" title=\"calculation fields not working with dates\">stackoverflow.com/questions/42116944/&hellip;</a>"}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "reply_to_user": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 0, "creation_date": 1486642900, "post_id": 42117103, "comment_id": 71439237, "body": "@R3uK, I&#39;ll have a look as soon as possible. Not promising any result though"}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 0, "creation_date": 1486642968, "post_id": 42117103, "comment_id": 71439294, "body": "No worries, it ain&#39;t that urgent but I hate word, especially when things should be working and yet they are quite painful!^^"}], "tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": false, "score": 1, "last_activity_date": 1486641131, "last_edit_date": 1486641131, "creation_date": 1486567543, "answer_id": 42117103, "question_id": 42111562, "link": "https://stackoverflow.com/questions/42111562/vba-format-cell-fill-color-based-on-content-file-type/42117103#42117103", "title": "VBA Format cell fill color based on content file type", "body": "<p>little <strong>edit</strong> to shorten down the code (and make @R3uK more undesirable...)</p>\n\n<p>you coudl use <a href=\"https://msdn.microsoft.com/en-us/library/office/gg264257(v=office.15).aspx\" rel=\"nofollow noreferrer\"><code>Switch()</code></a> function</p>\n\n<pre><code>Public Sub Master_JoaoTS()\n    Dim FCell As Range\n    Dim docType As String\n    Dim clrIndex As Variant\n\n    For Each FCell In Worksheets(\"myWorksheetName\").Range(\"A1:A25\").SpecialCells(xlCellTypeConstants, xlTextValues)\n        With FCell\n            docType = LCase(Right(.Value, Len(.Value) - InStrRev(.Value, \".\")))\n            clrIndex = Switch(docType = \"pdf\", 10, _\n                             docType = \"doc\", 9, _\n                             docType = \"jpg\", 8)\n            If IsNull(clrIndex) Then clrIndex = 2\n            .Interior.ColorIndex = clrIndex\n        End With\n    Next FCell\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 45, "user_id": 6493482, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2bac330e718b9332ce36f6906004bd9f?s=128&d=identicon&r=PG&f=1", "display_name": "JoaoTS", "link": "https://stackoverflow.com/users/6493482/joaots"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 533, "favorite_count": 0, "accepted_answer_id": 42112008, "answer_count": 3, "score": 2, "last_activity_date": 1486648335, "creation_date": 1486552378, "last_edit_date": 1486648335, "question_id": 42111562, "link": "https://stackoverflow.com/questions/42111562/vba-format-cell-fill-color-based-on-content-file-type", "title": "VBA Format cell fill color based on content file type", "body": "<p>I'm trying to read a list of documents in a column of Excel and depending the type of file change the color of the cell. but I can't do it. Any solutions? </p>\n\n<pre><code>Public Sub Master()\n\n       Dim TdCel As Range, FCell As Range\n\n       Set TdCel = Range(\"A1:A25\")\n\n       For Each FCell In TdCel\n\n          If FCell.Text = \"*.pdf\" Then\n                FCell.Interior.ColorIndex = 10\n            ElseIf FCell.Value = \"*.*.doc\" Then\n                FCell.Interior.ColorIndex = 9\n            ElseIf FCell.Value = \"*.jpg\" Then\n                FCell.Interior.ColorIndex = 8\n            Else\n                FCell.Interior.Color = vbWhite\n          End If\n       Next\n\n    End Sub\n</code></pre>\n"}, {"tags": ["c++", "vba", "dll"], "comments": [{"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 0, "creation_date": 1486551095, "post_id": 42110801, "comment_id": 71390900, "body": "Your function has a memory leak.  There is no need for <code>new</code> to create the map."}, {"owner": {"reputation": 11, "user_id": 7533774, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/12dd8c8ea446fd2d678582c674dd0de4?s=128&d=identicon&r=PG&f=1", "display_name": "nram", "link": "https://stackoverflow.com/users/7533774/nram"}, "reply_to_user": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 0, "creation_date": 1486553242, "post_id": 42110801, "comment_id": 71392406, "body": "When i replace map&lt;BSTR, map&lt;BSTR, double&gt; &gt;* nestedMap  = new map&lt;BSTR, map&lt;BSTR, double&gt; &gt;; with map&lt;BSTR, map&lt;BSTR, double&gt; &gt;* nestedMap  = map&lt;BSTR, map&lt;BSTR, double&gt; &gt;; or map&lt;BSTR, map&lt;BSTR, double&gt; &gt;* nestedMap; the code compiles but excel crashes when it accesses the dll.. @PaulMcKenzie Can you elaborate more on the memory leak and new?"}, {"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 0, "creation_date": 1486553573, "post_id": 42110801, "comment_id": 71392630, "body": "You allocate memory, and never deallocate it.  That is a memory leak.  Don&#39;t know how to make it simpler than that.  To avoid all of that <code>map&lt;BSTR, map&lt;BSTR, double&gt;&gt; nestedMap;</code>  No need for pointers."}, {"owner": {"reputation": 11, "user_id": 7533774, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/12dd8c8ea446fd2d678582c674dd0de4?s=128&d=identicon&r=PG&f=1", "display_name": "nram", "link": "https://stackoverflow.com/users/7533774/nram"}, "reply_to_user": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 0, "creation_date": 1486554455, "post_id": 42110801, "comment_id": 71393216, "body": "@PaulMcKenzie thanks help, pls bear with my ignorance I am rather new to c++ and c, I made the suggested changes, the function still returns a &#39;0&#39;.."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 7533774, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/12dd8c8ea446fd2d678582c674dd0de4?s=128&d=identicon&r=PG&f=1", "display_name": "nram", "link": "https://stackoverflow.com/users/7533774/nram"}, "edited": false, "score": 0, "creation_date": 1486573634, "post_id": 42114261, "comment_id": 71407024, "body": "Hi Bo!, thanks for pointing out that i was passing the address as a key in the map, I have corrected the same in the code now. I have to use BSTR(instead of a string) as the input array comes from EXCEL VBA.The function still returns &quot;0&quot;."}, {"owner": {"reputation": 11, "user_id": 7533774, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/12dd8c8ea446fd2d678582c674dd0de4?s=128&d=identicon&r=PG&f=1", "display_name": "nram", "link": "https://stackoverflow.com/users/7533774/nram"}, "edited": false, "score": 0, "creation_date": 1486574184, "post_id": 42114261, "comment_id": 71407378, "body": "I even tried         <code>BSTR* ON;         BSTR* VOLATM;         *ON =L&quot;ON&quot;;         *VOLATM=L&quot;VOLATM&quot;;         x=nestedMap[*ON][*VOLATM];</code> insted of         <code>BSTR ON=L&quot;1Y&quot;;          BSTR VOLATM=L&quot;VOLATM&quot;;          x=nestedMapAlais[ON][VOLATM];</code> I still get the same result.."}], "tags": [], "owner": {"reputation": 85822, "user_id": 597607, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jCzJi.png?s=128&g=1", "display_name": "Bo Persson", "link": "https://stackoverflow.com/users/597607/bo-persson"}, "is_accepted": false, "score": 0, "last_activity_date": 1486559879, "creation_date": 1486559879, "answer_id": 42114261, "question_id": 42110801, "link": "https://stackoverflow.com/questions/42110801/when-i-pass-an-array-of-strings-from-vba-to-c-and-use-them-as-keys-in-a-map-w/42114261#42114261", "title": "When i pass an array of strings from VBA to c++ and use them as keys in a map, why am i not able to retrieve data (using the keys) from the map?", "body": "<p>The type <code>BSTR</code> is a pointer, so you use the address stored in the pointer as a key in the map, not the string value pointed to.</p>\n\n<p>Trying to do a lookup with an identical string value, but stored at a different address will not find the original entry in the map.</p>\n\n<p>In C++ it is common to use a <code>map&lt;std::string, double&gt;</code> to avoid this problem.</p>\n"}, {"comments": [{"owner": {"reputation": 11, "user_id": 7533774, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/12dd8c8ea446fd2d678582c674dd0de4?s=128&d=identicon&r=PG&f=1", "display_name": "nram", "link": "https://stackoverflow.com/users/7533774/nram"}, "edited": false, "score": 0, "creation_date": 1486627686, "post_id": 42122464, "comment_id": 71429380, "body": "Thanks for the help, I have made the changes as suggested above. Now i get an <i>undefined reference to `SysStringLen@4</i> error. I have included the OleAuto.h file as header. I am using CodeBlocks IDE and MinGW compiler.."}, {"owner": {"reputation": 194, "user_id": 5802276, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f55f97bea0dc3f4d25395f71048f2b9?s=128&d=identicon&r=PG&f=1", "display_name": "Boris Glick", "link": "https://stackoverflow.com/users/5802276/boris-glick"}, "reply_to_user": {"reputation": 11, "user_id": 7533774, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/12dd8c8ea446fd2d678582c674dd0de4?s=128&d=identicon&r=PG&f=1", "display_name": "nram", "link": "https://stackoverflow.com/users/7533774/nram"}, "edited": false, "score": 0, "creation_date": 1486650795, "post_id": 42122464, "comment_id": 71444912, "body": "In MSVC, you&#39;d need to link against OleAut32.lib: <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/ms221240(v=vs.85).aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/windows/desktop/&hellip;</a> . If all fails, you&#39;ll have to just assume that the BSTR is null-terminated (they usually are), and implement it like so: <code>std::wstring BstrToString(BSTR s){ return s ? s : L&quot;&quot; ; }</code>"}], "tags": [], "owner": {"reputation": 194, "user_id": 5802276, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f55f97bea0dc3f4d25395f71048f2b9?s=128&d=identicon&r=PG&f=1", "display_name": "Boris Glick", "link": "https://stackoverflow.com/users/5802276/boris-glick"}, "is_accepted": false, "score": 0, "last_activity_date": 1486583844, "creation_date": 1486583844, "answer_id": 42122464, "question_id": 42110801, "link": "https://stackoverflow.com/questions/42110801/when-i-pass-an-array-of-strings-from-vba-to-c-and-use-them-as-keys-in-a-map-w/42122464#42122464", "title": "When i pass an array of strings from VBA to c++ and use them as keys in a map, why am i not able to retrieve data (using the keys) from the map?", "body": "<p>When handling BSTRs, keep in mind that a BSTR is not a normal string.  BSTR values must be allocated using Win32 API calls like SysAllocString(), and freed using SysFreeString().  In addition, BSTR can be NULL (which is a valid empty string).</p>\n\n<p>Some suggestions:</p>\n\n<ol>\n<li><p>Make sure your VBA arrays are fixed-sized.  Otherwise, they are stored as SAFEARRAY, not a C-style array.</p></li>\n<li><p>Use proper API to allocate and free BSTRs:</p>\n\n<pre><code>BSTR sOn = SysAllocStringW(L\"1Y\");\n...\nSysFreeString(sOn);\n</code></pre></li>\n<li><p>Instead of dealing with BSTRs directly, convert them into strings of wide chars.  (Note that a BSTR encoding an empty string can be (but not necessarily is) a NULL pointer). Here's one example of such conversion function:</p>\n\n<pre><code>std::wstring BstrToString(BSTR s)\n{\n    return std::wstring(s, s + SysStringLen(sMyHello));\n}\n</code></pre></li>\n</ol>\n\n<p>To summarize:</p>\n\n<pre><code>map&lt;std::wstring, map&lt;std::wstring, double&gt; &gt; nestedMap;\n\nfor (int i=0; i&lt;VolArrayTenorLen;++i)\n{\n    for (int j=0; j&lt;VolArrayDataLen;++j)\n    {\n        double a = *(VolArray_destination + (i * VolArrayDataLen) + (j));\n        BSTR b = *(VolArrayTenor_destination + i);\n        BSTR c = *(VolArrayData_destination + j);\n        nestedMapAlais[BstrToString(b)][BstrToString(c)] = a;\n    }\n}\nx=nestedMapAlais[L\"1Y\"][L\"VOLATM\"];\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 7533774, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/12dd8c8ea446fd2d678582c674dd0de4?s=128&d=identicon&r=PG&f=1", "display_name": "nram", "link": "https://stackoverflow.com/users/7533774/nram"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 303, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1486583844, "creation_date": 1486550256, "last_edit_date": 1486573580, "question_id": 42110801, "link": "https://stackoverflow.com/questions/42110801/when-i-pass-an-array-of-strings-from-vba-to-c-and-use-them-as-keys-in-a-map-w", "title": "When i pass an array of strings from VBA to c++ and use them as keys in a map, why am i not able to retrieve data (using the keys) from the map?", "body": "<p>I am trying to pass 2 arrays of strings from vba to c++ and use them as keys to a nested map. The data corresponding to the keys is passed as an array of doubles. First array of strings (VolArrayTenor_Destination) contains \"ON\", \"1W\", \"1M\", \"3M\", \"6M\" and the other array of strings (VolArrayData_Destination) contains \"ATMVOL\", \"25RR\", \"10FLY\". I am trying to get the data using keys in the code and it returns a 0 value, my guess is that it cannot find the keys from the map.</p>\n\n<pre><code>double convert2Maps(double* VolArray_destination, BSTR* VolArrayTenor_destination, BSTR* VolArrayData_destination,\n                 long VolArrayTenorLen, long VolArrayDataLen )\n{\n\ndouble a ,x;\nBSTR* b;\nBSTR* c;\nmap&lt;BSTR, map&lt;BSTR, double&gt; &gt;* nestedMap  = new map&lt;BSTR, map&lt;BSTR, double&gt; &gt;;\nmap&lt;BSTR, map&lt;BSTR, double&gt; &gt; &amp;nestedMapAlais = *nestedMap;\nfor (int i=0; i&lt;VolArrayTenorLen;++i)\n    for (int j=0; j&lt;VolArrayDataLen;++j)\n        {\n            {\n                a = *(VolArray_destination + (i * VolArrayDataLen) + (j));\n                b = ((VolArrayTenor_destination + i));\n                c = ((VolArrayData_destination + j));\n                nestedMapAlais[*b][*c] = a;\n            }\n        }\n\nBSTR ON=L\"1Y\";\nBSTR VOLATM=L\"VOLATM\";\n\nx=nestedMapAlais[ON][VOLATM];\nreturn (x);\n}\n</code></pre>\n"}, {"tags": ["vba", "excel", "while-loop", "do-while"], "comments": [{"owner": {"reputation": 552, "user_id": 2381028, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/1855097c6c29ed8c62fc4c78bccd967e?s=128&d=identicon&r=PG", "display_name": "Shmukko", "link": "https://stackoverflow.com/users/2381028/shmukko"}, "edited": false, "score": 0, "creation_date": 1486547874, "post_id": 42109141, "comment_id": 71388687, "body": "what do you mean with &quot;current&quot; cell. The selected cell in the sheet?"}, {"owner": {"reputation": 23, "user_id": 6740369, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-wNXslvLn-y4/AAAAAAAAAAI/AAAAAAAAAB4/M7f1SzZQgV0/photo.jpg?sz=128", "display_name": "Ashley Davies", "link": "https://stackoverflow.com/users/6740369/ashley-davies"}, "reply_to_user": {"reputation": 552, "user_id": 2381028, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/1855097c6c29ed8c62fc4c78bccd967e?s=128&d=identicon&r=PG", "display_name": "Shmukko", "link": "https://stackoverflow.com/users/2381028/shmukko"}, "edited": false, "score": 0, "creation_date": 1486548626, "post_id": 42109141, "comment_id": 71389231, "body": "@Shmukko I want to put them in the current cell next to the cell i got them from, however the code below does not work as it is only outputting one answer"}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 6740369, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-wNXslvLn-y4/AAAAAAAAAAI/AAAAAAAAAB4/M7f1SzZQgV0/photo.jpg?sz=128", "display_name": "Ashley Davies", "link": "https://stackoverflow.com/users/6740369/ashley-davies"}, "edited": false, "score": 0, "creation_date": 1486548560, "post_id": 42109956, "comment_id": 71389180, "body": "Unfortunately for some reason, this enters them correctly but keeps same value through all cells which is the last value of the do while loop, can someone else help? but thank you!"}, {"owner": {"reputation": 552, "user_id": 2381028, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/1855097c6c29ed8c62fc4c78bccd967e?s=128&d=identicon&r=PG", "display_name": "Shmukko", "link": "https://stackoverflow.com/users/2381028/shmukko"}, "reply_to_user": {"reputation": 23, "user_id": 6740369, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-wNXslvLn-y4/AAAAAAAAAAI/AAAAAAAAAB4/M7f1SzZQgV0/photo.jpg?sz=128", "display_name": "Ashley Davies", "link": "https://stackoverflow.com/users/6740369/ashley-davies"}, "edited": false, "score": 0, "creation_date": 1486548652, "post_id": 42109956, "comment_id": 71389244, "body": "which variable are you using? please edit your question and post your full code."}, {"owner": {"reputation": 23, "user_id": 6740369, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-wNXslvLn-y4/AAAAAAAAAAI/AAAAAAAAAB4/M7f1SzZQgV0/photo.jpg?sz=128", "display_name": "Ashley Davies", "link": "https://stackoverflow.com/users/6740369/ashley-davies"}, "edited": false, "score": 0, "creation_date": 1486549631, "post_id": 42109956, "comment_id": 71389896, "body": "&#39; I am using the string SerialNumber and it always will have a value of 3 strings in each loop, so I need to insert them each into cells on the right, your code does what in the sense of placing them in the right cells but not the right data, the data ends up like this:   Q52587\tQ52587\tQ52587 all the same numbers when the numbers in msgbox are completely different and this is the last msgbox value."}, {"owner": {"reputation": 23, "user_id": 6740369, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-wNXslvLn-y4/AAAAAAAAAAI/AAAAAAAAAB4/M7f1SzZQgV0/photo.jpg?sz=128", "display_name": "Ashley Davies", "link": "https://stackoverflow.com/users/6740369/ashley-davies"}, "edited": false, "score": 0, "creation_date": 1486550654, "post_id": 42109956, "comment_id": 71390600, "body": "For some reason the code keeps looping and freezes excel now"}, {"owner": {"reputation": 552, "user_id": 2381028, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/1855097c6c29ed8c62fc4c78bccd967e?s=128&d=identicon&r=PG", "display_name": "Shmukko", "link": "https://stackoverflow.com/users/2381028/shmukko"}, "reply_to_user": {"reputation": 23, "user_id": 6740369, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-wNXslvLn-y4/AAAAAAAAAAI/AAAAAAAAAB4/M7f1SzZQgV0/photo.jpg?sz=128", "display_name": "Ashley Davies", "link": "https://stackoverflow.com/users/6740369/ashley-davies"}, "edited": false, "score": 0, "creation_date": 1486550903, "post_id": 42109956, "comment_id": 71390760, "body": "Sorry. Forgot to increment index. I changed that. You can stop Code by ctrl+pause"}, {"owner": {"reputation": 23, "user_id": 6740369, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-wNXslvLn-y4/AAAAAAAAAAI/AAAAAAAAAB4/M7f1SzZQgV0/photo.jpg?sz=128", "display_name": "Ashley Davies", "link": "https://stackoverflow.com/users/6740369/ashley-davies"}, "edited": false, "score": 0, "creation_date": 1486559139, "post_id": 42109956, "comment_id": 71396417, "body": "Thank you @shmukko you helped amazingly!"}], "tags": [], "owner": {"reputation": 552, "user_id": 2381028, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/1855097c6c29ed8c62fc4c78bccd967e?s=128&d=identicon&r=PG", "display_name": "Shmukko", "link": "https://stackoverflow.com/users/2381028/shmukko"}, "is_accepted": true, "score": 0, "last_activity_date": 1486550885, "last_edit_date": 1486550885, "creation_date": 1486548063, "answer_id": 42109956, "question_id": 42109141, "link": "https://stackoverflow.com/questions/42109141/vba-do-while-loop-put-data-in-different-cells-each-time/42109956#42109956", "title": "VBA Do while Loop put data in different cells each time", "body": "<pre><code>dim i as integer\nDo While index &lt; Len(SNs)\n\n    SerialNumber = Mid(SNs, index, SNLength)\n    MsgBox \"Q\" + SerialNumber\n    index = index + SNLength\n\n    ActiveCell.Offset(0, i).Value = \"Q\" + SerialNumber\n\n    index = index + SNLength\n\n    i=i+1\nLoop\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 6740369, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-wNXslvLn-y4/AAAAAAAAAAI/AAAAAAAAAB4/M7f1SzZQgV0/photo.jpg?sz=128", "display_name": "Ashley Davies", "link": "https://stackoverflow.com/users/6740369/ashley-davies"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 206, "favorite_count": 0, "accepted_answer_id": 42109956, "answer_count": 1, "score": 1, "last_activity_date": 1486550885, "creation_date": 1486545800, "last_edit_date": 1486549623, "question_id": 42109141, "link": "https://stackoverflow.com/questions/42109141/vba-do-while-loop-put-data-in-different-cells-each-time", "title": "VBA Do while Loop put data in different cells each time", "body": "<p>I have recently been given a Do While Loop to spit out some numbers, you can see in another question that I asked, My problem now is I want to put the data in cells next to where I get the data from, So I know the row number for the row I get data from but because there are 3 different possible answers that could come out. I would need to put one value in each cell for example: A3,A4,A5 </p>\n\n<p>Dim SNs As String</p>\n\n<pre><code>SNs = \"Q\" &amp; xout\n\n\nConst SNLength As Integer = 5\n\nDim SerialNumber As String\nDim index As Integer\n\nIf Left(SNs, 1) = \"Q\" Then SNs = Mid(SNs, 2)\n\nindex = 1\n\n\n\nDo While index &lt; Len(SNs)\n    SerialNumber = Mid(SNs, index, SNLength)\n\n\n    'Code from user\n\n\nWorksheets(\"Calendar\").Range(\"H\" &amp; Rng.Row).Activate\n\nActiveCell.Offset(0, 0).Value = \"Q\" + SerialNumber\nActiveCell.Offset(0, 1).Value = \"Q\" + SerialNumber\nActiveCell.Offset(0, 2).Value = \"Q\" + SerialNumber\n\n    index = index + SNLength\n\n\n\n  ' I am using the string SerialNumber and it always will have a value of 3 strings in each loop, so I need to insert them each into cells on the right, your code does what in the sense of placing them in the right cells but not the right data, the data ends up like this: \n</code></pre>\n\n<p>Q52587  Q52587  Q52587 all the same numbers when the numbers in msgbox are completely different and this is the last msgbox value. </p>\n\n<pre><code>Loop\n</code></pre>\n\n<p>Please can someone help me out this has got me baffled :) </p>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 22957, "user_id": 78522, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3facb4a672d9fbeb9f2ed6b5acc65633?s=128&d=identicon&r=PG", "display_name": "Patrick Honorez", "link": "https://stackoverflow.com/users/78522/patrick-honorez"}, "edited": false, "score": 0, "creation_date": 1486544726, "post_id": 42108464, "comment_id": 71386357, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/33896746/insert-into-access-select-from-excel-from-within-access-vba\">Insert into Access Select from Excel from within Access VBA</a>"}], "answers": [{"comments": [{"owner": {"reputation": 65, "user_id": 3663792, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dpccU.jpg?s=128&g=1", "display_name": "KjBox", "link": "https://stackoverflow.com/users/3663792/kjbox"}, "edited": false, "score": 0, "creation_date": 1486550384, "post_id": 42109632, "comment_id": 71390402, "body": "Had to remove the parentheses after SELECT, but otherwise perfect solution, many thanks."}], "tags": [], "owner": {"reputation": 1445, "user_id": 6065909, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/59936064c95a62d283737b9e18ad95ae?s=128&d=identicon&r=PG&f=1", "display_name": "marlan", "link": "https://stackoverflow.com/users/6065909/marlan"}, "is_accepted": true, "score": 1, "last_activity_date": 1486547882, "last_edit_date": 1486547882, "creation_date": 1486547210, "answer_id": 42109632, "question_id": 42108464, "link": "https://stackoverflow.com/questions/42108464/using-insert-into-select-for-importing-excel-to-access/42109632#42109632", "title": "Using INSERT INTO.....SELECT for importing Excel to Access", "body": "<p>Use a temp location for mapping (and filtering) issues, gives you better control over the process </p>\n\n<pre><code>DoCmd.TransferSpreadsheet acImport, 8, \"TempSummary\", selectFile(), True\n</code></pre>\n\n<p>Then Check Mappings, and insert the data:  </p>\n\n<pre><code>CurrentDB.Execute \"INSERT INTO Summary (OFFER, DESCRIPTION, [Total AMRM], RMACCNUM) \" &amp; _   \n\"SELECT(OFFER, DESCRIPTION, [Total AMRM], RMACCNUM) \" &amp; _   \n\"FROM TempSummary\"\n</code></pre>\n\n<p>Finaly, delete the Temp table:</p>\n\n<pre><code>CurrentDb.TableDefs.Delete \"TempSummary\"\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": false, "score": 0, "last_activity_date": 1486550100, "creation_date": 1486550100, "answer_id": 42110735, "question_id": 42108464, "link": "https://stackoverflow.com/questions/42108464/using-insert-into-select-for-importing-excel-to-access/42110735#42110735", "title": "Using INSERT INTO.....SELECT for importing Excel to Access", "body": "<p>You will be better off <em>linking</em> the spreadsheet.</p>\n\n<p>Then create a simple <em>select query</em> that uses the linked table as source. In this, rename (alias) the fields if needed, and do simple converting and filtering like converting text data to numbers, text dates to true dates, excluding Null values, etc.</p>\n\n<p>Save this query and use it for your further processing like appending records to existing tables.</p>\n"}], "owner": {"reputation": 65, "user_id": 3663792, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dpccU.jpg?s=128&g=1", "display_name": "KjBox", "link": "https://stackoverflow.com/users/3663792/kjbox"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 890, "favorite_count": 0, "accepted_answer_id": 42109632, "answer_count": 2, "score": 1, "last_activity_date": 1486550100, "creation_date": 1486543752, "last_edit_date": 1486544968, "question_id": 42108464, "link": "https://stackoverflow.com/questions/42108464/using-insert-into-select-for-importing-excel-to-access", "title": "Using INSERT INTO.....SELECT for importing Excel to Access", "body": "<p>I am trying to import data from Excel to Access.</p>\n\n<p>The Excel file gets selected using</p>\n\n<pre><code>Function selectFile()\n    Dim fd As FileDialog\n    Set fd = Application.FileDialog(msoFileDialogFilePicker)\n\n    With fd\n        If .Show Then\n            selectFile = .SelectedItems(1)\n        Else\n            End\n        End If\n    End With\n\n    Set fd = Nothing\nEnd Function\n</code></pre>\n\n<p>The file selected will always have just 1 worksheet</p>\n\n<p>Up to now I have been using TransferSpreadsheet</p>\n\n<pre><code>DoCmd.TransferSpreadsheet acImport, 8, \"Summary\", selectFile(), True\n</code></pre>\n\n<p>and all was well. However, the selected file may have additional, unwanted, columns of data. I just need the data in the first columns of data, Row 1 is a header row and the headers in the excel sheet match the first 4 column headers in the Access \"Summary\" Table (\"OFFER\", \"DESCRIPTION\", \"Total AMRM\", \"RMACCNUM\").</p>\n\n<p>An additional problem is that the worksheet with the data can be named \"Sheet1\", \"Summary\", or maybe something else!</p>\n\n<p>I have tried INSERT INTO......SELECT....FROM but cannot get the syntax right.</p>\n\n<p>Any help greatly appreciated.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1486544004, "post_id": 42108381, "comment_id": 71385935, "body": "How about simply <code>=column()</code>"}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "reply_to_user": {"reputation": 552, "user_id": 2381028, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/1855097c6c29ed8c62fc4c78bccd967e?s=128&d=identicon&r=PG", "display_name": "Shmukko", "link": "https://stackoverflow.com/users/2381028/shmukko"}, "edited": false, "score": 1, "creation_date": 1486544032, "post_id": 42108381, "comment_id": 71385952, "body": "@Shmukko : Wrong!  <a href=\"http://stackoverflow.com/questions/22542834/how-to-use-regular-expressions-regex-in-microsoft-excel-both-in-cell-and-loops\" title=\"how to use regular expressions regex in microsoft excel both in cell and loops\">stackoverflow.com/questions/22542834/&hellip;</a> you can use Regex in VBA"}, {"owner": {"reputation": 552, "user_id": 2381028, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/1855097c6c29ed8c62fc4c78bccd967e?s=128&d=identicon&r=PG", "display_name": "Shmukko", "link": "https://stackoverflow.com/users/2381028/shmukko"}, "reply_to_user": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 0, "creation_date": 1486544953, "post_id": 42108381, "comment_id": 71386513, "body": "@R3uK ok you&#39;re right. But you need a external reference."}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "reply_to_user": {"reputation": 552, "user_id": 2381028, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/1855097c6c29ed8c62fc4c78bccd967e?s=128&d=identicon&r=PG", "display_name": "Shmukko", "link": "https://stackoverflow.com/users/2381028/shmukko"}, "edited": false, "score": 2, "creation_date": 1486545046, "post_id": 42108381, "comment_id": 71386575, "body": "@Shmukko : Yeah, like a lot of things with VBA..."}], "answers": [{"tags": [], "owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "is_accepted": false, "score": 1, "last_activity_date": 1486544338, "creation_date": 1486544338, "answer_id": 42108638, "question_id": 42108381, "link": "https://stackoverflow.com/questions/42108381/how-to-get-column-number-in-excel-vba-using-regex/42108638#42108638", "title": "How to get column number in Excel VBA using regex?", "body": "<p>Try <code>Debug.Print Cells(5,7).Column</code>, it'll output <code>7</code>!</p>\n\n<p>Here is an example of a <code>.Find</code> method and it'll <em>output</em> the column of the found cells!</p>\n\n<pre><code>Sub test_Eswemenasja()\nDim FirstAddress As String, cF As Range, SearchedStr as String\nSearchedStr = \"Cat\"\n\nActiveSheet.Range(\"A1\").Activate\nWith ActiveSheet.Cells\n    'First, define properly the Find method\n    Set cF = .Find(What:=SearchedStr, _\n                After:=ActiveCell, _\n                LookIn:=xlFormulas, _\n                LookAt:=xlPart, _\n                SearchOrder:=xlByColumns, _\n                SearchDirection:=xlNext, _\n                MatchCase:=False, _\n                SearchFormat:=False)\n\n    'If there is a result, keep looking with FindNext method\n    If Not cF Is Nothing Then\n        FirstAddress = cF.Address\n        Do\n            'Message with the column number!\n            MsgBox \"Found in column : \" &amp; cF.column\n            Set cF = .FindNext(cF)\n        'Look until you find again the first result\n        Loop While Not cF Is Nothing And cF.Address &lt;&gt; FirstAddress\n    End If\nEnd With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 125, "user_id": 5887081, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/5621635a054d8f914bee3beac8d23f0d?s=128&d=identicon&r=PG&f=1", "display_name": "Eswemenasja", "link": "https://stackoverflow.com/users/5887081/eswemenasja"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 50, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1486544355, "creation_date": 1486543491, "last_edit_date": 1486544355, "question_id": 42108381, "link": "https://stackoverflow.com/questions/42108381/how-to-get-column-number-in-excel-vba-using-regex", "title": "How to get column number in Excel VBA using regex?", "body": "<p>I know how to return column number using .Match, .Find and with iteration (yuck).</p>\n\n<p>Is it possible to have it done more quickly using regex?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1486542569, "post_id": 42108014, "comment_id": 71385094, "body": "you say you have two options working: why don&#39;t you use them?"}, {"owner": {"reputation": 239, "user_id": 7424955, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/a3a1a84a7bf05408c05b081da20fa17a?s=128&d=identicon&r=PG&f=1", "display_name": "tombata", "link": "https://stackoverflow.com/users/7424955/tombata"}, "reply_to_user": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1486542662, "post_id": 42108014, "comment_id": 71385144, "body": "they do not work with the variable"}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 1, "creation_date": 1486542695, "post_id": 42108014, "comment_id": 71385167, "body": "@tombata : it&#39;s because it&#39;s not a variable, check my answer! ;)"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 1, "creation_date": 1486542893, "post_id": 42108014, "comment_id": 71385264, "body": "WHY are you trying to do this?  There may be a better way.  What is the value of <code>stMsg</code> and how was that variable created?"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 1, "creation_date": 1486543650, "post_id": 42108014, "comment_id": 71385699, "body": "It seems really strange to be taking the length of a string, dividing that length by 2 (rounding any 1/2s to the nearest even number - e.g. if <code>stMsg</code> is 11, 12 or 13 characters long you would calculate 6, if it was 14 characters long you would calculate 7, if it was 15, 16 or 17 characters long you would calculate 8, etc), and then expecting that many characters taken from the start of the string to be a valid range address."}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1486544009, "post_id": 42108014, "comment_id": 71385937, "body": "You say you have <code>stMsg=&#39;Sheet2&#39;!$C$8&#39;Sheet2&#39;!$C$8</code> thus <code>x=&#39;Sheet2&#39;!$C$8&#39;</code> and that <code>2 option</code> works with such an <code>x</code>: what&#39;s the problem then?"}, {"owner": {"reputation": 239, "user_id": 7424955, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/a3a1a84a7bf05408c05b081da20fa17a?s=128&d=identicon&r=PG&f=1", "display_name": "tombata", "link": "https://stackoverflow.com/users/7424955/tombata"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1486544230, "post_id": 42108014, "comment_id": 71386051, "body": "@YowE3K  the string is always an even number."}], "answers": [{"comments": [{"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "reply_to_user": {"reputation": 239, "user_id": 7424955, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/a3a1a84a7bf05408c05b081da20fa17a?s=128&d=identicon&r=PG&f=1", "display_name": "tombata", "link": "https://stackoverflow.com/users/7424955/tombata"}, "edited": false, "score": 0, "creation_date": 1486542739, "post_id": 42108113, "comment_id": 71385188, "body": "@tombata : What is your input in for <code>stMsg</code>?"}, {"owner": {"reputation": 239, "user_id": 7424955, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/a3a1a84a7bf05408c05b081da20fa17a?s=128&d=identicon&r=PG&f=1", "display_name": "tombata", "link": "https://stackoverflow.com/users/7424955/tombata"}, "edited": false, "score": 0, "creation_date": 1486542943, "post_id": 42108113, "comment_id": 71385289, "body": "<code>stMsg</code> comes from the first part of the macro. It is the precedents of a formula in a cell. So <code>stMsg</code> finds the precedents in a formula (there are 2 precedents) and then I want to go to the first precedent. I use x to split them, which works fine, but the jump to the cell does not."}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "reply_to_user": {"reputation": 239, "user_id": 7424955, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/a3a1a84a7bf05408c05b081da20fa17a?s=128&d=identicon&r=PG&f=1", "display_name": "tombata", "link": "https://stackoverflow.com/users/7424955/tombata"}, "edited": false, "score": 0, "creation_date": 1486543066, "post_id": 42108113, "comment_id": 71385366, "body": "@tombata : So what are the <b>values</b> for <code>stMsg</code>? Use <code>Debug.Print stMsg</code> and tell me what it is."}, {"owner": {"reputation": 239, "user_id": 7424955, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/a3a1a84a7bf05408c05b081da20fa17a?s=128&d=identicon&r=PG&f=1", "display_name": "tombata", "link": "https://stackoverflow.com/users/7424955/tombata"}, "edited": false, "score": 0, "creation_date": 1486543194, "post_id": 42108113, "comment_id": 71385449, "body": "the value of <code>stMsg</code> is &#39;Sheet2&#39;!$C$8&#39;Sheet2&#39;!$C$8"}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "reply_to_user": {"reputation": 239, "user_id": 7424955, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/a3a1a84a7bf05408c05b081da20fa17a?s=128&d=identicon&r=PG&f=1", "display_name": "tombata", "link": "https://stackoverflow.com/users/7424955/tombata"}, "edited": false, "score": 0, "creation_date": 1486543690, "post_id": 42108113, "comment_id": 71385722, "body": "@tombata : <a href=\"https://msdn.microsoft.com/fr-fr/library/office/ff839232.aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/fr-fr/library/office/ff839232.aspx</a> See that and fully working code"}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "reply_to_user": {"reputation": 239, "user_id": 7424955, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/a3a1a84a7bf05408c05b081da20fa17a?s=128&d=identicon&r=PG&f=1", "display_name": "tombata", "link": "https://stackoverflow.com/users/7424955/tombata"}, "edited": false, "score": 0, "creation_date": 1486556530, "post_id": 42108113, "comment_id": 71394599, "body": "@tombata : This is working so please take time to accept an answer and close that question"}, {"owner": {"reputation": 239, "user_id": 7424955, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/a3a1a84a7bf05408c05b081da20fa17a?s=128&d=identicon&r=PG&f=1", "display_name": "tombata", "link": "https://stackoverflow.com/users/7424955/tombata"}, "edited": false, "score": 0, "creation_date": 1486556740, "post_id": 42108113, "comment_id": 71394746, "body": "It is stil not working with me. If I write it this way <code>With Range(&quot;&#39;Sheet2&#39;!$C$8&quot;)</code> it works. However, it does not work with <code>x</code>   <code>With Range(x)</code> and  <code>x=&#39;Sheet2&#39;!$C$8 </code>"}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "reply_to_user": {"reputation": 239, "user_id": 7424955, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/a3a1a84a7bf05408c05b081da20fa17a?s=128&d=identicon&r=PG&f=1", "display_name": "tombata", "link": "https://stackoverflow.com/users/7424955/tombata"}, "edited": false, "score": 0, "creation_date": 1486556945, "post_id": 42108113, "comment_id": 71394899, "body": "@tombata : It should be <code>x =&quot;&#39;Sheet2&#39;!$C$8&quot;</code> and it is working with that. Also, you don&#39;t need both for what you are trying to do, so why bother?"}, {"owner": {"reputation": 239, "user_id": 7424955, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/a3a1a84a7bf05408c05b081da20fa17a?s=128&d=identicon&r=PG&f=1", "display_name": "tombata", "link": "https://stackoverflow.com/users/7424955/tombata"}, "edited": false, "score": 0, "creation_date": 1486557142, "post_id": 42108113, "comment_id": 71395043, "body": "I need it to work with x. Both <code>With Range(x)</code> and <code>With Range(&quot;x&quot;)</code> do not work"}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "reply_to_user": {"reputation": 239, "user_id": 7424955, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/a3a1a84a7bf05408c05b081da20fa17a?s=128&d=identicon&r=PG&f=1", "display_name": "tombata", "link": "https://stackoverflow.com/users/7424955/tombata"}, "edited": false, "score": 0, "creation_date": 1486557345, "post_id": 42108113, "comment_id": 71395188, "body": "@tombata : Man, I&#39;m sorry, but read the 1st line of my answer again and use the code <code>Sub test_tombata(stMsg As String)</code> or <code>Sub test_tombata2(x As String)</code>. Because those code works"}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "reply_to_user": {"reputation": 239, "user_id": 7424955, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/a3a1a84a7bf05408c05b081da20fa17a?s=128&d=identicon&r=PG&f=1", "display_name": "tombata", "link": "https://stackoverflow.com/users/7424955/tombata"}, "edited": false, "score": 0, "creation_date": 1486557763, "post_id": 42108113, "comment_id": 71395494, "body": "@tombata : I&#39;ve added another sub to show that both works : <code>Sub TEST_test_tombata()</code>"}], "tags": [], "owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "is_accepted": true, "score": 1, "last_activity_date": 1486557387, "last_edit_date": 1486557387, "creation_date": 1486542605, "answer_id": 42108113, "question_id": 42108014, "link": "https://stackoverflow.com/questions/42108014/vba-code-does-not-jump-to-cell/42108113#42108113", "title": "VBA code does not jump to cell", "body": "<p><code>x</code>is your variable and you are trying to use it as <code>\"x\"</code>, which is a text only containing the letter <strong>x</strong></p>\n\n<p>So your code should be more like this :</p>\n\n<pre><code>Dim x As String\nx = Left(stMsg, Len(stMsg) / 2)\n\n'''Option 1\nApplication.Goto Reference:=x\n\n'''Option 2\nWith Range(x)\n    .Parent.Activate\n    .Activate\nEnd With\n</code></pre>\n\n<p>And working for both options with : <br>\nInput provided by OP : <code>'Sheet2'!$C$8'Sheet2'!$C$8</code></p>\n\n<pre><code>Sub test_tombata(stMsg As String)\n\nDim x As String\nx = Left(stMsg, Len(stMsg) / 2) 'x = \"'Sheet2'!$C$8\"\n'Debug.Print x\n\n'''Option 1\nApplication.Goto Reference:=Sheets(Replace(Split(x, \"!\")(0), \"'\", vbNullString)).Range(Split(x, \"!\")(1))\n\n'''Option 2\nWith Range(x)\n    .Parent.Activate\n    .Activate\nEnd With\n\nEnd Sub\n</code></pre>\n\n<p>And working for both options with : <br>\nInput provided by OP : <code>'Sheet2'!$C$8</code></p>\n\n<pre><code>Sub test_tombata2(x As String)\n\n'''Option 1\nApplication.Goto Reference:=Sheets(Replace(Split(x, \"!\")(0), \"'\", vbNullString)).Range(Split(x, \"!\")(1))\n\n'''Option 2\nWith Range(x)\n    .Parent.Activate\n    .Activate\nEnd With\n\nEnd Sub\n</code></pre>\n\n<p>Code to try both :</p>\n\n<pre><code>Sub TEST_test_tombata()\n\ntest_tombata \"'Sheet2'!$C$8'Sheet2'!$C$8\"\n\ntest_tombata2 \"'Sheet2'!$C$8\"\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 0, "creation_date": 1486543958, "post_id": 42108425, "comment_id": 71385914, "body": "? Why Dim <code>col</code> as string and fill it with a number?? <code>rw</code> is a variant the way you declare it. And you wouldn&#39;t have to use <code>+-0</code> if you declare the variable with a good fit..."}, {"owner": {"reputation": 313, "user_id": 4299161, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EFEji.jpg?s=128&g=1", "display_name": "Mohammed", "link": "https://stackoverflow.com/users/4299161/mohammed"}, "reply_to_user": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 0, "creation_date": 1486544546, "post_id": 42108425, "comment_id": 71386252, "body": "@R3uK Yeah it should be integer, will edit it, it will work as string though."}], "tags": [], "owner": {"reputation": 313, "user_id": 4299161, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EFEji.jpg?s=128&g=1", "display_name": "Mohammed", "link": "https://stackoverflow.com/users/4299161/mohammed"}, "is_accepted": false, "score": 0, "last_activity_date": 1486544555, "last_edit_date": 1486544555, "creation_date": 1486543648, "answer_id": 42108425, "question_id": 42108014, "link": "https://stackoverflow.com/questions/42108014/vba-code-does-not-jump-to-cell/42108425#42108425", "title": "VBA code does not jump to cell", "body": "<p>Hope below is whats you, by assuming K9 is contains the target range:</p>\n\n<pre><code>Dim rw, col As integer\nrw = Range(Range(\"K9\").Value).Row\ncol = Range(Range(\"K9\").Value).Column\nApplication.Goto ActiveSheet.Cells(rw + 0, col - 0)\n</code></pre>\n"}], "owner": {"reputation": 239, "user_id": 7424955, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/a3a1a84a7bf05408c05b081da20fa17a?s=128&d=identicon&r=PG&f=1", "display_name": "tombata", "link": "https://stackoverflow.com/users/7424955/tombata"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 450, "favorite_count": 0, "accepted_answer_id": 42108113, "answer_count": 2, "score": 0, "last_activity_date": 1486557387, "creation_date": 1486542283, "last_edit_date": 1486543116, "question_id": 42108014, "link": "https://stackoverflow.com/questions/42108014/vba-code-does-not-jump-to-cell", "title": "VBA code does not jump to cell", "body": "<p>Hy I am trying to make a code that jumps to a cell. </p>\n\n<p>The address is stored in a variable. </p>\n\n<p>I tried 2 options, but both do not work with the variable.</p>\n\n<p>They work fine with the concrete cell address.</p>\n\n<pre><code>Dim stMsg As String\nDim x As String\n\n x = Left(stMsg, Len(stMsg) / 2) 'x = 'Sheet2'!$C$8\n\n    '1 Option\n    Application.Goto Reference:=\"x\" 'this works with format: Sheet2!R8C3\n\n    '2 Option\n    With Range(\"x\")  'this works with format: 'Sheet2'!$C$8 , which is exactly x\n    .Parent.Activate\n    .Activate\n    End With\n</code></pre>\n\n<p>It gives me </p>\n\n<blockquote>\n  <p>Method 'Range' or object'_Global' failed\" error.</p>\n</blockquote>\n\n<p><code>stMsg</code> is a variable found in the first part of the macro. The first part take a formula in a cell and find the precedents in the formula, which are 2. <code>stMsg</code> stores them both, that's why I split it with x. The value of <code>stMsg</code> is 'Sheet2'!$C$8'Sheet2'!$C$8</p>\n\n<p>How can I make it work with x?</p>\n"}, {"tags": ["vba", "excel", "replace", "vlookup"], "comments": [{"owner": {"reputation": 145, "user_id": 6821241, "user_type": "registered", "accept_rate": 29, "profile_image": "https://i.stack.imgur.com/ugKRa.jpg?s=128&g=1", "display_name": "Martin Router King", "link": "https://stackoverflow.com/users/6821241/martin-router-king"}, "edited": false, "score": 0, "creation_date": 1486542681, "post_id": 42107898, "comment_id": 71385155, "body": "How many rows do you have in Column E? You may try to find the last row that contains data before you start the for loop in order to not spend any time checking cells that don&#39;t contain any data."}, {"owner": {"reputation": 145, "user_id": 6821241, "user_type": "registered", "accept_rate": 29, "profile_image": "https://i.stack.imgur.com/ugKRa.jpg?s=128&g=1", "display_name": "Martin Router King", "link": "https://stackoverflow.com/users/6821241/martin-router-king"}, "edited": false, "score": 0, "creation_date": 1486542800, "post_id": 42107898, "comment_id": 71385216, "body": "Try adding these two lines and tell me if it improves.  <code>LastRow = Sheets(&quot;Customer List&quot;).Cells(Rows.Count, 5).End(xlUp).Row</code> <code>For Each myCell In Sheets(&quot;Customer List&quot;).Range(&quot;E1:E&quot; &amp; LastRow &amp; &quot;&quot;)</code>"}, {"owner": {"reputation": 2953, "user_id": 2801253, "user_type": "registered", "profile_image": "https://graph.facebook.com/1332362525/picture?type=large", "display_name": "Mark Fitzgerald", "link": "https://stackoverflow.com/users/2801253/mark-fitzgerald"}, "edited": false, "score": 0, "creation_date": 1486548100, "post_id": 42107898, "comment_id": 71388864, "body": "May be better on <a href=\"http://codereview.stackexchange.com/questions/tagged/vba?sort=newest&amp;pageSize=50\">CodeReview</a>"}, {"owner": {"reputation": 2953, "user_id": 2801253, "user_type": "registered", "profile_image": "https://graph.facebook.com/1332362525/picture?type=large", "display_name": "Mark Fitzgerald", "link": "https://stackoverflow.com/users/2801253/mark-fitzgerald"}, "edited": false, "score": 0, "creation_date": 1486549827, "post_id": 42107898, "comment_id": 71390033, "body": "How many used rows in your sheet?  What percentage of those do you expect to get a match to &#39;Modify Order!&#39;B4?"}], "answers": [{"tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": false, "score": 0, "last_activity_date": 1486542923, "creation_date": 1486542923, "answer_id": 42108209, "question_id": 42107898, "link": "https://stackoverflow.com/questions/42107898/vlookup-and-replace-performance-improvement/42108209#42108209", "title": "vlookup and replace - performance improvement", "body": "<p>I'd use <code>AutoFilter()</code>:</p>\n\n<pre><code>Option Explicit\n\nPrivate Sub CommandButton1_Click()\n    Dim myLookup As Variant\n    Dim i As Integer\n\n    With Sheets(\"Modify Order\")\n        i = .Cells(5, 2).Value\n        myLookup = .Cells(4, 2).Value\n    End With\n    With Sheets(\"Customer List\")\n        With .Range(\"E1\", .Cells(.Rows.count, \"E\").End(xlUp))\n            .AutoFilter Field:=1, Criteria1:=myLookup\n            If Application.WorksheetFunction.Subtotal(103, .Cells) &gt; 1 Then .Offset(1, i).Resize(.Rows.count - 1).SpecialCells(xlCellTypeVisible).Value = Sheets(\"Modify Order\").Cells(7, 2).Value\n        End With\n        .AutoFilterMode = False\n    End With\n\n    MsgBox \"Done!\"\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 21725, "user_id": 88173, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/114b7dea411e3648a54fa459c89bed40?s=128&d=identicon&r=PG", "display_name": "Charles Williams", "link": "https://stackoverflow.com/users/88173/charles-williams"}, "is_accepted": false, "score": 1, "last_activity_date": 1486545603, "creation_date": 1486545603, "answer_id": 42109080, "question_id": 42107898, "link": "https://stackoverflow.com/questions/42107898/vlookup-and-replace-performance-improvement/42109080#42109080", "title": "vlookup and replace - performance improvement", "body": "<p>It is always very slow iterating cell-by-cell: better to use  variant arrays instead:</p>\n\n<pre><code>Sub CommandButton1_Click()\n\nDim vArrColE As Variant\nDim vArrColChange As Variant\nDim myLookup As Variant\nDim myChangeTo As Variant\nDim j As Long\nDim jLastRow As Long\nDim kCol As Long\nDim nChanged As Long\nDim lCalc As Long\n\nlCalc = Application.Calculation\nApplication.Calculation = xlCalculationManual\nApplication.ScreenUpdating = False\n\nmyLookup = Sheets(\"Modify Order\").Cells(4, 2).Value2\nmyChangeTo = Sheets(\"Modify Order\").Cells(7, 2).Value2\nkCol = Sheets(\"Modify Order\").Cells(5, 2).Value2\njLastRow = Sheets(\"Customer List\").Cells(Rows.Count, 5).End(xlUp).Row\n'\n' get columns into variant arrays\n'\nvArrColE = Sheets(\"Customer List\").Range(\"E1:E\" &amp; jLastRow).Value2\nvArrColChange = Sheets(\"Customer List\").Cells(1, kCol).Resize(jLastRow, 1).Value2\n\nFor j = LBound(vArrColE) To UBound(vArrColE)\n    If vArrColE(j, 1) = myLookup Then\n        vArrColChange(j, 1) = myChangeTo\n        nChanged = nChanged + 1\n    End If\nNext j\n'\n' put changed column back\n'\nSheets(\"Customer List\").Cells(1, kCol).Resize(jLastRow, 1).Value2 = vArrColChange\n\nApplication.Calculation = lCalc\nMsgBox \"Changed \" &amp; nChanged &amp; \" Cells\"\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 7533228, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce4c55eab37a4e98b2907d3874463c82?s=128&d=identicon&r=PG&f=1", "display_name": "Leme", "link": "https://stackoverflow.com/users/7533228/leme"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 31, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1486545603, "creation_date": 1486541843, "last_edit_date": 1486542076, "question_id": 42107898, "link": "https://stackoverflow.com/questions/42107898/vlookup-and-replace-performance-improvement", "title": "vlookup and replace - performance improvement", "body": "<p>I want to create a macro which will vlookup in another sheet and change the value in the vlook up cell by another user defined value.</p>\n\n<p>I wrote a very basic code which full fills my need, but it is very slow and its one run takes almost 3 minutes. </p>\n\n<p>Can you please suggest an easier way out or just suggest what is wrong with my code. </p>\n\n<pre><code>Private Sub CommandButton1_Click()\n\n    Dim myCell As Range\n    Dim myLookup\n    Dim i As Integer\n    i = Sheets(\"Modify Order\").Cells(5, 2).Value\n     For Each myCell In Sheets(\"Customer List\").Range(\"E:E\")\n         If myCell.Value = Sheets(\"Modify Order\").Cells(4, 2).Value Then\n         myCell.Offset(0, i).Value = Sheets(\"Modify Order\").Cells(7, 2).Value\n         End If\n        Next myCell\n\nMsgBox \"Done!\"\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "excel-formula"], "comments": [{"owner": {"reputation": 22957, "user_id": 78522, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3facb4a672d9fbeb9f2ed6b5acc65633?s=128&d=identicon&r=PG", "display_name": "Patrick Honorez", "link": "https://stackoverflow.com/users/78522/patrick-honorez"}, "edited": false, "score": 0, "creation_date": 1486542018, "post_id": 42107599, "comment_id": 71384781, "body": "Perhaps you should clear the existing array before ? You can&#39;t change part of an existing array."}], "answers": [{"comments": [{"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "reply_to_user": {"reputation": 103, "user_id": 5549668, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/a256b6e2ae9d2428e376ecb1ad53bb87?s=128&d=identicon&r=PG&f=1", "display_name": "Empty", "link": "https://stackoverflow.com/users/5549668/empty"}, "edited": false, "score": 0, "creation_date": 1486545397, "post_id": 42107917, "comment_id": 71386820, "body": "@Empty : What is the error? I&#39;ve added a line to empty the range first"}, {"owner": {"reputation": 103, "user_id": 5549668, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/a256b6e2ae9d2428e376ecb1ad53bb87?s=128&d=identicon&r=PG&f=1", "display_name": "Empty", "link": "https://stackoverflow.com/users/5549668/empty"}, "edited": false, "score": 0, "creation_date": 1486546328, "post_id": 42107917, "comment_id": 71387442, "body": "Run-time error &#39;1004&#39;: Unable to set the FormulaArray property of the Range class"}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "reply_to_user": {"reputation": 103, "user_id": 5549668, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/a256b6e2ae9d2428e376ecb1ad53bb87?s=128&d=identicon&r=PG&f=1", "display_name": "Empty", "link": "https://stackoverflow.com/users/5549668/empty"}, "edited": false, "score": 0, "creation_date": 1486546717, "post_id": 42107917, "comment_id": 71387769, "body": "@Empty : I think the issue now is your formula. you have most of in <code>R1C1</code> refs but you also have a few like <code>INDEX(C2</code>, you should have all of the refs in the same style."}, {"owner": {"reputation": 103, "user_id": 5549668, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/a256b6e2ae9d2428e376ecb1ad53bb87?s=128&d=identicon&r=PG&f=1", "display_name": "Empty", "link": "https://stackoverflow.com/users/5549668/empty"}, "edited": false, "score": 0, "creation_date": 1486553807, "post_id": 42107917, "comment_id": 71392790, "body": "I will try to work on that. Hope can get it right. Thanks :)"}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "reply_to_user": {"reputation": 103, "user_id": 5549668, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/a256b6e2ae9d2428e376ecb1ad53bb87?s=128&d=identicon&r=PG&f=1", "display_name": "Empty", "link": "https://stackoverflow.com/users/5549668/empty"}, "edited": false, "score": 0, "creation_date": 1486553965, "post_id": 42107917, "comment_id": 71392888, "body": "@Empty : I changed the <code>INDEX(C2</code> into <code>INDEX(R2C3</code> in the <code>Option2</code>, try it! ;)"}, {"owner": {"reputation": 1029, "user_id": 1474994, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/rOT6j.png?s=128&g=1", "display_name": "UndeadBob", "link": "https://stackoverflow.com/users/1474994/undeadbob"}, "edited": false, "score": 0, "creation_date": 1486582398, "post_id": 42107917, "comment_id": 71412077, "body": "@R3uK You&#39;re kidding... the problem was in a <b>422</b> character formula. <i>shocking</i>"}, {"owner": {"reputation": 103, "user_id": 5549668, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/a256b6e2ae9d2428e376ecb1ad53bb87?s=128&d=identicon&r=PG&f=1", "display_name": "Empty", "link": "https://stackoverflow.com/users/5549668/empty"}, "reply_to_user": {"reputation": 1029, "user_id": 1474994, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/rOT6j.png?s=128&g=1", "display_name": "UndeadBob", "link": "https://stackoverflow.com/users/1474994/undeadbob"}, "edited": false, "score": 0, "creation_date": 1486970889, "post_id": 42107917, "comment_id": 71558955, "body": "@reasra Thanks for the advice, the run-time error &#39;1004&#39;: Unable to set the FormulaArray property of the Range class here is because of the length of Formula had over exceed the maximum (255)..."}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "reply_to_user": {"reputation": 103, "user_id": 5549668, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/a256b6e2ae9d2428e376ecb1ad53bb87?s=128&d=identicon&r=PG&f=1", "display_name": "Empty", "link": "https://stackoverflow.com/users/5549668/empty"}, "edited": false, "score": 0, "creation_date": 1486971680, "post_id": 42107917, "comment_id": 71559329, "body": "@Empty : Which version of Excel are you using?"}, {"owner": {"reputation": 103, "user_id": 5549668, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/a256b6e2ae9d2428e376ecb1ad53bb87?s=128&d=identicon&r=PG&f=1", "display_name": "Empty", "link": "https://stackoverflow.com/users/5549668/empty"}, "edited": false, "score": 0, "creation_date": 1487028796, "post_id": 42107917, "comment_id": 71592154, "body": "@R3uK version 2016"}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "reply_to_user": {"reputation": 103, "user_id": 5549668, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/a256b6e2ae9d2428e376ecb1ad53bb87?s=128&d=identicon&r=PG&f=1", "display_name": "Empty", "link": "https://stackoverflow.com/users/5549668/empty"}, "edited": false, "score": 0, "creation_date": 1487060233, "post_id": 42107917, "comment_id": 71602181, "body": "@Empty : Ok... Strange, I&#39;d have said that this wasn&#39;t an issue anymore... For <b>Excel 2007 to 2016, Length of formula contents: 8,192 characters and Internal length of formula: 16,384 bytes</b>. Does the code work with a shorter formula?"}, {"owner": {"reputation": 103, "user_id": 5549668, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/a256b6e2ae9d2428e376ecb1ad53bb87?s=128&d=identicon&r=PG&f=1", "display_name": "Empty", "link": "https://stackoverflow.com/users/5549668/empty"}, "edited": false, "score": 0, "creation_date": 1487141310, "post_id": 42107917, "comment_id": 71643408, "body": "I had tried for a week to workout with this issue, unfortunately I still get the similar error. I guess I need help from here.."}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "reply_to_user": {"reputation": 103, "user_id": 5549668, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/a256b6e2ae9d2428e376ecb1ad53bb87?s=128&d=identicon&r=PG&f=1", "display_name": "Empty", "link": "https://stackoverflow.com/users/5549668/empty"}, "edited": false, "score": 0, "creation_date": 1487144310, "post_id": 42107917, "comment_id": 71644964, "body": "@Empty : have you tried with a shorter formula? Pick a simple one and try  with!"}, {"owner": {"reputation": 103, "user_id": 5549668, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/a256b6e2ae9d2428e376ecb1ad53bb87?s=128&d=identicon&r=PG&f=1", "display_name": "Empty", "link": "https://stackoverflow.com/users/5549668/empty"}, "edited": false, "score": 1, "creation_date": 1487149445, "post_id": 42107917, "comment_id": 71647906, "body": "@R3uK: I&#39;ve give up using formula. I&#39;m using VBA code. The problem was solved. Thanks for the advise from all for these few weeks. Appreciated."}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "reply_to_user": {"reputation": 103, "user_id": 5549668, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/a256b6e2ae9d2428e376ecb1ad53bb87?s=128&d=identicon&r=PG&f=1", "display_name": "Empty", "link": "https://stackoverflow.com/users/5549668/empty"}, "edited": false, "score": 0, "creation_date": 1487152361, "post_id": 42107917, "comment_id": 71650001, "body": "@Empty : Ok, glad you found a solution even if it was on your own! ;)"}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "reply_to_user": {"reputation": 103, "user_id": 5549668, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/a256b6e2ae9d2428e376ecb1ad53bb87?s=128&d=identicon&r=PG&f=1", "display_name": "Empty", "link": "https://stackoverflow.com/users/5549668/empty"}, "edited": false, "score": 0, "creation_date": 1487152382, "post_id": 42107917, "comment_id": 71650024, "body": "@Empty : And a little upvote would be very heart warming! ;)"}], "tags": [], "owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "is_accepted": false, "score": 0, "last_activity_date": 1486553927, "last_edit_date": 1486553927, "creation_date": 1486541902, "answer_id": 42107917, "question_id": 42107599, "link": "https://stackoverflow.com/questions/42107599/vba-formulaarray-unable-to-set-the-formulaarray-property-of-the-range-class/42107917#42107917", "title": "VBA FormulaArray - Unable to set the FormulaArray property of the Range class", "body": "<p>You should apply to the whole range directly, not in each cell :</p>\n\n<pre><code>Sub Option1()\n    Sheet1.Range(Sheet1.Cells(5,5),Sheet1.Cells(5, 8)).Clear\n    Sheet1.Range(Sheet1.Cells(5,5),Sheet1.Cells(5, 8)).FormulaArray = _\n       \"=INDEX(MOD(INT((ROW(R2C2:INDEX(C2,2^ROWS(R2C2:R9C2)))-1)/2^(TRANSPOSE(MATCH(ROW(R2C2:R9C2),ROW(R2C2:R9C2)))-1)),2)*TRANSPOSE(R2C2:R9C2),MATCH(MIN(ABS(MMULT(MOD(INT((ROW(R2C2:INDEX(C2,2^ROWS(R2C2:R9C2)))-1)/2^(TRANSPOSE(MATCH(ROW(R2C2:R9C2),ROW(R2C2:R9C2)))-1)),2),R2C2:R9C2)-R1C5)),ABS(MMULT(MOD(INT((ROW(R2C2:INDEX(C2,2^ROWS(R2C2:R9C2)))-1)/2^(TRANSPOSE(MATCH(ROW(R2C2:R9C2),ROW(R2C2:R9C2)))-1)),2),R2C2:R9C2)-R1C5),0),0)\"\n\nEnd Sub\n</code></pre>\n\n<p>Or </p>\n\n<pre><code>Sub Option2()\n    Sheet1.Range(\"E5:I5\").Clear\n    Sheet1.Range(\"E5:I5\").FormulaArray = _\n       \"=INDEX(MOD(INT((ROW(R2C2:INDEX(R2C3,2^ROWS(R2C2:R9C2)))-1)/2^(TRANSPOSE(MATCH(ROW(R2C2:R9C2),ROW(R2C2:R9C2)))-1)),2)*TRANSPOSE(R2C2:R9C2),MATCH(MIN(ABS(MMULT(MOD(INT((ROW(R2C2:INDEX(R2C3,2^ROWS(R2C2:R9C2)))-1)/2^(TRANSPOSE(MATCH(ROW(R2C2:R9C2),ROW(R2C2:R9C2)))-1)),2),R2C2:R9C2)-R1C5)),ABS(MMULT(MOD(INT((ROW(R2C2:INDEX(R2C3,2^ROWS(R2C2:R9C2)))-1)/2^(TRANSPOSE(MATCH(ROW(R2C2:R9C2),ROW(R2C2:R9C2)))-1)),2),R2C2:R9C2)-R1C5),0),0)\"\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 103, "user_id": 5549668, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/a256b6e2ae9d2428e376ecb1ad53bb87?s=128&d=identicon&r=PG&f=1", "display_name": "Empty", "link": "https://stackoverflow.com/users/5549668/empty"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 681, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1547846522, "creation_date": 1486540709, "last_edit_date": 1486541929, "question_id": 42107599, "link": "https://stackoverflow.com/questions/42107599/vba-formulaarray-unable-to-set-the-formulaarray-property-of-the-range-class", "title": "VBA FormulaArray - Unable to set the FormulaArray property of the Range class", "body": "<p>At first, I am trying to write a macro program which can let user use to find numbers that closest to a total target that input from user.</p>\n\n<ul>\n<li>in the first figure, the quantity column is presenting amounts for their own title respectively. Target is an input from user. the horizontal A,B,C,D is use to show user which Title used.</li>\n</ul>\n\n<p><a href=\"https://i.stack.imgur.com/GrXvM.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/GrXvM.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>I get this error message after the file execution.</p>\n\n<p><a href=\"https://i.stack.imgur.com/NvzDW.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/NvzDW.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>Any advice? Thanks...</p>\n\n<pre><code>Sub Option1()\n    Dim c As Long\n    For c = 5 To 8\n        Sheet1.Cells(5, c).FormulaArray = _\n          \"=INDEX(MOD(INT((ROW(R2C2:INDEX(C2,2^ROWS(R2C2:R9C2)))-1)/2^(TRANSPOSE(MATCH(ROW(R2C2:R9C2),ROW(R2C2:R9C2)))-1)),2)*TRANSPOSE(R2C2:R9C2),MATCH(MIN(ABS(MMULT(MOD(INT((ROW(R2C2:INDEX(C2,2^ROWS(R2C2:R9C2)))-1)/2^(TRANSPOSE(MATCH(ROW(R2C2:R9C2),ROW(R2C2:R9C2)))-1)),2),R2C2:R9C2)-R1C5)),ABS(MMULT(MOD(INT((ROW(R2C2:INDEX(C2,2^ROWS(R2C2:R9C2)))-1)/2^(TRANSPOSE(MATCH(ROW(R2C2:R9C2),ROW(R2C2:R9C2)))-1)),2),R2C2:R9C2)-R1C5),0),0)\"\n    Next c\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 186, "user_id": 6552642, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/llIOQ.png?s=128&g=1", "display_name": "Chrygore", "link": "https://stackoverflow.com/users/6552642/chrygore"}, "is_accepted": false, "score": 0, "last_activity_date": 1486591087, "last_edit_date": 1486591087, "creation_date": 1486589891, "answer_id": 42124111, "question_id": 42107582, "link": "https://stackoverflow.com/questions/42107582/excel-vba-macro-to-copy-worksheet-and-count-1/42124111#42124111", "title": "Excel VBA Macro to copy worksheet and count + 1", "body": "<p>I'm not sure if this is what you're looking for, but I had a similar issue in the past, and I used the following methodology to solve it.</p>\n\n<pre><code>    Dim worksheetName As String\n    worksheetName = \"Test 1\"\n    worksheetNumber = 2\n    CheckName:\n        For Each ws in Sheets\n            ' If the desired worksheet name exists\n            If ws.name = worksheetName Then\n                ' Change the worksheetName to be Test x+1 and increment worksheetNumber\n                worksheetName = \"Test \" &amp; worksheetNumber\n                worksheetNumber = worksheetNumber + 1\n                GoTo CheckName ' return to the CheckName label and start again\n            End If\n        Next ws\n</code></pre>\n\n<p>Essentially, what we are doing is looping through every worksheet in the current workbook, and checking if any of them have the same name as the one we want to insert. If they do, we change the name to a new one and check again; if not, we have our new name.</p>\n\n<p>EDIT: Also, I would suggest putting the above code inside a Function that takes the sheet name as an argument, so you can change the desired name easily, like so:</p>\n\n<pre><code>    Function worksheetName(desiredName As String) As String\n        Dim worksheetName As String\n        worksheetName = desiredName\n        ' rest of code follows ...\n    End Function\n</code></pre>\n\n<p>And then it can be called like so:</p>\n\n<pre><code>    NewName = worksheetName(\"Test\")\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 7533087, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/53470c5c859d7689a97f3898b368b1af?s=128&d=identicon&r=PG&f=1", "display_name": "Dan", "link": "https://stackoverflow.com/users/7533087/dan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 102, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1486591087, "creation_date": 1486540654, "last_edit_date": 1531164843, "question_id": 42107582, "link": "https://stackoverflow.com/questions/42107582/excel-vba-macro-to-copy-worksheet-and-count-1", "title": "Excel VBA Macro to copy worksheet and count + 1", "body": "<p>I tried to create a macro that is on worksheet <code>overview</code>. This worksheet should be copied and renamed into <code>Test 1</code>. If I go back to the overview worksheet and start the macro again the newname of the <code>ws</code> should be <code>Test 2</code> and so on. </p>\n\n<p>I already tried Solutions with <code>Count</code> and if then but it is not working. Currently it runs once and then it says the <code>ws</code> already exists:</p>\n\n<pre><code>Sub CopyWs()\n\nDim NewName As String\n\nActiveSheet.Copy Before:=ActiveSheet\n\nNewName = \"Test  \" &amp; WsNo + 1\n\nWsNo = WsNo + 1\n\nActiveSheet.Name = NewName\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vb.net", "vba"], "answers": [{"comments": [{"owner": {"reputation": 165, "user_id": 7533100, "user_type": "registered", "accept_rate": 91, "profile_image": "https://graph.facebook.com/10154808286796047/picture?type=large", "display_name": "LarsS", "link": "https://stackoverflow.com/users/7533100/larss"}, "edited": false, "score": 0, "creation_date": 1486640367, "post_id": 42109223, "comment_id": 71437591, "body": "Thanks a lot for your help :) Together with the answer above, I got all I needed."}], "tags": [], "owner": {"reputation": 2163, "user_id": 1818637, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/c4207dd6a6c79e2bb6e6de75f5679fe4?s=128&d=identicon&r=PG", "display_name": "Malcor", "link": "https://stackoverflow.com/users/1818637/malcor"}, "is_accepted": false, "score": 0, "last_activity_date": 1486546028, "creation_date": 1486546028, "answer_id": 42109223, "question_id": 42107553, "link": "https://stackoverflow.com/questions/42107553/format-textbox-output-in-scientific-notation-if-number-of-digits-exceed-5/42109223#42109223", "title": "Format textbox output in scientific notation if number of digits exceed 5", "body": "<p>You can output the scientific notion with the <code>.ToString()</code> method. For example</p>\n\n<pre><code>    TextBox1.Text = (0.000000474600000000001).ToString(\"0.00E+00\")\n    ' OR\n    TextBox1.Text = value.ToString(\"0.00E+00\")\n</code></pre>\n\n<p>You can read more about custom numeric formats <a href=\"https://msdn.microsoft.com/en-us/library/0c899ak8(v=vs.110).aspx\" rel=\"nofollow noreferrer\">here</a></p>\n\n<p>As for the events, you can check out <a href=\"https://msdn.microsoft.com/en-us/library/aa984320(v=vs.71).aspx\" rel=\"nofollow noreferrer\">this</a> (not VB) but will point you in the right direction for using the 'lightning bolt' icon to select the events you want to hook up. Or you can create a sub which <code>handles</code> an event like so</p>\n\n<pre><code>Private sub Textbox_changed() Handles TextBox1.TextChanged\n 'Textbox change event\nEnd sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 165, "user_id": 7533100, "user_type": "registered", "accept_rate": 91, "profile_image": "https://graph.facebook.com/10154808286796047/picture?type=large", "display_name": "LarsS", "link": "https://stackoverflow.com/users/7533100/larss"}, "edited": false, "score": 0, "creation_date": 1486640306, "post_id": 42115603, "comment_id": 71437549, "body": "Thanks for answering all of my questions :)  I managed to get the output in scientific notation as you described. The code failed when I tried to use your suggestion for the Button1_Click sub, but that may well be due to me overlooking some dependent code.  I also managed to get the events working, thanks to you and @Malcor here."}], "tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": true, "score": 0, "last_activity_date": 1486563573, "creation_date": 1486563573, "answer_id": 42115603, "question_id": 42107553, "link": "https://stackoverflow.com/questions/42107553/format-textbox-output-in-scientific-notation-if-number-of-digits-exceed-5/42115603#42115603", "title": "Format textbox output in scientific notation if number of digits exceed 5", "body": "<p>here's some suggestions:</p>\n\n<ul>\n<li><p>in <code>Button1_Click()</code> you don't need any loop and just go:</p>\n\n<pre><code>TextBox2.Text = TextBox1.Text * rates(FraEnhet.SelectedIndex, TilEnhet.SelectedIndex)\n</code></pre></li>\n<li><p>as for TextBox2 formatting issue I'd go with:</p>\n\n<pre><code>TextBox2.Text = Convert.ToDouble(TextBox2.Text).ToString(\"0.00E+00\")\n</code></pre></li>\n<li><p>but I'd rather keep it in <code>Button1_Click()</code> instead of in a different event handler (<code>TextBox2_TextChanged()</code>) :</p>\n\n<pre><code>TextBox2.Text = TextBox1.Text * rates(FraEnhet.SelectedIndex, TilEnhet.SelectedIndex)\nIf Len(TextBox2.Text) &gt; 5 Then TextBox2.Text = Convert.ToDouble(TextBox2.Text).ToString(\"0.00E+00\")\n</code></pre></li>\n<li><p>finally, VBA <code>UserForm_Initialize()</code> translates into VB.NET <code>Form1_Load()</code></p></li>\n</ul>\n\n<p>all what above gives the following <code>Form1.vb</code> code:</p>\n\n<pre><code>Public Class Form1\n    Private Sub Button1_Click(sender As Object, e As EventArgs) Handles Button1.Click\n        Dim rates(0 To 5, 0 To 5) As Double, i As Integer, j As Integer\n\n        rates(0, 0) = 1\n        rates(0, 1) = 86400\n        rates(0, 2) = 100\n        rates(0, 3) = 8640000\n        rates(0, 4) = 283460\n        rates(0, 5) = 2120428.8\n\n        rates(1, 0) = 0.000011574\n        rates(1, 1) = 1\n        rates(1, 2) = 0.0011574\n        rates(1, 3) = 100\n        rates(1, 4) = 3.2808\n        rates(1, 5) = 24.542\n\n        rates(2, 0) = 0.01\n        rates(2, 1) = 864\n        rates(2, 2) = 1\n        rates(2, 3) = 86400\n        rates(2, 4) = 2834.6\n        rates(2, 5) = 21204.288\n\n        rates(3, 0) = 0.00000011574\n        rates(3, 1) = 0.01\n        rates(3, 2) = 0.000011574\n        rates(3, 3) = 1\n        rates(3, 4) = 0.032808\n        rates(3, 5) = 0.24542\n\n        rates(4, 0) = 0.0000035278\n        rates(4, 1) = 0.3048\n        rates(4, 2) = 0.00035278\n        rates(4, 3) = 30.4805\n        rates(4, 4) = 1\n        rates(4, 5) = 7.4333\n\n        rates(5, 0) = 0.000000474600000000001\n        rates(5, 1) = 0.0410054400000001\n        rates(5, 2) = 0.0000474600000000001\n        rates(5, 3) = 4.10054400000001\n        rates(5, 4) = 0.134530116\n        rates(5, 5) = 1\n\n        TextBox2.Text = TextBox1.Text * rates(FraEnhet.SelectedIndex, TilEnhet.SelectedIndex)\n        If Len(TextBox2.Text) &gt; 5 Then TextBox2.Text = Convert.ToDouble(TextBox2.Text).ToString(\"0.00E+00\")\n\n    End Sub\n\n    'Private Sub TextBox2_TextChanged(sender As Object, e As EventArgs) Handles TextBox2.TextChanged\n    '    If Len(TextBox2.Text) &gt; 5 Then\n    '        TextBox2.Text = Convert.ToDouble(TextBox2.Text).ToString(\"0.00E+00\")\n    '    End If\n    'End Sub\n\n    Private Sub Form1_Load(sender As Object, e As EventArgs) Handles MyBase.Load\n        With FraEnhet.Items\n            .Add(\"m/s\")\n            .Add(\"m/dag\")\n            .Add(\"cm/s\")\n            .Add(\"cm/dag\")\n            .Add(\"ft/day\")\n            .Add(\"gpd/ft2\")\n        End With\n\n        With TilEnhet.Items\n            .Add(\"m/s\")\n            .Add(\"m/dag\")\n            .Add(\"cm/s\")\n            .Add(\"cm/dag\")\n            .Add(\"ft/day\")\n            .Add(\"gpd/ft2\")\n        End With\n\n        FraEnhet.SelectedIndex = 0\n        TilEnhet.SelectedIndex = 2\n        TextBox1.Text = 1\n        TextBox2.Text = 100\n    End Sub\nEnd Class\n</code></pre>\n"}], "owner": {"reputation": 165, "user_id": 7533100, "user_type": "registered", "accept_rate": 91, "profile_image": "https://graph.facebook.com/10154808286796047/picture?type=large", "display_name": "LarsS", "link": "https://stackoverflow.com/users/7533100/larss"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 911, "favorite_count": 0, "accepted_answer_id": 42115603, "answer_count": 2, "score": 0, "last_activity_date": 1486563573, "creation_date": 1486540553, "question_id": 42107553, "link": "https://stackoverflow.com/questions/42107553/format-textbox-output-in-scientific-notation-if-number-of-digits-exceed-5", "title": "Format textbox output in scientific notation if number of digits exceed 5", "body": "<p>I'm totally new to programming, but yesterday I managed to program a simple conversion calculator in VBA for Excel. Since the code doesn't really need Excel, I found I wanted to make it a freestanding application and downloaded Visual Basic.</p>\n\n<p>After working one night to migrate the VBA for Excel code to Visual Basic, I finally managed to get the primary code function working.</p>\n\n<p>However, I would like to output the textbox1 result in Scientific notation if the number of digits exceed 5. I tried to use the VBA code directly, and while it didn't result in an error, it didn't change anything either.</p>\n\n<p>This is my VBA code:</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n\nDim rates(0 To 5, 0 To 5) As Double, i As Integer, j As Integer\n\nrates(0, 0) = 1\nrates(0, 1) = 86400\nrates(0, 2) = 100\nrates(0, 3) = 8640000\nrates(0, 4) = 283460\nrates(0, 5) = 2120428.8\n\nrates(1, 0) = 0.000011574\nrates(1, 1) = 1\nrates(1, 2) = 0.0011574\nrates(1, 3) = 100\nrates(1, 4) = 3.2808\nrates(1, 5) = 24.542\n\nrates(2, 0) = 0.01\nrates(2, 1) = 864\nrates(2, 2) = 1\nrates(2, 3) = 86400\nrates(2, 4) = 2834.6\nrates(2, 5) = 21204.288\n\nrates(3, 0) = 0.00000011574\nrates(3, 1) = 0.01\nrates(3, 2) = 0.000011574\nrates(3, 3) = 1\nrates(3, 4) = 0.032808\nrates(3, 5) = 0.24542\n\nrates(4, 0) = 0.0000035278\nrates(4, 1) = 0.3048\nrates(4, 2) = 0.00035278\nrates(4, 3) = 30.4805\nrates(4, 4) = 1\nrates(4, 5) = 7.4333\n\nrates(5, 0) = 4.74600000000001E-07\nrates(5, 1) = 4.10054400000001E-02\nrates(5, 2) = 4.74600000000001E-05\nrates(5, 3) = 4.10054400000001\nrates(5, 4) = 0.134530116\nrates(5, 5) = 1\n\nFor i = 0 To 5\n    For j = 0 To 5\n        If ListBox1.ListIndex = i And ListBox2.ListIndex = j Then TextBox2.Value = TextBox1.Value * rates(i, j)\n    Next j\nNext i\n\nEnd Sub\n\n\nPrivate Sub ListBox1_DblClick(ByVal Cancel As MSForms.ReturnBoolean)\n    CommandButton1_Click\nEnd Sub\n\nPrivate Sub ListBox1_KeyDown(ByVal KeyCode As MSForms.ReturnInteger, ByVal Shift As Integer)\n    If KeyCode = vbKeyReturn Then\n        CommandButton1_Click\n    End If\nEnd Sub\n\n\nPrivate Sub ListBox2_DblClick(ByVal Cancel As MSForms.ReturnBoolean)\n    CommandButton1_Click\nEnd Sub\n\nPrivate Sub ListBox2_KeyDown(ByVal KeyCode As MSForms.ReturnInteger, ByVal Shift As Integer)\n    If KeyCode = vbKeyReturn Then\n        CommandButton1_Click\n    End If\nEnd Sub\n\nPrivate Sub TextBox1_KeyDown(ByVal KeyCode As MSForms.ReturnInteger, ByVal Shift As Integer)\n    If KeyCode = vbKeyReturn Then\n        CommandButton1_Click\n    End If\nEnd Sub\n\nPrivate Sub TextBox2_Change()\n\n    If Len(TextBox2) &gt; 5 Then\n    TextBox2 = Format(TextBox2, \"0.00E+00\")\n    End If\n\nEnd Sub\nPrivate Sub UserForm_Initialize()\n\nWith ListBox1\n    .AddItem \"m/s\"\n    .AddItem \"m/dag\"\n    .AddItem \"cm/s\"\n    .AddItem \"cm/dag\"\n    .AddItem \"ft/day\"\n    .AddItem \"gpd/ft2\"\nEnd With\n\nWith ListBox2\n    .AddItem \"m/s\"\n    .AddItem \"m/dag\"\n    .AddItem \"cm/s\"\n    .AddItem \"cm/dag\"\n    .AddItem \"ft/day\"\n    .AddItem \"gpd/ft2\"\nEnd With\n\nListBox1.ListIndex = 0\nListBox2.ListIndex = 2\n\nTextBox1.Value = 1\nTextBox2.Value = 100\n\nEnd Sub\n</code></pre>\n\n<p>And here is my Visual Basic code:</p>\n\n<pre><code>Public Class Form1\nPrivate Sub Button1_Click(sender As Object, e As EventArgs) Handles Button1.Click\n    Dim rates(0 To 5, 0 To 5) As Double, i As Integer, j As Integer\n\n    rates(0, 0) = 1\n    rates(0, 1) = 86400\n    rates(0, 2) = 100\n    rates(0, 3) = 8640000\n    rates(0, 4) = 283460\n    rates(0, 5) = 2120428.8\n\n    rates(1, 0) = 0.000011574\n    rates(1, 1) = 1\n    rates(1, 2) = 0.0011574\n    rates(1, 3) = 100\n    rates(1, 4) = 3.2808\n    rates(1, 5) = 24.542\n\n    rates(2, 0) = 0.01\n    rates(2, 1) = 864\n    rates(2, 2) = 1\n    rates(2, 3) = 86400\n    rates(2, 4) = 2834.6\n    rates(2, 5) = 21204.288\n\n    rates(3, 0) = 0.00000011574\n    rates(3, 1) = 0.01\n    rates(3, 2) = 0.000011574\n    rates(3, 3) = 1\n    rates(3, 4) = 0.032808\n    rates(3, 5) = 0.24542\n\n    rates(4, 0) = 0.0000035278\n    rates(4, 1) = 0.3048\n    rates(4, 2) = 0.00035278\n    rates(4, 3) = 30.4805\n    rates(4, 4) = 1\n    rates(4, 5) = 7.4333\n\n    rates(5, 0) = 0.000000474600000000001\n    rates(5, 1) = 0.0410054400000001\n    rates(5, 2) = 0.0000474600000000001\n    rates(5, 3) = 4.10054400000001\n    rates(5, 4) = 0.134530116\n    rates(5, 5) = 1\n\n    For i = 0 To 5\n        For j = 0 To 5\n            If FraEnhet.SelectedIndex = i And TilEnhet.SelectedIndex = j Then\n                TextBox2.Text = TextBox1.Text * rates(i, j)\n            End If\n        Next j\n    Next i\nEnd Sub\nPrivate Sub TextBox2_Change()\n\n    If Len(TextBox2) &gt; 5 Then\n        TextBox2.Text = FormatNumber(\"0.00E+00\")\n    End If\nEnd Sub\nEnd Class\n</code></pre>\n\n<p>If anyone can also tip me on how to set the doubleclick and enter key events, it would be greatly appreciated.</p>\n\n<p>Thanks</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 459, "user_id": 6532310, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7548cf1a3d74a483383d895f07192ee6?s=128&d=identicon&r=PG&f=1", "display_name": "tretom", "link": "https://stackoverflow.com/users/6532310/tretom"}, "edited": false, "score": 0, "creation_date": 1486538911, "post_id": 42106899, "comment_id": 71383245, "body": "I&#39;d search the value of <code>F3</code> on the <code>YEAR Sheet</code> in row 19 into a variable eg. actMonth, then sum the values of the 30th row from column <code>E</code> to column <code>actMonth-1</code>, and there you are."}, {"owner": {"reputation": 37, "user_id": 5680202, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/d8945b84858cf1ca3d1efc23ca232974?s=128&d=identicon&r=PG&f=1", "display_name": "rabal", "link": "https://stackoverflow.com/users/5680202/rabal"}, "reply_to_user": {"reputation": 459, "user_id": 6532310, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7548cf1a3d74a483383d895f07192ee6?s=128&d=identicon&r=PG&f=1", "display_name": "tretom", "link": "https://stackoverflow.com/users/6532310/tretom"}, "edited": false, "score": 0, "creation_date": 1486541611, "post_id": 42106899, "comment_id": 71384555, "body": "Can we elaborate sir ?"}], "answers": [{"comments": [{"owner": {"reputation": 37, "user_id": 5680202, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/d8945b84858cf1ca3d1efc23ca232974?s=128&d=identicon&r=PG&f=1", "display_name": "rabal", "link": "https://stackoverflow.com/users/5680202/rabal"}, "edited": false, "score": 0, "creation_date": 1486541357, "post_id": 42107283, "comment_id": 71384429, "body": "This is the code from Mr. @harun24hr, to change the value of TARGET OF THE MONTH base on the month you selected, it came from my previous question &#39;Changing the value of the other Cell base on the month you entered&#39; and it work for me., =IFERROR(INDEX(&#39;YEAR Sheet&#39;!$E$21:$P$32,ROWS($E$21:$E21),MATCH(LEFT($F$3,3),&#39;YEAR Sheet&#39;!$E$19:$P$19,0)),&quot;-&quot;)"}, {"owner": {"reputation": 343, "user_id": 4898713, "user_type": "registered", "profile_image": "https://graph.facebook.com/1189342967759685/picture?type=large", "display_name": "Wujaszkun", "link": "https://stackoverflow.com/users/4898713/wujaszkun"}, "reply_to_user": {"reputation": 37, "user_id": 5680202, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/d8945b84858cf1ca3d1efc23ca232974?s=128&d=identicon&r=PG&f=1", "display_name": "rabal", "link": "https://stackoverflow.com/users/5680202/rabal"}, "edited": false, "score": 0, "creation_date": 1486542695, "post_id": 42107283, "comment_id": 71385168, "body": "Then try this (put it in the cell where the last month should be added):  <code>=IFERROR(INDEX(&#39;YEAR Sheet&#39;!$E$21:$P$32,ROWS($E$21:$E21),MATCH(LEFT($F$3,3),&#39;YEAR Sheet&#39;!$E$19:$P$19,0))+INDEX(&#39;YEAR Sheet&#39;!$E$21:$P$32,ROWS($E$30),MATCH(LEFT($F$3,3),&#39;YEAR Sheet&#39;!$E$19:$P$19,0)-1),&quot;-&quot;)</code>"}, {"owner": {"reputation": 343, "user_id": 4898713, "user_type": "registered", "profile_image": "https://graph.facebook.com/1189342967759685/picture?type=large", "display_name": "Wujaszkun", "link": "https://stackoverflow.com/users/4898713/wujaszkun"}, "reply_to_user": {"reputation": 37, "user_id": 5680202, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/d8945b84858cf1ca3d1efc23ca232974?s=128&d=identicon&r=PG&f=1", "display_name": "rabal", "link": "https://stackoverflow.com/users/5680202/rabal"}, "edited": false, "score": 0, "creation_date": 1486544900, "post_id": 42107283, "comment_id": 71386468, "body": "I have a question, the &quot;last month value&quot; is only the value from previous month (from the source table) or is it a year to date sum?"}], "tags": [], "owner": {"reputation": 343, "user_id": 4898713, "user_type": "registered", "profile_image": "https://graph.facebook.com/1189342967759685/picture?type=large", "display_name": "Wujaszkun", "link": "https://stackoverflow.com/users/4898713/wujaszkun"}, "is_accepted": false, "score": 0, "last_activity_date": 1486539476, "creation_date": 1486539476, "answer_id": 42107283, "question_id": 42106899, "link": "https://stackoverflow.com/questions/42106899/adding-the-total-of-the-previous-month-to-the-selected-month/42107283#42107283", "title": "Adding the total of the previous month to the selected month", "body": "<p>Option 1:\nHow did you get the data for the Target month to change? I'm asking because you could use the same formula (or VBA code) and just ad <code>Offset</code> function to it to get the correct Cell.  </p>\n\n<p>Option 2:\nYou could also use the <code>Match</code> function to get the correct column and build a formula using <code>Indirect</code>, like this: <code>=Indirect(Address(row_num,col_num))</code>:</p>\n\n<p>Lookup Cell -> B25</p>\n\n<p>Formula for current Month (C25) -> <code>=INDIRECT(ADDRESS(21,MATCH(B25,$A$7:$N$7,0)))</code></p>\n\n<p>Formula for previous Month (D25) -> <code>=INDIRECT(ADDRESS(21,MATCH(B25,$A$7:$N$7,0)-1))</code></p>\n\n<p>As you can see the only difference in these 2 formulas is the <code>-1</code> which changes the number of column .</p>\n\n<p>For the Cells C24 &amp; D24 i have used the same formula just with the row =7</p>\n\n<p><a href=\"https://i.stack.imgur.com/WqLid.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/WqLid.jpg\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 37, "user_id": 5680202, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/d8945b84858cf1ca3d1efc23ca232974?s=128&d=identicon&r=PG&f=1", "display_name": "rabal", "link": "https://stackoverflow.com/users/5680202/rabal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 274, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1570123340, "creation_date": 1486538121, "last_edit_date": 1570123340, "question_id": 42106899, "link": "https://stackoverflow.com/questions/42106899/adding-the-total-of-the-previous-month-to-the-selected-month", "title": "Adding the total of the previous month to the selected month", "body": "<p>So I have here a screen shot an excel file with 2 sheets, the first is the 'YEAR Sheet' and the 2nd is the 'Monthly Report Sheet', the value of the <strong>Target of the month</strong> will automatically change when I change the Month or the F3 cell on Monthly report sheet. Now my problem is how can I ADD the total of the previous month to the selected month automatically. Sample screen shots is this.</p>\n\n<p><a href=\"https://i.stack.imgur.com/IUKio.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/IUKio.jpg\" alt=\"enter image description here\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/EGmNz.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/EGmNz.jpg\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["vba", "excel", "excel-formula"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 7398690, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0ab275ccd4fecba1309c4f3f388a9165?s=128&d=identicon&r=PG&f=1", "display_name": "Pao", "link": "https://stackoverflow.com/users/7398690/pao"}, "edited": false, "score": 0, "creation_date": 1486543809, "post_id": 42108284, "comment_id": 71385793, "body": "But I have this userform <a href=\"http://imgh.us/userform_1.png\" rel=\"nofollow noreferrer\">imgh.us/userform_1.png</a> check it. When I insert image, i want it to be in a cell whether it is button, clickable text, object. What can you suggest?  This will be the format when I encode a product |Product Code| Product Name | Ref number| clickable image|  This will be in a table. That&#39;s my plan."}, {"owner": {"reputation": 28228, "user_id": 7132550, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/1063981417044495/picture?type=large", "display_name": "Micha\u0142 Turczyn", "link": "https://stackoverflow.com/users/7132550/micha%c5%82-turczyn"}, "reply_to_user": {"reputation": 1, "user_id": 7398690, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0ab275ccd4fecba1309c4f3f388a9165?s=128&d=identicon&r=PG&f=1", "display_name": "Pao", "link": "https://stackoverflow.com/users/7398690/pao"}, "edited": false, "score": 0, "creation_date": 1486545906, "post_id": 42108284, "comment_id": 71387149, "body": "So, add code to insert button click event that will ask for the directory of the picture, then add the button - you can write code, that will generate button using given directory and place it the cell you want it to be."}], "tags": [], "owner": {"reputation": 28228, "user_id": 7132550, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/1063981417044495/picture?type=large", "display_name": "Micha\u0142 Turczyn", "link": "https://stackoverflow.com/users/7132550/micha%c5%82-turczyn"}, "is_accepted": false, "score": 0, "last_activity_date": 1486543124, "creation_date": 1486543124, "answer_id": 42108284, "question_id": 42106142, "link": "https://stackoverflow.com/questions/42106142/vba-vba-excel-upload-picture-and-make-it-as-a-link-clickable-text/42108284#42108284", "title": "(VBA/VBA EXCEL) Upload picture and make it as a link/clickable text", "body": "<p>My idea is to do the following:</p>\n\n<ul>\n<li>prompt OpenFilename window - this way you can get the directory,</li>\n<li>next, create button within the cell, where you want to have your link (you will replace link with button),</li>\n<li>then add the code to the button click event, that will load and show the picture.</li>\n</ul>\n\n<p>Hope it helps. Best reagrds!</p>\n"}], "owner": {"reputation": 1, "user_id": 7398690, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0ab275ccd4fecba1309c4f3f388a9165?s=128&d=identicon&r=PG&f=1", "display_name": "Pao", "link": "https://stackoverflow.com/users/7398690/pao"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 488, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1565193634, "creation_date": 1486535263, "last_edit_date": 1565193634, "question_id": 42106142, "link": "https://stackoverflow.com/questions/42106142/vba-vba-excel-upload-picture-and-make-it-as-a-link-clickable-text", "title": "(VBA/VBA EXCEL) Upload picture and make it as a link/clickable text", "body": "<p>I have my code that can upload a picture. I want to make it as clickable link. See the attached picture. The country will be the link and when I click it. The picture uploaded will show. </p>\n\n<p>I have my userform for Product name, product code, ref. number , and upload img.\nwhen click add. That will be the output and there is a clickable txt/link to img.</p>\n\n<p><a href=\"http://imgh.us/CLICKABLE.png\" rel=\"nofollow noreferrer\">http://imgh.us/CLICKABLE.png</a></p>\n\n<pre><code>Private Sub cmdAttachment_Click() \n\nDim fname As String \n\n fname = Application.GetOpenFilename(filefilter:= _ \n\"JPG Files(*.jpg),*.jpg\", Title:=\"Select Image To Open\") \n\n 'If you did not click Cancel...\n If fname &lt;&gt; \"False\" Then \n    Dim pic \n\n    Set pic = ActiveSheet.Pictures.Insert(fname) \n\n    With pic \n        .Left = 0 \n        .Top = 0 \n    End With \nEnd If \n</code></pre>\n"}, {"tags": ["vba", "outlook"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 2, "creation_date": 1486535282, "post_id": 42105785, "comment_id": 71381435, "body": "<code>StripIllegalChar</code> is named that because certain characters <i>cannot</i> be used in a file name.  There&#39;s no getting away from that."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 7532634, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1b51ac7b361b6939410d0876a7b96fd?s=128&d=identicon&r=PG&f=1", "display_name": "cheno", "link": "https://stackoverflow.com/users/7532634/cheno"}, "edited": false, "score": 0, "creation_date": 1486551340, "post_id": 42107124, "comment_id": 71391070, "body": "Good point Tim, actually didn&#39;t think about that as windows doesn&#39;t accept those characters.  Thanks for the help guys"}], "tags": [], "owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "is_accepted": false, "score": 0, "last_activity_date": 1486538924, "creation_date": 1486538924, "answer_id": 42107124, "question_id": 42105785, "link": "https://stackoverflow.com/questions/42105785/saving-msg-to-local-folder-using-illegal-characters-in-file-name/42107124#42107124", "title": "Saving msg to local folder using illegal characters in file name", "body": "<p>Its bad idea like Tim said, but if that is what you want to do then modify your j loop to something like this...</p>\n\n<pre><code>    For j = 1 To SubFolder.Items.Count\n        Set mItem = SubFolder.Items(j)\n        StrSubject = mItem.Subject\n        StrSubject = StrSaveFolder &amp; StrSubject &amp; \".msg\"\n        mItem.SaveAs StrSubject, 3\n    Next j\n</code></pre>\n\n<p>Good Luck...</p>\n"}], "owner": {"reputation": 11, "user_id": 7532634, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1b51ac7b361b6939410d0876a7b96fd?s=128&d=identicon&r=PG&f=1", "display_name": "cheno", "link": "https://stackoverflow.com/users/7532634/cheno"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 457, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1593074747, "creation_date": 1486533681, "last_edit_date": 1593074747, "question_id": 42105785, "link": "https://stackoverflow.com/questions/42105785/saving-msg-to-local-folder-using-illegal-characters-in-file-name", "title": "Saving msg to local folder using illegal characters in file name", "body": "<p>I have the following code to save emails from Outlook to a folder on the desktop.</p>\n\n<p>I would like to name the files with the email subjects exactly the way they are in Outlook. I do not want to strip any characters. </p>\n\n<p>I have played around with the macro but I can't fix it. Also would like to remove the time stamp date etc.</p>\n\n<pre><code>Option Explicit\nDim StrSavePath     As String\n\nSub SaveAllEmails_ProcessAllSubFolders()\n\n    Dim i               As Long\n    Dim j               As Long\n    Dim n               As Long\n    Dim StrSubject      As String\n    Dim StrName         As String\n    Dim StrFile         As String\n    Dim StrReceived     As String\n    Dim StrFolder       As String\n    Dim StrSaveFolder   As String\n    Dim StrFolderPath   As String\n    Dim iNameSpace      As NameSpace\n    Dim myOlApp         As Outlook.Application\n    Dim SubFolder       As MAPIFolder\n    Dim mItem           As MailItem\n    Dim FSO             As Object\n    Dim ChosenFolder    As Object\n    Dim Folders         As New Collection\n    Dim EntryID         As New Collection\n    Dim StoreID         As New Collection\n\n    Set FSO = CreateObject(\"Scripting.FileSystemObject\")\n    Set myOlApp = Outlook.Application\n    Set iNameSpace = myOlApp.GetNamespace(\"MAPI\")\n    Set ChosenFolder = iNameSpace.PickFolder\n    If ChosenFolder Is Nothing Then\n'GoTo ExitSub:\n    End If\n\nBrowseForFolder StrSavePath\n\n    Call GetFolder(Folders, EntryID, StoreID, ChosenFolder)\n\n    For i = 1 To Folders.Count\n        StrFolder = StripIllegalChar(Folders(i))\n        n = InStr(3, StrFolder, \"\\\") + 1\n        StrFolder = Mid(StrFolder, n, 256)\n        StrFolderPath = StrSavePath &amp; \"\\\" &amp; StrFolder &amp; \"\\\"\n        StrSaveFolder = Left(StrFolderPath, Len(StrFolderPath) - 1) &amp; \"\\\"\n        If Not FSO.FolderExists(StrFolderPath) Then\n            FSO.CreateFolder (StrFolderPath)\n        End If\n\n        Set SubFolder = myOlApp.Session.GetFolderFromID(EntryID(i), StoreID(i))\n        On Error Resume Next\n        For j = 1 To SubFolder.Items.Count\n            Set mItem = SubFolder.Items(j)\n            StrReceived = Format(mItem.ReceivedTime, \"YYYYMMDD-hhmm\")\n            StrSubject = mItem.Subject\n            StrName = StripIllegalChar(StrSubject)\n            StrFile = StrSaveFolder &amp; StrReceived &amp; \"_\" &amp; StrName &amp; \".msg\"\n            StrFile = Left(StrFile, 256)\n            mItem.SaveAs StrFile, 3\n        Next j\n        On Error GoTo 0\n    Next i\n\nExitSub:\n\nEnd Sub\n\nFunction StripIllegalChar(StrInput)\n    Dim RegX            As Object\n\n    Set RegX = CreateObject(\"vbscript.regexp\")\n\n    RegX.Pattern = \"[\\\" &amp; Chr(34) &amp; \"\\!\\@\\#\\$\\%\\^\\&amp;\\*\\(\\)\\=\\+\\|\\[\\]\\{\\}\\`\\'\\;\\:\\&lt;\\&gt;\\?\\/\\,]\"\n    RegX.IgnoreCase = True\n    RegX.Global = True\n\n    StripIllegalChar = RegX.Replace(StrInput, \"\")\n\nExitFunction:\n    Set RegX = Nothing\n\nEnd Function\n\n\nSub GetFolder(Folders As Collection, EntryID As Collection, _\n                        StoreID As Collection, Fld As MAPIFolder)\n    Dim SubFolder       As MAPIFolder\n\n    Folders.Add Fld.FolderPath\n    EntryID.Add Fld.EntryID\n    StoreID.Add Fld.StoreID\n    For Each SubFolder In Fld.Folders\n        GetFolder Folders, EntryID, StoreID, SubFolder\n    Next SubFolder\n\nExitSub:\n    Set SubFolder = Nothing\n\nEnd Sub\n\n\nFunction BrowseForFolder(StrSavePath As String, _\n                        Optional OpenAt As String) As String\nDim objShell As Object\nDim objFolder '  As Folder\n\nDim enviro\nenviro = CStr(Environ(\"USERPROFILE\"))\nSet objShell = CreateObject(\"Shell.Application\")\nSet objFolder = objShell.BrowseForFolder(0, \"Please choose a folder\", _\n                                           0, enviro &amp; \"C:\\Temp\\Folders\")\nStrSavePath = objFolder.self.Path\n\n    On Error Resume Next\n    On Error GoTo 0\n\nExitFunction:\n    Set objShell = Nothing\n\nEnd Function\n</code></pre>\n"}, {"tags": ["excel", "vba", "string-function"], "comments": [{"owner": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "edited": false, "score": 1, "creation_date": 1486532856, "post_id": 42104873, "comment_id": 71380485, "body": "I think this is better of full VBA instead of using Formulas."}, {"owner": {"reputation": 4114, "user_id": 5751805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da1c3545802a510a9b283f706d74283a?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan", "link": "https://stackoverflow.com/users/5751805/jordan"}, "reply_to_user": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "edited": false, "score": 0, "creation_date": 1486555144, "post_id": 42104873, "comment_id": 71393641, "body": "I agree with @PatricK that you&#39;d be better off just re-writing the formula as a macro perhaps using <code>InStr</code>, <code>If</code> and <code>Select Case</code> functions."}, {"owner": {"reputation": 1148, "user_id": 7231593, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kvB-QD-A2Xs/AAAAAAAAAAI/AAAAAAAAAE4/LRTmHQQqx44/photo.jpg?sz=128", "display_name": "John Muggins", "link": "https://stackoverflow.com/users/7231593/john-muggins"}, "edited": false, "score": 0, "creation_date": 1486562619, "post_id": 42104873, "comment_id": 71398991, "body": "if you expect there to be only 1 equal sign in &quot;A6&quot; then using the instr function would definitely be easier.  ie if inst(1,range(&quot;a6&quot;).value, &quot;=&quot;) = 60 then......"}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 7532398, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-HaI09d62aBA/AAAAAAAAAAI/AAAAAAAACBg/eM10yIl6N_E/photo.jpg?sz=128", "display_name": "Mike W", "link": "https://stackoverflow.com/users/7532398/mike-w"}, "edited": false, "score": 0, "creation_date": 1487701537, "post_id": 42115598, "comment_id": 71899408, "body": "This worked great, thanks again everyone for he quick feed back!"}, {"owner": {"reputation": 1148, "user_id": 7231593, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kvB-QD-A2Xs/AAAAAAAAAAI/AAAAAAAAAE4/LRTmHQQqx44/photo.jpg?sz=128", "display_name": "John Muggins", "link": "https://stackoverflow.com/users/7231593/john-muggins"}, "reply_to_user": {"reputation": 13, "user_id": 7532398, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-HaI09d62aBA/AAAAAAAAAAI/AAAAAAAACBg/eM10yIl6N_E/photo.jpg?sz=128", "display_name": "Mike W", "link": "https://stackoverflow.com/users/7532398/mike-w"}, "edited": false, "score": 0, "creation_date": 1487703668, "post_id": 42115598, "comment_id": 71900642, "body": "Is that the answer?  If so please don&#39;t forget to +1 it."}], "tags": [], "owner": {"reputation": 1148, "user_id": 7231593, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kvB-QD-A2Xs/AAAAAAAAAAI/AAAAAAAAAE4/LRTmHQQqx44/photo.jpg?sz=128", "display_name": "John Muggins", "link": "https://stackoverflow.com/users/7231593/john-muggins"}, "is_accepted": true, "score": 0, "last_activity_date": 1486563565, "creation_date": 1486563565, "answer_id": 42115598, "question_id": 42104873, "link": "https://stackoverflow.com/questions/42104873/convert-formula-with-string-function-into-a-vba-equivalent/42115598#42115598", "title": "Convert formula with string function into a VBA equivalent", "body": "<pre><code>Sub convert()\nDim ws As Worksheet, thisRng As Range\nSet ws = Sheet1\nSet thisRng = Sheet1.Range(\"B1\")' Select the cell to place data into\n\n'   Break up the formula logically first and it becomes easier to convert\n'   =IF (MID(A6,60,1)=\"=\",     MID(A6,52,15),    else if IF(MID(A6,57,1)=\"=\",     MID(A6,53,8),        else    C1))\nIf Mid(ws.Range(\"A6\").Value, 60, 1) = \"=\" Then\n    thisRng = Mid(ws.Range(\"A6\").Value, 52, 15)\n    Else\n        If (Mid(ws.Range(\"A6\").Value, 57, 1)) = \"=\" Then\n            thisRng = Mid(ws.Range(\"A6\").Value, 53, 8)\n        Else\n            thisRng.Value = ws.Range(\"C1\").Value\n        End If\nEnd If\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 7532398, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-HaI09d62aBA/AAAAAAAAAAI/AAAAAAAACBg/eM10yIl6N_E/photo.jpg?sz=128", "display_name": "Mike W", "link": "https://stackoverflow.com/users/7532398/mike-w"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 773, "favorite_count": 0, "accepted_answer_id": 42115598, "answer_count": 1, "score": 0, "last_activity_date": 1560597348, "creation_date": 1486528955, "last_edit_date": 1560597348, "question_id": 42104873, "link": "https://stackoverflow.com/questions/42104873/convert-formula-with-string-function-into-a-vba-equivalent", "title": "Convert formula with string function into a VBA equivalent", "body": "<p>I would like to turn Excel formulas with string functions into VBA equivalents. </p>\n\n<p>There are several lines of formulas. I'm going to give two examples.</p>\n\n<p>There is a copy a txt report in column A. Columns B thru O sort through the rows of A, picking out pieces using some of the following formulas:</p>\n\n<pre><code>=IF(MID(A6,60,1)=\"=\",MID(A6,52,15),IF(MID(A6,57,1)=\"=\",MID(A6,53,8),C1))\n</code></pre>\n\n<p>and </p>\n\n<pre><code>=IF(A2=\"\",\"-\",IF(LEFT(A2,1)=\"1\",\"pg\",\"-\"))\n</code></pre>\n\n<p>Here's a snapshot of a test report. </p>\n\n<p><img src=\"https://i.stack.imgur.com/kCOgn.png\" alt=\"Mock Report\"></p>\n\n<p>I'd like to loop through the formulas and send to Sheet2 starting with A2 (due to headers) not go through the steps of copying then pasting to A1, copying columns B thru O, and then sorting out the \"-\".</p>\n\n<p>I tried recording a macro and imputing the formulas, but I couldn't make it happen.</p>\n"}, {"tags": ["c#", "excel", "vba", "epplus"], "comments": [{"owner": {"reputation": 8784, "user_id": 604196, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2bb860fa39a843f9d6931a7756e5444e?s=128&d=identicon&r=PG", "display_name": "kuujinbo", "link": "https://stackoverflow.com/users/604196/kuujinbo"}, "edited": false, "score": 0, "creation_date": 1486527294, "post_id": 42104198, "comment_id": 71378701, "body": "What data type are the cells showing in Excel with your code as is? E.g. <i>General</i>, <i>Custom</i>, etc."}, {"owner": {"reputation": 275, "user_id": 6683886, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/689c1c43e7ed59432f6574527106a607?s=128&d=identicon&r=PG&f=1", "display_name": "Chris K.", "link": "https://stackoverflow.com/users/6683886/chris-k"}, "reply_to_user": {"reputation": 8784, "user_id": 604196, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2bb860fa39a843f9d6931a7756e5444e?s=128&d=identicon&r=PG", "display_name": "kuujinbo", "link": "https://stackoverflow.com/users/604196/kuujinbo"}, "edited": false, "score": 0, "creation_date": 1486533926, "post_id": 42104198, "comment_id": 71380888, "body": "@kuujinbo The data type for the column is showing as General but the format of the cell is correctly showing as the &quot;Date&quot; format."}, {"owner": {"reputation": 8784, "user_id": 604196, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2bb860fa39a843f9d6931a7756e5444e?s=128&d=identicon&r=PG", "display_name": "kuujinbo", "link": "https://stackoverflow.com/users/604196/kuujinbo"}, "edited": false, "score": 1, "creation_date": 1486577788, "post_id": 42104198, "comment_id": 71409484, "body": "Verify the cell <code>Value</code> is<code>DateTime</code>. And if you&#39;re working with different cultures, I&#39;ve seen that setting <code>Style.Numberformat.Format</code> to <code>System.Globalization.DateTimeFormatInfo.CurrentInfo.ShortDat&zwnj;&#8203;ePattern</code> will type the cells correctly."}], "answers": [{"tags": [], "owner": {"reputation": 459, "user_id": 6532310, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7548cf1a3d74a483383d895f07192ee6?s=128&d=identicon&r=PG&f=1", "display_name": "tretom", "link": "https://stackoverflow.com/users/6532310/tretom"}, "is_accepted": true, "score": 3, "last_activity_date": 1486538289, "creation_date": 1486538289, "answer_id": 42106934, "question_id": 42104198, "link": "https://stackoverflow.com/questions/42104198/set-column-data-format-using-epplus-in-c/42106934#42106934", "title": "Set Column Data Format using EPPLUS in C#", "body": "<p>I tried it and I found that, if I enter the date format exactly as it's set in my system, then Excel takes it as date value type, otherwise takes it as user defined. My system date format is \"dd.MM.yyyy\" and as a result of this code in the Excel file cell \"A3\" has date format, cell \"A2\" had user defined.\nYou might check this out.</p>\n\n<p>My testcase was:</p>\n\n<pre><code>using (ExcelPackage testFile = new ExcelPackage(new System.IO.FileInfo(@\"c:\\Data\\test.xlsx\")))\n            {\n                ExcelWorksheet testSht = testFile.Workbook.Worksheets[1];\n\n                testSht.Cells[1, 1].Value = new DateTime(2017, 1, 1);\n                testSht.Cells[2, 1].Style.Numberformat.Format = \"dd-mm-yyyy\";\n                testSht.Cells[2, 1].Formula = \"=Date(\" + DateTime.Now.Year + \",\" + DateTime.Now.Month + \",\" + DateTime.Now.Day + \")\";\n                testSht.Cells[3, 1].Value = new DateTime(2017, 1, 1);\n                testSht.Cells[3, 1].Style.Numberformat.Format = \"dd.MM.yyyy\";\n                testFile.Save();\n            }\n</code></pre>\n"}], "owner": {"reputation": 275, "user_id": 6683886, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/689c1c43e7ed59432f6574527106a607?s=128&d=identicon&r=PG&f=1", "display_name": "Chris K.", "link": "https://stackoverflow.com/users/6683886/chris-k"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7884, "favorite_count": 0, "accepted_answer_id": 42106934, "answer_count": 1, "score": 2, "last_activity_date": 1486538289, "creation_date": 1486524787, "last_edit_date": 1486532882, "question_id": 42104198, "link": "https://stackoverflow.com/questions/42104198/set-column-data-format-using-epplus-in-c", "title": "Set Column Data Format using EPPLUS in C#", "body": "<h1>Problem</h1>\n\n<p>When I export a <code>Microsoft Excel spreadsheet</code> using the <code>EPPLUS</code> library I need to set both the column's data format as well as the cell format such that the resultant dates in the Microsoft Excel spreadsheet can be recognized by <code>Microsoft Excel's formulas</code> that deal with date and time.</p>\n\n<h1>What was tried</h1>\n\n<p>I can set the cell's format easily using:</p>\n\n<pre><code>currentWorkSheet.Cells[\"L\" + currentRowNumber.ToString()].Style.Numberformat.Format = \"m/d/yyyy\";\ncurrentWorkSheet.Cells[\"L\" + currentRowNumber.ToString()].Style.HorizontalAlignment = OfficeOpenXml.Style.ExcelHorizontalAlignment.Right;\n</code></pre>\n\n<p>The problem is that even with this number formatting and styling the date in the cell is still not recognized as a date, it is only <strong>formatted</strong> as a date.</p>\n\n<p>Upon research I found that I need to set the column to have a \"Date\" data as shown in this image: <a href=\"https://i.stack.imgur.com/c0EDO.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/c0EDO.png\" alt=\"Image\"></a></p>\n\n<p>I tried setting the column's data type as shown but this doesn't work:</p>\n\n<pre><code>currentWorkSheet.Column(10).Style.Numberformat.Format = \"Date\";\n</code></pre>\n\n<p>What can I do to get the column's data type to be a date?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "edited": false, "score": 0, "creation_date": 1486523402, "post_id": 42103888, "comment_id": 71377765, "body": "does any of the <code>B1:B5</code> cells contain non-date value like text, blank, etc. ?"}, {"owner": {"reputation": 3, "user_id": 7532133, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d346e185ccb6e1dd533797dfee1f96da?s=128&d=identicon&r=PG&f=1", "display_name": "warfarin", "link": "https://stackoverflow.com/users/7532133/warfarin"}, "reply_to_user": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "edited": false, "score": 0, "creation_date": 1486523514, "post_id": 42103888, "comment_id": 71377789, "body": "They&#39;re all dates. In fact I don&#39;t get an error if I write any specific number into the row index place holder instead of the variable &#39;counter&#39;."}, {"owner": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "edited": false, "score": 0, "creation_date": 1486523836, "post_id": 42103888, "comment_id": 71377883, "body": "hmm strange .. you can try different variable name just in case, or <code>Date - Range(&quot;B&quot; &amp; counter)</code>"}, {"owner": {"reputation": 3, "user_id": 7532133, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d346e185ccb6e1dd533797dfee1f96da?s=128&d=identicon&r=PG&f=1", "display_name": "warfarin", "link": "https://stackoverflow.com/users/7532133/warfarin"}, "reply_to_user": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "edited": false, "score": 0, "creation_date": 1486523956, "post_id": 42103888, "comment_id": 71377915, "body": "I&#39;ve tried different variable names. In case it was the variable being named itself I tried it more simply with a: for each c in range (&quot;B1:B3&quot;), then referring to the value as c.value and it still has a mismatch error when subtracting from &#39;Date&#39;."}, {"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 1, "creation_date": 1486529156, "post_id": 42103888, "comment_id": 71379266, "body": "You will get this error if the values in column B are strings that only <i>look</i> like dates.  Ideally, fix your data so it&#39;s real dates.  Or use <code>If Date - DateValue(Cells(counter, 2)) &gt; ...</code>"}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "reply_to_user": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 0, "creation_date": 1486530514, "post_id": 42103888, "comment_id": 71379742, "body": "I agree with @chrisneilsen.  it is likely that one of your entries in column B is a &quot;date in text clothing&quot;  In some column, enter <code>=ISTEXT(B1)</code> and see if <code>TRUE</code> is returned for any of the entries."}, {"owner": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "edited": false, "score": 0, "creation_date": 1486532103, "post_id": 42103888, "comment_id": 71380227, "body": "This can be done with Formula instead of VBA."}, {"owner": {"reputation": 3, "user_id": 7532133, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d346e185ccb6e1dd533797dfee1f96da?s=128&d=identicon&r=PG&f=1", "display_name": "warfarin", "link": "https://stackoverflow.com/users/7532133/warfarin"}, "edited": false, "score": 0, "creation_date": 1486652062, "post_id": 42103888, "comment_id": 71445845, "body": "I understand what you&#39;re saying and don&#39;t think this is the problem. IsText returns False for all data in the range. If I change formatting to general all dates are displayed in serial format...as I understand they should if they&#39;re recognized as dates. Additionally, if I step through the loop one number at a time substituting the number instead of the variable &#39;counter&#39; for the &#39;row index&#39; value within the Cell reference...it works. This would not work if the problem were the data not being in the correct format."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 7532133, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d346e185ccb6e1dd533797dfee1f96da?s=128&d=identicon&r=PG&f=1", "display_name": "warfarin", "link": "https://stackoverflow.com/users/7532133/warfarin"}, "edited": false, "score": 0, "creation_date": 1486653453, "post_id": 42105955, "comment_id": 71446882, "body": "Well I&#39;m stumped, it must be a formatting issue. This doesn&#39;t work but if I add an elseif IsDate() = False statement it tells me that they&#39;re not recognized as dates. I don&#39;t understand though, the dates in the sheet are even recognized in serial format. I feel like it shouldn&#39;t be this hard to have a program recognize a value as a date. I&#39;m about to save it as .csv and have a python file parse it lol."}, {"owner": {"reputation": 3, "user_id": 7532133, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d346e185ccb6e1dd533797dfee1f96da?s=128&d=identicon&r=PG&f=1", "display_name": "warfarin", "link": "https://stackoverflow.com/users/7532133/warfarin"}, "edited": false, "score": 0, "creation_date": 1486658747, "post_id": 42105955, "comment_id": 71450642, "body": "When I run this on a separate worksheet with manually entered dates it only returns a value on the last row and it doesn&#39;t appear to be calculating correctly."}, {"owner": {"reputation": 3, "user_id": 7532133, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d346e185ccb6e1dd533797dfee1f96da?s=128&d=identicon&r=PG&f=1", "display_name": "warfarin", "link": "https://stackoverflow.com/users/7532133/warfarin"}, "edited": false, "score": 0, "creation_date": 1486659719, "post_id": 42105955, "comment_id": 71451350, "body": "Nvm, the variables Date and Cell value are just in wrong order in the DateDiff. It works. Now I just have to figure out why it won&#39;t work on my other sheet. Is there a way I can ask what each data type is when it fails? Or, alternatively, force a date type on the data? I tried the DateValue() from above and it did not work. Thanks."}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "reply_to_user": {"reputation": 3, "user_id": 7532133, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d346e185ccb6e1dd533797dfee1f96da?s=128&d=identicon&r=PG&f=1", "display_name": "warfarin", "link": "https://stackoverflow.com/users/7532133/warfarin"}, "edited": false, "score": 0, "creation_date": 1486659818, "post_id": 42105955, "comment_id": 71451415, "body": "You could try <code>Cdate</code> if it&#39;s a <code>String</code> constructed like a date"}, {"owner": {"reputation": 3, "user_id": 7532133, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d346e185ccb6e1dd533797dfee1f96da?s=128&d=identicon&r=PG&f=1", "display_name": "warfarin", "link": "https://stackoverflow.com/users/7532133/warfarin"}, "edited": false, "score": 0, "creation_date": 1486664071, "post_id": 42105955, "comment_id": 71454184, "body": "That didn&#39;t work either. Oddly enough I copy pasted all data into a new worksheet and everything works fine. Even my original code works. Not sure what was going on. Thank you for the help, and I will use your answer Shai, I like the utilization of the Datediff function, much cleaner looking. Thank you."}], "tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": true, "score": 0, "last_activity_date": 1486534557, "creation_date": 1486534557, "answer_id": 42105955, "question_id": 42103888, "link": "https://stackoverflow.com/questions/42103888/subtracting-dates-in-vba-using-a-for-loop/42105955#42105955", "title": "Subtracting dates in VBA using a for loop", "body": "<p>try the code below (I tested it with Dates, Numbers, Text and it worked)</p>\n\n<pre><code>Option Explicit\n\nSub LoopTest()\n\nDim counter As Long\n\n    For counter = 1 To 5\n        If IsDate(Range(\"B\" &amp; counter).Value) Then\n            If DateDiff(\"d\", Date, Range(\"B\" &amp; counter).Value) &gt; 30 Then\n                Range(\"H\" &amp; counter).Value = \"working\"\n            End If\n        End If\n    Next\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 7532133, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d346e185ccb6e1dd533797dfee1f96da?s=128&d=identicon&r=PG&f=1", "display_name": "warfarin", "link": "https://stackoverflow.com/users/7532133/warfarin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 368, "favorite_count": 0, "accepted_answer_id": 42105955, "answer_count": 1, "score": 0, "last_activity_date": 1486534557, "creation_date": 1486522767, "last_edit_date": 1486533984, "question_id": 42103888, "link": "https://stackoverflow.com/questions/42103888/subtracting-dates-in-vba-using-a-for-loop", "title": "Subtracting dates in VBA using a for loop", "body": "<p>I'm trying to make a decision when the difference between two dates is greater than n number. The problem arises when I use a variable (<code>counter</code>) to refer to the row index, it returns a type mismatch and will not subtract from <code>Date</code>. If I substitute a number in for the variable <code>counter</code> it runs fine. </p>\n\n<p>Why am I getting a mismatch error? </p>\n\n<p>Why does it view the cell value differently when I call it with the variable even though the variable is equivalent to the number?</p>\n\n<p>Thanks for the help.</p>\n\n<pre><code>Sub LoopTest()\n\nDim counter As Integer\n    For counter = 1 To 5\n        If Date - Cells(counter, 2) &gt; 30 Then\n            Range(\"H\" &amp; counter).Value = \"working\"\n        End If        \n    Next    \n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 7509348, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa6a8a529a57a36c903285f87d008574?s=128&d=identicon&r=PG&f=1", "display_name": "Arnab D", "link": "https://stackoverflow.com/users/7509348/arnab-d"}, "edited": false, "score": 0, "creation_date": 1486538842, "post_id": 42106628, "comment_id": 71383210, "body": "Thanks Shai for the quick response! The first part of the code works fine but the second part is giving  compilation error that says: &quot;Ambiguous name detected.&quot; Can you please tell me how I can work this out?"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "reply_to_user": {"reputation": 3, "user_id": 7509348, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa6a8a529a57a36c903285f87d008574?s=128&d=identicon&r=PG&f=1", "display_name": "Arnab D", "link": "https://stackoverflow.com/users/7509348/arnab-d"}, "edited": false, "score": 0, "creation_date": 1486539191, "post_id": 42106628, "comment_id": 71383384, "body": "@ArnabD on which line do you get the error ? where does the ywllow line stands ?"}, {"owner": {"reputation": 3, "user_id": 7509348, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa6a8a529a57a36c903285f87d008574?s=128&d=identicon&r=PG&f=1", "display_name": "Arnab D", "link": "https://stackoverflow.com/users/7509348/arnab-d"}, "edited": false, "score": 0, "creation_date": 1486542791, "post_id": 42106628, "comment_id": 71385211, "body": "The code works perfectly fine. I&#39;m sorry I copy-pasted both codes and as a result the error occurred. Thanks a bunch again for your help @Shai. :)"}], "tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": true, "score": 0, "last_activity_date": 1486537148, "creation_date": 1486537148, "answer_id": 42106628, "question_id": 42103835, "link": "https://stackoverflow.com/questions/42103835/copy-range-of-data-from-sheet-1-to-sheet-2-every-day-as-a-log/42106628#42106628", "title": "Copy range of data from sheet 1 to sheet 2 every day as a log", "body": "<p>To copy the Range(\"C3:C7\") from \"Sheet1\" to Range(\"B3:F3\") in \"Sheet2\" , you can use the code below (without using <code>Select</code> and <code>ActiveCell</code>).</p>\n\n<pre><code>Private Sub CommandButton21_Click()    \n\n    Worksheets(\"Sheet1\").Range(\"C3:C7\").Copy     \n    Worksheets(\"Sheet2\").Range(\"B3\").PasteSpecial Paste:=xlPasteAll, Operation:=xlNone, _\n                                    SkipBlanks:=False, Transpose:=True\n\nEnd Sub\n</code></pre>\n\n<p><strong>Note</strong>: this will result with \"overwriting\" the previous date's data, and will be hard to use it as a log.</p>\n\n<p>You can use the code below, to paste it in the first empty row in Column B in \"Sheet2\":</p>\n\n<pre><code>Private Sub CommandButton21_Click()\n\n    Dim LastRow As Long    \n    Worksheets(\"Sheet1\").Range(\"C3:C7\").Copy            \n\n    With Worksheets(\"Sheet2\")\n        LastRow = .Cells(.Rows.Count, \"B\").End(xlUp).Row + 1 '&lt;-- find first empty row in column B        \n        .Range(\"B\" &amp; LastRow).PasteSpecial Paste:=xlPasteAll, Operation:=xlNone, _\n                                    SkipBlanks:=False, Transpose:=True        \n    End With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 7509348, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa6a8a529a57a36c903285f87d008574?s=128&d=identicon&r=PG&f=1", "display_name": "Arnab D", "link": "https://stackoverflow.com/users/7509348/arnab-d"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 507, "favorite_count": 1, "accepted_answer_id": 42106628, "answer_count": 1, "score": 0, "last_activity_date": 1486537148, "creation_date": 1486522422, "last_edit_date": 1531164843, "question_id": 42103835, "link": "https://stackoverflow.com/questions/42103835/copy-range-of-data-from-sheet-1-to-sheet-2-every-day-as-a-log", "title": "Copy range of data from sheet 1 to sheet 2 every day as a log", "body": "<p>I want to copy data from Sheet 1 to Sheet 2 in the same workbook. The data set needs to be copied from range C3 to C7 on sheet 1 to B3 to F3 on sheet 2. The data gets copied everyday on sheet 2 as a log. I have a code that works if I define a single cell with Range object but doesn't work with multiple cells.</p>\n\n<p>The code is inserted on a button. Please find below the code. I'm a novice and would appreciate if someone helps with the error. </p>\n\n<pre><code>Private Sub CommandButton21_Click()\n\n    Dim Data As String\n    Worksheets(\"Sheet1\").Select\n    Data = Range(Cells(3, 3), Cells(3, 7))\n    Worksheets(\"Sheet2\").Select\n    Worksheets(\"Sheet2\").Range(Cells(2, 3), Cells(6, 3)).Select\n\n    If Worksheets(\"Sheet2\").Range(Cells(2, 3), Cells(6, 3)).Offset(1, 0)&lt;&gt; \"\" Then\n        Worksheets(\"Sheet2\").Range(Cells(2, 3), Cells(6, 3)).End(xlDown).Select\n    End If\n    ActiveCell.Offset(1, 0).Select\n    ActiveCell.Value = Data\n    Worksheets(\"Sheet1\").Select\n    Worksheets(\"Sheet1\").Range(Cells(3, 3), Cells(3, 7)).Select\n\nEnd Sub\n\nPrivate Sub Update_Click()\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["sql", "vba", "ms-access"], "comments": [{"owner": {"reputation": 63634, "user_id": 215752, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/face3276756bf64319a7d1df0d194d5c?s=128&d=identicon&r=PG", "display_name": "Hogan", "link": "https://stackoverflow.com/users/215752/hogan"}, "edited": false, "score": 0, "creation_date": 1486522428, "post_id": 42103797, "comment_id": 71377511, "body": "is it really the last 3 months?  you could just delete records with dates that are older.  That would be faster too.  take a look at the dateadd function (hint, a minus value will subtract)"}, {"owner": {"reputation": 10018, "user_id": 1309356, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o45P6.png?s=128&g=1", "display_name": "cha", "link": "https://stackoverflow.com/users/1309356/cha"}, "edited": false, "score": 0, "creation_date": 1486523039, "post_id": 42103797, "comment_id": 71377666, "body": "Access SQL happily supports <code>NOT IN</code>. Your problem is that you use <code>distinct</code>  and <code>top</code> together, which is according to Access SQL is not allowed:  <a href=\"https://msdn.microsoft.com/en-us/library/bb177882(v=office.12).aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/bb177882(v=office.12).aspx</a>"}, {"owner": {"reputation": 103, "user_id": 1688194, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5feca08c0a5a01def553f24a177c59dd?s=128&d=identicon&r=PG", "display_name": "user-DY", "link": "https://stackoverflow.com/users/1688194/user-dy"}, "edited": false, "score": 0, "creation_date": 1486524361, "post_id": 42103797, "comment_id": 71378023, "body": "in fact i have tried the 2 following before but they do not work.  (1) Delete from [Course] Where DateAdd(\u2018m\u2019, 3, ExtractDate) &lt; Now() (2) Delete from [Course] Where DateDiff(\u2018m\u2019, ExtractDate, now()) &gt; 3"}, {"owner": {"reputation": 10018, "user_id": 1309356, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o45P6.png?s=128&g=1", "display_name": "cha", "link": "https://stackoverflow.com/users/1309356/cha"}, "edited": false, "score": 0, "creation_date": 1486525210, "post_id": 42103797, "comment_id": 71378203, "body": "Access wants you to write <code>DELETE * FROM...</code>"}, {"owner": {"reputation": 103, "user_id": 1688194, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5feca08c0a5a01def553f24a177c59dd?s=128&d=identicon&r=PG", "display_name": "user-DY", "link": "https://stackoverflow.com/users/1688194/user-dy"}, "edited": false, "score": 0, "creation_date": 1486535383, "post_id": 42103797, "comment_id": 71381480, "body": "i doubt the * will make any difference in MS ACCESS."}], "answers": [{"comments": [{"owner": {"reputation": 103, "user_id": 1688194, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5feca08c0a5a01def553f24a177c59dd?s=128&d=identicon&r=PG", "display_name": "user-DY", "link": "https://stackoverflow.com/users/1688194/user-dy"}, "edited": false, "score": 0, "creation_date": 1486524303, "post_id": 42103895, "comment_id": 71378009, "body": "this will work if it is a select statement. but i need to delete those records that fall under the condition."}], "tags": [], "owner": {"reputation": 63634, "user_id": 215752, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/face3276756bf64319a7d1df0d194d5c?s=128&d=identicon&r=PG", "display_name": "Hogan", "link": "https://stackoverflow.com/users/215752/hogan"}, "is_accepted": false, "score": 0, "last_activity_date": 1486522802, "creation_date": 1486522802, "answer_id": 42103895, "question_id": 42103797, "link": "https://stackoverflow.com/questions/42103797/sql-not-in-query-on-ms-access-vba/42103895#42103895", "title": "SQL NOT IN Query on MS ACCESS/VBA", "body": "<p>NOT IN is the same as a left join where the target is null (thus there was no join)</p>\n\n<p>SO...</p>\n\n<pre><code>from [Course]\nwhere [ExtractDate] not in (\n   select distinct top 3 [ExtractDate] \n   from [Course] \n   order by [ExtractDate] desc\n)\n</code></pre>\n\n<p>is the same as </p>\n\n<pre><code>from [Course]\nleft join (\n   select distinct top 3 [ExtractDate] \n   from [Course] \n   order by [ExtractDate] desc\n) as x on [ExtractDate] = x.[ExtractDate]\nwhere x.[ExtractDate] is null\n</code></pre>\n\n<p>However, I make no claim any of your code was correct -- just that those two are the same in SQL.</p>\n"}, {"comments": [{"owner": {"reputation": 103, "user_id": 1688194, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5feca08c0a5a01def553f24a177c59dd?s=128&d=identicon&r=PG", "display_name": "user-DY", "link": "https://stackoverflow.com/users/1688194/user-dy"}, "edited": false, "score": 0, "creation_date": 1486535038, "post_id": 42104436, "comment_id": 71381325, "body": "i just tried, it doesn&#39;t seems to be working. the unwanted records are not being deleted. it is working fine on SQL server though. I am thinking whether its the DATEADD / DATEDIFF function that is not supported by MS ACCESS 2016."}, {"owner": {"reputation": 1106495, "user_id": 1144035, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e514b017977ebf742a418cac697d8996?s=128&d=identicon&r=PG", "display_name": "Gordon Linoff", "link": "https://stackoverflow.com/users/1144035/gordon-linoff"}, "reply_to_user": {"reputation": 103, "user_id": 1688194, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5feca08c0a5a01def553f24a177c59dd?s=128&d=identicon&r=PG", "display_name": "user-DY", "link": "https://stackoverflow.com/users/1688194/user-dy"}, "edited": false, "score": 0, "creation_date": 1486558320, "post_id": 42104436, "comment_id": 71395878, "body": "@user1688194 . . . <code>dateadd()</code> is definitely in MS Access (<a href=\"https://www.techonthenet.com/access/functions/date/dateadd.php\" rel=\"nofollow noreferrer\">techonthenet.com/access/functions/date/dateadd.php</a>)."}, {"owner": {"reputation": 103, "user_id": 1688194, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5feca08c0a5a01def553f24a177c59dd?s=128&d=identicon&r=PG", "display_name": "user-DY", "link": "https://stackoverflow.com/users/1688194/user-dy"}, "edited": false, "score": 0, "creation_date": 1486605221, "post_id": 42104436, "comment_id": 71421740, "body": "Oh no, there was a stupid mistake that i have made which cause the records to not be deleted. It is working now already. Thank you!"}], "tags": [], "owner": {"reputation": 1106495, "user_id": 1144035, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e514b017977ebf742a418cac697d8996?s=128&d=identicon&r=PG", "display_name": "Gordon Linoff", "link": "https://stackoverflow.com/users/1144035/gordon-linoff"}, "is_accepted": true, "score": 0, "last_activity_date": 1486526348, "creation_date": 1486526348, "answer_id": 42104436, "question_id": 42103797, "link": "https://stackoverflow.com/questions/42103797/sql-not-in-query-on-ms-access-vba/42104436#42104436", "title": "SQL NOT IN Query on MS ACCESS/VBA", "body": "<p>If you want records older than three months:</p>\n\n<pre><code>Delete from [Course]\n    where [ExtractDate] &lt; dateadd(\"m\", -3, date());\n</code></pre>\n\n<p>No set-based operation is needed.</p>\n"}], "owner": {"reputation": 103, "user_id": 1688194, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5feca08c0a5a01def553f24a177c59dd?s=128&d=identicon&r=PG", "display_name": "user-DY", "link": "https://stackoverflow.com/users/1688194/user-dy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2740, "favorite_count": 0, "accepted_answer_id": 42104436, "answer_count": 2, "score": 2, "last_activity_date": 1486607685, "creation_date": 1486522182, "last_edit_date": 1486607685, "question_id": 42103797, "link": "https://stackoverflow.com/questions/42103797/sql-not-in-query-on-ms-access-vba", "title": "SQL NOT IN Query on MS ACCESS/VBA", "body": "<p>I have the following Course table with different extract dates.</p>\n\n<pre><code>ID | Course | ExtractDate\n10 | 100000 | 2017-02-28\n10 | 100001 | 2017-01-31\n10 | 100002 | 2016-12-31\n10 | 100003 | 2016-11-30\n</code></pre>\n\n<p>I need to perform the following SQL script to keep only records from the latest 3 months, and hence removing the record with Course code 10003.</p>\n\n<pre><code>Delete from [Course] where [ExtractDate] not in (select distinct top 3 [ExtractDate] from [Course] order by [ExtractDate] desc\n</code></pre>\n\n<p>Seems like VBA or MS Access does not support the function \"not in\", anybody has any workaround for this? </p>\n\n<p>Thank you.</p>\n"}, {"tags": ["excel", "vba", "range", "selection"], "comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1486518400, "post_id": 42103171, "comment_id": 71376535, "body": "<code>Set temprange = Selection</code> - but please think twice (and then twice more) before building a lot of code around <code>Select</code> or <code>Activate</code>.  (E.g. are you just trying to <code>Set temprange = Range(&quot;E2&quot;).CurrentRegion</code>?)"}, {"owner": {"reputation": 27, "user_id": 7513331, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9069e72f32dc419ee488ead619c292d1?s=128&d=identicon&r=PG&f=1", "display_name": "Hahasiah", "link": "https://stackoverflow.com/users/7513331/hahasiah"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1486519199, "post_id": 42103171, "comment_id": 71376748, "body": "It worked with both selection and with currentregion .Thanks, whats the diference bettewen them? And how can i mark your comment as an answer? :D"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1486519478, "post_id": 42103171, "comment_id": 71376815, "body": "Theoretically, the answer to your question is just the <code>Set temprange = Selection</code> part of my comment (so you can mark @Michael&#39;s answer as correct).  I doubt if the <code>Select</code> statements you currently use will <b>always</b> end up with <code>CurrentRegion</code>, so that part of my comment has nothing to do with the question, and is just a suggestion on what you should probably really be doing to achieve what you are wanting to do."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 1, "creation_date": 1486519684, "post_id": 42103171, "comment_id": 71376860, "body": "P.S.  See <a href=\"http://stackoverflow.com/q/10714251/6535336\">How to avoid using Select in Excel VBA macros</a> for some very good tips on ... wait for it ... how to avoid using <code>Select</code> in Excel VBA macros."}], "answers": [{"tags": [], "owner": {"reputation": 4058, "user_id": 7444507, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e538cc60b5829d23dd6601a5807e9e9e?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/7444507/michael"}, "is_accepted": true, "score": 2, "last_activity_date": 1486526156, "last_edit_date": 1486526156, "creation_date": 1486518576, "answer_id": 42103290, "question_id": 42103171, "link": "https://stackoverflow.com/questions/42103171/how-to-set-a-range-of-the-cells-selected-in-that-moment/42103290#42103290", "title": "How to set a range of the cells selected in that moment", "body": "<p>If you want to refer to cells that are ALREADY selected, just use the Selection reference:</p>\n\n<pre><code>Set temprange = Selection\n</code></pre>\n\n<p>Note that it's generally better to avoid working with selections in VBA where possible and simple work with ranges. It's possible for you to rewrite the code to not work with selections at all:</p>\n\n<pre><code>Set temprange = Range(Range(\"E2\").End(xlToRight), Range(\"E2\").End(xlDown))\nSet temprange = Range(temprange, temprange.End(xlToLeft))\nSet temprange = Range(temprange, temprange.End(xlToRight))\n</code></pre>\n\n<p>You could probably also simplify this further using offsets to automatically include 2 additional columns to the right. See the article below for more details about how to reference ranges in VBA:</p>\n\n<p><a href=\"https://msdn.microsoft.com/en-us/library/office/gg192736(v=office.14).aspx\" rel=\"nofollow noreferrer\">https://msdn.microsoft.com/en-us/library/office/gg192736(v=office.14).aspx</a></p>\n"}, {"tags": [], "owner": {"reputation": 52630, "user_id": 641067, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/n6xVq.png?s=128&g=1", "display_name": "brettdj", "link": "https://stackoverflow.com/users/641067/brettdj"}, "is_accepted": false, "score": 0, "last_activity_date": 1486528949, "creation_date": 1486528949, "answer_id": 42104871, "question_id": 42103171, "link": "https://stackoverflow.com/questions/42103171/how-to-set-a-range-of-the-cells-selected-in-that-moment/42104871#42104871", "title": "How to set a range of the cells selected in that moment", "body": "<p>An option is to provide this choice to select a range to the user, with the current selection already populated as default:</p>\n\n<p><em>code</em></p>\n\n<pre><code>Sub GetRng()\nDim rng1 As Range\nOn Error Resume Next\nSet rng1 = Application.InputBox(\"pls select range\", \"Set Range\", Selection.Address, , , , , 8)\nOn Error GoTo 0\nIf rng1 Is Nothing Then MsgBox \"User cancelled\", vbCritical\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 27, "user_id": 7513331, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9069e72f32dc419ee488ead619c292d1?s=128&d=identicon&r=PG&f=1", "display_name": "Hahasiah", "link": "https://stackoverflow.com/users/7513331/hahasiah"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 154, "favorite_count": 0, "accepted_answer_id": 42103290, "answer_count": 2, "score": 1, "last_activity_date": 1486528949, "creation_date": 1486517773, "question_id": 42103171, "link": "https://stackoverflow.com/questions/42103171/how-to-set-a-range-of-the-cells-selected-in-that-moment", "title": "How to set a range of the cells selected in that moment", "body": "<p>I'm trying to set a range of cells that are already selected is there a way to do it?</p>\n\n<pre><code>    Range(\"e2\").Select\n    Range(Selection.End(xlToRight), Selection.End(xlDown)).Select\n    Range(Selection, Selection.End(xlToLeft)).Select\n    Range(Selection, Selection.End(xlToRight)).Select\n    Set temprange = activeselection\n</code></pre>\n\n<p>I had to select that way because in the sheet there aren't data in all columns always but in E it have to and the data starts in row 2 it work fine but i need to set it as a range in other to pass a filter on it. </p>\n\n<p>Activeselection was too easy so i should know that it wasn't going to work that way..\nWhat is the proper way to do it? Thanks  </p>\n"}, {"tags": ["excel", "string", "vba", "resize", "range"], "answers": [{"tags": [], "owner": {"reputation": 4058, "user_id": 7444507, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e538cc60b5829d23dd6601a5807e9e9e?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/7444507/michael"}, "is_accepted": false, "score": 0, "last_activity_date": 1486518089, "creation_date": 1486518089, "answer_id": 42103214, "question_id": 42103102, "link": "https://stackoverflow.com/questions/42103102/how-to-resize-a-range-to-stop-at-a-cell-with-text-vba/42103214#42103214", "title": "How to resize a range to stop at a cell with text VBA?", "body": "<p>These examples assume you're working in column A.</p>\n\n<p>If you don't have any blank cells until the end of your data, you can simply perform the VBA equivalent of pressing Ctrl-Shift-DownArrow:</p>\n\n<pre><code>Range(Range(\"A1\"),Range(\"A1\").End(xlDown)).Select\n</code></pre>\n\n<p>Otherwise you'll need to first find the cell using a loop or the find function. Looping is a little slower but easier to code:</p>\n\n<pre><code>i = 0\n\nDo\n    i = i + 1\nLoop While Cells(i, 1) &lt;&gt; \"End of Data\"\n\nRange(\"A1\", Cells(i, 1)).Select\n</code></pre>\n\n<p>The following guide is good for explaining the various ways to refer to a range of data in VBA:</p>\n\n<p><a href=\"https://msdn.microsoft.com/en-us/library/office/gg192736(v=office.14).aspx\" rel=\"nofollow noreferrer\">https://msdn.microsoft.com/en-us/library/office/gg192736(v=office.14).aspx</a></p>\n"}, {"tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": false, "score": 0, "last_activity_date": 1486547702, "creation_date": 1486547702, "answer_id": 42109821, "question_id": 42103102, "link": "https://stackoverflow.com/questions/42103102/how-to-resize-a-range-to-stop-at-a-cell-with-text-vba/42109821#42109821", "title": "How to resize a range to stop at a cell with text VBA?", "body": "<p>you could use this function:</p>\n\n<pre><code>Function ResizeRangeDownToACertainString(iniCell As Range, stringToStopAt As String) As Range\n    Dim endCell As Range\n\n    With iniCell.Parent\n        Set endCell = .Range(iniCell, .Cells(.Rows.count, iniCell.Column)).Find(what:=stringToStopAt, LookIn:=xlValues, lookat:=xlWhole)\n        If endCell Is Nothing Then\n            Set ResizeRangeDownToACertainString = iniCell\n        Else\n            Set ResizeRangeDownToACertainString = .Range(iniCell, endCell)\n        End If\n    End With\nEnd Function\n</code></pre>\n\n<p>and exploit it in your \"main\" code as follows</p>\n\n<pre><code>Sub main()\n    Dim myRng As Range\n\n    Set myRng = ResizeRangeDownToACertainString(Range(\"A2\"), \"End Of Data\")\nEnd Sub\n</code></pre>\n\n<p>you may want to change the function behavior when it doesn't find the wanted string</p>\n"}], "owner": {"reputation": 1, "user_id": 7463906, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Av9wstPjXAw/AAAAAAAAAAI/AAAAAAAANgw/Td8NIT3bZws/photo.jpg?sz=128", "display_name": "Curry Monster", "link": "https://stackoverflow.com/users/7463906/curry-monster"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 597, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1486547702, "creation_date": 1486517292, "question_id": 42103102, "link": "https://stackoverflow.com/questions/42103102/how-to-resize-a-range-to-stop-at-a-cell-with-text-vba", "title": "How to resize a range to stop at a cell with text VBA?", "body": "<p>I'm trying to resize a range to start at a certain point and resize it down until it hits a cell that contains the text \"End of Data\"</p>\n\n<p>What would that/those line(s) of code look like?  I don't know if you can pass a string find argument to the resize function for range.</p>\n\n<p>Thank you!</p>\n"}, {"tags": ["vba", "excel", "passwords"], "comments": [{"owner": {"reputation": 8811, "user_id": 5757159, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/yxD51.png?s=128&g=1", "display_name": "ThunderFrame", "link": "https://stackoverflow.com/users/5757159/thunderframe"}, "edited": false, "score": 0, "creation_date": 1486516405, "post_id": 42102778, "comment_id": 71375994, "body": "Password on a workbook, sheet or its VBA project?"}, {"owner": {"reputation": 351, "user_id": 7355173, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7dda11ab1331fa4a3e018d35015a29b7?s=128&d=identicon&r=PG&f=1", "display_name": "SQL_Deadwood", "link": "https://stackoverflow.com/users/7355173/sql-deadwood"}, "reply_to_user": {"reputation": 8811, "user_id": 5757159, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/yxD51.png?s=128&g=1", "display_name": "ThunderFrame", "link": "https://stackoverflow.com/users/5757159/thunderframe"}, "edited": false, "score": 0, "creation_date": 1486517536, "post_id": 42102778, "comment_id": 71376306, "body": "The password on a workbook."}], "answers": [{"tags": [], "owner": {"reputation": 4058, "user_id": 7444507, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e538cc60b5829d23dd6601a5807e9e9e?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/7444507/michael"}, "is_accepted": false, "score": 1, "last_activity_date": 1486518960, "creation_date": 1486518960, "answer_id": 42103359, "question_id": 42102778, "link": "https://stackoverflow.com/questions/42102778/macro-programmatically-remove-known-excel-passwords/42103359#42103359", "title": "Macro: Programmatically Remove Known Excel Passwords", "body": "<p>Just resave the workbook without a password:</p>\n\n<pre><code>ActiveWorkbook.SaveAs\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 351, "user_id": 7355173, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7dda11ab1331fa4a3e018d35015a29b7?s=128&d=identicon&r=PG&f=1", "display_name": "SQL_Deadwood", "link": "https://stackoverflow.com/users/7355173/sql-deadwood"}, "edited": false, "score": 0, "creation_date": 1486525515, "post_id": 42103556, "comment_id": 71378265, "body": "This is great - thank you! Now I just need to learn how to loop through all the files in a folder and call different passwords from a list depending on the name of the file."}, {"owner": {"reputation": 4058, "user_id": 7444507, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e538cc60b5829d23dd6601a5807e9e9e?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/7444507/michael"}, "edited": false, "score": 1, "creation_date": 1486526364, "post_id": 42103556, "comment_id": 71378479, "body": "You&#39;ll need the Dir function"}], "tags": [], "owner": {"reputation": 173, "user_id": 3847207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e177b9ef9729e7b4feaeaca796b49590?s=128&d=identicon&r=PG&f=1", "display_name": "zaphodalive", "link": "https://stackoverflow.com/users/3847207/zaphodalive"}, "is_accepted": true, "score": 2, "last_activity_date": 1486520348, "creation_date": 1486520348, "answer_id": 42103556, "question_id": 42102778, "link": "https://stackoverflow.com/questions/42102778/macro-programmatically-remove-known-excel-passwords/42103556#42103556", "title": "Macro: Programmatically Remove Known Excel Passwords", "body": "<p>You'll need to open the workbook specifying the passwords to open and modify, then saveas specifying an empty password for open and modify.  To avoid getting prompts when overwriting the existing file, you need to disable alerts.</p>\n\n<p>e.g.</p>\n\n<pre><code>Sub OpenAndSaveWithoutPasswords()\n\n    Dim wb As Workbook\n\n    Application.DisplayAlerts = False\n\n    Set wb = Workbooks.Open(Filename:=\"YOUR PATH AND FILENAME\", Password:=\"OPEN PASSWORD\", WriteResPassword:=\"MODIFY PASSWORD\")\n    wb.SaveAs Filename:=\"YOUR PATH AND FILENAME AGAIN\", Password:=\"\", WriteResPassword:=\"\"\n\n    Application.DisplayAlerts = True\n\nEnd Sub\n</code></pre>\n\n<p>Note: Workbooks.Open seems to require brackets, wb.SaveAs requires no brackets (don't ask me why).</p>\n"}], "owner": {"reputation": 351, "user_id": 7355173, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7dda11ab1331fa4a3e018d35015a29b7?s=128&d=identicon&r=PG&f=1", "display_name": "SQL_Deadwood", "link": "https://stackoverflow.com/users/7355173/sql-deadwood"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1511, "favorite_count": 0, "accepted_answer_id": 42103556, "answer_count": 2, "score": 0, "last_activity_date": 1486520348, "creation_date": 1486515239, "question_id": 42102778, "link": "https://stackoverflow.com/questions/42102778/macro-programmatically-remove-known-excel-passwords", "title": "Macro: Programmatically Remove Known Excel Passwords", "body": "<p>Is there a means to remove a <strong>KNOWN</strong> password from an Excel file via a VBA macro? Web searches only return the method to crack unknown Excel passwords.</p>\n\n<p>I've automated all other aspects of the data handling except downloading files from an FTP site and subsequently removing the password.</p>\n"}, {"tags": ["vba", "excel", "clipboard", "clipboarddata"], "comments": [{"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1486515041, "post_id": 42102597, "comment_id": 71375583, "body": "Maybe not quite a duplicate, but related: <a href=\"http://stackoverflow.com/q/24910288/4996248\">stackoverflow.com/q/24910288/4996248</a>"}, {"owner": {"reputation": 99, "user_id": 6929289, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/fee60350d4401aa7df1437c13c838ada?s=128&d=identicon&r=PG&f=1", "display_name": "Esuriency", "link": "https://stackoverflow.com/users/6929289/esuriency"}, "reply_to_user": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1486515451, "post_id": 42102597, "comment_id": 71375717, "body": "Thanks I was looking at that, however in my case my source that I&#39;m copying could be from anywhere not just an Excel cell. So I would just want to get the contents of the clipboard (assumes that user has already hit CTRL+C on something)."}], "answers": [{"tags": [], "owner": {"reputation": 4058, "user_id": 7444507, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e538cc60b5829d23dd6601a5807e9e9e?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/7444507/michael"}, "is_accepted": false, "score": 0, "last_activity_date": 1486519415, "creation_date": 1486519415, "answer_id": 42103431, "question_id": 42102597, "link": "https://stackoverflow.com/questions/42102597/cleaning-quotes-from-clipboard-data-in-vba/42103431#42103431", "title": "Cleaning quotes from clipboard data in VBA", "body": "<p>Not really.</p>\n\n<p>If double quotes are being inconsistently added to the clipboard in the copying process AND there are legitimate quotes in the source data that you want to keep, there's no way from just looking at what's currently in the clipboard to know for certain what was in the original data and what was added in the copying process.</p>\n\n<p>The best you can do is try to recognize any patterns of quotes being added incorrectly and try to remove those.</p>\n\n<p>For example, test each value to determine whether there is a double quote at the beginning and/or at the end, in which case remove the first and/or last character from that value.</p>\n"}], "owner": {"reputation": 99, "user_id": 6929289, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/fee60350d4401aa7df1437c13c838ada?s=128&d=identicon&r=PG&f=1", "display_name": "Esuriency", "link": "https://stackoverflow.com/users/6929289/esuriency"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 234, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1486519415, "creation_date": 1486514033, "question_id": 42102597, "link": "https://stackoverflow.com/questions/42102597/cleaning-quotes-from-clipboard-data-in-vba", "title": "Cleaning quotes from clipboard data in VBA", "body": "<p>I have a macro that will paste into a selected cell multi-lined data from the clipboard. It will insert new rows for each line. Column A and Row1 contains headers and it will fill it out for any inserted rows. </p>\n\n<pre><code>Sheet1\nHeader0 Header  Header  Header\nHeader1 Data        \nHeader2 Data    Data1\n                Data2   Data\nHeader3 Data\n</code></pre>\n\n<p>Sometimes it adds additional \"\" quotes, sometimes it doesn't. Is there a way to clean the clipboard data without removing legitimate quote characters?</p>\n\n<p><a href=\"https://i.stack.imgur.com/QRow7.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/QRow7.png\" alt=\"cellContent array\"></a></p>\n\n<pre><code>Sub ClipboardToRows()\n' Split multi-lined data into separate rows for the current selection\n' Assumption is that Column A contains row headers\nDim currRange As Range, currCell As Range, pasteCell As Range\nDim rowHeader As String\nDim cellContent\nDim cellStr\n\nDim clipboard As MSForms.DataObject\nDim str1 As String\nSet clipboard = New MSForms.DataObject\n\nclipboard.GetFromClipboard\nOn Error GoTo clipEmpty\nstr1 = Trim(clipboard.GetText())\n\nApplication.CutCopyMode = False\nSet currCell = Selection\n\nrowHeader = Cells(currCell.Row, 1).Value\n'Skip Column A\nIf (currCell.Column &gt; 1) Then\n    cellContent = Split(str1, Chr(10))\n    For i = LBound(cellContent) To (UBound(cellContent))\n        cellStr = Trim(cellContent(i))\n        If Len(cellStr) &gt; 0 Then\n            Set pasteCell = currCell.Offset(i)\n            'Set current cell with line 1\n            If i = 0 Then\n                currCell.Value = cellContent(i)\n            Else\n                'If next cell down is not empty or the row header is different\n                If (Not IsEmpty(pasteCell.Value)) Or (Cells(pasteCell.Row, 1).Value &lt;&gt; rowHeader) Then\n                    pasteCell.EntireRow.Insert\n                    Cells(pasteCell.Row - 1, 1).Value = rowHeader\n                End If\n                currCell.Offset(i).Value = cellContent(i)\n\n            End If\n        End If\n    Next\nEnd If\n\nclipEmpty:\n    If Err &lt;&gt; 0 Then MsgBox \"There was an issue with pasting. Please try again.\"\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "vlookup"], "answers": [{"comments": [{"owner": {"reputation": 27, "user_id": 7513331, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9069e72f32dc419ee488ead619c292d1?s=128&d=identicon&r=PG&f=1", "display_name": "Hahasiah", "link": "https://stackoverflow.com/users/7513331/hahasiah"}, "edited": false, "score": 0, "creation_date": 1486747593, "post_id": 42105934, "comment_id": 71495292, "body": "Something like that i had but using a variable instead of putting the value in one cell but it doesn&#39;t work. I mean i want to put the values in the others textboxes live as soon as i finish to type the number it should show the name in the other textbox without pressing anything else. Its an userform and i had use a multipage don&#39;t know if that change the situation, thx"}, {"owner": {"reputation": 294, "user_id": 5518412, "user_type": "registered", "profile_image": "https://graph.facebook.com/900413473399114/picture?type=large", "display_name": "Praveen Behera", "link": "https://stackoverflow.com/users/5518412/praveen-behera"}, "reply_to_user": {"reputation": 27, "user_id": 7513331, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9069e72f32dc419ee488ead619c292d1?s=128&d=identicon&r=PG&f=1", "display_name": "Hahasiah", "link": "https://stackoverflow.com/users/7513331/hahasiah"}, "edited": false, "score": 0, "creation_date": 1486963974, "post_id": 42105934, "comment_id": 71556409, "body": "I agree with you, but i tried using a variable, it doesn&#39;t work. but storing in a cell in background, it works with charm. with this code, you are still working live on the form, as soon as you fill in 1 textbox, others will fill up automatically."}], "tags": [], "owner": {"reputation": 294, "user_id": 5518412, "user_type": "registered", "profile_image": "https://graph.facebook.com/900413473399114/picture?type=large", "display_name": "Praveen Behera", "link": "https://stackoverflow.com/users/5518412/praveen-behera"}, "is_accepted": true, "score": 1, "last_activity_date": 1486534442, "creation_date": 1486534442, "answer_id": 42105934, "question_id": 42102295, "link": "https://stackoverflow.com/questions/42102295/using-vlookup-in-vba-but-updating-the-userform-live/42105934#42105934", "title": "Using vlookup in vba but updating the userform live", "body": "<p>If data is in this range</p>\n\n<p><a href=\"https://i.stack.imgur.com/WfaVo.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/WfaVo.png\" alt=\"If data is in this range\"></a></p>\n\n<pre><code>Private Sub TextBox1_Change()\n\n'Skip if value is not there\nOn Error Resume Next\n\n'take any random cell to store textbox1's value\n\nRange(\"C4\").Value = TextBox1.Text\n\n'Vlookup to get the value\nTextBox2.Text = Application.WorksheetFunction.VLookup(Range(\"C4\").Value,Sheet1.Range(\"A:B\"), 2, 0)\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 27, "user_id": 7513331, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9069e72f32dc419ee488ead619c292d1?s=128&d=identicon&r=PG&f=1", "display_name": "Hahasiah", "link": "https://stackoverflow.com/users/7513331/hahasiah"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 575, "favorite_count": 0, "accepted_answer_id": 42105934, "answer_count": 1, "score": 1, "last_activity_date": 1486534442, "creation_date": 1486512077, "last_edit_date": 1592644375, "question_id": 42102295, "link": "https://stackoverflow.com/questions/42102295/using-vlookup-in-vba-but-updating-the-userform-live", "title": "Using vlookup in vba but updating the userform live", "body": "<p>I have an userform with a few texbox and i want that when you put the value on the first one scan the data sheet and if it found the same value it fill the rest of textboxes, i think i can manage to do it if i do it in two steps. First take the value of textbox1 as variable and with it scan the data an generate the second userform with the data already paste on it. But is there a way to do it live? at the moment i put data in textbox1 shows the data of the rest of the columns on the others textboxes?</p>\n<p>Also i was trying to do more or less the same thing in a sheet with an vlookup formula (VLOOKUP(A27,BDD!A:B,2,FALSE)) and it worked but the problem is that i want the formula to change the value of the cells only in case it found a mach in the data and also i don't want the formula in the cells i want to change so i can put new data without problem.</p>\n<p>Lets say i have in the sheet &quot;bdd&quot; numbers in the first columns and names in the second. I want in another sheet to put a number and if that number already exist in the bdd i want to have the name near to it but i dont want the formula near to the numbers because i want to be able to put new numbers and names if necessary.</p>\n<h1>bdd:</h1>\n<p>101 Antonio<br />\n102 Luis</p>\n<h1>sheet</h1>\n<p>101 Antonio (At the moment i finish writing 101)</p>\n<p>103 Peter  (nothing happens because it isn't in the bdd yet and i have to type peter to complete that line or put 103 peter in the bdd)</p>\n<p>Sorry if it wasn't clear i tried :P Thanks in advance</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 1, "creation_date": 1486511190, "post_id": 42102099, "comment_id": 71374458, "body": "Please see <a href=\"http://stackoverflow.com/q/10714251/11683\">How to avoid using Select in Excel VBA macros</a>."}, {"owner": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 2, "creation_date": 1486511884, "post_id": 42102099, "comment_id": 71374673, "body": "It&#39;s hard to say why it doesn&#39;t <i>work as expected</i> when you&#39;ve neither explained how you <i>expected</i> it to work or how it&#39;s <i>working instead</i> of as expected. Can you <a href=\"https://stackoverflow.com/posts/42102099/edit\">edit</a> your question to actually <i>explain the problem you&#39;re having</i> with the code you posted? If you don&#39;t understand why you need to do so, call your auto repair shop and say <i>My car isn&#39;t working as expected. What&#39;s wrong and how much to fix it?</i> and see if they give you an answer without needing more information."}, {"owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "edited": false, "score": 0, "creation_date": 1486512133, "post_id": 42102099, "comment_id": 71374741, "body": "One POSSIBLE explanation is there is something to do with timing with your code. You are waiting in between actions longer than the CPU would perform the actions. This is not the ONLY option."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 7526062, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-T6ZIyq0IY-M/AAAAAAAAAAI/AAAAAAAAB0M/VijQOPK42Ao/photo.jpg?sz=128", "display_name": "Felipe Vitalino Mendon&#231;a", "link": "https://stackoverflow.com/users/7526062/felipe-vitalino-mendon%c3%a7a"}, "edited": false, "score": 0, "creation_date": 1486596664, "post_id": 42102353, "comment_id": 71419247, "body": "Thank you very much! Qualifying like your example solved my problem I was having!"}], "tags": [], "owner": {"reputation": 4058, "user_id": 7444507, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e538cc60b5829d23dd6601a5807e9e9e?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/7444507/michael"}, "is_accepted": true, "score": 0, "last_activity_date": 1486513025, "last_edit_date": 1486513025, "creation_date": 1486512519, "answer_id": 42102353, "question_id": 42102099, "link": "https://stackoverflow.com/questions/42102099/vba-code-runs-correctly-on-debug-f8-but-behaves-differently-undisired-way-wh/42102353#42102353", "title": "VBA code runs correctly on debug (F8) but behaves differently (undisired way) when run through a button", "body": "<p>Are you sure the macro has been correctly assigned? Put a message box at the start of the macro to confirm it is running:</p>\n\n<pre><code>MsgBox \"Running\"\n</code></pre>\n\n<p>If the message box doesn't display when you click the button, then the macro isn't running at all. If the message box does display and you still don't have your data being copied correctly, then try the following:</p>\n\n<p>Using Paste Special can have issues when the sheet you're pasting to isn't active. This issue can be hidden when you're stepping through code, especially if you're manually changing tabs to watch what happens at each step.</p>\n\n<p>Note that you don't need to activate the sheet that you're copying from, so you just need to make the destination sheet active at the start of the macro instead:</p>\n\n<pre><code>Sheets(\"Historico vendas\").activate\n</code></pre>\n\n<p>You just need to change your code so that everything that looks at your Venda sheet is qualified. It looks like all of your code is already qualified, except for the ranges in your If statements. Update those as well, and then see if it works. E.g.</p>\n\n<pre><code>If IsEmpty(Sheets(\"Venda\").Range(\"C7\").Value) = False Then\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 7526062, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-T6ZIyq0IY-M/AAAAAAAAAAI/AAAAAAAAB0M/VijQOPK42Ao/photo.jpg?sz=128", "display_name": "Felipe Vitalino Mendon&#231;a", "link": "https://stackoverflow.com/users/7526062/felipe-vitalino-mendon%c3%a7a"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 519, "favorite_count": 0, "accepted_answer_id": 42102353, "answer_count": 1, "score": 0, "last_activity_date": 1542269826, "creation_date": 1486510951, "last_edit_date": 1542269826, "question_id": 42102099, "link": "https://stackoverflow.com/questions/42102099/vba-code-runs-correctly-on-debug-f8-but-behaves-differently-undisired-way-wh", "title": "VBA code runs correctly on debug (F8) but behaves differently (undisired way) when run through a button", "body": "<p>My code behaves similarly, runs ok when stepping trough(F8) but when assigning a macro to a picture, button or whatever, the code doesn't bahave as expected (also doesn't crash). Does anyone know a fix?</p>\n\n<p>My code simply copies data from one sheet to another in a certain structure. Thank you.</p>\n\n<p><a href=\"https://www.dropbox.com/s/kmidgign0dcv8oq/vendas-estoque3.xlsm?dl=0\" rel=\"nofollow noreferrer\">Excel file on dropbox</a></p>\n\n<pre><code>Sub BaixarVenda()\npecas = 0\nSheets(\"Venda\").Select\nRange(\"A1\").Select\n\nIf IsEmpty(Range(\"C7\").Value) = False Then\n'one item sale\nSheets(\"Venda\").Range(\"C2\").Copy Destination:=Sheets(\"Historico     vendas\").Range(\"A1\").End(xlDown).Offset(1, 0)\nSheets(\"Venda\").Range(\"C4\").Copy\nSheets(\"Historico vendas\").Range(\"A1\").End(xlDown).Offset(0, 1).PasteSpecial     Paste:=xlPasteValuesAndNumberFormats\nSheets(\"Venda\").Range(\"C7\").Copy Destination:=Sheets(\"Historico vendas\").Range(\"A1\").End(xlDown).Offset(0, 2)\nSheets(\"Venda\").Range(\"C9\").Copy\nSheets(\"Historico vendas\").Range(\"A1\").End(xlDown).Offset(0, 3).PasteSpecial  Paste:=xlPasteValues\nSheets(\"Venda\").Range(\"C11\").Copy Destination:=Sheets(\"Historico vendas\").Range(\"A1\").End(xlDown).Offset(0, 4)\nSheets(\"Venda\").Range(\"C13\").Copy\nSheets(\"Historico vendas\").Range(\"A1\").End(xlDown).Offset(0, 5).PasteSpecial Paste:=xlPasteValuesAndNumberFormats\npecas = pecas + 1\nEnd If\n\nIf IsEmpty(Range(\"E7\").Value) = False Then\nSheets(\"Venda\").Range(\"C2\").Copy Destination:=Sheets(\"Historico vendas\").Range(\"A1\").End(xlDown).Offset(1, 0)\nSheets(\"Venda\").Range(\"C4\").Copy\nSheets(\"Historico vendas\").Range(\"A1\").End(xlDown).Offset(0, 1).PasteSpecial Paste:=xlPasteValuesAndNumberFormats\nSheets(\"Historico vendas\").Range(\"A1\").End(xlDown).Offset(0, 5).PasteSpecial    Paste:=xlPasteValuesAndNumberFormats\nSheets(\"Venda\").Range(\"E7\").Copy Destination:=Sheets(\"Historico vendas\").Range(\"A1\").End(xlDown).Offset(0, 2)\nSheets(\"Venda\").Range(\"E9\").Copy\nSheets(\"Historico vendas\").Range(\"A1\").End(xlDown).Offset(0, 3).PasteSpecial Paste:=xlPasteValues\nSheets(\"Venda\").Range(\"E11\").Copy Destination:=Sheets(\"Historico vendas\").Range(\"A1\").End(xlDown).Offset(0, 4)\nSheets(\"Venda\").Range(\"E13\").Copy\nSheets(\"Historico vendas\").Range(\"A1\").End(xlDown).Offset(0, 5).PasteSpecial Paste:=xlPasteValuesAndNumberFormats\npecas = pecas + 1\nEnd If\n\nIf IsEmpty(Range(\"G7\").Value) = False Then\n'3 item sale\n\nSheets(\"Venda\").Range(\"C2\").Copy Destination:=Sheets(\"Historico vendas\").Range(\"A1\").End(xlDown).Offset(1, 0)\nSheets(\"Venda\").Range(\"C4\").Copy\nSheets(\"Historico vendas\").Range(\"A1\").End(xlDown).Offset(0, 1).PasteSpecial Paste:=xlPasteValuesAndNumberFormats\nSheets(\"Historico vendas\").Range(\"A1\").End(xlDown).Offset(0, 5).PasteSpecial Paste:=xlPasteValuesAndNumberFormats\nSheets(\"Venda\").Range(\"G7\").Copy Destination:=Sheets(\"Historico vendas\").Range(\"A1\").End(xlDown).Offset(0, 2)\nSheets(\"Venda\").Range(\"G9\").Copy\nSheets(\"Historico vendas\").Range(\"A1\").End(xlDown).Offset(0, 3).PasteSpecial     Paste:=xlPasteValues\nSheets(\"Venda\").Range(\"G11\").Copy Destination:=Sheets(\"Historico vendas\").Range(\"A1\").End(xlDown).Offset(0, 4)\nSheets(\"Venda\").Range(\"G13\").Copy\nSheets(\"Historico vendas\").Range(\"A1\").End(xlDown).Offset(0, 5).PasteSpecial Paste:=xlPasteValuesAndNumberFormats\npecas = pecas + 1\nEnd If\n\nIf IsEmpty(Range(\"I7\").Value) = False Then\n\nSheets(\"Venda\").Range(\"C2\").Copy Destination:=Sheets(\"Historico vendas\").Range(\"A1\").End(xlDown).Offset(1, 0)\nSheets(\"Venda\").Range(\"C4\").Copy\nSheets(\"Historico vendas\").Range(\"A1\").End(xlDown).Offset(0, 1).PasteSpecial Paste:=xlPasteValuesAndNumberFormats\nSheets(\"Historico vendas\").Range(\"A1\").End(xlDown).Offset(0, 5).PasteSpecial Paste:=xlPasteValuesAndNumberFormats\nSheets(\"Venda\").Range(\"I7\").Copy Destination:=Sheets(\"Historico vendas\").Range(\"A1\").End(xlDown).Offset(0, 2)\nSheets(\"Venda\").Range(\"I9\").Copy\nSheets(\"Historico vendas\").Range(\"A1\").End(xlDown).Offset(0, 3).PasteSpecial     Paste:=xlPasteValues\nSheets(\"Venda\").Range(\"I11\").Copy Destination:=Sheets(\"Historico vendas\").Range(\"A1\").End(xlDown).Offset(0, 4)\nSheets(\"Venda\").Range(\"I13\").Copy\nSheets(\"Historico vendas\").Range(\"A1\").End(xlDown).Offset(0, 5).PasteSpecial Paste:=xlPasteValuesAndNumberFormats\npecas = pecas + 1\nEnd If\n\nIf IsEmpty(Range(\"K7\").Value) = False Then\nSheets(\"Venda\").Range(\"C2\").Copy Destination:=Sheets(\"Historico vendas\").Range(\"A1\").End(xlDown).Offset(1, 0)\nSheets(\"Venda\").Range(\"C4\").Copy\nSheets(\"Historico vendas\").Range(\"A1\").End(xlDown).Offset(0, 1).PasteSpecial Paste:=xlPasteValuesAndNumberFormats\nSheets(\"Historico vendas\").Range(\"A1\").End(xlDown).Offset(0, 5).PasteSpecial Paste:=xlPasteValuesAndNumberFormats\nSheets(\"Venda\").Range(\"K7\").Copy Destination:=Sheets(\"Historico   vendas\").Range(\"A1\").End(xlDown).Offset(0, 2)\nSheets(\"Venda\").Range(\"K9\").Copy\nSheets(\"Historico vendas\").Range(\"A1\").End(xlDown).Offset(0, 3).PasteSpecial Paste:=xlPasteValues\nSheets(\"Venda\").Range(\"K11\").Copy Destination:=Sheets(\"Historico vendas\").Range(\"A1\").End(xlDown).Offset(0, 4)\nSheets(\"Venda\").Range(\"K13\").Copy\nSheets(\"Historico vendas\").Range(\"A1\").End(xlDown).Offset(0, 5).PasteSpecial    Paste:=xlPasteValuesAndNumberFormats\n\npecas = pecas + 1\nEnd If \nSheets(\"Venda\").Select\nMsgBox \"Venda finalizada\"\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1486511626, "post_id": 42102089, "comment_id": 71374595, "body": "You&#39;re giving your buttons all the same name. Try using <code>.Name = &quot;Preparer_&quot; &amp; i</code> and then in the click handler parse out the row number using <code>Split(Application.Caller,&quot;_&quot;)(1)</code>"}, {"owner": {"reputation": 19, "user_id": 6282722, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/78e345dba7d9c4742ee54856ca143f40?s=128&d=identicon&r=PG&f=1", "display_name": "antd", "link": "https://stackoverflow.com/users/6282722/antd"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1486513586, "post_id": 42102089, "comment_id": 71375173, "body": "perfect! thank you Tim!"}], "answers": [{"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 1, "last_activity_date": 1486512515, "creation_date": 1486512515, "answer_id": 42102352, "question_id": 42102089, "link": "https://stackoverflow.com/questions/42102089/excel-vba-add-form-button-to-each-row/42102352#42102352", "title": "excel vba add form button to each row", "body": "<p>You're giving your buttons all the same name. </p>\n\n<p>Try something like:</p>\n\n<pre><code>Sub Button1_Click()\n    Dim btn As Button, t As Range, sht As Worksheet, i As Long\n\n    Set sht = Sheets(FolderName)\n\n    sht.Buttons.Delete\n\n    For i = 5 To sht.Cells(Rows.Count, \"A\").End(xlUp).Row\n        Set t = sht.Cells(i, 10)\n        Set btn = sht.Buttons.Add(t.Left, t.Top, t.Width, t.Height)\n        With btn\n          .OnAction = \"Createbutton\"\n          .Caption = \"Preparer\"\n          .Name = \"Preparer_\" &amp; i\n        End With\n    Next i\nEnd Sub\n\nSub CreateButton()\n\n    Dim RowNumber As Long, sht As Worksheet\n    Dim c As Range\n\n    Set sht = ActiveSheet\n\n    RowNumber = CLng(Split(Application.Caller, \"_\")(1))\n\n    Set c = sht.Cells(RowNumber, \"F\")\n\n    If c.Value = vbNullString Then\n        c.Value = \"User: \" &amp; Application.UserName &amp; vbNewLine &amp; \"Date: \" &amp; Date\n\n        If Date &lt;= ActiveSheet.Cells(RowNumber, \"E\").Value Then\n            c.Font.Color = RGB(1, 125, 33)\n            c.Interior.Color = RGB(0, 255, 127)\n        Else\n            c.Font.Color = vbRed\n            c.Interior.Color = RGB(255, 204, 204)\n        End If\n    Else\n        c.Value = vbNullString\n        c.Interior.ColorIndex = 2\n        c.Font.Color = vbBlack\n    End If\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 19, "user_id": 6282722, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/78e345dba7d9c4742ee54856ca143f40?s=128&d=identicon&r=PG&f=1", "display_name": "antd", "link": "https://stackoverflow.com/users/6282722/antd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5087, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1486512515, "creation_date": 1486510903, "question_id": 42102089, "link": "https://stackoverflow.com/questions/42102089/excel-vba-add-form-button-to-each-row", "title": "excel vba add form button to each row", "body": "<p>I have code to add buttons to each row of a spreadsheet, what I want to have happen is when the button is clicked on a given row certain cells will update on that row. My code adds the buttons to the correct row, and when clicked the buttons update the right columns, but each button in every row is only updating the first row, in this case 5, since that is where I start (with variable i). It seems that the .row function is always returning the top row. Any idea why this is the case?</p>\n\n<pre><code>Sub Button1_Click()\n\nDim btn As Button\nSheets(foldername).Buttons.Delete\nDim t As Range\nFor i = 5 To Sheets(foldername).Cells(Rows.Count, \"A\").End(xlUp).Row\nSet t = Sheets(foldername).Range(Cells(i, 10), Cells(i, 10))\nSet btn = Sheets(foldername).Buttons.Add(t.Left, t.Top, t.Width, t.Height)\nWith btn\n  .OnAction = \"Createbutton\"\n  .Caption = \"Preparer\"\n  .Name = \"Preparer\"\nEnd With\nNext I\nend sub\n\nSub CreateButton()\n\n'code that is used to inject into each button that is created\n\nDim b As Object, cs As Integer, RowNumber As Long\nSet b = ActiveSheet.Buttons(Application.Caller)\nWith b.TopLeftCell\n    cs = .Column\n     RowNumber = .Row\nEnd With\n\nIf ActiveSheet.Cells(RowNumber, \"F\").Value = vbNullString Then\n ActiveSheet.Cells(RowNumber, \"F\").Value = \"User: \" &amp;      \n Application.UserName   &amp; vbNewLine &amp; \"Date: \" &amp; Date\nElse\nActiveSheet.Cells(RowNumber, \"F\").Value = vbNullString\nActiveSheet.Cells(RowNumber, \"F\").Interior.ColorIndex = 2\nActiveSheet.Cells(RowNumber, \"F\").Font.Color = vbBlack\nGoTo skiptoend:\nEnd If\n\nIf Date &lt;= ActiveSheet.Cells(RowNumber, \"E\").Value Then\nActiveSheet.Cells(RowNumber, \"F\").Font.Color = RGB(1, 125, 33)\nActiveSheet.Cells(RowNumber, \"F\").Interior.Color = RGB(0, 255, 127)\nElse\nActiveSheet.Cells(RowNumber, \"F\").Font.Color = vbRed\n ActiveSheet.Cells(RowNumber, \"F\").Interior.Color = RGB(255, 204, 204)\nEnd If\n\nskiptoend:\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["arrays", "vba", "excel"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1486511560, "post_id": 42101949, "comment_id": 71374567, "body": "<a href=\"https://msdn.microsoft.com/en-us/library/office/aa221844.aspx\" rel=\"nofollow noreferrer\">AutoFilter method</a> on <i>44</i> then collect the values from column A (.SpecialCells(XlCellTypeVisible) into dictionary keys and apply another autofilter on the array of keys."}, {"owner": {"reputation": 13, "user_id": 7531615, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/827170078c87664562092e642ee9e9ea?s=128&d=identicon&r=PG&f=1", "display_name": "eosos", "link": "https://stackoverflow.com/users/7531615/eosos"}, "edited": false, "score": 0, "creation_date": 1486512349, "post_id": 42101949, "comment_id": 71374811, "body": "Thanks! Would this be done in a VBA script? Not sure how I would apply an autofilter on an area."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1486516255, "post_id": 42101949, "comment_id": 71375955, "body": "Since you have declined to show original effort, the only question is what you plan to do with the double filtered data once you have it."}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1486515652, "post_id": 42102653, "comment_id": 71375779, "body": "This would fail if there were two &#39;cat&#39; entries with &#39;44&#39;. I find it always best to check if <code>if not dict.exists(cel.Value) then dict(cel.Value) = 0</code> just to be sure. The OP&#39;s sample data was not entirely clear on whether there was a header label to the data which AutoFilter requires. While this is <i>usually</i> true, the sample data was not specific enough to guarantee it."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 1, "creation_date": 1486515955, "post_id": 42102653, "comment_id": 71375864, "body": "Hmmm ... maybe I forgot about overwriting the dict.key&#39;s value. I will have to test to make sure."}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 1, "creation_date": 1486515959, "post_id": 42102653, "comment_id": 71375867, "body": "@Jeeped I tested that case. It wont because the criteria range is the <code>dict.keys</code>, no duplicates there."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 1, "creation_date": 1486516036, "post_id": 42102653, "comment_id": 71375890, "body": "As mentioned earler, I think I forot about the add/overwrite method that you used so eloquently."}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1486516203, "post_id": 42102653, "comment_id": 71375935, "body": "@Jeeped Yeah (we posted simultaneously :) ). On another plan, I wish I could pass the <code>Columns(&quot;A&quot;).SpecialCells(...)</code> directly as criteria to the second <code>.AutoFilter</code>... This would&#39;ve made it much shorter, dropping the dico. Couldn&#39;t find it. Do you see a way?"}, {"owner": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "edited": false, "score": 0, "creation_date": 1486518423, "post_id": 42102653, "comment_id": 71376545, "body": "I don&#39;t think there is any better way for non-contiguous range. I am guessing that the items in the second filter array don&#39;t need to be unique, so maybe another option can be sorting the data and something like <code>.AutoFilter 1, Application.Transpose(Columns(&quot;A&quot;).SpecialCells(xlCellTypeVi&zwnj;&#8203;sible).Areas(2)), xlFilterValues</code>."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1486524896, "post_id": 42102653, "comment_id": 71378136, "body": "@A.S.H - I threw out AutoFilter completely and relied on arrays. See my response. As mentioned, it would be better with a second array to accept the filtered returns and then bulk transfer back to teh worksheet."}, {"owner": {"reputation": 13, "user_id": 7531615, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/827170078c87664562092e642ee9e9ea?s=128&d=identicon&r=PG&f=1", "display_name": "eosos", "link": "https://stackoverflow.com/users/7531615/eosos"}, "edited": false, "score": 0, "creation_date": 1486568565, "post_id": 42102653, "comment_id": 71403331, "body": "Thanks for the help all of you. I was able to use the second reply below to get everything to work. Really appreciate it, will try to add more information in the future."}], "tags": [], "owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "is_accepted": false, "score": 1, "last_activity_date": 1486514761, "last_edit_date": 1486514761, "creation_date": 1486514399, "answer_id": 42102653, "question_id": 42101949, "link": "https://stackoverflow.com/questions/42101949/filter-on-one-column-return-all-related-results-for-a-different-column/42102653#42102653", "title": "Filter on one column, return all related results for a different column", "body": "<p>You can take this routine as a model: it applies to <code>Sheet1</code>, looks for <code>44</code> in column <code>B</code> then shows the rows that match from column <code>A</code></p>\n\n<pre><code>Sub filterBthenA()\n    Sheet1.UsedRange.Columns(\"B\").AutoFilter 1, 44 '&lt;-- Filter Sheet1 col B by value 44\n    Dim cel As Range, dict As Object: Set dict = CreateObject(\"Scripting.Dictionary\")\n    For Each cel In Sheet1.UsedRange.Columns(\"A\").SpecialCells(xlCellTypeVisible)\n        dict(cel.Value) = 0\n    Next\n    Sheet1.AutoFilterMode = False\n    Sheet1.UsedRange.Columns(\"A\").AutoFilter 1, dict.Keys, xlFilterValues\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 1, "last_activity_date": 1506029093, "last_edit_date": 1592644375, "creation_date": 1486524178, "answer_id": 42104094, "question_id": 42101949, "link": "https://stackoverflow.com/questions/42101949/filter-on-one-column-return-all-related-results-for-a-different-column/42104094#42104094", "title": "Filter on one column, return all related results for a different column", "body": "<p>You could avoid the <a href=\"https://msdn.microsoft.com/en-us/library/office/aa221844.aspx\" rel=\"nofollow noreferrer\">AutoFilter method</a> and <a href=\"https://msdn.microsoft.com/en-us/library/office/ff196157.aspx\" rel=\"nofollow noreferrer\">Range.SpecialCells method</a> with one or more variant arrays.</p>\n<pre><code>Option Explicit\n\nSub cats_and_birds()\n    Dim crit As Long\n    Dim i As Long, j As Long, iCols As Long\n    Dim arr1 As Variant\n    Static dict As Object  '&lt;~~ faster second time around this way\n    \n    'create and configure the static dictionary\n    If dict Is Nothing Then _\n        Set dict = CreateObject(&quot;Scripting.Dictionary&quot;)\n    dict.RemoveAll\n    dict.CompareMode = vbTextCompare\n    \n    'number of columns to transfer from column A\n    iCols = 3\n    'set filter criteria for column 2 within range\n    crit = 44\n    \n    With Worksheets(&quot;Sheet1&quot;)\n    \n        'assign raw values\n        arr1 = .Range(.Cells(2, 1), Cells(.Rows.Count, iCols).End(xlUp)).Value2\n        \n        'show the data array limits in the Immediate window\n        'delete this or comment it after the routine works\n        Debug.Print LBound(arr1, 1) &amp; &quot; to &quot; &amp; UBound(arr1, 1)\n        Debug.Print LBound(arr1, 2) &amp; &quot; to &quot; &amp; UBound(arr1, 2)\n        \n        'iterate through the 'rows' of the array and compare column 2\n        For i = LBound(arr1, 1) To UBound(arr1, 1)\n            'add/oversrite the pet species as key\n            If arr1(i, 2) = crit Then _\n                dict(arr1(i, 1)) = 0\n            \n            'if pet species in key, transfer information\n            If dict.exists(arr1(i, 1)) Then\n                'iterate through the columns backwards to maintain row\n                For j = UBound(arr1, 2) To LBound(arr1, 2) Step -1\n                    .Cells(.Rows.Count, &quot;Z&quot;).End(xlUp).Offset(1, j - 1) = arr1(i, j)\n                Next j\n            End If\n        Next i\n    \n    End With\n\nEnd Sub\n</code></pre>\n<p>This would actually be better with two arrays; the second receiving the results and then bulk transferring the information but there is also a (smaller) penalty due to redim'ming the array with preserve (and transposing). For small (&lt;10K) this is probably only marginally longer to process. For &lt;100 rows of filtered information you might not be able to measure the difference without special tools.</p>\n<p><a href=\"https://i.stack.imgur.com/kJnrA.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/kJnrA.png\" alt=\"enter image description here\" /></a></p>\n<p>Dim'ming the dictionary object as Static shortens the load time the second time around because you do not have to recreate the object. While I prefer to add the <strong>Microsoft Scripting Runtime</strong> to the Tools \u25ba References and use <code>dim dict as new scripting.dictionary</code> not everyone prefers that so I'll post this with CreateObject and dim dict as static.</p>\n"}], "owner": {"reputation": 13, "user_id": 7531615, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/827170078c87664562092e642ee9e9ea?s=128&d=identicon&r=PG&f=1", "display_name": "eosos", "link": "https://stackoverflow.com/users/7531615/eosos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 61, "favorite_count": 0, "accepted_answer_id": 42104094, "answer_count": 2, "score": 1, "last_activity_date": 1506029093, "creation_date": 1486510169, "last_edit_date": 1486573163, "question_id": 42101949, "link": "https://stackoverflow.com/questions/42101949/filter-on-one-column-return-all-related-results-for-a-different-column", "title": "Filter on one column, return all related results for a different column", "body": "<p>I've been trying to think of how to do this and can't quite figure it out. The premise is as follows. I need to filter on <strong>COLUMN B</strong>, following that I need to use the filtered returned results of <strong>COLUMN A</strong> to filter all of the results. If that's confusing I tried to 'draw' it out below...</p>\n\n<pre><code>COL A | COL B |\ncat   | 44    |\ncat   | 476   |\ncat   | 19    |\ndog   | 11    |\ndog   | 12    |\nbird  | 44    |\nbird  | 99    |\nbird  | 4556  |\n</code></pre>\n\n<p>So if I filter on Column B for 44 I'll only get the two '44' rows returned (cat | 44 and bird | 44). <strong>Instead</strong>, I want to somehow get all of the cat rows and all of the bird rows, since 44 was associated with those two 'A' types. </p>\n\n<pre><code>COL A | COL B |\ncat   | 44    |\ncat   | 476   |\ncat   | 19    |\nbird  | 44    |\nbird  | 99    |\nbird  | 4556  |\n</code></pre>\n\n<p>Have any of you done this before? My idea was initially to copy the unaltered sheet over to a new sheet 2, apply the filter and copy the returned column A results to a new sheet 3, use the returned column A results in sheet 3 to do an autofilter on the sheet2 column A. However, there can be hundreds of filters and this is a pretty manual process in VBA. </p>\n\n<p>I'd be happy to add more detail if needed.</p>\n"}, {"tags": ["excel", "vba", "validation"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1486509570, "post_id": 42101763, "comment_id": 71373940, "body": "Try removing the <code>()</code> surrounding the formula"}, {"owner": {"reputation": 141, "user_id": 6650282, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/IBivw.jpg?s=128&g=1", "display_name": "SanomaJean", "link": "https://stackoverflow.com/users/6650282/sanomajean"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1486509622, "post_id": 42101763, "comment_id": 71373954, "body": "@BruceWayne I tried both methods, same error :/"}, {"owner": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "edited": false, "score": 0, "creation_date": 1486509958, "post_id": 42101763, "comment_id": 71374059, "body": "delete the previous data validation and totalrange might have to be only one column or row <a href=\"http://stackoverflow.com/questions/22956604/how-to-add-data-validation-to-a-cell-using-vba\" title=\"how to add data validation to a cell using vba\">stackoverflow.com/questions/22956604/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 141, "user_id": 6650282, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/IBivw.jpg?s=128&g=1", "display_name": "SanomaJean", "link": "https://stackoverflow.com/users/6650282/sanomajean"}, "edited": false, "score": 1, "creation_date": 1486510117, "post_id": 42101913, "comment_id": 71374102, "body": "Ahhhh perfect. I didn&#39;t delete. Thank you."}], "tags": [], "owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "is_accepted": true, "score": 4, "last_activity_date": 1486510021, "creation_date": 1486510021, "answer_id": 42101913, "question_id": 42101763, "link": "https://stackoverflow.com/questions/42101763/vba-adding-data-validation-programmatically/42101913#42101913", "title": "VBA Adding Data Validation Programmatically", "body": "<p>You seem to be overwriting the validation. If it already exists, overwriting leads to runtime error. Try:</p>\n\n<pre><code>With .Validation\n    .Delete  \n    .Add ...\n</code></pre>\n"}], "owner": {"reputation": 141, "user_id": 6650282, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/IBivw.jpg?s=128&g=1", "display_name": "SanomaJean", "link": "https://stackoverflow.com/users/6650282/sanomajean"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1161, "favorite_count": 0, "accepted_answer_id": 42101913, "answer_count": 1, "score": 0, "last_activity_date": 1486510164, "creation_date": 1486509171, "last_edit_date": 1486510164, "question_id": 42101763, "link": "https://stackoverflow.com/questions/42101763/vba-adding-data-validation-programmatically", "title": "VBA Adding Data Validation Programmatically", "body": "<p>I've looked online for an hour and can't find any solution that has worked for me. \nI have a range of cells which I want to apply data validation to each cell in that range based on another range. I am not sure if I need a For Each loop or if I can just assign the validation to the whole list at one time. Here is what I have so far: </p>\n\n<pre><code>With Range(rngMonthStart, rngMonthEnd)\n    With .Validation\n         .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Formula1:= (\"='Settings'!\" &amp; totalrange.Address)\n    End With\nEnd With\n</code></pre>\n\n<p>When it gets to the .Add line I get an Application Defined Error. Any help is super appreciated</p>\n"}, {"tags": ["vba", "excel", "xlsb"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 3, "creation_date": 1486508985, "post_id": 42101648, "comment_id": 71373750, "body": "You should always qualify sheet references with a workbook object - don&#39;t rely on the ActiveWorkbook being what you think it ought to be.    <a href=\"https://stackoverflow.com/questions/28439376/what-is-the-default-scope-of-worksheets-and-cells-and-range/28439984#28439984\" title=\"what is the default scope of worksheets and cells and range\">stackoverflow.com/questions/28439376/&hellip;</a>  If that&#39;s not the issue then you need to be more specific about exactly where the error occurs."}, {"owner": {"reputation": 552, "user_id": 2381028, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/1855097c6c29ed8c62fc4c78bccd967e?s=128&d=identicon&r=PG", "display_name": "Shmukko", "link": "https://stackoverflow.com/users/2381028/shmukko"}, "edited": false, "score": 0, "creation_date": 1486509088, "post_id": 42101648, "comment_id": 71373776, "body": "Do all the other workbooks have sheet with the correct name MPSA ?"}, {"owner": {"reputation": 23, "user_id": 7347948, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10c333e2b83176c8bdb313c1072bbf72?s=128&d=identicon&r=PG&f=1", "display_name": "Ashwendra", "link": "https://stackoverflow.com/users/7347948/ashwendra"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1486509790, "post_id": 42101648, "comment_id": 71374005, "body": "@TimWilliams I tried that, I don&#39;t know the issue, normally code works fine."}, {"owner": {"reputation": 23, "user_id": 7347948, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10c333e2b83176c8bdb313c1072bbf72?s=128&d=identicon&r=PG&f=1", "display_name": "Ashwendra", "link": "https://stackoverflow.com/users/7347948/ashwendra"}, "reply_to_user": {"reputation": 552, "user_id": 2381028, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/1855097c6c29ed8c62fc4c78bccd967e?s=128&d=identicon&r=PG", "display_name": "Shmukko", "link": "https://stackoverflow.com/users/2381028/shmukko"}, "edited": false, "score": 0, "creation_date": 1486509820, "post_id": 42101648, "comment_id": 71374017, "body": "@Shmukko yes all workbooks will have MPSA sheet"}, {"owner": {"reputation": 552, "user_id": 2381028, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/1855097c6c29ed8c62fc4c78bccd967e?s=128&d=identicon&r=PG", "display_name": "Shmukko", "link": "https://stackoverflow.com/users/2381028/shmukko"}, "edited": false, "score": 0, "creation_date": 1486510103, "post_id": 42101648, "comment_id": 71374098, "body": "OK. have you tried debugging it? where does the error occur?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1486510738, "post_id": 42101648, "comment_id": 71374298, "body": "I see unqualified worksheet references in your posted code - can you update to the version you tried with fully-qualified references?  And again <b>where is the error occuring</b> ?"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1486517275, "post_id": 42101648, "comment_id": 71376252, "body": "FWIW (nothing to do with your problem) an <code>Exit Sub</code> (or anything else) immediately after a <code>GoTo</code> statement will not do anything - the <code>GoTo</code> has moved the code execution pointer somewhere else."}, {"owner": {"reputation": 23, "user_id": 7347948, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10c333e2b83176c8bdb313c1072bbf72?s=128&d=identicon&r=PG&f=1", "display_name": "Ashwendra", "link": "https://stackoverflow.com/users/7347948/ashwendra"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1486535860, "post_id": 42101648, "comment_id": 71381697, "body": "@TimWilliams how will I do that?"}, {"owner": {"reputation": 23, "user_id": 7347948, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10c333e2b83176c8bdb313c1072bbf72?s=128&d=identicon&r=PG&f=1", "display_name": "Ashwendra", "link": "https://stackoverflow.com/users/7347948/ashwendra"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1486536274, "post_id": 42101648, "comment_id": 71381885, "body": "@YowE3K I tried removing <code>GoTo</code> and pasted <code>Saveas</code> line, The problem is same."}, {"owner": {"reputation": 23, "user_id": 7347948, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10c333e2b83176c8bdb313c1072bbf72?s=128&d=identicon&r=PG&f=1", "display_name": "Ashwendra", "link": "https://stackoverflow.com/users/7347948/ashwendra"}, "edited": false, "score": 0, "creation_date": 1486537314, "post_id": 42101648, "comment_id": 71382388, "body": "I believe this line <code>ThisWorkbook</code> in has a problem, I need to use this code with all the new different sheets everytime. <code>Target_Workbook.Sheets(1).Range(&quot;A1&quot;).CurrentRegion.Offset(1&zwnj;&#8203;).Copy  ThisWorkbook.Sheets(&quot;MPSA&quot;).Range(&quot;a1000000&quot;).End(xlUp).Offs&zwnj;&#8203;et(1)</code>     <code>Target_Workbook.Close False</code>"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1486537484, "post_id": 42101648, "comment_id": 71382473, "body": "Comment out the line <code>On Error GoTo Cleanup</code> - which line is highlighted when your code errors?"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1486542487, "post_id": 42101648, "comment_id": 71385054, "body": "The comment I made has nothing to do with your problem - I was just pointing out that the <code>Exit Sub</code> statements directly after a <code>GoTo</code> statement will never get executed - they can be deleted."}, {"owner": {"reputation": 23, "user_id": 7347948, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10c333e2b83176c8bdb313c1072bbf72?s=128&d=identicon&r=PG&f=1", "display_name": "Ashwendra", "link": "https://stackoverflow.com/users/7347948/ashwendra"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1486556051, "post_id": 42101648, "comment_id": 71394265, "body": "@TimWilliams I cannot see it because the code gives error only as an ADD-IN."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1486569229, "post_id": 42101648, "comment_id": 71403836, "body": "You can still debug an addin the same way you would for a regular workbook.  The code is still viewable in the VBE"}, {"owner": {"reputation": 23, "user_id": 7347948, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10c333e2b83176c8bdb313c1072bbf72?s=128&d=identicon&r=PG&f=1", "display_name": "Ashwendra", "link": "https://stackoverflow.com/users/7347948/ashwendra"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1486586515, "post_id": 42101648, "comment_id": 71414460, "body": "Hi @TimWilliams, I followed your instructions and got to know that there is a problem with <code>Target_Workbook.Sheets(1).Range(&quot;A1&quot;).CurrentRegion.Offset(1&zwnj;&#8203;).Copy ThisWorkbook.Sheets(&quot;MPSA&quot;).Range(&quot;a1000000&quot;).End(xlUp).Offs&zwnj;&#8203;et(1)</code>"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1486587986, "post_id": 42101648, "comment_id": 71415290, "body": "Does your add-in have a sheet named &quot;MPSA&quot; ?"}, {"owner": {"reputation": 23, "user_id": 7347948, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10c333e2b83176c8bdb313c1072bbf72?s=128&d=identicon&r=PG&f=1", "display_name": "Ashwendra", "link": "https://stackoverflow.com/users/7347948/ashwendra"}, "edited": false, "score": 0, "creation_date": 1486588834, "post_id": 42101648, "comment_id": 71415764, "body": "Yes, a code will first adds a <code>sheet(&quot;MPSA&quot;)</code> and then will call this above code."}, {"owner": {"reputation": 23, "user_id": 7347948, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10c333e2b83176c8bdb313c1072bbf72?s=128&d=identicon&r=PG&f=1", "display_name": "Ashwendra", "link": "https://stackoverflow.com/users/7347948/ashwendra"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1486736678, "post_id": 42101648, "comment_id": 71488261, "body": "@TimWilliams can u help ?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1486742909, "post_id": 42101648, "comment_id": 71492451, "body": "You&#39;re adding a sheet &quot;MPSA&quot; to your add-in, or to some other workbook?  ThisWorkbook is the file which contains the code which is running, so in your case that&#39;s your add-in."}, {"owner": {"reputation": 23, "user_id": 7347948, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10c333e2b83176c8bdb313c1072bbf72?s=128&d=identicon&r=PG&f=1", "display_name": "Ashwendra", "link": "https://stackoverflow.com/users/7347948/ashwendra"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1486906675, "post_id": 42101648, "comment_id": 71538371, "body": "@TimWilliams Oh man, I was wondering if that could be the problem, I need to add <code>MPSA</code> to the workbook for which I&#39;ll run add-in. Now, should I use <code>Activeworkbook</code> in place of <code>Thisworkbook</code> ?"}], "answers": [{"tags": [], "owner": {"reputation": 23, "user_id": 7347948, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10c333e2b83176c8bdb313c1072bbf72?s=128&d=identicon&r=PG&f=1", "display_name": "Ashwendra", "link": "https://stackoverflow.com/users/7347948/ashwendra"}, "is_accepted": true, "score": 0, "last_activity_date": 1486911989, "creation_date": 1486911989, "answer_id": 42189183, "question_id": 42101648, "link": "https://stackoverflow.com/questions/42101648/code-not-working-as-add-in-or-personal-xlsb-the-same-code-works-fine-in-workb/42189183#42189183", "title": "Code not working as `Add-In or Personal XLSB` [The same code works fine in workbook where it was created]", "body": "<p>The problem is solved now. As suggested by @Tom, Add-In was confused about which worksheet to paste values in.</p>\n\n<p>Well I defined another variable using <code>Dim Source_Workbook as Workbook</code> <code>Set Source_Workbook as ActiveWorkbook</code></p>\n\n<p>Thanks to all of you :)</p>\n"}], "owner": {"reputation": 23, "user_id": 7347948, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10c333e2b83176c8bdb313c1072bbf72?s=128&d=identicon&r=PG&f=1", "display_name": "Ashwendra", "link": "https://stackoverflow.com/users/7347948/ashwendra"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 112, "favorite_count": 0, "accepted_answer_id": 42189183, "answer_count": 1, "score": 0, "last_activity_date": 1486911989, "creation_date": 1486508558, "last_edit_date": 1486519990, "question_id": 42101648, "link": "https://stackoverflow.com/questions/42101648/code-not-working-as-add-in-or-personal-xlsb-the-same-code-works-fine-in-workb", "title": "Code not working as `Add-In or Personal XLSB` [The same code works fine in workbook where it was created]", "body": "<p>Below code is working fine and doing what I want to do. But when I use it as <code>Add-In</code> to run on all other workbooks it says <code>subscript out of range</code>.</p>\n\n<p>There may be object related confusion or the add-in gets confused which workbook to refer.</p>\n\n<p>I'm new to vba and request all of you to help.</p>\n\n<pre><code> Sub mac_3()\n Dim xlsname As String\n\n\nDim d As VbMsgBoxResult: d = MsgBox(\"Would you like to add record?\" &amp; vbNewLine &amp; vbNewLine &amp; \"(Esc/Cancel to add something.)\", vbYesNoCancel + vbQuestion, \"Details!\")\nIf d = vbNo Then\n    Sheets(\"MPSA\").Range(\"a13\").Value = \"Record is not available.\"\n    Sheets(\"MPSA\").Range(\"a13\").Font.Bold = True\n    ActiveWorkbook.Save\n    GoTo savefile\n    Exit Sub\nEnd If\nIf d = vbCancel Then\n    Dim myValue As Variant\n    myValue = Application.InputBox(\"Non-Transactional number!\", \"Please paste number[separate with comma ,]:\")\n    If myValue = False Then\n    Exit Sub\n    Else\n    Sheets(\"MPSA\").Range(\"a13\").Value = \"Dataot available for : \" &amp; myValue\n    Sheets(\"MPSA\").Range(\"a13\").Font.Bold = True\n    ActiveWorkbook.Save\n    GoTo savefile\n    Exit Sub\n    End If\nEnd If\n\nOn Error GoTo Cleanup\nApplication.DisplayAlerts = False: Application.EnableEvents = False: Application.ScreenUpdating = False\n\nSheets(\"MPSA\").Range(\"a14:ac14\").Value = Array( _\n\"ACCOUNT NAME\", \" ACCOUNT NUMBER\", \"AGE\", \"ENTITY NAME\", \"GROUP\", _\n\"ITEM NUMBER\", \"ITEM NAME\", \"COMPONENT\", \"QUANTITY\", \"SUBSCRIPTIONS\", _\n\"QUANTITY\", \"QUANTITY\", \"NUMBER\", \"ITEM NAME\", _\n\"PART NUMBER\", \"PART NAME\", \"EDITION\", \"TYPE\", \"VERSION\", \"USAGE\", _\n\"LIMIT\", \"NAME\", \"TART DATE\", \"END DATE\", \"ASSET STATUS\", _\n\"CATEGORY\", \"ACCOUNT TYPE\", \"METHOD\", \"CENTER\")\n\nSheets(\"MPSA\").Range(\"a14:ac14\").Font.Name = \"Calibri\"\nSheets(\"MPSA\").Range(\"a14:ac14\").Interior.ColorIndex = 24\nSheets(\"MPSA\").Range(\"a14:ac14\").Font.Bold = True\nSheets(\"MPSA\").Range(\"a14:ac14\").Borders.LineStyle = xlContinuous\nSheets(\"MPSA\").Columns.AutoFit\n\n\nDim Target_Path: Target_Path = Application.GetOpenFilename\n\nDo While Target_Path &lt;&gt; False ' &lt;-- loop until user cancels\n    Dim Target_Workbook As Workbook: Set Target_Workbook = Workbooks.Open(Target_Path)\n\n    Target_Workbook.Sheets(1).Cells.WrapText = True\n    Target_Workbook.Sheets(1).Cells.WrapText = False\n\n    Target_Workbook.Sheets(1).Range(\"A1\").CurrentRegion.Offset(1).Copy _\n        ThisWorkbook.Sheets(\"MPSA\").Range(\"a1000000\").End(xlUp).Offset(1)\n    Target_Workbook.Close False\n\n    ActiveWorkbook.Save\nDim e As VbMsgBoxResult: e = MsgBox(\"Another Record?\", vbYesNo + vbQuestion, \"Next details!\")\n    If e = vbNo Then\n    ThisWorkbook.Save\n    GoTo savefile\n    Exit Sub\n    End If\n    'If e = vbYes Then\n\n Target_Path = Application.GetOpenFilename    \n Loop    \n GoTo savefile\n\n savefile:\n Application.DisplayAlerts = False    \n xlsname = Left(ActiveWorkbook.Name, Len(ActiveWorkbook.Name) - 5)ActiveWorkbook.SaveAs Filename:=\"C:\\Users\\\" &amp; Environ$(\"username\") &amp; \"\\Desktop\\New Folder\\\" &amp; xlsname &amp; \".xlsx\", FileFormat:=xlOpenXMLWorkbook, CreateBackup:=False\n\n Cleanup:\nIf Err.Number &lt;&gt; 0 Then MsgBox \"Something went wrong: \" &amp; vbCrLf &amp; Err.Description\nApplication.DisplayAlerts = True: Application.EnableEvents = True: Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 3124, "user_id": 5175942, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MiN2o.jpg?s=128&g=1", "display_name": "MacroMarc", "link": "https://stackoverflow.com/users/5175942/macromarc"}, "edited": false, "score": 0, "creation_date": 1486512476, "post_id": 42101634, "comment_id": 71374846, "body": "You found a range which matched with the <code>set rng =....</code> Use that variable rng again somewhere?! Like <code>Dim foundRangeRow as long....foundRangeRow=rng.Row...</code> etc"}], "answers": [{"comments": [{"owner": {"reputation": 2953, "user_id": 2801253, "user_type": "registered", "profile_image": "https://graph.facebook.com/1332362525/picture?type=large", "display_name": "Mark Fitzgerald", "link": "https://stackoverflow.com/users/2801253/mark-fitzgerald"}, "edited": false, "score": 0, "creation_date": 1486630706, "post_id": 42101696, "comment_id": 71431058, "body": "How does this answer the OP?  He is &quot;having trouble getting the code to check volumes if the Customer &amp; SKU match&quot; and &quot;wants to know where have I gone wrong and what is the proper implementation?&quot;    He doesn&#39;t use myString or myFloat.  Excel VBA doesn&#39;t even have a Float data type!"}], "tags": [], "owner": {"reputation": 11755, "user_id": 4797603, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/AwTvE.jpg?s=128&g=1", "display_name": "Ronnie Royston", "link": "https://stackoverflow.com/users/4797603/ronnie-royston"}, "is_accepted": false, "score": -3, "last_activity_date": 1486508789, "creation_date": 1486508789, "answer_id": 42101696, "question_id": 42101634, "link": "https://stackoverflow.com/questions/42101634/vba-and-passing-values/42101696#42101696", "title": "VBA and passing values", "body": "<p>Variables.  ...If I understand your questions correctly.</p>\n\n<p><code>dim myString as String</code>\n<code>dim myFloat as Float</code></p>\n"}, {"tags": [], "owner": {"reputation": 79, "user_id": 9981147, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ebb8a4a3579bf6f57592393f4ffce436?s=128&d=identicon&r=PG&f=1", "display_name": "Brendan.H", "link": "https://stackoverflow.com/users/9981147/brendan-h"}, "is_accepted": false, "score": 0, "last_activity_date": 1529824043, "creation_date": 1529824043, "answer_id": 51007692, "question_id": 42101634, "link": "https://stackoverflow.com/questions/42101634/vba-and-passing-values/51007692#51007692", "title": "VBA and passing values", "body": "<p>I think you need to reuse rng like this:</p>\n\n<pre><code>rng.offset(2,0).value\n</code></pre>\n\n<p>in place of:</p>\n\n<pre><code>Sheets(\"sheet2\").Cells(i, 2).Value\n</code></pre>\n\n<p>Because all your currently doing is assuming that the matching cell is in exactly the same row as in sheet1.</p>\n\n<p>Your code should then look something like this:</p>\n\n<pre><code>Sub Again()\n\nDim lastRow As Integer\nDim rng As Range\nlastRow = Sheets(\"Sheet1\").Range(\"A65000\").End(xlUp).Row\n\nFor i = 1 To lastRow\n    Set rng = Sheets(\"sheet2\").Range(\"A:A\").Find(Sheets(\"Sheet1\").Cells(i, 1))\n    If rng Is Nothing Then\n        Sheets(\"Sheet1\").Cells(i, 3) = \"Item not in sheet2\"\n        Sheets(\"Sheet1\").Cells(i, 1).EntireRow.Interior.Color = vbRed\n    ElseIf Not rng Is Nothing Then\n        If Sheets(\"sheet1\").Cells(i, 2).Value - rng.offset(0, 2).Value &lt; -5 Then\n            Sheets(\"sheet1\").Cells(i, 3) = \"Sheet2 reports \" &amp; Sheets(\"sheet1\").Cells(i, 2).Value - rng.offset(0, 2).Value &amp; \" more units of volume.\"\n        ElseIf Sheets(\"sheet1\").Cells(i, 2) - rng.offset(0, 2).Value &gt; 5 Then\n            Sheets(\"sheet1\").Cells(i, 3) = \"Sheet1 reports \" &amp; Sheets(\"sheet1\").Cells(i, 2) - rng.offset(0, 2).Value &amp; \" more units of volume.\"\n        Else: Sheets(\"sheet1\").Cells(i, 3) = \"No or insignificant discrepancy\"\n        End If\n    End If\nNext\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 7508382, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Yd1Lq1s_6aU/AAAAAAAAAAI/AAAAAAAAAJQ/os9SVkelTR0/photo.jpg?sz=128", "display_name": "David Romero", "link": "https://stackoverflow.com/users/7508382/david-romero"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 76, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1529824043, "creation_date": 1486508457, "last_edit_date": 1531161705, "question_id": 42101634, "link": "https://stackoverflow.com/questions/42101634/vba-and-passing-values", "title": "VBA and passing values", "body": "<p>I'm trying to compare data between two worksheets. Each Worksheet has three column: A is a concatenation of a Customer and a SKU, B is the sales volume and C is for measuring volume discrepancies. I aim to do two things, check Sheet1 for SKUs that are not in Sheet2 and then, if SKUs match on both sheets, check their volume for quantity differences. If Sheet 1 has a SKU not in Sheet2, I want the record highlighted. I've accomplished this in a primitive way, the entire row gets highlighted. I am, however, having trouble getting the code to check volumes if the Customer &amp; SKU match. I was hoping VBA would retain the values of the cells it was checking, where have I gone wrong and what is the proper implementation? Sorry for being such a n00b. </p>\n\n<p>Sub Again()</p>\n\n<pre><code>Dim lastRow As Integer\nDim rng As Range\nlastRow = Sheets(\"Sheet1\").Range(\"A65000\").End(xlUp).Row\n\nFor i = 1 To lastRow\n    Set rng = Sheets(\"sheet2\").Range(\"A:A\").Find(Sheets(\"Sheet1\").Cells(i, 1))\n    If rng Is Nothing Then\n        Sheets(\"Sheet1\").Cells(i, 3) = \"Item not in sheet2\"\n        Sheets(\"Sheet1\").Cells(i, 1).EntireRow.Interior.Color = vbRed\n    ElseIf Not rng Is Nothing Then\n        If Sheets(\"sheet1\").Cells(i, 2).Value - Sheets(\"sheet2\").Cells(i, 2).Value &lt; -5 Then\n            Sheets(\"sheet1\").Cells(i, 3) = \"Sheet2 reports \" &amp; Sheets(\"sheet1\").Cells(i, 2).Value - Sheets(\"sheet2\").Cells(i, 2).Value &amp; \" more units of volume.\"\n        ElseIf Sheets(\"sheet1\").Cells(i, 2) - Sheets(\"sheet2\").Cells(i, 2) &gt; 5 Then\n            Sheets(\"sheet1\").Cells(i, 3) = \"Sheet1 reports \" &amp; Sheets(\"sheet1\").Cells(i, 2) - Sheets(\"sheet2\").Cells(i, 2) &amp; \" more units of volume.\"\n        Else: Sheets(\"sheet1\").Cells(i, 3) = \"No or insignificant discrepancy\"\n        End If\n    End If\nNext\n</code></pre>\n\n<p>End Sub</p>\n"}, {"tags": ["regex", "excel", "vba"], "comments": [{"owner": {"reputation": 552, "user_id": 2381028, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/1855097c6c29ed8c62fc4c78bccd967e?s=128&d=identicon&r=PG", "display_name": "Shmukko", "link": "https://stackoverflow.com/users/2381028/shmukko"}, "edited": false, "score": 0, "creation_date": 1486509449, "post_id": 42101561, "comment_id": 71373889, "body": "Yes It&#39;s possible to do that with VBA and I think also with basic excel functionallity. In table 1 which month is displayed? the last paid month of the  customer?"}, {"owner": {"reputation": 35, "user_id": 3070028, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95c0106074117b074bdcc773802e3afa?s=128&d=identicon&r=PG&f=1", "display_name": "user3070028", "link": "https://stackoverflow.com/users/3070028/user3070028"}, "reply_to_user": {"reputation": 552, "user_id": 2381028, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/1855097c6c29ed8c62fc4c78bccd967e?s=128&d=identicon&r=PG", "display_name": "Shmukko", "link": "https://stackoverflow.com/users/2381028/shmukko"}, "edited": false, "score": 0, "creation_date": 1486512081, "post_id": 42101561, "comment_id": 71374721, "body": "yes. The last paid month."}], "owner": {"reputation": 35, "user_id": 3070028, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95c0106074117b074bdcc773802e3afa?s=128&d=identicon&r=PG&f=1", "display_name": "user3070028", "link": "https://stackoverflow.com/users/3070028/user3070028"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 30, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1486508089, "creation_date": 1486508089, "question_id": 42101561, "link": "https://stackoverflow.com/questions/42101561/search-for-string-in-one-sheet-and-update-cell-in-another-sheet", "title": "Search for string in one sheet and update cell in another sheet", "body": "<p>My excel workbook has a \"Main\" tab/sheet which looks like this </p>\n\n<h2>Name   | Last-Payment | Ontime/Late |</h2>\n\n<h2>Andy   | December     |  Late       |</h2>\n\n<h2>Dick    | January      |  On-time   |</h2>\n\n<h2>Nathan  | February     |   Late     |</h2>\n\n<h2>Jimmy   | September    |   Late     |</h2>\n\n<p>And each Name has a separate Sheet/Tab with a table:</p>\n\n<h2>Month  |  Paid</h2>\n\n<h2>December | Yes</h2>\n\n<h2>Jan      | Yes</h2>\n\n<h2>Feb      | No</h2>\n\n<h2>Mar      | No</h2>\n\n<p>When a person makes a payment for a certain month, the \"Paid\" column is updated with a \"Yes\"</p>\n\n<p>I am looking for a way to update the main sheet for the appropriate person when the paid month for that person is updated.\nFor example:\nWhen Andy makes a payment for the month of January,the appropriate month  for Andy is entered as \"Yes\". Now, this column is read and I would look for the recent paid month and the month is compared with the current month and the Late/On-time column in the main sheet is updated.</p>\n\n<p>I would like to know if writing a VBA script would accomplish this or some kind of Lookup (Vlookup, hlookup etc) would.</p>\n\n<p>I am not looking for any code.\nSuggestions on how I should approach the problem is highly appreciated.</p>\n\n<p>Sincere apologies for the table format.</p>\n\n<p>Thank you</p>\n"}]