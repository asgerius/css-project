[{"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 183, "user_id": 5678552, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-jnxw7OpW0jU/AAAAAAAAAAI/AAAAAAAAABU/0V81DiP0m7Y/photo.jpg?sz=128", "display_name": "Clyde", "link": "https://stackoverflow.com/users/5678552/clyde"}, "edited": false, "score": 0, "creation_date": 1489622073, "post_id": 42822794, "comment_id": 72757340, "body": "you could try using ws.usedrange.rows.count  that&#39;s the same thing as ctrl+end"}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 1, "creation_date": 1489652365, "post_id": 42822794, "comment_id": 72767275, "body": "you may want to add some screenshots of some &quot;before&quot; and &quot;after&quot; scenarios"}], "answers": [{"comments": [{"owner": {"reputation": 93, "user_id": 7631256, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/890fd24830afe3b9dac9e03b4bfcb529?s=128&d=identicon&r=PG&f=1", "display_name": "Sid.  T.", "link": "https://stackoverflow.com/users/7631256/sid-t"}, "edited": false, "score": 0, "creation_date": 1489676548, "post_id": 42834559, "comment_id": 72784445, "body": "sorry but that code didn&#39;t work. It still replaced my initial entry."}], "tags": [], "owner": {"reputation": 46, "user_id": 7720925, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d1b8028aea50eb2c9db533fb0f349d3e?s=128&d=identicon&r=PG&f=1", "display_name": "Jerry Lundgren", "link": "https://stackoverflow.com/users/7720925/jerry-lundgren"}, "is_accepted": false, "score": 0, "last_activity_date": 1489696127, "last_edit_date": 1489696127, "creation_date": 1489668477, "answer_id": 42834559, "question_id": 42822794, "link": "https://stackoverflow.com/questions/42822794/find-last-row-in-a-group-of-columns/42834559#42834559", "title": "Find Last Row In A Group Of Columns", "body": "<p>Add these two dim statements.</p>\n\n<pre><code>Dim ColumnCount As Integer\nDim x As Long \n</code></pre>\n\n<p>Change your code:</p>\n\n<pre><code>Lastrow = ws.Range(\"i101\").End(xlUp).Row\n</code></pre>\n\n<p>to:</p>\n\n<pre><code>Lastrow = 0\n\nFor ColumnCount = 0 To 10\n    x = ws.Range(\"I101\").Offset(0, ColumnCount).End(xlUp).Row\n    If x &gt; Lastrow Then Lastrow = x\nNext ColumnCount\n</code></pre>\n\n<p>edit:\nThis for loop always start on 16. Is it maybe supposed to start on Lastrow+1?</p>\n\n<pre><code>For iRow = 16 To Lastrow\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 93, "user_id": 7631256, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/890fd24830afe3b9dac9e03b4bfcb529?s=128&d=identicon&r=PG&f=1", "display_name": "Sid.  T.", "link": "https://stackoverflow.com/users/7631256/sid-t"}, "edited": false, "score": 0, "creation_date": 1489703283, "post_id": 42844315, "comment_id": 72800289, "body": "@ Jerry Lundgren I don&#39;t think its lastrow+1. I&#39;ve tried it and it entered the data twice."}, {"owner": {"reputation": 93, "user_id": 7631256, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/890fd24830afe3b9dac9e03b4bfcb529?s=128&d=identicon&r=PG&f=1", "display_name": "Sid.  T.", "link": "https://stackoverflow.com/users/7631256/sid-t"}, "edited": false, "score": 0, "creation_date": 1489703315, "post_id": 42844315, "comment_id": 72800302, "body": "please see my original post with the pictures. This was me changing the code to    Lastrow = ws.Range(&quot;I:S&quot;).Find(&quot;*&quot;, , , , xlByRows, xlPrevious).row"}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "reply_to_user": {"reputation": 93, "user_id": 7631256, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/890fd24830afe3b9dac9e03b4bfcb529?s=128&d=identicon&r=PG&f=1", "display_name": "Sid.  T.", "link": "https://stackoverflow.com/users/7631256/sid-t"}, "edited": false, "score": 0, "creation_date": 1489705257, "post_id": 42844315, "comment_id": 72800956, "body": "@Sid.T. there are two places where you write the line in your code, one inside the loop, and another bloc at the end. I can&#39;t figure out why you do that."}, {"owner": {"reputation": 93, "user_id": 7631256, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/890fd24830afe3b9dac9e03b4bfcb529?s=128&d=identicon&r=PG&f=1", "display_name": "Sid.  T.", "link": "https://stackoverflow.com/users/7631256/sid-t"}, "edited": false, "score": 0, "creation_date": 1489771973, "post_id": 42844315, "comment_id": 72833681, "body": "i&#39;m not sure why either lol. It was part of a code I&#39;ve copied and just kept it that way..I will eliminate it if it doesn&#39;t do anything. EDIT- deleted the code and it doesn&#39;t compute to my worksheet so I guess I need it."}], "tags": [], "owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "is_accepted": false, "score": 0, "last_activity_date": 1489697865, "last_edit_date": 1489697865, "creation_date": 1489696599, "answer_id": 42844315, "question_id": 42822794, "link": "https://stackoverflow.com/questions/42822794/find-last-row-in-a-group-of-columns/42844315#42844315", "title": "Find Last Row In A Group Of Columns", "body": "<p>The following gets you the last non-empty row considering all columns:</p>\n\n<pre><code>Lastrow = ws.UsedRange.Find(\"*\", , , , xlByRows, xlPrevious).Row\n</code></pre>\n\n<p>You can also restrict it to a set of columns, by replacing <code>.UsedRange</code> to the specific columns range, i.e. the following gets you the last non-empty row in columns <code>G</code> to <code>AB</code>:</p>\n\n<pre><code>Lastrow = ws.Range(\"G:AB\").Find(\"*\", , , , xlByRows, xlPrevious).Row\n</code></pre>\n"}], "owner": {"reputation": 93, "user_id": 7631256, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/890fd24830afe3b9dac9e03b4bfcb529?s=128&d=identicon&r=PG&f=1", "display_name": "Sid.  T.", "link": "https://stackoverflow.com/users/7631256/sid-t"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1381, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1489703583, "creation_date": 1489621362, "last_edit_date": 1531164843, "question_id": 42822794, "link": "https://stackoverflow.com/questions/42822794/find-last-row-in-a-group-of-columns", "title": "Find Last Row In A Group Of Columns", "body": "<p>I have a userform that enters data into columns I to S but sometimes all data points does not need to be entered. My probably is I only have the last row counting up on column I so if I have data in J through S, they would get replaced with the next set of data that has data in column I. </p>\n\n<p>What I need help is coding for the last row of all columns or the next blank row of all columns. Thanks.</p>\n\n<p>My code:</p>\n\n<pre><code> Private Sub cmd_EnterData_Click()\n\n Dim iRow As Long\n Dim Lastrow As Long\n Dim ws As Worksheet\n Set ws = Worksheets(\"FirstShift\")\n\n Lastrow = ws.Range(\"i101\").End(xlUp).Row\n 'find first empty row in database\n For iRow = 16 To Lastrow\n  If ws.Cells(iRow, 9) = \"\" And ws.Cells(iRow, 10) = \"\" Then\n    ws.Cells(iRow, 9).Value = Me.textbox_Lane1.Value\n    ws.Cells(iRow, 10).Value = Me.textbox_Lane2.Value\n    ws.Cells(iRow, 11).Value = Me.textbox_Lane3.Value\n    ws.Cells(iRow, 12).Value = Me.textbox_Lane4.Value\n    ws.Cells(iRow, 13).Value = Me.textbox_Lane5.Value\n    ws.Cells(iRow, 14).Value = Me.textbox_Lane6.Value\n    ws.Cells(iRow, 15).Value = Me.textbox_Lane7.Value\n    ws.Cells(iRow, 16).Value = Me.textbox_Length.Value\n    ws.Cells(iRow, 17).Value = Me.textbox_SheetCount.Value\n    ws.Cells(iRow, 18).Value = Me.cbchecktype.Value\n    ws.Cells(iRow, 19).Value = Me.cbchecktype1.Value\n  End If\n Next iRow\n\n\n If checkbox_Retest.Value = False And Me.textbox_Lane1.Value = \"\" Then\n 'do nothing\n Me.textbox_Lane1.SetFocus\n MsgBox \"ENTER LANE 1 WIDTH!\"\n Exit Sub\n End If\n\n If checkbox_Retest.Value = False And Me.textbox_Length.Value = \"\" Then\n 'do nothing\n Me.textbox_Length.SetFocus\n MsgBox \"ENTER YOUR LENGTH!\"\n Exit Sub\n End If\n\n If checkbox_Retest.Value = False And Me.textbox_SheetCount.Value = \"\" Then\n 'do nothing\n Me.textbox_SheetCount.SetFocus\n MsgBox \"ENTER THE SHEETCOUNT!\"\n Exit Sub\n End If\n\n If checkbox_Retest.Value = False And Me.cbchecktype.Value = \"\" Then\n 'do nothing\n Me.cbchecktype.SetFocus\n MsgBox \"ENTER 'PASS' OR 'FAIL' FOR PERF CHECK!!\"\n Exit Sub\n Select Case checktype\n    Case Trim(Me.cbchecktype.Value) = \"PASS\"\n    checktype = \"PASS\"\n\n    Case Trim(Me.cbchecktype.Value) = \"FAIL\"\n    checktype = \"FAIL\"\n End Select\n End If\n\n If checkbox_Retest.Value = False And Me.cbchecktype1.Value = \"\" Then\n 'do nothing\n Me.cbchecktype1.SetFocus\n MsgBox \"ENTER 'PASS' OR 'FAIL' FOR SLITHER CHECK!!\"\n Exit Sub\n Select Case checktype1\n    Case Trim(Me.cbchecktype1.Value) = \"PASS\"\n    checktype1 = \"PASS\"\n\n    Case Trim(Me.cbchecktype1.Value) = \"FAIL\"\n    checktype1 = \"FAIL\"\n End Select\n End If\n\n With ws\n.Unprotect Password:=\"password\"\n.Cells(iRow, 9).Value = Me.textbox_Lane1.Value\n.Cells(iRow, 10).Value = Me.textbox_Lane2.Value\n.Cells(iRow, 11).Value = Me.textbox_Lane3.Value\n.Cells(iRow, 12).Value = Me.textbox_Lane4.Value\n.Cells(iRow, 13).Value = Me.textbox_Lane5.Value\n.Cells(iRow, 14).Value = Me.textbox_Lane6.Value\n.Cells(iRow, 15).Value = Me.textbox_Lane7.Value\n.Cells(iRow, 16).Value = Me.textbox_Length.Value\n.Cells(iRow, 17).Value = Me.textbox_SheetCount.Value\n.Cells(iRow, 18).Value = Me.cbchecktype.Value\n.Cells(iRow, 19).Value = Me.cbchecktype1.Value\n.Protect Password:=\"password\"\nEnd With\n\n'clear the data\nMe.textbox_Lane1.Value = \"\"\nMe.textbox_Lane2.Value = \"\"\nMe.textbox_Lane3.Value = \"\"\nMe.textbox_Lane4.Value = \"\"\nMe.textbox_Lane5.Value = \"\"\nMe.textbox_Lane6.Value = \"\"\nMe.textbox_Lane7.Value = \"\"\nMe.textbox_Length.Value = \"\"\nMe.textbox_SheetCount.Value = \"\"\nMe.cbchecktype.Value = \"\"\nMe.cbchecktype1.Value = \"\"\nMe.checkbox_Retest.Value = False\n\n Me.Hide\n\nEnd Sub\n</code></pre>\n\n<p>A.S.H, I've tried your code and same thing is happening BUT I don't think its the code. Please see pictures of before and after. I think the problem is my IF STATEMENT: </p>\n\n<pre><code>\"If ws.Cells (iRow, 9) = \"\" And ws.Cells(iRow, 10) = \"\" Then\n</code></pre>\n\n<p>As you can see, the function works fine when I have an item in columns 9 (I) and 10 (J), but when I put no data in those two columns then it gets replaced with whatever data I've entered on my userform as long as it includes data in columns 9 or 10..Thoughts on correcting this?</p>\n\n<p><a href=\"https://i.stack.imgur.com/dGFXk.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/dGFXk.jpg\" alt=\"BEFORE\"></a><a href=\"https://i.stack.imgur.com/WBx9Z.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/WBx9Z.jpg\" alt=\"AFTER\"></a></p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 11755, "user_id": 4797603, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/AwTvE.jpg?s=128&g=1", "display_name": "Ronnie Royston", "link": "https://stackoverflow.com/users/4797603/ronnie-royston"}, "edited": false, "score": 0, "creation_date": 1489620205, "post_id": 42822501, "comment_id": 72756721, "body": "split the string based on &quot;&quot; into an array, then iterate (loop) the array"}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1489620384, "post_id": 42822501, "comment_id": 72756789, "body": "Are the strings you are interested in always delimited by <code>&quot;-&quot;</code>, or can the surrounding characters be other nondigit symbols? Also -- what would you do if there exists more than one run of consecutive digits, or is that not a problem?"}, {"owner": {"reputation": 31, "user_id": 4858714, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b81991085e2881d8933e8a12020a56b?s=128&d=identicon&r=PG&f=1", "display_name": "Python", "link": "https://stackoverflow.com/users/4858714/python"}, "edited": false, "score": 0, "creation_date": 1489623809, "post_id": 42822501, "comment_id": 72757806, "body": "Thank you for your prompt responses and help. The strings always change, sometimes have more than one &quot;-&quot; or none. Usually there is only one run of consecutive digits."}], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 4858714, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b81991085e2881d8933e8a12020a56b?s=128&d=identicon&r=PG&f=1", "display_name": "Python", "link": "https://stackoverflow.com/users/4858714/python"}, "edited": false, "score": 0, "creation_date": 1489623691, "post_id": 42822742, "comment_id": 72757761, "body": "Brilliant, thank you very much, this worked perfectly."}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 1, "last_activity_date": 1489621063, "creation_date": 1489621063, "answer_id": 42822742, "question_id": 42822501, "link": "https://stackoverflow.com/questions/42822501/extract-consecutive-digits-from-a-string-using-vba/42822742#42822742", "title": "Extract Consecutive Digits from a String using VBA", "body": "<p>Consider:</p>\n\n<pre><code>Public Function onlyDigits(s As String) As String\n    Dim L As Long, s2 As String, i As Long, Kapture As Boolean\n    Dim CH As String, temp As String\n\n    s2 = s &amp; \" \"\n    L = Len(s2)\n    Kapture = False\n    temp = \"\"\n    onlyDigits = \"\"\n\n    For i = 1 To L\n        CH = Mid(s2, i, 1)\n        If IsNumeric(CH) Then\n            temp = temp &amp; CH\n            If Len(temp) &gt; 1 Then Kapture = True\n        Else\n            If Len(temp) &lt; 2 Then\n                temp = \"\"\n            Else\n                If Kapture Then\n                    Exit For\n                End If\n            End If\n        End If\n    Next i\n\n    If Kapture Then onlyDigits = temp\nEnd Function\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/D0aXd.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/D0aXd.png\" alt=\"enter image description here\"></a></p>\n"}, {"comments": [{"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1489621391, "post_id": 42822778, "comment_id": 72757128, "body": "Nice. I was wondering if someone would give an re solution. +1"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1489621893, "post_id": 42822778, "comment_id": 72757297, "body": "@JohnColeman - thank you John, am always slightly wary of messing up RE."}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 1, "creation_date": 1489622277, "post_id": 42822778, "comment_id": 72757405, "body": "VBScript&#39;s implementation is on the clunky side. I use it sometimes but so infrequently that I usually have to spend time looking at the documentation to remind myself how it works. More often than not in VBA I can cobble together something using <code>Like</code> which does what I need and doesn&#39;t require all sorts of trial and error."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1489622366, "post_id": 42822778, "comment_id": 72757427, "body": "Agreed, often it&#39;s not necessary but I like to use it as it does make me have to think. Like you I usually have to resort to checking syntax and testing."}, {"owner": {"reputation": 52630, "user_id": 641067, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/n6xVq.png?s=128&g=1", "display_name": "brettdj", "link": "https://stackoverflow.com/users/641067/brettdj"}, "edited": false, "score": 0, "creation_date": 1489641307, "post_id": 42822778, "comment_id": 72762432, "body": "Nice. The OP may want to use <code>.Global</code> if there is more than 1 string to extract."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 52630, "user_id": 641067, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/n6xVq.png?s=128&g=1", "display_name": "brettdj", "link": "https://stackoverflow.com/users/641067/brettdj"}, "edited": false, "score": 0, "creation_date": 1489657933, "post_id": 42822778, "comment_id": 72770846, "body": "Thank you @brettdj - yes the code would need adjusting, but based on the OP&#39;s code I&#39;m assuming there is only one match."}], "tags": [], "owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "is_accepted": false, "score": 5, "last_activity_date": 1489621281, "creation_date": 1489621281, "answer_id": 42822778, "question_id": 42822501, "link": "https://stackoverflow.com/questions/42822501/extract-consecutive-digits-from-a-string-using-vba/42822778#42822778", "title": "Extract Consecutive Digits from a String using VBA", "body": "<p>Think this should do it if you only have one sequence</p>\n\n<pre><code>Function onlyDigits(v As Variant) As String\n\nWith CreateObject(\"vbscript.regexp\")\n    .Pattern = \"\\d{2,}\"\n    If .Test(v) Then onlyDigits = .Execute(v)(0)\nEnd With\n\nEnd Function\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "is_accepted": false, "score": 1, "last_activity_date": 1489621328, "creation_date": 1489621328, "answer_id": 42822788, "question_id": 42822501, "link": "https://stackoverflow.com/questions/42822501/extract-consecutive-digits-from-a-string-using-vba/42822788#42822788", "title": "Extract Consecutive Digits from a String using VBA", "body": "<p>This is fairly similar to the excellent answer of @Gary'sStudent but has a slightly different structure:</p>\n\n<pre><code>Function ConsecutiveDigits(s As String) As String\n    'returns the first substring consisting of 2 or more\n    'consecutive digits which is delimited by either a\n    'nondigit or the edge of the string\n    'returns empty string if no such subtring exists\n\n    Dim i As Long\n    Dim c As String\n    Dim digits As String\n\n    For i = 1 To Len(s)\n        c = Mid(s, i, 1)\n        If IsNumeric(c) Then\n            digits = digits &amp; c\n        Else\n            If Len(digits) &gt; 1 Then\n                ConsecutiveDigits = digits\n                Exit Function\n            Else\n                digits = \"\" 'reset\n            End If\n        End If\n    Next i\n    'we are at the end of the string -- should we return digits?\n    If Len(digits) &gt; 1 Then ConsecutiveDigits = digits\n    'else return default empty string\n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 4858714, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b81991085e2881d8933e8a12020a56b?s=128&d=identicon&r=PG&f=1", "display_name": "Python", "link": "https://stackoverflow.com/users/4858714/python"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1404, "favorite_count": 0, "answer_count": 3, "score": 3, "last_activity_date": 1489621328, "creation_date": 1489619816, "last_edit_date": 1531164843, "question_id": 42822501, "link": "https://stackoverflow.com/questions/42822501/extract-consecutive-digits-from-a-string-using-vba", "title": "Extract Consecutive Digits from a String using VBA", "body": "<p>I've written a sub that extracts all the digits from a string in cell A1 and pastes the result in cell A2. This loops through each row repeating the process until all cells containing strings have been worked through. </p>\n\n<p>However, I would like to only extract the numbers that are consecutive (more than 1 digit)</p>\n\n<p>for example: \nfrom this string: <strong>string-pattern-7---62378250-stringpattern.html</strong> I only want to extract the digits <strong>62378250</strong> and not the preceding <strong>7</strong>. </p>\n\n<p>How should I alter my code to achieve this? </p>\n\n<pre><code>Option Explicit\n\nFunction onlyDigits(s As String) As String\n    ' Variables needed (remember to use \"option explicit\").   '\n    Dim retval As String    ' This is the return string.      '\n    Dim i As Integer        ' Counter for character position. '\n\n    ' Initialise return string to empty                       '\n    retval = \"\"\n\n    ' For every character in input string, copy digits to     '\n    '   return string.                                        '\n    For i = 1 To Len(s)\n        If Mid(s, i, 1) &gt;= \"0\" And Mid(s, i, 1) &lt;= \"9\" Then\n            retval = retval + Mid(s, i, 1)\n        End If\n    Next\n\n    ' Then return the return string.                          '\n    onlyDigits = retval\nEnd Function\n\n\nSub extractDigits()\n\nDim myStr As String\n\nDo While ActiveCell.Value &lt;&gt; Empty\n        myStr = onlyDigits(ActiveCell.Value)\n        ActiveCell(1, 2).Value = myStr\n        ActiveCell.Offset(1, 0).Select\n    Loop\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1489623740, "post_id": 42822436, "comment_id": 72757775, "body": "Try adding <i>Form</i> object to reference as in: <code>[Forms]![frmFullCourseInfo]![sbfrmTrainingElements].Form![Si&zwnj;&#8203;te]</code>"}, {"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "reply_to_user": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1489651361, "post_id": 42822436, "comment_id": 72766730, "body": "@Parfait: Also emphasize that <code>sbfrmTrainingElements</code> must be the name of the subform <i>control</i> on form <code>frmFullCourseInfo</code>."}], "answers": [{"tags": [], "owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "is_accepted": false, "score": 0, "last_activity_date": 1489633264, "creation_date": 1489633264, "answer_id": 42824512, "question_id": 42822436, "link": "https://stackoverflow.com/questions/42822436/ms-access-vba-properly-referencing-a-subform/42824512#42824512", "title": "MS Access VBA: Properly Referencing a SubForm", "body": "<p>Must reference the subform container control. I always give the container a name different from the object it holds, like ctrTraining. </p>\n\n<p>[Forms]![frmFullCourseInfo]![ctrTraining]![Site]</p>\n"}, {"tags": [], "owner": {"reputation": 501, "user_id": 7129561, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/8543be588e524cca7f2c217ac549771b?s=128&d=identicon&r=PG&f=1", "display_name": "Chuck0185", "link": "https://stackoverflow.com/users/7129561/chuck0185"}, "is_accepted": false, "score": 0, "last_activity_date": 1489684944, "creation_date": 1489684944, "answer_id": 42840835, "question_id": 42822436, "link": "https://stackoverflow.com/questions/42822436/ms-access-vba-properly-referencing-a-subform/42840835#42840835", "title": "MS Access VBA: Properly Referencing a SubForm", "body": "<p>Thank you for your help.  I found out what the issue was.  The field \"Site\" actually had a lookup associated with it (lookup was created by a colleague who has since left the project).  I tried to remove the lookup just by deleting the information in the lookup tab, despite this it still preserved some sort of lookup functionality.  What I had to do was delete this field, and create a new one with the same name.  Everything is working fine now.  Thanks again!</p>\n"}], "owner": {"reputation": 501, "user_id": 7129561, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/8543be588e524cca7f2c217ac549771b?s=128&d=identicon&r=PG&f=1", "display_name": "Chuck0185", "link": "https://stackoverflow.com/users/7129561/chuck0185"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 934, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1489684944, "creation_date": 1489619438, "last_edit_date": 1489621405, "question_id": 42822436, "link": "https://stackoverflow.com/questions/42822436/ms-access-vba-properly-referencing-a-subform", "title": "MS Access VBA: Properly Referencing a SubForm", "body": "<p>I have built an MS Access Curriculum Management tool for my group at work.  I have a form where an end user is able to add Training materials for a specific course.  One of the fields in the form asks for the specific hospital that the material is used for.  To populate this form, the user clicks a button that brings up a form (\"sbfrmcoursematerialsite\") with a list of all possible hospitals in our system that the user is able to multiselect.  The form is populated using this SQL code:</p>\n\n<pre><code>SELECT pklistEntSites.Site FROM pklistEntSites UNION SELECT \"          [Enterprise]\" FROM pklistEntSites\nORDER BY pklistEntSites.Site;\n</code></pre>\n\n<p>This multiselect concatenates the hospital abbreviations and creates a string to insert into the \"Site\" field in the \"sbfrmTrainingElements\" (which is the control source for a txtBox named txtSite).  My issue is that when I click the Ok button on the \"sbfrmcoursematerialsite\" I get an error stating: Cannot Perform this Operation.  My VBA code contained within the \"sbfrmcoursematerialsite\" form is below.  The concatenation function is working but the error occurs on the line in bold in the code.  Am I not properly referencing the subform that I would like add the data to?  </p>\n\n<pre><code>Private Sub cmdOk_Click()\nDim teID As Integer\nMe.Refresh\nteID = Me.txtTrainingElementID 'Document Training Element ID\n\nDoCmd.SetWarnings False\n'Update the Site field in tblTrainingElements for the specific training      element\n'DoCmd.RunSQL \"UPDATE tblTrainingElements SET [Site] = '\" &amp;     Me.txtSelectedSites &amp; \"' WHERE [Training Element ID] = \" &amp; teID &amp; \";\"\n'Debug.Print Me.txtSite.Value\nDebug.Print [Forms]![frmFullCourseInfo]![sbfrmTrainingElements]! [Site].Value\n**[Forms]![frmFullCourseInfo]![sbfrmTrainingElements]![Site].Value =     Me.txtSelectedSites**\nDoCmd.SetWarnings True\n'Close the site select form\nDoCmd.Close\nEnd Sub\n\nPrivate Sub Form_Load()\n'Show current site selection\nMe.txtSelectedSites = [Forms]![frmFullCourseInfo]! [sbfrmTrainingElements]![Site]\n\n'Pass the training element ID from the last screen to current form\nDim i As Integer\ni = CInt(Me.OpenArgs)\nMe.txtTrainingElementID.Value = i\n\nEnd Sub\n\nPrivate Sub lboAllSites_Click()\n   Dim strSelected As String\n   Dim varItem As Variant\n\n    With Me.lboAllSites\n        For Each varItem In .ItemsSelected\n            strSelected = strSelected &amp; \",\" &amp; .ItemData(varItem)\n        Next varItem\n        Me.txtSelectedSites = Mid(strSelected, 2)\n    End With\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 11381, "user_id": 2859347, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/00bC9.png?s=128&g=1", "display_name": "CallumDA", "link": "https://stackoverflow.com/users/2859347/callumda"}, "edited": false, "score": 1, "creation_date": 1489619569, "post_id": 42822409, "comment_id": 72756515, "body": "Hey. Can you include a screenshot of your worksheet and also what behaviour you expect to see?"}, {"owner": {"reputation": 1396, "user_id": 4691433, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/bce001c90ad26add5d7483b714640c12?s=128&d=identicon&r=PG&f=1", "display_name": "puzzlepiece87", "link": "https://stackoverflow.com/users/4691433/puzzlepiece87"}, "reply_to_user": {"reputation": 11381, "user_id": 2859347, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/00bC9.png?s=128&g=1", "display_name": "CallumDA", "link": "https://stackoverflow.com/users/2859347/callumda"}, "edited": false, "score": 0, "creation_date": 1489621551, "post_id": 42822409, "comment_id": 72757182, "body": "@CallumDA I added lots of comments to the code and added a screenshot, hopefully that will help. Thanks for your suggestion!"}, {"owner": {"reputation": 11381, "user_id": 2859347, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/00bC9.png?s=128&g=1", "display_name": "CallumDA", "link": "https://stackoverflow.com/users/2859347/callumda"}, "edited": false, "score": 0, "creation_date": 1489621780, "post_id": 42822409, "comment_id": 72757254, "body": "That makes a lot of sense, I&#39;ll update my answer"}], "answers": [{"comments": [{"owner": {"reputation": 1396, "user_id": 4691433, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/bce001c90ad26add5d7483b714640c12?s=128&d=identicon&r=PG&f=1", "display_name": "puzzlepiece87", "link": "https://stackoverflow.com/users/4691433/puzzlepiece87"}, "edited": false, "score": 0, "creation_date": 1489621743, "post_id": 42822785, "comment_id": 72757242, "body": "Thanks for this. I know you were waiting for me to get my edits up, but one reason this won&#39;t work is because I don&#39;t want a switched turned on unnecessarily, only turned off if necessary. Let me know if I can clarify my original question any better - I&#39;m about to format the expected results section to make it more visible."}, {"owner": {"reputation": 11381, "user_id": 2859347, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/00bC9.png?s=128&g=1", "display_name": "CallumDA", "link": "https://stackoverflow.com/users/2859347/callumda"}, "reply_to_user": {"reputation": 1396, "user_id": 4691433, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/bce001c90ad26add5d7483b714640c12?s=128&d=identicon&r=PG&f=1", "display_name": "puzzlepiece87", "link": "https://stackoverflow.com/users/4691433/puzzlepiece87"}, "edited": false, "score": 0, "creation_date": 1489622832, "post_id": 42822785, "comment_id": 72757556, "body": "Hey @puzzlepiece87, I updated my answer - let me know how you get on?"}, {"owner": {"reputation": 1396, "user_id": 4691433, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/bce001c90ad26add5d7483b714640c12?s=128&d=identicon&r=PG&f=1", "display_name": "puzzlepiece87", "link": "https://stackoverflow.com/users/4691433/puzzlepiece87"}, "edited": false, "score": 1, "creation_date": 1489623126, "post_id": 42822785, "comment_id": 72757637, "body": "Oh, I get it, you&#39;re basically suggesting I use three <code>Sub</code>s instead of two: <code>Toggle_Click_Trigger</code>, <code>Toggle_Click_Formatting</code>, and <code>Toggle_ErrPrevention</code> that calls <code>Toggle_Click_Formatting</code> with arguments to avoid over-relying on <code>Application.Caller</code>. I like it, thank you!"}, {"owner": {"reputation": 11381, "user_id": 2859347, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/00bC9.png?s=128&g=1", "display_name": "CallumDA", "link": "https://stackoverflow.com/users/2859347/callumda"}, "reply_to_user": {"reputation": 1396, "user_id": 4691433, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/bce001c90ad26add5d7483b714640c12?s=128&d=identicon&r=PG&f=1", "display_name": "puzzlepiece87", "link": "https://stackoverflow.com/users/4691433/puzzlepiece87"}, "edited": false, "score": 1, "creation_date": 1489623480, "post_id": 42822785, "comment_id": 72757696, "body": "Well, do you really need the <code>Toggle_ErrPrevention</code> sub? But yes, you definitely don&#39;t want to overuse <code>Application.Caller</code>. I reworked my answer a bit just to make it slightly more obvious how it&#39;s working :) Anyway, pleased to help!"}, {"owner": {"reputation": 1396, "user_id": 4691433, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/bce001c90ad26add5d7483b714640c12?s=128&d=identicon&r=PG&f=1", "display_name": "puzzlepiece87", "link": "https://stackoverflow.com/users/4691433/puzzlepiece87"}, "edited": false, "score": 0, "creation_date": 1489623886, "post_id": 42822785, "comment_id": 72757835, "body": "You are right, I don&#39;t need it. Your edit helped clear that up. Thanks!"}], "tags": [], "owner": {"reputation": 11381, "user_id": 2859347, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/00bC9.png?s=128&g=1", "display_name": "CallumDA", "link": "https://stackoverflow.com/users/2859347/callumda"}, "is_accepted": true, "score": 1, "last_activity_date": 1489623336, "last_edit_date": 1489623336, "creation_date": 1489621303, "answer_id": 42822785, "question_id": 42822409, "link": "https://stackoverflow.com/questions/42822409/is-it-possible-to-run-multiple-instances-of-the-same-sub-or-is-refactoring-nece/42822785#42822785", "title": "Is it possible to run multiple instances of the same sub, or is refactoring necessary?", "body": "<p>The code below toggles your three shapes like this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/CvBkB.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/CvBkB.png\" alt=\"enter image description here\"></a> <a href=\"https://i.stack.imgur.com/2Xi30.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/2Xi30.png\" alt=\"enter image description here\"></a> <a href=\"https://i.stack.imgur.com/zIVNd.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/zIVNd.png\" alt=\"enter image description here\"></a> <a href=\"https://i.stack.imgur.com/CvBkB.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/CvBkB.png\" alt=\"enter image description here\"></a></p>\n\n<pre><code>Option Explicit\n\nSub ToggleShape()\n    With ThisWorkbook.Worksheets(\"Sheet1\")\n        Dim selectedShape As Shape\n        Set selectedShape = .Shapes(Application.Caller)\n\n        'always turn on selected shape\n        FormatShape selectedShape, \"On\"\n\n        'turn off relevant other shapes\n        Select Case selectedShape.Name\n            Case \"ToggleBackground1\"\n                FormatShape .Shapes(\"ToggleBackground2\"), \"Off\"\n                FormatShape .Shapes(\"ToggleBackground3\"), \"Off\"\n            Case Else\n                FormatShape .Shapes(\"ToggleBackground1\"), \"Off\"\n        End Select\n    End With\nEnd Sub\n\nSub FormatShape(sh As Shape, status As String)\n    With sh\n        If status = \"On\" Then\n            .Fill.ForeColor.RGB = RGB(0, 255, 0)\n            .TextFrame.Characters.Text = \"On\"\n        Else\n            .Fill.ForeColor.RGB = RGB(255, 255, 255)\n            .TextFrame.Characters.Text = \"Off\"\n        End If\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1396, "user_id": 4691433, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/bce001c90ad26add5d7483b714640c12?s=128&d=identicon&r=PG&f=1", "display_name": "puzzlepiece87", "link": "https://stackoverflow.com/users/4691433/puzzlepiece87"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 27, "favorite_count": 0, "accepted_answer_id": 42822785, "answer_count": 1, "score": 1, "last_activity_date": 1489623336, "creation_date": 1489619326, "last_edit_date": 1531164843, "question_id": 42822409, "link": "https://stackoverflow.com/questions/42822409/is-it-possible-to-run-multiple-instances-of-the-same-sub-or-is-refactoring-nece", "title": "Is it possible to run multiple instances of the same sub, or is refactoring necessary?", "body": "<p><a href=\"https://i.stack.imgur.com/GyElT.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/GyElT.png\" alt=\"Screenshot of Incompatible Switches\"></a></p>\n\n<p><strong>Expected Result</strong></p>\n\n<p>The Claim Removal switches above are incompatible with the HL Segment Numbering switch. If the user turns the HL Segment Numbering switch On while one or both of the Claim Removal switches are already On, the Claim Removal Switches will be turned off, and vice versa.</p>\n\n<hr>\n\n<p>I am trying to efficiently use one <code>Sub</code>, <code>Toggle_Click</code>, to manage turning switches on and off, and another, <code>Toggle_ErrorPrevention</code>, to prevent two incompatible switches from being turned on at the same time.</p>\n\n<p>The issue I'm having trouble with is that when <code>Toggle_ErrorPrevention</code> tries to turn off an incompatible switch by calling <code>Toggle_Click</code> via <code>Application.Run .Shapes([incompatible switch]).OnAction</code>, <code>Toggle_Click</code> does not recognize the incompatible switch as the new <code>Application.Caller</code>, believing it instead to be the original switch that started the whole sequence.</p>\n\n<p>This may be because <code>Toggle_Click</code> is still mid-execution from the first call and VBA is not able to recognize a new caller until the first call finishes. </p>\n\n<p>How can I get <code>Toggle_Click</code> to recognize [incompatible switch] as a new <code>Application.Caller</code>?</p>\n\n<pre><code>Option Explicit\n\nSub Toggle_Click()\n    Dim lngMoveBy As Long\n    Dim Loop1 As Long\n    Dim intShapeNumber As Integer\n    Dim boolActive As Boolean\n\n    '--- A user clicked a toggle or Toggle_ErrPrevention is trying to turn off an incompatible toggle ---\n    'Which toggle triggered this sub? Get ready to turn that toggle on/off\n    intShapeNumber = Right(Application.Caller, Len(Application.Caller) - Len(\"Toggle\"))\n    'Is the toggle inactive (white)?\n    If ThisWorkbook.Sheets(\"Correction Type Options\").Shapes(\"ToggleBackground\" &amp; intShapeNumber).Fill.ForeColor.RGB = RGB(255, 255, 255) Then boolActive = False Else boolActive = True\n    'A user-clicked toggle that is currently off may have incompatible toggles that are currently on. If currently off, prevent errors\n    'If Toggle_ErrPrevention is trying to turn off an incompatible toggle, it won't trigger itself again because incompatible toggles are always on\n    If boolActive = False Then Toggle_ErrorPrevention intShapeNumber\n\n    '--- The triggering toggle was on or all incompatible toggles have been turned off. Get ready to change triggering toggle state ---\n    'Which direction should the switch graphic be moved?\n    If boolActive = False Then\n        'Move right to On position\n        lngMoveBy = 0.6\n    Else\n        'Move left to Off position\n        lngMoveBy = -0.6\n    End If\n\n    'Actually move the switch graphic in the appropriate direction\n    With ThisWorkbook.Sheets(\"Correction Type Options\").Shapes(\"Toggle\" &amp; intShapeNumber)\n        For Loop1 = 1 To 24\n            .IncrementLeft lngMoveBy\n            DoEvents\n        Next Loop1\n    End With\n\n    'Change switch text and color\n    If boolActive = False Then\n        With ThisWorkbook.Sheets(\"Correction Type Options\").Shapes(\"ToggleBackground\" &amp; intShapeNumber)\n            .Fill.ForeColor.RGB = RGB(0, 255, 0)\n            .TextFrame.Characters.Text = \"On\"\n            .TextFrame.Characters.Font.Bold = True\n            .TextFrame.Characters.Font.ColorIndex = 1\n            .TextFrame.HorizontalAlignment = xlLeft\n            .TextFrame.VerticalAlignment = xlCenter\n        End With\n    Else\n        With ThisWorkbook.Sheets(\"Correction Type Options\").Shapes(\"ToggleBackground\" &amp; intShapeNumber)\n            .Fill.ForeColor.RGB = RGB(255, 255, 255)\n            .TextFrame.Characters.Text = \"Off\"\n            .TextFrame.Characters.Font.Bold = True\n            .TextFrame.Characters.Font.ColorIndex = 1\n            .TextFrame.HorizontalAlignment = xlRight\n            .TextFrame.VerticalAlignment = xlCenter\n        End With\n    End If\n\nEnd Sub\n\nSub Toggle_ErrorPrevention(ByVal intShapeNumberVal As Integer)\n\n    Dim lngHLSegmentNumberingRow As Long\n    Dim lngClaimRemovalHaveWantedClaimsRow As Long\n    Dim lngClaimRemovalHaveUnwantedClaimsRow As Long\n\n\n    'Find current location of incompatible switches\n    With ThisWorkbook.Sheets(\"Correction Type Options\").Columns(1)\n        lngHLSegmentNumberingRow = .Find(What:=\"HL Segment Numbering\", Lookat:=xlWhole).Row\n        lngClaimRemovalHaveWantedClaimsRow = .Find(What:=\"Claim Removal - Have Wanted Claims\", Lookat:=xlWhole).Row\n        lngClaimRemovalHaveUnwantedClaimsRow = .Find(What:=\"Claim Removal - Have Unwanted Claims\", Lookat:=xlWhole).Row\n    End With\n\n    'If an incompatible switch is green (on), run Toggle_Click for the incompatible switch\n    With ThisWorkbook.Sheets(\"Correction Type Options\")\n        'Claim Removal is incompatible with HL Segment Numbering\n        If intShapeNumberVal + 1 = lngHLSegmentNumberingRow Then\n            If .Shapes(\"ToggleBackground\" &amp; lngClaimRemovalHaveWantedClaimsRow - 1).Fill.ForeColor.RGB = RGB(0, 255, 0) Then Application.Run .Shapes(\"Toggle\" &amp; lngClaimRemovalHaveWantedClaimsRow - 1).OnAction\n            If .Shapes(\"ToggleBackground\" &amp; lngClaimRemovalHaveUnwantedClaimsRow - 1).Fill.ForeColor.RGB = RGB(0, 255, 0) Then Application.Run .Shapes(\"Toggle\" &amp; lngClaimRemovalHaveUnwantedClaimsRow - 1).OnAction\n        End If\n        'HL Segment Numbering is incompatible with Claim Removal\n        If intShapeNumberVal + 1 = lngClaimRemovalHaveWantedClaimsRow Or intShapeNumberVal + 1 = lngClaimRemovalHaveUnwantedClaimsRow Then\n            If .Shapes(\"ToggleBackground\" &amp; lngHLSegmentNumberingRow - 1).Fill.ForeColor.RGB = RGB(0, 255, 0) Then Application.Run .Shapes(\"Toggle\" &amp; lngHLSegmentNumberingRow - 1).OnAction\n        End If\n    End With\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2953, "user_id": 2801253, "user_type": "registered", "profile_image": "https://graph.facebook.com/1332362525/picture?type=large", "display_name": "Mark Fitzgerald", "link": "https://stackoverflow.com/users/2801253/mark-fitzgerald"}, "edited": false, "score": 0, "creation_date": 1489705152, "post_id": 42822164, "comment_id": 72800916, "body": "Could you show your existing <code>Worksheet_Change</code> code?  Also, I think I understand how your sheets are laid out but would like to see before and after images of both sheets just to be sure.  I think what you are asking can probably be done."}, {"owner": {"reputation": 2953, "user_id": 2801253, "user_type": "registered", "profile_image": "https://graph.facebook.com/1332362525/picture?type=large", "display_name": "Mark Fitzgerald", "link": "https://stackoverflow.com/users/2801253/mark-fitzgerald"}, "edited": false, "score": 0, "creation_date": 1489710244, "post_id": 42822164, "comment_id": 72802455, "body": "I think I almost have it.  Are you monitoring rowsheet in Work in Process.xls or is that a separate workbook?"}, {"owner": {"reputation": 99, "user_id": 7681144, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/d4270c16f660ea95982ce4b0b6b452a4?s=128&d=identicon&r=PG&f=1", "display_name": "Liamck27", "link": "https://stackoverflow.com/users/7681144/liamck27"}, "reply_to_user": {"reputation": 2953, "user_id": 2801253, "user_type": "registered", "profile_image": "https://graph.facebook.com/1332362525/picture?type=large", "display_name": "Mark Fitzgerald", "link": "https://stackoverflow.com/users/2801253/mark-fitzgerald"}, "edited": false, "score": 0, "creation_date": 1489710570, "post_id": 42822164, "comment_id": 72802547, "body": "Its the same workbook"}, {"owner": {"reputation": 2953, "user_id": 2801253, "user_type": "registered", "profile_image": "https://graph.facebook.com/1332362525/picture?type=large", "display_name": "Mark Fitzgerald", "link": "https://stackoverflow.com/users/2801253/mark-fitzgerald"}, "edited": false, "score": 0, "creation_date": 1489716131, "post_id": 42822164, "comment_id": 72803962, "body": "What happens to the cell relationship to batchNo for cells below the inserted cell?  It seems to me there will be a disconnect."}, {"owner": {"reputation": 99, "user_id": 7681144, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/d4270c16f660ea95982ce4b0b6b452a4?s=128&d=identicon&r=PG&f=1", "display_name": "Liamck27", "link": "https://stackoverflow.com/users/7681144/liamck27"}, "reply_to_user": {"reputation": 2953, "user_id": 2801253, "user_type": "registered", "profile_image": "https://graph.facebook.com/1332362525/picture?type=large", "display_name": "Mark Fitzgerald", "link": "https://stackoverflow.com/users/2801253/mark-fitzgerald"}, "edited": false, "score": 0, "creation_date": 1489716406, "post_id": 42822164, "comment_id": 72804047, "body": "What do you mean by a &quot;disconnect&quot;? I had hoped I could assign batchNo to cell A# while looping through the selection"}, {"owner": {"reputation": 2953, "user_id": 2801253, "user_type": "registered", "profile_image": "https://graph.facebook.com/1332362525/picture?type=large", "display_name": "Mark Fitzgerald", "link": "https://stackoverflow.com/users/2801253/mark-fitzgerald"}, "edited": false, "score": 0, "creation_date": 1489718022, "post_id": 42822164, "comment_id": 72804505, "body": "Say you insert a cell in M10 which, prior to the insertion had a batchNo = 8, the newly inserted M10 will have batchNo = 8 and the old M10 will get M11s batchNo.  Hence the disconnect.  Where would a new batchNo come from?"}, {"owner": {"reputation": 99, "user_id": 7681144, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/d4270c16f660ea95982ce4b0b6b452a4?s=128&d=identicon&r=PG&f=1", "display_name": "Liamck27", "link": "https://stackoverflow.com/users/7681144/liamck27"}, "reply_to_user": {"reputation": 2953, "user_id": 2801253, "user_type": "registered", "profile_image": "https://graph.facebook.com/1332362525/picture?type=large", "display_name": "Mark Fitzgerald", "link": "https://stackoverflow.com/users/2801253/mark-fitzgerald"}, "edited": false, "score": 0, "creation_date": 1489718506, "post_id": 42822164, "comment_id": 72804634, "body": "Its inserting an entire row. when the user inserts they cut multiple rows from a group with an &quot;unassigned&quot; header and when they insert, all rows below will get shifted down"}, {"owner": {"reputation": 2953, "user_id": 2801253, "user_type": "registered", "profile_image": "https://graph.facebook.com/1332362525/picture?type=large", "display_name": "Mark Fitzgerald", "link": "https://stackoverflow.com/users/2801253/mark-fitzgerald"}, "edited": false, "score": 0, "creation_date": 1489721324, "post_id": 42822164, "comment_id": 72805404, "body": "I still think it can probably be done but will need to think on it for a while.  In the absence of images, am I right in thinking that <code>columnsheet</code> range(&quot;D12:FZ144&quot;) has &quot;Group&quot; headers in row 12 with applicable batchNos for each &quot;Group&quot; listed directly below them and that you want to cut the batchNos from the source &quot;Group&quot; and paste them below the destination &quot;Group&quot; header?"}, {"owner": {"reputation": 99, "user_id": 7681144, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/d4270c16f660ea95982ce4b0b6b452a4?s=128&d=identicon&r=PG&f=1", "display_name": "Liamck27", "link": "https://stackoverflow.com/users/7681144/liamck27"}, "reply_to_user": {"reputation": 2953, "user_id": 2801253, "user_type": "registered", "profile_image": "https://graph.facebook.com/1332362525/picture?type=large", "display_name": "Mark Fitzgerald", "link": "https://stackoverflow.com/users/2801253/mark-fitzgerald"}, "edited": false, "score": 0, "creation_date": 1489968168, "post_id": 42822164, "comment_id": 72888821, "body": "in columnsheet rows 3-7 have group header information and 8-11 have calculations to do with the group, so batchNos start in row 12"}], "answers": [{"comments": [{"owner": {"reputation": 99, "user_id": 7681144, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/d4270c16f660ea95982ce4b0b6b452a4?s=128&d=identicon&r=PG&f=1", "display_name": "Liamck27", "link": "https://stackoverflow.com/users/7681144/liamck27"}, "edited": false, "score": 0, "creation_date": 1489702905, "post_id": 42825703, "comment_id": 72800122, "body": "Sorry if i was unclear but I don&#39;t want to stop users from cutting and pasting, i want some code to run when cutting and inserting rows that moves cells on another sheet(I already have code for this i just need to know when to run it)"}], "tags": [], "owner": {"reputation": 2953, "user_id": 2801253, "user_type": "registered", "profile_image": "https://graph.facebook.com/1332362525/picture?type=large", "display_name": "Mark Fitzgerald", "link": "https://stackoverflow.com/users/2801253/mark-fitzgerald"}, "is_accepted": false, "score": 0, "last_activity_date": 1489640749, "creation_date": 1489640749, "answer_id": 42825703, "question_id": 42822164, "link": "https://stackoverflow.com/questions/42822164/excel-if-selection-is-cut-then-do-things/42825703#42825703", "title": "Excel if selection is cut then do things", "body": "<p>There are 3 potential ways, excluding macros, to change a cell value without actually typing anything in the cell:</p>\n\n<ol>\n<li>Drag and drop from another cell on the sheet</li>\n<li>Copy and paste from another cell, sheet or even workbook</li>\n<li>Cut and paste from another cell, sheet or workbook</li>\n</ol>\n\n<p>If you want to stop users from dragging and dropping into a cell or range of cells, you can disable that functionality whenever the sheet is activated.  Be sure to re-enable it when you deactivate the sheet because it's an Application setting which applies to all sheets in all open workbooks.</p>\n\n<pre><code>Private Sub Worksheet_Activate()\n    Application.CellDragAndDrop = False\nEnd Sub\n\nPrivate Sub Worksheet_Deactivate()\n    Application.CellDragAndDrop = True\nEnd Sub\n</code></pre>\n\n<p>You will notice that the mouse pointer doesn't change to 4 arrows when you hover over a non-blank cells borders.  I found an undocumented side-effect that disabling CellDragAndDrop also clears the clipboard if you are trying to copy something from another sheet or workbook.</p>\n\n<p>To prevent cutting and pasting from within the sheet, you need to catch it before it happens by checking if CutCopyMode (i.e. there are marching ants around a selection) is true when the cell selection changes.</p>\n\n<pre><code>Private Sub Worksheet_SelectionChange(ByVal Target As Range)\n    If Application.CutCopyMode &lt;&gt; False Then\n        Application.CutCopyMode = False\n        MsgBox \"Cut or Copy &amp; Paste is not allowed on this sheet\", vbExclamation\n    End If\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 99, "user_id": 7681144, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/d4270c16f660ea95982ce4b0b6b452a4?s=128&d=identicon&r=PG&f=1", "display_name": "Liamck27", "link": "https://stackoverflow.com/users/7681144/liamck27"}, "is_accepted": true, "score": 0, "last_activity_date": 1494810191, "creation_date": 1494810191, "answer_id": 43970256, "question_id": 42822164, "link": "https://stackoverflow.com/questions/42822164/excel-if-selection-is-cut-then-do-things/43970256#43970256", "title": "Excel if selection is cut then do things", "body": "<p>The way i solved this was by checking if the selection was an entire row</p>\n\n<pre><code>If Target.count &gt; 0 Then\n    Dim r As Range\n    If Target.Columns.count = ActiveSheet.Columns.count Then        ' if entire row\n        If Target.rows.count &gt; 1 Then                               ' multiple rows\n            For Each r In Target.rows                               \n                DoStuff r\n            Next r\n        Else                                                        'single row\n            DoStuff Target\n        End If\n    ElseIf Not Application.Intersect(KeyCells, Range(Target.Address)) Is Nothing Then\n        If Target.rows.count &gt; 1 Then                               ' multiple items\n            For Each r In Target.rows                               ' do stuff for each item\n                DoOtherStuff r\n            Next r\n        Else                                                        'single item\n            DoOtherStuff Target\n        End If\n    End If\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 99, "user_id": 7681144, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/d4270c16f660ea95982ce4b0b6b452a4?s=128&d=identicon&r=PG&f=1", "display_name": "Liamck27", "link": "https://stackoverflow.com/users/7681144/liamck27"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 416, "favorite_count": 0, "accepted_answer_id": 43970256, "answer_count": 2, "score": 2, "last_activity_date": 1494810191, "creation_date": 1489618086, "last_edit_date": 1489708394, "question_id": 42822164, "link": "https://stackoverflow.com/questions/42822164/excel-if-selection-is-cut-then-do-things", "title": "Excel if selection is cut then do things", "body": "<p>I have a workbook and need to run a macro on rows that are cut and inserted</p>\n\n<p>I already have code that runs when one cell in a row changes that changes the color of a cell in another sheet with the same value.</p>\n\n<p>That code is in the worksheet_Change sub.</p>\n\n<p>My question is How do i detect if target has been cut and inserted rather than just typed in?</p>\n\n<p>EDIT**</p>\n\n<p>Thanks to Mark Fitzgerald i realized i need to give more information.</p>\n\n<p>I have 2 sheets one has rows of data with a blank row then a header for each group of data</p>\n\n<p>the other sheet is set up in columns so each column has the header info then the first cell from each of the rows that are in the group.</p>\n\n<p>when someone cuts and inserts some rows from one group on the row sheet the related cells in the column sheet to move to the relevant column.</p>\n\n<p>The rows will NEVER be copy and pasted nor will the values move independently of the row.</p>\n\n<p>Code Below</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\nApplication.ScreenUpdating = False\nDim KeyCells As Range\nDim batchNo\n' The variable KeyCells contains the cells that will\n' cause an alert when they are changed.\nSet KeyCells = Range(\"m1:m5000\")\nSet batchNo = Range(\"A\" &amp; ActiveCell.Row)\n\nIf Target.count = 1 Then\n    Select Case Target.Value\n        Case \"x\"\n\n        Case \"y\"\n\n        Case Else\n            ActiveCell.Interior.Color = RGB(255, 255, 255)\n            ActiveCell.Font.Color = RGB(0, 0, 0)\n    End Select\n\n    If Not Application.Intersect(KeyCells, Range(Target.Address)) Is Nothing Then\n\n        Dim c\n        With Sheets(\"columnsheet\").Range(\"d12:fz144\")\n            Set c = .Find(batchNo, LookIn:=xlValues)\n            If Not c Is Nothing Then\n                Workbooks(\"Work In Process.xls\").Activate\n                Worksheets(\"columnsheet\").Activate\n                ActiveSheet.Range(c.Address).Activate\n                Select Case Target.Value\n                Case \"x\"\n\n                Case \"y\"\n\n                Case Else\n                    ActiveCell.Interior.Color = RGB(255, 255, 255)\n                    ActiveCell.Font.Color = RGB(0, 0, 0)\n                End Select\n                Workbooks(\"Work In Process.xls\").Activate\n                Worksheets(\"rowsheet\").Activate\n            End If\n        End With\n    End If\nElseIf (Target.count &gt; 1) Then\n                                      'if entire row or rows are selected\nEnd If\nApplication.ScreenUpdating = True\nEnd Sub\n</code></pre>\n\n<p>I removed most of the cases because they made it more cluttered but all they do is change text colour and background colour</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 2, "creation_date": 1489621275, "post_id": 42822111, "comment_id": 72757092, "body": "First steps toward fixing this: 1) <code>Option Explicit</code> (you have typos in some variable names, i.e. <code>varAddColumnFixedValiue</code>) 2) qualify all your ranges."}, {"owner": {"reputation": 159, "user_id": 6450586, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/20eed796d8d3400c9e498e4d6d2dd185?s=128&d=identicon&r=PG&f=1", "display_name": "DGP", "link": "https://stackoverflow.com/users/6450586/dgp"}, "reply_to_user": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1489622159, "post_id": 42822111, "comment_id": 72757361, "body": "Thanks very much.  Sorry, but could you please be a bit more specific when you say &quot;qualify all of your ranges&quot;."}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1489622380, "post_id": 42822111, "comment_id": 72757432, "body": "I saw some places where you use <code>Cells</code> without a <code>dot</code> before, specifically in those commented lines that throw errors."}, {"owner": {"reputation": 159, "user_id": 6450586, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/20eed796d8d3400c9e498e4d6d2dd185?s=128&d=identicon&r=PG&f=1", "display_name": "DGP", "link": "https://stackoverflow.com/users/6450586/dgp"}, "reply_to_user": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1489622978, "post_id": 42822111, "comment_id": 72757597, "body": "This is where my ignorance gets me.  I had seen some posts online with .Cells and I did try that, but it would not run and gave me an error:   Invalid or unqualified reference  I just tried again to change the code to: oXLSheet.Range(.Cells(2, 23), .Cells(17, 23)).Value = strNewFixedValueInsteadofVARIANT    Error Again.  So, I think you have hit on one of my key problems, but I don&#39;t know the proper syntax to fix it."}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1489623359, "post_id": 42822111, "comment_id": 72757680, "body": "I did not mean just adding a dot, like <code>.Cells</code> but <code>someSheetObject.Cells</code>. eventually you can use a <code>With</code> bloc, specifying the sheet once, in that case you can use single dot."}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1489623509, "post_id": 42822111, "comment_id": 72757709, "body": "Anyway I think it is more urgent is to set <code>option explicit</code> and fix variable name typos."}, {"owner": {"reputation": 159, "user_id": 6450586, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/20eed796d8d3400c9e498e4d6d2dd185?s=128&d=identicon&r=PG&f=1", "display_name": "DGP", "link": "https://stackoverflow.com/users/6450586/dgp"}, "reply_to_user": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1489625006, "post_id": 42822111, "comment_id": 72758108, "body": "UPDATE. The Option Explicit did help, but I am still getting ZERO for the SUM most of the times that it runs.  Still no clue why that is inconsistent (works once, and then fails after). &#39;Get SUM for Parameter Column strSUMRange = strSUMColumn &amp; &quot;2:&quot; &amp; strSUMColumn &amp; intLastRow &#39;This works once and then returns ZERO each time I run the SUB again   varSumExcelColumns = Excel.WorksheetFunction.Sum(oXLSheet.Range(strSUMRange))  I also don\u2019t understand what is wrong with this code below: oXLSheet.Range(Cells(2, intLastCol), Cells(intLastRow, intLastCol)).Value = varAddColumnFixedValue"}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1489626356, "post_id": 42822111, "comment_id": 72758439, "body": "What is the error message it throws?"}], "answers": [{"comments": [{"owner": {"reputation": 159, "user_id": 6450586, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/20eed796d8d3400c9e498e4d6d2dd185?s=128&d=identicon&r=PG&f=1", "display_name": "DGP", "link": "https://stackoverflow.com/users/6450586/dgp"}, "edited": false, "score": 0, "creation_date": 1489848325, "post_id": 42868300, "comment_id": 72855621, "body": "Thanks Kev.  I have literally tested/debugged dozens of times with the Locals Window open.  The variables are not changing.  I am going to Re-Post a more limited Question now related just to the SUM issue.  I do appreciate you answering!"}], "tags": [], "owner": {"reputation": 100, "user_id": 7590602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5b4cc17151e86b979a84e64d11dc547?s=128&d=identicon&r=PG&f=1", "display_name": "Kev", "link": "https://stackoverflow.com/users/7590602/kev"}, "is_accepted": false, "score": 0, "last_activity_date": 1489791280, "creation_date": 1489791280, "answer_id": 42868300, "question_id": 42822111, "link": "https://stackoverflow.com/questions/42822111/excel-vba-issues-sum-ranges-values-etc/42868300#42868300", "title": "Excel VBA Issues - SUM, Ranges, Values, etc", "body": "<p>Since you have a line that works the first time and not the second time, the next step to take could be to add extra feedback within your code to check what the variables are doing that are getting passed to the line.</p>\n\n<pre><code>'Get SUM for Parameter Column\n\nstrSUMRange = strSUMColumn &amp; \"2:\" &amp; strSUMColumn &amp; intLastRow\n</code></pre>\n\n<p>Add this row</p>\n\n<pre><code>msgbox \"Variable Check: oXLsheet&gt; \" &amp;  oXLSheet &amp; \"strSUMRange&gt; \" &amp; strSUMRange\n</code></pre>\n\n<p>to see if the variables are changing unexpectedly between runs.</p>\n\n<pre><code>'This works once and then returns ZERO each time I run the SUB again?????\nvarSumExcelColumns = Excel.WorksheetFunction.Sum(oXLSheet.Range(strSUMRange))\n\nmsgbox \"SUM From Excel Worksheet: \" &amp; varSumExcelColumns\n</code></pre>\n"}], "owner": {"reputation": 159, "user_id": 6450586, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/20eed796d8d3400c9e498e4d6d2dd185?s=128&d=identicon&r=PG&f=1", "display_name": "DGP", "link": "https://stackoverflow.com/users/6450586/dgp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 232, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1489791280, "creation_date": 1489617830, "question_id": 42822111, "link": "https://stackoverflow.com/questions/42822111/excel-vba-issues-sum-ranges-values-etc", "title": "Excel VBA Issues - SUM, Ranges, Values, etc", "body": "<p>I have been using VBA within MS Access for years  and have some general VBA competence.  I now need to start using VBA within Excel and I am running into all sorts of problems.  I am sorry to bug you all, but I just cannot get this to work and I have spent over a day researching the web and carefully testing each option.</p>\n\n<p>Ultimately, I am trying to automate an Access import from Excel spreadsheets.  I think this is a fairly common objective and I think my plans for Excel VBA are pretty straightforward:</p>\n\n<p>1)  Get a record Count from the Spreadsheet (used to verify successful import)\n2)  Get a SUM of all Values in a specific column (also used to verify successful import)\n3)  Add a new Column to contain File Name s (Add Header and then Add a fixed value \u2013 file name \u2013 to each row with data)</p>\n\n<p>I don\u2019t know whether my problems are how I refer to Workbook/Worksheet/Cell/Range etc., or some other fundamental misunderstanding of VBA.</p>\n\n<p>What is also frustrating is the fact that the first time I run this, some parts DO work, but then they start failing with each subsequent run.\nI am using Access &amp; Excel 2010.</p>\n\n<p>I have lumped all of these processes into a single function for two reasons.  First, it makes testing easier.  Second, I cannot figure out how to create separate functions which would work on an open/active Spreadsheet. (So if you have insight on that I welcome that as well).</p>\n\n<p>The Code is pasted below and the comments include info re what works/doesn\u2019t work.</p>\n\n<p>Thank you very much for any insights into the problems with my code.</p>\n\n<p>DGP</p>\n\n<hr>\n\n<pre><code>Public Function fnProcessExcelDataImportFiles(strFileNameAndPath As String, strUseWorksheet As String, strSUMColumn As String,  strAddColumnLabel As String, varAddColumnFixedValue As Variant)\nOn Error GoTo HandleError\n\n'Variables\n\nDim strColumnCLabel As String\nDim varColumnCLabel As Variant\nDim intLastCol As Long\nDim intLastRow As Long\nDim intNextCol As Long\n\nDim intRecordCount As Long\nDim varSumExcelColumns As Variant\nDim strSUMRange As String\nDim strNewFixedValueInsteadofVARIANT As String\n\n\nDim oXLApp As Excel.Application       'Declare the object variables\nDim oXLBook As Excel.Workbook\nDim oXLSheet As Excel.Worksheet\n\nSet oXLApp = New Excel.Application      'Create a new instance of Excel\nSet oXLBook = oXLApp.Workbooks.Open(strFileNameAndPath) 'Open the existing workbook\nSet oXLSheet = oXLBook.Worksheets(1)  'Work with the first worksheet\n\n\n  oXLSheet.Activate                   'Activate the Worksheet\n  oXLApp.Visible = True               'Show it to the user\n  oXLApp.UserControl = True\n\n\n'For Testing:  Verify that function can read from Worksheet\n            \u2018THESE WORKED!!\n            varColumnCLabel = oXLSheet.Cells(1, 13).Value\n            strColumnCLabel = oXLSheet.Cells(1, 3).Value\n\n\n'Get Last Row &amp; Record Count \u2013 THIS WORKED\n\nintLastRow = oXLSheet.Cells.Find(\"*\", searchorder:=xlByRows, SearchDirection:=xlPrevious).Row\nintRecordCount = intLastRow - 1\n\n\n\n'Get SUM for Parameter Column\n\nstrSUMRange = strSUMColumn &amp; \"2:\" &amp; strSUMColumn &amp; intLastRow\n\n'This works once and then returns ZERO each time I run the SUB again?????\nvarSumExcelColumns = Excel.WorksheetFunction.Sum(oXLSheet.Range(strSUMRange))\n\n                msgbox \"SUM From Excel Worksheet: \" &amp; varSumExcelColumns\n\n'This works Once and then causes ERROR each time the SUB is subsequently run\n'varSumExcelColumns = Excel.WorksheetFunction.Sum(Range(\"M:M\")) 'This throws ERRORS when used more than once???\n\n                'msgbox \"SUM From Excel Worksheet: \" &amp; varSumExcelColumns\n\n' This also works only Once and then throws ERRORS??????\n'varSumExcelColumns = Excel.WorksheetFunction.Sum(Columns(13))\n                'msgbox \"SUM From Excel Worksheet: \" &amp; varSumExcelColumns\n\n'Get Last Column \u2013 THIS WORKS\nintLastCol = oXLSheet.Cells.Find(\"*\", searchorder:=xlByColumns, SearchDirection:=xlPrevious).Column\nintNextCol = intLastCol + 1\n\n'Add Label and Fixed Value Data to New Column\n\n\n\n\n oXLSheet.Cells(1, 13).Value = strAddColumnLabel  'This WORKS\n\noXLSheet.Cells(1, intNextCol).Value = strAddColumnLabel  \u2018THIS DOES NOT WORK\n\n ' This throws an ERROR\n 'oXLSheet.Range(Cells(2, intLastCol), Cells(intLastRow, intLastCol)).Value = varAddColumnFixedValue\n\n  ' This throws an ERROR also\n  'oXLSheet.Range(Cells(2, 23), Cells(17, 23)).Value = varAddColumnFixedValue\n\n    'This did NOT work\n    oXLSheet.Range(\"X3:X7\").Value = varAddColumnFixedValue\n\n    'Check to see if the Range did get updated  \n    strNewValue = oXLSheet.Range(\"x5\").Value\n    msgbox \"New Value = \" &amp; strNewValue             'strNewValue is EMPTY\n\n  strNewFixedValueInsteadofVARIANT = CStr(varAddColumnFixedValue)\n\n  'Does it work if I set the new value to a String instead of variant??\n  'NO - this does NOT work either\n  oXLSheet.Range(\"X3:X7\").Value = strNewFixedValueInsteadofVARIANT\n\n 'Check to see if the Range did get updated - It did NOT\n    strNewValue = oXLSheet.Range(\"x5\").Value\n    msgbox \"New Value = \" &amp; strNewValue  'strNewValue is EMPTY\n\nExit_label:\n\n    oXLBook.Close SaveChanges:=True    'Save (and disconnect from) the Workbook\n\n\n    oXLApp.Quit                         'Close (and disconnect from) Excel\n    Set oXLSheet = Nothing               'Disconnect from all Excel objects (let the user take over)\n    Set oXLBook = Nothing\n    Set oXLApp = Nothing\n\n    fnProcessExcelDataImportFiles = -777\n\nExit Function\n\nHandleError:\n    msgbox \"Error during fnProcessExcelDataImportFiles - \" &amp; Err.Description\n    Resume Exit_label\nEnd Function\n\n\n\nPublic Sub TestfnProcessExcelDataImportFiles()\n\nDim strFileNameAndPath As String\nDim strUseWorksheet As String\nDim intSUMColumn As Integer\nDim strSUMColumn As String\nDim strAddColumnLabel As String\nDim varAddColumnFixedValue As Variant\n\nDim dblSUMFromFunction As Double\n\nstrFileNameAndPath = \"C:\\Users\\xxxxxxxxxxxxx\\FileNamexxx_2Mar17.xlsx\"\nstrUseWorksheet = \"Sheet1\"\nintSUMColumn = 13\nstrSUMColumn = \"M\"\nstrAddColumnLabel = \"PleaseWork\"\nvarAddColumnFixedValiue = 333.33\n\n\ndblSUMFromFunction = fnProcessExcelDataImportFiles(strFileNameAndPath, strUseWorksheet, strSUMColumn, strAddColumnLabel, varAddColumnFixedValue)\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 1, "creation_date": 1489617955, "post_id": 42821632, "comment_id": 72755855, "body": "Before you can write any more code, you will need to decide if you want to delete a row if (a) the status column contains &quot;Complete&quot; OR the status name column contains &quot;Completed&quot; OR the status processes column contains &quot;Done&quot;, or (b) the status column contains &quot;Complete&quot; AND the status name column contains &quot;Completed&quot; AND the status processes column contains &quot;Done&quot;."}, {"owner": {"reputation": 305, "user_id": 7624245, "user_type": "registered", "accept_rate": 59, "profile_image": "https://graph.facebook.com/1340035062729998/picture?type=large", "display_name": "Defca Trick", "link": "https://stackoverflow.com/users/7624245/defca-trick"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1489618094, "post_id": 42821632, "comment_id": 72755908, "body": "So it would be easier to do this for 1 column name and 1 cell value ie: Status and Complete then another line for status name and completed and a third line for status process and done right? so that would simplify the code and the process?"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1489618461, "post_id": 42821632, "comment_id": 72756081, "body": "It would be <b>marginally</b> simpler to do it for one value - it would save thinking about whether you want all the values to match or any value to match.  But if you are willing to just check one column for its value then you probably have <b>already</b> decided that you want the row deleted if <b>any</b> value matches."}, {"owner": {"reputation": 305, "user_id": 7624245, "user_type": "registered", "accept_rate": 59, "profile_image": "https://graph.facebook.com/1340035062729998/picture?type=large", "display_name": "Defca Trick", "link": "https://stackoverflow.com/users/7624245/defca-trick"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1489618713, "post_id": 42821632, "comment_id": 72756184, "body": "And it can be 1 column for multiple values? so Status I want to remove Complete and Pending -- Then once all of those are deleted I can select Status Name and Completed and Pending etc. so in that case I just need it to look for a certain column, then look for an array of values and delete the entire row if any of those values exist right? - also ty for editing my post, sorry if it was not clear enough!"}], "answers": [{"comments": [{"owner": {"reputation": 305, "user_id": 7624245, "user_type": "registered", "accept_rate": 59, "profile_image": "https://graph.facebook.com/1340035062729998/picture?type=large", "display_name": "Defca Trick", "link": "https://stackoverflow.com/users/7624245/defca-trick"}, "edited": false, "score": 0, "creation_date": 1489624830, "post_id": 42823238, "comment_id": 72758073, "body": "Hello, to make sure I understand as this is very far above me right now.. so what you are saying is this will delete any combination of &quot;status -Complete&quot; &quot;status - Pending&quot; &quot;status - Completed&quot; &quot;Status - Done&quot;  AND &quot;status name -Complete&quot; &quot;status name - Pending&quot; &quot;status name - Completed&quot; &quot;Status - Done&quot;  AND &quot;Status Processes -Complete&quot; &quot;Status Processes - Pending&quot; &quot;Status Processes - Completed&quot; &quot;Status Processes - Done&quot;  is that right?"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 305, "user_id": 7624245, "user_type": "registered", "accept_rate": 59, "profile_image": "https://graph.facebook.com/1340035062729998/picture?type=large", "display_name": "Defca Trick", "link": "https://stackoverflow.com/users/7624245/defca-trick"}, "edited": false, "score": 0, "creation_date": 1489628338, "post_id": 42823238, "comment_id": 72758901, "body": "No, it will first process the &quot;status&quot; column and delete any rows containing either &quot;Complete&quot; or &quot;Pending&quot; (due to the <code>Array(&quot;Complete&quot;, &quot;Pending&quot;)</code>), then it will go through the &quot;Status Name&quot; column and delete any rows containing &quot;Completed&quot; or &quot;Pending&quot; (due to the <code>Array(&quot;Completed&quot;, &quot;Pending&quot;)</code>), then it will go through the &quot;Status Processes&quot; column and delete any rows containing done (due to the <code>Array(&quot;Done&quot;)</code>).  So each <code>Array(...)</code> within the <code>vDELROWS</code> Array corresponds to the equivalent column in the <code>vDELCOLS</code> Array."}, {"owner": {"reputation": 305, "user_id": 7624245, "user_type": "registered", "accept_rate": 59, "profile_image": "https://graph.facebook.com/1340035062729998/picture?type=large", "display_name": "Defca Trick", "link": "https://stackoverflow.com/users/7624245/defca-trick"}, "edited": false, "score": 0, "creation_date": 1489671793, "post_id": 42823238, "comment_id": 72780762, "body": "makes sense! and it is perfect, ty so much"}], "tags": [], "owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "is_accepted": true, "score": 1, "last_activity_date": 1489624180, "creation_date": 1489624180, "answer_id": 42823238, "question_id": 42821632, "link": "https://stackoverflow.com/questions/42821632/excel-vba-macro-to-delete-entire-row-based-on-column-header/42823238#42823238", "title": "Excel Vba Macro to Delete Entire Row Based on Column Header", "body": "<p>The following code will take an array of arrays as <code>vDELROWS</code> and will delete a row if any of the values match what is in the corresponding column.</p>\n\n<pre><code>Sub Delete_Rows_Based_On_Header_and_Value()\n    '\n    ' Delete_Rows_Based_On_Header_and_Value Macro\n    '\n    ' Declaration\n    Dim a As Long\n    Dim w As Long\n    Dim vDELCOLs As Variant\n    Dim vCOLNDX As Variant\n    Dim vDELROWs As Variant\n    Dim vROWNDX As Variant\n    Dim r As Long\n    Dim v As Long\n\n    vDELCOLs = Array(\"status\", \"Status Name\", \"Status Processes\")\n    vDELROWs = Array(Array(\"Complete\", \"Pending\"), Array(\"Completed\", \"Pending\"), Array(\"Done\"))\n\n    With ActiveWorkbook\n        For w = 1 To .Worksheets.Count\n            With Worksheets(w)\n                For a = LBound(vDELCOLs) To UBound(vDELCOLs)\n                    vCOLNDX = Application.Match(vDELCOLs(a), .Rows(1), 0)\n                    If Not IsError(vCOLNDX) Then\n                        For r = .Cells(.Rows.Count, vCOLNDX).End(xlUp).Row To 1 Step -1\n                            For v = LBound(vDELROWs(a)) To UBound(vDELROWs(a))\n                                If .Cells(r, vCOLNDX).Value = vDELROWs(a)(v) Then\n                                    .Rows(r).EntireRow.Delete\n                                    Exit For\n                                End If\n                            Next\n                        Next\n                    End If\n                Next a\n            End With\n        Next w\n    End With\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 26, "user_id": 7687219, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de604965720a8343d1883e4f9f0572db?s=128&d=identicon&r=PG&f=1", "display_name": "DougLSchneider", "link": "https://stackoverflow.com/users/7687219/douglschneider"}, "is_accepted": false, "score": 0, "last_activity_date": 1489674879, "creation_date": 1489674879, "answer_id": 42837058, "question_id": 42821632, "link": "https://stackoverflow.com/questions/42821632/excel-vba-macro-to-delete-entire-row-based-on-column-header/42837058#42837058", "title": "Excel Vba Macro to Delete Entire Row Based on Column Header", "body": "<p>Autofilter is more efficient than looping</p>\n\n<pre><code>Sub DeleteRows()\n    Sheet1.Range(\"a1:c35\").AutoFilter Field:=2, Criteria1:=\"Completed\"\n    Sheet1.UsedRange.Offset(1, 0).SpecialCells(xlCellTypeVisible).EntireRow.Delete\nSheet1.UsedRange.AutoFilter\n'repeat for each value\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 305, "user_id": 7624245, "user_type": "registered", "accept_rate": 59, "profile_image": "https://graph.facebook.com/1340035062729998/picture?type=large", "display_name": "Defca Trick", "link": "https://stackoverflow.com/users/7624245/defca-trick"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 862, "favorite_count": 0, "accepted_answer_id": 42823238, "answer_count": 2, "score": 0, "last_activity_date": 1489674879, "creation_date": 1489615794, "last_edit_date": 1489618047, "question_id": 42821632, "link": "https://stackoverflow.com/questions/42821632/excel-vba-macro-to-delete-entire-row-based-on-column-header", "title": "Excel Vba Macro to Delete Entire Row Based on Column Header", "body": "<p>Would the below code be able to be modified to</p>\n\n<ol>\n<li>remove multiple rows based on column headers and cell values, and</li>\n<li>do this for multiple column row combinations?</li>\n</ol>\n\n<p>example: Column \"Status\" Value \"Complete\"\nCycle through all sheets and look for any header that says status and delete all rows where status has a complete in it? </p>\n\n<pre><code>Sub Delete_Rows_Based_On_Header_and_Value ()\n'\n' Delete_Rows_Based_On_Header_and_Value Macro\n'\n' Declaration\nDim a as long\nDim w as long\nDim vDELCOLs as variant\nDim vCOLNDX as variant\nDim vDELROWs as variant\nDim vROWNDX as variant\n\nvDELCOLs = array(\"status\",\"Status Name\",\"Status Processes\")\nvDELROWs = array(\"Complete\",\"Completed\",\"Done\")\n\nwith Activeworkbook\n    for w=1 to .worksheets.count\n        with worksheets(w)\n' I know this part is to delete columns based on the column name and I am not sure how to modify it to just check column name then delete row based on the value on that column only.\n            for a=lbound(vdelcols) to ubound(vdelcols)\n                vcolndx=application.match(vdelcols(a), .rows(1), 0)\n                if not iserror(vcolndx) then\n                    .columns(vcolndx).entirecolumn.delete\n                end if\n            next a\n        end with\n    next w\nend with\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1489616727, "post_id": 42821594, "comment_id": 72755359, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/q/18232987/11683\">Export pictures from excel file into jpg using VBA</a>"}, {"owner": {"reputation": 1383, "user_id": 5981533, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/688353da6deb0ac1d22eb9d42e032269?s=128&d=identicon&r=PG", "display_name": "Amorpheuses", "link": "https://stackoverflow.com/users/5981533/amorpheuses"}, "edited": false, "score": 1, "creation_date": 1489623659, "post_id": 42821594, "comment_id": 72757752, "body": "Looks like you use &#39;desFolder&#39; twice: once in shpName and again when you specify the &#39;Filename&#39; property in the SaveAs command.  Also you should have a backslash at the end of the destFolder string when you define it."}], "owner": {"reputation": 223, "user_id": 7039125, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/805dafea7a1ec52382acdefd6636b847?s=128&d=identicon&r=PG&f=1", "display_name": "BH57", "link": "https://stackoverflow.com/users/7039125/bh57"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 4075, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1489615865, "creation_date": 1489615658, "last_edit_date": 1489615865, "question_id": 42821594, "link": "https://stackoverflow.com/questions/42821594/how-to-save-images-from-an-excel-file-using-vba", "title": "How to save images from an Excel file using VBA?", "body": "<p>I have an Excel file that contains a column with images that correspond to distinct unique IDs. Basically, through VBA, I want to loop through each image and save it with its name being the unique ID.</p>\n\n<p>I realize you cannot save an image in Excel itself, so I found this VBA code online (found below) that copies the image into PowerPoint and saves it there, but it is not working for me. I am working with Excel 2016, 64 bit.</p>\n\n<p>Any suggestions?</p>\n\n<pre><code>Sub SaveImages()\n    'the location to save all the images\n    Const destFolder = \"C:\\Desktop\\Images\"\n\n    Dim ws As Worksheet\n    Set ws = ThisWorkbook.Worksheets(\"data\")\n\n    Dim ppt As Object, ps As Variant, slide As Variant\n\n    Set ppt = CreateObject(\"PowerPoint.application\")\n    Set ps = ppt.presentations.Add\n    Set slide = ps.slides.Add(1, 1)\n\n    Dim shp As Shape, shpName\n    For Each shp In ws.Shapes\n        shpName = destFolder &amp; shp.TopLeftCell.Offset(0, 1) &amp; \".png\"\n        shp.Copy\n        With slide\n            .Shapes.Paste\n            'This is the point where the code breaks, when I try to save\n            .Shapes.SaveAs Filename:=destFolder &amp; shpName\n            .Shapes(.Shapes.Count).Delete\n        End With\n    Next shp\n\n    With ps\n        .Saved = True\n        .Close\n    End With\n    ppt.Quit\n    Set ppt = Nothing\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 11381, "user_id": 2859347, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/00bC9.png?s=128&g=1", "display_name": "CallumDA", "link": "https://stackoverflow.com/users/2859347/callumda"}, "edited": false, "score": 0, "creation_date": 1489615226, "post_id": 42821416, "comment_id": 72754675, "body": "This error seems to have more to do with compatibility between versions of Excel (from a very brief search). Search this site with your error as the search term and you will see a number of different possible causes &amp; solutions"}, {"owner": {"reputation": 11381, "user_id": 2859347, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/00bC9.png?s=128&g=1", "display_name": "CallumDA", "link": "https://stackoverflow.com/users/2859347/callumda"}, "edited": false, "score": 0, "creation_date": 1489615433, "post_id": 42821416, "comment_id": 72754781, "body": "So what have you tried/ eliminated? I&#39;ll warn you though, it might be difficult for us to help if it seemingly has little to do with the code (as per the other solutions!)"}, {"owner": {"reputation": 11381, "user_id": 2859347, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/00bC9.png?s=128&g=1", "display_name": "CallumDA", "link": "https://stackoverflow.com/users/2859347/callumda"}, "edited": false, "score": 0, "creation_date": 1489615978, "post_id": 42821416, "comment_id": 72755039, "body": "Which version of Excel are you using? Also, I&#39;d advise posting the rest of your code"}, {"owner": {"reputation": 1396, "user_id": 4691433, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/bce001c90ad26add5d7483b714640c12?s=128&d=identicon&r=PG&f=1", "display_name": "puzzlepiece87", "link": "https://stackoverflow.com/users/4691433/puzzlepiece87"}, "reply_to_user": {"reputation": 11381, "user_id": 2859347, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/00bC9.png?s=128&g=1", "display_name": "CallumDA", "link": "https://stackoverflow.com/users/2859347/callumda"}, "edited": false, "score": 0, "creation_date": 1489616664, "post_id": 42821416, "comment_id": 72755327, "body": "@CallumDA Good question. I&#39;m using Office Professional Plus 2013/Excel 2013 on Windows 7 Enterprise. I edited the complete module into my question."}, {"owner": {"reputation": 1396, "user_id": 4691433, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/bce001c90ad26add5d7483b714640c12?s=128&d=identicon&r=PG&f=1", "display_name": "puzzlepiece87", "link": "https://stackoverflow.com/users/4691433/puzzlepiece87"}, "reply_to_user": {"reputation": 11381, "user_id": 2859347, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/00bC9.png?s=128&g=1", "display_name": "CallumDA", "link": "https://stackoverflow.com/users/2859347/callumda"}, "edited": false, "score": 0, "creation_date": 1489618329, "post_id": 42821416, "comment_id": 72756022, "body": "@CallumDA I just found out that original error was occurring because <code>Toggle_ErrorPrevention</code> was running successfully the first time, but then calling attempting to call <code>Toggle_Click</code> via the <code>.OnAction</code> lines in <code>Toggle_ErrorPrevention</code> did not update the <code>Application.Caller</code> in <code>Toggle_Click</code>. What I&#39;m trying to do is turn off Option 1 if someone turns on Option 2 or 3 and vice versa because they&#39;re not compatible. Is it possible to run a second, and this may be the wrong word, instance of <code>Toggle_Click</code> while the first instance is still mid-execution?"}, {"owner": {"reputation": 11381, "user_id": 2859347, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/00bC9.png?s=128&g=1", "display_name": "CallumDA", "link": "https://stackoverflow.com/users/2859347/callumda"}, "edited": false, "score": 1, "creation_date": 1489618520, "post_id": 42821416, "comment_id": 72756107, "body": "From what I understand, that doesn&#39;t sound possible. It might be worth explaining the new issue in a new question - but include screenshots of what you are trying to achieve. It sounds like a bit of refactoring might be necessary"}, {"owner": {"reputation": 1396, "user_id": 4691433, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/bce001c90ad26add5d7483b714640c12?s=128&d=identicon&r=PG&f=1", "display_name": "puzzlepiece87", "link": "https://stackoverflow.com/users/4691433/puzzlepiece87"}, "reply_to_user": {"reputation": 11381, "user_id": 2859347, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/00bC9.png?s=128&g=1", "display_name": "CallumDA", "link": "https://stackoverflow.com/users/2859347/callumda"}, "edited": false, "score": 0, "creation_date": 1489618605, "post_id": 42821416, "comment_id": 72756147, "body": "@CallumDA If I originally start <code>Toggle_Click</code> by clicking Option 2 while Option 1 is already on, it successfully sees that Option 1 is already on and triggers <code>Toggle_ErrorPrevention</code>. Then <code>Toggle_ErrorPrevention</code> triggers <code>Toggle_Click</code> programatically so Option 1 can be turned off. I try to have the new <code>Application.Caller</code> be registered as Option 1 (so it can be turned off), but Excel shows it as Option 2 even though it is run successfully from a line that equates to <code>.Shapes(Option 1).OnAction</code>"}, {"owner": {"reputation": 11381, "user_id": 2859347, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/00bC9.png?s=128&g=1", "display_name": "CallumDA", "link": "https://stackoverflow.com/users/2859347/callumda"}, "edited": false, "score": 1, "creation_date": 1489619295, "post_id": 42821416, "comment_id": 72756411, "body": "Hey, I&#39;ve tried to understand the ins and outs of your code but it really is difficult without seeing your workbook/ playing around with the file myself. Using <code>Application.Caller</code> isn&#39;t usually a good way to pass arguments to your routines (I wouldn&#39;t want to suggest a better way without seeing your setup). I imagine a bit of refactoring would be the way to go if you can&#39;t work out a fix. Apologies I can&#39;t be more help :("}, {"owner": {"reputation": 1396, "user_id": 4691433, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/bce001c90ad26add5d7483b714640c12?s=128&d=identicon&r=PG&f=1", "display_name": "puzzlepiece87", "link": "https://stackoverflow.com/users/4691433/puzzlepiece87"}, "reply_to_user": {"reputation": 11381, "user_id": 2859347, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/00bC9.png?s=128&g=1", "display_name": "CallumDA", "link": "https://stackoverflow.com/users/2859347/callumda"}, "edited": false, "score": 0, "creation_date": 1489619436, "post_id": 42821416, "comment_id": 72756467, "body": "@CallumDA That&#39;s okay! I&#39;m sorry my code is messy - I&#39;m working hard to become more professional but I still have several bad habits. I&#39;m going to take this feedback you just gave me to add comments to the code in the new question I just asked to try to make things clearer."}], "answers": [{"comments": [{"owner": {"reputation": 1396, "user_id": 4691433, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/bce001c90ad26add5d7483b714640c12?s=128&d=identicon&r=PG&f=1", "display_name": "puzzlepiece87", "link": "https://stackoverflow.com/users/4691433/puzzlepiece87"}, "edited": false, "score": 0, "creation_date": 1489617154, "post_id": 42821871, "comment_id": 72755530, "body": "The longshot worked, thank you. I had seen warnings on other questions to make sure everything was properly qualified to prevent this error, so I tried making sure that my line was fully, <i>fully</i> qualified by using <code>lngHLSegmentNumberingRow = ThisWorkbook.Sheets(&quot;Correction Type Options&quot;).Columns(1).Find(What:=&quot;HL Segment Numbering&quot;, Lookat:=xlWhole).Row</code>, but that didn&#39;t work. For whatever reason, saving it to an object first works. Thanks again."}, {"owner": {"reputation": 11381, "user_id": 2859347, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/00bC9.png?s=128&g=1", "display_name": "CallumDA", "link": "https://stackoverflow.com/users/2859347/callumda"}, "reply_to_user": {"reputation": 1396, "user_id": 4691433, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/bce001c90ad26add5d7483b714640c12?s=128&d=identicon&r=PG&f=1", "display_name": "puzzlepiece87", "link": "https://stackoverflow.com/users/4691433/puzzlepiece87"}, "edited": false, "score": 0, "creation_date": 1489617586, "post_id": 42821871, "comment_id": 72755696, "body": "@puzzlepiece87 you were absolutely right to <i>fully, fully</i> qualify any reference to a workbook/worksheet/range etc. Keep doing that in the future and you&#39;ll save yourself from a lot of potential errors. The main thing here is recognising that <code>.Find</code> returns either a <code>Range</code> (if it finds something) or <code>Nothing</code> (if it doesn&#39;t find anything). You can&#39;t perform <code>.Row</code> to <code>Nothing</code> so you have to check for that first. This is a useful thing to remember for any method that returns a range object."}], "tags": [], "owner": {"reputation": 11381, "user_id": 2859347, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/00bC9.png?s=128&g=1", "display_name": "CallumDA", "link": "https://stackoverflow.com/users/2859347/callumda"}, "is_accepted": true, "score": 2, "last_activity_date": 1489617116, "last_edit_date": 1489617116, "creation_date": 1489616776, "answer_id": 42821871, "question_id": 42821416, "link": "https://stackoverflow.com/questions/42821416/automation-error-the-object-invoked-has-disconnected-from-its-clients-when-c/42821871#42821871", "title": "&quot;Automation error: The object invoked has disconnected from its clients.&quot; when calling from another sub", "body": "<p><em>Disclaimer: I realise this is a long shot...</em></p>\n\n<p>This error seems to pop up at unusual times and one (semi) recurring solution is to deal with objects in the best way possible. So try this:</p>\n\n<pre><code>Sub Toggle_ErrorPrevention(ByVal intShapeNumberVal As Integer)\n\n    Dim findRange As Range\n    Dim lngHLSegmentNumberingRow As Long\n    'more declarations\n\n    Set findRange = ThisWorkbook.Sheets(\"Correction Type Options\").Columns(1).Find(What:=\"HL Segment Numbering\", Lookat:=xlWhole)\n\n    If Not rng Is Nothing Then\n        lngHLSegmentNumberingRow = findRange.Row\n    End If\n\n    'other code...\nEnd Sub\n</code></pre>\n\n<p>You would have got <em>an error</em> if <code>.Find</code> returned nothing, because you can't get the <code>Row</code> property of <code>Nothing</code>.</p>\n"}], "owner": {"reputation": 1396, "user_id": 4691433, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/bce001c90ad26add5d7483b714640c12?s=128&d=identicon&r=PG&f=1", "display_name": "puzzlepiece87", "link": "https://stackoverflow.com/users/4691433/puzzlepiece87"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1807, "favorite_count": 0, "accepted_answer_id": 42821871, "answer_count": 1, "score": 2, "last_activity_date": 1489618057, "creation_date": 1489614889, "last_edit_date": 1489618057, "question_id": 42821416, "link": "https://stackoverflow.com/questions/42821416/automation-error-the-object-invoked-has-disconnected-from-its-clients-when-c", "title": "&quot;Automation error: The object invoked has disconnected from its clients.&quot; when calling from another sub", "body": "<p>After reading through many questions with this same title, I am still struggling to prevent the error in the title from occurring when my code runs.</p>\n\n<p>The code begins here:</p>\n\n<pre><code>Option Explicit\n\nSub Toggle_Click()\n\n    Dim lngMoveBy As Long\n    Dim Loop1 As Long\n    Dim intShapeNumber As Integer\n\n    intShapeNumber = Right(Application.Caller, Len(Application.Caller) - Len(\"Toggle\"))\n    If ThisWorkbook.Sheets(\"Correction Type Options\").Shapes(\"ToggleBackground\" &amp; intShapeNumber).Fill.ForeColor.RGB = RGB(255, 255, 255) Then Toggle_ErrorPrevention intShapeNumber\n</code></pre>\n\n<p>Then moves to this Sub in the same module:</p>\n\n<pre><code>Sub Toggle_ErrorPrevention(ByVal intShapeNumberVal As Integer)\n\n    Dim lngHLSegmentNumberingRow As Long\n    Dim lngClaimRemovalHaveWantedClaimsRow As Long\n    Dim lngClaimRemovalHaveUnwantedClaimsRow As Long\n\n\n    With ThisWorkbook.Sheets(\"Correction Type Options\").Columns(1)\n        lngHLSegmentNumberingRow = .Find(What:=\"HL Segment Numbering\", Lookat:=xlWhole).Row\n</code></pre>\n\n<p>before failing on the final line above, <code>lngHLSegmentNumberingRow = .Find(What:=\"HL Segment Numbering\", Lookat:=xlWhole).Row</code>, with \"Automation error: The object invoked has disconnected from its clients.\"</p>\n\n<p>If I save and close the document after the error occurs and restart it, Column 1 on the \"Correction Type Options\" sheet is highlighted.</p>\n\n<p>This is my first time calling subs from other subs, so I've been paying extra attention to the call itself as a potential source of the problem. I'm still not confident it's correct.</p>\n\n<hr>\n\n<p>Here is the complete module, in case it helps:</p>\n\n<pre><code>Option Explicit\n\nSub Toggle_Click()\n\n    Dim lngMoveBy As Long\n    Dim Loop1 As Long\n    Dim intShapeNumber As Integer\n\n    intShapeNumber = Right(Application.Caller, Len(Application.Caller) - Len(\"Toggle\"))\n    If ThisWorkbook.Sheets(\"Correction Type Options\").Shapes(\"ToggleBackground\" &amp; intShapeNumber).Fill.ForeColor.RGB = RGB(255, 255, 255) Then Toggle_ErrorPrevention intShapeNumber\n\n    If ThisWorkbook.Sheets(\"Correction Type Options\").Shapes(\"ToggleBackground\" &amp; intShapeNumber).Fill.ForeColor.RGB = RGB(255, 255, 255) Then\n        lngMoveBy = 0.6\n    Else\n        lngMoveBy = -0.6\n    End If\n\n    With ThisWorkbook.Sheets(\"Correction Type Options\").Shapes(\"Toggle\" &amp; intShapeNumber)\n        For Loop1 = 1 To 24\n            .IncrementLeft lngMoveBy\n            DoEvents\n        Next Loop1\n    End With\n\n    If ThisWorkbook.Sheets(\"Correction Type Options\").Shapes(\"ToggleBackground\" &amp; intShapeNumber).Fill.ForeColor.RGB = RGB(255, 255, 255) Then\n        With ThisWorkbook.Sheets(\"Correction Type Options\").Shapes(\"ToggleBackground\" &amp; intShapeNumber)\n            .Fill.ForeColor.RGB = RGB(0, 255, 0)\n            .TextFrame.Characters.Text = \"On\"\n            .TextFrame.Characters.Font.Bold = True\n            .TextFrame.Characters.Font.ColorIndex = 1\n            .TextFrame.HorizontalAlignment = xlLeft\n            .TextFrame.VerticalAlignment = xlCenter\n        End With\n    Else\n        With ThisWorkbook.Sheets(\"Correction Type Options\").Shapes(\"ToggleBackground\" &amp; intShapeNumber)\n            .Fill.ForeColor.RGB = RGB(255, 255, 255)\n            .TextFrame.Characters.Text = \"Off\"\n            .TextFrame.Characters.Font.Bold = True\n            .TextFrame.Characters.Font.ColorIndex = 1\n            .TextFrame.HorizontalAlignment = xlRight\n            .TextFrame.VerticalAlignment = xlCenter\n        End With\n    End If\n\nEnd Sub\n\nSub Toggle_ErrorPrevention(ByVal intShapeNumberVal As Integer)\n\n    Dim lngHLSegmentNumberingRow As Long\n    Dim lngClaimRemovalHaveWantedClaimsRow As Long\n    Dim lngClaimRemovalHaveUnwantedClaimsRow As Long\n\n\n    With ThisWorkbook.Sheets(\"Correction Type Options\").Columns(1)\n        lngHLSegmentNumberingRow = .Find(What:=\"HL Segment Numbering\", Lookat:=xlWhole).Row\n        lngClaimRemovalHaveWantedClaimsRow = .Find(What:=\"Claim Removal - Have Wanted Claims\", Lookat:=xlWhole).Row\n        lngClaimRemovalHaveUnwantedClaimsRow = .Find(What:=\"Claim Removal - Have Unwanted Claims\", Lookat:=xlWhole).Row\n    End With\n\n    With ThisWorkbook.Sheets(\"Correction Type Options\")\n        If intShapeNumberVal + 1 = lngHLSegmentNumberingRow Then\n            If .Shapes(\"ToggleBackground\" &amp; lngClaimRemovalHaveWantedClaimsRow - 1).Fill.ForeColor.RGB = RGB(0, 255, 0) Then Application.Run .Shapes(\"Toggle\" &amp; lngClaimRemovalHaveWantedClaimsRow - 1).OnAction\n            If .Shapes(\"ToggleBackground\" &amp; lngClaimRemovalHaveUnwantedClaimsRow - 1).Fill.ForeColor.RGB = RGB(0, 255, 0) Then Application.Run .Shapes(\"Toggle\" &amp; lngClaimRemovalHaveUnwantedClaimsRow - 1).OnAction\n        End If\n        If intShapeNumberVal + 1 = lngClaimRemovalHaveWantedClaimsRow Then\n            If .Shapes(\"ToggleBackground\" &amp; lngHLSegmentNumberingRow - 1).Fill.ForeColor.RGB = RGB(0, 255, 0) Then Application.Run .Shapes(\"Toggle\" &amp; lngHLSegmentNumberingRow - 1).OnAction\n        End If\n        If intShapeNumberVal + 1 = lngClaimRemovalHaveUnwantedClaimsRow Then\n            If .Shapes(\"ToggleBackground\" &amp; lngHLSegmentNumberingRow - 1).Fill.ForeColor.RGB = RGB(0, 255, 0) Then Application.Run .Shapes(\"Toggle\" &amp; lngHLSegmentNumberingRow - 1).OnAction\n        End If\n    End With\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "getelementsbytagname"], "comments": [{"owner": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "edited": false, "score": 0, "creation_date": 1489623035, "post_id": 42821409, "comment_id": 72757612, "body": "I can&#39;t copy this into a module because of the poor formatting.  So passing on this until formatting fixed."}, {"owner": {"reputation": 31, "user_id": 5386525, "user_type": "registered", "profile_image": "https://graph.facebook.com/992355340809408/picture?type=large", "display_name": "Stephen Karas", "link": "https://stackoverflow.com/users/5386525/stephen-karas"}, "reply_to_user": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "edited": false, "score": 0, "creation_date": 1489758135, "post_id": 42821409, "comment_id": 72824302, "body": "I understand.  I was able to find the TagName &lt;Select&gt; when using an instance of Internet Explorer but when I used xmlhttprequest the TagName &lt;Select&gt; was not present.  I could use this IE method but it is so slow."}, {"owner": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "edited": false, "score": 0, "creation_date": 1489759251, "post_id": 42821409, "comment_id": 72825100, "body": "EDITED: I have added tabs to code block because VBA labels don&#39;t indent in VBA IDE.    Still does not compile because of Create12ExpirationDates() not given."}, {"owner": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "edited": false, "score": 0, "creation_date": 1489759616, "post_id": 42821409, "comment_id": 72825362, "body": "Also [Symbol] looks like a defined named range.  You need to tell us the contents of a range defined as Symbol.  Please open a new workbook and copy over as much as is required to get it to compile."}, {"owner": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "edited": false, "score": 0, "creation_date": 1489765372, "post_id": 42821409, "comment_id": 72829501, "body": "OK, I can see that the HTML is different when in a browser and when using XHR.  This suggests the page is created dynamically.  Indeed one can see in the HTML the attribute data-reactid on the nodes which indicates it is written using React.js.  See SO <a href=\"http://stackoverflow.com/questions/17585787/whats-data-reactid-attribute-in-html\" title=\"whats data reactid attribute in html\">stackoverflow.com/questions/17585787/&hellip;</a>"}], "owner": {"reputation": 31, "user_id": 5386525, "user_type": "registered", "profile_image": "https://graph.facebook.com/992355340809408/picture?type=large", "display_name": "Stephen Karas", "link": "https://stackoverflow.com/users/5386525/stephen-karas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 406, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1489759230, "creation_date": 1489614871, "last_edit_date": 1489759230, "question_id": 42821409, "link": "https://stackoverflow.com/questions/42821409/msxml2-xmlhttp-getelementsbytagname-no-longer-working-on-webpage", "title": "MSXML2.XMLHTTP GetElementsbyTagName no longer working on webpage", "body": "<p>The following code has been working for the past 140 days, but 5 days ago it stopped.  The code (poorly written \"raccoon style\") scrapes daily option sheets from yahoo finance.  I have an array of stock symbols that are fed one by one into yahoo.  The first web request pulls up the initial option page, which is turned into an htmlfile.  I pull the option expiration dates out of the htmlfile using getElementsByTagName(\"select\") and creating an object.  If object.Item.childNodes.Length&lt;>0 then it loads the childnode values into an array which is then used to create the URL to pull the monthly expirations option sheets.</p>\n\n<p>When I open the webpage with inspect element (Chrome) the \n\n<pre><code>Sub HTML_Table_To_Excel()\n        Dim htm As Object, temp As Variant, r As Long, s As Variant, t As Long, vDate As Variant, d As Long, ldate As Long, web_url As String\n        Dim obTable As Object, aitemp() As Variant, aiExpDates() As String, lTab As Long, start As Long, sstop As Long, elapsed As Long, z As Long, vwebpage As Object\n        Dim html_content As Object, lmatch As Long, http As Object, e As Long, hits As Long\n        Application.ScreenUpdating = False\n        ReDim aiExpDates(11)\n        aiExpDates() = Create12ExpirationDates()\n        start = Timer\n        hits = 0\n        temp = [Symbol].Value\n\n\n        'LBound(temp, 1)\n        For r = LBound(temp, 1) To UBound(temp, 1)\n\n         ReDim aitemp(10, 0)\n         z = 0\n       d = 0\n       e = 0\n        web_url = \"http://finance.yahoo.com/quote/\" &amp; temp(r, 1) &amp; \"/options?p=\" &amp; temp(r, 1)\n\n        'Create HTMLFile Object\n        Set html_content = CreateObject(\"htmlfile\")\n\n            'Get the WebPage Content to HTMLFile Object\n        Set http = CreateObject(\"msxml2.xmlhttp\")\n        With http\n            .Open \"GET\", web_url, False\n            .Send\n    '         While Not .readyState = 4\n     '           Sleep (500)\n      '      Wend\n\n            html_content.body.innerHTML = .ResponseText\n\n\n        End With\ncheckpageload:\n    hits = hits + 1\n\n            On Error Resume Next\n            Set vwebpage = html_content.getElementsByTagName(\"select\")\n            If vwebpage.Item.ChildNodes.Length = 0 Then\n            Set html_content = Nothing\n         Set http = Nothing\n         Set html_content = CreateObject(\"htmlfile\")\n        Set http = CreateObject(\"msxml2.xmlhttp\")\n            With http\n            .Open \"GET\", web_url, False\n            .Send\n    '         While Not .readyState = 4\n     '           Sleep (500)\n      '      Wend\n            html_content.body.innerHTML = .ResponseText\n            End With\n           d = d + 1\n                 If d = 10 Then\n                GoTo continue\n                End If\n            GoTo checkpageload\n            End If\n            hits = hits + 1\n            ReDim vDate(vwebpage.Item.ChildNodes.Length - 1)\n            For Each obTable In vwebpage.Item.ChildNodes\n              lmatch = 0\n\n            lmatch = Application.WorksheetFunction.Match(obTable.Value, aiExpDates(), 0)\n                If lmatch &lt;&gt; 0 Then\n                    vDate(z) = obTable.Value\n                    z = z + 1\n                End If\n\n            Next obTable\n            ReDim Preserve vDate(z - 1)\n            z = 0\n            On Error GoTo 0\n      For ldate = LBound(vDate) To UBound(vDate)\n        web_url = \"http://finance.yahoo.com/quote/\" &amp; temp(r, 1) &amp; \"/options?p=\" &amp; temp(r, 1) &amp; \"&amp;date=\" &amp; vDate(ldate)\n     hits = hits + 1\n        'Create HTMLFile Object\n        Set html_content = CreateObject(\"htmlfile\")\n        Set http = CreateObject(\"msxml2.xmlhttp\")\n     With http\n            .Open \"GET\", web_url, False\n            .Send\n    '         While Not .readyState = 4\n     '           Sleep (500)\n      '      Wend\n            html_content.body.innerHTML = .ResponseText\n     End With\n\ntest:\n        If html_content.getElementsByTagName(\"tbody\").Length &lt; 2 Then\n       ' MsgBox \"the page did not load\"\n         Set html_content = Nothing\n         Set http = Nothing\n         Set html_content = CreateObject(\"htmlfile\")\n        Set http = CreateObject(\"msxml2.xmlhttp\")\n        With http\n            .Open \"GET\", web_url, False\n            .Send\n    '         While Not .readyState = 4                               '&lt;---------- wait\n     '           Sleep (500)\n      '      Wend\n            html_content.body.innerHTML = .ResponseText\n        End With\n        d = d + 1\n        If d = 10 Then\n            GoTo continue\n           End If\n        GoTo test\n\n           End If\n       Set obTable = html_content.getElementsByTagName(\"tbody\")\n\n\n\n      For s = 0 To obTable(1).Rows.Length - 1\n      For t = 0 To obTable(1).Rows(0).Cells.Length - 1\n\n       aitemp(t, e) = obTable(1).Rows(s).Cells(t).innerText\n\n        Next t\n        aitemp(10, e) = Date - 1\n\n        e = e + 1\n        ReDim Preserve aitemp(UBound(aitemp, 1), UBound(aitemp, 2) + 1)\n    Next s\n\n    If obTable.Length = 3 Then\n         s = 0: t = 0\n        For s = 0 To obTable(2).Rows.Length - 1\n        For t = 0 To obTable(2).Rows(0).Cells.Length - 1\n\n       aitemp(t, e) = obTable(2).Rows(s).Cells(t).innerText\n\n        Next t\n        aitemp(10, e) = Date - 1\n        e = e + 1\n        ReDim Preserve aitemp(UBound(aitemp, 1), UBound(aitemp, 2) + 1)\n    Next s\n    End If\n\n\n    Next ldate\n    ReDim Preserve aitemp(UBound(aitemp, 1), UBound(aitemp, 2) - 1)\n\n    Worksheets(temp(r, 1)).Activate\n    ActiveSheet.Cells(Cells.Rows.Count, 1).End(xlUp).Offset(1, 0).Select\n    Selection.Resize(UBound(aitemp, 2), UBound(aitemp, 1) + 1).Value = Application.Transpose(aitemp)\n    ActiveSheet.UsedRange.Columns.AutoFit\ncontinue:\n    Next r\n    ThisWorkbook.Save\n     sstop = Timer\n     elapsed = (sstop - start) / 60\n        MsgBox elapsed &amp; vbCr &amp; \" # of Resubmittals \" &amp; d &amp; vbCr &amp; \"webhits = \" &amp; hits\n\n    End Sub\n</code></pre>\n"}, {"tags": ["vba", "email", "outlook"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1489614568, "post_id": 42821302, "comment_id": 72754381, "body": "So what is the question?"}, {"owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "edited": false, "score": 0, "creation_date": 1489674743, "post_id": 42821302, "comment_id": 72782944, "body": "Cancel parameter must be declared &quot;ByRef&quot;."}], "answers": [{"tags": [], "owner": {"reputation": 382, "user_id": 6697723, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/dc05443c714c0d271e7791db5c08829b?s=128&d=identicon&r=PG&f=1", "display_name": "teddy2", "link": "https://stackoverflow.com/users/6697723/teddy2"}, "is_accepted": true, "score": 1, "last_activity_date": 1489615544, "creation_date": 1489615544, "answer_id": 42821562, "question_id": 42821302, "link": "https://stackoverflow.com/questions/42821302/outlook-custom-pop-up-with-logic-before-sending-email/42821562#42821562", "title": "Outlook: Custom Pop-Up with logic before sending email", "body": "<p>So the snippet you found is perfect and talks about <code>WithEvents</code> instance property. Now it can't be declared inside standard module. Either you need to put in a class or inside <code>ThisOutlookSession</code> </p>\n\n<hr>\n\n<p>Using Class for hooking application level events is the recommended way. But considering your statement <em>I do not have much experience in VBA</em> here is one class less way. </p>\n\n<hr>\n\n<p>But for your requirements, all you need to do is put your code inside the <code>Application_ItemSend</code> under <code>ThisOutlookSession</code>. This way you can avoid creating a class and initializing it at the startup. </p>\n\n<pre><code>Option Explicit\n\nPrivate Sub Application_ItemSend(ByVal Item As Object, Cancel As Boolean)\n    Dim prompt As String\n\n    prompt = \"Are you sure you want to send \" &amp; Item.Subject &amp; \"?\"\n\n    If MsgBox(prompt, vbYesNo + vbQuestion, \"Sample\") = vbNo Then\n        Cancel = True\n    End If\nEnd Sub\n</code></pre>\n\n<p>Note that this code goes in <strong>ThisOutlookSession</strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/mWIeR.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/mWIeR.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 56, "user_id": 7036191, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/f5c45ecd5ea918d306de252e0d63d9ef?s=128&d=identicon&r=PG&f=1", "display_name": "Nicolas", "link": "https://stackoverflow.com/users/7036191/nicolas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 334, "favorite_count": 0, "accepted_answer_id": 42821562, "answer_count": 1, "score": -1, "last_activity_date": 1489615544, "creation_date": 1489614435, "question_id": 42821302, "link": "https://stackoverflow.com/questions/42821302/outlook-custom-pop-up-with-logic-before-sending-email", "title": "Outlook: Custom Pop-Up with logic before sending email", "body": "<p>A colleague had a brilliant idea to reinforce the use of Slack for internal emails. We thought about a custom pop-up that would appear when the user is about to send an internal email. This message would say \"Please prefer Slack for internal communication. Are you sure you still want to send?\".</p>\n\n<p>I thought about using the Application.ItemSend Event in VBA to trigger the pop-up.\nI do not have much experience in VBA but I found that snippet to get me started:</p>\n\n<pre><code>Public WithEvents myOlApp As Outlook.Application \n\nPublic Sub Initialize_handler() \n\n Set myOlApp = Outlook.Application \n\nEnd Sub \n\n\n\nPrivate Sub myOlApp_ItemSend(ByVal Item As Object, Cancel As Boolean) \n\n Dim prompt As String \n\n prompt = \"Are you sure you want to send \" &amp; Item.Subject &amp; \"?\" \n\n If MsgBox(prompt, vbYesNo + vbQuestion, \"Sample\") = vbNo Then \n\n Cancel = True \n\n End If \n\nEnd Sub\n</code></pre>\n\n<p>Any help is appreciated.</p>\n"}, {"tags": ["excel", "if-statement", "vba"], "comments": [{"owner": {"reputation": 7368, "user_id": 4982088, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Wlrq2.png?s=128&g=1", "display_name": "Xorifelse", "link": "https://stackoverflow.com/users/4982088/xorifelse"}, "edited": false, "score": 2, "creation_date": 1489614401, "post_id": 42821257, "comment_id": 72754298, "body": "After the edit, are you seeing what is missing..?"}, {"owner": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 2, "creation_date": 1489614481, "post_id": 42821257, "comment_id": 72754342, "body": "If you learn to properly indent your code, problems like this one don&#39;t exist because the problem slaps you in the face until you fix it."}, {"owner": {"reputation": 7, "user_id": 5964703, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b7580d6c9afc4af0102f7d206c5508d0?s=128&d=identicon&r=PG&f=1", "display_name": "Richard Garcia", "link": "https://stackoverflow.com/users/5964703/richard-garcia"}, "edited": false, "score": 0, "creation_date": 1489618878, "post_id": 42821257, "comment_id": 72756251, "body": "How should it typically be indented?"}, {"owner": {"reputation": 10487, "user_id": 5708620, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b0f8c70394b748ed7ec1a3a11a749b1?s=128&d=identicon&r=PG&f=1", "display_name": "Danny_ds", "link": "https://stackoverflow.com/users/5708620/danny-ds"}, "edited": false, "score": 0, "creation_date": 1489619817, "post_id": 42821257, "comment_id": 72756593, "body": "@RichardGarcia See my updated answer concerning proper indentation."}], "answers": [{"tags": [], "owner": {"reputation": 10487, "user_id": 5708620, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b0f8c70394b748ed7ec1a3a11a749b1?s=128&d=identicon&r=PG&f=1", "display_name": "Danny_ds", "link": "https://stackoverflow.com/users/5708620/danny-ds"}, "is_accepted": false, "score": 2, "last_activity_date": 1489620458, "last_edit_date": 1489620458, "creation_date": 1489614393, "answer_id": 42821287, "question_id": 42821257, "link": "https://stackoverflow.com/questions/42821257/block-if-without-end-if-error/42821287#42821287", "title": "Block If without End If Error", "body": "<p>I think you need a second <code>End If</code> here:</p>\n\n<pre><code>End If\nEnd If\nEnd Sub\n</code></pre>\n\n<p>If you indent your code properly, it would become visible.</p>\n\n<p>Update: After proper formatting it becomes clear that you actually needed an <code>ElseIf</code>, see below.</p>\n\n<hr>\n\n<blockquote>\n  <p>Your comment: How should it typically be indented?</p>\n</blockquote>\n\n<p>Well, usually, after each <code>If</code> you indent the block that follows, and has to be executed if the condition following that <code>If</code> is true - when the <code>If</code> statements are nested you indent more, like:</p>\n\n<pre><code>If test1\n    do something\n    If test2\n        do some more\n    End If\nEnd If\n</code></pre>\n\n<p>That way you have a good overview of the nesting, and it is harder to forget an <code>End If</code>.</p>\n\n<p>In this case, after reformatting your code, it also becomes clear that you actually needed an <code>ElseIf</code> (as others already stated):</p>\n\n<pre><code>If test1\n    do something\nElseIf test2\n    do something else\nElse\n    last else case\nEnd If\n</code></pre>\n\n<p>So good formatting of the code is important to avoid mistakes like that and keep a good overview. This also holds for loops etc.</p>\n"}, {"tags": [], "owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "is_accepted": true, "score": 0, "last_activity_date": 1489618261, "creation_date": 1489618261, "answer_id": 42822198, "question_id": 42821257, "link": "https://stackoverflow.com/questions/42821257/block-if-without-end-if-error/42822198#42822198", "title": "Block If without End If Error", "body": "<p>The second <code>If</code>, I mean this line:</p>\n\n<blockquote>\n  <p><code>If firstnum &lt; secondnum Then</code></p>\n</blockquote>\n\n<p>should be an <code>ElseIf</code> :</p>\n\n<pre><code>ElseIf firstnum &lt; secondnum Then\n    ....\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 174117, "user_id": 1630171, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oIS66.png?s=128&g=1", "display_name": "Ansgar Wiechers", "link": "https://stackoverflow.com/users/1630171/ansgar-wiechers"}, "is_accepted": false, "score": 1, "last_activity_date": 1489618866, "creation_date": 1489618866, "answer_id": 42822314, "question_id": 42821257, "link": "https://stackoverflow.com/questions/42821257/block-if-without-end-if-error/42822314#42822314", "title": "Block If without End If Error", "body": "<p>If you want to use the <code>If &lt;condition&gt; Then &lt;action&gt;</code> short notation (without an <code>End If</code> after the action) you MUST put the statement in one line, either by actually having the statement in a single line:</p>\n\n<pre><code>If firstnum &gt; secondnum Then MsgBox \"The first number is greater\"\n</code></pre>\n\n<p>or by wrapping that line using the line continuation operator (<code>_</code>):</p>\n\n<pre><code>If firstnum &gt; secondnum Then _\n    MsgBox \"The first number is greater\"\n</code></pre>\n\n<p>Otherwise you MUST use block syntax with an <code>End If</code> after the action:</p>\n\n<pre><code>If firstnum &gt; secondnum Then\n    MsgBox \"The first number is greater\"\nEnd If\n</code></pre>\n\n<p>With that said, what you <em>actually</em> want here is an <a href=\"https://msdn.microsoft.com/en-us/library/office/gg251599.aspx\" rel=\"nofollow noreferrer\"><code>If..ElseIf..Else</code></a> statement, because you have three different, mutually exclusive, states (less, equal, greater):</p>\n\n<pre><code>If firstnum &gt; secondnum Then\n    MsgBox \"The first number is greater\"\nElseIf firstnum &lt; secondnum Then\n    MsgBox \"The second number is greater\"\nElse\n    MsgBox \"The numbers are equal\"\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 7, "user_id": 5964703, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b7580d6c9afc4af0102f7d206c5508d0?s=128&d=identicon&r=PG&f=1", "display_name": "Richard Garcia", "link": "https://stackoverflow.com/users/5964703/richard-garcia"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 196, "favorite_count": 0, "accepted_answer_id": 42822198, "answer_count": 3, "score": 0, "last_activity_date": 1489620458, "creation_date": 1489614231, "last_edit_date": 1531164843, "question_id": 42821257, "link": "https://stackoverflow.com/questions/42821257/block-if-without-end-if-error", "title": "Block If without End If Error", "body": "<p>I just did my first <code>If..Then</code> basic then I tried to do logical operators to compare two values in the first two cells to result in message box.  I get an <code>End If</code> Statement compile error </p>\n\n<p>The actual code:</p>\n\n<pre><code>Sub Button3_Click()\n    Dim firstnum As Long \n    Dim secondnum As Long\n\n    firstnum = Cells(1, 1).Value\n    secondnum = Cells(1, 2).Value\n\n    If firstnum &gt; secondnum Then\n        MsgBox \"The first number is greater\"\n\n    If firstnum &lt; secondnum Then\n        MsgBox \"The second number is greater\"\n    Else\n        MsgBox \"The numbers are equal\"\n    End If\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 7422, "user_id": 1586390, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f07270207034d2bcbe347b028edc8f02?s=128&d=identicon&r=PG", "display_name": "Sorceri", "link": "https://stackoverflow.com/users/1586390/sorceri"}, "edited": false, "score": 1, "creation_date": 1489612731, "post_id": 42820814, "comment_id": 72753497, "body": "Date is a type, you need to give it an actual date and not the data type. So: dt = Format(Now, &quot;yyyymmdd&quot;)"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 7422, "user_id": 1586390, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f07270207034d2bcbe347b028edc8f02?s=128&d=identicon&r=PG", "display_name": "Sorceri", "link": "https://stackoverflow.com/users/1586390/sorceri"}, "edited": false, "score": 2, "creation_date": 1489612921, "post_id": 42820814, "comment_id": 72753580, "body": "@Sorceri - <code>Date</code> is the VBA equivalent of <code>=TODAY()</code> on the worksheet. @Matt, I can find nothing wrong with your code; it runs through just fine (to a <code>Debug.Print MyFileName</code> after the string concatenatiopn) for me."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "reply_to_user": {"reputation": 7422, "user_id": 1586390, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f07270207034d2bcbe347b028edc8f02?s=128&d=identicon&r=PG", "display_name": "Sorceri", "link": "https://stackoverflow.com/users/1586390/sorceri"}, "edited": false, "score": 4, "creation_date": 1489613031, "post_id": 42820814, "comment_id": 72753656, "body": "@Sorceri <code>Date</code> is a property of <code>VBA.DateTime</code> class that should return the current date. I can enter this statement <code>?Format(Date, &quot;yyyymmdd&quot;)</code> in the Immediate pane and get the expected result: 20170315."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 3, "creation_date": 1489613091, "post_id": 42820814, "comment_id": 72753686, "body": "This is a compile error, though, so that means the code isn&#39;t even running. Which line is highlighted when the warning is raised?"}, {"owner": {"reputation": 2423, "user_id": 4043845, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/75de73b9f9301869e5136edf9b663a9b?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/4043845/kyle"}, "edited": false, "score": 3, "creation_date": 1489613209, "post_id": 42820814, "comment_id": 72753756, "body": "I get no issues. Try <code>VBA.Format()</code>. It sounds stupid, but I have had that work where you need to qualify VBA built-ins. It has only happened across geographic locations though, never in the US."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 3, "creation_date": 1489614888, "post_id": 42820814, "comment_id": 72754520, "body": "You probably just have another <code>Format</code> function defined somewhere in your code or in an add-in.  Fully qualifying it with <code>VBA.Format</code> is less than an ideal fix.  The <b><i>real</i></b> fix would be finding the identifier that is hiding the built in <code>Format</code> function and renaming it."}], "answers": [{"comments": [{"owner": {"reputation": 2423, "user_id": 4043845, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/75de73b9f9301869e5136edf9b663a9b?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/4043845/kyle"}, "edited": false, "score": 1, "creation_date": 1489615227, "post_id": 42821410, "comment_id": 72754676, "body": "I can&#39;t see how <code>Now</code> will function any different than <code>Date</code>. I use <code>Date</code> all the time for things when I don&#39;t need the time piece."}, {"owner": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "reply_to_user": {"reputation": 2423, "user_id": 4043845, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/75de73b9f9301869e5136edf9b663a9b?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/4043845/kyle"}, "edited": false, "score": 0, "creation_date": 1489616429, "post_id": 42821410, "comment_id": 72755227, "body": "@Kyle <code>Date</code> is both a type and a method, so I am not sure if that can cause conflicts with different references, or the issue is related to the rest of the code that is not shown (more likely)"}, {"owner": {"reputation": 2423, "user_id": 4043845, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/75de73b9f9301869e5136edf9b663a9b?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/4043845/kyle"}, "edited": false, "score": 0, "creation_date": 1489618022, "post_id": 42821410, "comment_id": 72755882, "body": "I know it is both, but I certainly hope this was contemplated in the language design. Seems like a massive  oversight if that fact causes problems."}, {"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 1, "creation_date": 1489647935, "post_id": 42821410, "comment_id": 72765061, "body": "It&#39;s sad that the accepted answer is based on the <a href=\"http://stackoverflow.com/questions/42820814/excel-formatdate-yyyymmdd-results-in-compile-error#comment72753497_42820814\">comment</a> that is inherently wrong. Pretending there is no issue by switching to another function that happens to do kind of the same is not a solution, it&#39;s closing your eyes and thinking no one can see you now. Please use the <a href=\"http://stackoverflow.com/questions/42820814/excel-formatdate-yyyymmdd-results-in-compile-error#comment72754520_42820814\">correct approach</a> instead."}], "tags": [], "owner": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "is_accepted": true, "score": 0, "last_activity_date": 1489614874, "creation_date": 1489614874, "answer_id": 42821410, "question_id": 42820814, "link": "https://stackoverflow.com/questions/42820814/excel-formatdate-yyyymmdd-results-in-compile-error/42821410#42821410", "title": "excel Format(date, &quot;yyyymmdd&quot;) results in compile error", "body": "<p>As @Sorceri commented, use <code>Now</code>:</p>\n\n<pre><code>MyFileName = Sheets(\"Order Summary (2)\").Range(\"B2\") &amp; VBA.Format(Now, \"_yyyymmdd\")\n</code></pre>\n\n<p>or if by any chance that fails, there is also <code>Evaluate</code> alternative:</p>\n\n<pre><code>MyFileName = ['Order Summary (2)'!B2 &amp; TEXT(NOW(), \"_yyyymmdd\")]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 9, "user_id": 14221286, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/187667691a17937904a514d21ec0d5f6?s=128&d=identicon&r=PG", "display_name": "user14221286", "link": "https://stackoverflow.com/users/14221286/user14221286"}, "is_accepted": false, "score": 0, "last_activity_date": 1599224917, "creation_date": 1599224917, "answer_id": 63741848, "question_id": 42820814, "link": "https://stackoverflow.com/questions/42820814/excel-formatdate-yyyymmdd-results-in-compile-error/63741848#63741848", "title": "excel Format(date, &quot;yyyymmdd&quot;) results in compile error", "body": "<p>I had the same issue and the solution was: Comintern Mar 15 '17 at 21:54</p>\n<p>&quot;You probably just have another Format function defined somewhere in your code or in an add-in&quot;</p>\n"}], "owner": {"reputation": 389, "user_id": 7324177, "user_type": "registered", "accept_rate": 82, "profile_image": "https://graph.facebook.com/10209248058172510/picture?type=large", "display_name": "Matt Taylor", "link": "https://stackoverflow.com/users/7324177/matt-taylor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2288, "favorite_count": 0, "accepted_answer_id": 42821410, "answer_count": 2, "score": 2, "last_activity_date": 1599224917, "creation_date": 1489612531, "question_id": 42820814, "link": "https://stackoverflow.com/questions/42820814/excel-formatdate-yyyymmdd-results-in-compile-error", "title": "excel Format(date, &quot;yyyymmdd&quot;) results in compile error", "body": "<p>Not sure why my \"Format\" isn't giving me a date at the end of my filename. I have \"Visual Basic For Applications\" checked in references.</p>\n\n<pre><code>Dim dt As String\n\ndt = Format(Date, \"yyyymmdd\")\n\nMyFileName = Sheets(\"Order Summary (2)\").Range(\"B2\").Value &amp; \"_\" &amp; dt\n</code></pre>\n\n<p>I get this every time</p>\n\n<p><a href=\"https://i.stack.imgur.com/Z5zom.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Z5zom.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["vba", "ms-access", "combobox", "multivalue"], "answers": [{"tags": [], "owner": {"reputation": 49, "user_id": 6684284, "user_type": "registered", "accept_rate": 70, "profile_image": "https://lh6.googleusercontent.com/-GZQx352Gvhs/AAAAAAAAAAI/AAAAAAABOso/d_sFkyeaHkY/photo.jpg?sz=128", "display_name": "Arne Clicteur", "link": "https://stackoverflow.com/users/6684284/arne-clicteur"}, "is_accepted": false, "score": 1, "last_activity_date": 1489615044, "creation_date": 1489615044, "answer_id": 42821455, "question_id": 42820454, "link": "https://stackoverflow.com/questions/42820454/hide-values-in-combobox-with-multi-value-controlsource/42821455#42821455", "title": "Hide values in combobox with multi-value controlsource", "body": "<p>Fiddled with the settings, found the option <code>ShowOnlyRowSourceValues</code>. This solved the problem.</p>\n"}], "owner": {"reputation": 49, "user_id": 6684284, "user_type": "registered", "accept_rate": 70, "profile_image": "https://lh6.googleusercontent.com/-GZQx352Gvhs/AAAAAAAAAAI/AAAAAAABOso/d_sFkyeaHkY/photo.jpg?sz=128", "display_name": "Arne Clicteur", "link": "https://stackoverflow.com/users/6684284/arne-clicteur"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 110, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1489615044, "creation_date": 1489611097, "last_edit_date": 1489614131, "question_id": 42820454, "link": "https://stackoverflow.com/questions/42820454/hide-values-in-combobox-with-multi-value-controlsource", "title": "Hide values in combobox with multi-value controlsource", "body": "<p>I'm using a multi-value field to assign different criteria to a person. These criteria are grouped in different categories. I'm using a dropdown list to choose the categories, selecting one fires some VBA that changes a combobox that displays the criteria. The problem with this is that the criteria from other categories in the multi-value field show up as ID-numbers in the combobox, since the controlsource is fixed on the multi-value field. How can I hide these unwanted ID's, or is this not possible with my approach? </p>\n\n<pre><code>Table AdmitCriteria:\n   ID  |  fkCatID  |  Label\n    1  |     1     |   xxx\n    2  |     1     |   xxx\n    3  |     1     |   xxx\n    4  |     2     |   xxx\n    5  |     3     |   xxx\n    6  |     3     |   xxx\n\nTable Patients:\n   AdmitCrit (multi-value field)\n\nForm:\n   critCategoriesDropdown: rowsource = ID, Label FROM AdmitCriteria\n   cboCriteria: controlsource = AdmitCrit\n                rowsource: VBA\n</code></pre>\n\n<p>-</p>\n\n<pre><code>Private Sub critCategoriesDropdown_AfterUpdate()\n    Dim strSource As String\n    Dim ctrlSource As String\n\n    strSource = \"SELECT Id, Label FROM AdmitCriteria WHERE fkCatID = \" &amp; Me.critCategoriesDropdown.Column(0) &amp; \";\"\n    Me.cboCriteria.RowSource = strSource\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/QDl4h.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/QDl4h.png\" alt=\"Unwanted ID&#39;s at the end\"></a></p>\n"}, {"tags": ["vba", "outlook", "pass-by-reference"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 7717086, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e54bc1e6c607afeecbc4eeaf65167e7?s=128&d=identicon&r=PG&f=1", "display_name": "GreySpike", "link": "https://stackoverflow.com/users/7717086/greyspike"}, "edited": false, "score": 0, "creation_date": 1489672251, "post_id": 42821062, "comment_id": 72781088, "body": "Thanks Comintern,"}], "tags": [], "owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "is_accepted": false, "score": 0, "last_activity_date": 1506028372, "last_edit_date": 1506028372, "creation_date": 1489613505, "answer_id": 42821062, "question_id": 42820445, "link": "https://stackoverflow.com/questions/42820445/i-need-to-swap-any-two-telephone-numbers-in-the-outlook-contactitem-object/42821062#42821062", "title": "I need to swap any two telephone numbers in the Outlook ContactItem object", "body": "<p>When you do this...</p>\n\n<blockquote>\n<pre><code>With Contact\n    '...\n    PrioritySwitch .MobileTelephoneNumber, .BusinessTelephoneNumber, True\n</code></pre>\n</blockquote>\n\n<p>...you're calling a <strong><em>property</em></strong> of the <code>Contact</code> object.  This returns the phone number to an internal stack variable.  That internal stack variable is what is being passed <code>ByRef</code> to your <code>PrioritySwitch</code> <code>Sub</code>.  Once it returns, the stack variables are simply discarded because you aren't assigning them to anything.  This is equivalent to...</p>\n\n<pre><code>Dim stackVar1 As String\nstackVar1 = Contact.MobileTelephoneNumber\nDim stackVar2 As String\nstackVar2 = Contact.BusinessTelephoneNumber\nPrioritySwitch stackVar1, stackVar2, True\n'...and then stackVar1 and stackVar2 disappear...\n</code></pre>\n\n<p><code>ByRef</code> can't just magically hook up a procedure to a property like that - envision what they would look like in a VBA class, because that is pretty close to what is going on when you use the property of a COM object.</p>\n\n<pre><code>Public Property Let MobileTelephoneNumber(number As String)\n    'Frobs whatever Outlook does to store the number.\nEnd Property\n\nPublic Property Get MobileTelephoneNumber() As String\n    'Frobs whatever Outlook does to retrieve the number.\nEnd Property\n</code></pre>\n\n<hr>\n\n<p>That said, you can do something similar using the <code>CallByName</code> function, and just call the properties directly in your <code>Sub</code>:</p>\n\n<pre><code>Public Sub PrioritySwitch(target As ContactItem, propertyOne As String, _\n                          propertyTwo As String, mobileOnly As Boolean)\n    Tel1 = CallByName(target, propertyOne, VbGet)\n    Tel2 = CallByName(target, propertyTwo, VbGet)\n\n    '...code that sets switchTel\n\n    If switchTel Then\n      CallByName target, propertyOne, VbLet, Tel2\n      CallByName target, propertyTwo, VbLet, Tel1\n    End If\nEnd Sub \n</code></pre>\n\n<p>Then your calling code would look more like this (without the <code>With</code> block - unless you have more work to do with <code>Contact</code>):</p>\n\n<pre><code>    ' prioritise\n    PrioritySwitch Contact, \"MobileTelephoneNumber\", \"BusinessTelephoneNumber\", True\n    PrioritySwitch Contact, \"MobileTelephoneNumber\", \"Business2TelephoneNumber\", True\n    PrioritySwitch Contact, \"MobileTelephoneNumber\", \"BusinessFaxNumber\", True\n    PrioritySwitch Contact, \"MobileTelephoneNumber\", \"CompanyMainTelephoneNumber\", True\n    ' etc...\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 7717086, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e54bc1e6c607afeecbc4eeaf65167e7?s=128&d=identicon&r=PG&f=1", "display_name": "GreySpike", "link": "https://stackoverflow.com/users/7717086/greyspike"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 55, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1506028372, "creation_date": 1489611056, "question_id": 42820445, "link": "https://stackoverflow.com/questions/42820445/i-need-to-swap-any-two-telephone-numbers-in-the-outlook-contactitem-object", "title": "I need to swap any two telephone numbers in the Outlook ContactItem object", "body": "<p>I writing some code to tidy up my contact list in Outlook.</p>\n\n<p>Over the years I've stored 'extra' telephone numbers in various fields, and now I want to move them around.</p>\n\n<p>Specifically when I recognise a non-mobile number in a mobile field and a mobile number in a non-mobile field then I want to swap them.</p>\n\n<p>However, the code below doesn't work; it doesn't error but the telephone numbers are unchanged once the swap routine returns.</p>\n\n<p>I think because either my use of ByRef is incorrect or class properties can't be passed by reference or class string properties behave in strange ways that I cannot fathom.</p>\n\n<p>I've tried both PriortySwitch Arg1 Arg2 Arg3 and Call PrioritySwitch(Arg1,Arg2,Arg3)</p>\n\n<p>Even if someone can confirm that it can't be done at least I will stop wasting time trying to puzzle it out.</p>\n\n<pre><code>Sub Whatever\n  Dim Ns As Outlook.NameSpace\n  Dim Contacts As Items\n  Dim Contact As ContactItem\n\n  Set Ns = Application.GetNamespace(\"MAPI\")\n\n  'use the default folder\n  Set Contacts = Ns.GetDefaultFolder(olFolderContacts).Items.Restrict(\"[MessageClass]='IPM.Contact'\")\n\n  'do whatever\n  On Error GoTo WTF\n\n  For Each Item In Contacts\n    If Item.Class = olContact Then\n      Set Contact = Item\n      With Contact\n        ' Call SetCategories(Contact)\n        '.MobileTelephoneNumber = FormatTel(.MobileTelephoneNumber)\n        '.AssistantTelephoneNumber = FormatTel(.AssistantTelephoneNumber)\n        '.Business2TelephoneNumber = FormatTel(.Business2TelephoneNumber)\n        '.BusinessFaxNumber = FormatTel(.BusinessFaxNumber)\n        '.BusinessTelephoneNumber = FormatTel(.BusinessTelephoneNumber)\n        '.CallbackTelephoneNumber = Format(.CallbackTelephoneNumber)\n        '.CarTelephoneNumber = FormatTel(.CarTelephoneNumber)\n        '.CompanyMainTelephoneNumber = FormatTel(.CompanyMainTelephoneNumber)\n        '.Home2TelephoneNumber = FormatTel(.Home2TelephoneNumber)\n        '.HomeFaxNumber = FormatTel(.HomeFaxNumber)\n        '.HomeTelephoneNumber = FormatTel(.HomeTelephoneNumber)\n        '.OtherFaxNumber = FormatTel(.OtherFaxNumber)\n        '.OtherTelephoneNumber = FormatTel(.OtherTelephoneNumber)\n        '.PagerNumber = FormatTel(.PagerNumber)\n        '.PrimaryTelephoneNumber = FormatTel(.PrimaryTelephoneNumber)\n        '.RadioTelephoneNumber = FormatTel(.RadioTelephoneNumber)\n        '.TTYTDDTelephoneNumber = FormatTel(.TTYTDDTelephoneNumber)\n\n        ' prioritise\n        PrioritySwitch .MobileTelephoneNumber, .BusinessTelephoneNumber, True\n        PrioritySwitch .MobileTelephoneNumber, .Business2TelephoneNumber, True\n        PrioritySwitch .MobileTelephoneNumber, .BusinessFaxNumber, True\n        PrioritySwitch .MobileTelephoneNumber, .CompanyMainTelephoneNumber, True\n        PrioritySwitch .MobileTelephoneNumber, .PrimaryTelephoneNumber, True\n        PrioritySwitch .MobileTelephoneNumber, .AssistantTelephoneNumber, True\n        PrioritySwitch .MobileTelephoneNumber, .CallbackTelephoneNumber, True\n        PrioritySwitch .MobileTelephoneNumber, .CarTelephoneNumber, True\n        PrioritySwitch .MobileTelephoneNumber, .CompanyMainTelephoneNumber, True\n        PrioritySwitch .MobileTelephoneNumber, .Home2TelephoneNumber, True\n        PrioritySwitch .MobileTelephoneNumber, .HomeTelephoneNumber, True\n        PrioritySwitch .MobileTelephoneNumber, .OtherTelephoneNumber, True\n        PrioritySwitch .MobileTelephoneNumber, .PagerNumber, True\n        PrioritySwitch .MobileTelephoneNumber, .HomeFaxNumber, True\n        PrioritySwitch .MobileTelephoneNumber, .OtherFaxNumber, True\n\n        If Not .Saved Then .Save\n      End With\n    End If\n  Next\n  Exit Sub\n  WTF:\n    Debug.Print Contact\nEnd Sub\n\nSub PrioritySwitch(ByRef Tel1 As String, ByRef Tel2 As String, mobileOnly As Boolean)\n  Dim t1 As String\n  Dim switchTel As Boolean\n\n  switchTel = False\n\n  'Logic code goes here\n  switchTel = True\n\n  If switchTel Then\n    t1 = Tel1\n    Tel1 = Tel2\n    Tel2 = t1\n  End If\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 2, "creation_date": 1489610030, "post_id": 42820130, "comment_id": 72751996, "body": "what is <code>Worksheet_Change1</code>? it can not have that name, it will never fire."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 2, "creation_date": 1489610156, "post_id": 42820130, "comment_id": 72752067, "body": "Also you will want to test that the target is empty Put this in the If before the Then <code>And Target.Value = &quot;&quot;</code>"}, {"owner": {"reputation": 7, "user_id": 7717471, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2761d2deb40c836fc55aee7363a275c7?s=128&d=identicon&r=PG&f=1", "display_name": "Greg Ryner", "link": "https://stackoverflow.com/users/7717471/greg-ryner"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1489611411, "post_id": 42820130, "comment_id": 72752804, "body": "ok that helped. At least its firing now... but now I&#39;m getting a debug error on the range(&quot;b8&quot;).Forumla part."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1489614752, "post_id": 42820130, "comment_id": 72754464, "body": "In the bit of the formula that says <code>IF($B$1=&quot;&quot;GBU&quot;&quot;,IF(MAX(&#39;TY Data&#39;!$L:$L)&amp;&gt;=VLOOKUP</code>, the <code>&amp;</code> shouldn&#39;t be there."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1489615143, "post_id": 42820130, "comment_id": 72754640, "body": "BTW - that formula could probably be simplified <b>a LOT</b> if you put your <code>IF</code> around just the part of the <code>SUMIFS</code> that is changing - ie <code>SUMIFS(.... ,IF($B$1=&quot;&quot;DC&quot;&quot;,&#39;TY Data&#39;!$I:$I,IF($B$1=&quot;&quot;Division&quot;&quot;,&#39;TY Data&#39;!$M:$M,IF($B$1=&quot;&quot;GBU&quot;&quot;,&#39;TY Data&#39;!$N:$N,&#39;TY Data&#39;!$O:$O))),&#39;Wage Run&#39;!$D$1)</code>"}], "answers": [{"comments": [{"owner": {"reputation": 7, "user_id": 7717471, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2761d2deb40c836fc55aee7363a275c7?s=128&d=identicon&r=PG&f=1", "display_name": "Greg Ryner", "link": "https://stackoverflow.com/users/7717471/greg-ryner"}, "edited": false, "score": 0, "creation_date": 1489674774, "post_id": 42822561, "comment_id": 72782968, "body": "This is amazing! Thank you so much... I love smart people. One final question. Is there a way to allow direct input into cell B8? Such as if they wanted to overwrite the formula with a value and then if that value is deleted, it reverts back to the formula."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 7, "user_id": 7717471, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2761d2deb40c836fc55aee7363a275c7?s=128&d=identicon&r=PG&f=1", "display_name": "Greg Ryner", "link": "https://stackoverflow.com/users/7717471/greg-ryner"}, "edited": false, "score": 0, "creation_date": 1489678848, "post_id": 42822561, "comment_id": 72786295, "body": "Change <code>If Not Target.HasFormula Then _</code> to <code>If IsEmpty(Target) Then _</code> Using <code>If Target = &quot;&quot;</code> does not preclude Target having a formula that returns <code>&quot;&quot;</code>. The <code>&quot;&quot;</code> is not truly blank but a &#39;zero-length string&#39;; only <code>IsEmpty</code> defines a truly blank cell."}, {"owner": {"reputation": 7, "user_id": 7717471, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2761d2deb40c836fc55aee7363a275c7?s=128&d=identicon&r=PG&f=1", "display_name": "Greg Ryner", "link": "https://stackoverflow.com/users/7717471/greg-ryner"}, "edited": false, "score": 0, "creation_date": 1489679524, "post_id": 42822561, "comment_id": 72786876, "body": "You are awesome! Worked perfectly :)"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 0, "last_activity_date": 1489620095, "creation_date": 1489620095, "answer_id": 42822561, "question_id": 42820130, "link": "https://stackoverflow.com/questions/42820130/direct-input-or-formula/42822561#42822561", "title": "Direct input or Formula", "body": "<p>You are not disabling event triggers. When you write the formula into B8, the Worksheet_Change is going to run on top of itself. If the formula happens to return <code>\"\"</code> then it is going to keep running on top of itself until you crash.</p>\n\n<pre><code>Option Explicit\n\nPrivate Sub Worksheet_Change(ByVal Target As Range)\n\n    If Target.Cells.Count &gt; 1 Then Exit Sub\n\n    On Error GoTo Safe_Exit\n    Application.EnableEvents = False\n\n    Select Case Target.Address(0, 0)\n        Case \"B1\"\n            Target.Offset(0, 1).ClearContents\n        Case \"B8\"\n            If Not Target.HasFormula Then _\n                Target.Formula = \"=IFERROR(IF(MAX('TY Data'!$L:$L)&gt;=VLOOKUP('Wage Run'!$F$1, Dates!$A:$D, 3, FALSE), \" &amp; _\n                                          \"SUMIFS('TY Data'!$K:$K, \" &amp; _\n                                                 \"'TY Data'!$A:$A, 5101200, \" &amp; _\n                                                 \"'TY Data'!$L:$L, VLOOKUP('Wage Run'!$F$1, Dates!$A:$D, 3, FALSE), \" &amp; _\n                                                 \"'TY Data'!$D:$D, \"\"AP0345R\"\",\" &amp; _\n                                                 \"INDEX('TY Data'!$I:$O, 0, LOOKUP($B$1, {\"\"DC\"\",\"\"Division\"\",\"\"GBU\"\",\"\"Rollup\"\"}, {1,5,6,7})), 'Wage Run'!$D$1), 0), \"\"\"\")\"\n        Case Else\n            'do nothing\n    End Select\n\nSafe_Exit:\n    Application.EnableEvents = True\n\nEnd Sub\n</code></pre>\n\n<p>On a related topic, this is my modification to your formula. In B8 as,</p>\n\n<pre><code>=IFERROR(IF(MAX('TY Data'!$L:$L)&gt;=VLOOKUP('Wage Run'!$F$1, Dates!$A:$D, 3, FALSE),\n      SUMIFS('TY Data'!$K:$K, 'TY Data'!$A:$A, 5101200,\n                              'TY Data'!$L:$L, VLOOKUP('Wage Run'!$F$1, Dates!$A:$D, 3, FALSE),\n                              'TY Data'!$D:$D, \"AP0345R\",\n                              INDEX('TY Data'!$I:$O, 0, LOOKUP($B$1, {\"DC\",\"Division\",\"GBU\",\"Rollup\"}, {1,5,6,7})), 'Wage Run'!$D$1), 0), \"\")\n</code></pre>\n\n<p>The last line with <code>INDEX</code> is where the <code>OR(B1={\"DC\",\"Division\",\"GBU\",\"Rollup\"})</code> comes into play.</p>\n"}], "owner": {"reputation": 7, "user_id": 7717471, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2761d2deb40c836fc55aee7363a275c7?s=128&d=identicon&r=PG&f=1", "display_name": "Greg Ryner", "link": "https://stackoverflow.com/users/7717471/greg-ryner"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 76, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1489620095, "creation_date": 1489609939, "last_edit_date": 1531161705, "question_id": 42820130, "link": "https://stackoverflow.com/questions/42820130/direct-input-or-formula", "title": "Direct input or Formula", "body": "<p>I have a spreadsheet where I would like the end user to be able to enter a value OR the spreadsheet will automatically populate a formula. I would also like it to re-populate the formula if the direct input is deleted. Currently the below code does nothing. Any help would be greatly appreciated!</p>\n\n<pre><code>Private Sub Worksheet_Change1(ByVal target As Range)\n\nIf target.Cells.Count &gt; 1 Then Exit Sub\n\nIf Not Intersect(target, Range(\"B8\")) Is Nothing Then\n\nRange(\"B8\").Formula = \"=IF($B$1=\"\"DC\"\",IF(MAX('TY Data'!$L:$L)&gt;=VLOOKUP('Wage Run'!$F$1,Dates!$A:$D,3,0),SUMIFS('TY Data'!$K:$K,'TY Data'!$A:$A,5101200,'TY Data'!$L:$L,VLOOKUP('Wage Run'!$F$1,Dates!$A:$D,3,0),'TY Data'!$D:$D,\"\"AP0345R\"\",'TY Data'!$I:$I,'Wage Run'!$D$1),0),IF($B$1=\"\"Division\"\",IF(MAX('TY Data'!$L:$L)&gt;=VLOOKUP('Wage Run'!$F$1,Dates!$A:$D,3,0),SUMIFS('TY Data'!$K:$K,'TY Data'!$A:$A,5101200,'TY Data'!$L:$L,VLOOKUP('Wage Run'!$F$1,Dates!$A:$D,3,0),'TY Data'!$D:$D,\"\"AP0345R\"\",'TY Data'!$M:$M,'Wage Run'!$D$1),0)\" _\n&amp; \",IF($B$1=\"\"GBU\"\",IF(MAX('TY Data'!$L:$L)&amp;&gt;=VLOOKUP('Wage Run'!$F$1,Dates!$A:$D,3,0),SUMIFS('TY Data'!$K:$K,'TY Data'!$A:$A,5101200,'TY Data'!$L:$L,VLOOKUP('Wage Run'!$F$1,Dates!$A:$D,3,0),'TY Data'!$D:$D,\"\"AP0345R\"\",'TY Data'!$N:$N,'Wage Run'!$D$1),0),IF($B$1=\"\"Rollup\"\",IF(MAX('TY Data'!$L:$L)&gt;=VLOOKUP('Wage Run'!$F$1,Dates!$A:$D,3,0),SUMIFS('TY Data'!$K:$K,'TY Data'!$A:$A,5101200,'TY Data'!$L:$L,VLOOKUP('Wage Run'!$F$1,Dates!$A:$D,3,0),'TY Data'!$D:$D,\"\"AP0345R\"\",'TY Data'!$O:$O,'Wage Run'!$D$1),0),\"\"\"\"))))\"\n\nEnd If\nEnd Sub\n</code></pre>\n\n<p>Edit:</p>\n\n<p>New formula looks like this after I added it to the old sub</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal target As Range)\n\nIf target.Cells.Count &gt; 1 Then Exit Sub\n\nIf Not Intersect(target, Range(\"B1\")) Is Nothing Then\n    Range(\"C1\").ClearContents\nEnd If\n\nIf target.Cells.Count &gt; 1 Then Exit Sub\n\nIf Not Intersect(target, Range(\"B8\")) Is Nothing And target.Value = \"\" Then\n\nRange(\"B8\").Formula = \"=IF($B$1=\"\"DC\"\",IF(MAX('TY Data'!$L:$L)&gt;=VLOOKUP('Wage Run'!$F$1,Dates!$A:$D,3,0),SUMIFS('TY Data'!$K:$K,'TY Data'!$A:$A,5101200,'TY Data'!$L:$L,VLOOKUP('Wage Run'!$F$1,Dates!$A:$D,3,0),'TY Data'!$D:$D,\"\"AP0345R\"\",'TY Data'!$I:$I,'Wage Run'!$D$1),0),IF($B$1=\"\"Division\"\",IF(MAX('TY Data'!$L:$L)&gt;=VLOOKUP('Wage Run'!$F$1,Dates!$A:$D,3,0),SUMIFS('TY Data'!$K:$K,'TY Data'!$A:$A,5101200,'TY Data'!$L:$L,VLOOKUP('Wage Run'!$F$1,Dates!$A:$D,3,0),'TY Data'!$D:$D,\"\"AP0345R\"\",'TY Data'!$M:$M,'Wage Run'!$D$1),0)\" _\n&amp; \",IF($B$1=\"\"GBU\"\",IF(MAX('TY Data'!$L:$L)&amp;&gt;=VLOOKUP('Wage Run'!$F$1,Dates!$A:$D,3,0),SUMIFS('TY Data'!$K:$K,'TY Data'!$A:$A,5101200,'TY Data'!$L:$L,VLOOKUP('Wage Run'!$F$1,Dates!$A:$D,3,0),'TY Data'!$D:$D,\"\"AP0345R\"\",'TY Data'!$N:$N,'Wage Run'!$D$1),0),IF($B$1=\"\"Rollup\"\",IF(MAX('TY Data'!$L:$L)&gt;=VLOOKUP('Wage Run'!$F$1,Dates!$A:$D,3,0),SUMIFS('TY Data'!$K:$K,'TY Data'!$A:$A,5101200,'TY Data'!$L:$L,VLOOKUP('Wage Run'!$F$1,Dates!$A:$D,3,0),'TY Data'!$D:$D,\"\"AP0345R\"\",'TY Data'!$O:$O,'Wage Run'!$D$1),0),\"\"\"\"))))\"\n\nEnd If\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "edited": false, "score": 0, "creation_date": 1489609764, "post_id": 42820015, "comment_id": 72751832, "body": "check the event log. look for exception code. did you update your antivirus recently?"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1489609876, "post_id": 42820015, "comment_id": 72751892, "body": "The application.calculate will calculate all open excel files and if the user has a file with many array or volatile formulas open, it could cause the cascade you are describing."}, {"owner": {"reputation": 199, "user_id": 4846251, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/mSKB5.jpg?s=128&g=1", "display_name": "Alex Martinez", "link": "https://stackoverflow.com/users/4846251/alex-martinez"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1489610550, "post_id": 42820015, "comment_id": 72752321, "body": "Got it @ScottCraner but we run this Macro (Application.Calculate) everyday at least 100 times at just today it started breaking everytime for every specific case we run it. It is very weird that just today when we starting receiving the rest of the errors this one came out."}, {"owner": {"reputation": 199, "user_id": 4846251, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/mSKB5.jpg?s=128&g=1", "display_name": "Alex Martinez", "link": "https://stackoverflow.com/users/4846251/alex-martinez"}, "reply_to_user": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "edited": false, "score": 0, "creation_date": 1489610606, "post_id": 42820015, "comment_id": 72752359, "body": "@cyboashu I asked the IT department if the update the Antivirus. Will let you know what they Say..."}, {"owner": {"reputation": 3003, "user_id": 1540019, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/8ca15171e2123d2218198e6a0a77e3d9?s=128&d=identicon&r=PG", "display_name": "rohrl77", "link": "https://stackoverflow.com/users/1540019/rohrl77"}, "edited": false, "score": 0, "creation_date": 1489649574, "post_id": 42820015, "comment_id": 72765802, "body": "Has your IT installed MS Office updates? I remember about 4 years ago MS provided an update that caused some of my code to stop working because it screwed up some ActiveX objects. Worth looking into!"}, {"owner": {"reputation": 199, "user_id": 4846251, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/mSKB5.jpg?s=128&g=1", "display_name": "Alex Martinez", "link": "https://stackoverflow.com/users/4846251/alex-martinez"}, "reply_to_user": {"reputation": 3003, "user_id": 1540019, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/8ca15171e2123d2218198e6a0a77e3d9?s=128&d=identicon&r=PG", "display_name": "rohrl77", "link": "https://stackoverflow.com/users/1540019/rohrl77"}, "edited": false, "score": 0, "creation_date": 1489671030, "post_id": 42820015, "comment_id": 72780110, "body": "@rohrl77 Something like that happened to me (shame that I didn&#39;t see your message earlier). Microsoft lunched an update that messed my code up. The servers have Automatic Updates on and grabbed whatever update is launched. This last update was messing everything up. I uninstall the update an everything works fine again. Thanks,"}], "answers": [{"comments": [{"owner": {"reputation": 3003, "user_id": 1540019, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/8ca15171e2123d2218198e6a0a77e3d9?s=128&d=identicon&r=PG", "display_name": "rohrl77", "link": "https://stackoverflow.com/users/1540019/rohrl77"}, "edited": false, "score": 0, "creation_date": 1489675376, "post_id": 42835454, "comment_id": 72783510, "body": "Good to know! Thanks for the link, as it is very likely that I will also get hit by this update."}], "tags": [], "owner": {"reputation": 199, "user_id": 4846251, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/mSKB5.jpg?s=128&g=1", "display_name": "Alex Martinez", "link": "https://stackoverflow.com/users/4846251/alex-martinez"}, "is_accepted": false, "score": 2, "last_activity_date": 1489670852, "creation_date": 1489670852, "answer_id": 42835454, "question_id": 42820015, "link": "https://stackoverflow.com/questions/42820015/macros-starting-crashing-today/42835454#42835454", "title": "Macros Starting Crashing Today", "body": "<p>Ok, here is what happened in case you guys see this problem in the future:</p>\n\n<p>Everything is Microsoft fault's. They launched an update to fix some Excel bugs and instead of fixing them, the server that automatic updated their versions, got really messed up. This updated was launched on Mar/14/2017 (2 days Ago). </p>\n\n<p>I made some research and this sounded very weird to me. They launched an update to fix Excel 2010 bugs and now my Macros are breaking without changing the code? It had to be that and there it was. </p>\n\n<p>Here's the Log: \n<a href=\"https://support.microsoft.com/en-us/help/3178690/ms17-014-description-of-the-security-update-for-excel-2010-march-14-20\" rel=\"nofollow noreferrer\">https://support.microsoft.com/en-us/help/3178690/ms17-014-description-of-the-security-update-for-excel-2010-march-14-20</a></p>\n\n<p>Just keep your head up if you have Automatic Updates on in your computer and see problems like these happening. In case you find that's the problem, just remove the update from your Excel.</p>\n\n<p>Regards,</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 7721859, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/ce7100db34264ed629c95da4e350d6ea?s=128&d=identicon&r=PG", "display_name": "user7721859", "link": "https://stackoverflow.com/users/7721859/user7721859"}, "is_accepted": false, "score": 0, "last_activity_date": 1489674111, "creation_date": 1489674111, "answer_id": 42836744, "question_id": 42820015, "link": "https://stackoverflow.com/questions/42820015/macros-starting-crashing-today/42836744#42836744", "title": "Macros Starting Crashing Today", "body": "<p>My laptop ran the latest windows 7 updates last night and since then all my macros have stopped working. I have had to roll my laptop back to a point before last nights updates and everything is now working fine again. Think there is a major issue with the latest Microsoft update releases.</p>\n"}, {"comments": [{"owner": {"reputation": 199, "user_id": 4846251, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/mSKB5.jpg?s=128&g=1", "display_name": "Alex Martinez", "link": "https://stackoverflow.com/users/4846251/alex-martinez"}, "edited": false, "score": 0, "creation_date": 1490019131, "post_id": 42860296, "comment_id": 72911235, "body": "Yes, that&#39;s exactly what was happening to me. I don&#39;t know how and when Microsoft is going to fix this problem."}], "tags": [], "owner": {"reputation": 11, "user_id": 7727665, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-xdWq9DMp6L4/AAAAAAAAAAI/AAAAAAAADnI/mEXqj0mav80/photo.jpg?sz=128", "display_name": "OSU_Matthew", "link": "https://stackoverflow.com/users/7727665/osu-matthew"}, "is_accepted": false, "score": 1, "last_activity_date": 1489761429, "creation_date": 1489761429, "answer_id": 42860296, "question_id": 42820015, "link": "https://stackoverflow.com/questions/42820015/macros-starting-crashing-today/42860296#42860296", "title": "Macros Starting Crashing Today", "body": "<p>I am currently running into a similar issue with an Excel VB script utilizing the Today() function. The script freezes up and becomes unresponsive when the date is 03/17/17, but if I change the system date to 03/16/17, everything works great.</p>\n\n<p>It appears that there were a number of Microsoft Office Updates on 03/16/17, so I am going to try and remove them one by one and see if that fixes the issue. I'm starting out with the Security Update for excel, KB3178690. </p>\n\n<p>Update -- confirmed, removing Microsoft Security Update for Excel KB3178690 fixes the crashing issue related to the date function after 3/17/17. Probably some deeper reason to this, such as activeX forms or something (of which I don't believe this script utilizes), but at any rate it's working now.</p>\n"}], "owner": {"reputation": 199, "user_id": 4846251, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/mSKB5.jpg?s=128&g=1", "display_name": "Alex Martinez", "link": "https://stackoverflow.com/users/4846251/alex-martinez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 793, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1489761429, "creation_date": 1489609569, "last_edit_date": 1489649106, "question_id": 42820015, "link": "https://stackoverflow.com/questions/42820015/macros-starting-crashing-today", "title": "Macros Starting Crashing Today", "body": "<p>Quick overview: I develop Excel Macros for a firm. The Macros are used in a daily basis for more than 200 workers. These 200 workers connect the Local Machine to a common server (there actually 3 servers) and run the Macros from there.</p>\n\n<p>Problem: Today in the morning some of these Macros (different Macros) starting crashing Excel with the tipical message \"Excel has stopped working\". These Macros (which I didn't update) run every day without a problem. Today, just like magic, they starting crashing for different lines of code which only common denominator is that they use a lot of resources.</p>\n\n<p>Ex:</p>\n\n<pre><code>sh.UsedRange.Value = sh.UsedRange.Value (the UseRange is alcually a pretty small range)\nApplication.Calculate\nwb.Sheet1.Move \n</code></pre>\n\n<p>I understand these are functions that take a lot of memory but still they have been working for months without a problem until today. I know this could be more like IT kind of problem but since I'm trying to solve this issue, I thought maybe one of you either had this problem before or know a possible cause (like a Windows update).</p>\n\n<p>IT already reinstalled Excel in all the servers that we use for remote connection but the problem persists.</p>\n\n<p>Any Idea?</p>\n\n<p>Thanks a lot,</p>\n"}, {"tags": ["vba", "range", "datediff"], "comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1489609594, "post_id": 42819920, "comment_id": 72751718, "body": "Is it <code>dSavedDate</code> that has a value of &quot;Thu Mar 02 01:14:28 EST 2017&quot; or is that the value of <code>vBaseArray(i,1)</code>?  If it isn&#39;t <code>dSavedDate</code>, what <b>is</b> the value of <code>dSavedDate</code>?  And what is the value of <code>dSearchDate</code>?  And do you have any <code>On Error</code> statements in your code that might be masking errors?"}, {"owner": {"reputation": 113, "user_id": 7569590, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/6248aad02aa008e6498b8246d62fa0e7?s=128&d=identicon&r=PG&f=1", "display_name": "Jay", "link": "https://stackoverflow.com/users/7569590/jay"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1489666423, "post_id": 42819920, "comment_id": 72776769, "body": "yes, the value of dSavedDate  is Thu Mar 02 01:14:28 EST 2017. dSearchDate has the value of all timestamps in column 1 which are within certain criteria. mainly the 4 values which I gave below. but obviously they are not correct"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1489688236, "post_id": 42819920, "comment_id": 72792802, "body": "If <code>dSavedDate</code> is Thu Mar 02 01:14:28 EST 2017 then <code>convertDate</code> hasn&#39;t worked - if it is the function I saw as an answer to one of your other questions, it should be returning a date, not a value like you have shown."}], "answers": [{"comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1489610892, "post_id": 42820280, "comment_id": 72752523, "body": "One minor issue - the OP wants &gt;=1 and &lt;=2."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1489610991, "post_id": 42820280, "comment_id": 72752579, "body": "Won&#39;t that just allow anything &lt;-1 Or &gt;1 ?"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1489611098, "post_id": 42820280, "comment_id": 72752625, "body": "@YowE3K - Huh? &quot;I want to process all the rows within timespan of 1 minute.&quot; I actually think the original version <i>without</i> the <code>Not</code> was probably what the OP wanted, but now that I compare the top of the question to the bottom..."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1489611243, "post_id": 42820280, "comment_id": 72752698, "body": "Yeah - the question is somewhat confusing - there is also the statement &quot;I want timestamps which will be &gt;= 1 minute of dSavedDate&quot;.  The code is certainly trying to do &gt;=1 and &lt;=2, so I assume it means ones that are within the one minute period after 1 minute after <code>dSavedDate</code>."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1489611306, "post_id": 42820280, "comment_id": 72752732, "body": "@YowE3K - If so, it&#39;s just a matter of taking out the <code>Abs</code> call. We&#39;ll see if the OP wants to chime in."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1489611407, "post_id": 42820280, "comment_id": 72752798, "body": "@YowE3K - If so, the OP should probably pursue that on the <a href=\"http://stackoverflow.com/q/42810055/4088852\">previous question</a>."}, {"owner": {"reputation": 113, "user_id": 7569590, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/6248aad02aa008e6498b8246d62fa0e7?s=128&d=identicon&r=PG&f=1", "display_name": "Jay", "link": "https://stackoverflow.com/users/7569590/jay"}, "edited": false, "score": 0, "creation_date": 1490211585, "post_id": 42820280, "comment_id": 73016552, "body": "Hi, Forgive for 1) late reply, I was on break. 2) for posting a a confusing description. But the suggestion given by @Comintern work for my problem. If WithinOneMinute(dSearchDate, dSavedDate) Then - gives me the records which match the criteria. there is no  need for &#39;NOT&#39;"}, {"owner": {"reputation": 113, "user_id": 7569590, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/6248aad02aa008e6498b8246d62fa0e7?s=128&d=identicon&r=PG&f=1", "display_name": "Jay", "link": "https://stackoverflow.com/users/7569590/jay"}, "edited": false, "score": 0, "creation_date": 1490211971, "post_id": 42820280, "comment_id": 73016775, "body": "If I want to process records within 2 minutes, do I divide by 120 in the function like following? Const ONE_MINUTE As Double = 1 / 24 / 60"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "reply_to_user": {"reputation": 113, "user_id": 7569590, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/6248aad02aa008e6498b8246d62fa0e7?s=128&d=identicon&r=PG&f=1", "display_name": "Jay", "link": "https://stackoverflow.com/users/7569590/jay"}, "edited": false, "score": 0, "creation_date": 1490212100, "post_id": 42820280, "comment_id": 73016854, "body": "@Jay - Wrong way - that would be half a minute.  It&#39;s 1 day divided by 24 hours divided by 60 minutes.  You could also do <code>Const TWO_MINUTES As Double = ONE_MINUTE * 2</code> if you need to use both of them."}], "tags": [], "owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "is_accepted": true, "score": 2, "last_activity_date": 1489610864, "last_edit_date": 1489610864, "creation_date": 1489610472, "answer_id": 42820280, "question_id": 42819920, "link": "https://stackoverflow.com/questions/42819920/datediff-function-to-compare-minute-range/42820280#42820280", "title": "datediff function to compare minute range", "body": "<p><code>Date</code> variables are represented internally as <code>Double</code>, with the time portion as a fractional day to the right of the decimal.  You can just subtract them directly and use a delta to see if they're within a minute of each other:</p>\n\n<pre><code>Public Function WithinOneMinute(first As Date, second As Date) As Boolean\n    Const ONE_MINUTE As Double = 1 / 24 / 60\n    Dim difference As Date\n    difference = Abs(first - second)\n    WithinOneMinute = difference &lt;= ONE_MINUTE\nEnd Function\n</code></pre>\n\n<p>Then you can call it in your loop like this:</p>\n\n<pre><code>    For i = 1 To UBound(vBaseArray)\n      dSavedDate = convertDate(vBaseArray(i, 1))\n      For j = i To UBound(vBaseArray)\n           If Not WithinOneMinute(dSearchDate, dSavedDate) Then\n</code></pre>\n"}], "owner": {"reputation": 113, "user_id": 7569590, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/6248aad02aa008e6498b8246d62fa0e7?s=128&d=identicon&r=PG&f=1", "display_name": "Jay", "link": "https://stackoverflow.com/users/7569590/jay"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 86, "favorite_count": 0, "accepted_answer_id": 42820280, "answer_count": 1, "score": 0, "last_activity_date": 1489610864, "creation_date": 1489609262, "last_edit_date": 1592644375, "question_id": 42819920, "link": "https://stackoverflow.com/questions/42819920/datediff-function-to-compare-minute-range", "title": "datediff function to compare minute range", "body": "<p>I am copying all the data in the sheet into variant array. Column 1 has timestamp like following.</p>\n<blockquote>\n<p>Thu Mar 02 01:14:28 EST 2017</p>\n</blockquote>\n<p>I want to process all the rows within timespan of 1 minute. I am using datediff function to find out the difference in minute. But somehow it is not working as per expectation.\nHere is the code.</p>\n<pre><code>    For i = 1 To UBound(vBaseArray)\n          dSavedDate = convertDate(vBaseArray(i,1)) 'function to convert string to date\n.....          some code\n          For j = i To UBound(vBaseArray) 'function to convert string to date\n\n               If DateDiff(&quot;n&quot;, dSearchDate, dSavedDate) &gt;= 1 And DateDiff(&quot;n&quot;, dSearchDate, dSavedDate) &lt;= 2 Then\n\n                 ----some code\n</code></pre>\n<p>but the result is not as per expectation\nif dSavedDate  is Thu Mar 02 01:14:28 EST 2017 then\nif statement is returning me following timestamps</p>\n<blockquote>\n<p>Thu Mar 02 01:12:24 EST 2017</p>\n<p>Thu Mar 02 01:12:44 EST 2017</p>\n<p>Thu Mar 02 01:12:40 EST 2017</p>\n<p>Thu Mar 02 00:47:12 EST 2017</p>\n</blockquote>\n<p>whereas I want timestamps which will be &gt;= 1 minute of dSavedDate</p>\n<p>what is it that I am doing wrong?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 2, "creation_date": 1489606986, "post_id": 42819244, "comment_id": 72750251, "body": "put the not after the If: <code>if not application.intersect(r1,r2) is nothing</code>"}], "answers": [{"tags": [], "owner": {"reputation": 1148, "user_id": 7231593, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kvB-QD-A2Xs/AAAAAAAAAAI/AAAAAAAAAE4/LRTmHQQqx44/photo.jpg?sz=128", "display_name": "John Muggins", "link": "https://stackoverflow.com/users/7231593/john-muggins"}, "is_accepted": false, "score": 1, "last_activity_date": 1489609599, "creation_date": 1489609599, "answer_id": 42820025, "question_id": 42819244, "link": "https://stackoverflow.com/questions/42819244/vba-for-excel-how-to-check-intersection-of-ranges-are-not-empty/42820025#42820025", "title": "VBA for Excel - How to check intersection of ranges are not empty", "body": "<p>To see if the intersection is empty you can use </p>\n\n<pre><code>If Not Application.WorksheetFunction.CountA(Application.Intersect(rng1, rng2)) &gt; 0 Then\n    MsgBox \"You Intersection is Empty!\"\n    Exit Sub\nEnd If\n</code></pre>\n\n<p>To see if 3 ranges intersect together is tougher.  Here's the logic</p>\n\n<p>if a and b and c intersect than do something.</p>\n\n<pre><code>Set isect = Application.Intersect(Range(\"rg1\"), Range(\"rg2\")) \nSet fsect = Application.Intersect(Range(\"rg2\"), Range(\"rg3\")) \nSet gsect = Application.Intersect(Range(\"rg1\"), Range(\"rg3\")) \nif isect = True and fsect = Tru and gsect = True then\n   '  They all intersect each other\n   '  Put your code here\nend if\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": false, "score": 4, "last_activity_date": 1489611520, "last_edit_date": 1489611520, "creation_date": 1489610391, "answer_id": 42820262, "question_id": 42819244, "link": "https://stackoverflow.com/questions/42819244/vba-for-excel-how-to-check-intersection-of-ranges-are-not-empty/42820262#42820262", "title": "VBA for Excel - How to check intersection of ranges are not empty", "body": "<p>To see if the intersection of two ranges is a third range:</p>\n\n<pre><code>Set intRng =  Intersect(R1, R2)\nIf Not intRng Is Nothing then\n    Set intRng =  Intersect(intRng, R3)\n    If Not Intersect(intRng) Is Nothing\n        If intRng.Address = R3.Address Then MsgBox \"intersection of ranges R1 and R2 is range R3\"\n    End If\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 145, "user_id": 7698709, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e18e5ad2390d6263fc3d1be8459519e6?s=128&d=identicon&r=PG&f=1", "display_name": "mathstackuser123", "link": "https://stackoverflow.com/users/7698709/mathstackuser123"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2666, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1489611520, "creation_date": 1489606907, "last_edit_date": 1531164843, "question_id": 42819244, "link": "https://stackoverflow.com/questions/42819244/vba-for-excel-how-to-check-intersection-of-ranges-are-not-empty", "title": "VBA for Excel - How to check intersection of ranges are not empty", "body": "<p>I have two questions:\n1) How do I check if  the intersection or a range is not empty? For example if I want to check if its empty I write for example</p>\n\n<pre><code>if application.intersect(r1,r2) is nothing\n</code></pre>\n\n<p>but is there something that is negation of nothing? not nothing didn't work for example.</p>\n\n<p>2) How can I compate ranges? For example I have ranges r1,r2,r3 and I want to check if the intersection of r1 and r2 is r3. Two thing that I have tried and didn't work:</p>\n\n<pre><code>1 - application.intersect(r1,r2) = r3\n2 - application.intersect(r1,r2) is r3\n</code></pre>\n\n<p>Would appreciate any help that I can get, Thanks!</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "edited": false, "score": 0, "creation_date": 1489610200, "post_id": 42819208, "comment_id": 72752092, "body": "You&#39;d have to combine the state of each of the checkboxes into a filter for your table. What does your code look like?"}, {"owner": {"reputation": 73, "user_id": 4705731, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/97642a12edf4c73f737b4f7147ffe37e?s=128&d=identicon&r=PG&f=1", "display_name": "sqlbg", "link": "https://stackoverflow.com/users/4705731/sqlbg"}, "reply_to_user": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "edited": false, "score": 0, "creation_date": 1489611622, "post_id": 42819208, "comment_id": 72752915, "body": "@peterT --&gt; I actually opted back for the radio button and added one that read &quot;All&quot;. So there are 6 radio buttons in total. If one of the five are selected then the table should filter on values that contain that specific text. If &quot;All&quot; is selected then it should filter on values that contain any one of the 5 specific texts. So now I&#39;m at square one again!"}, {"owner": {"reputation": 73, "user_id": 4705731, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/97642a12edf4c73f737b4f7147ffe37e?s=128&d=identicon&r=PG&f=1", "display_name": "sqlbg", "link": "https://stackoverflow.com/users/4705731/sqlbg"}, "reply_to_user": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "edited": false, "score": 0, "creation_date": 1489612874, "post_id": 42819208, "comment_id": 72753556, "body": "@PeterT, I&#39;ve added my current code here for the first three buttons. However, its telling me there&#39;s a bug when using the radio buttons...around this area: ActiveSheet.PivotTables(&quot;PivotTable1&quot;).PivotFields(&quot;Eligible Win Type&quot;). _         PivotFilters.Add2 Type:=xlCaptionContains, Value1:=&quot;Incr Phys&quot;"}], "answers": [{"tags": [], "owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "is_accepted": false, "score": 0, "last_activity_date": 1506011174, "last_edit_date": 1506011174, "creation_date": 1489762143, "answer_id": 42860542, "question_id": 42819208, "link": "https://stackoverflow.com/questions/42819208/vba-function-to-filter-pivot-table-based-on-option-button-form-control/42860542#42860542", "title": "VBA Function to Filter Pivot Table Based on Option Button Form Control", "body": "<p>It's clear you've recorded a macro to capture the VBA as an example of where to start. Very good move, because that can reveal some of the methods you wouldn't otherwise know about. Once you've done that, there are a few things you can do to help debug the code and help see what's happening more clearly.</p>\n\n<ol>\n<li>Edit the code to remove <code>Activate</code> and <code>Select</code>. </li>\n<li>Define and set references to <code>Worksheets</code> and <code>Workbooks</code>. It will help you avoid problems later on when you try to expand your work.</li>\n<li>When you're having an unknown issue, break apart the individual pieces of a single compound statement. That way you can isolate exactly which part of the action is giving you the error. I've done this below to access different parts of your <code>PivotTable</code></li>\n</ol>\n\n<p>What I think you were missing is to <code>ClearAllFilters</code> before re-applying a new filter.</p>\n\n\n\n<pre><code>Option Explicit\n\nSub Incr_Phys()\n'\n' Incr_Phys Macro\n'\n    Dim thisWB As Workbook\n    Dim pivotWS As Worksheet\n    Set thisWB = ThisWorkbook\n    Set pivotWS = thisWB.Sheets(\"Sheet5\")\n\n    Dim thisPT As PivotTable\n    Dim winType As PivotField\n    Set thisPT = pivotWS.PivotTables(\"PivotTable1\")\n    Set winType = thisPT.PivotFields(\"Eligible Win Type\")\n    With winType\n        .ClearAllFilters\n        .PivotFilters.Add2 Type:=xlCaptionContains, Value1:=\"Incr Phys\"\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 73, "user_id": 4705731, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/97642a12edf4c73f737b4f7147ffe37e?s=128&d=identicon&r=PG&f=1", "display_name": "sqlbg", "link": "https://stackoverflow.com/users/4705731/sqlbg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1220, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1506011226, "creation_date": 1489606753, "last_edit_date": 1506011226, "question_id": 42819208, "link": "https://stackoverflow.com/questions/42819208/vba-function-to-filter-pivot-table-based-on-option-button-form-control", "title": "VBA Function to Filter Pivot Table Based on Option Button Form Control", "body": "<p>I have a pivot table that has a column containing text. I also have 5 option buttons. Via VBA code I would like to filter a column of the pivot table if it CONTAINS a certain text. I would need five different contains functions to account for the various combinations. I then plan to assign these macros to the option buttons. I've browsed various forums but couldn't get it to work as they described it and they never built it exactly how I'm describing it here.</p>\n\n<p>This is what I have so far for 3 of the buttons, but I'm getting an error when I click off one button and onto another:</p>\n\n<pre><code>Sub Incr_Phys()\n'\n' Incr_Phys Macro\n'\n\n'\n    ActiveSheet.PivotTables(\"PivotTable1\").PivotFields(\"Eligible Win Type\"). _\n        PivotFilters.Add2 Type:=xlCaptionContains, Value1:=\"Incr Phys\"\n    Selection.End(xlToLeft).Select\n    Selection.End(xlUp).Select\nEnd Sub\nSub All_Win_Types()\n'\n' All_Win_Types Macro\n'\n\n'\n    ActiveSheet.PivotTables(\"PivotTable1\").PivotFields(\"Eligible Win Type\"). _\n        PivotFilters.Add2 Type:=xlCaptionContains, Value1:=\"?\"\n    Selection.End(xlToLeft).Select\n    Selection.End(xlUp).Select\n    Selection.End(xlToLeft).Select\n    Selection.End(xlUp).Select\nEnd Sub\nSub Acq()\n'\n' Acq Macro\n'\n\n'\n    ActiveSheet.PivotTables(\"PivotTable1\").PivotFields(\"Eligible Win Type\"). _\n        ClearAllFilters\n    ActiveSheet.PivotTables(\"PivotTable1\").PivotFields(\"Eligible Win Type\"). _\n        PivotFilters.Add2 Type:=xlCaptionContains, Value1:=\"Acq\"\n    Selection.End(xlToLeft).Select\n    Selection.End(xlUp).Select\n    Selection.End(xlToLeft).Select\n    Selection.End(xlUp).Select\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "pivot", "autofilter"], "comments": [{"owner": {"reputation": 45, "user_id": 6700502, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3528bcdf8f97983be02394de0c01b6e3?s=128&d=identicon&r=PG&f=1", "display_name": "Biplab1985", "link": "https://stackoverflow.com/users/6700502/biplab1985"}, "reply_to_user": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1489665110, "post_id": 42818926, "comment_id": 72775908, "body": "The problem is i am automating the entire manual task and thus cannot ask user to add another column, put formula to convert the month and year value in raw data and then refresh the pivot."}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1489665209, "post_id": 42818926, "comment_id": 72775965, "body": "Do you know the data structure ? what columns are <code>Month</code> and <code>Year</code> in ? Do you know the first empty column ? If yes, we can do it by code, and then refresh the <code>PivotTable</code> with the new Extra Column, sounds like a good start ?"}, {"owner": {"reputation": 45, "user_id": 6700502, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3528bcdf8f97983be02394de0c01b6e3?s=128&d=identicon&r=PG&f=1", "display_name": "Biplab1985", "link": "https://stackoverflow.com/users/6700502/biplab1985"}, "reply_to_user": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1489665318, "post_id": 42818926, "comment_id": 72776046, "body": "Sounds Great! Month and Year are in column N and O. First empty column is AR"}, {"owner": {"reputation": 45, "user_id": 6700502, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3528bcdf8f97983be02394de0c01b6e3?s=128&d=identicon&r=PG&f=1", "display_name": "Biplab1985", "link": "https://stackoverflow.com/users/6700502/biplab1985"}, "reply_to_user": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1489665861, "post_id": 42818926, "comment_id": 72776404, "body": "No, ThisWorkbook.Sheets(&quot;Data Input&quot;)"}], "answers": [{"comments": [{"owner": {"reputation": 40613, "user_id": 4099593, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/zweIW.png?s=128&g=1", "display_name": "Bhargav Rao", "link": "https://stackoverflow.com/users/4099593/bhargav-rao"}, "edited": false, "score": 0, "creation_date": 1489851866, "post_id": 42833930, "comment_id": 72856662, "body": "Comments are not for extended discussion; this conversation has been <a href=\"http://chat.stackoverflow.com/rooms/138400/discussion-on-answer-by-shai-rado-autofilter-last-13-months-in-pivot-table\">moved to chat</a>."}], "tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": false, "score": 0, "last_activity_date": 1489689026, "last_edit_date": 1489689026, "creation_date": 1489666811, "answer_id": 42833930, "question_id": 42818926, "link": "https://stackoverflow.com/questions/42818926/autofilter-last-13-months-in-pivot-table/42833930#42833930", "title": "Autofilter last 13 months in PIVOT TABLE", "body": "<p>The code below will add a <code>Date</code> format in Column \"AR\" of the entire data in \"Data Input\" worksheet.</p>\n\n<p>Afterwards it creates/update \"PivotTable2\" in \"margin pool\" worksheet.</p>\n\n<p>At last, it will show only record within 390d (~13 months) of the selected date in cell \"B2\".</p>\n\n<p><strong>Full Code</strong></p>\n\n<pre><code>Option Explicit\n\nSub Period_Last_12_Months()\n\nDim PvtTbl      As PivotTable\nDim PvtCache    As PivotCache\nDim PvtItm      As PivotItem\nDim PvtDataRng  As Range\n\nDim Cutoffmonth As String, CuttoffYear As String\nDim sMonthName As String\nDim Calc As String\n\nDim LastRow As Long, i As Long\n\n' === first sort the data for the Pivot Table ===\nWith Worksheets(\"Data Input\")\n    LastRow = .Cells(.Rows.Count, \"O\").End(xlUp).Row ' get last row with data in column \"O\"\n\n    .Range(\"AR2:AR\" &amp; LastRow).Formula = \"=DATEVALUE(CONCATENATE(\" &amp; Chr(34) &amp; \"1/\" &amp; Chr(34) &amp; \",N2,\" &amp; Chr(34) &amp; \"/\" &amp; Chr(34) &amp; \",O2))\"\n    .Range(\"AR2:AR\" &amp; LastRow).NumberFormat = \"m/d/yyyy\"\n\n    Set PvtDataRng = .Range(\"A1:AR\" &amp; LastRow) ' &lt;-- set the Range for the Pivot Table\nEnd With\n\n' === set the Pivot Table ===\nSet PvtCache = ActiveWorkbook.PivotCaches.Add(xlDatabase, PvtDataRng)\n\n' Set the Pivot Table (already created in previous macro run)\nOn Error Resume Next\nSet PvtTbl = ThisWorkbook.Sheets(\"margin pool\").PivotTables(\"PivotTable2\")\n\nOn Error GoTo 0\nIf PvtTbl Is Nothing Then ' &lt;-- pivot table still doesn't exist &gt;&gt; need to create it\n\n    ' create a new Pivot Table in ws2 sheet, start from Cell A5\n    Set PvtTbl = ThisWorkbook.Sheets(\"margin pool\").PivotTables.Add(PivotCache:=PvtCache, TableDestination:=ThisWorkbook.Sheets(\"margin pool\").Range(\"A5\"), TableName:=\"PivotTable2\")\n\n    With PvtTbl.PivotFields(\"MyDate\") ' add MyDate as Pivot Table's filter\n        .Orientation = xlPageField\n        .Position = 1\n    End With\nElse\n    ' just refresh the Pivot table, with updated Pivot Cache\n    PvtTbl.ChangePivotCache PvtCache\n    PvtTbl.RefreshTable\nEnd If\n\n\nDim toDate As Date\n\ntoDate = ThisWorkbook.Sheets(\"margin pool\").Range(\"B2\").Value ' &lt;-- get the date value from Cell B2\n\nApplication.ScreenUpdating = False\n\nWith PvtTbl\n    .ManualUpdate = True\n    With .PivotFields(\"MyDate\") ' &lt;-- depends on the column's header of the new column we added (I have in \"AR1\" Mydate as Text)\n        .ClearAllFilters\n        For Each PvtItm In .PivotItems\n            PvtItm.Visible = DateDiff(\"d\", CDate(PvtItm.Name), toDate) &lt; 13 * 30 ' &lt;-- less than 13 months (took 30 days in a month)\n        Next PvtItm\n    End With\n    .ManualUpdate = False\nEnd With\n\nApplication.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p>Pivot Table Fields screen-shot:</p>\n\n<p><a href=\"https://i.stack.imgur.com/MomtB.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/MomtB.png\" alt=\"enter image description here\"></a></p>\n\n<p>Pivot Table result after running this code screen-shot:</p>\n\n<ul>\n<li>Value in cell \"B2 is 01-01-2017 (Date Format)</li>\n<li>All Items within 390 days of that days are Visible</li>\n</ul>\n\n<p><a href=\"https://i.stack.imgur.com/FsdGJ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/FsdGJ.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 45, "user_id": 6700502, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3528bcdf8f97983be02394de0c01b6e3?s=128&d=identicon&r=PG&f=1", "display_name": "Biplab1985", "link": "https://stackoverflow.com/users/6700502/biplab1985"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 799, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1529138747, "creation_date": 1489605863, "last_edit_date": 1529138747, "question_id": 42818926, "link": "https://stackoverflow.com/questions/42818926/autofilter-last-13-months-in-pivot-table", "title": "Autofilter last 13 months in PIVOT TABLE", "body": "<p>I have two slicers \"Month\" and \"Year\", I need a VBA code to auto-filter the PT on selection in Slicer for example, user select Month - march and Year 2017, Filter should be applied Month - April to March and Year - 2016 &amp; 2017.</p>\n\n<pre><code>Sub Period_Last_12_Months()\n\nDim pi As PivotItem, Cutoffmonth As String, CuttoffYear As String\nDim sMonthName As String\nDim Calc As String\n\nsMonthName = ThisWorkbook.Sheets(\"margin pool\").Range(\"B1\").Value\nCutoffmonth = Format(DateAdd(\"m\", -13, CDate(sMonthName &amp; \"/1/2000\")), \"mmmm\")\ncutoffyear = ThisWorkbook.Sheets(\"margin pool\").Range(\"B2\").Value\n''  Calc = Cutoffmonth &amp; \" \" &amp; cutoffyear\nApplication.ScreenUpdating = False\nWith ThisWorkbook.Sheets(\"margin pool\").PivotTables(\"PivotTable2\")\n    .ManualUpdate = True\n    With .PivotFields(\"Month\")\n        For Each pi In .PivotItems\n            pi.Visible = (Format(CDate(pi &amp; \"/1/2000\"), \"mmmm\")) &gt; Cutoffmonth\n        Next pi\n        End With\n        With .PivotFields(\"Year\")\n        For Each pi In .PivotItems\n        pi.Visible = DateValue(pi.Year) &gt; cutoffyear\n        Next pi\n        End With\n    .ManualUpdate = False\n\n        End With\nApplication.ScreenUpdating = True\n\nEnd Sub      \n</code></pre>\n\n<h3>screenshot</h3>\n\n<p><img src=\"https://i.stack.imgur.com/4a7ag.jpg\" alt=\"screenshot\"></p>\n"}, {"tags": ["vba", "excel", "userform"], "comments": [{"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 2, "creation_date": 1489605838, "post_id": 42818872, "comment_id": 72749561, "body": "Don&#39;t rely on <code>CountA</code> to find the last used row.  It&#39;s commonly recommended to use <code>Range.End(xlUp)</code>, so in your case: <code>emptyRow = Cells(Rows.Count, &quot;F&quot;).End(xlUp).Row + 1</code>"}, {"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 1, "creation_date": 1489605922, "post_id": 42818872, "comment_id": 72749604, "body": "And then instead of Offsetting to the emptyRow, just work with it directly: <code>With Worksheets(&quot;Sheet1&quot;).Cells(emptyRow, &quot;A&quot;)</code> and then your Offset lines become <code>.Offset(, 0)...  .Offset(, 1)....</code> etc"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1489608589, "post_id": 42818872, "comment_id": 72751179, "body": "Or, if you are like me, and can never remember how many columns a column is offset from column A, you can use <code>With Worksheets(&quot;Sheet1&quot;).Cells(emptyRow, &quot;A&quot;)</code> (or just <code>With Worksheets(&quot;Sheet1&quot;).Rows(emptyRow)</code>) and replace the offsets with <code>.Cells(1, &quot;A&quot;).Value = ..</code>, <code>.Cells(1, &quot;B&quot;).Value = ..</code>, <code>.Cells(1, &quot;C&quot;).Value = ..</code>, etc."}, {"owner": {"reputation": 229, "user_id": 7729923, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/t7mS9.png?s=128&g=1", "display_name": "J. L. Muller", "link": "https://stackoverflow.com/users/7729923/j-l-muller"}, "edited": false, "score": 0, "creation_date": 1490272883, "post_id": 42818872, "comment_id": 73044573, "body": "There seems to be nothing wrong with your code. However, I would guess you may have a gap in your column &quot;F:F&quot;, used as range in in <code>WorkSheetFunction.CountA</code>. Make sure you don&#39;t have any empty cell in between the header and the last cell (bly simply using <code>Ctrl + Arrow Up&#47;Down</code>)."}, {"owner": {"reputation": 229, "user_id": 7729923, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/t7mS9.png?s=128&g=1", "display_name": "J. L. Muller", "link": "https://stackoverflow.com/users/7729923/j-l-muller"}, "edited": false, "score": 0, "creation_date": 1490273272, "post_id": 42818872, "comment_id": 73044872, "body": "As another alternative, run the code <code>WorksheetFunction.CountA(Range(&quot;F:F&quot;)) + 1</code> in the VBA Immediate Window (<code>Ctrl + G</code>) and check if the result matches with the correct row index in your worksheet."}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 7717083, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54bb7fa5093bd234943b1a80f8ff169e?s=128&d=identicon&r=PG&f=1", "display_name": "Rick ", "link": "https://stackoverflow.com/users/7717083/rick"}, "is_accepted": false, "score": 0, "last_activity_date": 1490393724, "creation_date": 1490393724, "answer_id": 43010022, "question_id": 42818872, "link": "https://stackoverflow.com/questions/42818872/excel-vba-userform-overwriting-existing-data/43010022#43010022", "title": "Excel/VBA - Userform overwriting existing data", "body": "<p>Sorry All for delayed response. We have figured that the code, whilst clunky, was still fine but there was some memory issue at play.</p>\n\n<p>The work sheet being written to was at 1400 lines, with 2 years of data inputs. Discovered that if we simply archived (cut and pasted) that all out to a new file the form and worksheet ran flawlessly again.</p>\n\n<p>Sure someone here would have figured it out in seconds on looking at the whole file but sharing the data or evening the whole code was a no-no. Thanks for your time all.</p>\n"}], "owner": {"reputation": 1, "user_id": 7717083, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54bb7fa5093bd234943b1a80f8ff169e?s=128&d=identicon&r=PG&f=1", "display_name": "Rick ", "link": "https://stackoverflow.com/users/7717083/rick"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1443, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1490393724, "creation_date": 1489605657, "question_id": 42818872, "link": "https://stackoverflow.com/questions/42818872/excel-vba-userform-overwriting-existing-data", "title": "Excel/VBA - Userform overwriting existing data", "body": "<p>I have written a user form for staff to input data on items confiscated, print out copies of said form and save all data inputted.</p>\n\n<p>This has worked well for the 2 years, but the universe has now supplied me a bigger and better idiot. Apparently Rows were deleted from the worksheet so that someone could return items to a person without leaving any record.</p>\n\n<p>Now - any data input to the form overwrites previous lines. Each new input overwrites another line higher(older). I am using  the following lines to find next empty row and enter data on work sheet. It was writing 5 rows of the same data, as the code below was now written 5 times in a row.</p>\n\n<p>I can not see where the error is - or understand how deleting Rows on worksheet would have the effect it has or change the code on the userform?</p>\n\n<pre><code>' WRITE DATA TO SPREADSHEET    \n\nemptyRow = WorksheetFunction.CountA(Range(\"F:F\")) + 1\n\nRowCount = Worksheets(\"Sheet1\").Range(\"A2\").CurrentRegion.Rows.Count\nWith Worksheets(\"Sheet1\").Range(\"A2\")\n.Offset(emptyRow, 0).Value = Me.txtSurname.Value\n.Offset(emptyRow, 1).Value = Me.numCRN.Value\n.Offset(emptyRow, 2).Value = Me.cboUnit.Value\n.Offset(emptyRow, 3).Value = DateValue(Me.txtDateConf.Value)\n.Offset(emptyRow, 4).Value = Me.numBoxnum.Value\n.Offset(emptyRow, 5).Value = Me.txtItem6.Value\n.Offset(emptyRow, 6).Value = Me.txtItemDesc6.Value\n.Offset(emptyRow, 7).Value = Me.numQTY6.Value\n.Offset(emptyRow, 8).Value = Me.cboCondition6.Value\n.Offset(emptyRow, 9).Value = Me.cboReason6.Value\nIf Me.chkHistCheck6.Value = True Then\n.Offset(emptyRow, 10).Value = \"Yes\"\nElse\n.Offset(emptyRow, 10).Value = \"No\"\nEnd If\n\nIf Me.chkHistCheck6.Value = \"\" Then\n    .Offset(emptyRow, 10).Value = \"No\"\nEnd If\n\n.Offset(emptyRow, 11).Value = Format(Now, \"dd/mm/yyyy hh:nn:ss\")\nEnd With\n</code></pre>\n"}, {"tags": ["vba", "excel", "listbox", "userform"], "comments": [{"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1489603939, "post_id": 42818303, "comment_id": 72748406, "body": "Have you tried re-initializing the listbox to a default, no selections?"}, {"owner": {"reputation": 29, "user_id": 7483682, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/aa94aff481cae8d49bd4115b5d407b91?s=128&d=identicon&r=PG&f=1", "display_name": "peejayjay", "link": "https://stackoverflow.com/users/7483682/peejayjay"}, "reply_to_user": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 1, "creation_date": 1489604151, "post_id": 42818303, "comment_id": 72748555, "body": "no, but i&#39;m not sure how that would help. I&#39;m checking if any of the multiselect listboxes are not selected by the user. If the listboxes are selected, I will carry out other steps in my code."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1489605419, "post_id": 42818303, "comment_id": 72749346, "body": "Show your code. For a long list (or even a short one) it would be preferable to <code>Exit For</code> in the event that <i>any</i> value is selected. 99% of the time you will not need to iterate the entire list."}], "answers": [{"tags": [], "owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "is_accepted": false, "score": 4, "last_activity_date": 1489605117, "creation_date": 1489605117, "answer_id": 42818719, "question_id": 42818303, "link": "https://stackoverflow.com/questions/42818303/excel-vba-check-that-no-items-are-selected-on-multiselect-listbox-without-loopi/42818719#42818719", "title": "Excel VBA: Check that no items are selected on multiselect listbox without looping", "body": "<p>There is no inbuilt property to check if anything is selected or not. Looping is the most natural way. If you have such a large dataset in listbox that is making it slow, the other way to check selected item count, on the fly, is to implement the change event and keep a count of selected items as and when they are checked. </p>\n\n<hr>\n\n<pre><code>Option Explicit\n\nDim lSelCount As Long\n\nPrivate Sub CommandButton1_Click()\n    If lSelCount &gt; 0 Then\n        MsgBox \"At least one item selected\"\n    Else\n        MsgBox \"No selection\"\n    End If\nEnd Sub\n\nPrivate Sub ListBox1_Change()\n\n    Dim bVal As Boolean\n    bVal = Me.ListBox1.Selected(ListBox1.ListIndex)\n\n    If bVal Then\n        lSelCount = lSelCount + 1\n    Else\n       lSelCount = lSelCount - 1\n    End If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 29, "user_id": 7483682, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/aa94aff481cae8d49bd4115b5d407b91?s=128&d=identicon&r=PG&f=1", "display_name": "peejayjay", "link": "https://stackoverflow.com/users/7483682/peejayjay"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1143, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1489605117, "creation_date": 1489603773, "last_edit_date": 1531164843, "question_id": 42818303, "link": "https://stackoverflow.com/questions/42818303/excel-vba-check-that-no-items-are-selected-on-multiselect-listbox-without-loopi", "title": "Excel VBA: Check that no items are selected on multiselect listbox without looping", "body": "<p>I have a few ListBoxes with MultiSelect enabled. </p>\n\n<p>Is there a way to check that none of the items in the listbox is selected by the user without looping? For a long list, the macro takes too long to check with looping.</p>\n"}, {"tags": ["excel", "loops", "optimization", "solver", "vba"], "comments": [{"owner": {"reputation": 724, "user_id": 3112610, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/VcnQ4.jpg?s=128&g=1", "display_name": "Adam", "link": "https://stackoverflow.com/users/3112610/adam"}, "edited": false, "score": 0, "creation_date": 1489604220, "post_id": 42818271, "comment_id": 72748592, "body": "You might consider asking here: <a href=\"http://codereview.stackexchange.com/help/on-topic\">codereview.stackexchange.com/help/on-topic</a> instead"}, {"owner": {"reputation": 6672, "user_id": 2446254, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/4SJnD.png?s=128&g=1", "display_name": "Cody \uff27", "link": "https://stackoverflow.com/users/2446254/cody-%ef%bc%a7"}, "edited": false, "score": 0, "creation_date": 1489609167, "post_id": 42818271, "comment_id": 72751479, "body": "Could you try <code>Engine:=1</code>  ?"}, {"owner": {"reputation": 1148, "user_id": 7231593, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kvB-QD-A2Xs/AAAAAAAAAAI/AAAAAAAAAE4/LRTmHQQqx44/photo.jpg?sz=128", "display_name": "John Muggins", "link": "https://stackoverflow.com/users/7231593/john-muggins"}, "edited": false, "score": 0, "creation_date": 1489610133, "post_id": 42818271, "comment_id": 72752058, "body": "step through it with the debugger to find your bottleneck or put timers in different sections and have them debug.print the time it took to reach those sections."}], "answers": [{"tags": [], "owner": {"reputation": 1638, "user_id": 7716885, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/2151bacaed30a0e9cff260f5ef591656?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin", "link": "https://stackoverflow.com/users/7716885/kevin"}, "is_accepted": true, "score": 0, "last_activity_date": 1498218708, "creation_date": 1498218708, "answer_id": 44720816, "question_id": 42818271, "link": "https://stackoverflow.com/questions/42818271/excel-vba-solver-loop-taking-too-long/44720816#44720816", "title": "Excel VBA Solver Loop taking too long", "body": "<p>Figured out the reason. My worksheet contained hundreds of vlookups and other reactive functions. This was causing the worksheet to re-calculate each iteration and slowing it down immensely. By hardcoding these values in, I was able to get the time down to &lt;2 minutes.</p>\n"}], "owner": {"reputation": 1638, "user_id": 7716885, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/2151bacaed30a0e9cff260f5ef591656?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin", "link": "https://stackoverflow.com/users/7716885/kevin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1235, "favorite_count": 0, "accepted_answer_id": 44720816, "answer_count": 1, "score": 0, "last_activity_date": 1498218708, "creation_date": 1489603675, "last_edit_date": 1531161705, "question_id": 42818271, "link": "https://stackoverflow.com/questions/42818271/excel-vba-solver-loop-taking-too-long", "title": "Excel VBA Solver Loop taking too long", "body": "<p>I created a code that runs through 60 optimizations through solver through 4 series of loops (each with 15 'iterations'). The code works great but it is taking FOREVER to run through (over an hour). Each optimization is a simple linear model (global solution is found), just changing which month I am looking at.</p>\n\n<p>Problem setup: I am trying to minimize the number of workers/test rigs that will satisfy the intake with the constraint of being under capacity.</p>\n\n<p>I am not sure how I can make it go any faster, but I cannot send this to other people and expect them to use it. Does anybody have any suggestions?</p>\n\n<p>Below is my code:</p>\n\n<pre><code>Sub Optimization()\n\nApplication.ScreenUpdating = False\n\n'Unlocks workbook to allow updating\nCall Unlock_Workbook\n\n'Makes visible and selects the tab where the optimization problem is set up\nSheets(\"Optimization\").Visible = True\nSheets(\"Optimization\").Select\n\n'Clear variable ranges that solver will change\nRange(\"Worker_All[[1]:[15]]\").Clear\nRange(\"TestRig_All[[1]:[15]]\").Clear\nRange(\"Worker_787[[1]:[15]]\").Clear\nRange(\"TestRig_787[[1]:[15]]\").Clear\n\n'Install the Add-in for users who have no done this already\nAddIns(\"Solver Add-in\").Installed = True\n\n\n'Optimized All Workers\n\nFor i = 1 To 15\n\n'Cell address for objective\nMin = Cells(3, 2 + i).Address\n'Cell adress for variable\nVariable = Range(\"Worker_All[\" &amp; i &amp; \"]\").Address\n'Cell address for constraint range\nConstraintRange = Range(\"IntakeHours_NonKeyWO[\" &amp; i &amp; \"]\").Address\n'Cell address for constrants\nConstraint = Range(\"IntakeHours_NonKeyWOC[\" &amp; i &amp; \"]\").Address\n\nSolverReset\n\nSolverOk SetCell:=Min, MaxMinVal:=2, ValueOf:=0, ByChange:=Variable, _\n    Engine:=2, EngineDesc:=\"Simplex LP\"\nSolverAdd CellRef:=ConstraintRange, Relation:=1, FormulaText:=Constraint\nSolverSolve True\n\nNext i\n\n'Optimized All Test Rigs\n\nFor i = 1 To 15\n\nMin = Cells(4, 2 + i).Address\nVariable = Range(\"TestRig_All[\" &amp; i &amp; \"]\").Address\nConstraintRange = Range(\"IntakeHours_NonKeyMO[\" &amp; i &amp; \"]\").Address\nConstraint = Range(\"IntakeHours_NonKeyMOC[\" &amp; i &amp; \"]\").Address\n\nSolverReset\n\nSolverOk SetCell:=Min, MaxMinVal:=2, ValueOf:=0, ByChange:=Variable, _\n    Engine:=2, EngineDesc:=\"Simplex LP\"\nSolverAdd CellRef:=ConstraintRange, Relation:=1, FormulaText:=Constraint\nSolverSolve True\n\nNext i\n\n'Optimized 787 Workers\n\nFor i = 1 To 15\n\nMin = Cells(5, 2 + i).Address\nVariable = Range(\"Worker_787[\" &amp; i &amp; \"]\").Address\nConstraintRange = Range(\"IntakeHours_Key787WO[\" &amp; i &amp; \"]\").Address\nConstraint = Range(\"IntakeHours_Key787WOC[\" &amp; i &amp; \"]\").Address\n\nSolverReset\n\nSolverOk SetCell:=Min, MaxMinVal:=2, ValueOf:=0, ByChange:=Variable, _\n    Engine:=2, EngineDesc:=\"Simplex LP\"\nSolverAdd CellRef:=ConstraintRange, Relation:=1, FormulaText:=Constraint\nSolverSolve True\n\nNext i\n\n'Optimized 787 Test Rigs\n\nFor i = 1 To 15\n\nMin = Cells(6, 2 + i).Address\nVariable = Range(\"TestRig_787[\" &amp; i &amp; \"]\").Address\nConstraintRange = Range(\"IntakeHours_Key787MO[\" &amp; i &amp; \"]\").Address\nConstraint = Range(\"IntakeHours_Key787MOC[\" &amp; i &amp; \"]\").Address\n\nSolverReset\n\nSolverOk SetCell:=Min, MaxMinVal:=2, ValueOf:=0, ByChange:=Variable, _\n    Engine:=2, EngineDesc:=\"Simplex LP\"\nSolverAdd CellRef:=ConstraintRange, Relation:=1, FormulaText:=Constraint\nSolverSolve True\n\nNext i\n\nSheets(\"Cell Summary\").Select\nSheets(\"Optimization\").Visible = False\n\nCall Lock_Workbook\n\nApplication.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-access", "sql-server-2008-r2", "ms-access-2013"], "answers": [{"comments": [{"owner": {"reputation": 967, "user_id": 6860396, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/2335c5b5ac2454a5b20ba41ab74f95f0?s=128&d=identicon&r=PG&f=1", "display_name": "BellHopByDayAmetuerCoderByNigh", "link": "https://stackoverflow.com/users/6860396/bellhopbydayametuercoderbynigh"}, "edited": false, "score": 0, "creation_date": 1489607158, "post_id": 42819220, "comment_id": 72750357, "body": "This gives me a VBA error of query timeout.  I tried to add <code>.ActiveConnection.CommandTimeout = 0</code> but still shows error."}, {"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "reply_to_user": {"reputation": 967, "user_id": 6860396, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/2335c5b5ac2454a5b20ba41ab74f95f0?s=128&d=identicon&r=PG&f=1", "display_name": "BellHopByDayAmetuerCoderByNigh", "link": "https://stackoverflow.com/users/6860396/bellhopbydayametuercoderbynigh"}, "edited": false, "score": 0, "creation_date": 1489622676, "post_id": 42819220, "comment_id": 72757516, "body": "Why set it to zero seconds? Your query may be running longer than the default 30 seconds. Try adding <code>.commandTimeout = 60</code> in the <code>With</code> block for 60 seconds."}, {"owner": {"reputation": 1540, "user_id": 7149748, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7517a3bbc9ae7afe5772ab3632edf5d?s=128&d=identicon&r=PG&f=1", "display_name": "Skippy", "link": "https://stackoverflow.com/users/7149748/skippy"}, "edited": false, "score": 0, "creation_date": 1489702403, "post_id": 42819220, "comment_id": 72799925, "body": "@Parfait - setting a timeout to zero means &#39;infinite timeout&#39;, not &#39;default timeout&#39;."}], "tags": [], "owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "is_accepted": true, "score": 2, "last_activity_date": 1489606826, "creation_date": 1489606826, "answer_id": 42819220, "question_id": 42818195, "link": "https://stackoverflow.com/questions/42818195/run-stored-procedure-from-access-vba/42819220#42819220", "title": "Run Stored Procedure From Access VBA", "body": "<p>Consider using <code>Format()</code> to convert MS Access dates to string as concatenating quotes will not work. Also, use <code>CONVERT()</code> to convert varchar strings to date in SQL Server. The format <code>YYYY-MM-DD</code> is used to not be dependent on cultural settings with placement of months and days.</p>\n\n<p><strong>VBA</strong></p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Private Sub btnRunStoredProc_Click()\n    Dim cmd As ADODB.Command, startdate As String, enddate As String\n\n    Set cmd = New ADODB.Command\n\n    startdate = Format(Me.txtStartDate, \"YYYY-MM-DD\")\n    enddate = Format(Me.txtEndDate, \"YYYY-MM-DD\")\n\n    With cmd\n       .ActiveConnection = \"Provider=sqloledb;Server=Server;Database=DB;Trusted_Connection=yes;\"\n       .CommandType = adCmdStoredProc\n       .CommandText = \"runstoredproc\"\n       .Parameters.Append .CreateParameter(\"@startdate\", adVarChar, adParamInput, 255, startdate)\n       .Parameters.Append .CreateParameter(\"@enddate\", adVarChar, adParamInput, 255, enddate)\n       .Execute\n    End With\n\n    Set cmd = Nothing\nEnd Sub\n</code></pre>\n\n<p><strong>TSQL</strong></p>\n\n<pre class=\"lang-sql prettyprint-override\"><code>ALTER Procedure [dbo].[runstoredproc]\n(\n       @startdate varchar(100)\n       ,@enddate varchar(100) \n)\nAs\n\nSELECT * FROM [helper]\nWHERE hiredate BETWEEN CONVERT(DATE, @startdate) AND CONVERT(DATE, @enddate)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 967, "user_id": 6860396, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/2335c5b5ac2454a5b20ba41ab74f95f0?s=128&d=identicon&r=PG&f=1", "display_name": "BellHopByDayAmetuerCoderByNigh", "link": "https://stackoverflow.com/users/6860396/bellhopbydayametuercoderbynigh"}, "edited": false, "score": 0, "creation_date": 1489616795, "post_id": 42821485, "comment_id": 72755385, "body": "Even if I alter to a datetime datatype I still receive the error query timeout"}, {"owner": {"reputation": 1540, "user_id": 7149748, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7517a3bbc9ae7afe5772ab3632edf5d?s=128&d=identicon&r=PG&f=1", "display_name": "Skippy", "link": "https://stackoverflow.com/users/7149748/skippy"}, "reply_to_user": {"reputation": 967, "user_id": 6860396, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/2335c5b5ac2454a5b20ba41ab74f95f0?s=128&d=identicon&r=PG&f=1", "display_name": "BellHopByDayAmetuerCoderByNigh", "link": "https://stackoverflow.com/users/6860396/bellhopbydayametuercoderbynigh"}, "edited": false, "score": 0, "creation_date": 1489618770, "post_id": 42821485, "comment_id": 72756205, "body": "What if you run this sp manually in SQL Enterprise Manager? How long does it take? Can you do this from the same machine that you&#39;re running Access on, and with the same credentials?"}], "tags": [], "owner": {"reputation": 1540, "user_id": 7149748, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7517a3bbc9ae7afe5772ab3632edf5d?s=128&d=identicon&r=PG&f=1", "display_name": "Skippy", "link": "https://stackoverflow.com/users/7149748/skippy"}, "is_accepted": false, "score": 0, "last_activity_date": 1489615230, "creation_date": 1489615230, "answer_id": 42821485, "question_id": 42818195, "link": "https://stackoverflow.com/questions/42818195/run-stored-procedure-from-access-vba/42821485#42821485", "title": "Run Stored Procedure From Access VBA", "body": "<p>Any reason your parameters can't be date/time data type? What is the data type of your <code>hiredate</code> column? This has always worked for me:</p>\n\n<pre><code>Private Sub btnRunStoredProc_Click()\nDim cmd As ADODB.Command, startdate As Date, enddate As Date\n    Set cmd = New ADODB.Command\n    startdate = CVDate(Me.txtStartDate)\n    enddate = CVDate(Me.txtEndDate)\n    cmd.ActiveConnection = \"Provider=sqloledb;Server=Server;Database=DB;Trusted_Connection=yes;\"\n    cmd.CommandType = adCmdStoredProc\n    cmd.CommandText = \"runstoredproc\"\n    cmd.Parameters.Append cmd.CreateParameter(\"@startdate\", adDBTimeStamp, adParamInput, , startdate)\n    cmd.Parameters.Append cmd.CreateParameter(\"@enddate\", adDBTimeStamp, adParamInput, , enddate)\n    cmd.Execute\nEnd Sub\n\n\nALTER Procedure [dbo].[runstoredproc]\n(\n       @startdate datetime\n       ,@enddate datetime \n)\nAs\n\nSelect * from helper where hiredate between @startdate And @enddate\n</code></pre>\n"}], "owner": {"reputation": 967, "user_id": 6860396, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/2335c5b5ac2454a5b20ba41ab74f95f0?s=128&d=identicon&r=PG&f=1", "display_name": "BellHopByDayAmetuerCoderByNigh", "link": "https://stackoverflow.com/users/6860396/bellhopbydayametuercoderbynigh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3590, "favorite_count": 0, "accepted_answer_id": 42819220, "answer_count": 2, "score": 2, "last_activity_date": 1489615230, "creation_date": 1489603472, "question_id": 42818195, "link": "https://stackoverflow.com/questions/42818195/run-stored-procedure-from-access-vba", "title": "Run Stored Procedure From Access VBA", "body": "<p>I keep getting an error of </p>\n\n<blockquote>\n  <p>Conversion failed when converting date and/or time from character string.</p>\n</blockquote>\n\n<p>This is my vba I am using as well as my sql server stored procedure syntax.  What should I alter in order to have this run succesfully?</p>\n\n<pre><code>Private Sub btnRunStoredProc_Click()\nDim cmd As ADODB.Command, startdate As String, enddate As String\n    Set cmd = New ADODB.Command\n    startdate = \"'\" &amp; Me.txtStartDate &amp; \"'\"\n    enddate = \"'\" &amp; Me.txtEndDate &amp; \"'\"\n    cmd.ActiveConnection = \"Provider=sqloledb;Server=Server;Database=DB;Trusted_Connection=yes;\"\n    cmd.CommandType = adCmdStoredProc\n    cmd.CommandText = \"runstoredproc\"\n    cmd.Parameters.Append cmd.CreateParameter(\"@startdate\", adVarChar, adParamInput, 255, startdate)\n    cmd.Parameters.Append cmd.CreateParameter(\"@enddate\", adVarChar, adParamInput, 255, enddate)\n    cmd.Execute\nEnd Sub\n\n\nALTER Procedure [dbo].[runstoredproc]\n(\n       @startdate varchar(100)\n       ,@enddate varchar(100) \n)\nAs\n\nSelect * from helper where hiredate between @startdate And @enddate\n</code></pre>\n"}, {"tags": ["vba", "excel", "validation"], "answers": [{"comments": [{"owner": {"reputation": 57, "user_id": 7716935, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fd916f1805b3a7248129616c9b896060?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad M", "link": "https://stackoverflow.com/users/7716935/vlad-m"}, "edited": false, "score": 0, "creation_date": 1489603763, "post_id": 42818108, "comment_id": 72748290, "body": "Wow I totally didn&#39;t know about the &quot;Case&quot; clause. Thank you so much for the help, I think that solved it. Issue was I was constantly changing my &quot;Target.Column&quot; by offsetting. Your first solution didn&#39;t work, it resulted in the same problem I was facing beforehand. The &quot;Select Case&quot; seemed to have fixed it, thank you once again!"}], "tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": true, "score": 0, "last_activity_date": 1489603122, "creation_date": 1489603122, "answer_id": 42818108, "question_id": 42818042, "link": "https://stackoverflow.com/questions/42818042/data-validation-on-worksheet-change-vba/42818108#42818108", "title": "Data validation on worksheet change vba", "body": "<p>Change this :</p>\n\n<pre><code>If Target.Column = 62 Or 75 Or 88 Or 101 Or 114 Then \n</code></pre>\n\n<p>to :</p>\n\n<pre><code>If Target.Column = 62 Or Target.Column = 75 Or Target.Column = 88 Or Target.Column = 101 Or Target.Column = 114 Then\n</code></pre>\n\n<p>Or better yet, change to <code>Select Case</code>:</p>\n\n<pre><code>Select Case Target.Column\n    Case 62, 75, 88, 101, 114\n        ' rest of your code goes here...\n\nEnd Select\n</code></pre>\n\n<p><strong><em>Note</em></strong>: You need to modify it also for the first time:</p>\n\n<pre><code>If Target.Column = 59 Or 72 Or 85 Or 98 Or 111 Then 'Refers to the columns that require Rec/Ass\n</code></pre>\n"}], "owner": {"reputation": 57, "user_id": 7716935, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fd916f1805b3a7248129616c9b896060?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad M", "link": "https://stackoverflow.com/users/7716935/vlad-m"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 483, "favorite_count": 0, "accepted_answer_id": 42818108, "answer_count": 1, "score": 2, "last_activity_date": 1489603122, "creation_date": 1489602900, "question_id": 42818042, "link": "https://stackoverflow.com/questions/42818042/data-validation-on-worksheet-change-vba", "title": "Data validation on worksheet change vba", "body": "<p>I am trying to do some data validation in excel that would limit the user entry based on previous user input. I would like this to be updated based on worksheet change. The code is as follows:</p>\n\n<pre><code>    Private Sub Worksheet_Change(ByVal Target As Range)\n'If Target.Cells.Count &gt; 1 Then Exit Sub\n'Checks if cell is Record or Assumption and applies appropriate data validation\nDim Cell As Range\nApplication.EnableEvents = False\n    If Target.Column = 59 Or 72 Or 85 Or 98 Or 111 Then 'Refers to the columns that require Rec/Ass\n        Set Cell = Target.Offset(0, 3)\n'MsgBox Cell &amp; \" \" &amp; Target.Value 'USED TO ERROR CHECK\n        If Target.Value = \"N/A\" Then\n            Cell.Validation.Delete\n            Cell.Value = vbNullString\n            Cell.Offset(0, 1).Validation.Delete\n            Cell.Offset(0, 1).Value = vbNullString\n        Else\n            If Target.Value = \"Record\" Then\n                With Cell.Validation\n                    .Delete\n                    .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:=xlBetween, Formula1:=\"=Record\"\n                End With\n            ElseIf Target.Value = \"Assumption\" Then\n                Cell.Validation.Delete\n                Cell.Value = vbNullString\n                Cell.Offset(0, 1).Value = vbNullString\n            End If\n        End If\n        Set Cell = ActiveCell\n    End If\n\n    If Target.Column = 62 Or 75 Or 88 Or 101 Or 114 Then 'Refers to the columns that require Doc Type\n        Desig = Application.VLookup(Target.Value, Sheets(\"Record Source Chart\").Range(\"RecordDesig\"), 21, False)\n        If Target.Value = \"\" Then Exit Sub\n        Else\n            Set Cell = Target.Offset(0, 1)\n            With Cell.Validation\n                .Delete\n                .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:=xlBetween, Formula1:=\"=\" &amp; Desig\n            End With\n    End If\nApplication.EnableEvents = True\nEnd Sub\n</code></pre>\n\n<p>I am having an issue with the second if statement. When I run this code, the second data.validation is not added - I think this is because the cell is blank until I update it, but even after I update it the validation does not go through. Also, if I delete <code>If Target.Value = \"\" Then Exit Sub</code>even though the Target.Column = 59, the second if statement runs and returns a \"Type Mismatch\" error. Any help is greatly appreciated, thank you.</p>\n"}, {"tags": ["vba", "excel", "ms-word", "worksheet"], "comments": [{"owner": {"reputation": 4190, "user_id": 6255978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2dd9f928c263c57925ad9f4703612e9c?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/6255978/dave"}, "edited": false, "score": 2, "creation_date": 1489603859, "post_id": 42817760, "comment_id": 72748359, "body": "Can you give an example of the data you are copying?  Also, which half is cut off?  Do you lose the bottom of the table, or does the second column run off the right hand side of the page?"}, {"owner": {"reputation": 729, "user_id": 7673876, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2c7e90895b2f01c5cb8df8e49a32ead2?s=128&d=identicon&r=PG&f=1", "display_name": "David Kris", "link": "https://stackoverflow.com/users/7673876/david-kris"}, "reply_to_user": {"reputation": 4190, "user_id": 6255978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2dd9f928c263c57925ad9f4703612e9c?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/6255978/dave"}, "edited": false, "score": 0, "creation_date": 1489604095, "post_id": 42817760, "comment_id": 72748509, "body": "The Second column runs off the right hand side of the page."}, {"owner": {"reputation": 4190, "user_id": 6255978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2dd9f928c263c57925ad9f4703612e9c?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/6255978/dave"}, "edited": false, "score": 0, "creation_date": 1489604196, "post_id": 42817760, "comment_id": 72748578, "body": "Have you considered using Landscape mode instead of Portrait in Word?  Or is the table too large even then?  You only have two columns - just how large is the data in each column?  Can you provide an example of the data in use?"}, {"owner": {"reputation": 729, "user_id": 7673876, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2c7e90895b2f01c5cb8df8e49a32ead2?s=128&d=identicon&r=PG&f=1", "display_name": "David Kris", "link": "https://stackoverflow.com/users/7673876/david-kris"}, "reply_to_user": {"reputation": 4190, "user_id": 6255978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2dd9f928c263c57925ad9f4703612e9c?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/6255978/dave"}, "edited": false, "score": 0, "creation_date": 1489605135, "post_id": 42817760, "comment_id": 72749177, "body": "Just uploaded a pic of the sheet"}], "answers": [{"comments": [{"owner": {"reputation": 729, "user_id": 7673876, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2c7e90895b2f01c5cb8df8e49a32ead2?s=128&d=identicon&r=PG&f=1", "display_name": "David Kris", "link": "https://stackoverflow.com/users/7673876/david-kris"}, "edited": false, "score": 0, "creation_date": 1489612215, "post_id": 42819059, "comment_id": 72753211, "body": "Method or data member not found error .Tables(1).AutoFitBehavior 2 &#39;wdAutoFitWindow"}, {"owner": {"reputation": 4190, "user_id": 6255978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2dd9f928c263c57925ad9f4703612e9c?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/6255978/dave"}, "reply_to_user": {"reputation": 729, "user_id": 7673876, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2c7e90895b2f01c5cb8df8e49a32ead2?s=128&d=identicon&r=PG&f=1", "display_name": "David Kris", "link": "https://stackoverflow.com/users/7673876/david-kris"}, "edited": false, "score": 0, "creation_date": 1489612296, "post_id": 42819059, "comment_id": 72753253, "body": "Oops.  Tables is a collections belonging to a <code>Document</code> object - edited."}], "tags": [], "owner": {"reputation": 4190, "user_id": 6255978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2dd9f928c263c57925ad9f4703612e9c?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/6255978/dave"}, "is_accepted": true, "score": 1, "last_activity_date": 1489612274, "last_edit_date": 1489612274, "creation_date": 1489606277, "answer_id": 42819059, "question_id": 42817760, "link": "https://stackoverflow.com/questions/42817760/excel-vba-button-copy-worksheet-to-new-word-doc/42819059#42819059", "title": "Excel VBA Button Copy WorkSheet to New Word Doc", "body": "<p>You can use the Word <code>AutoFit</code> command to make the table fit into the document.  I've included code to swap the orientation to Landscape as well but this may not be necessary.</p>\n\n<pre><code>Sub btnExport()\n    Dim objWord As Word.Application\n    Range(\"C2:D60\").Copy ' you should name the worksheet as well here really\n\n    Set objWord = CreateObject(\"Word.Application.14\")\n    With objWord\n        .Documents.Add\n        .ActiveDocument.PageSetup.Orientation = 1 'wdOrientLandscape\n        .Visible = True\n        .Selection.Paste\n        .ActiveDocument.Tables(1).AutoFitBehavior 2 'wdAutoFitWindow\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 729, "user_id": 7673876, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2c7e90895b2f01c5cb8df8e49a32ead2?s=128&d=identicon&r=PG&f=1", "display_name": "David Kris", "link": "https://stackoverflow.com/users/7673876/david-kris"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1173, "favorite_count": 0, "accepted_answer_id": 42819059, "answer_count": 1, "score": 0, "last_activity_date": 1489612274, "creation_date": 1489602133, "last_edit_date": 1489605097, "question_id": 42817760, "link": "https://stackoverflow.com/questions/42817760/excel-vba-button-copy-worksheet-to-new-word-doc", "title": "Excel VBA Button Copy WorkSheet to New Word Doc", "body": "<p>The code below copies a table I have in a work sheet and pastes it in a new Microsoft Word Document. The only issue is it cuts off half the table when pasted in the word document. Any suggestions? Thanks.</p>\n\n<pre><code>Sub btnExport()\nDim objWord As Word.Application\nRange(\"C2:D60\").Copy\n\nSet objWord = CreateObject(\"Word.Application.14\")\nWith objWord\n    .Documents.Add\n    .Visible = True\n    .Selection.Paste\nEnd With\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/fFUna.png\" rel=\"nofollow noreferrer\">Sheet I'm using</a></p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 4, "creation_date": 1489602023, "post_id": 42817685, "comment_id": 72747271, "body": "<code>SeachOrder</code> &lt;&gt; <code>SearchOrder</code>, <code>SeachDirection</code> &lt;&gt; <code>SearchDirection</code>."}, {"owner": {"reputation": 101, "user_id": 7716843, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/82f02bb293aa83e553f293fb8905e581?s=128&d=identicon&r=PG&f=1", "display_name": "Exulansis", "link": "https://stackoverflow.com/users/7716843/exulansis"}, "reply_to_user": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1489602720, "post_id": 42817685, "comment_id": 72747682, "body": "I am not sure what this means...? Sorry!"}, {"owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "edited": false, "score": 0, "creation_date": 1489602868, "post_id": 42817685, "comment_id": 72747776, "body": "you are missing <b>r</b> in seachOrder"}, {"owner": {"reputation": 101, "user_id": 7716843, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/82f02bb293aa83e553f293fb8905e581?s=128&d=identicon&r=PG&f=1", "display_name": "Exulansis", "link": "https://stackoverflow.com/users/7716843/exulansis"}, "edited": false, "score": 0, "creation_date": 1489603159, "post_id": 42817685, "comment_id": 72747966, "body": "Well. That&#39;s embarrassing. Thank you!"}], "answers": [{"tags": [], "owner": {"reputation": 12253, "user_id": 16473, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d2588c9db71e7201288ff9f74ba219ca?s=128&d=identicon&r=PG", "display_name": "Gordon Bell", "link": "https://stackoverflow.com/users/16473/gordon-bell"}, "is_accepted": true, "score": 0, "last_activity_date": 1489602919, "creation_date": 1489602919, "answer_id": 42818046, "question_id": 42817685, "link": "https://stackoverflow.com/questions/42817685/vba-named-argument-not-found-multiple-finds/42818046#42818046", "title": "VBA: Named Argument Not Found, Multiple .Finds", "body": "<pre><code>SeachOrder:=xlByRows, _\nSeachDirection:=xlNext, _\n</code></pre>\n\n<p>Those are typos.  Search not Seach!</p>\n"}], "owner": {"reputation": 101, "user_id": 7716843, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/82f02bb293aa83e553f293fb8905e581?s=128&d=identicon&r=PG&f=1", "display_name": "Exulansis", "link": "https://stackoverflow.com/users/7716843/exulansis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 578, "favorite_count": 0, "closed_date": 1489610512, "accepted_answer_id": 42818046, "answer_count": 1, "score": 1, "last_activity_date": 1489602919, "creation_date": 1489601892, "question_id": 42817685, "link": "https://stackoverflow.com/questions/42817685/vba-named-argument-not-found-multiple-finds", "closed_reason": "Not suitable for this site", "title": "VBA: Named Argument Not Found, Multiple .Finds", "body": "<p>I have been trying to get VBA to search a column of cells (that will be user-populated) to find specific criteria. After struggling with WorksheetFunction.CountIfs(, I've settled on this code, and up to this point, it seemed to work:</p>\n\n<pre><code>Sub CalendarColor()\n\nCall VarDef\n\nDim SearchEmpList As Range\nDim SearchSDate As Range\nDim SearchEDate As Range\nDim SearchLType As Range\nDim SearchPType As Range\n\nIf EmpName &lt;&gt; \"\" Then\n    With Worksheets(2).Range(\"B:B\") 'Search all of Employee Name list entries\n        Set SearchEmpList = .Find(What:=EmpName, _\n                                  After:=.Cells(.Cells.Count), _\n                                  LookIn:=xlValues, _\n                                  LookAt:=xlWhole, _\n                                  SearchOrder:=xlByRows, _\n                                  SearchDirection:=xlNext, _\n                                  MatchCase:=False)\n    End With\n</code></pre>\n\n<p>So that is the first column and the first variable that has to be identified. To move on to the relevant start date, I added this code:</p>\n\n<pre><code>    With Worksheets(2).Range(\"C:C\") 'Search all of Start Date list entries\n        Set SearchSDate = .Find(What:=ActiveCell.Value, _\n                                After:=.Cells(.Cells.Count), _\n                                LookIn:=xlValues, _\n                                LookAt:=xlWhole, _\n                                SeachOrder:=xlByRows, _\n                                SeachDirection:=xlNext, _\n                                MatchCase:=False)\n    End With\n</code></pre>\n\n<p>To my eye, this is exactly the same, but I'm getting the \"Run-time error '448': Named argument not found\" when using step-into to debug.</p>\n\n<p>Is it the ActiveCell.Value? If so, what else can I use? This script is going to be used in a loop script, which offsets by 1 each iteration -- so ActiveCell seems the most plausible if it works at all.</p>\n\n<p>Loop script looks like this:</p>\n\n<pre><code>Sub ColorLoop()\n\nDim EndNumberA As Integer '31 day months\nDim EndNumberB As Integer '30 day months\nDim EndnumberC As Integer '28 day months\nDim EndNumberD As Integer '29 day months\nDim i As Integer\n\nEndNumberA = 31\nEndNumberB = 30\nEndnumberC = 28\nEndNumberD = 29\n\n'Offset commands need to be tweaked each year to ensure the ActiveCell lands on the first day of the next month\n\n'January 31d\nFor i = 1 To EndNumberA\n    Call CalendarColor\n    ActiveCell.Offset(, 1).Select\nNext i\n\n'Set ActiveCell to Feb1\nActiveCell.Offset(1, -28).Select\n\n'February 28d (Use EndNumberD if leap year)\nFor i = 1 To EndnumberC\n    'Call CalendarColor\n    ActiveCell.Offset(, 1).Select\nNext i\n\n'Set ActiveCell to Mar1\nActiveCell.Offset(1, -28).Select\n</code></pre>\n\n<p>I am about 2 weeks into learning VBA (and my first post here), so whatever you have is welcome information.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1489602027, "post_id": 42817617, "comment_id": 72747275, "body": "It is all the Selects and Activates that are put there by the macro recorder.  You need to change how vba is refering to the cells by referring directly to the cells and not use Select or Activate.  See here: <a href=\"http://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba-macros\" title=\"how to avoid using select in excel vba macros\">stackoverflow.com/questions/10714251/&hellip;</a>"}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1489602963, "post_id": 42817617, "comment_id": 72747836, "body": "Thanks Scott - I&#39;ll take a look there"}], "answers": [{"comments": [{"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1489605869, "post_id": 42817785, "comment_id": 72749575, "body": "Whoa! Adding those 2 first bits of code is what I was missing! I also cleaned up a lot of the &quot;select&quot; lines, and now it&#39;s running in &lt;2 seconds! Perfect, thank you!"}, {"owner": {"reputation": 975, "user_id": 890266, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/iGHDm.gif?s=128&g=1", "display_name": "Bill Roberts", "link": "https://stackoverflow.com/users/890266/bill-roberts"}, "reply_to_user": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 1, "creation_date": 1489606291, "post_id": 42817785, "comment_id": 72749821, "body": "Plz tell Joyce I said hello :)"}, {"owner": {"reputation": 3228, "user_id": 848419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0cf2a4a3abac652c91148d8e12e5268a?s=128&d=identicon&r=PG", "display_name": "VoteCoffee", "link": "https://stackoverflow.com/users/848419/votecoffee"}, "edited": false, "score": 0, "creation_date": 1557774662, "post_id": 42817785, "comment_id": 98870200, "body": "I also like .DisplayAlerts = False"}], "tags": [], "owner": {"reputation": 975, "user_id": 890266, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/iGHDm.gif?s=128&g=1", "display_name": "Bill Roberts", "link": "https://stackoverflow.com/users/890266/bill-roberts"}, "is_accepted": true, "score": 1, "last_activity_date": 1489602654, "last_edit_date": 1489602654, "creation_date": 1489602218, "answer_id": 42817785, "question_id": 42817617, "link": "https://stackoverflow.com/questions/42817617/excel-vba-code-running-extremely-slow-even-with-events-turned-off/42817785#42817785", "title": "Excel VBA code running extremely slow even with events turned off", "body": "<p>Well, you turned off events... This block for me is fairly standard before macro code does anything:</p>\n\n<pre><code>Dim PrevCalc As XlCalculation\nWith Application\n    PrevCalc = .Calculation\n    .Calculation = xlCalculationManual\n    .Cursor = xlWait\n    .Calculate\n    .EnableEvents = False\n    .ScreenUpdating = False\nEnd With\n</code></pre>\n\n<p>Then I \"undo\" when the macro is finished, or in case of error:</p>\n\n<pre><code>With Application\n    .Cursor = xlDefault\n    .Calculate\n    .Calculation = PrevCalc\n    '.ScreenUpdating = True 'Not Needed...\n    .EnableEvents = True\nEnd With\n</code></pre>\n\n<p>By the way, every operation you call that modifies cells, is technically a COM call - so you'll want to minimize them. The macro record isn't smart enough to know when modifying a cell that you are only doing one thing.</p>\n\n<p>So for example here where you really only want to center the text:</p>\n\n<pre><code>Range(\"A1\").Select\nWith Selection\n    .HorizontalAlignment = xlCenter\n    .VerticalAlignment = xlTop\n    .WrapText = True\n    .Orientation = 0\n    .AddIndent = False\n    .IndentLevel = 0\n    .ShrinkToFit = False\n    .ReadingOrder = xlContext\n    .MergeCells = False\nEnd With\n</code></pre>\n\n<p>Change it to:</p>\n\n<pre><code>Range(\"A1\").HorizontalAlignment = xlCenter\n</code></pre>\n"}], "owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 556, "favorite_count": 0, "accepted_answer_id": 42817785, "answer_count": 1, "score": 1, "last_activity_date": 1489602654, "creation_date": 1489601689, "question_id": 42817617, "link": "https://stackoverflow.com/questions/42817617/excel-vba-code-running-extremely-slow-even-with-events-turned-off", "title": "Excel VBA code running extremely slow even with events turned off", "body": "<p>The following is a macro that some of my coworkers had already been using to clean up an excel document. It was a complete mess! Believe it or not, this si the cleaned up version (I removed a ton of activewindow scrolling, adjusting column and row widths over and over again). Even after all my cleaning up (and turning off events), this code still runs slow (10-15 seconds) and scrolls all over the page. Any ideas as to how I revamp this to run it a little faster?   </p>\n\n<pre><code>Sub MyMacro()\nApplication.DisplayAlerts = False\n    Sheets(\"P H T Funnel Summary_1\").Select\n    ActiveWindow.SelectedSheets.Delete\n    Rows(\"1:21\").Select\n         Selection.ClearContents\n         Selection.Delete Shift:=xlUp\n'Joyce's Macro\n    Rows(\"1:1\").RowHeight = 51\n    Rows(\"1:1\").RowHeight = 44.25\n    Range(\"A1\").Select\n    With Selection\n        .HorizontalAlignment = xlCenter\n        .VerticalAlignment = xlTop\n        .WrapText = True\n        .Orientation = 0\n        .AddIndent = False\n        .IndentLevel = 0\n        .ShrinkToFit = False\n        .ReadingOrder = xlContext\n        .MergeCells = False\n    End With\n    Columns(\"F:F\").Select\n    Selection.Cut\n    Columns(\"B:B\").Select\n    ActiveSheet.Paste\n    Selection.ColumnWidth = 14.29\n   Columns(\"B:B\").Select\n    With Selection\n        .HorizontalAlignment = xlGeneral\n        .WrapText = False\n        .Orientation = 0\n        .AddIndent = False\n        .IndentLevel = 0\n        .ShrinkToFit = False\n        .ReadingOrder = xlContext\n        .MergeCells = False\n    End With\n    With Selection\n        .HorizontalAlignment = xlCenter\n        .WrapText = False\n        .Orientation = 0\n        .AddIndent = False\n        .IndentLevel = 0\n        .ShrinkToFit = False\n        .ReadingOrder = xlContext\n        .MergeCells = False\n    End With\n    Columns(\"G:G\").Select\n    Selection.Cut\n    Columns(\"C:C\").Select\n    ActiveSheet.Paste\n    Range(\"D1\").Select\n    ActiveCell.FormulaR1C1 = \"Quote Account Name\"\n    Range(\"D1\").Select\n    With Selection\n        .HorizontalAlignment = xlGeneral\n        .VerticalAlignment = xlTop\n        .WrapText = False\n        .Orientation = 0\n        .AddIndent = False\n        .IndentLevel = 0\n        .ShrinkToFit = False\n        .ReadingOrder = xlContext\n        .MergeCells = False\n    End With\n    Selection.Font.Bold = True\n    Range(\"D1:D534\").Select\n    Selection.Borders(xlDiagonalDown).LineStyle = xlNone\n    Selection.Borders(xlDiagonalUp).LineStyle = xlNone\n    With Selection.Borders(xlEdgeLeft)\n        .LineStyle = xlContinuous\n        .ColorIndex = 0\n        .TintAndShade = 0\n        .Weight = xlThin\n    End With\n    With Selection.Borders(xlEdgeTop)\n        .LineStyle = xlContinuous\n        .ColorIndex = 0\n        .TintAndShade = 0\n        .Weight = xlThin\n    End With\n    With Selection.Borders(xlEdgeBottom)\n        .LineStyle = xlContinuous\n        .ColorIndex = 0\n        .TintAndShade = 0\n        .Weight = xlThin\n    End With\n    With Selection.Borders(xlEdgeRight)\n        .LineStyle = xlContinuous\n        .ColorIndex = 0\n        .TintAndShade = 0\n        .Weight = xlThin\n    End With\n    With Selection.Borders(xlInsideVertical)\n        .LineStyle = xlContinuous\n        .ColorIndex = 0\n        .TintAndShade = 0\n        .Weight = xlThin\n    End With\n    With Selection.Borders(xlInsideHorizontal)\n        .LineStyle = xlContinuous\n        .ColorIndex = 0\n        .TintAndShade = 0\n        .Weight = xlThin\n    End With\n    Columns(\"AB:AB\").Select\n    Selection.Cut\n    Columns(\"E:E\").Select\n    ActiveSheet.Paste\n    Columns(\"K:K\").Select\n    Selection.Cut\n    Columns(\"G:G\").Select\n    ActiveSheet.Paste\n    Columns(\"G:G\").Select\n    With Selection\n        .HorizontalAlignment = xlGeneral\n        .WrapText = False\n        .Orientation = 0\n        .AddIndent = False\n        .IndentLevel = 0\n        .ShrinkToFit = False\n        .ReadingOrder = xlContext\n        .MergeCells = False\n    End With\n    With Selection\n        .HorizontalAlignment = xlCenter\n        .WrapText = False\n        .Orientation = 0\n        .AddIndent = False\n        .IndentLevel = 0\n        .ShrinkToFit = False\n        .ReadingOrder = xlContext\n        .MergeCells = False\n    End With\n    Range(\"H1\").Select\n    Columns(\"L:L\").Select\n    Selection.Cut\n    Columns(\"H:H\").Select\n    ActiveSheet.Paste\n    Columns(\"H:H\").EntireColumn.AutoFit\n    Columns(\"I:I\").Select\n    Selection.Cut\n    Columns(\"I:I\").Select\n    Application.CutCopyMode = False\n    Selection.Delete Shift:=xlToLeft\n    Selection.ColumnWidth = 12.29\n    With Selection\n        .WrapText = True\n        .Orientation = 0\n        .AddIndent = False\n        .IndentLevel = 0\n        .ShrinkToFit = False\n        .ReadingOrder = xlContext\n        .MergeCells = False\n    End With\n    Columns(\"AN:AN\").Select\n    Selection.Cut\n    Columns(\"J:J\").Select\n    ActiveSheet.Paste\n    Selection.ColumnWidth = 16\n    With Selection\n        .WrapText = True\n        .Orientation = 0\n        .AddIndent = False\n        .IndentLevel = 0\n        .ShrinkToFit = False\n        .ReadingOrder = xlContext\n        .MergeCells = False\n    End With\n    Columns(\"AI:AI\").Select\n    Selection.Cut\n    Columns(\"K:K\").Select\n    ActiveSheet.Paste\n    Range(\"K1\").Select\n    With Selection\n        .HorizontalAlignment = xlCenter\n        .VerticalAlignment = xlTop\n        .WrapText = True\n        .Orientation = 0\n        .AddIndent = False\n        .IndentLevel = 0\n        .ShrinkToFit = False\n        .ReadingOrder = xlContext\n        .MergeCells = False\n    End With\n    Range(\"L1\").Select\n    ActiveCell.FormulaR1C1 = \" \"\n    Columns(\"AJ:AJ\").Select\n    Selection.Cut\n    Columns(\"L:L\").Select\n    ActiveSheet.Paste\n    Columns(\"M:M\").Select\n    Selection.Cut\n    Application.CutCopyMode = False\n    Selection.Delete Shift:=xlToLeft\n    Range(\"N1\").Select\n    Selection.ClearContents\n    Columns(\"X:X\").Select\n    Selection.Cut\n    Range(\"N1\").Select\n    ActiveSheet.Paste\n    Range(\"O1\").Select\n    Columns(\"N:N\").EntireColumn.AutoFit\n    With Selection\n        .HorizontalAlignment = xlCenter\n        .VerticalAlignment = xlTop\n        .WrapText = True\n        .Orientation = 0\n        .AddIndent = False\n        .IndentLevel = 0\n        .ShrinkToFit = False\n        .ReadingOrder = xlContext\n        .MergeCells = False\n    End With\n    Range(\"N1\").Select\n    With Selection\n        .HorizontalAlignment = xlCenter\n        .VerticalAlignment = xlTop\n        .WrapText = True\n        .Orientation = 0\n        .AddIndent = False\n        .IndentLevel = 0\n        .ShrinkToFit = False\n        .ReadingOrder = xlContext\n        .MergeCells = False\n    End With\n    Range(\"O1\").Select\n    ActiveCell.FormulaR1C1 = \" \"\n    Columns(\"U:U\").Select\n    Selection.Cut\n    Columns(\"O:O\").Select\n    ActiveSheet.Paste\n    Columns(\"Y:Y\").Select\n    Selection.Cut\n    Columns(\"O:O\").Select\n    Selection.Insert Shift:=xlToRight\n    Range(\"O1\").Select\n    With Selection\n        .HorizontalAlignment = xlCenter\n        .VerticalAlignment = xlTop\n        .WrapText = True\n        .Orientation = 0\n        .AddIndent = False\n        .IndentLevel = 0\n        .ShrinkToFit = False\n        .ReadingOrder = xlContext\n        .MergeCells = False\n    End With\n    Range(\"P1\").Select\n    Columns(\"X:X\").Select\n    Selection.Cut\n    Columns(\"Q:Q\").Select\n    Selection.Insert Shift:=xlToRight\n    Range(\"Q1\").Select\n    With Selection\n        .HorizontalAlignment = xlCenter\n        .VerticalAlignment = xlTop\n        .WrapText = True\n        .Orientation = 0\n        .AddIndent = False\n        .IndentLevel = 0\n        .ShrinkToFit = False\n        .ReadingOrder = xlContext\n        .MergeCells = False\n    End With\n    Columns(\"T:T\").Select\n    Selection.Cut\n    Columns(\"R:R\").Select\n    Columns(\"T:T\").Select\n    Application.CutCopyMode = False\n    Selection.Cut\n    Columns(\"R:R\").Select\n    Selection.Insert Shift:=xlToRight\n    Columns(\"R:R\").Select\n    With Selection\n        .HorizontalAlignment = xlGeneral\n        .WrapText = False\n        .Orientation = 0\n       .AddIndent = False\n        .IndentLevel = 0\n        .ShrinkToFit = False\n        .ReadingOrder = xlContext\n        .MergeCells = False\n    End With\n    With Selection\n        .HorizontalAlignment = xlCenter\n        .WrapText = False\n        .Orientation = 0\n        .AddIndent = False\n        .IndentLevel = 0\n        .ShrinkToFit = False\n        .ReadingOrder = xlContext\n        .MergeCells = False\n    End With\n    Columns(\"AN:AN\").Select\n    Selection.Cut\n    Columns(\"T:T\").Select\n    ActiveSheet.Paste\n    Columns(\"U:U\").Select\n    Selection.Insert Shift:=xlToRight, CopyOrigin:=xlFormatFromLeftOrAbove\n    Range(\"A1\").Select\n    With Selection.Font\n        .Name = \"Arial\"\n        .Size = 7\n        .Strikethrough = False\n        .Superscript = False\n        .Subscript = False\n        .OutlineFont = False\n        .Shadow = False\n        .Underline = xlUnderlineStyleNone\n        .ThemeColor = xlThemeColorLight1\n        .TintAndShade = 0\n        .ThemeFont = xlThemeFontNone\n    End With\n    Range(\"A1\").Select\n    With Selection.Font\n        .Name = \"Arial\"\n        .Size = 8\n        .Strikethrough = False\n        .Superscript = False\n        .Subscript = False\n        .OutlineFont = False\n        .Shadow = False\n        .Underline = xlUnderlineStyleNone\n        .ThemeColor = xlThemeColorLight1\n        .TintAndShade = 0\n        .ThemeFont = xlThemeFontNone\n    End With\n    Range(\"A1\").Select\n    With Selection.Font\n        .Name = \"Arial\"\n        .Size = 7.5\n        .Strikethrough = False\n        .Superscript = False\n        .Subscript = False\n        .OutlineFont = False\n        .Shadow = False\n        .Underline = xlUnderlineStyleNone\n        .ThemeColor = xlThemeColorLight1\n        .TintAndShade = 0\n        .ThemeFont = xlThemeFontNone\n    End With\n    Range(\"A1\").Select\n    With Selection.Font\n        .Name = \"Arial\"\n        .Size = 7\n        .Strikethrough = False\n        .Superscript = False\n        .Subscript = False\n        .OutlineFont = False\n        .Shadow = False\n        .Underline = xlUnderlineStyleNone\n        .ThemeColor = xlThemeColorLight1\n        .TintAndShade = 0\n        .ThemeFont = xlThemeFontNone\n    End With\n    Range(\"A1\").Select\n    Range(\"D1\").Select\n    With Selection.Font\n        .Name = \"Tahoma\"\n        .Size = 8\n        .Strikethrough = False\n        .Superscript = False\n        .Subscript = False\n        .OutlineFont = False\n        .Shadow = False\n        .Underline = xlUnderlineStyleNone\n        .ThemeColor = xlThemeColorLight1\n        .TintAndShade = 0\n        .ThemeFont = xlThemeFontNone\n    End With\n    Range(\"D1\").Select\n    With Selection.Font\n        .Name = \"Arial\"\n        .Size = 8\n        .Strikethrough = False\n        .Superscript = False\n        .Subscript = False\n        .OutlineFont = False\n        .Shadow = False\n        .Underline = xlUnderlineStyleNone\n        .ThemeColor = xlThemeColorLight1\n        .TintAndShade = 0\n        .ThemeFont = xlThemeFontNone\n    End With\n    Columns(\"C:C\").ColumnWidth = 47.14\n    Columns(\"F:F\").ColumnWidth = 13.43\n    Columns(\"H:H\").ColumnWidth = 18.57\n    Columns(\"I:I\").EntireColumn.AutoFit\n    Columns(\"J:J\").ColumnWidth = 14.14\n    Columns(\"K:K\").ColumnWidth = 12.14\n    Columns(\"K:K\").ColumnWidth = 11\n    Columns(\"M:M\").ColumnWidth = 20.43\n    Columns(\"N:N\").ColumnWidth = 12.29\n    Columns(\"N:N\").ColumnWidth = 12.71\n    Columns(\"O:O\").ColumnWidth = 12.43\n    Columns(\"R:R\").ColumnWidth = 13.57\n    Columns(\"S:S\").ColumnWidth = 24.57\n    Columns(\"T:T\").ColumnWidth = 28.57\n    Columns(\"A:A\").ColumnWidth = 35\n    Columns(\"U:AU\").Select\n    Selection.Delete Shift:=xlToLeft\n'End of Joyce's Macro\nColumns(\"D:D\").Select\n    Selection.Delete Shift:=xlToLeft\n    Rows(\"1:19\").Select\n    Selection.FormatConditions.Add Type:=xlExpression, Formula1:= _\n        \"=SEARCH(\"\"CTC\"\",$S2)\"\n    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority\n    With Selection.FormatConditions(1).Interior\n        .PatternColorIndex = xlAutomatic\n        .Color = 255\n        .TintAndShade = 0\n    End With\n    Selection.FormatConditions(1).StopIfTrue = False\n    Selection.FormatConditions.Add Type:=xlExpression, Formula1:=\"=$I2&gt;=10000\"\n    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority\n    With Selection.FormatConditions(1).Interior\n        .PatternColorIndex = xlAutomatic\n        .Color = 65535\n        .TintAndShade = 0\n    End With\n    Selection.FormatConditions(1).StopIfTrue = False\n    Selection.FormatConditions.Add Type:=xlExpression, Formula1:=\"=$N2&gt;=30\"\n    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority\n    With Selection.FormatConditions(1).Interior\n        .PatternColorIndex = xlAutomatic\n        .ThemeColor = xlThemeColorAccent4\n        .TintAndShade = 0.399945066682943\n    End With\n    Selection.FormatConditions(1).StopIfTrue = False\n    Selection.FormatConditions.Add Type:=xlCellValue, Operator:=xlEqual, _\n        Formula1:=\"=0\"\n    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority\n    With Selection.FormatConditions(1).Interior\n        .PatternColorIndex = xlAutomatic\n        .Color = 15773696\n        .TintAndShade = 0\n    End With\n    Selection.FormatConditions(1).StopIfTrue = False\n    Selection.FormatConditions.Add Type:=xlExpression, Formula1:= _\n        \"=AND(D2&gt;=TODAY()-7,D2&lt;=TODAY())\"\n    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority\n    With Selection.FormatConditions(1).Interior\n        .PatternColorIndex = xlAutomatic\n        .Color = 5287936\n        .TintAndShade = 0\n    End With\n    Selection.FormatConditions(1).StopIfTrue = False\n    Selection.FormatConditions.Add Type:=xlCellValue, Operator:=xlGreaterEqual _\n        , Formula1:=\"=30\"\n    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority\n    With Selection.FormatConditions(1).Interior\n        .PatternColorIndex = xlAutomatic\n        .ThemeColor = xlThemeColorAccent6\n        .TintAndShade = -0.249946592608417\n    End With\n    Selection.FormatConditions(1).StopIfTrue = False\n    Range(\"A2\").Select\n    Cells.FormatConditions.Delete\n    Range(\"A2:A5000\").Select\n    Selection.FormatConditions.Add Type:=xlExpression, Formula1:= _\n        \"=SEARCH(\"\"CTC\"\",$S2)\"\n    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority\n    With Selection.FormatConditions(1).Interior\n        .PatternColorIndex = xlAutomatic\n        .Color = 255\n        .TintAndShade = 0\n    End With\n    Selection.FormatConditions(1).StopIfTrue = False\n    Range(\"B2:B5000\").Select\n    Selection.FormatConditions.Add Type:=xlExpression, Formula1:=\"=$I2&gt;=10000\"\n    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority\n    With Selection.FormatConditions(1).Interior\n        .PatternColorIndex = xlAutomatic\n        .Color = 65535\n        .TintAndShade = 0\n    End With\n    Selection.FormatConditions(1).StopIfTrue = False\n    Range(\"C2:C5000\").Select\n    Selection.FormatConditions.Add Type:=xlExpression, Formula1:=\"=$N2&gt;=30\"\n    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority\n    With Selection.FormatConditions(1).Interior\n        .PatternColorIndex = xlAutomatic\n        .ThemeColor = xlThemeColorAccent4\n        .TintAndShade = 0.399945066682943\n    End With\n    Selection.FormatConditions(1).StopIfTrue = False\n    Range(\"I2:I5000\").Select\n    Selection.FormatConditions.Add Type:=xlCellValue, Operator:=xlEqual, _\n        Formula1:=\"=0\"\n    Selection.FormatConditions.Add Type:=xlExpression, Formula1:=\"=AND(COUNTBLANK($I2)=0,$I2=0)\"\n    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority\n    With Selection.FormatConditions(1).Interior\n        .PatternColorIndex = xlAutomatic\n        .Color = 15773696\n        .TintAndShade = 0\n    End With\n    Selection.FormatConditions(1).StopIfTrue = False\n    Range(\"D2:D5000\").Select\n    Selection.FormatConditions.Add Type:=xlExpression, Formula1:= _\n        \"=AND(D2&lt;=TODAY()+7,D2&gt;=TODAY())\"\n    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority\n    With Selection.FormatConditions(1).Interior\n        .PatternColorIndex = xlAutomatic\n        .Color = 5287936\n        .TintAndShade = 0\n    End With\n    Selection.FormatConditions(1).StopIfTrue = False\n    Range(\"M2:M5000\").Select\n    Selection.FormatConditions.Add Type:=xlExpression, Formula1:= _\n        \"=M2&lt;=TODAY()-30\"\n    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority\n    With Selection.FormatConditions(1).Interior\n        .PatternColorIndex = xlAutomatic\n        .ThemeColor = xlThemeColorAccent6\n        .TintAndShade = -0.249946592608417\n    End With\n    Selection.FormatConditions(1).StopIfTrue = False\nApplication.DisplayAlerts = True\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 1, "creation_date": 1489601925, "post_id": 42817520, "comment_id": 72747215, "body": "<code>Dim Msgbox As String</code> isn&#39;t a good idea since <code>Msgbox</code> is a built-in function."}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1489602242, "post_id": 42817520, "comment_id": 72747395, "body": "Also, if you are learning VBA, I recommend that you forget that <code>Integer</code> even exists as a possible type. It is a 16-bit integer and such things are no longer able to index all possible rows since they overflow at 32,768. With a 32 or even 64 bit word size, such 16 bit numbers are probably stored in a memory slot which is actually bigger than 16 bits, so there is no memory savings. Use <code>Long</code> instead. Similarly, use <code>Double</code> rather than <code>Single</code> for your floating point type."}, {"owner": {"reputation": 7, "user_id": 5964703, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b7580d6c9afc4af0102f7d206c5508d0?s=128&d=identicon&r=PG&f=1", "display_name": "Richard Garcia", "link": "https://stackoverflow.com/users/5964703/richard-garcia"}, "reply_to_user": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1489612206, "post_id": 42817520, "comment_id": 72753205, "body": "Thank you two John Coleman, Scott Craner, and Flazer.  I removed Dim and = to fix them and now they both works great :)...I guess dont need to define variables if built in functions and I made already some syntax for msg box.  but now it works after those corrections"}], "answers": [{"comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1489602459, "post_id": 42817622, "comment_id": 72747536, "body": "Note that you also have to remove <code>Dim Msgbox As String</code> or it&#39;s a compile error."}], "tags": [], "owner": {"reputation": 975, "user_id": 890266, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/iGHDm.gif?s=128&g=1", "display_name": "Bill Roberts", "link": "https://stackoverflow.com/users/890266/bill-roberts"}, "is_accepted": true, "score": 2, "last_activity_date": 1489603132, "last_edit_date": 1495541843, "creation_date": 1489601694, "answer_id": 42817622, "question_id": 42817520, "link": "https://stackoverflow.com/questions/42817520/if-and-then-basic/42817622#42817622", "title": "If and Then basic", "body": "<p>Welcome to VBA!</p>\n\n<pre><code>MsgBox \"This is my message\", , \"This is my Title\"\n</code></pre>\n\n<p>Between the commas, you insert button styles.\nButton styles and Title are optional.</p>\n\n<p>So for your example, remove the \"=\"'s and instead do:</p>\n\n<pre><code>If Score = 1 Then\n    Msgbox \"Yes\"\nElse\n    Msgbox \"no\"\nEnd If\n</code></pre>\n\n<p>Check out the MS link: <a href=\"https://msdn.microsoft.com/en-us/library/aa445082(v=vs.60).aspx\" rel=\"nofollow noreferrer\">MsgBox Function</a></p>\n\n<p><strong>* **EDIT per <a href=\"https://stackoverflow.com/users/4088852/comintern\">comintern</a>'s comment - remove this line</strong> !!!!!!</p>\n\n<pre><code>Dim Msgbox As String\n</code></pre>\n"}], "owner": {"reputation": 7, "user_id": 5964703, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b7580d6c9afc4af0102f7d206c5508d0?s=128&d=identicon&r=PG&f=1", "display_name": "Richard Garcia", "link": "https://stackoverflow.com/users/5964703/richard-garcia"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60, "favorite_count": 0, "accepted_answer_id": 42817622, "answer_count": 1, "score": 0, "last_activity_date": 1489603132, "creation_date": 1489601367, "last_edit_date": 1531164843, "question_id": 42817520, "link": "https://stackoverflow.com/questions/42817520/if-and-then-basic", "title": "If and Then basic", "body": "<p>I am new to VBA and I want to test a basic If and Then Statement.  I want to create a message to say Yes or No based on the data in cell A1 in excel named score. I had tried many things and sometimes just all the messages pop up so wondering how to write this properly?  </p>\n\n<p>Here is the actual statement:</p>\n\n<pre><code>Sub IfTest()    \nDim Score As Integer    \nDim Msgbox As String\n\nScore = Cells(1, 1).Value\n\nIf Score = 1 Then    \n    Msgbox = \"Yes\"\nElse    \n    Msgbox = \"no\"\nEnd If    \n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 2, "creation_date": 1489601388, "post_id": 42817470, "comment_id": 72746892, "body": "You need to use the <code>Set</code> keyword when assigning objects to variables: <code>Set rectangle = sheet1.shapes(&quot;rectangle 1&quot;)</code>"}, {"owner": {"reputation": 11, "user_id": 7716826, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca0926a5d244742e6118c0fac44339e1?s=128&d=identicon&r=PG&f=1", "display_name": "Nicki", "link": "https://stackoverflow.com/users/7716826/nicki"}, "reply_to_user": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1489602013, "post_id": 42817470, "comment_id": 72747264, "body": "In 2015 you don&#39;t need the word &quot;set&quot; in order to assign objects. &quot;Let&quot; and &quot;set&quot; are no longer supported. Works just fine removing the word &quot;set&quot; all together.  However that still uses the &quot;shape&quot; type, which is what I am having the issue with"}, {"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1489603555, "post_id": 42817470, "comment_id": 72748190, "body": "You absolutely do still need the <code>Set</code> keyword when assigning an object to an object variable.  Here is official documentation from the MSDN website for Office 2013 and later: <a href=\"https://msdn.microsoft.com/en-us/library/office/gg251642.aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/office/gg251642.aspx</a> I couldn&#39;t find anything to support your claim that Let and Set are no longer supported.  Maybe that&#39;s true in Visual Basic, or .NET, or when creating custom classes?"}, {"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1489603685, "post_id": 42817470, "comment_id": 72748249, "body": "Also note that you only need the <code>Set</code> keyword for object variables, it is not necessary (and will in fact cause an error) for non-object variables (such as strings, longs, etc)"}, {"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1489603737, "post_id": 42817470, "comment_id": 72748273, "body": "All that being said, the <code>With</code> statement shown by @GordonBell should work just fine as an alternate solution."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1489604229, "post_id": 42817470, "comment_id": 72748601, "body": "Are you programming this in VB.NET or VBA? They are 2 completely different languages, and AFAIK there isn&#39;t a &quot;VBA 2015&quot;.  You might end some of the confusion here by tagging the question with <i>the language you are programming in.</i>"}, {"owner": {"reputation": 11, "user_id": 7716826, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca0926a5d244742e6118c0fac44339e1?s=128&d=identicon&r=PG&f=1", "display_name": "Nicki", "link": "https://stackoverflow.com/users/7716826/nicki"}, "edited": false, "score": 0, "creation_date": 1489604364, "post_id": 42817470, "comment_id": 72748704, "body": "Huh, whenever I use set I get an error with the description &quot; &#39;Let&#39; and &#39;Set&#39; assignment statements are no longer supported&quot; and the code leads me to think link <a href=\"https://msdn.microsoft.com/en-us/library/9tzcse0s(v=vs.90).aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/9tzcse0s(v=vs.90).aspx</a>"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1489606376, "post_id": 42817470, "comment_id": 72749870, "body": "That link it to VB.NET documentation, not VBA documentation.  If you opened Visual Basic from Excel, you&#39;re programming in VBA.  If you opened Visual Studio and referenced the Office Interop, you&#39;re programming in VB.NET."}, {"owner": {"reputation": 12253, "user_id": 16473, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d2588c9db71e7201288ff9f74ba219ca?s=128&d=identicon&r=PG", "display_name": "Gordon Bell", "link": "https://stackoverflow.com/users/16473/gordon-bell"}, "edited": false, "score": 0, "creation_date": 1489606426, "post_id": 42817470, "comment_id": 72749903, "body": "Set is still required in VBA."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 7716826, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca0926a5d244742e6118c0fac44339e1?s=128&d=identicon&r=PG&f=1", "display_name": "Nicki", "link": "https://stackoverflow.com/users/7716826/nicki"}, "edited": false, "score": 0, "creation_date": 1489603802, "post_id": 42818103, "comment_id": 72748318, "body": "Thank you!  I tried that and I am no longer getting the same error but I&#39;m getting the item not found error. The argument you pass through shapes is the cell name, right?"}, {"owner": {"reputation": 12253, "user_id": 16473, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d2588c9db71e7201288ff9f74ba219ca?s=128&d=identicon&r=PG", "display_name": "Gordon Bell", "link": "https://stackoverflow.com/users/16473/gordon-bell"}, "reply_to_user": {"reputation": 11, "user_id": 7716826, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca0926a5d244742e6118c0fac44339e1?s=128&d=identicon&r=PG&f=1", "display_name": "Nicki", "link": "https://stackoverflow.com/users/7716826/nicki"}, "edited": false, "score": 0, "creation_date": 1489606049, "post_id": 42818103, "comment_id": 72749671, "body": "No, not the cell name, the shape name.  When you click on the Shape, it&#39;s name should appear in the little dropdown box on the Format tab."}], "tags": [], "owner": {"reputation": 12253, "user_id": 16473, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d2588c9db71e7201288ff9f74ba219ca?s=128&d=identicon&r=PG", "display_name": "Gordon Bell", "link": "https://stackoverflow.com/users/16473/gordon-bell"}, "is_accepted": false, "score": 0, "last_activity_date": 1489603103, "creation_date": 1489603103, "answer_id": 42818103, "question_id": 42817470, "link": "https://stackoverflow.com/questions/42817470/vba-2015-shape-type-undefined/42818103#42818103", "title": "VBA 2015 &quot;shape&quot; Type undefined", "body": "<p>Does this work?</p>\n\n<pre><code>With sheet1.shapes(\"rectangle 1\")\n    .Fill.Forecolor.RGB = RGB(255, 255, 255)\nEnd With\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 12253, "user_id": 16473, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d2588c9db71e7201288ff9f74ba219ca?s=128&d=identicon&r=PG", "display_name": "Gordon Bell", "link": "https://stackoverflow.com/users/16473/gordon-bell"}, "is_accepted": false, "score": 0, "last_activity_date": 1489606337, "creation_date": 1489606337, "answer_id": 42819081, "question_id": 42817470, "link": "https://stackoverflow.com/questions/42817470/vba-2015-shape-type-undefined/42819081#42819081", "title": "VBA 2015 &quot;shape&quot; Type undefined", "body": "<p>Run this to list shapes on Sheet1.  Are you sure you have a \"Rectangle 1\"?</p>\n\n<pre><code>Sub ListShapes()\n    For Each s In Sheets(\"Sheet1\").Shapes\n        MsgBox s.Name\n    Next\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 7716826, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca0926a5d244742e6118c0fac44339e1?s=128&d=identicon&r=PG&f=1", "display_name": "Nicki", "link": "https://stackoverflow.com/users/7716826/nicki"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 193, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1489606337, "creation_date": 1489601246, "last_edit_date": 1489601637, "question_id": 42817470, "link": "https://stackoverflow.com/questions/42817470/vba-2015-shape-type-undefined", "title": "VBA 2015 &quot;shape&quot; Type undefined", "body": "<p>I'm still somewhat new to VBA and I am having trouble defining an object as a shape. I have an excel worksheet with a rectangle and I would like to change the color of this shape from a comboBox in my VBA User Form. I have tried the code bellow and several other methods however I keep running into the error that \"shape\" is not a type, and this prevents me from using members such as fill. It might help to know I am using VBA 2015 as I know there are some differences between years</p>\n\n<pre><code>Dim rectangle as Shape\nrectangle = sheet1.shapes(\"rectangle 1\")\nrectangle.Fill.Forecolor.RGB = RGB(255, 255, 255)\n</code></pre>\n"}, {"tags": ["sql", "vba", "excel"], "comments": [{"owner": {"reputation": 21, "user_id": 5183660, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155923059275241/picture?type=large", "display_name": "Caj Michael Andersson", "link": "https://stackoverflow.com/users/5183660/caj-michael-andersson"}, "edited": false, "score": 0, "creation_date": 1499538027, "post_id": 42817430, "comment_id": 76953514, "body": "I made a workaround by using match index to another table."}], "owner": {"reputation": 21, "user_id": 5183660, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155923059275241/picture?type=large", "display_name": "Caj Michael Andersson", "link": "https://stackoverflow.com/users/5183660/caj-michael-andersson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 61, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1489607928, "creation_date": 1489601099, "last_edit_date": 1489607928, "question_id": 42817430, "link": "https://stackoverflow.com/questions/42817430/vba-sql-return-to-matching-row", "title": "VBA-SQL return to matching row", "body": "<p>I use the following code to match a range of article numbers and return each corresponding article numbers price.</p>\n\n<p>While the returning prices are correct it does not print the price on the correct row. Each price gets printed two  cells below where it should be printed.</p>\n\n<p>RowNo = the article number I wanna match, and these resides in the E column.</p>\n\n<p>What am I missing? :) </p>\n\n<pre><code> SQLStr = \"SELECT convert(money, poCOST) FROM [dbo].[Database]\" &amp; _\n\"WHERE [RowNo] IN( '\" &amp; Join(Application.Transpose(ActiveSheet.Range(\"E40:E500\").Value), \"','\") &amp; \"')\"\n\nSet cn = New ADODB.Connection\n\nWith cn\n    .CursorLocation = adUseClient\n    .Open \"Driver={SQL Server};Server=\" &amp; Server_Name &amp; \";Database=\" &amp; Database_Name &amp; _\n\";Uid=\" &amp; User_ID &amp; \";Pwd=\" &amp; Password &amp; \";\"\n\nSet rs = .Execute(SQLStr)\nEnd With\n\np = 40\n\nWhile Not rs.EOF\n    For v = 1 To rs.Fields.Count\n        ActiveSheet.Cells(p, v + 10).Value = rs.Fields(v - 1).Value\n    Next v\n    p = p + 1\n    rs.MoveNext\nWend\n\nrs.Close\nSet rs = Nothing\n\ncn.Close\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1489599207, "post_id": 42816638, "comment_id": 72745621, "body": "So if you select range A1:A7 you want it called <code>A1SUMA2SUMA3SUMA4SUMA5SUMA6SUMA7SUM</code>?"}, {"owner": {"reputation": 11, "user_id": 7716572, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0246189ec09fc1417b7bc349c9958e69?s=128&d=identicon&r=PG&f=1", "display_name": "Psam Elyon Alumni", "link": "https://stackoverflow.com/users/7716572/psam-elyon-alumni"}, "reply_to_user": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1489599607, "post_id": 42816638, "comment_id": 72745893, "body": "Yes that is exactly what I mean. Thanks"}, {"owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "edited": false, "score": 0, "creation_date": 1489600116, "post_id": 42816638, "comment_id": 72746185, "body": "<code>strName= strName &amp; Replace(mycell.Address,&quot;$&quot;,&quot;&quot;) &amp; &quot;SUM&quot;</code> and then <code>mycell.Name (strName)</code>"}, {"owner": {"reputation": 11, "user_id": 7716572, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0246189ec09fc1417b7bc349c9958e69?s=128&d=identicon&r=PG&f=1", "display_name": "Psam Elyon Alumni", "link": "https://stackoverflow.com/users/7716572/psam-elyon-alumni"}, "edited": false, "score": 0, "creation_date": 1489609730, "post_id": 42816638, "comment_id": 72751805, "body": "I got the error Run-time error &#39;438&#39;, Object doesn&#39;t support this property  or method"}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 7716572, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0246189ec09fc1417b7bc349c9958e69?s=128&d=identicon&r=PG&f=1", "display_name": "Psam Elyon Alumni", "link": "https://stackoverflow.com/users/7716572/psam-elyon-alumni"}, "edited": false, "score": 0, "creation_date": 1489609369, "post_id": 42817414, "comment_id": 72751585, "body": "Hello thanks for your input,I ran the code but it just returned A1SUM in the MSG box but it didn&#39;t actually alter the cell reference"}], "tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": false, "score": 0, "last_activity_date": 1489601048, "creation_date": 1489601048, "answer_id": 42817414, "question_id": 42816638, "link": "https://stackoverflow.com/questions/42816638/cell-reference-modification/42817414#42817414", "title": "Cell Reference Modification", "body": "<p>You can try the code below:</p>\n\n<pre><code>Sub UpdateCellReference()\n\n    Dim mycell As Range\n    Dim MyStr   As String\n\n    For Each mycell In Selection\n        MyStr = MyStr &amp; mycell.Address(False, False) &amp; \"SUM\"\n    Next mycell\n\n    MsgBox MyStr\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "is_accepted": false, "score": 0, "last_activity_date": 1489650257, "creation_date": 1489650257, "answer_id": 42828033, "question_id": 42816638, "link": "https://stackoverflow.com/questions/42816638/cell-reference-modification/42828033#42828033", "title": "Cell Reference Modification", "body": "<p>Using Shai Rado's code as a starting point.</p>\n\n<p>Change his <code>MsgBox MyStr</code> line to   </p>\n\n<pre><code>AllocateNamedRange ThisWorkbook, MyStr, \"='\" &amp; Selection.Parent.Name &amp; \"'!\" &amp; Selection.Address, \"A1\"\n</code></pre>\n\n<p>and add these two procedures to the module:  </p>\n\n<pre><code>Public Sub AllocateNamedRange(Book As Workbook, sName As String, sRefersTo As String, Optional ReferType = \"R1C1\")\n    With Book\n        If NamedRangeExists(Book, sName) Then .Names(sName).Delete\n            If ReferType = \"R1C1\" Then\n                .Names.Add Name:=sName, RefersToR1C1:=sRefersTo\n        ElseIf ReferType = \"A1\" Then\n                .Names.Add Name:=sName, RefersTo:=sRefersTo\n        End If\n    End With\nEnd Sub\n\nPublic Function NamedRangeExists(Book As Workbook, sName As String) As Boolean\n    On Error Resume Next\n        NamedRangeExists = Book.Names(sName).Index &lt;&gt; (Err.Number = 0)\n    On Error GoTo 0\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 7716572, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0246189ec09fc1417b7bc349c9958e69?s=128&d=identicon&r=PG&f=1", "display_name": "Psam Elyon Alumni", "link": "https://stackoverflow.com/users/7716572/psam-elyon-alumni"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 61, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1489650257, "creation_date": 1489598606, "last_edit_date": 1531164843, "question_id": 42816638, "link": "https://stackoverflow.com/questions/42816638/cell-reference-modification", "title": "Cell Reference Modification", "body": "<p>I have selected a range of cells and I would like to concatenate the cell references of the cells selected with the word SUM.</p>\n\n<p>e.g. If I select cell A1 I want my macro to return a reference \"A1SUM\" </p>\n\n<p><strong>My code</strong> </p>\n\n<pre><code>Sub UpdateCellReference()\n    For Each mycell In Selection\n        mycell.Name (mycell.Name &amp; \"SUM\")\n    Next mycell\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1489598539, "post_id": 42816214, "comment_id": 72745236, "body": "Are you wanting each item in the combobox to be ColumnC+ColumnD, or you want an array with Column C and Column D separately?"}, {"owner": {"reputation": 1472, "user_id": 1726522, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/0DUTN.gif?s=128&g=1", "display_name": "CMArg", "link": "https://stackoverflow.com/users/1726522/cmarg"}, "edited": false, "score": 0, "creation_date": 1489598817, "post_id": 42816214, "comment_id": 72745383, "body": "Your code is working fine for me. ComboBox contains values from column C as well as column D."}, {"owner": {"reputation": 1472, "user_id": 1726522, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/0DUTN.gif?s=128&g=1", "display_name": "CMArg", "link": "https://stackoverflow.com/users/1726522/cmarg"}, "edited": false, "score": 0, "creation_date": 1489599310, "post_id": 42816214, "comment_id": 72745681, "body": "<code>stack the values as one list</code>: yes, that&#39;s what your code is doing. Perhaps you need to better clarify what you want to achieve."}, {"owner": {"reputation": 361, "user_id": 2879124, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/fa097dbc1af5cbe10119a74dbce77b02?s=128&d=identicon&r=PG&f=1", "display_name": "Carlos80", "link": "https://stackoverflow.com/users/2879124/carlos80"}, "edited": false, "score": 0, "creation_date": 1489654075, "post_id": 42816214, "comment_id": 72768251, "body": "Apologies rather than having them in one column, I&#39;m trying to get them to come through as two columns next to each other in the drop down box. <code>ID Account</code> rather than one list returning ID, Account, ID, Account all together."}], "owner": {"reputation": 361, "user_id": 2879124, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/fa097dbc1af5cbe10119a74dbce77b02?s=128&d=identicon&r=PG&f=1", "display_name": "Carlos80", "link": "https://stackoverflow.com/users/2879124/carlos80"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 281, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1489597279, "creation_date": 1489597279, "last_edit_date": 1531164843, "question_id": 42816214, "link": "https://stackoverflow.com/questions/42816214/vba-populate-combobox-with-multiple-columns", "title": "VBA Populate ComboBox with multiple columns", "body": "<p>I'm sure this is straight forward but I have a combobox in userform which is giving me a dynamic list of values. It turns out that I now also need to bring in the column next to it. However with the code below it somehow seems to stack the values as one list:</p>\n\n<pre><code>i = 2\n\nFor Each c In Range(\"D2\", Range(\"D\" &amp; Rows.Count).End(xlUp))\n    CB_Account.AddItem Cells(i, 3).Value\n    CB_Account.AddItem Cells(i, 4).Value\n    i = i + 1\n\nNext\n</code></pre>\n\n<p>Any help would be much appreciated.</p>\n\n<p>Thanks</p>\n"}, {"tags": ["vba", "outlook"], "comments": [{"owner": {"reputation": 2514, "user_id": 6004650, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/668db278c31bc9040a9dea1b77b4ddd4?s=128&d=identicon&r=PG&f=1", "display_name": "MikeJRamsey56", "link": "https://stackoverflow.com/users/6004650/mikejramsey56"}, "edited": false, "score": 1, "creation_date": 1489597358, "post_id": 42816137, "comment_id": 72744515, "body": "Google this: how to save outlook messages automatically to a file as they arrive"}], "answers": [{"tags": [], "owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "is_accepted": false, "score": 0, "last_activity_date": 1490311295, "last_edit_date": 1490311295, "creation_date": 1489728308, "answer_id": 42849807, "question_id": 42816137, "link": "https://stackoverflow.com/questions/42816137/save-specific-incoming-messages-to-the-hard-drive/42849807#42849807", "title": "Save specific incoming messages to the hard drive", "body": "<p>The simplest way to save emails is using  <strong><em>Outlook Rule + simple vba Script</em></strong></p>\n\n<p>Example</p>\n\n<pre><code>Option Explicit\nPublic Sub Save_Example(Item As Outlook.MailItem)\n    Dim Path As String\n    Dim FileName As String\n\n    Path = \"C:\\Temp\\\"\n\n    If Item.Subject = \"Hello\" Then\n        FileName = \"Bla Bla\" &amp; \".msg\"\n        Item.SaveAs Path &amp; FileName, olMsg\n    End If\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 10757, "user_id": 1709270, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/mL7hP.jpg?s=128&g=1", "display_name": "Yves", "link": "https://stackoverflow.com/users/1709270/yves"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 154, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1593327553, "creation_date": 1489597047, "last_edit_date": 1593327553, "question_id": 42816137, "link": "https://stackoverflow.com/questions/42816137/save-specific-incoming-messages-to-the-hard-drive", "title": "Save specific incoming messages to the hard drive", "body": "<p>How to save specific incoming messages to the local hard drive programmatically\nor \nHow to save an outlook folder to a local hard drive programmatically</p>\n\n<p>either or works for me</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2235, "user_id": 7535125, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209489062678374/picture?type=large", "display_name": "Brandon Barney", "link": "https://stackoverflow.com/users/7535125/brandon-barney"}, "edited": false, "score": 0, "creation_date": 1489599774, "post_id": 42816057, "comment_id": 72745983, "body": "What specifically doesnt work with formatting your date for the filename. When I try it on my end it works just fine. Are you getting an error?"}, {"owner": {"reputation": 389, "user_id": 7324177, "user_type": "registered", "accept_rate": 82, "profile_image": "https://graph.facebook.com/10209248058172510/picture?type=large", "display_name": "Matt Taylor", "link": "https://stackoverflow.com/users/7324177/matt-taylor"}, "reply_to_user": {"reputation": 2235, "user_id": 7535125, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209489062678374/picture?type=large", "display_name": "Brandon Barney", "link": "https://stackoverflow.com/users/7535125/brandon-barney"}, "edited": false, "score": 0, "creation_date": 1489606184, "post_id": 42816057, "comment_id": 72749746, "body": "yes, I get a Compile error: Wrong number of arguments or invalid property assignment."}, {"owner": {"reputation": 2235, "user_id": 7535125, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209489062678374/picture?type=large", "display_name": "Brandon Barney", "link": "https://stackoverflow.com/users/7535125/brandon-barney"}, "edited": false, "score": 0, "creation_date": 1489665735, "post_id": 42816057, "comment_id": 72776308, "body": "Is the error on the format line, or on the saveas line? From looking at your code I cant see how the format would cause an issue. My bet would be that you are somehow creating an invalid filename on the saveas line. Try using &quot;Debug.Print&quot; or &quot;msgbox&quot; to display &#39;mypath &amp; myfilename&#39; and try manually creating a file with that name."}, {"owner": {"reputation": 389, "user_id": 7324177, "user_type": "registered", "accept_rate": 82, "profile_image": "https://graph.facebook.com/10209248058172510/picture?type=large", "display_name": "Matt Taylor", "link": "https://stackoverflow.com/users/7324177/matt-taylor"}, "reply_to_user": {"reputation": 2235, "user_id": 7535125, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209489062678374/picture?type=large", "display_name": "Brandon Barney", "link": "https://stackoverflow.com/users/7535125/brandon-barney"}, "edited": false, "score": 0, "creation_date": 1489676976, "post_id": 42816057, "comment_id": 72784786, "body": "@Brandon Fixed it by doing <code>MyFileName = Sheets(&quot;Order Summary (2)&quot;).Range(&quot;B2&quot;) &amp; VBA.Format(Now, &quot;_yyyymmdd&quot;)</code>"}], "answers": [{"tags": [], "owner": {"reputation": 2235, "user_id": 7535125, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209489062678374/picture?type=large", "display_name": "Brandon Barney", "link": "https://stackoverflow.com/users/7535125/brandon-barney"}, "is_accepted": true, "score": 1, "last_activity_date": 1489599630, "creation_date": 1489599630, "answer_id": 42816972, "question_id": 42816057, "link": "https://stackoverflow.com/questions/42816057/excel-export-sheet-without-shape-boxes-and-drop-down/42816972#42816972", "title": "Excel export sheet without shape boxes and drop down", "body": "<p>You can remove validation by doing:</p>\n\n<pre><code>Activesheet.Cells.Validation.Delete\n</code></pre>\n\n<p>(though qualifying the sheet name would be ideal). </p>\n\n<p>You can also loop through shapes within a worksheet by doing something like:</p>\n\n<pre><code>Dim shp as Shape\n\nFor each shp in ActiveSheet.Shapes\n    shp.delete\nNext\n</code></pre>\n\n<p>These two steps should remove all shapes, and should remove all data validation.</p>\n"}], "owner": {"reputation": 389, "user_id": 7324177, "user_type": "registered", "accept_rate": 82, "profile_image": "https://graph.facebook.com/10209248058172510/picture?type=large", "display_name": "Matt Taylor", "link": "https://stackoverflow.com/users/7324177/matt-taylor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 171, "favorite_count": 0, "accepted_answer_id": 42816972, "answer_count": 1, "score": 1, "last_activity_date": 1489599630, "creation_date": 1489596806, "question_id": 42816057, "link": "https://stackoverflow.com/questions/42816057/excel-export-sheet-without-shape-boxes-and-drop-down", "title": "Excel export sheet without shape boxes and drop down", "body": "<p>I have a macro to export the current page without any formulas or code. There are a few problems.</p>\n\n<pre><code>Sub ExportXLSX()\nApplication.EnableEvents = False\n\nDim MyPath As String\nDim MyFileName As String\n\nMyFileName = Sheets(\"Order Summary\").Range(\"B2\").Value &amp; \"_\" &amp; Format(Date, \"yyyymmdd\")\n\nIf Not Right(MyFileName, 4) = \".xlsx\" Then MyFileName = MyFileName &amp; \".xlsx\"\n\nSheets(\"Order Summary\").Copy\n\nWith Application.FileDialog(msoFileDialogFolderPicker)\n.Title = \"Select where you want to save\"\n.AllowMultiSelect = False\n.InitialFileName = \"\" 'Start folder path for the file picker.\nIf .Show &lt;&gt; -1 Then GoTo NextCode\nMyPath = .SelectedItems(1) &amp; \"\\\"\nEnd With\n\nNextCode:\n\nWith ActiveWorkbook\n    .ActiveSheet.UsedRange.Value = ActiveSheet.UsedRange.Value '&lt;~~ converts contents of XLSX file to values only\n    .SaveAs filename:=MyPath &amp; MyFileName, FileFormat:=xlOpenXMLWorkbook, CreateBackup:=False\n    .Close False\nEnd With\nApplication.EnableEvents = True\nEnd Sub\n</code></pre>\n\n<ol>\n<li>Format(Date, \"yyyymmdd\") doesn't seem to work for the filename.</li>\n<li>I would like to remove the drop down boxes I have in column A.</li>\n<li>I would like to remove the shape boxes I use for my macros.</li>\n</ol>\n\n<p>Basically want to strip the document to only dumb text so I can email it.</p>\n\n<p>Thanks</p>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 885, "user_id": 1758897, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hMoc1.png?s=128&g=1", "display_name": "basslo", "link": "https://stackoverflow.com/users/1758897/basslo"}, "edited": false, "score": 0, "creation_date": 1489598558, "post_id": 42816028, "comment_id": 72745247, "body": "So it is excel Files. You want to copy the whole file or just a range ?"}, {"owner": {"reputation": 115, "user_id": 7535145, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/433853c9ebc39c8811f7ca46cc5df58d?s=128&d=identicon&r=PG&f=1", "display_name": "astha", "link": "https://stackoverflow.com/users/7535145/astha"}, "reply_to_user": {"reputation": 885, "user_id": 1758897, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hMoc1.png?s=128&g=1", "display_name": "basslo", "link": "https://stackoverflow.com/users/1758897/basslo"}, "edited": false, "score": 0, "creation_date": 1489598634, "post_id": 42816028, "comment_id": 72745275, "body": "Yes in my folder there are 5 excel file which I want to embed in a powerpoint slide"}, {"owner": {"reputation": 115, "user_id": 7535145, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/433853c9ebc39c8811f7ca46cc5df58d?s=128&d=identicon&r=PG&f=1", "display_name": "astha", "link": "https://stackoverflow.com/users/7535145/astha"}, "reply_to_user": {"reputation": 885, "user_id": 1758897, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hMoc1.png?s=128&g=1", "display_name": "basslo", "link": "https://stackoverflow.com/users/1758897/basslo"}, "edited": false, "score": 0, "creation_date": 1489598876, "post_id": 42816028, "comment_id": 72745412, "body": "Actually I want all these excel files should be attached as an attachment in my powerpoint slide"}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1489599408, "post_id": 42816028, "comment_id": 72745746, "body": "<code>folderpath &amp; fil.name</code> -----&gt; <code>folderpath &amp; &quot;\\&quot; &amp; fil.name</code>"}, {"owner": {"reputation": 115, "user_id": 7535145, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/433853c9ebc39c8811f7ca46cc5df58d?s=128&d=identicon&r=PG&f=1", "display_name": "astha", "link": "https://stackoverflow.com/users/7535145/astha"}, "edited": false, "score": 0, "creation_date": 1489599657, "post_id": 42816028, "comment_id": 72745916, "body": "I tried this it still gives me error Run time error, shapes unknown member := Invalid request on this line"}, {"owner": {"reputation": 115, "user_id": 7535145, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/433853c9ebc39c8811f7ca46cc5df58d?s=128&d=identicon&r=PG&f=1", "display_name": "astha", "link": "https://stackoverflow.com/users/7535145/astha"}, "edited": false, "score": 0, "creation_date": 1489599665, "post_id": 42816028, "comment_id": 72745920, "body": "Set obchart = pres.Shapes.AddOLEObject(100, 100, 200, 100, folderpath &amp; &quot;\\&quot; &amp; fil.Name, True)"}], "answers": [{"tags": [], "owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "is_accepted": true, "score": 0, "last_activity_date": 1489604604, "creation_date": 1489604604, "answer_id": 42818568, "question_id": 42816028, "link": "https://stackoverflow.com/questions/42816028/copying-files-from-folder-and-embedding-it-in-powerpoint-slide/42818568#42818568", "title": "copying files from folder and embedding it in powerpoint slide", "body": "<p>You forgot the \"\\\" between the path and the file name, and you misplaced the arguments. Try this:</p>\n\n<pre><code>Set obchart = pres.Shapes.AddOLEObject(100, 100, 200, 100, , folderpath &amp; \"\\\" &amp; fil.Name, True)\n'                                                         ^^^           ^^^^^^\n</code></pre>\n"}], "owner": {"reputation": 115, "user_id": 7535145, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/433853c9ebc39c8811f7ca46cc5df58d?s=128&d=identicon&r=PG&f=1", "display_name": "astha", "link": "https://stackoverflow.com/users/7535145/astha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 0, "accepted_answer_id": 42818568, "answer_count": 1, "score": 2, "last_activity_date": 1489604604, "creation_date": 1489596725, "last_edit_date": 1489599165, "question_id": 42816028, "link": "https://stackoverflow.com/questions/42816028/copying-files-from-folder-and-embedding-it-in-powerpoint-slide", "title": "copying files from folder and embedding it in powerpoint slide", "body": "<p>In a folder there are some files which I want to copy and embed it in my powerpoint slide.\nI have written a code, however it is giving error \"Run Time Error . Shapes unknown member: Invalid Request on this line:</p>\n\n<blockquote>\n  <p><code>Set obchart = pres.Shapes.AddOLEObject(100, 100, 200, 100, folderpath &amp; fil.Name, True)</code></p>\n</blockquote>\n\n<pre><code>Sub copyfilestoppt()\n    Dim fso As Scripting.FileSystemObject\n    Dim fil As Scripting.file\n    Dim foldername As Scripting.Folder\n    Dim folderpath As String\n    Dim pres As PowerPoint.Slide\n    Dim obchart As Object\n\n    folderpath = \"C:\\Users\\av\\Desktop\\Macro\\Excel maacro\"\n    Set fso = New Scripting.FileSystemObject\n    Set foldername = fso.GetFolder(folderpath)\n    Set pres = ActivePresentation.Slides(1)\n\n    'loop\n    For Each fil In foldername.Files\n        With ActivePresentation\n            Set pres = ActivePresentation.Slides(1)\n            Set obchart = pres.Shapes.AddOLEObject(100, 100, 200, 100, folderpath &amp; fil.name, True)\n        End With\n    Next fil\n    Set obchart = Nothing\nEnd Sub\n</code></pre>\n"}, {"tags": ["database", "excel", "copy", "vba"], "comments": [{"owner": {"reputation": 524, "user_id": 7648526, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b54db50ad2bfd167b85f1686dd47b28d?s=128&d=identicon&r=PG&f=1", "display_name": "SteveES", "link": "https://stackoverflow.com/users/7648526/stevees"}, "edited": false, "score": 0, "creation_date": 1489598176, "post_id": 42815992, "comment_id": 72745028, "body": "Can you please state more clearly exactly what you want the code to do (with an example ideally), and add in what you have already tried."}, {"owner": {"reputation": 87, "user_id": 3810199, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/kUV2U.jpg?s=128&g=1", "display_name": "JCprog", "link": "https://stackoverflow.com/users/3810199/jcprog"}, "reply_to_user": {"reputation": 524, "user_id": 7648526, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b54db50ad2bfd167b85f1686dd47b28d?s=128&d=identicon&r=PG&f=1", "display_name": "SteveES", "link": "https://stackoverflow.com/users/7648526/stevees"}, "edited": false, "score": 0, "creation_date": 1489599474, "post_id": 42815992, "comment_id": 72745785, "body": "here&#39;s a sample workbooks: <a href=\"http://jmluzadas.com/WB.zip\" rel=\"nofollow noreferrer\">Workbook samples</a>"}, {"owner": {"reputation": 87, "user_id": 3810199, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/kUV2U.jpg?s=128&g=1", "display_name": "JCprog", "link": "https://stackoverflow.com/users/3810199/jcprog"}, "reply_to_user": {"reputation": 524, "user_id": 7648526, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b54db50ad2bfd167b85f1686dd47b28d?s=128&d=identicon&r=PG&f=1", "display_name": "SteveES", "link": "https://stackoverflow.com/users/7648526/stevees"}, "edited": false, "score": 0, "creation_date": 1489600038, "post_id": 42815992, "comment_id": 72746130, "body": "the code will copy only new data from one workbook to another the only problem with this code is that it only copy 2 columns, I need it to copy all the way to DQ."}, {"owner": {"reputation": 1472, "user_id": 1726522, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/0DUTN.gif?s=128&g=1", "display_name": "CMArg", "link": "https://stackoverflow.com/users/1726522/cmarg"}, "edited": false, "score": 0, "creation_date": 1489600332, "post_id": 42815992, "comment_id": 72746307, "body": "Try replacing <code>arr1 = wb1.Sheets(1).Range(&quot;A2:B&quot; &amp; wb1.Sheet....</code> with <code>arr1 = wb1.Sheets(1).Range(&quot;A2:ZQ&quot; &amp; wb1.Sheet....</code>. Same for <code>arr2</code>. Anyway, I would not add that much amount of data to an array, but look for an alternate method."}, {"owner": {"reputation": 87, "user_id": 3810199, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/kUV2U.jpg?s=128&g=1", "display_name": "JCprog", "link": "https://stackoverflow.com/users/3810199/jcprog"}, "edited": false, "score": 0, "creation_date": 1489600588, "post_id": 42815992, "comment_id": 72746470, "body": "CMArg, that&#39;s actually the first thing I tried and it didn&#39;t do a thing"}, {"owner": {"reputation": 1472, "user_id": 1726522, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/0DUTN.gif?s=128&g=1", "display_name": "CMArg", "link": "https://stackoverflow.com/users/1726522/cmarg"}, "edited": false, "score": 0, "creation_date": 1489600977, "post_id": 42815992, "comment_id": 72746679, "body": "you&#39;re right. Code is &quot;storing&quot; desired values in <code>arr3</code>, but only two of them (the lines below <code>ReDim Preserve</code>). Other than hard code all columns, some loop might work. But can&#39;t see clearly how to."}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1489602764, "post_id": 42815992, "comment_id": 72747718, "body": "@JCprog How do you determine which row to copy ? what is the criteria ? in the sample code above with 2 columns, it compares the values of column A and column B per row ? You want to compare the values of column A to B , B to C? C to D? A to C? ....... and so on ? what is the criteria to decide which row to copy ?"}, {"owner": {"reputation": 87, "user_id": 3810199, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/kUV2U.jpg?s=128&g=1", "display_name": "JCprog", "link": "https://stackoverflow.com/users/3810199/jcprog"}, "edited": false, "score": 0, "creation_date": 1489604148, "post_id": 42815992, "comment_id": 72748553, "body": "Shai Rado, unique ID&#39;s are in column A on both workbooks. Compare ID&#39;s on both workbooks and only copy over the ones that don&#39;t exist in wb2."}], "answers": [{"comments": [{"owner": {"reputation": 87, "user_id": 3810199, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/kUV2U.jpg?s=128&g=1", "display_name": "JCprog", "link": "https://stackoverflow.com/users/3810199/jcprog"}, "edited": false, "score": 0, "creation_date": 1489617594, "post_id": 42820779, "comment_id": 72755702, "body": "CMArg, Thanks for the code! this works, however, it also copy even the blank cells. I noticed it with the length of the horizontal scrollbar. This will be problematic when the routine is run for x number of times. Here&#39;s the updated sample <a href=\"http://jmluzadas.com/WB.zip\" rel=\"nofollow noreferrer\">workbooks</a> I&#39;ve been playing around with and hard coded each position in array, your code is also in a module."}, {"owner": {"reputation": 1472, "user_id": 1726522, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/0DUTN.gif?s=128&g=1", "display_name": "CMArg", "link": "https://stackoverflow.com/users/1726522/cmarg"}, "reply_to_user": {"reputation": 87, "user_id": 3810199, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/kUV2U.jpg?s=128&g=1", "display_name": "JCprog", "link": "https://stackoverflow.com/users/3810199/jcprog"}, "edited": false, "score": 0, "creation_date": 1489658857, "post_id": 42820779, "comment_id": 72771521, "body": "Glad it helps. Instead of <code>.EntireRow</code> you can define a range. Regarding the link to sample workbooks, few people will dare to open unknown excel file. And certainly not me."}], "tags": [], "owner": {"reputation": 1472, "user_id": 1726522, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/0DUTN.gif?s=128&g=1", "display_name": "CMArg", "link": "https://stackoverflow.com/users/1726522/cmarg"}, "is_accepted": true, "score": 1, "last_activity_date": 1489612351, "creation_date": 1489612351, "answer_id": 42820779, "question_id": 42815992, "link": "https://stackoverflow.com/questions/42815992/copy-only-new-data-from-one-workbook-to-another/42820779#42820779", "title": "copy only new data from one workbook to another", "body": "<p>Try following code:</p>\n\n<pre><code>Sub CompareArrays()\n\nDim arr1() As Variant, arr2() As Variant, arr3() As Variant\nDim i As Long, j As Long, k As Long, nextRow As Long\nDim wb1 As Workbook, wb2 As Workbook\nDim x As Boolean\n\nSet wb1 = Workbooks(\"Workbook1.xlsm\") 'Name of first workbook\nSet wb2 = Workbooks(\"Workbook2.xlsx\") 'Name of second workbook\narr1 = wb1.Sheets(1).Range(\"A2:A\" &amp; wb1.Sheets(1).Cells(Rows.Count, 1).End(xlUp).Row).Value\narr2 = wb2.Sheets(1).Range(\"A2:A\" &amp; wb2.Sheets(1).Cells(Rows.Count, 1).End(xlUp).Row).Value\nk = 1\nFor i = LBound(arr1) To UBound(arr1)\n    x = True\n    For j = LBound(arr2) To UBound(arr2)\n        If arr1(i, 1) = arr2(j, 1) Then\n            x = False\n            Exit For\n        End If\n    Next j\n    If x = True Then\n        k = k + 1\n        pos = Application.Match(arr1(i, 1), arr1, False) + 1 'get position in array\n        nextRow = wb2.Sheets(1).Cells(Rows.Count, \"A\").End(xlUp).Row + 1\n        wb2.Sheets(1).Rows(nextRow).EntireRow.Value = wb1.Sheets(1).Rows(pos).EntireRow.Value\n    End If\nNext i\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 87, "user_id": 3810199, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/kUV2U.jpg?s=128&g=1", "display_name": "JCprog", "link": "https://stackoverflow.com/users/3810199/jcprog"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 59, "favorite_count": 0, "accepted_answer_id": 42820779, "answer_count": 1, "score": -1, "last_activity_date": 1489612351, "creation_date": 1489596619, "last_edit_date": 1531164843, "question_id": 42815992, "link": "https://stackoverflow.com/questions/42815992/copy-only-new-data-from-one-workbook-to-another", "title": "copy only new data from one workbook to another", "body": "<p>Found this code below that copies only \"new\" data from workbook1 to workbook2. It does what it suppose to but only limited to two columns A and B. My data span all the way to ZQ on every row. I tried to tweak the code for my purpose but its just beyond me. I appreciate any help.</p>\n\n<pre><code>Sub CompareArrays()\n\nDim arr1() As Variant, arr2() As Variant, arr3() As Variant\nDim i As Long, j As Long, k As Long, nextRow As Long\nDim wb1 As Workbook, wb2 As Workbook\nDim x As Boolean\n\nSet wb1 = Workbooks(\"Workbook1.xlsm\") 'Name of first workbook\nSet wb2 = Workbooks(\"Workbook2.xlsx\") 'Name of second workbook\narr1 = wb1.Sheets(1).Range(\"A2:B\" &amp; wb1.Sheets(1).Cells(Rows.Count, 1).End(xlUp).Row).Value\narr2 = wb2.Sheets(1).Range(\"A2:B\" &amp; wb2.Sheets(1).Cells(Rows.Count, 1).End(xlUp).Row).Value\n\nFor i = LBound(arr1) To UBound(arr1)\n    x = True\n    For j = LBound(arr2) To UBound(arr2)\n        If arr1(i, 1) = arr2(j, 1) Then\n            x = False\n            Exit For\n        End If\n    Next j\n    If x = True Then\n        k = k + 1\n        ReDim Preserve arr3(2, k)\n        arr3(1, k - 1) = arr1(i, 2)\n        arr3(0, k - 1) = arr1(i, 1)\n    End If\nNext i\n\nWith wb2.Sheets(1)\n    nextRow = .Cells(Rows.Count, \"A\").End(xlUp).Row + 1\n    .Range(.Cells(nextRow, 1), .Cells(nextRow + k, 2)) = Application.Transpose(arr3)\nEnd With\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "file", "text", "input"], "answers": [{"comments": [{"owner": {"reputation": 113, "user_id": 2000581, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/a5f17a6e42e340972991c3789b21f01a?s=128&d=identicon&r=PG", "display_name": "umayfindurself", "link": "https://stackoverflow.com/users/2000581/umayfindurself"}, "edited": false, "score": 0, "creation_date": 1489656792, "post_id": 42815831, "comment_id": 72770020, "body": "The file was written in Matlab with space as the delimiter."}], "tags": [], "owner": {"reputation": 531, "user_id": 7416494, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wuDKk.jpg?s=128&g=1", "display_name": "user681574", "link": "https://stackoverflow.com/users/7416494/user681574"}, "is_accepted": false, "score": 0, "last_activity_date": 1489692810, "last_edit_date": 1489692810, "creation_date": 1489596191, "answer_id": 42815831, "question_id": 42815666, "link": "https://stackoverflow.com/questions/42815666/reading-formatted-data-from-a-text-file/42815831#42815831", "title": "Reading formatted data from a text file", "body": "<p>How was the input file created?  It appears to be in a different format than the Input # directive is expecting.</p>\n\n<p><a href=\"https://msdn.microsoft.com/en-us/library/aa243386(v=vs.60).aspx\" rel=\"nofollow noreferrer\">https://msdn.microsoft.com/en-us/library/aa243386(v=vs.60).aspx</a></p>\n\n<p>\"Data read with Input # is usually written to a file with Write #. Use this statement only with files opened in Input or Binary mode.\"</p>\n\n<p>\"Note   To be able to correctly read data from a file into variables using Input #, use the Write # statement instead of the Print # statement to write the data to the files. Using Write # ensures each separate data field is properly delimited.\"</p>\n\n<p>Given the space delimitation, you'll need to parse the file differently.  Here is one example:</p>\n\n<pre><code>Dim iLine As Integer, \nDim sFile As String\nDim sData As String\nDim sLine() As String\nDim sSplitLine() As String\nDim x as Double\nDim y as Double\n\n'read the whole file into 1 string variable\nsFile = \"perforatedcircles.txt\"\nOpen sFile For Input As #1\nsData = Input(LOF(1), 1)\nClose #1\nsLine = Split(sData, vbCrLf)\nFor iLine = 0 To UBound(sLine)\n    sSplitLine = Split(sLine(UBound(sLine)), \" \")\n\n    x = CDbl(sSplitLine(0))\n    y = CDbl(sSplitLine(1))\n    'Do Stuff with your numbers here\nNext iLine\n</code></pre>\n"}], "owner": {"reputation": 113, "user_id": 2000581, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/a5f17a6e42e340972991c3789b21f01a?s=128&d=identicon&r=PG", "display_name": "umayfindurself", "link": "https://stackoverflow.com/users/2000581/umayfindurself"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 46, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1489692810, "creation_date": 1489595679, "question_id": 42815666, "link": "https://stackoverflow.com/questions/42815666/reading-formatted-data-from-a-text-file", "title": "Reading formatted data from a text file", "body": "<p>The following code reads in values (in a loop) from a text file containing two numbers per line into X and Y. The first iteration of the loop gives correct values for X and Y (70, 210). The next iteration onwards, the X and Y values are not what is contained in the file (210, 210 for the second iteration instead of 0, 210). I ust be making a mistake but I can't seem to find it !</p>\n\n<pre><code>Sub main()\nDim X As Double\nDim Y As Double\n\nOpen \"perforatedcircles.txt\" For Input As #1\n\nDo While Not EOF(1)\nInput #1, X, Y\nLoop\nClose #1\n\nEnd Sub\n</code></pre>\n\n<p>Sample Contents of \"perforatedcircles.txt\":</p>\n\n<pre><code>70.000 210.000\n0.000 210.000\n-70.000 -210.000\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 7716290, "user_type": "registered", "profile_image": "https://graph.facebook.com/10208703498454230/picture?type=large", "display_name": "Sydney Shafer", "link": "https://stackoverflow.com/users/7716290/sydney-shafer"}, "edited": false, "score": 0, "creation_date": 1489604195, "post_id": 42815692, "comment_id": 72748576, "body": "Thanks for the comment.  I substituted Worksheets(sheet.Name) with Worksheets(Index) however if I run the command more than once, it will re-copy in the sheets and add a (2) or (3) after the sheet name.  Is there a way to prevent it from copying the sheet in at all if it has already been copied?"}], "tags": [], "owner": {"reputation": 128, "user_id": 7677928, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5334e48ef9f7115924b4b2cc695222ed?s=128&d=identicon&r=PG&f=1", "display_name": "Enrico", "link": "https://stackoverflow.com/users/7677928/enrico"}, "is_accepted": false, "score": 0, "last_activity_date": 1489595765, "creation_date": 1489595765, "answer_id": 42815692, "question_id": 42815351, "link": "https://stackoverflow.com/questions/42815351/copy-worksheets-into-another-workbook-without-duplicating-worksheets/42815692#42815692", "title": "Copy worksheets into another workbook without duplicating worksheets", "body": "<p>Dont use <strong>sheet.Name</strong>. Use <strong>Worksheet(index)</strong> to identify the workbook you want. Ist more safe and you will be sure to copy one by one (avoid double copying).</p>\n"}, {"tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": true, "score": 1, "last_activity_date": 1489654113, "creation_date": 1489654113, "answer_id": 42829140, "question_id": 42815351, "link": "https://stackoverflow.com/questions/42815351/copy-worksheets-into-another-workbook-without-duplicating-worksheets/42829140#42829140", "title": "Copy worksheets into another workbook without duplicating worksheets", "body": "<p>you could use a helper function like the following</p>\n\n<pre><code>Function IsSheetFree(wb As Workbook, shtName As String) As Boolean\n    Dim sht As Worksheet\n\n    On Error Resume Next '&lt;--| prevent any subsequent error to stop the function\n    Set sht = wb.Worksheets(shtName) '&lt;--| try setting 'sht' worksheet object to the one with passed name in the passed workbook\n    IsSheetFree = sht Is Nothing '&lt;--| return 'True' if 'sht' has not been successfully set\nEnd Function\n</code></pre>\n\n<p>and exploit it as follows:</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n\n    Dim directory As String\n    Dim fileName As String\n    Dim sht As Worksheet\n\n    Dim totalWb As Workbook\n\n    Set totalWb = Workbooks(\"test import.xlsm\")\n\n    Application.ScreenUpdating = False\n    Application.DisplayAlerts = False\n\n    directory = \"c:\\test\\\"\n    ' edit directory\n\n    fileName = Dir(directory &amp; \"*.xl??\")\n\n    Do While fileName &lt;&gt; \"\"\n        Workbooks.Open directory &amp; fileName '&lt;--| this makes the just opened workbook the \"active\" one\n\n        For Each sht In Worksheets '&lt;--| loop through currently active workbook worksheets\n            If IsSheetFree(totalWb, sht.Name) Then sht.Copy after:=totalWb.Worksheets(totalWb.Worksheets.Count)\n        Next sht\n\n        ActiveWorkbook.Close\n\n        fileName = Dir()\n    Loop\n\n    Application.ScreenUpdating = True\n    Application.DisplayAlerts = True\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 7716290, "user_type": "registered", "profile_image": "https://graph.facebook.com/10208703498454230/picture?type=large", "display_name": "Sydney Shafer", "link": "https://stackoverflow.com/users/7716290/sydney-shafer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 90, "favorite_count": 0, "accepted_answer_id": 42829140, "answer_count": 2, "score": 0, "last_activity_date": 1489654113, "creation_date": 1489594805, "last_edit_date": 1531164843, "question_id": 42815351, "link": "https://stackoverflow.com/questions/42815351/copy-worksheets-into-another-workbook-without-duplicating-worksheets", "title": "Copy worksheets into another workbook without duplicating worksheets", "body": "<p>I'm new at VBA so bear with me.  I'm trying to copy worksheets from a specified file location into a master consolidated workbook.  I would like to prevent copying duplicate worksheets into the consolidated workbook.  For example, if sheet 1 has been copied into the Master consolidated workbook, I don't want to recopy it when the command has been ran.  Below is the code I have so far. </p>\n\n<pre><code>Private Sub CommandButton1_Click()\n\nDim directory As String\nDim fileName As String\nDim sheet As Worksheet\nDim total As Integer\n\nApplication.ScreenUpdating = False\nApplication.DisplayAlerts = False\n\ndirectory = \"c:\\test\\\"\n' edit directory\n\nfileName = Dir(directory &amp; \"*.xl??\")\n\nDo While fileName &lt;&gt; \"\"\nWorkbooks.Open (directory &amp; fileName)\n\nFor Each sheet In Workbooks(fileName).Worksheets\n    total = Workbooks(\"test import.xlsm\").Worksheets.Count\n    Workbooks(fileName).Worksheets(sheet.Name).Copy _\n    after:=Workbooks(\"test import.xlsm\").Worksheets(total)\nNext sheet\n\nWorkbooks(fileName).Close\n\nfileName = Dir()\n\nLoop\n\n\nApplication.ScreenUpdating = True\nApplication.DisplayAlerts = True\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "heuristics"], "owner": {"reputation": 21, "user_id": 7716217, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0d72caa2be4da4186ad12abffc8c61e?s=128&d=identicon&r=PG&f=1", "display_name": "Xinmu Zhang", "link": "https://stackoverflow.com/users/7716217/xinmu-zhang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 177, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1489646392, "creation_date": 1489594800, "last_edit_date": 1489646392, "question_id": 42815348, "link": "https://stackoverflow.com/questions/42815348/local-search-heuristic-vba-compile-error", "title": "Local Search Heuristic vba compile error", "body": "<p>Hi I am building a local search heuristic for a TSP similar problem and have encountered some bugs. I am using the sequence obtained from using the constructive heuristic (solConstr) and when I run the code there is a constant \"compile error: for without next\" and a highlight on the \"End Sub\". Please can anyone help me find the bug, thanks a lot!</p>\n\n<p>Here is my code:</p>\n\n<pre><code>For b = 1 To Count\n    For pos = b + 1 To Count\n        changePosition = solConstr.Sequence(b)\n\n        For c = 1 To Count\n            If c &gt;= 1 And c &lt;= b - 1 Then\n                solTemp.Sequence(c) = solConstr.Sequence(c)\n            ElseIf c &gt;= b And c &lt;= pos - 1 Then\n                solTemp.Sequence(c) = solConstr.Sequence(c + 1)\n            ElseIf c &gt;= pos + 1 And c &lt;= Count Then\n                solTemp.Sequence(c) = solConstr.Sequence(c)\n            End If\n\n            solTemp.Sequence(pos) = changePosition\n\n            Call EvaluateSolution(shoppingInfo, solTemp)\n            currentCost = solTemp.Cost\n            MsgBox (\"change\" &amp; b &amp; \"to\" &amp; pos &amp; \"will incur updated cost of\" &amp; currentCost)\n\n            If currentCost &lt; newcost Then newcost = currentCost\n\n            For d = 1 To Count\n                solTemp.Sequence(d) = solLS.Sequence(d)\n            Next\n\n        Next\n    Next\nNext\n</code></pre>\n\n<p>Here is the psuedo code:</p>\n\n<p>Data: n, c[ij ], sol [i ], sNew[i ], i = 0, . . . , n \u2212 1</p>\n\n<p>Result: newCost</p>\n\n<p>currentCost=ComputeCost(n, c[ij ], sol [i ], i = 0, . . . , n \u2212 1);</p>\n\n<p>for k = 0 To n \u2212 1 do</p>\n\n<p>for pos = 0 To n \u2212 1, pos 6= i do</p>\n\n<p>cost= EvaluateSol(n, c[ij ], sol [i ], i = 0, . . . , n \u2212 1, k, pos);</p>\n\n<p>if cost &lt; currentCost then</p>\n\n<p>currentCost = cost;</p>\n\n<p>Update sNew[i ], i = 0, . . . , n \u2212 1;</p>\n\n<p>Return sNew;</p>\n\n<p>end</p>\n\n<p>end</p>\n\n<p>end</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 6095, "user_id": 1274820, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/620aa435151f022b9c4070eae088d788?s=128&d=identicon&r=PG", "display_name": "user1274820", "link": "https://stackoverflow.com/users/1274820/user1274820"}, "is_accepted": false, "score": 0, "last_activity_date": 1489609106, "creation_date": 1489609106, "answer_id": 42819874, "question_id": 42815090, "link": "https://stackoverflow.com/questions/42815090/apply-a-macro-to-range-of-cells/42819874#42819874", "title": "Apply a Macro to range of cells", "body": "<pre><code>If Target.Address = \"$B$24\"\n</code></pre>\n\n<p>This is the line you're interested in modifying.</p>\n\n<p>If you only want it to occur on a single cell, you likely want to add above it</p>\n\n<pre><code>If Target.CountLarge &gt; 1 Then Exit Sub\n</code></pre>\n\n<p>Now that we know it was only a single cell that was clicked, we can use intersect to keep the code short and replace the first line with</p>\n\n<pre><code>If Not Intersect(Target, [B24:B28]) is Nothing Then\n</code></pre>\n\n<p>Alternatively, we could just replace the single line with</p>\n\n<pre><code>If Target.Address = \"$B$24\" Or Target.Address = \"$B$25\" Or Target.Address = \"$B$26\" Or Target.Address = \"$B$27\" Or Target.Address = \"$B$28\"\n</code></pre>\n\n<p>But as you can see, that gets a bit less elegant pretty quickly.</p>\n\n<p>My advice - replace:</p>\n\n<pre><code>If Target.Address = \"$B$24\"\n</code></pre>\n\n<p>With:</p>\n\n<pre><code>If Target.CountLarge &gt; 1 Then Exit Sub\nIf Not Intersect(Target, [B24:B28]) is Nothing Then\n</code></pre>\n\n<p>Final code becomes:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\nDim Oldvalue As String\nDim Newvalue As String\n\nOn Error GoTo Exitsub\nIf Target.CountLarge &gt; 1 Then Exit Sub\nIf Not Intersect(Target, [B24:B28]) is Nothing Then\n    If Target.SpecialCells(xlCellTypeAllValidation) Is Nothing Then\n    GoTo Exitsub\n    Else: If Target.Value = \"\" Then GoTo Exitsub Else\n        Application.EnableEvents = False\n        Newvalue = Target.Value\n        Application.Undo\n        Oldvalue = Target.Value\n        If Oldvalue = \"\" Then\n            Target.Value = Newvalue\n        Else\n            Target.Value = Oldvalue &amp; \", \" &amp; Newvalue\n        End If\n    End If\nEnd If\n</code></pre>\n\n<p>In the future, if you want to change the <code>Range</code> this affects, you can just modify the <code>[B24:B28]</code></p>\n"}], "owner": {"reputation": 1, "user_id": 7716245, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-7XZbbHY-NT4/AAAAAAAAAAI/AAAAAAAAAZk/-9am5oufLGg/photo.jpg?sz=128", "display_name": "susnwalkr", "link": "https://stackoverflow.com/users/7716245/susnwalkr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1091, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1490396696, "creation_date": 1489594172, "last_edit_date": 1531161705, "question_id": 42815090, "link": "https://stackoverflow.com/questions/42815090/apply-a-macro-to-range-of-cells", "title": "Apply a Macro to range of cells", "body": "<p>I need to apply the code below to a range of cells (i.e. B24:B28) - how do I edit to make this happen?</p>\n\n<hr>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\nDim Oldvalue As String\nDim Newvalue As String\n\nOn Error GoTo Exitsub\nIf Target.Address = \"$B$24\" Then\n    If Target.SpecialCells(xlCellTypeAllValidation) Is Nothing Then\n    GoTo Exitsub\n    Else: If Target.Value = \"\" Then GoTo Exitsub Else\n        Application.EnableEvents = False\n        Newvalue = Target.Value\n        Application.Undo\n        Oldvalue = Target.Value\n        If Oldvalue = \"\" Then\n            Target.Value = Newvalue\n        Else\n            Target.Value = Oldvalue &amp; \", \" &amp; Newvalue\n        End If\n    End If\nEnd If\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 177, "user_id": 7569118, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c3b83c8c08ad316e02d4ce62c8a0a73?s=128&d=identicon&r=PG&f=1", "display_name": "Cocoberry2526", "link": "https://stackoverflow.com/users/7569118/cocoberry2526"}, "edited": false, "score": 0, "creation_date": 1489604487, "post_id": 42815457, "comment_id": 72748787, "body": "Thank you so much Jeeped, this was a huge help!"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 4, "last_activity_date": 1489596450, "last_edit_date": 1495539991, "creation_date": 1489595134, "answer_id": 42815457, "question_id": 42814927, "link": "https://stackoverflow.com/questions/42814927/copying-and-pasting-multiple-columns-into-another-worksheet-using-vba/42815457#42815457", "title": "Copying and pasting multiple columns into another worksheet using vba", "body": "<p>See <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba-macros\">How to avoid using Select in Excel VBA macros</a>.</p>\n\n<pre><code>Sub yg23iwyg()\n    Dim wst As Worksheet\n\n    Set wst = Worksheets.Add\n    wst.Name = \"Data\"\n    With Worksheets(\"Table\")\n        .Range(.Cells(1, \"A\"), .Cells(.Rows.Count, \"D\").End(xlUp)).Copy _\n            Destination:=wst.Cells(1, \"A\")\n        .Range(.Cells(1, \"AK\"), .Cells(.Rows.Count, \"AL\").End(xlUp)).Copy _\n            Destination:=wst.Cells(1, \"E\")\n\n        'alternate with Union'ed range - becomes a Copy, Paste Special, Values and Formats because of the union\n        .Range(\"A:D, AK:AL\").Copy _\n            Destination:=wst.Cells(1, \"A\")\n    End With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 177, "user_id": 7569118, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c3b83c8c08ad316e02d4ce62c8a0a73?s=128&d=identicon&r=PG&f=1", "display_name": "Cocoberry2526", "link": "https://stackoverflow.com/users/7569118/cocoberry2526"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4859, "favorite_count": 0, "accepted_answer_id": 42815457, "answer_count": 1, "score": 2, "last_activity_date": 1489596450, "creation_date": 1489593729, "last_edit_date": 1489595913, "question_id": 42814927, "link": "https://stackoverflow.com/questions/42814927/copying-and-pasting-multiple-columns-into-another-worksheet-using-vba", "title": "Copying and pasting multiple columns into another worksheet using vba", "body": "<p>I'm working on a code that will copy several columns of data that are not in order. I couldn't figure out how to do it in one step so i was trying to get it in two. After the first set of columns posts I'm having trouble getting it to go back to the sheet I was on to copy the next set of columns. This is what my code looks like so far.</p>\n\n<p>Survey_Macro1 Macro</p>\n\n<pre><code>range(\"A:D\").Select\nrange(Selection, Selection.End(xlDown)).Select\nSelection.Copy\nSheets.Add.Name = \"Data\"\nActiveSheet.Paste\nThisWorkbook.Save\nThisWorkbook.Sheets(\"Table\").Activate\nApplication.CutCopyMode = False\nrange(\"AK:AL\").Select\nrange(Selection, Selection.End(xlDown)).Select\nSelection.Copy\nThisWorkbook.Worksheets(\"Data\").range(E1).Select\nActiveSheet.Paste\n</code></pre>\n"}, {"tags": ["vba", "ms-access", "replace", "ms-word", "find"], "answers": [{"tags": [], "owner": {"reputation": 107, "user_id": 6104146, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/10154083379249365/picture?type=large", "display_name": "Steve O&#39;Dea", "link": "https://stackoverflow.com/users/6104146/steve-odea"}, "is_accepted": false, "score": 3, "last_activity_date": 1489594640, "creation_date": 1489594640, "answer_id": 42815291, "question_id": 42814790, "link": "https://stackoverflow.com/questions/42814790/vba-access-find-and-replace-text-in-word-document/42815291#42815291", "title": "VBA Access - Find and Replace text in Word Document", "body": "<p>Actually I've just figured it out myself...I hadn't referenced the Word object library under tools.</p>\n\n<p>Always something simple!</p>\n"}], "owner": {"reputation": 107, "user_id": 6104146, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/10154083379249365/picture?type=large", "display_name": "Steve O&#39;Dea", "link": "https://stackoverflow.com/users/6104146/steve-odea"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4064, "favorite_count": 0, "answer_count": 1, "score": 5, "last_activity_date": 1567108949, "creation_date": 1489593340, "last_edit_date": 1508835738, "question_id": 42814790, "link": "https://stackoverflow.com/questions/42814790/vba-access-find-and-replace-text-in-word-document", "title": "VBA Access - Find and Replace text in Word Document", "body": "<p>I have successfully written some VBA code in Excel which opens an existing Word document, finds and replaces a string based on information in the Excel worksheet.</p>\n\n<p>As the source data exists comes from an Access Database, I thought I would try and move the VBA code into Access and run it from there.</p>\n\n<p>The updated code works mostly but strangely, the part of the code which finds and replaces the text string doesn't work when I run it in access.</p>\n\n<pre><code>Sub CreateFormsPDF()\n\n'   Creates Garda Vetting Forms NVB1 in Word and saves as PDF\n    Dim WordApp As Object\n    Dim WordDoc As Object\n    Dim db As Database\n    Dim rs As Recordset\n    Dim Records As Integer\n    Dim IDAnchor As String\n    Dim ID As String\n    Dim FilePath As String, SaveAsName As String\n\n    FilePath = \"N:\\\"\n\n'   Start Word and create an object (late binding)\n'   Document already exists so reference this\n    Set WordApp = CreateObject(\"Word.Application\")\n    Set WordDoc = WordApp.Documents.Open(FilePath &amp; \"Form1.docx\")\n\n    WordApp.Application.Visible = True\n\n'   Point to the relevant table in the Current Database\n    Set db = CurrentDb\n    Set rs = db.OpenRecordset(\"qryMailingList\", dbOpenDynaset, dbSeeChanges)\n    Records = rs.RecordCount\n\n'   Cycle through all records in MailingList Query\n    Do Until rs.EOF\n\n'   Define IDAnchor\n    IDAnchor = \"$$ID$$\"\n\n'   Assign current data to variables\n    ID = rs!StudentID\n\n'   Determine the filename\n    SaveAsName = FilePath &amp; ID &amp; \".pdf\"\n\n'   Send commands to Word\n    With WordApp\n        With WordDoc.Content.Find\n            .Text = IDAnchor\n            .Replacement.Text = ID\n            .Wrap = wdFindContinue\n            .Execute Replace:=wdReplaceAll\n        End With\n        .ActiveDocument.SaveAs2 FileName:=SaveAsName, FileFormat:=17\n    End With\n\n    IDAnchor = ID\n\n            rs.MoveNext\n    Loop\n\n    WordApp.Quit savechanges:=wdDoNotSaveChanges\n    Set WordApp = Nothing\n    Set WordDoc = Nothing\n    Set rs = Nothing\n    Set db = Nothing\n\n    MsgBox Records &amp; \" Forms Created\"\n\nEnd Sub\n</code></pre>\n\n<p>The code executes fine, with one exception which is the Find and Replace element in Word i.e.</p>\n\n<pre><code>'   Send commands to Word\n    With WordApp\n        With WordDoc.Content.Find\n            .Text = IDAnchor\n            .Replacement.Text = ID\n            .Wrap = wdFindContinue\n            .Execute Replace:=wdReplaceAll\n        End With\n        .ActiveDocument.SaveAs2 FileName:=SaveAsName, FileFormat:=17\n    End With\n</code></pre>\n\n<p>What is even stranger is that I have a version of this code running via Excel and this runs without any problems at all and I've lifted this section of code from that subroutine exactly as is. So this works in Excel, but not in Access but I've no idea why.</p>\n\n<p>Would really appreciate any help that might be available</p>\n\n<p>Many thanks...</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1489593548, "post_id": 42814726, "comment_id": 72741932, "body": "Are you putting this in a standard module code sheet or a worksheet&#39;s private code sheet?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1489593893, "post_id": 42814726, "comment_id": 72742172, "body": "1. What is in <code>Range(&quot;I4&quot;)</code> and what worksheet is <code>Range(&quot;I4&quot;)</code> on? 2. Are the values supposed to change in different new worksheets? They are all the same. 3. Do you have to retain the formulas or could you just write adjusted text into each cell?"}], "owner": {"reputation": 1, "user_id": 7716111, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dab8d85799a629f4e2895c2f54393bb?s=128&d=identicon&r=PG&f=1", "display_name": "J.Doe", "link": "https://stackoverflow.com/users/7716111/j-doe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 45, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1489593368, "creation_date": 1489593171, "last_edit_date": 1489593368, "question_id": 42814726, "link": "https://stackoverflow.com/questions/42814726/duplicate-excel-sheet", "title": "Duplicate Excel Sheet", "body": "<p>I have an excel sheet where I add in data about different items. I can have anywhere from 1-10 items. Each item has a different set of values attached to it and a report must be created for each item with the specified values. I have all of the values in different sheets in an excel file. I created an extra sheet that has the report. The report has the values concatenated into it. </p>\n\n<p>I am attempting to copy the template report for each item and change the values in the report to match correct item. I have a loop that creates the correct amount of specific reports, but I cannot figure out how to have the loop insert the correct values while copying the report. I am brand new at VBA and trying to learn. This is what I have so far.  </p>\n\n<pre><code>Private Sub Creating_New_Sheet()\n\n    Dim i As Integer\n\n\n\n    For i = 1 To Range(\"I4\")\n\n    Sheets(5).Copy After:=Sheets(Sheets.Count)\n    Sheets(Sheets.Count).Name = \"Well\" &amp; \" \" &amp; i\n\n        Sheets(Sheets.Count).Active\n        Range(\"B8\").Select\n        ActiveCell.FormulaR1C1 = \"=\"\"RE:\"\"&amp;\"\"         \"\"&amp;'Cost Summary'!RC[-1]\"\n        Range(\"B11\").Select\n        ActiveCell.FormulaR1C1 = _\n            \"=\"\"Attached for your review and approval is AFE\"\"&amp;\"\" \"\"&amp;'Cost Summary'!R[-3]C[7]&amp;\"\" \"\"&amp;\"\"to install plunger lift on the\"\" &amp;\"\" \"\"&amp; 'Cost Summary'!R[-3]C[-1]&amp;\"\". \"\"&amp; \"\"The AFE amount is reflected in the Expenditures section of the AFE.\"\"\"\n        Range(\"B13\").Select\n        ActiveCell.FormulaR1C1 = _\n            \"=\"\"Objective: The purpose of this workover is to install plunger lift on the\"\"&amp;\"\" \"\"&amp; 'Cost Summary'!R[-5]C[-1]&amp;\"\" \"\"&amp; \"\"to stabilize production decline. Artificial lift intervention is required because gas rates for the\"\"&amp;\"\" \"\"&amp; 'Cost Summary'!R[-5]C[-1]&amp;\"\" \"\"&amp; \"\"are no longer sufficient to adequately lift reservoir fluid from the wellbore.  If no intervention acti\" &amp; _\n            \"ken fluid will buildup in the wellbore adversely affecting the wells production and decline characteristics.\"\"\"\n        Range(\"B15\").Select\n        ActiveCell.FormulaR1C1 = _\n            \"=\"\"Attached you will find a detailed cost estimate for plunger lift system installations on the\"\" &amp;\"\" \"\"&amp; 'Cost Summary'!R[-7]C[-1]&amp;\"\"\"\"&amp;\"\". Cost estimates were made using price sheets for material and services.  All other costs were estimated based on past plunger installation costs.\"\"\"\n        Range(\"B17\").Select\n        ActiveCell.FormulaR1C1 = _\n            \"=\"\"Well History:\"\"&amp;\"\" \"\"&amp; 'Cost Summary'!R[-9]C[-1]&amp;\"\" \"\"&amp; \"\"was turned to sales on\"\"&amp;\"\" \"\"&amp; TEXT('Production and Well History'!R[-12]C[1],\"\"MM/DD/YY\"\")&amp;\"\" \"\"&amp; \"\"and has produced for\"\" &amp;\"\" \"\"&amp;'Production and Well History'!R[-12]C[2]&amp;\"\" \"\"&amp;\"\"days. The current production rates are\"\"&amp;\"\" \"\"&amp; 'Production and Well History'!R[-12]C[3]&amp;\"\" \"\"&amp;\"\"MCFD,\"\"&amp;\"\" \"\"&amp;'Production and \" &amp; _\n            \"tory'!R[-12]C[4]&amp;\"\" \"\"&amp;  \"\"BOPD,\"\"&amp;\"\" \"\"&amp; 'Production and Well History'!R[-12]C[5]&amp;\"\" \"\"&amp;\"\"BWPD at wellhead pressures of\"\" &amp;\"\" \"\"&amp;'Production and Well History'!R[-12]C[6]&amp;\"\" \"\"&amp;\"\"psi for casing pressure and\"\"&amp;\"\" \"\"&amp; 'Production and Well History'!R[-12]C[7]&amp;\"\" \"\"&amp;\"\"psi for tubing.\"\"\"\n        Range(\"B18\").Select\n\n\n    Next i\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "edited": false, "score": 2, "creation_date": 1489593195, "post_id": 42814541, "comment_id": 72741635, "body": "I&#39;d start by removing all of the <code>.Select</code> / <code>Selection.</code> entries to tidy it up and make everything fully qualified."}, {"owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "edited": false, "score": 0, "creation_date": 1489593671, "post_id": 42814541, "comment_id": 72742025, "body": "Also, you state that Excel &#39;crashes&#39;. Can you elaborate on how it crashes? Does it hang, error or &#39;quits unexpectedly&#39;?"}, {"owner": {"reputation": 203, "user_id": 3837438, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/ed0a2a24d198fa1448b1fc2c65d40b86?s=128&d=identicon&r=PG&f=1", "display_name": "spaindc", "link": "https://stackoverflow.com/users/3837438/spaindc"}, "reply_to_user": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "edited": false, "score": 0, "creation_date": 1489593872, "post_id": 42814541, "comment_id": 72742159, "body": "Hi, I edited the code above. I am not an expert at vba so if I didn&#39;t go through everything I could, please let me know. Excel quits, goes to the screen where it is &quot;trying to find a fix&quot; and then shuts down completely. Sometimes it gives me the option to debug (which I don&#39;t know how to do). When I click on that, it says &quot;An unhandled win32 exception occurred in excel.exe [2524]&quot;"}, {"owner": {"reputation": 524, "user_id": 7648526, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b54db50ad2bfd167b85f1686dd47b28d?s=128&d=identicon&r=PG&f=1", "display_name": "SteveES", "link": "https://stackoverflow.com/users/7648526/stevees"}, "edited": false, "score": 0, "creation_date": 1489595647, "post_id": 42814541, "comment_id": 72743463, "body": "Have you tried running the macro from another computer? What has changed on the computer since the last time the macro ran successfully? What version of Excel and what OS are you using? Also, the <code>Sheets().Select</code> statements should be replaced with <code>With Sheets()</code> blocks."}, {"owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "edited": false, "score": 0, "creation_date": 1489595784, "post_id": 42814541, "comment_id": 72743553, "body": "That&#39;s certainly better, though there is more you could do - that conversation is for another time - there&#39;s plenty of guides for using <code>WITH</code> etc.. I&#39;d now start to insert a breakpoint (or a <code>STOP</code>) within the code, just to find exactly what command is causing the issue. My gut-feeling is that it&#39;s probably the <code>Sheets(&quot;Landing&quot;).Select</code> line, trying to run before the <code>.Consolidate</code> has finished but I could be wrong."}, {"owner": {"reputation": 203, "user_id": 3837438, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/ed0a2a24d198fa1448b1fc2c65d40b86?s=128&d=identicon&r=PG&f=1", "display_name": "spaindc", "link": "https://stackoverflow.com/users/3837438/spaindc"}, "edited": false, "score": 0, "creation_date": 1489608292, "post_id": 42814541, "comment_id": 72751014, "body": "Hi! I did that. I added the stop at the <code>Sheets(&quot;Landing&quot;).Select</code>. Before I stepped into that, the I can see the consolidate finished on the <code>Working</code> Sheet. As i stepped into the code, it crashed right after highlighting the <code>vlookup</code> line. Any ideas? I am also curious why this has been running fine for months and now it is crashing."}, {"owner": {"reputation": 524, "user_id": 7648526, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b54db50ad2bfd167b85f1686dd47b28d?s=128&d=identicon&r=PG&f=1", "display_name": "SteveES", "link": "https://stackoverflow.com/users/7648526/stevees"}, "edited": false, "score": 0, "creation_date": 1489663504, "post_id": 42814541, "comment_id": 72774820, "body": "Do you mean that it is crashing before the <code>VLOOKUP</code> (while attempting to <code>ClearContents</code>) or after/while trying to calculate it? If it is the <code>VLOOKUP</code> that crashes, does it need to search the whole of the columns? It might help to restrict the number of rows it is searching, i.e. <code>&quot;=VLOOKUP(RC[-2],Working!R[1]C[2]:R[**Put in your number of rows**]C[3],2,FALSE)&quot;</code>."}, {"owner": {"reputation": 203, "user_id": 3837438, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/ed0a2a24d198fa1448b1fc2c65d40b86?s=128&d=identicon&r=PG&f=1", "display_name": "spaindc", "link": "https://stackoverflow.com/users/3837438/spaindc"}, "edited": false, "score": 0, "creation_date": 1490027336, "post_id": 42814541, "comment_id": 72917237, "body": "Hi again - sorry for not responding. I was off for a few days. It is definitely the <code>vlookup</code> - it crashes while trying to calculate it. Even even when I do it manually (outside of vba) it crashed a few times. I feel like I am going crazy, its not a complicate piece of code! I limited the cells it looks in and it still crashes. Any other ideas?"}], "owner": {"reputation": 203, "user_id": 3837438, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/ed0a2a24d198fa1448b1fc2c65d40b86?s=128&d=identicon&r=PG&f=1", "display_name": "spaindc", "link": "https://stackoverflow.com/users/3837438/spaindc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 238, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1489593823, "creation_date": 1489592750, "last_edit_date": 1531161705, "question_id": 42814541, "link": "https://stackoverflow.com/questions/42814541/excel-crash-not-sure-why", "title": "Excel Crash : not sure why", "body": "<p>I have an excel program with some code that has been running without problem for several months. Today it started crashing and I have no idea why. It may have nothing to do with the code but I pasted it below with the place where it seems to crash. When I walk through it step by step it runs fine. Thanks.</p>\n\n<pre><code>Sub Merge()\n\n    Sheets(\"Working\").Select\nDim lastRow As Long\nlastRow = Range(\"A\" &amp; Rows.Count).End(xlUp).Row\nColumns(\"A:A\").Insert Shift:=xlToRight, CopyOrigin:=xlFormatFromLeftOrAbove\nRange(\"A2\").FormulaR1C1 = \"=TEXT(RC[1],\"\"mmm\"\")\"\n\nRange(\"A2\").AutoFill Destination:=Range(\"A2:A\" &amp; lastRow)\nColumns(\"A:A\").Copy\nRange(\"A1\").PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n    :=False, Transpose:=False\nColumns(\"B:B\").Delete Shift:=xlToLeft\nRange(\"G1\").Consolidate Sources:= _\n    \"'Working'!R1C1:R[\" &amp; lastRow &amp; \"]C2\" _\n    , Function:=xlSum, TopRow:=True, LeftColumn:=True, CreateLinks:=False\n\n\nSheets(\"Landing\").Select\nRange(\"E10:F21\").ClearContents\n\nRange(\"E10\").FormulaR1C1 = \"=VLOOKUP(RC[-2],Working!C[2]:C[3],2,FALSE)\"\nRange(\"F10\").FormulaR1C1 = \"=RC[-1]/RC[-2]\"\nRange(\"E10:F10\").AutoFill Destination:=Range(\"E10:F21\"), Type:=xlFillDefault\n\n\n        On Error Resume Next\n        Cells.SpecialCells(xlCellTypeFormulas, xlErrors).ClearContents ' Delete #N/A\n        On Error GoTo 0\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1489592917, "post_id": 42814493, "comment_id": 72741389, "body": "Try <code>totalRows = Sheet2.Cells(Sheet2.Rows.Count, startColumn).End(xlUp).Row</code>. If that doesn&#39;t help then please include in your post on which line you are getting the aforementioned error."}, {"owner": {"reputation": 27, "user_id": 7716048, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/761dc9dbce6c83fb06c574c276096ce9?s=128&d=identicon&r=PG&f=1", "display_name": "Condav", "link": "https://stackoverflow.com/users/7716048/condav"}, "reply_to_user": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1489594145, "post_id": 42814493, "comment_id": 72742364, "body": "Tried your addition but still get the same error (object required). The debugger highlights that line as the one where the error is occurring."}, {"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1489594217, "post_id": 42814493, "comment_id": 72742420, "body": "Which line is highlighted when you get the error?"}, {"owner": {"reputation": 27, "user_id": 7716048, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/761dc9dbce6c83fb06c574c276096ce9?s=128&d=identicon&r=PG&f=1", "display_name": "Condav", "link": "https://stackoverflow.com/users/7716048/condav"}, "reply_to_user": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1489594273, "post_id": 42814493, "comment_id": 72742459, "body": "<code>totalRows = Sheet2.Cells(Sheet2.Rows.Count, startColumn).End(xlUp).Row</code>"}], "answers": [{"comments": [{"owner": {"reputation": 27, "user_id": 7716048, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/761dc9dbce6c83fb06c574c276096ce9?s=128&d=identicon&r=PG&f=1", "display_name": "Condav", "link": "https://stackoverflow.com/users/7716048/condav"}, "edited": false, "score": 0, "creation_date": 1489595288, "post_id": 42815407, "comment_id": 72743181, "body": "Thank you Ralph! I made the change and still get an error but it is on a later line: <code>Sheet4.Cells(currentRow, currentColumn).EntireRow.Copy Destination:=Worksheets(&quot;Sheet5&quot;).Range(&quot;A&quot; &amp; j)</code> it is a &quot;subscript out of range&quot; error"}, {"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "reply_to_user": {"reputation": 27, "user_id": 7716048, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/761dc9dbce6c83fb06c574c276096ce9?s=128&d=identicon&r=PG&f=1", "display_name": "Condav", "link": "https://stackoverflow.com/users/7716048/condav"}, "edited": false, "score": 0, "creation_date": 1489595544, "post_id": 42815407, "comment_id": 72743360, "body": "That&#39;s because <code>Sheet4</code> is also a <code>CodeName</code>. Change it as shown above or make sure that the sheet you want to refer to has this <code>CodeName</code>."}, {"owner": {"reputation": 27, "user_id": 7716048, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/761dc9dbce6c83fb06c574c276096ce9?s=128&d=identicon&r=PG&f=1", "display_name": "Condav", "link": "https://stackoverflow.com/users/7716048/condav"}, "edited": false, "score": 0, "creation_date": 1489595565, "post_id": 42815407, "comment_id": 72743389, "body": "Got it! I realized I had mixed my referencing and put &quot;Sheet5&quot; in quotes where it was named Sheet3 on the tab, so changed to &quot;Sheet3&quot; and it works! Thanks for your help."}], "tags": [], "owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "is_accepted": true, "score": 1, "last_activity_date": 1489594972, "creation_date": 1489594972, "answer_id": 42815407, "question_id": 42814493, "link": "https://stackoverflow.com/questions/42814493/macro-to-copy-a-row-with-an-empty-cell-in-any-of-the-last-5-columns-to-other-she/42815407#42815407", "title": "Macro to copy a row with an empty cell in any of the last 5 columns to other sheet", "body": "<p>The error you are getting indicates that there is not <code>Sheet</code> in your Excel file with the <code>CodeName</code> <code>Sheet2</code>. Have a look at the following illustration to see the distinction between the <code>Name</code> of a sheet (which you see in the tab) and the <code>CodeName</code>:</p>\n\n<p><a href=\"https://i.stack.imgur.com/UdGNI.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/UdGNI.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>If you wish to code with the <code>CodeName</code> then you must change it in the VBE as shown above. Alternatively you can also use the <code>Name</code> of the sheet. But then your line should read:</p>\n\n<pre><code>totalRows = ThisWorkbook.Worksheets(\"Sheet1\").Cells(ThisWorkbook.Worksheets(\"Sheet1\").Rows.Count, startColumn).End(xlUp).Row\n</code></pre>\n\n<p><sub>Because the name of the sheet in the above example is <code>Sheet1</code>.</sub></p>\n"}], "owner": {"reputation": 27, "user_id": 7716048, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/761dc9dbce6c83fb06c574c276096ce9?s=128&d=identicon&r=PG&f=1", "display_name": "Condav", "link": "https://stackoverflow.com/users/7716048/condav"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 63, "favorite_count": 0, "accepted_answer_id": 42815407, "answer_count": 1, "score": 1, "last_activity_date": 1489594972, "creation_date": 1489592629, "last_edit_date": 1531161705, "question_id": 42814493, "link": "https://stackoverflow.com/questions/42814493/macro-to-copy-a-row-with-an-empty-cell-in-any-of-the-last-5-columns-to-other-she", "title": "Macro to copy a row with an empty cell in any of the last 5 columns to other sheet", "body": "<p>As stated above, I'm trying to write a program that looks at the last 5 columns of every row in Sheet2 and copies that row if any of the cells in those last 5 columns are empty, then pastes the row into a new sheet Sheet3. I've been searching and found some helpful links but I keep getting an \"Object required\" error. I have a feeling I forgot something simple but I'm not getting anywhere. This is my 2nd day attempting macros, I appreciate any help!</p>\n\n<pre><code>Sub missingDataCopy()\n\n\nDim startColumn As Integer\nDim startRow As Integer\n\nDim totalRows As Integer\nDim totalColumns As Integer\n\nDim currentColumn As Integer\nDim currentRow As Integer\n\nDim shouldCopyRow As Boolean\n\nDim j As Long\n\nstartColumn = 7\ntotalColumns = 11\nstartRow = 1\nj = 1\ntotalRows = Sheet2.Cells(Rows.Count, startColumn).End(xlUp).Row\n\n\nFor currentRow = totalRows To startRow Step -1\n    shouldCopyRow = False\n\n\n    For currentColumn = startColumn To totalColumns\n        If IsEmpty(Sheet2.Cells(currentRow, currentColumn)) Then\n            shouldCopyRow = True\n            Exit For\n        End If\n    Next\n\n    If shouldCopyRow Then\n        Sheet2.Cells(currentRow, currentColumn).EntireRow.Copy Destination:=Worksheets(\"Sheet3\").Range(\"A\" &amp; j)\n        j = j + 1\n    End If\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "is_accepted": true, "score": 1, "last_activity_date": 1489592823, "creation_date": 1489592823, "answer_id": 42814576, "question_id": 42814321, "link": "https://stackoverflow.com/questions/42814321/how-do-i-paste-data-into-new-worksheets-and-delete-certain-rows-based-on-cell-f/42814576#42814576", "title": "How do I paste data into new worksheets, and delete certain rows based on cell from another table?", "body": "<p>Filter your master data on tab names and copy them over to the new sheet.</p>\n\n<p>Something like this will work. You might need to change your filter field based on your data.    </p>\n\n<pre><code>Sub Create_Tabs_And_Copy_Data()\n    Dim MyCell As Range, MyRange As Range\n\n    Set MyRange = Sheets(\"TabList\").Range(\"D2\")\n    Set MyRange = Range(MyRange, MyRange.End(xlDown))\n\n    For Each MyCell In MyRange\n        Sheets.Add After:=Sheets(Sheets.Count) 'creates a new worksheet\n        Sheets(Sheets.Count).Name = MyCell.Value ' renames the new worksheet\n        'I would like to create code here to paste the \"Master\" spreadsheet contents in the newly created worksheet and keep only rows corresponding Region IDs (delete the rest).\n         With Sheets(\"Master\").UsedRange\n            .AutoFilter\n            .AutoFilter Field:=1, Criteria1:=MyCell.Value\n            .SpecialCells(xlCellTypeVisible).Copy Sheets(MyCell.Value).Cells(1, 1)\n            Application.CutCopyMode = False\n        End With\n    Next MyCell\n    End Sub\n</code></pre>\n"}], "owner": {"reputation": 41, "user_id": 6245473, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/e0f7d28ad976a7c2df3f001a3de92dab?s=128&d=identicon&r=PG&f=1", "display_name": "HTMLHelpMe", "link": "https://stackoverflow.com/users/6245473/htmlhelpme"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 30, "favorite_count": 0, "accepted_answer_id": 42814576, "answer_count": 1, "score": 1, "last_activity_date": 1489592823, "creation_date": 1489592244, "question_id": 42814321, "link": "https://stackoverflow.com/questions/42814321/how-do-i-paste-data-into-new-worksheets-and-delete-certain-rows-based-on-cell-f", "title": "How do I paste data into new worksheets, and delete certain rows based on cell from another table?", "body": "<p>I have data in an Excel spreadsheet called \"Master\" of about 1,000 rows I am trying to split into 42 different spreadsheets based on an identifier called the Region ID.  I have created a table with the 42 unique different regions in another spreadsheet in the same workbook, along with what I want to name the new worksheets.  I have the following code so far, which creates the 42 new spreadsheets and names them accordingly.</p>\n\n<pre><code>Sub Create_Tabs()\nDim MyCell As Range, MyRange As Range\n\nSet MyRange = Sheets(\"TabList\").Range(\"D2\")\nSet MyRange = Range(MyRange, MyRange.End(xlDown))\n\nFor Each MyCell In MyRange\n    Sheets.Add After:=Sheets(Sheets.Count) 'creates a new worksheet\n    Sheets(Sheets.Count).Name = MyCell.Value ' renames the new worksheet\n    'I would like to create code here to paste the \"Master\" spreadsheet contents in the newly created worksheet and keep only rows corresponding Region IDs (delete the rest).\nNext MyCell\nEnd Sub\n</code></pre>\n\n<p>How do I paste the \"Master\" spreadsheet contents in the newly created worksheet and keep only rows corresponding Region IDs (delete the rest)?</p>\n"}, {"tags": ["vba", "excel", "powerpoint"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 7716026, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/452f7372f0a9e4f8e42beac17780f04a?s=128&d=identicon&r=PG&f=1", "display_name": "Stoffeltotof", "link": "https://stackoverflow.com/users/7716026/stoffeltotof"}, "edited": false, "score": 0, "creation_date": 1489652725, "post_id": 42815415, "comment_id": 72767458, "body": "I changed the code but no textbox is created. Set myPresentation = PowerPointApp.Presentations.Add Counter = ThisWorkbook.ActiveSheet.Range(&quot;A1&quot;).Value x = 3 For i = 1 To Counter Set mySlide = myPresentation.Slides.Add(i, 12) &#39;11 = ppLayoutBlank Set myPPT = ActivePresentation Set S = myPPT.Slides(1).Shapes.AddTextbox(Orientation:=msoTextOrient&zwnj;&#8203;ationHorizontal, Left:=20, Top:=240, Width:=850, Height:=50) S.TextFrame.TextRange.Text = &quot;Test&quot; S.Fill.BackColor.RGB = RGB(128, 0, 0) S.Line.DashStyle = msoLineSolid S.Line.BackColor.RGB = RGB(0, 128, 0)"}], "tags": [], "owner": {"reputation": 552, "user_id": 2381028, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/1855097c6c29ed8c62fc4c78bccd967e?s=128&d=identicon&r=PG", "display_name": "Shmukko", "link": "https://stackoverflow.com/users/2381028/shmukko"}, "is_accepted": false, "score": 0, "last_activity_date": 1489594999, "creation_date": 1489594999, "answer_id": 42815415, "question_id": 42814176, "link": "https://stackoverflow.com/questions/42814176/change-textbox-properties-via-vba-excel-code-to-powerpoint/42815415#42815415", "title": "change textbox properties via VBA Excel code to powerpoint", "body": "<p>You should create an object for every TextBox. After that you can edit the properties of it.</p>\n\n<pre><code>Dim x As Presentation\nSet x = ActivePresentation\n\nDim s As Shape\n\n'create object and save it to variable s\nSet s = x.Slides(1).Shapes.AddTextbox(Orientation:=msoTextOrientationHorizontal, Left:=20, Top:=240, Width:=850, Height:=50)\n\n'create background\ns.TextFrame.TextRange.Text = \"Test\"\ns.Fill.BackColor.RGB = RGB(128, 0, 0)\n\n'create border\ns.Line.DashStyle = msoLineSolid\ns.Line.BackColor.RGB = RGB(0, 128, 0)\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 7716026, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/452f7372f0a9e4f8e42beac17780f04a?s=128&d=identicon&r=PG&f=1", "display_name": "Stoffeltotof", "link": "https://stackoverflow.com/users/7716026/stoffeltotof"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 711, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1489661891, "creation_date": 1489591871, "last_edit_date": 1489661891, "question_id": 42814176, "link": "https://stackoverflow.com/questions/42814176/change-textbox-properties-via-vba-excel-code-to-powerpoint", "title": "change textbox properties via VBA Excel code to powerpoint", "body": "<p>I have some VBA code in Excel to copy some text to powerpoint. </p>\n\n<p>Copying works, but I would like to give a color to the textboxes (fill &amp; line). </p>\n\n<p>How can I do this?</p>\n\n<hr>\n\n<p>My code</p>\n\n<pre><code>Sub ExcelRangeToPowerPoint()\n\n\nDim PowerPointApp As Object\nDim myPresentation As Object\nDim mySlide As Object\nDim myShape As Object\nDim i, x, QuestionType, Counter As Integer\nDim oSld As Slide\nDim oShp As Shape\n'Dim Question, Answer1, Answer2, Answer3, Answer4 As Text\n\n\n'Create an Instance of PowerPoint\n  On Error Resume Next\n\n    'Is PowerPoint already opened?\n     Set PowerPointApp = GetObject(class:=\"PowerPoint.Application\")\n\n    'Clear the error between errors\n      Err.Clear\n\n    'If PowerPoint is not already open then open PowerPoint\n     If PowerPointApp Is Nothing Then Set PowerPointApp = CreateObject(class:=\"PowerPoint.Application\")\n\n    'Handle if the PowerPoint Application is not found\n      If Err.Number = 429 Then\n        MsgBox \"PowerPoint could not be found, aborting.\"\n        Exit Sub\n      End If\n\n  'On Error GoTo 0\n\n'Optimize Code\n  Application.ScreenUpdating = False\n\n'Create a New Presentation\n  Set myPresentation = PowerPointApp.Presentations.Add\n\n\n\n 'define nbr of questions\n  Counter = ThisWorkbook.ActiveSheet.Range(\"A1\").Value\n\n'define x to have the correct linenr\n    x = 3\n For i = 1 To Counter\n    'Add a slide to the Presentation\n    Set mySlide = myPresentation.Slides.Add(i, 12) '11 = ppLayoutBlank\n\n    World = ThisWorkbook.ActiveSheet.Range(\"B\" &amp; x).Value\n    Question = ThisWorkbook.ActiveSheet.Range(\"C\" &amp; x).Value\n    Answer1 = ThisWorkbook.ActiveSheet.Range(\"D\" &amp; x).Value\n    Answer2 = ThisWorkbook.ActiveSheet.Range(\"E\" &amp; x).Value\n    Answer3 = ThisWorkbook.ActiveSheet.Range(\"F\" &amp; x).Value\n    Answer4 = ThisWorkbook.ActiveSheet.Range(\"G\" &amp; x).Value\n    Feedback1 = ThisWorkbook.ActiveSheet.Range(\"L\" &amp; x).Value\n    Feedback2 = ThisWorkbook.ActiveSheet.Range(\"M\" &amp; x).Value\n    Feedback3 = ThisWorkbook.ActiveSheet.Range(\"N\" &amp; x).Value\n\n    mySlide.Shapes.AddTextbox(Orientation:=msoTextOrientationHorizontal, Left:=20, Top:=10, Width:=850, Height:=10).TextFrame.TextRange.Text = World\n    mySlide.Shapes.AddTextbox(Orientation:=msoTextOrientationHorizontal, Left:=20, Top:=50, Width:=850, Height:=50).TextFrame.TextRange.Text = Question\n    mySlide.Shapes.AddTextbox(Orientation:=msoTextOrientationHorizontal, Left:=20, Top:=100, Width:=850, Height:=50).TextFrame.TextRange.Text = Answer1\n    mySlide.Shapes.AddTextbox(Orientation:=msoTextOrientationHorizontal, Left:=20, Top:=170, Width:=850, Height:=50).TextFrame.TextRange.Text = Answer2\n    mySlide.Shapes.AddTextbox(Orientation:=msoTextOrientationHorizontal, Left:=20, Top:=240, Width:=850, Height:=50).TextFrame.TextRange.Text = Answer3\n    mySlide.Shapes.AddTextbox(Orientation:=msoTextOrientationHorizontal, Left:=20, Top:=310, Width:=850, Height:=50).TextFrame.TextRange.Text = Answer4\n    mySlide.Shapes.AddTextbox(Orientation:=msoTextOrientationHorizontal, Left:=50, Top:=400, Width:=200, Height:=50).TextFrame.TextRange.Text = Feedback1\n    mySlide.Shapes.AddTextbox(Orientation:=msoTextOrientationHorizontal, Left:=400, Top:=400, Width:=200, Height:=50).TextFrame.TextRange.Text = Feedback2\n    mySlide.Shapes.AddTextbox(Orientation:=msoTextOrientationHorizontal, Left:=750, Top:=400, Width:=200, Height:=50).TextFrame.TextRange.Text = Feedback3\n\n    x = x + 1\n\nNext i\n\n\n\n'Make PowerPoint Visible and Active\n  PowerPointApp.Visible = True\n  PowerPointApp.Activate\n\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["sql", "vba", "ms-access", "runtime-error", "sql-delete"], "comments": [{"owner": {"reputation": 1445, "user_id": 6065909, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/59936064c95a62d283737b9e18ad95ae?s=128&d=identicon&r=PG&f=1", "display_name": "marlan", "link": "https://stackoverflow.com/users/6065909/marlan"}, "edited": false, "score": 0, "creation_date": 1489592339, "post_id": 42814117, "comment_id": 72740880, "body": "Make sure the ODBC connection is not <i>Read only</i>. Also, why do you have an <i>Excel</i> tag, where is excel in the system?"}, {"owner": {"reputation": 1445, "user_id": 6065909, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/59936064c95a62d283737b9e18ad95ae?s=128&d=identicon&r=PG&f=1", "display_name": "marlan", "link": "https://stackoverflow.com/users/6065909/marlan"}, "edited": false, "score": 0, "creation_date": 1489592671, "post_id": 42814117, "comment_id": 72741165, "body": "An other option: when comparing strings, you&#39;d better make sure there are no white spaces. Use <a href=\"https://www.techonthenet.com/access/functions/string/trim.php\" rel=\"nofollow noreferrer\">Trim()</a>: <code>where Trim(tradename) =  &#39;300MM SODIUM CARBONATE&#39;</code>"}, {"owner": {"reputation": 1, "user_id": 7715974, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-UOPYcSCzfq8/AAAAAAAAAAI/AAAAAAAAFCE/6-pEx7D0Kb0/photo.jpg?sz=128", "display_name": "akash dable", "link": "https://stackoverflow.com/users/7715974/akash-dable"}, "reply_to_user": {"reputation": 1445, "user_id": 6065909, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/59936064c95a62d283737b9e18ad95ae?s=128&d=identicon&r=PG&f=1", "display_name": "marlan", "link": "https://stackoverflow.com/users/6065909/marlan"}, "edited": false, "score": 0, "creation_date": 1489592872, "post_id": 42814117, "comment_id": 72741340, "body": "Hey Thank you <code>@marlan</code>.  Can you please tell me how to check that &quot;ODBC connection is  Read only&quot;. But, I am able to insert the record into the table is it possible to insert a record when its &quot;Read only&quot; connection?"}, {"owner": {"reputation": 1540, "user_id": 7149748, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7517a3bbc9ae7afe5772ab3632edf5d?s=128&d=identicon&r=PG&f=1", "display_name": "Skippy", "link": "https://stackoverflow.com/users/7149748/skippy"}, "edited": false, "score": 0, "creation_date": 1489615701, "post_id": 42814117, "comment_id": 72754910, "body": "Confirm - can you manually delete the row in the table view from Access?"}, {"owner": {"reputation": 487, "user_id": 729474, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/a8e32e28c2361f6bf5465e39c0a68987?s=128&d=identicon&r=PG", "display_name": "missscripty", "link": "https://stackoverflow.com/users/729474/missscripty"}, "edited": false, "score": 0, "creation_date": 1612903233, "post_id": 42814117, "comment_id": 116910505, "body": "Did you ever find a solution to this? I&#39;m having the same issue, but with SQL. I can debug.print the sql string for the delete statement, and I can run it in SSMS, but when I attempt to run it from the access vba, I get this error. I have confirmed that my account has write rights, and I can use vba to add a record to the same table without error."}], "owner": {"reputation": 1, "user_id": 7715974, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-UOPYcSCzfq8/AAAAAAAAAAI/AAAAAAAAFCE/6-pEx7D0Kb0/photo.jpg?sz=128", "display_name": "akash dable", "link": "https://stackoverflow.com/users/7715974/akash-dable"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 799, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1489596219, "creation_date": 1489591741, "last_edit_date": 1489596219, "question_id": 42814117, "link": "https://stackoverflow.com/questions/42814117/run-time-error3086-could-not-delete-from-specified-table-in-ms-access-vba-code", "title": "Run time Error:3086 Could not delete from Specified table. in MS-Access vba code", "body": "<p>I am trying to delete specific rows using following code in MS-ACCESS. I have created a form using VBA and using this code</p>\n\n<pre><code>Dim dbs As Database\nDim MyDate\nMyDate = Date\nSet dbs = CurrentDb\n\nIf IsNull(Me.Text72.Value) Then\nMsgBox \"Values are Missing\"\nElse\n'dbs.Execute \"insert into scott_synonym_cidm (id,synonym_cidm,source,status,username,updatedate) values ( '\" &amp; Me.id.Value &amp; \"' ,'\" &amp; Me.syn_name.Value &amp; \"','\" &amp; Me.system.Value &amp; \"','YES','\" &amp; Me.Text72.Value &amp; \"','\" &amp; MyDate &amp; \"')\"\n'MsgBox \"Record Inserted \"\n\ndbs.Execute \"delete  from scott_unmatched where tradename =  '300MM SODIUM CARBONATE' \"\nMsgBox \"Record deleted \"\nEnd If\ndbs.Close\nSet dbs = Nothing\n</code></pre>\n\n<p>When I am running this the row is inserted in the table but gives error when delete statement is executed.</p>\n\n<p>The tables have connection from Oracle.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1489592205, "post_id": 42814107, "comment_id": 72740789, "body": "See here: <a href=\"http://stackoverflow.com/questions/20541905/convert-matrix-to-3-column-table-reverse-pivot-unpivot-flatten-normal\" title=\"convert matrix to 3 column table reverse pivot unpivot flatten normal\">stackoverflow.com/questions/20541905/&hellip;</a>  You will need to add a garbage column to the left of your data that you delete after ward."}, {"owner": {"reputation": 11381, "user_id": 2859347, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/00bC9.png?s=128&g=1", "display_name": "CallumDA", "link": "https://stackoverflow.com/users/2859347/callumda"}, "edited": false, "score": 0, "creation_date": 1489594074, "post_id": 42814107, "comment_id": 72742316, "body": "Do you really want to do this with VBA?"}], "answers": [{"tags": [], "owner": {"reputation": 128, "user_id": 7677928, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5334e48ef9f7115924b4b2cc695222ed?s=128&d=identicon&r=PG&f=1", "display_name": "Enrico", "link": "https://stackoverflow.com/users/7677928/enrico"}, "is_accepted": false, "score": 1, "last_activity_date": 1489592036, "creation_date": 1489592036, "answer_id": 42814242, "question_id": 42814107, "link": "https://stackoverflow.com/questions/42814107/how-to-rearrange-data-from-multiple-columns-to-one-column-in-excel/42814242#42814242", "title": "How to rearrange data from multiple columns to one column in excel", "body": "<p>1) copy row 1 and insert between 2 and 3, you will get:</p>\n\n<pre><code>2010 2011 2012 2013 2014 \n  A     B     G   H    J\n2010 2011 2012 2013 2014 \n  J     G     R   J    K\n</code></pre>\n\n<p>2) copy row 3 &amp; 4 and paste behind data in line 1/2, you will get:</p>\n\n<pre><code>2010 2011 2012 2013 2014  2010 2011 2012 2013 2014 \n  A     B     G   H    J    J    G    R    J    K\n</code></pre>\n\n<p>3) copy all data, paste with transponation and you will get what you want</p>\n"}, {"tags": [], "owner": {"reputation": 1826, "user_id": 6153990, "user_type": "registered", "profile_image": "https://graph.facebook.com/955879401185683/picture?type=large", "display_name": "Sangbok  Lee", "link": "https://stackoverflow.com/users/6153990/sangbok-lee"}, "is_accepted": false, "score": 0, "last_activity_date": 1489595923, "creation_date": 1489595923, "answer_id": 42815737, "question_id": 42814107, "link": "https://stackoverflow.com/questions/42814107/how-to-rearrange-data-from-multiple-columns-to-one-column-in-excel/42815737#42815737", "title": "How to rearrange data from multiple columns to one column in excel", "body": "<p>You can use <a href=\"https://www.google.com/search?q=excel+array+formula\" rel=\"nofollow noreferrer\">array formula</a>. When <code>a1:a3</code> is <code>2010, A, J</code>, let's put output at <code>g:h</code>. </p>\n\n<p>First, select <code>g1:g5</code> and hit <code>F2</code> and type <code>=TRANSPOSE(A1:E1)</code> and hit <code>ctrl + shift + enter</code>. Now <code>g1:g5</code> should be <code>2010, 2011, ..., 2014</code>.</p>\n\n<p>Select <code>g6:g10</code> and hit <code>F2</code> and type <code>=TRANSPOSE(A1:E1)</code> and hit <code>ctrl + shift + enter</code>. Now <code>g1:g5</code> should be <code>2010, 2011, ..., 2014</code>.</p>\n\n<p>select <code>h1:h5</code> and hit <code>F2</code> and type <code>=TRANSPOSE(A2:E2)</code> and hit <code>ctrl + shift + enter</code>. Now <code>h1:h5</code> should be <code>A, B, ..., J</code>.</p>\n\n<p>Select <code>h6:h10</code> and hit <code>F2</code> and type <code>=TRANSPOSE(A3:E3)</code> and hit <code>ctrl + shift + enter</code>. Now <code>g1:g5</code> should be <code>J, G, ..., K</code>.</p>\n\n<p><a href=\"https://i.stack.imgur.com/rBXT6.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/rBXT6.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 11, "user_id": 7716002, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b391f1a6291665128b0bbb74e04593d8?s=128&d=identicon&r=PG&f=1", "display_name": "Clark", "link": "https://stackoverflow.com/users/7716002/clark"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 87, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1489595923, "creation_date": 1489591720, "last_edit_date": 1489591767, "question_id": 42814107, "link": "https://stackoverflow.com/questions/42814107/how-to-rearrange-data-from-multiple-columns-to-one-column-in-excel", "title": "How to rearrange data from multiple columns to one column in excel", "body": "<p>My data looks like this </p>\n\n<pre><code>2010 2011 2012 2013 2014 \nA     B     G   H    J\nJ     G     R   J    K\n</code></pre>\n\n<p>I want it to look like this </p>\n\n<pre><code>2010  A\n2011  B\n2012  G\n2013  H\n2014  J\n2010  J\n2011  G\n2012  R\n2013  J \n2014  K\n</code></pre>\n"}, {"tags": ["vba", "outlook"], "comments": [{"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1489597283, "post_id": 42814083, "comment_id": 72744463, "body": "Can show us your current code?"}], "answers": [{"tags": [], "owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "is_accepted": false, "score": 0, "last_activity_date": 1489608005, "creation_date": 1489608005, "answer_id": 42819574, "question_id": 42814083, "link": "https://stackoverflow.com/questions/42814083/getting-highlighted-text-from-subject-in-activeexplorer-window/42819574#42819574", "title": "Getting highlighted text from subject in ActiveExplorer window", "body": "<p>The only way to do that is find the HWND of the subject edit box (it is RichEdit20W control) and send the EM_GETSELTEXT message. </p>\n"}], "owner": {"reputation": 356, "user_id": 6834551, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/576a6f5a5155d448f650296fb4b4e749?s=128&d=identicon&r=PG&f=1", "display_name": "finjo", "link": "https://stackoverflow.com/users/6834551/finjo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 77, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1593307564, "creation_date": 1489591673, "last_edit_date": 1593307564, "question_id": 42814083, "link": "https://stackoverflow.com/questions/42814083/getting-highlighted-text-from-subject-in-activeexplorer-window", "title": "Getting highlighted text from subject in ActiveExplorer window", "body": "<p>I have a macro which currently copies text highlighted within the message body, but I now want to achieve the same thing when the subject title from the Explorer window is highlighted.</p>\n\n<p>I'm not sure this is going to be possible, because what I'm looking for is essentially the Explorer equivalent of <code>Item.GetInspector.WordEditor.Application.Selection.Text</code>, and this obviously wouldn't be an option as subject titles cannot be edited in the same way as the message body.</p>\n\n<p>Are there any workarounds for this?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 524, "user_id": 7648526, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b54db50ad2bfd167b85f1686dd47b28d?s=128&d=identicon&r=PG&f=1", "display_name": "SteveES", "link": "https://stackoverflow.com/users/7648526/stevees"}, "edited": false, "score": 0, "creation_date": 1489591613, "post_id": 42814002, "comment_id": 72740313, "body": "What is the error?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1489591719, "post_id": 42814002, "comment_id": 72740395, "body": "Can you just Find &amp; Replace any hyphens with &quot;&quot;?"}], "answers": [{"tags": [], "owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "is_accepted": false, "score": 3, "last_activity_date": 1489591743, "creation_date": 1489591743, "answer_id": 42814119, "question_id": 42814002, "link": "https://stackoverflow.com/questions/42814002/vba-change-negative-range-to-positive/42814119#42814119", "title": "VBA change negative range to positive", "body": "<p>Try this:</p>\n\n<pre><code>rowStart = 10\nrowEnd = 20\nFor Each myCell In Range(\"K\" &amp; rowStart &amp; \":K\" &amp; rowEnd)\n    myCell.Value = Abs(myCell.Value)\nNext\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 52630, "user_id": 641067, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/n6xVq.png?s=128&g=1", "display_name": "brettdj", "link": "https://stackoverflow.com/users/641067/brettdj"}, "edited": false, "score": 0, "creation_date": 1489641185, "post_id": 42814124, "comment_id": 72762402, "body": "Nice <code>Evaluate</code>."}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": false, "score": 6, "last_activity_date": 1489592611, "last_edit_date": 1489592611, "creation_date": 1489591750, "answer_id": 42814124, "question_id": 42814002, "link": "https://stackoverflow.com/questions/42814002/vba-change-negative-range-to-positive/42814124#42814124", "title": "VBA change negative range to positive", "body": "<p>You can't do it in whole that way.</p>\n\n<p>Either Loop:</p>\n\n<pre><code>For i = rowStart to rowEnd\n    ActiveSheet.Range(\"K\" &amp; i).Value = Abs(ActiveSheet.Range(\"K\" &amp; i).Value)\nNext i\n</code></pre>\n\n<p>Or you can set it using Evaluate:</p>\n\n<pre><code>ActiveSheet.Range(\"K\" &amp; rowStart &amp; \":K\" &amp; rowEnd).Value = Evaluate(\"INDEX(ABS(\" &amp; Range(\"K\" &amp; rowStart &amp; \":K\" &amp; rowEnd).Address &amp; \"),)\")\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": true, "score": 4, "last_activity_date": 1489591758, "creation_date": 1489591758, "answer_id": 42814129, "question_id": 42814002, "link": "https://stackoverflow.com/questions/42814002/vba-change-negative-range-to-positive/42814129#42814129", "title": "VBA change negative range to positive", "body": "<p>You must <strong>loop over the items</strong>:</p>\n\n<pre><code>Sub ksdjfh()\n    Dim r As Range\n\n    rowStart = 10\n    rowEnd = 20\n\n    For Each r In Range(\"K\" &amp; rowStart &amp; \":K\" &amp; rowEnd)\n        r.Value = Abs(r.Value)\n    Next r\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 3, "last_activity_date": 1489592016, "creation_date": 1489592016, "answer_id": 42814236, "question_id": 42814002, "link": "https://stackoverflow.com/questions/42814002/vba-change-negative-range-to-positive/42814236#42814236", "title": "VBA change negative range to positive", "body": "<p>Does your number format allow for simply removing the negative signs (i.e. <em>hyphens</em>)?</p>\n\n<pre><code>Dim rowStart As Long, rowEnd As Long\nrowStart = 10\nrowEnd = 20\nWith ActiveSheet\n    .Range(\"K\" &amp; rowStart &amp; \":K\" &amp; rowEnd).Replace What:=\"-\", Replacement:=\"\", LookAt:=xlPart\nEnd With\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "is_accepted": false, "score": 1, "last_activity_date": 1489592772, "creation_date": 1489592772, "answer_id": 42814554, "question_id": 42814002, "link": "https://stackoverflow.com/questions/42814002/vba-change-negative-range-to-positive/42814554#42814554", "title": "VBA change negative range to positive", "body": "<p>Place in an array and loop over the items (might be faster than updating the range if it's a big range):</p>\n\n<pre><code>Sub Test()\n\n    Dim rowStart As Long, rowEnd As Long\n    Dim rRange As Range\n    Dim vRange() As Variant\n    Dim vItem As Variant\n    Dim R As Long\n\n    rowStart = 10\n    rowEnd = 20\n\n    With Sheet1\n        'Define the range.\n        Set rRange = .Range(.Cells(rowStart, 1), .Cells(rowEnd, 1))\n    End With\n    vRange = rRange\n\n    'Loop through the values - consider R to mean Row.\n    For R = 1 To UBound(vRange, 1)\n        vRange(R, 1) = Abs(vRange(R, 1))\n    Next R\n\n    rRange.Value = vRange\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1945, "user_id": 2148939, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/65a4495f8cf59bfe786fe5b75598ff13?s=128&d=identicon&r=PG", "display_name": "Selrac", "link": "https://stackoverflow.com/users/2148939/selrac"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5274, "favorite_count": 0, "accepted_answer_id": 42814129, "answer_count": 5, "score": 1, "last_activity_date": 1489592772, "creation_date": 1489591486, "last_edit_date": 1489591866, "question_id": 42814002, "link": "https://stackoverflow.com/questions/42814002/vba-change-negative-range-to-positive", "title": "VBA change negative range to positive", "body": "<p>I'm trying to change the negative values to positive based on a dynamic range. By dynamic I mean that the row number might change. </p>\n\n<p>For example</p>\n\n<pre><code>rowStart = 10\nrowEnd   = 20\n</code></pre>\n\n<p>From these I need to change the values in this range to positive. I'm trying the following but I'm getting an error:</p>\n\n<pre><code>Range(\"K\" &amp; rowStart &amp; \":K\" &amp; rowEnd).Value = _\n    Abs(Range(\"K\" &amp; rowStart &amp; \":K\" &amp; rowEnd).Value)\n</code></pre>\n\n<p>The error I get is: Run-time error '13': Type mismatch</p>\n\n<p>Any ideas on how to make this work?</p>\n"}, {"tags": ["excel", "vba", "outlook"], "answers": [{"comments": [{"owner": {"reputation": 101, "user_id": 7715829, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba4d3d1f5aec40652f88b4c184fa3694?s=128&d=identicon&r=PG&f=1", "display_name": "Tonks", "link": "https://stackoverflow.com/users/7715829/tonks"}, "edited": false, "score": 0, "creation_date": 1489763069, "post_id": 42845474, "comment_id": 72827871, "body": "This is fantastic, thank you! However I&#39;m now having a problem getting the info to actually copy.  If I put the name of the mailbox at line 2 and run it, it runs fine but no info appears in the spreadsheet.  I tried changing it to the name of the calendar just in case, and as expected it doesn&#39;t recognise it.  There are multiple shared calendars all in the same mailbox; I know I can repeat the Export sub for each calendar, I&#39;m just not sure how to get it to recognise the calendar or why it isn&#39;t recognising it already?  Thank you for helping a rookie out!"}, {"owner": {"reputation": 101, "user_id": 7715829, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba4d3d1f5aec40652f88b4c184fa3694?s=128&d=identicon&r=PG&f=1", "display_name": "Tonks", "link": "https://stackoverflow.com/users/7715829/tonks"}, "edited": false, "score": 0, "creation_date": 1489766064, "post_id": 42845474, "comment_id": 72830002, "body": "I&#39;ve tried every combination I can think of - surely I should be able to give RunExportCalendarToExcel the name of the calendar and it should be able to follow the path? Do I need to put in the mailbox location somewhere?"}, {"owner": {"reputation": 5418, "user_id": 519226, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/dSD4J.jpg?s=128&g=1", "display_name": "Eric Legault", "link": "https://stackoverflow.com/users/519226/eric-legault"}, "reply_to_user": {"reputation": 101, "user_id": 7715829, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba4d3d1f5aec40652f88b4c184fa3694?s=128&d=identicon&r=PG&f=1", "display_name": "Tonks", "link": "https://stackoverflow.com/users/7715829/tonks"}, "edited": false, "score": 0, "creation_date": 1489773178, "post_id": 42845474, "comment_id": 72834403, "body": "It&#39;s hard to tell where it&#39;s failing because you have no error handling setup. Add On Error GoTo EH: at the beginning of ExportCalendarToExcel, and add the EH: label to the end of the procedure, with Debug.Print err..Number (or err.Description). You have to use a Recipient object in order to use GetSharedDefaultFolder, so perhaps olkRecipient is Nothing because it couldn&#39;t resolve due to an invalid name or whatever."}, {"owner": {"reputation": 101, "user_id": 7715829, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba4d3d1f5aec40652f88b4c184fa3694?s=128&d=identicon&r=PG&f=1", "display_name": "Tonks", "link": "https://stackoverflow.com/users/7715829/tonks"}, "edited": false, "score": 0, "creation_date": 1490091743, "post_id": 42845474, "comment_id": 72945946, "body": "The error code I got back was 430 - an automation problem? One of the main issues I&#39;m having getting info from it is that, as I&#39;m working in Excel 2003 and the code is set up to open the spreadsheet again, its opening up two copies. As such the only way I can get the macro to run is if I make it a shared workbook - but then I can&#39;t edit the macro/see the immediate window while it runs. If I try and run it without making it shared I get error 1004 warning me that it&#39;s read only."}, {"owner": {"reputation": 5418, "user_id": 519226, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/dSD4J.jpg?s=128&g=1", "display_name": "Eric Legault", "link": "https://stackoverflow.com/users/519226/eric-legault"}, "reply_to_user": {"reputation": 101, "user_id": 7715829, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba4d3d1f5aec40652f88b4c184fa3694?s=128&d=identicon&r=PG&f=1", "display_name": "Tonks", "link": "https://stackoverflow.com/users/7715829/tonks"}, "edited": false, "score": 0, "creation_date": 1490106018, "post_id": 42845474, "comment_id": 72956845, "body": "Hold down the Shift key when you start Excel to bypass any macros running at startup"}, {"owner": {"reputation": 101, "user_id": 7715829, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba4d3d1f5aec40652f88b4c184fa3694?s=128&d=identicon&r=PG&f=1", "display_name": "Tonks", "link": "https://stackoverflow.com/users/7715829/tonks"}, "edited": false, "score": 0, "creation_date": 1490171208, "post_id": 42845474, "comment_id": 72988208, "body": "Thank you, I have a new error code: Error number:  438 Source: VBAProject Description: Object doesn&#39;t support this property or method I think you might be right, that its an issue with olkRecipient?"}, {"owner": {"reputation": 5418, "user_id": 519226, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/dSD4J.jpg?s=128&g=1", "display_name": "Eric Legault", "link": "https://stackoverflow.com/users/519226/eric-legault"}, "reply_to_user": {"reputation": 101, "user_id": 7715829, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba4d3d1f5aec40652f88b4c184fa3694?s=128&d=identicon&r=PG&f=1", "display_name": "Tonks", "link": "https://stackoverflow.com/users/7715829/tonks"}, "edited": false, "score": 0, "creation_date": 1490196532, "post_id": 42845474, "comment_id": 73006758, "body": "On what line? What property or method?"}], "tags": [], "owner": {"reputation": 5418, "user_id": 519226, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/dSD4J.jpg?s=128&g=1", "display_name": "Eric Legault", "link": "https://stackoverflow.com/users/519226/eric-legault"}, "is_accepted": false, "score": 0, "last_activity_date": 1489701282, "creation_date": 1489701282, "answer_id": 42845474, "question_id": 42813713, "link": "https://stackoverflow.com/questions/42813713/code-to-send-outlook-2003-shared-calendar-information-to-excel-spreadsheet/42845474#42845474", "title": "Code to send Outlook 2003 shared calendar information to Excel spreadsheet", "body": "<p>The 2003 Outlook Object Model uses MAPIFolder as the object name, not Folder - which was introduced in later versions (which are backwards compatible with usages of MAPIFolder).</p>\n"}], "owner": {"reputation": 101, "user_id": 7715829, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba4d3d1f5aec40652f88b4c184fa3694?s=128&d=identicon&r=PG&f=1", "display_name": "Tonks", "link": "https://stackoverflow.com/users/7715829/tonks"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 121, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1593325249, "creation_date": 1489590715, "last_edit_date": 1593325249, "question_id": 42813713, "link": "https://stackoverflow.com/questions/42813713/code-to-send-outlook-2003-shared-calendar-information-to-excel-spreadsheet", "title": "Code to send Outlook 2003 shared calendar information to Excel spreadsheet", "body": "<p>I've been trying to cobble together some code to send all the information in our calendar to an Excel file. I work on a multi-site shared network and the calendars are shared generally with everyone that needs access to them from a shared company mailbox.</p>\n\n<p>I have found guides on how to do this from local calendars and from calendars shared between two people, but I'm struggling to get it to work on our system.</p>\n\n<p>Here is the code I am using:</p>\n\n<pre><code> Sub RunExportCalendarsToExcel()\n    'Change the name of the conference room on the next line.  The name must match the name of the mailbox.'\n    ExportCalendarToExcel \"County, Family\", True\nEnd Sub\n\nSub ExportCalendarToExcel(strCalendarName As String, Optional bolClearWorksheet As Boolean)\n    Dim olkFolder As Outlook.Folder, olkItems As Outlook.Items, olkAppt As Outlook.AppointmentItem, olkRecipient As Outlook.Recipient\n    Dim excApp As Object, excWkb As Object, excSht As Object, excRng As Object, lngRow As Long\n    Dim arrTitle As Variant\n\n    'Launch Excel and open the spreadsheet'\n    Set excApp = CreateObject(\"Excel.Application\")\n    excApp.Visible = True\n    'Change the name and path of the spreadsheet on the next line'\n    Set excWkb = excApp.Workbooks.Open(\"\\\\dom1\\data\\County\\Wolverhampton\\Home\\[my username]\\List.xls\")\n    Set excSht = excWkb.Worksheets(1)\n    If bolClearWorksheet Then\n        Set excRng = excSht.Range(\"A1\").CurrentRegion\n        lngRow = excRng.Rows.Count\n        excApp.Rows(2 &amp; \":\" &amp; lngRow).Delete\n        lngRow = 2\n    Else\n        lngRow = excSht.UsedRange.Rows.Count + 1\n    End If\n\n   'Connect to and process the shared calendar'\n    Set olkRecipient = Session.CreateRecipient(strCalendarName)\n    Set olkFolder = Session.GetSharedDefaultFolder(olkRecipient, olFolderCalendar)\n    datDate = InputBox(\"Enter the date you want to export for.\", \"Export Calendars to Excel\", Date)\n    Set olkItems = olkFolder.Items.Restrict(\"[Start] &gt;= '\" &amp; Format(datDate &amp; \" 0:01am\", \"ddddd h:nn AMPM\") &amp; \"' AND [Start] &lt; '\" &amp; Format(datDate &amp; \" 11:59pm\", \"ddddd h:nn AMPM\") &amp; \"'\")\n    olkItems.Sort \"[Start]\"\n    olkItems.IncludeRecurrences = True\n    For Each olkAppt In olkItems\n        arrTitle = Split(olkAppt.Subject, \"-\")\n        excSht.Cells(lngRow, 1) = olkAppt.Start\n        excSht.Cells(lngRow, 2) = olkAppt.End\n        excSht.Cells(lngRow, 3) = strCalendarName\n        excSht.Cells(lngRow, 4) = olkAppt.Organizer\n        excSht.Cells(lngRow, 5) = olkAppt.Body\n        lngRow = lngRow + 1\n    Next\n\n    'Save the spreadsheet and exit Excel'\n    Set excRng = Nothing\n    Set excSht = Nothing\n    excWkb.Save\n    Set excWkb = Nothing\n    excApp.Quit\n    Set excApp = Nothing\n\n    'Clean-up the Outlook objects'\n    Set olkFolder = Nothing\n    Set olkItems = Nothing\n    Set olkAppt = Nothing\nEnd Sub\n</code></pre>\n\n<p>There are three calendars with appointments scheduled at different times throughout the day between 9AM and 5PM.</p>\n\n<p>No matter what I do, I keep getting the error 'User-defined type not defined' at this line, with 'Dim olkFolder as Outlook.Folder' highlighted as if it is selected:</p>\n\n<pre><code>Sub ExportCalendarToExcel(strCalendarName As String, Optional bolClearWorksheet As Boolean)\nDim olkFolder As Outlook.Folder, olkItems As Outlook.Items, olkAppt As Outlook.AppointmentItem, olkRecipient As Outlook.Recipient\n</code></pre>\n\n<p>I've only been writing in VBA for a few months, so please let me know if there is any other information you need that I haven't given.</p>\n"}, {"tags": ["vba", "excel", "runtime-error", "copy-paste"], "answers": [{"comments": [{"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 0, "creation_date": 1489590459, "post_id": 42813129, "comment_id": 72739312, "body": "You should use <code>Long</code> or <code>Double</code> instead of <code>Integer</code> for <code>LR</code>, because <code>Integer</code> is limited to 32k (and a little something more), but try <code>LR = 33000</code> and you&#39;ll have an error due to <code>Integer</code> ;)"}, {"owner": {"reputation": 1334, "user_id": 7579539, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XY7eB.png?s=128&g=1", "display_name": "Pspl", "link": "https://stackoverflow.com/users/7579539/pspl"}, "reply_to_user": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 1, "creation_date": 1489590749, "post_id": 42813129, "comment_id": 72739563, "body": "Yes, I know... However didn&#39;t think of that... Usually I only remember that tiny detail when I&#39;m working with big excel tables and the code generates an error... And then... &quot;Oh s****! Forgot the long thing again!!!&quot; Eh eh... Thanks for the reminder... :)"}], "tags": [], "owner": {"reputation": 1334, "user_id": 7579539, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XY7eB.png?s=128&g=1", "display_name": "Pspl", "link": "https://stackoverflow.com/users/7579539/pspl"}, "is_accepted": false, "score": 0, "last_activity_date": 1489590772, "last_edit_date": 1489590772, "creation_date": 1489589345, "answer_id": 42813129, "question_id": 42812924, "link": "https://stackoverflow.com/questions/42812924/copy-and-paste-using-last-row-error-91/42813129#42813129", "title": "Copy and paste using last row, Error 91", "body": "<p>There's some code you have... You need to work more on your skills... Try the following:</p>\n\n<pre><code>Sub update()\n\n    Dim LR As Long\n    Dim Revise As Range\n    LR = Cells(Rows.Count, \"M\").End(xlUp).Row\n    Set Revise = Range(\"M1:M\" &amp; LR)\n    Revise.Copy\n    Sheets(\"Weekly\").Cells(1, 1).PasteSpecial xlPasteAll\n\nEnd sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 137, "user_id": 6604863, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8ZCQ3.jpg?s=128&g=1", "display_name": "Reisenrich", "link": "https://stackoverflow.com/users/6604863/reisenrich"}, "edited": false, "score": 0, "creation_date": 1489590698, "post_id": 42813314, "comment_id": 72739510, "body": "I am now getting a runtime error &quot;out of range&quot; I switched the sub up to copy from column &quot;I&quot; to column &quot;M&quot; And I am now getting the out of range error. Why am I getting this error?"}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "reply_to_user": {"reputation": 137, "user_id": 6604863, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8ZCQ3.jpg?s=128&g=1", "display_name": "Reisenrich", "link": "https://stackoverflow.com/users/6604863/reisenrich"}, "edited": false, "score": 0, "creation_date": 1489590806, "post_id": 42813314, "comment_id": 72739602, "body": "@Reisenrich : Glad I could help! ;)"}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "reply_to_user": {"reputation": 137, "user_id": 6604863, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8ZCQ3.jpg?s=128&g=1", "display_name": "Reisenrich", "link": "https://stackoverflow.com/users/6604863/reisenrich"}, "edited": false, "score": 0, "creation_date": 1489591179, "post_id": 42813314, "comment_id": 72739917, "body": "@Reisenrich : How about accepting my answer then? :)"}, {"owner": {"reputation": 137, "user_id": 6604863, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8ZCQ3.jpg?s=128&g=1", "display_name": "Reisenrich", "link": "https://stackoverflow.com/users/6604863/reisenrich"}, "edited": false, "score": 0, "creation_date": 1489591364, "post_id": 42813314, "comment_id": 72740084, "body": "Sorry, got lost in updating my spread sheet (: Still having an issue with the &quot;out of Range&quot; error. When debuging it appears to have issue with the paste command"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 137, "user_id": 6604863, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8ZCQ3.jpg?s=128&g=1", "display_name": "Reisenrich", "link": "https://stackoverflow.com/users/6604863/reisenrich"}, "edited": false, "score": 0, "creation_date": 1489591432, "post_id": 42813314, "comment_id": 72740146, "body": "@Reisenrich verify that your sheet names don&#39;t have leading/trailing spaces. &quot;Out of range&quot; is very likely to be because there is no sheet named &quot;Weekly&quot; in <code>ThisWorkbook</code>."}, {"owner": {"reputation": 137, "user_id": 6604863, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8ZCQ3.jpg?s=128&g=1", "display_name": "Reisenrich", "link": "https://stackoverflow.com/users/6604863/reisenrich"}, "edited": false, "score": 0, "creation_date": 1489591520, "post_id": 42813314, "comment_id": 72740228, "body": "You sir are a WIZARD. Thank you!"}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1489592020, "post_id": 42813314, "comment_id": 72740639, "body": "@Mat&#39;sMug : Yes, you are! ;) Thx for answering the OP! BTW, may I have your opinion on this : <a href=\"http://codereview.stackexchange.com/q/157336/71125\">codereview.stackexchange.com/q/157336/71125</a>    0:)"}], "tags": [], "owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "is_accepted": true, "score": 2, "last_activity_date": 1489590365, "last_edit_date": 1489590365, "creation_date": 1489589740, "answer_id": 42813314, "question_id": 42812924, "link": "https://stackoverflow.com/questions/42812924/copy-and-paste-using-last-row-error-91/42813314#42813314", "title": "Copy and paste using last row, Error 91", "body": "<p>Your issue is that :</p>\n\n<ul>\n<li>you defined <code>LR</code> as <code>Range</code> which is an object</li>\n<li>you are trying to assign a value to it, without using <code>Set</code> keyword (like for <code>Set Revise</code>)</li>\n<li>If you add <code>Set</code>, you'd have an Error 13 because you are trying to put a number into a Range! ;)</li>\n</ul>\n\n<p>Corrected code :</p>\n\n<pre><code>Sub update()\n    Dim LR As Double\n    Dim SrcWS As Worksheet\n    Set SrcWS = ThisWorkbook.Sheets(\"Sheet1\")\n\n    With SrcWS\n        LR = .Cells(.Rows.Count, \"M\").End(xlUp).Row\n        .Range(\"M1:M\" &amp; LR).Copy\n    End With 'SrcWS \n\n    ThisWorkbook.Sheets(\"Weekly\").Cells(1,1).PasteSpecial xlPasteAll\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 137, "user_id": 6604863, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8ZCQ3.jpg?s=128&g=1", "display_name": "Reisenrich", "link": "https://stackoverflow.com/users/6604863/reisenrich"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 394, "favorite_count": 0, "accepted_answer_id": 42813314, "answer_count": 2, "score": 2, "last_activity_date": 1489590772, "creation_date": 1489588903, "last_edit_date": 1489589558, "question_id": 42812924, "link": "https://stackoverflow.com/questions/42812924/copy-and-paste-using-last-row-error-91", "title": "Copy and paste using last row, Error 91", "body": "<p>I am trying to copy and paste a range of values based on the last row in the range, meaning that the number of rows will vary but the number of columns will all ways stay the same. </p>\n\n<p>The code I have written to do this continues to return the error : </p>\n\n<blockquote>\n  <p>Object Variable or With Block Variable not set</p>\n</blockquote>\n\n<p>What does this error mean and how do I fix it?</p>\n\n<pre><code>Sub update()\n\nDim LR As Range\nDim Revise As Range\n\nLR = Cells(Rows.Count, \"M\").End(xlUp).Row\n\nSet Revise = Range(\"M1:M\" &amp; LR)\n\nRevise.Copy\n\nSheets(Weekly).Select\nCells(1,1).PasteSpecial xlPasteAll\n\n\nEnd Sub\n</code></pre>\n\n<hr>\n"}, {"tags": ["ms-access", "vba"], "answers": [{"comments": [{"owner": {"reputation": 170, "user_id": 7495443, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/45cc211ede863e4dd862d03c9512d737?s=128&d=identicon&r=PG&f=1", "display_name": "Jul Pod", "link": "https://stackoverflow.com/users/7495443/jul-pod"}, "edited": false, "score": 0, "creation_date": 1489589812, "post_id": 42812787, "comment_id": 72738790, "body": "sorry this does not work for me, i want to display the touch keyboard when i click on a text field in access"}, {"owner": {"reputation": 1525, "user_id": 3636806, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/f5aee89c11a5184ae26918f1969a439d?s=128&d=identicon&r=PG", "display_name": "EAK TEAM", "link": "https://stackoverflow.com/users/3636806/eak-team"}, "reply_to_user": {"reputation": 170, "user_id": 7495443, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/45cc211ede863e4dd862d03c9512d737?s=128&d=identicon&r=PG&f=1", "display_name": "Jul Pod", "link": "https://stackoverflow.com/users/7495443/jul-pod"}, "edited": false, "score": 0, "creation_date": 1489589856, "post_id": 42812787, "comment_id": 72738824, "body": "This works , for all the text fields. Did you try it ?"}, {"owner": {"reputation": 1525, "user_id": 3636806, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/f5aee89c11a5184ae26918f1969a439d?s=128&d=identicon&r=PG", "display_name": "EAK TEAM", "link": "https://stackoverflow.com/users/3636806/eak-team"}, "reply_to_user": {"reputation": 170, "user_id": 7495443, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/45cc211ede863e4dd862d03c9512d737?s=128&d=identicon&r=PG&f=1", "display_name": "Jul Pod", "link": "https://stackoverflow.com/users/7495443/jul-pod"}, "edited": false, "score": 0, "creation_date": 1489589968, "post_id": 42812787, "comment_id": 72738911, "body": "Anyway , what version of Windows do you have installed ?"}, {"owner": {"reputation": 170, "user_id": 7495443, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/45cc211ede863e4dd862d03c9512d737?s=128&d=identicon&r=PG&f=1", "display_name": "Jul Pod", "link": "https://stackoverflow.com/users/7495443/jul-pod"}, "edited": false, "score": 0, "creation_date": 1489590110, "post_id": 42812787, "comment_id": 72739035, "body": "i try, did the same steps as above, win version : Microsoft Windows 10 Pro, 10.0.14393 Build 14393"}, {"owner": {"reputation": 1525, "user_id": 3636806, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/f5aee89c11a5184ae26918f1969a439d?s=128&d=identicon&r=PG", "display_name": "EAK TEAM", "link": "https://stackoverflow.com/users/3636806/eak-team"}, "reply_to_user": {"reputation": 170, "user_id": 7495443, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/45cc211ede863e4dd862d03c9512d737?s=128&d=identicon&r=PG&f=1", "display_name": "Jul Pod", "link": "https://stackoverflow.com/users/7495443/jul-pod"}, "edited": false, "score": 0, "creation_date": 1489590556, "post_id": 42812787, "comment_id": 72739393, "body": "you have anoher example for vba in access in the top of answer"}, {"owner": {"reputation": 170, "user_id": 7495443, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/45cc211ede863e4dd862d03c9512d737?s=128&d=identicon&r=PG&f=1", "display_name": "Jul Pod", "link": "https://stackoverflow.com/users/7495443/jul-pod"}, "edited": false, "score": 0, "creation_date": 1489590593, "post_id": 42812787, "comment_id": 72739414, "body": "hm strange, this option is not listet in my settings, i look again after the update finished. thanks sir."}, {"owner": {"reputation": 170, "user_id": 7495443, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/45cc211ede863e4dd862d03c9512d737?s=128&d=identicon&r=PG&f=1", "display_name": "Jul Pod", "link": "https://stackoverflow.com/users/7495443/jul-pod"}, "edited": false, "score": 0, "creation_date": 1489590629, "post_id": 42812787, "comment_id": 72739443, "body": "i dont mean osk.exe, its not the same as the one in my screenshot"}, {"owner": {"reputation": 1525, "user_id": 3636806, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/f5aee89c11a5184ae26918f1969a439d?s=128&d=identicon&r=PG", "display_name": "EAK TEAM", "link": "https://stackoverflow.com/users/3636806/eak-team"}, "reply_to_user": {"reputation": 170, "user_id": 7495443, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/45cc211ede863e4dd862d03c9512d737?s=128&d=identicon&r=PG&f=1", "display_name": "Jul Pod", "link": "https://stackoverflow.com/users/7495443/jul-pod"}, "edited": false, "score": 0, "creation_date": 1489590880, "post_id": 42812787, "comment_id": 72739657, "body": "i understand .... but it&#39;s no other ways as i know ... Try the windows 10 option , if you find it helpfull or it solve your question please upvote or mark as answer"}, {"owner": {"reputation": 170, "user_id": 7495443, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/45cc211ede863e4dd862d03c9512d737?s=128&d=identicon&r=PG&f=1", "display_name": "Jul Pod", "link": "https://stackoverflow.com/users/7495443/jul-pod"}, "edited": false, "score": 1, "creation_date": 1489590961, "post_id": 42812787, "comment_id": 72739725, "body": "i also find nothing on the net, but thats the reason why i ask here :D"}, {"owner": {"reputation": 1525, "user_id": 3636806, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/f5aee89c11a5184ae26918f1969a439d?s=128&d=identicon&r=PG", "display_name": "EAK TEAM", "link": "https://stackoverflow.com/users/3636806/eak-team"}, "reply_to_user": {"reputation": 170, "user_id": 7495443, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/45cc211ede863e4dd862d03c9512d737?s=128&d=identicon&r=PG&f=1", "display_name": "Jul Pod", "link": "https://stackoverflow.com/users/7495443/jul-pod"}, "edited": false, "score": 0, "creation_date": 1489591037, "post_id": 42812787, "comment_id": 72739783, "body": "i see ... :D :D"}], "tags": [], "owner": {"reputation": 1525, "user_id": 3636806, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/f5aee89c11a5184ae26918f1969a439d?s=128&d=identicon&r=PG", "display_name": "EAK TEAM", "link": "https://stackoverflow.com/users/3636806/eak-team"}, "is_accepted": true, "score": 0, "last_activity_date": 1489590529, "last_edit_date": 1489590529, "creation_date": 1489588532, "answer_id": 42812787, "question_id": 42812738, "link": "https://stackoverflow.com/questions/42812738/automatically-show-touch-keyboard-in-ms-access/42812787#42812787", "title": "Automatically Show Touch Keyboard in MS Access", "body": "<p><code>ACCESS VBA</code> :</p>\n\n<p>You have to write two lines of VB code</p>\n\n<pre><code>Call Shell(\"osk.exe\", 1)\nMyControl.SetFocus\n</code></pre>\n\n<p>or something like that, where my control is the name of the testbox, which should be activated. </p>\n\n<p>Try this <code>WINDOWS 7</code>:</p>\n\n<ol>\n<li>Start => Control Panel => Ease of access => Ease of Access Center</li>\n</ol>\n\n<p>Under Explore all settings, select Use the computer without a mouse or keyboard.</p>\n\n<p>Ease of Access Center</p>\n\n<ol start=\"2\">\n<li>Under Type using a pointing device, select Use On-screen Keyboard. Click Apply, then OK</li>\n</ol>\n\n<p>Use On-screen Keyboard</p>\n\n<ol start=\"3\">\n<li>Select Change Administrative settings from the column on the left.</li>\n</ol>\n\n<p>Change Administrative settings\nSelect Apply all settings to the logon desktop. Click Apply, then OK.</p>\n\n<p>Try this <code>WINDOWS 10</code></p>\n\n<p>Windows 10 does a fairly good job producing the onscreen keyboard when needed, particularly when you've switched to tablet mode. However, getting the onscreen keyboard to pop-up automatically consistently when in desktop mode is difficult.</p>\n\n<p>The keyboard icon in the Windows 10 System Tray helps. You can tap or click this to expose the onscreen keyboard.</p>\n\n<p>But, you can also improve how the onscreen keyboard reacts through the Windows 10 settings.</p>\n\n<p>To do this:</p>\n\n<p>Open All Settings, and then go to Devices.</p>\n\n<p>One the left-hand side of the Devices screen, select Typing and then scroll on the right-hand side until you locate Automatically show the touch keyboard in the windowed apps when there's no keyboard attached to your device</p>\n\n<p>Turn this option to \"ON\"</p>\n"}], "owner": {"reputation": 170, "user_id": 7495443, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/45cc211ede863e4dd862d03c9512d737?s=128&d=identicon&r=PG&f=1", "display_name": "Jul Pod", "link": "https://stackoverflow.com/users/7495443/jul-pod"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2078, "favorite_count": 0, "accepted_answer_id": 42812787, "answer_count": 1, "score": 0, "last_activity_date": 1489590529, "creation_date": 1489588385, "question_id": 42812738, "link": "https://stackoverflow.com/questions/42812738/automatically-show-touch-keyboard-in-ms-access", "title": "Automatically Show Touch Keyboard in MS Access", "body": "<p>i want to show automatically the Touch Keyboard in MS access when i click on a textbox, wondering why this is not working, is there maybe some property? I also wondering why this is not showing up automatically if i click in a excel cell...\n This Touch Keyboard:</p>\n\n<p><a href=\"https://i.stack.imgur.com/9OvyL.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/9OvyL.jpg\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1489588243, "post_id": 42812454, "comment_id": 72737479, "body": "Kudos for not defaulting to <code>Select</code> and <code>Activate</code> upon realising that unqualified <code>Range</code> calls implicitly refer to the active sheet."}], "answers": [{"comments": [{"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1489663067, "post_id": 42812533, "comment_id": 72774510, "body": "Downvoter I&#39;d love to improve this answer. Mind telling me what&#39;s wrong with it? (hope @Mat&#39;sMag won&#39;t mind my stealing his beautiful phrase)"}], "tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": false, "score": 2, "last_activity_date": 1489587862, "creation_date": 1489587862, "answer_id": 42812533, "question_id": 42812454, "link": "https://stackoverflow.com/questions/42812454/vba-for-excel-setting-a-range/42812533#42812533", "title": "VBA for Excel - Setting a range", "body": "<p>use <code>With-End With</code> syntax, and precede every <code>Range()</code> (and <code>Cells()</code>) specifications by a dot</p>\n\n<pre><code>With Worksheets(\"specificworksheet\")\n    .Range(\"a1\").Value = 1\n    .Range(\"B3:C5\").Value = 2\nEnd With\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 5, "last_activity_date": 1489587897, "creation_date": 1489587897, "answer_id": 42812544, "question_id": 42812454, "link": "https://stackoverflow.com/questions/42812454/vba-for-excel-setting-a-range/42812544#42812544", "title": "VBA for Excel - Setting a range", "body": "<p>You could use Address:</p>\n\n<pre><code>worksheets(\"specificworksheet\").range(r.Address).value=1 \n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 2, "creation_date": 1489589541, "post_id": 42812889, "comment_id": 72738575, "body": "@Downvoter I&#39;d love to improve this answer. Mind telling me what&#39;s wrong with it?"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 2, "creation_date": 1489589682, "post_id": 42812889, "comment_id": 72738693, "body": "Again, much better explanation and resolution.  I thought about adding the string approach but then got busy, just came back but I will leave as is and hope that the OP changes to yours."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1489590234, "post_id": 42812889, "comment_id": 72739124, "body": "Edited to include a more complete explanation of OP&#39;s runtime error 438."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1489590842, "post_id": 42812889, "comment_id": 72739630, "body": "I suppose @Downvoter wanted a quick &quot;try this&quot; copy-pasta answer - go ahead and downvote all my answers then, because I don&#39;t do that."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1489591127, "post_id": 42812889, "comment_id": 72739865, "body": "oooooh oooooh {<i>waves hands in the air frantically</i>}, I do that. 8P And that is why you have three upvotes to my two, currently"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1489591169, "post_id": 42812889, "comment_id": 72739906, "body": "And why this should be the accepted answer. @mathstackuser123"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1489591713, "post_id": 42812889, "comment_id": 72740389, "body": "@ScottCraner eh, I didn&#39;t mean to &quot;attack&quot; your perfectly valid answer - I&#39;m just puzzled with how some people spend their (down)votes sometimes. Cheers!"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1489591949, "post_id": 42812889, "comment_id": 72740590, "body": "no offense was taken, I stated the above, extremely sarcastically.  I know I do just enough, and that sometimes my answers are lacking in detail.  I was trying to be funny.  Text just does not convey humor properly."}, {"owner": {"reputation": 134, "user_id": 10986879, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ELEICvXMOBY/AAAAAAAAAAI/AAAAAAAAAZg/k3_D_aVqziU/photo.jpg?sz=128", "display_name": "Alex M", "link": "https://stackoverflow.com/users/10986879/alex-m"}, "edited": false, "score": 1, "creation_date": 1569007926, "post_id": 42812889, "comment_id": 102470449, "body": "Lovely. Thank you. I learned something from this question thanks to your answer. +1"}], "tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": false, "score": 8, "last_activity_date": 1489590174, "last_edit_date": 1489590174, "creation_date": 1489588794, "answer_id": 42812889, "question_id": 42812454, "link": "https://stackoverflow.com/questions/42812454/vba-for-excel-setting-a-range/42812889#42812889", "title": "VBA for Excel - Setting a range", "body": "<p>When you do:</p>\n\n<pre><code>Set r = Range(\"A1\")\n</code></pre>\n\n<p>What you're <em>really</em> doing is this:</p>\n\n<pre><code>Dim r As Variant\nSet r = Application.ActiveSheet.Range(\"A1\")\n</code></pre>\n\n<p>So declare all your variables, and <strong>always</strong> specify <code>Option Explicit</code> at the top of every module - that way VBA will refuse to compile code that uses undeclared variables (or typos). And declare your variables with an explicit type:</p>\n\n<pre><code>Dim r As Range\n</code></pre>\n\n<p>A <code>Range</code> object knows about its <code>Parent</code>, which is the worksheet it belongs to; that's why, as you noted, <em>this range is valid for the active worksheet</em>. And it remains on that sheet even if you activate another sheet (which you wouldn't need to do 99.999% of the time anyway).</p>\n\n<p>That's why you can't do this:</p>\n\n<pre><code>Worksheets(\"Sheet42\").r.Value = 1\n</code></pre>\n\n<p>Because <code>r</code> isn't a member of the <code>Worksheet</code> object - it's a local object variable that points to a very specific address on a very specific worksheet. Now, when you do <code>Worksheets(\"Sheet42\")</code>, you're really accessing the default property of the <code>Worksheets</code> collection class, which is its <code>Item</code> property:</p>\n\n<pre><code>Dim sheet As Worksheet\nSet sheet = Worksheets.Item(\"Sheet42\")\n</code></pre>\n\n<p>And the <code>Worksheets</code> collection's <code>Item</code> property returns an <code>Object</code>, which means any member call you add after that is going to be late-bound / resolved at run-time:</p>\n\n<pre><code>Dim obj As Object\nSet obj = Worksheets.Item(\"Sheet42\")\nobj.AnythingYouWantHereWillCompileAnyway\n</code></pre>\n\n<p>At run-time, VBA queries the object's interface to look for <code>AnythingYouWantHereWillCompileAnyway</code>, and doesn't find that member - and that's how you get a run-time error 438 - \"object doesn't support this property or method\".</p>\n\n<p>You can move that type-safety back to compile-time (instead of run-time) by working with early-bound calls, i.e. work with the <code>Worksheet</code> interface/class instead of <code>Object</code>:</p>\n\n<pre><code>Dim obj As Worksheet\nSet obj = Worksheets.Item(\"Sheet42\")\nobj.AnythingYouWantHereWillCompileAnyway 'nope. that won't compile anymore.\n</code></pre>\n\n<hr>\n\n<p>When you ask <em>how can I assign a range (that was already set) for another worksheet?</em>, you assume a <code>Range</code> object is nothing more than an address - and that assumption is wrong.</p>\n\n<p>A <code>Range</code> is <em>much</em> more than just an address. If it were just an address, then it would be a string literal, not an object.</p>\n\n<p>If you want a variable that represents an address, you can do that with a <code>String</code> variable:</p>\n\n<pre><code>Dim a As String\na = \"A1\"\n\nDim r1 As Range\nSet r1 = Sheet1.Range(a)\n\nDim r2 As Range\nSet r2 = Sheet2.Range(a)\n</code></pre>\n"}], "owner": {"reputation": 145, "user_id": 7698709, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e18e5ad2390d6263fc3d1be8459519e6?s=128&d=identicon&r=PG&f=1", "display_name": "mathstackuser123", "link": "https://stackoverflow.com/users/7698709/mathstackuser123"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 18755, "favorite_count": 1, "accepted_answer_id": 42812544, "answer_count": 3, "score": 8, "last_activity_date": 1489590174, "creation_date": 1489587668, "last_edit_date": 1531164843, "question_id": 42812454, "link": "https://stackoverflow.com/questions/42812454/vba-for-excel-setting-a-range", "title": "VBA for Excel - Setting a range", "body": "<p>I have a question about set range. There is something that I am trying and it's not working. Let's say I have range r, for example I wrote:</p>\n\n<pre><code>set r = range(\"a1\")\n</code></pre>\n\n<p>But this range is valid for the active worksheet, for example if I am on worksheet1 and I write r.value = 1 then it will change the value of that cell on the active worksheet. Now I want to change the value of that specific range on another worksheet. So I write</p>\n\n<pre><code>worksheets(\"specificworksheet\").r.value =1\n</code></pre>\n\n<p>But when I write this, it says Object doesn't support this propert or method. why is that? How can i assign a range (that was already set) for another worksheet? In this case writing</p>\n\n<pre><code>worksheets(\"specificworksheet\").range(\"a1\").value=1 \n</code></pre>\n\n<p>would solve my problem, however, somethimes I have more complicated range, for example if I assinged a cell to r, where I used cells.find(...). \nAppreciate any help, thanks!</p>\n"}, {"tags": ["excel", "vba", "compare", "cells"], "comments": [{"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 4, "creation_date": 1489587674, "post_id": 42812359, "comment_id": 72737041, "body": "Try possibly <code>Trim(sht.Cells(2, i).Value) = Trim(sht.Cells(11, i).Value)</code>? If the values are <i>truly</i> the same, your procedure shouldn&#39;t color them. Often leading/trailing spaces will cause a discrepancy, as <code>0 </code> != <code>0</code>, etc."}, {"owner": {"reputation": 77, "user_id": 5367981, "user_type": "registered", "profile_image": "https://graph.facebook.com/1052774908066879/picture?type=large", "display_name": "Viktor Bendik", "link": "https://stackoverflow.com/users/5367981/viktor-bendik"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1489588021, "post_id": 42812359, "comment_id": 72737314, "body": "Awesome David, this worked. Probably some spaces slipped in at export/import. Thanks!"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 2, "creation_date": 1489588303, "post_id": 42812359, "comment_id": 72737522, "body": "Also, if you&#39;re not concerned about upper/lowercase (i.e., you consider &quot;a&quot; == &quot;A&quot;), then you should wrap each in the <code>LCase</code> function as well. Otherwise, it will highlight cells with same <i>value</i> but different case."}], "owner": {"reputation": 77, "user_id": 5367981, "user_type": "registered", "profile_image": "https://graph.facebook.com/1052774908066879/picture?type=large", "display_name": "Viktor Bendik", "link": "https://stackoverflow.com/users/5367981/viktor-bendik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 447, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1489587650, "creation_date": 1489587398, "question_id": 42812359, "link": "https://stackoverflow.com/questions/42812359/comparison-of-2-cells-with-same-value-in-vba-returns-wrong-output", "title": "Comparison of 2 cells with same value in VBA returns wrong output", "body": "<p>So I have this code which lists through all sheets and compare cells in the 2nd row with cells in the 11th row. If they do not match it changes their color to red: </p>\n\n<pre><code>Dim tbl As ListObject\nDim sht As Worksheet\nDim i As Integer\n\n 'Loop through each sheet and table in the workbook\nFor Each sht In ThisWorkbook.Worksheets\n\n  For i = 1 To 1000\n    If sht.Cells(1, i) &lt;&gt; vbNullString Then\n        If sht.Cells(2, i).Value = sht.Cells(11, i).Value Then\n            sht.Cells(2, i).Interior.Color = xlNone\n            sht.Cells(11, i).Interior.Color = xlNone\n        Else\n            sht.Cells(2, i).Interior.Color = RGB(255, 0, 0)\n            sht.Cells(11, i).Interior.Color = RGB(255, 0, 0)\n\n        End If\n    Else\n        Exit For\n    End If\n\n Next i\n</code></pre>\n\n<p>However in one tab it colors some matching cells as well. The data I am comparing is an exported csv. If i manually rewrite the value of the compared cell and run the code the result is correct. The formating of cells is general in both rows. Any ideas how to fix this?</p>\n\n<p><a href=\"https://i.stack.imgur.com/gKGZf.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/gKGZf.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1489587330, "post_id": 42812288, "comment_id": 72736720, "body": "Yes, basically you wrap your current loop in another loop of sheets. Also amend your If statement or try a Select Case formulation which looks neater."}, {"owner": {"reputation": 305, "user_id": 7624245, "user_type": "registered", "accept_rate": 59, "profile_image": "https://graph.facebook.com/1340035062729998/picture?type=large", "display_name": "Defca Trick", "link": "https://stackoverflow.com/users/7624245/defca-trick"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1489587406, "post_id": 42812288, "comment_id": 72736790, "body": "will that work if I dont know the sheet names? I will go look up what a select case is, sorry im new to VBA. ty for the quick response."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1489587462, "post_id": 42812288, "comment_id": 72736835, "body": "Yes, just google &#39;loop through sheets&#39; or similar and you will find many examples. Try something yourself and then post back if you get stuck."}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1489589906, "post_id": 42812577, "comment_id": 72738864, "body": "FWIW, the <code>.Sheets</code> container may contain charts, macro sheets, etc. for both <code>.Count</code> and reference (e.g. <code>For Each wS in ThisWorkbook.Sheets</code>).  The <code>Worksheets</code> container contains only worksheets."}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 0, "creation_date": 1489590159, "post_id": 42812577, "comment_id": 72739071, "body": "@Jeeped : Thx for pointing it out, I knew but as I always use <code>Sheets</code> (and never use any Chart&#39;s sheets, and haven&#39;t the faintest clue of what you mean by <i>macro sheets</i> ^^), I never think of this! ;) I&#39;ll edit my answer to reflect that good point that may indeed avoid getting errors on non-worksheets! ;)"}], "tags": [], "owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "is_accepted": false, "score": 1, "last_activity_date": 1489590191, "last_edit_date": 1489590191, "creation_date": 1489587991, "answer_id": 42812577, "question_id": 42812288, "link": "https://stackoverflow.com/questions/42812288/excel-vba-to-remove-columns-based-on-multiple-headers-on-multiple-sheets/42812577#42812577", "title": "Excel VBA to Remove Columns Based on Multiple Headers on Multiple Sheets", "body": "<p>You need to properly reference the sheet, easy using <code>With</code> and you can use <code>LCase()</code> to avoid case sensitivity :</p>\n\n<pre><code>Sub remove_columns()\n    Dim wS As WorkSheet\n    For Each wS in ThisWorkbook.Worksheets\n        With wS\n            For i = .Columns.Count To 1 Step -1\n                If InStr(1, LCase(.Cells(1, i)), LCase(\"Status\")) Then _\n                    .Columns(i).EntireColumn.Delete\n            Next i\n        End With 'wS\n    Next wS\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": false, "score": 2, "last_activity_date": 1489588426, "creation_date": 1489588426, "answer_id": 42812751, "question_id": 42812288, "link": "https://stackoverflow.com/questions/42812288/excel-vba-to-remove-columns-based-on-multiple-headers-on-multiple-sheets/42812751#42812751", "title": "Excel VBA to Remove Columns Based on Multiple Headers on Multiple Sheets", "body": "<p>I'd go like follows</p>\n\n<pre><code>Sub Main()\n    Dim sh As Worksheet\n    Dim i as Long\n\n    For Each sh In ThisWorkbook.Sheets\n        With sh.UsedRange\n            For i = .columns.Count To 1 Step -1\n                If InStr(1, LCase(.columns(i).cells(1)), \"status\") Then .columns(i).EntireColumn.Delete\n            Next\n        End With\n    Next\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 305, "user_id": 7624245, "user_type": "registered", "accept_rate": 59, "profile_image": "https://graph.facebook.com/1340035062729998/picture?type=large", "display_name": "Defca Trick", "link": "https://stackoverflow.com/users/7624245/defca-trick"}, "edited": false, "score": 0, "creation_date": 1489591941, "post_id": 42813085, "comment_id": 72740583, "body": "This worked perfectly! ty, out of curiosity will this work the same if I replace all deletes with hidden&#39;s? ty again!"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 305, "user_id": 7624245, "user_type": "registered", "accept_rate": 59, "profile_image": "https://graph.facebook.com/1340035062729998/picture?type=large", "display_name": "Defca Trick", "link": "https://stackoverflow.com/users/7624245/defca-trick"}, "edited": false, "score": 0, "creation_date": 1489592159, "post_id": 42813085, "comment_id": 72740753, "body": "I don&#39;t see any reason why changing <code>.delete</code> to <code>.hidden = true</code> would not work."}, {"owner": {"reputation": 305, "user_id": 7624245, "user_type": "registered", "accept_rate": 59, "profile_image": "https://graph.facebook.com/1340035062729998/picture?type=large", "display_name": "Defca Trick", "link": "https://stackoverflow.com/users/7624245/defca-trick"}, "edited": false, "score": 0, "creation_date": 1489592749, "post_id": 42813085, "comment_id": 72741243, "body": "Thanks! 1 final thought if you would be so kind, If I wanted to delete a row based on a column name and a value in that column would I be able to do that in this same code by adding in another array somehow? (in case it is multiple values in the column)  ty yet again!"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 305, "user_id": 7624245, "user_type": "registered", "accept_rate": 59, "profile_image": "https://graph.facebook.com/1340035062729998/picture?type=large", "display_name": "Defca Trick", "link": "https://stackoverflow.com/users/7624245/defca-trick"}, "edited": false, "score": 0, "creation_date": 1489592846, "post_id": 42813085, "comment_id": 72741323, "body": "Sure. After finding a non-error column number, use a similar routine to find a non-error row number in that column."}, {"owner": {"reputation": 305, "user_id": 7624245, "user_type": "registered", "accept_rate": 59, "profile_image": "https://graph.facebook.com/1340035062729998/picture?type=large", "display_name": "Defca Trick", "link": "https://stackoverflow.com/users/7624245/defca-trick"}, "edited": false, "score": 0, "creation_date": 1489593099, "post_id": 42813085, "comment_id": 72741534, "body": "ty! im still very green to this, so I will try and figure out what that would look like, but at least in theory that can be done which is great news! thanks again."}, {"owner": {"reputation": 305, "user_id": 7624245, "user_type": "registered", "accept_rate": 59, "profile_image": "https://graph.facebook.com/1340035062729998/picture?type=large", "display_name": "Defca Trick", "link": "https://stackoverflow.com/users/7624245/defca-trick"}, "edited": false, "score": 0, "creation_date": 1489610785, "post_id": 42813085, "comment_id": 72752462, "body": "Hello, I tried a few things but cant get it to work it kept just hiding the column but not the row/column combination"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 305, "user_id": 7624245, "user_type": "registered", "accept_rate": 59, "profile_image": "https://graph.facebook.com/1340035062729998/picture?type=large", "display_name": "Defca Trick", "link": "https://stackoverflow.com/users/7624245/defca-trick"}, "edited": false, "score": 0, "creation_date": 1489611553, "post_id": 42813085, "comment_id": 72752862, "body": "This is probably the time to take your modified code and post a new question using the code and detailing what you are attempting (examples help) and what doesn&#39;t happen the way you are expecting it to."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 3, "last_activity_date": 1489589254, "creation_date": 1489589254, "answer_id": 42813085, "question_id": 42812288, "link": "https://stackoverflow.com/questions/42812288/excel-vba-to-remove-columns-based-on-multiple-headers-on-multiple-sheets/42813085#42813085", "title": "Excel VBA to Remove Columns Based on Multiple Headers on Multiple Sheets", "body": "<pre><code>dim a as long, w as long, vDELCOLs as variant, vCOLNDX as variant\nvdelcols = array(\"status\",\"Status Name\",\"Status Processes\")\nwith thisworkbook\n    for w=1 to .worksheets.count\n        with worksheets(w)\n            for a=lbound(vdelcols) to ubound(vdelcols)\n                vcolndx=application.match(vdelcols(a), .rows(1), 0)\n                if not iserror(vcolndx) then\n                    .columns(vcolndx).entirecolumn.delete\n                end if\n            next a\n        end with\n    next w\nend with\n</code></pre>\n\n<p>You obviously have less columns to delete than columns that exist. Look for matches to the columns to delete rather than comparing every column to the delete list.</p>\n\n<p>This looks (case-insensitive) for the column names in row 1.</p>\n"}], "owner": {"reputation": 305, "user_id": 7624245, "user_type": "registered", "accept_rate": 59, "profile_image": "https://graph.facebook.com/1340035062729998/picture?type=large", "display_name": "Defca Trick", "link": "https://stackoverflow.com/users/7624245/defca-trick"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2679, "favorite_count": 0, "accepted_answer_id": 42813085, "answer_count": 3, "score": 3, "last_activity_date": 1489590191, "creation_date": 1489587196, "last_edit_date": 1489587704, "question_id": 42812288, "link": "https://stackoverflow.com/questions/42812288/excel-vba-to-remove-columns-based-on-multiple-headers-on-multiple-sheets", "title": "Excel VBA to Remove Columns Based on Multiple Headers on Multiple Sheets", "body": "<p>Would the below code be able to be modified to 1 loop through all sheets in a workbook and 2 remove multiple columns based on their headers? </p>\n\n<p>example: \"status\",\"Status Name\",\"Status Processes\" etc.)?\nAnd then cycle through all sheets in the wkbk to do the same checks?</p>\n\n<pre><code>Sub remove_columns()\n    For i = ActiveSheet.Columns.Count To 1 Step -1\n        If InStr(1, Cells(1, i), \"Status\") Then Columns(i).EntireColumn.Delete\n    Next i\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 1, "creation_date": 1489587776, "post_id": 42812250, "comment_id": 72737136, "body": "You can delete the formula when the result is empty, granted we can tell you how to do that. BUT are you sure you want to do it only when the result is empty? Be aware that, if you <code>delete</code> the formula at some place, but later <code>A1</code> is edited and become &quot;calcutta&quot;, the formula is gone and you will still have blank. Therefore it makes no sense, unless you want to delete <i>ALL</i>  the formulas and keep only the resulting values, whether blank or not."}, {"owner": {"reputation": 1, "user_id": 7715489, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d21670f92bce60dd2cbf88d9ad3c8a4e?s=128&d=identicon&r=PG&f=1", "display_name": "BC Ministry", "link": "https://stackoverflow.com/users/7715489/bc-ministry"}, "reply_to_user": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1489588632, "post_id": 42812250, "comment_id": 72737820, "body": "Thanks, that makes sense.  I would still like to delete it if blank as the blank cells are interfering more with our results than this mistake would.  Knowing that if I change cell A1 I will have  to go back and manually populate B1 would be less of an inconvenience for me than to have to delete the blank cells each time I opened the document.  Thanks!"}, {"owner": {"reputation": 7854, "user_id": 5461205, "user_type": "registered", "profile_image": "https://graph.facebook.com/1112471818782668/picture?type=large", "display_name": "Dirk Reichel", "link": "https://stackoverflow.com/users/5461205/dirk-reichel"}, "edited": false, "score": 0, "creation_date": 1489590435, "post_id": 42812250, "comment_id": 72739296, "body": "Using VBA you can go for the <code>WorksheetChange</code> event and check for the cells like <code>A1:A20</code> and if the <code>Taget.Value</code> is &quot;calcutta&quot; then <code>Target.Offset(0, 2).Value = Target.Offset(0, 1).Value</code> or use <code>Target.Offset(0, 2).FormulaR1C1</code> if column B is not static else set it to be empty. (Assuming the formulas in column C)"}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1489591052, "post_id": 42813467, "comment_id": 72739800, "body": "A change in the value returned by a formula does not trigger a Worksheet_Change event so Target will never be a formula even if something else triggered the event. A formula only triggers a Worksheet_Change event when it is originally entered or cleared."}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 0, "creation_date": 1489591273, "post_id": 42813467, "comment_id": 72739993, "body": "@Jeeped When you <b>first enter a formula, BOTH</b> events are raised.......try it..........a pure re-calc will not catch a switch to NULL."}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 0, "last_activity_date": 1489591328, "last_edit_date": 1489591328, "creation_date": 1489590131, "answer_id": 42813467, "question_id": 42812250, "link": "https://stackoverflow.com/questions/42812250/how-do-i-use-a-macro-to-delete-blank-cells-within-a-range-automatically/42813467#42813467", "title": "How do I use a macro to delete blank cells within a range automatically?", "body": "<p>After you have entered your formulas, run this short macro:</p>\n\n<pre><code>Sub FixFormulas()\n    Dim r As Range, BigR As Range\n    On Error GoTo tellme\n        Set BigR = ActiveSheet.UsedRange.Cells.SpecialCells(xlCellTypeFormulas)\n    On Error GoTo 0\n    For Each r In BigR\n        If r.Value = \"\" Then r.Clear\n    Next r\n    Exit Sub\ntellme:\n    On Error GoTo 0\n    MsgBox \"no formulas\"\n\nEnd Sub\n</code></pre>\n\n<p><strong>EDIT#1:</strong></p>\n\n<p>If you want this action to occur automatically <strong>after</strong> you have entered a formula, the use this <em>Event macro</em>:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    Dim r As Range\n\n    Application.EnableEvents = False\n        For Each r In Target\n            If r.HasFormula And r.Value = \"\" Then r.Clear\n        Next r\n    Application.EnableEvents = True\nEnd Sub\n</code></pre>\n\n<p>Because it is worksheet code, it is very easy to install and automatic to use:</p>\n\n<ol>\n<li>right-click the tab name near the bottom of the Excel window</li>\n<li>select View Code - this brings up a VBE window</li>\n<li>paste the stuff in and close the VBE window</li>\n</ol>\n\n<p>If you have any concerns, first try it on a trial worksheet.</p>\n\n<p>If you save the workbook, the macro will be saved with it.\nIf you are using a version of Excel later then 2003, you must save\nthe file as .xlsm rather than .xlsx</p>\n\n<p>To remove the macro:</p>\n\n<ol>\n<li>bring up the VBE windows as above</li>\n<li>clear the code out</li>\n<li>close the VBE window</li>\n</ol>\n\n<p>To learn more about macros in general, see:</p>\n\n<p><a href=\"http://www.mvps.org/dmcritchie/excel/getstarted.htm\" rel=\"nofollow noreferrer\">http://www.mvps.org/dmcritchie/excel/getstarted.htm</a></p>\n\n<p>and</p>\n\n<p><a href=\"http://msdn.microsoft.com/en-us/library/ee814735(v=office.14).aspx\" rel=\"nofollow noreferrer\">http://msdn.microsoft.com/en-us/library/ee814735(v=office.14).aspx</a></p>\n\n<p>To learn more about Event Macros (worksheet code), see:</p>\n\n<p><a href=\"http://www.mvps.org/dmcritchie/excel/event.htm\" rel=\"nofollow noreferrer\">http://www.mvps.org/dmcritchie/excel/event.htm</a></p>\n\n<p>Macros must be enabled for this to work!</p>\n"}], "owner": {"reputation": 1, "user_id": 7715489, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d21670f92bce60dd2cbf88d9ad3c8a4e?s=128&d=identicon&r=PG&f=1", "display_name": "BC Ministry", "link": "https://stackoverflow.com/users/7715489/bc-ministry"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 226, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1489591328, "creation_date": 1489587124, "last_edit_date": 1489587309, "question_id": 42812250, "link": "https://stackoverflow.com/questions/42812250/how-do-i-use-a-macro-to-delete-blank-cells-within-a-range-automatically", "title": "How do I use a macro to delete blank cells within a range automatically?", "body": "<p>I am using if-then statements to automatically populate an excel sheet and I would like the cell (not the whole row or column) to automatically delete itself if the equation is false.  I need this to happen automatically so that we can pull these sheets up as a reference quickly without having to delete the blank cells before seeing the results. This is the equation I am currently using:</p>\n\n<pre><code>=IF(A1=\"calcutta\",B1,\"\")\n</code></pre>\n\n<p>The formula does what I would like it to do, but I understand that I will need to run a Macro to automatically delete blank cells withing my range as you cannot delete cells with a formula.  Essentially I would like it to work like this:</p>\n\n<pre><code>=IF(A1=\"calcutta\",B1,\"deletecell\")\n</code></pre>\n\n<p>Can anyone help me with this?  I have never used macros before, so the exact equation would be especially helpful!</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 1, "creation_date": 1489589148, "post_id": 42812243, "comment_id": 72738259, "body": "If you are using Form controls, your syntax is wrong - that&#39;s how you refer to ActiveX controls."}, {"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1489599956, "post_id": 42812243, "comment_id": 72746084, "body": "If that&#39;s a form control then you might be interested in the following post: <a href=\"http://stackoverflow.com/questions/42811509/object-required-error-when-trying-to-refer-to-checkbox-in-worksheet/42811946#42811946\" title=\"object required error when trying to refer to checkbox in worksheet\">stackoverflow.com/questions/42811509/&hellip;</a>"}, {"owner": {"reputation": 1, "user_id": 7710386, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1efd2ebbde435adef98ded03ba7e12a4?s=128&d=identicon&r=PG&f=1", "display_name": "BobEatsFood", "link": "https://stackoverflow.com/users/7710386/bobeatsfood"}, "edited": false, "score": 0, "creation_date": 1491846654, "post_id": 42812243, "comment_id": 73723845, "body": "It is an ActiveX control.  After toying around some I realized that I can no longer insert any ActiveX controlls into my workbooks.  I ran across the following:"}, {"owner": {"reputation": 1, "user_id": 7710386, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1efd2ebbde435adef98ded03ba7e12a4?s=128&d=identicon&r=PG&f=1", "display_name": "BobEatsFood", "link": "https://stackoverflow.com/users/7710386/bobeatsfood"}, "edited": false, "score": 0, "creation_date": 1491846660, "post_id": 42812243, "comment_id": 73723848, "body": "<a href=\"https://support.microsoft.com/en-us/help/3025036/-cannot-insert-object-error-in-an-activex-custom-office-solution-after-you-install-the-ms14-082-security-update\" rel=\"nofollow noreferrer\">support.microsoft.com/en-us/help/3025036/&hellip;</a>"}, {"owner": {"reputation": 1, "user_id": 7710386, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1efd2ebbde435adef98ded03ba7e12a4?s=128&d=identicon&r=PG&f=1", "display_name": "BobEatsFood", "link": "https://stackoverflow.com/users/7710386/bobeatsfood"}, "edited": false, "score": 0, "creation_date": 1491846742, "post_id": 42812243, "comment_id": 73723888, "body": "But I am hoping to find an alternate fix as I don&#39;t have the permissions to install updates and IT who does have permissions is not responding to requests."}], "owner": {"reputation": 1, "user_id": 7710386, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1efd2ebbde435adef98ded03ba7e12a4?s=128&d=identicon&r=PG&f=1", "display_name": "BobEatsFood", "link": "https://stackoverflow.com/users/7710386/bobeatsfood"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 419, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1489588526, "creation_date": 1489587119, "last_edit_date": 1531164843, "question_id": 42812243, "link": "https://stackoverflow.com/questions/42812243/excel-vba-option-button-run-time-error-438-on-new-machine", "title": "Excel VBA Option Button Run Time Error 438 on New Machine", "body": "<p>I have some code that worked on my old work machine and confirmed still works on other work machines but doesn't work on a newly provided work computer.  Code appears to bomb when I reference the option button but works fine for all the rest of the code.  For instance this line:</p>\n\n<pre><code>Sub test()\n\n    Sheets(\"Sheet1\").OptionButton1.value = \"False\"\n\nEnd Sub\n</code></pre>\n\n<p>Generates this error message:\nRun-time error '438': Object doesn't support this property or method</p>\n\n<p>I have verified the following:</p>\n\n<ul>\n<li>I am working off of the same version of Microsoft Excel as before</li>\n<li>The same references are included as before</li>\n<li>I am using Form controls, not ActiveX controls</li>\n<li>I get the same error even if I alter the code to : ActiveSheet.Shapes(\"OptionButton1\").ControlFormat.Value = xlOff</li>\n</ul>\n"}, {"tags": ["vba", "excel", "while-loop"], "comments": [{"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 0, "creation_date": 1489587346, "post_id": 42812149, "comment_id": 72736731, "body": "Welcome to SO, please take a <b>minute to take the <a href=\"https://stackoverflow.com/tour\">tour</a></b> to see how SO community works (how to accept answers and use votes)."}], "answers": [{"comments": [{"owner": {"reputation": 37, "user_id": 7690933, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh3.googleusercontent.com/-FUM7--pD4-o/AAAAAAAAAAI/AAAAAAAAACk/Rdqa2Wp8xmE/photo.jpg?sz=128", "display_name": "Eric ", "link": "https://stackoverflow.com/users/7690933/eric"}, "edited": false, "score": 0, "creation_date": 1489587948, "post_id": 42812311, "comment_id": 72737263, "body": "That worked perfectly.  I&#39;m learning vba the hard way here!  A couple questions.  First, how to close the files I just opened?  Second, is there another way to differentiate the files to open other than &quot;*.xlsx&quot;?  My concern is the folks add additional files in the folder that do not need the date tab added."}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "reply_to_user": {"reputation": 37, "user_id": 7690933, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh3.googleusercontent.com/-FUM7--pD4-o/AAAAAAAAAAI/AAAAAAAAACk/Rdqa2Wp8xmE/photo.jpg?sz=128", "display_name": "Eric ", "link": "https://stackoverflow.com/users/7690933/eric"}, "edited": false, "score": 0, "creation_date": 1489588490, "post_id": 42812311, "comment_id": 72737706, "body": "@Eric : Glad I could help! First of all, as I said in comments : <b>please take the <a href=\"https://stackoverflow.com/tour\">tour</a></b> (click it), I see that you have ask a few questions and not accepted any answers, so it&#39;s more than time to know how SO works! ;) Then I&#39;ve added the part to save the workbook with the new sheet. And to exclude the files, if those you want to add sheets in don&#39;t have a common form of naming, it&#39;ll be hard to exclude other files... If it has, you can use something like <code>&quot;*Common_Part_In_Name*.xlsx&quot;</code>"}, {"owner": {"reputation": 37, "user_id": 7690933, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh3.googleusercontent.com/-FUM7--pD4-o/AAAAAAAAAAI/AAAAAAAAACk/Rdqa2Wp8xmE/photo.jpg?sz=128", "display_name": "Eric ", "link": "https://stackoverflow.com/users/7690933/eric"}, "edited": false, "score": 0, "creation_date": 1489589354, "post_id": 42812311, "comment_id": 72738416, "body": "Thank you, and I&#39;ll definitely take the tour.  I&#39;m going to update my code and try this now."}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "reply_to_user": {"reputation": 37, "user_id": 7690933, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh3.googleusercontent.com/-FUM7--pD4-o/AAAAAAAAAAI/AAAAAAAAACk/Rdqa2Wp8xmE/photo.jpg?sz=128", "display_name": "Eric ", "link": "https://stackoverflow.com/users/7690933/eric"}, "edited": false, "score": 0, "creation_date": 1489589487, "post_id": 42812311, "comment_id": 72738522, "body": "@Eric : And after, the tour, come back to accept answers! ;)"}, {"owner": {"reputation": 37, "user_id": 7690933, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh3.googleusercontent.com/-FUM7--pD4-o/AAAAAAAAAAI/AAAAAAAAACk/Rdqa2Wp8xmE/photo.jpg?sz=128", "display_name": "Eric ", "link": "https://stackoverflow.com/users/7690933/eric"}, "edited": false, "score": 0, "creation_date": 1489591175, "post_id": 42812311, "comment_id": 72739915, "body": "This is works well.  As soon as work allows I&#39;ll take the tour.  Thanks."}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "reply_to_user": {"reputation": 37, "user_id": 7690933, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh3.googleusercontent.com/-FUM7--pD4-o/AAAAAAAAAAI/AAAAAAAAACk/Rdqa2Wp8xmE/photo.jpg?sz=128", "display_name": "Eric ", "link": "https://stackoverflow.com/users/7690933/eric"}, "edited": false, "score": 0, "creation_date": 1489591283, "post_id": 42812311, "comment_id": 72740004, "body": "@Eric : It&#39;ll take less time than posting a comment! ;) And even less time to accept an answer (gray tick under the arrow, that&#39;ll become green if you click it! ;) )"}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "reply_to_user": {"reputation": 37, "user_id": 7690933, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh3.googleusercontent.com/-FUM7--pD4-o/AAAAAAAAAAI/AAAAAAAAACk/Rdqa2Wp8xmE/photo.jpg?sz=128", "display_name": "Eric ", "link": "https://stackoverflow.com/users/7690933/eric"}, "edited": false, "score": 0, "creation_date": 1489591927, "post_id": 42812311, "comment_id": 72740567, "body": "@Eric : Thx! ;)"}], "tags": [], "owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "is_accepted": true, "score": 0, "last_activity_date": 1489588135, "last_edit_date": 1489588135, "creation_date": 1489587272, "answer_id": 42812311, "question_id": 42812149, "link": "https://stackoverflow.com/questions/42812149/loop-through-files-in-a-folder-and-add-date-tab/42812311#42812311", "title": "Loop through files in a folder and add date tab", "body": "<p>2 issues :</p>\n\n<ol>\n<li>you missed the <code>MyFile = Dir()</code> that give you the next file name.</li>\n<li>you used <code>Exit Sub</code> which would just get out of the program without continuing treatment.</li>\n</ol>\n\n<hr>\n\n<p>Fixed code :</p>\n\n<pre><code>Sub LoopThroughFolder()\nDim MyFile As String, Str As String, MyDir As String\nDim Tb As Workbook, wB As Workbook\nSet Tb = ThisWorkbook\n\nMyDir = \"C:\\Users\\u558683\\Desktop\\QA VBA Project\\LoopTabs\\\"\nMyFile = Dir(MyDir &amp; \"*.xlsx\")\n\nDo While MyFile &lt;&gt; vbNullString\n    Set wB = Workbooks.Open(MyDir &amp; MyFile)\n    TabName = Format(Date, \"mmm-yyyy\") 'Change the format as per your  requirement\n\n    On Error Resume Next\n    wB.Sheets(TabName).Activate\n    If Err.Number &gt; 0 Then\n        'AddNewSheet\n        wB.Sheets.Add , wB.Sheets(wB.Sheets.Count)\n        ActiveSheet.Name = TabName\n        ActiveSheet.Previous.Range(\"A1:AJ4\").Copy Destination:=Range(\"A1\")\n        ActiveSheet.Previous.Range(\"AL1:AN500\").Copy Destination:=Range(\"AK1\")\n        wB.Save\n    Else\n    End If\n    On Error GoTo 0\n    wB.Close False\n    MyFile = Dir()\nLoop\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 37, "user_id": 7690933, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh3.googleusercontent.com/-FUM7--pD4-o/AAAAAAAAAAI/AAAAAAAAACk/Rdqa2Wp8xmE/photo.jpg?sz=128", "display_name": "Eric ", "link": "https://stackoverflow.com/users/7690933/eric"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 110, "favorite_count": 1, "accepted_answer_id": 42812311, "answer_count": 1, "score": 2, "last_activity_date": 1489588135, "creation_date": 1489586869, "last_edit_date": 1489587287, "question_id": 42812149, "link": "https://stackoverflow.com/questions/42812149/loop-through-files-in-a-folder-and-add-date-tab", "title": "Loop through files in a folder and add date tab", "body": "<p>I am trying to go to a set of workbooks in a folder and add a Tab to each named the current date.  </p>\n\n<p>My code below opens the first file and adds the Tab correctly, but does not loop to open the remaining files.   </p>\n\n<pre><code>Sub LoopThroughFolder()\n\nDim MyFile As String, Str As String, MyDir As String, Wb As Workbook\nSet Wb = ThisWorkbook\n\nMyDir = \"C:\\Users\\u558683\\Desktop\\QA VBA Project\\LoopTabs\\\"\nMyFile = Dir(MyDir &amp; \"*.xlsx\")\nChDir MyDir\n\n\nDo While MyFile &lt;&gt; \"\"\n\nWorkbooks.Open (MyFile)\n    TabName = Format(Date, \"mmm-yyyy\") 'Change the format as per your  requirement\n\nOn Error GoTo AddNew\nSheets(TabName).Activate\nExit Sub\n\nAddNew:\n Sheets.Add , Worksheets(Worksheets.Count)\n ActiveSheet.Name = TabName\n\n ActiveSheet.Previous.Range(\"A1:AJ4\").Copy Destination:=Range(\"A1\")\n ActiveSheet.Previous.Range(\"AL1:AN500\").Copy Destination:=Range(\"AK1\")\n\n Loop\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "charts"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1489587885, "post_id": 42812011, "comment_id": 72737215, "body": "Without seeing the data, I don&#39;t think we can rule out that it&#39;s a data issue. Can you make a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>?"}, {"owner": {"reputation": 25, "user_id": 7702098, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cc153cb25cbf0ae3fda38c3fa94e73af?s=128&d=identicon&r=PG&f=1", "display_name": "A.Doe", "link": "https://stackoverflow.com/users/7702098/a-doe"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1489592183, "post_id": 42812011, "comment_id": 72740775, "body": "Mat&#39;s Mug thanks for replying. I have created a mini version, how do I attach it?"}, {"owner": {"reputation": 25, "user_id": 7702098, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cc153cb25cbf0ae3fda38c3fa94e73af?s=128&d=identicon&r=PG&f=1", "display_name": "A.Doe", "link": "https://stackoverflow.com/users/7702098/a-doe"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1489592533, "post_id": 42812011, "comment_id": 72741051, "body": "Mat&#39;s Mug: <a href=\"https://ufile.io/85f2b\" rel=\"nofollow noreferrer\">ufile.io/85f2b</a> Please let me know if it doesn&#39;t work. Many thanks FN"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1489592619, "post_id": 42812011, "comment_id": 72741116, "body": "I&#39;d include all the relevant information <i>in the question itself</i>, not behind a download link (which I&#39;m not clicking btw)."}, {"owner": {"reputation": 25, "user_id": 7702098, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cc153cb25cbf0ae3fda38c3fa94e73af?s=128&d=identicon&r=PG&f=1", "display_name": "A.Doe", "link": "https://stackoverflow.com/users/7702098/a-doe"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1489595055, "post_id": 42812011, "comment_id": 72742998, "body": "Mat&#39;s Mug - I provided screenshots in the original post instead - is this sufficient for you to be able to help? Many thanks for your feedback"}], "owner": {"reputation": 25, "user_id": 7702098, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cc153cb25cbf0ae3fda38c3fa94e73af?s=128&d=identicon&r=PG&f=1", "display_name": "A.Doe", "link": "https://stackoverflow.com/users/7702098/a-doe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 266, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1489594414, "creation_date": 1489586491, "last_edit_date": 1489594414, "question_id": 42812011, "link": "https://stackoverflow.com/questions/42812011/part-of-area-chart-not-filled-vba", "title": "part of area chart not filled vba", "body": "<p>I'm trying to generate area charts that comes out with green colors for values over a threshold, and red values for values under. I'm able to generate the charts, but my problem is that I don't get continuous graphs (they always come out with gap spaces between the different colored values, even if there is a number in the cell that represents the gap in the graph).\nSample code for the graphs:</p>\n\n<pre><code>Sub x_Graph()\n\n'Define Chart\nDim c As Chart\nSet c = ActiveWorkbook.Charts.Add\nSet c = c.Location(Where:=xlLocationAsObject, Name:=\"RRL\")\nWith c\n.ChartType = xlArea\n.HasTitle = True\n.ChartTitle.Text = Sheets(\"Control Data\").Range(\"C4\").Value\nEnd With\n\n'Delete pre-defined series\nDo Until ActiveChart.SeriesCollection.Count = 0\nActiveChart.SeriesCollection(1).Delete\nLoop\n\nWith c\n.SeriesCollection.NewSeries\n.SeriesCollection(1).XValues = Sheets(\"PD\").Range(\"AN$34:AY$34\")\n.SeriesCollection(1).Values = Sheets(\"PD\").Range(\"AN$40:AY$40\")\n.SeriesCollection.NewSeries\n.SeriesCollection(2).XValues = Sheets(\"PD\").Range(\"AN$34:AY$34\")\n.SeriesCollection(2).Values = Sheets(\"PD\").Range(\"AN$41:AY$41\")\n\n'Name series and format size\n\nc.SeriesCollection(1).Name = \"HU (days/month)\"\nc.SeriesCollection(2).Name = \"LU (days/month)\"\n.Parent.Width = 700\n.Parent.Height = 450\n\nEnd With\n\nc.SeriesCollection(1).Select\nWith Selection\n.Format.Fill.ForeColor.RGB = RGB(0, 255, 0)\nEnd With\n\nc.SeriesCollection(2).Select\nWith Selection\n.Format.Fill.ForeColor.RGB = RGB(255, 0, 0)\nEnd With\n\n'Format fonts\nc.Legend.Select\n    With Selection.Format.TextFrame2.TextRange.Font\n        .BaselineOffset = 0\n        .Size = 14\n        .Name = \"Arial\"\n        End With\nc.Axes(xlValue).Select\nWith Selection.TickLabels.Font\n     .Size = 14\n     .Name = \"Arial\"\n   End With\nc.Axes(xlCategory).Select\nWith Selection.TickLabels.Font\n     .Size = 14\n     .Name = \"Arial\"\n   End With\n\nEnd Sub\n</code></pre>\n\n<p>The graphs come out like this:</p>\n\n<p><img src=\"https://image.ibb.co/eLR9bF/jees.png\" alt=\"\"></p>\n\n<p>With a gap in between the red and green area, even if there's data in the cell.</p>\n\n<p>The input data is in the following format:\n<img src=\"https://ibb.co/iVsROv\" alt=\"\">\nThe green is created from the \"Good\" series and the red is created from \"Bad\"</p>\n\n<p>And background code:\n<img src=\"https://ibb.co/j9rswF\" alt=\"\">\netc</p>\n\n<p>Anyone know what could be done?</p>\n\n<p>Many thanks in advance\nFN</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 2, "creation_date": 1489586048, "post_id": 42811757, "comment_id": 72735609, "body": "Is there a unique identifier for each row?  Could do an Index/Match on that unique identifier to specify the columns you need.  Hard to speculate further due to lack of information."}, {"owner": {"reputation": 27, "user_id": 7443167, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-QIwbQ1BlOi4/AAAAAAAAAAI/AAAAAAAAA4g/5L4LYAxGkV4/photo.jpg?sz=128", "display_name": "Nabeela Van", "link": "https://stackoverflow.com/users/7443167/nabeela-van"}, "reply_to_user": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1489586259, "post_id": 42811757, "comment_id": 72735814, "body": "@tigeravatar No index match won&#39;t be possible. New data will be put into sheet everyday."}, {"owner": {"reputation": 27, "user_id": 7443167, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-QIwbQ1BlOi4/AAAAAAAAAAI/AAAAAAAAA4g/5L4LYAxGkV4/photo.jpg?sz=128", "display_name": "Nabeela Van", "link": "https://stackoverflow.com/users/7443167/nabeela-van"}, "reply_to_user": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1489599004, "post_id": 42811757, "comment_id": 72745485, "body": "@Fadi any ideas?"}], "answers": [{"comments": [{"owner": {"reputation": 27, "user_id": 7443167, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-QIwbQ1BlOi4/AAAAAAAAAAI/AAAAAAAAA4g/5L4LYAxGkV4/photo.jpg?sz=128", "display_name": "Nabeela Van", "link": "https://stackoverflow.com/users/7443167/nabeela-van"}, "edited": false, "score": 0, "creation_date": 1490025089, "post_id": 42836651, "comment_id": 72915684, "body": "I don&#39;t understand the unique identifier part. But in AO1  ( an unused column of Sheet 1) (Master Sheet), I have put Route_Sheet!AO3 . I have added the code to module under Sheet 4 (Master Sheet)"}, {"owner": {"reputation": 27, "user_id": 7443167, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-QIwbQ1BlOi4/AAAAAAAAAAI/AAAAAAAAA4g/5L4LYAxGkV4/photo.jpg?sz=128", "display_name": "Nabeela Van", "link": "https://stackoverflow.com/users/7443167/nabeela-van"}, "edited": false, "score": 0, "creation_date": 1490025152, "post_id": 42836651, "comment_id": 72915731, "body": "But the code is not recognized by workbook, and when I run macro, it shows no name. I am adding the modified code to my original question (please see). Thanks very much for your help."}, {"owner": {"reputation": 3088, "user_id": 4039286, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/vOSnz.jpg?s=128&g=1", "display_name": "Fadi", "link": "https://stackoverflow.com/users/4039286/fadi"}, "reply_to_user": {"reputation": 27, "user_id": 7443167, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-QIwbQ1BlOi4/AAAAAAAAAAI/AAAAAAAAA4g/5L4LYAxGkV4/photo.jpg?sz=128", "display_name": "Nabeela Van", "link": "https://stackoverflow.com/users/7443167/nabeela-van"}, "edited": false, "score": 0, "creation_date": 1490032966, "post_id": 42836651, "comment_id": 72920761, "body": "@NabeelaVan, form the image that you add it seems that you put the code in <code>Module1</code> not in <code>Sheet4</code> module and I don&#39;t see any sheet with name <code>Sheet 2</code> . change <code>Sheet 2</code> in the code to your target sheet like <code>Route_Sheet</code> or <code>Lists</code>"}, {"owner": {"reputation": 27, "user_id": 7443167, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-QIwbQ1BlOi4/AAAAAAAAAAI/AAAAAAAAA4g/5L4LYAxGkV4/photo.jpg?sz=128", "display_name": "Nabeela Van", "link": "https://stackoverflow.com/users/7443167/nabeela-van"}, "edited": false, "score": 0, "creation_date": 1490042066, "post_id": 42836651, "comment_id": 72926064, "body": "Okay now I&#39;m adding the code to View code for Sheet 4 (Master Sheet). But please see new image, the workbook is not recognizing the code like it does for other two codes in the same workbook. Also, I made one small change in my previous codes with the B column. Sorry about that. Thank you Fadi. Greatly appreciate your time and effort to help."}, {"owner": {"reputation": 27, "user_id": 7443167, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-QIwbQ1BlOi4/AAAAAAAAAAI/AAAAAAAAA4g/5L4LYAxGkV4/photo.jpg?sz=128", "display_name": "Nabeela Van", "link": "https://stackoverflow.com/users/7443167/nabeela-van"}, "edited": false, "score": 0, "creation_date": 1490042678, "post_id": 42836651, "comment_id": 72926417, "body": "Yay, Fadi the code is working. I resaved and that helped. Thank you. But please see the column change for B that I made in my original code. How do I account for that change in this new code that you gave me? Thanks a ton!"}, {"owner": {"reputation": 27, "user_id": 7443167, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-QIwbQ1BlOi4/AAAAAAAAAAI/AAAAAAAAA4g/5L4LYAxGkV4/photo.jpg?sz=128", "display_name": "Nabeela Van", "link": "https://stackoverflow.com/users/7443167/nabeela-van"}, "edited": false, "score": 0, "creation_date": 1490043179, "post_id": 42836651, "comment_id": 72926672, "body": "Also, the rows are filling in Route_sheet from the 3rd and onwards. First two are totally blank. What would be the reason for that? Though all the data is copied. But that is a small issue I might just hide those two rows."}, {"owner": {"reputation": 3088, "user_id": 4039286, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/vOSnz.jpg?s=128&g=1", "display_name": "Fadi", "link": "https://stackoverflow.com/users/4039286/fadi"}, "reply_to_user": {"reputation": 27, "user_id": 7443167, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-QIwbQ1BlOi4/AAAAAAAAAAI/AAAAAAAAA4g/5L4LYAxGkV4/photo.jpg?sz=128", "display_name": "Nabeela Van", "link": "https://stackoverflow.com/users/7443167/nabeela-van"}, "edited": false, "score": 0, "creation_date": 1490043506, "post_id": 42836651, "comment_id": 72926825, "body": "@NabeelaVan, yes it will start from the second (not 3rd) row if there is no data in the sheet  as the first row must have the header (columns name)"}, {"owner": {"reputation": 3088, "user_id": 4039286, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/vOSnz.jpg?s=128&g=1", "display_name": "Fadi", "link": "https://stackoverflow.com/users/4039286/fadi"}, "reply_to_user": {"reputation": 27, "user_id": 7443167, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-QIwbQ1BlOi4/AAAAAAAAAAI/AAAAAAAAA4g/5L4LYAxGkV4/photo.jpg?sz=128", "display_name": "Nabeela Van", "link": "https://stackoverflow.com/users/7443167/nabeela-van"}, "edited": false, "score": 0, "creation_date": 1490044613, "post_id": 42836651, "comment_id": 72927461, "body": "@NabeelaVan, I edited it to start from first row. Maybe you need to delete column &quot;AO&quot; in both sheets to delete the old formulas."}, {"owner": {"reputation": 27, "user_id": 7443167, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-QIwbQ1BlOi4/AAAAAAAAAAI/AAAAAAAAA4g/5L4LYAxGkV4/photo.jpg?sz=128", "display_name": "Nabeela Van", "link": "https://stackoverflow.com/users/7443167/nabeela-van"}, "edited": false, "score": 0, "creation_date": 1490046597, "post_id": 42836651, "comment_id": 72928384, "body": "Thanks very much throughout this!  I&#39;ve a fear that any manual edit on Route Sheet 2 would cause the code to disrupt. For ex: Resizing the table?"}, {"owner": {"reputation": 27, "user_id": 7443167, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-QIwbQ1BlOi4/AAAAAAAAAAI/AAAAAAAAA4g/5L4LYAxGkV4/photo.jpg?sz=128", "display_name": "Nabeela Van", "link": "https://stackoverflow.com/users/7443167/nabeela-van"}, "edited": false, "score": 0, "creation_date": 1490046696, "post_id": 42836651, "comment_id": 72928429, "body": "Yes I think you&#39;re right. I will delete AO. How will this affect the code?  But do I put in same formula again in AO?"}, {"owner": {"reputation": 3088, "user_id": 4039286, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/vOSnz.jpg?s=128&g=1", "display_name": "Fadi", "link": "https://stackoverflow.com/users/4039286/fadi"}, "reply_to_user": {"reputation": 27, "user_id": 7443167, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-QIwbQ1BlOi4/AAAAAAAAAAI/AAAAAAAAA4g/5L4LYAxGkV4/photo.jpg?sz=128", "display_name": "Nabeela Van", "link": "https://stackoverflow.com/users/7443167/nabeela-van"}, "edited": false, "score": 0, "creation_date": 1490046935, "post_id": 42836651, "comment_id": 72928530, "body": "No, Just  run the <code>Sub Test()</code> in my answer to create the formulas again (run it only one time)."}, {"owner": {"reputation": 27, "user_id": 7443167, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-QIwbQ1BlOi4/AAAAAAAAAAI/AAAAAAAAA4g/5L4LYAxGkV4/photo.jpg?sz=128", "display_name": "Nabeela Van", "link": "https://stackoverflow.com/users/7443167/nabeela-van"}, "edited": false, "score": 0, "creation_date": 1490643411, "post_id": 42836651, "comment_id": 73194551, "body": "Sorry about this question. But if I am adding a column after T in Master sheet, why is it interrupting the code? :("}, {"owner": {"reputation": 3088, "user_id": 4039286, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/vOSnz.jpg?s=128&g=1", "display_name": "Fadi", "link": "https://stackoverflow.com/users/4039286/fadi"}, "reply_to_user": {"reputation": 27, "user_id": 7443167, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-QIwbQ1BlOi4/AAAAAAAAAAI/AAAAAAAAA4g/5L4LYAxGkV4/photo.jpg?sz=128", "display_name": "Nabeela Van", "link": "https://stackoverflow.com/users/7443167/nabeela-van"}, "edited": false, "score": 1, "creation_date": 1490652440, "post_id": 42836651, "comment_id": 73198852, "body": "@NabeelaVan, when you insert new column before column <code>AO</code> this column will shift to right so now the column that contain the formulas is <code>AP</code>, the same thing happen if you delete a column, all columns after it will shift to left. before insert or delete columns you need to disable events then insert or delete columns then update the code to refer to new address (for example <code>hC = &quot;AP&quot;</code>) then enable events again."}, {"owner": {"reputation": 27, "user_id": 7443167, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-QIwbQ1BlOi4/AAAAAAAAAAI/AAAAAAAAA4g/5L4LYAxGkV4/photo.jpg?sz=128", "display_name": "Nabeela Van", "link": "https://stackoverflow.com/users/7443167/nabeela-van"}, "edited": false, "score": 0, "creation_date": 1490983250, "post_id": 42836651, "comment_id": 73371327, "body": "Yes, I did that please see the edited code with date 3_31_2017. However, there are no changes on the route sheet when data is entered into the master. Not for any columns. I am trying though."}, {"owner": {"reputation": 3088, "user_id": 4039286, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/vOSnz.jpg?s=128&g=1", "display_name": "Fadi", "link": "https://stackoverflow.com/users/4039286/fadi"}, "reply_to_user": {"reputation": 27, "user_id": 7443167, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-QIwbQ1BlOi4/AAAAAAAAAAI/AAAAAAAAA4g/5L4LYAxGkV4/photo.jpg?sz=128", "display_name": "Nabeela Van", "link": "https://stackoverflow.com/users/7443167/nabeela-van"}, "edited": false, "score": 1, "creation_date": 1490983547, "post_id": 42836651, "comment_id": 73371469, "body": "@NabeelaVan, make sure to enable events again <code>Application.EnableEvents = True</code>."}, {"owner": {"reputation": 27, "user_id": 7443167, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-QIwbQ1BlOi4/AAAAAAAAAAI/AAAAAAAAA4g/5L4LYAxGkV4/photo.jpg?sz=128", "display_name": "Nabeela Van", "link": "https://stackoverflow.com/users/7443167/nabeela-van"}, "edited": false, "score": 1, "creation_date": 1491846589, "post_id": 42836651, "comment_id": 73723812, "body": "Thank you! It all worked out! You&#39;re a life saver :)"}], "tags": [], "owner": {"reputation": 3088, "user_id": 4039286, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/vOSnz.jpg?s=128&g=1", "display_name": "Fadi", "link": "https://stackoverflow.com/users/4039286/fadi"}, "is_accepted": true, "score": 0, "last_activity_date": 1490044564, "last_edit_date": 1490044564, "creation_date": 1489673884, "answer_id": 42836651, "question_id": 42811757, "link": "https://stackoverflow.com/questions/42811757/vba-for-matching-sheet-1-columns-to-sheet-2-columns/42836651#42836651", "title": "VBA for matching Sheet 1 columns to Sheet 2 columns", "body": "<p>We need at least one thing to know that <code>row(x)</code> in <code>Sheet 1</code> is related to <code>row(y)</code> in <code>Sheet 2</code>. this can be done by adding unique identifier for each row as @tigeravatar mentioned or by adding one formula in unused column in <code>row(x)</code> in <code>Sheet 1</code> relating to <code>row(y)</code> in <code>Sheet 2</code>.</p>\n\n<p>In <code>Sheet 1</code> Module add this:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n   Dim Rng As Range, Rc As Range, R As Long\n   Dim hC As String, Lr As Long\n   Dim Ws2 As Worksheet\n\n   On Error GoTo mExit\n\n   Set Ws2 = Worksheets(\"Sheet 2\")\n   hC = \"U\" 'Change this to any unused column and You can hide it\n\n   Application.EnableEvents = False\n   Set Rng = Application.Intersect(Target, Columns(\"A:T\"))\n\n   If Not Rng Is Nothing Then\n      For Each Rc In Rng.Rows\n\n        R = Rc.Row\n        If Range(hC &amp; R).HasFormula Then\n            Lr = Ws2.Range(Range(hC &amp; R).Formula).Row\n        Else\n            With Ws2\n               Lr = .Range(hC &amp; .Rows.Count).End(xlUp).Row + 1\n               Range(hC &amp; R).Formula = \"='\" &amp; .Name &amp; \"'!\" &amp; hC &amp; Lr\n            End With\n        End If\n\n        With Ws2\n           ' Add here all columns you need like :\n           '=====================================\n           .Range(\"C\" &amp; Lr).Value = Range(\"A\" &amp; R).Value\n           .Range(\"A\" &amp; Lr).Value = Range(\"B\" &amp; R).Value\n           '...etc\n           '=====================================\n           .Range(hC &amp; Lr).Value = \"Related\"\n        End With\n\n      Next\n   End If\n\nmExit:    \n   Application.EnableEvents = True\nEnd Sub\n</code></pre>\n\n<p><strong>Edit:</strong><br>\nRight click on \"Master\" sheet tab and select <code>View Code</code> and paste this code in it:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n   Dim Rng As Range, Rc As Range, R As Long\n   Dim hC As String, Lr As Long\n   Dim Ws2 As Worksheet\n\n   On Error GoTo mExit\n\n   Set Ws2 = Worksheets(\"Sheet 2\") 'Change \"Sheet 2\" to your target sheet name like \"Route_Sheet\" or \"Lists\"\n   hC = \"AO\"\n\n   Application.EnableEvents = False\n   Set Rng = Application.Intersect(Target, Columns(\"A:AH\"))\n\n   If Not Rng Is Nothing Then\n      For Each Rc In Rng.Rows\n\n        R = Rc.Row\n        If Range(hC &amp; R).HasFormula Then\n            Lr = Ws2.Range(Range(hC &amp; R).Formula).Row\n        Else\n            With Ws2\n               Lr = .Range(hC &amp; .Rows.Count).End(xlUp).Row\n               If Not (Lr = 1 And .Range(hC &amp; Lr).Value = vbNullString) Then Lr = Lr + 1                              \n               Range(hC &amp; R).Formula = \"='\" &amp; .Name &amp; \"'!\" &amp; hC &amp; Lr\n            End With\n        End If\n\n        With Ws2\n            .Range(\"B\" &amp; Lr).Value = Range(\"A\" &amp; R).Value\n            .Range(.Cells(Lr, \"C\"), .Cells(Lr, \"J\")).Value = Range(Cells(R, \"C\"), Cells(R, \"J\")).Value\n            .Range(.Cells(Lr, \"L\"), .Cells(Lr, \"O\")).Value = Range(Cells(R, \"K\"), Cells(R, \"N\")).Value\n            .Range(\"K\" &amp; Lr).Value = Range(\"AH\" &amp; R).Value\n            .Range(\"P\" &amp; Lr).Value = Range(\"AA\" &amp; R).Value\n\n            .Range(hC &amp; Lr).Value = \"Related\"\n\n        End With\n\n      Next\n   End If\n\nmExit:\n   Application.EnableEvents = True\nEnd Sub\n</code></pre>\n\n<p>This is a Worksheet Event that run automatically when user change any cell inside Columns(\"A:AH\").</p>\n\n<p>If you want to run it manually you can add new sub in <code>Module1</code>:</p>\n\n<pre><code>Sub Test()\n With sheets(\"Master\").Range(\"A2:A50\") ' change this range to all rows you need like \"A5:A100\"\n  .Value = .Value\n End With\nEnd Sub\n</code></pre>\n\n<p>Or: </p>\n\n<pre><code>Sub Test()\n With Sheets(\"Master\")\n  Application.Run .CodeName &amp; \".Worksheet_Change\", .Range(\"A1:A50\") 'change this range to all rows you need like \"A5:A100\"\n End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 27, "user_id": 7443167, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-QIwbQ1BlOi4/AAAAAAAAAAI/AAAAAAAAA4g/5L4LYAxGkV4/photo.jpg?sz=128", "display_name": "Nabeela Van", "link": "https://stackoverflow.com/users/7443167/nabeela-van"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 970, "favorite_count": 0, "accepted_answer_id": 42836651, "answer_count": 1, "score": 1, "last_activity_date": 1490983078, "creation_date": 1489585890, "last_edit_date": 1490983078, "question_id": 42811757, "link": "https://stackoverflow.com/questions/42811757/vba-for-matching-sheet-1-columns-to-sheet-2-columns", "title": "VBA for matching Sheet 1 columns to Sheet 2 columns", "body": "<p><a href=\"https://i.stack.imgur.com/nOW42.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/nOW42.jpg\" alt=\"Please see how Macro doesn&#39;t show\"></a><a href=\"https://i.stack.imgur.com/FOZjp.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/FOZjp.jpg\" alt=\"Please see where I have added the code--Sheet 4 (aka Master Sheet) Module\"></a>Sheet 1 has columns A-T. Some columns of Sheet 1 have formulas and others have a dropdown list.\nSheet 2 has columns A-P. I want to be able to paste the Sheet 1 data in Sheet 2-- The data generated as a result of formulas and drop downs. Also in a way, that if I change anything in Sheet 1 it changes on the other sheet. I want to be able to do this for multiple columns.\nThe thing is that Sheet 1 and Sheet 2 columns are not true to each other. I mean Column A of Sheet 1 is Column C in Sheet 2 etc.. </p>\n\n<p>Right now, I have simply equaled the cells using formula on both sheets to make this work. I don't wish to continue it this way. Macro will be better.</p>\n\n<p>Thank you! Please help.</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\nDim Rng As Range, Rc As Range, R As Long\n   Dim hC As String, Lr As Long\n   Dim Ws2 As Worksheet\n\n   On Error GoTo mExit\n\n   Set Ws2 = Worksheets(\"Sheet 2\")\n   hC = \"AO\"\n\n   Application.EnableEvents = False\n   Set Rng = Application.Intersect(Target, Columns(\"A:T\"))\n\n   If Not Rng Is Nothing Then\n      For Each Rc In Rng.Rows\n\n        R = Rc.Row\n        If Range(hC &amp; R).HasFormula Then\n            Lr = Ws2.Range(Range(hC &amp; R).Formula).Row\n        Else\n            With Ws2\n               Lr = .Range(hC &amp; .Rows.Count).End(xlUp).Row + 1\n               Range(hC &amp; R).Formula = \"='\" &amp; .Name &amp; \"'!\" &amp; hC &amp; Lr\n            End With\n        End If\n\n        With Ws2\n           .Range(\"B\" &amp; Lr).Value = Range(\"A\" &amp; R).Value\n           .Range(\"C\" &amp; Lr).Value = Range(\"C\" &amp; R).Value\n           .Range(\"D\" &amp; Lr).Value = Range(\"D\" &amp; R).Value\n           .Range(\"E\" &amp; Lr).Value = Range(\"E\" &amp; R).Value\n           .Range(\"F\" &amp; Lr).Value = Range(\"F\" &amp; R).Value\n           .Range(\"G\" &amp; Lr).Value = Range(\"G\" &amp; R).Value\n           .Range(\"H\" &amp; Lr).Value = Range(\"H\" &amp; R).Value\n           .Range(\"I\" &amp; Lr).Value = Range(\"I\" &amp; R).Value\n           .Range(\"J\" &amp; Lr).Value = Range(\"J\" &amp; R).Value\n           .Range(\"K\" &amp; Lr).Value = Range(\"AH\" &amp; R).Value\n           .Range(\"L\" &amp; Lr).Value = Range(\"K\" &amp; R).Value\n           .Range(\"M\" &amp; Lr).Value = Range(\"L\" &amp; R).Value\n           .Range(\"N\" &amp; Lr).Value = Range(\"M\" &amp; R).Value\n           .Range(\"O\" &amp; Lr).Value = Range(\"N\" &amp; R).Value\n           .Range(\"P\" &amp; Lr).Value = Range(\"AA\" &amp; R).Value\n           .Range(hC &amp; Lr).Value = \"Related\"\n\n        End With\n\n      Next\n   End If\n\nmExit:\n   Application.EnableEvents = True\nEnd Sub\n</code></pre>\n\n<p>Edited Code (3_31_3017)</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n   Dim Rng As Range, Rc As Range, R As Long\n   Dim hC As String, Lr As Long\n   Dim Ws2 As Worksheet\n\n   On Error GoTo mExit\n\n   Set Ws2 = Worksheets(\"Route_Sheet\")\n   hC = \"AP\"\n\n   Application.EnableEvents = False\n   Set Rng = Application.Intersect(Target, Columns(\"A:AL\"))\n\n   If Not Rng Is Nothing Then\n      For Each Rc In Rng.Rows\n\n        R = Rc.Row\n        If Range(hC &amp; R).HasFormula Then\n            Lr = Ws2.Range(Range(hC &amp; R).Formula).Row\n        Else\n            With Ws2\n               Lr = .Range(hC &amp; .Rows.Count).End(xlUp).Row + 1\n               Range(hC &amp; R).Formula = \"='\" &amp; .Name &amp; \"'!\" &amp; hC &amp; Lr\n            End With\n        End If\n\n        With Ws2\n            .Range(\"B\" &amp; Lr).Value = Range(\"A\" &amp; R).Value\n            .Range(.Cells(Lr, \"C\"), .Cells(Lr, \"J\")).Value = Range(Cells(R, \"C\"), Cells(R, \"J\")).Value\n            .Range(.Cells(Lr, \"L\"), .Cells(Lr, \"O\")).Value = Range(Cells(R, \"K\"), Cells(R, \"N\")).Value\n            .Range(\"K\" &amp; Lr).Value = Range(\"AH\" &amp; R).Value\n            .Range(\"P\" &amp; Lr).Value = Range(\"AA\" &amp; R).Value\n            .Range(\"Q\" &amp; Lr).Value = Range(\"U\" &amp; R).Value\n            .Range(hC &amp; Lr).Value = \"Related\"\n            End With\n\n      Next\n   End If\n\nmExit:\n   Application.EnableEvents = True\nEnd Sub\n</code></pre>\n"}, {"tags": ["image", "vba", "hyperlink", "add"], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 7715365, "user_type": "registered", "profile_image": "https://graph.facebook.com/10210069702633840/picture?type=large", "display_name": "AK1991IT", "link": "https://stackoverflow.com/users/7715365/ak1991it"}, "edited": false, "score": 0, "creation_date": 1489593153, "post_id": 42813997, "comment_id": 72741594, "body": "Cheers! That was useful. Set it as oShape and applied link like you did here."}], "tags": [], "owner": {"reputation": 816, "user_id": 5143876, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/36f1aaff08162453b0791065c9a44b14?s=128&d=identicon&r=PG&f=1", "display_name": "Jbjstam", "link": "https://stackoverflow.com/users/5143876/jbjstam"}, "is_accepted": true, "score": 0, "last_activity_date": 1489591471, "creation_date": 1489591471, "answer_id": 42813997, "question_id": 42811655, "link": "https://stackoverflow.com/questions/42811655/how-do-i-add-a-hyperlinks-to-image-using-vba/42813997#42813997", "title": "How do I add a hyperlinks to image using VBA?", "body": "<p>Assuming this is about Word, you need to save a reference the shape you just created and then use that reference as an argument to Document.Hyperlinks.Add</p>\n\n<pre><code>Option Explicit\n\nSub LinkImageTest()\n    Dim oSelection As Selection\n    Dim oDocument As Document\n    Dim oShape As InlineShape\n\n    Set oSelection = Application.Selection\n    Set oDocument = oSelection.Document\n\n    Set oShape = oSelection.InlineShapes.AddPicture(\"https://yt3.ggpht.com/-Pde_zs2tuj0/AAAAAAAAAAI/AAAAAAAAAAA/iBq9KSwTTLk/s88-c-k-no-mo-rj-c0xffffff/photo.jpg\")\n\n    oDocument.Hyperlinks.Add oShape, \"http://www.microsoft.com\"\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 7715365, "user_type": "registered", "profile_image": "https://graph.facebook.com/10210069702633840/picture?type=large", "display_name": "AK1991IT", "link": "https://stackoverflow.com/users/7715365/ak1991it"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1769, "favorite_count": 0, "protected_date": 1569346376, "accepted_answer_id": 42813997, "answer_count": 1, "score": 1, "last_activity_date": 1569346388, "creation_date": 1489585662, "last_edit_date": 1569346388, "question_id": 42811655, "link": "https://stackoverflow.com/questions/42811655/how-do-i-add-a-hyperlinks-to-image-using-vba", "title": "How do I add a hyperlinks to image using VBA?", "body": "<p>I have a script that will run on GPO on Windows Server 2012.</p>\n\n<p>It's pretty simple stuff, but I cannot fathom how to add a hyperlink around an image! I have:</p>\n\n<p><code>objSelection.InlineShapes.AddPicture \"linktoimage.html\"</code></p>\n\n<p>This works a dream, I can see the image and there is no issue. But how do I add a hyperlink to this image so that when folks click on it they are taken to my desired hyperlink location. I know adding an image is simply a line of code, hoping for same for adding a hyperlink.</p>\n\n<p>I am not doing this in excel or anything of the kind, just Notepad++</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1489585491, "post_id": 42811509, "comment_id": 72735177, "body": "Does <a href=\"http://stackoverflow.com/a/11991419/4650297\">this thread</a> help?  Or perhaps <a href=\"https://www.mrexcel.com/forum/excel-questions/45786-if-clause-visual-basic-applications-look-checkbox-if-its-checked-not.html\" rel=\"nofollow noreferrer\">this one</a>?"}, {"owner": {"reputation": 1337, "user_id": 2999781, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/kYD9I.gif?s=128&g=1", "display_name": "Jiminy Cricket", "link": "https://stackoverflow.com/users/2999781/jiminy-cricket"}, "edited": false, "score": 0, "creation_date": 1489585581, "post_id": 42811509, "comment_id": 72735237, "body": "Is your checkbox on a worksheet or a form? Is it an ActiveX control or a Form control if it&#39;s on a worksheet?"}, {"owner": {"reputation": 177, "user_id": 7443078, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/2c1584d62ac86e07b29a52ace8307f9d?s=128&d=identicon&r=PG&f=1", "display_name": "Olivia", "link": "https://stackoverflow.com/users/7443078/olivia"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1489585666, "post_id": 42811509, "comment_id": 72735292, "body": "@BruceWayne: I am having trouble opening the link!!!"}, {"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "reply_to_user": {"reputation": 1337, "user_id": 2999781, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/kYD9I.gif?s=128&g=1", "display_name": "Jiminy Cricket", "link": "https://stackoverflow.com/users/2999781/jiminy-cricket"}, "edited": false, "score": 1, "creation_date": 1489585682, "post_id": 42811509, "comment_id": 72735302, "body": "@JiminyCricket A lot of people don&#39;t know the difference and thus are unaware which one they implemented. Hence, I always try to include the following link: <a href=\"http://stackoverflow.com/questions/15455179/what-is-the-difference-between-form-controls-and-activex-control-in-excel-20\" title=\"what is the difference between form controls and activex control in excel 20\">stackoverflow.com/questions/15455179/&hellip;</a>"}, {"owner": {"reputation": 177, "user_id": 7443078, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/2c1584d62ac86e07b29a52ace8307f9d?s=128&d=identicon&r=PG&f=1", "display_name": "Olivia", "link": "https://stackoverflow.com/users/7443078/olivia"}, "reply_to_user": {"reputation": 1337, "user_id": 2999781, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/kYD9I.gif?s=128&g=1", "display_name": "Jiminy Cricket", "link": "https://stackoverflow.com/users/2999781/jiminy-cricket"}, "edited": false, "score": 0, "creation_date": 1489585710, "post_id": 42811509, "comment_id": 72735322, "body": "@JiminyCricket: My checkbox is on the worksheet. And it is Form Control."}], "answers": [{"comments": [{"owner": {"reputation": 177, "user_id": 7443078, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/2c1584d62ac86e07b29a52ace8307f9d?s=128&d=identicon&r=PG&f=1", "display_name": "Olivia", "link": "https://stackoverflow.com/users/7443078/olivia"}, "edited": false, "score": 0, "creation_date": 1489586037, "post_id": 42811741, "comment_id": 72735602, "body": "When I try to use this code, it gives me &#39;method or data member not found&#39; error on the very first line!"}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "reply_to_user": {"reputation": 177, "user_id": 7443078, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/2c1584d62ac86e07b29a52ace8307f9d?s=128&d=identicon&r=PG&f=1", "display_name": "Olivia", "link": "https://stackoverflow.com/users/7443078/olivia"}, "edited": false, "score": 0, "creation_date": 1489586134, "post_id": 42811741, "comment_id": 72735687, "body": "@Pooja : Do you mean <code>Sub CheckBox1_Click()</code> or <code>If Me.CheckBox1.Value </code>?"}, {"owner": {"reputation": 177, "user_id": 7443078, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/2c1584d62ac86e07b29a52ace8307f9d?s=128&d=identicon&r=PG&f=1", "display_name": "Olivia", "link": "https://stackoverflow.com/users/7443078/olivia"}, "edited": false, "score": 0, "creation_date": 1489586315, "post_id": 42811741, "comment_id": 72735862, "body": "I meant <code>Sub CheckBox1_Click()</code> This is where it gives the error &#39;method or data member not found&#39;"}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "reply_to_user": {"reputation": 177, "user_id": 7443078, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/2c1584d62ac86e07b29a52ace8307f9d?s=128&d=identicon&r=PG&f=1", "display_name": "Olivia", "link": "https://stackoverflow.com/users/7443078/olivia"}, "edited": false, "score": 0, "creation_date": 1489586472, "post_id": 42811741, "comment_id": 72736014, "body": "@Pooja : My bad, I thought that by default the code of the form would be place in the sheet&#39;s module, but it isn&#39;t! I&#39;ll edit my answer! ;)"}, {"owner": {"reputation": 177, "user_id": 7443078, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/2c1584d62ac86e07b29a52ace8307f9d?s=128&d=identicon&r=PG&f=1", "display_name": "Olivia", "link": "https://stackoverflow.com/users/7443078/olivia"}, "edited": false, "score": 0, "creation_date": 1489587189, "post_id": 42811741, "comment_id": 72736593, "body": "Now it gives me another error <code>Sub CheckBox1_Click()  Dim xRng As Range  Set xRng = Selection  If Me.CheckBox1_Click.Value Then  xRng.Interior.Color = vbGreen  Else  xRng.Interior.Color = xlNone  End If  End Sub</code> The error is &#39;Expected Function or Variable&#39; for .CheckBox1_Click"}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "reply_to_user": {"reputation": 177, "user_id": 7443078, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/2c1584d62ac86e07b29a52ace8307f9d?s=128&d=identicon&r=PG&f=1", "display_name": "Olivia", "link": "https://stackoverflow.com/users/7443078/olivia"}, "edited": false, "score": 0, "creation_date": 1489587524, "post_id": 42811741, "comment_id": 72736891, "body": "@Pooja : You used <code>Me.CheckBox1_Click.Value</code> <b>in your test</b> <code>If Me.CheckBox1_Click.Value Then</code>, you forgot to <b>get rid of the <code>_Click</code></b> when copying! ;) Take a closer look at my answer, it should be <code>If Me.CheckBox1.Value Then</code> ;)"}, {"owner": {"reputation": 177, "user_id": 7443078, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/2c1584d62ac86e07b29a52ace8307f9d?s=128&d=identicon&r=PG&f=1", "display_name": "Olivia", "link": "https://stackoverflow.com/users/7443078/olivia"}, "edited": false, "score": 0, "creation_date": 1489588095, "post_id": 42811741, "comment_id": 72737360, "body": "Oh! I am so sorry! My bad. But, now I changed it and getting the error &#39;method or data member not found&#39; on .CheckBox1"}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "reply_to_user": {"reputation": 177, "user_id": 7443078, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/2c1584d62ac86e07b29a52ace8307f9d?s=128&d=identicon&r=PG&f=1", "display_name": "Olivia", "link": "https://stackoverflow.com/users/7443078/olivia"}, "edited": false, "score": 0, "creation_date": 1489588265, "post_id": 42811741, "comment_id": 72737496, "body": "@Pooja : If you use <code>Me.CheckBox1.Value</code> is the code in the sheet&#39;s module? If not, try to move it there or try the 1st part of my answer."}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "reply_to_user": {"reputation": 177, "user_id": 7443078, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/2c1584d62ac86e07b29a52ace8307f9d?s=128&d=identicon&r=PG&f=1", "display_name": "Olivia", "link": "https://stackoverflow.com/users/7443078/olivia"}, "edited": false, "score": 0, "creation_date": 1489588964, "post_id": 42811741, "comment_id": 72738109, "body": "@Pooja : Try the edit! It&#39;s working smoothly for me! ;)"}, {"owner": {"reputation": 177, "user_id": 7443078, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/2c1584d62ac86e07b29a52ace8307f9d?s=128&d=identicon&r=PG&f=1", "display_name": "Olivia", "link": "https://stackoverflow.com/users/7443078/olivia"}, "edited": false, "score": 0, "creation_date": 1489589710, "post_id": 42811741, "comment_id": 72738710, "body": "Thank you so much for the help! Now I am able to run the macro using Ralph&#39;s code"}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "reply_to_user": {"reputation": 177, "user_id": 7443078, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/2c1584d62ac86e07b29a52ace8307f9d?s=128&d=identicon&r=PG&f=1", "display_name": "Olivia", "link": "https://stackoverflow.com/users/7443078/olivia"}, "edited": false, "score": 0, "creation_date": 1489589945, "post_id": 42811741, "comment_id": 72738894, "body": "@Pooja : You are welcome, you can upvote as many posts as you want so don&#39;t hesitate! ;) But accept Ralph&#39;s one! ;)"}], "tags": [], "owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "is_accepted": false, "score": 1, "last_activity_date": 1489588945, "last_edit_date": 1489588945, "creation_date": 1489585862, "answer_id": 42811741, "question_id": 42811509, "link": "https://stackoverflow.com/questions/42811509/object-required-error-when-trying-to-refer-to-checkbox-in-worksheet/42811741#42811741", "title": "&#39;Object Required&#39; Error when trying to refer to CheckBox in worksheet", "body": "<p>By default the code for such a control is placed in a regular module,<br> so you'll have to specify the sheet (change <code>Sheet's name</code>) on which your control is placed :</p>\n\n<pre><code>Sub CheckBox1_Click()    \nDim xRng As Range\nSet xRng = Selection\n\nIf  ThisWorkBook.Sheets(\"Sheet's name\").Shapes(\"Check Box 1\").ControlFormat.Value = 1 Then\n    xRng.Interior.Color = vbGreen\nElse\n    xRng.Interior.Color = xlNone\nEnd If\n\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p>If you place that code in the sheet's module where the checkbox is,<br>\nthe easiest way to fix this would be to try adding <code>Me</code>:</p>\n\n<pre><code>Sub CheckBox1_Click()    \nDim xRng As Range\nSet xRng = Selection\n\nIf Me.Shapes(\"Check Box 1\").ControlFormat.Value = 1 Then\n    xRng.Interior.Color = vbGreen\nElse\n    xRng.Interior.Color = xlNone\nEnd If\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 177, "user_id": 7443078, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/2c1584d62ac86e07b29a52ace8307f9d?s=128&d=identicon&r=PG&f=1", "display_name": "Olivia", "link": "https://stackoverflow.com/users/7443078/olivia"}, "edited": false, "score": 0, "creation_date": 1489586754, "post_id": 42811946, "comment_id": 72736254, "body": "This code gives me another error! <code>Sub CheckBox1_Click()  Dim xRng As Range Set xRng = Selection If Worksheets(&quot;Sheet1&quot;).CheckBoxes(&quot;Checkbox1&quot;).Value = 1 Then &#39;Here is the error Allication-defined or object-defined error xRng.Interior.Color = vbGreen Else xRng.Interior.Color = xlNone End If End Sub</code>"}, {"owner": {"reputation": 177, "user_id": 7443078, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/2c1584d62ac86e07b29a52ace8307f9d?s=128&d=identicon&r=PG&f=1", "display_name": "Olivia", "link": "https://stackoverflow.com/users/7443078/olivia"}, "edited": false, "score": 0, "creation_date": 1489586970, "post_id": 42811946, "comment_id": 72736442, "body": "Sorry for the messy presentation. I just clicked enter so it got posted. I hope you can understand!"}, {"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "reply_to_user": {"reputation": 177, "user_id": 7443078, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/2c1584d62ac86e07b29a52ace8307f9d?s=128&d=identicon&r=PG&f=1", "display_name": "Olivia", "link": "https://stackoverflow.com/users/7443078/olivia"}, "edited": false, "score": 0, "creation_date": 1489587050, "post_id": 42811946, "comment_id": 72736494, "body": "Did you change <code>Sheet2</code> and <code>Check Box 1</code> according to the actual names you have in your Excel file?"}, {"owner": {"reputation": 177, "user_id": 7443078, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/2c1584d62ac86e07b29a52ace8307f9d?s=128&d=identicon&r=PG&f=1", "display_name": "Olivia", "link": "https://stackoverflow.com/users/7443078/olivia"}, "edited": false, "score": 0, "creation_date": 1489587371, "post_id": 42811946, "comment_id": 72736759, "body": "Yes I did change it the respective names I am using!"}, {"owner": {"reputation": 177, "user_id": 7443078, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/2c1584d62ac86e07b29a52ace8307f9d?s=128&d=identicon&r=PG&f=1", "display_name": "Olivia", "link": "https://stackoverflow.com/users/7443078/olivia"}, "edited": false, "score": 1, "creation_date": 1489589554, "post_id": 42811946, "comment_id": 72738587, "body": "Thank you so much! I am able to run the code now! I was using the edited text name as my checkbox name in the code and not its original name!"}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "reply_to_user": {"reputation": 177, "user_id": 7443078, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/2c1584d62ac86e07b29a52ace8307f9d?s=128&d=identicon&r=PG&f=1", "display_name": "Olivia", "link": "https://stackoverflow.com/users/7443078/olivia"}, "edited": false, "score": 1, "creation_date": 1489589887, "post_id": 42811946, "comment_id": 72738847, "body": "@Pooja : In order : <b>Take the <a href=\"https://stackoverflow.com/tour\">tour</a> (click it)</b>, Accept and upvote this awesome answer and go back to your profile to do the same on helpful answers on your previous questions! ;)"}], "tags": [], "owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "is_accepted": true, "score": 2, "last_activity_date": 1489588673, "last_edit_date": 1489588673, "creation_date": 1489586346, "answer_id": 42811946, "question_id": 42811509, "link": "https://stackoverflow.com/questions/42811509/object-required-error-when-trying-to-refer-to-checkbox-in-worksheet/42811946#42811946", "title": "&#39;Object Required&#39; Error when trying to refer to CheckBox in worksheet", "body": "<p>It seems to me that this is what you want:</p>\n\n<pre><code>Sub CheckBox1_Click()\nDim xRng As Range\nSet xRng = Selection\n\nIf Worksheets(\"Sheet2\").CheckBoxes(\"Check Box 1\").Value = 1 Then\n    xRng.Interior.Color = vbGreen\nElse\n    xRng.Interior.Color = xlNone\nEnd If\n\nEnd Sub\n</code></pre>\n\n<p><sub>Don't forget to adjust the names <code>Sheet2</code> and <code>Check Box 1</code> to the actual names in your file.</sub></p>\n\n<p>Here is a step-by-step video solution:</p>\n\n<p><a href=\"https://i.stack.imgur.com/8j5ur.gif\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/8j5ur.gif\" alt=\"enter image description here\"></a></p>\n"}, {"comments": [{"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1489587491, "post_id": 42812096, "comment_id": 72736858, "body": "@Pooja, did you try this solution?"}, {"owner": {"reputation": 177, "user_id": 7443078, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/2c1584d62ac86e07b29a52ace8307f9d?s=128&d=identicon&r=PG&f=1", "display_name": "Olivia", "link": "https://stackoverflow.com/users/7443078/olivia"}, "edited": false, "score": 0, "creation_date": 1489587504, "post_id": 42812096, "comment_id": 72736871, "body": "I just tried this code. It gives me the error &#39;Application-defined or object-defined error&#39;"}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "reply_to_user": {"reputation": 177, "user_id": 7443078, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/2c1584d62ac86e07b29a52ace8307f9d?s=128&d=identicon&r=PG&f=1", "display_name": "Olivia", "link": "https://stackoverflow.com/users/7443078/olivia"}, "edited": false, "score": 2, "creation_date": 1489587588, "post_id": 42812096, "comment_id": 72736962, "body": "then either it&#39;s not a <i>Form</i> checkbox (but rather an <i>ActiveX</i> one), or it&#39;s not called &quot;CheckBox1&quot;. Please check it out and let me know"}, {"owner": {"reputation": 177, "user_id": 7443078, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/2c1584d62ac86e07b29a52ace8307f9d?s=128&d=identicon&r=PG&f=1", "display_name": "Olivia", "link": "https://stackoverflow.com/users/7443078/olivia"}, "edited": false, "score": 0, "creation_date": 1489587904, "post_id": 42812096, "comment_id": 72737231, "body": "I am sure about it being a form control. And, when I inserted the checkbox its name was &#39;Check Box 1&#39;. I edited its name to &#39;CheckBox1&#39; which we are using to write the code."}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "reply_to_user": {"reputation": 177, "user_id": 7443078, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/2c1584d62ac86e07b29a52ace8307f9d?s=128&d=identicon&r=PG&f=1", "display_name": "Olivia", "link": "https://stackoverflow.com/users/7443078/olivia"}, "edited": false, "score": 0, "creation_date": 1489588080, "post_id": 42812096, "comment_id": 72737346, "body": "what you depicted is precisely my testing enevironment. try selecting your checkbox (right click on it), type in Immediate Window <code>?typename(selection)</code>, press return and see the returned value"}, {"owner": {"reputation": 177, "user_id": 7443078, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/2c1584d62ac86e07b29a52ace8307f9d?s=128&d=identicon&r=PG&f=1", "display_name": "Olivia", "link": "https://stackoverflow.com/users/7443078/olivia"}, "edited": false, "score": 0, "creation_date": 1489588327, "post_id": 42812096, "comment_id": 72737545, "body": "When I right click on the checkbox, I cannot find any immediate window where I can type in! The right click just opens up the cut, copy, paste, format control, etc. drop down!"}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "reply_to_user": {"reputation": 177, "user_id": 7443078, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/2c1584d62ac86e07b29a52ace8307f9d?s=128&d=identicon&r=PG&f=1", "display_name": "Olivia", "link": "https://stackoverflow.com/users/7443078/olivia"}, "edited": false, "score": 0, "creation_date": 1489588463, "post_id": 42812096, "comment_id": 72737672, "body": "you must open your VBA IDE, and pop Immediate Window out by clicking CTRL+G..  And.... what&#39;s that &quot;dropdown&quot; about?"}, {"owner": {"reputation": 177, "user_id": 7443078, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/2c1584d62ac86e07b29a52ace8307f9d?s=128&d=identicon&r=PG&f=1", "display_name": "Olivia", "link": "https://stackoverflow.com/users/7443078/olivia"}, "edited": false, "score": 0, "creation_date": 1489588737, "post_id": 42812096, "comment_id": 72737896, "body": "The returned value is CheckBox"}, {"owner": {"reputation": 177, "user_id": 7443078, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/2c1584d62ac86e07b29a52ace8307f9d?s=128&d=identicon&r=PG&f=1", "display_name": "Olivia", "link": "https://stackoverflow.com/users/7443078/olivia"}, "edited": false, "score": 0, "creation_date": 1489589677, "post_id": 42812096, "comment_id": 72738688, "body": "Thank you so much for the help! Now I am able to run the macro using Ralph&#39;s code"}], "tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": false, "score": 1, "last_activity_date": 1489586764, "creation_date": 1489586764, "answer_id": 42812096, "question_id": 42811509, "link": "https://stackoverflow.com/questions/42811509/object-required-error-when-trying-to-refer-to-checkbox-in-worksheet/42812096#42812096", "title": "&#39;Object Required&#39; Error when trying to refer to CheckBox in worksheet", "body": "<p>I'd go like follows</p>\n\n<pre><code>Sub CheckBox1_Click()\n\n    Selection.Interior.Color = IIf(ActiveSheet.CheckBoxes(\"CheckBox1\").Value = xlOn, vbGreen, 16777215)\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 177, "user_id": 7443078, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/2c1584d62ac86e07b29a52ace8307f9d?s=128&d=identicon&r=PG&f=1", "display_name": "Olivia", "link": "https://stackoverflow.com/users/7443078/olivia"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4618, "favorite_count": 0, "accepted_answer_id": 42811946, "answer_count": 3, "score": 4, "last_activity_date": 1489588945, "creation_date": 1489585218, "last_edit_date": 1489586029, "question_id": 42811509, "link": "https://stackoverflow.com/questions/42811509/object-required-error-when-trying-to-refer-to-checkbox-in-worksheet", "title": "&#39;Object Required&#39; Error when trying to refer to CheckBox in worksheet", "body": "<p>I am trying to write a code in excel vba.</p>\n\n<p>I want to change the color of the user selected cell when the checkbox is checked.</p>\n\n<p>I have already written this code but it gives the 'object required' error on the line marked.</p>\n\n<pre><code>Sub CheckBox1_Click()    \nDim xRng As Range    \nSet xRng = Selection\n\nIf CheckBox1.Value = True Then 'This is the error    \n    xRng.Interior.Color = vbGreen    \nEnd If\n\nIf CheckBox1.Value = False Then    \n    xRng.Interior.Color = xlNone    \nEnd If\n\nEnd Sub\n</code></pre>\n\n<p>Please help me on how to debug this error.\nThanks in advance! :)</p>\n"}, {"tags": ["sql", "vba", "ms-access", "type-mismatch"], "comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1489584754, "post_id": 42811239, "comment_id": 72734603, "body": "if you run the sql in an access query does it work? And what is value of lngEstID when you pass into SQL statement?"}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 0, "creation_date": 1489584903, "post_id": 42811239, "comment_id": 72734732, "body": "Not sure that it&#39;ll fix your issue, because it&#39;s probably done implicitly, but try <code>Set rs = db.OpenRecordset(&quot;SELECT ... = &quot; &amp; CStr(lngEstID) )</code>"}, {"owner": {"reputation": 35, "user_id": 6148694, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/698a696c545df5a2b216a692590d3fb6?s=128&d=identicon&r=PG&f=1", "display_name": "wesp", "link": "https://stackoverflow.com/users/6148694/wesp"}, "edited": false, "score": 0, "creation_date": 1489585249, "post_id": 42811239, "comment_id": 72734997, "body": "Yes, it works in a regular query. What exactly do you mean by the value of lngEstID?(remember I am new to VBA) The value is set to equal Me.EstID. Should the variable be declared as a String instead of Long Int because it is being used to make up a string?"}, {"owner": {"reputation": 35, "user_id": 6148694, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/698a696c545df5a2b216a692590d3fb6?s=128&d=identicon&r=PG&f=1", "display_name": "wesp", "link": "https://stackoverflow.com/users/6148694/wesp"}, "edited": false, "score": 0, "creation_date": 1489585287, "post_id": 42811239, "comment_id": 72735023, "body": "I put in <code>Set rs = db.OpenRecordset(&quot;SELECT tblEstDtl.PartID, tblEstDtl.Qty, tblEstDtl.EstID FROM tblEstDtl &quot; _        &amp; &quot;WHERE tblEstDtl.EstID = &quot; &amp; CStr(lngEstID))</code> and it still gives me the same error."}, {"owner": {"reputation": 4621, "user_id": 4709298, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/fe41ea7cc395df33b3ad744599248d80?s=128&d=identicon&r=PG&f=1", "display_name": "Preston", "link": "https://stackoverflow.com/users/4709298/preston"}, "edited": false, "score": 0, "creation_date": 1489585763, "post_id": 42811239, "comment_id": 72735363, "body": "put &quot;debug.print Me.EstID: stop&quot;  in the code before you hit the code before you get the error.  run the code, what is in the immediates window?"}, {"owner": {"reputation": 35, "user_id": 6148694, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/698a696c545df5a2b216a692590d3fb6?s=128&d=identicon&r=PG&f=1", "display_name": "wesp", "link": "https://stackoverflow.com/users/6148694/wesp"}, "edited": false, "score": 0, "creation_date": 1489586129, "post_id": 42811239, "comment_id": 72735678, "body": "There is a   10  in the immediate window."}, {"owner": {"reputation": 1595, "user_id": 6847949, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00fc40c71814d3ead488ab90ca84bf76?s=128&d=identicon&r=PG&f=1", "display_name": "Minty", "link": "https://stackoverflow.com/users/6847949/minty"}, "edited": false, "score": 0, "creation_date": 1489590364, "post_id": 42811239, "comment_id": 72739242, "body": "Try using <b>Set rs = db.OpenRecordset(&quot;SELECT tblEstDtl.* FROM tblEstDtl;&quot;, dbOpenSnapShot)</b>"}, {"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "edited": false, "score": 0, "creation_date": 1489590615, "post_id": 42811239, "comment_id": 72739429, "body": "DAO is the answer because you also have a (not needed) reference to ADO, thus Access gets confused."}, {"owner": {"reputation": 35, "user_id": 6148694, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/698a696c545df5a2b216a692590d3fb6?s=128&d=identicon&r=PG&f=1", "display_name": "wesp", "link": "https://stackoverflow.com/users/6148694/wesp"}, "edited": false, "score": 0, "creation_date": 1489590733, "post_id": 42811239, "comment_id": 72739548, "body": "Should I or do I need to change something in regards DAO or ADO to help me in the future?"}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1489598838, "post_id": 42811239, "comment_id": 72745391, "body": "On a side note and unrelated to the problem - you can remove the table name from each field in your query as there&#39;s only one table.  You only need to explicitly state the table name if the field appears in more than one table in your query.  So <code>SELECT PartID, Qty, EstID FROM tblEstDtl WHERE EstID = </code> will work."}, {"owner": {"reputation": 35, "user_id": 6148694, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/698a696c545df5a2b216a692590d3fb6?s=128&d=identicon&r=PG&f=1", "display_name": "wesp", "link": "https://stackoverflow.com/users/6148694/wesp"}, "edited": false, "score": 0, "creation_date": 1489601049, "post_id": 42811239, "comment_id": 72746726, "body": "Thank you Darren"}], "owner": {"reputation": 35, "user_id": 6148694, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/698a696c545df5a2b216a692590d3fb6?s=128&d=identicon&r=PG&f=1", "display_name": "wesp", "link": "https://stackoverflow.com/users/6148694/wesp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 125, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1489590650, "creation_date": 1489584596, "last_edit_date": 1489590650, "question_id": 42811239, "link": "https://stackoverflow.com/questions/42811239/runtime-13-data-type-mismatch", "title": "runtime &#39;13&#39; Data type mismatch", "body": "<p>So I have this code which is used to set the stage for a public function:</p>\n\n<pre><code>Private Sub OrderMatbtn_Click()\n   Dim strSQL As String\n   Dim lngPartID As Long\n   Dim db As Database\n   Dim rs As Recordset\n   Dim lngEstID As Long\n   Dim dblQty As Double\n\n   'Set the Estimate ID to the current Estimate\n   lngEstID = Me.EstID\n\n   'Open the Estimate detail as a recordset filtered on lngEstID\n   Set db = CurrentDb()\n   Set rs = db.OpenRecordset(\"SELECT tblEstDtl.PartID, tblEstDtl.Qty, \" _\n          &amp; \"tblEstDtl.EstID FROM tblEstDtl \" _\n          &amp; \"WHERE tblEstDtl.EstID = \" &amp; lngEstID)\n\n'The rest of the code\n</code></pre>\n\n<p>And I am getting a data type mismatch error on the <code>Set rs</code> line. I have checked <code>tblEstDtl.EstId</code> and it is set to Long. Is my error somehow with the <code>db.OpenRecordset</code>? I am new to VBA. Any help would be appreciated.</p>\n\n<p>EDIT It seems to be a problem with <code>Set rs = db.OpenRecordSet</code> because even when I use the simple string:</p>\n\n<pre><code>Set rs = db.OpenRecordset(\"SELECT tblEstDtl.* FROM tblEstDtl;\")\n</code></pre>\n\n<p>it still gives me the same error.</p>\n\n<p>EDIT 2 Well I changed my Declarations to look like this:</p>\n\n<pre><code>Dim strSQL As String\nDim lngPartID As Long\nDim db As DAO.Database\nDim rs As DAO.Recordset\nDim lngEstID As Long\nDim dblQty As Double\n</code></pre>\n\n<p>Adding the DAO. to db and rs. I wasn't sure if I should post this as an answer or not because I still don't know why I had to do this.</p>\n"}, {"tags": ["vba", "stored-procedures"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1489582877, "post_id": 42810085, "comment_id": 72733158, "body": "at this time, what is the value of counter and the cell trying to round?  Could try converting before rounding."}, {"owner": {"reputation": 9316, "user_id": 35777, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c7e94664f931ff90e17b2b47086f483?s=128&d=identicon&r=PG", "display_name": "Arvo", "link": "https://stackoverflow.com/users/35777/arvo"}, "edited": false, "score": 0, "creation_date": 1489583288, "post_id": 42810085, "comment_id": 72733486, "body": "Either <code>counter</code> is not numeric or <code>.Cells(2, counter)</code> (which likely returns range object, not just cell value) cannot be directly passed to <code>Round()</code>. PS - this is not sql server question, vba only."}, {"owner": {"reputation": 67, "user_id": 7394916, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/e59aff1e461d88451e67a4704000b87f?s=128&d=identicon&r=PG&f=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/7394916/mike"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1489583423, "post_id": 42810085, "comment_id": 72733597, "body": "@Nathan_Sav the value of the counter is 6, (6th column)"}, {"owner": {"reputation": 67, "user_id": 7394916, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/e59aff1e461d88451e67a4704000b87f?s=128&d=identicon&r=PG&f=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/7394916/mike"}, "edited": false, "score": 0, "creation_date": 1489583593, "post_id": 42810085, "comment_id": 72733733, "body": "I am trying to insert 14.23232323232 as 14.23. Earlier I used this -             If .Cells(iRowNo, 6) = &quot;&quot; Then ABC = 0 Else ABC = Application.WorksheetFunction.Round(.Cells(iRowNo, 6), 2)                        which worked fine in vba. But when I modified it to be used as inserting through stored procedure , it gives me error"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1489584274, "post_id": 42810085, "comment_id": 72734224, "body": "The parameter type will need to match the data type, so I&#39;d suggest checking the cell contents then if numeric <code>paramValue=cdbl(.cells(2,counter))</code> then <code>round(paramValue,2)</code>"}, {"owner": {"reputation": 67, "user_id": 7394916, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/e59aff1e461d88451e67a4704000b87f?s=128&d=identicon&r=PG&f=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/7394916/mike"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1489587483, "post_id": 42810085, "comment_id": 72736853, "body": "@Nathan_Sav  &#39;Set param = objMyCmd.CreateParameter(&quot;@ABC&quot;, adNumeric,         adParamInput)             param.Precision = 18          param.NumericScale = 2          param.Value = CDbl(.Cells(2, counter))          objMyCmd.Parameters.Append Round(param, 2)          counter = counter + 1&#39;                                                                        This still gives Type mismatch error"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1489587904, "post_id": 42810085, "comment_id": 72737232, "body": "can you show table?  should this be a <code>adDouble</code> in the type in create param?"}, {"owner": {"reputation": 67, "user_id": 7394916, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/e59aff1e461d88451e67a4704000b87f?s=128&d=identicon&r=PG&f=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/7394916/mike"}, "edited": false, "score": 0, "creation_date": 1489589265, "post_id": 42810085, "comment_id": 72738346, "body": "I changed to decimal instead of numeric. I see that it is now picking up the precision value correctly but still not rounding up the answer"}], "owner": {"reputation": 67, "user_id": 7394916, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/e59aff1e461d88451e67a4704000b87f?s=128&d=identicon&r=PG&f=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/7394916/mike"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 70, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1489589186, "creation_date": 1489581688, "last_edit_date": 1489589186, "question_id": 42810085, "link": "https://stackoverflow.com/questions/42810085/type-mismatch-in-adodb-parameters-while-rounding-up-the-values-before-insert", "title": "Type mismatch in ADODB.Parameters while rounding up the values before insert", "body": "<p>I am trying to round of value while executing stored procedure from vba code and I get type mismatch error for this below code snippet. </p>\n\n<pre><code>     Dim counter as Integer\n     Set param = objMyCmd.CreateParameter(\"@ABC\", adDecimal, adParamInput)\n     param.Precision = 10\n     param.NumericScale = 5\n     param.Value = .Cells(2, counter)\n     objMyCmd.Parameters.Append Round((param), 2)\n     counter = counter + 1\n\n\n     Table: [ABC] [decimal](10, 5) NULL,\n\n     SP:     @ABC decimal(10,5) = NULL,\n</code></pre>\n\n<p>I changed numeric to decimal. I got the precision value correctly inputed but I still get \"Application uses a value for the wrong type\" error .</p>\n\n<p>Any suggestions on how would I round of the value while inserting into SQL Server tables?</p>\n"}, {"tags": ["vba", "datetime", "timestamp"], "comments": [{"owner": {"reputation": 336, "user_id": 7428364, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bFsRs.jpg?s=128&g=1", "display_name": "TheSilkCode", "link": "https://stackoverflow.com/users/7428364/thesilkcode"}, "edited": false, "score": 0, "creation_date": 1489582843, "post_id": 42810055, "comment_id": 72733123, "body": "Hi @jay - Couple things: First in <code>cdate(vbaseArray(I,1))</code> you have an &#39;L&#39; in row index, not sure if this is the problem or just typo when pasting here but wanted to point it out... Next is if you used <code>Range.Value2</code> to read a range into an array I believe Value2 removes date formatting... Lastly, I am not sure the format &#39;Wed Mar 01 22:08:01 EST 2017&#39; can be converted to date using cdate- so 2 options: 1) try <code>dateValue</code> or 2) if that doesn&#39;t work you might have to write your own date conversion function from the format of your timestamp above to a date, wouldn&#39;t be too tricky. -TheSilkCode"}, {"owner": {"reputation": 113, "user_id": 7569590, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/6248aad02aa008e6498b8246d62fa0e7?s=128&d=identicon&r=PG&f=1", "display_name": "Jay", "link": "https://stackoverflow.com/users/7569590/jay"}, "reply_to_user": {"reputation": 336, "user_id": 7428364, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bFsRs.jpg?s=128&g=1", "display_name": "TheSilkCode", "link": "https://stackoverflow.com/users/7428364/thesilkcode"}, "edited": false, "score": 0, "creation_date": 1489583479, "post_id": 42810055, "comment_id": 72733646, "body": "Hi @SilkCode, Thank you for quick response. &#39;L&#39; is the row index from the loop. I did not paste the entire code here . I tried datevalue too but its giving me the same type mismatch error.I need to think about writing my own conversion function."}, {"owner": {"reputation": 336, "user_id": 7428364, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bFsRs.jpg?s=128&g=1", "display_name": "TheSilkCode", "link": "https://stackoverflow.com/users/7428364/thesilkcode"}, "edited": false, "score": 0, "creation_date": 1489583533, "post_id": 42810055, "comment_id": 72733691, "body": "ahh gotcha, makes sense. Try those other 2 and let me know if works."}], "answers": [{"tags": [], "owner": {"reputation": 31052, "user_id": 4280, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bc588d9f099467ce6bc6fc68426119aa?s=128&d=identicon&r=PG", "display_name": "Dick Kusleika", "link": "https://stackoverflow.com/users/4280/dick-kusleika"}, "is_accepted": true, "score": 1, "last_activity_date": 1489583652, "creation_date": 1489583652, "answer_id": 42810887, "question_id": 42810055, "link": "https://stackoverflow.com/questions/42810055/vba-how-to-store-timestamp-in-variable/42810887#42810887", "title": "VBA how to store timestamp in variable", "body": "<p>You can't convert that string into a date automatically, so you have to parse it. Generally, <code>DateValue</code> is a little more forgiving than <code>CDate</code>.</p>\n\n<p>From the immediate windows</p>\n\n<pre><code>?datevalue(mid(\"Wed Mar 01 22:08:01 EST 2017\",5,15))\n3/1/2017 \n</code></pre>\n\n<p>That will always give you the current year. It cuts of the day of week and stops after the time.</p>\n\n<p>If you need the year, or you just want to be more robust, I'd use a function like</p>\n\n<pre><code>Function ConvertDate(ByVal sDate As String) As Date\n\n    Dim vaSplit As Variant\n\n    vaSplit = Split(sDate, Space(1))\n\n    ConvertDate = DateValue(vaSplit(1) &amp; Space(1) &amp; vaSplit(2) &amp; \", \" &amp; vaSplit(5)) + TimeValue(vaSplit(3))\n\nEnd Function\n</code></pre>\n\n<p>From the immediate window</p>\n\n<pre><code>?convertdate(\"Wed Mar 01 22:08:01 EST 2017\")\n3/1/2017 10:08:01 PM \n</code></pre>\n"}], "owner": {"reputation": 113, "user_id": 7569590, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/6248aad02aa008e6498b8246d62fa0e7?s=128&d=identicon&r=PG&f=1", "display_name": "Jay", "link": "https://stackoverflow.com/users/7569590/jay"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2644, "favorite_count": 0, "accepted_answer_id": 42810887, "answer_count": 1, "score": 1, "last_activity_date": 1489583652, "creation_date": 1489581631, "last_edit_date": 1489582074, "question_id": 42810055, "link": "https://stackoverflow.com/questions/42810055/vba-how-to-store-timestamp-in-variable", "title": "VBA how to store timestamp in variable", "body": "<p>I am working on processing of log or history file. In column 1 there is timestamp like this Wed Mar 01 22:08:01 EST 2017.\nI am copying the entire contents of the sheet into 2d variant array for further processing. Now I want to store this timestamp as date or datetime to further process it.</p>\n\n<p>but if I do </p>\n\n<p>dim dTimeStamp as date </p>\n\n<p>and in the loop use it to store the value of column1 \ndTimeStamp = cdate(vbaseArray(I,1))</p>\n\n<p>it gives me typemismatch error.</p>\n\n<p>Is there a way I can store timestamp value as date or datetime?\nPlease suggest.</p>\n"}, {"tags": ["vba", "ms-access-2010", "dao", "sql-server-2016", "always-encrypted"], "answers": [{"tags": [], "owner": {"reputation": 785, "user_id": 7270082, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05c06dd30d560129c5109f5230fa566a?s=128&d=identicon&r=PG&f=1", "display_name": "Nikhil Vithlani - Microsoft", "link": "https://stackoverflow.com/users/7270082/nikhil-vithlani-microsoft"}, "is_accepted": false, "score": 1, "last_activity_date": 1489602538, "creation_date": 1489602538, "answer_id": 42817906, "question_id": 42809775, "link": "https://stackoverflow.com/questions/42809775/ms-access-sql-server-always-encrypted-parameterization/42817906#42817906", "title": "MS Access SQL Server Always Encrypted Parameterization", "body": "<p>I have not directly worked with access, but, Seems like your connection string might not have been configured properly. Please set ColumnEncryption to enabled by appending the following to your connection string</p>\n\n<pre><code>;ColumnEncryption=Enabled\n</code></pre>\n\n<p><a href=\"https://docs.microsoft.com/en-us/sql/connect/odbc/windows/using-always-encrypted-with-the-windows-odbc-driver\" rel=\"nofollow noreferrer\">This article</a> explains how to use always encrypted with ODBC driver.</p>\n"}, {"tags": [], "owner": {"reputation": 21, "user_id": 3964198, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/117f69931c27b4d1290fc832e6fb32a0?s=128&d=identicon&r=PG&f=1", "display_name": "Marc M", "link": "https://stackoverflow.com/users/3964198/marc-m"}, "is_accepted": true, "score": 0, "last_activity_date": 1490803380, "creation_date": 1490803380, "answer_id": 43098655, "question_id": 42809775, "link": "https://stackoverflow.com/questions/42809775/ms-access-sql-server-always-encrypted-parameterization/43098655#43098655", "title": "MS Access SQL Server Always Encrypted Parameterization", "body": "<p>The resolution to my problem was to convert my function from DAO to ADO.  Hope the following code helps someone else down the road:</p>\n\n<pre><code>Public Function ExecuteSPWithParamsQueryADO(pSPROCName As String, ParamArray pParams() As Variant) As ADODB.RecordSet\n\n'---------------------------------------------------------------------------------------------------------------------\n' Purpose   : Executes an SQL pass-through query that requires parameters and returns a recordset.\n'           : Utilizes ADO rather than DAO.\n'\n' Author    : M. Minneman\n'\n' Params    : pSPROCName - (required) name of SPROC to be executed\n'           : pParams - (required) one or more parameters required by SPROC\n'\n' Returns   : ADODB.Recordset - ResultSet\n'\n' Contract  : Dependencies\n'           :   G_HANDLE_ERRORS - Global Boolean Constant\n'           :   ImprovedErrorHandler.HandleError - Global error handler\n'           :   ADODB - Microsoft AcitveX Data Objects Library\n'           :   ADO_CONNECT_STRING - valid connect string\n'           :   GeneralFunctions.doCloseAndRelease - CCL Function for cleaning up DAO objects\n'           :\n'           : Assumptions (routine may still work, but produce unexpected results)\n'           :   pParams has one index that is 0-based\n'           :\n'           : Pre Conditions (must be true before execution)\n'           :   pSPROCName - SPROC exists in ADODB.Connection\n'           :\n'           : Post Conditions (should be true after execution)\n'           :   ADODB.Recordset has 0 to many records\n'           :\n'---------------------------------------------------------------------------------------------------------------------\n'\n' Change Log:\n'\n' Date      By              Comment\n' 03/17/17  M. Minneman     created\n'\n\n    If G_HANDLE_ERRORS Then On Error GoTo ErrorHandler\n\n    Dim oReturn As ADODB.RecordSet\n\n    'db interface\n    Dim cnn As New ADODB.Connection\n    Dim cmd As New ADODB.Command\n    Dim prm As New ADODB.Parameter\n\n    ' Set CommandText equal to the stored procedure name.\n    cmd.CommandText = pSPROCName\n    cmd.CommandType = adCmdStoredProc\n\n    ' Connect to the data source.\n    cnn.Open ADO_CONNECT_STRING\n\n    'validate connection\n    If cnn.State &lt;&gt; adStateOpen Then\n        Err.Raise vbObjectError, , \"ADO Connection failed to open\"\n    End If\n\n    'assign connection to command\n    cmd.ActiveConnection = cnn\n\n    'automatically fill in parameter info from stored procedure.\n    cmd.Parameters.Refresh\n\n    'make sure expected parameters and given arguments are equal\n    If cmd.Parameters.Count &lt;&gt; UBound(pParams) + 2 Then\n        Err.Raise vbObjectError, , \"SPROC '\" &amp; pSPROCName &amp; \"' expects \" &amp; cmd.Parameters.Count &amp; \" arguments. \" &amp; UBound(pParams) &amp; \" provided.\"\n    End If\n\n    'set the param values.\n    Dim i As Integer\n    For i = 1 To cmd.Parameters.Count - 1\n        cmd(i) = pParams(i - 1)\n    Next i\n\n    'execute SPROC\n    Set oReturn = cmd.Execute\n\nExitHere:\n\n    'housekeeping - failure okay\n    On Error Resume Next\n    'add cleanup here\n    GeneralFunctions.doCloseAndRelease _\n        prm, _\n        cmd, _\n        cnn\n\n    'everything else - failure not okay\n    On Error GoTo 0\n    Set ExecuteSPWithParamsQueryADO = oReturn\n    Exit Function\n\nErrorHandler:\n\n    'local action\n    'add local actions here\n\n    'default action\n    Select Case Err.Source\n    Case \"CONSUMED\"\n        Call MsgBox(\"Operation failed!\", vbExclamation, \"Message\")\n    Case Else\n        Err.Source = \"SQLStoredProcedureHelper.ExecuteSPWithParamsQueryADO\"\n        Select Case Err.Number\n        Case Else\n            HandleError , , , True         'rethrow\n        End Select\n    End Select\n    Resume ExitHere\n    Resume\n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 3964198, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/117f69931c27b4d1290fc832e6fb32a0?s=128&d=identicon&r=PG&f=1", "display_name": "Marc M", "link": "https://stackoverflow.com/users/3964198/marc-m"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 490, "favorite_count": 0, "accepted_answer_id": 43098655, "answer_count": 2, "score": 2, "last_activity_date": 1490803380, "creation_date": 1489580939, "last_edit_date": 1489605956, "question_id": 42809775, "link": "https://stackoverflow.com/questions/42809775/ms-access-sql-server-always-encrypted-parameterization", "title": "MS Access SQL Server Always Encrypted Parameterization", "body": "<p>I'm evaluating whether or not SQL Server 2016 Always Encrypted will work with an existing MS Access 2010 application that I support.</p>\n\n<p>Here's my current roadblock:</p>\n\n<p>My application calls many SQL Server stored procedures that require parameters. I use the following function to make those calls:</p>\n\n<pre><code>Public Function ExecuteSPWithParamsQuery(poQDFStub As DAO.QueryDef, psParameterString As String) As DAO.Recordset\n\n'-------------------------------------------------------------------------------------------------\n' Purpose   : Execute an SQL pass-through query that calls a stored procedures requiring parameters.\n'\n' Params    : poQDFStub: pass through query with name of SPROC\n'                : psParameterString : one or more parameters to be appended to poQDFStub\n'\n' Returns   : Dao.Recordset(dbOpenSnapshot)\n'-------------------------------------------------------------------------------------------------\n'\n\n    If G_HANDLE_ERRORS Then On Error GoTo ErrorHandler\n\n    Dim rstResult As DAO.Recordset\n\n    'db interface\n    Dim dbs As DAO.Database: Set dbs = CurrentDb\n    Dim qdfResult As DAO.QueryDef: Set qdfResult = dbs.CreateQueryDef(vbNullString)\n\n    'setup pass through\n    With qdfResult\n        .Connect = poQDFStub.Connect\n        .SQL = poQDFStub.SQL &amp; \" \" &amp; psParameterString\n        .ODBCTimeout = 0\n        .ReturnsRecords = True\n    End With\n\n    'setup result\n    Set rstResult = qdfResult.OpenRecordset(dbOpenSnapshot, dbSQLPassThrough + dbReadOnly + dbFailOnError)\n\nExitHere:\n\n    'housekeeping\n    On Error Resume Next\n    'add cleanup here\n    Set qdfResult = Nothing\n    Set dbs = Nothing\n\n    'exit protocol\n    On Error GoTo 0\n    Set ExecuteSPWithParamsQuery = rstResult\n    Set rstResult = Nothing\n    Exit Function\n\nErrorHandler:\n\n    Err.Source = \"SQLStoredProcedureHelper.ExecuteSPWithParamsQuery\"\n    HandleError\n    Resume ExitHere\n\nEnd Function\n</code></pre>\n\n<p>Calls to this function will now include parameters that are clear text versions of values encrypted in the database.</p>\n\n<p>When this happens, I get the following error.</p>\n\n<blockquote>\n  <p>206 [Microsoft][ODBC SQL Server Driver][SQL Server] Operand type clash: varchar is incompatible > with nvarchar(255) encrypted with (encryption_type = 'DETERMINISTIC', encryption_algorithm_name \n  = 'AEAD_AES_256_CBC_HMAC_SHA_256', column_encryption_key_name = 'CEK_Auto1', \n  column_encryption_key_database_name = 'sandbox')</p>\n</blockquote>\n\n<p>I've done some investigation on Always Encrypted Parameterization. It requires one of two technologies</p>\n\n<ul>\n<li>.NET</li>\n<li>ODBC 13.1 For SQL Server</li>\n</ul>\n\n<p>Since this is an MS Access application, .NET is not applicable. </p>\n\n<p>I have ODBC 13.1 installed, but I'm guessing that my pass through query is bypassing parameterization.</p>\n\n<p>Here are my ODBC settings:</p>\n\n<pre><code>[ODBC]  \nDRIVER=ODBC Driver 13 for SQL Server  \nColumnEncryption=Enabled  \nTrustServerCertificate=No  \nDATABASE=sandbox  \nWSID=********  \nAPP=Microsoft Office 2010  \nTrusted_Connection=Yes  \nSERVER=*********  \n</code></pre>\n\n<p>Any ideas on how I can resolve this problem or is Always Encrypted not a fit for my application?</p>\n"}, {"tags": ["vba", "excel", "excel-formula"], "comments": [{"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 1, "creation_date": 1489581080, "post_id": 42809745, "comment_id": 72731785, "body": "Welcome to SO, <b>please take the <a href=\"https://stackoverflow.com/tour\">tour</a></b> and show us what you tried (<a href=\"https://stackoverflow.com/posts/42809745/edit\">edit</a> your post to include your formula)! ;)"}, {"owner": {"reputation": 33, "user_id": 7714788, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e31fe299a96a1d40af8cca4d07a3a0d2?s=128&d=identicon&r=PG&f=1", "display_name": "Ade Thompson", "link": "https://stackoverflow.com/users/7714788/ade-thompson"}, "reply_to_user": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 0, "creation_date": 1489581520, "post_id": 42809745, "comment_id": 72732099, "body": "Unfortunately I don&#39;t have any working code for the above issue. Looking for pointers as to where to start."}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 1, "creation_date": 1489581768, "post_id": 42809745, "comment_id": 72732298, "body": "Ok, but as you can see, there is no need for code! ;) But you should definitely <b>take the <a href=\"https://stackoverflow.com/tour\">tour</a></b> (click on &quot;tour&quot;, it&#39;s blue so it&#39;s a link! ;) )"}], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 7714788, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e31fe299a96a1d40af8cca4d07a3a0d2?s=128&d=identicon&r=PG&f=1", "display_name": "Ade Thompson", "link": "https://stackoverflow.com/users/7714788/ade-thompson"}, "edited": false, "score": 0, "creation_date": 1489581928, "post_id": 42810080, "comment_id": 72732419, "body": "The cells/string content will vary so can&#39;t search for specific strings. The only thing thats constant will be the url which should start with http:// or just www."}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "reply_to_user": {"reputation": 33, "user_id": 7714788, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e31fe299a96a1d40af8cca4d07a3a0d2?s=128&d=identicon&r=PG&f=1", "display_name": "Ade Thompson", "link": "https://stackoverflow.com/users/7714788/ade-thompson"}, "edited": false, "score": 0, "creation_date": 1489582607, "post_id": 42810080, "comment_id": 72732933, "body": "@AdeThompson : You could have say so in your question... But first, <b>I insist that you take the <a href=\"https://stackoverflow.com/tour\">tour</a></b>"}, {"owner": {"reputation": 33, "user_id": 7714788, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e31fe299a96a1d40af8cca4d07a3a0d2?s=128&d=identicon&r=PG&f=1", "display_name": "Ade Thompson", "link": "https://stackoverflow.com/users/7714788/ade-thompson"}, "edited": false, "score": 0, "creation_date": 1489587706, "post_id": 42810080, "comment_id": 72737068, "body": "Maybe I wasnt clear but I thought &#39;contains a variety of information&#39; was enough.  I&#39;ve been through the tour.... Twice."}], "tags": [], "owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "is_accepted": false, "score": 1, "last_activity_date": 1489581677, "creation_date": 1489581677, "answer_id": 42810080, "question_id": 42809745, "link": "https://stackoverflow.com/questions/42809745/find-url-in-cell-string-with-excel-vba/42810080#42810080", "title": "Find URL in cell/string with Excel VBA", "body": "<p>If your input is in A1, place this in A2 to get the cleaned link :</p>\n\n<pre><code>=TRIM(SUBSTITUTE(SUBSTITUTE(A1,\"This is a sample link: \",\"\"),\" Please visit.\",\"\"))\n</code></pre>\n\n<p>Using cleaned link in A2 :</p>\n\n<pre><code>=\"This is a sample link: &lt;a href=\"\"\"&amp;A2&amp;\"\"\"&gt;\"&amp;A2&amp;\"&lt;/a&gt; Please visit.\"\n</code></pre>\n\n<hr>\n\n<p>Or both combined (input in A1) :</p>\n\n<pre><code>=\"This is a sample link: &lt;a href=\"\"\"&amp;TRIM(SUBSTITUTE(SUBSTITUTE(A1,\"This is a sample link: \",\"\"),\" Please visit.\",\"\"))&amp;\"\"\"&gt;\"&amp;TRIM(SUBSTITUTE(SUBSTITUTE(A1,\"This is a sample link: \",\"\"),\" Please visit.\",\"\"))&amp;\"&lt;/a&gt; Please visit.\"\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 33, "user_id": 7714788, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e31fe299a96a1d40af8cca4d07a3a0d2?s=128&d=identicon&r=PG&f=1", "display_name": "Ade Thompson", "link": "https://stackoverflow.com/users/7714788/ade-thompson"}, "edited": false, "score": 0, "creation_date": 1489587394, "post_id": 42810538, "comment_id": 72736777, "body": "this seems to just give me VALUE!"}, {"owner": {"reputation": 33, "user_id": 7714788, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e31fe299a96a1d40af8cca4d07a3a0d2?s=128&d=identicon&r=PG&f=1", "display_name": "Ade Thompson", "link": "https://stackoverflow.com/users/7714788/ade-thompson"}, "edited": false, "score": 0, "creation_date": 1489588333, "post_id": 42810538, "comment_id": 72737549, "body": "Ok I resolved that, wasnt including the text after the URL. This seems to be getting me closer to the solution.  Just need to work out how to make it do it if it finds multiple insances of URL&#39;s. Oh and also put the URL with the &lt;a href&gt; tag.  Thanks for the help."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 33, "user_id": 7714788, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e31fe299a96a1d40af8cca4d07a3a0d2?s=128&d=identicon&r=PG&f=1", "display_name": "Ade Thompson", "link": "https://stackoverflow.com/users/7714788/ade-thompson"}, "edited": false, "score": 0, "creation_date": 1489588507, "post_id": 42810538, "comment_id": 72737717, "body": "The formula above shows how to find the begnning and the end of the URL, use those and a little maths with the MID function to pull out the URL into the existing REPLACE function&#39;s replacement text."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 1, "last_activity_date": 1489582844, "creation_date": 1489582844, "answer_id": 42810538, "question_id": 42809745, "link": "https://stackoverflow.com/questions/42809745/find-url-in-cell-string-with-excel-vba/42810538#42810538", "title": "Find URL in cell/string with Excel VBA", "body": "<p>Oh-key-doh-key... so you are '<em>... looking for pointers as to where to start.</em>'. Here is a start:</p>\n\n<pre><code>=SUBSTITUTE(REPLACE(A2, FIND(\" \", A2, FIND(\"http\", A2)), 1, \"\"\"&gt;\"), \" http\", \"&lt;a href=\"\"http\")&amp;\"&lt;/a&gt;\"\n</code></pre>\n\n<p>Now you can refine that using the same functions and methods to strip out the URL into the anchor element.</p>\n\n<p><a href=\"https://i.stack.imgur.com/hVcGl.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/hVcGl.png\" alt=\"enter image description here\"></a></p>\n"}, {"comments": [{"owner": {"reputation": 33, "user_id": 7714788, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e31fe299a96a1d40af8cca4d07a3a0d2?s=128&d=identicon&r=PG&f=1", "display_name": "Ade Thompson", "link": "https://stackoverflow.com/users/7714788/ade-thompson"}, "edited": false, "score": 0, "creation_date": 1489590813, "post_id": 42813138, "comment_id": 72739607, "body": "Ron that works perfectly, just what I can looking for. Many thanks."}, {"owner": {"reputation": 33, "user_id": 7714788, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e31fe299a96a1d40af8cca4d07a3a0d2?s=128&d=identicon&r=PG&f=1", "display_name": "Ade Thompson", "link": "https://stackoverflow.com/users/7714788/ade-thompson"}, "edited": false, "score": 0, "creation_date": 1489655918, "post_id": 42813138, "comment_id": 72769430, "body": "This works great within a cell but cant get it to perform the same result when calling it from within VBA.  <code>Output = &quot;This is a test link http:&#47;&#47;www.bbc.co.uk&quot;</code> <code>LinkToHtml (Output)</code>"}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "reply_to_user": {"reputation": 33, "user_id": 7714788, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e31fe299a96a1d40af8cca4d07a3a0d2?s=128&d=identicon&r=PG&f=1", "display_name": "Ade Thompson", "link": "https://stackoverflow.com/users/7714788/ade-thompson"}, "edited": false, "score": 0, "creation_date": 1489659960, "post_id": 42813138, "comment_id": 72772294, "body": "@AdeThompson It works fine here, either when called from a cell or from within a VBA routine.  Your output indicates the Regex procedure is not being called, or does not recognize the URL as such."}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "reply_to_user": {"reputation": 33, "user_id": 7714788, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e31fe299a96a1d40af8cca4d07a3a0d2?s=128&d=identicon&r=PG&f=1", "display_name": "Ade Thompson", "link": "https://stackoverflow.com/users/7714788/ade-thompson"}, "edited": false, "score": 0, "creation_date": 1489663215, "post_id": 42813138, "comment_id": 72774616, "body": "@AdeThompson  If the line in your comment represents two lines of VBA code, then you are not doing anything with the output from the formula.  You need to assign it to something."}, {"owner": {"reputation": 33, "user_id": 7714788, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e31fe299a96a1d40af8cca4d07a3a0d2?s=128&d=identicon&r=PG&f=1", "display_name": "Ade Thompson", "link": "https://stackoverflow.com/users/7714788/ade-thompson"}, "edited": false, "score": 0, "creation_date": 1489699140, "post_id": 42813138, "comment_id": 72798622, "body": "Yeah thanks worked that out in the end. Thought it would apply to the variable but didn&#39;t. Thanks again."}, {"owner": {"reputation": 152, "user_id": 5614795, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed2d99f97fc11aa0a587b26428d1a484?s=128&d=identicon&r=PG&f=1", "display_name": "emjaySX", "link": "https://stackoverflow.com/users/5614795/emjaysx"}, "edited": false, "score": 0, "creation_date": 1618367133, "post_id": 42813138, "comment_id": 118577995, "body": "I&#39;m going to have to learn RegEx one day, but for now @RonRosenfeld this worked perfectly! Thanks"}], "tags": [], "owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "is_accepted": true, "score": 1, "last_activity_date": 1489590363, "last_edit_date": 1489590363, "creation_date": 1489589372, "answer_id": 42813138, "question_id": 42809745, "link": "https://stackoverflow.com/questions/42809745/find-url-in-cell-string-with-excel-vba/42813138#42813138", "title": "Find URL in cell/string with Excel VBA", "body": "<p>Here is a UDF that will replace.  And should also work with multiple URL's in the same string.  IT uses the Regular Expression engine to do the work, and will find URL's with various protocols (eg http, https, ftp, File)</p>\n\n<p>Also, if the link is part of a sentence, the punctuation at the end (eg period, comma, etc) will not be included within the html tags.</p>\n\n<hr>\n\n<pre><code>Option Explicit\nFunction LinkToHTML(S As String) As String\n    Dim RE As Object\n    Const sPat As String = \"\\b(https?|ftps?|file)://[-A-Z0-9+&amp;@#/%?=~_|$!:,.;]*[A-Z0-9+&amp;@#/%=~_|$]\"\n    Const sRepl As String = \"&lt;a href=\"\"$&amp;\"\"&gt;$&amp;&lt;/a&gt;\"\n\nSet RE = CreateObject(\"vbscript.regexp\")\nWith RE\n    .Global = True\n    .Pattern = sPat\n    .ignorecase = True\n    LinkToHTML = .Replace(S, sRepl)\nEnd With\n\nEnd Function\n</code></pre>\n\n<hr>\n\n<p><a href=\"https://i.stack.imgur.com/0vrMh.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/0vrMh.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 33, "user_id": 7714788, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e31fe299a96a1d40af8cca4d07a3a0d2?s=128&d=identicon&r=PG&f=1", "display_name": "Ade Thompson", "link": "https://stackoverflow.com/users/7714788/ade-thompson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1039, "favorite_count": 0, "accepted_answer_id": 42813138, "answer_count": 3, "score": 3, "last_activity_date": 1489590363, "creation_date": 1489580875, "last_edit_date": 1489581036, "question_id": 42809745, "link": "https://stackoverflow.com/questions/42809745/find-url-in-cell-string-with-excel-vba", "title": "Find URL in cell/string with Excel VBA", "body": "<p>I have a cell/string that contains a varierty of information including RAW http:// links. </p>\n\n<p>I'm wanting find a way to extract these RAW URLS and convert them into HTML links ( etc not clickable links in Excel). see below for an example:</p>\n\n<pre><code>Source: This is a sample link: http://www.bbc.co.uk Please visit.\nOutput: This is a sample link: &lt;a href=\"http://www.bbc.co.uk\"&gt;http://www.bbc.co.uk&lt;/a&gt; Please visit.\n</code></pre>\n\n<p>I've dabbled with replace function but this doesn't seem to be giving me the required result.</p>\n\n<p>Any help appreciated.</p>\n"}, {"tags": ["regex", "excel", "vba"], "comments": [{"owner": {"reputation": 421, "user_id": 3987036, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvLoG.png?s=128&g=1", "display_name": "Oscar Hermosilla", "link": "https://stackoverflow.com/users/3987036/oscar-hermosilla"}, "edited": false, "score": 0, "creation_date": 1489580979, "post_id": 42809600, "comment_id": 72731713, "body": "If there is no match, then the matchCollection is not initiated. Only if it enters in your If regEx.test(strInput) Then"}, {"owner": {"reputation": 481661, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1489581136, "post_id": 42809600, "comment_id": 72731828, "body": "Besides, you have declared <code>matches1</code> and then use <code>matches(0)</code>"}, {"owner": {"reputation": 23, "user_id": 7646569, "user_type": "registered", "profile_image": "https://graph.facebook.com/10210854192926901/picture?type=large", "display_name": "Cecilia Mattsson", "link": "https://stackoverflow.com/users/7646569/cecilia-mattsson"}, "edited": false, "score": 0, "creation_date": 1489581324, "post_id": 42809600, "comment_id": 72731954, "body": "There is a match, the code is entering If regEx.test(strInput). Yes thats right Wiktor, my bad. However, it does not solve the problem of getting in to the loop in the first place.."}, {"owner": {"reputation": 481661, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1489581762, "post_id": 42809600, "comment_id": 72732293, "body": "I simplified your code a bit, and after fixing the matches it works. Tried with your updated code: it works well if you just pass a string (not a range)."}, {"owner": {"reputation": 23, "user_id": 7646569, "user_type": "registered", "profile_image": "https://graph.facebook.com/10210854192926901/picture?type=large", "display_name": "Cecilia Mattsson", "link": "https://stackoverflow.com/users/7646569/cecilia-mattsson"}, "edited": false, "score": 0, "creation_date": 1489582251, "post_id": 42809600, "comment_id": 72732667, "body": "Is it possible to get all the sub matches with a string? I would like to gather the sub matches in different cells in excel."}, {"owner": {"reputation": 481661, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1489585743, "post_id": 42809600, "comment_id": 72735345, "body": "Sorry, your question is off-topic now and unclear."}, {"owner": {"reputation": 23, "user_id": 7646569, "user_type": "registered", "profile_image": "https://graph.facebook.com/10210854192926901/picture?type=large", "display_name": "Cecilia Mattsson", "link": "https://stackoverflow.com/users/7646569/cecilia-mattsson"}, "edited": false, "score": 0, "creation_date": 1489588637, "post_id": 42809600, "comment_id": 72737825, "body": "Yes, it got a bit confusing. My question simply was if it is possible to return a matchCollection from a function but the answer to that question might be no. I&#39;m trying to get around my problem in a different way. Thanks anyway!"}, {"owner": {"reputation": 17364, "user_id": 3740093, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XrJEq.png?s=128&g=1", "display_name": "Visual Vincent", "link": "https://stackoverflow.com/users/3740093/visual-vincent"}, "edited": false, "score": 0, "creation_date": 1489590989, "post_id": 42809600, "comment_id": 72739745, "body": "If this is VB.NET then your use of the <code>Set</code> keyword is not valid and should be removed. If this is VBA then you should tag your question as such instead of VB.NET."}], "owner": {"reputation": 23, "user_id": 7646569, "user_type": "registered", "profile_image": "https://graph.facebook.com/10210854192926901/picture?type=large", "display_name": "Cecilia Mattsson", "link": "https://stackoverflow.com/users/7646569/cecilia-mattsson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 792, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1489591966, "creation_date": 1489580394, "last_edit_date": 1489591966, "question_id": 42809600, "link": "https://stackoverflow.com/questions/42809600/how-to-return-a-matchcollection-from-function-in-visual-basic-excel", "title": "How to return a matchCollection from function in Visual Basic, Excel", "body": "<p>I'm trying to return a matchCollection from a function to be able to loop through my matches and write them to excel cells outside the function. </p>\n\n<p>I get the run-time error 91: Object variable or With block variable not set, when my code comes to:</p>\n\n<p>If matches1.Count &lt;> 0 Then</p>\n\n<p>This is my code:</p>\n\n<pre><code>Sub simpleRegex()\n\n  Dim ShortRange As range\n  Set ShortRange = ActiveSheet.range(\"A2:A505\")\n  Dim strInput1 As String\n  Dim matches1 As MatchCollection\n\n  For Each cell In ShortRange\n\n    strInput1 = cell.Value\n\n    Set matches1 = CheckMatch(strInput1)\n\n    If matches1.Count &lt;&gt; 0 Then\n        cell(1, 3).Value = matches1(0).SubMatches(2)\n        cell(1, 4).Value = matches1(0).SubMatches(3)\n    End If\n\n  Next\n\nEnd Sub\n\nPublic Function CheckMatch(str As String) As MatchCollection\n\n  Dim strPattern1 As String\n  Dim strInput As String\n\n  Dim regEx As New RegExp\n  Dim matches As MatchCollection\n  Dim Match As Boolean\n\n  Match = False\n\n\n  strPattern1 = \"((storlek|strl|stl|strlk|storleken|storl|size|storleksm\u00e4rkt|storl|storlk|st).{0,2}?(?:[^\\s]+)?.{0,2}?)?(30|32|34|36|38|40|42|44|46|48|50).?(30|32|34|36|38|40|42|44|46|48|50)?\"\n\n   strInput = str\n\n   With regEx\n     .Global = True\n     .MultiLine = False\n     .IgnoreCase = True\n     .Pattern = strPattern1\n   End With\n\n   If regEx.test(strInput) Then\n     Match = True\n     Set matches = regEx.Execute(strInput)\n   End If\n\n   Set CheckMatch = matches\n\nEnd Function\n</code></pre>\n\n<p>Anyone who knows how this can be fixed? </p>\n"}, {"tags": ["excel", "ms-word", "multiple-columns", "margins", "vba"], "answers": [{"comments": [{"owner": {"reputation": 50, "user_id": 5416512, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/982865943b1943886ae4a42580f95d3f?s=128&d=identicon&r=PG&f=1", "display_name": "Allen", "link": "https://stackoverflow.com/users/5416512/allen"}, "edited": false, "score": 0, "creation_date": 1489601371, "post_id": 42810945, "comment_id": 72746885, "body": "I updated the code to use Val as it seems to be the better way to go, thank you. I did try to do it that way as well as direct point value and experienced the same issue. I think what may be happening is when it sets the .spaceafter to .3, it pulls the 2nd column to the left more, which increases the right margin. I believe the margin may actually be set to 0.3, but the column width isn&#39;t wide enough to meet it. That being said, I am trying to create a tool that can have variable inputs, and I don&#39;t know how to have the code adjust for the last column width in different situations."}, {"owner": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "reply_to_user": {"reputation": 50, "user_id": 5416512, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/982865943b1943886ae4a42580f95d3f?s=128&d=identicon&r=PG&f=1", "display_name": "Allen", "link": "https://stackoverflow.com/users/5416512/allen"}, "edited": false, "score": 0, "creation_date": 1489632655, "post_id": 42810945, "comment_id": 72760070, "body": "I took a look at your code for setting the columns and found no obvious fault there either. Could it be that the total width of columns, including SpaceAfter, exceeds the total width of the page area as defined by the margins?"}], "tags": [], "owner": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "is_accepted": false, "score": 1, "last_activity_date": 1489583802, "creation_date": 1489583802, "answer_id": 42810945, "question_id": 42809594, "link": "https://stackoverflow.com/questions/42809594/inconsistency-setting-word-margins-column-spacing-via-excel-vba/42810945#42810945", "title": "Inconsistency Setting Word Margins/Column Spacing via Excel VBA", "body": "<p>This is the part of your code which sets the margins.</p>\n\n<blockquote>\n  <p>With wrdDocument.PageSetup\n    .LeftMargin = wrdApplication.InchesToPoints(frmWordEdit.txtMLeftRight)\n    .RightMargin = wrdApplication.InchesToPoints(frmWordEdit.txtMLeftRight)\n    .TopMargin = wrdApplication.InchesToPoints(frmWordEdit.txtMTop)\n    .BottomMargin = wrdApplication.InchesToPoints(frmWordEdit.txtMBottom)</p>\n  \n  <p>End With</p>\n</blockquote>\n\n<p>I find no fault with the syntax (except that you don't need to specify wrdApplication unless you run the code from another application, perhaps Excel). Since the code appears without fault errors must have their origin in the reference to frmWordEdit. I suggest that you run this code with plain numbers, expressed in points, and see if you still get the same result.\nfrmWordEdit.txtMLeftRight would appear to be a Textbox. Since you don't specify which property you are referring to it must be the default which is the Value property. The Value property of a Textbox holds a string which you feed into the InchesToPoints function. That function takes a single, if I'm not mistaken - anyway, a numeric value. Therefore I suspect that the string isn't correctly translated. Try something like InchesToPoints(Val(frmWordEdit.txtMLeftRight)).</p>\n"}], "owner": {"reputation": 50, "user_id": 5416512, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/982865943b1943886ae4a42580f95d3f?s=128&d=identicon&r=PG&f=1", "display_name": "Allen", "link": "https://stackoverflow.com/users/5416512/allen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 296, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1489583802, "creation_date": 1489580386, "last_edit_date": 1531161705, "question_id": 42809594, "link": "https://stackoverflow.com/questions/42809594/inconsistency-setting-word-margins-column-spacing-via-excel-vba", "title": "Inconsistency Setting Word Margins/Column Spacing via Excel VBA", "body": "<p>Good Morning!</p>\n\n<p>I am creating a tool to format many word documents with the same settings, and am working on setting all document body data to the column count specified, and the margins as specified. When run, this code works, but does not set the left/ right margins appropriately. The code should set each of them to the same value.</p>\n\n<p>When run it seems to be variable. For instance, if I choose 0.3; the left margin will end of as 0.2 and the right will be 0.4. To make it a little weirder, if I manually go into the custom margin settings in MS Word, it states it is at the appropriate numbers (0.3) even when the margin bar on the page is not set there.</p>\n\n<p>Has anyone worked with margins via vb to know if this is a setting issue, or if there is a more accurate way? I think it may have something to do with the column spacing .SpaceAfter = InchesToPoints(frmWordEdit.txtColumnSpacing), but I am unsure.</p>\n\n<p>Any help is appreciated!</p>\n\n<pre><code>Sub AddRemoveWatermark(strReplaceText As String)\n    'Word Variables\n    Dim wrdApplication As Word.Application\n    Dim wrdDocument As Word.Document\n    Dim wrdSection As Word.section\n    Dim wrdSelection As Word.Selection\n    Dim wrdHeader As Word.HeaderFooter\n    Dim rngHeader As Word.Range\n    Dim rngFooter As Word.HeaderFooter\n    Dim spShape As Word.Shape\n\n    Dim strDocumentName As String\n    Dim strPath As String\n    Dim strBBPath As String\n    Dim lngCount As Long\n\n    ' Open the file dialog\n    With Application.FileDialog(msoFileDialogOpen)\n        .AllowMultiSelect = True\n        .Show\n\n        Set wrdApplication = New Word.Application\n\n        ' Display paths of each file selected\n        For lngCount = 1 To .SelectedItems.Count\n            strPath = .SelectedItems(lngCount)\n            Set wrdDocument = wrdApplication.Documents.Open(strPath)\n\n            strDocumentName = wrdDocument.FullName 'Record the document name\n            wrdApplication.Templates.LoadBuildingBlocks\n\n            wrdApplication.Visible = True\n\n            'Document Layout\n            If frmWordEdit.chkDocumentLayout.Value = True Then\n\n                'Change Columns\n                If frmWordEdit.chkColumns = True Then\n                    With wrdDocument.PageSetup.TextColumns\n                        .SetCount NumColumns:=frmWordEdit.txtColumns\n                        '.Add EvenlySpaced:=True\n                        '.Width = InchesToPoints(3)\n                        '.SpaceAfter = InchesToPoints(0.3)\n                    End With\n\n                    Dim i As Integer\n\n                    If frmWordEdit.txtColumns &gt; 1 Then\n                        For i = 1 To frmWordEdit.txtColumns - 1\n                            With wrdDocument.PageSetup.TextColumns(i)\n                                '.Width = InchesToPoints(4)\n                                .SpaceAfter = InchesToPoints(frmWordEdit.txtColumnSpacing)\n                            End With\n\n                        Next\n                    End If\n                End If\n\n                'Change Margins\n                If frmWordEdit.chkMargins = True Then\n                    With wrdDocument.PageSetup\n                        .LeftMargin = wrdApplication.InchesToPoints(frmWordEdit.txtMLeftRight)\n                        .RightMargin = wrdApplication.InchesToPoints(frmWordEdit.txtMLeftRight)\n                        .TopMargin = wrdApplication.InchesToPoints(frmWordEdit.txtMTop)\n                        .BottomMargin = wrdApplication.InchesToPoints(frmWordEdit.txtMBottom)\n                    End With\n                End If\n\n            End If\n\n            'Document Design\n            If frmWordEdit.chkDocumentDesign.Value = True Then\n                If frmWordEdit.chkMHeader = True Then\n                    With wrdDocument.PageSetup\n                        .HeaderDistance = wrdApplication.InchesToPoints(frmWordEdit.txtMHeader)\n                    End With\n                End If\n\n                If frmWordEdit.chkMFooter = True Then\n                    With wrdDocument.PageSetup\n                        .FooterDistance = wrdApplication.InchesToPoints(frmWordEdit.txtMFooter)\n                    End With\n                End If\n            End If\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "ms-word"], "comments": [{"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 0, "creation_date": 1489580467, "post_id": 42809439, "comment_id": 72731350, "body": "Mkay... Do you use some code to tag this as <a href=\"https://stackoverflow.com/questions/tagged/vba\">vba</a>?? If yes, please add your code. If no, please change the tags and add more details. In both cases, it&#39;s <a href=\"https://stackoverflow.com/posts/42809439/edit\">edit</a> time! ;)"}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 1, "creation_date": 1489580554, "post_id": 42809439, "comment_id": 72731410, "body": "BTW, I see that you didn&#39;t <b>take the <a href=\"https://stackoverflow.com/tour\">tour</a>, nor accept any answer on your 7 questions</b>, it&#39;s time to learn how SO works! Then go back to your profile, accept the answer that helped you on each question, then you can have some more help! ;)"}, {"owner": {"reputation": 33, "user_id": 5179745, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c1d7c81962cb2cb65005e4bf0f708487?s=128&d=identicon&r=PG&f=1", "display_name": "JoshD", "link": "https://stackoverflow.com/users/5179745/joshd"}, "reply_to_user": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 1, "creation_date": 1489615976, "post_id": 42809439, "comment_id": 72755038, "body": "Apologies, I&#39;ve added in the code and addressed old questions."}], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 5179745, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c1d7c81962cb2cb65005e4bf0f708487?s=128&d=identicon&r=PG&f=1", "display_name": "JoshD", "link": "https://stackoverflow.com/users/5179745/joshd"}, "edited": false, "score": 0, "creation_date": 1489963792, "post_id": 42832761, "comment_id": 72887597, "body": "It does and doesn&#39;t work. The issue is the empty cells being merged contain a &#39;space&#39; character in them and I don&#39;t know how to delete it before merging the cells. I&#39;ve tried <code>Tables(1).Cells(1,3).Select Selection.Delete</code> but it doesn&#39;t work. Any ideas?"}], "tags": [], "owner": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "is_accepted": false, "score": 1, "last_activity_date": 1489663520, "creation_date": 1489663520, "answer_id": 42832761, "question_id": 42809439, "link": "https://stackoverflow.com/questions/42809439/vba-word-stop-merging-cells-adds-new-lines-to-merged-cell/42832761#42832761", "title": "VBA word stop merging cells adds new lines to merged cell", "body": "<p>The Merge command can only merge two adjacent cells. You might use a loop to merge more cells.</p>\n\n<blockquote>\n<pre><code>Dim i As Long\n\nWith ActiveDocument.Tables(1).Rows(1)\n    For i = 3 To 4\n        .Cells(2).Merge .Cells(i)\n    Next i\nEnd With\n</code></pre>\n</blockquote>\n\n<p>Cells 3 and 4 are merged with cell(2).</p>\n"}, {"tags": [], "owner": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "is_accepted": true, "score": 1, "last_activity_date": 1489976785, "creation_date": 1489976785, "answer_id": 42894906, "question_id": 42809439, "link": "https://stackoverflow.com/questions/42809439/vba-word-stop-merging-cells-adds-new-lines-to-merged-cell/42894906#42894906", "title": "VBA word stop merging cells adds new lines to merged cell", "body": "<p>This variation includes two solutions for how to deal with existing content in cells being merged.</p>\n\n<pre><code>Private Sub TestMerge()\n    Dim i As Long\n\n    With ActiveDocument.Tables(1).Rows(1)\n        For i = 3 To 4\n'            .Cells(i).Range.Text = \"\"\n            .Cells(2).Merge .Cells(i)\n        Next i\n        .Cells(2).Range.Text = \"\"\n    End With\nEnd Sub\n</code></pre>\n\n<p>The first solution deletes everything in cells 3 and 4 but retains content of cell(2). In the above code it is rendered mute by the apostrophe preceding the code.</p>\n\n<p>The second way is to remove everything from the merged cells. I would recommend to run this version only while <code>Application.ScreenUpdating = False</code> because it will cause a lot of flicker.</p>\n\n<p>There are several more way, but in order to recommend the one most suitable for your needs one would need to have a better understanding of what you want. BTW, if at all possible, remove the blanks from the table at the time they are entered. Having blanks floating around your document and popping up when they are least expected or wanted is never a good idea.</p>\n"}], "owner": {"reputation": 33, "user_id": 5179745, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c1d7c81962cb2cb65005e4bf0f708487?s=128&d=identicon&r=PG&f=1", "display_name": "JoshD", "link": "https://stackoverflow.com/users/5179745/joshd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 252, "favorite_count": 0, "accepted_answer_id": 42894906, "answer_count": 2, "score": 1, "last_activity_date": 1489976785, "creation_date": 1489579909, "last_edit_date": 1531164843, "question_id": 42809439, "link": "https://stackoverflow.com/questions/42809439/vba-word-stop-merging-cells-adds-new-lines-to-merged-cell", "title": "VBA word stop merging cells adds new lines to merged cell", "body": "<p>I have a table in word in which I merge 1 cell with text to the 2 empty cells left of it. Each time it merges it adds a new line under the text of the merged cell. This messes up the whole layout of the table. This table has been copied from Excel and pasted into Word. How do I fix this?</p>\n\n<pre><code>Dim table1 as Table\nWith table1\n.Cell(Row:=1, Column:=3).Merge _ \nMergeTo:=.Cell(Row:=1, Column:=5)\nEnd With\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 21753, "user_id": 3978545, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jmQsw.png?s=128&g=1", "display_name": "Wolfie", "link": "https://stackoverflow.com/users/3978545/wolfie"}, "edited": false, "score": 0, "creation_date": 1489579098, "post_id": 42809035, "comment_id": 72730413, "body": "Give us an example of the data in your csv, and any code you&#39;ve <i>already tried</i>"}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 2, "creation_date": 1489579353, "post_id": 42809035, "comment_id": 72730593, "body": "Welcome to SO.  This is not a free code-writing service but exists to help others with code or functions they are trying to develop.  As such, we expect to see clear cut questions with examples of data, attempted code, actual output, desired output, research efforts to solve the problem, etc.  Please read the HELP pages for information as to <a href=\"http://stackoverflow.com/help/on-topic\">What topics can I ask about here?</a>, <a href=\"http://stackoverflow.com/help/how-to-ask\">How to Ask a Good Question</a>, and <a href=\"http://stackoverflow.com/help/mcve\">How to create a Minimal, Complete, and Verifiable example</a>"}, {"owner": {"reputation": 1148, "user_id": 7231593, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kvB-QD-A2Xs/AAAAAAAAAAI/AAAAAAAAAE4/LRTmHQQqx44/photo.jpg?sz=128", "display_name": "John Muggins", "link": "https://stackoverflow.com/users/7231593/john-muggins"}, "edited": false, "score": 0, "creation_date": 1489579488, "post_id": 42809035, "comment_id": 72730696, "body": "The commas in your CSV file are delimiters.  Delimiters are separators - when you import data into an array for example, the commas separate the different elements.  The common way to put such a file into an excel array would be myArrayVariable = split(textVariable, &quot;,&quot;)"}, {"owner": {"reputation": 3101, "user_id": 6783806, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dce70a8f2f353bdac58089c38f1ba5a5?s=128&d=identicon&r=PG&f=1", "display_name": "Mukul Varshney", "link": "https://stackoverflow.com/users/6783806/mukul-varshney"}, "edited": false, "score": 0, "creation_date": 1489585453, "post_id": 42809035, "comment_id": 72735144, "body": "Please show us what you have tried so far."}, {"owner": {"reputation": 3732, "user_id": 7676310, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ssFxM.jpg?s=128&g=1", "display_name": "Gowtham Shiva", "link": "https://stackoverflow.com/users/7676310/gowtham-shiva"}, "edited": false, "score": 0, "creation_date": 1489585493, "post_id": 42809035, "comment_id": 72735179, "body": "Rajiv, Please show us what is your expected output in the column"}], "answers": [{"tags": [], "owner": {"reputation": 424, "user_id": 7676648, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/MKp0t.jpg?s=128&g=1", "display_name": "Apurv Pawar", "link": "https://stackoverflow.com/users/7676648/apurv-pawar"}, "is_accepted": false, "score": 0, "last_activity_date": 1489589914, "creation_date": 1489589914, "answer_id": 42813376, "question_id": 42809035, "link": "https://stackoverflow.com/questions/42809035/if-cell-contains-word-then-extract-word-into-another-cell-excel-vba/42813376#42813376", "title": "IF cell contains WORD then extract WORD into another cell - Excel/VBA", "body": "<pre><code>Sub test()\ni = Range(\"A1048576\").End(xlUp).Row\nans = InputBox(\"what needs to be checked\", \"test\")\nFor K = 2 To i\n\nIf InStr(1, Range(\"A\" &amp; K).Value, ans) Then\nRange(\"b\" &amp; K).Value = ans\nEnd If\nNext\n\nEnd Sub\n</code></pre>\n\n<p>place text in col A, run the macro, macro will ask what to be searched, if found then will place in the B col, let us know if something like this works or any thing additional</p>\n"}], "owner": {"reputation": 1, "user_id": 7714672, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/626a14726f86331caca8997ad23f8183?s=128&d=identicon&r=PG&f=1", "display_name": "Rajiv Thakrar", "link": "https://stackoverflow.com/users/7714672/rajiv-thakrar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 572, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1489589914, "creation_date": 1489578888, "last_edit_date": 1489581846, "question_id": 42809035, "link": "https://stackoverflow.com/questions/42809035/if-cell-contains-word-then-extract-word-into-another-cell-excel-vba", "title": "IF cell contains WORD then extract WORD into another cell - Excel/VBA", "body": "<p>I have a large spreadsheet full of job titles that I need to sort in terms of seniority. I am trying to use an <code>IF (certain group of words are in cell) THEN (print that word)</code> function. I am relatively new to programming and have a vague idea of what I want my code to. Any other suggestions will be useful!</p>\n\n<p><img src=\"https://i.stack.imgur.com/kq18O.png\" alt=\"Data set\"></p>\n\n<p>In the column next to the job title I would like to extract the relevant bits of information. In this case I am exploring the seniority of the role. Therefore I was hoping to extract words such as \"head\", \"director\", \"CXO\" where X is E/T/R/P etc. I was thinking about importing the data into python as we already have the data in CSV format but the issue is that there are commas within my CSV. I also think it would be best practice to do this within excel. Once I extracted the information I can then use a simple lookup function to relay if they are C-level, Manager level etc.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 14064, "user_id": 765395, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Xc817.png?s=128&g=1", "display_name": "Robin Mackenzie", "link": "https://stackoverflow.com/users/765395/robin-mackenzie"}, "edited": false, "score": 0, "creation_date": 1489579459, "post_id": 42809011, "comment_id": 72730661, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/24173238/expected-end-of-statement-in-formula-with-quotes\">Expected End of Statement in formula with quotes</a>"}, {"owner": {"reputation": 14064, "user_id": 765395, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Xc817.png?s=128&g=1", "display_name": "Robin Mackenzie", "link": "https://stackoverflow.com/users/765395/robin-mackenzie"}, "edited": false, "score": 0, "creation_date": 1489579494, "post_id": 42809011, "comment_id": 72730705, "body": "Try this  <code>&quot;=MID(aa,FIND(&quot;&quot;for &quot;&quot;,aa)+4,FIND(&quot;&quot; &quot;&quot;,aa,FIND(&quot;&quot;for &quot;&quot;,aa)+4)-(FIND(&quot;&quot;for &quot;&quot;,aa)+4))&quot;</code>"}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1489579913, "post_id": 42809011, "comment_id": 72731010, "body": "I&#39;ll add as a comment as the duplicate link answers the question.  Use <code>.FormulaR1C1 = &quot;=MID(RC1,FIND(&quot;&quot;for &quot;&quot;,RC1)+4,FIND(&quot;&quot; &quot;&quot;,RC1,find(&quot;&quot;for &quot;&quot;,RC1)+4)-(FIND(&quot;&quot;for &quot;&quot;,RC1)+4))&quot;</code>.  <code>aa</code> is the text as displayed in column A.  <code>RC1</code> references column 1 (A) of the row the formula is placed in."}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "reply_to_user": {"reputation": 14064, "user_id": 765395, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Xc817.png?s=128&g=1", "display_name": "Robin Mackenzie", "link": "https://stackoverflow.com/users/765395/robin-mackenzie"}, "edited": false, "score": 0, "creation_date": 1489580195, "post_id": 42809011, "comment_id": 72731188, "body": "@RobinMackenzie but <code>aa</code> is a variable, you need to extract it from your formula by adding a <code>&quot; &amp; aa &amp; &quot;</code>"}, {"owner": {"reputation": 14064, "user_id": 765395, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Xc817.png?s=128&g=1", "display_name": "Robin Mackenzie", "link": "https://stackoverflow.com/users/765395/robin-mackenzie"}, "reply_to_user": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1489580330, "post_id": 42809011, "comment_id": 72731270, "body": "@ShaiRado - yes you&#39;re right - didn&#39;t read question properly:( I thought it was a named range."}], "answers": [{"tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": false, "score": 0, "last_activity_date": 1489579825, "creation_date": 1489579825, "answer_id": 42809401, "question_id": 42809011, "link": "https://stackoverflow.com/questions/42809011/vba-excel-formula-compile-error-expected-end-of-statement/42809401#42809401", "title": "VBA Excel formula compile error - expected end of statement", "body": "<p><strong>It's a little long:</strong></p>\n\n<p>You need to add the <code>\"</code> inside your formula, I like to use the <code>Chr(34)</code> to add it.</p>\n\n<p>So first, your <code>aa</code> is a varaible that changes every time you advance <code>i</code> in the loop, so inside the formula you need to break the constant part and add <code>\" &amp; aa &amp; \"</code> every time you use it.\nBut, you need to add the <code>\"</code> to <code>aa</code>, that's why I modifed your <code>aa</code> line to:</p>\n\n<pre><code>aa = Chr(34) &amp; ThisWorkbook.Sheets(3).Cells(i, \"A\").Text &amp; Chr(34)\n</code></pre>\n\n<p>Second, I added a <code>String</code> variable named <code>Myfor</code>, and set the value to it <code>Myfor = Chr(34) &amp; \"for \" &amp; Chr(34)</code>, just to try to \"shorten\" the formula a little.</p>\n\n<p><strong>Code</strong></p>\n\n<pre><code>Dim aa          As String\nDim Myfor       As String\n\nMyfor = Chr(34) &amp; \"for \" &amp; Chr(34)\nFor i = 2 To lastRow\n    aa = Chr(34) &amp; ThisWorkbook.Sheets(3).Cells(i, \"A\").Text &amp; Chr(34)\n    ThisWorkbook.Sheets(3).Cells(i, \"E\").Formula = \"=MID(\" &amp; aa &amp; \",FIND(\" &amp; Myfor &amp; \",\" &amp; aa &amp; \")+4, FIND(\"\" \"\",\" &amp; aa &amp; \",FIND(\" &amp; Myfor &amp; \",\" &amp; aa &amp; \")+4)-(FIND(\" &amp; Myfor &amp; \",\" &amp; aa &amp; \")+4))\"\nNext i\n</code></pre>\n"}], "owner": {"reputation": 159, "user_id": 5179321, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1ec2c077f8c8bcb3d8313897477a568c?s=128&d=identicon&r=PG&f=1", "display_name": "Gaus Shaikh", "link": "https://stackoverflow.com/users/5179321/gaus-shaikh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1706, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1489579825, "creation_date": 1489578830, "last_edit_date": 1531164843, "question_id": 42809011, "link": "https://stackoverflow.com/questions/42809011/vba-excel-formula-compile-error-expected-end-of-statement", "title": "VBA Excel formula compile error - expected end of statement", "body": "<p>I am getting a this error:</p>\n\n<blockquote>\n  <p>Compile error: Expected: End of Statement</p>\n</blockquote>\n\n<p>While trying to use an Excel formula in a VBA statement in the code below.</p>\n\n<p>The error occurs on <code>\"FIND(\"for \",\"...</code></p>\n\n<pre><code>For i = 2 To lastRow\n    aa = ThisWorkbook.Sheets(3).Cells(i, \"A\").Text                  \n    ThisWorkbook.Sheets(3).Cells(i, \"E\").Formula = \"=MID(aa,FIND(\"for \",aa)+4,FIND(\" \",aa,FIND(\"for \",aa)+4)-(FIND(\"for \",aa)+4))\"\nNext i\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1472, "user_id": 1726522, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/0DUTN.gif?s=128&g=1", "display_name": "CMArg", "link": "https://stackoverflow.com/users/1726522/cmarg"}, "edited": false, "score": 0, "creation_date": 1489578037, "post_id": 42808501, "comment_id": 72729661, "body": "Please note that SO is not a &quot;code for me&quot; site. Try a code that 1) loops through all your rows. 2) As loop progreses, check actual and previous values in A column (this will work if data is ordered), and 3) if both values are the same, highlight entire row. Try googling <code>excel vba check two cell values</code> and <code>excel vba highlight row</code>."}, {"owner": {"reputation": 1148, "user_id": 7231593, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kvB-QD-A2Xs/AAAAAAAAAAI/AAAAAAAAAE4/LRTmHQQqx44/photo.jpg?sz=128", "display_name": "John Muggins", "link": "https://stackoverflow.com/users/7231593/john-muggins"}, "edited": false, "score": 0, "creation_date": 1489579745, "post_id": 42808501, "comment_id": 72730897, "body": "This has been asked and answered too many times.  <a href=\"https://www.google.com/search?rls=com.microsoft%3Aen-US%3AIE-Address&amp;q=vba+excel+highlight+row+if+text+is+found+in+cell&amp;oq=vba+excel+highlight+row+if+text+is+found+in+cell&amp;gs_l=serp.12..33i21k1.330561.346010.0.349229.50.41.0.0.0.0.518.5639.0j9j5j3j2j2.21.0..2..0...1.1.64.serp..29.17.4515...0j0i67k1j0i22i30k1j33i160k1.jlFdOctvKdk\" rel=\"nofollow noreferrer\">google.com/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 126, "user_id": 5575763, "user_type": "registered", "accept_rate": 70, "profile_image": "https://graph.facebook.com/747354945368781/picture?type=large", "display_name": "Samadhan Gaikwad", "link": "https://stackoverflow.com/users/5575763/samadhan-gaikwad"}, "edited": false, "score": 0, "creation_date": 1489650691, "post_id": 42809651, "comment_id": 72766382, "body": "It&#39;s working nice, I got code to iterate through 1 to 52 index color but this is just cluttering whole content. So above code is nice to switch between just 2 colors. Also to highlight text in red colors, created new rule in conditional formatting. Added formula =$F1=&quot;Files are on EMEA server&quot; and added =$F:$G to apply rule for."}, {"owner": {"reputation": 21753, "user_id": 3978545, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jmQsw.png?s=128&g=1", "display_name": "Wolfie", "link": "https://stackoverflow.com/users/3978545/wolfie"}, "reply_to_user": {"reputation": 126, "user_id": 5575763, "user_type": "registered", "accept_rate": 70, "profile_image": "https://graph.facebook.com/747354945368781/picture?type=large", "display_name": "Samadhan Gaikwad", "link": "https://stackoverflow.com/users/5575763/samadhan-gaikwad"}, "edited": false, "score": 0, "creation_date": 1489651342, "post_id": 42809651, "comment_id": 72766717, "body": "If you wanted more colours, you look at creating an array of colours, and instead of the swap you could increase some counter, which specifies the element in the array. Depends how important multiple colours are to you, two colours is the simplest option for just separating regions..."}, {"owner": {"reputation": 126, "user_id": 5575763, "user_type": "registered", "accept_rate": 70, "profile_image": "https://graph.facebook.com/747354945368781/picture?type=large", "display_name": "Samadhan Gaikwad", "link": "https://stackoverflow.com/users/5575763/samadhan-gaikwad"}, "edited": false, "score": 0, "creation_date": 1536407526, "post_id": 42809651, "comment_id": 91418648, "body": "Somehow when I&#39;m executing above code from Personal.xlsb, it&#39;s not working."}, {"owner": {"reputation": 21753, "user_id": 3978545, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jmQsw.png?s=128&g=1", "display_name": "Wolfie", "link": "https://stackoverflow.com/users/3978545/wolfie"}, "reply_to_user": {"reputation": 126, "user_id": 5575763, "user_type": "registered", "accept_rate": 70, "profile_image": "https://graph.facebook.com/747354945368781/picture?type=large", "display_name": "Samadhan Gaikwad", "link": "https://stackoverflow.com/users/5575763/samadhan-gaikwad"}, "edited": false, "score": 0, "creation_date": 1536410010, "post_id": 42809651, "comment_id": 91419262, "body": "@Samadhan a year later and a broad &quot;it&#39;s not working&quot; makes things tricky to diagnose. I&#39;d advise asking another question with the issue details"}], "tags": [], "owner": {"reputation": 21753, "user_id": 3978545, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jmQsw.png?s=128&g=1", "display_name": "Wolfie", "link": "https://stackoverflow.com/users/3978545/wolfie"}, "is_accepted": true, "score": 2, "last_activity_date": 1489580925, "last_edit_date": 1489580925, "creation_date": 1489580604, "answer_id": 42809651, "question_id": 42808501, "link": "https://stackoverflow.com/questions/42808501/find-duplicates-in-a-coulmn-and-highlight-row-background-color-with-alternate-co/42809651#42809651", "title": "Find duplicates in a coulmn and highlight row background color with alternate color", "body": "<p>This macro alternates between 2 colours, changing when the value in column A changes.</p>\n\n<pre><code>Sub Highlighting()\n\nDim rw As Long\nDim lastrw As Long\n\n' Define 2 different highlighting colours by their RGB values\nDim col1 As Long\nDim col2 As Long\ncol1 = RGB(255, 230, 180)\ncol2 = RGB(180, 230, 255)\n' \"Current\" colour for highlighting\nDim col As Long\ncol = col1\n\nWith ThisWorkbook.ActiveSheet\n    ' Get last row by last non-empty cell in column A\n    lastrw = .Cells(.Rows.Count, 1).End(xlUp).Row\n    ' Cycle through column A\n    For rw = 1 To lastrw\n        ' Highlight row with current colour\n        .Range(\"A\" &amp; rw &amp; \":G\" &amp; rw).Interior.Color = col\n        ' If column A value in next row is different, change colour\n        If .Cells(rw + 1, 1).Value &lt;&gt; .Cells(rw, 1) Then\n            ' Set to whichever colour it is not\n            If col = col1 Then\n                col = col2\n            Else\n                col = col1\n            End If\n        End If\n    Next rw\nEnd With\n\nEnd Sub\n</code></pre>\n\n<p>Before:</p>\n\n<p><a href=\"https://i.stack.imgur.com/kn8Hz.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/kn8Hz.png\" alt=\"before\"></a></p>\n\n<p>After:</p>\n\n<p><a href=\"https://i.stack.imgur.com/6ZYFY.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/6ZYFY.png\" alt=\"after\"></a></p>\n\n<p>You should be able to change the font colour to red in certain cases, by inserting your own condition <code>If .Range(\"F\" &amp; rw).Value = \"Files ... \"</code> etc into the main <code>For</code> loop.</p>\n"}], "owner": {"reputation": 126, "user_id": 5575763, "user_type": "registered", "accept_rate": 70, "profile_image": "https://graph.facebook.com/747354945368781/picture?type=large", "display_name": "Samadhan Gaikwad", "link": "https://stackoverflow.com/users/5575763/samadhan-gaikwad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 619, "favorite_count": 0, "accepted_answer_id": 42809651, "answer_count": 1, "score": 2, "last_activity_date": 1489580925, "creation_date": 1489577434, "last_edit_date": 1489577630, "question_id": 42808501, "link": "https://stackoverflow.com/questions/42808501/find-duplicates-in-a-coulmn-and-highlight-row-background-color-with-alternate-co", "title": "Find duplicates in a coulmn and highlight row background color with alternate color", "body": "<p><a href=\"https://i.stack.imgur.com/jyQ3v.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/jyQ3v.png\" alt=\"Initial content\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/j2e82.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/j2e82.png\" alt=\"Processed content\"></a></p>\n\n<ol>\n<li>I want to highlight cell colors of rows (text is in column \"A\" to\n\"G\")with same color when value in \"A\" column is same and want to\niterate same operation for all rows &amp; apply alternate colors.</li>\n<li>Also want to change font color to Red in 2 cells (of column \"F\" and\n\"G\") when there is text \"Files are on EMEA server\" in \"F\" column.</li>\n</ol>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 7714459, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1787c932fe868fa2db8b6457513c29ab?s=128&d=identicon&r=PG&f=1", "display_name": "Rapha&#235;l", "link": "https://stackoverflow.com/users/7714459/rapha%c3%abl"}, "edited": false, "score": 0, "creation_date": 1489583283, "post_id": 42808508, "comment_id": 72733482, "body": "Hi , first thank you for the answer! However,I tried what you wrote (I will probably use for my next macros since syntax is simpler than mine) but I still get the same mistake."}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "reply_to_user": {"reputation": 21, "user_id": 7714459, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1787c932fe868fa2db8b6457513c29ab?s=128&d=identicon&r=PG&f=1", "display_name": "Rapha&#235;l", "link": "https://stackoverflow.com/users/7714459/rapha%c3%abl"}, "edited": false, "score": 0, "creation_date": 1489584246, "post_id": 42808508, "comment_id": 72734204, "body": "@Rapha&#235;l  can u edit your post and add the rest of the relevant code ?"}], "tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": false, "score": 1, "last_activity_date": 1489577459, "creation_date": 1489577459, "answer_id": 42808508, "question_id": 42808077, "link": "https://stackoverflow.com/questions/42808077/excel-vba-error-createpivottable-the-object-invoked-has-disconnected-from-its-c/42808508#42808508", "title": "excel VBA error: CreatePivotTable/The object invoked has disconnected from its clients", "body": "<p>Change the line of creating a new <code>PivotTable</code> with the line below:</p>\n\n<pre><code>' create a new Pivot Table in ws2 sheet, start from Cell A1\nSet pvt = ws2.PivotTables.Add(PivotCache:=pvtCache, TableDestination:=StartPvt, TableName:=\"PivotTable10\")\n</code></pre>\n\n<p>Also, you can remove the code line below from your <code>Sub</code>:</p>\n\n<pre><code>StartPvt = ws2.Name &amp; \"!\" &amp; ws2.Range(\"A1\").Address(ReferenceStyle:=xlR1C1)\n</code></pre>\n\n<p>And replace the <code>Set pvt</code> line with:</p>\n\n<pre><code>Set pvt = ws2.PivotTables.Add(PivotCache:=pvtCache, TableDestination:=ws2.Range(\"A1\"), TableName:=\"PivotTable10\")\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 21, "user_id": 7714459, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1787c932fe868fa2db8b6457513c29ab?s=128&d=identicon&r=PG&f=1", "display_name": "Rapha&#235;l", "link": "https://stackoverflow.com/users/7714459/rapha%c3%abl"}, "is_accepted": false, "score": 0, "last_activity_date": 1489662283, "creation_date": 1489662283, "answer_id": 42832291, "question_id": 42808077, "link": "https://stackoverflow.com/questions/42808077/excel-vba-error-createpivottable-the-object-invoked-has-disconnected-from-its-c/42832291#42832291", "title": "excel VBA error: CreatePivotTable/The object invoked has disconnected from its clients", "body": "<p>For people with a common problem, I solved the issue regrouping pivot cache creation and pivot table creation in one line:</p>\n\n<pre><code>wb.PivotCaches.Create(SourceType:=xlDatabase, SourceData:= _\n        ws.Name &amp; \"!\" &amp; ws.Range(\"A1\").CurrentRegion.Address(ReferenceStyle:=xlR1C1), Version:=6).CreatePivotTable _\n        TableDestination:=ws2.Range(\"A1\"), TableName:=\"PivotTable10\", DefaultVersion _\n        :=6\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 7714459, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1787c932fe868fa2db8b6457513c29ab?s=128&d=identicon&r=PG&f=1", "display_name": "Rapha&#235;l", "link": "https://stackoverflow.com/users/7714459/rapha%c3%abl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 343, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1489662283, "creation_date": 1489576239, "last_edit_date": 1531164843, "question_id": 42808077, "link": "https://stackoverflow.com/questions/42808077/excel-vba-error-createpivottable-the-object-invoked-has-disconnected-from-its-c", "title": "excel VBA error: CreatePivotTable/The object invoked has disconnected from its clients", "body": "<p>I have checked several forums to look for my problem but offered solutions don't seem to match with my code.</p>\n\n<p>I created the following code which is quite usual (used it in many macros and never had a problem like this). I call this sub in another one. All variables are declared (some in public to use through the different subs). It eventually works but excel crashes for 4-5 minutes before it gives the result. </p>\n\n<p>The crashing line is this one : </p>\n\n<pre><code>Set pvt = pvtCache.CreatePivotTable( _\n                   TableDestination:=StartPvt, _\n                   TableName:=\"PivotTable10\")`\n</code></pre>\n\n<p>I can't identify the reason. The only thing is that when I ask to recover it gives me the following message:</p>\n\n<blockquote>\n  <p>The object invoked has disconnected from its clients</p>\n</blockquote>\n\n<p><strong>Code</strong></p>\n\n<pre><code>Option Explicit\nSub point23()\n\nDim a, i As Long\nDim dict As Dictionary\nDim wb1 As Workbook, ws1 As Worksheet, wb As Workbook, ws As Worksheet, ws2 \n\nAs Worksheet, ws3 As Worksheet\nDim FolderPath1 As String, filename1 As String, FolderPath As String,     FileName As String,\nDim FC As Integer, FCC As Integer, LC As Integer, LR As Integer\nDim pvtCache As PivotCache, pvt As PivotTable\nDim StartPvt As String, SrcData As Range, pf As String, pf_Name As String\n\nApplication.DisplayAlerts = False\nApplication.Calculation = xlCalculationManual\nApplication.ScreenUpdating = False\nApplication.AskToUpdateLinks = False\n\nFolderPath = ...\nFileName = ...\n\nFolderPath1 = ....\nfilename1 = ....\n\nSet wb = Workbooks.Open(FolderPath &amp; FileName)\nwb.Sheets(1).Copy Before:=Sheets(1)\nSet ws = wb.Worksheets(1)\n\nws.Cells.UnMerge\n\nFor i = 1 To 20\nFor j = 1 To 20\nIf ws.Cells(i, j).Value = \"X\" Then\nFR = ws.Cells(i, j).Row\nj = 20\ni = 20\nEnd If\nNext j\nNext i\n\nws.Rows(\"1\").Resize(FR - 1).EntireRow.Delete\n\nLC = ws.Cells(45, Columns.Count).End(xlToLeft).Column\nLR = ws.Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n\nSet wb1 = Workbooks.Open(FolderPath1 &amp; filename1)\nSet ws1 = wb1.Worksheets(1)\n\nFor i = 1 To 20\n\nIf ws1.Cells(1, i).Value = \"X\" Then\nFC = ws1.Cells(1, i).Column\nExit For\nEnd If\nNext i\n\nFor i = 1 To 20\nIf ws1.Cells(1, i).Value = \"X\" Then\nFCC = ws1.Cells(1, i).Column\nExit For\nEnd If\nNext i\n\nSet dict = New Dictionary\n</code></pre>\n\n<p>'Perform Vlookups using dictionaries</p>\n\n<pre><code>a = ws1.Range(\"a1\").CurrentRegion.Resize(, FC).Value\n' Fill the dictionary\nWith dict\nFor i = 2 To UBound(a, 1)\n.Item(a(i, FCC)) = a(i, FC)\nNext\n</code></pre>\n\n<p>'Do the loop</p>\n\n<pre><code>ws.Range(\"a1\").EntireColumn.Insert\na = ws.Range(\"A1\").CurrentRegion.Resize(, FCC).Value\nFor i = 2 To UBound(a, 1)\nIf .Exists(a(i, 2)) Then\nws.Cells(i, 1).Value = .Item(a(i, 2))\nElse: ws.Cells(i, 1).Value = \"#N\\A\"\nEnd If\n\nNext\nEnd With\ndict.RemoveAll\n\nwb1.Close\n\nWith ws.Range(\"A1\")\n.Value = \"X\"\n.Resize(, 2).EntireColumn.Insert\nEnd With\n\nFor i = 1 To LR\nIf ws.Cells(1, i).Value = vbNullString Then\nws.Cells(1, i).Value = \"X\"\nEnd If\nNext i\n\nFor i = 2 To LR\nWith ws\n    .Cells(1, 1).Value = \"X\"\n    .Cells(i, 1).Value = Cells(i, 3).Value &amp; Cells(i, 12).Value\n    .Cells(i, 2).Value = Cells(i, 4).Value &amp; Cells(i, 6).Value\nEnd With\nNext i\n</code></pre>\n\n<p>'Create Pivot</p>\n\n<pre><code>wb.Worksheets.Add After:=wb.Worksheets(1)\nSet ws2 = wb.Sheets(2)\n\n\n  ws.Activate\n  Set SrcData = ws.Range(\"A2\").CurrentRegion\n  ws2.Activate\n\n  Set pvtCache = wb.PivotCaches.Create( _\n    SourceType:=xlDatabase, _\n    SourceData:=SrcData)\n\nSet pvt = ws2.PivotTables.Add(PivotCache:=pvtCache, TableDestination:=ws2.Range(\"A1\"), TableName:=\"PivotTable10\")\n\npvt.PivotFields(\"X\").Orientation = xlRowField\npvt.PivotFields(\"X\").Orientation = xlRowField\npvt.PivotFields(\"X\").Orientation = xlRowField\n\n'create columns of the pivot\npf = \"X\"\npf_Name = \"Sum \" &amp; pf\npvt.AddDataField pvt.PivotFields(pf), pf_Name, xlSum\n\nWith ws2.PivotTables(\"PivotTable10\")\n        .InGridDropZones = True\n        .RowAxisLayout xlTabularRow\nEnd With\n\nWith ws2\n    .PivotTables(\"PivotTable10\").PivotFields(\"Xl\").Subtotals = _\n        Array(False, False, False, False, False, False, False, False, False, False, False, False)\n    .PivotTables(\"PivotTable10\").PivotFields(\"X\").Subtotals = _\n        Array(False, False, False, False, False, False, False, False, False, False, False, False)\n    .PivotTables(\"PivotTable10\").PivotFields(\"X\").Subtotals = _\n        Array(False, False, False, False, False, False, False, False, False, False, False, False)\n    .PivotTables(\"PivotTable10\").RepeatAllLabels xlRepeatLabels\n    .PivotTables(\"PivotTable10\").ColumnGrand = False\nEnd With\n\nws2.Range(\"A1\").CurrentRegion.Copy\nwb.Worksheets.Add After:=wb.Worksheets(2)\nSet ws3 = wb.Worksheets(3)\nWith ws3\n    .Name = \"Sum X\"\n    .Range(\"A1\").PasteSpecial xlPasteValues\nEnd With\n\nws3.Rows.AutoFit\n\nws.Delete\nwb.Save\nwb.Close\n\nApplication.DisplayAlerts = True\nApplication.Calculation = xlCalculationManual\nApplication.ScreenUpdating = True\nApplication.AskToUpdateLinks = True\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1489576254, "post_id": 42807899, "comment_id": 72728503, "body": "<code>Cells(rows.count, 1).End(xlup).Row</code> and <code>split</code> function will assist."}, {"owner": {"reputation": 27, "user_id": 7714417, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/26191b1e362bc25dc7d90fa8b275463b?s=128&d=identicon&r=PG&f=1", "display_name": "Kalain", "link": "https://stackoverflow.com/users/7714417/kalain"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1489577290, "post_id": 42807899, "comment_id": 72729187, "body": "Thanks Nathan, I doesnt work with split yet. But I thinks I dont need this function. The Text is already splitted in Column A and B. Or is it a missunterstanding?"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1489579580, "post_id": 42807899, "comment_id": 72730774, "body": "sorry, I understand now :)  you need to wrap this up in another loop, so something like <code>do until range(&quot;a&quot; &amp; lr+1).value=&quot;&quot;</code>, then retain the <code>LR = Cells(1, 1).End(xlDown).Row</code>, but change to <code>LR = Cells(LR, 1).End(xlDown).Row</code>  I&#39;ll mock an answer up"}, {"owner": {"reputation": 1148, "user_id": 7231593, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kvB-QD-A2Xs/AAAAAAAAAAI/AAAAAAAAAE4/LRTmHQQqx44/photo.jpg?sz=128", "display_name": "John Muggins", "link": "https://stackoverflow.com/users/7231593/john-muggins"}, "edited": false, "score": 0, "creation_date": 1489580220, "post_id": 42807899, "comment_id": 72731200, "body": "Does each block have the exact same number of lines, and are the names on the left always the same?  If so then you can use the split function on the space &quot; &quot; as @Kalain suggested to separate the names from the value and put them into  two arrays."}], "answers": [{"tags": [], "owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "is_accepted": true, "score": 1, "last_activity_date": 1489580239, "creation_date": 1489580239, "answer_id": 42809540, "question_id": 42807899, "link": "https://stackoverflow.com/questions/42807899/excel-vba-looking-for-strings-in-text-block-then-look-in-the-next/42809540#42809540", "title": "Excel VBA - Looking for Strings in &quot;Text Block&quot; , then look in the next", "body": "<p>something like </p>\n\n<pre><code>Sub SO1()\n\nDim lngRow As Long\nDim lngLastRowOfSection As Long\nDim rngFind As Range\nDim strName As String\n\nlngRow = 1\n\nDo Until Cells(lngRow + 1, 1).Value = \"\"\n\n    lngLastRowOfSection = Cells(lngRow, 1).End(xlDown).Row\n    Set rngFind = Range(Cells(lngRow, 1), Cells(lngLastRowOfSection, 1)).Find(\"name\")\n    If Not rngFind Is Nothing Then\n        strName = rngFind.Offset(0, 1).Value\n        Debug.Print strName\n    End If\n\n    lngRow = Cells(lngLastRowOfSection, 1).End(xlDown).Row\n    If lngRow &gt;= Rows.Count Then Exit Do\n\nLoop\n\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1489583780, "post_id": 42810672, "comment_id": 72733869, "body": "It seems as though you re-programmed here the `text-to-columns&quot; button in Excel."}, {"owner": {"reputation": 1148, "user_id": 7231593, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kvB-QD-A2Xs/AAAAAAAAAAI/AAAAAAAAAE4/LRTmHQQqx44/photo.jpg?sz=128", "display_name": "John Muggins", "link": "https://stackoverflow.com/users/7231593/john-muggins"}, "reply_to_user": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1489584114, "post_id": 42810672, "comment_id": 72734115, "body": "Well, yes.  I didn&#39;t think about that.  I know he wants to put the data on another worksheet.  What I did here was give him the logic - not the code he needs to accomplish his end goal.  He can replace the last &quot;for i&quot; loop to accommodate his actual needs.  The thing is that he now has the data in an array that he can split in any way he needs."}], "tags": [], "owner": {"reputation": 1148, "user_id": 7231593, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kvB-QD-A2Xs/AAAAAAAAAAI/AAAAAAAAAE4/LRTmHQQqx44/photo.jpg?sz=128", "display_name": "John Muggins", "link": "https://stackoverflow.com/users/7231593/john-muggins"}, "is_accepted": false, "score": 1, "last_activity_date": 1489583689, "last_edit_date": 1489583689, "creation_date": 1489583142, "answer_id": 42810672, "question_id": 42807899, "link": "https://stackoverflow.com/questions/42807899/excel-vba-looking-for-strings-in-text-block-then-look-in-the-next/42810672#42810672", "title": "Excel VBA - Looking for Strings in &quot;Text Block&quot; , then look in the next", "body": "<p>I might have misunderstood the question.  I think you meant that each line of your data has the name and data separated by a space.  I manipulated your subroutine to put all values in column a into an array and then I split the array into columns B and C.</p>\n\n<pre><code>Sub find_test()\n\nDim rng As Range\nDim LR As Long\nDim tRow As Long\nDim myArray() As Variant, arrayCounter As Long\nDim lilStringArray\n'\n\n    LR = ActiveSheet.Cells(ActiveSheet.Rows.Count, \"A\").End(xlUp).Row\n    ReDim myArray(1 To 1)\n    arrayCounter = 1\n    myArray = Range(\"A1:A\" &amp; LR)\n    tRow = 1\n    For i = LBound(myArray) To UBound(myArray)\n        If myArray(i, 1) &lt;&gt; \"\" Then\n            lilStringArray = Split(myArray(i, 1), \" \")\n            Range(\"B\" &amp; tRow).Value = lilStringArray(0)\n            On Error Resume Next\n                Range(\"C\" &amp; tRow).Value = lilStringArray(1)\n            On Error GoTo 0\n        Else\n             Range(\"C\" &amp; tRow).Value = \"\"\n        End If\n        tRow = tRow + 1\n    Next i\n\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 27, "user_id": 7714417, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/26191b1e362bc25dc7d90fa8b275463b?s=128&d=identicon&r=PG&f=1", "display_name": "Kalain", "link": "https://stackoverflow.com/users/7714417/kalain"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 151, "favorite_count": 0, "accepted_answer_id": 42809540, "answer_count": 2, "score": 1, "last_activity_date": 1489583689, "creation_date": 1489575778, "question_id": 42807899, "link": "https://stackoverflow.com/questions/42807899/excel-vba-looking-for-strings-in-text-block-then-look-in-the-next", "title": "Excel VBA - Looking for Strings in &quot;Text Block&quot; , then look in the next", "body": "<p>I doesnt find a solution for my problem in the WWW.\nHope you can help me:</p>\n\n<p>I've imported a long text file with various information: it looks like this:</p>\n\n<pre><code>id 5\nname node1\nUPS_serial_number\nWWNN 500507680350BD\nstatus online\nIO_group_id 0\nIO_group_name io_grp0\npartner_node_id 4\npartner_node_name node2\nconfig_node yes\nUPS_unique_id\nport_id 500507680456454\nport_status active\nport_speed 8Gb\nport_id 500507680545644\nport_status active\nport_speed 8Gb\n\nid 4\nname node2\nUPS_serial_number\nWWNN 500507680200DDE8\nstatus online\nIO_group_id 0\nIO_group_name io_grp0\npartner_node_id 4\npartner_node_name node1\nconfig_node yes\nUPS_unique_id\nport_id 5005076803594BDE\nport_status active\nport_speed 8Gb\nport_id 500507680235486F\nport_status active\nport_speed 8Gb\n\n.\n.\n.\n</code></pre>\n\n<p>Its almost formatted in the right format like this:\n[string || value]</p>\n\n<p>I want to look in the first block and get the infos for name, id, WWPN - then copy the values to another worksheet.\nThen look into the second block and get the same infos: name, id, WWPN and copy them.</p>\n\n<p>Then next block and the next block and so on.</p>\n\n<p>I have the following code:</p>\n\n<pre><code>Sub find_test()\n\nDim rng As Range\nDim rngCell As Variant\nDim LR As Long\nDim tRow\nLR = Cells(1, 1).End(xlDown).Row\nSet rng = Range(\"A1:A\" &amp; LR)\n\nFor Each rngCell In rng.Cells\n\ntRow = rngCell.Row\n If StrComp(rngCell.Value, \"name\") = 0 Then                                      'Node 1 Service IP\n        Worksheets(\"temp\").Range(\"E16\").Value = Worksheets(\"lsnodecanister\").Range(\"B\" &amp; tRow).Value\n     End If\n     Next\n\n\nEnd Sub\n</code></pre>\n\n<p>The Text blocks are almost seperated by an empty row.</p>\n\n<p>Do you have any idea? \nHope it was understandable.</p>\n\n<p>Thank you very much,</p>\n\n<p>Best regards,\nKalain</p>\n"}, {"tags": ["excel", "vba", "outlook"], "comments": [{"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 2, "creation_date": 1489574143, "post_id": 42807041, "comment_id": 72726970, "body": "Please don&#39;t use <a href=\"https://stackoverflow.com/questions/tagged/macros\">macros</a> for VBA related questions! Further more for sending notes to individuals in your list, you should definitely <b>use <a href=\"https://support.office.com/en-us/article/Mail-merge-using-an-Excel-spreadsheet-858c7d7f-5cc0-4ba1-9a7b-0a948fa3d7d3\" rel=\"nofollow noreferrer\">Word&#39;s Mailing tools</b></a> (click it, I&#39;ve linked the relevant MS thread) rather than VBA code, that is exactly what it is supposed to do! ;)"}], "answers": [{"comments": [{"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 0, "creation_date": 1489574675, "post_id": 42807258, "comment_id": 72727333, "body": "Probably working, but not using the good <code>With</code> from the OP! ;)"}], "tags": [], "owner": {"reputation": 41, "user_id": 7688572, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8dfbec6a3b557ba9daeb05823edcbd2?s=128&d=identicon&r=PG&f=1", "display_name": "Dhanappa Baddole", "link": "https://stackoverflow.com/users/7688572/dhanappa-baddole"}, "is_accepted": false, "score": 0, "last_activity_date": 1489574906, "last_edit_date": 1489574906, "creation_date": 1489574185, "answer_id": 42807258, "question_id": 42807041, "link": "https://stackoverflow.com/questions/42807041/how-to-copy-range-from-excel-to-outlook-ignoring-the-first-column-where-filter-i/42807258#42807258", "title": "How to copy range from excel to outlook ignoring the first column where filter is applicable?", "body": "<p>By using offset you can select specific filtered column without heading or with heading</p>\n\n<p>Please have a look below code : </p>\n\n<pre><code>Set rng = .AutoFilter.Range.Offset(1, ColumnNumber).Resize(.AutoFilter.Range.Rows.Count - 1, ColumnCount).SpecialCells(xlCellTypeVisible)\n</code></pre>\n\n<p>ColumnNumber - start column to copy\nColumnCount -  number of columns to copy</p>\n\n<p>Try below one :</p>\n\n<p>set rng = Ash.Autofilter.Range.Offset(1).Resize(Ash.AutoFilter.Range.Rows.Count - 1,7).SpecialCells(xlCellTypeVisible)</p>\n"}, {"tags": [], "owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "is_accepted": true, "score": 0, "last_activity_date": 1489574380, "creation_date": 1489574380, "answer_id": 42807339, "question_id": 42807041, "link": "https://stackoverflow.com/questions/42807041/how-to-copy-range-from-excel-to-outlook-ignoring-the-first-column-where-filter-i/42807339#42807339", "title": "How to copy range from excel to outlook ignoring the first column where filter is applicable?", "body": "<p>If you want to stick with your solution rather than using <a href=\"https://support.office.com/en-us/article/Mail-merge-using-an-Excel-spreadsheet-858c7d7f-5cc0-4ba1-9a7b-0a948fa3d7d3\" rel=\"nofollow noreferrer\">Word's Mailing tools</a>,</p>\n\n<p>Just change this line :</p>\n\n<pre><code>Set rng = .SpecialCells(xlCellTypeVisible)\n</code></pre>\n\n<p>To </p>\n\n<pre><code>Set rng = Application.Intersect(.SpecialCells(xlCellTypeVisible),Ash.Range(\"B:H\"))\n</code></pre>\n"}], "owner": {"reputation": 133, "user_id": 6633301, "user_type": "registered", "accept_rate": 62, "profile_image": "https://lh4.googleusercontent.com/-3FTx74t3OXc/AAAAAAAAAAI/AAAAAAAAAFE/MGWCSzXiIIc/photo.jpg?sz=128", "display_name": "Revan Erraboina", "link": "https://stackoverflow.com/users/6633301/revan-erraboina"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 123, "favorite_count": 0, "accepted_answer_id": 42807339, "answer_count": 2, "score": 3, "last_activity_date": 1592949501, "creation_date": 1489573712, "last_edit_date": 1592949501, "question_id": 42807041, "link": "https://stackoverflow.com/questions/42807041/how-to-copy-range-from-excel-to-outlook-ignoring-the-first-column-where-filter-i", "title": "How to copy range from excel to outlook ignoring the first column where filter is applicable?", "body": "<p>Hi I got a code which would filter the unique values in the A column and copy the whole range from A1:H, but I want to ignore the first column and want range to be copied form B1:H.</p>\n\n<p>Eg: if there is a table with marks of students and I want to post the individual marks table to every student separately. This macro is sending the table along with the student name which is in the first column, but I need only marks table, don't need students name along with that.</p>\n\n<p>Here is my code</p>\n\n<pre><code>Sub Send_Row_Or_Rows_1()\n\nDim OutApp As Object\nDim OutMail As Object\nDim rng As Range\nDim Ash As Worksheet\nDim Cws As Worksheet\nDim Rcount As Long\nDim Rnum As Long\nDim FilterRange As Range\nDim FieldNum As Integer\nDim mailAddress As String\nDim StrBody As String\n\nOn Error GoTo cleanup\nSet OutApp = CreateObject(\"Outlook.Application\")\n\nWith Application\n    .EnableEvents = False\n    .ScreenUpdating = False\nEnd With\n\n\nSet Ash = ActiveSheet\n\n'Set filter range and filter column (Column with names)\nSet FilterRange = Ash.Range(\"A1:H\" &amp; Ash.Rows.Count)\nFieldNum = 1    'Filter column = A because the filter range start in A\n\n'Add a worksheet for the unique list and copy the unique list in A1\nSet Cws = Worksheets.Add\nFilterRange.Columns(FieldNum).AdvancedFilter _\n        Action:=xlFilterCopy, _\n        CopyToRange:=Cws.Range(\"A1\"), _\n        CriteriaRange:=\"\", Unique:=True\n\n'Count of the unique values + the header cell\nRcount = Application.WorksheetFunction.CountA(Cws.Columns(1))\n\n'If there are unique values start the loop\nIf Rcount &gt;= 2 Then\n    For Rnum = 2 To Rcount\n\n        'Filter the FilterRange on the FieldNum column\n        FilterRange.AutoFilter Field:=FieldNum, _\n                               Criteria1:=Cws.Cells(Rnum, 1).Value\n\n        'Look for the mail address in the MailInfo worksheet\n        mailAddress = \"\"\n        On Error Resume Next\n        mailAddress = Application.WorksheetFunction. _\n                      VLookup(Cws.Cells(Rnum, 1).Value, _\n                            Worksheets(\"Mailinfo\").Range(\"A1:B\" &amp; _\n                            Worksheets(\"Mailinfo\").Rows.Count), 2, False)\n        On Error GoTo 0\n\n        If mailAddress &lt;&gt; \"\" Then\n            With Ash.AutoFilter.Range\n                On Error Resume Next\n                Set rng = .SpecialCells(xlCellTypeVisible)\n                On Error GoTo 0\n            End With\n\n            Set OutMail = OutApp.CreateItem(0)\n\n            On Error Resume Next\n\n            With OutMail\n                .to = mailAddress\n                .Subject = \"Test mail\"\n                .HTMLBody = StrBody &amp; RangetoHTML(rng)\n                .Display  'Or use Send\n\n                StrBody = Sheets(\"Body\").Range(\"A1\").Value &amp; \"&lt;br&gt;\" &amp; _\n          Sheets(\"Body\").Range(\"A2\").Value &amp; \"&lt;br&gt;\" &amp; _\n          Sheets(\"Body\").Range(\"A3\").Value &amp; \"&lt;br&gt;&lt;br&gt;&lt;br&gt;\"\n\n            End With\n            On Error GoTo 0\n\n            Set OutMail = Nothing\n        End If\n\n        'Close AutoFilter\n        Ash.AutoFilterMode = False\n\n    Next Rnum\nEnd If\n\ncleanup:\nSet OutApp = Nothing\nApplication.DisplayAlerts = False\nCws.Delete\nApplication.DisplayAlerts = True\n\nWith Application\n    .EnableEvents = True\n    .ScreenUpdating = True\nEnd With\nEnd Sub\n</code></pre>\n"}, {"tags": ["arrays", "vba", "excel", "range"], "comments": [{"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 0, "creation_date": 1489572039, "post_id": 42806350, "comment_id": 72725435, "body": "varGetArrayAll = ActiveSheet.Range(&quot;$F$3:$F$100&quot;).Value"}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 7276606, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-2lGisXsiKIk/AAAAAAAAAAI/AAAAAAAAA70/7InvS6U9UaA/photo.jpg?sz=128", "display_name": "Florian NYC", "link": "https://stackoverflow.com/users/7276606/florian-nyc"}, "edited": false, "score": 0, "creation_date": 1489572712, "post_id": 42806446, "comment_id": 72725926, "body": "You saved my day. Thank you. Works perfectly!!"}], "tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": true, "score": 2, "last_activity_date": 1489572174, "creation_date": 1489572174, "answer_id": 42806446, "question_id": 42806350, "link": "https://stackoverflow.com/questions/42806350/vba-take-values-from-selected-range-f1f100-in-array/42806446#42806446", "title": "VBA - Take values from selected Range (F$1:F$100) in Array", "body": "<p>If you want to get the Range into a 1-D array, then use <code>Application.Transpose</code>, like in the line below:</p>\n\n<pre><code>varGetArrayAll = Application.Transpose(ActiveSheet.Range(\"$F$3:$F$100\").Value)\n</code></pre>\n\n<p>However, you shouldn't rely on <code>ActiveSheet</code>, you should fully qualify your <code>Range</code> with the worksheet is it in, like in the code below:</p>\n\n<pre><code>' replace \"Sheet1\" with your sheet's name\nvarGetArrayAll = Application.Transpose(Worksheets(\"Sheet1\").Range(\"$F$3:$F$100\").Value)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 1, "last_activity_date": 1489572434, "creation_date": 1489572434, "answer_id": 42806554, "question_id": 42806350, "link": "https://stackoverflow.com/questions/42806350/vba-take-values-from-selected-range-f1f100-in-array/42806554#42806554", "title": "VBA - Take values from selected Range (F$1:F$100) in Array", "body": "<p>Try it like this:</p>\n\n<pre><code>Public Sub TestMe()\n\n    Dim vargetArrayAll  As Range 'or as Variant, to look like your code.\n    Dim counter         As Long\n\n    Set vargetArrayAll = Selection\n\n    For counter = 1 To vargetArrayAll.Count\n        Debug.Print vargetArrayAll(counter)\n    Next counter\n\nEnd Sub\n</code></pre>\n\n<p>Thus, you set the value as a range and you can acces its elements as if it is an array. However, you start with <code>1</code>, not with <code>0</code>.</p>\n"}], "owner": {"reputation": 23, "user_id": 7276606, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-2lGisXsiKIk/AAAAAAAAAAI/AAAAAAAAA70/7InvS6U9UaA/photo.jpg?sz=128", "display_name": "Florian NYC", "link": "https://stackoverflow.com/users/7276606/florian-nyc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 59, "favorite_count": 0, "accepted_answer_id": 42806446, "answer_count": 2, "score": 2, "last_activity_date": 1489572434, "creation_date": 1489571905, "last_edit_date": 1489571964, "question_id": 42806350, "link": "https://stackoverflow.com/questions/42806350/vba-take-values-from-selected-range-f1f100-in-array", "title": "VBA - Take values from selected Range (F$1:F$100) in Array", "body": "<p>I try to create an array with values from a range of selected cells.</p>\n\n<p>What I have so far is following:</p>\n\n<pre><code>ActiveSheet.Range(\"$F$3:$F$100\").Select\nvarGetArrayAll = Selection\n</code></pre>\n\n<p>But it only creates the array with the first cell F3.</p>\n\n<p>I would appreciate if someone can help me. </p>\n"}, {"tags": ["excel", "text-files", "delimiter", "vba"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1489573805, "post_id": 42805779, "comment_id": 72726741, "body": "Why don&#39;t you just replace <code>|</code> with a line break before you import the file. This would make it much easier."}, {"owner": {"reputation": 63, "user_id": 7713865, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/fe01f5392d692c7bd750f1f9edbd1d45?s=128&d=identicon&r=PG&f=1", "display_name": "rei123", "link": "https://stackoverflow.com/users/7713865/rei123"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1489574584, "post_id": 42805779, "comment_id": 72727270, "body": "@Peh I cant replace because the text file are generated in other equipment."}], "answers": [{"comments": [{"owner": {"reputation": 63, "user_id": 7713865, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/fe01f5392d692c7bd750f1f9edbd1d45?s=128&d=identicon&r=PG&f=1", "display_name": "rei123", "link": "https://stackoverflow.com/users/7713865/rei123"}, "edited": false, "score": 0, "creation_date": 1489574699, "post_id": 42806894, "comment_id": 72727350, "body": "Hi, Thank you for the reply.  Thank you for the reply. Im getting a type mismathc error on this line :     .Cells(2, 1) = Format(DateValue(aRow(0)), &quot;d/m/yy&quot;)"}, {"owner": {"reputation": 585, "user_id": 7689006, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JH9Nj.png?s=128&g=1", "display_name": "Winterknell", "link": "https://stackoverflow.com/users/7689006/winterknell"}, "reply_to_user": {"reputation": 63, "user_id": 7713865, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/fe01f5392d692c7bd750f1f9edbd1d45?s=128&d=identicon&r=PG&f=1", "display_name": "rei123", "link": "https://stackoverflow.com/users/7713865/rei123"}, "edited": false, "score": 0, "creation_date": 1489577129, "post_id": 42806894, "comment_id": 72729077, "body": "@Peh, you&#39;re right and you&#39;re wrong. You&#39;re right to highlight date issues, but my local date format is d/m/y and the date in the data is &quot;27/2/2017 17:14:32&quot;. So my date calculation works for me and also fits the data, which is d/m/y. If the data had been y/m/d or m/d/y I would have calculated the date a different way. Incidentally, DATESERIAL is not a panacea, because it depends on prior knowledge - namely which part of the date is the year, which is the month, and which is the day. If a data date is going to vary in its format, someday you&#39;ll end up stuffing the year into the day anyway!"}, {"owner": {"reputation": 585, "user_id": 7689006, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JH9Nj.png?s=128&g=1", "display_name": "Winterknell", "link": "https://stackoverflow.com/users/7689006/winterknell"}, "reply_to_user": {"reputation": 63, "user_id": 7713865, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/fe01f5392d692c7bd750f1f9edbd1d45?s=128&d=identicon&r=PG&f=1", "display_name": "rei123", "link": "https://stackoverflow.com/users/7713865/rei123"}, "edited": false, "score": 0, "creation_date": 1489577782, "post_id": 42806894, "comment_id": 72729492, "body": "At any rate, the solution I&#39;ve chosen here is simply to strip the time from the timestamp and present the raw date, which OP can massage as he chooses. The rest really is up to the student!"}, {"owner": {"reputation": 63, "user_id": 7713865, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/fe01f5392d692c7bd750f1f9edbd1d45?s=128&d=identicon&r=PG&f=1", "display_name": "rei123", "link": "https://stackoverflow.com/users/7713865/rei123"}, "edited": false, "score": 0, "creation_date": 1489580222, "post_id": 42806894, "comment_id": 72731202, "body": "I&#39;m still getting the Type mismatch error after I added the declarations"}, {"owner": {"reputation": 585, "user_id": 7689006, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JH9Nj.png?s=128&g=1", "display_name": "Winterknell", "link": "https://stackoverflow.com/users/7689006/winterknell"}, "reply_to_user": {"reputation": 63, "user_id": 7713865, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/fe01f5392d692c7bd750f1f9edbd1d45?s=128&d=identicon&r=PG&f=1", "display_name": "rei123", "link": "https://stackoverflow.com/users/7713865/rei123"}, "edited": false, "score": 0, "creation_date": 1489580493, "post_id": 42806894, "comment_id": 72731369, "body": "Have you updated the date line? .Cells(2, 1) = Trim(Left(aRow(0), InStr(aRow(0), &quot; &quot;)))"}, {"owner": {"reputation": 63, "user_id": 7713865, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/fe01f5392d692c7bd750f1f9edbd1d45?s=128&d=identicon&r=PG&f=1", "display_name": "rei123", "link": "https://stackoverflow.com/users/7713865/rei123"}, "edited": false, "score": 0, "creation_date": 1489582744, "post_id": 42806894, "comment_id": 72733044, "body": "Thanks! missed that one out, but im still not getting what I want it to be. This is what im getting now: <a href=\"https://i.stack.imgur.com/8Lvu5.jpg\" rel=\"nofollow noreferrer\">i.stack.imgur.com/8Lvu5.jpg</a>"}, {"owner": {"reputation": 585, "user_id": 7689006, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JH9Nj.png?s=128&g=1", "display_name": "Winterknell", "link": "https://stackoverflow.com/users/7689006/winterknell"}, "reply_to_user": {"reputation": 63, "user_id": 7713865, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/fe01f5392d692c7bd750f1f9edbd1d45?s=128&d=identicon&r=PG&f=1", "display_name": "rei123", "link": "https://stackoverflow.com/users/7713865/rei123"}, "edited": false, "score": 0, "creation_date": 1489583358, "post_id": 42806894, "comment_id": 72733551, "body": "You&#39;ve got a pipe (&quot;|&quot;) visible in your latest output (as &quot;0|0&quot;), so whatever you&#39;re doing the splits aren&#39;t working right. That&#39;s the very first split in my code: <code>aRow = Split(sLine, &quot;|&quot;)</code> Since your data is not split at the pipes, it&#39;s all going into one column."}, {"owner": {"reputation": 63, "user_id": 7713865, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/fe01f5392d692c7bd750f1f9edbd1d45?s=128&d=identicon&r=PG&f=1", "display_name": "rei123", "link": "https://stackoverflow.com/users/7713865/rei123"}, "edited": false, "score": 0, "creation_date": 1489585744, "post_id": 42806894, "comment_id": 72735346, "body": "I just posted my code above. Is my code structured right? the date is not entered now"}], "tags": [], "owner": {"reputation": 585, "user_id": 7689006, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JH9Nj.png?s=128&g=1", "display_name": "Winterknell", "link": "https://stackoverflow.com/users/7689006/winterknell"}, "is_accepted": true, "score": 0, "last_activity_date": 1489578029, "last_edit_date": 1489578029, "creation_date": 1489573336, "answer_id": 42806894, "question_id": 42805779, "link": "https://stackoverflow.com/questions/42805779/vba-import-delimited-text-file-to-excel/42806894#42806894", "title": "VBA import delimited text file to Excel", "body": "<p>Edited to remove a date objection and declare my variables</p>\n\n<pre><code>Dim aCol, aRow, aNames, colNow As Long, rowNow As Long, sLine As String\n'Text to Columns\naRow = Split(sLine, \"|\")\nWith ActiveSheet\n    .Cells(2, 1) = Trim(Left(aRow(0), InStr(aRow(0), \" \")))\n    '.Cells(2, 1) = Format(DateValue(aRow(0)), \"d/m/yy\")\n    For rowNow = 1 To UBound(aRow)\n        aCol = Split(aRow(rowNow), \",\")\n        For colNow = 0 To UBound(aCol)\n            Sheet1.Cells(rowNow + 1, colNow + 2) = aCol(colNow)\n        Next\n    Next\nEnd With\n</code></pre>\n\n<p>Oh, edited to add the column headers:</p>\n\n<pre><code>aNames = Array(\"Date and Time\", \"John\", \"Kate\", \"Sean\", \"Stephen\", \"Brian\", \"Philip\", \"Peter\")\nFor colNow = 0 To UBound(aNames)\n    ActiveSheet.Cells(1, colNow + 1) = aNames(colNow)\nNext\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 63, "user_id": 7713865, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/fe01f5392d692c7bd750f1f9edbd1d45?s=128&d=identicon&r=PG&f=1", "display_name": "rei123", "link": "https://stackoverflow.com/users/7713865/rei123"}, "is_accepted": false, "score": 1, "last_activity_date": 1489656702, "last_edit_date": 1489656702, "creation_date": 1489585341, "answer_id": 42811551, "question_id": 42805779, "link": "https://stackoverflow.com/questions/42805779/vba-import-delimited-text-file-to-excel/42811551#42811551", "title": "VBA import delimited text file to Excel", "body": "<p>Modified code to make it more clear, its working now. See code below.</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n\nDim text As String, textline As String\nDim Cell As Range\nDim strLine() As String\nDim aCol, aRow, aNames, colNow As Long, rowNow As Long\nDim oldDate As Date, newDate As Date\n\n\nUnload Me\nmyFile = Application.GetOpenFilename(\"Text Files (*.txt), *.txt\")\n\nIf myFile = False Then\nExit Sub\n'MsgBox (\"No File Select. Exit\")\n\nElse\n\n'Open and read file\nOpen myFile For Input As #1\n    Do Until EOF(1)\n        Line Input #1, textline\n        text = text &amp; textline\n    Loop\nClose #1\n\naRow = Split(textline, \"|\")\nWith ActiveSheet\n\n    .Cells(2, 1) = Trim(Left(aRow(0), InStr(aRow(0), \" \")))\n\n    For rowNow = 1 To UBound(aRow)\n\n        aCol = Split(aRow(rowNow), \",\")\n        For colNow = 0 To UBound(aCol)\n            ActiveSheet.Cells(rowNow + 1, colNow + 2) = aCol(colNow)\n        Next\n    Next\n\nEnd With\nEnd If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 63, "user_id": 7713865, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/fe01f5392d692c7bd750f1f9edbd1d45?s=128&d=identicon&r=PG&f=1", "display_name": "rei123", "link": "https://stackoverflow.com/users/7713865/rei123"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 12224, "favorite_count": 0, "accepted_answer_id": 42806894, "answer_count": 2, "score": 2, "last_activity_date": 1489656702, "creation_date": 1489570332, "last_edit_date": 1531164843, "question_id": 42805779, "link": "https://stackoverflow.com/questions/42805779/vba-import-delimited-text-file-to-excel", "title": "VBA import delimited text file to Excel", "body": "<p>I'm trying to import text file to excel using vba. The text file I have has all the data in one line and contains two delimiters \"|\" and \",\". Where, \",\" will separate the data into columns and \"|\" separate the data to rows. </p>\n\n<p>I have got a code, but it seems like doing the opposite and because I'm very new to vba, I couldn't really figure out where it goes wrong. </p>\n\n<p>I was thinking if there is other ways of doing to vba, something will performs like, if it recognize the delimiter it will move the data to specified cell?</p>\n\n<p>Here is what my text file looks like. </p>\n\n<pre><code>27/2/2017 17:14:32 | 54,11,6,32,58,83,0 | 0,0,0,0,0,0,0 | 0,0,0,0,0,0,0 | 0,69,8,86,0,241,255 | 0,71,69,404,0,553,0 | 15,0,0,0,53,0,0 | 0,0,0,0,0,0,0 | 0,867,2,18,0,939,0 | 0,0,0,0,0,0,0 | 0,0,0,0,0,0,0 | 0,0,0,0,0,0,0 | 0,0,0,0,0,0,0 | 0,0,0,0,0,0,0 | 16,0,0,0,0,0,85 | 647,509,18,82,18,670,85 | 1433,0,0,0,0,0,0 | 1432,882,0,0,0,939,0 | 32,861,1,20,0,938,0 | 0,887,0,0,0,939,0 | 0,886,0,0,0,939,0 | 12,801,4,42,0,912,0 | 0,867,0,0,0,939,0 | 0,0,0,0,0,0,0 | 0,890,0,0,0,939,0 | 0,871,0,0,0,930,85 | 0,891,0,0,0,939,0 | 0,892,0,0,0,939,0 | 0,894,0,0,0,939,0 | 0,895,0,0,0,954,0 | 0,0,0,0,0,0,0 | 0,905,0,0,0,954,0 | 0,792,6,35,0,897,85 | 4,697,40,202,0,952,0 | 0,640,13,108,0,807,0 | 0,0,0,0,507,0,0 | 60,24,23,211,1128,296,0 | 4,81,16,148,569,348,0 | 0,0,0,0,0,0,0 | 0,0,0,0,0,0,0 | 77,224,22,367,159,791,0 | 118,42,1,7,1051,104,0 | 58,0,0,0,654,0,0 | 260,0,0,0,642,0,0 | 172,0,0,0,1241,0,0 | 0,0,0,0,1433,0,0 | 0,0,0,0,1433,0,0 | 0,0,0,0,1433,0,0 | 0,0,0,0,1433,0,0 | 0,0,0,0,1434,0,0 | 0,0,0,0,1433,0,0 | 0,0,0,0,1433,0,0 | 0,0,0,0,1433,0,0 | 0,0,0,0,1433,0,0 | 0,0,0,0,1434,0,0 | 0,0,0,0,1433,0,0 | 114,0,0,0,1284,0,0 | 0,0,0,0,1429,0,0 | 0,0,0,0,1353,0,0 | 0,0,0,0,1433,0,0 | 0,0,0,0,1434,0,0 | 0,0,0,0,1433,0,0 | 0,0,0,0,1433,0,0 | 0,0,0,0,1432,0,0 | 0,0,0,0,1434,0,0 | 0,0,0,0,1433,0,0 | 0,0,0,0,1433,0,0 | 86,89,1,51,1279,141,0 | 0,0,0,0,1433,0,0 | 0,0,0,0,1433,0,0 | 0,0,0,0,1433,0,0 | 0,0,0,0,1433,0,0 | 0,0,0,0,1434,0,0 | 0,0,0,0,1433,0,0 | 0,0,0,0,1433,0,0 | 0,0,0,0,1433,0,0 | 0,0,0,0,1433,0,0 | 0,0,0,0,1434,0,0 | 0,0,0,612,751,613,0 | 0,0,2,662,0,710,0 | 0,0,0,0,0,0,0 | 0,0,0,0,0,0,0 | 0,0,0,0,0,0,0 | 0,0,0,0,0,0,0 | 0,0,0,0,0,0,0 | 0,0,0,0,0,0,0 | 0,0,0,0,0,0,0 | 0,0,0,0,0,0,0 | 0,0,0,0,0,0,0 | 0,0,0,0,0,0,0 | 0,0,0,0,0,0,0 | 0,0,0,0,0,3,0 | \n</code></pre>\n\n<p>Here is my code</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n\nDim sPath As String, sLine As String\nDim oFile As String\nDim i As Long\nDim workRange As Range\nDim destCell As Range\n\n\nSet destCell = Range(\"A1\")\nSet workRange = Range(\"A1\" &amp; \":\" &amp; Range(\"A1\").End(xlDown).Address)\n\nUnload Me\noFile = Application.GetOpenFilename()\n\ni = 1\n\nOpen oFile For Input As #1 ' Open file for input.\nDo While Not EOF(1) ' Loop until end of file.\n    Input #1, sLine ' Read data\n\n    i = i + 1\n    Range(\"A\" &amp; i).Formula = sLine  ' Write data line\n\n\nLoop\nClose #1 ' Close file.\n\n\n'Text to Columns\n    With workRange\n    .TextToColumns Destination:=destCell, DataType:=xlDelimited, _\n     TextQualifier:=xlDoubleQuote, ConsecutiveDelimiter:=False, Tab:=False, _\n     Semicolon:=False, Comma:=False, Space:=False, Other:=True, OtherChar:=\"|\", _\n     FieldInfo:=Array(1, 1), TrailingMinusNumbers:=False\n    End With\n\nApplication.ScreenUpdating = True\nEnd Sub\n</code></pre>\n\n<p>I want to the result to look like this </p>\n\n<p><a href=\"https://i.stack.imgur.com/U6HEc.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/U6HEc.jpg\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1489574161, "post_id": 42806858, "comment_id": 72726983, "body": "Please could you add code tags to your post. Think you are missing a dot too."}, {"owner": {"reputation": 21, "user_id": 7688347, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c037a4ebb2e2e56407b9b86c40d0739?s=128&d=identicon&r=PG&f=1", "display_name": "Grumpy Dad", "link": "https://stackoverflow.com/users/7688347/grumpy-dad"}, "edited": false, "score": 0, "creation_date": 1489614561, "post_id": 42806858, "comment_id": 72754374, "body": "Thanks SJR, I have tried and I still get a Run Time Error <code>1004</code>"}, {"owner": {"reputation": 21, "user_id": 7688347, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c037a4ebb2e2e56407b9b86c40d0739?s=128&d=identicon&r=PG&f=1", "display_name": "Grumpy Dad", "link": "https://stackoverflow.com/users/7688347/grumpy-dad"}, "edited": false, "score": 0, "creation_date": 1489614608, "post_id": 42806858, "comment_id": 72754404, "body": "Sorry &quot;AutoFill method of range class failed"}], "tags": [], "owner": {"reputation": 41, "user_id": 7688572, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8dfbec6a3b557ba9daeb05823edcbd2?s=128&d=identicon&r=PG&f=1", "display_name": "Dhanappa Baddole", "link": "https://stackoverflow.com/users/7688572/dhanappa-baddole"}, "is_accepted": false, "score": 0, "last_activity_date": 1489573729, "last_edit_date": 1489573729, "creation_date": 1489573255, "answer_id": 42806858, "question_id": 42805331, "link": "https://stackoverflow.com/questions/42805331/autofill-a-range-of-cells/42806858#42806858", "title": "AutoFill a Range of Cells", "body": "<p>You have used '&amp;' after 'LastRow' variable please remove it and try below code :</p>\n\n<p>With Worksheets(\"MySheet\")\n    .Range(\"A1\").AutoFill Destination:=Range(\"A1:H\" &amp; LastRow)\nEnd With</p>\n"}, {"comments": [{"owner": {"reputation": 21, "user_id": 7688347, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c037a4ebb2e2e56407b9b86c40d0739?s=128&d=identicon&r=PG&f=1", "display_name": "Grumpy Dad", "link": "https://stackoverflow.com/users/7688347/grumpy-dad"}, "edited": false, "score": 0, "creation_date": 1489700759, "post_id": 42823077, "comment_id": 72799248, "body": "Thanks SJR, but I still get an error message &quot;Run Time Error 1004&quot; Autofill method of Range Class Failed."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 21, "user_id": 7688347, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c037a4ebb2e2e56407b9b86c40d0739?s=128&d=identicon&r=PG&f=1", "display_name": "Grumpy Dad", "link": "https://stackoverflow.com/users/7688347/grumpy-dad"}, "edited": false, "score": 0, "creation_date": 1489746775, "post_id": 42823077, "comment_id": 72816566, "body": "Try it now, have made a small change."}, {"owner": {"reputation": 21, "user_id": 7688347, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c037a4ebb2e2e56407b9b86c40d0739?s=128&d=identicon&r=PG&f=1", "display_name": "Grumpy Dad", "link": "https://stackoverflow.com/users/7688347/grumpy-dad"}, "edited": false, "score": 0, "creation_date": 1489957815, "post_id": 42823077, "comment_id": 72885803, "body": "Thanks SJR, It now works, I appreciate all your time and help."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 21, "user_id": 7688347, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c037a4ebb2e2e56407b9b86c40d0739?s=128&d=identicon&r=PG&f=1", "display_name": "Grumpy Dad", "link": "https://stackoverflow.com/users/7688347/grumpy-dad"}, "edited": false, "score": 0, "creation_date": 1490017296, "post_id": 42823077, "comment_id": 72909898, "body": "Perhaps you could indicate that this has answered your question."}, {"owner": {"reputation": 21, "user_id": 7688347, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c037a4ebb2e2e56407b9b86c40d0739?s=128&d=identicon&r=PG&f=1", "display_name": "Grumpy Dad", "link": "https://stackoverflow.com/users/7688347/grumpy-dad"}, "edited": false, "score": 0, "creation_date": 1490130560, "post_id": 42823077, "comment_id": 72973369, "body": "Hi SJR, Re your last post &quot;Perhaps you could indicate that this has answered your question&quot; If you read my post from the day before you would see I did indicate you had answered my question.  &quot;Thanks SJR, It now works, I appreciate all your time and help"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 21, "user_id": 7688347, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c037a4ebb2e2e56407b9b86c40d0739?s=128&d=identicon&r=PG&f=1", "display_name": "Grumpy Dad", "link": "https://stackoverflow.com/users/7688347/grumpy-dad"}, "edited": false, "score": 0, "creation_date": 1490130673, "post_id": 42823077, "comment_id": 72973428, "body": "Yes ok, actually I meant the formal SO way of indicating that an answer was approved (not sure how to do it as have never asked a question)."}], "tags": [], "owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "is_accepted": false, "score": 0, "last_activity_date": 1489746762, "last_edit_date": 1489746762, "creation_date": 1489623107, "answer_id": 42823077, "question_id": 42805331, "link": "https://stackoverflow.com/questions/42805331/autofill-a-range-of-cells/42823077#42823077", "title": "AutoFill a Range of Cells", "body": "<p>Subbed down your code by removing Selects and I think fixed your error</p>\n\n<pre><code>Sub TransferQuoteToMasterQuoteTest()\n\nDim LastRow As Long\nDim R As Long\n\nR = 16\nWorksheets.Add.Name = \"MySheet\"\n\nSheets(\"Sheet1\").Range(\"I5:I9\").Copy\nSheets(\"MySheet\").Range(\"A1\").PasteSpecial Transpose:=True\nSheets(\"Sheet1\").Range (\"K5\")\nSheets(\"MySheet\").Range(\"F1\").PasteSpecial\nSheets(\"Sheet1\").Range(\"K11:K12\").Copy\nSheets(\"MySheet\").Range(\"G1\").PasteSpecial Transpose:=True\n\nDo While Not IsEmpty(Worksheets(\"Sheet1\").Range(\"B\" &amp; R))\n    Worksheets(\"Sheet1\").Range(\"B\" &amp; R &amp; \":M\" &amp; R).Copy Worksheets(\"MySheet\").Range(\"I\" &amp; (R - 15) &amp; \":T\" &amp; (R - 15))\n    R = R + 1\nLoop\n\nLastRow = Worksheets(\"MySheet\").Range(\"I1\").End(xlDown).Row\nWith Worksheets(\"MySheet\")\n    .Range(\"A1:H1\").AutoFill Destination:=.Range(\"A1:H\" &amp; LastRow)\nEnd With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 7688347, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c037a4ebb2e2e56407b9b86c40d0739?s=128&d=identicon&r=PG&f=1", "display_name": "Grumpy Dad", "link": "https://stackoverflow.com/users/7688347/grumpy-dad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 119, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1489746762, "creation_date": 1489568994, "last_edit_date": 1489572503, "question_id": 42805331, "link": "https://stackoverflow.com/questions/42805331/autofill-a-range-of-cells", "title": "AutoFill a Range of Cells", "body": "<p>I have a quote form - I need to take certain (Header) info and paste into a Master file column <code>A1:H1</code>, and then take the quoted items and also paste in to the master file, Column <code>I1:T1</code> and <code>I2:T2</code> and so on if more than the one item.</p>\n\n<p>I can do most of it but if the quote items are more than 1, then I need to autofill the header information from column <code>A1:H1</code> to last column populated in <code>I?:H?</code></p>\n\n<p>Below is what I have written but I can't make it work. It is probably a simple issue that I cant see, or I may be trying to do this a way that would be easier with another loop. </p>\n\n<p>Can anyone suggest a solution to populate the header information in columns <code>A:H</code> for as many rows as there were items?</p>\n\n<pre><code>Sub TransferQuoteToMasterQuoteTest()\n\n    Dim LastRow As Long\n    Dim R As Long\n\n    R = 16\n\n    Range(\"I5:I9\").Copy\n    Worksheets.Add.Name = \"MySheet\"\n    Range(\"A1\").PasteSpecial Transpose:=True\n    Sheets(\"Sheet1\").Select\n    Range(\"K5\").Copy\n    Sheets(\"MySheet\").Select\n    Range(\"F1\").PasteSpecial\n    Sheets(\"Sheet1\").Select\n    Range(\"K11:K12\").Copy\n    Sheets(\"MySheet\").Select\n    Range(\"G1\").PasteSpecial Transpose:=True\n    Range(\"I1\").Select\n    Sheets(\"Sheet1\").Select\n    Range(\"B16\").Select\n\n        Do While Not IsEmpty(Worksheets(\"Sheet1\").Range(\"B\" &amp; R))\n            Worksheets(\"Sheet1\").Range(\"B\" &amp; R &amp; \":M\" &amp; R).Copy Worksheets(\"MySheet\").Range(\"I\" &amp; (R - 15) &amp; \":T\" &amp; (R - 15))\n            R = R + 1\n        Loop\n\n    Worksheets(\"MySheet\").Select\n\n        LastRow = Worksheets(\"MySheet\").Range(\"I1\").End(xlDown).Row\n            With Worksheets(\"MySheet\").Range(\"A1\")\n            .AutoFill Destination:=Range(\"A1:H\" &amp; LastRow&amp;)\n        End With\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 3812, "user_id": 1481116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d0c940ad90baf5f93d7ab07933d2e17?s=128&d=identicon&r=PG", "display_name": "Luuklag", "link": "https://stackoverflow.com/users/1481116/luuklag"}, "edited": false, "score": 1, "creation_date": 1489569657, "post_id": 42805183, "comment_id": 72723767, "body": "You should look into the principle of lastrow. There are plenty of pieces of code around here that will help you. Then change your <code>ActiveSheet.Range()</code>  into : <code>ActiveSheet.Range(&quot;$A$1:$E$&quot;&amp;lastrow)</code>"}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "reply_to_user": {"reputation": 3812, "user_id": 1481116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d0c940ad90baf5f93d7ab07933d2e17?s=128&d=identicon&r=PG", "display_name": "Luuklag", "link": "https://stackoverflow.com/users/1481116/luuklag"}, "edited": false, "score": 0, "creation_date": 1489571231, "post_id": 42805183, "comment_id": 72724846, "body": "See <a href=\"http://stackoverflow.com/documentation/excel-vba/918/methods-for-finding-the-last-used-row-or-column-in-a-worksheet#t=201703150943548881299\">stackoverflow.com/documentation/excel-vba/918/&hellip;</a> and <a href=\"http://stackoverflow.com/a/11169920/4628637\">stackoverflow.com/a/11169920/4628637</a> (@Luuklag : it&#39;s better if you provide the link! ;) )"}, {"owner": {"reputation": 126, "user_id": 5575763, "user_type": "registered", "accept_rate": 70, "profile_image": "https://graph.facebook.com/747354945368781/picture?type=large", "display_name": "Samadhan Gaikwad", "link": "https://stackoverflow.com/users/5575763/samadhan-gaikwad"}, "edited": false, "score": 0, "creation_date": 1489572116, "post_id": 42805183, "comment_id": 72725484, "body": "Thanks for letting me know this lastrow links!"}], "answers": [{"tags": [], "owner": {"reputation": 126, "user_id": 5575763, "user_type": "registered", "accept_rate": 70, "profile_image": "https://graph.facebook.com/747354945368781/picture?type=large", "display_name": "Samadhan Gaikwad", "link": "https://stackoverflow.com/users/5575763/samadhan-gaikwad"}, "is_accepted": true, "score": 0, "last_activity_date": 1489572172, "creation_date": 1489572172, "answer_id": 42806442, "question_id": 42805183, "link": "https://stackoverflow.com/questions/42805183/remove-delete-duplicate-rows-from-5-columns/42806442#42806442", "title": "Remove/Delete duplicate rows from 5 columns", "body": "<p>Below code is working fine to me:\n<code>\nSub Macro11()\n    ActiveSheet.Range(\"A:E\").RemoveDuplicates Columns:=4, Header:=xlNo\nEnd Sub</code></p>\n"}], "owner": {"reputation": 126, "user_id": 5575763, "user_type": "registered", "accept_rate": 70, "profile_image": "https://graph.facebook.com/747354945368781/picture?type=large", "display_name": "Samadhan Gaikwad", "link": "https://stackoverflow.com/users/5575763/samadhan-gaikwad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 102, "favorite_count": 0, "accepted_answer_id": 42806442, "answer_count": 1, "score": 0, "last_activity_date": 1489572172, "creation_date": 1489568547, "question_id": 42805183, "link": "https://stackoverflow.com/questions/42805183/remove-delete-duplicate-rows-from-5-columns", "title": "Remove/Delete duplicate rows from 5 columns", "body": "<p><a href=\"https://i.stack.imgur.com/Yo0hL.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Yo0hL.png\" alt=\"enter image description here\"></a>\nI want to remove/delete all duplicate rows from 5 columns which have no headers.\nI have recorded operation in macro and code is here:</p>\n\n<pre><code>Sub Macro11()\nColumns(\"D:D\").Select\nSelection.SpecialCells(xlCellTypeConstants, 23).Select\nActiveSheet.Range(\"$A$1:$E$8\").RemoveDuplicates Columns:=Array(1, 2, 3, 4, 5), _\n    Header:=xlNo\nRange(\"A1\").Select\nEnd Sub\n</code></pre>\n\n<p>I want above range to be variable as my count of rows will be varying.\nI have compared column 'C' to remove duplicates. It will be OK to compare each row or cells only from coulmn 'D'.</p>\n"}, {"tags": ["javascript", "sql", "ms-access", "vba"], "comments": [{"owner": {"reputation": 1, "user_id": 7713588, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7c795513d04adc18ed37ce5a5aeb70b?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/7713588/michael"}, "edited": false, "score": 0, "creation_date": 1489567410, "post_id": 42804618, "comment_id": 72722421, "body": "I try with SumProduct:"}, {"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "edited": false, "score": 0, "creation_date": 1489567450, "post_id": 42804618, "comment_id": 72722436, "body": "What is SumProduct?"}, {"owner": {"reputation": 1, "user_id": 7713588, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7c795513d04adc18ed37ce5a5aeb70b?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/7713588/michael"}, "reply_to_user": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "edited": false, "score": 0, "creation_date": 1489567717, "post_id": 42804618, "comment_id": 72722578, "body": "a function in vba code"}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 7713588, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7c795513d04adc18ed37ce5a5aeb70b?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/7713588/michael"}, "is_accepted": false, "score": 0, "last_activity_date": 1489567871, "creation_date": 1489567871, "answer_id": 42804957, "question_id": 42804618, "link": "https://stackoverflow.com/questions/42804618/calculating-weighted-averages-in-queries-vba-access/42804957#42804957", "title": "Calculating weighted averages in queries vba access", "body": "<p>Public Function SumProduct(Array1 As Variant, Array2 As Variant) As Variant</p>\n\n<pre><code>Dim lngRowMax As Long\nDim lngColMax As Long\nDim i As Long\nDim j As Long\nDim var As Variant\n\nlngRowMax = IIf(UBound(Array1, 2) &lt;= UBound(Array2, 2), UBound(Array1, 2), UBound(Array2, 2))\nlngColMax = IIf(UBound(Array1) &lt;= UBound(Array2), UBound(Array1), UBound(Array2))\nReDim var(0 To lngRowMax)\nFor i = 0 To lngRowMax\n    For j = 0 To lngColMax\n        var(i) = var(i) + Array1(j, i) * Array2(j, i)\n    Next j\n    SumProduct = SumProduct + var(i)\nNext i\n</code></pre>\n\n<p>End Function</p>\n"}], "owner": {"reputation": 1, "user_id": 7713588, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7c795513d04adc18ed37ce5a5aeb70b?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/7713588/michael"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 200, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1489567948, "creation_date": 1489566871, "last_edit_date": 1489567948, "question_id": 42804618, "link": "https://stackoverflow.com/questions/42804618/calculating-weighted-averages-in-queries-vba-access", "title": "Calculating weighted averages in queries vba access", "body": "<p>I'm working on a database that needs to value WEIGHTED average cost for \ninventory based on actual costs per unit.  The source data \nis in a query that combines item receiving/return history, \nand sorts the results by item ID and by receipt date. \nSo, what I get from this query looks like this: </p>\n\n<p><br> <p>ITEM # &nbsp; &nbsp; &nbsp; RECPT_DATE &nbsp; &nbsp;QTY &nbsp; &nbsp;UNIT_COST <br> A1 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 10/15/2001 &nbsp; &nbsp;100 &nbsp; &nbsp; &nbsp; &nbsp; 5.50 <br> A1 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 09/02/2001 &nbsp; &nbsp; 50 &nbsp; &nbsp; &nbsp; &nbsp; 6.00 <br> A1 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 06/10/2001 &nbsp; &nbsp; 40 &nbsp; &nbsp; &nbsp; &nbsp; 7.00 <br> A2 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 12/02/2001 &nbsp; &nbsp; 75 &nbsp; &nbsp; &nbsp; &nbsp;15.00 <br> A2 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 07/20/2001 &nbsp; &nbsp; 20 &nbsp; &nbsp; &nbsp; &nbsp;14.50 <br> <p>Now, I have another table that tells me the total on hand <br> quantities of each item in inventory. <br> <p>ITEM # &nbsp; &nbsp; &nbsp; TOT_QTY <br> A1 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; [WEIGHTED average cost ] <br> A2 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;[WEIGHTED average cost ]<br>\nSo, is this possible to do with VBA in access? \nANY help would be much appreciated!\n<br>Thx.</p>\n\n<pre><code>Public Function SumProduct(Array1 As Variant, Array2 As Variant) As Variant\n\n    Dim lngRowMax As Long\n    Dim lngColMax As Long\n    Dim i As Long\n    Dim j As Long\n    Dim var As Variant\n\n    lngRowMax = IIf(UBound(Array1, 2) &lt;= UBound(Array2, 2), UBound(Array1, 2), UBound(Array2, 2))\n    lngColMax = IIf(UBound(Array1) &lt;= UBound(Array2), UBound(Array1), UBound(Array2))\n    ReDim var(0 To lngRowMax)\n    For i = 0 To lngRowMax\n        For j = 0 To lngColMax\n            var(i) = var(i) + Array1(j, i) * Array2(j, i)\n        Next j\n        SumProduct = SumProduct + var(i)\n    Next i\n\nEnd Function\n</code></pre>\n"}, {"tags": ["vba", "if-statement", "multiple-conditions"], "answers": [{"comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "reply_to_user": {"reputation": 261, "user_id": 7634135, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/02a8e232898c11cbc32a93ea8f55520e?s=128&d=identicon&r=PG&f=1", "display_name": "lcc", "link": "https://stackoverflow.com/users/7634135/lcc"}, "edited": false, "score": 1, "creation_date": 1489564627, "post_id": 42803848, "comment_id": 72720855, "body": "@lcc see answer and code under <b>Edit 1</b>, I think this is the way you should adapt to your code"}, {"owner": {"reputation": 381813, "user_id": 1863229, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/4sh1l.png?s=128&g=1", "display_name": "Tim Biegeleisen", "link": "https://stackoverflow.com/users/1863229/tim-biegeleisen"}, "edited": false, "score": 0, "creation_date": 1489564639, "post_id": 42803848, "comment_id": 72720861, "body": "Do you have an explanation for how the original code was even <i>running</i>?  I couldn&#39;t reproduce the behavior."}], "tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": true, "score": 7, "last_activity_date": 1489564641, "last_edit_date": 1489564641, "creation_date": 1489564265, "answer_id": 42803848, "question_id": 42803797, "link": "https://stackoverflow.com/questions/42803797/i-use-or-to-form-a-multiple-condition-if-else-statement-on-vba-its-not-working/42803848#42803848", "title": "I use OR to form a multiple condition IF ELSE statement on VBA, it&#39;s not working", "body": "<p>Using the line below is incorrect: </p>\n\n<pre><code>ElseIf (Selection.Value = \"hold to console\" Or \"Hold to console\" Or \"Allocated 14/12 and ship next day\") Then\n</code></pre>\n\n<p>You need to add <code>Selection.Value =</code> before each condition, see line below:</p>\n\n<pre><code>ElseIf Selection.Value = \"hold to console\" Or Selection.Value = \"Hold to console\" Or Selection.Value = \"Allocated 14/12 and ship next day\" Then\n</code></pre>\n\n<p>Note: the same applies to all other <code>ElseIf</code>s you have.</p>\n\n<hr>\n\n<p><strong><em>Edit 1</em></strong></p>\n\n<p>However,I would suggest to use the code below. Your code is \"screaming\" for <code>Select Case</code>. Also, there is no need to <code>Range(\"AB\" &amp; cat).Select</code> and later use <code>ActiveCell</code>, instead you could just use fully qualifed <code>Range</code>.</p>\n\n<p><strong>Code</strong></p>\n\n<pre><code>Dim cat As Long\n\nFor cat = 2 To last\n    Select Case Range(\"AB\" &amp; cat).Value\n        Case \" \"\n            Range(\"AB\" &amp; cat).Offset(0, -2).Value = \"-\"\n            Range(\"AB\" &amp; cat).Offset(0, -1).Value = \"-\"\n\n        Case \"Address in local wording\"\n            Range(\"AB\" &amp; cat).Offset(0, -2).Value = \"Customer\"\n            Range(\"AB\" &amp; cat).Offset(0, -1).Value = \"Incomplete information or awaiting more info from customer\"\n\n        Case \"hold to console\", \"Hold to console\", \"Allocated 14/12 and ship next day\"\n            Range(\"AB\" &amp; cat).Offset(0, -2).Value = \"Depot\"\n            Range(\"AB\" &amp; cat).Offset(0, -1).Value = \"Allotment delay\"\n\n        Case \"Backorder\", \"backorder\", \"Back order\", \"back order\"\n            Range(\"AB\" &amp; cat).Offset(0, -2).Value = \"Inventory\"\n            Range(\"AB\" &amp; cat).Offset(0, -1).Value = \"Material not available causing backorder\"\n    End Select\n\nNext cat\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 261, "user_id": 7634135, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/02a8e232898c11cbc32a93ea8f55520e?s=128&d=identicon&r=PG&f=1", "display_name": "lcc", "link": "https://stackoverflow.com/users/7634135/lcc"}, "edited": false, "score": 0, "creation_date": 1489564588, "post_id": 42803860, "comment_id": 72720836, "body": "Thanks for ur help !!"}], "tags": [], "owner": {"reputation": 381813, "user_id": 1863229, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/4sh1l.png?s=128&g=1", "display_name": "Tim Biegeleisen", "link": "https://stackoverflow.com/users/1863229/tim-biegeleisen"}, "is_accepted": false, "score": 3, "last_activity_date": 1489564287, "creation_date": 1489564287, "answer_id": 42803860, "question_id": 42803797, "link": "https://stackoverflow.com/questions/42803797/i-use-or-to-form-a-multiple-condition-if-else-statement-on-vba-its-not-working/42803860#42803860", "title": "I use OR to form a multiple condition IF ELSE statement on VBA, it&#39;s not working", "body": "<p>I think you need to express equality in each condition.  In other words, instead of this:</p>\n\n<pre><code>(Selection.Value = \"hold to console\" Or\n \"Hold to console\" Or\n \"Allocated 14/12 and ship next day\") Then\n</code></pre>\n\n<p>you need to use this:</p>\n\n<pre><code>(Selection.Value = \"hold to console\" Or\n Selection.Value = \"Hold to console\" Or\n Selection.Value = \"Allocated 14/12 and ship next day\") Then\n</code></pre>\n"}], "owner": {"reputation": 261, "user_id": 7634135, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/02a8e232898c11cbc32a93ea8f55520e?s=128&d=identicon&r=PG&f=1", "display_name": "lcc", "link": "https://stackoverflow.com/users/7634135/lcc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 156, "favorite_count": 1, "accepted_answer_id": 42803848, "answer_count": 2, "score": 3, "last_activity_date": 1580827603, "creation_date": 1489564059, "last_edit_date": 1489569330, "question_id": 42803797, "link": "https://stackoverflow.com/questions/42803797/i-use-or-to-form-a-multiple-condition-if-else-statement-on-vba-its-not-working", "title": "I use OR to form a multiple condition IF ELSE statement on VBA, it&#39;s not working", "body": "<pre><code>Dim cat As Integer\nFor cat = 2 To last\n    Range(\"AB\" &amp; cat).Select\n\n    If Selection.Value = \" \" Then\n        ActiveCell.Offset(0, -2).Value = \"-\"\n        ActiveCell.Offset(0, -1).Value = \"-\"\n\n    ElseIf Selection.Value = \"Address in local wording\" Then\n        ActiveCell.Offset(0, -2).Value = \"Customer\"\n        ActiveCell.Offset(0, -1).Value = \"Incomplete information or awaiting more info from customer\"\n\n    ElseIf (Selection.Value = \"hold to console\" Or \"Hold to console\" Or \"Allocated 14/12 and ship next day\") Then\n        ActiveCell.Offset(0, -2).Value = \"Depot\"\n        ActiveCell.Offset(0, -1).Value = \"Allotment delay\"\n\n    ElseIf (Selection.Value = \"Backorder\" Or \"backorder\" Or \"Back order\" Or \"back order\") Then\n        ActiveCell.Offset(0, -2).Value = \"Inventory\"\n        ActiveCell.Offset(0, -1).Value = \"Material not available causing backorder\"\n\n    End If        \nNext cat\n</code></pre>\n\n<p>The result I get is when Selection.Value is empty,  <strong><code>\"-\" , \"-\"</code></strong> \nand the rest all show <strong><code>\"Depot\"</code></strong> , <strong><code>\"Allotment delay\"</code></strong> only.</p>\n\n<p>What's wrong with this code ?</p>\n"}, {"tags": ["vba", "excel", "autofilter", "advanced-filter"], "answers": [{"comments": [{"owner": {"reputation": 645, "user_id": 860742, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/a20452deefe6340461a396e6c8eaad3a?s=128&d=identicon&r=PG", "display_name": "Mathew Hood", "link": "https://stackoverflow.com/users/860742/mathew-hood"}, "edited": false, "score": 0, "creation_date": 1489620699, "post_id": 42805928, "comment_id": 72756900, "body": "I like the idea but I need the array value to be =&quot;=*2TWH*&quot; and not just &quot;<i>2TWH</i>&quot; etc."}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "reply_to_user": {"reputation": 645, "user_id": 860742, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/a20452deefe6340461a396e6c8eaad3a?s=128&d=identicon&r=PG", "display_name": "Mathew Hood", "link": "https://stackoverflow.com/users/860742/mathew-hood"}, "edited": false, "score": 0, "creation_date": 1489666712, "post_id": 42805928, "comment_id": 72776969, "body": "@MathewHood : See the edit! Nope, you don&#39;t, test the second code with only 2 parameters in the array and you&#39;ll see that you don&#39;t need the <code>=</code>! ;) Anyway, <b>Enjoy advanced filters! ;)</b>"}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "reply_to_user": {"reputation": 146, "user_id": 2289431, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/8d505886310b1260e45bebdc1fa726a2?s=128&d=identicon&r=PG", "display_name": "Simulator", "link": "https://stackoverflow.com/users/2289431/simulator"}, "edited": false, "score": 0, "creation_date": 1539673253, "post_id": 42805928, "comment_id": 92575699, "body": "@Simulator : The place of &quot;N&quot; in the alphabet ;)"}, {"owner": {"reputation": 146, "user_id": 2289431, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/8d505886310b1260e45bebdc1fa726a2?s=128&d=identicon&r=PG", "display_name": "Simulator", "link": "https://stackoverflow.com/users/2289431/simulator"}, "edited": false, "score": 0, "creation_date": 1539673991, "post_id": 42805928, "comment_id": 92576081, "body": "@R3uK my bad :). Although for some reason the advanced filter is returning all rows and not the columns matching the wildcards."}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "reply_to_user": {"reputation": 146, "user_id": 2289431, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/8d505886310b1260e45bebdc1fa726a2?s=128&d=identicon&r=PG", "display_name": "Simulator", "link": "https://stackoverflow.com/users/2289431/simulator"}, "edited": false, "score": 0, "creation_date": 1539678662, "post_id": 42805928, "comment_id": 92578658, "body": "@Simulator : Reading back myself, it seems it should be the column&#39;s header and not the column&#39;s number. Are you trying to filter columns based on their names ?"}, {"owner": {"reputation": 146, "user_id": 2289431, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/8d505886310b1260e45bebdc1fa726a2?s=128&d=identicon&r=PG", "display_name": "Simulator", "link": "https://stackoverflow.com/users/2289431/simulator"}, "edited": false, "score": 1, "creation_date": 1539685033, "post_id": 42805928, "comment_id": 92582405, "body": "I was actually trying to use advanced filter without using a column header, but used it ultimately and worked fine."}], "tags": [], "owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "is_accepted": true, "score": 2, "last_activity_date": 1539698427, "last_edit_date": 1539698427, "creation_date": 1489570745, "answer_id": 42805928, "question_id": 42803528, "link": "https://stackoverflow.com/questions/42803528/excel-filter-with-multiple-criteria-autofilter-or-advancedfilter/42805928#42805928", "title": "Excel : filter with Multiple Criteria : AutoFilter or AdvancedFilter", "body": "<p>This should do the trick :</p>\n\n<pre><code>ActiveSheet.Range(\"$A$5:$H$10\").AutoFilter Field:=2, Criteria1:=\"=4*\", _\n    Operator:=xlOr, Criteria2:=Array(\"*2TWH*\",\"*2TER*\")\n</code></pre>\n\n<p>This doesn't throw any error, but ...<br>\nit'll <strong>only take 2 criteria because there are wildcards (<code>*</code>).</strong><br>\nHere it's the last criteria from the array (here <code>*2TER*</code>) </p>\n\n<hr>\n\n<p>Ideally, this would have been nice, as it works for <em>constants</em>,<br>\nbut because you <strong>use WildCards (<code>*</code>) it only supports 2 criteria... :/</strong></p>\n\n<pre><code>ActiveSheet.Range(\"$A$1:$H$10\").AutoFilter Field:=2, Criteria1:=Array(\"*2TWH*\", \"*2TER*\", \"4*\"), _\n    Operator:=xlFilterValues\n</code></pre>\n\n<hr>\n\n<hr>\n\n<p><strong>So you'll have to go with <code>AdvancedFilter</code> :</strong></p>\n\n<pre><code>With ActiveSheet\n    'Const xlFilterInPlace = 1\n    .Range(\"$A$5:$H$10\").AdvancedFilter _\n                        Action:=xlFilterInPlace, _\n                        CriteriaRange:=WsFilterSettings.Range(\"A1:A4\")\nEnd With 'ActiveSheet\n</code></pre>\n\n<p><code>AdvancedFilter</code> take a <strong>Range as criteria inputs</strong>, <code>CriteriaRange</code>, so you'll have to <strong>put on a sheet</strong> :</p>\n\n<ul>\n<li>the <strong>header of the column</strong> you want to apply to the filter on</li>\n<li>your <strong>criteria</strong> below the respective header (if you have multiples columns)</li>\n</ul>\n\n<p>Each <strong>COLUMN</strong> of that Range, are <em>linked</em> by an <strong>AND</strong><br>\nEach <strong>ROW</strong> of that Range, are <em>linked</em> by an <strong>OR</strong><br>\nSo build your table carefully!</p>\n\n<p>In the above example code, I have used : <br>\n(let's say that your <strong>column's header</strong> was <em>Column To Filter On</em>) :</p>\n\n<pre><code>A1 | Column To Filter On\nA2 | 4*\nA3 | *2TWH*\nA4 | *2TER*\n</code></pre>\n"}], "owner": {"reputation": 645, "user_id": 860742, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/a20452deefe6340461a396e6c8eaad3a?s=128&d=identicon&r=PG", "display_name": "Mathew Hood", "link": "https://stackoverflow.com/users/860742/mathew-hood"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7245, "favorite_count": 1, "accepted_answer_id": 42805928, "answer_count": 1, "score": 3, "last_activity_date": 1539698427, "creation_date": 1489563110, "last_edit_date": 1539698291, "question_id": 42803528, "link": "https://stackoverflow.com/questions/42803528/excel-filter-with-multiple-criteria-autofilter-or-advancedfilter", "title": "Excel : filter with Multiple Criteria : AutoFilter or AdvancedFilter", "body": "<p>I am trying to create a filter that will do the below</p>\n\n<p>Begins with \"4\" or\nContains \"2TWH\" or\nContains \"2TER\"</p>\n\n<p>I believe it will turn out to look like this</p>\n\n<pre><code>ActiveSheet.Range(\"$A$5:$H$10\").AutoFilter Field:=2, Criteria1:=\"=4*\", _\n    Operator:=xlOr, Criteria2:=\"=*2TWH*\" \n</code></pre>\n\n<p>but I need to somehow also have a criteria 3 for =\"=<em>2TER</em>\"</p>\n\n<p>I did some googling and saw that you can store the values into an array and then  call the array values but I was unable to get them into the array in a usable fashion.</p>\n\n<p>Is anyone able to offer some assistance with this please?</p>\n"}, {"tags": ["c#", "excel", "excel-interop", "vba"], "comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 1, "creation_date": 1489578621, "post_id": 42803332, "comment_id": 72730070, "body": "Assuming an .xlam add-in: <code>m_Application.Run(&quot;&#39;add-in name.xlam&#39;!Data.GetVersion&quot;)</code>"}, {"owner": {"reputation": 638, "user_id": 388611, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/YhvP8.jpg?s=128&g=1", "display_name": "Drakestar", "link": "https://stackoverflow.com/users/388611/drakestar"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1489594133, "post_id": 42803332, "comment_id": 72742355, "body": "Thanks. Once I get that to run (turns out that Excel is looking for the file in my default Documents directory unless I qualify the complete path to the file), I get the dreaded <code>&quot;Exception from HRESULT: 0x800AC472&quot;</code>. Of course that might have any number of reasons. Any ideas?"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 1, "creation_date": 1489594333, "post_id": 42803332, "comment_id": 72742509, "body": "You shouldn&#39;t need the path if the add-in is open in Excel. I couldn&#39;t really comment on a generic error like that, certainly not without seeing the macro code."}, {"owner": {"reputation": 638, "user_id": 388611, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/YhvP8.jpg?s=128&g=1", "display_name": "Drakestar", "link": "https://stackoverflow.com/users/388611/drakestar"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1489595556, "post_id": 42803332, "comment_id": 72743377, "body": "Weird. I&#39;m getting the runtime exception <code>&quot;Sorry, we couldn&#39;t find C:\\\\Users\\\\user.name\\\\Documents\\\\Logic.xlam. Is it possible it was moved, renamed or deleted?&quot;</code> The workbook I have opened via Interop has the .xlam referenced, and its modules show up in the VBA editor. (My macros run correctly when I invoke everything inside an Excel session, as well.) Is there a way to get a list of all add-ins in Interop so that I can check what is loaded, and what the file references are?"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1489595647, "post_id": 42803332, "comment_id": 72743462, "body": "What was the error when you didn&#39;t include the path?"}, {"owner": {"reputation": 638, "user_id": 388611, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/YhvP8.jpg?s=128&g=1", "display_name": "Drakestar", "link": "https://stackoverflow.com/users/388611/drakestar"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1489595758, "post_id": 42803332, "comment_id": 72743535, "body": "See above. It excepts with the message that it can&#39;t find the .xlam file. When I provide a fully qualified path, I get 0x800AC472. I might add that my add-in file is not in Excel&#39;s default directory - I&#39;m browsing for it."}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1489595964, "post_id": 42803332, "comment_id": 72743668, "body": "I think you need to provide more code showing how the application, workbook and add-in were loaded."}, {"owner": {"reputation": 638, "user_id": 388611, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/YhvP8.jpg?s=128&g=1", "display_name": "Drakestar", "link": "https://stackoverflow.com/users/388611/drakestar"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1489596064, "post_id": 42803332, "comment_id": 72743740, "body": "Yeah, I&#39;ll update this Q later. Right now I&#39;m going to embedd the modules back in the actual .xlsm as a workaround, gotta make a deadline real quick :)"}], "owner": {"reputation": 638, "user_id": 388611, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/YhvP8.jpg?s=128&g=1", "display_name": "Drakestar", "link": "https://stackoverflow.com/users/388611/drakestar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 314, "favorite_count": 0, "answer_count": 0, "score": 3, "last_activity_date": 1489562866, "creation_date": 1489562360, "last_edit_date": 1531164843, "question_id": 42803332, "link": "https://stackoverflow.com/questions/42803332/running-a-macro-in-an-excel-add-in-via-interop", "title": "Running a macro in an Excel add-in via interop", "body": "<p>I have an Excel workbook that installs an add-in with macros. After I load this workbook via Excel interop, I want to run those add-in macros from code. I'm not sure how to reference them, tho.</p>\n\n<p>I've been executing macros that live in the loaded workbook's modules without issues, like this:</p>\n\n<pre><code>private Application m_Application; \n...\nstring version = m_Application.Run(\"Data.GetVersion\");\n</code></pre>\n\n<p>But now <code>GetVersion</code> doesn't live in the workbook's <code>Data</code> module anymore. It's contained in a <code>Data</code> module <em>in the add-in</em>. What is the correct syntax for calling it? </p>\n"}, {"tags": ["vba", "excel", "pivot"], "answers": [{"tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": true, "score": 1, "last_activity_date": 1489561896, "creation_date": 1489561896, "answer_id": 42803219, "question_id": 42803085, "link": "https://stackoverflow.com/questions/42803085/defining-variable-source-range-for-pivot-chart-code-in-vba/42803219#42803219", "title": "Defining variable Source range for pivot chart code in VBA", "body": "<p>There is a way, try the code below:</p>\n\n<pre><code>SourceData:= \"DATA INPUT SHEET!\" &amp; Range(Cells(2, 1), Cells(FinalRow, 8 + NoBids)).Address(True, True, xlR1C1)\n</code></pre>\n\n<p>If you want to learn more about the <code>Range.Address</code> Property, read <a href=\"https://msdn.microsoft.com/en-us/library/office/ff837625.aspx\" rel=\"nofollow noreferrer\">HERE</a></p>\n"}], "owner": {"reputation": 27, "user_id": 7713185, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df91ac812b20c2665ff13461a74784f6?s=128&d=identicon&r=PG&f=1", "display_name": "Raj", "link": "https://stackoverflow.com/users/7713185/raj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 166, "favorite_count": 0, "accepted_answer_id": 42803219, "answer_count": 1, "score": 1, "last_activity_date": 1489561896, "creation_date": 1489561369, "last_edit_date": 1489561448, "question_id": 42803085, "link": "https://stackoverflow.com/questions/42803085/defining-variable-source-range-for-pivot-chart-code-in-vba", "title": "Defining variable Source range for pivot chart code in VBA", "body": "<p>I have recorded a macro for pivot table and chart. Now I what to change the range as per the changes in the rows and columns of the source sheet. </p>\n\n<p>The code from the recorded macro is:</p>\n\n<pre><code>SourceData:= _\n        \"DATA INPUT SHEET!R2C1:R23C12\", Version:=xlPivotTableVersion15)\n</code></pre>\n\n<p>Any way out to change the Range <code>R2C1:R23C12</code> to <code>Range(Cells(2,1),Cells(FinalRow,8+NoBids))</code>, where <code>Finalrow</code> is the last row of the source sheet and <code>NoBids</code> is to the no. of columns to be added after the 8th column of the source sheet.</p>\n"}, {"tags": ["excel", "vba", "outlook"], "comments": [{"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 2, "creation_date": 1489561417, "post_id": 42802828, "comment_id": 72719275, "body": "After .to - add .cc = &quot;email address&quot; and next line .bcc = &quot;email address&quot;"}], "answers": [{"tags": [], "owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "is_accepted": true, "score": 2, "last_activity_date": 1489561724, "creation_date": 1489561724, "answer_id": 42803179, "question_id": 42802828, "link": "https://stackoverflow.com/questions/42802828/how-to-embedd-cc-and-bcc-in-the-vba-macro-code-while-send-set-of-rows-to-unique/42803179#42803179", "title": "How to Embedd CC and BCC in the VBA Macro Code while send set of rows to unique person", "body": "<p>Should be</p>\n\n<pre><code>         With OutMail\n                .to = mailAddress\n                .cc = \"email address\"\n                .Bcc =\"email address\"\n</code></pre>\n\n<p>If you want to add more than one email then </p>\n\n<p><code>.cc = \"email address; email address\"</code></p>\n"}, {"comments": [{"owner": {"reputation": 133, "user_id": 6633301, "user_type": "registered", "accept_rate": 62, "profile_image": "https://lh4.googleusercontent.com/-3FTx74t3OXc/AAAAAAAAAAI/AAAAAAAAAFE/MGWCSzXiIIc/photo.jpg?sz=128", "display_name": "Revan Erraboina", "link": "https://stackoverflow.com/users/6633301/revan-erraboina"}, "edited": false, "score": 1, "creation_date": 1489571740, "post_id": 42803287, "comment_id": 72725210, "body": "Thank you very much, that was helpful. Sir, I just realised that my macro ( the macro that I posted) works after filtering unique values in A1,  the range is getting copied from A1:H1,  but I  need the range to get copied from B1:H1. Eg: if there is a table with marks of students and I want to post the individual marks table to every student separately. This macro is sending the table along with the student name which is in the first column, but I need only marks table, don&#39;t need students name along with that."}], "tags": [], "owner": {"reputation": 2181, "user_id": 3468139, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fhetA.jpg?s=128&g=1", "display_name": "jainashish", "link": "https://stackoverflow.com/users/3468139/jainashish"}, "is_accepted": false, "score": 0, "last_activity_date": 1489562166, "creation_date": 1489562166, "answer_id": 42803287, "question_id": 42802828, "link": "https://stackoverflow.com/questions/42802828/how-to-embedd-cc-and-bcc-in-the-vba-macro-code-while-send-set-of-rows-to-unique/42803287#42803287", "title": "How to Embedd CC and BCC in the VBA Macro Code while send set of rows to unique person", "body": "<p>I will advise using a separate sub-routine for sending the email. Use the existing sub-routine to classify the data and call the below sub-routine whenever you want to send the email. This will resolve your problem of adding and resolving the bcc and cc mail addresses and in addition, will do excellent memory management with the outlook instance.</p>\n\n<p>Please use the below code:</p>\n\n<pre><code>Sub SendEmail(ByVal str_To_EmailAddress As String, ByVal strSubject As String, ByVal strHTMLBody As String)\nDim OutApp As Object\nDim oMsg As Object\nDim objRecip As Object\n\nDim str_CC_EmailAddress As String\nDim str_BCC_EmailAddress As String\n\nSet OutApp = CreateObject(\"Outlook.Application\")\nSet oMsg = OutApp.ActiveInspector.CurrentItem\n\nstr_CC_EmailAddress = \"ABC@example.com\"\nstr_BCC_EmailAddress = \"XYZ@example.com\"\n\nWith oMsg\n    'Add to Email Address\n    Set objRecip = oMsg.Recipients.Add(strToEmailAddress)\n    objRecip.Type = olTo\n    objRecip.Resolve\n\n    'Add CC Email Address\n    Set objRecip = oMsg.Recipients.Add(str_CC_EmailAddress)\n    objRecip.Type = olCC\n    objRecip.Resolve\n\n    'Add BCC Email Address\n    Set objRecip = oMsg.Recipients.Add(str_BCC_EmailAddress)\n    objRecip.Type = olBCC\n    objRecip.Resolve\n\n    'Add Subject\n    .Subject = strSubject\n\n    'Add Body\n    .BodyFormat = olFormatHTML\n\n    'Display or Send\n    .Display '.Send\nEnd With\n\nSet oMsg = Nothing\n\nEnd Sub\n</code></pre>\n\n<p>Please construct the strings of email addresses separated by semicolons (;).</p>\n"}], "owner": {"reputation": 133, "user_id": 6633301, "user_type": "registered", "accept_rate": 62, "profile_image": "https://lh4.googleusercontent.com/-3FTx74t3OXc/AAAAAAAAAAI/AAAAAAAAAFE/MGWCSzXiIIc/photo.jpg?sz=128", "display_name": "Revan Erraboina", "link": "https://stackoverflow.com/users/6633301/revan-erraboina"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3204, "favorite_count": 1, "accepted_answer_id": 42803179, "answer_count": 2, "score": 3, "last_activity_date": 1592873087, "creation_date": 1489560477, "last_edit_date": 1592873087, "question_id": 42802828, "link": "https://stackoverflow.com/questions/42802828/how-to-embedd-cc-and-bcc-in-the-vba-macro-code-while-send-set-of-rows-to-unique", "title": "How to Embedd CC and BCC in the VBA Macro Code while send set of rows to unique person", "body": "<p>I have got a macro which would eMail a row or rows to each person in a range. I just want to know how to add CC and BCC which are same in every email.I am amature to Excel VBA. Please help.</p>\n\n<p>here is the code</p>\n\n<pre><code>Sub Send_Row_Or_Rows_1()\n\nDim OutApp As Object\nDim OutMail As Object\nDim rng As Range\nDim Ash As Worksheet\nDim Cws As Worksheet\nDim Rcount As Long\nDim Rnum As Long\nDim FilterRange As Range\nDim FieldNum As Integer\nDim mailAddress As String\nDim StrBody As String\n\nOn Error GoTo cleanup\nSet OutApp = CreateObject(\"Outlook.Application\")\n\nWith Application\n    .EnableEvents = False\n    .ScreenUpdating = False\nEnd With\n\n\nSet Ash = ActiveSheet\n\n'Set filter range and filter column (Column with names)\nSet FilterRange = Ash.Range(\"A1:H\" &amp; Ash.Rows.Count)\nFieldNum = 1    'Filter column = A because the filter range start in A\n\n'Add a worksheet for the unique list and copy the unique list in A1\nSet Cws = Worksheets.Add\nFilterRange.Columns(FieldNum).AdvancedFilter _\n        Action:=xlFilterCopy, _\n        CopyToRange:=Cws.Range(\"A1\"), _\n        CriteriaRange:=\"\", Unique:=True\n\n'Count of the unique values + the header cell\nRcount = Application.WorksheetFunction.CountA(Cws.Columns(1))\n\n'If there are unique values start the loop\nIf Rcount &gt;= 2 Then\n    For Rnum = 2 To Rcount\n\n        'Filter the FilterRange on the FieldNum column\n        FilterRange.AutoFilter Field:=FieldNum, _\n                               Criteria1:=Cws.Cells(Rnum, 1).Value\n\n        'Look for the mail address in the MailInfo worksheet\n        mailAddress = \"\"\n        On Error Resume Next\n        mailAddress = Application.WorksheetFunction. _\n                      VLookup(Cws.Cells(Rnum, 1).Value, _\n                            Worksheets(\"Mailinfo\").Range(\"A1:B\" &amp; _\n                            Worksheets(\"Mailinfo\").Rows.Count), 2, False)\n        On Error GoTo 0\n\n        If mailAddress &lt;&gt; \"\" Then\n            With Ash.AutoFilter.Range\n                On Error Resume Next\n                Set rng = .SpecialCells(xlCellTypeVisible)\n                On Error GoTo 0\n            End With\n\n            Set OutMail = OutApp.CreateItem(0)\n\n            On Error Resume Next\n\n            With OutMail\n                .to = mailAddress\n                .Subject = \"Test mail\"\n                .HTMLBody = StrBody &amp; RangetoHTML(rng)\n                .Display  'Or use Send\n\n                StrBody = Sheets(\"Sheet2\").Range(\"A1\").Value &amp; \"&lt;br&gt;\" &amp; \"&lt;br&gt;\" &amp; _\n          Sheets(\"Sheet2\").Range(\"A2\").Value &amp; \"&lt;br&gt;\" &amp; \"&lt;br&gt;\" &amp; _\n          Sheets(\"Sheet2\").Range(\"A3\").Value &amp; \"&lt;br&gt;&lt;br&gt;&lt;br&gt;\"\n\n            End With\n            On Error GoTo 0\n\n            Set OutMail = Nothing\n        End If\n\n        'Close AutoFilter\n        Ash.AutoFilterMode = False\n\n    Next Rnum\nEnd If\ncleanup:\nSet OutApp = Nothing\nApplication.DisplayAlerts = False\nCws.Delete\nApplication.DisplayAlerts = True\n\nWith Application\n    .EnableEvents = True\n    .ScreenUpdating = True\nEnd With\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "reply_to_user": {"reputation": 31, "user_id": 7712822, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c53f249f3eaf24109ab44017ae8912f2?s=128&d=identicon&r=PG&f=1", "display_name": "cherryl", "link": "https://stackoverflow.com/users/7712822/cherryl"}, "edited": false, "score": 0, "creation_date": 1489582440, "post_id": 42804105, "comment_id": 72732799, "body": "It&#39;s already copied with  ThisWorkbook.Worksheets.Copy After:=wbNew.Worksheets(1). Your command just copies from and to wks.usedrange. Source and target are the same. Delete this part of the code and the rest should just do what you want."}], "tags": [], "owner": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "is_accepted": false, "score": 0, "last_activity_date": 1489565160, "creation_date": 1489565160, "answer_id": 42804105, "question_id": 42801807, "link": "https://stackoverflow.com/questions/42801807/vba-error-1004-on-range-value-when-copying-the-worksheet/42804105#42804105", "title": "VBA error 1004 on range.value when copying the worksheet", "body": "<p>What's the purpose of wks.usedrange.value = wks.usedrange.value?\nThis question is independent of whether the command is permitted by VBA.</p>\n"}, {"tags": [], "owner": {"reputation": 261, "user_id": 7329451, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/F4HSK.jpg?s=128&g=1", "display_name": "K.Fanedoul", "link": "https://stackoverflow.com/users/7329451/k-fanedoul"}, "is_accepted": false, "score": 0, "last_activity_date": 1489568093, "creation_date": 1489568093, "answer_id": 42805019, "question_id": 42801807, "link": "https://stackoverflow.com/questions/42801807/vba-error-1004-on-range-value-when-copying-the-worksheet/42805019#42805019", "title": "VBA error 1004 on range.value when copying the worksheet", "body": "<p>Can't understand why you trying to do this : </p>\n\n<pre><code>For Each wks In wbNew.Worksheets\n    wks.UsedRange.Value = wks.UsedRange.Value\nNext wks\n</code></pre>\n\n<p>It's like saying that x = x</p>\n"}], "owner": {"reputation": 31, "user_id": 7712822, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c53f249f3eaf24109ab44017ae8912f2?s=128&d=identicon&r=PG&f=1", "display_name": "cherryl", "link": "https://stackoverflow.com/users/7712822/cherryl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 199, "favorite_count": 0, "answer_count": 2, "score": 3, "last_activity_date": 1489568093, "creation_date": 1489556129, "last_edit_date": 1531164843, "question_id": 42801807, "link": "https://stackoverflow.com/questions/42801807/vba-error-1004-on-range-value-when-copying-the-worksheet", "title": "VBA error 1004 on range.value when copying the worksheet", "body": "<p>Below is the code I am using, but it throws a 1004 error on the <code>range.value</code> line.  However it copies successfully the worksheet without formulas (just values). It's just that running this keeps throwing the error 1004.</p>\n\n<pre><code>Sub test1()     \n    Dim wbNew As Workbook\n    Dim wks As Worksheet\n    Set wbNew = Workbooks.Add(xlWBATWorksheet)\n    ThisWorkbook.Worksheets.Copy After:=wbNew.Worksheets(1)\n    Application.DisplayAlerts = False\n    wbNew.Worksheets(1).Delete\n    Application.DisplayAlerts = True\n    Application.Calculation = xlCalculationManual\n\n    For Each wks In wbNew.Worksheets\n        wks.UsedRange.Value = wks.UsedRange.Value\n    Next wks\n    Application.Dialogs(xlDialogSaveAs).Show\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 113, "user_id": 6180229, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/9678f78945db2173fe02bcfd96f4f9ef?s=128&d=identicon&r=PG&f=1", "display_name": "Nafis", "link": "https://stackoverflow.com/users/6180229/nafis"}, "edited": false, "score": 0, "creation_date": 1489574238, "post_id": 42804758, "comment_id": 72727034, "body": "Thank to reply I tried your suggestion but nothing is happening with this one also. I think there may be any problem with combo box or cell in column A which contains dates. when I select date from combo box somewhere date format is being changed and not matching the condition. Request you to check the codes. OR can I send you my file?"}, {"owner": {"reputation": 1334, "user_id": 7579539, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XY7eB.png?s=128&g=1", "display_name": "Pspl", "link": "https://stackoverflow.com/users/7579539/pspl"}, "reply_to_user": {"reputation": 113, "user_id": 6180229, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/9678f78945db2173fe02bcfd96f4f9ef?s=128&d=identicon&r=PG&f=1", "display_name": "Nafis", "link": "https://stackoverflow.com/users/6180229/nafis"}, "edited": false, "score": 0, "creation_date": 1489583447, "post_id": 42804758, "comment_id": 72733622, "body": "Before you do that (I noticed another thing) declare your <code>dtt1</code> and <code>dtt2</code> as <code>Date</code>, not as <code>String</code> and try again."}, {"owner": {"reputation": 113, "user_id": 6180229, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/9678f78945db2173fe02bcfd96f4f9ef?s=128&d=identicon&r=PG&f=1", "display_name": "Nafis", "link": "https://stackoverflow.com/users/6180229/nafis"}, "edited": false, "score": 0, "creation_date": 1489653429, "post_id": 42804758, "comment_id": 72767871, "body": "Thanks my code is now working, but &quot;AND&quot; operator in if condition is not working.     If Range(&quot;A&quot; &amp; i).Value &gt;= dtt1 And Range(&quot;A&quot; &amp; i).Value &lt;= dtt2 Then  when I try only one condition (i.e. range(&quot;A&quot; &amp; i) &gt;= dtt1 then ) it works. Is there any mistake in use of &quot;AND&quot;. or some other problem is occurring there."}, {"owner": {"reputation": 1334, "user_id": 7579539, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XY7eB.png?s=128&g=1", "display_name": "Pspl", "link": "https://stackoverflow.com/users/7579539/pspl"}, "reply_to_user": {"reputation": 113, "user_id": 6180229, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/9678f78945db2173fe02bcfd96f4f9ef?s=128&d=identicon&r=PG&f=1", "display_name": "Nafis", "link": "https://stackoverflow.com/users/6180229/nafis"}, "edited": false, "score": 0, "creation_date": 1489684021, "post_id": 42804758, "comment_id": 72790174, "body": "It&#39;s not working because it generates a run time error? Or simply doesn&#39;t do want you want it to do?"}, {"owner": {"reputation": 113, "user_id": 6180229, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/9678f78945db2173fe02bcfd96f4f9ef?s=128&d=identicon&r=PG&f=1", "display_name": "Nafis", "link": "https://stackoverflow.com/users/6180229/nafis"}, "edited": false, "score": 0, "creation_date": 1489725601, "post_id": 42804758, "comment_id": 72806547, "body": "Yes, it is not doing actually what I want it to do. sometimes it is deleting other rows or doing nothing. :-("}, {"owner": {"reputation": 1334, "user_id": 7579539, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XY7eB.png?s=128&g=1", "display_name": "Pspl", "link": "https://stackoverflow.com/users/7579539/pspl"}, "reply_to_user": {"reputation": 113, "user_id": 6180229, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/9678f78945db2173fe02bcfd96f4f9ef?s=128&d=identicon&r=PG&f=1", "display_name": "Nafis", "link": "https://stackoverflow.com/users/6180229/nafis"}, "edited": false, "score": 0, "creation_date": 1489998239, "post_id": 42804758, "comment_id": 72897573, "body": "Ok. Maybe the problem is about the date format. I have some problems when I use a day-month-year format (the usual date format on my country) because the <i>standart</i> format for VB is month-day-year. Just for test, try change the format to <code>&quot;mm-dd-yyyy&quot;</code> and run your code with some examples. If you don&#39;t see any errors then the problem is identified. Don&#39;t worry though! There are some simple things to do to correct this issue."}, {"owner": {"reputation": 113, "user_id": 6180229, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/9678f78945db2173fe02bcfd96f4f9ef?s=128&d=identicon&r=PG&f=1", "display_name": "Nafis", "link": "https://stackoverflow.com/users/6180229/nafis"}, "edited": false, "score": 0, "creation_date": 1490156804, "post_id": 42804758, "comment_id": 72981940, "body": "thanks the problem is solved now, actually there was issue with dtt declaration as I was declaring that as string &amp; date format was change there. Thanks Pspl for you kind support. :-)"}], "tags": [], "owner": {"reputation": 1334, "user_id": 7579539, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XY7eB.png?s=128&g=1", "display_name": "Pspl", "link": "https://stackoverflow.com/users/7579539/pspl"}, "is_accepted": false, "score": 2, "last_activity_date": 1489567279, "creation_date": 1489567279, "answer_id": 42804758, "question_id": 42801440, "link": "https://stackoverflow.com/questions/42801440/compare-date-with-combo-box-setection-delete-rows-between-specific-date-range/42804758#42804758", "title": "compare date with combo box setection &amp; delete rows between specific date range", "body": "<p>Instead of</p>\n\n<pre><code>For i = 2 To lRow\n</code></pre>\n\n<p>try</p>\n\n<pre><code>For i = lRow To 2 step -1\n</code></pre>\n\n<p>Please note: I didn't check the rest of your code because probably this is the problem; when you want to delete rows (or columns) on a spreadsheet by VBA, is always a good procedure doing it from bottom to top (or right to left if you're dealing with columns).</p>\n"}], "owner": {"reputation": 113, "user_id": 6180229, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/9678f78945db2173fe02bcfd96f4f9ef?s=128&d=identicon&r=PG&f=1", "display_name": "Nafis", "link": "https://stackoverflow.com/users/6180229/nafis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 332, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1489567279, "creation_date": 1489554002, "last_edit_date": 1531164843, "question_id": 42801440, "link": "https://stackoverflow.com/questions/42801440/compare-date-with-combo-box-setection-delete-rows-between-specific-date-range", "title": "compare date with combo box setection &amp; delete rows between specific date range", "body": "<p><a href=\"https://i.stack.imgur.com/m6Fyj.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/m6Fyj.jpg\" alt=\"This is my excel sheet where I am working to get data only between a specific date range selected through two combo boxes.\"></a></p>\n\n<p>Hi there,</p>\n\n<p>Thanks to you for your support I got recently. I am working with a excel sheet (image is attached here), here I have approx 60k rows repeating same date in column A. Actually what I need to do is to select start date &amp; end date through user form (can see in image). when will click on OK button rest rows having dates out of given date range should be deleted.\nbut my code is not working exactly as I want &amp; deleting some of rows which is within the range. I accept there may be my mistakes but after so many efforts I couldn't find out. And also dates in combo box is repeating so many times &amp; not sorted. pls go thorough my codes below -</p>\n\n<pre><code>Private Sub CancelButton_Click()\nUnload UserForm1\nEnd Sub\n\nPrivate Sub ComboBox1_Change()\nComboBox1.Value = Format(ComboBox1.Value, \"dd-mmm-yyyy\")\nEnd Sub\n\nPrivate Sub ComboBox2_Change()\nComboBox2.Value = Format(ComboBox2.Value, \"dd-mmm-yyyy\")\nEnd Sub\n\nPrivate Sub okButton_Click()\nDim i As Double, dt1 As String, dtt1 As String\nDim dt2 As String, dtt2 As String\nDim ws As Worksheet, lRow As Long\nSet ws = ActiveWorkbook.Sheets(1)\nWith ws\nlRow = .Range(\"A\" &amp; .Rows.Count).End(xlUp).Row\nEnd With\ndt1 = ComboBox1.Value\ndtt1 = CDate(dt1)\ndt2 = ComboBox2.Value\ndtt2 = CDate(dt2)\nApplication.ScreenUpdating = False\nFor i = 2 To lRow\nIf Range(\"A\" &amp; i).Value &gt;= dtt1 And Range(\"A\" &amp; i).Value &lt;= dtt2 Then\n     Rows(i).Select\n     Selection.Delete\n     i = i - 1\nEnd If\nNext\nApplication.ScreenUpdating = True\nUnload UserForm1\nEnd Sub\n\nPrivate Sub UserForm_Initialize()\nSet ws = ActiveWorkbook.Sheets(1)\nWith ws\nlRow = .Range(\"A\" &amp; .Rows.Count).End(xlUp).Row\nEnd With\nComboBox1.RowSource = \"A2:A\" &amp; lRow\nComboBox2.RowSource = \"A2:A\" &amp; lRow\nEnd Sub\n</code></pre>\n\n<p>Thanks a lot in advance.</p>\n"}, {"tags": ["excel", "vba", "outlook"], "answers": [{"comments": [{"owner": {"reputation": 160, "user_id": 7229645, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BSOXb.jpg?s=128&g=1", "display_name": "Kelvin", "link": "https://stackoverflow.com/users/7229645/kelvin"}, "edited": false, "score": 0, "creation_date": 1489571392, "post_id": 42805249, "comment_id": 72724976, "body": "Thanks @0m3r that works perfectly.. Just one thing missing. In the body content Hello &quot;D&quot; refers to the D column.value. So I need to update the name automatically based on the value. Would it be possible?"}, {"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "reply_to_user": {"reputation": 160, "user_id": 7229645, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BSOXb.jpg?s=128&g=1", "display_name": "Kelvin", "link": "https://stackoverflow.com/users/7229645/kelvin"}, "edited": false, "score": 1, "creation_date": 1489571878, "post_id": 42805249, "comment_id": 72725320, "body": "@Kelvin just add another variable in your <code>do loop</code> Example <code>BodyName = .Cells(i, 4).Value</code> then on the <code>MsgFwd.HTMLBody = EmailBody &amp; &quot; &quot; &amp; BodyName &amp; &quot;&lt;BR&gt;&quot; &amp; &quot;&lt;BR&gt;&quot; &amp; Item.HTMLBody</code>"}, {"owner": {"reputation": 160, "user_id": 7229645, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BSOXb.jpg?s=128&g=1", "display_name": "Kelvin", "link": "https://stackoverflow.com/users/7229645/kelvin"}, "edited": false, "score": 1, "creation_date": 1489572344, "post_id": 42805249, "comment_id": 72725660, "body": "Superb, Thanks alot.. I really owe you :)"}], "tags": [], "owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "is_accepted": true, "score": 2, "last_activity_date": 1489569067, "last_edit_date": 1489569067, "creation_date": 1489568729, "answer_id": 42805249, "question_id": 42801270, "link": "https://stackoverflow.com/questions/42801270/excel-vba-to-include-body-in-the-forwarded-outlook-email/42805249#42805249", "title": "Excel VBA to include body in the forwarded outlook email", "body": "<p>Add new variable as string <strong><code>Dim EmailBody As String</code></strong> then assign to column C <strong><code>EmailBody = .Cells(i, 3).Value</code></strong> with in your <strong><code>Do Loop</code></strong></p>\n\n<p>To remove the following from the <strong><code>Item.Forward</code></strong> body, simply add your <strong><code>Item.Body</code></strong> to your <strong><code>MsgFwd.Body</code></strong> - it should replace the whole forward Email body with <code>Item.Body</code> only</p>\n\n<hr>\n\n<p><a href=\"https://i.stack.imgur.com/Q2548.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Q2548.png\" alt=\"enter image description here\"></a></p>\n\n<p><strong><code>MsgFwd.HTMLBody = EmailBody &amp; \"&lt;BR&gt;\" &amp; \"&lt;BR&gt;\" &amp; Item.HTMLBody</code></strong></p>\n\n<hr>\n\n<p>Example</p>\n\n<pre><code>Dim EmailBody As String\nWith Worksheets(\"Sheet1\") ' Sheet Name\n    Do Until IsEmpty(.Cells(i, 1))\n\n    ItemSubject = .Cells(i, 1).Value '(i, 1) = (Row 2,Column 1)\n    Email = .Cells(i, 16).Value '(i, 2) = (Row 2,Column 2)\n    Email1 = .Cells(i, 2).Value\n    EmailBody = .Cells(i, 3).Value\n\n        '// Loop through Inbox Items backwards\n        For lngCount = Items.Count To 1 Step -1\n            Set Item = Items.Item(lngCount)\n\n            If Item.Subject = ItemSubject Then ' if Subject found then\n                Set MsgFwd = Item.Forward\n                Set RecipTo = MsgFwd.Recipients.Add(Email1) ' add To Recipient\n                Set RecipTo = MsgFwd.Recipients.Add(\"sen@aa.com\")\n                Set RecipBCC = MsgFwd.Recipients.Add(Email) ' add BCC Recipient\n                MsgFwd.SentOnBehalfOfName = \"doc@aa.com\"\n\n                RecipTo.Type = olTo\n                RecipBCC.Type = olBCC\n\n                Debug.Print Item.Body ' Immediate Window\n\n                MsgFwd.HTMLBody = EmailBody &amp; \"&lt;BR&gt;\" &amp; \"&lt;BR&gt;\" &amp; Item.HTMLBody\n                MsgFwd.Display\n\n            End If\n        Next ' exit loop\n</code></pre>\n"}], "owner": {"reputation": 160, "user_id": 7229645, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BSOXb.jpg?s=128&g=1", "display_name": "Kelvin", "link": "https://stackoverflow.com/users/7229645/kelvin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 882, "favorite_count": 1, "accepted_answer_id": 42805249, "answer_count": 1, "score": 4, "last_activity_date": 1592871295, "creation_date": 1489553114, "last_edit_date": 1592871295, "question_id": 42801270, "link": "https://stackoverflow.com/questions/42801270/excel-vba-to-include-body-in-the-forwarded-outlook-email", "title": "Excel VBA to include body in the forwarded outlook email", "body": "<p>I am trying to forward emails based on the subject provided in the A column by looping. Its working perfectly, but I would also like to include the content in the C column to each of the corresponding mail. </p>\n\n<p>Also delete the from and to details from the initial mail.</p>\n\n<p><a href=\"https://i.stack.imgur.com/i8IL0.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/i8IL0.png\" alt=\"enter image description here\"></a> </p>\n\n<p>Request template:</p>\n\n<p>The body content should also use the column value as mentioned below.</p>\n\n<p><a href=\"https://i.stack.imgur.com/E7g7T.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/E7g7T.png\" alt=\"enter image description here\"></a></p>\n\n<p>Can some one help me remove and include this details in the below.. </p>\n\n<pre><code>Option Explicit\nPublic Sub Example()\nDim olApp As Outlook.Application\nDim olNs As Outlook.Namespace\nDim Inbox As Outlook.MAPIFolder\nDim Item As Variant\nDim MsgFwd As MailItem\nDim Items As Outlook.Items\nDim Email As String\nDim Email1 As String\nDim ItemSubject As String\nDim lngCount As Long\nDim i As Long\nDim RecipTo As Recipient\nDim RecipCC As Recipient\nDim RecipBCC As Recipient\nDim onbehalf As Variant\n\n\n\nSet olApp = CreateObject(\"Outlook.Application\")\nSet olNs = olApp.GetNamespace(\"MAPI\")\nSet Inbox = olNs.GetDefaultFolder(olFolderInbox)\nSet Items = Inbox.Items\n\ni = 2 '  i = Row 2\n\nWith Worksheets(\"Sheet1\") ' Sheet Name\n    Do Until IsEmpty(.Cells(i, 1))\n\n    ItemSubject = .Cells(i, 1).Value '(i, 1) = (Row 2,Column 1)\n    Email = .Cells(i, 16).Value '(i, 2) = (Row 2,Column 2)\n    Email1 = .Cells(i, 2).Value\n\n        '// Loop through Inbox Items backwards\n        For lngCount = Items.Count To 1 Step -1\n            Set Item = Items.Item(lngCount)\n\n            If Item.Subject = ItemSubject Then ' if Subject found then\n                Set MsgFwd = Item.Forward\n                Set RecipTo = MsgFwd.Recipients.Add(Email1) ' add To Recipient\n                Set RecipTo = MsgFwd.Recipients.Add(\"sen@aa.com\")\n                Set RecipBCC = MsgFwd.Recipients.Add(Email) ' add BCC Recipient\n                MsgFwd.SentOnBehalfOfName = \"doc@aa.com\"\n\n\n                    RecipTo.Type = olTo\n                    RecipBCC.Type = olBCC\n                    MsgFwd.Display\n\n            End If\n        Next ' exit loop\n\n        i = i + 1 '  = Row 2 + 1 = Row 3\n    Loop\nEnd With\n\nSet olApp = Nothing\nSet olNs = Nothing\nSet Inbox = Nothing\nSet Item = Nothing\nSet MsgFwd = Nothing\nSet Items = Nothing\n\nMsgBox \"Mail sent\"\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba"], "answers": [{"tags": [], "owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "is_accepted": true, "score": 0, "last_activity_date": 1489561090, "creation_date": 1489561090, "answer_id": 42802993, "question_id": 42801004, "link": "https://stackoverflow.com/questions/42801004/how-to-loop-through-monthly-data-with-vba/42802993#42802993", "title": "How to loop through monthly data with VBA?", "body": "<p>Firstly, you need to finish your loop.  Secondly, to divide the last value by the first value, just create a variable to retain the first value until you reach the row containing the last row - then it is available for the division:</p>\n\n<pre><code>sub find_lastrow()\n    Dim lrow As Long\n    Dim i As Long\n    Dim data As Date\n    Dim next_day As Date\n    Dim StartValue As Double\n\n    lrow = Cells(Rows.Count, \"A\").End(xlUp).Row\n    StartValue = Cells(2, \"B\").Value\n\n    For i = 2 To lrow\n\n        data = Cells(i, \"A\")\n        next_date = Cells(i + 1, \"A\")\n\n        'finding and painting last day of each month and last day of each year\n\n        If Month(next_date) = Month(data) + 1 Or _\n            Year(next_date) = Year(data) + 1 Then\n\n            Cells(i, \"C\").Value = Cells(i, \"B\").Value / StartValue\n            'Set up start value for next month\n            StartValue = Cells(i + 1, \"B\").Value\n\n            With Range(Cells(i, \"A\"), Cells(i, \"K\")).Interior\n                .Pattern = xlSolid\n                .PatternColorIndex = xlAutomatic\n                .ThemeColor = xlThemeColorLight2\n                .TintAndShade = 0.799981688894314\n                .PatternTintAndShade = 0\n            End With\n\n        End If\n    Next\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 7712484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1adccb9b46b570bf3fd9fd2bfea08484?s=128&d=identicon&r=PG&f=1", "display_name": "Raphy", "link": "https://stackoverflow.com/users/7712484/raphy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 269, "favorite_count": 0, "accepted_answer_id": 42802993, "answer_count": 1, "score": 1, "last_activity_date": 1489561090, "creation_date": 1489551310, "last_edit_date": 1489560599, "question_id": 42801004, "link": "https://stackoverflow.com/questions/42801004/how-to-loop-through-monthly-data-with-vba", "title": "How to loop through monthly data with VBA?", "body": "<p>I am new here and will appreciate your help in the challenge I am facing. </p>\n\n<p>I am working on a project using VBA for Excel. I have data from 14 months and want to divide the last value of every month by the first value of the same month. The first working day of the month can be any day, and so can the last day. I wrote the code below to find and highlight the last day of every month, and it works.</p>\n\n<pre><code>sub find_lastrow()\n    Dim lrow As Long\n    Dim i As Long\n    Dim data As Date\n    Dim next_day As Date\n\n    lrow = Cells(Rows.Count, \"A\").End(xlUp).Row\n\n    For i = 2 To lrow\n\n        data = Cells(i, \"A\")\n        next_date = Cells(i, \"A\").Offset(1, 0)\n\n        'finding and painting last day of each month and last day of each year\n\n        If Month(next_date) = Month(data) + 1 Or _\n            Year(next_date) = Year(data) + 1 Then\n\n            Range(Cells(i, \"A\"), Cells(i, \"K\")).Select\n\n            With Selection.Interior\n                .Pattern = xlSolid\n                .PatternColorIndex = xlAutomatic\n                .ThemeColor = xlThemeColorLight2\n                .TintAndShade = 0.799981688894314\n                .PatternTintAndShade = 0\n            End With\n\n        End If\nEnd sub\n</code></pre>\n\n<p>However, I am having a hard time dividing the first value of each month by the last value of the corresponding month. I highly appreciate your help.</p>\n\n<p><a href=\"https://i.stack.imgur.com/sJKTa.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/sJKTa.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2953, "user_id": 2801253, "user_type": "registered", "profile_image": "https://graph.facebook.com/1332362525/picture?type=large", "display_name": "Mark Fitzgerald", "link": "https://stackoverflow.com/users/2801253/mark-fitzgerald"}, "edited": false, "score": 0, "creation_date": 1489568497, "post_id": 42800838, "comment_id": 72723036, "body": "So the Job Titles in Sheet1 may be shorter but never longer than those in Sheet2?"}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 5156922, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/10a7c1f7455091409e0b2a283d903236?s=128&d=identicon&r=PG&f=1", "display_name": "Kumar K", "link": "https://stackoverflow.com/users/5156922/kumar-k"}, "edited": false, "score": 0, "creation_date": 1493872841, "post_id": 42801481, "comment_id": 74588924, "body": "It does not do any &quot;partial match&quot;.  It does only exact match. Sometimes, columnb &quot;melvin&quot; will &quot;melvin CPA&quot; <a href=\"https://spaces.hightail.com/receive/3Qzf9CoIYz\" rel=\"nofollow noreferrer\">Samplefile</a>"}], "tags": [], "owner": {"reputation": 2478, "user_id": 6110371, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/O93Qp.jpg?s=128&g=1", "display_name": "VBA Pete", "link": "https://stackoverflow.com/users/6110371/vba-pete"}, "is_accepted": false, "score": 0, "last_activity_date": 1489554232, "creation_date": 1489554232, "answer_id": 42801481, "question_id": 42800838, "link": "https://stackoverflow.com/questions/42800838/how-can-we-vlookup-sheet1-data-in-sheet2-with-partial-match-columns-c/42801481#42801481", "title": "How can we Vlookup Sheet1 data in sheet2 with partial match Columns C", "body": "<p>You could try a <strong>FOR loop</strong> to compare the values:</p>\n\n<pre><code>Sub CompleteData()\n\nDim lastrow1 As Long, lastrow2 As Long\nDim ws1 As Worksheet, ws2 As Worksheet\n\nSet ws1 = Worksheets(\"Sheet1\")\nSet ws2 = Worksheets(\"Sheet2\")\n\nlastrow1 = ws1.Cells(Rows.Count, \"A\").End(xlUp).Row\nlastrow2 = ws2.Cells(Rows.Count, \"A\").End(xlUp).Row\n\nFor x = 2 To lastrow1 'change to 1 if you have no headers\n    For y = 2 To lastrow2 'change to 1 if you have no headers\n        If ws1.Cells(x, 1).Value = ws2.Cells(y, 1).Value And ws1.Cells(x, 2).Value = ws2.Cells(y, 2).Value And ws1.Cells(x, 3).Value = ws2.Cells(y, 3).Value Then\n            ws1.Cells(x, 4).Value = ws2.Cells(y, 4).Value\n            Exit For\n        End If\n    Next y\nNext x\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": false, "score": 0, "last_activity_date": 1489566541, "creation_date": 1489566541, "answer_id": 42804519, "question_id": 42800838, "link": "https://stackoverflow.com/questions/42800838/how-can-we-vlookup-sheet1-data-in-sheet2-with-partial-match-columns-c/42804519#42804519", "title": "How can we Vlookup Sheet1 data in sheet2 with partial match Columns C", "body": "<p>you could use <code>AutoFilter()</code> and filter Sheet2 columns A to C with corresponding value of each Sheet1 row:</p>\n\n<pre><code>Option Explicit\n\nSub CompleteData()\n    Dim myRng As Range, cell As Range\n\n    With Worksheets(\"Sheet1\")\n        Set myRng = .Range(\"A2\", .cells(.Rows.Count, 1).End(xlUp)).SpecialCells(xlCellTypeConstants, xlTextValues)\n    End With\n\n    With Worksheets(\"Sheet2\")\n        With .Range(\"C1\", .cells(.Rows.Count, 1).End(xlUp))\n            For Each cell In myRng\n                .AutoFilter Field:=1, Criteria1:=cell.Value\n                .AutoFilter Field:=2, Criteria1:=cell.Offset(, 1).Value\n                .AutoFilter Field:=3, Criteria1:=cell.Offset(, 2).Value\n                If Application.WorksheetFunction.Subtotal(103, .cells) &gt; 1 Then cell.Offset(, 3).Value = .Offset(1).Resize(.Rows.Count - 1).SpecialCells(xlCellTypeVisible).cells(1, 4).Value\n                .Parent.AutoFilterMode = False\n            Next\n        End With\n        .AutoFilterMode = False\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 5156922, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/10a7c1f7455091409e0b2a283d903236?s=128&d=identicon&r=PG&f=1", "display_name": "Kumar K", "link": "https://stackoverflow.com/users/5156922/kumar-k"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 272, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1489566541, "creation_date": 1489550248, "last_edit_date": 1495542316, "question_id": 42800838, "link": "https://stackoverflow.com/questions/42800838/how-can-we-vlookup-sheet1-data-in-sheet2-with-partial-match-columns-c", "title": "How can we Vlookup Sheet1 data in sheet2 with partial match Columns C", "body": "<p>Looking VBA macro/Code which can do this simple match/partial match function in Excel spreadsheet.<br/><br/>\nI have 2 sheets in a excel workbook.<br/><br/>\nSheet1 Contains <br/>\nColumnA = First Name <br/>\nColumnB = Last Name<br/>\nColumnC = Job Title<br/></p>\n\n<p>Sheet2 Contains<br/>\nColumnA = First Name <br/>\nColumnB = Last Name<br/>\nColumnC = Job Title<br/>\nColumnD = Emails</p>\n\n<p>I want the macro to vlookup/match Sheet1 ColumnA, B, C with Sheet2 ColumnA, B, C\nand get Sheet2 ColumnD data into Sheet1 columnD with respective row matched.</p>\n\n<p>Note:<br/>\nData could be case sensitive while doing vlookup/match/partial match.<br/>\nHave to do partial match Sheet1 and Sheet2 \"C\" Columns with respective rows</p>\n\n<p>Below are attached files sample and results should look after running the macro.</p>\n\n<p><a href=\"https://spaces.hightail.com/space/kDaSw\" rel=\"nofollow noreferrer\">Sample and results files</a>\nI been through these posts but did not find the answer.</p>\n\n<p><a href=\"https://stackoverflow.com/questions/2159592/how-to-get-data-in-sheet2-from-sheet1-in-excel\">how to get data in sheet2 from sheet1 in excel</a></p>\n\n<p><a href=\"https://stackoverflow.com/questions/416214/how-to-copy-data-from-sheet1-to-sheet2-with-a-condition-in-excel\">How to copy data from sheet1 to sheet2 with a condition in Excel</a></p>\n\n<p><a href=\"https://stackoverflow.com/questions/10617377/merge-data-with-partial-match-in-r\">merge data with partial match in r</a></p>\n\n<p><a href=\"https://stackoverflow.com/questions/9537816/excel-vba-search-for-value-from-sheet1-in-sheet2-and-update-with-adjacent-valu\">Excel VBA - Search for value from sheet1 in sheet2 and update with adjacent value from sheet1</a></p>\n"}, {"tags": ["vba", "excel", "ms-word"], "answers": [{"tags": [], "owner": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "is_accepted": true, "score": 1, "last_activity_date": 1489664134, "creation_date": 1489664134, "answer_id": 42832982, "question_id": 42800786, "link": "https://stackoverflow.com/questions/42800786/vba-excel-to-word-paste-includes-new-line-after-pasted-text/42832982#42832982", "title": "VBA Excel to Word paste includes new line after pasted text", "body": "<p>Try this:-</p>\n\n<blockquote>\n<pre><code>Txt = \"My cell value as string\"\nWith ActiveDocument\n    .Bookmarks(\"Mark\").Range.Text = Txt\nEnd With\n</code></pre>\n</blockquote>\n\n<p>The bookmark will be over-written and can't be used again. If you need to preserve it, capture the range containing the new text and reset the bookmark pointing at it.</p>\n"}], "owner": {"reputation": 33, "user_id": 5179745, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c1d7c81962cb2cb65005e4bf0f708487?s=128&d=identicon&r=PG&f=1", "display_name": "JoshD", "link": "https://stackoverflow.com/users/5179745/joshd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 190, "favorite_count": 0, "accepted_answer_id": 42832982, "answer_count": 1, "score": 0, "last_activity_date": 1489664134, "creation_date": 1489549829, "last_edit_date": 1531164843, "question_id": 42800786, "link": "https://stackoverflow.com/questions/42800786/vba-excel-to-word-paste-includes-new-line-after-pasted-text", "title": "VBA Excel to Word paste includes new line after pasted text", "body": "<p>I'm trying to paste a cell's text to a bookmarked place on a word doc. When I do this it adds a new line after the newly pasted text. How do I get rid of this? I'm using the </p>\n\n<pre><code>PasteAndFormat (wdFormatSurroundingFormattingWithEmphasis)\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 7854, "user_id": 5461205, "user_type": "registered", "profile_image": "https://graph.facebook.com/1112471818782668/picture?type=large", "display_name": "Dirk Reichel", "link": "https://stackoverflow.com/users/5461205/dirk-reichel"}, "edited": false, "score": 0, "creation_date": 1489551955, "post_id": 42800562, "comment_id": 72715936, "body": "you could use workaround 1 with <code>Application.ScreenUpdating = False</code> then change sheet and run the solver. If everything is finished, go back to your sheet and set <code>Application.ScreenUpdating = True</code> again. (No flicker)"}, {"owner": {"reputation": 150, "user_id": 7420464, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c1b1893b73a50174583069fdd7493d2?s=128&d=identicon&r=PG&f=1", "display_name": "fallengyro", "link": "https://stackoverflow.com/users/7420464/fallengyro"}, "reply_to_user": {"reputation": 7854, "user_id": 5461205, "user_type": "registered", "profile_image": "https://graph.facebook.com/1112471818782668/picture?type=large", "display_name": "Dirk Reichel", "link": "https://stackoverflow.com/users/5461205/dirk-reichel"}, "edited": false, "score": 0, "creation_date": 1489575252, "post_id": 42800562, "comment_id": 72727748, "body": "@DirkReichel I appreciate the feedback, but you&#39;ll notice the first thing that I do after the event determines the correct cell changed, is set screenupdating to false. I&#39;m still getting the flicker though. Because updating is false this is a surprising result."}, {"owner": {"reputation": 7854, "user_id": 5461205, "user_type": "registered", "profile_image": "https://graph.facebook.com/1112471818782668/picture?type=large", "display_name": "Dirk Reichel", "link": "https://stackoverflow.com/users/5461205/dirk-reichel"}, "edited": false, "score": 0, "creation_date": 1489589718, "post_id": 42800562, "comment_id": 72738717, "body": "I assume that this is a part of the solver itself. There are multiple actions which cannot prevented. But depending on the complexity of your equations, your best solution will be a sub which &quot;searches&quot; for the solution. Or even better (but probably not possible for us) is a mathematical equation which directly outputs the numbers you need. However: without a sheet and some example data it will be hard to help to do it this way. Also for workaround 2: setting the number format of the cells to &quot;<code>;;;</code>&quot; will be easier. It will look like it&#39;s empty except for the formula bar if selected."}, {"owner": {"reputation": 150, "user_id": 7420464, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c1b1893b73a50174583069fdd7493d2?s=128&d=identicon&r=PG&f=1", "display_name": "fallengyro", "link": "https://stackoverflow.com/users/7420464/fallengyro"}, "reply_to_user": {"reputation": 7854, "user_id": 5461205, "user_type": "registered", "profile_image": "https://graph.facebook.com/1112471818782668/picture?type=large", "display_name": "Dirk Reichel", "link": "https://stackoverflow.com/users/5461205/dirk-reichel"}, "edited": false, "score": 0, "creation_date": 1489684563, "post_id": 42800562, "comment_id": 72790515, "body": "@DirkReichel Thanks for these thoughts. I believe you are right that Solver is taking actions that cannot be prevented. Of course! This makes sense given it has its own libraries external of the excel application. As for an expression to compute the numbers instead of optimizing, that just won&#39;t be possible. The equations I have are transcendental so no clean inverse exists. I&#39;ll probably just write my own optimization code and call that, maybe overkill but at least I get control that way. Thanks for all of your input (and neat formatting trick, very cool!). Cheers."}, {"owner": {"reputation": 7854, "user_id": 5461205, "user_type": "registered", "profile_image": "https://graph.facebook.com/1112471818782668/picture?type=large", "display_name": "Dirk Reichel", "link": "https://stackoverflow.com/users/5461205/dirk-reichel"}, "edited": false, "score": 0, "creation_date": 1489684954, "post_id": 42800562, "comment_id": 72790748, "body": "You are welcome ;)"}], "owner": {"reputation": 150, "user_id": 7420464, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c1b1893b73a50174583069fdd7493d2?s=128&d=identicon&r=PG&f=1", "display_name": "fallengyro", "link": "https://stackoverflow.com/users/7420464/fallengyro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 803, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1489548338, "creation_date": 1489548338, "question_id": 42800562, "link": "https://stackoverflow.com/questions/42800562/run-solver-not-on-active-sheet-vba", "title": "Run Solver NOT on active sheet (VBA)", "body": "<p>I have a workbook that I am using to solve a system of non-linear equations, and then display the solution on a chart. The chart has a large amount of content (basically the result of solving the system of equations for a few standard cases), which references a table of about 1200 cells. That content is static, and so for aesthetics I keep the calculations table on sheet1 and graph on sheet2.  </p>\n\n<p>Then on the graph sheet I allow user input to two cells which are referenced in the calculations on sheet1 to build three dynamic instances of the system of equations. Pretty lightweight for solver to handle one at a time.</p>\n\n<p>I use a Worksheet_Change event on sheet2 to watch for the user to modify those two cells and then it calls a sub that runs the solver.</p>\n\n<p>The event code:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Excel.Range)\n    If (Target.Address = \"$C$3\") Or (Target.Address = \"$D$3\") Then\n\n        Application.ScreenUpdating = False\n        Application.EnableEvents = False\n\n        SolverEQN 178, 180\n\n        Application.ScreenUpdating = True\n        Application.EnableEvents = True\n    End If\nEnd Sub\n</code></pre>\n\n<p>The Solver code:</p>\n\n<pre><code>Sub SolverEQN(rw, rwend As Integer)\n    Dim iter As Integer\n\n    For iter = rw To rwend\n\n        If Sheets(1).Cells(iter, 14) &lt;&gt; 0 Then\n            SolverReset\n            SolverOptions AssumeNonNeg:=False\n            SolverOK SetCell:=\"'Sheet1'!$N$\" &amp; iter, MaxMinVal:=\"3\", ValueOf:=\"0\", ByChange:=\"'Sheet1'!$H$\" &amp; iter\n            SolverSolve True\n        End If\n\n    Next iter\n\nEnd Sub\n</code></pre>\n\n<p>Here is where the problem is encountered. Solver runs on sheet2, despite my assigning it to run on sheet1, meaning the system of equations don't exist where they should and solver quickly optimizes to 0 = 0 in the middle of my active sheet.</p>\n\n<p>There are two workarounds that I've found:</p>\n\n<p>1 - Set my activesheet to be sheet1 before running solver and then set activesheet back to sheet2 after solver runs. This causes a short pause and screen flicker, so the experience would not be 'seamless' for a user.</p>\n\n<p>2 - Solve the dynamic system of equations on the graph sheet and hide them in a crude way (white font, stuff them behind my graph, YUCK!).</p>\n\n<p>I will handle this with option 2 if I have to, but do you creative folks have any ideas on how to keep the calculations on my calculations sheet?</p>\n\n<p>Input much appreciated.</p>\n\n<p>Cheers.</p>\n"}, {"tags": ["macos", "excel", "applescript", "vba"], "owner": {"reputation": 21, "user_id": 7712280, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-8ETGtVIQj1I/AAAAAAAAAAI/AAAAAAAAAok/nfzkDBdRoIM/photo.jpg?sz=128", "display_name": "Bret Kramer", "link": "https://stackoverflow.com/users/7712280/bret-kramer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 314, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1489562063, "creation_date": 1489546041, "last_edit_date": 1531164843, "question_id": 42800228, "link": "https://stackoverflow.com/questions/42800228/applescripttask-is-not-returning-result-to-vba", "title": "AppleScriptTask is not returning Result to VBA", "body": "<p>I am seeing very intermittent return results when I have a Mac Excel VBA Macro calling an Apple script using AppleScriptTask.</p>\n\n<p>I say intermittent because I can run the same code the same way and sometimes I get the result I expect and other times I get a blank string.</p>\n\n<p>When I call the <code>GetPathInput</code> Function below with the following line I get the intermittent behavior I described:</p>\n\n<pre><code>customerDataDir = GetPathInput(\"Please select the directory you would like to use for Customer Data Output:\" &amp; userHomeDir &amp; \"Documents/Data/Customers/\")\n</code></pre>\n\n<p>VBA Macro:</p>\n\n<pre><code>Function GetPathInput(ParameterStr As String) As String\nDim answer As Integer\nanswer = vbNo\nDo Until answer = vbYes\n    GetPathInput = AppleScriptTask(\"GetUserInput.scpt\", \"GetPathInput\", ParameterStr)\n    answer = MsgBox(\"Path: \" &amp; GetPathInput, vbYesNo, \"Is this what you selected?\")\nLoop\nEnd Function\n</code></pre>\n\n<p>AppleScript GetUserInput.scpt:</p>\n\n<pre><code>on GetPathInput(ParameterStr)\n-- Takes 2 Parameters (Prompt for the Dialog, Default Path) \nset myParm to my splitParameters(ParameterStr, \":\")\nset PromptStr to item 1 of myParm\nset DefaultPathStr to item 2 of myParm\nreturn POSIX path of (choose folder with prompt PromptStr default location DefaultPathStr) as string\n--  set DefaultPathStr to POSIX path of (path to home folder as string)\n--  display dialog PathNameStr default answer DefaultPathStr\n--  return text returned of result\nend GetPathInput\n</code></pre>\n\n<p>AppleScript splitParameters:</p>\n\n<pre><code>on splitParameters(theString, theDelimiter)\n-- save delimiters to restore old settings\nset oldDelimiters to AppleScript's text item delimiters\n-- set delimiters to delimiter to be used\nset AppleScript's text item delimiters to theDelimiter\n-- create the array\nset theArray to every text item of theString\n-- restore the old setting\nset AppleScript's text item delimiters to oldDelimiters\n-- return the result\nreturn theArray\nend splitParameters\n</code></pre>\n"}, {"tags": ["vba", "excel", "excel-formula", "vlookup"], "comments": [{"owner": {"reputation": 7854, "user_id": 5461205, "user_type": "registered", "profile_image": "https://graph.facebook.com/1112471818782668/picture?type=large", "display_name": "Dirk Reichel", "link": "https://stackoverflow.com/users/5461205/dirk-reichel"}, "edited": false, "score": 0, "creation_date": 1489544252, "post_id": 42799757, "comment_id": 72714165, "body": "Sorry, but it is unclear what you want. If you want to access any file, you will need the full path and the filename. But you are free to save the path in one variable and the filename in another. Later on just use <code>mypath &amp; myfile</code>. But this also depends on what you are going to do in detail."}, {"owner": {"reputation": 81, "user_id": 7459928, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d1372163d1eb37d459b69a8744320c10?s=128&d=identicon&r=PG&f=1", "display_name": "Zounds", "link": "https://stackoverflow.com/users/7459928/zounds"}, "reply_to_user": {"reputation": 7854, "user_id": 5461205, "user_type": "registered", "profile_image": "https://graph.facebook.com/1112471818782668/picture?type=large", "display_name": "Dirk Reichel", "link": "https://stackoverflow.com/users/5461205/dirk-reichel"}, "edited": false, "score": 0, "creation_date": 1489552654, "post_id": 42799757, "comment_id": 72716119, "body": "I was from my mobile sorry for not providing more details."}], "answers": [{"comments": [{"owner": {"reputation": 81, "user_id": 7459928, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d1372163d1eb37d459b69a8744320c10?s=128&d=identicon&r=PG&f=1", "display_name": "Zounds", "link": "https://stackoverflow.com/users/7459928/zounds"}, "edited": false, "score": 1, "creation_date": 1489618353, "post_id": 42800024, "comment_id": 72756027, "body": "Thank you for your answer, you  make my life simplier :)"}, {"owner": {"reputation": 748, "user_id": 7130016, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/fa54f3f9332091638b37c3fb84db39d3?s=128&d=identicon&r=PG&f=1", "display_name": "Mertinc", "link": "https://stackoverflow.com/users/7130016/mertinc"}, "edited": false, "score": 1, "creation_date": 1495689111, "post_id": 42800024, "comment_id": 75360760, "body": "small contribution: And if you would like to get the path of your desktop you can simply call it with this code: <code>Dim yourdesktopaddress As String</code>        <code>yourdesktopaddress = CreateObject(&quot;WScript.Shell&quot;).specialfolders(&quot;Desktop&quot;)</code>  and even if you would like to get another folders&#39; path on desktop you can simply add:   <code>&amp; &quot;\\SpecificFolderOnTheDesktop&quot;</code> after that code"}, {"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "reply_to_user": {"reputation": 748, "user_id": 7130016, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/fa54f3f9332091638b37c3fb84db39d3?s=128&d=identicon&r=PG&f=1", "display_name": "Mertinc", "link": "https://stackoverflow.com/users/7130016/mertinc"}, "edited": false, "score": 1, "creation_date": 1495689460, "post_id": 42800024, "comment_id": 75360871, "body": "@Mertinc post as second answer"}], "tags": [], "owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "is_accepted": true, "score": 4, "last_activity_date": 1489544636, "creation_date": 1489544636, "answer_id": 42800024, "question_id": 42799757, "link": "https://stackoverflow.com/questions/42799757/vba-excel-do-vlookup-from-a-closed-file/42800024#42800024", "title": "Vba Excel do vlookup from a closed file", "body": "<p>You will need the full path.</p>\n\n<p>Example</p>\n\n<pre><code>Option Explicit\nPublic Sub Example()\n    Dim Path As String\n\n    Path = \"C:\\Temp\\\"\n\n    With ThisWorkbook.Sheets(\"Sheet1\")\n        .Range(\"B1\").Formula = \"=VLOOKUP(A1,'\" &amp; Path &amp; \"[Book1.xlsx]Sheet2'!A:J,3,FALSE)\"\n    End With\nEnd Sub\n</code></pre>\n\n<p><em><a href=\"https://support.office.com/en-us/article/VLOOKUP-function-0BBC8083-26FE-4963-8AB8-93A18AD188A1?ui=en-US&amp;rs=en-US&amp;ad=US&amp;fromAR=1\" rel=\"nofollow noreferrer\">VLOOKUP function</a></em></p>\n"}, {"tags": [], "owner": {"reputation": 748, "user_id": 7130016, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/fa54f3f9332091638b37c3fb84db39d3?s=128&d=identicon&r=PG&f=1", "display_name": "Mertinc", "link": "https://stackoverflow.com/users/7130016/mertinc"}, "is_accepted": false, "score": 2, "last_activity_date": 1495689973, "creation_date": 1495689973, "answer_id": 44172883, "question_id": 42799757, "link": "https://stackoverflow.com/questions/42799757/vba-excel-do-vlookup-from-a-closed-file/44172883#44172883", "title": "Vba Excel do vlookup from a closed file", "body": "<p>As long as @0m3r's solution answers the question here is a small contribution to anyone who is looking to reference a closed file located in <strong>Desktop.</strong> </p>\n\n<blockquote>\n  <p>Even not specific for one user, works on any other user as well.</p>\n</blockquote>\n\n<pre><code>Option Explicit\nPublic Sub Example()\n    Dim yourdesktopaddress As String \n\n    yourdesktopaddress = CreateObject(\"WScript.Shell\").specialfolders(\"Desktop\")\n\n'or if you would like to reference another folder located in Desktop (i.e: SpecificFolderOnTheDesktop)\n    'Dim folderinthedesktopaddress as String\n    'folderinthedesktopaddress = CreateObject(\"WScript.Shell\").specialfolders(\"Desktop\") &amp; \"\\SpecificFolderOnTheDesktop\"\n\n    With ThisWorkbook.Sheets(\"Sheet1\")\n        .Range(\"B1\").Formula = \"=VLOOKUP(A1,'\" &amp; yourdesktopaddress &amp; \"[Book1.xlsx]Sheet2'!A:J,3,FALSE)\"\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 81, "user_id": 7459928, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d1372163d1eb37d459b69a8744320c10?s=128&d=identicon&r=PG&f=1", "display_name": "Zounds", "link": "https://stackoverflow.com/users/7459928/zounds"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4185, "favorite_count": 0, "accepted_answer_id": 42800024, "answer_count": 2, "score": 4, "last_activity_date": 1495689973, "creation_date": 1489542500, "last_edit_date": 1491634774, "question_id": 42799757, "link": "https://stackoverflow.com/questions/42799757/vba-excel-do-vlookup-from-a-closed-file", "title": "Vba Excel do vlookup from a closed file", "body": "<p>I would like to do a vlookup from a close file to an active open file, The path of the closed file will be given as a variant </p>\n\n<p>Lets say       <code>mypath = \"C:\\list\\....\"</code></p>\n\n<p>I don't know if it is better to set the path only or the full-path (path+filename)</p>\n\n<p>Could u please help ?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 14064, "user_id": 765395, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Xc817.png?s=128&g=1", "display_name": "Robin Mackenzie", "link": "https://stackoverflow.com/users/765395/robin-mackenzie"}, "edited": false, "score": 0, "creation_date": 1489543932, "post_id": 42799504, "comment_id": 72714075, "body": "<code>y</code> is 0 at the end because you never set <code>y</code> to anything - so it just gives default value of <code>0</code>."}, {"owner": {"reputation": 99, "user_id": 7687628, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh6.googleusercontent.com/-ggCvuVg75x0/AAAAAAAAAAI/AAAAAAAAAPk/zppDyWaaa8Q/photo.jpg?sz=128", "display_name": "Moe Nay", "link": "https://stackoverflow.com/users/7687628/moe-nay"}, "reply_to_user": {"reputation": 14064, "user_id": 765395, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Xc817.png?s=128&g=1", "display_name": "Robin Mackenzie", "link": "https://stackoverflow.com/users/765395/robin-mackenzie"}, "edited": false, "score": 0, "creation_date": 1489547023, "post_id": 42799504, "comment_id": 72714834, "body": "&quot;Then Fun = Tmp And i = y&quot; i tried y = i as well but it still gives me 0. is that not setting it?"}], "answers": [{"tags": [], "owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "is_accepted": true, "score": 1, "last_activity_date": 1489547545, "creation_date": 1489547545, "answer_id": 42800464, "question_id": 42799504, "link": "https://stackoverflow.com/questions/42799504/finding-minimum-value-using-count-and-then-finding-out-what-that-count-is/42800464#42800464", "title": "Finding minimum value using count and then finding out what that count is", "body": "<p>Let's split your <code>If</code> statement up and see what it actually <strong><em>does</em></strong>:</p>\n\n<p>Pull the conditional expression into its block:</p>\n\n<pre><code>If Tmp &lt;&gt; 0 And Tmp &lt;&gt; \"\" And Tmp &lt; Fun Then \n    Fun = Tmp And i = y\nEnd If\n</code></pre>\n\n<p>Add the implicit parentheses to the right of the assignment:</p>\n\n<pre><code>If Tmp &lt;&gt; 0 And Tmp &lt;&gt; \"\" And Tmp &lt; Fun Then \n    Fun = (Tmp And i = y)\nEnd If\n</code></pre>\n\n<p>Add the implicit parentheses to the right of the <code>And</code>:</p>\n\n<pre><code>If Tmp &lt;&gt; 0 And Tmp &lt;&gt; \"\" And Tmp &lt; Fun Then \n    Fun = (Tmp And (i = y))\nEnd If\n</code></pre>\n\n<p>Now look at the expression <code>i = y</code> - since it's on the <em>right-hand side</em>, this evaluates as a <code>Boolean</code>, so it's either <code>0</code> or <code>-1</code> when cast to a number.  Let's assume that it's <code>0</code> and put it back into the expression:  <code>Temp And 0</code>.  This is performing a <em>binary And operation</em>.  You then assign the result to <code>Temp</code>.  That's the only thing that gets set.</p>\n\n<p>I'm <em>guessing</em> your intention was this...</p>\n\n<pre><code>If Tmp &lt;&gt; 0 And Tmp &lt;&gt; \"\" And Tmp &lt; Fun Then \n    Fun = Tmp \n    i = y\nEnd If\n</code></pre>\n\n<p>...although assigning to your loop counter is a bad idea.</p>\n"}], "owner": {"reputation": 99, "user_id": 7687628, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh6.googleusercontent.com/-ggCvuVg75x0/AAAAAAAAAAI/AAAAAAAAAPk/zppDyWaaa8Q/photo.jpg?sz=128", "display_name": "Moe Nay", "link": "https://stackoverflow.com/users/7687628/moe-nay"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 35, "favorite_count": 0, "accepted_answer_id": 42800464, "answer_count": 1, "score": 1, "last_activity_date": 1489547545, "creation_date": 1489540618, "last_edit_date": 1531164843, "question_id": 42799504, "link": "https://stackoverflow.com/questions/42799504/finding-minimum-value-using-count-and-then-finding-out-what-that-count-is", "title": "Finding minimum value using count and then finding out what that count is", "body": "<p>I am trying to get the minimum value out of my Inv variables.. This works however I thought i might be able to add i=y  to the end of the If Tmp... statement so once it applies to Tmp &lt; Fun it can set the i count to y and then i can go around later and use (Inv(y)) object later.. not sure if this will work it just makes sense in my head right now. Summarizing my question... why is msgbox y in the end giving me a value of 0 even though i is not. Any feedback would be great, thank you very much in advance</p>\n\n<pre><code>Dim Fun As Variant\nDim Tmp As Variant\nDim Inv() As String\nDim i As Integer\nDim y As Integer\n\nInv = Split(\"NBInv NEBInv EBInv SEBInv SBInv SWBInv WBInv NWBInv\")\nFun = 1000\n\nFor i = 0 To UBound(Inv)\n    Tmp = Val(ActiveSheet.OLEObjects(Inv(i)).Object.Value)\n    If Tmp &lt;&gt; 0 And Tmp &lt;&gt; \"\" And Tmp &lt; Fun Then Fun = Tmp And i = y\nNext i\n\nSmallest = Fun\nMsgBox y\n</code></pre>\n"}]