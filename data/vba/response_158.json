[{"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 19, "user_id": 6575496, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/08fcbc9c2accd3dc97403ac071ced0ed?s=128&d=identicon&r=PG&f=1", "display_name": "cdc949494", "link": "https://stackoverflow.com/users/6575496/cdc949494"}, "edited": false, "score": 0, "creation_date": 1516232522, "post_id": 48311699, "comment_id": 83609347, "body": "Hi, thanks for the quick response. I haven&#39;t used the frequency formula before and am having trouble applying it to my situation. Should the data_array and the bins_array be the same range? For some reason the value is returning 0"}, {"owner": {"reputation": 19, "user_id": 6575496, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/08fcbc9c2accd3dc97403ac071ced0ed?s=128&d=identicon&r=PG&f=1", "display_name": "cdc949494", "link": "https://stackoverflow.com/users/6575496/cdc949494"}, "edited": false, "score": 0, "creation_date": 1516232693, "post_id": 48311699, "comment_id": 83609392, "body": "Nevermind, the match function works since the customer ID field has text. Thanks!"}], "tags": [], "owner": {"reputation": 1946, "user_id": 8828524, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Z001KmBq-2Y/AAAAAAAAAAI/AAAAAAAAIlU/paK7lD3iHuw/photo.jpg?sz=128", "display_name": "virtualdvid", "link": "https://stackoverflow.com/users/8828524/virtualdvid"}, "is_accepted": true, "score": 0, "last_activity_date": 1516237747, "last_edit_date": 1516237747, "creation_date": 1516231971, "answer_id": 48311699, "question_id": 48311537, "link": "https://stackoverflow.com/questions/48311537/summing-a-range-of-cells-and-perform-a-countif-on-that-range-in-one-formula/48311699#48311699", "title": "Summing a range of cells and perform a countif on that range in one formula", "body": "<p>This formula counts the number of unique values in a range if IDs contains only numbers:</p>\n\n<pre><code>=SUM(IF(FREQUENCY($@$#:@#,$@$#:@#)&gt;0,1))\n</code></pre>\n\n<p>or use this one if you want to count the number of unique text or a mix between numbers and text:</p>\n\n<pre><code>=SUM(IF(FREQUENCY(MATCH($@$#:@#,$@$#:@#,0),MATCH($@$#:@#,$@$#:@#,0))&gt;0,1))\n</code></pre>\n"}], "owner": {"reputation": 19, "user_id": 6575496, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/08fcbc9c2accd3dc97403ac071ced0ed?s=128&d=identicon&r=PG&f=1", "display_name": "cdc949494", "link": "https://stackoverflow.com/users/6575496/cdc949494"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 23, "favorite_count": 0, "accepted_answer_id": 48311699, "answer_count": 1, "score": 0, "last_activity_date": 1516244364, "creation_date": 1516231006, "last_edit_date": 1516244364, "question_id": 48311537, "link": "https://stackoverflow.com/questions/48311537/summing-a-range-of-cells-and-perform-a-countif-on-that-range-in-one-formula", "title": "Summing a range of cells and perform a countif on that range in one formula", "body": "<p>I have a huge data dump that has lots of duplicates. Lets say that its a list of customer IDs. I have a <code>=IF(COUNTIF($@$#:@#,@#)&gt;1,0,1)</code> to only count the new customer ID if its not duplicated above. </p>\n\n<p>Lets say I didn't want to have one column for the 1s and 0s for customer IDs but instead wanted one formula that would sum all distinct IDs or in other words sum all the 1s in the above formula. Is this possible in excel?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 2, "creation_date": 1516250528, "post_id": 48311532, "comment_id": 83613614, "body": "VBA is not VB.NET"}], "answers": [{"tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 0, "last_activity_date": 1516382821, "creation_date": 1516382821, "answer_id": 48346466, "question_id": 48311532, "link": "https://stackoverflow.com/questions/48311532/using-substring-and-indexof-methods-in-vba/48346466#48346466", "title": "Using Substring and IndexOf methods in VBA", "body": "<p>If you are concerning VBA, and not VB.Net, then you need <code>Split()</code> to refer the splitted array and <code>OLEObjects()</code> to refer to the OLEObjects.</p>\n\n<p>This compiles and returns what you probably need:</p>\n\n<pre><code>Option Explicit\nSub TestMe()\n\n    Dim Op1 As String\n    Dim Op2 As String\n    Dim operatore As String\n\n    operatore = ActiveSheet.OLEObjects(\"ComboBox1\").Object\n    Op1 = Split(operatore, \"&lt;\")(0)\n    Op2 = Split(operatore, \"&gt;\")(1)\n\nEnd Sub\n</code></pre>\n\n<p>In VBA <code>IndexOf</code> does not exist. It is only in VB.NET - <a href=\"https://msdn.microsoft.com/en-us/library/k8b1470s(v=vs.110).aspx\" rel=\"nofollow noreferrer\">MSDN IndexOf</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 116, "user_id": 8140473, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b1a1268dce8138b190a41e507bda381?s=128&d=identicon&r=PG&f=1", "display_name": "Rohim Chou", "link": "https://stackoverflow.com/users/8140473/rohim-chou"}, "is_accepted": false, "score": 0, "last_activity_date": 1599476911, "last_edit_date": 1599476911, "creation_date": 1592446776, "answer_id": 62441291, "question_id": 48311532, "link": "https://stackoverflow.com/questions/48311532/using-substring-and-indexof-methods-in-vba/62441291#62441291", "title": "Using Substring and IndexOf methods in VBA", "body": "<p>Hope this might save someone some time in the future:</p>\n<pre class=\"lang-vb prettyprint-override\"><code>    ' indexof\n    Dim positionInPath As Integer\n    positionInPath = InStr(&quot;C:\\Users\\2200522\\Documents\\&quot;, &quot;2200522&quot;) ' returns 10\n    ' C:\\Users\\2200522\\Documents\\\n    ' ^^^      ^      \n    ' 123      10     \n    \n    ' substring \n    Dim newPath As String\n    newPath = Left(&quot;C:\\Users\\2200522\\Documents\\&quot;, 10) ' returns &quot;C:\\Users\\2&quot;\n</code></pre>\n"}], "owner": {"reputation": 43, "user_id": 4105539, "user_type": "registered", "accept_rate": 25, "profile_image": "https://graph.facebook.com/1452400427/picture?type=large", "display_name": "Samuel Leanza", "link": "https://stackoverflow.com/users/4105539/samuel-leanza"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2792, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1599476911, "creation_date": 1516230970, "last_edit_date": 1593707224, "question_id": 48311532, "link": "https://stackoverflow.com/questions/48311532/using-substring-and-indexof-methods-in-vba", "title": "Using Substring and IndexOf methods in VBA", "body": "<p>I have the following code:</p>\n\n<pre><code>Dim Op1 As String\nDim Op2 As String\nDim operatore As String\noperatore = ComboBox1.Value\nOp1 = operatore.Substring(0, operatore.IndexOf(\"&lt;\")).Trim()\nOp2 = operatore.Split(\"&gt;\")(1)\n</code></pre>\n\n<p>When I compile, I get the error: \"Qualifier not valid\" refered to variable \"operatore\". How can I fix it?</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "is_accepted": false, "score": 0, "last_activity_date": 1516230979, "creation_date": 1516230979, "answer_id": 48311534, "question_id": 48311403, "link": "https://stackoverflow.com/questions/48311403/sum-filtered-column-within-a-table/48311534#48311534", "title": "Sum Filtered Column Within a Table", "body": "<p>The below code will test if there are zero rows. In order to be able to use the <code>SpecialCells(xlCellTypeVisible)</code> method without fail, I include the headers rows which will always be there, thus if the visible cell row count is > 1 you can be assured there is at least one value of 100.</p>\n\n<pre><code>With TableX\n\n    .Range.AutoFilter Field:=15, Criteria1:=\"100\"\n\n    If Intersect(.Range, .ListColumns(15).Range).SpecialCells(xlCellTypeVisible).Rows.Count &gt; 1 Then\n        'do stuff\n    End If\n\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 9217914, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2SwPo.jpg?s=128&g=1", "display_name": "Jason_H", "link": "https://stackoverflow.com/users/9217914/jason-h"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 292, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1516230979, "creation_date": 1516230259, "last_edit_date": 1531164843, "question_id": 48311403, "link": "https://stackoverflow.com/questions/48311403/sum-filtered-column-within-a-table", "title": "Sum Filtered Column Within a Table", "body": "<p>Within Excel Vba, I'm conducting a filter on table column referencing a ListObject;</p>\n\n<pre><code>With TableX\n.Range.AutoFilter Field:=15, Criteria1:=\"100\"\nEnd With\n</code></pre>\n\n<p>I want to test the filtered column before executing further code, as it is possible the filter may return no rows matching the value of 100.\nI've found some information about TotalsCalculation method but struggling to code it. Any thoughts on what I'm missing in this simple example??</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2265, "user_id": 5958842, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d6891cdbf84d1fab53a0d73b05ee467?s=128&d=identicon&r=PG", "display_name": "DecimalTurn", "link": "https://stackoverflow.com/users/5958842/decimalturn"}, "edited": false, "score": 0, "creation_date": 1516233467, "post_id": 48311307, "comment_id": 83609595, "body": "You might want to have a look at this: <a href=\"https://stackoverflow.com/questions/22083668/wait-until-activeworkbook-refreshall-finishes-vba\" title=\"wait until activeworkbook refreshall finishes vba\">stackoverflow.com/questions/22083668/&hellip;</a>"}, {"owner": {"reputation": 15, "user_id": 6343949, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/b42b4daee750816750ba1b4582a92772?s=128&d=identicon&r=PG&f=1", "display_name": "ERZUT", "link": "https://stackoverflow.com/users/6343949/erzut"}, "reply_to_user": {"reputation": 2265, "user_id": 5958842, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d6891cdbf84d1fab53a0d73b05ee467?s=128&d=identicon&r=PG", "display_name": "DecimalTurn", "link": "https://stackoverflow.com/users/5958842/decimalturn"}, "edited": false, "score": 0, "creation_date": 1516237373, "post_id": 48311307, "comment_id": 83610501, "body": "Thank you @DecimalTurn - That was really helpful!  I added:  Activeworkbook.RefreshAll DoEvents    and disabled background refresh in my connections."}, {"owner": {"reputation": 2265, "user_id": 5958842, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d6891cdbf84d1fab53a0d73b05ee467?s=128&d=identicon&r=PG", "display_name": "DecimalTurn", "link": "https://stackoverflow.com/users/5958842/decimalturn"}, "edited": false, "score": 0, "creation_date": 1516249278, "post_id": 48311307, "comment_id": 83613284, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/22083668/wait-until-activeworkbook-refreshall-finishes-vba\">Wait until ActiveWorkbook.RefreshAll finishes - VBA</a>"}, {"owner": {"reputation": 15, "user_id": 6343949, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/b42b4daee750816750ba1b4582a92772?s=128&d=identicon&r=PG&f=1", "display_name": "ERZUT", "link": "https://stackoverflow.com/users/6343949/erzut"}, "reply_to_user": {"reputation": 2265, "user_id": 5958842, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d6891cdbf84d1fab53a0d73b05ee467?s=128&d=identicon&r=PG", "display_name": "DecimalTurn", "link": "https://stackoverflow.com/users/5958842/decimalturn"}, "edited": false, "score": 0, "creation_date": 1516597336, "post_id": 48311307, "comment_id": 83736902, "body": "@DecimalTurn Yes it seems that the workbook refreshes before it goes to the next sheet instead of after the entire loop. I checked out the link you posted but still can&#39;t figure out how to do this. If you could provide any further insight, it would be much appreciated! Thanks"}, {"owner": {"reputation": 2265, "user_id": 5958842, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d6891cdbf84d1fab53a0d73b05ee467?s=128&d=identicon&r=PG", "display_name": "DecimalTurn", "link": "https://stackoverflow.com/users/5958842/decimalturn"}, "edited": false, "score": 0, "creation_date": 1516634424, "post_id": 48311307, "comment_id": 83756788, "body": "If I understand your question correctly, to do it at the end of one loop, you would have to put <code>ActiveWorkbook.RefreshAll</code> and <code>DoEvents</code> right before <code>Next j</code>"}, {"owner": {"reputation": 15, "user_id": 6343949, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/b42b4daee750816750ba1b4582a92772?s=128&d=identicon&r=PG&f=1", "display_name": "ERZUT", "link": "https://stackoverflow.com/users/6343949/erzut"}, "reply_to_user": {"reputation": 2265, "user_id": 5958842, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d6891cdbf84d1fab53a0d73b05ee467?s=128&d=identicon&r=PG", "display_name": "DecimalTurn", "link": "https://stackoverflow.com/users/5958842/decimalturn"}, "edited": false, "score": 0, "creation_date": 1517266929, "post_id": 48311307, "comment_id": 84017674, "body": "@DecimalTurn - Apologies for the delayed response! I have just tried that but the refresh doesn&#39;t work at all. It just loops through all the sheets. Thanks again for the help :)"}, {"owner": {"reputation": 2265, "user_id": 5958842, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d6891cdbf84d1fab53a0d73b05ee467?s=128&d=identicon&r=PG", "display_name": "DecimalTurn", "link": "https://stackoverflow.com/users/5958842/decimalturn"}, "edited": false, "score": 0, "creation_date": 1517267391, "post_id": 48311307, "comment_id": 84017816, "body": "I&#39;m a bit confused about what you are really trying to do. Are you actually trying to refresh the sheet and let the user look at the refreshed sheet for 20 sec?"}, {"owner": {"reputation": 15, "user_id": 6343949, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/b42b4daee750816750ba1b4582a92772?s=128&d=identicon&r=PG&f=1", "display_name": "ERZUT", "link": "https://stackoverflow.com/users/6343949/erzut"}, "reply_to_user": {"reputation": 2265, "user_id": 5958842, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d6891cdbf84d1fab53a0d73b05ee467?s=128&d=identicon&r=PG", "display_name": "DecimalTurn", "link": "https://stackoverflow.com/users/5958842/decimalturn"}, "edited": false, "score": 0, "creation_date": 1517280049, "post_id": 48311307, "comment_id": 84020905, "body": "The workbook will be displayed on a screen in our office. There are 4 x sheets (with various reports) that we would like displayed for 20 seconds at a time (in a loop). We have several external data sources that require frequent refreshing. I hope this help explain - thanks again for your help on this"}, {"owner": {"reputation": 15, "user_id": 6343949, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/b42b4daee750816750ba1b4582a92772?s=128&d=identicon&r=PG&f=1", "display_name": "ERZUT", "link": "https://stackoverflow.com/users/6343949/erzut"}, "reply_to_user": {"reputation": 2265, "user_id": 5958842, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d6891cdbf84d1fab53a0d73b05ee467?s=128&d=identicon&r=PG", "display_name": "DecimalTurn", "link": "https://stackoverflow.com/users/5958842/decimalturn"}, "edited": false, "score": 0, "creation_date": 1517543495, "post_id": 48311307, "comment_id": 84147460, "body": "@DecimalTurn - apologies, I forgot to tag you in the above comment. Any insight would be highly appreciated!"}, {"owner": {"reputation": 2265, "user_id": 5958842, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d6891cdbf84d1fab53a0d73b05ee467?s=128&d=identicon&r=PG", "display_name": "DecimalTurn", "link": "https://stackoverflow.com/users/5958842/decimalturn"}, "edited": false, "score": 0, "creation_date": 1517545232, "post_id": 48311307, "comment_id": 84147831, "body": "I think I misunderstood what you meant by &quot;after the entire loop&quot;. If you want to show all 4 sheets (20 sec each) and then refresh, you would need to put it inside the if statement right after<code>j = -1</code>"}], "answers": [{"tags": [], "owner": {"reputation": 15, "user_id": 6343949, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/b42b4daee750816750ba1b4582a92772?s=128&d=identicon&r=PG&f=1", "display_name": "ERZUT", "link": "https://stackoverflow.com/users/6343949/erzut"}, "is_accepted": false, "score": 0, "last_activity_date": 1516237720, "creation_date": 1516237720, "answer_id": 48312401, "question_id": 48311307, "link": "https://stackoverflow.com/questions/48311307/displaying-each-worksheet-for-20-seconds-and-refresh-all/48312401#48312401", "title": "Displaying each worksheet for 20 seconds and Refresh All", "body": "<p>Thanks to DecimalTurn's assistance, the following code worked after disabling background refresh:</p>\n\n<pre><code>Sub Test2()\n\n Dim i As Long, j As Long, t As Single, str As String\n Dim MyArray As Variant\n MyArray = Array(\"Sheet1\", \"Sheet2\", \"Sheet4\", \"Sheet6\")\n For j = LBound(MyArray) To UBound(MyArray)\n    On Error GoTo exit_\n    ActiveWorkbook.RefreshAll\n    DoEvents\n    Application.EnableCancelKey = xlErrorHandler\n    str = MyArray(j)\n    Sheets(str).Select\n    t = Timer + 1\n    Application.Wait Now + TimeSerial(0, 0, 20)\n    If Timer &lt; t Then Exit Sub\n    If j = UBound(MyArray) Then\n        j = -1\n    Else\n        j = j\n    End If\nNext j\nexit_:\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 6343949, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/b42b4daee750816750ba1b4582a92772?s=128&d=identicon&r=PG&f=1", "display_name": "ERZUT", "link": "https://stackoverflow.com/users/6343949/erzut"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 67, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1516244051, "creation_date": 1516229613, "last_edit_date": 1516244051, "question_id": 48311307, "link": "https://stackoverflow.com/questions/48311307/displaying-each-worksheet-for-20-seconds-and-refresh-all", "title": "Displaying each worksheet for 20 seconds and Refresh All", "body": "<p>I have the below code which works well to display each defined worksheet for 20 seconds, in a loop. I would like to be able to refresh the workbook after each loop or at a defined interval. Inserting ActiveWorkbook.RefreshAll in the code doesn't seem to work. </p>\n\n<p>Any help would be hugely appreciated!</p>\n\n<p>Many thanks in advance</p>\n\n<pre><code>Sub Test2()\n\n    Dim i As Long, j As Long, t As Single, str As String\n    Dim MyArray As Variant\n    MyArray = Array(\"Sheet1\", \"Sheet2\", \"Sheet4\", \"Sheet6\")\n    For j = LBound(MyArray) To UBound(MyArray)\n        On Error GoTo exit_\n        Application.EnableCancelKey = xlErrorHandler\n        str = MyArray(j)\n        Sheets(str).Select\n        t = Timer + 1\n        Application.Wait Now + TimeSerial(0, 0, 20)\n        If Timer &lt; t Then Exit Sub\n        If j = UBound(MyArray) Then\n            j = -1\n        Else\n            j = j\n        End If\n    Next j\nexit_:\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "charts"], "comments": [{"owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "edited": false, "score": 1, "creation_date": 1516227475, "post_id": 48310772, "comment_id": 83607617, "body": "Actually... You can post pics. Just click the picture button."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "edited": false, "score": 0, "creation_date": 1516230384, "post_id": 48310772, "comment_id": 83608738, "body": "@K.Davis sorry for the confusion, you&#39;re right. I was mistaken."}, {"owner": {"reputation": 1, "user_id": 2391065, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f37ea12f206e627447c56d7f9d88a7cb?s=128&d=identicon&r=PG", "display_name": "Joel Embry", "link": "https://stackoverflow.com/users/2391065/joel-embry"}, "edited": false, "score": 0, "creation_date": 1516312105, "post_id": 48310772, "comment_id": 83647521, "body": "I tried to add pics but is said I have to have a higher reputation rank or something like that.  I worked around it by just copying via formula the total field into a hidden cell at the end of the data range so it is placed in order on the graph.   I still would like to know why it rearranges the data differently if I assign the data range through the user interface and via VBA code."}], "owner": {"reputation": 1, "user_id": 2391065, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f37ea12f206e627447c56d7f9d88a7cb?s=128&d=identicon&r=PG", "display_name": "Joel Embry", "link": "https://stackoverflow.com/users/2391065/joel-embry"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 97, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1516307681, "creation_date": 1516226652, "last_edit_date": 1516307681, "question_id": 48310772, "link": "https://stackoverflow.com/questions/48310772/selected-data-from-non-contiguous-cells-ordering-different-with-vba", "title": "Selected data from non-contiguous cells ordering different with VBA", "body": "<p>I create a graph manually, select a range of days comprising an entire month, then ctrl+click a single cell containing the month to date sum. </p>\n\n<p>When I create the graph manually, select the days first, then the MTD cell, it displays correctly (see two columns way off to the right). </p>\n\n<p>I copied the way it stored the data source and set that using VBA but now the MTD value keeps moving to the first bar in the chart rather than at the end like the manual chart does. </p>\n\n<p>The data source of the graph that looks correct is </p>\n\n<pre><code>=(Dashboard!$G$110:$AK$110,Dashboard!$F$110)\n</code></pre>\n\n<p>What I put in the VBA code as data source is: </p>\n\n<pre><code>Set rng = ws.Range(\"$G$110:$AK$110,$F$110\")\n</code></pre>\n\n<p>So the <code>F110</code> cell gets moved to the front in VBA.</p>\n\n<p>The labels are selected the same and they work.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1516227041, "post_id": 48310700, "comment_id": 83607394, "body": "So if they select more than one cell, you want to skip message boxes?  You could wrap each one in <code>If target.Count = 1 Then msgbox(...)</code>?"}, {"owner": {"reputation": 25, "user_id": 4370400, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/31d98b277ed4e07f8430b3401c550491?s=128&d=identicon&r=PG&f=1", "display_name": "Cory Gabba", "link": "https://stackoverflow.com/users/4370400/cory-gabba"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1516227285, "post_id": 48310700, "comment_id": 83607527, "body": "That did it! Perfect, thank you so much!"}], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 4370400, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/31d98b277ed4e07f8430b3401c550491?s=128&d=identicon&r=PG&f=1", "display_name": "Cory Gabba", "link": "https://stackoverflow.com/users/4370400/cory-gabba"}, "edited": false, "score": 0, "creation_date": 1516229351, "post_id": 48310958, "comment_id": 83608367, "body": "Could i also shorten the code by saying <code>If Target.Column=14 or Target.Column =15</code> then only having the corresponding code below once?"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 25, "user_id": 4370400, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/31d98b277ed4e07f8430b3401c550491?s=128&d=identicon&r=PG&f=1", "display_name": "Cory Gabba", "link": "https://stackoverflow.com/users/4370400/cory-gabba"}, "edited": false, "score": 0, "creation_date": 1516229451, "post_id": 48310958, "comment_id": 83608417, "body": "@CoryGabba - Ah, yes! Good catch.  I&#39;d keep the two <code>If</code> statements, but you could do <code>If Target.Column = 1 And (Target.Column = 14 or Target.Column = 15) Then ...</code>  I <i>think</i> ...but that&#39;s kind of convoluted, so I&#39;d just keep <code>If Target.Count = 1 Then &#47;&#47; If Target.Column = 14 or Target.Column = 15 Then ...</code>"}], "tags": [], "owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "is_accepted": true, "score": 2, "last_activity_date": 1516227663, "creation_date": 1516227663, "answer_id": 48310958, "question_id": 48310700, "link": "https://stackoverflow.com/questions/48310700/excel-vba-code-executes-when-deleting-copying-pasting-more-than-one-cell-at-a-ti/48310958#48310958", "title": "Excel VBA code executes when deleting/copying/pasting more than one cell at a time", "body": "<p>You can always just check how many <code>Targets</code> were selected, and use that in an <code>If</code> statement:</p>\n\n<pre><code>If target.Count = 1 Then msgbox(\"My Message!\")\n</code></pre>\n\n<p>Since it's a simple one liner <code>If</code> statement, you can do it all in one line instead of, say,</p>\n\n<pre><code>If target.Count = 1 Then\n    msgbox(\"My Message!\")\nEnd If\n</code></pre>\n\n<p>And, looking more over the code, perhaps wrap the whole first part in such a statement, since all you're doing is putting up a message:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\nIf Target.Count = 1 Then ' &lt;-------- Checking how many cells were changed.\n    If Target.Column = 14 Then    'COLUMN N\n        If Not IsNumeric(Target.Value) Then\n            MsgBox \"Please enter LBS ran with only numbers.\", vbExclamation\n            Exit Sub\n        End If\n        If Len(Target.Value) &lt; 4 And Target.Value &lt;&gt; 0 Then\n            MsgBox \"Please enter LBS ran with comma included.\", vbExclamation\n            Exit Sub\n        End If\n    End If\n\n    If Target.Column = 15 Then    'COLUMN O\n        If Not IsNumeric(Target.Value) Then\n            MsgBox \"Please enter LBS ran with only numbers.\", vbExclamation\n            Exit Sub\n        End If\n        If Len(Target.Value) &lt; 4 And Target.Value &lt;&gt; 0 Then\n            MsgBox \"Please enter LBS ran with comma included.\", vbExclamation\n            Exit Sub\n        End If\n    End If\nEnd If 'Target.Count = 1 \n\n'IF COLUMN Q IS MARKED, BUT NOT COMPLETE TEXT TURNS RED\n' &lt;&lt; Rest of your code here &gt;&gt;\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 4370400, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/31d98b277ed4e07f8430b3401c550491?s=128&d=identicon&r=PG&f=1", "display_name": "Cory Gabba", "link": "https://stackoverflow.com/users/4370400/cory-gabba"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 33, "favorite_count": 0, "accepted_answer_id": 48310958, "answer_count": 1, "score": 1, "last_activity_date": 1516227663, "creation_date": 1516226350, "question_id": 48310700, "link": "https://stackoverflow.com/questions/48310700/excel-vba-code-executes-when-deleting-copying-pasting-more-than-one-cell-at-a-ti", "title": "Excel VBA code executes when deleting/copying/pasting more than one cell at a time", "body": "<p>These blocks of code seems to execute when you delete or edit more than one cell in the target columns at a time. In most cases the user is trying to paste allowed values into these cell, just more than one cell at a time. This causes users to have to deal with message boxes that pop up for no reason. Any ideas on how to have the same error checking, but without the message box popping up when you select or alter more than one cell? This code is pasted in a microsoft excel object (sheet code).</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\nIf Target.Column = 14 Then  'COLUMN N\n    If Not IsNumeric(Target.Value) Then\n        MsgBox \"Please enter LBS ran with only numbers.\", vbExclamation\n        Exit Sub\n    End If\n    If Len(Target.Value) &lt; 4 And Target.Value &lt;&gt; 0 Then\n        MsgBox \"Please enter LBS ran with comma included.\", vbExclamation\n        Exit Sub\n    End If\nEnd If\n\nIf Target.Column = 15 Then  'COLUMN O\n    If Not IsNumeric(Target.Value) Then\n        MsgBox \"Please enter LBS ran with only numbers.\", vbExclamation\n        Exit Sub\n    End If\n    If Len(Target.Value) &lt; 4 And Target.Value &lt;&gt; 0 Then\n        MsgBox \"Please enter LBS ran with comma included.\", vbExclamation\n        Exit Sub\n    End If\nEnd If\n\n\n'IF COLUMN Q IS MARKED, BUT NOT COMPLETE TEXT TURNS RED\nIf Target.Column = 18 Then\n    If Target.Value = \"YES\" Or Target.Value = \"Yes\" Or Target.Value = \"yes\" Then 'Marks text green\n        With Target.Font\n            .Color = -16724992\n            .TintAndShade = 0\n        End With\n    Else\n        With Target.Font\n            .Color = vbRed\n            .TintAndShade = 0\n        End With\n    End If\nEnd If\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "visio", "embedded-object"], "owner": {"reputation": 36, "user_id": 9231663, "user_type": "registered", "profile_image": "https://graph.facebook.com/1655111171213167/picture?type=large", "display_name": "Jacek", "link": "https://stackoverflow.com/users/9231663/jacek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 243, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1593541973, "creation_date": 1516222201, "last_edit_date": 1593541973, "question_id": 48309763, "link": "https://stackoverflow.com/questions/48309763/saving-visio-drawing-after-update-an-embedded-excel-object-in-vba", "title": "Saving Visio drawing after update an embedded Excel object in VBA", "body": "<p>I have a problem with my VBA code.</p>\n\n<p>My task is to create VBA script which will scan directory for Visio drawings, update an embedded Excel object, save it and close it.</p>\n\n<p>So I developed a VBA sub:</p>\n\n<pre><code>Dim m_visioApp as Object\nSet m_visioApp = CreateObject(\"visio.application\")\n\n\nSub UpdateVsdFile(filename As String)\n\n    m_visioApp.Documents.Open (filename)\n\n    For Each pageObj In m_visioApp.ActiveDocument.Pages\n        For Each oleObj In pageObj.OLEObjects\n            If InStr(oleObj.progID, \"Excel.Sheet\") &gt; 0 Then\n                oleObj.Object.Activate\n                oleObj.Object.Application.Worksheets(1).Cells(1, 1) = \"Something\"\n                Call oleObj.Object.RefreshAll\n            End If\n        Next\n    Next\n\n    m_visioApp.ActiveWindow.DeselectAll\n\n    m_visioApp.ActiveDocument.SaveAsEx filename, visSaveAsListInMRU\n\n    m_visioApp.ActiveDocument.Close\n\nEnd Sub\n</code></pre>\n\n<p>What is not working:\n- saving Visio drawing after OLE object update\n- closing Visio drawing</p>\n\n<p>I'm using Visio 2016 and Excel 2016.</p>\n\n<p>Can any one help to check what I'm doing wrong? Or what I'm missing here?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1516221861, "post_id": 48309658, "comment_id": 83605022, "body": "Make sure there are no spaces or other unprintable characters in the data that would cause Excel not to see them as the same, as this method is looking for an EXACT match."}, {"owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1516222030, "post_id": 48309658, "comment_id": 83605101, "body": "After your <code>For i = 1</code> line, add <code>Debug.Print myRange.Cells(i, 3)</code> to see if you are even looking in the right place. Press <code>Ctrl</code> + <code>G</code> to open up the immediate window. As @ScottCraner stated, you are looking for an exact match. So if your cell&#39;s value actually says <code>Company Meeting on Tuesday</code>, that is not an exact match."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 2, "creation_date": 1516222165, "post_id": 48309658, "comment_id": 83605160, "body": "I would use <code>Debug.Print &quot;&#39;&quot; &amp; myRange.Cells(i, 3) &amp; &quot;&#39;&quot;</code> Which will help find any non printable characters."}, {"owner": {"reputation": 123, "user_id": 6901697, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-318FAO433XQ/AAAAAAAAAAI/AAAAAAAAAEc/-i5DASj1gCM/photo.jpg?sz=128", "display_name": "Dacromir", "link": "https://stackoverflow.com/users/6901697/dacromir"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1516222529, "post_id": 48309658, "comment_id": 83605360, "body": "@ScottCraner I thought that too, so I copied directly from my If statement and pasted into an empty cell, but I&#39;m still having problems. I&#39;ve also tried copying from the cell to the if statement."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1516222735, "post_id": 48309658, "comment_id": 83605464, "body": "There is nothing wrong with the syntax so the error has to be with the data or the location or something on your side that we can&#39;t do but guess."}, {"owner": {"reputation": 123, "user_id": 6901697, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-318FAO433XQ/AAAAAAAAAAI/AAAAAAAAAEc/-i5DASj1gCM/photo.jpg?sz=128", "display_name": "Dacromir", "link": "https://stackoverflow.com/users/6901697/dacromir"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1516223207, "post_id": 48309658, "comment_id": 83605710, "body": "@ScottCraner Debug.Print helped! Turns out my data source was using some other strange whitespace character. Thank you!"}], "answers": [{"tags": [], "owner": {"reputation": 153, "user_id": 7806187, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/683f69093ae92a6f10dd618bc179d841?s=128&d=identicon&r=PG&f=1", "display_name": "Harry", "link": "https://stackoverflow.com/users/7806187/harry"}, "is_accepted": false, "score": 1, "last_activity_date": 1516222283, "creation_date": 1516222283, "answer_id": 48309784, "question_id": 48309658, "link": "https://stackoverflow.com/questions/48309658/how-do-i-check-if-cell-contents-match-a-specific-string/48309784#48309784", "title": "How do I check if cell contents match a specific string?", "body": "<p>Agree with Scott Craner, I have had issues dealing with whitespace characters within excel. Copy and paste the contents of the cell into notepadd++ and then enable hidden chars with something like:</p>\n\n<ul>\n<li>View->Show Symbol->Show White Space and TAB</li>\n</ul>\n\n<p>This may help you identify exactly what you are looking at within you cell!</p>\n"}], "owner": {"reputation": 123, "user_id": 6901697, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-318FAO433XQ/AAAAAAAAAAI/AAAAAAAAAEc/-i5DASj1gCM/photo.jpg?sz=128", "display_name": "Dacromir", "link": "https://stackoverflow.com/users/6901697/dacromir"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1680, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1516222283, "creation_date": 1516221713, "last_edit_date": 1531164843, "question_id": 48309658, "link": "https://stackoverflow.com/questions/48309658/how-do-i-check-if-cell-contents-match-a-specific-string", "title": "How do I check if cell contents match a specific string?", "body": "<p>I'm building a quick Excel Macro that iterates through a raw input range, row by row, looking for different text values (which it sends to other worksheets as needed). I'm running into a problem with my If statements.</p>\n\n<p>Code snippet of the affected area</p>\n\n<pre><code>For i = 1 To (maxRow - 1)\n\n    If IsEmpty(myRange.Cells(i, 3)) Then\n\n        'Do things\n\n    ElseIf myRange.Cells(i, 3).Value = \"Company Meeting\" Then\n\n        'Do other things\n\n    End If\n\nNext\n</code></pre>\n\n<p>The code inside the ElseIf never runs. I changed the ElseIf line to </p>\n\n<pre><code>ElseIf myRange.Cells(i, 3).Value = 3 Then\n</code></pre>\n\n<p>...and added a 3 to the column we're looking at in the input, and it ran the code inside ElseIf. This tells me that my code is looking at the right columns and the right cells. For some reason, the issue only happens if my ElseIf is looking for a string value - if I try to check for a number I don't see any issues.</p>\n\n<p>I've also tried the following:</p>\n\n<pre><code>ElseIf myRange.Cells(i, 3).Text = \"Company Meeting\" Then\nElseIf myRange.Cells(i, 3) = \"Company Meeting\" Then\n</code></pre>\n\n<p>...with the same results</p>\n\n<p>How can I check if the text in the cell matches a specific string with an If statement?</p>\n"}, {"tags": ["vba", "ms-word"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user8753746"}, "edited": false, "score": 1, "creation_date": 1516223583, "post_id": 48309636, "comment_id": 83605892, "body": "you need to work with <code>.Selection</code>, this way will replace the selection."}, {"owner": {"reputation": 7422, "user_id": 1586390, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f07270207034d2bcbe347b028edc8f02?s=128&d=identicon&r=PG", "display_name": "Sorceri", "link": "https://stackoverflow.com/users/1586390/sorceri"}, "edited": false, "score": 0, "creation_date": 1516225844, "post_id": 48309636, "comment_id": 83606873, "body": "just add <code>car.Select</code> before the <code>Selection.TypeText (&quot;ENTER&quot;)</code>"}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "reply_to_user": {"reputation": 7422, "user_id": 1586390, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f07270207034d2bcbe347b028edc8f02?s=128&d=identicon&r=PG", "display_name": "Sorceri", "link": "https://stackoverflow.com/users/1586390/sorceri"}, "edited": false, "score": 0, "creation_date": 1516226949, "post_id": 48309636, "comment_id": 83607356, "body": "@Sorceri I think he would then need <code>Selection.TypeText car &amp; (&quot;ENTER&quot;)</code> Then an <code>Exit For</code>"}, {"owner": {"reputation": 7422, "user_id": 1586390, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f07270207034d2bcbe347b028edc8f02?s=128&d=identicon&r=PG", "display_name": "Sorceri", "link": "https://stackoverflow.com/users/1586390/sorceri"}, "reply_to_user": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1516227215, "post_id": 48309636, "comment_id": 83607491, "body": "@dwirony  I wasn&#39;t to sure as &quot;in the place of detection.&quot; wasn&#39;t very clear to me.  But if wishes to keep the char then you are correct."}], "answers": [{"tags": [], "owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "is_accepted": true, "score": 0, "last_activity_date": 1516299920, "last_edit_date": 1516299920, "creation_date": 1516229115, "answer_id": 48311223, "question_id": 48309636, "link": "https://stackoverflow.com/questions/48309636/inserting-text-while-iterating-by-character/48311223#48311223", "title": "Inserting text while iterating by character", "body": "<p>Word's Character object is also a Range object. So the following should work:</p>\n\n<pre><code> car.InsertParagraphAfter\n</code></pre>\n\n<p>Generally, working with the Selection object should be avoided when automating Word. There are a very few things for which it's necessary, but writing text to a document is not one of them...</p>\n\n<p>If, instead, the paragraph mark should be inserted a number of characters before the target Range (car), you can extend the start of the Range using the MoveStart method:</p>\n\n<pre><code> car.MoveStart wdCharacter, -n\n car.InsertParagraphBefore\n</code></pre>\n\n<p>Where n is the number of characters you want to go backwards.</p>\n"}], "owner": {"reputation": 3, "user_id": 8379291, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-2FCvQjbnbXw/AAAAAAAAAAI/AAAAAAAAB1A/S_5-h4jBYT0/photo.jpg?sz=128", "display_name": "Esteban Simoes", "link": "https://stackoverflow.com/users/8379291/esteban-simoes"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 33, "favorite_count": 0, "accepted_answer_id": 48311223, "answer_count": 1, "score": 0, "last_activity_date": 1516299920, "creation_date": 1516221588, "last_edit_date": 1516225185, "question_id": 48309636, "link": "https://stackoverflow.com/questions/48309636/inserting-text-while-iterating-by-character", "title": "Inserting text while iterating by character", "body": "<p>I'm going through a text character by character.</p>\n\n<p>With this Sub.</p>\n\n<p>Believe me it works.</p>\n\n<pre><code>Sub Recorrida2()\n\nprepararVariables\n\n   For Each parrf In ActiveDocument.Paragraphs\n        DoEvents\n        Dim c As Integer\n        c = 1\n               For Each car In parrf.Range.Characters\n                     If cargaAPatron(car) Then\n                     MsgBox \"lleno ok\"\n                     Selection.TypeText (\"ENTER\")\n                     lleno = 1\n                     End If\n\n                Next 'parrafo\nNext\n\nEnd Sub\n</code></pre>\n\n<p>My problem is that I want to insert a text when I detect a pattern.</p>\n\n<p>This way it does not work</p>\n\n<pre><code>Selection.TypeText (\"ENTER\")\n</code></pre>\n\n<p>Because it inserts the \"ENTER\" at the beginning of the text, instead of inserting it in the place of detection.</p>\n\n<p>What am I doing wrong?</p>\n\n<p>Thanks in advance!</p>\n"}, {"tags": ["html", "vba", "excel"], "comments": [{"owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "edited": false, "score": 2, "creation_date": 1516221239, "post_id": 48309513, "comment_id": 83604693, "body": "Your account was probably disabled for too many failed attempts trying to log in with VBA code."}, {"owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "edited": false, "score": 0, "creation_date": 1516221795, "post_id": 48309513, "comment_id": 83604985, "body": "Can you supply the HTML code in question?"}, {"owner": {"reputation": 36, "user_id": 6737912, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/082814b8aab8d6bc350ce59a4355e8bd?s=128&d=identicon&r=PG&f=1", "display_name": "skroutela", "link": "https://stackoverflow.com/users/6737912/skroutela"}, "reply_to_user": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "edited": false, "score": 0, "creation_date": 1516294271, "post_id": 48309513, "comment_id": 83638228, "body": "Hi Davis | I have updated the code in question.. plz check and suggest the resolution"}], "answers": [{"tags": [], "owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "is_accepted": false, "score": 0, "last_activity_date": 1516298450, "creation_date": 1516298450, "answer_id": 48327614, "question_id": 48309513, "link": "https://stackoverflow.com/questions/48309513/website-login-through-vba-is-throwing-error-stating-invalid-user-name-or-passwo/48327614#48327614", "title": "Website Login through VBA is throwing error stating &quot;Invalid user name or password&quot;", "body": "<p>No need to iterate through all the input tag collections. When you have an ID, then you can reference them directly.</p>\n\n<p>Try this modification:</p>\n\n<pre><code>Private Sub time_sheet_filling()\n\n    Dim I As Long\n    Dim IE As Object\n    Dim doc As Object\n    Dim objElement As Object\n    Dim objCollection As Object\n\n    ' Create InternetExplorer Object\n    Set IE = CreateObject(\"InternetExplorer.Application\")\n    IE.Visible = True\n\n    ' Send the form data To URL As POST binary request\n    IE.navigate \"http://sanjay.com/default.aspx\"\n\n    ' Wait while IE loading...\n    Do While IE.Busy Or IE.readyState &lt; 4\n        DoEvents\n    Loop\n\n    'Load the logon page\n    Dim oUser As Object, oPass As Object, oSubmit As Object\n    Set doc = IE.document\n    Set oUser = doc.getElementById(\"ctl00_MainContent_ctlLogin__UserName\")\n    Set oPass = doc.getElementById(\"ctl00_MainContent_ctlLogin__Password\")\n    Set oSubmit = doc.getElementById(\"ctl00_MainContent_ctlLogin_BtnSubmit\")\n\n    oUser.Value = \"abc\"\n    oPass.Value = \"123\"\n    oSubmit.Click\n</code></pre>\n\n<hr>\n\n<p>Also - notice the change I made to your loop. <code>IE.Busy</code> by itself is very unreliable. Sometimes it will turn <code>False</code> when the webpage is still loading. On your line I added <code>IE.ReadyState &lt; 4</code> as another factor on reliability. <code>4</code> is the value of the constant <code>READYSTATE_COMPLETE</code>.</p>\n"}], "owner": {"reputation": 36, "user_id": 6737912, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/082814b8aab8d6bc350ce59a4355e8bd?s=128&d=identicon&r=PG&f=1", "display_name": "skroutela", "link": "https://stackoverflow.com/users/6737912/skroutela"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 177, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1516298533, "creation_date": 1516221120, "last_edit_date": 1531164843, "question_id": 48309513, "link": "https://stackoverflow.com/questions/48309513/website-login-through-vba-is-throwing-error-stating-invalid-user-name-or-passwo", "title": "Website Login through VBA is throwing error stating &quot;Invalid user name or password&quot;", "body": "<p>I used below code for auto login on website through VBA but it is throwing error stating </p>\n\n<blockquote>\n  <p>\"Invalid user name or password\"</p>\n</blockquote>\n\n<p>Can someone guide me to what changes required in below code to eliminate the issue?</p>\n\n<pre><code>Private Sub time_sheet_filling()\n\n    Dim I As Long\n    Dim IE As Object\n    Dim doc As Object\n    Dim objElement As Object\n    Dim objCollection As Object\n\n    ' Create InternetExplorer Object\n    Set IE = CreateObject(\"InternetExplorer.Application\")\n    IE.Visible = True\n\n    ' Send the form data To URL As POST binary request\n    IE.Navigate \"http://sanjay.com/default.aspx\"\n\n    ' Wait while IE loading...\n    Do While IE.Busy\n        Application.Wait DateAdd(\"s\", 1, Now)\n    Loop\n\n        'Load the logon page\n    Set objCollection = IE.Document.getElementsByTagName(\"input\")\n    I = 0\n    While I &lt; objCollection.Length\n        If objCollection(I).ID = \"username\" Then\n            ' Set text to enter\n            objCollection(I).Value = \"abc\"\n        End If\n        If objCollection(I).ID = \"password\" Then\n            ' Set text for password\n            objCollection(I).Value = \"123\"\n        End If\n\n        If objCollection(I).ID = \"submit\" Then ' submit button clicking\n            Set objElement = objCollection(I)\n        End If\n        I = I + 1\n    Wend\n\n    objElement.Click\n</code></pre>\n\n<h2>        End Sub</h2>\n\n<p>Website code as you asked.. kindly check and please help with resolution</p>\n\n<pre><code> &lt;/script&gt;\n        &lt;table cellspacing=\"0\" cellpadding=\"0\" style=\"margin: 0px auto 0 auto;\"&gt;\n            &lt;tr&gt;\n                &lt;td class=\"parrafo\" style=\"text-align: left; vertical-align: middle; padding: 0 15px 0 0;\"&gt;ACCOUNT&lt;/td&gt;\n                &lt;td class=\"parrafo\" style=\"text-align: left; vertical-align: middle; padding: 0 15px 0 0;\"&gt;PASSWORD&lt;/td&gt;\n                &lt;td&gt;&amp;#0160;&lt;/td&gt;\n            &lt;/tr&gt;\n            &lt;tr&gt;\n                &lt;td style=\"text-align: left; vertical-align: middle; padding: 0 15px 0 0;\"&gt;\n                    &lt;input name=\"ctl00$MainContent$ctlLogin$_UserName\" type=\"text\" size=\"15\" id=\"ctl00_MainContent_ctlLogin__UserName\" accesskey=\"u\" tabindex=\"60\" class=\"login_input\" /&gt;\n                &lt;/td&gt;\n                &lt;td style=\"text-align: left; vertical-align: middle; padding: 0 15px 0 0;\"&gt;\n                    &lt;input name=\"ctl00$MainContent$ctlLogin$_IdBook\" type=\"hidden\" id=\"ctl00_MainContent_ctlLogin__IdBook\" value=\"54,60,51,24,3,7,6\" /&gt;\n                    &lt;input name=\"ctl00$MainContent$ctlLogin$Redir\" type=\"hidden\" id=\"ctl00_MainContent_ctlLogin_Redir\" value=\"wager/welcome.aspx\" /&gt;\n                    &lt;input name=\"ctl00$MainContent$ctlLogin$_Password\" type=\"password\" size=\"15\" id=\"ctl00_MainContent_ctlLogin__Password\" accesskey=\"p\" tabindex=\"61\" onkeyup=\"onkey(event, this.value, this)\" class=\"login_input\" /&gt;\n                &lt;/td&gt;\n                &lt;td style=\"text-align: left; vertical-align: middle;\"&gt;\n                    &lt;input type=\"submit\" name=\"ctl00$MainContent$ctlLogin$BtnSubmit\" value=\"Login\" id=\"ctl00_MainContent_ctlLogin_BtnSubmit\" class=\"login_input\" style=\"text-transform: uppercase;\" /&gt;\n                &lt;/td&gt;\n            &lt;/tr&gt;               \n        &lt;/table&gt;\n    &lt;/div&gt;\n</code></pre>\n"}, {"tags": ["vba", "ms-access"], "answers": [{"comments": [{"owner": {"reputation": 107, "user_id": 9027658, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/41ee829aa0d5b59a743f4671b80d2aca?s=128&d=identicon&r=PG&f=1", "display_name": "Azmodan", "link": "https://stackoverflow.com/users/9027658/azmodan"}, "edited": false, "score": 0, "creation_date": 1516221962, "post_id": 48309474, "comment_id": 83605069, "body": "Thanks Winter, however - i made silly mistake and didn&#39;t report that this is access VBA programming - as ListItem is not picked up by access :("}], "tags": [], "owner": {"reputation": 136, "user_id": 3137823, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a4e2c7362d3562e86a21dc6432f8e9d7?s=128&d=identicon&r=PG&f=1", "display_name": "Wintermute", "link": "https://stackoverflow.com/users/3137823/wintermute"}, "is_accepted": false, "score": 1, "last_activity_date": 1516223014, "last_edit_date": 1516223014, "creation_date": 1516220937, "answer_id": 48309474, "question_id": 48309382, "link": "https://stackoverflow.com/questions/48309382/for-loop-through-a-list-box/48309474#48309474", "title": "For Loop through a list box", "body": "<p>Alright, I've adjusted the code based on your comment: </p>\n\n<pre><code>Dim i As Integer\nFor i = 0 To Me.lstOrdersInBatch.ListCount - 1\n    If Me.lstOrdersInBatch.Selected(i) Then\n        tbxTotal = tbxTotal + Me.lstOrdersInBatch.ItemData(i)\n    End If\nNext i\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 14479, "user_id": 7531598, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/DKnSq.jpg?s=128&g=1", "display_name": "Lee Mac", "link": "https://stackoverflow.com/users/7531598/lee-mac"}, "is_accepted": false, "score": 0, "last_activity_date": 1516229318, "creation_date": 1516229318, "answer_id": 48311263, "question_id": 48309382, "link": "https://stackoverflow.com/questions/48309382/for-loop-through-a-list-box/48311263#48311263", "title": "For Loop through a list box", "body": "<p>You can reduce the number of iterations and avoid the need for the <code>if</code> statement using the following:</p>\n\n<pre><code>Dim idx\ntbxTotal = 0\nWith lstOrdersInBatch\n    For Each idx In .ItemsSelected\n        tbxTotal = tbxTotal + .Column(4, idx)\n    Next idx\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 107, "user_id": 9027658, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/41ee829aa0d5b59a743f4671b80d2aca?s=128&d=identicon&r=PG&f=1", "display_name": "Azmodan", "link": "https://stackoverflow.com/users/9027658/azmodan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2482, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1612378569, "creation_date": 1516220520, "last_edit_date": 1612378569, "question_id": 48309382, "link": "https://stackoverflow.com/questions/48309382/for-loop-through-a-list-box", "title": "For Loop through a list box", "body": "<p>Hope you can help - I have simple list box which is populated from DB and has 6 columns [ID, name, ordnumber, data, price ,postcode]</p>\n<p>The listbox is populated without issues [So for that purposes I will not post the code]</p>\n<p>The issue i have is when i'm trying to get the running total of the prices when I select item in list box.</p>\n<pre><code> With lstOrdersInBatch\n   tbxTotal.value = 0\n    For IntIndex = 0 To .ListCount - 1\n        If .Selected(IntIndex) Then\n         'tbxTotal = tbxTotal + .Column(4)\n   \n           \n        End If\n\n    Next\nEnd With\n</code></pre>\n<p>It's giving me incorrect value</p>\n<p>I have gone through the debug log and it's seems it only take the last item selected &amp; not all selected.</p>\n<p>Hope you can help.</p>\n<p>Thanks</p>\n<p>Please note is access VBA programming.</p>\n<p>===== SOLVED ===</p>\n<p><a href=\"https://stackoverflow.com/questions/4649000/retrieve-column-values-of-the-selected-row-of-a-multicolumn-access-listbox\">Retrieve column values of the selected row of a multicolumn Access listbox</a></p>\n<p>That has the answer.</p>\n<pre><code>   With lstOrdersInBatch\n   tbxTotal.value = 0\n   For IntIndex = 0 To .ListCount - 1\n        If .Selected(IntIndex) Then\n        tbxTotal = tbxTotal + lstOrdersInBatch.Column(4, IntIndex)\n        End If\n\n   Next\n</code></pre>\n<p>End With</p>\n<p>Thank you for trying.</p>\n"}, {"tags": ["vba", "ms-word"], "answers": [{"comments": [{"owner": {"reputation": 55, "user_id": 7411350, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/10209196004408092/picture?type=large", "display_name": "Dave Reilly", "link": "https://stackoverflow.com/users/7411350/dave-reilly"}, "edited": false, "score": 0, "creation_date": 1516286116, "post_id": 48311287, "comment_id": 83632699, "body": "So glad this was something that I was missing! Appreciate the QA Cindy!"}], "tags": [], "owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "is_accepted": true, "score": 1, "last_activity_date": 1516229492, "creation_date": 1516229492, "answer_id": 48311287, "question_id": 48309117, "link": "https://stackoverflow.com/questions/48309117/write-and-style-in-loop/48311287#48311287", "title": "Write and Style In Loop", "body": "<p>In the following line of code:</p>\n\n<pre><code> wrdRange.text = totalArray(i, colIndex(3)) &amp; Chr(11)\n</code></pre>\n\n<p>Use Chr(13) instead of Chr(11). The latter is simply a line break, not a new paragraph. So applying a style to any part of the Range is actually applying it to all the text your code is generating because it's a single paragraph.</p>\n"}], "owner": {"reputation": 55, "user_id": 7411350, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/10209196004408092/picture?type=large", "display_name": "Dave Reilly", "link": "https://stackoverflow.com/users/7411350/dave-reilly"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 53, "favorite_count": 0, "accepted_answer_id": 48311287, "answer_count": 1, "score": 0, "last_activity_date": 1516229492, "creation_date": 1516219360, "last_edit_date": 1516220085, "question_id": 48309117, "link": "https://stackoverflow.com/questions/48309117/write-and-style-in-loop", "title": "Write and Style In Loop", "body": "<p>Say that I have the following code to write headings from an array to a word document and to apply defined styles:</p>\n\n<pre><code>With wdDoc\n    Set wrdRange = .Range(0, 0)                     ' Set initial Range.\n    i = 2\n    Do Until i &gt; 6\n       ' Debug.Print wrdRange.Start, wrdRange.End\n        wrdRange.text = totalArray(i, colIndex(3)) &amp; Chr(11)\n        Set wrdRange = .Paragraphs(i - 1).Range\n        wrdRange.Style = totalArray(i, colIndex(2))\n        wrdRange.Collapse 0\n        i = i + 1\n    Loop\nEnd With\n</code></pre>\n\n<p>One would expect the following to occur: </p>\n\n<ol>\n<li>The word range moves programmatically as I move through the document.</li>\n<li>The word style is updated for the new range (defined by the set statement)</li>\n<li>The Range collapses to the end (0 = wdCollapseEnd) and the loop continues until the initial conditions are satisfied. </li>\n</ol>\n\n<p>What I can't seem to fix is the styles being applied to ALL existing paragraphs in the document. The Debug.Print statement should show the range being updated as expected, despite the fact that the style applies to all existing paragraphs. </p>\n\n<p>As you can tell, I've toyed around with this quite a bit, to no avail. Any help would be appreciated in this matter.</p>\n\n<p>Thanks.</p>\n"}, {"tags": ["regex", "vba", "excel"], "comments": [{"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 1, "creation_date": 1516219536, "post_id": 48309014, "comment_id": 83603813, "body": "Just use Proper on Capturing group 3.  How to do that depends on your VBA code."}, {"owner": {"reputation": 63, "user_id": 9124238, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/92ac4c75ad012414ad220a3fb77d8ad6?s=128&d=identicon&r=PG&f=1", "display_name": "Tom F", "link": "https://stackoverflow.com/users/9124238/tom-f"}, "reply_to_user": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1516221443, "post_id": 48309014, "comment_id": 83604786, "body": "Thanks. I added the VBA code to my question.  I do not know how to use Proper on just capturing group 3."}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1516222017, "post_id": 48309014, "comment_id": 83605093, "body": "I&#39;ve posted some code"}], "answers": [{"comments": [{"owner": {"reputation": 63, "user_id": 9124238, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/92ac4c75ad012414ad220a3fb77d8ad6?s=128&d=identicon&r=PG&f=1", "display_name": "Tom F", "link": "https://stackoverflow.com/users/9124238/tom-f"}, "edited": false, "score": 1, "creation_date": 1516224062, "post_id": 48309720, "comment_id": 83606122, "body": "Thank you! I ran it and it worked. I have so much to learn. Thanks for helping out."}], "tags": [], "owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "is_accepted": true, "score": 3, "last_activity_date": 1516221997, "creation_date": 1516221997, "answer_id": 48309720, "question_id": 48309014, "link": "https://stackoverflow.com/questions/48309014/case-conversion-using-regex/48309720#48309720", "title": "Case Conversion using REGEX", "body": "<p>Try this:</p>\n\n<pre><code>Option Explicit\nFunction tom_test(Myrange As Range) As String\n\nDim regEx As New RegExp\nDim strPattern As String\nDim strInput As String\nDim strReplace As String\n\nDim MC As MatchCollection\n\nstrPattern = \"^(\\D{2,4}\\d{0,4})-(\\d{1,4}) (.*)\\s(\\d\\d)( HP)\\s\\((\\d\\d.\\d)\\skw\\)\"\n\nIf strPattern &lt;&gt; \"\" Then\n    strInput = Myrange.Value\n    strReplace = \"$1-$2 - Juniper $1 Part, $3, $4HP, $6KW\"\n    With regEx\n        .Global = True\n        .MultiLine = True\n        .IgnoreCase = False\n        .Pattern = strPattern\n    End With\n\n    If regEx.Test(strInput) Then\n        Set MC = regEx.Execute(strInput)\n\n        strReplace = Replace(strReplace, \"$3\", StrConv(MC(0).SubMatches(2), vbProperCase))\n\n        tom_test = regEx.Replace(strInput, strReplace)\n\n    Else\n        tom_test = \"No Bueno\"\n    End If\nEnd If\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 63, "user_id": 9124238, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/92ac4c75ad012414ad220a3fb77d8ad6?s=128&d=identicon&r=PG&f=1", "display_name": "Tom F", "link": "https://stackoverflow.com/users/9124238/tom-f"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 61, "favorite_count": 0, "accepted_answer_id": 48309720, "answer_count": 1, "score": 1, "last_activity_date": 1516221997, "creation_date": 1516218973, "last_edit_date": 1516221078, "question_id": 48309014, "link": "https://stackoverflow.com/questions/48309014/case-conversion-using-regex", "title": "Case Conversion using REGEX", "body": "<p>Using Excel with REGEX in VBA and I am new at this. </p>\n\n<p>I need to convert the contents of one capture group from all uppercase to titlecase via the strReplace command. I can't use the Excel PROPER function on the results from strReplace because it doesn't provide the desired results.</p>\n\n<p>Sample cell contents are (not all cells are like this one which is why string pattern definition is more encompassing):</p>\n\n<pre><code>FDI850-4224 JIM SMITH 29 HP (21.6 kw)\n</code></pre>\n\n<p>My string pattern is:</p>\n\n<pre><code>strPattern = \"^(\\D{2,4}\\d{0,4})-(\\d{1,4}) (.*)\\s(\\d\\d)( HP)\\s\\((\\d\\d.\\d)\\skw\\)\"\n</code></pre>\n\n<p>My replacement pattern is:</p>\n\n<pre><code>strReplace = \"$1-$2 - Juniper $1 Part, $3, $4HP, $6KW\"\n</code></pre>\n\n<p>The current results that are placed in the adjacent cell are:</p>\n\n<pre><code>FDI850-4224 - Juniper FDI850 Part, JIM SMITH, 29HP, 21.6KW\n</code></pre>\n\n<p>My desired results to be placed in the adjacent cell are:</p>\n\n<pre><code>FDI850-4224 - Juniper FDI850 Part, Jim Smith, 29HP, 21.6KW\n</code></pre>\n\n<p>Is there something I can use in the strReplace for capture group 3 (.*) to change it from all uppercase to titlecase?</p>\n\n<p>Here is my VBA code:</p>\n\n<pre><code>Function tom_test(Myrange As Range) As String\n\nDim regEx As New RegExp\nDim strPattern As String\nDim strInput As String\nDim strReplace As String\n\nstrPattern = \"^(\\D{2,4}\\d{0,4})-(\\d{1,4}) (.*)\\s(\\d\\d)( HP) \\((\\d\\d.\\d\\d)\\skW\\)\"\n\nIf strPattern &lt;&gt; \"\" Then\n    strInput = Myrange.Value\n    strReplace = \"$1-$2 - Juniper $1 Part, $3, $4HP, $6KW\"\n    With regEx\n        .Global = True\n        .MultiLine = True\n        .IgnoreCase = False\n        .Pattern = strPattern\n    End With\n\n    If regEx.Test(strInput) Then\n        tom_test = regEx.Replace(strInput, strReplace)\n\n    Else\n        tom_test = \"No Bueno\"\n    End If\nEnd If    \nEnd Function\n</code></pre>\n\n<p>I tried a two step process of taking the results from the REGEX function and then using the Excel PROPER function on it, but it mucked up the results of the other capture group results:\nHere is what happened after using PROPER on the results from strReplace:</p>\n\n<pre><code>Fdi850-4224 - Juniper Fdi850 Part, Jim Smith, 29Hp, 21.6Kw\n</code></pre>\n\n<p>I would appreciate any help.</p>\n"}, {"tags": ["excel", "vba", "outlook"], "comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 1, "creation_date": 1516221593, "post_id": 48308994, "comment_id": 83604867, "body": "Can you check what the <code>ReceivedTime</code> is of the emails that weren&#39;t selected please.  I suspect that this is a time zone issue of some sort, i.e. the <b>displayed</b> time in Outlook is offset from what is stored in <code>ReceivedTime</code>.  (But I don&#39;t use Outlook VBA, so I could be wildly wrong.)"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1516222063, "post_id": 48308994, "comment_id": 83605114, "body": "Also concerning is that emails from other users (e.g. &quot;support@croesus.com&quot;) were selected, despite your <code>DateToCheck3</code> restriction."}, {"owner": {"reputation": 81, "user_id": 8635780, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/a6a1f2938c54b10f5a34f00f775ebd18?s=128&d=identicon&r=PG&f=1", "display_name": "Jason", "link": "https://stackoverflow.com/users/8635780/jason"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1516222158, "post_id": 48308994, "comment_id": 83605155, "body": "@YowE3K Yes, you&#39;re right I edited my code below DateToCheck = &quot;[ReceivedTime] &gt;  &#39;&quot; &amp; Format(&quot;1/16/18 12:01am&quot;, &quot;ddddd h:nn AMPM&quot;) &amp; &quot;&#39;&quot; DateToCheck2 = &quot;[ReceivedTime] &lt;  &#39;&quot; &amp; Format(&quot;1/17/18 23:59pm&quot;, &quot;ddddd h:nn AMPM&quot;) &amp; &quot;&#39;&quot; DateToCheck3 = &quot;[SenderName] = &quot;&quot;no-reply@croesus.com&quot;&quot;&quot;"}, {"owner": {"reputation": 81, "user_id": 8635780, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/a6a1f2938c54b10f5a34f00f775ebd18?s=128&d=identicon&r=PG&f=1", "display_name": "Jason", "link": "https://stackoverflow.com/users/8635780/jason"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1516222300, "post_id": 48308994, "comment_id": 83605238, "body": "The main problem is time format. User will insert specified date in Excel but they don&#39;t usually type the time. Let&#39;s say 1/15/18 to 1/17/18. how can I date add time as I gave dummy data in above code? I know DateAdd function but I don&#39;t know how I can apply this in my code"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1516224746, "post_id": 48308994, "comment_id": 83606402, "body": "I&#39;m afraid I can&#39;t really help - I don&#39;t have easy access to Outlook VBA, so I can&#39;t play with it to see how <code>ReceivedTime</code> is stored, or how the <code>Restrict</code> method works."}, {"owner": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "edited": false, "score": 0, "creation_date": 1516260830, "post_id": 48308994, "comment_id": 83617296, "body": "<a href=\"https://stackoverflow.com/a/48162914/2685412\">Check one of my post regarding <i>Restrict</i> requirement on dates</a>."}, {"owner": {"reputation": 2005, "user_id": 5942100, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/we47u.jpg?s=128&g=1", "display_name": "Lynn", "link": "https://stackoverflow.com/users/5942100/lynn"}, "edited": false, "score": 0, "creation_date": 1601254187, "post_id": 48308994, "comment_id": 113340529, "body": "Is there a way to add &#39;todays date&#39; to the filter?"}], "answers": [{"tags": [], "owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "is_accepted": false, "score": 1, "last_activity_date": 1516224766, "creation_date": 1516224766, "answer_id": 48310333, "question_id": 48308994, "link": "https://stackoverflow.com/questions/48308994/using-restrict-method-for-emails-within-a-specified-date/48310333#48310333", "title": "Using Restrict method for emails within a specified date", "body": "<p>If you are missing most recent mail then set DateEnd, without time, one day later. This should calculate to the beginning of the day at time 00:00.</p>\n\n<pre><code>Sub GetFromOutlook()\n\nDim OutlookApp As Outlook.Application\nDim OutlookNamespace As Namespace\nDim Folder As MAPIFolder\nDim OutlookMail As Variant\n\nDim i As Integer\n\nDim olItems As Outlook.Items\nDim myItems As Outlook.Items\nDim myitem As Object\n\nDim DateStr As String\nDim DateEnd As String\n\nDim oOlResults As Object\n\nDim DateToCheck As String\nDim DateToCheck2 As String\nDim DateToCheck3 As String\n\nSet OutlookApp = New Outlook.Application\nSet OutlookNamespace = OutlookApp.GetNamespace(\"MAPI\")\n\nDim olShareName As Outlook.Recipient\n'Set olShareName = OutlookNamespace.CreateRecipient(\"Mailbox.sharedmailbox@example.ca\")\n'Set Folder = OutlookNamespace.GetSharedDefaultFolder(olShareName, olfolderinbox).Folders(\"sub1\").Folders(\"sub2\")\n\n' for my testing\nSet Folder = OutlookNamespace.getdefaultfolder(olfolderinbox)\n\nSet olItems = Folder.Items\n\nDateStr = \"2018-01-16\"\nDebug.Print DateStr\n\n' User input DateEnd without a time\nDateEnd = \"2018-01-17\"\nDebug.Print DateEnd\n\n' Calculated DateEnd is the beginning of the next day\nDateEnd = DateAdd(\"d\", 1, DateEnd)\n' This is 2018-01-18 00:00\nDebug.Print DateEnd\n\nDateToCheck = \"[ReceivedTime] &gt; \"\"\" &amp; DateStr &amp; \"\"\"\"\nDebug.Print vbCr &amp; \"Filter 1: \" &amp; DateToCheck\n\nSet myItems = olItems.Restrict(DateToCheck)\n\nFor Each myitem In myItems\n    Debug.Print myitem.ReceivedTime &amp; \": \" &amp; myitem.Subject\nNext myitem\n\n'DateToCheck2 = \"[ReceivedTime] &lt;= \"\"\" &amp; DateEnd &amp; \"\"\"\"\nDateToCheck2 = \"[ReceivedTime] &lt; \"\"\" &amp; DateEnd &amp; \"\"\"\"\nDebug.Print vbCr &amp; \"Filter 2: \" &amp; DateToCheck2\n\nSet myItems = myItems.Restrict(DateToCheck2)\n\nFor Each myitem In myItems\n    Debug.Print myitem.ReceivedTime &amp; \": \" &amp; myitem.Subject\nNext myitem\n\nDateToCheck3 = \"[SenderName] = \"\"no-reply@example.com\"\"\"\nDebug.Print vbCr &amp; \"Filter 3: \" &amp; DateToCheck3\n\nSet myItems = myItems.Restrict(DateToCheck3)\n\nFor Each myitem In myItems\n    Debug.Print myitem.ReceivedTime &amp; \": \" &amp; myitem.Subject\nNext myitem\n\nSet Folder = Nothing\nSet OutlookNamespace = Nothing\nSet OutlookApp = Nothing\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "is_accepted": true, "score": 1, "last_activity_date": 1516685947, "last_edit_date": 1516685947, "creation_date": 1516269614, "answer_id": 48318476, "question_id": 48308994, "link": "https://stackoverflow.com/questions/48308994/using-restrict-method-for-emails-within-a-specified-date/48318476#48318476", "title": "Using Restrict method for emails within a specified date", "body": "<p>Expounding my comment you can try using below with the following considerations:</p>\n\n<ol>\n<li>Received date, <code>datereceived</code> is expressed in UTC. So you need to adjust your time depending on your UTC. In my case it is UTC8 so I need to adjust the time 8 hours earlier <sub>(<strong><em>Note</strong>: No documentation to support this, but when I did my testing, it is expressed in UTC. <br>It may or may not always be the case</em>).</sub></li>\n<li><p>Date should be expressed as string as stated <a href=\"https://msdn.microsoft.com/en-us/vba/outlook-vba/articles/items-restrict-method-outlook\" rel=\"nofollow noreferrer\">here</a>.</p>\n\n<blockquote>\n  <p>Although dates and times are typically stored with a Date format, the Find and Restrict methods require that the date and time be converted to a string representation.</p>\n</blockquote>\n\n<p><strong>Example:</strong></p>\n\n<pre><code>mydate = Format(Now,\"\\'m/d/yyy hh:mm AM/PM\\'\") '/* will give '1/23/2018 01:36 PM' */\n</code></pre></li>\n<li><code>sendername</code> may contain the email address or the email name.</li>\n</ol>\n\n<hr>\n\n<pre><code>Sub stancial()\n    Dim olItems As Outlook.Items\n    Dim olFolder As Outlook.Folder\n    Dim olNS As Outlook.NameSpace\n    Dim olEmail As Outlook.MailItem\n    Dim i As Long\n\n    Dim efilter As String, startdt As String, endindt As String, _\n        myUTC As Integer, sentby As String\n\n    myUTC = 8 '/* this is your UTC, change to suit (in my case 8) */\n\n    startdt = Format(DateAdd(\"h\", -myUTC, _\n              CDate(\"1/18/2018 12:00 PM\")), \"\\'m/d/yyyy hh:mm AM/PM\\'\")\n    endindt = Format(DateAdd(\"h\", -myUTC, _\n              CDate(\"1/18/2018 4:00 PM\")), \"\\'m/d/yyyy hh:mm AM/PM\\'\")\n    sentby = \"'john.doe@email.com'\" '/* can be sendername, \"doe, john\" */\n\n    Set olNS = Application.GetNamespace(\"MAPI\")\n    Set olFolder = olNS.GetDefaultFolder(olFolderInbox)\n    '/* filter in one go, where datereceived is\n    'expressed in UTC (Universal Coordinated Time) */\n    efilter = \"@SQL= (urn:schemas:httpmail:sendername = \" &amp; sentby &amp; _\n              \" And (urn:schemas:httpmail:datereceived &gt;= \" &amp; startdt &amp; _\n              \" And urn:schemas:httpmail:datereceived &lt;= \" &amp; endindt &amp; \"))\"\n\n    Set olItems = olFolder.Items.Restrict(efilter)\n\n    With olItems\n        For i = .Count To 1 Step -1 '/* starting from most recent */\n            If TypeOf .Item(i) Is MailItem Then\n                Set olEmail = .Item(i)\n                Debug.Print olEmail.Subject, olEmail.ReceivedTime\n            End If\n        Next\n    End With\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "is_accepted": false, "score": 0, "last_activity_date": 1516725339, "creation_date": 1516725339, "answer_id": 48406689, "question_id": 48308994, "link": "https://stackoverflow.com/questions/48308994/using-restrict-method-for-emails-within-a-specified-date/48406689#48406689", "title": "Using Restrict method for emails within a specified date", "body": "<p>Your code only uses the DateToCheck3 restriction - the other two are ignored by your code. If you want to combine multiple restrictions, combine them into a single query using the AND operator.</p>\n"}], "owner": {"reputation": 81, "user_id": 8635780, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/a6a1f2938c54b10f5a34f00f775ebd18?s=128&d=identicon&r=PG&f=1", "display_name": "Jason", "link": "https://stackoverflow.com/users/8635780/jason"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3613, "favorite_count": 0, "accepted_answer_id": 48318476, "answer_count": 3, "score": 1, "last_activity_date": 1592872231, "creation_date": 1516218901, "last_edit_date": 1592872231, "question_id": 48308994, "link": "https://stackoverflow.com/questions/48308994/using-restrict-method-for-emails-within-a-specified-date", "title": "Using Restrict method for emails within a specified date", "body": "<p><a href=\"https://i.stack.imgur.com/hJKGW.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/hJKGW.jpg\" alt=\"Problem\"></a>I am creating a macro to get email by subject and received date in our team shared box. My problem is that once I select date (e,g 1/16/2018 to 1/17/2018), only few emails are stored in object.\nIn below screenshot, I have 9 items which are applied restrict method. It should be 14 items emails which are received after 1/16/2018 to now(right outlook mail in screenshot), but 5 emails are not stored in object. can anyone help me out? I'm STUCK!</p>\n\n<pre><code>Sub GetFromOutlook()\n\nDim OutlookApp As Outlook.Application\nDim OutlookNamespace As Namespace\nDim Folder As MAPIFolder\nDim OutlookMail As Variant\nDim i As Integer\nDim olItems As Outlook.Items\nDim myItems As Outlook.Items\nDim DateStr As Date\nDim DateEnd As Date\nDim oOlResults As Object\n\nDim DateToCheck As String\nDim DateToCheck2 As String\nDim DateToCheck3 As String\n\nSet OutlookApp = New Outlook.Application\nSet OutlookNamespace = OutlookApp.GetNamespace(\"MAPI\")\n\nDim olShareName As Outlook.Recipient\nSet olShareName = OutlookNamespace.CreateRecipient(\"Mailbox.sharedmailbox@example.ca\")\nSet Folder = OutlookNamespace.GetSharedDefaultFolder(olShareName, olFolderInbox).Folders(\"sub1\").Folders(\"sub2\")\nSet olItems = Folder.Items\n\n\n'DateStr = 1/16/2018\n'DateEnd = 1/17/2018\n\nDateStr = Format(Range(\"From_Date\").Value, \"DDDDD HH:NN\")\nDateEnd = Format(Range(\"To_Date\").Value, \"DDDDD HH:NN\")\n\n'DateStr = DateAdd(\"d\", -1, DateStr)\n'DateEnd = DateAdd(\"d\", 1, DateEnd)\n\nDateToCheck = \"[ReceivedTime] &gt; \"\"\" &amp; DateStr &amp; \"\"\"\"\nDateToCheck2 = \"[ReceivedTime] &lt;= \"\"\" &amp; DateEnd &amp; \"\"\"\"\nDateToCheck3 = \"[SenderName] = \"\"no-reply@example.com\"\"\"\n\nSet myItems = olItems.Restrict(DateToCheck)\nSet myItems = myItems.Restrict(DateToCheck2)\nSet myItems = myItems.Restrict(DateToCheck3)\n\ni = 1\n\nFor Each myitem In myItems\n    ' MsgBox myitem.ReceivedTime\n\n     Range(\"eMail_subject\").Offset(i, 0).Value = myitem.Subject\n     Range(\"eMail_date\").Offset(i, 0).Value = myitem.ReceivedTime\n\n     i = i + 1\n\nNext myitem\n\nSet Folder = Nothing\nSet OutlookNamespace = Nothing\nSet OutlookApp = Nothing\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1516218799, "post_id": 48308883, "comment_id": 83603383, "body": "Try <code>Target(1).Value</code> and <code>Target(2).Value</code>"}, {"owner": {"reputation": 3028, "user_id": 558619, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/1618a853824f6ed866aa0fe4385b8687?s=128&d=identicon&r=PG", "display_name": "keynesiancross", "link": "https://stackoverflow.com/users/558619/keynesiancross"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1516219416, "post_id": 48308883, "comment_id": 83603752, "body": "Nope, doesn&#39;t work. Same issue as The TTG Guy"}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 0, "creation_date": 1516220523, "post_id": 48308883, "comment_id": 83604333, "body": "See my <b>EDIT#2</b>"}], "answers": [{"comments": [{"owner": {"reputation": 3028, "user_id": 558619, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/1618a853824f6ed866aa0fe4385b8687?s=128&d=identicon&r=PG", "display_name": "keynesiancross", "link": "https://stackoverflow.com/users/558619/keynesiancross"}, "edited": false, "score": 0, "creation_date": 1516219361, "post_id": 48309039, "comment_id": 83603717, "body": "The loop may work, but it&#39;s only ever going to be two cells.  Makes for an ugly loop if I have to assign specific variables (Ticker, and TickerTwo)..."}, {"owner": {"reputation": 3423, "user_id": 1738572, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/s0VGr.jpg?s=128&g=1", "display_name": "Greg Viers", "link": "https://stackoverflow.com/users/1738572/greg-viers"}, "edited": false, "score": 0, "creation_date": 1516219421, "post_id": 48309039, "comment_id": 83603758, "body": "An ugly loop may still perform well. If you want it stop after 2, you can add If i &gt; 2 Then Exit For after the i=i+1 line."}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 0, "creation_date": 1516219426, "post_id": 48309039, "comment_id": 83603761, "body": "I agree, it is not pretty......................perhaps we may get a more elegant answer."}, {"owner": {"reputation": 3028, "user_id": 558619, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/1618a853824f6ed866aa0fe4385b8687?s=128&d=identicon&r=PG", "display_name": "keynesiancross", "link": "https://stackoverflow.com/users/558619/keynesiancross"}, "edited": false, "score": 0, "creation_date": 1516219745, "post_id": 48309039, "comment_id": 83603918, "body": "I used this in the end. I changed Ticker to array, and just assigned to elements - so I can always loop through.  Thanks!"}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "reply_to_user": {"reputation": 3028, "user_id": 558619, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/1618a853824f6ed866aa0fe4385b8687?s=128&d=identicon&r=PG", "display_name": "keynesiancross", "link": "https://stackoverflow.com/users/558619/keynesiancross"}, "edited": false, "score": 0, "creation_date": 1516219812, "post_id": 48309039, "comment_id": 83603951, "body": "@keynesiancross  See my <b>EDIT#1</b>"}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "reply_to_user": {"reputation": 3028, "user_id": 558619, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/1618a853824f6ed866aa0fe4385b8687?s=128&d=identicon&r=PG", "display_name": "keynesiancross", "link": "https://stackoverflow.com/users/558619/keynesiancross"}, "edited": false, "score": 0, "creation_date": 1516220482, "post_id": 48309039, "comment_id": 83604307, "body": "@keynesiancross  See my <b>EDIT#2</b>"}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": true, "score": 3, "last_activity_date": 1516220459, "last_edit_date": 1516220459, "creation_date": 1516219062, "answer_id": 48309039, "question_id": 48308883, "link": "https://stackoverflow.com/questions/48308883/worksheet-selectionchangebyval-target-as-range-two-cells-in-target/48309039#48309039", "title": "Worksheet_SelectionChange(ByVal Target As Range), Two Cells in Target", "body": "<p>If you don't know if the User is going to select cells in a column or cells in a row, or even a block of cells, use a loop and counter:</p>\n\n<pre><code>Private Sub Worksheet_SelectionChange(ByVal Target As Range)\n    Dim r As Range, i As Long\n    i = 1\n    If Target.Count &gt; 1 Then\n        For Each r In Target\n            MsgBox r.Address(0, 0) &amp; vbCrLf &amp; i\n            i = i + 1\n        Next r\n    End If\nEnd Sub\n</code></pre>\n\n<p>Then process when <em>i=2</em>.  It will be the cell-to-the-right if a block or row is selected or the cell-below if part of a column is selected.</p>\n\n<p>While this is <strong>not</strong> pretty code, at least it will work, even if the User selects a disjoint set of cells.</p>\n\n<p><strong>EDIT#1:</strong></p>\n\n<p>You can avoid the ugly loop if you are willing to parse <code>Selection.Address</code></p>\n\n<p><strong>EDIT#2:</strong></p>\n\n<p>This code <em>(without any loops)</em> will work if the User selects 2 and only 2 cells:</p>\n\n<pre><code>Private Sub Worksheet_SelectionChange(ByVal Target As Range)\n    Dim s As String\n    If Target.Count = 2 Then\n        s = Split(Replace(Target.Address(0, 0), \":\", \",\"), \",\")(1)\n        MsgBox \"The second cell is: \" &amp; s\n    End If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3028, "user_id": 558619, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/1618a853824f6ed866aa0fe4385b8687?s=128&d=identicon&r=PG", "display_name": "keynesiancross", "link": "https://stackoverflow.com/users/558619/keynesiancross"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 242, "favorite_count": 0, "accepted_answer_id": 48309039, "answer_count": 1, "score": 2, "last_activity_date": 1516220459, "creation_date": 1516218495, "last_edit_date": 1516220299, "question_id": 48308883, "link": "https://stackoverflow.com/questions/48308883/worksheet-selectionchangebyval-target-as-range-two-cells-in-target", "title": "Worksheet_SelectionChange(ByVal Target As Range), Two Cells in Target", "body": "<p>I am using the event handler, and I run certain events if either one cell or two cells are selected.  The issue I'm having is, when two cells are selected, I don't know how to access the attributes of that 2nd cell (Ie, what it's value is).  Any idea how I can access the value of the 2nd cell thats selected (I was hoping Target would be an array object, and I could just select by array index....)</p>\n\n<pre><code>Public Sub Worksheet_SelectionChange(ByVal Target As Range)\n\nOn Error GoTo disError\nIf Target.Cells.Count &gt; 2 Or Target.Address = Range(\"DataHist\").Address Then Exit Sub\n\nDim curve As String\nDim Ticker As String\nDim TickerTwo As String\nDim lastValue As Double\nTickerTwo = \"\"\n\nIf Target.Cells.Count = 1 Then\n    Ticker = Target.Value\n    lastValue = Round(Target.Offset(0, 1).Value, 3)\n    curve = CheckLabel(Target)\nElse\n    ' This is where the issue is --------------------------------\n    Ticker = Target.Cells(1, 1).Value\n    TickerTwo = Target.Next.Value\n    lastValue = Round(Target.Offset(0, 1).Value, 3)\n    curve = CheckLabel(Target)\n    ' -----------------------------------------------------------\nEnd If\n\nSelect Case curve\n    Case \"na\"\n        Exit Sub\n    Case \"Test1\"\n        Call FillChart(\"Test1\", Ticker, lastValue, TickerTwo)\n    Case \"Test2\"\n        Call FillChart(\"Test2\", Ticker, lastValue, TickerTwo)\n\nEnd Select\n\ndisError:\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "if-statement", "excel-formula", "isnumeric"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1516218633, "post_id": 48308855, "comment_id": 83603298, "body": "remove the <code>=</code> after the first one."}, {"owner": {"reputation": 3311, "user_id": 6147374, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d05b5955de351d18e1c8d715f97f0be2?s=128&d=identicon&r=PG&f=1", "display_name": "Ibo", "link": "https://stackoverflow.com/users/6147374/ibo"}, "edited": false, "score": 0, "creation_date": 1516219037, "post_id": 48308855, "comment_id": 83603537, "body": "also <code>IsNumeric</code> is a VBA function. Its equivalent function is <code>IsNumber</code>"}], "answers": [{"comments": [{"owner": {"reputation": 3311, "user_id": 6147374, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d05b5955de351d18e1c8d715f97f0be2?s=128&d=identicon&r=PG&f=1", "display_name": "Ibo", "link": "https://stackoverflow.com/users/6147374/ibo"}, "reply_to_user": {"reputation": 9, "user_id": 9231470, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46c8df6160ecd5b832ea35763b89c56d?s=128&d=identicon&r=PG&f=1", "display_name": "Ash", "link": "https://stackoverflow.com/users/9231470/ash"}, "edited": false, "score": 0, "creation_date": 1516218994, "post_id": 48308930, "comment_id": 83603510, "body": "please check it as the right answer then! :) upper left corner checkmark ;)"}], "tags": [], "owner": {"reputation": 3311, "user_id": 6147374, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d05b5955de351d18e1c8d715f97f0be2?s=128&d=identicon&r=PG&f=1", "display_name": "Ibo", "link": "https://stackoverflow.com/users/6147374/ibo"}, "is_accepted": true, "score": 2, "last_activity_date": 1516336856, "last_edit_date": 1516336856, "creation_date": 1516218703, "answer_id": 48308930, "question_id": 48308855, "link": "https://stackoverflow.com/questions/48308855/using-isnumeric-function-in-a-formula/48308930#48308930", "title": "Using IsNumeric Function in a Formula", "body": "<p>Your formula is wrong, use this:</p>\n\n<pre><code>ActiveCell.FormulaR1C1 = \"=IF(IsNumber(RC[-2]),RC[-2]*RC[-1],RC[-1])\"\n</code></pre>\n\n<p>Note that <code>IsNumeric</code> is a VBA function and its equivalent in Excel functions is <code>IsNumber</code>. Sometimes functions have different names for Excel and VBA, this is one of the cases.</p>\n"}], "owner": {"reputation": 9, "user_id": 9231470, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46c8df6160ecd5b832ea35763b89c56d?s=128&d=identicon&r=PG&f=1", "display_name": "Ash", "link": "https://stackoverflow.com/users/9231470/ash"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 148, "favorite_count": 0, "accepted_answer_id": 48308930, "answer_count": 1, "score": 0, "last_activity_date": 1516336856, "creation_date": 1516218355, "last_edit_date": 1516220362, "question_id": 48308855, "link": "https://stackoverflow.com/questions/48308855/using-isnumeric-function-in-a-formula", "title": "Using IsNumeric Function in a Formula", "body": "<p>I was wondering if anyone had any suggestions for what I'm doing wrong, or if it's even possible.</p>\n\n<p>I am working with 3 columns:\nColumn X = # of Services, Column Y = # of Bills, and Column Z which is a calculation of X divided by Y.</p>\n\n<p>Sometimes, there is a text entry in Column X - when that happens, I want Column Z to simply reflect what Column Y contains.</p>\n\n<p>Here is the code I've written...  I've tried (seemingly) all possible combinations of quotation marks and parentheses, to no avail.</p>\n\n<pre><code>ActiveCell.FormulaR1C1 = _\n    \"=IF(IsNumeric(RC[-2]),=RC[-2]/RC[-1],=RC[-1])\"\n</code></pre>\n\n<p>Thank you!</p>\n"}, {"tags": ["excel", "email", "url", "hyperlink", "vba"], "comments": [{"owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "edited": false, "score": 0, "creation_date": 1516217963, "post_id": 48308709, "comment_id": 83602940, "body": "Care to share the error and the code that&#39;s causing you issues?"}, {"owner": {"reputation": 11, "user_id": 9231478, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/054d9c475b8b15df0d1bb68d3e8fcf3a?s=128&d=identicon&r=PG&f=1", "display_name": "Toya ", "link": "https://stackoverflow.com/users/9231478/toya"}, "reply_to_user": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "edited": false, "score": 0, "creation_date": 1516218507, "post_id": 48308709, "comment_id": 83603240, "body": "compile error: sub or function not defined"}, {"owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "edited": false, "score": 2, "creation_date": 1516218633, "post_id": 48308709, "comment_id": 83603297, "body": "Again we would need to see part of your code. Because you are trying to make a call to a sub that doesn&#39;t exist. You need to add <code>Option Explicit</code> to the top of your module. You need to ensure you are declaring all of your variables. But it&#39;s 100% impossible for anyone to tell you exactly what your issue is without seeing some code."}, {"owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "edited": false, "score": 0, "creation_date": 1516218712, "post_id": 48308709, "comment_id": 83603330, "body": "You are more than welcome to replace any personal information (and it&#39;s strongly recommended that you do), such as website addresses like you did above. But the replacements need to match the general idea of what you are wanting to accomplish."}, {"owner": {"reputation": 11, "user_id": 9231478, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/054d9c475b8b15df0d1bb68d3e8fcf3a?s=128&d=identicon&r=PG&f=1", "display_name": "Toya ", "link": "https://stackoverflow.com/users/9231478/toya"}, "reply_to_user": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "edited": false, "score": 0, "creation_date": 1516218778, "post_id": 48308709, "comment_id": 83603372, "body": "correction. It is giving me a syntax error"}, {"owner": {"reputation": 11, "user_id": 9231478, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/054d9c475b8b15df0d1bb68d3e8fcf3a?s=128&d=identicon&r=PG&f=1", "display_name": "Toya ", "link": "https://stackoverflow.com/users/9231478/toya"}, "reply_to_user": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "edited": false, "score": 0, "creation_date": 1516219343, "post_id": 48308709, "comment_id": 83603704, "body": "Email_Body = &quot;Dear &quot; &amp; name &amp; &quot;,&quot; &amp; Chr(11) _        &amp; &quot;Thank you for you question &quot; &amp; Chr(11) _        &amp; &quot;We will get back to you within 24 hours.&quot; &amp; Chr(11)        &amp; &quot;IMPORTANT: Please remember to you may find answers to your question on our website: <a href=\"https://forhelp.com\" rel=\"nofollow noreferrer\">forhelp.com</a>. If you do not find a solution here.&quot; &amp; Char(11) _        &amp; &quot;Please refer to Instructions available on the our intranet: <a href=\"https://developer.com/faq/\" rel=\"nofollow noreferrer\">developer.com/faq</a>.&quot; &amp; Char(11) _        &amp; &quot;All listed answers are not perfect.&quot; &amp; questions &amp; chr(11)"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "edited": false, "score": 0, "creation_date": 1516225459, "post_id": 48308709, "comment_id": 83606702, "body": "@K.Davis The line continuation character can come anywhere within the statement (other than in the middle of a token) so <code>_ &amp;</code> is as good as <code>&amp; _</code>."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1516225578, "post_id": 48308709, "comment_id": 83606758, "body": "@Toya Please update the question using the <a href=\"https://stackoverflow.com/posts/48308709/edit\">edit</a> link you will find just below it, and include the code there - it is nearly impossible to correctly read code written in comments."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1516225853, "post_id": 48308709, "comment_id": 83606880, "body": "FWIW, your syntax error is probably due to the <code>;</code> after the string literal <code>&quot;Please refer to Instructions available on the our intranet: developer.com&#47;faq&#47;.&quot;</code>, and your sub or function not defined is due to your <code>Char</code> function calls. (Do you have a function called <code>Char</code>, or is that a typo?)"}], "answers": [{"tags": [], "owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "is_accepted": false, "score": 1, "last_activity_date": 1516226517, "last_edit_date": 1516226517, "creation_date": 1516219797, "answer_id": 48309226, "question_id": 48308709, "link": "https://stackoverflow.com/questions/48308709/simply-have-link-to-url-in-email-sent-from-excel/48309226#48309226", "title": "Simply have link to URL in email sent from Excel", "body": "<p>Try this:</p>\n\n<pre><code>Email_Body = \"Dear \" &amp; Name &amp; \",\" &amp; Chr(11) &amp; _\n    \"Thank you for you question \" &amp; Chr(11) &amp; _\n    \"We will get back to you within 24 hours.\" &amp; _\n    Chr(11) &amp; \"IMPORTANT: Please remember to \" &amp; _\n    \"you may find answers to your question on \" &amp; _\n    \"our website: forhelp.com. If you do not \" &amp; _\n    \"find a solution here.\" &amp; Chr(11) &amp; _\n    \"Please refer to Instructions available on the \" &amp; _\n    \"our intranet: developer.com/faq/.;\" &amp; Chr(11) &amp; _\n    \"All listed answers are not perfect.\" &amp; questions &amp; Chr(11)\n</code></pre>\n\n<p>If you still have issues, ensure that <code>Name</code> &amp; <code>questions</code> are properly declared variables.</p>\n\n<p>Also, Ensure that <code>Email_Body</code> is assigned to your outlook object. It should look something like:</p>\n\n<pre><code>With OutApp.CreateItem(0)\n    .Email_Body = ...\nEnd With\n</code></pre>\n\n<p>with <code>OutApp</code> being the object referencing your outlook application/email.</p>\n"}], "owner": {"reputation": 11, "user_id": 9231478, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/054d9c475b8b15df0d1bb68d3e8fcf3a?s=128&d=identicon&r=PG&f=1", "display_name": "Toya ", "link": "https://stackoverflow.com/users/9231478/toya"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 57, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1516226517, "creation_date": 1516217798, "last_edit_date": 1531161705, "question_id": 48308709, "link": "https://stackoverflow.com/questions/48308709/simply-have-link-to-url-in-email-sent-from-excel", "title": "Simply have link to URL in email sent from Excel", "body": "<p>This seems simple enough. I am sending an email from Excel using a Macros. In the body of the email there is a web address. </p>\n\n<p>Example:</p>\n\n<p>For helpful hints on coding go to our website: https:stackoverflow.com or visit https:google.com</p>\n\n<p>I keep getting a compile error. I would like the person receiving the email to be able to click on the address and link to the website. </p>\n\n<p>Thanks</p>\n"}, {"tags": ["vba", "excel"], "owner": {"reputation": 65, "user_id": 8626617, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/7ffab6aed6a0b0d884d7dbec1476e0cc?s=128&d=identicon&r=PG&f=1", "display_name": "Seva Arve", "link": "https://stackoverflow.com/users/8626617/seva-arve"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 58, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1516217318, "creation_date": 1516216833, "last_edit_date": 1516217318, "question_id": 48308484, "link": "https://stackoverflow.com/questions/48308484/dynamic-query-vba-how-add-value-to-column-from-one-query-to-second", "title": "Dynamic query VBA How add value to column from one query to second", "body": "<p>I have data in excel Sheet(\"CustomReport\"):</p>\n\n<pre><code> SalesOrder  Value1      Value2      Value3     Links\n 1           Jonas       Station1    8          https://x.com=1\n 2           Greg        Station1    5          https://x.com=2\n 3           Anton       Station1    1          https://x.com=3\n ...         ...         ...         ...        ...\n</code></pre>\n\n<p>Number of rows in this query is always different when it is refreshed</p>\n\n<p>And based on this webquery I generate dynamic webquery in macro. For example: DynamicQuery1 save data from report <a href=\"https://x.com=1\" rel=\"nofollow noreferrer\">https://x.com=1</a> to Sheet name \"Orders\" started from A1 and ending A{X} value (reports have diffrents number of rows).</p>\n\n<p>DynamicQuery2 save data from report <a href=\"https://x.com=2\" rel=\"nofollow noreferrer\">https://x.com=2</a> to the same Sheet \"Orders\" but started from A{X+1}.</p>\n\n<p>This is the macro:</p>\n\n<pre><code>Sub Test()\n    Application.DisplayAlerts = False\n    ThisWorkbook.Sheets(\"Orders\").Delete\n    Application.DisplayAlerts = True\n    ThisWorkbook.Sheets.Add.Name = \"Orders\"\n    Dim c As Range, DataSpot As Range\n    Set c = Sheets(\"CustomReport\").Range(\"E2\")\n    While c.Value &lt;&gt; \"\"\n\n    Dim URL As String\n    URL = c.Value\n        Set DataSpot = Cells(Sheets(\"Orders\").Range(\"A1\").SpecialCells(xlLastCell).Row + 1, 1)\n\n\n                    Sheets(\"Orders\").Select\n                    With ActiveSheet.QueryTables.Add(Connection:=\"URL;\" &amp; URL, Destination:=Range(DataSpot.Address))\n                        .Name = \"team2289_2\"\n                        .FieldNames = True\n                        .RowNumbers = False\n                        .FillAdjacentFormulas = False\n                        .PreserveFormatting = False\n                        .RefreshOnFileOpen = False\n                        .BackgroundQuery = True\n                        .RefreshStyle = xlOverwriteCells\n                        .SavePassword = False\n                        .SaveData = True\n                        .AdjustColumnWidth = True\n                        .RefreshPeriod = 0\n                        .WebSelectionType = xlEntirePage\n                        .WebFormatting = xlWebFormattingAll\n                        .WebPreFormattedTextToColumns = True\n                        .WebConsecutiveDelimitersAsOne = True\n                        .WebSingleBlockTextImport = False\n                        .WebDisableDateRecognition = True\n                        .WebDisableRedirections = False\n                        .Refresh BackgroundQuery:=False\n                    End With\n        Set c = c.Offset(1, 0)\n    Wend\n\n\nEnd Sub \n</code></pre>\n\n<p>And now i need add new formula to this macro.\nThis is structure reports from \"Links\"</p>\n\n<p>Example Sheets from sheet \"Orders\"</p>\n\n<pre><code>WorkOrder  ID          Item2       Column4    Level3    &lt;----- Report Sales Order 1 \nNumber4    TOPLEVEL    Jonas       Station1   5\n212121212  2           Station1    5          2\n31212121   3           Station1    1          4\n...         ...         ...         ...        ...\n\nTextSome   TOPLEVEL    Jonas       Station1   5         &lt;----- Report Sales Order 2\n212121212  2           Station1    5          2\n31212121   3           Station1    1          4\n...         ...         ...         ...        ...\n\n...        ...          ...         ...        ...&lt;----- Report Sales Order 3\n\nDADADA   TOPLEVEL    Jonas       Station1   5         &lt;----- Report Sales Order 4\n212121212  2           Station1    5          2\n31212121   3           Station1    1          4\n...         ...         ...         ...        ...\n</code></pre>\n\n<p>I need add formula, when every loop make, makro add to new column value from workorder, where ID=\"TOPLEVEL\", but if report dont exist then put blank value.</p>\n\n<pre><code>   SalesOrder    Value1    Value2      Value3     Links             WOTOP\n   1             Jonas     Station1    8          https://x.com=1   Number4\n   2             Greg      Station1    5          https://x.com=2   TextSome\n   3             Anton     Station1    1          https://x.com=3   blank\n   4             Anton     Station1    1          https://x.com=3   DADA\n   ...           ...         ...         ...        ...\n</code></pre>\n\n<p>`</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1516217070, "post_id": 48308471, "comment_id": 83602462, "body": "Your problem is this: <code>wsO.Range(&quot;AL&quot; &amp; Lines)</code> you have not declared or assigned a value to <code>Lines</code>.  Also you will want to include the whole range of the table and not just that one column: <code>wsO.Range(&quot;A1:AL&quot; &amp; Lines)</code> but you need to put a value in Lines."}, {"owner": {"reputation": 1941, "user_id": 1267370, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/32MVo.jpg?s=128&g=1", "display_name": "mooseman", "link": "https://stackoverflow.com/users/1267370/mooseman"}, "edited": false, "score": 0, "creation_date": 1516217112, "post_id": 48308471, "comment_id": 83602487, "body": "What is the variable &quot;lines&quot;?"}, {"owner": {"reputation": 65, "user_id": 9226292, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d3e330dd3e73989c0297a31bed9d7b72?s=128&d=identicon&r=PG&f=1", "display_name": "J Doe", "link": "https://stackoverflow.com/users/9226292/j-doe"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1516217420, "post_id": 48308471, "comment_id": 83602624, "body": "@ScottCraner I&#39;m not sure what value Lines should be...that part I inserted from someone else&#39;s code.  If I remove the Lines and adjust it to be `wsO.Range(&quot;A1:AL&quot;) I still receive the same error.  Is there another issue with my code?"}], "answers": [{"comments": [{"owner": {"reputation": 65, "user_id": 9226292, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d3e330dd3e73989c0297a31bed9d7b72?s=128&d=identicon&r=PG&f=1", "display_name": "J Doe", "link": "https://stackoverflow.com/users/9226292/j-doe"}, "edited": false, "score": 0, "creation_date": 1516217579, "post_id": 48308621, "comment_id": 83602722, "body": "I have tried to run your code now - it looks like it worked but now something else is off.  I&#39;m getting the error &quot;AutoFilter method of Range class failed&quot;"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 65, "user_id": 9226292, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d3e330dd3e73989c0297a31bed9d7b72?s=128&d=identicon&r=PG&f=1", "display_name": "J Doe", "link": "https://stackoverflow.com/users/9226292/j-doe"}, "edited": false, "score": 1, "creation_date": 1516217755, "post_id": 48308621, "comment_id": 83602818, "body": "Missing a <code>:</code> and AL is the 23 column in the area not the 22nd.  @JDoe"}, {"owner": {"reputation": 65, "user_id": 9226292, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d3e330dd3e73989c0297a31bed9d7b72?s=128&d=identicon&r=PG&f=1", "display_name": "J Doe", "link": "https://stackoverflow.com/users/9226292/j-doe"}, "edited": false, "score": 0, "creation_date": 1516218218, "post_id": 48308621, "comment_id": 83603073, "body": "When I run the new code, it pops up &quot;No cells found&quot; then after clicking OK, it filters column AL for &quot;1&quot; but does not delete those rows then does not show all rows after.  My headers are located on P12:AC13 so I changed the <code>P2:AL</code> to be <code>P13:AL</code> and <code>P3:AL</code> to <code>P14:AL</code>.  Would that have screwed it up?"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 65, "user_id": 9226292, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d3e330dd3e73989c0297a31bed9d7b72?s=128&d=identicon&r=PG&f=1", "display_name": "J Doe", "link": "https://stackoverflow.com/users/9226292/j-doe"}, "edited": false, "score": 1, "creation_date": 1516218598, "post_id": 48308621, "comment_id": 83603281, "body": "The code above works for me, without issue, so I don&#39;t know what problems you are having. @JDoe"}, {"owner": {"reputation": 65, "user_id": 9226292, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d3e330dd3e73989c0297a31bed9d7b72?s=128&d=identicon&r=PG&f=1", "display_name": "J Doe", "link": "https://stackoverflow.com/users/9226292/j-doe"}, "edited": false, "score": 0, "creation_date": 1516218834, "post_id": 48308621, "comment_id": 83603401, "body": "I clicked debug upon error and it highlights this line: <code>.Range(&quot;P14:AL&quot; &amp; Lines).SpecialCells(xlCellTypeVisible).EntireRow.Delete</code>."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 65, "user_id": 9226292, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d3e330dd3e73989c0297a31bed9d7b72?s=128&d=identicon&r=PG&f=1", "display_name": "J Doe", "link": "https://stackoverflow.com/users/9226292/j-doe"}, "edited": false, "score": 1, "creation_date": 1516218902, "post_id": 48308621, "comment_id": 83603447, "body": "yes for some reason it is not finding any <code>1</code> in the column so when it filters there are no visible rows. @JDoe"}, {"owner": {"reputation": 65, "user_id": 9226292, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d3e330dd3e73989c0297a31bed9d7b72?s=128&d=identicon&r=PG&f=1", "display_name": "J Doe", "link": "https://stackoverflow.com/users/9226292/j-doe"}, "edited": false, "score": 0, "creation_date": 1516219153, "post_id": 48308621, "comment_id": 83603607, "body": "ahhhh that explains it...is there a code I can add so that if there is no <code>1</code> in the column, continue onto the next line of code?  I did not include the full code here because it involves work related information."}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 1, "last_activity_date": 1516220186, "last_edit_date": 1516220186, "creation_date": 1516217375, "answer_id": 48308621, "question_id": 48308471, "link": "https://stackoverflow.com/questions/48308471/filtering-on-value-and-deleting-visible-rows/48308621#48308621", "title": "Filtering on value and deleting visible rows", "body": "<p>Your problem is this: </p>\n\n<blockquote>\n  <p><code>wsO.Range(\"AL\" &amp; Lines)</code> </p>\n</blockquote>\n\n<p>You have not declared or assigned a value to <code>Lines</code>.  </p>\n\n<p>Also you will want to include the whole range of the table and not just that one column: </p>\n\n<pre><code>wsO.Range(\"P2:AL\" &amp; Lines)\n</code></pre>\n\n<p>So:</p>\n\n<pre><code>Sub copypaste()\n\nDim c As Range\nDim IRow As Long, lastrow As Long\nDim rSource As Range\nDim wsI As Worksheet, wsO As Worksheet\nDim endrow As Long\nDim Lines As Long\n\nSet wsI = ThisWorkbook.Sheets(\"Sheet2\")\nSet wsO = ThisWorkbook.Sheets(\"Sheet1\")\n\nApplication.ScreenUpdating = False\n\n\nWith wsO\n    Lines = .Cells(.Rows.Count, \"P\").End(xlUp).Row\n    .Range(\"P13:AL\" &amp; Lines).AutoFilter field:=23, Criteria1:=\"1\"\n    On Error Resume Next\n        .Range(\"P14:AL\" &amp; Lines).SpecialCells(xlCellTypeVisible).EntireRow.Delete\n    On Error Goto 0\n    .ShowAllData\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 65, "user_id": 9226292, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d3e330dd3e73989c0297a31bed9d7b72?s=128&d=identicon&r=PG&f=1", "display_name": "J Doe", "link": "https://stackoverflow.com/users/9226292/j-doe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 301, "favorite_count": 0, "accepted_answer_id": 48308621, "answer_count": 1, "score": 0, "last_activity_date": 1516220186, "creation_date": 1516216787, "last_edit_date": 1516218062, "question_id": 48308471, "link": "https://stackoverflow.com/questions/48308471/filtering-on-value-and-deleting-visible-rows", "title": "Filtering on value and deleting visible rows", "body": "<p>I have some code that doesn't work like I think it would.  It is supposed to filter on column AL for \"1\", then delete all rows that are visible, then show all rows afterwards.  My data starts in column P and I counted that column AL is 23 columns away from P so I put 23 for the field. I have headers in the first 3 rows so I have set it to offset 3 rows.  </p>\n\n<p>When I run it, it says </p>\n\n<blockquote>\n  <p>Method 'Range' of object '_Worksheet' failed</p>\n</blockquote>\n\n<p>I'm a beginner at VBA so I'm still learning but I'm just not sure what part of this is causing the error.  I tried everything I could think of to my limited ability.  As far as I can tell...it should work based on Googling other people's code that was similar.</p>\n\n<p>This is the section of code in question:</p>\n\n<pre><code>Sub copypaste()\n\nDim c As Range\nDim IRow As Long, lastrow As Long\nDim rSource As Range\nDim wsI As Worksheet, wsO As Worksheet\nDim endrow As Long\n\n\nSet wsI = ThisWorkbook.Sheets(\"Sheet2\")\n\nSet wsO = ThisWorkbook.Sheets(\"Sheet1\")\n\nApplication.ScreenUpdating = False\n\n\nWith wsO\n\nwsO.Range(\"AL\" &amp; Lines).AutoFilter Field = 22, Criteria1:=\"1\"\nwsO.Range(\"AL\" &amp; Lines).Offset(3, 0).SpecialCells _\n(xlCellTypeVisible).EntireRow.Delete\nwsO.ShowAllData\n\nEnd With\n</code></pre>\n"}, {"tags": ["javascript", "excel", "google-apps-script", "google-sheets", "vba"], "answers": [{"comments": [{"owner": {"reputation": 1972, "user_id": 1304458, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/dc6ea084fbd20a88381173e9aaf4de00?s=128&d=identicon&r=PG", "display_name": "xyz", "link": "https://stackoverflow.com/users/1304458/xyz"}, "edited": false, "score": 0, "creation_date": 1516291901, "post_id": 48309095, "comment_id": 83636685, "body": "Thanks Ruben, I will see if I can get somewhere from your comments"}], "tags": [], "owner": {"reputation": 23873, "user_id": 1595451, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/08TCi.jpg?s=128&g=1", "display_name": "Rub&#233;n", "link": "https://stackoverflow.com/users/1595451/rub%c3%a9n"}, "is_accepted": false, "score": 0, "last_activity_date": 1516219276, "creation_date": 1516219276, "answer_id": 48309095, "question_id": 48307846, "link": "https://stackoverflow.com/questions/48307846/rearrange-multiple-columns-on-sheet-with-google-script/48309095#48309095", "title": "Rearrange multiple columns on sheet with Google script", "body": "<p>On this line</p>\n\n<pre><code>var data = sheet.getDataRange().getValues();\n</code></pre>\n\n<p>data gets a 2D array, but later the script handled it as 1D array. In other words, to reference a cell value, instead of <code>data[index]</code> use something like <code>data[row][column]</code>.</p>\n\n<p>A single equal sign <code>=</code> is use to assign an object/literal to a variable so this <code>headers[F] = data[j]</code> instead of doing a comparison replaces the value of <code>headers[F]</code> by the object of <code>data[j]</code> which initially is an array.</p>\n"}, {"comments": [{"owner": {"reputation": 1972, "user_id": 1304458, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/dc6ea084fbd20a88381173e9aaf4de00?s=128&d=identicon&r=PG", "display_name": "xyz", "link": "https://stackoverflow.com/users/1304458/xyz"}, "edited": false, "score": 0, "creation_date": 1516291818, "post_id": 48309746, "comment_id": 83636623, "body": "Cooper thanks for the response, I copied your code and made the loop replacement.  The code ran without error but nothing changed i.e no columns were moved.  If I understand your code at all I think the 2nd loop is removing the wrong columns? I tried to fix it but no luck"}, {"owner": {"reputation": 1972, "user_id": 1304458, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/dc6ea084fbd20a88381173e9aaf4de00?s=128&d=identicon&r=PG", "display_name": "xyz", "link": "https://stackoverflow.com/users/1304458/xyz"}, "edited": false, "score": 0, "creation_date": 1516294412, "post_id": 48309746, "comment_id": 83638299, "body": "<code>I assumed that the numbers in first3 array are column numbers starting from 1</code> Yes correct.  This might be more telling if  <code>first3 = [5,4,1]</code> so after running function I should get <code>Col1 &gt;&gt; Col5</code>,  <code>Col2 &gt;&gt; Col4</code> and     <code>Col3 &gt;&gt; Col1</code> but after I cun the function nothing changes.  Am I miss-understanding something"}, {"owner": {"reputation": 34507, "user_id": 7215091, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/2pNI4.jpg?s=128&g=1", "display_name": "MetaMan", "link": "https://stackoverflow.com/users/7215091/metaman"}, "reply_to_user": {"reputation": 1972, "user_id": 1304458, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/dc6ea084fbd20a88381173e9aaf4de00?s=128&d=identicon&r=PG", "display_name": "xyz", "link": "https://stackoverflow.com/users/1304458/xyz"}, "edited": false, "score": 0, "creation_date": 1516296004, "post_id": 48309746, "comment_id": 83639240, "body": "I did find an error in the second loop.  Try it again.  And I changed the sheet name"}, {"owner": {"reputation": 34507, "user_id": 7215091, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/2pNI4.jpg?s=128&g=1", "display_name": "MetaMan", "link": "https://stackoverflow.com/users/7215091/metaman"}, "reply_to_user": {"reputation": 1972, "user_id": 1304458, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/dc6ea084fbd20a88381173e9aaf4de00?s=128&d=identicon&r=PG", "display_name": "xyz", "link": "https://stackoverflow.com/users/1304458/xyz"}, "edited": false, "score": 0, "creation_date": 1516297327, "post_id": 48309746, "comment_id": 83640039, "body": "Thanks for the question."}], "tags": [], "owner": {"reputation": 34507, "user_id": 7215091, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/2pNI4.jpg?s=128&g=1", "display_name": "MetaMan", "link": "https://stackoverflow.com/users/7215091/metaman"}, "is_accepted": true, "score": 1, "last_activity_date": 1516297224, "last_edit_date": 1516297224, "creation_date": 1516222109, "answer_id": 48309746, "question_id": 48307846, "link": "https://stackoverflow.com/questions/48307846/rearrange-multiple-columns-on-sheet-with-google-script/48309746#48309746", "title": "Rearrange multiple columns on sheet with Google script", "body": "<p>Try  this:</p>\n\n<pre><code>function moveColumns() {\n  var sh=SpreadsheetApp.getActiveSpreadsheet().getSheetByName(\"Elements\");\n  var rg= sh.getDataRange()\n  var vA=rg.getValues();\n  var vB=[];\n  var first3 = [8,7,6,5];\n  var first3desc=first3.slice();\n  first3desc.sort(function(a, b){return b-a;});\n  for(var i=0;i&lt;vA.length;i++){\n    var row=vA[i];\n    for(var j=0;j&lt;first3.length;j++){\n      row.splice(j,0,vA[i][first3[j]-1+j]);\n    }\n    for(var j=0;j&lt;first3desc.length;j++){\n      var c=first3desc[j]-1+first3.length;//for debugging\n      row.splice(first3desc[j]-1+first3.length,1);\n    }\n    vB.push(row);\n  }\n  sh.getRange(1,1,vB.length,vB[0].length).setValues(vB);\n}   \n</code></pre>\n\n<p>Here's the function as I run it this time.</p>\n\n<pre><code>function moveColumns() {\n  var sh=SpreadsheetApp.getActiveSpreadsheet().getSheetByName(\"Elements\");\n  var rg= sh.getDataRange()\n  var vA=rg.getValues();\n  var vB=[];\n  var first3 = [8,7,6,5,4,3,2,1];\n  var first3desc=first3.slice();\n  first3desc.sort(function(a, b){return b-a;});\n  for(var i=0;i&lt;vA.length;i++){\n    var row=vA[i];\n    for(var j=0;j&lt;first3.length;j++){\n      row.splice(j,0,vA[i][first3[j]-1+j]);\n    }\n    for(var j=0;j&lt;first3desc.length;j++){\n      var c=first3desc[j]-1+first3.length;\n      row.splice(first3desc[j]-1+first3.length,1);\n    }\n    vB.push(row);\n  }\n  sh.getRange(1,1,vB.length,vB[0].length).setValues(vB);\n}   \n</code></pre>\n\n<p>My \"Elements\" sheet before:</p>\n\n<p><a href=\"https://i.stack.imgur.com/TTy5g.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/TTy5g.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>My \"Elements\" sheet after:</p>\n\n<p><a href=\"https://i.stack.imgur.com/O8r2C.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/O8r2C.jpg\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 1972, "user_id": 1304458, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/dc6ea084fbd20a88381173e9aaf4de00?s=128&d=identicon&r=PG", "display_name": "xyz", "link": "https://stackoverflow.com/users/1304458/xyz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 982, "favorite_count": 0, "accepted_answer_id": 48309746, "answer_count": 2, "score": 1, "last_activity_date": 1516297224, "creation_date": 1516214203, "last_edit_date": 1531161705, "question_id": 48307846, "link": "https://stackoverflow.com/questions/48307846/rearrange-multiple-columns-on-sheet-with-google-script", "title": "Rearrange multiple columns on sheet with Google script", "body": "<p>I am trying to convert a VBA macro that rearranges columns on a sheet from an array of column indices to a Google script</p>\n\n<p>I want to return all columns but with the columns listed in the array as the first 3 columns and all the other columns in their same order</p>\n\n<p>The original vba is using header names but I am using column indices</p>\n\n<p>I get error <code>Incorrect range height, was 1 but should be 24</code></p>\n\n<p>I have no idea if there are other issues as well</p>\n\n<p>Thanks in advance</p>\n\n<p>Here is what I have</p>\n\n<pre><code>function myFunction() {\nvar sheet =SpreadsheetApp.getActiveSpreadsheet().getSheetByName(\"Elements\");\nvar data = sheet.getDataRange().getValues();\nvar LC = sheet.getLastColumn();\nvar LR = sheet.getLastRow();\n\nvar headers = [4,2,3]; //array of colunm indices\nvar temp = [];\n\nvar Dex = 0\nfor (var i = 0; i &lt; LC; i++) {\n  for(var j = 0; j &lt; LC; j++) { \n    for (var F = 0; F &lt; headers.length - 1; F++) {\n      if (headers[F] = data[j]) {\n           Dex = F\n           break;\n       };\n     }\n\n      if (F &lt; i) {\n         temp = data.indexOf(i);\n         data[i] = data.indexOf(j)\n         data[j] = temp\n        }\n    };\n   };\n\n  sheet.getRange(1, 1, LC,LR).setValues([data])\n}   \n</code></pre>\n\n<p>Here is the vba</p>\n\n<pre><code>Sub vba()\nDim rng As Range\nDim i As Integer\nDim J As Integer\nDim Temp\nDim nams As Variant\nDim F\nDim Dex As Integer\n\nnams = Array(\"ItemID\", \"FirstName\", \"LastName\", \"Year\")\nSet rng = Range(\"A1\").CurrentRegion\n\n    For i = 1 To rng.Columns.Count\n    For J = i To rng.Columns.Count\n        For F = 0 To UBound(nams)\n            If nams(F) = rng(J) Then Dex = F: Exit For\n        Next F\n        If F &lt; i Then\n            Temp = rng.Columns(i).Value\n            rng(i).Resize(rng.Rows.Count) = rng.Columns(J).Value\n            rng(J).Resize(rng.Rows.Count) = Temp\n        End If\n    Next J\nNext i\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 2, "creation_date": 1516213979, "post_id": 48307766, "comment_id": 83600852, "body": "<code>TextBox1 = Format(TextBox1, &quot;0&quot;)</code>"}, {"owner": {"reputation": 95, "user_id": 6329908, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/JeqIQ.jpg?s=128&g=1", "display_name": "Kasra", "link": "https://stackoverflow.com/users/6329908/kasra"}, "reply_to_user": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1516255103, "post_id": 48307766, "comment_id": 83615033, "body": "Thank you Dear @braX ,, but after writing the code the number lost the Separator for Thousand group! I need Separator Group + without Decimal Place together. do you have any idea?"}, {"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 1, "creation_date": 1516280924, "post_id": 48307766, "comment_id": 83629309, "body": "TextBox1.Text = Format(TextBox1.Text, &quot;#,###,###,##0&quot;)"}, {"owner": {"reputation": 95, "user_id": 6329908, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/JeqIQ.jpg?s=128&g=1", "display_name": "Kasra", "link": "https://stackoverflow.com/users/6329908/kasra"}, "reply_to_user": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1516303377, "post_id": 48307766, "comment_id": 83643271, "body": "Well done braX ,, Thank you, it&#39;s worked properly ... :)"}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "edited": false, "score": 1, "creation_date": 1516215826, "post_id": 48308152, "comment_id": 83601811, "body": "This will returning the decimal part of the string not the integer part."}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 0, "creation_date": 1516215883, "post_id": 48308152, "comment_id": 83601843, "body": "@ThomasInzina  OUCH!  Thanks  I will fix"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 2, "creation_date": 1516215994, "post_id": 48308152, "comment_id": 83601919, "body": "FYI: Raises an index out of range if user backspaces to a 0-length string. <code>Format</code> seems more reliable."}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 1, "creation_date": 1516216128, "post_id": 48308152, "comment_id": 83601990, "body": "@DavidZemens  good point...........should we end up with a null string or a zero??"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1516216472, "post_id": 48308152, "comment_id": 83602145, "body": "Note: both methods effectively prevent the user from inputting the decimal, but they don&#39;t truncate or round the (presumably numeric) value, so if the user is trying to enter <code>123.54</code> the resulting value will be <code>12354</code> when probably you want either of <code>124</code> (round) or <code>123</code> (trunc). Relying on _Change event for validation has some limitations :D and probably this value should be validated/manipulated by whatever other procedure is using it as an input."}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1516216662, "post_id": 48308152, "comment_id": 83602247, "body": "@Mat&#39;sMug  you are correct! ...............the <code>Split()</code> separator must match the locale."}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1516217999, "post_id": 48308152, "comment_id": 83602962, "body": "@Mat&#39;sMug  See my <b>EDIT#1</b>"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1516218521, "post_id": 48308152, "comment_id": 83603251, "body": "IMO it&#39;s an X-Y problem (see answer below)"}, {"owner": {"reputation": 95, "user_id": 6329908, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/JeqIQ.jpg?s=128&g=1", "display_name": "Kasra", "link": "https://stackoverflow.com/users/6329908/kasra"}, "edited": false, "score": 0, "creation_date": 1516261403, "post_id": 48308152, "comment_id": 83617532, "body": "Thank you for your idea,,,, I forgot something small ... this TextBox is not an input data entrance, in fact, it is an output display for a hidden cell. It related to a cell (&quot;B15&quot;) that the cell is set on Separator Thousand Group (On) and No Decimal Place (Off). But the TextBox1 shows the Numbers with Separator T.Group (On) with Decimal Place (On). I need a syntax of VB code for keeping Separator T.Group without Decimal Place."}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 2, "last_activity_date": 1516217967, "last_edit_date": 1516217967, "creation_date": 1516215481, "answer_id": 48308152, "question_id": 48307766, "link": "https://stackoverflow.com/questions/48307766/removing-decimal-from-number-by-vba-excel/48308152#48308152", "title": "Removing Decimal from number by VBA Excel", "body": "<p>If TextBox1 is a <code>String</code> like:</p>\n\n<p>1,234.56</p>\n\n<p>then use something like:</p>\n\n<pre><code>TextBox1 = Split(TextBox1,\".\")(0)\n</code></pre>\n\n<p><strong>EDIT#1:</strong></p>\n\n<p>Based on the Comments,this should be used:</p>\n\n<pre><code>TextBox1 = Split(TextBox1 &amp; Application.DecimalSeparator, Application.DecimalSeparator)(0)\n</code></pre>\n\n<p>This will:</p>\n\n<ol>\n<li>return a null string given a null string</li>\n<li>return a null string if there is no integer part</li>\n<li>return the integer part in a Locale-independent fashion</li>\n</ol>\n"}, {"comments": [{"owner": {"reputation": 95, "user_id": 6329908, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/JeqIQ.jpg?s=128&g=1", "display_name": "Kasra", "link": "https://stackoverflow.com/users/6329908/kasra"}, "edited": false, "score": 0, "creation_date": 1516278377, "post_id": 48308465, "comment_id": 83627728, "body": "I forgot something small ... this TextBox is not an input data entrance, in fact, it is an output display for a hidden cell. It related to a cell (&quot;B15&quot;) that the cell is set on Separator Thousand Group (On) and No Decimal Place (Off). But the TextBox1 shows the Numbers with Separator T.Group (On) with Decimal Place (On). I need a syntax of VB code for keeping Separator T.Group without Decimal Place."}], "tags": [], "owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "is_accepted": false, "score": 3, "last_activity_date": 1516216747, "creation_date": 1516216747, "answer_id": 48308465, "question_id": 48307766, "link": "https://stackoverflow.com/questions/48307766/removing-decimal-from-number-by-vba-excel/48308465#48308465", "title": "Removing Decimal from number by VBA Excel", "body": "<p>Note that both methods (<code>Format</code> from the comments on OP, and <code>Split</code> from @Gary's Student) effectively prevent the user from inputting the decimal, but they don't truncate or round the (presumably numeric) value, so if the user is trying to enter <code>123.54</code> the resulting value will be <code>12354</code> when probably you want either of <code>124</code> (round) or <code>123</code> (trunc). </p>\n\n<p>Relying on _Change event for validation has some limitations :D and probably this value should be validated/manipulated by whatever other procedure is using it as an input.</p>\n\n<p>Example:</p>\n\n<pre><code>Option Explicit\nPrivate Sub CommandButton1_Click()\n    Call ValidateMe(TextBox1)\n    MsgBox (TextBox1.Value)\n\nEnd Sub\n\nPrivate Sub TextBox1_Change()\n    ' do nothing\nEnd Sub\n\nPrivate Sub ValidateMe(obj As MSForms.TextBox)\n    obj.Value = Format(obj, \"0\")\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 1, "creation_date": 1516218518, "post_id": 48308597, "comment_id": 83603249, "body": "Your idea of using preemptive validation of the data is pretty cool."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "edited": false, "score": 0, "creation_date": 1516235237, "post_id": 48308597, "comment_id": 83610039, "body": "I think that there should be an exception added to <code>IsValidDigitInput</code> to allow for negative numbers.   The OP also mentions that <b>The final result has the separator for thousand</b>.  This approach doesn&#39;t allow for copy and paste either."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1516235635, "post_id": 48308597, "comment_id": 83610130, "body": "@ThomasInzina meh, it can easily be tweaked at will as needed - I&#39;m using this in actual production code where negatives would be illegal (negative cost price? negative product code? negative invoice total?); good point on textbox hotkeys being thwarted though. Gotta think about that one...."}, {"owner": {"reputation": 95, "user_id": 6329908, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/JeqIQ.jpg?s=128&g=1", "display_name": "Kasra", "link": "https://stackoverflow.com/users/6329908/kasra"}, "edited": false, "score": 0, "creation_date": 1516259059, "post_id": 48308597, "comment_id": 83616436, "body": "Thank you for your idea,,,, I forgot something small ... this TextBox is not an input data entrance, in fact, it is an output display for a hidden cell. It related to a cell (&quot;B15&quot;) that the cell is set on Separator Thousand Group (On) and No Decimal Place (Off). But the TextBox1 shows the Numbers with Separator T.Group (On) with Decimal Place (On). I need a syntax of VB code for keeping Separator T.Group without Decimal Place."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1516276312, "post_id": 48308597, "comment_id": 83626525, "body": "Then don&#39;t handle a change event.... Assign the textbox with the correct value in the first place!"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1516285704, "post_id": 48308597, "comment_id": 83632410, "body": "Also if the user isn&#39;t supposed to be able to change that value, consider locking the textbox, or using a <code>Label</code> control. And if the cell is hidden, why does it need a format at all?"}], "tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": false, "score": 5, "last_activity_date": 1516225509, "last_edit_date": 1516225509, "creation_date": 1516217297, "answer_id": 48308597, "question_id": 48307766, "link": "https://stackoverflow.com/questions/48307766/removing-decimal-from-number-by-vba-excel/48308597#48308597", "title": "Removing Decimal from number by VBA Excel", "body": "<p>Assuming the user is providing the input, this is an X-Y problem IMO: your goal is to ensure your user can only type digit characters in that textbox, not to <em>truncate decimals</em>.</p>\n\n<p>The problem is that a textbox' <code>Change</code> event is fired too late to do that. Instead, handle <code>KeyDown</code> - I'd do something like this:</p>\n\n<pre><code>Private Sub TextBox1_KeyDown(ByVal KeyCode As MSForms.ReturnInteger, ByVal Shift As Integer)\n    If Not KeyCodeValidator.IsValidDigitInput(KeyCode.value) Then KeyCode.value = 0\nEnd Sub\n</code></pre>\n\n<p>Have a <code>KeyCodeValidator</code> standard module:</p>\n\n<pre><code>Option Explicit\nOption Private Module\n\nPublic Function IsValidAlphaInput(ByVal keyAscii As Long, Optional ByVal allowDeletion As Boolean = True, Optional ByVal allowNav As Boolean = True) As Boolean\n    IsValidAlphaInput = (keyAscii &gt;= vbKeyA And keyAscii &lt;= vbKeyZ) Or (allowDeletion And IsDeletion(keyAscii)) Or (allowNav And IsNavKey(keyAscii))\nEnd Function\n\nPublic Function IsValidDigitInput(ByVal keyAscii As Long, Optional ByVal allowDeletion As Boolean = True, Optional ByVal allowNav As Boolean = True) As Boolean\n    IsValidDigitInput = (keyAscii &gt;= vbKey0 And keyAscii &lt;= vbKey9) Or (keyAscii &gt;= vbKeyNumpad0 And keyAscii &lt;= vbKeyNumpad9) Or (allowDeletion And IsDeletion(keyAscii)) Or (allowNav And IsNavKey(keyAscii))\nEnd Function\n\nPublic Function IsValidAlphanumericInput(ByVal keyAscii As Long, Optional ByVal allowDeletion As Boolean = True, Optional ByVal allowNav As Boolean = True) As Boolean\n    IsValidAlphanumericInput = IsValidAlphaInput(keyAscii) Or IsValidDigitInput(keyAscii) Or (allowDeletion And IsDeletion(keyAscii)) Or (allowNav And IsNavKey(keyAscii))\nEnd Function\n\nPublic Function IsValidDecimalInput(ByVal keyAscii As Long, ByVal contents As String) As Boolean\n    If IsValidDigitInput(keyAscii) Or keyAscii = Asc(\".\") Then\n        IsValidDecimalInput = IsNumeric(contents &amp; Chr$(keyAscii))\n    End If\nEnd Function\n\nPrivate Function IsDeletion(ByVal keyAscii As Long) As Boolean\n    IsDeletion = keyAscii = vbKeyDelete Or keyAscii = vbKeyBack\nEnd Function\n\nPrivate Function IsNavKey(ByVal keyAscii As Long) As Boolean\n    IsNavKey = keyAscii = vbKeyTab Or keyAscii = vbKeyLeft Or keyAscii = vbKeyRight\nEnd Function\n</code></pre>\n\n<p>If you wanted to support decimals, you'd pass the current contents of your textbox to <code>IsValidDecimalInput</code> (which needs minor adjustments to support international decimal separators).</p>\n\n<p>I actually have that module as a class, but a standard module fits the bill just fine too.</p>\n\n<p>Point being, don't fix your user's input after it's in the textbox - <em>prevent</em> the user's invalid input from even being entered in the first place instead.</p>\n"}, {"tags": [], "owner": {"reputation": 95, "user_id": 6329908, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/JeqIQ.jpg?s=128&g=1", "display_name": "Kasra", "link": "https://stackoverflow.com/users/6329908/kasra"}, "is_accepted": false, "score": 0, "last_activity_date": 1516307006, "creation_date": 1516307006, "answer_id": 48329717, "question_id": 48307766, "link": "https://stackoverflow.com/questions/48307766/removing-decimal-from-number-by-vba-excel/48329717#48329717", "title": "Removing Decimal from number by VBA Excel", "body": "<p><strong>braX</strong> sent this code:</p>\n\n<pre><code>TextBox1.Text = Format(TextBox1.Text, \"#,###,###,##0\")\n</code></pre>\n\n<p>Well done <strong>braX</strong> ,, Thank you, it's worked properly ... :)</p>\n"}], "owner": {"reputation": 95, "user_id": 6329908, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/JeqIQ.jpg?s=128&g=1", "display_name": "Kasra", "link": "https://stackoverflow.com/users/6329908/kasra"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2845, "favorite_count": 1, "answer_count": 4, "score": 3, "last_activity_date": 1516307006, "creation_date": 1516213895, "last_edit_date": 1516259174, "question_id": 48307766, "link": "https://stackoverflow.com/questions/48307766/removing-decimal-from-number-by-vba-excel", "title": "Removing Decimal from number by VBA Excel", "body": "<p>I wrote a bit of VBA code in Excel to remove the decimal separator in a textbox that contains a number. The code is as follows:</p>\n\n<pre><code>Private Sub TextBox1_Change()\n\nTextBox1 = Format(TextBox1, \"Standard\")\n\nEnd Sub\n</code></pre>\n\n<p>But it doesn't work properly. The final result has the separator for thousand and also has the decimal place.</p>\n\n<p>This TextBox is not an input data entrance, in fact, it is an output display for a hidden cell. It related to a cell (\"B15\") that the cell is set on Separator Thousand Group (On) and No Decimal Place (Off). But the TextBox1 shows the Numbers with Separator T.Group (On) with Decimal Place (On). I need a syntax of VB code for keeping Separator T.Group without Decimal Place.\nAny idea for removing the decimal separator is welcome!</p>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 2, "creation_date": 1516213650, "post_id": 48307579, "comment_id": 83600701, "body": "Use <code>Split()</code> function and then iterate through the return."}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "is_accepted": true, "score": 2, "last_activity_date": 1516214032, "creation_date": 1516214032, "answer_id": 48307805, "question_id": 48307579, "link": "https://stackoverflow.com/questions/48307579/create-items-through-splitting-a-string-by-comma-and-add-them-to-the-collecti/48307805#48307805", "title": "Create Items through splitting a string by comma(,) and add them to the collection", "body": "<p>As Scott Craner pointed out. </p>\n\n<p>Split the names into an array and then iterate over each name in the array adding it to the collection.</p>\n\n<pre><code>Dim item As Variant\nFor Each item In Split(SheetNames, \",\")\n    SheetNameCollection.Add item\nNext\n</code></pre>\n"}], "owner": {"reputation": 2568, "user_id": 7638174, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/8c25651e0c6634562b6283fa9d76b9cb?s=128&d=identicon&r=PG&f=1", "display_name": "CodingDawg", "link": "https://stackoverflow.com/users/7638174/codingdawg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 34, "favorite_count": 0, "accepted_answer_id": 48307805, "answer_count": 1, "score": 0, "last_activity_date": 1516214032, "creation_date": 1516213206, "last_edit_date": 1516213744, "question_id": 48307579, "link": "https://stackoverflow.com/questions/48307579/create-items-through-splitting-a-string-by-comma-and-add-them-to-the-collecti", "title": "Create Items through splitting a string by comma(,) and add them to the collection", "body": "<p>I have a collection called as <code>SheetNameCollection</code> and I have a string called as SheetNames.</p>\n\n<p>Here goes my code,</p>\n\n<pre><code>Dim SheetNames As String\nDim SheetNameCollection As Collection\nSet SheetNameCollection = New Collection\nSheetNames = \"wk1,wk2,wk3,wk4\"\n'This is dynamic and will usually be more than 100 sheets.\n</code></pre>\n\n<p>I am looking for a way to add these SheetNames one by one into my collection SheetNameCollection.</p>\n\n<p>Kindly suggest an approach. Thanks.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1516213900, "post_id": 48307486, "comment_id": 83600812, "body": "Is there code behind <code>UserForm1</code>, like, a <code>Private Sub UserForm_Activate</code> handler? The workbook can&#39;t be closed because the form is modal - <i>nothing</i> can be done outside the form until it&#39;s closed, that&#39;s what <i>modal</i> dialogs do."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1516214066, "post_id": 48307486, "comment_id": 83600891, "body": "Also note, <a href=\"https://rubberduckvba.wordpress.com/2017/10/25/userform1-show/\" rel=\"nofollow noreferrer\"><code>UserForm1.Show</code> is actively harmful</a> (disclaimer: I wrote that article)."}, {"owner": {"reputation": 26, "user_id": 9220823, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c9673822b7f2218fe3657758b12e83e?s=128&d=identicon&r=PG&f=1", "display_name": "DaniMan", "link": "https://stackoverflow.com/users/9220823/daniman"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1516214683, "post_id": 48307486, "comment_id": 83601180, "body": "@Mat&#39;sMug hello again! There is currently no code behind userForm1 - i tried putting some screen updating stuff in there but nothing works."}, {"owner": {"reputation": 26, "user_id": 9220823, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c9673822b7f2218fe3657758b12e83e?s=128&d=identicon&r=PG&f=1", "display_name": "DaniMan", "link": "https://stackoverflow.com/users/9220823/daniman"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1516214737, "post_id": 48307486, "comment_id": 83601210, "body": "@Mat&#39;sMug I know that the form is modal - i just don&#39;t know why when it gets to the UserForm1.show line it then also shows a new blank grey workbook."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1516214750, "post_id": 48307486, "comment_id": 83601220, "body": "Well, showing a form doesn&#39;t automagically open a workbook - you have code <i>somewhere</i> that&#39;s doing it."}, {"owner": {"reputation": 26, "user_id": 9220823, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c9673822b7f2218fe3657758b12e83e?s=128&d=identicon&r=PG&f=1", "display_name": "DaniMan", "link": "https://stackoverflow.com/users/9220823/daniman"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1516215571, "post_id": 48307486, "comment_id": 83601693, "body": "@Mat&#39;sMug I added the whole code - I don&#39;t think I&#39;m opening it anywhere else. If i remove the UserForm1.show and leave it alone my initial form via the command button 1 works fine."}, {"owner": {"reputation": 26, "user_id": 9220823, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c9673822b7f2218fe3657758b12e83e?s=128&d=identicon&r=PG&f=1", "display_name": "DaniMan", "link": "https://stackoverflow.com/users/9220823/daniman"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1516215636, "post_id": 48307486, "comment_id": 83601716, "body": "@Mat&#39;sMug I can solve my issue using a nasty use of application.visible, but id really like to find out why that blank grey workbook appears upon userform1.show. Can this be some weird system thing and not a code issue?"}, {"owner": {"reputation": 715, "user_id": 8716187, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9d379e724336936aa82cb81f348ef72?s=128&d=identicon&r=PG&f=1", "display_name": "Wookies-Will-Code", "link": "https://stackoverflow.com/users/8716187/wookies-will-code"}, "edited": false, "score": 0, "creation_date": 1516216400, "post_id": 48307486, "comment_id": 83602124, "body": "I would suggest leaving the app visible and not toggle it.  Where you put the worksheet showing up in code and where you describe it in your description are not the same.  In code you would have to close msgbox, form, msgbox for it to appear as stated.  In description it shows up when the form shows up.  Could be your workbook.Close and screenupdating.  in addition you make two references to the same workbook and only close one, there is some interchangeability used as well :Set wb = Workbooks.Open(userDataPath)    Set CopyFromWbk = wb wb.Close"}, {"owner": {"reputation": 715, "user_id": 8716187, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9d379e724336936aa82cb81f348ef72?s=128&d=identicon&r=PG&f=1", "display_name": "Wookies-Will-Code", "link": "https://stackoverflow.com/users/8716187/wookies-will-code"}, "edited": false, "score": 0, "creation_date": 1516216963, "post_id": 48307486, "comment_id": 83602404, "body": "Do you hide the form?  do you unload it?  How do you terminate your userforms after showing them?"}, {"owner": {"reputation": 26, "user_id": 9220823, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c9673822b7f2218fe3657758b12e83e?s=128&d=identicon&r=PG&f=1", "display_name": "DaniMan", "link": "https://stackoverflow.com/users/9220823/daniman"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1516218350, "post_id": 48307486, "comment_id": 83603140, "body": "@Mat&#39;sMug Sorry - grey sheet is right after the .show line. Also tried doing away with the copyfromwkbk reference cause in my case right now the If EstNum &lt;&gt; &quot;&quot;  doesn&#39;t fire off so i don&#39;t need it temporarily. Tried application updating false and true alllll over. Cant get the blank workbook to stop appearing."}, {"owner": {"reputation": 26, "user_id": 9220823, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c9673822b7f2218fe3657758b12e83e?s=128&d=identicon&r=PG&f=1", "display_name": "DaniMan", "link": "https://stackoverflow.com/users/9220823/daniman"}, "reply_to_user": {"reputation": 715, "user_id": 8716187, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9d379e724336936aa82cb81f348ef72?s=128&d=identicon&r=PG&f=1", "display_name": "Wookies-Will-Code", "link": "https://stackoverflow.com/users/8716187/wookies-will-code"}, "edited": false, "score": 0, "creation_date": 1516218408, "post_id": 48307486, "comment_id": 83603184, "body": "@Wookies-Will-Code I just rely on the user to close the first userform when they are done - since it only works via commandbutton i reinitialize all variable on the click"}, {"owner": {"reputation": 26, "user_id": 9220823, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c9673822b7f2218fe3657758b12e83e?s=128&d=identicon&r=PG&f=1", "display_name": "DaniMan", "link": "https://stackoverflow.com/users/9220823/daniman"}, "reply_to_user": {"reputation": 715, "user_id": 8716187, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9d379e724336936aa82cb81f348ef72?s=128&d=identicon&r=PG&f=1", "display_name": "Wookies-Will-Code", "link": "https://stackoverflow.com/users/8716187/wookies-will-code"}, "edited": false, "score": 0, "creation_date": 1516218455, "post_id": 48307486, "comment_id": 83603210, "body": "@Wookies-Will-Code - nothing for the UserForm1 because I just got to it and saw that this blank workbook was appearing right after userform.show"}, {"owner": {"reputation": 715, "user_id": 8716187, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9d379e724336936aa82cb81f348ef72?s=128&d=identicon&r=PG&f=1", "display_name": "Wookies-Will-Code", "link": "https://stackoverflow.com/users/8716187/wookies-will-code"}, "edited": false, "score": 0, "creation_date": 1516218717, "post_id": 48307486, "comment_id": 83603335, "body": "sounds more like a windows (making an assumption here) residue as the screen isn&#39;t refreshed. I tested the meat of that code and it does not provide a legacy grey box (and my userform is a grey box).  This is more in Matt&#39;s league than mine, when does the grey box go away?  How do you get rid of it currently?  You say its a grey workbook . . . problem could be in tour worksheet code up above this section . . . .    <a href=\"https://superuser.com/questions/852251/how-to-clear-screen-artifacts-without-rebooting-windows-multiple-versions\" title=\"how to clear screen artifacts without rebooting windows multiple versions\">superuser.com/questions/852251/&hellip;</a>"}, {"owner": {"reputation": 26, "user_id": 9220823, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c9673822b7f2218fe3657758b12e83e?s=128&d=identicon&r=PG&f=1", "display_name": "DaniMan", "link": "https://stackoverflow.com/users/9220823/daniman"}, "reply_to_user": {"reputation": 715, "user_id": 8716187, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9d379e724336936aa82cb81f348ef72?s=128&d=identicon&r=PG&f=1", "display_name": "Wookies-Will-Code", "link": "https://stackoverflow.com/users/8716187/wookies-will-code"}, "edited": false, "score": 0, "creation_date": 1516219524, "post_id": 48307486, "comment_id": 83603807, "body": "@Wookies-Will-Code Its not a gray box. Its literally a new workbook shell htat opens up and where the cells are its just all grey. I don&#39;t know if its a residue cause restarting should&#39;ve fixed it temporarily.  Right now the first form is on workbook open. When that runs on a button click it results in opening up this UserForm1 so the user can make some secondary selections. Right after UserForm1.show executes - the grey workbook appears. The grey workbook will close when I close the UserForm1 with X. no Unload or hide or anything like that."}, {"owner": {"reputation": 715, "user_id": 8716187, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9d379e724336936aa82cb81f348ef72?s=128&d=identicon&r=PG&f=1", "display_name": "Wookies-Will-Code", "link": "https://stackoverflow.com/users/8716187/wookies-will-code"}, "edited": false, "score": 0, "creation_date": 1516220094, "post_id": 48307486, "comment_id": 83604072, "body": "I am not sure its a new workbook. See this link:<a href=\"https://support.microsoft.com/en-us/help/2790615/parts-of-excel-turn-white-or-gray-when-you-run-vba-code-in-excel-2013\" rel=\"nofollow noreferrer\">support.microsoft.com/en-us/help/2790615/&hellip;</a> ,, I just made a pile of userforms, one opening another and also inline with the button code, they do not artifact on the screen, when I close the second msgbox I might get a flicker of one, but then its gone with the added workbook."}, {"owner": {"reputation": 715, "user_id": 8716187, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9d379e724336936aa82cb81f348ef72?s=128&d=identicon&r=PG&f=1", "display_name": "Wookies-Will-Code", "link": "https://stackoverflow.com/users/8716187/wookies-will-code"}, "edited": false, "score": 0, "creation_date": 1516220995, "post_id": 48307486, "comment_id": 83604578, "body": "tested further code below, its nonsensical, but still no grey workbook / worksheet.  It does however prompt me to save the new workbook after I add those sheets when it gets to close, that&#39;s about it."}, {"owner": {"reputation": 26, "user_id": 9220823, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c9673822b7f2218fe3657758b12e83e?s=128&d=identicon&r=PG&f=1", "display_name": "DaniMan", "link": "https://stackoverflow.com/users/9220823/daniman"}, "reply_to_user": {"reputation": 715, "user_id": 8716187, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9d379e724336936aa82cb81f348ef72?s=128&d=identicon&r=PG&f=1", "display_name": "Wookies-Will-Code", "link": "https://stackoverflow.com/users/8716187/wookies-will-code"}, "edited": false, "score": 0, "creation_date": 1516231006, "post_id": 48307486, "comment_id": 83608941, "body": "@Wookies-Will-Code - I fixed it by adding wb.windows(1).visible = false before my IF statement that checks for isDate. Now the workbook that was opening I was able to verify was the wb that I load from userDataPath in the earlier portion of the code. Since screen updating was false - it came up as just grey, but the wb workbook still opened none the less. The weird part though is why does it only open visibly upon the UserForm1.Show call and not ever through my original user form that the code is in? Either way - thank you very much for the time and effort!"}, {"owner": {"reputation": 715, "user_id": 8716187, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9d379e724336936aa82cb81f348ef72?s=128&d=identicon&r=PG&f=1", "display_name": "Wookies-Will-Code", "link": "https://stackoverflow.com/users/8716187/wookies-will-code"}, "edited": false, "score": 0, "creation_date": 1516291365, "post_id": 48307486, "comment_id": 83636340, "body": "glad you found it! showing and hiding workbooks and sheets, co-mingled with forms can be strange.  After thorough testing of the code (so you don&#39;t get hung with no updating) I might shut things off once at the top of a sub and then back on upon exit.  I don&#39;t do much of that, just hide workbooks opening, processing, and closing that is about it."}], "answers": [{"tags": [], "owner": {"reputation": 715, "user_id": 8716187, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9d379e724336936aa82cb81f348ef72?s=128&d=identicon&r=PG&f=1", "display_name": "Wookies-Will-Code", "link": "https://stackoverflow.com/users/8716187/wookies-will-code"}, "is_accepted": true, "score": 0, "last_activity_date": 1516221160, "last_edit_date": 1516221160, "creation_date": 1516217660, "answer_id": 48308678, "question_id": 48307486, "link": "https://stackoverflow.com/questions/48307486/userform-show-within-a-prior-initial-user-form-causes-blank-grey-un-closeable-wo/48308678#48308678", "title": "UserForm.Show within a prior Initial User form causes blank grey un-closeable workbook to open", "body": "<p>THIS IS NOT A SOLUTION, I tested a piece of your code and here is my feedback below.</p>\n\n<p>I ran just this code in a workbook named testbook.xslm and I created a form (myForm that is just a grey layout, nothing on it):</p>\n\n<pre><code>Private Sub CommandButton1_Click()\nDim wb As Workbook\nDim anotherbook As Workbook\nDim anotherbook2 As Workbook\nDim anotherbook3 As Workbook\n\nSet wb = Workbooks.Add\nSet anotherbook = wb\nSet anotherbook2 = wb\nSet anotherbook3 = wb\n\n\nMsgBox \"h\"\nwb.Application.Visible = False\nmyForm.Show\nwb.Application.Visible = True\n\nMsgBox \"h\"\n\nwb.Close\nApplication.ScreenUpdating = False ' from before also!\nEnd Sub\n</code></pre>\n\n<p>From the user standpoint:</p>\n\n<p>1) testbook opens</p>\n\n<p>2) click the button -> book# opens on top of testbook</p>\n\n<p>3) msgbox \"h\" pops up</p>\n\n<p>4) x out of msgbox \"h\" -> <strong>Both workbooks disappear</strong> (testbook and book1)</p>\n\n<p>5) my grey user form pops up (its empty)</p>\n\n<p>6) x out of userform</p>\n\n<p>7) testbook shows again on top of the new book created which is behind it</p>\n\n<p>8) msgbox \"h\" #2 pops up</p>\n\n<p>9) x out of msgbox</p>\n\n<p>10) the book# behind testbook disappears</p>\n\n<p>That's it.  No grey box residue.  How are you closing the userforms (the first one and the second one)?  obviously I used the terminate with the x.  I did not add any code.  So how are you closing your form with no code?</p>\n\n<p>Adding the same behavior occurs if I make multiple workbook references to wb.\nSo this code area is not your problem . . . . </p>\n\n<p>Second test, still no problems, adding worksheets, running through the number of worksheets, copying them to the testbook.</p>\n\n<pre><code>Option Explicit\n\nPrivate Sub CommandButton1_Click()\nDim wb As Workbook\nDim wb2 As Workbook\nDim ws As Worksheet\nDim anotherbook As Workbook\nDim anotherbook2 As Workbook\nDim anotherbook3 As Workbook\nDim X As Double\nDim lastrow As Double\nDim thisNum As String\n\n\nSet wb = Workbooks.Add\nSet anotherbook = wb\nSet anotherbook2 = wb\nSet anotherbook3 = wb\nSet wb2 = ThisWorkbook\n\nwb.Worksheets.Add\nwb.Worksheets.Add\nwb.Worksheets.Add\nwb.Worksheets.Add\nwb.Worksheets.Add\nwb.Worksheets.Add\n\nmyForm2.Show\n\nMsgBox \"h\"\nwb.Application.Visible = False\nmyForm.Show\nwb.Application.Visible = True\n\nMsgBox \"h\"\n\nFor X = 1 To wb.Worksheets.Count\n\n\n    Set ws = wb.Sheets(X)\n    thisNum = ws.Cells(2, 2)\n\n    lastrow = ws.Cells(Rows.Count, 1).End(xlUp).Row\n\n    ws.Copy After:=wb2.Worksheets(wb2.Worksheets.Count)\n\n    'future code\n\nNext X\n\nwb.Close\nApplication.ScreenUpdating = False ' from before also!\nEnd Sub\n</code></pre>\n\n<p>Perhaps you have a lot of data being acted upon.  Clear the clipboard after the paste?  With:</p>\n\n<pre><code>Application.CutCopyMode = False\n</code></pre>\n\n<p>Digging - WWC</p>\n"}], "owner": {"reputation": 26, "user_id": 9220823, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c9673822b7f2218fe3657758b12e83e?s=128&d=identicon&r=PG&f=1", "display_name": "DaniMan", "link": "https://stackoverflow.com/users/9220823/daniman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 191, "favorite_count": 0, "accepted_answer_id": 48308678, "answer_count": 1, "score": 0, "last_activity_date": 1516221160, "creation_date": 1516212844, "last_edit_date": 1516215489, "question_id": 48307486, "link": "https://stackoverflow.com/questions/48307486/userform-show-within-a-prior-initial-user-form-causes-blank-grey-un-closeable-wo", "title": "UserForm.Show within a prior Initial User form causes blank grey un-closeable workbook to open", "body": "<p>Below is the excerpt of code where the \"error(more like an unwanted occurrence)\" happens. My code is running in a userform (not userform1) after a command button click. The initial form shows on workbook open. The second userform - UserForm1 in the code below - is a check box that I want to present to the user upon my IF condition. When the program gets there, it opens the UserForm1, but also opens a blank grey excel workbook. The workbook cannot be closed until I close the Userformm1 interface.</p>\n\n<p>Note: the second msgbox does not display until AFTER I close the userform.\nI tried searching for this problem, but couldn't find the issue in regards to UserForm stuff. Thanks in advance for any help.</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n\n\nDim wbName As String, wb As Workbook, ws As Worksheet\nDim sht As Worksheet\nDim myValue As Variant\nDim counter As Integer\nDim EstNumAttempt As Boolean\nEstNumAttemp = False\n\ncounter = 0\n\nDim ThisNum As String\nDim EstNum As String\nDim CopyFromBook As Workbook\nDim CopyToWbk As Workbook\nDim ShToCopy As Worksheet\n\n\nSet CopyToWbk = ThisWorkbook\n\n\nApplication.ScreenUpdating = False\n\nThisUserPath = Application.ActiveWorkbook.Path\n\nuserDataPath = ThisUserPath &amp; \"\\SBNBidDataSet01112018.xlsx\"\n\nDim StartDate As String\nDim EndDate As String\n\n\nStartDate = TextBox1.Value\nEndDate = TextBox2.Value\nEstNum = TextBox3.Value\n\n\n\nSet wb = Workbooks.Open(userDataPath)\n\n\n\nSet CopyFromWbk = wb\n\nWSCount = wb.Worksheets.Count\n\n\n\n\nIf EstNum &lt;&gt; \"\" Then\n\nEstNumAttempt = True\n\nFor X = 1 To WSCount\n\n\nSet ws = wb.Sheets(X)\nThisNum = ws.Cells(2, 2)\n\nIf ThisNum = EstNum Then\n\n counter = counter + 1\n Set ShToCopy = CopyFromWbk.Worksheets(X)\n ShToCopy.Copy After:=CopyToWbk.Sheets(CopyToWbk.Sheets.Count)\n\nEnd If\n\nNext X\n\nIf counter = 0 Then\n\n   MsgBox \" That's probably not a valid EST# in SmartBidNet\"\n\nEnd If\n\nEnd If\n\n\nIf IsDate(StartDate) = True And IsDate(EndDate) = True And EstNumAttempt = False Then\nMsgBox \"h\"\nwb.Application.Visible = False\nUserForm1.Show\nwb.Application.Visible = True\n\nMsgBox \"h\"\n'BLANK GREY SHEET HERE\n\nFor X = 100 To 101\n\n    Set ws = wb.Sheets(X)\n\n    lastrow = ws.Cells(Rows.Count, 1).End(xlUp).Row\n\n\n    'future code\n\nNext X\n\nEnd If\n\nwb.Close\nApplication.ScreenUpdating = False ' from before also!\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "excel-2010"], "comments": [{"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 1, "creation_date": 1516212015, "post_id": 48307256, "comment_id": 83599827, "body": "Shouldn&#39;t that <code>Do While</code> be a <code>Do Until</code>?"}], "answers": [{"comments": [{"owner": {"reputation": 489, "user_id": 4021184, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/715e799fa6bcbb7af072f14a37e3caef?s=128&d=identicon&r=PG&f=1", "display_name": "ranopano", "link": "https://stackoverflow.com/users/4021184/ranopano"}, "edited": false, "score": 0, "creation_date": 1516292413, "post_id": 48308786, "comment_id": 83637049, "body": "ahh this is so frustrating. I have another table above the one I am trying to resize (starting also in column A). Now when I run the code I get &quot;Run-time error &#39;13: Type Mismatch&quot;. Any idea how to get around this?"}, {"owner": {"reputation": 489, "user_id": 4021184, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/715e799fa6bcbb7af072f14a37e3caef?s=128&d=identicon&r=PG&f=1", "display_name": "ranopano", "link": "https://stackoverflow.com/users/4021184/ranopano"}, "edited": false, "score": 0, "creation_date": 1516294071, "post_id": 48308786, "comment_id": 83638111, "body": "Ok, I&#39;ve modified the code a bit and it doesn&#39;t seem to be causing the error, BUT the code is not working as intended. There are about 10 extra rows being generated after &quot;Retail Total&quot;. I am thinking this might have to do with data being above Table 6, also in column A..."}, {"owner": {"reputation": 3423, "user_id": 1738572, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/s0VGr.jpg?s=128&g=1", "display_name": "Greg Viers", "link": "https://stackoverflow.com/users/1738572/greg-viers"}, "reply_to_user": {"reputation": 489, "user_id": 4021184, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/715e799fa6bcbb7af072f14a37e3caef?s=128&d=identicon&r=PG&f=1", "display_name": "ranopano", "link": "https://stackoverflow.com/users/4021184/ranopano"}, "edited": false, "score": 0, "creation_date": 1516294265, "post_id": 48308786, "comment_id": 83638225, "body": "Try this: ob.Resize ob.Range.Resize(Lrow1 + ob.range.row)"}, {"owner": {"reputation": 489, "user_id": 4021184, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/715e799fa6bcbb7af072f14a37e3caef?s=128&d=identicon&r=PG&f=1", "display_name": "ranopano", "link": "https://stackoverflow.com/users/4021184/ranopano"}, "edited": false, "score": 0, "creation_date": 1516295843, "post_id": 48308786, "comment_id": 83639140, "body": "Does not seem to work. Even if there is nothing above my table, but i move my table down 4 rows (to a5 rather than a1), there will be 4 extra rows after &quot;Retail Total&quot;. Actually if I do ob.Resize ob.Range.Resize(Lrow1 + ob.range.row) there are 9 extra rows. If i do ob.Resize ob.Range.Resize(Lrow1), there are 4 extra rows"}, {"owner": {"reputation": 3423, "user_id": 1738572, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/s0VGr.jpg?s=128&g=1", "display_name": "Greg Viers", "link": "https://stackoverflow.com/users/1738572/greg-viers"}, "reply_to_user": {"reputation": 489, "user_id": 4021184, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/715e799fa6bcbb7af072f14a37e3caef?s=128&d=identicon&r=PG&f=1", "display_name": "ranopano", "link": "https://stackoverflow.com/users/4021184/ranopano"}, "edited": false, "score": 0, "creation_date": 1516296195, "post_id": 48308786, "comment_id": 83639368, "body": "Oops. Should have been  ob.Resize ob.Range.Resize(Lrow1 + 1 -  ob.range.row)"}], "tags": [], "owner": {"reputation": 3423, "user_id": 1738572, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/s0VGr.jpg?s=128&g=1", "display_name": "Greg Viers", "link": "https://stackoverflow.com/users/1738572/greg-viers"}, "is_accepted": false, "score": 1, "last_activity_date": 1516218111, "creation_date": 1516218111, "answer_id": 48308786, "question_id": 48307256, "link": "https://stackoverflow.com/questions/48307256/dynamically-resize-table-based-on-text-in-cell/48308786#48308786", "title": "Dynamically Resize Table Based on Text in Cell", "body": "<p>I ran this code and it worked, except for an off-by-one error. I fixed it with:</p>\n\n<pre><code>ob.Resize ob.Range.Resize(Lrow1 + 1)\n</code></pre>\n\n<p>You should verify that the cell that contains \"Retail Total\" actually contains that verbatim phrase and not any leading or trailing spaces. You can test by putting this code in your immediate window and see if it comes up true:</p>\n\n<pre><code>? range(\"A5\").Value = \"Retail Total\"\n</code></pre>\n\n<p>Replace A5 with whatever cell happens to contain \"Retail Total\" at the moment.</p>\n"}], "owner": {"reputation": 489, "user_id": 4021184, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/715e799fa6bcbb7af072f14a37e3caef?s=128&d=identicon&r=PG&f=1", "display_name": "ranopano", "link": "https://stackoverflow.com/users/4021184/ranopano"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1503, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1516218111, "creation_date": 1516211920, "last_edit_date": 1516211934, "question_id": 48307256, "link": "https://stackoverflow.com/questions/48307256/dynamically-resize-table-based-on-text-in-cell", "title": "Dynamically Resize Table Based on Text in Cell", "body": "<p>I have a dynamic table that changes size based on slicer selection, so sometimes the table may consist of 4 rows, sometimes, 7, sometimes 15, etc.</p>\n\n<p>Regardless of the size of the table, the last row in column A will always equal \"Retail Total\".</p>\n\n<p>My table looks essentially like this:</p>\n\n<pre><code>+--------------+------+------+------+------+------+------+\n|     ColA     | ColB | ColC | ColD | ColE | ColF | ColG |\n+--------------+------+------+------+------+------+------+\n| Row1         | B2   | C2   | D2   | E2   | F2   | G2   |\n| Row2         | B3   | C3   | D3   | E3   | F3   | G3   |\n| Row3         | B4   | C4   | D4   | E4   | F4   | G4   |\n| Retail Total | B5   | C5   | D5   | E5   | F5   | G5   |\n+--------------+------+------+------+------+------+------+\n</code></pre>\n\n<p>What I would like to do is have some VBA code that will resize the table depending on wherever \"Retail Total\" occurs.</p>\n\n<p>Here is my code so far:</p>\n\n<pre><code>Private Sub Worksheet_Calculate()\nDim ws As Worksheet\nDim ob As ListObject\nDim Lrow1 As Long\n\nSet ws = ActiveWorkbook.Worksheets(\"Sheet1\")\nSet ob = ws.ListObjects(\"Table6\")\n\nWith Sheets(\"Sheet1\")\n\n    Lrow1 = .Cells(.Rows.Count, \"G\").End(xlUp).Row\n    Do While .Cells(Lrow1, \"A\").Value = \"Retail Total\"\n        Lrow1 = Lrow1 - 1\n    Loop\n\nEnd With\n\nob.Resize ob.Range.Resize(Lrow1)\n\nEnd Sub\n</code></pre>\n\n<p>This code doesn't seem to work. The table keeps growing and does not stop at \"Retail Total\", so I was hoping for some assistance.</p>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 1, "creation_date": 1516211760, "post_id": 48307170, "comment_id": 83599701, "body": "Are you using <code>Option Explicit</code>? What is the value of <code>READYSTATE_COMPLETE</code>?"}, {"owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "reply_to_user": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1516212497, "post_id": 48307170, "comment_id": 83600103, "body": "@braX If he made a reference to Microsoft Internet Controls, the value is 4 (max value)."}], "answers": [{"comments": [{"owner": {"reputation": 17, "user_id": 9231051, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/1c0d164882782da3ee5621109cdcf28c?s=128&d=identicon&r=PG&f=1", "display_name": "pedro tedesco", "link": "https://stackoverflow.com/users/9231051/pedro-tedesco"}, "edited": false, "score": 0, "creation_date": 1516213266, "post_id": 48307295, "comment_id": 83600483, "body": "I forgot to mention that the problem is hapenning in the &quot;for each&quot; part."}, {"owner": {"reputation": 17, "user_id": 9231051, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/1c0d164882782da3ee5621109cdcf28c?s=128&d=identicon&r=PG&f=1", "display_name": "pedro tedesco", "link": "https://stackoverflow.com/users/9231051/pedro-tedesco"}, "edited": false, "score": 0, "creation_date": 1516213366, "post_id": 48307295, "comment_id": 83600556, "body": "When I run my program in debug, it works entirely, but when I execute it , it works only until the &quot;for each&quot; part."}, {"owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "reply_to_user": {"reputation": 17, "user_id": 9231051, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/1c0d164882782da3ee5621109cdcf28c?s=128&d=identicon&r=PG&f=1", "display_name": "pedro tedesco", "link": "https://stackoverflow.com/users/9231051/pedro-tedesco"}, "edited": false, "score": 0, "creation_date": 1516214152, "post_id": 48307295, "comment_id": 83600935, "body": "@pedrotedesco Did you make the changes I posted? Did you add BOTH <code>ieBusy ie</code> lines I added to your code? Because your problem is after you click <code>...(&quot;enviar&quot;).Click</code>, you were not allowing it to finish loading."}, {"owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "reply_to_user": {"reputation": 17, "user_id": 9231051, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/1c0d164882782da3ee5621109cdcf28c?s=128&d=identicon&r=PG&f=1", "display_name": "pedro tedesco", "link": "https://stackoverflow.com/users/9231051/pedro-tedesco"}, "edited": false, "score": 0, "creation_date": 1516216121, "post_id": 48307295, "comment_id": 83601984, "body": "Your best bet is to start a new question and include the html code in question with it."}], "tags": [], "owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "is_accepted": true, "score": 0, "last_activity_date": 1516212762, "last_edit_date": 1516212762, "creation_date": 1516212056, "answer_id": 48307295, "question_id": 48307170, "link": "https://stackoverflow.com/questions/48307170/my-vba-works-on-debug-mode-but-not-in-running-mode/48307295#48307295", "title": "My VBA works on debug mode but not in running mode", "body": "<p>When navigating webpages, I created this routine that you simply call to wait for the webpage to finish loading.</p>\n\n<pre><code>Sub ieBusy(ieObj As InternetExplorer)\n    With ieObj\n        Do While .Busy Or .readyState &lt; READYSTATE_COMPLETE\n            DoEvents\n        Loop\n    End With\nEnd Sub\n</code></pre>\n\n<p>So in your code, you can use <code>ieBusy ie</code>.</p>\n\n<pre><code>Option Explicit\n\nSub ieBusy(ieObj As InternetExplorer)\n    With ieObj\n        Do While .Busy Or .readyState &lt; READYSTATE_COMPLETE\n            DoEvents\n        Loop\n    End With\nEnd Sub\n\n\nSub test()\n\n    ' Make sure you Declare your variables, such as &lt;numero&gt;\n    ' You other code here\n\n    numero = Application.InputBox(\"Por Favor entre com o numero precatorio\", \"\", \"\")\n\n    Dim ie As New InternetExplorer\n    ie.Visible = True\n    ie.navigate \"https://processual.trf1.jus.br/consultaProcessual/numeroProcesso.php?secao=TRF1&amp;enviar=ok\"\n\n    ieBusy ie\n\n    ie.document.all(\"proc\").innerText = numero\n    ie.document.getElementById(\"enviar\").Click\n\n    ' It will become busy again after your click, so make another call\n    ieBusy ie\n\n    Set objElementCol = ie.document.getElementsByTagName(\"a\")\n\n    For Each objElement In objElementCol\n        DoEvents\n        If objElement.href = \"https://processual.trf1.jus.br/consultaProcessual/processo.php?proc=1219012520174019198&amp;secao=TRF1&amp;pg=1&amp;enviar=Pesquisar#aba-partes\" Then\n         DoEvents\n            objElement.Click\n            Exit For\n        End If\n        DoEvents\n    Next objElement\n\nEnd Sub\n</code></pre>\n\n<blockquote>\n  <p>Notice: I added <code>Option Explicit</code> to the top of the code. You should get in the habit of <em>always</em> adding this to the top of <strong>every</strong> module. This will require you to declare all of your variables.</p>\n</blockquote>\n"}], "owner": {"reputation": 17, "user_id": 9231051, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/1c0d164882782da3ee5621109cdcf28c?s=128&d=identicon&r=PG&f=1", "display_name": "pedro tedesco", "link": "https://stackoverflow.com/users/9231051/pedro-tedesco"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 263, "favorite_count": 0, "accepted_answer_id": 48307295, "answer_count": 1, "score": 1, "last_activity_date": 1516212762, "creation_date": 1516211587, "last_edit_date": 1516211816, "question_id": 48307170, "link": "https://stackoverflow.com/questions/48307170/my-vba-works-on-debug-mode-but-not-in-running-mode", "title": "My VBA works on debug mode but not in running mode", "body": "<p>I'm writting a code in VBA to open an internet explorer  website, filling the form with a number and then clicking in the \"pesquisar'' button. After that, I need to click on the \"partes\" button.\nMy code is working perfectly on debug mode, but when i run it, it doesn't work.\nPlease help me!</p>\n\n<p>This is my code:</p>\n\n<pre><code>numero = Application.InputBox(\"Por Favor entre com o numero precatorio\", \"\", \"\")\n\n\nSet ie = New InternetExplorer\nie.Visible = True\nie.Navigate \"https://processual.trf1.jus.br/consultaProcessual/numeroProcesso.php?secao=TRF1&amp;enviar=ok\"\n\nDo Until ie.ReadyState = READYSTATE_COMPLETE\nLoop\n\nie.Document.all(\"proc\").innerText = numero\nie.Document.getElementById(\"enviar\").Click\n\nSet objElementCol = ie.Document.getElementsByTagName(\"a\")\n\nFor Each objElement In objElementCol\n    DoEvents\n    If objElement.href = \"https://processual.trf1.jus.br/consultaProcessual/processo.php?proc=1219012520174019198&amp;secao=TRF1&amp;pg=1&amp;enviar=Pesquisar#aba-partes\" Then\n     DoEvents\n        objElement.Click\n        Exit For\n    End If\n    DoEvents\nNext objElement\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1516211563, "post_id": 48307089, "comment_id": 83599588, "body": "Such problems usually arise from unqualified ranges. Most of your code is fine but towards the end you are missing some sheet references - add those and see if the problem disappears."}, {"owner": {"reputation": 25, "user_id": 4370400, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/31d98b277ed4e07f8430b3401c550491?s=128&d=identicon&r=PG&f=1", "display_name": "Cory Gabba", "link": "https://stackoverflow.com/users/4370400/cory-gabba"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1516212158, "post_id": 48307089, "comment_id": 83599906, "body": "Could you be more specific about which sheet references i am missing?"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 2235, "user_id": 7535125, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209489062678374/picture?type=large", "display_name": "Brandon Barney", "link": "https://stackoverflow.com/users/7535125/brandon-barney"}, "edited": false, "score": 0, "creation_date": 1516213084, "post_id": 48307089, "comment_id": 83600406, "body": "I may have jumped the gun as I missed the <code>wsActSht.Activate</code> line.This means all the subsequent range references will refer to this sheet. See @Brandon Barney&#39;s answer for a much fuller explanation of the problems caused by this."}, {"owner": {"reputation": 4001, "user_id": 8811778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/803575584f2d2d45fe01ee5d52c003dd?s=128&d=identicon&r=PG&f=1", "display_name": "chillin", "link": "https://stackoverflow.com/users/8811778/chillin"}, "edited": false, "score": 0, "creation_date": 1516213264, "post_id": 48307089, "comment_id": 83600481, "body": "Note that you toggle application settings off at the beginning, but they only get turned back on if <code>MsgBox = vbYes</code>. You might want to look into that."}, {"owner": {"reputation": 25, "user_id": 4370400, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/31d98b277ed4e07f8430b3401c550491?s=128&d=identicon&r=PG&f=1", "display_name": "Cory Gabba", "link": "https://stackoverflow.com/users/4370400/cory-gabba"}, "reply_to_user": {"reputation": 4001, "user_id": 8811778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/803575584f2d2d45fe01ee5d52c003dd?s=128&d=identicon&r=PG&f=1", "display_name": "chillin", "link": "https://stackoverflow.com/users/8811778/chillin"}, "edited": false, "score": 0, "creation_date": 1516213514, "post_id": 48307089, "comment_id": 83600636, "body": "@chillin , great suggestion...didn&#39;t even see this."}], "answers": [{"comments": [{"owner": {"reputation": 2235, "user_id": 7535125, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209489062678374/picture?type=large", "display_name": "Brandon Barney", "link": "https://stackoverflow.com/users/7535125/brandon-barney"}, "edited": false, "score": 0, "creation_date": 1516212678, "post_id": 48307255, "comment_id": 83600182, "body": "You may want to explain a bit further what you mean. I believe you are referring more to the <code>End(xlDown)</code> causing the lastrow to be 8, but other users might not be able to follow your train of thought."}, {"owner": {"reputation": 21, "user_id": 6587544, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dc1255ee02a0fc363f2b471d011f4a79?s=128&d=identicon&r=PG&f=1", "display_name": "Conor", "link": "https://stackoverflow.com/users/6587544/conor"}, "reply_to_user": {"reputation": 2235, "user_id": 7535125, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209489062678374/picture?type=large", "display_name": "Brandon Barney", "link": "https://stackoverflow.com/users/7535125/brandon-barney"}, "edited": false, "score": 0, "creation_date": 1516213774, "post_id": 48307255, "comment_id": 83600756, "body": "@BrandonBarney Thank you for the advice. I wanted to leave a comment along these lines, but I don&#39;t have the rep for that yet"}, {"owner": {"reputation": 2235, "user_id": 7535125, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209489062678374/picture?type=large", "display_name": "Brandon Barney", "link": "https://stackoverflow.com/users/7535125/brandon-barney"}, "edited": false, "score": 0, "creation_date": 1516216988, "post_id": 48307255, "comment_id": 83602423, "body": "Its not a problem. Your first few answers on SO you&#39;re bound to learn what works and what doesn&#39;t. Just keep in mind that, more often than not, our answers help future programmers who are stuck with a similar question, so being as clear as we can in our answers now will not only help the OP, but it will help future askers as well."}], "tags": [], "owner": {"reputation": 21, "user_id": 6587544, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dc1255ee02a0fc363f2b471d011f4a79?s=128&d=identicon&r=PG&f=1", "display_name": "Conor", "link": "https://stackoverflow.com/users/6587544/conor"}, "is_accepted": false, "score": 0, "last_activity_date": 1516211915, "creation_date": 1516211915, "answer_id": 48307255, "question_id": 48307089, "link": "https://stackoverflow.com/questions/48307089/for-loop-is-executing-longer-than-asked/48307255#48307255", "title": "For Loop is executing longer than asked", "body": "<p>When you set <code>lastrow</code>, the value may vary depending on the data in that column. </p>\n\n<p>For example, if there are entries from A8-A10 lastrow will be 10. If A9 is blank, lastrow will be 8.</p>\n\n<p>Let me know if this helps!</p>\n"}, {"comments": [{"owner": {"reputation": 25, "user_id": 4370400, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/31d98b277ed4e07f8430b3401c550491?s=128&d=identicon&r=PG&f=1", "display_name": "Cory Gabba", "link": "https://stackoverflow.com/users/4370400/cory-gabba"}, "edited": false, "score": 0, "creation_date": 1516213070, "post_id": 48307405, "comment_id": 83600396, "body": "Thank you for the feedback. <code>wsActSht</code>, <code>wsArch</code> are all worksheet names defined in the sheet properties in the (Name) field. Allows me to shorten code from <code>Sheets(&quot;Activity Sheet&quot;)</code> to <code>wsActSht</code>. Agree that it does sound similar to active sheet. Also, the <code>lastrow = wsActSht.Range(&quot;A7&quot;).End(xlDown).Row</code> is finding the first interuption below <code>A7</code> as <code>A1-A6</code> are blank header rows. will look into each of your suggestions below. Really appreciate it!"}], "tags": [], "owner": {"reputation": 2235, "user_id": 7535125, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209489062678374/picture?type=large", "display_name": "Brandon Barney", "link": "https://stackoverflow.com/users/7535125/brandon-barney"}, "is_accepted": false, "score": 1, "last_activity_date": 1516212569, "creation_date": 1516212569, "answer_id": 48307405, "question_id": 48307089, "link": "https://stackoverflow.com/questions/48307089/for-loop-is-executing-longer-than-asked/48307405#48307405", "title": "For Loop is executing longer than asked", "body": "<p>There are a few areas where you will want to check your code.</p>\n\n<p>First, <code>wsActSht</code> isn't defined within the scope of your subroutine. If <code>wsActSheet</code> is a <code>Public</code> (also known as <code>Global</code>) variable, then this is a code smell. Additionally, that name looks awfully like <code>ActiveSheet</code>. This isn't CodeReview, so i'll spare the rant, but, in short, use descriptive names.</p>\n\n<p>Next, I am not quite sure this is the line you are looking for:</p>\n\n<pre><code>lastrow = wsActSht.Range(\"A7\").End(xlDown).Row\n</code></pre>\n\n<p>This will find the first interruption within your rows, not the last row with data in it. Generally, the pattern is:</p>\n\n<pre><code>lastrow = wsActSht.Range(\"A7\").End(xlUp).Row\n</code></pre>\n\n<p>Next, you have a few instances of this pattern:</p>\n\n<pre><code>LastRowArchive = wsArch.Range(\"D\" &amp; Rows.Count).End(xlUp).Offset(1, 0).Row\n</code></pre>\n\n<p>Notice that <code>Rows.Count</code> means <code>ActiveSheet.Rows.Count</code> which is not the same as <code>wsActSht.Rows.Count</code> (see how that might bite you in the butt?). Your <code>wsActSht</code> holds reference to the <code>Worksheet</code> that was <code>Active</code> when it was <code>Set</code>, not the currently <code>ActiveSheet</code>.</p>\n\n<p>Along these lines, watch out for this as well:</p>\n\n<pre><code>... Destination:=Sheets(\"Archive\").Range(\"D\" &amp; LastRowArchive)\n</code></pre>\n\n<p>Again, <code>Sheets</code> here refers to <code>ActiveWorkbook.Sheets</code> and not <code>ThisWorkbook.Sheets</code>. You're bound to get a <code>Subscript Out of Range</code> error here.</p>\n\n<p>Here's another one:</p>\n\n<pre><code>wsActSht.Activate\nRange(\"I7:J\" &amp; lastrow).Select\nSelection.ClearContents              'CLEAR DAY AND NIGHT OPERATORS\nRange(\"N7:O\" &amp; lastrow).Select\nSelection.ClearContents \n</code></pre>\n\n<p>Guess what happens if, between the <code>Activate</code> statement and the rest of it, another worksheet becomes active? All of a sudden you are now potentially deleting all of the data on that sheet, and there is no way of getting it back.</p>\n\n<p>So, how do you remedy all of this?</p>\n\n<p>First, make sure <strong>everything</strong> is qualified. Create your variables with <em>descriptive names</em> such as <code>DPR</code>, or <code>SheetToClear</code> so that you know what you are working on, and when you are working on it. This includes <code>Workbook</code> variables. I prefer <code>ThisWorkbook</code> but that assumes your code is working on the <code>Workbook</code> that is running it. If this isn't the case, you can create a variable for this purpose.</p>\n\n<p>Once you have done this, you need to train yourself to look for anything at a lower level that doesn't have something in front of it. So:</p>\n\n<pre><code>Rows.Count\nRange(\"A1\").Value\nSheets(\"SuperImportantData\")\n</code></pre>\n\n<p>All become code smells because they should be:</p>\n\n<pre><code>SomeImportantSheet.Rows.Count\nSomeImportantSheet.Range(\"A1\").Value\nSomeImportantWorkbook.Sheets(\"SomeImportantData\")\n</code></pre>\n\n<p>By enforcing this practice, you will save yourself many headaches.</p>\n\n<p>Finally, <strong>do not use <code>.Activate</code></strong>. No if's, and's or but's about it. Unless you are quite literally using <code>Activate</code> to return the view back to where the user started, there is no good reason to use <code>Activate</code>. Use variables instead.</p>\n\n<p>Best of luck.</p>\n"}], "owner": {"reputation": 25, "user_id": 4370400, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/31d98b277ed4e07f8430b3401c550491?s=128&d=identicon&r=PG&f=1", "display_name": "Cory Gabba", "link": "https://stackoverflow.com/users/4370400/cory-gabba"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 51, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1516212977, "creation_date": 1516211261, "last_edit_date": 1516212977, "question_id": 48307089, "link": "https://stackoverflow.com/questions/48307089/for-loop-is-executing-longer-than-asked", "title": "For Loop is executing longer than asked", "body": "<p>I am having a problem in the for loop in the code below. It should loop until it reaches the (<code>lastrow - 6</code>) value. In testing this code myself in debug mode, it works everytime and properly exits, however when in use by the end user the for loop seems to run 1-3 more loops than it should before it exits the loop. This causes problems when looking at the data because the dates are not lining up with the pasted data.</p>\n\n<pre><code>Sub ClearDPR()\n    Dim lastrow As Long\n    Dim Found As Range\n    Dim copydate As Long\n    Dim CopyShift As String\n    Dim CopyCRO As String\n    Dim BlankCells As Long\n    Dim LastRowArchive As Long\n    Dim Answer As Integer\n    Dim r As Integer\n    Dim i As Integer\n    Dim startrow As Integer\n\n    With Application\n        .ScreenUpdating = False\n        .Calculation = xlCalculationManual\n        .DisplayAlerts = False\n    End With\n\n\n    ' PRINT REMINDER AND DPR CLEAR CONFIRMATION\n    Answer = MsgBox(\"Have you printed the DPR?\", vbYesNo, \"Clear DPR\")\n    If Answer = vbNo Then\n        Exit Sub\n    Else                                         'COPY PASTE ACTIVITY SHEET ITEMS TO ARCHIVE\n        'IF COLUMN O IS COMPLETE, THEN CHECKS PRIOR CELLS FILLED BEFORE CONSIDERING ROW &amp; COLUMN AS TARGET CELL (ELSE MSGBOX)\n        lastrow = wsActSht.Range(\"A7\").End(xlDown).Row\n        BlankCells = WorksheetFunction.CountBlank(wsActSht.Range(\"A7:R\" &amp; lastrow))\n\n        If BlankCells &lt;&gt; 0 Then\n            MsgBox (\"Please fill the \" &amp; BlankCells &amp; \" blank cell(s) on DPR.\")\n            Exit Sub\n        End If\n\n        If BlankCells = 0 Then\n            MsgBox \"Entry accepted\", vbInformation, \"Accepted\"\n\n            If wsActSht.FilterMode = True Then\n                wsActSht.ShowAllData\n            End If\n\n\n            'THEN COPY PASTE A:Q FROM ACTIVITY SHEET TO ARCHIVE STARTING WITH COLUMN D\n            LastRowArchive = wsArch.Range(\"D\" &amp; Rows.Count).End(xlUp).Offset(1, 0).Row\n            If SheetProtected(wsArch) Then\n                wsArch.Unprotect \"password\"      'Unprotect Archive\n            End If\n\n            If wsArch.FilterMode = True Then\n                wsArch.ShowAllData\n            End If\n\n\n            wsActSht.Range(\"A7:B\" &amp; lastrow).Copy Destination:=Sheets(\"Archive\").Range(\"D\" &amp; LastRowArchive)\n            wsActSht.Range(\"D7:R\" &amp; lastrow).Copy Destination:=Sheets(\"Archive\").Range(\"F\" &amp; LastRowArchive)\n            wsArch.Activate\n\n            ' COPIES AND PASTES B5,D5,F5 FROM ACTIVITY SHEET TO SYNC WITH ROW PASTED ABOVE\n            For r = 1 To lastrow - 6\n                copydate = wsActSht.Range(\"B5\").Value - 1\n                CopyShift = wsActSht.Range(\"E5\").Value &amp; \" &amp;\" &amp; Chr(10) &amp; wsActSht.Range(\"I5\").Value\n                CopyCRO = wsActSht.Range(\"G5\").Value &amp; \" &amp;\" &amp; Chr(10) &amp; wsActSht.Range(\"K5\").Value\n                wsArch.Range(\"A\" &amp; Rows.Count).End(xlUp).Offset(1, 0).NumberFormat = \"m/d/yyyy\" 'short date format of date before paste to archive\n                wsArch.Range(\"A\" &amp; Rows.Count).End(xlUp).Offset(1, 0).Value = copydate\n                wsArch.Range(\"A\" &amp; Rows.Count).End(xlUp).Offset(0, 20).Value = Format(Now(), \"m/dd/yyyy h:mmAM/PM\")\n                wsArch.Range(\"B\" &amp; Rows.Count).End(xlUp).Offset(1, 0).Value = CopyShift\n                wsArch.Range(\"C\" &amp; Rows.Count).End(xlUp).Offset(1, 0).Value = CopyCRO\n                wsArch.Range(\"C\" &amp; Rows.Count).End(xlUp).EntireRow.AutoFit 'size row to show all contents of COLUMN C\n            Next r\n\n            wsArch.Protect \"password\", , , , , , , , , , , , , True, True 'Protect Archive\n\n            'REFRESH DPR FOR NEXT 24 HOUR USE\n            wsActSht.Activate\n            Range(\"I7:J\" &amp; lastrow).Select\n            Selection.ClearContents              'CLEAR DAY AND NIGHT OPERATORS\n            Range(\"N7:O\" &amp; lastrow).Select\n            Selection.ClearContents              'CLEAR LBS RAN SPACE FOR BOTH SHIFTS\n\n            startrow = 7\n            For i = startrow To lastrow          'INDEXES ROWS AND REMOVE ROWS MARKED YES IN COLUMN Q (ROWS WHICH HAVE BEEN INDICATED THAT THE LOT IS COMPLETE)\n                If Range(\"R\" &amp; i).Value = \"YES\" Or Range(\"R\" &amp; i).Value = \"Yes\" Or Range(\"R\" &amp; i).Value = \"yes\" Then\n                    Range(\"R\" &amp; i).Select\n                    Selection.EntireRow.Delete\n                    i = i - 1\n                End If\n            Next i\n\n            'CLEAR SHIFT AND CRO FOR DAYS AND NIGHTS\n\n            With wsActSht\n                .Range(\"E5\").Value = \"Click Here\"\n                .Range(\"I5\").Value = \"Click Here\"\n                .Range(\"G5\").Value = \"\"\n                .Range(\"K5\").Value = \"\"\n            End With\n\n            MsgBox (\"DPR Cleared to completion\")\n\n            'SAVE DOCUMENT\n            LotFolder.Save\n\n        End If\n    End If\n\n    With Application\n        .ScreenUpdating = True\n        .Calculation = xlCalculationAutomatic\n        .DisplayAlerts = True\n    End With\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1516209129, "post_id": 48306459, "comment_id": 83598161, "body": "at first glance this looks wrong: <code>OCT.Range(&quot;A&quot; &amp; x) &amp; (&quot;A&quot; &amp; y))</code>. Try <code>OCT.Range(OCT.Range(&quot;A&quot; &amp; x),OCT.Range(&quot;A&quot; &amp; y))</code>"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1516209932, "post_id": 48306459, "comment_id": 83598638, "body": "Also, where&#39;s your <code>End If</code>?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 3, "creation_date": 1516210448, "post_id": 48306459, "comment_id": 83598938, "body": "Why even use evaluate for this?"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1516210881, "post_id": 48306459, "comment_id": 83599205, "body": "Per Tim Williams comment, Sumproduct is the function you want, either as a worksheet formula or in code."}, {"owner": {"reputation": 13, "user_id": 8091887, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/49ca9b9a7b9816d066a2c63bf241d1f3?s=128&d=identicon&r=PG&f=1", "display_name": "PaulRey", "link": "https://stackoverflow.com/users/8091887/paulrey"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1516263863, "post_id": 48306459, "comment_id": 83618769, "body": "@ScottHoltzman I tried it with you addition, but had the same end results."}, {"owner": {"reputation": 13, "user_id": 8091887, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/49ca9b9a7b9816d066a2c63bf241d1f3?s=128&d=identicon&r=PG&f=1", "display_name": "PaulRey", "link": "https://stackoverflow.com/users/8091887/paulrey"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1516263870, "post_id": 48306459, "comment_id": 83618773, "body": "@BruceWayne My bad, I forgot to add it, I&#39;ve fixed that."}, {"owner": {"reputation": 13, "user_id": 8091887, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/49ca9b9a7b9816d066a2c63bf241d1f3?s=128&d=identicon&r=PG&f=1", "display_name": "PaulRey", "link": "https://stackoverflow.com/users/8091887/paulrey"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1516263941, "post_id": 48306459, "comment_id": 83618816, "body": "@Rory I used evaluate since I&#39;ve used it before, that&#39;s pretty much it. I have never used Sumproduct before (not in VBA at least), could you provide an example of how it would work with this problem?"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1516265274, "post_id": 48306459, "comment_id": 83619597, "body": "<code>Month.Cells(w, j).Value = Application.Sumproduct( _         OCT.Range(Cells(x, i), Cells(y, i)), _         OCT.Range(&quot;A&quot; &amp; x, &quot;A&quot; &amp; y))</code>"}, {"owner": {"reputation": 13, "user_id": 8091887, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/49ca9b9a7b9816d066a2c63bf241d1f3?s=128&d=identicon&r=PG&f=1", "display_name": "PaulRey", "link": "https://stackoverflow.com/users/8091887/paulrey"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1516265732, "post_id": 48306459, "comment_id": 83619861, "body": "@Rory Fantastic. I tried it with that one and it worked perfectly. Thank you"}], "owner": {"reputation": 13, "user_id": 8091887, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/49ca9b9a7b9816d066a2c63bf241d1f3?s=128&d=identicon&r=PG&f=1", "display_name": "PaulRey", "link": "https://stackoverflow.com/users/8091887/paulrey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 52, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1516263597, "creation_date": 1516208842, "last_edit_date": 1516263597, "question_id": 48306459, "link": "https://stackoverflow.com/questions/48306459/application-evaluate-with-multiplication-and-range", "title": "Application.Evaluate with multiplication and range", "body": "<p>I'm having a problem writing a line of code using Application.Evaluate. I have a table with data that looks like this:</p>\n\n<pre><code>00:01  Mark  1  0  3  5 \n00:02  Mark  2  8  7  1 \n00:05  Mark  8  1  4  3 \n00:08  Mark  9  5  5  5 \n00:10  Mark  7  8  9  7 \n</code></pre>\n\n<p>Essentially what I am trying to do is multiply the first column (00:01 until 00:10) with the 3rd column, and place the result in another sheet, then the same with the 4th column and so on. The idea is for excel to do something like this:</p>\n\n<p>((00:01 * 1) + (00:02 * 2) + (00:05 * 8) + (00:08 * 9) + (00:10 * 7))</p>\n\n<p>In the following code OCT is the worksheet with the table, and Month is the worksheet where the results should be placed and MonthSkipRow and MonthRow are used to find the correct Row in Month:</p>\n\n<pre><code>Dim OCTStartRow as Range\nDim OCTEndRow as Range\nDim MonthSkipRow as Range\nDim MonthRow as Range\ndim i as Long, j as Long, x as Long, y as Long, w as Long\n\ni = 3\nj = 2\n\nDo Until i &gt; 33\n\nIf Not OCT.Columns(2).Find(\"Mark\", lookat:=xlWhole) Is Nothing Then\n\n    Set OCTStartRow = OCT.Columns(2).Find(\"Mark\", lookat:=xlWhole)\n    x = OCTStartRow.Row\n\n    Set OCTEndRow = OCT.Columns(2).Find(\"Mark\", lookat:=xlWhole, SearchDirection:=xlPrevious)\n    y = OCTEndRow.Row\n\n    Set MonthSkipRow = Month.Columns(1).Find(\"Total Duration Outbound (hrs)\", lookat:=xlWhole)\n    z = MonthSkipRow.Row\n\n    Set MonthRow = Month.Columns(1).Find(\"Mark\", lookat:=xlWhole, After:=Range(\"A\" &amp; z))\n    w = MonthRow.Row\n\n    Month.Cells(w, j).Value = Application.Evaluate( _\n        (OCT.Range(Cells(x, i), Cells(y, i)) &amp; \"*\" &amp; _\n        (OCT.Range(\"A\" &amp; x) &amp; (\"A\" &amp; y))))\n    End if\n    j = j + 1\n    i = i + 1\n\nLoop \n</code></pre>\n\n<p>My problem is the last line of code, I keep getting the error message \"Run-time error \"13\": Type mismatch\". My guess is that the line is baddly written. I am hoping someone knows how to write it properly. I hope it all makes sense.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 1, "creation_date": 1516208619, "post_id": 48306355, "comment_id": 83597836, "body": "The simplest way might be to overwrite the results each time. Otherwise you&#39;d need some way of identifying each row that is copied to check whether it already exists."}, {"owner": {"reputation": 65, "user_id": 9226292, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d3e330dd3e73989c0297a31bed9d7b72?s=128&d=identicon&r=PG&f=1", "display_name": "J Doe", "link": "https://stackoverflow.com/users/9226292/j-doe"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1516208678, "post_id": 48306355, "comment_id": 83597885, "body": "@SJR I think that&#39;d work for me...Do you know how I can overwrite the results each time?  I&#39;m just beginning to learn VBA so I don&#39;t know very much beyond the basics right now..."}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 1, "creation_date": 1516208985, "post_id": 48306355, "comment_id": 83598076, "body": "Hi @JDoe - are the IDs unique to the rows of data on the output tab? You could do an <code>Application.WorksheetFunction.CountIf</code> to make sure the ID doesn&#39;t already exist on the output tab"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 1, "creation_date": 1516209088, "post_id": 48306355, "comment_id": 83598140, "body": "I think this will do it <code>endrow=1</code>. Btw your code as posted has a Next without a For."}, {"owner": {"reputation": 65, "user_id": 9226292, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d3e330dd3e73989c0297a31bed9d7b72?s=128&d=identicon&r=PG&f=1", "display_name": "J Doe", "link": "https://stackoverflow.com/users/9226292/j-doe"}, "reply_to_user": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1516209248, "post_id": 48306355, "comment_id": 83598220, "body": "@dwirony the ID&#39;s are not unique to the rows unfortunately....but that is a good idea otherwise, thank you for you input"}, {"owner": {"reputation": 65, "user_id": 9226292, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d3e330dd3e73989c0297a31bed9d7b72?s=128&d=identicon&r=PG&f=1", "display_name": "J Doe", "link": "https://stackoverflow.com/users/9226292/j-doe"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1516209357, "post_id": 48306355, "comment_id": 83598287, "body": "@SJR where would I place <code>endrow=1</code> in the code?  Or would I be replacing <code>endrow = wsO.Cells(Rows.Count, &quot;T&quot;).End(xlUp).Row + 1</code>?  I think I need that part since it checks column T for the last row with data in it then moves down one."}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 1, "creation_date": 1516209509, "post_id": 48306355, "comment_id": 83598395, "body": "@JDoe Then what makes a row considered a duplicate? Whatever that is should be the critieria for the countif"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 2, "creation_date": 1516209513, "post_id": 48306355, "comment_id": 83598399, "body": "My suggestion is that you don&#39;t want to find the last row and start underneath it, but to start again. In fact, why not clear the usedrange of wsO at the beginning and then you can keep the rest of your code as is?"}, {"owner": {"reputation": 65, "user_id": 9226292, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d3e330dd3e73989c0297a31bed9d7b72?s=128&d=identicon&r=PG&f=1", "display_name": "J Doe", "link": "https://stackoverflow.com/users/9226292/j-doe"}, "reply_to_user": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1516210091, "post_id": 48306355, "comment_id": 83598741, "body": "@dwirony running the macro will copy the data in cells S:V and paste it in after the last row used in Sheet1 column T.  Running it again will copy that same data and paste it under the data that was just pasted.  I want Excel to recognize that the data is already all there and the macro was already run so it should not run again unless the data was altered in some way.  But I&#39;m not sure if that would be possible to do with VBA..."}, {"owner": {"reputation": 65, "user_id": 9226292, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d3e330dd3e73989c0297a31bed9d7b72?s=128&d=identicon&r=PG&f=1", "display_name": "J Doe", "link": "https://stackoverflow.com/users/9226292/j-doe"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1516210346, "post_id": 48306355, "comment_id": 83598876, "body": "@SJR ah I see...I will be running this macro multiple times, each for a different column but pasting into the same sheet, in the columns.  That&#39;s why I have the code to find the last row and start underneath it, so that it can be a continuous line of data"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 1, "creation_date": 1516210835, "post_id": 48306355, "comment_id": 83599171, "body": "Clearly I am missing something. If you clear the contents of the output sheet you can then run all the code you want and nothing will be duplicated."}, {"owner": {"reputation": 65, "user_id": 9226292, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d3e330dd3e73989c0297a31bed9d7b72?s=128&d=identicon&r=PG&f=1", "display_name": "J Doe", "link": "https://stackoverflow.com/users/9226292/j-doe"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1516211114, "post_id": 48306355, "comment_id": 83599334, "body": "@SJR I apologize for being unclear.  I don&#39;t want to clear the contents of the output sheet. I want the macro to paste the copied data 1 row after the last row that has data in column T.  Then if the macro is run again, it should somehow check to make sure this exact data wasn&#39;t just pasted in right before.  Is that possible through VBA?"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 1, "creation_date": 1516211222, "post_id": 48306355, "comment_id": 83599395, "body": "If you need to preserve what is already there, you need to define what you mean by &quot;exact data&quot; as suggested by @dwirony."}, {"owner": {"reputation": 65, "user_id": 9226292, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d3e330dd3e73989c0297a31bed9d7b72?s=128&d=identicon&r=PG&f=1", "display_name": "J Doe", "link": "https://stackoverflow.com/users/9226292/j-doe"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1516211940, "post_id": 48306355, "comment_id": 83599789, "body": "@SJR the data that must be preserved is sort of dynamic.  It could be more or less rows depending on how much data there happens to be at a given time.  Is there a way to detect what&#39;s already there, exclude that from deletion, and only delete the values that the code just pasted then and there?"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1516212114, "post_id": 48306355, "comment_id": 83599880, "body": "When you copy you could add a flag in another column, e.g. a 1 or anything really, and filter on that and delete those rows."}, {"owner": {"reputation": 65, "user_id": 9226292, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d3e330dd3e73989c0297a31bed9d7b72?s=128&d=identicon&r=PG&f=1", "display_name": "J Doe", "link": "https://stackoverflow.com/users/9226292/j-doe"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1516212347, "post_id": 48306355, "comment_id": 83600020, "body": "@SJR that&#39;s an excellent idea...is it possible to do this all in one step - filter on the flag, delete the rows, paste the new data in?  So that the end user can just click the button to run the macro so that Excel will copy the data required, go to Sheet1, filter on flag, delete those rows, paste new data in w/ the same flag?  I guess the main part that I&#39;m trying to ask is how to add the code that adds a flag in another column and how to filter and delete those rows before pasting in the new data."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1516212709, "post_id": 48306355, "comment_id": 83600195, "body": "Yes all that is possible. When you copy each line you just need to add a 1 in column AA or wherever. There are many examples online of code for filtering and deleting. If you get stuck on that I suggest you post a new question on that specifically."}, {"owner": {"reputation": 65, "user_id": 9226292, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d3e330dd3e73989c0297a31bed9d7b72?s=128&d=identicon&r=PG&f=1", "display_name": "J Doe", "link": "https://stackoverflow.com/users/9226292/j-doe"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 1, "creation_date": 1516213660, "post_id": 48306355, "comment_id": 83600707, "body": "@SJR I will go ahead and look that up.  Thank you very much for your help!"}], "answers": [{"comments": [{"owner": {"reputation": 65, "user_id": 9226292, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d3e330dd3e73989c0297a31bed9d7b72?s=128&d=identicon&r=PG&f=1", "display_name": "J Doe", "link": "https://stackoverflow.com/users/9226292/j-doe"}, "edited": false, "score": 0, "creation_date": 1516210276, "post_id": 48306752, "comment_id": 83598840, "body": "I&#39;m trying to run this code but @SJR mentioned before that I had a Next without a For.  Where would the For go?  My original macro ran fine without the For but I don&#39;t understand why it was able to run fine....but when I try to run the one you posted, it tells me Compile error: Next without For"}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 2, "creation_date": 1516210651, "post_id": 48306752, "comment_id": 83599055, "body": "Looks like you need a <code>For each c in rSource</code> above <code>If IsNumeric(c.Value) Then</code>"}, {"owner": {"reputation": 65, "user_id": 9226292, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d3e330dd3e73989c0297a31bed9d7b72?s=128&d=identicon&r=PG&f=1", "display_name": "J Doe", "link": "https://stackoverflow.com/users/9226292/j-doe"}, "reply_to_user": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1516210972, "post_id": 48306752, "comment_id": 83599252, "body": "@dwirony hm this code seems to erase everything then paste in the data.  I want all data to be kept in tact then to paste the data after the last row in column T with data in it.  My code does that right now but clicking it multiple times continues to paste the data down after the last row with data in it, resulting in duplicate values.  Would it be out of the scope for VBA to be able to stop that from happening?  So that it will recognize that it has pasted that data already and that it should not continue pasting unless the data was changed?"}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 1, "creation_date": 1516211140, "post_id": 48306752, "comment_id": 83599347, "body": "That&#39;s why I suggested something to double check against duplicate values, like an <code>Application.WorksheetFunction.CountIf</code> :)"}, {"owner": {"reputation": 65, "user_id": 9226292, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d3e330dd3e73989c0297a31bed9d7b72?s=128&d=identicon&r=PG&f=1", "display_name": "J Doe", "link": "https://stackoverflow.com/users/9226292/j-doe"}, "reply_to_user": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1516211258, "post_id": 48306752, "comment_id": 83599414, "body": "@dwirony I apologize for not taking your suggestion.  I will give it a try right now to see how it fares.  Do you know where I should put that line of code in the macro?"}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "reply_to_user": {"reputation": 65, "user_id": 9226292, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d3e330dd3e73989c0297a31bed9d7b72?s=128&d=identicon&r=PG&f=1", "display_name": "J Doe", "link": "https://stackoverflow.com/users/9226292/j-doe"}, "edited": false, "score": 1, "creation_date": 1516211330, "post_id": 48306752, "comment_id": 83599466, "body": "@JDoe No worries - you need to tell us what is classifying a row as a duplicate value. If it&#39;s not the ID, then what is it? Client name? Date? A combination of the two?"}, {"owner": {"reputation": 65, "user_id": 9226292, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d3e330dd3e73989c0297a31bed9d7b72?s=128&d=identicon&r=PG&f=1", "display_name": "J Doe", "link": "https://stackoverflow.com/users/9226292/j-doe"}, "reply_to_user": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1516211441, "post_id": 48306752, "comment_id": 83599516, "body": "@dwirony it would be the ID that is the duplicate.  Is there a way to change the code that checks against duplicate values to only check the rows that were just pasted only and nothing before that?  If so, you would have solved my problem all  along!!"}], "tags": [], "owner": {"reputation": 7497, "user_id": 8670372, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ir8a4Lbosmo/AAAAAAAAAAI/AAAAAAAAOtE/2eY5jK1atcc/photo.jpg?sz=128", "display_name": "Xabier", "link": "https://stackoverflow.com/users/8670372/xabier"}, "is_accepted": false, "score": 1, "last_activity_date": 1516214965, "last_edit_date": 1516214965, "creation_date": 1516209995, "answer_id": 48306752, "question_id": 48306355, "link": "https://stackoverflow.com/questions/48306355/how-to-stop-a-macro-from-repeating-when-run-multiple-times/48306752#48306752", "title": "How to stop a macro from repeating when run multiple times?", "body": "<p>As SJR mentioned why not clear the wsO before running the code again:</p>\n\n<pre><code>Sub CopyPaste()\n\nDim c As Range\nDim IRow As Long, lastrow As Long\nDim rSource As Range\nDim wsI As Worksheet, wsO As Worksheet\nDim endrow As Long\n\n\nOn Error GoTo Whoa\n\n\n'~~&gt; Sheet Where values needs to be checked\nSet wsI = ThisWorkbook.Sheets(\"Sheet2\")\n'~~&gt; Output sheet\nSet wsO = ThisWorkbook.Sheets(\"Sheet1\")\n\nwsO.Rows(\"2:\" &amp; Rows.Count).ClearContents\n'the above line will clear the sheet from Row 2 to the last (in case you have headers, if not then change 2 to 1\n\nApplication.ScreenUpdating = False\n\n'Look for last row with data in column T and move to next\nendrow = wsO.Cells(Rows.Count, \"T\").End(xlUp).Row + 1\n\n\nWith wsI\n    '~~&gt; Find Last Row which has data in Col S to V\n    If Application.WorksheetFunction.CountA(.Cells) &lt;&gt; 0 Then\n\n        lastrow = .Columns(\"S:V\").Find(What:=\"*\", _\n                      After:=.Range(\"S1\"), _\n                      Lookat:=xlPart, _\n                      LookIn:=xlFormulas, _\n                      SearchOrder:=xlByRows, _\n                      SearchDirection:=xlPrevious, _\n                      MatchCase:=False).Row\n    Else\n        lastrow = 1\n    End If\n\n\n    Set rSource = .Range(\"V1:V\" &amp; lastrow)\n\n\n        If IsNumeric(c.Value) Then\n            If c.Value &gt; 0 Then\n                wsO.Cells(endrow + IRow, 20).Resize(1, 4).Value = _\n                     .Range(\"S\" &amp; c.Row &amp; \":V\" &amp; c.Row).Value\n                wsO.Cells(endrow + IRow, 25).Value = \"ID#\" &amp; .Range(\"J\" &amp; c.Row).Value\n                IRow = IRow + 1\n            End If\n        End If\n\n\nEnd With\n\nLetsContinue:\n    Application.ScreenUpdating = True\n    Application.CutCopyMode = False\n    Exit Sub\nWhoa:\n    MsgBox Err.Description\n    Resume LetsContinue\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 65, "user_id": 9226292, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d3e330dd3e73989c0297a31bed9d7b72?s=128&d=identicon&r=PG&f=1", "display_name": "J Doe", "link": "https://stackoverflow.com/users/9226292/j-doe"}, "edited": false, "score": 1, "creation_date": 1516211704, "post_id": 48307074, "comment_id": 83599665, "body": "I like this solution.  If all else fails, I will go with this one.   Even if it isn&#39;t as fancy pancy to the end user, it gets the job done :)"}], "tags": [], "owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "is_accepted": false, "score": 2, "last_activity_date": 1516211220, "creation_date": 1516211220, "answer_id": 48307074, "question_id": 48306355, "link": "https://stackoverflow.com/questions/48306355/how-to-stop-a-macro-from-repeating-when-run-multiple-times/48307074#48307074", "title": "How to stop a macro from repeating when run multiple times?", "body": "<p>Another solution to prevent human error (more like a band-aid solution):</p>\n\n<pre><code>If MsgBox(\"Are you sure you want to run this macro? Running it a second time can result in duplicate values! Proceed?\", vbYesNo + vbQuestion) = vbNo Then Exit Sub\n</code></pre>\n\n<p>Putting this at the start of your macro can warn the user against running it by accident.</p>\n"}], "owner": {"reputation": 65, "user_id": 9226292, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d3e330dd3e73989c0297a31bed9d7b72?s=128&d=identicon&r=PG&f=1", "display_name": "J Doe", "link": "https://stackoverflow.com/users/9226292/j-doe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1569, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1516214965, "creation_date": 1516208476, "last_edit_date": 1516208607, "question_id": 48306355, "link": "https://stackoverflow.com/questions/48306355/how-to-stop-a-macro-from-repeating-when-run-multiple-times", "title": "How to stop a macro from repeating when run multiple times?", "body": "<p>I have a macro that I hashed together with the immense help with other users on here.  I then edited it slightly to fit my needs.  </p>\n\n<p>Right now, running the macro will have Excel look for any numerical value above 0 in column V of Sheet2.  If a value above 0 exists, copy cells S:V of that same row.  Then Excel will look for the last row that has data in it in column T and move to the next row after.  Excel will then paste the data from cell S:V into this row.  Afterwards, it will go back to Sheet2 and continue to look in column V for the next value that exists and do it all over again until it reaches the end of the column.</p>\n\n<p>My issue is that when you run the macro twice, it will perform the actions as needed twice, resulting in duplicate values.  I want Excel to perform the macro once and then if it is run again, have nothing happen.  I'm trying to prevent human error in case someone accidentally runs the macro twice and doesn't notice it.  Is this possible?</p>\n\n<pre><code>    Sub CopyPaste()\n\n    Dim c As Range\n    Dim IRow As Long, lastrow As Long\n    Dim rSource As Range\n    Dim wsI As Worksheet, wsO As Worksheet\n    Dim endrow As Long\n\n\n    On Error GoTo Whoa\n\n\n    '~~&gt; Sheet Where values needs to be checked\n    Set wsI = ThisWorkbook.Sheets(\"Sheet2\")\n    '~~&gt; Output sheet\n    Set wsO = ThisWorkbook.Sheets(\"Sheet1\")\n\n    Application.ScreenUpdating = False\n\n    'Look for last row with data in column T and move to next\n    endrow = wsO.Cells(Rows.Count, \"T\").End(xlUp).Row + 1\n\n\n    With wsI\n        '~~&gt; Find Last Row which has data in Col S to V\n        If Application.WorksheetFunction.CountA(.Cells) &lt;&gt; 0 Then\n\n            lastrow = .Columns(\"S:V\").Find(What:=\"*\", _\n                          After:=.Range(\"S1\"), _\n                          Lookat:=xlPart, _\n                          LookIn:=xlFormulas, _\n                          SearchOrder:=xlByRows, _\n                          SearchDirection:=xlPrevious, _\n                          MatchCase:=False).Row\n        Else\n            lastrow = 1\n        End If\n\n\n        Set rSource = .Range(\"V1:V\" &amp; lastrow)\n\n\n            If IsNumeric(c.Value) Then\n                If c.Value &gt; 0 Then\n                    wsO.Cells(endrow + IRow, 20).Resize(1, 4).Value = _\n                         .Range(\"S\" &amp; c.Row &amp; \":V\" &amp; c.Row).Value\n                    wsO.Cells(endrow + IRow, 25).Value = \"ID#\" &amp; .Range(\"J\" &amp; c.Row).Value\n                    IRow = IRow + 1\n                End If\n            End If\n\n        Next\n    End With\n\n LetsContinue:\n    Application.ScreenUpdating = True\n    Application.CutCopyMode = False\n    Exit Sub\n Whoa:\n    MsgBox Err.Description\n    Resume LetsContinue\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "xll"], "answers": [{"comments": [{"owner": {"reputation": 57, "user_id": 3378377, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4742f2dd662f88d3642b67a6e6890880?s=128&d=identicon&r=PG&f=1", "display_name": "eugene251", "link": "https://stackoverflow.com/users/3378377/eugene251"}, "edited": false, "score": 0, "creation_date": 1516210152, "post_id": 48306157, "comment_id": 83598772, "body": "unfortunately this doesnt solve the problem. the problem is that the function itself returns an error. <code>val = Application.Run(&quot;arrayfun1&quot;, arg1, arg2, ...)</code> gives me back &quot;#uncalculated&quot;."}, {"owner": {"user_type": "does_not_exist", "display_name": "user8753746"}, "reply_to_user": {"reputation": 57, "user_id": 3378377, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4742f2dd662f88d3642b67a6e6890880?s=128&d=identicon&r=PG&f=1", "display_name": "eugene251", "link": "https://stackoverflow.com/users/3378377/eugene251"}, "edited": false, "score": 0, "creation_date": 1516212288, "post_id": 48306157, "comment_id": 83599981, "body": "The code I post is just an example, you need to modify the code and you will be able to receive an array as result."}, {"owner": {"reputation": 57, "user_id": 3378377, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4742f2dd662f88d3642b67a6e6890880?s=128&d=identicon&r=PG&f=1", "display_name": "eugene251", "link": "https://stackoverflow.com/users/3378377/eugene251"}, "edited": false, "score": 0, "creation_date": 1516212771, "post_id": 48306157, "comment_id": 83600228, "body": "i understand what you are suggesting but the function is in a xll-file so i can only run it with <code>Application.Run(...)</code>  i can not see the function itself."}, {"owner": {"user_type": "does_not_exist", "display_name": "user8753746"}, "reply_to_user": {"reputation": 57, "user_id": 3378377, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4742f2dd662f88d3642b67a6e6890880?s=128&d=identicon&r=PG&f=1", "display_name": "eugene251", "link": "https://stackoverflow.com/users/3378377/eugene251"}, "edited": false, "score": 0, "creation_date": 1516220970, "post_id": 48306157, "comment_id": 83604559, "body": "Then the function should be modified to return an array."}, {"owner": {"reputation": 770, "user_id": 1108056, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/db29ab9496d7cf1beed295ebdd1e5677?s=128&d=identicon&r=PG", "display_name": "AnotherParker", "link": "https://stackoverflow.com/users/1108056/anotherparker"}, "edited": false, "score": 0, "creation_date": 1521242555, "post_id": 48306157, "comment_id": 85663631, "body": "The function does return an array when it&#39;s called in the worksheet; he&#39;s asking how to get the array into VBA without using the worksheet as intermediary."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user8753746"}, "is_accepted": false, "score": 0, "last_activity_date": 1516207797, "last_edit_date": 1525816189, "creation_date": 1516207797, "answer_id": 48306157, "question_id": 48305967, "link": "https://stackoverflow.com/questions/48305967/application-run-for-macro-returning-arrays/48306157#48306157", "title": "Application.Run for Macro returning Arrays", "body": "<p>I found this example at Chip's website:\n<a href=\"http://www.cpearson.com/excel/passingandreturningarrays.htm\" rel=\"nofollow noreferrer\">http://www.cpearson.com/excel/passingandreturningarrays.htm</a></p>\n\n<pre><code>Sub AAATest()\n    Dim Arr() As Long\n    Dim N As Long\n    Arr = LoadNumbers(Low:=101, High:=110)\n    If IsArrayAllocated(Arr:=Arr) = True Then\n        For N = LBound(Arr) To UBound(Arr)\n           Debug.Print Arr(N)\n        Next N\n    Else\n        ''''''''''''''''''''''''''''''''''''\n        ' Code in case Arr is not allocated.\n        ''''''''''''''''''''''''''''''''''''\n    End If\nEnd Sub\n\nFunction LoadNumbers(Low As Long, High As Long) As Long()\n    '''''''''''''''''''''''''''''''''''''''\n    ' Returns an array of Longs, containing\n    ' the numbers from Low to High. The \n    ' number of elements in the returned\n    ' array will vary depending on the \n    ' values of Low and High.\n    ''''''''''''''''''''''''''''''''''''''''\n\n    '''''''''''''''''''''''''''''''''''''''''\n    ' Declare ResultArray as a dynamic array\n    ' to be resized based on the values of\n    ' Low and High.\n    '''''''''''''''''''''''''''''''''''''''''\n    Dim ResultArray() As Long\n    Dim Ndx As Long\n    Dim Val As Long\n    '''''''''''''''''''''''''''''''''''''''''\n    ' Ensure Low &lt;= High\n    '''''''''''''''''''''''''''''''''''''''''\n    If Low &gt; High Then\n        Exit Function\n    End If\n    '''''''''''''''''''''''''''''''''''''''''\n    ' Resize the array\n    '''''''''''''''''''''''''''''''''''''''''\n    ReDim ResultArray(1 To (High - Low + 1))\n    ''''''''''''''''''''''''''''''''''''''''\n    ' Fill the array with values.\n    ''''''''''''''''''''''''''''''''''''''''\n    Val = Low\n    For Ndx = LBound(ResultArray) To UBound(ResultArray)\n        ResultArray(Ndx) = Val\n        Val = Val + 1\n    Next Ndx\n    ''''''''''''''''''''''''''''''''''''''''\n    ' Return the array.\n    ''''''''''''''''''''''''''''''''''''''''\n    LoadNumbers = ResultArray()\n\nEnd Function\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 770, "user_id": 1108056, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/db29ab9496d7cf1beed295ebdd1e5677?s=128&d=identicon&r=PG", "display_name": "AnotherParker", "link": "https://stackoverflow.com/users/1108056/anotherparker"}, "is_accepted": false, "score": 0, "last_activity_date": 1521242737, "creation_date": 1521242737, "answer_id": 49330810, "question_id": 48305967, "link": "https://stackoverflow.com/questions/48305967/application-run-for-macro-returning-arrays/49330810#49330810", "title": "Application.Run for Macro returning Arrays", "body": "<p>You can call into the function using a <code>Declare Function</code> statement in VBA (though you'll need to acquire some tools to convert the parameters from VBA format to Excel SDK format, and vice versa for the return value), or using <code>ExecuteExcel4Macro</code> or <code>Evaluate</code> (though those require converting all the arguments to strings first).</p>\n\n<p>See this web page:\n<a href=\"https://fastexcel.wordpress.com/2014/12/13/calling-xlamxllautomation-udfs-from-vba-evaluate-run-or-reference/\" rel=\"nofollow noreferrer\">https://fastexcel.wordpress.com/2014/12/13/calling-xlamxllautomation-udfs-from-vba-evaluate-run-or-reference/</a></p>\n\n<p>And this question:\n<a href=\"https://stackoverflow.com/questions/375552/how-do-i-call-an-xll-addin-function-from-vba\">How do I call an xll addin function from vba?</a></p>\n"}], "owner": {"reputation": 57, "user_id": 3378377, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4742f2dd662f88d3642b67a6e6890880?s=128&d=identicon&r=PG&f=1", "display_name": "eugene251", "link": "https://stackoverflow.com/users/3378377/eugene251"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 617, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1521242737, "creation_date": 1516207136, "question_id": 48305967, "link": "https://stackoverflow.com/questions/48305967/application-run-for-macro-returning-arrays", "title": "Application.Run for Macro returning Arrays", "body": "<p>i want to call a function \"arrayfun1\" in vba from an xll-addin with \"Application.Run\"</p>\n\n<pre><code>Sub test()\nDim val As Variant\nval = Application.Run(\"arrayfun1\", arg1, arg2, ...)\nEnd Sub\n</code></pre>\n\n<p>this works for functions that return just one output, but not for functions that return arrays. However, if i use the function as Arrayformula in a sheet it works. But i am looking for a programatical solution.</p>\n\n<p>any ideas?</p>\n"}, {"tags": ["vba", "outlook"], "answers": [{"comments": [{"owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "edited": false, "score": 0, "creation_date": 1516217754, "post_id": 48307827, "comment_id": 83602816, "body": "Application_ItemSend in ThisOutlookSession. See <a href=\"https://stackoverflow.com/questions/35806335/how-can-i-automatically-run-a-macro-when-an-email-is-sent-in-outlook\" title=\"how can i automatically run a macro when an email is sent in outlook\">stackoverflow.com/questions/35806335/&hellip;</a>  and  <a href=\"https://stackoverflow.com/questions/16044846/run-macro-when-email-is-sent\" title=\"run macro when email is sent\">stackoverflow.com/questions/16044846/&hellip;</a>"}], "tags": [], "owner": {"reputation": 1, "user_id": 9230592, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f5abfd4259d683027caac84cf42018a?s=128&d=identicon&r=PG&f=1", "display_name": "Tina ", "link": "https://stackoverflow.com/users/9230592/tina"}, "is_accepted": false, "score": 0, "last_activity_date": 1516214563, "last_edit_date": 1516214563, "creation_date": 1516214153, "answer_id": 48307827, "question_id": 48305650, "link": "https://stackoverflow.com/questions/48305650/change-subject-line-on-all-outbound-mail/48307827#48307827", "title": "Change subject line on all outbound mail", "body": "<p>So I found a solution to question 2 (Thanks to other code on this site :) this works! - if you see any issue with using this however please let me know).  also - I have currently added a button to the quick access toolbar to manually run this to update the Subject line.   I would love to have this auto populate on all outbound emails though - so if you have any suggestions I would appreciate it!    I'd prefer to not enable all Macros if possible though..\nthank you!!</p>\n\n<pre><code>Dim Item As Outlook.MailItem\nDim oInspector As Inspector\nSet oInspector = Application.ActiveInspector\nSet Item = oInspector.CurrentItem\n\nIf InStr(Item.Subject, \"New Value -\") &gt; 0 Then\n\nElse\n\n    Item.Subject = \"New Value -\" &amp; Item.Subject\n\nEnd If\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 6477, "user_id": 9608718, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/414d776388a58815290c0efc4a4bb114?s=128&d=identicon&r=PG&f=1", "display_name": "Alex Riabov", "link": "https://stackoverflow.com/users/9608718/alex-riabov"}, "edited": false, "score": 1, "creation_date": 1531502854, "post_id": 51329990, "comment_id": 89635926, "body": "While this code may answer the question, providing additional context regarding why and/or how this code answers the question improves its long-term value."}], "tags": [], "owner": {"reputation": 1, "user_id": 10077302, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/5012abce55a3d1f59627c3a11ed7a95d?s=128&d=identicon&r=PG", "display_name": "Niels Hackett", "link": "https://stackoverflow.com/users/10077302/niels-hackett"}, "is_accepted": false, "score": 0, "last_activity_date": 1531502121, "creation_date": 1531502121, "answer_id": 51329990, "question_id": 48305650, "link": "https://stackoverflow.com/questions/48305650/change-subject-line-on-all-outbound-mail/51329990#51329990", "title": "Change subject line on all outbound mail", "body": "<pre><code>Private Sub Application_ItemSend(ByVal Item As Object, Cancel As Boolean)\nIf InStr(Item.Subject, \"New Value -\") &lt; 1 Then\n    Item.Subject = \"New Value -\" &amp; Item.Subject\nEnd If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 9230592, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f5abfd4259d683027caac84cf42018a?s=128&d=identicon&r=PG&f=1", "display_name": "Tina ", "link": "https://stackoverflow.com/users/9230592/tina"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 701, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1531502121, "creation_date": 1516206168, "last_edit_date": 1516688241, "question_id": 48305650, "link": "https://stackoverflow.com/questions/48305650/change-subject-line-on-all-outbound-mail", "title": "Change subject line on all outbound mail", "body": "<p>I found the following code to update the subject line.</p>\n\n<pre><code>Sub ChangeSubjectSelection()\n\nDim selectionIndex As Long\nDim itm As Object\n\nFor selectionIndex = 1 To ActiveExplorer.Selection.Count\n\n    Set itm = ActiveExplorer.Selection(selectionIndex)\n\n    If TypeOf itm Is MailItem Then\n        itm.Subject = \"add value here-\" &amp; itm.Subject\n        itm.Save\n    End If\nNext\n\nEnd Sub\n</code></pre>\n\n<ol>\n<li>I want this on all outbound emails, but from reading it looks like I have to enable macros, which could be a security risk for inbound emails - yes? </li>\n<li>I added a button to the toolbar for outbound emails to fire the VBA, but it changed the ORIGINAL email, not the REPLY email. </li>\n</ol>\n\n<p>I want this on <strong>ALL OUTBOUND</strong> emails.  Forwards, new, replies should have this new word or phrase in the subject- but my current method is updating basically the last email I was sitting on- if I was replying, it would update the original.  If I am creating an email it updates the last email I had opened.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1516208026, "post_id": 48305438, "comment_id": 83597453, "body": "I don&#39;t understand this statement &quot;I will need 10*9*8*7*6*5*4*3*2 nested select statements for the first check alone&quot;. Don&#39;t you just need 10?"}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 2, "creation_date": 1516208643, "post_id": 48305438, "comment_id": 83597858, "body": "Looks to me like you&#39;re overthinking it - I think you could achieve all of this with two nested loops"}, {"owner": {"reputation": 315, "user_id": 9057704, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/92b8098293d8382d61623df795e1aa51?s=128&d=identicon&r=PG&f=1", "display_name": "Gregory", "link": "https://stackoverflow.com/users/9057704/gregory"}, "edited": false, "score": 0, "creation_date": 1516208661, "post_id": 48305438, "comment_id": 83597872, "body": "All rows between the two values are the same (e.g., 1&amp;10=same, then 2-9=same as 1&amp;10). I want each row checked individually and its unique id added to a string. If the loop hits on one then it won&#39;t check the other conditions, as far as I understand it? This means that it has to go a layer deeper on each hit to successfully gather all of the unique ids for the rows with the blank cell?"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 1, "creation_date": 1516210792, "post_id": 48305438, "comment_id": 83599140, "body": "Can you post a screenshot, am struggling to follow this?"}, {"owner": {"reputation": 315, "user_id": 9057704, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/92b8098293d8382d61623df795e1aa51?s=128&d=identicon&r=PG&f=1", "display_name": "Gregory", "link": "https://stackoverflow.com/users/9057704/gregory"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1516213007, "post_id": 48305438, "comment_id": 83600352, "body": "@sjr <a href=\"https://prnt.sc/i1takf\" rel=\"nofollow noreferrer\">prnt.sc/i1takf</a>"}, {"owner": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "edited": false, "score": 0, "creation_date": 1516229256, "post_id": 48305438, "comment_id": 83608332, "body": "seems like just one For loop to find the last value that is equal to the first, and another For loop to check if all of the values before it are equal to the first value too."}, {"owner": {"reputation": 315, "user_id": 9057704, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/92b8098293d8382d61623df795e1aa51?s=128&d=identicon&r=PG&f=1", "display_name": "Gregory", "link": "https://stackoverflow.com/users/9057704/gregory"}, "reply_to_user": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "edited": false, "score": 0, "creation_date": 1516229558, "post_id": 48305438, "comment_id": 83608453, "body": "@slai not all will necessarily be equal. It could be the case that 10,8,6,2 are but the rest are not."}, {"owner": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "edited": false, "score": 0, "creation_date": 1516230136, "post_id": 48305438, "comment_id": 83608654, "body": "then you may need to explain 1a better, and probably needs few good examples. The screenshot seems to make it even more confusing."}, {"owner": {"reputation": 315, "user_id": 9057704, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/92b8098293d8382d61623df795e1aa51?s=128&d=identicon&r=PG&f=1", "display_name": "Gregory", "link": "https://stackoverflow.com/users/9057704/gregory"}, "reply_to_user": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "edited": false, "score": 0, "creation_date": 1516235980, "post_id": 48305438, "comment_id": 83610202, "body": "@Slai I&#39;ve updated the OP."}], "answers": [{"tags": [], "owner": {"reputation": 1688, "user_id": 9259306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EIROY.png?s=128&g=1", "display_name": "Mistella", "link": "https://stackoverflow.com/users/9259306/mistella"}, "is_accepted": false, "score": 0, "last_activity_date": 1521569424, "creation_date": 1521569424, "answer_id": 49391382, "question_id": 48305438, "link": "https://stackoverflow.com/questions/48305438/select-case-fall-through-in-vba/49391382#49391382", "title": "Select Case fall through in VBA?", "body": "<p>I rewrote your <code>selectcasefallthrough</code> to make it more flexible, and added some additional comments. Since I wasn't sure which section of your psuedocode was currently giving you trouble, I didn't add any additional capabilities. However, I can edit them in, once I know which psuedocode step you're currently stuck on.</p>\n\n<pre><code>Sub selectcasetryagain()\nDim c As Range 'Will no longer access Global c\nDim r As Range\nDim lastRow As Long\nDim lastCol As Long\n\nlastRow = Range(\"A:A\").End(xlDown).Row\nlastCol = Cells(1, Columns.Count).End(xlToLeft).Column\n\nSet r = ActiveSheet.Range(Cells(1, 1), Cells(lastRow, lastCol))\n\nFor i = 2 To lastRow\n    Set c = r.Cells(i, 6)\n    Select Case c.Value\n        Case SelectCaseFallThru(10, c) ' Added in row number to make it variable\n\n    End Select\nNext i\n\nEnd Sub\n\nOption Explicit\nPublic c, r As Range 'Note: currently Global c is defined as a Variant\nPublic i As Integer\nPublic lastRow, lastCol As Long\nPublic RMissing As Variant\n\n'This function does not currently return anything.\nFunction SelectCaseFallThru(maxRowNum as Integer, Optional c As Variant, Optional d As Variant) 'This Function will use the Optional c, not the Global c\n    Dim counter as Integer\n    Dim found as Boolean\n\n    For counter = maxRowNum to 1 step -1\n        If c.Value = c.Offset(counter, 0).Value Then\n            Debug.Print c.Value &amp; \" - \" &amp; c.Offset(counter, 0).Value\n            If IsEmpty(c.Offset(0, 46)).Value And IsEmpty(c.Offset(0, 47)).Value and counter = maxRowNum Then 'added check for counter\n                RMissing = c.Offset(0, 42).Value\n            End if\n            i = i + counter\n            found = True\n            Exit For\n        End If\n    Next counter\n\n    If not found Then Exit Function\n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 315, "user_id": 9057704, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/92b8098293d8382d61623df795e1aa51?s=128&d=identicon&r=PG&f=1", "display_name": "Gregory", "link": "https://stackoverflow.com/users/9057704/gregory"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 307, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1521569424, "creation_date": 1516205461, "last_edit_date": 1516235917, "question_id": 48305438, "link": "https://stackoverflow.com/questions/48305438/select-case-fall-through-in-vba", "title": "Select Case fall through in VBA?", "body": "<p>I am using a select case statement in conjunction with a function to create fall through in VBA, but I can't seem to figure out how it should be structured. Here's what I'm looking for it to do:</p>\n\n<ol>\n<li><p>Check if row values 1 &amp; 10 have same unique ID (if not: 1&amp;9;1&amp;8,1&amp;7,...,1&amp;2) </p>\n\n<p>1a. If row values 1 &amp; 10 have same unique ID then all rows inbetween do as well</p>\n\n<p>2a. Even though all rows have same unique ID, it <em>does not mean that the cells I want to check afterward are all the same</em> -- for example: rows 1,3,4,7,8,10 may have blank cells while rows 2,5,9 are not blank. In order to determine that, it has to go through each row from 10 through 1 to determine this. One row does not affect another; any/all/none of the rows from 1-10 can have blank cells despite them all having the same unique ID.</p></li>\n<li><p>check for blank cell in all rows between and including the first and last</p></li>\n<li><p>Concatenate unique IDs of all rows with blank cells.</p></li>\n</ol>\n\n<p>The issue is this: I will need 10+9+8+7+6+5+4+3+2 nested select statements for the first check alone.</p>\n\n<hr>\n\n<p>Here is a psuedocode example:</p>\n\n<p>Begin First loop (first range: Excel sheet rows 2-12; 10 rows):</p>\n\n<p>Rows 1 &amp; 10 have same unique id</p>\n\n<p>Check row 10 for blank cells</p>\n\n<p>No blank cells in row 10</p>\n\n<p>Check row 9 for blank cells</p>\n\n<p>Blank cells found -> add info to string</p>\n\n<p>Check row 8 for blank cells</p>\n\n<p>Blank cells found -> add info to string</p>\n\n<p>Check row 7 for blank cells</p>\n\n<p>No blank cells found</p>\n\n<p>Check row 6 for blank cells</p>\n\n<p>Blank cells found - > add info to string</p>\n\n<p>Check row 5 for blank cells</p>\n\n<p>....</p>\n\n<p>No more blank cells found</p>\n\n<p>Begin Second loop (second range: Excel sheet rows 12-14; 3 rows):</p>\n\n<p>Cells 12 and 14 match</p>\n\n<p>Check row 14 for blank cells</p>\n\n<p>Blank cells found -> add info to separate string</p>\n\n<p>Check row 13 for blank cells</p>\n\n<p>No Blank cells found</p>\n\n<p>Check row 12 for blank cells</p>\n\n<p>No blank cells found</p>\n\n<hr>\n\n<p>My current code is below:</p>\n\n<pre><code>Sub selectcasetryagain()\nDim c As Range\nDim r As Range\nDim lastRow As Long\nDim lastCol As Long\n\nlastRow = Range(\"A:A\").End(xlDown).Row\nlastCol = Cells(1, Columns.Count).End(xlToLeft).Column\n\nSet r = ActiveSheet.Range(Cells(1, 1), Cells(lastRow, lastCol))\n\nFor i = 2 To lastRow\n    Set c = r.Cells(i, 6)\n    Select Case c.Value\n        Case SelectCaseFallThru(c)\n\n    End Select\nNext i\n\nEnd Sub\n\nOption Explicit\nPublic c, r As Range\nPublic i As Integer\nPublic lastRow, lastCol As Long\nPublic RMissing As Variant\n\nFunction SelectCaseFallThru(Optional c As Variant, Optional d As Variant)\n    If c.Value = c.Offset(10, 0).Value Then\n        Debug.Print c.Value &amp; \" - \" &amp; c.Offset(10, 0).Value\n        If IsEmpty(c.Offset(0, 46)).Value And IsEmpty(c.Offset(0, 47)).Value Then\n            RMissing = c.Offset(0, 42).Value\n        i = i + 10\n    ElseIf c.Value = c.Offset(9, 0).Value Then\n        Debug.Print c.Value &amp; \" - \" &amp; c.Offset(9, 0).Value\n        i = i + 9\n    ElseIf c.Value = c.Offset(8, 0).Value Then\n        Debug.Print c.Value &amp; \" - \" &amp; c.Offset(8, 0).Value\n        i = i + 8\n    ElseIf c.Value = c.Offset(7, 0).Value Then\n        Debug.Print c.Value &amp; \" - \" &amp; c.Offset(7, 0).Value\n        i = i + 7\n    ElseIf c.Value = c.Offset(6, 0).Value Then\n        Debug.Print c.Value &amp; \" - \" &amp; c.Offset(6, 0).Value\n        i = i + 6\n    ElseIf c.Value = c.Offset(5, 0).Value Then\n        Debug.Print c.Value &amp; \" - \" &amp; c.Offset(5, 0).Value\n        i = i + 5\n    ElseIf c.Value = c.Offset(4, 0).Value Then\n        Debug.Print c.Value &amp; \" - \" &amp; c.Offset(4, 0).Value\n        i = i + 4\n    ElseIf c.Value = c.Offset(3, 0).Value Then\n        Debug.Print c.Value &amp; \" - \" &amp; c.Offset(3, 0).Value\n        i = i + 3\n    ElseIf c.Value = c.Offset(2, 0).Value Then\n        Debug.Print c.Value &amp; \" - \" &amp; c.Offset(2, 0).Value\n        i = i + 2\n    ElseIf c.Value = c.Offset(1, 0).Value Then\n        Debug.Print c.Value &amp; \" - \" &amp; c.Offset(1, 0).Value\n        i = i + 1\n    Else\n        Exit Function\n    End If\n\n\nEnd Function\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user8753746"}, "edited": false, "score": 0, "creation_date": 1516206810, "post_id": 48305424, "comment_id": 83596681, "body": "Did you tried <code>LEFT</code> function?"}, {"owner": {"reputation": 27, "user_id": 8772378, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04658717980a52342283c2f8a3c84aaa?s=128&d=identicon&r=PG&f=1", "display_name": "SirHillaryPushemoff", "link": "https://stackoverflow.com/users/8772378/sirhillarypushemoff"}, "edited": false, "score": 0, "creation_date": 1516207800, "post_id": 48305424, "comment_id": 83597292, "body": "Not yet, since I&#39;m not sure how to insert it in my existing code without disturbing the rest of the copying algorithm"}, {"owner": {"reputation": 27, "user_id": 8772378, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04658717980a52342283c2f8a3c84aaa?s=128&d=identicon&r=PG&f=1", "display_name": "SirHillaryPushemoff", "link": "https://stackoverflow.com/users/8772378/sirhillarypushemoff"}, "edited": false, "score": 0, "creation_date": 1516210122, "post_id": 48305424, "comment_id": 83598757, "body": "Is there a way I can insert a code of line to truncate the copied cell as it is being copied from one sheet to another?"}], "answers": [{"comments": [{"owner": {"reputation": 27, "user_id": 8772378, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04658717980a52342283c2f8a3c84aaa?s=128&d=identicon&r=PG&f=1", "display_name": "SirHillaryPushemoff", "link": "https://stackoverflow.com/users/8772378/sirhillarypushemoff"}, "edited": false, "score": 0, "creation_date": 1516715022, "post_id": 48311514, "comment_id": 83794572, "body": "Works perfectly, albeit with a decent crunch on resources.  Thanks so much!"}], "tags": [], "owner": {"reputation": 121, "user_id": 9086188, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/038d12c507d0067c56dc6ea8cd28330f?s=128&d=identicon&r=PG", "display_name": "AmBo", "link": "https://stackoverflow.com/users/9086188/ambo"}, "is_accepted": true, "score": 0, "last_activity_date": 1516230881, "creation_date": 1516230881, "answer_id": 48311514, "question_id": 48305424, "link": "https://stackoverflow.com/questions/48305424/enhancing-copy-marco-to-specify-a-given-number-of-characters-from-a-string/48311514#48311514", "title": "Enhancing copy marco to specify a given number of characters from a string", "body": "<p>After your first loop :</p>\n\n<pre><code>For Each c In sheets(\"Portfolio\").Range(\"A1:A\" &amp; X-1)\n    c.offset(0,1)=left(c.offset(0,1),9) 'For column \"B\" in sheets \"Portfolio\"\n    c.offset(0,5)=left(c.offset(0,5),9) 'For column \"F\" in sheets \"Portfolio\"\n    '...\nNext c\n</code></pre>\n"}], "owner": {"reputation": 27, "user_id": 8772378, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04658717980a52342283c2f8a3c84aaa?s=128&d=identicon&r=PG&f=1", "display_name": "SirHillaryPushemoff", "link": "https://stackoverflow.com/users/8772378/sirhillarypushemoff"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 26, "favorite_count": 0, "accepted_answer_id": 48311514, "answer_count": 1, "score": 0, "last_activity_date": 1516230881, "creation_date": 1516205403, "last_edit_date": 1531161705, "question_id": 48305424, "link": "https://stackoverflow.com/questions/48305424/enhancing-copy-marco-to-specify-a-given-number-of-characters-from-a-string", "title": "Enhancing copy marco to specify a given number of characters from a string", "body": "<p>I have a macro in Excel that accurately copies all the data from one page to another.  </p>\n\n<pre><code>Dim c As Range\n    For Each c In Sheets(\"Data\").Range(\"A1:L\" &amp; bottomL)\n        If (c.Value = \"Title1\" Or c.Value = \"Title2\" Or c.Value = \"Title3\" Or c.Value = \"Title4\") Then\n            Intersect(c.Parent.Columns(\"A:Q\"), c.EntireRow).Copy Worksheets(\"Portfolio\").Range(\"A\" &amp; x + 1)\n            x = x + 1\n        End If\n    Next c\n</code></pre>\n\n<p>Now, I need to add a line that specifies how many characters to copy from a given column (i.e. only copy the first 9 characters from column C), similar to the code below:</p>\n\n<pre><code>For Each cell In ws.Range(\"C:C\").Cells\n    cell.Offset(0, 1).Value = Left(cell.Value, 9)\nNext cell\n</code></pre>\n\n<p>What is the easiest way I might be able to insert this seamlessly into my original code?</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 9230490, "user_type": "registered", "profile_image": "https://graph.facebook.com/10212930420788378/picture?type=large", "display_name": "Josh Taylor", "link": "https://stackoverflow.com/users/9230490/josh-taylor"}, "edited": false, "score": 0, "creation_date": 1516210675, "post_id": 48305788, "comment_id": 83599068, "body": "Still stops at the same spot    ThisWorkbook.Sheets(vArray(i)).Select"}], "tags": [], "owner": {"reputation": 7497, "user_id": 8670372, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ir8a4Lbosmo/AAAAAAAAAAI/AAAAAAAAOtE/2eY5jK1atcc/photo.jpg?sz=128", "display_name": "Xabier", "link": "https://stackoverflow.com/users/8670372/xabier"}, "is_accepted": false, "score": 0, "last_activity_date": 1516206615, "creation_date": 1516206615, "answer_id": 48305788, "question_id": 48305262, "link": "https://stackoverflow.com/questions/48305262/varray-if-else-macro/48305788#48305788", "title": "vArray if else macro", "body": "<p>Try the following, this will loop through your array and do what you expect:</p>\n\n<pre><code>Sub ToyotaMO()\n'\n' ToyotaMO Macro\n'\n\n    Sheets(\"TC\").Visible = True\n    Sheets(\"BS\").Visible = True\n    Sheets(\"ToyotaMO\").Activate\n        If Sheets(\"ACM\").OLEObjects(\"Toyota\").Object.Value = True Then\n            vArray = Array(\"ToyotaMO\", \"TC\", \"BS\")\n        Else\n            vArray = Array(\"Proposal\", \"TC\")\n        End If\n\n    For i = LBound(vArray) To UBound(vArray)\n        ThisWorkbook.Sheets(vArray(i)).Select\n        ActiveSheet.ExportAsFixedFormat Type:=xlTypePDF, Filename:= _\n        ThisWorkbook.Path &amp; \"\\\" &amp; ActiveSheet.Range(\"C5\").Value &amp; \" Toyota Material Only ACM Proposal\" &amp; Format(Date, \" MMDDYY\") &amp; \".pdf\" _\n        , Quality:=xlQualityStandard, IncludeDocProperties:=True, IgnorePrintAreas _\n        :=False, OpenAfterPublish:=True\n        Sheets(\"ToyotaMO\").Activate\n        Range(\"A1\").Select\n        Sheets(\"TC\").Visible = False\n        Sheets(\"BS\").Visible = False\n        Sheets(\"ACM\").Select\n        Range(\"B1\").Select\n    Next i\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 9230490, "user_type": "registered", "profile_image": "https://graph.facebook.com/10212930420788378/picture?type=large", "display_name": "Josh Taylor", "link": "https://stackoverflow.com/users/9230490/josh-taylor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 33, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1516206615, "creation_date": 1516204948, "last_edit_date": 1516205079, "question_id": 48305262, "link": "https://stackoverflow.com/questions/48305262/varray-if-else-macro", "title": "vArray if else macro", "body": "<p>I am trying to create a macro the adds different pages to a pdf based on a check box status.  This is what I currently have.</p>\n\n<pre><code>Sub ToyotaMO()\n'\n' ToyotaMO Macro\n'\n\n    Sheets(\"TC\").Visible = True\n    Sheets(\"BS\").Visible = True\n    Sheets(\"ToyotaMO\").Activate\n        If Sheets(\"ACM\").OLEObjects(\"Toyota\").Object.Value = True Then\n            vArray = Array(\"ToyotaMO\", \"TC\", \"BS\")\n        Else\n            vArray = Array(\"Proposal\", \"TC\")\n        End If\n    ThisWorkbook.Sheets(vArray).Select\n    ActiveSheet.ExportAsFixedFormat Type:=xlTypePDF, Filename:= _\n    ThisWorkbook.Path &amp; \"\\\" &amp; ActiveSheet.Range(\"C5\").Value &amp; \" Toyota Material Only ACM Proposal\" &amp; Format(Date, \" MMDDYY\") &amp; \".pdf\" _\n    , Quality:=xlQualityStandard, IncludeDocProperties:=True, IgnorePrintAreas _\n    :=False, OpenAfterPublish:=True\n    Sheets(\"ToyotaMO\").Activate\n    Range(\"A1\").Select\n    Sheets(\"TC\").Visible = False\n    Sheets(\"BS\").Visible = False\n    Sheets(\"ACM\").Select\n    Range(\"B1\").Select\nEnd Sub\n</code></pre>\n\n<p>The macro works on all the other forms the only difference is I need to add worksheet \"BS\" to the PDF if the checkbox is checked.  VBA always stalls at <code>ThisWorkbook.Sheets(vArray).Select</code>.</p>\n\n<p>Any help is greatly appreciated</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 177, "user_id": 7502029, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f02e63402f13f6ae2c68c4d72a292e06?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin P.", "link": "https://stackoverflow.com/users/7502029/kevin-p"}, "edited": false, "score": 0, "creation_date": 1516205447, "post_id": 48305334, "comment_id": 83595842, "body": "It does not, I even tried messing around with the similar post that was given to me. I get a type mismatch on <code>For i = 1 To (&quot;T66&quot;)</code>"}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "reply_to_user": {"reputation": 177, "user_id": 7502029, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f02e63402f13f6ae2c68c4d72a292e06?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin P.", "link": "https://stackoverflow.com/users/7502029/kevin-p"}, "edited": false, "score": 0, "creation_date": 1516205630, "post_id": 48305334, "comment_id": 83595946, "body": "@KevinP.  Is the name of the first macro <b>T1</b> or <b>Macro1</b> or <b>MacroT1</b> ???"}, {"owner": {"reputation": 177, "user_id": 7502029, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f02e63402f13f6ae2c68c4d72a292e06?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin P.", "link": "https://stackoverflow.com/users/7502029/kevin-p"}, "edited": false, "score": 0, "creation_date": 1516205632, "post_id": 48305334, "comment_id": 83595949, "body": "Nevermind. I needed to clarify where my range was by putting <code>Sheet1.Range(&quot;T66&quot;)</code> Thank you!"}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "reply_to_user": {"reputation": 177, "user_id": 7502029, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f02e63402f13f6ae2c68c4d72a292e06?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin P.", "link": "https://stackoverflow.com/users/7502029/kevin-p"}, "edited": false, "score": 0, "creation_date": 1516205703, "post_id": 48305334, "comment_id": 83595989, "body": "@KevinP.  Update this post if you require more help."}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": true, "score": 1, "last_activity_date": 1516205169, "creation_date": 1516205169, "answer_id": 48305334, "question_id": 48305204, "link": "https://stackoverflow.com/questions/48305204/call-macroi-for-loop/48305334#48305334", "title": "Call Macro(i) (For loop)", "body": "<p>Is this helpful?</p>\n\n<pre><code>Sub dural()\n    For i = 1 To 3\n        Application.Run \"Macro\" &amp; i\n    Next i\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 177, "user_id": 7502029, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f02e63402f13f6ae2c68c4d72a292e06?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin P.", "link": "https://stackoverflow.com/users/7502029/kevin-p"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 873, "favorite_count": 0, "closed_date": 1516204909, "accepted_answer_id": 48305334, "answer_count": 1, "score": 0, "last_activity_date": 1516205787, "creation_date": 1516204801, "last_edit_date": 1531164843, "question_id": 48305204, "link": "https://stackoverflow.com/questions/48305204/call-macroi-for-loop", "closed_reason": "Duplicate", "title": "Call Macro(i) (For loop)", "body": "<p>I can't seem to find anything on the web for this. I am wondering if there is a way to call a <strong>loop</strong> of macro's. I have <strong>Macro1() - Macro16()</strong> and I want to run them consecutively based on the value in another cell. Using this code causes a compile error:</p>\n\n<blockquote>\n  <p>Sub or Function not defined.</p>\n</blockquote>\n\n<p>Can this be achieved?</p>\n\n<pre><code>Sub PlotAll()\n    Dim i As Integer\n    Application.ScreenUpdating = False\n    If Sheet1.Range(\"T66\") &lt;&gt; 0 Then\n        For i = 1 To Sheet1.Range(\"T66\") ' T66 is number of Macro's to perform\n            Call Macroi\n        Next i\n    Else\n        MsgBox \"You do not have any points to plot.\", vbExclamation\n    End If\n    Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 0, "creation_date": 1516204837, "post_id": 48305144, "comment_id": 83595407, "body": "Haven&#39;t dug in deep yet, but your <code>With ws</code> is superfluous. The Range object <code>addme</code> knows which sheet in which it resides."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 1, "creation_date": 1516204844, "post_id": 48305144, "comment_id": 83595418, "body": "And in <code>addme.Offset.Value</code> you need to specify the offset like <code>addme.Offset(0, 1).Value</code>. Afterwards resetting a textbox would be as easy like <code>Me.txtNeedsAnalysSum = vbNullString</code> and for the checkboxes <code>Me.chkInRes = False</code>. For resetting comboboxes see textboxes."}], "answers": [{"tags": [], "owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "is_accepted": false, "score": 1, "last_activity_date": 1516205196, "creation_date": 1516205196, "answer_id": 48305342, "question_id": 48305144, "link": "https://stackoverflow.com/questions/48305144/vba-excel-userform-move-to-next-empty-row/48305342#48305342", "title": "vba excel userform move to next empty row", "body": "<p>I think you want do something like:</p>\n\n<pre><code>Private Sub cmdSubmit_Click()\n    Dim ws As Worksheet\n    Dim addme As Range\n    Set ws = Sheet1\n    Set addme = ws.Cells(Rows.Count, 1).End(xlUp).Offset(1, 0)\n\n\n        addme.Offset(,1).Value = Me.txtNeedsAnalysSum\n        addme.Offset(,2).Value = Me.txtSummaryOfTask\n        addme.Offset(,3).Value = Me.txtIntroduction\n        addme.Offset(,4).Value = Me.chkInRes\n        addme.Offset(,5).Value = Me.chkOnline\n        addme.Offset(,6).Value = Me.chk24Hr\n        addme.Offset(,7).Value = Me.chk3days\n        addme.Offset(,8).Value = Me.chkDurOther\n        addme.Offset(,9).Value = Me.cmbPrereqReq\n        addme.Offset(,10).Value = Me.cmbPrereqRec\n\nEnd Sub\n</code></pre>\n\n<p>You could, potentially, loop through the controls in your form and use a variable to track which column you are writing to:</p>\n\n<pre><code>Private Sub cmdSubmit_Click()\n    Dim ws As Worksheet\n    Dim addme As Range\n    Set ws = Sheet1\n    Set addme = ws.Cells(Rows.Count, 1).End(xlUp).Offset(1, 0)\n\n    Dim cntrl As control\n    Dim intCol as integer\n    intCol = 0\n    For Each cntrl in Me.Controls\n        addme.offset(, intCol) = cntrl\n        intCol = intCol + 1\n    Next cntrl        \nEnd Sub\n</code></pre>\n\n<p>That will also pick up labels and submit buttons and what have you, so YMMV.</p>\n"}, {"comments": [{"owner": {"reputation": 3, "user_id": 9230358, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/41efdcda3973ad2b85d55db4abf3259f?s=128&d=identicon&r=PG&f=1", "display_name": "Joe C.", "link": "https://stackoverflow.com/users/9230358/joe-c"}, "edited": false, "score": 0, "creation_date": 1516285908, "post_id": 48305353, "comment_id": 83632549, "body": "Thanks!  The last code (Xabier) worked perfectly.  And I learned a few things.  Much appreciated."}, {"owner": {"reputation": 7497, "user_id": 8670372, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ir8a4Lbosmo/AAAAAAAAAAI/AAAAAAAAOtE/2eY5jK1atcc/photo.jpg?sz=128", "display_name": "Xabier", "link": "https://stackoverflow.com/users/8670372/xabier"}, "reply_to_user": {"reputation": 3, "user_id": 9230358, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/41efdcda3973ad2b85d55db4abf3259f?s=128&d=identicon&r=PG&f=1", "display_name": "Joe C.", "link": "https://stackoverflow.com/users/9230358/joe-c"}, "edited": false, "score": 0, "creation_date": 1516286506, "post_id": 48305353, "comment_id": 83632956, "body": "@JoeC. If my response has helped you, please could you mark it as an answer? Thanks."}], "tags": [], "owner": {"reputation": 7497, "user_id": 8670372, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ir8a4Lbosmo/AAAAAAAAAAI/AAAAAAAAOtE/2eY5jK1atcc/photo.jpg?sz=128", "display_name": "Xabier", "link": "https://stackoverflow.com/users/8670372/xabier"}, "is_accepted": true, "score": 0, "last_activity_date": 1516205538, "last_edit_date": 1516205538, "creation_date": 1516205221, "answer_id": 48305353, "question_id": 48305144, "link": "https://stackoverflow.com/questions/48305144/vba-excel-userform-move-to-next-empty-row/48305353#48305353", "title": "vba excel userform move to next empty row", "body": "<p>Something like the following should do it:</p>\n\n<pre><code>Private Sub cmdSubmit_Click()\n    Dim ws As Worksheet\n    Dim addme As Long\n    Set ws = Sheet1\n    addme = ws.Cells(Rows.Count, 1).End(xlUp).Offset(1, 0).Row\n\n    With ws\n        ws.Cells(addme, 1).Value = Me.txtNeedsAnalysSum 'the number 1 here represents the Column A\n        ws.Cells(addme, 2).Value = Me.txtSummaryOfTask 'the number 2 represents Column B\n        ws.Cells(addme, 3).Value = Me.txtIntroduction\n        ws.Cells(addme, 4).Value = Me.chkInRes\n        ws.Cells(addme, 5).Value = Me.chkOnline\n        ws.Cells(addme, 6).Value = Me.chk24Hr\n        ws.Cells(addme, 7).Value = Me.chk3days\n        ws.Cells(addme, 8).Value = Me.chkDurOther\n        ws.Cells(addme, 9).Value = Me.cmbPrereqReq\n        ws.Cells(addme, 10).Value = Me.cmbPrereqRec\n    End With\n        Me.txtNeedsAnalysSum = vbNullString 're-set your textboxes\n        Me.txtSummaryOfTask = vbNullString\n        Me.txtIntroduction = vbNullString\n        Me.chkInRes = False\n        Me.chkOnline = False\n        Me.chk24Hr = False\n        Me.chk3days = False\n        Me.chkDurOther = False\n        Me.cmbPrereqReq = \"\"\n        Me.cmbPrereqRec = \"\"\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 9230358, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/41efdcda3973ad2b85d55db4abf3259f?s=128&d=identicon&r=PG&f=1", "display_name": "Joe C.", "link": "https://stackoverflow.com/users/9230358/joe-c"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1678, "favorite_count": 1, "accepted_answer_id": 48305353, "answer_count": 2, "score": 0, "last_activity_date": 1516205538, "creation_date": 1516204614, "last_edit_date": 1531164843, "question_id": 48305144, "link": "https://stackoverflow.com/questions/48305144/vba-excel-userform-move-to-next-empty-row", "title": "vba excel userform move to next empty row", "body": "<p>I recently created a VBA userform with various ActiveX controls, and I'm having trouble with the following:</p>\n\n<ol>\n<li>Saving data from the userform to a worksheet</li>\n<li>Entering data to the next available row in the worksheet (creating multiple records)</li>\n<li>Resetting the userform for new data entry</li>\n</ol>\n\n<p>I have a command button that uses (unsuccessfully) the following code: </p>\n\n<pre><code>Private Sub cmdSubmit_Click()\n    Dim ws As Worksheet\n    Dim addme As Range\n    Set ws = Sheet1\n    Set addme = ws.Cells(Rows.Count, 1).End(xlUp).Offset(1, 0)\n\n    With ws\n        addme.Offset.Value = Me.txtNeedsAnalysSum\n        addme.Offset.Value = Me.txtSummaryOfTask\n        addme.Offset.Value = Me.txtIntroduction\n        addme.Offset.Value = Me.chkInRes\n        addme.Offset.Value = Me.chkOnline\n        addme.Offset.Value = Me.chk24Hr\n        addme.Offset.Value = Me.chk3days\n        addme.Offset.Value = Me.chkDurOther\n        addme.Offset.Value = Me.cmbPrereqReq\n        addme.Offset.Value = Me.cmbPrereqRec\n    End With\nEnd Sub\n</code></pre>\n\n<p>Any assistance is appreciated!</p>\n\n<p>-Joe</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1516204288, "post_id": 48304788, "comment_id": 83595026, "body": "Try: <code>Range(&quot;A452:A457&quot;).Formula = &quot;=INDIRECT(&quot;&quot;&#39;[ASE Template White Book.xlsx]&quot;&quot; &amp; &#39;Tab Names from white book&#39;!A1 &amp; &quot;&quot;&#39;!E16&quot;&quot;)&quot;</code>"}, {"owner": {"reputation": 51, "user_id": 9209543, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/509e07313eb5e78d1069ad828c460a5b?s=128&d=identicon&r=PG&f=1", "display_name": "Richard Hannigan", "link": "https://stackoverflow.com/users/9209543/richard-hannigan"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1516205741, "post_id": 48304788, "comment_id": 83596012, "body": "thank you scott that is brilliant spent the last 3 hours trying to work out my self.  that works but previously when i used with out the indirect excel would take all the data from &#39;!E16 down in the reference white book and match to the range i specified at the beginning of the argument now it just takes the value of E16 and repeats. anyway to have the previous functionality or will have have to specify the reference rage to??"}], "owner": {"reputation": 51, "user_id": 9209543, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/509e07313eb5e78d1069ad828c460a5b?s=128&d=identicon&r=PG&f=1", "display_name": "Richard Hannigan", "link": "https://stackoverflow.com/users/9209543/richard-hannigan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 60, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1516203594, "creation_date": 1516203491, "last_edit_date": 1516203594, "question_id": 48304788, "link": "https://stackoverflow.com/questions/48304788/how-to-reference-a-cell-that-contains-the-worksheet-name-to-put-inside-a-formula", "title": "how to reference a cell that contains the worksheet name to put inside a formula that is inside a Macro", "body": "<p>I am hoping that someone can help me correct this bit of code not fancy but have been using </p>\n\n<pre><code> Range(\"D1220:D1243\").Formula = \"='[ASE Template White Book.xlsx]Cntrl 3'!$D38\"\n</code></pre>\n\n<p>to extract information from a closed workbook that is named ASE template White book which is really a saved as copy of a workbook that name will change all the time.  So i have set a refernce document.</p>\n\n<p>through the help here i have manage to extract the worksheet name from the document ref document and put in to the workbook i am working on.</p>\n\n<p>now i am having trouble trying to included the indirect function into the above formula.</p>\n\n<pre><code>   Range(\"A452:A457\").Formula = \"='[ASE Template White Book.xlsx][=INDIRECT('Tab Names from white book'!&amp;A1&amp;)\" '!E16\"\n</code></pre>\n\n<p>Range is of a worksheet in my current workbook \nworkbook that is refernce [ASE Template White Book]\nSheet name is located on TAb names from white book in side workbook i am working on in this case A1 \nE16 is the cell where to start in the reference document</p>\n\n<p>what i am attempting to do is use the cell text which is the sheet name from the ref doc and get it to dynamically change depending on the value in side the cell which is located in column A can someone help i have looked online and the answer on how to use indirect doesn't seem to work when using in the inside the formula i am guessing i am missing some syntax </p>\n\n<p>Also i don't no if possible to include a macro to check if the number in column B is = to a number then ie cell A1 has 2S0 P143 MAIN BUS SECTION cell B1 has  1</p>\n\n<p>as the range where the information will go will depend on the number which is actually an address of an IED which has different Addressing different points</p>\n\n<p>or if there is a way to if the value in column B is equal to then put the information in a1 and b1 in  the corresponding row ie. a6 currently has M751 Bitronics GT5  B6 has the address 33 </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1516202009, "post_id": 48303818, "comment_id": 83593375, "body": "When you are pasting the data, do you just want the data alone, or also the formatting?"}], "answers": [{"comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1516201822, "post_id": 48303977, "comment_id": 83593229, "body": "In the <code>If</code> statement, be sure to link <code>Range()</code> to the worksheet (I assume <code>sht1.Range(...)</code>)."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1516207909, "post_id": 48303977, "comment_id": 83597370, "body": "@BruceWayne - yes, hence my comment. I didn&#39;t add a sheet just in case is a different one. Will see what OP says, if anything."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1516208535, "post_id": 48303977, "comment_id": 83597781, "body": "D&#39;oh, sorry, I missed the comment."}], "tags": [], "owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "is_accepted": false, "score": 2, "last_activity_date": 1516201050, "creation_date": 1516201050, "answer_id": 48303977, "question_id": 48303818, "link": "https://stackoverflow.com/questions/48303818/move-selected-range-over-one-column-with-vba-in-excel-2016/48303977#48303977", "title": "Move selected range over one column with VBA in Excel 2016", "body": "<p>Nothing wrong with Cut and Paste, but you can avoid it, and avoiding Select will speed things up. Plus you should check first that you have found something to avoid an error.</p>\n\n<pre><code>Sub FindValueAndAboveThenMoveOver()\n\nDim sht1 As Worksheet, r As Range\n\nSet sht1 = Sheets(\"Convert\")\nSet r = sht1.Columns(\"A:A\").Find(\"XXXX\", LookIn:=xlValues)\n\nIf Not r Is Nothing Then\n    'should add sheet references here too\n    With Range(\"A1\").Resize(r.Row)\n        Range(\"B1\").Resize(r.Row).Value = .Value\n        .ClearContents\n    End With\nEnd If\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1516201836, "post_id": 48304105, "comment_id": 83593243, "body": "(Don&#39;t forget the <code>.</code> in <code>Set r = .Range(...</code>)"}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1516202122, "post_id": 48304105, "comment_id": 83593463, "body": "@BruceWayne  You don&#39;t need the <i>dot</i> outside if the items inside have <i>dots</i>"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1516202625, "post_id": 48304105, "comment_id": 83593840, "body": "Oh, really?? Cool, I didn&#39;t know that!  That makes sense though, thinking about it."}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 1, "last_activity_date": 1516201447, "creation_date": 1516201447, "answer_id": 48304105, "question_id": 48303818, "link": "https://stackoverflow.com/questions/48303818/move-selected-range-over-one-column-with-vba-in-excel-2016/48304105#48304105", "title": "Move selected range over one column with VBA in Excel 2016", "body": "<p>This might be slightly faster:</p>\n\n<pre><code>Sub FindValueAndAboveThenMoveOver()\n\n    Dim sht1 As Worksheet, r As Range\n    Set sht1 = Sheets(\"Convert\")\n\n    With sht1\n        Set r = Range(.Range(\"A1\"), .Columns(\"A:A\").Find(\"XXXX\", LookIn:=xlValues))\n    End With\n\n    r.Offset(0, 1).Value = r.Value\n    r.Clear\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 165, "user_id": 8370017, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/df8436a149272ffa90ed97977aa62101?s=128&d=identicon&r=PG&f=1", "display_name": "kroy2008", "link": "https://stackoverflow.com/users/8370017/kroy2008"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3204, "favorite_count": 1, "answer_count": 2, "score": 3, "last_activity_date": 1516201447, "creation_date": 1516200516, "last_edit_date": 1516201053, "question_id": 48303818, "link": "https://stackoverflow.com/questions/48303818/move-selected-range-over-one-column-with-vba-in-excel-2016", "title": "Move selected range over one column with VBA in Excel 2016", "body": "<p>I need to be able te</p>\n\n<ol>\n<li>Find a value in column A</li>\n<li>Select that value and everything above it</li>\n<li>Offset all those values over one column</li>\n</ol>\n\n<p>The below code does just that - however, I am trying to speed up the code execution, and copy and paste actions slow it down. Is there a way to accomplish this without the cut/paste? I'd like to stick with VBA (vice formula) since this is part of a larger procedure.</p>\n\n<p>Thanks!</p>\n\n<pre><code>Sub FindValueAndAboveThenMoveOver ()\n    Dim sht1 as Worksheet\n    Set sht1 = Sheets(\"Convert\")\n\n    sht1.Columns(\"A:A\").Find(\"XXXX\"), LookIn:=xlValues).Select\n    Range(ActiveCell.Offset(0, 0), \"A1\").Select\n    Selection.Cut\n    Range(\"B1\").Select\n    ActiveSheet.Paste\nEnd Sub\n</code></pre>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 9337, "user_id": 137508, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/2901ad5dee18873961c18562be3b3a72?s=128&d=identicon&r=PG", "display_name": "Beth", "link": "https://stackoverflow.com/users/137508/beth"}, "edited": false, "score": 0, "creation_date": 1516916959, "post_id": 48303493, "comment_id": 83898059, "body": "can you get it to work with a hyperlink to the pdf instead of an embedded object?"}, {"owner": {"reputation": 1066, "user_id": 6566741, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d4e290cef80d739bcf148e397d637af?s=128&d=identicon&r=PG", "display_name": "Rene", "link": "https://stackoverflow.com/users/6566741/rene"}, "edited": false, "score": 0, "creation_date": 1517015549, "post_id": 48303493, "comment_id": 83937275, "body": "If I create a new report, add an unbound object frame and select a pdf, it works just fine. Having set that, have a look at this discussion: <a href=\"https://www.pcreview.co.uk/threads/embedding-pdf-file-in-report.3261155/\" rel=\"nofollow noreferrer\">Embedding PDF file in Report</a>"}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1517015978, "post_id": 48303493, "comment_id": 83937353, "body": "How &quot;dynamic&quot; are these PDF images?  Is there a limited number of PDFs?  How many? You want to programmatically choose which one to display? -- or, are they being generated on the fly by another program?  No interaction is required with the PDF (like filling a PDF form), correct?  Are they single-page PDF&#39;s?  Are they all the same dimensions?  Do you have the full version of Adobe Acrobat (not reader)?  Do you have an issue with using 3rd-party or possibly &quot;unlicensed&quot; software to make this happen?  Does this need to work on only <i>one</i> installation of Access?"}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1517015985, "post_id": 48303493, "comment_id": 83937355, "body": "....I assume you&#39;ve posted the bounty since you&#39;re already aware (as a little research shows) that what you want to do is <b><i>not possible</i></b> through <i>&quot;traditional&quot;</i> means... (ie., <a href=\"https://answers.microsoft.com/en-us/office/forum/office_2010-access/use-pdf-as-access-report-background/9591c5d5-95e0-409f-b855-26e3dea089d1\" rel=\"nofollow noreferrer\">this</a>.) That being said, &quot;there&#39;s always a way&quot;.  I have a couple ideas depending on your answers to the above clarifications."}, {"owner": {"reputation": 170, "user_id": 7495443, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/45cc211ede863e4dd862d03c9512d737?s=128&d=identicon&r=PG&f=1", "display_name": "Jul Pod", "link": "https://stackoverflow.com/users/7495443/jul-pod"}, "reply_to_user": {"reputation": 9337, "user_id": 137508, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/2901ad5dee18873961c18562be3b3a72?s=128&d=identicon&r=PG", "display_name": "Beth", "link": "https://stackoverflow.com/users/137508/beth"}, "edited": false, "score": 0, "creation_date": 1517166409, "post_id": 48303493, "comment_id": 83973351, "body": "@Beth Hyperlink does also not change the pdf on the Form load/open Event - also no error."}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1517223944, "post_id": 48303493, "comment_id": 83992875, "body": "This is getting confusing. What has the report to do with a <code>Form_Load</code> event? Do you want to change the displayed PDF <i>in an already opened report?</i>"}, {"owner": {"reputation": 170, "user_id": 7495443, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/45cc211ede863e4dd862d03c9512d737?s=128&d=identicon&r=PG&f=1", "display_name": "Jul Pod", "link": "https://stackoverflow.com/users/7495443/jul-pod"}, "reply_to_user": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1517229046, "post_id": 48303493, "comment_id": 83995826, "body": "@Andre much sorry, i meant in the Report_load event of course"}], "answers": [{"comments": [{"owner": {"reputation": 170, "user_id": 7495443, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/45cc211ede863e4dd862d03c9512d737?s=128&d=identicon&r=PG&f=1", "display_name": "Jul Pod", "link": "https://stackoverflow.com/users/7495443/jul-pod"}, "edited": false, "score": 0, "creation_date": 1517166201, "post_id": 48489284, "comment_id": 83973289, "body": "Hello Sir, i already heard from the 2jpeg method, but this would also be the  most consuming Way for displaying a one Page pdf, i thought there can be a other way"}, {"owner": {"reputation": 170, "user_id": 7495443, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/45cc211ede863e4dd862d03c9512d737?s=128&d=identicon&r=PG&f=1", "display_name": "Jul Pod", "link": "https://stackoverflow.com/users/7495443/jul-pod"}, "edited": false, "score": 0, "creation_date": 1517166284, "post_id": 48489284, "comment_id": 83973312, "body": "The oleunbound does already display the pdf, but i cant load others on the form load/open/current event"}, {"owner": {"reputation": 170, "user_id": 7495443, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/45cc211ede863e4dd862d03c9512d737?s=128&d=identicon&r=PG&f=1", "display_name": "Jul Pod", "link": "https://stackoverflow.com/users/7495443/jul-pod"}, "edited": false, "score": 0, "creation_date": 1517216676, "post_id": 48489284, "comment_id": 83988237, "body": "how you mean set number of Images? this are all pdf&#39;s"}, {"owner": {"reputation": 170, "user_id": 7495443, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/45cc211ede863e4dd862d03c9512d737?s=128&d=identicon&r=PG&f=1", "display_name": "Jul Pod", "link": "https://stackoverflow.com/users/7495443/jul-pod"}, "edited": false, "score": 0, "creation_date": 1517216738, "post_id": 48489284, "comment_id": 83988269, "body": "what i don&#39;t get is that on the create of the oleunbound object i can choose the PDF and it also got correctly shown"}, {"owner": {"reputation": 170, "user_id": 7495443, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/45cc211ede863e4dd862d03c9512d737?s=128&d=identicon&r=PG&f=1", "display_name": "Jul Pod", "link": "https://stackoverflow.com/users/7495443/jul-pod"}, "edited": false, "score": 0, "creation_date": 1517216749, "post_id": 48489284, "comment_id": 83988275, "body": "but i cant change it with the vba code above, there are also no errors, the first PDF just stays in."}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "reply_to_user": {"reputation": 170, "user_id": 7495443, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/45cc211ede863e4dd862d03c9512d737?s=128&d=identicon&r=PG&f=1", "display_name": "Jul Pod", "link": "https://stackoverflow.com/users/7495443/jul-pod"}, "edited": false, "score": 0, "creation_date": 1517216892, "post_id": 48489284, "comment_id": 83988365, "body": "@JulPod -- You didn&#39;t mention in your question that you need to change anything."}, {"owner": {"reputation": 170, "user_id": 7495443, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/45cc211ede863e4dd862d03c9512d737?s=128&d=identicon&r=PG&f=1", "display_name": "Jul Pod", "link": "https://stackoverflow.com/users/7495443/jul-pod"}, "edited": false, "score": 0, "creation_date": 1517216936, "post_id": 48489284, "comment_id": 83988387, "body": "&quot;I want to display dynamically .pdf files ...&quot;"}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "reply_to_user": {"reputation": 170, "user_id": 7495443, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/45cc211ede863e4dd862d03c9512d737?s=128&d=identicon&r=PG&f=1", "display_name": "Jul Pod", "link": "https://stackoverflow.com/users/7495443/jul-pod"}, "edited": false, "score": 0, "creation_date": 1517216961, "post_id": 48489284, "comment_id": 83988404, "body": "&quot;Display&quot;, not &quot;Change&quot;"}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "reply_to_user": {"reputation": 170, "user_id": 7495443, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/45cc211ede863e4dd862d03c9512d737?s=128&d=identicon&r=PG&f=1", "display_name": "Jul Pod", "link": "https://stackoverflow.com/users/7495443/jul-pod"}, "edited": false, "score": 0, "creation_date": 1517217018, "post_id": 48489284, "comment_id": 83988433, "body": "Do you mean to switch to different pictures, or to change, as in edit the picture?"}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "reply_to_user": {"reputation": 170, "user_id": 7495443, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/45cc211ede863e4dd862d03c9512d737?s=128&d=identicon&r=PG&f=1", "display_name": "Jul Pod", "link": "https://stackoverflow.com/users/7495443/jul-pod"}, "edited": false, "score": 0, "creation_date": 1517217090, "post_id": 48489284, "comment_id": 83988475, "body": "You can switch to as many pictures as you want if you are producing them dynamically with the  suggestions above.  Editing the images is not possible, at least not without a major amount of coding."}, {"owner": {"reputation": 170, "user_id": 7495443, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/45cc211ede863e4dd862d03c9512d737?s=128&d=identicon&r=PG&f=1", "display_name": "Jul Pod", "link": "https://stackoverflow.com/users/7495443/jul-pod"}, "edited": false, "score": 0, "creation_date": 1517217216, "post_id": 48489284, "comment_id": 83988540, "body": "no i dont want to Change anything at the Images, i just want to load different pdf&#39;s on the form load or open Event with an oleounbound object"}, {"owner": {"reputation": 170, "user_id": 7495443, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/45cc211ede863e4dd862d03c9512d737?s=128&d=identicon&r=PG&f=1", "display_name": "Jul Pod", "link": "https://stackoverflow.com/users/7495443/jul-pod"}, "edited": false, "score": 0, "creation_date": 1517217225, "post_id": 48489284, "comment_id": 83988548, "body": "or other object as somebody knows"}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "reply_to_user": {"reputation": 170, "user_id": 7495443, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/45cc211ede863e4dd862d03c9512d737?s=128&d=identicon&r=PG&f=1", "display_name": "Jul Pod", "link": "https://stackoverflow.com/users/7495443/jul-pod"}, "edited": false, "score": 0, "creation_date": 1524440651, "post_id": 48489284, "comment_id": 86959362, "body": "@JulPod - if this help you solve your issue, don&#39;t forget to <b><code>\u2713 Accept</code></b> an answer that helped solve your problem\u2026 You&#39;ll get <b><code>+2</code></b> repuation, and the answer&#39;s author gets <b><code>+15</code></b> rep.  You can <i>also</i> <b><code>\u25b2 Upvote</code></b> any answers that are helpful, which also rewards the authors <b>and</b> <i>benefits the Stack Overflow community as a whole!</i>"}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "reply_to_user": {"reputation": 170, "user_id": 7495443, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/45cc211ede863e4dd862d03c9512d737?s=128&d=identicon&r=PG&f=1", "display_name": "Jul Pod", "link": "https://stackoverflow.com/users/7495443/jul-pod"}, "edited": false, "score": 0, "creation_date": 1528961890, "post_id": 48489284, "comment_id": 88706728, "body": "@JulPod - Don&#39;t forget to <b><code>\u2713 Accept</code></b> an answer that helped solve your problem\u2026 You&#39;ll get <b><code>+2</code></b> reputation, and the answer&#39;s author gets <b><code>+15</code></b> rep.  When you&#39;ve reached 15 reputation, you can <i>also</i> <b><code>\u25b2 Upvote</code></b> any answers that are helpful, which also rewards the authors <b>plus</b> your feedback in the form of votes <i>benefits the <a href=\"https://stackoverflow.com\">Stack Overflow</a> community as a whole!</i>"}], "tags": [], "owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "is_accepted": false, "score": 3, "last_activity_date": 1517160503, "creation_date": 1517160503, "answer_id": 48489284, "question_id": 48303493, "link": "https://stackoverflow.com/questions/48303493/display-pdf-in-report/48489284#48489284", "title": "Display PDF in Report", "body": "<p>You could get a licensed version of <a href=\"https://www.amazon.ca/s/keywords=adobe+acrobat\" rel=\"nofollow noreferrer\">Adobe Acrobat</a> (not Reader) and control it programmatically to capture the images you want.  </p>\n\n<p>Alternatively, you could use the VBA <a href=\"https://msdn.microsoft.com/en-us/vba/language-reference-vba/articles/shell-function\" rel=\"nofollow noreferrer\"><code>Shell Function</code></a> to call a command-line PDF converter like <a href=\"https://www.2jpeg.com/\" rel=\"nofollow noreferrer\">2Jpeg</a> to programmatically (and dynamically if necessary) convert the PDF to an image (see <a href=\"https://www.print-driver.com/stories/convert-pdf-to-jpg-via-the-command-line\" rel=\"nofollow noreferrer\">this</a>), or even \"print\" the PDF to an image file using the correct driver (see <a href=\"https://www.online-tech-tips.com/software-reviews/extract-images-from-pdf-files/\" rel=\"nofollow noreferrer\">this</a>).</p>\n\n<p>Once you have an image file, you can easily load the created image to your Access form with VBA, perhaps with <a href=\"http://www.lebans.com/loadsavejpeg.htm\" rel=\"nofollow noreferrer\">this</a>.</p>\n\n<p>Without further information (and answers to my previous questions) I can't offer more suggestions at this point but I hope that helps!</p>\n"}], "owner": {"reputation": 170, "user_id": 7495443, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/45cc211ede863e4dd862d03c9512d737?s=128&d=identicon&r=PG&f=1", "display_name": "Jul Pod", "link": "https://stackoverflow.com/users/7495443/jul-pod"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2198, "favorite_count": 1, "answer_count": 1, "score": 5, "last_activity_date": 1517232183, "creation_date": 1516199390, "last_edit_date": 1517232183, "question_id": 48303493, "link": "https://stackoverflow.com/questions/48303493/display-pdf-in-report", "title": "Display PDF in Report", "body": "<p>I want to display dynamically .pdf files like pictures in a report, it should look like this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/r5Xgi.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/r5Xgi.png\" alt=\"enter image description here\"></a></p>\n\n<p>i already tried with webbrowser, but then it doesn't show up in the preview or when i print the report out...</p>\n\n<p>I also tried a ole unbound object, also no success, here the code i had in the <code>Report_Load</code> event:</p>\n\n<pre><code>Dim vPath As String\n\nvPath = GetNewestDocument(Me!artNr)\n'Returns path for pdf file, about:blank if there is no file.\nIf vPath = \"about:blank\" Then\n        Me!PDFBrowser.visible = True\n        Me.PDFBrowser.SourceDoc = vbNullString\nElse\n        With Me.PDFBrowser\n        .OLETypeAllowed = acOLELinked\n        .SourceDoc = vPath\n        .SizeMode = acOLESizeStretch\n        End With\nEnd If\n</code></pre>\n\n<p><strong>EDIT:</strong></p>\n\n<p>With \"I want to display dynamically ...\" i meant to change dynamically pdf's in the Report.</p>\n\n<p><strong>EDIT 2:</strong></p>\n\n<p>I just found out that the type of the OLEunbound object is embedded, but i think this one should be linked as i read in other Forums: <a href=\"https://i.stack.imgur.com/qkklQ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/qkklQ.png\" alt=\"enter image description here\"></a></p>\n\n<p>When i try to Change it gives error: \"This property can not be changed because it is read-only\"</p>\n"}, {"tags": ["vba", "winapi", "printing", "sap"], "comments": [{"owner": {"reputation": 51, "user_id": 9229776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/66f1327c8451f51ae1f916ca03468c00?s=128&d=identicon&r=PG&f=1", "display_name": "Madalina", "link": "https://stackoverflow.com/users/9229776/madalina"}, "edited": false, "score": 0, "creation_date": 1516199628, "post_id": 48303411, "comment_id": 83591754, "body": "Please notice that my PRINT window looks like in this image:<a href=\"https://www.google.ro/search?q=printer+dialog&amp;rlz=1C1GGRV_enCH772CH772&amp;source=lnms&amp;tbm=isch&amp;sa=X&amp;ved=0ahUKEwjUgKCjm9_YAhWIjCwKHVzzCg4Q_AUICigB&amp;biw=1366&amp;bih=662&amp;safe=active&amp;ssui=on#imgrc=yOnigS8PeId84M\" rel=\"nofollow noreferrer\">google.ro/&hellip;</a>:"}, {"owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "edited": false, "score": 1, "creation_date": 1516200065, "post_id": 48303411, "comment_id": 83592046, "body": "Can you set the default printer before you pull up dialog box, then change it back? Might be a little easier."}, {"owner": {"reputation": 4047, "user_id": 3246362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6da9a197d0f0e5f19875d8a97550e58e?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/3246362/sam"}, "edited": false, "score": 1, "creation_date": 1516202145, "post_id": 48303411, "comment_id": 83593479, "body": "There is a lot of valuable information in this article: <a href=\"http://www.lessanvaezi.com/changing-printer-settings-using-the-windows-api/\" rel=\"nofollow noreferrer\">lessanvaezi.com/changing-printer-settings-using-the-windows-&zwnj;&#8203;api</a>"}, {"owner": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "edited": false, "score": 1, "creation_date": 1516271519, "post_id": 48303411, "comment_id": 83623586, "body": "UI Automation is best done using UI Automation. See <a href=\"https://stackoverflow.com/a/47502092/1889329\">this answer</a> for sample code. There are many benefits in using UI Automation. For one, the code won&#39;t break if run on a system, where the button isn&#39;t titled <i>&quot;OK&quot;</i> (e.g. on a Russian system). There&#39;s also no reason ever to call the ANSI versions of the Windows API. Just use the Unicode versions, and you won&#39;t have to convert between character sets up to 4 times per API call."}], "answers": [{"tags": [], "owner": {"reputation": 51, "user_id": 9229776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/66f1327c8451f51ae1f916ca03468c00?s=128&d=identicon&r=PG&f=1", "display_name": "Madalina", "link": "https://stackoverflow.com/users/9229776/madalina"}, "is_accepted": false, "score": 0, "last_activity_date": 1518014164, "last_edit_date": 1518014164, "creation_date": 1518005616, "answer_id": 48663528, "question_id": 48303411, "link": "https://stackoverflow.com/questions/48303411/how-to-change-printer-dialog-default-name-in-vba-when-using-the-handle-of-the/48663528#48663528", "title": "How to change printer dialog default name in VBA? (when using the handle of the printer dialog)", "body": "<p>PROBLEM SOLVED (for Windows 10):\nPlease notice that the code which was needed is:</p>\n\n<pre><code>'Declarations\n    Private Declare Function SendMessage Lib \"user32\" Alias \"SendMessageA\" _\n        (ByVal hwnd As Long, ByVal wMsg As Long, ByVal wParam As Long, lParam As Any) As Long\n    Public Declare Function GetWindow Lib \"user32\" _\n(ByVal hwnd As Long, ByVal wCmd As Long) As Long\n    Dim i                          'index to the selected item\n    Dim getPrintName As String     ' the text of the selected item\n    Dim getPrintNameLength As Long ' the length of the selected item's text\n    Dim printPDFFound As Boolean\n    Dim ChildhwndPrint11 As Long\n    Dim ChildhwndPrint1 As Long\n    Dim ChildhwndPrint As Long\n    Dim hwndPrint As Long\n    Const GW_CHILD = 5\n    Const GW_HWNDNEXT = 2\n    Const CB_GETLBTEXTLEN = &amp;H149\n    Const CB_GETLBTEXT = &amp;H148\n\n     getPrintName = Space(20)\n\n\n    'Code Between Previous Lines LINE1 and LINE4 Used To Change The Print Name \n\nhwndPrint = hwnd\n        ChildhwndPrint = GetWindow(hwndPrint, GW_CHILD)\n        If ChildhwndPrint = 0 Then\n            MsgBox \"ChildhwndPrint not found.\"\n            Exit Sub\n        End If\n        ChildhwndPrint1 = GetWindow(ChildhwndPrint, GW_HWNDNEXT)\n        If ChildhwndPrint1 = 0 Then\n            MsgBox \"ChildhwndPrint1 not found.\"\n            Exit Sub\n        End If\n        ChildhwndPrint11 = GetWindow(ChildhwndPrint1, GW_HWNDNEXT)\n        If ChildhwndPrint11 = 0 Then\n            MsgBox \"ChildhwndPrint11 not found.\"\n            Exit Sub\n        End If\n\nCall SendMessage(ChildhwndPrint11, CB_SHOWDROPDOWN, True, 0)\n\n    i = 0\n            printPDFFound = False\n            'getPrintName = \"\"\n            Do Until (i = 30) Or (getPrintName = \"Microsoft Print to PDF\")\n                    Call SendMessage(ChildhwndPrint11, CB_SETCURSEL, i, 0)\n                    'Call SendMessage(ChildhwndPrint11, CB_GETLBTEXT, 2, buffer)\n                    getPrintNameLength = SendMessage(ChildhwndPrint11, CB_GETLBTEXTLEN, ByVal CLng(i), ByVal CLng(0))\n                    getPrintName = Space(getPrintNameLength) &amp; vbNullChar\n                    getPrintNameLength = SendMessage(ChildhwndPrint11, CB_GETLBTEXT, ByVal CLng(i), ByVal getPrintName)\n                    getPrintName = Left(getPrintName, getPrintNameLength)\n                    'MsgBox getPrintName\n                    If getPrintName = \"Microsoft Print to PDF\" Then\n                        printPDFFound = True\n                    End If\n                    i = i + 1\n            Loop\n            If printPDFFound = False Then\n                MsgBox \"&lt;Microsoft Print to PDF&gt; print name was not found.\"\n                Exit Sub\n            End If\n</code></pre>\n\n<p>Explaining the CODE:\nI supposed that they can be maximum of 30 printers:</p>\n\n<ul>\n<li>I've searched for the handler of the print-name drop-down= ChildhwndPrint11 (I've used a Visual Studio Tool named Spy++, separately for my macro, and this tool shows all childs of open windows on desktop) [also, please find above standard declarations in Windows API Viewer for MS Excel x64, I,ve downloaded it from the Internet)</li>\n<li>I've showed the drop-down with CB_SHOWDROPDOWN</li>\n<li>so I looped until meeting the maximum printer (until 30 printer) or loop until print name is \"Microsoft Print to PDF\"</li>\n<li>I used scroll down drop down list that contains printer names</li>\n<li>for every CURSEL (element from drop-down list), I extracted printer name and printer length name</li>\n<li>if printer is found, I set printPDFFound to TRUE</li>\n</ul>\n"}], "owner": {"reputation": 51, "user_id": 9229776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/66f1327c8451f51ae1f916ca03468c00?s=128&d=identicon&r=PG&f=1", "display_name": "Madalina", "link": "https://stackoverflow.com/users/9229776/madalina"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 762, "favorite_count": 0, "answer_count": 1, "score": 5, "last_activity_date": 1518014164, "creation_date": 1516199162, "last_edit_date": 1516202459, "question_id": 48303411, "link": "https://stackoverflow.com/questions/48303411/how-to-change-printer-dialog-default-name-in-vba-when-using-the-handle-of-the", "title": "How to change printer dialog default name in VBA? (when using the handle of the printer dialog)", "body": "<p>I've obtained some data from SAP and then I've pressed Print button from SAP in order to print the data.\nThen PRINT window appeared:</p>\n\n<ol>\n<li><p>I've handled it into hWnd variable (please find in LINE 1 comment);</p></li>\n<li><p>Then I want to change default printer name into \"Microsoft Print to PDF\"(I don't know how to change it);</p></li>\n<li><p>Then I've pressed button OK (please find LINE 4 comment);</p></li>\n</ol>\n\n<p>Here's the code:</p>\n\n<pre><code>Private Declare Function FindWindow Lib \"user32\" Alias \"FindWindowA\" _\n    (ByVal lpClassName As String, ByVal lpWindowName As String) As Long\nPrivate Declare Function FindWindowEx Lib \"user32\" Alias \"FindWindowExA\" _\n    (ByVal hWnd1 As Long, ByVal hWnd2 As Long, ByVal lpsz1 As String, ByVal lpsz2 As String) As Long\nPrivate Declare Function SendMessage Lib \"user32\" Alias \"SendMessageA\" _\n    (ByVal hWnd As Long, ByVal wMsg As Long, ByVal wParam As Long, lParam As Any) As Long\nConst BM_CLICK = &amp;HF5\n'''\n hWnd = FindWindow(\"#32770\", \"Print\")  'LINE 1 comment;\n Childhwnd = FindWindowEx(hWnd, ByVal 0&amp;, \"Button\", \"OK\")';\n'ON THIS LINE NEED TO INSERT CODE THAT CHANGES PRINTER NAME;\n SendMessage Childhwnd, BM_CLICK, 0, ByVal 0&amp; 'LINE 4 comment;\n</code></pre>\n\n<p>Please help me to change printer name.</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 263, "user_id": 1614221, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/e2b092bdd4e98897bcda97197c4c3955?s=128&d=identicon&r=PG", "display_name": "Cap", "link": "https://stackoverflow.com/users/1614221/cap"}, "edited": false, "score": 0, "creation_date": 1516199244, "post_id": 48303355, "comment_id": 83591498, "body": "Thanks for the suggestion. But, this was clear. The problem is that the cell contains not only the link but some information + link. So, I don&#39;t want the whole cell to be a link, but just a part of it. And, the cell can contain 2-3 links as reference"}, {"owner": {"reputation": 263, "user_id": 1614221, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/e2b092bdd4e98897bcda97197c4c3955?s=128&d=identicon&r=PG", "display_name": "Cap", "link": "https://stackoverflow.com/users/1614221/cap"}, "edited": false, "score": 0, "creation_date": 1516199556, "post_id": 48303355, "comment_id": 83591698, "body": "See added example"}, {"owner": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "reply_to_user": {"reputation": 263, "user_id": 1614221, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/e2b092bdd4e98897bcda97197c4c3955?s=128&d=identicon&r=PG", "display_name": "Cap", "link": "https://stackoverflow.com/users/1614221/cap"}, "edited": false, "score": 0, "creation_date": 1516199577, "post_id": 48303355, "comment_id": 83591714, "body": "Your new question is different from the original - and incomplete. For example, if there are several links, where would you like to put them? There can only be one functioning hyperlink in any one cell."}], "tags": [], "owner": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "is_accepted": false, "score": 1, "last_activity_date": 1516198998, "creation_date": 1516198998, "answer_id": 48303355, "question_id": 48303115, "link": "https://stackoverflow.com/questions/48303115/detecting-url-link-in-the-text-cell/48303355#48303355", "title": "Detecting url (link) in the text cell", "body": "<p>In order to convert them in their own cell you would require VBA - simple, but this is simpler:-</p>\n\n<p>Insert a blank column next to the <code>Info</code> column. Enter this formula in row 2. Adjust the reference to column C in the formula to point at your <code>Info</code> column.</p>\n\n<pre><code>=HYPERLINK(MID($C2,2,LEN($C2)-2))\n</code></pre>\n\n<p>Copy the formula down as required. This should create hyperlinks in the new column. Select all of them, Copy and Paste > Values in place. Delete the original column. Done.</p>\n"}, {"tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 0, "last_activity_date": 1516199201, "creation_date": 1516199201, "answer_id": 48303431, "question_id": 48303115, "link": "https://stackoverflow.com/questions/48303115/detecting-url-link-in-the-text-cell/48303431#48303431", "title": "Detecting url (link) in the text cell", "body": "<p>To convert them \"in-place\", select the cells and run this short macro:</p>\n\n<pre><code>Sub hyperMaker()\n    Dim rng As Range\n    Set rng = Selection\n\n    For Each r In rng\n        v = r.Value\n        If Left(v, 1) = \"{\" And Right(v, 1) = \"}\" Then\n            If Mid(v, 2, 4) = \"http\" Then\n                vv = Mid(v, 2, Len(v) - 2)\n                ActiveSheet.Hyperlinks.Add Anchor:=r, Address:=vv, TextToDisplay:=v\n            End If\n        End If\n    Next r\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 263, "user_id": 1614221, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/e2b092bdd4e98897bcda97197c4c3955?s=128&d=identicon&r=PG", "display_name": "Cap", "link": "https://stackoverflow.com/users/1614221/cap"}, "edited": false, "score": 0, "creation_date": 1516206698, "post_id": 48304432, "comment_id": 83596606, "body": "I tried to see how your macro behaves, but I am getting &quot;Application defined or object defined error&quot; =("}, {"owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "edited": false, "score": 0, "creation_date": 1516207563, "post_id": 48304432, "comment_id": 83597140, "body": "you need to put the URL in quotes, so write <code>&quot;= HYPERLINK(&quot;&quot;&quot; &amp; Left(Txt, n - 1) &amp; &quot;&quot;&quot;)</code>"}, {"owner": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "reply_to_user": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "edited": false, "score": 0, "creation_date": 1516266028, "post_id": 48304432, "comment_id": 83620042, "body": "@Fun Thomas - Yes. Thank you for pointing this out. I have corrected the published code."}], "tags": [], "owner": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "is_accepted": true, "score": 1, "last_activity_date": 1516265982, "last_edit_date": 1516265982, "creation_date": 1516202433, "answer_id": 48304432, "question_id": 48303115, "link": "https://stackoverflow.com/questions/48303115/detecting-url-link-in-the-text-cell/48304432#48304432", "title": "Detecting url (link) in the text cell", "body": "<p>This should come nearer to what you wish to achieve. An unlimited number of links are converted to functioning hyperlinks, written to column <code>Info</code> and to the right of it (or to <code>C</code> number of columns to the right of <code>Info</code>. Please observe the comments in the code.</p>\n\n<pre><code>Sub ExtractLinks()\n    ' 18 Jan 2018\n\n    Const TargetClm As Long = 3                 ' 3 defines column C\n    ' hyperlinks are written to TargetClm\n    ' and to the columns to the right of TargetClm\n\n    Dim Txt As String\n    Dim R As Long, C As Long\n    Dim n As Integer\n\n    Application.ScreenUpdating = False\n    With ActiveSheet\n        ' Info is in column C, starting from row 2:\n        For R = 2 To .Cells(.Rows.Count, TargetClm).End(xlUp).Row\n            C = 0               ' set C = 1 to not over-write original cell value\n                                ' and start writing to the right of TargetClm\n            With .Cells(R, TargetClm)\n                Txt = .Value\n                Do\n                    n = InStr(Txt, \"(\")\n                    If n Then\n                        Txt = Mid(Txt, n + 1)\n                        n = InStr(Txt, \")\")\n                        If n Then\n                            .Offset(0, C).Formula = \"= HYPERLINK(\"\"\" &amp; Left(Txt, n - 1) &amp; \"\"\")\"\n                            C = C + 1\n                            Txt = Mid(Txt, n + 1)\n                        End If\n                    End If\n                Loop While n\n            End With\n        Next R\n    End With\n    Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 263, "user_id": 1614221, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/e2b092bdd4e98897bcda97197c4c3955?s=128&d=identicon&r=PG", "display_name": "Cap", "link": "https://stackoverflow.com/users/1614221/cap"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 210, "favorite_count": 0, "accepted_answer_id": 48304432, "answer_count": 3, "score": 0, "last_activity_date": 1516265982, "creation_date": 1516198231, "last_edit_date": 1516199534, "question_id": 48303115, "link": "https://stackoverflow.com/questions/48303115/detecting-url-link-in-the-text-cell", "title": "Detecting url (link) in the text cell", "body": "<p>I have a table in excel that consists of 3 columns:</p>\n\n<pre><code>--------------\n|ID|Name|Info|\n--------------\n</code></pre>\n\n<p>IN the info column there is some text that includes the citation and link to the source. But, somehow they are not recognized as hyperlink (i.e. - not clickable). The links always preserve the format: </p>\n\n<pre><code>(http://www. .....) or (https://www. ....) \n</code></pre>\n\n<p>They are always surrounded by braces and are on the new line.</p>\n\n<p>How can I automatically convert these links inside text cells into hyperlink? I tried using autocorrection, but doesn't work. Even when I select the text and make a rightclick - there is no hyperlink option. </p>\n\n<p>Any assistance is appreciated. Even if the solution is using macros. </p>\n\n<p><strong>UPDATE: Example of the text in cell</strong></p>\n\n<pre><code>The information in this cell is about Google (http://www.google.com) and taken from Wikipedia (http://en.wikipedia.org)\n</code></pre>\n"}, {"tags": ["vba", "excel", "dynamicquery", "excel-web-query"], "answers": [{"comments": [{"owner": {"reputation": 65, "user_id": 8626617, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/7ffab6aed6a0b0d884d7dbec1476e0cc?s=128&d=identicon&r=PG&f=1", "display_name": "Seva Arve", "link": "https://stackoverflow.com/users/8626617/seva-arve"}, "edited": false, "score": 0, "creation_date": 1516201451, "post_id": 48303330, "comment_id": 83592968, "body": "i wrote @up full macro, can u help me ?"}, {"owner": {"reputation": 3423, "user_id": 1738572, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/s0VGr.jpg?s=128&g=1", "display_name": "Greg Viers", "link": "https://stackoverflow.com/users/1738572/greg-viers"}, "reply_to_user": {"reputation": 65, "user_id": 8626617, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/7ffab6aed6a0b0d884d7dbec1476e0cc?s=128&d=identicon&r=PG&f=1", "display_name": "Seva Arve", "link": "https://stackoverflow.com/users/8626617/seva-arve"}, "edited": false, "score": 0, "creation_date": 1516202368, "post_id": 48303330, "comment_id": 83593652, "body": "I fixed the offset line. I mistyped it originally."}, {"owner": {"reputation": 65, "user_id": 8626617, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/7ffab6aed6a0b0d884d7dbec1476e0cc?s=128&d=identicon&r=PG&f=1", "display_name": "Seva Arve", "link": "https://stackoverflow.com/users/8626617/seva-arve"}, "edited": false, "score": 0, "creation_date": 1516202848, "post_id": 48303330, "comment_id": 83594014, "body": "its not work, because macro download x times only raport from cell &quot;e2&quot; and i need download 1 times every raport from cells e{x}"}, {"owner": {"reputation": 3423, "user_id": 1738572, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/s0VGr.jpg?s=128&g=1", "display_name": "Greg Viers", "link": "https://stackoverflow.com/users/1738572/greg-viers"}, "reply_to_user": {"reputation": 65, "user_id": 8626617, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/7ffab6aed6a0b0d884d7dbec1476e0cc?s=128&d=identicon&r=PG&f=1", "display_name": "Seva Arve", "link": "https://stackoverflow.com/users/8626617/seva-arve"}, "edited": false, "score": 0, "creation_date": 1516203659, "post_id": 48303330, "comment_id": 83594590, "body": "I&#39;ve added another line: url=c.value."}, {"owner": {"reputation": 65, "user_id": 8626617, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/7ffab6aed6a0b0d884d7dbec1476e0cc?s=128&d=identicon&r=PG&f=1", "display_name": "Seva Arve", "link": "https://stackoverflow.com/users/8626617/seva-arve"}, "edited": false, "score": 0, "creation_date": 1516205775, "post_id": 48303330, "comment_id": 83596035, "body": "url=c.value must be the same line like while or add tab before url = c.value?"}, {"owner": {"reputation": 3423, "user_id": 1738572, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/s0VGr.jpg?s=128&g=1", "display_name": "Greg Viers", "link": "https://stackoverflow.com/users/1738572/greg-viers"}, "reply_to_user": {"reputation": 65, "user_id": 8626617, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/7ffab6aed6a0b0d884d7dbec1476e0cc?s=128&d=identicon&r=PG&f=1", "display_name": "Seva Arve", "link": "https://stackoverflow.com/users/8626617/seva-arve"}, "edited": false, "score": 0, "creation_date": 1516205886, "post_id": 48303330, "comment_id": 83596106, "body": "It&#39;s within the while loop."}, {"owner": {"reputation": 65, "user_id": 8626617, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/7ffab6aed6a0b0d884d7dbec1476e0cc?s=128&d=identicon&r=PG&f=1", "display_name": "Seva Arve", "link": "https://stackoverflow.com/users/8626617/seva-arve"}, "edited": false, "score": 0, "creation_date": 1516208042, "post_id": 48303330, "comment_id": 83597472, "body": "still download raport from first link &#39;x&#39; times from cell &quot;e2&quot;, but not download report from link from cell &quot;e3,e4&quot; etc. maybe i dont need while loop, but formula: for each rows in column &quot;e&quot; make webquery ?"}, {"owner": {"reputation": 65, "user_id": 8626617, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/7ffab6aed6a0b0d884d7dbec1476e0cc?s=128&d=identicon&r=PG&f=1", "display_name": "Seva Arve", "link": "https://stackoverflow.com/users/8626617/seva-arve"}, "edited": false, "score": 0, "creation_date": 1516208786, "post_id": 48303330, "comment_id": 83597946, "body": "i have quesion - how add command - for new quering macro - clean all rows in Sheet1"}, {"owner": {"reputation": 3423, "user_id": 1738572, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/s0VGr.jpg?s=128&g=1", "display_name": "Greg Viers", "link": "https://stackoverflow.com/users/1738572/greg-viers"}, "reply_to_user": {"reputation": 65, "user_id": 8626617, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/7ffab6aed6a0b0d884d7dbec1476e0cc?s=128&d=identicon&r=PG&f=1", "display_name": "Seva Arve", "link": "https://stackoverflow.com/users/8626617/seva-arve"}, "edited": false, "score": 0, "creation_date": 1516215936, "post_id": 48303330, "comment_id": 83601881, "body": "If the solution works, perhaps mark my solution as correct and then post a new question for your next issue"}, {"owner": {"reputation": 65, "user_id": 8626617, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/7ffab6aed6a0b0d884d7dbec1476e0cc?s=128&d=identicon&r=PG&f=1", "display_name": "Seva Arve", "link": "https://stackoverflow.com/users/8626617/seva-arve"}, "edited": false, "score": 0, "creation_date": 1516216881, "post_id": 48303330, "comment_id": 83602347, "body": "i posted new issue :)"}], "tags": [], "owner": {"reputation": 3423, "user_id": 1738572, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/s0VGr.jpg?s=128&g=1", "display_name": "Greg Viers", "link": "https://stackoverflow.com/users/1738572/greg-viers"}, "is_accepted": true, "score": 0, "last_activity_date": 1516205871, "last_edit_date": 1516205871, "creation_date": 1516198933, "answer_id": 48303330, "question_id": 48302995, "link": "https://stackoverflow.com/questions/48302995/dynamics-webquery-from-url-in-cells/48303330#48303330", "title": "Dynamics webquery from url in cells", "body": "<p>To loop through the cells use:</p>\n\n<pre><code>dim c as range, DataSpot as range\nset c = Sheets(\"CustomReport\").Range(\"E2\")\nwhile c.value &lt;&gt;\"\"\n    url = c.value\n    set DataSpot=cells(sheets(\"orders\").Range(\"A1\").SpecialCells(xlLastCell).row+1,1)\n    ' Web Query Code goes here\n    set c=c.offset(1,0)\nwend\n</code></pre>\n\n<p>In your data query, use:</p>\n\n<pre><code>Destination:=Range(DataSpot.Address))\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 65, "user_id": 8626617, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/7ffab6aed6a0b0d884d7dbec1476e0cc?s=128&d=identicon&r=PG&f=1", "display_name": "Seva Arve", "link": "https://stackoverflow.com/users/8626617/seva-arve"}, "is_accepted": false, "score": 0, "last_activity_date": 1516201422, "creation_date": 1516201422, "answer_id": 48304095, "question_id": 48302995, "link": "https://stackoverflow.com/questions/48302995/dynamics-webquery-from-url-in-cells/48304095#48304095", "title": "Dynamics webquery from url in cells", "body": "<p>Sub Test()</p>\n\n<pre><code>Dim URL As String\n\nURL = Sheets(\"CustomReport\").Range(\"E2\").Value\n\nSheets(\"Sheet1\").Select\nDim c As Range, DataSpot As Range\nSet c = Sheets(\"CustomReport\").Range(\"E2\")\nWhile c.Value &lt;&gt; \"\"\n    Set DataSpot = Cells(Sheets(\"Sorders\").Range(\"A1\").SpecialCells(xlLastCell).Row + 1, 1)\n        With ActiveSheet.QueryTables.Add(Connection:=\"URL;\" &amp; URL, Destination:=Range(DataSpot.Address))\n         .Name = \"team2289_2\"\n            .FieldNames = True\n            .RowNumbers = False\n            .FillAdjacentFormulas = False\n            .PreserveFormatting = False\n            .RefreshOnFileOpen = False\n            .BackgroundQuery = True\n            .RefreshStyle = xlOverwriteCells\n            .SavePassword = False\n            .SaveData = True\n            .AdjustColumnWidth = True\n            .RefreshPeriod = 0\n            .WebSelectionType = xlEntirePage\n            .WebFormatting = xlWebFormattingAll\n            .WebPreFormattedTextToColumns = True\n            .WebConsecutiveDelimitersAsOne = True\n            .WebSingleBlockTextImport = False\n            .WebDisableDateRecognition = True\n            .WebDisableRedirections = False\n             .Refresh BackgroundQuery:=False\n        End With\n        Set r = r.Offset(1, 0)\nWend\n</code></pre>\n\n<p>End Sub</p>\n\n<p>i put your code and i have debug with:\nSet r = r.Offset(1, 0)</p>\n\n<p>What wrong i do ?</p>\n"}], "owner": {"reputation": 65, "user_id": 8626617, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/7ffab6aed6a0b0d884d7dbec1476e0cc?s=128&d=identicon&r=PG&f=1", "display_name": "Seva Arve", "link": "https://stackoverflow.com/users/8626617/seva-arve"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 652, "favorite_count": 0, "accepted_answer_id": 48303330, "answer_count": 2, "score": 0, "last_activity_date": 1516205871, "creation_date": 1516197852, "last_edit_date": 1516198179, "question_id": 48302995, "link": "https://stackoverflow.com/questions/48302995/dynamics-webquery-from-url-in-cells", "title": "Dynamics webquery from url in cells", "body": "<p>I searched the internet, but I could not find anywhere a dynamic query from links in cells.\nIn excel i have webquery which generate this data:</p>\n\n<p>I have data in excel Sheet(\"CustomReport\"):</p>\n\n<pre><code>SalesOrder  Value1      Value2      Value3     Links\n1           Jonas       Station1    8          https://x.com=1\n2           Greg        Station1    5          https://x.com=2\n3           Anton       Station1    1          https://x.com=3\n...         ...         ...         ...        ...\n</code></pre>\n\n<p>Number of rows in this query is always different when it is refreshed.</p>\n\n<p>And based on this webquery i need generate dynamic webquery in macro.\nFor example:\nDynamicQuery1 save data from report <a href=\"https://x.com=1\" rel=\"nofollow noreferrer\">https://x.com=1</a> to Sheet name \"Orders\" started from A1 and ending A{X} value (reports have diffrents number of rows).</p>\n\n<p>DynamicQuery2 save data from report <a href=\"https://x.com=2\" rel=\"nofollow noreferrer\">https://x.com=2</a> to the same Sheet \"Orders\" but started from A{X+1}.</p>\n\n<p>I have such a macro, but it only works for the first row.</p>\n\n<p><i></p>\n\n<p>Sub Test()</p>\n\n<pre><code>Dim URL As String\n\nURL = Sheets(\"CustomReport\").Range(\"E2\").Value\n\nSheets(\"Orders\").Select\nWith ActiveSheet.QueryTables.Add(Connection:=\"URL;\" &amp; URL, Destination:=Range(\"$A$1\"))\n    .Name = \"team2289_2\"\n    .FieldNames = True\n    .RowNumbers = False\n    .FillAdjacentFormulas = False\n    .PreserveFormatting = False\n    .RefreshOnFileOpen = False\n    .BackgroundQuery = True\n    .RefreshStyle = xlOverwriteCells\n    .SavePassword = False\n    .SaveData = True\n    .AdjustColumnWidth = True\n    .RefreshPeriod = 0\n    .WebSelectionType = xlEntirePage\n    .WebFormatting = xlWebFormattingAll\n    .WebPreFormattedTextToColumns = True\n    .WebConsecutiveDelimitersAsOne = True\n    .WebSingleBlockTextImport = False\n    .WebDisableDateRecognition = True\n    .WebDisableRedirections = False\n    .Refresh BackgroundQuery:=False\nEnd With\n</code></pre>\n\n<p></i></p>\n\n<p>And i need refreshing this macro every 1 hour.\nAnyone can give me macro based on this way?</p>\n"}, {"tags": ["sql-server", "vba", "excel", "stored-procedures"], "comments": [{"owner": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "edited": false, "score": 0, "creation_date": 1516197870, "post_id": 48302975, "comment_id": 83590546, "body": "CopyFromRecordset is the pasting to worksheet tip.   <a href=\"https://www.excelforum.com/excel-programming-vba-macros/563913-sql-copyfromrecordset.html\" rel=\"nofollow noreferrer\">excelforum.com/excel-programming-vba-macros/&hellip;</a>"}, {"owner": {"reputation": 429, "user_id": 8467253, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/87211b5aea4e2f0f3b36669206c1f686?s=128&d=identicon&r=PG&f=1", "display_name": "Sorath", "link": "https://stackoverflow.com/users/8467253/sorath"}, "reply_to_user": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "edited": false, "score": 0, "creation_date": 1516197977, "post_id": 48302975, "comment_id": 83590619, "body": "@SMeaden Ok, but how do I run the stored procedure to get the data?"}, {"owner": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "edited": false, "score": 0, "creation_date": 1516197998, "post_id": 48302975, "comment_id": 83590638, "body": "that link also gives stored procedure example."}], "answers": [{"tags": [], "owner": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "is_accepted": false, "score": 0, "last_activity_date": 1516198062, "creation_date": 1516198062, "answer_id": 48303054, "question_id": 48302975, "link": "https://stackoverflow.com/questions/48302975/how-do-run-a-stored-procedure-from-sql-in-vba-and-then-paste-the-data-into-excel/48303054#48303054", "title": "How do run a stored procedure from SQL in VBA and then paste the data into Excel?", "body": "<p>From the <a href=\"https://www.excelforum.com/excel-programming-vba-macros/563913-sql-copyfromrecordset.html\" rel=\"nofollow noreferrer\">link</a></p>\n\n<pre><code>myConnection.Open\nSet myCommand.ActiveConnection = myConnection\nSet myRecordSet.ActiveConnection = myConnection\nmyCommand.CommandText = strSQL\nmyCommand.CommandType = adCmdText\nmyCommand.Execute\nmyRecordSet.Open myCommand\n\n'Paste to spreadsheet\nThisWorkbook.Worksheets(\"Report\").Range(\"a2\").CopyFromRecordset\nmyRecordSet\n</code></pre>\n"}], "owner": {"reputation": 429, "user_id": 8467253, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/87211b5aea4e2f0f3b36669206c1f686?s=128&d=identicon&r=PG&f=1", "display_name": "Sorath", "link": "https://stackoverflow.com/users/8467253/sorath"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 415, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1516198062, "creation_date": 1516197757, "last_edit_date": 1531164843, "question_id": 48302975, "link": "https://stackoverflow.com/questions/48302975/how-do-run-a-stored-procedure-from-sql-in-vba-and-then-paste-the-data-into-excel", "title": "How do run a stored procedure from SQL in VBA and then paste the data into Excel?", "body": "<p>So I am quite new to VBA but I need to write a VBA macro which runs the stored procedure in Microsoft SQL server and then paste this data into the excel worksheet. </p>\n\n<p>So far this is the code that I have, but I am not sure how to proceed? Is there sample code or a template for this particular procedure?</p>\n\n<pre><code>Sub Connection()   ' create the connection\n\nloginstatus = True\nlogin.Show\nPassword = login.password_input\nuser = login.UserName\n\n\nDim con As ADODB.Connection\nDim stored_procedure As String\nDim ADODBCmd As ADODB.Command\nDim rs As ADODB.Recordset\n\n\n\nSet con = New ADODB.Connection\n\n'provide and create connection string\n Dim connectionString As String\n\nDim location As String  'the server\n\nlocation = \"MyLocation\"\n\nconnectionString = \"Provider=SQLOLEDB; Network Library=DBMSSOCN;Data Source=\" &amp; location &amp; \";Command Timeout=0;Connection Timeout=0;Packet Size=4096; Initial Catalog=ukmc; User ID=\" &amp; user &amp; \"; Password=\" &amp; Password &amp; \";\"\n\n'handle when it is not possible to log in\nOn Error GoTo ConnectionError\n\ncon.Open connectionString\nloginstatus = False\nExit Sub\n\n\n'errorhandl0\nConnectionError:\n MsgBox \"Not possible to log in. Have you entered the correct password?\"\n\n'recordset - the data extracted\nSet ADODBCmd = New ADODB.Command\n\nEnd Sub\n</code></pre>\n\n<p>So i think I have created the connection, but how do I tell it which stored procedure to run and then how do i paste the data into a worksheet in my excel document?</p>\n"}, {"tags": ["vba", "combobox", "powerpoint"], "comments": [{"owner": {"reputation": 18498, "user_id": 620444, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/592e6e89add7a3937a41c963941e10e1?s=128&d=identicon&r=PG", "display_name": "Andy G", "link": "https://stackoverflow.com/users/620444/andy-g"}, "edited": false, "score": 0, "creation_date": 1516197348, "post_id": 48302803, "comment_id": 83590203, "body": "What line causes the error?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6089076"}, "reply_to_user": {"reputation": 18498, "user_id": 620444, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/592e6e89add7a3937a41c963941e10e1?s=128&d=identicon&r=PG", "display_name": "Andy G", "link": "https://stackoverflow.com/users/620444/andy-g"}, "edited": false, "score": 0, "creation_date": 1516197379, "post_id": 48302803, "comment_id": 83590228, "body": "sorry guys, the line ComboBox1.AddItem DateAdd(&quot;d&quot;, nIndex, CVDate(&quot;10/02/2007&quot;))"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6089076"}, "reply_to_user": {"reputation": 18498, "user_id": 620444, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/592e6e89add7a3937a41c963941e10e1?s=128&d=identicon&r=PG", "display_name": "Andy G", "link": "https://stackoverflow.com/users/620444/andy-g"}, "edited": false, "score": 0, "creation_date": 1516197970, "post_id": 48302803, "comment_id": 83590607, "body": "The sub  AddDropDownItemsFromDate is in a separate module. Perhaps this is the issue"}, {"owner": {"reputation": 1941, "user_id": 1267370, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/32MVo.jpg?s=128&g=1", "display_name": "mooseman", "link": "https://stackoverflow.com/users/1267370/mooseman"}, "edited": false, "score": 1, "creation_date": 1516198113, "post_id": 48302803, "comment_id": 83590730, "body": "You will need to call the sub with the module prefix, like Module1.AddDropDownItemsFromDate"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6089076"}, "edited": false, "score": 0, "creation_date": 1516198157, "post_id": 48302803, "comment_id": 83590762, "body": "yep...we needed the SlideX (x being whatever number) number in front of CombobBox"}], "owner": {"user_type": "does_not_exist", "display_name": "user6089076"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 112, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1516197485, "creation_date": 1516197229, "last_edit_date": 1516197485, "question_id": 48302803, "link": "https://stackoverflow.com/questions/48302803/drop-down-box-object-required", "title": "Drop down box, Object required", "body": "<p>I have constructed following code. Here we click on a combobox in a power point display and the date is the selected from a list. For some reason I am getting a </p>\n\n<blockquote>\n  <p>Object required run time 424 error</p>\n</blockquote>\n\n<p>Do I need to set the object?  </p>\n\n<pre><code>Private Sub ComboBox1_GotFocus()\nIf ComboBox1.ListCount = 0 Then\n   Call AddDropDownItemsFromDate(1)\nEnd If\nEnd Sub\n\n Sub AddDropDownItemsFromDate(i As Integer)\n Dim nIndex As Integer\n Dim Selector As Integer\n Selector = i\n\n Select Case Selector\n  Case Is = 1\n  For nIndex = 0 To 3600\n   ComboBox1.AddItem DateAdd(\"d\", nIndex, CVDate(\"10/02/2007\"))\n  Next nIndex\n  Case Is = 2 \n   ....other combobox's\nEnd Select\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "edited": false, "score": 0, "creation_date": 1516196932, "post_id": 48302565, "comment_id": 83589943, "body": "I&#39;d suggest stepping through your code (or using <code>debug.print</code>) to check that your <code>If</code> statement is flowing the way you&#39;d expect."}], "answers": [{"comments": [{"owner": {"reputation": 177, "user_id": 7502029, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f02e63402f13f6ae2c68c4d72a292e06?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin P.", "link": "https://stackoverflow.com/users/7502029/kevin-p"}, "edited": false, "score": 0, "creation_date": 1516198964, "post_id": 48302820, "comment_id": 83591285, "body": "When unchecking, it removes the labels fine. When checking I get a &quot;<b>Object doesn&#39;t support this property or method</b>&quot;. and it points to <code>Sheet5.Shapes(&quot;Chart 12&quot;).ShowCategoryName = True</code>"}, {"owner": {"reputation": 7497, "user_id": 8670372, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ir8a4Lbosmo/AAAAAAAAAAI/AAAAAAAAOtE/2eY5jK1atcc/photo.jpg?sz=128", "display_name": "Xabier", "link": "https://stackoverflow.com/users/8670372/xabier"}, "reply_to_user": {"reputation": 177, "user_id": 7502029, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f02e63402f13f6ae2c68c4d72a292e06?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin P.", "link": "https://stackoverflow.com/users/7502029/kevin-p"}, "edited": false, "score": 0, "creation_date": 1516200501, "post_id": 48302820, "comment_id": 83592336, "body": "@Kevin I forgot to add a couple of things, it should work as expected now, please see my updated answer. Also if this helps please could you mark my response as an answer? Thanks."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1516200908, "post_id": 48302820, "comment_id": 83592612, "body": "@Xabier <code>Sheet1.Range(&quot;W11&quot;) = &quot;True&quot;</code> will be <code>false</code> if the cell W11 contains <code>True</code> because it will return a boolean not a string. So this will not work as expected: See my answer."}, {"owner": {"reputation": 7497, "user_id": 8670372, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ir8a4Lbosmo/AAAAAAAAAAI/AAAAAAAAOtE/2eY5jK1atcc/photo.jpg?sz=128", "display_name": "Xabier", "link": "https://stackoverflow.com/users/8670372/xabier"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1516200986, "post_id": 48302820, "comment_id": 83592663, "body": "@Peh, point taken and updated, thanks for your observation... :)"}, {"owner": {"reputation": 177, "user_id": 7502029, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f02e63402f13f6ae2c68c4d72a292e06?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin P.", "link": "https://stackoverflow.com/users/7502029/kevin-p"}, "edited": false, "score": 0, "creation_date": 1516202054, "post_id": 48302820, "comment_id": 83593414, "body": "@Xabier I am still getting the same error in the same spot :("}, {"owner": {"reputation": 177, "user_id": 7502029, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f02e63402f13f6ae2c68c4d72a292e06?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin P.", "link": "https://stackoverflow.com/users/7502029/kevin-p"}, "edited": false, "score": 0, "creation_date": 1516203260, "post_id": 48302820, "comment_id": 83594312, "body": "@Xabier the issue was with the chart referencing even with the revised code. Once I changed some spots to Selection it worked. Please take a look at my answer if you want to see."}], "tags": [], "owner": {"reputation": 7497, "user_id": 8670372, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ir8a4Lbosmo/AAAAAAAAAAI/AAAAAAAAOtE/2eY5jK1atcc/photo.jpg?sz=128", "display_name": "Xabier", "link": "https://stackoverflow.com/users/8670372/xabier"}, "is_accepted": false, "score": 1, "last_activity_date": 1516200966, "last_edit_date": 1516200966, "creation_date": 1516197276, "answer_id": 48302820, "question_id": 48302565, "link": "https://stackoverflow.com/questions/48302565/add-data-labels-with-vba/48302820#48302820", "title": "Add Data Labels with VBA", "body": "<p>Try the following, I believe you were referencing the chart incorrectly, by using the Shapes object, you can get to your desired chart:</p>\n\n<pre><code>Sub Checkbox()\n    If Sheet1.Range(\"W11\") = True Then\n        Sheet1.Shapes(\"Chart 1\").Chart.SetElement (msoElementDataLabelShow)\n        Sheet1.Shapes(\"Chart 1\").Chart.ApplyDataLabels\n        Sheet1.Shapes(\"Chart 1\").Chart.FullSeriesCollection(1).DataLabels.Select\n        Sheet1.Shapes(\"Chart 1\").Chart.FullSeriesCollection(1).DataLabels.ShowCategoryName = True\n        Sheet1.Shapes(\"Chart 1\").Chart.FullSeriesCollection(1).DataLabels.Separator = \"\" &amp; Chr(13) &amp; \"\"\n        With Sheet1.Shapes(\"Chart 1\").Chart.FullSeriesCollection(1).Format.Fill\n            .Visible = msoTrue\n            .ForeColor.RGB = RGB(127, 127, 127)\n            .Solid\n        End With\n        With Sheet1.Shapes(\"Chart 1\").Chart.FullSeriesCollection(1).Format.Fill\n            .Visible = msoTrue\n            .ForeColor.ObjectThemeColor = msoThemeColorAccent1\n            .ForeColor.TintAndShade = 0\n            .ForeColor.Brightness = 0\n            .Transparency = 0\n            .Solid\n        End With\n        With Sheet1.Shapes(\"Chart 1\").Chart.FullSeriesCollection(2).Format.Fill\n            .Visible = msoTrue\n            .ForeColor.RGB = RGB(68, 114, 196)\n            .Transparency = 0.75\n            .Solid\n        End With\n        Application.CommandBars(\"Format Object\").Visible = False\n    Else\n        Sheet1.Shapes(\"Chart 1\").Chart.SetElement (msoElementDataLabelNone)\n    End If\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 177, "user_id": 7502029, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f02e63402f13f6ae2c68c4d72a292e06?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin P.", "link": "https://stackoverflow.com/users/7502029/kevin-p"}, "edited": false, "score": 0, "creation_date": 1516199166, "post_id": 48302907, "comment_id": 83591438, "body": "That makes sense, I can just replace that line with <code>If CheckBox1.Value = True Then</code> if I want to use a checkbox reference rather than a linked cell?"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 177, "user_id": 7502029, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f02e63402f13f6ae2c68c4d72a292e06?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin P.", "link": "https://stackoverflow.com/users/7502029/kevin-p"}, "edited": false, "score": 0, "creation_date": 1516199958, "post_id": 48302907, "comment_id": 83591985, "body": "@KevinP. If it is a ActiveX checkbox then yes, if it is a form element checkbox then no. And you might need to specify the sheet If <code>Sheet1.CheckBox1.Value = True Then</code> if the code is in a module. If you used a form element checkbox instead of an ActiveX then you would need to use something like <code>If Sheet1.Shapes(&quot;CheckBox 1&quot;).OLEFormat.Object.Value = xlOn Then</code>. I recommend to stay away from ActiveX if possible. Note that there might be a space in <code>CheckBox 1</code>."}, {"owner": {"reputation": 177, "user_id": 7502029, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f02e63402f13f6ae2c68c4d72a292e06?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin P.", "link": "https://stackoverflow.com/users/7502029/kevin-p"}, "edited": false, "score": 0, "creation_date": 1516202119, "post_id": 48302907, "comment_id": 83593460, "body": "Aside from the checkbox issue with either my original code and Xabiers I am still getting a functional error."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 177, "user_id": 7502029, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f02e63402f13f6ae2c68c4d72a292e06?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin P.", "link": "https://stackoverflow.com/users/7502029/kevin-p"}, "edited": false, "score": 0, "creation_date": 1516202395, "post_id": 48302907, "comment_id": 83593671, "body": "@KevinP. If you don&#39;t tell us which error you get and in which line of your original code we cannot help."}, {"owner": {"reputation": 177, "user_id": 7502029, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f02e63402f13f6ae2c68c4d72a292e06?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin P.", "link": "https://stackoverflow.com/users/7502029/kevin-p"}, "edited": false, "score": 0, "creation_date": 1516202659, "post_id": 48302907, "comment_id": 83593865, "body": "Sorry, I had posted the comment in the other answer. When unchecking, it removes the labels fine. When checking I get a &quot;<b>Object doesn&#39;t support this property or method</b>&quot;. and it points to <code>Sheet5.Shapes(&quot;Chart 12&quot;).ShowCategoryName = True</code>"}, {"owner": {"reputation": 177, "user_id": 7502029, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f02e63402f13f6ae2c68c4d72a292e06?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin P.", "link": "https://stackoverflow.com/users/7502029/kevin-p"}, "edited": false, "score": 0, "creation_date": 1516203342, "post_id": 48302907, "comment_id": 83594375, "body": "I have found the issue. Thank you for clarifying the debug."}], "tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": true, "score": 1, "last_activity_date": 1516198703, "last_edit_date": 1516198703, "creation_date": 1516197543, "answer_id": 48302907, "question_id": 48302565, "link": "https://stackoverflow.com/questions/48302565/add-data-labels-with-vba/48302907#48302907", "title": "Add Data Labels with VBA", "body": "<p>The issue is that </p>\n\n<pre><code>If Sheet1.Range(\"W11\") = \"TRUE\"\n</code></pre>\n\n<p>is not <code>true</code>.</p>\n\n<p>If you <code>Debug.Print Sheet1.Range(\"W11\") = \"TRUE\"</code> it will return <code>false</code> instead of the expected <code>true</code>. The cause is that <code>Sheet1.Range(\"W11\")</code> returns a <code>boolean</code> not a <code>string</code> in this case.</p>\n\n<p>You can verify the return type with</p>\n\n<pre><code>Debug.Print VarType(Sheet1.Range(\"W11\"))\n</code></pre>\n\n<p>which returns <code>11</code> and that means <code>boolean</code> (see <a href=\"https://msdn.microsoft.com/en-us/vba/language-reference-vba/articles/vartype-function?f=255&amp;MSPPError=-2147217396\" rel=\"nofollow noreferrer\">VarType Function</a>).</p>\n\n<hr>\n\n<p>So you should change it to</p>\n\n<pre><code>If Sheet1.Range(\"W11\") = True\n</code></pre>\n\n<p>which is <code>true</code> if the cell W11 contains <code>TRUE</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 177, "user_id": 7502029, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f02e63402f13f6ae2c68c4d72a292e06?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin P.", "link": "https://stackoverflow.com/users/7502029/kevin-p"}, "is_accepted": false, "score": 0, "last_activity_date": 1516203177, "creation_date": 1516203177, "answer_id": 48304683, "question_id": 48302565, "link": "https://stackoverflow.com/questions/48302565/add-data-labels-with-vba/48304683#48304683", "title": "Add Data Labels with VBA", "body": "<p>Thanks to help I was able to figure out the issue. Below is the final code:</p>\n\n<pre><code>Sub Checkbox()\n    If Sheet1.Range(\"W11\") = True Then\n    Sheet5.Shapes(\"Chart 12\").Chart.SetElement (msoElementDataLabelTop)\n    Sheet5.Shapes(\"Chart 12\").Chart.ApplyDataLabels\n    Sheet5.Shapes(\"Chart 12\").Chart.FullSeriesCollection(1).DataLabels.Select\n    Selection.ShowCategoryName = True\n    Selection.Separator = \"\" &amp; Chr(13) &amp; \"\"\n    With Selection.Format.Fill\n        .Visible = msoTrue\n        .ForeColor.RGB = RGB(127, 127, 127)\n        .Solid\n    End With\n    With Selection.Format.Fill\n        .Visible = msoTrue\n        .ForeColor.ObjectThemeColor = msoThemeColorAccent1\n        .ForeColor.TintAndShade = 0\n        .ForeColor.Brightness = 0\n        .Transparency = 0\n        .Solid\n    End With\n    With Selection.Format.Fill\n        .Visible = msoTrue\n        .ForeColor.RGB = RGB(68, 114, 196)\n        .Transparency = 0.75\n        .Solid\n    End With\n    Application.CommandBars(\"Format Object\").Visible = False\n        Else\n        Sheet5.Shapes(\"Chart 12\").Chart.FullSeriesCollection(1).DataLabels.Select\n        Sheet5.Shapes(\"Chart 12\").Chart.SetElement (msoElementDataLabelNone)\n    End If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 177, "user_id": 7502029, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f02e63402f13f6ae2c68c4d72a292e06?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin P.", "link": "https://stackoverflow.com/users/7502029/kevin-p"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6443, "favorite_count": 0, "accepted_answer_id": 48302907, "answer_count": 3, "score": 0, "last_activity_date": 1516203177, "creation_date": 1516196517, "last_edit_date": 1531164843, "question_id": 48302565, "link": "https://stackoverflow.com/questions/48302565/add-data-labels-with-vba", "title": "Add Data Labels with VBA", "body": "<p>I have a <strong>Sub</strong> based off a <strong>checkbox</strong> that I want to essentially switch between showing data labels on a graph and hiding them. I recorded the macro and altered it to no longer say <strong>\"Selection\"</strong> or <strong>\"ActiveChart\"</strong> because I don't want to have the user select the chart. I think that's where my problem is because it does absolutely nothing.</p>\n\n<p>I can't seem to narrow down the issue since it's a rather long chunk. Any help would be appreciated!</p>\n\n<pre><code>Sub Checkbox()\nDim Cht As ChartObject\nSet Cht = Sheet5.ChartObjects(\"Chart 12\")\n    If Sheet1.Range(\"W11\") = \"TRUE\" Then\n    Cht.Chart.SetElement (msoElementDataLabelTop)\n    Cht.Chart.ApplyDataLabels\n    Cht.Chart.FullSeriesCollection(1).DataLabels.Select\n    Cht.ShowCategoryName = True\n    Cht.Separator = \"\" &amp; Chr(13) &amp; \"\"\n    With Cht.Format.Fill\n        .Visible = msoTrue\n        .ForeColor.RGB = RGB(127, 127, 127)\n        .Solid\n    End With\n    With Cht.Format.Fill\n        .Visible = msoTrue\n        .ForeColor.ObjectThemeColor = msoThemeColorAccent1\n        .ForeColor.TintAndShade = 0\n        .ForeColor.Brightness = 0\n        .Transparency = 0\n        .Solid\n    End With\n    With Cht.Format.Fill\n        .Visible = msoTrue\n        .ForeColor.RGB = RGB(68, 114, 196)\n        .Transparency = 0.75\n        .Solid\n    End With\n    Application.CommandBars(\"Format Object\").Visible = False\n    Else: Cht.Chart.SetElement (msoElementDataLabelNone)\n    End If\nEnd Sub\n</code></pre>\n\n<p>I was told a while ago it's better to reference a cell rather than a checkbox, hence the reason I have the code looking at W11 for \"TRUE\" or \"FALSE\". I would rather use the checkbox if it seems practical.</p>\n"}, {"tags": ["arrays", "ms-access", "vba"], "comments": [{"owner": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "edited": false, "score": 0, "creation_date": 1516220189, "post_id": 48302285, "comment_id": 83604130, "body": "Have deleted my answer which only worked in Excel.  Apologies."}, {"owner": {"reputation": 14479, "user_id": 7531598, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/DKnSq.jpg?s=128&g=1", "display_name": "Lee Mac", "link": "https://stackoverflow.com/users/7531598/lee-mac"}, "reply_to_user": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "edited": false, "score": 0, "creation_date": 1516222087, "post_id": 48302285, "comment_id": 83605122, "body": "@SMeaden no problem - thank you for your time &amp; contribution!"}], "answers": [{"comments": [{"owner": {"reputation": 14479, "user_id": 7531598, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/DKnSq.jpg?s=128&g=1", "display_name": "Lee Mac", "link": "https://stackoverflow.com/users/7531598/lee-mac"}, "edited": false, "score": 0, "creation_date": 1516212404, "post_id": 48302602, "comment_id": 83600050, "body": "Thanks - this does work in defining an array, however, not a two-dimensional string array, but rather an array of arrays... therefore rather than accessing the elements using <code>arr(0,0)</code>, I have to access them using <code>arr(0)(0)</code>..."}, {"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "reply_to_user": {"reputation": 14479, "user_id": 7531598, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/DKnSq.jpg?s=128&g=1", "display_name": "Lee Mac", "link": "https://stackoverflow.com/users/7531598/lee-mac"}, "edited": false, "score": 0, "creation_date": 1516222874, "post_id": 48302602, "comment_id": 83605533, "body": "That is true. But it should fit the purpose."}, {"owner": {"reputation": 14479, "user_id": 7531598, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/DKnSq.jpg?s=128&g=1", "display_name": "Lee Mac", "link": "https://stackoverflow.com/users/7531598/lee-mac"}, "edited": false, "score": 0, "creation_date": 1516223262, "post_id": 48302602, "comment_id": 83605742, "body": "Indeed - I could modify my <code>GetFile</code> function above to expect an array using this structure, but I thought there may be a more &quot;correct&quot; way in which to define a literal 2D string array, as it seemed like it should be a relatively straightforward exercise."}], "tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": false, "score": 0, "last_activity_date": 1516196632, "creation_date": 1516196632, "answer_id": 48302602, "question_id": 48302285, "link": "https://stackoverflow.com/questions/48302285/defining-a-literal-2d-string-array-in-vba/48302602#48302602", "title": "Defining a Literal 2D String Array in VBA", "body": "<p>Your last method will work:</p>\n\n<pre><code>Dim arr() As Variant\narr = Array(Array(\"Excel Files\", \"*.xls;*.xlsx\"), Array(\"Text Files\", \"*.txt\"))\n</code></pre>\n\n<p>Your error must be caused by something else.</p>\n"}, {"comments": [{"owner": {"reputation": 14479, "user_id": 7531598, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/DKnSq.jpg?s=128&g=1", "display_name": "Lee Mac", "link": "https://stackoverflow.com/users/7531598/lee-mac"}, "edited": false, "score": 0, "creation_date": 1516222751, "post_id": 48302964, "comment_id": 83605469, "body": "Thanks Alex, this is cleaner solution than my current approach, though of course still populating an empty array as opposed to defining a literal array... Perhaps this is not possible in Access VBA."}, {"owner": {"reputation": 158803, "user_id": 246342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8ba0aea3f521082f18dd7c186e7d4c3?s=128&d=identicon&r=PG", "display_name": "Alex K.", "link": "https://stackoverflow.com/users/246342/alex-k"}, "reply_to_user": {"reputation": 14479, "user_id": 7531598, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/DKnSq.jpg?s=128&g=1", "display_name": "Lee Mac", "link": "https://stackoverflow.com/users/7531598/lee-mac"}, "edited": false, "score": 0, "creation_date": 1516224217, "post_id": 48302964, "comment_id": 83606186, "body": "Sadly vba/s/6 do not support variable initialization of any type for any type."}], "tags": [], "owner": {"reputation": 158803, "user_id": 246342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8ba0aea3f521082f18dd7c186e7d4c3?s=128&d=identicon&r=PG", "display_name": "Alex K.", "link": "https://stackoverflow.com/users/246342/alex-k"}, "is_accepted": false, "score": 0, "last_activity_date": 1516197723, "creation_date": 1516197723, "answer_id": 48302964, "question_id": 48302285, "link": "https://stackoverflow.com/questions/48302285/defining-a-literal-2d-string-array-in-vba/48302964#48302964", "title": "Defining a Literal 2D String Array in VBA", "body": "<p>Use another utility function to make the array then you can:</p>\n\n<pre><code>GetFile , , StrsTo2d(\"Excel Files\", \"*.xls;*.xlsx\")\nGetFile , , StrsTo2d(\"Excel Files\", \"*.xls;*.xlsx\", \"Text Files\", \"*.txt\")\nGetFile , , StrsTo2d(\"Excel Files\", \"*.xls;*.xlsx\", \"Text Files\", \"*.txt\", \"FooFile\", \"*.foo\")\n</code></pre>\n\n<hr>\n\n<pre><code>Function StrsTo2d(ParamArray args() As Variant) As String()\n    Dim     i As Long\n    Dim num As Long: num = (UBound(args) - 1) / 2\n    ReDim   out(num, 1) As String\n\n    For i = 0 To num\n        out(i, 0) = args(i * 2)\n        out(i, 1) = args(i * 2 + 1)\n    Next\n\n    StrsTo2d = out\nEnd Function\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 14479, "user_id": 7531598, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/DKnSq.jpg?s=128&g=1", "display_name": "Lee Mac", "link": "https://stackoverflow.com/users/7531598/lee-mac"}, "edited": false, "score": 1, "creation_date": 1516281508, "post_id": 48320514, "comment_id": 83629648, "body": "Wow - thank you for this example! I have not used classes previously, so this is a great introduction."}], "tags": [], "owner": {"reputation": 5714, "user_id": 1684486, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/6kb2P.jpg?s=128&g=1", "display_name": "Krish", "link": "https://stackoverflow.com/users/1684486/krish"}, "is_accepted": true, "score": 1, "last_activity_date": 1516275733, "creation_date": 1516275733, "answer_id": 48320514, "question_id": 48302285, "link": "https://stackoverflow.com/questions/48302285/defining-a-literal-2d-string-array-in-vba/48320514#48320514", "title": "Defining a Literal 2D String Array in VBA", "body": "<p>Because you commented that you could edit the getFile function, you should consider this approach. Using an Array might be a simple and straightforward idea but if your applications is complex enough, there is a chance your Array initialisations could become clumsy.</p>\n\n<p>Below approach is just an introduction to classes and maybe to design pattern. Have a look.</p>\n\n<pre><code>Public Function test()\n\n    Dim fe As New FileExtensions 'initialise your file extension class\n\n    'Add filters\n    fe.AddFilter \"All Files\", \"*.*\" 'add here or in class defaults\n    fe.AddFilter \"Excel Files\", \"*.xls; *.xlsx\"\n    fe.AddFilter \"Text Files\", \"*.txt\"\n\n    GetFile , , fe\nEnd Function\n\nFunction GetFile(Optional strMsg As String = \"Select File\", Optional strIni As String = vbNullString, Optional arrFlt) As String\n    Dim dia As Object\n    Set dia = Application.FileDialog(3)\n    With dia\n        .InitialFileName = strIni\n        .AllowMultiSelect = False\n        .Title = strMsg\n        .filters.Clear\n\n        'Simply retrieve the filters from extension class\n        If Not IsMissing(arrFlt) Then\n            Dim i As Long\n            For i = 0 To arrFlt.getCount - 1\n                .filters.ADD arrFlt.getDescription(i), arrFlt.getFilter(i)\n            Next i\n        End If\n        If .Show Then\n            GetFile = .selecteditems.item(1)\n        End If\n    End With\nEnd Function\n</code></pre>\n\n<p>and a FileExtensions class</p>\n\n<pre><code>Option Compare Database\nOption Explicit\n\nPrivate Type FileExtension\n    tDescription As String\n    tFilter As String\nEnd Type\nPrivate Holder() As FileExtension\n\nPublic Sub class_initialize()\n    ReDim Holder(0) ' or if you want to add default filters\nEnd Sub\n\nPublic Sub AddFilter(Description As String, Filter As String)\n\n    ReDim Preserve Holder(UBound(Holder) + 1)\n    Holder(UBound(Holder) - 1).tDescription = Description\n    Holder(UBound(Holder) - 1).tFilter = Filter\n\nEnd Sub\n\nPublic Function getCount() As Long\n    getCount = UBound(Holder)\nEnd Function\n\nPublic Function getDescription(index As Long) As String\n    getDescription = Holder(index).tDescription\nEnd Function\n\nPublic Function getFilter(index As Long) As String\n    getFilter = Holder(index).tFilter\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 14479, "user_id": 7531598, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/DKnSq.jpg?s=128&g=1", "display_name": "Lee Mac", "link": "https://stackoverflow.com/users/7531598/lee-mac"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2372, "favorite_count": 0, "accepted_answer_id": 48320514, "answer_count": 3, "score": 3, "last_activity_date": 1516405699, "creation_date": 1516195582, "last_edit_date": 1516405699, "question_id": 48302285, "link": "https://stackoverflow.com/questions/48302285/defining-a-literal-2d-string-array-in-vba", "title": "Defining a Literal 2D String Array in VBA", "body": "<p>I'm trying to construct a utility function to prompt the user for an arbitrary file via the standard Windows file dialog.</p>\n\n<p>I would like to pass the list of filetype filters as a two dimensional array of strings, where the first element of each subarray is the filetype description and the second element is the filetype filter.</p>\n\n<p>Below is my function:</p>\n\n<pre><code>'' GetFile  -  Lee Mac\n''\n'' Prompts the user to select a file using a standard Windows file dialog\n''\n'' msg - [str] Dialog title\n'' ini - [str] Initial filename/filepath\n'' flt - [arr] Array of filetype filters\n''\nFunction GetFile(Optional strMsg As String = \"Select File\", Optional strIni As String = vbNullString, Optional arrFlt) As String\n    Dim dia As FileDialog\n    Set dia = Application.FileDialog(msoFileDialogFilePicker)\n    With dia\n        .InitialFileName = strIni\n        .AllowMultiSelect = False\n        .Title = strMsg\n        .Filters.Clear\n        If IsMissing(arrFlt) Then\n            .Filters.Add \"All Files\", \"*.*\"\n        Else\n            Dim i As Integer\n            For i = 0 To UBound(arrFlt, 1)\n                .Filters.Add arrFlt(i, 0), arrFlt(i, 1)\n            Next i\n        End If\n        If .show Then\n            GetFile = .selecteditems.Item(1)\n        End If\n    End With\nEnd Function\n</code></pre>\n\n<p>This works, however, when supplying the filetype filter argument to the function, I find myself having to do something like this:</p>\n\n<pre><code>Function test()\n    Dim arr(1, 1) As String\n    arr(0, 0) = \"Excel Files\"\n    arr(0, 1) = \"*.xls;*.xlsx\"\n    arr(1, 0) = \"Text Files\"\n    arr(1, 1) = \"*.txt\"\n\n    GetFile , , arr\nEnd Function\n</code></pre>\n\n<p>I've also tried the following but receive 'Subscript out of range':</p>\n\n<pre><code>Dim arr() As Variant\narr = Array(Array(\"Excel Files\", \"*.xls;*.xlsx\"), Array(\"Text Files\", \"*.txt\"))\n</code></pre>\n\n<p>Is there a better way to define a literal 2D string array that I'm missing?</p>\n\n<p>Many thanks in advance for your advice &amp; feedback.</p>\n"}, {"tags": ["excel", "web-scraping", "vba"], "comments": [{"owner": {"reputation": 387, "user_id": 7630262, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a74551d0063aa3c06837041235d7d571?s=128&d=identicon&r=PG&f=1", "display_name": "T. Nesset", "link": "https://stackoverflow.com/users/7630262/t-nesset"}, "edited": false, "score": 0, "creation_date": 1516199429, "post_id": 48301175, "comment_id": 83591630, "body": "To be able to help you go further with your script, you need to find the HTML elements that you want to interact with. These can be found if you press F12 in your browser. I know that Chrome and Edge will highlight the elements on the page, when you hover over them in the Developer Tool window (after pressing F12)"}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user7755666"}, "edited": false, "score": 0, "creation_date": 1516201240, "post_id": 48302345, "comment_id": 83592825, "body": "this Topic is good , I&#39;m gonna carry on with coding until I get a problem to post it here"}, {"owner": {"reputation": 4239, "user_id": 6480658, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/79a2edab9dc17e4c66e1d91ebe7a40f7?s=128&d=identicon&r=PG&f=1", "display_name": "jamheadart", "link": "https://stackoverflow.com/users/6480658/jamheadart"}, "edited": false, "score": 0, "creation_date": 1516209050, "post_id": 48302345, "comment_id": 83598118, "body": "It&#39;s great, I ended up using it all the time at work, I&#39;ve built a lot of handy tools that save people a lot of time automating annoying admin jobs they do through POST and GET requests. Just all background internet stuff, filling in forms etc."}, {"owner": {"reputation": 4239, "user_id": 6480658, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/79a2edab9dc17e4c66e1d91ebe7a40f7?s=128&d=identicon&r=PG&f=1", "display_name": "jamheadart", "link": "https://stackoverflow.com/users/6480658/jamheadart"}, "edited": false, "score": 0, "creation_date": 1516209084, "post_id": 48302345, "comment_id": 83598136, "body": "Oh and yeah, if you get specific coding problems related to that then please post here!"}], "tags": [], "owner": {"reputation": 4239, "user_id": 6480658, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/79a2edab9dc17e4c66e1d91ebe7a40f7?s=128&d=identicon&r=PG&f=1", "display_name": "jamheadart", "link": "https://stackoverflow.com/users/6480658/jamheadart"}, "is_accepted": true, "score": 0, "last_activity_date": 1516195772, "creation_date": 1516195772, "answer_id": 48302345, "question_id": 48301175, "link": "https://stackoverflow.com/questions/48301175/searching-for-data-vbaweb/48302345#48302345", "title": "Searching for DATA (VBA+Web)", "body": "<p>If you have your URL then the next stage is to send it. To send it you need something to act as a connector, like Internet Explorer, or a background connector without the browser like XMLHttpServer objects - <a href=\"https://codingislove.com/http-requests-excel-vba/\" rel=\"nofollow noreferrer\">THIS</a> is a good guide to hopefully get you started.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user7755666"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 101, "favorite_count": 0, "accepted_answer_id": 48302345, "answer_count": 1, "score": 0, "last_activity_date": 1516195772, "creation_date": 1516192108, "last_edit_date": 1531164843, "question_id": 48301175, "link": "https://stackoverflow.com/questions/48301175/searching-for-data-vbaweb", "title": "Searching for DATA (VBA+Web)", "body": "<p>I'm trying to create a macro that fetch for specific DATA in URL from Excel sheet and when the DATA is found , it copy the values and past it into the Excel File andmove on to the next DATA </p>\n\n<p>I'm a little bit new with SCRAPPING WEB via EXCEL VBA so Anyone can light me and helps me to carry on ?</p>\n\n<ul>\n<li>I made a lot of searches here in stack over flow but I didn't understand too much </li>\n</ul>\n\n<p>I will explain below with Image what I want to Do and I will show My code which is nothing :( </p>\n\n<p>First URL to use to access to <code>MP</code> :<a href=\"http://XXXX-XXXXX.eu.airbus.XXXX:XXXXX/XXXX/consultation/preSearchMP.do?clearBackList=true&amp;CMH_NO_STORING_fromMenu=true\" rel=\"nofollow noreferrer\">http://XXXX-XXXXX.eu.airbus.XXXX:XXXXX/XXXX/consultation/preSearchMP.do?clearBackList=true&amp;CMH_NO_STORING_fromMenu=true</a> </p>\n\n<p><a href=\"https://i.stack.imgur.com/uVdlB.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/uVdlB.jpg\" alt=\"Image One \"></a></p>\n\n<p><strong>then Take a value from EXCEL FILE and put it in that Path to make search and tape enter</strong>\n<a href=\"https://i.stack.imgur.com/CUf9z.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/CUf9z.jpg\" alt=\"enter image description here\"></a></p>\n\n<p><strong>The last Picture IT will loop for <code>MOD</code> and Copy Value and Paste it into Excel File</strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/dnvs4.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/dnvs4.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>Can Anyone guide me please with something </p>\n\n<p>this is my first Code</p>\n\n<pre><code>Dim str As String: str = ThisWorkbook.Sheets(\"Feuil1\").Range(\"A1\").Value    \nDim myURL as String\n' The &amp; symbol concatenates strings. The _ symbol is for line continuation.\n myURL = \n \"http://Confidential.eu.airbus.Confidential:Confidential/Confidential/\" _\n     &amp; \"consultation/preViewMP.do?\" &amp; str\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 18498, "user_id": 620444, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/592e6e89add7a3937a41c963941e10e1?s=128&d=identicon&r=PG", "display_name": "Andy G", "link": "https://stackoverflow.com/users/620444/andy-g"}, "edited": false, "score": 3, "creation_date": 1516191299, "post_id": 48300910, "comment_id": 83586270, "body": "What have you attempted or considered?"}, {"owner": {"reputation": 5324, "user_id": 8759927, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/B8ktI.jpg?s=128&g=1", "display_name": "shrivallabha.redij", "link": "https://stackoverflow.com/users/8759927/shrivallabha-redij"}, "reply_to_user": {"reputation": 18498, "user_id": 620444, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/592e6e89add7a3937a41c963941e10e1?s=128&d=identicon&r=PG", "display_name": "Andy G", "link": "https://stackoverflow.com/users/620444/andy-g"}, "edited": false, "score": 0, "creation_date": 1516191742, "post_id": 48300910, "comment_id": 83586563, "body": "You can do with formula as well. VBA is not required. But as indicated by @AndyG you need to show us your efforts!"}, {"owner": {"reputation": 186, "user_id": 7528039, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/I1pwD.jpg?s=128&g=1", "display_name": "Kyoujin", "link": "https://stackoverflow.com/users/7528039/kyoujin"}, "edited": false, "score": 0, "creation_date": 1516192155, "post_id": 48300910, "comment_id": 83586777, "body": "Hint (<a href=\"https://exceljet.net/formula/sum-if-cells-contain-either-x-or-y\" rel=\"nofollow noreferrer\">exceljet.net/formula/sum-if-cells-contain-either-x-or-y</a>)"}], "answers": [{"comments": [{"owner": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "edited": false, "score": 0, "creation_date": 1516195136, "post_id": 48302040, "comment_id": 83588709, "body": "Very good.  I was working on something a lot more heavyweight."}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": true, "score": 3, "last_activity_date": 1516194803, "creation_date": 1516194803, "answer_id": 48302040, "question_id": 48300910, "link": "https://stackoverflow.com/questions/48300910/split-cell-values-into-multiple-columns/48302040#48302040", "title": "Split cell values into multiple columns", "body": "<p>Since you wanted some VBA in the solution, enter this UDF in a standard module:</p>\n\n<pre><code>Public Function IsIn(big As String, little As Variant) As String\n    IsIn = \"\"\n    If InStr(big, CStr(little)) &gt; 0 Then\n        IsIn = \"X\"\n    End If\nEnd Function\n</code></pre>\n\n<p>Then in <strong>C2</strong> enter:</p>\n\n<pre><code>=isin($B2,C$1)\n</code></pre>\n\n<p>copy this both across and downward:</p>\n\n<p><a href=\"https://i.stack.imgur.com/65pon.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/65pon.png\" alt=\"enter image description here\"></a></p>\n\n<p><strong>NOTE:</strong></p>\n\n<ul>\n<li>you can use a worksheet formula rather than a UDF()</li>\n<li>this works for values like 1 through 7 <em>(days of week)</em>; not so well for values like 1 through 31 <em>(days of month)</em></li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "is_accepted": false, "score": 1, "last_activity_date": 1516195356, "creation_date": 1516195356, "answer_id": 48302207, "question_id": 48300910, "link": "https://stackoverflow.com/questions/48300910/split-cell-values-into-multiple-columns/48302207#48302207", "title": "Split cell values into multiple columns", "body": "<p>I recommend Gary's Student answer but as I was in the middle of writing mine, I thought I'd dump it here anyhow.</p>\n\n<pre><code>Option Explicit\n\nSub TestParseData()\n    Dim vReport As Variant\n    vReport = ParseData(MockData)\n\nEnd Sub\n\nFunction MockData() As Variant\n\n    Dim vData As Variant\n    ReDim vData(1 To 4, 1 To 2)\n    vData(1, 1) = \"Person 1\"\n    vData(2, 1) = \"Person 2\"\n    vData(3, 1) = \"Person 3\"\n    vData(4, 1) = \"Person 4\"\n\n    vData(1, 2) = \"2,3,5\"\n    vData(2, 2) = \"1,2\"\n    vData(3, 2) = \"5\"\n    vData(4, 2) = \"1,2,3,6,7\"\n\n    MockData = vData\n\n\n\nEnd Function\n\nFunction ParseData(ByVal vData As Variant) As Variant\n\n    '* start of pre-conditions\n    On Error Resume Next\n    '* test for two dimension array like off a sheet range\n    Dim vRows As Variant, vColumns As Variant\n    vRows = UBound(vData, 1) - LBound(vData, 1) + 1\n    vColumns = UBound(vData, 2) - LBound(vData, 2) + 1\n    On Error GoTo 0\n    If IsEmpty(vRows) Or IsEmpty(vColumns) Then Err.Raise vbObjectError, , \"#Please supply a 2d array from a sheet range with two columns!\"\n    If vColumns &lt;&gt; 2 Then Err.Raise vbObjectError, , \"#Please supply a 2d array from a sheet range with two columns!\"\n    '* end of pre-conditions\n\n    ReDim dicPersonSchedule(LBound(vData, 1) To UBound(vData, 1)) As Scripting.Dictionary\n\n    '* STEP 1 , load up all work days in each person's dictionary\n    '*     and find Min and Max of workdays to define range\n    Dim lPersonLoop As Long\n    Dim lMax As Long: lMax = -1\n    Dim lMin As Long: lMin = 2 ^ 30\n    For lPersonLoop = LBound(vData, 1) To UBound(vData, 1)\n        Set dicPersonSchedule(lPersonLoop) = New Scripting.Dictionary\n\n        Dim vWorkDaysSplit As Variant\n        vWorkDaysSplit = Split(vData(lPersonLoop, 2), \",\")\n\n        Dim vWorkDaysSplitLoop As Variant\n        For Each vWorkDaysSplitLoop In vWorkDaysSplit\n            If Not IsNumeric(vWorkDaysSplitLoop) Then Err.Raise \"#Bad data, expecting commas and numbers!\"\n\n            If vWorkDaysSplitLoop &lt; lMin Then lMin = vWorkDaysSplitLoop\n            If vWorkDaysSplitLoop &gt; lMax Then lMax = vWorkDaysSplitLoop\n            dicPersonSchedule(lPersonLoop).add vWorkDaysSplitLoop, 0\n        Next\n    Next lPersonLoop\n\n    '*STEP 2 - load the report\n    ReDim vReturn(LBound(vData, 1) To UBound(vData, 1), lMin To lMax)\n\n    For lPersonLoop = LBound(vData, 1) To UBound(vData, 1)\n        For Each vWorkDaysSplitLoop In dicPersonSchedule(lPersonLoop).Keys\n            vReturn(lPersonLoop, vWorkDaysSplitLoop) = \"X\"\n        Next\n\n    Next lPersonLoop\n\n    ParseData = vReturn\n\n\n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 19, "user_id": 8885109, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddddefc801a8cc8e7fd12c1609325d07?s=128&d=identicon&r=PG&f=1", "display_name": "Kilo64", "link": "https://stackoverflow.com/users/8885109/kilo64"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 67, "favorite_count": 1, "accepted_answer_id": 48302040, "answer_count": 2, "score": -5, "last_activity_date": 1516195356, "creation_date": 1516191221, "last_edit_date": 1516191332, "question_id": 48300910, "link": "https://stackoverflow.com/questions/48300910/split-cell-values-into-multiple-columns", "title": "Split cell values into multiple columns", "body": "<p>I have an Excel with multiple dates in a single cell separated by comma as follows:</p>\n\n<pre><code>Name         Work Days  \nPerson 1     2,3,5  \nPerson 2     1,2  \nPerson 3     5  \nPerson 4     1,2,3,6,7  \n</code></pre>\n\n<p>Now I need to make an X mark against only the working days so that my output looks as follows:</p>\n\n<pre><code>Name         Work Days    1    2    3    4    5    6    7\nPerson 1     2,3,5             X    X         X\nPerson 2     1,2          X    X\nPerson 3     5                                X\nPerson 4     1,2,3,6,7    X    X    X              X    X\n</code></pre>\n\n<p>Please note that the dates in the table header does not need to be dynamically populated as they are fixed. I just need to put the X mark against the corresponding columns. Thanks in advance!</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 495, "user_id": 7747433, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/JkdzF.jpg?s=128&g=1", "display_name": "nishit dey", "link": "https://stackoverflow.com/users/7747433/nishit-dey"}, "edited": false, "score": 0, "creation_date": 1516192595, "post_id": 48300771, "comment_id": 83587092, "body": "It will always depend on the task you are performing."}, {"owner": {"reputation": 1329, "user_id": 5686352, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XzZNx.png?s=128&g=1", "display_name": "appa yip yip", "link": "https://stackoverflow.com/users/5686352/appa-yip-yip"}, "edited": false, "score": 5, "creation_date": 1516192888, "post_id": 48300771, "comment_id": 83587271, "body": "You should consider posting on <a href=\"https://codereview.stackexchange.com/\">Code Review</a>, not here"}, {"owner": {"reputation": 895, "user_id": 7690982, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/3391858e255d5aa7f209ecfb3029526c?s=128&d=identicon&r=PG&f=1", "display_name": "danieltakeshi", "link": "https://stackoverflow.com/users/7690982/danieltakeshi"}, "edited": false, "score": 1, "creation_date": 1516192901, "post_id": 48300771, "comment_id": 83587274, "body": "You could avoid the use of <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">Select and Activate</a> and read this reference: <a href=\"http://www.avdf.com/apr98/art_ot003.html\" rel=\"nofollow noreferrer\">Excel VBA : Efficiency and Performance</a>. And use some timers to discover what part of your code is most time consuming and edit your post with the new information, describing what you want to do. If you are going to post on CodeReview, you should read: <a href=\"https://codereview.meta.stackexchange.com/q/5777\">A guide to Code Review for Stack Overflow users</a>"}, {"owner": {"reputation": 3, "user_id": 9177593, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32b3466e28804fea6c004dd8402cf607?s=128&d=identicon&r=PG&f=1", "display_name": "John Doe", "link": "https://stackoverflow.com/users/9177593/john-doe"}, "edited": false, "score": 0, "creation_date": 1516782680, "post_id": 48300771, "comment_id": 83825400, "body": "Thanks for the guides guys. I&#39;ve learned a lot by reading them :)"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 9177593, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32b3466e28804fea6c004dd8402cf607?s=128&d=identicon&r=PG&f=1", "display_name": "John Doe", "link": "https://stackoverflow.com/users/9177593/john-doe"}, "edited": false, "score": 0, "creation_date": 1516610734, "post_id": 48302594, "comment_id": 83741868, "body": "Works like a charm ! Thanks a lot sir ! :)"}], "tags": [], "owner": {"reputation": 7497, "user_id": 8670372, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ir8a4Lbosmo/AAAAAAAAAAI/AAAAAAAAOtE/2eY5jK1atcc/photo.jpg?sz=128", "display_name": "Xabier", "link": "https://stackoverflow.com/users/8670372/xabier"}, "is_accepted": true, "score": 0, "last_activity_date": 1516196618, "creation_date": 1516196618, "answer_id": 48302594, "question_id": 48300771, "link": "https://stackoverflow.com/questions/48300771/how-may-i-optimize-my-code-to-speed-up-the-process/48302594#48302594", "title": "How may i optimize my code to speed up the process?", "body": "<p>By removing the Select and Activate methods, it should speed up your code, I believe the following should do it:</p>\n\n<pre><code>Option Explicit\n\nPublic Namepatch3 As String\n\nSub Figures()\n\nDim Filt As String\nDim IndexFiltre As Integer, NomFichier As Variant, Titre As String\nDim o As Integer, p As Integer\nDim Msg As String\nDim ConsoPDC As Workbook\nDim Fichier As String, fichier1 As String, chaine As String\nDim feuille As Variant\nDim Reponse As Integer\nDim Config As Integer\nDim nomClasseur As Variant\nDim vclasseur As Workbook\nDim resum As Workbook\nDim ws As Worksheet\n\nDim n As Long\n    With ThisWorkbook.Worksheets(\"Dest\")\n        n = .Range(\"L\" &amp; .Rows.Count).End(xlUp).Row + 1\n    End With\n\n\nNamepatch3 = ThisWorkbook.Name\n\nApplication.ScreenUpdating = False\nApplication.Calculation = xlCalculationManual\n'   File filters list\nFilt = \"txt files (*.txt),*.txt,\" &amp; _\n        \"Lotus files (*.prn),*.prn,\" &amp; _\n        \"Comma separated files (*.csv),*.csv,\" &amp; _\n        \"ASCII files (*.asc),*.asc,\" &amp; _\n        \"All files (*.*),*.*\"\n'   display *.* by default\nIndexFiltre = 5\n'   DialogBox\nTitre = \"S\u00e9lectionner les fichiers \u00e0 traiter\"\n'   Get file name\nNomFichier = Application.GetOpenFilename _\n    (fileFilter:=Filt, _\n     FilterIndex:=IndexFiltre, _\n     Title:=Titre, _\n     MultiSelect:=True)\n'   Quit if the dialogbox is cancelled\nIf Not IsArray(NomFichier) Then\n    MsgBox \"No files were selected!\"\n    Application.StatusBar = False\n    GoTo TheEnd\nEnd If\n'   display the entire path + file name\nConfig = vbYesNo + vbInformation + vbDefaultButton2\nFor o = LBound(NomFichier) To UBound(NomFichier)\n    Msg = Msg &amp; NomFichier(o)\nNext o\nReponse = MsgBox(\"Please find below your file :\" &amp; vbCrLf &amp; Msg &amp; vbCrLf, Config, \"MAJ resum\")\nIf Reponse = vbNo Then\n  GoTo TheEnd\nEnd If\n\n\n  '   MsgBox (Msg) ' Source file\n   ' Test to check if the file has already been opened\n\n   ' If yes =&gt; close file or use the opened file ?\n    Workbooks.Open Filename:=Msg\n\n\n'------------------------------------------------------------------------------------------------------\n'Only select file name instead of whole path\nfichier1 = Right(Msg, Len(Msg) - InStrRev(Msg, \"\\\", -1, 1))\nFichier = Left(fichier1, InStr(fichier1, \".xls\") - 1)\n\n'Import process\n'------------------------------------------------------------------------------------------------------\n\nDim i As Integer\nDim j As Integer\nDim K As Integer\nDim l  As Integer\n\nDim debutcols As Integer ' Year in number ?\nDim fincols As Integer ' Year in number ?\nDim debutas As Integer ' Column N\u00b0 first year\nDim finas As Integer ' Column N\u00b0 last year\nDim debutcold As Integer\nDim fincold As Integer\nDim debutad As Integer\nDim finad As Integer\nDim rowmaxwallets As Integer\nDim rowmaxwalletd As Integer\nDim c As Object\nDim therow As Integer\nDim Nlp As String\nDim Vcol(30) As Variant ' data paste year\nDim cpt As Integer\n\ndebutcols = CInt(Workbook(fichier1).Worksheets(\"DataBase\").Cells(1, 22))  ' (col V)  XXXX\ndebutas = 22\nfincols = 0\nfincold = 0\nfinas = 0\ndebutad = 0\nfinad = 0\n\n' End column in source file\ni = 0\nFor i = 1 To 30\n    If Len(Workbook(fichier1).Worksheets(\"DataBase\").Cells(1, i + 22)) = 4 Then\n        ' If a year is found\n    Else\n        ' Plus 1 column\n        i = i - 1\n        finas = (22 + i)\n        fincols = CInt(Workbook(fichier1).Worksheets(\"DataBase\").Cells(1, i + 22))\n        GoTo sortie\n    End If\nNext i\n\nsortie:\n   Columns(ConvertCol(debutas) &amp; \":\" &amp; ConvertCol(finas)).Select\n\n    For i = 1 To 70\n        If Workbook(Namepatch3).Worksheets(\"Dest\").Cells(1, i) = debutcols Then\n            debutcold = i\n            debutad = i\n            GoTo sortie2\n        End If\n    Next i\n\nsortie2:\n    finad = debutad + (finas - debutas)\n\n    rowmaxwallets = CInt(Workbook(fichier1).Worksheets(\"DataBase\").Cells(Columns(1).Cells.Count, 1).End(xlUp).Row)\n\n    rowmaxwalletd = CInt(Workbook(Namepatch3).Worksheets(\"LP\").Cells(Columns(1).Cells.Count, 1).End(xlUp).Row)\n    i = 0\n    cpt = 1\n\n    Application.ScreenUpdating = True\n    Application.Calculation = xlCalculationManual\n\nFor i = 1 To rowmaxwalletd ' loop on all lines in source file\n'Read source file\n    For l = 1 To rowmaxwallets\n        ' dynamically copy figures\n        For j = 0 To (finas - debutas)\n          Vcol(j) = Workbook(fichier1).Worksheets(\"Database\").Cells(1822 + l, debutas + j)\n        Next j\n\n        ' Paste figures\n        For j = 0 To (finas - debutas)\n          Workbook(Namepatch3).Worksheets(\"Dest\").Cells(n, debutad + j) = Vcol(j)\n        Next j\n    n = n + 1\n    Next l\nNext i\nfin:\n    Application.StatusBar = False\n    Application.ScreenUpdating = True\n    Application.Calculation = xlCalculationAutomatic\n    Worksheets(\"Dest\").Select\n    Range(\"A3\").Select\n    MsgBox (\"Import done\")\n\n   'Set resource free\n    Workbook(fichier1).Close\nTheEnd:\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 9177593, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32b3466e28804fea6c004dd8402cf607?s=128&d=identicon&r=PG&f=1", "display_name": "John Doe", "link": "https://stackoverflow.com/users/9177593/john-doe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 64, "favorite_count": 0, "accepted_answer_id": 48302594, "answer_count": 1, "score": -2, "last_activity_date": 1516196618, "creation_date": 1516190722, "question_id": 48300771, "link": "https://stackoverflow.com/questions/48300771/how-may-i-optimize-my-code-to-speed-up-the-process", "title": "How may i optimize my code to speed up the process?", "body": "<p>Thanks to the help from some users of this site, my vba code is now working well.\nBut the process is quite long to be achieved, approx. 5 min for a little excel file to import and it is proportional with the excel file size to import...</p>\n\n<p>How may I optimize it to speed up my import process ?\nEvery tips, idea or advice is welcome\nBelow is my code:</p>\n\n<pre><code>Option Explicit\n\nPublic Namepatch3 As String\n\nSub Figures()\n\n\nDim Filt As String\nDim IndexFiltre As Integer, NomFichier As Variant, Titre As String\nDim o As Integer, p As Integer\nDim Msg As String\nDim ConsoPDC As Workbook\nDim Fichier As String, fichier1 As String, chaine As String\nDim feuille As Variant\nDim Reponse As Integer\nDim Config As Integer\nDim nomClasseur As Variant\nDim vclasseur As Workbook\nDim resum As Workbook\nDim wkb As Workbook\nDim ws As Worksheet\n\nDim n\n    With Worksheets(\"Dest\")\n        n = .Range(\"L\" &amp; .Rows.Count).End(xlUp).Row + 1\n    End With\n\nSet wkb = ActiveWorkbook\n\nNamepatch3 = ThisWorkbook.Name\n\nApplication.ScreenUpdating = False\nApplication.Calculation = xlCalculationManual\n'   File filters list\nFilt = \"txt files (*.txt),*.txt,\" &amp; _\n        \"Lotus files (*.prn),*.prn,\" &amp; _\n        \"Comma separated files (*.csv),*.csv,\" &amp; _\n        \"ASCII files (*.asc),*.asc,\" &amp; _\n        \"All files (*.*),*.*\"\n'   display *.* by default\nIndexFiltre = 5\n'   DialogBox\nTitre = \"S\u00e9lectionner les fichiers \u00e0 traiter\"\n'   Get file name\nNomFichier = Application.GetOpenFilename _\n    (fileFilter:=Filt, _\n     FilterIndex:=IndexFiltre, _\n     Title:=Titre, _\n     MultiSelect:=True)\n'   Quit if the dialogbox is cancelled\nIf Not IsArray(NomFichier) Then\n    MsgBox \"No files were selected!\"\n    Application.StatusBar = False\n    GoTo TheEnd\nEnd If\n'   display the entire path + file name\nConfig = vbYesNo + vbInformation + vbDefaultButton2\nFor o = LBound(NomFichier) To UBound(NomFichier)\n    Msg = Msg &amp; NomFichier(o)\nNext o\nReponse = MsgBox(\"Please find below your file :\" &amp; vbCrLf &amp; Msg &amp; vbCrLf, Config, \"MAJ resum\")\nIf Reponse = vbNo Then\n  GoTo TheEnd\nEnd If\n\n\n  '   MsgBox (Msg) ' Source file\n   ' Test to check if the file has already been opened\n\n   ' If yes =&gt; close file or use the opened file ? \n    Workbooks.Open Filename:=Msg\n\n\n'------------------------------------------------------------------------------------------------------\nOnly select file name instead of whole path\nfichier1 = Right(Msg, Len(Msg) - InStrRev(Msg, \"\\\", -1, 1))\nFichier = Left(fichier1, InStr(fichier1, \".xls\") - 1)\n\n'Import process\n'------------------------------------------------------------------------------------------------------\n\nDim i As Integer\nDim j As Integer\nDim K As Integer\nDim l  As Integer\n\nDim debutcols As Integer ' Year in number ?\nDim fincols As Integer ' Year in number ?\nDim debutas As Integer ' Column N\u00b0 first year\nDim finas As Integer ' Column N\u00b0 last year\nDim debutcold As Integer\nDim fincold As Integer\nDim debutad As Integer\nDim finad As Integer\nDim rowmaxwallets As Integer\nDim rowmaxwalletd As Integer\nDim c As Object\nDim therow As Integer\nDim Nlp As String\nDim Vcol(30) As Variant ' data paste year\nDim cpt As Integer\n\n\nWindows(fichier1).Activate\nWorksheets(\"DataBase\").Select\n\ndebutcols = CInt(Worksheets(\"DataBase\").Cells(1, 22))  ' (col V)  XXXX\ndebutas = 22\nfincols = 0\nfincold = 0\nfinas = 0\ndebutad = 0\nfinad = 0\n\n' End column in source file\ni = 0\nFor i = 1 To 30\n   If Len(Worksheets(\"DataBase\").Cells(1, i + 22)) = 4 Then\n     ' If a year is found\n     Else\n     ' Plus 1 column\n     i = i - 1\n     finas = (22 + i)\n     fincols = CInt(Worksheets(\"DataBase\").Cells(1, i + 22))\n     GoTo sortie\n   End If\nNext\n\nsortie:\n   Columns(ConvertCol(debutas) &amp; \":\" &amp; ConvertCol(finas)).Select\n\n   Windows(Namepatch3).Activate\n   Worksheets(\"Dest\").Select\n   i = 0\n\n   For i = 1 To 70\n   If Worksheets(\"Dest\").Cells(1, i) = debutcols Then\n     debutcold = i\n     debutad = i\n\n     GoTo sortie2\n     End If\n   Next i\n\nsortie2:\n     finad = debutad + (finas - debutas)\n\n   Windows(fichier1).Activate\n   Sheets(\"DataBase\").Select\n   rowmaxwallets = CInt(Worksheets(\"DataBase\").Cells(Columns(1).Cells.Count, 1).End(xlUp).Row)\n\n   Windows(Namepatch3).Activate\n   Worksheets(\"LP\").Select\n\n   rowmaxwalletd = CInt(Worksheets(\"LP\").Cells(Columns(1).Cells.Count, 1).End(xlUp).Row)\n   i = 0\n   cpt = 1\n\n   Application.ScreenUpdating = True\n   Application.Calculation = xlCalculationManual\n\n   For i = 1 To rowmaxwalletd ' loop on all lines in source file\n\n\n     Windows(Namepatch3).Activate\n     Sheets(\"LP\").Select\n\n\n         'Read source file\n     For l = 1 To rowmaxwallets\n        ' dynamically copy figures\n        Windows(fichier1).Activate\n        Sheets(\"DataBase\").Select\n                   For j = 0 To (finas - debutas)\n             Vcol(j) = Worksheets(\"Database\").Cells(1822 + l, debutas + j)\n           Next j\n                     Windows(Namepatch3).Activate\n           Worksheets(\"Dest\").Select\n\n          ' Paste figures\n           For j = 0 To (finas - debutas)\n             Worksheets(\"Dest\").Cells(n, debutad + j) = Vcol(j)\n           Next j\n           n = n + 1\n\n\n     Next l\n   Next i\nfin:\n   Application.StatusBar = False\n   Application.ScreenUpdating = True\n   Application.Calculation = xlCalculationAutomatic\n   Worksheets(\"Dest\").Select\n   Range(\"A3\").Select\n   MsgBox (\"Import done\")\n\n   'Set resource free\n\n    Set wkb = Nothing\n\n    Windows(fichier1).Activate\n        ActiveWorkbook.Close\n\nTheEnd:\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["html", "arrays", "vba", "excel", "html-table"], "comments": [{"owner": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "edited": false, "score": 0, "creation_date": 1516190497, "post_id": 48300422, "comment_id": 83585741, "body": "Did you check the values of <code>LBound(htmlArr, 1)</code> and <code>UBound(htmlArr, 1)</code>?"}, {"owner": {"reputation": 594, "user_id": 1126927, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/d6701ce88607ae792d291de20eabf78b?s=128&d=identicon&r=PG", "display_name": "Brownish Monster", "link": "https://stackoverflow.com/users/1126927/brownish-monster"}, "edited": false, "score": 1, "creation_date": 1516190552, "post_id": 48300422, "comment_id": 83585779, "body": "Get the element inside the <code>j</code>-loop but outside of the <code>k</code>-loop: <code>set objTr = oHTML.getElementsByTagName(&quot;tr&quot;)(j)</code>. Then put a breakpoint after this line and add <code>objTr</code> to the watchlist. Also check what the values of <code>eleColtr.Length</code> and <code>numberofColumns.Length</code>. Ideally, edit your question and tell us what they are."}, {"owner": {"reputation": 65, "user_id": 8789944, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/faae290b580455156f8f50c401ca651b?s=128&d=identicon&r=PG&f=1", "display_name": "Izzy888", "link": "https://stackoverflow.com/users/8789944/izzy888"}, "edited": false, "score": 0, "creation_date": 1516197089, "post_id": 48300422, "comment_id": 83590046, "body": "Hi, I added the objTr variable and found out it has 22 items as opposed to 23 so having the number of columns not matching was causing the error!"}, {"owner": {"reputation": 65, "user_id": 8789944, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/faae290b580455156f8f50c401ca651b?s=128&d=identicon&r=PG&f=1", "display_name": "Izzy888", "link": "https://stackoverflow.com/users/8789944/izzy888"}, "edited": false, "score": 0, "creation_date": 1516197100, "post_id": 48300422, "comment_id": 83590055, "body": "All sorted now - thanks for your help"}, {"owner": {"reputation": 594, "user_id": 1126927, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/d6701ce88607ae792d291de20eabf78b?s=128&d=identicon&r=PG", "display_name": "Brownish Monster", "link": "https://stackoverflow.com/users/1126927/brownish-monster"}, "edited": false, "score": 0, "creation_date": 1516201208, "post_id": 48300422, "comment_id": 83592801, "body": "@Izzy888 You&#39;re welcome. You may want to add an answer to your question then accept it, once you can."}], "answers": [{"tags": [], "owner": {"reputation": 65, "user_id": 8789944, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/faae290b580455156f8f50c401ca651b?s=128&d=identicon&r=PG&f=1", "display_name": "Izzy888", "link": "https://stackoverflow.com/users/8789944/izzy888"}, "is_accepted": false, "score": 0, "last_activity_date": 1516317056, "creation_date": 1516317056, "answer_id": 48331804, "question_id": 48300422, "link": "https://stackoverflow.com/questions/48300422/populate-a-2-d-array-with-data-from-a-table-in-vba/48331804#48331804", "title": "Populate a 2-D array with data from a table in VBA", "body": "<p>The lengths of the array dimensions I was using didn't match the table which caused the array not to populate</p>\n"}], "owner": {"reputation": 65, "user_id": 8789944, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/faae290b580455156f8f50c401ca651b?s=128&d=identicon&r=PG&f=1", "display_name": "Izzy888", "link": "https://stackoverflow.com/users/8789944/izzy888"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 596, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1516317056, "creation_date": 1516189636, "last_edit_date": 1516196680, "question_id": 48300422, "link": "https://stackoverflow.com/questions/48300422/populate-a-2-d-array-with-data-from-a-table-in-vba", "title": "Populate a 2-D array with data from a table in VBA", "body": "<p>I am trying to write data from a html table into a 2-D array, \"htmlArr\", I have created in VBA. I can get it to populate the first row of data (with all the correct column entries going across) using 2 for loops however the code breaks down after this and will not move to the next j to write the data in the second row.</p>\n\n<p>Here is the part of my VBA code to populate the array:</p>\n\n<p>eleColtr.Length = 11 &amp; numberofColumns.length = 23</p>\n\n<pre><code>ReDim htmlArr(0 To (eleColtr.Length - 1), 0 To (numberofColumns.Length - 1)) 'set array dimensions 11 rows by 23 columns\n    For j = LBound(htmlArr, 1) To UBound(htmlArr, 1)  'loop through rows dim 0 - 10 (html table indexes)\n            Set ObjTr = oHTML.getElementsByTagName(\"tr\")(j)\n            For k = LBound(htmlArr, 2) To UBound(htmlArr, 2) 'loop over cols 0 - 22 (html table indexes)\n\n            htmlArr(j, k) = ObjTr.getElementsByTagName(\"td\")(k).innerText\n\n            Next k\n    Next j\n</code></pre>\n\n<p>Can anyone see where I've gone wrong and how I can fix this?</p>\n\n<p>I have tried to add a counter but I am not sure where it would go</p>\n\n<p>Thanks for your help</p>\n"}, {"tags": ["excel", "vba", "combobox"], "answers": [{"tags": [], "owner": {"reputation": 377, "user_id": 8249645, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/83ce2465fde8b4c0779205788997b91f?s=128&d=identicon&r=PG", "display_name": "sporc", "link": "https://stackoverflow.com/users/8249645/sporc"}, "is_accepted": false, "score": 0, "last_activity_date": 1516190404, "creation_date": 1516190404, "answer_id": 48300677, "question_id": 48300210, "link": "https://stackoverflow.com/questions/48300210/combobox-load-the-worksheet-names-into-dropdown-list/48300677#48300677", "title": "ComboBox load the Worksheet names into Dropdown List", "body": "<p>The problem is that you add items through the Event 'Change'. If there is no change in the combobox (because there aren't any items) this event never fires.</p>\n\n<p>Instead you can add your code to the Initialize or Activate Event of your Form. For example:</p>\n\n<pre><code>Private Sub UserForm_Activate()\n    Dim WS As Worksheet\n    For Each WS In Worksheets\n        ComboBox1.AddItem (WS.Name)\n    Next WS\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 25, "user_id": 12855670, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/519db4fafea4c872ea9e5ddd6e9fcb85?s=128&d=identicon&r=PG&f=1", "display_name": "jomen40544jmail7.com", "link": "https://stackoverflow.com/users/12855670/jomen40544jmail7-com"}, "is_accepted": false, "score": 0, "last_activity_date": 1581229396, "last_edit_date": 1581229396, "creation_date": 1581229065, "answer_id": 60134004, "question_id": 48300210, "link": "https://stackoverflow.com/questions/48300210/combobox-load-the-worksheet-names-into-dropdown-list/60134004#60134004", "title": "ComboBox load the Worksheet names into Dropdown List", "body": "<p>This will proper result </p>\n\n<pre><code>Private Sub UserForm_Initialize()   \n    Dim ws As Worksheet\n    For Each ws In Worksheets\n    If ws.Name &lt;&gt; \"Main\" Then\n    Me.ComboBoxpgname.AddItem ws.Name\n    End If\n    Next ws    \nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 9194376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/433dd580421a2979a2d50eef515d0141?s=128&d=identicon&r=PG&f=1", "display_name": "Moe", "link": "https://stackoverflow.com/users/9194376/moe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 802, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1581229396, "creation_date": 1516188945, "last_edit_date": 1516189694, "question_id": 48300210, "link": "https://stackoverflow.com/questions/48300210/combobox-load-the-worksheet-names-into-dropdown-list", "title": "ComboBox load the Worksheet names into Dropdown List", "body": "<p>I cannot seem to get a combobox to work. I'm trying to add a dropdown combobox that displays all worksheets in my workbook.\nMy first step was to create a combobox which adds the sheets but the box does not add any sheetnames</p>\n\n<p>Here is my code:</p>\n\n<pre><code>Sub ComboBox1_Change()\n\nDim WS As Worksheet\nFor Each WS In Worksheets\nComboBox1.AddItem (WS.Name)\nNext WS\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "activex"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 9229219, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155193289777423/picture?type=large", "display_name": "Jon Elder", "link": "https://stackoverflow.com/users/9229219/jon-elder"}, "edited": false, "score": 0, "creation_date": 1516189050, "post_id": 48300206, "comment_id": 83584760, "body": "Thanks. Tried that too. I get the &#39;error 438&#39;, object doesn&#39;t support this property or method."}, {"owner": {"reputation": 1, "user_id": 9229219, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155193289777423/picture?type=large", "display_name": "Jon Elder", "link": "https://stackoverflow.com/users/9229219/jon-elder"}, "edited": false, "score": 0, "creation_date": 1516202617, "post_id": 48300206, "comment_id": 83593834, "body": "I&#39;ve now changed the command button to a shape. I can only get this working through the debugger. See code above. No error received now but just doesn&#39;t run on option button change."}], "tags": [], "owner": {"reputation": 3623, "user_id": 491557, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3c20e970d3e909fa67a7809965c4936?s=128&d=identicon&r=PG", "display_name": "Spangen", "link": "https://stackoverflow.com/users/491557/spangen"}, "is_accepted": false, "score": 0, "last_activity_date": 1516188939, "creation_date": 1516188939, "answer_id": 48300206, "question_id": 48300142, "link": "https://stackoverflow.com/questions/48300142/vba-advice-needed/48300206#48300206", "title": "VBA Advice needed", "body": "<p>If you want the button to disappear completely, use its visible property:</p>\n\n<pre><code>Sub OptionButton78_Click()\n  If Sheets(\"New Req\").OptionButton78.Value = True Then\n    Sheets(\"New Req\").CommandButton65.Visible = True\n  Else\n    Sheets(\"New Req\").CommandButton65.Visible = False\n  End If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 9229219, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155193289777423/picture?type=large", "display_name": "Jon Elder", "link": "https://stackoverflow.com/users/9229219/jon-elder"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 32, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1516202557, "creation_date": 1516188754, "last_edit_date": 1516202557, "question_id": 48300142, "link": "https://stackoverflow.com/questions/48300142/vba-advice-needed", "title": "VBA Advice needed", "body": "<p>I have a requirement to hide a command button based on the user selecting an option button.\nI have two Option buttons on my excel worksheet, One for 'Yes' and one for 'no'. If yes is selected then the command button that submits the worksheet to an email should be visible, if no is selected the command button should be invisible.\nHere's what I have, but it's not working:</p>\n\n<pre><code>Sub OptionButton78_Click()\nIf Sheets(\"New Req\").OptionButton78.Value = True Then\nSheets(\"New Req\").CommandButton65.Enabled = True\nElse\nSheets(\"New Req\").CommandButton65.Enabled = False\nEnd If\nEnd Sub\n</code></pre>\n\n<p>New Line of Code</p>\n\n<pre><code>Sub OptionButton78_Change()\n    If OptionButton78 = True Then\n        OptionButton79 = False\n    Else\n        OptionButton78 = True\n    End If\nEnd Sub\n\nSub Worksheet_Change()\n     If ThisWorkbook.Sheets(\"New Req\").Range(\"V1\").Value = 2 Then\n          ThisWorkbook.Sheets(\"New Req\").Shapes(\"Rounded Rectangle 2\").Visible = False\n          Else\n          ThisWorkbook.Sheets(\"New Req\").Shapes(\"Rounded Rectangle 2\").Visible = True\n     End If\nEnd Sub\n</code></pre>\n"}, {"tags": ["javascript", "html", "vba", "excel", "web-scraping"], "comments": [{"owner": {"reputation": 145, "user_id": 8938363, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc77aca8ca2e6eabaaff2e84e8fa3dcb?s=128&d=identicon&r=PG&f=1", "display_name": "dadler", "link": "https://stackoverflow.com/users/8938363/dadler"}, "edited": false, "score": 0, "creation_date": 1516188911, "post_id": 48299735, "comment_id": 83584677, "body": "I know that IE handles <code>.execScript</code> well. Have you tried opening it through a hidden IE window and then executing your script?"}, {"owner": {"reputation": 19801, "user_id": 9189799, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/U2hEg.jpg?s=128&g=1", "display_name": "SIM", "link": "https://stackoverflow.com/users/9189799/sim"}, "edited": false, "score": 0, "creation_date": 1516190009, "post_id": 48299735, "comment_id": 83585414, "body": "Have you tried to get the text within class <code>xls-link</code>? <code>onclick</code> is also available within that class. However, what I wanna say is <code>xmlhttp60</code> request won&#39;t be able to fetch you anything from that page because it can&#39;t even parse the text within that class. The content of that website is generated dynamically. You should go for IE."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1516191927, "post_id": 48299735, "comment_id": 83586662, "body": "I will try with IE. I was deliberately avoiding because it is slow."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 19801, "user_id": 9189799, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/U2hEg.jpg?s=128&g=1", "display_name": "SIM", "link": "https://stackoverflow.com/users/9189799/sim"}, "edited": false, "score": 0, "creation_date": 1516193256, "post_id": 48299735, "comment_id": 83587478, "body": "@Shahin As an aside, when I tried getting by className using &quot;xls-link&quot; nothing was returned. Is this  to do with .OuterHTML versus .Inner ?"}, {"owner": {"reputation": 158803, "user_id": 246342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8ba0aea3f521082f18dd7c186e7d4c3?s=128&d=identicon&r=PG", "display_name": "Alex K.", "link": "https://stackoverflow.com/users/246342/alex-k"}, "edited": false, "score": 0, "creation_date": 1516193287, "post_id": 48299735, "comment_id": 83587501, "body": "That ga() is just a call to google analytics, it wont affect the download, do you really need to invoke it?"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 158803, "user_id": 246342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8ba0aea3f521082f18dd7c186e7d4c3?s=128&d=identicon&r=PG", "display_name": "Alex K.", "link": "https://stackoverflow.com/users/246342/alex-k"}, "edited": false, "score": 0, "creation_date": 1516194108, "post_id": 48299735, "comment_id": 83588068, "body": "@Alex K I don&#39;t have to. In effect then, if i executed the function would I simply be sending (tracking?) data then?"}, {"owner": {"reputation": 158803, "user_id": 246342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8ba0aea3f521082f18dd7c186e7d4c3?s=128&d=identicon&r=PG", "display_name": "Alex K.", "link": "https://stackoverflow.com/users/246342/alex-k"}, "edited": false, "score": 0, "creation_date": 1516194163, "post_id": 48299735, "comment_id": 83588104, "body": "Yes that&#39;s what GA does."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1516194843, "post_id": 48299735, "comment_id": 83588497, "body": "I will edit this question so it will be of use to others."}, {"owner": {"reputation": 19801, "user_id": 9189799, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/U2hEg.jpg?s=128&g=1", "display_name": "SIM", "link": "https://stackoverflow.com/users/9189799/sim"}, "edited": false, "score": 0, "creation_date": 1516258561, "post_id": 48299735, "comment_id": 83616215, "body": "My only intention was to get your problem resolved and I&#39;m happy you are there. Thanks."}], "answers": [{"tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": true, "score": 0, "last_activity_date": 1531426966, "creation_date": 1531426966, "answer_id": 51313859, "question_id": 48299735, "link": "https://stackoverflow.com/questions/48299735/downloading-files-executing-a-javascript-function-using-execscript-vba/51313859#51313859", "title": "Downloading files; Executing a JavaScript function using .execScript VBA", "body": "<p>So I ended up using a CSS selector to get all the hrefs for the downloads and passing them to URLMon for download. As there is a two month lag for latest files I filtered files to download on those 2 months behind month.</p>\n\n<hr>\n\n<p><strong>CSS selector:</strong></p>\n\n<p>The selector I chose was <code>#main-content a[href*=xls]</code></p>\n\n<p>This looked for elements with elements with <code>a</code> tags, having attribute <code>href</code> containing the string <code>\"xls\"</code>, inside of element with id of <code>main=content</code>.</p>\n\n<hr>\n\n<p><strong>Sample CSS query results:</strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/YqXUT.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/YqXUT.png\" alt=\"query results\"></a></p>\n\n<hr>\n\n<p><strong>VBA:</strong></p>\n\n<pre><code>Option Explicit\nPrivate Declare PtrSafe Function URLDownloadToFile Lib \"urlmon\" _\nAlias \"URLDownloadToFileA\" ( _\nByVal pCaller As LongPtr, _\nByVal szURL As String, _\nByVal szFileName As String, _\nByVal dwReserved As LongPtr, _\nByVal lpfnCB As LongPtr _\n) As Long\nPrivate Declare PtrSafe Function DeleteUrlCacheEntry Lib \"Wininet.dll\" _\nAlias \"DeleteUrlCacheEntryA\" ( _\nByVal lpszUrlName As String _\n) As Long\n\nPublic Const BINDF_GETNEWESTVERSION As Long = &amp;H10\n\nPublic Sub DownloadFiles()\n    Dim http As New XMLHTTP60, html As New HTMLDocument, downloads As Collection\n    With http\n        .Open \"GET\", \"https://www.england.nhs.uk/statistics/statistical-work-areas/delayed-transfers-of-care/statistical-work-areas-delayed-transfers-of-care-delayed-transfers-of-care-data-2018-19/\", False\n        .send\n        html.body.innerHTML = .responseText\n    End With\n\n    Dim aNodeList As Object, i As Long\n    Set downloads = New Collection\n    Set aNodeList = html.querySelectorAll(\"#main-content a[href*=xls]\")\n    For i = 0 To aNodeList.Length - 1\n        downloads.Add aNodeList.item(i).getAttribute(\"href\")\n    Next i\n\n    For i = 1 To downloads.Count\n        If InStr(downloads(i), Format(DateAdd(\"m\", -2, Date), \"mmmm-yyyy\")) &gt; 0 Then\n            Debug.Print downloads(i)\n            downloadFile downloads(i)\n        End If\n    Next i\nEnd Sub\n\nPublic Sub downloadFile(ByVal url As String)\n    Dim ret As Long, arr() As String, outputPath As String\n    arr = Split(url, Chr$(47))\n    outputPath = \"C:\\Users\\HarrisQ\\Desktop\\\" &amp; arr(UBound(arr))\n    ret = URLDownloadToFile(0, url, outputPath, BINDF_GETNEWESTVERSION, 0)\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p><strong>References:</strong></p>\n\n<p>Requires references for HTML Object Library and Microsoft XML.</p>\n\n<hr>\n\n<p><strong>API call:</strong></p>\n\n<p>Written for 64 bit</p>\n"}], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 935, "favorite_count": 0, "accepted_answer_id": 51313859, "answer_count": 1, "score": 2, "last_activity_date": 1531427033, "creation_date": 1516187516, "last_edit_date": 1531427033, "question_id": 48299735, "link": "https://stackoverflow.com/questions/48299735/downloading-files-executing-a-javascript-function-using-execscript-vba", "title": "Downloading files; Executing a JavaScript function using .execScript VBA", "body": "<p><strong>Situation:</strong> </p>\n\n<p>I am downloading files from the webpage <a href=\"https://www.england.nhs.uk/statistics/statistical-work-areas/delayed-transfers-of-care/delayed-transfers-of-care-data-2017-18/\" rel=\"nofollow noreferrer\">NHS Delayed Transfers of Care</a>. </p>\n\n<p>In the HTML I can see the following:</p>\n\n<pre><code>onclick=\"ga('send', 'event', 'Downloads', 'XLS', 'https://www.england.nhs.uk/statistics/wp-content/uploads/sites/2/2018/01/LA-Type-B-November-2017-2ayZP.xls');\"\n</code></pre>\n\n<p>After looking <a href=\"https://developers.google.com/analytics/devguides/collection/analyticsjs/command-queue-reference\" rel=\"nofollow noreferrer\">here</a> and seeing these SO questions (amongst others): </p>\n\n<ul>\n<li><a href=\"https://stackoverflow.com/questions/3247391/click-button-or-execute-javascript-function-with-vba\">Click button or execute JavaScript function with VBA</a></li>\n<li><a href=\"https://stackoverflow.com/questions/31521205/how-to-find-and-call-javascript-method-from-vba\">How to find and call javascript method from vba</a></li>\n<li><a href=\"http://www.vbaexpress.com/forum/showthread.php?9690-Solved-call-a-javascript-function\" rel=\"nofollow noreferrer\">Call a javascript function</a></li>\n</ul>\n\n<p>I am under the impression that <code>ga()</code> is a JavaScript function I should be able to call directly with <code>.execScript</code>.</p>\n\n<p><strong>Question:</strong></p>\n\n<p>Can I execute the JavaScript function using <code>.execScript</code> to download the file? If not, how can I download the file(s)?</p>\n\n<p><strong>What I have tried:</strong></p>\n\n<p>I have tried the following unsuccessfully:</p>\n\n<p>1) <code>Call html.parentWindow.execScript(\"ga('send', 'event', 'Downloads', 'XLS', 'https://www.england.nhs.uk/statistics/wp-content/uploads/sites/2/2018/01/LA-Type-B-November-2017-2ayZP.xls');\", \"Javascript\")</code></p>\n\n<blockquote>\n  <p>'-2147352319   Automation error</p>\n</blockquote>\n\n<hr>\n\n<p>2) <code>Call html.frames(0).execScript(\"ga('send', 'event', 'Downloads', 'XLS', 'https://www.england.nhs.uk/statistics/wp-content/uploads/sites/2/2018/01/LA-Type-B-November-2017-2ayZP.xls');\", \"Javascript\")</code> </p>\n\n<blockquote>\n  <p>Error 438 Object doesn't support this property or method</p>\n</blockquote>\n\n<hr>\n\n<p>3) <code>Call currentWindow.execScript(\"ga('send', 'event', 'Downloads', 'XLS', 'https://www.england.nhs.uk/statistics/wp-content/uploads/sites/2/2018/01/LA-Type-B-November-2017-2ayZP.xls');\", \"Javascript\")</code> </p>\n\n<blockquote>\n  <p>Error 91 Object variable or With block variable not set</p>\n</blockquote>\n\n<hr>\n\n<p>4) <code>Call CurrentWindow.execScript(\"ga('send', 'event', 'Downloads', 'XLS', 'https://www.england.nhs.uk/statistics/wp-content/uploads/sites/2/2018/01/LA-Type-B-November-2017-2ayZP.xls');\", \"Javascript\")</code> </p>\n\n<blockquote>\n  <p>-2147352319  Could not complete the operation due to error 80020101.</p>\n</blockquote>\n\n<p>I will admit to very little knowledge of these sorts of operations. Can anyone see where I am going wrong please?</p>\n\n<p><strong>Code:</strong></p>\n\n<pre><code>Option Explicit\n\nPublic Sub DownloadDTOC()\n\n    Dim http As New XMLHTTP60\n    Dim html As New HTMLDocument\n    Dim CurrentWindow As HTMLWindowProxy\n\n    With http\n        .Open \"GET\", \"https://www.england.nhs.uk/statistics/statistical-work-areas/delayed-transfers-of-care/delayed-transfers-of-care-data-2017-18/\", False\n        .send\n        html.body.innerHTML = .responseText\n    End With\n\n    On Error GoTo Errhand\n\n    'Call html.parentWindow.execScript(\"ga('send', 'event', 'Downloads', 'XLS', 'https://www.england.nhs.uk/statistics/wp-content/uploads/sites/2/2018/01/LA-Type-B-November-2017-2ayZP.xls');\", \"Javascript\") '-2147352319   Automation error\n\n    'Call html.frames(0).execScript(\"ga('send', 'event', 'Downloads', 'XLS', 'https://www.england.nhs.uk/statistics/wp-content/uploads/sites/2/2018/01/LA-Type-B-November-2017-2ayZP.xls');\", \"Javascript\") '438 Object doesn't support this property or method\n'automation error\n\n    'Call currentWindow.execScript(\"ga('send', 'event', 'Downloads', 'XLS', 'https://www.england.nhs.uk/statistics/wp-content/uploads/sites/2/2018/01/LA-Type-B-November-2017-2ayZP.xls');\", \"Javascript\") ' 91 Object variable or With block variable not set\n\n    Set CurrentWindow = html.parentWindow\n    Call CurrentWindow.execScript(\"ga('send', 'event', 'Downloads', 'XLS', 'https://www.england.nhs.uk/statistics/wp-content/uploads/sites/2/2018/01/LA-Type-B-November-2017-2ayZP.xls');\", \"Javascript\") '--2147352319  Could not complete the operation due to error 80020101.\n\n    Exit Sub\n\nErrhand:\n    If Err.Number &lt;&gt; 0 Then Debug.Print Err.Number, Err.Description\nEnd Sub\n</code></pre>\n\n<p><strong>References added:</strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/Ax0k6.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Ax0k6.png\" alt=\"References in project\"></a></p>\n\n<p>Here is a reduced version of the HTML. Apologies, I am not used to formatting HTML.</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>&lt;p&gt;\r\n  &lt;a href=\"https://www.england.nhs.uk/statistics/wp-content/uploads/sites/2/2018/01/LA-Type-B-November-2017-2ayZP.xls\" class=\"xls-link\" onclick=\"ga('send', 'event', 'Downloads', 'XLS', 'https://www.england.nhs.uk/statistics/wp-content/uploads/sites/2/2018/01/LA-Type-B-November-2017-2ayZP.xls');\"&gt;Total Delayed Days Local Authority 2017-18 November (XLS, 121KB)&lt;/a&gt;\r\n  &lt;br&gt;\r\n&lt;/p&gt;</code></pre>\r\n</div>\r\n</div>\r\n</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 824, "user_id": 6722034, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/70472b94b95a084f55551520030f88fb?s=128&d=identicon&r=PG&f=1", "display_name": "Arul", "link": "https://stackoverflow.com/users/6722034/arul"}, "is_accepted": true, "score": 1, "last_activity_date": 1516188317, "creation_date": 1516188317, "answer_id": 48299986, "question_id": 48299666, "link": "https://stackoverflow.com/questions/48299666/using-specialcells/48299986#48299986", "title": "Using .SpecialCells", "body": "<p>One way to overcome the issue is to add <code>ErrorHandler</code> like the one below:</p>\n\n<pre><code>Sub DivByZero()\nOn Error GoTo ErrHandler:\nDim rng As Range\nSet rng = ActiveSheet.Cells.SpecialCells(xlCellTypeFormulas, xlErrors)\n\nFor Each rCell In rng\n    If rCell.Value = CVErr(xlErrDiv0) Then\n        rCell.Value = 0\n    End If\nNext\n\nErrHandler:\nIf Err.Number = 1004 Then\n    Exit Sub\nEnd If\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 293, "user_id": 9057518, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/067764a3e2e917197a58401710c76654?s=128&d=identicon&r=PG&f=1", "display_name": "CptGoodar", "link": "https://stackoverflow.com/users/9057518/cptgoodar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 24, "favorite_count": 0, "accepted_answer_id": 48299986, "answer_count": 1, "score": -1, "last_activity_date": 1516198256, "creation_date": 1516187337, "last_edit_date": 1516198256, "question_id": 48299666, "link": "https://stackoverflow.com/questions/48299666/using-specialcells", "title": "Using .SpecialCells", "body": "<p>I have a line of code that converts any cells contain #DIV/O error with 0. Which is idealy, apart from when there is no #DIV/o error found in range. When this is that case i get a run time error informing me that there is none found and then I can't move past this. </p>\n\n<p>Is there a way to pass over this issue? </p>\n\n<p>The code goes as follows </p>\n\n<pre><code>Set rng = ActiveSheet.Cells.SpecialCells(xlCellTypeFormulas, xlErrors)\n\n          For Each rCell In rng\n          If rCell.Value = CVErr(xlErrDiv0) Then\n          rCell.Value = 0\n          End If\n          Next\n</code></pre>\n\n<p>I have tried to play around using <code>NullString</code> &amp; <code>For loops</code> but to no avail. </p>\n\n<p>Any help would be  greatful. </p>\n"}, {"tags": ["arrays", "vba", "sum", "elements", "non-repetitive"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1516479551, "post_id": 48299360, "comment_id": 83708080, "body": "i think you mean n*2 becomes m * 2 (or some other letter) to indicate first dimension actually can change in size?"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1516480295, "post_id": 48299360, "comment_id": 83708318, "body": "See here for retrieving key and values from dict <a href=\"https://stackoverflow.com/questions/21432222/can-i-loop-through-key-value-pairs-in-a-vba-collection/21433046\" title=\"can i loop through key value pairs in a vba collection\">stackoverflow.com/questions/21432222/&hellip;</a>. Note that there are limitations on size that can be tranposed."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1516481469, "post_id": 48299360, "comment_id": 83708657, "body": "create your second array with the same dimensions as the first, loop the first array adding to a dictionary e.g. banana , 1 (if exists add  to the value associated with the key i.e. current value+ new value). Transpose the array so 2nd dim becomes 1st. Then redim the second array&#39;s second dimension to the count of the dict keys, re-transpose the array, then loop the dictionary emptying into the array.  \t See here for retrieving key and values from dict stackoverflow.com/questions/21432222/\u2026. Note that there are limitations on size that can be tranposed."}, {"owner": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "edited": false, "score": 0, "creation_date": 1516486245, "post_id": 48299360, "comment_id": 83709961, "body": "easier alternative might be to consolidate them <a href=\"http://www.excel-easy.com/examples/consolidate.html\" rel=\"nofollow noreferrer\">excel-easy.com/examples/consolidate.html</a>"}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 7181718, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/dd2edd1041f7793d5b102829297d7d67?s=128&d=identicon&r=PG&f=1", "display_name": "user7181718", "link": "https://stackoverflow.com/users/7181718/user7181718"}, "edited": false, "score": 0, "creation_date": 1516697346, "post_id": 48361534, "comment_id": 83782623, "body": "code returns error9-subscript out of range. for example when:  msgbox arr2(x,y).    moreover it seems that we may replace arr with arr1 in populating second column."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 11, "user_id": 7181718, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/dd2edd1041f7793d5b102829297d7d67?s=128&d=identicon&r=PG&f=1", "display_name": "user7181718", "link": "https://stackoverflow.com/users/7181718/user7181718"}, "edited": false, "score": 0, "creation_date": 1516698072, "post_id": 48361534, "comment_id": 83783066, "body": "I made a typo at the start. Can you check now? If not, can you make a <a href=\"https://pastebin.com/\" rel=\"nofollow noreferrer\">pastebin</a> so i can see where the error in your version is as works here. I had just missed the 1 off arr1 when typing the assignments."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 11, "user_id": 7181718, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/dd2edd1041f7793d5b102829297d7d67?s=128&d=identicon&r=PG&f=1", "display_name": "user7181718", "link": "https://stackoverflow.com/users/7181718/user7181718"}, "edited": false, "score": 0, "creation_date": 1516705547, "post_id": 48361534, "comment_id": 83788130, "body": "the transpose shifts the start to 1 rather than 0. If you put STOP before the Msgbox, run the code and then look at arr2 in the locals window you will see the change. The start value becomes arr2(1,1). Apologies, I should have mentioned this."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 11, "user_id": 7181718, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/dd2edd1041f7793d5b102829297d7d67?s=128&d=identicon&r=PG&f=1", "display_name": "user7181718", "link": "https://stackoverflow.com/users/7181718/user7181718"}, "edited": false, "score": 0, "creation_date": 1516705731, "post_id": 48361534, "comment_id": 83788275, "body": "You could simply put ReDim arr2(1 to 2, 1 to FruitDict.Count ) but you would still need to access from (1,1)"}, {"owner": {"reputation": 11, "user_id": 7181718, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/dd2edd1041f7793d5b102829297d7d67?s=128&d=identicon&r=PG&f=1", "display_name": "user7181718", "link": "https://stackoverflow.com/users/7181718/user7181718"}, "edited": false, "score": 0, "creation_date": 1516707651, "post_id": 48361534, "comment_id": 83789584, "body": "thank you QHarr! it works. i think first redim line is omissible."}, {"owner": {"reputation": 11, "user_id": 7181718, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/dd2edd1041f7793d5b102829297d7d67?s=128&d=identicon&r=PG&f=1", "display_name": "user7181718", "link": "https://stackoverflow.com/users/7181718/user7181718"}, "edited": false, "score": 0, "creation_date": 1516707804, "post_id": 48361534, "comment_id": 83789689, "body": "is it possible to programmatically transpose an array?"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 11, "user_id": 7181718, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/dd2edd1041f7793d5b102829297d7d67?s=128&d=identicon&r=PG&f=1", "display_name": "user7181718", "link": "https://stackoverflow.com/users/7181718/user7181718"}, "edited": false, "score": 0, "creation_date": 1516708142, "post_id": 48361534, "comment_id": 83789898, "body": "See here: <a href=\"https://stackoverflow.com/questions/20055784/best-workaround-for-vba-transpose-array-length-limit\" title=\"best workaround for vba transpose array length limit\">stackoverflow.com/questions/20055784/&hellip;</a>"}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": false, "score": 0, "last_activity_date": 1516707861, "last_edit_date": 1516707861, "creation_date": 1516485721, "answer_id": 48361534, "question_id": 48299360, "link": "https://stackoverflow.com/questions/48299360/converting-112-array-based-on-unique-values-and-value-assignment/48361534#48361534", "title": "converting 11*2 array based on unique values and value assignment", "body": "<p>Here is an example of what I was describing. </p>\n\n<p>Loop the first array and add the fruit and the value to a dictionary. This will ensure unique fruit names, as used as key, and the values can be added by simply adding to the existing value, if the key (fruit) already exists in the dictionary, or adding in the normal fashion otherwise. </p>\n\n<p>Transpose the array to allow for swopping the dimensions around (as you can only resize the second dimension. There is a restriction on how many items this can be performed with using Transpose).</p>\n\n<p>You should really separate this out into separate function/procedures calls, for example, adding items to a dictionary could be its own function. The retrieval of the dictionary key and value is as per <a href=\"https://stackoverflow.com/questions/21432222/can-i-loop-through-key-value-pairs-in-a-vba-collection\">@Peter Albert</a>.</p>\n\n<pre><code>Option Explicit\n\nSub Test()\n\nDim arr1(0 to 5, 0 to 1)\nDim arr2()\n\narr1(0,0) = \"Banana\"\narr1(1,0) = \"Banana\"\narr1(2,0) = \"Apple\"\narr1(3,0) = \"Banana\"\narr1(4,0) = \"Orange\"\narr1(5,0) = \"Orange\"\n\narr1(0,1) = 1\narr1(1,1) = 2\narr1(2,1) = 3\narr1(3,1) = 4\narr1(4,1) = 5\narr1(5,1) = 6\n\nDim fruitDict As New Scripting.Dictionary 'required reference to MS Scripting Runtime\n\nDim i as Long\n\nFor i = LBound(arr1,1) to UBound(arr1,1)\n\n    If fruitDict.Exists(arr1(i,0)) Then\n\n        fruitDict(arr1(i,0)) = fruitDict(arr1(i,0)) + arr1(i,1)\n\n    Else\n\n       fruitDict.Add arr1(i,0) , arr1(i,1)\n\n    End If\n\nNext i\n\nReDim arr2(0 to 1, 0 to FruitDict.Count - 1)\n\narr2 = Application.WorksheetFunction.Transpose(arr2)\n\nDim key As Variant\nDim counter As Long\ncounter = 1\n\nFor Each key in fruitDict.Keys\n\n    arr2(counter,1) = key\n    arr2(counter,2) = fruitDict(key)\n    counter = counter + 1\n\nNext key\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 7181718, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/dd2edd1041f7793d5b102829297d7d67?s=128&d=identicon&r=PG&f=1", "display_name": "user7181718", "link": "https://stackoverflow.com/users/7181718/user7181718"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 47, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1516707861, "creation_date": 1516186476, "last_edit_date": 1516471436, "question_id": 48299360, "link": "https://stackoverflow.com/questions/48299360/converting-112-array-based-on-unique-values-and-value-assignment", "title": "converting 11*2 array based on unique values and value assignment", "body": "<p>I need a function that takes a n*2 input array and produces n*2 output array that its first column elements are unique values from the first column of input array and second column elements are summations of numbers correspondent to each of these unique values.  </p>\n\n<pre><code>Sub test()\nDim arm(11, 1) As Variant\nDim tempar() As Variant\nReDim tempar(0 To UBound(arm, 1), 0 To UBound(arm, 2)) As Variant\n\narm(0, 0) = \"banana\"\narm(1, 0) = \"banana\"\narm(2, 0) = \"banana\"\narm(3, 0) = \"apple\"\narm(4, 0) = \"apple\"\narm(5, 0) = \"banana\"\narm(6, 0) = \"cucumber\"\narm(7, 0) = \"cucumber\"\narm(8, 0) = \"cucumber\"\narm(9, 0) = \"apple\"\narm(10, 0) = \"cucumber\"\narm(11, 0) = \"a\"\n\narm(0, 1) = 5\narm(1, 1) = 4\narm(2, 1) = 3\narm(3, 1) = 2\narm(4, 1) = 5\narm(5, 1) = 3\narm(6, 1) = 2\narm(7, 1) = 4\narm(8, 1) = 5\narm(9, 1) = 1\narm(10, 1) = 1\narm(11, 1) = 3\n\ntempar() = unqfiladv(arm)\n\nEnd Sub  \n</code></pre>\n\n<p>resulte array must be :  </p>\n\n<blockquote>\n  <p>banana    15<br>\n  apple    8<br>\n  cucumber    12<br>\n  a    3  </p>\n</blockquote>\n"}, {"tags": ["vba", "excel", "excel-formula"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1516188040, "post_id": 48299342, "comment_id": 83584152, "body": "Users would need to have the same version of Excel for your specification to have a chance of working. Is that what you intended? You may also need to give consideration to removing missing references."}, {"owner": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "edited": false, "score": 0, "creation_date": 1516191040, "post_id": 48299342, "comment_id": 83586107, "body": "In order to add a reference you must have access to the VBA project which MS has long taught users not to allow, for good reasons. Therefore, even if you write code to install the reference the code won&#39;t run unless the user has granted access to VBA projects on his PC which is unlikely and not recommended."}, {"owner": {"reputation": 543, "user_id": 3631482, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/K2wBD.jpg?s=128&g=1", "display_name": "Jeanjean", "link": "https://stackoverflow.com/users/3631482/jeanjean"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1516202274, "post_id": 48299342, "comment_id": 83593580, "body": "@QHarr they do have the same version. What if not? What do you mean by removing missing references and what do I need to know about this, please?"}, {"owner": {"reputation": 543, "user_id": 3631482, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/K2wBD.jpg?s=128&g=1", "display_name": "Jeanjean", "link": "https://stackoverflow.com/users/3631482/jeanjean"}, "reply_to_user": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "edited": false, "score": 0, "creation_date": 1516202285, "post_id": 48299342, "comment_id": 83593592, "body": "@Variatus so what&#39;s your advice, please? Does that mean noboddy uses references? How do Professional programmers do then?"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1516202567, "post_id": 48299342, "comment_id": 83593802, "body": "Use early binding for testing and convert to late binding for release"}, {"owner": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "edited": false, "score": 0, "creation_date": 1516202645, "post_id": 48299342, "comment_id": 83593854, "body": "You need to get users to set the required references themselves. Professional programmers make do with what they find on the machines where their programs run or spit out messages like &quot;Please contact your IT department.&quot;"}], "owner": {"reputation": 543, "user_id": 3631482, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/K2wBD.jpg?s=128&g=1", "display_name": "Jeanjean", "link": "https://stackoverflow.com/users/3631482/jeanjean"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 175, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1516189544, "creation_date": 1516186405, "last_edit_date": 1516189544, "question_id": 48299342, "link": "https://stackoverflow.com/questions/48299342/adding-a-reference-for-any-user", "title": "Adding a reference for any user", "body": "<p>I am struggling with references in my VBA project. In order to use my Drag and Drop function, I need to add the following reference to my workbook: <code>Microsoft Windows Common Controls 6.0 (SP6)</code>. This reference has got the following location : <code>C:\\Windows\\system32\\MSCOMCTL.OCX</code>.</p>\n\n<p>I would like to make sure that for <strong>any user</strong> using <strong>my specific workbook</strong>, the reference won't be missing. I have seen many tutorials about it and could \"easily\" add a reference, but I would like to understand precisely what I am doing and choose the best solution. I have several questions:</p>\n\n<ol>\n<li><p><strong>Late binding, Early Biding, AddFromFile, AddFromGUI</strong></p>\n\n<p>In those two topics (<a href=\"https://stackoverflow.com/questions/40593195/outlook-add-reference-from-file\">1</a> and <a href=\"https://stackoverflow.com/questions/9879825/how-to-add-a-reference-programmatically\">2</a>), I read many things about references. The problem is I really do not know which option fits the best to my particular case.</p>\n\n<ol>\n<li><p>My reference has already been added manually. Should I code something in order to be sure it is not missing when the code runs?</p></li>\n<li><p>About adding a reference : Which option between those four is the best? I am hesitating between <code>AddFromFile</code> and Late Binding.</p></li>\n<li><p>Let's suppose I choose <code>AddFromFile</code> or Late Binding. I cannot manage to <code>Print</code> my reference's name! How do you know that <code>Microsoft VBScript Regular Expressions 5.5</code>'s <code>.Name</code> is <code>VBScript_RegExp_55</code>? I tried the code in <a href=\"https://stackoverflow.com/questions/43137715/finding-the-vbide-reference-name-of-object-libraries-vba\">this topic</a> but it does not work (Must have done something wrong...).</p></li>\n</ol></li>\n<li><p><strong>\"Universal\" Path to my reference</strong></p>\n\n<p>I am very pessimistic and I was wondering: are references always stored at the same location? Let's suppose a user uses my specific workbook and hasn't got the reference it needs for the Drag and Drop function. He/She would need to add <code>MSCOMCTL.OCX</code> from <code>C:\\Windows\\system32\\</code>.</p>\n\n<ol>\n<li><p>Are references always stored at the same location?</p></li>\n<li><p>If not, how can I overcome that? Changing the path to something like the following?</p>\n\n<pre><code>Sub mySub()\n    Dim sRef, sPath As String\n\n    sRef = \"MSCOMCTL.OCX\"\n    sPath = Environ(\"Windir\") &amp; \"\\system32\\\" &amp; sRef\nEnd Sub\n</code></pre></li>\n</ol></li>\n</ol>\n\n<p>Thank you in advance for your answers and sorry if things are crystal clear and already answered in other posts, I may have missed it.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "edited": false, "score": 1, "creation_date": 1516186356, "post_id": 48299064, "comment_id": 83583087, "body": "I think <code>issuerformula</code> is a string? Therefore : <code>.Formula = &quot;=BDP(&quot; &amp; issuerformula &amp; &quot;,&quot;&quot;ISSUER&quot;&quot;)&quot;</code> - i.e. without the <code>.value</code>."}, {"owner": {"reputation": 13, "user_id": 7813390, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/36cb8cb2d1d367a8de779047e0a0b9a6?s=128&d=identicon&r=PG&f=1", "display_name": "JeromeVBA", "link": "https://stackoverflow.com/users/7813390/jeromevba"}, "edited": false, "score": 0, "creation_date": 1516186700, "post_id": 48299064, "comment_id": 83583310, "body": "indeed, but with blanks between &amp; and variable... I attached it in my previous code."}], "answers": [{"tags": [], "owner": {"reputation": 13, "user_id": 7813390, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/36cb8cb2d1d367a8de779047e0a0b9a6?s=128&d=identicon&r=PG&f=1", "display_name": "JeromeVBA", "link": "https://stackoverflow.com/users/7813390/jeromevba"}, "is_accepted": false, "score": 1, "last_activity_date": 1516186868, "last_edit_date": 1516186868, "creation_date": 1516186644, "answer_id": 48299410, "question_id": 48299064, "link": "https://stackoverflow.com/questions/48299064/vba-code-to-reference-letter-and-number-in-excel-formula/48299410#48299410", "title": "vba code to reference letter and number in excel formula", "body": "<p>it's ok I found the answer myself, it was a matter of blank </p>\n\n<p>so, this works...</p>\n\n<pre><code>For loopi = maxlastrow + 3 To lastrowrangetotal\n      issuerformula = Cells(loopi, 4).Address(rowabsolute:=False, columnabsolute:=False)\n      Worksheets(\"Dashboard\").Cells(loopi, 4).Formula = \"=BDP(\" &amp; issuerformula &amp; \",\"\"ISSUER\"\")\"\nNext loopi\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 7813390, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/36cb8cb2d1d367a8de779047e0a0b9a6?s=128&d=identicon&r=PG&f=1", "display_name": "JeromeVBA", "link": "https://stackoverflow.com/users/7813390/jeromevba"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1516186868, "creation_date": 1516185540, "last_edit_date": 1531161705, "question_id": 48299064, "link": "https://stackoverflow.com/questions/48299064/vba-code-to-reference-letter-and-number-in-excel-formula", "title": "vba code to reference letter and number in excel formula", "body": "<p>This is my piece of code:</p>\n\n<pre><code>For loopi = maxlastrow + 3 To lastrowrangetotal\nissuerformula = Cells(loopi, 4).Address(rowabsolute:=False, columnabsolute:=False)\nWorksheets(\"Dashboard\").Cells(loopi, 4).Formula = \"=BDP(\"\"&amp;issuerformula.value&amp;\"\",\"\"ISSUER\"\")\"\nNext loopi\n</code></pre>\n\n<p>this part assign a variable to a cell expressed in \"letter / number\", let's say D35 in this case.</p>\n\n<p>This piece of code manage to transform a cell expressed as cell(2,2) for example into B2 : </p>\n\n<pre><code>issuerformula = Cells(loopi, 4).Address(rowabsolute:=False, columnabsolute:=False)\n</code></pre>\n\n<p>I would like to use this variable to have in my cell the formula <code>\"=BDP(B2,\"ISSUER\")\"</code></p>\n\n<p>However, the way it is coded now returns that : <code>=BDP(\"&amp;issuerformula.value&amp;\",\"ISSUER\")</code></p>\n\n<p>I tried several combinations, removing \".value\", doubling or tripling \"\"\",... no chance for me.</p>\n\n<p>What would be the correct combination to do that in this formula <code>Worksheets(\"Dashboard\").Cells(loopi, 4).Formula = \"=BDP(\"\"&amp;issuerformula.value&amp;\"\",\"\"ISSUER\"\")\"</code></p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 3347, "user_id": 5722505, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e2356a75bc16cc5aae3fce6b5ff1b9e?s=128&d=identicon&r=PG&f=1", "display_name": "Egan Wolf", "link": "https://stackoverflow.com/users/5722505/egan-wolf"}, "edited": false, "score": 1, "creation_date": 1516185292, "post_id": 48298908, "comment_id": 83582355, "body": "Your <code>i</code> doesn&#39;t change in coping loop. Should be <code>numtimes</code> probably."}], "answers": [{"comments": [{"owner": {"reputation": 117, "user_id": 5282448, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/2Uooa.jpg?s=128&g=1", "display_name": "perbrethil", "link": "https://stackoverflow.com/users/5282448/perbrethil"}, "edited": false, "score": 0, "creation_date": 1516186314, "post_id": 48299009, "comment_id": 83583060, "body": "ohw duh, i can&#39;t believe i looked over that. thanks!"}, {"owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "reply_to_user": {"reputation": 117, "user_id": 5282448, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/2Uooa.jpg?s=128&g=1", "display_name": "perbrethil", "link": "https://stackoverflow.com/users/5282448/perbrethil"}, "edited": false, "score": 0, "creation_date": 1516186582, "post_id": 48299009, "comment_id": 83583237, "body": "<code>Option Explicit</code> <i>might</i> have helped you with this one - but as I can&#39;t see all the code I&#39;ve no idea if <code>i</code> was ever declared."}], "tags": [], "owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "is_accepted": true, "score": 3, "last_activity_date": 1516185372, "creation_date": 1516185372, "answer_id": 48299009, "question_id": 48298908, "link": "https://stackoverflow.com/questions/48298908/vba-copy-sheet-and-rename-error/48299009#48299009", "title": "VBA copy sheet and rename error", "body": "<p>You don't appear to be increasing <code>i</code>?</p>\n\n<p>Perhaps you could just use <code>numtimes</code>?</p>\n\n<pre><code>For numtimes = 2 To LastRow\n   ActiveWorkbook.Sheets(\"sheet\").Copy _\n   After:=ActiveWorkbook.Sheets(\"Sheet\")\n   'test voor name copy\n   ActiveSheet.Name = \"Sheet\" &amp; numtimes \nNext\n</code></pre>\n"}], "owner": {"reputation": 117, "user_id": 5282448, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/2Uooa.jpg?s=128&g=1", "display_name": "perbrethil", "link": "https://stackoverflow.com/users/5282448/perbrethil"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 325, "favorite_count": 0, "accepted_answer_id": 48299009, "answer_count": 1, "score": 2, "last_activity_date": 1516185372, "creation_date": 1516185066, "question_id": 48298908, "link": "https://stackoverflow.com/questions/48298908/vba-copy-sheet-and-rename-error", "title": "VBA copy sheet and rename error", "body": "<p>I have a piece of code where i don't see where it goes wrong exactly.\nI have this macro that copies a sheet a certain amount of times and name them \"Sheet\" + number.</p>\n\n<pre><code> 'copies over template to amount of items\n    For numtimes = 2 To LastRow\n    ActiveWorkbook.Sheets(\"sheet\").Copy _\n    After:=ActiveWorkbook.Sheets(\"Sheet\")\n    'test voor name copy\n    ActiveSheet.Name = \"Sheet\" &amp; i\n    Next\n</code></pre>\n\n<p>when i run this it copies the sheet only two times. One named \"Sheet2\"(as it should), but one as \"Sheet (2)\", and an error that the name is already taken.\nI don't really see where it goes wrong, or why it half works.</p>\n"}, {"tags": ["sql", "vba", "insert", "sql-insert"], "comments": [{"owner": {"reputation": 2242, "user_id": 8415670, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f2ad46fa40a3cde7922fdd8b89f2bb3d?s=128&d=identicon&r=PG&f=1", "display_name": "zarruq", "link": "https://stackoverflow.com/users/8415670/zarruq"}, "edited": false, "score": 0, "creation_date": 1516185174, "post_id": 48298845, "comment_id": 83582264, "body": "Kindly share whole code and specific error"}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user5902678"}, "is_accepted": false, "score": 0, "last_activity_date": 1516185794, "creation_date": 1516185794, "answer_id": 48299157, "question_id": 48298845, "link": "https://stackoverflow.com/questions/48298845/insert-query-in-pl-sql/48299157#48299157", "title": "insert query in pl sql", "body": "<p>insert into tab (userid, reason) \n            values ('\"+UserName+\"','test');</p>\n\n<p>You can modify the query in the VBA as described.</p>\n"}], "owner": {"reputation": 21, "user_id": 9062080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bafe722fb9f76796b7a9d14ee9793252?s=128&d=identicon&r=PG&f=1", "display_name": "user824565", "link": "https://stackoverflow.com/users/9062080/user824565"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 35, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1516185794, "creation_date": 1516184890, "last_edit_date": 1516185204, "question_id": 48298845, "link": "https://stackoverflow.com/questions/48298845/insert-query-in-pl-sql", "title": "insert query in pl sql", "body": "<p>I want to insert a username that I got from eviron method in a table. I have used insert query for this </p>\n\n<pre><code>insert into tab (userid, reason) \n            values ('\"&amp;UserName&amp;\"','test')\n</code></pre>\n\n<p>I am getting error in this syntax.Can someone pls help me how to correct it.</p>\n"}, {"tags": ["vba", "email", "outlook"], "comments": [{"owner": {"reputation": 3612, "user_id": 2422013, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/VwKps.jpg?s=128&g=1", "display_name": "AStopher", "link": "https://stackoverflow.com/users/2422013/astopher"}, "edited": false, "score": 1, "creation_date": 1516187618, "post_id": 48298425, "comment_id": 83583894, "body": "This question was caused by a problem that can no longer be reproduced or a simple typographical error. While similar questions may be on-topic here, this one was resolved in a manner unlikely to help future readers. This can often be avoided by identifying and closely inspecting the shortest program necessary to reproduce the problem before posting."}], "answers": [{"tags": [], "owner": {"reputation": 471, "user_id": 4682879, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/y4f9X.png?s=128&g=1", "display_name": "MapEngine", "link": "https://stackoverflow.com/users/4682879/mapengine"}, "is_accepted": false, "score": -1, "last_activity_date": 1516187510, "creation_date": 1516187510, "answer_id": 48299732, "question_id": 48298425, "link": "https://stackoverflow.com/questions/48298425/outlook-vba-why-does-sender-and-receivedbyname-return-the-same-name/48299732#48299732", "title": "Outlook VBA: Why does Sender and ReceivedByName return the same name?", "body": "<p>Turns out it's</p>\n\n<pre><code>oMail.Recipients.Item(i)\n</code></pre>\n"}], "owner": {"reputation": 471, "user_id": 4682879, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/y4f9X.png?s=128&g=1", "display_name": "MapEngine", "link": "https://stackoverflow.com/users/4682879/mapengine"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 262, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1516187510, "creation_date": 1516183660, "question_id": 48298425, "link": "https://stackoverflow.com/questions/48298425/outlook-vba-why-does-sender-and-receivedbyname-return-the-same-name", "title": "Outlook VBA: Why does Sender and ReceivedByName return the same name?", "body": "<p>I wrote a mail saver macro that reads the recipient, sender and some other stuff, formats the file name and saves as *.msg. This works fine from the inbox. However when I use it from my \"sent\" folder, the below code bit returns my name as both the sender and recipient. Why is that?</p>\n\n<p>The basic mail format looks like this:</p>\n\n<p>Inbox folders:\n- Sender (someone) \n- Subject\n- Recipient (me)</p>\n\n<p>Sent folders:\n- Sender (me)\n- Subject \n- Recipient (someone)</p>\n\n<p>Code:</p>\n\n<pre><code>For Each objItem In ActiveExplorer.Selection\n\n    If objItem.MessageClass = \"IPM.Note\" Then\n        Set oMail = objItem\n\n        mSender = oMail.Sender\n        'mSender = oMail.SenderName 'Same result as .Sender\n\n        mRecipient = oMail.ReceivedByName\n        'mRecipient = oMail.ReceivedOnBehalfOfName   'Same result as .ReceivedByName\n\n        MsgBox \"Sender: \" &amp; mSender &amp; \"_ Recipient: \" &amp; mRecipient\n</code></pre>\n"}, {"tags": ["vba", "excel", "excel-2010", "pivot-table"], "comments": [{"owner": {"reputation": 824, "user_id": 6722034, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/70472b94b95a084f55551520030f88fb?s=128&d=identicon&r=PG&f=1", "display_name": "Arul", "link": "https://stackoverflow.com/users/6722034/arul"}, "edited": false, "score": 0, "creation_date": 1516182832, "post_id": 48297802, "comment_id": 83580689, "body": "As you said your dates would be continuous, you can try something like <code>ws2.PivotTables(&quot;MainTable&quot;).PivotFields(&quot;Date&quot;).PivotFilter&zwnj;&#8203;s.Add Type:=xlDateBetween, Value1:=&quot;1&#47;1&#47;2018&quot;, Value2:=&quot;1&#47;24&#47;2018&quot;</code>"}, {"owner": {"reputation": 429, "user_id": 8841973, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/315b8fe679afc0bdbed1296760210350?s=128&d=identicon&r=PG&f=1", "display_name": "Deepak", "link": "https://stackoverflow.com/users/8841973/deepak"}, "reply_to_user": {"reputation": 824, "user_id": 6722034, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/70472b94b95a084f55551520030f88fb?s=128&d=identicon&r=PG&f=1", "display_name": "Arul", "link": "https://stackoverflow.com/users/6722034/arul"}, "edited": false, "score": 0, "creation_date": 1516183107, "post_id": 48297802, "comment_id": 83580872, "body": "@arul I already said. it is not working for two different years. Check my image"}], "owner": {"reputation": 429, "user_id": 8841973, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/315b8fe679afc0bdbed1296760210350?s=128&d=identicon&r=PG&f=1", "display_name": "Deepak", "link": "https://stackoverflow.com/users/8841973/deepak"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 742, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1516181818, "creation_date": 1516181818, "question_id": 48297802, "link": "https://stackoverflow.com/questions/48297802/how-to-select-multiple-dates-in-filter-in-excel-vba", "title": "How to select multiple dates in Filter in Excel VBA", "body": "<p>I have pivot table which contains all 365 days in a year (in Row labels). I need to choose some dates on filter but continuous dates. \nI will enter a date manaually on Sheet1 in cell A10. Then, the pivot filters must always select from January 1 to the date which i entered.</p>\n\n<p>Sometimes if the date is not available means, then it must choose the previous available date. Then atlast it must select the two adjacent cell values for the date which i entered.I used the code below but not working. </p>\n\n<p>The problem with inbulit Date fitler in pivot table is, it will work only for 1 year. So only i need VBA. Help me to update.</p>\n\n<p><a href=\"https://i.stack.imgur.com/zzZJ5.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/zzZJ5.png\" alt=\"enter image description here\"></a></p>\n\n<pre><code>Sub selectdate()\nDim ws1, ws2 As Worksheet\nDim dat1 As Date\nDim Data As Variant\n\nSet ws1 = Sheets(\"Sheet1\")\nSet ws2 = Sheets(\"Sheet2\")\ndat1 = Sheet1.Range(\"A10\").Value\n\nDim pi As PivotItem\nws2.PivotTables(\"MainTable\").PivotFields(\"Date\").ClearAllFilters\nFor Each pi In ws2.PivotTables(\"MainTable\").PivotFields(\"Date\").PivotItems\n    If Not IsError(Application.Match(pi.Name, dat1, 0)) Then\n            pi.Visible = True\n        Else\n            pi.Visible = False\n        End If\n    Next pi\nEnd If\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "excel-2016", "vba"], "comments": [{"owner": {"reputation": 2555, "user_id": 5794172, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd463d10de161a2b8fbf601f51c58d01?s=128&d=identicon&r=PG&f=1", "display_name": "jkpieterse", "link": "https://stackoverflow.com/users/5794172/jkpieterse"}, "edited": false, "score": 2, "creation_date": 1516181722, "post_id": 48297296, "comment_id": 83580026, "body": "alt+shift 0 works for me (Excel 2016). WHere is your onkey line of code located precisely? What exactly happens when you run it?"}, {"owner": {"reputation": 883, "user_id": 630466, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d526ba13e59803afdeb15ba833cb952d?s=128&d=identicon&r=PG", "display_name": "Relaxed1", "link": "https://stackoverflow.com/users/630466/relaxed1"}, "reply_to_user": {"reputation": 2555, "user_id": 5794172, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd463d10de161a2b8fbf601f51c58d01?s=128&d=identicon&r=PG&f=1", "display_name": "jkpieterse", "link": "https://stackoverflow.com/users/5794172/jkpieterse"}, "edited": false, "score": 0, "creation_date": 1516183071, "post_id": 48297296, "comment_id": 83580849, "body": "Thanks I found the problem now .... see below"}], "answers": [{"comments": [{"owner": {"reputation": 2555, "user_id": 5794172, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd463d10de161a2b8fbf601f51c58d01?s=128&d=identicon&r=PG&f=1", "display_name": "jkpieterse", "link": "https://stackoverflow.com/users/5794172/jkpieterse"}, "edited": false, "score": 1, "creation_date": 1516202221, "post_id": 48298440, "comment_id": 83593535, "body": "Great you were able to solve the problem. Although it does surprise me because normally OnKey supersedes whatever the built-in function is a short-cut key triggers."}], "tags": [], "owner": {"reputation": 883, "user_id": 630466, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d526ba13e59803afdeb15ba833cb952d?s=128&d=identicon&r=PG", "display_name": "Relaxed1", "link": "https://stackoverflow.com/users/630466/relaxed1"}, "is_accepted": true, "score": 1, "last_activity_date": 1516183729, "creation_date": 1516183729, "answer_id": 48298440, "question_id": 48297296, "link": "https://stackoverflow.com/questions/48297296/cannot-program-application-onkey-for-alt0-in-excel-2016/48298440#48298440", "title": "Cannot program application.onkey for alt+0 in Excel 2016", "body": "<p>Thanks, I found the problem now: I had done the ctrl + shift + f1 toggle beforehand. This makes Excel fullscreen and totally hides the ribbon. While hidden, alt + 0 becomes the shortcut to temporarily show the ribbon, and <code>application.onkey \"%0\", \"mysub\"</code> won't work.</p>\n\n<p>Apologies, it was not my intention to answer my own question from the start... But @jkpieterse motivated to me try harder.</p>\n"}], "owner": {"reputation": 883, "user_id": 630466, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d526ba13e59803afdeb15ba833cb952d?s=128&d=identicon&r=PG", "display_name": "Relaxed1", "link": "https://stackoverflow.com/users/630466/relaxed1"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 126, "favorite_count": 0, "accepted_answer_id": 48298440, "answer_count": 1, "score": 0, "last_activity_date": 1556868297, "creation_date": 1516180133, "last_edit_date": 1531164843, "question_id": 48297296, "link": "https://stackoverflow.com/questions/48297296/cannot-program-application-onkey-for-alt0-in-excel-2016", "title": "Cannot program application.onkey for alt+0 in Excel 2016", "body": "<p>In Excel 2016 it seems I cannot program alt + 0 anymore to run a VBA subroutine of mine, in other words \n<code>application.onkey \"%0\", \"mysub\"</code>\n. The default behaviour (to temporary show the ribbon, if hidden) cannot be changed, it seems. But now I also lose alt + shift + 0, in other words the following also does not work:\n<code>application.onkey \"%+0\", \"mysub\"</code>.\nIs there any way to have application.onkey override the default action? Thanks </p>\n"}, {"tags": ["vba", "email", "outlook", "outlook-filter"], "comments": [{"owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "edited": false, "score": 0, "creation_date": 1516210775, "post_id": 48297283, "comment_id": 83599125, "body": "<a href=\"https://stackoverflow.com/help/mcve\">stackoverflow.com/help/mcve</a>"}, {"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 1, "creation_date": 1516233517, "post_id": 48297283, "comment_id": 83609605, "body": "<a href=\"https://stackoverflow.com/search?q=user:4539709+[outlook-filter]\">stackoverflow.com/search?q=user:4539709+[outlook-filter]</a>"}, {"owner": {"reputation": 835, "user_id": 5860143, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/tngDm.png?s=128&g=1", "display_name": "aaa", "link": "https://stackoverflow.com/users/5860143/aaa"}, "edited": false, "score": 0, "creation_date": 1516233888, "post_id": 48297283, "comment_id": 83609707, "body": "Thanks for the reference."}], "answers": [{"tags": [], "owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "is_accepted": false, "score": 0, "last_activity_date": 1516207745, "creation_date": 1516207745, "answer_id": 48306141, "question_id": 48297283, "link": "https://stackoverflow.com/questions/48297283/use-restrict-method-to-get-recipient-subject-and-date-range/48306141#48306141", "title": "Use Restrict method to get recipient, subject and date range", "body": "<p>Outlook does not know what \"today\" is. You need to provide a suitably formatted date value, e.g. \"2018-01-17\"</p>\n"}, {"comments": [{"owner": {"reputation": 835, "user_id": 5860143, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/tngDm.png?s=128&g=1", "display_name": "aaa", "link": "https://stackoverflow.com/users/5860143/aaa"}, "edited": false, "score": 0, "creation_date": 1516234361, "post_id": 48311864, "comment_id": 83609828, "body": "Hi, why is it returning <code>Inbox</code>? shouldn&#39;t it also print out the <code>Subject</code> and <code>ReceivedTime</code>? I modify <code>&quot;Like &#39;%0m3r 0m3r%&#39;&quot;</code> to my name. I did sent myself a mail yesterday. The <code>Items.Count</code> was 0."}, {"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "reply_to_user": {"reputation": 835, "user_id": 5860143, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/tngDm.png?s=128&g=1", "display_name": "aaa", "link": "https://stackoverflow.com/users/5860143/aaa"}, "edited": false, "score": 0, "creation_date": 1516235104, "post_id": 48311864, "comment_id": 83610003, "body": "@ppz <code>fromname</code> should be name from sender - <code>TargetFolder </code> will return Current active folder, the folder your viewing -"}, {"owner": {"reputation": 835, "user_id": 5860143, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/tngDm.png?s=128&g=1", "display_name": "aaa", "link": "https://stackoverflow.com/users/5860143/aaa"}, "edited": false, "score": 0, "creation_date": 1516235834, "post_id": 48311864, "comment_id": 83610171, "body": "Yes. I was testing using subject as well. It does print out the relevance data. However, once I include the Date filters. It&#39;s returning empty result. I&#39;m checking for the date format"}, {"owner": {"reputation": 835, "user_id": 5860143, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/tngDm.png?s=128&g=1", "display_name": "aaa", "link": "https://stackoverflow.com/users/5860143/aaa"}, "edited": false, "score": 1, "creation_date": 1516236289, "post_id": 48311864, "comment_id": 83610278, "body": "Ok, get It. It&#39;s because my system date format is not in <code>mm&#47;dd&#47;yyyy</code> format. I modify the date format and it works great. Thanks!"}], "tags": [], "owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "is_accepted": true, "score": 1, "last_activity_date": 1516235171, "last_edit_date": 1516235171, "creation_date": 1516233176, "answer_id": 48311864, "question_id": 48297283, "link": "https://stackoverflow.com/questions/48297283/use-restrict-method-to-get-recipient-subject-and-date-range/48311864#48311864", "title": "Use Restrict method to get recipient, subject and date range", "body": "<p><em>Here is example for multiple filters</em></p>\n\n<pre><code>Option Explicit\nPublic Sub Example()\n    Dim olNs As Outlook.NameSpace\n    Dim TargetFolder As Outlook.MAPIFolder\n    Dim Items As Outlook.Items\n    Dim Item As Object\n    Dim i As Long\n    Dim Filter As String\n\n    Set olNs = Application.Session\n    If TargetFolder Is Nothing Then Set TargetFolder = ActiveExplorer.CurrentFolder\n    Debug.Print TargetFolder.Name\n\n    Filter = \"@SQL=\" &amp; Chr(34) &amp; \"urn:schemas:httpmail:datereceived\" &amp; _\n                       Chr(34) &amp; \" &gt;= '01/10/2018' And \" &amp; _\n                       Chr(34) &amp; \"urn:schemas:httpmail:datereceived\" &amp; _\n                       Chr(34) &amp; \" &lt; '01/16/2018' And \" &amp; _\n                       Chr(34) &amp; \"urn:schemas:httpmail:fromname\" &amp; _\n                       Chr(34) &amp; \"Like '%0m3r 0m3r%'\"\n\n    Set Items = TargetFolder.Items.Restrict(Filter)\n        Items.Sort \"[ReceivedTime]\"\n\n    For i = Items.Count To 1 Step -1\n        DoEvents\n        If TypeOf Items(i) Is mailitem Then\n            Set Item = Items(i)\n            Debug.Print Item.Subject\n            Debug.Print Item.ReceivedTime\n        End If\n    Next\n\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p><strong><code>If TargetFolder Is Nothing Then Set TargetFolder = ActiveExplorer.CurrentFolder</code></strong></p>\n\n<blockquote>\n  <p><a href=\"https://msdn.microsoft.com/en-us/library/office/aa211818(v=office.11).aspx\" rel=\"nofollow noreferrer\">Returns or sets a MAPIFolder object that represents the current folder displayed in the explorer</a></p>\n  \n  <hr>\n</blockquote>\n\n<p>Or use</p>\n\n<pre><code>Dim olNs As Outlook.NameSpace\nDim TargetFolder As Outlook.MAPIFolder\nSet olNs = Application.GetNamespace(\"MAPI\")\nSet TargetFolder = olNs.GetDefaultFolder(olFolderInbox)\n</code></pre>\n\n<p>Filter with Subject line</p>\n\n<pre><code>Filter = \"@SQL=\" &amp; Chr(34) &amp; \"urn:schemas:httpmail:datereceived\" &amp; _\n                   Chr(34) &amp; \" &gt;= '01/10/2018' And \" &amp; _\n                   Chr(34) &amp; \"urn:schemas:httpmail:datereceived\" &amp; _\n                   Chr(34) &amp; \" &lt; '01/17/2018' And \" &amp; _\n                   Chr(34) &amp; \"urn:schemas:httpmail:fromname\" &amp; _\n                   Chr(34) &amp; \"Like '%0m3r 0m3r%' And \" &amp; _\n                   Chr(34) &amp; \"urn:schemas:httpmail:subject\" &amp; _\n                   Chr(34) &amp; \" Like '%Bla Bla%'\"\n</code></pre>\n"}], "owner": {"reputation": 835, "user_id": 5860143, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/tngDm.png?s=128&g=1", "display_name": "aaa", "link": "https://stackoverflow.com/users/5860143/aaa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1293, "favorite_count": 0, "accepted_answer_id": 48311864, "answer_count": 2, "score": 1, "last_activity_date": 1593071922, "creation_date": 1516180095, "last_edit_date": 1593071922, "question_id": 48297283, "link": "https://stackoverflow.com/questions/48297283/use-restrict-method-to-get-recipient-subject-and-date-range", "title": "Use Restrict method to get recipient, subject and date range", "body": "<p>I tried </p>\n\n<pre><code>'only works for name, not email address.\n\"@SQL=\"\"urn:schemas:httpmail:displayto\"\" ci_phrasematch '%John Doe%'\" \n\n'works great, failed when use AND. today was declared as string\n\"@SQL=\"\"urn:schemas:httpmail:subject\"\" like '%\" &amp; emailSubject &amp; \"%'\"\n\n'works great, failed when use AND. today was declared as string\n\"[ReceivedTime] &lt;= today\" \n</code></pre>\n\n<p>How can I use <code>Item.Restrict</code> to filter the recipient email address, subject and date range together?</p>\n"}, {"tags": ["vba", "ms-project"], "answers": [{"tags": [], "owner": {"reputation": 301, "user_id": 6765719, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/FXG4j.jpg?s=128&g=1", "display_name": "Eric Christoph", "link": "https://stackoverflow.com/users/6765719/eric-christoph"}, "is_accepted": false, "score": 1, "last_activity_date": 1516286480, "creation_date": 1516286480, "answer_id": 48323836, "question_id": 48297130, "link": "https://stackoverflow.com/questions/48297130/vba-management-tool/48323836#48323836", "title": "VBA Management tool?", "body": "<p>I was trying to do the same thing, but in the end it's easier to just migrate to full VB.net and build your code as an add-in using the full power of Visual Studio. You get complete dev and test tools, plus integration with TFS, and a much better IDE to work with. The learning curve for the VB stuff is minimal (same language syntax, same Project Object Model), but there is a little getting used to Visual Studio.</p>\n\n<p>There are some (rather complicated) solutions out there, but if you are ready for managed code you may as well take the leap.</p>\n"}], "owner": {"reputation": 11, "user_id": 8370107, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69f9fff9059eba467cadfec9b7f6e1d4?s=128&d=identicon&r=PG&f=1", "display_name": "MessorG", "link": "https://stackoverflow.com/users/8370107/messorg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 76, "favorite_count": 0, "closed_date": 1593558915, "answer_count": 1, "score": -1, "last_activity_date": 1593558902, "creation_date": 1516179515, "last_edit_date": 1593558902, "question_id": 48297130, "link": "https://stackoverflow.com/questions/48297130/vba-management-tool", "closed_reason": "Not suitable for this site", "title": "VBA Management tool?", "body": "<p>I use MS Project Professional 2013, and I need to find a tool for code management for VBA. I would like this tool to be able to import and export code from/to MSP and the ability to integration with TFS. Can you recommend something to me?</p>\n"}, {"tags": ["excel", "vba", "text", "import"], "answers": [{"comments": [{"owner": {"reputation": 213, "user_id": 8918431, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/bd76a92f8e53e1fe19af76101d9bb3e4?s=128&d=identicon&r=PG&f=1", "display_name": "Rose", "link": "https://stackoverflow.com/users/8918431/rose"}, "edited": false, "score": 0, "creation_date": 1516184531, "post_id": 48297717, "comment_id": 83581812, "body": "that is perfect, many thanks! where can I read more about all these details?"}, {"owner": {"reputation": 2555, "user_id": 5794172, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd463d10de161a2b8fbf601f51c58d01?s=128&d=identicon&r=PG&f=1", "display_name": "jkpieterse", "link": "https://stackoverflow.com/users/5794172/jkpieterse"}, "reply_to_user": {"reputation": 213, "user_id": 8918431, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/bd76a92f8e53e1fe19af76101d9bb3e4?s=128&d=identicon&r=PG&f=1", "display_name": "Rose", "link": "https://stackoverflow.com/users/8918431/rose"}, "edited": false, "score": 0, "creation_date": 1516202268, "post_id": 48297717, "comment_id": 83593575, "body": "In the article I already mentioned above I guess? Or are you looking for other information?"}, {"owner": {"reputation": 213, "user_id": 8918431, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/bd76a92f8e53e1fe19af76101d9bb3e4?s=128&d=identicon&r=PG&f=1", "display_name": "Rose", "link": "https://stackoverflow.com/users/8918431/rose"}, "edited": false, "score": 0, "creation_date": 1516203328, "post_id": 48297717, "comment_id": 83594365, "body": "yes I read it. I mean, for instance, if I want to import an space delimited .txt file, how do I change this same code? Or any other change... mamy thanks"}, {"owner": {"reputation": 2555, "user_id": 5794172, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd463d10de161a2b8fbf601f51c58d01?s=128&d=identicon&r=PG&f=1", "display_name": "jkpieterse", "link": "https://stackoverflow.com/users/5794172/jkpieterse"}, "reply_to_user": {"reputation": 213, "user_id": 8918431, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/bd76a92f8e53e1fe19af76101d9bb3e4?s=128&d=identicon&r=PG&f=1", "display_name": "Rose", "link": "https://stackoverflow.com/users/8918431/rose"}, "edited": false, "score": 0, "creation_date": 1516257377, "post_id": 48297717, "comment_id": 83615767, "body": "The crux is that you actually do not need any VBA code, just use the Excel userinterface as described in the article."}], "tags": [], "owner": {"reputation": 2555, "user_id": 5794172, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd463d10de161a2b8fbf601f51c58d01?s=128&d=identicon&r=PG&f=1", "display_name": "jkpieterse", "link": "https://stackoverflow.com/users/5794172/jkpieterse"}, "is_accepted": true, "score": 2, "last_activity_date": 1516181546, "creation_date": 1516181546, "answer_id": 48297717, "question_id": 48297102, "link": "https://stackoverflow.com/questions/48297102/importing-txt-into-excel-with-vba-not-adding-a-column/48297717#48297717", "title": "Importing .txt into Excel with VBA not adding a column", "body": "<p>Change\n  <code>.RefreshStyle = xlInsertDeleteCells</code> to  <code>.RefreshStyle = xlOverWriteCells</code>, then run the macro just once. After that you can simply have Excel do the work by hitting the refresh data button on the data tab and get rid of the macro.\nSee: <a href=\"http://jkp-ads.com/articles/importtext.asp\" rel=\"nofollow noreferrer\">http://jkp-ads.com/articles/importtext.asp</a></p>\n"}], "owner": {"reputation": 213, "user_id": 8918431, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/bd76a92f8e53e1fe19af76101d9bb3e4?s=128&d=identicon&r=PG&f=1", "display_name": "Rose", "link": "https://stackoverflow.com/users/8918431/rose"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 470, "favorite_count": 1, "accepted_answer_id": 48297717, "answer_count": 1, "score": 1, "last_activity_date": 1516181546, "creation_date": 1516179406, "question_id": 48297102, "link": "https://stackoverflow.com/questions/48297102/importing-txt-into-excel-with-vba-not-adding-a-column", "title": "Importing .txt into Excel with VBA not adding a column", "body": "<p>I have this code to import a .txt file to my Excel sheet (<code>Sheet1</code>). In <code>Sheet1</code> I have the first column with a formula, so I import my text data into B1.\nThis code does it well the first time, however the following ones adds a column to the right, moving the selected cells in the formula of column A. The data is copied in B1 still, but somehow adding a column first. Any help? </p>\n\n<pre><code>Sheets(\"Sheet1\").Select\nColumns(\"B:F\").Select\nSelection.ClearContents\n\nDim Ret\n\nRet = Application.GetOpenFilename(\"Text Files (*.txt), *.txt\", Title:=\"Select text file(.txt)\")\n\nIf Ret &lt;&gt; False Then\n    With ActiveSheet.QueryTables.Add(Connection:= _\n    \"TEXT;\" &amp; Ret, Destination:=Range(\"$B$1\"))\n    .FieldNames = True\n    .RowNumbers = False\n    .FillAdjacentFormulas = False\n    .PreserveFormatting = True\n    .RefreshOnFileOpen = False\n    .RefreshStyle = xlInsertDeleteCells\n    .SavePassword = False\n    .SaveData = True\n    .AdjustColumnWidth = True\n    .RefreshPeriod = 0\n    .TextFilePromptOnRefresh = False\n    .TextFilePlatform = 437\n    .TextFileStartRow = 1\n    .TextFileParseType = xlDelimited\n    .TextFileTextQualifier = xlTextQualifierDoubleQuote\n    .TextFileConsecutiveDelimiter = False\n    .TextFileTabDelimiter = True\n    .TextFileSemicolonDelimiter = False\n    .TextFileCommaDelimiter = True\n    .TextFileSpaceDelimiter = False\n    .TextFileColumnDataTypes = Array(1, 1, 1, 1, 2)\n    .TextFileTrailingMinusNumbers = True\n    .Refresh BackgroundQuery:=False\n    End With\n\nEnd If\n</code></pre>\n"}, {"tags": ["vba", "ms-access"], "comments": [{"owner": {"reputation": 3982, "user_id": 5695953, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b50e1603f447a4a31cded4a14edfeff9?s=128&d=identicon&r=PG&f=1", "display_name": "Md. Suman Kabir", "link": "https://stackoverflow.com/users/5695953/md-suman-kabir"}, "edited": false, "score": 0, "creation_date": 1516179587, "post_id": 48296982, "comment_id": 83578754, "body": "Check the data source of the form and then find <code>Run</code> in that data source"}], "answers": [{"tags": [], "owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "is_accepted": true, "score": 1, "last_activity_date": 1516179288, "creation_date": 1516179288, "answer_id": 48297079, "question_id": 48296982, "link": "https://stackoverflow.com/questions/48296982/how-to-see-from-what-source-data-comes-from-in-ms-access/48297079#48297079", "title": "How to see from what source data comes from in ms access", "body": "<p>Quite simple:</p>\n\n<p>If the control source is <em>run</em>, the value comes from the column <em>run</em> of the form's record source. The record source can either be a table or a query.</p>\n"}], "owner": {"reputation": 569, "user_id": 9142561, "user_type": "registered", "accept_rate": 60, "profile_image": "https://graph.facebook.com/2003968199891958/picture?type=large", "display_name": "nick318", "link": "https://stackoverflow.com/users/9142561/nick318"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 37, "favorite_count": 0, "accepted_answer_id": 48297079, "answer_count": 1, "score": 1, "last_activity_date": 1516179288, "creation_date": 1516178957, "last_edit_date": 1516179254, "question_id": 48296982, "link": "https://stackoverflow.com/questions/48296982/how-to-see-from-what-source-data-comes-from-in-ms-access", "title": "How to see from what source data comes from in ms access", "body": "<p>I have to figure out from what source the value of the field is coming from. </p>\n\n<p>I have tried to search by name <code>txtRun</code> and by Control source name <code>Run</code> in vb classes, but there are nothing matched values.</p>\n\n<p>Are there any ways to do that?</p>\n\n<p><a href=\"https://i.stack.imgur.com/4mjXf.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/4mjXf.png\" alt=\"Field in design view\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/MoKWl.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/MoKWl.png\" alt=\"Properties for that field\"></a></p>\n"}, {"tags": ["html", "excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 21753, "user_id": 3978545, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jmQsw.png?s=128&g=1", "display_name": "Wolfie", "link": "https://stackoverflow.com/users/3978545/wolfie"}, "is_accepted": true, "score": 1, "last_activity_date": 1516178884, "creation_date": 1516178884, "answer_id": 48296965, "question_id": 48296879, "link": "https://stackoverflow.com/questions/48296879/html-vba-modification-url/48296965#48296965", "title": "HTML VBA modification URL", "body": "<p>You can get the string from <code>A1</code> using</p>\n\n<pre><code>Dim str As String: str = ThisWorkbook.Sheets(\"Feuil1\").Range(\"A1\").Value\n</code></pre>\n\n<p>Then create the URL from what you've stated</p>\n\n<pre><code>Dim myURL as String\n' The &amp; symbol concatenates strings. The _ symbol is for line continuation.\nmyURL = \"http://Confidential.eu.airbus.Confidential:Confidential/Confidential/\" _\n        &amp; \"consultation/preViewMP.do?\" &amp; str\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user7755666"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 91, "favorite_count": 0, "accepted_answer_id": 48296965, "answer_count": 1, "score": 0, "last_activity_date": 1516185538, "creation_date": 1516178577, "last_edit_date": 1531164843, "question_id": 48296879, "link": "https://stackoverflow.com/questions/48296879/html-vba-modification-url", "title": "HTML VBA modification URL", "body": "<p>I'm trying to modify a link \"<code>URL link</code>\" using VBA Excel to extract specific Value from Site . </p>\n\n<p>Below the Type of link :</p>\n\n<p>URL<code>http://Confidential.eu.airbus.Confidential:Confidential/Confidential/consultation/preViewMP.do?mpId=XXXXXX</code></p>\n\n<p>What I want is to change <code>mpID=XXXXX</code> with <code>sheet(\"Feuil1\").range(\"A1\").value</code>but I didn't succeed , I don't have the right knowledge</p>\n\n<p>So I don't have a clue how to manipulate this URL to open what I enter in <code>range(\"A1\")</code> and look for specific line there and Copy and Past it in my excel File</p>\n\n<p>Anyone could light me with some idea or help to better code this  ? </p>\n"}, {"tags": ["excel", "vba", "sorting"], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 9228417, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a317809a9b96ec04490d24528c59c2fd?s=128&d=identicon&r=PG&f=1", "display_name": "PMH123", "link": "https://stackoverflow.com/users/9228417/pmh123"}, "edited": false, "score": 0, "creation_date": 1516252441, "post_id": 48297061, "comment_id": 83614153, "body": "Thank you for the (very fast) reply sktneer. Works perfectly - much appreciated!"}, {"owner": {"reputation": 9506, "user_id": 2312614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ra7Jm.jpg?s=128&g=1", "display_name": "Subodh Tiwari sktneer", "link": "https://stackoverflow.com/users/2312614/subodh-tiwari-sktneer"}, "reply_to_user": {"reputation": 13, "user_id": 9228417, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a317809a9b96ec04490d24528c59c2fd?s=128&d=identicon&r=PG&f=1", "display_name": "PMH123", "link": "https://stackoverflow.com/users/9228417/pmh123"}, "edited": false, "score": 0, "creation_date": 1516256121, "post_id": 48297061, "comment_id": 83615323, "body": "You&#39;re welcome! Glad it worked as desired. Please take a minute to accept the answer to mark your question as Solved. :)"}], "tags": [], "owner": {"reputation": 9506, "user_id": 2312614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ra7Jm.jpg?s=128&g=1", "display_name": "Subodh Tiwari sktneer", "link": "https://stackoverflow.com/users/2312614/subodh-tiwari-sktneer"}, "is_accepted": true, "score": 0, "last_activity_date": 1516179215, "creation_date": 1516179215, "answer_id": 48297061, "question_id": 48296771, "link": "https://stackoverflow.com/questions/48296771/excel-vba-pop-up-window-to-define-range-to-perform-multiple-criteria-sorting/48297061#48297061", "title": "Excel VBA, pop-up window to define range to perform multiple criteria sorting", "body": "<p>You may try something like this. Look at the comments I added in the code.</p>\n\n<pre><code>Sub Sort_and_Subtotal_CheckBox()\n\nDim SortRng As Range\n\nOn Error Resume Next\nSet SortRng = Application.InputBox(\"Select the range to sort\", \"Select Range\", Type:=8)\nOn Error GoTo 0\n\nIf Not SortRng Is Nothing Then\n    'SortRng.Cells(1, 1) --&gt; First cell in column 1 in the selected range\n    'SortRng.Cells(1, 2) --&gt; First cell in column 2 in the selected range\n    'SortRng.Cells(1, 3) --&gt; First cell in column 3 in the selected range\n    SortRng.Sort key1:=SortRng.Cells(1, 1), order1:=xlAscending, key2:=SortRng.Cells(1, 2), order2:=xlAscending, key3:=SortRng.Cells(1, 3), order3:=xlAscending, Header:=xlGuess\nEnd If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 9228417, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a317809a9b96ec04490d24528c59c2fd?s=128&d=identicon&r=PG&f=1", "display_name": "PMH123", "link": "https://stackoverflow.com/users/9228417/pmh123"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 972, "favorite_count": 0, "accepted_answer_id": 48297061, "answer_count": 1, "score": 1, "last_activity_date": 1516179215, "creation_date": 1516178221, "question_id": 48296771, "link": "https://stackoverflow.com/questions/48296771/excel-vba-pop-up-window-to-define-range-to-perform-multiple-criteria-sorting", "title": "Excel VBA, pop-up window to define range to perform multiple criteria sorting", "body": "<p>amateur macro writer here. I am looking for some guidance in how to write a macro which does the following: </p>\n\n<p>Pop-up box which prompts user to define a range of data e.g. A26:K35.</p>\n\n<p>Use this range to then perform a custom filtering e.g. Sort on Column A, then B, then C in ascending order.</p>\n\n<p>The following code, I pieced together, will provide the prompt, and sort based on A - I cannot seem to add the additional criteria.</p>\n\n<p>Any guidance would be greatly appreciated.</p>\n\n<pre><code>Sub Sort_and_Subtotal_CheckBox()\n\nDim SortRng As Range\n\nSet SortRng = Application.InputBox(\"Select the range to sort\", \"Select Range\", 0, , , , , 8)\n\nSortRng.Select\nSelection.Sort Key1:=SortRng, Order1:=xlAscending, Header:=xlGuess, _\nOrderCustom:=1, MatchCase:=False, Orientation:=xlTopToBottom, _\nDataOption1:=xlSortNormal\nRange(\"A1\").Select\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "outlook"], "answers": [{"comments": [{"owner": {"reputation": 540, "user_id": 7977245, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/75d742b8a8e957e7d15b8b040818fea4?s=128&d=identicon&r=PG&f=1", "display_name": "dre_84w934", "link": "https://stackoverflow.com/users/7977245/dre-84w934"}, "edited": false, "score": 1, "creation_date": 1516616678, "post_id": 48306207, "comment_id": 83745229, "body": "sorry, I take that back, it does not work in my case. While ReceivedByName property does indeed retrieve the responder, in case of a shared mailbox, it does not work. Instead, it retrieves the name of the shared mailbox. I&#39;ve also tried the  ReceivedOnBehalfOfName property, but still no luck, it does the same."}, {"owner": {"reputation": 540, "user_id": 7977245, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/75d742b8a8e957e7d15b8b040818fea4?s=128&d=identicon&r=PG&f=1", "display_name": "dre_84w934", "link": "https://stackoverflow.com/users/7977245/dre-84w934"}, "edited": false, "score": 1, "creation_date": 1516712712, "post_id": 48306207, "comment_id": 83792979, "body": "thanks for the correction. So, I&#39;ve done some research and as it turns out, PR_LAST_MODIFIER_NAME also changes when an email is moved. Here, I would have a problem because if a user answers the email and another moves it to a different folder, I will not retrieve the true sender, but the user that moved the email."}, {"owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "reply_to_user": {"reputation": 540, "user_id": 7977245, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/75d742b8a8e957e7d15b8b040818fea4?s=128&d=identicon&r=PG&f=1", "display_name": "dre_84w934", "link": "https://stackoverflow.com/users/7977245/dre-84w934"}, "edited": false, "score": 0, "creation_date": 1516803828, "post_id": 48306207, "comment_id": 83839006, "body": "Then you are out of luck - Outlook does not keep a log of changes."}, {"owner": {"reputation": 398, "user_id": 1568996, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/e626621d7b6054a4f491fc974063d8ae?s=128&d=identicon&r=PG", "display_name": "DeerSpotter", "link": "https://stackoverflow.com/users/1568996/deerspotter"}, "edited": false, "score": 0, "creation_date": 1531863790, "post_id": 48306207, "comment_id": 89753319, "body": "How can i call it in outlook using a macro"}, {"owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "edited": false, "score": 0, "creation_date": 1531921825, "post_id": 48306207, "comment_id": 89778412, "body": "Call what? Are you running into a particular problem doing that?"}], "tags": [], "owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "is_accepted": true, "score": 2, "last_activity_date": 1516668607, "last_edit_date": 1516668607, "creation_date": 1516207995, "answer_id": 48306207, "question_id": 48296556, "link": "https://stackoverflow.com/questions/48296556/retrieve-emails-replier-name-of-email-in-a-shared-mailbox/48306207#48306207", "title": "Retrieve email&#39;s replier name of email in a shared mailbox", "body": "<p>Try <code>MailItem.ReceivedByName</code> property.</p>\n\n<p>If you want the name of the last user who modified the message (if a user replied to a message, the message will be modified), use the <code>PR_LAST_MODIFIER_NAME</code> property DASL name (<code>http://schemas.microsoft.com/mapi/proptag/0x3FFA001F</code>). You can also try to retrieve <code>PR_LAST_MODIFIER_ENTRYID</code> (DASL name <code>http://schemas.microsoft.com/mapi/proptag/0x3FFB0102</code>), convert it to hex, and open it as <code>AddressEntry</code> object using <code>Namespace.GetAddressEntryFromID</code>.</p>\n"}], "owner": {"reputation": 540, "user_id": 7977245, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/75d742b8a8e957e7d15b8b040818fea4?s=128&d=identicon&r=PG&f=1", "display_name": "dre_84w934", "link": "https://stackoverflow.com/users/7977245/dre-84w934"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 375, "favorite_count": 1, "accepted_answer_id": 48306207, "answer_count": 1, "score": 2, "last_activity_date": 1608498029, "creation_date": 1516177498, "last_edit_date": 1608498029, "question_id": 48296556, "link": "https://stackoverflow.com/questions/48296556/retrieve-emails-replier-name-of-email-in-a-shared-mailbox", "title": "Retrieve email&#39;s replier name of email in a shared mailbox", "body": "<p>I retrieve information for each email such as date received, date sent, sender and so on. This data is transferred into an Excel table.</p>\n<p>I am looking into adding replier's email address, if the inbox email has been replied to.</p>\n<p>By repliers I mean the users that have access to the common mailbox and reply to the emails received. Since our mailbox is shared, sometimes repliers are replying on behalf of <code>mailboxToRunReportOn@example.com</code>, sometimes are replying as themselves.</p>\n<p>I am not able to find any <a href=\"https://msdn.microsoft.com/en-us/library/office/cc765838.aspx\" rel=\"nofollow noreferrer\">MAPI</a> or <a href=\"https://msdn.microsoft.com/en-us/library/microsoft.office.interop.outlook.mailitem_properties.aspx\" rel=\"nofollow noreferrer\">MailItem</a> propertes to retrieve the email's replier's name for inbox emails.</p>\n<pre class=\"lang-vb prettyprint-override\"><code>Sub ReportResponses()\n    Dim objNS As Outlook.NameSpace\n    Dim objFolder As Outlook.Folder\n    Dim objTable As Outlook.Table\n    Dim objRow As Outlook.Row\n    Dim objEX As Object\n    Dim objWB As Object\n    Dim objWS As Object\n    Dim intR As Integer\n    Dim val()\n    Const PR_LAST_VERB_EXECUTION_TIME = &quot;http://schemas.microsoft.com/mapi/proptag/0x10820040&quot;\n    Const PR_LAST_VERB_EXECUTED = &quot;http://schemas.microsoft.com/mapi/proptag/0x10810003&quot;\n    On Error Resume Next\n        \n    Set objNS = Application.GetNamespace(&quot;MAPI&quot;)\n    Set objFolder = objNS.PickFolder\n    Set objTable = objFolder.GetTable\n        \n    With objTable\n        .Columns.RemoveAll\n        .Columns.Add &quot;SenderName&quot;\n        .Columns.Add &quot;Subject&quot;\n        .Columns.Add &quot;SentOn&quot;\n        .Columns.Add &quot;UnRead&quot;\n        .Columns.Add PR_LAST_VERB_EXECUTION_TIME 'returns reply date\n    End With\n    If objTable.GetRowCount &gt; 0 Then\n        Set objEX = CreateObject(&quot;Excel.Application&quot;)\n        Set objWB = objEX.Workbooks.Add\n        Set objWS = objWB.Worksheets(1)\n        intR = 4\n        Do Until objTable.EndOfTable\n            Set objRow = objTable.GetNextRow\n            val = objRow.GetValues\n            With objWS\n                .Cells(intR, 1).Value = val(0)\n                .Cells(intR, 2).Value = val(1)\n                .Cells(intR, 3).Value = val(2)\n                .Cells(intR, 4).Value = didReadMail(val(3))\n                .Cells(intR, 5).Value = val(4)\n                If IsDate(val(4)) Then\n                    .Cells(intR, 6).Value = Hour(TimeDiff((CDate(val(4))), (CDate(val(2)))))\n                End If\n            End With\n            intR = intR + 1\n        Loop\n        With objWS\n            .Columns(&quot;A:G&quot;).EntireColumn.AutoFit\n            .Cells(1, 1).Value = &quot;Report on Messages in Folder: &quot; &amp; objFolder.FolderPath\n            .Cells(3, 1).Value = &quot;From&quot;\n            .Cells(3, 2).Value = &quot;Subject&quot;\n            .Cells(3, 3).Value = &quot;Received On&quot;\n            .Cells(3, 4).Value = &quot;DidRead&quot;\n            .Cells(3, 5).Value = &quot;Replied On&quot;\n            .Cells(3, 6).Value = &quot;Resonse time in h&quot;\n            .Range(&quot;A1:G3&quot;).Font.Bold = True\n            .Columns(&quot;D&quot;).EntireColumn.AutoFit\n            .Range(&quot;A4&quot;).AutoFilter\n        End With\n        objEX.Visible = True\n        objWB.Activate\n    End If\n    Set objTable = Nothing\n    Set objRow = Nothing\n    Set objEX = Nothing\n    Set objWS = Nothing\nEnd Sub\n    \nFunction TimeDiff(ByRef StartTime As Date, ByRef StopTime As Date) As Date\n    TimeDiff = CDate((StopTime - StartTime))\nEnd Function\n    \nFunction didReadMail(ByVal isUnread As Boolean) As Boolean\n    If isUnread = False Then\n        didReadMail = True\n    Else\n        didReadMail = False\n    End If\nEnd Function\n</code></pre>\n"}, {"tags": ["vba", "excel", "operators"], "comments": [{"owner": {"reputation": 2189, "user_id": 8726447, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/961e6112f7d5aac9646ce1469e89fe20?s=128&d=identicon&r=PG&f=1", "display_name": "MarcinSzaleniec", "link": "https://stackoverflow.com/users/8726447/marcinszaleniec"}, "edited": false, "score": 0, "creation_date": 1516176850, "post_id": 48296321, "comment_id": 83577248, "body": "It works for me. What is your decimal separator? Comma or point?"}, {"owner": {"reputation": 165, "user_id": 7533100, "user_type": "registered", "accept_rate": 91, "profile_image": "https://graph.facebook.com/10154808286796047/picture?type=large", "display_name": "LarsS", "link": "https://stackoverflow.com/users/7533100/larss"}, "reply_to_user": {"reputation": 2189, "user_id": 8726447, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/961e6112f7d5aac9646ce1469e89fe20?s=128&d=identicon&r=PG&f=1", "display_name": "MarcinSzaleniec", "link": "https://stackoverflow.com/users/8726447/marcinszaleniec"}, "edited": false, "score": 0, "creation_date": 1516176929, "post_id": 48296321, "comment_id": 83577277, "body": "Comma, but I did try to change system settings to point decimal, and I still got the error ... Weird. Possibly some arcane language setting problem?"}, {"owner": {"reputation": 4801, "user_id": 4713729, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/PL9tu.jpg?s=128&g=1", "display_name": "vacip", "link": "https://stackoverflow.com/users/4713729/vacip"}, "edited": false, "score": 0, "creation_date": 1516177120, "post_id": 48296321, "comment_id": 83577371, "body": "What do you put in the inputbox? could you give an example? VBA always uses the US English formats, reardless of your system settings. So in the inputbox, one will always have to insert number with a decimal point, not a comma."}, {"owner": {"reputation": 165, "user_id": 7533100, "user_type": "registered", "accept_rate": 91, "profile_image": "https://graph.facebook.com/10154808286796047/picture?type=large", "display_name": "LarsS", "link": "https://stackoverflow.com/users/7533100/larss"}, "edited": false, "score": 0, "creation_date": 1516177260, "post_id": 48296321, "comment_id": 83577443, "body": "I&#39;ve always used whole numbers while testing, e.g. &quot;*1000&quot;. But thanks for the info; that gives me another problem to solve, ;)."}, {"owner": {"reputation": 165, "user_id": 7533100, "user_type": "registered", "accept_rate": 91, "profile_image": "https://graph.facebook.com/10154808286796047/picture?type=large", "display_name": "LarsS", "link": "https://stackoverflow.com/users/7533100/larss"}, "edited": false, "score": 0, "creation_date": 1516177374, "post_id": 48296321, "comment_id": 83577500, "body": "And I see I get the same error if I use a decimal comma in the input box on an integer. So I guess the error is related to that."}, {"owner": {"reputation": 4801, "user_id": 4713729, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/PL9tu.jpg?s=128&g=1", "display_name": "vacip", "link": "https://stackoverflow.com/users/4713729/vacip"}, "edited": false, "score": 0, "creation_date": 1516177470, "post_id": 48296321, "comment_id": 83577554, "body": "Yeah, I&#39;m testing it. Funny error. VBA understands 1,5, Excel understands 1,5, but when VBA is passing a value to Excel, it has to be 1.5. Format() doesn&#39;t work, so I&#39;m afraid you will have to do some disgusting text replacements... Bleh..."}], "answers": [{"comments": [{"owner": {"reputation": 4801, "user_id": 4713729, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/PL9tu.jpg?s=128&g=1", "display_name": "vacip", "link": "https://stackoverflow.com/users/4713729/vacip"}, "edited": false, "score": 0, "creation_date": 1516177757, "post_id": 48296580, "comment_id": 83577720, "body": "I&#39;d do the replacement on the output, as decimal and thousand separators might appear in the cells as well. And the error occurs when VBA tries to write the value to the Excel cell. Also, space as a thousand separator doesn&#39;t cause any problems, but . (dot) does, so I&#39;d change that instead."}, {"owner": {"reputation": 165, "user_id": 7533100, "user_type": "registered", "accept_rate": 91, "profile_image": "https://graph.facebook.com/10154808286796047/picture?type=large", "display_name": "LarsS", "link": "https://stackoverflow.com/users/7533100/larss"}, "edited": false, "score": 0, "creation_date": 1516177918, "post_id": 48296580, "comment_id": 83577797, "body": "This does work for the problem of using comma in the inputbox, Thanks. But I still have the original problem."}], "tags": [], "owner": {"reputation": 2189, "user_id": 8726447, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/961e6112f7d5aac9646ce1469e89fe20?s=128&d=identicon&r=PG&f=1", "display_name": "MarcinSzaleniec", "link": "https://stackoverflow.com/users/8726447/marcinszaleniec"}, "is_accepted": false, "score": 1, "last_activity_date": 1516177594, "creation_date": 1516177594, "answer_id": 48296580, "question_id": 48296321, "link": "https://stackoverflow.com/questions/48296321/excel-vba-math-type-formula-with-variable-operator-doesnt-work-on-decimal-numbe/48296580#48296580", "title": "Excel VBA math type formula with variable operator doesn&#39;t work on decimal numbers", "body": "<p>try to use following line after inputbox:</p>\n\n<pre><code>If Application.ThousandsSeparator = \" \" Then expression = Replace(expression, \" \", \"\")\nIf Application.DecimalSeparator = \",\" Then expression = Replace(expression, \",\", \".\")\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 165, "user_id": 7533100, "user_type": "registered", "accept_rate": 91, "profile_image": "https://graph.facebook.com/10154808286796047/picture?type=large", "display_name": "LarsS", "link": "https://stackoverflow.com/users/7533100/larss"}, "is_accepted": false, "score": 0, "last_activity_date": 1516178447, "last_edit_date": 1516178447, "creation_date": 1516178137, "answer_id": 48296746, "question_id": 48296321, "link": "https://stackoverflow.com/questions/48296321/excel-vba-math-type-formula-with-variable-operator-doesnt-work-on-decimal-numbe/48296746#48296746", "title": "Excel VBA math type formula with variable operator doesn&#39;t work on decimal numbers", "body": "<p>I can separate the operator and number and use a case select statement, but then I have to include all possible operators and limit the functionality to the operators I include.</p>\n\n<p>This works, with decimal comma in the inputbox and the cell:</p>\n\n<pre><code>Sub CellMath()\nDim rng As Range\nDim c As Variant, operator As Variant\noperator = InputBox(\"Enter operator (* / + - ^ or e).\", \"Operator\")\nIf StrPtr(operator) = 0 Then Exit Sub\nc = InputBox(\"Enter number.\", \"Number\")\nIf StrPtr(c) = 0 Then Exit Sub\nFor Each rng In Selection\nIf WorksheetFunction.IsNumber(rng) Then\nSelect Case operator\n    Case \"*\"\n    rng.Value = rng * c\n    Case \"/\"\n    rng.Value = rng / c\n    Case \"+\"\n    rng.Value = rng + c\n    Case \"-\"\n    rng.Value = rng - c\n    Case \"^\"\n    rng.Value = rng ^ c\n    Case \"e\"\n    rng.Value = rng * 10 ^ c\nEnd Select\nElse\nEnd If\nNext rng\nEnd Sub\n</code></pre>\n\n<p>Any interesting operators I've forgotten here?</p>\n"}, {"comments": [{"owner": {"reputation": 165, "user_id": 7533100, "user_type": "registered", "accept_rate": 91, "profile_image": "https://graph.facebook.com/10154808286796047/picture?type=large", "display_name": "LarsS", "link": "https://stackoverflow.com/users/7533100/larss"}, "edited": false, "score": 0, "creation_date": 1516181824, "post_id": 48297563, "comment_id": 83580086, "body": "It works for integers, but when I use it on decimal numbers, I get a &quot;#VALUE&quot; error, for some reason."}, {"owner": {"reputation": 3359, "user_id": 4604845, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/88d81c9b06f65d860bb60c31ab062e7e?s=128&d=identicon&r=PG&f=1", "display_name": "Vegard", "link": "https://stackoverflow.com/users/4604845/vegard"}, "reply_to_user": {"reputation": 165, "user_id": 7533100, "user_type": "registered", "accept_rate": 91, "profile_image": "https://graph.facebook.com/10154808286796047/picture?type=large", "display_name": "LarsS", "link": "https://stackoverflow.com/users/7533100/larss"}, "edited": false, "score": 0, "creation_date": 1516183142, "post_id": 48297563, "comment_id": 83580898, "body": "Most likely because you&#39;re not using EN-US localization. Updated code to convert it. Note that you&#39;ll either need to add the same <code>Replace</code> to your <code>InputBox</code> or instruct your users to enter decimal values with <code>.</code> instead of <code>,</code>"}, {"owner": {"reputation": 3359, "user_id": 4604845, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/88d81c9b06f65d860bb60c31ab062e7e?s=128&d=identicon&r=PG&f=1", "display_name": "Vegard", "link": "https://stackoverflow.com/users/4604845/vegard"}, "reply_to_user": {"reputation": 165, "user_id": 7533100, "user_type": "registered", "accept_rate": 91, "profile_image": "https://graph.facebook.com/10154808286796047/picture?type=large", "display_name": "LarsS", "link": "https://stackoverflow.com/users/7533100/larss"}, "edited": false, "score": 0, "creation_date": 1516183245, "post_id": 48297563, "comment_id": 83580965, "body": "On closer inspection, <a href=\"https://stackoverflow.com/a/48296580/4604845\">another answer</a> in this thread already solved that problem..."}, {"owner": {"reputation": 3359, "user_id": 4604845, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/88d81c9b06f65d860bb60c31ab062e7e?s=128&d=identicon&r=PG&f=1", "display_name": "Vegard", "link": "https://stackoverflow.com/users/4604845/vegard"}, "reply_to_user": {"reputation": 165, "user_id": 7533100, "user_type": "registered", "accept_rate": 91, "profile_image": "https://graph.facebook.com/10154808286796047/picture?type=large", "display_name": "LarsS", "link": "https://stackoverflow.com/users/7533100/larss"}, "edited": false, "score": 0, "creation_date": 1516183751, "post_id": 48297563, "comment_id": 83581314, "body": "At any rate, the newest update now corrects all instances of the decimal separator"}, {"owner": {"reputation": 165, "user_id": 7533100, "user_type": "registered", "accept_rate": 91, "profile_image": "https://graph.facebook.com/10154808286796047/picture?type=large", "display_name": "LarsS", "link": "https://stackoverflow.com/users/7533100/larss"}, "edited": false, "score": 0, "creation_date": 1516184183, "post_id": 48297563, "comment_id": 83581594, "body": "Thanks, that worked a treat! I had tried to add <code>If Application.DecimalSeparator = &quot;,&quot; Then rng = Replace(rng, &quot;,&quot;, &quot;.&quot;)</code>, but that didn&#39;t work. Your updated code did the trick, though."}], "tags": [], "owner": {"reputation": 3359, "user_id": 4604845, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/88d81c9b06f65d860bb60c31ab062e7e?s=128&d=identicon&r=PG&f=1", "display_name": "Vegard", "link": "https://stackoverflow.com/users/4604845/vegard"}, "is_accepted": true, "score": 1, "last_activity_date": 1516183692, "last_edit_date": 1516183692, "creation_date": 1516181016, "answer_id": 48297563, "question_id": 48296321, "link": "https://stackoverflow.com/questions/48296321/excel-vba-math-type-formula-with-variable-operator-doesnt-work-on-decimal-numbe/48297563#48297563", "title": "Excel VBA math type formula with variable operator doesn&#39;t work on decimal numbers", "body": "<p>What you're looking for is the <a href=\"https://msdn.microsoft.com/en-us/vba/excel-vba/articles/application-evaluate-method-excel\" rel=\"nofollow noreferrer\"><code>Evaluate</code></a> method.</p>\n\n<p>Usage as such:</p>\n\n<pre><code>For Each rng In Selection\n    If WorksheetFunction.IsNumber(rng) Then\n        rng.Value = Evaluate(Replace(rng &amp; expression, \",\", \".\"))\n    End If\nNext rng\n</code></pre>\n\n<p><code>Evaluate</code> accepts the same style of operators as a formula does, at least largely, so if you have <code>A1</code> with value of <code>10</code> and <code>expression=\"+10\"</code>, then <code>Evaluate(Range(\"A1\") &amp; expression</code> would give you <code>20</code>.</p>\n\n<p><code>Replace(rng, \",\", \".\")</code> to convert from European decimals to the US-standard (which VBA uses).</p>\n"}], "owner": {"reputation": 165, "user_id": 7533100, "user_type": "registered", "accept_rate": 91, "profile_image": "https://graph.facebook.com/10154808286796047/picture?type=large", "display_name": "LarsS", "link": "https://stackoverflow.com/users/7533100/larss"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 699, "favorite_count": 0, "accepted_answer_id": 48297563, "answer_count": 3, "score": 2, "last_activity_date": 1516183692, "creation_date": 1516176558, "question_id": 48296321, "link": "https://stackoverflow.com/questions/48296321/excel-vba-math-type-formula-with-variable-operator-doesnt-work-on-decimal-numbe", "title": "Excel VBA math type formula with variable operator doesn&#39;t work on decimal numbers", "body": "<p>I have a small script designed to perform simple math operations where the operator is defined as a variable. The only problem is that it only works on integers, not decimal numbers. Anyone have an idea why?\nI've tried to separate the operator and the number into two variables, but the problem persists.</p>\n\n<pre><code>Sub CellMath2()\nCall CreateSheetBackup\nDim rng As Range\nDim expression As Variant\nexpression = InputBox(\"Enter operator (* / + - ^) and number (e.g. \"\"*1000\"\").\", \"Operator and number\")\nIf StrPtr(expression) = 0 Then Exit Sub\nFor Each rng In Selection\nIf WorksheetFunction.IsNumber(rng) Then\n    rng.Value = \"=\" &amp; rng &amp; expression\n    rng.Value = rng.Value\nElse\nEnd If\nNext rng\nEnd Sub\n</code></pre>\n"}, {"tags": ["java", "excel", "excel-formula", "apache-poi", "vba"], "comments": [{"owner": {"reputation": 3651, "user_id": 5572007, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9dbf6f0e74d31d3cd3300365e899733?s=128&d=identicon&r=PG&f=1", "display_name": "amseager", "link": "https://stackoverflow.com/users/5572007/amseager"}, "edited": false, "score": 0, "creation_date": 1516175698, "post_id": 48296032, "comment_id": 83576692, "body": "check this: <a href=\"https://stackoverflow.com/questions/37660522/limiting-cells-to-only-numeric-values-in-apache-poi\" title=\"limiting cells to only numeric values in apache poi\">stackoverflow.com/questions/37660522/&hellip;</a>"}, {"owner": {"reputation": 5138, "user_id": 7109162, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/eaf2daca9ef0a1751603bd0f707f0139?s=128&d=identicon&r=PG&f=1", "display_name": "XtremeBaumer", "link": "https://stackoverflow.com/users/7109162/xtremebaumer"}, "edited": false, "score": 2, "creation_date": 1516176591, "post_id": 48296032, "comment_id": 83577107, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/37660522/limiting-cells-to-only-numeric-values-in-apache-poi\">Limiting cells to only numeric values in Apache POI</a>"}, {"owner": {"reputation": 3651, "user_id": 5572007, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9dbf6f0e74d31d3cd3300365e899733?s=128&d=identicon&r=PG&f=1", "display_name": "amseager", "link": "https://stackoverflow.com/users/5572007/amseager"}, "reply_to_user": {"reputation": 5138, "user_id": 7109162, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/eaf2daca9ef0a1751603bd0f707f0139?s=128&d=identicon&r=PG&f=1", "display_name": "XtremeBaumer", "link": "https://stackoverflow.com/users/7109162/xtremebaumer"}, "edited": false, "score": 0, "creation_date": 1516187559, "post_id": 48296032, "comment_id": 83583862, "body": "@XtremeBaumer I&#39;ve posted exactly the same link"}, {"owner": {"reputation": 5138, "user_id": 7109162, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/eaf2daca9ef0a1751603bd0f707f0139?s=128&d=identicon&r=PG&f=1", "display_name": "XtremeBaumer", "link": "https://stackoverflow.com/users/7109162/xtremebaumer"}, "edited": false, "score": 0, "creation_date": 1516187684, "post_id": 48296032, "comment_id": 83583932, "body": "there is a difference between posting a link and marking as duplicate"}, {"owner": {"reputation": 3651, "user_id": 5572007, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9dbf6f0e74d31d3cd3300365e899733?s=128&d=identicon&r=PG&f=1", "display_name": "amseager", "link": "https://stackoverflow.com/users/5572007/amseager"}, "reply_to_user": {"reputation": 5138, "user_id": 7109162, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/eaf2daca9ef0a1751603bd0f707f0139?s=128&d=identicon&r=PG&f=1", "display_name": "XtremeBaumer", "link": "https://stackoverflow.com/users/7109162/xtremebaumer"}, "edited": false, "score": 0, "creation_date": 1516197143, "post_id": 48296032, "comment_id": 83590081, "body": "@XtremeBaumer Actually it is not a duplicate. That question was about numeric values, and this is about alphanumeric ones."}, {"owner": {"reputation": 5138, "user_id": 7109162, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/eaf2daca9ef0a1751603bd0f707f0139?s=128&d=identicon&r=PG&f=1", "display_name": "XtremeBaumer", "link": "https://stackoverflow.com/users/7109162/xtremebaumer"}, "edited": false, "score": 0, "creation_date": 1516197389, "post_id": 48296032, "comment_id": 83590234, "body": "it is a duplicate, because the solution is the same"}], "answers": [{"tags": [], "owner": {"reputation": 51, "user_id": 7212849, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/c3fa6613060002ca0663928a0166c564?s=128&d=identicon&r=PG&f=1", "display_name": "Narsingh barik", "link": "https://stackoverflow.com/users/7212849/narsingh-barik"}, "is_accepted": false, "score": 0, "last_activity_date": 1516255623, "creation_date": 1516255623, "answer_id": 48314835, "question_id": 48296032, "link": "https://stackoverflow.com/questions/48296032/restricting-cells-to-accept-only-alphanumeric-values-in-apache-poi/48314835#48314835", "title": "restricting cells to accept only alphanumeric values in Apache POI", "body": "<p>Use this excel formula to achieve this :-</p>\n\n<p><em>=IF(A2=\"\",TRUE,IF(ISERROR(SUMPRODUCT(SEARCH(MID(A2,ROW(INDIRECT(\"1:\"&amp;LEN(A2))),1),\"0123456789abcdefghijklmnopqrstuvwxyz\"))),FALSE,TRUE))</em></p>\n\n<p>here A2 is cell number.</p>\n"}], "owner": {"reputation": 51, "user_id": 7212849, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/c3fa6613060002ca0663928a0166c564?s=128&d=identicon&r=PG&f=1", "display_name": "Narsingh barik", "link": "https://stackoverflow.com/users/7212849/narsingh-barik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 226, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1516255623, "creation_date": 1516175397, "last_edit_date": 1531161705, "question_id": 48296032, "link": "https://stackoverflow.com/questions/48296032/restricting-cells-to-accept-only-alphanumeric-values-in-apache-poi", "title": "restricting cells to accept only alphanumeric values in Apache POI", "body": "<p>How can we restrict the cells to accept only AlphaNumeric(A-Z,a-z,0-9) values ? Is there any class that restricts to only alphanumeric in Apache POI library ?\nor is there any formula to apply  in a particular cell using Apache POI.</p>\n\n<p>Thnak</p>\n"}, {"tags": ["excel", "excel-formula", "excel-2010", "excel-2007", "vba"], "comments": [{"owner": {"reputation": 2749, "user_id": 8532656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ty503.jpg?s=128&g=1", "display_name": "TidyDev", "link": "https://stackoverflow.com/users/8532656/tidydev"}, "edited": false, "score": 0, "creation_date": 1516174093, "post_id": 48295655, "comment_id": 83575919, "body": "What have you tried so far? Stack Overflow isn&#39;t a code writing service."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 2, "creation_date": 1516174175, "post_id": 48295655, "comment_id": 83575961, "body": "Stack Overflow is not Facebook.  Your post should not just be telling us what you are doing today, it should contain a question and details of what you have already done to try and fix the problem yourself."}, {"owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 1, "creation_date": 1516174272, "post_id": 48295655, "comment_id": 83576004, "body": "@YowE3K I think you meant Twitter"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "edited": false, "score": 1, "creation_date": 1516174357, "post_id": 48295655, "comment_id": 83576044, "body": "@K.Davis 162 characters - can&#39;t be Twitter  :D"}, {"owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1516174513, "post_id": 48295655, "comment_id": 83576107, "body": "@YowE3K It&#39;s <a href=\"https://www.washingtonpost.com/news/the-switch/wp/2017/11/07/twitter-is-officially-doubling-the-character-limit-to-280/?utm_term=.359be1b8c328\" rel=\"nofollow noreferrer\">280 Characters now</a>. So it&#39;s perfect for simple Excel formulas."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "edited": false, "score": 1, "creation_date": 1516174582, "post_id": 48295655, "comment_id": 83576140, "body": "@K.Davis  :O Twice as much reason to not have an account!"}, {"owner": {"reputation": 4239, "user_id": 6480658, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/79a2edab9dc17e4c66e1d91ebe7a40f7?s=128&d=identicon&r=PG&f=1", "display_name": "jamheadart", "link": "https://stackoverflow.com/users/6480658/jamheadart"}, "edited": false, "score": 0, "creation_date": 1516175143, "post_id": 48295655, "comment_id": 83576431, "body": "I love these posts. I really love the fact someone thinks it&#39;s as easy as this."}, {"owner": {"reputation": 3907, "user_id": 4961700, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f80e4233c80b9ba42b3b39cf704804dc?s=128&d=identicon&r=PG&f=1", "display_name": "Solar Mike", "link": "https://stackoverflow.com/users/4961700/solar-mike"}, "edited": false, "score": 0, "creation_date": 1516183984, "post_id": 48295655, "comment_id": 83581491, "body": "Edit / Replace could do this..."}], "answers": [{"tags": [], "owner": {"reputation": 21, "user_id": 9228067, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-4vm531POjA0/AAAAAAAAAAI/AAAAAAAAAPs/_sW-0A7ZP2M/photo.jpg?sz=128", "display_name": "mayur shahasane", "link": "https://stackoverflow.com/users/9228067/mayur-shahasane"}, "is_accepted": false, "score": -1, "last_activity_date": 1516180215, "last_edit_date": 1516180215, "creation_date": 1516178422, "answer_id": 48296828, "question_id": 48295655, "link": "https://stackoverflow.com/questions/48295655/replacing-data-in-many-column-in-excel/48296828#48296828", "title": "Replacing data in many column in excel", "body": "<p>You may use Index Match to solve your issue check this image</p>\n\n<p>Index Match image:</p>\n\n<p><a href=\"https://i.stack.imgur.com/M1CNv.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/M1CNv.png\" alt=\"Index Match image\"></a></p>\n"}], "owner": {"reputation": 1, "user_id": 9218112, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fee72ed748d46556630007787658da33?s=128&d=identicon&r=PG&f=1", "display_name": "ajoshi", "link": "https://stackoverflow.com/users/9218112/ajoshi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 54, "favorite_count": 0, "answer_count": 1, "score": -6, "last_activity_date": 1516180215, "creation_date": 1516173815, "last_edit_date": 1531161705, "question_id": 48295655, "link": "https://stackoverflow.com/questions/48295655/replacing-data-in-many-column-in-excel", "title": "Replacing data in many column in excel", "body": "<p>I have two excel file \n(1) contain many group names in many column .\n(2) contain group name with group id \n i need to replace all group name in sheet 1 with group id </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1516171349, "post_id": 48294980, "comment_id": 83574661, "body": "Google &quot;<code>Paste Values Excel VBA</code>&quot;."}], "answers": [{"comments": [{"owner": {"reputation": 99, "user_id": 8674458, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/7e28e5e9a5d6d1fc5dab176ef6b44648?s=128&d=identicon&r=PG&f=1", "display_name": "wt1155", "link": "https://stackoverflow.com/users/8674458/wt1155"}, "edited": false, "score": 0, "creation_date": 1516171758, "post_id": 48295065, "comment_id": 83574825, "body": "but my workbooks each have different sheet names according to the product number is there any way to change it ?"}, {"owner": {"reputation": 495, "user_id": 7747433, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/JkdzF.jpg?s=128&g=1", "display_name": "nishit dey", "link": "https://stackoverflow.com/users/7747433/nishit-dey"}, "reply_to_user": {"reputation": 99, "user_id": 8674458, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/7e28e5e9a5d6d1fc5dab176ef6b44648?s=128&d=identicon&r=PG&f=1", "display_name": "wt1155", "link": "https://stackoverflow.com/users/8674458/wt1155"}, "edited": false, "score": 0, "creation_date": 1516171873, "post_id": 48295065, "comment_id": 83574870, "body": "You will need to give the sheet name or reference.. i just gave you a path, now you will have to adjust as per your requirements. Keep learning. :)"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1516172277, "post_id": 48295065, "comment_id": 83575039, "body": "Aren&#39;t the limits of the original defined by the last populated cell in column A?"}, {"owner": {"reputation": 495, "user_id": 7747433, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/JkdzF.jpg?s=128&g=1", "display_name": "nishit dey", "link": "https://stackoverflow.com/users/7747433/nishit-dey"}, "edited": false, "score": 0, "creation_date": 1516173887, "post_id": 48295065, "comment_id": 83575827, "body": "all i took the reference from the Coloumn B and C, and assumed that the the values in Column B is non blank and kept that as a Unique column."}], "tags": [], "owner": {"reputation": 495, "user_id": 7747433, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/JkdzF.jpg?s=128&g=1", "display_name": "nishit dey", "link": "https://stackoverflow.com/users/7747433/nishit-dey"}, "is_accepted": false, "score": 0, "last_activity_date": 1516171408, "creation_date": 1516171408, "answer_id": 48295065, "question_id": 48294980, "link": "https://stackoverflow.com/questions/48294980/changing-excel-formula-result-to-value/48295065#48295065", "title": "Changing excel formula result to value", "body": "<p>Try this:</p>\n\n<pre><code>        With Workbooks.Open(FolderName &amp; Fname)\n         Do until Sheet1.Cells(x,2) = \"\"\n           Sheet1.cells(x,4) = Sheet1.cells(x,2) &amp; \" | QTY: \" &amp; SHeet1.cells(x,3)\n         x =x +1\n         Loop\n          .Save\n          .Close\n    End With\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 99, "user_id": 8674458, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/7e28e5e9a5d6d1fc5dab176ef6b44648?s=128&d=identicon&r=PG&f=1", "display_name": "wt1155", "link": "https://stackoverflow.com/users/8674458/wt1155"}, "edited": false, "score": 0, "creation_date": 1516175574, "post_id": 48295266, "comment_id": 83576629, "body": "I just realized there a type mismatch error if there is a only a single value present"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 99, "user_id": 8674458, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/7e28e5e9a5d6d1fc5dab176ef6b44648?s=128&d=identicon&r=PG&f=1", "display_name": "wt1155", "link": "https://stackoverflow.com/users/8674458/wt1155"}, "edited": false, "score": 0, "creation_date": 1516176440, "post_id": 48295266, "comment_id": 83577027, "body": "see alternative above"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 1, "last_activity_date": 1516176425, "last_edit_date": 1516176425, "creation_date": 1516172202, "answer_id": 48295266, "question_id": 48294980, "link": "https://stackoverflow.com/questions/48294980/changing-excel-formula-result-to-value/48295266#48295266", "title": "Changing excel formula result to value", "body": "<p>Try it using the parent workbook/worksheet you set up..</p>\n\n<pre><code>    With Workbooks.Open(FolderName &amp; Fname)\n        with .worksheets(1)\n            with .Range(.cells(2, \"d\"), .Cells(.Rows.Count, 1).End(xlUp).offset(0, 3))\n                .formula = \"=$B2 &amp; \"\" \"\" &amp; \"\"|\"\" &amp; \"\"QTY: \"\" &amp; $C2\"\n                .offset(0, -2) = .value\n            end with\n            .columns(\"c:d\").entirecolumn.delete\n        end with\n        .Save\n        .Close\n    End With\n</code></pre>\n"}], "owner": {"reputation": 99, "user_id": 8674458, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/7e28e5e9a5d6d1fc5dab176ef6b44648?s=128&d=identicon&r=PG&f=1", "display_name": "wt1155", "link": "https://stackoverflow.com/users/8674458/wt1155"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 138, "favorite_count": 0, "accepted_answer_id": 48295266, "answer_count": 2, "score": -1, "last_activity_date": 1516176425, "creation_date": 1516171085, "last_edit_date": 1516171644, "question_id": 48294980, "link": "https://stackoverflow.com/questions/48294980/changing-excel-formula-result-to-value", "title": "Changing excel formula result to value", "body": "<p>I managed to run a macro that uses a formula to merge the value of column B and column C and saving the formula result to column D, but is there any method to change the formula to value and paste it to column B, deleting column C and column D. Below is the code used:</p>\n\n<pre><code>Sub LoopThroughFilesMergingFormula()\n\n    'paste the specified directory to FolderName\n    FolderName = \"C:\\Users\\Desktop\\formula merge\"\n    If Right(FolderName, 1) &lt;&gt; Application.PathSeparator Then FolderName = FolderName &amp; Application.PathSeparator\n    Fname = Dir(FolderName &amp; \"*.xlsx\")\n\n    'loop through the files\n    Do While Len(Fname)\n\n        With Workbooks.Open(FolderName &amp; Fname)\n             Range(\"D2\").Formula = \"=$B2 &amp; \"\" \"\" &amp; \"\"|\"\" &amp; \"\"QTY: \"\" &amp; $C2\"\n             Range(\"D2\", \"D\" &amp; Cells(Rows.Count, 1).End(xlUp).Row).FillDown\n         .Save\n         .Close\n        End With\n\n        ' go to the next file in the folder\n        Fname = Dir\n\n    Loop\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "runtime-error"], "comments": [{"owner": {"reputation": 495, "user_id": 7747433, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/JkdzF.jpg?s=128&g=1", "display_name": "nishit dey", "link": "https://stackoverflow.com/users/7747433/nishit-dey"}, "edited": false, "score": 0, "creation_date": 1516171085, "post_id": 48294946, "comment_id": 83574565, "body": "You need to open the Xy.xlsx to access that."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 1, "creation_date": 1516171210, "post_id": 48294946, "comment_id": 83574611, "body": "1. You cannot select a range until you select the parent worksheet. 2. <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba/28700020#28700020\">How to avoid using Select in Excel VBA</a>"}, {"owner": {"reputation": 191, "user_id": 5658623, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/589f4ad1339d6763ea2cd54aa2cc5bdd?s=128&d=identicon&r=PG&f=1", "display_name": "yashika vaish", "link": "https://stackoverflow.com/users/5658623/yashika-vaish"}, "edited": false, "score": 0, "creation_date": 1516172244, "post_id": 48294946, "comment_id": 83575011, "body": "XY workbook is already open and I have tried wb.Worksheets(&quot;A&quot;).Rows(&quot;1:1&quot;).Select also, It is also giving me the same error."}, {"owner": {"reputation": 191, "user_id": 5658623, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/589f4ad1339d6763ea2cd54aa2cc5bdd?s=128&d=identicon&r=PG&f=1", "display_name": "yashika vaish", "link": "https://stackoverflow.com/users/5658623/yashika-vaish"}, "edited": false, "score": 0, "creation_date": 1516172312, "post_id": 48294946, "comment_id": 83575060, "body": "Every time I am trying to select worksheet using wb, It is giving an error but without selecting worksheet, neither I can select rows or any range."}], "answers": [{"comments": [{"owner": {"reputation": 2265, "user_id": 5958842, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d6891cdbf84d1fab53a0d73b05ee467?s=128&d=identicon&r=PG", "display_name": "DecimalTurn", "link": "https://stackoverflow.com/users/5958842/decimalturn"}, "reply_to_user": {"reputation": 191, "user_id": 5658623, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/589f4ad1339d6763ea2cd54aa2cc5bdd?s=128&d=identicon&r=PG&f=1", "display_name": "yashika vaish", "link": "https://stackoverflow.com/users/5658623/yashika-vaish"}, "edited": false, "score": 0, "creation_date": 1516214971, "post_id": 48295155, "comment_id": 83601343, "body": "I&#39;ve adjusted my answer to account for the workbook as well."}], "tags": [], "owner": {"reputation": 2265, "user_id": 5958842, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d6891cdbf84d1fab53a0d73b05ee467?s=128&d=identicon&r=PG", "display_name": "DecimalTurn", "link": "https://stackoverflow.com/users/5958842/decimalturn"}, "is_accepted": true, "score": 1, "last_activity_date": 1586850501, "last_edit_date": 1586850501, "creation_date": 1516171761, "answer_id": 48295155, "question_id": 48294946, "link": "https://stackoverflow.com/questions/48294946/vba-code-getting-error-select-method-of-range-class-failed/48295155#48295155", "title": "Vba code getting error &quot;select method of range class failed&quot;", "body": "<p>When you want to use the <code>.Select</code> method on a range, you have to make sure that both the corresponding <strong>workbook</strong> and <strong>worksheet</strong> are activated (in that order).</p>\n\n<pre><code>wb.Activate\nws11111.Activate\nws11111.Rows(\"1:1\").Select\n</code></pre>\n\n<p>As you can see, the use of the <code>.Select</code> method can be a little tedious and it is also slow. This is why I would suggest you to have a look at this question, when you have the chance: <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba?rq=1\">How to avoid using Select in Excel VBA</a>.</p>\n"}], "owner": {"reputation": 191, "user_id": 5658623, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/589f4ad1339d6763ea2cd54aa2cc5bdd?s=128&d=identicon&r=PG&f=1", "display_name": "yashika vaish", "link": "https://stackoverflow.com/users/5658623/yashika-vaish"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1250, "favorite_count": 0, "accepted_answer_id": 48295155, "answer_count": 1, "score": 1, "last_activity_date": 1586850501, "creation_date": 1516170941, "last_edit_date": 1586815226, "question_id": 48294946, "link": "https://stackoverflow.com/questions/48294946/vba-code-getting-error-select-method-of-range-class-failed", "title": "Vba code getting error &quot;select method of range class failed&quot;", "body": "<p>In the code below, I am getting an error \"<code>Select Method of Range Class Failed</code>\" on the line bracketed by comments. </p>\n\n<p>I am trying to copy some fixed ranges from <code>Worksheet A</code> of <code>Workbook XY</code> into <code>Worksheet A</code> of <em>all</em> the open workbooks.  Kindly help me with the issues. Also, suggest a better or optimized way of doing the same.</p>\n\n<pre><code>Sub Macro1()\n    Dim wbs As Workbooks\n    Dim wb As Workbook\n    Dim ws11111 As Worksheet\n    Set wbs = Application.Workbooks\n    For Each wb In wbs\n    Set ws11111 = wb.Worksheets(\"A\")\n\n  '' ERROR BREAKS ON NEXT LINE:\n    wb.Worksheets(\"A\").Rows(\"1:1\").Select\n  '' ERROR: \"Select Method of Range Class Failed\"\n\n    Selection.Insert Shift:=xlDown, CopyOrigin:=xlFormatFromLeftOrAbove\n    Selection.Insert Shift:=xlDown, CopyOrigin:=xlFormatFromLeftOrAbove\n    Selection.Insert Shift:=xlDown, CopyOrigin:=xlFormatFromLeftOrAbove\n    Selection.Insert Shift:=xlDown, CopyOrigin:=xlFormatFromLeftOrAbove\n    Selection.Insert Shift:=xlDown, CopyOrigin:=xlFormatFromLeftOrAbove\n    Selection.Insert Shift:=xlDown, CopyOrigin:=xlFormatFromLeftOrAbove\n    Selection.Insert Shift:=xlDown, CopyOrigin:=xlFormatFromLeftOrAbove\n    Next wb\n    Windows(\"XY.xlsx\").Activate\n    Worksheets(\"A\").Select\n    Workbooks(\"XY.xlsx\").Worksheets(\"A\").Range(\"E2:M6\").Select\n    Selection.Copy\n    For Each wb In wbs\n        wb.Worksheets(\"A\").Range(\"E2:M6\").Select\n        ActiveSheet.Paste\n    Next wb\n    Windows(\"XY.xlsx\").Activate\n    Worksheets(\"A\").Select\n    Workbooks(\"XY.xlsx\").Worksheets(\"A\").Columns(\"D:D\").Select\n    Application.CutCopyMode = False\n    Selection.Delete Shift:=xlToLeft\n    Workbooks(\"XY.xlsx\").Worksheets(\"A\").Rows(\"9:9\").Select\n    Selection.Copy\n    For Each wb In wbs\n        wb.Worksheets(\"A\").Rows(\"8:8\").Select\n        ActiveSheet.Paste\n    Next wb\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "adodb", "vba"], "comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1516173275, "post_id": 48294900, "comment_id": 83575546, "body": "Code works for me.  (I am using Excel 2016, but I haven&#39;t heard of this issue before even in earlier versions.)  Is there something about your source data that is causing the problem?"}, {"owner": {"reputation": 56, "user_id": 7979126, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154854548688052/picture?type=large", "display_name": "Floben Moro", "link": "https://stackoverflow.com/users/7979126/floben-moro"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1516176503, "post_id": 48294900, "comment_id": 83577058, "body": "After a bunch of trial and error I have found out that left side column can be set at a maximum = &quot;H&quot; (8th column). The right column can be a maximum = &quot;IV&quot; (256th column)."}, {"owner": {"reputation": 56, "user_id": 7979126, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154854548688052/picture?type=large", "display_name": "Floben Moro", "link": "https://stackoverflow.com/users/7979126/floben-moro"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1516176935, "post_id": 48294900, "comment_id": 83577279, "body": "For excel versions beyond 97-2003, left column can be set at maximum = &quot;D&quot; (4th column)."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1516176946, "post_id": 48294900, "comment_id": 83577286, "body": "Yes - there is a maximum of 256 columns (16-bit hangover, just like <a href=\"https://stackoverflow.com/q/38650103/6535336\">my question</a> caused by row 65536), but there is no reason why Z:AA shouldn&#39;t work.  That&#39;s only two columns."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1516177077, "post_id": 48294900, "comment_id": 83577348, "body": "You originally said that just selecting column Z worked for you.  Has that now stopped working?"}, {"owner": {"reputation": 56, "user_id": 7979126, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154854548688052/picture?type=large", "display_name": "Floben Moro", "link": "https://stackoverflow.com/users/7979126/floben-moro"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1516177133, "post_id": 48294900, "comment_id": 83577379, "body": "I&#39;m new to this. I will check further. I don&#39;t see any problem with the source data."}, {"owner": {"reputation": 56, "user_id": 7979126, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154854548688052/picture?type=large", "display_name": "Floben Moro", "link": "https://stackoverflow.com/users/7979126/floben-moro"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1516177225, "post_id": 48294900, "comment_id": 83577423, "body": "Yes it stopped working. or maybe I have just overlooked previously. I&#39;m not sure what is happening. I&#39;ll try a different computer later. I&#39;m still doing tons of trial and error."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1516177475, "post_id": 48294900, "comment_id": 83577558, "body": "Set your &quot;ADO Test2.xlsm&quot; spreadsheet up to just have data in cells Z1:AA10 - just something simple like the numbers 1 to 10 in column Z and 11 to 20 in column AA.  See if that works with the code you posted.  If that does work (that&#39;s what worked for me), try gradually changing your data to be what is in your real data sheet, e.g. add extra rows if that is in your real data, add extra columns to the left, add extra columns to the right, add headers, etc, etc.  Try to see when it breaks.  Then reverse that change and see whether it still works.  That will narrow the problem."}, {"owner": {"reputation": 56, "user_id": 7979126, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154854548688052/picture?type=large", "display_name": "Floben Moro", "link": "https://stackoverflow.com/users/7979126/floben-moro"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1516177572, "post_id": 48294900, "comment_id": 83577612, "body": "wow that just worked. Thank you YowE3k. I didn&#39;t know having data in the cell have an effect."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1516178574, "post_id": 48294900, "comment_id": 83578163, "body": "Ohh - you were trying without data?!?  Yes, that would <b>definitely</b> have an effect."}, {"owner": {"reputation": 56, "user_id": 7979126, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154854548688052/picture?type=large", "display_name": "Floben Moro", "link": "https://stackoverflow.com/users/7979126/floben-moro"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1516179630, "post_id": 48294900, "comment_id": 83578773, "body": "It has data. But only up to column H. Maybe I have pasted some data up to Z during the first run. I made lots of trial and error and I lost track of what I&#39;m changing. Because I succeeded in setting the right side column beyond H (even without data) it made me believe that data in the sheets doesn&#39;t have any effect."}], "owner": {"reputation": 56, "user_id": 7979126, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154854548688052/picture?type=large", "display_name": "Floben Moro", "link": "https://stackoverflow.com/users/7979126/floben-moro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 175, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1516176026, "creation_date": 1516170756, "last_edit_date": 1531164843, "question_id": 48294900, "link": "https://stackoverflow.com/questions/48294900/adodb-recordset-error-when-range-column-is-beyond-z", "title": "ADODB Recordset error when Range Column is beyond &quot;Z&quot;", "body": "<p>I am using ADODB to get data from a closed excel file. I get an error when I use columns beyond column Z in my query.</p>\n\n<pre><code>Sub TestExcelWB()\n\nDim cn As Object\nDim szConnect As String\nDim SourceFile As String\nDim SourceSheet As String\nDim SourceRange As String\nDim rsData As Object\n\n\n\n'-----For ADODB connection-----\nSourceFile = ThisWorkbook.Path &amp; \"\\ADO Test2.xlsm\"\n\nszConnect = \"Provider=Microsoft.ACE.OLEDB.12.0;\" &amp; _\n        \"Data Source=\" &amp; SourceFile &amp; \";\" &amp; _\n        \"Extended Properties=\"\"Excel 12.0;HDR=No\"\";\"\n\nSet cn = CreateObject(\"ADODB.Connection\")\ncn.Open szConnect\n'---^^\n\n\n\n'-----For Recordset-----\nSet rsData = CreateObject(\"ADODB.Recordset\")\n\nSourceSheet = \"Sheet1\"\nSourceRange = \"Z1:AA10\"\nszSQL2 = \"SELECT * FROM [\" &amp; SourceSheet$ &amp; \"$\" &amp; SourceRange$ &amp; \"];\"\n\nrsData.Open szSQL2, cn, 0, 1, 1\n'---^^\n\n\n\ncn.Close\n\nEnd Sub\n</code></pre>\n\n<p>When I change the variable SourceRange = \"A1:Z10\" then there is no error. Is this a limit of the provider. Is there a way around this?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1516171192, "post_id": 48294867, "comment_id": 83574606, "body": "Welcome! (+Well written question, thanks!)  I&#39;m a fan of Excel and it&#39;s countless capabilities but this is one of the times my first thought is...  What you want is very do-able, but when you start using Excel as a database you may be better off to switch to Access.  Access is as easy (or easier) than Excel to learn, and everyone who has Excel probably has Access, which is designed specifically for these kinds of tasks.  Forms are more user friendly, data is easier to store &amp; share in an organized and secure manner, corruption is far less likely, and scale-ability is practically unlimited."}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1516171281, "post_id": 48294867, "comment_id": 83574638, "body": "...however 100% of the times I suggest that, there are reasons that the person doesn&#39;t want to use Access.  I don&#39;t have time to look at your question in depth but I&#39;m sure someone will have a solution for you... but not as easy as unique field names would be in Access.  :-)"}, {"owner": {"reputation": 21, "user_id": 9201961, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/494ce4d448c098dbcbdc3a4698ba3145?s=128&d=identicon&r=PG&f=1", "display_name": "Maartin", "link": "https://stackoverflow.com/users/9201961/maartin"}, "reply_to_user": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1516171859, "post_id": 48294867, "comment_id": 83574868, "body": "Thank You ashleedawg for your quick comment! :) Unfortunatelly I can use only Excel and migrate to Access is not a solution for me at the moment. Unique field names are not so important as specific numbers for now if it is so complicated to make."}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1516171988, "post_id": 48294867, "comment_id": 83574906, "body": "There&#39;s always a reason.  :-)  Where are the ticket numbers stored?  I assume in column <code>B</code> of <code>Sheets(&quot;Issue Log&quot;)</code>?  If so, is it fair to say that the next ticket number would be the [<code>MAX</code> value in column <code>B</code>] <code>+ 1</code>?"}, {"owner": {"reputation": 21, "user_id": 9201961, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/494ce4d448c098dbcbdc3a4698ba3145?s=128&d=identicon&r=PG&f=1", "display_name": "Maartin", "link": "https://stackoverflow.com/users/9201961/maartin"}, "reply_to_user": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1516179591, "post_id": 48294867, "comment_id": 83578756, "body": "They can be stored in other sheet, for example &quot;Sheet2&quot; or &quot;Internal&quot;, not the same where I want to manage tickets."}, {"owner": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "edited": false, "score": 0, "creation_date": 1516184338, "post_id": 48294867, "comment_id": 83581691, "body": "I think you should open different questions for every of your needs. 1 for the last row thing, 1 for concatenating stuff, and more."}, {"owner": {"reputation": 21, "user_id": 9201961, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/494ce4d448c098dbcbdc3a4698ba3145?s=128&d=identicon&r=PG&f=1", "display_name": "Maartin", "link": "https://stackoverflow.com/users/9201961/maartin"}, "reply_to_user": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "edited": false, "score": 0, "creation_date": 1516248729, "post_id": 48294867, "comment_id": 83613145, "body": "@FoxfireAndBurnsAndBurns I&#39;m not sure about what you writed. Can you advise what you mean by &quot;open different questions&quot;?"}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 9201961, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/494ce4d448c098dbcbdc3a4698ba3145?s=128&d=identicon&r=PG&f=1", "display_name": "Maartin", "link": "https://stackoverflow.com/users/9201961/maartin"}, "edited": false, "score": 0, "creation_date": 1516179808, "post_id": 48295213, "comment_id": 83578872, "body": "Hello sporc, it looks very nice and useful in UserForm just I was looking for! Unfortunatelly there is showing me some kind of error, when I want to click &quot;Create&quot; button: &quot;Run-time error &#39;13&#39;: Type mismatch&quot;?"}], "tags": [], "owner": {"reputation": 377, "user_id": 8249645, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/83ce2465fde8b4c0779205788997b91f?s=128&d=identicon&r=PG", "display_name": "sporc", "link": "https://stackoverflow.com/users/8249645/sporc"}, "is_accepted": false, "score": 0, "last_activity_date": 1516172007, "creation_date": 1516172007, "answer_id": 48295213, "question_id": 48294867, "link": "https://stackoverflow.com/questions/48294867/how-to-add-specific-number-in-last-row-from-userform-using-vba/48295213#48295213", "title": "How to add specific number in last row from UserForm using VBA?", "body": "<p>You can concatenate strings with the <code>&amp;</code> symbol. Hence a possible solution for your needs would be:</p>\n\n<pre><code>Me.tbTicketNo.Value = \"[BHD#\" &amp; Format(LastRow,\"00000\") &amp;\"]\"\n</code></pre>\n\n<p>The <code>Format(LastRow, \"00000\")</code> makes the value always five digits long. With <code>LastRow=1</code> the output would be <code>[BHD#00001]</code>.</p>\n\n<p>If you want to start by a value of <code>60555</code> than just add this value</p>\n\n<pre><code>Me.tbTicketNo.Value = \"[BHD#\" &amp; 60555+LastRow &amp;\"]\"\n</code></pre>\n\n<p>With <code>LastRow=1</code> the output would be <code>[BHD#60556]</code></p>\n"}], "owner": {"reputation": 21, "user_id": 9201961, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/494ce4d448c098dbcbdc3a4698ba3145?s=128&d=identicon&r=PG&f=1", "display_name": "Maartin", "link": "https://stackoverflow.com/users/9201961/maartin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 149, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1516172007, "creation_date": 1516170612, "last_edit_date": 1531164843, "question_id": 48294867, "link": "https://stackoverflow.com/questions/48294867/how-to-add-specific-number-in-last-row-from-userform-using-vba", "title": "How to add specific number in last row from UserForm using VBA?", "body": "<p>I am the beginner of VBA and need some help from you in code.</p>\n\n<p>My problem is that I want to make some kind of UserForm using VBA in Excel to generate new numbers for new ticket.</p>\n\n<p>The UserForm will be needed to manage tickets about received problems.</p>\n\n<p>The case is that I want to make new number of ticket by clicking button \"New Ticket\". After that, in UserForm, the \"Ticket Number\" field will be blocked and show assigned new ticket number, \"Date Opened\" field will show current date automatically and \"Accept\" button will change text to \"Create\" button and will be enabled. After clicking \"Create\" button, UserForm will close and write line about ticket with details in last row in Excel sheet.</p>\n\n<p>I also want to have ticket number starting with specific number e.g. 60555, 60556, 60557 etc. The problem is that now I am receiving numbers 1, 2, 3 etc.</p>\n\n<p>Below you can see some screenshots of problem and part of created code.</p>\n\n<p><a href=\"https://i.stack.imgur.com/Mk15U.png\" rel=\"nofollow noreferrer\">UserForm \"Manage Tickets\"</a></p>\n\n<p><a href=\"https://i.stack.imgur.com/DVmvj.png\" rel=\"nofollow noreferrer\">After \"Create\" button, what is showing in last row in Excel Sheet</a></p>\n\n<p><a href=\"https://i.stack.imgur.com/6MKuL.png\" rel=\"nofollow noreferrer\">What I want to show in last row in Excel Sheet after \"Create\" button</a></p>\n\n<p>If there is a way also to show text \"<strong>[BHD#?????]</strong>\" in UserForm and add it by UserForm, it will be very helpful for me!</p>\n\n<p>Part of code which is responsible for \"New Ticket\" button:</p>\n\n<pre><code>Private Sub btwNewTicket_Click()\n    ClearFields\n    LastRow = ThisWorkbook.Sheets(\"Issue Log\").Cells(Rows.Count, 2).End(xlUp).End(xlUp).Row - 4\n    Me.tbTicketNo.Value = LastRow\n    Me.tbTicketNo.Locked = True\n    Me.tbDateOpen = Date\n    Me.btnAccept.Caption = \"Create\"\n    Me.btnAccept.Enabled = True\nEnd Sub\n</code></pre>\n\n<p>Thanks in advance!</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2265, "user_id": 5958842, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d6891cdbf84d1fab53a0d73b05ee467?s=128&d=identicon&r=PG", "display_name": "DecimalTurn", "link": "https://stackoverflow.com/users/5958842/decimalturn"}, "edited": false, "score": 0, "creation_date": 1516167218, "post_id": 48294051, "comment_id": 83573291, "body": "Add a point like this <code>.Range(Cells(2, 1), Cells(lr, 5)).Clear</code>"}], "answers": [{"comments": [{"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1516190242, "post_id": 48294607, "comment_id": 83585571, "body": "You forgot associate the cells within the range definition as well.  <code>.Range(Cells(2, 1), Cells(lr, 5))</code> will mean the <code>Range</code> on the <code>Found</code> sheet using the <code>Cells</code> on the currently active sheet (which will throw an error if they&#39;re different).  You&#39;ll need <code>.Range(.Cells(2, 1), .Cells(lr, 5))</code>.  Also worth changing <code>Rows.Count</code> to <code>.Rows.Count</code> in case the active sheet is in Excel 2007+ (1048576 rows) and <code>Found</code> is in Excel 2003 (65536 rows) - again, the discrepancy will cause an error."}, {"owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "reply_to_user": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1516199394, "post_id": 48294607, "comment_id": 83591609, "body": "@DarrenBartrup-Cook Thank you!"}], "tags": [], "owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "is_accepted": false, "score": 1, "last_activity_date": 1516199361, "last_edit_date": 1516199361, "creation_date": 1516169349, "answer_id": 48294607, "question_id": 48294051, "link": "https://stackoverflow.com/questions/48294051/vba-code-for-excel-range-on-other-sheet/48294607#48294607", "title": "vba code for excel range on other sheet", "body": "<p>Minor typo when referring to your worksheet object.</p>\n\n<p>On line 3, you didn't associate your Range with <code>Sheets(\"Found\")</code> because you are missing the <code>.</code> in front of <code>Range(Cells(2, 1), cELLS(LR, 5)).Clear</code>.</p>\n\n<p>Should look like this:</p>\n\n<pre><code>With Sheets(\"Found\")\n  lr = .Range(\"A\" &amp; .Rows.Count).End(xlUp).Row\n  .Range(.Cells(2, 1), .Cells(lr, 5)).Clear\nEnd With\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 9227288, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6b0223a8f98d59bb29749b93b293fbac?s=128&d=identicon&r=PG&f=1", "display_name": "Henry", "link": "https://stackoverflow.com/users/9227288/henry"}, "edited": false, "score": 0, "creation_date": 1516224532, "post_id": 48299314, "comment_id": 83606311, "body": "Thank you so much Davis and Lee! The code with period works."}], "tags": [], "owner": {"reputation": 7206, "user_id": 8107092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dce232725da0108d5e43f3eebcaddd91?s=128&d=identicon&r=PG&f=1", "display_name": "Dy.Lee", "link": "https://stackoverflow.com/users/8107092/dy-lee"}, "is_accepted": false, "score": 2, "last_activity_date": 1516186295, "creation_date": 1516186295, "answer_id": 48299314, "question_id": 48294051, "link": "https://stackoverflow.com/questions/48294051/vba-code-for-excel-range-on-other-sheet/48299314#48299314", "title": "vba code for excel range on other sheet", "body": "<p>Put a period.</p>\n\n<pre><code>With Sheets(\"Found\")\n  lr = .Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n  .Range(.Cells(2, 1), .Cells(lr, 5)).Clear\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 9227288, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6b0223a8f98d59bb29749b93b293fbac?s=128&d=identicon&r=PG&f=1", "display_name": "Henry", "link": "https://stackoverflow.com/users/9227288/henry"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 64, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1516199361, "creation_date": 1516166304, "last_edit_date": 1531164843, "question_id": 48294051, "link": "https://stackoverflow.com/questions/48294051/vba-code-for-excel-range-on-other-sheet", "title": "vba code for excel range on other sheet", "body": "<p>I try to use below VBA code to delete a range of data on other sheet, but it deleted data on sheet1 instead. Can someone help for this?</p>\n\n<pre><code>With Sheets(\"Found\")\n  lr = .Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n  Range(Cells(2, 1), Cells(lr, 5)).Clear\nEnd With\n</code></pre>\n\n<p>Thanks</p>\n"}, {"tags": ["vba", "excel", "pdf", "printing"], "comments": [{"owner": {"reputation": 2538, "user_id": 6388698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7gWUL.png?s=128&g=1", "display_name": "GMalc", "link": "https://stackoverflow.com/users/6388698/gmalc"}, "edited": false, "score": 2, "creation_date": 1516161392, "post_id": 48293262, "comment_id": 83571722, "body": "Combine all your ranges into one worksheet, then print the worksheet to a .pdf"}], "answers": [{"tags": [], "owner": {"reputation": 11963, "user_id": 2707864, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/LYdpu.png?s=128&g=1", "display_name": "sancho.s ReinstateMonicaCellio", "link": "https://stackoverflow.com/users/2707864/sancho-s-reinstatemonicacellio"}, "is_accepted": false, "score": 0, "last_activity_date": 1516165401, "creation_date": 1516165401, "answer_id": 48293916, "question_id": 48293262, "link": "https://stackoverflow.com/questions/48293262/print-multiple-ranges-from-multiple-sheets-to-pdf/48293916#48293916", "title": "Print multiple ranges from multiple sheets to PDF", "body": "<p>You could use two alternative strategies:</p>\n\n<ol>\n<li><a href=\"https://stackoverflow.com/questions/13073888/vba-script-that-saves-excel-range-as-pdf\">Export each range to pdf</a> using a sequence of file names.</li>\n<li>Concatenate all pdf files, with some tool (e.g., <a href=\"https://www.pdflabs.com/tools/pdftk-the-pdf-toolkit/\" rel=\"nofollow noreferrer\">pdftk</a>).</li>\n</ol>\n\n<p>or</p>\n\n<ol>\n<li>Create a sequence of worksheets, one for each range you want to print. You can do this by duplicating the source worksheet and either removing what you do not need, or if that introduces formula errors or other issues  setting the print area.</li>\n<li>Form an array with the names of the worksheets, and <a href=\"https://social.msdn.microsoft.com/Forums/office/en-US/5b5dff10-d3ef-44c0-84a0-dadb391f9c59/loop-to-append-pdf?forum=exceldev\" rel=\"nofollow noreferrer\">printout the array</a>.</li>\n</ol>\n"}, {"tags": [], "owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "is_accepted": false, "score": 0, "last_activity_date": 1516242041, "creation_date": 1516242041, "answer_id": 48312863, "question_id": 48293262, "link": "https://stackoverflow.com/questions/48293262/print-multiple-ranges-from-multiple-sheets-to-pdf/48312863#48312863", "title": "Print multiple ranges from multiple sheets to PDF", "body": "<p>How about this option?</p>\n\n<pre><code>Sub CreatePDF()\n\n    ActiveWorkbook.Sheets(Array(\"Sheet1\", \"Sheet2\", \"Sheet3\")).Select\n\n    Sheets(\"Sheet1\").Activate\n\n    ActiveSheet.ExportAsFixedFormat _\n            Type:=xlTypePDF, _\n            Filename:=\"C:\\temp.pdf\", _\n            Quality:=xlQualityStandard, _\n            IncludeDocProperties:=True, _\n            IgnorePrintAreas:=False, _\n            OpenAfterPublish:=True\n\n    Sheets(\"Sheet1\").Select\n    Range(\"A1\").Select\n\nEnd Sub\n</code></pre>\n\n<p>I'm pretty sure there are ways to customize it, and/or enhance it.</p>\n"}], "owner": {"reputation": 1, "user_id": 9227085, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddfaa81d5c81a04eb916a73759224b33?s=128&d=identicon&r=PG&f=1", "display_name": "Dean", "link": "https://stackoverflow.com/users/9227085/dean"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1188, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1516242041, "creation_date": 1516160664, "question_id": 48293262, "link": "https://stackoverflow.com/questions/48293262/print-multiple-ranges-from-multiple-sheets-to-pdf", "title": "Print multiple ranges from multiple sheets to PDF", "body": "<p>I've done a lot of research on this site and haven't found a solution to my problem. I have a workbook with multiple sheets that have specific ranges that need to be printed. Unfortunately these ranges need to printed in a very specific order for a monthly report and it's easier to keep them on separate tabs. I created a code that allows me to print them to my office printer, but I'd like to be able to combine the sheets and then print them directly to PDF. Can anyone help me out? I can continue to use the print macro if not.</p>\n\n<p>Thanks!</p>\n\n<p>Questions/Thoughts</p>\n\n<p>1) Am I able to select the ranges, and print all of them to a single pdf in one go?</p>\n\n<p>2) if not perhaps its easier to print to two different pdfs (based on tab/worksheet) and then combine in adobe</p>\n\n<p>Here's my code:</p>\n\n<pre><code>Sub PrintOut()\n\nAnswer = MsgBox(\"Ahoy scallywag! Would ye like t' print scroll?\",\nvbYesNoCancel + vbInformation, \"Application Message\")\n\nIf Answer = vbYes Then Else Exit Sub\n\nApplication.ScreenUpdating = False\n\nWith ActiveSheet.PageSetup\n\n.LeftMargin = Application.CentimetersToPoints(0.5)\n.RightMargin = Application.CentimetersToPoints(0.5)\n.TopMargin = Application.CentimetersToPoints(0.5)\n.BottomMargin = Application.CentimetersToPoints(0.5)\n.HeaderMargin = Application.CentimetersToPoints(0.2)\n.FooterMargin = Application.CentimetersToPoints(0.2)\nWorksheets(\"PTD and YTD Spend\").PageSetup.CenterHorizontally = True\nWorksheets(\"Leasing Detail\").PageSetup.CenterHorizontally = True\nWorksheets(\"PTD and YTD Spend\").PageSetup.CenterVertically = True\nWorksheets(\"Leasing Detail\").PageSetup.CenterVertically = True\n\nSheets(\"PTD and YTD Spend\").Select\nActiveSheet.PageSetup.PrintArea = \"$G$3:$AG$32\"\nActiveWindow.SelectedSheets.PrintOut\n\nSheets(\"Leasing Detail\").Select\nActiveSheet.PageSetup.PrintArea = \"$G$3:$AD$32\"\nActiveWindow.SelectedSheets.PrintOut\n\nSheets(\"PTD and YTD Spend\").Select\nActiveSheet.PageSetup.PrintArea = \"$G$33:$AG$63\"\nActiveWindow.SelectedSheets.PrintOut\n\nSheets(\"Leasing Detail\").Select\nActiveSheet.PageSetup.PrintArea = \"$G$33:$AD$63\"\nActiveWindow.SelectedSheets.PrintOut\n\nSheets(\"PTD and YTD Spend\").Select\nActiveSheet.PageSetup.PrintArea = \"$G$64:$AG$93\"\nActiveWindow.SelectedSheets.PrintOut\n\nSheets(\"Leasing Detail\").Select\nActiveSheet.PageSetup.PrintArea = \"$G$64:$AD$93\"\nActiveWindow.SelectedSheets.PrintOut\n\nSheets(\"PTD and YTD Spend\").Select\nActiveSheet.PageSetup.PrintArea = \"$G$94:$AG$123\"\nActiveWindow.SelectedSheets.PrintOut\n\nSheets(\"Leasing Detail\").Select\nActiveSheet.PageSetup.PrintArea = \"$G$94:$AD$123\"\nActiveWindow.SelectedSheets.PrintOut\n\nSheets(\"PTD and YTD Spend\").Select\nActiveSheet.PageSetup.PrintArea = \"$G$124:$AG$153\"\nActiveWindow.SelectedSheets.PrintOut\n\nSheets(\"Leasing Detail\").Select\nActiveSheet.PageSetup.PrintArea = \"$G$124:$AD$153\"\nActiveWindow.SelectedSheets.PrintOut\n\nSheets(\"PTD and YTD Spend\").Select\nActiveSheet.PageSetup.PrintArea = \"$G$154:$AG$183\"\nActiveWindow.SelectedSheets.PrintOut\n\nSheets(\"Leasing Detail\").Select\nActiveSheet.PageSetup.PrintArea = \"$G$154:$AD$183\"\nActiveWindow.SelectedSheets.PrintOut\n\nSheets(\"PTD and YTD Spend\").Select\nActiveSheet.PageSetup.PrintArea = \"$G$184:$AG$216\"\nActiveWindow.SelectedSheets.PrintOut\n\nSheets(\"Leasing Detail\").Select\nActiveSheet.PageSetup.PrintArea = \"$G$184:$AD$213\"\nActiveWindow.SelectedSheets.PrintOut\n\nSheets(Array(\"PTD and YTD Spend\", \"Leasing Detail\")).Select\n\nActiveWindow.SelectedSheets.PrintOut\nSheets(\"PTD and YTD Spend\").Select 'Needed so that multiple sheets don't remain selected\n\nEnd With\nApplication.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "accpac"], "comments": [{"owner": {"reputation": 37205, "user_id": 1070452, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/osssV.jpg?s=128&g=1", "display_name": "\u0147\u024fssa P&#248;ngj\u01e3rdenlarp", "link": "https://stackoverflow.com/users/1070452/%c5%87%c9%8fssa-p%c3%b8ngj%c7%a3rdenlarp"}, "edited": false, "score": 0, "creation_date": 1516160571, "post_id": 48293235, "comment_id": 83571545, "body": "Thats not VB.NET code.  VB.NET is to  vba as <i>carpet</i> is to <i>car</i>"}, {"owner": {"reputation": 43, "user_id": 5320188, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/69723a8ab9ac3565790d697f6a884431?s=128&d=identicon&r=PG&f=1", "display_name": "Fenny", "link": "https://stackoverflow.com/users/5320188/fenny"}, "reply_to_user": {"reputation": 37205, "user_id": 1070452, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/osssV.jpg?s=128&g=1", "display_name": "\u0147\u024fssa P&#248;ngj\u01e3rdenlarp", "link": "https://stackoverflow.com/users/1070452/%c5%87%c9%8fssa-p%c3%b8ngj%c7%a3rdenlarp"}, "edited": false, "score": 0, "creation_date": 1516160741, "post_id": 48293235, "comment_id": 83571587, "body": "yeah, i know that not vb.net :) but maybe anyone in vb .net know that code too"}, {"owner": {"reputation": 37205, "user_id": 1070452, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/osssV.jpg?s=128&g=1", "display_name": "\u0147\u024fssa P&#248;ngj\u01e3rdenlarp", "link": "https://stackoverflow.com/users/1070452/%c5%87%c9%8fssa-p%c3%b8ngj%c7%a3rdenlarp"}, "edited": false, "score": 0, "creation_date": 1516160934, "post_id": 48293235, "comment_id": 83571627, "body": "Thats not how it works.  Maybe someone using python or c++ could answer too.  The questions pertains solely to VBA/Excel-vba, so remove the tag please"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 1, "creation_date": 1516161278, "post_id": 48293235, "comment_id": 83571702, "body": "Where are you running the code?  Is it in Excel&#39;s VBA?  Or somewhere else?  If, for instance, it was in Word VBA, then <code>xlUp</code> (a constant in the Excel Object library) won&#39;t be defined and will be treated as <code>0</code> instead of as <code>-4162</code>."}, {"owner": {"reputation": 43, "user_id": 5320188, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/69723a8ab9ac3565790d697f6a884431?s=128&d=identicon&r=PG&f=1", "display_name": "Fenny", "link": "https://stackoverflow.com/users/5320188/fenny"}, "edited": false, "score": 0, "creation_date": 1516161769, "post_id": 48293235, "comment_id": 83571807, "body": "i run it in ACCPAC macro. this is how its work. First we read the excel file, and insert all the data to ACCPAC system using macro"}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 1, "creation_date": 1516198452, "post_id": 48293235, "comment_id": 83590955, "body": "Then  the comment by YowE3K is completely relevant. You either need the reference to the Excel library, or you need to use the corresponding numerical value instead of xlUp. xlUp is internal to Excel."}], "answers": [{"tags": [], "owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "is_accepted": false, "score": 0, "last_activity_date": 1516216876, "creation_date": 1516216876, "answer_id": 48308491, "question_id": 48293235, "link": "https://stackoverflow.com/questions/48293235/vba-xlup-error-in-macro/48308491#48308491", "title": "VBA xlUp error in macro", "body": "<p>If you are not running your code in Excel VBA, or otherwise have a reference to the Microsoft Excel Object Library, then none of the constants defined in that library will be available to your code.  You will have to set their values yourself.</p>\n\n<p>You could add the following lines to the start of your code:</p>\n\n<pre><code>Const xlUp As Long = -4162\nConst xlDown As Long = -4121\n</code></pre>\n\n<p>They were the only two constants I could see in your posted code but, if you have others, they should be added to your code as well.</p>\n"}], "owner": {"reputation": 43, "user_id": 5320188, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/69723a8ab9ac3565790d697f6a884431?s=128&d=identicon&r=PG&f=1", "display_name": "Fenny", "link": "https://stackoverflow.com/users/5320188/fenny"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 803, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1522419904, "creation_date": 1516160484, "last_edit_date": 1516198339, "question_id": 48293235, "link": "https://stackoverflow.com/questions/48293235/vba-xlup-error-in-macro", "title": "VBA xlUp error in macro", "body": "<p>can anyone help me?\ni have this syntax</p>\n\n<pre><code>Dim oExcel As Variant\nDim oWB As Variant\n\n'Set oWB = CreateObject(\"Object.Workbook\")\nSet oExcel = CreateObject(\"Excel.Application\")\nSet oWB = oExcel.Workbooks.Open(\"Z:\\MPR\\Maret 2017\\31 - 03 -2017\\DF\\PAL - DF.xlsx\")\noWB.Sheets(1).select\nDim oNumRow As Integer\n\n'oNumRow = oWB.Sheets(1).UsedRange.Count\nWith oWB\n    oNumRow = oWB.Sheets(1).Cells(oWB.Sheets(1).Rows.Count, \"A\").End(xlUp).row 'error\nEnd With\noNumRow = oWB.Sheets(1).Cells(oWB.Sheets(1).Rows.Count, 1).End.row 'error\noNumRow = oWB.Sheets(1).Range(\"A1\", oWB.Sheets(1).Range(\"A1\").End(xlDown).row).Rows.Count'error\n</code></pre>\n\n<p>if i change the  <code>Dim oExcel As Variant</code> to Dim oExcel As Excel.Application, the program error in there. Can anyone suggest any idea? I'm new in programing vba for macro</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1516164230, "post_id": 48293110, "comment_id": 83572476, "body": "Try using <code>.Text</code> instead of <code>.Value</code>"}, {"owner": {"reputation": 11, "user_id": 7271960, "user_type": "registered", "profile_image": "https://graph.facebook.com/741461332670526/picture?type=large", "display_name": "TLD", "link": "https://stackoverflow.com/users/7271960/tld"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1516329446, "post_id": 48293110, "comment_id": 83652218, "body": "Thank you so much. It works perfectly :)"}], "owner": {"reputation": 11, "user_id": 7271960, "user_type": "registered", "profile_image": "https://graph.facebook.com/741461332670526/picture?type=large", "display_name": "TLD", "link": "https://stackoverflow.com/users/7271960/tld"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 67, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1516170596, "creation_date": 1516159427, "last_edit_date": 1531164843, "question_id": 48293110, "link": "https://stackoverflow.com/questions/48293110/replace-data-in-word-by-excel-vba", "title": "Replace data in Word by Excel VBA", "body": "<p>I am using this code for my work but I got a problem, when I replace number it doesn't copy format. For example: In Excel 999.999 when replace in Word 999999. Could someone help me solving this ?</p>\n\n<pre><code>Sub test22()\n\nDim num_of_row As Long\n    Dim num_of_column As Long\n    Dim i As Long, j As Long\n    Dim template As Object\n    Dim t As Object\n    Dim name As String\n\n\n    num_of_column = 20\n\n    num_of_row = ActiveSheet.Cells(Rows.Count, \"A\").End(xlUp).Row - 1\n\n    With CreateObject(\"word.application\") ' late binding\n        .Visible = False\n\n        For i = 1 To num_of_row\n            Set template = .documents.Open(\"D:\\zzz LINH TINH\\02. Test VBA\\01. LRAMP\\Template_KHQLMT.docx\")\n            Set t = template.Content\n            For j = 1 To num_of_column\n                t.Find.Execute _\n                    FindText:=ActiveSheet.Cells(1, j).Value, _\n                    ReplaceWith:=ActiveSheet.Cells(i + 1, j).Value, _\n                    Replace:=wdReplaceAll\n            Next\n            template.SaveAs Filename:=ThisWorkbook.Path &amp; Application.PathSeparator &amp; i &amp; \"-KHQLMT \" &amp; \".docx\"\n        Next\n        .Quit\n    End With\n    Set t = Nothing\n    Set template = Nothing\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-word"], "answers": [{"comments": [{"owner": {"reputation": 75, "user_id": 5733054, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/0908c9f86c814557d6c198d5267ece2e?s=128&d=identicon&r=PG&f=1", "display_name": "Wally Walters", "link": "https://stackoverflow.com/users/5733054/wally-walters"}, "edited": false, "score": 1, "creation_date": 1516172038, "post_id": 48294400, "comment_id": 83574924, "body": "That&#39;s very close in that it works as desired on every line except the first -- it returns &quot;top of page&quot; at every character position on the first line, whereas that should only happen before the occurrence of the first character.  But if I combine combine that with wdFirstCharacterColumnNumber (which I got from the link you provided), it works.  Much obliged,"}], "tags": [], "owner": {"reputation": 824, "user_id": 6722034, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/70472b94b95a084f55551520030f88fb?s=128&d=identicon&r=PG&f=1", "display_name": "Arul", "link": "https://stackoverflow.com/users/6722034/arul"}, "is_accepted": true, "score": 1, "last_activity_date": 1516168391, "creation_date": 1516168391, "answer_id": 48294400, "question_id": 48293080, "link": "https://stackoverflow.com/questions/48293080/ms-word-macro-special-handling-for-top-of-page/48294400#48294400", "title": "MS Word macro -- special handling for top of page", "body": "<p>You could use <code>Selection.Information(wdFirstCharacterLineNumber) = 1</code>. </p>\n\n<pre><code>If Selection.Information(wdFirstCharacterLineNumber) = 1 Then\n  Selection.TypeText Text:=\"top of page\"  \nElse\n  Selection.TypeParagraph\n  Selection.TypeText Text:=\"not top of page\"  \nEnd If\n</code></pre>\n\n<p><code>Selection.Information(wdFirstCharacterLineNumber)</code> will return the line number of the current selection within that page. See <a href=\"https://msdn.microsoft.com/en-us/library/bb213848(v=office.12).aspx\" rel=\"nofollow noreferrer\" title=\"MSDN\">MSDN</a>.</p>\n\n<p>PS: I have tested this with Word 2010 and I don't have access to previous version. So, give it a try.</p>\n"}], "owner": {"reputation": 75, "user_id": 5733054, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/0908c9f86c814557d6c198d5267ece2e?s=128&d=identicon&r=PG&f=1", "display_name": "Wally Walters", "link": "https://stackoverflow.com/users/5733054/wally-walters"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60, "favorite_count": 0, "accepted_answer_id": 48294400, "answer_count": 1, "score": 0, "last_activity_date": 1516171228, "creation_date": 1516159166, "last_edit_date": 1516171228, "question_id": 48293080, "link": "https://stackoverflow.com/questions/48293080/ms-word-macro-special-handling-for-top-of-page", "title": "MS Word macro -- special handling for top of page", "body": "<p>I'm trying to write an MS Word macro to drop down one line and type a certain phrase unless the cursor at the very top of the document or following a \"hard\" page break, in which case it should only type the message.  The code goes pretty much like this -- </p>\n\n<pre><code>If &lt;TOP OF PAGE&gt; Then\n  Selection.TypeText Text:=\"top of page\"  \nElse\n  Selection.TypeParagraph\n  Selection.TypeText Text:=\"not top of page\"  \nEnd If\n</code></pre>\n\n<p>-- but I don't know the specific syntax for testing whether the cursor is at the top of a page.  Can anyone fill me in?  My software version is MS Word 2003.  Thanks.</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 0, "last_activity_date": 1516156879, "creation_date": 1516156879, "answer_id": 48292809, "question_id": 48292431, "link": "https://stackoverflow.com/questions/48292431/searching-for-the-column-that-contains-a-given-text-and-then-searching-for-the/48292809#48292809", "title": "Searching for the column that contains a given text, and then searching for the row that contains the last non-blank cell in the worksheet", "body": "<p>I was wondering about your starting point of ActiveCell, so I reversed the methods and used the last row as the starting point to search for FIRST.</p>\n\n<pre><code>Dim r As Long, c As Long\n\nWith Worksheets(\"sheet1\")\n    r = .Cells.Find(what:=\"*\", after:=.Cells(1, \"A\"), _\n                LookAt:=xlPart, LookIn:=xlFormulas, _\n                SearchOrder:=xlByRows, SearchDirection:=xlPrevious, _\n                MatchCase:=False).Row\n    c = .Cells.Find(what:=\"FIRST\", after:=.Cells(r + 1, \"A\"), _\n                LookIn:=xlFormulas, LookAt:=xlPart, _\n                SearchOrder:=xlByRows, SearchDirection:=xlNext, _\n                MatchCase:=False, SearchFormat:=False).Column\n    .Cells(r, c).Activate\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 9227049, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0e919b64a77a3bcc3816aaed6e70e302?s=128&d=identicon&r=PG&f=1", "display_name": "Sneakymist", "link": "https://stackoverflow.com/users/9227049/sneakymist"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 30, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1516156944, "creation_date": 1516153033, "last_edit_date": 1516153351, "question_id": 48292431, "link": "https://stackoverflow.com/questions/48292431/searching-for-the-column-that-contains-a-given-text-and-then-searching-for-the", "title": "Searching for the column that contains a given text, and then searching for the row that contains the last non-blank cell in the worksheet", "body": "<p>I am trying to create a code that does two things:</p>\n\n<ol>\n<li><p>First, the code will search for a column that contains a given text within the worksheet.</p></li>\n<li><p>Afterwards, the code will search for the row with the last non-blank cell in the worksheet, while remaining on the same column as 1.  </p></li>\n</ol>\n\n<p><a href=\"https://i.stack.imgur.com/SzZ6A.png\" rel=\"nofollow noreferrer\">picture example</a></p>\n\n<p>As shown in the example above, the code would first search for the text \"FIRST\" in A1. Afterwards, it will search for the last non-blank cell in the worksheet, which is C11. However, it should remain in the column that contains \"FIRST\", so that only the row changes. The final result would be A11. </p>\n\n<p>So far, I found the code that lets me do 1.</p>\n\n<pre><code>Cells.Find(what:=\"FIRST\", \n           after:=ActiveCell, \n           LookIn:=xlFormulas, \n           LookAt:=xlPart, \n           SearchOrder:=xlByRows, \n           SearchDirection:=xlNext, \n           MatchCase:=False, \n           SearchFormat:=False).Activate\n</code></pre>\n\n<p>and another code that lets me do 2., </p>\n\n<pre><code>Cells.Find(what:=\"*\",\n           after:=Range(\"A1\"),\n           LookAt:=xlPart,\n           LookIn:=xlFormulas,\n           SearchOrder:=xlByRows,\n           SearchDirection:=xlPrevious,\n           MatchCase:=False).Activate\n</code></pre>\n\n<p>However, I am unable to use them together to achieve my intended goal. </p>\n\n<p>Any suggestions to answer this would be appreciated. Thank you!</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1516152358, "post_id": 48292326, "comment_id": 83569845, "body": "Are you using an XLSM file or XLAM file for your macro? The _Change needs to be part of an XLSM and it would probably be better to put the sub in an XLAM. (Add-In)"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 2, "creation_date": 1516152489, "post_id": 48292326, "comment_id": 83569873, "body": "Neither of those Subs will show up in the &quot;Run macro&quot; dialog, since they both have parameters: only parameterless methods are listed.  Is this code in the worksheet code module?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1516152839, "post_id": 48292326, "comment_id": 83569945, "body": "@TimWilliams - subs with optional parameters as variants are listed."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1516157390, "post_id": 48292326, "comment_id": 83570864, "body": "@Jeeped - thanks for the correction"}, {"owner": {"reputation": 33, "user_id": 8617134, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b730e1797ac40facee2bd8d647e84a5?s=128&d=identicon&r=PG&f=1", "display_name": "ken_you_not", "link": "https://stackoverflow.com/users/8617134/ken-you-not"}, "reply_to_user": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1516160072, "post_id": 48292326, "comment_id": 83571422, "body": "@braX I&#39;m using a XLSM file. So are you saying that it would work if my Excel file is changed into the XLAM format? Mind if you share more with me? I&#39;m really new at Excel :/"}, {"owner": {"reputation": 33, "user_id": 8617134, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b730e1797ac40facee2bd8d647e84a5?s=128&d=identicon&r=PG&f=1", "display_name": "ken_you_not", "link": "https://stackoverflow.com/users/8617134/ken-you-not"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1516160331, "post_id": 48292326, "comment_id": 83571486, "body": "@TimWilliams Thank you for your response!! This code is indeed in the worksheet code module."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1516163994, "post_id": 48292326, "comment_id": 83572411, "body": "Your code should run automatically when a you make a change on the worksheet - did you try putting a breakpoint and seeing if it hit?"}, {"owner": {"reputation": 33, "user_id": 8617134, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b730e1797ac40facee2bd8d647e84a5?s=128&d=identicon&r=PG&f=1", "display_name": "ken_you_not", "link": "https://stackoverflow.com/users/8617134/ken-you-not"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1516204202, "post_id": 48292326, "comment_id": 83594957, "body": "@TimWilliams Yes. I got it. It&#39;s not a macro after all. Once I saved the project, the code would run when I change the value within the target address. But, it couldn&#39;t run if it&#39;s updated automatically?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1516205036, "post_id": 48292326, "comment_id": 83595555, "body": "What do you mean by &quot;updated automatically&quot;?"}, {"owner": {"reputation": 33, "user_id": 8617134, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b730e1797ac40facee2bd8d647e84a5?s=128&d=identicon&r=PG&f=1", "display_name": "ken_you_not", "link": "https://stackoverflow.com/users/8617134/ken-you-not"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1516299915, "post_id": 48292326, "comment_id": 83641434, "body": "@Tim Williams The data that I want my VBA to work on is actually imported from a website. That&#39;s why it will change at a certain interval."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1516306817, "post_id": 48292326, "comment_id": 83645049, "body": "Imported how <i>exactly</i>?"}, {"owner": {"reputation": 33, "user_id": 8617134, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b730e1797ac40facee2bd8d647e84a5?s=128&d=identicon&r=PG&f=1", "display_name": "ken_you_not", "link": "https://stackoverflow.com/users/8617134/ken-you-not"}, "edited": false, "score": 0, "creation_date": 1516322906, "post_id": 48292326, "comment_id": 83650795, "body": "The data is imported through the use of the web query function in Excel. I copied the URL of the website and paste it into the dialog of the &quot;From Web&quot; function in Excel. Then, I click &quot;Load&quot; and the data that is part of the URL will be converted into a table where it can be loaded to my Excel Worksheet."}], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 8617134, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b730e1797ac40facee2bd8d647e84a5?s=128&d=identicon&r=PG&f=1", "display_name": "ken_you_not", "link": "https://stackoverflow.com/users/8617134/ken-you-not"}, "edited": false, "score": 0, "creation_date": 1516160499, "post_id": 48292396, "comment_id": 83571528, "body": "So, from what I can understand, I should take the whole Worksheet_Change code into a new separated module to get it working? Also, mind sharing some useful insights or links so that I can &#39;convert&#39; my code into a non-variant parameter? Thank you lots!"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 0, "last_activity_date": 1516152683, "creation_date": 1516152683, "answer_id": 48292396, "question_id": 48292326, "link": "https://stackoverflow.com/questions/48292326/unable-to-locate-vba-notification-macro-via-excel-2016/48292396#48292396", "title": "Unable to locate VBA notification macro via Excel 2016", "body": "<p>A <a href=\"https://msdn.microsoft.com/en-us/vba/excel-vba/articles/worksheet-change-event-excel\" rel=\"nofollow noreferrer\">Worksheet_Change</a> is an event macro typically located on a private worksheet code sheet; not a public module code sheet. It also takes a non-optional, non-variant parameter. Sub procedures (what you call <em>macros</em>) are not listed in the Macros dialog when they require a non-variant parameter.</p>\n"}], "owner": {"reputation": 33, "user_id": 8617134, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b730e1797ac40facee2bd8d647e84a5?s=128&d=identicon&r=PG&f=1", "display_name": "ken_you_not", "link": "https://stackoverflow.com/users/8617134/ken-you-not"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 60, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1516152683, "creation_date": 1516152059, "last_edit_date": 1516152593, "question_id": 48292326, "link": "https://stackoverflow.com/questions/48292326/unable-to-locate-vba-notification-macro-via-excel-2016", "title": "Unable to locate VBA notification macro via Excel 2016", "body": "<p>so I have this code where its function is to send an email reminder to the user if the cell values in the range is equivalent to say, number x. Within the mail, it specifies directly which cell address has been changed. But the problem now is that, I was always prompted by the Macros table to select a macro to work on, and even worse, my macro was not present at all</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\n            If Target.Column = 5 Then\n                If Target.Row &lt; 15 And Target.Row &gt; 2 Then\n                    If Target.value &lt; 1 Then\n                    Call mymacro(Target.Address)\n                    End If\n                End If\n            End If\n        End Sub\n\n    Private Sub mymacro(theValue As String)\n\n\n            Dim xOutApp As Object\n            Dim xOutMail As Object\n            Dim xMailBody As String\n            Set xOutApp = CreateObject(\"Outlook.Application\")\n            Set xOutMail = xOutApp.CreateItem(0)\n            xMailBody = \"Hi there\" &amp; vbNewLine &amp; vbNewLine &amp; _\n                      \"The value that changed is in cell: \" &amp; theValue\n\n            On Error Resume Next\n            With xOutMail\n                .To = \"email address\"\n                .CC = \"\"\n                .BCC = \"\"\n                .Subject = \"test succeeded\"\n                .Body = xMailBody\n                .Display   'or use .Send\n            End With\n            On Error GoTo 0\n            Set xOutMail = Nothing\n            Set xOutApp = Nothing\n        End Sub\n</code></pre>\n\n<p>The logic is okay ( I think ), but the main problem is, I was always prompted by Excel to select my Macro from the Macros table, and my macro was not even there! It's as if I have never created one at all. I tried to find some information regarding this issue, but its nowhere to be found. In other words, how can I make this macro work the way I wanted to? I have zero knowledge regarding VBA, so please excuse me if my question seems dumb. Do let me know if y'all need more information to understand the problem. Thank you everyone!</p>\n"}, {"tags": ["ms-access", "vba", "ms-access-2007"], "comments": [{"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 1, "creation_date": 1516151457, "post_id": 48292051, "comment_id": 83569595, "body": "What do you mean <i>I am no longer the administrator of the database</i>?"}, {"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1516151564, "post_id": 48292051, "comment_id": 83569640, "body": "If you are going to import CSV files into an access database, you will want to leave the table definition as open as possible. The Memo field should be able to hold as much data as you want. What you then do is write some VBA code that processes that memo data for errors. In other words, you handle it yourself instead of letting Access to do it for you."}, {"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1516151620, "post_id": 48292051, "comment_id": 83569662, "body": "Consider using more than one Access database and importing the data from one to the other, or stop using Access and get a free version of SQL Server Express which is much much better."}, {"owner": {"reputation": 3502, "user_id": 1261752, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OjAfn.png?s=128&g=1", "display_name": "C Perkins", "link": "https://stackoverflow.com/users/1261752/c-perkins"}, "reply_to_user": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1516167761, "post_id": 48292051, "comment_id": 83573443, "body": "@braX Although the Memo field might be able to hold more data, this does not guarantee that the import tools honor the same limits."}, {"owner": {"reputation": 3502, "user_id": 1261752, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OjAfn.png?s=128&g=1", "display_name": "C Perkins", "link": "https://stackoverflow.com/users/1261752/c-perkins"}, "edited": false, "score": 0, "creation_date": 1516168045, "post_id": 48292051, "comment_id": 83573540, "body": "It is bad practice to delete an object from a collection being enumerated.  Instead, collect the names (in another collection) of the TableDef objects separately, then delete them in a separate loop after the first loop is finished.  (As is, the code still has a reference to the TableDef when it is deleted, potentially causing an object reference problem that might be the source of the problem.)"}, {"owner": {"reputation": 3502, "user_id": 1261752, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OjAfn.png?s=128&g=1", "display_name": "C Perkins", "link": "https://stackoverflow.com/users/1261752/c-perkins"}, "edited": false, "score": 0, "creation_date": 1516168425, "post_id": 48292051, "comment_id": 83573654, "body": "Instead of using DoCmd methods, execute an SQL command <code>DROP TABLE [Table Name]</code> <a href=\"https://msdn.microsoft.com/en-us/library/bb177897(v=office.12).aspx\" rel=\"nofollow noreferrer\">See reference.</a>  DoCmd is an Access method that likely creates redundant database connections... a possible source of the problem."}, {"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1516179974, "post_id": 48292051, "comment_id": 83578977, "body": "I agree with CPerkins that you should avoid using <code>DoCmd</code>, but I personally prefer <code>TableDefs.Delete tdf.Name</code> over a <code>DROP TABLE</code> query."}, {"owner": {"reputation": 11, "user_id": 9226958, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a6428f04dd1bd1884bafeaa62907f20?s=128&d=identicon&r=PG&f=1", "display_name": "Jasper", "link": "https://stackoverflow.com/users/9226958/jasper"}, "reply_to_user": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1516180469, "post_id": 48292051, "comment_id": 83579255, "body": "@Brax: it means that I can&#39;t edit my code any longer as I&#39;m not the sole user of the dbase any longer hence I can&#39;t modify and save my code."}, {"owner": {"reputation": 11, "user_id": 9226958, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a6428f04dd1bd1884bafeaa62907f20?s=128&d=identicon&r=PG&f=1", "display_name": "Jasper", "link": "https://stackoverflow.com/users/9226958/jasper"}, "edited": false, "score": 0, "creation_date": 1516181674, "post_id": 48292051, "comment_id": 83579981, "body": "Thank you for the suggestions: With drop statements i get syntax errors. I tried two options inserted after &#39;then&#39; attempt 1: str = &quot;DROP TABLE&quot; &amp; str &amp; &quot;&quot;             DoCmd.RunSQL str  || attempt2: db.execute &quot;DROP TABLE&quot; &amp; tdf.Name &amp; &quot;;&quot; both didn&#39;t  drop the tables and also placed the dbase again in &#39;administration&#39; mode"}, {"owner": {"reputation": 11, "user_id": 9226958, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a6428f04dd1bd1884bafeaa62907f20?s=128&d=identicon&r=PG&f=1", "display_name": "Jasper", "link": "https://stackoverflow.com/users/9226958/jasper"}, "edited": false, "score": 0, "creation_date": 1516181986, "post_id": 48292051, "comment_id": 83580201, "body": "With the Tabledefs.Delete tdf.name statement I get another error: (Object required) in procedure DelteTbls  with the result that it didn&#39;t drop the tables either and also placed the dbase again in a not exclusive state. (not able to modify&amp;save the code changes)"}, {"owner": {"reputation": 11, "user_id": 9226958, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a6428f04dd1bd1884bafeaa62907f20?s=128&d=identicon&r=PG&f=1", "display_name": "Jasper", "link": "https://stackoverflow.com/users/9226958/jasper"}, "edited": false, "score": 0, "creation_date": 1516183110, "post_id": 48292051, "comment_id": 83580876, "body": "Resolved: Two steps I took to get it resolved: 1=created a new empty access dbase and imported all tables,forms,queries,modules from the old dbase. 2: I replaced my code between the error handling with this     Dim tbl As DAO.TableDef       For Each tbl In CurrentDb.TableDefs          If InStr(tbl.Name, &quot;ImportErrors&quot;) Then             CurrentDb.TableDefs.Delete (tbl.Name)         End If     Next tbl  Thank you for your suggestions to get it work."}], "owner": {"reputation": 11, "user_id": 9226958, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a6428f04dd1bd1884bafeaa62907f20?s=128&d=identicon&r=PG&f=1", "display_name": "Jasper", "link": "https://stackoverflow.com/users/9226958/jasper"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 29, "favorite_count": 1, "answer_count": 0, "score": 1, "last_activity_date": 1516151488, "creation_date": 1516149877, "last_edit_date": 1516151488, "question_id": 48292051, "link": "https://stackoverflow.com/questions/48292051/no-exclusive-rights-after-removing-tables", "title": "No exclusive rights after removing tables", "body": "<p>In MS Access 2007 I imported some CSV files. These imports do create import errors as some of the fields have extensive text that cannot be stored in a memo field. For these errors, MS Access creates new tables with import errors for every single file that it imports. I created a sub that deletes the import error tables and, in general, that works fine. What is not fine is that after the code has run I'm no longer the administrator of the database and I first need to close the database before I can continue with further development on the database.</p>\n\n<pre><code>Sub DelteTbls() \n\nOn Error GoTo DelteTbls_Error\n\n    Dim db As DAO.Database\n    Dim tdf As DAO.TableDef\n\n    Set db = CurrentDb() 'Set the database object\n\n    'Clean the import error tables.\n    For Each tdf In db.TableDefs\n        If (tdf.Name Like \"*\" &amp; \"import\" &amp; \"*\") Then\n            DoCmd.DeleteObject acTable, tdf.Name\n        End If\n    Next\n\n    On Error GoTo 0\n\nSmoothExit_DelteTbls:\n    Set db = Nothing\n    DoCmd.SetWarnings True\n    Exit Sub\n\nDelteTbls_Error:\n    MsgBox \"Error\" &amp; Err.Number &amp; \" (\" &amp; Err.Description &amp; \") in procedure DelteTbls\"\n    Resume SmoothExit_DelteTbls\n\nEnd Sub\n</code></pre>\n\n<p>The message I get after this code has run is</p>\n\n<blockquote>\n  <p>Microsoft Access can't save design changes or save to a new database object as another user has the file open. To save your design changes or to save to a new object you must have exclusive access to the file.</p>\n</blockquote>\n\n<p>This is strange, as I'm the only user of the database and no-one else is logged in. What am I doing wrong?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 1, "creation_date": 1516149643, "post_id": 48291956, "comment_id": 83569103, "body": "Did you at least <b>try</b> amending the code to reflect the fact that you want to match on 3 columns (or, at least, I assume you do) and the fact that you want to update column D, not column B?  If so, please post the code that you tried."}, {"owner": {"reputation": 3, "user_id": 8639581, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d839237884f053dcc197f1c112bd76b3?s=128&d=identicon&r=PG&f=1", "display_name": "Zero", "link": "https://stackoverflow.com/users/8639581/zero"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1516153140, "post_id": 48291956, "comment_id": 83570015, "body": "That was the original code from this site also, i tried amending it but it only updates 1 info per column. Means it will update 11 to all of Family Oh in column D instead of 11, 12, 13, 15"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1516156500, "post_id": 48291956, "comment_id": 83570682, "body": "Did you at least try amending the code to reflect the fact that you want to match on 3 columns, i.e. did you try checking whether all of the three columns (A, B, and C) matched, or did you expect that that would automatically happen just because you checked column A?"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1516156711, "post_id": 48291956, "comment_id": 83570725, "body": "You really shouldn&#39;t just copy/paste <a href=\"https://stackoverflow.com/a/28918966/6535336\">someone else&#39;s answer</a> (especially without attribution) and say that you &quot;can&#39;t get it to work correctly&quot; when you have made Zero effort at getting it to work correctly."}, {"owner": {"reputation": 3, "user_id": 8639581, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d839237884f053dcc197f1c112bd76b3?s=128&d=identicon&r=PG&f=1", "display_name": "Zero", "link": "https://stackoverflow.com/users/8639581/zero"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1516158869, "post_id": 48291956, "comment_id": 83571170, "body": "yes I tried amending it and like I said the results were not as what I have expected. I tried to change the columns A B C but same result. I just saw that answer and tried that code. I worked only on a single search and replace but if the table contains more than one searchable items, it will only replace all of the info with the same data. So if I ran the macro, instead of having Age 11, 12, 13, 15 in column D, it will replace the Age as 11, 11, 11, 11 :) It would be much appreciated if there is an alternative code that is much easier than that since this is my first time working on excel vba"}, {"owner": {"reputation": 3, "user_id": 8639581, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d839237884f053dcc197f1c112bd76b3?s=128&d=identicon&r=PG&f=1", "display_name": "Zero", "link": "https://stackoverflow.com/users/8639581/zero"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1516159006, "post_id": 48291956, "comment_id": 83571192, "body": "That original code that I searched in this site is working perfectly, but only to a single search and replace process and I am still figuring out on how to make it work in a multiple data update :) Oh btw, thank you for editing my post I appreciate it a lot :)"}, {"owner": {"reputation": 3, "user_id": 8639581, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d839237884f053dcc197f1c112bd76b3?s=128&d=identicon&r=PG&f=1", "display_name": "Zero", "link": "https://stackoverflow.com/users/8639581/zero"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1516159500, "post_id": 48291956, "comment_id": 83571286, "body": "I can try to upload and share the link of the actual sheet that I am working here for reference"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1516159558, "post_id": 48291956, "comment_id": 83571304, "body": "Why don&#39;t you make an attempt at changing the <code>If</code> to check three values instead of just one, and post your code - then people will be more inclined to help you.  (At the moment, the only effort you have shown is a search to find a piece of code somewhat similar, and then post a question saying &quot;this isn&#39;t close enough - please finish it for me&quot;.  People don&#39;t like answering those sort of questions.  But show a <b>bit</b> of effort and people will <b>gladly</b> fix the problems you encounter.)"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1516159629, "post_id": 48291956, "comment_id": 83571321, "body": "The data in your question seems clear enough - I could easily make the one line change (two lines if you include the change of &quot;2&quot; to &quot;4&quot;) needed now, but we need to see you make an effort yourself."}, {"owner": {"reputation": 3, "user_id": 8639581, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d839237884f053dcc197f1c112bd76b3?s=128&d=identicon&r=PG&f=1", "display_name": "Zero", "link": "https://stackoverflow.com/users/8639581/zero"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1516160021, "post_id": 48291956, "comment_id": 83571406, "body": "I am still working on the code right now. Amending it and testing :) I&#39;ll delete this question once I got the code working correctly"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1516160682, "post_id": 48291956, "comment_id": 83571570, "body": "If you <b>don&#39;t</b> get it working correctly, feel free to ask a new question (or even edit this one if you like - we can delete all the comment history) and we will be happy to help you fix anything <b>you</b> get wrong."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 8639581, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d839237884f053dcc197f1c112bd76b3?s=128&d=identicon&r=PG&f=1", "display_name": "Zero", "link": "https://stackoverflow.com/users/8639581/zero"}, "edited": false, "score": 0, "creation_date": 1516234210, "post_id": 48300368, "comment_id": 83609788, "body": "Wow! This is the kind of explanation I have been looking for. I now see the error. So that&#39;s why I can&#39;t get the code to work correctly even if I amend the codes because I was too focused on having the macro to look for the Family Name and overwrite the info instead of having it look at the first 3 cells. Thank you so much this really helps a lot and I really appreciate it. I have been amending the codes for 5 days now and searching the web for possible formula to make it work but I still can&#39;t get it to work on my end. I really need a lot of things to learn regarding this excel thing :)"}], "tags": [], "owner": {"reputation": 7497, "user_id": 8670372, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ir8a4Lbosmo/AAAAAAAAAAI/AAAAAAAAOtE/2eY5jK1atcc/photo.jpg?sz=128", "display_name": "Xabier", "link": "https://stackoverflow.com/users/8670372/xabier"}, "is_accepted": true, "score": 1, "last_activity_date": 1516216531, "last_edit_date": 1516216531, "creation_date": 1516189466, "answer_id": 48300368, "question_id": 48291956, "link": "https://stackoverflow.com/questions/48291956/how-to-update-existing-data-from-sheet1-to-sheet2-using-macro/48300368#48300368", "title": "How to update existing data from Sheet1 to Sheet2 using Macro?", "body": "<p>The following should do what you expect, I've commented the code so you may understand what it is doing:</p>\n\n<pre><code>Sub FindValues()\n    Dim lookUpSheet As Worksheet, updateSheet As Worksheet\n    Dim valueToSearch As String\n    Dim i As Long, t As Long\n\n    Set lookUpSheet = Worksheets(\"Sheet1\")\n    Set updateSheet = Worksheets(\"Sheet2\")\n\n    lastRowLookup = lookUpSheet.Cells(Rows.Count, \"A\").End(xlUp).Row\n    lastRowUpdate = updateSheet.Cells(Rows.Count, \"A\").End(xlUp).Row\n    'get the number of the last row with data in sheet1 and in sheet2\n\n    For i = 2 To lastRowLookup 'i = 2 to last to omit the first row as that row is for headers\n\n        valueFamily = lookUpSheet.Cells(i, 1) 'Family, 1 = Column A\n        valueDOB = lookUpSheet.Cells(i, 2) 'DOB, 2 = Column  B\n        valueName = lookUpSheet.Cells(i, 3) 'Name, 3 = Column C\n        valueAge = lookUpSheet.Cells(i, 4) 'Age, 4 = Column D\n        'above get the values from the four column into variables\n\n        For t = 2 To lastRowUpdate 't = 2 to last to omit the first row as that row is for headers\n            If updateSheet.Cells(t, 1) = valueFamily And updateSheet.Cells(t, 2) = valueDOB And updateSheet.Cells(t, 3) = valueName Then\n            'if family, dob and name match, then\n            updateSheet.Cells(t, 4) = valueAge\n            'update age value\n            Exit For\n            End If\n        Next t\n    Next i\nEnd Sub\n</code></pre>\n\n<p>This could be shortened without using the variables and comparing cells instead like below:</p>\n\n<pre><code>Sub FindValues()\n    Dim lookUpSheet As Worksheet, updateSheet As Worksheet\n    Dim i As Long, t As Long\n\n    Set lookUpSheet = Worksheets(\"Sheet1\")\n    Set updateSheet = Worksheets(\"Sheet2\")\n\n    lastRowLookup = lookUpSheet.Cells(Rows.Count, \"A\").End(xlUp).Row\n    lastRowUpdate = updateSheet.Cells(Rows.Count, \"A\").End(xlUp).Row\n    'get the number of the last row with data in sheet1 and in sheet2\n\n    For i = 2 To lastRowLookup 'i = 2 to last to omit the first row as that row is for headers\n        For t = 2 To lastRowUpdate 't = 2 to last to omit the first row as that row is for headers\n            If updateSheet.Cells(t, 1) = lookUpSheet.Cells(i, 1) And updateSheet.Cells(t, 2) = lookUpSheet.Cells(i, 2) And updateSheet.Cells(t, 3) = lookUpSheet.Cells(i, 3) Then\n            'if family, dob and name match, then\n            updateSheet.Cells(t, 4) = lookUpSheet.Cells(i, 4)\n            'update age value\n            Exit For\n            End If\n        Next t\n    Next i\nEnd Sub\n</code></pre>\n\n<p>The issue you were having is from the fact that you needed to have the IF Statement look at the first 3 cells instead of a single value, so with the AND between conditions you compare all three.</p>\n"}, {"comments": [{"owner": {"reputation": 3, "user_id": 8639581, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d839237884f053dcc197f1c112bd76b3?s=128&d=identicon&r=PG&f=1", "display_name": "Zero", "link": "https://stackoverflow.com/users/8639581/zero"}, "edited": false, "score": 0, "creation_date": 1516234398, "post_id": 48300473, "comment_id": 83609836, "body": "Thank you so much for this. I will try this code on my next form so that I can have an idea on how to make it work with adodb. I still have plenty of forms left and will select if which form needs an adodb or just a simple table for my database :)"}], "tags": [], "owner": {"reputation": 7206, "user_id": 8107092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dce232725da0108d5e43f3eebcaddd91?s=128&d=identicon&r=PG&f=1", "display_name": "Dy.Lee", "link": "https://stackoverflow.com/users/8107092/dy-lee"}, "is_accepted": false, "score": 0, "last_activity_date": 1516189807, "creation_date": 1516189807, "answer_id": 48300473, "question_id": 48291956, "link": "https://stackoverflow.com/questions/48291956/how-to-update-existing-data-from-sheet1-to-sheet2-using-macro/48300473#48300473", "title": "How to update existing data from Sheet1 to Sheet2 using Macro?", "body": "<p>This is how to update to sql using adodb.</p>\n\n<pre><code>Sub UpdateSQL()\n\n    Dim Cn As Object\n    Dim strConn As String, Name As String\n    Dim Ws As Worksheet\n    Dim strSQL As String\n    Dim i As Integer\n    Dim vDB\n\n    strConn = \"Provider=Microsoft.ACE.OLEDB.12.0;\" &amp; _\n        \"Data Source=\" &amp; ThisWorkbook.FullName &amp; \";\" &amp; _\n            \"Extended Properties=Excel 12.0;\"\n    Set Ws = Sheets(1)\n    Name = Sheets(2).Name\n    With Ws\n        vDB = .Range(\"a2\", .Range(\"d\" &amp; Rows.Count).End(xlUp))\n    End With\n\n    Set Cn = CreateObject(\"ADODB.Connection\")\n    Cn.Open strConn\n\n    For i = 1 To UBound(vDB, 1)\n        strSQL = \"UPDATE [\" &amp; Name &amp; \"$] set Age=\" &amp; vDB(i, 4) &amp; \" where Family = '\" &amp; vDB(i, 1) &amp; \"' AND DOB =#\" &amp; vDB(i, 2) &amp; \"# AND Name='\" &amp; vDB(i, 3) &amp; \"' \"\n        Cn.Execute strSQL\n    Next i\n\n    Cn.Close\n    Set Cn = Nothing\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 8639581, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d839237884f053dcc197f1c112bd76b3?s=128&d=identicon&r=PG&f=1", "display_name": "Zero", "link": "https://stackoverflow.com/users/8639581/zero"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 749, "favorite_count": 0, "accepted_answer_id": 48300368, "answer_count": 2, "score": 0, "last_activity_date": 1516216531, "creation_date": 1516149126, "last_edit_date": 1531164843, "question_id": 48291956, "link": "https://stackoverflow.com/questions/48291956/how-to-update-existing-data-from-sheet1-to-sheet2-using-macro", "title": "How to update existing data from Sheet1 to Sheet2 using Macro?", "body": "<p>I just want to ask if someone do have a code for this.\nI have a saved data in Sheet2 and I want to update it using the new data from Sheet1. In the below example, the code will search for Family \"Oh\" in Sheet2 and update its details using the updated information from Sheet1 when I click on the Update button. Here are the screenshots of</p>\n\n<p>Sheet1:</p>\n\n<p><a href=\"https://i.stack.imgur.com/XEBId.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/XEBId.jpg\" alt=\"Sheet1\"></a></p>\n\n<p>and</p>\n\n<p>Sheet2:</p>\n\n<p><a href=\"https://i.stack.imgur.com/bSZe8.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/bSZe8.jpg\" alt=\"Sheet2\"></a></p>\n\n<p>Tried this code but I can't get it to work correctly</p>\n\n<pre><code>Sub FindValues()\n\nDim lookUpSheet As Worksheet, updateSheet As Worksheet\nDim valueToSearch As String\nDim i As Integer, t As Integer\n\nSet lookUpSheet = Worksheets(\"sheet1\")\nSet updateSheet = Worksheets(\"sheet2\")\n\n'get the number of the last row with data in sheet1 and in sheet2\nlastRowLookup = lookUpSheet.Cells(Rows.Count, \"A\").End(xlUp).Row\nlastRowUpdate = updateSheet.Cells(Rows.Count, \"A\").End(xlUp).Row\n\n'for every value in column A of sheet2\nFor i = 1 To lastRowUpdate\n valueToSearch = updateSheet.Cells(i, 1)\n 'look the value in column A of sheet1\n For t = 1 To lastRowLookup\n    'if found a match, copy column B value to sheet1 and proceed to the next value\n    If lookUpSheet.Cells(t, 1) = valueToSearch Then\n        updateSheet.Cells(i, 2) = lookUpSheet.Cells(t, 2)\n        Exit For\n    End If\n Next t\n Next i\n\nEnd Sub\n</code></pre>\n\n<p>Thank you in advance for your help</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2266, "user_id": 3221380, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/zaKk5.png?s=128&g=1", "display_name": "Sgdva", "link": "https://stackoverflow.com/users/3221380/sgdva"}, "edited": false, "score": 0, "creation_date": 1516146236, "post_id": 48291503, "comment_id": 83568187, "body": "Welcome to S.O! Have you tried anything? If so, please, provide the code. Take a look to the <a href=\"http://stackoverflow.com/tour\">tour</a> and <a href=\"http://stackoverflow.com/help/how-to-ask\">how to ask</a>. Friendly reminder: StackOverflow is not a &quot;we code for you&quot; service provider.<a href=\"https://blog.udemy.com/excel-macros-tutorial/\" rel=\"nofollow noreferrer\">Introduction to VBA</a> or <a href=\"http://analysistabs.com/excel-vba/codes-examples-macros-how-tos-most-useful-basics-advanced/\" rel=\"nofollow noreferrer\">Mid-Advanced Tutorials</a> and my <a href=\"http://analystcave.com/excel-vba-tutorial/\" rel=\"nofollow noreferrer\">personal favorite</a>"}, {"owner": {"reputation": 3, "user_id": 9100836, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Sv20gL-6v9M/AAAAAAAAAAI/AAAAAAAADrY/r3WPu4y6eG0/photo.jpg?sz=128", "display_name": "Mark Johnson", "link": "https://stackoverflow.com/users/9100836/mark-johnson"}, "reply_to_user": {"reputation": 2266, "user_id": 3221380, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/zaKk5.png?s=128&g=1", "display_name": "Sgdva", "link": "https://stackoverflow.com/users/3221380/sgdva"}, "edited": false, "score": 0, "creation_date": 1517588401, "post_id": 48291503, "comment_id": 84170573, "body": "How do I mark Xabier&#39;s reply as an answer?"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 9100836, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Sv20gL-6v9M/AAAAAAAAAAI/AAAAAAAADrY/r3WPu4y6eG0/photo.jpg?sz=128", "display_name": "Mark Johnson", "link": "https://stackoverflow.com/users/9100836/mark-johnson"}, "edited": false, "score": 0, "creation_date": 1517339429, "post_id": 48301059, "comment_id": 84052789, "body": "Sorry for the delayed response! Thanks a bunch this code worked beautifully!"}], "tags": [], "owner": {"reputation": 7497, "user_id": 8670372, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ir8a4Lbosmo/AAAAAAAAAAI/AAAAAAAAOtE/2eY5jK1atcc/photo.jpg?sz=128", "display_name": "Xabier", "link": "https://stackoverflow.com/users/8670372/xabier"}, "is_accepted": true, "score": 0, "last_activity_date": 1516191734, "creation_date": 1516191734, "answer_id": 48301059, "question_id": 48291503, "link": "https://stackoverflow.com/questions/48291503/sum-cellls-based-on-2-criteria-and-then-remove-rows-that-are-not-needed-after-su/48301059#48301059", "title": "sum cellls based on 2 criteria and then remove rows that are not needed after summing", "body": "<p>If I understood your question correctly, then the following should do what you expect:</p>\n\n<pre><code>Sub foo()\nDim ws As Worksheet: Set ws = Sheets(\"Sheet1\")\n'declare and set your worksheet, amend as required\nLastRow = ws.Cells(ws.Rows.Count, \"A\").End(xlUp).Row\n'get the last row with data on Column A\n\nFor i = 1 To LastRow 'loop from row 1 to last\n    CheckValue = ws.Cells(i, 1) 'get the value from Column A\n    For x = 1 To LastRow 'do a second loop to check if we find any cell in Column B with \"Special Cash\"\n        If ws.Cells(x, 2) = \"Special Cash\" And ws.Cells(x, 1) = CheckValue Then ' if Special Cash found and there is another cell with the same Column A value\n            ws.Cells(x, 2) = \"Income\" 'replace Special Cash with Income\n        End If\n    Next x\nNext i\n    ws.Cells(1, 4).FormulaR1C1 = \"=SUMIFS(C[-1],C[-3],RC[-3],C[-2],RC[-2])\"\n    'add sum formula to column D\n    ws.Range(\"D1:D\" &amp; LastRow).FillDown\n    'fill the formula to the lastrow\n    ws.Range(\"D1:D\" &amp; LastRow).Copy\n    'copy values returned by formula\n    ws.Range(\"D1:D\" &amp; LastRow).PasteSpecial xlPasteValues\n    'paste the values and get rid of formula\n    ws.Columns(\"C:C\").Delete Shift:=xlToLeft\n    'delete column C and bring Column D into its place\n    Range(\"$A$1:$C$\" &amp; LastRow).RemoveDuplicates Columns:=Array(1, 2, 3), Header:=xlNo\n    'remove duplicates\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 9100836, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Sv20gL-6v9M/AAAAAAAAAAI/AAAAAAAADrY/r3WPu4y6eG0/photo.jpg?sz=128", "display_name": "Mark Johnson", "link": "https://stackoverflow.com/users/9100836/mark-johnson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 143, "favorite_count": 1, "accepted_answer_id": 48301059, "answer_count": 1, "score": 0, "last_activity_date": 1516191734, "creation_date": 1516145686, "last_edit_date": 1531164843, "question_id": 48291503, "link": "https://stackoverflow.com/questions/48291503/sum-cellls-based-on-2-criteria-and-then-remove-rows-that-are-not-needed-after-su", "title": "sum cellls based on 2 criteria and then remove rows that are not needed after summing", "body": "<p>In the sample data below, I am trying to sum the rates if (1) the security in column A is duplicated and (2) if the description in column B says \"Income\" and \"Special Cash.\" Then take the sum and replace the rate value in Row 1, Column C. Lastly, remove Row 3 as it is no longer needed.</p>\n\n<pre><code>         Column A        Column B         Column C\n(Row 1) BIT US Equity    Income           .1167\n(Row 2) BIT US Equity    ST Cap Gain      .1110\n(Row 3) BIT US Equity    Special Cash     .13105\n(Row 4) AOL US Equity    Regular Cash     .12345\n(Row 5) RAC US Equity    LT Cap Gain      .10005\n</code></pre>\n\n<p>Any feedback would be much appreciated!</p>\n"}, {"tags": ["excel", "checkbox", "vba"], "answers": [{"tags": [], "owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "is_accepted": false, "score": 1, "last_activity_date": 1516145453, "creation_date": 1516145453, "answer_id": 48291468, "question_id": 48291425, "link": "https://stackoverflow.com/questions/48291425/linking-excel-checkbox-using-vba-to-a-cell-in-another-worksheet/48291468#48291468", "title": "Linking Excel Checkbox using VBA to a cell in another Worksheet", "body": "<p>You can change</p>\n\n<pre><code>.LinkedCell = c.Address\n</code></pre>\n\n<p>to something like</p>\n\n<pre><code>.LinkedCell = \"Sheet2!\" &amp; c.Address\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 9199652, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de9eb3469f1a1c03f5140456d52a405b?s=128&d=identicon&r=PG&f=1", "display_name": "PMehta", "link": "https://stackoverflow.com/users/9199652/pmehta"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1555, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1516145453, "creation_date": 1516145188, "last_edit_date": 1531161705, "question_id": 48291425, "link": "https://stackoverflow.com/questions/48291425/linking-excel-checkbox-using-vba-to-a-cell-in-another-worksheet", "title": "Linking Excel Checkbox using VBA to a cell in another Worksheet", "body": "<p>I am relatively new to Excel VBA. I have found the following code online to add multiple check boxes in excel in a particular worksheet (Let's call it Sheet 1):</p>\n\n<pre><code>Sub AddCheckBoxes()\n   On Error Resume Next\n   Dim c As Range, myRange As Range\n   Set myRange = Selection\n   For Each c In myRange.Cells\n   ActiveSheet.CheckBoxes.Add(c.Left, c.Top, c.Width, c.Height).Select\n   With Selection\n   .LinkedCell = c.Address\n   .Characters.Text = \"\"\n   .Name = c.Address\n\n   End With\n   Next\n   myRange.Select\n  End Sub\n</code></pre>\n\n<p>As seen above, each check box is linked to the cell it is located in. What I am trying to do is find out a way to link the result of the check box (True, False) to another sheet (let's call it worksheet 2) in the same excel file. For example, if I were to click a checkbox on row W9 on sheet 1, it should say True on W9 on sheet 2. Is there a way to tweak the above code to make that work?</p>\n\n<p>Thanks for your help in advance</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1516151444, "post_id": 48291347, "comment_id": 83569593, "body": "4th file based on what sort order?"}], "answers": [{"comments": [{"owner": {"reputation": 61, "user_id": 8251191, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/005e61a9cab0f768bb6e6dad5c09a076?s=128&d=identicon&r=PG&f=1", "display_name": "Souza Saulo", "link": "https://stackoverflow.com/users/8251191/souza-saulo"}, "edited": false, "score": 1, "creation_date": 1516233968, "post_id": 48291406, "comment_id": 83609724, "body": "You may be re right. I&#39;m using Excel 2013 so I&#39;ll need a diferent code."}], "tags": [], "owner": {"reputation": 5115, "user_id": 864696, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/88RyU.jpg?s=128&g=1", "display_name": "Ross Presser", "link": "https://stackoverflow.com/users/864696/ross-presser"}, "is_accepted": false, "score": 0, "last_activity_date": 1516145093, "creation_date": 1516145093, "answer_id": 48291406, "question_id": 48291347, "link": "https://stackoverflow.com/questions/48291347/vba-to-open-fourth-excel-file-in-a-folder/48291406#48291406", "title": "Vba to open fourth excel file in a folder", "body": "<p><code>Application.Filesearch</code> was removed from Excel in Office 2007. What version of Office are you using?</p>\n\n<p>Assuming you really do have <code>Application.Filesearch</code> available:</p>\n\n<pre><code>Sub OpenDoStuff()\n\n    Dim fs As FileSearch\n    Dim i As Integer\n    Dim wbk As Workbook\n\n    Set fs = Application.FileSearch\n\n    With fs\n    .LookIn = \"C:\\Users\\Saulo\\Desktop\\MINING\"\n    .Filename = \"*.xls\"\n    .Execute()\n\n    If .FoundFiles.Count &gt;= 4 Then\n        Set wbk = Workbooks.Open(.FoundFiles(3))\n       'do stuff here\n        wbk.Close(SaveChanges:=True)\n    End If\nEnd With\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 61, "user_id": 8251191, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/005e61a9cab0f768bb6e6dad5c09a076?s=128&d=identicon&r=PG&f=1", "display_name": "Souza Saulo", "link": "https://stackoverflow.com/users/8251191/souza-saulo"}, "edited": false, "score": 0, "creation_date": 1516234146, "post_id": 48292104, "comment_id": 83609773, "body": "Not sure where to insert the path to my file in this code. Plus I&#39;m kind of new to VBA so I find this code a bit complicated."}, {"owner": {"reputation": 6686, "user_id": 9086466, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JI5yN.png?s=128&g=1", "display_name": "Ctznkane525", "link": "https://stackoverflow.com/users/9086466/ctznkane525"}, "reply_to_user": {"reputation": 61, "user_id": 8251191, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/005e61a9cab0f768bb6e6dad5c09a076?s=128&d=identicon&r=PG&f=1", "display_name": "Souza Saulo", "link": "https://stackoverflow.com/users/8251191/souza-saulo"}, "edited": false, "score": 0, "creation_date": 1516234840, "post_id": 48292104, "comment_id": 83609933, "body": "I changed the WMI query to match your folder structure...and replaced the msgbox with your file open"}, {"owner": {"reputation": 61, "user_id": 8251191, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/005e61a9cab0f768bb6e6dad5c09a076?s=128&d=identicon&r=PG&f=1", "display_name": "Souza Saulo", "link": "https://stackoverflow.com/users/8251191/souza-saulo"}, "edited": false, "score": 0, "creation_date": 1516238343, "post_id": 48292104, "comment_id": 83610735, "body": "I just did it. Take care."}], "tags": [], "owner": {"reputation": 6686, "user_id": 9086466, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JI5yN.png?s=128&g=1", "display_name": "Ctznkane525", "link": "https://stackoverflow.com/users/9086466/ctznkane525"}, "is_accepted": false, "score": 0, "last_activity_date": 1516234789, "last_edit_date": 1516234789, "creation_date": 1516150357, "answer_id": 48292104, "question_id": 48291347, "link": "https://stackoverflow.com/questions/48291347/vba-to-open-fourth-excel-file-in-a-folder/48292104#48292104", "title": "Vba to open fourth excel file in a folder", "body": "<p>Files need to be sorted.</p>\n\n<p>I'm using WMI to get the files.  WMI will work on most environments.</p>\n\n<p>DisplayFourthFile relies on a secondary function to sort the array.  You can easily replace the MsgBox with the opening of your file.</p>\n\n<p>WMI doesn't support ORDER BY, hence the sort function.</p>\n\n<pre><code>Sub DisplayFourthFile()\n\n    ' Get the Data, Unfortunately WMI Has No ORDER BY\n    Set objWMIService = GetObject(\"winmgmts:\\\\.\\root\\cimv2\")\n    Set colFiles = objWMIService.ExecQuery _\n        (\"Select Name from CIM_DataFile  where Drive='C:' and Path = '\\\\Users\\\\Saulo\\\\Desktop\\\\MINING\\\\' And Name Like '%XLS%'\")\n\n    ' Set to Array\n    Dim files() As String\n    ReDim files(1 To colFiles.count)\n    Dim name As String\n    Dim i As Integer: i = 1\n    For Each objFile In colFiles\n      files(i) = objFile.name\n      i = i + 1\n    Next\n\n    ' Sort the Data\n    QuickSort files, 1, colFiles.count\n\n    If colFiles.count &gt;= 4 Then\n\n         Set wbk = Workbooks.Open(files(i))\n         ' do stuff here\n         wbk.Close(SaveChanges:=True)\n\n    End If\n\n    Set objWMIService = Nothing\n    Set colFiles = Nothing\nEnd Sub\n\nPublic Sub QuickSort(vArray As Variant, inLow As Long, inHi As Long)\n\n  Dim pivot   As Variant\n  Dim tmpSwap As Variant\n  Dim tmpLow  As Long\n  Dim tmpHi   As Long\n\n  tmpLow = inLow\n  tmpHi = inHi\n\n  pivot = vArray((inLow + inHi) \\ 2)\n\n  While (tmpLow &lt;= tmpHi)\n\n     While (vArray(tmpLow) &lt; pivot And tmpLow &lt; inHi)\n        tmpLow = tmpLow + 1\n     Wend\n\n     While (pivot &lt; vArray(tmpHi) And tmpHi &gt; inLow)\n        tmpHi = tmpHi - 1\n     Wend\n\n     If (tmpLow &lt;= tmpHi) Then\n        tmpSwap = vArray(tmpLow)\n        vArray(tmpLow) = vArray(tmpHi)\n        vArray(tmpHi) = tmpSwap\n        tmpLow = tmpLow + 1\n        tmpHi = tmpHi - 1\n     End If\n\n  Wend\n\n  If (inLow &lt; tmpHi) Then QuickSort vArray, inLow, tmpHi\n  If (tmpLow &lt; inHi) Then QuickSort vArray, tmpLow, inHi\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 61, "user_id": 8251191, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/005e61a9cab0f768bb6e6dad5c09a076?s=128&d=identicon&r=PG&f=1", "display_name": "Souza Saulo", "link": "https://stackoverflow.com/users/8251191/souza-saulo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 89, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1516234789, "creation_date": 1516144672, "last_edit_date": 1531164843, "question_id": 48291347, "link": "https://stackoverflow.com/questions/48291347/vba-to-open-fourth-excel-file-in-a-folder", "title": "Vba to open fourth excel file in a folder", "body": "<p>I need a VBA code to open only the fourth Excel file in a folder regardless of the file\u2019s name, do stuff on the file and close it</p>\n\n<p>I have tried to use</p>\n\n<pre><code>Sub OpenDoStuff()\n\nDim fs As FileSearch\nDim i As Integer\nDim wbk As Workbook\n\nSet fs = Application.FileSearch\n\nWith fs\n.LookIn = \"C:\\Users\\Saulo\\Desktop\\MINING\"\n.Filename = \"*.xls\"\nFor i = 3 To .Execute()\n    Set wbk = Workbooks.Open(.FoundFiles(i))\n    'do stuff here\nwbk.Close(SaveChanges:=True)\nEnd With\nEnd Sub\n</code></pre>\n\n<p>Any suggestions will be welcome.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 318, "user_id": 7103010, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-mJ5MGor2_yQ/AAAAAAAAAAI/AAAAAAAAAGc/wYKZy_kkFrU/photo.jpg?sz=128", "display_name": "Karl Kristjansson", "link": "https://stackoverflow.com/users/7103010/karl-kristjansson"}, "edited": false, "score": 0, "creation_date": 1516141456, "post_id": 48290668, "comment_id": 83566656, "body": "In what format are the lists?  Are they named excel ranges or part of larger tables?"}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 2, "creation_date": 1516141673, "post_id": 48290668, "comment_id": 83566729, "body": "Are any values duplicated <b>within</b> any columns??"}], "answers": [{"comments": [{"owner": {"reputation": 318, "user_id": 7103010, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-mJ5MGor2_yQ/AAAAAAAAAAI/AAAAAAAAAGc/wYKZy_kkFrU/photo.jpg?sz=128", "display_name": "Karl Kristjansson", "link": "https://stackoverflow.com/users/7103010/karl-kristjansson"}, "edited": false, "score": 0, "creation_date": 1516145062, "post_id": 48291053, "comment_id": 83567878, "body": "It would be very time consuming to Deduplicate 1100 lists with Data &gt; remove Duplicates."}, {"owner": {"reputation": 1654, "user_id": 1793332, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/41e09c9c0f4bb3417737464d90ca709d?s=128&d=identicon&r=PG", "display_name": "MattClarke", "link": "https://stackoverflow.com/users/1793332/mattclarke"}, "reply_to_user": {"reputation": 318, "user_id": 7103010, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-mJ5MGor2_yQ/AAAAAAAAAAI/AAAAAAAAAGc/wYKZy_kkFrU/photo.jpg?sz=128", "display_name": "Karl Kristjansson", "link": "https://stackoverflow.com/users/7103010/karl-kristjansson"}, "edited": false, "score": 0, "creation_date": 1516167991, "post_id": 48291053, "comment_id": 83573523, "body": "True. Could fairly easily record that as a macro on one column, then rerun the macro with 1100 click&#39;s of a button. Or record the macro as you do it manually for 10 columns -- then you only need to rerun the macro 100 times."}, {"owner": {"reputation": 318, "user_id": 7103010, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-mJ5MGor2_yQ/AAAAAAAAAAI/AAAAAAAAAGc/wYKZy_kkFrU/photo.jpg?sz=128", "display_name": "Karl Kristjansson", "link": "https://stackoverflow.com/users/7103010/karl-kristjansson"}, "edited": false, "score": 0, "creation_date": 1516209896, "post_id": 48291053, "comment_id": 83598612, "body": "Before I have a clue on how to assist on this question, I would need to know how these &quot;lists&quot; are.  Are they one table 1100 columns wide, in multiple sheets or even workbooks. Are multiple lists in a single column or do we have named ranges. A question on how to find duplicates in 1100 lists needs to provide some details about these 1100 lists."}, {"owner": {"reputation": 5, "user_id": 9226671, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c2d41ad290fbc675aec4a870549d7e5e?s=128&d=identicon&r=PG&f=1", "display_name": "Brock Sibert", "link": "https://stackoverflow.com/users/9226671/brock-sibert"}, "edited": false, "score": 1, "creation_date": 1516241827, "post_id": 48291053, "comment_id": 83611537, "body": "Thank you all for your insights! Karl, the lists are like you mentioned: one table 1100 columns wide. Also, I should mention that the list contains words, not numbers."}], "tags": [], "owner": {"reputation": 1654, "user_id": 1793332, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/41e09c9c0f4bb3417737464d90ca709d?s=128&d=identicon&r=PG", "display_name": "MattClarke", "link": "https://stackoverflow.com/users/1793332/mattclarke"}, "is_accepted": false, "score": 2, "last_activity_date": 1516142771, "creation_date": 1516142771, "answer_id": 48291053, "question_id": 48290668, "link": "https://stackoverflow.com/questions/48290668/finding-duplicates-across-a-thousand-lists/48291053#48291053", "title": "Finding Duplicates across a thousand lists", "body": "<ol>\n<li>Deduplicate each list using <code>Data</code> > <code>Remove Duplicates</code></li>\n<li>Collate all the lists into one long list</li>\n<li>Create a pivot table with the column of items as the Row dimension</li>\n<li>Use the same column as the Value displayed in the pivot table, and aggregate using Count.</li>\n<li>Sort the pivot table in descending order of that count.</li>\n</ol>\n\n<p>The count shows the number of lists in which each item appears. If any have a count of 1100 then they must occur in every list.</p>\n"}, {"comments": [{"owner": {"reputation": 5, "user_id": 9226671, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c2d41ad290fbc675aec4a870549d7e5e?s=128&d=identicon&r=PG&f=1", "display_name": "Brock Sibert", "link": "https://stackoverflow.com/users/9226671/brock-sibert"}, "edited": false, "score": 1, "creation_date": 1516295624, "post_id": 48325692, "comment_id": 83638984, "body": "Hi Karl, this is brilliant--and quite fast and intuitive as well! I can&#39;t thank you enough for your help. Have a great day!"}], "tags": [], "owner": {"reputation": 318, "user_id": 7103010, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-mJ5MGor2_yQ/AAAAAAAAAAI/AAAAAAAAAGc/wYKZy_kkFrU/photo.jpg?sz=128", "display_name": "Karl Kristjansson", "link": "https://stackoverflow.com/users/7103010/karl-kristjansson"}, "is_accepted": true, "score": 0, "last_activity_date": 1516340526, "last_edit_date": 1516340526, "creation_date": 1516292038, "answer_id": 48325692, "question_id": 48290668, "link": "https://stackoverflow.com/questions/48290668/finding-duplicates-across-a-thousand-lists/48325692#48325692", "title": "Finding Duplicates across a thousand lists", "body": "<p>Here's my non VBA solution to this fun problem.  The plan is to search each item in any one list and compare to all the other lists in the table.</p>\n\n<p>Start off by inserting a new \"A\" column to the left of your table.  Copy any list and paste to A35.</p>\n\n<ul>\n<li>if your goal is only to find items occuring in all lists, choose the smallest list.</li>\n<li>if you would like to analyse, choose the largest list or even multiple lists.</li>\n<li>you could include all items by copy/paste TRANSPOSE the entire table to new sheet.  then you have less than 30 colums.  copy paste each into one column and delete duplicates of this list with data--> remove duplicates.</li>\n</ul>\n\n<p>Now you need to create a formula in cell B35 that searches for the string in A35 in the range B1:B30.  You drag the formula all the way right and down.</p>\n\n<pre><code>=COUNTIF(B$1:B$30,$A30)\n</code></pre>\n\n<p>The results will be the count of each item found in each list.  In order to see if any item is in all lists, then all columns within the specific row should count at least 1 item.  To the right of the results, see what the minimum value in the row is with:</p>\n\n<pre><code>=MIN(B35:API35)\n</code></pre>\n\n<p>(assuming your table ends in column API)</p>\n\n<p>If any of your rows have a minimum of 1, then the item is included in all lists.</p>\n\n<p>You could then also sum up the line to see which items occur the most and you could use the \"max\" instead of \"min\" to see if any list has duplicates.</p>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 6745769, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-FQhwpkpOD24/AAAAAAAAAAI/AAAAAAAACBE/hA3D-XWQz2o/photo.jpg?sz=128", "display_name": "Brajesh", "link": "https://stackoverflow.com/users/6745769/brajesh"}, "is_accepted": false, "score": 0, "last_activity_date": 1516342423, "creation_date": 1516342423, "answer_id": 48335144, "question_id": 48290668, "link": "https://stackoverflow.com/questions/48290668/finding-duplicates-across-a-thousand-lists/48335144#48335144", "title": "Finding Duplicates across a thousand lists", "body": "<p>Please try to use this<a href=\"https://i.stack.imgur.com/IJOY0.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/IJOY0.jpg\" alt=\"Duplicate value in excel\"></a>\nIf it will not work I can help you with Macro VB code.<br>\nLogic will be as below:<br>\n1. Keep 1st column as base to check all the other column<br>\n2. Check each 30 cell of the 1st column in a loop with all the other column cell.<br>\n3. Stop the loop, if you don't the value in an entire column.</p>\n"}], "owner": {"reputation": 5, "user_id": 9226671, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c2d41ad290fbc675aec4a870549d7e5e?s=128&d=identicon&r=PG&f=1", "display_name": "Brock Sibert", "link": "https://stackoverflow.com/users/9226671/brock-sibert"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 117, "favorite_count": 1, "accepted_answer_id": 48325692, "answer_count": 3, "score": 0, "last_activity_date": 1516342423, "creation_date": 1516140736, "last_edit_date": 1531161705, "question_id": 48290668, "link": "https://stackoverflow.com/questions/48290668/finding-duplicates-across-a-thousand-lists", "title": "Finding Duplicates across a thousand lists", "body": "<p>I have over 1,100 lists that each contain no more than 30 items in them. I am trying to see if there are any items within the lists that appear in all lists. I was initially thinking that I would need to compare the list in column A to the list in column B, store the duplicates, then compare the duplicates to the list in Column C, store the new duplicates, compare the new duplicates to the list in Column D, and so on until all the lists have been covered. </p>\n\n<p>My questions are:\n1.) Is this the correct way to approach this?\n2.) If so, is there a simple VBA code that could be used to do this?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1516139185, "post_id": 48290139, "comment_id": 83565737, "body": "Do you only have one Excel file open when you run the macro?"}, {"owner": {"reputation": 3, "user_id": 9226491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c235e51caf255d7ab248a779dd6c129?s=128&d=identicon&r=PG&f=1", "display_name": "NatalieF", "link": "https://stackoverflow.com/users/9226491/natalief"}, "reply_to_user": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1516140143, "post_id": 48290139, "comment_id": 83566136, "body": "Hi tigeravatar and thanks for your reply.  Yes I do (I just re-confirmed I had everything closed out expect the one workbook in question)."}, {"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1516140360, "post_id": 48290139, "comment_id": 83566232, "body": "Try <code>Set SourceWks = ActiveWorkbook.Sheets(&quot;Sheet2&quot;)</code> where Sheet2 is the actual name of your Source worksheet on the sheet tab."}, {"owner": {"reputation": 3, "user_id": 9226491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c235e51caf255d7ab248a779dd6c129?s=128&d=identicon&r=PG&f=1", "display_name": "NatalieF", "link": "https://stackoverflow.com/users/9226491/natalief"}, "reply_to_user": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1516141404, "post_id": 48290139, "comment_id": 83566641, "body": "Excellent tigeravatar...that did it.  Works great now.  I very much appreciate your assistance."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 9226491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c235e51caf255d7ab248a779dd6c129?s=128&d=identicon&r=PG&f=1", "display_name": "NatalieF", "link": "https://stackoverflow.com/users/9226491/natalief"}, "edited": false, "score": 0, "creation_date": 1516141823, "post_id": 48290729, "comment_id": 83566790, "body": "Thank you as well, Gary&#39;s Student.  I did have to add tigeravatar&#39;s suggestion of &quot;= ActiveWorkbook.Sheets(&quot;Sheet2&quot;)&quot; but your code works great as well.  Thanks much."}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": true, "score": 0, "last_activity_date": 1516141111, "creation_date": 1516141111, "answer_id": 48290729, "question_id": 48290139, "link": "https://stackoverflow.com/questions/48290139/vba-to-delete-specific-rows-by-row-number/48290729#48290729", "title": "VBA to delete specific rows by row number", "body": "<p>Consider:</p>\n\n<pre><code>Sub rowKiller()\n\n    Dim SourceWks As Worksheet, deleteWks As Worksheet\n    Dim rng As Range, i As Long\n\n    Set SourceWks = Sheet2\n    Set deleteWks = Sheet1\n\n    Set rng = SourceWks.Columns(1).SpecialCells(2)\n    rng.Sort Key1:=rng(1), Order1:=xlDescending, Header:=xlNo, _\n            OrderCustom:=1, MatchCase:=False, Orientation:=xlTopToBottom, _\n            DataOption1:=xlSortNormal\n\n    For Each r In rng\n        i = r.Value\n        deleteWks.Rows(i).EntireRow.Delete\n    Next r\n\nEnd Sub\n</code></pre>\n\n<p><strong>NOTES:</strong></p>\n\n<p>The reason we sort the row list <em>descending</em> because we want to delete the rows in <em>Sheet1</em> from the bottom upwards.</p>\n"}], "owner": {"reputation": 3, "user_id": 9226491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c235e51caf255d7ab248a779dd6c129?s=128&d=identicon&r=PG&f=1", "display_name": "NatalieF", "link": "https://stackoverflow.com/users/9226491/natalief"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1321, "favorite_count": 1, "accepted_answer_id": 48290729, "answer_count": 1, "score": 0, "last_activity_date": 1516171271, "creation_date": 1516138207, "last_edit_date": 1531161705, "question_id": 48290139, "link": "https://stackoverflow.com/questions/48290139/vba-to-delete-specific-rows-by-row-number", "title": "VBA to delete specific rows by row number", "body": "<p>If anyone is willing to help me, I'd be most grateful.</p>\n\n<p>Basically I would like to perform the same task as what was featured in this thread...</p>\n\n<p><a href=\"https://stackoverflow.com/questions/13878022/excel-marcro-delete-a-row-based-on-row-number\">Excel Marcro - delete a row based on row number</a></p>\n\n<p>I have a list of 3500+ lines and need to occasionally delete about 25-30 (non-consecutive) rows based on row number (the row #s will vary every time).  I'd like to list the row numbers (to be deleted) on Sheet2 (in Column A) and have the code automatically read the row numbers on Sheet2 and delete those rows from Sheet1.  I tried the code provided in the thread and I get a \"run-time error 424\" Object required.  If I mouse over the error it tells me \"SourceWks = Nothing\" and \"Sheet2 = Empty\".  I do have data contained in the sheet(s). I'm sure I'm just missing something simple.</p>\n\n<p>I'll paste the code I'm using below (again it is from the original thread which was reported by the user to work just fine)...</p>\n\n<pre><code>Dim deleteRows As Range\nDim data() As Variant\nDim i As Double\n\nDim SourceWks As Worksheet, deleteWks As Worksheet\n\nSet SourceWks = Sheet2\nSet deleteWks = Sheet1\n\n    With SourceWks\n        data = .Range(.Cells(1, 1), .Cells(1, 1).End(xlDown))\n    End With\n\n    Set deleteRows = deleteWks.Rows(data(1, 1))\n\n    For i = 2 To UBound(data, 1)\n\n        Set deleteRows = Union(deleteRows, deleteWks.Rows(data(i, 1)))\n\n    Next i\n\n    deleteRows.Delete Shift:=xlUp\n</code></pre>\n\n<p>I've tried it both ways...keeping Sheet1 named \"Sheet1\" and Sheet2 named \"Sheet2\" and I've also tried changing the sheets to be named to: \"deleteWKS\" and \"SourceWks\" all with the same results.</p>\n\n<p>If anyone can please let me know what I'm doing incorrectly, I'd be most appreciative.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 1, "creation_date": 1516147402, "post_id": 48289422, "comment_id": 83568510, "body": "Understand that even if you protect vba in your workbook, there are always ways around it, so it should never be used to code with service account credentials. VBA is low level programming, and if you want to write something more secure, you should be using something like <code>VB.NET</code> instead and use encryption."}, {"owner": {"reputation": 36788, "user_id": 2887618, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e643417e67e5a3bb9f659e4491ed26b0?s=128&d=identicon&r=PG&f=1", "display_name": "Florent B.", "link": "https://stackoverflow.com/users/2887618/florent-b"}, "edited": false, "score": 1, "creation_date": 1516199328, "post_id": 48289422, "comment_id": 83591561, "body": "Send the post request with xmlhttp and store the returned cookies related to the session. Then navigate the targeted domain and set the cookies."}, {"owner": {"reputation": 1583, "user_id": 1981678, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/8c454e4c5a0e8a506b87c1902d13aeff?s=128&d=identicon&r=PG&f=1", "display_name": "briansol", "link": "https://stackoverflow.com/users/1981678/briansol"}, "reply_to_user": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1516200522, "post_id": 48289422, "comment_id": 83592351, "body": "@braX, understood it&#39;s not the most secure thing in the world.  This is an internal corp app and requires vpn access to hit anyway.  It&#39;s mostly just to keep people from seeing it/having to type it in then it is about true security.   Florent B, that sounds possible.  Have you ever done this successfully?  I don&#39;t know how to store cookies in excel."}], "answers": [{"tags": [], "owner": {"reputation": 276, "user_id": 9379711, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KdliM.jpg?s=128&g=1", "display_name": "EarlyBird2", "link": "https://stackoverflow.com/users/9379711/earlybird2"}, "is_accepted": true, "score": 1, "last_activity_date": 1525951031, "creation_date": 1525951031, "answer_id": 50271683, "question_id": 48289422, "link": "https://stackoverflow.com/questions/48289422/posting-with-an-open-event/50271683#50271683", "title": "Posting with an open event", "body": "<p>Adding to what @Florent B. has posted, check whether the cookie is set when calling the login page (which I assume) or really when posting the login data.  </p>\n\n<pre><code>Dim xhttp As MSXML2.XMLHTTP ' make sure you reference to MSXML!\nDim strCookie As String\n\nSet xHttp = New MSXML2.XMLHTTP\nXMLHttp.Open \"GET\" TheURLOfYourLogInPage\n\nIf xHttp.Status = 200 Then\n    strCookie = xHttp.getResponseHeader(\"Set-Cookie\")\nEnd If\n</code></pre>\n\n<p>Check your web browser for what is sent to the server when login in, probably something like <code>\"username=\" &amp; YourUserName &amp; \"&amp;password=\" &amp; YourPassword &amp; \"&amp;cookie=\" &amp; strCookie</code> Declare another string variable (I will call it strTicker) and fill it accordingly, then </p>\n\n<pre><code>xHttp.Open \"POST\", \"URLOfYourLoginPage\"\nxHttp.setRequestHeader \"Cookie\", strCookie\nxHttp.send strTicker\n</code></pre>\n"}], "owner": {"reputation": 1583, "user_id": 1981678, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/8c454e4c5a0e8a506b87c1902d13aeff?s=128&d=identicon&r=PG&f=1", "display_name": "briansol", "link": "https://stackoverflow.com/users/1981678/briansol"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 125, "favorite_count": 1, "accepted_answer_id": 50271683, "answer_count": 1, "score": 4, "last_activity_date": 1525951031, "creation_date": 1516134936, "question_id": 48289422, "link": "https://stackoverflow.com/questions/48289422/posting-with-an-open-event", "title": "Posting with an open event", "body": "<p><strong>Action:</strong>  Trying to 'post' excel data to a webpage that the user sees/uses with a vba code event.</p>\n\n<p><strong>Issue:</strong>  I can open a window with a get, or I can xmlhttp with a post and a get a response variable, but neither is what I need.   I need to POST login information (a service account) from baked in vba code on a button to POST and open a browser.   </p>\n\n<p>The webpage is behind Spring Security and the service account credentials should not be known to the user, it's hidden in a protected workbook/vba.  I need to post those over to the url.</p>\n\n<p>--> How do I open AND post at the same time?</p>\n\n<p>What I need is the excel equivalent of an HTML form post with a   </p>\n\n<pre><code>target=_blank\n</code></pre>\n\n<p>attribute in vba. Is this possible?</p>\n\n<p>I've tried both </p>\n\n<pre><code>ShellExecute\n</code></pre>\n\n<p>functions\nand</p>\n\n<pre><code>xmlhttp\n</code></pre>\n\n<p>methods\nbut both only give me half of the package.</p>\n\n<p>Any advice?</p>\n"}, {"tags": ["vba", "excel", "email", "if-statement"], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 8617134, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b730e1797ac40facee2bd8d647e84a5?s=128&d=identicon&r=PG&f=1", "display_name": "ken_you_not", "link": "https://stackoverflow.com/users/8617134/ken-you-not"}, "edited": false, "score": 0, "creation_date": 1516147120, "post_id": 48289497, "comment_id": 83568431, "body": "Hey! looks good and thank you for the swift response. I did use your code, but couldn&#39;t run it as the macro selection table popped out and there is nothing to select, so I&#39;m stucked there. Also, what&#39;s the point of adding &quot;(Target.Address)&quot; behind the &quot;Call mymacro&quot; code?"}, {"owner": {"reputation": 878, "user_id": 7321366, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/8168d183e450bbb72f0c3341c847af5c?s=128&d=identicon&r=PG&f=1", "display_name": "pokemon_Man", "link": "https://stackoverflow.com/users/7321366/pokemon-man"}, "reply_to_user": {"reputation": 33, "user_id": 8617134, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b730e1797ac40facee2bd8d647e84a5?s=128&d=identicon&r=PG&f=1", "display_name": "ken_you_not", "link": "https://stackoverflow.com/users/8617134/ken-you-not"}, "edited": false, "score": 0, "creation_date": 1516197952, "post_id": 48289497, "comment_id": 83590598, "body": "@ken_you_not you do not need to run it, put all the code in your sheet code such as &quot;Sheet1&quot;...., just enter a &quot;1&quot; in cell F3 and the code should run itself because it is actviated on the worksheet change event which means anything that changes in F3 to F14 and equal to 1 will trigger your code. Target.Address is the cell location that is changing so that if your values does change, it captures the cell change and output in your email code."}, {"owner": {"reputation": 33, "user_id": 8617134, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b730e1797ac40facee2bd8d647e84a5?s=128&d=identicon&r=PG&f=1", "display_name": "ken_you_not", "link": "https://stackoverflow.com/users/8617134/ken-you-not"}, "edited": false, "score": 0, "creation_date": 1516204524, "post_id": 48289497, "comment_id": 83595196, "body": "Got it haha. The code can be run now, but that&#39;s only if I manually change the target cells. The main problem is still there, the code would not run if the cells are updated via query refresh though. Any thoughts? Thanks a lot for helping me to clear my first hurdle though :)"}, {"owner": {"reputation": 33, "user_id": 8617134, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b730e1797ac40facee2bd8d647e84a5?s=128&d=identicon&r=PG&f=1", "display_name": "ken_you_not", "link": "https://stackoverflow.com/users/8617134/ken-you-not"}, "edited": false, "score": 0, "creation_date": 1516296976, "post_id": 48289497, "comment_id": 83639829, "body": "Thank you bro! Everything works as expected. Appreciate your help! :)"}], "tags": [], "owner": {"reputation": 878, "user_id": 7321366, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/8168d183e450bbb72f0c3341c847af5c?s=128&d=identicon&r=PG&f=1", "display_name": "pokemon_Man", "link": "https://stackoverflow.com/users/7321366/pokemon-man"}, "is_accepted": true, "score": 1, "last_activity_date": 1516206157, "last_edit_date": 1516206157, "creation_date": 1516135248, "answer_id": 48289497, "question_id": 48289351, "link": "https://stackoverflow.com/questions/48289351/sending-specific-email-based-on-cell-values-in-excel-2016/48289497#48289497", "title": "Sending specific email based on cell values in Excel 2016", "body": "<p>On refresh of query, the code should check each cell from F3 to F14 and see if it is equal to 1, if so, it will email user the cell location.</p>\n\n<p>UPDATE:</p>\n\n<pre><code>'Need to be in the sheet code:\nPrivate Sub Worksheet_Change(ByVal Target As Range)\n    Call notify\nEnd Sub\n\nSub notify()\n    Dim rng As Range\n    For Each rng In Range(\"F3:F14\")\n       If (rng.Value = 1) Then\n           Call mymacro(rng.Address)\n       End If\n    Next rng\nEnd Sub\n\nPrivate Sub mymacro(theValue As String)\n    Dim xOutApp As Object\n    Dim xOutMail As Object\n    Dim xMailBody As String\n    Set xOutApp = CreateObject(\"Outlook.Application\")\n    Set xOutMail = xOutApp.CreateItem(0)\n    xMailBody = \"Hi there\" &amp; vbNewLine &amp; vbNewLine &amp; _\n              \"The value that changed is in cell: \" &amp; theValue\n    On Error Resume Next\n    With xOutMail\n        .To = \"email address\"\n        .CC = \"\"\n        .BCC = \"\"\n        .Subject = \"test succeeded\"\n        .Body = xMailBody\n        .Display   'or use .Send\n    End With\n    On Error GoTo 0\n    Set xOutMail = Nothing\n    Set xOutApp = Nothing\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 8617134, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b730e1797ac40facee2bd8d647e84a5?s=128&d=identicon&r=PG&f=1", "display_name": "ken_you_not", "link": "https://stackoverflow.com/users/8617134/ken-you-not"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 8780, "favorite_count": 1, "accepted_answer_id": 48289497, "answer_count": 1, "score": 1, "last_activity_date": 1578600538, "creation_date": 1516134692, "question_id": 48289351, "link": "https://stackoverflow.com/questions/48289351/sending-specific-email-based-on-cell-values-in-excel-2016", "title": "Sending specific email based on cell values in Excel 2016", "body": "<p>is there a more efficient way to send email reminders to a user based on a cell value that changes frequently? Here's the code of what I'm working on, so that you guys could understand the context of the question.</p>\n\n<pre><code>   'This is the main function\n\nSub notify()          \n Dim rng As Range\n For Each rng In Range(\"F3:F14\")\n    If (rng.Value = 1) Then\n        Call mymacro\n    End If\n Next rng\n\nEnd Sub\n-----------------------------------------------------------------------\n\n  'This is the function that sends an email when called by the main function\n\n  Private Sub mymacro()  \n    Dim xOutApp As Object\n    Dim xOutMail As Object\n    Dim xMailBody As String\n    Set xOutApp = CreateObject(\"Outlook.Application\")\n    Set xOutMail = xOutApp.CreateItem(0)\n    xMailBody = \"Hi there\" &amp; vbNewLine &amp; vbNewLine &amp; _\n              \"This is line 1\" &amp; vbNewLine &amp; _\n              \"This is line 2\"\n    On Error Resume Next\n    With xOutMail\n        .To = \"email address\"\n        .CC = \"\"\n        .BCC = \"\"\n        .Subject = \"test succeeded\"\n        .Body = xMailBody\n        .Display   'or use .Send\n    End With\n    On Error GoTo 0\n    Set xOutMail = Nothing\n    Set xOutApp = Nothing\nEnd Sub\n</code></pre>\n\n<p>Explanation:</p>\n\n<p>Both codes above are located in the same module of my worksheet. The code worked absolutely fine to send an email (through Outlook) to the user. For example, if F3 and F7 evaluate to true, two emails will be sent to the user.</p>\n\n<p>Now, here's the problem, how can I edit my code, such that if the same situation occurs (F3 and F7 evaluate to true), the two email sent to the user would specify which cell evaluates to true. In other words, each email sent would be different in pointing out which specific cell was evaluated to true.</p>\n\n<p>Also, would the code be able to rerun if the data inside the cell (\"F3:F14\") is updated?</p>\n\n<p>I personally do not have any VBA background, so it would be nice if you guys could explain it in layman's term. Thank you! Really appreciate it! :)</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1516134609, "post_id": 48289310, "comment_id": 83563580, "body": "&quot; It just copies part of a row then pastes it into another worksheet&quot; - Isn&#39;t that what you want? Or does it not copy all of what you&#39;re expecting? Can you clarify the issue?"}, {"owner": {"reputation": 65, "user_id": 9226292, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d3e330dd3e73989c0297a31bed9d7b72?s=128&d=identicon&r=PG&f=1", "display_name": "J Doe", "link": "https://stackoverflow.com/users/9226292/j-doe"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1516134774, "post_id": 48289310, "comment_id": 83563652, "body": "@BruceWayne it&#39;s copying what I am expecting but it is copying and pasting it indiscriminately and does not continue checking to the next row afterwards.  I need Excel to check if there is a value in Column R first then copy and paste if a value exists.  If not, continue down the next row.  I apologize for not being clear, I will edit now."}, {"owner": {"reputation": 3423, "user_id": 1738572, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/s0VGr.jpg?s=128&g=1", "display_name": "Greg Viers", "link": "https://stackoverflow.com/users/1738572/greg-viers"}, "edited": false, "score": 0, "creation_date": 1516134825, "post_id": 48289310, "comment_id": 83563674, "body": "So you are saying that this test is not functioning properly? If c.Value &gt; &quot;0&quot; Then"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1516134837, "post_id": 48289310, "comment_id": 83563682, "body": "Check your variable declaration. You set <code>wsI</code> to <code>Sheet2</code>, but I think you need to switch those around.  You&#39;re looping through a range on Sheet2, and copying the range on <code>Sheet2</code>. Don&#39;t you want that to be Sheet1?"}, {"owner": {"reputation": 65, "user_id": 9226292, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d3e330dd3e73989c0297a31bed9d7b72?s=128&d=identicon&r=PG&f=1", "display_name": "J Doe", "link": "https://stackoverflow.com/users/9226292/j-doe"}, "reply_to_user": {"reputation": 3423, "user_id": 1738572, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/s0VGr.jpg?s=128&g=1", "display_name": "Greg Viers", "link": "https://stackoverflow.com/users/1738572/greg-viers"}, "edited": false, "score": 0, "creation_date": 1516134959, "post_id": 48289310, "comment_id": 83563734, "body": "@TheTTGGuy it appears that it is not functioning properly.  There is no value in column R yet Excel will still copy the row and paste it into the Sheet2."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 1, "creation_date": 1516134986, "post_id": 48289310, "comment_id": 83563748, "body": "Umm - <code>Set rSource = .Range(&quot;R&quot; &amp; lastrow)</code> - that is setting <code>rSource</code> to the <b>single</b> cell which is the last cell in column R, so there isn&#39;t much point in then doing a <code>For Each c In rSource</code>, you may as well just <code>Set c = .Range(&quot;R&quot; &amp; lastrow)</code>"}, {"owner": {"reputation": 3423, "user_id": 1738572, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/s0VGr.jpg?s=128&g=1", "display_name": "Greg Viers", "link": "https://stackoverflow.com/users/1738572/greg-viers"}, "edited": false, "score": 0, "creation_date": 1516135066, "post_id": 48289310, "comment_id": 83563799, "body": "Add a line in the code above that: debug.print c.Value"}, {"owner": {"reputation": 65, "user_id": 9226292, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d3e330dd3e73989c0297a31bed9d7b72?s=128&d=identicon&r=PG&f=1", "display_name": "J Doe", "link": "https://stackoverflow.com/users/9226292/j-doe"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1516135079, "post_id": 48289310, "comment_id": 83563806, "body": "@BruceWayne You are correct - I changed the sheet names initially for privacy and looks like I got them mixed up.  Thank you for pointing that one out"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 1, "creation_date": 1516135130, "post_id": 48289310, "comment_id": 83563836, "body": "And, of course, you have hard-coded the copy to always copy the three cells in columns O, P and Q of row 3."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 1, "creation_date": 1516135184, "post_id": 48289310, "comment_id": 83563861, "body": "To piggy back off @YowE3K - Try <code>.Range(&quot;O&quot; &amp; c.row &amp; &quot;:Q&quot; &amp; c.row).Copy</code>"}, {"owner": {"reputation": 65, "user_id": 9226292, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d3e330dd3e73989c0297a31bed9d7b72?s=128&d=identicon&r=PG&f=1", "display_name": "J Doe", "link": "https://stackoverflow.com/users/9226292/j-doe"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1516135268, "post_id": 48289310, "comment_id": 83563904, "body": "@YowE3K I will change the first suggestion you made.  How should I change the copy function to copy the cells adjacent to the the current cell that is being checked for an existing value (in Column R)?"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1516135270, "post_id": 48289310, "comment_id": 83563906, "body": "@BruceWayne I think it probably needs to be column N to R based on the OP&#39;s statement &quot;copy that cell and the four adjacent cells to the left of it&quot; but, yeah, that looks a lot more sensible."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 1, "creation_date": 1516135391, "post_id": 48289310, "comment_id": 83563972, "body": "Don&#39;t change things based on my first suggestion - that was just pointing out that you are only processing <b>one</b> cell.  I suspect (but don&#39;t understand the question enough to be sure) that you really meant to use <code>Set rSource = .Range(&quot;R1:R&quot; &amp; lastRow)</code>."}, {"owner": {"reputation": 65, "user_id": 9226292, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d3e330dd3e73989c0297a31bed9d7b72?s=128&d=identicon&r=PG&f=1", "display_name": "J Doe", "link": "https://stackoverflow.com/users/9226292/j-doe"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1516135539, "post_id": 48289310, "comment_id": 83564051, "body": "@YowE3K I made the change to the .Range command.  It looks like that&#39;s exactly what I needed! Is there a way to make this a loop now so that once it pastes, it will continue looking down the next row?"}, {"owner": {"reputation": 65, "user_id": 9226292, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d3e330dd3e73989c0297a31bed9d7b72?s=128&d=identicon&r=PG&f=1", "display_name": "J Doe", "link": "https://stackoverflow.com/users/9226292/j-doe"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1516135634, "post_id": 48289310, "comment_id": 83564092, "body": "@BruceWayne I made the change you suggested to the Range command and it works exactly like I want it to.  Do you know how to turn this into a loop now so that it will continue looking onto the next row afterwards?"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 1, "creation_date": 1516135649, "post_id": 48289310, "comment_id": 83564101, "body": "See my previous comment. (It was probably written while you were writing your comment, so you probably didn&#39;t see it.)"}, {"owner": {"reputation": 65, "user_id": 9226292, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d3e330dd3e73989c0297a31bed9d7b72?s=128&d=identicon&r=PG&f=1", "display_name": "J Doe", "link": "https://stackoverflow.com/users/9226292/j-doe"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1516135888, "post_id": 48289310, "comment_id": 83564241, "body": "@YowE3K I apologize but I am not well versed in VBA - I have only started to teach myself the basics so I&#39;m not sure if I should have used that one.  It was just something I pulled from someone else&#39;s code.  I made the change to use      Set rSource = .Range(&quot;R1:R&quot; &amp; lastRow) to see what happens and it appears that nothing changed when I run the macro"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 1, "creation_date": 1516136586, "post_id": 48289310, "comment_id": 83564580, "body": "Do you still have the <code>For Each c In rSource</code> loop after the <code>Set rSource = .Range(&quot;R1:R&quot; &amp; lastRow)</code> statement?"}, {"owner": {"reputation": 65, "user_id": 9226292, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d3e330dd3e73989c0297a31bed9d7b72?s=128&d=identicon&r=PG&f=1", "display_name": "J Doe", "link": "https://stackoverflow.com/users/9226292/j-doe"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1516139068, "post_id": 48289310, "comment_id": 83565674, "body": "@YowE3K Yes I do still have     &gt;For Each c In rSource loop after the statement.  It looks like it only stops after the first copy+paste.  If I change Set rSource = .Range(&quot;R1:R&quot; &amp; lastRow) to be R7:R, it will copy+paste the value properly.  Then if I change it to R8:R, it will copy+paste the next value right under properly which is what I want.  But for some reason, it will not automatically cycle past that."}], "answers": [{"comments": [{"owner": {"reputation": 65, "user_id": 9226292, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d3e330dd3e73989c0297a31bed9d7b72?s=128&d=identicon&r=PG&f=1", "display_name": "J Doe", "link": "https://stackoverflow.com/users/9226292/j-doe"}, "edited": false, "score": 0, "creation_date": 1516138959, "post_id": 48290043, "comment_id": 83565622, "body": "To my amateur eyes, this code looks like it should do what I want it to but when I run the macro, it looks like nothing happens.  I&#39;m not quite sure what I&#39;m missing here...May I ask you to try the macro out?"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 65, "user_id": 9226292, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d3e330dd3e73989c0297a31bed9d7b72?s=128&d=identicon&r=PG&f=1", "display_name": "J Doe", "link": "https://stackoverflow.com/users/9226292/j-doe"}, "edited": false, "score": 1, "creation_date": 1516139385, "post_id": 48290043, "comment_id": 83565821, "body": "@JDoe Yes, works for me - you may need to include a screenshot of your data into the question (or single-step through the code to see what it is doing)"}, {"owner": {"reputation": 65, "user_id": 9226292, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d3e330dd3e73989c0297a31bed9d7b72?s=128&d=identicon&r=PG&f=1", "display_name": "J Doe", "link": "https://stackoverflow.com/users/9226292/j-doe"}, "edited": false, "score": 0, "creation_date": 1516139775, "post_id": 48290043, "comment_id": 83565992, "body": "I have created a new worksheet with example data that mirrors the layout of my data.  Here it is: <a href=\"https://imgur.com/a/Zjx9z\" rel=\"nofollow noreferrer\">imgur.com/a/Zjx9z</a> .  I ran the code and it appears nothing happens.  However when I remove row 1 with the words TEST, it will copy+paste row 3 (row that starts with jan) then stop.  I will need to keep row 1 in tact so my data that needs to be copy+pasted actually starts on row 3"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 65, "user_id": 9226292, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d3e330dd3e73989c0297a31bed9d7b72?s=128&d=identicon&r=PG&f=1", "display_name": "J Doe", "link": "https://stackoverflow.com/users/9226292/j-doe"}, "edited": false, "score": 1, "creation_date": 1516140144, "post_id": 48290043, "comment_id": 83566137, "body": "@JDoe You have data in O1:R2, so that is confusing your <code>Find</code> (because it finds the data in R2 and therefore sets <code>lastrow</code> to 2) - therefore it isn&#39;t copying anything at all.  I&#39;ll edit the answer to change <code>&quot;O3&quot;</code> to <code>&quot;O1&quot;</code>."}, {"owner": {"reputation": 65, "user_id": 9226292, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d3e330dd3e73989c0297a31bed9d7b72?s=128&d=identicon&r=PG&f=1", "display_name": "J Doe", "link": "https://stackoverflow.com/users/9226292/j-doe"}, "edited": false, "score": 0, "creation_date": 1516140847, "post_id": 48290043, "comment_id": 83566405, "body": "you solved it!  Thank you so so so much.  It is perfect now.  I have another question if it is appropriate to ask.  Is there a way I can can pull data from column J and place specific text with it then paste it into the next worksheet alongside those values we just pasted before?"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 65, "user_id": 9226292, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d3e330dd3e73989c0297a31bed9d7b72?s=128&d=identicon&r=PG&f=1", "display_name": "J Doe", "link": "https://stackoverflow.com/users/9226292/j-doe"}, "edited": false, "score": 1, "creation_date": 1516141127, "post_id": 48290043, "comment_id": 83566537, "body": "If you look at the line saying <code>wsO.Cells(5 + IRow, 12).Resize(1, 5).Value = .Range(&quot;N&quot; &amp; c.Row &amp; &quot;:R&quot; &amp; c.Row).Value</code>, you should be able to easily put another line straight after it changing &quot;12&quot; to whatever column you want to store the value in, changing the number of columns you want to process from &quot;5&quot; to &quot;1&quot;, and changing <code>&quot;N&quot; &amp; c.Row &amp; &quot;:R&quot; &amp; c.Row</code> to <code>&quot;J&quot; &amp; c.Row &amp; &quot;:J&quot; &amp; c.Row</code>  (or it can be simplified to, for example, <code>wsO.Cells(5 + IRow, 17).Value = .Range(&quot;J&quot; &amp; c.Row).Value</code>)"}, {"owner": {"reputation": 65, "user_id": 9226292, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d3e330dd3e73989c0297a31bed9d7b72?s=128&d=identicon&r=PG&f=1", "display_name": "J Doe", "link": "https://stackoverflow.com/users/9226292/j-doe"}, "edited": false, "score": 0, "creation_date": 1516141923, "post_id": 48290043, "comment_id": 83566845, "body": "that is just about what I needed to the T.  Just one more thing to question - is there a code I can insert into that that lets me combine words with the value in column J then paste it without affecting column J?  For example, J1 has value &quot;123&quot;.  I want to be able to add the words &quot;ID Number #&quot; right before it then have Excel paste &quot;ID Number #123&quot;.  All the while J1 will still say just &quot;123&quot; at the end of the day."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 65, "user_id": 9226292, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d3e330dd3e73989c0297a31bed9d7b72?s=128&d=identicon&r=PG&f=1", "display_name": "J Doe", "link": "https://stackoverflow.com/users/9226292/j-doe"}, "edited": false, "score": 1, "creation_date": 1516142878, "post_id": 48290043, "comment_id": 83567185, "body": "You have to stop asking questions and do some research yourself!  (But, FWIW, to concatenate two strings you can use the <code>&amp;</code> operator - so <code>wsO.Cells(5 + IRow, 17).Value =  &quot;ID Number #&quot; &amp; .Range(&quot;J&quot; &amp; c.Row).Value</code> )"}, {"owner": {"reputation": 65, "user_id": 9226292, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d3e330dd3e73989c0297a31bed9d7b72?s=128&d=identicon&r=PG&f=1", "display_name": "J Doe", "link": "https://stackoverflow.com/users/9226292/j-doe"}, "edited": false, "score": 0, "creation_date": 1516143930, "post_id": 48290043, "comment_id": 83567531, "body": "I swear I did exactly that before and it didn&#39;t work!  But I tried just now and it worked....haha...Thank you so much for all your help sir.  It does not go unappreciated :)"}], "tags": [], "owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "is_accepted": true, "score": 2, "last_activity_date": 1516140580, "last_edit_date": 1516140580, "creation_date": 1516137741, "answer_id": 48290043, "question_id": 48289310, "link": "https://stackoverflow.com/questions/48289310/excel-vba-copy-and-paste-loop-in-vba-based-on-cell-value/48290043#48290043", "title": "Excel VBA - Copy and Paste Loop in VBA based on cell value", "body": "<p>Below is some code which hopefully achieves what I <strong>think</strong> you are trying to do.  I have included comments throughout stating what I changed:</p>\n\n<pre><code>Sub Paste_Value_Test()\n\n    Dim c As Range\n    Dim IRow As Long, lastrow As Long\n    Dim rSource As Range\n    Dim wsI As Worksheet, wsO As Worksheet\n\n    On Error GoTo Whoa\n\n    '~~&gt; Sheet Where values needs to be checked\n    Set wsI = ThisWorkbook.Sheets(\"Sheet1\")\n    '~~&gt; Output sheet\n    Set wsO = ThisWorkbook.Sheets(\"Sheet2\")\n\n    Application.ScreenUpdating = False\n\n    With wsI\n        '~~&gt; Find Last Row which has data in Col O to R\n        If Application.WorksheetFunction.CountA(.Cells) &lt;&gt; 0 Then\n            'You specified \"After\" to be cell O3.  This means a match will\n            '  occur on row 2 if cell R2 (or O2 or P2) has something in it\n            '  because cell R2 is the cell \"after\" O3 when\n            '  \"SearchDirection:=xlPrevious\"\n\n            '             After:=.Range(\"O3\"), _\n\n            lastrow = .Columns(\"O:R\").Find(What:=\"*\", _\n                          After:=.Range(\"O1\"), _\n                          Lookat:=xlPart, _\n                          LookIn:=xlFormulas, _\n                          SearchOrder:=xlByRows, _\n                          SearchDirection:=xlPrevious, _\n                          MatchCase:=False).Row\n        Else\n            lastrow = 1\n        End If\n\n        'This was only referring to the single cell in column R on the\n        '  last row (in columns O:R)\n        'Set rSource = .Range(\"R\" &amp; lastrow)\n        'Create a range referring to everything in column R, from row 1\n        '  down to the \"last row\"\n        Set rSource = .Range(\"R1:R\" &amp; lastrow)\n\n        'This comment doesn't seem to reflect what the code was doing, or what the\n        'question said\n        '~~&gt; Search for the cell which has \"L\" and then copy it across to sheet1\n        For Each c In rSource\n            'This is printing the variable \"cValue\", which has never been set\n            'Debug.Print cValue\n            'It was probably meant to be\n            Debug.Print c.Value\n            'This was testing whether the value in the cell was\n            '  greater than the string \"0\"\n            'So the following values would be &gt; \"0\"\n            '  ABC\n            '  54\n            '  ;asd\n            'And the following values would not be &gt; \"0\"\n            '  (ABC)\n            '  $523   (assuming that was as text, and not just 523 formatted as currency)\n            'If c.Value &gt; \"0\" Then\n            'I suspect you are trying to test whether the cell is numeric\n            '  and greater than 0\n            If IsNumeric(c.Value) Then\n                If c.Value &gt; 0 Then\n                    'This is only copying the cell and the *three* cells\n                    ' to the left of it\n                    '.Range(\"O\" &amp; c.Row &amp; \":R\" &amp; c.Row).Copy\n                    'This will copy the cell and the *four* cells\n                    ' to the left of it\n                    '.Range(\"N\" &amp; c.Row &amp; \":R\" &amp; c.Row).Copy\n                    'wsO.Cells(5 + IRow, 12).PasteSpecial Paste:=xlPasteValues\n                    'But this would avoid the use of copy/paste\n                    wsO.Cells(5 + IRow, 12).Resize(1, 5).Value = _\n                         .Range(\"N\" &amp; c.Row &amp; \":R\" &amp; c.Row).Value\n                    IRow = IRow + 1\n                End If\n            End If\n        Next\n    End With\n\nLetsContinue:\n    Application.ScreenUpdating = True\n    Application.CutCopyMode = False\n    Exit Sub\nWhoa:\n    MsgBox Err.Description\n    Resume LetsContinue\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 65, "user_id": 9226292, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d3e330dd3e73989c0297a31bed9d7b72?s=128&d=identicon&r=PG&f=1", "display_name": "J Doe", "link": "https://stackoverflow.com/users/9226292/j-doe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3234, "favorite_count": 0, "accepted_answer_id": 48290043, "answer_count": 1, "score": 3, "last_activity_date": 1516140580, "creation_date": 1516134551, "last_edit_date": 1516135717, "question_id": 48289310, "link": "https://stackoverflow.com/questions/48289310/excel-vba-copy-and-paste-loop-in-vba-based-on-cell-value", "title": "Excel VBA - Copy and Paste Loop in VBA based on cell value", "body": "<p>I am trying to come up with a macro that checks if any numeral value exists in a cell.  If a numeral value exists, copy a portion of that row and paste it into another worksheet within the same spreadsheet.</p>\n\n<p>Sheet1 is the sheet that has all my data in it.  I am trying to look in column R if there is any values in it.  If it does, copy that cell and the four adjacent cells to the left of it and paste it into Sheet2.</p>\n\n<p>This is what I have come up with so far based on mish-mashing other people's code though it only does a part of what I want.  It just copies part of a row then pastes it into another worksheet but it does not check column R for a value first.  It just copies and pastes regardless and does not move onto the next row once it has done that.  I need it to continue onto the next row to continue looking:</p>\n\n<pre><code>Sub Paste_Value_Test()\n\nDim c As Range\nDim IRow As Long, lastrow As Long\nDim rSource As Range\nDim wsI As Worksheet, wsO As Worksheet\n\nOn Error GoTo Whoa\n\n'~~&gt; Sheet Where values needs to be checked\nSet wsI = ThisWorkbook.Sheets(\"Sheet1\")\n'~~&gt; Output sheet\nSet wsO = ThisWorkbook.Sheets(\"Sheet2\")\n\nApplication.ScreenUpdating = False\n\nWith wsI\n    '~~&gt; Find Last Row which has data in Col O to R\n    If Application.WorksheetFunction.CountA(.Cells) &lt;&gt; 0 Then\n        lastrow = .Columns(\"O:R\").Find(What:=\"*\", _\n                      After:=.Range(\"O3\"), _\n                      Lookat:=xlPart, _\n                      LookIn:=xlFormulas, _\n                      SearchOrder:=xlByRows, _\n                      SearchDirection:=xlPrevious, _\n                      MatchCase:=False).Row\n    Else\n        lastrow = 1\n    End If\n\n    '~~&gt; Set you input range\n    Set rSource = .Range(\"R\" &amp; lastrow)\n\n    '~~&gt; Search for the cell which has \"L\" and then copy it across to sheet1\n    For Each c In rSource\n    Debug.Print cValue\n        If c.Value &gt; \"0\" Then\n            .Range(\"O\" &amp; c.Row &amp; \":R\" &amp; c.Row).Copy\n            wsO.Cells(5 + IRow, 12).PasteSpecial Paste:=xlPasteValues\n            IRow = IRow + 1\n        End If\n    Next\nEnd With\n\nLetsContinue:\nApplication.ScreenUpdating = True\nApplication.CutCopyMode = False\nExit Sub\nWhoa:\nMsgBox Err.Description\nResume LetsContinue\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "combobox", "vlookup", "userform"], "comments": [{"owner": {"reputation": 3423, "user_id": 1738572, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/s0VGr.jpg?s=128&g=1", "display_name": "Greg Viers", "link": "https://stackoverflow.com/users/1738572/greg-viers"}, "edited": false, "score": 0, "creation_date": 1516134339, "post_id": 48289167, "comment_id": 83563461, "body": "Does it have to be a combobox? You can create a more vlookup-friendly drop down box using Data Validation without any code."}, {"owner": {"reputation": 61, "user_id": 8953988, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/debb991691bbf1a0e2abedb715c940ce?s=128&d=identicon&r=PG&f=1", "display_name": "Casey M", "link": "https://stackoverflow.com/users/8953988/casey-m"}, "reply_to_user": {"reputation": 3423, "user_id": 1738572, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/s0VGr.jpg?s=128&g=1", "display_name": "Greg Viers", "link": "https://stackoverflow.com/users/1738572/greg-viers"}, "edited": false, "score": 1, "creation_date": 1516134582, "post_id": 48289167, "comment_id": 83563566, "body": "unfortunately yes, but good news    found the solution  Me.Contact1.Value = Application.VLookup(SelectAgency.Value, Worksheets(&quot;Ref Sheet - Delimited list&quot;).Range(&quot;S2:T300&quot;), 2, 0)  for whatever reason it doesn&#39;t like doing a vlookup on first column so I expanded it.. seemed to work :)"}, {"owner": {"reputation": 3423, "user_id": 1738572, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/s0VGr.jpg?s=128&g=1", "display_name": "Greg Viers", "link": "https://stackoverflow.com/users/1738572/greg-viers"}, "edited": false, "score": 1, "creation_date": 1516134665, "post_id": 48289167, "comment_id": 83563599, "body": "You can post the answer to your own question, below, for others"}], "answers": [{"tags": [], "owner": {"reputation": 61, "user_id": 8953988, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/debb991691bbf1a0e2abedb715c940ce?s=128&d=identicon&r=PG&f=1", "display_name": "Casey M", "link": "https://stackoverflow.com/users/8953988/casey-m"}, "is_accepted": false, "score": 0, "last_activity_date": 1516134838, "creation_date": 1516134838, "answer_id": 48289386, "question_id": 48289167, "link": "https://stackoverflow.com/questions/48289167/how-to-use-combobox-value-to-vlookup-value-for-another-text-value-in-a-userform/48289386#48289386", "title": "How to use combobox value to vlookup value for another text value in a userform and have it update automatically in the userform", "body": "<p>Me.Contact1.Value = Application.VLookup(SelectAgency.Value, Worksheets(\"Ref Sheet - Delimited list\").Range(\"S2:T300\"), 2, 0)</p>\n\n<p>expanded selection picked second column and didn't use the named range ACIN used the cell ranges.</p>\n"}], "owner": {"reputation": 61, "user_id": 8953988, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/debb991691bbf1a0e2abedb715c940ce?s=128&d=identicon&r=PG&f=1", "display_name": "Casey M", "link": "https://stackoverflow.com/users/8953988/casey-m"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1035, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1516134838, "creation_date": 1516133946, "last_edit_date": 1516134441, "question_id": 48289167, "link": "https://stackoverflow.com/questions/48289167/how-to-use-combobox-value-to-vlookup-value-for-another-text-value-in-a-userform", "title": "How to use combobox value to vlookup value for another text value in a userform and have it update automatically in the userform", "body": "<p>I'm not seeing what is not working on this one. </p>\n\n<p>I want after the user selects SelectAgency a userform combobox for the Contact1 populate from reference sheet with a named range in column T </p>\n\n<pre><code>column s on ref sheet = Agency name \ncolumn t on ref sheet = Contact1. name\nACIN = column t range for contacts\n</code></pre>\n\n<p>I've been trying a few ways - vlookup method, offset method, and started on the find method. I've seen a few questions kind of close, but not quite what I needed.  Any help would be Great! :)  Thanks!</p>\n\n<pre><code>Private Sub SelectAgency_Afterupdate()\n\n 'Me.Contact1.Value = Application.VLookup(SelectAgency.Value, Worksheets(\"Ref   Sheet - Delimited list\").Range(\"AC1N\"), 1, 0)\n\n'Me.Contact1.Value = Worksheets(\"Ref Sheet - Delimited list\").Range(SelectAgency.Value).Offset(0, 1)\n\n\n\n'Dim ws5 As Worksheet\n'Dim lRow2\n'Me.Contact1.Value = lRow2 = ws5.Cells.Find(What:=\"*\", SearchOrder:=xlRows, _\n'  SearchDirection:=xlPrevious, LookIn:=xlValues).Row + 1\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "excel-formula"], "comments": [{"owner": {"reputation": 6762, "user_id": 845655, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/ySyzL.jpg?s=128&g=1", "display_name": "DeanOC", "link": "https://stackoverflow.com/users/845655/deanoc"}, "edited": false, "score": 0, "creation_date": 1516133004, "post_id": 48288928, "comment_id": 83562850, "body": "You&#39;ve tagged [vba]. Can you clarify if you want a code solution or a formula solution?"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1516133012, "post_id": 48288928, "comment_id": 83562853, "body": "split on the space then check if the second character in the second result is a number or not and return either the first or the first two depending on the result."}, {"owner": {"reputation": 8856, "user_id": 372526, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/1ffade2b226578a12a4b0d949e5199ee?s=128&d=identicon&r=PG&f=1", "display_name": "Parseltongue", "link": "https://stackoverflow.com/users/372526/parseltongue"}, "reply_to_user": {"reputation": 6762, "user_id": 845655, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/ySyzL.jpg?s=128&g=1", "display_name": "DeanOC", "link": "https://stackoverflow.com/users/845655/deanoc"}, "edited": false, "score": 0, "creation_date": 1516133073, "post_id": 48288928, "comment_id": 83562878, "body": "@deanOC either works, but formula is preferred if possible."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1516133207, "post_id": 48288928, "comment_id": 83562949, "body": "@ScottCraner Or even (if using VBA) just use <code>Val</code> on the first two characters after the space (it will ignore the non-numeric character if it exists)"}], "answers": [{"comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 6, "creation_date": 1516133325, "post_id": 48289013, "comment_id": 83563003, "body": "a slightly shorter version: <code>=MID(A1,FIND(&quot; &quot;,A1)+1,IF(ISNUMBER(--MID(A1,FIND(&quot; &quot;,A1)+2,1)),2,1))</code>"}, {"owner": {"reputation": 8856, "user_id": 372526, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/1ffade2b226578a12a4b0d949e5199ee?s=128&d=identicon&r=PG&f=1", "display_name": "Parseltongue", "link": "https://stackoverflow.com/users/372526/parseltongue"}, "edited": false, "score": 0, "creation_date": 1516133348, "post_id": 48289013, "comment_id": 83563018, "body": "Wow.  Incredible work, both of you guys.  Excel Wizards.  Thanks"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 248, "user_id": 8131936, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/a969359221040fb8213ff372360018f4?s=128&d=identicon&r=PG&f=1", "display_name": "Salek", "link": "https://stackoverflow.com/users/8131936/salek"}, "edited": false, "score": 2, "creation_date": 1516134002, "post_id": 48289013, "comment_id": 83563319, "body": "@Salek the number could be either 1 or 2 digits,  so for example <code>January 5th-7th 2018</code> would return <code>5t</code> and not <code>5</code>"}], "tags": [], "owner": {"reputation": 3423, "user_id": 1738572, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/s0VGr.jpg?s=128&g=1", "display_name": "Greg Viers", "link": "https://stackoverflow.com/users/1738572/greg-viers"}, "is_accepted": true, "score": 6, "last_activity_date": 1516133186, "last_edit_date": 1516133186, "creation_date": 1516133155, "answer_id": 48289013, "question_id": 48288928, "link": "https://stackoverflow.com/questions/48288928/excel-extract-numbers-from-date-strings/48289013#48289013", "title": "Excel: Extract Numbers from Date Strings", "body": "<pre><code>=IF(ISNUMBER(1*MID(A1,FIND(\" \",A1)+2,1)),MID(A1,FIND(\" \",A1)+1,2),MID(A1,FIND(\" \",A1)+1,1))*1\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 8856, "user_id": 372526, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/1ffade2b226578a12a4b0d949e5199ee?s=128&d=identicon&r=PG&f=1", "display_name": "Parseltongue", "link": "https://stackoverflow.com/users/372526/parseltongue"}, "edited": false, "score": 0, "creation_date": 1516133919, "post_id": 48289097, "comment_id": 83563279, "body": "This is also great.  Thanks!"}], "tags": [], "owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "is_accepted": false, "score": 2, "last_activity_date": 1516133596, "creation_date": 1516133596, "answer_id": 48289097, "question_id": 48288928, "link": "https://stackoverflow.com/questions/48288928/excel-extract-numbers-from-date-strings/48289097#48289097", "title": "Excel: Extract Numbers from Date Strings", "body": "<p>A VBA solution might be:</p>\n\n<pre><code>Sub test()\n    Dim s() As String\n    Dim i As Long\n    For i = 1 To 14\n        'Split text based on spaces\n        s = Split(Cells(i, \"A\").Text)\n        'Join bits together and convert to date\n        'Val(Left(s(1), 2)) gives the day portion\n        'Month and Year are directly from the source\n        Cells(i, \"B\").Value = CDate(Val(Left(s(1), 2)) &amp; \" \" &amp; s(0) &amp; \" \" &amp; s(2))\n    Next\nEnd Sub\n</code></pre>\n\n<p>(Assumes data in A1:A14, and puts results in B1:B14)</p>\n"}, {"tags": [], "owner": {"reputation": 3, "user_id": 2748408, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60915209bb0fd86a46ef7eef86ab42ea?s=128&d=identicon&r=PG", "display_name": "Greg N.", "link": "https://stackoverflow.com/users/2748408/greg-n"}, "is_accepted": false, "score": 0, "last_activity_date": 1516134372, "creation_date": 1516134372, "answer_id": 48289267, "question_id": 48288928, "link": "https://stackoverflow.com/questions/48288928/excel-extract-numbers-from-date-strings/48289267#48289267", "title": "Excel: Extract Numbers from Date Strings", "body": "<p>You can use a formula that could take care of this;</p>\n\n<pre><code>=DATE(VALUE(RIGHT(A1,4)),VLOOKUP(MID(A1,1,3),$G$1:$H$12,2),MID(A1,FIND(\" \",A1)+1,(FIND(\"t\",A1)-FIND(\" \",A1)-1)))\n</code></pre>\n\n<p>This also assumes that there is a lookup table that has JAN, FEB, etc... with the number of the month.  That table needs to be sorted alphabetically by the month.  It should look like this;\nAPR 4\nAUG 8\nDEC 12\nFEB 2\nJAN 1\nJUL 7\nJUN 6\nMAR 3\nMAY 5\nNOV 11\nOCT 10\nSEP 9</p>\n\n<p>Also, you will have to do a search and replace the 'nd' with 'th' to avoid having to add a bunch of extra conditional code here.</p>\n\n<p>I would also suggest that a second column of dates be added that would be populated by the 'to' dates that may appear.</p>\n\n<p>Hope that helps.</p>\n\n<p>Greg</p>\n"}, {"tags": [], "owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "is_accepted": false, "score": 2, "last_activity_date": 1516134615, "creation_date": 1516134615, "answer_id": 48289333, "question_id": 48288928, "link": "https://stackoverflow.com/questions/48288928/excel-extract-numbers-from-date-strings/48289333#48289333", "title": "Excel: Extract Numbers from Date Strings", "body": "<p>Alternate solution:</p>\n\n<pre><code>=LOOKUP(99,--MID(A1,FIND(\" \",A1)+1,{1,2}))\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": false, "score": 1, "last_activity_date": 1516135227, "creation_date": 1516135227, "answer_id": 48289492, "question_id": 48288928, "link": "https://stackoverflow.com/questions/48288928/excel-extract-numbers-from-date-strings/48289492#48289492", "title": "Excel: Extract Numbers from Date Strings", "body": "<p>Another alternate:</p>\n\n<pre><code>=AGGREGATE(14,6,--MID(A1,FIND(\" \",A1)+1,{1,2}),1)\n</code></pre>\n"}], "owner": {"reputation": 8856, "user_id": 372526, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/1ffade2b226578a12a4b0d949e5199ee?s=128&d=identicon&r=PG&f=1", "display_name": "Parseltongue", "link": "https://stackoverflow.com/users/372526/parseltongue"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 544, "favorite_count": 0, "accepted_answer_id": 48289013, "answer_count": 5, "score": 2, "last_activity_date": 1516135227, "creation_date": 1516132810, "last_edit_date": 1516133178, "question_id": 48288928, "link": "https://stackoverflow.com/questions/48288928/excel-extract-numbers-from-date-strings", "title": "Excel: Extract Numbers from Date Strings", "body": "<p>I have several malformed date columns.  I am trying to transform these columns into \"month\", \"year\", and \"start_day\" columns.  </p>\n\n<p>Here is an example sample:</p>\n\n<pre><code>January 13th, 2018\nJanuary 13th-14th 2018\nJanuary 5th-7th 2018\nJanuary 4th-8th 2018\nDecember 9th-10th 2017\nDecember 2nd-3rd 2017\nDecember 2nd, 2017\nDecember 2nd-3rd 2017\nNovember 18th, 2017\nNovember 18th-20th, 2017\nNovember 17th-19th 2017\nNovember 11th, 2017\nNovember 11th-12th, 2017\nNovember 11th-12th 2017\n</code></pre>\n\n<p>Note that sometimes there is a comma between the day abbreviation and the year, other times not.  My desired output (for the day column) would be:</p>\n\n<pre><code>13\n13\n5\n4\n9\n2\n2\n2\n18\n18\n17\n11\n11\n11\n</code></pre>\n\n<p>I am not concerned about the second date (to the right of the hyphen).  I was able to get the month with <code>LEFT(A1, 3)</code> and the year with <code>RIGHT(A1, 4)</code>.  I cannot for the life of me figure out how to grab the first numerical value to the right of the month without resorting to regex.  Any ideas?</p>\n"}, {"tags": ["vba", "excel", "conditional-formatting"], "comments": [{"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1516132833, "post_id": 48288923, "comment_id": 83562771, "body": "In most cases, formulas work faster than VBA code."}], "answers": [{"comments": [{"owner": {"reputation": 113, "user_id": 7885268, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/dd5321500837661a0acfab6a34794919?s=128&d=identicon&r=PG&f=1", "display_name": "MSauce", "link": "https://stackoverflow.com/users/7885268/msauce"}, "edited": false, "score": 0, "creation_date": 1516135805, "post_id": 48289051, "comment_id": 83564196, "body": "Wow that did it! Thanks!"}], "tags": [], "owner": {"reputation": 3423, "user_id": 1738572, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/s0VGr.jpg?s=128&g=1", "display_name": "Greg Viers", "link": "https://stackoverflow.com/users/1738572/greg-viers"}, "is_accepted": true, "score": 3, "last_activity_date": 1516133346, "creation_date": 1516133346, "answer_id": 48289051, "question_id": 48288923, "link": "https://stackoverflow.com/questions/48288923/conditional-format-slows-down-excel/48289051#48289051", "title": "Conditional Format Slows Down Excel", "body": "<p>Change your COUNTIFS so it doesn't search the entire column, but a limited range. For example, 1000 rows:</p>\n\n<pre><code>=COUNTIFS($B1:$B1000,$B1,$C1:$C1000,$C1, $E1:$E1000,$E1,$F1:$F1000,$F1,$G1:$G1000,$G1,$I1:$I1000,$I1) &gt; 1\n</code></pre>\n\n<p>That should improve the performance substantially. If your data has too dynamic of a size for that to work, switch to using tables and when you select the whole column table you'll get a field-based formula which only selects the cells needed.</p>\n"}], "owner": {"reputation": 113, "user_id": 7885268, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/dd5321500837661a0acfab6a34794919?s=128&d=identicon&r=PG&f=1", "display_name": "MSauce", "link": "https://stackoverflow.com/users/7885268/msauce"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 460, "favorite_count": 0, "accepted_answer_id": 48289051, "answer_count": 1, "score": 3, "last_activity_date": 1516169171, "creation_date": 1516132774, "last_edit_date": 1516169171, "question_id": 48288923, "link": "https://stackoverflow.com/questions/48288923/conditional-format-slows-down-excel", "title": "Conditional Format Slows Down Excel", "body": "<p>I'm using excel Conditional Formatting to find duplicate rows by searching through multiple columns, and if those columns match in another row, it'll highlight those duplicate rows. The problem is, that when I use that conditional formatting, it really slows down the sheet. Selecting from a drop-down list takes 3-5 seconds, and copy and pasting takes a few seconds. I'm probably at most, pasting about 100 rows and about 8 columns.</p>\n\n<p>Is there a way to make the sheet more efficient? Will creating a macro speed up the Excel?</p>\n\n<p>Here's the formula. </p>\n\n<pre><code>=COUNTIFS($B:$B,$B1,$C:$C,$C1, $E:$E,$E1,$F:$F,$F1,$G:$G,$G1,$I:$I,$I1) &gt; 1\n</code></pre>\n\n<p>and it applies $A:$I. </p>\n\n<p><img src=\"https://i.stack.imgur.com/ZZcrA.png\"></p>\n\n<p>Thanks!</p>\n"}, {"tags": ["vba", "excel", "arduino"], "comments": [{"owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "edited": false, "score": 0, "creation_date": 1516133396, "post_id": 48288558, "comment_id": 83563044, "body": "You probably need to create a reference to whatever <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/aa366757(v=vs.85).aspx\" rel=\"nofollow noreferrer\">type library</a> for your program in VBE to get your functions to work. That or you can use <a href=\"https://docs.microsoft.com/en-us/dotnet/visual-basic/programming-guide/language-features/early-late-binding/\" rel=\"nofollow noreferrer\">late binding</a>."}], "answers": [{"tags": [], "owner": {"reputation": 1580, "user_id": 7938503, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OYvg2.jpg?s=128&g=1", "display_name": "Plagon", "link": "https://stackoverflow.com/users/7938503/plagon"}, "is_accepted": false, "score": 0, "last_activity_date": 1516133686, "creation_date": 1516133686, "answer_id": 48289117, "question_id": 48288558, "link": "https://stackoverflow.com/questions/48288558/reading-data-from-serial-bus/48289117#48289117", "title": "Reading Data From Serial Bus", "body": "<p>So i dont have an Arduino, but from what ive seen, you should try this:</p>\n\n<pre><code>Sub ReadDataFromPort()\nDim PortID as Integer: PortID = 1\nDim Status as Long\nDim strData as String\n\nStatus = CommOpen(PortID, \"COM4\", \"baud=9600 parity=N data=8 stop=1\")\nIf Status &lt;&gt; 0 then\nMsgBox(\"Error\")\nExit Sub\nEnd IF\n\nStatus = CommRead(PortID, strData, 64) 'last Parameter = Number of Bytes to read\nIf Status &gt; 0 then \n'Process Data\nMsgBox(strData)\nElseif Status &lt; 0 then \nMsgBox(\"Error\")\nend if\n\nCall CommClose(PortID)\nEnd Sub\n</code></pre>\n\n<p>Also there is an example code that comes with the files. you can check that for a working example and also look into the .bas file to see what each function does. </p>\n"}], "owner": {"reputation": 3, "user_id": 2748408, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60915209bb0fd86a46ef7eef86ab42ea?s=128&d=identicon&r=PG", "display_name": "Greg N.", "link": "https://stackoverflow.com/users/2748408/greg-n"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2537, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1516146065, "creation_date": 1516131173, "last_edit_date": 1531164843, "question_id": 48288558, "link": "https://stackoverflow.com/questions/48288558/reading-data-from-serial-bus", "title": "Reading Data From Serial Bus", "body": "<p>I have an Arduino board that is has a script that reads one of the analog ports and dumps the value to the USB (in my case, it's COM4).</p>\n\n<p>I want to be able to read this in VBA and dump it into Excel.  This is just the first step... a proof of concept, if you will...</p>\n\n<p>I have installed a module called modCOMM (<a href=\"http://www.thescarms.com/vbasic/CommIO.aspx\" rel=\"nofollow noreferrer\">http://www.thescarms.com/vbasic/CommIO.aspx</a>) and in that, there is a function called <code>CommRead(intPortID, strData, ingSize)</code>.</p>\n\n<p>I am sure that I'm not seeing something simple here... </p>\n\n<p>Does anybody have any experience with this?  Any tips or pointers to a tutorial would be very helpful.</p>\n"}, {"tags": ["excel", "vba", "image", "checkbox"], "comments": [{"owner": {"reputation": 15409, "user_id": 2877364, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0a101160e41fd7fd75f5fc701f8acb1c?s=128&d=identicon&r=PG", "display_name": "cxw", "link": "https://stackoverflow.com/users/2877364/cxw"}, "edited": false, "score": 0, "creation_date": 1516128199, "post_id": 48287745, "comment_id": 83560549, "body": "Welcome to the site!  Check out the <a href=\"https://stackoverflow.com/tour\">tour</a> and the <a href=\"https://stackoverflow.com/help/how-to-ask\">how-to-ask page</a> for more about asking questions that will attract quality answers.  You can <a href=\"https://stackoverflow.com/posts/48287745/edit\">edit your question</a> to include more information.  Have you done any searching to find out how to add the checkbox?"}, {"owner": {"reputation": 3423, "user_id": 1738572, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/s0VGr.jpg?s=128&g=1", "display_name": "Greg Viers", "link": "https://stackoverflow.com/users/1738572/greg-viers"}, "edited": false, "score": 1, "creation_date": 1516128525, "post_id": 48287745, "comment_id": 83560704, "body": "You may find this helpful <a href=\"https://stackoverflow.com/questions/39430745/excel-vba-script-to-insert-multiple-checkboxes-linked-to-cell-with-yes-and-no-in/39434543#39434543\" title=\"excel vba script to insert multiple checkboxes linked to cell with yes and no in\">stackoverflow.com/questions/39430745/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 3423, "user_id": 1738572, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/s0VGr.jpg?s=128&g=1", "display_name": "Greg Viers", "link": "https://stackoverflow.com/users/1738572/greg-viers"}, "is_accepted": false, "score": 0, "last_activity_date": 1516162066, "last_edit_date": 1516162066, "creation_date": 1516132081, "answer_id": 48288767, "question_id": 48287745, "link": "https://stackoverflow.com/questions/48287745/show-or-delete-an-image-based-on-a-checkbox-value-in-vba-excel/48288767#48288767", "title": "Show or delete an image based on a checkbox value in VBA Excel", "body": "<p>Here is a solution:</p>\n\n<ol>\n<li>Place the checkboxes in column C</li>\n<li>Add an empty column (D)</li>\n<li>Link each checkbox to the corresponding cell in D. For example, link the one in C3 to cell D3. You can do this by right-clicking on the checkbox and choosing \"format control\". Then go to the control tab and set the cell link. Now when you check and uncheck the checkbox, this cell will change to <code>TRUE</code> or <code>FALSE</code>.</li>\n<li><p>In cell E2, use the formula:</p>\n\n<p><code>=and(D2,B2=\"correct\")</code></p></li>\n</ol>\n\n<p>with <code>B2=\"correct\"</code> replaced with whatever way you are currently planning to check if B2 is correct.</p>\n\n<ol start=\"5\">\n<li><p>Create the macro you have above, but don't use the action. Instead, make it an ordinary macro called LoadPic (<code>ByVal Target as Range</code>) and change your If statement to read:</p>\n\n<p><code>If Not Intersect(Target, Rng) Is Nothing And Cells(Target.Row, 5) = True Then</code></p></li>\n<li><p>Create the change macro to capture changes to the B column, but have it call your other macro:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\n    Call loadPic(Target)\n\nEnd Sub\n</code></pre></li>\n<li><p>Create another macro for when a checkbox is clicked:</p>\n\n<pre><code>Sub clickCheckBox()\nDim ClickedCheckBox As CheckBox\nDim source As String\nsource = Application.Caller\n\nSet ClickedCheckBox = ActiveSheet.CheckBoxes(Application.Caller)\nCall loadPic(Range(ClickedCheckBox.LinkedCell))\nEnd Sub\n</code></pre></li>\n<li><p>right-click and assign this macro to each of your images.</p></li>\n</ol>\n\n<p>That should work.</p>\n"}], "owner": {"reputation": 21, "user_id": 9213545, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21a8603fe209ff3dd067845856071008?s=128&d=identicon&r=PG&f=1", "display_name": "Jens Verschuren", "link": "https://stackoverflow.com/users/9213545/jens-verschuren"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 683, "favorite_count": 1, "answer_count": 1, "score": 2, "last_activity_date": 1516162066, "creation_date": 1516127682, "last_edit_date": 1516128152, "question_id": 48287745, "link": "https://stackoverflow.com/questions/48287745/show-or-delete-an-image-based-on-a-checkbox-value-in-vba-excel", "title": "Show or delete an image based on a checkbox value in VBA Excel", "body": "<p>I have a code that inserts images in range <code>D2:D10</code> based on the cell value in range <code>B2:B10</code>. So if I enter a correct value in <code>B2</code>, an image will appear in <code>D2</code>, etc. However, I want to add a checkbox that controls the visibility of the image.</p>\n\n<p>So I want Excel to:</p>\n\n<ul>\n<li>show the image when the checkbox is true and the cell <code>B2</code> has a correct value</li>\n<li>delete the image when the checkbox is false, even if B2 still has the correct value.  </li>\n</ul>\n\n<p>So I think the checkbox should be the action that starts the macro, but I don't know how to make this. Because now the macro runs when I enter a value. In my current code, I even don't have a checkbox.</p>\n\n<p>I never made something like this. Is this possible to make?</p>\n\n<pre><code>Option Explicit\n\nPrivate Sub Worksheet_Change(ByVal Target As Range)\nDim myPict As Picture\nDim PictureLoc As String\nDim rng As Range, cell As Range\nSet rng = Range(\"B2:B10\")\nIf Not Intersect(Target, rng) Is Nothing Then\n    Application.EnableEvents = False\n    PictureLoc = \"C:\\Users\\\" &amp; Target.Value &amp; \".png\"\n    Set cell = Target.Offset(, 2)\n    With cell\n        On Error Resume Next\n        Set myPict = ActiveSheet.Pictures.Insert(PictureLoc)\n        myPict.Select\n        With Selection\n            .Height = 30\n            .Width = 60\n            .Top = cell.Top + cell.Height / 2 - .Width / 2\n            .Left = cell.Left + cell.Width / 2 - .Width / 2\n            Rows(Target.Row).RowHeight = .Height\n        End With\n        On Error GoTo 0\n    End With\n    Application.EnableEvents = True\nEnd If\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "date", "if-statement"], "comments": [{"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1516127563, "post_id": 48287682, "comment_id": 83560227, "body": "Shouldn&#39;t it just be <code>myValue</code>, not <code>myValue.Date</code>? You already have it as a date. Also yeah, you have to step backwards through the loop (<code>Step -1</code>) when deleting rows"}, {"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 1, "creation_date": 1516127568, "post_id": 48287682, "comment_id": 83560235, "body": "When you are looping and deleting rows, you must loop backwards or you will end up skipping rows. That&#39;s the first issue. <code>For x = NumberofRows To 1 Step -1</code>"}, {"owner": {"reputation": 3730, "user_id": 652301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3fa42db9e3dd408f0de546a82d67c016?s=128&d=identicon&r=PG&f=1", "display_name": "sous2817", "link": "https://stackoverflow.com/users/652301/sous2817"}, "edited": false, "score": 0, "creation_date": 1516127617, "post_id": 48287682, "comment_id": 83560265, "body": "a bit of a pro tip: When deleting, loop from the last row to the first row or your iterator will not be what you think it&#39;ll be after deleting."}, {"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1516128639, "post_id": 48287682, "comment_id": 83560750, "body": "In the end, <code>InputBox</code> is never a great idea, because you never know what the user is going to type and you have to jump thru all kinds of hoops to make sure they entered what you expected. In this case I would just make a <code>Userform</code> that has a <code>DateTimePicker</code> on it and include an <code>OK</code> and <code>Cancel</code> button on it. It&#39;s really simple to do."}], "answers": [{"comments": [{"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 1, "creation_date": 1516127823, "post_id": 48287749, "comment_id": 83560362, "body": "I would include a check to make sure myValue is actually a valid date. <code>If Not IsDate(myValue) Then Exit Sub</code>"}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "reply_to_user": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1516127994, "post_id": 48287749, "comment_id": 83560449, "body": "@braX Good suggestion - added"}, {"owner": {"reputation": 21, "user_id": 9225855, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-uQEp_FRbFK4/AAAAAAAAAAI/AAAAAAAAAjU/yH0Avn-QimE/photo.jpg?sz=128", "display_name": "Jen", "link": "https://stackoverflow.com/users/9225855/jen"}, "edited": false, "score": 0, "creation_date": 1516129917, "post_id": 48287749, "comment_id": 83561305, "body": "I tried this code and it isn&#39;t giving me any errors, but it isn&#39;t correctly comparing the dates.  Even when they are the same, it thinks they are different and wants to delete the row.  Any ideas why?"}, {"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1516131127, "post_id": 48287749, "comment_id": 83561894, "body": "That&#39;s because you are actually comparing 2 strings or a string and a number that <i>look</i> like dates. It would be better to verify both values you are comparing are dates, then convert them to actual dates using <code>CVDate</code> - and then compare them."}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "reply_to_user": {"reputation": 21, "user_id": 9225855, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-uQEp_FRbFK4/AAAAAAAAAAI/AAAAAAAAAjU/yH0Avn-QimE/photo.jpg?sz=128", "display_name": "Jen", "link": "https://stackoverflow.com/users/9225855/jen"}, "edited": false, "score": 0, "creation_date": 1516137720, "post_id": 48287749, "comment_id": 83565051, "body": "@Jen Right - as braX said, you should probably do <code>Dim dDate As String</code> and see if that changes it."}], "tags": [], "owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "is_accepted": false, "score": 2, "last_activity_date": 1516127984, "last_edit_date": 1516127984, "creation_date": 1516127708, "answer_id": 48287749, "question_id": 48287682, "link": "https://stackoverflow.com/questions/48287682/use-if-statement-to-compare-variable-to-stored-date/48287749#48287749", "title": "Use IF Statement to compare variable to stored date", "body": "<p>Try this:</p>\n\n<pre><code>Sub Test()\nDim myValue As Variant\nmyValue = InputBox(\"Enter current as of date (MM/DD/YY)\")\n\nIf Not IsDate(myValue) Then Exit Sub\n\nDim dDate As Date\nDim NumberofRows As Long\nDim x As Long\n\nWith Worksheets(\"Transactions\")\n    NumberofRows = .Cells(.Rows.Count, \"C\").End(xlUp).Row\n\n    For x = NumberofRows To 1 Step -1\n        If Not .Range(\"Q\" &amp; x).Value = myValue Then\n            .Range(\"Q\" &amp; x).EntireRow.Delete\n        End If\n    Next x\n\nEnd With\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 1, "creation_date": 1516128346, "post_id": 48287825, "comment_id": 83560617, "body": "What happens if the user  presses cancel? An empty string will be returned and <code>CDate</code> will error."}, {"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1516129115, "post_id": 48287825, "comment_id": 83560954, "body": "What if the user enters their name? You really need an <code>IsDate()</code> in there somewhere."}, {"owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "reply_to_user": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1516129198, "post_id": 48287825, "comment_id": 83560999, "body": "@braX IMHO It should rightfully throw an error of <code>Type Mismatch</code>. If it simply <code>Exit Sub</code> then an end user who was typing <b>Jan 16, 2018</b> in the inputbox will think he&#39;s doing nothing wrong and the code is just not be working for some reason."}, {"owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "reply_to_user": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1516129994, "post_id": 48287825, "comment_id": 83561346, "body": "OP would have been better off using a Date Picker userform rather than an input box imo"}, {"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 1, "creation_date": 1516130297, "post_id": 48287825, "comment_id": 83561493, "body": "Yes, that&#39;s what I explained in the main comments. :)"}, {"owner": {"reputation": 21, "user_id": 9225855, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-uQEp_FRbFK4/AAAAAAAAAAI/AAAAAAAAAjU/yH0Avn-QimE/photo.jpg?sz=128", "display_name": "Jen", "link": "https://stackoverflow.com/users/9225855/jen"}, "edited": false, "score": 0, "creation_date": 1516130416, "post_id": 48287825, "comment_id": 83561564, "body": "Thanks for the idea, when I get this issue sorted I will work on switching to a date picker.  But when I tried this code, it isn&#39;t correctly comparing the dates. Even when they are the same, it thinks they are different and wants to delete the row. Any ideas why?"}, {"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1516131172, "post_id": 48287825, "comment_id": 83561914, "body": "That&#39;s because you are actually comparing 2 strings or a string and a number that look like dates. It would be better to verify both values you are comparing are dates, then convert them to actual dates using <code>CVDate</code> - and then compare them."}], "tags": [], "owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "is_accepted": false, "score": 0, "last_activity_date": 1516128957, "last_edit_date": 1516128957, "creation_date": 1516128020, "answer_id": 48287825, "question_id": 48287682, "link": "https://stackoverflow.com/questions/48287682/use-if-statement-to-compare-variable-to-stored-date/48287825#48287825", "title": "Use IF Statement to compare variable to stored date", "body": "<p>You can delete all at once, instead of one at a time. This will be a little faster as well, and you do not have to step backwards.</p>\n\n<p>Simply add all the rows you want to delete to a range, then delete the entire range.</p>\n\n<pre><code>Dim myValue As Date, retVal As String\nretVal = InputBox(\"Enter current as of date (MM/DD/YY)\")\n\nIf retVal = vbNullString Then\n    Exit Sub\nElse\n    myValue = CDate(retVal)\nEnd If\n\nDim dDate As Date\nDim NumberofRows As Long\nDim x As Long\n\nWith Worksheets(\"Transactions\")\n    NumberofRows = .Cells(.Rows.Count, \"C\").End(xlUp).row\n    For x = 1 To NumberofRows\n        If Not .Range(\"Q\" &amp; x) = myValue Then\n            If delRng Is Nothing Then\n                Set delRng = .Range(\"Q\" &amp; x)\n            Else\n                Set delRng = Union(delRng, .Range(\"Q\" &amp; x))\n            End If\n        End If\n    Next x\n    If Not delRng Is Nothing Then delRng.EntireRow.Delete\nEnd With\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "is_accepted": false, "score": 0, "last_activity_date": 1516144505, "last_edit_date": 1516144505, "creation_date": 1516131521, "answer_id": 48288636, "question_id": 48287682, "link": "https://stackoverflow.com/questions/48287682/use-if-statement-to-compare-variable-to-stored-date/48288636#48288636", "title": "Use IF Statement to compare variable to stored date", "body": "<p>Here's a version that compares using Date variables instead, and checks for Cancel being clicked. This way you know you are comparing apples to apples.</p>\n\n<pre><code>Sub Test()\nDim myValue As Variant\nDim dtValue As Date\nDim dtSheet As Date\nmyValue = InputBox(\"Enter current as of date (MM/DD/YY)\", \"Enter Date\", Date)\n\n' user cancelled\nIf myValue = \"\" Then Exit Sub\n\nIf Not IsDate(myValue) Then \n    MsgBox \"That is not a date.\", vbCritical\n    Exit Sub\nEnd If\n\n' user entered a valid date, so continue\ndtValue = CDate(myValue)\n\nDim NumberofRows As Long\nDim x As Long\n\nWith Worksheets(\"Transactions\")\n    NumberofRows = .Cells(.Rows.Count, \"C\").End(xlUp).Row\n\n    For x = NumberofRows To 1 Step -1\n        If IsDate(.Range(\"Q\" &amp; x).Value) Then\n            dtSheet = CDate(.Range(\"Q\" &amp; x).Value)\n            If Not dtSheet = dtValue Then\n                .Range(\"Q\" &amp; x).EntireRow.Delete\n            End If\n        Else\n            MsgBox \"'\" &amp; .Range(\"Q\" &amp; x).Value &amp; \"' is not a date.\", vbCritical\n        End If\n    Next x\n\nEnd With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 9225855, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-uQEp_FRbFK4/AAAAAAAAAAI/AAAAAAAAAjU/yH0Avn-QimE/photo.jpg?sz=128", "display_name": "Jen", "link": "https://stackoverflow.com/users/9225855/jen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 38, "favorite_count": 0, "answer_count": 3, "score": 2, "last_activity_date": 1516144505, "creation_date": 1516127409, "last_edit_date": 1516127464, "question_id": 48287682, "link": "https://stackoverflow.com/questions/48287682/use-if-statement-to-compare-variable-to-stored-date", "title": "Use IF Statement to compare variable to stored date", "body": "<p>I am trying to run a loop of my data that checks a number of different aspects, and if any fail, the macro deletes the row.  I have everything working except for the check of the date.  If a date in a given cell is equal to the date input initially, I want to keep the row, otherwise I want to delete it.  However I cant seem to get my date compare to work.  Any thoughts?</p>\n\n<pre><code>Dim myValue As Variant\nmyValue = InputBox(\"Enter current as of date (MM/DD/YY)\")\n\nDim dDate As Date\nDim NumberofRows As Long\nDim x As Long\n\nWith Worksheets(\"Transactions\")\n    NumberofRows = .Cells(.Rows.Count, \"C\").End(xlUp).Row\n\n    For x = 1 To NumberofRows\n        If (.Range(\"Q\" &amp; x).Value) = myValue.Date Then\n            ActiveCell.Offset(1, 0).Select\n        Else\n            ActiveCell.EntireRow.Select\n            Selection.Delete\n            Range(\"A\" &amp; (ActiveCell.Row)).Select\n        End If\n    Next x\n\nEnd With\n</code></pre>\n"}, {"tags": ["vba", "api", "web", "exchange-server", "exchangewebservices"], "answers": [{"tags": [], "owner": {"reputation": 16134, "user_id": 1080923, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de5381f82010f6a5175f2f3fe8ac85b9?s=128&d=identicon&r=PG", "display_name": "Glen Scales", "link": "https://stackoverflow.com/users/1080923/glen-scales"}, "is_accepted": true, "score": 1, "last_activity_date": 1516149863, "creation_date": 1516149863, "answer_id": 48292045, "question_id": 48287241, "link": "https://stackoverflow.com/questions/48287241/connecting-to-ews-using-vba-retrieve-data-using-get-call-via-xml/48292045#48292045", "title": "Connecting to EWS using VBA - Retrieve data using GET call via xml", "body": "<p>All EWS requests should be POST (eg your always POSTing the the SOAP XML regardless of the operation your performing) in your FindItem example you using</p>\n\n<pre><code>xmlMethod = \"GET\"\n</code></pre>\n\n<p>So this isn't correct.</p>\n"}], "owner": {"reputation": 181, "user_id": 8608110, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/6ae634819f46398476ff7ddc558f34b5?s=128&d=identicon&r=PG&f=1", "display_name": "user8608110", "link": "https://stackoverflow.com/users/8608110/user8608110"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1124, "favorite_count": 0, "accepted_answer_id": 48292045, "answer_count": 1, "score": 0, "last_activity_date": 1516149863, "creation_date": 1516125463, "last_edit_date": 1516125547, "question_id": 48287241, "link": "https://stackoverflow.com/questions/48287241/connecting-to-ews-using-vba-retrieve-data-using-get-call-via-xml", "title": "Connecting to EWS using VBA - Retrieve data using GET call via xml", "body": "<p>I am trying to connect to EWS services using VBA - I believe the only way is using POST and GET API calls from EWS. </p>\n\n<p>This code works perfectly fine for the POST case i.e. sending an email:</p>\n\n<pre><code>            Sub SendMessage()\n               Dim sReq As String\n               Dim xmlMethod As String\n               Dim XMLreq As New MSXML2.XMLHTTP60\n               Dim EWSEndPoint As String\n               EWSEndPoint = \"server_address\"\n               sReq = \"&lt;?xml version=\"\"1.0\"\" encoding=\"\"UTF-8\"\"?&gt;\" &amp; vbCrLf\n               sReq = sReq &amp; \"&lt;soap:Envelope xmlns:soap=\"\"http://schemas.xmlsoap.org/soap/envelope/\"\" xmlns:t=\"\"http://schemas.microsoft.com/exchange/services/2006/types\"\"&gt;\" &amp; vbCrLf\n               sReq = sReq &amp; \"&lt;soap:Header&gt;\" &amp; vbCrLf\n               sReq = sReq &amp; \"&lt;t:RequestServerVersion Version=\"\"Exchange2010\"\"/&gt;\" &amp; vbCrLf\n               sReq = sReq &amp; \"&lt;/soap:Header&gt;\" &amp; vbCrLf\n               sReq = sReq &amp; \"&lt;soap:Body&gt;\" &amp; vbCrLf\n               sReq = sReq &amp; \"&lt;CreateItem MessageDisposition=\"\"SendAndSaveCopy\"\" xmlns=\"\"http://schemas.microsoft.com/exchange/services/2006/messages\"\"&gt;\" &amp; vbCrLf\n               sReq = sReq &amp; \"&lt;SavedItemFolderId&gt;\" &amp; vbCrLf\n               sReq = sReq &amp; \"&lt;t:DistinguishedFolderId Id=\"\"sentitems\"\" /&gt;\" &amp; vbCrLf\n               sReq = sReq &amp; \"&lt;/SavedItemFolderId&gt;\" &amp; vbCrLf\n               sReq = sReq &amp; \"&lt;Items&gt;\" &amp; vbCrLf\n               sReq = sReq &amp; \"&lt;t:Message&gt;\" &amp; vbCrLf\n               sReq = sReq &amp; \"&lt;t:ItemClass&gt;IPM.Note&lt;/t:ItemClass&gt;\" &amp; vbCrLf\n               sReq = sReq &amp; \"&lt;t:Subject&gt;\" &amp; \"123\" &amp; \"&lt;/t:Subject&gt;\" &amp; vbCrLf\n               sReq = sReq &amp; \"&lt;t:Body BodyType=\"\"Text\"\"&gt;\" &amp; \"123\" &amp; \"&lt;/t:Body&gt;\" &amp; vbCrLf\n               sReq = sReq &amp; \"&lt;t:ToRecipients&gt;\" &amp; vbCrLf\n               sReq = sReq &amp; \"&lt;t:Mailbox&gt;\" &amp; vbCrLf\n               sReq = sReq &amp; \"&lt;t:EmailAddress&gt;\" &amp; \"EMAIL\" &amp; \"&lt;/t:EmailAddress&gt;\" &amp; vbCrLf\n               sReq = sReq &amp; \"&lt;/t:Mailbox&gt;\" &amp; vbCrLf\n               sReq = sReq &amp; \"&lt;/t:ToRecipients&gt;\" &amp; vbCrLf\n               sReq = sReq &amp; \"&lt;/t:Message&gt;\" &amp; vbCrLf\n               sReq = sReq &amp; \"&lt;/Items&gt;\" &amp; vbCrLf\n               sReq = sReq &amp; \"&lt;/CreateItem&gt;\" &amp; vbCrLf\n               sReq = sReq &amp; \"&lt;/soap:Body&gt;\" &amp; vbCrLf\n               sReq = sReq &amp; \"&lt;/soap:Envelope&gt;\" &amp; vbCrLf\n\n               xmlMethod = \"POST\"\n               XMLreq.Open xmlMethod, EWSEndPoint, False, \"user\",\"password\" \n               XMLreq.setRequestHeader \"Content-Type\", \"text/xml; charset=\"\"UTF-8\"\"\"\n\n               XMLreq.Send sReq\n\n               If XMLreq.Status = 200 Then\n                    ' Message Sent okay\n                Else\n                    ' Something went Wrong\n               End If\n\n\n            End Sub\n</code></pre>\n\n<p>But for receiving, it doesn't give an error but does not seem to be retrieving any data, this is my script, I am sure my folder parentID used is correct as I retrieved it from a C# run of EWS:</p>\n\n<pre><code>            Sub getMessage()\n               Dim sReq As String\n               Dim xmlMethod As String\n               Dim XMLreq As New MSXML2.XMLHTTP60\n               Dim EWSEndPoint As String\n               Dim xdoc As New MSXML2.DOMDocument\n               EWSEndPoint = \"serveraddress\"\n\n               xdoc.Load (\"filepath\")\n\n               sReq = \"&lt;?xml version=\"\"1.0\"\" encoding=\"\"UTF-8\"\"?&gt;\" &amp; vbCrLf\n               sReq = sReq &amp; \"&lt;soap:Envelope xmlns:soap=\"\"http://schemas.xmlsoap.org/soap/envelope/\"\" xmlns:t=\"\"http://schemas.microsoft.com/exchange/services/2006/types\"\"&gt;\" &amp; vbCrLf\n               sReq = sReq &amp; \"&lt;soap:Header&gt;\" &amp; vbCrLf\n               sReq = sReq &amp; \"&lt;t:RequestServerVersion Version=\"\"Exchange2010_SP1\"\" /&gt;\" &amp; vbCrLf\n               sReq = sReq &amp; \"&lt;/soap:Header&gt;\" &amp; vbCrLf\n               sReq = sReq &amp; \"&lt;soap:Body&gt;\" &amp; vbCrLf\n               sReq = sReq &amp; \"&lt;m:FindItem Traversal=\"\"Shallow\"\"&gt;\" &amp; vbCrLf\n               sReq = sReq &amp; \"&lt;m:ItemShape&gt;\" &amp; vbCrLf\n               sReq = sReq &amp; \"&lt;t:BaseShape&gt;IdOnly&lt;/t:BaseShape&gt;\" &amp; vbCrLf\n               sReq = sReq &amp; \"&lt;t:AdditionalProperties&gt;\" &amp; vbCrLf\n               sReq = sReq &amp; \"&lt;t:FieldURI FieldURI=\"\"item:Subject\"\" /&gt;\" &amp; vbCrLf\n               sReq = sReq &amp; \"&lt;/t:AdditionalProperties&gt;\" &amp; vbCrLf\n               sReq = sReq &amp; \"&lt;/m:ItemShape&gt;\" &amp; vbCrLf\n               sReq = sReq &amp; \"&lt;m:ParentFolderIds&gt;\" &amp; vbCrLf\n               sReq = sReq &amp; \" &lt;t:FolderId Id=\"\"parentID\"\" ChangeKey=\"\"AQAAAA==\"\" /&gt;\" &amp; vbCrLf\n               sReq = sReq &amp; \"&lt;/m:ParentFolderIds&gt;\" &amp; vbCrLf\n               sReq = sReq &amp; \"&lt;/m:FindItem&gt;\" &amp; vbCrLf\n               sReq = sReq &amp; \"&lt;/soap:Body&gt;\" &amp; vbCrLf\n               sReq = sReq &amp; \"&lt;/soap:Envelope&gt;\" &amp; vbCrLf\n\n               xmlMethod = \"GET\"\n               XMLreq.Open xmlMethod, EWSEndPoint, False, \"user\", \"pass\"\n\n               XMLreq.setRequestHeader \"Content-Type\", \"text/xml; charset=\"\"UTF-8\"\"\"\n               XMLreq.Send sReq\n\n               If XMLreq.Status = 200 Then\n                    ' Message Sent okay\n                Else\n                    ' Something went Wrong\n               End If\n\n\n               VBA_to_append_existing_text_file (XMLreq.responseText)\n\n\n            End Sub\n</code></pre>\n\n<p>Thanks</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 741, "user_id": 198849, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/727a5d93dbc3618ec2b04c440e1d462f?s=128&d=identicon&r=PG", "display_name": "BlissC", "link": "https://stackoverflow.com/users/198849/blissc"}, "edited": false, "score": 0, "creation_date": 1516191772, "post_id": 48287089, "comment_id": 83586574, "body": "Thanks Scott - that&#39;s done it! Using <code>=$B4&lt;&gt;&quot;&quot;</code>, which I&#39;d already tried, it added borders to rows 1 to 11, but my test data goes to row 14. I&#39;ve just realised that it added borders to the next row down as I added another, but not to the row I was adding. Changed it to <code>=$B1&lt;&gt;&quot;&quot;</code> as you suggested and it&#39;s working fine. I was assuming that as my data rows started at row 4 (above that is a title and headings), I should use B4, but as soon as I changed it to B1 as you suggested, it works fine. Thanks!"}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 1, "last_activity_date": 1516124895, "creation_date": 1516124895, "answer_id": 48287089, "question_id": 48287038, "link": "https://stackoverflow.com/questions/48287038/add-border-to-cells-in-a-table-if-another-row-is-added-in-excel/48287089#48287089", "title": "Add border to cells in a table if another row is added in excel", "body": "<p>Your formula needs to refer to the first row of the Applied To area:</p>\n\n<pre><code>=$B1&lt;&gt;\"\"\n</code></pre>\n\n<p>And apply it to <code>=$A:$T</code></p>\n"}], "owner": {"reputation": 741, "user_id": 198849, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/727a5d93dbc3618ec2b04c440e1d462f?s=128&d=identicon&r=PG", "display_name": "BlissC", "link": "https://stackoverflow.com/users/198849/blissc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 523, "favorite_count": 0, "accepted_answer_id": 48287089, "answer_count": 1, "score": 1, "last_activity_date": 1516124895, "creation_date": 1516124720, "last_edit_date": 1531161705, "question_id": 48287038, "link": "https://stackoverflow.com/questions/48287038/add-border-to-cells-in-a-table-if-another-row-is-added-in-excel", "title": "Add border to cells in a table if another row is added in excel", "body": "<p>I have an Excel spreadsheet which spans columns A to T and for ease of reading, the cells have borders. Currently when another row of data is added to the spreadsheet though, I, or other users, have to add borders around the cells, just for cells in columns A to T where is something (usually, but not always, a date) in Column B on that row. The spreadsheet is a log of survey results, and gets very long by the end of the year, but doesn't have a defined number of rows, because it's being added to all the time. It's not much of a problem for me to add borders, but other users not familiar with Excel either manage to add borders to all the cells in columns A to T making the end of the list look untidy with cells with borders but no contents or they just don't bother adding borders and it gets very messy for managers to read (apparently!).</p>\n\n<p>I'm trying to use conditional formatting with a formula to format the cells, but can't seem to get the formula right. I'm basically trying to get Excel to add a border around cells in columns A to T on any row where the cell in column B on that row isn't empty. I've tried various formulas with no luck so far and just end up with borders everywhere but where I want them!</p>\n\n<p>Some of what I've tried so far (I can't remember all the ones that didn't work!):\n(row 4 is the first row of data)</p>\n\n<p><code>=$B2&lt;&gt;\"\"</code> (applied to =$A:$T) (adds borders above the table, but not below)</p>\n\n<p><code>NOT(ISBLANK($B4))</code> (applied to =$A:$T) (doesn't add any additional borders)</p>\n\n<p><code>=B4&lt;&gt;\"\"</code> (applied to =$A:$T) (doesn't add any additional borders) </p>\n\n<p><code>=not(exact(B4, \"\"))</code> (applied to =$A:$T) (doesn't add any additional borders)</p>\n\n<p>...and of course using Excel's inbuilt \"cell doesn't contain a blank value\" doesn't allow you to specify that you want to know if another cell isn't blank. It'll add borders around cells after you've input into them, but if a cell in another column is blank for any reason, it leaves 'holes' in the table where there aren't any borders which makes it look even more messy.</p>\n\n<p>Am I just fundamentally misunderstanding the formulas, or can this not be done? (or do I need VBA to do this?)</p>\n"}]