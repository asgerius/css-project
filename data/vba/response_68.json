[{"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1751, "user_id": 5854349, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d5b543de0f52b16e1c1d30e4dd5693f9?s=128&d=identicon&r=PG&f=1", "display_name": "Timothy Kanski", "link": "https://stackoverflow.com/users/5854349/timothy-kanski"}, "edited": false, "score": 0, "creation_date": 1461799302, "post_id": 36902574, "comment_id": 61369185, "body": "Range(A7).Select should be Range(&quot;A7&quot;).Select"}, {"owner": {"reputation": 1, "user_id": 6185783, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/96596780a0a470b74693ae054351d657?s=128&d=identicon&r=PG&f=1", "display_name": "Samuel Leak", "link": "https://stackoverflow.com/users/6185783/samuel-leak"}, "reply_to_user": {"reputation": 1751, "user_id": 5854349, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d5b543de0f52b16e1c1d30e4dd5693f9?s=128&d=identicon&r=PG&f=1", "display_name": "Timothy Kanski", "link": "https://stackoverflow.com/users/5854349/timothy-kanski"}, "edited": false, "score": 0, "creation_date": 1461800130, "post_id": 36902574, "comment_id": 61369416, "body": "@TimothyKanski thanks for the quick reply, but it still has an error &quot;Run-time error 1004&quot;"}, {"owner": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 0, "creation_date": 1461805413, "post_id": 36902574, "comment_id": 61370754, "body": "<i>I&#39;ve had no luck</i> is not a useful problem description. What <b>specific problem</b> do you have with the code you&#39;ve posted?"}, {"owner": {"reputation": 1, "user_id": 6185783, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/96596780a0a470b74693ae054351d657?s=128&d=identicon&r=PG&f=1", "display_name": "Samuel Leak", "link": "https://stackoverflow.com/users/6185783/samuel-leak"}, "reply_to_user": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 0, "creation_date": 1461806272, "post_id": 36902574, "comment_id": 61370993, "body": "@KenWhite sorry - in short the code opens the file with no worries which is up to the line &quot;Workbooks.open (latestFile)&quot; - the problem occurs when i try and copy the data within Range(&quot;A7:V2000&quot;) and paste in the current workbook in which im writing the code - if you have any suggestions or more efficient solutions to select the range and copy / paste into the workbook the code is written that would be extremely helpful - cheers"}, {"owner": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 0, "creation_date": 1461806726, "post_id": 36902574, "comment_id": 61371121, "body": "You&#39;ve still not explained what <i>the problem</i> is, which is exactly the problem I pointed out in my last comment. What <b>specific</b> <i>problem occurs</i>??? What is the <b>specific issue you&#39;re having when you reach that line of code</b>?"}, {"owner": {"reputation": 1, "user_id": 6185783, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/96596780a0a470b74693ae054351d657?s=128&d=identicon&r=PG&f=1", "display_name": "Samuel Leak", "link": "https://stackoverflow.com/users/6185783/samuel-leak"}, "reply_to_user": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 0, "creation_date": 1461807323, "post_id": 36902574, "comment_id": 61371298, "body": "@kenWhite im not sure - i get a &quot;Run-Time error &#39;1004&#39;&quot; im not sure how else to explain this...after the file opens my code tries to select the range and for some reason it cant...and i get an application-edfined or object-defined error....could it be something too do with the file being in read only ?"}, {"owner": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 0, "creation_date": 1461807599, "post_id": 36902574, "comment_id": 61371374, "body": "Where in your question does it mention a <i>Run-time error &quot;1004&quot;</i>? That&#39;s &#39;the <b>specific problem</b> I&#39;ve asked you twice before to include in your question. Now please <a href=\"https://stackoverflow.com/posts/36902574/edit\">edit</a> your question to include that information <b>there</b>, where it should have been in the first place. You had that information when you posted your question, and there are zero valid reasons for you not to have included it when you posted."}, {"owner": {"reputation": 1, "user_id": 6185783, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/96596780a0a470b74693ae054351d657?s=128&d=identicon&r=PG&f=1", "display_name": "Samuel Leak", "link": "https://stackoverflow.com/users/6185783/samuel-leak"}, "reply_to_user": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 0, "creation_date": 1461807712, "post_id": 36902574, "comment_id": 61371409, "body": "@kenwhite i mentioned this error in the first reply of this problem to TimothyKanski - but i will add to the question"}, {"owner": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 0, "creation_date": 1461807895, "post_id": 36902574, "comment_id": 61371459, "body": "Guess I missed it, because it was in the comments and <b>not in the question where it belonged</b>. You&#39;re asking us for help to solve <b>your</b> problem; when you have information that is highly relevant to the question, put it in the question in the first place. We shouldn&#39;t have to play 20 questions to get you to provide the important details you should have provided already."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 6185783, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/96596780a0a470b74693ae054351d657?s=128&d=identicon&r=PG&f=1", "display_name": "Samuel Leak", "link": "https://stackoverflow.com/users/6185783/samuel-leak"}, "edited": false, "score": 0, "creation_date": 1461805434, "post_id": 36903184, "comment_id": 61370760, "body": "i still seem to be having an issue with this - thanks a lot for you help, the issue arises when i try selecting the data from first workbook that is opened, is there an easier code i can use to select copy and paste the data  ? also i want to paste it into the book in which im currently writing the VBA so the file name &quot;RMBS..&quot; is probs irrelevant and i can use ActiveWorkbook.open"}, {"owner": {"reputation": 748, "user_id": 6209872, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d51589c2d23ee66dc43c65c410bbf70c?s=128&d=identicon&r=PG&f=1", "display_name": "yk11", "link": "https://stackoverflow.com/users/6209872/yk11"}, "reply_to_user": {"reputation": 1, "user_id": 6185783, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/96596780a0a470b74693ae054351d657?s=128&d=identicon&r=PG&f=1", "display_name": "Samuel Leak", "link": "https://stackoverflow.com/users/6185783/samuel-leak"}, "edited": false, "score": 0, "creation_date": 1461854508, "post_id": 36903184, "comment_id": 61397972, "body": "You can use <code>courceRange.Copy targetRange</code>.  This syntax allows you to copy/paste in a single operation.  You should also look into <code>PasteSpecial</code> if you need to control what is copied (formats, values, etc.)."}], "tags": [], "owner": {"reputation": 748, "user_id": 6209872, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d51589c2d23ee66dc43c65c410bbf70c?s=128&d=identicon&r=PG&f=1", "display_name": "yk11", "link": "https://stackoverflow.com/users/6209872/yk11"}, "is_accepted": false, "score": 0, "last_activity_date": 1461803276, "creation_date": 1461803276, "answer_id": 36903184, "question_id": 36902574, "link": "https://stackoverflow.com/questions/36902574/open-most-up-to-date-file-on-sharedrive-and-copy-paste-into-workbook/36903184#36903184", "title": "Open most up to date file on sharedrive and copy/paste into workbook", "body": "<p>Assuming that <code>RMBS ...</code> is the master file:</p>\n\n<pre><code>Workbooks.Open(latestFile)\nWorksheets(\"Ratesheet\").Activate\nRange(\"A7\").Select\nSelection.copy\n' ActiveWorkbook.Close if needed\n\nWorkbooks.Open(\"RMBS Pricing_New v5 (version 1) [Autosaved]\")\nRange(\"A7\").Select\nSelection.Paste\n' Save/close as needed\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "is_accepted": false, "score": 0, "last_activity_date": 1461820221, "last_edit_date": 1495542680, "creation_date": 1461819827, "answer_id": 36905658, "question_id": 36902574, "link": "https://stackoverflow.com/questions/36902574/open-most-up-to-date-file-on-sharedrive-and-copy-paste-into-workbook/36905658#36905658", "title": "Open most up to date file on sharedrive and copy/paste into workbook", "body": "<p>This is the simplest way to achieve what you want. Avoid the use of <code>.Select/.Activate</code>. You may want to see <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba-macros\">THIS</a></p>\n\n<p><strong>My Assumptions</strong>: </p>\n\n<ol>\n<li>The file that you are trying to open can be opened in Excel</li>\n<li>You are running the code from <code>RMBS Pricing_New v5 (version 1)</code>. If not then declare another workbook object and assign this workbook to that object.</li>\n</ol>\n\n<p>Is this what you are trying? (<strong>Untested</strong>)</p>\n\n<pre><code>Sub GetLatestFile()\n    Dim strFolder As String, strFile As String, latestFile As String\n    Dim dtLast As Date\n\n    Dim wbThis As Workbook, wbThat As Workbook\n    Dim wsThis As Worksheet, wsThat As Worksheet\n\n    Set wbThis = ThisWorkbook\n    '&lt;~~ Change this to the relevant sheetname where you want to paste\n    Set wsThis = wbThis.Sheets(\"Sheet1\")\n\n    '\n    '~~&gt; Your code to find the latest file\n    '\n\n    Set wbThat = Workbooks.Open(latestFile)\n    Set wsThat = wbThat.Sheets(\"Ratesheet\")\n\n    wsThat.Range(A7).Copy wsThis.Range(\"A7\")\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 6185783, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/96596780a0a470b74693ae054351d657?s=128&d=identicon&r=PG&f=1", "display_name": "Samuel Leak", "link": "https://stackoverflow.com/users/6185783/samuel-leak"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 58, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1461820221, "creation_date": 1461799130, "last_edit_date": 1461807791, "question_id": 36902574, "link": "https://stackoverflow.com/questions/36902574/open-most-up-to-date-file-on-sharedrive-and-copy-paste-into-workbook", "title": "Open most up to date file on sharedrive and copy/paste into workbook", "body": "<p>I have been able to get some code to open the most up to date file located on a share drive. The part of code that i'm really struggling with is the last part which tries to copy and paste the contents of that file into my master - i tried recording this last part and alter that code but have had no luck - i feel like im on the right track but would appreciate any pointers! the specific error is \"Run-time error '1004'\"</p>\n\n<pre><code>Sub GetLatestFile()\n\nDim strFolder  As String\nDim strFile    As String\nDim latestFile As String\nDim dtLast     As Date\n\n'   assign variables\n    strFolder = \"Z:\\PRICING1\\1Mbs Pricing1\\MBSREVAL11\\21016111\\\" 'The end of this path must have a \\ on it\n    strFile = Dir(strFolder &amp; \"\\*.*\", vbNormal)    ' Any File\n'   strFile = Dir(strFolder &amp; \"\\*.xls*\", vbNormal) ' Excel Files\n'   strFile = Dir(strFolder &amp; \"\\*.csv\", vbNormal)  ' CSV Files\n\n'   loop through files to find latest modified date\n    Do While strFile &lt;&gt; \"\"\n        If FileDateTime(strFolder &amp; strFile) &gt; dtLast Then\n            dtLast = FileDateTime(strFolder &amp; strFile)\n            latestFile = strFolder &amp; strFile\n        End If\n        strFile = Dir\n    Loop\n\n    MsgBox latestFile\n\n    Workbooks.Open (latestFile)\n\n    Worksheets(\"Ratesheet\").Activate\n    Range(A7).Select\n    Selection.copy\n    Windows(\"RMBS Pricing_New v5 (version 1) [Autosaved]\").Activate\n    Range(\"A7\").Select\n    ActiveSheet.Paste\n    Windows(latestFile).Activate\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 1, "creation_date": 1461796642, "post_id": 36902145, "comment_id": 61368372, "body": "<a href=\"https://msdn.microsoft.com/en-us/library/office/ff196678.aspx\" rel=\"nofollow noreferrer\">resize it</a>."}, {"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 1, "creation_date": 1461797040, "post_id": 36902145, "comment_id": 61368539, "body": "personal preference of course, but might want to remove your name from that file path..."}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "reply_to_user": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 0, "creation_date": 1461797098, "post_id": 36902145, "comment_id": 61368568, "body": "@MacroMan no one would&#39;ve noticed until you pointed it out =P"}, {"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1461797264, "post_id": 36902145, "comment_id": 61368617, "body": "@findwindow still, better me than an annoying recruitment spam person/thing."}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "reply_to_user": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 2, "creation_date": 1461797301, "post_id": 36902145, "comment_id": 61368636, "body": "@MacroMan don&#39;t flatter yourself. No one is more annoying than <i>you</i> =P Edit: I am so troll XD"}], "answers": [{"comments": [{"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1461821180, "post_id": 36902214, "comment_id": 61375299, "body": "Nice one.. there is a slight problem with this. If your data is till say 5th row and the Row 2 to 10th row has formula in it then it will copy till the 10th row :). This will happen even when the formula returns a blank value"}, {"owner": {"reputation": 119, "user_id": 6237157, "user_type": "registered", "accept_rate": 17, "profile_image": "https://i.stack.imgur.com/yo5MR.jpg?s=128&g=1", "display_name": "Meedee", "link": "https://stackoverflow.com/users/6237157/meedee"}, "edited": false, "score": 0, "creation_date": 1461875200, "post_id": 36902214, "comment_id": 61410861, "body": "This worked! Just had to change .Copy to .Select.. Thank you so much! @MacroMan"}], "tags": [], "owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "is_accepted": false, "score": 2, "last_activity_date": 1461796877, "creation_date": 1461796877, "answer_id": 36902214, "question_id": 36902145, "link": "https://stackoverflow.com/questions/36902145/select-all-cells-with-value-from-specific-row/36902214#36902214", "title": "Select all cells with value from specific row", "body": "<p>You will need to offset and resize:</p>\n\n<pre><code>With Sheets(\"Sheet1\").Range(\"A2\").CurrentRegion.Offset(1, 0)\n    .Resize(.Rows.Count - 1, .Columns.Count).Copy\nEnd With\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 1, "creation_date": 1461829404, "post_id": 36906125, "comment_id": 61379606, "body": "This would be my preferred method instead of<code>.CurrentRegion</code> +1"}, {"owner": {"reputation": 119, "user_id": 6237157, "user_type": "registered", "accept_rate": 17, "profile_image": "https://i.stack.imgur.com/yo5MR.jpg?s=128&g=1", "display_name": "Meedee", "link": "https://stackoverflow.com/users/6237157/meedee"}, "edited": false, "score": 0, "creation_date": 1461875391, "post_id": 36906125, "comment_id": 61410963, "body": "I tried this &amp; it works perfectly when copying from the same workbook. I guess I forgot to specify that I&#39;m copying from a different workbook."}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1461989486, "post_id": 36906125, "comment_id": 61459607, "body": "You can copy to different workbook using this as well :)"}], "tags": [], "owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "is_accepted": false, "score": 6, "last_activity_date": 1461821980, "creation_date": 1461821980, "answer_id": 36906125, "question_id": 36902145, "link": "https://stackoverflow.com/questions/36902145/select-all-cells-with-value-from-specific-row/36906125#36906125", "title": "Select all cells with value from specific row", "body": "<p>Even though you have mentioned <code>CurrentRegion</code> in your code, I suspect you do not need it or at least are not planning to use it in the intended way</p>\n\n<p>Let's say our worksheet looks like this. Notice the formulas in Col F?</p>\n\n<p><a href=\"https://i.stack.imgur.com/RnS0A.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/RnS0A.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>The problem with using <code>.Resize</code> is that it will include cells which has formulas even if they return blank values. </p>\n\n<p>Taking MacroMan's example</p>\n\n<pre><code>Sub Sample()\n    With Sheets(\"Sheet1\").Range(\"A2\").CurrentRegion.Offset(1, 0)\n        .Resize(.Rows.Count - 1, .Columns.Count).Select\n    End With\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/0LgwN.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/0LgwN.png\" alt=\"enter image description here\"></a></p>\n\n<hr>\n\n<blockquote>\n  <p>I'm trying to copy all cells with value in it from 2nd row 'coz 1st row is the heading/title. </p>\n</blockquote>\n\n<p>From what I understand, what you want can be achieved by finding the last row and last column <strong>which has data</strong> and copying that.</p>\n\n<p>I think this is what you want? Notice the use of <code>LookIn:=xlValues</code> with <code>.Find</code></p>\n\n<pre><code>Sub Sample()\n    Dim ws As Worksheet\n    Dim rng As Range\n    Dim lRow As Long, lCol As Long\n\n    Set ws = ThisWorkbook.Sheets(\"Sheet1\")\n\n    With ws\n        lRow = .Cells.Find(What:=\"*\", _\n                After:=.Range(\"A1\"), _\n                Lookat:=xlPart, _\n                LookIn:=xlValues, _\n                SearchOrder:=xlByRows, _\n                SearchDirection:=xlPrevious, _\n                MatchCase:=False).Row\n\n        lCol = .Cells.Find(What:=\"*\", _\n                After:=.Range(\"A1\"), _\n                Lookat:=xlPart, _\n                LookIn:=xlValues, _\n                SearchOrder:=xlByColumns, _\n                SearchDirection:=xlPrevious, _\n                MatchCase:=False).Column\n\n        Set rng = .Range(.Cells(2, 1), .Cells(lRow, lCol))\n\n        Debug.Print rng.Address\n        rng.Copy\n    End With\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/tcrEn.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/tcrEn.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 119, "user_id": 6237157, "user_type": "registered", "accept_rate": 17, "profile_image": "https://i.stack.imgur.com/yo5MR.jpg?s=128&g=1", "display_name": "Meedee", "link": "https://stackoverflow.com/users/6237157/meedee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 157, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1461850765, "creation_date": 1461796502, "last_edit_date": 1461850765, "question_id": 36902145, "link": "https://stackoverflow.com/questions/36902145/select-all-cells-with-value-from-specific-row", "title": "Select all cells with value from specific row", "body": "<p>I'm trying to copy all cells with value in it from 2nd row 'coz 1st row is the heading/title. However, my code seems to select ALL cells with value. :(<br>\nHere's my code to copy:</p>\n\n<pre><code>Dim myData As Workbook\nSet myData = Workbooks.Open(\"C:\\Book2.xlsx\")\n\nWorksheets(\"Sheet1\").Range(\"A2\").Select\nWorksheets(\"Sheet1\").Range(\"A2\").CurrentRegion.Copy\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1461835740, "post_id": 36901763, "comment_id": 61383617, "body": "FYI, you use <code>ThisWorkbook</code> to refer to the workbook containing the code that is running. If this code is not in the add-in, then you wouldn&#39;t get the results you expect."}], "answers": [{"comments": [{"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 1, "creation_date": 1461822519, "post_id": 36902358, "comment_id": 61375819, "body": "This will not give you the last row of <code>Workbooks(&quot;Book1.xlam&quot;).Sheets(&quot;Sheet1&quot;)</code> unless it is the activesheet. You need to add <code>.</code> before the range and other objects"}, {"owner": {"reputation": 1831, "user_id": 2967019, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/rnBqX.jpg?s=128&g=1", "display_name": "mrbungle", "link": "https://stackoverflow.com/users/2967019/mrbungle"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1461853654, "post_id": 36902358, "comment_id": 61397248, "body": "I thought so to but it worked at the time.  Coming back to it today I realize that only worked because I had the actual workbook open.  Now trying to figure out how to reference the values in the worksheet of the addin without the addin workbook actually being open."}], "tags": [], "owner": {"reputation": 1831, "user_id": 2967019, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/rnBqX.jpg?s=128&g=1", "display_name": "mrbungle", "link": "https://stackoverflow.com/users/2967019/mrbungle"}, "is_accepted": false, "score": 0, "last_activity_date": 1461797706, "creation_date": 1461797706, "answer_id": 36902358, "question_id": 36901763, "link": "https://stackoverflow.com/questions/36901763/last-row-of-addin-worksheet/36902358#36902358", "title": "Last row of AddIn worksheet", "body": "<p>I was close.  This retrieves the correct last row number for the addin worksheet</p>\n\n<pre><code>With Workbooks(\"Book1.xlam\").Sheets(\"Sheet1\")\n\nlRow = Range(\"A1\", Range(\"A\" &amp; Rows.Count).End(xlUp)).SpecialCells(xlCellTypeVisible).Count\n\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 1831, "user_id": 2967019, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/rnBqX.jpg?s=128&g=1", "display_name": "mrbungle", "link": "https://stackoverflow.com/users/2967019/mrbungle"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 51, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1461797706, "creation_date": 1461794721, "last_edit_date": 1461796707, "question_id": 36901763, "link": "https://stackoverflow.com/questions/36901763/last-row-of-addin-worksheet", "title": "Last row of AddIn worksheet", "body": "<p>I've created an AddIn and need to reference the last cell in column A.  I do this all the time in regular macros but having a time with it in the AddIn.</p>\n\n<p>I've tried </p>\n\n<pre><code>lRow2 = ThisWorkbook.Sheets(\"Client\").Range(\"A1\", Range(\"A\" &amp; Rows.Count).End(xlUp)).SpecialCells(xlCellTypeVisible).Count\n</code></pre>\n\n<p>and </p>\n\n<pre><code>lRow2 = ThisWorkbook.Sheets(1).Range(\"A1\", Range(\"A\" &amp; Rows.Count).End(xlUp)).SpecialCells(xlCellTypeVisible).Count\n</code></pre>\n\n<p>even</p>\n\n<pre><code>Dim ws2 As Worksheet\nDim lRow2 As Long\n\nSet ws2 = ThisWorkbook.Sheets(\"Client\")\n\nWith ws2\n    lRow2 = .Range(\"A\" &amp; .Rows.Count).End(xlUp).Row\nEnd With\n</code></pre>\n\n<p>which only returns a value of 1 which is not correct.</p>\n\n<p>I've read that I have to use <code>ThisWorkbook</code> to refer to the AddIn worksheet but I either get subscript out of range or object doesn't support this methods in the various way I've tried to write this out.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1461794893, "post_id": 36901737, "comment_id": 61367678, "body": "<code>url = &quot;https:&#47;&#47;www.google.co.in&#47;search?q=&quot; &amp; Cells(i, 1) &amp; &quot;&amp;rnd=&quot; &amp; WorksheetFunction.RandBetween(1, 10000)</code> are you cracking sites?"}, {"owner": {"reputation": 155, "user_id": 6252387, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/c3e4e1a236dfd83f1692ed51a6184a17?s=128&d=identicon&r=PG&f=1", "display_name": "Brayheart", "link": "https://stackoverflow.com/users/6252387/brayheart"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 1, "creation_date": 1461795186, "post_id": 36901737, "comment_id": 61367787, "body": "I&#39;m not sure what you mean by &quot;cracking sites&quot;  I should mention that I found this code from this page: <a href=\"http://stackoverflow.com/questions/17495644/using-vba-in-excel-to-google-search-in-ie-and-return-the-hyperlink-of-the-first\" title=\"using vba in excel to google search in ie and return the hyperlink of the first\">stackoverflow.com/questions/17495644/&hellip;</a>"}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1461795323, "post_id": 36901737, "comment_id": 61367845, "body": "You&#39;re hitting google for random pages (RandBetween) 12k times. That&#39;s something crackers do. Just wanted to make sure."}, {"owner": {"reputation": 155, "user_id": 6252387, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/c3e4e1a236dfd83f1692ed51a6184a17?s=128&d=identicon&r=PG&f=1", "display_name": "Brayheart", "link": "https://stackoverflow.com/users/6252387/brayheart"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1461795415, "post_id": 36901737, "comment_id": 61367899, "body": "Does that have anything to do with the error? Its strange I can&#39;t get it to work under the original conditions when I did function properly."}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1461795491, "post_id": 36901737, "comment_id": 61367937, "body": "No, I only asked because cracking is uh...frowned upon. I am not familiar with xml so can&#39;t comment. Nothing looks obviously out of line though. The loop is closed. Edit: maybe something took too long for google to respond but <code>doevents</code> should handle that? I don&#39;t know :/ Edit2: build an errorhandler if response is taking too long?"}, {"owner": {"reputation": 6762, "user_id": 845655, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/ySyzL.jpg?s=128&g=1", "display_name": "DeanOC", "link": "https://stackoverflow.com/users/845655/deanoc"}, "edited": false, "score": 0, "creation_date": 1461795804, "post_id": 36901737, "comment_id": 61368052, "body": "I cut/paste your code into a fresh workbook and it runs without errors."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1461795809, "post_id": 36901737, "comment_id": 61368053, "body": "Stick <code>On Error GoTo ErrHandler</code> at the top, then <code>Exit Sub</code> at the bottom, and below that make an <code>ErrHandler:</code> line label, put <code>Stop</code> and <code>Resume</code> instructions there, and step through your code. Where does it blow up?"}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1461795853, "post_id": 36901737, "comment_id": 61368071, "body": "Huh apparently when you google search, you append random numbers O.o I apologize for my accusation earlier. So according to that example, if 60k can be done, then 12k should be cake (suggesting one of your searches is &quot;bad&quot;). Check which row it errors out on and <code>debug.print cells(i,1).value2</code>"}, {"owner": {"reputation": 155, "user_id": 6252387, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/c3e4e1a236dfd83f1692ed51a6184a17?s=128&d=identicon&r=PG&f=1", "display_name": "Brayheart", "link": "https://stackoverflow.com/users/6252387/brayheart"}, "edited": false, "score": 0, "creation_date": 1461797797, "post_id": 36901737, "comment_id": 61368788, "body": "Set objH3 = objResultDiv.getelementsbytagname(&quot;H3&quot;)(0)  this is the line where it messes up apparently. Also I should note that the code doesn&#39;t work for anything anymore. It just flat out wont run even for the original 800 rows that it already worked for."}, {"owner": {"reputation": 155, "user_id": 6252387, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/c3e4e1a236dfd83f1692ed51a6184a17?s=128&d=identicon&r=PG&f=1", "display_name": "Brayheart", "link": "https://stackoverflow.com/users/6252387/brayheart"}, "reply_to_user": {"reputation": 6762, "user_id": 845655, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/ySyzL.jpg?s=128&g=1", "display_name": "DeanOC", "link": "https://stackoverflow.com/users/845655/deanoc"}, "edited": false, "score": 0, "creation_date": 1461798600, "post_id": 36901737, "comment_id": 61368994, "body": "@DeanOC THEN WHY WONT IT WORK FOR ME?? :((. It worked for 800 rows then stopped and now wont work anymore :("}, {"owner": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "edited": false, "score": 0, "creation_date": 1461800003, "post_id": 36901737, "comment_id": 61369387, "body": "Can you try move <code>Set XMLHTTP = CreateObject(&quot;MSXML2.serverXMLHTTP&quot;)</code> before the For loop or put <code>Set XMLHTTP = Nothing</code> before Next? Restart Excel should make it work again? May be you need to put <code>XMLHTTP.waitForResponse</code> or check for <code>XMLHTTP.Status</code> at some stage?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 1, "creation_date": 1461800560, "post_id": 36901737, "comment_id": 61369540, "body": "Are you aware that Google has software that recognizes too many robotic searches and blocks the IP for a short period?"}, {"owner": {"reputation": 155, "user_id": 6252387, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/c3e4e1a236dfd83f1692ed51a6184a17?s=128&d=identicon&r=PG&f=1", "display_name": "Brayheart", "link": "https://stackoverflow.com/users/6252387/brayheart"}, "edited": false, "score": 0, "creation_date": 1461950135, "post_id": 36901737, "comment_id": 61446803, "body": "As Jeeped said I think Google flags me after so many entries. Any Ideas on how to circumvent this? I was thinking of putting something in that would switch to internet explorer or Firefox once this happens or would that not matter?"}], "answers": [{"tags": [], "owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "is_accepted": false, "score": 1, "last_activity_date": 1461824937, "creation_date": 1461824937, "answer_id": 36906902, "question_id": 36901737, "link": "https://stackoverflow.com/questions/36901737/vba-run-time-error-91-object-variable-or-with-block-variable-not-set/36906902#36906902", "title": "VBA Run-time Error &#39;91&#39; Object-variable or With block variable not set", "body": "<blockquote>\n  <p>Run-time Error '91' Object-variable or With block variable not set</p>\n</blockquote>\n\n<p>You are getting that error because one of the below SET statement is failing.</p>\n\n<pre><code>Set objResultDiv = html.getelementbyid(\"rso\")\nSet objH3 = objResultDiv.getelementsbytagname(\"H3\")(0)\nSet link = objH3.getelementsbytagname(\"a\")(0)\n</code></pre>\n\n<p>You need to properly handle the objects. For example</p>\n\n<pre><code>Set objResultDiv = HTML.getelementbyid(\"rso\")\n\nIf objResultDiv Is Nothing Then\n    MsgBox \"Id `rso` not found for \" &amp; Cells(i, 1)\nElse\n    Set objH3 = objResultDiv.getelementsbytagname(\"H3\")(0)\n\n    If objH3 Is Nothing Then\n        MsgBox \"Tag `H3` not found for \" &amp; Cells(i, 1)\n    Else\n        Set link = objH3.getelementsbytagname(\"a\")(0)\n\n        If link Is Nothing Then\n            MsgBox \"Tag `a` not found for \" &amp; Cells(i, 1)\n        Else\n            '\n            '~~&gt; Rest of your code\n            '\n        End If\n    End If\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 155, "user_id": 6252387, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/c3e4e1a236dfd83f1692ed51a6184a17?s=128&d=identicon&r=PG&f=1", "display_name": "Brayheart", "link": "https://stackoverflow.com/users/6252387/brayheart"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1413, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1461824937, "creation_date": 1461794621, "last_edit_date": 1461802246, "question_id": 36901737, "link": "https://stackoverflow.com/questions/36901737/vba-run-time-error-91-object-variable-or-with-block-variable-not-set", "title": "VBA Run-time Error &#39;91&#39; Object-variable or With block variable not set", "body": "<p>I have about 12,000 rows of data that I need websites for. This VBA code was working fine for about 800 and then stopped. Now I can't get it to run again due to this error. I can't figure out how to get it running again.</p>\n\n<blockquote>\n  <p>Run-time Error '91' Object-variable or With block variable not set</p>\n</blockquote>\n\n<pre><code>Sub XMLHTTP()\n\n    Dim url As String, lastRow As Long\n    Dim XMLHTTP As Object, html As Object, objResultDiv As Object, objH3 As Object, link As Object\n    Dim start_time As Date\n    Dim end_time As Date\n\n    lastRow = Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n\n    Dim cookie As String\n    Dim result_cookie As String\n\n    start_time = Time\n    Debug.Print \"start_time:\" &amp; start_time\n\n    For i = 2 To lastRow\n\n        url = \"https://www.google.co.in/search?q=\" &amp; Cells(i, 1) &amp; \"&amp;rnd=\" &amp; WorksheetFunction.RandBetween(1, 10000)\n\n        Set XMLHTTP = CreateObject(\"MSXML2.serverXMLHTTP\")\n        XMLHTTP.Open \"GET\", url, False\n        XMLHTTP.setRequestHeader \"Content-Type\", \"text/xml\"\n        XMLHTTP.setRequestHeader \"User-Agent\", \"Mozilla/5.0 (Windows NT 6.1; rv:25.0) Gecko/20100101 Firefox/25.0\"\n        XMLHTTP.send\n\n            Set html = CreateObject(\"htmlfile\")\n        html.body.innerHTML = XMLHTTP.ResponseText\n        Set objResultDiv = html.getelementbyid(\"rso\")\n        Set objH3 = objResultDiv.getelementsbytagname(\"H3\")(0)\n        Set link = objH3.getelementsbytagname(\"a\")(0)\n\n\n        str_text = Replace(link.innerHTML, \"&lt;EM&gt;\", \"\")\n        str_text = Replace(str_text, \"&lt;/EM&gt;\", \"\")\n\n        Cells(i, 2) = str_text\n        Cells(i, 3) = link.href\n        DoEvents\n    Next\n\n    end_time = Time\n    Debug.Print \"end_time:\" &amp; end_time\n\n    Debug.Print \"done\" &amp; \"Time taken : \" &amp; DateDiff(\"n\", start_time, end_time)\n    MsgBox \"done\" &amp; \"Time taken : \" &amp; DateDiff(\"n\", start_time, end_time)\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "combobox"], "comments": [{"owner": {"reputation": 2089, "user_id": 2901085, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jxiyV.jpg?s=128&g=1", "display_name": "OldUgly", "link": "https://stackoverflow.com/users/2901085/oldugly"}, "edited": false, "score": 0, "creation_date": 1461816798, "post_id": 36901464, "comment_id": 61373877, "body": "I&#39;m assuming there is a field in the AllIdeas sheet for &quot;Idea Owners&quot; and a field for &quot;Status&quot;. If you have something working for &quot;Idea Number&quot;, it should be similar for the other two. The challenge is, do you want the user to pick his name from a drop down list, or do you have some other means to identify him/her. I recommend you post a small mock up sample of your AllIdeas worksheet, and your Idea Number code."}, {"owner": {"reputation": 105, "user_id": 6141287, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4605e092c7dcfd8fe1903da38f1fdd3e?s=128&d=identicon&r=PG", "display_name": "jrichall", "link": "https://stackoverflow.com/users/6141287/jrichall"}, "reply_to_user": {"reputation": 2089, "user_id": 2901085, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jxiyV.jpg?s=128&g=1", "display_name": "OldUgly", "link": "https://stackoverflow.com/users/2901085/oldugly"}, "edited": false, "score": 0, "creation_date": 1461847152, "post_id": 36901464, "comment_id": 61391873, "body": "You are correct, OldUgly, I have columns with the Idea Owners, Status, Etc. I would like for a user to select their name in a comboBox, then hit &quot;Filter Ideas&quot;, and have the &quot;AllIdeas&quot; sheet become unhidden and filtered by the name selected.  Here is the code I&#39;m using for the &quot;Idea query&quot; on the dashboard: <code>=IFERROR(INDEX(AllIdeas!D:D,MATCH(Dashboard!D13,AllIdeas!B:B&zwnj;&#8203;,0)),&quot;&quot;)</code> - I&#39;m running an index match, so a user can see the idea description, solution, and status; so long as they know the idea number. I posted an example of my dashboard at the end of my initial question."}], "answers": [{"comments": [{"owner": {"reputation": 105, "user_id": 6141287, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4605e092c7dcfd8fe1903da38f1fdd3e?s=128&d=identicon&r=PG", "display_name": "jrichall", "link": "https://stackoverflow.com/users/6141287/jrichall"}, "edited": false, "score": 0, "creation_date": 1461943940, "post_id": 36926808, "comment_id": 61443444, "body": "That is an AMAZING response! Thank you! I think I can work what you&#39;ve given me into my workbook. I think what I would like to do, if possible, is utilize the &quot;FetchIdeas&quot; macro to show the AllIdeas sheet, filtered with the selection. The data I have is way to large to populate on the dashboard. Could I add the following code into the FetchIdeas Macro somewhere? <code>Worksheets(&quot;AllIdeas&quot;).Visible = xlSheetVisible Worksheets(&quot;AllIdeas&quot;).Activate</code>"}], "tags": [], "owner": {"reputation": 2089, "user_id": 2901085, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jxiyV.jpg?s=128&g=1", "display_name": "OldUgly", "link": "https://stackoverflow.com/users/2901085/oldugly"}, "is_accepted": true, "score": 1, "last_activity_date": 1461884000, "creation_date": 1461884000, "answer_id": 36926808, "question_id": 36901464, "link": "https://stackoverflow.com/questions/36901464/using-a-combobox-and-click-to-filter-data-on-a-separate-sheet-in-excel/36926808#36926808", "title": "Using a combobox and click to filter data on a separate sheet in Excel", "body": "<p>jrichall - This answer is to provide a framework, with examples, to help address your problem. It does not lay things out exactly as you have designed.</p>\n\n<p>I've broken it down this way ...</p>\n\n<ol>\n<li>Lists are required for unique Names, Status, Idea Numbers, etc., that exist on the AllIdeas table. These lists are used to limit the end users choices for filtering, but they need to be kept up to date as/when the contents change.</li>\n<li>You are limiting the end user to one kind of filter at a time - either by Name, Status, Idea Number, or something else. This means you need a way to eliminate one kind of filter when the other is chosen.</li>\n<li>The old filtering of AllIdeas needs to be eliminated before a new filter is applied.</li>\n<li>Displaying the filtered results on the Dashboard means maintaining the dashboard appearance.</li>\n</ol>\n\n<p>Note: In my example, I am not using Combo Boxes. However, the concepts are easily transportable.</p>\n\n<hr>\n\n<p><strong>A simple AllIdeas</strong></p>\n\n<p>To test the code, a simple mockup of AllIdeas was generated ...</p>\n\n<p><a href=\"https://i.stack.imgur.com/5Fa7n.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/5Fa7n.png\" alt=\"enter image description here\"></a></p>\n\n<hr>\n\n<p><strong>A simple dashboard</strong></p>\n\n<p>A simple dashboard was also put together. In it, Cells A2, B2, and C2 have their input protected using Data Validation.</p>\n\n<p><a href=\"https://i.stack.imgur.com/DgRYS.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/DgRYS.png\" alt=\"enter image description here\"></a> </p>\n\n<p>A named Range defines the valid data. Illustrated above is the named Range \"Names\".</p>\n\n<hr>\n\n<p><strong>Lists and maintaining them</strong></p>\n\n<p>The Lists of valid Names, Status, and Numbers (named ranges) are maintained on a tab named \"DropDowns\". It looks like the following ...</p>\n\n<p><a href=\"https://i.stack.imgur.com/9nOBR.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/9nOBR.png\" alt=\"enter image description here\"></a></p>\n\n<p>You can see these lists do not contain all of the information contained in the AllIdeas table. Below is VBA code to update the \"Names\" list. Similar ones exist for updating the \"Status\" list and the \"Numbers\" list. </p>\n\n<pre><code>Sub UpdateNamesList()\nDim IdeaSht As Worksheet, ListSht As Worksheet\nDim IdeaRng As Range, myRng As Range\nDim iCount As Long, NameCol As Long\nDim myDict As Object, myKey As Variant\nDim namedRange As Name\n' Initial\nSet IdeaSht = Worksheets(\"AllIdeas\")\nSet ListSht = Worksheets(\"DropDowns\")\nSet myDict = CreateObject(\"Scripting.Dictionary\")\n\n' Find the column with the user names\nFor Each myRng In IdeaSht.Range(IdeaSht.Cells(1, 1), IdeaSht.Cells(1, IdeaSht.Cells(1, IdeaSht.Columns.Count).End(xlToLeft).Column))\n    If myRng.Value = \"Idea Owner\" Then\n        NameCol = myRng.Column\n        Exit For\n    End If\nNext myRng\n\n' Pull out unique user names\nFor Each myRng In IdeaSht.Range(IdeaSht.Cells(2, NameCol), IdeaSht.Cells(IdeaSht.Range(\"A\" &amp; IdeaSht.Rows.Count).End(xlUp).Row, NameCol))\n    If Not myDict.exists(myRng.Value) Then\n        myDict.Add myRng.Value, myRng.Value\n    End If\nNext myRng\n\n' Change \"Names\" list to contain the unique user names\nFor Each myRng In ListSht.Range(ListSht.Cells(1, 1), ListSht.Cells(1, ListSht.Cells(1, ListSht.Columns.Count).End(xlToLeft).Column))\n    If myRng.Value = \"Names\" Then\n        NameCol = myRng.Column\n        Exit For\n    End If\nNext myRng\n\niCount = 0\nFor Each myKey In myDict\n    ListSht.Cells(2 + iCount, NameCol).Value = myKey\n    iCount = iCount + 1\nNext myKey\n\nSet namedRange = ActiveWorkbook.Names(\"Names\")\nnamedRange.RefersTo = ListSht.Range(ListSht.Cells(2, NameCol), ListSht.Cells(1 + iCount, NameCol))\n\n' clean up\nSet IdeaSht = Nothing\nSet ListSht = Nothing\nSet myDict = Nothing\nSet namedRange = Nothing\n\nEnd Sub\n</code></pre>\n\n<p>After running these routines, the named range lists now look like the following ...</p>\n\n<p><a href=\"https://i.stack.imgur.com/2qjdb.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/2qjdb.png\" alt=\"enter image description here\"></a></p>\n\n<p>These routines are added to the WorkBook_Open Event code, so they stay up to date for the user ...</p>\n\n<pre><code>Private Sub Workbook_Open()\n    UpdateNamesList\n    UpdateStatusList\n    UpdateNumberList\nEnd Sub\n</code></pre>\n\n<p>Now, the user has drop down lists that are up to date (a similar method could be used to keep combo boxes up to date) ...</p>\n\n<p><a href=\"https://i.stack.imgur.com/wwgd9.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/wwgd9.png\" alt=\"enter image description here\"></a></p>\n\n<hr>\n\n<p><strong>Filtering - there can be only one!</strong></p>\n\n<p>To manage clearing filtering in Cell A2 when something is specified in Cell B2, or all other combinations of changes in the three filter specifications, the WorkSheet_Change event code for the Dashboard was used ...</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\nDim iLoop As Long\n    If Intersect(Target, ActiveSheet.Range(\"A2:C2\")) Is Nothing Then Exit Sub\n    Application.EnableEvents = False\n    For iLoop = 1 To 3\n        If Target.Column &lt;&gt; iLoop Then ActiveSheet.Cells(2, iLoop).Value = \"\"\n    Next iLoop\n    Application.EnableEvents = True\nEnd Sub\n</code></pre>\n\n<p>Now, picking one filter automatically clears the other ...</p>\n\n<p><a href=\"https://i.stack.imgur.com/Xscf1.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Xscf1.png\" alt=\"enter image description here\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/bGZX7.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/bGZX7.png\" alt=\"enter image description here\"></a></p>\n\n<hr>\n\n<p><strong>Filtering and Displaying</strong></p>\n\n<p>The \"FetchIdeas\" button is connected to the following piece of VBA code ...</p>\n\n<pre><code>Sub FetchAllIdeas()\nDim IdeaSht As Worksheet, DshbrdSht As Worksheet\nDim myRng As Range\nDim lstRow As Long, lstCol As Long\nDim FltrVal() As Variant, FltrCol As Long\nDim myField As Long, iLoop As Long\n'Initial\nSet IdeaSht = Worksheets(\"AllIdeas\")\nSet DshbrdSht = Worksheets(\"Dashboard\")\n\n'Determine which filter we are using\nReDim FltrVal(1 To 1)\nmyField = 0\nFor Each myRng In DshbrdSht.Range(\"A2:C2\")\n    If myRng.Value &lt;&gt; \"\" Then\n        FltrVal(1) = myRng.Value\n        If myRng.Offset(-1, 0).Value = \"GetByName\" Then myField = 2\n        If myRng.Offset(-1, 0).Value = \"GetByStatus\" Then myField = 3\n        If myRng.Offset(-1, 0).Value = \"GetByNumber\" Then myField = 1\n        Exit For\n    End If\nNext myRng\n\n'Clear the dashboard\nlstRow = DshbrdSht.Range(\"A\" &amp; DshbrdSht.Rows.Count).End(xlUp).Row\nFor iLoop = lstRow To 5 Step -1\n    DshbrdSht.Cells(iLoop, 1).EntireRow.Delete\nNext iLoop\n\n'Filter the AllIdeas tab\nIf myField &gt; 0 Then\n    lstRow = IdeaSht.Range(\"A\" &amp; IdeaSht.Rows.Count).End(xlUp).Row\n    lstCol = IdeaSht.Cells(1, IdeaSht.Columns.Count).End(xlToLeft).Column\n    With IdeaSht\n        .Cells.AutoFilter\n        With .Range(IdeaSht.Cells(1, 1), IdeaSht.Cells(lstRow, lstCol))\n            .AutoFilter field:=myField, Criteria1:=FltrVal\n' and display on the dashboard\n            .SpecialCells(xlCellTypeVisible).Copy Destination:=DshbrdSht.Range(\"A5\")\n        End With\n    End With\nEnd If\n\n\nEnd Sub\n</code></pre>\n\n<p>It applies the filters, clears the dashboard, and puts the new filterd data on the dashboard ...</p>\n\n<p><a href=\"https://i.stack.imgur.com/jYlmK.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/jYlmK.png\" alt=\"enter image description here\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/5rVTl.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/5rVTl.png\" alt=\"enter image description here\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/CRYfv.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/CRYfv.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 105, "user_id": 6141287, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4605e092c7dcfd8fe1903da38f1fdd3e?s=128&d=identicon&r=PG", "display_name": "jrichall", "link": "https://stackoverflow.com/users/6141287/jrichall"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3562, "favorite_count": 0, "accepted_answer_id": 36926808, "answer_count": 1, "score": 0, "last_activity_date": 1461884000, "creation_date": 1461793453, "last_edit_date": 1461874072, "question_id": 36901464, "link": "https://stackoverflow.com/questions/36901464/using-a-combobox-and-click-to-filter-data-on-a-separate-sheet-in-excel", "title": "Using a combobox and click to filter data on a separate sheet in Excel", "body": "<p>I've been searching for a few days now, but can't seem to work this out.</p>\n\n<p>I have an excel workbook that houses a list of \"ideas\" from an Access database. The Table is connected in Read-Only mode (definitely don't want Excel writing back to Access!) on excel sheet \"AllIdeas\" </p>\n\n<p>A few notes: The sheet \"AllIdeas\" will initially be hidden. The VBA Macros will unhide and filter it.</p>\n\n<p>I have a Sheet titled \"Dashboard\" where I want the following functionality:</p>\n\n<ol>\n<li>(Not Working) Idea Owners can use a ComboBox and Click a \"Button\" (In this case, it's a rounded rectangle that I'll assign a macro to) to filter the information on \"AllIdeas\" to only show the ideas assigned to them.</li>\n<li>(Not Working) I want another ComboBox listing the \"Status\" of the Ideas (Open, Declined, Implemented, etc) along with a clickable rounded rectangle. The Macro for this rectangle needs to pull only the ideas for the Idea Owner (identified in combobox1) and the status (identified in combobox2). This second \"button\" macro would not run without both the Idea Owner and the Status selected.</li>\n<li>(Working) Users can enter an idea number and have the information pop up on the dashboard. This is useful if they know an idea number, but need the details.</li>\n<li>(Working) At the bottom of the Dashboard there is another rounded rectangle with a macro assigned that unhides the \"AllIdeas\" sheet and displays the entire table.</li>\n<li>(Working)On the \"AllIdeas\" sheet there is a button labeled \"Click Here to Return to Dashboard\". This Macro returns the user to the dashboard and hides the \"AllIdeas\" sheet.</li>\n</ol>\n\n<p>Here is some of what I have. I apologize in advance for how messy this may be...this is my first venture into VBA:</p>\n\n<pre><code>    Sub AllIdeasBtn()\nWorksheets(\"AllIdeas\").Visible = xlSheetVisible\nWorksheets(\"AllIdeas\").Activate\nIf Worksheets(\"AllIdeas\").AutoFilterMode Then          Worksheets(\"AllIdeas\").ShowAllData\nEnd Sub\n\nSub Back()\nActiveSheet.Visible = False\nSheets(\"Dashboard\").Select\nSheets(\"AllIdeas\").Visible = False\n\n\nEnd Sub\n</code></pre>\n\n<p>I am completely stuck on how to use my comboBoxes along with a click macro to unhide the AllIdeas Sheet and filter it by the selections in the combo boxes.\n<a href=\"http://i.stack.imgur.com/VWZfp.png\" rel=\"nofollow\">AllIdeas Example</a></p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 1, "creation_date": 1461792545, "post_id": 36901235, "comment_id": 61366594, "body": "So don&#39;t keep doing <code>Rows(&quot;5:5&quot;).Select</code>?"}, {"owner": {"reputation": 286, "user_id": 5261233, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/i5rHw.jpg?s=128&g=1", "display_name": "Histerical", "link": "https://stackoverflow.com/users/5261233/histerical"}, "edited": false, "score": 0, "creation_date": 1461792604, "post_id": 36901235, "comment_id": 61366618, "body": "Is it always the same columns that are being used? Also will you be selecting the entire row when running, or just a specific cell?"}], "answers": [{"tags": [], "owner": {"reputation": 286, "user_id": 5261233, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/i5rHw.jpg?s=128&g=1", "display_name": "Histerical", "link": "https://stackoverflow.com/users/5261233/histerical"}, "is_accepted": false, "score": 1, "last_activity_date": 1461793634, "creation_date": 1461793634, "answer_id": 36901516, "question_id": 36901235, "link": "https://stackoverflow.com/questions/36901235/getting-a-macro-to-operate-in-selected-range/36901516#36901516", "title": "Getting a Macro to Operate in Selected Range", "body": "<p>I created a quick bit of your code to do what you are asking on any row, you just have to be clicked in any cell of the row you want it to run on. I wouldn't recommend this code, as it is rather sloppy and has a lot of duplicate code, but it works. I would work on learning what it is doing and get rid of any extra code. </p>\n\n<p>I also got rid of almost all the select statements as they slow down your code, instead of selecting a cell and then setting the formula, you just put that in one line as I did with your code.</p>\n\n<p>Good luck learning VBA, it's fun and you have plenty of knowledgeable people on this site for you to get assistance.</p>\n\n<pre><code>Sub OrschelnMacro()\n'\n' OrschelnMacro Macro\n'\n' Keyboard Shortcut: Ctrl+p\n'\ncurRow = Selection.Row\nSelection.EntireRow.Insert Shift:=xlDown, CopyOrigin:=xlFormatFromLeftOrAbove\nRange(\"E\" &amp; curRow).FormulaR1C1 = \"=SUM(R[-2]C:R[-1]C)\"\nRange(\"G\" &amp; curRow).FormulaR1C1 = \"=SUM(R[-2]C:R[-1]C)\"\nRange(\"H\" &amp; curRow).FormulaR1C1 = \"1\"\nRange(\"F\" &amp; curRow).FormulaR1C1 = \"1 of 1\"\nRows(curRow).RowHeight = 75\nWith Rows(curRow).Interior\n    .Pattern = xlSolid\n    .PatternColorIndex = xlAutomatic\n    .Color = 65535\n    .TintAndShade = 0\n    .PatternTintAndShade = 0\nEnd With\nWith Rows(curRow).Font\n    .Name = \"Calibri\"\n    .Size = 26\n    .Bold = True\n    .Strikethrough = False\n    .Superscript = False\n    .Subscript = False\n    .OutlineFont = False\n    .Shadow = False\n    .Underline = xlUnderlineStyleNone\n    .ColorIndex = xlAutomatic\n    .TintAndShade = 0\n    .ThemeFont = xlThemeFontMinor\nEnd With\nRange(\"H\" &amp; curRow).Select\nWith Range(\"H\" &amp; curRow).Font\n    .Name = \"Calibri\"\n    .Size = 72\n    .Strikethrough = False\n    .Superscript = False\n    .Subscript = False\n    .OutlineFont = False\n    .Shadow = False\n    .Underline = xlUnderlineStyleNone\n    .ColorIndex = xlAutomatic\n    .TintAndShade = 0\n    .ThemeFont = xlThemeFontMinor\nEnd With\nWith Range(\"H\" &amp; curRow)\n    .HorizontalAlignment = xlGeneral\n    .VerticalAlignment = xlTop\n    .WrapText = False\n    .Orientation = 0\n    .AddIndent = False\n    .IndentLevel = 0\n    .ShrinkToFit = False\n    .ReadingOrder = xlContext\n    .MergeCells = False\nEnd With\nWith Range(\"E\" &amp; curRow &amp; \":G\" &amp; curRow)\n    .VerticalAlignment = xlTop\n    .WrapText = False\n    .Orientation = 0\n    .AddIndent = False\n    .IndentLevel = 0\n    .ShrinkToFit = False\n    .ReadingOrder = xlContext\n    .MergeCells = False\nEnd With\nWith Range(\"H\" &amp; curRow)\n    .HorizontalAlignment = xlCenter\n    .VerticalAlignment = xlTop\n    .WrapText = False\n    .Orientation = 0\n    .AddIndent = False\n    .IndentLevel = 0\n    .ShrinkToFit = False\n    .ReadingOrder = xlContext\n    .MergeCells = False\nEnd With\nRange(\"A\" &amp; curRow &amp; \":H\" &amp; curRow).Borders(xlDiagonalDown).LineStyle = xlNone\nRange(\"A\" &amp; curRow &amp; \":H\" &amp; curRow).Borders(xlDiagonalUp).LineStyle = xlNone\nWith Range(\"A\" &amp; curRow &amp; \":H\" &amp; curRow).Borders(xlEdgeLeft)\n    .LineStyle = xlContinuous\n    .ColorIndex = 0\n    .TintAndShade = 0\n    .Weight = xlMedium\nEnd With\nWith Range(\"A\" &amp; curRow &amp; \":H\" &amp; curRow).Borders(xlEdgeTop)\n    .LineStyle = xlContinuous\n    .ColorIndex = 0\n    .TintAndShade = 0\n    .Weight = xlMedium\nEnd With\nWith Range(\"A\" &amp; curRow &amp; \":H\" &amp; curRow).Borders(xlEdgeBottom)\n    .LineStyle = xlContinuous\n    .ColorIndex = 0\n    .TintAndShade = 0\n    .Weight = xlMedium\nEnd With\nWith Range(\"A\" &amp; curRow &amp; \":H\" &amp; curRow).Borders(xlEdgeRight)\n    .LineStyle = xlContinuous\n    .ColorIndex = 0\n    .TintAndShade = 0\n    .Weight = xlMedium\nEnd With\nRange(\"A\" &amp; curRow &amp; \":H\" &amp; curRow).Borders(xlInsideVertical).LineStyle = xlNone\nRange(\"A\" &amp; curRow &amp; \":H\" &amp; curRow).Borders(xlInsideHorizontal).LineStyle = xlNone\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "is_accepted": false, "score": 1, "last_activity_date": 1461796495, "creation_date": 1461796495, "answer_id": 36902143, "question_id": 36901235, "link": "https://stackoverflow.com/questions/36901235/getting-a-macro-to-operate-in-selected-range/36902143#36902143", "title": "Getting a Macro to Operate in Selected Range", "body": "<p>Replace this:</p>\n\n<pre><code>Rows(\"5:5\").Select\nSelection.Insert Shift:=xlDown, CopyOrigin:=xlFormatFromLeftOrAbove\nRange(\"E5\").Select\nActiveCell.FormulaR1C1 = \"=SUM(R[-2]C:R[-1]C)\"\nRange(\"G5\").Select\nActiveCell.FormulaR1C1 = \"=SUM(R[-2]C:R[-1]C)\"\nRange(\"H5\").Select\nActiveCell.FormulaR1C1 = \"1\"\nRange(\"F5\").Select\nActiveCell.FormulaR1C1 = \"1 of 1\"\nRows(\"5:5\").Select\nSelection.RowHeight = 75\n</code></pre>\n\n<p>with</p>\n\n<pre><code>Dim myRow As Long    \n\nmyRow = Selection.Row\n\nRows(myRow).Insert\nRange(\"E\" &amp; myRow &amp; \":H\" &amp; myRow).FormulaR1C1 = _\n    Array(\"=SUM(R[-2]C:R[-1]C)\", \"1 of 1\", \"=SUM(R[-2]C:R[-1]C)\", \"1\")\n\nRows(myRow).RowHeight = 75\n</code></pre>\n\n<p>I won't get into all the formatting code as it's not really what your question is about - the point is that you can use a variable to get the <code>.Row</code> property and use that in your code.</p>\n"}], "owner": {"reputation": 11, "user_id": 6263702, "user_type": "registered", "profile_image": "https://graph.facebook.com/1208828702463684/picture?type=large", "display_name": "Courtney Cascante", "link": "https://stackoverflow.com/users/6263702/courtney-cascante"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 126, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1461815123, "creation_date": 1461792431, "last_edit_date": 1461815123, "question_id": 36901235, "link": "https://stackoverflow.com/questions/36901235/getting-a-macro-to-operate-in-selected-range", "title": "Getting a Macro to Operate in Selected Range", "body": "<p>I created the perfect macro but of course as all macro's do it's standard - only working in the exact rows it was recorded in.  I need it to work in any row I highlight and I've tried a variety of custom coding.  I can't get it to do anything but the same formula and formatting on top of the same area.  Always row 5.  This is the code...</p>\n\n<pre><code>Sub OrschelnMacro()\n'\n' OrschelnMacro Macro\n'\n' Keyboard Shortcut: Ctrl+p\n'\n    Rows(\"5:5\").Select\n    Selection.Insert Shift:=xlDown, CopyOrigin:=xlFormatFromLeftOrAbove\n    Range(\"E5\").Select\n    ActiveCell.FormulaR1C1 = \"=SUM(R[-2]C:R[-1]C)\"\n    Range(\"G5\").Select\n    ActiveCell.FormulaR1C1 = \"=SUM(R[-2]C:R[-1]C)\"\n    Range(\"H5\").Select\n    ActiveCell.FormulaR1C1 = \"1\"\n    Range(\"F5\").Select\n    ActiveCell.FormulaR1C1 = \"1 of 1\"\n    Rows(\"5:5\").Select\n    Selection.RowHeight = 75\n    With Selection.Interior\n        .Pattern = xlSolid\n        .PatternColorIndex = xlAutomatic\n        .Color = 65535\n        .TintAndShade = 0\n        .PatternTintAndShade = 0\n    End With\n    With Selection.Font\n        .Name = \"Calibri\"\n        .Strikethrough = False\n        .Superscript = False\n        .Subscript = False\n        .OutlineFont = False\n        .Shadow = False\n        .Underline = xlUnderlineStyleNone\n        .ColorIndex = xlAutomatic\n        .TintAndShade = 0\n        .ThemeFont = xlThemeFontMinor\n    End With\n    With Selection.Font\n        .Name = \"Calibri\"\n        .Size = 26\n        .Strikethrough = False\n        .Superscript = False\n        .Subscript = False\n        .OutlineFont = False\n        .Shadow = False\n        .Underline = xlUnderlineStyleNone\n        .ColorIndex = xlAutomatic\n        .TintAndShade = 0\n        .ThemeFont = xlThemeFontMinor\n    End With\n    Selection.Font.Bold = True\n    Range(\"H5\").Select\n    With Selection.Font\n        .Name = \"Calibri\"\n        .Size = 72\n        .Strikethrough = False\n        .Superscript = False\n        .Subscript = False\n        .OutlineFont = False\n        .Shadow = False\n        .Underline = xlUnderlineStyleNone\n        .ColorIndex = xlAutomatic\n        .TintAndShade = 0\n        .ThemeFont = xlThemeFontMinor\n    End With\n    With Selection\n        .HorizontalAlignment = xlGeneral\n        .VerticalAlignment = xlTop\n        .WrapText = False\n        .Orientation = 0\n        .AddIndent = False\n        .IndentLevel = 0\n        .ShrinkToFit = False\n        .ReadingOrder = xlContext\n        .MergeCells = False\n    End With\n    Range(\"E5:G5\").Select\n    With Selection\n        .VerticalAlignment = xlTop\n        .WrapText = False\n        .Orientation = 0\n        .AddIndent = False\n        .IndentLevel = 0\n        .ShrinkToFit = False\n        .ReadingOrder = xlContext\n        .MergeCells = False\n    End With\n    Range(\"H5\").Select\n    With Selection\n        .HorizontalAlignment = xlCenter\n        .VerticalAlignment = xlTop\n        .WrapText = False\n        .Orientation = 0\n        .AddIndent = False\n        .IndentLevel = 0\n        .ShrinkToFit = False\n        .ReadingOrder = xlContext\n        .MergeCells = False\n    End With\n    Range(\"A5:H5\").Select\n    Selection.Borders(xlDiagonalDown).LineStyle = xlNone\n    Selection.Borders(xlDiagonalUp).LineStyle = xlNone\n    With Selection.Borders(xlEdgeLeft)\n        .LineStyle = xlContinuous\n        .ColorIndex = 0\n        .TintAndShade = 0\n        .Weight = xlMedium\n    End With\n    With Selection.Borders(xlEdgeTop)\n        .LineStyle = xlContinuous\n        .ColorIndex = 0\n        .TintAndShade = 0\n        .Weight = xlMedium\n    End With\n    With Selection.Borders(xlEdgeBottom)\n        .LineStyle = xlContinuous\n        .ColorIndex = 0\n        .TintAndShade = 0\n        .Weight = xlMedium\n    End With\n    With Selection.Borders(xlEdgeRight)\n        .LineStyle = xlContinuous\n        .ColorIndex = 0\n        .TintAndShade = 0\n        .Weight = xlMedium\n    End With\n    Selection.Borders(xlInsideVertical).LineStyle = xlNone\n    Selection.Borders(xlInsideHorizontal).LineStyle = xlNone\n    Range(\"K7\").Select\nEnd Sub\n</code></pre>\n\n<p>Does anyone have any ideas?  Thank you so much in advance...</p>\n"}, {"tags": ["excel", "vba", "copy-paste"], "comments": [{"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1461791938, "post_id": 36901065, "comment_id": 61366298, "body": "You need a <code>paste:=</code> Edit: or you <a href=\"https://msdn.microsoft.com/en-us/library/office/ff839476.aspx\" rel=\"nofollow noreferrer\">need</a> <code>(</code>?"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1461791939, "post_id": 36901065, "comment_id": 61366300, "body": "Make the paste special two lines not one."}, {"owner": {"reputation": 27, "user_id": 6237673, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/1301750139838330/picture?type=large", "display_name": "James Page", "link": "https://stackoverflow.com/users/6237673/james-page"}, "edited": false, "score": 0, "creation_date": 1461792156, "post_id": 36901065, "comment_id": 61366406, "body": "Does it matter that the paste is happening in a new workbook?  Not sure what you mean by make it 2 lines, or where to put paste:= in my existing code.  I am complete noob sorry :("}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1461792252, "post_id": 36901065, "comment_id": 61366458, "body": "<code>paste is happening in a new workbook</code> yea, that matters. I hope you have a <code>with</code> that qualifies the desired book that you left out. Also, see my link to see where to put <code>paste:=</code> Edit: if you just want values, set the ranges to each other."}, {"owner": {"reputation": 27, "user_id": 6237673, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/1301750139838330/picture?type=large", "display_name": "James Page", "link": "https://stackoverflow.com/users/6237673/james-page"}, "edited": false, "score": 0, "creation_date": 1461792337, "post_id": 36901065, "comment_id": 61366491, "body": "I added the full code snippet"}, {"owner": {"reputation": 27, "user_id": 6237673, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/1301750139838330/picture?type=large", "display_name": "James Page", "link": "https://stackoverflow.com/users/6237673/james-page"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1461792627, "post_id": 36901065, "comment_id": 61366631, "body": "@findwindow where would I insert the paste:= ?"}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1461792672, "post_id": 36901065, "comment_id": 61366657, "body": "Er, as I said, check the link. But that&#39;s not your only problem. @jeeped caught something crucial below."}], "answers": [{"comments": [{"owner": {"reputation": 27, "user_id": 6237673, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/1301750139838330/picture?type=large", "display_name": "James Page", "link": "https://stackoverflow.com/users/6237673/james-page"}, "edited": false, "score": 0, "creation_date": 1461792532, "post_id": 36901210, "comment_id": 61366585, "body": "yeah the first line of code works fine if I remove the paste special line....not sure what you mean with this one"}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 1, "creation_date": 1461792599, "post_id": 36901210, "comment_id": 61366616, "body": "Jeeped is saying, you need to qualify <i>all</i> ranges."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 27, "user_id": 6237673, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/1301750139838330/picture?type=large", "display_name": "James Page", "link": "https://stackoverflow.com/users/6237673/james-page"}, "edited": false, "score": 0, "creation_date": 1461792704, "post_id": 36901210, "comment_id": 61366673, "body": "@JamesPage - See above for a more complete rewrite from the additional code you updated with."}, {"owner": {"reputation": 27, "user_id": 6237673, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/1301750139838330/picture?type=large", "display_name": "James Page", "link": "https://stackoverflow.com/users/6237673/james-page"}, "edited": false, "score": 0, "creation_date": 1461792947, "post_id": 36901210, "comment_id": 61366776, "body": "Was just trying it and had an extra END IF in there haha, i see you updated.  Trying momentarily"}, {"owner": {"reputation": 27, "user_id": 6237673, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/1301750139838330/picture?type=large", "display_name": "James Page", "link": "https://stackoverflow.com/users/6237673/james-page"}, "edited": false, "score": 0, "creation_date": 1461793167, "post_id": 36901210, "comment_id": 61366877, "body": "@jeeped Awesome man!!!!!!!  not sure I understand fully what you&#39;ve done or why there is a resize function in there but YAY!   Only 1 hiccup, it automatically added formatting to column B in new wb.  It somehow kept the formatting from original copy even though we specified values only?  It formats column B as currency"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1461793430, "post_id": 36901210, "comment_id": 61367011, "body": "Always explicitly supply a parent to cells, ranes and the cells/ranges that define them. I&#39;ve use a with end with and prefaced everything with a <code>.</code>. The resize gis necessary because direct values transfer requires the destination be the same size as the source. The additional with/end with allows us to use <code>.Rows.Count</code> which is the rows within the source. If you want raw values then use <code>.Value2</code>, the <code>.Value</code> can carry regional information in dates and currency values."}, {"owner": {"reputation": 27, "user_id": 6237673, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/1301750139838330/picture?type=large", "display_name": "James Page", "link": "https://stackoverflow.com/users/6237673/james-page"}, "edited": false, "score": 0, "creation_date": 1461794009, "post_id": 36901210, "comment_id": 61367277, "body": "Thanks for the detailed description of the code.  Value2 did the trick....Thank you so much!"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 1, "last_activity_date": 1461792635, "last_edit_date": 1461792635, "creation_date": 1461792346, "answer_id": 36901210, "question_id": 36901065, "link": "https://stackoverflow.com/questions/36901065/syntax-error-on-paste-special-from-thisworkbook-to-new-workbook/36901210#36901210", "title": "Syntax error on Paste Special from ThisWorkbook to new workbook", "body": "<p><code>Range(\"A4\")</code> and <code>Range(\"A4\").End(xlDown)</code> may not belong to <code>ThisWorkbook.Sheets(1)</code> and you cannot define a range using cells from another worksheet.</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n    Dim nwb As Workbook\n\n    Set nwb = Workbooks.Add\n\n    With ThisWorkbook.Sheets(1)\n        .Range(.Range(\"A4\"), .Range(\"A4\").End(xlDown)).Copy _\n            Destination:=nwb.Sheets(1).Range(\"A1\")\n        With .Range(.Range(\"G4\"), .Range(\"G4\").End(xlDown))\n            nwb.Sheets(1).Range(\"B1\").Resize(.Rows.Count, 1) = .Value\n        End With\n    End With\n\n    With nwb\n        Application.DisplayAlerts = False\n        .SaveAs \"C:\\Users\\my username\\Desktop\\Macro Demo\\output.xlsx\"\n        Application.DisplayAlerts = True\n        .Close\n    End With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 27, "user_id": 6237673, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/1301750139838330/picture?type=large", "display_name": "James Page", "link": "https://stackoverflow.com/users/6237673/james-page"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 169, "favorite_count": 0, "accepted_answer_id": 36901210, "answer_count": 1, "score": 1, "last_activity_date": 1518381541, "creation_date": 1461791853, "last_edit_date": 1518381541, "question_id": 36901065, "link": "https://stackoverflow.com/questions/36901065/syntax-error-on-paste-special-from-thisworkbook-to-new-workbook", "title": "Syntax error on Paste Special from ThisWorkbook to new workbook", "body": "<p>First line of code works fine, second errors out with a syntax error. I want it to do the same thing as first line except paste values only.</p>\n\n<pre><code>ThisWorkbook.Sheets(1).Range(Range(\"A4\"), Range(\"A4\").End(xlDown)).Copy .Sheets(1).Range(\"A1\")\nThisWorkbook.Sheets(1).Range(Range(\"G4\"), Range(\"G4\").End(xlDown)).Copy .Sheets(1).Range(\"B1\").PasteSpecial xlPasteValues\n</code></pre>\n\n<p>Full code for the sub</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n    With Workbooks.Add\n        ThisWorkbook.Sheets(1).Range(Range(\"A4\"), Range(\"A4\").End(xlDown)).Copy .Sheets(1).Range(\"A1\")\n        ThisWorkbook.Sheets(1).Range(Range(\"G4\"), Range(\"G4\").End(xlDown)).Copy .Sheets(1).Range(\"B1\").PasteSpecial xlPasteValues\n\n        Application.DisplayAlerts = False\n        .SaveAs \"C:\\Users\\my username\\Desktop\\Macro Demo\\output.xlsx\"\n        Application.DisplayAlerts = True\n        .Close\n    End With\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "sqlite", "odbc"], "comments": [{"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1461793507, "post_id": 36900792, "comment_id": 61367053, "body": "Why don&#39;t you use the first method and change the command to <code>adoCmd.CommandText = &quot;SELECT * FROM TableName WHERE X = &quot; &amp; Worksheets(1).Range(&quot;RangeForParameter&quot;).Value2</code>? That should work. Why do you say that the first isn&#39;t working? What do you mean by that?"}, {"owner": {"reputation": 73863, "user_id": 3358272, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/gteVQ.jpg?s=128&g=1", "display_name": "r2evans", "link": "https://stackoverflow.com/users/3358272/r2evans"}, "reply_to_user": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1461793672, "post_id": 36900792, "comment_id": 61367130, "body": "Primarily because that&#39;s not parameterization. Though I think it&#39;s unlikely that a user will enter into a cell <code>5;DROP TABLE users;</code>, I also believe it will be faster and more sustainable in the long haul."}, {"owner": {"reputation": 73863, "user_id": 3358272, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/gteVQ.jpg?s=128&g=1", "display_name": "r2evans", "link": "https://stackoverflow.com/users/3358272/r2evans"}, "reply_to_user": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1461793730, "post_id": 36900792, "comment_id": 61367166, "body": "I say the first method isn&#39;t working because it errs with &quot;Error 1004: invalid accessor flag&quot;. It&#39;s a vague error with no clear indication of a remedy."}, {"owner": {"reputation": 748, "user_id": 6209872, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d51589c2d23ee66dc43c65c410bbf70c?s=128&d=identicon&r=PG&f=1", "display_name": "yk11", "link": "https://stackoverflow.com/users/6209872/yk11"}, "edited": false, "score": 0, "creation_date": 1461803671, "post_id": 36900792, "comment_id": 61370362, "body": "<code>Set adoParam = adoCmd.CreateParameter(, adVarChar, adParamInput, _         Len(rCell.value), rCell.value</code> is missing a closing paren <code>)</code>"}, {"owner": {"reputation": 73863, "user_id": 3358272, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/gteVQ.jpg?s=128&g=1", "display_name": "r2evans", "link": "https://stackoverflow.com/users/3358272/r2evans"}, "edited": false, "score": 0, "creation_date": 1461803776, "post_id": 36900792, "comment_id": 61370392, "body": "Thanks ... that wasn&#39;t causing my problem (IDE would be clear about that mistake), but I obviously made a copy/paste mistake."}, {"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1461804999, "post_id": 36900792, "comment_id": 61370680, "body": "Curious, why chose SQLlite when Excel if using PC already has an installed SQL engine called Jet/ACE a pre-built Windows .dll and the default engine of MS Access, a file-level RDMS like SQLlite which PC users can use without full Access exe GUI program!"}, {"owner": {"reputation": 73863, "user_id": 3358272, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/gteVQ.jpg?s=128&g=1", "display_name": "r2evans", "link": "https://stackoverflow.com/users/3358272/r2evans"}, "edited": false, "score": 0, "creation_date": 1461806760, "post_id": 36900792, "comment_id": 61371134, "body": "Good question. The accdb format isn&#39;t supported by the tools generating the database, and the MDB file is literally over 10x the size of the sqlite3 file. I&#39;ll ask on other channels on getting accdb to work, hoping that it is much better at file size than MDB."}, {"owner": {"reputation": 73863, "user_id": 3358272, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/gteVQ.jpg?s=128&g=1", "display_name": "r2evans", "link": "https://stackoverflow.com/users/3358272/r2evans"}, "reply_to_user": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1461808780, "post_id": 36900792, "comment_id": 61371650, "body": "Update: found one method for using accdb files, and though I have not verified all the data yet, it&#39;s only 25% larger than sqlite3, so the size may be acceptable for the interface cleanliness. Thanks for the suggestion, @Parfait."}], "answers": [{"comments": [{"owner": {"reputation": 73863, "user_id": 3358272, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/gteVQ.jpg?s=128&g=1", "display_name": "r2evans", "link": "https://stackoverflow.com/users/3358272/r2evans"}, "edited": false, "score": 0, "creation_date": 1461809030, "post_id": 36903982, "comment_id": 61371726, "body": "At one point I was having problems that switching to <code>adOpenStatic</code> (for <code>Recordset.Open</code>) solved, and I couldn&#39;t figure out how to specify that option with <code>.Execute</code>. I&#39;ll give this a try again, thanks for the help!"}, {"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "reply_to_user": {"reputation": 73863, "user_id": 3358272, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/gteVQ.jpg?s=128&g=1", "display_name": "r2evans", "link": "https://stackoverflow.com/users/3358272/r2evans"}, "edited": false, "score": 0, "creation_date": 1461810003, "post_id": 36903982, "comment_id": 61371978, "body": "Indeed. Just tested on a MySQL connection. Also please check your connection string as you currently have Provider, Driver, and DSN together when it should be one of the three with data source (i.e., file) and any options (ODBC/DSNs can be checked in odbcad32.exe)."}, {"owner": {"reputation": 73863, "user_id": 3358272, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/gteVQ.jpg?s=128&g=1", "display_name": "r2evans", "link": "https://stackoverflow.com/users/3358272/r2evans"}, "edited": false, "score": 0, "creation_date": 1461810242, "post_id": 36903982, "comment_id": 61372024, "body": "I thought that, too, but during troubleshooting (lots of that going on) I grabbed the connection string excel was using internally. Overkill, perhaps, but once I got it working, reducing it became a low priority."}], "tags": [], "owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "is_accepted": true, "score": 1, "last_activity_date": 1461809764, "last_edit_date": 1461809764, "creation_date": 1461808939, "answer_id": 36903982, "question_id": 36900792, "link": "https://stackoverflow.com/questions/36900792/parameterized-queries-in-excel-with-sqlite-odbc/36903982#36903982", "title": "parameterized queries in Excel with SQLite ODBC", "body": "<p>Rather than <a href=\"https://msdn.microsoft.com/en-us/library/ms675544%28v=vs.85%29.aspx\" rel=\"nofollow\">opening recordset</a> via an ADO connection, you need to execute the command from <a href=\"https://msdn.microsoft.com/en-us/library/ms681559%28v=vs.85%29.aspx\" rel=\"nofollow\">ADO command</a> object. This an often discussed topic of <em>recordset .execute vs .open</em>. Of course, be sure to add error handling to capture relevant errors/exceptions.</p>\n\n<pre><code>Sub UpdateTables()\nOn Error GoTo ErrHandle\n    Dim ws as Worksheet\n    Dim adoCN As New ADODB.Connection, adoRS As New ADODB.Recordset\n    Dim adoCmd As New ADODB.Command    \n    Dim sDB as String\n    Dim rCell as Range\n\n    'Set ws = ... '\n    'sDB = ... '\n\n    ' DATABASE CONNECTION '   \n    adoCN.Open \"Provider=MSDASQL.1;Persist Security Info=True;\" _\n                  &amp; \"Driver={SQLite3 ODBC Driver};\" _\n                  &amp; \"Database=\" &amp; sDB &amp; \";\" _\n                  &amp; \"DSN=SQLite3 Datasource;LongNames=true;fksupport=true\", \"\", \"\" \n\n    ' ADO COMMAND '\n    With adoCmd\n        .ActiveConnection = adoCN\n        .CommandText = \"SELECT * FROM TableName WHERE X = ?\"\n        .CommandType = adCmdText\n        .Parameters.Append .CreateParameter(, adVarChar, adParamInput, _\n                                            Len(rCell.value), rCell.value)\n    End With\n\n    ' EXECUTE RECORDSET '\n    Set adoRS = adoCmd.Execute\n\n    ' DEFINE QUERYTABLE '\n    With ws.ListObjects(1).QueryTable\n        Set .RecordSet = adoRS\n        .Refresh\n    End With\n\n    ' CLOSE AND FREE RESOURCES '\n    adoRS.Close: adoCN.Close\n    Set adoRS = Nothing: Set adoCmd = Nothing: Set adoCN = Nothing    \n    Exit Sub\n\nErrHandle:\n    MsgBox Err.Number &amp; \" - \" &amp; Err.Description\n    Set adoRS = Nothing: Set adCmd = Nothing: Set adCN = Nothing    \n    Exit Sub    \nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 73863, "user_id": 3358272, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/gteVQ.jpg?s=128&g=1", "display_name": "r2evans", "link": "https://stackoverflow.com/users/3358272/r2evans"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1013, "favorite_count": 0, "accepted_answer_id": 36903982, "answer_count": 1, "score": 0, "last_activity_date": 1461809764, "creation_date": 1461790817, "last_edit_date": 1461803731, "question_id": 36900792, "link": "https://stackoverflow.com/questions/36900792/parameterized-queries-in-excel-with-sqlite-odbc", "title": "parameterized queries in Excel with SQLite ODBC", "body": "<p>I'm using the <a href=\"http://www.ch-werner.de/sqliteodbc/\" rel=\"nofollow\">SQLite ODBC Driver</a> v0.9993 in Excel 2016 (win10). The main impetus for using an external source is that I have too much data for Excel to sanely manage, so it will be pulled based on user-selected criteria. Because of this, I'd like to use parameterized queries based on the contents of well-defined worksheet cells.</p>\n\n<p>I'm trying two methods:</p>\n\n<ol>\n<li><p>Straight VBA, where I do something like this (rough code):</p>\n\n<pre><code>Sub UpdateTables()\n    Dim ws as Worksheet\n    Dim adoCN As ADODB.Connection\n    Dim adoCmd As ADODB.Command\n    Dim adoRS As ADODB.Recordset\n    Dim sDB as String\n    Dim rCell as Range\n    Set adoCN = New ADODB.Connection\n    Set adoRS = New ADODB.Recordset\n    ' ws is set to correct worksheet\n    ' ...\n    ' define sDB from worksheet cell\n    With adoCN\n        .Open \"Provider=MSDASQL.1;Persist Security Info=True;\" _\n            &amp; \"Driver={SQLite3 ODBC Driver};\" _\n            &amp; \"Database=\" &amp; sDB &amp; \";\" _\n            &amp; \"DSN=SQLite3 Datasource;LongNames=true;fksupport=true\", \"\", \"\" '\n    End With\n    Set adoCmd = New ADODB.Command\n    adoCmd.ActiveConnection = adoCN\n    ' rCell points to cell containing query parameter\n    Set adoParam = adoCmd.CreateParameter(, adVarChar, adParamInput, _\n        Len(rCell.value), rCell.value)\n    adoCmd.Parameters.Append adoParam\n    adoCmd.CommandText = \"SELECT * FROM TableName WHERE X = ?\"\n    adoRS.Open Source:=adoCmd, CursorType:=adOpenKeyset\n    With ws.ListObjects(1).QueryTable\n        Set .RecordSet = adoRS\n        .Refresh ' errors with \"Error 1004: invalid accessor flag\"\n    End With\nEnd Sub\n</code></pre>\n\n<p>(Code has been simplified, generally I include sanity checks.)</p></li>\n<li><p>GUI-based in Excel, with <em>New Query</em> > <em>From Other Sources</em> > <em>From ODBC</em>, set DSN to \"SQLite3 Datasource\", and enter in the Connection string used above.</p>\n\n<p>Unfortunately, the \"Parameters\" button (<em>Connections</em> > <em>select query</em> > <em>Properties</em> > <em>Definition</em> tab) is grayed out.</p></li>\n</ol>\n\n<p>I think I prefer the second solution, but neither is working at the moment.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1461789474, "post_id": 36900342, "comment_id": 61364973, "body": "Hmm this has been asked numerous times on SO. Not sure if it was ever answered fully..."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1461793196, "post_id": 36900342, "comment_id": 61366890, "body": "You will need to use the Range.Find method to find the correct row then iterate through the columns testing the values.  If all are equal then use the value."}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1461793314, "post_id": 36900342, "comment_id": 61366958, "body": "@ScottCraner is that really best architecture? I am with Karl below. Wouldn&#39;t it be easier to concat everything then compare? Edit: hmm I guess to concat, you still have to loop columns XD Otherwise, it&#39;s an array then you&#39;d have to loop array which I guess is technically faster but not easier XD"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1461793553, "post_id": 36900342, "comment_id": 61367073, "body": "@findwindow either way if the rows do not line up then loops are involved, either find the correct row first or loop twice trough an array, which now that I think of it may be faster."}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1461793675, "post_id": 36900342, "comment_id": 61367131, "body": "Not sure what you mean by finding correct row. We need to test all rows? But yea, loops are unavoidable."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 1, "creation_date": 1461793768, "post_id": 36900342, "comment_id": 61367178, "body": "@findwindow Range.Find and Range.FindNext will loop through only those rows that the SKUs match, thus cutting out many unneeded loops."}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1461793843, "post_id": 36900342, "comment_id": 61367204, "body": "I must&#39;ve misunderstood the question."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1461794160, "post_id": 36900342, "comment_id": 61367337, "body": "I don&#39;t think it is a one for one placement, as in I do not think the rows are in order.  If so then yes loading the whole into an array and looping through each row and each column would be the quickest. @findwindow"}, {"owner": {"reputation": 742, "user_id": 5596937, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/1fAS1.jpg?s=128&g=1", "display_name": "Iron Man", "link": "https://stackoverflow.com/users/5596937/iron-man"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1461794356, "post_id": 36900342, "comment_id": 61367433, "body": "@findwindow I have updated the question with information that I hope clarifies what I need. All I really need to do is update the data in column O where all the data in the rest of the row matches between each workbook. If column ) in workbook 2 is &gt;0 and column O in workbook 1 &lt;&gt; column O of workbook 2, then the value in workbook 2 column O needs to be copied to Column O in workbook 1."}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1461794468, "post_id": 36900342, "comment_id": 61367489, "body": "Ok, that&#39;s my understanding. So yea, I would array each row and loop that for the test."}, {"owner": {"reputation": 742, "user_id": 5596937, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/1fAS1.jpg?s=128&g=1", "display_name": "Iron Man", "link": "https://stackoverflow.com/users/5596937/iron-man"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1461794478, "post_id": 36900342, "comment_id": 61367498, "body": "@ScottCraner You are correct, the rows will not always match up in their order between the 2 workbooks, that is what makes this tricky. Otherwise, I would just manually copy and paste. The number of rows is always growing."}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1461794525, "post_id": 36900342, "comment_id": 61367520, "body": "Ooooohhh. Now I get it. Edit: yea, so do what Scott says."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 2, "creation_date": 1461794615, "post_id": 36900342, "comment_id": 61367555, "body": "I foresee lots of loops in your future.  That is as far as my crystal ball will take me today."}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1461794954, "post_id": 36900342, "comment_id": 61367697, "body": "What about my future?? @ScottCraner"}, {"owner": {"reputation": 742, "user_id": 5596937, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/1fAS1.jpg?s=128&g=1", "display_name": "Iron Man", "link": "https://stackoverflow.com/users/5596937/iron-man"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1461795323, "post_id": 36900342, "comment_id": 61367844, "body": "@ScottCraner Great! More loops. Great! More loops. Great! More loops. Great! More loops. Great! More loops. Great! More loops. Great! More loops. Great! More loops. Great! More loops."}], "answers": [{"comments": [{"owner": {"reputation": 742, "user_id": 5596937, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/1fAS1.jpg?s=128&g=1", "display_name": "Iron Man", "link": "https://stackoverflow.com/users/5596937/iron-man"}, "edited": false, "score": 0, "creation_date": 1461792090, "post_id": 36901026, "comment_id": 61366378, "body": "As pointed out in the question, I know where the difference is and need to copy that difference from workbook 2 to workbook B, but only if all other columns in that row match."}, {"owner": {"reputation": 312, "user_id": 5376832, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/131cf551898d23800289731848abedbc?s=128&d=identicon&r=PG&f=1", "display_name": "Karlomanio", "link": "https://stackoverflow.com/users/5376832/karlomanio"}, "reply_to_user": {"reputation": 742, "user_id": 5596937, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/1fAS1.jpg?s=128&g=1", "display_name": "Iron Man", "link": "https://stackoverflow.com/users/5596937/iron-man"}, "edited": false, "score": 0, "creation_date": 1461792475, "post_id": 36901026, "comment_id": 61366566, "body": "Concatenating the rows should still work, just leave out the one row (Column O) you know is wrong, then make the compare.  Your question sounded like it wanted a broad solution.  Let me know if I&#39;m not completely understanding your question, if there is some other way I can help.  Thanks!"}, {"owner": {"reputation": 742, "user_id": 5596937, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/1fAS1.jpg?s=128&g=1", "display_name": "Iron Man", "link": "https://stackoverflow.com/users/5596937/iron-man"}, "edited": false, "score": 0, "creation_date": 1461795381, "post_id": 36901026, "comment_id": 61367874, "body": "Please edit your answer so I can change the down-vote. I think I jumped the gun because I misunderstood what you meant. Please explain further what you mean by concatenating the rows."}], "tags": [], "owner": {"reputation": 312, "user_id": 5376832, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/131cf551898d23800289731848abedbc?s=128&d=identicon&r=PG&f=1", "display_name": "Karlomanio", "link": "https://stackoverflow.com/users/5376832/karlomanio"}, "is_accepted": false, "score": 1, "last_activity_date": 1461861798, "last_edit_date": 1461861798, "creation_date": 1461791690, "answer_id": 36901026, "question_id": 36900342, "link": "https://stackoverflow.com/questions/36900342/compare-rows-from-2-worksheets-and-update-a-specific-column/36901026#36901026", "title": "Compare rows from 2 worksheets and update a specific column", "body": "<p>Take all the rows except for Row O and put them in a long string, that is (concatenate them in a line) and use an IF THEN statement comparing the differences.  If a difference is found between the rows, you can then update them with the value of Column O from Workbook 2.</p>\n"}], "owner": {"reputation": 742, "user_id": 5596937, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/1fAS1.jpg?s=128&g=1", "display_name": "Iron Man", "link": "https://stackoverflow.com/users/5596937/iron-man"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 53, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1461861798, "creation_date": 1461789295, "last_edit_date": 1531164843, "question_id": 36900342, "link": "https://stackoverflow.com/questions/36900342/compare-rows-from-2-worksheets-and-update-a-specific-column", "title": "Compare rows from 2 worksheets and update a specific column", "body": "<p>Please see attached picture.</p>\n\n<p>Workbook 1 is the end product of merging, comparing, formatting, and calculating datasets from a couple of sources. At the beginning of each month, one of the sources gets a staffing update. While this update is running, the <a href=\"https://i.stack.imgur.com/28YnA.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/28YnA.png\" alt=\"enter image description here\"></a>data represented in Column O will contain 0's. The process takes several hours, but data is updated in this workbook each hour.</p>\n\n<p>What I need to achieve is running a report <strong>after</strong> the staffing update is completed (represented by Workbook 2) and comparing the data in Workbook 2 to Workbook 1. If <strong><em>ALL</em></strong> data in each row matches between the two workbooks, except for Column O, then Column O needs to get updated from Workbook 2. I should note that the data in the two workbooks will be identical except in column O.</p>\n\n<p>I have looked at other questions/answers on other forums and here in SO, but cannot find anything that matches what I need. If there is an answer out there that matches my requirements, please comment me the link.</p>\n"}, {"tags": ["javascript", "vba", "excel"], "comments": [{"owner": {"reputation": 11712, "user_id": 2227085, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/zr2qw.png?s=128&g=1", "display_name": "Santosh", "link": "https://stackoverflow.com/users/2227085/santosh"}, "edited": false, "score": 0, "creation_date": 1461840661, "post_id": 36900224, "comment_id": 61387048, "body": "Try this <a href=\"http://stackoverflow.com/questions/19140394/html-vba-click-event-not-firing/19144124#19144124\" title=\"html vba click event not firing\">stackoverflow.com/questions/19140394/&hellip;</a>"}], "owner": {"reputation": 64, "user_id": 5379889, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a047066bfcd57d11a3abba014f05ca0?s=128&d=identicon&r=PG", "display_name": "Greg", "link": "https://stackoverflow.com/users/5379889/greg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 923, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1461788888, "creation_date": 1461788888, "question_id": 36900224, "link": "https://stackoverflow.com/questions/36900224/how-to-execute-javascript-function-in-vba", "title": "How to Execute Javascript Function in VBA", "body": "<p>I'm filling out a web form with values from a spreadsheet. The form fills out fine, but there is some JavaScript field validation that takes place and since my code is filling in the text box fields without the validation, it is seeing my fields as empty. Here is a snippet of my VBA code.</p>\n\n<pre><code>Set objCollection = wd.document.getElementsByTagName(\"input\")    \ni = 0\nWhile i &lt; objCollection.Length\n    'Name\n    If objCollection(i).Name = \"Y__0__Cctl1_ctl8_ctl2_6_ctl4__X\" Then\n        objCollection(i).Value = Sheets(\"Main\").Range(\"b4\") ' \"Hello World\"\n    End If\n</code></pre>\n\n<p>I've narrowed down the onkeypress Javascript function but I'm not sure how to correctly call it in VBA with the appropriate variables. Here is another snippet.</p>\n\n<pre><code>&lt;input name=\"Y__0__Cctl1_ctl8_ctl2_6_ctl4__X\" title=\"\" class=\"DefaultTextBox DefaultTextBoxMandatory\" id=\"Y__0__Cctl1_ctl8_ctl2_6_ctl4__X\" onkeypress=\"return aeweb_BlurAndCallAssoc( this, 'Y__0__Cctl1_ctl8_ctl2_6_ctl4__X', event);\" onblur=\"aechg(this, event);\" type=\"text\" value=\"Hello World\" cursor=\"01Q0Q0Q1\" lastvalue=\"Hello World\" ismandatory=\"true\"&gt;\n</code></pre>\n\n<p>Any help would be greatly appreciated.</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["vba", "outlook", "outlook-2010"], "answers": [{"tags": [], "owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "is_accepted": true, "score": 12, "last_activity_date": 1568213611, "last_edit_date": 1568213611, "creation_date": 1461790562, "answer_id": 36900721, "question_id": 36900156, "link": "https://stackoverflow.com/questions/36900156/senderemailaddress-property-does-not-contain-a-standard-email-address-for-intern/36900721#36900721", "title": "SenderEmailAddress property does not contain a standard email address for internal contacts", "body": "<p>This is a perfectly valid address of type \"EX\" (as opposed to SMTP) - check the value of the <code>MailItem.SenderEmailType</code> property. If it is \"SMTP\", use <code>MailItem.SenderEmailAddress</code>. If it is \"EX\", use <code>MailItem.Sender.GetExchangeUser().PrimarySmtpAddress</code>.</p>\n\n<p>You can also try to read <code>PidTagSenderSmtpAddress</code> MAPI property (DASL name <code>http://schemas.microsoft.com/mapi/proptag/0x5D01001F</code>) using <code>MailItem.PropertyAccessor.GetProperty</code> - take a look at the message with <a href=\"http://www.dimastr.com/outspy/\" rel=\"nofollow noreferrer\">OutlookSpy</a> (click IMessage button) or <a href=\"https://github.com/stephenegriffin/mfcmapi\" rel=\"nofollow noreferrer\">MFCMAPI</a>.</p>\n"}], "owner": {"reputation": 1293, "user_id": 2665195, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/8rUmZ.png?s=128&g=1", "display_name": "Instant Breakfast", "link": "https://stackoverflow.com/users/2665195/instant-breakfast"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 8997, "favorite_count": 3, "accepted_answer_id": 36900721, "answer_count": 1, "score": 6, "last_activity_date": 1592694541, "creation_date": 1461788627, "last_edit_date": 1592694541, "question_id": 36900156, "link": "https://stackoverflow.com/questions/36900156/senderemailaddress-property-does-not-contain-a-standard-email-address-for-intern", "title": "SenderEmailAddress property does not contain a standard email address for internal contacts", "body": "<p><strong>Background:</strong></p>\n\n<p>Using an Outlook Rule to trigger a script, I want all of my email from certain high-visibility clients to open immediately upon receipt.</p>\n\n<p>I have successfully set up a rule that triggers when those clients send me email. It looks something like this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/UgIYg.jpg\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/UgIYg.jpg\" alt=\"emails from Jobs and Wozniak\"></a></p>\n\n<p>And I have successfully created a script that opens a reply to the email, depending on who sent it. It looks something like this:</p>\n\n<pre><code>Sub OpenEmailImmediately(oEmail As Outlook.MailItem)\n\n    Select Case oEmail.Sender\n        Case \"Jobs, Steve\"\n            oEmail.Reply.Display\n    End Select\n\nEnd Sub\n</code></pre>\n\n<p>Although this works, I have implemented it using <code>.Sender</code> property. </p>\n\n<p><strong>Problem:</strong></p>\n\n<p>I would <em>prefer</em> to implement this using the sender's email address (a unique value associated with every email I receive). Unfortunately, <code>oEmail.SenderEmailAddress</code>, which I expected to contain the email address, <em>only worked for external clients</em>.</p>\n\n<p>While troubleshooting, I discovered that where I expected <code>oEmail.SenderEmailAddress</code> to have a value similar to this: </p>\n\n<blockquote>\n  <p>steve.jobs@apple.com</p>\n</blockquote>\n\n<p>for internal emails it had a value similar to this: </p>\n\n<blockquote>\n  <p>/O=APPLE/CN=RECIPIENTS/CN=JOBSS6738</p>\n</blockquote>\n\n<p><strong>Question:</strong></p>\n\n<p>Is there a way I can make this script work for internals <em>and</em> externals using their standard email address?</p>\n\n<p><strong>Code with implemented solution:</strong></p>\n\n<p>Using Dmitry's answer below, the code was modified to use the email address:</p>\n\n<pre><code>Sub OpenEmailImmediately(oEmail As Outlook.MailItem)\n\n    If oEmail.SenderEmailType = \"EX\" Then\n        Select Case oEmail.Sender.GetExchangeUser().PrimarySmtpAddress\n            Case \"steve.jobs@apple.com\"\n                oEmail.Reply.Display\n        End Select\n    Else\n        Select Case oEmail.SenderEmailAddress\n            Case \"tom.brady@patriots.com\"\n                oEmail.Reply.Display\n        End Select\n    End If\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 1, "creation_date": 1461788218, "post_id": 36900028, "comment_id": 61364257, "body": "Didn&#39;t qualify the <code>range</code>?"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1461788286, "post_id": 36900028, "comment_id": 61364287, "body": "There is a space in <code>&quot; UNIT&quot;</code> should it be without the space <code>&quot;UNIT&quot;</code>?"}, {"owner": {"reputation": 2478, "user_id": 6110371, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/O93Qp.jpg?s=128&g=1", "display_name": "VBA Pete", "link": "https://stackoverflow.com/users/6110371/vba-pete"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1461788344, "post_id": 36900028, "comment_id": 61364325, "body": "@findwindow what do you mean by &quot;Didn&#39;t qualify the range&quot;?"}, {"owner": {"reputation": 2478, "user_id": 6110371, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/O93Qp.jpg?s=128&g=1", "display_name": "VBA Pete", "link": "https://stackoverflow.com/users/6110371/vba-pete"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1461788445, "post_id": 36900028, "comment_id": 61364389, "body": "@ScottCraner The space before UNIT is there purposely to avoid picking up values like SUNIT."}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1461788451, "post_id": 36900028, "comment_id": 61364391, "body": "Could potentially be some sort of Unicode vs. ascii issue if the values in Column C were pasted from a website or something. When I evaluate <code>InStr(Range(&quot;C&quot; &amp; k).Value, &quot; UNIT&quot;)</code> for a cell that contains &quot;BETA UNIT&quot; I get the expected return of 5, so there is nothing wrong with the way you are using <code>InStr</code>"}, {"owner": {"reputation": 2478, "user_id": 6110371, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/O93Qp.jpg?s=128&g=1", "display_name": "VBA Pete", "link": "https://stackoverflow.com/users/6110371/vba-pete"}, "reply_to_user": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1461788609, "post_id": 36900028, "comment_id": 61364487, "body": "@JohnColeman How would I go about identifying an issue like that? The data has been pulled from a database."}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 2, "creation_date": 1461788666, "post_id": 36900028, "comment_id": 61364524, "body": "@findwindow was probably noticing the you have <code>wsFile</code> before <code>Range</code> on the LHS but not on the RHS. Perhaps you are looking at Column C in the wrong worksheet."}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1461788960, "post_id": 36900028, "comment_id": 61364691, "body": "<code>what do you mean by &quot;Didn&#39;t qualify the range&quot;?</code> Sigh. So you don&#39;t even know what<code>wsFile.Range(</code> is doing XD"}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1461788975, "post_id": 36900028, "comment_id": 61364696, "body": "Maybe look at this: <a href=\"http://dailydoseofexcel.com/archives/2010/11/19/unicode-and-vbas-chrw-and-ascw-functions/\" rel=\"nofollow noreferrer\">dailydoseofexcel.com/archives/2010/11/19/&hellip;</a> but my hunch is that @findwindow &#39;s guess is probably a more likely explanation than some sort of encoding problem. Since I can&#39;t reproduce your problem we have nothing but guesswork to go on."}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 2, "creation_date": 1461789060, "post_id": 36900028, "comment_id": 61364745, "body": "@findwindow The sigh is a bit uncalled for. It is just as likely that he wasn&#39;t aware of that usage of the word &quot;qualify&quot;."}, {"owner": {"reputation": 2478, "user_id": 6110371, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/O93Qp.jpg?s=128&g=1", "display_name": "VBA Pete", "link": "https://stackoverflow.com/users/6110371/vba-pete"}, "reply_to_user": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 1, "creation_date": 1461789060, "post_id": 36900028, "comment_id": 61364746, "body": "@JohnColeman that was exactly the issue. wsFile.Range(&quot;C&quot; &amp; k).Value fixed it. Such a rookie mistake."}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1461789100, "post_id": 36900028, "comment_id": 61364771, "body": "Point take. I apologize."}, {"owner": {"reputation": 2478, "user_id": 6110371, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/O93Qp.jpg?s=128&g=1", "display_name": "VBA Pete", "link": "https://stackoverflow.com/users/6110371/vba-pete"}, "edited": false, "score": 0, "creation_date": 1461789110, "post_id": 36900028, "comment_id": 61364779, "body": "Thanks everyone for your help!"}, {"owner": {"reputation": 2478, "user_id": 6110371, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/O93Qp.jpg?s=128&g=1", "display_name": "VBA Pete", "link": "https://stackoverflow.com/users/6110371/vba-pete"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1461789138, "post_id": 36900028, "comment_id": 61364799, "body": "@findwindow No offense taken!"}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1461789167, "post_id": 36900028, "comment_id": 61364812, "body": "Good. If @findwindow answers it you should accept it."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 5, "creation_date": 1461789669, "post_id": 36900028, "comment_id": 61365084, "body": "@findwindow dude, where&#39;s your <a href=\"https://codereview.stackexchange.com\">Code Review</a> account? :D"}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1461789727, "post_id": 36900028, "comment_id": 61365125, "body": "@Mat&#39;sMug lol I am not <i>that</i> good."}], "answers": [{"tags": [], "owner": {"reputation": 521, "user_id": 3656152, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/1a87c3d2e77df2882dc9c5192bbf871f?s=128&d=identicon&r=PG&f=1", "display_name": "James Heffer", "link": "https://stackoverflow.com/users/3656152/james-heffer"}, "is_accepted": false, "score": 0, "last_activity_date": 1461919669, "creation_date": 1461919669, "answer_id": 36933727, "question_id": 36900028, "link": "https://stackoverflow.com/questions/36900028/instr-always-returns-zero/36933727#36933727", "title": "InStr always returns zero", "body": "<p>Here is the INSTR return values, hope it helps... <a href=\"http://i.stack.imgur.com/w716i.png\" rel=\"nofollow\">Return_Values</a></p>\n"}], "owner": {"reputation": 2478, "user_id": 6110371, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/O93Qp.jpg?s=128&g=1", "display_name": "VBA Pete", "link": "https://stackoverflow.com/users/6110371/vba-pete"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 196, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1461919669, "creation_date": 1461788153, "question_id": 36900028, "link": "https://stackoverflow.com/questions/36900028/instr-always-returns-zero", "title": "InStr always returns zero", "body": "<p>Any idea why the InStr formula below would always return zero even though the value in column C includes the word UNIT (e.g BETA UNIT)?</p>\n\n<pre><code>For k = 2 To y\n\nwsFile.Range(\"P\" &amp; k).Value = InStr(Range(\"C\" &amp; k).Value, \" UNIT\")\n\nNext k\n</code></pre>\n\n<p>I already switched .Value to .Text but that did not solve it.</p>\n\n<p>Thanks for your help!</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1461788030, "post_id": 36899964, "comment_id": 61364138, "body": "Do you have another function or sub that is called SummaryAssemble?"}, {"owner": {"reputation": 744, "user_id": 1623804, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/62YqG.jpg?s=128&g=1", "display_name": "camelCaseCowboy", "link": "https://stackoverflow.com/users/1623804/camelcasecowboy"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1461788171, "post_id": 36899964, "comment_id": 61364232, "body": "I do not.______________"}], "answers": [{"comments": [{"owner": {"reputation": 744, "user_id": 1623804, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/62YqG.jpg?s=128&g=1", "display_name": "camelCaseCowboy", "link": "https://stackoverflow.com/users/1623804/camelcasecowboy"}, "edited": false, "score": 0, "creation_date": 1461789094, "post_id": 36900032, "comment_id": 61364768, "body": "It looks like the line Range(&quot;B4&quot;)... is throwing an error as well.  It says &quot;Application Defined or Object Defined error&quot;"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1461789693, "post_id": 36900032, "comment_id": 61365107, "body": "I missed the bit with <code>Range(2, i)</code> . It should have been <code>Cells(2, i)</code>."}, {"owner": {"reputation": 744, "user_id": 1623804, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/62YqG.jpg?s=128&g=1", "display_name": "camelCaseCowboy", "link": "https://stackoverflow.com/users/1623804/camelcasecowboy"}, "edited": false, "score": 0, "creation_date": 1461790904, "post_id": 36900032, "comment_id": 61365771, "body": "Is there a way to do the same but copying as values (since it&#39;s a &quot;Desination&quot; command there&#39;s no paste values option)?  I will need it for copying the value of a formula over."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 1, "creation_date": 1461791203, "post_id": 36900032, "comment_id": 61365945, "body": "I&#39;ve added a direct value transfer method above. Remember that the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff196273.aspx\" rel=\"nofollow noreferrer\">Range.Cells property</a> is <code>Cells(&lt;row_number&gt;, &lt;column_number&gt;)</code> which is sort of backwards from <code>Range(&quot;B4&quot;)</code> (you are incrementing the column not the row). It is possible that you meant <code>Cells(i, 2)</code> not <code>Cells(2, i)</code>."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 6, "last_activity_date": 1461791041, "last_edit_date": 1495541275, "creation_date": 1461788166, "answer_id": 36900032, "question_id": 36899964, "link": "https://stackoverflow.com/questions/36899964/excel-vba-first-line-throwing-argument-not-optional/36900032#36900032", "title": "Excel VBA - First line throwing &quot;Argument not optional&quot;", "body": "<p>The problem is actually in this line,</p>\n\n<pre><code>Range.Select (\"B4\")\n</code></pre>\n\n<p>It should be closer to,</p>\n\n<pre><code>Range(\"B4\").Select\n</code></pre>\n\n<p>Couple of other problems</p>\n\n<pre><code>Sub SummaryAssemble()\n    Dim i As Long, x As Long\n\n    x = Sheets.Count\n\n    For i = 3 To x Step 1\n          ' Copy and paste the value into sheet where A\n          ' First copy value for ATRT 2014 (cell B4)\n        Sheets(i).Range(\"B4\").Copy _\n                Destination:=Sheets(\"Summary\").Cells(2, i)\n        'or as a direct value transfer (PasteSpecial Paste:=xlvalues)\n        'Sheets(\"Summary\").Cells(2, i) = Sheets(i).Range(\"B4\").Value\n    Next i\nEnd Sub\n</code></pre>\n\n<p>I believe your use of <strong>Summary</strong> should have been quoted as a literal string and there is no need to select something for a copy and paste operation. Finally, you were mixing and mismatching the syntax for a <a href=\"https://msdn.microsoft.com/en-us/library/office/ff838238.aspx\" rel=\"nofollow noreferrer\">Range object</a> and a <a href=\"https://msdn.microsoft.com/en-us/library/office/ff196273.aspx\" rel=\"nofollow noreferrer\">Range.Cells property</a>; e.g. it is <code>Range(\"B4\")</code> and <code>Cells(2, i)</code>.</p>\n\n<hr>\n\n<p><sub>See <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba-macros\">How to avoid using Select in Excel VBA macros</a> for more methods on getting away from relying on select and activate to accomplish your goals.</sub></p>\n"}, {"tags": [], "owner": {"reputation": 4801, "user_id": 4713729, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/PL9tu.jpg?s=128&g=1", "display_name": "vacip", "link": "https://stackoverflow.com/users/4713729/vacip"}, "is_accepted": false, "score": 4, "last_activity_date": 1461789663, "last_edit_date": 1461789663, "creation_date": 1461789344, "answer_id": 36900355, "question_id": 36899964, "link": "https://stackoverflow.com/questions/36899964/excel-vba-first-line-throwing-argument-not-optional/36900355#36900355", "title": "Excel VBA - First line throwing &quot;Argument not optional&quot;", "body": "<p>Let me add one thing to Jeeped's answer. Whenever you see the Sub getting highlighted after an error, it is usually not the culprit. <strong>The yellow highlight doesn't actually mean \"There is a problem with this row.\"</strong> It merely means \"This is the next row of code to be executed.\" Or in other words, \"This is where I have stopped executing the program.\"</p>\n\n<p><a href=\"https://i.stack.imgur.com/aVC85.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/aVC85.png\" alt=\"Compile error highlights\"></a></p>\n\n<p>In cases like this, look for the <strong>selected</strong> or highlighted code (<em>Range</em> in your case). That is the one causing the problem - a Compile error.</p>\n\n<p><a href=\"https://i.stack.imgur.com/O2rH9.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/O2rH9.png\" alt=\"Compile error message\"></a></p>\n\n<p>Before a Sub could be executed, it needs to be compiled. When this happens, it is checked for errors. Some specific types of errors won't even let the code be compiled, so it won't even begin execution.</p>\n\n<hr>\n\n<p>There are three major types of errors. A <strong>syntax error</strong> is when the code doesn't make sense. It can't be compiled, because it violates the basic rules of the language. Like saying <em>\"Grumblutty wadahargs.\"</em></p>\n\n<p>Then there is the <strong>Runtime error</strong>. This happens when the words do make sense, maybe even the whole sentence is OK grammatically, but in the current context it tries something that can't be done. Like saying <em>\"Put the lorry on your head and go for a run.\"</em> Not gonna work.</p>\n\n<p>The third type of error is the favourite of all programmers: The <strong>Logic error</strong>. Syntax is OK, the code runs, no error messages, but something goes horribly wrong. Like: <em>\"Open the window and step out.\"</em> This technically can be done, but it will hurt. Programmers spend hours and hours hunting this type of error. A lot of fun...</p>\n"}], "owner": {"reputation": 744, "user_id": 1623804, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/62YqG.jpg?s=128&g=1", "display_name": "camelCaseCowboy", "link": "https://stackoverflow.com/users/1623804/camelcasecowboy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1129, "favorite_count": 0, "accepted_answer_id": 36900032, "answer_count": 2, "score": 3, "last_activity_date": 1463059815, "creation_date": 1461787931, "last_edit_date": 1463059815, "question_id": 36899964, "link": "https://stackoverflow.com/questions/36899964/excel-vba-first-line-throwing-argument-not-optional", "title": "Excel VBA - First line throwing &quot;Argument not optional&quot;", "body": "<p>I'm trying to develop a sub that pulls data from the same cell one worksheet at a time and copies it to a worksheet called \"Summary\" and pastes it in to create a table of values.  However, I am getting the error \"Argument not optional\" and the first line is highlighted as the issue (the one with Sub SummaryAssemble()), yet there doesn't seem to be a reason for that since it isn't necessary to pass anything into the subroutine.</p>\n\n<pre><code>Sub SummaryAssemble()\n\n    Dim i As Integer\n\n    Dim x As Integer\n\n    x = Sheets.Count\n\n\n    For i = 3 To x Step 1\n\n    Sheets(i).Activate\n        ' Copy and paste the value into sheet where A\n        ' Range.Select($A\n        ' First copy value for ATRT 2014 (cell B4)\n       Range.Select (\"B4\")\n       Selection.Copy\n       Sheets(Summary).Activate\n       ' Select Column B Row i (2, i)\n       Range(2, i).Select\n       ActiveCell.Paste\n\n       Sheets(i).Activate\n\n        Sheets(ActiveSheet.Index + 1).Activate\n    Next i\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "autohotkey"], "answers": [{"tags": [], "owner": {"reputation": 44, "user_id": 6619607, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OA4gg.png?s=128&g=1", "display_name": "Xeo786", "link": "https://stackoverflow.com/users/6619607/xeo786"}, "is_accepted": true, "score": 0, "last_activity_date": 1469511197, "creation_date": 1469511197, "answer_id": 38581704, "question_id": 36899517, "link": "https://stackoverflow.com/questions/36899517/autohotkey-runs-excel-vba-macro-but-changes-are-not-applied/38581704#38581704", "title": "Autohotkey runs Excel VBA macro but changes are not applied", "body": "<p>This can be accomplished simply without VBA macro, while file being closed. </p>\n\n<pre><code>FilePath = C:\\Users\\KostasK\\Desktop\\Plano.xlsx\noExcel := ComObjGet(FilePath)\noExcel.Worksheets(\"Sheet1\").Range(\"C1\").VALUE := \"99\" ; you can put actual sheet name instead \"sheet1\"\noExcel.Save\noExcel.Quit\noExcel := \n</code></pre>\n"}], "owner": {"reputation": 768, "user_id": 1467434, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6cb825b6be932e244c6f52a2a5cefed2?s=128&d=identicon&r=PG&f=1", "display_name": "mgus", "link": "https://stackoverflow.com/users/1467434/mgus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 874, "favorite_count": 0, "accepted_answer_id": 38581704, "answer_count": 1, "score": 1, "last_activity_date": 1469511197, "creation_date": 1461786383, "last_edit_date": 1461809885, "question_id": 36899517, "link": "https://stackoverflow.com/questions/36899517/autohotkey-runs-excel-vba-macro-but-changes-are-not-applied", "title": "Autohotkey runs Excel VBA macro but changes are not applied", "body": "<p>I have an Excel file, say <code>Plano.xlsx</code> and I am trying to run a VBA macro script on it using Autohotkey following the instructions stated <a href=\"https://autohotkey.com/board/topic/80602-run-excel-vba-macro-via-ahk-l-and-com/\" rel=\"nofollow\">here</a>.\nI don't want the Excel to be visible during this process. The VBA code is supposed to enter the value 99 in the cell C1 at the first sheet. \nAfter hours of trial and error, the Autohotkey script runs smoothly without errors i.e. it opens an Excel process in the background supposedly \nediting the Excel file and then exits. The problem is that the Excel file does not change at all. The VBA code works fine if I paste it manually \nin a new VBA module in Excel without using Autohotkey.   </p>\n\n<p>Here is the code:</p>\n\n<pre><code>#SingleInstance force\n\n#Include Acc.ahk\n\nVBcode=\n(\nSub myFunction()\n    Worksheets(1).Select\n    Worksheets(1).Range(\"C1\").Select\n    Selection.Value = 99\nEnd Sub\n)\n\nExcel_Run(\"myFunction\")\n\nExcel_Run(sFunction){\n    FilePath = C:\\Users\\KostasK\\Desktop\\Plano.xlsx\n    oExcel := ComObjCreate(\"Excel.Application\")\n    Excel_ImportCode(VBcode)\n    oWorkbook := oExcel.Workbooks.Open(FilePath)\n    Excel_Get().Run(sFunction)\n    oWorkbook.Save\n    oExcel.Quit\n}\n\nExcel_ImportCode(VBcode){\n    if fileexist(A_ScriptDir . \"\\tempvbcode.txt\")\n        FileDelete, %A_ScriptDir%\\tempvbcode.txt\n\n    FileAppend, %VBcode%, %A_ScriptDir%\\tempvbcode.txt\n\n    Excel_Get().ActiveWorkbook.VBProject\n        .VBComponents.Import(A_ScriptDir . \"\\tempvbcode.txt\")\n}\n\nExcel_Get(WinTitle=\"ahk_class XLMAIN\") {    ; by Sean and Jethrow, minor modification by Learning one\n    ControlGet, hwnd, hwnd, , Excel71, %WinTitle%\n    if !hwnd\n        return\n    Window := Acc_ObjectFromWindow(hwnd, -16)\n    Loop\n        try\n            Application := Window.Application\n        catch\n            ControlSend, Excel71, {esc}, %WinTitle%\n    Until !!Application\n    return Application\n}\n</code></pre>\n\n<p>To get the Acc.ahk library that is included in the script please see <a href=\"https://autohotkey.com/board/topic/77303-acc-library-ahk-l-updated-09272012/\" rel=\"nofollow\">here</a>. My Autohotkey version is v.1.1.23.05 and I use Excel 2013. I did not \ntake a closer look on <code>Excel_Get()</code> function but I used it instead of <code>ComObjActive(\"Excel.Application\")</code> because the latter produces errors. There \nis some useful info about that <a href=\"https://autohotkey.com/board/topic/77840-how-to-pass-com-object-pointer-to-a-script/#entry495039\" rel=\"nofollow\">here</a>. Finally, please note that I have enabled the following options in Excel Trust Center: \n<code>Enable all macros (not recommended, potentially dangerous code can run)</code> and <code>Trust access to the VBA project object model</code>. Also, in Add-ins section \nin COM Add-ins nothing is checked (I don't know if that matters). Finally, I always run the script as administrator.</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 506, "user_id": 4282481, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cdb4a9d3cc8e7f3c57889b76cbae9822?s=128&d=identicon&r=PG&f=1", "display_name": "user18101", "link": "https://stackoverflow.com/users/4282481/user18101"}, "edited": false, "score": 0, "creation_date": 1462215824, "post_id": 36959246, "comment_id": 61533648, "body": "It is in that sheet, does it need to be in a module for the workbook?"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6058587"}, "is_accepted": false, "score": 0, "last_activity_date": 1462044440, "creation_date": 1462044440, "answer_id": 36959246, "question_id": 36899473, "link": "https://stackoverflow.com/questions/36899473/auto-open-workbook-open-with-connection-refresh-in-vba/36959246#36959246", "title": "Auto_open &amp; Workbook_open with Connection refresh in VBA", "body": "<p>You are putting the code in 'ThisWorkbook' object, right.  </p>\n\n<pre><code>Private Sub Workbook_Open()\n     ActiveWorkbook.RefreshAll\nEnd Sub\n\n\nPrivate Sub Workbook_Open()\n'Step 1: Use the RefreshAll method\n    Workbooks(ThisWorkbook.Name).RefreshAll\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 359, "user_id": 5516685, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e8d1cf30e65ce2a0283e265d422ccbb2?s=128&d=identicon&r=PG&f=1", "display_name": "deez", "link": "https://stackoverflow.com/users/5516685/deez"}, "is_accepted": false, "score": 0, "last_activity_date": 1598381895, "creation_date": 1598381895, "answer_id": 63585447, "question_id": 36899473, "link": "https://stackoverflow.com/questions/36899473/auto-open-workbook-open-with-connection-refresh-in-vba/63585447#63585447", "title": "Auto_open &amp; Workbook_open with Connection refresh in VBA", "body": "<p>user6058587 was close, but you just need to add this to ThisWorkbook:</p>\n<pre><code>Private Sub Workbook_Open() \n'Step 1: Use the RefreshAll method\n    Workbooks(ThisWorkbook.Name).RefreshAll\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 506, "user_id": 4282481, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cdb4a9d3cc8e7f3c57889b76cbae9822?s=128&d=identicon&r=PG&f=1", "display_name": "user18101", "link": "https://stackoverflow.com/users/4282481/user18101"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 453, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1598381895, "creation_date": 1461786234, "question_id": 36899473, "link": "https://stackoverflow.com/questions/36899473/auto-open-workbook-open-with-connection-refresh-in-vba", "title": "Auto_open &amp; Workbook_open with Connection refresh in VBA", "body": "<p>I have a script that refreshes my data connection to a SQL server. I need to the macro to run when the workbook is opened but for some reason it will not. I guess it has to do with the connection refresh.  I tried with both Workbook_Open and Auto_Open() and neither are working. Other than the data load the only thing I am doing is filtering and copying data, nothing exotic.</p>\n\n<p>Does the data refresh need permissions outside of the script, is that the problem?</p>\n\n<p>Here are the first couples lines.</p>\n\n<p><code>Sub Auto_Open()\nActiveWorkbook.Connections(\"Connection Name\").Refresh\nother stuff\nend sub</code></p>\n"}, {"tags": ["sql", "vba", "ms-access"], "comments": [{"owner": {"reputation": 293, "user_id": 4332080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cb6fa3c0e479015639cee5e59c4d325b?s=128&d=identicon&r=PG", "display_name": "INOPIAE", "link": "https://stackoverflow.com/users/4332080/inopiae"}, "edited": false, "score": 0, "creation_date": 1461786226, "post_id": 36899116, "comment_id": 61363020, "body": "I am not quite sure why you are working with the Max. You do not need the Where part in the SQL-statement. SQL = &quot;INSERT INTO Breweries ([Contact Names].[Value]) VALUES (&quot; + itm + &quot;) &quot;. Why are you labling a combobox with txt as suffix which points to a textbox?"}, {"owner": {"reputation": 11, "user_id": 3873314, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/36e441a0192f3f4260ae5c462eec6c63?s=128&d=identicon&r=PG&f=1", "display_name": "estoner", "link": "https://stackoverflow.com/users/3873314/estoner"}, "reply_to_user": {"reputation": 293, "user_id": 4332080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cb6fa3c0e479015639cee5e59c4d325b?s=128&d=identicon&r=PG", "display_name": "INOPIAE", "link": "https://stackoverflow.com/users/4332080/inopiae"}, "edited": false, "score": 0, "creation_date": 1461787339, "post_id": 36899116, "comment_id": 61363729, "body": "I do need the Max - it gives me the ID of the most recently added entry into the Breweries Table. I then add values into the &quot;Contact Names&quot; field of the entity with that ID.  I can update my code so that the <i>prefix</i> better aligns with the object"}, {"owner": {"reputation": 9306, "user_id": 731453, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/389670f2388d25a21c2d6b61b027523e?s=128&d=identicon&r=PG&f=1", "display_name": "ron tornambe", "link": "https://stackoverflow.com/users/731453/ron-tornambe"}, "edited": false, "score": 0, "creation_date": 1461788485, "post_id": 36899116, "comment_id": 61364414, "body": "Multi-select combo boxes must be new in MSA16. Or are you using a Listbox?"}, {"owner": {"reputation": 11, "user_id": 3873314, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/36e441a0192f3f4260ae5c462eec6c63?s=128&d=identicon&r=PG&f=1", "display_name": "estoner", "link": "https://stackoverflow.com/users/3873314/estoner"}, "edited": false, "score": 0, "creation_date": 1461789669, "post_id": 36899116, "comment_id": 61365083, "body": "No, I&#39;m using a multi-select combo box, like the left side of this image <a href=\"http://www.codeproject.com/KB/silverlight/MultiSelComboBox/image001.png\" rel=\"nofollow noreferrer\">codeproject.com/KB/silverlight/MultiSelComboBox/image001.png</a>"}, {"owner": {"reputation": 710, "user_id": 5021236, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16637c5be814c194e7dde84f653d36d7?s=128&d=identicon&r=PG&f=1", "display_name": "jhTuppeny", "link": "https://stackoverflow.com/users/5021236/jhtuppeny"}, "edited": false, "score": 0, "creation_date": 1461854514, "post_id": 36899116, "comment_id": 61397979, "body": "I think that control is for a web page - which control are you actually using on your Access form?"}, {"owner": {"reputation": 11, "user_id": 3873314, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/36e441a0192f3f4260ae5c462eec6c63?s=128&d=identicon&r=PG&f=1", "display_name": "estoner", "link": "https://stackoverflow.com/users/3873314/estoner"}, "reply_to_user": {"reputation": 710, "user_id": 5021236, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16637c5be814c194e7dde84f653d36d7?s=128&d=identicon&r=PG&f=1", "display_name": "jhTuppeny", "link": "https://stackoverflow.com/users/5021236/jhtuppeny"}, "edited": false, "score": 0, "creation_date": 1461864932, "post_id": 36899116, "comment_id": 61404984, "body": "@jhTuppeny Here is an image of the form that I&#39;m working on. You can see in the Property Sheet that it is in fact a Combo Box. The second image is the same field in use - you can see it is a drop down Combo Box with check boxes to allow for multiple selections. <a href=\"http://imgur.com/GcdO1EY\" rel=\"nofollow noreferrer\">imgur.com/GcdO1EY</a> <a href=\"http://imgur.com/m8M1Tu0\" rel=\"nofollow noreferrer\">imgur.com/m8M1Tu0</a>"}, {"owner": {"reputation": 710, "user_id": 5021236, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16637c5be814c194e7dde84f653d36d7?s=128&d=identicon&r=PG&f=1", "display_name": "jhTuppeny", "link": "https://stackoverflow.com/users/5021236/jhtuppeny"}, "edited": false, "score": 0, "creation_date": 1461920444, "post_id": 36899116, "comment_id": 61427360, "body": "The issues that you are having are to do with the specific properties of the control that you&#39;re using. You need to specify exactly which custom control you&#39;ve used to be sure how to work with it. The standard combo box control that comes with Access doesn&#39;t have check boxes and buttons."}, {"owner": {"reputation": 753, "user_id": 7526564, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/K9yKl.jpg?s=128&g=1", "display_name": "Vlado", "link": "https://stackoverflow.com/users/7526564/vlado"}, "edited": false, "score": 0, "creation_date": 1580483997, "post_id": 36899116, "comment_id": 106123824, "body": "@estoner: it looks like you are talking about Silverlight not Access. There is no such Combo Box in MS Access."}], "answers": [{"tags": [], "owner": {"reputation": 625, "user_id": 2880342, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/917a1ca96bd067832d2b7e4d8967d336?s=128&d=identicon&r=PG&f=1", "display_name": "GoodJuJu", "link": "https://stackoverflow.com/users/2880342/goodjuju"}, "is_accepted": false, "score": 0, "last_activity_date": 1485904087, "creation_date": 1485904087, "answer_id": 41969167, "question_id": 36899116, "link": "https://stackoverflow.com/questions/36899116/get-values-from-a-multi-value-combo-box-in-access-vba/41969167#41969167", "title": "Get values from a multi-value combo box in access vba", "body": "<p>If a combobox has more than 1 item selected/populated, then you can use Ubound() to find out how many.</p>\n\n<pre><code>IF UBound(Me.cmbContacts.OldValue) &gt; 0\n    For i = LBound(Me.cmbContacts.OldValue) To UBound(Me.cmbContacts.OldValue)\n       SQL = \"INSERT INTO Breweries ([Contact Names].[Value]) VALUES (\" + Me.cmbContacts.OldValue(i) + \") WHERE ID=\" + Max\n        CurrentDb.Execute (SQL)\n    Next i\nEND IF\n</code></pre>\n\n<p>Bear in mind this will error with a Type Mismatch if only one, or no values are selected and you will have to handle this somehow.</p>\n\n<p>Hope this helps..</p>\n"}], "owner": {"reputation": 11, "user_id": 3873314, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/36e441a0192f3f4260ae5c462eec6c63?s=128&d=identicon&r=PG&f=1", "display_name": "estoner", "link": "https://stackoverflow.com/users/3873314/estoner"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2608, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1593956758, "creation_date": 1461785067, "last_edit_date": 1593956758, "question_id": 36899116, "link": "https://stackoverflow.com/questions/36899116/get-values-from-a-multi-value-combo-box-in-access-vba", "title": "Get values from a multi-value combo box in access vba", "body": "<p>I have a form that I'm using to gather information that will be inserted into a database table in Access 2016. My form has a multi-value combo box (called cmbContacts) that pulls values from a Contacts table (ID and Name). A user is able to select 0 or more contacts from the combo box. When a user clicks the submit button, the button_click event triggers VBA code to format the information and insert it into the table.</p>\n\n<p>What I need to do is get the IDs of each selected contact from the combo box.</p>\n\n<p>Here's what I have so far:</p>\n\n<pre><code>If Me.cmbContacts.ItemsSelected.Count &gt; 0 Then 'Only run code if there are contacts selected'\n    'Select the most recently added entry (added right before this if statement)'\n    Dim rs As DAO.Recordset, Max As Integer\n    SQL = \"SELECT MAX(ID) FROM Breweries\"\n    Set rs = CurrentDb.OpenRecordset(SQL)\n    Max = rs.Fields(0)\n    'Insert each selected Contact ID into Breweries.[Contact Names].Value'\n    Dim itm As Variant\n    For Each itm In Me.cmbContacts.ItemsSelected\n        SQL = \"INSERT INTO Breweries ([Contact Names].[Value]) VALUES (\" + itm + \") WHERE ID=\" + Max\n        CurrentDb.Execute (SQL)\n    Next itm\nEnd If\n</code></pre>\n\n<p>Some issues:</p>\n\n<ul>\n<li>Me.cmbContacts.ItemsSelected.Count always equals 0, regardless of how many items are selected in the Combo Box</li>\n<li>Because cmbContacts.ItemsSelected doesn't contain the selected items, the for loop doesn't run. I'm not sure why it's not registering the selected items</li>\n</ul>\n"}, {"tags": ["ms-access", "vba", "ms-access-2010", "ms-access-2007", "linked-tables"], "comments": [{"owner": {"reputation": 5789, "user_id": 2679750, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/W8CvF.jpg?s=128&g=1", "display_name": "Mark C.", "link": "https://stackoverflow.com/users/2679750/mark-c"}, "edited": false, "score": 0, "creation_date": 1461784951, "post_id": 36899011, "comment_id": 61362225, "body": "I don&#39;t know the answer and I&#39;m not trying to dissuade you, but is this so you can just click a button and sync the data as opposed to running the wizard? I would be hesitant to do this because of the nice built-in validation that comes natively with Access that you (may?) have to also code for."}, {"owner": {"reputation": 1097, "user_id": 472673, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/3d4a6896f964b03e9495a0c5f16100a1?s=128&d=identicon&r=PG", "display_name": "Mark", "link": "https://stackoverflow.com/users/472673/mark"}, "reply_to_user": {"reputation": 5789, "user_id": 2679750, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/W8CvF.jpg?s=128&g=1", "display_name": "Mark C.", "link": "https://stackoverflow.com/users/2679750/mark-c"}, "edited": false, "score": 0, "creation_date": 1461785047, "post_id": 36899011, "comment_id": 61362297, "body": "Yes, that&#39;s exactly the reason for doing this. I have automated almost all my database manipulations in VBA except this one. I can just use the wizard but it seems like I&#39;m at the last hurdle!"}], "answers": [{"tags": [], "owner": {"reputation": 930, "user_id": 499486, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/6ff3cd57318170e4bf342988eef9a3db?s=128&d=identicon&r=PG", "display_name": "DataWriter", "link": "https://stackoverflow.com/users/499486/datawriter"}, "is_accepted": false, "score": 4, "last_activity_date": 1527279176, "last_edit_date": 1527279176, "creation_date": 1461789739, "answer_id": 36900474, "question_id": 36899011, "link": "https://stackoverflow.com/questions/36899011/ms-access-link-table-with-vba/36900474#36900474", "title": "MS Access Link Table With VBA", "body": "<p>It's actually pretty easy--you just create a new tabledef and set its .connect property to an ODBC connection string that links to the other Access database.</p>\n\n<pre><code>Private Function LinkTable(LinkedTableName As String, TableToLink As String, connectString As String) As Boolean\n\n    Dim tdf As New dao.TableDef\n\n    On Error GoTo LinkTable_Error\n\n    With CurrentDb\n\n        .TableDefs.Refresh\n\n        Set tdf = .CreateTableDef(LinkedTableName)\n        tdf.Connect = connectString\n        tdf.SourceTableName = TableToLink\n        .TableDefs.Append tdf\n        .TableDefs.Refresh\n\n\n    End With\n\n    Set tdf = Nothing\nEnd Function\n</code></pre>\n\n<p>The connection string would look something like this (taken from <a href=\"http://www.connectionstrings.com/access/\" rel=\"nofollow noreferrer\" title=\"ConnectionStrings.com\">connectionstrings.com</a>):</p>\n\n<pre><code>Provider=Microsoft.ACE.OLEDB.12.0;Data Source=C:\\myFolder\\myAccessFile.accdb;Persist Security Info=False;\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "is_accepted": true, "score": 17, "last_activity_date": 1461792199, "last_edit_date": 1461792199, "creation_date": 1461791651, "answer_id": 36901013, "question_id": 36899011, "link": "https://stackoverflow.com/questions/36899011/ms-access-link-table-with-vba/36901013#36901013", "title": "MS Access Link Table With VBA", "body": "<p>You can use the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff196455.aspx\" rel=\"noreferrer\">DoCmd.TransferDatabase Method</a> to create a link to a table in another Access database.</p>\n\n\n\n<pre class=\"lang-vb prettyprint-override\"><code>DoCmd.TransferDatabase TransferType:=acLink, _\n        DatabaseType:=\"Microsoft Access\", _\n        DatabaseName:=\"C:\\share\\Access\\Example Database.accdb\", _\n        ObjectType:=acTable, _\n        Source:=\"Addresses\", _\n        Destination:=\"Addresses_link\"\n</code></pre>\n\n<p>I included the option names hoping that would make it easier to track which option is which.  But if that seems too verbose, you can omit the option names and do it all on one line:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>DoCmd.TransferDatabase acLink, \"Microsoft Access\", \"C:\\share\\Access\\Example Database.accdb\", acTable , \"Addresses\", \"Addresses_link\"\n</code></pre>\n"}], "owner": {"reputation": 1097, "user_id": 472673, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/3d4a6896f964b03e9495a0c5f16100a1?s=128&d=identicon&r=PG", "display_name": "Mark", "link": "https://stackoverflow.com/users/472673/mark"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 37510, "favorite_count": 2, "accepted_answer_id": 36901013, "answer_count": 2, "score": 12, "last_activity_date": 1527279176, "creation_date": 1461784722, "last_edit_date": 1461791708, "question_id": 36899011, "link": "https://stackoverflow.com/questions/36899011/ms-access-link-table-with-vba", "title": "MS Access Link Table With VBA", "body": "<p>How can I link a table from one MS Access Database (*.mdb or *.accdb) to another Access database in VBA?</p>\n\n<p>Basically I just was to use VBA to replicate what the External Data wizard does.</p>\n\n<p>I've googled this and I see many examples of how to update or relink tables and many examples of linking to SQL databases, but very few of simple linking tables between Access databases.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1461784658, "post_id": 36898854, "comment_id": 61362039, "body": "Store the search string to a variable, not array."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1461784996, "post_id": 36898854, "comment_id": 61362256, "body": "Consider describing what you mean by &quot;Without any luck&quot;. Are there errors? If so, what line raises the error and what is the error message?"}, {"owner": {"reputation": 23, "user_id": 6095396, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f655b32cfa8018b2a7aa3474bff85d1f?s=128&d=identicon&r=PG&f=1", "display_name": "Mac", "link": "https://stackoverflow.com/users/6095396/mac"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1461786183, "post_id": 36898854, "comment_id": 61362995, "body": "@DavidZemens When I run the macro as written a new sheet is added but nothing is copied.  No errors occur"}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 6095396, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f655b32cfa8018b2a7aa3474bff85d1f?s=128&d=identicon&r=PG&f=1", "display_name": "Mac", "link": "https://stackoverflow.com/users/6095396/mac"}, "edited": false, "score": 0, "creation_date": 1461787088, "post_id": 36899404, "comment_id": 61363576, "body": "Replaced everything following  &quot;For J&quot; with what you selected and I&#39;m now getting a for without next error.  I&#39;d appreciate it if you could repost the full corrected code.  I seem to be screwing up trying to paste in your suggestion.  Thanks!"}, {"owner": {"reputation": 23, "user_id": 6095396, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f655b32cfa8018b2a7aa3474bff85d1f?s=128&d=identicon&r=PG&f=1", "display_name": "Mac", "link": "https://stackoverflow.com/users/6095396/mac"}, "edited": false, "score": 0, "creation_date": 1461788078, "post_id": 36899404, "comment_id": 61364167, "body": "Awesome!  Thanks so much @JNevill.  Greatly appreciate it"}, {"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "reply_to_user": {"reputation": 23, "user_id": 6095396, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f655b32cfa8018b2a7aa3474bff85d1f?s=128&d=identicon&r=PG&f=1", "display_name": "Mac", "link": "https://stackoverflow.com/users/6095396/mac"}, "edited": false, "score": 0, "creation_date": 1461788086, "post_id": 36899404, "comment_id": 61364175, "body": "Not a problem. I have posted two version. I believe the second one will be quicker since it&#39;s using <code>find()</code> on the row/range instead of looping through every cell."}, {"owner": {"reputation": 23, "user_id": 6095396, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f655b32cfa8018b2a7aa3474bff85d1f?s=128&d=identicon&r=PG&f=1", "display_name": "Mac", "link": "https://stackoverflow.com/users/6095396/mac"}, "edited": false, "score": 0, "creation_date": 1461788821, "post_id": 36899404, "comment_id": 61364617, "body": "I have tried both versions just as you&#39;ve written them and the macro still results in a blank worksheet without the desired copied rows.  I am not sure why.  Certainly I am doing something incorrect, but I felt it worthwhile telling you.  I will experiment and hopefully find a solution.  Again, thanks so much for you assistance"}, {"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "reply_to_user": {"reputation": 23, "user_id": 6095396, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f655b32cfa8018b2a7aa3474bff85d1f?s=128&d=identicon&r=PG&f=1", "display_name": "Mac", "link": "https://stackoverflow.com/users/6095396/mac"}, "edited": false, "score": 0, "creation_date": 1461789104, "post_id": 36899404, "comment_id": 61364773, "body": "Make sure that your sheet that you are copying from is &quot;Active&quot; when you run this since you have <code>=activeSheet</code> in there. Make sure that <code>Aeronautic</code> is spelled the way that it appears in the sheet. Also, is <code>Aeronautic</code> the only thing in the cell, or does it appear with other text?"}, {"owner": {"reputation": 23, "user_id": 6095396, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f655b32cfa8018b2a7aa3474bff85d1f?s=128&d=identicon&r=PG&f=1", "display_name": "Mac", "link": "https://stackoverflow.com/users/6095396/mac"}, "edited": false, "score": 0, "creation_date": 1461789617, "post_id": 36899404, "comment_id": 61365055, "body": "The sheet I&#39;m working in is the only sheet in the workbook, so I assume it is &quot;Active.&quot;    I ran the macros with &quot;Aeronautic&quot; alone and also with a variation of one of the possible texts that would appear next to it in the cell &quot;Aeronautic Engineers.&quot;  Both variations returned nothing even though there are numerous instances of cells with &quot;Aeronautic Engineers&quot; in the range."}, {"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "reply_to_user": {"reputation": 23, "user_id": 6095396, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f655b32cfa8018b2a7aa3474bff85d1f?s=128&d=identicon&r=PG&f=1", "display_name": "Mac", "link": "https://stackoverflow.com/users/6095396/mac"}, "edited": false, "score": 0, "creation_date": 1461789714, "post_id": 36899404, "comment_id": 61365116, "body": "Next thing is to understand if your <code>For</code> loop is actually looking at rows. Do you have data in column <code>A</code> of your worksheet? If not then your loop isn&#39;t looping since it&#39;s determining which rows to loop on based on that column. Change to <code>NoRows = wsSource.Range(&quot;AE65536&quot;).End(xlUp).Row</code> and see if that helps."}, {"owner": {"reputation": 23, "user_id": 6095396, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f655b32cfa8018b2a7aa3474bff85d1f?s=128&d=identicon&r=PG&f=1", "display_name": "Mac", "link": "https://stackoverflow.com/users/6095396/mac"}, "edited": false, "score": 0, "creation_date": 1461790196, "post_id": 36899404, "comment_id": 61365384, "body": "Woohoo!  That fixed it.  Thanks so much!  A did have data but there were some blank columns between A and AE.  Wish this site had a way to send a virtual beer coupon, I&#39;d totally buy you one for this.  THANKS!! :)"}, {"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "reply_to_user": {"reputation": 23, "user_id": 6095396, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f655b32cfa8018b2a7aa3474bff85d1f?s=128&d=identicon&r=PG&f=1", "display_name": "Mac", "link": "https://stackoverflow.com/users/6095396/mac"}, "edited": false, "score": 0, "creation_date": 1461790242, "post_id": 36899404, "comment_id": 61365406, "body": "LOL. I get fake internet points and the knowledge that I was able to help someone with a frustrating problem... so we&#39;re all good."}], "tags": [], "owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "is_accepted": true, "score": 0, "last_activity_date": 1461788021, "last_edit_date": 1461788021, "creation_date": 1461785957, "answer_id": 36899404, "question_id": 36898854, "link": "https://stackoverflow.com/questions/36898854/vba-copy-entire-row-to-new-sheet-based-on-value-in-range/36899404#36899404", "title": "VBA Copy Entire Row to New Sheet Based on Value in Range", "body": "<p>Your problem is in your <code>j</code> loop:</p>\n\n<pre><code>For J = 0 To UBound(strArray)\n</code></pre>\n\n<p>The UpperBound (<code>Ubound</code>) of array <code>strArray</code> is 0. It's an array with a single element <code>\"Aeronautic\"</code>.</p>\n\n<p>So your loop is looping once and exiting.</p>\n\n<p>Instead try looping through your range:</p>\n\n<pre><code>For Each rngCell in rngCells.Cells\n    if rngCell.value = \"Aeronatic\" Then \n        Found = True\n        Exit For\n    End if\nNext rngCell\n</code></pre>\n\n<p>Here we loop through that <code>rngCells</code> range that you just made, cell by cell. Then we test if if the cell has the value you are looking for. If we find it, we set <code>found</code> to <code>true</code> and exit the for loop. You don't have to exit the for loop, but we found what we wanted, so there is no reason not to save some cpu time.</p>\n\n<hr>\n\n<p>Full code, removed unnecessary variables and moved a little bit around:</p>\n\n<pre><code>Sub MoveAero()\nDim wsSource As Worksheet\nDim wsDest As Worksheet\nDim NoRows As Long\nDim DestNoRows As Long\nDim I As Long\nDim J As Integer\nDim rngCells As Range\nDim rngCell as Range\n\nSet wsSource = ActiveSheet\n\nNoRows = wsSource.Range(\"A65536\").End(xlUp).Row\nDestNoRows = 1\nSet wsDest = ActiveWorkbook.Worksheets.Add\n\nFor I = 1 To NoRows\n\n    Set rngCells = wsSource.Range(\"AE\" &amp; I &amp; \":BF\" &amp; I)\n\n    For Each rngCell in rngCells.Cells\n        if rngCell.value = \"Aeronatic\" Then \n            'Moved this logic up from the IF block below\n            rngCells.EntireRow.Copy wsDest.Range(\"A\" &amp; DestNoRows)\n            DestNoRows = DestNoRows + 1\n            Exit For\n        End if\n    Next rngCell\n\nNext I\nEnd Sub\n</code></pre>\n\n<p>Alternatively, you could use that <code>.find</code> method of the <code>range</code> object instead of the second <code>For</code> loop. (Using both for your needs is unnecessary). </p>\n\n<pre><code>Sub MoveAero()\nDim wsSource As Worksheet\nDim wsDest As Worksheet\nDim NoRows As Long\nDim DestNoRows As Long\nDim I As Long\nDim rngCells As Range\n\nSet wsSource = ActiveSheet\n\nNoRows = wsSource.Range(\"A65536\").End(xlUp).Row\nDestNoRows = 1\nSet wsDest = ActiveWorkbook.Worksheets.Add\n\nFor I = 1 To NoRows\n\n    Set rngCells = wsSource.Range(\"AE\" &amp; I &amp; \":BF\" &amp; I)\n\n    'Try to find your search term in the range\n    If Not (rngCells.Find(\"Aeronautic\") Is Nothing) Then\n        rngCells.EntireRow.Copy wsDest.Range(\"A\" &amp; DestNoRows)\n        DestNoRows = DestNoRows + 1\n    End If\n\nNext I\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 6095396, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f655b32cfa8018b2a7aa3474bff85d1f?s=128&d=identicon&r=PG&f=1", "display_name": "Mac", "link": "https://stackoverflow.com/users/6095396/mac"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 674, "favorite_count": 0, "accepted_answer_id": 36899404, "answer_count": 1, "score": -1, "last_activity_date": 1461788068, "creation_date": 1461784266, "last_edit_date": 1531161705, "question_id": 36898854, "link": "https://stackoverflow.com/questions/36898854/vba-copy-entire-row-to-new-sheet-based-on-value-in-range", "title": "VBA Copy Entire Row to New Sheet Based on Value in Range", "body": "<p>Despite reading several threads searching for answers to similar problems I have been unable to debug my code on its own.  </p>\n\n<p>I am trying to write a macro that will search all cells between AE and BF for the term \"Aeronautics Engineers\" and then copy all rows that contain that term to a new sheet. The entire sheet has a total of 99289.    </p>\n\n<p>I have tried using the following code without any luck:</p>\n\n<pre><code>Sub MoveAero()\nDim strArray As Variant\nDim wsSource As Worksheet\nDim wsDest As Worksheet\nDim NoRows As Long\nDim DestNoRows As Long\nDim I As Long\nDim J As Integer\nDim rngCells As Range\nDim rngFind As Range\nDim Found As Boolean\n\nstrArray = Array(\"Aeronautic\")\n\nSet wsSource = ActiveSheet\n\nNoRows = wsSource.Range(\"A65536\").End(xlUp).Row\nDestNoRows = 1\nSet wsDest = ActiveWorkbook.Worksheets.Add\n\nFor I = 1 To NoRows\n\n    Set rngCells = wsSource.Range(\"AE\" &amp; I &amp; \":BF\" &amp; I)\n    Found = False\n    For J = 0 To UBound(strArray)\n        Found = Found Or Not (rngCells.Find(strArray(J)) Is Nothing)\n    Next J\n\n    If Found Then\n        rngCells.EntireRow.Copy wsDest.Range(\"A\" &amp; DestNoRows)\n\n        DestNoRows = DestNoRows + 1\n    End If\nNext I\nEnd Sub\n</code></pre>\n\n<p>Thanks for any assistance!</p>\n"}, {"tags": ["vba", "copy-paste"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1461783460, "post_id": 36898563, "comment_id": 61361276, "body": "What error message and on which line?"}, {"owner": {"reputation": 11, "user_id": 5101005, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/2c28862c71a071a081eb28bf24965a1b?s=128&d=identicon&r=PG&f=1", "display_name": "Ben", "link": "https://stackoverflow.com/users/5101005/ben"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1461783552, "post_id": 36898563, "comment_id": 61361341, "body": "Run time error &#39;1004&#39;: application defined or object defined error. It occurs on the pasting line. I have tried different variations of this to no avail. I have confirmed that it does work in selecting the correct cell, it will not paste though."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 5101005, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/2c28862c71a071a081eb28bf24965a1b?s=128&d=identicon&r=PG&f=1", "display_name": "Ben", "link": "https://stackoverflow.com/users/5101005/ben"}, "edited": false, "score": 0, "creation_date": 1461787636, "post_id": 36898831, "comment_id": 61363902, "body": "How would I paste into the worksheet using last row then? With this report I know that I will need columns A:AI, but the lastrow may change. As for the remaining variables they are used in the complete project, but I am only having trouble with this part."}, {"owner": {"reputation": 748, "user_id": 6209872, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d51589c2d23ee66dc43c65c410bbf70c?s=128&d=identicon&r=PG&f=1", "display_name": "yk11", "link": "https://stackoverflow.com/users/6209872/yk11"}, "reply_to_user": {"reputation": 11, "user_id": 5101005, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/2c28862c71a071a081eb28bf24965a1b?s=128&d=identicon&r=PG&f=1", "display_name": "Ben", "link": "https://stackoverflow.com/users/5101005/ben"}, "edited": false, "score": 0, "creation_date": 1461788174, "post_id": 36898831, "comment_id": 61364234, "body": "Can you please clarify what you are trying to copy? Your code indicates you are copying entire columns, not row based data."}, {"owner": {"reputation": 11, "user_id": 5101005, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/2c28862c71a071a081eb28bf24965a1b?s=128&d=identicon&r=PG&f=1", "display_name": "Ben", "link": "https://stackoverflow.com/users/5101005/ben"}, "edited": false, "score": 0, "creation_date": 1461788554, "post_id": 36898831, "comment_id": 61364455, "body": "The range would be A1:AI65523. I used the column format to capture the entire set without having to reference lastrow because the lastrow may change the next time I have to pull this report. I can use sht2.Range(Cells(1, 1), Cells(LR, 35)).Select to select the range I want, but how would I paste it into the first available row of the master worksheet?"}], "tags": [], "owner": {"reputation": 748, "user_id": 6209872, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d51589c2d23ee66dc43c65c410bbf70c?s=128&d=identicon&r=PG&f=1", "display_name": "yk11", "link": "https://stackoverflow.com/users/6209872/yk11"}, "is_accepted": false, "score": 0, "last_activity_date": 1461784176, "creation_date": 1461784176, "answer_id": 36898831, "question_id": 36898563, "link": "https://stackoverflow.com/questions/36898563/copy-and-paste-a-selection-based-on-lastrow/36898831#36898831", "title": "Copy and Paste a selection based on LastRow", "body": "<p>One issue I see is that you are trying to copy a range of columns <code>Range(\"A:AI\")</code> into a cell <code>Range(\"A\" &amp; NR)</code>.</p>\n\n<p>You can also improve your code</p>\n\n<ol>\n<li>Define <code>wsmaster</code> (I'm guessing it used to be <code>sht1</code>)</li>\n<li>Remove <code>LR</code> as it is not being used</li>\n<li>Remove the <code>With Thisworkbook</code> wrapper as it is not needed</li>\n</ol>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 5101005, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/2c28862c71a071a081eb28bf24965a1b?s=128&d=identicon&r=PG&f=1", "display_name": "Ben", "link": "https://stackoverflow.com/users/5101005/ben"}, "is_accepted": false, "score": 0, "last_activity_date": 1461789556, "creation_date": 1461789556, "answer_id": 36900418, "question_id": 36898563, "link": "https://stackoverflow.com/questions/36898563/copy-and-paste-a-selection-based-on-lastrow/36900418#36900418", "title": "Copy and Paste a selection based on LastRow", "body": "<p>I was able to figure it out</p>\n\n<pre><code>LR = Cells(Rows.Count, \"A\").End(xlUp).Row\nNR = Cells(Rows.Count, \"A\").End(xlUp).Row + 1\n\nsht2.Activate\nsht2.Range(Cells(1, 1), Cells(LR, 35)).Copy\nsht1.Activate\nsht1.Range(\"A\" &amp; NR).PasteSpecial Paste:=xlPasteValues\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 5101005, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/2c28862c71a071a081eb28bf24965a1b?s=128&d=identicon&r=PG&f=1", "display_name": "Ben", "link": "https://stackoverflow.com/users/5101005/ben"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 48, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1461789556, "creation_date": 1461783342, "question_id": 36898563, "link": "https://stackoverflow.com/questions/36898563/copy-and-paste-a-selection-based-on-lastrow", "title": "Copy and Paste a selection based on LastRow", "body": "<p>I am just trying to copy and paste a selection from one worksheet into the first blank row of another master worksheet. I plan to do this with a few different worksheets, but I can't understand why I keep getting an error message.</p>\n\n<pre><code>Dim sht1 As Worksheet\nDim sht2 As Worksheet\nDim sht3 As Worksheet\nDim shape As Excel.shape\n\nSet wsmaster = Sheets(\"Sheet 1\")\nSet sht2 = Sheets(\"Sheet 2\")\nSet sht3 = Sheets(\"Sheet 3\")\n\nLR = wsmaster.Range(\"A\" &amp; Rows.Count).End(xlUp).Row\nNR = wsmaster.Range(\"A\" &amp; Rows.Count).End(xlUp).Row + 1\n\nWith ThisWorkbook\nsht2.Range(\"A:AI\").Copy\nwsmaster.Range(\"A\" &amp; NR).PasteSpecial Paste:=pastevalues\nEnd With\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1461782074, "post_id": 36898031, "comment_id": 61360399, "body": "can you check another value, so If .Range(&quot;F7&quot;) = &quot;&quot; and .Range(&quot;G7&quot;)&lt;&gt; &quot;&quot;"}], "answers": [{"comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 1, "creation_date": 1461785302, "post_id": 36898272, "comment_id": 61362461, "body": "or add as the first line if environ(&quot;Username&quot;)=your username then exit sub"}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": true, "score": 4, "last_activity_date": 1461783333, "last_edit_date": 1461783333, "creation_date": 1461782471, "answer_id": 36898272, "question_id": 36898031, "link": "https://stackoverflow.com/questions/36898031/mandatory-fields-red-now-how-to-save/36898272#36898272", "title": "Mandatory fields red. Now how to save?", "body": "<p>If you are in the middle of development and want to \"break the rules\" and save your current efforts, then in a standard module:</p>\n\n<pre><code>Sub MyPrivateSave()\n    Application.EnableEvents = False\n    ThisWorkbook.Save\n    Application.EnableEvents = True\nEnd Sub\n</code></pre>\n\n<p>Of course, when you finish development, you would remove this little \"save tool\" before you send the workbook out to the users.</p>\n"}, {"comments": [{"owner": {"reputation": 31, "user_id": 5975247, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04fcab60073ece63fc96fae05cdb283e?s=128&d=identicon&r=PG", "display_name": "Solomon3y", "link": "https://stackoverflow.com/users/5975247/solomon3y"}, "edited": false, "score": 0, "creation_date": 1462216608, "post_id": 36908821, "comment_id": 61534050, "body": "This makes the most sense, but I&#39;m having trouble implementing this code. Should I ask a separate question or can I post it here?"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "reply_to_user": {"reputation": 31, "user_id": 5975247, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04fcab60073ece63fc96fae05cdb283e?s=128&d=identicon&r=PG", "display_name": "Solomon3y", "link": "https://stackoverflow.com/users/5975247/solomon3y"}, "edited": false, "score": 0, "creation_date": 1462281703, "post_id": 36908821, "comment_id": 61563079, "body": "What issues are you having?"}, {"owner": {"reputation": 31, "user_id": 5975247, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04fcab60073ece63fc96fae05cdb283e?s=128&d=identicon&r=PG", "display_name": "Solomon3y", "link": "https://stackoverflow.com/users/5975247/solomon3y"}, "edited": false, "score": 0, "creation_date": 1462382517, "post_id": 36908821, "comment_id": 61618427, "body": "It seems when I add this code, it does not actually Exit the sub, but continues to the next line."}], "tags": [], "owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "is_accepted": false, "score": 1, "last_activity_date": 1461830938, "creation_date": 1461830938, "answer_id": 36908821, "question_id": 36898031, "link": "https://stackoverflow.com/questions/36898031/mandatory-fields-red-now-how-to-save/36908821#36908821", "title": "Mandatory fields red. Now how to save?", "body": "<p>or add as the first line <code>if environ(\"Username\")=your username then exit sub</code></p>\n"}], "owner": {"reputation": 31, "user_id": 5975247, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04fcab60073ece63fc96fae05cdb283e?s=128&d=identicon&r=PG", "display_name": "Solomon3y", "link": "https://stackoverflow.com/users/5975247/solomon3y"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 64, "favorite_count": 0, "accepted_answer_id": 36898272, "answer_count": 2, "score": 0, "last_activity_date": 1461830938, "creation_date": 1461781695, "last_edit_date": 1495540775, "question_id": 36898031, "link": "https://stackoverflow.com/questions/36898031/mandatory-fields-red-now-how-to-save", "title": "Mandatory fields red. Now how to save?", "body": "<p>What it does: Requires fields from users. Blocks user from saving if specific fields are missing. Turns those fields red until saved correctly.</p>\n\n<p>What I need: Well, how the hell am I supposed to save this...</p>\n\n<p>What I would like: Since the worksheet is blank. I cannot save. and required fields are red. EVEN if I could save I would LIKE the cells to be on no fill until I roll it out. </p>\n\n<p><a href=\"https://stackoverflow.com/questions/13529234/excel-vba-colour-mandatory-field-cell-if-there-is-no-entry-and-show-message-b\">View Original Post Here</a></p>\n\n<pre><code>Private Sub Workbook_BeforeSave(ByVal SaveAsUI As Boolean, Cancel As Boolean)\n\nDim xlSht As Worksheet\nDim cellsNotPopulated As Boolean\ncellsNotPopulated = False\n\nSet xlSht = ThisWorkbook.Worksheets(\"1st Call\")\n\n    With xlSht\n\n        If .Range(\"F7\") = \"\" Then\n            .Range(\"F7\").Interior.Color = RGB(255, 0, 0)\n            cellsNotPopulated = True\n        Else\n            .Range(\"F7\").Interior.ColorIndex = xlNone\n        End If\n    End With\n\n    If cellsNotPopulated = True Then\n        MsgBox \"Please review the highlighted cells and ensure the fields are populated.\"\n        Cancel = True\n    End If\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 0, "creation_date": 1461781296, "post_id": 36897716, "comment_id": 61359886, "body": "You probably need a Calculate Event macro to detect the result of the <b>B25</b> formulas actions and some <code>OnTime</code> macros to control the blinking."}], "answers": [{"tags": [], "owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "is_accepted": false, "score": 0, "last_activity_date": 1461782716, "creation_date": 1461782716, "answer_id": 36898345, "question_id": 36897716, "link": "https://stackoverflow.com/questions/36897716/excel-vba-script-detects-value-in-cell-causes-sheet-to-blink-until-clicked-on/36898345#36898345", "title": "Excel VBA script detects value in cell, causes sheet to blink until clicked on", "body": "<p>You may run into further issues down the road with these requirements, but a good start is to work from your Worksheet's Change event. </p>\n\n<p>In your VBE, go to your worksheet that contains the cell you are tracking and drop down the box at the top of the code to select \"Worksheet\", then drop down the box to the left and choose \"Change\".</p>\n\n<p>This will create a new subroutine in that worksheet's VBA code called <code>Worksheet_Change()</code></p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\nEnd Sub\n</code></pre>\n\n<p>This has a parameter called <code>Target</code> that is loaded by default with <code>Range</code> that had the <code>change</code> that caused this subroutine to fire. To detect which cell it was you can use <code>INTERSECT</code>:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n     If Not Intersect(Target, Range(\"B25\")) Is Nothing Then\n          If Target.Value = \"True\" Then Call Test\n     End if\nEnd Sub\n</code></pre>\n\n<p>So here we detect which cell changed, and then we call the test subroutine if it's <code>B25</code> and the value is <code>True</code>.</p>\n\n<p>In your <code>Test()</code> subroutine, you can take out lines that reference <code>B25</code> since we are doing the detecting here in the <code>Worksheet_Change()</code> event subroutine.</p>\n\n<p>Once you get that squared away, the <code>Application.OnTime</code> method will allow you to set up a schedule where a macro is called (say 1 second from current time) and then that macro will toggle the color, but that's the next hurdle. The first is getting this thing triggered from a worksheet change. </p>\n"}], "owner": {"reputation": 11, "user_id": 6262921, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cfcf0430c56001dcf92c4f674e63d3d6?s=128&d=identicon&r=PG", "display_name": "M. West", "link": "https://stackoverflow.com/users/6262921/m-west"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 434, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1461784205, "creation_date": 1461780682, "last_edit_date": 1531164843, "question_id": 36897716, "link": "https://stackoverflow.com/questions/36897716/excel-vba-script-detects-value-in-cell-causes-sheet-to-blink-until-clicked-on", "title": "Excel VBA script detects value in cell, causes sheet to blink until clicked on", "body": "<p>I have created a dashboard that users will be copy and pasting a log into. The dashboard will do some analysis on the data on several sheets with formulas only. </p>\n\n<p>I would like to set up a VBA script that, when a formula comes out to TRUE in B25, that the sheet will blank back and fourth from green to red until the user clicks on the sheet tab and end the loop. I'm very new to VBA and scraped some code from a macro to make an attempt. Here is what I have:</p>\n\n<pre><code>Sub Test()\n\nIf Range(\"B25\").Value = \"TRUE\" Then\n\nDo Until Sheets(\"Dilutions\").Activate\n\nWith ActiveWorkbook.Sheets(\"Dilutions\").Tab\n    .ThemeColor = xlThemeColorAccent3\n    .TintAndShade = -0.249977111117893\nEnd With\n\nApplication.Wait (Now + #12:00:01 AM#)\n\nWith ActiveWorkbook.Sheets(\"Dilutions\").Tab\n    .ThemeColor = xlThemeColorAccent2\n    .TintAndShade = -0.249977111117893\nEnd With\n\nApplication.Wait (Now + #12:00:01 AM#)\nLoop\nEnd If\nEnd Sub\n</code></pre>\n\n<p>When running the script where TRUE is found in B25 the sheet tab does not change colors. I don't get any error messages with my code, so I'm at a loss at where to start troubleshooting. I have made sure that I do not have the \"Dilutions\" sheet selected when testing the macro and that B25 does evaluate to true.</p>\n\n<p>Any help on this would be most welcome. I will continue to play with this / if I find out the solution I will follow up. Thank you!</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1461780422, "post_id": 36897577, "comment_id": 61359338, "body": "And the normal Sort function on the ribbon does not work?  Please show an example that would not sort properly with the sort function on the ribbon. The above will."}, {"owner": {"reputation": 1, "user_id": 3404354, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f50fa3a785265e0490eb740d8712384e?s=128&d=identicon&r=PG&f=1", "display_name": "user3404354", "link": "https://stackoverflow.com/users/3404354/user3404354"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1461782373, "post_id": 36897577, "comment_id": 61360585, "body": "Sorry I should have been more specific. I want to be able to change the input range and have the results update automatically in the second range."}], "answers": [{"tags": [], "owner": {"reputation": 748, "user_id": 6209872, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d51589c2d23ee66dc43c65c410bbf70c?s=128&d=identicon&r=PG&f=1", "display_name": "yk11", "link": "https://stackoverflow.com/users/6209872/yk11"}, "is_accepted": false, "score": 0, "last_activity_date": 1461783135, "creation_date": 1461783135, "answer_id": 36898479, "question_id": 36897577, "link": "https://stackoverflow.com/questions/36897577/arrange-cells-in-range-based-on-size-of-string/36898479#36898479", "title": "Arrange Cells in range based on size of string", "body": "<p>I suggest solving this problem as a two pronged approach:</p>\n\n<ol>\n<li>Create a function to convert UTF8 to Unicode (see <a href=\"https://stackoverflow.com/questions/23810324/vba-convert-string-to-unicode\">VBA - Convert string to UNICODE</a>)</li>\n<li>Create a column to store the results of the function for each row's string value</li>\n<li>Sort your data using the built-in sort based on the Unicode value column</li>\n</ol>\n"}], "owner": {"reputation": 1, "user_id": 3404354, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f50fa3a785265e0490eb740d8712384e?s=128&d=identicon&r=PG&f=1", "display_name": "user3404354", "link": "https://stackoverflow.com/users/3404354/user3404354"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 49, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1461785000, "creation_date": 1461780291, "last_edit_date": 1461785000, "question_id": 36897577, "link": "https://stackoverflow.com/questions/36897577/arrange-cells-in-range-based-on-size-of-string", "title": "Arrange Cells in range based on size of string", "body": "<p>I am wondering if it is possible for excel to sort a range of cells based on the sum of the unicode values of the text in the string.  </p>\n\n<p>For example, I have a range as shown below</p>\n\n<pre><code>abc  \nbde  \nfgh  \nbbc  \n</code></pre>\n\n<p>and the result of the formula would produce in a seperate range</p>\n\n<pre><code>abc\nbbc\nbde\nfgh\n</code></pre>\n\n<p>I am not sure if this type of thing would require a vba solution or if there is a way to use array functions to get this result.  </p>\n\n<p>Any help would be greatly appreciated.  </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 833, "user_id": 5002793, "user_type": "registered", "accept_rate": 33, "profile_image": "https://lh6.googleusercontent.com/-EcmwXD-5qGw/AAAAAAAAAAI/AAAAAAAACqQ/wLjCO2xNuug/photo.jpg?sz=128", "display_name": "Rehban Khatri", "link": "https://stackoverflow.com/users/5002793/rehban-khatri"}, "edited": false, "score": 0, "creation_date": 1461779725, "post_id": 36897303, "comment_id": 61358896, "body": "So you want to remove the last digit from a number, but only if the last digit is either 0 or 1, right?. Divide it by 10 and round it off. I hope that works"}, {"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1461779730, "post_id": 36897303, "comment_id": 61358898, "body": "You can use <code>Str(num)</code> to ge the number as a string. Then yiu can use character manipulation such as <code>mid</code> to keep only what you want, then put it back."}, {"owner": {"reputation": 11, "user_id": 4130717, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Mpc4v2FMZCc/AAAAAAAAAAI/AAAAAAAAAPg/uqu2UUR7IC4/photo.jpg?sz=128", "display_name": "Sara Goldsworthy", "link": "https://stackoverflow.com/users/4130717/sara-goldsworthy"}, "edited": false, "score": 0, "creation_date": 1461780556, "post_id": 36897303, "comment_id": 61359408, "body": "If I use your &#39;Str(num)&#39; method, how do I get it back into its original cell?"}, {"owner": {"reputation": 116, "user_id": 6229756, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0YZvj.jpg?s=128&g=1", "display_name": "Jason Conway", "link": "https://stackoverflow.com/users/6229756/jason-conway"}, "edited": false, "score": 0, "creation_date": 1461782269, "post_id": 36897303, "comment_id": 61360520, "body": "You could do this with a formula using =TEXT(&lt;string&gt;,&quot;000&quot;)"}], "owner": {"reputation": 11, "user_id": 4130717, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Mpc4v2FMZCc/AAAAAAAAAAI/AAAAAAAAAPg/uqu2UUR7IC4/photo.jpg?sz=128", "display_name": "Sara Goldsworthy", "link": "https://stackoverflow.com/users/4130717/sara-goldsworthy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 81, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1461783162, "creation_date": 1461779471, "last_edit_date": 1461779606, "question_id": 36897303, "link": "https://stackoverflow.com/questions/36897303/shortening-numbers-in-vba", "title": "Shortening numbers in VBA", "body": "<p>I have a document that has numbers such as </p>\n\n<pre><code>4100.0\n4201.0\n4300.1\n</code></pre>\n\n<p>but I need them in the format of</p>\n\n<pre><code>410\n420\n430\n</code></pre>\n\n<p>I'm trying to write a global excel macro in VBA (first time using VBA) to do this but seem to have hit a road block. This is what I have so far:</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n\nDim ItemNum As Range\n\nFor Each num In ItemNum\n\n\nEnd Sub\n</code></pre>\n\n<p>ItemNum.NumberFormat (\"000\")</p>\n\n<p>I have figured out how to walk through a defined range and I found range.numberformat but that only gets rid of the decimals, not the final 0 / 1. I also can't figure out how to make it accessible to all of my spreadsheets.</p>\n\n<p>Any other suggestions?</p>\n"}, {"tags": ["excel", "optimization", "excel-formula", "vba"], "comments": [{"owner": {"reputation": 1, "user_id": 6262933, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-KZKckxbR2OU/AAAAAAAAAAI/AAAAAAAABos/teRUe7bKahk/photo.jpg?sz=128", "display_name": "Jeff Settle", "link": "https://stackoverflow.com/users/6262933/jeff-settle"}, "edited": false, "score": 0, "creation_date": 1461779322, "post_id": 36897199, "comment_id": 61358627, "body": "That optimizes the sum of the average score*"}, {"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1461779723, "post_id": 36897199, "comment_id": 61358894, "body": "Filter for salaries &lt; $50,000, sort by average score descending (so highest is on top) and then the first 6 are what you&#39;re looking for."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1461779794, "post_id": 36897199, "comment_id": 61358949, "body": "@tigeravatar I think Op wants the total sum of the salaries under 50,000 not the individual.  But I have been off today on my understanding so yours may be correct."}, {"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 1, "creation_date": 1461779803, "post_id": 36897199, "comment_id": 61358955, "body": "Unless golfers just do not get paid well at all, $50,000 total salary spread among 6 people? That&#39;s an average of $8333.33 per person which is way under minimum wage O.o"}, {"owner": {"reputation": 1, "user_id": 6262933, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-KZKckxbR2OU/AAAAAAAAAAI/AAAAAAAABos/teRUe7bKahk/photo.jpg?sz=128", "display_name": "Jeff Settle", "link": "https://stackoverflow.com/users/6262933/jeff-settle"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1461780952, "post_id": 36897199, "comment_id": 61359670, "body": "@ScottCraner, correct.  There&#39;s a list of golfers where salary ranges from 12,500 - 5,000.  Each golfer also has average points per tournament  I want to find the combination of six golfers that maximizes the sum of the six golfers average while keeping their cumulative salary under the 50,000 cap"}, {"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 1, "creation_date": 1461782218, "post_id": 36897199, "comment_id": 61360490, "body": "As a note, the number of combinations of 6 golfers from a pool of 153 is <code>16,133,132,940</code>  Note that yes, that is over 16 <i>billion</i> combinations.  Even if Solver can do it, it will probably crash Excel."}, {"owner": {"reputation": 1, "user_id": 6262933, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-KZKckxbR2OU/AAAAAAAAAAI/AAAAAAAABos/teRUe7bKahk/photo.jpg?sz=128", "display_name": "Jeff Settle", "link": "https://stackoverflow.com/users/6262933/jeff-settle"}, "reply_to_user": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1461787709, "post_id": 36897199, "comment_id": 61363943, "body": "@tigeravatar you&#39;re right.  maybe another program like matlab or something would do the trick.  just have to figure out how to write the math!"}, {"owner": {"reputation": 10888, "user_id": 5625534, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/d4mCF.jpg?s=128&g=1", "display_name": "Erwin Kalvelagen", "link": "https://stackoverflow.com/users/5625534/erwin-kalvelagen"}, "reply_to_user": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 1, "creation_date": 1461796643, "post_id": 36897199, "comment_id": 61368373, "body": "@tigeravatar I don&#39;t see why Excel would crash on a simple model like this, In fact I tried it with some random data for 153 players and Excel solves it just fine. Note that it will use a MIP solver that is smarter than just evaluating all possible combinations,"}, {"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "reply_to_user": {"reputation": 10888, "user_id": 5625534, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/d4mCF.jpg?s=128&g=1", "display_name": "Erwin Kalvelagen", "link": "https://stackoverflow.com/users/5625534/erwin-kalvelagen"}, "edited": false, "score": 0, "creation_date": 1461796917, "post_id": 36897199, "comment_id": 61368479, "body": "@ErwinKalvelagen I am personally not very familiar with the Excel Solver add-in so unfortunately I am unable to provide a working solution.  If you have a solution that the OP can implement, you should post it as an answer so the OP can test it and select your answer for future users who have a similar issue."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 6262933, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-KZKckxbR2OU/AAAAAAAAAAI/AAAAAAAABos/teRUe7bKahk/photo.jpg?sz=128", "display_name": "Jeff Settle", "link": "https://stackoverflow.com/users/6262933/jeff-settle"}, "edited": false, "score": 0, "creation_date": 1462891874, "post_id": 36902377, "comment_id": 61822502, "body": "I set up the equation the way you said and it returns an error that says:  &quot;Solver can not find a point for which all constraints are satisfied.&quot;  It optimizes for score and six golfers, but does not do so within the Salary constraints.  (note:  i do have constraint SUM of Salary set to &lt;= 50000)  @erwin kalvelagen"}, {"owner": {"reputation": 10888, "user_id": 5625534, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/d4mCF.jpg?s=128&g=1", "display_name": "Erwin Kalvelagen", "link": "https://stackoverflow.com/users/5625534/erwin-kalvelagen"}, "reply_to_user": {"reputation": 1, "user_id": 6262933, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-KZKckxbR2OU/AAAAAAAAAAI/AAAAAAAABos/teRUe7bKahk/photo.jpg?sz=128", "display_name": "Jeff Settle", "link": "https://stackoverflow.com/users/6262933/jeff-settle"}, "edited": false, "score": 0, "creation_date": 1462916969, "post_id": 36902377, "comment_id": 61837074, "body": "It is also possible your data is &quot;wrong&quot; and there is no feasible solution to your problem. Make sure the 6 cheapest players are within the budget,"}], "tags": [], "owner": {"reputation": 10888, "user_id": 5625534, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/d4mCF.jpg?s=128&g=1", "display_name": "Erwin Kalvelagen", "link": "https://stackoverflow.com/users/5625534/erwin-kalvelagen"}, "is_accepted": false, "score": 1, "last_activity_date": 1461962282, "last_edit_date": 1461962282, "creation_date": 1461797872, "answer_id": 36902377, "question_id": 36897199, "link": "https://stackoverflow.com/questions/36897199/optimization-of-a-list-in-excel-with-variables/36902377#36902377", "title": "Optimization of a list in Excel with Variables", "body": "<p>This is a simple optimization problem that can be solved using Excel solver (just use \"Simplex Lp solver\" -- somewhat of a misnomer as we will use it here to solve an integer programming or MIP problem).</p>\n\n<p>You need one column with 153 binary (BIN) variables (Excels limit is I believe 200). Make sure you add a constraint to set the values to Binary. Lets call this column INCLUDE; Solver will fill it with 0 or 1 values. Sum these values, and add a constraint with SUMINCLUDE=6. Then add a column with INCLUDE * SCORE. Sum this column and this is your objective (optimizing the average is the same as optimizing the sum). Then add a column with INCLUDE*SALARY and sum these. Add a constraint with SUMSALARY &lt;= 50k. Press solve and done.</p>\n\n<p>I don't agree with claims that Excel will crash on this or that this does not fit within the limits of Excels solver. (I really tried this out).</p>\n\n<p>I prefer the simplex method above the evolutionary solver as the simplex solver is more suitable for this problem: it is faster (simplex takes &lt; 1 seconds) and provides optimal solutions (evolutionary solver gives often suboptimal solutions).</p>\n\n<p>If you want to solve this problem with Matlab a function to look at is <code>intlinprog</code> (Optimization Toolbox).</p>\n\n<p>To be complete: this is the mathematical model we are solving here:</p>\n\n<p><a href=\"https://i.stack.imgur.com/U7Xjo.gif\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/U7Xjo.gif\" alt=\"enter image description here\"></a></p>\n\n<p>Results with random data:</p>\n\n<p><a href=\"https://i.stack.imgur.com/JzWPp.gif\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/JzWPp.gif\" alt=\"enter image description here\"></a></p>\n\n<p>....</p>\n\n<p><a href=\"https://i.stack.imgur.com/2shB7.gif\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/2shB7.gif\" alt=\"enter image description here\"></a></p>\n"}, {"comments": [{"owner": {"reputation": 4425, "user_id": 669883, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de87da844b7db7c21235b5d9560fc0e7?s=128&d=identicon&r=PG", "display_name": "Brian Camire", "link": "https://stackoverflow.com/users/669883/brian-camire"}, "edited": false, "score": 0, "creation_date": 1461852605, "post_id": 36904096, "comment_id": 61396340, "body": "The built-in version of Solver reports, &quot;This problem is too large for Solver to handle.&quot;  To get around this, you could buy the full version of Solver and use that.  However, in this problem, the objective and constraints are all linear functions of the 0-1 decision variables.  This means that, an alternative is the free OpenSolver add-in (see opensolver.org), which has no artificial limitations on the size of the problem (but can only solve linear problems).  In my case, it solved the original problem above in a few seconds with an average score of 85."}, {"owner": {"reputation": 1, "user_id": 6262933, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-KZKckxbR2OU/AAAAAAAAAAI/AAAAAAAABos/teRUe7bKahk/photo.jpg?sz=128", "display_name": "Jeff Settle", "link": "https://stackoverflow.com/users/6262933/jeff-settle"}, "edited": false, "score": 0, "creation_date": 1462892533, "post_id": 36904096, "comment_id": 61822986, "body": "Why did you set solver to &quot;min&quot; $h$2 instead of &quot;max&quot; $h$2?"}, {"owner": {"reputation": 2089, "user_id": 2901085, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jxiyV.jpg?s=128&g=1", "display_name": "OldUgly", "link": "https://stackoverflow.com/users/2901085/oldugly"}, "edited": false, "score": 0, "creation_date": 1462896290, "post_id": 36904096, "comment_id": 61825610, "body": "H2 is the average score. In golf, a lower score is better - unless there&#39;s some other criteria I missed."}], "tags": [], "owner": {"reputation": 2089, "user_id": 2901085, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jxiyV.jpg?s=128&g=1", "display_name": "OldUgly", "link": "https://stackoverflow.com/users/2901085/oldugly"}, "is_accepted": false, "score": 2, "last_activity_date": 1461809762, "creation_date": 1461809762, "answer_id": 36904096, "question_id": 36897199, "link": "https://stackoverflow.com/questions/36897199/optimization-of-a-list-in-excel-with-variables/36904096#36904096", "title": "Optimization of a list in Excel with Variables", "body": "<p>Illustrating a solution that is pretty close to what @ErwinKalvelagen suggested.</p>\n\n<ol>\n<li>Column A is the names of the 153 golfers</li>\n<li>Column B is the golfers salaries (generated by <code>=RANDBETWEEN(50, 125)*100</code>, filled down, then Copy/Paste Values)</li>\n<li>Column C is the golfers average scores (generated by <code>=RANDBETWEEN(70, 85)</code>, filled down, then Copy/Paste Values)</li>\n<li>Column D is a 0 or 1 to indicate if the golfer is included.</li>\n<li>Cell <code>F2</code> is the total salary, given by <code>=SUMPRODUCT(B2:B154,D2:D154)</code></li>\n<li>Cell <code>G2</code> is the number of golfers, given by <code>=SUM(D2:D154)</code></li>\n<li>Cell <code>H2</code> is the average score of the team, given by <code>=SUMPRODUCT(C2:C154,D2:D154)/G2</code></li>\n</ol>\n\n<p>The page looks like this, before setting up Solver ...</p>\n\n<p><a href=\"https://i.stack.imgur.com/RsJn5.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/RsJn5.png\" alt=\"enter image description here\"></a></p>\n\n<p>The Solver setup looks like this ...</p>\n\n<p><a href=\"https://i.stack.imgur.com/WbfuN.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/WbfuN.png\" alt=\"enter image description here\"></a></p>\n\n<p>According to the help, it says to use Evolutionary engine for non-smooth problems. In Options, I needed to increase the Maximum Time without improvement from 30 to 300 (60 may have been good enough). </p>\n\n<p><a href=\"https://i.stack.imgur.com/57n2G.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/57n2G.png\" alt=\"enter image description here\"></a></p>\n\n<p>It took a couple of minutes for it to complete. It reached the solution of 70 fairly quickly, but spent more time looking for a better answer.</p>\n\n<p><a href=\"https://i.stack.imgur.com/zrbNj.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/zrbNj.png\" alt=\"enter image description here\"></a></p>\n\n<p>And here are the six golfers it came up with.</p>\n\n<p><a href=\"https://i.stack.imgur.com/ueubZ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ueubZ.png\" alt=\"enter image description here\"></a></p>\n\n<p>Of the golfers with an average of 70, it could have found a lower salary.</p>\n\n<p><a href=\"https://i.stack.imgur.com/eqEmP.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/eqEmP.png\" alt=\"enter image description here\"></a></p>\n\n<p>In Cell <code>I2</code> added the formula <code>=F2+F2*(H2-70)</code> which is essentially salary penalized by increases in average score above 70 ...</p>\n\n<p><a href=\"https://i.stack.imgur.com/3tPA0.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/3tPA0.png\" alt=\"enter image description here\"></a></p>\n\n<p>... and use the same Solver setup, except to minimize Cell <code>I2</code> instead of <code>H2</code> ...</p>\n\n<p><a href=\"https://i.stack.imgur.com/oVwlD.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/oVwlD.png\" alt=\"enter image description here\"></a></p>\n\n<p>and these are the golfers it chose ...</p>\n\n<p><a href=\"https://i.stack.imgur.com/ogCZ8.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ogCZ8.png\" alt=\"enter image description here\"></a></p>\n\n<p>Again - it looks like there is still a better solution. It could have picked Name97 instead of Name96.</p>\n"}], "owner": {"reputation": 1, "user_id": 6262933, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-KZKckxbR2OU/AAAAAAAAAAI/AAAAAAAABos/teRUe7bKahk/photo.jpg?sz=128", "display_name": "Jeff Settle", "link": "https://stackoverflow.com/users/6262933/jeff-settle"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1578, "favorite_count": 1, "answer_count": 2, "score": 0, "last_activity_date": 1461962282, "creation_date": 1461779191, "last_edit_date": 1531161705, "question_id": 36897199, "link": "https://stackoverflow.com/questions/36897199/optimization-of-a-list-in-excel-with-variables", "title": "Optimization of a list in Excel with Variables", "body": "<p>I have a list of 153 golfers with associated salaries and average scores.  </p>\n\n<p>I want to find the combination of 6 golfers that optimizes avg score and keeps salary under $50,000.  </p>\n\n<p>I've tried using Solver, but I am stuck!  Can anyone help please?  :)</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1461777611, "post_id": 36896555, "comment_id": 61357496, "body": "I&#39;ve just tried Cancel = Not Sheets(1).ProtectContents and it works fine.  Have you stepped through the code?"}, {"owner": {"reputation": 5345, "user_id": 3561813, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/958afeca6b11ffa0e83b97b516c88dc7?s=128&d=identicon&r=PG&f=1", "display_name": "basodre", "link": "https://stackoverflow.com/users/3561813/basodre"}, "edited": false, "score": 0, "creation_date": 1461777921, "post_id": 36896555, "comment_id": 61357722, "body": "Are you certain that the Worksheet at Index 1 actually points the sheet you are testing against? You can quickly test this using the Immediate Window in the VBE. (Press CTRL + G to open Immediate Window, then type <code>? Sheets(1).Name</code> )"}, {"owner": {"reputation": 26278, "user_id": 293078, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/5437f5b4fa32bd95e6825f93a2b91a50?s=128&d=identicon&r=PG", "display_name": "Doug Glancy", "link": "https://stackoverflow.com/users/293078/doug-glancy"}, "edited": false, "score": 0, "creation_date": 1461778309, "post_id": 36896555, "comment_id": 61357974, "body": "I pasted your code into the ThisWorkbook module of a new workbook. When I tried to close it I got the message and the workbook remained open. So, it worked for me. I can&#39;t think of how you&#39;d get the MsgBox but not have it Cancel."}, {"owner": {"reputation": 1027, "user_id": 2543601, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/40e3e80e7c8697ec26e33e49cb8336bc?s=128&d=identicon&r=PG", "display_name": "Jarom", "link": "https://stackoverflow.com/users/2543601/jarom"}, "edited": false, "score": 0, "creation_date": 1461778446, "post_id": 36896555, "comment_id": 61358066, "body": "That&#39;s strange, I also opened a new workbook and pasted the code and it still closed after displaying the message box.  It looks like the issue might not be with the code."}, {"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1461778992, "post_id": 36896555, "comment_id": 61358427, "body": "I copied only one line into a new / empty Excel file: <code>Cancel = False</code>. So, essentially, you can never close the file. When I tried to close it I got cancelled (as expected). Yet, if I immediately thereafter attempt (again) to close the file again then I can do so without the event firing up. Only if I do something between the two close attempts then it is firing the workbook close event again. Maybe there is something to prevent infinite loops?"}, {"owner": {"reputation": 26278, "user_id": 293078, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/5437f5b4fa32bd95e6825f93a2b91a50?s=128&d=identicon&r=PG", "display_name": "Doug Glancy", "link": "https://stackoverflow.com/users/293078/doug-glancy"}, "edited": false, "score": 1, "creation_date": 1461781274, "post_id": 36896555, "comment_id": 61359869, "body": "I assume you mean <code>Cancel = True</code>?"}, {"owner": {"reputation": 26278, "user_id": 293078, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/5437f5b4fa32bd95e6825f93a2b91a50?s=128&d=identicon&r=PG", "display_name": "Doug Glancy", "link": "https://stackoverflow.com/users/293078/doug-glancy"}, "edited": false, "score": 0, "creation_date": 1461781530, "post_id": 36896555, "comment_id": 61360036, "body": "If I paste <code>Cancel = True</code> into the ThisWorkbook module&#39;s Workbook_BeforeClose event, I can&#39;t close it no matter how many times I try. So, I can&#39;t reproduce what you commented on above. Perhaps you&#39;ve got an addin running that&#39;s somehow messing with your events although, as I said in my first comment, hard to know how you&#39;d only get half an event to run. Is this a Windows machine?"}, {"owner": {"reputation": 1027, "user_id": 2543601, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/40e3e80e7c8697ec26e33e49cb8336bc?s=128&d=identicon&r=PG", "display_name": "Jarom", "link": "https://stackoverflow.com/users/2543601/jarom"}, "edited": false, "score": 0, "creation_date": 1461781895, "post_id": 36896555, "comment_id": 61360272, "body": "Yes it is a windows machine.  Are there certain add ins that have a reputation of messing things up?"}, {"owner": {"reputation": 26278, "user_id": 293078, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/5437f5b4fa32bd95e6825f93a2b91a50?s=128&d=identicon&r=PG", "display_name": "Doug Glancy", "link": "https://stackoverflow.com/users/293078/doug-glancy"}, "edited": false, "score": 0, "creation_date": 1461782899, "post_id": 36896555, "comment_id": 61360926, "body": "Please also answer my question three comments up and confirm you meant to say <code>Cancel = True</code>. As to addins that mess things up, they are generally ones you wrote yourself :-). If you have any installed, you could try uninstalling them. Restarting Excel would also be good. If it was me I&#39;d assume I&#39;ve done something silly until proven otherwise. I wish I had more for you than that. One tip, when replying to a comment, do like &quot;@DougGlancy&quot; so that SO let&#39;s me know you replied."}, {"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "reply_to_user": {"reputation": 26278, "user_id": 293078, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/5437f5b4fa32bd95e6825f93a2b91a50?s=128&d=identicon&r=PG", "display_name": "Doug Glancy", "link": "https://stackoverflow.com/users/293078/doug-glancy"}, "edited": false, "score": 0, "creation_date": 1461783273, "post_id": 36896555, "comment_id": 61361167, "body": "@DougGlancy: yes, of course: <code>Cancel = True</code>. Sorry for the typo. Yet, I can sincerely say that there is no Add-On, modification, or anything special about my Excel setup. Just an ordinary Windows 7 64bit machine. Maybe it is something about Office 2016?"}, {"owner": {"reputation": 26278, "user_id": 293078, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/5437f5b4fa32bd95e6825f93a2b91a50?s=128&d=identicon&r=PG", "display_name": "Doug Glancy", "link": "https://stackoverflow.com/users/293078/doug-glancy"}, "edited": false, "score": 0, "creation_date": 1461783385, "post_id": 36896555, "comment_id": 61361240, "body": "Nope, I&#39;ve been testing with Office 2016. Seriously, it&#39;s very likely something unique to you and your computer."}, {"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "reply_to_user": {"reputation": 26278, "user_id": 293078, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/5437f5b4fa32bd95e6825f93a2b91a50?s=128&d=identicon&r=PG", "display_name": "Doug Glancy", "link": "https://stackoverflow.com/users/293078/doug-glancy"}, "edited": false, "score": 0, "creation_date": 1461784454, "post_id": 36896555, "comment_id": 61361900, "body": "@DougGlancy: now I got it. If I close the file with <code>Menu</code> --&gt; <code>File</code> --&gt; <code>Close</code> then I cannot close the file (as expected). The same happens when I use <code>Strg + F4</code>. Yet, when I close the file by closing Excel then the above occurs and the <b>second</b> press on &quot;x&quot; in the top right of Excel closes the application (and thereby the workbook) anyway."}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1461785096, "post_id": 36896555, "comment_id": 61362328, "body": "Is the user protection unique? If not, just protect it with code. Or worst hack yet, have an <code>inputbox</code> that prompts for password then use that to protect."}, {"owner": {"reputation": 26278, "user_id": 293078, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/5437f5b4fa32bd95e6825f93a2b91a50?s=128&d=identicon&r=PG", "display_name": "Doug Glancy", "link": "https://stackoverflow.com/users/293078/doug-glancy"}, "edited": false, "score": 0, "creation_date": 1461786117, "post_id": 36896555, "comment_id": 61362957, "body": "Right you are! Thanks for showing me another reason to hate the <code>Before_Close</code> event :-). How about going at it from the other direction and protecting in the Workbook_Open event?"}, {"owner": {"reputation": 1027, "user_id": 2543601, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/40e3e80e7c8697ec26e33e49cb8336bc?s=128&d=identicon&r=PG", "display_name": "Jarom", "link": "https://stackoverflow.com/users/2543601/jarom"}, "reply_to_user": {"reputation": 26278, "user_id": 293078, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/5437f5b4fa32bd95e6825f93a2b91a50?s=128&d=identicon&r=PG", "display_name": "Doug Glancy", "link": "https://stackoverflow.com/users/293078/doug-glancy"}, "edited": false, "score": 0, "creation_date": 1461856337, "post_id": 36896555, "comment_id": 61399328, "body": "@DougGlancy: That is the work around solution I ended up going with.  The exact same code works under the Workbook_Open event.  It gives the same result (i.e. protecting the workbook before the next user can change things, but doesn&#39;t require any kind of saving before closing).  Thank you for your insights."}, {"owner": {"reputation": 26278, "user_id": 293078, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/5437f5b4fa32bd95e6825f93a2b91a50?s=128&d=identicon&r=PG", "display_name": "Doug Glancy", "link": "https://stackoverflow.com/users/293078/doug-glancy"}, "edited": false, "score": 0, "creation_date": 1461856640, "post_id": 36896555, "comment_id": 61399546, "body": "You&#39;re welcome. I&#39;m glad I could help. Thanks for the good question."}, {"owner": {"reputation": 7854, "user_id": 5461205, "user_type": "registered", "profile_image": "https://graph.facebook.com/1112471818782668/picture?type=large", "display_name": "Dirk Reichel", "link": "https://stackoverflow.com/users/5461205/dirk-reichel"}, "edited": false, "score": 0, "creation_date": 1461961617, "post_id": 36896555, "comment_id": 61452328, "body": "Just a question: Where is the need for it at the &quot;closing/opening&quot; point? can&#39;t you simply set the protection at <code>Workbook_BeforeSave</code>? (Makes more sense to me)"}, {"owner": {"reputation": 1027, "user_id": 2543601, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/40e3e80e7c8697ec26e33e49cb8336bc?s=128&d=identicon&r=PG", "display_name": "Jarom", "link": "https://stackoverflow.com/users/2543601/jarom"}, "edited": false, "score": 0, "creation_date": 1462202804, "post_id": 36896555, "comment_id": 61526520, "body": "I want the worksheet to be protected any time the user is inside of it, unless the user unprotects it.  If the user doesn&#39;t save before closing (intentionally or unintentionally) I want the worksheet to be locked when another user opens it."}], "answers": [{"comments": [{"owner": {"reputation": 1782, "user_id": 6299399, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/555bacb911dbaa9810ed4e546a3a7ef2?s=128&d=identicon&r=PG", "display_name": "Gary Evans", "link": "https://stackoverflow.com/users/6299399/gary-evans"}, "edited": false, "score": 0, "creation_date": 1465915914, "post_id": 37111194, "comment_id": 63094940, "body": "@user2543601 Did this help?"}, {"owner": {"reputation": 323, "user_id": 10106356, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-T7Tr6ot8gJY/AAAAAAAAAAI/AAAAAAAAAX0/Md6jAbDvlKc/photo.jpg?sz=128", "display_name": "Karthick Ganesan", "link": "https://stackoverflow.com/users/10106356/karthick-ganesan"}, "edited": false, "score": 0, "creation_date": 1600271085, "post_id": 37111194, "comment_id": 113037168, "body": "Will the event <code>Workbook_BeforeClose</code> will even be triggered if <code>Application.EnableEvents</code> was set to <code>False</code> in the first place?"}, {"owner": {"reputation": 323, "user_id": 10106356, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-T7Tr6ot8gJY/AAAAAAAAAAI/AAAAAAAAAX0/Md6jAbDvlKc/photo.jpg?sz=128", "display_name": "Karthick Ganesan", "link": "https://stackoverflow.com/users/10106356/karthick-ganesan"}, "edited": false, "score": 0, "creation_date": 1600271164, "post_id": 37111194, "comment_id": 113037203, "body": "Also, how to revert any actions if Workbook Close event is cancelled?"}, {"owner": {"reputation": 1782, "user_id": 6299399, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/555bacb911dbaa9810ed4e546a3a7ef2?s=128&d=identicon&r=PG", "display_name": "Gary Evans", "link": "https://stackoverflow.com/users/6299399/gary-evans"}, "reply_to_user": {"reputation": 323, "user_id": 10106356, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-T7Tr6ot8gJY/AAAAAAAAAAI/AAAAAAAAAX0/Md6jAbDvlKc/photo.jpg?sz=128", "display_name": "Karthick Ganesan", "link": "https://stackoverflow.com/users/10106356/karthick-ganesan"}, "edited": false, "score": 0, "creation_date": 1600425930, "post_id": 37111194, "comment_id": 113091447, "body": "Its been 4 years since I&#39;ve been in this space, I&#39;d recommend posting it as its own question if it doesn&#39;t exist or perform some testing to see what the outcomes are."}], "tags": [], "owner": {"reputation": 1782, "user_id": 6299399, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/555bacb911dbaa9810ed4e546a3a7ef2?s=128&d=identicon&r=PG", "display_name": "Gary Evans", "link": "https://stackoverflow.com/users/6299399/gary-evans"}, "is_accepted": true, "score": 3, "last_activity_date": 1462788554, "last_edit_date": 1462788554, "creation_date": 1462783254, "answer_id": 37111194, "question_id": 36896555, "link": "https://stackoverflow.com/questions/36896555/beforeclose-vba-event-closing-workbook-when-cancel-true/37111194#37111194", "title": "BeforeClose VBA Event Closing Workbook When Cancel = True", "body": "<p>I could replicate it if I set <code>Application.EnableEvents</code> to <code>False</code>. In the below example I have remembered its state to place it back as was after, however, I'm not sure how it gets to a state of <code>False</code> to begin with.</p>\n\n<pre><code>Private Sub Workbook_BeforeClose(Cancel As Boolean)\n    Dim BlnEventState as Boolean\n\n    BlnEventState = Application.EnableEvents\n    Application.EnableEvents = True\n\n    If Sheets(1).ProtectContents = True Then\n        Cancel = False\n    Else\n        MsgBox \"Please Protect 'Unique Futures' Worksheet Before Closing Workbook\"\n        Cancel = True\n    End If\n\n    Application.EnableEvents = BlnEventState\n\nEnd Sub\n</code></pre>\n\n<p>It may be a safer long term option to force the state rather then set it back.</p>\n\n<pre><code>Private Sub Workbook_BeforeClose(Cancel As Boolean)\n    Application.EnableEvents = True\n    If Sheets(1).ProtectContents = True Then\n        Cancel = False\n    Else\n        MsgBox \"Please Protect 'Unique Futures' Worksheet Before Closing Workbook\"\n        Cancel = True\n    End If    \nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1027, "user_id": 2543601, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/40e3e80e7c8697ec26e33e49cb8336bc?s=128&d=identicon&r=PG", "display_name": "Jarom", "link": "https://stackoverflow.com/users/2543601/jarom"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 12091, "favorite_count": 1, "accepted_answer_id": 37111194, "answer_count": 1, "score": 5, "last_activity_date": 1462788554, "creation_date": 1461777241, "last_edit_date": 1461778291, "question_id": 36896555, "link": "https://stackoverflow.com/questions/36896555/beforeclose-vba-event-closing-workbook-when-cancel-true", "title": "BeforeClose VBA Event Closing Workbook When Cancel = True", "body": "<p>I'm trying to write a short macro that will prevent the user of an excel workbook from closing the workbook without protecting the first sheet.  </p>\n\n<p>The code shows the message box but then proceeds to close the workbook.  From my understanding, if the \"Cancel\" parameter is set to True, the workbook shouldn't close.  </p>\n\n<pre><code>Private Sub Workbook_BeforeClose(Cancel As Boolean)\n\n    If Sheets(1).ProtectContents = True Then\n        Cancel = False\n    Else\n        MsgBox \"Please Protect 'Unique Futures' Worksheet Before Closing Workbook\"\n        Cancel = True\n    End If    \nEnd Sub\n</code></pre>\n\n<p>I just need the code to display the message box and then not close if the first sheet is not protected.</p>\n"}, {"tags": ["vb.net", "excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 477, "user_id": 4664207, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/071d17a9e1c675598fe1f81e1b4d4037?s=128&d=identicon&r=PG&f=1", "display_name": "jones-chris", "link": "https://stackoverflow.com/users/4664207/jones-chris"}, "edited": false, "score": 0, "creation_date": 1461784852, "post_id": 36897847, "comment_id": 61362153, "body": "Sorry I forgot to mention that I already have that reference, I think.  It&#39;s displayed as Microsoft.Office.Interop.Excel.  Is that the correct one?  I thought the Imports statement was only needed if I didn&#39;t want to write out all the object qualifiers.  It&#39;s not necessary, is it?  You&#39;re example above worked, but why can&#39;t I do this:  Dim AppExcel as New Excel.Application Dim cellrange1 as Excel.Range = AppExcel.ActiveWorkbook.Sheets(&quot;MySheet&quot;).Range(&quot;SQL&quot;).Value&zwnj;&#8203;.  I don&#39;t like to nest variables in other variables, but what I wrote above doesn&#39;t seem to work in Visual Studio.  Thanks!"}, {"owner": {"reputation": 3364, "user_id": 6139255, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/H7gaC.jpg?s=128&g=1", "display_name": "Abdellah OUMGHAR", "link": "https://stackoverflow.com/users/6139255/abdellah-oumghar"}, "reply_to_user": {"reputation": 477, "user_id": 4664207, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/071d17a9e1c675598fe1f81e1b4d4037?s=128&d=identicon&r=PG&f=1", "display_name": "jones-chris", "link": "https://stackoverflow.com/users/4664207/jones-chris"}, "edited": false, "score": 0, "creation_date": 1461794642, "post_id": 36897847, "comment_id": 61367574, "body": "Firstly You can&#39;t do this because, you must create a WorkBook objet and you can not assign an object type to a Range type. 2nd Why put SQL in Range ( &quot;SQL&quot;), which represents SQL; must be an address Range."}, {"owner": {"reputation": 477, "user_id": 4664207, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/071d17a9e1c675598fe1f81e1b4d4037?s=128&d=identicon&r=PG&f=1", "display_name": "jones-chris", "link": "https://stackoverflow.com/users/4664207/jones-chris"}, "edited": false, "score": 0, "creation_date": 1461950257, "post_id": 36897847, "comment_id": 61446854, "body": "Why can&#39;t I assign an object type to a Range variable?  How would I assign a range&#39;s value/text then?  I&#39;m new to VB.NET, but I&#39;m sure you can reference a named range, correct?  If cell A1 is named &quot;BudgetSQL&quot;, it should be fine to put &quot;BudgetSQL&quot; in the Cell1 parameter for the Range object, right?"}, {"owner": {"reputation": 3364, "user_id": 6139255, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/H7gaC.jpg?s=128&g=1", "display_name": "Abdellah OUMGHAR", "link": "https://stackoverflow.com/users/6139255/abdellah-oumghar"}, "reply_to_user": {"reputation": 477, "user_id": 4664207, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/071d17a9e1c675598fe1f81e1b4d4037?s=128&d=identicon&r=PG&f=1", "display_name": "jones-chris", "link": "https://stackoverflow.com/users/4664207/jones-chris"}, "edited": false, "score": 0, "creation_date": 1461956470, "post_id": 36897847, "comment_id": 61449878, "body": "you can not assign a Range value type to a Range type : Excel.Range = AppExcel.ActiveWorkbook.Sheets(&quot;MySheet&quot;).Range(&quot;SQL&quot;).Value&zwnj;&#8203;; For the range name, Yes, you&#39;re right, you can reference a named range."}, {"owner": {"reputation": 477, "user_id": 4664207, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/071d17a9e1c675598fe1f81e1b4d4037?s=128&d=identicon&r=PG&f=1", "display_name": "jones-chris", "link": "https://stackoverflow.com/users/4664207/jones-chris"}, "edited": false, "score": 0, "creation_date": 1462242504, "post_id": 36897847, "comment_id": 61543152, "body": "It took a little while, but I think a combination of Scott&#39;s answer below and your answer helped me understand why I can&#39;t assign the Value object to Range variable.  Sorry if I&#39;m being slow - I&#39;m trying to switch from VBA to VB.NET.  I appreciate your time and help!"}], "tags": [], "owner": {"reputation": 3364, "user_id": 6139255, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/H7gaC.jpg?s=128&g=1", "display_name": "Abdellah OUMGHAR", "link": "https://stackoverflow.com/users/6139255/abdellah-oumghar"}, "is_accepted": true, "score": 2, "last_activity_date": 1461951727, "last_edit_date": 1461951727, "creation_date": 1461781100, "answer_id": 36897847, "question_id": 36896540, "link": "https://stackoverflow.com/questions/36896540/defining-a-variable-as-a-range-vb-net/36897847#36897847", "title": "Defining a variable as a range - VB.NET", "body": "<p>To work on Excel since VB.NET, first you must add the reference to your Project :</p>\n\n<pre><code>Microsoft.Office.Interop\n</code></pre>\n\n<p>To Add a Reference :</p>\n\n<p>In <code>Solution Explorer</code>, right-click on the <code>References</code> node and choose <code>Add Reference</code>.</p>\n\n<p>Import the Reference in your code :</p>\n\n<pre><code>Imports Microsoft.Office.Interop\n</code></pre>\n\n<p>Try to use this code :</p>\n\n<pre><code>Dim AppExcel As New Excel.Application 'Create a new Excel Application\nDim workbook As Excel.Workbook = AppExcel.Workbooks.Add() 'Create a new workbook\nDim sheet As Excel.Worksheet = workbook.Sheets(\"Sheet1\") ' Create variable a Sheet, Sheet1 must be in WorkBook\n\n'Work with range\nDim cellRange1 As Excel.Range = sheet.Range(\"A1\") 'Range with text address\ncellRange1.Value = \"Text in Cell A1\"\n\nDim cellRange2 As Excel.Range = sheet.Cells(2, 2) 'Range(\"B2:B2\") with index; Cells(N\u00b0Row,N\u00b0Col) \ncellRange2.Value = \"Text in Cell B2\"\n\n\nDim tableRange3 As Excel.Range = sheet.Range(\"A1:F4\") 'Range with text address\n\nDim tableRange4 As Excel.Range = sheet.Range(sheet.Cells(1, 1), sheet.Cells(4, 6)) 'Range(\"A1:F4\") with index; Cells(N\u00b0Row,N\u00b0Col) \n\nAppExcel.Visible = True 'To display the workbook\n</code></pre>\n\n<p>Code without variable sheet</p>\n\n<pre><code>Dim AppExcel as New Excel.Application\nDim workbook As Excel.Workbook = AppExcel.Workbooks.Add()\n'Range\nDim cellrange1 as Excel.Range = AppExcel.ActiveWorkbook.Sheets(\"Feuil1\").Range(\"A1\")\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 477, "user_id": 4664207, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/071d17a9e1c675598fe1f81e1b4d4037?s=128&d=identicon&r=PG&f=1", "display_name": "jones-chris", "link": "https://stackoverflow.com/users/4664207/jones-chris"}, "edited": false, "score": 0, "creation_date": 1461949656, "post_id": 36900300, "comment_id": 61446574, "body": "So, Visual Studio doesn&#39;t throw an error when I write the line above, but Intellisense doesn&#39;t show the Range object in the dropdown list after I type Sheets(&quot;MySheet&quot;).  Do you know why that is?  And that makes some sense when you were explaining the Text vs. Value properties.  Do you happen to know why I could set a string variable in VBA to a Range object?  I looked up the Value objects in VBA vs. interop and they look very similar but interop has &quot;As Object&quot; as the data type, while VBA doesn&#39;t show a data type in the Object Browser.  Is this the difference you are referring to?"}, {"owner": {"reputation": 21110, "user_id": 5101046, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iTaTr.png?s=128&g=1", "display_name": "Scott Hannen", "link": "https://stackoverflow.com/users/5101046/scott-hannen"}, "reply_to_user": {"reputation": 477, "user_id": 4664207, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/071d17a9e1c675598fe1f81e1b4d4037?s=128&d=identicon&r=PG&f=1", "display_name": "jones-chris", "link": "https://stackoverflow.com/users/4664207/jones-chris"}, "edited": false, "score": 0, "creation_date": 1462279402, "post_id": 36900300, "comment_id": 61561376, "body": "<code>Sheets()</code> probably returns an <code>object</code>. It forces you to just somehow know what the actual type is. That&#39;s one of the problems with Excel interop. A function or property should return a meaningful type (at least in a strongly-typed language like C#.)"}], "tags": [], "owner": {"reputation": 21110, "user_id": 5101046, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iTaTr.png?s=128&g=1", "display_name": "Scott Hannen", "link": "https://stackoverflow.com/users/5101046/scott-hannen"}, "is_accepted": false, "score": 1, "last_activity_date": 1461789126, "creation_date": 1461789126, "answer_id": 36900300, "question_id": 36896540, "link": "https://stackoverflow.com/questions/36896540/defining-a-variable-as-a-range-vb-net/36900300#36900300", "title": "Defining a variable as a range - VB.NET", "body": "<p>You would need to start from your application object. Suppose that's <code>AppExcel</code>:</p>\n\n<pre><code>Dim AppExcel As New Excel.Application\n</code></pre>\n\n<p>From there, you could do:</p>\n\n<pre><code>Dim cellrange1 as Excel.Range = AppExcel.ActiveWorkbook.Sheets(\"MySheet\").Range(\"SQL\")\n</code></pre>\n\n<p>Because you've declared <code>cellrange1</code> as a <code>Range</code> it can't be set to  <code>Range(\"SQL\").Value</code>.<br>\n<code>Value</code> returns an <code>object</code> which is the value contained in that <code>Range</code>.</p>\n\n<p>That's so wordy. To put it (maybe) more clearly, <code>Range(\"SQL\")</code> returns a <code>Range</code>. <code>Range(\"SQL\").Value</code> returns an object.</p>\n\n<p>If you want to get the value, that would be <code>cellrange1.Value</code>, or perhaps <code>cellrange1.Text</code>. Assuming that the range contains some sort of SQL, I'd go with <code>Text</code>. </p>\n\n<p>An unfortunate aspect of Excel interop programming is that many properties return objects rather than strongly-typed values. For example, the object returned by <code>Range.Text</code> is always going to be a <code>string</code>, but the property still returns an <code>object</code>. That means that Visual Studio intellisense will often not tell you what type a property returns. You'll need to look up properties and functions in the <a href=\"https://msdn.microsoft.com/en-us/library/microsoft.office.interop.excel.aspx\" rel=\"nofollow\">documentation</a> to really know what they return.</p>\n"}], "owner": {"reputation": 477, "user_id": 4664207, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/071d17a9e1c675598fe1f81e1b4d4037?s=128&d=identicon&r=PG&f=1", "display_name": "jones-chris", "link": "https://stackoverflow.com/users/4664207/jones-chris"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5720, "favorite_count": 0, "accepted_answer_id": 36897847, "answer_count": 2, "score": 1, "last_activity_date": 1461951727, "creation_date": 1461777193, "last_edit_date": 1531164843, "question_id": 36896540, "link": "https://stackoverflow.com/questions/36896540/defining-a-variable-as-a-range-vb-net", "title": "Defining a variable as a range - VB.NET", "body": "<p>I think I'm losing my mind - how do you declare a variable as a string and then set it equal to a range in an Excel workbook in VB.NET?  In VBA this was easy:</p>\n\n<pre><code>Dim SQL as string\nSQL = ActiveWorkbook.Sheets(\"MySheet\").Range(\"SQL\")\n</code></pre>\n\n<p>If I try do something like this in VB.NET (in Visual Studio 2015), first I can't find Activeworkbook.  Second, if I try <code>Excel.Range(\"SQL\")</code>, I get an error saying that <code>'Range' is an interface type and cannot be used as an expression</code>.  Also, it doesn't look like the <code>Range</code> data type exists either.  Surely this functionality exists in VB.NET, right?</p>\n\n<p>Thanks for the help!</p>\n"}, {"tags": ["c#", "sql-server", "excel", "ssis", "vba"], "comments": [{"owner": {"reputation": 30431, "user_id": 1507566, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/40b799a199eda9317d64e854c9fc8858?s=128&d=identicon&r=PG", "display_name": "Tab Alleman", "link": "https://stackoverflow.com/users/1507566/tab-alleman"}, "edited": false, "score": 0, "creation_date": 1461781141, "post_id": 36895918, "comment_id": 61359786, "body": "None that I know of."}], "answers": [{"tags": [], "owner": {"reputation": 428, "user_id": 5520934, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/e37c2789254e801492b819df6f8addcd?s=128&d=identicon&r=PG&f=1", "display_name": "SQLSuperHero", "link": "https://stackoverflow.com/users/5520934/sqlsuperhero"}, "is_accepted": false, "score": 1, "last_activity_date": 1463148772, "last_edit_date": 1463148772, "creation_date": 1461777395, "answer_id": 36896604, "question_id": 36895918, "link": "https://stackoverflow.com/questions/36895918/ssis-handling-semi-structured-data-source/36896604#36896604", "title": "SSIS handling semi structured data source", "body": "<p>You can create a Data Flow Flow Task to work with Excel data source.</p>\n\n<p>Drag a Data Flow Task into the Control Flow pane. Right click the Data Flow Task and select Edit.</p>\n\n<p>From there, you can drag a \"Source Assistant\" into the Data Flow Pane. Inside the Source Assistant you are able to select Excel as the Source Type. Then you select the File Path to the Excel file.</p>\n\n<p>Then, you can connect the Source Assistant to a Destination Assistant, Transformation, or whatever you need in order to do what you need to do with the data.</p>\n"}], "owner": {"reputation": 101, "user_id": 5385432, "user_type": "registered", "accept_rate": 7, "profile_image": "https://www.gravatar.com/avatar/c9e2782ab3a7ea8fd53d5c70c5aa20ec?s=128&d=identicon&r=PG&f=1", "display_name": "dallas", "link": "https://stackoverflow.com/users/5385432/dallas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 85, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1463148772, "creation_date": 1461775405, "last_edit_date": 1531161705, "question_id": 36895918, "link": "https://stackoverflow.com/questions/36895918/ssis-handling-semi-structured-data-source", "title": "SSIS handling semi structured data source", "body": "<p>Other than using a script task, are there any ways of handling/parsing a semi structured excel data source in SSIS?</p>\n"}, {"tags": ["excel", "vba", "charts", "userform"], "comments": [{"owner": {"reputation": 3145, "user_id": 4560433, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/412786b272a5c096e45967bc79cde0a9?s=128&d=identicon&r=PG&f=1", "display_name": "OpiesDad", "link": "https://stackoverflow.com/users/4560433/opiesdad"}, "edited": false, "score": 0, "creation_date": 1461775704, "post_id": 36895781, "comment_id": 61356232, "body": "Do you have anything in the chart?  I found that the title doesn&#39;t show up until you have some values in the chart.  It does, however, save the title and then once you put the values in there, it shows up correctly."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6089076"}, "reply_to_user": {"reputation": 3145, "user_id": 4560433, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/412786b272a5c096e45967bc79cde0a9?s=128&d=identicon&r=PG&f=1", "display_name": "OpiesDad", "link": "https://stackoverflow.com/users/4560433/opiesdad"}, "edited": false, "score": 0, "creation_date": 1461849786, "post_id": 36895781, "comment_id": 61394045, "body": "Nothing was in there. There is now, and there is a title. Thanks"}], "answers": [{"tags": [], "owner": {"reputation": 3145, "user_id": 4560433, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/412786b272a5c096e45967bc79cde0a9?s=128&d=identicon&r=PG&f=1", "display_name": "OpiesDad", "link": "https://stackoverflow.com/users/4560433/opiesdad"}, "is_accepted": false, "score": 0, "last_activity_date": 1461855321, "creation_date": 1461855321, "answer_id": 36918342, "question_id": 36895781, "link": "https://stackoverflow.com/questions/36895781/dynamic-chart-title-from-userform/36918342#36918342", "title": "Dynamic chart title from userform", "body": "<p>You need to have values in the chart for the title to display.</p>\n\n<p>The code will title, with the desired text, and will display as soon as you put values in the chart.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user6089076"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 113, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1461855321, "creation_date": 1461774954, "last_edit_date": 1461777618, "question_id": 36895781, "link": "https://stackoverflow.com/questions/36895781/dynamic-chart-title-from-userform", "title": "Dynamic chart title from userform", "body": "<p>I am attempting to label a Dynamic Chart from a Userform. Although I receive no errors from the following code, I still do not get any title on the chart?!? </p>\n\n<pre><code> With Worksheets(\"Sheet1\").ChartObjects(1).Chart\n.HasTitle = True\n.ChartTitle.Text = \"Comparisons\"\n End With\n</code></pre>\n\n<p>Please, why is this? How can I remedy the situation?\nThank you!</p>\n"}, {"tags": ["vba", "ms-word", "word-2007", "word-2003"], "answers": [{"comments": [{"owner": {"reputation": 615, "user_id": 6236294, "user_type": "registered", "accept_rate": 96, "profile_image": "https://graph.facebook.com/10204431270580592/picture?type=large", "display_name": "Ibn e Ashiq", "link": "https://stackoverflow.com/users/6236294/ibn-e-ashiq"}, "edited": false, "score": 0, "creation_date": 1461774558, "post_id": 36895360, "comment_id": 61355514, "body": "but it is not escaping from previous selection. rather it is reducing the selection to <code>ABCD</code>.  and it also go beyond <code>start</code> position if there is <code>ABCD</code> before <code>start</code>.   I want only <code>ABCD</code> selected in between <code>Start</code> <code>End</code>."}, {"owner": {"reputation": 615, "user_id": 6236294, "user_type": "registered", "accept_rate": 96, "profile_image": "https://graph.facebook.com/10204431270580592/picture?type=large", "display_name": "Ibn e Ashiq", "link": "https://stackoverflow.com/users/6236294/ibn-e-ashiq"}, "edited": false, "score": 0, "creation_date": 1461775625, "post_id": 36895360, "comment_id": 61356181, "body": "have Added <code>image</code> should help understand the position"}, {"owner": {"reputation": 1635, "user_id": 5224021, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/37c6e44eb453915965b37dcc4653c3cf?s=128&d=identicon&r=PG&f=1", "display_name": "interesting-name-here", "link": "https://stackoverflow.com/users/5224021/interesting-name-here"}, "reply_to_user": {"reputation": 615, "user_id": 6236294, "user_type": "registered", "accept_rate": 96, "profile_image": "https://graph.facebook.com/10204431270580592/picture?type=large", "display_name": "Ibn e Ashiq", "link": "https://stackoverflow.com/users/6236294/ibn-e-ashiq"}, "edited": false, "score": 0, "creation_date": 1461778623, "post_id": 36895360, "comment_id": 61358183, "body": "Does this not highlight until ABCD? If it does then, <code>Selection.MoveRight 1</code> then <code>Selection.Expand wdWord</code>"}, {"owner": {"reputation": 615, "user_id": 6236294, "user_type": "registered", "accept_rate": 96, "profile_image": "https://graph.facebook.com/10204431270580592/picture?type=large", "display_name": "Ibn e Ashiq", "link": "https://stackoverflow.com/users/6236294/ibn-e-ashiq"}, "edited": false, "score": 0, "creation_date": 1461778801, "post_id": 36895360, "comment_id": 61358303, "body": "it highlight until <code>ABCD</code> but I need only <code>ABCD</code> highlighted. just like <code>find.execute</code> command"}], "tags": [], "owner": {"reputation": 1635, "user_id": 5224021, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/37c6e44eb453915965b37dcc4653c3cf?s=128&d=identicon&r=PG&f=1", "display_name": "interesting-name-here", "link": "https://stackoverflow.com/users/5224021/interesting-name-here"}, "is_accepted": false, "score": 2, "last_activity_date": 1461779280, "last_edit_date": 1461779280, "creation_date": 1461773637, "answer_id": 36895360, "question_id": 36895199, "link": "https://stackoverflow.com/questions/36895199/find-text-after-using-selection-extend-function/36895360#36895360", "title": "Find text after using Selection.Extend function", "body": "<p>I just tested, you're <code>.Wrap</code> is <code>wdFindStop</code>. The cursor is at the end of the find and you are finding <code>.Forward = True</code>. Since you are at the end, looking until the stop, it will not find it. </p>\n\n<p>Test text being:</p>\n\n<blockquote>\n  <p>Start ABCD End</p>\n</blockquote>\n\n<p>I got it to work after changing:</p>\n\n<p><code>.Forward = True</code> </p>\n\n<p>to </p>\n\n<p><code>.Forward = False</code> </p>\n\n<p>in your <code>Selection.Find</code> for <code>\"ABCD\"</code></p>\n\n<p><strong>Edit:</strong></p>\n\n<p>Then </p>\n\n<pre><code>If Selection.Find.Found = True Then\n    Selection.Collapse wdCollapseEnd\n    Selection.Expand wdWord\nElse\n    MsgBox(\"Not Found\")\nEnd If\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 615, "user_id": 6236294, "user_type": "registered", "accept_rate": 96, "profile_image": "https://graph.facebook.com/10204431270580592/picture?type=large", "display_name": "Ibn e Ashiq", "link": "https://stackoverflow.com/users/6236294/ibn-e-ashiq"}, "edited": false, "score": 0, "creation_date": 1461777393, "post_id": 36896283, "comment_id": 61357356, "body": "copy paste the above code in <code>vba</code> . it should work on the above mentioned circumstances but unfortunately something is missing its not working."}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "reply_to_user": {"reputation": 615, "user_id": 6236294, "user_type": "registered", "accept_rate": 96, "profile_image": "https://graph.facebook.com/10204431270580592/picture?type=large", "display_name": "Ibn e Ashiq", "link": "https://stackoverflow.com/users/6236294/ibn-e-ashiq"}, "edited": false, "score": 1, "creation_date": 1461778088, "post_id": 36896283, "comment_id": 61357831, "body": "You need to provide more information than that about HOW it&#39;s not working... My code example is provided as an <i>example</i> for the approach of using Ranges to find something within a specified part of the text. It&#39;s not meant as &quot;plug-and-play&quot;."}], "tags": [], "owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "is_accepted": true, "score": 1, "last_activity_date": 1461776441, "creation_date": 1461776441, "answer_id": 36896283, "question_id": 36895199, "link": "https://stackoverflow.com/questions/36895199/find-text-after-using-selection-extend-function/36896283#36896283", "title": "Find text after using Selection.Extend function", "body": "<p>I think there's some misunderstanding about what Selection.Extend actually does, you might want to read up on it in the Language Reference. It emulates a keyboard command in the UI that extends the current selection by pre-defined \"jumps\".</p>\n\n<p>From your description, I understand that you want to locate the first search term in the document (\"Start\"). <em>If</em> it's present, search to the end of the document for the second search term (\"End\"). If that is also found, search between the two terms for the third search term.</p>\n\n<p>This is best done using three RANGES, one for each search term. Something like this:</p>\n\n<pre><code>Dim rngStart as Word.Range, rngEnd as Word.Range, rngTarget as Word.Range\nDim bFound as Boolean\nSet rngStart = ActiveDocument.Content\nbFound = rngStart.Find.Execute(FindText:=\"Start\", Forward:=True, Wrap:=wdFindStop)\nIf bFound Then\n  Set rngEnd = rngStart.Duplicate\n  bFound = rngEnd.Find.Execute(FindText:=\"End\", Forward:=True, Wrap:=wdFindStop)\n  If bFound Then\n    rngStart.End = rngEnd.End 'Extend first Found to include second Found\n    Set rngTarget = rngStart.Duplicate\n    bFound = rngTarget.Find.Execute(FindText:=\"ABCD\", Forward:=True, Wrap:=wdFindStop)\n    If bFound Then\n        MsgBox \"Found\"\n    Else\n        MsgBox \"Not found\"\n    End If\n  End If\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 615, "user_id": 6236294, "user_type": "registered", "accept_rate": 96, "profile_image": "https://graph.facebook.com/10204431270580592/picture?type=large", "display_name": "Ibn e Ashiq", "link": "https://stackoverflow.com/users/6236294/ibn-e-ashiq"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1269, "favorite_count": 0, "accepted_answer_id": 36896283, "answer_count": 2, "score": 0, "last_activity_date": 1461779280, "creation_date": 1461773193, "last_edit_date": 1461776305, "question_id": 36895199, "link": "https://stackoverflow.com/questions/36895199/find-text-after-using-selection-extend-function", "title": "Find text after using Selection.Extend function", "body": "<p>I have used <code>Selection.Extend</code> to make selection of particular text from <code>Start</code> to <code>End</code> Now Text is in selection from the following code:</p>\n\n<pre><code>Selection.Find.ClearFormatting\n        With Selection.Find\n        .Text = \"Start\"\n        .Forward = True\n        .Wrap = wdFindStop\n        End With\n    Selection.Find.Execute\n    If Selection.Find.Found = False Then\n    Else\n\n    Selection.Extend\n\n    Selection.Find.ClearFormatting\n    With Selection.Find\n        .Text = \"End\"\n        .Forward = True\n        .Wrap = wdFindStop\n   End With\n   Selection.Find.Execute\n   End If\n</code></pre>\n\n<p>after selection I want to find \"ABCD\" in Selected text by the following code:</p>\n\n<pre><code>   Selection.Find.ClearFormatting\n        With Selection.Find\n            .Text = \"ABCD\"\n            .Forward = True\n            .Wrap = wdFindStop\n        End With\n    Selection.Find.Execute\n    If Selection.Find.Found = True Then\n    MsgBox (\"Found\")\n    Else\n    MsgBox (\"Not Found\")\n    End If\n</code></pre>\n\n<p>but instead of finding it is Extending the selection to <code>ABCD</code> where ever it finds.</p>\n\n<p>so my question is how do i escape from previous selection and <code>selection.Find.Execute</code> the <code>ABCD</code> within <code>Start</code> and <code>End</code>?</p>\n\n<p><img src=\"https://i.stack.imgur.com/oPVgG.png\"> </p>\n"}, {"tags": ["excel", "performance", "vba"], "comments": [{"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 2, "creation_date": 1461773186, "post_id": 36895016, "comment_id": 61354477, "body": "Copy/paste is slow. If you only need values, set ranges to each other or use array."}, {"owner": {"reputation": 21, "user_id": 6262237, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3adbe7d2c3cb64d7c8bb179b95e404c?s=128&d=identicon&r=PG&f=1", "display_name": "MAM", "link": "https://stackoverflow.com/users/6262237/mam"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1461774015, "post_id": 36895016, "comment_id": 61355128, "body": "Actually, I have simplified the issue to this: Even with a brand new sheet1 opened in excel all by itself the following statement takes about 2 seconds to execute:        Sheets(&quot;sheet1&quot;).Range(&quot;A4&quot;).Copy Destination:=Sheets(&quot;sheet1&quot;).Range(&quot;B4&quot;)"}, {"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1461775562, "post_id": 36895016, "comment_id": 61356136, "body": "Copy the sheet &quot;Tests_Master&quot; into an array then the do all the comparisons in there and take the values from there to copy them to &quot;Sheet3&quot;. Accessing a worksheet is slowing down VBA. So you should limit  the times you are reading from a sheet or writing to it."}, {"owner": {"reputation": 21, "user_id": 6262237, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3adbe7d2c3cb64d7c8bb179b95e404c?s=128&d=identicon&r=PG&f=1", "display_name": "MAM", "link": "https://stackoverflow.com/users/6262237/mam"}, "edited": false, "score": 0, "creation_date": 1461780479, "post_id": 36895016, "comment_id": 61359366, "body": "If ThisValue = surface Or x = 4 Then                 R1 = &quot;A&quot; + CStr(x) + &quot;:K&quot; + CStr(x)                 R2 = &quot;A&quot; + CStr(y) + &quot;:K&quot; + CStr(y)                 Sheets(&quot;sheet3&quot;).Range(R2) = Sheets(&quot;Tests_Master&quot;).Range(R1).Value                                 y = y + 1                              End If"}, {"owner": {"reputation": 21, "user_id": 6262237, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3adbe7d2c3cb64d7c8bb179b95e404c?s=128&d=identicon&r=PG&f=1", "display_name": "MAM", "link": "https://stackoverflow.com/users/6262237/mam"}, "edited": false, "score": 0, "creation_date": 1461780515, "post_id": 36895016, "comment_id": 61359380, "body": "Looks like the following code change did the job:"}, {"owner": {"reputation": 21, "user_id": 6262237, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3adbe7d2c3cb64d7c8bb179b95e404c?s=128&d=identicon&r=PG&f=1", "display_name": "MAM", "link": "https://stackoverflow.com/users/6262237/mam"}, "edited": false, "score": 0, "creation_date": 1461780533, "post_id": 36895016, "comment_id": 61359394, "body": "If ThisValue = surface Or x = 4 Then                 R1 = &quot;A&quot; + CStr(x) + &quot;:K&quot; + CStr(x)                 R2 = &quot;A&quot; + CStr(y) + &quot;:K&quot; + CStr(y)                 Sheets(&quot;sheet3&quot;).Range(R2) = Sheets(&quot;Tests_Master&quot;).Range(R1).Value                                 y = y + 1                              End If"}], "answers": [{"comments": [{"owner": {"reputation": 2639, "user_id": 3072566, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jaZNV.png?s=128&g=1", "display_name": "litelite", "link": "https://stackoverflow.com/users/3072566/litelite"}, "edited": false, "score": 0, "creation_date": 1461778944, "post_id": 36895764, "comment_id": 61358400, "body": "Can you explain your modifications and why they are an improvement over OP&#39;s original"}, {"owner": {"reputation": 192, "user_id": 1666422, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/c2JIV.jpg?s=128&g=1", "display_name": "Kellsens", "link": "https://stackoverflow.com/users/1666422/kellsens"}, "reply_to_user": {"reputation": 2639, "user_id": 3072566, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jaZNV.png?s=128&g=1", "display_name": "litelite", "link": "https://stackoverflow.com/users/3072566/litelite"}, "edited": false, "score": 0, "creation_date": 1461783458, "post_id": 36895764, "comment_id": 61361275, "body": "Hi @litelite, I just use the recommendation of MSDN article <a href=\"https://msdn.microsoft.com/en-us/library/office/ff726673(v=office.14).aspx#xlArraySumProduct\" rel=\"nofollow noreferrer\">link</a>. It&#39;s better read and write a large block of data in a single operation."}, {"owner": {"reputation": 2639, "user_id": 3072566, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jaZNV.png?s=128&g=1", "display_name": "litelite", "link": "https://stackoverflow.com/users/3072566/litelite"}, "edited": false, "score": 1, "creation_date": 1461784577, "post_id": 36895764, "comment_id": 61361968, "body": "To improve the quality of your answer, please quote the appropriate parts of the link you provided into the answer itself. <a href=\"http://stackoverflow.com/help/how-to-answer\">stackoverflow.com/help/how-to-answer</a>"}, {"owner": {"reputation": 192, "user_id": 1666422, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/c2JIV.jpg?s=128&g=1", "display_name": "Kellsens", "link": "https://stackoverflow.com/users/1666422/kellsens"}, "reply_to_user": {"reputation": 2639, "user_id": 3072566, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jaZNV.png?s=128&g=1", "display_name": "litelite", "link": "https://stackoverflow.com/users/3072566/litelite"}, "edited": false, "score": 0, "creation_date": 1461840724, "post_id": 36895764, "comment_id": 61387088, "body": "Thank&#39;s @litelite!"}], "tags": [], "owner": {"reputation": 192, "user_id": 1666422, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/c2JIV.jpg?s=128&g=1", "display_name": "Kellsens", "link": "https://stackoverflow.com/users/1666422/kellsens"}, "is_accepted": false, "score": 1, "last_activity_date": 1461840669, "last_edit_date": 1461840669, "creation_date": 1461774858, "answer_id": 36895764, "question_id": 36895016, "link": "https://stackoverflow.com/questions/36895016/excel-vba-copy-operation-inside-loop-is-extremely-slow/36895764#36895764", "title": "Excel VBA Copy operation inside loop is extremely slow", "body": "<p>I made some modifications, using the tip</p>\n\n<blockquote>\n  <p>Optimize your code by explicitly reducing the number of times data is transferred between Excel and your code. Instead of looping through cells one at a time to get or set a value, get or set the values in the entire range of cells in one line, using a variant containing a two-dimensional array to store values as needed.</p>\n</blockquote>\n\n<p>from this <a href=\"https://msdn.microsoft.com/en-us/library/office/ff726673(v=office.14).aspx#xlFasterVBA\" rel=\"nofollow\">article</a> I modified your code:</p>\n\n<pre><code>Sub TEST_SUB(surface)\n    With Application\n        .ScreenUpdating = False\n        .EnableEvents = False\n        .Calculation = xlCalculationManual\n    End With\n    Worksheets(\"Sheet3\").Activate\n    ActiveSheet.DisplayPageBreaks = False\n\n    Sheets(\"Sheet3\").Range(\"A4:Z400\").ClearContents    \n\n    y = 4   'y is the row on sheet3 where we want to paste\n    For x = 4 To 20 'x is the current row from which we want to copy\n    ' Decide if to copy based on whether the value in col 10 matches the parameter Surface\n        ThisValue = Sheets(\"Tests_Master\").Cells(x, 10).value\n        If ThisValue = surface Or x = 4 Then\n            R1 = \"A\" + CStr(x) + \":K\" + CStr(x) 'Range to copy from: row X columns 1-10\n\n            'Is faster use an array to store a range to copy after\n            rangeToCopy = Sheets(\"Tests_Master\").Range(R1)\n            Sheets(\"sheet3\").Range(\"A\" + CStr(y) + \":K\" + CStr(y)) = rangeToCopy\n\n            'This next statement taks about 2 seconds to execute ! WHY????\n            'Sheets(\"Tests_Master\").Range(R1).Copy Destination:=Sheets(\"sheet3\").Range(\"A\" + CStr(y))\n            y = y + 1\n\n        End If\n\n    Next x\n\n    With Application\n        .Calculation = xlCalculationAutomatic\n        .ScreenUpdating = True\n        .EnableEvents = True\n    End With\n\nEnd Sub\n</code></pre>\n\n<p>P.S.: Sorry my english</p>\n"}], "owner": {"reputation": 21, "user_id": 6262237, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3adbe7d2c3cb64d7c8bb179b95e404c?s=128&d=identicon&r=PG&f=1", "display_name": "MAM", "link": "https://stackoverflow.com/users/6262237/mam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 830, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1461840669, "creation_date": 1461772768, "last_edit_date": 1461772810, "question_id": 36895016, "link": "https://stackoverflow.com/questions/36895016/excel-vba-copy-operation-inside-loop-is-extremely-slow", "title": "Excel VBA Copy operation inside loop is extremely slow", "body": "<p>The following sub has a Copy statement inside its loop that takes over 2 seconds to execute in Excel 2013. So that would be over 40 seconds for 20 iterations. I have tried all the usual optimations , like disabling events and screen updates. Does anyone have the same problem?</p>\n\n<pre><code>Sub TEST_SUB(surface)\n    Application.ScreenUpdating = False\n    Application.EnableEvents = False\n    Application.Calculation = xlCalculationManual\n    Worksheets(\"Sheet3\").Activate\n    ActiveSheet.DisplayPageBreaks = False\n\n    Sheets(\"Sheet3\").Range(\"A4:Z400\").ClearContents\n\n\ny = 4   'y is the row on sheet3 where we want to paste\nFor x = 4 To 20 'x is the current row from which we want to copy\n        ' Decide if to copy based on whether the value in col 10 matches the parameter Surface\n        ThisValue = Sheets(\"Tests_Master\").Cells(x, 10).Value\n        If ThisValue = surface Or x = 4 Then\n            R1 = \"A\" + CStr(x) + \":K\" + CStr(x) 'Range to copy from: row X columns 1-10\n\n            'This next statement taks about 2 seconds to execute ! WHY????\n            Sheets(\"Tests_Master\").Range(R1).Copy Destination:=Sheets(\"sheet3\").Range(\"A\" + CStr(y))\n            y = y + 1\n\n        End If\n\nNext x\nApplication.Calculation = xlCalculationAutomatic\nApplication.ScreenUpdating = True\nApplication.EnableEvents = True\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 2, "creation_date": 1461771942, "post_id": 36894538, "comment_id": 61353498, "body": "In the Access database where you&#39;re doing this, make <code>TblMatched</code> a link to a pre-created table in your secondary Access database.  Then you can execute an &quot;append query&quot; (<code>INSERT INTO ...</code>) to fetch data from the server and store it in the linked Access table."}, {"owner": {"reputation": 1249, "user_id": 2145932, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/1d99eb67a4425e46fe138a73e0b72e8f?s=128&d=identicon&r=PG", "display_name": "Mark Pelletier", "link": "https://stackoverflow.com/users/2145932/mark-pelletier"}, "reply_to_user": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1461772695, "post_id": 36894538, "comment_id": 61354099, "body": "@HansUp.  I did consider this idea.  My current issue is these tables are deleted and replaced as users move from job to job throughout the day.  I suppose I could EMTPY the linked tables vs DROPPING them...  Something to try."}, {"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1461772909, "post_id": 36894538, "comment_id": 61354270, "body": "Maybe I missed something, Mark.  I see no reason to drop and then recreate <code>TblMatched</code> repeatedly.  Create it once.  Thereafter when you want to load fresh data into it, execute <code>DELETE FROM TblMatched;</code> followed by <code>INSERT INTO TblMatched (&lt;target fields&gt;) SELECT &lt;source fields&gt; FROM dbo_TblMatched;</code>"}, {"owner": {"reputation": 1249, "user_id": 2145932, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/1d99eb67a4425e46fe138a73e0b72e8f?s=128&d=identicon&r=PG", "display_name": "Mark Pelletier", "link": "https://stackoverflow.com/users/2145932/mark-pelletier"}, "reply_to_user": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 1, "creation_date": 1461773621, "post_id": 36894538, "comment_id": 61354810, "body": "Yep, that&#39;s kind of what I tried to describe in my reply ;-).   Just tested-These huge linked tables empty almost immediately - will be as ~transparent to user as DROP is today."}, {"owner": {"reputation": 1684, "user_id": 5936117, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/KO8Gd.jpg?s=128&g=1", "display_name": "MoondogsMaDawg", "link": "https://stackoverflow.com/users/5936117/moondogsmadawg"}, "edited": false, "score": 0, "creation_date": 1461780553, "post_id": 36894538, "comment_id": 61359405, "body": "Note too that any DDL action in your back end is going to disrupt any other users actively connected to it."}], "answers": [{"tags": [], "owner": {"reputation": 2046, "user_id": 6216216, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10e055d8eee151322d496f655f12088a?s=128&d=identicon&r=PG&f=1", "display_name": "Leviathan", "link": "https://stackoverflow.com/users/6216216/leviathan"}, "is_accepted": false, "score": 1, "last_activity_date": 1461868802, "creation_date": 1461868802, "answer_id": 36922953, "question_id": 36894538, "link": "https://stackoverflow.com/questions/36894538/fetch-data-into-split-database/36922953#36922953", "title": "Fetch Data Into Split Database?", "body": "<p>You can refer to another database in an SQL statement by prepending a connection string in brackets before the desired remote object.</p>\n\n<p>For an access database it would look like this:</p>\n\n<pre class=\"lang-vba prettyprint-override\"><code>strSQL = \" SELECT dbo_TblMatched.*, *\" &amp; _\n         \"   INTO [;DATABASE=&lt;path_to_accdb&gt;].TblMatched\" &amp; _\n         \"   FROM dbo_TblMatched\" &amp; _\n         \"  WHERE dbo_TblMatched.invID = \" &amp; myInvID\n</code></pre>\n\n<p>Is this what you had in mind?</p>\n"}], "owner": {"reputation": 1249, "user_id": 2145932, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/1d99eb67a4425e46fe138a73e0b72e8f?s=128&d=identicon&r=PG", "display_name": "Mark Pelletier", "link": "https://stackoverflow.com/users/2145932/mark-pelletier"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 56, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1461868802, "creation_date": 1461771551, "question_id": 36894538, "link": "https://stackoverflow.com/questions/36894538/fetch-data-into-split-database", "title": "Fetch Data Into Split Database?", "body": "<p>I have an Access database which permits users (via VBA under a button) to FETCH data from a SQL Server into their local instance.  Currently, this creates a new table in the same AccessDB containing my app.</p>\n\n<p>Due to some potentially large table sizes, I'd like to FETCH these large tables into a backend database local to the user, then LINK to them in my frontend app.</p>\n\n<p>The following is a snippet of how I fetch currently:</p>\n\n<pre><code>    strSQL = \"SELECT dbo_TblMatched.*, * \" &amp; _\n        \"INTO TblMatched FROM dbo_TblMatched \" &amp; _\n        \"WHERE dbo_TblMatched.invID= \" &amp; myInvID\n    db.Execute strSQL\n</code></pre>\n\n<p>Question:  Initiated from the fontend app, can I direct the \"INTO\" portion of this command to send the data to the backend database (already exists)?  I have no issue LINKING once the tables reside in the backend database.</p>\n\n<p>Note:  There are only 3 large/static tables I want to split out like this.  The remainder of tables I'd prefer to keep local to the frontend.</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 1, "creation_date": 1461770454, "post_id": 36893996, "comment_id": 61352379, "body": "Why code something instead of using formulas on sheet?"}, {"owner": {"reputation": 3650, "user_id": 5090027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/904db949ae64fe1a63ea8b4c677e6d57?s=128&d=identicon&r=PG&f=1", "display_name": "Grade &#39;Eh&#39; Bacon", "link": "https://stackoverflow.com/users/5090027/grade-eh-bacon"}, "edited": false, "score": 2, "creation_date": 1461771212, "post_id": 36893996, "comment_id": 61352939, "body": "&quot;So far I managed to come up with code as below.&quot; And? What does your code do? What exactly do you expect it to do? What is a sample of the data you are looking at? On what conditions does it work as expected? Does it error? etc. etc. etc."}], "answers": [{"comments": [{"owner": {"reputation": 55, "user_id": 5670070, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/364ca136226138cd9d008a0c5037c78f?s=128&d=identicon&r=PG&f=1", "display_name": "Trix", "link": "https://stackoverflow.com/users/5670070/trix"}, "edited": false, "score": 0, "creation_date": 1461773881, "post_id": 36894742, "comment_id": 61355019, "body": "Thank you but I am getting &quot;Run time error &#39;404&#39; Object required.&quot; To explain my intentions to findwindow and Grade &#39;Eh&#39; Bacon:  I am trying to populate some data in column O of Sheet1 using relevant values from the table in Sheet2. As the size of both tables is different each time I need to do it, I cannot simply enter formulas into each cell as it would be time consuming process so I am trying to avoid it using macro that populates the data automatically regardless the number of rows in each table."}, {"owner": {"reputation": 286, "user_id": 5261233, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/i5rHw.jpg?s=128&g=1", "display_name": "Histerical", "link": "https://stackoverflow.com/users/5261233/histerical"}, "reply_to_user": {"reputation": 55, "user_id": 5670070, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/364ca136226138cd9d008a0c5037c78f?s=128&d=identicon&r=PG&f=1", "display_name": "Trix", "link": "https://stackoverflow.com/users/5670070/trix"}, "edited": false, "score": 0, "creation_date": 1461775232, "post_id": 36894742, "comment_id": 61355948, "body": "I updated my answer to account for the run time error you were receiving, it wasn&#39;t liking the variables being input into the function, so I dimmed them as what they were looking for."}, {"owner": {"reputation": 286, "user_id": 5261233, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/i5rHw.jpg?s=128&g=1", "display_name": "Histerical", "link": "https://stackoverflow.com/users/5261233/histerical"}, "reply_to_user": {"reputation": 55, "user_id": 5670070, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/364ca136226138cd9d008a0c5037c78f?s=128&d=identicon&r=PG&f=1", "display_name": "Trix", "link": "https://stackoverflow.com/users/5670070/trix"}, "edited": false, "score": 0, "creation_date": 1461782281, "post_id": 36894742, "comment_id": 61360532, "body": "Glad to hear it! Make sure to mark my answer for ya :)"}], "tags": [], "owner": {"reputation": 286, "user_id": 5261233, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/i5rHw.jpg?s=128&g=1", "display_name": "Histerical", "link": "https://stackoverflow.com/users/5261233/histerical"}, "is_accepted": true, "score": 1, "last_activity_date": 1461775040, "last_edit_date": 1461775040, "creation_date": 1461772066, "answer_id": 36894742, "question_id": 36893996, "link": "https://stackoverflow.com/questions/36893996/vba-vlookup-function-operating-on-dynamic-number-of-rows/36894742#36894742", "title": "VBA &#39;Vlookup&#39; function operating on dynamic number of rows", "body": "<p>You will need to call the function in your sub using a similar line to below. It then takes your values from your sub and inputs them into the function and returns the value.</p>\n\n<p>You need to dim the ranges in order for them to be recognized correctly in your function. I have updated your code to make it work and you can fiddle around with it to make it work the way you want it to. I also updated a few other spots to figure out the correct ranges, you don't want to use <code>xlDown</code> where you were using it, causes an enormous loop covering cells you don't want it to.</p>\n\n<pre><code>Public Function fsVlookup(ByVal pSearch As Range, ByVal pMatrix As Range, ByVal pMatColNum As Integer) As String\n    Dim s As String\n    On Error Resume Next\n    s = Application.WorksheetFunction.VLookup(pSearch, pMatrix, pMatColNum, False)\n    If IsError(s) Then\n        fsVlookup = \"\"\n    Else\n        fsVlookup = s\n    End If\nEnd Function.\n\nPublic Sub Delinquency2()\n    Dim ws1 As Worksheet, ws2 As Worksheet\n    Dim rng As Range\n    Dim rCell As Range, pMatrix As Range\n\n    Set ws1 = Worksheets(\"Sheet1\")\n    Set ws2 = Worksheets(\"Sheet2\")\n\n    pSearchCol = ws1.Range(\"D2:D2\").Column\n    Set pMatrix = ws2.Range(\"$A3:$H\" &amp; ws2.Cells(Rows.Count, \"C\").End(xlUp).Row)\n    pMatColNum = 4\n\n    Set rng = ws1.Range(\"O2:O\" &amp; ws1.Cells(Rows.Count, \"A\").End(xlUp).Row)\n\n    For Each rCell In rng.Cells\n         With rCell\n             rCell.Value = fsVlookup(ws1.Cells(rCell.Row, pSearchCol), pMatrix, pMatColNum)\n        End With\n    Next rCell\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 55, "user_id": 5670070, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/364ca136226138cd9d008a0c5037c78f?s=128&d=identicon&r=PG&f=1", "display_name": "Trix", "link": "https://stackoverflow.com/users/5670070/trix"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1940, "favorite_count": 0, "accepted_answer_id": 36894742, "answer_count": 1, "score": 0, "last_activity_date": 1461775040, "creation_date": 1461770179, "last_edit_date": 1461771149, "question_id": 36893996, "link": "https://stackoverflow.com/questions/36893996/vba-vlookup-function-operating-on-dynamic-number-of-rows", "title": "VBA &#39;Vlookup&#39; function operating on dynamic number of rows", "body": "<p>I am not sure how to combine a Function with a Sub. Most likely, the Sub I have below needs corrections.</p>\n\n<p>I have two tables in two separate sheets: Sheet1 and Sheet2. </p>\n\n<p>Both tables have dynamic number of rows but the first rows always start in the same place and the number of columns in both tables is constant, too. Sheet1 data starts in A2 and ends in R2:R and Sheet2 data starts in A3 and ends in H3:H.</p>\n\n<p>I am trying to implement VLOOkUP in column O of Sheet1, that would populate each cell in column O of Sheet1 with relevant values of column D in Sheet2. So far I managed to come up with code as below.</p>\n\n<pre><code>Public Function fsVlookup(ByVal pSearch As Range, ByVal pMatrix As Range, ByVal pMatColNum As Integer) As String\n    Dim s As String\n    On Error Resume Next\n    s = Application.WorksheetFunction.VLookup(pSearch, pMatrix, pMatColNum, False)\n    If IsError(s) Then\n        fsVlookup = \"\"\n    Else\n        fsVlookup = s\n    End If\nEnd Function\nPublic Sub Delinquency2()\n\n    Dim ws1 As Worksheet, ws2 As Worksheet\n    Dim rng As Range\n    Dim rCell As Range\n\n\n    Set ws1 = Worksheets(\"Sheet1\")\n    Set ws2 = Worksheets(\"Sheet2\")\n\n    pSearch = ws1.Range(\"D2:D\" &amp; Cells(Rows.Count, \"A\").End(xlDown).Row)\n    pMatrix = ws2.Range(\"$A3:$H\" &amp; Cells(Rows.Count, \"C\").End(xlDown).Row)\n    pMatColNum = 4\n\n    Set rng = ws1.Range(\"O2:O\" &amp; Cells(Rows.Count, \"A\").End(xlDown).Row)\n\n    For Each rCell In rng.Cells\n             With rCell\n                               rCell.FormulaR1C1 = s\n\n            End With\n        Next rCell\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1461770235, "post_id": 36893967, "comment_id": 61352194, "body": "<code>getting my Range(&quot;I26:Q26) to increment</code> It won&#39;t increment if you hard code it. Also, consider <code>findnext</code> Edit: nevermind the <code>findnext</code>, you&#39;re only going from row 26 to 56. Looping rows isn&#39;t detrimental to performance here."}, {"owner": {"reputation": 41, "user_id": 2930095, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/48a574a9f5bf5a0462117a8a0008d149?s=128&d=identicon&r=PG&f=1", "display_name": "Tyler Cohen", "link": "https://stackoverflow.com/users/2930095/tyler-cohen"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1461770560, "post_id": 36893967, "comment_id": 61352458, "body": "Do you have a recommendation for how to declare my range variable and increment it instead of the way its written? i was really hoping just running through the for each loop would natively increment it."}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1461770687, "post_id": 36893967, "comment_id": 61352536, "body": "<code>hoping just running through the for each loop would natively increment it</code> computers do <i>exactly</i> what you tell them to do. So if you ordered <code>Range(&quot;I26:Q26&quot;).Select</code> how can you expect the machine to know you want to move to row 27 next time??? As for recommendation, look up a <code>for i=1 to x</code> loop.  Edit: a link <a href=\"https://msdn.microsoft.com/en-us/library/5z06z1kb.aspx\" rel=\"nofollow noreferrer\">here</a>."}, {"owner": {"reputation": 414, "user_id": 2923617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vJbkH.jpg?s=128&g=1", "display_name": "NiH", "link": "https://stackoverflow.com/users/2923617/nih"}, "edited": false, "score": 0, "creation_date": 1461770849, "post_id": 36893967, "comment_id": 61352662, "body": "try  &quot; range( cells(Cell.row, 9), cells(Cell.row, 17)) &quot;"}, {"owner": {"reputation": 41, "user_id": 2930095, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/48a574a9f5bf5a0462117a8a0008d149?s=128&d=identicon&r=PG&f=1", "display_name": "Tyler Cohen", "link": "https://stackoverflow.com/users/2930095/tyler-cohen"}, "edited": false, "score": 0, "creation_date": 1461771518, "post_id": 36893967, "comment_id": 61353139, "body": "Thank you both of you for the resources this is what I need to do."}], "answers": [{"comments": [{"owner": {"reputation": 41, "user_id": 2930095, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/48a574a9f5bf5a0462117a8a0008d149?s=128&d=identicon&r=PG&f=1", "display_name": "Tyler Cohen", "link": "https://stackoverflow.com/users/2930095/tyler-cohen"}, "edited": false, "score": 0, "creation_date": 1461771552, "post_id": 36894381, "comment_id": 61353169, "body": "Yes! thats perfect, I just need to copy some extra rows so ill expand from i,9/ i,12 to i,17. Thank you!"}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 1, "creation_date": 1461771641, "post_id": 36894381, "comment_id": 61353248, "body": "While this does address the issue at hand, it would help if you don&#39;t perpetuate the use of <code>select</code> and <code>copy&#47;paste</code> for values :/"}, {"owner": {"reputation": 3541, "user_id": 1616731, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/c9adb6c09548c81a8a9a46d7497081f6?s=128&d=identicon&r=PG&f=1", "display_name": "Tim Wilkinson", "link": "https://stackoverflow.com/users/1616731/tim-wilkinson"}, "reply_to_user": {"reputation": 41, "user_id": 2930095, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/48a574a9f5bf5a0462117a8a0008d149?s=128&d=identicon&r=PG&f=1", "display_name": "Tyler Cohen", "link": "https://stackoverflow.com/users/2930095/tyler-cohen"}, "edited": false, "score": 0, "creation_date": 1461837956, "post_id": 36894381, "comment_id": 61385147, "body": "@TylerCohen if you need to copy more rows change the 56 in <code>i = 26 To 56&#39; to a higher number. Only change </code>Cells(i, 12)` if you want to copy more columns. Also take note of findwindows comment, and try to amend."}], "tags": [], "owner": {"reputation": 3541, "user_id": 1616731, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/c9adb6c09548c81a8a9a46d7497081f6?s=128&d=identicon&r=PG&f=1", "display_name": "Tim Wilkinson", "link": "https://stackoverflow.com/users/1616731/tim-wilkinson"}, "is_accepted": true, "score": 0, "last_activity_date": 1461771146, "creation_date": 1461771146, "answer_id": 36894381, "question_id": 36893967, "link": "https://stackoverflow.com/questions/36893967/trying-to-copy-specific-columns-in-a-row-to-another-excel-sheet-based-on-it-meet/36894381#36894381", "title": "Trying to copy specific columns in a row to another excel sheet based on it meeting certain criteria", "body": "<p>Try this</p>\n\n<pre><code>Sheets(\"Aspen Data\").Select\nDim i As Integer\n\nSheets(\"Code\").Calculate\nSheets(\"Aspen Data\").Calculate\n\nFor i = 26 To 56\n\nIf IsEmpty(Cells(i, 7)) Then\n    Exit Sub\nElseIf Cells(i, 7).Value = \"True\" Then\n\nRange(Cells(i, 9), Cells(i, 12)).Copy\nSheets(\"AspenHist\").Activate\nRange(\"B\" &amp; Rows.Count).End(xlUp).Offset(1).Select\nSelection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n:=False, Transpose:=False\nSheets(\"Aspen Data\").Activate\nEnd If\n\nNext i\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 135, "user_id": 6047827, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/ef0636a84718c96a71943942b531587c?s=128&d=identicon&r=PG&f=1", "display_name": "Micah Lindstrom", "link": "https://stackoverflow.com/users/6047827/micah-lindstrom"}, "is_accepted": false, "score": 0, "last_activity_date": 1461772725, "last_edit_date": 1495542701, "creation_date": 1461772725, "answer_id": 36894992, "question_id": 36893967, "link": "https://stackoverflow.com/questions/36893967/trying-to-copy-specific-columns-in-a-row-to-another-excel-sheet-based-on-it-meet/36894992#36894992", "title": "Trying to copy specific columns in a row to another excel sheet based on it meeting certain criteria", "body": "<p>There's no need to use <code>.Select/.Activate/ActiveSheet</code> (see <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba-macros/10718179#1071817]\">this</a>) to accomplish your goals, and you can definitely use <code>For Each</code>. Try this:</p>\n\n<pre><code>Option Explicit\n\nSub Macro1()\n    '\n    ' Macro1 Macro\n    '\n\n    '\n    Dim tfCol As Range, Cell As Object\n\n    Set tfCol = Sheets(\"Aspen Data\").Range(\"G26:G56\")\n\n    Application.ScreenUpdating = False\n\n    Sheets(\"Code\").Calculate\n    Sheets(\"Aspen Data\").Calculate\n\n    For Each Cell In tfCol\n\n        If IsEmpty(Cell) Then\n            Exit For\n        End If\n\n        If Cell.Value = \"True\" Then\n\n            Sheets(\"Aspen Data\").Range(\"I\" &amp; Cell.Row &amp; \":Q\" &amp; Cell.Row).Copy\n            Sheets(\"AspenHist\").Range(\"B\" &amp; Rows.Count).End(xlUp).Offset(1).PasteSpecial _\n                Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=False\n        End If\n\n    Next\n\n    Application.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 41, "user_id": 2930095, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/48a574a9f5bf5a0462117a8a0008d149?s=128&d=identicon&r=PG&f=1", "display_name": "Tyler Cohen", "link": "https://stackoverflow.com/users/2930095/tyler-cohen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2006, "favorite_count": 0, "accepted_answer_id": 36894381, "answer_count": 2, "score": 0, "last_activity_date": 1572345733, "creation_date": 1461770124, "last_edit_date": 1463059825, "question_id": 36893967, "link": "https://stackoverflow.com/questions/36893967/trying-to-copy-specific-columns-in-a-row-to-another-excel-sheet-based-on-it-meet", "title": "Trying to copy specific columns in a row to another excel sheet based on it meeting certain criteria", "body": "<p>Im very new to excel/vba and trying to use a macro to check a column for the value true, when it sees that value I'd like it to copy parts of that row to another sheet in my column. Then I need it to iterate through the other rows and perform the same checks. Here is my code currently.</p>\n\n<pre><code>Sub Macro3()\n'\n' Macro3 Macro\n'\n\n'\nSheets(\"Aspen Data\").Select\nDim tfCol As Range, Cell As Object\n\n\nSet tfCol = Range(\"G26:G56\")\n\nSheets(\"Code\").Select\nActiveSheet.Calculate\nSheets(\"Aspen Data\").Select\nActiveSheet.Calculate\n\nFor Each Cell In tfCol\n\n    If IsEmpty(Cell) Then\n        Exit Sub\n    End If\n\n    If Cell.Value = \"True\" Then\n\nRange(\"I26:Q26\").Select\nSelection.Copy\nSheets(\"AspenHist\").Select\nRange(\"B\" &amp; Rows.Count).End(xlUp).Offset(1).Select\nSelection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n    :=False, Transpose:=False\n    End If\n\n    Next\n\n\nEnd Sub\n</code></pre>\n\n<p>The issue appears to be in getting my Range(\"I26:Q26) to increment by one as it goes through the loop.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 1, "creation_date": 1461770407, "post_id": 36893933, "comment_id": 61352330, "body": "You could populate all rows initially: <code>rng.Parent.Cells(2, LastCol + 1).Resize(lastrow - 1).Formula = ...</code> and so on."}, {"owner": {"reputation": 3, "user_id": 6262054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab747ac574894209843ffa3df9b5bdc4?s=128&d=identicon&r=PG&f=1", "display_name": "J Clark", "link": "https://stackoverflow.com/users/6262054/j-clark"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1461771231, "post_id": 36893933, "comment_id": 61352951, "body": "Rory, thank you for your suggestion.  I have tried that and it changed the output however has not totally resolved the issue.  Instead of the original calculation being added into Row2 when the row was hidden, it leaves Row2 empty, but applies the calculation to all Visible Rows.  So any hidden rows are left blank, with visual rows updated to contain the calculation.  As for advise on the function &#39;Resize&#39; however, thats great, I am sure I can use that in the future to make things easier for me."}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1461772866, "post_id": 36893933, "comment_id": 61354228, "body": "Apologies - I had forgotten about that abomination (someone at Redmond needs a kick for that). With the filter applied, you&#39;ll have to loop through the cells, I&#39;m afraid."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 6262054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab747ac574894209843ffa3df9b5bdc4?s=128&d=identicon&r=PG&f=1", "display_name": "J Clark", "link": "https://stackoverflow.com/users/6262054/j-clark"}, "edited": false, "score": 0, "creation_date": 1461835345, "post_id": 36896106, "comment_id": 61383318, "body": "Marco, thank you - the code to determine, store and reapply the original Auto Filter Settings works a treat and has resolved my issue.  Your assistance is really appreciated."}], "tags": [], "owner": {"reputation": 2648, "user_id": 6230407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IgdHF.jpg?s=128&g=1", "display_name": "Marco Vos", "link": "https://stackoverflow.com/users/6230407/marco-vos"}, "is_accepted": true, "score": 0, "last_activity_date": 1461779790, "last_edit_date": 1495541275, "creation_date": 1461775996, "answer_id": 36896106, "question_id": 36893933, "link": "https://stackoverflow.com/questions/36893933/excel-vba-filldown-not-working-when-sheet-has-an-autofilter-applied-row-cont/36896106#36896106", "title": "Excel-VBA : FillDown not working when sheet has an AutoFilter applied &amp; row containing calculations is hidden by filter settings", "body": "<p>A workaround could be to first copy the invisible row 2 to the visible row 3 end then fill Down. Something like:</p>\n\n<pre><code>Range(Cells(2, LastCol + 1),Cells(2,lastcolaftercalculations)).copy Range(Cells(3, LastCol + 1,Cells(2,lastcolaftercalculations))\nRange(Cells(3, LastCol + 1), Cells(LastRow, lastcolaftercalculations)).FillDown\n</code></pre>\n\n<p>This does however not fill other filtered cells. When you want that you could use <a href=\"https://stackoverflow.com/questions/9489126/in-excel-vba-how-do-i-save-restore-a-user-defined-filter\">this</a> code, that will first disable the autofilter and then reset it to the previous setting after you run your code.</p>\n"}], "owner": {"reputation": 3, "user_id": 6262054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab747ac574894209843ffa3df9b5bdc4?s=128&d=identicon&r=PG&f=1", "display_name": "J Clark", "link": "https://stackoverflow.com/users/6262054/j-clark"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1002, "favorite_count": 0, "accepted_answer_id": 36896106, "answer_count": 1, "score": 0, "last_activity_date": 1463059834, "creation_date": 1461770033, "last_edit_date": 1463059834, "question_id": 36893933, "link": "https://stackoverflow.com/questions/36893933/excel-vba-filldown-not-working-when-sheet-has-an-autofilter-applied-row-cont", "title": "Excel-VBA : FillDown not working when sheet has an AutoFilter applied &amp; row containing calculations is hidden by filter settings", "body": "<p>I have the below code and it works perfectly for my purposes except when an AutoFilter is applied to the sheet &amp; row 2 is hidden by the AutoFilter.</p>\n\n<p>The Macro inserts the 'Record_Created_Year' and '=Year(##)' into the 1st empty Column &amp; Row 1/2 correctly (even if the Row is hidden), however does not FillDown the calculations to the last row.  </p>\n\n<p>Instead of filling down the calculations added into Row 2, it is instead selecting the 2nd visible row (which could be Row 3) and filling down the values within those cells (which are blank, but for testing purposes I populated them to prove the theory).</p>\n\n<p>I have been able to work around the issue by including a command  \"ActiveSheet.AutoFilterMode = False\", however that is causing some issues for a subset of users who need to reapply complex filters after running the macro.  </p>\n\n<p>Is there a better way to define the FillDown Range, so it ignores the Auto Filter and actually Fills Down the data/calculations within Row2 rather than the data contained within the 2nd visible row?</p>\n\n<p>Cheers in advance for any assistance.</p>\n\n<pre><code>Private Sub Add_and_Filldown_Calcs()\n\nDim LastCol As Long\n    With ActiveSheet\n        LastCol = .Cells(1, .Columns.Count).End(xlToLeft).Column\n    End With\nDim LastRow As Long\n    With ActiveSheet\n        LastRow = .Cells(Rows.Count, 1).End(xlUp).Row\n    End With\nDim rng As Range\nSet rng = ActiveSheet.Cells\nDim Created_Date As Range\nSet Created_Date = ActiveSheet.Range(\"A1:BZ1\").Find(\"sys_created_on\", lookat:=xlWhole)\n\nrng.Parent.Cells(1, LastCol + 1).Value = \"Record_Created_Year\"\nrng.Parent.Cells(2, LastCol + 1).Formula = \"=year(\" &amp; Replace(Created_Date.Address(False, False), \"1\", \"\") &amp; \"2)\"\nrng.Parent.Cells(1, LastCol + 2).Value = \"Record_Created_Month\"\nrng.Parent.Cells(2, LastCol + 2).Formula = \"=Month(\" &amp; Replace(Created_Date.Address(False, False), \"1\", \"\") &amp; \"2)\"\n' Many others removed to make it easier to read\n'Filldown new calcs\n\nDim LastColAfterCalulations As Long\n    With ActiveSheet\n        lastcolaftercalculations = .Cells(1, .Columns.Count).End(xlToLeft).Column\n    End With\n\nRange(Cells(2, LastCol + 1), Cells(LastRow, lastcolaftercalculations)).FillDown\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["arrays", "vba", "userform"], "comments": [{"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1461777896, "post_id": 36893869, "comment_id": 61357706, "body": "You don&#39;t show us enough context; please use the <a href=\"https://stackoverflow.com/posts/36893869/edit\">edit</a> link to add more information. Show us the Sort and Reverse methods your code is calling. Which line of code is triggering the error? Also, what values do <code>A</code>, <code>B</code> and <code>n</code> represent? Show us how these are defined."}], "answers": [{"tags": [], "owner": {"reputation": 449, "user_id": 5585956, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/5pwKs.png?s=128&g=1", "display_name": "Sean", "link": "https://stackoverflow.com/users/5585956/sean"}, "is_accepted": false, "score": 1, "last_activity_date": 1461771210, "last_edit_date": 1461771210, "creation_date": 1461770392, "answer_id": 36894077, "question_id": 36893869, "link": "https://stackoverflow.com/questions/36893869/can-anyone-solve-this-error-in-my-code-to-do-with-calling-subs-in-userform-erro/36894077#36894077", "title": "Can anyone solve this error in my code to do with calling subs in userform? Error: array or user define expected", "body": "<p>You should be using the property <a href=\"https://msdn.microsoft.com/en-us/library/office/ff196172.aspx\" rel=\"nofollow\"><code>value</code></a> of the your option buttons. Currently, you're trying to compare if the button itself (the actual physical control) is true.</p>\n\n<p>For example, if you have a Car and want to check whether or not there is a driver, you would <strong>specifically</strong> check the driver seat and not just look at the entire car or any seat (hopefully this analogy doesn't confuse you).</p>\n\n<p>So with a quick review of your code, it should look like so:</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n    If OptionButton1.Value = True Then\n        Sort A, B, n            \n    Else\n        Reverse A, B, n\n    End If\nEnd Sub\n</code></pre>\n\n<p>Also just to help you become a better programmer, use <a href=\"https://msdn.microsoft.com/en-us/library/aa263493%28v=vs.60%29.aspx\" rel=\"nofollow\">VBA naming conventions</a> for your controls. It helps a lot if someone else has to ever use your code, whether it's a week or a year from now!</p>\n"}], "owner": {"reputation": 51, "user_id": 5650971, "user_type": "registered", "accept_rate": 25, "profile_image": "https://graph.facebook.com/10205656293303604/picture?type=large", "display_name": "Katrina", "link": "https://stackoverflow.com/users/5650971/katrina"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 30, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1461777936, "creation_date": 1461769872, "last_edit_date": 1461777936, "question_id": 36893869, "link": "https://stackoverflow.com/questions/36893869/can-anyone-solve-this-error-in-my-code-to-do-with-calling-subs-in-userform-erro", "title": "Can anyone solve this error in my code to do with calling subs in userform? Error: array or user define expected", "body": "<p>I want to call different sub depending on what button the user clicks.</p>\n\n<pre><code>Private Sub CommandButton1_Click()\nIf OptionButton1 = True Then\n    Sort A, B, n\n    Exit Sub\nElseIf OptionButton2 = True Then\n    Reverse A, B, n\n    Exit Sub\nEnd If\n\nEnd Sub\n</code></pre>\n\n<p>The error comes up as \"array or user define expected\" but i have checked that I have defined the arrays A, B the same throughout my code. \nAny ideas? </p>\n"}, {"tags": ["excel", "vba", "ms-office", "udf"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1461769587, "post_id": 36893688, "comment_id": 61351689, "body": "<code>My question is: Is it doable using macros?</code> Answer: Yes, most likely.  Stack Overflow is not a code for me service.  Use array or dictionary and lots of loops."}, {"owner": {"reputation": 414, "user_id": 2923617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vJbkH.jpg?s=128&g=1", "display_name": "NiH", "link": "https://stackoverflow.com/users/2923617/nih"}, "edited": false, "score": 0, "creation_date": 1461769944, "post_id": 36893688, "comment_id": 61351951, "body": "Although not the same, <a href=\"http://stackoverflow.com/q/36824503/2923617\">here</a>&#39;s a very similar question. It might put you on the right track."}, {"owner": {"reputation": 414, "user_id": 2923617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vJbkH.jpg?s=128&g=1", "display_name": "NiH", "link": "https://stackoverflow.com/users/2923617/nih"}, "edited": false, "score": 1, "creation_date": 1461771180, "post_id": 36893688, "comment_id": 61352918, "body": "I just notice that the link I posted was actually your question! Please put in some effort! Starting from the answers provided there, you should be able to figure it out or at least give it a try. Come back here when you run into a specific issue with your own solution and everyone here will be more than happy to help."}], "owner": {"reputation": 23, "user_id": 6247690, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-5oae_T_dw3M/AAAAAAAAAAI/AAAAAAAABWA/gl_YmWiC3kY/photo.jpg?sz=128", "display_name": "Mete Cirakoglu", "link": "https://stackoverflow.com/users/6247690/mete-cirakoglu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 26, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1461769417, "creation_date": 1461769417, "question_id": 36893688, "link": "https://stackoverflow.com/questions/36893688/product-attribute-combinations-generation-in-excel", "title": "Product attribute combinations generation in Excel", "body": "<p>I have a table which contains 13.931 rows and 2 columns, the first column is SKU's, second is Options (Size, Colour, etc..);</p>\n\n<ul>\n<li><strong>SKU Option</strong></li>\n<li>0001 Size:S</li>\n<li>0001 Size:M</li>\n<li>0001 Size:L</li>\n<li>0001 Size:XL</li>\n<li>0001 Colour:Red</li>\n<li>0001 Colour:Blue</li>\n<li>0002 Size:S</li>\n<li>0002 Size:M</li>\n<li>0002 Size:L</li>\n<li>0002 Colour:Navy</li>\n<li>0002 Leg:G</li>\n</ul>\n\n<p>and goes on like this. What I need to do is generate every combination of these options <strong>(there are 7 option types in total; some SKU's has 2 types some has 4, some non)</strong> within SKU's, so it'll be like this;</p>\n\n<ul>\n<li><strong>SKU Option</strong></li>\n<li>0001 Size:S;Colour:Red</li>\n<li>0001 Size:M;Colour:Red</li>\n<li>0001 Size:L;Colour:Red</li>\n<li>0001 Size:XL;Colour:Red</li>\n<li>0001 Size:S;Colour:Blue</li>\n<li>0001 Size:M;Colour:Blue</li>\n<li>0001 Size:L;Colour:Blue</li>\n<li>0001 Size:XL;Colour:Blue</li>\n<li>0002 Size:S;Colour:Navy;Leg:G</li>\n<li>0002 Size:M;Colour:Navy;Leg:G</li>\n<li>0002 Size:L;Colour:Navy;Leg:G</li>\n</ul>\n\n<p>I can seperate Option column into 2 for option types and option values if it makes it easier.</p>\n\n<p>My question is: Is it doable using macros? Because it is going to be a huge pain if I manually do these.</p>\n"}, {"tags": ["xml", "vba", "excel", "soap"], "comments": [{"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1461772446, "post_id": 36893670, "comment_id": 61353877, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/13620011/how-to-fetch-data-from-xml-file-to-excel-sheet-using-vba\" title=\"how to fetch data from xml file to excel sheet using vba\">stackoverflow.com/questions/13620011/&hellip;</a> or <a href=\"http://stackoverflow.com/questions/16423644/load-xml-into-excel-through-vba\" title=\"load xml into excel through vba\">stackoverflow.com/questions/16423644/&hellip;</a>"}, {"owner": {"reputation": 327, "user_id": 5088090, "user_type": "registered", "accept_rate": 57, "profile_image": "https://lh3.googleusercontent.com/--Ml0XmPrtUg/AAAAAAAAAAI/AAAAAAAAAXo/c56o6-8TXnA/photo.jpg?sz=128", "display_name": "Mehmet Akif G&#252;zey", "link": "https://stackoverflow.com/users/5088090/mehmet-akif-g%c3%bczey"}, "reply_to_user": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1461779800, "post_id": 36893670, "comment_id": 61358954, "body": "No, it is completely different."}], "answers": [{"tags": [], "owner": {"reputation": 870, "user_id": 6163402, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/19d47a16284a626890edbc72733bca30?s=128&d=identicon&r=PG&f=1", "display_name": "the scion", "link": "https://stackoverflow.com/users/6163402/the-scion"}, "is_accepted": false, "score": 0, "last_activity_date": 1461770952, "creation_date": 1461770952, "answer_id": 36894301, "question_id": 36893670, "link": "https://stackoverflow.com/questions/36893670/is-it-possible-to-parse-xml-with-using-excelvba/36894301#36894301", "title": "Is it possible to parse XML with using Excel(VBA)?", "body": "<p>Only for paragraph 2 you can use the build tool of excel for import xml file into the excel-</p>\n\n<p>Click on tab \"data\"->\"from other sources\"->\"from xml data inport\"</p>\n"}], "owner": {"reputation": 327, "user_id": 5088090, "user_type": "registered", "accept_rate": 57, "profile_image": "https://lh3.googleusercontent.com/--Ml0XmPrtUg/AAAAAAAAAAI/AAAAAAAAAXo/c56o6-8TXnA/photo.jpg?sz=128", "display_name": "Mehmet Akif G&#252;zey", "link": "https://stackoverflow.com/users/5088090/mehmet-akif-g%c3%bczey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 433, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1461770952, "creation_date": 1461769353, "question_id": 36893670, "link": "https://stackoverflow.com/questions/36893670/is-it-possible-to-parse-xml-with-using-excelvba", "title": "Is it possible to parse XML with using Excel(VBA)?", "body": "<p>I have a xml file, I can run it by using Soap UI. In Soap, I open a new worksheet, paste my xml code, and click the run button, and it makes what I want. </p>\n\n<p>I want to the same thing with using Excel(VBA). </p>\n\n<p>Scenario: </p>\n\n<ol>\n<li>I paste the xml content to A1 cell. </li>\n<li>Create a button and write the code which I need</li>\n<li>Click the button and parse the xml content</li>\n</ol>\n\n<p>Is it possible to do? </p>\n"}, {"tags": ["excel", "csv", "powerpoint", "vba"], "comments": [{"owner": {"reputation": 175, "user_id": 6146720, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-aqmyOqDEWGY/AAAAAAAAAAI/AAAAAAAAAMY/KshiuhjrGnc/photo.jpg?sz=128", "display_name": "Stewart Whitman", "link": "https://stackoverflow.com/users/6146720/stewart-whitman"}, "edited": false, "score": 0, "creation_date": 1461865713, "post_id": 36893436, "comment_id": 61405478, "body": "I&#39;ve expanded my original question to provide more detail to my problem as how these characters ($ and %) are dealt with by PowerPoint as well as Excel."}], "answers": [{"comments": [{"owner": {"reputation": 175, "user_id": 6146720, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-aqmyOqDEWGY/AAAAAAAAAAI/AAAAAAAAAMY/KshiuhjrGnc/photo.jpg?sz=128", "display_name": "Stewart Whitman", "link": "https://stackoverflow.com/users/6146720/stewart-whitman"}, "edited": false, "score": 0, "creation_date": 1461867326, "post_id": 36896382, "comment_id": 61406432, "body": "This is a good utility that does take the data and put it as text in Excel.   However, as stated above in my corrected question, PowerPoint handles this different and ignores the &quot;read as text&quot; marker that Excel accepts."}], "tags": [], "owner": {"reputation": 51, "user_id": 6262666, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/22065b2693cca558b7107ebd5fbc9f33?s=128&d=identicon&r=PG&f=1", "display_name": "Swaffle", "link": "https://stackoverflow.com/users/6262666/swaffle"}, "is_accepted": false, "score": 0, "last_activity_date": 1461776742, "creation_date": 1461776742, "answer_id": 36896382, "question_id": 36893436, "link": "https://stackoverflow.com/questions/36893436/vba-powerpoint-formatting-and/36896382#36896382", "title": "vba powerpoint formatting % and $", "body": "<p>You didn't specify what exactly you want to do with the data in the CSV file, but I've assumed you're trying to open the file in VBA.</p>\n\n<p>If you are opening the CSV file using OpenText (as below) then Excel will automatically parse the data in the format it sees fit. eg:</p>\n\n<pre><code>Workbooks.OpenText fileName:=\"directory\", DataType:=xlDelimited, Comma:=True\n</code></pre>\n\n<p>You can use a different method to open the CSV file if you want VBA to handle the data as just text which you can use as you see fit. </p>\n\n<pre><code>Sub OpenCSVFile()\nDim ff As Long, iRow As Long, iCol As Long\nDim FilePath As String\nDim FileBuffer As String            'Entire CSV file as one string\nDim LineSeparatedFile() As String   'Array of data separated into lines\nDim LineData() As String            'Array of comma separated values for that line\n\nff = FreeFile\nOpen FilePath For Binary Access Read As #ff\nFileBuffer = Space$(LOF(ff))\nGet #ff, , FileBuffer\nClose #ff\nLineSeparatedFile = Split(txtBuffer, vbCrLf)\n\nFor iRow = 0 To UBound(LineSeparatedFile)\n    LineData = Split(LineSeparatedFile(i), \",\")\n    For iCol = 0 To UBound(LineData)\n        'Code to do something with each entry.\n        'Eg. print to cell as text\n        ThisWorkbook.Sheets(1).Cells(iRow + 1, iCol + 1).NumberFormat = \"@\"\n        ThisWorkbook.Sheets(1).Cells(iRow + 1, iCol + 1).Value = LineData(iCol)\n    Next iCol\nNext iRow\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 175, "user_id": 6146720, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-aqmyOqDEWGY/AAAAAAAAAAI/AAAAAAAAAMY/KshiuhjrGnc/photo.jpg?sz=128", "display_name": "Stewart Whitman", "link": "https://stackoverflow.com/users/6146720/stewart-whitman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 160, "favorite_count": 0, "closed_date": 1461777611, "answer_count": 1, "score": 0, "last_activity_date": 1462206929, "creation_date": 1461768733, "last_edit_date": 1531161705, "question_id": 36893436, "link": "https://stackoverflow.com/questions/36893436/vba-powerpoint-formatting-and", "closed_reason": "Duplicate", "title": "vba powerpoint formatting % and $", "body": "<p>I am having a challenge with how MSOffice deals with number formats. </p>\n\n<p>While I believe this is similar root cause to: <a href=\"https://stackoverflow.com/questions/165042/stop-excel-from-automatically-converting-certain-text-values-to-dates\">Stop Excel from automatically converting certain text values to dates</a></p>\n\n<p>It is different as this is not a date format and this involves both Excel and PowerPoint with VBA.</p>\n\n<p>I have data that I am pulling out of a dB into CSV files and I am doing a <code>.Replace</code> on certain text markers (e.g. @@ReplaceText@@) in a PPT template. (There is a good post on the site on how to do this I can't seem to locate now)</p>\n\n<p>There is one field I need to deal with which is tracking a metric, this field is text in my dB, but it can contain special characters - specifically $ and %.</p>\n\n<p>e.g. I could see the following values in the CSV file:\n\"increase market share\",\"1234\",\"$10\",\"28%\"  </p>\n\n<p>I want VBA to treat this all as text, so the % and $ characters are maintained...but...  Excel reads the data as a number and keeps the $ or % sign. PowerPoint removes the $ or % sign and converts 28% to 0.28 and $10 to 10.</p>\n\n<p>Per the above question, adding <code>\"=\"\"28%\"\"\"</code> to the .csv in Excel, will give me that exact literal text in PowerPoint.</p>\n\n<p>Adding a preceding <code>space</code> or <code>'</code> character works in forcing Excel to read the data as text string. But PowerPoint ignores it and behaves same as above. Eg 28% to 0.28. </p>\n\n<p>I tried using FORMAT as below, but because the data is variable, I don't know which case to apply.</p>\n\n<p><code>sCurrentText = Format(sCurrentText, \"$#\")</code> \nor \n<code>sCurrentText = Format(sCurrentText, \"0.0%\")</code></p>\n\n<p>If statements don't work because the $ or % are not present in what VBA sees (e.g the $ or % character is already gone)</p>\n\n<p><code>If sCurrentText Like \"*$*\" Then</code> or <code>If sCurrentText Like \"*%\" Then</code></p>\n\n<p>So my question is how do I force VBA to take what is in the CSV file as text and ignore processing $ or % as special characters and just maintain them in the CSV?</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 36, "user_id": 5897519, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-uKlpJD431fo/AAAAAAAAAAI/AAAAAAAAAAA/S0t2jE4EBkQ/photo.jpg?sz=128", "display_name": "Sen", "link": "https://stackoverflow.com/users/5897519/sen"}, "is_accepted": true, "score": 2, "last_activity_date": 1461767890, "creation_date": 1461767890, "answer_id": 36893064, "question_id": 36892930, "link": "https://stackoverflow.com/questions/36892930/how-to-save-as-excel-and-vba-project-for-future-use/36893064#36893064", "title": "How to save as excel and vba project for future use?", "body": "<p><strong>xlsx</strong> only for data sheet. When you have VBA code in your excel workbook you should save as <strong>Excel Macro-Enabled workbook (*.xlsm)</strong> </p>\n"}, {"tags": [], "owner": {"reputation": 890, "user_id": 4537270, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/ihOUv.jpg?s=128&g=1", "display_name": "XsiSec", "link": "https://stackoverflow.com/users/4537270/xsisec"}, "is_accepted": false, "score": 3, "last_activity_date": 1461768392, "last_edit_date": 1461768392, "creation_date": 1461768082, "answer_id": 36893148, "question_id": 36892930, "link": "https://stackoverflow.com/questions/36892930/how-to-save-as-excel-and-vba-project-for-future-use/36893148#36893148", "title": "How to save as excel and vba project for future use?", "body": "<p>Hello Schadrack Rurangwa**,</p>\n\n<p>There a couple ways to do this.</p>\n\n<p><strong>Altenative One:</strong></p>\n\n<p>save the vba file to <strong>\"<em>.bas\"</strong><br>\n1. Click on menu Tools->Macro->Visual Basic Editor<br>\n2. This will open Visual Basic Editor<br>\n3. In the visual basic editor, select menu File-> Rightclick somewhere in the module and select export file. (save your module \"</em>.bas\" somewhere).<br></p>\n\n<p><em>Next time you start excel and want to use your VBA-Macro, just navigate to:<br>\nTools>Macro->Visual Basic Editor> Rightlclick somewhere in the module and import the <strong>\"</em>.bas\"</strong> file.* </p>\n\n<p><strong>Altenative two:</strong>\nYou could save the file Excelfile as <strong>\"*.xlsm\"</strong><br>\n(A file with the XLSM file extension is an Excel Macro-Enabled Workbook file)<br></p>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 13008235, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/4c8ee2be484960c9aa06bec0c7e37fdf?s=128&d=identicon&r=PG", "display_name": "user13008235", "link": "https://stackoverflow.com/users/13008235/user13008235"}, "is_accepted": false, "score": 1, "last_activity_date": 1583350023, "creation_date": 1583350023, "answer_id": 60533375, "question_id": 36892930, "link": "https://stackoverflow.com/questions/36892930/how-to-save-as-excel-and-vba-project-for-future-use/60533375#60533375", "title": "How to save as excel and vba project for future use?", "body": "<p>Macros can be stored in individual workbooks or available for a user in all workbooks opened if they are stored in C:\\Users\\nnn\\AppData\\Roaming\\Microsoft\\Excel\\XLSTART\\ PERSONAL.XLSB.</p>\n\n<p>For more info see <a href=\"https://support.office.com/en-us/article/create-and-save-all-your-macros-in-a-single-workbook-66c97ab3-11c2-44db-b021-ae005a9bc790\" rel=\"nofollow noreferrer\">https://support.office.com/en-us/article/create-and-save-all-your-macros-in-a-single-workbook-66c97ab3-11c2-44db-b021-ae005a9bc790</a></p>\n"}], "owner": {"reputation": 381, "user_id": 5804831, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/IXuOh.jpg?s=128&g=1", "display_name": "Schadrack Rurangwa", "link": "https://stackoverflow.com/users/5804831/schadrack-rurangwa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3981, "favorite_count": 0, "accepted_answer_id": 36893064, "answer_count": 3, "score": 1, "last_activity_date": 1583350023, "creation_date": 1461767577, "last_edit_date": 1531164843, "question_id": 36892930, "link": "https://stackoverflow.com/questions/36892930/how-to-save-as-excel-and-vba-project-for-future-use", "title": "How to save as excel and vba project for future use?", "body": "<p>How can I save as xlsx my project?\nI try to do my project in excel with vba but I do know how to save it for future use.\nIf I save as excel sheet, vba will not be saved to it, I do know how to do that save.\nIs there someone who has an idea to this problem?</p>\n\n<p>Please anyone can help me.</p>\n"}, {"tags": ["excel", "vba", "internet-explorer", "automation", "dispatchevent"], "comments": [{"owner": {"reputation": 51, "user_id": 6257067, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/21ca35949d737a5fce818a41c3d8b392?s=128&d=identicon&r=PG&f=1", "display_name": "CasWalker", "link": "https://stackoverflow.com/users/6257067/caswalker"}, "edited": false, "score": 0, "creation_date": 1461774978, "post_id": 36892918, "comment_id": 61355780, "body": "Some more information I&#39;ve figured out, id=&quot;G_grdProfile&quot; acts as an EventListener for the cell I want to &quot;click&quot; or run an event for, &quot;grdProfile_rc_0_2&quot;. So knowing that, how would I build that in to dispatch?"}, {"owner": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "edited": false, "score": 0, "creation_date": 1533452869, "post_id": 36892918, "comment_id": 90345895, "body": "This is useful <a href=\"http://exceldevelopmentplatform.blogspot.com/2018/02/vba-ie-createevent-and-dispatchevent-to.html\" rel=\"nofollow noreferrer\">exceldevelopmentplatform.blogspot.com/2018/02/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 51, "user_id": 6257067, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/21ca35949d737a5fce818a41c3d8b392?s=128&d=identicon&r=PG&f=1", "display_name": "CasWalker", "link": "https://stackoverflow.com/users/6257067/caswalker"}, "is_accepted": true, "score": 0, "last_activity_date": 1461960039, "creation_date": 1461960039, "answer_id": 36946559, "question_id": 36892918, "link": "https://stackoverflow.com/questions/36892918/dispatchevent-vba-ie-automation/36946559#36946559", "title": "dispatchEvent - VBA IE automation", "body": "<p>I figured out what needed to occur was a few mouse events had to fire to move forward. </p>\n\n<p>I ended up setting the cell in the table that I wanted to click and used fireEvent to fire all of the onmouse* events that had to happen.</p>\n\n<pre><code>     Set objLink = IE1.document.frames(\"mainParent\").document.forms(\"AgentProfileList\").document.getElementById(\"grdProfile_r_0\").document.getElementById(\"grdProfile_rc_0_2\")\n objLink.fireEvent (\"onmouseover\")\n objLink.fireEvent (\"onmousedown\")\n objLink.fireEvent (\"onmouseup\")\n</code></pre>\n"}], "owner": {"reputation": 51, "user_id": 6257067, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/21ca35949d737a5fce818a41c3d8b392?s=128&d=identicon&r=PG&f=1", "display_name": "CasWalker", "link": "https://stackoverflow.com/users/6257067/caswalker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2694, "favorite_count": 0, "accepted_answer_id": 36946559, "answer_count": 1, "score": 0, "last_activity_date": 1461960039, "creation_date": 1461767543, "question_id": 36892918, "link": "https://stackoverflow.com/questions/36892918/dispatchevent-vba-ie-automation", "title": "dispatchEvent - VBA IE automation", "body": "<p>I have a question I can't seem to figure out the answer to regarding how to dispatch an event in VBA. </p>\n\n<p>On the website I am trying to navigate via VBA, there is a dynamic table id=\"G_grdProfile\". In the table html, there are events listed. The table itself is dynamic. At minimum there will always be a row with the id=\"grdProfile_r_0\". Within that row, there are cells that can be clicked. There can be id=\"grdProfile_rc_0_0\", grdProfile_rc_0_1\", etc. </p>\n\n<p>I assume I need to dispatch the event in relation to the row or individual cell within the row, but I can't seem to get it to work. From using developer tools in Chrome and IE, it looks like either the ondblclick or onmousedown events are fired when a cell (other than 17) is clicked.\nAnd .click does not return an error, but does not do anything.</p>\n\n<p>My code is:</p>\n\n<pre><code>     With ie\n While .Busy Or .ReadyState &lt;&gt; 4: DoEvents: Wend\n Application.Wait (Now + TimeValue(\"0:00:02\"))\n Set objLink = .Document.frames(\"mainParent\").Document.forms(\"AgentProfileList\").Document.getElementById(\"G_grdProfile\").Document.getElementById(\"grdProfile_r_0\").Document.getElementById(\"grdProfile_rc_0_2\")\n objLink.dispatchEvent (\"onmousedown\")\n End With        \n</code></pre>\n\n<p>The HTML referenced above for this section is:</p>\n\n<pre><code>&lt;TABLE onmouseup='igtbl_cellClickUp(event,\"grdProfile\");' onmouseover='igtbl_cellMouseOver(event,\"grdProfile\");' ondblclick='igtbl_cellDblClick(event,\"grdProfile\");' onmousemove='igtbl_cellMouseMove(event,\"grdProfile\");' onmousedown='igtbl_cellClickDown(event,\"grdProfile\");' onmouseout='igtbl_cellMouseOut(event,\"grdProfile\");' id=G_grdProfile onselectstart='igtbl_selectStart(event,\"grdProfile\");' style=\"WIDTH: 978px; TABLE-LAYOUT: fixed; POSITION: relative\" oncontextmenu='igtbl_cellContextMenu(event,\"grdProfile\");' cellSpacing=0 cellPadding=0 border=0 bandNo=\"0\"&gt;&lt;COLGROUP&gt;\n\n&lt;TR id=grdProfile_r_0 style=\"HEIGHT: 20px\" DataKey=\"XXXXX3658\"&gt;&lt;TD id=grdProfile_rc_0_0 class=\"ig_2e49b359_r1 GRSHand\"&gt;&lt;NOBR&gt;&lt;SPAN id=fup_agentstdsearch_3765545&gt;&lt;A onclick='javascript:xfupshow(\"fup_agentstdsearch_3765545\");' href=\"javascript:void(0);\"&gt;&lt;IMG border=0 src=\"https://xchange.reged.com/ctiacom/images/flag000.gif\"&gt;&lt;/A&gt;&lt;/SPAN&gt;&amp;nbsp;&amp;nbsp;&lt;/NOBR&gt;&lt;/TD&gt;\n&lt;TD id=grdProfile_rc_0_1 class=\"ig_2e49b359_r1 GRSHand\" style=\"DISPLAY: none\" iDV=\"False\"&gt;&lt;NOBR&gt;&lt;INPUT tabIndex=-1 onpropertychange='igtbl_chkBoxChange(event,\"grdProfile\");' type=checkbox&gt;&lt;/NOBR&gt;&lt;/TD&gt;\n&lt;TD id=grdProfile_rc_0_2 class=\"ig_2e49b359_r1 GRSHand\"&gt;&lt;NOBR&gt;*LastName*&lt;/NOBR&gt;&lt;/TD&gt;\n&lt;TD id=grdProfile_rc_0_3 class=\"ig_2e49b359_r1 GRSHand\"&gt;&lt;NOBR&gt;*FIrstName*&lt;/NOBR&gt;&lt;/TD&gt;\n&lt;TD id=grdProfile_rc_0_4 class=\"ig_2e49b359_r1 GRSHand\"&gt;&lt;NOBR&gt;*MiddleName*&lt;/NOBR&gt;&lt;/TD&gt;\n&lt;TD id=grdProfile_rc_0_5 class=\"ig_2e49b359_r1 GRSHand\" style=\"DISPLAY: none\"&gt;&lt;NOBR&gt;3765545&lt;/NOBR&gt;&lt;/TD&gt;\n&lt;TD id=grdProfile_rc_0_6 class=\"ig_2e49b359_r1 GRSHand\"&gt;&lt;NOBR&gt;*ID*&lt;/NOBR&gt;&lt;/TD&gt;\n&lt;TD id=grdProfile_rc_0_7 class=\"ig_2e49b359_r1 GRSHand\"&gt;&lt;NOBR&gt;*ID2*&lt;/NOBR&gt;&lt;/TD&gt;\n&lt;TD id=grdProfile_rc_0_8 class=\"ig_2e49b359_r1 GRSHand\"&gt;&lt;NOBR&gt;&amp;nbsp;&lt;/NOBR&gt;&lt;/TD&gt;\n&lt;TD id=grdProfile_rc_0_9 class=\"ig_2e49b359_r1 GRSHand\"&gt;&lt;NOBR&gt;*ID3*&lt;/NOBR&gt;&lt;/TD&gt;\n&lt;TD id=grdProfile_rc_0_10 class=\"ig_2e49b359_r1 GRSHand\" style=\"DISPLAY: none\"&gt;&lt;NOBR&gt;*ID2*&lt;/NOBR&gt;&lt;/TD&gt;\n&lt;TD id=grdProfile_rc_0_11 class=\"ig_2e49b359_r1 GRSHand\" style=\"DISPLAY: none\"&gt;&lt;NOBR&gt;*Location*&lt;/NOBR&gt;&lt;/TD&gt;\n&lt;TD id=grdProfile_rc_0_12 class=\"ig_2e49b359_r1 GRSHand\" style=\"DISPLAY: none\"&gt;&lt;NOBR&gt;PROD&lt;/NOBR&gt;&lt;/TD&gt;\n&lt;TD id=grdProfile_rc_0_13 class=\"ig_2e49b359_r1 GRSHand\" style=\"DISPLAY: none\"&gt;&lt;NOBR&gt;0&lt;/NOBR&gt;&lt;/TD&gt;\n&lt;TD id=grdProfile_rc_0_14 class=\"ig_2e49b359_r1 GRSHand\" style=\"DISPLAY: none\"&gt;&lt;NOBR&gt;7040&lt;/NOBR&gt;&lt;/TD&gt;\n&lt;TD id=grdProfile_rc_0_15 class=\"ig_2e49b359_r1 GRSHand\" style=\"DISPLAY: none\"&gt;&lt;NOBR&gt;&amp;nbsp;&lt;/NOBR&gt;&lt;/TD&gt;\n&lt;TD id=grdProfile_rc_0_16 class=\"ig_2e49b359_r1 GRSHand\" style=\"DISPLAY: none\"&gt;&lt;NOBR&gt;&amp;nbsp;&lt;/NOBR&gt;&lt;/TD&gt;\n&lt;TD id=grdProfile_rc_0_17 class=\"ig_2e49b359_r1 GRSHand\"&gt;&lt;NOBR&gt;&lt;A onclick=\"viewProfile('3765545','*LastName* *FirstName*');\" href=\"javascript:void(0);\"&gt;View Profile Summary&lt;/A&gt;&lt;/NOBR&gt;&lt;/TD&gt;\n&lt;TD id=grdProfile_rc_0_18 class=\"ig_2e49b359_r1 GRSHand\" style=\"DISPLAY: none\"&gt;&lt;NOBR&gt;&amp;nbsp;&lt;/NOBR&gt;&lt;/TD&gt;\n&lt;TD id=grdProfile_rc_0_19 class=\"ig_2e49b359_r1 GRSHand\" style=\"DISPLAY: none\"&gt;&lt;NOBR&gt;&amp;nbsp;&lt;/NOBR&gt;&lt;/TD&gt;\n&lt;TD id=grdProfile_rc_0_20 class=\"ig_2e49b359_r1 GRSHand\" style=\"DISPLAY: none\"&gt;&lt;NOBR&gt;&amp;nbsp;&lt;/NOBR&gt;&lt;/TD&gt;\n&lt;TD id=grdProfile_rc_0_21 class=\"ig_2e49b359_r1 GRSHand\" style=\"DISPLAY: none\"&gt;&lt;NOBR&gt;&amp;nbsp;&lt;/NOBR&gt;&lt;/TD&gt;&lt;/TR&gt;\n</code></pre>\n\n<p>Any ideas, or am I even using dispatchEvent properly?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1743, "user_id": 3629691, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RkvSZ.jpg?s=128&g=1", "display_name": "CodeJockey", "link": "https://stackoverflow.com/users/3629691/codejockey"}, "edited": false, "score": 0, "creation_date": 1461767615, "post_id": 36892501, "comment_id": 61350069, "body": "What happens when you try to use it?  How does it fail?"}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 1, "creation_date": 1461767898, "post_id": 36892501, "comment_id": 61350311, "body": "If <b>A12</b> is isolated, then <code>CurrentRegion</code> will be a single cell and <code>Arr</code> will not be an array and the <code>Resize</code> will fail."}, {"owner": {"reputation": 43, "user_id": 6113503, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/f3ed83498602f199aa4c85c02889aefc?s=128&d=identicon&r=PG&f=1", "display_name": "shinpencil", "link": "https://stackoverflow.com/users/6113503/shinpencil"}, "edited": false, "score": 0, "creation_date": 1461807172, "post_id": 36892501, "comment_id": 61371253, "body": "It must be this error. How can I correct it plz?"}], "owner": {"reputation": 43, "user_id": 6113503, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/f3ed83498602f199aa4c85c02889aefc?s=128&d=identicon&r=PG&f=1", "display_name": "shinpencil", "link": "https://stackoverflow.com/users/6113503/shinpencil"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 417, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1461767609, "creation_date": 1461766597, "question_id": 36892501, "link": "https://stackoverflow.com/questions/36892501/vba-import-csv-file-to-excel", "title": "VBA Import CSV file to excel", "body": "<p>I have an VBA code to import CSV file (35 columns, 80 rows) into Excel, it worked well at the beginning but it don't work for certain files. Where is the problem in my code?</p>\n\n<pre><code>Dim Wb As Workbook\nDim Arr\n\n    Set Wb = GetObject(Application.GetOpenFilename(\"csv file,*.csv\", , \"please choose a csv file\", , False))\n    Arr = Wb.ActiveSheet.Range(\"A12\").CurrentRegion\n    Wb.Close False\n    Range(\"A12\").Resize(UBound(Arr), UBound(Arr, 2)) = Arr\n</code></pre>\n"}, {"tags": ["ms-access", "vba"], "answers": [{"tags": [], "owner": {"reputation": 494, "user_id": 5761401, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/3cb5bcce0a5ee06973be7948aec5c5e2?s=128&d=identicon&r=PG&f=1", "display_name": "LuckyLuke82", "link": "https://stackoverflow.com/users/5761401/luckyluke82"}, "is_accepted": true, "score": 0, "last_activity_date": 1461819849, "last_edit_date": 1461819849, "creation_date": 1461766762, "answer_id": 36892582, "question_id": 36892165, "link": "https://stackoverflow.com/questions/36892165/access-prevent-second-form-to-open-in-different-record/36892582#36892582", "title": "Access - prevent second form to open in different record", "body": "<p>Solved, here is what I had to do:</p>\n\n<pre><code>  If Not CurrentProject.AllForms(\"MySecondForm\").IsLoaded Then\n\n      DoCmd.OpenForm \"MyThirdForm\", , , \"ID=\" &amp; Forms![MainForm].Form![ID]\n\n   ElseIf CurrentProject.AllForms(\"MySecondForm\").IsLoaded Then\n\n      DoCmd.OpenForm \"MyThirdForm\", , , \"ID=\" &amp; Forms![MainForm].Form![ID]\n\n      If Forms![MyThirdForm].Form![ID] = Forms![MySecondForm].Form![ID] Then\n\n              'Do nothing\n\n      Else\n\n      MsgBox \"Error. You cannot open both forms in different records !\", vbCritical\n              DoCmd.Close acForm, \"MyThirdform\"\n              Exit Sub\n\n      End If\n\n   End If\n</code></pre>\n\n<p>If anybody has solution that would prevent opening form, please post. This solution opens form, checks record ID's and then closes form, which is not exactly perfect.</p>\n"}], "owner": {"reputation": 494, "user_id": 5761401, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/3cb5bcce0a5ee06973be7948aec5c5e2?s=128&d=identicon&r=PG&f=1", "display_name": "LuckyLuke82", "link": "https://stackoverflow.com/users/5761401/luckyluke82"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 50, "favorite_count": 0, "accepted_answer_id": 36892582, "answer_count": 1, "score": 0, "last_activity_date": 1461819849, "creation_date": 1461765810, "question_id": 36892165, "link": "https://stackoverflow.com/questions/36892165/access-prevent-second-form-to-open-in-different-record", "title": "Access - prevent second form to open in different record", "body": "<p>I have a form from which I can Access 2 another forms. I can do that by clicking into selected record. What I want to do is prevent user to open second form in any different record that first form is allready opened. So far I have tried this (in Current event of 1st form - let me call It Main form):</p>\n\n<pre><code>If CurrentProject.AllForms(\"MySecondForm\").IsLoaded And CurrentProject.AllForms(\"MyThirdForm\").IsLoaded Then\n   If Forms![MySecondForm].Form![ID] = Forms![MyThirdForm].Form![ID] Then\n        'do nothing\n\n   Else\n\n   ...\n\n   MsgBox \"Error. You cannot open both forms in different records !\"\n\n   End If\n\nEnd If\n</code></pre>\n\n<p>Any ideas on which event I need to use code, and how to prevent that ?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 414, "user_id": 2923617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vJbkH.jpg?s=128&g=1", "display_name": "NiH", "link": "https://stackoverflow.com/users/2923617/nih"}, "edited": false, "score": 0, "creation_date": 1461765903, "post_id": 36891930, "comment_id": 61348668, "body": "first line: &quot;ByVal Target As Row&quot; should be &quot;ByVal Target As Range&quot;"}, {"owner": {"reputation": 1444, "user_id": 2696497, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6d01be1a281ffad5a8dd64a70d1013ef?s=128&d=identicon&r=PG&f=1", "display_name": "ryansin", "link": "https://stackoverflow.com/users/2696497/ryansin"}, "reply_to_user": {"reputation": 414, "user_id": 2923617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vJbkH.jpg?s=128&g=1", "display_name": "NiH", "link": "https://stackoverflow.com/users/2923617/nih"}, "edited": false, "score": 0, "creation_date": 1461766198, "post_id": 36891930, "comment_id": 61348878, "body": "Thanks, amended the question"}, {"owner": {"reputation": 206726, "user_id": 5459839, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iehrR.jpg?s=128&g=1", "display_name": "trincot", "link": "https://stackoverflow.com/users/5459839/trincot"}, "edited": false, "score": 0, "creation_date": 1461766588, "post_id": 36891930, "comment_id": 61349158, "body": "Are you really assigning <code>&quot;New Value&quot;</code>? Can you reproduce the problem with the exact code as you have given it in your question? (except for the password of course)"}, {"owner": {"reputation": 1444, "user_id": 2696497, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6d01be1a281ffad5a8dd64a70d1013ef?s=128&d=identicon&r=PG&f=1", "display_name": "ryansin", "link": "https://stackoverflow.com/users/2696497/ryansin"}, "edited": false, "score": 0, "creation_date": 1461768918, "post_id": 36891930, "comment_id": 61351171, "body": "The value being assigned isn&#39;t relevant. If I assign <code>&quot;New Value&quot;</code>, it would still shows the same error. This has been sorted now anyway."}], "answers": [{"comments": [{"owner": {"reputation": 1444, "user_id": 2696497, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6d01be1a281ffad5a8dd64a70d1013ef?s=128&d=identicon&r=PG&f=1", "display_name": "ryansin", "link": "https://stackoverflow.com/users/2696497/ryansin"}, "edited": false, "score": 1, "creation_date": 1461768857, "post_id": 36892529, "comment_id": 61351123, "body": "Thank you, spot on"}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": true, "score": 3, "last_activity_date": 1461767032, "last_edit_date": 1461767032, "creation_date": 1461766661, "answer_id": 36892529, "question_id": 36891930, "link": "https://stackoverflow.com/questions/36891930/excel-vba-sheet-being-protected-too-quickly/36892529#36892529", "title": "Excel VBA - sheet being protected too quickly", "body": "<p>You are changing cells with the event macro.</p>\n\n<p>You must:</p>\n\n<pre><code>Application.EnableEvents = False\n</code></pre>\n\n<p>before the <code>For</code> loop and</p>\n\n<pre><code>Application.EnableEvents = True\n</code></pre>\n\n<p>after the <code>For</code> loop.</p>\n"}], "owner": {"reputation": 1444, "user_id": 2696497, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6d01be1a281ffad5a8dd64a70d1013ef?s=128&d=identicon&r=PG&f=1", "display_name": "ryansin", "link": "https://stackoverflow.com/users/2696497/ryansin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 87, "favorite_count": 0, "accepted_answer_id": 36892529, "answer_count": 1, "score": 1, "last_activity_date": 1461767032, "creation_date": 1461765264, "last_edit_date": 1461766342, "question_id": 36891930, "link": "https://stackoverflow.com/questions/36891930/excel-vba-sheet-being-protected-too-quickly", "title": "Excel VBA - sheet being protected too quickly", "body": "<p>I have a VBA macro that loops through cells whose values have been changed and amends the values of other cells in the same row.</p>\n\n<pre><code>Public Sub Worksheet_Change (ByVal Target As Range)\n    Dim r As Integer\n    Application.ScreenUpdating = false\n    ' Unprotect the sheet\n    ActiveSheet.Unprotect(\"password\")\n\n    Set newRange = Range(\"K:K\")\n\n    If Not Application.Intersect(newRange, Range(Target.Address)) Is Nothing Then\n        For Each cell in Target.Cells       \n            ' Change the values of cells in the same row\n            r = cell.Row\n\n            Cells(r, 2).Value = \"New Value\"\n            Cells(r, 3).Value = \"New Value\"   ' Debug highlights this line\n            Cells(r, 4).Value = \"New Value\"\n            Cells(r, 5).Value = \"New Value\"\n\n        Next\n\n\n    End If\n\n    ' Reprotect the sheet\n    ActiveSheet.Protect Password:=\"password\", AllowFormattingCells:=True, AllowFormattingColumns:=True, AllowFormattingRows:=True, _\n        AllowSorting:=True, AllowFiltering:=True, AllowUsingPivotTables:=True\n    Application.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n\n<p>Without unprotecting/reprotecting the sheet the macro works fine, but when added it generates a Runtime Error <code>Application-Defined or Object-Defined error</code>, but not before changing the first cell value <code>Cells(r, 2).Value = \"New Value\"</code>. </p>\n\n<p>I can only assume that this is because the sheet is unprotected at the start and the first cell value change completes before the sheet is then locked (perhaps running in a separate thread to the For loop?). The macro then errors at the following line because it is trying to make a change to a protected sheet.</p>\n\n<p>How can I fix this and prevent the sheet from locking too quickly?</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 27, "user_id": 6237673, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/1301750139838330/picture?type=large", "display_name": "James Page", "link": "https://stackoverflow.com/users/6237673/james-page"}, "edited": false, "score": 0, "creation_date": 1461767586, "post_id": 36892570, "comment_id": 61350042, "body": "for clarification, wbNew.Sheets(wsName).UsedRange.Value = wbNew.Sheets(wsName).UsedRange.Value is the statement that is changing all cells to values right now?"}, {"owner": {"reputation": 116, "user_id": 6229756, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0YZvj.jpg?s=128&g=1", "display_name": "Jason Conway", "link": "https://stackoverflow.com/users/6229756/jason-conway"}, "reply_to_user": {"reputation": 27, "user_id": 6237673, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/1301750139838330/picture?type=large", "display_name": "James Page", "link": "https://stackoverflow.com/users/6237673/james-page"}, "edited": false, "score": 0, "creation_date": 1461768107, "post_id": 36892570, "comment_id": 61350489, "body": "That&#39;s right, so instead within the loop you can use wbNew.Sheets(wsName).Columns(ValArr(x)).Value = wbNew.Sheets(wsName).Columns(ValArr(x)).Value or code to that effect. Let me know how it goes!"}, {"owner": {"reputation": 27, "user_id": 6237673, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/1301750139838330/picture?type=large", "display_name": "James Page", "link": "https://stackoverflow.com/users/6237673/james-page"}, "edited": false, "score": 0, "creation_date": 1461769402, "post_id": 36892570, "comment_id": 61351555, "body": "More complex than I thought, My original sheet has dependencies on another sheet in that workbook.  My code now copy&#39;s original sheet values to the new workbook.  I need to change original columns to values before sheet is copied to new workbook so I don&#39;t lose the data and get #REF?.  What I liked about my current code is the original sheet was left unchanged.    I&#39;m thinking if I duplicate the original sheet as a temp sheet, run your loop to convert columns in ValArr to values, save and open the temp sheet in new workbook and delete tempsheet from original workbook and continue my macro."}, {"owner": {"reputation": 116, "user_id": 6229756, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0YZvj.jpg?s=128&g=1", "display_name": "Jason Conway", "link": "https://stackoverflow.com/users/6229756/jason-conway"}, "reply_to_user": {"reputation": 27, "user_id": 6237673, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/1301750139838330/picture?type=large", "display_name": "James Page", "link": "https://stackoverflow.com/users/6237673/james-page"}, "edited": false, "score": 0, "creation_date": 1461769687, "post_id": 36892570, "comment_id": 61351752, "body": "Just so my understanding is correct, you&#39;re getting formula errors after the sheet has been copied to the new workbook? If that&#39;s the case then what you&#39;re describing should work, create a temporary sheet etc."}, {"owner": {"reputation": 27, "user_id": 6237673, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/1301750139838330/picture?type=large", "display_name": "James Page", "link": "https://stackoverflow.com/users/6237673/james-page"}, "edited": false, "score": 0, "creation_date": 1461769951, "post_id": 36892570, "comment_id": 61351958, "body": "yes, the original sheet pulls most of its data from another sheet, hence why they need to be converted to values.  This is one heck of a learning experience for me haha"}, {"owner": {"reputation": 1378, "user_id": 3501751, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/cJ4g9.jpg?s=128&g=1", "display_name": "Charlie", "link": "https://stackoverflow.com/users/3501751/charlie"}, "edited": false, "score": 0, "creation_date": 1461770710, "post_id": 36892570, "comment_id": 61352552, "body": "But copy and paste works? I would say that&#39;s a separate question something like &quot;how to dynamically change formula sheet references.&quot;"}, {"owner": {"reputation": 27, "user_id": 6237673, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/1301750139838330/picture?type=large", "display_name": "James Page", "link": "https://stackoverflow.com/users/6237673/james-page"}, "edited": false, "score": 0, "creation_date": 1461771641, "post_id": 36892570, "comment_id": 61353247, "body": "I&#39;ve actually solved it by recording a macro and doing by hand copy paste, and just copying the generated code.  Final question, now that I have correct values/formulas for each column, what can I change the statement  wbNew.Sheets(wsName).UsedRange.Value = wbNew.Sheets(wsName).UsedRange.Value  to so that it just copies data as it is, not converting to values"}, {"owner": {"reputation": 116, "user_id": 6229756, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0YZvj.jpg?s=128&g=1", "display_name": "Jason Conway", "link": "https://stackoverflow.com/users/6229756/jason-conway"}, "reply_to_user": {"reputation": 1378, "user_id": 3501751, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/cJ4g9.jpg?s=128&g=1", "display_name": "Charlie", "link": "https://stackoverflow.com/users/3501751/charlie"}, "edited": false, "score": 0, "creation_date": 1461771913, "post_id": 36892570, "comment_id": 61353478, "body": "As @Charlie stated below, if you use .Formula instead of .Value if there is a formula it will copy that, else it will just copy the text. That should do the trick."}], "tags": [], "owner": {"reputation": 116, "user_id": 6229756, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0YZvj.jpg?s=128&g=1", "display_name": "Jason Conway", "link": "https://stackoverflow.com/users/6229756/jason-conway"}, "is_accepted": true, "score": 0, "last_activity_date": 1461766732, "creation_date": 1461766732, "answer_id": 36892570, "question_id": 36891594, "link": "https://stackoverflow.com/questions/36891594/change-existing-macro-to-copy-formulas-from-specific-columns/36892570#36892570", "title": "Change existing macro to copy formulas from specific columns", "body": "<p>As you say I think the best step is to copy all as formulas initially. What I would do next is define an array which contains the column letters which you need to be values, you can do that as follows.</p>\n\n<pre><code>ValArr = Array(\"A\",\"E\",\"F\",\"H\",\"I\",\"J\",\"K\",\"L\",\"M\",\"N\",\"T\",\"U\",\"V\",\"W\",\"X\")\n</code></pre>\n\n<p>Then you can loop through this array and turn each column to values.</p>\n\n<pre><code>For x = Lbound(ValArr) To Ubound(ValArr)\n    'Paste values in column ValArr(x)\nNext\n</code></pre>\n\n<p>I hope this helps, let me know if you need any more clarification.</p>\n"}, {"comments": [{"owner": {"reputation": 27, "user_id": 6237673, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/1301750139838330/picture?type=large", "display_name": "James Page", "link": "https://stackoverflow.com/users/6237673/james-page"}, "edited": false, "score": 0, "creation_date": 1461772077, "post_id": 36894160, "comment_id": 61353594, "body": "I get what this is doing but not sure how to apply it.  I&#39;ve got it creating the temp sheet with no dependencies and values/formulas as they should be....now I need this temp sheet opened in a new workbook as it appears.  The code I&#39;m using now is wbNew.Sheets(wsName).UsedRange.Value = wbNew.Sheets(wsName).UsedRange.Value which will not work for that"}, {"owner": {"reputation": 27, "user_id": 6237673, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/1301750139838330/picture?type=large", "display_name": "James Page", "link": "https://stackoverflow.com/users/6237673/james-page"}, "edited": false, "score": 0, "creation_date": 1461772218, "post_id": 36894160, "comment_id": 61353700, "body": "ahhh change .Value to .Formula ..let&#39;s try that!"}, {"owner": {"reputation": 27, "user_id": 6237673, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/1301750139838330/picture?type=large", "display_name": "James Page", "link": "https://stackoverflow.com/users/6237673/james-page"}, "edited": false, "score": 0, "creation_date": 1461787942, "post_id": 36894160, "comment_id": 61364089, "body": "I&#39;ve made incredible progress on this, big thanks to everyone for helping me !"}], "tags": [], "owner": {"reputation": 1378, "user_id": 3501751, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/cJ4g9.jpg?s=128&g=1", "display_name": "Charlie", "link": "https://stackoverflow.com/users/3501751/charlie"}, "is_accepted": false, "score": 0, "last_activity_date": 1461770598, "creation_date": 1461770598, "answer_id": 36894160, "question_id": 36891594, "link": "https://stackoverflow.com/questions/36891594/change-existing-macro-to-copy-formulas-from-specific-columns/36894160#36894160", "title": "Change existing macro to copy formulas from specific columns", "body": "<p>You can do it without any copy and pasting. For example let's say you want to copy all the formulas from Sheet1 to Sheet2 you can do something like this:</p>\n\n<pre><code>for i = 1 to lastRow\n    for j in 1 to lastCol\n        Sheets(\"Sheet2\").cells(i,j).formula = Sheets(\"Sheet1\").cells(i,j).formula\n    next j\nnext i\n</code></pre>\n\n<p>Also if there's no formula it just copies the text so you can do that for all the cells.</p>\n"}], "owner": {"reputation": 27, "user_id": 6237673, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/1301750139838330/picture?type=large", "display_name": "James Page", "link": "https://stackoverflow.com/users/6237673/james-page"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 205, "favorite_count": 0, "accepted_answer_id": 36892570, "answer_count": 2, "score": 1, "last_activity_date": 1461770598, "creation_date": 1461764454, "last_edit_date": 1461766793, "question_id": 36891594, "link": "https://stackoverflow.com/questions/36891594/change-existing-macro-to-copy-formulas-from-specific-columns", "title": "Change existing macro to copy formulas from specific columns", "body": "<p>This is my still my first macro, I have been searching like a mad man trying to get this to work...and it's getting close!</p>\n\n<p>I have it set to copy \"Pricing_Cost\" sheet from Active workbook into a new workbook as values and then manipulate it beyond that.  What I really need is to modify that step so that certain columns copy values, others copy formulas.  I have columns A:X</p>\n\n<p>Columns needing to be pasted as values = A,E,F,H,I,J,K,L,M,N,T,U,V,W,X</p>\n\n<p>Columns needing to pasted as formula = B,C,D,G,O,P,Q,R,S</p>\n\n<p>This is within the CopyRemoveFormSave sub</p>\n\n<p>I'm guessing maybe I should copy the whole thing as formulas and then cut and paste as values the columns that need to be converted to values?  Not really sure how to do that with the code I have here...</p>\n\n<pre><code>    Public strFile As String\nSub RunAll()\n    Call load_csv\n    Call CopyRemoveFormAndSave\n    Call Splitbook\nEnd Sub\nSub load_csv()\n\n    Dim fStr As String\n\nWith Application.FileDialog(msoFileDialogFilePicker)\n    .Show\n    If .SelectedItems.Count = 0 Then\n        MsgBox \"Cancel Selected\"\n        Exit Sub\n    End If\n    'fStr is the file path and name of the file you selected.\n    fStr = .SelectedItems(1)\nEnd With\n\nSheets(\"Product_Weekly\").UsedRange.ClearContents\n\nWith ThisWorkbook.Sheets(\"Product_Weekly\").QueryTables.Add(Connection:= _\n\"TEXT;\" &amp; fStr, Destination:=ThisWorkbook.Sheets(\"Product_Weekly\").Range(\"$A$1\"))\n    .Name = \"CAPTURE\"\n    .FieldNames = True\n    .RowNumbers = False\n    .FillAdjacentFormulas = False\n    .PreserveFormatting = True\n    .RefreshOnFileOpen = False\n    .RefreshStyle = xlInsertDeleteCells\n    .SavePassword = False\n    .SaveData = True\n    .AdjustColumnWidth = True\n    .RefreshPeriod = 0\n    .TextFilePromptOnRefresh = False\n    .TextFilePlatform = 437\n    .TextFileStartRow = 1\n    .TextFileParseType = xlDelimited\n    .TextFileTextQualifier = xlTextQualifierDoubleQuote\n    .TextFileConsecutiveDelimiter = False\n    .TextFileTabDelimiter = True\n    .TextFileSemicolonDelimiter = True\n    .TextFileCommaDelimiter = False\n    .TextFileSpaceDelimiter = False\n    .TextFileColumnDataTypes = Array(1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1)\n    .TextFileTrailingMinusNumbers = True\n    .Refresh BackgroundQuery:=False\n\nEnd With\nEnd Sub\n\n\nDeclare PtrSafe Function GetTempPath Lib \"kernel32\" Alias \"GetTempPathA\" _\n(ByVal nBufferLength As Long, ByVal lpBuffer As String) As Long\n\nPrivate Const MAX_PATH As Long = 260\n\n'~~&gt; Function to get user's temp directoy\nFunction TempPath() As String\n    TempPath = String$(MAX_PATH, Chr$(0))\n    GetTempPath MAX_PATH, TempPath\n    TempPath = Replace(TempPath, Chr$(0), \"\")\nEnd Function\n\n\nSub CopyRemoveFormAndSave()\n\n    Dim wb As Workbook, wbNew As Workbook\n    Dim ws As Worksheet\n    Dim wsName As String, NewName As String\n'    Dim shp As Shape\n\nSet wb = ThisWorkbook\n\nwsName = ActiveSheet.Name\n\nNewName = wsName &amp; \".xlsm\"\n\nwb.SaveCopyAs TempPath &amp; NewName\n\nSet wbNew = Workbooks.Open(TempPath &amp; NewName)\n\nwbNew.Sheets(wsName).UsedRange.Value = wbNew.Sheets(wsName).UsedRange.Value\n\nApplication.DisplayAlerts = False\nFor Each ws In wbNew.Worksheets\n    If ws.Name &lt;&gt; wsName Then ws.Delete\nNext ws\nApplication.DisplayAlerts = True\n\n'    For Each shp In wbNew.Sheets(wsName).Shapes\n'        If shp.Type = 8 Then shp.Delete\n'    Next\n\n'\n'~~&gt; Do a save as for the new workbook if required.\n'\n'End Sub\n\nColumns(\"W:W\").Replace \"2\", \"KevinClark\", xlWhole\nColumns(\"W:W\").Replace \"9\", \"PaulG\", xlWhole\nColumns(\"W:W\").Replace \"O\", \"KevinClark\", xlWhole\nColumns(\"W:W\").Replace \"I\", \"KevinClark\", xlWhole\nColumns(\"W:W\").Replace \"4\", \"PaulG\", xlWhole\nColumns(\"W:W\").Replace \"8\", \"KevinClark\", xlWhole\nColumns(\"W:W\").Replace \"7\", \"KevinClark\", xlWhole\n\n\n'Sub SplitData()\nConst NameCol = \"W\"\nConst HeaderRow = 3\nConst FirstRow = 4\nDim SrcSheet As Worksheet\nDim TrgSheet As Worksheet\nDim SrcRow As Long\nDim LastRow As Long\nDim TrgRow As Long\nDim Buyer As String\nApplication.ScreenUpdating = False\nSet SrcSheet = ActiveSheet\nLastRow = SrcSheet.Cells(SrcSheet.Rows.Count, NameCol).End(xlUp).Row\nFor SrcRow = FirstRow To LastRow\n    Buyer = SrcSheet.Cells(SrcRow, NameCol).Value\n    Set TrgSheet = Nothing\n    On Error Resume Next\n    Set TrgSheet = Worksheets(Buyer)\n    On Error GoTo 0\n    If TrgSheet Is Nothing Then\n        Set TrgSheet = Worksheets.Add(After:=Worksheets(Worksheets.Count))\n        TrgSheet.Name = Buyer\n'            SrcSheet.Range(HeaderRow).Copy Destination:=TrgSheet.Range(HeaderRow)\n        SrcSheet.Range(\"A1:W3\").Copy Destination:=TrgSheet.Range(\"A1:W3\")\n    End If\n    TrgRow = TrgSheet.Cells(TrgSheet.Rows.Count, NameCol).End(xlUp).Row + 1\n    SrcSheet.Rows(SrcRow).Copy Destination:=TrgSheet.Rows(TrgRow)\nNext SrcRow\nApplication.ScreenUpdating = True\n\nDim sht As Worksheet\n\n''AutoFit One Column\n'    ThisWorkbook.Worksheets(\"Sheet1\").Columns(\"O:O\").EntireColumn.AutoFit\n'\n''AutoFit Multiple Columns\n'    ThisWorkbook.Worksheets(\"Sheet1\").Range(\"I:I,L:L\").EntireColumn.AutoFit 'Columns I &amp; L\n'    ThisWorkbook.Worksheets(\"Sheet1\").Range(\"I:L\").EntireColumn.AutoFit 'Columns I to L\n'\n''AutoFit All Columns on Worksheet\n'    ThisWorkbook.Worksheets(\"Sheet1\").Cells.EntireColumn.AutoFit\n\n'AutoFit Every Worksheet Column in a Workbook\nFor Each sht In wbNew.Worksheets\n    sht.Cells.EntireColumn.AutoFit\nNext sht\n\n\nEnd Sub\n\nSub Splitbook()\n'Updateby20140612\nDim xPath As String\nxPath = \"C:\\Users\\Jimbo.JAMESP-ACERLT\\Documents\\For Gary\\Output\"\n    Application.ScreenUpdating = False\n    Application.DisplayAlerts = False\nFor Each xWs In ActiveWorkbook.Sheets\n    If xWs.Name &lt;&gt; \"Pricing Cost\" Then\n    xWs.Copy\n    Application.ActiveWorkbook.SaveAs Filename:=xPath &amp; \"\\\" &amp; xWs.Name &amp; \".xlsx\"\n    Application.ActiveWorkbook.Close False\n    End If\n  Next\n    Application.DisplayAlerts = True\n    Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n"}, {"tags": ["arrays", "vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 697, "user_id": 1041958, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/k80sC.jpg?s=128&g=1", "display_name": "StormsEdge", "link": "https://stackoverflow.com/users/1041958/stormsedge"}, "edited": false, "score": 0, "creation_date": 1461764467, "post_id": 36891433, "comment_id": 61347486, "body": "Thanks very much for this john.  I didn&#39;t realize you were unable to initialize arrays by array literals.  That fixed the problem.  Thanks very much.  Soon as I am able to I will select your answer as the appropriate one."}], "tags": [], "owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "is_accepted": true, "score": 3, "last_activity_date": 1461764096, "creation_date": 1461764096, "answer_id": 36891433, "question_id": 36891278, "link": "https://stackoverflow.com/questions/36891278/error-initializing-array-type-mismatch/36891433#36891433", "title": "Error Initializing Array *Type Mismatch*", "body": "<p>VBA doesn't support initialization of arrays by array literals. It does, however, have an <a href=\"https://msdn.microsoft.com/en-us/library/aa262675(v=vs.60).aspx\" rel=\"nofollow\">Array()</a> function:</p>\n\n<pre><code>Dim tradesMasterListColumnIndexArray As Variant\nDim newExcelConfirmColumnIndexArray As variant\n\ntradesMasterListColumnIndexArray = Array(1,4,firmLocationColumn,(firmLocationColumn - 1),(firmLocationColumn + 3),15,16,10,11,8,19,18,17,(firmLocationColumn + 4),9,6,2)\nnewExcelConfirmColumnIndexArray = Array(1,2,3,4,5,7,8,9,10,11,12,13,14,15,16,17,18)\n</code></pre>\n"}], "owner": {"reputation": 697, "user_id": 1041958, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/k80sC.jpg?s=128&g=1", "display_name": "StormsEdge", "link": "https://stackoverflow.com/users/1041958/stormsedge"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 119, "favorite_count": 0, "accepted_answer_id": 36891433, "answer_count": 1, "score": 1, "last_activity_date": 1461764096, "creation_date": 1461763747, "question_id": 36891278, "link": "https://stackoverflow.com/questions/36891278/error-initializing-array-type-mismatch", "title": "Error Initializing Array *Type Mismatch*", "body": "<p>Attempting to utilize two arrays to iterate through a data transfer process by copy and pasting cells from one sheet into a newly created one.  The code below is merely responsible for copy and pasting the correct data in the correct order from one sheet to the newly created one.  I'm receiving a type mismatch when attempting to initialize the arrays.  It occurs on the first array, but I haven't gotten to the second array to test that yet, so it could be wrong as well.</p>\n\n<p><strong>Things to Note:</strong> 1) firmLocationColumn is of type long. 2) All the data stored in said arrays are meant to represent column numbers.  They are out of order so I needed to store them in the array in the proper order so that it's easier to iterate through them rather than writing the same information over and over again.  </p>\n\n<p>Let me know if I missed anything that needs to be explained and i'll edit my question:</p>\n\n<pre><code>Private Sub GetSpecificTradeDetails(ByVal masterListRow As Long, ByVal firmLocationColumn As Long, ByVal newExcelConfirmSheet As Worksheet, ByVal newExcelConfirmSheetLastRow As Long)\n\n    Dim tradesMasterListColumnIndexArray() As Long\n    Dim newExcelConfirmColumnIndexArray() As Long\n    Dim arrayIndexCounter As Long\n\n    'Sets array of columns for loop iteration through data sheet\n    tradesMasterListColumnIndexArray() = [1,4,firmLocationColumn,(firmLocationColumn - 1),(firmLocationColumn + 3),15,16,10,11,8,19,18,17,(firmLocationColumn + 4),9,6,2]\n    newExcelConfirmColumnIndexArray() = [1,2,3,4,5,7,8,9,10,11,12,13,14,15,16,17,18]\n\n    Select Case firmLocationColumn\n\n        Case 25\n\n            'Sets confirm direction to \"BUY\"\n            newExcelConfirmSheet.Cells((newExcelConfirmSheetLastRow + 1), 6) = \"BUY\"\n\n        Case 27\n\n            'Sets confirm direction to \"SELL\"\n            newExcelConfirmSheet.Cells((newExcelConfirmSheetLastRow + 1), 6) = \"SELL\"\n\n    End Select\n\n    'Transfers trade details between the masterlist and the newly created confirm sheet\n    With TradesMasterSheet\n\n        For arrayIndexCounter = 0 To 17\n\n            .Cells(masterListRow, tradesMasterListColumnIndexArray(arrayIndexCounter)).Copy _\n                Destination:=newExcelConfirmSheet.Cells((newExcelConfirmSheetLastRow + 1), newExcelConfirmColumnIndexArray(arrayIndexCounter))\n\n        Next\n\n    End With\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 1482, "user_id": 5043393, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/effb702a40d17cd670f56f051847b33f?s=128&d=identicon&r=PG&f=1", "display_name": "LiamH", "link": "https://stackoverflow.com/users/5043393/liamh"}, "edited": false, "score": 0, "creation_date": 1461763804, "post_id": 36891233, "comment_id": 61346905, "body": "Do you want the user to input the description?"}, {"owner": {"reputation": 3, "user_id": 6134490, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/98a44a92158709e92556ce9494563d3b?s=128&d=identicon&r=PG&f=1", "display_name": "Ignasis", "link": "https://stackoverflow.com/users/6134490/ignasis"}, "reply_to_user": {"reputation": 1482, "user_id": 5043393, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/effb702a40d17cd670f56f051847b33f?s=128&d=identicon&r=PG&f=1", "display_name": "LiamH", "link": "https://stackoverflow.com/users/5043393/liamh"}, "edited": false, "score": 0, "creation_date": 1461856284, "post_id": 36891233, "comment_id": 61399293, "body": "sorry for late reply LiamH,  No, it&#39;s just a button which should open that folder and the user might not know the exact description.  thanks for your time"}, {"owner": {"reputation": 3, "user_id": 6134490, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/98a44a92158709e92556ce9494563d3b?s=128&d=identicon&r=PG&f=1", "display_name": "Ignasis", "link": "https://stackoverflow.com/users/6134490/ignasis"}, "reply_to_user": {"reputation": 1482, "user_id": 5043393, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/effb702a40d17cd670f56f051847b33f?s=128&d=identicon&r=PG&f=1", "display_name": "LiamH", "link": "https://stackoverflow.com/users/5043393/liamh"}, "edited": false, "score": 0, "creation_date": 1462031215, "post_id": 36891233, "comment_id": 61471459, "body": "Any help would be greatly appreciated, thanks"}], "answers": [{"tags": [], "owner": {"reputation": 14672, "user_id": 8967612, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EEhyd.png?s=128&g=1", "display_name": "41686d6564", "link": "https://stackoverflow.com/users/8967612/41686d6564"}, "is_accepted": true, "score": 0, "last_activity_date": 1462055550, "creation_date": 1462055550, "answer_id": 36960967, "question_id": 36891233, "link": "https://stackoverflow.com/questions/36891233/call-shell-only-know-part-of-the-filename/36960967#36960967", "title": "Call shell - only know part of the filename", "body": "<p>You could use a helper function to get you the <em>actual</em> folder path.. something like the following:</p>\n\n<pre><code>Function GetSubFolderByPartial(sRootPath As String, sSub As String) As String\n    Dim oFso As Object\n    Dim oTopFolder As Object\n    Dim oSubs As Object\n    Dim oFolder As Object\n\n    Set oFso = CreateObject(\"Scripting.FileSystemObject\")\n    Set oTopFolder = oFso.GetFolder(sRootPath)\n    Set oSubs = oTopFolder.SubFolders\n    For Each oFolder In oSubs\n        If oFolder.Name Like sSub &amp; \"*\" Then\n            GetSubFolderByPartial = oFolder.Path\n            Set oFso = Nothing\n            Exit Function\n        End If\n    Next\nEnd Function\n</code></pre>\n\n<p>So, you can simply call it like this:</p>\n\n<pre><code>Carpeta = GetSubFolderByPartial(\"C:\\Folder1\\Folder2\", A\u00f1o &amp; \".\" &amp; Numero &amp; \".\")\nIf Len(Carpeta) &gt; 0 Then\n    Call Shell(\"explorer.exe \" &amp; Carpeta, vbNormalFocus)\nEnd If\n</code></pre>\n\n<p>Hope that helps</p>\n"}], "owner": {"reputation": 3, "user_id": 6134490, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/98a44a92158709e92556ce9494563d3b?s=128&d=identicon&r=PG&f=1", "display_name": "Ignasis", "link": "https://stackoverflow.com/users/6134490/ignasis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 57, "favorite_count": 0, "accepted_answer_id": 36960967, "answer_count": 1, "score": 0, "last_activity_date": 1462055550, "creation_date": 1461763633, "last_edit_date": 1462052421, "question_id": 36891233, "link": "https://stackoverflow.com/questions/36891233/call-shell-only-know-part-of-the-filename", "title": "Call shell - only know part of the filename", "body": "<p>My macro creates folders named year.number.description (2016.185.Hello). </p>\n\n<p>The problem is that this name may be changed, so for example, after some days someone renames it to 2016.185.Hi</p>\n\n<p>In the same macro there is an option to open that folder.</p>\n\n<p>I thought that adding \".*\" would work but it seems not.</p>\n\n<pre><code>Private Sub cmdNumero_Click()\n\nDim Carpeta As String\nA\u00f1o = Me.txtAny.Value\nNumero = Me.txtNumero.Value\n\nCarpeta = \"C:\\Folder1\\Folder2\" &amp; \"\\\" &amp; A\u00f1o &amp; \".\" &amp; Numero &amp; \".*\"\n\nCall Shell(\"explorer.exe \" &amp; Carpeta, vbNormalFocus)\n\nEnd Sub\n</code></pre>\n\n<p>Thanks for your attention</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 1, "creation_date": 1461769412, "post_id": 36891143, "comment_id": 61351562, "body": "Your question is unclear. <code>copy for each not empty row</code> then you proceed to write <code>a subset row of it</code>. What does subset mean? The row immediately below? How do you determine where the &quot;subset&quot; starts?"}, {"owner": {"reputation": 353, "user_id": 4536454, "user_type": "registered", "accept_rate": 27, "profile_image": "https://i.stack.imgur.com/cFU4F.jpg?s=128&g=1", "display_name": "Noomak", "link": "https://stackoverflow.com/users/4536454/noomak"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1461840177, "post_id": 36891143, "comment_id": 61386716, "body": "simply a subset row is made by n column where n&lt;number of column for each row, maybe what I wrote describe better: &quot;my subset copy source starts from column E up to the last not empty column&quot;"}], "owner": {"reputation": 353, "user_id": 4536454, "user_type": "registered", "accept_rate": 27, "profile_image": "https://i.stack.imgur.com/cFU4F.jpg?s=128&g=1", "display_name": "Noomak", "link": "https://stackoverflow.com/users/4536454/noomak"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 80, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1461763417, "creation_date": 1461763417, "question_id": 36891143, "link": "https://stackoverflow.com/questions/36891143/vba-how-to-copy-a-row-subset-from-a-sheet-to-another", "title": "VBA how to copy a row subset from a sheet to another", "body": "<p>I want to copy for each not empty row in first sheet (wsIn), a subset row of it in second sheet (wsGruppo)</p>\n\n<p>my subset copy source starts from column E up to the last not empty column (at right) ....each row is processed inside a while loop (rowOut index)</p>\n\n<p>my paste column in second sheet is column H at row x (x has its own increment)</p>\n\n<p>I did this stuff but it loops:</p>\n\n<pre><code>Range(\"E\" &amp; rowOut).Select\nRange(Selection, Selection.End(xlToRight)).Select\nSelection.Copy\nwsGruppo.Select\nwsGruppo.Cells.Range(\"H\" &amp; rowOut2).Select\nActiveSheet.Paste\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 143, "user_id": 3744785, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/9d9a62c86cd7c316ba19d954f66e6d0c?s=128&d=identicon&r=PG&f=1", "display_name": "Windmill", "link": "https://stackoverflow.com/users/3744785/windmill"}, "edited": false, "score": 0, "creation_date": 1461765039, "post_id": 36891099, "comment_id": 61347923, "body": "Thanks Rory almost exactly what i&#39;m after, whats best way for me to only make my cell changes to cells selected in one particular column as at the minute this will make changes to any cell selected with in the table, as my tables are modified by end users who many accidentally select other cells in the table not belonging to the column I&#39;m wanting to modify"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "reply_to_user": {"reputation": 143, "user_id": 3744785, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/9d9a62c86cd7c316ba19d954f66e6d0c?s=128&d=identicon&r=PG&f=1", "display_name": "Windmill", "link": "https://stackoverflow.com/users/3744785/windmill"}, "edited": false, "score": 0, "creation_date": 1461765113, "post_id": 36891099, "comment_id": 61347988, "body": "Sorry - I missed that. I have amended the code accordingly."}], "tags": [], "owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "is_accepted": true, "score": 1, "last_activity_date": 1461765096, "last_edit_date": 1461765096, "creation_date": 1461763282, "answer_id": 36891099, "question_id": 36890900, "link": "https://stackoverflow.com/questions/36890900/excel-vba-determine-if-the-cell-is-selected-in-a-table-then-run-script/36891099#36891099", "title": "Excel vba determine If the Cell is selected in a table Then run script", "body": "<p>I'd suggest you change the logic to only loop through any selected cells in that column:</p>\n\n<pre><code>If Not Intersect(tb.DataBodyRange, Selection) Is Nothing Then\n    For Each cell In Intersect(tb.ListColumns(1).DataBodyRange, Selection).Cells\n        ' do something to cell\n    Next cell\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 143, "user_id": 3744785, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/9d9a62c86cd7c316ba19d954f66e6d0c?s=128&d=identicon&r=PG&f=1", "display_name": "Windmill", "link": "https://stackoverflow.com/users/3744785/windmill"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2814, "favorite_count": 0, "accepted_answer_id": 36891099, "answer_count": 1, "score": 0, "last_activity_date": 1461765096, "creation_date": 1461762813, "last_edit_date": 1531164843, "question_id": 36890900, "link": "https://stackoverflow.com/questions/36890900/excel-vba-determine-if-the-cell-is-selected-in-a-table-then-run-script", "title": "Excel vba determine If the Cell is selected in a table Then run script", "body": "<p>I currently run code that loops though a column of data in a table and want to modify my code below that if the cell is selected run my script/macro</p>\n\n<pre><code>Dim tb As Listobject\nDim Currcell, i As Integer\n\nSet tb = Worksheets(\"Sheet1\").ListObjects(\"Table1\")\n\nFor i = 1 To 60\n    Currcell = tb.DataBodyRange.Cells(i, tb.ListColumns(1).Index)\n    If Currcell = Selected Then\n    ' Run My Script\nEnd If\nNext i\n</code></pre>\n\n<p>I know the code is crude but hopefully you get the idea \"Currcell\" suppose to represent if the cell is selected or not. Thanks inadvance</p>\n"}, {"tags": ["vba", "excel", "sharepoint", "sharepoint-2010"], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 6261448, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/98874db4dc847fbf54a4c12638780fdb?s=128&d=identicon&r=PG&f=1", "display_name": "First", "link": "https://stackoverflow.com/users/6261448/first"}, "edited": false, "score": 0, "creation_date": 1461835763, "post_id": 36891597, "comment_id": 61383645, "body": "Tanks for your answer. But it doesn&#39;t work, I have no error from Excel but the file is not exported. It perfectly works with a drag and drop but not with the macro ( I verify the path 20 times and it is right ). I am not considered as an admin on my computer, it&#39;s maybe due to that."}, {"owner": {"reputation": 11, "user_id": 6261448, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/98874db4dc847fbf54a4c12638780fdb?s=128&d=identicon&r=PG&f=1", "display_name": "First", "link": "https://stackoverflow.com/users/6261448/first"}, "edited": false, "score": 0, "creation_date": 1461845649, "post_id": 36891597, "comment_id": 61390697, "body": "Ok now it works, I just copied the wrong path, I had the choice between 2 and I&#39;ve chosen the wrong one. Thanks for your help"}], "tags": [], "owner": {"reputation": 233, "user_id": 5818624, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/Ql6J9.jpg?s=128&g=1", "display_name": "Sam Slaughterbeck", "link": "https://stackoverflow.com/users/5818624/sam-slaughterbeck"}, "is_accepted": false, "score": 0, "last_activity_date": 1461764458, "creation_date": 1461764458, "answer_id": 36891597, "question_id": 36890249, "link": "https://stackoverflow.com/questions/36890249/how-to-export-an-excel-graph-to-sharepoint/36891597#36891597", "title": "how to export an Excel graph to sharepoint", "body": "<p>It is possible that you could map a network drive to your SharePoint site/subsite and then have your code export it there. Open up the Windows Explorer, right click on \"Computer\" on the left hand side and click \"Map Network Drive...\". Once the Map Network Drive dialog appears, choose the drive letter you wish to use and in the \"Folder\" dropdown paste in the url to the SharePoint site.</p>\n\n<p><a href=\"https://i.stack.imgur.com/3eHtI.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/3eHtI.png\" alt=\"enter image description here\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/ASyb9.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ASyb9.png\" alt=\"enter image description here\"></a></p>\n\n<p>Then in your code, point your path to this shared drive and where the document library is located.</p>\n\n<pre><code>Fich = \"S:\\DocumentLibrary\\\"\n</code></pre>\n\n<p>Hope that helps!</p>\n"}, {"tags": [], "owner": {"reputation": 58, "user_id": 4455015, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Vwitt.png?s=128&g=1", "display_name": "clarencebuttowski", "link": "https://stackoverflow.com/users/4455015/clarencebuttowski"}, "is_accepted": false, "score": 1, "last_activity_date": 1506519162, "last_edit_date": 1506519162, "creation_date": 1506518411, "answer_id": 46448972, "question_id": 36890249, "link": "https://stackoverflow.com/questions/36890249/how-to-export-an-excel-graph-to-sharepoint/46448972#46448972", "title": "how to export an Excel graph to sharepoint", "body": "<p>I realize this is late but hopefully it is useful to someone else. There is a Windows bug however where the code below will only work if you open up the SharePoint in a browser navigate to the SharePoint library and hit the 'Open with Explorer' button under the Library tab in the Connect &amp; Export section. This only needs to be done one-time per machine. </p>\n\n<p>You can change the file type using the examples I have included below. BMP seems to provide the highest quality image. </p>\n\n<pre><code>Sub PublishSharePoint()\n\n'Unprotect worksheet\nWorksheets(\"My Worksheet\").Unprotect\n\nCall SaveImage(\"My Worksheet\", \"B8:N46\", \"Report Name\")\n\n'Protect worksheet\nWorksheets(\"My Worksheet\").Protect DrawingObjects:=True, Contents:=True, Scenarios:=True\n\nEnd Sub\n</code></pre>\n\n<p>This will call the routine below</p>\n\n<pre><code>Sub SaveImage(sSheet As String, sRange As String, sFile As String)\n\n\nWorksheets(sSheet).Activate\n\nSet Plage = ThisWorkbook.Worksheets(sSheet).Range(sRange)\n\nPlage.CopyPicture\n\nWith ThisWorkbook.Worksheets(sSheet).ChartObjects.Add(Plage.Left, Plage.Top, Plage.Width, Plage.Height)\n.Activate\n.Chart.Paste\n.Chart.ChartArea.Border.LineStyle = xlNone\n'.Chart.Export \"C:\\...\\\" &amp; nameFile &amp; \".png\", \"PNG\"\n'.Chart.Export \"C:\\...\\\" &amp; nameFile &amp; \".jpg\", \"JPG\"\n.Chart.Export \"\\\\url.sharepoint.com\\sites\\SiteAssets\\SitePages\\Page\\\" &amp; sFile &amp; \".bmp\", \"BMP\"\nEnd With\n\nWorksheets(sSheet).ChartObjects(Worksheets(sSheet).ChartObjects.Count).Delete\n\nSet Plage = Nothing\n\nEnd Sub\n</code></pre>\n\n<p>If you want to map the site as a network drive this will also work:</p>\n\n<pre><code>Dim oNetwork As Object\nSet oNetwork = CreateObject(\"WScript.Network\")\noNetwork.MapNetworkDrive \"Z:\", \"http://SharePoint.com/sites/MySite/SiteAssets/SitePages/Report\", False\n</code></pre>\n\n<p>Then remove drive</p>\n\n<pre><code>oNetwork.RemoveNetworkDrive \"Z:\"\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 6261448, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/98874db4dc847fbf54a4c12638780fdb?s=128&d=identicon&r=PG&f=1", "display_name": "First", "link": "https://stackoverflow.com/users/6261448/first"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1081, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1506519162, "creation_date": 1461761138, "last_edit_date": 1461766097, "question_id": 36890249, "link": "https://stackoverflow.com/questions/36890249/how-to-export-an-excel-graph-to-sharepoint", "title": "how to export an Excel graph to sharepoint", "body": "<p>I wanted to know how to export a diagram in sharepoint with an Excel macro. </p>\n\n<p>I've already code a macro to export my graph as a gif picture, here is my code:</p>\n\n<pre><code>Private Sub Workbook_BeforeSave(ByVal SaveAsUI As Boolean, Cancel As Boolean)\n    ExportGraph\nEnd Sub\n\n\nSub ExportGraph()\n    ' D\u00e9claration des variables\n    Dim Sheets As Variant\n    Dim NomSheet As String\n    Dim Graph As Variant\n    Dim NomGraph As String\n    Dim Fich As String\n    Dim i As Byte\n\n    ' Boucle parcourant les feuilles\n    For Each Sheets In ActiveWorkbook.Sheets\n        NomSheet = Sheets.Name\n        ' On parcours les graphiques de la feuille\n        For Each Graph In Sheets.ChartObjects\n            i = i + 1\n\n            ' Selection d'un graphique\n            Sheets.ChartObjects(i).Activate\n\n            ' R\u00e9cup\u00e9ration du nom du graphique\n            NomGraph = ActiveChart.ChartTitle.Characters.Text\n\n            ' Chemin o\u00f9 l'on veut exporter les graphiques\n            Fich = \"d:\\LocalData\\p080931\\Desktop\\racc\\\"\n            ' On lance la proc\u00e9dure d'export\n            ActiveChart.Export Filename:=Fich &amp; NomGraph &amp; \".gif\",\nFilterName:=\"GIF\"\n        Next\n    Next\nEnd Sub\n</code></pre>\n\n<p>But I want to export it directly in my SharePoint document library.</p>\n\n<p>Any idea to do this ? I didn't find a function which work with an URL.</p>\n\n<p>Thanks a lot </p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31, "user_id": 6261405, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bba6189867ff119aab70773934d7ae15?s=128&d=identicon&r=PG&f=1", "display_name": "SSP", "link": "https://stackoverflow.com/users/6261405/ssp"}, "edited": false, "score": 0, "creation_date": 1461761206, "post_id": 36890230, "comment_id": 61344787, "body": "I have a list of those prefixes that needs to be removed form the column"}, {"owner": {"reputation": 607, "user_id": 5707565, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/ffcd648968d49604d218ef197649f1c4?s=128&d=identicon&r=PG&f=1", "display_name": "zaptask", "link": "https://stackoverflow.com/users/5707565/zaptask"}, "edited": false, "score": 0, "creation_date": 1461761532, "post_id": 36890230, "comment_id": 61345044, "body": "How does the list of prefixes look like? Will you have an entry &quot;Prof.Dr.med.&quot; or &quot;Prof.&quot; and &quot;Dr.&quot; and &quot;med.&quot; as separate entries?"}, {"owner": {"reputation": 1987, "user_id": 4434652, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/94ee978abf31b6cb604ec929a54ae4e1?s=128&d=identicon&r=PG&f=1", "display_name": "Brian", "link": "https://stackoverflow.com/users/4434652/brian"}, "edited": false, "score": 0, "creation_date": 1461761534, "post_id": 36890230, "comment_id": 61345047, "body": "I don&#39;t fully understand your question. Can you show an image of the data?"}, {"owner": {"reputation": 414, "user_id": 2923617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vJbkH.jpg?s=128&g=1", "display_name": "NiH", "link": "https://stackoverflow.com/users/2923617/nih"}, "edited": false, "score": 0, "creation_date": 1461762184, "post_id": 36890230, "comment_id": 61345568, "body": "How long is your list?"}], "answers": [{"tags": [], "owner": {"reputation": 1987, "user_id": 4434652, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/94ee978abf31b6cb604ec929a54ae4e1?s=128&d=identicon&r=PG&f=1", "display_name": "Brian", "link": "https://stackoverflow.com/users/4434652/brian"}, "is_accepted": false, "score": 1, "last_activity_date": 1461761320, "creation_date": 1461761320, "answer_id": 36890320, "question_id": 36890230, "link": "https://stackoverflow.com/questions/36890230/how-to-delete-certain-characters-in-a-excel-2013-cells/36890320#36890320", "title": "How to delete Certain Characters in a excel 2013 cells", "body": "<p>Maybe this:</p>\n\n<pre><code>=RIGHT(A1,LEN(A1)-FIND(\".\",A1))\n</code></pre>\n\n<p>Not tested!</p>\n"}, {"comments": [{"owner": {"reputation": 414, "user_id": 2923617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vJbkH.jpg?s=128&g=1", "display_name": "NiH", "link": "https://stackoverflow.com/users/2923617/nih"}, "edited": false, "score": 0, "creation_date": 1461764165, "post_id": 36891048, "comment_id": 61347218, "body": "This will only work if you have only one word of your junk list appearing. If you have for example &quot;Prof. Dr. Jones&quot; and you want to remove &quot;Prof.&quot; and &quot;Dr.&quot;, it will give you unexpected results."}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "reply_to_user": {"reputation": 414, "user_id": 2923617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vJbkH.jpg?s=128&g=1", "display_name": "NiH", "link": "https://stackoverflow.com/users/2923617/nih"}, "edited": false, "score": 0, "creation_date": 1461764411, "post_id": 36891048, "comment_id": 61347444, "body": "@NiH <b>You are correct!</b>, its advantage is that it can handle a large &quot;junk list&quot;"}, {"owner": {"reputation": 414, "user_id": 2923617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vJbkH.jpg?s=128&g=1", "display_name": "NiH", "link": "https://stackoverflow.com/users/2923617/nih"}, "edited": false, "score": 0, "creation_date": 1461764605, "post_id": 36891048, "comment_id": 61347580, "body": "Agreed. And it&#39;s deffinitely faster than a UDF. So the best solution will depend on the exact needs of the OP."}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 2, "last_activity_date": 1461765126, "last_edit_date": 1461765126, "creation_date": 1461763177, "answer_id": 36891048, "question_id": 36890230, "link": "https://stackoverflow.com/questions/36890230/how-to-delete-certain-characters-in-a-excel-2013-cells/36891048#36891048", "title": "How to delete Certain Characters in a excel 2013 cells", "body": "<p>Say we have a list of names in column <strong>A</strong>.  First we list the unwanted junk in column <strong>C</strong> and in <strong>B1</strong> we enter:</p>\n\n<pre><code>=TRIM(SUBSTITUTE(A1,INDEX($C$1:$C$6,SUMPRODUCT(ROW($C$1:$C$6)*ISNUMBER(SEARCH($C$1:$C$6,A1)))),\"\"))\n</code></pre>\n\n<p>and copy down:</p>\n\n<p><a href=\"https://i.stack.imgur.com/qowaN.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/qowaN.png\" alt=\"enter image description here\"></a></p>\n\n<p>Derived from <a href=\"http://answers.microsoft.com/en-us/office/forum/office_2007-excel/formula-to-replace-junk-sub-strings/9030c539-acaa-43d5-8801-78073d6d9b37?auth=1\" rel=\"nofollow noreferrer\">Mike H. answer</a></p>\n"}, {"comments": [{"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 0, "creation_date": 1461764579, "post_id": 36891064, "comment_id": 61347558, "body": "Your <i>UDF</i> approach is a lot more flexible."}], "tags": [], "owner": {"reputation": 414, "user_id": 2923617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vJbkH.jpg?s=128&g=1", "display_name": "NiH", "link": "https://stackoverflow.com/users/2923617/nih"}, "is_accepted": false, "score": 1, "last_activity_date": 1461763762, "last_edit_date": 1461763762, "creation_date": 1461763215, "answer_id": 36891064, "question_id": 36890230, "link": "https://stackoverflow.com/questions/36890230/how-to-delete-certain-characters-in-a-excel-2013-cells/36891064#36891064", "title": "How to delete Certain Characters in a excel 2013 cells", "body": "<p>If you have a very short and fixed-length list of substrings that you want to remove, you could do something like:</p>\n\n<pre><code>= TRIM( SUBSTITUTE( SUBSTITUTE( SUBSTITUTE( SUBSTITUTE( SUBSTITUTE( C1, $A$1, \"\" ), $A$2, \"\" ), $A$3; \"\" ), $A$4, \"\" ), $A$5, \"\" ) )\n</code></pre>\n\n<p>(with your original string in C1 and the range of substringsto be removed in A1:A5) .This is a bit messy though and not quite flexible. If you have no objections to using vba, I would propose to write a UDF similar to this:</p>\n\n<pre><code>Function UDF_MultiSubstitute(text As String, old_text_rng As Range, newText As String)\n\n    Dim curCell As Range\n\n    For Each curCell In old_text_rng\n        text = Replace(text, curCell.Value, newText)\n    Next\n\n    UDF_MultiSubstitute = Trim(text)\n\nEnd Function\n</code></pre>\n\n<p>which you can then invoke as: </p>\n\n<pre><code>= UDF_MultiSubstitute( C1, $A$1:$A$5, \"\" )\n</code></pre>\n\n<p>Obviuosly, you might want to add some error trapping etc. to the vba code</p>\n"}], "owner": {"reputation": 31, "user_id": 6261405, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bba6189867ff119aab70773934d7ae15?s=128&d=identicon&r=PG&f=1", "display_name": "SSP", "link": "https://stackoverflow.com/users/6261405/ssp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 214, "favorite_count": 0, "answer_count": 3, "score": 2, "last_activity_date": 1463194312, "creation_date": 1461761091, "last_edit_date": 1463194312, "question_id": 36890230, "link": "https://stackoverflow.com/questions/36890230/how-to-delete-certain-characters-in-a-excel-2013-cells", "title": "How to delete Certain Characters in a excel 2013 cells", "body": "<p>I have a set of names in a column \"A\" having \"Dr.\", \"Prof.\" as prefix. I need to remove these prefixes and retain only names.</p>\n\n<p><code>**Column A**        **Required only names in column B**\nProf.Dr.med.nameX\nDr.med.nameXX \nProf. name XXX\nDr. XX\nPr.XX\n</code></p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 6402, "user_id": 6245650, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vMp3K.jpg?s=128&g=1", "display_name": "Scratch&#39;N&#39;Purr", "link": "https://stackoverflow.com/users/6245650/scratchnpurr"}, "edited": false, "score": 0, "creation_date": 1461760276, "post_id": 36889871, "comment_id": 61344040, "body": "What is the error you&#39;re getting? Also, you mention that your sheet is <code>filtered_data</code>, yet your code shows <code>filtred_data</code>"}, {"owner": {"reputation": 59, "user_id": 6060931, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/rlp3k.jpg?s=128&g=1", "display_name": "mateos", "link": "https://stackoverflow.com/users/6060931/mateos"}, "reply_to_user": {"reputation": 6402, "user_id": 6245650, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vMp3K.jpg?s=128&g=1", "display_name": "Scratch&#39;N&#39;Purr", "link": "https://stackoverflow.com/users/6245650/scratchnpurr"}, "edited": false, "score": 0, "creation_date": 1461760521, "post_id": 36889871, "comment_id": 61344221, "body": "the error i am getting is run-time error 9  subscript out of range"}, {"owner": {"reputation": 59, "user_id": 6060931, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/rlp3k.jpg?s=128&g=1", "display_name": "mateos", "link": "https://stackoverflow.com/users/6060931/mateos"}, "reply_to_user": {"reputation": 6402, "user_id": 6245650, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vMp3K.jpg?s=128&g=1", "display_name": "Scratch&#39;N&#39;Purr", "link": "https://stackoverflow.com/users/6245650/scratchnpurr"}, "edited": false, "score": 0, "creation_date": 1461760565, "post_id": 36889871, "comment_id": 61344261, "body": "about the name of the sheet just writhed it wrong my fault :D"}, {"owner": {"reputation": 2356, "user_id": 5332500, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/A9pzj.png?s=128&g=1", "display_name": "Rosetta", "link": "https://stackoverflow.com/users/5332500/rosetta"}, "edited": false, "score": 0, "creation_date": 1461760797, "post_id": 36889871, "comment_id": 61344458, "body": "you declare <code>xno</code> as integer, yet checks whether <code>xno</code> is a boolean??"}, {"owner": {"reputation": 2356, "user_id": 5332500, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/A9pzj.png?s=128&g=1", "display_name": "Rosetta", "link": "https://stackoverflow.com/users/5332500/rosetta"}, "edited": false, "score": 0, "creation_date": 1461760895, "post_id": 36889871, "comment_id": 61344537, "body": "why not just declare <code>xno</code> as variant"}, {"owner": {"reputation": 59, "user_id": 6060931, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/rlp3k.jpg?s=128&g=1", "display_name": "mateos", "link": "https://stackoverflow.com/users/6060931/mateos"}, "edited": false, "score": 0, "creation_date": 1461761173, "post_id": 36889871, "comment_id": 61344745, "body": "did so but still have the same error :/"}], "answers": [{"comments": [{"owner": {"reputation": 59, "user_id": 6060931, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/rlp3k.jpg?s=128&g=1", "display_name": "mateos", "link": "https://stackoverflow.com/users/6060931/mateos"}, "edited": false, "score": 0, "creation_date": 1461765255, "post_id": 36890915, "comment_id": 61348107, "body": "yes you are right ,   in the sheet that i am filtering i have 5 column but i want to filter just by the last column which is column E  so after clicking on the button to filter i need to copy all column from A to E but only the filtered data   to the new sheet &quot;filtred_data&quot;"}], "tags": [], "owner": {"reputation": 5345, "user_id": 3561813, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/958afeca6b11ffa0e83b97b516c88dc7?s=128&d=identicon&r=PG&f=1", "display_name": "basodre", "link": "https://stackoverflow.com/users/3561813/basodre"}, "is_accepted": false, "score": 0, "last_activity_date": 1461763878, "last_edit_date": 1461763878, "creation_date": 1461762854, "answer_id": 36890915, "question_id": 36889871, "link": "https://stackoverflow.com/questions/36889871/vba-using-inputbox-to-filter-and-copy-data/36890915#36890915", "title": "VBA- Using inputbox to filter and copy data", "body": "<p>The problem in your case is that you are setting the <code>Found</code> variable to be a single cell by using the <code>Find</code> method. Later in your code, you are trying to copy the <code>A1:F10000</code> of that ONE cell when you write <code>Found.Range(\"A1:F1000\")</code>. </p>\n\n<p>Essentially, your code looks like this (assume <code>Found</code> refers to cell <code>E25</code>):</p>\n\n<pre><code>Range(\"E25\").Range(\"A1:F1000\").Copy\n</code></pre>\n\n<p>Can you see why that would cause an error?</p>\n\n<p>I'd try to offer more help, but it's hard to determine exactly what you want. Can you possibly give more details about your spreadsheet layouts and an example of what you want to happen?</p>\n"}], "owner": {"reputation": 59, "user_id": 6060931, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/rlp3k.jpg?s=128&g=1", "display_name": "mateos", "link": "https://stackoverflow.com/users/6060931/mateos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 490, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1461763878, "creation_date": 1461760167, "last_edit_date": 1461760587, "question_id": 36889871, "link": "https://stackoverflow.com/questions/36889871/vba-using-inputbox-to-filter-and-copy-data", "title": "VBA- Using inputbox to filter and copy data", "body": "<p>i am working on a userform where i puted a button that when i click on it i got an input box where i try to filter data of the  column (E) then after filtering this data  copy  from colum A1 till the value filtered in the column E in another sheet caaled filtred_data  i am using this code this code but it show me a bug dont nw how to fix it </p>\n\n<pre><code>Private Sub CommandButton9_Click()\nDim xno As Integer, Found As Range\nDo\n    xno = Application.InputBox(\"Enter the number of Top communities \", Type:=1)\n    If TypeName(xno) = \"Boolean\" Then Exit Sub\n    Set Found = Columns(\"E\").Find(what:=xno, lookat:=xlWhole, LookIn:=xlValues)\n    If Found Is Nothing Then\n        MsgBox \"the number was not found, please try again !!\", vbInformation\n    Else\n        Found.Range(\"A1:F10000\").Copy Destination:=Sheets(\"filtred_data\").Range(\"A1:F10000\")\n    End If\nLoop\nEnd Sub\n</code></pre>\n\n<p>if anyone can help me please , thank you </p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 65, "user_id": 6239436, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/LjR0J.png?s=128&g=1", "display_name": "bart1701", "link": "https://stackoverflow.com/users/6239436/bart1701"}, "edited": false, "score": 0, "creation_date": 1461762519, "post_id": 36889814, "comment_id": 61345854, "body": "thanks, one q: where should i put your input? Selection.AutoFill Destination:=Range(&quot;M25:M34&quot;) in stead of the range(&quot;M25:M34&quot;) ?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6249873"}, "reply_to_user": {"reputation": 65, "user_id": 6239436, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/LjR0J.png?s=128&g=1", "display_name": "bart1701", "link": "https://stackoverflow.com/users/6239436/bart1701"}, "edited": false, "score": 0, "creation_date": 1461795628, "post_id": 36889814, "comment_id": 61367983, "body": "Put it is place of select copy and paste lines, this one line will select and past the values into the desired range. See my updated answer for formulas."}, {"owner": {"reputation": 65, "user_id": 6239436, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/LjR0J.png?s=128&g=1", "display_name": "bart1701", "link": "https://stackoverflow.com/users/6239436/bart1701"}, "edited": false, "score": 0, "creation_date": 1461837069, "post_id": 36889814, "comment_id": 61384557, "body": "sorry to bother again, but still doesnt work? what am i doing wrong? pls see my original post for my new code"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6249873"}, "is_accepted": true, "score": 2, "last_activity_date": 1461795554, "last_edit_date": 1461795554, "creation_date": 1461760017, "answer_id": 36889814, "question_id": 36889336, "link": "https://stackoverflow.com/questions/36889336/copy-paste-variable-number-rows-autofill/36889814#36889814", "title": "Copy/Paste variable number rows (autofill)", "body": "<p>Use something like this.</p>\n\n<pre><code>Cells(25, 13).Resize(Cells(Rows.Count, 14).End(xlUp).Row - 25).Value = _\nRange(\"N25:N\" &amp; Cells(Rows.Count, 14).End(xlUp).Row).Value\n</code></pre>\n\n<p>That will copy down to the last row for you.</p>\n\n<p>To do this with a range of formulas, use this.</p>\n\n<pre><code>Cells(25, 13).Resize(Cells(Rows.Count, 14).End(xlUp).Row - 25).Formula = _\n    Range(\"N25:N\" &amp; Cells(Rows.Count, 14).End(xlUp).Row).Formula\n</code></pre>\n"}], "owner": {"reputation": 65, "user_id": 6239436, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/LjR0J.png?s=128&g=1", "display_name": "bart1701", "link": "https://stackoverflow.com/users/6239436/bart1701"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 152, "favorite_count": 0, "accepted_answer_id": 36889814, "answer_count": 1, "score": 0, "last_activity_date": 1461837198, "creation_date": 1461758799, "last_edit_date": 1495540779, "question_id": 36889336, "link": "https://stackoverflow.com/questions/36889336/copy-paste-variable-number-rows-autofill", "title": "Copy/Paste variable number rows (autofill)", "body": "<p>I want to copy and paste a few things in one code, difficultly for me: I cannot select a variable row count. I will paste the entire code, but same problem appears 3 times. I want to select a cell, pastevalue it (first part @ \"M25\") than autofill to the last row where there is fill in the table (reference is for example the lenght of fills in the \"L\" column), so it should count those filled rows in the table and not stop @ M34 in my code now, as the rows can be more than that.</p>\n\n<p>I know i should use something from this topic:\n<a href=\"https://stackoverflow.com/questions/14161637/autofill-with-a-dynamic-range\">Autofill with a dynamic range</a></p>\n\n<p>but i cannot figure out how to start at the 25th row and then onwards to where the fills in K stop..</p>\n\n<pre><code>Range(\"B14\").Select\nSelection.Copy\nRange(\"M25\").Select\nSelection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n    :=False, Transpose:=False\nRange(\"M25\").Select\nApplication.CutCopyMode = False\nSelection.AutoFill Destination:=Range**(\"M25:M34\")**\nRange(\"M25:M34\").Select\nRange(\"N25\").Select\nActiveCell.FormulaR1C1 = _\n    \"=INDEX(CLIENTS!C[-8],MATCH(CONTROL!R14C2,CLIENTS!C1,0))\"\nRange(\"N25\").Select\nSelection.Copy\nSelection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n    :=False, Transpose:=False\nApplication.CutCopyMode = False\nSelection.AutoFill Destination:=Range(\"N25:N34\")\nRange(\"N25:N34\").Select\nRange(\"O25\").Select\nActiveCell.FormulaR1C1 = _\n    \"=INDEX(CLIENTS!C[-8],MATCH(CONTROL!R14C2,CLIENTS!C1,0))\"\nRange(\"O25\").Select\nSelection.Copy\nSelection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n    :=False, Transpose:=False\nApplication.CutCopyMode = False\nSelection.AutoFill Destination:=Range(\"O25:O34\")\nRange(\"A25:O25\").Select\nRange(Selection, Selection.End(xlDown)).Select\nSelection.Copy\n</code></pre>\n\n<p>code probably looks ugly, as i just started VBA and try to do much with the record function</p>\n\n<p>thanks</p>\n\n<p>part of new code:</p>\n\n<pre><code>Range(\"B14\").Select\nSelection.Copy\nRange(\"M25\").Select\nSelection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n    :=False, Transpose:=False\nRange(\"M25\").Select\nCells(25, 13).Resize(Cells(Rows.Count, 14).End(xlUp).Row - 25).Value = _\nRange(\"M25:M\" &amp; Cells(Rows.Count, 14).End(xlUp).Row).Value\nRange(\"N25\").Select\n</code></pre>\n"}, {"tags": ["vba", "ms-access", "ms-access-2007"], "comments": [{"owner": {"reputation": 2885, "user_id": 44950, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/bf0aca93d347405746df524f86a965f6?s=128&d=identicon&r=PG", "display_name": "NeedHack", "link": "https://stackoverflow.com/users/44950/needhack"}, "edited": false, "score": 1, "creation_date": 1461759456, "post_id": 36889320, "comment_id": 61343302, "body": "The quality of this post would be improved by shortening it. This way you are more likely to get the answer you are looking for."}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 7784274, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-MadJeO_xcKQ/AAAAAAAAAAI/AAAAAAAAA4k/MdhIQMvkzaw/photo.jpg?sz=128", "display_name": "Hakila ", "link": "https://stackoverflow.com/users/7784274/hakila"}, "is_accepted": false, "score": 0, "last_activity_date": 1490772300, "creation_date": 1490772300, "answer_id": 43087000, "question_id": 36889320, "link": "https://stackoverflow.com/questions/36889320/name-error-while-using-convertcurrencytoenglish-function-in-access-report/43087000#43087000", "title": "#Name? error while using ConvertCurrencyToEnglish function in access report", "body": "<p>I maybe late answering your question. Did you use Access 2016?</p>\n\n<p>I also faced the same problem when copy my system from Access 2010 to Access 2016. Then, I copy these file : mscomct2.ocx and mscomct2 in: \"C:\\Program Files (x86)\\Microsoft Office\\Office16\\\" on the machine running Access 2016.</p>\n\n<p>Maybe here can help u to find the files.</p>\n\n<p><a href=\"https://www.ocxme.com/files/mscomct2_ocx\" rel=\"nofollow noreferrer\">https://www.ocxme.com/files/mscomct2_ocx</a></p>\n\n<p>Hope this will help you..</p>\n"}], "owner": {"reputation": 1, "user_id": 5366498, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-wEYf9pdabUE/AAAAAAAAAAI/AAAAAAAAAgU/6foKHt0pheQ/photo.jpg?sz=128", "display_name": "Neelam", "link": "https://stackoverflow.com/users/5366498/neelam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 368, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1513158667, "creation_date": 1461758759, "last_edit_date": 1513158667, "question_id": 36889320, "link": "https://stackoverflow.com/questions/36889320/name-error-while-using-convertcurrencytoenglish-function-in-access-report", "title": "#Name? error while using ConvertCurrencyToEnglish function in access report", "body": "<p>im using below function for converting amount into words</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Function ConvertCurrencyToEnglish(ByVal MyNumber)\n  Dim Temp\n         Dim Rupees, Paise\n         Dim DecimalPlace, Count\n\n         ReDim Place(9) As String\n         Place(2) = \" Thousand \"\n         Place(3) = \" lakh \"\n         Place(4) = \" Crore \"     \n\n         ' Convert MyNumber to a string, trimming extra spaces.\n         MyNumber = Trim(Str(MyNumber))\n\n         ' Find decimal place.\n         DecimalPlace = InStr(MyNumber, \".\")\n\n         ' If we find decimal place...\n         If DecimalPlace &gt; 0 Then\n            ' Convert Paise\n            Temp = Left(Mid(MyNumber, DecimalPlace + 1) &amp; \"00\", 2)\n            ' Hi! Note the above line Mid function it gives right portion\n            ' after the decimal point\n            'if only . and no numbers such as 789. accures, mid returns nothing\n            ' to avoid error we added 00\n            ' Left function gives only left portion of the string with specified places here 2\n\n            Paise = ConvertTens(Temp)\n\n            ' Strip off paise from remainder to convert.\n            MyNumber = Trim(Left(MyNumber, DecimalPlace - 1))\n         End If\n\n         Count = 1\n        If MyNumber &lt;&gt; \"\" Then\n\n            ' Convert last 3 digits of MyNumber to Indian Rupees.\n            Temp = ConvertHundreds(Right(MyNumber, 3))\n\n            If Temp &lt;&gt; \"\" Then Rupees = Temp &amp; Place(Count) &amp; Rupees\n\n            If Len(MyNumber) &gt; 3 Then\n               ' Remove last 3 converted digits from MyNumber.\n               MyNumber = Left(MyNumber, Len(MyNumber) - 3)\n            Else\n               MyNumber = \"\"\n            End If\n        End If\n\n            ' convert last two digits to of mynumber\n            Count = 2\n\n            Do While MyNumber &lt;&gt; \"\"\n            Temp = ConvertTens(Right(\"0\" &amp; MyNumber, 2))\n\n            If Temp &lt;&gt; \"\" Then Rupees = Temp &amp; Place(Count) &amp; Rupees\n            If Len(MyNumber) &gt; 2 Then\n               ' Remove last 2 converted digits from MyNumber.\n               MyNumber = Left(MyNumber, Len(MyNumber) - 2)\n\n            Else\n               MyNumber = \"\"\n            End If\n            Count = Count + 1\n\n            Loop\n\n         ' Clean up rupees.\n         Select Case Rupees\n            Case \"\"\n               Rupees = \"\"\n            Case \"One\"\n               Rupees = \"One Rupee\"\n            Case Else\n               Rupees = Rupees &amp; \" Rupees\"\n         End Select\n\n         ' Clean up paise.\n         Select Case Paise\n            Case \"\"\n               Paise = \"\"\n            Case \"One\"\n               Paise = \"One Paise\"\n            Case Else\n               Paise = Paise &amp; \" Paise\"\n         End Select\n\n         If Rupees = \"\" Then\n         ConvertCurrencyToEnglish = Paise\n         ElseIf Paise = \"\" Then\n         ConvertCurrencyToEnglish = Rupees\n         Else\n         ConvertCurrencyToEnglish = Rupees &amp; \" and \" &amp; Paise\n         End If\n\nEnd Function\n\nPrivate Function ConvertDigit(ByVal MyDigit)\n        Select Case Val(MyDigit)\n            Case 1: ConvertDigit = \"One\"\n            Case 2: ConvertDigit = \"Two\"\n            Case 3: ConvertDigit = \"Three\"\n            Case 4: ConvertDigit = \"Four\"\n            Case 5: ConvertDigit = \"Five\"\n            Case 6: ConvertDigit = \"Six\"\n            Case 7: ConvertDigit = \"Seven\"\n            Case 8: ConvertDigit = \"Eight\"\n            Case 9: ConvertDigit = \"Nine\"\n            Case Else: ConvertDigit = \"\"\n         End Select\nEnd Function\n\nPrivate Function ConvertHundreds(ByVal MyNumber)\n    Dim Result As String\n\n         ' Exit if there is nothing to convert.\n         If Val(MyNumber) = 0 Then Exit Function\n\n         ' Append leading zeros to number.\n         MyNumber = Right(\"000\" &amp; MyNumber, 3)\n\n         ' Do we have a hundreds place digit to convert?\n         If Left(MyNumber, 1) &lt;&gt; \"0\" Then\n            Result = ConvertDigit(Left(MyNumber, 1)) &amp; \" Hundred \"\n         End If\n\n         ' Do we have a tens place digit to convert?\n         If Mid(MyNumber, 2, 1) &lt;&gt; \"0\" Then\n            Result = Result &amp; ConvertTens(Mid(MyNumber, 2))\n         Else\n            ' If not, then convert the ones place digit.\n            Result = Result &amp; ConvertDigit(Mid(MyNumber, 3))\n         End If\n\n         ConvertHundreds = Trim(Result)\nEnd Function\n\nPrivate Function ConvertTens(ByVal MyTens)\n          Dim Result As String\n\n         ' Is value between 10 and 19?\n         If Val(Left(MyTens, 1)) = 1 Then\n            Select Case Val(MyTens)\n               Case 10: Result = \"Ten\"\n               Case 11: Result = \"Eleven\"\n               Case 12: Result = \"Twelve\"\n               Case 13: Result = \"Thirteen\"\n               Case 14: Result = \"Fourteen\"\n               Case 15: Result = \"Fifteen\"\n               Case 16: Result = \"Sixteen\"\n               Case 17: Result = \"Seventeen\"\n               Case 18: Result = \"Eighteen\"\n               Case 19: Result = \"Nineteen\"\n               Case Else\n            End Select\n         Else\n            ' .. otherwise it's between 20 and 99.\n            Select Case Val(Left(MyTens, 1))\n               Case 2: Result = \"Twenty \"\n               Case 3: Result = \"Thirty \"\n               Case 4: Result = \"Forty \"\n               Case 5: Result = \"Fifty \"\n               Case 6: Result = \"Sixty \"\n               Case 7: Result = \"Seventy \"\n               Case 8: Result = \"Eighty \"\n               Case 9: Result = \"Ninety \"\n               Case Else\n            End Select\n\n            ' Convert ones place digit.\n            Result = Result &amp; ConvertDigit(Right(MyTens, 1))\n         End If\n\n         ConvertTens = Result\nEnd Function\n</code></pre>\n\n<p>but repeatedly im getting a #Name? error</p>\n\n<p>Pls help me out of this</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 718, "user_id": 3298787, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/aNMIS.jpg?s=128&g=1", "display_name": "Nijin22", "link": "https://stackoverflow.com/users/3298787/nijin22"}, "edited": false, "score": 0, "creation_date": 1461759511, "post_id": 36889428, "comment_id": 61343355, "body": "So <code>Dim... as New...</code> isn&#39;t actually just a short way to write <code>Dim ...</code> and <code>Set ... = New ...</code>? There are probably quite a few guides on the internet which need to be updated then. Thanks this solved my problem!"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "reply_to_user": {"reputation": 718, "user_id": 3298787, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/aNMIS.jpg?s=128&g=1", "display_name": "Nijin22", "link": "https://stackoverflow.com/users/3298787/nijin22"}, "edited": false, "score": 1, "creation_date": 1461759821, "post_id": 36889428, "comment_id": 61343659, "body": "It is, pretty much, but it&#39;s equivalent to having both those two lines at the top of your procedure and outside your loop, so you only get the object variable created once. IMO, it&#39;s lazy and dangerous. You could have kept that syntax and added <code>Set newValueMap = Nothing</code> after adding the object to the dictionary but I still think&#39;s it bad programming."}], "tags": [], "owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "is_accepted": true, "score": 2, "last_activity_date": 1461759036, "creation_date": 1461759036, "answer_id": 36889428, "question_id": 36889075, "link": "https://stackoverflow.com/questions/36889075/entries-in-a-dictionary-all-have-the-same-value-though-they-are-created-individu/36889428#36889428", "title": "Entries in a dictionary all have the same value though they are created individually", "body": "<p>Object lesson for you - <strong>NEVER</strong> use <code>Dim... As New...</code> as you can't control when or if you get a new object.</p>\n\n<p>Simple changes to your code required:</p>\n\n<pre><code>Dim idCell                As Range\nDim allValues             As Scripting.Dictionary\nDim newValueMap           As CValueMap\n\nSet allValues = New Scripting.Dictionary\nallValues.RemoveAll\n\nFor Each idCell In Range(\"id_value_table[ID]\")\n    If Not allValues.Exists(idCell.value) Then\n        Set newValueMap = New CValueMap\n        newValueMap.id = idCell.value\n        Set newValueMap.values = New Collection\n        allValues.Add idCell.value, newValueMap\n    End If\n\n    Dim valueMap          As CValueMap\n    Set valueMap = allValues.Item(idCell.value)\n    valueMap.values.Add idCell.Offset(0, 1).value\nNext idCell\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2685, "user_id": 1523914, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/95939ded1fb2423fbe9ba7989a0006ab?s=128&d=identicon&r=PG", "display_name": "Excel Developers", "link": "https://stackoverflow.com/users/1523914/excel-developers"}, "is_accepted": false, "score": 0, "last_activity_date": 1461760286, "creation_date": 1461760286, "answer_id": 36889908, "question_id": 36889075, "link": "https://stackoverflow.com/questions/36889075/entries-in-a-dictionary-all-have-the-same-value-though-they-are-created-individu/36889908#36889908", "title": "Entries in a dictionary all have the same value though they are created individually", "body": "<p>Just before your End If, add this line:</p>\n\n<pre><code>Set newValueMap = Nothing\n</code></pre>\n"}], "owner": {"reputation": 718, "user_id": 3298787, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/aNMIS.jpg?s=128&g=1", "display_name": "Nijin22", "link": "https://stackoverflow.com/users/3298787/nijin22"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 42, "favorite_count": 1, "accepted_answer_id": 36889428, "answer_count": 2, "score": 1, "last_activity_date": 1461760286, "creation_date": 1461758177, "last_edit_date": 1531161705, "question_id": 36889075, "link": "https://stackoverflow.com/questions/36889075/entries-in-a-dictionary-all-have-the-same-value-though-they-are-created-individu", "title": "Entries in a dictionary all have the same value though they are created individually", "body": "<p>I have a excel table for a <code>1:n-Relationship</code></p>\n\n<pre><code>ID  value\n----------\n1   A\n1   B\n1   C\n2   A\n2   B\n3   F\n4   X\n4   Z\n</code></pre>\n\n<p>And a object (<code>CValueMap</code>) which should store the values for a given ID:</p>\n\n<pre><code>Option Explicit\n\nPublic id As Integer\nPublic values As Collection\n</code></pre>\n\n<p>I read the excel table by iterating the rows, creating the <code>CValueMap</code> (if it doesn't exist in my dictionary yet) and filling the values.</p>\n\n<pre><code>Dim idCell As Range\nDim allValues As New Scripting.Dictionary\nallValues.RemoveAll\n\nFor Each idCell In Range(\"id_value_table[ID]\")\n    If Not allValues.Exists(idCell.value) Then\n        Dim newValueMap As New CValueMap\n        newValueMap.id = idCell.value\n        Set newValueMap.values = New Collection\n        allValues.Add idCell.value, newValueMap\n    End If\n\n    Dim valueMap As CValueMap\n    Set valueMap = allValues.Item(idCell.value)\n    valueMap.values.Add idCell.Offset(0, 1).value\nNext idCell\n</code></pre>\n\n<p>I would now assume that I have 4 <code>CValueMap</code>s where the first one has <code>ABC</code>, the second <code>AB</code>, the third <code>F</code> and the last <code>XZ</code> as values. This, however is not the case as this code shows:</p>\n\n<pre><code>'iterate allValues\nDim singleKey as Variant\nFor Each singleKey In allValues.Keys\n    Debug.Print singleKey &amp; \" has these values:\"\n    Debug.Print \"ID: \" &amp; allValues.Item(singleKey).id\n    Dim value As Variant\n    For Each value In allValues.Item(singleKey).values\n        Debug.Print \"  \" &amp; value\n    Next value\nNext singleKey\n</code></pre>\n\n<p>.</p>\n\n<pre><code>---------------OUTPUT:-------------------\n1 has these values:\nID: 4\n  X\n  Z\n2 has these values:\nID: 4\n  X\n  Z\n3 has these values:\nID: 4\n  X\n  Z\n4 has these values:\nID: 4\n  X\n  Z\n</code></pre>\n\n<p>I'm not really sure where I went wrong. From the behaviour I assumed the <strong>same</strong> ValueMap might have been written to <strong>each</strong> entry in the <code>allValues</code> dictionary, but since I did create 4 distinct ones and load them correctly before adding the <code>value</code>s I fail to see where this could have happened.</p>\n"}, {"tags": ["sql", "oracle", "excel", "ado", "vba"], "answers": [{"comments": [{"owner": {"reputation": 71, "user_id": 6261248, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/cbd6aa914c036b6b28945e6e5a1c4980?s=128&d=identicon&r=PG&f=1", "display_name": "jp3nyc", "link": "https://stackoverflow.com/users/6261248/jp3nyc"}, "edited": false, "score": 0, "creation_date": 1461760988, "post_id": 36889292, "comment_id": 61344604, "body": "Thanks mathguy.  Change made."}], "tags": [], "owner": {"reputation": 37365, "user_id": 5683823, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8551ed09606092a75f36b0638e5c318f?s=128&d=identicon&r=PG&f=1", "display_name": "mathguy", "link": "https://stackoverflow.com/users/5683823/mathguy"}, "is_accepted": false, "score": 2, "last_activity_date": 1461758719, "creation_date": 1461758719, "answer_id": 36889292, "question_id": 36888953, "link": "https://stackoverflow.com/questions/36888953/oledb-connection-from-excel-to-oracle-issue/36889292#36889292", "title": "OLEDB Connection from Excel to Oracle Issue", "body": "<p>I see the host for the OLEDB connection is modn-ast-<strong>fdb1</strong>. ...  while for the ODBC connection you have modn-ast-<strong>tdb1</strong>. ...   Shouldn't the host be the same?</p>\n"}, {"comments": [{"owner": {"reputation": 71, "user_id": 6261248, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/cbd6aa914c036b6b28945e6e5a1c4980?s=128&d=identicon&r=PG&f=1", "display_name": "jp3nyc", "link": "https://stackoverflow.com/users/6261248/jp3nyc"}, "edited": false, "score": 0, "creation_date": 1461761014, "post_id": 36889347, "comment_id": 61344622, "body": "Serg.  Defining the variables this way fixed it.  Thank you."}, {"owner": {"reputation": 7586, "user_id": 1151269, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/5eoVa.jpg?s=128&g=1", "display_name": "Rachcha", "link": "https://stackoverflow.com/users/1151269/rachcha"}, "reply_to_user": {"reputation": 71, "user_id": 6261248, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/cbd6aa914c036b6b28945e6e5a1c4980?s=128&d=identicon&r=PG&f=1", "display_name": "jp3nyc", "link": "https://stackoverflow.com/users/6261248/jp3nyc"}, "edited": false, "score": 0, "creation_date": 1461762516, "post_id": 36889347, "comment_id": 61345848, "body": "@jp3nyc: Please mark the answer that helped you best as accepted so that we the readers know exactly which answer solved your problem."}], "tags": [], "owner": {"reputation": 13262, "user_id": 6219979, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e768deedd6c0ed9a87a26eff0f4c6cbd?s=128&d=identicon&r=PG&f=1", "display_name": "Serg", "link": "https://stackoverflow.com/users/6219979/serg"}, "is_accepted": true, "score": 1, "last_activity_date": 1461758835, "creation_date": 1461758835, "answer_id": 36889347, "question_id": 36888953, "link": "https://stackoverflow.com/questions/36888953/oledb-connection-from-excel-to-oracle-issue/36889347#36889347", "title": "OLEDB Connection from Excel to Oracle Issue", "body": "<p>This means  <code>Set conn = CreateObject(\"ADODB.Connection\")</code> returns nothing. Check ADODB.dll registration. Alternatively you may use </p>\n\n<pre><code>Dim conn As ADODB.Connection\nSet conn = New ADODB.Connection\n</code></pre>\n\n<p>and you'll see if ADODB is available at the moment you edit the script not waiting for runtime errors.</p>\n"}], "owner": {"reputation": 71, "user_id": 6261248, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/cbd6aa914c036b6b28945e6e5a1c4980?s=128&d=identicon&r=PG&f=1", "display_name": "jp3nyc", "link": "https://stackoverflow.com/users/6261248/jp3nyc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 599, "favorite_count": 0, "accepted_answer_id": 36889347, "answer_count": 2, "score": 0, "last_activity_date": 1461758835, "creation_date": 1461757839, "last_edit_date": 1531161705, "question_id": 36888953, "link": "https://stackoverflow.com/questions/36888953/oledb-connection-from-excel-to-oracle-issue", "title": "OLEDB Connection from Excel to Oracle Issue", "body": "<p>Everyone,</p>\n\n<p>A VBA problem has been killing me the past two days. I have a Macro Based Model in Excel that has data sets bought into the spreadsheets from Oracle via OLEDB. To illustrate the problem simply I have created two functions within the Model.  One using ODBC(\"odbc\") and another using OLEDB(\"OraOLEDB\").  The code was working completely fine last week and it has not been changed. </p>\n\n<p>Now, however I get an error message that states \"Run-Time Error '424': Object Required when I execute the line \"conn.Open strCon\" in sub \"OraOLEDB\".A connection can't be established with the database!  So when I am trying to establish a connection to the database with that line of code, it fails.  What is interesting is that via ODBC, a connection can be established. The line \"conn.Open strCon\" in sub \"odbc\" executes successfully and I am able to establish a connection to the database.</p>\n\n<p>I did not change anything in the Excel Model but I did have a bunch of windows updates recently.  I don't know if that corrupted anything.  I think it may have.  The reason why I don't want to use the ODBC connection is that it is significantly slower.  I get run times 10x faster using OLEDB.  Please let me know if you can help.  </p>\n\n<hr>\n\n<pre><code>Sub odbc()\nDim conn As Object\nDim strCon As String\n\nstrCon = \"Driver={Microsoft ODBC for Oracle}; \n          CONNECTSTRING=(DESCRIPTION=(ADDRESS=(PROTOCOL=TCP) \n             (HOST=xxx)(PORT=1521))\n             (CONNECT_DATA=(SERVICE_NAME=xxx))); \n          uid=xxx;pwd=xxx;\"\n\nSet conn = CreateObject(\"ADODB.Connection\")\n\nconn.Open strCon\n\nEnd Sub\n</code></pre>\n\n<hr>\n\n<pre><code>Sub OraOLEDB()\nDim conn As Object\nDim strCon As String\n\nstrCon = \"Provider=OraOLEDB.Oracle;\n          Data Source=(DESCRIPTION =  (ADDRESS = (PROTOCOL = TCP)\n             (HOST = xxx)(PORT = 1521)) \n             (CONNECT_DATA = (SERVER = DEDICATED)(SERVICE_NAME = xxx)));   \n          User Id=xxx;Password=xxx\"\n\nSet conn = CreateObject(\"ADODB.Connection\")\n\nconn.Open strCon\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 53, "user_id": 6261261, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ee90859c489f3cf3497df5a35542052?s=128&d=identicon&r=PG&f=1", "display_name": "Gargi Nirmal", "link": "https://stackoverflow.com/users/6261261/gargi-nirmal"}, "edited": false, "score": 0, "creation_date": 1461757749, "post_id": 36888878, "comment_id": 61342016, "body": "Cells(i, 80).Value)         .Orientation = xlRowField         .Position = 1  There was some typo in this line"}, {"owner": {"reputation": 7547, "user_id": 6019417, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/nA455.jpg?s=128&g=1", "display_name": "J. Chomel", "link": "https://stackoverflow.com/users/6019417/j-chomel"}, "edited": false, "score": 0, "creation_date": 1461758860, "post_id": 36888878, "comment_id": 61342866, "body": "You should have posted your error. But thanks for fixing it yourself!"}, {"owner": {"reputation": 53, "user_id": 6261261, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ee90859c489f3cf3497df5a35542052?s=128&d=identicon&r=PG&f=1", "display_name": "Gargi Nirmal", "link": "https://stackoverflow.com/users/6261261/gargi-nirmal"}, "reply_to_user": {"reputation": 7547, "user_id": 6019417, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/nA455.jpg?s=128&g=1", "display_name": "J. Chomel", "link": "https://stackoverflow.com/users/6019417/j-chomel"}, "edited": false, "score": 0, "creation_date": 1461759414, "post_id": 36888878, "comment_id": 61343272, "body": "It has not been fixed yet :( In the above comment, I just posted part of the code which i missed while posting the code here"}, {"owner": {"reputation": 53, "user_id": 6261261, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ee90859c489f3cf3497df5a35542052?s=128&d=identicon&r=PG&f=1", "display_name": "Gargi Nirmal", "link": "https://stackoverflow.com/users/6261261/gargi-nirmal"}, "reply_to_user": {"reputation": 7547, "user_id": 6019417, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/nA455.jpg?s=128&g=1", "display_name": "J. Chomel", "link": "https://stackoverflow.com/users/6019417/j-chomel"}, "edited": false, "score": 0, "creation_date": 1461759610, "post_id": 36888878, "comment_id": 61343472, "body": "The error is this...I get a dialogue box saying &quot;Do you want to replace the contents of destination cells&quot; .I dont want such dialogue box to appear :/"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 2, "creation_date": 1461762908, "post_id": 36888878, "comment_id": 61346166, "body": "Then use <code>Application.DisplayAlerts = False</code> or clear the sheet first."}], "owner": {"reputation": 53, "user_id": 6261261, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ee90859c489f3cf3497df5a35542052?s=128&d=identicon&r=PG&f=1", "display_name": "Gargi Nirmal", "link": "https://stackoverflow.com/users/6261261/gargi-nirmal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 243, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1461763331, "creation_date": 1461757664, "last_edit_date": 1461763331, "question_id": 36888878, "link": "https://stackoverflow.com/questions/36888878/create-pivot-table-using-vba", "title": "Create pivot table using vba", "body": "<p>I am trying to create a pivot table using vba coding. The row,column fields, filter etc. i am giving through a combobox. The code is not working. Can someone please help me debug it. I am having problem with \"month\" and \"campaign\" fields both of which i am trying to use as filter variables. Rest everything is working fine.</p>\n\n<pre><code>ActiveWorkbook.PivotCaches.Create(SourceType:=xlDatabase, SourceData:= _\n        \"mo_pivotdata!R1C1:R120629C11\", Version:=xlPivotTableVersion14). _\n        CreatePivotTable TableDestination:=\"mo!R107C43\", TableName:=\"PivotTable1\" _\n        , DefaultVersion:=xlPivotTableVersion14\n    Sheets(\"mo\").Select\n\n    Dim i, j, k, l, m As Integer\n    For i = 1 To 10\n    If Range(\"cg1\").Value = i Then\n\n\n    Cells(3, 1).Select\n    With ActiveSheet.PivotTables(\"PivotTable1\").PivotFields(Cells(i, 80        \n    End With\n    End If\n    Next i\n\n\n     For j = 1 To 10\n    If Range(\"ch1\").Value = j Then\n    With ActiveSheet.PivotTables(\"PivotTable1\").PivotFields(Cells(j, 80).Value)\n        .Orientation = xlColumnField\n        .Position = 1\n\n    End If\n    Next j\n\n      For k = 1 To 10\n    If Range(\"cj1\").Value = k Then\n    With ActiveSheet.PivotTables(\"PivotTable1\").PivotFields(\"Month\")\n        .Orientation = xlPageField\n        .Position = 1\n\n    ActiveSheet.PivotTables(\"PivotTable1\").AddDataField ActiveSheet.PivotTables( _\n        \"PivotTable1\").PivotFields(Cells(k, 81).Value), \"Sum Total\", xlSum\n\n\n    End With\n    End If\n    Next k\n\n\n\n    For l = 1 To 10\n    If Range(\"cf1\").Value = l Then\n    ActiveSheet.PivotTables(\"PivotTable1\").PivotFields(\"Month\").ClearAllFilters\n    ActiveSheet.PivotTables(\"PivotTable1\").PivotFields(\"Month\").CurrentPage = Cells(l, 79).Value\n   Range(\"ar104\").Value = Cells(l, 79).Value\n   End If\n   Next l\n    With ActiveSheet.PivotTables(\"PivotTable1\").PivotFields(\"Sum Total\")\n        .NumberFormat = \"#,##0\"\n\n    End With\n\n\n\n\n\n        For m = 1 To 10\n    If Range(\"co1\").Value = m Then\n With ActiveSheet.PivotTables(\"PivotTable1\").PivotFields(\"Campaign\")\n        .Orientation = xlPageField\n        .Position = 1\n    End With\n    ActiveSheet.PivotTables(\"PivotTable1\").PivotFields(\"Campaign\").ClearAllFilters\n    ActiveSheet.PivotTables(\"PivotTable1\").PivotFields(\"Campaign\").CurrentPage = Cells(m, 94).Value\n   Range(\"ar103\").Value = Cells(m, 94).Value\n   End If\n   Next m\n    With ActiveSheet.PivotTables(\"PivotTable1\").PivotFields(\"Sum Total\")\n        .NumberFormat = \"#,##0\"\n\n\n    End With\n'\n\n   Sheets(\"mo_pivotdata\").Visible = False\n   Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n\n<p>I get a dialogue box saying </p>\n\n<blockquote>\n  <p>\"Do you want to replace the contents of destination cells?\"</p>\n</blockquote>\n\n<p>I dont want such dialogue box to appear.</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 2039, "user_id": 1827764, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/020eeae0bec754b16c896c8c8e38eb08?s=128&d=identicon&r=PG", "display_name": "raphael75", "link": "https://stackoverflow.com/users/1827764/raphael75"}, "is_accepted": false, "score": 2, "last_activity_date": 1461757748, "last_edit_date": 1495540730, "creation_date": 1461757748, "answer_id": 36888913, "question_id": 36888592, "link": "https://stackoverflow.com/questions/36888592/reading-csv-file-with-strange-line-deliminter-in-vba/36888913#36888913", "title": "Reading csv file with strange line deliminter in VBA", "body": "<p>I think this has the answer - split on vbcrlf? </p>\n\n<p><a href=\"https://stackoverflow.com/questions/6870152/crlf-in-vbscript\">CRLF in VBScript</a></p>\n\n<p>Of the 4 examples you gave, \"CR\" and \"LF\" would look for the literal strings \"CR\" and \"LF\", which is not what you want. VB doesn't recognize \"\\n\" like most C-like languages, so that's out. vbnewline was the closest to working, but I think this might help you:</p>\n\n<p><a href=\"http://www.jaypm.com/2012/08/the-difference-between-vbcrlf-vbnewline-and-environment-newline/\" rel=\"nofollow noreferrer\">http://www.jaypm.com/2012/08/the-difference-between-vbcrlf-vbnewline-and-environment-newline/</a></p>\n"}, {"comments": [{"owner": {"reputation": 805, "user_id": 3909356, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/6e04adf8e08c1a4cd812345e602e06af?s=128&d=identicon&r=PG&f=1", "display_name": "skatun", "link": "https://stackoverflow.com/users/3909356/skatun"}, "edited": false, "score": 0, "creation_date": 1461761065, "post_id": 36890021, "comment_id": 61344659, "body": "VBLf did the trick, thanks heaps. I will now quickly edit the code and upload the complete code"}], "tags": [], "owner": {"reputation": 1953, "user_id": 5695459, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38a3d0b5f37c6c96c98210424b4ccf7d?s=128&d=identicon&r=PG&f=1", "display_name": "Petr Srn&#237;\u010dek", "link": "https://stackoverflow.com/users/5695459/petr-srn%c3%ad%c4%8dek"}, "is_accepted": true, "score": 2, "last_activity_date": 1461760584, "last_edit_date": 1495540350, "creation_date": 1461760584, "answer_id": 36890021, "question_id": 36888592, "link": "https://stackoverflow.com/questions/36888592/reading-csv-file-with-strange-line-deliminter-in-vba/36890021#36890021", "title": "Reading csv file with strange line deliminter in VBA", "body": "<p>The screenshot you attached shows that the file uses CR LF as linebreaks but the file I downloaded from your Google Drive link actually uses LF only, so you might want to use:</p>\n\n<p><code>lines = Split(dataLine, vbLf)</code></p>\n\n<p>Also, the file uses Little Endian UCS-2 encoding with BOM. If you simply open the file using the <code>Open</code> statement, you are likely to run into corrupt characters and other encoding related problems. I would suggest <a href=\"https://stackoverflow.com/questions/10996922/specify-encoding-when-open-for-input-vb#answer-10997824\">using Filesystem object instead</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 805, "user_id": 3909356, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/6e04adf8e08c1a4cd812345e602e06af?s=128&d=identicon&r=PG&f=1", "display_name": "skatun", "link": "https://stackoverflow.com/users/3909356/skatun"}, "is_accepted": false, "score": 2, "last_activity_date": 1461761821, "creation_date": 1461761821, "answer_id": 36890530, "question_id": 36888592, "link": "https://stackoverflow.com/questions/36888592/reading-csv-file-with-strange-line-deliminter-in-vba/36890530#36890530", "title": "Reading csv file with strange line deliminter in VBA", "body": "<p>Here is my code that currently seems to work well:</p>\n\n<pre><code>Option Explicit\n\nSub test()\n    Dim a As Object\n    Set a = getPropertiesDictionary(\"c:\\Temp\\Creo\\param_table.csv\")\n    Debug.Print a.item(\"PTC_WM_CREATED_BY\")\n\nEnd Sub\n\n\n' populate dictinoary with document types based on input file\nFunction getPropertiesDictionary(FileName As String) As Object\n\n    Set getPropertiesDictionary = CreateObject(\"Scripting.Dictionary\")\n    Dim temp() As String\n    Dim dataLine As String\n    Dim hf As Integer: hf = FreeFile\n    Dim lines() As String, i As Long\n\n    Open FileName For Input As #hf\n        Line Input #hf, dataLine\n        lines = Split(dataLine, vbLf)\n    Close #hf\n\n    For i = 0 To UBound(lines) - 1\n        temp = Split(lines(i), \",\")\n        If Not temp(0) = \"\" Then\n            getPropertiesDictionary.Add temp(0), temp(2)\n        End If\n    Next\n\n  End Function\n</code></pre>\n"}], "owner": {"reputation": 805, "user_id": 3909356, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/6e04adf8e08c1a4cd812345e602e06af?s=128&d=identicon&r=PG&f=1", "display_name": "skatun", "link": "https://stackoverflow.com/users/3909356/skatun"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1334, "favorite_count": 0, "accepted_answer_id": 36890021, "answer_count": 3, "score": 1, "last_activity_date": 1466563032, "creation_date": 1461756864, "last_edit_date": 1495542162, "question_id": 36888592, "link": "https://stackoverflow.com/questions/36888592/reading-csv-file-with-strange-line-deliminter-in-vba", "title": "Reading csv file with strange line deliminter in VBA", "body": "<p>I have a input file which I am struggling to read in line by line, The file can be found <a href=\"https://drive.google.com/file/d/0BxwDFjYKpMNMd3hLc0ROWDJnQ1E/view\" rel=\"nofollow noreferrer\">here</a> and is also shown below:<a href=\"https://i.stack.imgur.com/gxkqE.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/gxkqE.png\" alt=\"enter image description here\"></a></p>\n\n<p>I would like to add the first value as key and the third value as item in a dictonary </p>\n\n<p>Then later I can do this:  a = myDictonary(\"CREATED_BY\") and this will then return \"Eigil...\" (Order and number of lines my vary from time to time..)</p>\n\n<p>But somehow I can not get the split to work:</p>\n\n<pre><code>Dim hf As Integer: hf = FreeFile\nDim lines() As String, i As Long\n\nOpen FileName For Input As #hf\n    Line Input #hf, dataLine\n    lines = Split(dataLine, vbNewLine)\n    lines = Split(dataLine, \"\\n\")\n    lines = Split(dataLine, \"CR\")\n    lines = Split(dataLine, \"LF\")\nClose #hf\n</code></pre>\n\n<p>I also tried to follow this <a href=\"https://stackoverflow.com/questions/11528694/read-parse-text-file-line-by-line-in-vba\">thread</a></p>\n\n<p>For people who like to use dictinary here is my code for that:</p>\n\n<pre><code> Set getProjectDictionary = CreateObject(\"Scripting.Dictionary\")\n    Dim item As String\n    Dim key As String\n    Dim dataLine As String\n\n    Open FileName For Input As 1\n\n    While Not EOF(1)\n        On Error Resume Next\n        Line Input #1, dataLine\n        temp = Split(dataLine, \",\")\n        If Not temp(0) = \"\" Then\n            getProjectDictionary.Add temp(0), temp(3)\n        End If\n        Wend\n    Close 1\n</code></pre>\n\n<p>I added some debug output below:\n<a href=\"https://i.stack.imgur.com/mBBGG.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/mBBGG.png\" alt=\"debug\"></a></p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 105, "user_id": 6031229, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/4bd1862b112c8c300ac7f84a1d95fdea?s=128&d=identicon&r=PG&f=1", "display_name": "Francisco Pl&#225;cido", "link": "https://stackoverflow.com/users/6031229/francisco-pl%c3%a1cido"}, "edited": false, "score": 0, "creation_date": 1461761385, "post_id": 36889722, "comment_id": 61344938, "body": "Hi, the issue is that if I use xlpastevalues, all my formulas will be lost. is there an xlpastesomething, that keeps formulas as well?"}, {"owner": {"reputation": 3591, "user_id": 5959772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16582d7b8ad17c08dd59266281ea5c7f?s=128&d=identicon&r=PG&f=1", "display_name": "arcadeprecinct", "link": "https://stackoverflow.com/users/5959772/arcadeprecinct"}, "reply_to_user": {"reputation": 105, "user_id": 6031229, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/4bd1862b112c8c300ac7f84a1d95fdea?s=128&d=identicon&r=PG&f=1", "display_name": "Francisco Pl&#225;cido", "link": "https://stackoverflow.com/users/6031229/francisco-pl%c3%a1cido"}, "edited": false, "score": 0, "creation_date": 1461761935, "post_id": 36889722, "comment_id": 61345381, "body": "Not for pasting to another instance of excel. Apparently <code>xlPasteFormulas</code> also pastes a picture. Did you try the method I recommended? When you open the second workbook in the same instance, the formulas will be copied."}, {"owner": {"reputation": 105, "user_id": 6031229, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/4bd1862b112c8c300ac7f84a1d95fdea?s=128&d=identicon&r=PG&f=1", "display_name": "Francisco Pl&#225;cido", "link": "https://stackoverflow.com/users/6031229/francisco-pl%c3%a1cido"}, "edited": false, "score": 0, "creation_date": 1461762093, "post_id": 36889722, "comment_id": 61345495, "body": "The point is that the person I am doing this for wants to have the two seperate instances running (which doesnt make a lot of sense) because there are way too many formulas to keep the file in one instance."}, {"owner": {"reputation": 105, "user_id": 6031229, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/4bd1862b112c8c300ac7f84a1d95fdea?s=128&d=identicon&r=PG&f=1", "display_name": "Francisco Pl&#225;cido", "link": "https://stackoverflow.com/users/6031229/francisco-pl%c3%a1cido"}, "edited": false, "score": 0, "creation_date": 1461764730, "post_id": 36889722, "comment_id": 61347684, "body": "Set dst = xlSht.Cells(rng.Row,rng.Column) Also, this will only paste the first value of the range"}, {"owner": {"reputation": 3591, "user_id": 5959772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16582d7b8ad17c08dd59266281ea5c7f?s=128&d=identicon&r=PG&f=1", "display_name": "arcadeprecinct", "link": "https://stackoverflow.com/users/5959772/arcadeprecinct"}, "reply_to_user": {"reputation": 105, "user_id": 6031229, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/4bd1862b112c8c300ac7f84a1d95fdea?s=128&d=identicon&r=PG&f=1", "display_name": "Francisco Pl&#225;cido", "link": "https://stackoverflow.com/users/6031229/francisco-pl%c3%a1cido"}, "edited": false, "score": 0, "creation_date": 1461771316, "post_id": 36889722, "comment_id": 61353005, "body": "I think you&#39;d have to copy each cell contents individually to be safe if there is really no way of opening the other workbook in the same instance.  Pasting the whole range while only referring to the first cell of the destination works for me in the same instance. What do you mean by that there are to many formulas to keep the file in one instance?"}, {"owner": {"reputation": 105, "user_id": 6031229, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/4bd1862b112c8c300ac7f84a1d95fdea?s=128&d=identicon&r=PG&f=1", "display_name": "Francisco Pl&#225;cido", "link": "https://stackoverflow.com/users/6031229/francisco-pl%c3%a1cido"}, "edited": false, "score": 0, "creation_date": 1461878759, "post_id": 36889722, "comment_id": 61412639, "body": "I don&#39;t really know as I haven&#39;t seen the actual file. Im just doing what was requested. Im going to mark your answer as correct as this was the way I ended up fixing the problem. Although will never know if it was actually possible to paste the formula."}], "tags": [], "owner": {"reputation": 3591, "user_id": 5959772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16582d7b8ad17c08dd59266281ea5c7f?s=128&d=identicon&r=PG&f=1", "display_name": "arcadeprecinct", "link": "https://stackoverflow.com/users/5959772/arcadeprecinct"}, "is_accepted": true, "score": 0, "last_activity_date": 1461759765, "creation_date": 1461759765, "answer_id": 36889722, "question_id": 36888383, "link": "https://stackoverflow.com/questions/36888383/pasting-a-table-into-a-different-excel-instance/36889722#36889722", "title": "Pasting a table into a different excel instance", "body": "<p>It seems that excel cannot paste to another instance directly, instead it has to use the windows paste function. I think this is why your <code>PasteSpecial</code> pastes a picture of your range. If you use <code>PasteSpecial xlPasteValues</code> it seems to work but a better way would be to open the second workbook in the same instance (eliminating xlApp):</p>\n\n<pre><code>'...\nfpath = Application.GetOpenFilename(, , Title:=\"Please select a file\")\n'...\nSet xlBook = Application.Workbooks.Open(fpath)\n\nws.activate  'wb might be a better name\nset rng = Application.InputBox(Prompt:=\"Please Select Range\", Title:=\"Range Select\", Type:=8)\n\nSet xlSht = xlBook.Sheets(1)\nxlSht.Activate\n\nset dst = Application.InputBox(Prompt:=\"Please Select Range\", Title:=\"Range Select\", Type:=8)\n\nrng.Copy\ndst.PasteSpecial xlPasteAll\n</code></pre>\n\n<p>If you want to paste to the same place as <code>rng</code> you could use </p>\n\n<pre><code>Set dst = xlSht.Cells(rng.Row,rng.Column)\n</code></pre>\n\n<p>But there might be a nicer way</p>\n"}], "owner": {"reputation": 105, "user_id": 6031229, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/4bd1862b112c8c300ac7f84a1d95fdea?s=128&d=identicon&r=PG&f=1", "display_name": "Francisco Pl&#225;cido", "link": "https://stackoverflow.com/users/6031229/francisco-pl%c3%a1cido"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 57, "favorite_count": 0, "accepted_answer_id": 36889722, "answer_count": 1, "score": 0, "last_activity_date": 1461759765, "creation_date": 1461756315, "last_edit_date": 1531164843, "question_id": 36888383, "link": "https://stackoverflow.com/questions/36888383/pasting-a-table-into-a-different-excel-instance", "title": "Pasting a table into a different excel instance", "body": "<p>I am trying to create a macro that pastes a selected range from one instance of excel into a second instance of excel.</p>\n\n<p>Right now I am facing 2 problems.</p>\n\n<p>First problem is that I am not able to automatically paste the range on the same address as the select range (although on a different sheet).</p>\n\n<p>Second problem is that I managed to paste values, but if I actually try to copy a table for instance, it gets pasted as a picture.</p>\n\n<p>I am also not sure my code is very efficient, these are only bits and pieces I have copied from around the internet.</p>\n\n<p>Thanks in advance for all your help.</p>\n\n<pre><code>Private Sub CommandButton1_Click()\nDim xlApp As Excel.Application\nDim xlBook As Excel.Workbook\nDim ws As Workbook\nDim rng As Range, dst As Range\nDim vals() As Variant\nDim xlSht\n\nSet ws = ThisWorkbook\n\n'select second file\nfpath = Application.GetOpenFilename(, , Title:=\"Please select a file\")\nIf fpath = False Then\n ' They pressed Cancel\n\n    MsgBox \"Stopping because you did not select a file\"\n\n    Exit Sub\n\nElse\n\n    Set xlApp = New Excel.Application\n    Set xlBook = xlApp.Workbooks.Open(fpath)\n    xlApp.Visible = True\n\nEnd If\nws.Sheets(2).Select\n\n\nSet rng = Application.InputBox(Prompt:=\"Please Select Range\",         Title:=\"Range Select\", Type:=8)\n\nSet xlSht = xlApp.Sheets(1)\n\nxlSht.Range(\"A1\").Select\n\nSet dst = xlApp.InputBox(Prompt:=\"Please Select Range\", Title:=\"Range     \nSelect\", Type:=8)\n\n\n\n\nrng.Copy\ndst.PasteSpecial xlPasteAll\n\n'vals = rng\n'dst.Value = vals\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "if-statement"], "comments": [{"owner": {"reputation": 1987, "user_id": 4434652, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/94ee978abf31b6cb604ec929a54ae4e1?s=128&d=identicon&r=PG&f=1", "display_name": "Brian", "link": "https://stackoverflow.com/users/4434652/brian"}, "edited": false, "score": 0, "creation_date": 1461753081, "post_id": 36887055, "comment_id": 61338743, "body": "I&#39;m confused. Could you please clarify your question?"}, {"owner": {"reputation": 4930, "user_id": 5276188, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/N2sAW.jpg?s=128&g=1", "display_name": "Doktor OSwaldo", "link": "https://stackoverflow.com/users/5276188/doktor-oswaldo"}, "edited": false, "score": 0, "creation_date": 1461753170, "post_id": 36887055, "comment_id": 61338798, "body": "whats your Problem, where you don&#39;t get anyfurther ? please provide a specific question."}, {"owner": {"reputation": 111, "user_id": 6235995, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/692cf1439dd649ecd560aa05ad6d73d4?s=128&d=identicon&r=PG&f=1", "display_name": "Maria", "link": "https://stackoverflow.com/users/6235995/maria"}, "edited": false, "score": 0, "creation_date": 1461758526, "post_id": 36887055, "comment_id": 61342604, "body": "I tried to describe more precisely and with images in my answer below. Thank you"}, {"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1461773660, "post_id": 36887055, "comment_id": 61354842, "body": "(1) Is <code>Workbooks(&quot;JiraKPI.xlsm&quot;)</code> the workbook in which the code is residing. If so, I&#39;d recommend using <code>ThisWorkbook</code> instead (in case someone renames the file). (2) Why are you repeating <code>Worksheets</code> in the line <code>Worksheets(Worksheets(&quot;Sheet&quot; &amp; y).Range(&quot;B3&quot;).Copy</code> twice? It should be <code>Worksheets(&quot;Sheet&quot; &amp; y).Range(&quot;B3&quot;).Copy</code> only. (3) The line <code>Range(&quot;A&quot; &amp; rows.Count).End(xlUp).Row</code> does not reference any sheet. From which sheet are you looking for the last row in column &quot;A&quot;? Actually, you might want to add a <code>Worksheet</code> reference to most of you lines or us <code>With Worksheets(&quot;Graph&quot;)</code>."}], "owner": {"reputation": 111, "user_id": 6235995, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/692cf1439dd649ecd560aa05ad6d73d4?s=128&d=identicon&r=PG&f=1", "display_name": "Maria", "link": "https://stackoverflow.com/users/6235995/maria"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 57, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1461758575, "creation_date": 1461752523, "last_edit_date": 1461758575, "question_id": 36887055, "link": "https://stackoverflow.com/questions/36887055/excel-vba-copy-one-cell-from-some-sheets-and-save-on-the-another-sheet", "title": "Excel VBA Copy one cell from some sheets and save on the another sheet", "body": "<p>I have 5 sheets : <code>graph, sheet1, sheet2, sheet3 and list</code>. </p>\n\n<p>I have to copy the cell <code>B3 from sheet1</code> and paste on graph in the <code>cell C2</code>, cell <code>B3 from sheet2</code> to <code>cell C3</code> etc. But I can't touch the sheet list.</p>\n\n<pre><code>nbrows = Range(\"A\" &amp; rows.Count).End(xlUp).Row\nFor y = 2 To nbrows   \n    Workbooks(\"JiraKPI.xlsm\").Activate\n    Worksheets(Worksheets(\"Sheet\" &amp; y).Range(\"B3\").Copy\n    Worksheets(\"Graph\").Select\n    If Range(\"C2\") &lt;&gt; (\"\") Then\n        Range(\"$C65536\").End(xlUp).Offset(1, 0).Select\n        Selection.PasteSpecial Paste:=xlPasteValues\n    Else\n        Range(\"C2\").Select\n        ActiveSheet.Paste\n    End If\nNext y\n</code></pre>\n\n<p>Any help would be appreciated.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 1, "creation_date": 1461752312, "post_id": 36886848, "comment_id": 61338205, "body": "That can&#39;t be the actual code as it won&#39;t work. Anyway, you should not declare <code>As New Workbook</code> but just <code>As Workbook</code>."}, {"owner": {"reputation": 53, "user_id": 6033199, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-E39Vl4uo0u0/AAAAAAAAAAI/AAAAAAAAACw/H5dvH_TcHKE/photo.jpg?sz=128", "display_name": "Gopala Krishnan Sankaran", "link": "https://stackoverflow.com/users/6033199/gopala-krishnan-sankaran"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1461753296, "post_id": 36886848, "comment_id": 61338882, "body": "Yes, corrected. Typo."}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 1, "creation_date": 1461753865, "post_id": 36886848, "comment_id": 61339265, "body": "That still can&#39;t be the real code. Once fixed, I have no problem closing the new workbook. Which version of Excel are you using and where are you running the code from?"}], "answers": [{"comments": [{"owner": {"reputation": 53, "user_id": 6033199, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-E39Vl4uo0u0/AAAAAAAAAAI/AAAAAAAAACw/H5dvH_TcHKE/photo.jpg?sz=128", "display_name": "Gopala Krishnan Sankaran", "link": "https://stackoverflow.com/users/6033199/gopala-krishnan-sankaran"}, "edited": false, "score": 0, "creation_date": 1461753512, "post_id": 36887130, "comment_id": 61339040, "body": "This would close the source workbook. My use case is that I want the user to read the infromation on the new workbook and then decide to close it or save it. But the close button on the top right won&#39;t work until I go back to the original workbook and then come back to the new one."}], "tags": [], "owner": {"reputation": 643, "user_id": 6155490, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-G96HvFnebzE/AAAAAAAAAAI/AAAAAAAAACE/HDx8US6emzo/photo.jpg?sz=128", "display_name": "Amine Soumiaa", "link": "https://stackoverflow.com/users/6155490/amine-soumiaa"}, "is_accepted": false, "score": 0, "last_activity_date": 1516812887, "last_edit_date": 1516812887, "creation_date": 1461752744, "answer_id": 36887130, "question_id": 36886848, "link": "https://stackoverflow.com/questions/36886848/excel-vba-cannot-close-new-workbook-created-using-workbook-add/36887130#36887130", "title": "Excel VBA - Cannot Close New Workbook created using Workbook.Add", "body": "<p>I think you need to add this line:</p>\n\n<pre><code>Workbooks(\"source\").Close\n</code></pre>\n\n<p>if you want to close the current workbook , try this :</p>\n\n<pre><code>Private Sub Worksheet_SelectionChange(ByVal Target As Range)\n    If ActiveCell.Value = \"CLOSE\" Then\n        ThisWorkbook.Saved = True\n        ThisWorkbook.Close\n    End If\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 562, "user_id": 5950214, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/d16094911aa0666d7cc19d29f361fe3c?s=128&d=identicon&r=PG", "display_name": "ali srn", "link": "https://stackoverflow.com/users/5950214/ali-srn"}, "is_accepted": false, "score": 0, "last_activity_date": 1461753951, "creation_date": 1461753951, "answer_id": 36887585, "question_id": 36886848, "link": "https://stackoverflow.com/questions/36886848/excel-vba-cannot-close-new-workbook-created-using-workbook-add/36887585#36887585", "title": "Excel VBA - Cannot Close New Workbook created using Workbook.Add", "body": "<pre><code>Sub Button1_Click()\nDim wb As Workbook\nSet wb = Workbooks.Add\nwb.Sheets(\"Sheet1\").Range(\"A1\") = \"Dummy Text\" 'Some code that populates data\nwb.Activate 'wb.Activate or ThisWorkbook.Activate has no effect\nEnd Sub\n</code></pre>\n\n<p>That worked fine on my excel. I click the close button and it has asked me if i want to save or not.</p>\n"}, {"tags": [], "owner": {"reputation": 192, "user_id": 1666422, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/c2JIV.jpg?s=128&g=1", "display_name": "Kellsens", "link": "https://stackoverflow.com/users/1666422/kellsens"}, "is_accepted": false, "score": 1, "last_activity_date": 1461772906, "creation_date": 1461772906, "answer_id": 36895078, "question_id": 36886848, "link": "https://stackoverflow.com/questions/36886848/excel-vba-cannot-close-new-workbook-created-using-workbook-add/36895078#36895078", "title": "Excel VBA - Cannot Close New Workbook created using Workbook.Add", "body": "<p>after your code</p>\n\n<pre><code>Dim wb as Workbook\nSet wb = Workbooks.Add\nwb.Range(\"A1\") = \"Dummy Text\"\n</code></pre>\n\n<p>insert</p>\n\n<pre><code>set wb = nothing\n</code></pre>\n\n<p>this will release your new workbook and you can close using the \"X\" in the top right.</p>\n\n<p>P.S.: Sorry my english</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 11525982, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1c3d021a6ed84904a1dcd5d410174be?s=128&d=identicon&r=PG", "display_name": "lord.cho", "link": "https://stackoverflow.com/users/11525982/lord-cho"}, "is_accepted": false, "score": 0, "last_activity_date": 1558327120, "last_edit_date": 1558327120, "creation_date": 1558322954, "answer_id": 56213980, "question_id": 36886848, "link": "https://stackoverflow.com/questions/36886848/excel-vba-cannot-close-new-workbook-created-using-workbook-add/56213980#56213980", "title": "Excel VBA - Cannot Close New Workbook created using Workbook.Add", "body": "<p>When displaying your userform, make sure you use \".Show 0\".</p>\n"}], "owner": {"reputation": 53, "user_id": 6033199, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-E39Vl4uo0u0/AAAAAAAAAAI/AAAAAAAAACw/H5dvH_TcHKE/photo.jpg?sz=128", "display_name": "Gopala Krishnan Sankaran", "link": "https://stackoverflow.com/users/6033199/gopala-krishnan-sankaran"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1063, "favorite_count": 0, "answer_count": 4, "score": 1, "last_activity_date": 1558327120, "creation_date": 1461752050, "last_edit_date": 1531164843, "question_id": 36886848, "link": "https://stackoverflow.com/questions/36886848/excel-vba-cannot-close-new-workbook-created-using-workbook-add", "title": "Excel VBA - Cannot Close New Workbook created using Workbook.Add", "body": "<p>I have the following code that creates a new workbook and populates it with some data. </p>\n\n<pre><code>Dim wb as Workbook\nSet wb = Workbooks.Add\nwb.Range(\"A1\") = \"Dummy Text\" 'Some code that populates data\nwb.Activate 'wb.Activate or ThisWorkbook.Activate has no effect\n</code></pre>\n\n<p>The new workbook opens fine. I am able to minimise it, use the menus, etc. but am unable to click the close button. </p>\n\n<p>If I go back to the original workbook that has the macro and come back to the new workbook, I can close. </p>\n\n<p>How do I overcome this problem? Out of ideas unfortunately.</p>\n\n<p><strong>My desidred use case</strong></p>\n\n<p>Step 1 : User clicks a button -> A new workbook opens up with data</p>\n\n<p>Step 2 : User reads the information in the new workbook and decides to save / close</p>\n\n<p>But the close button in the new workbook won't work until the user goes back to the original workbook and comes again to the new workbook.</p>\n"}, {"tags": ["vba"], "answers": [{"tags": [], "owner": {"reputation": 4930, "user_id": 5276188, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/N2sAW.jpg?s=128&g=1", "display_name": "Doktor OSwaldo", "link": "https://stackoverflow.com/users/5276188/doktor-oswaldo"}, "is_accepted": true, "score": 1, "last_activity_date": 1461753915, "creation_date": 1461753915, "answer_id": 36887571, "question_id": 36886842, "link": "https://stackoverflow.com/questions/36886842/how-do-i-improve-my-existing-code-for-getopenfile-function/36887571#36887571", "title": "How do i improve my existing code for GetOpenfile function", "body": "<p>I think you could have solved most of the questions for your self by searching the specific Problem, but i gonna try to help you anyway.</p>\n\n<p>1 If you know the Name of the file, why do you let the user choose it ?\n Anyway you can check the Name with \"workbook.name\" and test whatever you want</p>\n\n<p>2 That's easy done by this:</p>\n\n<pre><code>    If (Worksheets(\"SAP\").Name = \"\") Then\n      MsgBox \"Macro will end now because there is no SAP sheet in the file\"\n      Exit Sub\n    End If\n</code></pre>\n\n<p>2.2? Depends on what you try to delete. ClearContents will not delete any formatings.</p>\n\n<p>3 You have to define vFile as Variant and check it for false:</p>\n\n<pre><code>vFile = Application.GetOpenFilename(\"Excel-files,*.xlsm\", 1, \"Please select file\", , False)\n\nif vFile = false then \n  MsgBox \"The macro will end now because you did not select the file\"\n  Exit Sub\nEnd If\n</code></pre>\n\n<p>But for the future, split the 4 question in 4 Posts, and try do describe what you have tried, and where you have Problems. And Questions like: \"Is it correct what I have done?\" are not suitable for SO. Try it and if you have Problems ask why These Problems occur.</p>\n"}], "owner": {"reputation": 59, "user_id": 6138950, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/eedeb65e7ec6ea107e30c8ea90780983?s=128&d=identicon&r=PG&f=1", "display_name": "Zakky", "link": "https://stackoverflow.com/users/6138950/zakky"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 42, "favorite_count": 0, "accepted_answer_id": 36887571, "answer_count": 1, "score": 0, "last_activity_date": 1461753915, "creation_date": 1461752041, "question_id": 36886842, "link": "https://stackoverflow.com/questions/36886842/how-do-i-improve-my-existing-code-for-getopenfile-function", "title": "How do i improve my existing code for GetOpenfile function", "body": "<p>Please can someone improve my current code - opens a box for the user to select a file and when the correct file is selected it pastes the data to correct tab. However, I am not sure how to improve it as follows:</p>\n\n<p>1) Can i specify the name of the target file (costings) in the code so it only works on that file? At the moment the user can select any file and it looks for the sheet name \"SAP\" and if it can't find it doesn't work - goes to debug mode - i would like it to give the message \"Macro will end now because you failed to select the correct file\". </p>\n\n<p>2) Same as 1 above but the message now is \"Macro will end now because there is no SAP sheet in the file\". This message will come up after selecting the correct file but there's no SAP sheet in it.</p>\n\n<p>2) Clear the existing data in the target \"SAP\" sheet in the given range (do i have the correct code at the moment?)</p>\n\n<p>3) When the user clicks cancel (because they don't want to proceed) a message appears and sub ends - \"The macro will end now because you did not select the file\"</p>\n\n<p>Thank you!</p>\n\n<pre><code>'Set source workbook\n Set wb = ActiveWorkbook\n'Open the target workbook\n vFile = Application.GetOpenFilename(\"Excel-files,*.xlsm\", 1, \"Please select file\", , False)\n Set wb2 = ActiveWorkbook\n'clear existing values form target book\n wb2.Worksheets(\"SAP\").Range(\"A:N\").ClearContents\n'Copy/paste the visible data to the new workbook\n wb.Worksheets(\"sheet1\").Cells.SpecialCells(xlCellTypeVisible).Copy\n wb2.Worksheets(\"SAP\").Range(\"A1\").PasteSpecial Paste:=xlPasteValues\n ActiveSheet.Range(\"A1\").Select\n Application.CutCopyMode = False\n Windows(\"Format MCP6 Final.xlsm\").Close\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1461753228, "post_id": 36886707, "comment_id": 61338838, "body": "I&#39;m not entirely sure what you are copying where, but copying cells <code>B:E</code> of the <code>rFound</code>&#39;s row to column <code>K</code> of <code>OutputWs</code> would be <code>Application.Intersect(rFound.EntireRow, rFound.Worksheet.Range(&quot;B:E&quot;)).Copy OutputWs.Cells(LastRow + 2, &quot;K&quot;)</code>. Or <code>rFound.Worksheet.Range(rFound.EntireRow.Cells(1, &quot;B&quot;), rFound.EntireRow.Cells(1, &quot;E&quot;)).Copy OutputWs.Cells(LastRow + 2, &quot;K&quot;)</code>. Or <code>rFound.EntireRow.Cells(1, &quot;B&quot;).Resize(1, 4).Copy OutputWs.Cells(LastRow + 2, &quot;K&quot;)</code>."}, {"owner": {"reputation": 77, "user_id": 5598655, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/c146e0853d4d984e0070b12617c67c21?s=128&d=identicon&r=PG&f=1", "display_name": "L&#243;r&#225;nt Csaba Mih&#225;ly", "link": "https://stackoverflow.com/users/5598655/l%c3%b3r%c3%a1nt-csaba-mih%c3%a1ly"}, "reply_to_user": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1461838853, "post_id": 36886707, "comment_id": 61385800, "body": "The last one is working rFound.EntireRow.Cells(1, &quot;B&quot;).Resize(1, 4).Copy Unfortunately the search is not... Can you tell why the code does not search for drop-down list values? In my excel sheet I want to list all the names which occurs on each worksheet and these names are selected from a drop-down list. I made an example like 4 same names in each row at sheet 2. And when I run the code it only shows the first result. Why is that?"}, {"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1461838971, "post_id": 36886707, "comment_id": 61385886, "body": "All of them are working and do exactly the same."}, {"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1461839675, "post_id": 36886707, "comment_id": 61386370, "body": "Because <code>Find</code> finds one match at a time. If you want all matches, you <a href=\"http://stackoverflow.com/q/19504858/11683\">must repeatedly call <code>Find</code></a>."}], "answers": [{"tags": [], "owner": {"reputation": 562, "user_id": 5950214, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/d16094911aa0666d7cc19d29f361fe3c?s=128&d=identicon&r=PG", "display_name": "ali srn", "link": "https://stackoverflow.com/users/5950214/ali-srn"}, "is_accepted": false, "score": 0, "last_activity_date": 1461753538, "creation_date": 1461753538, "answer_id": 36887434, "question_id": 36886707, "link": "https://stackoverflow.com/questions/36886707/how-to-debug-vba-code-using-find-and-offset/36887434#36887434", "title": "How to debug VBA code using .Find and Offset?", "body": "<p>You are selection entire row but you are pasting it to the column K. If you copy entire row, you can only copy it to column A. That's why it is not working. So I suggest you to work on Offset part. \nIn Offset, first part is rows, second part is columns.\nyou can do something like that,</p>\n\n<pre><code>Dim sth as Range\nset sth = .range(.rfound.offset(0,-2),.rfound.offset(0,1)).copy\n</code></pre>\n\n<p>But I am not sure of it. Not very good at that.</p>\n"}], "owner": {"reputation": 77, "user_id": 5598655, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/c146e0853d4d984e0070b12617c67c21?s=128&d=identicon&r=PG&f=1", "display_name": "L&#243;r&#225;nt Csaba Mih&#225;ly", "link": "https://stackoverflow.com/users/5598655/l%c3%b3r%c3%a1nt-csaba-mih%c3%a1ly"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 258, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1462035268, "creation_date": 1461751691, "last_edit_date": 1462035238, "question_id": 36886707, "link": "https://stackoverflow.com/questions/36886707/how-to-debug-vba-code-using-find-and-offset", "title": "How to debug VBA code using .Find and Offset?", "body": "<p>I'm practising VBA and I need some help / correction for my code.\nIn this task I'm creating a search tool which looks up each worksheet for the selected value from a combobox. Each result is listed on the first page.</p>\n\n<p>Problems:</p>\n\n<ol>\n<li><p>In the code I defined the <code>.Find</code> method in to a range <code>rFound</code>. On each worksheet the searched value is at column <code>D</code>. I would like to copy the row from column <code>B</code> to <code>E</code>. I've commented an attempt how did I tried to select that range, with offset but I receive an error. Why and how to fix that?</p></li>\n<li><p>When I want to paste (list) the results I want it to start from the 1st page 3rd row column <code>K</code>. After running the code it selects the right target but pastes nothing. How to fix this?</p></li>\n</ol>\n\n<p>I've also made some attempts to copy the document header after each search result, but I commented them out, please ignore lines with <code>getOwner</code>.</p>\n\n<pre><code>Dim ws As Worksheet, OutputWs As Worksheet, wsLists As Worksheet\nDim rFound As Range ', getOwner As Range\nDim strName As String\nDim count As Long, LastRow As Long\nDim IsValueFound As Boolean\n'Dim cboSelectName As ComboBox\nDim a As String\n\n\nIsValueFound = False\nSet OutputWs = Worksheets(\"Teszt\")    '----&gt;change the sheet name as required\nLastRow = OutputWs.Cells(Rows.count, \"A\").End(xlUp).Row\nSet wsLists = Worksheets(\"Lists\")\n\na = ComboBox1.Value\n\nOn Error Resume Next\nstrName = a\nIf strName = \"\" Then Exit Sub\nFor Each ws In Worksheets\n    If ws.Name &lt;&gt; \"Output\" Then\n        With ws.UsedRange\n            Set rFound = .Find(What:=strName, After:=.Cells(1, 1), LookIn:=xlValues, LookAt:=xlWhole)\n            If Not rFound Is Nothing Then\n                Application.Goto rFound, True\n                IsValueFound = True\n                'MsgBox rFound.Row\n                rFound.EntireRow.Copy\n                'Rfound keres - rFound.Range(rFound(Offset(-2,\")),rFound.Offset(1,\"\")).Copy  ' ---&gt; This is a suggestion\n                OutputWs.Cells(LastRow + 2, 11).PasteSpecial xlPasteAll\n                'getOwner.Range(K2, R2).Copy        ' attempt to copy the header for each search result\n                'getOwner.Cells(LastRow + 1, 6).Paste\n                Application.CutCopyMode = False\n                LastRow = LastRow + 1\n            End If\n        End With\n    End If\nNext ws\nOn Error GoTo 0\nIf IsValueFound Then\n   OutputWs.Select\n   MsgBox \"Search Complete!\"\nElse\n    MsgBox \"Value not found\"\nEnd If\n</code></pre>\n"}, {"tags": ["vba", "animation", "triggers", "powerpoint"], "comments": [{"owner": {"reputation": 12482, "user_id": 1667023, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JXaUt.png?s=128&g=1", "display_name": "Steve Rindsberg", "link": "https://stackoverflow.com/users/1667023/steve-rindsberg"}, "edited": false, "score": 1, "creation_date": 1461773940, "post_id": 36885110, "comment_id": 61355067, "body": "I don&#39;t know of a way of triggering VBA from an animation.  However, you could let the slide automatically advance after the last animation and trap the slide change event with VBA."}], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 6260427, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b561ef2aa73bbb648f09ae7940fba675?s=128&d=identicon&r=PG", "display_name": "Peter_Michael96", "link": "https://stackoverflow.com/users/6260427/peter-michael96"}, "is_accepted": false, "score": 1, "last_activity_date": 1461858411, "last_edit_date": 1461858411, "creation_date": 1461857587, "answer_id": 36919252, "question_id": 36885110, "link": "https://stackoverflow.com/questions/36885110/vba-powerpoint-2007-how-do-i-trigger-a-slide-change-after-a-specific-animation/36919252#36919252", "title": "VBA PowerPoint 2007 - How do i trigger a slide change after a specific animation end?", "body": "<p><em>-This is not the answer for the main question, but i have found a workaround for my case-</em></p>\n\n<p>The problem in my case was that each slide, or \"level\" had a countdown which result in a \"Game Over\" after a specific amount of time (Advance Slide Automatically After X Time).</p>\n\n<p>Initially, my slideshow was designed like this, so it required a timer/end of an animation trigger to step into a \"Game Over\" slide placed at the end of presentation:</p>\n\n<p><a href=\"http://i.stack.imgur.com/hk3Uh.png\" rel=\"nofollow\">The initial order of slides</a></p>\n\n<p>However, I have found another positioning of slides that doesn't require extra VBA code, only the one that i attached to the main question. I have placed a copy of the \"Game Over\" after each level, so only by accomplishing the level you could step-by the red-slide. On each intermediate red-slide i've placed an invisible hyperlink whick leads to the final \"Game Over\" slide which is in fact a black screen:</p>\n\n<p><a href=\"http://i.stack.imgur.com/NvRyh.png\" rel=\"nofollow\">My solution without using extra VBA</a></p>\n\n<p>*(explanation of arrows: green arrows means that the condition of the level was accomplished; the red arrows means failure)</p>\n"}], "owner": {"reputation": 11, "user_id": 6260427, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b561ef2aa73bbb648f09ae7940fba675?s=128&d=identicon&r=PG", "display_name": "Peter_Michael96", "link": "https://stackoverflow.com/users/6260427/peter-michael96"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 451, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1461858411, "creation_date": 1461747763, "last_edit_date": 1461748191, "question_id": 36885110, "link": "https://stackoverflow.com/questions/36885110/vba-powerpoint-2007-how-do-i-trigger-a-slide-change-after-a-specific-animation", "title": "VBA PowerPoint 2007 - How do i trigger a slide change after a specific animation end?", "body": "<p>I am working on a game created in <strong>PowerPoint</strong>. I have an exit animation attributed to an image, on a specific slide (ex: the 6th one) that takes 7 seconds to complete. This part is easy, I've done it without VBA. Now i am trying to execute the following code after this animation ends:</p>\n\n<pre><code>With SlideShowWindows(1).View\n    .GotoSlide 17, msoFalse\nEnd With\n</code></pre>\n\n<p>It's like a countdown that sends the user to a \"Game Over\" slide.\nI've tried multiple solutions to this problem like applying DoEvents loops with specific amounts of seconds, Sleep or Delays, but some of them just crashed my presentation or made it unresponsive(that makes all the game useless).</p>\n\n<p>Is there any way to <strong>\"catch\" the end of an animation in PowerPoint</strong> so it can trigger that slide change or any other line of code?</p>\n\n<p>Thank you!</p>\n"}, {"tags": ["c++", "excel", "com", "safearray", "vba"], "comments": [{"owner": {"reputation": 17676, "user_id": 4523099, "user_type": "registered", "accept_rate": 85, "profile_image": "https://lh5.googleusercontent.com/-p3t1IDsNokk/AAAAAAAAAAI/AAAAAAAAABE/EsrSYS8ok2Y/photo.jpg?sz=128", "display_name": "Humam Helfawi", "link": "https://stackoverflow.com/users/4523099/humam-helfawi"}, "edited": false, "score": 0, "creation_date": 1461745666, "post_id": 36884084, "comment_id": 61333521, "body": "As far as I know, SAFEARRAY is MSVC thing. do not you have any problem with that?"}, {"owner": {"reputation": 111, "user_id": 2279982, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/a642479931726282af42628b439b7740?s=128&d=identicon&r=PG", "display_name": "graphElem", "link": "https://stackoverflow.com/users/2279982/graphelem"}, "reply_to_user": {"reputation": 17676, "user_id": 4523099, "user_type": "registered", "accept_rate": 85, "profile_image": "https://lh5.googleusercontent.com/-p3t1IDsNokk/AAAAAAAAAAI/AAAAAAAAABE/EsrSYS8ok2Y/photo.jpg?sz=128", "display_name": "Humam Helfawi", "link": "https://stackoverflow.com/users/4523099/humam-helfawi"}, "edited": false, "score": 0, "creation_date": 1461746463, "post_id": 36884084, "comment_id": 61334038, "body": "Oups - sorry - I completely forgot to add that I should work at MinGW+gcc environment. And SAFEARRAY declaration is simply avaialble for me out-of-box from MinGW. So - I even did not try to analyse - who was the first Company - who has developed it."}, {"owner": {"reputation": 31019, "user_id": 2230, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/a905a92a336eaea1b936c100ec49e229?s=128&d=identicon&r=PG", "display_name": "Euro Micelli", "link": "https://stackoverflow.com/users/2230/euro-micelli"}, "reply_to_user": {"reputation": 17676, "user_id": 4523099, "user_type": "registered", "accept_rate": 85, "profile_image": "https://lh5.googleusercontent.com/-p3t1IDsNokk/AAAAAAAAAAI/AAAAAAAAABE/EsrSYS8ok2Y/photo.jpg?sz=128", "display_name": "Humam Helfawi", "link": "https://stackoverflow.com/users/4523099/humam-helfawi"}, "edited": false, "score": 0, "creation_date": 1461818142, "post_id": 36884084, "comment_id": 61374268, "body": "@HumamHelfawi, no, SAFEARRAY is exactly what gets passed around in VBA/VB6 when you use an array type in a COM exposed method."}], "answers": [{"tags": [], "owner": {"reputation": 111, "user_id": 2279982, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/a642479931726282af42628b439b7740?s=128&d=identicon&r=PG", "display_name": "graphElem", "link": "https://stackoverflow.com/users/2279982/graphelem"}, "is_accepted": true, "score": 1, "last_activity_date": 1461941560, "creation_date": 1461941560, "answer_id": 36941458, "question_id": 36884084, "link": "https://stackoverflow.com/questions/36884084/safearray-of-safearrays-help-to-transfer-vba-code-to-c/36941458#36941458", "title": "SafeArray of SafeArrays? Help to transfer VBA code to C++", "body": "<pre><code>// Create a 5x2 safearray of integer arrays with VT_I4 fields...\ncomstl::variant fieldInfo;\nfieldInfo.vt = VT_ARRAY | VT_VARIANT;\n{\n    SAFEARRAYBOUND sab[2];\n    sab[0].lLbound = 1; sab[0].cElements = 5; // i\n    sab[1].lLbound = 1; sab[1].cElements = 2;  // j\n    fieldInfo.parray = SafeArrayCreate(VT_VARIANT, 2, sab);\n}\n\n// Fill safearray with values like:\n/*\n   FieldInfo:=Array(Array(1, 2), Array(2, 2), Array(3, 2), Array(4, 2), Array(5, 2))\n */\n// first of all fill the first column with data...\nfor(int i=1; i&lt;=5; i++) {\n    VARIANT tmp;\n    tmp.vt = VT_I4;\n    tmp.lVal = i;\n    // Add to safearray...\n    long indices[] = {i,1};\n    SafeArrayPutElement(fieldInfo.parray, indices, (void *)&amp;tmp);\n}\n// ...after that - fill the second column.\nfor(int i=1; i&lt;=5; i++) {\n    VARIANT tmp;\n    tmp.vt = VT_I4;\n    tmp.lVal = 2;\n    // Add to safearray...\n    long indices[] = {i,2};\n    SafeArrayPutElement(fieldInfo.parray, indices, (void *)&amp;tmp);\n}\n</code></pre>\n\n<p>And this code allowed to me achieve my Goal!</p>\n"}], "owner": {"reputation": 111, "user_id": 2279982, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/a642479931726282af42628b439b7740?s=128&d=identicon&r=PG", "display_name": "graphElem", "link": "https://stackoverflow.com/users/2279982/graphelem"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 887, "favorite_count": 0, "accepted_answer_id": 36941458, "answer_count": 1, "score": -2, "last_activity_date": 1461941560, "creation_date": 1461744930, "last_edit_date": 1531161705, "question_id": 36884084, "link": "https://stackoverflow.com/questions/36884084/safearray-of-safearrays-help-to-transfer-vba-code-to-c", "title": "SafeArray of SafeArrays? Help to transfer VBA code to C++", "body": "<pre><code>FieldInfo:=Array(Array(1, 2), Array(2, 2), Array(3, 2), Array(4, 2), Array(5, 2))\n</code></pre>\n\n<p>such code from above I have at VBA macros. Now the same thing I should create in a C++ code.\nAs far as I could understand till now - I should use SAFEARRAY type.\nBut I still do not understand how correctly I should do that.\nMain problem - I have practically pure C++ code. No MSVC extensions like COleSafeArray, no ATL support.\nThe only thing which I can use - STLSoft which is a 100% header-only library\nwhich significantly simplifies the creation of such elements like SAFEARRAY.</p>\n\n<p>But in any way - which structure it should be? 1D SafeArray of 1D SafeArrays of two VT_I4 type elements?</p>\n\n<p>P.S. I should use MinGW + gcc 4.x environment.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 36287, "user_id": 2649012, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/i4SzF.jpg?s=128&g=1", "display_name": "Phant&#244;maxx", "link": "https://stackoverflow.com/users/2649012/phant%c3%b4maxx"}, "edited": false, "score": 1, "creation_date": 1461741830, "post_id": 36882933, "comment_id": 61331081, "body": "no, it&#39;s a <b>logical</b> (bitwise) AND. Then it means that &quot;if the condition is met, change the value of A to <code>A And B</code>&quot;."}, {"owner": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "edited": false, "score": 0, "creation_date": 1461741953, "post_id": 36882933, "comment_id": 61331158, "body": "<code>And</code>, <code>Or</code> are Boolean (True/False) operators. The <code>greatThanPrec</code> is a Boolean type here."}, {"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "reply_to_user": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "edited": false, "score": 2, "creation_date": 1461742304, "post_id": 36882933, "comment_id": 61331368, "body": "@PatricK In VBA, <code>And</code> and <code>Or</code> are bitwise. They work just as fine in logical contexts, but they are inherently bitwise (as opposed to <code>AndAlso</code> and <code>OrElse</code> in VB.NET)."}, {"owner": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "reply_to_user": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1461798096, "post_id": 36882933, "comment_id": 61368867, "body": "@GSerg Thanks, didn&#39;t notice it before. I can confirm in immediate window with <code>?1 Or 2</code> (=3) and <code>?2 And 3</code> (=2). This opens up some tweaks for some calculations for me."}], "answers": [{"comments": [{"owner": {"reputation": 2780, "user_id": 1294909, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/OZWPz.jpg?s=128&g=1", "display_name": "Moosli", "link": "https://stackoverflow.com/users/1294909/moosli"}, "edited": false, "score": 0, "creation_date": 1461742383, "post_id": 36883050, "comment_id": 61331414, "body": "Is the AND here a logical Connector or does it just Connet two Lines after the Then?"}, {"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "reply_to_user": {"reputation": 2780, "user_id": 1294909, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/OZWPz.jpg?s=128&g=1", "display_name": "Moosli", "link": "https://stackoverflow.com/users/1294909/moosli"}, "edited": false, "score": 2, "creation_date": 1461742605, "post_id": 36883050, "comment_id": 61331545, "body": "<code>And</code> never connects two lines. You use <code>:</code> in VBA to put multiple statements on one line. That is, you can write code where you have boolean functions that have side effects, and you can call them on one line like <code>= CauseEffects() And CauseMoreEffects()</code>, but that is both not what is happening here and is bad code, especially for people who don&#39;t realize VBA <a href=\"http://stackoverflow.com/q/3242560/11683\">does not have short circuit</a>."}, {"owner": {"reputation": 4930, "user_id": 5276188, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/N2sAW.jpg?s=128&g=1", "display_name": "Doktor OSwaldo", "link": "https://stackoverflow.com/users/5276188/doktor-oswaldo"}, "reply_to_user": {"reputation": 2780, "user_id": 1294909, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/OZWPz.jpg?s=128&g=1", "display_name": "Moosli", "link": "https://stackoverflow.com/users/1294909/moosli"}, "edited": false, "score": 0, "creation_date": 1461742717, "post_id": 36883050, "comment_id": 61331625, "body": "@Moosli the And here is a Logical conjunction yes."}, {"owner": {"reputation": 2780, "user_id": 1294909, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/OZWPz.jpg?s=128&g=1", "display_name": "Moosli", "link": "https://stackoverflow.com/users/1294909/moosli"}, "edited": false, "score": 0, "creation_date": 1461743059, "post_id": 36883050, "comment_id": 61331858, "body": "@Gserg: Thanks for the explanation and the Link. I learned something new"}, {"owner": {"reputation": 1370, "user_id": 2717068, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/1443043394/picture?type=large", "display_name": "Lubo\u0161 Suk", "link": "https://stackoverflow.com/users/2717068/lubo%c5%a1-suk"}, "edited": false, "score": 0, "creation_date": 1461758174, "post_id": 36883050, "comment_id": 61342335, "body": "@GSerg thanks for great answer ;) didnt thought its so simple"}], "tags": [], "owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "is_accepted": true, "score": 9, "last_activity_date": 1461753587, "last_edit_date": 1461753587, "creation_date": 1461741846, "answer_id": 36883050, "question_id": 36882933, "link": "https://stackoverflow.com/questions/36882933/what-means-if-then-and-condition/36883050#36883050", "title": "What means If * Then * And condition", "body": "<p>That particular <code>And</code> has nothing to do with <code>If Then</code>.</p>\n\n<p>The code after <code>Then</code> simply updates <code>greatThanPrec</code> depending on whether <code>signalAmplArray(i) &gt; signalAmplArray(j)</code> or not. <code>greatThanPrec</code> will stay <code>True</code> if both <code>greatThanPrec</code> and <code>signalAmplArray(i) &gt; signalAmplArray(j)</code> are <code>True</code>, otherwise it will become <code>False</code>.</p>\n\n<p>To better see it, replace <code>signalAmplArray(i) &gt; signalAmplArray(j)</code> with its possible values. You will get two options:</p>\n\n<pre><code>greatThanPrec = greatThanPrec And True  'greatThanPrec does not change its value\n</code></pre>\n\n\n\n<pre><code>greatThanPrec = greatThanPrec And False 'greatThanPrec becomes false\n</code></pre>\n\n<p>If you want to refactor it, that would be</p>\n\n<pre><code>If (j &gt; 0) Then\n  If Not (signalAmplArray(i) &gt; signalAmplArray(j)) Then\n    greatThanPrec = False\n  End If\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 1370, "user_id": 2717068, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/1443043394/picture?type=large", "display_name": "Lubo\u0161 Suk", "link": "https://stackoverflow.com/users/2717068/lubo%c5%a1-suk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 137, "favorite_count": 0, "accepted_answer_id": 36883050, "answer_count": 1, "score": 2, "last_activity_date": 1461753587, "creation_date": 1461741458, "question_id": 36882933, "link": "https://stackoverflow.com/questions/36882933/what-means-if-then-and-condition", "title": "What means If * Then * And condition", "body": "<p>i have maybe a simple question, but its blowing my mind. I have some code to refactor it a bit, but cant figure out what author thinks by this statement</p>\n\n<pre><code>If (j &gt; 0) Then greatThanPrec = greatThanPrec And (signalAmplArray(i) &gt; signalAmplArray(j))\n</code></pre>\n\n<p>I think i know how basic <code>If Then else</code> works, but cant realize why is something like <code>A = A</code> after then, and then is <code>AND</code> maybe some short condition like in C/C++?</p>\n"}, {"tags": ["vba", "internet-explorer-8", "internet-explorer-9"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1461746034, "post_id": 36882460, "comment_id": 61333755, "body": "Hi,  I get the same with one of my projects.  You can use the IE readystate etc to check for the page loading rather than sleeps.  Something like      Do While .Busy Or .readyState &lt;&gt; 4: DoEvents: Loop I am looking at this today, but it&#39;s hard to replicate, as it happens infrequently.  I&#39;ll let you know what I find.  I also use the actual libraries,Microsoft HTML Object Library and Microsoft Internet Controls"}, {"owner": {"reputation": 119, "user_id": 3911603, "user_type": "registered", "accept_rate": 7, "profile_image": "https://i.stack.imgur.com/wJwm1.jpg?s=128&g=1", "display_name": "mond007", "link": "https://stackoverflow.com/users/3911603/mond007"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1461749384, "post_id": 36882460, "comment_id": 61335985, "body": "Glad I am not the only one. Look forward to your views later. Thxs"}], "owner": {"reputation": 119, "user_id": 3911603, "user_type": "registered", "accept_rate": 7, "profile_image": "https://i.stack.imgur.com/wJwm1.jpg?s=128&g=1", "display_name": "mond007", "link": "https://stackoverflow.com/users/3911603/mond007"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 36, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1461740018, "creation_date": 1461740018, "question_id": 36882460, "link": "https://stackoverflow.com/questions/36882460/error-extracting-content-from-internet-explorer-8-vs-internet-explorer-9", "title": "Error Extracting content from Internet Explorer 8 vs Internet Explorer 9", "body": "<p>I have some VBA code that in effect launches a web page and reads of the data content. </p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>Sub Retrieve_Info()\r\n        \r\n        If First_Time = True Then\r\n            IE_Sledgehammer\r\n            Set IE = CreateObject(\"InternetExplorer.Application\")\r\n            IE.Visible = True\r\n        End If\r\n        \r\n            PACN = Cells(Row, 1)\r\n            IE.Navigate \"http://www.myWebReportPage.com/Apps/AddIssues/EditIssue.asp?IssueID=\" &amp; PACN &amp; \"&amp;ProjectID=PACN\"\r\n        If First_Time = True Then\r\n            Sleep 10000\r\n            First_Time = False\r\n        Else\r\n            Sleep 3000\r\n        End If\r\n        \r\n        On Error Resume Next\r\n        Source_Code = IE.document.DocumentElement.innerText\r\n        Do Until InStr(1, Source_Code, \"Issue Id\") &lt;&gt; 0 Or InStr(1, Source_Code, \"Unable to locate\") &lt;&gt; 0\r\n            Source_Code = IE.document.DocumentElement.innerText\r\n            Sleep 100\r\n        Loop\r\n        \r\n        Sleep 200\r\n            \r\n        Source_Code = IE.document.DocumentElement.innerText\r\n        Source_Code2 = IE.document.DocumentElement.innerHTML\r\n            \r\nEnd Sub</code></pre>\r\n</div>\r\n</div>\r\n</p>\n\n<p>The problem is that this code runs fine in IE 8 but hangs in IE9. </p>\n\n<p>Any help would be greatly appreciated. </p>\n"}, {"tags": ["sql", "excel", "vba", "odbc", "adodb"], "comments": [{"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1461745038, "post_id": 36881887, "comment_id": 61333095, "body": "The article you quote is about querying an excel workbook without headers, not about querying a text file without headers. Have you tried loading the text file into excel and then querying it?"}, {"owner": {"reputation": 158803, "user_id": 246342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8ba0aea3f521082f18dd7c186e7d4c3?s=128&d=identicon&r=PG", "display_name": "Alex K.", "link": "https://stackoverflow.com/users/246342/alex-k"}, "edited": false, "score": 0, "creation_date": 1461753613, "post_id": 36881887, "comment_id": 61339101, "body": "What format is the text file? Consider reading My_Text_File.txt and parsing out the first line?"}, {"owner": {"reputation": 415, "user_id": 6099655, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/d343b8c6fa75c600166e1b9aa9183a05?s=128&d=identicon&r=PG&f=1", "display_name": "CWilson", "link": "https://stackoverflow.com/users/6099655/cwilson"}, "reply_to_user": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1461766576, "post_id": 36881887, "comment_id": 61349150, "body": "@Paul True, it is about an excel workbook. Perhaps there may be an even closer match, but the principles of <code>HDR=No</code> are well explained there, which is the relevant point. Furthermore, &#39;a text file without headers&#39; isn&#39;t the problem here. And &#39;loading the text file into excel and then querying it&#39; is not what I am looking for. As I said in the question, I can and do easily change my query string to get the information. I want to &#39;override the header&#39; information, not figure out how to query a text file."}, {"owner": {"reputation": 415, "user_id": 6099655, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/d343b8c6fa75c600166e1b9aa9183a05?s=128&d=identicon&r=PG&f=1", "display_name": "CWilson", "link": "https://stackoverflow.com/users/6099655/cwilson"}, "reply_to_user": {"reputation": 158803, "user_id": 246342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8ba0aea3f521082f18dd7c186e7d4c3?s=128&d=identicon&r=PG", "display_name": "Alex K.", "link": "https://stackoverflow.com/users/246342/alex-k"}, "edited": false, "score": 0, "creation_date": 1461766830, "post_id": 36881887, "comment_id": 61349393, "body": "@Alex The <code>Format=TabDelimited</code> found in the schema.ini file tells the connection string that the format of the file is tab delimited. And this may be the relevant information here, as I have been able to replicate this problem with another flat file, tab delimited, of a different source, size, and extension. On the other hand, the sources I have found seem to make no distinction for purposes of the <code>HDR</code> property."}, {"owner": {"reputation": 415, "user_id": 6099655, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/d343b8c6fa75c600166e1b9aa9183a05?s=128&d=identicon&r=PG&f=1", "display_name": "CWilson", "link": "https://stackoverflow.com/users/6099655/cwilson"}, "reply_to_user": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1461767635, "post_id": 36881887, "comment_id": 61350084, "body": "@Paul Ok, maybe not &#39;well explained&#39;. There was another with an answer by Fionnuala that I thought I was linking. I apologize, when you are your own boss, you don&#39;t sleep well. Anyway, a different question (<a href=\"http://stackoverflow.com/questions/31345000/\">stackoverflow.com/questions/31345000</a>) has the same topic, but different reason for asking, so I can&#39;t use that answer."}], "owner": {"reputation": 415, "user_id": 6099655, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/d343b8c6fa75c600166e1b9aa9183a05?s=128&d=identicon&r=PG&f=1", "display_name": "CWilson", "link": "https://stackoverflow.com/users/6099655/cwilson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 86, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1461768277, "creation_date": 1461738293, "last_edit_date": 1495542233, "question_id": 36881887, "link": "https://stackoverflow.com/questions/36881887/how-do-i-override-the-header-for-field-naming", "title": "How do I override the Header for field naming?", "body": "<p><a href=\"https://stackoverflow.com/questions/21511096\">Using SQL to query an Excel worksheet without a header row</a> echos the information I have found in all my research. But that isn't what I am getting. Has there been a change in Excel 2016, or is my implementation wrong?</p>\n\n<pre><code>    Sub vndrrst()\n        Dim cn As Object\n        Set cn = CreateObject(\"adodb.connection\")\n        strfilename = ThisWorkbook.Path\n        cn.ConnectionString = _\n                \"Provider=Microsoft.Jet.OLEDB.4.0;Data Source=\" &amp; strfilename &amp; _\n                \";Extended Properties=\"\"text;HDR=NO;imex=1\"\";\"\n        cn.Open\n        Set rs = cn.Execute(\"select * from My_Text_File.txt where F2='04-62425'\")\n        Set rs = Nothing\n        Set cn = Nothing\n    End Sub\n</code></pre>\n\n<p>The error message reads \"No value given for one or more required parameters.\" at the <code>Set rs</code> statement. When I change <code>F2</code> to <code>MFGID</code> (the actual field name given in the header of this text file), it both runs and gives accurate output in the debug window... even though <code>HDR=No</code>.</p>\n\n<p>So, how can I use the F field names if the file has a header this time? The reason this becomes interesting is because I have many text/csv/delimited files sent to my FTP, some have headers, some don't, and some have headers sometimes. </p>\n\n<p>Edit: the schema.ini file reads </p>\n\n<pre><code>[My_Text_File.txt]\nFormat=TabDelimited\n</code></pre>\n\n<p>in case it matters.</p>\n\n<p>A different related question is <a href=\"https://stackoverflow.com/questions/31345000\">ADO Recordset to Excel spreadsheet opens properly in Excel 2007, has a missing parameter in Excel 2013</a>, but the motivation/project of the OP is different, and therefore the answer is irrelevant. </p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 2566, "user_id": 6043669, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/ff752ba637b5c4dfe53d520fde260e45?s=128&d=identicon&r=PG&f=1", "display_name": "HopeKing", "link": "https://stackoverflow.com/users/6043669/hopeking"}, "edited": false, "score": 0, "creation_date": 1461739236, "post_id": 36881751, "comment_id": 61329561, "body": "The given solution above does work with data of say A 22312 B 32 C 42312321 D 52312321321 E 6232. Thanks."}, {"owner": {"reputation": 2566, "user_id": 6043669, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/ff752ba637b5c4dfe53d520fde260e45?s=128&d=identicon&r=PG&f=1", "display_name": "HopeKing", "link": "https://stackoverflow.com/users/6043669/hopeking"}, "edited": false, "score": 0, "creation_date": 1461743040, "post_id": 36881751, "comment_id": 61331845, "body": "your answer is perfect for the question I had asked. But in my zeal to simplify the question, I left out important bits i.e 1. The column headers can be variable and 2. data values have spaces. I have clarified this in my question now. This makes the question and the prospective answer complex in my view. Thanks, but can&#39;t upvote because i dont have the rep as yet :)"}, {"owner": {"reputation": 2089, "user_id": 2901085, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jxiyV.jpg?s=128&g=1", "display_name": "OldUgly", "link": "https://stackoverflow.com/users/2901085/oldugly"}, "reply_to_user": {"reputation": 2566, "user_id": 6043669, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/ff752ba637b5c4dfe53d520fde260e45?s=128&d=identicon&r=PG&f=1", "display_name": "HopeKing", "link": "https://stackoverflow.com/users/6043669/hopeking"}, "edited": false, "score": 0, "creation_date": 1461743431, "post_id": 36881751, "comment_id": 61332092, "body": "@PVR - I don&#39;t see any example in your question where the data values have spaces."}, {"owner": {"reputation": 2566, "user_id": 6043669, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/ff752ba637b5c4dfe53d520fde260e45?s=128&d=identicon&r=PG&f=1", "display_name": "HopeKing", "link": "https://stackoverflow.com/users/6043669/hopeking"}, "edited": false, "score": 0, "creation_date": 1461743820, "post_id": 36881751, "comment_id": 61332298, "body": "I make the edit in the image but not in the initial data. Made the changes now. sorry abt that."}, {"owner": {"reputation": 2566, "user_id": 6043669, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/ff752ba637b5c4dfe53d520fde260e45?s=128&d=identicon&r=PG&f=1", "display_name": "HopeKing", "link": "https://stackoverflow.com/users/6043669/hopeking"}, "edited": false, "score": 0, "creation_date": 1461748452, "post_id": 36881751, "comment_id": 61335362, "body": "Works like a charm. Can&#39;t thank you enough @OldUgly. One minor error, Len(DataString) should be replaced by Len(DataString) + 1 in 3 places above to correct the last digit not coming up in the Elephants column above."}, {"owner": {"reputation": 2089, "user_id": 2901085, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jxiyV.jpg?s=128&g=1", "display_name": "OldUgly", "link": "https://stackoverflow.com/users/2901085/oldugly"}, "reply_to_user": {"reputation": 2566, "user_id": 6043669, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/ff752ba637b5c4dfe53d520fde260e45?s=128&d=identicon&r=PG&f=1", "display_name": "HopeKing", "link": "https://stackoverflow.com/users/6043669/hopeking"}, "edited": false, "score": 1, "creation_date": 1461748524, "post_id": 36881751, "comment_id": 61335409, "body": "@PVR - yep - very late here. Not being too sharp. Thanks."}, {"owner": {"reputation": 2089, "user_id": 2901085, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jxiyV.jpg?s=128&g=1", "display_name": "OldUgly", "link": "https://stackoverflow.com/users/2901085/oldugly"}, "reply_to_user": {"reputation": 2566, "user_id": 6043669, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/ff752ba637b5c4dfe53d520fde260e45?s=128&d=identicon&r=PG&f=1", "display_name": "HopeKing", "link": "https://stackoverflow.com/users/6043669/hopeking"}, "edited": false, "score": 1, "creation_date": 1461749383, "post_id": 36881751, "comment_id": 61335983, "body": "@PVR - updated the code. Also added a Trim statement to clean up trailing blanks."}], "tags": [], "owner": {"reputation": 2089, "user_id": 2901085, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jxiyV.jpg?s=128&g=1", "display_name": "OldUgly", "link": "https://stackoverflow.com/users/2901085/oldugly"}, "is_accepted": true, "score": 2, "last_activity_date": 1461749344, "last_edit_date": 1461749344, "creation_date": 1461737819, "answer_id": 36881751, "question_id": 36881405, "link": "https://stackoverflow.com/questions/36881405/extract-relevant-data-to-relevant-columns-from-unordered-data-in-excel/36881751#36881751", "title": "Extract Relevant data to relevant columns from unordered data in Excel", "body": "<p>I think your formula is too complex, for the problem as you laid it out ...</p>\n\n<p><a href=\"https://i.stack.imgur.com/L9EYz.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/L9EYz.png\" alt=\"enter image description here\"></a></p>\n\n<p>Where Cell B2 contains (filled down and across) ...</p>\n\n<pre><code>=IF(ISERROR(FIND(B$1,$A2)),\"\",MID($A2,FIND(B$1,$A2)+2, 1))\n</code></pre>\n\n<p>This solution relies on the fact the number portion is only a single character long.</p>\n\n<p><strong>Updated for modified requirement</strong></p>\n\n<p>Use this formula in B2 (filled down and across) ...</p>\n\n<pre><code>=IF(ISERROR(FIND(B$1,$A2)),\"\",MID($A2,FIND(B$1,$A2)+2, IF(ISERROR(FIND(\" \",$A2,FIND(B$1,$A2)+2)-(FIND(B$1,$A2)+2)),LEN($A2),FIND(\" \",$A2,FIND(B$1,$A2)+2)-(FIND(B$1,$A2)+2))))\n</code></pre>\n\n<p>... for this result ...</p>\n\n<p><a href=\"https://i.stack.imgur.com/hcape.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/hcape.png\" alt=\"enter image description here\"></a></p>\n\n<p>This solution relies on the fact there are spaces between the Column Names (A, B, etc) and the numbers, and a single character for the Column Name.</p>\n\n<p><strong>Updated for modified requirement</strong></p>\n\n<p>Use this formula in B2 (filled down and across) ...</p>\n\n<pre><code>=IF(ISERROR(FIND(B$1,$A2)),\"\",MID($A2,FIND(B$1,$A2)+LEN(B$1)+1, IF(ISERROR(FIND(\" \",$A2,FIND(B$1,$A2)+LEN(B$1)+1)-(FIND(B$1,$A2)+LEN(B$1)+1)),LEN($A2),FIND(\" \",$A2,FIND(B$1,$A2)+LEN(B$1)+1)-(FIND(B$1,$A2)+LEN(B$1)+1))))\n</code></pre>\n\n<p>For this result ...</p>\n\n<p><a href=\"https://i.stack.imgur.com/Jsnhc.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Jsnhc.png\" alt=\"enter image description here\"></a></p>\n\n<p><strong>Updated for modified requirement</strong></p>\n\n<p>A user defined function is much simpler for this problem.</p>\n\n<p>The following VBA user defined function (UDF) ...</p>\n\n<pre><code>Function FindData(DataString As String, SearchString As String, AllSearchStrings As Range) As String\nDim iLoop As Long, iTemp As Long, iStart As Long, iEnd As Long\nDim oCell As Range\n' Initialize\n    FindData = \"\"\n    If DataString = \"\" Then GoTo Done\n    If SearchString = \"\" Then GoTo Done\n    If AllSearchStrings.Cells.Count = 0 Then GoTo Done\n\n' find where in the data string the data starts\n    On Error Resume Next\n        iStart = WorksheetFunction.Find(SearchString, DataString, 1) + Len(SearchString) + 1\n    On Error GoTo 0\n    If IsError(iStart) Or iStart = 0 Then GoTo Done\n\n' find where in the data string the data ends\n    iEnd = Len(DataString) + 1\n    For Each oCell In AllSearchStrings\n        On Error Resume Next\n            iTemp = WorksheetFunction.Find(oCell.Value, DataString, 1)\n        On Error GoTo 0\n        If IsError(iTemp) Then\n            iTemp = Len(DataString) + 1\n        Else\n            If iTemp &lt; iStart Then iTemp = Len(DataString) + 1\n            If iTemp &lt; iEnd Then iEnd = iTemp\n        End If\n    Next oCell\n\n' extract the string\n    FindData = Trim(Mid(DataString, iStart, iEnd - iStart))\nDone:\nEnd Function\n</code></pre>\n\n<p>... called in Cell B2 (filled down and across) ...</p>\n\n<pre><code>=FindData($A2,B$1,$B$1:$G$1)\n</code></pre>\n\n<p>... and gets this result ...</p>\n\n<p><a href=\"https://i.stack.imgur.com/N1Xg6.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/N1Xg6.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 2566, "user_id": 6043669, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/ff752ba637b5c4dfe53d520fde260e45?s=128&d=identicon&r=PG&f=1", "display_name": "HopeKing", "link": "https://stackoverflow.com/users/6043669/hopeking"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 135, "favorite_count": 1, "accepted_answer_id": 36881751, "answer_count": 1, "score": 1, "last_activity_date": 1461749344, "creation_date": 1461736619, "last_edit_date": 1531161705, "question_id": 36881405, "link": "https://stackoverflow.com/questions/36881405/extract-relevant-data-to-relevant-columns-from-unordered-data-in-excel", "title": "Extract Relevant data to relevant columns from unordered data in Excel", "body": "<p>I have data in the following manner in column A of excel (cells A2, A3, A4)</p>\n\n<ol>\n<li>Apple 223 12 Bags 32 Carrots 4231 2321 Doughnuts 5231 232 1321 Elephants 6232</li>\n<li>Apple 3123213 Bags 412321 3213 Carrots 411 Doughnuts 621 3213 Elephants 71 2321</li>\n<li>Apple 212324 Carrots 52312 Bags 42313 Elephants 512312 Doughnuts 621 32132</li>\n</ol>\n\n<p>I need to pull this data to relevant columns A, B, C, D, E.\nHave been able to come up with the below solution till now.</p>\n\n<ul>\n<li>Insert column headers A, B, C, D, E, Dummy in first row (i.e. B1, C1, D1, E1, F1, G1)</li>\n<li><p>Put the following formula into the respective cells on rows 2,3,4</p>\n\n<pre><code> =MID($A2,FIND(E$1,$A2)+LEN(E$1),IFERROR(FIND(F$1,$A2),LEN($A2)+1)-FIND(E$1,$A2)-LEN(E$1))\n</code></pre></li>\n</ul>\n\n<p>This works for data set 1,2 where the data is in ordered fashion i.e. A then B then C so on</p>\n\n<p>But it doesnt work on data set 3 where data is undordered i.e. A then C then B then E then D..as shown below.  Any suggestions appreciated - Am open to VBA solutions too. Thanks.</p>\n\n<p><a href=\"https://i.stack.imgur.com/eg7Ne.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/eg7Ne.png\" alt=\"TexttoCols\"></a></p>\n"}, {"tags": ["html", "excel", "vba", "internet-explorer", "buttonclick"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1530513488, "post_id": 36880937, "comment_id": 89245339, "body": "Any associated javascript events?"}], "owner": {"reputation": 156, "user_id": 4148465, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UxyErEAgSyM/AAAAAAAAAAI/AAAAAAAADjY/HDyOanPMqAc/photo.jpg?sz=128", "display_name": "Sujoy Bhattacharya", "link": "https://stackoverflow.com/users/4148465/sujoy-bhattacharya"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 712, "favorite_count": 1, "answer_count": 0, "score": 3, "last_activity_date": 1461735062, "creation_date": 1461734494, "last_edit_date": 1461735062, "question_id": 36880937, "link": "https://stackoverflow.com/questions/36880937/excel-vba-unable-to-click-a-button-on-web-page", "title": "Excel VBA unable to click a button on web page", "body": "<p>I have done a lot of internet explorer automation with excel but this has gotten me stumped. </p>\n\n<p>I have a page with a button with the code:-</p>\n\n<pre><code>&lt;a class=\"button button-bg multi-search-add\"&gt;add&lt;/a&gt;\n</code></pre>\n\n<p>I need to click this button to enter a pincode data into the form but i'm not being able to do that</p>\n\n<p>I've tried</p>\n\n<pre><code>Dim objButtonAll As Object\nDim objButton As Object\nSet objButtonAll = ie.document.getElementsByTagName(\"a\")\nFor Each objButton In objButtonAll\nIf objButton.className = \"button button-bg multi-search-add\" Then\nobjButton.Click  \nEnd If\nNext\n</code></pre>\n\n<p>and I've also tried</p>\n\n<pre><code>Dim objButtonAll As Object\nDim objButton As Object\nSet objButtonAll = ie.document.getElementsByTagName(\"a\")\nFor Each objButton In objButtonAll\nIf objButton.innerText = \"add\" Then\nobjButton.Click  \nEnd If\nNext\n</code></pre>\n\n<p>and tried</p>\n\n<pre><code>Dim objButtonAll As Object\nDim objButton As Object\nDim objA As HTMLInputButtonElement\n\nSet objButtonAll = ie.document.getElementsByTagName(\"a\")\nFor Each objButton In objButtonAll\nIf objButton.innerText = \"add\" Then\nobjA=objButton 'I get an error here\nobjA.Click  \nEnd If\nNext\n</code></pre>\n\n<p>The first two codes can identify the point but the objButton.click does nothing. The third code snip gives an error that the <strong>\"Object Variable or with Block Variable not set\"</strong></p>\n\n<p>BTW this is the 130th \"a\" element in the page, the 129th \"a\" element the \"order statuses\" link is easily clicked.</p>\n\n<p>The snap of the website is as below.</p>\n\n<p><a href=\"https://i.stack.imgur.com/xOKUs.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/xOKUs.png\" alt=\"enter image description here\"></a></p>\n\n<p>Also it seems that this part of the code is implemented in Javascript as I cant find this button in the source HTML file.</p>\n\n<p>Any Ideas?</p>\n\n<p>PS. Sendkeys works here ... about 50% of the time.</p>\n"}, {"tags": ["c#", "vba", "com"], "answers": [{"comments": [{"owner": {"reputation": 69, "user_id": 6079998, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b0d226e1a8068644b5b71d4e1573588c?s=128&d=identicon&r=PG&f=1", "display_name": "Jos&#233; Gonz&#225;lez", "link": "https://stackoverflow.com/users/6079998/jos%c3%a9-gonz%c3%a1lez"}, "edited": false, "score": 0, "creation_date": 1461774635, "post_id": 36882331, "comment_id": 61355564, "body": "Is there a need to convert the bitmap to IStdPciture? or Can I use the bitmap directly ?"}, {"owner": {"reputation": 36788, "user_id": 2887618, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e643417e67e5a3bb9f659e4491ed26b0?s=128&d=identicon&r=PG&f=1", "display_name": "Florent B.", "link": "https://stackoverflow.com/users/2887618/florent-b"}, "reply_to_user": {"reputation": 69, "user_id": 6079998, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b0d226e1a8068644b5b71d4e1573588c?s=128&d=identicon&r=PG&f=1", "display_name": "Jos&#233; Gonz&#225;lez", "link": "https://stackoverflow.com/users/6079998/jos%c3%a9-gonz%c3%a1lez"}, "edited": false, "score": 0, "creation_date": 1461775607, "post_id": 36882331, "comment_id": 61356170, "body": "VBA doesn&#39;t support the Bitmap format and the <code>[Oleobject].Picture</code> requires an object implementing the <code>IPictureDisp</code> or <code>IPictureDisp</code> interface."}, {"owner": {"reputation": 69, "user_id": 6079998, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b0d226e1a8068644b5b71d4e1573588c?s=128&d=identicon&r=PG&f=1", "display_name": "Jos&#233; Gonz&#225;lez", "link": "https://stackoverflow.com/users/6079998/jos%c3%a9-gonz%c3%a1lez"}, "edited": false, "score": 0, "creation_date": 1461779173, "post_id": 36882331, "comment_id": 61358539, "body": "I can&#180;t find which library I should use to implement &#39;IpictureDisp&#39; interface I find some references to some StdOle.dll I added a reference to it in the project then put this directive &#39;using stdole;&#39; And modified this line &#39;class _QRCodeGenerator:i_QRCodeGenerator, IDispatch &#39; I still get that curvly red lines xD. I&#39;m not that good at programming I&#39;m learning on the road."}, {"owner": {"reputation": 36788, "user_id": 2887618, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e643417e67e5a3bb9f659e4491ed26b0?s=128&d=identicon&r=PG&f=1", "display_name": "Florent B.", "link": "https://stackoverflow.com/users/2887618/florent-b"}, "reply_to_user": {"reputation": 69, "user_id": 6079998, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b0d226e1a8068644b5b71d4e1573588c?s=128&d=identicon&r=PG&f=1", "display_name": "Jos&#233; Gonz&#225;lez", "link": "https://stackoverflow.com/users/6079998/jos%c3%a9-gonz%c3%a1lez"}, "edited": false, "score": 0, "creation_date": 1461782444, "post_id": 36882331, "comment_id": 61360631, "body": "Have a look here for an example to convert a Bitmap to an IStdPicture picture: <a href=\"https://github.com/florentbr/SeleniumBasic/blob/master/Selenium/Internal/ImgExt.cs\" rel=\"nofollow noreferrer\">github.com/florentbr/SeleniumBasic/blob/master/Selenium/&hellip;</a>"}, {"owner": {"reputation": 69, "user_id": 6079998, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b0d226e1a8068644b5b71d4e1573588c?s=128&d=identicon&r=PG&f=1", "display_name": "Jos&#233; Gonz&#225;lez", "link": "https://stackoverflow.com/users/6079998/jos%c3%a9-gonz%c3%a1lez"}, "edited": false, "score": 0, "creation_date": 1461858368, "post_id": 36882331, "comment_id": 61400767, "body": "I get Error:2192. With this code Dim qr As New QRCoder.QRCodeGenerator Me.Oleobject.PictureData = qr.createqrcode(Texto1, ECCLevel.ECCLevel_Q, 5) if I change .picturedata for .picture it says can&#39;t open QRcoder.QRCodeData."}, {"owner": {"reputation": 69, "user_id": 6079998, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b0d226e1a8068644b5b71d4e1573588c?s=128&d=identicon&r=PG&f=1", "display_name": "Jos&#233; Gonz&#225;lez", "link": "https://stackoverflow.com/users/6079998/jos%c3%a9-gonz%c3%a1lez"}, "edited": false, "score": 0, "creation_date": 1462682229, "post_id": 36882331, "comment_id": 61735855, "body": "I&#180;ve retried over and over again. I get error 2220 can&#39;t open the file."}, {"owner": {"reputation": 36788, "user_id": 2887618, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e643417e67e5a3bb9f659e4491ed26b0?s=128&d=identicon&r=PG&f=1", "display_name": "Florent B.", "link": "https://stackoverflow.com/users/2887618/florent-b"}, "reply_to_user": {"reputation": 69, "user_id": 6079998, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b0d226e1a8068644b5b71d4e1573588c?s=128&d=identicon&r=PG&f=1", "display_name": "Jos&#233; Gonz&#225;lez", "link": "https://stackoverflow.com/users/6079998/jos%c3%a9-gonz%c3%a1lez"}, "edited": false, "score": 0, "creation_date": 1462816410, "post_id": 36882331, "comment_id": 61785463, "body": "It seems that you are using an <code>Access.Image</code> control. Try with an <code>MSForms.Image</code> instead."}, {"owner": {"reputation": 69, "user_id": 6079998, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b0d226e1a8068644b5b71d4e1573588c?s=128&d=identicon&r=PG&f=1", "display_name": "Jos&#233; Gonz&#225;lez", "link": "https://stackoverflow.com/users/6079998/jos%c3%a9-gonz%c3%a1lez"}, "edited": false, "score": 0, "creation_date": 1463001699, "post_id": 36882331, "comment_id": 61881648, "body": "Where do I find that control? It&#39;s not on the default list, Is it in activex controls? Any example? Sorry If I annoy you, I&#39;m new with all this stuff."}], "tags": [], "owner": {"reputation": 36788, "user_id": 2887618, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e643417e67e5a3bb9f659e4491ed26b0?s=128&d=identicon&r=PG&f=1", "display_name": "Florent B.", "link": "https://stackoverflow.com/users/2887618/florent-b"}, "is_accepted": false, "score": 1, "last_activity_date": 1461739628, "creation_date": 1461739628, "answer_id": 36882331, "question_id": 36880780, "link": "https://stackoverflow.com/questions/36880780/how-to-implement-interface-to-an-abstract-class-which-is-constraint/36882331#36882331", "title": "How to implement Interface to an abstract class which is constraint?", "body": "<p>Your COM object can't be created because the class doesn't have a default constructor. Rather than trying to expose the original API, you should create a single class with the methods matching your needs:</p>\n\n<p>VBA usage:</p>\n\n<pre><code>Public Sub QRCreator(text As String)\n  Dim qrc As New QRCoder.QRCodeGenerator\n  Forms!Formulario1.[Oleobject].Picture = qrc.Create(text, CCLevel_Q, 5)\nEnd Sub\n</code></pre>\n\n<p>.Net :</p>\n\n<pre><code>[Guid(\"C7CC4CA0-813A-431E-B92C-842A07735E72\")]\n[ComVisible(true), InterfaceType(ComInterfaceType.InterfaceIsIDispatch)]\npublic interface _QRCodeGenerator {\n\n    public IStdPicture Create(string text, int cclevel, int pixelsPerModule);\n\n}\n\n\n[ProgId(\"QRCoder.QRCodeGenerator\")]\n[Guid(\"4DC2C1F8-2727-4120-80E1-8475650D8547\")]\n[ComVisible(true), ClassInterface(ClassInterfaceType.None)]\n[Description(\"...\")]\npublic class QRCodeGenerator : _QRCodeGenerator, IDisposable {\n\n    private QRCoder.QRCodeGenerator instance;\n\n    public QRCodeGenerator() {\n        instance = new QRCoder.QRCodeGenerator();\n    }\n\n    public IStdPicture Create(string text, int cclevel, int pixelsPerModule){\n        var qrCodeData = instance.CreateQrCode(text, cclevel);\n        var qrCode = new QRCoder.QRCode(qrCodeData);\n        var bitmap = qrCode.GetGraphic(pixelsPerModule);\n        return ImageToPicture(bitmap);\n    }\n\n    public void Dispose() {\n        instance.Dispose();\n    }\n\n    private static IStdPicture ImageToPicture(Bitmap bitmap) {\n        ...\n    }\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 69, "user_id": 6079998, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b0d226e1a8068644b5b71d4e1573588c?s=128&d=identicon&r=PG&f=1", "display_name": "Jos&#233; Gonz&#225;lez", "link": "https://stackoverflow.com/users/6079998/jos%c3%a9-gonz%c3%a1lez"}, "is_accepted": true, "score": 1, "last_activity_date": 1463094002, "creation_date": 1463094002, "answer_id": 37198788, "question_id": 36880780, "link": "https://stackoverflow.com/questions/36880780/how-to-implement-interface-to-an-abstract-class-which-is-constraint/37198788#37198788", "title": "How to implement Interface to an abstract class which is constraint?", "body": "<p>Well After checking, trying and failing I decided to change my perspective. So I did this</p>\n\n<pre><code>using System;\nusing System.Collections.Generic;\nusing System.Linq;\nusing System.Text;\nusing System.Drawing;\nusing Interop;\nusing System.Runtime.InteropServices;\nusing stdole;\nnamespace QRCoder\n{\n[Guid(\"52724C82-F18C-460B-B48D-1F19E016F86E\")]\n[ComVisible (true) , InterfaceType(ComInterfaceType.InterfaceIsDual)]\npublic interface IQRCodeGene\n{\n    string Create(string text, QRCodeGenerator.ECCLevel value, int pixelsPerModule);\n}\n[Guid(\"4F445AA5-D642-438B-A69A-429D621A3CB0\")]\n[ComVisible (true), ClassInterface(ClassInterfaceType.None)]\n   public class QRCodeGene: IQRCodeGene, IDisposable\n{\n    private QRCodeGenerator Instance;\n    public QRCodeGene()\n    {\n        Instance = new QRCodeGenerator();\n    }\n    public string Create(string text, QRCodeGenerator.ECCLevel value, int pixelsPerModule)\n    {\n        var qrCodeData = Instance.CreateQrCode(text, value);\n        var qrCode = new QRCode(qrCodeData);\n        var bitmap = qrCode.GetGraphic(pixelsPerModule);\n// This line is the only modified by the provided in the code above.\n        bitmap.Save(\"C:\\\\\"+text+\".bmp\", System.Drawing.Imaging.ImageFormat.Bmp);\n//I return this string for testing. I guess If removed the text wouldn't work.\n        return (\"Hello\");\n    }\n    public void Dispose()\n    {\n        Instance.Dispose();\n    }\n\n}\n}\n</code></pre>\n\n<p>The code above generates the QRCode of anything I would send trough this function in access VBA:</p>\n\n<pre><code>Public Sub QR(Text As String)\nDim QRC As New QRCodeGene\nDim x As String\nx = QRC.Create(Text, ECCLevel_Q, 5)\n\nEnd Sub\n</code></pre>\n\n<p>After that I just load the picture generated with and access.image control source.\nThanks Florent B. for providing this code.</p>\n"}], "owner": {"reputation": 69, "user_id": 6079998, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b0d226e1a8068644b5b71d4e1573588c?s=128&d=identicon&r=PG&f=1", "display_name": "Jos&#233; Gonz&#225;lez", "link": "https://stackoverflow.com/users/6079998/jos%c3%a9-gonz%c3%a1lez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 373, "favorite_count": 0, "accepted_answer_id": 37198788, "answer_count": 2, "score": 2, "last_activity_date": 1463161580, "creation_date": 1461733696, "last_edit_date": 1495541843, "question_id": 36880780, "link": "https://stackoverflow.com/questions/36880780/how-to-implement-interface-to-an-abstract-class-which-is-constraint", "title": "How to implement Interface to an abstract class which is constraint?", "body": "<p>A few days ago I've tried to use (reference) a QRCode library .net with no interface in ms access vba unsuccesfully. So I did some research and people here guided me.\nSo I decided to make the interface I followed this steps\n<a href=\"https://whoisburiedhere.wordpress.com/2011/07/12/creating-a-com-object-from-scratch-with-c/\" rel=\"nofollow noreferrer\">https://whoisburiedhere.wordpress.com/2011/07/12/creating-a-com-object-from-scratch-with-c/</a></p>\n\n<p>I've been able to see the intellisense and create some of the objects and variables of other classess but I'm trouble with a class in which I see the Dispose() but I can't use the New in ms access:</p>\n\n<pre><code>[Dim QRCD as New QRCode]\n</code></pre>\n\n<p>I get an error the use of New is not valid but I can declare with the line:</p>\n\n<pre><code>Dim QRCD as QRCode\n</code></pre>\n\n<p>[I think that's not an object{ If I try to make it equals to QRData \"That is no permited\" error kicks in}] that class implements an abstract class which has constraints I've tried to put the interface in the abstract class and I get the error \"Does not implement the method\" if I put it in the Child class I can't create an object neither see any of the methods with the late binding.\nThe QRCoder library can be found here.\n<a href=\"https://github.com/codebude/QRCoder\" rel=\"nofollow noreferrer\">https://github.com/codebude/QRCoder</a>\nThis is the abstract class as it's provided.</p>\n\n<pre><code>{\nusing System;\n\npublic abstract class AbstractQRCode&lt;T&gt;\n{\n    protected QRCodeData qrCodeData;\n\n    protected AbstractQRCode(QRCodeData data)\n    {\n        qrCodeData = data;\n    }\n    public abstract T GetGraphic(int pixelsPerModule);\n}\n</code></pre>\n\n<p>}</p>\n\n<p>This is the child class that implements it; it's already modified with the interface. Is not all the code but down are several methods all called GetGraphic(something as something) which are different from one another.</p>\n\n<pre><code>    [ComVisible(true)]\n[Guid(\"It's filled in the program\"), InterfaceType(ComInterfaceType.InterfaceIsDual)]\npublic interface neker\n{\n\n    Bitmap GetGraphic(int pixelsPerModule);\n}\n[ComVisible(true)]\n[Guid(\"\"), ClassInterface(ClassInterfaceType.AutoDual)]\n\npublic class QRCode :AbstractQRCode&lt;Bitmap&gt;, IDisposable, neker\n{\n    public QRCode(QRCodeData data) : base(data) {}\n\n    public override Bitmap GetGraphic(int pixelsPerModule)\n    {\n        return GetGraphic(pixelsPerModule, Color.Black, Color.White, true);\n    }\n\n    public Bitmap GetGraphic(int pixelsPerModule, string darkColorHtmlHex, string lightColorHtmlHex, bool drawQuietZones = true)\n    {\n        return GetGraphic(pixelsPerModule, ColorTranslator.FromHtml(darkColorHtmlHex), ColorTranslator.FromHtml(lightColorHtmlHex), true);\n    }\n</code></pre>\n\n<p>This is the sample code (also provided)</p>\n\n<pre><code>QRCodeGenerator qrGenerator = new QRCodeGenerator();\nQRCodeData qrCodeData = qrGenerator.CreateQrCode(\"The text which should be encoded.\", QRCodeGenerator.ECCLevel.Q);\nQRCode qrCode = new QRCode(qrCodeData);\nBitmap qrCodeImage = qrCode.GetGraphic(20);\n</code></pre>\n\n<p>This is my code in VBA [This is in a Module]</p>\n\n<pre><code>Public Sub QRCreator(QRtext As String)\nDim QRCG As QRCoder.QRCodeGenerator\nSet QRCG = New QRCoder.QRCodeGenerator\nDim QRCD As QRCodeData\nSet QRCD = QRCG.CreateQRCode(QRtext, ECCLevel_Q, False)\nDim QRCO As QRCode\nSet QRCO = Factory.CreateQRCode(QRCD)\nForms!Formulario1.[Oleobject].Picture = QRCO.GetGraphic(5)\nEnd Sub\n\nPublic Sub InitiateProperties(Data As QRCodeData)\n//I declared it as Variant since QRCode is not avaliable\nDim m_data As Variant\nm_data = Data\nEnd Sub\n</code></pre>\n\n<p>This is in another module[I use this modules to create the object with parameters] <a href=\"https://stackoverflow.com/questions/15224113/pass-arguments-to-constructor-in-vba\">Pass arguments to Constructor in VBA</a></p>\n\n<pre><code>Public Function CreateQRCode(Data As QRCodeData) As QRCode\n//you see the word new is missing If I run it it says \"An object is required\"\n\nSet CreateQRCode = QRCode\nCreateQRCode.InitiateProperties Data:=Data\n\nEnd Function\n</code></pre>\n\n<p>How could I modify it to be usable from microsoft access 2013?\nIs another way to do it with no interfaces?\nDoes access supports bitmaps in vba? \nI'm very new with all this stuff so thank you so much.</p>\n\n<p>EDIT:\nTHE REASON WHY I COULD'T MAKE IT WORK WAS COM VISIBLE DOESN\u00b4T SUPPORT CONSTRUCTORS WITH PARAMETERS, AND METHODS WITH OVERRIDES. THE ANSWER THEN IS HOW I WAS ABLE TO CREATE THE IMAGES ANYWAY.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 4, "creation_date": 1461720935, "post_id": 36878519, "comment_id": 61323539, "body": "<i>NumberFormat</i> does not alter the number itself. It only affects the way the number is visually displayed. (It would be really bad if it <i>did</i> modify the values, especially when you were dealing with complex accounting or financial calculations. Imagine the errors that would cause?)"}, {"owner": {"reputation": 32807, "user_id": 196919, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/iqMS0.png?s=128&g=1", "display_name": "DmitryBoyko", "link": "https://stackoverflow.com/users/196919/dmitryboyko"}, "edited": false, "score": 0, "creation_date": 1522728806, "post_id": 36878519, "comment_id": 86251059, "body": "Take a look here <a href=\"https://stackoverflow.com/questions/20648149/what-are-numberformat-options-in-excel-vba/49621979#49621979\" title=\"what are numberformat options in excel vba\">stackoverflow.com/questions/20648149/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 655, "user_id": 3097981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6776097221ad67f371357aaf72cbc775?s=128&d=identicon&r=PG&f=1", "display_name": "Hila DG", "link": "https://stackoverflow.com/users/3097981/hila-dg"}, "is_accepted": false, "score": 3, "last_activity_date": 1461720577, "creation_date": 1461720577, "answer_id": 36878729, "question_id": 36878519, "link": "https://stackoverflow.com/questions/36878519/use-of-numberformat-to-format-decimal-places-in-excel-vba/36878729#36878729", "title": "Use of .NumberFormat to Format Decimal Places in Excel VBA", "body": "<p>Number format only changes the format that you see.\nThe underlying value is VARIANT anyways.\nTry using ROUND() function in order to make sure you import only 2 decimal places</p>\n"}, {"tags": [], "owner": {"reputation": 36788, "user_id": 2887618, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e643417e67e5a3bb9f659e4491ed26b0?s=128&d=identicon&r=PG&f=1", "display_name": "Florent B.", "link": "https://stackoverflow.com/users/2887618/florent-b"}, "is_accepted": true, "score": 18, "last_activity_date": 1461723367, "creation_date": 1461723367, "answer_id": 36879117, "question_id": 36878519, "link": "https://stackoverflow.com/questions/36878519/use-of-numberformat-to-format-decimal-places-in-excel-vba/36879117#36879117", "title": "Use of .NumberFormat to Format Decimal Places in Excel VBA", "body": "<p>The <code>.NumberFormat</code> property formats the rendered text and doesn't alter the value stored in the cell. You can use 'Range.Text' to get the displayed value:</p>\n\n<pre><code>Range(\"A1\") = 99.12345\nRange(\"A1\").NumberFormat = \"0.00\"\nDebug.Print Range(\"A1\").Text   '  &gt; 99.12\nDebug.Print Range(\"A1\").Value  '  &gt; 99.12345\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 8830, "user_id": 5336948, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/YqCFK.jpg?s=128&g=1", "display_name": "Forward Ed", "link": "https://stackoverflow.com/users/5336948/forward-ed"}, "edited": false, "score": 1, "creation_date": 1461743396, "post_id": 36880256, "comment_id": 61332071, "body": "Since we got rid of the penny here in Canada, does that mean we don&#39;t need to worry about the &#39;lost-a-penny&quot; scenario 8)"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 8830, "user_id": 5336948, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/YqCFK.jpg?s=128&g=1", "display_name": "Forward Ed", "link": "https://stackoverflow.com/users/5336948/forward-ed"}, "edited": false, "score": 0, "creation_date": 1461760635, "post_id": 36880256, "comment_id": 61344312, "body": "Actually, since 2 and 7 round down and 3 and 8 round up, it&#39;s more like &#39;lost-a-nickel&#39;.We never lost lost the &#39;cents&#39; in our prices; just the ability to accurately pay said prices."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 1, "last_activity_date": 1461730943, "creation_date": 1461730943, "answer_id": 36880256, "question_id": 36878519, "link": "https://stackoverflow.com/questions/36878519/use-of-numberformat-to-format-decimal-places-in-excel-vba/36880256#36880256", "title": "Use of .NumberFormat to Format Decimal Places in Excel VBA", "body": "<blockquote>\n  <p>Why can the .NumberFormat function change it to 2 decimal places? What do I need to change?</p>\n</blockquote>\n\n<p>Generally speaking you really do not want to change the precision of the raw underlying value. When you do, the 'lost-a-penny' scenario often comes into play; particularly so when calculating and totalling percentages in taxes, interest rates, wholesale-to-retail markup, etc.</p>\n\n<p>With that said, you can quickly change precision of the underlying value to what is displayed for the entire workbook with the following.</p>\n\n<pre><code>ActiveWorkbook.PrecisionAsDisplayed = True\n</code></pre>\n\n<p>The <a href=\"https://msdn.microsoft.com/en-us/library/office/ff198189.aspx\" rel=\"nofollow\">.PrecisionAsDisplayed property</a> is a member of the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff835568.aspx\" rel=\"nofollow\">Workbook Object</a>. As such it can be accessed with the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff821871.aspx\" rel=\"nofollow\">ActiveWorkbook property</a>, <a href=\"https://msdn.microsoft.com/en-us/library/office/aa215773%28v=office.11%29.aspx\" rel=\"nofollow\">ThisWorkbook Property</a> or a named workbook in the <a href=\"https://msdn.microsoft.com/en-us/library/office/aa224505.aspx\" rel=\"nofollow\">Workbooks Collection</a>.</p>\n\n<blockquote>\n  <p><strong>Warning!</strong> This action <strong>cannot</strong> be undone. Once you truncate the decimal  precision to the displayed value, you cannot get it back.</p>\n</blockquote>\n\n<p>This option is also available within Excel Options, Advanced, When calculating this workbook, Set Precision as displayed. Expect a similar warning.</p>\n"}], "owner": {"reputation": 5840, "user_id": 633426, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/7f8a472ee625830cccd5290d70907e54?s=128&d=identicon&r=PG", "display_name": "Concerned_Citizen", "link": "https://stackoverflow.com/users/633426/concerned-citizen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 90977, "favorite_count": 1, "accepted_answer_id": 36879117, "answer_count": 3, "score": 10, "last_activity_date": 1461774925, "creation_date": 1461719061, "last_edit_date": 1461774925, "question_id": 36878519, "link": "https://stackoverflow.com/questions/36878519/use-of-numberformat-to-format-decimal-places-in-excel-vba", "title": "Use of .NumberFormat to Format Decimal Places in Excel VBA", "body": "<p>I am inserting data into a Word doc from an Excel spreadsheet. There is a value that has more than 2 decimal places. I am using the following code to try to convert it to 2 decimal places and paste it to my doc.</p>\n\n<pre><code> wdApp.Selection.GoTo what:=-1, Name:=\"Device_Avail\"\n''Referring to the total count column in the Device Availability worksheet.\nSet devAvailRow = shDevAvail.Range(\"A:A\").Find(\"Overall Totals:\",       \nAfter:=Cells(1, 1), searchdirection:=xlPrevious)\n\n''Actual piece to format value to 2 decimal places.\nshDevAvail.Cells(devAvailRow.Row, 3).NumberFormat = \"0.00\"\ndevAvailPer = shDevAvail.Cells(devAvailRow.Row, 3)\nwdApp.Selection.TypeText devAvailPer\n</code></pre>\n\n<p>The value now shows only 2 decimal places, but the formula bar is showing a lot more. </p>\n\n<p><a href=\"https://i.stack.imgur.com/MQO3L.png\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/MQO3L.png\" alt=\"enter image description here\"></a></p>\n\n<p>And <code>?Selection.Value</code> in the Immediate Window of VBA console is showing 89.43448051 too. And this gets pasted into my doc. </p>\n\n<p>Why can the <code>.NumberFormat</code> function change it to 2 decimal places? What do I need to change?</p>\n"}, {"tags": ["html", "vba"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 6258939, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wIyMJ.jpg?s=128&g=1", "display_name": "JZOR", "link": "https://stackoverflow.com/users/6258939/jzor"}, "edited": false, "score": 0, "creation_date": 1461720029, "post_id": 36878540, "comment_id": 61323323, "body": "That was it. I have to read up on the appropriate way to say thanks and award points, but for now...Thank you!!"}], "tags": [], "owner": {"reputation": 1969, "user_id": 6208915, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/66d12a46b70b55620f35c08c7db5d696?s=128&d=identicon&r=PG&f=1", "display_name": "Gabor", "link": "https://stackoverflow.com/users/6208915/gabor"}, "is_accepted": true, "score": 0, "last_activity_date": 1461719244, "creation_date": 1461719244, "answer_id": 36878540, "question_id": 36878466, "link": "https://stackoverflow.com/questions/36878466/need-to-loop-through-recordset-to-insert-html-table-in-outlook-email-body/36878540#36878540", "title": "Need to loop through recordset to insert HTML table in Outlook email body", "body": "<p>The problem is that you always append the current record to <code>strHTML</code> so it will contain only the last record added to <code>strHTML</code>.</p>\n\n<p>Instead initialize <code>MailBody</code> with <code>strHTML</code> and append <code>MailBody</code> in each loop just like you did in the plain text version.</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>strHTML = \"&lt;HTML&gt;&lt;Body&gt;&lt;table border='1' width='50%'&gt;&lt;tr&gt;&lt;th&gt;Request Date&lt;/th&gt;&lt;th&gt;Submitted By&lt;/th&gt;\" &amp; _\n\"&lt;th&gt;Department&lt;/th&gt;&lt;th&gt;Effective Date&lt;/th&gt;&lt;th&gt;Description&lt;/th&gt;&lt;/tr&gt;\"\n\n' Initialize Mailbody    \nMailbody = strHTML\n\nWith rst\n  Do While Not rst.EOF\n\n  ' Here you append the current record to the end of the Mailbody variable.\n  Mailbody = Mailbody &amp; \"&lt;tr&gt;&lt;td&gt;\" &amp; rst(\"hdr_req_date\") &amp; \"&lt;/td&gt;&lt;td&gt;\" &amp; _\n        rst(\"usr_name\") &amp; \"&lt;/td&gt;&lt;td&gt;\" &amp; rst(\"hdr_department\") &amp; \"&lt;/td&gt;&lt;td&gt;\" &amp; _\n        rst(\"dtl_req_eff_date\") &amp; \"&lt;/td&gt;&lt;td&gt;\" &amp; rst(\"dtl_chg_desc\") &amp; \"&lt;/td&gt;&lt;/tr&gt;\" &amp; _\n        vbCrLf\n\n   rst.MoveNext\n   Loop\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 6258939, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wIyMJ.jpg?s=128&g=1", "display_name": "JZOR", "link": "https://stackoverflow.com/users/6258939/jzor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1601, "favorite_count": 0, "accepted_answer_id": 36878540, "answer_count": 1, "score": 0, "last_activity_date": 1461719244, "creation_date": 1461718786, "question_id": 36878466, "link": "https://stackoverflow.com/questions/36878466/need-to-loop-through-recordset-to-insert-html-table-in-outlook-email-body", "title": "Need to loop through recordset to insert HTML table in Outlook email body", "body": "<p>I am attempting to loop through a recordset in Access VBA. The results are then to be output to an HTML formatted table in the email body of an Outlook item. I have been able to loop through all records in the recordset, as long as it is not formatted in HTML.  </p>\n\n<p>As soon as I insert the HTML string, the loop fails to return more than one record in the body of the email. </p>\n\n<p>A Debug.Print counts the appropriate number of records in the recordset, but the HTML table only returns the header and one record. </p>\n\n<p>The following code prints the entire recordset based on the query parameters. All rows are returned in text format with each data element pipe delimited:</p>\n\n<pre><code>Set dbs = CurrentDb()\nSet qdf = dbs.QueryDefs(\"qryNewRequest\")\nqdf.Parameters(0) = Me![hdr_ID]\nSet rst = qdf.OpenRecordset()\n\nWith rst\n  Do While Not rst.EOF\n  Mailbody = Mailbody &amp; ![hdr_req_date] &amp; \" | \" &amp; ![usr_name] &amp; _\n  \" | \" &amp; ![hdr_department] &amp; \" | \" &amp; ![dtl_req_eff_date] &amp; _\n  \" | \" &amp; ![dtl_chg_cpt] &amp; \" | \" &amp; ![dtl_chg_rev] &amp; _\n  \" | \" &amp; ![dtl_chg_price] &amp; \" | \" &amp; ![reason] &amp; vbCrLf\n  rst.MoveNext\n  Loop\nEnd With\n\n\nSet olApp = CreateObject(\"Outlook.application\")\nSet olItem = olApp.CreateItem(0)\n\nolItem.display\nolItem.To = \"me@mymail.com\"\nolItem.Subject = \"New Request\"\nolItem.body = Mailbody\n</code></pre>\n\n<p>However, when I try to format the results in an HTML table, only the header and the first row of the recordset is returned. See code below:</p>\n\n<pre><code>Set dbs = CurrentDb()\nSet qdf = dbs.QueryDefs(\"qryNewRequest\")\nqdf.Parameters(0) = Me![hdr_ID]\nSet rst = qdf.OpenRecordset()\n\nstrHTML = \"&lt;HTML&gt;&lt;Body&gt;&lt;table border='1' width='50%'&gt;&lt;tr&gt;&lt;th&gt;Request Date&lt;/th&gt;&lt;th&gt;Submitted By&lt;/th&gt;\" &amp; _\n\"&lt;th&gt;Department&lt;/th&gt;&lt;th&gt;Effective Date&lt;/th&gt;&lt;th&gt;Description&lt;/th&gt;&lt;/tr&gt;\"\n\nWith rst\n  Do While Not rst.EOF\n  Mailbody = strHTML &amp; \"&lt;tr&gt;&lt;td&gt;\" &amp; rst(\"hdr_req_date\") &amp; \"&lt;/td&gt;&lt;td&gt;\" &amp; _\n        rst(\"usr_name\") &amp; \"&lt;/td&gt;&lt;td&gt;\" &amp; rst(\"hdr_department\") &amp; \"&lt;/td&gt;&lt;td&gt;\" &amp; _\n        rst(\"dtl_req_eff_date\") &amp; \"&lt;/td&gt;&lt;td&gt;\" &amp; rst(\"dtl_chg_desc\") &amp; \"&lt;/td&gt;&lt;/tr&gt;\" &amp; _\n        vbCrLf\n\n   rst.MoveNext\n   Loop\nEnd With\n\nstrHTML = strHTML &amp; \"&lt;/table&gt;&lt;/body&gt;&lt;/html&gt;\"\n\nSet olApp = CreateObject(\"Outlook.application\")\nSet olItem = olApp.CreateItem(0)\n\nolItem.display\nolItem.To = \"me@mymail.com\"\nolItem.Subject = \"New Request\"\nolItem.HTMLbody = Mailbody\n</code></pre>\n\n<p>Running the query directly from the Access form passes the parameter appropriately, and returns the correct number of records. The email item is created in both methods, so I believe my problem is in the HTML of the sub. As stated, a Debug.Print on the intCount of the recordset returns the appropriate number of records based on the query.</p>\n\n<p>Am I missing something simple? I have done a lot of hunting and searching over the last few days, so I apologize if I missed another thread that has the answer. This is my first post, so bear with me as I learn the site rules and etiquette. </p>\n\n<p>Thank you </p>\n"}, {"tags": ["excel", "vba", "search", "substring", "vlookup"], "comments": [{"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 1, "creation_date": 1461955568, "post_id": 36878302, "comment_id": 61449451, "body": "did you come up to anything with answers given up to date?"}, {"owner": {"reputation": 83, "user_id": 3958175, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/1132054314/picture?type=large", "display_name": "Ian Schneider", "link": "https://stackoverflow.com/users/3958175/ian-schneider"}, "reply_to_user": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1461961885, "post_id": 36878302, "comment_id": 61452475, "body": "currently testing OldUgly&#39;s fix, seems to be really close and just working out the kinks"}, {"owner": {"reputation": 83, "user_id": 3958175, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/1132054314/picture?type=large", "display_name": "Ian Schneider", "link": "https://stackoverflow.com/users/3958175/ian-schneider"}, "reply_to_user": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1461966343, "post_id": 36878302, "comment_id": 61454445, "body": "Both answers below were close - user&#39;s below provided the most results, but still errored on some that there should be answers for"}], "answers": [{"comments": [{"owner": {"reputation": 83, "user_id": 3958175, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/1132054314/picture?type=large", "display_name": "Ian Schneider", "link": "https://stackoverflow.com/users/3958175/ian-schneider"}, "edited": false, "score": 0, "creation_date": 1461776072, "post_id": 36880441, "comment_id": 61356463, "body": "So this is great, however, it looks like it can only search in A2/B2 for the criteria in D2. My situation is I have columns A, B, C on one sheet, and Column D and E on another, where I&#39;m trying to pull the corresponding result for each code, if it exists.   My formula I have currently performs similarly to what you have, however I&#39;m looking to have it search all of column A/B, so I could hypothetically, going off your above sample, have AC-92 in D2 and it would still pull Result3"}, {"owner": {"reputation": 2089, "user_id": 2901085, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jxiyV.jpg?s=128&g=1", "display_name": "OldUgly", "link": "https://stackoverflow.com/users/2901085/oldugly"}, "reply_to_user": {"reputation": 83, "user_id": 3958175, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/1132054314/picture?type=large", "display_name": "Ian Schneider", "link": "https://stackoverflow.com/users/3958175/ian-schneider"}, "edited": false, "score": 0, "creation_date": 1461783502, "post_id": 36880441, "comment_id": 61361309, "body": "It&#39;s simple enough to move Columns D and E to a different tab. In order to search the entire set, you will need to use array formulae. I&#39;m away from my computer now, but can look into later."}, {"owner": {"reputation": 2089, "user_id": 2901085, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jxiyV.jpg?s=128&g=1", "display_name": "OldUgly", "link": "https://stackoverflow.com/users/2901085/oldugly"}, "reply_to_user": {"reputation": 83, "user_id": 3958175, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/1132054314/picture?type=large", "display_name": "Ian Schneider", "link": "https://stackoverflow.com/users/3958175/ian-schneider"}, "edited": false, "score": 0, "creation_date": 1461804823, "post_id": 36880441, "comment_id": 61370638, "body": "@IanSchneider - is this closer to what you were looking for?"}, {"owner": {"reputation": 83, "user_id": 3958175, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/1132054314/picture?type=large", "display_name": "Ian Schneider", "link": "https://stackoverflow.com/users/3958175/ian-schneider"}, "edited": false, "score": 0, "creation_date": 1461961305, "post_id": 36880441, "comment_id": 61452178, "body": "It looks like it worked in your example above, which is pretty much identical to what I need, however it&#39;s erroring out in the first argument for me, the if(iserror(find(right(. I&#39;m also not understanding the need for concatenate? looks like it only has half the function in there anyway"}, {"owner": {"reputation": 2089, "user_id": 2901085, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jxiyV.jpg?s=128&g=1", "display_name": "OldUgly", "link": "https://stackoverflow.com/users/2901085/oldugly"}, "reply_to_user": {"reputation": 83, "user_id": 3958175, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/1132054314/picture?type=large", "display_name": "Ian Schneider", "link": "https://stackoverflow.com/users/3958175/ian-schneider"}, "edited": false, "score": 0, "creation_date": 1461961568, "post_id": 36880441, "comment_id": 61452311, "body": "It&#39;s a CSE formula, so it generates an array. Without the CONCAT, it returns the first array element, which is often &quot;&quot;. CONCAT puts all of the answers together - typically <code>Result1&amp;&quot;&quot;&amp;&quot;&quot;</code> or <code>&quot;&quot;&amp;Result2&amp;&quot;&quot;</code> or <code>&quot;&quot;&amp;&quot;&quot;&amp;Result3</code>. And CONCAT should enclose everything - so maybe there&#39;s a problem with the brackets."}, {"owner": {"reputation": 83, "user_id": 3958175, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/1132054314/picture?type=large", "display_name": "Ian Schneider", "link": "https://stackoverflow.com/users/3958175/ian-schneider"}, "edited": false, "score": 0, "creation_date": 1461961831, "post_id": 36880441, "comment_id": 61452446, "body": "ah that makes sense why it&#39;s not working, looks like it&#39;s only in excel16? I&#39;m running on 2010, so to make this function I would replace with concatenate at the beginning, and it then doesn&#39;t need the rest of the argument?"}, {"owner": {"reputation": 2089, "user_id": 2901085, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jxiyV.jpg?s=128&g=1", "display_name": "OldUgly", "link": "https://stackoverflow.com/users/2901085/oldugly"}, "reply_to_user": {"reputation": 83, "user_id": 3958175, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/1132054314/picture?type=large", "display_name": "Ian Schneider", "link": "https://stackoverflow.com/users/3958175/ian-schneider"}, "edited": false, "score": 0, "creation_date": 1461962151, "post_id": 36880441, "comment_id": 61452608, "body": "Sorry - I see just now it was introduced in 2016. It works a little different than CONCATENATE with arrays. So it may not work."}, {"owner": {"reputation": 83, "user_id": 3958175, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/1132054314/picture?type=large", "display_name": "Ian Schneider", "link": "https://stackoverflow.com/users/3958175/ian-schneider"}, "edited": false, "score": 0, "creation_date": 1461962250, "post_id": 36880441, "comment_id": 61452673, "body": "yup it was the brackets! I moved the concatenate brackets to after the first and second &quot;&quot; and it&#39;s pulling results now. It&#39;s pulling the first result however which isn&#39;t correct, I&#39;m looking into why so. Noticed in my example it was based on comma separation in cols A and B, but I actually have semi-colons"}, {"owner": {"reputation": 2089, "user_id": 2901085, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jxiyV.jpg?s=128&g=1", "display_name": "OldUgly", "link": "https://stackoverflow.com/users/2901085/oldugly"}, "reply_to_user": {"reputation": 83, "user_id": 3958175, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/1132054314/picture?type=large", "display_name": "Ian Schneider", "link": "https://stackoverflow.com/users/3958175/ian-schneider"}, "edited": false, "score": 0, "creation_date": 1461962386, "post_id": 36880441, "comment_id": 61452741, "body": "The equation is lengthy because <code>AND()</code> and <code>OR()</code> don&#39;t work as you would want with arrays - so you need to use nested <code>IF()</code> statements."}, {"owner": {"reputation": 83, "user_id": 3958175, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/1132054314/picture?type=large", "display_name": "Ian Schneider", "link": "https://stackoverflow.com/users/3958175/ian-schneider"}, "edited": false, "score": 0, "creation_date": 1461966193, "post_id": 36880441, "comment_id": 61454401, "body": "hey well I appreciate it! Noted that this is an appropriate answer for Excel 2016"}], "tags": [], "owner": {"reputation": 2089, "user_id": 2901085, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jxiyV.jpg?s=128&g=1", "display_name": "OldUgly", "link": "https://stackoverflow.com/users/2901085/oldugly"}, "is_accepted": false, "score": 1, "last_activity_date": 1461996754, "last_edit_date": 1461996754, "creation_date": 1461732006, "answer_id": 36880441, "question_id": 36878302, "link": "https://stackoverflow.com/questions/36878302/find-specifc-text-in-multiple-columns-in-excel/36880441#36880441", "title": "Find specifc text in multiple columns in excel", "body": "<p>If you put the code you are looking for in Column D, then your formula in Column E, the following formula will accomplish what you are looking for ... </p>\n\n<p><code>=IF(OR(ISERROR(FIND(LEFT(D2,2),A2)),ISERROR(FIND(RIGHT(D2,2),B2)),LEN(D2)=0),\"\",C2)</code></p>\n\n<p>And then fill it down.</p>\n\n<p>The formula searches for the left two characters from the code in Column A. If it's not found, an error is thrown. It also looks for the right two characters from the code in Column B. If it's not found, an error is thrown. If the code you are looking for is blank, no error is thrown, so we need to check that case. </p>\n\n<p>So if there is an error searching for the left part, or an error searching for the right part, or there is no code to look for, return a blank. Otherwise, return the result.</p>\n\n<p>Below are some examples ...</p>\n\n<p><a href=\"https://i.stack.imgur.com/E2qHz.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/E2qHz.png\" alt=\"enter image description here\"></a></p>\n\n<hr>\n\n<p><strong>Updated based on comments</strong></p>\n\n<p>On Sheet1, the data looks like this ...</p>\n\n<p><a href=\"https://i.stack.imgur.com/7B5H6.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/7B5H6.png\" alt=\"enter image description here\"></a></p>\n\n<p>... On Sheet2, we have results like this ...</p>\n\n<p><a href=\"https://i.stack.imgur.com/78jW2.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/78jW2.png\" alt=\"enter image description here\"></a></p>\n\n<p>Where Cell <code>B2</code> contains this formula (filled down)</p>\n\n<pre><code>{=CONCAT(IF(ISERROR(FIND(LEFT(A2,2),Sheet1!$A$1:$A$3)),\"\",IF(ISERROR(FIND(RIGHT(A2,2),Sheet1!$B$1:$B$3)),\"\",IF(LEN(A2)&lt;1,\"\",Sheet1!$C$1:$C$3))))}\n</code></pre>\n\n<hr>\n\n<p><strong>Updated due to version-itis</strong></p>\n\n<p>When all else fails, go to VBA. Attached is an example Function. It gets the same results as shown above. It is invoked with formula in Column B, filled down ...</p>\n\n<pre><code>=FindResult(A2,Sheet1!$A$1:$A$3,Sheet1!$B$1:$B$3,Sheet1!$C$1:$C$3)\n</code></pre>\n\n<p>Code ...</p>\n\n<pre><code>Function FindResult(inString As String, LeftRange As Range, RightRange As Range, ReturnRange As Range) As String\nDim strArr() As String\nDim myCellLeft As Range, myCellRight\n\n'initial\nFindResult = \"\"\nIf LeftRange Is Nothing Then GoTo Done:\nIf RightRange Is Nothing Then GoTo Done:\nIf ReturnRange Is Nothing Then GoTo Done:\n\n' get the two halfs\nstrArr = Split(inString, \"-\")\nIf UBound(strArr) &lt; 1 Then GoTo Done:\n\n' Search the left range for the left half, the right range for the right half\nFor Each myCellLeft In LeftRange\n    If InStr(1, myCellLeft.Value, strArr(0)) &gt; 0 Then\n        For Each myCellRight In RightRange.Rows(myCellLeft.Row)\n            If InStr(1, myCellRight.Value, strArr(1)) &gt; 0 Then\n                FindResult = ReturnRange.Rows(myCellLeft.Row)\n                Exit For\n            End If\n        Next myCellRight\n        If FindResult &lt;&gt; \"\" Then Exit For\n    End If\nNext myCellLeft\n' clean up\nDone:\nErase strArr\nSet myCellLeft = Nothing\nSet myCellRight = Nothing\nEnd Function\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 83, "user_id": 3958175, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/1132054314/picture?type=large", "display_name": "Ian Schneider", "link": "https://stackoverflow.com/users/3958175/ian-schneider"}, "edited": false, "score": 0, "creation_date": 1461966164, "post_id": 36907238, "comment_id": 61454387, "body": "hey thanks! while this was pretty wordy, it worked for a decent amount. Came up with some errors on answers I would of expected but not bad. I don&#39;t believe VBA is appropriate for what I&#39;m trying to do but I will test it later."}, {"owner": {"reputation": 83, "user_id": 3958175, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/1132054314/picture?type=large", "display_name": "Ian Schneider", "link": "https://stackoverflow.com/users/3958175/ian-schneider"}, "edited": false, "score": 0, "creation_date": 1461968024, "post_id": 36907238, "comment_id": 61455082, "body": "Seems to be pulling in &quot;Different Rows&quot; for a lot that should have results, I&#39;m going to test the VBA as well as tinker with the huge formula and see which turns out better"}, {"owner": {"reputation": 83, "user_id": 3958175, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/1132054314/picture?type=large", "display_name": "Ian Schneider", "link": "https://stackoverflow.com/users/3958175/ian-schneider"}, "edited": false, "score": 0, "creation_date": 1461969958, "post_id": 36907238, "comment_id": 61455738, "body": "VBA did not work - however, I removed the section of your code for the different rows result, and now it&#39;s pulling the first result pertaining to the left 2 characters of the code in D - ex. is there is <code>D3-16</code> with <code>result1</code> and <code>D3-02</code> with <code>result2</code>, both lines will pull <code>result1</code>. I think the answer lies in the last section with the index(match(."}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "reply_to_user": {"reputation": 83, "user_id": 3958175, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/1132054314/picture?type=large", "display_name": "Ian Schneider", "link": "https://stackoverflow.com/users/3958175/ian-schneider"}, "edited": false, "score": 0, "creation_date": 1461991947, "post_id": 36907238, "comment_id": 61460110, "body": "If you post data for which you encounterrd errors for both formula and VBA approache, I &#39;ll have a look"}], "tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": false, "score": 1, "last_activity_date": 1461826069, "creation_date": 1461826069, "answer_id": 36907238, "question_id": 36878302, "link": "https://stackoverflow.com/questions/36878302/find-specifc-text-in-multiple-columns-in-excel/36907238#36907238", "title": "Find specifc text in multiple columns in excel", "body": "<p>the \"formula\" approach is, to my knowledge, quite verbose and cumbersome as follows:</p>\n\n<pre><code>=IF(\n        ISNA(\n                   IFERROR(MATCH(LEFT(D1,SEARCH(\"-\",D1)-1),Codes!$A$1:$A$100,0),\n                                     IFERROR(MATCH(\"*\"&amp;LEFT(D1,SEARCH(\"-\",D1)-1)&amp;\",*\",Codes!$A$1:$A$100,0),\n                                                       MATCH(\"*,\"&amp;LEFT(D1,SEARCH(\"-\",D1)-1)&amp;\"*\",Codes!$A$1:$A$100,0)))\n                   *\n                   IFERROR(MATCH(RIGHT(D1,LEN(D1)-SEARCH(\"-\",D1)),Codes!$B$1:$B$100,0),\n                                      IFERROR(MATCH(\"*\"&amp;RIGHT(D1,LEN(D1)-SEARCH(\"-\",D1))&amp;\",*\",Codes!$B$1:$B$100,0),\n                                                        MATCH(\"*,\"&amp;RIGHT(D1,LEN(D1)-SEARCH(\"-\",D1))&amp;\"*\",Codes!$B$1:$B$100,0)))\n                   ),\n\n         \"Not Found\",\n\n          IF(IFERROR(MATCH(LEFT(D1,SEARCH(\"-\",D1)-1),Codes!$A$1:$A$100,0),\n                                   IFERROR(MATCH(\"*\"&amp;LEFT(D1,SEARCH(\"-\",D1)-1)&amp;\",*\",Codes!$A$1:$A$100,0),\n                                                      MATCH(\"*,\"&amp;LEFT(D1,SEARCH(\"-\",D1)-1)&amp;\"*\",Codes!$A$1:$A$100,0)))\n                &lt;&gt;\n                IFERROR(MATCH(RIGHT(D1,LEN(D1)-SEARCH(\"-\",D1)),Codes!$B$1:$B$100,0),\n                                    IFERROR(MATCH(\"*\"&amp;RIGHT(D1,LEN(D1)-SEARCH(\"-\",D1))&amp;\",*\",Codes!$B$1:$B$100,0),\n                                                      MATCH(\"*,\"&amp;RIGHT(D1,LEN(D1)-SEARCH(\"-\",D1))&amp;\"*\",Codes!$B$1:$B$100,0))), \n\n               \"Different rows\",\n\n                INDEX(Codes!C:C,IFERROR(MATCH(RIGHT(D1,LEN(D1)-SEARCH(\"-\",D1)),Codes!$B$1:$B$100,0),\n                                                       IFERROR(MATCH(\"*\"&amp;RIGHT(D1,LEN(D1)-SEARCH(\"-\",D1))&amp;\",*\",Codes!$B$1:$B$100,0),\n                                                                         MATCH(\"*,\"&amp;RIGHT(D1,LEN(D1)-SEARCH(\"-\",D1))&amp;\"*\",Codes!$B$1:$B$100,0))))\n               )\n        )\n</code></pre>\n\n<p>where I used a (hopefully) more readable format and assumed:</p>\n\n<ul>\n<li><p>\"Codes\" as the sheet name whose columns \"A\" (\"first\" code), \"B\" (\"second\" code) and \"C\" (\"Results\") are placed</p></li>\n<li><p>codes pairs are to be placed in column \"D\" of any sheet</p></li>\n<li><p>formula is to be placed in column \"E\" adjacent to above mentioned column \"D\" cells </p></li>\n</ul>\n\n<p>you may want to consider a \"VBA\" approach like the following</p>\n\n<pre><code>Sub main()\nDim codesSht As Worksheet\nDim cell As Range, found As Range, codesRng As Range\nDim index1 As Long\n\nSet codesSht = ThisWorkbook.Worksheets(\"Codes\") '&lt;== change \"codes\" sheet reference as per your needs\nSet codesRng = codesSht.Range(\"A:B\").SpecialCells(xlCellTypeConstants, xlTextValues)\nWith ThisWorkbook.Worksheets(\"Results\") '&lt;== change \"Results\" sheet reference as per your needs\n    For Each cell In .Range(\"D1:D\" &amp; .Cells(.Rows.count, \"D\").End(xlUp).Row).SpecialCells(xlCellTypeConstants, xlTextValues)\n        Set found = codesRng.Resize(, 1).Find(What:=Split(cell.Value, \"-\")(0), LookIn:=xlValues, LookAt:=xlPart)\n        If Not found Is Nothing Then\n            index1 = found.Row\n            Set found = codesRng.Offset(, 1).Resize(, 1).Find(What:=Split(cell.Value, \"-\")(1), LookIn:=xlValues, LookAt:=xlPart)\n            If Not found Is Nothing Then If found.Row = index1 Then cell.Offset(, 1).Value = codesRng(index1, 3)\n        End If\n    Next cell\nEnd With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 83, "user_id": 3958175, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/1132054314/picture?type=large", "display_name": "Ian Schneider", "link": "https://stackoverflow.com/users/3958175/ian-schneider"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 747, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1461996754, "creation_date": 1461717712, "last_edit_date": 1495540360, "question_id": 36878302, "link": "https://stackoverflow.com/questions/36878302/find-specifc-text-in-multiple-columns-in-excel", "title": "Find specifc text in multiple columns in excel", "body": "<p>I've got a formula that's been puzzling me for a while - I feel I'm close but the solution is evading me so I'm turning to you wizards. This questions is similar to <a href=\"https://stackoverflow.com/questions/23811521/excel-vlookup-and-search-combination\">Excel VLOOKUP and SEARCH combination</a>.</p>\n\n<p>Problem:</p>\n\n<p>I want to look up a value which is a pair of codes separated by a dash, ex.\n<code>01-05</code>\n<code>A1-B2</code>\n<code>AB-90</code>\n, within columns A and B and return a result from C.</p>\n\n<p>The issue is that I'm searching in two columns, which may include multiple codes separated by commas:</p>\n\n<pre><code>Col A          Col B           Col C\n\n01             05, B2          Result1\nA1             B2              Result2\nAB, AC         90, 91, 92      Result3\n</code></pre>\n\n<p>I was thinking that a <code>=if(isnumber(search(</code> function would be the key but I can't figure how to have it check the entire column and once found, check the column next to it for the 2nd part of the code.</p>\n\n<p>Ideally, the formula would perform as such, where in the above example, if I were to run this formula on the criteria <code>01-05</code> it would return <code>Result1</code>.</p>\n\n<p>Appreciated!</p>\n"}, {"tags": ["excel", "csv", "text", "vba"], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user3246980"}, "edited": false, "score": 0, "creation_date": 1463721666, "post_id": 36878468, "comment_id": 62194082, "body": "This is great! Thanks."}], "tags": [], "owner": {"reputation": 2462, "user_id": 639580, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/21b3041d664dd92d697bd3e0bca40fb7?s=128&d=identicon&r=PG", "display_name": "Tony", "link": "https://stackoverflow.com/users/639580/tony"}, "is_accepted": true, "score": 0, "last_activity_date": 1461719804, "last_edit_date": 1461719804, "creation_date": 1461718799, "answer_id": 36878468, "question_id": 36877829, "link": "https://stackoverflow.com/questions/36877829/text-list-to-excel-spreadsheet/36878468#36878468", "title": "Text list to excel spreadsheet", "body": "<p>This is more easily accomplished in Word, if that's a possibility.  You can use it create a tab-separated list, and then put that into Excel.</p>\n\n<p>Assuming the text formatting in your example is accurate, the macro below will perform the desired conversion.  You could also search/replace manually.</p>\n\n<pre><code>Sub LineZapper()\n   Selection.Find.Execute FindText:=\"Item No: \", ReplaceWith:=\"\", Replace:=wdReplaceAll\n   Selection.Find.Execute FindText:=\"^pDescription: \", ReplaceWith:=\"^t\", Replace:=wdReplaceAll\n   Selection.Find.Execute FindText:=\"^pBarcode: \", ReplaceWith:=\"^t\", Replace:=wdReplaceAll\n   Selection.Find.Execute FindText:=\"^pBarcode:\", ReplaceWith:=\"^t\", Replace:=wdReplaceAll\n   Selection.Find.Execute FindText:=\"^pSize: \", ReplaceWith:=\"^t\", Replace:=wdReplaceAll\n   Selection.Find.Execute FindText:=\"^p^p\", ReplaceWith:=\"^p\", Replace:=wdReplaceAll\nEnd Sub\n</code></pre>\n\n<p>I created two instances to replace the \"<code>Barcode:</code>\" lines because in the text sample where there's no barcode data, there's no trailing space like the others have.</p>\n\n<p>Note that if there are preexisting tabs in your text list, it will throw off the import to Excel.  If that's the case, the first step should be a search/replace to eliminate them.</p>\n\n<p>It's easy enough to manually insert a header row later.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user3246980"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 66, "favorite_count": 0, "accepted_answer_id": 36878468, "answer_count": 1, "score": 0, "last_activity_date": 1461719804, "creation_date": 1461714750, "last_edit_date": 1531161705, "question_id": 36877829, "link": "https://stackoverflow.com/questions/36877829/text-list-to-excel-spreadsheet", "title": "Text list to excel spreadsheet", "body": "<p>I'm trying to figure out a way to convert a text list formatted in the way below to an excel spreadsheet with single headers for each key. Would I have to make code that combines columns based on header names? I've searched google and can't find anything. Any help would be much appreciated. </p>\n\n<p><em>text list</em></p>\n\n<pre><code>Item No: Baklawa 001\nDescription: Jasmine Mixed Baklawa Tray\nBarcode: 777640001048\nSize: 1x320 g\n\nItem No: Baklawa 002\nDescription: Jasmine Mixed Baklawa Tray\nBarcode: 777640001031\nSize: 1x725 g\n\nItem No: Baklawa021\nDescription: Jasmine Baklawa Roll\nBarcode:\nSize: 40 pcs\n\nItem No: Baklawa041\nDescription: Jasmine Baklawa Almond (Square)\nBarcode:\nSize: 40 pcs\n</code></pre>\n\n<p><em>end text list</em></p>\n"}, {"tags": ["excel", "encoding", "vba"], "comments": [{"owner": {"reputation": 9743, "user_id": 2127508, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24b1d5bcb39ec4baad76d20c66506318?s=128&d=identicon&r=PG", "display_name": "barrowc", "link": "https://stackoverflow.com/users/2127508/barrowc"}, "edited": false, "score": 3, "creation_date": 1461724213, "post_id": 36877494, "comment_id": 61324408, "body": "It&#39;s an encoding problem - <a href=\"http://stackoverflow.com/a/2477480/2127508\">this answer</a> explains what the issue is"}, {"owner": {"reputation": 4162, "user_id": 362712, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yWcUr.jpg?s=128&g=1", "display_name": "Nigel Heffernan", "link": "https://stackoverflow.com/users/362712/nigel-heffernan"}, "reply_to_user": {"reputation": 9743, "user_id": 2127508, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24b1d5bcb39ec4baad76d20c66506318?s=128&d=identicon&r=PG", "display_name": "barrowc", "link": "https://stackoverflow.com/users/2127508/barrowc"}, "edited": false, "score": 2, "creation_date": 1461751417, "post_id": 36877494, "comment_id": 61337559, "body": "@barrowc has directed you to the explanation you need. Nothing you can code up will work reliably unless you read that answer, <b>and</b> the link at the end of it, to Joel Spolsky&#39;s famous blog post  <a href=\"http://www.joelonsoftware.com/articles/Unicode.html\" rel=\"nofollow noreferrer\">The Absolute Minimum Every Software Developer Absolutely, Positively Must Know About Unicode and Character Sets</a>"}], "owner": {"reputation": 731, "user_id": 1505019, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/7b88fdc5f054ea6f18af95365a85826b?s=128&d=identicon&r=PG", "display_name": "bmende", "link": "https://stackoverflow.com/users/1505019/bmende"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 907, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1461765647, "creation_date": 1461712810, "last_edit_date": 1531164843, "question_id": 36877494, "link": "https://stackoverflow.com/questions/36877494/string-stores-%c3%a2%e2%82%ac-instead-of-when-reading-a-file", "title": "String stores &quot; &#226;\u20ac\u2122 &quot; instead of &quot; &#39; &quot; when reading a file", "body": "<p>When I assign my <code>str</code> variable to a text file like so...</p>\n\n<pre><code>Open fl.Path For Input As #1\n        Do Until EOF(1)\n            Line Input #1, temp\n            str = str &amp; temp\n        Loop\nClose #1\n</code></pre>\n\n<p>I noticed that when I look into my string with the <code>mid</code> function, the apostrophe character seems to turn into <code>\u00e2\u20ac\u2122</code>.</p>\n\n<p>This is particularly problem for me because the above is three characters long, instead of only 1 character. This offsets the rest of my string manipulations so that basically everything is wrong.</p>\n\n<p>I'm not really familiar with the different kinds of encoding and how it relates to VBA Excel, but maybe there is an easy way to fix this?</p>\n\n<p>I could try to create some defensive coding to counter this, but I'm wondering if there is a more \"legit\" way.</p>\n"}, {"tags": ["vba", "excel", "ide", "excel-2010"], "comments": [{"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1461713842, "post_id": 36877370, "comment_id": 61321693, "body": "Set password  project properties"}, {"owner": {"reputation": 5840, "user_id": 633426, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/7f8a472ee625830cccd5290d70907e54?s=128&d=identicon&r=PG", "display_name": "Concerned_Citizen", "link": "https://stackoverflow.com/users/633426/concerned-citizen"}, "reply_to_user": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1461717401, "post_id": 36877370, "comment_id": 61322650, "body": "Why voting to close this thread?"}, {"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1461720142, "post_id": 36877370, "comment_id": 61323352, "body": "who is voting to close"}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 1, "creation_date": 1461750719, "post_id": 36877370, "comment_id": 61337016, "body": "As @Wen21 - locking it will stop them changing it (save as xlsb; is easy to crack the password on xlsm - check other posts on this site).  If you want people to see your code copy it to a Word or Notepad++ document.  Nothing like ideal and requires updating in two places, but does what you asked. :)"}, {"owner": {"reputation": 6672, "user_id": 2446254, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/4SJnD.png?s=128&g=1", "display_name": "Cody \uff27", "link": "https://stackoverflow.com/users/2446254/cody-%ef%bc%a7"}, "edited": false, "score": 0, "creation_date": 1461762281, "post_id": 36877370, "comment_id": 61345676, "body": "I do this exact thing by setting the referenced addin as read-only. When it is opened, you can see the code, but upon trying to &quot;save&quot; changes you&#39;ll get a message asking you to save it somewhere else."}], "answers": [{"tags": [], "owner": {"reputation": 8811, "user_id": 5757159, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/yxD51.png?s=128&g=1", "display_name": "ThunderFrame", "link": "https://stackoverflow.com/users/5757159/thunderframe"}, "is_accepted": false, "score": 1, "last_activity_date": 1461712607, "creation_date": 1461712607, "answer_id": 36877468, "question_id": 36877370, "link": "https://stackoverflow.com/questions/36877370/lock-or-freeze-vba-code-to-prevent-editing/36877468#36877468", "title": "Lock or Freeze VBA Code to Prevent Editing", "body": "<p>If you want the code to be visible and executable, then you can't stop people from making changes to it.\nYou can however, stop them from <em>saving those changes</em>, by opening the workbook as <em>read-only</em>.\nYou can mark a workbook as read-only in the File Properties from within File Explorer. Or, if your workbook is opened via Automation, then you can specify read-only in the open method.</p>\n"}, {"tags": [], "owner": {"reputation": 103, "user_id": 5235105, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/54uMR.jpg?s=128&g=1", "display_name": "Wen21", "link": "https://stackoverflow.com/users/5235105/wen21"}, "is_accepted": false, "score": 2, "last_activity_date": 1461731343, "creation_date": 1461731343, "answer_id": 36880329, "question_id": 36877370, "link": "https://stackoverflow.com/questions/36877370/lock-or-freeze-vba-code-to-prevent-editing/36880329#36880329", "title": "Lock or Freeze VBA Code to Prevent Editing", "body": "<p>Just go to Visual Basic, right click your module, select VBA Project Properties..., under protection tab, you can lock your VBA code with password. </p>\n\n<p>Hope this help. ^^</p>\n"}], "owner": {"reputation": 5840, "user_id": 633426, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/7f8a472ee625830cccd5290d70907e54?s=128&d=identicon&r=PG", "display_name": "Concerned_Citizen", "link": "https://stackoverflow.com/users/633426/concerned-citizen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1363, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1461731343, "creation_date": 1461711975, "last_edit_date": 1461720210, "question_id": 36877370, "link": "https://stackoverflow.com/questions/36877370/lock-or-freeze-vba-code-to-prevent-editing", "title": "Lock or Freeze VBA Code to Prevent Editing", "body": "<p>Is there any way I can lock or freeze the <strong><code>VBE</code></strong> editor to prevent others from accidentally editing the VBA code? </p>\n\n<p>I don't want to lock down the whole workbook where people can run macros but can't see the code. </p>\n\n<p>I want to let others see the code but don't want them accidentally deleting something and break the program (something even I am prone to doing to my code). </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1461711301, "post_id": 36877156, "comment_id": 61320946, "body": "hmm. So if range is <code>A10:B20</code>, you want <code>A10:A20</code>?"}, {"owner": {"reputation": 8830, "user_id": 5336948, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/YqCFK.jpg?s=128&g=1", "display_name": "Forward Ed", "link": "https://stackoverflow.com/users/5336948/forward-ed"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1461711689, "post_id": 36877156, "comment_id": 61321051, "body": "correct!  or if the user selected B34:D50, I want to pass in the call either through another variable, a function, or syntax B34:B50.  I just got rid of using the A column since it is column 1 in absolute reference as well as relative."}], "answers": [{"comments": [{"owner": {"reputation": 8830, "user_id": 5336948, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/YqCFK.jpg?s=128&g=1", "display_name": "Forward Ed", "link": "https://stackoverflow.com/users/5336948/forward-ed"}, "edited": false, "score": 0, "creation_date": 1461712544, "post_id": 36877386, "comment_id": 61321321, "body": "is there a way without using selection?  Right now I am testing the code by calling it from a sub and passing it a hard coded range.  There for with my test sub there is no selection made.  I do like this method when an actual selection is available.  And I do agree this is exactly what I stated in the title of the question!"}, {"owner": {"reputation": 8830, "user_id": 5336948, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/YqCFK.jpg?s=128&g=1", "display_name": "Forward Ed", "link": "https://stackoverflow.com/users/5336948/forward-ed"}, "edited": false, "score": 0, "creation_date": 1461712924, "post_id": 36877386, "comment_id": 61321424, "body": "would <code>intersect(userrange(1).entirecolumn,userrange)</code> if I was passing B34:D40 as userrange?  Would the intersect result in B34:B40?"}, {"owner": {"reputation": 8830, "user_id": 5336948, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/YqCFK.jpg?s=128&g=1", "display_name": "Forward Ed", "link": "https://stackoverflow.com/users/5336948/forward-ed"}, "edited": false, "score": 0, "creation_date": 1461713202, "post_id": 36877386, "comment_id": 61321498, "body": "Good point about the block style range...but since that is my case THIS TIME, I will be selfish and accept this as the answer. 8)  What happens if you just used <code>userrange(1).entirecolumn</code>  would it return the entire column of just the urserrange or will it take the entire column of the worksheet?"}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "reply_to_user": {"reputation": 8830, "user_id": 5336948, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/YqCFK.jpg?s=128&g=1", "display_name": "Forward Ed", "link": "https://stackoverflow.com/users/5336948/forward-ed"}, "edited": false, "score": 0, "creation_date": 1461713333, "post_id": 36877386, "comment_id": 61321539, "body": "@ForwardEd  It would return the entire column, but..................see my little edit."}, {"owner": {"reputation": 8830, "user_id": 5336948, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/YqCFK.jpg?s=128&g=1", "display_name": "Forward Ed", "link": "https://stackoverflow.com/users/5336948/forward-ed"}, "edited": false, "score": 0, "creation_date": 1461713589, "post_id": 36877386, "comment_id": 61321618, "body": "hrrmmm so if I have to pass the range, would I use <code>userrange.Columns(1).address</code> or <code>userrange.columns(1)</code> in the function call?"}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "reply_to_user": {"reputation": 8830, "user_id": 5336948, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/YqCFK.jpg?s=128&g=1", "display_name": "Forward Ed", "link": "https://stackoverflow.com/users/5336948/forward-ed"}, "edited": false, "score": 1, "creation_date": 1461713820, "post_id": 36877386, "comment_id": 61321683, "body": "@ForwardEd  Since you want to do stuff with the individual cells in that first column, I personally would pass <code>userrange.Columns(1).Cells</code> ............this will insure that Excel treats it as a Range Object rather than a Columns Object."}, {"owner": {"reputation": 8830, "user_id": 5336948, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/YqCFK.jpg?s=128&g=1", "display_name": "Forward Ed", "link": "https://stackoverflow.com/users/5336948/forward-ed"}, "edited": false, "score": 0, "creation_date": 1461713973, "post_id": 36877386, "comment_id": 61321730, "body": "<code>.cells</code> is definitely the key.  I tried address.  that blew up on me and gave an error on type mismatch.  I tried just <code>.column(1)</code>, and that did not give an error, but it also did not give the right results!  Thanks for the help on this one Gary."}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": true, "score": 1, "last_activity_date": 1461713253, "last_edit_date": 1461713253, "creation_date": 1461712074, "answer_id": 36877386, "question_id": 36877156, "link": "https://stackoverflow.com/questions/36877156/how-to-pass-a-column-of-a-selected-range/36877386#36877386", "title": "How to pass a column of a selected range", "body": "<p>One way:</p>\n\n<pre><code>Sub dural()\n    Dim FirstColumn As Range\n\n    Set FirstColumn = Intersect(Selection(1).EntireColumn, Selection)\n    MsgBox FirstColumn.Address\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/FAXco.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/FAXco.png\" alt=\"enter image description here\"></a></p>\n\n<p>Also:</p>\n\n<pre><code>Sub dural()\n    MsgBox Selection.Columns(1).Address\nEnd Sub\n</code></pre>\n\n<p>seems to do the trick.</p>\n"}], "owner": {"reputation": 8830, "user_id": 5336948, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/YqCFK.jpg?s=128&g=1", "display_name": "Forward Ed", "link": "https://stackoverflow.com/users/5336948/forward-ed"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 410, "favorite_count": 0, "accepted_answer_id": 36877386, "answer_count": 1, "score": 0, "last_activity_date": 1461713253, "creation_date": 1461710807, "last_edit_date": 1531164843, "question_id": 36877156, "link": "https://stackoverflow.com/questions/36877156/how-to-pass-a-column-of-a-selected-range", "title": "How to pass a column of a selected range", "body": "<p>I did a little research and I found <a href=\"https://stackoverflow.com/questions/22036496/pass-a-column-of-2d-array\">my question</a>.  The problem is it is written for some language called C that I am not familiar with.  Not that I am all that familiar with VBA either but that is what I am working in and doing a very nice job of screwing things up.  So in an effort to thwart my abilities to screw things up and instead make things work, how do I pass a sub range or column from a user selected column?</p>\n\n<p>so in my example code I was trying to pass the entire first column of whatever was selected.  Lets say user range was B34:D40, I want to pass B34:B40 such that arrange is B34:B40.</p>\n\n<pre><code>Sub initialsub (userrange as range)\n\nCall secondfunction (userrange([],1)\n\nend sub\n----------------------------------------------------------------\nfunction secondfunction (arrange as range) as long\n\nsome function that counts a variety of things in a single column\n\nsecondfunction = 45\n\nend function\n</code></pre>\n"}, {"tags": ["sql", "vba", "ms-access", "combobox", "isnull"], "comments": [{"owner": {"reputation": 4930, "user_id": 5276188, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/N2sAW.jpg?s=128&g=1", "display_name": "Doktor OSwaldo", "link": "https://stackoverflow.com/users/5276188/doktor-oswaldo"}, "edited": false, "score": 0, "creation_date": 1461745853, "post_id": 36876578, "comment_id": 61333643, "body": "Is EmailID a Integer ? Integers can&#39;t be null in vba, you will Need to find another way for handling that, for example Setting it to -1"}, {"owner": {"reputation": 1, "user_id": 6258543, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d83da9711ab56651ac865d0e66fa8bb0?s=128&d=identicon&r=PG&f=1", "display_name": "AliG", "link": "https://stackoverflow.com/users/6258543/alig"}, "reply_to_user": {"reputation": 4930, "user_id": 5276188, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/N2sAW.jpg?s=128&g=1", "display_name": "Doktor OSwaldo", "link": "https://stackoverflow.com/users/5276188/doktor-oswaldo"}, "edited": false, "score": 0, "creation_date": 1461904442, "post_id": 36876578, "comment_id": 61419407, "body": "EmailID is an integer--I didn&#39;t realize they couldn&#39;t be null.  I tried setting it to -1 but still couldn&#39;t get the code to run without the error"}, {"owner": {"reputation": 4930, "user_id": 5276188, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/N2sAW.jpg?s=128&g=1", "display_name": "Doktor OSwaldo", "link": "https://stackoverflow.com/users/5276188/doktor-oswaldo"}, "edited": false, "score": 0, "creation_date": 1461911674, "post_id": 36876578, "comment_id": 61422193, "body": "only variants can be null in vba, for numeric datatypes there is a Default constructor with a value (integer is 0). So also your IsNull(EmailID) is useless too"}, {"owner": {"reputation": 1, "user_id": 6258543, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d83da9711ab56651ac865d0e66fa8bb0?s=128&d=identicon&r=PG&f=1", "display_name": "AliG", "link": "https://stackoverflow.com/users/6258543/alig"}, "reply_to_user": {"reputation": 4930, "user_id": 5276188, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/N2sAW.jpg?s=128&g=1", "display_name": "Doktor OSwaldo", "link": "https://stackoverflow.com/users/5276188/doktor-oswaldo"}, "edited": false, "score": 0, "creation_date": 1462229243, "post_id": 36876578, "comment_id": 61539720, "body": "I tried setting its value to 0, and changing that other line to If (EmailID = 0) Then instead of using IsNull, but still no luck.  The same error pops up."}, {"owner": {"reputation": 4930, "user_id": 5276188, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/N2sAW.jpg?s=128&g=1", "display_name": "Doktor OSwaldo", "link": "https://stackoverflow.com/users/5276188/doktor-oswaldo"}, "edited": false, "score": 0, "creation_date": 1462257708, "post_id": 36876578, "comment_id": 61548081, "body": "post your variable definitions or better your full code block. I don&#39;t think we will be able to solve it with only this code ;)"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 6258543, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d83da9711ab56651ac865d0e66fa8bb0?s=128&d=identicon&r=PG&f=1", "display_name": "AliG", "link": "https://stackoverflow.com/users/6258543/alig"}, "edited": false, "score": 0, "creation_date": 1461909216, "post_id": 36877514, "comment_id": 61420958, "body": "I tried building a new form based on this design method, but ran into problems with that as well. If I try to select an option in the drop down, or try to type in the combobox within the subform first, I get the error &quot;You can&#39;t assign a value to this object. *The object may be a control on a read-only form. *The object may be on a form that is open in Design view. *The value may be too large for this field.&quot;  I know for sure that it isn&#39;t open in design view..."}], "tags": [], "owner": {"reputation": 967, "user_id": 5592955, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/aAlPK.jpg?s=128&g=1", "display_name": "JJ32", "link": "https://stackoverflow.com/users/5592955/jj32"}, "is_accepted": false, "score": 0, "last_activity_date": 1461712943, "creation_date": 1461712943, "answer_id": 36877514, "question_id": 36876578, "link": "https://stackoverflow.com/questions/36876578/how-to-allow-a-combobox-to-be-left-blank-skipped-on-a-form/36877514#36877514", "title": "How to allow a combobox to be left blank//skipped on a form", "body": "<p>If the recordsource for your form contains a query with one-to-many relationships this error may come up.  Try to use only the base table as the recordsource for the form.  Use subforms if you need to display related data.  The rest of the code may then be unnecessary.</p>\n"}], "owner": {"reputation": 1, "user_id": 6258543, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d83da9711ab56651ac865d0e66fa8bb0?s=128&d=identicon&r=PG&f=1", "display_name": "AliG", "link": "https://stackoverflow.com/users/6258543/alig"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 723, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1463691831, "creation_date": 1461708095, "last_edit_date": 1463691831, "question_id": 36876578, "link": "https://stackoverflow.com/questions/36876578/how-to-allow-a-combobox-to-be-left-blank-skipped-on-a-form", "title": "How to allow a combobox to be left blank//skipped on a form", "body": "<p>I am relatively new to Access and any SQL and VBA I have picked up is self-taught, so I would really appreciate answers that are not too heavily laden with technical terms...that said, I am having an issue with allowing comboboxes to be left blank on a form if the user chooses not to input data.  Also, I am using Access 2016.</p>\n\n<p>Initially the problem I ran into was that if a combobox was entirely skipped and left blank, or if the user selects the combobox and then tries to move on without making a selection from the list, they got the error \"You tried to assign the Null value to a variable that is not a Variant data type,\" and were unable to move on to any other fields on the form or to save the record being entered.</p>\n\n<p>I found this <a href=\"https://msdn.microsoft.com/en-us/library/dd671280(v=office.12).aspx\" rel=\"nofollow\">article</a> that details a possible solution, but I can't seem to get it to work. I made an unbound combobox, set the Row Source to:</p>\n\n<pre><code>SELECT EmailID, PersonalEmail FROM EmailT  UNION SELECT \"&lt;N/A&gt;\",\"&lt;N/A&gt;\" FROM EmailT\nORDER BY PersonalEmail;\n</code></pre>\n\n<p>where PersonalEmail is a field of type short text and the EmailID is an autonumber.  I also followed the article's steps for formatting the combobox (column width, etc.) and set it to Limit to List = Yes.</p>\n\n<p>Here is my exact code:</p>\n\n<pre><code>Private Sub Combo62_AfterUpdate()\nIf Combo62 = \"&lt;N/A&gt;\" Then\n    EmailID = Null\nElse\n    EmailID = Combo62\nEnd If\nEnd Sub\n\nPrivate Sub Form_Current()\nIf IsNull(EmailID) Then\n    Combo62 = \"&lt;N/A&gt;\"\nElse\n    Combo62 = EmailID\nEnd If\nEnd Sub\n</code></pre>\n\n<p>&lt; N/A> now shows up on my list, but if it is selected I get the error: \"The value you entered isn't valid for this field. For example, you may have entered text in a numeric field or a number that is larger than the FieldSize setting permits.\"  </p>\n\n<p>Access's debugger highlights the line:</p>\n\n<pre><code>EmailID = Null\n</code></pre>\n\n<p>but I am not sure what steps I should take now to try and fix this.  </p>\n\n<p>I am completely open to other methods of allowing the combobox to be left blank if someone knows of a better way to do this also.  For all I know, I am missing something really obvious! Thanks in advance for any insight!</p>\n\n<p>EDIT: Thanks for your help guys, I never did figure out what exactly the problem was, but I got some advice from another forum to rethink my database design so this ended up being a null issue--it's all totally different now!</p>\n"}, {"tags": ["vba", "shell", "dll"], "answers": [{"tags": [], "owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "is_accepted": true, "score": 1, "last_activity_date": 1461707722, "creation_date": 1461707722, "answer_id": 36876486, "question_id": 36876305, "link": "https://stackoverflow.com/questions/36876305/vba-to-open-a-file-and-dll-program/36876486#36876486", "title": "VBA to open a file and dll program", "body": "<p>try using the <code>START</code> command in CMD.exe instead - you shouldn't need to specify the program if the file type is already associated in the system's registry.</p>\n\n<pre><code>Shell \"CMD /C START \" &amp; strPath\n</code></pre>\n\n<p>(no need for the <code>Call</code> keyword btw)</p>\n\n<p><em>further note: If the file is not associated, it should still run but prompt you to specify a program to open the file with.</em></p>\n"}], "owner": {"reputation": 63, "user_id": 2509872, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/0d3951d8ad77217cef1295c53ecdfa7c?s=128&d=identicon&r=PG", "display_name": "Greg", "link": "https://stackoverflow.com/users/2509872/greg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 817, "favorite_count": 0, "accepted_answer_id": 36876486, "answer_count": 1, "score": 1, "last_activity_date": 1463194285, "creation_date": 1461706950, "last_edit_date": 1463194285, "question_id": 36876305, "link": "https://stackoverflow.com/questions/36876305/vba-to-open-a-file-and-dll-program", "title": "VBA to open a file and dll program", "body": "<p>I have created a macro that opens a file in a predetermined program (e.g. Acrobat for pdf, Word for docs, Excel for xls). However some programs such as Windows Photo Viewer and the Zip File program are a dll file. How do I amend my code to make it work for non .exe applications?</p>\n\n<pre><code>Sub PhotoChart()\n\nDim strPath As String\nDim strProgram As String\n\n    strPath = \"C:\\Libraries\\Photos\\WeeklyPlanner.png\"\n    strProgram = \"C:\\Program Files (x86)\\Windows PhotoViewer\\PhotoViewer.dll\"\n\n    Call Shell(\"\"\"\" &amp; strProgram &amp; \"\"\" \"\"\" &amp; strPath &amp; \"\"\"\", vbNormalFocus)\n\n\nEnd Sub\n</code></pre>\n\n<p>The Call Shell feature does not work. The computer sends back a Run-Time error '5': Invalid procedure call or argument. </p>\n"}, {"tags": ["regex", "vba", "expression"], "comments": [{"owner": {"reputation": 481661, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1461704852, "post_id": 36875716, "comment_id": 61318273, "body": "Have you written any code for that? Where are you stuck?"}, {"owner": {"reputation": 12341, "user_id": 3678068, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/QWjMd.png?s=128&g=1", "display_name": "Fabricator", "link": "https://stackoverflow.com/users/3678068/fabricator"}, "edited": false, "score": 0, "creation_date": 1461705022, "post_id": 36875716, "comment_id": 61318352, "body": "depend on how strict you want the date validation to be. is <code>31.09.1998</code> a valid one?"}], "answers": [{"comments": [{"owner": {"reputation": 68294, "user_id": 854246, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cpTof.png?s=128&g=1", "display_name": "Joseph Marikle", "link": "https://stackoverflow.com/users/854246/joseph-marikle"}, "edited": false, "score": 1, "creation_date": 1461707276, "post_id": 36875932, "comment_id": 61319412, "body": "shouldn&#39;t that <code>\\d{1,2}\\.\\d{1,2}\\.\\d{1,4}</code> bit just be <code>\\d{2}\\.\\d{2}\\.\\d{4}</code> or does vb not support that?"}, {"owner": {"reputation": 305, "user_id": 3157626, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/206f0b774c909eefad0f8ea78fc2583a?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew", "link": "https://stackoverflow.com/users/3157626/andrew"}, "reply_to_user": {"reputation": 68294, "user_id": 854246, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cpTof.png?s=128&g=1", "display_name": "Joseph Marikle", "link": "https://stackoverflow.com/users/854246/joseph-marikle"}, "edited": false, "score": 0, "creation_date": 1461707585, "post_id": 36875932, "comment_id": 61319551, "body": "I did it because I assumed 1.1.2010 is accepted just as 01.01.2010 would be accepted. But you&#39;re right, that depends on the OP. I guess it&#39;s safe to remove the \\d{1,4} though. Unless they want two digit years or a year prior to the year 1000."}], "tags": [], "owner": {"reputation": 305, "user_id": 3157626, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/206f0b774c909eefad0f8ea78fc2583a?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew", "link": "https://stackoverflow.com/users/3157626/andrew"}, "is_accepted": true, "score": 3, "last_activity_date": 1461707497, "last_edit_date": 1461707497, "creation_date": 1461705390, "answer_id": 36875932, "question_id": 36875716, "link": "https://stackoverflow.com/questions/36875716/how-would-a-properly-format-a-regular-expression-for-this/36875932#36875932", "title": "How would a properly format a regular expression for this?", "body": "<p>I would start here. </p>\n\n<pre><code>^\\d{7}\\s.*\\s\\d{1,2}\\.\\d{1,2}\\.\\d{4}$\n</code></pre>\n\n<p>This is what each section corresponds to.</p>\n\n<pre><code>(beginning) = ^\n[Seven digit #] = \\d{7}\n[space] = \\s\n[Unspecified amount of text] = .*\n[space] = \\s\n[. delimited date] = \\d{1,2}\\.\\d{1,2}\\.\\d{4}\n(end) = $\n</code></pre>\n\n<p>But the <code>.*</code> in the middle might allow more than you are ok with. \nAlso the <code>\\d{1,2}\\.\\d{1,2}\\.\\d{1,4}$</code> won't actually filter dates, just decimals. So it will allow a string like \"99.99.9999\"</p>\n\n<p>You can use this tool to hone it down if you need something more specific:\n<a href=\"https://regex101.com/r/dU5lQ3/2\" rel=\"nofollow\">https://regex101.com/r/dU5lQ3/2</a></p>\n"}], "owner": {"reputation": 13, "user_id": 6258495, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/77a5011c377c7097b085bf6c1cbd34ba?s=128&d=identicon&r=PG&f=1", "display_name": "user6258495", "link": "https://stackoverflow.com/users/6258495/user6258495"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 44, "favorite_count": 0, "accepted_answer_id": 36875932, "answer_count": 1, "score": 1, "last_activity_date": 1461707497, "creation_date": 1461704644, "last_edit_date": 1461705159, "question_id": 36875716, "link": "https://stackoverflow.com/questions/36875716/how-would-a-properly-format-a-regular-expression-for-this", "title": "How would a properly format a regular expression for this?", "body": "<p>I am attempting to validate a regex expression for the following procedure:</p>\n\n<p>Example:</p>\n\n<pre><code>1234567 Marko's word document 31.10.1998\n</code></pre>\n\n<p>Pseudo Example:</p>\n\n<pre><code>[Seven digit #] [space] [Unspecified amount of text] [space] [. delimited date]\n</code></pre>\n\n<p>Can someone assist me on constructing one? This is for the VBA flavor of regex.</p>\n"}, {"tags": ["vba", "excel", "email", "outlook"], "answers": [{"comments": [{"owner": {"reputation": 19, "user_id": 6072694, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh6.googleusercontent.com/-qFWqoHm4sAw/AAAAAAAAAAI/AAAAAAAAAmM/UHDIyqdVVZ4/photo.jpg?sz=128", "display_name": "USA", "link": "https://stackoverflow.com/users/6072694/usa"}, "edited": false, "score": 0, "creation_date": 1461783979, "post_id": 36876063, "comment_id": 61361601, "body": "Hello Mrbungle, I have tried this but still the mail is available under the sent item with one exception. Thanks!"}], "tags": [], "owner": {"reputation": 1831, "user_id": 2967019, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/rnBqX.jpg?s=128&g=1", "display_name": "mrbungle", "link": "https://stackoverflow.com/users/2967019/mrbungle"}, "is_accepted": false, "score": 3, "last_activity_date": 1461705919, "creation_date": 1461705919, "answer_id": 36876063, "question_id": 36875375, "link": "https://stackoverflow.com/questions/36875375/how-to-delete-the-mail-from-the-senders-sent-item-from-outlook/36876063#36876063", "title": "How to delete the mail from the senders sent item from Outlook", "body": "<pre><code>newmsg.Send 'send message\nnewmsg.DeleteAfterSubmit = True\n</code></pre>\n\n<p>switch these around</p>\n\n<pre><code>newmsg.DeleteAfterSubmit = True\nnewmsg.Send 'send message\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 19, "user_id": 6072694, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh6.googleusercontent.com/-qFWqoHm4sAw/AAAAAAAAAAI/AAAAAAAAAmM/UHDIyqdVVZ4/photo.jpg?sz=128", "display_name": "USA", "link": "https://stackoverflow.com/users/6072694/usa"}, "edited": false, "score": 0, "creation_date": 1461783924, "post_id": 36876210, "comment_id": 61361571, "body": "Hi Dmitry, I want the mail should be send who violates the AuditLog tab, but don&#39;t want him to know that there was a mail trigger to his supervisor as the traces will be available under Sent Items."}, {"owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "reply_to_user": {"reputation": 19, "user_id": 6072694, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh6.googleusercontent.com/-qFWqoHm4sAw/AAAAAAAAAAI/AAAAAAAAAmM/UHDIyqdVVZ4/photo.jpg?sz=128", "display_name": "USA", "link": "https://stackoverflow.com/users/6072694/usa"}, "edited": false, "score": 0, "creation_date": 1461788307, "post_id": 36876210, "comment_id": 61364297, "body": "Do not call Display, set the DeleteAfterSubmit property to true, call Send."}, {"owner": {"reputation": 19, "user_id": 6072694, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh6.googleusercontent.com/-qFWqoHm4sAw/AAAAAAAAAAI/AAAAAAAAAmM/UHDIyqdVVZ4/photo.jpg?sz=128", "display_name": "USA", "link": "https://stackoverflow.com/users/6072694/usa"}, "edited": false, "score": 0, "creation_date": 1471378393, "post_id": 36876210, "comment_id": 65320103, "body": "I have change the code as suggested and you are right."}], "tags": [], "owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "is_accepted": false, "score": 1, "last_activity_date": 1461706550, "creation_date": 1461706550, "answer_id": 36876210, "question_id": 36875375, "link": "https://stackoverflow.com/questions/36875375/how-to-delete-the-mail-from-the-senders-sent-item-from-outlook/36876210#36876210", "title": "How to delete the mail from the senders sent item from Outlook", "body": "<p>In addition to what @mrbungle wrote, as a rule of thumb, once you call Send, the only allowed operation is dereferencing the message  - it now belongs to the spooler. </p>\n\n<p>There is also no reason to call Display (modelessly) and then Send while the message is still being displayed. If you are displaying the message, would you not want the user to click the Send button?</p>\n"}], "owner": {"reputation": 19, "user_id": 6072694, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh6.googleusercontent.com/-qFWqoHm4sAw/AAAAAAAAAAI/AAAAAAAAAmM/UHDIyqdVVZ4/photo.jpg?sz=128", "display_name": "USA", "link": "https://stackoverflow.com/users/6072694/usa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 766, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1461706550, "creation_date": 1461703516, "last_edit_date": 1531164843, "question_id": 36875375, "link": "https://stackoverflow.com/questions/36875375/how-to-delete-the-mail-from-the-senders-sent-item-from-outlook", "title": "How to delete the mail from the senders sent item from Outlook", "body": "<p>I am getting run time error for the below Excel to VBA code to delete the senders mail</p>\n\n<pre><code>        Sub Worksheet_Change(ByVal Target As Range)\n        Dim PriorVal As String\n' For the worksheet AuditLog        \n        With Sheets(\"AuditLog\")\n        If Selection(1).Value = \"\" Then\n                PriorVal = \"Blank\"\n            Else\n                PriorVal = Selection(1).Value\n            End If\n        Set OutlookApp = CreateObject(\"Outlook.Application\")\n        Set OlObjects = OutlookApp.GetNamespace(\"MAPI\")\n        Set newmsg = OutlookApp.CreateItem(olMailItem)\n        'add recipients\n        newmsg.Recipients.Add (\"add your mail id\")\n        'add subject\n        newmsg.Subject = (\"AuditLog has a violator\") '\",\" Environ(\"UserName\"), Environ(\"ComputerName\"), &amp; sh.Name \"\n        'add body\n        newmsg.Body = Application.UserName &amp; \" has made changes to the AuditLog _ tab at cell position \" &amp; Target(1).Address &amp; \", \" &amp; Target(1).Value\n        newmsg.Display 'display\n        newmsg.Send 'send message\n        newmsg.DeleteAfterSubmit = True\n        End With\n            Set newmsg = Nothing:     Set OutlookApp = Nothing:\n        End Sub\n</code></pre>\n"}, {"tags": ["sql-server", "ms-access", "vba"], "answers": [{"tags": [], "owner": {"reputation": 313, "user_id": 5325661, "user_type": "registered", "accept_rate": 57, "profile_image": "https://graph.facebook.com/10153087421279212/picture?type=large", "display_name": "Jeff Cox", "link": "https://stackoverflow.com/users/5325661/jeff-cox"}, "is_accepted": false, "score": 0, "last_activity_date": 1461705870, "creation_date": 1461705870, "answer_id": 36876048, "question_id": 36874981, "link": "https://stackoverflow.com/questions/36874981/sql-server-query-with-variables-as-ms-access-subform-record-source/36876048#36876048", "title": "SQL Server Query with variables as MS Access subform record source", "body": "<p>I believe I have figured out my initial problem of passing the textbox to the WHERE clause by creating a stored procedure. I will repost if I can't get the stored procedure to work, but it seems easy enough.</p>\n"}, {"tags": [], "owner": {"reputation": 1926, "user_id": 992660, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/8c0282d3af4d0d388ba24e32e71ca66b?s=128&d=identicon&r=PG", "display_name": "John Bingham", "link": "https://stackoverflow.com/users/992660/john-bingham"}, "is_accepted": false, "score": 0, "last_activity_date": 1461707780, "creation_date": 1461707780, "answer_id": 36876510, "question_id": 36874981, "link": "https://stackoverflow.com/questions/36874981/sql-server-query-with-variables-as-ms-access-subform-record-source/36876510#36876510", "title": "SQL Server Query with variables as MS Access subform record source", "body": "<p>Use a [permanent] temporary table, which you then remove when the form unloads. If multiple users will use the form simultaneously, you'll need to add a session number of some sort to the name. So:</p>\n\n<pre><code>SELECT COUNT(*) AS TotalNumEstimates, SUM(NumPanels) AS TotalNumPanels, SUM(PriceBase) AS TotalBasePrice, SUM(PriceBase) / SUM(NumPanels) AS ValuePricePerPanel \nINTO   dbo.TempSubFormTable    \nFROM   dbo.tblBid \nWHERE  Date &gt; '2016-01-01'\nHAVING SUM(NumPanels) &gt; 0\n</code></pre>\n\n<p>Remove the recordsource from your subform, and give it a public interface:</p>\n\n<pre><code>Public Sub SetRecordSource(tbl as string)\n    Me.RecordSource = \"SELECT * FROM tbl\" 'ORDER BY ...\nEnd Sub\n</code></pre>\n\n<p>Then, before the temporary table is created, make your subform invisible. After creating the temporary table, </p>\n\n<pre><code>Me.subformName.Visible = True\nMe.subformName.SetRecordSource temporary_table_name 'without the dbo. part of the name\n</code></pre>\n"}], "owner": {"reputation": 313, "user_id": 5325661, "user_type": "registered", "accept_rate": 57, "profile_image": "https://graph.facebook.com/10153087421279212/picture?type=large", "display_name": "Jeff Cox", "link": "https://stackoverflow.com/users/5325661/jeff-cox"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 225, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1594642208, "creation_date": 1461702036, "last_edit_date": 1594642208, "question_id": 36874981, "link": "https://stackoverflow.com/questions/36874981/sql-server-query-with-variables-as-ms-access-subform-record-source", "title": "SQL Server Query with variables as MS Access subform record source", "body": "<p>I'm trying to figure out the best way to go about building a dynamic query and use it as a record source for a MS Access subform. I've got my WHERE clause statically assigned at the moment just so I could get the form built and make sure data was pulling properly. The main form will have 2 text boxes formatted as ShortDate and 2 subforms below with the query results. The first subform is the query grouped by Employee name and the second subform is a sum of department totals.</p>\n\n<p>FWIW this is an Access 2010 ADP/ADE front end, SQL Server 2008 back end. My current SQL for the Dept totals is as follows:</p>\n\n<pre><code>SELECT        COUNT(*) AS TotalNumEstimates, SUM(NumPanels) AS TotalNumPanels, SUM(PriceBase) AS TotalBasePrice, SUM(PriceBase) / SUM(NumPanels) AS ValuePricePerPanel \nFROM            dbo.tblBid \nWHERE        (Date &gt; CONVERT(DATETIME, '2016-01-01 00:00:00', 102)) \nHAVING        (SUM(NumPanels) &gt; 0)\n</code></pre>\n\n<p>I plan on changing the WHERE clause to \"WHERE Date BETWEEN @FromDate and @ToDate\". Then on the Access form when the dates are set and a \"Run Report\" button is clicked, programatically set the OnClick event to pass the txtFromDate and txtToDate to the @FromDate and @ToDate respectively, but I can't quite figure that part out. </p>\n\n<p>The only other option I can see would be to type out the whole SQL statement as a string with the txtFromDate and txtToDate declared in the OnClick event and change the subform record source to the new string. Is there a better way to go about doing this?</p>\n"}, {"tags": ["ms-access", "vba", "ms-access-2013"], "answers": [{"tags": [], "owner": {"reputation": 1684, "user_id": 5936117, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/KO8Gd.jpg?s=128&g=1", "display_name": "MoondogsMaDawg", "link": "https://stackoverflow.com/users/5936117/moondogsmadawg"}, "is_accepted": true, "score": 1, "last_activity_date": 1461701882, "creation_date": 1461701882, "answer_id": 36874943, "question_id": 36874822, "link": "https://stackoverflow.com/questions/36874822/call-subform-macro-from-main-form-in-access-2013/36874943#36874943", "title": "Call subform macro from main form in Access 2013", "body": "<p><code>Forms!MainForm!SubForm.Form.Subform_Macro</code> Should do the trick. <a href=\"https://msdn.microsoft.com/en-us/library/office/ff195393.aspx\" rel=\"nofollow\">Link</a></p>\n"}], "owner": {"reputation": 417, "user_id": 4897271, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AMOHJ.jpg?s=128&g=1", "display_name": "jjjjjjjjjjj", "link": "https://stackoverflow.com/users/4897271/jjjjjjjjjjj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 351, "favorite_count": 0, "accepted_answer_id": 36874943, "answer_count": 1, "score": 0, "last_activity_date": 1461701882, "creation_date": 1461701459, "question_id": 36874822, "link": "https://stackoverflow.com/questions/36874822/call-subform-macro-from-main-form-in-access-2013", "title": "Call subform macro from main form in Access 2013", "body": "<p>I have a macro on the SubForm I'd like to call from the MainForm. I found <a href=\"http://access.mvps.org/access/forms/frm0031.htm\" rel=\"nofollow\">this reference</a> but I can't get it working. I've tried</p>\n\n<pre><code>Call Form(\"MainForm\").Subform_Macro\n</code></pre>\n\n<p>and</p>\n\n<pre><code>Call Form!MainForm!Subform_Macro\n</code></pre>\n\n<p>Any ideas?</p>\n"}, {"tags": ["vba", "gmail", "google-apps", "outlook-2013"], "comments": [{"owner": {"reputation": 3145, "user_id": 4560433, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/412786b272a5c096e45967bc79cde0a9?s=128&d=identicon&r=PG&f=1", "display_name": "OpiesDad", "link": "https://stackoverflow.com/users/4560433/opiesdad"}, "edited": false, "score": 0, "creation_date": 1461701454, "post_id": 36874477, "comment_id": 61316264, "body": "Are there any error messages?  What happens when an item is put into the deleted items folder?  Does the code run?"}, {"owner": {"reputation": 3145, "user_id": 4560433, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/412786b272a5c096e45967bc79cde0a9?s=128&d=identicon&r=PG&f=1", "display_name": "OpiesDad", "link": "https://stackoverflow.com/users/4560433/opiesdad"}, "edited": false, "score": 0, "creation_date": 1461701739, "post_id": 36874477, "comment_id": 61316439, "body": "I tested this code in Outlook 2013 and it was working for me."}, {"owner": {"reputation": 3145, "user_id": 4560433, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/412786b272a5c096e45967bc79cde0a9?s=128&d=identicon&r=PG&f=1", "display_name": "OpiesDad", "link": "https://stackoverflow.com/users/4560433/opiesdad"}, "edited": false, "score": 0, "creation_date": 1461701789, "post_id": 36874477, "comment_id": 61316471, "body": "Are you remembering to turn on macros when  you open Outlook?"}, {"owner": {"reputation": 25, "user_id": 2623367, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3cce9bb5571e449d70298498df419f3?s=128&d=identicon&r=PG", "display_name": "Ben S.", "link": "https://stackoverflow.com/users/2623367/ben-s"}, "reply_to_user": {"reputation": 3145, "user_id": 4560433, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/412786b272a5c096e45967bc79cde0a9?s=128&d=identicon&r=PG&f=1", "display_name": "OpiesDad", "link": "https://stackoverflow.com/users/4560433/opiesdad"}, "edited": false, "score": 0, "creation_date": 1461766165, "post_id": 36874477, "comment_id": 61348848, "body": "@OpiesDad: No error messages, just nothing happens. Maybe some setting somewhere that I&#39;m just not seeing or thinking would be an issue... I am definitely turning on macros when starting Outlook, though."}, {"owner": {"reputation": 3145, "user_id": 4560433, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/412786b272a5c096e45967bc79cde0a9?s=128&d=identicon&r=PG&f=1", "display_name": "OpiesDad", "link": "https://stackoverflow.com/users/4560433/opiesdad"}, "edited": false, "score": 0, "creation_date": 1461770135, "post_id": 36874477, "comment_id": 61352103, "body": "What happens if you manually run Application_Startup?  Does it work then?  If you put a break-point in Deleted_Items_ItemAdd, does it get to the break point?"}, {"owner": {"reputation": 25, "user_id": 2623367, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3cce9bb5571e449d70298498df419f3?s=128&d=identicon&r=PG", "display_name": "Ben S.", "link": "https://stackoverflow.com/users/2623367/ben-s"}, "reply_to_user": {"reputation": 3145, "user_id": 4560433, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/412786b272a5c096e45967bc79cde0a9?s=128&d=identicon&r=PG&f=1", "display_name": "OpiesDad", "link": "https://stackoverflow.com/users/4560433/opiesdad"}, "edited": false, "score": 0, "creation_date": 1461859091, "post_id": 36874477, "comment_id": 61401261, "body": "@OpiesDad, I did, and I also put <code>Debug.Print Item.UnRead</code> before and after the If statement in DeletedItems_ItemAdd and a breakpoint before that first Debug. Sometimes it was marked as read, other times not, but was always returning as unread in the second Debug check. I also sometimes saw in the main application that it would be read initially and then not be. A few times, I had to re-run the Application_Startup sub manually because deleting an item would not trigger the event-handler at all."}, {"owner": {"reputation": 3145, "user_id": 4560433, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/412786b272a5c096e45967bc79cde0a9?s=128&d=identicon&r=PG&f=1", "display_name": "OpiesDad", "link": "https://stackoverflow.com/users/4560433/opiesdad"}, "edited": false, "score": 0, "creation_date": 1461859627, "post_id": 36874477, "comment_id": 61401665, "body": "Were you trying to say that the second debug check always returned as &quot;read,&quot; or do you mean that it is inappropriately returning as &quot;unread&quot;?  If it&#39;s returning as &quot;read,&quot; when the ItemAdd event is triggered, does the item stay read when it gets into the deleted items folder or does it revert back to unread?"}, {"owner": {"reputation": 3145, "user_id": 4560433, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/412786b272a5c096e45967bc79cde0a9?s=128&d=identicon&r=PG&f=1", "display_name": "OpiesDad", "link": "https://stackoverflow.com/users/4560433/opiesdad"}, "edited": false, "score": 0, "creation_date": 1461859655, "post_id": 36874477, "comment_id": 61401684, "body": "If it&#39;s not reverting back, do you have any other code in outlook, or is this the only code you have running?"}, {"owner": {"reputation": 25, "user_id": 2623367, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3cce9bb5571e449d70298498df419f3?s=128&d=identicon&r=PG", "display_name": "Ben S.", "link": "https://stackoverflow.com/users/2623367/ben-s"}, "reply_to_user": {"reputation": 3145, "user_id": 4560433, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/412786b272a5c096e45967bc79cde0a9?s=128&d=identicon&r=PG&f=1", "display_name": "OpiesDad", "link": "https://stackoverflow.com/users/4560433/opiesdad"}, "edited": false, "score": 0, "creation_date": 1461870101, "post_id": 36874477, "comment_id": 61408058, "body": "@OpiesDad, sorry for the lack of clarity. To start with your last question, there is no other code running in Outlook. I can&#39;t tell if the second check is instantaneously correct and the message is revering or if the check is completely in error. To see if the message is reverting to unread, I put a 10 second delay in and ran a third check (see edit above), but that returns the item is read despite it obviously not being so. I added the manually-run CheckStatus sub to see if the debug checks mid-execution of the sub were just buggy, but that still erroneously says the item is read."}], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 2623367, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3cce9bb5571e449d70298498df419f3?s=128&d=identicon&r=PG", "display_name": "Ben S.", "link": "https://stackoverflow.com/users/2623367/ben-s"}, "edited": false, "score": 0, "creation_date": 1461877162, "post_id": 36924729, "comment_id": 61411869, "body": "Your analysis is correct; I am just not doing a good job of explaining myself, and your patience and help are very greatly appreciated. The reason I say the return is incorrect is because while checking Item.UnRead programmatically returns FALSE--the item is read--the UI shows it as unread: Bolded when looking in the trash folder, and added to the unread items counter in the navigation pane. If I open the item or highlight it and manually mark as read, the UI then changes to show the item as read."}, {"owner": {"reputation": 25, "user_id": 2623367, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3cce9bb5571e449d70298498df419f3?s=128&d=identicon&r=PG", "display_name": "Ben S.", "link": "https://stackoverflow.com/users/2623367/ben-s"}, "edited": false, "score": 0, "creation_date": 1461877495, "post_id": 36924729, "comment_id": 61412050, "body": "The reason I wrote &quot;may or may not be correct&quot; is because there is a few tenths of a second when the item moves into the trash that the unread items counter for that folder does not increase, but then it inevitably does. I say &quot;may or may not&quot; because I&#39;m not sure if that means it was moved, marked as read so it didn&#39;t show in the counter, and then reverted to an unread status or if that slight delay is just the result of lag in the counter updating."}], "tags": [], "owner": {"reputation": 3145, "user_id": 4560433, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/412786b272a5c096e45967bc79cde0a9?s=128&d=identicon&r=PG&f=1", "display_name": "OpiesDad", "link": "https://stackoverflow.com/users/4560433/opiesdad"}, "is_accepted": false, "score": 0, "last_activity_date": 1501569233, "last_edit_date": 1501569233, "creation_date": 1461874843, "answer_id": 36924729, "question_id": 36874477, "link": "https://stackoverflow.com/questions/36874477/mark-items-as-read-when-deleted-moved-to-trash/36924729#36924729", "title": "Mark items as read when deleted/moved to trash", "body": "<p>This is too long for a comment, but I am confused by the problem, so I will restate it in my own words to clarify and show the process in steps.</p>\n\n<blockquote>\n  <ol>\n  <li><p>The item gets deleted and may or may not have been read.</p></li>\n  <li><p>The <code>DeletedItems_ItemAdd</code> procedure is automatically called.</p>\n  \n  <ul>\n  <li>It seems like you may be having issues with this being called sometimes, but that this is not your main issue.</li>\n  </ul></li>\n  <li><p><code>Item.UnRead</code> is output.  This seems to be working.</p></li>\n  <li><p>The message is checked to see whether it is unread, using the <code>Item.UnRead</code> property. This will return <code>False</code> if read, and <code>True</code> if not read. <code>Item.UnRead</code> is then set to <code>False</code> if it was <code>True</code>. If it was already <code>False</code>, it remains <code>False</code>. At this point, EVERY message should have the <code>Item.UnRead</code> property equal to <code>False</code> which actually indicates that the item has been read.</p></li>\n  <li><p><code>Item.UnRead</code> is output.</p>\n  \n  <ul>\n  <li>What I am interpreting from your question is that this is always <code>False</code>, which means the item is read. Per step 4, I believe this SHOULD be <code>False</code>.</li>\n  <li>Your note suggests that this \"may or may not be correct,\" but I do not understand when it is not correct.</li>\n  </ul></li>\n  <li><p>There is a pause.</p></li>\n  <li><p><code>Item.UnRead</code> is output.</p>\n  \n  <ul>\n  <li>Your note suggests that this has a value of <code>False</code>, indicating the item has been read. You believe this to be incorrect.  I do not understand why.</li>\n  </ul></li>\n  <li><p>A follow-up check is performed, outside of the normal procedure. I will assume that the code works correctly and that the correct message is checked. Again, you note that <code>Item.UnRead</code> is <code>False</code>, indicating the message has been read and then state that this is incorrect.  Again, I do not understand why this is incorrect.</p></li>\n  </ol>\n</blockquote>\n\n<p>If my analysis is mistaken, please correct so that I can assist.  As is, I cannot understand the problem.  The code seems to be trying to set every message to read by setting the <code>Item.UnRead</code> property to <code>False</code>.  Every check that I can see is returning <code>False</code>.  What behavior is expected?</p>\n"}, {"comments": [{"owner": {"reputation": 25, "user_id": 2623367, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3cce9bb5571e449d70298498df419f3?s=128&d=identicon&r=PG", "display_name": "Ben S.", "link": "https://stackoverflow.com/users/2623367/ben-s"}, "edited": false, "score": 0, "creation_date": 1461938000, "post_id": 36925633, "comment_id": 61439352, "body": "This seems to be doing the trick! Thank you so much. I really appreciate you taking the time and effort to help me out."}], "tags": [], "owner": {"reputation": 3145, "user_id": 4560433, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/412786b272a5c096e45967bc79cde0a9?s=128&d=identicon&r=PG&f=1", "display_name": "OpiesDad", "link": "https://stackoverflow.com/users/4560433/opiesdad"}, "is_accepted": true, "score": 0, "last_activity_date": 1461878348, "creation_date": 1461878348, "answer_id": 36925633, "question_id": 36874477, "link": "https://stackoverflow.com/questions/36874477/mark-items-as-read-when-deleted-moved-to-trash/36925633#36925633", "title": "Mark items as read when deleted/moved to trash", "body": "<p>I haven't been able to figure out the exact issue you are having, as I can't replicate it, but try this:</p>\n\n<pre><code>Option Explicit\n\nDim WithEvents MainFolder As Outlook.Folder\n\n Private Sub Application_Startup()\n     Set MainFolder = Session.GetDefaultFolder(olFolderInbox)\n End Sub\n\n\n Private Sub MainFolder_BeforeItemMove(ByVal Item As Object, ByVal MoveTo As MAPIFolder, Cancel As Boolean)\n\n     If MoveTo.Name = Session.GetDefaultFolder(olFolderDeletedItems).Name And Item.UnRead = True Then\n         Item.UnRead = False\n         Item.Save\n     End If\n End Sub\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 2623367, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3cce9bb5571e449d70298498df419f3?s=128&d=identicon&r=PG", "display_name": "Ben S.", "link": "https://stackoverflow.com/users/2623367/ben-s"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1923, "favorite_count": 0, "accepted_answer_id": 36925633, "answer_count": 2, "score": 1, "last_activity_date": 1611712649, "creation_date": 1461700290, "last_edit_date": 1611712649, "question_id": 36874477, "link": "https://stackoverflow.com/questions/36874477/mark-items-as-read-when-deleted-moved-to-trash", "title": "Mark items as read when deleted/moved to trash", "body": "<p>In Outlook 2010, using the code below, anything I delete or move into the trash folder is automatically marked as read.</p>\n<pre class=\"lang-vb prettyprint-override\"><code>Option Explicit\nDim WithEvents DeletedItems As Outlook.Items\n    \nPrivate Sub Application_Startup()\n    Set DeletedItems = Session.GetDefaultFolder(olFolderDeletedItems).Items\nEnd Sub\n    \nPrivate Sub DeletedItems_ItemAdd(ByVal Item As Object)\n    If Item.UnRead = True Then\n        Item.UnRead = False\n        Item.Save\n    End If\nEnd Sub\n</code></pre>\n<p>It does not work at all in Outlook 2013.</p>\n<p>Here is the code I am using to check how Outlook is seeing the read/unread status of the deleted emails. I lifted the <code>Pause</code> function from <a href=\"https://stackoverflow.com/a/30196332/2623367\">here</a>.</p>\n<pre class=\"lang-vb prettyprint-override\"><code>Private Sub DeletedItems_ItemAdd(ByVal Item As Object)\n    RememberItem Item 'Remember which email this is\n    Debug.Print &quot;At start: &quot; &amp; Item.UnRead 'Should be True\n    If Item.UnRead = True Then\n        Item.UnRead = False\n        Item.Save\n    End If\n    Debug.Print &quot;After mark read: &quot; &amp; Item.UnRead 'Should be False\n    Pause 10 'In separate module. Code from https://stackoverflow.com/a/30196332/2623367\n    Debug.Print &quot;After pause: &quot; &amp; Item.UnRead 'Should be False unless item has become Unread\nEnd Sub\n    \nPrivate Function RememberItem(Optional ByVal Item As Object) As Object\n    'Allows check-up on the deleted item after event-handler is done with it.\n    Static oDeleted As Object\n    If Not Item Is Nothing Then Set oDeleted = Item\n    Set RememberItem = oDeleted\nEnd Function\n    \nPrivate Sub CheckStatus()\n    Dim CheckItem As Object\n    Set CheckItem = RememberItem\n    Debug.Print &quot;Follow-up check: &quot; &amp; CheckItem.UnRead 'Should be False\nEnd Sub\n</code></pre>\n<p>The output I get:</p>\n<ul>\n<li>At start: True (item is unread - this is correct)</li>\n<li>After mark read: False (item is read - this may or may not be correct)</li>\n<li>After pause: False (item is read - this is incorrect)</li>\n<li>Follow-up check: False (item is read - this is incorrect)</li>\n</ul>\n<hr />\n<p><strong>UPDATE:</strong></p>\n<p>The answer marked as working did resolve my issue, though I occasionally still saw some odd behaviors.</p>\n<p>A little more digging around revealed that the root cause was a sync issue between Outlook and the email server. Outlook would delete things, but the syncing would go screwy, and it looks like Outlook was pulling updates from the server before sending its own updates back. The discrepancies seem to have caused Outlook to lose track of what state deleted emails should be in.</p>\n<p>My workplace uses Google Apps as their email provider, and I had set everything up in Outlook with the correct IMAP settings, but Google and Outlook don't play nice. Was able to eliminate all unpredictable behavior by using the selected answer and Google's <a href=\"https://tools.google.com/dlpage/gappssync\" rel=\"nofollow noreferrer\">Outlook syncing tool for Google Apps</a>.</p>\n<p>Also confirmed my original code behaves as it should when used in conjunction with the Google Apps sync tool.</p>\n<p>I should have realized a lot sooner that the issue could be Google and Outlook being buggy together, but it didn't even occur to me, which is why I failed to mention the Google component of this equation earlier.</p>\n"}, {"tags": ["vba", "excel", "worksheet", "listobject"], "answers": [{"comments": [{"owner": {"reputation": 77, "user_id": 9283777, "user_type": "registered", "profile_image": "https://graph.facebook.com/1363078390413019/picture?type=large", "display_name": "RobertW081171", "link": "https://stackoverflow.com/users/9283777/robertw081171"}, "edited": false, "score": 0, "creation_date": 1605620953, "post_id": 36874483, "comment_id": 114701743, "body": "Fantastic from both of you - saved me about 2 hours faffing around trying to find a solution.  Stole both your idea&#39;s added it to a Save to SharePoint piece of code so I can now use the excel sheet in power Automate (Flow)"}, {"owner": {"reputation": 131, "user_id": 5304449, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aa675077a0b9047ac96ac50e01f6ea53?s=128&d=identicon&r=PG&f=1", "display_name": "deepDeepSea", "link": "https://stackoverflow.com/users/5304449/deepdeepsea"}, "reply_to_user": {"reputation": 77, "user_id": 9283777, "user_type": "registered", "profile_image": "https://graph.facebook.com/1363078390413019/picture?type=large", "display_name": "RobertW081171", "link": "https://stackoverflow.com/users/9283777/robertw081171"}, "edited": false, "score": 0, "creation_date": 1610406987, "post_id": 36874483, "comment_id": 116118494, "body": "@RobertW081171 Can you please share how you added code to be able to use excel sheet in Power Automate?"}, {"owner": {"reputation": 892, "user_id": 4001177, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TEikv.jpg?s=128&g=1", "display_name": "Golden Lion", "link": "https://stackoverflow.com/users/4001177/golden-lion"}, "edited": false, "score": 0, "creation_date": 1617831284, "post_id": 36874483, "comment_id": 118420988, "body": "Please add your definition for xlSrcRange and Selection"}], "tags": [], "owner": {"reputation": 7536, "user_id": 979580, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/IZ5iY.jpg?s=128&g=1", "display_name": "Alexander Bell", "link": "https://stackoverflow.com/users/979580/alexander-bell"}, "is_accepted": true, "score": 15, "last_activity_date": 1461701048, "last_edit_date": 1461701048, "creation_date": 1461700312, "answer_id": 36874483, "question_id": 36874319, "link": "https://stackoverflow.com/questions/36874319/create-table-in-excel-worksheet-using-vba/36874483#36874483", "title": "Create Table in Excel Worksheet using VBA", "body": "<p>Use the following Excel VBA code snippet to add the <code>Table</code> object corresponding to selected <code>Range</code>:</p>\n\n<pre><code>Dim objTable As ListObject\nSet objTable = ActiveSheet.ListObjects.Add(xlSrcRange, Selection, , xlYes)\n</code></pre>\n\n<p>You can also apply optional styling to the added <code>Table</code> object like shown below:</p>\n\n<pre><code>objTable.TableStyle = \"TableStyleMedium2\"\n</code></pre>\n\n<p>More details available at MSDN: <a href=\"https://msdn.microsoft.com/en-us/library/office/ff823155.aspx\" rel=\"noreferrer\">https://msdn.microsoft.com/en-us/library/office/ff823155.aspx</a></p>\n\n<p>Hope this will help.</p>\n"}], "owner": {"reputation": 73, "user_id": 6209877, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8b301448b1ef9f59895149980f87c84?s=128&d=identicon&r=PG&f=1", "display_name": "Jgonzales", "link": "https://stackoverflow.com/users/6209877/jgonzales"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 93922, "favorite_count": 4, "accepted_answer_id": 36874483, "answer_count": 1, "score": 7, "last_activity_date": 1461701240, "creation_date": 1461699765, "last_edit_date": 1461701240, "question_id": 36874319, "link": "https://stackoverflow.com/questions/36874319/create-table-in-excel-worksheet-using-vba", "title": "Create Table in Excel Worksheet using VBA", "body": "<p>I have this code below that will auto select a range.\nDoes anyone know how I can add code to create a table to the selected range?</p>\n\n<p>Thanks!</p>\n\n<pre><code>Sub DynamicRange()\n'Best used when first column has value on last row and first row has a value in the last column\n\nDim sht As Worksheet\nDim LastRow As Long\nDim LastColumn As Long\nDim StartCell As Range\n\nSet sht = Worksheets(\"Sheet1\")\nSet StartCell = Range(\"D9\")\n\n'Find Last Row and Column\n  LastRow = sht.Cells(sht.Rows.Count, StartCell.Column).End(xlUp).Row\n  LastColumn = sht.Cells(StartCell.Row, sht.Columns.Count).End(xlToLeft).Column\n\n'Select Range\n  sht.Range(StartCell, sht.Cells(LastRow, LastColumn)).Select\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["sql", "vba", "ms-access"], "comments": [{"owner": {"reputation": 3836, "user_id": 917964, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/c13e70fc5e9cb594fcc7021a6d6c8da6?s=128&d=identicon&r=PG", "display_name": "cableload", "link": "https://stackoverflow.com/users/917964/cableload"}, "edited": false, "score": 0, "creation_date": 1461697687, "post_id": 36873658, "comment_id": 61313977, "body": "you are selecting multiple fields in your query but you are capturing it in only one variable.Also i dont see any parameters in your query. Is there a where clause missing ?"}, {"owner": {"reputation": 138646, "user_id": 1081897, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b46b160c4e606ce0be84dae336ab25f0?s=128&d=identicon&r=PG&f=1", "display_name": "D Stanley", "link": "https://stackoverflow.com/users/1081897/d-stanley"}, "edited": false, "score": 1, "creation_date": 1461698661, "post_id": 36873658, "comment_id": 61314599, "body": "Why are you adding parameters to the <code>QueryDef</code> when you have no parameters in your SQL statement?"}, {"owner": {"reputation": 1, "user_id": 6258059, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/580cfa8bf62cdbd7bb8dc72513744367?s=128&d=identicon&r=PG&f=1", "display_name": "MikeG", "link": "https://stackoverflow.com/users/6258059/mikeg"}, "edited": false, "score": 0, "creation_date": 1461701771, "post_id": 36873658, "comment_id": 61316462, "body": "If I don&#39;t add the parameter statements, I get an error that system was expecting 4 parameters.  These parameters exist on the main form and are referred to by other queries that are chained to this one."}, {"owner": {"reputation": 1, "user_id": 6258059, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/580cfa8bf62cdbd7bb8dc72513744367?s=128&d=identicon&r=PG&f=1", "display_name": "MikeG", "link": "https://stackoverflow.com/users/6258059/mikeg"}, "edited": false, "score": 0, "creation_date": 1461702064, "post_id": 36873658, "comment_id": 61316645, "body": "you are selecting multiple fields in your query but you are capturing it in only one variable.Also i dont see any parameters in your query. Is there a where clause missing ?  I&#39;m not sure what you mean by capturing multiple fields in one variable - which variable?"}, {"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1461941155, "post_id": 36873658, "comment_id": 61441564, "body": "Is <code>tempConsolTB</code> the name of a saved query?"}], "answers": [{"tags": [], "owner": {"reputation": 312, "user_id": 5376832, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/131cf551898d23800289731848abedbc?s=128&d=identicon&r=PG&f=1", "display_name": "Karlomanio", "link": "https://stackoverflow.com/users/5376832/karlomanio"}, "is_accepted": false, "score": 0, "last_activity_date": 1461699986, "creation_date": 1461699986, "answer_id": 36874380, "question_id": 36873658, "link": "https://stackoverflow.com/questions/36873658/select-into-in-vba-results-in-no-records-selected-or-written/36874380#36874380", "title": "SELECT INTO in VBA results in no records selected or written", "body": "<p>Try checking that the objects in your forms are named properly and are actually feeding the values into the query.   You can always use the Watch function in your compiler to see the values there or create a string variable that you initialize its value within the code to see what your actual query and put a watch on it when running the code.</p>\n"}], "owner": {"reputation": 1, "user_id": 6258059, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/580cfa8bf62cdbd7bb8dc72513744367?s=128&d=identicon&r=PG&f=1", "display_name": "MikeG", "link": "https://stackoverflow.com/users/6258059/mikeg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 76, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1593958707, "creation_date": 1461697553, "last_edit_date": 1593958707, "question_id": 36873658, "link": "https://stackoverflow.com/questions/36873658/select-into-in-vba-results-in-no-records-selected-or-written", "title": "SELECT INTO in VBA results in no records selected or written", "body": "<p>When I use this SQL in Access, it works fine.  In VBA, the result is to create a new table with no records.  It must be a dumb mistake on my part but can't find it.  Many thanks for any help or point in right direction.</p>\n\n<p>Mike</p>\n\n<pre><code>strSQL = \"SELECT tempconsoltb.[sub-accountNumber],tempconsoltb.[sub-accountDescription], tempconsoltb.sumOfCMBaseCurr INTO tblTempConsolTB FROM tempConsolTB;\"\nSet qdf = CurrentDb.CreateQueryDef(\"\", strSQL)\nqdf.Parameters(0) = Forms!frmMain.txtPM\nqdf.Parameters(1) = Forms!frmMain.txtPY\nqdf.Parameters(2) = Forms!frmMain.cboBaseFX\nqdf.Parameters(3) = Forms!frmMain.cboConsolCo\nqdf.Execute\n</code></pre>\n"}, {"tags": ["vba", "sharepoint", "checkin"], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 6158683, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a3de33e919a000c91485ab3a0ec0150?s=128&d=identicon&r=PG&f=1", "display_name": "Cerebus the aardvark", "link": "https://stackoverflow.com/users/6158683/cerebus-the-aardvark"}, "is_accepted": false, "score": 0, "last_activity_date": 1461701332, "creation_date": 1461701332, "answer_id": 36874782, "question_id": 36873633, "link": "https://stackoverflow.com/questions/36873633/vba-sharepoint-file-manipulation-check-in-check-out-programmatically/36874782#36874782", "title": "vba -&gt; sharepoint -&gt; file_manipulation | check-in / check-out programmatically", "body": "<p>-create a linked table to check if the file is checked out\n-if it is, use kill to remove the file\n-docmd.outputo yourfile</p>\n"}], "owner": {"reputation": 1, "user_id": 6158683, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a3de33e919a000c91485ab3a0ec0150?s=128&d=identicon&r=PG&f=1", "display_name": "Cerebus the aardvark", "link": "https://stackoverflow.com/users/6158683/cerebus-the-aardvark"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 265, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1461701332, "creation_date": 1461697484, "question_id": 36873633, "link": "https://stackoverflow.com/questions/36873633/vba-sharepoint-file-manipulation-check-in-check-out-programmatically", "title": "vba -&gt; sharepoint -&gt; file_manipulation | check-in / check-out programmatically", "body": "<p>I want to overwrite a file in sharepoint using vba.  I cannot do this when a file is checked-out.  How do I forcibly check-in a file on sharepoint that is checked-out?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 4448, "user_id": 959663, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/kC9Qb.jpg?s=128&g=1", "display_name": "dinotom", "link": "https://stackoverflow.com/users/959663/dinotom"}, "edited": false, "score": 0, "creation_date": 1461696740, "post_id": 36873359, "comment_id": 61313450, "body": "Set Application.ScreenUpdating to false and you won&#39;t have the overhead of accessing the sheet."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1461696911, "post_id": 36873359, "comment_id": 61313551, "body": "<a href=\"http://stackoverflow.com/questions/33744149/code-in-vba-loops-and-never-ends-how-to-fix-this\">HERE</a> are good examples of various methods."}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1461697877, "post_id": 36873359, "comment_id": 61314109, "body": "BTW.. the fastest way is using <code>Autofilter</code> :)"}, {"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1461701638, "post_id": 36873359, "comment_id": 61316378, "body": "@SiddharthRout: have a look at the subs below. Based on these results it seems that you are incorrect and there is a faster approach."}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1461702276, "post_id": 36873359, "comment_id": 61316765, "body": "I am biased towards <a href=\"http://stackoverflow.com/questions/34028430/deleting-via-autofilter-takes-too-long\">array</a>."}, {"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 0, "creation_date": 1461707082, "post_id": 36873359, "comment_id": 61319321, "body": "There are a <i>lot</i> of Q/A on this on SO.  And besides, if you want to know which is fastest in your specific case, do your own tests"}], "answers": [{"tags": [], "owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "is_accepted": false, "score": 2, "last_activity_date": 1461700350, "last_edit_date": 1461700350, "creation_date": 1461696907, "answer_id": 36873469, "question_id": 36873359, "link": "https://stackoverflow.com/questions/36873359/fastest-way-to-delete-rows-which-cannot-be-grabbed-with-specialcells/36873469#36873469", "title": "Fastest way to delete rows which cannot be grabbed with SpecialCells", "body": "<p>Here are all the possible options I could think of with an \"average time\" to complete the tasks:</p>\n\n<pre><code>Option Base 1\nOption Explicit\n\nSub FixWithArraysAndDeleteRange()\n\nDim lngItem As Long\nDim varArray() As Variant\nDim wksItem As Worksheet\nDim rngRangeToDelete As Range\n\nDim dttStart As Date\n\nWorksheets(1).Range(\"I25:I50000\").Formula = \"=RandBetween(1, 5)\"\nWorksheets(1).Range(\"I25:I50000\").Value2 = Worksheets(1).Range(\"I25:I50000\").Value2\n\ndttStart = Now()\n\nApplication.ScreenUpdating = False\nApplication.Calculation = xlCalculationManual\nApplication.EnableEvents = False\n\nSet wksItem = Worksheets(1)\nvarArray() = wksItem.Range(\"I25:I50000\").Value2\n\nFor lngItem = LBound(varArray) To UBound(varArray)\n    If IsNumeric(varArray(lngItem, 1)) Then\n        If Int(varArray(lngItem, 1)) = 2 Then\n            If rngRangeToDelete Is Nothing Then\n              Set rngRangeToDelete = wksItem.Rows(lngItem + 24)\n            Else\n              Set rngRangeToDelete = Intersect(rngRangeToDelete, wksItem.Rows(lngItem + 24))\n            End If\n        End If\n    End If\nNext lngItem\n\nrngRangeToDelete.EntireRow.Delete\n\nApplication.ScreenUpdating = True\nApplication.Calculation = xlCalculationAutomatic\nApplication.EnableEvents = True\n\nDebug.Print Format(Now() - dttStart, \"HH:MM:SS\")\n'Average time around 0 seconds\n\nEnd Sub\n</code></pre>\n\n<hr>\n\n<pre><code>Sub FixWithLoop()\n\nDim lngRow As Long\nDim lngLastRow As Long\nDim wksItem As Worksheet\n\nDim dttStart As Date\n\nWorksheets(1).Range(\"I25:I50000\").Formula = \"=RandBetween(1, 5)\"\nWorksheets(1).Range(\"I25:I50000\").Value2 = Worksheets(1).Range(\"I25:I50000\").Value2\n\ndttStart = Now()\n\nApplication.ScreenUpdating = False\nApplication.Calculation = xlCalculationManual\nApplication.EnableEvents = False\n\nSet wksItem = Worksheets(1)\nlngLastRow = wksItem.Cells(wksItem.Rows.Count, \"I\").End(xlUp).Row\n\nFor lngRow = lngLastRow To 25 Step -1\n    If Int(wksItem.Cells(lngRow, \"I\").Value) = 2 Then wksItem.Rows(lngRow).Delete\nNext lngRow\n\nApplication.ScreenUpdating = True\nApplication.Calculation = xlCalculationAutomatic\nApplication.EnableEvents = True\n\nDebug.Print Format(Now() - dttStart, \"HH:MM:SS\")\n'Average time ~3 seconds\n\nEnd Sub\n</code></pre>\n\n<hr>\n\n<pre><code>Sub FixWithLoopInChunks()\n\nDim lngRow As Long\nDim lngLastRow As Long\nDim wksItem As Worksheet\nDim strRowsToDelete As String\nDim intDeleteCount As Integer\n\nDim dttStart As Date\n\nWorksheets(1).Range(\"I25:I50000\").Formula = \"=RandBetween(1, 5)\"\nWorksheets(1).Range(\"I25:I50000\").Value2 = Worksheets(1).Range(\"I25:I50000\").Value2\n\ndttStart = Now()\n\nApplication.ScreenUpdating = False\nApplication.Calculation = xlCalculationManual\nApplication.EnableEvents = False\n\nSet wksItem = Worksheets(1)\nlngLastRow = wksItem.Cells(wksItem.Rows.Count, \"I\").End(xlUp).Row\n\nFor lngRow = lngLastRow To 25 Step -1\n    If Int(wksItem.Cells(lngRow, \"I\").Value) = 2 Then\n        intDeleteCount = intDeleteCount + 1\n        strRowsToDelete = strRowsToDelete &amp; \",I\" &amp; lngRow\n    End If\n    If intDeleteCount &gt;= 30 Then\n        strRowsToDelete = Mid(strRowsToDelete, 2)\n        wksItem.Range(strRowsToDelete).EntireRow.Delete\n        intDeleteCount = 0\n        strRowsToDelete = \"\"\n    End If\nNext lngRow\n\nIf intDeleteCount &gt; 0 Then\n    strRowsToDelete = Mid(strRowsToDelete, 2)\n    wksItem.Range(strRowsToDelete).EntireRow.Delete\nEnd If\n\nApplication.ScreenUpdating = True\nApplication.Calculation = xlCalculationAutomatic\nApplication.EnableEvents = True\n\nDebug.Print Format(Now() - dttStart, \"HH:MM:SS\")\n'Average time ~3 seconds\n\nEnd Sub\n</code></pre>\n\n<hr>\n\n<pre><code>Sub FixWithArraysAndDeleteChunks()\n\nDim lngItem As Long\nDim varArray() As Variant\nDim wksItem As Worksheet\nDim strRowsToDelete As String\nDim intDeleteCount As Integer\n\nDim dttStart As Date\n\nWorksheets(1).Range(\"I25:I50000\").Formula = \"=RandBetween(1, 5)\"\nWorksheets(1).Range(\"I25:I50000\").Value2 = Worksheets(1).Range(\"I25:I50000\").Value2\n\ndttStart = Now()\n\nApplication.ScreenUpdating = False\nApplication.Calculation = xlCalculationManual\nApplication.EnableEvents = False\n\nSet wksItem = Worksheets(1)\nvarArray() = wksItem.Range(\"I25:I50000\").Value2\n\nFor lngItem = UBound(varArray) To LBound(varArray) Step -1\n    If IsNumeric(varArray(lngItem, 1)) Then\n        If Int(varArray(lngItem, 1)) = 2 Then\n            intDeleteCount = intDeleteCount + 1\n            strRowsToDelete = strRowsToDelete &amp; \",I\" &amp; lngItem + 24\n        End If\n        If intDeleteCount &gt;= 30 Then\n            strRowsToDelete = Mid(strRowsToDelete, 2)\n            wksItem.Range(strRowsToDelete).EntireRow.Delete\n            intDeleteCount = 0\n            strRowsToDelete = \"\"\n        End If\n    End If\nNext lngItem\n\nIf intDeleteCount &gt; 0 Then\n    strRowsToDelete = Mid(strRowsToDelete, 2)\n    wksItem.Range(strRowsToDelete).EntireRow.Delete\nEnd If\n\nApplication.ScreenUpdating = True\nApplication.Calculation = xlCalculationAutomatic\nApplication.EnableEvents = True\n\nDebug.Print Format(Now() - dttStart, \"HH:MM:SS\")\n'Average time ~2 seconds\n\nEnd Sub\n</code></pre>\n\n<p>Based on the above tests the \"fastest\" route is to use an array, save the range of rows to be deleted using <code>Intersect</code>and then delete all rows together.</p>\n\n<p><sub>Note, if you are using <code>Application.Union</code> instead of <code>Intersect</code> then the time of that approach drops significantly and the sub will run for almost 30 seconds.</sub></p>\n\n<p>Yet, the time difference is very small and negligible (for 50.000 rows).</p>\n\n<p>Please do let me know if my speed-test-setup has any flaws which might bias the results or if I am missing another approach you would like to see.</p>\n\n<h2>Update:</h2>\n\n<p>Here is another approach offered by @SiddharthRout. I do not wish to plagiarise. Yet, I wanted to compare time results. Hence, here is the sub rewritten to compare to the others with the average time recorded on my system.</p>\n\n<pre><code>Sub DeleteFilteredRows_SiddharthRout()\n\nDim wksItem As Worksheet\nDim rngRowsToDelete As Range\n\nDim dttStart As Date\n\nWorksheets(1).Range(\"I25:I50000\").Formula = \"=RandBetween(1, 5)\"\nWorksheets(1).Range(\"I25:I50000\").Value2 = Worksheets(1).Range(\"I25:I50000\").Value2\n\ndttStart = Now()\n\nApplication.ScreenUpdating = False\nApplication.Calculation = xlCalculationManual\nApplication.EnableEvents = False\n\nSet wksItem = Worksheets(1)\nwksItem.AutoFilterMode = False\nwksItem.Range(\"I25:I50000\").AutoFilter Field:=1, Criteria1:=2\nSet rngRowsToDelete = wksItem.Range(\"I25:I50000\").SpecialCells(xlCellTypeVisible)\nwksItem.AutoFilterMode = False\nwksItem.Rows.Hidden = False\n\nrngRowsToDelete.EntireRow.Delete\n\nApplication.ScreenUpdating = True\nApplication.Calculation = xlCalculationAutomatic\nApplication.EnableEvents = True\n\nDebug.Print Format(Now() - dttStart, \"HH:MM:SS\")\n'Average time around 5 seconds\n\nEnd Sub\n</code></pre>\n\n<p>It seems that this approach is slightly slower compared to all the others.</p>\n"}, {"comments": [{"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 2, "creation_date": 1461735444, "post_id": 36875006, "comment_id": 61327759, "body": "++ Definitely a faster way :) It is much faster than autofilter. Removing my answer :)"}], "tags": [], "owner": {"reputation": 36788, "user_id": 2887618, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e643417e67e5a3bb9f659e4491ed26b0?s=128&d=identicon&r=PG&f=1", "display_name": "Florent B.", "link": "https://stackoverflow.com/users/2887618/florent-b"}, "is_accepted": true, "score": 10, "last_activity_date": 1461702363, "last_edit_date": 1461702363, "creation_date": 1461702181, "answer_id": 36875006, "question_id": 36873359, "link": "https://stackoverflow.com/questions/36873359/fastest-way-to-delete-rows-which-cannot-be-grabbed-with-specialcells/36875006#36875006", "title": "Fastest way to delete rows which cannot be grabbed with SpecialCells", "body": "<p>One efficient solution is to tag all the rows to keep and move all the rows to delete at the end by sorting the tags.\nThis way, the complexity doesn't increase with the number of rows to delete.</p>\n\n<p>This example deletes in less than a second, for 50000 rows, all the rows where column <code>I</code> is equal to <code>2</code>:</p>\n\n<pre><code>Sub DeleteMatchingRows()\n    Dim rgTable As Range, rgTags As Range, data(), tags(), count&amp;, r&amp;\n\n    ' load the data in an array\n    Set rgTable = ActiveSheet.UsedRange\n    data = rgTable.Value\n\n    ' tag all the rows to keep with the row number. Leave empty otherwise.\n    ReDim tags(1 To UBound(data), 1 To 1)\n    tags(1, 1) = 1  ' keep the header\n    For r = 2 To UBound(data)\n      If data(r, 9) &lt;&gt; 2 Then tags(r, 1) = r  ' if column I &lt;&gt; 2 keep the row\n    Next\n\n    ' insert the tags in the last column on the right\n    Set rgTags = rgTable.Columns(rgTable.Columns.count + 1)\n    rgTags.Value = tags\n\n    ' sort the rows on the tags which will move the rows to delete at the end\n    Union(rgTable, rgTags).Sort key1:=rgTags, Orientation:=xlTopToBottom, Header:=xlYes\n    count = rgTags.End(xlDown).Row\n\n    ' delete the tags on the right and the rows that weren't tagged\n    rgTags.EntireColumn.Delete\n    rgTable.Resize(UBound(data) - count + 1).Offset(count).EntireRow.Delete\nEnd Sub\n</code></pre>\n\n<p>Note that it doesn't alter the order of the rows.</p>\n"}, {"tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": false, "score": 2, "last_activity_date": 1461752731, "last_edit_date": 1461752731, "creation_date": 1461736242, "answer_id": 36881308, "question_id": 36873359, "link": "https://stackoverflow.com/questions/36873359/fastest-way-to-delete-rows-which-cannot-be-grabbed-with-specialcells/36881308#36881308", "title": "Fastest way to delete rows which cannot be grabbed with SpecialCells", "body": "<p><strong>edited</strong></p>\n\n<p>after some more testings it seems that <code>Sort</code>&amp;<code>Delete</code> is a little faster than <code>RemoveDuplicates</code></p>\n\n<p>so I put in the following solution (keeping the first one for reference by the end of the answer)</p>\n\n<pre><code>Sub FixWithSort()\nDim testRng As Range\nDim dttStart As Date\n\nSet testRng = Worksheets(\"Test\").Range(\"I25:I50000\")\n\nWith testRng\n    .Formula = \"=RandBetween(1, 5)\"\n    .Value2 = .Value2\nEnd With\n\ndttStart = Now()\n\nWith testRng\n    With .Offset(, 1)\n        .FormulaR1C1 = \"=IF(RC[-1]=2,\"\"\"\",row())\"\n        .Value2 = .Value2\n    End With\n\n    .Resize(, 2).Sort key1:=.Columns(2), Orientation:=xlTopToBottom, Header:=xlYes\n    Range(.Cells(1, 2).End(xlDown).Offset(1, -1), .Cells(1, 1).End(xlDown)).EntireRow.Delete\n    .Columns(2).ClearContents\nEnd With\n\nDebug.Print Format(Now() - dttStart, \"HH:MM:SS\")\ndttStartGlobal = dttStartGlobal + Now() - dttStart\n\nEnd Sub\n</code></pre>\n\n<p>previous (and a little slower) solution with <code>RemoveDuplicates</code></p>\n\n<pre><code>Option Explicit\n\nSub FixWithRemoveDuplicates()\nDim testRng As Range\nDim dttStart As Date\n\nSet testRng = Worksheets(\"Test\").Range(\"I25:I50000\")\n\nWith testRng\n    .Formula = \"=RandBetween(1, 5)\"\n    .Value2 = .Value2\nEnd With\n\ndttStart = Now()\n\nApplication.ScreenUpdating = False\nApplication.Calculation = xlCalculationManual\nApplication.EnableEvents = False\n\nWith testRng\n    With .Offset(, 1)\n        .FormulaR1C1 = \"=IF(RC[-1]=2,\"\"a\"\",row())\"\n        .Value2 = .Value2\n    End With\n    .EntireRow.RemoveDuplicates Columns:=Array(.Columns(2).Column), Header:=xlNo\n    .Offset(, 1).Find(what:=\"a\", LookIn:=xlValues, LookAt:=xlWhole).EntireRow.Delete\n    .Columns(2).ClearContents\nEnd With\n\nApplication.ScreenUpdating = True\nApplication.Calculation = xlCalculationAutomatic\nApplication.EnableEvents = True\n\nDebug.Print Format(Now() - dttStart, \"HH:MM:SS\")\n'Average time around 0 seconds\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 433, "favorite_count": 3, "accepted_answer_id": 36875006, "answer_count": 3, "score": 1, "last_activity_date": 1548241650, "creation_date": 1461696535, "last_edit_date": 1548241650, "question_id": 36873359, "link": "https://stackoverflow.com/questions/36873359/fastest-way-to-delete-rows-which-cannot-be-grabbed-with-specialcells", "title": "Fastest way to delete rows which cannot be grabbed with SpecialCells", "body": "<p>Based <a href=\"https://stackoverflow.com/questions/36867552/if-0-or-delete-row-code-works-but-very-slow\">on another question</a> on this site I started wondering about the fastest way to delete all rows with a certain condition.</p>\n\n<p>The above-referenced question came with various solutions:</p>\n\n<p>(1) Loop through all rows on the sheet (backward) and delete all rows one-by-one which meet the condition.</p>\n\n<p>(2) Move the applicable range into an array first and then evaluate the conditions in the array and -- based on that -- delete all rows one-by-one on the underlying sheet.</p>\n\n<p>A possible improvement might be to delete all rows in chunks to reduce the overhead of accessing to the worksheet. But if you go this route then you have various options to \"store\" the ranges before you actually delete them:</p>\n\n<p>(1) Use <code>Intersect</code> to merge the ranges which should be deleted.</p>\n\n<p>(2) Simply write a <code>String</code> with all the rows to be deleted.</p>\n\n<p>So, which is the fastest way to do that?</p>\n"}, {"tags": ["ms-access", "vba"], "answers": [{"tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": false, "score": 1, "last_activity_date": 1461745104, "creation_date": 1461745104, "answer_id": 36884136, "question_id": 36873323, "link": "https://stackoverflow.com/questions/36873323/ms-access-query-multiple-ms-access-databases-with-relative-path/36884136#36884136", "title": "MS access query multiple MS Access Databases with relative path", "body": "<blockquote>\n  <p>I cannot figure out the correct syntax to use VBA functions in the\n  from clause.</p>\n</blockquote>\n\n<p>That's because you can't. The path must be resolved before calling the query.</p>\n\n<p>So you have to build the finished SQL string in VBA, then call the query.</p>\n\n<p>That said, wouldn't it be much simpler to just <em>link</em> the tables needed for the current operation, assigning them names as <em>CatalogA</em> and <em>CatalogB</em>?</p>\n\n<p>The (re)linking is easily done in VBA and would free you completely from tampering with the queries.</p>\n"}], "owner": {"reputation": 1, "user_id": 6257929, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-qo-hRjUO7D4/AAAAAAAAAAI/AAAAAAAABnA/1CHxCTsOXA0/photo.jpg?sz=128", "display_name": "Scott Gunnell-Beck", "link": "https://stackoverflow.com/users/6257929/scott-gunnell-beck"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 404, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1461745104, "creation_date": 1461696426, "question_id": 36873323, "link": "https://stackoverflow.com/questions/36873323/ms-access-query-multiple-ms-access-databases-with-relative-path", "title": "MS access query multiple MS Access Databases with relative path", "body": "<p>I am trying to setup an access database (Queries.accdb) that will be used to query multiple access databases as table sources. I am able to do it by hardcoding, but I am getting syntax errors when I try to use relative paths. I would like to be able to move the Queries.accdb around.</p>\n\n<p>Current file structure:</p>\n\n<ul>\n<li>C:\\Temp\\PB\\28\\A.accdb </li>\n<li>C:\\Temp\\PB\\28\\B.accdb</li>\n<li>C:\\Temp\\PB\\28\\Queries.accdb </li>\n<li>C:\\Temp\\PB\\29\\A.accdb</li>\n<li>C:\\Temp\\PB\\29\\B.accdb </li>\n<li>C:\\Temp\\PB\\29\\Queries.accdb</li>\n</ul>\n\n<p>Current working query:</p>\n\n<pre><code>SELECT * \nFROM  [;database=C:\\Temp\\PB\\28\\A.accdb].[Catalog] AS a \nINNER JOIN [;database=C:\\Temp\\PB\\28\\B.accdb].[Catalog] AS b \nON a.componentid = b.externalid;\n</code></pre>\n\n<p>When I try different variations (.\\ ~\\, etc.) to remove the hardcoded path in front of the DB file, it automatically adds the \"default database folder\" setup in Access. (example: \"C:\\\" would change the following query to \"C:\\A.accdb\")</p>\n\n<pre><code>SELECT * \nFROM  [;database=A.accdb].[Catalog] AS a \nINNER JOIN [;database=B.accdb].[Catalog] AS b \nON a.componentid = b.externalid;\n</code></pre>\n\n<p>I created a VBA function to return both the full \"from\" bracket (including database file) and also one just returning the path, but I cannot figure out the correct syntax to use VBA functions in the from clause.</p>\n\n<pre><code>\"[;database=\" + Application.CurrentProject.Path + \"\\A.accdb]\"\n\"Application.CurrentProject.Path\"\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 7, "user_id": 4622632, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0577d7d08e61ac73758906c59258009e?s=128&d=identicon&r=PG&f=1", "display_name": "subhajit mondal", "link": "https://stackoverflow.com/users/4622632/subhajit-mondal"}, "edited": false, "score": 0, "creation_date": 1461733027, "post_id": 36874987, "comment_id": 61326834, "body": "Your code is only copying One value But I am copying both values to a specific sheet(called &quot;Physical Memory&quot; Ex: First time i want to Paste  @ (A1:B1) ...Then second time I want to paste the data @ (C1:D1)."}, {"owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "reply_to_user": {"reputation": 7, "user_id": 4622632, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0577d7d08e61ac73758906c59258009e?s=128&d=identicon&r=PG&f=1", "display_name": "subhajit mondal", "link": "https://stackoverflow.com/users/4622632/subhajit-mondal"}, "edited": false, "score": 0, "creation_date": 1461860555, "post_id": 36874987, "comment_id": 61402247, "body": "Does it work if you call the sub with <code>PhysicalMemWMI ActiveSheet.Range(&quot;A1:B1&quot;)</code> ? My code is just an example, so you can add parameters however you like, e.g. define the number of values to copy, or the string format to use, or something similar. Hopefully the example is adaptable to your needs."}], "tags": [], "owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "is_accepted": true, "score": 0, "last_activity_date": 1461702055, "creation_date": 1461702055, "answer_id": 36874987, "question_id": 36873266, "link": "https://stackoverflow.com/questions/36873266/copying-data-to-excel-by-criteria/36874987#36874987", "title": "copying data to excel by criteria", "body": "<p>Just add a parameter to your sub:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Option Explicit\n\nSub test()\n    PhysicalMemWMI ActiveSheet.Range(\"A1\")\nEnd Sub\n\nSub PhysicalMemWMI(destinationRange As Range)\n    Dim dTotalMemory          As Double\n    Dim dAvailable            As Double\n    Dim dFreeMem              As Double\n\n    sWQL = \"SELECT * FROM Win32_OperatingSystem\"\n    Set oWMISrvEx = GetObject(\"winmgmts:root/CIMV2\")\n    Set oWMIObjSet = oWMISrvEx.ExecQuery(sWQL)\n\n    For Each oWMIObjEx In oWMIObjSet\n        dTotalMemory = dTotalMemory + oWMIObjEx.TotalVisibleMemorySize\n    Next\n    dTotalMemory = dTotalMemory / 1024\n    Set colItems = oWMISrvEx.ExecQuery(\"Select * \" &amp; _\n                         \"from Win32_PerfFormattedData_PerfOS_Memory\", , 48)\n    For Each objitem In colItems\n        dFreeMem = dFreeMem + objitem.FreeAndZeroPageListBytes\n        dAvailable = dAvailable + objitem.AvailableBytes\n    Next objitem\n    dFreeMem = dFreeMem / 1024 / 1024\n    destinationRange.Value2 = Array( _\n                                Format( _\n                                  ((dTotalMemory * 1024 * 1024) - dAvailable) _\n                                      / 1024 / 1024 / 1024, _\n                                      \"#,##0.00 GB\"), Format(dFreeMem, \"#,##0 MB\"))\nEnd Sub\n</code></pre>\n\n<p>Note: Since you're only using the <code>destinationRange</code> once, there's no need for a <code>With</code> clause here.</p>\n\n<p>(Untested code above, but it should work.)</p>\n"}], "owner": {"reputation": 7, "user_id": 4622632, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0577d7d08e61ac73758906c59258009e?s=128&d=identicon&r=PG&f=1", "display_name": "subhajit mondal", "link": "https://stackoverflow.com/users/4622632/subhajit-mondal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 67, "favorite_count": 0, "accepted_answer_id": 36874987, "answer_count": 1, "score": 0, "last_activity_date": 1461702055, "creation_date": 1461696211, "last_edit_date": 1531164843, "question_id": 36873266, "link": "https://stackoverflow.com/questions/36873266/copying-data-to-excel-by-criteria", "title": "copying data to excel by criteria", "body": "<p>I have this vba code ,which is copying Physical memory data to one specific excel sheet,It is working fine,\nBut i want to make it generic,Whenever i will call this function i want to copy the data to different range</p>\n\n<pre><code>Sub PhysicalMemWMI()\nDim dTotalMemory          As Double\nDim dAvailable            As Double\nDim dFreeMem              As Double\n\nsWQL = \"SELECT * FROM Win32_OperatingSystem\"\nSet oWMISrvEx = GetObject(\"winmgmts:root/CIMV2\")\nSet oWMIObjSet = oWMISrvEx.ExecQuery(sWQL)\n\nWith ThisWorkbook.Sheets(\"Physical Memory\")\n\n\n    For Each oWMIObjEx In oWMIObjSet\n        dTotalMemory = dTotalMemory + oWMIObjEx.TotalVisibleMemorySize\n    Next\n    dTotalMemory = dTotalMemory / 1024\n    Set colItems = oWMISrvEx.ExecQuery(\"Select * from Win32_PerfFormattedData_PerfOS_Memory\", , 48)\n    For Each objitem In colItems\n        dFreeMem = dFreeMem + objitem.FreeAndZeroPageListBytes\n        dAvailable = dAvailable + objitem.AvailableBytes\n    Next objitem\n    dFreeMem = dFreeMem / 1024 / 1024\n   .Range(\"A2:B2\").Value2 = Array(Format(((dTotalMemory * 1024 * 1024) - dAvailable) / 1024 / 1024 / 1024, \"#,##0.00 GB\"), Format(dFreeMem, \"#,##0 MB\"))\n   End With\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "loops"], "comments": [{"owner": {"reputation": 2843, "user_id": 2958401, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/a5dd8c841e767e09bd8c08764dc2319e?s=128&d=identicon&r=PG&f=1", "display_name": "gtwebb", "link": "https://stackoverflow.com/users/2958401/gtwebb"}, "edited": false, "score": 0, "creation_date": 1461696609, "post_id": 36873124, "comment_id": 61313392, "body": "use range(&quot;A&quot; &amp; i) instead of row(&quot;A&quot; &amp; i) and it should work fine."}], "answers": [{"tags": [], "owner": {"reputation": 312, "user_id": 5376832, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/131cf551898d23800289731848abedbc?s=128&d=identicon&r=PG&f=1", "display_name": "Karlomanio", "link": "https://stackoverflow.com/users/5376832/karlomanio"}, "is_accepted": true, "score": 0, "last_activity_date": 1461775617, "last_edit_date": 1461775617, "creation_date": 1461697501, "answer_id": 36873636, "question_id": 36873124, "link": "https://stackoverflow.com/questions/36873124/excel-vba-looping-a-macro-with-custom-data-from-a-worksheet-with-output-to-anot/36873636#36873636", "title": "Excel VBA: Looping a macro with custom data from a worksheet with output to another", "body": "<p>Your macro will have code written for it.  Modify the macro's declaration to pass in the variables you want it to use/manipulate.</p>\n\n<pre><code>Dim row As Range\nDim rowCount As Integer\nDim input1 As String\nDim input2 As String\nSet worksheet1 = Worksheets(\"Sheet1\")\nSet worksheet2 = Worksheets(\"Sheet2\")\nrowCount = worksheet1.Cells(Rows.Count, \"A\").End(xlUp).row\n\nFor i = 2 To worksheet1.rowCount\n    Do\n        input1 = worksheet1.row(\"A\" &amp; i).Value '(value is continuous text)\n        input2 = worksheet1.row(\"B\" &amp; i).Value '(value is integer)\n        worksheet2.Activate\n             Do\n                MacroCode input1, input2\n             Next\n    Next i\nEnd\n\nSub MacroCode(input1 As String, input2 As Integer)\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 4512341, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ef4b33ded8838d7331b08dbee0e7d824?s=128&d=identicon&r=PG&f=1", "display_name": "rsasetc", "link": "https://stackoverflow.com/users/4512341/rsasetc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 46, "favorite_count": 0, "accepted_answer_id": 36873636, "answer_count": 1, "score": -1, "last_activity_date": 1463196174, "creation_date": 1461695780, "last_edit_date": 1463196174, "question_id": 36873124, "link": "https://stackoverflow.com/questions/36873124/excel-vba-looping-a-macro-with-custom-data-from-a-worksheet-with-output-to-anot", "title": "Excel VBA: Looping a macro with custom data from a worksheet with output to another", "body": "<p>I have a macro that I customize certain parameters of each time I need to run it. To be more efficient I'd like the macro to grab the parameter value from another worksheet I provide and use that value as input for a sub do loop.</p>\n\n<p>Below I provide my basic understanding of what I'd like the macro to do in lay language. </p>\n\n<pre><code>Dim row as Range\nDim rowCount As Integer\nDim input1 as String\nDim input2 as String\nSet worksheet1=Worksheets(\"Sheet1\")\nSet worksheet2=Worksheets(\"Sheet2\")\nrowCount=worksheet1.Cells(Rows.Count,\"A\").End(xlUp).row\n\nFor i=2 to worksheet1.rowCount\n    Do\n        input1=worksheet1.row(\"A\" &amp; i).value (value is continuous text)\n        input2=worksheet1.row(\"B\" &amp; i).value (value is integer)\n        worksheet2.activate\n             Do                 \n             *code that relies on the input1 and input2 values to run.\n    Next i\nEnd\n</code></pre>\n"}, {"tags": ["vba", "excel", "autofill"], "comments": [{"owner": {"reputation": 1743, "user_id": 3629691, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RkvSZ.jpg?s=128&g=1", "display_name": "CodeJockey", "link": "https://stackoverflow.com/users/3629691/codejockey"}, "edited": false, "score": 1, "creation_date": 1461694442, "post_id": 36872438, "comment_id": 61311996, "body": "I would try determining what the target range is dynamically, storing it in a variable, and then passing the variable to the <code>Destination:=</code> argument.  Here&#39;s a start: <a href=\"http://www.excel-easy.com/vba/examples/offset.html\" rel=\"nofollow noreferrer\">excel-easy.com/vba/examples/offset.html</a>  <a href=\"http://www.excel-easy.com/vba/examples/from-active-cell-to-last-entry.html\" rel=\"nofollow noreferrer\">excel-easy.com/vba/examples/from-active-cell-to-last-entry.h&zwnj;&#8203;tml</a>"}], "answers": [{"tags": [], "owner": {"reputation": 562, "user_id": 5950214, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/d16094911aa0666d7cc19d29f361fe3c?s=128&d=identicon&r=PG", "display_name": "ali srn", "link": "https://stackoverflow.com/users/5950214/ali-srn"}, "is_accepted": false, "score": 0, "last_activity_date": 1461744128, "creation_date": 1461744128, "answer_id": 36883823, "question_id": 36872438, "link": "https://stackoverflow.com/questions/36872438/excel-vba-code-to-autofill-formula-to-whatever-the-length-of-the-column-to-the/36883823#36883823", "title": "Excel VBA: Code to Autofill formula to whatever the length of the column to the left is (so no specified range is required)", "body": "<p>I assumed that you have a formula on Cell(B1) and there are some entries in column A.\nThen your code would be like that if I understand you correctly,</p>\n\n<pre><code>Sub autofill()\n\nDim Last_Row_Left As Integer 'Long if too high.\nLast_Row_Left = Range(\"A66450\").End(3).Row\nRange(\"B1\").Copy\n\nRange(Cells(2, 2), Cells(Last_Row_Left, 2)).PasteSpecial\n\nEnd Sub\n</code></pre>\n\n<p>You can edit this to your own work with FormulaRC.</p>\n"}], "owner": {"reputation": 744, "user_id": 1623804, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/62YqG.jpg?s=128&g=1", "display_name": "camelCaseCowboy", "link": "https://stackoverflow.com/users/1623804/camelcasecowboy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1315, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1463193989, "creation_date": 1461693602, "last_edit_date": 1463193989, "question_id": 36872438, "link": "https://stackoverflow.com/questions/36872438/excel-vba-code-to-autofill-formula-to-whatever-the-length-of-the-column-to-the", "title": "Excel VBA: Code to Autofill formula to whatever the length of the column to the left is (so no specified range is required)", "body": "<p>I'm making a macro whereby I'm trying to autofill a formula, but when I autofill it, in the code it specifies a certain range instead of having code that will generally work if I apply it to a list with more or fewer records in it.  The code currently looks like:</p>\n\n<pre><code>ActiveCell.FormulaR1C1 = \"=RC[-3]*RC[-1]\"\n Range(\"S11\").Select\nSelection.AutoFill Destination:=ActiveCell.Range(\"A1:A1846\")\n</code></pre>\n\n<p>But I want to make it so that I copy it down to whatever the last row with values on the column to the left, so that instead of copying to A1846 it copies to whatever length depending on the length of the list as a whole?</p>\n"}, {"tags": ["excel", "vba", "copy", "row", "dropdown"], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user6018732"}, "edited": false, "score": 0, "creation_date": 1461696170, "post_id": 36872990, "comment_id": 61313130, "body": "This gets the job done! I figured out something myself (clicked on &quot;use relative references&quot; when recording the same macro). But with your code, I don&#39;t have to be in the B column to make it work. Thanks!"}, {"owner": {"reputation": 5345, "user_id": 3561813, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/958afeca6b11ffa0e83b97b516c88dc7?s=128&d=identicon&r=PG&f=1", "display_name": "basodre", "link": "https://stackoverflow.com/users/3561813/basodre"}, "edited": false, "score": 0, "creation_date": 1461699798, "post_id": 36872990, "comment_id": 61315291, "body": "@TanyaChy Good to hear. Oftentimes, there are many ways to get to our answer, and it&#39;s all about figuring out the best one. It&#39;s good that you were able to solve a part of the problem on your own!"}], "tags": [], "owner": {"reputation": 5345, "user_id": 3561813, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/958afeca6b11ffa0e83b97b516c88dc7?s=128&d=identicon&r=PG&f=1", "display_name": "basodre", "link": "https://stackoverflow.com/users/3561813/basodre"}, "is_accepted": true, "score": 0, "last_activity_date": 1461695391, "creation_date": 1461695391, "answer_id": 36872990, "question_id": 36872418, "link": "https://stackoverflow.com/questions/36872418/create-a-macro-to-add-new-row-that-includes-dropdown-options/36872990#36872990", "title": "Create a macro to add new row that includes dropdown options", "body": "<p>Below is one approach. It copies the validation (only the validation) from <code>B4:C4</code> and pastes it one row below the <code>ActiveCell</code>. Presuming the cursor is <em>anywhere</em> in row 6, when you run this macro, the <code>Validation</code> dropdowns will be copied to cells <code>B7:C7</code>. </p>\n\n<pre><code>Sub CopyValidation()\n    Dim rCopy As Range\n\n\n    Application.ScreenUpdating = False\n\n    Set rCopy = ActiveSheet.Range(\"B4:C4\")\n\n    rCopy.Copy\n    ActiveSheet.Range(\"B\" &amp; ActiveCell.Row + 1).PasteSpecial xlPasteValidation\n    Application.CutCopyMode = False\n\n    Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n\n<p>Is this what you needed?</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user6018732"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 284, "favorite_count": 0, "accepted_answer_id": 36872990, "answer_count": 1, "score": 0, "last_activity_date": 1461695391, "creation_date": 1461693540, "question_id": 36872418, "link": "https://stackoverflow.com/questions/36872418/create-a-macro-to-add-new-row-that-includes-dropdown-options", "title": "Create a macro to add new row that includes dropdown options", "body": "<p><a href=\"http://i.stack.imgur.com/TaDAh.jpg\" rel=\"nofollow\">What I start with</a></p>\n\n<p><a href=\"http://i.stack.imgur.com/TComq.jpg\" rel=\"nofollow\">This is what I want it to do, but for every row</a></p>\n\n<p>Here is the macro that was created when I simply copied and pasted the first row. This copies the dropdown menus for columns B and C, which I will need for every new row. So, it can't just copy the values that appear in the row being copied - it needs to include the dropdowns (the new row can be above or below the rest). Can the code below be tweaked to achieve that?</p>\n\n<p>Sub AddLine()\n'\n' AddLine Macro\n'\n' Keyboard Shortcut: Ctrl+Shift+A\n'\n    Range(\"B4:C4\").Select\n    Selection.Copy</p>\n\n<pre><code>Range(\"B5:C5\").Select\nActiveSheet.Paste\n\nRange(\"D5\").Select\nApplication.CutCopyMode = False\n\nRange(\"B5\").Select\n</code></pre>\n\n<p>End Sub</p>\n"}, {"tags": ["excel", "vba", "google-api", "picasa", "google-photos"], "comments": [{"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1519208071, "post_id": 36871477, "comment_id": 84811823, "body": "Did you find a solution?  If not, I believe i have one for you.\\"}, {"owner": {"reputation": 2987, "user_id": 298871, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/eee2993cf9ace90ee522fc0dd79691f5?s=128&d=identicon&r=PG", "display_name": "checho", "link": "https://stackoverflow.com/users/298871/checho"}, "reply_to_user": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1519227981, "post_id": 36871477, "comment_id": 84825959, "body": "Not really, I haven&#39;t. If you can share your approach, that would be great."}], "answers": [{"tags": [], "owner": {"reputation": 347, "user_id": 3240320, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d91151925a4c8d6df8fa80588b58bde1?s=128&d=identicon&r=PG&f=1", "display_name": "Bryn", "link": "https://stackoverflow.com/users/3240320/bryn"}, "is_accepted": false, "score": 1, "last_activity_date": 1499804579, "creation_date": 1499804579, "answer_id": 45043841, "question_id": 36871477, "link": "https://stackoverflow.com/questions/36871477/get-list-of-all-files-in-google-photos/45043841#45043841", "title": "Get list of all files in Google Photos", "body": "<p>Try this way:</p>\n\n<ol>\n<li>Select all photos you have in account. You may have trouble if you have lots of them, to workaround so select the first one and scroll down. The images will load, holding shift button makes hover images under cursor, so click on images with shift to select as much as possible.</li>\n<li>When you have necessary selection, click download images. The file starts to download. Your task is to interrupt it and try to get into saved file with some archive viewer. The file is corrupted, but at least the archive will contain all file names.</li>\n</ol>\n"}, {"comments": [{"owner": {"reputation": 7884, "user_id": 543873, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/55576366e4295fb7840a319399d53f57?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/543873/michael"}, "edited": false, "score": 1, "creation_date": 1578196246, "post_id": 48919472, "comment_id": 105358476, "body": "That PicasaWeb link is 404"}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "reply_to_user": {"reputation": 7884, "user_id": 543873, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/55576366e4295fb7840a319399d53f57?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/543873/michael"}, "edited": false, "score": 1, "creation_date": 1599403283, "post_id": 48919472, "comment_id": 112758199, "body": "One day when I have time I&#39;ll update this answer to use oAuth and the newer <a href=\"https://developers.google.com/photos/library/guides/get-started\" rel=\"nofollow noreferrer\">Google Photos API&#39;s</a>.  Spoiler: Google still doesn&#39;t make it easy to determine which files are hogging all your free storage space."}, {"owner": {"reputation": 7884, "user_id": 543873, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/55576366e4295fb7840a319399d53f57?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/543873/michael"}, "edited": false, "score": 0, "creation_date": 1599412134, "post_id": 48919472, "comment_id": 112760672, "body": "I wrote a simple script (actually about 3 as I haven&#39;t properly cleaned it up to integrate oAuth) using the API - it takes about 20 minutes to run... even requesting 100 at a time it often returns only 20-30 items and I&#39;ve got close to 100,000 images.  And guess what, you also can&#39;t use it to distinguish duplicates that differ only in their meta data (curse you Google for making me have to re-upload if I rename or add GPS data, and it&#39;s easy to forget to locate and delete/empty trash before re-uploading)"}], "tags": [], "owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "is_accepted": true, "score": 8, "last_activity_date": 1592915973, "last_edit_date": 1592915973, "creation_date": 1519272174, "answer_id": 48919472, "question_id": 36871477, "link": "https://stackoverflow.com/questions/36871477/get-list-of-all-files-in-google-photos/48919472#48919472", "title": "Get list of all files in Google Photos", "body": "<blockquote>\n<p><em><strong>This answer is outdated and will no longer work as Picasa and its API have been shut down</strong></em></p>\n</blockquote>\n<h1>How to list all files in your <em>Google Photos</em>:</h1>\n<p>I was surprised at how long it took me to find this API.  It's not necessarily &quot;secret information&quot;, but I suppose most users are perfectly happy viewing their Google Photos &quot;the old fashioned way&quot;.  My initial goal was to be able to determine which photos had/had not properly uploaded before I risk deleting anything as valuable as even my <em>&quot;3rd backup copy&quot;</em> of old photos.</p>\n<ul>\n<li><p>Like so many things in life, there's an <strong>easy way</strong> and a <strong>hard way</strong>.</p>\n</li>\n<li><p>Depending on your point of view, the <em>hard way</em> is often more fun and/or more fulfilling...</p>\n</li>\n</ul>\n<hr />\n<h2>Short Answer: <sub><sup><em>(The &quot;Easy&quot; Way)</em></sup></sub></h2>\n<ol>\n<li><p>Make sure you're logged into your <strong><a href=\"https://accounts.google.com/\" rel=\"nofollow noreferrer\">Google Account</a></strong> on your &quot;usual&quot; (default) browser.</p>\n</li>\n<li><h2>Click this:\n\u2002\u2002<strong><a href=\"https://picasaweb.google.com/data/feed/api/user/default\" rel=\"nofollow noreferrer\">https://picasaweb.google.com/data/feed/api/user/default</a></strong></h2>\n</li>\n</ol>\n<p>You'll get a text-based list of all your Google Photos <em>Albums</em>.  Both the album list and the photo list look suspiciously like RSS Feeds (and can be bookmarked as such if you should so desire).</p>\n<hr />\n<p>I know <em>you</em> don't want to <strong>copy your list of photos <em>manually</em></strong>, but I suspect others that come across this question want the <em>&quot;easy&quot;</em> way:</p>\n<ul>\n<li><p>After opening the API <a href=\"https://picasaweb.google.com/data/feed/api/user/default\" rel=\"nofollow noreferrer\">URL</a>, click the first album link.</p>\n</li>\n<li><p>hit <kbd>Ctrl</kbd>+<kbd>A</kbd> then <kbd>Ctrl</kbd>+<kbd>C</kbd> to copy text from the page</p>\n</li>\n<li><p>go to your favorite text editor (<a href=\"https://notepad-plus-plus.org/\" rel=\"nofollow noreferrer\">Notepad++</a>, Excel, oldschool Notepad, etc) and hit <kbd>Ctrl</kbd>+<kbd>V</kbd></p>\n</li>\n<li><p>go back to the photo list, click your browser's <kbd><img src=\"https://i.stack.imgur.com/CE4eJ.png\" alt=\"\u2190\" />Back</kbd> button and <em>repeat for each album</em>.</p>\n</li>\n</ul>\n<p><strong>Authentication:</strong>  For the sake of simplicty, first <strong>make sure you are signed in</strong> to your Google account from any Google page, such as from the top-right corner of the <a href=\"https://google.com\" rel=\"nofollow noreferrer\">Google Search page</a>. This will allow you to use the generic addresses listed below -- otherwise the word &quot;<code>default</code>&quot; would need to be replaced with your Google ID, as as well as other changes to accomodate <a href=\"https://developers.google.com/picasa-web/faq_gdata#Authentication\" rel=\"nofollow noreferrer\">Google API Authentication</a>.</p>\n<hr />\n<h2>API Endpoints</h2>\n<p>If you have a preferred method of sending <a href=\"https://www.w3schools.com/tags/ref_httpmethods.asp\" rel=\"nofollow noreferrer\">GET requests</a> then all you'll need is two URL's.</p>\n<p>As I understand it, <strong>all</strong> Google Photos are stored in <strong>Albums</strong> (even if they don't appear to be). Therefore, in order to list all photos, you must parse all of your albums, listing the photos in each one.</p>\n<p>The <code>GET</code> call to list your Google Photos albums is:</p>\n<pre><code>https://picasaweb.google.com/data/feed/api/user/default\n</code></pre>\n<p>The <code>GET</code> call to list all photos within an album is:</p>\n<pre><code>https://picasaweb.google.com/data/feed/api/user/default/albumid/__[albumID]__\n</code></pre>\n<hr />\n<h2><em>Retrieving the List Programmatically: <sub><sup>(The &quot;<strong>.NET</strong> API&quot; Way)</sup></sub></em></h2>\n<p><strong>.NET Example from <a href=\"https://developers.google.com/picasa-web/docs/1.0/developers_guide_dotnet\" rel=\"nofollow noreferrer\">Google</a>:</strong></p>\n<pre><code>PhotoQuery query = new PhotoQuery(PicasaQuery.CreatePicasaUri(username, albumid));\n\nPicasaFeed feed = service.Query(query);\n\nforeach (PicasaEntry entry in feed.Entries)\n{\n    Console.WriteLine(entry.Title.Text);\n}\n</code></pre>\n<blockquote>\n<p>\u2605 The string &quot;<code>default</code>&quot; can be used in place of a real username, in which case the server will use the username of the <em>current user credentials</em> used to authenticate the request.</p>\n</blockquote>\n<p>More Info: <strong><a href=\"https://developers.google.com/picasa-web/docs/1.0/developers_guide_dotnet\" rel=\"nofollow noreferrer\">Google Picasa .NET Developer's Guide: Request a List of Photos</a></strong></p>\n<hr />\n<h2><em>List all Google Photos using VBA: <sub><sup>(The&quot;Web-Scrapey Way&quot; with Excel)</em></sup></sub></h2>\n<p><strong>Excel has built-in XML-Parsing functionality</strong>, in various forms:</p>\n<ul>\n<li><a href=\"https://support.office.com/en-us/article/Import-XML-data-6eca3906-d6c9-4f0d-b911-c736da817fa4\" rel=\"nofollow noreferrer\">Import XML Data</a> (Developer Tab) <sub><sup>Excel 2007+</sup></sub></li>\n<li><a href=\"https://support.office.com/en-us/article/connect-to-an-xml-file-power-query-78bbe5b5-ebf2-4036-bdcb-72ea47f34ee3#ID0EAADAAA=2007\" rel=\"nofollow noreferrer\">Connect to an XML file</a> (Power Query) <sub><sup>Excel 2010+</sup></sub></li>\n<li><a href=\"https://support.office.com/en-us/article/Web-functions-reference-2b2fb1f0-5107-4020-a563-7dd9cfae2343\" rel=\"nofollow noreferrer\">Webservice &amp; FilterXML</a> (Worksheet Functions) <sub><sup>Excel 2013+</sup></sub></li>\n</ul>\n<p>...but not even the newest features seem to support enough  [of what I assume to be] variations in XML style/source, to be of use to me...  (or maybe I'm just doing something wrong.</p>\n<p>Thus, my preferred method for parsing XML is to simply load it into a String with an <code>HttpRequest</code> and then use <code>Instr</code> and <code>Mid</code> to locate the values I'm interested in.  It's messy, but I've used it as a &quot;quick fix&quot; to retrieve several types of data from several types of sites.</p>\n<blockquote>\n<p>While writing this answer I seem to have misplaced my related code (side effect of over-multitasking?!) -- but if you made it this far, you probably get the gist of it.  The simple function for retrieving the source from a URL is below.  If you're interested in seeing the rest, add a comment and I'll look harder.  :-)</p>\n</blockquote>\n<pre><code>Public Function getHTTP(ByVal url As String) As String\n'equivalent to Excel's WEBSERVICE function\n    Dim encResp() As Byte, xmlHTTP As Object\n    Set xmlHTTP = CreateObject(&quot;MSXML2.XMLHTTP&quot;) 'create XML/HTTP object\n    xmlHTTP.Open &quot;GET&quot;, url, False 'initialize GET request\n    xmlHTTP.send 'send request to remote server\n    encResp = xmlHTTP.responseBody 'receive raw (encoded) response\n    Set xmlHTTP = Nothing 'always clean up after yourself!\n    getHTTP = StrConv(encResp, vbUnicode) 'return decoded response\nEnd Function\n</code></pre>\n<p>Also a sneaky way to quickly count occurrences of one string within another:</p>\n<pre><code>Function countOccur(searchWithin As String, toFind As String) As String\n    'returns the count of occurrences of [toFind] within [searchWithin]\n    countOccur = UBound(Split(searchWithin, toFind))\nEnd Function\n</code></pre>\n<p>Counting occurrences of <code>&lt;entry&gt;</code> on an album or photo page returns the count of albums or photos on that page.</p>\n<hr />\n<h2>Related Links:</h2>\n<ul>\n<li><p><a href=\"https://developers.google.com/picasa-web/docs/2.0/reference\" rel=\"nofollow noreferrer\">Picasa Web Albums Data API Reference</a></p>\n</li>\n<li><p>MSDN : <a href=\"https://msdn.microsoft.com/en-us/library/ms537505(v=vs.85).aspx\" rel=\"nofollow noreferrer\">About Native XMLHTTP</a></p>\n</li>\n<li><p><a href=\"http://www.4guysfromrolla.com/webtech/110100-1.shtml\" rel=\"nofollow noreferrer\">Using Microsoft's XMLHTTP Object to Get Data From Other Web Pages</a></p>\n</li>\n<li><p>MSDN : <a href=\"https://msdn.microsoft.com/en-us/library/ms756095(v=vs.85).aspx\" rel=\"nofollow noreferrer\">responseBody Property (IXMLHTTPRequest)</a></p>\n</li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 1407, "user_id": 5515843, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/746997ba4ec55decede7905984a418d7?s=128&d=identicon&r=PG", "display_name": "bobasti", "link": "https://stackoverflow.com/users/5515843/bobasti"}, "is_accepted": false, "score": 4, "last_activity_date": 1600537218, "last_edit_date": 1600537218, "creation_date": 1551878484, "answer_id": 55024129, "question_id": 36871477, "link": "https://stackoverflow.com/questions/36871477/get-list-of-all-files-in-google-photos/55024129#55024129", "title": "Get list of all files in Google Photos", "body": "<h1>How to list all photos from specific albums or whole library</h1>\n<h3>Deprecated Picasa API alternative</h3>\n<p>Since Picasa API has been deprecated by Google, the <strong>Google Photos API</strong> can be used to obtain information about albums and to get a list of photos and videos in that album, or even in the whole Google Photos library.</p>\n<p>This can be done using REST, Java or PHP (as listed on their <strong><a href=\"https://developers.google.com/photos/library/guides/list\" rel=\"nofollow noreferrer\">examples page</a></strong>).</p>\n<p><strong>Get started</strong>: <a href=\"https://developers.google.com/photos/\" rel=\"nofollow noreferrer\">https://developers.google.com/photos/</a></p>\n<hr />\n<h3>Web API provided by Google</h3>\n<p>You can also easily test API functionality without downloading or coding anything, by visiting one of the API method links on the web shown on the examples page:</p>\n<ul>\n<li><strong>List albums:</strong> <a href=\"https://developers.google.com/photos/library/reference/rest/v1/albums/list\" rel=\"nofollow noreferrer\">https://developers.google.com/photos/library/reference/rest/v1/albums/list</a>\n<ul>\n<li><em>This way you can obtain albumId parameters from all albums in your Google Photos library.</em></li>\n</ul>\n</li>\n<li><strong>List media items:</strong> <a href=\"https://developers.google.com/photos/library/reference/rest/v1/mediaItems/list\" rel=\"nofollow noreferrer\">https://developers.google.com/photos/library/reference/rest/v1/mediaItems/list</a>\n<ul>\n<li><em>This way you can list <strong>ALL</strong> media items in your Google Photos library.</em></li>\n</ul>\n</li>\n<li><strong>List shared albums:</strong> <a href=\"https://developers.google.com/photos/library/reference/rest/v1/sharedAlbums/list\" rel=\"nofollow noreferrer\">https://developers.google.com/photos/library/reference/rest/v1/sharedAlbums/list</a>\n<ul>\n<li><em>This way you can list only albums that you've shared or have been shared with you.</em></li>\n</ul>\n</li>\n</ul>\n<hr />\n<p>In order to obtain a list of <strong>all photos and videos in a specific album</strong>, use:</p>\n<ul>\n<li><strong>Search media items:</strong> <a href=\"https://developers.google.com/photos/library/reference/rest/v1/mediaItems/search\" rel=\"nofollow noreferrer\">https://developers.google.com/photos/library/reference/rest/v1/mediaItems/search</a>\n<ul>\n<li><em>This way you can list media items from one <strong>album</strong>.</em></li>\n<li>Using this method you can only list <strong>at most 100 media items</strong> in an album at a time (on one page). Each response gives you the <code>nextPageToken</code> at the end. Use the <code>pageToken</code> parameter to navigate through pages.</li>\n<li>If you need to do this a couple of times, no problem. For simple and repeating tasks like this, you can utilize <strong><a href=\"https://www.tinytask.net/\" rel=\"nofollow noreferrer\">TinyTask</a></strong> to record mouse and keyboard input, and <strong>automate the boring work</strong>.</li>\n</ul>\n</li>\n</ul>\n<h3>Note</h3>\n<p>For simple searches and listing, you can use the above mentioned web API that gives at most 100 results per page. For anything more advanced I advise you to write code that will go through all result pages and store or print out the information that you need. For a no coding solution, <strong><a href=\"https://www.tinytask.net/\" rel=\"nofollow noreferrer\">TinyTask</a></strong> is a good alternative.</p>\n"}, {"tags": [], "owner": {"reputation": 307, "user_id": 8613945, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Qi5mEFbbc5E/AAAAAAAAAAI/AAAAAAAAHlw/e4HJ-kiHL4A/photo.jpg?sz=128", "display_name": "Giles Knap", "link": "https://stackoverflow.com/users/8613945/giles-knap"}, "is_accepted": false, "score": 2, "last_activity_date": 1551962793, "creation_date": 1551962793, "answer_id": 55044152, "question_id": 36871477, "link": "https://stackoverflow.com/questions/36871477/get-list-of-all-files-in-google-photos/55044152#55044152", "title": "Get list of all files in Google Photos", "body": "<p>If you want to list all your photos and check them against your backups you could use my python project <a href=\"https://pypi.org/project/gphotos-sync/\" rel=\"nofollow noreferrer\">https://pypi.org/project/gphotos-sync/</a> which uses the new(ish) Google Photos API.</p>\n\n<p>This will:-</p>\n\n<ul>\n<li>index all of your media and albums into a SQL database</li>\n<li>download a local backup (if required)</li>\n<li>make a comparison of your new local backup against previous backups</li>\n<li>give you a list of the files missing from your library</li>\n<li>give you a list of files missing from your previous backups</li>\n<li>give you a list of all the duplicates in your backup folders</li>\n</ul>\n\n<p>Note that the comparison works on metadata in the files themselves and the folder structure and filenames need not match for it to work.</p>\n"}, {"comments": [{"owner": {"reputation": 101, "user_id": 2842229, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a38cf5f1e5d93be40fb11bda7b3007fd?s=128&d=identicon&r=PG", "display_name": "Sadi", "link": "https://stackoverflow.com/users/2842229/sadi"}, "edited": false, "score": 0, "creation_date": 1578060962, "post_id": 55175360, "comment_id": 105326388, "body": "Thanks a lot! Although it was a bit difficult to find the auth token, I&#39;ve managed to get a list of all files in Google Photos. However, the script ignored the filename I specified and simply saved a file named &quot;list&quot; in the current folder as well as the last &quot;page&quot; file although it&#39;s not a big deal."}, {"owner": {"reputation": 101, "user_id": 2842229, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a38cf5f1e5d93be40fb11bda7b3007fd?s=128&d=identicon&r=PG", "display_name": "Sadi", "link": "https://stackoverflow.com/users/2842229/sadi"}, "edited": false, "score": 0, "creation_date": 1578061889, "post_id": 55175360, "comment_id": 105326810, "body": "I should probably add that entering <b>token</b> in the <i>Filter</i> field showed the authorization token as <i>access_token</i>."}], "tags": [], "owner": {"reputation": 59, "user_id": 11206611, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-hZW12PVtO9k/AAAAAAAAAAI/AAAAAAAALCY/u2tpfDMutRU/photo.jpg?sz=128", "display_name": "David Tristram", "link": "https://stackoverflow.com/users/11206611/david-tristram"}, "is_accepted": false, "score": 3, "last_activity_date": 1552622531, "creation_date": 1552622531, "answer_id": 55175360, "question_id": 36871477, "link": "https://stackoverflow.com/questions/36871477/get-list-of-all-files-in-google-photos/55175360#55175360", "title": "Get list of all files in Google Photos", "body": "<p>I thought this was much easier:</p>\n\n<p>Here's my bash script:</p>\n\n<pre><code>#!/bin/bash\n#\n# listgp - list google photos\n#\n# usage: listgp &lt;file&gt;\n#\n# dumps listing of all curreent user's stored google photos in the speeceifieed file\n#\n# example access to google api\n#\n# curl   'https://photoslibrary.googleapis.com/v1/mediaItems?pageToken=CkQKQnR5cGUuZ29vZ2xlYXBpcy5jb20vZ29vZ2xlLnBob3Rvcy5saWJyYXJ5LnYxLkxpc3RNZWRpYUl0ZW1zUmVxdWVzdBKiAUFIX3VRNDM0V1JKaEVkcTRfYU1uUXNnUXlzdGJpUEt4enlhVXZ3QW1TUTB5cVg2SEdRRk85MjkwRlFrRVg2VlJMRVBOVnI4cHRyRWhPcE11bTN3WUFTVHNnTXNFdmc5eUtaODd6TFJsLXh2QjNnSUlabWpLZl9sZV81c2lMc1VCUmhsalNFRXowWm9lazVhczQtNXB0dkJtYzduYUs1b1Vidw'   --header 'Authorization: Bearer ya29.GmTMBkWYE5CNTCSKJJTqlSh7FohUHp6u0hWTiyevsIW5iEGbBC0lmExfCNAldH8kaKBkwszW3Pk-ZwAzFMPNXtM4RlBF8M4vgbf8Lzv99LiVxWtojooSnRxOHWqq7ZEm-4sE9NI-'   --header 'Accept: application/json'  --compressed\n#\n# to determine your auth token,\n#    see https://developers.google.com/photos/library/reference/rest/v1/mediaItems/list\n# open dev tools in chrome, go to network tab, run the example, log into your google photos account\n#    you can inpect the headers and find one that has 'Authorization: Bearer '.  Copy and paste your token\n#    in the script below as the value for 'auth'.\n#\n#\nauth=\"ya29.GmPNBqtRiw1dvOdiqjoaRkG9CtO2gunFtV8u_00vsAHROatuT5gZlFwNjmXf-CiPxOqxdgDKmweTdZIXeOCVaMM7d8n7E9VQlxAKOZo1zyE5Gq0_Nqqpc7T6csUJ5wablvhajQw\"\n#\nfunction getItems() {\n    pageToken=$1;\n\n    if [ \"$pageToken\" != \"\" ]\n    then\n       pageTokenParam=pageToken=\"$pageToken\";\n    else    \n    pageTokenParam=\"\";\n    fi\n\n    curl  \\\n     \"https://photoslibrary.googleapis.com/v1/mediaItems?$pageTokenParam\" \\\n     --header \"Authorization: Bearer $auth\" \\\n     --header 'Accept: application/json'\\\n     --compressed &gt; page\n\n    cat page &gt;&gt; list\n\n    grepOut=(`grep nextPageToken page | sed s/\\\"//g`)\n\n    if [ \"${grepOut[0]}\" == \"\" ]\n    then\n    exit;\n    fi\n\n    getItems ${grepOut[1]}\n}\n\ngetItems\n</code></pre>\n"}], "owner": {"reputation": 2987, "user_id": 298871, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/eee2993cf9ace90ee522fc0dd79691f5?s=128&d=identicon&r=PG", "display_name": "checho", "link": "https://stackoverflow.com/users/298871/checho"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 11890, "favorite_count": 4, "accepted_answer_id": 48919472, "answer_count": 5, "score": 9, "last_activity_date": 1600537218, "creation_date": 1461690673, "last_edit_date": 1530822752, "question_id": 36871477, "link": "https://stackoverflow.com/questions/36871477/get-list-of-all-files-in-google-photos", "title": "Get list of all files in Google Photos", "body": "<p>My ultimate goal is to get a list with all the files (photos, videos) in my Google Photos account preferably with their path.\n<a href=\"https://i.stack.imgur.com/rNtHj.png\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/rNtHj.png\" alt=\"enter image description here\"></a></p>\n\n<p>If I have to use some API I would rather use a .NET based one. Can you provide some directions in this matter?</p>\n\n<p>I've tried the Gdata API, via the PicasaService, but providing my email/password as credentials did not work and I always get 404 response.</p>\n"}, {"tags": ["vba", "excel", "activex"], "answers": [{"comments": [{"owner": {"reputation": 418, "user_id": 5919585, "user_type": "registered", "accept_rate": 87, "profile_image": "https://lh3.googleusercontent.com/-R3HXA5L1CCE/AAAAAAAAAAI/AAAAAAAAAGY/A2G6nHm58EI/photo.jpg?sz=128", "display_name": "Aspiring Developer", "link": "https://stackoverflow.com/users/5919585/aspiring-developer"}, "edited": false, "score": 0, "creation_date": 1461695800, "post_id": 36872157, "comment_id": 61312880, "body": "Do you know of a link where I can download those tools? I get this error when going to the download site: You don&#39;t have permission to access &quot;<a href=\"http://activex.microsoft.com/controls/vb6/MSCOMCT2.cab\" rel=\"nofollow noreferrer\">activex.microsoft.com/controls/vb6/MSCOMCT2.cab</a>&quot; on this server. <a href=\"http://activex.microsoft.com/controls/vb6/mscomct2.cab\" rel=\"nofollow noreferrer\">activex.microsoft.com/controls/vb6/mscomct2.cab</a>"}, {"owner": {"reputation": 2843, "user_id": 2958401, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/a5dd8c841e767e09bd8c08764dc2319e?s=128&d=identicon&r=PG&f=1", "display_name": "gtwebb", "link": "https://stackoverflow.com/users/2958401/gtwebb"}, "reply_to_user": {"reputation": 418, "user_id": 5919585, "user_type": "registered", "accept_rate": 87, "profile_image": "https://lh3.googleusercontent.com/-R3HXA5L1CCE/AAAAAAAAAAI/AAAAAAAAAGY/A2G6nHm58EI/photo.jpg?sz=128", "display_name": "Aspiring Developer", "link": "https://stackoverflow.com/users/5919585/aspiring-developer"}, "edited": false, "score": 0, "creation_date": 1461696523, "post_id": 36872157, "comment_id": 61313341, "body": "I didn&#39;t download anything so I guess it came pre-installed.  Just need to add the developer tab which I believe is outlined on the website."}], "tags": [], "owner": {"reputation": 2843, "user_id": 2958401, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/a5dd8c841e767e09bd8c08764dc2319e?s=128&d=identicon&r=PG&f=1", "display_name": "gtwebb", "link": "https://stackoverflow.com/users/2958401/gtwebb"}, "is_accepted": false, "score": 1, "last_activity_date": 1461692791, "creation_date": 1461692791, "answer_id": 36872157, "question_id": 36871471, "link": "https://stackoverflow.com/questions/36871471/excel-2013-64bit-select-date-update/36872157#36872157", "title": "Excel 2013 64bit Select Date - Update", "body": "<p>You can add a embedded object which can be linked to a cell under:</p>\n\n<p>developer tab>Insert>More Controls>Microsoft Date and Time Picker Control.</p>\n\n<p><a href=\"http://smallbusiness.chron.com/insert-calendar-clicking-cell-excel-29766.html\" rel=\"nofollow\">link</a></p>\n"}], "owner": {"reputation": 418, "user_id": 5919585, "user_type": "registered", "accept_rate": 87, "profile_image": "https://lh3.googleusercontent.com/-R3HXA5L1CCE/AAAAAAAAAAI/AAAAAAAAAGY/A2G6nHm58EI/photo.jpg?sz=128", "display_name": "Aspiring Developer", "link": "https://stackoverflow.com/users/5919585/aspiring-developer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 707, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1461692791, "creation_date": 1461690653, "last_edit_date": 1461692736, "question_id": 36871471, "link": "https://stackoverflow.com/questions/36871471/excel-2013-64bit-select-date-update", "title": "Excel 2013 64bit Select Date - Update", "body": "<p>Has anyone heard of any update from Microsoft regarding the ability to add a datepicker (click on a cell and select a date from a calendar) to Excel 2013 64-bit?  I know of the common controls but as far as I know, those do not seem to be compatible.</p>\n\n<p>I searched the forums but could not find a recent post so I wanted to see if there was an update from those.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1461688988, "post_id": 36870630, "comment_id": 61308788, "body": "If you can <a href=\"https://stackoverflow.com/posts/36870630/edit\">edit</a> the title to succinctly explain <i>what the code does</i>, and expand a bit about the surrounding context in the question body, this would be a perfect question for <a href=\"https://codereview.stackexchange.com\">Code Review</a>. As it stands, it&#39;s a bit <i>too broad</i> of a question to be on-topic for Stack Overflow."}, {"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1461689070, "post_id": 36870630, "comment_id": 61308838, "body": "Why do you need to shorten your code? If you get the error &quot;procedure too large&quot; then just break it down into several procedures. And if the module size is exceeded then distribute your code across several modules."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1461689228, "post_id": 36870630, "comment_id": 61308941, "body": "@Ralph If you get the &quot;procedure too large&quot; error, you have much bigger problems, and need to read up a bit on <a href=\"https://en.wikipedia.org/wiki/Single_responsibility_principle\" rel=\"nofollow noreferrer\">SRP</a> ;-)"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1461689407, "post_id": 36870630, "comment_id": 61309050, "body": "What do you mean &quot;for 50 line (linha) intervals&quot;?  I&#39;m guessing this could be accomplished with a loop..."}, {"owner": {"reputation": 23, "user_id": 6191949, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b21623503784017030bef219a4a5fe5?s=128&d=identicon&r=PG&f=1", "display_name": "Anibal", "link": "https://stackoverflow.com/users/6191949/anibal"}, "edited": false, "score": 0, "creation_date": 1461689468, "post_id": 36870630, "comment_id": 61309087, "body": "I&#39;m getting the error because there is a bunch of lines of code. Just don&#39;t put them all here. I think you got it by reading what I wrote."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1461689519, "post_id": 36870630, "comment_id": 61309116, "body": "No, from the comments (mine, and others), the problem is that we <b>don&#39;t</b> understand what you&#39;re asking."}, {"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1461689561, "post_id": 36870630, "comment_id": 61309142, "body": "@Mat&#39;sMug I don&#39;t see how that as applicable to VBA. For all I can tell (and understand from the OP) the above question has already been answered here: <a href=\"http://stackoverflow.com/questions/3751263/procedure-too-large\">stackoverflow.com/questions/3751263/procedure-too-large</a>"}, {"owner": {"reputation": 23, "user_id": 6191949, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b21623503784017030bef219a4a5fe5?s=128&d=identicon&r=PG&f=1", "display_name": "Anibal", "link": "https://stackoverflow.com/users/6191949/anibal"}, "edited": false, "score": 0, "creation_date": 1461689587, "post_id": 36870630, "comment_id": 61309163, "body": "Ralph, You mean by call function, right? I&#39;ve tried but without success.    Something like  End With         End With  Call sublines      End If      Sub sublines()     If (linha &gt;= 20 And linha &lt;= 21) Then (...)"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "reply_to_user": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 1, "creation_date": 1461689643, "post_id": 36870630, "comment_id": 61309200, "body": "@Ralph it&#39;s very likely applicable here. Assuming the contents of the <code>If</code> block can be compartmentalized to another sub/function(s) which accept some arguments."}, {"owner": {"reputation": 23, "user_id": 6191949, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b21623503784017030bef219a4a5fe5?s=128&d=identicon&r=PG&f=1", "display_name": "Anibal", "link": "https://stackoverflow.com/users/6191949/anibal"}, "reply_to_user": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1461689710, "post_id": 36870630, "comment_id": 61309229, "body": "Thanks @Ralph I will take a look"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 2, "creation_date": 1461689987, "post_id": 36870630, "comment_id": 61309415, "body": "Oh wait, is that <code>If linha &gt;= x And linha &lt;= y Then</code> chunk copy+pasted so many times the procedure length actually goes beyond the limit? If so, then yeah @Ralph&#39;s link has your answer, and your question is a bit unclear. That said, if you&#39;re looking for help breaking it down into more manageable pieces and making it more efficient altogether, <a href=\"https://codereview.stackexchange.com\">Code Review</a> remains the place to go."}, {"owner": {"reputation": 23, "user_id": 6191949, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b21623503784017030bef219a4a5fe5?s=128&d=identicon&r=PG&f=1", "display_name": "Anibal", "link": "https://stackoverflow.com/users/6191949/anibal"}, "edited": false, "score": 0, "creation_date": 1461690275, "post_id": 36870630, "comment_id": 61309564, "body": "Yes Mat&#39;sMug  it&#39;s exactly that. I did not know that site. Thanks! I will try the Ralph&#39;s link first."}, {"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1461691422, "post_id": 36870630, "comment_id": 61310240, "body": "I can hardly imagine this small piece of code being too large. I have written far larger procedures."}], "answers": [{"comments": [{"owner": {"reputation": 23662, "user_id": 380384, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/uT3JH.png?s=128&g=1", "display_name": "John Alexiou", "link": "https://stackoverflow.com/users/380384/john-alexiou"}, "edited": false, "score": 1, "creation_date": 1461692991, "post_id": 36871709, "comment_id": 61311103, "body": "Good advice. Seeing 200 lines of code in a single event handler is a pet peeve of mine. An event should always call a verb (method) with only arguments that might change as the program runs."}, {"owner": {"reputation": 23, "user_id": 6191949, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b21623503784017030bef219a4a5fe5?s=128&d=identicon&r=PG&f=1", "display_name": "Anibal", "link": "https://stackoverflow.com/users/6191949/anibal"}, "edited": false, "score": 0, "creation_date": 1461699850, "post_id": 36871709, "comment_id": 61315324, "body": "David Zemens You are the man! Thanks a lot!"}], "tags": [], "owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "is_accepted": true, "score": 1, "last_activity_date": 1461691398, "creation_date": 1461691398, "answer_id": 36871709, "question_id": 36870630, "link": "https://stackoverflow.com/questions/36870630/procedure-too-large-vba-excel/36871709#36871709", "title": "Procedure too large VBA excel", "body": "<p>First, don't put entire functional procedures in an event handler. Put only the minimal code required to route the event to the appropriate procedure. This keeps your event handlers concise, and easier to maintain. The bulk of the work will be happening in additional procedures.</p>\n\n<p>I'll define a new procedure <code>DoStuff</code> which will process the <code>linha</code>s, and the parameters which we send to <code>DoStuff</code> can be controlled within a <code>Case</code> switch.</p>\n\n<p>This way, the <code>DoStuff</code> procedure body doesn't need to be copied 50 times or more, you can simply add to the <code>Case</code> statements in the <code>Worksheet_Change</code> event handler, and making changes (if needed) on the optional parameters.</p>\n\n<pre><code>Private Sub Worksheet_SelectionChange(ByVal Target As Range)\n  Dim foto as Range\n  Dim destino as Range\n  Dim linha As Long\n\n    Set foto = Target.Cells(1)\n    Set destino = Me.Range(\"AU:BC,BN:BV,CG:CO,CZ:DH,DS:EA,EL:ET,FE:FM,FX:GF,GQ:GY,HJ:HR,IC:IK,IV:JD,JO:JW,KH:KP,NF:NN,NY:OG,OR:OZ,PK:PS\")\n    If Not Application.Intersect(foto, destino) Is Nothing Then\n        linha = foto.Row\n    End If\n\n    Select Case linha\n        Case 20, 21\n            Call DoStuff(foto, 1, 9, \"1234\")\n\n        '### Simply add additional \"Case\" statements for each linha pair\n        '    NOTE: You can send different parameters to the DoStuff procedure!\n        Case 22, 23\n            Call DoStuff(foto, 1, 9, \"ABCD\", \"G:\\another path\\Excel\\\", \".xlsb\")\n\n\n        'Etc...\n\n    End Select\n\nEnd Sub\n</code></pre>\n\n<p>Here is the <code>DoStuff</code> procedure. This procedure takes the <code>foto</code> range (or, any range object, technically), and optional parameters (with default values) for <code>password</code>, <code>filepath</code>, <code>fileExt</code> (which are used in the <code>With</code> block).</p>\n\n<pre><code>Sub DoStuff(foto as Range, _\n            Optional fontColor as Long=1, \n            Optional fontSize as Long=9, _\n            Optional password as String=\"1234\", _\n            Optional filePath as String=\"F:\\path\\EXCEL\\\", _\n            Optional fileExt as String=\".xlsx\")\n\n  Dim fname as String\n  Dim pName As String\n  Dim iName As String\n  Dim iNameClean As String\n  Dim iNameExcel As String\n  Dim fNameExcel As String\n\n    If Right(filePath,1) &lt;&gt; \"\\\" Then filePath = filePath &amp; \"\\\"\n\n    fName = Application.GetOpenFilename(\"Picture files (*.jpg;*.gif;*.bmp;*.tif), *.jpgs;*.gif;*.bmp;*.tif\", , _\n    \"Select picture to insert\")\n    iName = Dir(\"\" &amp; fName &amp; \"\")\n    If fName = \"False\" Then Exit Sub\n    iNameClean = Left(iName, Len(iName) - 4)\n    iNameExcel = \"+Info\"\n    fNameExcel = filePath &amp; foto.Offset(1, 3).Value &amp; fileExt\n\n    With foto.Parent 'Worksheet\n        .Unprotect Password:=password\n        .Pictures.Insert(fName).Select\n        With foto.Offset(0,2)\n            .Formula = \"=HYPERLINK(\"\"\" &amp; fName &amp; \"\"\",\"\"\" &amp; iNameClean &amp; \"\"\")\"\n            .Font.ColorIndex = fontColor ' preto\n            .Font.Size = fontSize\n            .Font.Underline = False\n        End With\n        With foto.Offset(0, 3)\n            .Formula = \"=HYPERLINK(\"\"\" &amp; fNameExcel &amp; \"\"\",\"\"\" &amp; iNameExcel &amp; \"\"\")\"\n            .Font.ColorIndex = fontColor ' preto\n            .Font.Size = fontSize\n            .Font.Underline = False\n        End With\n        With Selection.ShapeRange\n            .LockAspectRatio = msoFalse\n            .Height = foto.MergeArea.Height\n            .Width = foto.MergeArea.Width\n            .Top = foto.Top\n            .Left = foto.Left\n        End With\n     .Protect Password:=password\n    End With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 6191949, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b21623503784017030bef219a4a5fe5?s=128&d=identicon&r=PG&f=1", "display_name": "Anibal", "link": "https://stackoverflow.com/users/6191949/anibal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 304, "favorite_count": 0, "closed_date": 1462427938, "accepted_answer_id": 36871709, "answer_count": 1, "score": 0, "last_activity_date": 1461691398, "creation_date": 1461688036, "last_edit_date": 1461689010, "question_id": 36870630, "link": "https://stackoverflow.com/questions/36870630/procedure-too-large-vba-excel", "closed_reason": "Needs details or clarity", "title": "Procedure too large VBA excel", "body": "<p>I need some help to shorten this piece of code.</p>\n\n<p>I need to use this code  <code>If (linha &gt;= 20 And linha &lt;= 21)</code> for 50 line (linha) intervals </p>\n\n<pre><code>Private Sub Worksheet_SelectionChange(ByVal Target As Range)\n  Dim foto As Range\n  Dim destino As Range\n  Dim linha As Long\n  Dim fName As String\n  Dim pName As String\n  Dim iName As String\n  Dim iNameClean As String\n  Dim iNameExcel As String\n  Dim fNameExcel As String\n\n    Set foto = Target.Cells(1)\n    Set destino = Me.Range(\"AU:BC,BN:BV,CG:CO,CZ:DH,DS:EA,EL:ET,FE:FM,FX:GF,GQ:GY,HJ:HR,IC:IK,IV:JD,JO:JW,KH:KP,NF:NN,NY:OG,OR:OZ,PK:PS\")\n    If Not Application.Intersect(foto, destino) Is Nothing Then\n        linha = foto.Row\n\n\n    If (linha &gt;= 20 And linha &lt;= 21) Then\n        With ActiveSheet\n    fName = Application.GetOpenFilename(\"Picture files (*.jpg;*.gif;*.bmp;*.tif), *.jpgs;*.gif;*.bmp;*.tif\", , _\n\"Select picture to insert\")\n            iName = Dir(\"\" &amp; fName &amp; \"\")\n            If fName = \"False\" Then Exit Sub\n            iNameClean = Left(iName, Len(iName) - 4)\n            iNameExcel = \"+Info\"\n            fNameExcel = \"F:\\path\\EXCEL\\\" &amp; foto.Offset(1, 3).Value &amp; \".xlsx\"\n            With ActiveSheet\n            .Unprotect Password:=\"1234\"\n                ActiveSheet.Pictures.Insert(fName).Select\n                foto.Offset(0, 2).Formula = \"=HYPERLINK(\"\"\" &amp; fName &amp; \"\"\",\"\"\" &amp; iNameClean &amp; \"\"\")\"\n                foto.Offset(0, 2).Font.ColorIndex = 1 ' preto\n                foto.Offset(0, 2).Font.Size = 9\n                foto.Offset(0, 2).Font.Underline = False\n                foto.Offset(0, 3).Formula = \"=HYPERLINK(\"\"\" &amp; fNameExcel &amp; \"\"\",\"\"\" &amp; iNameExcel &amp; \"\"\")\"\n                foto.Offset(0, 3).Font.ColorIndex = 1 ' preto\n                foto.Offset(0, 3).Font.Size = 9\n                foto.Offset(0, 3).Font.Underline = False\n                With Selection.ShapeRange\n                    .LockAspectRatio = msoFalse\n                    .Height = ActiveCell.MergeArea.Height\n                    .Width = ActiveCell.MergeArea.Width\n                    .Top = ActiveCell.Top\n                    .Left = ActiveCell.Left\n                End With\n             .Protect Password:=\"1234\"\n            End With\n        End With\n    End If\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 8830, "user_id": 5336948, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/YqCFK.jpg?s=128&g=1", "display_name": "Forward Ed", "link": "https://stackoverflow.com/users/5336948/forward-ed"}, "edited": false, "score": 1, "creation_date": 1461688242, "post_id": 36870560, "comment_id": 61308346, "body": "so if later on I have it stuck in the middle of a for X loop, I would have to redim the array each time.  And by the looks of it when you redim, you are just adjusting the upper index number to a new number.  so I could do <code>redim preserve Arr(0 to X, 0 to 1)</code>."}, {"owner": {"reputation": 8830, "user_id": 5336948, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/YqCFK.jpg?s=128&g=1", "display_name": "Forward Ed", "link": "https://stackoverflow.com/users/5336948/forward-ed"}, "edited": false, "score": 0, "creation_date": 1461688267, "post_id": 36870560, "comment_id": 61308357, "body": "I assume you dropped the Arr by accident in the preserve example?"}, {"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "reply_to_user": {"reputation": 8830, "user_id": 5336948, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/YqCFK.jpg?s=128&g=1", "display_name": "Forward Ed", "link": "https://stackoverflow.com/users/5336948/forward-ed"}, "edited": false, "score": 0, "creation_date": 1461688344, "post_id": 36870560, "comment_id": 61308404, "body": "Yes on both counts. In a loop you would <code>redim preserve</code> each time. And I did accidently drop the <code>Arr</code> in the preserve statement."}, {"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 1, "creation_date": 1461688889, "post_id": 36870560, "comment_id": 61308734, "body": "Wouldn&#39;t it be better to use <code>ReDim Preserve Arr(LBound(Arr) to UBound(Arr) + 1, 0 to 1)</code> instead, to keep the code dynamic?"}, {"owner": {"reputation": 8830, "user_id": 5336948, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/YqCFK.jpg?s=128&g=1", "display_name": "Forward Ed", "link": "https://stackoverflow.com/users/5336948/forward-ed"}, "reply_to_user": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1461689051, "post_id": 36870560, "comment_id": 61308823, "body": "@Ralph I see where you are going with that Ralph. and I do like that option.  Since you are putting in a Lbound reference, does that mean you can have your index for your array elements start at some other number than 0?  can I have my first element at say Arr(3,4) if I needed it to be for some reason?"}, {"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 1, "creation_date": 1461689213, "post_id": 36870560, "comment_id": 61308935, "body": "As far as I know you can only start at 1 or 0 using the <code>Option Base 0</code> or <code>Option Base 1</code> statement: <a href=\"https://msdn.microsoft.com/en-us/library/aa266179(v=vs.60).aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/aa266179(v=vs.60).aspx</a>"}, {"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 1, "creation_date": 1461689239, "post_id": 36870560, "comment_id": 61308948, "body": "<code>Ubound(arr)+</code> can be really handy if you have conditions in your for loop for sitcking the values in the array. This way you don&#39;t have to monkey with two variables (the loop&#39;s variable and the conditional counter). If you aren&#39;t conditionally adding items, then you can save some CPU by just going with the variable."}, {"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 0, "creation_date": 1461689557, "post_id": 36870560, "comment_id": 61309139, "body": "It may depend on the version of excel, but you can dim an array with any integer as the lbound. I&#39;ve never felt the need to stray outside of the very standard and expected 0-based array though. If you are using the index for something more crafty, then it may be time to look into a more robust object like a Collection"}, {"owner": {"reputation": 8830, "user_id": 5336948, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/YqCFK.jpg?s=128&g=1", "display_name": "Forward Ed", "link": "https://stackoverflow.com/users/5336948/forward-ed"}, "edited": false, "score": 0, "creation_date": 1461689918, "post_id": 36870560, "comment_id": 61309357, "body": "@JNevill funny you should mention that as I am actually using two to 3 counters in my loops with conditions to keep track of things.  I am getting another error though on the redim.  I thought it was because I did not have some of my variables defined, but they are..."}, {"owner": {"reputation": 8830, "user_id": 5336948, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/YqCFK.jpg?s=128&g=1", "display_name": "Forward Ed", "link": "https://stackoverflow.com/users/5336948/forward-ed"}, "edited": false, "score": 0, "creation_date": 1461690313, "post_id": 36870560, "comment_id": 61309577, "body": "Not sure how to do this...should I edit the question or post a new question as to why  I am getting an error on redim when I redim with a variable for the new size of the array? ie ( <code>redim preserve Arr(0 to varX, 0 to varY)</code> with both varX and vary being defined as long and value of 2."}, {"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 0, "creation_date": 1461690370, "post_id": 36870560, "comment_id": 61309609, "body": "Probably best to go with a new question. You can reference this question in it if you think it would help."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1461691949, "post_id": 36870560, "comment_id": 61310512, "body": "@JNevill FYI.  Only the last dimension can be adjusted using Redim Preserve."}, {"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1461692204, "post_id": 36870560, "comment_id": 61310656, "body": "Oh VBA. VBA. Why. Thanks @ScottCraner, that hurts my soul."}, {"owner": {"reputation": 8830, "user_id": 5336948, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/YqCFK.jpg?s=128&g=1", "display_name": "Forward Ed", "link": "https://stackoverflow.com/users/5336948/forward-ed"}, "edited": false, "score": 0, "creation_date": 1461702428, "post_id": 36870560, "comment_id": 61316843, "body": "@JNevill  You mentioned Collections earlier.  I was using arrays as I could populate the array in the same positioning as I would for and excel range. X columns and Y rows.  When I look at collections, as far as I understand them, they are a 1 dimensional array essentially.  Is it possible to have a two dimenisional collection that you can imsply add and remove from?"}, {"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 1, "creation_date": 1461703987, "post_id": 36870560, "comment_id": 61317782, "body": "I don&#39;t believe so. Collection is more of a key/value pair type of object. Much like an array, but instead of an index, you can define a key that returns the value for that key. Another option for you might be to dimension your array to the size of the range, load everything (putting blanks at positions where the conditions don&#39;t hit), and then shrink your array to size after you&#39;ve made all the decisions (which will require more coding, but will get the job done). Kind of a two pass approach."}], "tags": [], "owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "is_accepted": true, "score": 1, "last_activity_date": 1461688289, "last_edit_date": 1461688289, "creation_date": 1461687806, "answer_id": 36870560, "question_id": 36870496, "link": "https://stackoverflow.com/questions/36870496/assigning-a-value-to-an-dynamic-array-element-results-in-subscript-out-of-range/36870560#36870560", "title": "Assigning a value to an dynamic array element results in subscript out of range error", "body": "<p>You'll have to dim the array to a size before you use it. This is pretty simple though:</p>\n\n<pre><code>Sub ArrTest()\n    Dim Arr() As Variant\n\n    redim Arr(0 to 1, 0 to 1)\n    Arr(1, 1) = \"Test\"\n\n    redim preserve Arr(0 to 2, 0 to 1)\n    Arr(2, 1) = \"Test2\"\n\nEnd Sub\n</code></pre>\n\n<p>The <code>redim</code> method will redimension your array. Using the keyword <code>Preserve</code> will insure that the data stored in the array is not lost during the redimensioning.</p>\n"}], "owner": {"reputation": 8830, "user_id": 5336948, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/YqCFK.jpg?s=128&g=1", "display_name": "Forward Ed", "link": "https://stackoverflow.com/users/5336948/forward-ed"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 262, "favorite_count": 0, "accepted_answer_id": 36870560, "answer_count": 1, "score": 1, "last_activity_date": 1461688289, "creation_date": 1461687596, "last_edit_date": 1531164843, "question_id": 36870496, "link": "https://stackoverflow.com/questions/36870496/assigning-a-value-to-an-dynamic-array-element-results-in-subscript-out-of-range", "title": "Assigning a value to an dynamic array element results in subscript out of range error", "body": "<pre><code>Sub ArrTest()\nDim Arr() As Variant\n\n    Arr(1, 1) = \"Test\"\n\nEnd Sub\n</code></pre>\n\n<p>I did not dimension the array as I do not know what size it will need to be.  I will eventually be writing this array to a spreadsheet.  I was attempting to assign the upper left hand corner of the cells that would be written in the future as \"test\".</p>\n\n<p>Now if I understand correctly dynamic arrays start to index at 0, so the first element is really Arr(0,0).  I tried Arr(0,0) and got the same error.</p>\n\n<p>I guess the real question is:</p>\n\n<p>How to assign a value to an element of an undefined dynamic array?</p>\n"}, {"tags": ["vba", "row", "ms-word"], "answers": [{"comments": [{"owner": {"reputation": 5143, "user_id": 1779863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/YRfHP.jpg?s=128&g=1", "display_name": "Nereo Costacurta", "link": "https://stackoverflow.com/users/1779863/nereo-costacurta"}, "edited": false, "score": 0, "creation_date": 1461747774, "post_id": 36872612, "comment_id": 61334927, "body": "Magic code! Thank u a lot. Since you seem pretty good in vba, is there a method to know if there are merged cells in the first two rows? Sadly <code>setRangeTable()</code> is called blindly on tables which can have a 1-row header or 2-rows header. by the way if you don&#39;t have the time to answer no problem, this one is good enough for me. I&#39;ll go test."}, {"owner": {"user_type": "does_not_exist", "display_name": "user1379931"}, "reply_to_user": {"reputation": 5143, "user_id": 1779863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/YRfHP.jpg?s=128&g=1", "display_name": "Nereo Costacurta", "link": "https://stackoverflow.com/users/1779863/nereo-costacurta"}, "edited": false, "score": 0, "creation_date": 1461761453, "post_id": 36872612, "comment_id": 61344992, "body": "@NereoCostacurta: You could check for .Cell(2,1) and trap error 5941, for example."}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "reply_to_user": {"reputation": 5143, "user_id": 1779863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/YRfHP.jpg?s=128&g=1", "display_name": "Nereo Costacurta", "link": "https://stackoverflow.com/users/1779863/nereo-costacurta"}, "edited": false, "score": 0, "creation_date": 1461775210, "post_id": 36872612, "comment_id": 61355936, "body": "@NereoCostacurta This would merit a new Question, and please remember to describe the issue in detail, as well as including any code you&#39;ve tried. I don&#39;t have anything I can &quot;shake out of my sleeve&quot; and it&#39;s been a while since I considered the problem..."}], "tags": [], "owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "is_accepted": true, "score": 1, "last_activity_date": 1461694133, "creation_date": 1461694133, "answer_id": 36872612, "question_id": 36870434, "link": "https://stackoverflow.com/questions/36870434/vba-macro-msword-insert-table-header-after-csv-conversion/36872612#36872612", "title": "VBA - macro msword - Insert table header after csv conversion", "body": "<p>Yes, this is a tricky situation. One problem with the code you provide is that you're deleting the table that contains the range with the header; assigning the table header to a variable won't protect it from deletion... Another factor is that you actually need rows 1 and 2, not just 1. And finally, Word won't let you address Rows(index) with merged cells.</p>\n\n<p>The following works for me, in a quick test. The key is that it is possible to pick up the row(s) with the merged cells analogous to how the user can do it, using the keyboard.</p>\n\n<p>Rather than delete the original table (corresponds to <code>tblOriginal</code> in my sample), first, the code works with a second table and only deletes the original one after the header has been copied over. Theoretically, you could use <code>Range.Cut</code> or <code>Range.Copy</code> and later <code>Range.Paste</code>, which would allow you to delete the original table earlier, but generally it's better not to use the Clipboard if another approach is possible.</p>\n\n<p>This means you should insert one or two empty paragraph(s) after the first table, insert the csv there and convert it to a table, assigning it to a variable when you do (corresponds <code>tblTarget</code> in my code sample).</p>\n\n<pre><code>Dim tblOriginal As word.Table\nDim tblTarget As word.Table\nDim rngTblHeader As word.Range\nDim rngTarget As word.Range\n\nSet tblOriginal = ActiveDocument.Tables(1)\nSet rngTblHeader = tblOriginal.Range\n'Range at the beginning of first cell, then extend\nrngTblHeader.Collapse wdCollapseStart\nrngTblHeader.MoveEnd wdRow, 2\n'rngTblHeader.Select 'debug/testing\n\nSet tblTarget = ActiveDocument.Tables(2) 'You use r.ConvertToTable\nSet rngTarget = tblTarget.Range\nrngTarget.Collapse wdCollapseStart\nrngTarget.FormattedText = rngTblHeader.FormattedText\n\ntblOriginal.Delete\n</code></pre>\n"}], "owner": {"reputation": 5143, "user_id": 1779863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/YRfHP.jpg?s=128&g=1", "display_name": "Nereo Costacurta", "link": "https://stackoverflow.com/users/1779863/nereo-costacurta"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 144, "favorite_count": 0, "accepted_answer_id": 36872612, "answer_count": 1, "score": 1, "last_activity_date": 1461694133, "creation_date": 1461687421, "question_id": 36870434, "link": "https://stackoverflow.com/questions/36870434/vba-macro-msword-insert-table-header-after-csv-conversion", "title": "VBA - macro msword - Insert table header after csv conversion", "body": "<p>I'm working on an existing script macro in MSword 2007 (I didn't made it myself, don't blame me for a not so well done code design!).</p>\n\n<p>This script takes SQL results from an ADODB connection and fill (delete and replace to be exact) a series of table at given bookmark, using the CSV conversion.</p>\n\n<p>The task is to preserve the existent header and put all the results in the next rows dynamically. Catch is... the header can be made of merged cells</p>\n\n<p>I'm not going to change a lot of code, and I'm no expert in VBA, but this is what I think should be the workflow:</p>\n\n<ul>\n<li>save the header (which is the \"first\" row of the base table)</li>\n<li>delete whole table</li>\n<li>insert CSV-converted table from the results</li>\n<li>insert header into the new generated table</li>\n</ul>\n\n<p>Copying a row throw error when there are some merged cells. And it seems that VBA can only add empty rows... so probably I cannot \"insert\" the header as is. how can i put this header on the top of the table?</p>\n\n<p><em>help!!!</em></p>\n\n<pre><code>Private Sub setRangeTable(bookmark As String, sqlCmd As String)\n    Dim rs As ADODB.Recordset\n    Dim r As Range\n    Dim t As table\n    Dim c As Column\n    Dim row As row\n    Dim i As Integer\n    'this variable should copy header\n    Dim oldHeader As Range\n    Set r = ActiveDocument.Bookmarks(bookmark).Range\n    With r.Tables(1)\n        ' try to memorize the header (?)\n        oldHeader = .Range(Start:=.Rows(1).Range.Start, _\n            End:=.Rows(1).Range.End)\n    End With\n    r.Tables(1).Delete\n    r.InsertAfter (getTableData(sqlCmd))\n    r.Select\n        r.ConvertToTable Separator:=wdSeparateByTabs, AutoFitBehavior:=wdAutoFitContent\n        r.Tables(1).Rows(1).Select\n        Selection.InsertRowsAbove\nEnd Sub\n</code></pre>\n\n<p>example of existent table</p>\n\n<pre><code>----------------------\n|      |      |     ....    | &lt;&lt; cell of real row 1 \\\n| .... | .... |-------------|                       | &lt;&lt; header\n|      |      | .... | .... | &lt;&lt; cell of real row 2 /\n-----------------------------\n|      |      |      |      | &lt;&lt; all results...\n-----------------------------\n|      |      |      |      | &lt;&lt; all results...\n-----------------------------\n|      |      |      |      | &lt;&lt; all results...\n-----------------------------\n</code></pre>\n"}, {"tags": ["html", "excel", "vba", "webforms"], "comments": [{"owner": {"reputation": 693, "user_id": 4792803, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7abffc13cec9c205a15f6856efe76e0?s=128&d=identicon&r=PG&f=1", "display_name": "C. White", "link": "https://stackoverflow.com/users/4792803/c-white"}, "edited": false, "score": 1, "creation_date": 1461687687, "post_id": 36870251, "comment_id": 61307991, "body": "I would guess that the form is using hidden fields to capture the data. It&#39;s pretty common for a web form to update a hidden field with a value when the visible field is updated, but the event won&#39;t (usually) fire when you change the data programatically.  You should be able to fire whatever function is called by the field being updated in code (using window.eval)."}, {"owner": {"reputation": 64, "user_id": 5379889, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a047066bfcd57d11a3abba014f05ca0?s=128&d=identicon&r=PG", "display_name": "Greg", "link": "https://stackoverflow.com/users/5379889/greg"}, "reply_to_user": {"reputation": 693, "user_id": 4792803, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7abffc13cec9c205a15f6856efe76e0?s=128&d=identicon&r=PG&f=1", "display_name": "C. White", "link": "https://stackoverflow.com/users/4792803/c-white"}, "edited": false, "score": 0, "creation_date": 1461688666, "post_id": 36870251, "comment_id": 61308596, "body": "Thanks C. White. I&#39;ve never used window.eval. Could you provide some guidance? I did find some hidden fields but not enough to have one for each corresponding visible field. here are two that stick out     &lt;input type=&quot;hidden&quot; name=&quot;aeweb_runtimeFormID&quot; id=&quot;aeweb_runtimeFormID&quot; value=&quot;3fcee193-280c-4541-afb1-304926892d83&quot; /&gt; &lt;input type=&quot;hidden&quot; name=&quot;__VIEWSTATE&quot; id=&quot;__VIEWSTATE&quot;"}, {"owner": {"reputation": 693, "user_id": 4792803, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7abffc13cec9c205a15f6856efe76e0?s=128&d=identicon&r=PG&f=1", "display_name": "C. White", "link": "https://stackoverflow.com/users/4792803/c-white"}, "edited": false, "score": 0, "creation_date": 1461875484, "post_id": 36870251, "comment_id": 61411007, "body": "Eval <b>should</b> just call whatever javascript function you pass it (so if you see some sort of event in the main control that fires when you update the control, you could just call it). You should also be able to set <code>aeweb_runtimeFormID</code> to whatever value you need (provided you can figure out what value that is)."}], "owner": {"reputation": 64, "user_id": 5379889, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a047066bfcd57d11a3abba014f05ca0?s=128&d=identicon&r=PG", "display_name": "Greg", "link": "https://stackoverflow.com/users/5379889/greg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 645, "favorite_count": 1, "answer_count": 0, "score": 2, "last_activity_date": 1461689514, "creation_date": 1461686849, "last_edit_date": 1461689514, "question_id": 36870251, "link": "https://stackoverflow.com/questions/36870251/html-form-data-not-recognized-when-clicking-submit-using-vba", "title": "HTML Form Data not Recognized when Clicking Submit using VBA", "body": "<p>I have a form that I'm filling out using data from a spreadsheet. I have everything working correctly, but when I hit submit (either manually or via code), the validation on the site doesn't recognize that the form is filled out. It errors out stating that the text boxes/combo boxes are all blank. How do I refresh so that it knows there is data populated? I apologize in advance if the code is amateurish, but this is my first pass at interacting with web forms.</p>\n\n<p>Here is the code:</p>\n\n<pre><code>Sub AddNewDevice()\n\n    Dim objCollection As Object\n\n    For Each wd In CreateObject(\"Shell.Application\").Windows\n\n        If wd = \"Internet Explorer\" Then\n            If InStr(UCase(wd.document.Title), \"ADD A NEW CISCO ACS\") &lt;&gt; 0 Then\n                'Debug.Print \"Yes\"\n                Exit For\n            End If\n        End If\n    Next wd\n    wd.Visible = True\n\n    Set objCollection = wd.document.getElementsByTagName(\"input\")\n    i = 0\n    While i &lt; objCollection.Length\n        'Name\n        If objCollection(i).Name = \"Y__0__Cctl1_ctl8_ctl2_6_ctl4__X\" Then\n            objCollection(i).Value = Sheets(\"Main\").Range(\"b4\")\n        End If\n        'Description\n        If objCollection(i).Name = \"Y__0__Cctl1_ctl8_ctl2_7_ctl4__X\" Then\n            objCollection(i).Value = Sheets(\"Main\").Range(\"b5\")\n        End If\n        'IP Address/Subnet\n        If objCollection(i).Name = \"Y__0__Cctl1_ctl8_ctl2_11_ctl4__X\" Then\n            objCollection(i).Value = Sheets(\"Main\").Range(\"b6\")\n        End If\n        'TACACS+\n        If objCollection(i).Name = \"Y__0__Cctl1_ctl8_wctl1_2_ColumnEditor1__X\" Then\n            objCollection(i).Click\n        End If\n        'Shared Secret\n        If objCollection(i).Name = \"Y__0__Cctl1_ctl8_wctl1_3_ColumnEditor1__X\" Then\n            objCollection(i).Value = Sheets(\"Main\").Range(\"B22\")\n        End If\n        'Single Connect\n        If objCollection(i).Name = \"Y__0__Cctl1_ctl8_wctl1_4_ColumnEditor1__X\" And _\n            Sheets(\"Main\").Range(\"B25\") = \"Yes\" Then\n            objCollection(i).Click\n        End If\n        'Legacy TACACS+\n        If objCollection(i).Name = \"Y__0__Cctl1_ctl8_wctl1_5_ColumnEditor1__X\" And _\n            Sheets(\"Main\").Range(\"B25\") = \"Yes\" Then\n            objCollection(i).Click\n        End If\n       i = i + 1\n    Wend\n    Set objCollection = Nothing\n    Set objCollection = wd.document.getElementsByTagName(\"select\")\n    i = 0\n    While i &lt; objCollection.Length\n        'Location\n        If objCollection(i).Name = \"Y__0__C22_ctl8_ctl2_8_ctl4_wctl1__X\" Then\n            objCollection(i).selectedIndex = Sheets(\"Main\").Range(\"B23\")\n        End If\n        'Device Type\n        If objCollection(i).Name = \"Y__0__C22_ctl8_ctl2_9_ctl4_wctl1__X\" Then\n            objCollection(i).selectedIndex = Sheets(\"Main\").Range(\"B24\")\n        End If\n        'DSR and Above\n        If objCollection(i).Name = \"Y__0__C22_ctl8_ctl2_10_ctl4_ctl1__X\" Then\n            objCollection(i).selectedIndex = 2\n        End If\n       i = i + 1\n    Wend\n    Set submitButton = wd.document.getElementById(\"Y__0__Cctl10___X\")\n        'submitButton.Click\n    Set objCollection = Nothing\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "loops"], "comments": [{"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 1, "creation_date": 1461685152, "post_id": 36869556, "comment_id": 61306359, "body": "Did you run it on the desired sheet? Because you didn&#39;t qualify your ranges."}, {"owner": {"reputation": 602, "user_id": 4749854, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/e9c0c863ac5565809a701836f90157da?s=128&d=identicon&r=PG&f=1", "display_name": "IIJHFII", "link": "https://stackoverflow.com/users/4749854/iijhfii"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1461685218, "post_id": 36869556, "comment_id": 61306396, "body": "I did! In my full macro I have a Sheets(&quot;&quot;).activate line just before it. Good thought though :)"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 3, "creation_date": 1461685259, "post_id": 36869556, "comment_id": 61306425, "body": "It has to do with If <code>AUMCell.value = &quot;DAAP&quot; &amp; &quot;*&quot;</code> use <code>INSTR(AUMCell.value ,&quot;DAAP&quot;)&gt;0</code> instead.  Or replace the <code>=</code> with <code>Like</code> it may work also."}, {"owner": {"reputation": 602, "user_id": 4749854, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/e9c0c863ac5565809a701836f90157da?s=128&d=identicon&r=PG&f=1", "display_name": "IIJHFII", "link": "https://stackoverflow.com/users/4749854/iijhfii"}, "edited": false, "score": 0, "creation_date": 1461685310, "post_id": 36869556, "comment_id": 61306448, "body": "gimme 2 secs to try this, will report back soon!"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1461685489, "post_id": 36869556, "comment_id": 61306569, "body": "You should avoid code that relies on <code>Select</code> and <code>Activate</code>, and that uses implicit references to the active sheet / workbook. If your worksheet is always going to be the same, use its global identifier instead - e.g. <code>Worksheets(&quot;Sheet1&quot;)</code> usually has a <code>Sheet1</code> object reference that&#39;s right there waiting to be used."}, {"owner": {"reputation": 602, "user_id": 4749854, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/e9c0c863ac5565809a701836f90157da?s=128&d=identicon&r=PG&f=1", "display_name": "IIJHFII", "link": "https://stackoverflow.com/users/4749854/iijhfii"}, "edited": false, "score": 0, "creation_date": 1461685595, "post_id": 36869556, "comment_id": 61306634, "body": "Scott your comment has solved the problem!!!! Thank you so much, Could I ask why the original method with Wildcards was not working?"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1461685882, "post_id": 36869556, "comment_id": 61306820, "body": "When using the <code>=</code> it is looking for an exact.  So it was looking for <code>DAAP*</code> not <code>DAAP</code> and what ever comes after it."}], "answers": [{"tags": [], "owner": {"reputation": 192, "user_id": 1666422, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/c2JIV.jpg?s=128&g=1", "display_name": "Kellsens", "link": "https://stackoverflow.com/users/1666422/kellsens"}, "is_accepted": false, "score": 0, "last_activity_date": 1461686369, "creation_date": 1461686369, "answer_id": 36870079, "question_id": 36869556, "link": "https://stackoverflow.com/questions/36869556/conditional-loop-with-running-sum-is-skipping-values/36870079#36870079", "title": "Conditional loop with running sum is skipping values", "body": "<p>Try to replace this code</p>\n\n<pre><code>For Each AUMCell In rng\n    If AUMCell.value = \"DAAP\" &amp; \"*\" And AUMCell.Offset(0, -5).value = \"\" Then\n        Total = Total + AUMCell.Offset(0, 1).Value\n        AUMCell.value = \"GAAF\"\n    ElseIf AUMCell.value = \"DAAP\" &amp; \"*\" And AUMCell.Offset(0, -5).value &lt;&gt; \"\" Then\n        AUMCell.value = \"GAAF\"\n    End If \nNext AUMCell\n</code></pre>\n\n<p>by this code</p>\n\n<pre><code>For Each AUMCell In rng\n    If AUMCell.value like \"DAAP*\" Then \n        If AUMCell.Offset(0, -5).value = \"\" Then\n            Total = Total + AUMCell.Offset(0, 1).Value\n        End If        \n        AUMCell.value = \"GAAF\"\n    End If\nNext AUMCell\n</code></pre>\n\n<p>P.S.: Sorry my english</p>\n"}, {"tags": [], "owner": {"reputation": 52630, "user_id": 641067, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/n6xVq.png?s=128&g=1", "display_name": "brettdj", "link": "https://stackoverflow.com/users/641067/brettdj"}, "is_accepted": true, "score": 0, "last_activity_date": 1461729065, "creation_date": 1461729065, "answer_id": 36879943, "question_id": 36869556, "link": "https://stackoverflow.com/questions/36869556/conditional-loop-with-running-sum-is-skipping-values/36879943#36879943", "title": "Conditional loop with running sum is skipping values", "body": "<p>While the code is longer the execution of <code>Find</code> will be much quicker than a loop through each cell.</p>\n\n<pre><code>    Sub Recut()\n    Dim rng1 As Range\n    Dim rng2 As Range\n    Dim rng3 As Range\n\n    Dim aCell As Range\n    Dim bCell As Range\n    Dim ws As Worksheet\n    Dim SearchString As String\n\n\n    Set ws = ActiveSheet\n    Set rng1 = ws.Range(\"O:O\")\n\n    SearchString = \"DAAP\"\n\n    Set aCell = rng1.Find(SearchString, , xlFormulas, xlPart, xlByRows, xlNext)\n\n    If Not aCell Is Nothing Then\n        Set bCell = aCell\n        If Left$(aCell.Value, 4) = SearchString Then Set rng2 = aCell\n        Do\n            Set aCell = rng1.FindNext(After:=aCell)\n             If Not aCell Is Nothing Then\n                If aCell.Address = bCell.Address Then Exit Do\n                 If Left$(aCell.Value, 4) = SearchString Then\n                    If Not rng2 Is Nothing Then\n                        Set rng2 = Union(rng2, aCell)\n                    Else\n                        Set rng2 = aCell\n                    End If\n                 End If\n            Else\n                Exit Do\n            End If\n        Loop\n    Else\n        MsgBox SearchString &amp; \" not Found\"\n        Exit Sub\n    End If\n\n    If rng2 Is Nothing Then Exit Sub\n\n    For Each rng3 In rng2\n      If Len(rng3.Offset(0, -5)) = 0 Then Total = Total + rng3.Offset(0, 1).Value\n      rng3.Value = \"GAFF\"\n    Next\n\n    MsgBox Total\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 602, "user_id": 4749854, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/e9c0c863ac5565809a701836f90157da?s=128&d=identicon&r=PG&f=1", "display_name": "IIJHFII", "link": "https://stackoverflow.com/users/4749854/iijhfii"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 50, "favorite_count": 0, "accepted_answer_id": 36879943, "answer_count": 2, "score": 1, "last_activity_date": 1461729065, "creation_date": 1461685000, "question_id": 36869556, "link": "https://stackoverflow.com/questions/36869556/conditional-loop-with-running-sum-is-skipping-values", "title": "Conditional loop with running sum is skipping values", "body": "<p>I have created this code with the purpose of:</p>\n\n<p><strong>First Loop:</strong></p>\n\n<ul>\n<li>Loop through cells in <code>column O</code> to find anything that starts with <code>DAAP</code>. </li>\n<li>If Cell 5 columns left of <code>DAAP</code> is empty then add the cell 1 column to the right (which is a number) to <code>Total</code>. Then rename the cell to <code>GAAF</code></li>\n<li>If Cell 5 columns left is not empty then just rename the cell to <code>GAAF</code></li>\n</ul>\n\n<p><strong>Second Loop:</strong></p>\n\n<ul>\n<li>Find all <code>GAAF</code> cells in <code>column O</code> and then change the cell 1 column to the right to <code>Total</code></li>\n</ul>\n\n<p>Here is the code I have, it runs with no errors but just does nothing. I'm assuming something is syntax'ed wrong so it's looking in the wrong place but I can't find it! Any help is greatly appreciated :)</p>\n\n<pre><code>Dim rng As Range\nDim lstRow As Long\nDim AUMCell As Range\nDim Total As Long\n\nlstRow = Cells(Rows.Count, \"O\").End(xlUp).Row\n\nSet rng = Range(\"O2\", Cells(lstRow, \"O\"))\n\nTotal = 0\n\nFor Each AUMCell In rng\n    If AUMCell.value = \"DAAP\" &amp; \"*\" And AUMCell.Offset(0, -5).value = \"\" Then\n        Total = Total + AUMCell.Offset(0, 1).Value\n        AUMCell.value = \"GAAF\"\n    ElseIf AUMCell.value = \"DAAP\" &amp; \"*\" And AUMCell.Offset(0, -5).value &lt;&gt; \"\" Then\n        AUMCell.value = \"GAAF\"\n    End If\nNext AUMCell\n\nFor Each AUMCell In rng\n    If AUMCell.Value = \"GAAF\" Then\n        AUMCell.Offset(0, 1).Value = Total\n    End If\nNext AUMCell\n</code></pre>\n"}]