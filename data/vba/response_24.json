[{"tags": ["excel", "vba", "macos"], "comments": [{"owner": {"reputation": 1396, "user_id": 1337635, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pVMWU.png?s=128&g=1", "display_name": "joehanna", "link": "https://stackoverflow.com/users/1337635/joehanna"}, "edited": false, "score": 0, "creation_date": 1435292169, "post_id": 31038984, "comment_id": 50149468, "body": "Did my answer solve your problem?  The random chars in the name would make the <code>Workbooks(form).Close</code> fail. I also just noticed that your <code>Sort</code> statement is referencing 2 different worksheets when you specify the keys.  Notice <code>Sheets(2)</code> and <code>Sheets(1)</code>"}], "answers": [{"tags": [], "owner": {"reputation": 1396, "user_id": 1337635, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pVMWU.png?s=128&g=1", "display_name": "joehanna", "link": "https://stackoverflow.com/users/1337635/joehanna"}, "is_accepted": false, "score": 0, "last_activity_date": 1435196943, "last_edit_date": 1435196943, "creation_date": 1435196632, "answer_id": 31039864, "question_id": 31038984, "link": "https://stackoverflow.com/questions/31038984/workbook-renaming-when-opened/31039864#31039864", "title": "Workbook renaming when opened", "body": "<p>Instead of using <code>Workbooks(form)</code> to access the data, you should simply use <code>ActiveWorkbook</code> after you have opened each file.  You can also close the open workbook with <code>ActiveWorkbook.Close</code></p>\n\n<p>You could also define a variable like this:-  <code>Dim wb As Workbook</code> and then assign the variable with the opened workbook like this:-</p>\n\n<p><code>set wb = Workbooks.Open (\"Macintosh HD:Users:user:Documents:Folder:\" &amp; form)</code></p>\n\n<p>Then you can reference the workbook using <code>wb</code>.  e.g.</p>\n\n<pre><code>Workbooks(\"Inventory.xlsm\").Sheets(2).Cells(counter, 1).Value = wb.Sheets(1).Range(\"D3\").Value\n</code></pre>\n\n<p>and then close it like this:-</p>\n\n<pre><code>wb.Close\n</code></pre>\n\n<p>Don't forget to be a good resource citizen and release the memory with this at the end:</p>\n\n<pre><code>set wb = Nothing\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 5046698, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c37b7ed0ffdaf73c8e6c7b3b75539b8?s=128&d=identicon&r=PG&f=1", "display_name": "RRR", "link": "https://stackoverflow.com/users/5046698/rrr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 830, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1593759014, "creation_date": 1435189544, "last_edit_date": 1593759014, "question_id": 31038984, "link": "https://stackoverflow.com/questions/31038984/workbook-renaming-when-opened", "title": "Workbook renaming when opened", "body": "<p>I am writing a module that opens each workbook in a folder and copies some information from it. It runs smoothly on most files in the folder, but some workbooks appear with different names when opened by the module. My code is as follows</p>\n\n<pre><code>Sub AutoUpdate()\nApplication.ScreenUpdating = False\nApplication.DisplayAlerts = False\nSheets(1).Cells(1, 10).Value = Now()\n'refreshes timestamp\nDim counter As Integer\nDim form\nform = Dir(\"Macintosh HD:Users:user:Documents:Folder:\")\n'Finds first form in folder\ncounter = 1\nDo Until form = \"\"\n    Workbooks.Open (\"Macintosh HD:Users:user:Documents:Folder:\" &amp; form)\n    Workbooks(\"Inventory.xlsm\").Sheets(2).Cells(counter, 1).Value = Workbooks(form).Sheets(1).Range(\"D3\").Value\n    Workbooks(\"Inventory.xlsm\").Sheets(2).Cells(counter, 2).Value = Workbooks(form).Sheets(1).Range(\"D5\").Value\n    Workbooks(\"Inventory.xlsm\").Sheets(2).Cells(counter, 3).Value = Workbooks(form).Sheets(1).Range(\"D1\").Value\n    Workbooks(\"Inventory.xlsm\").Sheets(2).Cells(counter, 4).Value = Workbooks(form).Sheets(1).Range(\"D2\").Value\n    Workbooks(\"Inventory.xlsm\").Sheets(2).Cells(counter, 5).Value = Workbooks(form).Sheets(1).Range(\"L69\").Value\n    Workbooks(\"Inventory.xlsm\").Sheets(2).Cells(counter, 6).Value = Workbooks(form).Sheets(1).Range(\"K36\").Value\n    Workbooks(\"Inventory.xlsm\").Sheets(2).Cells(counter, 7).Value = Workbooks(form).Sheets(1).Range(\"C37\").Value\n    Workbooks(form).Close\n    counter = counter + 1\n    form = Dir\n    'cycles through all forms\nLoop\nWorkbooks(\"Inventory.xlsm\").Sheets(2).Range(\"A:G\").Sort Key1:=Workbooks(\"Inventory.xlsm\").Sheets(2).Range(\"A:A\"), Order1:=xlAscending, Key2:=Workbooks(\"Inventory.xlsm\").Sheets(1).Range(\"C:C\"), Order2:=xlAscending, Orientation:=xlSortRows\nApplication.ScreenUpdating = True\nApplication.DisplayAlerts = False\nEnd Sub\n</code></pre>\n\n<p>This pulls the data from the first 45 workbooks, then returns \"runtime error 9 subscript out of range.\" The open workbook appears with the name reading as the file name with two seemingly random digits appended. When I manually open the file the name reads as the file name.</p>\n"}, {"tags": ["vba", "outlook", "office365", "ms-office", "outlook-addin"], "answers": [{"tags": [], "owner": {"reputation": 5418, "user_id": 519226, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/dSD4J.jpg?s=128&g=1", "display_name": "Eric Legault", "link": "https://stackoverflow.com/users/519226/eric-legault"}, "is_accepted": false, "score": 0, "last_activity_date": 1435209351, "creation_date": 1435209351, "answer_id": 31041729, "question_id": 31038916, "link": "https://stackoverflow.com/questions/31038916/outlook-search-for-folder-name/31041729#31041729", "title": "Outlook Search for Folder Name", "body": "<p>Unfortunately, there is no way to search for a folder. It would be a pretty simple add-in to build too.  I swear they had something like this in Outlook 97 or 2000...</p>\n"}, {"comments": [{"owner": {"reputation": 9, "user_id": 5017751, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6bc58b06a5b691c37c374d71b9e345e8?s=128&d=identicon&r=PG&f=1", "display_name": "kanda", "link": "https://stackoverflow.com/users/5017751/kanda"}, "edited": false, "score": 0, "creation_date": 1435298952, "post_id": 31042352, "comment_id": 50151804, "body": "can you be more specific about the macro... the search bar was not a requirement, it was an idealisation"}, {"owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "reply_to_user": {"reputation": 9, "user_id": 5017751, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6bc58b06a5b691c37c374d71b9e345e8?s=128&d=identicon&r=PG&f=1", "display_name": "kanda", "link": "https://stackoverflow.com/users/5017751/kanda"}, "edited": false, "score": 0, "creation_date": 1435697227, "post_id": 31042352, "comment_id": 50306658, "body": "You need to walk along the folder tree programmatically to find the required folder."}, {"owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "reply_to_user": {"reputation": 9, "user_id": 5017751, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6bc58b06a5b691c37c374d71b9e345e8?s=128&d=identicon&r=PG&f=1", "display_name": "kanda", "link": "https://stackoverflow.com/users/5017751/kanda"}, "edited": false, "score": 0, "creation_date": 1435753193, "post_id": 31042352, "comment_id": 50330769, "body": "You need to develop a VBA macro or add-in for Outlook. See my answer for more information. The Folder class provides the Folders property which returns the Folders collection that represents all the folders contained in the specified Folder."}], "tags": [], "owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "is_accepted": false, "score": 0, "last_activity_date": 1435212176, "creation_date": 1435212176, "answer_id": 31042352, "question_id": 31038916, "link": "https://stackoverflow.com/questions/31038916/outlook-search-for-folder-name/31042352#31042352", "title": "Outlook Search for Folder Name", "body": "<p>The simplest way is to develop a VBA macro. See <a href=\"https://msdn.microsoft.com/en-us/library/office/ee814736%28v=office.14%29.aspx?f=255&amp;MSPPError=-2147217396\" rel=\"nofollow\">Getting Started with VBA in Outlook 2010</a> for more information. </p>\n\n<p>But the Outlook extensibility model doesn't provide anything for placing a search bar on top of the Navigation pane. You need to use Windows API functions to inject your own form with controls anywhere in the Outlook Explorer window. See <a href=\"http://blogs.msdn.com/b/stephen_griffin/archive/2010/06/01/adjacent-windows-in-outlook.aspx\" rel=\"nofollow\">Adjacent Windows In Outlook</a> and <a href=\"https://code.msdn.microsoft.com/windowsdesktop/Creating-Adjacent-Windows-00090e4a\" rel=\"nofollow\">Creating Adjacent Windows In Outlook</a> to get started. </p>\n"}], "owner": {"reputation": 9, "user_id": 5017751, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6bc58b06a5b691c37c374d71b9e345e8?s=128&d=identicon&r=PG&f=1", "display_name": "kanda", "link": "https://stackoverflow.com/users/5017751/kanda"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 392, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1593306201, "creation_date": 1435189076, "last_edit_date": 1593306201, "question_id": 31038916, "link": "https://stackoverflow.com/questions/31038916/outlook-search-for-folder-name", "title": "Outlook Search for Folder Name", "body": "<p>Is there a way to quickly search for the name of a folder in outlooks inbox folder structure?</p>\n\n<p>I am talking about this:</p>\n\n<p><a href=\"http://i.imgur.com/p1LhdRS.png\" rel=\"nofollow\">http://i.imgur.com/p1LhdRS.png</a></p>\n\n<p>Ideally this would be in the form of a search bar above the folder structure. \nI am asking this because I need to categorize emails into these folders as they arrive.</p>\n\n<p>We are running our own Exchange and I am using Outlook over rdp\n<a href=\"http://i.stack.imgur.com/wZDKS.png\" rel=\"nofollow\">http://i.stack.imgur.com/wZDKS.png</a></p>\n"}, {"tags": ["vba", "ms-access-2013"], "comments": [{"owner": {"reputation": 168120, "user_id": 102937, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/1233ec65168f4aae4d939ae8fe6cde1e?s=128&d=identicon&r=PG", "display_name": "Robert Harvey", "link": "https://stackoverflow.com/users/102937/robert-harvey"}, "edited": false, "score": 0, "creation_date": 1435188608, "post_id": 31038809, "comment_id": 50101488, "body": "I suspect <code>As Variant</code> to be the source of the difficulty.  That should probably be <code>As POKEMON_VERSION</code>"}, {"owner": {"reputation": 14205, "user_id": 449902, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/e4d02d2f0d957567d161d72e18d40292?s=128&d=identicon&r=PG", "display_name": "rlb.usa", "link": "https://stackoverflow.com/users/449902/rlb-usa"}, "reply_to_user": {"reputation": 168120, "user_id": 102937, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/1233ec65168f4aae4d939ae8fe6cde1e?s=128&d=identicon&r=PG", "display_name": "Robert Harvey", "link": "https://stackoverflow.com/users/102937/robert-harvey"}, "edited": false, "score": 0, "creation_date": 1435189135, "post_id": 31038809, "comment_id": 50101618, "body": "@RobertHarvey I&#39;m new at VBA but when I try <code>Const pokemonVersion As POKEMON_VERSION = POKEMON_VERSION.GOLD_SILVER</code>, I get the error message <code>Compile error: Expected: type name</code>"}], "answers": [{"comments": [{"owner": {"reputation": 14205, "user_id": 449902, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/e4d02d2f0d957567d161d72e18d40292?s=128&d=identicon&r=PG", "display_name": "rlb.usa", "link": "https://stackoverflow.com/users/449902/rlb-usa"}, "edited": false, "score": 0, "creation_date": 1435190313, "post_id": 31039039, "comment_id": 50101908, "body": "Okay, so Case version=GOLD_SILVER always fails, even though version=2 and GOLD_SILVER=2, interestingly enough. I think it has to do with types. BUT Case GOLD_SILVER succeeds! Very, very interesting."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "reply_to_user": {"reputation": 14205, "user_id": 449902, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/e4d02d2f0d957567d161d72e18d40292?s=128&d=identicon&r=PG", "display_name": "rlb.usa", "link": "https://stackoverflow.com/users/449902/rlb-usa"}, "edited": false, "score": 1, "creation_date": 1435190916, "post_id": 31039039, "comment_id": 50102061, "body": "@rib.usa - That&#39;s because <code>version = [anything]</code> is <code>True</code>, but <code>version</code> is a number, not a boolean. It&#39;s like testing <code>If 2 = True Then &#39;...</code>"}], "tags": [], "owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "is_accepted": true, "score": 2, "last_activity_date": 1435189851, "creation_date": 1435189851, "answer_id": 31039039, "question_id": 31038809, "link": "https://stackoverflow.com/questions/31038809/how-to-compare-enums/31039039#31039039", "title": "How to compare enums?", "body": "<p>The problem has nothing to do with the <code>Const</code> or the <code>Enum</code>.  It has to do with your <code>Select</code> syntax.  You are selecting based on <code>version</code>, so the cases need to be members of the enumeration.  When you do this (parentheses added for clarity)...</p>\n\n<pre><code>Case (version = RED_BLUE_YELLOW)\n</code></pre>\n\n<p>...it evaluates to this...</p>\n\n<pre><code>Case (version = 1)\n</code></pre>\n\n<p>...so if you pass it a <code>RED_BLUE_YELLOW</code> for <code>version</code>, you get...</p>\n\n<pre><code>Case (1 = 1)\n</code></pre>\n\n<p>...which is:</p>\n\n<pre><code>Case True\n    '...\nCase False\n    '...\nCase False\n'etc.\n</code></pre>\n\n<p>You can either change the <code>Select</code> to switch on <code>True</code>...</p>\n\n<pre><code>Public Function Get_Pokemon(version As POKEMON_VERSION) As String\n    Select Case True\n        Case version = RED_BLUE_YELLOW\n            ' don't get ability or nature, didn't exist in this version\n             Get_Pokemon = \"SELECT * FROM ...\"\n        Case version = GOLD_SILVER\n             Get_Pokemon = \"SELECT * FROM ...\"\n    End Select\nEnd Function\n</code></pre>\n\n<p>...or use the much clearer and working syntax below:</p>\n\n<pre><code>Public Function Get_Pokemon(version As POKEMON_VERSION) As String\n    Select Case version\n        Case RED_BLUE_YELLOW\n            ' don't get ability or nature, didn't exist in this version\n             Get_Pokemon = \"SELECT * FROM ...\"\n        Case GOLD_SILVER\n             Get_Pokemon = \"SELECT * FROM ...\"\n    End Select\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 14205, "user_id": 449902, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/e4d02d2f0d957567d161d72e18d40292?s=128&d=identicon&r=PG", "display_name": "rlb.usa", "link": "https://stackoverflow.com/users/449902/rlb-usa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1087, "favorite_count": 0, "accepted_answer_id": 31039039, "answer_count": 1, "score": 1, "last_activity_date": 1435189851, "creation_date": 1435188385, "question_id": 31038809, "link": "https://stackoverflow.com/questions/31038809/how-to-compare-enums", "title": "How to compare enums?", "body": "<p>I'm having a lot of trouble checking if my enums are equal.</p>\n\n<p>My enum is declared like this:</p>\n\n<pre><code>Public Enum POKEMON_VERSION\n    RED_BLUE_YELLOW = 1\n    GOLD_SILVER = 2\n    ...\nEnd Enum\n</code></pre>\n\n<p>My form is like this:</p>\n\n<pre><code>Const pokemonVersion As Variant = POKEMON_VERSION.GOLD_SILVER\nPublic Sub Search_ButtonClick()\n    Dim sql As String\n    sql = Get_Pokemon(pokemonVersion ) 'which is GOLD_SILVER\n    Me.mySubform.Form.RecordSource = sql\n    Me.mySubform.Requery\nEnd Sub \n</code></pre>\n\n<p>Here's the method I'm having a problem with, my switch statement:</p>\n\n<pre><code>  Public Function Get_Pokemon( version As Variant ) As String\n     Select Case version\n          Case version = RED_BLUE_YELLOW\n              ' don't get ability or nature, didn't exist in this version\n               Get_Pokemon = \"SELECT * FROM ...\" \n          Case version = GOLD_SILVER\n               Get_Pokemon = \"SELECT * FROM ...\"\n     End Select\n  End Function\n</code></pre>\n\n<p>But when I run the program, it finds that <code>version</code> is not matched in any of my cases (in this example, should match GOLD_SILVER). I think the problem may be that I'm comparing a <code>Variant</code> to an <code>Enum</code>'s \"value\".</p>\n\n<p>How do I fix this?</p>\n\n<p>I'd wouldn't mind changing the type of my <code>Const pokemonVersion</code>, but the Enum's \"value\" does need to be stored in a <code>Const</code> variable, and this was the best I could figure out. </p>\n"}, {"tags": ["c#", "vba", "vsto", "excel-dna"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1435193119, "post_id": 31038649, "comment_id": 50102602, "body": "This is why I come to Stack Overflow and not Google Groups..."}, {"owner": {"reputation": 5397, "user_id": 8678, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/5Bgli.jpg?s=128&g=1", "display_name": "tbone", "link": "https://stackoverflow.com/users/8678/tbone"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1435207559, "post_id": 31038649, "comment_id": 50105882, "body": "That&#39;s what I don&#39;t get.  To be fair, the thread originally started in 2011, but the question posted on Oct 14, 2014 is still struggling with this, and he is coming <i>from</i> c#, so why he can&#39;t just get the Range reference directly I don&#39;t understand.  Maybe his addin is Excel-DNA based rather than VSTO?  Does that even make sense? I am just learning this so have no clue."}, {"owner": {"reputation": 5397, "user_id": 8678, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/5Bgli.jpg?s=128&g=1", "display_name": "tbone", "link": "https://stackoverflow.com/users/8678/tbone"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1435207699, "post_id": 31038649, "comment_id": 50105923, "body": "Actually, Govert doesn&#39;t know what that guy&#39;s talking about either now that I reread it....lol"}], "answers": [{"comments": [{"owner": {"reputation": 5397, "user_id": 8678, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/5Bgli.jpg?s=128&g=1", "display_name": "tbone", "link": "https://stackoverflow.com/users/8678/tbone"}, "edited": false, "score": 0, "creation_date": 1435256508, "post_id": 31047222, "comment_id": 50136895, "body": "thanks for the incredibly comprehensive answer, exactly what I was wanting to know.  I would very much like to learn more on the specific COM considerations you mentioned, any links you might have handy would be most appreciated. (&quot;You don&#39;t want to build process to directly register your .dll as the COM server for your XLServer.MyClass COM type, but rather have the .xll serve as the COM server. That will ensure your COM objects live in the same AppDomain as the rest of the add-in.&quot;)"}, {"owner": {"reputation": 15406, "user_id": 44264, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60d941e5d68ed49560a678a4f37c2bbb?s=128&d=identicon&r=PG", "display_name": "Govert", "link": "https://stackoverflow.com/users/44264/govert"}, "reply_to_user": {"reputation": 5397, "user_id": 8678, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/5Bgli.jpg?s=128&g=1", "display_name": "tbone", "link": "https://stackoverflow.com/users/8678/tbone"}, "edited": false, "score": 0, "creation_date": 1435257336, "post_id": 31047222, "comment_id": 50137366, "body": "Suppose you have some kind of cache that you want to share between the worksheet UDFs and the COM objects used from VBA. Then it&#39;s much easier to share if the UDF part and the COM objects are in the same AppDomain. Registering the .dll for COM access on its own will cause the .NET runtime to activate it in the default AppDomain, while the Excel-DNA add-in runs in its own AppDomain. Also - the Excel-DNA registration does not require Admin rights."}, {"owner": {"reputation": 1803, "user_id": 166231, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/e1d586387b3a13caa0e7540f47e98f92?s=128&d=identicon&r=PG", "display_name": "Terry", "link": "https://stackoverflow.com/users/166231/terry"}, "edited": false, "score": 0, "creation_date": 1449627712, "post_id": 31047222, "comment_id": 56086701, "body": "Is there ever a reason to <i>not</i> use ExcelAynscUtil.QueueAsMacro in the Ribbon callback?  I want to use COM and C API both, and wrapping call to my function in QueueAsMacro allows me to use XlCall.Excel( XlCall.xlfGetCell, 53, reference ).  If I didn&#39;t use that, I couldn&#39;t figure out a way to call that function successfully.  My Ribbon/AddIn hooks to application events and needs to maintain a bit of state in some of the handlers, so making all my call backs static so Application.Run() could be used on them became too complicated."}, {"owner": {"reputation": 1803, "user_id": 166231, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/e1d586387b3a13caa0e7540f47e98f92?s=128&d=identicon&r=PG", "display_name": "Terry", "link": "https://stackoverflow.com/users/166231/terry"}, "edited": false, "score": 0, "creation_date": 1449629868, "post_id": 31047222, "comment_id": 56087283, "body": "Also, when an error is thrown from the QueueAsMacro delegate, who catches that exception?  It doesn&#39;t appear to be my Ribbon callback nor my ExcelIntegration.RegisterUnhandledExceptionHandler() method."}], "tags": [], "owner": {"reputation": 15406, "user_id": 44264, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60d941e5d68ed49560a678a4f37c2bbb?s=128&d=identicon&r=PG", "display_name": "Govert", "link": "https://stackoverflow.com/users/44264/govert"}, "is_accepted": true, "score": 8, "last_activity_date": 1435257138, "last_edit_date": 1592644375, "creation_date": 1435226704, "answer_id": 31047222, "question_id": 31038649, "link": "https://stackoverflow.com/questions/31038649/passing-an-excel-range-from-vba-to-c-via-excel-dna/31047222#31047222", "title": "Passing an Excel.Range from VBA to C# via Excel-DNA", "body": "<p>Yes, it's the right way to do it, as long as you:</p>\n<ol>\n<li><p>are sure your library project is <strong>not</strong> marked as &quot;Register for COM interop&quot;. You don't want to build process to directly register your .dll as the COM server for your <code>XLServer.MyClass</code> COM type, but rather have the .xll serve as the COM server. That will ensure your COM objects live in the same AppDomain as the rest of the add-in.</p>\n</li>\n<li><p>add the <code>ComServer</code> attribute to the <code>&lt;ExternalLibrary&gt;</code> tag in the .dna file, thus as</p>\n<p><code>&lt;ExternalLibrary Path=&quot;XlServer.dll&quot; ComServer=&quot;true&quot; ... /&gt;</code>.</p>\n</li>\n<li><p>take care of all the COM interface versioning rules.</p>\n</li>\n</ol>\n<p>The best references on the topic are the walk-through articles by Mikael Katajam\u00e4ki, which I presume you found:</p>\n<ul>\n<li><a href=\"http://mikejuniperhill.blogspot.fi/2014/03/interfacing-c-and-vba-with-exceldna-no.html\" rel=\"noreferrer\">http://mikejuniperhill.blogspot.fi/2014/03/interfacing-c-and-vba-with-exceldna-no.html</a></li>\n<li><a href=\"http://mikejuniperhill.blogspot.fi/2014/03/interfacing-c-and-vba-with-exceldna_16.html\" rel=\"noreferrer\">http://mikejuniperhill.blogspot.fi/2014/03/interfacing-c-and-vba-with-exceldna_16.html</a></li>\n</ul>\n<hr />\n<p>Now for some background to give some context to the Google group discussion:</p>\n<p>Most of the Excel-DNA internals is concerned with the Excel C API (as defined by the Excel SDK) which is great for making high-performance worksheet UDFs. In this setting, the C API structure that describes a worksheet reference is wrapper in the <code>ExcelDna.Integration.ExcelReference</code> type. This is a small data structure that wraps a sheet pointer (called the SheetId), and the extents of the reference. <code>ExcelReference</code> objects can be safely used in multi-threaded UDFs, and can be passed back-and-forth to the C API. Excel-DNA worksheet functions can be configured to receive <code>ExcelReference</code> objects as input, when appropriate.</p>\n<p>The <code>Range</code> COM object is quite a different thing. It is a COM object wrapper around such a sheet reference, subject to all the COM threading, lifetime and other restrictions. Microsoft does not support using the COM object model (and hence the <code>Range</code> objects) inside UDF functions defined in an .xll, and while it mostly works, trying to use these in multi-threaded functions is likely to cause serious trouble.</p>\n<p>Inside a macro or ribbon callback (as async triggered macro that is run started by <code>ExcelAsyncUtil.QueueAsMacro</code>) that you put in an Excel-DNA add-in, you can safely use both the C API and the COM object model.</p>\n<p>Converting from an thin <code>ExcelReference</code> object to a COM <code>Range</code> object is mot so hard, though it depends on whether you want to support multi-area ranges. If not, it's as simple as:</p>\n<pre><code>static Range ReferenceToRange(ExcelReference xlref)\n{\n    string refText = (string)XlCall.Excel(XlCall.xlfReftext, xlref, true);\n    dynamic app = ExcelDnaUtil.Application;\n    return app.Range[refText];\n} \n</code></pre>\n<p>The only reason this helper is not part of the <code>ExcelReference</code> type is that Excel-DNA still support .NET 2.0, and the COM type unification that would make sense of this is only available since .NET 4.0</p>\n"}], "owner": {"reputation": 5397, "user_id": 8678, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/5Bgli.jpg?s=128&g=1", "display_name": "tbone", "link": "https://stackoverflow.com/users/8678/tbone"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4901, "favorite_count": 2, "accepted_answer_id": 31047222, "answer_count": 1, "score": 2, "last_activity_date": 1435257138, "creation_date": 1435187302, "last_edit_date": 1435191008, "question_id": 31038649, "link": "https://stackoverflow.com/questions/31038649/passing-an-excel-range-from-vba-to-c-via-excel-dna", "title": "Passing an Excel.Range from VBA to C# via Excel-DNA", "body": "<p>I'm working on figuring out how the proper/best way to pass Excel.Range objects from VBA in Excel to C# via Excel-DNA, and then interacting with the Excel object model via that passed reference.</p>\n\n<p>Sample code:</p>\n\n<pre><code>    '***************** VBA code ********************\n    Sub test2()\n        Dim rng As Excel.Range\n        Set rng = Worksheets(\"test_output\").Range(\"D9\")\n\n        Dim myDLL As New XLServer.MyClass\n        Call myDLL.test_ExcelRangePassedAsObject(rng)\n        Call myDLL.test_ExcelRangePassedAsRange(rng)\n    End Sub\n\n\n\n//**************** C# Code **********************\nusing System;\nusing ExcelDna.Integration;\nusing ExcelDna.ComInterop;\nusing System.Runtime.InteropServices;\nusing Microsoft.Office.Interop;\nusing Excel = Microsoft.Office.Interop.Excel;\n\nnamespace XLServer\n{\n    [ComVisible(false)]\n    class ExcelAddin : IExcelAddIn\n    {\n        public void AutoOpen()\n        {\n            ComServer.DllRegisterServer();\n        }\n        public void AutoClose()\n        {\n            ComServer.DllUnregisterServer();\n        }\n    }    \n\n    [ComVisible(true)]\n    [ClassInterface(ClassInterfaceType.AutoDual)]\n    public class MyClass                            \n    {\n        public void test_ExcelRangePassedAsObject(object range)\n        {\n            Excel.Range rng = (Excel.Range)range;\n            rng.Worksheet.Cells[1, 1].Value = \"Specified range was: \" + rng.Address.ToString();\n        }\n\n        public void test_ExcelRangePassedAsRange(Excel.Range range)\n        {\n            Excel.Range rng = range;\n            rng.Worksheet.Cells[2, 1].Value = \"Specified range was: \" + rng.Address.ToString();\n        }\n</code></pre>\n\n<p>And when I run this, I get the expected output:<br>\nA1: Specified range was: $D$9<br>\nA2: Specified range was: $D$9</p>\n\n<p>After spending a significant amount of time googling Excel-DNA questions and coming up with nothing, I just wrote this and was actually surprised that it worked with no issues.  </p>\n\n<p>So I guess my question is to those who are experienced in this...<strong>is this the proper/best way to go about it?</strong></p>\n\n<p>For example, I came across many posts similar to this:<br>\n<a href=\"https://groups.google.com/forum/#!topic/exceldna/zqzEIos7ma0\" rel=\"nofollow\">https://groups.google.com/forum/#!topic/exceldna/zqzEIos7ma0</a></p>\n\n<p>....where people were dealing with <code>ExcelReference</code> objects and having to use incredibly obscure code to convert those into <code>Excel.Range</code> objects and it almost feels like there's something I'm missing?</p>\n"}, {"tags": ["vba", "excel", "ms-access", "ms-access-2013"], "comments": [{"owner": {"reputation": 9743, "user_id": 2127508, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24b1d5bcb39ec4baad76d20c66506318?s=128&d=identicon&r=PG", "display_name": "barrowc", "link": "https://stackoverflow.com/users/2127508/barrowc"}, "edited": false, "score": 1, "creation_date": 1435199500, "post_id": 31038446, "comment_id": 50103934, "body": "Not sure if Access works the same way but when using ADO against an Excel sheet the column types are guessed from the first eight rows and a tie results in a numeric type being chosen - see the &quot;A Caution about Mixed Data Types&quot; section <a href=\"https://support.microsoft.com/en-us/kb/257819\" rel=\"nofollow noreferrer\">here</a> The workaround in ADO is to ensure that at least five of the first eight rows contain the desired type of data (text, in this case). Not sure if this will also work in Access"}, {"owner": {"reputation": 1207, "user_id": 3524158, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/eNErY.png?s=128&g=1", "display_name": "mountainclimber11", "link": "https://stackoverflow.com/users/3524158/mountainclimber11"}, "reply_to_user": {"reputation": 9743, "user_id": 2127508, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24b1d5bcb39ec4baad76d20c66506318?s=128&d=identicon&r=PG", "display_name": "barrowc", "link": "https://stackoverflow.com/users/2127508/barrowc"}, "edited": false, "score": 0, "creation_date": 1435238921, "post_id": 31038446, "comment_id": 50124521, "body": "@barrowc - The only way to override that &quot;first 8 rows&quot; rule is to have a schema.ini file?"}, {"owner": {"reputation": 9743, "user_id": 2127508, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24b1d5bcb39ec4baad76d20c66506318?s=128&d=identicon&r=PG", "display_name": "barrowc", "link": "https://stackoverflow.com/users/2127508/barrowc"}, "edited": false, "score": 1, "creation_date": 1435267089, "post_id": 31038446, "comment_id": 50142405, "body": "I think schema.ini only works for text files but you could give it a try. It might be easier to export the Excel worksheet to a CSV file and then use schema.ini with the CSV file. The reference for schema.ini is <a href=\"https://msdn.microsoft.com/en-us/library/ms709353(v=vs.85).aspx\" rel=\"nofollow noreferrer\">here</a>"}], "owner": {"reputation": 1207, "user_id": 3524158, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/eNErY.png?s=128&g=1", "display_name": "mountainclimber11", "link": "https://stackoverflow.com/users/3524158/mountainclimber11"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 108, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1435186048, "creation_date": 1435186048, "last_edit_date": 1495542139, "question_id": 31038446, "link": "https://stackoverflow.com/questions/31038446/shouldnt-text-to-columns-convert-to-text-for-ms-access-when-fieldinfo-is-set-co", "title": "Shouldn&#39;t text to columns convert to text for MS Access when FieldInfo is set correctly in TextToColumns?", "body": "<p>Hello I am iterating through all of my columns in an Excel workbook and TextToColumns'ing them so MS Access will bring them in as the data type that I want; however, it doesn't seem to be working for one should-be short text field.</p>\n\n<p>The field in question has the field name \"test\" then 10 blank cells then the text \"test\" in rows 11 - 13 then blanks again etc. I.e. a lot of blank cells and a few short text strings.</p>\n\n<pre><code>With w.sheet(\"x\")\n\n  'I go through some logic to set variables c to a column number and\n  'iFormatType to either 2 for text, which is what I use for the \"test\" field, or 1 for general\n\n.Columns(c).TextToColumns Destination:=.Cells(1, r.Column), DataType:=xlDelimited, _\n            TextQualifier:=xlDoubleQuote, _\n            ConsecutiveDelimiter:=False, Tab:=True, _\n            Semicolon:=False, Comma:=False, Space:=False, Other:=False, _\n            FieldInfo:=Array(1, iFormatType), TrailingMinusNumbers:=True\n\nend with\n</code></pre>\n\n<p>As mentioned in the comments iFormatType = 2 for field \"test\" when I step through it. </p>\n\n<p>Later, I import the workbook into MS Access like this:</p>\n\n<pre><code>DoCmd.TransferSpreadsheet acImport, , \"tbl_DatedModel_\" &amp; sSomeVariableHere, \"some file path here\", True\n</code></pre>\n\n<p>Field \"test\" should be a text field and it is a double. What am I doing wrong? Or is this just a limitation and I should move to using Schema.ini files (which I have not used)?</p>\n\n<p>I have also tried this by manually importing it via the MS Access ribbon controls and I get the same result.</p>\n\n<p>Here is a related questions for more background: <a href=\"https://stackoverflow.com/questions/30947160/vba-excel-to-access-zero-length-string-to-null-number\">vba Excel to Access: zero length string to Null number</a></p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "edited": false, "score": 0, "creation_date": 1435192386, "post_id": 31038295, "comment_id": 50102435, "body": "There are a few issues with your code: 1. You are using x without an initial value (ThisValue = Cells(x, 4).Value) 2. NextRow should be &quot;FinalRow + 1&quot; instead of finding the last row again 3. It&#39;s not pasting the data: just copy, then select destination range"}], "answers": [{"comments": [{"owner": {"reputation": 47, "user_id": 5046492, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-GwNcINEw594/AAAAAAAAAAI/AAAAAAAAACw/bqyuTtvN-es/photo.jpg?sz=128", "display_name": "Jonathan", "link": "https://stackoverflow.com/users/5046492/jonathan"}, "edited": false, "score": 0, "creation_date": 1435255606, "post_id": 31040551, "comment_id": 50136343, "body": "Thank you for this, it&#39;s a great start.  However, I&#39;m running into a bug and my rudimentary VBA skills aren&#39;t enough for me to figure out where it&#39;s coming from.  When I run the script, it creates the new sheet with formatted titles correctly.  However, it pulls only the first sheet from the case argument instead of working on all the named sheets, and inserts the data from Col A on the original sheet into <i>both</i> Cols A and B on the Course Code sheet.  I think it might have something to do with the ranges but the syntax you gave me is a bit beyond my skill level.  Any insight?  Thanks again."}, {"owner": {"reputation": 47, "user_id": 5046492, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-GwNcINEw594/AAAAAAAAAAI/AAAAAAAAACw/bqyuTtvN-es/photo.jpg?sz=128", "display_name": "Jonathan", "link": "https://stackoverflow.com/users/5046492/jonathan"}, "edited": false, "score": 0, "creation_date": 1435261494, "post_id": 31040551, "comment_id": 50139639, "body": "I am extracting from a subset of all sheets.  Thank you immensely for your help, I&#39;ve learned more about VBA from this problem than I have in all my basic macro-writing."}, {"owner": {"reputation": 47, "user_id": 5046492, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-GwNcINEw594/AAAAAAAAAAI/AAAAAAAAACw/bqyuTtvN-es/photo.jpg?sz=128", "display_name": "Jonathan", "link": "https://stackoverflow.com/users/5046492/jonathan"}, "edited": false, "score": 0, "creation_date": 1435264156, "post_id": 31040551, "comment_id": 50140963, "body": "I think the issue is arising because I am trying to pull the data from tables on these sheets.  What do you think?"}, {"owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "reply_to_user": {"reputation": 47, "user_id": 5046492, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-GwNcINEw594/AAAAAAAAAAI/AAAAAAAAACw/bqyuTtvN-es/photo.jpg?sz=128", "display_name": "Jonathan", "link": "https://stackoverflow.com/users/5046492/jonathan"}, "edited": false, "score": 0, "creation_date": 1435273706, "post_id": 31040551, "comment_id": 50145012, "body": "I improved my test file and fixed the issues you mentioned (tables don&#39;t affect data extraction - I just converted my 3 test sheets to tables and it works the same). I also added more comments describing the steps"}, {"owner": {"reputation": 47, "user_id": 5046492, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-GwNcINEw594/AAAAAAAAAAI/AAAAAAAAACw/bqyuTtvN-es/photo.jpg?sz=128", "display_name": "Jonathan", "link": "https://stackoverflow.com/users/5046492/jonathan"}, "edited": false, "score": 0, "creation_date": 1435276292, "post_id": 31040551, "comment_id": 50145745, "body": "I tweaked a couple things here and there - was getting a bunch of extra rows and some error values (no idea from where, couldn&#39;t find them in any table) but those are easy to trim off.  This looks great!  Thank you Paul!"}, {"owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "reply_to_user": {"reputation": 47, "user_id": 5046492, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-GwNcINEw594/AAAAAAAAAAI/AAAAAAAAACw/bqyuTtvN-es/photo.jpg?sz=128", "display_name": "Jonathan", "link": "https://stackoverflow.com/users/5046492/jonathan"}, "edited": false, "score": 0, "creation_date": 1435277983, "post_id": 31040551, "comment_id": 50146158, "body": "To keep the code short I used an inaccurate way of determining the last row: the &quot;UsedRange&quot; method returns rows and columns with hidden or invisible data (like font formatting, row height, empty formulas, etc). To get the last row with data in column A, you could update the line <b><code>last1 = thisWS.UsedRange.Rows.Count</code></b> to this <b><code>last1 = thisWS.Cells(thisWS.Rows.Count, 1).End(xlUp).Row</code></b> (fully qualified)"}], "tags": [], "owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "is_accepted": true, "score": 1, "last_activity_date": 1435273356, "last_edit_date": 1435273356, "creation_date": 1435201691, "answer_id": 31040551, "question_id": 31038295, "link": "https://stackoverflow.com/questions/31038295/compiling-columns-into-single-workworksheet/31040551#31040551", "title": "Compiling Columns into Single Workworksheet", "body": "<p>This will append data from Col A &amp; D on all Sheets, to a new \"Course Codes\" sheet, Col A &amp; B</p>\n\n<hr>\n\n<pre><code>Option Explicit\n\nSub getData()\n\n    Const OFFSET        As Byte = 2\n    Const COL1_NAME     As String = \"Category\"\n    Const COL2_NAME     As String = \"Course Codes\"\n    Const SHEET_NAMES   As String = \"Category1,Category2,Category3,Category4,Category5,Category6\"\n\n    Dim thisWS  As Worksheet\n    Dim destWS  As Worksheet\n    Dim last1   As Long\n    Dim last2   As Long\n    Dim rng     As Range\n\n    Application.DisplayAlerts = False   'turn off sheet deletion warning\n    Application.ScreenUpdating = False  'turn off display\n\n    For Each thisWS In ActiveWorkbook.Worksheets    'look for sheet \"Course Codes\"\n        If thisWS.Name = COL2_NAME Then\n            thisWS.Delete                           'if found, delete it\n            Exit For\n        End If\n    Next\n    Set destWS = Worksheets.Add(Sheets(1))          'create a new sheet \"Course Codes\"\n    With destWS\n        .Name = COL2_NAME\n        .Cells(1, 1).Value = COL1_NAME              'add header \"Category\"\n        .Cells(1, 2).Value = COL2_NAME              'add header \"Course Codes\"\n        With .UsedRange.Rows(1)\n            .HorizontalAlignment = xlCenter         'header alignment: center\n            .Font.Bold = True                       'header font: bold\n            .Interior.Color = RGB(222, 222, 222)    'header cell background: grey\n        End With\n    End With\n\n    last2 = OFFSET                                  'first row on \"Course Codes\"\n\n    For Each thisWS In ActiveWorkbook.Worksheets    'check all sheets if in SHEET_NAMES\n\n        If InStr(1, SHEET_NAMES, thisWS.Name, vbBinaryCompare) &gt; 0 Then\n\n            last1 = thisWS.UsedRange.Rows.Count     'last row of current sheet\n\n            If last1 &gt; OFFSET Then                  'if the sheet has more than 2 rows\n\n               'Col A - Destination sheet: destWS.Cells(Row, Col)\n                Set rng = destWS.Range( _\n                                        destWS.Cells(last2, 1), _\n                                        destWS.Cells(last1 + last2 - OFFSET, 1))\n\n                rng.Value = thisWS.Range(\"A2:\" &amp; \"A\" &amp; last1).Value  'copy Col A to A\n\n               'Col B - Destination sheet: destWS.Cells(Row, Col)\n                Set rng = destWS.Range( _\n                                        destWS.Cells(last2, 2), _\n                                        destWS.Cells(last1 + last2 - OFFSET, 2))\n\n                rng.Value = thisWS.Range(\"D2:\" &amp; \"D\" &amp; last1).Value  'copy Col D to B\n\n                last2 = last2 + last1 - 1   'increment offset by (total copied rows - 1)\n            End If\n        End If\n    Next\n    destWS.UsedRange.Columns.AutoFit        'resize columns to fit the widest text\n    Application.DisplayAlerts = True\n    Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p><img src=\"https://i.stack.imgur.com/2nKTt.png\" alt=\"Compiling Columns\"></p>\n"}], "owner": {"reputation": 47, "user_id": 5046492, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-GwNcINEw594/AAAAAAAAAAI/AAAAAAAAACw/bqyuTtvN-es/photo.jpg?sz=128", "display_name": "Jonathan", "link": "https://stackoverflow.com/users/5046492/jonathan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 90, "favorite_count": 0, "accepted_answer_id": 31040551, "answer_count": 1, "score": 1, "last_activity_date": 1435273356, "creation_date": 1435185248, "last_edit_date": 1435186883, "question_id": 31038295, "link": "https://stackoverflow.com/questions/31038295/compiling-columns-into-single-workworksheet", "title": "Compiling Columns into Single Workworksheet", "body": "<p>I need to copy paired course codes and respective categories from two non-adjacent columns on several worksheets onto a single worksheet compiling all pairs.  </p>\n\n<p>One course may fall into three or four categories and exist on three or four worksheets and I need a unique observation for each one of these.  </p>\n\n<p>I have other worksheets as well, so I can't simply use something like </p>\n\n<pre><code>Select Case sh.Name\nCase Is &lt;&gt; \"All Course Codes\"\n</code></pre>\n\n<p>Nor can I use a hard-coded range for any given worksheet, as they are all different and often changing.  The data is in columns A and D consistently, though.  I have very little knowledge of VBA, so I've cobbled together this from various sources:</p>\n\n<pre><code>Dim sh As Worksheet\nDim DestSh As Worksheet\nDim LastRow As Long\n\nActiveWorkbook.Worksheets(\"Course Codes\").Delete\n\nSet DestSh = ActiveWorkbook.Worksheets.Add\nDestSh.Name = \"Course Codes\"\nDestSh.Cells(1, 1).Value = \"Category\"\nDestSh.Cells(1, 2).Value = \"Course Code\"\n\nFor Each sh In ActiveWorkbook.Worksheets\n    Select Case sh.Name\n    Case \"Category1\", \"Category2\", \"Category3\", \"Category4\", \"Category5\", \"Category6\"\n\n        FinalRow = Cells(Rows.Count, 1).End(xlUp).Row\n        ThisValue = Cells(x, 4).Value\n        NextRow = Cells(Rows.Count, 1).End(xlUp).Row + 1\n\n        For x = 2 To FinalRow\n            If ThisValue &lt;&gt; \"\" Then\n            Cells(x, 1).Copy\n            Destination DestSh.Cells(NextRow, 1).Select\n            End If\n        Next\n    End Select\nNext\nEnd Sub\n</code></pre>\n\n<p>To explain, I am attempting to select each sheet by name, then run down column D and copy the data from A and D to columns A and B on the new sheet as long as there is a value in D on the data sheet.  </p>\n\n<p>Once it runs out of values, it would progress onto the next sheet, appending the new copies to the bottom of the list on the \"Course Codes\" compilation sheet.</p>\n\n<p>The macro runs, creates the new sheet, and titles the columns correctly.  It does not copy any of the desired information into this new sheet, however.  What mistake am I making here?</p>\n\n<p>Thank you in advance for your help, and let me know if there is any information I am missing to get an accurate answer.</p>\n"}, {"tags": ["vba", "vb6"], "answers": [{"tags": [], "owner": {"reputation": 145, "user_id": 5020414, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xzf9L.png?s=128&g=1", "display_name": "KMan", "link": "https://stackoverflow.com/users/5020414/kman"}, "is_accepted": true, "score": 0, "last_activity_date": 1435224484, "creation_date": 1435224484, "answer_id": 31046330, "question_id": 31037536, "link": "https://stackoverflow.com/questions/31037536/trouble-with-shape-append-on-vb6/31046330#31046330", "title": "Trouble with shape append on VB6", "body": "<p>Put a messagebox between your load or set data source statement and 'Report.show' statement. I vaguely remember this issue. If it works you can then change the messagebox to something like DoEvents or Wait.</p>\n"}], "owner": {"reputation": 95, "user_id": 5046350, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/ab724c3fb30812ced77341824f65d0cd?s=128&d=identicon&r=PG&f=1", "display_name": "Carlos Lopez", "link": "https://stackoverflow.com/users/5046350/carlos-lopez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 151, "favorite_count": 0, "accepted_answer_id": 31046330, "answer_count": 1, "score": 0, "last_activity_date": 1435224484, "creation_date": 1435181860, "last_edit_date": 1435182588, "question_id": 31037536, "link": "https://stackoverflow.com/questions/31037536/trouble-with-shape-append-on-vb6", "title": "Trouble with shape append on VB6", "body": "<p>I'm working on VB6 and I try to create an report, for create this report I'm using shape with 3 levels.</p>\n\n<pre><code>\"SHAPE APPEND \" &amp; _\n    \"  New adVarChar(15) As zoneId,\" &amp; _\n    \"  New adVarChar(15) As zoneNam,\" &amp; _\n        \"  ((SHAPE APPEND \" &amp; _\n            \"  New adVarChar(30) As ID, New adVarChar(30) As costumerName,\" &amp; _\n           \"  ((SHAPE APPEND \" &amp; _\n                \"  New adVarChar(15) As productCode, New adVarChar(25) As produtName, New product(30) As product,\" &amp; _\n                \"  New adVarChar(30) As price,\" &amp; _\n                \"  New addouble As disount)\" &amp; _\n                \"  RELATE productCode to productCode) AS COST)\" &amp; _\n            \"  RELATE zoneId to zoneId) As FECHAS\", _\n    \"Provider=MSDataShape;Data Provider=None\"\n</code></pre>\n\n<p>This code run and don't show error but in execution time don't show data and the query test work perfect. I'm making the report using the vb designer and the data's bind using DataField and DataMember names on an array.</p>\n\n<p>Example:</p>\n\n<pre><code>rsCostumersZone.addNew Array(\"ZONEID\", \"ZONENAME\"), (rsDataZone!tbz_id, rsDataZone!tbz_name)\n</code></pre>\n\n<p>I appreciate any hint on the error.</p>\n"}, {"tags": ["excel", "vba", "add-in"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1435185672, "post_id": 31037517, "comment_id": 50100641, "body": "What&#39;s the file size of the .xlam you want to store in the workbook?"}], "answers": [{"comments": [{"owner": {"reputation": 558, "user_id": 4686873, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/e8ed25ac033b2a31f8d90013d39089ce?s=128&d=identicon&r=PG&f=1", "display_name": "Ihidan", "link": "https://stackoverflow.com/users/4686873/ihidan"}, "edited": false, "score": 0, "creation_date": 1435245704, "post_id": 31041513, "comment_id": 50130153, "body": "I won&#180;t be sure where my client will store the workbook file. I am looking for a single file solution so I will be sure that when I send the add-in my client will be able to open the workbook."}], "tags": [], "owner": {"reputation": 117, "user_id": 4115567, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2bdac4434725493543ded427cc082fce?s=128&d=identicon&r=PG&f=1", "display_name": "DevBW", "link": "https://stackoverflow.com/users/4115567/devbw"}, "is_accepted": false, "score": 0, "last_activity_date": 1435208262, "creation_date": 1435208262, "answer_id": 31041513, "question_id": 31037517, "link": "https://stackoverflow.com/questions/31037517/store-a-workbook-within-an-xlam-file/31041513#31041513", "title": "Store a Workbook within an xlam file", "body": "<p>Add the VBA below to your macro to open the workbook from a specific filepath..</p>\n\n<pre><code>Workbooks.Open \"\\\\someNetworkDrive\\myworkbook.xlsx\"\n\nor \n\nWorkbooks.Open \"C:\\myworkbook.xlsx\"\n</code></pre>\n\n<p>Assuming your .xlam is enabled in your add-in manager, your add-in code will be available from anywhere in your Excel instance.  </p>\n"}], "owner": {"reputation": 558, "user_id": 4686873, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/e8ed25ac033b2a31f8d90013d39089ce?s=128&d=identicon&r=PG&f=1", "display_name": "Ihidan", "link": "https://stackoverflow.com/users/4686873/ihidan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 152, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1435208262, "creation_date": 1435181774, "question_id": 31037517, "link": "https://stackoverflow.com/questions/31037517/store-a-workbook-within-an-xlam-file", "title": "Store a Workbook within an xlam file", "body": "<p>There is a workbook which I need to attach to a .xlam file, so when a macro is run the workbook will be shown. Is it possible to do it by \"attaching\" this workbook to the xlam? </p>\n\n<p>I know I could add sheet with visible property set to false, but in this case my VBE editor would become very messy and would be very hard to create all those sheets again in the xlam file.     </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 1, "creation_date": 1435181830, "post_id": 31037502, "comment_id": 50099090, "body": "You have to explicitly declare variable types for <b>every</b> variable.  Your line <code>P, W, R, V As ConfigDataType</code> only declares <code>V</code>, all of the others (P, W, and R) are defaulting to <code>Variant</code> instead of ConfigDataType"}, {"owner": {"reputation": 11, "user_id": 5045579, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/W9ST1.jpg?s=128&g=1", "display_name": "Chet", "link": "https://stackoverflow.com/users/5045579/chet"}, "reply_to_user": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1435182216, "post_id": 31037502, "comment_id": 50099275, "body": "Aha.  So the right syntax is more like <code>Sub GetParams(byRef P as ConfigDataType, W as ConfigDataType...</code>, etc?  Does the initial Dim work as I expect it to, i.e. does it create ProjCol, WBSCol, ValCol, and ResCol as variables of type ConfigDataType?"}, {"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 1, "creation_date": 1435182429, "post_id": 31037502, "comment_id": 50099379, "body": "For your first question: Yes, that is the correct syntax.  For your second question: No, the same logic applies and you would still need to declare every variable type explicitly"}, {"owner": {"reputation": 11, "user_id": 5045579, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/W9ST1.jpg?s=128&g=1", "display_name": "Chet", "link": "https://stackoverflow.com/users/5045579/chet"}, "reply_to_user": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1435182727, "post_id": 31037502, "comment_id": 50099537, "body": "Ah, apparently not. I&#39;ll mark this answered. Thanks very much!"}], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 5045579, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/W9ST1.jpg?s=128&g=1", "display_name": "Chet", "link": "https://stackoverflow.com/users/5045579/chet"}, "is_accepted": false, "score": 1, "last_activity_date": 1435182975, "creation_date": 1435182975, "answer_id": 31037831, "question_id": 31037502, "link": "https://stackoverflow.com/questions/31037502/baffling-object-required-issue/31037831#31037831", "title": "Baffling &quot;Object Required&quot; issue", "body": "<p>TigerAvatar immediately saw my problem. I was assuming a line like</p>\n\n<pre><code>Dim foo, bar, bash, baz as ConfigType\n</code></pre>\n\n<p>would result in four variables of type ConfigType, but that's not the case. Only the last one is; the rest are of type variant. The correct usage is apparently</p>\n\n<pre><code>Dim foo as ConfigDataType, bar as ConfigDataType, bash as ConfigDataType, bas as ConfigDataType\n</code></pre>\n\n<p>and that extends to the definition of the sub, too, which would correctly be written</p>\n\n<pre><code>Sub GetParameters(ByRef P as ConfigDataType, W as ConfigDataType, R as ConfigDataType, V As ConfigDataType)\n</code></pre>\n\n<p>Once I fixed both of those issues, the code worked as I expected. Thanks again to Tigeravatar for such a prompt answer.</p>\n"}], "owner": {"reputation": 11, "user_id": 5045579, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/W9ST1.jpg?s=128&g=1", "display_name": "Chet", "link": "https://stackoverflow.com/users/5045579/chet"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 29, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1435183425, "creation_date": 1435181712, "last_edit_date": 1435183425, "question_id": 31037502, "link": "https://stackoverflow.com/questions/31037502/baffling-object-required-issue", "title": "Baffling &quot;Object Required&quot; issue", "body": "<p>It's entirely possible -- probable, even -- that I'm missing something here, but for the life of me I can't figure out what.</p>\n\n<p>I have a situation where I need a user defined structure (or a class, I guess, but I'm trying to stay simple) to carry two related bits of data: the column name and column number where certain data lives.</p>\n\n<p>However, when I run the code, I get an \"object required\" error on the first assignment attempt:</p>\n\n<p>Here's the truncated listing:</p>\n\n<pre><code>Public Type ConfigDataType\n    ltr As String\n    nbr As Integer\nEnd Type\n\nSub MacroWorkbookName()\n    Dim ProjCol, WBSCol, ResCol, ValCol As ConfigDataType\n    Call GetParameters(ProjCol, WBSCol, ResCol, ValCol)\nEnd Sub\n\nSub GetParameters(ByRef P, W, R, V As ConfigDataType)\n\n    Dim MacroWorkBook As String\n    MacroWorkBook = ThisWorkbook.Name\n\n    ' The next line triggers the error\n    P.ltr = Workbooks(MacroWorkBook).Sheets(\"Configuration\").Cells(6, 3)\n    W.ltr = Workbooks(MacroWorkBook).Sheets(\"Configuration\").Cells(7, 3)\n    R.ltr = Workbooks(MacroWorkBook).Sheets(\"Configuration\").Cells(8, 3)\n    V.ltr = Workbooks(MacroWorkBook).Sheets(\"Configuration\").Cells(9, 3)\n\nEnd Sub\n</code></pre>\n\n<p>I'm either fundamentally misunderstanding something about VBA syntax, or I've missed some braindead error. </p>\n\n<p>It's also possible I'm going about this All Wrong in terms of idiomatic Excel automation, in which case I also welcome nudges towards the True Path - the client will presumably use this for a while, and I'd hate for them to think ill of me for deploying crappy code.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1435181700, "post_id": 31037468, "comment_id": 50099027, "body": "Need to change your syntax: <code>Set x = Workbooks.Open(&quot;C:\\Exportbook.xlsx&quot;, UpdateLinks:=xlUpdateLinksUserSetting)</code>"}, {"owner": {"reputation": 97, "user_id": 2220670, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/fcfa2cc3938d159894f9dd5677b2a87e?s=128&d=identicon&r=PG", "display_name": "user2220670", "link": "https://stackoverflow.com/users/2220670/user2220670"}, "reply_to_user": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1435181900, "post_id": 31037468, "comment_id": 50099116, "body": "I&#39;ve tried that. I get compile error: expected end of statement even before I run it"}, {"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1435181987, "post_id": 31037468, "comment_id": 50099161, "body": "The &quot;expected end of statement&quot; error has nothing to do with that specific line.  It means you are missing an <code>End With</code> or <code>Next</code> or <code>Loop</code>, or <code>End If</code> or similar somewhere in your code.  I&#39;d have to see your code to give a better answer"}, {"owner": {"reputation": 97, "user_id": 2220670, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/fcfa2cc3938d159894f9dd5677b2a87e?s=128&d=identicon&r=PG", "display_name": "user2220670", "link": "https://stackoverflow.com/users/2220670/user2220670"}, "reply_to_user": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1435182246, "post_id": 31037468, "comment_id": 50099292, "body": "Sub Comments() Dim x As Workbook Dim y As Workbook  Set x = Workbooks.Open(&quot;C:\\Exportbook.xlsx&quot;),UpdateLinks:=xlUpdateLi&zwnj;&#8203;nksUserSetting Set y = ThisWorkbook  x.Sheets(&quot;Tablets&quot;).Range(&quot;E10:AQ2000&quot;).Copy  y.Sheets(&quot;Tablets&quot;).Range(&quot;E10:AQ2000&quot;).PasteSpecial Paste:=xlPasteComments  x.Close SaveChanges:=False  End Sub    It ran fine until I added the updatelink part"}, {"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1435182728, "post_id": 31037468, "comment_id": 50099539, "body": "Do you see how you have the wrong placement for the ending parenthesis?  From your shown code: <code>Workbooks.Open(&quot;C:\\Exportbook.xlsx&quot;),UpdateLinks:=xlUpdateLi&zwnj;&#8203;nksUserSetting</code>"}, {"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 1, "creation_date": 1435182742, "post_id": 31037468, "comment_id": 50099543, "body": "Needs to be as I showed above: <code>Workbooks.Open(&quot;C:\\Exportbook.xlsx&quot;, UpdateLinks:=xlUpdateLinksUserSetting)</code>"}, {"owner": {"reputation": 97, "user_id": 2220670, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/fcfa2cc3938d159894f9dd5677b2a87e?s=128&d=identicon&r=PG", "display_name": "user2220670", "link": "https://stackoverflow.com/users/2220670/user2220670"}, "reply_to_user": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1435183461, "post_id": 31037468, "comment_id": 50099826, "body": "Missed that.  Sorry.  Thanks.  Need to pay better attention. I just saw the :=.  thanks again.  It did work."}], "owner": {"reputation": 97, "user_id": 2220670, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/fcfa2cc3938d159894f9dd5677b2a87e?s=128&d=identicon&r=PG", "display_name": "user2220670", "link": "https://stackoverflow.com/users/2220670/user2220670"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 277, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1435187281, "creation_date": 1435181559, "last_edit_date": 1435187281, "question_id": 31037468, "link": "https://stackoverflow.com/questions/31037468/compile-error-type-mismatch", "title": "Compile Error type mismatch", "body": "<p>I am getting type mismatch when running this code even though I didn't get an error when I wrote it below:</p>\n\n<pre><code>Set x = Workbooks.Open(\"C:\\Exportbook.xlsx\").UpdateLinks = xlUpdateLinksUserSetting\n</code></pre>\n\n<p>or even</p>\n\n<pre><code>Set x = Workbooks.Open(\"C:\\Exportbook.xlsx\").UpdateLinks = xlUpdateLinksNever\n</code></pre>\n\n<hr>\n\n<pre><code>Sub Comments()\n    Dim x As Workbook\n    Dim y As Workbook\n\n    Set x = Workbooks.Open(\"C:\\Exportbook.xlsx\"),UpdateLinks:=xlUpdateLinksUserSetting\n    Set y = ThisWorkbook x.Sheets(\"Tablets\").Range(\"E10:AQ2000\").Copy\n\n    y.Sheets(\"Tablets\").Range(\"E10:AQ2000\").PasteSpecial Paste:=xlPasteComments\n    x.Close SaveChanges:=False\n\nEnd Sub\n</code></pre>\n\n<p>It ran fine until I added the updatelink part</p>\n"}, {"tags": ["vba", "excel", "excel-formula"], "comments": [{"owner": {"reputation": 7770, "user_id": 2142028, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ltfco.jpg?s=128&g=1", "display_name": "Maciej Los", "link": "https://stackoverflow.com/users/2142028/maciej-los"}, "edited": false, "score": 2, "creation_date": 1435180838, "post_id": 31037124, "comment_id": 50098630, "body": "What exactly have you tried?"}, {"owner": {"reputation": 1804, "user_id": 754147, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OQkUn.jpg?s=128&g=1", "display_name": "prmottajr", "link": "https://stackoverflow.com/users/754147/prmottajr"}, "edited": false, "score": 0, "creation_date": 1435181452, "post_id": 31037124, "comment_id": 50098914, "body": "Even with the fiddle it is not clear what you want to accomplish."}, {"owner": {"reputation": 6115, "user_id": 2074605, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/vTHal.png?s=128&g=1", "display_name": "vallismortis", "link": "https://stackoverflow.com/users/2074605/vallismortis"}, "edited": false, "score": 1, "creation_date": 1435186703, "post_id": 31037124, "comment_id": 50100945, "body": "Please provide an example of what you consider to be an inconsistent pair vs. a &quot;consistent pair&quot;."}, {"owner": {"reputation": 3, "user_id": 5040812, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0b2ea5cef767720d41aeb6570e784e80?s=128&d=identicon&r=PG&f=1", "display_name": "Joseph R", "link": "https://stackoverflow.com/users/5040812/joseph-r"}, "edited": false, "score": 0, "creation_date": 1435241920, "post_id": 31037124, "comment_id": 50127023, "body": "I tried searching for duplicates, but that only gives me values on one column, like <a href=\"http://www.excel-easy.com/examples/find-duplicates.html\" rel=\"nofollow noreferrer\">right here</a>. A consistant pair would consist of, for instance if you look at the fiddle: Bananas is associated with &#39;Y&#39; three times. Also, &#39;Nuts&#39; has the same value pair in both E and F as well as A and B. I meant to highlight Oranges and Steaksauce not the apricot part.I have updated the Fiddle here: <a href=\"https://jsfiddle.net/0qvj73ua/1/\" rel=\"nofollow noreferrer\">jsfiddle.net/0qvj73ua/1</a>. You can see how both Oranges and Steaksauce are inconsistent. I am comparing the first 2 values throughout the worksheet."}, {"owner": {"reputation": 3, "user_id": 5040812, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0b2ea5cef767720d41aeb6570e784e80?s=128&d=identicon&r=PG&f=1", "display_name": "Joseph R", "link": "https://stackoverflow.com/users/5040812/joseph-r"}, "edited": false, "score": 0, "creation_date": 1435335538, "post_id": 31037124, "comment_id": 50174237, "body": "Is there anyway I could do some conditional formatting that would just highlight the pairs consistent data? For instance: Bananas Y. Wherever that is true, Bananas and Y will be highlighted. Same with any data pair that is the same. I have been working on this problem for a long time, but nothing I have seen is like what I&#39;m doing. I&#39;m trying to go across. I know there has to be a VBA macro or conditional formatting equation that will do this task, but I have not come across it yet."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 5040812, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0b2ea5cef767720d41aeb6570e784e80?s=128&d=identicon&r=PG&f=1", "display_name": "Joseph R", "link": "https://stackoverflow.com/users/5040812/joseph-r"}, "edited": false, "score": 0, "creation_date": 1436208430, "post_id": 31087580, "comment_id": 50503618, "body": "Thank you! The second half worked for me, although I think the highlighting made navigating through excel rather slow, I was able to get what I needed."}, {"owner": {"reputation": 21459, "user_id": 3894917, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/41Fan.jpg?s=128&g=1", "display_name": "Tom Sharpe", "link": "https://stackoverflow.com/users/3894917/tom-sharpe"}, "reply_to_user": {"reputation": 3, "user_id": 5040812, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0b2ea5cef767720d41aeb6570e784e80?s=128&d=identicon&r=PG&f=1", "display_name": "Joseph R", "link": "https://stackoverflow.com/users/5040812/joseph-r"}, "edited": false, "score": 0, "creation_date": 1436215134, "post_id": 31087580, "comment_id": 50507327, "body": "Good! Yes, I suspected the array formula might be a bit slow if applied to a large number of cells."}], "tags": [], "owner": {"reputation": 21459, "user_id": 3894917, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/41Fan.jpg?s=128&g=1", "display_name": "Tom Sharpe", "link": "https://stackoverflow.com/users/3894917/tom-sharpe"}, "is_accepted": true, "score": 0, "last_activity_date": 1435572614, "last_edit_date": 1435572614, "creation_date": 1435400217, "answer_id": 31087580, "question_id": 31037124, "link": "https://stackoverflow.com/questions/31037124/finding-duplicate-pairs-in-excel/31087580#31087580", "title": "Finding Duplicate Pairs in Excel", "body": "<p>I think this array formula should work:-</p>\n\n<pre><code>=SUM(ISODD(COLUMN())*($A$2:$E$12=A2)*($B$2:$F$12&lt;&gt;B2))\n</code></pre>\n\n<p>if the table starts in A1, this can be applied as conditional formatting from A2 to E12 and will highlight the left-hand (fruit) cell of inconsistent pair of cells.</p>\n\n<p>Then you can use a similar formula to highlight the right-hand cell of each pair:-</p>\n\n<pre><code>=SUM(ISEVEN(COLUMN())*($A$2:$E$12=A2)*($B$2:$F$12&lt;&gt;B2))\n</code></pre>\n\n<p>Apply this from B2 to F12.</p>\n\n<p><img src=\"https://i.stack.imgur.com/m9Zb4.png\" alt=\"enter image description here\"></p>\n\n<p>Note that Smango are highlighted because they are in an inconsistent group (although they are also in a consistent group).</p>\n\n<p>Here is the alternative approach (as suggested) of highlighting the consistent groups:-</p>\n\n<p><img src=\"https://i.stack.imgur.com/ANK33.png\" alt=\"enter image description here\"></p>\n\n<p>The formulae are</p>\n\n<pre><code>=SUM(ISODD(COLUMN())*($A$2:$E$12=A2)*($B$2:$F$12=B2))&gt;1\n</code></pre>\n\n<p>and</p>\n\n<pre><code>=SUM(ISEVEN(COLUMN())*($A$2:$E$12=A2)*($B$2:$F$12=B2))&gt;1\n</code></pre>\n\n<p>to be applied as before.</p>\n\n<p>The sum this time will always be at least one because each pair of cells will match with itself, so the '>' sign is to find if there are any matches with other pairs of cells.</p>\n"}], "owner": {"reputation": 3, "user_id": 5040812, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0b2ea5cef767720d41aeb6570e784e80?s=128&d=identicon&r=PG&f=1", "display_name": "Joseph R", "link": "https://stackoverflow.com/users/5040812/joseph-r"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 407, "favorite_count": 0, "accepted_answer_id": 31087580, "answer_count": 1, "score": 0, "last_activity_date": 1435572614, "creation_date": 1435180291, "last_edit_date": 1495542106, "question_id": 31037124, "link": "https://stackoverflow.com/questions/31037124/finding-duplicate-pairs-in-excel", "title": "Finding Duplicate Pairs in Excel", "body": "<p>So I have this summary sheet. It contains data from multiple workbooks going across. </p>\n\n<p>It's not like this <a href=\"https://stackoverflow.com/questions/16823468/excel-duplicate-values-pairs-in-multiple-column\">question</a>, because what I'm trying to do is find all the inconsistant pairs of data in this worksheet going across and highlight them. </p>\n\n<p>Here is a <a href=\"https://jsfiddle.net/0qvj73ua/\" rel=\"nofollow noreferrer\">fiddle</a> that explains what I want to accomplish. I have a large worksheet, and would like to compare the first 2 rows with the next 2 rows etc. throughout the worksheet. Below is an HTML representation of what I am trying to accomplish.</p>\n\n<pre><code>&lt;table class=\"tg\"&gt;\n&lt;tr&gt;\n&lt;th class=\"tg-031e\"&gt;#INT1&lt;/th&gt;\n&lt;th class=\"tg-031e\"&gt;#INT1&lt;/th&gt;\n&lt;th class=\"tg-031e\"&gt;#INT2&lt;/th&gt;\n&lt;th class=\"tg-031e\"&gt;#INT2&lt;/th&gt;\n&lt;th class=\"tg-031e\"&gt;#INT3&lt;/th&gt;\n&lt;th class=\"tg-031e\"&gt;#INT3&lt;/th&gt;\n&lt;/tr&gt;\n&lt;tr&gt;\n&lt;td class=\"tg-031e\"&gt;Apples&lt;/td&gt;\n&lt;td class=\"tg-031e\"&gt;Y&lt;/td&gt;\n&lt;td class=\"tg-031e\"&gt;Bananas&lt;/td&gt;\n&lt;td class=\"tg-031e\"&gt;Y&lt;/td&gt;\n&lt;td class=\"tg-031e\"&gt;Apples&lt;/td&gt;\n&lt;td class=\"tg-031e\"&gt;Y&lt;/td&gt;\n&lt;/tr&gt;\n&lt;tr&gt;\n&lt;td class=\"tg-031e\"&gt;Bananas&lt;/td&gt;\n&lt;td class=\"tg-031e\"&gt;Y&lt;/td&gt;\n&lt;td class=\"tg-031e\"&gt;Peppers&lt;/td&gt;\n&lt;td class=\"tg-031e\"&gt;Y&lt;/td&gt;\n&lt;td class=\"tg-031e\"&gt;Bananas&lt;/td&gt;\n&lt;td class=\"tg-031e\"&gt;Y&lt;/td&gt;\n&lt;/tr&gt;\n&lt;tr&gt;\n&lt;td class=\"tg-031e\"&gt;Peppers&lt;/td&gt;\n&lt;td class=\"tg-031e\"&gt;Y&lt;/td&gt;\n&lt;td class=\"tg-031e\"&gt;Pomegranite&lt;/td&gt;\n&lt;td class=\"tg-031e\"&gt;Y&lt;/td&gt;\n&lt;td class=\"tg-031e\"&gt;Peppers&lt;/td&gt;\n&lt;td class=\"tg-031e\"&gt;Y&lt;/td&gt;\n&lt;/tr&gt;\n&lt;tr&gt;\n&lt;td class=\"tg-031e\"&gt;Pomegranite&lt;/td&gt;\n&lt;td class=\"tg-031e\"&gt;Y&lt;/td&gt;\n&lt;td class=\"tg-031e\"&gt;Nuts&lt;/td&gt;\n&lt;td class=\"tg-031e\"&gt;YYYYYNN&lt;/td&gt;\n&lt;td class=\"tg-031e\"&gt;Pomegranite&lt;/td&gt;\n&lt;td class=\"tg-031e\"&gt;Y&lt;/td&gt;\n&lt;/tr&gt;\n&lt;tr&gt;\n&lt;td class=\"tg-031e\"&gt;Nuts&lt;/td&gt;\n&lt;td class=\"tg-031e\"&gt;YYYYYYNN&lt;/td&gt;\n&lt;td class=\"tg-031e\"&gt;Smango&lt;/td&gt;\n&lt;td class=\"tg-031e\"&gt;NNNYYNNN&lt;/td&gt;\n&lt;td class=\"tg-031e\"&gt;Nuts&lt;/td&gt;\n&lt;td class=\"tg-031e\"&gt;NNNYNNNN&lt;/td&gt;\n&lt;/tr&gt;\n&lt;tr&gt;\n&lt;td class=\"tg-zl7m\"&gt;Oranges&lt;/td&gt;\n&lt;td class=\"tg-zl7m\"&gt;YYYYNNNN&lt;/td&gt; &lt;!-- this oranges is different from... --&gt;\n&lt;td class=\"tg-031e\"&gt;Blackberries&lt;/td&gt;\n&lt;td class=\"tg-031e\"&gt;NNNYYNNNN&lt;/td&gt;\n&lt;td class=\"tg-zl7m\"&gt;Oranges&lt;/td&gt; \n&lt;td class=\"tg-zl7m\"&gt;NNNYYNNN&lt;/td&gt; &lt;!-- ...this one --&gt;\n&lt;/tr&gt;\n&lt;tr&gt;\n&lt;td class=\"tg-031e\"&gt;Smango&lt;/td&gt;\n&lt;td class=\"tg-031e\"&gt;NNNYYNNN&lt;/td&gt;\n&lt;td class=\"tg-031e\"&gt;Berries&lt;/td&gt;\n&lt;td class=\"tg-031e\"&gt;YYNYNNNN&lt;/td&gt;\n&lt;td class=\"tg-031e\"&gt;Smango&lt;/td&gt;\n&lt;td class=\"tg-031e\"&gt;Y&lt;/td&gt;\n&lt;/tr&gt;\n&lt;tr&gt;\n&lt;td class=\"tg-031e\"&gt;Skiwi&lt;/td&gt;\n&lt;td class=\"tg-031e\"&gt;NNNYNNNN&lt;/td&gt;\n&lt;td class=\"tg-031e\"&gt;Beer&lt;/td&gt;\n&lt;td class=\"tg-031e\"&gt;NNNYNNNN&lt;/td&gt;\n&lt;td class=\"tg-031e\"&gt;Steaks&lt;/td&gt;\n&lt;td class=\"tg-031e\"&gt;Y&lt;/td&gt;\n&lt;/tr&gt;\n&lt;tr&gt;\n&lt;td class=\"tg-031e\"&gt;Steaks&lt;/td&gt;\n&lt;td class=\"tg-031e\"&gt;Y&lt;/td&gt;\n&lt;td class=\"tg-031e\"&gt;Blueberries&lt;/td&gt;\n&lt;td class=\"tg-031e\"&gt;YNNYNNNN&lt;/td&gt;\n&lt;td class=\"tg-031e\"&gt;Steaksauce&lt;/td&gt;\n&lt;td class=\"tg-031e\"&gt;NNNYNNNN&lt;/td&gt;\n&lt;/tr&gt;\n&lt;tr&gt;\n&lt;td class=\"tg-zl7m\"&gt;Steaksauce&lt;/td&gt;\n&lt;td class=\"tg-zl7m\"&gt;YYNYNNNN&lt;/td&gt;\n&lt;td class=\"tg-031e\"&gt;Blucheese&lt;/td&gt;\n&lt;td class=\"tg-031e\"&gt;NNNYNNNN&lt;/td&gt;\n&lt;td class=\"tg-zl7m\"&gt;Apricot&lt;/td&gt;\n&lt;td class=\"tg-zl7m\"&gt;YYYYNNNN&lt;/td&gt;\n&lt;/tr&gt;\n&lt;tr&gt;\n&lt;td class=\"tg-031e\"&gt;Apricot&lt;/td&gt;\n&lt;td class=\"tg-031e\"&gt;YYYYNNNN&lt;/td&gt;\n&lt;td class=\"tg-031e\"&gt;Blackberries&lt;/td&gt;\n&lt;td class=\"tg-031e\"&gt;NNNYNNNN&lt;/td&gt;\n&lt;td class=\"tg-031e\"&gt;Milkshake&lt;/td&gt;\n&lt;td class=\"tg-031e\"&gt;NNNYNNNN&lt;/td&gt;\n&lt;/tr&gt;\n&lt;/table&gt;\n</code></pre>\n\n<p>I have tried VBA solutions and also conditional formatting. Any solution that will make this work is greatly appreciated.</p>\n\n<p>Thank you.</p>\n"}, {"tags": ["excel", "ms-access", "vba"], "comments": [{"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1435179695, "post_id": 31036889, "comment_id": 50098045, "body": "Forgive me, but why not do everything in MS Access? Why reinvent an entire user interface and query processor in Excel as Access does such operations natively."}, {"owner": {"reputation": 623, "user_id": 3781528, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/57552cda53e1092efc04fb0a7d313a25?s=128&d=identicon&r=PG&f=1", "display_name": "user3781528", "link": "https://stackoverflow.com/users/3781528/user3781528"}, "reply_to_user": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1435182815, "post_id": 31036889, "comment_id": 50099567, "body": "The original report is dumped into Excel. Also, I work with people that refuse to use Access.  They are afraid of it. :)"}, {"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1435191508, "post_id": 31036889, "comment_id": 50102208, "body": "Ah yes, Excel&#39;s popularity and ease of use are its own drawbacks as people will use it for everything under the sun! If you design a good UI in Access, users should not be afraid as they use command buttons, dropdowns, text boxes everyday on websites! Plus, Access forms are much more interactive than Excel UserForms."}], "answers": [{"comments": [{"owner": {"reputation": 623, "user_id": 3781528, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/57552cda53e1092efc04fb0a7d313a25?s=128&d=identicon&r=PG&f=1", "display_name": "user3781528", "link": "https://stackoverflow.com/users/3781528/user3781528"}, "edited": false, "score": 0, "creation_date": 1435237020, "post_id": 31039239, "comment_id": 50123014, "body": "Thank you for you suggestion.  I&#39;ve added your code and now get &quot;Error 3001 (Arguments are of wrong type, are out of acceptable range, or are in conflict with one another&quot; error.  Could you please help resolve this error?"}, {"owner": {"reputation": 623, "user_id": 3781528, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/57552cda53e1092efc04fb0a7d313a25?s=128&d=identicon&r=PG&f=1", "display_name": "user3781528", "link": "https://stackoverflow.com/users/3781528/user3781528"}, "edited": false, "score": 0, "creation_date": 1435237395, "post_id": 31039239, "comment_id": 50123304, "body": "here is what I&#39;ve changed:<code>code Set cnn = New ADODB.Connection &#39; Initialise the collection class variable cnn.Open &quot;Provider=Microsoft.ACE.OLEDB.12.0;Data Source=&quot; &amp; dbPath Set maxIDrst = New ADODB.Recordset sql = &quot;SELECT MAX([&quot; &amp; PrimaryField &amp; &quot;]) + 1 as MaxIDPlusOne FROM [&quot; &amp; MyTable &amp; &quot;];&quot; maxIDrst.Open sql, conn UserForm1.Arec1.Value = maxIDrst!MaxIDPlusOne Set maxIDrst = Nothing Set rst = New ADODB.Recordset &#39;assign memory to the recordset rst.Open Source:=&quot;Table1&quot;, ActiveConnection:=cnn, _ CursorType:=adOpenDynamic, LockType:=adLockOptimistic, _ Options:=adCmdTable </code>"}, {"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "reply_to_user": {"reputation": 623, "user_id": 3781528, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/57552cda53e1092efc04fb0a7d313a25?s=128&d=identicon&r=PG&f=1", "display_name": "user3781528", "link": "https://stackoverflow.com/users/3781528/user3781528"}, "edited": false, "score": 0, "creation_date": 1435258665, "post_id": 31039239, "comment_id": 50138152, "body": "Did your change work? I believe the earlier error was due to the UserForm control reference. As I mentioned in my answer, you need to change it to fit your intended textbox. I added a 5th to Arec because I thought the other four were in use already (ID, patient, test, CommentTxt)."}, {"owner": {"reputation": 623, "user_id": 3781528, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/57552cda53e1092efc04fb0a7d313a25?s=128&d=identicon&r=PG&f=1", "display_name": "user3781528", "link": "https://stackoverflow.com/users/3781528/user3781528"}, "edited": false, "score": 0, "creation_date": 1435260707, "post_id": 31039239, "comment_id": 50139234, "body": "I&#39;ve created two seperated routines: one to query MaxId and the second to send the data to Access and they work great! Thank you for your help."}], "tags": [], "owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "is_accepted": true, "score": 0, "last_activity_date": 1435191307, "creation_date": 1435191307, "answer_id": 31039239, "question_id": 31036889, "link": "https://stackoverflow.com/questions/31036889/how-to-query-and-update-a-table-in-access-from-excel-in-one-sub/31039239#31039239", "title": "How to query and update a table in Access from Excel in one sub", "body": "<p>Consider opening a new recordset. Of course, change the Excel userform textbox name (placeholder here):</p>\n\n<pre><code>Set maxIDrst = New ADODB.Recordset\n\nsql = \"SELECT MAX([\" &amp; PrimaryField &amp; \"]) + 1 as MaxIDPlusOne FROM [\" &amp; MyTable &amp; \"];\"\nmaxIDrst.Open sql, conn\n\nUserForm1.Controls(\"Arec5\").Value = maxIDrst!MaxIDPlusOne\nmaxIDrst.Close\n...\nSet maxIDrst = nothing\n</code></pre>\n"}], "owner": {"reputation": 623, "user_id": 3781528, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/57552cda53e1092efc04fb0a7d313a25?s=128&d=identicon&r=PG&f=1", "display_name": "user3781528", "link": "https://stackoverflow.com/users/3781528/user3781528"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 386, "favorite_count": 0, "accepted_answer_id": 31039239, "answer_count": 1, "score": 0, "last_activity_date": 1594644251, "creation_date": 1435179381, "last_edit_date": 1594644251, "question_id": 31036889, "link": "https://stackoverflow.com/questions/31036889/how-to-query-and-update-a-table-in-access-from-excel-in-one-sub", "title": "How to query and update a table in Access from Excel in one sub", "body": "<p>I have a Userform in Excel with four textboxes. Each text box corresponds to a field of Table1 in Access. </p>\n\n<p>I\u2019m would like to return MAX row ID value from a table in Access, add 1 to that value, and to display that value in a textbox on the userform.</p>\n\n<p>After I enter values into the other 3 text boxes, I would like to export data to Table1 in Access.</p>\n\n<p>Can this all be accomplished in the same subroutine?  Please help me incorporate sql statement in the correct location in the code.</p>\n\n<p>Thank you</p>\n\n<pre><code>Dim cnn As ADODB.Connection 'dim the ADO collection class\nDim rst As ADODB.Recordset 'dim the ADO recordset class\nDim dbPath As String\nDim x As Long, i As Long\nDim PrimaryField As String\n\nDim MyTable As String\nDim GetLastPrimaryKey As Variant\n\nPrimaryField = \"ID\"\nMyTable = \"Table1\"\n\n\n'Erro handler\nOn Error GoTo errHandler:\n\n'dbPath = ActiveSheet.Range(\"H500\").Value\n\ndbPath = \"H:\\Annie\\File.accdb\"\n\nSet cnn = New ADODB.Connection ' Initialise the collection class variable\n\n'Connection class is equipped with a \u2014method\u2014 named Open\n'\u2014-4 aguments\u2014- ConnectionString, UserID, Password, Options\n'ConnectionString formula\u2014-Key1=Value1;Key2=Value2;Key_n=Value_n;\ncnn.Open \"Provider=Microsoft.ACE.OLEDB.12.0;Data Source=\" &amp; dbPath\nsql = \"SELECT MAX([\" &amp; PrimaryField &amp; \"]) FROM [\" &amp; MyTable &amp; \"];\"\n\n'two primary providers used in ADO SQLOLEDB \u2014-Microsoft.JET.OLEDB.4.0 \u2014-Microsoft.ACE.OLEDB.12.0\n'Object Linking and Embedding, Database\n\n'ADO library is equipped with a class named Recordset\nSet rst = New ADODB.Recordset 'assign memory to the recordset\n'ConnectionString Open '\u2014-5 aguments\u2014-\n\n'Source, ActiveConnection, CursorType, LockType, Options\n\nrst.Open Source:=\"Table1\", ActiveConnection:=cnn, _\nCursorType:=adOpenDynamic, LockType:=adLockOptimistic, _\nOptions:=adCmdTable\n\n'rst.Open sql, cnn\n\n\nGetLastPrimaryKey = rst.Fields(0).Value\nMsgBox (GetLastPrimaryKey)\nGetLastPrimaryKey = Arec1.Value\n'you now have the recordset object\n'alternative code\nWith rst\n    .AddNew\n    .Fields(\"ID\").Value = Arec1\n    .Fields(\"patient\").Value = Arec2\n    .Fields(\"test\").Value = Arec3\n    .Fields(\"CommentTxt\").Value = Arec4\n    .Update\nEnd With\n\n\n'clear the userform values\nFor x = 1 To 4\nUserForm1.Controls(\"Arec\" &amp; x).Value = \"\"\nNext\n'add the next user ID\n'Me.Arec1 = Sheet1.Range(\"J3\").Value\n' Close the connection\nrst.Close\ncnn.Close\nSet rst = Nothing\nSet cnn = Nothing\n'commuinicate with the user\nMsgBox \" The data has been successfully sent to the access database\"\nOn Error GoTo 0\nExit Sub\nerrHandler:\nSet rst = Nothing\nSet cnn = Nothing\nMsgBox \"Error \" &amp; Err.Number &amp; \" (\" &amp; Err.Description &amp; \") in procedure cmdAdd\"\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-access", "text", "auto-populate"], "comments": [{"owner": {"reputation": 41, "user_id": 5046315, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/fc3d9e17b37568a30f66175a2aecfeeb?s=128&d=identicon&r=PG&f=1", "display_name": "hightryan", "link": "https://stackoverflow.com/users/5046315/hightryan"}, "edited": false, "score": 0, "creation_date": 1435179062, "post_id": 31036774, "comment_id": 50097709, "body": "To be clear the names are on different lines.  Did not notice my error."}, {"owner": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 1, "creation_date": 1435179487, "post_id": 31036774, "comment_id": 50097923, "body": "So <a href=\"https://stackoverflow.com/posts/31036774/edit\">edit</a> your post and fix them. :-)"}], "answers": [{"comments": [{"owner": {"reputation": 41, "user_id": 5046315, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/fc3d9e17b37568a30f66175a2aecfeeb?s=128&d=identicon&r=PG&f=1", "display_name": "hightryan", "link": "https://stackoverflow.com/users/5046315/hightryan"}, "edited": false, "score": 0, "creation_date": 1435243208, "post_id": 31041959, "comment_id": 50128121, "body": "Thank you for the help but I am getting error-code 91 when running the code.  Stating the my Object variable or with-block variable is not set.  The debugger points to the line &quot;Set oFS=oFSO.OpenTextFile(filepath)&quot;  I also added the library before running the script."}, {"owner": {"reputation": 117, "user_id": 4115567, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2bdac4434725493543ded427cc082fce?s=128&d=identicon&r=PG&f=1", "display_name": "DevBW", "link": "https://stackoverflow.com/users/4115567/devbw"}, "reply_to_user": {"reputation": 41, "user_id": 5046315, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/fc3d9e17b37568a30f66175a2aecfeeb?s=128&d=identicon&r=PG&f=1", "display_name": "hightryan", "link": "https://stackoverflow.com/users/5046315/hightryan"}, "edited": false, "score": 0, "creation_date": 1435278396, "post_id": 31041959, "comment_id": 50146255, "body": "Sorry about that.. I had set oFSO to nothing without setting it to something in the first place.  Try the edit"}, {"owner": {"reputation": 41, "user_id": 5046315, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/fc3d9e17b37568a30f66175a2aecfeeb?s=128&d=identicon&r=PG&f=1", "display_name": "hightryan", "link": "https://stackoverflow.com/users/5046315/hightryan"}, "edited": false, "score": 0, "creation_date": 1435591951, "post_id": 31041959, "comment_id": 50252458, "body": "Thank you so much, that did the trick.  Now I can finally finish this project. I don&#39;t think I can up vote your comment, being new to the website.  So i hope you accept my written thank you. @CharlieOscarDeltaEcho"}], "tags": [], "owner": {"reputation": 117, "user_id": 4115567, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2bdac4434725493543ded427cc082fce?s=128&d=identicon&r=PG&f=1", "display_name": "DevBW", "link": "https://stackoverflow.com/users/4115567/devbw"}, "is_accepted": false, "score": 1, "last_activity_date": 1435278232, "last_edit_date": 1435278232, "creation_date": 1435210449, "answer_id": 31041959, "question_id": 31036774, "link": "https://stackoverflow.com/questions/31036774/how-to-populate-combo-box-access-vba/31041959#31041959", "title": "How to Populate Combo Box Access VBA", "body": "<p>Assuming you're just trying to populate one combo box with a list of first and last names (where the names are separated by a line break), try this:</p>\n\n<pre><code>Dim filePath As String\nDim oFSO As New FileSystemObject\nDim oFS As TextStream\n\nfilePath = \"C:\\FileFullOfNames.txt\"\n\nSet oFS = oFSO.OpenTextFile(filePath)\n\nDo While Not oFS.AtEndOfStream\n  MyForm.ComboBox1.AddItem oFS.ReadLine\nLoop\n\noFS.Close\n\nSet oFS = Nothing\n</code></pre>\n\n<p>If you've never used FileSystemObject &amp; TextStream, you'll need to add the Microsoft Scripting Runtime reference in your VBE.  (Tools > References > Check the box labeled \"Microsoft Scripting Runtime\").</p>\n"}], "owner": {"reputation": 41, "user_id": 5046315, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/fc3d9e17b37568a30f66175a2aecfeeb?s=128&d=identicon&r=PG&f=1", "display_name": "hightryan", "link": "https://stackoverflow.com/users/5046315/hightryan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 637, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1435278232, "creation_date": 1435179001, "last_edit_date": 1435243339, "question_id": 31036774, "link": "https://stackoverflow.com/questions/31036774/how-to-populate-combo-box-access-vba", "title": "How to Populate Combo Box Access VBA", "body": "<p>I am trying to fill in a combo box with names from a text file.  The file ill ready something to the affect of.</p>\n\n<p>Greg Smith<br>\nJohn Oliver<br>\nBob Cassidy<br>\n....<br>\n....</p>\n\n<p>So far I have the code from another thread which works great but only takes the last name from the list and the other names are no where to be found.  The code is:</p>\n\n<p>Dim MyStr1 as string<br>\ndim MyStr2 as string  </p>\n\n<p>Open \"TESTFILE\" For Input As #1<br>\nDo While Not EOF(1)    ' Loop until end of file.<br>\n    Input #1, MyStr1, MyStr2<br>\n    me.txtStr1 = MyStr1<br>\n    me.txtStr2 = MyStr2<br>\nLoop<br>\nClose #1    ' Close file.  </p>\n\n<p>Any help would be greatly appreciated.</p>\n"}, {"tags": ["ms-access", "vba", "ms-access-2010"], "answers": [{"tags": [], "owner": {"reputation": 99, "user_id": 4526197, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e752e7969ab15fcb1df21ae1e6544e2a?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/4526197/michael"}, "is_accepted": false, "score": 1, "last_activity_date": 1558337339, "last_edit_date": 1558337339, "creation_date": 1435210454, "answer_id": 31041962, "question_id": 31036630, "link": "https://stackoverflow.com/questions/31036630/why-won-t-2010-ms-access-preview-or-print-a-report-with-subreports/31041962#31041962", "title": "Why won\u2019t 2010 MS Access preview or print a report with subreports?", "body": "<p>This problem originated using the Report Wizard.  I tried another approach by opening a blank report and dragging the subreports into it....<strong>problem solved</strong>.  </p>\n\n<p>The vba code for opening and printing the report is the following:  </p>\n\n<pre><code>DoCmd.OpenReport \"rptGRANT_REPORT\", acViewReport\n</code></pre>\n\n<p>and</p>\n\n<pre><code>DoCmd.OutputTo acOutputReport, \"rptGRANT_REPORT\", _ \n    acFormatPDF, \"C:\\Users\\User\\Downloads\\Grant_Report.pdf\"\n</code></pre>\n"}], "owner": {"reputation": 99, "user_id": 4526197, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e752e7969ab15fcb1df21ae1e6544e2a?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/4526197/michael"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 699, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1594570256, "creation_date": 1435178558, "last_edit_date": 1594570256, "question_id": 31036630, "link": "https://stackoverflow.com/questions/31036630/why-won-t-2010-ms-access-preview-or-print-a-report-with-subreports", "title": "Why won\u2019t 2010 MS Access preview or print a report with subreports?", "body": "<p>I have a perfectly compliled report consisting of two subreports (thanks to the Stack).  I use this line of code to open it:</p>\n\n<p>DoCmd.OpenReport \"rptGRANT_REPORT\", acViewPreview</p>\n\n<p>\u2026looks like this:</p>\n\n<p><img src=\"https://i.stack.imgur.com/V2dcE.jpg\" alt=\"enter image description here\"></p>\n\n<p>But when I try to preview or print report it looks like this:  (no subreports):</p>\n\n<p><img src=\"https://i.stack.imgur.com/lTH5g.jpg\" alt=\"enter image description here\"></p>\n\n<p>Any suggestions?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1435178243, "post_id": 31036508, "comment_id": 50097295, "body": "Are you using ActiveX checkboxes or Form Control checkboxes?"}, {"owner": {"reputation": 48, "user_id": 5046146, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d928facd14c0bff51bd1f5757e8e096a?s=128&d=identicon&r=PG", "display_name": "IncensedFork", "link": "https://stackoverflow.com/users/5046146/incensedfork"}, "reply_to_user": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1435178416, "post_id": 31036508, "comment_id": 50097399, "body": "ActiveX checkboxes. Also I should note, the reason I activated cell J4 is because that was the cell that contains the ActiveX checkbox"}, {"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1435179311, "post_id": 31036508, "comment_id": 50097841, "body": "To do what you want you either need to use Form Controls, or create a Class Module for your ActiveX checkboxes.  See here for an example with ActiveX command buttons: <a href=\"http://www.mrexcel.com/forum/excel-questions/219122-application-caller-command-buttons-sheet.html\" rel=\"nofollow noreferrer\">mrexcel.com/forum/excel-questions/&hellip;</a>"}, {"owner": {"reputation": 48, "user_id": 5046146, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d928facd14c0bff51bd1f5757e8e096a?s=128&d=identicon&r=PG", "display_name": "IncensedFork", "link": "https://stackoverflow.com/users/5046146/incensedfork"}, "reply_to_user": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1435251261, "post_id": 31036508, "comment_id": 50133825, "body": "Woops, I screwed up. They ARE form controls after all."}], "answers": [{"comments": [{"owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "edited": false, "score": 0, "creation_date": 1435206537, "post_id": 31039049, "comment_id": 50105630, "body": "Actually this is a better option, BUT: you can&#39;t update all checkboxes at once because it will use the same UserName for all checked cells - you still need to send one box at the time NameCopy(ByRef chk As <b>MSForms.CheckBox</b>) and it will know the offset. Also you need to properly reference the range: <b>chk.TopLeftCell.Offset(0, 1)</b>, and remove the name when unchecked"}, {"owner": {"reputation": 48, "user_id": 5046146, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d928facd14c0bff51bd1f5757e8e096a?s=128&d=identicon&r=PG", "display_name": "IncensedFork", "link": "https://stackoverflow.com/users/5046146/incensedfork"}, "edited": false, "score": 0, "creation_date": 1435238073, "post_id": 31039049, "comment_id": 50123835, "body": "Thank you two so much for your help! Lance, I tried your code, but it&#39;s giving me an error: &quot;Invalid use of Me keyword&quot;. Any thoughts?"}, {"owner": {"reputation": 21235, "user_id": 13295, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/x6tCV.jpg?s=128&g=1", "display_name": "Lance Roberts", "link": "https://stackoverflow.com/users/13295/lance-roberts"}, "edited": false, "score": 0, "creation_date": 1435241505, "post_id": 31039049, "comment_id": 50126666, "body": "Me gives a quick reference to the sheet that the Checkbox is on, but you can just use ActiveSheet probably. Oh, I do see one error where I left out the variable type in the sub parameter. Edited in now."}, {"owner": {"reputation": 48, "user_id": 5046146, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d928facd14c0bff51bd1f5757e8e096a?s=128&d=identicon&r=PG", "display_name": "IncensedFork", "link": "https://stackoverflow.com/users/5046146/incensedfork"}, "edited": false, "score": 0, "creation_date": 1435244059, "post_id": 31039049, "comment_id": 50128812, "body": "Thanks! I made the changes, and it runs now, but nothing is happening. I&#39;d like to walk through the macro, how do I go about doing that?"}, {"owner": {"reputation": 21235, "user_id": 13295, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/x6tCV.jpg?s=128&g=1", "display_name": "Lance Roberts", "link": "https://stackoverflow.com/users/13295/lance-roberts"}, "edited": false, "score": 0, "creation_date": 1435244352, "post_id": 31039049, "comment_id": 50129063, "body": "Set a breakpoint on one of the first lines, then use F8 to walk through.  My bet would be on the references of what the LinkedCell value is and the Offset used. I made it specifically based on setting the Linked Cell to the J4 reference, i.e. on the cell it was in."}, {"owner": {"reputation": 21235, "user_id": 13295, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/x6tCV.jpg?s=128&g=1", "display_name": "Lance Roberts", "link": "https://stackoverflow.com/users/13295/lance-roberts"}, "edited": false, "score": 0, "creation_date": 1435244444, "post_id": 31039049, "comment_id": 50129146, "body": "Uh, I just realized that this won&#39;t completely work the way you want it to, since it sets all the true checkboxes to the same name. I&#39;ll have to look into that."}, {"owner": {"reputation": 48, "user_id": 5046146, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d928facd14c0bff51bd1f5757e8e096a?s=128&d=identicon&r=PG", "display_name": "IncensedFork", "link": "https://stackoverflow.com/users/5046146/incensedfork"}, "edited": false, "score": 0, "creation_date": 1435245985, "post_id": 31039049, "comment_id": 50130362, "body": "Yeah, I think I see what you mean. It gets the for each loop and just skips straight to the end. Almost like it&#39;s not recognizing the checkbox as an object... Not sure what to make of it"}, {"owner": {"reputation": 21235, "user_id": 13295, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/x6tCV.jpg?s=128&g=1", "display_name": "Lance Roberts", "link": "https://stackoverflow.com/users/13295/lance-roberts"}, "edited": false, "score": 0, "creation_date": 1435246544, "post_id": 31039049, "comment_id": 50130770, "body": "Hmmm, maybe instead of an ActiveX checkbox, you made a Forms checkbox."}, {"owner": {"reputation": 48, "user_id": 5046146, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d928facd14c0bff51bd1f5757e8e096a?s=128&d=identicon&r=PG", "display_name": "IncensedFork", "link": "https://stackoverflow.com/users/5046146/incensedfork"}, "edited": false, "score": 0, "creation_date": 1435247598, "post_id": 31039049, "comment_id": 50131530, "body": "I admit, I don&#39;t know whether they&#39;re ActiveX or Forms. The checkboxes were already there when I was asked to write the macro. When you asked me which they were, I created two new checkboxes, one of each kind, and compared them visually to the ones that were there, and ActiveX looked most similar. A Band-Aid solution, I know, but I don&#39;t know of any other way to tell.  As long as I&#39;m giving full disclosure, the reason the controls are linked to other cells is because those linked cells are used in some kind of formula that determines the color of the corresponding row. It&#39;s not a macro, so I&#39;m"}, {"owner": {"reputation": 48, "user_id": 5046146, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d928facd14c0bff51bd1f5757e8e096a?s=128&d=identicon&r=PG", "display_name": "IncensedFork", "link": "https://stackoverflow.com/users/5046146/incensedfork"}, "edited": false, "score": 0, "creation_date": 1435247693, "post_id": 31039049, "comment_id": 50131589, "body": "not exactly sure how he did it, but when you click the first check box, for example, the row turns blue. Clicking a checkbox that says &quot;complete&quot; turns it green, etc."}, {"owner": {"reputation": 21235, "user_id": 13295, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/x6tCV.jpg?s=128&g=1", "display_name": "Lance Roberts", "link": "https://stackoverflow.com/users/13295/lance-roberts"}, "edited": false, "score": 0, "creation_date": 1435247910, "post_id": 31039049, "comment_id": 50131741, "body": "Instead of looking at their appearance, look at their properties. They will have different properties. You may have condition formatting set on the rows that keys to the LinkedCells, which would be easy to modify."}, {"owner": {"reputation": 21235, "user_id": 13295, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/x6tCV.jpg?s=128&g=1", "display_name": "Lance Roberts", "link": "https://stackoverflow.com/users/13295/lance-roberts"}, "edited": false, "score": 0, "creation_date": 1435249508, "post_id": 31039049, "comment_id": 50132803, "body": "Ok, found one more limitation in VBA, so you can&#39;t be completely generic on the wrapper. It works now for ActiveX checkboxes, and I&#39;ve changed the reference to be -7 from your current LinkedCell, hopefully that is consistent."}, {"owner": {"reputation": 48, "user_id": 5046146, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d928facd14c0bff51bd1f5757e8e096a?s=128&d=identicon&r=PG", "display_name": "IncensedFork", "link": "https://stackoverflow.com/users/5046146/incensedfork"}, "edited": false, "score": 0, "creation_date": 1435251336, "post_id": 31039049, "comment_id": 50133875, "body": "Oh boy, big mistake made by me. They ARE form controls. Sorry everyone. I&#39;ve edited the OP to reflect this little screwup."}, {"owner": {"reputation": 48, "user_id": 5046146, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d928facd14c0bff51bd1f5757e8e096a?s=128&d=identicon&r=PG", "display_name": "IncensedFork", "link": "https://stackoverflow.com/users/5046146/incensedfork"}, "edited": false, "score": 0, "creation_date": 1435253278, "post_id": 31039049, "comment_id": 50134981, "body": "Unfortunately it still didn&#39;t work for me :/ @tigeravatar&#39;s response worked though, so I&#39;ve accepted his answer. Thank you so much for all of your help (and patience) Lance!"}, {"owner": {"reputation": 48, "user_id": 5046146, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d928facd14c0bff51bd1f5757e8e096a?s=128&d=identicon&r=PG", "display_name": "IncensedFork", "link": "https://stackoverflow.com/users/5046146/incensedfork"}, "edited": false, "score": 0, "creation_date": 1435253878, "post_id": 31039049, "comment_id": 50135334, "body": "Hold up, it DID work, I just missed it because the offset put it in a cell where I didn&#39;t expect to see it. As a result, I have marked your answer instead because you were here since the beginning. Thanks so much Lance!!!"}], "tags": [], "owner": {"reputation": 21235, "user_id": 13295, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/x6tCV.jpg?s=128&g=1", "display_name": "Lance Roberts", "link": "https://stackoverflow.com/users/13295/lance-roberts"}, "is_accepted": true, "score": 2, "last_activity_date": 1435253400, "last_edit_date": 1435253400, "creation_date": 1435189921, "answer_id": 31039049, "question_id": 31036508, "link": "https://stackoverflow.com/questions/31036508/using-relative-references-to-reuse-a-macro-for-a-control/31039049#31039049", "title": "Using relative references to reuse a macro for a control", "body": "<p>While this is easy to do with a Sheet object, it's pretty hard to do with an ActiveX Control object. You can't self-reference the name of an ActiveX Control in its event, unless it's passed to it, and you also can't reference the name of the event subroutine to extract the name, and you can't reference the name of the routine that called a routine. </p>\n\n<p>I also attempted to trigger off of the Worksheet Change and SelectionChange events, but those don't trigger off of a checkbox change, even if it has a LinkedCell that changes</p>\n\n<p>What I finally came up with was the somewhat generic wrapper for the click event, that you'll have to modify the string to match the Checkbox name:</p>\n\n<pre><code>Private Sub CheckBox1_Click()\n\n  NameCopy Me, \"CheckBox1\"\n\nEnd Sub\n</code></pre>\n\n<p>and then a Namecopy function that sets the cell -7 to the left of the LinkedCell to the name value. </p>\n\n<pre><code>Public Sub NameCopy(wsheet As Worksheet, cname As String)\n\nIf wsheet.OLEObjects(cname).Object.Value = True Then\n    Range(wsheet.OLEObjects(cname).LinkedCell).Offset(0, -7).Value = Environ(\"UserName\")\nEnd If\n\nEnd Sub\n</code></pre>\n\n<p>It's easier with a Forms checkbox, you can use this Macro for all your checkboxes. Just remember to set the Macro to this:</p>\n\n<pre><code>Public Sub NameCopy()\n\nDim shp As Shape\nSet shp = ActiveSheet.Shapes(Application.Caller)\n\nIf shp.ControlFormat.Value = xlOn Then\n  ActiveSheet.Range(shp.ControlFormat.LinkedCell).Offset(0, -7).Value = Environ(\"UserName\")\nEnd If\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 48, "user_id": 5046146, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d928facd14c0bff51bd1f5757e8e096a?s=128&d=identicon&r=PG", "display_name": "IncensedFork", "link": "https://stackoverflow.com/users/5046146/incensedfork"}, "edited": false, "score": 0, "creation_date": 1435253336, "post_id": 31056781, "comment_id": 50135012, "body": "IT WORKED! Thank you so much, @tigeravatar"}, {"owner": {"reputation": 1408, "user_id": 3251540, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/PbLpq.jpg?s=128&g=1", "display_name": "AER", "link": "https://stackoverflow.com/users/3251540/aer"}, "edited": false, "score": 0, "creation_date": 1470353775, "post_id": 31056781, "comment_id": 64929170, "body": "@tigeravatar You are an absolute legend. People pay for this kind of help; completely saved my skin. I can copy paste the check-box and it relative references the cell it&#39;s on. This is so good, thank you."}], "tags": [], "owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "is_accepted": false, "score": 2, "last_activity_date": 1435252836, "creation_date": 1435252836, "answer_id": 31056781, "question_id": 31036508, "link": "https://stackoverflow.com/questions/31036508/using-relative-references-to-reuse-a-macro-for-a-control/31056781#31056781", "title": "Using relative references to reuse a macro for a control", "body": "<p>Since you are using form controls, this is really easy.  You can use <code>Application.Caller</code> to have the code access the clicked checkbox, and then use it's <code>TopLeftCell</code> property to get where the checkbox is located, and then you can perform whatever operation you want.  In your case, something like this I'm guessing:</p>\n\n<pre><code>Sub Checkbox_Click()\n\n    With ActiveSheet.CheckBoxes(Application.Caller)\n        If .Value = 1 Then  'Checkbox is checked\n            .TopLeftCell.Offset(, 1).Value = Environ(\"UserName\")\n        Else\n            .TopLeftCell.Offset(, 1).ClearContents\n        End If\n    End With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 48, "user_id": 5046146, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d928facd14c0bff51bd1f5757e8e096a?s=128&d=identicon&r=PG", "display_name": "IncensedFork", "link": "https://stackoverflow.com/users/5046146/incensedfork"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 796, "favorite_count": 0, "accepted_answer_id": 31039049, "answer_count": 2, "score": 3, "last_activity_date": 1435253400, "creation_date": 1435178077, "last_edit_date": 1435252790, "question_id": 31036508, "link": "https://stackoverflow.com/questions/31036508/using-relative-references-to-reuse-a-macro-for-a-control", "title": "Using relative references to reuse a macro for a control", "body": "<p>I'm trying to write an Excel 2007 macro for a coworker, but my VBA skills are pretty basic (pardon the pun). Essentially, what needs to happen is, when a checkbox is clicked, the neighboring cell to the right is filled with the username of the person logged in.</p>\n\n<p>So far, here's the code I've come up with that allows me to do that:</p>\n\n<pre><code>Sub CheckBox1_Click()\n    Range(\"J4\").Activate\n    If ActiveCell.Offset(0, 18).Value = True Then\n        ActiveCell.Offset(0, 1).Value = Environ(\"UserName\")\n    Else\n        ActiveCell.Offset(0, 1).Clear\n    End If\nEnd Sub\n</code></pre>\n\n<p>Just for the sake of reference, that \"ActiveCell.Offset(0,18)\" refers to a cell that is linked to the checkbox in question and contains its true/false value.</p>\n\n<p>(EDIT: Also, the reason cell J4 is activated is because in this case, it's the cell containing the ActiveX checkbox)</p>\n\n<p>That works perfectly, but that's not my problem. My problem is this: there are 49 more checkboxes in that row, and three more rows on this sheet, and 45 more sheets in this book. I do NOT want to have to copy paste the same code into a unique macro just to change the active cell. More importantly, as a good programmer, I shouldn't be repeating code like that. How should I write this so that I don't have to refer to a distinct cell every time?</p>\n\n<p>EDIT 2: Holy smokes, Lance just helped me realize I was mistaken. The sheet uses form controls, not ActiveX controls. Greatly sorry, everyone.</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 3730, "user_id": 652301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3fa42db9e3dd408f0de546a82d67c016?s=128&d=identicon&r=PG&f=1", "display_name": "sous2817", "link": "https://stackoverflow.com/users/652301/sous2817"}, "is_accepted": false, "score": 3, "last_activity_date": 1435177730, "creation_date": 1435177730, "answer_id": 31036390, "question_id": 31036314, "link": "https://stackoverflow.com/questions/31036314/invalid-outside-procedure/31036390#31036390", "title": "Invalid Outside Procedure", "body": "<p>The max value for an Integer is ~32767.  You have to pick a different data type if you want your counter to be that high (perhaps a long?)</p>\n"}, {"comments": [{"owner": {"reputation": 23, "user_id": 5046251, "user_type": "registered", "profile_image": "https://graph.facebook.com/916819751697630/picture?type=large", "display_name": "i.c.", "link": "https://stackoverflow.com/users/5046251/i-c"}, "edited": false, "score": 0, "creation_date": 1435178666, "post_id": 31036484, "comment_id": 50097519, "body": "Thank you for the Long.  However, when I run the formula by @paul bica I still get the error End if without block if."}, {"owner": {"reputation": 3730, "user_id": 652301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3fa42db9e3dd408f0de546a82d67c016?s=128&d=identicon&r=PG&f=1", "display_name": "sous2817", "link": "https://stackoverflow.com/users/652301/sous2817"}, "reply_to_user": {"reputation": 23, "user_id": 5046251, "user_type": "registered", "profile_image": "https://graph.facebook.com/916819751697630/picture?type=large", "display_name": "i.c.", "link": "https://stackoverflow.com/users/5046251/i-c"}, "edited": false, "score": 0, "creation_date": 1435178969, "post_id": 31036484, "comment_id": 50097664, "body": "@i.c. the way you have your &quot;if&quot; statement structured in your original code, you don&#39;t need the &quot;end if&quot; statement.  If you use paul bica&#39;s code, you do (the fact that the &quot;then&quot; criteria is on another line)."}, {"owner": {"reputation": 23, "user_id": 5046251, "user_type": "registered", "profile_image": "https://graph.facebook.com/916819751697630/picture?type=large", "display_name": "i.c.", "link": "https://stackoverflow.com/users/5046251/i-c"}, "reply_to_user": {"reputation": 3730, "user_id": 652301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3fa42db9e3dd408f0de546a82d67c016?s=128&d=identicon&r=PG&f=1", "display_name": "sous2817", "link": "https://stackoverflow.com/users/652301/sous2817"}, "edited": false, "score": 0, "creation_date": 1435180360, "post_id": 31036484, "comment_id": 50098384, "body": "I believe it works! Sorry for all the questions, new to vba, but from the site I do not understand how to solve the next error:  Run time error &#39;438&#39; Object doesn&#39;t support this property or method. @sous2817"}, {"owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "edited": false, "score": 0, "creation_date": 1435180739, "post_id": 31036484, "comment_id": 50098582, "body": "You may want to ask a new question (if this one was solved) and in it post the code related to the next error, but it would be easier if you provide more context describing what the functionality is meant to accomplish"}], "tags": [], "owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "is_accepted": true, "score": 1, "last_activity_date": 1435179039, "last_edit_date": 1435179039, "creation_date": 1435178000, "answer_id": 31036484, "question_id": 31036314, "link": "https://stackoverflow.com/questions/31036314/invalid-outside-procedure/31036484#31036484", "title": "Invalid Outside Procedure", "body": "<p>Your For loop is outside the Sub()</p>\n\n<p>Try this:</p>\n\n<pre><code>Option Explicit\n\nSub NewCost()\n\n    Dim i As Long\n\n    For i = 1 To 37918\n        With Sheets(\"nw\")\n            If .Cells(i, 1) = .Cells(6, 3) And .Celss(i, 2) &gt; .Cells(i, 2) Then\n                .Cells(15, 22) = .Cells(i, 3)\n            End If\n        End With\n    Next\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 5046251, "user_type": "registered", "profile_image": "https://graph.facebook.com/916819751697630/picture?type=large", "display_name": "i.c.", "link": "https://stackoverflow.com/users/5046251/i-c"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 235, "favorite_count": 0, "accepted_answer_id": 31036484, "answer_count": 2, "score": 2, "last_activity_date": 1435179316, "creation_date": 1435177503, "last_edit_date": 1435179316, "question_id": 31036314, "link": "https://stackoverflow.com/questions/31036314/invalid-outside-procedure", "title": "Invalid Outside Procedure", "body": "<p>I searched for solutions on the web for my problem, but couldn't find them. When running the following, I get the error: <em>Invalid outside procedure</em> for the second line. Does anyone have suggestions how to solve this? Thank you.</p>\n\n<pre><code>Dim i As Integer\n\nFor i = 1 To 37918\n\nIf Sheets(\"nw\").Cells(i, 1).Value = Cells(6, 3).Value And Sheets(\"nw\").Celss(i, 2) &gt; Sheets(\"nw\").Cells(i, 2).Value Then Sheets(\"nw\").Cells(15, 22).Value = Sheets(\"nw\").Cells(i, 3).Value\nEnd If\nNext i\n\nEnd Sub\n\n\nSub NewCost()\n\nEnd Sub\n</code></pre>\n\n<p>Also, when I place <code>Sub NewCost()</code> above <code>Dim i as integer</code> I get the error:</p>\n\n<blockquote>\n  <p>end if without block if </p>\n</blockquote>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 7422, "user_id": 1586390, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f07270207034d2bcbe347b028edc8f02?s=128&d=identicon&r=PG", "display_name": "Sorceri", "link": "https://stackoverflow.com/users/1586390/sorceri"}, "edited": false, "score": 0, "creation_date": 1435177466, "post_id": 31036208, "comment_id": 50096862, "body": "vrtSelectedItem is never assigned a value, may tell the user to use SelectedItems.Item(1)"}, {"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "reply_to_user": {"reputation": 7422, "user_id": 1586390, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f07270207034d2bcbe347b028edc8f02?s=128&d=identicon&r=PG", "display_name": "Sorceri", "link": "https://stackoverflow.com/users/1586390/sorceri"}, "edited": false, "score": 0, "creation_date": 1435177545, "post_id": 31036208, "comment_id": 50096907, "body": "@Sorceri I personally don&#39;t believe <i>any</i> of the original code will work as it&#39;s <b>full</b> of syntax errors - but that wasn&#39;t what the OP asked :) - I&#39;m just demonstrating the logic required to pass the variable."}], "tags": [], "owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "is_accepted": false, "score": 0, "last_activity_date": 1435177193, "creation_date": 1435177193, "answer_id": 31036208, "question_id": 31036081, "link": "https://stackoverflow.com/questions/31036081/vba-filepath-object-syntax/31036208#31036208", "title": "VBA filepath object syntax", "body": "<p>Either make the variable Public, outside the scope of a procedure:</p>\n\n<pre><code>Public vrtSelectedItem As String\n\nSub Main()\nDim fd As FileDialog\n\nSet fd = Application.FileDialog(msoFileDialogFilePicker)\nDim vrtSelectedItem As Variant\nWith fd\n    If .Show = -1 Then\n            MsgBox \"The path is: \" &amp; vrtSelectedItem\n        Next vrtSelectedItem        Else\n    End If\nEnd With\n\nSet fd = myVariable\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p>Or make the procedure a UDF that returns a string argument:</p>\n\n<pre><code>Function GetPath() As String\nDim fd As FileDialog\n\nSet fd = Application.FileDialog(msoFileDialogFilePicker)\nDim vrtSelectedItem As Variant\nWith fd\n    If .Show = -1 Then\n            MsgBox \"The path is: \" &amp; vrtSelectedItem\n        Next vrtSelectedItem        Else\n    End If\nEnd With\n\nGetPath = CStr(vrtSelectedItem)\n\nEnd Function\n\nSub Example()\n    Dim myFilePath As String\n\n    myFilePath = GetPath &amp; IIf(Right(myFilePath, 1)= \"\\\", vbNullString, \"\\\")\n    MsgBox myFilePath\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p>Then finally, you would use:</p>\n\n<pre><code>.Range(\"A1:A2\").FormulaR1C1 = \"=INDEX('\" &amp; myFilePath &amp; \"_06_23_15_v3.xlsx'!Table1[scheduleddate],MATCH([ @HostName],'\" &amp; myFilePath &amp; \"_06_23_15_v3.xlsx'!Table1[computername],0))\"\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 5045766, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65be0708f1115d4a199a45d35f6a43e1?s=128&d=identicon&r=PG&f=1", "display_name": "Alex Cohen", "link": "https://stackoverflow.com/users/5045766/alex-cohen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 236, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1435177193, "creation_date": 1435176770, "last_edit_date": 1435176997, "question_id": 31036081, "link": "https://stackoverflow.com/questions/31036081/vba-filepath-object-syntax", "title": "VBA filepath object syntax", "body": "<p>I have the following code in VBA in excel:</p>\n\n<pre><code>Sub Main()\nDim fd As FileDialog\n\nSet fd = Application.FileDialog(msoFileDialogFilePicker)\nDim vrtSelectedItem As Variant\nWith fd\n    If .Show = -1 Then\n            MsgBox \"The path is: \" &amp; vrtSelectedItem\n        Next vrtSelectedItem        Else\n    End If\nEnd With\n\nSet fd = myVariable\nEnd Sub\n</code></pre>\n\n<p>What is the context for taking the filepath that the user chose and putting it into the macro?</p>\n\n<p>So if I want to replace the file path of Computer&amp;DelploymentInfo in this code:</p>\n\n<pre><code> .Range(\"A1:A2\").FormulaR1C1 = \"=INDEX('Computer&amp;DeploymentInfo_06_23_15_v3.xlsx'!Table1[scheduleddate],MATCH([ @HostName],'Computer&amp;DeploymentInfo_06_23_15_v3.xlsx'!Table1[computername],0))\"\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 8006, "user_id": 2753501, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0a5ac280a03c3a9d89488dc33f0ef075?s=128&d=identicon&r=PG&f=1", "display_name": "ZygD", "link": "https://stackoverflow.com/users/2753501/zygd"}, "edited": false, "score": 0, "creation_date": 1435215098, "post_id": 31035993, "comment_id": 50108963, "body": "Could you please share, what you mention you tried?"}, {"owner": {"reputation": 23, "user_id": 5046195, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-vorxM6ju7YY/AAAAAAAAAAI/AAAAAAAAAac/S0u7MAogM2k/photo.jpg?sz=128", "display_name": "Chi Smith", "link": "https://stackoverflow.com/users/5046195/chi-smith"}, "reply_to_user": {"reputation": 8006, "user_id": 2753501, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0a5ac280a03c3a9d89488dc33f0ef075?s=128&d=identicon&r=PG&f=1", "display_name": "ZygD", "link": "https://stackoverflow.com/users/2753501/zygd"}, "edited": false, "score": 0, "creation_date": 1435326493, "post_id": 31035993, "comment_id": 50168309, "body": "I tried manipulating code from this question: <a href=\"http://stackoverflow.com/questions/26986063/excel-macro-to-copy-specific-columns-conditionally-to-another-worksheet\" title=\"excel macro to copy specific columns conditionally to another worksheet\">stackoverflow.com/questions/26986063/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 8006, "user_id": 2753501, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0a5ac280a03c3a9d89488dc33f0ef075?s=128&d=identicon&r=PG&f=1", "display_name": "ZygD", "link": "https://stackoverflow.com/users/2753501/zygd"}, "is_accepted": true, "score": 1, "last_activity_date": 1435492849, "creation_date": 1435492849, "answer_id": 31099547, "question_id": 31035993, "link": "https://stackoverflow.com/questions/31035993/conditionally-moving-columns/31099547#31099547", "title": "Conditionally moving columns", "body": "<p>I've corrected a bit the code that you linked.</p>\n\n<p>First, take a look at my original data:</p>\n\n<p><img src=\"https://i.stack.imgur.com/QAmus.jpg\" alt=\"before1\"> <img src=\"https://i.stack.imgur.com/VLEWa.jpg\" alt=\"before2\"></p>\n\n<p>The code (change the values in the first 4 commented lines to what you need):</p>\n\n<pre><code>Option Explicit\n\nSub Move_Inactive_to_Other_Sheet()\n    Const sOrigSheet As String = \"Sheet1\"       'Name of the original sheet\n    Const lStatusRow As Long = 2                'the # of row where you have Status in the original sheet\n    Const sInactSheet As String = \"inactive\"    'Name of the sheet where inactive data is put\n    Const lInactStartCol As Long = 2            'Column # in the Inactive data sheet where data starts to be put\n    Dim lColCount As Long\n    Dim c As Long\n    Dim i As Long\n    Dim Sh1 As Worksheet, Sh2 As Worksheet\n    Set Sh1 = ThisWorkbook.Worksheets(sOrigSheet)\n    Set Sh2 = ThisWorkbook.Worksheets(sInactSheet)\n\n    lColCount = Range(Sh1.Cells(1, 1), Sh1.UsedRange).Rows.Count\n    i = lInactStartCol\n    For c = 1 To lColCount\n        If Sh1.Cells(lStatusRow, c).Value = \"inactive\" Then\n            Sh1.Columns(c).Copy Destination:=Sh2.Columns(i)\n            Sh1.Columns(c).EntireColumn.Delete\n            c = c - 1\n            i = i + 1\n        End If\n    Next\n    Sh2.Activate\nEnd Sub\n</code></pre>\n\n<p>The result after the code was run:</p>\n\n<p><img src=\"https://i.stack.imgur.com/R0o7l.jpg\" alt=\"after1\"> <img src=\"https://i.stack.imgur.com/SssxG.jpg\" alt=\"after2\"></p>\n"}], "owner": {"reputation": 23, "user_id": 5046195, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-vorxM6ju7YY/AAAAAAAAAAI/AAAAAAAAAac/S0u7MAogM2k/photo.jpg?sz=128", "display_name": "Chi Smith", "link": "https://stackoverflow.com/users/5046195/chi-smith"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 93, "favorite_count": 1, "accepted_answer_id": 31099547, "answer_count": 1, "score": 0, "last_activity_date": 1435492849, "creation_date": 1435176391, "last_edit_date": 1435329117, "question_id": 31035993, "link": "https://stackoverflow.com/questions/31035993/conditionally-moving-columns", "title": "Conditionally moving columns", "body": "<p>I have a series of grants I am keeping track of and one of the rows is \"Status\", which can either be \"Active\" or \"Inactive\". When the status changes to \"Inactive\", I would like that column to be copied to another sheet titled \"Inactive\". The original can either be deleted or I can create another sheet for active grants called \"Active\" and have the same process take place for those, whichever is easier. </p>\n\n<p>I tried to modify some code I found on the internet for similar processes, but I had no luck. It's been years since my basic C+ course in college! I guess this may be more complicated, moving columns rather than rows, but this is how I need it to go.</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 97, "user_id": 2220670, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/fcfa2cc3938d159894f9dd5677b2a87e?s=128&d=identicon&r=PG", "display_name": "user2220670", "link": "https://stackoverflow.com/users/2220670/user2220670"}, "edited": false, "score": 0, "creation_date": 1435176519, "post_id": 31035991, "comment_id": 50096351, "body": "The vb script is in the active workbook and it is a different file.  The vb script will run on open"}, {"owner": {"reputation": 414, "user_id": 3750262, "user_type": "registered", "accept_rate": 83, "profile_image": "https://graph.facebook.com/903190092/picture?type=large", "display_name": "Greg", "link": "https://stackoverflow.com/users/3750262/greg"}, "reply_to_user": {"reputation": 97, "user_id": 2220670, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/fcfa2cc3938d159894f9dd5677b2a87e?s=128&d=identicon&r=PG", "display_name": "user2220670", "link": "https://stackoverflow.com/users/2220670/user2220670"}, "edited": false, "score": 0, "creation_date": 1435176662, "post_id": 31035991, "comment_id": 50096416, "body": "You need to use ThisWorkbook instead of ActiveWorkbook."}, {"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "reply_to_user": {"reputation": 97, "user_id": 2220670, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/fcfa2cc3938d159894f9dd5677b2a87e?s=128&d=identicon&r=PG", "display_name": "user2220670", "link": "https://stackoverflow.com/users/2220670/user2220670"}, "edited": false, "score": 0, "creation_date": 1435176743, "post_id": 31035991, "comment_id": 50096472, "body": "@user2220670 - Is this <code>VB Script</code> or is it <code>VBA</code>? There are important differences..."}, {"owner": {"reputation": 97, "user_id": 2220670, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/fcfa2cc3938d159894f9dd5677b2a87e?s=128&d=identicon&r=PG", "display_name": "user2220670", "link": "https://stackoverflow.com/users/2220670/user2220670"}, "edited": false, "score": 1, "creation_date": 1435176944, "post_id": 31035991, "comment_id": 50096572, "body": "Greg, I missed your comment about ThisWorkbook.  I just saw it and used it and it worked.  Thanks a lot."}], "tags": [], "owner": {"reputation": 414, "user_id": 3750262, "user_type": "registered", "accept_rate": 83, "profile_image": "https://graph.facebook.com/903190092/picture?type=large", "display_name": "Greg", "link": "https://stackoverflow.com/users/3750262/greg"}, "is_accepted": true, "score": 1, "last_activity_date": 1435176765, "last_edit_date": 1435176765, "creation_date": 1435176391, "answer_id": 31035991, "question_id": 31035877, "link": "https://stackoverflow.com/questions/31035877/excel-comments-not-being-pasted-after-copy/31035991#31035991", "title": "Excel comments not being pasted after copy", "body": "<p>You need to use <strong>ThisWorkbook</strong> instead of <strong>ActiveWorkbook</strong>.</p>\n\n<p>Currently your code copies and pastes from/to the same location. After opening workbook x it will become the active workbook, so workbook y is the same as workbook x.</p>\n"}], "owner": {"reputation": 97, "user_id": 2220670, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/fcfa2cc3938d159894f9dd5677b2a87e?s=128&d=identicon&r=PG", "display_name": "user2220670", "link": "https://stackoverflow.com/users/2220670/user2220670"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 97, "favorite_count": 0, "accepted_answer_id": 31035991, "answer_count": 1, "score": 2, "last_activity_date": 1435176765, "creation_date": 1435176015, "last_edit_date": 1435176548, "question_id": 31035877, "link": "https://stackoverflow.com/questions/31035877/excel-comments-not-being-pasted-after-copy", "title": "Excel comments not being pasted after copy", "body": "<p>I am trying to copy and paste comments from one Excel workbook to another, but <strong>the comments don't get pasted after being copied from the first workbook</strong>. </p>\n\n<p>Here is my code:</p>\n\n<pre><code>  Sub Comments()\n    Dim x As Workbook\n    Dim y As Workbook\n\n    Set x = Workbooks.Open(\"C:\\Exportbook.xlsx\")\n    Set y = ActiveWorkbook\n\n    x.Sheets(\"Tablets\").Range(\"E10:AQ2000\").Copy\n    y.Sheets(\"Tablets\").Range(\"E10:AQ2000\").PasteSpecial Paste:=xlPasteComments\n\n    x.Close SaveChanges:=False\n\n  End Sub\n</code></pre>\n"}, {"tags": ["ms-access", "vba", "filepath", "linked-tables"], "comments": [{"owner": {"reputation": 414, "user_id": 3750262, "user_type": "registered", "accept_rate": 83, "profile_image": "https://graph.facebook.com/903190092/picture?type=large", "display_name": "Greg", "link": "https://stackoverflow.com/users/3750262/greg"}, "edited": false, "score": 0, "creation_date": 1435176138, "post_id": 31035826, "comment_id": 50096146, "body": "Could you not just set filepath = &quot;C:\\Users\\&quot; &amp; username &amp; &quot;\\Desktop...&quot;"}], "answers": [{"tags": [], "owner": {"reputation": 31052, "user_id": 4280, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bc588d9f099467ce6bc6fc68426119aa?s=128&d=identicon&r=PG", "display_name": "Dick Kusleika", "link": "https://stackoverflow.com/users/4280/dick-kusleika"}, "is_accepted": true, "score": 0, "last_activity_date": 1435180778, "creation_date": 1435180778, "answer_id": 31037257, "question_id": 31035826, "link": "https://stackoverflow.com/questions/31035826/changing-a-linked-table-file-path-to-os-username-in-vba/31037257#31037257", "title": "Changing a linked table file path to OS username in VBA?", "body": "<p>The TableDef object has a Connect property that you need to change. It's a Read/Write String. You just need some string manipulation to make it how you want. Note that if they're moving the database file to the same path, you can just pull <code>CurrentProject.Path</code> rather than futzing with username APIs.</p>\n\n<pre><code>Sub ChangeTableLink()\n\n    Dim sNewPath As String\n    Dim lDbaseStart As Long\n    Dim td As TableDef\n    Dim sFile As String\n    Dim db As DAO.Database\n\n    'This is what we look for in the Connect string\n    Const sDBASE As String = \"DATABASE=\"\n\n    'Set a variable to CurrentDb and to the table\n    Set db = CurrentDb\n    Set td = db.TableDefs(\"Fuel Pricing\")\n\n    'Whatever your new path is, set it here\n    sNewPath = CurrentProject.Path &amp; \"\\\"\n\n    'Find where the database piece starts\n    lDbaseStart = InStr(1, td.Connect, sDBASE)\n\n    'As long as you found it\n    If lDbaseStart &gt; 0 Then\n        'Separate out the file name\n        sFile = Dir(Mid(td.Connect, lDbaseStart + Len(sDBASE), Len(td.Connect)))\n\n        'Rewrite Connect and refresh it\n        td.Connect = Left(td.Connect, lDbaseStart - 1) &amp; sDBASE &amp; sNewPath &amp; sFile\n        td.RefreshLink\n    End If\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 5045965, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0908f1dd0fc08b48cf2c8a509b7bb3f4?s=128&d=identicon&r=PG&f=1", "display_name": "Ashley", "link": "https://stackoverflow.com/users/5045965/ashley"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1736, "favorite_count": 1, "accepted_answer_id": 31037257, "answer_count": 1, "score": 1, "last_activity_date": 1435180778, "creation_date": 1435175860, "question_id": 31035826, "link": "https://stackoverflow.com/questions/31035826/changing-a-linked-table-file-path-to-os-username-in-vba", "title": "Changing a linked table file path to OS username in VBA?", "body": "<p>I have linked tables in an Access Database. I want to share this database and the associated excel workbooks with other users. I want to program a one-time use macro that the user will use the first time they use the database to relink the linked tables to the new user's local folder. </p>\n\n<p>For example:</p>\n\n<p>The linked table is current pulling the file from:<br>\nC:\\Users\\jane.doe\\Desktop\\Database Imports\\Premier Account List.xlsx</p>\n\n<p>When the new user (let's say their name is John Smith) relinks the table, it needs to read:\nC:\\Users\\john.smith\\Desktop\\Database Imports\\Premier Account List.xlsx</p>\n\n<p>I basically want to change the file path from my OS Username to new user's OS Username. I already have the code to pull the OS Username, but I'm not sure how to code changing the file path. Here is the code to pull the OS UserName:</p>\n\n<pre><code>Private Declare Function apiGetUserName Lib \"advapi32.dll\" Alias _\n\"GetUserNameA\" (ByVal lpBuffer As String, nSize As Long) As Long\n\nFunction fOSUserName() As String\n\n' Returns the network login name\nDim lngLen As Long, lngX As Long\nDim strUserName As String\n\nstrUserName = String$(254, 0)\nlngLen = 255\nlngX = apiGetUserName(strUserName, lngLen)\n\nIf (lngX &gt; 0) Then\n    fOSUserName = Left$(strUserName, lngLen - 1)\nElse\n    fOSUserName = vbNullString\nEnd If\n\nEnd Function\n</code></pre>\n\n<p>I am fairly new to VBA/Access, so if you could be as specific as possible with your answer, that would be great. Thanks in advanced!</p>\n"}, {"tags": ["vba", "excel", "copy-paste"], "comments": [{"owner": {"reputation": 414, "user_id": 3750262, "user_type": "registered", "accept_rate": 83, "profile_image": "https://graph.facebook.com/903190092/picture?type=large", "display_name": "Greg", "link": "https://stackoverflow.com/users/3750262/greg"}, "edited": false, "score": 0, "creation_date": 1435175702, "post_id": 31035713, "comment_id": 50095872, "body": "Declare a variable to track the next open row. Loop through the workbooks. Paste starting with the open row and increment the open row by the number of rows pasted."}, {"owner": {"reputation": 1, "user_id": 5046090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c0c77b2ce7fed4b62d2b9bbcd4038597?s=128&d=identicon&r=PG&f=1", "display_name": "Oguh", "link": "https://stackoverflow.com/users/5046090/oguh"}, "reply_to_user": {"reputation": 414, "user_id": 3750262, "user_type": "registered", "accept_rate": 83, "profile_image": "https://graph.facebook.com/903190092/picture?type=large", "display_name": "Greg", "link": "https://stackoverflow.com/users/3750262/greg"}, "edited": false, "score": 0, "creation_date": 1435176759, "post_id": 31035713, "comment_id": 50096482, "body": "Thanks ! I didn&#39;t know the term &quot;loop through&quot; so I searched for that and it helped. I don&#39;t think there is a way to loop specifically for Patient1GlobalP then 2 then 3 if all files are in the same folder so I guess the best way to do it is to put each condition in a different folder and then loop through that ?"}, {"owner": {"reputation": 414, "user_id": 3750262, "user_type": "registered", "accept_rate": 83, "profile_image": "https://graph.facebook.com/903190092/picture?type=large", "display_name": "Greg", "link": "https://stackoverflow.com/users/3750262/greg"}, "edited": false, "score": 0, "creation_date": 1435176951, "post_id": 31035713, "comment_id": 50096582, "body": "You could loop through all the workbooks, then test the workbook name to see if it is one that should be appended. Alternatively you could create the list of workbook names you&#39;d like to append using a loop, then do your copy and paste operation for each name in your list."}], "answers": [{"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 0, "last_activity_date": 1435208869, "creation_date": 1435208869, "answer_id": 31041640, "question_id": 31035713, "link": "https://stackoverflow.com/questions/31035713/copy-and-paste-data-from-the-next-excel-sheet-vba/31041640#31041640", "title": "Copy and paste data from the next Excel sheet VBA", "body": "<p>Here's one possible approach:</p>\n\n<pre><code>Sub Tester()\n\n    Const SRC_FLDR As String = \"C:\\something\\myfiles\\\"\n\n    Dim wbM As Workbook, wbS As Workbook, shtS As Worksheet\n    Dim i As Long, colOff As Long\n\n    Set wbM = Workbooks(\"master.xlsx\")\n\n    colOff = 0 'paste position offset\n\n    For i = 1 To 10 'eg\n        Set wbS = Workbooks.Open(SRC_FLDR &amp; \"Patient\" &amp; i &amp; \"GlobalP.xlsm\")\n        Set shtS = wbS.Sheets(1)\n\n        'copy ranges to specific positions on Master sheets\n        '  offset changes each time through the loop\n        'NOTE: no need to use Activate/Select here\n        shtS.Range(\"B1:B1505\").Copy wbS.Sheets(\"Ankle X\").Range(\"C2\").Offset(0, colOff)\n        shtS.Range(\"C1:C1505\").Copy wbS.Sheets(\"Ankle Y\").Range(\"C2\").Offset(0, colOff)\n        shtS.Range(\"C1:C1505\").Copy wbS.Sheets(\"Ankle Z\").Range(\"C2\").Offset(0, colOff)\n        'etc...\n        'etc...\n\n        wbS.Close savechanges:=False\n        colOff = colOff + 1\n\n    Next i\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 5046090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c0c77b2ce7fed4b62d2b9bbcd4038597?s=128&d=identicon&r=PG&f=1", "display_name": "Oguh", "link": "https://stackoverflow.com/users/5046090/oguh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 261, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1435216335, "creation_date": 1435175432, "last_edit_date": 1435216335, "question_id": 31035713, "link": "https://stackoverflow.com/questions/31035713/copy-and-paste-data-from-the-next-excel-sheet-vba", "title": "Copy and paste data from the next Excel sheet VBA", "body": "<p>I'm a complete beginner with VBA and I looked at other topics but couldn't really find an answer (at least that I could understand). </p>\n\n<p>Basically I have Excel workbooks for different subjects during a research project. </p>\n\n<p>I want to copy past some data from the subjects workbook and past it to a master Workbook. This code does it for one subject. </p>\n\n<p>It open the selected workbook, copy past what is needed in the right place then close it then open the next condition etc. </p>\n\n<p>I'd like to find a way to tell it to open the next workbook (ie: Patient1GlobalP.xlsm becomes Patient2GlobalP.xlsm, then 3 then 4...) and do the same but copy to the next cell (the range that is copied stay the same but <code>Range(\"C2\").Select</code> becomes <code>Range(\"D2\").Select</code> for the copy destination, C1509 becomes D1509 and C3016 becomes D3016 then E then F...). I can do it by hand but there has to be a more elegant solution like some kind of offset. </p>\n\n<pre><code>Windows(\"Patient1GlobalP.xlsm\").Activate\n    Range(\"B1:B1505\").Select\n    Selection.Copy\n    Windows(\"master.xlsx\").Activate\n    Sheets(\"Ankle X\").Select\n    Range(\"C2\").Select\n    ActiveSheet.Paste\n    Application.CutCopyMode = False\n    Windows(\"Patient1GlobalP.xlsm\").Activate\n    Range(\"C1:C1505\").Select\n    Selection.Copy\n    Windows(\"master.xlsx\").Activate\n    Sheets(\"Ankle Y\").Select\n    Range(\"C2\").Select\n    ActiveSheet.Paste\n    Application.CutCopyMode = False\n    Windows(\"Patient1GlobalP.xlsm\").Activate\n    Windows(\"Patient1GlobalP.xlsm\").Activate\n    Range(\"C1:C1505\").Select\n    Selection.Copy\n    Windows(\"master.xlsx\").Activate\n    Sheets(\"Ankle Z\").Select\n    Range(\"C2\").Select\n    ActiveSheet.Paste\n    Application.CutCopyMode = False\n    Windows(\"Patient1GlobalP.xlsm\").Activate\n    Range(\"N1:N1505\").Select\n    Selection.Copy\n    Windows(\"master.xlsx\").Activate\n    Sheets(\"Knee X\").Select\n    Range(\"C2\").Select\n    ActiveSheet.Paste\n    Application.CutCopyMode = False\n        Windows(\"Patient1GlobalP.xlsm\").Activate\n    Range(\"O1:O1505\").Select\n    Selection.Copy\n    Windows(\"master.xlsx\").Activate\n    Sheets(\"Knee Y\").Select\n    Range(\"C2\").Select\n    ActiveSheet.Paste\n    Application.CutCopyMode = False\n        Windows(\"Patient1GlobalP.xlsm\").Activate\n    Range(\"P1:P1505\").Select\n    Selection.Copy\n    Windows(\"master.xlsx\").Activate\n    Sheets(\"Knee Z\").Select\n    Range(\"C2\").Select\n    ActiveSheet.Paste\n    Application.CutCopyMode = False\n        Windows(\"Patient1GlobalP.xlsm\").Activate\n    Range(\"I1:I1505\").Select\n    Selection.Copy\n    Windows(\"master.xlsx\").Activate\n    Sheets(\"Hip X\").Select\n    Range(\"C2\").Select\n    ActiveSheet.Paste\n    Application.CutCopyMode = False\n    Windows(\"Patient1GlobalP.xlsm\").Activate\n    Range(\"J1:J1505\").Select\n    Selection.Copy\n    Windows(\"master.xlsx\").Activate\n    Sheets(\"Hip Y\").Select\n    Range(\"C2\").Select\n    ActiveSheet.Paste\n    Application.CutCopyMode = False\n    Windows(\"Patient1GlobalP.xlsm\").Activate\n    Range(\"J1:J1505\").Select\n    Selection.Copy\n    Windows(\"master.xlsx\").Activate\n    Sheets(\"Hip Z\").Select\n    Range(\"C2\").Select\n    ActiveSheet.Paste\n    Application.CutCopyMode = False\nWorkbooks.Open Filename:=\"C:\\Users\\hugo\\Desktop\\data\\Patient1LocalP.xlsx\"\n    Windows(\"Patient1LocalP.xlsx\").Activate\n    Range(\"B1:B1505\").Select\n    Selection.Copy\n    Windows(\"master.xlsx\").Activate\n    Sheets(\"Ankle X\").Select\n    Range(\"C1509\").Select\n    ActiveSheet.Paste\n    Application.CutCopyMode = False\n    Windows(\"Patient1LocalP.xlsx\").Activate\n    Range(\"C1:C1505\").Select\n    Selection.Copy\n    Windows(\"master.xlsx\").Activate\n    Sheets(\"Ankle Y\").Select\n    Range(\"C1509\").Select\n    ActiveSheet.Paste\n    Application.CutCopyMode = False\n    Windows(\"Patient1LocalP.xlsx\").Activate\n    Windows(\"Patient1LocalP.xlsx\").Activate\n    Range(\"C1:C1505\").Select\n    Selection.Copy\n    Windows(\"master.xlsx\").Activate\n    Sheets(\"Ankle Z\").Select\n    Range(\"C1509\").Select\n    ActiveSheet.Paste\n    Application.CutCopyMode = False\n    Windows(\"Patient1LocalP.xlsx\").Activate\n    Range(\"N1:N1505\").Select\n    Selection.Copy\n    Windows(\"master.xlsx\").Activate\n    Sheets(\"Knee X\").Select\n    Range(\"C1509\").Select\n    ActiveSheet.Paste\n    Application.CutCopyMode = False\n        Windows(\"Patient1LocalP.xlsx\").Activate\n    Range(\"O1:O1505\").Select\n    Selection.Copy\n    Windows(\"master.xlsx\").Activate\n    Sheets(\"Knee Y\").Select\n    Range(\"C1509\").Select\n    ActiveSheet.Paste\n    Application.CutCopyMode = False\n        Windows(\"Patient1LocalP.xlsx\").Activate\n    Range(\"P1:P1505\").Select\n    Selection.Copy\n    Windows(\"master.xlsx\").Activate\n    Sheets(\"Knee Z\").Select\n    Range(\"C1509\").Select\n    ActiveSheet.Paste\n    Application.CutCopyMode = False\n        Windows(\"Patient1LocalP.xlsx\").Activate\n    Range(\"I1:I1505\").Select\n    Selection.Copy\n    Windows(\"master.xlsx\").Activate\n    Sheets(\"Hip X\").Select\n    Range(\"C1509\").Select\n    ActiveSheet.Paste\n    Application.CutCopyMode = False\n    Windows(\"Patient1LocalP.xlsx\").Activate\n    Range(\"J1:J1505\").Select\n    Selection.Copy\n    Windows(\"master.xlsx\").Activate\n    Sheets(\"Hip Y\").Select\n    Range(\"C1509\").Select\n    ActiveSheet.Paste\n    Application.CutCopyMode = False\n    Windows(\"Patient1LocalP.xlsx\").Activate\n    Range(\"J1:J1505\").Select\n    Selection.Copy\n    Windows(\"master.xlsx\").Activate\n    Sheets(\"Hip Z\").Select\n    Range(\"C1509\").Select\n    ActiveSheet.Paste\n    Application.CutCopyMode = False\n    Windows(\"Patient1LocalP.xlsx\").Activate\n    ActiveWindow.Close\n    Workbooks.Open Filename:=\"C:\\Users\\hugo\\Desktop\\data\\Patient1Nopert.xlsx\"\n    Windows(\"Patient1Nopert.xlsx\").Activate\n    Range(\"B1:B1505\").Select\n    Selection.Copy\n    Windows(\"master.xlsx\").Activate\n    Sheets(\"Ankle X\").Select\n    Range(\"C3016\").Select\n    ActiveSheet.Paste\n    Application.CutCopyMode = False\n    Windows(\"Patient1Nopert.xlsx\").Activate\n    Range(\"C1:C1505\").Select\n    Selection.Copy\n    Windows(\"master.xlsx\").Activate\n    Sheets(\"Ankle Y\").Select\n    Range(\"C3016\").Select\n    ActiveSheet.Paste\n    Application.CutCopyMode = False\n    Windows(\"Patient1Nopert.xlsx\").Activate\n    Windows(\"Patient1Nopert.xlsx\").Activate\n    Range(\"C1:C1505\").Select\n    Selection.Copy\n    Windows(\"master.xlsx\").Activate\n    Sheets(\"Ankle Z\").Select\n    Range(\"C3016\").Select\n    ActiveSheet.Paste\n    Application.CutCopyMode = False\n    Windows(\"Patient1Nopert.xlsx\").Activate\n    Range(\"N1:N1505\").Select\n    Selection.Copy\n    Windows(\"master.xlsx\").Activate\n    Sheets(\"Knee X\").Select\n    Range(\"C3016\").Select\n    ActiveSheet.Paste\n    Application.CutCopyMode = False\n        Windows(\"Patient1Nopert.xlsx\").Activate\n    Range(\"O1:O1505\").Select\n    Selection.Copy\n    Windows(\"master.xlsx\").Activate\n    Sheets(\"Knee Y\").Select\n    Range(\"C3016\").Select\n    ActiveSheet.Paste\n    Application.CutCopyMode = False\n        Windows(\"Patient1Nopert.xlsx\").Activate\n    Range(\"P1:P1505\").Select\n    Selection.Copy\n    Windows(\"master.xlsx\").Activate\n    Sheets(\"Knee Z\").Select\n    Range(\"C3016\").Select\n    ActiveSheet.Paste\n    Application.CutCopyMode = False\n        Windows(\"Patient1Nopert.xlsx\").Activate\n    Range(\"I1:I1505\").Select\n    Selection.Copy\n    Windows(\"master.xlsx\").Activate\n    Sheets(\"Hip X\").Select\n    Range(\"C3016\").Select\n    ActiveSheet.Paste\n    Application.CutCopyMode = False\n    Windows(\"Patient1Nopert.xlsx\").Activate\n    Range(\"J1:J1505\").Select\n    Selection.Copy\n    Windows(\"master.xlsx\").Activate\n    Sheets(\"Hip Y\").Select\n    Range(\"C3016\").Select\n    ActiveSheet.Paste\n    Application.CutCopyMode = False\n    Windows(\"Patient1Nopert.xlsx\").Activate\n    Range(\"J1:J1505\").Select\n    Selection.Copy\n    Windows(\"master.xlsx\").Activate\n    Sheets(\"Hip Z\").Select\n    Range(\"C3016\").Select\n    ActiveSheet.Paste\n    Application.CutCopyMode = False\n    Windows(\"Patient1Nopert.xlsx\").Activate\n    ActiveWindow.Close\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 4801, "user_id": 4713729, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/PL9tu.jpg?s=128&g=1", "display_name": "vacip", "link": "https://stackoverflow.com/users/4713729/vacip"}, "edited": false, "score": 0, "creation_date": 1435175277, "post_id": 31035315, "comment_id": 50095593, "body": "And putting that in ONE cell would require some really horrible syntax, something like <code>{{1,2};{2,2};{3,2}}</code>. Or is there a better way?"}, {"owner": {"reputation": 4801, "user_id": 4713729, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/PL9tu.jpg?s=128&g=1", "display_name": "vacip", "link": "https://stackoverflow.com/users/4713729/vacip"}, "edited": false, "score": 0, "creation_date": 1435175380, "post_id": 31035315, "comment_id": 50095666, "body": "Yeah, just seen, good solution. :) Also, I doubt mine would ever work, I don&#39;t think Excel accepts arrays of arrayas in a single cell..."}, {"owner": {"reputation": 168, "user_id": 5045790, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/66357fe391a498d8ad20bd7d76379160?s=128&d=identicon&r=PG&f=1", "display_name": "Englehas", "link": "https://stackoverflow.com/users/5045790/englehas"}, "edited": false, "score": 0, "creation_date": 1435187033, "post_id": 31035315, "comment_id": 50101044, "body": "Interesting, thank you for the workaround! It works great. So it looks like the problem here was that an Array has to be created in VBA since it&#39;s not text."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1435190038, "post_id": 31035315, "comment_id": 50101853, "body": "<code>Split()</code> already return an array, so I&#39;m not sure you need to wrap Split in <code>Array()</code> ?"}, {"owner": {"reputation": 7770, "user_id": 2142028, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ltfco.jpg?s=128&g=1", "display_name": "Maciej Los", "link": "https://stackoverflow.com/users/2142028/maciej-los"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1435241037, "post_id": 31035315, "comment_id": 50126290, "body": "@TimWilliams, Yeah, <code>Split</code> return an array of string, but not an array of variant. As i mentioned in my answer, i do not tested it. Maybe, <code>Split</code> is enough and does not need to be dressed up in <code>Array()</code>. Cheers, Maciej"}, {"owner": {"reputation": 7770, "user_id": 2142028, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ltfco.jpg?s=128&g=1", "display_name": "Maciej Los", "link": "https://stackoverflow.com/users/2142028/maciej-los"}, "reply_to_user": {"reputation": 168, "user_id": 5045790, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/66357fe391a498d8ad20bd7d76379160?s=128&d=identicon&r=PG&f=1", "display_name": "Englehas", "link": "https://stackoverflow.com/users/5045790/englehas"}, "edited": false, "score": 0, "creation_date": 1435246124, "post_id": 31035315, "comment_id": 50130482, "body": "@Englehas, Thank you ;)"}], "tags": [], "owner": {"reputation": 7770, "user_id": 2142028, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ltfco.jpg?s=128&g=1", "display_name": "Maciej Los", "link": "https://stackoverflow.com/users/2142028/maciej-los"}, "is_accepted": true, "score": 1, "last_activity_date": 1435176020, "last_edit_date": 1435176020, "creation_date": 1435174036, "answer_id": 31035315, "question_id": 31034992, "link": "https://stackoverflow.com/questions/31034992/vba-passing-cell-reference-into-method-parameter-value/31035315#31035315", "title": "VBA passing cell reference into method parameter value", "body": "<p>Based on <a href=\"https://msdn.microsoft.com/en-us/library/office/ff837097.aspx\" rel=\"nofollow\">MSDN documentation</a> <code>fieldInfo</code> input parameter is </p>\n\n<blockquote>\n  <p><em>an array  containing parse information for individual columns of data. The interpretation depends on the value of DataType. When the\n  data is delimited, this argument is an array of two-element arrays,\n  with each two-element array specifying the conversion options for a\n  particular column. The first element is the column number (1-based),\n  and the second element is one of the XlColumnDataType constants\n  specifying how the column is parsed.</em></p>\n</blockquote>\n\n<p>So, to be able to use it, you need to define an arrray of arrays of numbers:</p>\n\n<pre><code>1,2\n2,2\n3,1\n...\n</code></pre>\n\n<p>I'd save this:</p>\n\n<pre><code>Array(Array(1, 2), Array(2, 2), Array(3, 1), Array(4, 2), _\nArray(5, 1), Array(6, 1), Array(7, 1), Array(8, 1))\n</code></pre>\n\n<p>as:</p>\n\n<pre><code>1,2;2,2;3,1;4,2;5,1;6,1;7,1;8,1\n</code></pre>\n\n<p>then i'd try to split it via using function similar to:</p>\n\n<pre><code>Function GetFieldInfoFromCell(ByVal rCell As Range) As Variant\nDim i As Integer\nDim fi As String, fis() As String\nDim fieldInfo() As Variant\n\nfi = rCell\nfis = Split(fi, \";\")\nReDim Preserve fieldInfo(UBound(fis))\n\nFor i = LBound(fis) To UBound(fis)\n    fieldInfo(i) = Array(Split(fis(i), \",\"))\nNext\n\nGetFieldInfoFromCell = fieldInfo\n\nEnd Function\n</code></pre>\n\n<p>Usage:</p>\n\n<pre><code>Dim fieldInfo As Variant\n'later\nfieldInfo = GetFieldInfoFromCell(ThisWorkbook.Worksheets(1).Range(\"B5\"))\n</code></pre>\n\n<p>Note: Not tested!</p>\n"}], "owner": {"reputation": 168, "user_id": 5045790, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/66357fe391a498d8ad20bd7d76379160?s=128&d=identicon&r=PG&f=1", "display_name": "Englehas", "link": "https://stackoverflow.com/users/5045790/englehas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 591, "favorite_count": 0, "accepted_answer_id": 31035315, "answer_count": 1, "score": 2, "last_activity_date": 1435176020, "creation_date": 1435173043, "last_edit_date": 1435174079, "question_id": 31034992, "link": "https://stackoverflow.com/questions/31034992/vba-passing-cell-reference-into-method-parameter-value", "title": "VBA passing cell reference into method parameter value", "body": "<p>I'm using the Workbooks.OpenText method to open a text file in Excel using VBA and would like to pass the value in a cell, say B5, of the active workbook into the FieldInfo parameter. Specifically, I want to modify the following code:</p>\n\n<pre><code>Dim inputDir As String\nDim outputDir As String\nDim myFile As String\nDim inputDelim As String\nDim formatOptions As Variant\n\nmyFile = Range(\"B1\").Value\ninputDir = Range(\"B2\").Value\noutputDir = Range(\"B3\").Value\ninputDelim = Range(\"B4\").Value\nformatOptions = Range(\"B5\").Value\n\n        Workbooks.OpenText Filename:=inputDir &amp; myFile, StartRow:=1, _\n            DataType:=xlDelimited, TextQualifier:=xlNone, _\n            Other:=True, OtherChar:=inputDelim, _\n            FieldInfo:=formatOptions                \n</code></pre>\n\n<p>The value in B5 is</p>\n\n<pre><code>Array(Array(1, 2), Array(2, 2), Array(3, 1), Array(4, 2), _\nArray(5, 1), Array(6, 1), Array(7, 1), Array(8, 1))\n</code></pre>\n\n<p>When you hardcode this value into formatOptions in the last line of the code above, everything works fine i.e...</p>\n\n<pre><code>            Workbooks.OpenText Filename:=inputDir &amp; myFile, StartRow:=1, _\n            DataType:=xlDelimited, TextQualifier:=xlNone, _\n            Other:=True, OtherChar:=inputDelim, _\n            FieldInfo:=Array(Array(1, 2), Array(2, 2), Array(3, 1), Array(4, 2), _\n            Array(5, 1), Array(6, 1), Array(7, 1), Array(8, 1))\n</code></pre>\n\n<p>The problem I believe is that it is passing text surrounded by quotations. For the delimiter specification in the OtherChar parameter, if you hard code it, you include the quotes: \"|\" for example. But in the formatOptions parameter you don't put quotes around the Array code.</p>\n\n<p>I know there may be better ways to pass the array of column types into Workbooks.OpenText but I think this issue will come up in other contexts and would like to understand why it is not working and what can be done so that instead of passing a string, it passes the Array as a object/code (the Set method did not work). I have searched for many hours for a solution and can't find one although I have a feeling the answer is very simple and I am not searching for the right words. I have seen similar questions throughout the web but nothing addressing this specifically. Apologies if I overlooked something.</p>\n\n<p>Thank you in advance for any help I can get.</p>\n"}, {"tags": ["excel", "checkbox", "filter", "userform", "vba"], "comments": [{"owner": {"reputation": 3845, "user_id": 4288101, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O0Xld.jpg?s=128&g=1", "display_name": "Byron Wall", "link": "https://stackoverflow.com/users/4288101/byron-wall"}, "edited": false, "score": 0, "creation_date": 1435174391, "post_id": 31034572, "comment_id": 50095097, "body": "You probably need to build an <code>Array</code> of values based on the checkboxes.  You can then feed this <code>Array</code> to <code>Criteria1</code> to allow for multiple selection."}], "owner": {"reputation": 19, "user_id": 4962717, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/160259e8f031773fa4944430c43e37ae?s=128&d=identicon&r=PG&f=1", "display_name": "M.Rumery", "link": "https://stackoverflow.com/users/4962717/m-rumery"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1803, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1435232597, "creation_date": 1435171630, "last_edit_date": 1531161705, "question_id": 31034572, "link": "https://stackoverflow.com/questions/31034572/filter-options-using-checkboxes-in-an-excel-vba-userform", "title": "Filter Options Using Checkboxes in an Excel VBA Userform", "body": "<p>I'm working on a <code>userform</code> that allows the end user to filter first by individual business units, then select the \"flags\" (0, 1, 2) they want to see. The <code>combobox</code> that lists the various business units works fine, it's the \"flags\" I'm having an issue with.</p>\n\n<p>The users need to be able to select more than one flag to analyze. I orignally thought that using <code>Checkboxes</code> would be the way to go, however I can't seem to get the code to perform as I expect it to. If one <code>checkbox</code> is selected, it works fine, but if more than one is selected, it only filters by the value of the first <code>checkbox</code> selected.</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n   Application.ScreenUpdating = False\n\nActiveWorkbook.Sheets(\"Masterlist\").Activate\n    Range(\"I1\").Select\n    ActiveSheet.Range(\"I1\").AutoFilter Field:=9, Criteria1:=ComboBox1\n\nWith ActiveSheet\n    If CheckBox1.Value = True Then\n      ActiveSheet.Range(\"BL1\").AutoFilter Field:=64, Criteria1:=\"0\"\n    ElseIf CheckBox2.Value = True Then\n     ActiveSheet.Range(\"BL1\").AutoFilter Field:=64, Criteria1:=\"1\"\n    ElseIf CheckBox3.Value = True Then\n     ActiveSheet.Range(\"BL1\").AutoFilter Field:=64, Criteria1:=\"2\"\n    End If\nEnd With\n\nApplication.ScreenUpdating = True\nEnd Sub\n</code></pre>\n\n<p>Is there a better choice? Or can the code I already have be modified to work?</p>\n"}, {"tags": ["vba", "excel", "vbscript", "runtime-error"], "answers": [{"comments": [{"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 1, "creation_date": 1435171849, "post_id": 31034528, "comment_id": 50093674, "body": "I would also recommend not using the <code>:</code> to have multiple statements on one line. It&#39;s legal, but it&#39;s easy for humans to skip over it and not see potentially vital code."}, {"owner": {"reputation": 17, "user_id": 4196635, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/076a531defc8547a7eefa23b6cea6bbd?s=128&d=identicon&r=PG&f=1", "display_name": "Alicia Pavan", "link": "https://stackoverflow.com/users/4196635/alicia-pavan"}, "edited": false, "score": 0, "creation_date": 1435171890, "post_id": 31034528, "comment_id": 50093702, "body": "Thank you! I did not know that. But, do you have any idea why wouldn&#39;t it let me declare variables with its types? It now gives me an error since line 1."}, {"owner": {"reputation": 8006, "user_id": 2753501, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0a5ac280a03c3a9d89488dc33f0ef075?s=128&d=identicon&r=PG&f=1", "display_name": "ZygD", "link": "https://stackoverflow.com/users/2753501/zygd"}, "edited": false, "score": 0, "creation_date": 1435172010, "post_id": 31034528, "comment_id": 50093771, "body": "On line 1 I also replaced <code>WScript.CreateObject()</code> with just <code>CreateObject()</code>, as I had errors before. Try changing it back."}, {"owner": {"reputation": 17, "user_id": 4196635, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/076a531defc8547a7eefa23b6cea6bbd?s=128&d=identicon&r=PG&f=1", "display_name": "Alicia Pavan", "link": "https://stackoverflow.com/users/4196635/alicia-pavan"}, "edited": false, "score": 0, "creation_date": 1435172173, "post_id": 31034528, "comment_id": 50093867, "body": "It does not work either. While building by bigger code I also had to get rid of Dim myworkbook As Workbook, as it would not compile. Could there be any other factors affecting this?"}, {"owner": {"reputation": 8006, "user_id": 2753501, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0a5ac280a03c3a9d89488dc33f0ef075?s=128&d=identicon&r=PG&f=1", "display_name": "ZygD", "link": "https://stackoverflow.com/users/2753501/zygd"}, "edited": false, "score": 0, "creation_date": 1435172287, "post_id": 31034528, "comment_id": 50093917, "body": "I thought you were working on VBA, but it seems it&#39;s VBScript, so all those explicit declarations do not work in VBScript!"}, {"owner": {"reputation": 17, "user_id": 4196635, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/076a531defc8547a7eefa23b6cea6bbd?s=128&d=identicon&r=PG&f=1", "display_name": "Alicia Pavan", "link": "https://stackoverflow.com/users/4196635/alicia-pavan"}, "edited": false, "score": 0, "creation_date": 1435172423, "post_id": 31034528, "comment_id": 50094002, "body": "That would explain it! Yes, I am using VBSCRIPT, with Excel 97-2003."}], "tags": [], "owner": {"reputation": 8006, "user_id": 2753501, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0a5ac280a03c3a9d89488dc33f0ef075?s=128&d=identicon&r=PG&f=1", "display_name": "ZygD", "link": "https://stackoverflow.com/users/2753501/zygd"}, "is_accepted": true, "score": 2, "last_activity_date": 1435172216, "last_edit_date": 1435172216, "creation_date": 1435171500, "answer_id": 31034528, "question_id": 31034311, "link": "https://stackoverflow.com/questions/31034311/objworkbook-worksheets-count-not-working/31034528#31034528", "title": "ObjWorkbook.Worksheets.Count not working", "body": "<p>The following would do the job.</p>\n\n<p><strong>VBA version</strong></p>\n\n<pre><code>Dim Shell As Object: Set Shell = CreateObject(\"WScript.Shell\")\nDim oFSO As Object: Set oFSO = CreateObject(\"Scripting.FileSystemObject\")\nDim objExcel As Application: Set objExcel = CreateObject(\"Excel.Application\")\n\nDim myworkbook As Workbook, worksheetcount As Long\nSet myworkbook = objExcel.Workbooks.Open(\"C:\\Temp\\Test.xlsx\")\n\nOn Error Resume Next\nworksheetcount = myworkbook.Worksheets.Count\n\nIf Err.Number &lt;&gt; 0 Then\n    ShowError\n    myworkbook.Close False\nEnd If\n</code></pre>\n\n<p><strong>VBScript version</strong></p>\n\n<pre><code>Dim Shell: Set Shell = WScript.CreateObject(\"WScript.Shell\")\nDim oFSO: Set oFSO = CreateObject(\"Scripting.FileSystemObject\")\nDim objExcel: Set objExcel = CreateObject(\"Excel.Application\")\n\nDim myworkbook, worksheetcount\nSet myworkbook = objExcel.Workbooks.Open(\"C:\\Temp\\Test.xlsx\")\n\nOn Error Resume Next\nworksheetcount = myworkbook.Worksheets.Count\n\nIf Err.Number &lt;&gt; 0 Then\n    ShowError\n    myworkbook.Close False\nEnd If\n</code></pre>\n\n<p>You had error, because you tried to <code>Set</code> a value to <code>worksheetcount</code> which is not an object. You use <code>Set</code> only to objects.</p>\n"}], "owner": {"reputation": 17, "user_id": 4196635, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/076a531defc8547a7eefa23b6cea6bbd?s=128&d=identicon&r=PG&f=1", "display_name": "Alicia Pavan", "link": "https://stackoverflow.com/users/4196635/alicia-pavan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1481, "favorite_count": 0, "accepted_answer_id": 31034528, "answer_count": 1, "score": 1, "last_activity_date": 1435175059, "creation_date": 1435170821, "last_edit_date": 1435175059, "question_id": 31034311, "link": "https://stackoverflow.com/questions/31034311/objworkbook-worksheets-count-not-working", "title": "ObjWorkbook.Worksheets.Count not working", "body": "<p>I am trying to write a code to open an Excel file and then search through it. Even though, I am having problems just retrieving the number of worksheets in the workbook. I get the error:</p>\n\n<blockquote>\n  <p>424 - VBScript Runtime Error, Object Required</p>\n</blockquote>\n\n<p>Any thoughts? Here is the small portion of the code I am having problems with:</p>\n\n<pre><code>Dim Shell : Set Shell = WScript.CreateObject( \"WScript.Shell\" )\nDim oFSO : Set oFSO = CreateObject(\"Scripting.FileSystemObject\")\nDim objExcel : Set objExcel = CreateObject(\"Excel.Application\")\n\nDim myworkbook, worksheetcount\nSet myworkbook = objExcel.Workbooks.Open(\"C:\\Temp\\Test.xlsx\")\n\nOn Error Resume Next\nSet worksheetcount = myworkbook.worksheets.count 'fails\n\nIf Err.number &lt;&gt; 0 Then\n    ShowError()\n    myworkbook.Close False\nEnd if\n\nSub ShowError()\n    WScript.Echo Err.Number &amp; \" Srce: \" &amp; Err.Source &amp; \" Desc: \" &amp; Err.Description\n    Err.Clear\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 8006, "user_id": 2753501, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0a5ac280a03c3a9d89488dc33f0ef075?s=128&d=identicon&r=PG&f=1", "display_name": "ZygD", "link": "https://stackoverflow.com/users/2753501/zygd"}, "edited": false, "score": 0, "creation_date": 1435170686, "post_id": 31034134, "comment_id": 50092978, "body": "Please share whatever you tried."}, {"owner": {"reputation": 3845, "user_id": 4288101, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O0Xld.jpg?s=128&g=1", "display_name": "Byron Wall", "link": "https://stackoverflow.com/users/4288101/byron-wall"}, "edited": false, "score": 0, "creation_date": 1435174317, "post_id": 31034134, "comment_id": 50095054, "body": "Do you know where to paste to?  Or do you need to find the cell to paste to first?  Also a picture would go a long way if the data is not sensitive.  If you add a link to a picture (on imgur) to your post or a comment, I can add it to the post."}, {"owner": {"reputation": 1, "user_id": 5045848, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/08d903304038f18aa271cb22cd1815e3?s=128&d=identicon&r=PG&f=1", "display_name": "Clara Pardue", "link": "https://stackoverflow.com/users/5045848/clara-pardue"}, "reply_to_user": {"reputation": 3845, "user_id": 4288101, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O0Xld.jpg?s=128&g=1", "display_name": "Byron Wall", "link": "https://stackoverflow.com/users/4288101/byron-wall"}, "edited": false, "score": 0, "creation_date": 1435175574, "post_id": 31034134, "comment_id": 50095783, "body": "@Byron, unfortunately the data is sensitive so I cannot post images. I need the macro to be able to figure out the correct row to paste it in as the Updates tab only has one row of data information at a time coinciding with the client name that was chosen from the drop down menu."}, {"owner": {"reputation": 3845, "user_id": 4288101, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O0Xld.jpg?s=128&g=1", "display_name": "Byron Wall", "link": "https://stackoverflow.com/users/4288101/byron-wall"}, "edited": false, "score": 0, "creation_date": 1435175617, "post_id": 31034134, "comment_id": 50095812, "body": "Can you replace the real data with <code>asd</code> type data just to show the structure?"}, {"owner": {"reputation": 1, "user_id": 5045848, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/08d903304038f18aa271cb22cd1815e3?s=128&d=identicon&r=PG&f=1", "display_name": "Clara Pardue", "link": "https://stackoverflow.com/users/5045848/clara-pardue"}, "reply_to_user": {"reputation": 3845, "user_id": 4288101, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O0Xld.jpg?s=128&g=1", "display_name": "Byron Wall", "link": "https://stackoverflow.com/users/4288101/byron-wall"}, "edited": false, "score": 0, "creation_date": 1435181388, "post_id": 31034134, "comment_id": 50098879, "body": "@Byron, I have pictures but unfortunately the site is not letting me post them"}, {"owner": {"reputation": 3845, "user_id": 4288101, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O0Xld.jpg?s=128&g=1", "display_name": "Byron Wall", "link": "https://stackoverflow.com/users/4288101/byron-wall"}, "edited": false, "score": 0, "creation_date": 1435181521, "post_id": 31034134, "comment_id": 50098946, "body": "Throw a link in the comments or the body of the post (just a link, not the image part).  I will edit them in since I have the rep."}, {"owner": {"reputation": 1, "user_id": 5045848, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/08d903304038f18aa271cb22cd1815e3?s=128&d=identicon&r=PG&f=1", "display_name": "Clara Pardue", "link": "https://stackoverflow.com/users/5045848/clara-pardue"}, "edited": false, "score": 0, "creation_date": 1435239371, "post_id": 31034134, "comment_id": 50124847, "body": "C:\\Users\\a0686183\\Desktop\\pic2.jpg"}], "owner": {"reputation": 1, "user_id": 5045848, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/08d903304038f18aa271cb22cd1815e3?s=128&d=identicon&r=PG&f=1", "display_name": "Clara Pardue", "link": "https://stackoverflow.com/users/5045848/clara-pardue"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 57, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1435241333, "creation_date": 1435170211, "last_edit_date": 1435241333, "question_id": 31034134, "link": "https://stackoverflow.com/questions/31034134/copying-row-into-new-worksheet-on-correct-row-excel-vba", "title": "Copying row into new worksheet on correct row Excel VBA", "body": "<p>I have a workbook with three sheets: <code>Clients</code>, <code>Client Updates</code> and <code>Updates</code>.\nOn the Clients page, there are 100+ companies with 100+ columns of information.</p>\n\n<p>In Client Updates, there is a drop down menu in which one can choose from the list of clients and all the information from the Clients page will come up in an easy to read column form. next to that column is an option to make changes to old information. By typing in changes, this gets updated to the Updates page in which all old and new information is put back into row form to then be copied back into the original database.</p>\n\n<p>The problem I'm having is that I want the database to be updated automatically without having to copy and paste from the Updates page.. I'm  having trouble getting it to copy and then paste to the correct row on the clients page.</p>\n\n<p>What I've tried so far....I know its very incorrect but I'm having a hard time finding any answers to this.</p>\n\n<pre><code>This is my latest attempt... \nDim rng1 As Range \nDim rng2 As Range \nSet rng1 = ThisWorkbook.Worksheets(2).Range(\"D7:BT7\") \nSet rng2 = ThisWorkbook.Worksheets(4).Range(\"A7:A134\") \n\nrng1.Select rng1.Copy \nFor Each i In rng2 \n    If rng1.Cells(\"E7\") = rng2.Cells(\"A\" &amp; i) Then \n        Range(\"A\" &amp; i).Select  \n        Range(\"A\" &amp; i).PasteSpecial Paste = xlPasteValues   \n    End If \nNext i\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1049, "user_id": 3251199, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/bf61d317161fc12eb6c9b74c546be321?s=128&d=identicon&r=PG&f=1", "display_name": "nicholas79171", "link": "https://stackoverflow.com/users/3251199/nicholas79171"}, "edited": false, "score": 0, "creation_date": 1435169233, "post_id": 31033820, "comment_id": 50092224, "body": "Try just using the <a href=\"http://www.techonthenet.com/excel/formulas/mkdir.php\" rel=\"nofollow noreferrer\"><code>mkDir</code> command.</a>"}, {"owner": {"reputation": 2294, "user_id": 759959, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/dd568e7c93f24e3ec1b98505f3b4fc07?s=128&d=identicon&r=PG", "display_name": "czchlong", "link": "https://stackoverflow.com/users/759959/czchlong"}, "reply_to_user": {"reputation": 1049, "user_id": 3251199, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/bf61d317161fc12eb6c9b74c546be321?s=128&d=identicon&r=PG&f=1", "display_name": "nicholas79171", "link": "https://stackoverflow.com/users/3251199/nicholas79171"}, "edited": false, "score": 0, "creation_date": 1435169450, "post_id": 31033820, "comment_id": 50092325, "body": "@nicholas79171 I&#39;ve also tried that, but it doesn&#39;t work. I think I may be on to something. It would appear VBA cannot create nested sub-directories? I&#39;ve updated my question"}, {"owner": {"reputation": 1049, "user_id": 3251199, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/bf61d317161fc12eb6c9b74c546be321?s=128&d=identicon&r=PG&f=1", "display_name": "nicholas79171", "link": "https://stackoverflow.com/users/3251199/nicholas79171"}, "edited": false, "score": 0, "creation_date": 1435169859, "post_id": 31033820, "comment_id": 50092528, "body": "Does the first directory get created?"}, {"owner": {"reputation": 2294, "user_id": 759959, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/dd568e7c93f24e3ec1b98505f3b4fc07?s=128&d=identicon&r=PG", "display_name": "czchlong", "link": "https://stackoverflow.com/users/759959/czchlong"}, "reply_to_user": {"reputation": 1049, "user_id": 3251199, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/bf61d317161fc12eb6c9b74c546be321?s=128&d=identicon&r=PG&f=1", "display_name": "nicholas79171", "link": "https://stackoverflow.com/users/3251199/nicholas79171"}, "edited": false, "score": 0, "creation_date": 1435170454, "post_id": 31033820, "comment_id": 50092831, "body": "@nicholas79171 The first directory does not get created either. I now changed my code to use 2 separate directory creations, one for the <code>DataEntry</code> and one for the <code>logs</code> and it seems to work. It seems VBA cannot create nested directories in a single statement?"}], "answers": [{"comments": [{"owner": {"reputation": 2294, "user_id": 759959, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/dd568e7c93f24e3ec1b98505f3b4fc07?s=128&d=identicon&r=PG", "display_name": "czchlong", "link": "https://stackoverflow.com/users/759959/czchlong"}, "edited": false, "score": 0, "creation_date": 1435170717, "post_id": 31034201, "comment_id": 50092990, "body": "I must say I am amazed VBA is not smart enough to create the parent directories by itself..."}], "tags": [], "owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "is_accepted": true, "score": 7, "last_activity_date": 1435170449, "creation_date": 1435170449, "answer_id": 31034201, "question_id": 31033820, "link": "https://stackoverflow.com/questions/31033820/filesystemobject-createfolder-to-create-directory-and-subdirectories/31034201#31034201", "title": "FileSystemObject.CreateFolder to create directory and subdirectories", "body": "<p>Need to create each folder one at a time.  You can use code like this to do so:</p>\n\n<pre><code>Sub tgr()\n\n    Dim strFolderPath As String\n    Dim strBuildPath As String\n    Dim varFolder As Variant\n\n    strFolderPath = \"C:\\Users\\&lt;my_username&gt;\\DataEntry\\logs\"\n\n    If Right(strFolderPath, 1) = \"\\\" Then strFolderPath = Left(strFolderPath, Len(strFolderPath) - 1)\n    For Each varFolder In Split(strFolderPath, \"\\\")\n        If Len(strBuildPath) = 0 Then\n            strBuildPath = varFolder &amp; \"\\\"\n        Else\n            strBuildPath = strBuildPath &amp; varFolder &amp; \"\\\"\n        End If\n        If Len(Dir(strBuildPath, vbDirectory)) = 0 Then MkDir strBuildPath\n    Next varFolder\n\n    'The full folder path has been created regardless of nested subdirectories\n    'Continue with your code here\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 379, "user_id": 6210991, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Y6nJN.jpg?s=128&g=1", "display_name": "KySoto", "link": "https://stackoverflow.com/users/6210991/kysoto"}, "edited": false, "score": 0, "creation_date": 1586879294, "post_id": 50818079, "comment_id": 108288087, "body": "i like to use the File System Object over the built in vba file handling. +1"}], "tags": [], "owner": {"reputation": 101, "user_id": 4438965, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5910bb998f6ce4586272f20803e14bcb?s=128&d=identicon&r=PG&f=1", "display_name": "MarkD", "link": "https://stackoverflow.com/users/4438965/markd"}, "is_accepted": false, "score": 9, "last_activity_date": 1528809011, "creation_date": 1528809011, "answer_id": 50818079, "question_id": 31033820, "link": "https://stackoverflow.com/questions/31033820/filesystemobject-createfolder-to-create-directory-and-subdirectories/50818079#50818079", "title": "FileSystemObject.CreateFolder to create directory and subdirectories", "body": "<p>tigeravatar's looping answer might work, but it's a bit hard to read. Instead of micromanaging the string handling yourself, the FileSystemObject has path manipulation functions available, and recursion is slightly easier to read than a loop.</p>\n\n<p>Here is the function I use:  </p>\n\n<pre><code>Function CreateFolderRecursive(path As String) As Boolean\n    Dim FSO As New FileSystemObject\n\n    'If the path exists as a file, the function fails.\n    If FSO.FileExists(path) Then\n        CreateFolderRecursive = False\n        Exit Function\n    End If\n\n    'If the path already exists as a folder, don't do anything and return success.\n    If FSO.FolderExists(path) Then\n        CreateFolderRecursive = True\n        Exit Function\n    End If\n\n    'recursively create the parent folder, then if successful create the top folder.\n    If CreateFolderRecursive(FSO.GetParentFolderName(path)) Then\n        If FSO.CreateFolder(path) Is Nothing Then\n            CreateFolderRecursive = False\n        Else\n            CreateFolderRecursive = True\n        End If\n    Else\n        CreateFolderRecursive = False\n    End If\nEnd Function\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 21, "user_id": 3430187, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ab3a988393589db85443a923163af3d?s=128&d=identicon&r=PG&f=1", "display_name": "Tavious", "link": "https://stackoverflow.com/users/3430187/tavious"}, "is_accepted": false, "score": 0, "last_activity_date": 1614342777, "creation_date": 1614342777, "answer_id": 66385918, "question_id": 31033820, "link": "https://stackoverflow.com/questions/31033820/filesystemobject-createfolder-to-create-directory-and-subdirectories/66385918#66385918", "title": "FileSystemObject.CreateFolder to create directory and subdirectories", "body": "<p>Agree with MarkD's suggestion to utilize recursion, it was the code I came here looking to find. In a scenario where the path provided uses a nonexistent root folder it will result in an infinite loop. Adding to MarkD's solution to check for zero length path.</p>\n<pre><code>Function CreateFolderRecursive(path As String) As Boolean\n    Static FSO As FileSystemObject\n \n    'Initialize FSO variable if not already setup\n    If FSO Is Nothing Then Set lFSO = New FileSystemObject\n\n    'Is the path paramater populated\n    If Len(path) = 0 Then\n      CreateFolderRecursive = False\n      Exit Function\n    End If\n\n    'If the path exists as a file, the function fails.\n    If FSO.FileExists(path) Then\n        CreateFolderRecursive = False\n        Exit Function\n    End If\n \n    'If the path already exists as a folder, don't do anything and return success.\n    If FSO.FolderExists(path) Then\n        CreateFolderRecursive = True\n        Exit Function\n    End If\n \n    'recursively create the parent folder, then if successful create the top folder.\n    If CreateFolderRecursive(FSO.GetParentFolderName(path)) Then\n        If FSO.CreateFolder(path) Is Nothing Then\n            CreateFolderRecursive = False\n        Else\n           CreateFolderRecursive = True\n        End If\n    Else\n        CreateFolderRecursive = False\n    End If\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 2294, "user_id": 759959, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/dd568e7c93f24e3ec1b98505f3b4fc07?s=128&d=identicon&r=PG", "display_name": "czchlong", "link": "https://stackoverflow.com/users/759959/czchlong"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 14618, "favorite_count": 1, "accepted_answer_id": 31034201, "answer_count": 3, "score": 9, "last_activity_date": 1614342777, "creation_date": 1435169071, "last_edit_date": 1435170995, "question_id": 31033820, "link": "https://stackoverflow.com/questions/31033820/filesystemobject-createfolder-to-create-directory-and-subdirectories", "title": "FileSystemObject.CreateFolder to create directory and subdirectories", "body": "<p>I would like to create a directory and a subdirectory with the following code:</p>\n\n<pre><code>Public fso As Scripting.FileSystemObject\nSet fso = New Scripting.FileSystemObject\nfso.CreateFolder (\"C:\\Users\\&lt;my_username&gt;\\DataEntry\\logs\")\n</code></pre>\n\n<p>I am trying to create nested directories. In this case, the <code>DataEntry</code> directory would not exist, so essentially I would like to create 2 directories, <code>DataEntry\\logs</code> under <code>C:\\Users\\&lt;username&gt;</code></p>\n\n<p>If I enter command prompt, I can create that directory with <code>mkdir</code> without any issues. However, I simply cannot get VBA to create that folder and I get:</p>\n\n<pre><code>Run-time error '76':\n\nPath not found                        \n</code></pre>\n\n<p>I am using Excel VBA 2007/2010                  </p>\n"}, {"tags": ["excel", "user-defined-functions", "sumifs", "udf", "vba"], "comments": [{"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1435169736, "post_id": 31033809, "comment_id": 50092468, "body": "I have to change the grave ` to be an apostrophe &#39; but it works for me"}, {"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1435169770, "post_id": 31033809, "comment_id": 50092489, "body": "Are you getting an error when you use the UDF?"}, {"owner": {"reputation": 27, "user_id": 4143439, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/zCYH2.png?s=128&g=1", "display_name": "mechengr02", "link": "https://stackoverflow.com/users/4143439/mechengr02"}, "reply_to_user": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1435173647, "post_id": 31033809, "comment_id": 50094675, "body": "Error  #value in the cell."}], "answers": [{"tags": [], "owner": {"reputation": 27, "user_id": 4143439, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/zCYH2.png?s=128&g=1", "display_name": "mechengr02", "link": "https://stackoverflow.com/users/4143439/mechengr02"}, "is_accepted": true, "score": 0, "last_activity_date": 1452101901, "last_edit_date": 1452101901, "creation_date": 1436454836, "answer_id": 31321583, "question_id": 31033809, "link": "https://stackoverflow.com/questions/31033809/create-excel-user-defined-function-udf-that-can-sum-mixed-numbers-and-text/31321583#31321583", "title": "Create Excel User Defined Function (UDF) that can sum mixed numbers and text", "body": "<p>This was my final UDF.</p>\n\n<pre><code>Option Explicit\nFunction Sumbytext(rg As Range, ltr As String) As Double\n'Similar to Excel SumIf, except that text can be in the cell with the number.\n'That text (\"ltr\") can identify the number, as a condition to sum.\n'e.g. Cell1 (D5 T8 Y3), Cell2(D3 A2), Cell3 (T8) &gt;&gt;&gt; Sums: D=8 T=16 Y=3 A=2\n\nDim c As Range   'c = a cell\nDim InStrResult As Integer  'returns the position of \"ltr\" in the cell \ne.g. abc34, if ltr=\"c\", then Instr() = 3\nDim MidResult As Double\nDim numltr As Integer 'number of characters in the critera, i.e. AL or A\nDim StartPos As Integer  'position of ltr + number of characters in the critera, i.e. AL or A\nDim DelimPos As Integer  'position of delimiter after \"ltr\"\nDim numlen As Integer  'returns length of the desired numbers i.e. \"3\" =1 or \"10\" =2\nDim Abbr As Range  'abbreviation of holiday - this is displayed on the calendar\nDim rgAbbr As Range  'the list of abbreviations corresponding to the list of holidays\n\nSet rgAbbr = Worksheets(\"Holidays\").Range(\"List_HolAbbr\")\n\nFor Each c In rg\n  For Each Abbr In rgAbbr\n    If UCase(c) = UCase(Abbr) Then GoTo skipcell   'skip cell if the holiday names are in the cell &gt;&gt; 'Labor day' gives an error because the function looking for a cell containing \"LA\".  Therefore exclude \"Labor\".\n    Next Abbr\n     If InStr(1, c.Text, UCase(\"OCT\"), vbTextCompare) &gt; 0 Then GoTo skipcell 'skip cell if it inscludes \"Oct\".  &gt;&gt; results in error due to the \"CT\" being used as \"ltr\".\n     InStrResult = InStr(1, c.Text, ltr, vbTextCompare)\n     If InStrResult &gt; 0 Then\n        StartPos = InStrResult + Len(ltr)\n        DelimPos = InStr(InStrResult, c.Text, \" \")\n\n        If DelimPos = 0 Then\n          MidResult = Right(c.Text, Len(c.Text) - StartPos + 1) '\"+1\" because if cell=al3; starpos will = 3 &amp; len(cell)=3; therefore Len-startpos=0\n        Else\n      numlen = DelimPos - StartPos + 1\n      MidResult = Mid(c.Text, StartPos, numlen)\n        End If\n\n        Sumbytext = Sumbytext + MidResult\n\n    End If\nskipcell:\nNext c\nEnd Function\n</code></pre>\n\n<p>UPDATE #1\nThe workbook problems shown in UPDATE#1 above  seemed to be what was breaking my UDF due to the sheet names being renamed automatically by Excel.  I had to change the references in the UDF to the new sheet names since Excel created \"new\" sheets and renamed my \"old\" sheets on its own. No more #VALUE errors. </p>\n\n<p>UPDATE #2:<br>\nI don't know how or why the #VALUE error was fixed in UPDATE #2 above.  Suggestions?</p>\n"}], "owner": {"reputation": 27, "user_id": 4143439, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/zCYH2.png?s=128&g=1", "display_name": "mechengr02", "link": "https://stackoverflow.com/users/4143439/mechengr02"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 794, "favorite_count": 0, "accepted_answer_id": 31321583, "answer_count": 1, "score": 0, "last_activity_date": 1452101901, "creation_date": 1435169013, "last_edit_date": 1531161705, "question_id": 31033809, "link": "https://stackoverflow.com/questions/31033809/create-excel-user-defined-function-udf-that-can-sum-mixed-numbers-and-text", "title": "Create Excel User Defined Function (UDF) that can sum mixed numbers and text", "body": "<p>Data example in excel:<br>\n<code>COL  A        B       C          D        F.....\n1                                         SL.....\n2  SL8 AL4 CD3   CN5   CD4 AL8</code>  </p>\n\n<p>I am summing conditionally, based on the letter identifier within the cell.  The UDF is entered into a cell (F2) <code>=SumDigByLTR2(A2:C2,F1)</code>, where F1 - I1 are the conditions to sum (the letters, SL, AL etc).  Result should be:<br>\n<code>SL=8 \nAL=12\nCD=7\nCN=5</code></p>\n\n<p>I created this user defined function in VBA (below).  I modified some code I found online.  It worked at first, then mysteriously stopped working.  I don't recall changing anything the XLS or VBA.  Thoughts?<br>\nYou can ignore the commented out \"delim\" lines.  I was trying to have an option to set a delimiter between letters.  It didn't work, so i just use a space.  </p>\n\n<pre><code>Option Explicit\nFunction SumDigByLTR2(rg As Range, ltr As String) As Double\nDim c As Range   'c = a cell\nDim delimiter As String\nDim InStrResult As Long  'returns the position of \"ltr\" in the cell e.g. abc34, if ltr=\"c\", then Instr() = 3\nDim MidResult As Long\nDim numltr As Integer 'number of characters in the critera, i.e. AL or A\n'Dim delim_text As String 'this will identify the user preferred demlimiter text.\nDim StartPos As Integer  'position of ltr + number of characters in the critera, i.e. AL or A\nDim DelimPos As Integer  'position of delimiter after \"ltr\"\nDim numlen As Integer  'returns length of the desired numbers i.e. \"3\" =1 or \"10\" =2\n\nFor Each c In rg\n'delimiter = Sheet7.Range(\"O8\").Value\n    InStrResult = InStr(1, c.Text, ltr, vbTextCompare)\n    If InStr(1, c.Text, ltr, vbTextCompare) &gt; 0 Then\n\n        StartPos = InStrResult + Len(ltr)\n        DelimPos = InStr(InStrResult, c.Text, \" \") 'Sheet7.Cells(8, 15).Value)  '\"O\"=15\n\n            If DelimPos = 0 Then\n               MidResult = Right(c.Text, Len(c.Text) - StartPos + 1)  '\"+1\" because if cell=al3; starpos will = 3 &amp; len(cell)=3; therefore   Len-startpos=0\n            Else\n               numlen = DelimPos - StartPos + 1\n               MidResult = Mid(c.Text, StartPos, numlen)\n            End If\n\n        SumDigByLTR2 = SumDigByLTR2 + MidResult\n\n    End If\nNext c\nEnd Function\n\n\n'Original\n'http://www.pcreview.co.uk/forums/excel-extract-and-sum-numerals-mixed-text-numeral-cell-range-t937450.html\n\n'Option Explicit\n'Function SumDigByLtr(rg As Range, ltr As String) As Double\n\n'Dim c As Range\n\n'For Each c In rg\n'If InStr(1, c.Text, ltr) &gt; 0 Then\n'SumDigByLtr = SumDigByLtr + Replace(c.Text, ltr, \"\")\n\n'End If\n'Next c\n'End Function\n</code></pre>\n\n<p>UPDATE #1, Nov 25 2015\nI discovered what was breaking the UDF for me.</p>\n\n<p>Excel 2010 seems to have created a new set of worksheets and renamed all the originals, e.g. Sheet10 becomes Sheet101, Sheet13 becomes Sheet131.  This causes the UDF to stop functioning.  The \"new\" \"sheet10\" and \"sheet13\" do not seem to exist anywhere but in the VBA project window.  The \"new\" sheets have a blue icon next to them.  </p>\n\n<p>I had to change the references in the UDF to the new sheet names since Excel created \"new\" sheets and renamed my \"old\" sheets on its own.  No  more #VALUE errors.  </p>\n\n<p><a href=\"https://i.stack.imgur.com/r5kwV.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/r5kwV.png\" alt=\"enter image description here\"></a>\n<a href=\"https://i.stack.imgur.com/URkFm.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/URkFm.png\" alt=\"enter image description here\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/uULCC.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/uULCC.png\" alt=\"enter image description here\"></a></p>\n\n<p>Does anyone know what caused Excel/VBA to create these non-existent sheets and rename the original sheets?</p>\n\n<p>UPDATE #2, 1/6/2016\nI copied all real, existing sheets to a new workbook in early Dec.<br>\nAs of today, the formulas in this new workbook are all errors (#VALUE) again when I opened it. Excel has not created the non-existent sheets as seen in my last update.  Last week the XLS &amp; formulas were working and I made no changes. The original workbook (the one shown in the pix w/ the non-existent worksheets) does not have the #VALUE errors. Both workbooks are on the same computer and have been updated together over the last month+ for comparison purposes.</p>\n\n<p>UPDATE3, 1/6/2016\nI just accidentally moved a text cell, then clicked undo, and all the #VALUE errors went away and I now have all the right calculations.  WTF.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 11963, "user_id": 2707864, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/LYdpu.png?s=128&g=1", "display_name": "sancho.s ReinstateMonicaCellio", "link": "https://stackoverflow.com/users/2707864/sancho-s-reinstatemonicacellio"}, "edited": false, "score": 1, "creation_date": 1435173465, "post_id": 31033749, "comment_id": 50094594, "body": "Please post the complete code that is giving you trouble. State where is that code located."}], "answers": [{"comments": [{"owner": {"reputation": 61, "user_id": 5042113, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d09e046512d7d8355735624ae1b8cfa?s=128&d=identicon&r=PG&f=1", "display_name": "Jim Mc", "link": "https://stackoverflow.com/users/5042113/jim-mc"}, "edited": false, "score": 0, "creation_date": 1435172508, "post_id": 31033922, "comment_id": 50094048, "body": "I&#39;m a newbie, so I&#39;m not following.  Where would this macro be stored and how would it be activated?"}, {"owner": {"reputation": 1637, "user_id": 3171007, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/Nltoh.jpg?s=128&g=1", "display_name": "n8.", "link": "https://stackoverflow.com/users/3171007/n8"}, "reply_to_user": {"reputation": 61, "user_id": 5042113, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d09e046512d7d8355735624ae1b8cfa?s=128&d=identicon&r=PG&f=1", "display_name": "Jim Mc", "link": "https://stackoverflow.com/users/5042113/jim-mc"}, "edited": false, "score": 0, "creation_date": 1435173844, "post_id": 31033922, "comment_id": 50094784, "body": "As Sancho states in his answer, use Alt+F11 to open your IDE where the macros are stored.  Macros can be stored in sheets or modules, if your macros are supposed to follow the copied sheets then they need to be within the sheets themselves so that when the sheets are copied over the macro follows.  Congratulations on your progress!  Macro editing is a very important step in your &quot;Excel Evolution&quot;."}], "tags": [], "owner": {"reputation": 1637, "user_id": 3171007, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/Nltoh.jpg?s=128&g=1", "display_name": "n8.", "link": "https://stackoverflow.com/users/3171007/n8"}, "is_accepted": false, "score": 0, "last_activity_date": 1435169414, "creation_date": 1435169414, "answer_id": 31033922, "question_id": 31033749, "link": "https://stackoverflow.com/questions/31033749/moving-sheets-with-vba-codes-and-buttons-to-a-new-workbook/31033922#31033922", "title": "Moving sheets with VBA codes and buttons to a new Workbook", "body": "<p>You can include a line in your macro that re-assigns the control to the macro in its own workbook instead of the originating workbook.</p>\n\n<p>What you can do is just record the act of assigning the macro, for example:</p>\n\n<pre><code>ActiveSheet.Shapes.Range(Array(\"Button 1\")).Select\nSelection.OnAction = \"Macro1\"\n</code></pre>\n\n<p>Then get rid of the pesky \"select\" stuff:</p>\n\n<pre><code>ActiveSheet.Shapes.Range(Array(\"Button 1\")).OnAction = \"Macro1\"\n</code></pre>\n\n<p>And there you have it.  Of course the button and macro names with vary depending on your workbook, but it will be close to that.</p>\n"}, {"tags": [], "owner": {"reputation": 11963, "user_id": 2707864, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/LYdpu.png?s=128&g=1", "display_name": "sancho.s ReinstateMonicaCellio", "link": "https://stackoverflow.com/users/2707864/sancho-s-reinstatemonicacellio"}, "is_accepted": false, "score": 0, "last_activity_date": 1435173434, "creation_date": 1435173434, "answer_id": 31035121, "question_id": 31033749, "link": "https://stackoverflow.com/questions/31033749/moving-sheets-with-vba-codes-and-buttons-to-a-new-workbook/31035121#31035121", "title": "Moving sheets with VBA codes and buttons to a new Workbook", "body": "<p>Your question is somewhat vague. I will then guess.</p>\n\n<p>You have to:</p>\n\n<ol>\n<li><p>Make sure that the <code>Sub</code>s to be run are actually contained in the <code>Worksheet</code> to be copied. Press Alt+F11 to open the VB Editor, and you will see on the left the Sheet and other modules.</p></li>\n<li><p>Inspect the code, and make sure all references to macros are not prefixed with any Sheet/Workbook name.</p></li>\n</ol>\n"}, {"tags": [], "owner": {"reputation": 2987, "user_id": 8173870, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xoZ3j.jpg?s=128&g=1", "display_name": "HackSlash", "link": "https://stackoverflow.com/users/8173870/hackslash"}, "is_accepted": false, "score": 0, "last_activity_date": 1536357775, "creation_date": 1536357775, "answer_id": 52230125, "question_id": 31033749, "link": "https://stackoverflow.com/questions/31033749/moving-sheets-with-vba-codes-and-buttons-to-a-new-workbook/52230125#52230125", "title": "Moving sheets with VBA codes and buttons to a new Workbook", "body": "<p>Here's a solution I pulled from TheSpreadsheetGuru. I modified it to accept a sheet object so you can run it against any sheet you have a handle on.</p>\n\n<pre><code>Public Sub FixCopiedButtonMacroLinks(ByVal theSheet As Worksheet)\n    ' UPDATED: by HackSlash to accept a worksheet parameter.\n    'PURPOSE: Remove an external workbook reference from all shapes triggering macros\n    'Source: www.TheSpreadsheetGuru.com\n\n    Dim control As Shape\n    Dim MacroLink As String\n    Dim SplitLink As Variant\n    Dim NewLink As String\n\n    'Loop through each shape in worksheet\n    For Each control In theSheet.Shapes\n\n        'Grab current macro link (if available)\n        MacroLink = control.OnAction\n\n        'Determine if shape was linking to a macro\n        If MacroLink &lt;&gt; vbNullString And InStr(MacroLink, \"!\") &lt;&gt; 0 Then\n            'Split Macro Link at the exclaimation mark (store in Array)\n            SplitLink = Split(MacroLink, \"!\")\n\n            'Pull text occurring after exclaimation mark\n            NewLink = SplitLink(1)\n\n            'Remove any straggling apostrophes from workbook name\n            If Right(NewLink, 1) = \"'\" Then\n                NewLink = Left(NewLink, Len(NewLink) - 1)\n            End If\n\n            'Apply New Link\n            control.OnAction = NewLink\n        End If\n    Next control\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 61, "user_id": 5042113, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d09e046512d7d8355735624ae1b8cfa?s=128&d=identicon&r=PG&f=1", "display_name": "Jim Mc", "link": "https://stackoverflow.com/users/5042113/jim-mc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1431, "favorite_count": 0, "answer_count": 3, "score": 3, "last_activity_date": 1536357775, "creation_date": 1435168872, "last_edit_date": 1435217149, "question_id": 31033749, "link": "https://stackoverflow.com/questions/31033749/moving-sheets-with-vba-codes-and-buttons-to-a-new-workbook", "title": "Moving sheets with VBA codes and buttons to a new Workbook", "body": "<p>I have a worksheet with macros and buttons. I want to copy that worksheet to other workbooks so that the macros can be used with the data in the new workbook.</p>\n\n<p>My problem is that when I copy a sheet into a new workbook, the macros come with it, but the button on the sheet still points to the macros in the original workbook. You have to right mouse click \"Assign Macro\" and choose the macro in the current workbook. </p>\n\n<p>Is there a property setting that tells the button in Excel to use the macro in the new workbook instead of the old workbook?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1435169475, "post_id": 31033735, "comment_id": 50092340, "body": "It looks like <a href=\"http://stackoverflow.com/questions/5600533/how-do-i-prompt-the-user-to-select-the-file-and-sheet-when-using-macro-to-impor\">this thread</a> may be able to help you.  Check out the first answer, that should get you started.  Are you familiar with VBA?"}], "answers": [{"comments": [{"owner": {"reputation": 537, "user_id": 4953820, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/e2b3f12e11e10ff518f2bc571a885136?s=128&d=identicon&r=PG&f=1", "display_name": "Kalev Maricq", "link": "https://stackoverflow.com/users/4953820/kalev-maricq"}, "reply_to_user": {"reputation": 1, "user_id": 5045766, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65be0708f1115d4a199a45d35f6a43e1?s=128&d=identicon&r=PG&f=1", "display_name": "Alex Cohen", "link": "https://stackoverflow.com/users/5045766/alex-cohen"}, "edited": false, "score": 0, "creation_date": 1435174542, "post_id": 31034283, "comment_id": 50095183, "body": "You&#39;re welcome.  It&#39;s confusing at first, but you&#39;ll get the hang of it."}, {"owner": {"reputation": 1, "user_id": 5045766, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65be0708f1115d4a199a45d35f6a43e1?s=128&d=identicon&r=PG&f=1", "display_name": "Alex Cohen", "link": "https://stackoverflow.com/users/5045766/alex-cohen"}, "edited": false, "score": 0, "creation_date": 1435175536, "post_id": 31034283, "comment_id": 50095763, "body": "Will InputBox work with choosing which excel workbook to use in this case? I need to replace the excel workbook path in the macro with the path of the file that is selected."}, {"owner": {"reputation": 537, "user_id": 4953820, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/e2b3f12e11e10ff518f2bc571a885136?s=128&d=identicon&r=PG&f=1", "display_name": "Kalev Maricq", "link": "https://stackoverflow.com/users/4953820/kalev-maricq"}, "reply_to_user": {"reputation": 1, "user_id": 5045766, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65be0708f1115d4a199a45d35f6a43e1?s=128&d=identicon&r=PG&f=1", "display_name": "Alex Cohen", "link": "https://stackoverflow.com/users/5045766/alex-cohen"}, "edited": false, "score": 0, "creation_date": 1435237760, "post_id": 31034283, "comment_id": 50123604, "body": "InputBox is best for choosing the sheet, but clunky for choosing the workbook.  You would have to have the user paste the path in.  I&#39;ve edited my code to let the user select both the workbook and the worksheet."}], "tags": [], "owner": {"reputation": 537, "user_id": 4953820, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/e2b3f12e11e10ff518f2bc571a885136?s=128&d=identicon&r=PG&f=1", "display_name": "Kalev Maricq", "link": "https://stackoverflow.com/users/4953820/kalev-maricq"}, "is_accepted": false, "score": 0, "last_activity_date": 1435237669, "last_edit_date": 1435237669, "creation_date": 1435170701, "answer_id": 31034283, "question_id": 31033735, "link": "https://stackoverflow.com/questions/31033735/vba-prompt-user-to-choose-excel-sheet/31034283#31034283", "title": "VBA Prompt user to choose Excel sheet", "body": "<p>The easiest way to do this is </p>\n\n<pre><code>shtNum = InputBox(\"Enter the number of the sheet you want to use.\")\nWith Sheets(shtNum)\n   Your code here\nEnd With\n</code></pre>\n\n<p>Also, just so you know, macro recorder code contains a lot of junk.  Here is a cleaned-up version of your code.  </p>\n\n<pre><code>Sub AutomateCompare()\nWith ActiveSheet\n    'Change the ranges to what you need.  Using activecell is usually dangerous\n    .Range(\"A1:A2\").FormulaR1C1 = \"=INDEX('Computer&amp;DeploymentInfo_06_23_15_v3.xlsx'!Table1[scheduleddate],MATCH([ @HostName],'Computer&amp;DeploymentInfo_06_23_15_v3.xlsx'!Table1[computername],0))\"\n    .Range(\"B1\").FormulaR1C1 = \"=INDEX('Computer&amp;DeploymentInfo_06_23_15_v3.xlsx'!Table1[forecastdate],MATCH([@HostName],'Computer&amp;DeploymentInfo_06_23_15_v3.xlsx'!Table1[computername],0))\"\n    .ListObjects(\"MasterHardwareDB\").Range.AutoFilter Field:=9, Criteria1:=\"FALSE\"\n    .ListObjects(\"MasterHardwareDB\").Range.AutoFilter Field:=5, Criteria1:=\"=Scheduled\", Operator:=xlOr, Criteria2:=\"=To Be Scheduled\"\nEnd With\nEnd Sub\n</code></pre>\n\n<p>Edit:  Here is code that opens another workbook</p>\n\n<pre><code>Sub AutomateCompare()\nDim fileBrowse As FileDialog\nDim shtNum As Integer\nSet fileBrowse = Application.FileDialog(msoFileDialogOpen)\nIf fileBrowse.Show = True Then wbPath = fileBrowse.SelectedItems(1)\nWith Workbooks.Open(wbPath)\n    shtNum = InputBox(\"Enter the number of the sheet you want to use.\")\n    With .Sheets(shtNum)\n        'Change the ranges to what you need.  Using activecell is usually dangerous\n        .Range(\"A1:A2\").FormulaR1C1 = \"=INDEX('Computer&amp;DeploymentInfo_06_23_15_v3.xlsx'!Table1[scheduleddate],MATCH([ @HostName],'Computer&amp;DeploymentInfo_06_23_15_v3.xlsx'!Table1[computername],0))\"\n        .Range(\"B1\").FormulaR1C1 = \"=INDEX('Computer&amp;DeploymentInfo_06_23_15_v3.xlsx'!Table1[forecastdate],MATCH([@HostName],'Computer&amp;DeploymentInfo_06_23_15_v3.xlsx'!Table1[computername],0))\"\n        .ListObjects(\"MasterHardwareDB\").Range.AutoFilter Field:=9, Criteria1:=\"FALSE\"\n        .ListObjects(\"MasterHardwareDB\").Range.AutoFilter Field:=5, Criteria1:=\"=Scheduled\", Operator:=xlOr, Criteria2:=\"=To Be Scheduled\"\n    End With\nEnd With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 5045766, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65be0708f1115d4a199a45d35f6a43e1?s=128&d=identicon&r=PG&f=1", "display_name": "Alex Cohen", "link": "https://stackoverflow.com/users/5045766/alex-cohen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 763, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1435237669, "creation_date": 1435168845, "last_edit_date": 1435217225, "question_id": 31033735, "link": "https://stackoverflow.com/questions/31033735/vba-prompt-user-to-choose-excel-sheet", "title": "VBA Prompt user to choose Excel sheet", "body": "<p>I used Macro Recorder in Excel to record a series of tasks I need to automate. These tasks happen between two different Excel spreadsheets. I believe that the macro performs the code on the current worksheet, but right now the second sheet is hard coded. How do I prompt the user to choose an Excel sheet to reference to?</p>\n\n<p>The workbook that is going to have the macro is the <code>MasterHardwareDB</code> &amp; the file that needs to be replaced with a user input is <code>Computer&amp;DeploymentInfo_06_23_15_v3.xlsx</code></p>\n\n<p>I was researching the filedialog object but I am not sure how to integrate here. </p>\n\n<pre><code>Sub AutomateCompare()\n'\n' AutomateCompare Macro\n'\nActiveCell.Select\nActiveCell.FormulaR1C1 = _\n    \"=INDEX('Computer&amp;DeploymentInfo_06_23_15_v3.xlsx'!Table1[scheduleddate],MATCH([ @HostName],'Computer&amp;DeploymentInfo_06_23_15_v3.xlsx'!Table1[computername],0))\"\nActiveCell.Offset(1, 0).Range(\"MasterHardwareDB[[#Headers],[Name]]\").Select\nActiveCell.FormulaR1C1 = _\n    \"=INDEX('Computer&amp;DeploymentInfo_06_23_15_v3.xlsx'!Table1[scheduleddate],MATCH([@HostName],'Computer&amp;DeploymentInfo_06_23_15_v3.xlsx'!Table1[computername],0))\"\nActiveCell.Offset(1, 0).Range(\"MasterHardwareDB[[#Headers],[Name]]\").Select\nActiveWindow.SmallScroll ToRight:=-1\nActiveCell.Offset(-2, 1).Range(\"MasterHardwareDB[[#Headers],[Name]]\").Select\nActiveCell.FormulaR1C1 = _\n    \"=INDEX('Computer&amp;DeploymentInfo_06_23_15_v3.xlsx'!Table1[forecastdate],MATCH([@HostName],'Computer&amp;DeploymentInfo_06_23_15_v3.xlsx'!Table1[computername],0))\"\nActiveWindow.SmallScroll ToRight:=1\nActiveCell.Offset(1, 0).Range(\"MasterHardwareDB[[#Headers],[Name]]\").Select\nActiveWindow.SmallScroll ToRight:=-7\nActiveSheet.ListObjects(\"MasterHardwareDB\").Range.AutoFilter Field:=9, _\n    Criteria1:=\"FALSE\"\nActiveWindow.SmallScroll ToRight:=1\nActiveCell.Offset(4169, -4).Range(\"MasterHardwareDB[[#Headers],[Name]:[EmpID]]\") _\n    .Select\nActiveCell.Offset(521, 1).Range(\"MasterHardwareDB[[#Headers],[Name]]\").Select\nActiveWindow.SmallScroll ToRight:=-7\nActiveSheet.ListObjects(\"MasterHardwareDB\").Range.AutoFilter Field:=5, _\n    Criteria1:=\"=Scheduled\", Operator:=xlOr, Criteria2:=\"=To Be Scheduled\"\nActiveCell.Offset(87, -8).Range(\"MasterHardwareDB[[#Headers],[Name]]\").Select\nActiveWindow.SmallScroll ToRight:=8\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "runtime-error", "vba"], "comments": [{"owner": {"reputation": 5852, "user_id": 1690392, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/A3DKR.jpg?s=128&g=1", "display_name": "nutsch", "link": "https://stackoverflow.com/users/1690392/nutsch"}, "edited": false, "score": 1, "creation_date": 1435168922, "post_id": 31033715, "comment_id": 50092062, "body": "Can you include the part of the code where you define line, amountCol, and amounts?"}, {"owner": {"reputation": 8006, "user_id": 2753501, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0a5ac280a03c3a9d89488dc33f0ef075?s=128&d=identicon&r=PG&f=1", "display_name": "ZygD", "link": "https://stackoverflow.com/users/2753501/zygd"}, "edited": false, "score": 0, "creation_date": 1435169094, "post_id": 31033715, "comment_id": 50092153, "body": "What is <code>line</code>? can you include the part where you declare it and assign a value to it?"}, {"owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "edited": false, "score": 3, "creation_date": 1435169433, "post_id": 31033715, "comment_id": 50092317, "body": "Does <code>line + 3</code> have an integer value of 1 or more?  Does <code>amountCol</code> have a value of 1 or more?  Is <code>amounts</code> declared as a <code>Range</code> with a value of a cell address?  On modern computers (32bit or later), <code>Dim amountCol as Long</code> is preferred."}, {"owner": {"reputation": 203, "user_id": 3697607, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/bc5d5ff86b010dab8e8785fb142b6b3c?s=128&d=identicon&r=PG&f=1", "display_name": "Mechanical Notaprogrammer", "link": "https://stackoverflow.com/users/3697607/mechanical-notaprogrammer"}, "edited": false, "score": 0, "creation_date": 1435170166, "post_id": 31033715, "comment_id": 50092696, "body": "I&#39;ve added the code up to where the error occurs."}, {"owner": {"reputation": 203, "user_id": 3697607, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/bc5d5ff86b010dab8e8785fb142b6b3c?s=128&d=identicon&r=PG&f=1", "display_name": "Mechanical Notaprogrammer", "link": "https://stackoverflow.com/users/3697607/mechanical-notaprogrammer"}, "reply_to_user": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "edited": false, "score": 0, "creation_date": 1435170420, "post_id": 31033715, "comment_id": 50092814, "body": "@TonyDallimore Changing it to Long fixed it. Thank you"}, {"owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "edited": false, "score": 1, "creation_date": 1435171533, "post_id": 31033715, "comment_id": 50093462, "body": "@MechanicalNotaprogrammer.  I recommended <code>Long</code> because it is more efficient; 16bit variables require special processing on 32bit computers.  Your problem was that an <code>Integer</code> variable has a maximum value of 65535.  Your macro failed when your row number, <code>line</code>, exceeded this value."}, {"owner": {"reputation": 11963, "user_id": 2707864, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/LYdpu.png?s=128&g=1", "display_name": "sancho.s ReinstateMonicaCellio", "link": "https://stackoverflow.com/users/2707864/sancho-s-reinstatemonicacellio"}, "reply_to_user": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "edited": false, "score": 0, "creation_date": 1435173702, "post_id": 31033715, "comment_id": 50094699, "body": "@TonyDallimore - I suggest posting an answer, as this solved the OP."}], "owner": {"reputation": 203, "user_id": 3697607, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/bc5d5ff86b010dab8e8785fb142b6b3c?s=128&d=identicon&r=PG&f=1", "display_name": "Mechanical Notaprogrammer", "link": "https://stackoverflow.com/users/3697607/mechanical-notaprogrammer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 438, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1435170134, "creation_date": 1435168772, "last_edit_date": 1531161705, "question_id": 31033715, "link": "https://stackoverflow.com/questions/31033715/error-1004-application-defined-or-object-defined-error-excel", "title": "Error 1004: Application-Defined or Object-Defined Error Excel", "body": "<p>I have a sub in Excel 2010 that copies information into cells. When I try to run it, I get an \"application-defined or object-defined error\" at:         </p>\n\n<pre><code>With Worksheets(\"Parameters\")\n    .Range(.Cells(line + 3, amountCol), _\n    .Cells(line + 3, amountCol + 6)).Copy Destination:=amounts\nEnd With\n</code></pre>\n\n<p>This is the entire sub up to the point where the error occurs.</p>\n\n<pre><code>Dim numLine As Integer\nDim line As Integer\nDim allocationType As String\nDim allocationRow As Integer\nDim specialFund As Integer\nDim amountCol As Integer\nDim numCol As Integer\nDim amounts As Range\nDim i As Integer\nDim costCol As Integer\nDim alloCol As Integer\nDim SFcol As Integer\n\nSFcol = 38\nalloCol = 32\ncostCol = 34\n\n'set number of allocation lines\nWith Worksheets(\"Parameters\")\n    numLine = .Range(.Cells(3, 18), .Cells(3, 18).End(xlDown)).Count - 1\nEnd With\n\n'set allocation starting point\nallocationRow = 3\n\n'set the amount starting columng\nWith Worksheets(\"Parameters\")\n    numCol = .Range(.Cells(3, 18), .Cells(3, 18).End(xlToRight)).Count - 1\n    'look for the starting year\n    For line = 1 To numCol\n        If .Cells(3, 18 + line).Value = Worksheets(wks).Cells(2, costCol) Then\n            amountCol = line + 18\n            Exit For\n        End If\n    Next line\nEnd With\n\n'go through each line, if allocation, add\nFor line = 1 To numLine\n    With Worksheets(\"Parameters\")\n        allocationType = .Cells(3 + line, 18).Value\n    End With\n\n    'check if needs to be included\n    If InStr(allocationType, Worksheets(\"Parameters\").Cells(6, 7).Value) Then\n        With Worksheets(wks)\n            'format the type cell\n            .Range(.Cells(allocationRow, alloCol), .Cells(allocationRow, alloCol + 1)).MergeCells = True\n            .Range(.Cells(allocationRow, alloCol), .Cells(allocationRow, alloCol + 1)).HorizontalAlignment = xlLeft\n            'check if needs color\n            If InStr(allocationType, \"Roads\") Then\n                .Range(.Cells(allocationRow, alloCol), .Cells(allocationRow, alloCol + 1)).Interior.ColorIndex = 36\n            ElseIf InStr(allocationType, \"Structures\") Then\n                .Range(.Cells(allocationRow, alloCol), .Cells(allocationRow, alloCol + 1)).Interior.ColorIndex = 34\n            Else\n                'check if special funding color\n                For specialFund = 3 To Worksheets.Count - 2\n                    If InStr(allocationType, Worksheets(specialFund).Name) Then\n                        .Range(.Cells(allocationRow, alloCol), .Cells(allocationRow, alloCol + 1)).Interior.ColorIndex = .Cells(2, SFcol + specialFund).Interior.ColorIndex\n                    End If\n                Next\n\n            End If\n            'add the allocation type\n            .Range(.Cells(allocationRow, alloCol), .Cells(allocationRow, alloCol + 1)) = allocationType\n            .Range(.Cells(allocationRow, alloCol), .Cells(allocationRow, alloCol + 1)).ShrinkToFit = True\n            'add the amounts range\n            Set amounts = .Range(.Cells(allocationRow, costCol), .Cells(allocationRow, costCol + 6))\n        End With\n        'copy amounts\n        With Worksheets(\"Parameters\")\n            .Range(.Cells(line + 3, amountCol), .Cells(line + 3, amountCol + 6)).Copy Destination:=amounts\n        End With\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1435168702, "post_id": 31033606, "comment_id": 50091914, "body": "What do you mean by &quot;the ith day i&quot;? Do you mean that e.g. B100 contains the number 100?"}, {"owner": {"reputation": 349, "user_id": 3050376, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/biCu0.jpg?s=128&g=1", "display_name": "jollarvia", "link": "https://stackoverflow.com/users/3050376/jollarvia"}, "reply_to_user": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1435168800, "post_id": 31033606, "comment_id": 50091989, "body": "no B100 can be anything. i is just the number in the in the range 0-365, or more if its been more than a year since the event occured"}], "answers": [{"comments": [{"owner": {"reputation": 349, "user_id": 3050376, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/biCu0.jpg?s=128&g=1", "display_name": "jollarvia", "link": "https://stackoverflow.com/users/3050376/jollarvia"}, "edited": false, "score": 0, "creation_date": 1435173014, "post_id": 31033860, "comment_id": 50094348, "body": "can I see you ammend your answer to make a map of maps of results so that dict[&quot;ggg&quot;][7] would equal true or something like that?  Forgive the syntax, I&#39;m new to vb and never used its maps before."}], "tags": [], "owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "is_accepted": false, "score": 1, "last_activity_date": 1435169239, "creation_date": 1435169239, "answer_id": 31033860, "question_id": 31033606, "link": "https://stackoverflow.com/questions/31033606/excel-check-whether-a-combination-of-cells-in-a-row-exists-in-a-range/31033860#31033860", "title": "excel check whether a combination of cells in a row exists in a range", "body": "<p>Something like this should work for you, or at least get you started in the right direction.  It finds all occurrences of the 10 unique values and then gets the corresponding numbers for them from column B.  I don't know how you're populating your unique values, so I just made something up.  The Range.Find loop should be relevant to you largely unchanged.</p>\n\n<pre><code>Sub tgr()\n\n    Dim rngFound As Range\n    Dim arrUnq(1 To 10) As String\n    Dim varUnq As Variant\n    Dim strFirst As String\n    Dim strResults As String\n\n    arrUnq(1) = \"aaa\"\n    arrUnq(2) = \"bbb\"\n    arrUnq(3) = \"ccc\"\n    arrUnq(4) = \"ddd\"\n    arrUnq(5) = \"eee\"\n    arrUnq(6) = \"fff\"\n    arrUnq(7) = \"ggg\"\n    arrUnq(8) = \"hhh\"\n    arrUnq(9) = \"iii\"\n    arrUnq(10) = \"jjj\"\n\n    For Each varUnq In arrUnq\n        Set rngFound = Columns(\"A\").Find(varUnq, Cells(Rows.Count, \"A\"), xlValues, xlPart)\n        If Not rngFound Is Nothing Then\n            strFirst = rngFound.Address\n            Do\n                'Here you can check what value is in column B by using rngFound.Offset(, 1).Value\n                'You can use this to compare to something you're looking for, or just record the result as shown in this code\n\n                strResults = strResults &amp; Chr(10) &amp; varUnq &amp; \": \" &amp; rngFound.Offset(, 1).Value\n\n                'Advance to the next found instance of the unique string\n                Set rngFound = Columns(\"A\").Find(varUnq, rngFound, xlValues, xlPart)\n            Loop While rngFound.Address &lt;&gt; strFirst\n        End If\n    Next varUnq\n\n    If Len(strResults) &gt; 0 Then\n        strResults = Mid(strResults, 2) 'Get rid of opening chr(10)\n        MsgBox strResults\n    Else\n        MsgBox \"No matches found for any of the 10 unique values\"\n    End If\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "is_accepted": true, "score": 1, "last_activity_date": 1435169384, "creation_date": 1435169384, "answer_id": 31033912, "question_id": 31033606, "link": "https://stackoverflow.com/questions/31033606/excel-check-whether-a-combination-of-cells-in-a-row-exists-in-a-range/31033912#31033912", "title": "excel check whether a combination of cells in a row exists in a range", "body": "<p>Something like this works. It might not be optimal but shows how to iterate through the rows in a range:</p>\n\n<pre><code>Sub test()\n    Dim count As Long, i As Long\n    Dim myRow As Range\n    Dim uniques As Variant\n    uniques = Array(\"a\", \"b\", \"c\", \"d\", \"e\", \"f\", \"g\", \"h\", \"i\") 'for example\n    i = 12 'for example\n    For Each myRow In Range(\"A1:B365\").Rows\n        If myRow.Cells(1, 1).Value = uniques(1) And myRow.Cells(1, 2).Value = i Then\n            count = count + 1\n        End If\n    Next myRow\n    MsgBoxS count\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 349, "user_id": 3050376, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/biCu0.jpg?s=128&g=1", "display_name": "jollarvia", "link": "https://stackoverflow.com/users/3050376/jollarvia"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1388, "favorite_count": 0, "accepted_answer_id": 31033912, "answer_count": 2, "score": 0, "last_activity_date": 1435169384, "creation_date": 1435168410, "question_id": 31033606, "link": "https://stackoverflow.com/questions/31033606/excel-check-whether-a-combination-of-cells-in-a-row-exists-in-a-range", "title": "excel check whether a combination of cells in a row exists in a range", "body": "<p>I've looked around and I can't find it.</p>\n\n<p>So lets say I have an array of these unique strings:</p>\n\n<pre><code>Dim uniques(10) As String\n</code></pre>\n\n<p>Now each of these Strings are represented in the A column on the spreadsheet.</p>\n\n<p>Also I have a range of Integers going from 1 - 365 representing unique values in column B. The ith day i</p>\n\n<p>My conundrum is:\nI want to know whether there exists a row where A is uniques(1) and b is i\nand I want to itterate this process through all uniques and all possible i's</p>\n\n<p>I'm looking for an efficient way to do this, anything better than looping through the range in question, for each unique, for each day.\nFor the record my actual data is counting every day of the year and the number of days since a certain event has happened so my number of rows can grow as large as 365^2 and maybe even more if the event happened more than a year ago.</p>\n\n<p>COUNTIFS seems to work pretty good. I wish I I could just go:</p>\n\n<pre><code>numOfOccurences = Sheet1.Countifs(countrange,dayrange,uniques(1),irange,i)\n</code></pre>\n\n<p>And if numOfOccurences is greater than 0 then I know it exists.</p>\n\n<p>Or is there a function that breaks a Range into rows in a vba array?\nSo that it looks like this {[A2,B2],[A3,B3],...} I could do some damage with that because both the columns come sorted, A then B. I'm just not looking forward to making the function myself.</p>\n\n<p>All ideas are appreciated</p>\n"}, {"tags": ["excel", "vba", "loops"], "comments": [{"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1435168398, "post_id": 31033533, "comment_id": 50091726, "body": "Your code is doing this: &quot;If a cell in column B is not blank, make the cell in column D on the same row blank&quot;, is that what you mean to be doing?"}, {"owner": {"reputation": 19, "user_id": 5042681, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e05e37bef43b9c61eb050f3b3907047c?s=128&d=identicon&r=PG&f=1", "display_name": "learninonthego", "link": "https://stackoverflow.com/users/5042681/learninonthego"}, "reply_to_user": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1435168828, "post_id": 31033533, "comment_id": 50092006, "body": "hmm when I run it it poluates column D with information based on the formula which references column C. Unfortunately column C doesnt always have values but i dont want that to stop the loop, hence why I would like to reference column B."}, {"owner": {"reputation": 19, "user_id": 5042681, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e05e37bef43b9c61eb050f3b3907047c?s=128&d=identicon&r=PG&f=1", "display_name": "learninonthego", "link": "https://stackoverflow.com/users/5042681/learninonthego"}, "reply_to_user": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1435168971, "post_id": 31033533, "comment_id": 50092088, "body": "I have a formula that I use in the &quot;&quot; part of the 4th line but this is different in differnt parts of the procedure, just want to make sure the loop references only one column that I know will have values in it (b)"}, {"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1435169380, "post_id": 31033533, "comment_id": 50092297, "body": "Alright, well there&#39;s nothing in that code snippet referencing an entire row.  It does exactly as described, it looks in column B, starting at row 2, and if it is not blank, puts a formula in column D.  The first cell where column B is blank will cause the loop to exit."}, {"owner": {"reputation": 19, "user_id": 5042681, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e05e37bef43b9c61eb050f3b3907047c?s=128&d=identicon&r=PG&f=1", "display_name": "learninonthego", "link": "https://stackoverflow.com/users/5042681/learninonthego"}, "reply_to_user": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1435237246, "post_id": 31033533, "comment_id": 50123199, "body": "Ok yeah the problem was in my formula, it was referencing the wrong column which had blank values in it, haha"}], "owner": {"reputation": 19, "user_id": 5042681, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e05e37bef43b9c61eb050f3b3907047c?s=128&d=identicon&r=PG&f=1", "display_name": "learninonthego", "link": "https://stackoverflow.com/users/5042681/learninonthego"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 413, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1435168149, "creation_date": 1435168149, "question_id": 31033533, "link": "https://stackoverflow.com/questions/31033533/how-to-make-a-do-while-function-use-a-column-as-the-argument", "title": "How to make a &quot;Do while&quot; function use a column as the argument", "body": "<p>I am using multiple loops within my sub and am running into issues regarding blank cell values. Below is a sample that is causing me issues:</p>\n\n<pre><code>ActiveCell.FormulaR1C1 = \"Host Name\"\n r = 2\nDo While Cells(r, 2) &lt;&gt; \"\"\nCells(r, 4).FormulaR1C1 = \"\"\nr = r + 1\nLoop\n</code></pre>\n\n<p>I want the loop to run until column B doesn't have a value and i am placing values based on the formula in D column. Currently this is referencing the entire row and if one value isn't there, stopping. Any advice? Thanks!</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 8006, "user_id": 2753501, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0a5ac280a03c3a9d89488dc33f0ef075?s=128&d=identicon&r=PG&f=1", "display_name": "ZygD", "link": "https://stackoverflow.com/users/2753501/zygd"}, "edited": false, "score": 0, "creation_date": 1435168527, "post_id": 31033498, "comment_id": 50091798, "body": "You missed one last line: <code>calcAscentTime = T</code>"}, {"owner": {"reputation": 8006, "user_id": 2753501, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0a5ac280a03c3a9d89488dc33f0ef075?s=128&d=identicon&r=PG&f=1", "display_name": "ZygD", "link": "https://stackoverflow.com/users/2753501/zygd"}, "edited": false, "score": 0, "creation_date": 1436379383, "post_id": 31033498, "comment_id": 50591352, "body": "Maybe it&#39;s time to mark the check the \u2713 symbol next to the answer?"}], "answers": [{"tags": [], "owner": {"reputation": 3730, "user_id": 652301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3fa42db9e3dd408f0de546a82d67c016?s=128&d=identicon&r=PG&f=1", "display_name": "sous2817", "link": "https://stackoverflow.com/users/652301/sous2817"}, "is_accepted": false, "score": 0, "last_activity_date": 1435168657, "creation_date": 1435168657, "answer_id": 31033682, "question_id": 31033498, "link": "https://stackoverflow.com/questions/31033498/returning-correct-value-from-vba-script-to-excel-cell/31033682#31033682", "title": "Returning correct value from VBA script to Excel cell", "body": "<p>ou're function isn't returning anything.  Assigning the function name to the calculated variable should return the expected result (assuming you have everything else right).  Something like:</p>\n\n<pre><code>Public Function calcAscentTime()\n\nIDepth = CInt(Sheets(\"Fundies\").Range(\"B47\"))\nT = 0\n\nT = T + 1   ' Add 1 minute for emergency\nD = Math.Round((IDepth / 10) * 10) 'Round to Ceiling of nearest 10\n\nhalf_depth = Math.Round(((D / 2) / 10) * 10, 0)  'Get where our first stop is\nT = T + Math.Round((((D - half_depth) / 30) / 2) * 2) ' Ascend to first stop at 30ft/min\n\nT = T + (half_depth / 10) ' 1 minute for every stop thereafter\ncalcAscentTime = T\nEnd Function\n</code></pre>\n\n<p>Keep in mind, you should probably Dim your variables to the proper type to avoid any kind of confusion / miss-casting by the compiler.  </p>\n"}], "owner": {"reputation": 807, "user_id": 221354, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/7a1ccde19798075e913cb78f6e86e8f8?s=128&d=identicon&r=PG", "display_name": "llaskin", "link": "https://stackoverflow.com/users/221354/llaskin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 24, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1435168657, "creation_date": 1435168053, "question_id": 31033498, "link": "https://stackoverflow.com/questions/31033498/returning-correct-value-from-vba-script-to-excel-cell", "title": "Returning correct value from VBA script to Excel cell", "body": "<p>I have a method I wrote in a VBA module</p>\n\n<pre><code>Public Function calcAscentTime()\n\nIDepth = CInt(Sheets(\"Fundies\").Range(\"B47\"))\nT = 0\n\nT = T + 1   ' Add 1 minute for emergency\nD = Math.Round((IDepth / 10) * 10) 'Round to Ceiling of nearest 10\n\nhalf_depth = Math.Round(((D / 2) / 10) * 10, 0)  'Get where our first stop is\nT = T + Math.Round((((D - half_depth) / 30) / 2) * 2) ' Ascend to first stop at 30ft/min\n\nT = T + (half_depth / 10) ' 1 minute for every stop thereafter\n</code></pre>\n\n<p>What this does is take a value from Cell B47 on the \"Fundies\" worksheet and should return a value based on the calculations.  I enter =calcAscentTime() into cell B48, expecting to get a value of 8(B47's value is 100), but get a return value of 0.  What am I doing wrong?</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 577, "user_id": 1125663, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/af96000115315214022f55112b9dc4d9?s=128&d=identicon&r=PG", "display_name": "Saladsamurai", "link": "https://stackoverflow.com/users/1125663/saladsamurai"}, "is_accepted": false, "score": 0, "last_activity_date": 1435168562, "creation_date": 1435168562, "answer_id": 31033660, "question_id": 31033475, "link": "https://stackoverflow.com/questions/31033475/access-vba-format-excel-column-to-general-using-texttocolumns/31033660#31033660", "title": "Access VBA - Format excel column to General using TextToColumns", "body": "<p>Hi mccoydo:  I am not sure what the most efficient way to do this is, but by adding the statement <code>rng.NumberFormat = \"mm/dd/yyyy\"</code> I was able to change the format of a range.</p>\n\n<p>In your code, the argument <code>xlGeneralFormat</code> looks suspicious and there might be an alternative that gets you desired result in one fell swoop.</p>\n"}], "owner": {"reputation": 55, "user_id": 4660232, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/2cc310b8980ba78d8b6988854662cf45?s=128&d=identicon&r=PG&f=1", "display_name": "mccdo", "link": "https://stackoverflow.com/users/4660232/mccdo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 248, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1435168562, "creation_date": 1435167988, "question_id": 31033475, "link": "https://stackoverflow.com/questions/31033475/access-vba-format-excel-column-to-general-using-texttocolumns", "title": "Access VBA - Format excel column to General using TextToColumns", "body": "<p>I'm trying to format a column in excel using TextToColumns in access vba. I'd like to format the column (which contain dates in excel) to General format. I don't encounter an error when the code is ran, but the format of the column doesn't change. </p>\n\n<p>Excerpt of the code where formatting is run is given below:</p>\n\n<pre><code>Dim rng as Range\n    set rng= oWS.Range(\"AD:AD\")\n        rng.TextToColumns Destination:=rng, DataType:=xlFixedWidth,FieldInfo:=Array(0, xlGeneralFormat)\n</code></pre>\n\n<p>Any suggestions? Thanks. </p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 5045668, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cb1f20ee65d6aa1e24d651ad50416225?s=128&d=identicon&r=PG&f=1", "display_name": "GMT", "link": "https://stackoverflow.com/users/5045668/gmt"}, "edited": false, "score": 0, "creation_date": 1435168486, "post_id": 31033250, "comment_id": 50091772, "body": "That does it! I knew it had to be easy, but couldn&#39;t find the answer. Thanks so much!"}], "tags": [], "owner": {"reputation": 862, "user_id": 1560126, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/8cebd478b6291f992ce5b2547b9c36f3?s=128&d=identicon&r=PG", "display_name": "ale10ander", "link": "https://stackoverflow.com/users/1560126/ale10ander"}, "is_accepted": true, "score": 0, "last_activity_date": 1435168591, "last_edit_date": 1435168591, "creation_date": 1435167183, "answer_id": 31033250, "question_id": 31033111, "link": "https://stackoverflow.com/questions/31033111/excel-vba-run-macro-based-upon-active-cell/31033250#31033250", "title": "Excel VBA - Run macro based upon Active Cell", "body": "<p>You want to use ActiveCell.Address\nIt will tell you a value like $A$1, which you can then use in your comparison.</p>\n\n<p>Try this sample code to see how the returned value is formatted:</p>\n\n<p><code>Sub selectRange()\n    MsgBox ActiveCell.Address\nEnd Sub</code></p>\n\n<p>For your case, you'd want something like</p>\n\n<p><code>If ActiveCell.Address = \"$C$36\" Then</code></p>\n"}], "owner": {"reputation": 25, "user_id": 5045668, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cb1f20ee65d6aa1e24d651ad50416225?s=128&d=identicon&r=PG&f=1", "display_name": "GMT", "link": "https://stackoverflow.com/users/5045668/gmt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4898, "favorite_count": 0, "accepted_answer_id": 31033250, "answer_count": 1, "score": 1, "last_activity_date": 1435168591, "creation_date": 1435166666, "last_edit_date": 1435167303, "question_id": 31033111, "link": "https://stackoverflow.com/questions/31033111/excel-vba-run-macro-based-upon-active-cell", "title": "Excel VBA - Run macro based upon Active Cell", "body": "<p>I'm creating an Excel macro that will filter a source worksheet based upon several criteria. Basically, the macro says if you're in the Ford sheet, go to the source sheet and filter on ford. That part is easy. What I'm struggling with is telling it to filter the source sheet based upon the active cell. So...</p>\n\n<p>If ActiveCell is A1, go to source and perform a filter of X number of criteria, else if ActiveCell is B1, go to source and perform this other filter, and so on and so forth.</p>\n\n<p>Here's what I have so far:</p>\n\n<pre><code>If ActiveCell = Range(\"C36\") Then\n    Sheets(\"Source-Cars\").Select\n        'Unfilter data\n        Application.Goto (Sheets(\"Source-Cars\").Range(\"A1\"))\n        If ActiveSheet.FilterMode Then \n           ActiveSheet.ShowAllData\n        end if\nend if\n</code></pre>\n\n<p>The problem here is that ActiveCell = Range(\"C36\") is looking at the value of that cell, not whether or not I've selected the cell. So, if I select another cell with the same value as C36, it performs the filter instead of returning the error message box I built in.</p>\n\n<p>Thoughts on how to run the logic based upon what cell is active (versus the value of said cell)? Thanks!</p>\n\n<p>G</p>\n"}, {"tags": ["vba", "excel", "excel-2010"], "comments": [{"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1435166901, "post_id": 31033095, "comment_id": 50090802, "body": "In any event -- why use a case statement (as opposed to an if-then-else) when deciding between 2 possibilities?"}, {"owner": {"reputation": 942, "user_id": 4974730, "user_type": "registered", "accept_rate": 60, "profile_image": "https://lh3.googleusercontent.com/-Hvpxpah3yUo/AAAAAAAAAAI/AAAAAAAAAGU/GfmmmHA1IO0/photo.jpg?sz=128", "display_name": "Thomas Shera", "link": "https://stackoverflow.com/users/4974730/thomas-shera"}, "reply_to_user": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1435166997, "post_id": 31033095, "comment_id": 50090848, "body": "@JohnColeman it&#39;s in the code."}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1435167328, "post_id": 31033095, "comment_id": 50091048, "body": "I can see that it is in the code, but the question is why. It isn&#39;t an idiomatic use of the case construct."}], "answers": [{"comments": [{"owner": {"reputation": 942, "user_id": 4974730, "user_type": "registered", "accept_rate": 60, "profile_image": "https://lh3.googleusercontent.com/-Hvpxpah3yUo/AAAAAAAAAAI/AAAAAAAAAGU/GfmmmHA1IO0/photo.jpg?sz=128", "display_name": "Thomas Shera", "link": "https://stackoverflow.com/users/4974730/thomas-shera"}, "edited": false, "score": 0, "creation_date": 1435167024, "post_id": 31033146, "comment_id": 50090864, "body": "Thanks, that fixes it!"}], "tags": [], "owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "is_accepted": true, "score": 4, "last_activity_date": 1435166793, "creation_date": 1435166793, "answer_id": 31033146, "question_id": 31033095, "link": "https://stackoverflow.com/questions/31033095/vba-compile-error-argument-not-optional/31033146#31033146", "title": "VBA &quot;Compile error: argument not optional&quot;", "body": "<p>The case labels should be values, not function names. Try </p>\n\n<pre><code>Case True\n</code></pre>\n"}], "owner": {"reputation": 942, "user_id": 4974730, "user_type": "registered", "accept_rate": 60, "profile_image": "https://lh3.googleusercontent.com/-Hvpxpah3yUo/AAAAAAAAAAI/AAAAAAAAAGU/GfmmmHA1IO0/photo.jpg?sz=128", "display_name": "Thomas Shera", "link": "https://stackoverflow.com/users/4974730/thomas-shera"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 896, "favorite_count": 0, "accepted_answer_id": 31033146, "answer_count": 1, "score": 0, "last_activity_date": 1442276851, "creation_date": 1435166608, "last_edit_date": 1442276851, "question_id": 31033095, "link": "https://stackoverflow.com/questions/31033095/vba-compile-error-argument-not-optional", "title": "VBA &quot;Compile error: argument not optional&quot;", "body": "<p>I have a VBA macro which selects the user's data type choice for other calculations. </p>\n\n<pre><code>Sub Function1()\n'   Give the user macro options based on how fast or slow the computer is using advanced conditional compliling\nMsgBox (\"This macro by default treats all numbers as decimals for maximum precision. If you are running this macro on an old computer, you may want to relare numbers as singles, to speed up the macro.\")\nMsgBox (\"Decimals are reccomended for any scientific conclusions.\")\nMsgBox (\"Decimal: reccomended for maximum precision. Also slower.\" &amp; vbNewLine &amp; \"Double: not reccomended.\" &amp; vbNewLine &amp; \"Single: not reccomended. A lightweight double.\" &amp; vbNewLine &amp; \"Long: rounds to nearest number. Massive range of possible values.\" &amp; vbNewLine &amp; \"Integer: designed for quick estimates of data.\")\nvuserChoice = InputBox(\"Select a data type:\" &amp; vbNewLine &amp; \"1. Decimal\" &amp; vbNewLine &amp; \"2. Long\" &amp; vbNewLine &amp; \"3. Single\" &amp; vbNewLine &amp; \"5. Integer\")\n\nSelect Case IsNumeric(vuserChoice)\n    Case IsNumeric = True\n       MsgBox (\"A number cannot be entered for data type.\")\n    Case IsNumeric = False\n         struserChoice = CStr(vuserChoice)\n\nIf struserChoice = \"Decimal\" Or \"decimal\" Or \"1\" Or \"one\" Or \"on\" Or \"Dec\" Or \"dec\" Then\n    Call FunctionDecimal\nElseIf struserChoice = \"Double\" Or \"double\" Or \"2\" Or \"two\" Or \"to\" Then\n    FunctionDouble\nElseIf struserChoice = \"Single\" Or \"single\" Or \"3\" Or \"three\" Or \"three\" Or \"thee\" Then\n    FunctionSingle\nElseIf struserChoice = \"Long\" Or \"long\" Or \"4\" Or \"four\" Or \"for\" Or \"foor\" Then\n    FunctionLong\nElseIf struserChoice = \"Integer\" Or \"integer\" Or \"int\" Then\n    FunctionInteger\nElse\n    FunctionNotValidVarType\nEnd If\n'   MEeff = measure of efflux due to crudely purified HDL in scintillation\nMsgBox \"For additional information about this macro:\" &amp; vbNewLine &amp; \"1. Go to tab Developer\" &amp; vbNewLine &amp; \"2. Select Visual Basic or Macro.\" &amp; vbNewLine &amp; \"See the comments or MsgBoxes (message boxes).\"\nEnd Sub\n</code></pre>\n\n<p>Here is the offending line of code:</p>\n\n<pre><code>    Case IsNumeric = True\n</code></pre>\n\n<p>What do I need to do to fix this? I know IsNumeric is a built-in VBA feature.</p>\n"}, {"tags": ["excel", "vba", "vbscript"], "comments": [{"owner": {"reputation": 816, "user_id": 470606, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/3f84ce00e9280fce870e5de39230a19c?s=128&d=identicon&r=PG", "display_name": "Brian M.", "link": "https://stackoverflow.com/users/470606/brian-m"}, "edited": false, "score": 0, "creation_date": 1435166705, "post_id": 31032911, "comment_id": 50090674, "body": "You need to specify WHAT and WHERE your errors are.  Which lines of code cause what errors?"}], "answers": [{"tags": [], "owner": {"reputation": 37163, "user_id": 603855, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91b541c001a51839aebfb1da088861b9?s=128&d=identicon&r=PG", "display_name": "Ekkehard.Horner", "link": "https://stackoverflow.com/users/603855/ekkehard-horner"}, "is_accepted": true, "score": 5, "last_activity_date": 1435168196, "creation_date": 1435168196, "answer_id": 31033550, "question_id": 31032911, "link": "https://stackoverflow.com/questions/31032911/unable-to-create-simple-vba-function-in-excel-macro-and-call-it/31033550#31033550", "title": "Unable to create simple VBA function in Excel Macro and call it", "body": "<p>Both VBA and VBScript use 'assignment to function' (instead of 'return' or 'result of last statement') to return results from functions. So</p>\n\n<pre><code>Public Function createStructBody() As String\n    createStructBody = \"Hey I'm a string and can be returned.\"\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 317, "user_id": 1015013, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/9e6b3bcfe07fcf9aefe629a96ede83ff?s=128&d=identicon&r=PG", "display_name": "nndhawan", "link": "https://stackoverflow.com/users/1015013/nndhawan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 131, "favorite_count": 0, "accepted_answer_id": 31033550, "answer_count": 1, "score": 0, "last_activity_date": 1435168196, "creation_date": 1435166004, "last_edit_date": 1435167758, "question_id": 31032911, "link": "https://stackoverflow.com/questions/31032911/unable-to-create-simple-vba-function-in-excel-macro-and-call-it", "title": "Unable to create simple VBA function in Excel Macro and call it", "body": "<p>I'm trying to create a macro that can collect data from an excel spreadsheet in the local active workbook and then create header file which I would later incorporate into my project. But for the life of me I must be missing something so DUMB that I can't create a working function that returns a string (which would construct a C++ structure) to the calling function. I've simplified the example code to is absolute bare minimum to isolate the problem but I still cannot figure out what I'm doing wrong. I'm not an expert at VBA but I know how to create code and I can't narrow down what VBA is unhappy about. I keep getting \"compile error, syntax error.\" Please copy the following code into your module and see if compiles properly for you. If you know where I went wrong please let me know. Much Appreciated!!!</p>\n\n<pre><code>Sub CREATE_FACTORY_SETTING_HEADER()\n    Dim FS, TSsource\n    Set FS = CreateObject(\"Scripting.FileSystemObject\")\n\n    Dim TSout\n    Set TSout = FS.Createtextfile(\"HeaderFile.h\", True)\n\n    Dim fileHeading As String\n    fileHeading = \"File Heading for Header file\"\n\n    Dim fileBody As String\n    fileBody = \"Some initial file body lines\"\n\n    fileBody = fileBody &amp; createStructBody\n\n    TSout.Write fileHeading &amp; fileBody\n    TSout.Close    \nEnd Sub\n\n\nPublic Function createStructBody() As String\n    Dim structBody As String\n    structBody = \"Hey I'm a struct body, but I can't be returned for some     reason\"\n    Return structBody\nEnd Function\n</code></pre>\n"}, {"tags": ["mysql", "ms-access", "vba", "linked-tables"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 4999909, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7fa88b4db025b069539f74430736b249?s=128&d=identicon&r=PG&f=1", "display_name": "Shalaph", "link": "https://stackoverflow.com/users/4999909/shalaph"}, "edited": false, "score": 0, "creation_date": 1435168362, "post_id": 31033190, "comment_id": 50091707, "body": "Thanks for the feedback, I may not have explained myself well, the query works well, I wanted was an automatic way to run it whenever a line is introduced, I can not remove the local table because several operations are generated in it. The table ClienteSql only purpose is for web&#39;s consultations to a webservice. is there any other way?"}, {"owner": {"reputation": 33012, "user_id": 64895, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/340c167b065daea534a020efa1fb6649?s=128&d=identicon&r=PG", "display_name": "Jack BeNimble", "link": "https://stackoverflow.com/users/64895/jack-benimble"}, "reply_to_user": {"reputation": 3, "user_id": 4999909, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7fa88b4db025b069539f74430736b249?s=128&d=identicon&r=PG&f=1", "display_name": "Shalaph", "link": "https://stackoverflow.com/users/4999909/shalaph"}, "edited": false, "score": 0, "creation_date": 1435169618, "post_id": 31033190, "comment_id": 50092413, "body": "I always tended to avoid macros, anyway. My preference is to run a VB function. It&#39;s easier to debug, for example - you can walk through the code. There are plenty of examples of accessing databases via code on the net. But how will you get it to be triggered automatically?"}, {"owner": {"reputation": 3, "user_id": 4999909, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7fa88b4db025b069539f74430736b249?s=128&d=identicon&r=PG&f=1", "display_name": "Shalaph", "link": "https://stackoverflow.com/users/4999909/shalaph"}, "edited": false, "score": 0, "creation_date": 1435170242, "post_id": 31033190, "comment_id": 50092726, "body": "I realy don&#39;t no, this is my problem, i don&#39;t no how to trigger it when a row is inserted in the Client table, i was thinking that maybe it was possible to do it by data macro, because it work well with local tables, but when i tried with linked table..... does n work.... now I&#39;m thinking that my approach is all wrong, and i realy don&#39;t now how to do it...  I have to try another approach. Thanks for your help"}, {"owner": {"reputation": 33012, "user_id": 64895, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/340c167b065daea534a020efa1fb6649?s=128&d=identicon&r=PG", "display_name": "Jack BeNimble", "link": "https://stackoverflow.com/users/64895/jack-benimble"}, "reply_to_user": {"reputation": 3, "user_id": 4999909, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7fa88b4db025b069539f74430736b249?s=128&d=identicon&r=PG&f=1", "display_name": "Shalaph", "link": "https://stackoverflow.com/users/4999909/shalaph"}, "edited": false, "score": 0, "creation_date": 1435171295, "post_id": 31033190, "comment_id": 50093333, "body": "Can you automatically run a macro when a row is inserted, even if it&#39;s just locally? For example, can you run a macro that says, &quot;Hello&quot; when a row is inserted? If your code is structured such that this is possible, then you&#39;re not necessarily on the wrong track."}, {"owner": {"reputation": 3, "user_id": 4999909, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7fa88b4db025b069539f74430736b249?s=128&d=identicon&r=PG&f=1", "display_name": "Shalaph", "link": "https://stackoverflow.com/users/4999909/shalaph"}, "edited": false, "score": 0, "creation_date": 1435171958, "post_id": 31033190, "comment_id": 50093738, "body": "it let me do some operation, but not show  alert, like send a email, or incert data into local table, data macro as not the same permitions as the simple macro. (i m not sure if it&#180;s call data macro in portugues its call &quot;pos action events&quot;).... Now im tring to do the conection and a query with php maybe it will work.... Thanks again, and sorry, i m verry noob in access..."}, {"owner": {"reputation": 33012, "user_id": 64895, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/340c167b065daea534a020efa1fb6649?s=128&d=identicon&r=PG", "display_name": "Jack BeNimble", "link": "https://stackoverflow.com/users/64895/jack-benimble"}, "reply_to_user": {"reputation": 3, "user_id": 4999909, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7fa88b4db025b069539f74430736b249?s=128&d=identicon&r=PG&f=1", "display_name": "Shalaph", "link": "https://stackoverflow.com/users/4999909/shalaph"}, "edited": false, "score": 0, "creation_date": 1435173285, "post_id": 31033190, "comment_id": 50094500, "body": "Good luck - most apps these days are Web-based or mobile anyway, so PHP sounds like a good option."}], "tags": [], "owner": {"reputation": 33012, "user_id": 64895, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/340c167b065daea534a020efa1fb6649?s=128&d=identicon&r=PG", "display_name": "Jack BeNimble", "link": "https://stackoverflow.com/users/64895/jack-benimble"}, "is_accepted": true, "score": 0, "last_activity_date": 1435166937, "creation_date": 1435166937, "answer_id": 31033190, "question_id": 31032660, "link": "https://stackoverflow.com/questions/31032660/how-to-run-append-query-from-data-macro-ms-access/31033190#31033190", "title": "How to run append query from data macro MS Access?", "body": "<p>I'm not sure why you should be able to do it manually, but not via a macro. According to this link </p>\n\n<pre><code>http://dev.mysql.com/doc/connector-odbc/en/connector-odbc-examples-tools-with-access-linked-tables.html\n</code></pre>\n\n<p>you should be able to do it either way. </p>\n\n<p>Another thought is to eliminate the local access client table and have the access program update the mySql table directly. However, if another program is accessing the client table at the same time, this could become tricky due to multi-user and locking situations. </p>\n"}], "owner": {"reputation": 3, "user_id": 4999909, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7fa88b4db025b069539f74430736b249?s=128&d=identicon&r=PG&f=1", "display_name": "Shalaph", "link": "https://stackoverflow.com/users/4999909/shalaph"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1129, "favorite_count": 0, "accepted_answer_id": 31033190, "answer_count": 1, "score": 0, "last_activity_date": 1435217413, "creation_date": 1435165128, "last_edit_date": 1435217413, "question_id": 31032660, "link": "https://stackoverflow.com/questions/31032660/how-to-run-append-query-from-data-macro-ms-access", "title": "How to run append query from data macro MS Access?", "body": "<p>I have 2 table, one is local named 'Client' and other is a linked table to MySQL DB in my web-server named 'ClientSql'.\nWhen I insert data into the table <code>Client</code>, I want it to be insert into <code>clientSql</code> too. I try it with data macro (after insert), but it shows me an error saying </p>\n\n<blockquote>\n  <p>It's not possible in linked tables.</p>\n</blockquote>\n\n<p>I have tried to create an append query successfully, and it works, but it just works if I execute it manually. My question is:<br>\nIs it possible to call it from a data macro? if is possible, can you show me how? If not, can you point me to a solution?</p>\n"}, {"tags": ["vba", "excel", "ms-word"], "answers": [{"comments": [{"owner": {"reputation": 147, "user_id": 4242750, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/0f78647b3093dbf3c60a6a77dcb082ee?s=128&d=identicon&r=PG&f=1", "display_name": "user4242750", "link": "https://stackoverflow.com/users/4242750/user4242750"}, "edited": false, "score": 0, "creation_date": 1435166661, "post_id": 31032874, "comment_id": 50090649, "body": "Thanks very much for the response. I get User-defined type not defined error? And then it highlights the dim wdapp part? How can I correct this @nicholas"}, {"owner": {"reputation": 147, "user_id": 4242750, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/0f78647b3093dbf3c60a6a77dcb082ee?s=128&d=identicon&r=PG&f=1", "display_name": "user4242750", "link": "https://stackoverflow.com/users/4242750/user4242750"}, "edited": false, "score": 0, "creation_date": 1435167166, "post_id": 31032874, "comment_id": 50090944, "body": "I have also added Word under references, really stuck here? @nicholas"}, {"owner": {"reputation": 1049, "user_id": 3251199, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/bf61d317161fc12eb6c9b74c546be321?s=128&d=identicon&r=PG&f=1", "display_name": "nicholas79171", "link": "https://stackoverflow.com/users/3251199/nicholas79171"}, "reply_to_user": {"reputation": 147, "user_id": 4242750, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/0f78647b3093dbf3c60a6a77dcb082ee?s=128&d=identicon&r=PG&f=1", "display_name": "user4242750", "link": "https://stackoverflow.com/users/4242750/user4242750"}, "edited": false, "score": 0, "creation_date": 1435167430, "post_id": 31032874, "comment_id": 50091111, "body": "@user4242750 Just updated the post with how the <code>wrdApp</code> variable gets set."}, {"owner": {"reputation": 147, "user_id": 4242750, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/0f78647b3093dbf3c60a6a77dcb082ee?s=128&d=identicon&r=PG&f=1", "display_name": "user4242750", "link": "https://stackoverflow.com/users/4242750/user4242750"}, "edited": false, "score": 0, "creation_date": 1435167838, "post_id": 31032874, "comment_id": 50091351, "body": "Still giving me the same error in the same place? @nicholas. Is this a usual problem? I just see on all pages to just turn my references to word on in this case. Thanks for your help i appreciate it. Is there anything I must change from your code above?"}, {"owner": {"reputation": 1049, "user_id": 3251199, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/bf61d317161fc12eb6c9b74c546be321?s=128&d=identicon&r=PG&f=1", "display_name": "nicholas79171", "link": "https://stackoverflow.com/users/3251199/nicholas79171"}, "reply_to_user": {"reputation": 147, "user_id": 4242750, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/0f78647b3093dbf3c60a6a77dcb082ee?s=128&d=identicon&r=PG&f=1", "display_name": "user4242750", "link": "https://stackoverflow.com/users/4242750/user4242750"}, "edited": false, "score": 0, "creation_date": 1435167991, "post_id": 31032874, "comment_id": 50091457, "body": "Try running the example code I linked to in the post, not the code I posted in my comment just to make sure everything is set up properly and you have Word linked correctly."}, {"owner": {"reputation": 147, "user_id": 4242750, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/0f78647b3093dbf3c60a6a77dcb082ee?s=128&d=identicon&r=PG&f=1", "display_name": "user4242750", "link": "https://stackoverflow.com/users/4242750/user4242750"}, "edited": false, "score": 0, "creation_date": 1435168195, "post_id": 31032874, "comment_id": 50091588, "body": "Ok I have done so @nicholas, one doesn&#39;t. the one that does work is: Sub M_snb()      With CreateObject(&quot;Word.Document&quot;)          .Windows(1).Visible = True          .Content = &quot;Example&quot;      End With  End Sub"}, {"owner": {"reputation": 1049, "user_id": 3251199, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/bf61d317161fc12eb6c9b74c546be321?s=128&d=identicon&r=PG&f=1", "display_name": "nicholas79171", "link": "https://stackoverflow.com/users/3251199/nicholas79171"}, "reply_to_user": {"reputation": 147, "user_id": 4242750, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/0f78647b3093dbf3c60a6a77dcb082ee?s=128&d=identicon&r=PG&f=1", "display_name": "user4242750", "link": "https://stackoverflow.com/users/4242750/user4242750"}, "edited": false, "score": 0, "creation_date": 1435168611, "post_id": 31032874, "comment_id": 50091852, "body": "So you ran the code that I just posted as &quot;test code&quot;? What error do you get exactly?"}, {"owner": {"reputation": 147, "user_id": 4242750, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/0f78647b3093dbf3c60a6a77dcb082ee?s=128&d=identicon&r=PG&f=1", "display_name": "user4242750", "link": "https://stackoverflow.com/users/4242750/user4242750"}, "reply_to_user": {"reputation": 1049, "user_id": 3251199, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/bf61d317161fc12eb6c9b74c546be321?s=128&d=identicon&r=PG&f=1", "display_name": "nicholas79171", "link": "https://stackoverflow.com/users/3251199/nicholas79171"}, "edited": false, "score": 0, "creation_date": 1435168626, "post_id": 31032874, "comment_id": 50091867, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/81450/discussion-between-user4242750-and-nicholas79171\">continue this discussion in chat</a>."}], "tags": [], "owner": {"reputation": 1049, "user_id": 3251199, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/bf61d317161fc12eb6c9b74c546be321?s=128&d=identicon&r=PG&f=1", "display_name": "nicholas79171", "link": "https://stackoverflow.com/users/3251199/nicholas79171"}, "is_accepted": true, "score": 1, "last_activity_date": 1435168568, "last_edit_date": 1435168568, "creation_date": 1435165884, "answer_id": 31032874, "question_id": 31032325, "link": "https://stackoverflow.com/questions/31032325/save-export-from-range-in-excel-to-word-and-save-as-name-in-cell-a1/31032874#31032874", "title": "Save export from range in excel to Word and save as name in Cell A1", "body": "<p>Try this code out:</p>\n\n<pre><code>Sub Export_Table_Data_Word()\n\n    'Name of the existing Word document\n    ' Const stWordDocument As String = \"Table Report.docx\"\n\n    'Word objects.\n    Dim wdApp As Word.Application\n    Dim wdDoc As Word.Document\n    Dim wdCell As Word.Cell\n\n    'Excel objects\n    Dim wbBook As Workbook\n    Dim wsSheet As Worksheet\n\n    'Count used in a FOR loop to fill the Word table.\n    Dim lnCountItems As Long\n\n    'Variant to hold the data to be exported.\n    Dim vaData As Variant\n\n    'File path based on A1'\n    Dim filePath As String\n        filePath = \"C:\\FolderName\\\" &amp; Cells(1, 1).Value &amp; \".doc\"\n\n    'Initialize the Excel objects\n    Set wbBook = ThisWorkbook\n    Set wsSheet = wbBook.Worksheets(\"Sheet1\")\n    vaData = wsSheet.Range(\"A1:A10\").Value\n\n    'Instantiate Word and open the new file.\n    Set wrdApp = CreateObject(\"Word.Application\") \n    Set wrdDoc = wrdApp.Documents.Add 'Create new app instead of open'\n\n\n    lnCountItems = 1\n\n    'Place the data from the variant into the table in the Word doc.\n    For Each wdCell In wdDoc.Tables(1).Columns(1).Cells\n        wdCell.Range.Text = vaData(lnCountItems, 1)\n        lnCountItems = lnCountItems + 1\n    Next wdCell\n\n    'Save and close the Word doc.\n    With wrdDoc \n        If Dir(filePath) &lt;&gt; \"\" Then \n            Kill filePath \n        End If \n        .SaveAs (filePath) \n        .Close ' close the document\n    End With \n\n    wdApp.Quit\n\n    'Null out the variables.\n    Set wdCell = Nothing\n    Set wdDoc = Nothing\n    Set wdApp = Nothing\n\n    MsgBox \"The \" &amp; stWordDocument &amp; \"'s table has succcessfully \" &amp; vbNewLine &amp; _\n           \"been updated!\", vbInformation\n\nEnd Sub\n</code></pre>\n\n<p>All that I changed was adding a <code>filePath</code> variable to store the file path (including the value found in <code>A1</code>), changed <code>wdDoc</code> to be a new document instead of opening an old one, and reconfigured the saving of the file to make sure the file isn't open before trying to save. </p>\n\n<p><a href=\"http://www.ozgrid.com/forum/showthread.php?t=50936\" rel=\"nofollow\">Here's where I got the most of the code.</a></p>\n\n<p><strong>Test code:</strong></p>\n\n<pre><code>Sub CreateNewWordDoc() \n     ' to test this code, paste it into an Excel module\n     ' add a reference to the Word-library\n     ' create a new folder named C:\\Foldername or edit the filnames in the code\n    Dim wrdApp As Word.Application \n    Dim wrdDoc As Word.Document \n    Dim i As Integer \n    Set wrdApp = CreateObject(\"Word.Application\") \n    wrdApp.Visible = True \n    Set wrdDoc = wrdApp.Documents.Add \n     ' or\n     'Set wrdDoc = wrdApp.Documents.Open(\"C:\\Foldername\\Filename.doc\")\n     ' sample word operations\n    With wrdDoc \n        For i = 1 To 100 \n            .Content.InsertAfter \"Here is a sample test line #\" &amp; i \n            .Content.InsertParagraphAfter \n        Next i \n        If Dir(\"C:\\Foldername\\MyNewWordDoc.doc\") &lt;&gt; \"\" Then \n            Kill \"C:\\Foldername\\MyNewWordDoc.doc\" \n        End If \n        .SaveAs (\"C:\\Foldername\\MyNewWordDoc.doc\") \n        .Close ' close the document\n    End With \n    wrdApp.Quit ' close the Word application\n    Set wrdDoc = Nothing \n    Set wrdApp = Nothing \nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 147, "user_id": 4242750, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/0f78647b3093dbf3c60a6a77dcb082ee?s=128&d=identicon&r=PG&f=1", "display_name": "user4242750", "link": "https://stackoverflow.com/users/4242750/user4242750"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5215, "favorite_count": 1, "accepted_answer_id": 31032874, "answer_count": 1, "score": 0, "last_activity_date": 1435219224, "creation_date": 1435164140, "last_edit_date": 1435219224, "question_id": 31032325, "link": "https://stackoverflow.com/questions/31032325/save-export-from-range-in-excel-to-word-and-save-as-name-in-cell-a1", "title": "Save export from range in excel to Word and save as name in Cell A1", "body": "<p>I am now exporting a range of cells into Word using a macro in excel. </p>\n\n<p>There are some changes though as I need it to instead copy this to a NEW Word document and not an existing one that is in the script? </p>\n\n<p>My range that is selected is made up of various Vlookup results.</p>\n\n<p>Also, if possible, I want to get the file name to be whatever is in A1.</p>\n\n<pre><code>Sub Export_Table_Data_Word()\n    'Name of the existing Word document\n    Const stWordDocument As String = \"Table Report.docx\"\n\n    'Word objects.\n    Dim wdApp As Word.Application\n    Dim wdDoc As Word.Document\n    Dim wdCell As Word.Cell\n\n    'Excel objects\n    Dim wbBook As Workbook\n    Dim wsSheet As Worksheet\n\n    'Count used in a FOR loop to fill the Word table.\n    Dim lnCountItems As Long\n\n    'Variant to hold the data to be exported.\n    Dim vaData As Variant\n\n    'Initialize the Excel objects\n    Set wbBook = ThisWorkbook\n    Set wsSheet = wbBook.Worksheets(\"Sheet1\")\n    vaData = wsSheet.Range(\"A1:A10\").Value\n\n    'Instantiate Word and open the \"Table Reports\" document.\n    Set wdApp = New Word.Application\n    Set wdDoc = wdApp.Documents.Open(wbBook.Path &amp; \"\\\" &amp; stWordDocument)\n\n    lnCountItems = 1\n\n    'Place the data from the variant into the table in the Word doc.\n    For Each wdCell In wdDoc.Tables(1).Columns(1).Cells\n        wdCell.Range.Text = vaData(lnCountItems, 1)\n        lnCountItems = lnCountItems + 1\n    Next wdCell\n\n    'Save and close the Word doc.\n    With wdDoc\n        .Save\n        .Close\n    End With\n\n    wdApp.Quit\n\n    'Null out the variables.\n    Set wdCell = Nothing\n    Set wdDoc = Nothing\n    Set wdApp = Nothing\n\n    MsgBox \"The \" &amp; stWordDocument &amp; \"'s table has succcessfully \" &amp; vbNewLine &amp; _\n           \"been updated!\", vbInformation\nEnd Sub\n</code></pre>\n\n<p>UPDATE:</p>\n\n<p>Thank you Nicholas for the assistance. Below the final script:</p>\n\n<pre><code>Sub OLDMACROADJUSTED()\n\n'Word objects.\nDim wdApp As Word.Application\nDim wdDoc As Word.Document\nDim wdCell As Word.Cell\n\n'Excel objects\nDim wbBook As Workbook\nDim wsSheet As Worksheet\n\n'Count used in a FOR loop to fill the Word table.\nDim lnCountItems As Long\n\n'Variant to hold the data to be exported.\nDim vaData As Variant\n\n'File path based on A1'\nDim filePath As String\nfilePath = \"C:\\FolderName\\\" &amp; Cells(1, 1).Value &amp; \".doc\"\n\n'Initialize the Excel objects\nSet wbBook = ThisWorkbook\nSet wsSheet = wbBook.Worksheets(\"Sheet1\")\nvaData = wsSheet.Range(\"A1:A10\").Value\n\n'Instantiate Word and open the new file.\nSet wrdApp = CreateObject(\"Word.Application\")\nSet wrdDoc = wrdApp.Documents.Add 'Create new app instead of open'\n\n\nlnCountItems = 1\n\nDim c As Range\nFor Each c In Range(\"B3:B7\")\nwrdDoc.Content.InsertAfter c\nNext c\n\n\n'Place the data from the variant into the table in the Word doc.\n'For Each wdCell In wdDoc.Tables(1).Columns(1).Cells\n'wdCell.Range.Text = vaData(lnCountItems, 1)\n'lnCountItems = lnCountItems + 1\n'Next wdCell\n\n'Save and close the Word doc.\nWith wrdDoc\nIf Dir(filePath) &lt;&gt; \"\" Then\nKill filePath\nEnd If\n.SaveAs (Range(\"B3\").Value)\n.Close ' close the document\nEnd With\n\n'wdApp.Quit\n\n'Null out the variables.\nSet wdCell = Nothing\nSet wdDoc = Nothing\nSet wdApp = Nothing\n\nMsgBox \"Your file has been saved in default location of the macro...\", vbInformation\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["forms", "ms-access", "position", "vba", "size"], "comments": [{"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1435203017, "post_id": 31032306, "comment_id": 50104756, "body": "There is no <code>reportname</code> property.  Use <code>Me.Name</code> to get the report&#39;s name.  <code>Me.Name</code> is available both in a form or report."}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 5042217, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/68b4884b5248b7c9535bc0fc6c844cde?s=128&d=identicon&r=PG&f=1", "display_name": "William", "link": "https://stackoverflow.com/users/5042217/william"}, "edited": false, "score": 1, "creation_date": 1435243122, "post_id": 31040870, "comment_id": 50128047, "body": "I have been unable to get this to work successfully.  How are you creating your function?  Ive tried to call the saved query and call the query parameters directly as below, but keep getting Too few parameters. Expected 1.      Set rs = db.OpenRecordset(&quot;SELECT s.left, s.top, s.width, s.height FROM SizPos AS s WHERE s.object = &quot; &amp; Me.Name)"}, {"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "reply_to_user": {"reputation": 23, "user_id": 5042217, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/68b4884b5248b7c9535bc0fc6c844cde?s=128&d=identicon&r=PG&f=1", "display_name": "William", "link": "https://stackoverflow.com/users/5042217/william"}, "edited": false, "score": 1, "creation_date": 1435243556, "post_id": 31040870, "comment_id": 50128412, "body": "If you want to do it that way, you will need to add quotes around <code>Me.Name</code> ... <code>Set rs = db.OpenRecordset(&quot;SELECT s.left, s.top, s.width, s.height FROM SizPos AS s WHERE s.object = &#39;&quot; &amp; Me.Name &amp; &quot;&#39;&quot;)</code>"}, {"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "reply_to_user": {"reputation": 23, "user_id": 5042217, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/68b4884b5248b7c9535bc0fc6c844cde?s=128&d=identicon&r=PG&f=1", "display_name": "William", "link": "https://stackoverflow.com/users/5042217/william"}, "edited": false, "score": 0, "creation_date": 1435243840, "post_id": 31040870, "comment_id": 50128638, "body": "I added an update to show how to use a saved parameter query."}, {"owner": {"reputation": 23, "user_id": 5042217, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/68b4884b5248b7c9535bc0fc6c844cde?s=128&d=identicon&r=PG&f=1", "display_name": "William", "link": "https://stackoverflow.com/users/5042217/william"}, "edited": false, "score": 1, "creation_date": 1435246656, "post_id": 31040870, "comment_id": 50130855, "body": "Thanks very much.  Sorry for all the questions, but I&#39;m learning a lot.  Also, thanks for the initial heads up on me.name working in reports.  I thought that was the case, but on further review, it wasn&#39;t working because the name of the report was mispelled in the table."}, {"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "reply_to_user": {"reputation": 23, "user_id": 5042217, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/68b4884b5248b7c9535bc0fc6c844cde?s=128&d=identicon&r=PG&f=1", "display_name": "William", "link": "https://stackoverflow.com/users/5042217/william"}, "edited": false, "score": 1, "creation_date": 1435247187, "post_id": 31040870, "comment_id": 50131251, "body": "You might prefer to adapt the code as generalized procedures which you could then call from the Load and Unload events of any form or report."}], "tags": [], "owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "is_accepted": true, "score": 1, "last_activity_date": 1435243811, "last_edit_date": 1435243811, "creation_date": 1435204071, "answer_id": 31040870, "question_id": 31032306, "link": "https://stackoverflow.com/questions/31032306/open-ms-access-form-or-report-in-same-location-as-when-last-closed/31040870#31040870", "title": "Open MS Access form or report in same location as when last closed", "body": "<p>Use a <code>DAO.Recordset</code> instead of 4 <code>DLookup</code> statements to fetch the values for the object's size and position.  You can also use a <code>DAO.Recordset</code> to store them later instead of building and executing <code>UPDATE</code> and <code>INSERT</code> statements.</p>\n\n<p>This is my <em>sizpos</em> table:</p>\n\n\n\n<pre class=\"lang-sql prettyprint-override\"><code>CREATE TABLE sizpos (\n    id COUNTER PRIMARY KEY,\n    obj_name TEXT(255) UNIQUE,\n    lft INTEGER,\n    tp INTEGER,\n    wdth INTEGER,\n    hght INTEGER\n    );\n</code></pre>\n\n<p>I created a parameter query to fetch stored size and position values for a given form or report name:</p>\n\n<pre class=\"lang-sql prettyprint-override\"><code>PARAMETERS which_object Text (255);\nSELECT s.obj_name, s.lft, s.tp, s.wdth, s.hght\nFROM sizpos AS s\nWHERE s.form_name=[which_object];\n</code></pre>\n\n<p>I could have saved that as a named query.  But I created a function, <em>SelectObjectSettings</em>, to return that statement text.</p>\n\n<p>So during <em>Form Load</em>, I can feed the form's name to that query and open a <code>DAO.Recordset</code> with the query's result.  Then, if the recordset is not empty, use the recordset's values to set the form's size and position:</p>\n\n\n\n<pre class=\"lang-vb prettyprint-override\"><code>Private Sub Form_Load()\n    Dim db As DAO.Database\n    Dim qdf As DAO.QueryDef\n    Dim rs As DAO.Recordset\n\n    Set db = CurrentDb\n    Set qdf = db.CreateQueryDef(vbNullString, SelectObjectSettings)\n    qdf.Parameters(\"which_object\").Value = Me.Name\n    Set rs = qdf.OpenRecordset\n    With rs\n        If Not (.BOF And .EOF) Then\n            Me.Move Left:=!lft, Top:=!tp, Width:=!wdth, Height:=!hght\n        End If\n    End With\n\n    Set rs = Nothing\n    Set qdf = Nothing\n    Set db = Nothing\n\nEnd Sub\n</code></pre>\n\n<p>Note: If you have a saved parameter query, you can <code>Set qdf</code> to that ...</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>'Set qdf = db.CreateQueryDef(vbNullString, SelectObjectSettings)\nSet qdf = db.QueryDefs(\"YourQueryName\")\n</code></pre>\n\n<p>At <em>Form Unload</em>, save the form's size and position:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Private Sub Form_Unload(Cancel As Integer)\n    Dim db As DAO.Database\n    Dim qdf As DAO.QueryDef\n    Dim rs As DAO.Recordset\n\n    Set db = CurrentDb\n    Set qdf = db.CreateQueryDef(vbNullString, SelectObjectSettings)\n    qdf.Parameters(\"which_object\").Value = Me.Name\n    Set rs = qdf.OpenRecordset\n    With rs\n        If (.BOF And .EOF) Then\n            ' no existing record for this object; create one\n            .AddNew\n            !obj_name = Me.Name\n        Else\n            ' a record exists for this object; edit it\n            .Edit\n        End If\n        !lft = Me.WindowLeft\n        !tp = Me.WindowTop\n        !wdth = Me.WindowWidth\n        !hght = Me.WindowHeight\n        .Update\n        .Close\n    End With\n\n    Set rs = Nothing\n    Set qdf = Nothing\n    Set db = Nothing\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 5042217, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/68b4884b5248b7c9535bc0fc6c844cde?s=128&d=identicon&r=PG&f=1", "display_name": "William", "link": "https://stackoverflow.com/users/5042217/william"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 846, "favorite_count": 1, "accepted_answer_id": 31040870, "answer_count": 1, "score": 1, "last_activity_date": 1435243811, "creation_date": 1435164055, "last_edit_date": 1495535655, "question_id": 31032306, "link": "https://stackoverflow.com/questions/31032306/open-ms-access-form-or-report-in-same-location-as-when-last-closed", "title": "Open MS Access form or report in same location as when last closed", "body": "<p>I'm kind of a novice at Access and having some difficulty implementing something I saw in another post. <a href=\"https://stackoverflow.com/questions/3114224/ms-access-how-to-open-form-in-same-location-size-as-closed-previous-form\">MS-Access: How to open form in same location/size as closed/previous form?</a> </p>\n\n<p>I want to open my pop-up forms in the same location they were last closed in and I've created a table (sizpos) to store the 4 attributes for position and size (left, top, width, height) and the name of the form (object) and a unique id number.  </p>\n\n<p>I need some help figuring out the VBA code to store the attributes of the open form based on the form name on the close or unload event.  I also need help with the code to retrieve the information from the table for the opening form on the open or load event.  </p>\n\n<p>I tried making use of <code>dlookup</code> in <code>me.move</code> and did not have any success, but may not have been implementing it correctly.</p>\n\n<p>I came up with the following that almost works for the reports.  I just can't figure out how to pull the report's name from the report being opened similar to the <code>me.name</code> function in a form.  I've noted those areas with <code>me.reportname</code>???</p>\n\n<pre><code>Private Sub Report_Open(Cancel As Integer)\nDim l As Long\nDim t As Long\nl = Nz(DLookup(\"Left\", \"SizPos\", \"Object = 'me.reportname???'\"))\nt = Nz(DLookup(\"Top\", \"SizPos\", \"Object = 'me.reportname???'\"))\nMe.Move Left:=l, Top:=t\nEnd Sub\n\nPrivate Sub Report_Close()\nDim strSQL As String\nstrSQL = \"UPDATE SizPos SET SizPos.Left = \" &amp; Me.WindowLeft &amp; \", SizPos.Top = \" &amp; Me.WindowTop &amp; \" WHERE SizPos.Object = 'me.reportname???';\"\nCurrentDb.Execute strSQL\nEnd Sub\n</code></pre>\n\n<p>The below works great for the form.</p>\n\n<pre><code>Private Sub Form_Open(Cancel As Integer)\nDim l As Long\nDim t As Long\nDim w As Long\nDim h As Long\nl = Nz(DLookup(\"Left\", \"SizPos\", \"Object = '\" &amp; Me.Name &amp; \"'\"))\nt = Nz(DLookup(\"Top\", \"SizPos\", \"Object = '\" &amp; Me.Name &amp; \"'\"))\nw = Nz(DLookup(\"Width\", \"SizPos\", \"Object = '\" &amp; Me.Name &amp; \"'\"))\nh = Nz(DLookup(\"Height\", \"SizPos\", \"Object = '\" &amp; Me.Name &amp; \"'\"))\nMe.Move Left:=l, Top:=t, Width:=w, Height:=h\nEnd Sub\n\nPrivate Sub Form_Close()\nDoCmd.Save\nDim strSQL As String\nstrSQL = \"UPDATE SizPos SET SizPos.Left = \" &amp; Me.WindowLeft &amp; \", SizPos.Top = \" &amp; Me.WindowTop &amp; \", SizPos.Width = \" &amp; Me.WindowWidth &amp; \", SizPos.Height = \" &amp; Me.WindowHeight &amp; \" WHERE SizPos.Object = '\" &amp; Me.Name &amp; \"';\"\nCurrentDb.Execute strSQL\nEnd Sub\n</code></pre>\n"}, {"tags": ["ms-access", "vba", "ms-access-2010"], "comments": [{"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1435163953, "post_id": 31032147, "comment_id": 50088934, "body": "Yes, you can alter the <code>.Connect</code> property of a link to point to a different file.    But you need to know <i>which</i> file to target.  Have you worked out a method to identify which of the CSV files is the &quot;latest&quot;?"}, {"owner": {"reputation": 85, "user_id": 4793927, "user_type": "registered", "accept_rate": 70, "profile_image": "https://lh5.googleusercontent.com/-htfTTycgtcY/AAAAAAAAAAI/AAAAAAAADRE/AWfETYPt0yA/photo.jpg?sz=128", "display_name": "ChiHam", "link": "https://stackoverflow.com/users/4793927/chiham"}, "reply_to_user": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1435166672, "post_id": 31032147, "comment_id": 50090657, "body": "The latest file will be csat_survey_MM_DD_2015 or it can use the date modified of the file."}, {"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1435166871, "post_id": 31032147, "comment_id": 50090785, "body": "I meant have you created the VBA code to identify which CSV file is the latest?  Seems to me you need to do that first.  Then worry about modifying the link property."}, {"owner": {"reputation": 85, "user_id": 4793927, "user_type": "registered", "accept_rate": 70, "profile_image": "https://lh5.googleusercontent.com/-htfTTycgtcY/AAAAAAAAAAI/AAAAAAAADRE/AWfETYPt0yA/photo.jpg?sz=128", "display_name": "ChiHam", "link": "https://stackoverflow.com/users/4793927/chiham"}, "reply_to_user": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1435167010, "post_id": 31032147, "comment_id": 50090854, "body": "No, I did it manually, but I will research on that."}], "owner": {"reputation": 85, "user_id": 4793927, "user_type": "registered", "accept_rate": 70, "profile_image": "https://lh5.googleusercontent.com/-htfTTycgtcY/AAAAAAAAAAI/AAAAAAAADRE/AWfETYPt0yA/photo.jpg?sz=128", "display_name": "ChiHam", "link": "https://stackoverflow.com/users/4793927/chiham"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 121, "favorite_count": 1, "answer_count": 0, "score": 1, "last_activity_date": 1435163629, "creation_date": 1435163629, "question_id": 31032147, "link": "https://stackoverflow.com/questions/31032147/link-text-file-with-the-latest-date-stamp-to-ms-access", "title": "Link text file with the latest date stamp to MS Access", "body": "<p>I have a MS access which I have link a file called <strong>CSAT</strong>. Everyday I overwrite this file with the latest CSAT and run a query. I their a way to autmatically overwrite or Linked the file with the latest CSAT ?\nHere is a Printscreen of the CSAT Folder. Its a cvs file.\n<img src=\"https://i.stack.imgur.com/6D1LV.png\" alt=\"Files with name + date\"></p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 5436, "user_id": 1571997, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c560890eac8c4bdb30e8c4657570aaa?s=128&d=identicon&r=PG", "display_name": "chancea", "link": "https://stackoverflow.com/users/1571997/chancea"}, "edited": false, "score": 0, "creation_date": 1435164017, "post_id": 31032126, "comment_id": 50088978, "body": "You can also do <code>Cells(y, 2).Cut Destination:= Cells(x, 2)</code>"}, {"owner": {"reputation": 99, "user_id": 2850838, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/0923095d289c0c5397b134ff449d486d?s=128&d=identicon&r=PG&f=1", "display_name": "knt5784", "link": "https://stackoverflow.com/users/2850838/knt5784"}, "edited": false, "score": 0, "creation_date": 1435164309, "post_id": 31032126, "comment_id": 50089166, "body": "yeah, some time it shows the commands, most of the time it doesn&#39;t show anything although I&#39;m typing other commands right."}, {"owner": {"reputation": 5436, "user_id": 1571997, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c560890eac8c4bdb30e8c4657570aaa?s=128&d=identicon&r=PG", "display_name": "chancea", "link": "https://stackoverflow.com/users/1571997/chancea"}, "reply_to_user": {"reputation": 99, "user_id": 2850838, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/0923095d289c0c5397b134ff449d486d?s=128&d=identicon&r=PG&f=1", "display_name": "knt5784", "link": "https://stackoverflow.com/users/2850838/knt5784"}, "edited": false, "score": 0, "creation_date": 1435164712, "post_id": 31032126, "comment_id": 50089412, "body": "@knt5784 If you always <code>Dim</code> a variable and set it equal to lets say a <code>Range</code> or something then when you put a <code>.</code> after the value the method/property window will show."}], "tags": [], "owner": {"reputation": 1321, "user_id": 3506217, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/B1laD.jpg?s=128&g=1", "display_name": "Miss Palmer", "link": "https://stackoverflow.com/users/3506217/miss-palmer"}, "is_accepted": true, "score": 1, "last_activity_date": 1435163559, "creation_date": 1435163559, "answer_id": 31032126, "question_id": 31032060, "link": "https://stackoverflow.com/questions/31032060/excel-vba-delete-empty-cells-and-move-contents-up/31032126#31032126", "title": "Excel VBA delete empty cells and move contents up", "body": "<p><code>Cells(x, 2).Paste</code> isn't a valid command. use <code>Cells(x, 2).PasteSpecial</code></p>\n\n<p>try using intellisense to guide you to valid commands.</p>\n"}], "owner": {"reputation": 99, "user_id": 2850838, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/0923095d289c0c5397b134ff449d486d?s=128&d=identicon&r=PG&f=1", "display_name": "knt5784", "link": "https://stackoverflow.com/users/2850838/knt5784"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 116, "favorite_count": 0, "accepted_answer_id": 31032126, "answer_count": 1, "score": 0, "last_activity_date": 1435163559, "creation_date": 1435163376, "question_id": 31032060, "link": "https://stackoverflow.com/questions/31032060/excel-vba-delete-empty-cells-and-move-contents-up", "title": "Excel VBA delete empty cells and move contents up", "body": "<p>I have data like this:</p>\n\n<pre><code>     xxxxx\nxxxxx\n     xxxxx\nxxxxx\n     xxxxx\nxxxxx         \n     xxxxx\nxxxxx\n</code></pre>\n\n<p>I want to write a macro to go through each column from top to bottom, cut and paste the cells up. Here's my code working with the second column.</p>\n\n<pre><code>Dim x As Integer, y As Integer\nx = 1\nFor y = 1 To 75\n    If Cells(y, 2).Value &lt;&gt; \"\" Then\n         Cells(y, 2).Cut\n            Cells(x, 2).Paste\n            x = x + 1\n        End If\nNext y\n</code></pre>\n\n<p>Excel keeps telling me: \"Object doesn't support this property or method\" on the Cells(x, 2).Paste</p>\n\n<p>It doesn't run at all.\nDisregard the range of 75. I'm only have small data.</p>\n"}, {"tags": ["vba", "user-interface", "excel", "dynamic"], "answers": [{"comments": [{"owner": {"reputation": 297, "user_id": 4950454, "user_type": "registered", "accept_rate": 85, "profile_image": "https://lh5.googleusercontent.com/-lO-8slYBlj0/AAAAAAAAAAI/AAAAAAAAAbI/Ov3uCl89kmU/photo.jpg?sz=128", "display_name": "Dasman", "link": "https://stackoverflow.com/users/4950454/dasman"}, "edited": false, "score": 0, "creation_date": 1435165743, "post_id": 31032016, "comment_id": 50090061, "body": "This looks good! Quick question how can I insert a line after every entry or put every entry on its separate line?"}, {"owner": {"reputation": 297, "user_id": 4950454, "user_type": "registered", "accept_rate": 85, "profile_image": "https://lh5.googleusercontent.com/-lO-8slYBlj0/AAAAAAAAAAI/AAAAAAAAAbI/Ov3uCl89kmU/photo.jpg?sz=128", "display_name": "Dasman", "link": "https://stackoverflow.com/users/4950454/dasman"}, "edited": false, "score": 0, "creation_date": 1435168762, "post_id": 31032016, "comment_id": 50091957, "body": "Perfect. Last thing. I added a &quot;Add Another Line&quot; Button. It doesnt seem to work when I post the same item again. If I change the code it changes the line added but doesn&#39;t add to it. (I edited my question)"}, {"owner": {"reputation": 1321, "user_id": 3506217, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/B1laD.jpg?s=128&g=1", "display_name": "Miss Palmer", "link": "https://stackoverflow.com/users/3506217/miss-palmer"}, "reply_to_user": {"reputation": 297, "user_id": 4950454, "user_type": "registered", "accept_rate": 85, "profile_image": "https://lh5.googleusercontent.com/-lO-8slYBlj0/AAAAAAAAAAI/AAAAAAAAAbI/Ov3uCl89kmU/photo.jpg?sz=128", "display_name": "Dasman", "link": "https://stackoverflow.com/users/4950454/dasman"}, "edited": false, "score": 0, "creation_date": 1435169502, "post_id": 31032016, "comment_id": 50092354, "body": "i think it&#39;s because every time you click the button a new instance of the sub is created and the variable is local to one instance. try making myString a global variable (declared outside the sub)."}, {"owner": {"reputation": 297, "user_id": 4950454, "user_type": "registered", "accept_rate": 85, "profile_image": "https://lh5.googleusercontent.com/-lO-8slYBlj0/AAAAAAAAAAI/AAAAAAAAAbI/Ov3uCl89kmU/photo.jpg?sz=128", "display_name": "Dasman", "link": "https://stackoverflow.com/users/4950454/dasman"}, "edited": false, "score": 0, "creation_date": 1435596577, "post_id": 31032016, "comment_id": 50255179, "body": "Thanks that did it! Still learning VB so didn&#39;t even know about global variables. Also you have the name of a high school teacher of mine! lol So thanks!"}], "tags": [], "owner": {"reputation": 1321, "user_id": 3506217, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/B1laD.jpg?s=128&g=1", "display_name": "Miss Palmer", "link": "https://stackoverflow.com/users/3506217/miss-palmer"}, "is_accepted": true, "score": 2, "last_activity_date": 1435165970, "last_edit_date": 1435165970, "creation_date": 1435163262, "answer_id": 31032016, "question_id": 31031556, "link": "https://stackoverflow.com/questions/31031556/vba-excel-dynamically-display-added-results/31032016#31032016", "title": "VBA Excel Dynamically Display Added Results", "body": "<p>You can update a label on the form on each iteration of your while loop using something of the form:</p>\n\n<pre><code>FormName.LabelName.Caption = \"you have entered:\" &amp; myString\n</code></pre>\n\n<p>and then add to the string each loop with</p>\n\n<pre><code>myString  = myString &amp; First.Value + Second.Value + Third.Value + Fourth.Value + Fifth.Value\n</code></pre>\n\n<p>EDIT</p>\n\n<pre><code>myString  = myString &amp; chr(13) &amp; First.Value + Second.Value + Third.Value + Fourth.Value + Fifth.Value\n</code></pre>\n"}], "owner": {"reputation": 297, "user_id": 4950454, "user_type": "registered", "accept_rate": 85, "profile_image": "https://lh5.googleusercontent.com/-lO-8slYBlj0/AAAAAAAAAAI/AAAAAAAAAbI/Ov3uCl89kmU/photo.jpg?sz=128", "display_name": "Dasman", "link": "https://stackoverflow.com/users/4950454/dasman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 113, "favorite_count": 0, "accepted_answer_id": 31032016, "answer_count": 1, "score": 0, "last_activity_date": 1435169129, "creation_date": 1435161978, "last_edit_date": 1435169129, "question_id": 31031556, "link": "https://stackoverflow.com/questions/31031556/vba-excel-dynamically-display-added-results", "title": "VBA Excel Dynamically Display Added Results", "body": "<p>So I am modeling my question with a simple Grocery List applications.</p>\n\n<p><strong>Program GUI:</strong></p>\n\n<p><img src=\"https://i.stack.imgur.com/xgy6x.png\" alt=\"AddMore\"></p>\n\n<p>Now what I want is for the Customer to enter: Eggs, Milk, and Bread and for that to enter and output to a .txt file.</p>\n\n<p><strong>Current Code:</strong></p>\n\n<pre><code>Private Sub CreateList_Click()\n\nDim myFile As String, myString As String\nmyFile = \"C:\\Reformatted.txt\"\nOpen myFile For Output As #1\n\nmyString = First.Value + Second.Value + Third.Value + Fourth.Value + Fifth.Value\n\nPrint #1, myString\n\nClose #1\nShell \"C:\\Windows\\Notepad.exe C:\\Reformatted.txt\", 1\n\nEnd Sub\n</code></pre>\n\n<p><strong>Desired Operation:</strong></p>\n\n<p>What I want to happen is that ther enter there first 5 items. Then it prompts them if they want another 5. If they do then they can add another line.</p>\n\n<p>So I understand that I can add a MsgBox in VB and just design a while loop for that. My question is how to display the results of their first/previous submissions?</p>\n\n<p><strong>Desired Result:</strong></p>\n\n<p><img src=\"https://i.stack.imgur.com/oIjoq.png\" alt=\"DynamicDisplay\"></p>\n\n<p>I understand that VB stores the values as variables, but how can I show them to the user while they still have a chance to enter more entries. Also how to add all this with the preferred formatting to a notepad file?</p>\n\n<p>----------------------------After Miss Palmer's Answer--------------------------</p>\n\n<pre><code>Private Sub AddEntry_Click()\n\nDim UserEntry As String\n\nUserEntry = First.Value + DDPP.Value + Filer.Value + EntryNumber.Value\n\nmyString = myString &amp; Chr(13) &amp; UserEntry\n\nGroceryList.UserDisplay.Caption = \"You have entered:\" &amp; myString\n\nEnd Sub\n</code></pre>\n\n<p><strong>Scenario 1 - First Addition</strong></p>\n\n<p><img src=\"https://i.stack.imgur.com/FC7rx.png\" alt=\"Scenario1\"></p>\n\n<p><strong>Scenario 2 - Second Addition</strong></p>\n\n<p><img src=\"https://i.stack.imgur.com/fw8kI.png\" alt=\"Scenario2\"></p>\n\n<p>The two additions should be placed one after the other. But currently it just replaces it.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 13431, "user_id": 2169762, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Nns8w.png?s=128&g=1", "display_name": "Martin", "link": "https://stackoverflow.com/users/2169762/martin"}, "edited": false, "score": 0, "creation_date": 1435161931, "post_id": 31031471, "comment_id": 50087593, "body": "Wouldn&#39;t G6 acutally be <code>C7R</code> instead of <code>C8R</code>?"}, {"owner": {"reputation": 7422, "user_id": 1586390, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f07270207034d2bcbe347b028edc8f02?s=128&d=identicon&r=PG", "display_name": "Sorceri", "link": "https://stackoverflow.com/users/1586390/sorceri"}, "edited": false, "score": 1, "creation_date": 1435162355, "post_id": 31031471, "comment_id": 50087888, "body": "ActiveCell.Formula = &quot;=C&quot; &amp; NewRow &amp; &quot;*G&quot; &amp; NewRow"}, {"owner": {"reputation": 4434, "user_id": 138469, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/aogBK.jpg?s=128&g=1", "display_name": "Vincent De Smet", "link": "https://stackoverflow.com/users/138469/vincent-de-smet"}, "edited": false, "score": 0, "creation_date": 1435162390, "post_id": 31031471, "comment_id": 50087912, "body": "yeah, just wrote the same in my answer 41 secs ago :p"}, {"owner": {"reputation": 41, "user_id": 4337957, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh5.googleusercontent.com/-tQILNiNTxwA/AAAAAAAAAAI/AAAAAAAAAEY/cV4yWZFCyT4/photo.jpg?sz=128", "display_name": "joe bredestege", "link": "https://stackoverflow.com/users/4337957/joe-bredestege"}, "edited": false, "score": 0, "creation_date": 1435162981, "post_id": 31031471, "comment_id": 50088325, "body": "I really just don&#39;t understand why what I wrote didn&#39;t work. It makes so much more sense to do it that way though, thanks!"}], "answers": [{"tags": [], "owner": {"reputation": 4434, "user_id": 138469, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/aogBK.jpg?s=128&g=1", "display_name": "Vincent De Smet", "link": "https://stackoverflow.com/users/138469/vincent-de-smet"}, "is_accepted": true, "score": 1, "last_activity_date": 1435162305, "creation_date": 1435162305, "answer_id": 31031685, "question_id": 31031471, "link": "https://stackoverflow.com/questions/31031471/excel-vba-cell-referencing/31031685#31031685", "title": "Excel VBA cell referencing", "body": "<p>Write row first, column second - so to get the multiplication of <code>C</code> column and <code>G</code> column on same line as active cell, write: <code>ActiveCell.FormulaR1C1=\"=RC3*RC7\"</code></p>\n\n<p>But couldn't you just write <code>ActiveCell.Formula=\"=C\" &amp; NewRow &amp; \"*\" &amp; \"G\" &amp; NewRow</code>?</p>\n"}], "owner": {"reputation": 41, "user_id": 4337957, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh5.googleusercontent.com/-tQILNiNTxwA/AAAAAAAAAAI/AAAAAAAAAEY/cV4yWZFCyT4/photo.jpg?sz=128", "display_name": "joe bredestege", "link": "https://stackoverflow.com/users/4337957/joe-bredestege"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 82, "favorite_count": 0, "accepted_answer_id": 31031685, "answer_count": 1, "score": 0, "last_activity_date": 1435162305, "creation_date": 1435161762, "question_id": 31031471, "link": "https://stackoverflow.com/questions/31031471/excel-vba-cell-referencing", "title": "Excel VBA cell referencing", "body": "<p>I'm growing extremely frustrated with the following code:</p>\n\n<pre><code>Range(\"H\" &amp; LastRow + 1).Select\nNewRow = LastRow + 1\nActiveCell.FormulaR1C1 = \"=C3R\" &amp; NewRow &amp; \"*C8R\" &amp; NewRow\n</code></pre>\n\n<p>I keep getting errors on the last line, but I cannot for the life of me figure out what I'm doing wrong.</p>\n\n<p>All I need in the cell is: <code>=C6*G6</code></p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 208, "user_id": 3891582, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51448975dcaa6ad63dc094840d703b56?s=128&d=identicon&r=PG&f=1", "display_name": "cherry_bueno", "link": "https://stackoverflow.com/users/3891582/cherry-bueno"}, "edited": false, "score": 1, "creation_date": 1435162054, "post_id": 31031432, "comment_id": 50087678, "body": "Does using <code>Workbooks.Add</code> not provide the functionality you&#39;re looking for?"}, {"owner": {"reputation": 449, "user_id": 3005564, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/53941e4543e0c0daf2ec3b8e56361a6c?s=128&d=identicon&r=PG&f=1", "display_name": "Chase", "link": "https://stackoverflow.com/users/3005564/chase"}, "reply_to_user": {"reputation": 208, "user_id": 3891582, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51448975dcaa6ad63dc094840d703b56?s=128&d=identicon&r=PG&f=1", "display_name": "cherry_bueno", "link": "https://stackoverflow.com/users/3891582/cherry-bueno"}, "edited": false, "score": 0, "creation_date": 1435163364, "post_id": 31031432, "comment_id": 50088557, "body": "Cherry - you are correct, and in the same sense, Rory&#39;s answer also included this command. So thank you both!"}], "answers": [{"tags": [], "owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "is_accepted": true, "score": 3, "last_activity_date": 1435162021, "creation_date": 1435162021, "answer_id": 31031574, "question_id": 31031432, "link": "https://stackoverflow.com/questions/31031432/excel-vba-open-new-workbook-in-new-window/31031574#31031574", "title": "Excel/VBA: Open New Workbook In New Window", "body": "<p>You can use this:</p>\n\n<pre><code>Sub NewApp()\n    With CreateObject(\"Excel.Application\")\n        .Workbooks.Add\n        .Visible = True\n    End With\nEnd Sub\n</code></pre>\n\n<p>but be aware that any automation of this sort won't load startup workbooks and add-ins by default.</p>\n"}, {"comments": [{"owner": {"reputation": 449, "user_id": 3005564, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/53941e4543e0c0daf2ec3b8e56361a6c?s=128&d=identicon&r=PG&f=1", "display_name": "Chase", "link": "https://stackoverflow.com/users/3005564/chase"}, "edited": false, "score": 0, "creation_date": 1435163301, "post_id": 31031779, "comment_id": 50088523, "body": "This will definitely be useful to me (and others) as well, thank you much for this additional functionality"}], "tags": [], "owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "is_accepted": false, "score": 3, "last_activity_date": 1435162593, "creation_date": 1435162593, "answer_id": 31031779, "question_id": 31031432, "link": "https://stackoverflow.com/questions/31031432/excel-vba-open-new-workbook-in-new-window/31031779#31031779", "title": "Excel/VBA: Open New Workbook In New Window", "body": "<p>Alternate way to do the same thing, includes selecting the file you want to open:</p>\n\n<pre><code>Sub tgr()\n\n    Dim strFilePath As String\n    Dim xlApp As Object\n\n    strFilePath = Application.GetOpenFilename(\"Excel Files, *.xls*\")\n    If strFilePath = \"False\" Then Exit Sub  'Pressed cancel\n\n    Set xlApp = CreateObject(\"Excel.Application\")\n    xlApp.Visible = True\n    xlApp.Workbooks.Open strFilePath\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 449, "user_id": 3005564, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/53941e4543e0c0daf2ec3b8e56361a6c?s=128&d=identicon&r=PG&f=1", "display_name": "Chase", "link": "https://stackoverflow.com/users/3005564/chase"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 12359, "favorite_count": 1, "accepted_answer_id": 31031574, "answer_count": 2, "score": 3, "last_activity_date": 1523359726, "creation_date": 1435161674, "last_edit_date": 1435168958, "question_id": 31031432, "link": "https://stackoverflow.com/questions/31031432/excel-vba-open-new-workbook-in-new-window", "title": "Excel/VBA: Open New Workbook In New Window", "body": "<p>I am using Excel 2010, and am looking for a VBA script that will open a new workbook in a new window (such that I could, for example, place one workbook on each of 2 monitors).</p>\n\n<p>I'd then place this VBA/macro on the ribbon and assign it a shortcut key. Thus, it'd work like CTRL+N, but the new workbook would open in a separate window/instance of Excel, instead of the same.</p>\n\n<p>I've tried just using Shell (\"excel.exe\"), but I suppose since it is running from my PERSONAL.XLSB workbook, it then asks if I want to Read Only or Notify.</p>\n\n<p>I just want CTRL+N functionality, but with the new window addition.</p>\n\n<p>Thank you!</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 62, "user_id": 5000828, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/31d6ff99e31207c9a11021b863e24416?s=128&d=identicon&r=PG&f=1", "display_name": "User30923", "link": "https://stackoverflow.com/users/5000828/user30923"}, "is_accepted": true, "score": 1, "last_activity_date": 1435161165, "creation_date": 1435161165, "answer_id": 31031258, "question_id": 31031137, "link": "https://stackoverflow.com/questions/31031137/let-button-with-macro-work-in-any-excel-file-without-open-file-where-i-wrote-mac/31031258#31031258", "title": "Let button with macro work in any excel file without open file where I wrote macro", "body": "<p>In the workbook where you wrote the macro, try this:\nClick on the Windows Button on the upper left. Select Excel Options. Click Customize on the left side. On the drop-down on the top left, select \"Macros\". Click the Macro you want then move it over to the right side. Make sure the drop-down on the top right says \"For All Documents\". This should give you a button that will run the macro on any excel document.</p>\n"}], "owner": {"reputation": 644, "user_id": 2327481, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/073cd9b17f82ae4d64ea085f1dcf49c0?s=128&d=identicon&r=PG", "display_name": "Davagaz", "link": "https://stackoverflow.com/users/2327481/davagaz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 130, "favorite_count": 0, "accepted_answer_id": 31031258, "answer_count": 1, "score": 0, "last_activity_date": 1435168974, "creation_date": 1435160804, "last_edit_date": 1435168974, "question_id": 31031137, "link": "https://stackoverflow.com/questions/31031137/let-button-with-macro-work-in-any-excel-file-without-open-file-where-i-wrote-mac", "title": "Let button with macro work in any excel file without open file where I wrote macro", "body": "<p>I have a code, which help me to insert image in cell with some keyword, and set some print parameters. And every day I have many new files where I must do it.\nI make a button with macro on excel panel, but when I click it there open a file where I write macro in first time. What should I do to let it work without open old file?</p>\n\n<p>Here is the code:</p>\n\n<pre><code>Sub Macro2()\nWith ActiveSheet.PageSetup\n    .Zoom = False\n        .FitToPagesWide = 1\n    End With\n    Set ff = ActiveSheet.Cells.Find(\"forpicture\")\n    MyTop = [ff].Top\n    MyLeft = [ff].Left\n    InsertPicture \"C:\\Users\\Public\\222222.png\", _\n        Range(ff.Address), True, True\n        Dim f As Range\n    With ActiveSheet.PageSetup\n        .LeftMargin = Application.InchesToPoints(0.5)\n        .RightMargin = Application.InchesToPoints(0.2)\n        .TopMargin = Application.InchesToPoints(0.5)\n        .BottomMargin = Application.InchesToPoints(0.2)\n    End With\nEnd Sub\n\nSub InsertPicture(PictureFileName As String, TargetCell As Range, _\n    CenterH As Boolean, CenterV As Boolean)\n' inserts a picture at the top left position of TargetCell\n' the picture can be centered horizontally and/or vertically\nDim p As Object, t As Double, l As Double, w As Double, h As Double\n    If TypeName(ActiveSheet) &lt;&gt; \"Worksheet\" Then Exit Sub\n    If Dir(PictureFileName) = \"\" Then Exit Sub\n    ' import picture\n    Set p = ActiveSheet.Pictures.Insert(PictureFileName)\n    ' determine positions\n    With TargetCell\n        t = .Top\n        l = .Left\n    End With\n    ' position picture\n    With p\n        .Top = t\n        .Left = l\n        .Height = 150\n    End With\n    Set p = Nothing\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "charts", "label", "scatter"], "comments": [{"owner": {"reputation": 3845, "user_id": 4288101, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O0Xld.jpg?s=128&g=1", "display_name": "Byron Wall", "link": "https://stackoverflow.com/users/4288101/byron-wall"}, "edited": false, "score": 0, "creation_date": 1435162485, "post_id": 31030963, "comment_id": 50087984, "body": "You need to go one step further and iterate through the <code>Values</code> and <code>XValues</code> one by one.  That is, you cannot ask Excel to compare two arrays/ranges with a single operator: <code>XValues &gt; Values</code> will not work.  See very similar question on SU: <a href=\"http://superuser.com/questions/920162/hide-data-label-containing-series-name-if-value-is-zero/920246#920246\" title=\"hide data label containing series name if value is zero\">superuser.com/questions/920162/&hellip;</a>.  If you cannot get an answer from that question, update your code and I&#39;ll post an answer below.  If you get your own answer, add it below!"}, {"owner": {"reputation": 825, "user_id": 2696883, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/2ac1f30c3080424cb5b7bcdd65588103?s=128&d=identicon&r=PG&f=1", "display_name": "Nat Aes", "link": "https://stackoverflow.com/users/2696883/nat-aes"}, "reply_to_user": {"reputation": 3845, "user_id": 4288101, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O0Xld.jpg?s=128&g=1", "display_name": "Byron Wall", "link": "https://stackoverflow.com/users/4288101/byron-wall"}, "edited": false, "score": 0, "creation_date": 1435163625, "post_id": 31030963, "comment_id": 50088713, "body": "Thanks. I&#39;ve had a look at that and think I understand it. However surely working through the XValues and Values separately wouldn&#39;t result in what I am trying to achieve? If I set a number (e.g. XValues &gt; 10 and Values &gt; 10) then this wouldn&#39;t apply a label to any instance where XValue would be 20 but Value would be 5 (i.e. where XValues &gt; Values). Would I not need to compare both directly?"}, {"owner": {"reputation": 3845, "user_id": 4288101, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O0Xld.jpg?s=128&g=1", "display_name": "Byron Wall", "link": "https://stackoverflow.com/users/4288101/byron-wall"}, "edited": false, "score": 0, "creation_date": 1435163808, "post_id": 31030963, "comment_id": 50088834, "body": "Yes, compare them directly, but ultimately you will have a statement like <code>XValues(i) &gt; Values(i)</code> where you are going through the arrays &quot;one-by-one&quot;.  I just meant to say that you will have to iterate the arrays instead of trying to compare them as objects.  Hopefully that&#39;s less confusing. :)"}], "owner": {"reputation": 825, "user_id": 2696883, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/2ac1f30c3080424cb5b7bcdd65588103?s=128&d=identicon&r=PG&f=1", "display_name": "Nat Aes", "link": "https://stackoverflow.com/users/2696883/nat-aes"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 346, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1435160322, "creation_date": 1435160322, "question_id": 31030963, "link": "https://stackoverflow.com/questions/31030963/adding-scatter-chart-data-label-if-xvalue-value", "title": "Adding Scatter Chart Data Label If XValue &gt; Value", "body": "<p>I have a scatter plot with 100+ series and I'd like to add some data labels to those series where the horizontal value is greater than the vertical value - i.e. where XValue>Value. </p>\n\n<p>I use the following code to add data labels to all series:</p>\n\n<pre><code>Dim mySeries As Series\nDim seriesCol As SeriesCollection\nDim i As Integer\n\nSet seriesCol = ActiveSheet.ChartObjects(\"Chart 1\").Chart.SeriesCollection\n\nFor Each mySeries In seriesCol\n    Set mySeries = ActiveSheet.ChartObjects(\"Chart 1\").Chart.SeriesCollection(j)\n    With mySeries\n            .ApplyDataLabels\n            .DataLabels.ShowSeriesName = True\n            .DataLabels.ShowValue = False\n            .DataLabels.Font.Size = 6\n    End With\n    j = j + 1\nNext\n</code></pre>\n\n<p>I would assume I'd add an 'If' command prior to the 'With' command, along the following lines:</p>\n\n<pre><code>If ActiveSheet.ChartObjects(\"Chart 1\").Chart.SeriesCollection(j).XValues &gt; _\n    ActiveSheet.ChartObjects(\"Chart 1\").Chart.SeriesCollection(j).Values  Then\n</code></pre>\n\n<p>However this condition doesn't seem to work. I'd be grateful if you could point out where I've gone wrong...</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["excel", "vba", "date", "filter"], "comments": [{"owner": {"reputation": 8006, "user_id": 2753501, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0a5ac280a03c3a9d89488dc33f0ef075?s=128&d=identicon&r=PG&f=1", "display_name": "ZygD", "link": "https://stackoverflow.com/users/2753501/zygd"}, "edited": false, "score": 0, "creation_date": 1435181794, "post_id": 31030815, "comment_id": 50099071, "body": "Can you just clarify your question? It&#39;s not very clear what you exactly want after reading it."}, {"owner": {"reputation": 139, "user_id": 5024349, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f330d4945946ff8f309cfeb38e1d176a?s=128&d=identicon&r=PG&f=1", "display_name": "Alexandre Gentil", "link": "https://stackoverflow.com/users/5024349/alexandre-gentil"}, "reply_to_user": {"reputation": 8006, "user_id": 2753501, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0a5ac280a03c3a9d89488dc33f0ef075?s=128&d=identicon&r=PG&f=1", "display_name": "ZygD", "link": "https://stackoverflow.com/users/2753501/zygd"}, "edited": false, "score": 0, "creation_date": 1435184145, "post_id": 31030815, "comment_id": 50100088, "body": "Yeah I know it&#39;s hard to explain. I want to filter a sheet per date. But first I have to filter the year them the month and last the day. How do I do that. But with the input box get the parameter to filter, for example a date."}], "answers": [{"comments": [{"owner": {"reputation": 139, "user_id": 5024349, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f330d4945946ff8f309cfeb38e1d176a?s=128&d=identicon&r=PG&f=1", "display_name": "Alexandre Gentil", "link": "https://stackoverflow.com/users/5024349/alexandre-gentil"}, "edited": false, "score": 0, "creation_date": 1435163037, "post_id": 31031446, "comment_id": 50088371, "body": "My problem is filter dates in VBA, because it keep open checkBoxes and I don&#39;t know how to ckeck them with VBA"}], "tags": [], "owner": {"reputation": 71, "user_id": 4991636, "user_type": "registered", "profile_image": "https://graph.facebook.com/10206162866885933/picture?type=large", "display_name": "Tom37", "link": "https://stackoverflow.com/users/4991636/tom37"}, "is_accepted": true, "score": 0, "last_activity_date": 1435161698, "creation_date": 1435161698, "answer_id": 31031446, "question_id": 31030815, "link": "https://stackoverflow.com/questions/31030815/how-do-i-filter-with-date-in-vba/31031446#31031446", "title": "How do I filter with date In VBA", "body": "<p>This will change your date to the format you are looking for if i understand your problem correctly:</p>\n\n<pre><code>Format(DateValue(mes), \"yyyy-mm-dd\")\n</code></pre>\n"}], "owner": {"reputation": 139, "user_id": 5024349, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f330d4945946ff8f309cfeb38e1d176a?s=128&d=identicon&r=PG&f=1", "display_name": "Alexandre Gentil", "link": "https://stackoverflow.com/users/5024349/alexandre-gentil"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 733, "favorite_count": 0, "accepted_answer_id": 31031446, "answer_count": 1, "score": 0, "last_activity_date": 1435161698, "creation_date": 1435159912, "question_id": 31030815, "link": "https://stackoverflow.com/questions/31030815/how-do-i-filter-with-date-in-vba", "title": "How do I filter with date In VBA", "body": "<p>I have the following code, and I want the user to just set a date like \"22/06/2015\" \nand have that date go to a filter. The problem is that when I go to filter I have at first year,\n then I check a year, appears the months then the days. (I'm just showing a part of the code)</p>\n\n<pre><code>Sub PassaProRelatorio(planilha As Worksheet, nome As String)\nApplication.ScreenUpdating = False\nOn Error Resume Next\nActiveSheet.ShowAllData\nDim contaLinha As Integer\nDim array1 As Variant\nDim mes As String\nmes = InputBox(\"Digite at\u00e9 a data que deseja EX: 27/02/2015\")\narray1 = Array(1, mes)\nSheets(\"BasePenhoras\").Activate\nActiveSheet.Range(\"$A$1:$DO$80000\").AutoFilter Field:=10, Criteria1:=nome\nActiveSheet.Range(\"$A$1:$DO$80000\").AutoFilter Field:=11, Criteria1:= _\n    \"Conclu\u00eddo\"\nActiveSheet.Range(\"$A$1:$DO$80000\").AutoFilter Field:=72, Criteria1:= _\n    \"Bloqueio\"\nActiveSheet.Range(\"$A$1:$DO$80000\").AutoFilter Field:=5, Operator:= _\nxlFilterValues, Criteria2:=array1here\n</code></pre>\n"}, {"tags": ["vba", "file", "path", "powerpoint", "show"], "comments": [{"owner": {"reputation": 12482, "user_id": 1667023, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JXaUt.png?s=128&g=1", "display_name": "Steve Rindsberg", "link": "https://stackoverflow.com/users/1667023/steve-rindsberg"}, "edited": false, "score": 0, "creation_date": 1435247202, "post_id": 31030529, "comment_id": 50131261, "body": "Questions/Suggestions: Is this code supposed to be running from within an existing, running slide presentation or from within another application?   Use &amp; instead of + for string concatenation or VB will bite you eventually.  Are you trying to save a macro-enabled presentation as a file with a .PPTX extension?  That won&#39;t work either.  PPTM or PPSM"}, {"owner": {"reputation": 1, "user_id": 5034461, "user_type": "registered", "profile_image": "https://graph.facebook.com/989630287748447/picture?type=large", "display_name": "Dustin Hall", "link": "https://stackoverflow.com/users/5034461/dustin-hall"}, "reply_to_user": {"reputation": 12482, "user_id": 1667023, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JXaUt.png?s=128&g=1", "display_name": "Steve Rindsberg", "link": "https://stackoverflow.com/users/1667023/steve-rindsberg"}, "edited": false, "score": 0, "creation_date": 1435264385, "post_id": 31030529, "comment_id": 50141055, "body": "Hi Steve, thanks for the reply. Thank you for the tip on the &amp; instead of +.  I&#39;m not trying to save the file in the code, I&#39;m just working on it as a presentation, then I save it as a macro-enabled show, and I get the error above (because the show path goes into &quot;C:...Microsoft Office\\Excel&quot;  instead of where the saved macro-enabled show was started from (which I&#39;d like to overwrite)."}, {"owner": {"reputation": 12482, "user_id": 1667023, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JXaUt.png?s=128&g=1", "display_name": "Steve Rindsberg", "link": "https://stackoverflow.com/users/1667023/steve-rindsberg"}, "edited": false, "score": 0, "creation_date": 1435330616, "post_id": 31030529, "comment_id": 50171151, "body": "It might be a good idea to post a bit more of the code ahead of the point where the error occurs, then."}, {"owner": {"reputation": 1, "user_id": 5034461, "user_type": "registered", "profile_image": "https://graph.facebook.com/989630287748447/picture?type=large", "display_name": "Dustin Hall", "link": "https://stackoverflow.com/users/5034461/dustin-hall"}, "reply_to_user": {"reputation": 12482, "user_id": 1667023, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JXaUt.png?s=128&g=1", "display_name": "Steve Rindsberg", "link": "https://stackoverflow.com/users/1667023/steve-rindsberg"}, "edited": false, "score": 0, "creation_date": 1435359993, "post_id": 31030529, "comment_id": 50184836, "body": "That is the code unfortunately. It works when  presentation is open, but not macro-show without presentation. If you&#39;ve powerpoint, open a new presentation and use the activepresentation.path to show the path in a msgbox. It will work fine. Then save as a macro-enabled show and it won&#39;t work. I&#39;m trying to get around that."}, {"owner": {"reputation": 12482, "user_id": 1667023, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JXaUt.png?s=128&g=1", "display_name": "Steve Rindsberg", "link": "https://stackoverflow.com/users/1667023/steve-rindsberg"}, "edited": false, "score": 0, "creation_date": 1435423460, "post_id": 31030529, "comment_id": 50198697, "body": "See newly posted answer."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 5034461, "user_type": "registered", "profile_image": "https://graph.facebook.com/989630287748447/picture?type=large", "display_name": "Dustin Hall", "link": "https://stackoverflow.com/users/5034461/dustin-hall"}, "edited": false, "score": 0, "creation_date": 1435519233, "post_id": 31091067, "comment_id": 50222696, "body": "Steve, that worked wonderfully. So that I can better understand, oPPRFile, oPPTShape, and oPPTSlide are just &quot;waking up&quot; a presentation?  I&#39;m just curious to know how that fixed the problem :) Thank you so much!   P.S. It says I don&#39;t have enough reputation points to mark this as correct :/"}, {"owner": {"reputation": 12482, "user_id": 1667023, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JXaUt.png?s=128&g=1", "display_name": "Steve Rindsberg", "link": "https://stackoverflow.com/users/1667023/steve-rindsberg"}, "reply_to_user": {"reputation": 1, "user_id": 5034461, "user_type": "registered", "profile_image": "https://graph.facebook.com/989630287748447/picture?type=large", "display_name": "Dustin Hall", "link": "https://stackoverflow.com/users/5034461/dustin-hall"}, "edited": false, "score": 0, "creation_date": 1435548004, "post_id": 31091067, "comment_id": 50229193, "body": "oPPRFile, oPPTShape etc are object variables that hold references to a presentation, placeholder format and slide respectively.  As long as you&#39;re using them from within PPT itself, there&#39;s no need to start with a reference to the PPT application, since it&#39;s implicit.  To be honest, I can&#39;t say why it wouldn&#39;t have worked before.  Odd, isn&#39;t it?"}], "tags": [], "owner": {"reputation": 12482, "user_id": 1667023, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JXaUt.png?s=128&g=1", "display_name": "Steve Rindsberg", "link": "https://stackoverflow.com/users/1667023/steve-rindsberg"}, "is_accepted": false, "score": 0, "last_activity_date": 1435423436, "creation_date": 1435423436, "answer_id": 31091067, "question_id": 31030529, "link": "https://stackoverflow.com/questions/31030529/ppt-macro-enabled-show-path/31091067#31091067", "title": ".PPT macro-enabled show path", "body": "<p>Since you haven't answered my question about where the code is running FROM, I'm going to assume that it's from within PPT and that there are no other applications involved.  That being the case, this works fine, either from a PPTM or PPSM:</p>\n\n<pre><code>Sub MittedForYourApproval()\n\n' if the code is running within PPT, you don't need to do it this way:\n' PPT has a reference to itself.\n'Dim oPPTApp As PowerPoint.Application\n'Dim oPPRFile As PowerPoint.Presentation\n'Dim oPPTShape As PowerPoint.PlaceholderFormat\n'Dim oPPTSlide As PowerPoint.Slide\n\nDim oPPRFile As Presentation\n' I don't know where you're going with this\n' but PlaceholderFormat &lt;&gt; a shape\nDim oPPTShape As PlaceholderFormat\nDim oPPTSlide As Slide\n\n'Set oPPTApp = CreateObject(\"PowerPoint.Application\")\n'oPPTApp.Visible = msoTrue\n\n'opening an existing presentation\n\nDim spath2 As String\nDim strpath2 As String\nspath2 = ActivePresentation.Path '&lt;--\n'strpath2 = spath2 + \"\\Resources\\AIT Diplomas\\AIT Diplomas.pptx\"\nMsgBox spath2\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 5034461, "user_type": "registered", "profile_image": "https://graph.facebook.com/989630287748447/picture?type=large", "display_name": "Dustin Hall", "link": "https://stackoverflow.com/users/5034461/dustin-hall"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 330, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1435423436, "creation_date": 1435159171, "question_id": 31030529, "link": "https://stackoverflow.com/questions/31030529/ppt-macro-enabled-show-path", "title": ".PPT macro-enabled show path", "body": "<p>I am trying to save a presentation as a macro-enabled show in PowerPoint, and I'm running into a problem when I do. This code that I'm using <strong>works great when I'm save as a macro-enabled presentation - but not as a macro-enabled show</strong>:</p>\n\n<pre><code>Dim oPPTApp As PowerPoint.Application\nDim oPPRFile As PowerPoint.Presentation\nDim oPPTShape As PowerPoint.PlaceholderFormat\nDim oPPTSlide As PowerPoint.Slide\n\nSet oPPTApp = CreateObject(\"PowerPoint.Application\")\noPPTApp.Visible = msoTrue\n\n'opening an existing presentation\n\nDim spath2 As String\nDim strpath2 As String\nspath2 = ActivePresentation.Path &lt;--\nstrpath2 = spath2 + \"\\Resources\\AIT Diplomas\\AIT Diplomas.pptx\"\n</code></pre>\n\n<p>The problem is that when I save it as a macro-enabled show and try to run it, it stops at the &lt;--- line of code because there \"is no active presentation. When you save powerpoint as a macro-enabled show, then no \"presentation\" (powerpoint window) opens, just the slideshow window. </p>\n\n<p>I need a way of finding the active show path that doesn't reference an activepresentation, which doesn't exist. </p>\n\n<p>Thank you for your time!</p>\n\n<p>Respectfully, Dustin</p>\n"}, {"tags": ["vba", "error-handling"], "comments": [{"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 2, "creation_date": 1435159989, "post_id": 31030519, "comment_id": 50086207, "body": "possible duplicate of <a href=\"http://stackoverflow.com/questions/28413919/excel-vba-not-properly-breaking-on-error\">Excel VBA not properly breaking on error</a>"}, {"owner": {"reputation": 2324, "user_id": 5094258, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/n4upu.png?s=128&g=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/5094258/tim"}, "edited": false, "score": 1, "creation_date": 1448298971, "post_id": 31030519, "comment_id": 55517176, "body": "Had to give you a kudos because I just had this same issue. The other post may be similar, but this post was far more helpful."}], "answers": [{"tags": [], "owner": {"reputation": 1512, "user_id": 2936675, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/886c2f804bb37c2dbd5d92fb5b3344ce?s=128&d=identicon&r=PG&f=1", "display_name": "nwhaught", "link": "https://stackoverflow.com/users/2936675/nwhaught"}, "is_accepted": true, "score": 2, "last_activity_date": 1448314078, "last_edit_date": 1495539880, "creation_date": 1448314078, "answer_id": 33881041, "question_id": 31030519, "link": "https://stackoverflow.com/questions/31030519/vba-on-error-not-catching-errors/33881041#33881041", "title": "VBA On Error not catching errors", "body": "<p>It turned out that in the VBA editor, under </p>\n\n<p>Tools>>Options>>General>>Error Trapping </p>\n\n<p>I had \"Break on All Errors\" selected, which overrides any instruction in the code to GoTo or Resume on the error. Changing the selection to \"Break on Unhandled Errors\" resolved my issue. </p>\n\n<p>Source for answer: <a href=\"https://stackoverflow.com/questions/28413919/excel-vba-not-properly-breaking-on-error\">Five tips for handling errors in VBA</a></p>\n"}], "owner": {"reputation": 1512, "user_id": 2936675, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/886c2f804bb37c2dbd5d92fb5b3344ce?s=128&d=identicon&r=PG&f=1", "display_name": "nwhaught", "link": "https://stackoverflow.com/users/2936675/nwhaught"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1150, "favorite_count": 0, "accepted_answer_id": 33881041, "answer_count": 1, "score": 2, "last_activity_date": 1448314141, "creation_date": 1435159145, "last_edit_date": 1495541713, "question_id": 31030519, "link": "https://stackoverflow.com/questions/31030519/vba-on-error-not-catching-errors", "title": "VBA On Error not catching errors", "body": "<p>Posting this here, in case it can help others. I was seeing some strange behavior where:</p>\n\n<pre><code>Sub somesub()\nOn Error GoTo Handler\n    Dim x\n    x = 1/0\n    MsgBox(\"Done\")\n    Exit Sub\nHandler:\n    MsgBox(\"Error was handled\")\nEnd Sub\n</code></pre>\n\n<p>Was not catching the error. </p>\n\n<p>There is a related question on SO already, at: <a href=\"https://stackoverflow.com/questions/28413919/excel-vba-not-properly-breaking-on-error\">Excel VBA Not Properly Breaking on Error</a>, but it is asking about how to mitigate side effects of making one choice or another in the Error Trapping settings. This is asking why the error handling is not working <em>at all</em>.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 61, "user_id": 4233396, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/f5f753524e11d457bebfb40e5def274d?s=128&d=identicon&r=PG&f=1", "display_name": "Max H", "link": "https://stackoverflow.com/users/4233396/max-h"}, "edited": false, "score": 0, "creation_date": 1435159547, "post_id": 31030492, "comment_id": 50085861, "body": "test comment, just to make sure this post didnt get deleted.."}, {"owner": {"reputation": 5002, "user_id": 2559297, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/lxuup.jpg?s=128&g=1", "display_name": "D_Bester", "link": "https://stackoverflow.com/users/2559297/d-bester"}, "edited": false, "score": 1, "creation_date": 1435159927, "post_id": 31030492, "comment_id": 50086160, "body": "<code>Range(&quot;R32&quot;).Value = Application.WorksheetFunction.Sum(Range(userResponse))</code> will give you an error when <code>userResponse</code> is nothing. You need to put it inside the if statement testing for nothingness."}], "answers": [{"comments": [{"owner": {"reputation": 61, "user_id": 4233396, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/f5f753524e11d457bebfb40e5def274d?s=128&d=identicon&r=PG&f=1", "display_name": "Max H", "link": "https://stackoverflow.com/users/4233396/max-h"}, "edited": false, "score": 0, "creation_date": 1435159708, "post_id": 31030702, "comment_id": 50085999, "body": "Thought I tried that already, but just put it in and it works! Thank you, will give you the check mark once it lets me (5 min delay...)"}, {"owner": {"reputation": 1238, "user_id": 2391294, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8af32502212174717014d4867e8bda3?s=128&d=identicon&r=PG", "display_name": "Arin", "link": "https://stackoverflow.com/users/2391294/arin"}, "reply_to_user": {"reputation": 61, "user_id": 4233396, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/f5f753524e11d457bebfb40e5def274d?s=128&d=identicon&r=PG&f=1", "display_name": "Max H", "link": "https://stackoverflow.com/users/4233396/max-h"}, "edited": false, "score": 1, "creation_date": 1435159874, "post_id": 31030702, "comment_id": 50086124, "body": "@MaxH, I&#39;d have you try Martin Parkin&#39;s solution instead, as mine contains redundant code (getting the address from the range and then the range from that address). His is cleaner!"}], "tags": [], "owner": {"reputation": 1238, "user_id": 2391294, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8af32502212174717014d4867e8bda3?s=128&d=identicon&r=PG", "display_name": "Arin", "link": "https://stackoverflow.com/users/2391294/arin"}, "is_accepted": false, "score": 2, "last_activity_date": 1435159604, "creation_date": 1435159604, "answer_id": 31030702, "question_id": 31030492, "link": "https://stackoverflow.com/questions/31030492/a-sum-function-in-vba-with-a-range-parameter/31030702#31030702", "title": "A SUM function in VBA with a Range parameter", "body": "<p>What if you added <code>.Address</code> inside the <code>Range()</code> at the bottom, like so:</p>\n\n<pre><code>Range(\"R32\").Value = Application.WorksheetFunction.Sum(Range(userResponse.Address))\n</code></pre>\n\n<p>Would that do what you're looking for?</p>\n"}, {"comments": [{"owner": {"reputation": 1238, "user_id": 2391294, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8af32502212174717014d4867e8bda3?s=128&d=identicon&r=PG", "display_name": "Arin", "link": "https://stackoverflow.com/users/2391294/arin"}, "edited": false, "score": 0, "creation_date": 1435159736, "post_id": 31030736, "comment_id": 50086012, "body": "I upvoted this because I believe it&#39;s better than my answer. :-)"}, {"owner": {"reputation": 61, "user_id": 4233396, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/f5f753524e11d457bebfb40e5def274d?s=128&d=identicon&r=PG&f=1", "display_name": "Max H", "link": "https://stackoverflow.com/users/4233396/max-h"}, "edited": false, "score": 1, "creation_date": 1435160899, "post_id": 31030736, "comment_id": 50086879, "body": "Thanks, this works as well! Gave it the green checkmark and upvote"}], "tags": [], "owner": {"reputation": 13431, "user_id": 2169762, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Nns8w.png?s=128&g=1", "display_name": "Martin", "link": "https://stackoverflow.com/users/2169762/martin"}, "is_accepted": true, "score": 4, "last_activity_date": 1435159676, "creation_date": 1435159676, "answer_id": 31030736, "question_id": 31030492, "link": "https://stackoverflow.com/questions/31030492/a-sum-function-in-vba-with-a-range-parameter/31030736#31030736", "title": "A SUM function in VBA with a Range parameter", "body": "<p>The problem here is that you are using <code>Range(userResponse)</code> for your <code>Sum</code> function.</p>\n\n<p>The variable <code>userResponse</code> is already a <code>Range</code>, you don't need to specify it as one again.</p>\n\n<p>Try this line of code and you will find it works as expected:</p>\n\n<pre><code>Range(\"R32\").Value = Application.WorksheetFunction.Sum(userResponse)\n</code></pre>\n"}], "owner": {"reputation": 61, "user_id": 4233396, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/f5f753524e11d457bebfb40e5def274d?s=128&d=identicon&r=PG&f=1", "display_name": "Max H", "link": "https://stackoverflow.com/users/4233396/max-h"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1018, "favorite_count": 0, "accepted_answer_id": 31030736, "answer_count": 2, "score": 0, "last_activity_date": 1435160548, "creation_date": 1435159083, "last_edit_date": 1435160548, "question_id": 31030492, "link": "https://stackoverflow.com/questions/31030492/a-sum-function-in-vba-with-a-range-parameter", "title": "A SUM function in VBA with a Range parameter", "body": "<p>I am trying to write a macro in VBA for excel that allows a user to input a range of cells. Then, I want the macro to sum up all of the cells, and input them into cell R32.</p>\n\n<p>I have attached the code that I wrote for it so far. When I run the macro, I am allowed to select my range of cells.</p>\n\n<p>However, I then receive the error message, <code>run time error 1004- method range of object _Worksheet failed</code>. This seems like something that could be a quick fix... But I am very stuck. Any help would be greatly appreciated.</p>\n\n<pre><code>Private Sub CommandButton5_Click()\n    Dim userResponse As Range\n    On Error Resume Next\n\n    Set userResponse = Application.InputBox(\"select a range with the mouse\",Default:=Selection.Address, Type:=8)\n    On Error GoTo 0\n\n    If userResponse Is Nothing Then\n        MsgBox \"Cancel clicked\"\n    Else\n        MsgBox \"You selected \" &amp; userResponse.Address\n    End If\n\n    Range(\"R32\").Value = Application.WorksheetFunction.Sum(Range(userResponse))\nEnd Sub\n</code></pre>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 0, "creation_date": 1435159330, "post_id": 31030445, "comment_id": 50085691, "body": "I got the same problem some times ago, but I didn&#39;t look for a work around... In my opinion a &quot;simple&quot; split/loop should do the trick! ;)"}, {"owner": {"reputation": 475, "user_id": 5045189, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/1df4ba32255405d1d48b9f73fe3a6cdc?s=128&d=identicon&r=PG&f=1", "display_name": "Joseph Kreifels II", "link": "https://stackoverflow.com/users/5045189/joseph-kreifels-ii"}, "reply_to_user": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 1, "creation_date": 1435161899, "post_id": 31030445, "comment_id": 50087564, "body": "It doesn&#39;t work because it&#39;s looking for the very last directory &quot;6.24.2015&quot;, It can&#39;t fint it if the month directory don&#39;t exist, also if the output directory doesn&#39;t exist... And your right, I didnt need the extra &quot;\\&quot;"}, {"owner": {"reputation": 475, "user_id": 5045189, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/1df4ba32255405d1d48b9f73fe3a6cdc?s=128&d=identicon&r=PG&f=1", "display_name": "Joseph Kreifels II", "link": "https://stackoverflow.com/users/5045189/joseph-kreifels-ii"}, "edited": false, "score": 0, "creation_date": 1435162492, "post_id": 31030445, "comment_id": 50087991, "body": "I was trying to do it in one go. Because If I deploy this back to the people in Meijing, I want it to create the directories, because I know they won&#39;t have them to start with"}], "answers": [{"tags": [], "owner": {"reputation": 475, "user_id": 5045189, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/1df4ba32255405d1d48b9f73fe3a6cdc?s=128&d=identicon&r=PG&f=1", "display_name": "Joseph Kreifels II", "link": "https://stackoverflow.com/users/5045189/joseph-kreifels-ii"}, "is_accepted": false, "score": 1, "last_activity_date": 1435162061, "creation_date": 1435162061, "answer_id": 31031588, "question_id": 31030445, "link": "https://stackoverflow.com/questions/31030445/making-directories-and-sub-directories-vba/31031588#31031588", "title": "Making Directories and sub-directories - VBA", "body": "<p>I have finally solved it, I did in fact have to manually check each directory. I used a loop and array though to make it seem simple</p>\n\n<pre><code>strOutPut(0) = CurrentProject.Path &amp; \"\\MeijingOutput\\\"\nstrOutPut(1) = strOutPut(0) &amp; MonthName(Month(Date)) &amp; \"_\" &amp; DatePart(\"YYYY\", Date) &amp; \"\\\"\nstrOutPut(2) = strOutPut(1) &amp; DatePart(\"m\", Date) &amp; \".\" &amp; DatePart(\"d\", Date) &amp; \".\" &amp; DatePart(\"yyyy\", Date)\nstrOutPath = strOutPut(2)\n</code></pre>\n\n<p>And the main attraction</p>\n\n<pre><code> For i = 0 To 2\n   If Len(Dir(strOutPut(i), vbDirectory)) = 0 Then ' make the folder if it doesnt exist\n    MkDir strOutPut(i)\n   End If\n Next i\n</code></pre>\n"}], "owner": {"reputation": 475, "user_id": 5045189, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/1df4ba32255405d1d48b9f73fe3a6cdc?s=128&d=identicon&r=PG&f=1", "display_name": "Joseph Kreifels II", "link": "https://stackoverflow.com/users/5045189/joseph-kreifels-ii"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 123, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1594644255, "creation_date": 1435158985, "last_edit_date": 1594644255, "question_id": 31030445, "link": "https://stackoverflow.com/questions/31030445/making-directories-and-sub-directories-vba", "title": "Making Directories and sub-directories - VBA", "body": "<p>I'm writing a script in Access 2013 for work, I'm kinda of a neat freak with computers so I want to be able to output the data to a organized archive so over the years it will be, well, organized.</p>\n\n<p>I know how to create a simple directory, but I want to create directories within directories.</p>\n\n<p>This is my variable I have written for the path</p>\n\n<pre><code>strOutPath = CurrentProject.Path &amp; \"\\MeijingOutput\\\" &amp; MonthName(Month(Date)) &amp; _\n\"_\" &amp; DatePart(\"YYYY\", Date) &amp; \"\\\" &amp; DatePart(\"m\", Date) &amp; \".\" &amp; DatePart(\"d\", Date) &amp; \".\" &amp; DatePart(\"yyyy\", Date) &amp; \"\\\"\n</code></pre>\n\n<p>this comes out to be <code>C:\\Users\\[user]\\Documents\\MeijingOutput\\June_2015\\6.24.2015\\</code></p>\n\n<p>Before, I was just outputting them all to the same folder \"MeijingOutPut\", and it worked since I was just making a new top level directory.</p>\n\n<p>Is there a way I can get this code to work without having to manually check for each sub directory?</p>\n\n<pre><code>If Len(Dir(strOutPath, vbDirectory)) = 0 Then ' make the folder if it doesnt exist\nMkDir strOutPath\nEnd If\n</code></pre>\n"}, {"tags": ["vba", "excel", "ms-word", "powerpoint"], "comments": [{"owner": {"reputation": 176, "user_id": 4044346, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0f147f8766920927c8692df420c250f8?s=128&d=identicon&r=PG&f=1", "display_name": "hypetech", "link": "https://stackoverflow.com/users/4044346/hypetech"}, "edited": false, "score": 1, "creation_date": 1435159125, "post_id": 31030322, "comment_id": 50085537, "body": "I think your  question is fine up to the third paragraph, the fourth and fifth paragraphs have valid questions but because it&#39;s becoming more opinion based the community usually doesn&#39;t approve.  Personally I feel Excel seems like an easier choice."}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1435159660, "post_id": 31030322, "comment_id": 50085965, "body": "I upvoted it since it is actually a fairly well-composed question. Furthermore -- the superiority of Excel for the quiz is objective rather than opinion based since Excel natively includes functions useful for scoring a quiz."}, {"owner": {"reputation": 161, "user_id": 4338938, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/he6mC.png?s=128&g=1", "display_name": "Valhalla_33", "link": "https://stackoverflow.com/users/4338938/valhalla-33"}, "reply_to_user": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1435159888, "post_id": 31030322, "comment_id": 50086133, "body": "@John. Thanks for adding the Word-VBA and the upvote. I typed in Word and  that never showed up as a tag so wasn&#39;t sure it existed. I&#39;ve done a lot of forms in Excel so I was kind of leading that way ever so slightly."}, {"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 1, "creation_date": 1435159960, "post_id": 31030322, "comment_id": 50086189, "body": "<a href=\"http://programmers.stackexchange.com/\">Programmers.SE</a> - <code>Programmers Stack Exchange is a question and answer site for professional programmers interested in conceptual questions about software development</code> might be a good location for the question, though I will neither downvote nor VTC here."}, {"owner": {"reputation": 161, "user_id": 4338938, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/he6mC.png?s=128&g=1", "display_name": "Valhalla_33", "link": "https://stackoverflow.com/users/4338938/valhalla-33"}, "reply_to_user": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 0, "creation_date": 1435160198, "post_id": 31030322, "comment_id": 50086347, "body": "@FreeMan.  I was thinking that  too but I am SOOOO far from a professional programmer. &quot;Dabbler&quot; is more like it."}, {"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 0, "creation_date": 1435160266, "post_id": 31030322, "comment_id": 50086391, "body": "Haven&#39;t posted there myself, but <code>professional</code> shouldn&#39;t matter that much. I dunno - maybe it&#39;s a real Ivory Tower crowd over there..."}, {"owner": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "reply_to_user": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 1, "creation_date": 1435160352, "post_id": 31030322, "comment_id": 50086462, "body": "No, this is not an appropriate question for <a href=\"https://softwareengineering.stackexchange.com\">Software Engineering</a>, and asking it there will generate quite a bit of anger. @Freeman: If you&#39;re not <i>certain</i> that the site fits elsewhere, don&#39;t recommend posting there.  The people at Programmers get extremely angry when SO users migrate off-topic questions there."}, {"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "reply_to_user": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 1, "creation_date": 1435160420, "post_id": 31030322, "comment_id": 50086520, "body": "@KenWhite - cool. I did say <i>might</i>, though I didn&#39;t emphasize it..."}, {"owner": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 1, "creation_date": 1435160434, "post_id": 31030322, "comment_id": 50086527, "body": "This question is extremely borderline as off-topic because it&#39;s both asking for a software recommendation and it&#39;s extremely opinion-based (either of which makes it inappropriate here)."}, {"owner": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "reply_to_user": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 1, "creation_date": 1435160489, "post_id": 31030322, "comment_id": 50086563, "body": "@Freeman: You should visit Programmers yourself and read the guidelines in the help center there. :-)"}, {"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "reply_to_user": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 1, "creation_date": 1435160646, "post_id": 31030322, "comment_id": 50086682, "body": "@KenWhite &quot;If you have a question about... software architecture and design,  algorithm and data structure concepts&quot; Seems to me to be a fit, but what do I know... ;) End of discussion before we get the &quot;take it to chat&quot; nasty-gram!  :)"}, {"owner": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "reply_to_user": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 1, "creation_date": 1435160731, "post_id": 31030322, "comment_id": 50086761, "body": "@Freeman: This isn&#39;t <i>software architecture</i>. It&#39;s a software <i>recommendation</i> (Word or Excel) question. It&#39;s not even a close call."}, {"owner": {"reputation": 841, "user_id": 3633799, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bf3c5795e0c55e5c31ed7fa75abc8da5?s=128&d=identicon&r=PG&f=1", "display_name": "Jane", "link": "https://stackoverflow.com/users/3633799/jane"}, "edited": false, "score": 1, "creation_date": 1435161012, "post_id": 31030322, "comment_id": 50086949, "body": "If you decide that you want to use Word VBA, then there is a Protect Method for a Word Document Object. See the MSDN documentation at <a href=\"https://msdn.microsoft.com/en-us/library/office/aa220366(v=office.11).aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/office/&hellip;</a>. If you use WdProtectionType of wdAllowOnlyReading, then users will not be able to make more edits to the document."}, {"owner": {"reputation": 161, "user_id": 4338938, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/he6mC.png?s=128&g=1", "display_name": "Valhalla_33", "link": "https://stackoverflow.com/users/4338938/valhalla-33"}, "reply_to_user": {"reputation": 841, "user_id": 3633799, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bf3c5795e0c55e5c31ed7fa75abc8da5?s=128&d=identicon&r=PG&f=1", "display_name": "Jane", "link": "https://stackoverflow.com/users/3633799/jane"}, "edited": false, "score": 0, "creation_date": 1435163318, "post_id": 31030322, "comment_id": 50088534, "body": "@Jane.  Thanks. That&#39;s the kind of input I really need. Didn&#39;t know that even existed."}, {"owner": {"reputation": 885, "user_id": 1676288, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/00186351b531d40caafac61aeeb2946a?s=128&d=identicon&r=PG", "display_name": "Mark Butler", "link": "https://stackoverflow.com/users/1676288/mark-butler"}, "edited": false, "score": 1, "creation_date": 1435684440, "post_id": 31030322, "comment_id": 50299241, "body": "Is Access an option? I&#39;ve had reasonable success creating quizzes in Access. It&#39;s also easy to lock down so it&#39;s tamper-proof."}, {"owner": {"reputation": 161, "user_id": 4338938, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/he6mC.png?s=128&g=1", "display_name": "Valhalla_33", "link": "https://stackoverflow.com/users/4338938/valhalla-33"}, "edited": false, "score": 0, "creation_date": 1435687896, "post_id": 31030322, "comment_id": 50301187, "body": "@ Mark Butler.  I am creating everything using Excel which at the moment is better for me since I don&#39;t know Access just yet. I actually have a pretty good solution using RadioButtons Grouped for each Question Block. When ready to score, a button press Protects the sheet &amp; disables the RadioButtons preventing changes. It reads all the T/F values figures out the percentage score based on number of questions and correct answers. I just need to figure a way to evaluate a &quot;written&quot; answer for 1-4 &quot;keywords&quot;. That being done, I&#39;ll be good to go."}], "answers": [{"tags": [], "owner": {"reputation": 21, "user_id": 4992418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00a5dbe9d010804bcc137f9a419ffe14?s=128&d=identicon&r=PG&f=1", "display_name": "Jack Flint", "link": "https://stackoverflow.com/users/4992418/jack-flint"}, "is_accepted": false, "score": 1, "last_activity_date": 1436210876, "creation_date": 1436210876, "answer_id": 31254055, "question_id": 31030322, "link": "https://stackoverflow.com/questions/31030322/advice-for-creating-and-scoring-quizzes/31254055#31254055", "title": "Advice for creating and scoring quizzes", "body": "<p>To try to answer the question: What you are doing seems like a lot of fun from a VBA perspective, and from a user interface perspective, but it seems to me your intuition is telling you to move the test to excel and I think that is the right thing to do. You have much more ability to lock down the test, could easily score multiple tests and create a multi-test curve, etc, etc. </p>\n"}], "owner": {"reputation": 161, "user_id": 4338938, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/he6mC.png?s=128&g=1", "display_name": "Valhalla_33", "link": "https://stackoverflow.com/users/4338938/valhalla-33"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 384, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1436210876, "creation_date": 1435158719, "last_edit_date": 1435160027, "question_id": 31030322, "link": "https://stackoverflow.com/questions/31030322/advice-for-creating-and-scoring-quizzes", "title": "Advice for creating and scoring quizzes", "body": "<p>I'm not sure where to actually post this (I'm pretty sure someone will chastize me tell me where after of course voting me down - expected). </p>\n\n<p>I've been developing a bunch of files for Safety Training at my facility. The UI is built in Excel with Excel VBA at it's heart to get names and the Training program to run. The Excel file opens A PowerPoint presentation after getting your name and the program you desire and logs that data. When you are done with the presentation it opens as a Word doc - the quiz for that presentation. </p>\n\n<p>My issue is this: currently all of our tests are created in Word (I barely know Word VBA) and would like to continue by just adding some text boxes and check boxes for the answers. I'd like to add some code to facilitate the automatic scoring of these tests by placing a button at the end that \"locks\" the test (so they can't change answers) then checks and returns the test score.</p>\n\n<p>I don't see where Word Files can be locked as in Excel's \"Protect Sheet\". The scoring I am using seems to be flawed but that is an issue I can work out later if I stay with Word. I am wondering if it wouldn't be better and maybe easier to do this in Excel as it is set up more for evaluating data input.</p>\n\n<p>Looking for any advice on what others might do if they had a choice to use Word or Excel for creating tests. I currently have no preference (except for the above - which I am not locked into) in which format to use, possibly even using a separate PowerPoint Presentation as the test itself.</p>\n"}, {"tags": ["vba", "excel", "goto"], "answers": [{"comments": [{"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 4, "creation_date": 1435158895, "post_id": 31030278, "comment_id": 50085356, "body": "You don&#39;t even need the word <code>Call</code> it&#39;s just a throwback from legacy VB code."}, {"owner": {"reputation": 3842, "user_id": 2216929, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1cfa9e99112a82bc03a57d97d09e7217?s=128&d=identicon&r=PG", "display_name": "kaybee99", "link": "https://stackoverflow.com/users/2216929/kaybee99"}, "reply_to_user": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 1, "creation_date": 1435159155, "post_id": 31030278, "comment_id": 50085561, "body": "Yes, but I still use it to make it totally clear I&#39;m calling another function"}, {"owner": {"reputation": 11591, "user_id": 1097347, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/efffb39e9e98d002a5b9afe2fde7e50d?s=128&d=identicon&r=PG", "display_name": "Uri Goren", "link": "https://stackoverflow.com/users/1097347/uri-goren"}, "edited": false, "score": 0, "creation_date": 1435164236, "post_id": 31030278, "comment_id": 50089123, "body": "There is a huge difference between calling a subroutine and the <code>GoTo</code> statement. after the subroutine we&#39;ve just call ended, the execution continues from the line we called the <code>Sub</code>, where in the <code>GoTo</code> scenario, it does not"}, {"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "reply_to_user": {"reputation": 942, "user_id": 4974730, "user_type": "registered", "accept_rate": 60, "profile_image": "https://lh3.googleusercontent.com/-Hvpxpah3yUo/AAAAAAAAAAI/AAAAAAAAAGU/GfmmmHA1IO0/photo.jpg?sz=128", "display_name": "Thomas Shera", "link": "https://stackoverflow.com/users/4974730/thomas-shera"}, "edited": false, "score": 0, "creation_date": 1435165164, "post_id": 31030278, "comment_id": 50089688, "body": "Or, @ThomasShera, as S O (and others) pointed out, you can remove both the <code>goto</code> and the <code>call</code> and be just fine."}, {"owner": {"reputation": 942, "user_id": 4974730, "user_type": "registered", "accept_rate": 60, "profile_image": "https://lh3.googleusercontent.com/-Hvpxpah3yUo/AAAAAAAAAAI/AAAAAAAAAGU/GfmmmHA1IO0/photo.jpg?sz=128", "display_name": "Thomas Shera", "link": "https://stackoverflow.com/users/4974730/thomas-shera"}, "reply_to_user": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 0, "creation_date": 1435165346, "post_id": 31030278, "comment_id": 50089798, "body": "@FreeMan OK, thanks! I have a new error message now. Should I edit the original post?"}, {"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 0, "creation_date": 1435165431, "post_id": 31030278, "comment_id": 50089857, "body": "Nope. The SE way is one question, one (accepted) answer. Start up a new question."}], "tags": [], "owner": {"reputation": 3842, "user_id": 2216929, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1cfa9e99112a82bc03a57d97d09e7217?s=128&d=identicon&r=PG", "display_name": "kaybee99", "link": "https://stackoverflow.com/users/2216929/kaybee99"}, "is_accepted": true, "score": 5, "last_activity_date": 1435158941, "last_edit_date": 1435158941, "creation_date": 1435158588, "answer_id": 31030278, "question_id": 31030162, "link": "https://stackoverflow.com/questions/31030162/vba-compile-error-label-not-defined/31030278#31030278", "title": "VBA &quot;Compile Error: Label not defined&quot;", "body": "<p><code>GoTo</code> will try and transfer the code execution to a different position in the current Subroutine with the given label.</p>\n\n<p>Specifically, <code>GoTo FunctionNotValidVarType</code> will try and execute the line:</p>\n\n<pre><code>FunctionNotValidVarType:  'Do stuff here\n</code></pre>\n\n<p>which doesn't exist in  your current code.</p>\n\n<p>If you want to call another function use <code>Call FunctionNotValidVarType</code></p>\n"}, {"comments": [{"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "reply_to_user": {"reputation": 862, "user_id": 1560126, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/8cebd478b6291f992ce5b2547b9c36f3?s=128&d=identicon&r=PG", "display_name": "ale10ander", "link": "https://stackoverflow.com/users/1560126/ale10ander"}, "edited": false, "score": 0, "creation_date": 1435165471, "post_id": 31030292, "comment_id": 50089895, "body": "well, you <i>could</i> use the <code>goto</code>, @cptn_hammer, in an <code>On Error Goto...</code>, but there are few other valid times..."}, {"owner": {"reputation": 862, "user_id": 1560126, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/8cebd478b6291f992ce5b2547b9c36f3?s=128&d=identicon&r=PG", "display_name": "ale10ander", "link": "https://stackoverflow.com/users/1560126/ale10ander"}, "edited": false, "score": 0, "creation_date": 1435165877, "post_id": 31030292, "comment_id": 50090147, "body": "I just added the link on shouldn&#39;t. I prefer to give people reasons <i>why</i> something is the way it is, rather than making sweeping proclamations. Information breeds understanding."}, {"owner": {"reputation": 862, "user_id": 1560126, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/8cebd478b6291f992ce5b2547b9c36f3?s=128&d=identicon&r=PG", "display_name": "ale10ander", "link": "https://stackoverflow.com/users/1560126/ale10ander"}, "edited": false, "score": 0, "creation_date": 1435166072, "post_id": 31030292, "comment_id": 50090279, "body": "Ahh didn&#39;t look at your username :)"}], "tags": [], "owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "is_accepted": false, "score": 2, "last_activity_date": 1435165041, "last_edit_date": 1495542689, "creation_date": 1435158627, "answer_id": 31030292, "question_id": 31030162, "link": "https://stackoverflow.com/questions/31030162/vba-compile-error-label-not-defined/31030292#31030292", "title": "VBA &quot;Compile Error: Label not defined&quot;", "body": "<p>Remove <code>Goto</code> from the call to your <code>Sub()</code></p>\n\n<p>If you really wanted to use a <code>Goto</code> (and you <em><a href=\"https://stackoverflow.com/questions/46586/goto-still-considered-harmful\">shouldn't</a></em>), you would </p>\n\n<pre><code>goto Label\n\nLabel:\n</code></pre>\n\n<p>where the label is defined by the trailing colon <code>:</code></p>\n"}, {"tags": [], "owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "is_accepted": false, "score": 2, "last_activity_date": 1435158853, "creation_date": 1435158853, "answer_id": 31030383, "question_id": 31030162, "link": "https://stackoverflow.com/questions/31030162/vba-compile-error-label-not-defined/31030383#31030383", "title": "VBA &quot;Compile Error: Label not defined&quot;", "body": "<p>Remove the word <code>GoTo</code></p>\n\n<p><code>GoTo</code> tells the code to jump to a label, you want it to enter a new procedure, not go to a label</p>\n"}, {"tags": [], "owner": {"reputation": 11591, "user_id": 1097347, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/efffb39e9e98d002a5b9afe2fde7e50d?s=128&d=identicon&r=PG", "display_name": "Uri Goren", "link": "https://stackoverflow.com/users/1097347/uri-goren"}, "is_accepted": false, "score": 0, "last_activity_date": 1435164051, "last_edit_date": 1435164051, "creation_date": 1435163361, "answer_id": 31032052, "question_id": 31030162, "link": "https://stackoverflow.com/questions/31030162/vba-compile-error-label-not-defined/31032052#31032052", "title": "VBA &quot;Compile Error: Label not defined&quot;", "body": "<p><code>GoTo</code> transitions to a label, a label is defined with <code>:</code></p>\n\n<p>For example:</p>\n\n<pre><code>Sub G()\nOn Error GoTo err_handling\n  a=1/0\n  Exit Sub\nerr_handling:\n  MsgBox \"Holy Shit, an error occurred !\"\nEnd Sub\n</code></pre>\n\n<p>To apply <code>GoTo</code> on a <code>Sub</code> you need call it and exit:</p>\n\n<pre><code>Call FunctionNotValidVarType\nExit Sub\n</code></pre>\n\n<p><em>(Technically, it is not the same as <code>GoTo</code> if you take the call stack into consideration, but the end result is the same)</em></p>\n\n<p><code>GoTo</code> is not considered a good practice, but if that doesn't concern you, take a look also at <code>GoSub</code> at the <a href=\"https://msdn.microsoft.com/en-us/library/office/gg251648.aspx\" rel=\"nofollow\">official docs</a>.</p>\n"}], "owner": {"reputation": 942, "user_id": 4974730, "user_type": "registered", "accept_rate": 60, "profile_image": "https://lh3.googleusercontent.com/-Hvpxpah3yUo/AAAAAAAAAAI/AAAAAAAAAGU/GfmmmHA1IO0/photo.jpg?sz=128", "display_name": "Thomas Shera", "link": "https://stackoverflow.com/users/4974730/thomas-shera"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 34987, "favorite_count": 0, "accepted_answer_id": 31030278, "answer_count": 4, "score": 2, "last_activity_date": 1435165041, "creation_date": 1435158301, "last_edit_date": 1435162961, "question_id": 31030162, "link": "https://stackoverflow.com/questions/31030162/vba-compile-error-label-not-defined", "title": "VBA &quot;Compile Error: Label not defined&quot;", "body": "<p>I have a VBA macro which gave me that error message.</p>\n\n<pre><code>Sub Function1()\n    '   Give the user macro options based on how fast or slow the computer \n    '   is using advanced conditional compiling\n    vuserChoice = MsgBox(\"This macro by default treats all numbers as decimals for maximum precision. If you are running this macro on an old computer, you may want to declare numbers as singles, to speed up the macro.\")\n    MsgBox (\"Decimal: recommended for maximum precision. Also slower.\" &amp; vbNewLine &amp; \"Long: not recommended. Rounds to nearest integer.\" &amp; vbNewLine &amp; \"Single: not recommended. A lightweight double.\" &amp; vbNewLine &amp; \"Integer: not recommended. Quick and low-precision.\")\n\n    If vuserChoice = \"Decimal\" Or \"decimal\" Then\n        GoTo FunctionDecimal\n    ElseIf vuserChoice = \"Double\" Or \"double\" Then\n        GoTo FunctionDouble\n    ElseIf vuserChoice = \"Single\" Or \"single\" Then\n        GoTo FunctionSingle\n    ElseIf vuserChoice = \"Long\" Or \"long\" Then\n        GoTo FunctionLong\n    Else\n        GoTo FunctionNotValidVarType\n    End If\n\n    '   MEeff = measure of efflux due to crudely purified HDL in scintillation\n    MsgBox \"For additional information about this macro:\" &amp; vbNewLine &amp; \"1. Go to tab Developer\" &amp; vbNewLine &amp; \"2. Select Visual Basic or Macro.\" &amp; vbNewLine &amp; \"See the comments or MsgBoxes (message boxes).\"\nEnd Sub\n</code></pre>\n\n<p>The offending line is:</p>\n\n<pre><code>GoTo FunctionNotValidVarType\n</code></pre>\n\n<p>I have the function <code>FunctionNotValidVarType</code> below this code. I have it as: </p>\n\n<pre><code>Public Sub FunctionNotValidVarType()\n    MsgBox \"VarType \" &amp; VarType &amp; \" is not supported. Please check spelling.\"\nEnd Sub\n</code></pre>\n\n<p>What do I need to do to let the first function recognize <code>FunctionNotValidVarType</code>? Thanks.</p>\n"}, {"tags": ["sql-server", "excel", "vba", "stored-procedures"], "comments": [{"owner": {"reputation": 13431, "user_id": 2169762, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Nns8w.png?s=128&g=1", "display_name": "Martin", "link": "https://stackoverflow.com/users/2169762/martin"}, "edited": false, "score": 1, "creation_date": 1435158481, "post_id": 31029938, "comment_id": 50085032, "body": "Just an aside, but your <code>level0type</code>, <code>level1type</code> and <code>level2type</code> columns are <code>adVarChar</code> and you are specifying their values as <code>N&#39;value&#39;</code> which is indicating that they are Unicode."}, {"owner": {"reputation": 901, "user_id": 4979197, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/deGfP.png?s=128&g=1", "display_name": "Chuck", "link": "https://stackoverflow.com/users/4979197/chuck"}, "edited": false, "score": 0, "creation_date": 1435274570, "post_id": 31029938, "comment_id": 50145262, "body": "You should close your connection (con.close) after you execute your command (cmd.execute), because it will stay open."}], "owner": {"reputation": 11, "user_id": 5044615, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/671030000f2f8cc7004f493ffbf4152a?s=128&d=identicon&r=PG&f=1", "display_name": "Alexey Nikolaev", "link": "https://stackoverflow.com/users/5044615/alexey-nikolaev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 387, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1435157656, "creation_date": 1435157656, "question_id": 31029938, "link": "https://stackoverflow.com/questions/31029938/cant-pass-parameters-to-a-stored-procedure", "title": "Can&#39;t pass parameters to a stored procedure", "body": "<p>I'm trying to create a userform in Excel which allows users to add new column and description to it to an existing SQL server table.</p>\n\n<p>I do with ADO library in VBA. To add description to a column created I need to run a system stored procedure sp_addextendedproperty.</p>\n\n<p>I can't pass parameters to it, I always receive an error <strong>Error -2147217900: An invalid parameter or option was specified for procedure 'sp_addextendedproperty'.</strong></p>\n\n<pre><code>Private Sub InsertField_bt_Click()\n    Set con = New ADODB.Connection\n    con.Provider = \"sqloledb\"\n    sConnectionString = \"Server=rumossql12;Database=PharmNet;UID=(login here);Pwd=(password here)\"\n    con.Open sConnectionString\n\n    Set cmd = New ADODB.Command\n    cmd.CommandType = adCmdStoredProc\n    cmd.ActiveConnection = con\n    cmd.CommandText = \"sp_addextendedproperty\"\n\n    Dim name As ADODB.Parameter\n    Dim value As ADODB.Parameter\n    Dim level0type As ADODB.Parameter\n    Dim level0name As ADODB.Parameter\n    Dim level1type As ADODB.Parameter\n    Dim level1name As ADODB.Parameter\n    Dim level2type As ADODB.Parameter\n    Dim level2name As ADODB.Parameter\n\n    Set name = cmd.CreateParameter(\"@name\", adVarWChar, adParamInput, 128, \"N'MS_Description'\")\n    cmd.Parameters.Append name\n\n    Set value = cmd.CreateParameter(\"@value\", adVariant, adParamInput, , \"N'\" &amp; InsertField.TextBox2.value &amp; \"'\")\n    cmd.Parameters.Append value\n\n    Set level0type = cmd.CreateParameter(\"@level0type\", adVarChar, adParamInput, 128, \"N'SCHEMA'\")\n    cmd.Parameters.Append level0type\n\n    Set level0name = cmd.CreateParameter(\"@level0name\", adVarWChar, adParamInput, 128, \"N'dbo'\")\n    cmd.Parameters.Append level0name\n\n    Set level1type = cmd.CreateParameter(\"@level1type\", adVarChar, adParamInput, 128, \"N'TABLE'\")\n    cmd.Parameters.Append level1type\n\n    Set level1name = cmd.CreateParameter(\"@level1name\", adVarWChar, adParamInput, 128, \"N'tbConsolidator'\")\n    cmd.Parameters.Append level1name\n\n    Set level2type = cmd.CreateParameter(\"@level2type\", adVarChar, adParamInput, 128, \"N'COLUMN'\")\n    cmd.Parameters.Append level2type\n\n    Set level2name = cmd.CreateParameter(\"@level2name\", adVarWChar, adParamInput, 128, \"N'\" &amp; InsertField.TextBox1.value &amp; \"'\")\n    cmd.Parameters.Append level2name\n\n    On Error GoTo ErrHandler\n\n\n    sSQL = \"ALTER TABLE PharmNet.dbo.tbConsolidator ADD \" &amp; InsertField.TextBox1.value &amp; \" NVARCHAR(255) NULL\"\n    'con.Execute sSQL\n    cmd.Execute\n    InsertField.Hide\n\nErrHandler:\n    MsgBox \"Error \" &amp; Err.Number &amp; \": \" &amp; Err.Description, vbCritical, \"ErrorThingy\"\n    Sheet2.Cells(1, 1).value = \"Error \" &amp; Err.Number &amp; \": \" &amp; Err.Description\n    con.Close\n    Set con = Nothing\nEnd Sub\n</code></pre>\n\n<p>Why can it happen?</p>\n"}, {"tags": ["vba", "ms-word"], "answers": [{"tags": [], "owner": {"reputation": 205, "user_id": 2077432, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/60294c0c82094c1ca625aa0c3c16af71?s=128&d=identicon&r=PG", "display_name": "Kelly Tessena Keck", "link": "https://stackoverflow.com/users/2077432/kelly-tessena-keck"}, "is_accepted": true, "score": 1, "last_activity_date": 1441022036, "creation_date": 1441022036, "answer_id": 32310646, "question_id": 31029714, "link": "https://stackoverflow.com/questions/31029714/word-vba-range-from-words-object/32310646#32310646", "title": "Word VBA Range from Words Object", "body": "<p>Object variables need to be assigned using Set. Instead of:</p>\n\n<pre><code>rngWord = ActiveDocument.Words(k)\n</code></pre>\n\n<p>use</p>\n\n<pre><code>Set rngWord = ActiveDocument.Words(k)\n</code></pre>\n\n<p>This small sample worked correctly:</p>\n\n<pre><code>Sub WordRangeTest()\n\nDim rngWord As Range\nSet rngWord = ActiveDocument.Words(1)\nMsgBox (rngWord.Text)\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 205, "user_id": 2077432, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/60294c0c82094c1ca625aa0c3c16af71?s=128&d=identicon&r=PG", "display_name": "Kelly Tessena Keck", "link": "https://stackoverflow.com/users/2077432/kelly-tessena-keck"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1771, "favorite_count": 1, "accepted_answer_id": 32310646, "answer_count": 1, "score": 1, "last_activity_date": 1459761352, "creation_date": 1435157059, "last_edit_date": 1459761352, "question_id": 31029714, "link": "https://stackoverflow.com/questions/31029714/word-vba-range-from-words-object", "title": "Word VBA Range from Words Object", "body": "<p>Context: I'm writing a Word VBA macro that loops through each word in a document, identifies the acronyms, and creates an acronym list as a new document. The next step is to identify whether the acronym is in parentheses (meaning it's likely spelled out) on its first occurrence. So, I'd like to expand the range to find out whether the characters on either side of the word are \"(\" and \")\".</p>\n\n<p>Issue: I can't figure out how to assign the range of the word to a range variable that I can then expand.  Using \"rngWord = ActiveDocument.Words(k)\" (where k is the counter variable) gets the error #91, Object Variable or With block variable not set. So presumably there's a method or property for Words that I'm missing. Based on Microsoft's VBA reference, though, the members of the Words collection are already ranges, so I'm stumped on why I can't assign one to a range variable. </p>\n\n<pre><code>Dim intArrayCount As Integer\nDim booAcroMatchesArray As Boolean\nDim intNextAcro As Integer\nDim strAcros(1000) As String\nDim strContext(1000) As String\nDim booAcroDefined(1000) As Boolean\nDim strTestMessage As String\n\ni = 1\nbooAcroMatchesArray = False\nintNextAcro = 1\nFor k = 1 To ActiveDocument.Words.Count\n    strWord = ActiveDocument.Words(k).Text\n    rngWord = ActiveDocument.Words(k) //The line that's missing something\n    MsgBox strWord\n    rngWord.Expand Unit:=wdCharacter\n    strWordPlus = rngWord\n    MsgBox strWordPlus\n\n\n\n    strWord = Trim(strWord)\n\n    If strWord = UCase(strWord) And Len(strWord) &gt;= 2 And IsLetter(Left(strWord, 1)) = True Then\n        'MsgBox (\"Word = \" &amp; strWord &amp; \" and Length = \" &amp; Len(strWord))\n        For intArrayCount = 1 To 1000\n            If strWord = strAcros(intArrayCount) Then booAcroMatchesArray = True\n        Next intArrayCount\n\n        'MsgBox (\"Word = \" &amp; strWord &amp; \" Match = \" &amp; booAcroMatchesArray)\n\n        If booAcroMatchesArray = False Then\n            strAcros(intNextAcro) = strWord\n            intNextAcro = intNextAcro + 1\n\n\n\n        End If\n\n        booAcroMatchesArray = False\n\n    End If\n\nNext k\n</code></pre>\n"}, {"tags": ["vba", "excel", "search", "find-occurrences"], "comments": [{"owner": {"reputation": 2709, "user_id": 4579015, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/56bbb7da70756a6470a57e2ee5ca341f?s=128&d=identicon&r=PG&f=1", "display_name": "LocEngineer", "link": "https://stackoverflow.com/users/4579015/locengineer"}, "edited": false, "score": 0, "creation_date": 1435157369, "post_id": 31029443, "comment_id": 50084208, "body": "I am trying to wrap my head around this but don&#39;t succeed. YOu have code? Values in Rows? Categories in Columns? Which of these is variable? Does the number of columns per row vary? What do you mean with categories and what do you mean by &quot;range&quot; of a &quot;code&quot;? Could you possibly try to put down some sample data in your post as well as what excatly you would like to count and where the percenatge shall be displayed?"}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1435157408, "post_id": 31029443, "comment_id": 50084233, "body": "you are referring to both rows and columns in a confusing way, especially in the second paragraph. Is the word &quot;row&quot; a typo there?"}, {"owner": {"reputation": 427, "user_id": 4995049, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/60e3b321eb9b28047e4a7966cdb756ab?s=128&d=identicon&r=PG&f=1", "display_name": "Coding Novice", "link": "https://stackoverflow.com/users/4995049/coding-novice"}, "edited": false, "score": 0, "creation_date": 1435158325, "post_id": 31029443, "comment_id": 50084891, "body": "Here is the best I can do.  There are 100ish categories that are labeled at the top of each column. Each column is an individual category. For example, one column might have the label &quot;Pixel Size.&quot; Then underneath there will be cells that belong to that category.   For pixel size the possible cells are 1: some various numbers. (ex: 24, 48, 92.. etc) 2: &quot;Custom&quot;. 3: Blank cells"}, {"owner": {"reputation": 427, "user_id": 4995049, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/60e3b321eb9b28047e4a7966cdb756ab?s=128&d=identicon&r=PG&f=1", "display_name": "Coding Novice", "link": "https://stackoverflow.com/users/4995049/coding-novice"}, "edited": false, "score": 0, "creation_date": 1435158328, "post_id": 31029443, "comment_id": 50084898, "body": "if out of 100 rows 24 occurs 60 times, 28 occurs 20 times, and 92 occurs 10 times, and there are 6 &quot;Custom&quot; cells and 4 blank cells. I want the code to highlight the 6 &quot;custom cells and possibly the 10 &quot;92&quot; cells depending on how much the total number of cells is (maybe the code will only pull show the bottom 10%.   Does this make sense?"}, {"owner": {"reputation": 427, "user_id": 4995049, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/60e3b321eb9b28047e4a7966cdb756ab?s=128&d=identicon&r=PG&f=1", "display_name": "Coding Novice", "link": "https://stackoverflow.com/users/4995049/coding-novice"}, "edited": false, "score": 0, "creation_date": 1435158459, "post_id": 31029443, "comment_id": 50085012, "body": "Sorry about the confusion. I myself am also having trouble to describe what I want this code to do. I just can see the end result"}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1435159122, "post_id": 31029443, "comment_id": 50085532, "body": "I would use a VBScript dictionary object (accessible in VBA if your project includes a reference to the Microsoft Scripting Runtime). Dictionaries are much better for maintaining frequency counts than any native VBA object. This seems especially important in your case since it seems that the values are heterogeneous (e.g. a mixture of integers and strings)."}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1435161143, "post_id": 31029443, "comment_id": 50087032, "body": "Why not just generate a list of the codes, and use COUNTIF with the code as the criteria."}], "answers": [{"comments": [{"owner": {"reputation": 427, "user_id": 4995049, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/60e3b321eb9b28047e4a7966cdb756ab?s=128&d=identicon&r=PG&f=1", "display_name": "Coding Novice", "link": "https://stackoverflow.com/users/4995049/coding-novice"}, "edited": false, "score": 0, "creation_date": 1435320909, "post_id": 31031551, "comment_id": 50164544, "body": "I am going to check on this right now. Ill get back asap as to whether or not this is a step in the right direction! Thank you!"}, {"owner": {"reputation": 427, "user_id": 4995049, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/60e3b321eb9b28047e4a7966cdb756ab?s=128&d=identicon&r=PG&f=1", "display_name": "Coding Novice", "link": "https://stackoverflow.com/users/4995049/coding-novice"}, "edited": false, "score": 0, "creation_date": 1435321274, "post_id": 31031551, "comment_id": 50164767, "body": "So the problem i am having running this is that it looks like perhaps the opposite effect is happening, everything turns yellow on the run except for the first value in the leading end of some of the rows. Odd... I do think this code is in the right direction, I will try to putz around with it to see what I can do."}, {"owner": {"reputation": 2709, "user_id": 4579015, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/56bbb7da70756a6470a57e2ee5ca341f?s=128&d=identicon&r=PG&f=1", "display_name": "LocEngineer", "link": "https://stackoverflow.com/users/4579015/locengineer"}, "reply_to_user": {"reputation": 427, "user_id": 4995049, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/60e3b321eb9b28047e4a7966cdb756ab?s=128&d=identicon&r=PG&f=1", "display_name": "Coding Novice", "link": "https://stackoverflow.com/users/4995049/coding-novice"}, "edited": false, "score": 0, "creation_date": 1435322603, "post_id": 31031551, "comment_id": 50165653, "body": "Funny. <code>col.Cells(1, col.Column).Address</code> seems to return a wrong address; therefore the lookup happens in the wrong column! Fixed it. Should work better now."}, {"owner": {"reputation": 427, "user_id": 4995049, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/60e3b321eb9b28047e4a7966cdb756ab?s=128&d=identicon&r=PG&f=1", "display_name": "Coding Novice", "link": "https://stackoverflow.com/users/4995049/coding-novice"}, "edited": false, "score": 0, "creation_date": 1435333045, "post_id": 31031551, "comment_id": 50172719, "body": "So I am still having trouble, but I cant figure out why. It looks like to me that the code you have posted is highlighting by row rather than by column because one column completely filled with &quot;False&quot; is being highlighted.  I am attempting to amend the code to inverse the scan direction if that is the problem.  I wish I could share a picture of what the scanned data looks like. For the most part the yellow is highlighting entire columns to look like vertical bars."}, {"owner": {"reputation": 2709, "user_id": 4579015, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/56bbb7da70756a6470a57e2ee5ca341f?s=128&d=identicon&r=PG&f=1", "display_name": "LocEngineer", "link": "https://stackoverflow.com/users/4579015/locengineer"}, "reply_to_user": {"reputation": 427, "user_id": 4995049, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/60e3b321eb9b28047e4a7966cdb756ab?s=128&d=identicon&r=PG&f=1", "display_name": "Coding Novice", "link": "https://stackoverflow.com/users/4995049/coding-novice"}, "edited": false, "score": 0, "creation_date": 1435400870, "post_id": 31031551, "comment_id": 50192351, "body": "Single step through it to see what each variable holds at a given point in time. It seems that your data is organised slightly different to what I thought it would be. Some visual sample might be helpful."}, {"owner": {"reputation": 427, "user_id": 4995049, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/60e3b321eb9b28047e4a7966cdb756ab?s=128&d=identicon&r=PG&f=1", "display_name": "Coding Novice", "link": "https://stackoverflow.com/users/4995049/coding-novice"}, "edited": false, "score": 0, "creation_date": 1435590197, "post_id": 31031551, "comment_id": 50251221, "body": "Okay, so I reviewed the data, and the code you made does in fact work very well. It still has a couple of problems for my use. It highlights titles (the actual data starts on row 7 and I cant seem to edit it to match. Secondly, rows that have no deviation in the data get completely highlighted."}, {"owner": {"reputation": 427, "user_id": 4995049, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/60e3b321eb9b28047e4a7966cdb756ab?s=128&d=identicon&r=PG&f=1", "display_name": "Coding Novice", "link": "https://stackoverflow.com/users/4995049/coding-novice"}, "edited": false, "score": 0, "creation_date": 1435590781, "post_id": 31031551, "comment_id": 50251666, "body": "Also in some cases the lowest frequency values down a column are not being highlighted, I cant explain why."}, {"owner": {"reputation": 2709, "user_id": 4579015, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/56bbb7da70756a6470a57e2ee5ca341f?s=128&d=identicon&r=PG&f=1", "display_name": "LocEngineer", "link": "https://stackoverflow.com/users/4579015/locengineer"}, "reply_to_user": {"reputation": 427, "user_id": 4995049, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/60e3b321eb9b28047e4a7966cdb756ab?s=128&d=identicon&r=PG&f=1", "display_name": "Coding Novice", "link": "https://stackoverflow.com/users/4995049/coding-novice"}, "edited": false, "score": 0, "creation_date": 1435593099, "post_id": 31031551, "comment_id": 50253202, "body": "Holy smoking moly, Batman! If THAT truly is your sheet.... I&#39;d say: forget &quot;UsedRange&quot;. That won&#39;t work well enough with THAT spread... I&#39;ve edited the above code using more hardcoded values. Please adapt the values according to your needs and try that. Woah what a mess. Thank god it&#39;s just a thumbnail pic up there... :-P"}], "tags": [], "owner": {"reputation": 2709, "user_id": 4579015, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/56bbb7da70756a6470a57e2ee5ca341f?s=128&d=identicon&r=PG&f=1", "display_name": "LocEngineer", "link": "https://stackoverflow.com/users/4579015/locengineer"}, "is_accepted": true, "score": 1, "last_activity_date": 1435593155, "last_edit_date": 1435593155, "creation_date": 1435161968, "answer_id": 31031551, "question_id": 31029443, "link": "https://stackoverflow.com/questions/31029443/find-and-highlight-least-common-occurrences-in-variable-range/31031551#31031551", "title": "Find and Highlight Least Common Occurrence(s) in Variable Range", "body": "<p>I just hacked together a seemingly working example. Try this here:</p>\n\n<pre><code>Sub frequenz()\nDim col As Range, cel As Range\nDim letter As String\nDim lookFor As String\nDim frequency As Long, totalRows As Long\nDim relFrequency As Double\nDim ran As Range\n\nran = ActiveSheet.Range(\"A1:ZZ65535\")\ntotalRows = 65535\n\nFor Each col In ran.Columns\n    '***get column letter***\n    letter = Split(ActiveSheet.Cells(1, col.Column).Address, \"$\")(1)\n    '*******\n    For Each cel In col.Cells\n        lookFor = cel.Text\n        frequency = Application.WorksheetFunction.CountIf(Range(letter &amp; \"2:\" &amp; letter &amp; totalRows), lookFor)\n        relFrequency = frequency / totalRows\n\n        If relFrequency &lt;= 0.001 Then\n            cel.Interior.Color = ColorConstants.vbYellow\n        End If\n    Next cel\n\nNext col\n\nEnd Sub\n</code></pre>\n\n<p>It seemed to be doing just what you are looking for.</p>\n\n<p>Edit: fixed the address getting.</p>\n"}], "owner": {"reputation": 427, "user_id": 4995049, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/60e3b321eb9b28047e4a7966cdb756ab?s=128&d=identicon&r=PG&f=1", "display_name": "Coding Novice", "link": "https://stackoverflow.com/users/4995049/coding-novice"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 228, "favorite_count": 0, "accepted_answer_id": 31031551, "answer_count": 1, "score": 0, "last_activity_date": 1435593155, "creation_date": 1435156315, "last_edit_date": 1592644375, "question_id": 31029443, "link": "https://stackoverflow.com/questions/31029443/find-and-highlight-least-common-occurrences-in-variable-range", "title": "Find and Highlight Least Common Occurrence(s) in Variable Range", "body": "<p>I have a code that has a variable range with many categories in each column that display data. I need to highlight the least commonly occurring values as a percentage of the total number of cells.</p>\n<p>If there are 300 cells in the column, it needs to find the value (out of many possibly repeating values) that occurs least frequently. It is a bonus if the code can anticipate the total number, and give only 5% or 10% of the entire column as a result.</p>\n<p>Currently my attempt is to use a function in the top cell that will find the least common occurrence, and the code will simply highlight whatever that value is down the cell as it repeats (and highlight every one of the least common ones.</p>\n<p>The difficulty I am having is twofold.</p>\n<ol>\n<li>There may be more than one least common value that is still below 10% of the total values</li>\n<li>The ability to automate this search so that it may be performed and highlighted for all of more than 100 columns with different categories and different values in each column</li>\n</ol>\n<p>If too vague, feel free to ask questions about what I am going for, and I will respond promptly.</p>\n<p>This is what the data looks like. As you can see there are merged titles for each column with various blank spaces and sperratically placed data that matches some specific column.\n<img src=\"https://i.stack.imgur.com/WRpUi.png\" alt=\"enter image description here\" /></p>\n<p>This is the proposed code which is still not highlighting what I would like it to. It has two problems. 1: It will highlight ALL of the data in one range if there is no differing value in the row. 2: It will highlight the titles of the columns.\n<img src=\"https://i.stack.imgur.com/klFKr.png\" alt=\"enter image description here\" /></p>\n<p>This is the highlighted data which is still insufficiently complete.\n<img src=\"https://i.stack.imgur.com/r0HvT.png\" alt=\"enter image description here\" /></p>\n<p>In some cases the column truely do not match the purpose of the code, for example in one column, the number 12 was highlighted down the column (67 occurances) where there are fewer occurances of other numbers. (8 occurs 29 times and is not highlighted)</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 3003, "user_id": 1540019, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/8ca15171e2123d2218198e6a0a77e3d9?s=128&d=identicon&r=PG", "display_name": "rohrl77", "link": "https://stackoverflow.com/users/1540019/rohrl77"}, "edited": false, "score": 0, "creation_date": 1435157489, "post_id": 31029417, "comment_id": 50084302, "body": "Could the <code>Auto Outline</code> Feature under <code>Data&gt;Group&gt;Auto Outline</code> be of help to you? If that does what you want it to manually, it could be adapted to code. Not sure yet what your data structure looks like."}, {"owner": {"reputation": 1668, "user_id": 5019691, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/93494c08d9bc6418d7a02846a51c5299?s=128&d=identicon&r=PG&f=1", "display_name": "aLearningLady", "link": "https://stackoverflow.com/users/5019691/alearninglady"}, "reply_to_user": {"reputation": 3003, "user_id": 1540019, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/8ca15171e2123d2218198e6a0a77e3d9?s=128&d=identicon&r=PG", "display_name": "rohrl77", "link": "https://stackoverflow.com/users/1540019/rohrl77"}, "edited": false, "score": 0, "creation_date": 1435158554, "post_id": 31029417, "comment_id": 50085109, "body": "@rohrl77 I wasn&#39;t able to get Auto Outline to do anything, but I haven&#39;t had much experience with that function.  I&#39;ve attached a screenshot of the data structure for reference above. Thanks!"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 1, "creation_date": 1435159812, "post_id": 31029417, "comment_id": 50086074, "body": "It appears that you are basically reinventing the Data- Subtotals feature which does exactly this."}], "answers": [{"tags": [], "owner": {"reputation": 1668, "user_id": 5019691, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/93494c08d9bc6418d7a02846a51c5299?s=128&d=identicon&r=PG&f=1", "display_name": "aLearningLady", "link": "https://stackoverflow.com/users/5019691/alearninglady"}, "is_accepted": true, "score": 2, "last_activity_date": 1435171407, "creation_date": 1435171407, "answer_id": 31034497, "question_id": 31029417, "link": "https://stackoverflow.com/questions/31029417/vba-insert-line-after-data-change-and-sum-data-group/31034497#31034497", "title": "VBA Insert Line After Data Change and Sum Data Group", "body": "<p>To anyone looking for the VBA answer to this, the below worked for me:</p>\n\n<pre><code>Range(\"A1\").Subtotal GroupBy:=3, Function:=xlSum, TotalList:=Array(6), _\n    Replace:=False, PageBreaks:=False, SummaryBelowData:=True\n</code></pre>\n\n<p>*Group by is the column number of what the data is being grouped by. \n**The number in parentheses next to Array is the column that the preceding function is being applied to.  </p>\n\n<p>Thanks to @Rory for the inspiration. </p>\n"}], "owner": {"reputation": 1668, "user_id": 5019691, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/93494c08d9bc6418d7a02846a51c5299?s=128&d=identicon&r=PG&f=1", "display_name": "aLearningLady", "link": "https://stackoverflow.com/users/5019691/alearninglady"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1931, "favorite_count": 0, "accepted_answer_id": 31034497, "answer_count": 1, "score": 1, "last_activity_date": 1528997179, "creation_date": 1435156257, "last_edit_date": 1528997179, "question_id": 31029417, "link": "https://stackoverflow.com/questions/31029417/vba-insert-line-after-data-change-and-sum-data-group", "title": "VBA Insert Line After Data Change and Sum Data Group", "body": "<p>I have a client with a long report of data that I am writing a VBA script to simplify.  What they would like is <em>after</em> each group of clients, a blank row is inserted. This is satisfied by:    </p>\n\n<pre><code>Dim lRow As Long\nFor lRow = Cells(Cells.Rows.Count, \"C\").End(xlUp).Row To 3 Step -1\n    If Cells(lRow, \"C\") &lt;&gt; Cells(lRow - 1, \"C\") Then Rows(lRow).EntireRow.Insert\nNext lRow\n</code></pre>\n\n<p>Now, in this empty row, I need an AutoSum of the values in Column F for the preceding group (i.e. the data leading to the blank row). </p>\n\n<p>I've been trying to use the blank special cell type but can't seem to get anything to work.  Any advice would be greatly appreciated.</p>\n\n<p>Thanks in advance!</p>\n"}, {"tags": ["vba", "excel", "events"], "answers": [{"comments": [{"owner": {"reputation": 109, "user_id": 4363180, "user_type": "registered", "accept_rate": 33, "profile_image": "https://lh6.googleusercontent.com/-sQVzVmv0FNE/AAAAAAAAAAI/AAAAAAAAAPg/d8yd3aGERaI/photo.jpg?sz=128", "display_name": "Maxwell", "link": "https://stackoverflow.com/users/4363180/maxwell"}, "edited": false, "score": 0, "creation_date": 1435157701, "post_id": 31029700, "comment_id": 50084447, "body": "Thank you very much. You&#39;re amazing, with this code I can use as base for anything. Regards!"}, {"owner": {"reputation": 109, "user_id": 4363180, "user_type": "registered", "accept_rate": 33, "profile_image": "https://lh6.googleusercontent.com/-sQVzVmv0FNE/AAAAAAAAAAI/AAAAAAAAAPg/d8yd3aGERaI/photo.jpg?sz=128", "display_name": "Maxwell", "link": "https://stackoverflow.com/users/4363180/maxwell"}, "edited": false, "score": 0, "creation_date": 1435158550, "post_id": 31029700, "comment_id": 50085104, "body": "I have another question, let&#39;s imagine the person who is filling the sheet, doesn&#39;t want to type cell by cell, and he decides to do a copy dropdown to the following 10 cell. In my code, instead of calling a macro, I highlight the right cell in yellow, how can you highlight the right cells after he did a copy and paste?"}, {"owner": {"reputation": 8006, "user_id": 2753501, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0a5ac280a03c3a9d89488dc33f0ef075?s=128&d=identicon&r=PG&f=1", "display_name": "ZygD", "link": "https://stackoverflow.com/users/2753501/zygd"}, "reply_to_user": {"reputation": 109, "user_id": 4363180, "user_type": "registered", "accept_rate": 33, "profile_image": "https://lh6.googleusercontent.com/-sQVzVmv0FNE/AAAAAAAAAAI/AAAAAAAAAPg/d8yd3aGERaI/photo.jpg?sz=128", "display_name": "Maxwell", "link": "https://stackoverflow.com/users/4363180/maxwell"}, "edited": false, "score": 0, "creation_date": 1435158620, "post_id": 31029700, "comment_id": 50085156, "body": "I made one small change - <code>If Target.Value = &quot;New Hire&quot; Then</code> became <code>If cell.Value = &quot;New Hire&quot; Then</code>."}, {"owner": {"reputation": 8006, "user_id": 2753501, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0a5ac280a03c3a9d89488dc33f0ef075?s=128&d=identicon&r=PG&f=1", "display_name": "ZygD", "link": "https://stackoverflow.com/users/2753501/zygd"}, "reply_to_user": {"reputation": 109, "user_id": 4363180, "user_type": "registered", "accept_rate": 33, "profile_image": "https://lh6.googleusercontent.com/-sQVzVmv0FNE/AAAAAAAAAAI/AAAAAAAAAPg/d8yd3aGERaI/photo.jpg?sz=128", "display_name": "Maxwell", "link": "https://stackoverflow.com/users/4363180/maxwell"}, "edited": false, "score": 0, "creation_date": 1435159073, "post_id": 31029700, "comment_id": 50085501, "body": "If I understand correctly, that would be pretty simple. Try inserting the following line: <code>cell.Interior.Color = 65535</code>. The code above also works when users choose pasting several cells at once."}], "tags": [], "owner": {"reputation": 8006, "user_id": 2753501, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0a5ac280a03c3a9d89488dc33f0ef075?s=128&d=identicon&r=PG&f=1", "display_name": "ZygD", "link": "https://stackoverflow.com/users/2753501/zygd"}, "is_accepted": true, "score": 1, "last_activity_date": 1435158542, "last_edit_date": 1435158542, "creation_date": 1435157022, "answer_id": 31029700, "question_id": 31029404, "link": "https://stackoverflow.com/questions/31029404/running-vba-code-only-after-a-specific-input-value-was-entered/31029700#31029700", "title": "Running VBA code only after a specific input value was entered", "body": "<p>You can use the given code in your Worksheet module. The main line here is <code>If Not Intersect(Target, Me.Range(\"D20:D50\")) Is Nothing Then</code>. It says that the code will be executed only if values within <code>Range(\"D20:D50\")</code> were changed.</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    On Error GoTo errH\n    Dim cell As Range\n    If Not Intersect(Target, Me.Range(\"D20:D50\")) Is Nothing Then\n        Application.EnableEvents = False\n        For Each cell In Target\n            If cell.Value = \"New Hire\" Then\n                MsgBox \"Please Fulfill the New Hire(s) Information in the following New Hire Sheet\" &amp; vbNewLine &amp; \"Important Note\" &amp; vbNewLine &amp; \"Include the New Employee's ID and Bank documentation with Account Number information\"\n                Call NewHireForm\n            End If\n        Next\n    End If\nerrH:\n    If Err.Number &lt;&gt; 0 Then MsgBox Err.Number &amp; \" \" &amp; Err.Description\n    Application.EnableEvents = True\nEnd Sub\n</code></pre>\n\n<p>You need to open your VBE, in your Project Window choose the worksheet that you need and paste the code.</p>\n"}], "owner": {"reputation": 109, "user_id": 4363180, "user_type": "registered", "accept_rate": 33, "profile_image": "https://lh6.googleusercontent.com/-sQVzVmv0FNE/AAAAAAAAAAI/AAAAAAAAAPg/d8yd3aGERaI/photo.jpg?sz=128", "display_name": "Maxwell", "link": "https://stackoverflow.com/users/4363180/maxwell"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1411, "favorite_count": 0, "accepted_answer_id": 31029700, "answer_count": 1, "score": 1, "last_activity_date": 1435159926, "creation_date": 1435156220, "last_edit_date": 1435159926, "question_id": 31029404, "link": "https://stackoverflow.com/questions/31029404/running-vba-code-only-after-a-specific-input-value-was-entered", "title": "Running VBA code only after a specific input value was entered", "body": "<p>I'm trying to do a macro that whenever someone types \"New Hire\" in the range <code>D20:D50</code>, it would call a macro. I know I can do it with an <code>If</code> but the problem is that there are to many cells and a lot of code. I need to use <code>ByVal Target As Range</code>, because whenever they type the word I want to call a macro.</p>\n\n<pre><code>If Target.Address = \"$D$20\" Then\n\n        If Range(\"D20\").Value = \"New Hire\" Then\n\n            MsgBox \"Please Fulfill the New Hire(s) Information in the following New Hire Sheet\" &amp; vbNewLine &amp; \"Important Note\" &amp; vbNewLine &amp; \"Include the New Employee's ID and Bank documentation with Account Number information\"\n            Call NewHireForm    \n\nElseIf Target.Address = \"$D$21\" Then\n\n        If Range(\"D21\").Value = \"New Hire\" Then\n\n            MsgBox \"Please Fulfill the New Hire(s) Information in the following New Hire Sheet\" &amp; vbNewLine &amp; \"Important Note\" &amp; vbNewLine &amp; \"Include the New Employee's ID and Bank documentation with Account Number information\"\n            Call NewHireForm\n</code></pre>\n\n<p>You see, it's not simplified. Is there a way to whenever they type \"New Hire\" in range <code>D20</code> to <code>D50</code> to make the event?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 0, "creation_date": 1435155833, "post_id": 31029161, "comment_id": 50083000, "body": "Welcome to SO! Reading <a href=\"http://stackoverflow.com/help/how-to-ask\">how to ask a good question</a> will help you get an answer sooner. Remember, this isn&#39;t a code-writing service, so post what you&#39;ve got &amp; we can help you fix it."}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 1, "creation_date": 1435155992, "post_id": 31029161, "comment_id": 50083164, "body": "did you try Range(&quot;Short&quot;)?"}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "reply_to_user": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 1, "creation_date": 1435156035, "post_id": 31029161, "comment_id": 50083200, "body": "You can refer to range(C &amp; i) using Cells(i,3) - row i, column 3 (for a single cell).       When you say you&#39;ve named them - do you mean a <b>Named Range</b> in which case @John comment should work."}, {"owner": {"reputation": 35, "user_id": 4114808, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/13bfc5b4832d3a76ba377e5b5ef2fd34?s=128&d=identicon&r=PG&f=1", "display_name": "starter1011", "link": "https://stackoverflow.com/users/4114808/starter1011"}, "reply_to_user": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1435156380, "post_id": 31029161, "comment_id": 50083491, "body": "@JohnColeman :Hey, yeah I&#39;ve tried that and I get the following error:  &quot;Run-time error &#39;1004&#39;:  Method &#39;Range&#39; of object &#39;_Global&#39; failed"}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 1, "creation_date": 1435157180, "post_id": 31029161, "comment_id": 50084080, "body": "@starter1011 what do you mean by &quot;named&quot; in &quot;I named Column A &#39;Short&#39;&quot;? I assumed that you meant you were using named ranges, but it sounds like you just entered the value &quot;Short&quot; in the first cell. To name the range -- you need to select the range you want to name, navigate to the formulas tab, and click on &quot;Define Name&quot;"}, {"owner": {"reputation": 35, "user_id": 4114808, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/13bfc5b4832d3a76ba377e5b5ef2fd34?s=128&d=identicon&r=PG&f=1", "display_name": "starter1011", "link": "https://stackoverflow.com/users/4114808/starter1011"}, "reply_to_user": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1435157447, "post_id": 31029161, "comment_id": 50084262, "body": "@JohnColeman : Yes I named it, as in, I defined it as you said."}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1435158164, "post_id": 31029161, "comment_id": 50084787, "body": "@starter1011 check spelling if it is still giving you that error. Open up the name manager and see what you have. It is maybe possible that the name has the wrong scope e.g. it is scoped as a sheet1 name and you are trying to use it in sheet2."}], "answers": [{"tags": [], "owner": {"reputation": 203, "user_id": 2637388, "user_type": "registered", "profile_image": "https://graph.facebook.com/284202480/picture?type=large", "display_name": "Adam Frederick Wiseman", "link": "https://stackoverflow.com/users/2637388/adam-frederick-wiseman"}, "is_accepted": false, "score": 1, "last_activity_date": 1435160245, "creation_date": 1435160245, "answer_id": 31030936, "question_id": 31029161, "link": "https://stackoverflow.com/questions/31029161/referring-to-columns-by-their-names-in-vba/31030936#31030936", "title": "Referring to columns by their names in VBA", "body": "<p>So long as your data is within a table (these can be defined with Ctrl+T), you could reference cells with:</p>\n\n<pre><code>TableName[ColumnName]\n</code></pre>\n\n<p>For instance, if your table was called <code>DataTable</code>, you could use <code>DataTable[Short]</code> to get the <em>Short</em> column.</p>\n\n<p>Usage in VBA would be: <code>Range(\"DataTable[Short]\")</code></p>\n\n<p>More information is available <a href=\"https://support.office.com/en-us/article/Using-structured-references-with-Excel-tables-f5ed2452-2337-4f71-bed3-c8ae6d2b276e\" rel=\"nofollow\">here</a>.</p>\n"}], "owner": {"reputation": 35, "user_id": 4114808, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/13bfc5b4832d3a76ba377e5b5ef2fd34?s=128&d=identicon&r=PG&f=1", "display_name": "starter1011", "link": "https://stackoverflow.com/users/4114808/starter1011"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 296, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1435160245, "creation_date": 1435155605, "last_edit_date": 1435156619, "question_id": 31029161, "link": "https://stackoverflow.com/questions/31029161/referring-to-columns-by-their-names-in-vba", "title": "Referring to columns by their names in VBA", "body": "<p>I have three columns of data. I've named column A, \"Short,\" column B \"Long,\" and column C: \"Position.\" </p>\n\n<p>In my VBA code, I refer to data in Column C as: Range(\"C\"&amp;i) (where i is the row number). </p>\n\n<p>How do I refer to column C as I've titled it in my macro?</p>\n\n<p>Any suggestions are welcome, thanks!</p>\n\n<p>This is my current code:</p>\n\n<pre><code>Sub NestedIf()\ni = 2\n\nDim uLimit As Integer\nDim lLimit As Integer\n\nuLimit = Range(\"e\" &amp; 1)\nlLimit = Range(\"e\" &amp; 2)\n\nDo\n    If Range(\"c\" &amp; i) &gt;= 0 Then\n        If Abs(Range(\"c\" &amp; i)) &lt;= uLimit Then\n            If Abs(Range(\"c\" &amp; i)) &gt;= lLimit Then\n                Range(\"b\" &amp; i) = Abs(Range(\"c\" &amp; i))\n            Else\n                Range(\"b\" &amp; i) = lLimit\n            End If\n        Else\n            Range(\"b\" &amp; i) = uLimit\n        End If\n    Else\n        Range(\"b\" &amp; i) = 0\n    End If\n\n    If Range(\"c\" &amp; i) &lt;= 0 Then\n        If Abs(Range(\"c\" &amp; i)) &lt;= uLimit Then\n            If Abs(Range(\"c\" &amp; i)) &gt;= lLimit Then\n                Range(\"a\" &amp; i) = Abs(Range(\"c\" &amp; i))\n            Else\n                Range(\"a\" &amp; i) = lLimit\n            End If\n    Else\n        Range(\"a\" &amp; i) = uLimit\n    End If\nElse\n    Range(\"a\" &amp; i) = 0\nEnd If\n\n    i = i + 1\nLoop Until IsEmpty(Range(\"c\" &amp; i))\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 4848131, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-_QoG7S10hBk/AAAAAAAAAAI/AAAAAAAAF64/Gle10Mz7JbI/photo.jpg?sz=128", "display_name": "H C", "link": "https://stackoverflow.com/users/4848131/h-c"}, "edited": false, "score": 0, "creation_date": 1435159702, "post_id": 31029384, "comment_id": 50085994, "body": "thank you Rory for your help.  Could you kindly explain to me the line 5 on what you did there?"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "reply_to_user": {"reputation": 13, "user_id": 4848131, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-_QoG7S10hBk/AAAAAAAAAAI/AAAAAAAAF64/Gle10Mz7JbI/photo.jpg?sz=128", "display_name": "H C", "link": "https://stackoverflow.com/users/4848131/h-c"}, "edited": false, "score": 0, "creation_date": 1435236217, "post_id": 31029384, "comment_id": 50122361, "body": "I test if the cell in question is blank (should only happen for the first row) and if not, go one row down."}], "tags": [], "owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "is_accepted": true, "score": 0, "last_activity_date": 1435156168, "creation_date": 1435156168, "answer_id": 31029384, "question_id": 31029107, "link": "https://stackoverflow.com/questions/31029107/vba-event-handler-for-wookrsheet-beforedoublelcick/31029384#31029384", "title": "VBA Event handler for wookrsheet_beforedoublelcick", "body": "<p>You don't really need a loop:</p>\n\n<pre><code>Private Sub Worksheet_BeforeDoubleClick(ByVal Target As Excel.Range, Cancel As Boolean)\n\nDim rgOut as Range\nIf Target.Column = 1 then\nSet rgOut = Cells(Rows.Count, \"B\").End(xlUp)\nif len(rgOut.formula) &lt;&gt; 0 then set rgOut = rgOut.Offset(1)\n\nrgOut.Value = Target.Value\nEnd If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 4848131, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-_QoG7S10hBk/AAAAAAAAAAI/AAAAAAAAF64/Gle10Mz7JbI/photo.jpg?sz=128", "display_name": "H C", "link": "https://stackoverflow.com/users/4848131/h-c"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 33, "favorite_count": 0, "accepted_answer_id": 31029384, "answer_count": 1, "score": 0, "last_activity_date": 1435156168, "creation_date": 1435155442, "last_edit_date": 1435155998, "question_id": 31029107, "link": "https://stackoverflow.com/questions/31029107/vba-event-handler-for-wookrsheet-beforedoublelcick", "title": "VBA Event handler for wookrsheet_beforedoublelcick", "body": "<p>Hi i am trying to write up a tool so that when i double click any cell on column a it will populate in column b. Column a will have many different rows of different string and i want to be able to simply double click on any cell to have it populated on column b.</p>\n\n<p>i.e; i would click on cell a1,a5,a8, a111 and these 4 cells clicked will appear on column b1, b2,b3,b4</p>\n\n<p>I know that i am missing a loop, but i cant seem to figure out where i am suppose to put it </p>\n\n<pre><code>Private Sub Worksheet_BeforeDoubleClick(ByVal Target As Excel.Range, Cancel As Boolean)\n\nx = 1\n\n\nsel = Target.Value\n\nCells(x, 2).Value = sel\n\nx = x + 1\n\nCancel = False\n\nEnd Sub\n</code></pre>\n\n<p>Thanks in advanced</p>\n"}, {"tags": ["vba", "ms-access", "ms-access-2010"], "comments": [{"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 1, "creation_date": 1435156246, "post_id": 31028937, "comment_id": 50083371, "body": "Generally the message for error #3075 includes more information.  Did you include the full text of the error message?"}], "answers": [{"comments": [{"owner": {"reputation": 81, "user_id": 4910446, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/10153847416797067/picture?type=large", "display_name": "Keneth Walters", "link": "https://stackoverflow.com/users/4910446/keneth-walters"}, "edited": false, "score": 0, "creation_date": 1435156475, "post_id": 31029246, "comment_id": 50083577, "body": "Do While Not rst.EOF     &#39;Get PendigOrder Used     Available = GetAvailable(rst![Item #])     If Available = 0 Then         NextTemp = rst!Qty * -1     &#39;ElseIf Available &gt;= rst!Qty Then     Else         NextTemp = Available - rst!Qty         &#39;ava = NextTemp     End If   DoCmd.RunSQL (&quot;INSERT INTO Pending_Orders (Customer, ItemNumber, Description,   Qty, [Order #], Temp, ShipDate) VALUES (&quot; &amp; _&quot;&#39;&quot; &amp; Replace(rst!Customer, &quot;&#39;&quot;, &quot;&#39;&#39;&quot;) &amp; &quot;&#39;,&#39;&quot; &amp; rst![Item #] &amp; &quot;&#39;,&#39;&quot; &amp; rst!Description &amp; &quot;&#39;,&quot; &amp; rst!Qty &amp; &quot;,&#39;&quot; &amp; rst![Order #] &amp; &quot;&#39;,&quot; &amp; NextTemp &amp; &quot;,#&quot; &amp; rst![Ship Date] &amp; &quot;#)&quot;)"}, {"owner": {"reputation": 5550, "user_id": 1732204, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/X4pln.png?s=128&g=1", "display_name": "PaulFrancis", "link": "https://stackoverflow.com/users/1732204/paulfrancis"}, "reply_to_user": {"reputation": 81, "user_id": 4910446, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/10153847416797067/picture?type=large", "display_name": "Keneth Walters", "link": "https://stackoverflow.com/users/4910446/keneth-walters"}, "edited": false, "score": 0, "creation_date": 1435156505, "post_id": 31029246, "comment_id": 50083607, "body": "Please edit your original post. Code doe snot come well with comments."}], "tags": [], "owner": {"reputation": 5550, "user_id": 1732204, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/X4pln.png?s=128&g=1", "display_name": "PaulFrancis", "link": "https://stackoverflow.com/users/1732204/paulfrancis"}, "is_accepted": false, "score": 0, "last_activity_date": 1435155848, "creation_date": 1435155848, "answer_id": 31029246, "question_id": 31028937, "link": "https://stackoverflow.com/questions/31028937/runtime-error-3075-missing-operator/31029246#31029246", "title": "Runtime error 3075 missing operator", "body": "<p>I would suggest you to replace the single quotes in the above code to double quotes, this is one common problem with names like Paul O'Connor. Also use CurrentDb.Execute over DoCmd.RunSQL. As using currentBD you can suppress the annoying messages and see many more information. Finally, always use a String to get the SQL query, so debugging could be a lot easier. </p>\n\n<p>Try the following,</p>\n\n<pre><code>strSQL = \"INSERT INTO Pending_Orders (Customer, ItemNumber, Description, Qty, [Order #], \" &amp; _\n         \"Temp, ShipDate) VALUES (\" &amp; Chr(34) &amp; rst!Customer &amp; Chr(34) &amp; _\n         \", \" &amp; Chr(34) &amp; rst![Item #] &amp; Chr(34) &amp; _\n         \", \" &amp; Chr(34) &amp; rst!Description &amp; Chr(34) &amp; _\n         \", \" &amp; rst![Qty] &amp; \", \" &amp; Chr(34) &amp; rst![Order #] &amp; Chr(34) &amp; _\n         \", \" &amp; NextTemp &amp; \", \" &amp; Format(rst![Ship Date], \"\\#mm\\/dd\\/yyyy\\#\") &amp; \")\n\nCurrentDB.Execute strSQL \n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "is_accepted": false, "score": 0, "last_activity_date": 1435182508, "creation_date": 1435182508, "answer_id": 31037702, "question_id": 31028937, "link": "https://stackoverflow.com/questions/31028937/runtime-error-3075-missing-operator/31037702#31037702", "title": "Runtime error 3075 missing operator", "body": "<p>In addition to Paul Francis answer, I offer the EscapeDBstring function which solves the problem of the embedded quote in \"Paul O'Connor\" by escaping the embedded quote:</p>\n\n<pre><code>' dbEscapeString -- escape the single quote in a string that will be included in\n'                   an SQL statement. The single quote is the database/SQL string delimiter.\nPublic Function dbEscapeString(ByVal s)\nDim i\n    i = 1\n    While (i &lt;= Len(s))\n        If (Mid(s, i, 1) = \"'\") Then\n            'If (Mid(s, i + 1, 1) = \"'\") Then   ' this would consider two single quotes to be escaped already\n            '    i = i + 1\n            'Else\n                s = Mid(s, 1, i) + Mid(s, i)\n                i = i + 1\n            'End If\n        End If\n        i = i + 1\n    Wend\n    dbEscapeString = s\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 81, "user_id": 4910446, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/10153847416797067/picture?type=large", "display_name": "Keneth Walters", "link": "https://stackoverflow.com/users/4910446/keneth-walters"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 174, "favorite_count": 0, "answer_count": 2, "score": 3, "last_activity_date": 1435182508, "creation_date": 1435155043, "question_id": 31028937, "link": "https://stackoverflow.com/questions/31028937/runtime-error-3075-missing-operator", "title": "Runtime error 3075 missing operator", "body": "<p>When I am using ms access 2007 it works perfectly. I swtich to ms access 2010 and now it does not work.</p>\n\n<pre><code> DoCmd.RunSQL (\"INSERT INTO Pending_Orders (Customer, ItemNumber, Description,   Qty, [Order #], Temp, ShipDate) VALUES (\" &amp; _\n  \"'\" &amp; Replace(rst!Customer, \"'\", \"''\") &amp; \"','\" &amp; rst![Item #] &amp; \"','\" &amp; rst!Description &amp; \"',\" &amp; rst!Qty &amp; \",'\" &amp; rst![Order #] &amp; \"',\" &amp; NextTemp &amp; \",#\" &amp; rst![Ship Date] &amp; \"#)\")\n</code></pre>\n\n<p>I am getting this error now.</p>\n\n<p>What it could be?</p>\n"}, {"tags": ["excel", "vba", "filedialog"], "owner": {"reputation": 131, "user_id": 3664452, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9e732d5d78f101498371b2ef5a90b95c?s=128&d=identicon&r=PG&f=1", "display_name": "user3664452", "link": "https://stackoverflow.com/users/3664452/user3664452"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 102, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1435155593, "creation_date": 1435154422, "last_edit_date": 1435155593, "question_id": 31028693, "link": "https://stackoverflow.com/questions/31028693/opening-order-in-msofiledialogopen", "title": "opening order in msoFileDialogOpen", "body": "<p>I wrote a macro that asks me to open some files, and then it runs more macros depending on files' names.</p>\n\n<pre><code>With Application.FileDialog(msoFileDialogOpen)\n.ButtonName = \"Seleziona\"\n.InitialView = msoFileDialogViewList\n.AllowMultiSelect = True\n.Filters.Add \"File Excel\", \"*.xls\", 1\n.InitialFileName = \"\\\\SERVER-PDC\\Archivi\\DOCUMENTI SU SERVER\\LAURA\\\"\n.Title = \"Seleziona i file: corpi, mancanti, montaggio, pressa. Questa \u00e8 la settimana numero \" &amp; Format(Date, \"ww\")\n.Show\nOn Error GoTo Erroremultiselezione\n     For Each vrtSelectedItem In .SelectedItems\n        Workbooks.Open Filename:=vrtSelectedItem, CorruptLoad:=xlRepairFile\n        Application.DisplayAlerts = False\n        ActiveWorkbook.SaveAs Filename:=vrtSelectedItem, FileFormat:=xlExcel8\n        If Left(ActiveWorkbook.Name, 5) = \"monta\" Then\n            Application.Run \"pacchetto_rev7.xls!Montaggio\"\n        ElseIf Left(ActiveWorkbook.Name, 5) = \"corpi\" Then\n            Application.Run \"pacchetto_rev7.xls!Corpi\"\n        ElseIf Left(ActiveWorkbook.Name, 5) = \"press\" Then\n            Application.Run \"pacchetto_rev7.xls!Pressacoll\"\n        ElseIf Left(ActiveWorkbook.Name, 5) = \"manca\" Then\n            Application.Run \"pacchetto_rev7.xls!Missing\"\n        Else: GoTo Erroremultiselezione\n        End If\n    Next vrtSelectedItem\nEnd With  \n[more code follows]\n</code></pre>\n\n<p>When the file dialog asks, I select three files while pressing and holding down the Ctrl button: montaggio.xls, pressa.xls, corpi.xls</p>\n\n<p>I can select the pressa.xls as first file, or as the second one, or as the third one, but it always opens first.  Why? </p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 4362, "user_id": 3890586, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/uk42f.png?s=128&g=1", "display_name": "AnalystCave.com", "link": "https://stackoverflow.com/users/3890586/analystcave-com"}, "edited": false, "score": 0, "creation_date": 1435156331, "post_id": 31028620, "comment_id": 50083449, "body": "Thx for fixing the code  :). Hope the general idea helped you"}], "tags": [], "owner": {"reputation": 4362, "user_id": 3890586, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/uk42f.png?s=128&g=1", "display_name": "AnalystCave.com", "link": "https://stackoverflow.com/users/3890586/analystcave-com"}, "is_accepted": true, "score": 4, "last_activity_date": 1435156285, "last_edit_date": 1435156285, "creation_date": 1435154220, "answer_id": 31028620, "question_id": 31028432, "link": "https://stackoverflow.com/questions/31028432/disable-macro-buttons-when-sheet-is-protected/31028620#31028620", "title": "Disable macro buttons when sheet is protected?", "body": "<p>Implement this at the beginning of every macro associated with buttons:</p>\n\n<pre><code>If Activesheet.ProtectContents = True Then \n  Exit Sub\nEnd if\n</code></pre>\n"}], "owner": {"reputation": 12496, "user_id": 1283776, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/abb815001c365007d50d2bdb3226e70a?s=128&d=identicon&r=PG", "display_name": "user1283776", "link": "https://stackoverflow.com/users/1283776/user1283776"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2227, "favorite_count": 0, "accepted_answer_id": 31028620, "answer_count": 1, "score": 0, "last_activity_date": 1435156285, "creation_date": 1435153722, "question_id": 31028432, "link": "https://stackoverflow.com/questions/31028432/disable-macro-buttons-when-sheet-is-protected", "title": "Disable macro buttons when sheet is protected?", "body": "<p>I am using shapes as macro buttons in Excel.</p>\n\n<p>Even when a sheet is protected, users can click on the buttons in that sheet.</p>\n\n<p>Is it possible to make it so that buttons become \"disabled\" when the sheet is protected?</p>\n"}, {"tags": ["vba", "solidworks"], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 5339079, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/bd7a0b35263b72995d6f48cc912e05dd?s=128&d=identicon&r=PG", "display_name": "GamingHeaven", "link": "https://stackoverflow.com/users/5339079/gamingheaven"}, "is_accepted": false, "score": 1, "last_activity_date": 1442340398, "last_edit_date": 1442340398, "creation_date": 1442337698, "answer_id": 32592061, "question_id": 31028425, "link": "https://stackoverflow.com/questions/31028425/solidworks-vba-save-as-new-name/32592061#32592061", "title": "Solidworks VBA save as new name", "body": "<p>Try the below approach:</p>\n\n<pre><code>Dim FileName As String\nFileName = \"blablabla\" &amp; Variable &amp; \"blablabla\"\nswModel.SaveAs3 (\"C:\\User\\Username\\Desktop\" + FileName + \".SLDPRT\", 0, 1)\n\nVariable = Variable + 1\n'continue with your loop\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 5044816, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/22b46166df8fb7eb9c4b3bc24042737c?s=128&d=identicon&r=PG&f=1", "display_name": "PenguinP", "link": "https://stackoverflow.com/users/5044816/penguinp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3457, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1442340398, "creation_date": 1435153713, "last_edit_date": 1435156752, "question_id": 31028425, "link": "https://stackoverflow.com/questions/31028425/solidworks-vba-save-as-new-name", "title": "Solidworks VBA save as new name", "body": "<p>I am currently generating a solidworks part file name from a text document for a batch \"rename\" of the documents. This assigns sequential numbers to them which i then save each part in a folder as. I have been trying to figure out a method for the new file names to be referenced in the assembly they were a part of.</p>\n\n<p>For saving the document I am using :  </p>\n\n<pre><code>swModel.SaveAs3 \"\" &amp; FileName &amp; \"\", 0, 0\n</code></pre>\n\n<p>I have no issue creating all the files in a batch but I could not seem to find a method of apply this save in such a way that any open documents that it is referenced in change to referencing the new part name.  </p>\n\n<p>Edit: I figured out a serviceable solution using some of the information held in this link:  </p>\n\n<p><a href=\"http://help.solidworks.com/2011/English/api/sldworksapi/pack_and_go_an_assembly_example_vb.htm\" rel=\"nofollow\">help.solidworks</a>  </p>\n\n<p>Using the pack and go functionality in solidworks avoids having to deal with the references as they are already handled by the process itself Hope this helps.</p>\n"}, {"tags": ["ms-access", "vba", "ms-access-2010"], "comments": [{"owner": {"reputation": 13431, "user_id": 2169762, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Nns8w.png?s=128&g=1", "display_name": "Martin", "link": "https://stackoverflow.com/users/2169762/martin"}, "edited": false, "score": 2, "creation_date": 1435153911, "post_id": 31028333, "comment_id": 50081474, "body": "What&#39;s to stop you just setting the textbox to the path in your <code>Form_Load</code> code?  Am I missing something here?"}, {"owner": {"reputation": 1926, "user_id": 992660, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/8c0282d3af4d0d388ba24e32e71ca66b?s=128&d=identicon&r=PG", "display_name": "John Bingham", "link": "https://stackoverflow.com/users/992660/john-bingham"}, "edited": false, "score": 0, "creation_date": 1435206017, "post_id": 31028333, "comment_id": 50105513, "body": "Should Application.CurrentProject.Path be Application.CurrentDB.Path? Over-and-above this, I think you need to provide the structure and some example content of tblBackendFiles, in order for someone to help."}, {"owner": {"reputation": 2322, "user_id": 2140244, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/MIRfV.png?s=128&g=1", "display_name": "Matt Hall", "link": "https://stackoverflow.com/users/2140244/matt-hall"}, "edited": false, "score": 0, "creation_date": 1435246915, "post_id": 31028333, "comment_id": 50131037, "body": "So does the path come from the <code>Setting</code> field in your <code>tblBackendFiles</code> table? Is the textbox on your pictured subform called <code>tVerificationPath</code>? Is the <code>load</code> event you&#39;ve posted taken from the main form or the subform? If it&#39;s the main form, then any controls that are on the subform can&#39;t be referenced <code>Me.myControlName</code>; you&#39;d need to something like <code>Me!mySubFormName.Form!myControlName</code>."}, {"owner": {"reputation": 203, "user_id": 3697607, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/bc5d5ff86b010dab8e8785fb142b6b3c?s=128&d=identicon&r=PG&f=1", "display_name": "Mechanical Notaprogrammer", "link": "https://stackoverflow.com/users/3697607/mechanical-notaprogrammer"}, "reply_to_user": {"reputation": 2322, "user_id": 2140244, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/MIRfV.png?s=128&g=1", "display_name": "Matt Hall", "link": "https://stackoverflow.com/users/2140244/matt-hall"}, "edited": false, "score": 0, "creation_date": 1435607912, "post_id": 31028333, "comment_id": 50261356, "body": "@MattHall The path is from <code>tblBackendfiles</code>, and the textbox is called <code>tVerificationPath</code>. I made a mistake in the question; this is a main form, not a subform."}, {"owner": {"reputation": 2322, "user_id": 2140244, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/MIRfV.png?s=128&g=1", "display_name": "Matt Hall", "link": "https://stackoverflow.com/users/2140244/matt-hall"}, "edited": false, "score": 1, "creation_date": 1435615449, "post_id": 31028333, "comment_id": 50265087, "body": "I assume your it&#39;s your <code>Me.tVerificationPath = Nz(rs!Setting, &quot;&quot;)</code> line that&#39;s not working as you expect? If that&#39;s the case have you tried <code>Debug.Print rs!setting</code> and seeing what gets printed to the immediate window? If <code>setting</code>&#39;s null, then your line will just send a zero-length string to your text box. Also, when you apply the filter <code>WHERE Code = &#39;SourceVerification&#39;</code> to your <code>tblBackendfiles</code> table, will this definitely return one record? Does it return any records at all? Test the sql in your <code>sSQL</code> string in query design to see if it runs ok and returns the result you are expecting."}], "answers": [{"tags": [], "owner": {"reputation": 8233, "user_id": 2174085, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/oMs90.jpg?s=128&g=1", "display_name": "Johnny Bones", "link": "https://stackoverflow.com/users/2174085/johnny-bones"}, "is_accepted": true, "score": 1, "last_activity_date": 1444399095, "creation_date": 1444399095, "answer_id": 33040196, "question_id": 31028333, "link": "https://stackoverflow.com/questions/31028333/show-file-path-in-access-2010-form/33040196#33040196", "title": "Show File Path in Access 2010 Form", "body": "<p>I have done this many times.  You will have to create a form.  On that form, place a textbox called \"tbFile\", another called \"tbFileName\" (which is invisible) and a button called \"bBrowse\".</p>\n\n<p>Then, behind your form, put this:</p>\n\n<pre><code>Option Compare Database\nOption Explicit\n\nPrivate Sub bBrowse_Click()\nOn Error GoTo Err_bBrowse_Click\n\n    Dim strFilter As String\n    Dim lngFlags As Long\n    Dim varFileName As Variant\n\n    Me.tbHidden.SetFocus\n\n'   strFilter = \"Access (*.mdb)\" &amp; vbNullChar &amp; \"*.mdb\" _\n'    &amp; vbNullChar &amp; \"All Files (*.*)\" &amp; vbNullChar &amp; \"*.*\"\n'    strFilter = \"Access Files (*.mdb)\" &amp; vbNullChar &amp; \"*.mdb*\"\n    strFilter = \"All Files (*.*)\" &amp; vbNullChar &amp; \"*.*\"\n\n    lngFlags = tscFNPathMustExist Or tscFNFileMustExist Or tscFNHideReadOnly\n\n    varFileName = tsGetFileFromUser( _\n    fOpenFile:=True, _\n    strFilter:=strFilter, _\n    rlngflags:=lngFlags, _\n    strInitialDir:=\"C:\\Windows\\\", _\n    strDialogTitle:=\"Find File (Select The File And Click The Open Button)\")\n    'remove the strInitialDir:=\"C:\\Windows\\\", _ line if you do not want the Browser to open at a specific location\n\n    If IsNull(varFileName) Or varFileName = \"\" Then\n        Debug.Print \"User pressed 'Cancel'.\"\n        Beep\n        MsgBox \"File selection was canceled.\", vbInformation\n        Exit Sub\n    Else\n        'Debug.Print varFileName\n        tbFile = varFileName\n    End If\n\n    Call ParseFileName\n\nExit_bBrowse_Click:\n    Exit Sub\n\nErr_bBrowse_Click:\n    MsgBox Err.Number &amp; \" - \" &amp; Err.Description\n    Resume Exit_bBrowse_Click\n\nEnd Sub\n\nPrivate Function ParseFileName()\nOn Error GoTo Err_ParseFileName\n\n    Dim sFullName As String\n    Dim sFilePathOnly As String\n    Dim sDrive As String\n    Dim sPath As String\n    Dim sLocation As String\n    Dim sFileName As String\n\n    sFullName = tbFile.Value\n\n    ' Find the final \"\\\" in the path.\n    sPath = sFullName\n\n    Do While Right$(sPath, 1) &lt;&gt; \"\\\"\n    sPath = Left$(sPath, Len(sPath) - 1)\n    Loop\n\n    ' Find the Drive.\n    sDrive = Left$(sFullName, InStr(sFullName, \":\") + 1)\n    'tbDrive = sDrive\n\n    ' Find the Location.\n    sLocation = Mid$(sPath, Len(sDrive) - 2)\n    'tbLocation = sLocation\n\n    ' Find the Path.\n    sPath = Mid$(sPath, Len(sDrive) + 1)\n    'tbPath = sPath\n\n    ' Find the file name.\n    sFileName = Mid$(sFullName, Len(sPath) + 4)\n    tbFileName = sFileName\n\nExit_ParseFileName:\n    Exit Function\n\nErr_ParseFileName:\n    MsgBox Err.Number &amp; \" - \" &amp; Err.Description\n    Resume Exit_ParseFileName\n\nEnd Function\n</code></pre>\n\n<p>Then, create a new Module and paste this into it:</p>\n\n<pre><code>Option Compare Database\nOption Explicit\n\nPrivate Declare Function ts_apiGetOpenFileName Lib \"comdlg32.dll\" _\n Alias \"GetOpenFileNameA\" (tsFN As tsFileName) As Boolean\n\nPrivate Declare Function ts_apiGetSaveFileName Lib \"comdlg32.dll\" _\n Alias \"GetSaveFileNameA\" (tsFN As tsFileName) As Boolean\n\nPrivate Declare Function CommDlgExtendedError Lib \"comdlg32.dll\" () As Long\n\nPrivate Type tsFileName\n   lStructSize As Long\n   hwndOwner As Long\n   hInstance As Long\n   strFilter As String\n   strCustomFilter As String\n   nMaxCustFilter As Long\n   nFilterIndex As Long\n   strFile As String\n   nMaxFile As Long\n   strFileTitle As String\n   nMaxFileTitle As Long\n   strInitialDir As String\n   strTitle As String\n   flags As Long\n   nFileOffset As Integer\n   nFileExtension As Integer\n   strDefExt As String\n   lCustData As Long\n   lpfnHook As Long\n   lpTemplateName As String\nEnd Type\n\n' Flag Constants\nPublic Const tscFNAllowMultiSelect = &amp;H200\nPublic Const tscFNCreatePrompt = &amp;H2000\nPublic Const tscFNExplorer = &amp;H80000\nPublic Const tscFNExtensionDifferent = &amp;H400\nPublic Const tscFNFileMustExist = &amp;H1000\nPublic Const tscFNPathMustExist = &amp;H800\nPublic Const tscFNNoValidate = &amp;H100\nPublic Const tscFNHelpButton = &amp;H10\nPublic Const tscFNHideReadOnly = &amp;H4\nPublic Const tscFNLongNames = &amp;H200000\nPublic Const tscFNNoLongNames = &amp;H40000\nPublic Const tscFNNoChangeDir = &amp;H8\nPublic Const tscFNReadOnly = &amp;H1\nPublic Const tscFNOverwritePrompt = &amp;H2\nPublic Const tscFNShareAware = &amp;H4000\nPublic Const tscFNNoReadOnlyReturn = &amp;H8000\nPublic Const tscFNNoDereferenceLinks = &amp;H100000\n\nPublic Function tsGetFileFromUser( _\n    Optional ByRef rlngflags As Long = 0&amp;, _\n    Optional ByVal strInitialDir As String = \"\", _\n    Optional ByVal strFilter As String = \"All Files (*.*)\" &amp; vbNullChar &amp; \"*.*\", _\n    Optional ByVal lngFilterIndex As Long = 1, _\n    Optional ByVal strDefaultExt As String = \"\", _\n    Optional ByVal strFileName As String = \"\", _\n    Optional ByVal strDialogTitle As String = \"\", _\n    Optional ByVal fOpenFile As Boolean = True) As Variant\nOn Error GoTo tsGetFileFromUser_Err\n\n    Dim tsFN As tsFileName\n    Dim strFileTitle As String\n    Dim fResult As Boolean\n\n    ' Allocate string space for the returned strings.\n    strFileName = Left(strFileName &amp; String(256, 0), 256)\n    strFileTitle = String(256, 0)\n\n    ' Set up the data structure before you call the function\n    With tsFN\n        .lStructSize = Len(tsFN)\n        .hwndOwner = Application.hWndAccessApp\n        .strFilter = strFilter\n        .nFilterIndex = lngFilterIndex\n        .strFile = strFileName\n        .nMaxFile = Len(strFileName)\n        .strFileTitle = strFileTitle\n        .nMaxFileTitle = Len(strFileTitle)\n        .strTitle = strDialogTitle\n        .flags = rlngflags\n        .strDefExt = strDefaultExt\n        .strInitialDir = strInitialDir\n        .hInstance = 0\n        .strCustomFilter = String(255, 0)\n        .nMaxCustFilter = 255\n        .lpfnHook = 0\n    End With\n\n    ' Call the function in the windows API\n    If fOpenFile Then\n        fResult = ts_apiGetOpenFileName(tsFN)\n    Else\n        fResult = ts_apiGetSaveFileName(tsFN)\n    End If\n\n    ' If the function call was successful, return the FileName chosen\n    ' by the user.  Otherwise return null.  Note, the CancelError property\n    ' used by the ActiveX Common Dialog control is not needed.  If the\n    ' user presses Cancel, this function will return Null.\n    If fResult Then\n        rlngflags = tsFN.flags\n        tsGetFileFromUser = tsTrimNull(tsFN.strFile)\n    Else\n        tsGetFileFromUser = Null\n    End If\n\ntsGetFileFromUser_End:\n    On Error GoTo 0\n    Exit Function\n\ntsGetFileFromUser_Err:\n    Beep\n    MsgBox Err.Description, , \"Error: \" &amp; Err.Number _\n    &amp; \" in function basBrowseFiles.tsGetFileFromUser\"\n    Resume tsGetFileFromUser_End\n\nEnd Function\n\n' Trim Nulls from a string returned by an API call.\nPrivate Function tsTrimNull(ByVal strItem As String) As String\nOn Error GoTo tsTrimNull_Err\n    Dim I As Integer\n\n    I = InStr(strItem, vbNullChar)\n    If I &gt; 0 Then\n        tsTrimNull = Left(strItem, I - 1)\n    Else\n        tsTrimNull = strItem\n    End If\n\ntsTrimNull_End:\n    On Error GoTo 0\n    Exit Function\n\ntsTrimNull_Err:\n    Beep\n    MsgBox Err.Description, , \"Error: \" &amp; Err.Number _\n    &amp; \" in function basBrowseFiles.tsTrimNull\"\n    Resume tsTrimNull_End\n\nEnd Function\n\nPublic Sub tsGetFileFromUserTest()\nOn Error GoTo tsGetFileFromUserTest_Err\n\n    Dim strFilter As String\n    Dim lngFlags As Long\n    Dim varFileName As Variant\n\n'   strFilter = \"Access (*.mdb)\" &amp; vbNullChar &amp; \"*.mdb\" _\n'    &amp; vbNullChar &amp; \"All Files (*.*)\" &amp; vbNullChar &amp; \"*.*\"\n    strFilter = \"All Files (*.*)\" &amp; vbNullChar &amp; \"*.*\"\n\n    lngFlags = tscFNPathMustExist Or tscFNFileMustExist Or tscFNHideReadOnly\n\n    varFileName = tsGetFileFromUser( _\n    fOpenFile:=True, _\n    strFilter:=strFilter, _\n    rlngflags:=lngFlags, _\n    strDialogTitle:=\"GetFileFromUser Test (Please choose a file)\")\n\n    If IsNull(varFileName) Then\n        Debug.Print \"User pressed 'Cancel'.\"\n    Else\n        Debug.Print varFileName\n        'Forms![Form1]![Text1] = varFileName\n    End If\n\n    If varFileName &lt;&gt; \"\" Then MsgBox \"You selected the '\" &amp; varFileName &amp; \"' file.\", vbInformation\n\ntsGetFileFromUserTest_End:\n    On Error GoTo 0\n    Exit Sub\n\ntsGetFileFromUserTest_Err:\n    Beep\n    MsgBox Err.Description, , \"Error: \" &amp; Err.Number _\n     &amp; \" in sub basBrowseFiles.tsGetFileFromUserTest\"\n    Resume tsGetFileFromUserTest_End\n\nEnd Sub\n</code></pre>\n\n<p>VOILA!  Easy as that.  ;o)</p>\n"}], "owner": {"reputation": 203, "user_id": 3697607, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/bc5d5ff86b010dab8e8785fb142b6b3c?s=128&d=identicon&r=PG&f=1", "display_name": "Mechanical Notaprogrammer", "link": "https://stackoverflow.com/users/3697607/mechanical-notaprogrammer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 793, "favorite_count": 0, "accepted_answer_id": 33040196, "answer_count": 1, "score": 2, "last_activity_date": 1444405498, "creation_date": 1435153465, "last_edit_date": 1444405498, "question_id": 31028333, "link": "https://stackoverflow.com/questions/31028333/show-file-path-in-access-2010-form", "title": "Show File Path in Access 2010 Form", "body": "<p>I have a form in Access 2010 that allows the user to find an Excel file and map it so that it can easily be accessed from another form. The simplest way to explain it, I think, is with a picture:</p>\n\n<p><img src=\"https://i.stack.imgur.com/iurEh.png\" alt=\"Mapping Form\"></p>\n\n<p>The form has this <code>On Load</code> event:</p>\n\n<pre><code>Private Sub Form_Load()\n\nDim db As DAO.Database\nDim rs As DAO.Recordset\nDim sSQL As String\nDim sPath As String\nSet db = CurrentDb\n\nOn Error GoTo Error_Handler\n\nsPath = Application.CurrentProject.Path\n\nsSQL = \"Select Setting from tblBackendFiles where Code = 'SourceVerification'\"\nSet rs = db.OpenRecordset(sSQL)\nMe.tVerificationPath = Nz(rs!Setting, \"\")\nIf Len(Me.tVerificationPath) = 0 Then\n    Me.tExcelPath = sPath\nEnd If\nMe.cmdAcceptPath.SetFocus\nrs.Close\n\nGoTo exit_sub\n\nError_Handler:\nMsgBox Err.number &amp; \": \" &amp; Err.Description, vbInformation + vbOKOnly, \"Error!\"\n\nexit_sub:\nSet rs = Nothing\nSet db = Nothing\n\nEnd Sub\n</code></pre>\n\n<p>What I want is to have the current path of the Excel file displayed in the textbox, which is currently unbound. I've looked around online but I'm having a hard time finding how to actually get the path to show up. </p>\n\n<p>What would be the best way to do this? I'd prefer to do it without VBA if at all possible, but I'm not 100% opposed to it.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 1, "creation_date": 1435153741, "post_id": 31028287, "comment_id": 50081327, "body": "<code>This code works</code> makes it inappropriate for SO. It would, however, be a <b>great</b> fit for <a href=\"http://codereview.stackexchange.com/\">Code Review</a>. I&#39;d recommend posting it there for some great help."}, {"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 1, "creation_date": 1435153796, "post_id": 31028287, "comment_id": 50081367, "body": "I&#39;m voting to close this question as off-topic because it is functional code that he is looking to optimize. It belongs on Code Review."}, {"owner": {"reputation": 361, "user_id": 4914731, "user_type": "registered", "accept_rate": 73, "profile_image": "https://lh3.googleusercontent.com/-GQlW2FaTZcQ/AAAAAAAAAAI/AAAAAAAAAC4/di5KCJ4DOS4/photo.jpg?sz=128", "display_name": "Abdul Shiyas", "link": "https://stackoverflow.com/users/4914731/abdul-shiyas"}, "reply_to_user": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 0, "creation_date": 1435153925, "post_id": 31028287, "comment_id": 50081478, "body": "Okei.. I don&#39;t know about Code review.. I will post it there and delete it from here. Thanks"}], "answers": [{"tags": [], "owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "is_accepted": true, "score": 1, "last_activity_date": 1435182081, "creation_date": 1435182081, "answer_id": 31037594, "question_id": 31028287, "link": "https://stackoverflow.com/questions/31028287/excel-vba-how-to-increase-the-speed-of-this-code/31037594#31037594", "title": "EXCEL VBA: how to increase the speed of this code", "body": "<p>I am amazed that this code \"does what it needs to do\". I see the following bugs.</p>\n\n<p>Bug1: There can be only one <code>Dir()</code> open at the same time. You use two nested <code>Dir()</code>s.</p>\n\n<p>Bug2: look at the loop:</p>\n\n<pre><code>Do While filename &lt;&gt; \"\"\n    If filename = fileName1\n    ...\n    End if\n    fileName1 = filename\nLoop\n</code></pre>\n\n<p>If at the first iteration <code>filename</code> isn't equal to <code>filename1</code> then it will be at the second iteration, however, it is not assured that the file exists in <code>pathname1</code> as it has not been obtained by a call to the topmost <code>Dir()</code> (which you can't because the second <code>Dir()</code> replaced the first one).</p>\n\n<p>Maybe you should first specify what this code is supposed to do.</p>\n"}], "owner": {"reputation": 361, "user_id": 4914731, "user_type": "registered", "accept_rate": 73, "profile_image": "https://lh3.googleusercontent.com/-GQlW2FaTZcQ/AAAAAAAAAAI/AAAAAAAAAC4/di5KCJ4DOS4/photo.jpg?sz=128", "display_name": "Abdul Shiyas", "link": "https://stackoverflow.com/users/4914731/abdul-shiyas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 70, "favorite_count": 0, "accepted_answer_id": 31037594, "answer_count": 1, "score": 0, "last_activity_date": 1435182081, "creation_date": 1435153328, "last_edit_date": 1435154678, "question_id": 31028287, "link": "https://stackoverflow.com/questions/31028287/excel-vba-how-to-increase-the-speed-of-this-code", "title": "EXCEL VBA: how to increase the speed of this code", "body": "<p>This code works. Since it has too many loop, loop inside loop, this works very slowly. How can we increase the speed of this program? \nI am trying to copy a range from one file to another file of same name in different folder. I have folders named \"A\",\"B\",\"C\"...\"G\" inside \"c:\\Charts\\1\\\" &amp; \"c:\\Charts\\0\\\". Inside each folders \"A\",\"B\",\"C\"...\"G\" there are files named 1,2,3,4,..10.</p>\n\n<p>My code is like this</p>\n\n<pre><code>vArr = Array(\"A\", \"B\", \"C\", \"D\", \"E\", \"F\", \"G\")\nDim fileName1, Pathname1 As String\nPathname1 = \"c:\\Charts\\1\\\"\nPathname=\"c:\\charts\\0\\\"\nFor Each vFile1 In vArr1\n    fileName1 = Dir(Pathname1 &amp; vFile1 &amp; \"\\\" &amp; \"*.xlsx\")\n    Do While fileName1 &lt;&gt; \"\"\n        For Each vFile In vArr\n            filename = Dir(Pathname &amp; vFile &amp; \"\\\" &amp; \"*.xlsx\")\n            Do While filename &lt;&gt; \"\"\n                If filename = fileName1 Then\n                Set WB1 = Workbooks.Open(Pathname1 &amp; vFile &amp; \"\\\" &amp; fileName1)\n                    WB1.Application.ScreenUpdating = False\n                    WB1.ActiveSheet.Range(\"M1:M30\").Copy\n                    WB1.Close (False)\n                Set WBD1 = Workbooks.Open(Pathname &amp; vFile &amp; \"\\\" &amp; filename)\n                WBD1.ActiveSheet.Range(\"C1\").Select\n                    WBD1.ActiveSheet.Paste\n                    WBD1.ActiveSheet.Cells(1, 3).Value = \"HSI Q4 2014-15\"\n                    WBD1.Close (True)\n                    filename = Dir()\n                Else\n\n                End If\n                fileName1 = filename\n            Loop\n        Next\n    Loop\nNext\n</code></pre>\n\n<p>How can we make this work faster?</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4576226"}, "is_accepted": true, "score": 0, "last_activity_date": 1435849778, "creation_date": 1435849778, "answer_id": 31188331, "question_id": 31028170, "link": "https://stackoverflow.com/questions/31028170/trouble-translating-border-information-from-cell-to-custom-style/31188331#31188331", "title": "Trouble translating border information from cell to custom style", "body": "<p>By replacing (xlEdge...) with non-Edge enumerations (i.e. changing Borders(xlEdgeLeft) to Borders(xlLeft)), it completely solved the issues I've been having. In my opinion, the Microsoft definition of a Border Object needs to be elaborated to include xlLeft, xlRight, xlTop, and xlBottom enumerations as an Index option. Border Object (Excel)</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user4576226"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 43, "favorite_count": 0, "accepted_answer_id": 31188331, "answer_count": 1, "score": 0, "last_activity_date": 1435849778, "creation_date": 1435153047, "last_edit_date": 1495541745, "question_id": 31028170, "link": "https://stackoverflow.com/questions/31028170/trouble-translating-border-information-from-cell-to-custom-style", "title": "Trouble translating border information from cell to custom style", "body": "<p>SOLVED BELOW</p>\n\n<p>I've been programming a workbook to load a bunch of custom cell styles based on cell information i've entered in a ListObject table, like so:\n<img src=\"https://i.stack.imgur.com/KJqz7.jpg\" alt=\"Table\"></p>\n\n<p>Each cell has a unique configuration of formats and the hope is when i need to add more i'll just expand the list. The code I've created can handle reading the particulars of each individual cell, until it comes to the <code>Borders</code> section, then it appears to either not read it at all, or make up it's own definitions of what the Border style should be. Here's my code (sorry it's a bit long):</p>\n\n<pre><code>Dim lstStle As ListObject\nDim obj_wbk As Object\n\nFor Each obj_wbk In ActiveWorkbook.Styles\n    If obj_wbk.Name &lt;&gt; \"Normal\" Then\n        obj_wbk.Delete\n    End If\nNext obj_wbk\nSet obj_wbk = Nothing\n\nSet lstStle = Sheet1.ListObjects(1)\nFor Each obj_wbk In lstStle.DataBodyRange\n    If obj_wbk.Value2 &lt;&gt; vbNullString Then\n        ActiveWorkbook.Styles.Add Name:=obj_wbk.Value2\n        With ActiveWorkbook.Styles(obj_wbk.Value2)\n'!!!!!!!!!!!Number properties\n            .IncludeNumber = True\n            .NumberFormat = obj_wbk.NumberFormat\n'!!!!!!!!!!!Alignment properties\n            .IncludeAlignment = True\n            .HorizontalAlignment = obj_wbk.HorizontalAlignment\n            .IndentLevel = obj_wbk.IndentLevel\n            .Orientation = obj_wbk.Orientation\n            .ReadingOrder = obj_wbk.ReadingOrder\n            .ShrinkToFit = obj_wbk.ShrinkToFit\n            .VerticalAlignment = obj_wbk.VerticalAlignment\n            .WrapText = obj_wbk.WrapText\n'!!!!!!!!!!!Font properties\n            .IncludeFont = True\n            .Font.Bold = obj_wbk.Font.Bold\n            .Font.Color = obj_wbk.Font.Color\n            .Font.Italic = obj_wbk.Font.Italic\n            .Font.Name = obj_wbk.Font.Name\n            .Font.Size = obj_wbk.Font.Size\n            .Font.Strikethrough = obj_wbk.Font.Strikethrough\n            .Font.Subscript = obj_wbk.Font.Subscript\n            .Font.Superscript = obj_wbk.Font.Superscript\n            .Font.Underline = obj_wbk.Font.Underline\n'!!!!!!!!!!!Borders properties\n            .IncludeBorder = True\n            .Borders(xlEdgeLeft).Color = obj_wbk.Borders(xlEdgeLeft).Color\n            .Borders(xlEdgeTop).Color = obj_wbk.Borders(xlEdgeTop).Color\n            .Borders(xlEdgeBottom).Color = obj_wbk.Borders(xlEdgeBottom).Color\n            .Borders(xlEdgeRight).Color = obj_wbk.Borders(xlEdgeRight).Color\n            .Borders(xlEdgeLeft).LineStyle = obj_wbk.Borders(xlEdgeLeft).LineStyle\n            .Borders(xlEdgeTop).LineStyle = obj_wbk.Borders(xlEdgeTop).LineStyle\n            .Borders(xlEdgeBottom).LineStyle = obj_wbk.Borders(xlEdgeBottom).LineStyle\n            .Borders(xlEdgeRight).LineStyle = obj_wbk.Borders(xlEdgeRight).LineStyle\n            .Borders(xlEdgeLeft).Weight = obj_wbk.Borders(xlEdgeLeft).Weight\n            .Borders(xlEdgeTop).Weight = obj_wbk.Borders(xlEdgeTop).Weight\n            .Borders(xlEdgeBottom).Weight = obj_wbk.Borders(xlEdgeBottom).Weight\n            .Borders(xlEdgeRight).Weight = obj_wbk.Borders(xlEdgeRight).Weight\n'!!!!!!!!!!!Patterns/Interiors properties\n            .IncludePatterns = True\n            .Interior.Color = obj_wbk.Interior.Color\n            .Interior.Pattern = obj_wbk.Interior.Pattern\n            .Interior.PatternColor = obj_wbk.Interior.PatternColor\n'!!!!!!!!!!!Protection properties\n            .IncludeProtection = False\n        End With\n    End If\nNext obj_wbk\n</code></pre>\n\n<p>Like I said, everything else gets read and pushed into the newly created style, except the <code>Borders</code>. Have I missed something?</p>\n\n<p>UPDATE: When trying to break down this process further, I've uncovered that when I am trying to define a <code>.Borders(xlEdgeLeft)</code> property, it will accept the definition but immediately forget/change the value of said property in the next line. For example, <code>.Color</code> values may spontaneously change to 0 after assigning a non-zero number, or <code>.LineStyle</code> may spontaneously change to -4142. After that, any following <code>.Borders(...)</code> property gets nulled. I feel like this is a bug. Retrieving border item properties from a given cell seems to work, but assigning border segment properties to a custom cell style does not. Any further insight would be appreciated.</p>\n\n<p>SOLVED: I figured out a solution from finding a VSTO question with similar issues:\n<a href=\"https://stackoverflow.com/questions/13827369/excel-range-style-specifying-borders-via-vsto-doesnt-work\">Excel range Style: specifying Borders via VSTO doesn't work</a></p>\n\n<p>By replacing <code>(xlEdge...)</code> with non-Edge enumerations (i.e. changing <code>Borders(xlEdgeLeft)</code> to <code>Borders(xlLeft)</code>), it completely solved the issues I've been having. In my opinion, the Microsoft definition of a Border Object needs to be elaborated to include xlLeft, xlRight, xlTop, and xlBottom enumerations as an Index option.\n<a href=\"https://msdn.microsoft.com/en-us/library/office/ff838428.aspx\" rel=\"nofollow noreferrer\">Border Object (Excel)</a></p>\n"}, {"tags": ["vba", "excel", "if-statement", "filter"], "comments": [{"owner": {"reputation": 789, "user_id": 4596273, "user_type": "registered", "accept_rate": 59, "profile_image": "https://graph.facebook.com/816411745073346/picture?type=large", "display_name": "Ben Smith", "link": "https://stackoverflow.com/users/4596273/ben-smith"}, "reply_to_user": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 0, "creation_date": 1435153062, "post_id": 31028068, "comment_id": 50080812, "body": "I don&#39;t know, can you show me how it would work please"}, {"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 0, "creation_date": 1435153081, "post_id": 31028068, "comment_id": 50080822, "body": "I don&#39;t think it&#39;s what you need actually, removed the comment."}], "answers": [{"tags": [], "owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "is_accepted": false, "score": 3, "last_activity_date": 1435153272, "creation_date": 1435153272, "answer_id": 31028262, "question_id": 31028068, "link": "https://stackoverflow.com/questions/31028068/vba-count-the-amount-of-different-items-are-seleted-in-a-filter/31028262#31028262", "title": "VBA: Count the amount of different items are seleted in a filter", "body": "<p>Change</p>\n\n<pre><code>If ftrRegion.On Then\n</code></pre>\n\n<p>To</p>\n\n<pre><code>If ftrRegion.On And ftrRegion.Count = 1 Then\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "is_accepted": false, "score": 0, "last_activity_date": 1435153733, "creation_date": 1435153733, "answer_id": 31028438, "question_id": 31028068, "link": "https://stackoverflow.com/questions/31028068/vba-count-the-amount-of-different-items-are-seleted-in-a-filter/31028438#31028438", "title": "VBA: Count the amount of different items are seleted in a filter", "body": "<p>I haven't tested this with recent versions of Office, but it may assist:</p>\n\n<pre><code>Function GetFilterSettings(oFilter As Filter) As String\n   Dim sTemp           As String\n   With oFilter\n      If .On Then\n         If IsArray(.Criteria1) Then\n            sTemp = Join(.Criteria1, \", \")\n         Else\n            Select Case .Operator\n               Case xlAnd\n                  sTemp = .Criteria1\n                  If Len(.Criteria2) &gt; 0 Then _\n                     sTemp = sTemp &amp; \" and \" &amp; .Criteria2\n               Case xlBottom10Percent\n                  sTemp = \"Bottom n% - effectively\" &amp; .Criteria1\n               Case xlTop10Items\n                  sTemp = \"Top n items - effectively \" &amp; .Criteria1\n               Case xlBottom10Items\n                  sTemp = \"Bottom n items - effectively \" &amp; .Criteria1\n               Case xlOr\n                  sTemp = .Criteria1\n                  If Len(.Criteria2) &gt; 0 Then _\n                     sTemp = sTemp &amp; \" or \" &amp; .Criteria2\n               Case xlTop10Percent\n                  sTemp = \"Top n% - effectively \" &amp; .Criteria1\n            End Select\n         End If\n      Else\n         sTemp = \"Off\"\n      End If\n   End With\n   GetFilterSettings = sTemp\n\nEnd Function\n</code></pre>\n\n<p>So with that in a <strong>normal module</strong>, your code would become:</p>\n\n<pre><code>Dim ftrRegion As Filter\nOn Error GoTo stopError\nSet ftrArea = ActiveSheet.AutoFilter.Filters(2)\nSet ftrRegion = ActiveSheet.AutoFilter.Filters(1)\n\n    Application.EnableEvents = False\n    Range(\"E206\").Value = GetFilterSettings(ftrArea)\n    Range(\"F201\").Value = \"Region \" &amp; GetFilterSettings(ftrRegion)\n</code></pre>\n"}], "owner": {"reputation": 789, "user_id": 4596273, "user_type": "registered", "accept_rate": 59, "profile_image": "https://graph.facebook.com/816411745073346/picture?type=large", "display_name": "Ben Smith", "link": "https://stackoverflow.com/users/4596273/ben-smith"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 40, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1435153733, "creation_date": 1435152771, "question_id": 31028068, "link": "https://stackoverflow.com/questions/31028068/vba-count-the-amount-of-different-items-are-seleted-in-a-filter", "title": "VBA: Count the amount of different items are seleted in a filter", "body": "<p>In Excel I have a filter on a header, this filter allows the user to select different areas and show the records that match the areas selected. I have the following code that then displays the value that has been selected in the filter:</p>\n\n<pre><code>Dim ftrRegion As Filter\nOn Error GoTo stopError\nSet ftrArea = ActiveSheet.AutoFilter.Filters(2)\nSet ftrRegion = ActiveSheet.AutoFilter.Filters(1)\n\nIf ftrRegion.On Then\n    Application.EnableEvents = False\n    Debug.Print ftrRegion.Criteria1\n    Range(\"E206\").Value = Mid$(ftrRegion.Criteria1, 2)\n    Range(\"F201\").Value = \"Region\" &amp; \" \" &amp; Mid$(ftrRegion.Criteria1, 2)\nElse\n    Range(\"E206\").Value = \"\"\nEnd If\n</code></pre>\n\n<p>But the problem with this is that if a user selects more than one value the whole thing doesn't work, so what I want is a way to count the amount of values the user has selected in the filter, and if it is just the 1 then apply this code through an if statement. Can someone please help.</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 5019483, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/66dba25acd5f39a14f9cfe3855f52c70?s=128&d=identicon&r=PG&f=1", "display_name": "Gabriel", "link": "https://stackoverflow.com/users/5019483/gabriel"}, "edited": false, "score": 0, "creation_date": 1435159580, "post_id": 31028400, "comment_id": 50085890, "body": "Thank you very much... That seems to work fine to add the check boxes but I forgot to add the code to delete them. Please find below: Sub DelCheckBoxAnalysisCupboardsbyPicks()  Dim cell As Range  LastRow = ActiveSheet.Range(&quot;B&quot; &amp; ActiveSheet.Rows.Count).End(xlUp).Row  For Each cell In Range(&quot;A5:A&quot; &amp; LastRow) Worksheets(&quot;Analysis Cupboards by Picks&quot;).CheckBoxes.Delete Next For Each cell In Range(&quot;I5:I&quot; &amp; LastRow)  Range(&quot;I5:I&quot; &amp; LastRow).Clear Next  End Sub"}, {"owner": {"reputation": 25, "user_id": 5019483, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/66dba25acd5f39a14f9cfe3855f52c70?s=128&d=identicon&r=PG&f=1", "display_name": "Gabriel", "link": "https://stackoverflow.com/users/5019483/gabriel"}, "edited": false, "score": 0, "creation_date": 1435159584, "post_id": 31028400, "comment_id": 50085895, "body": "That one is applying the code to a &quot;specific worksheet but I need that it also applies to the same worksheets that I have added the check boxes previously."}, {"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "reply_to_user": {"reputation": 25, "user_id": 5019483, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/66dba25acd5f39a14f9cfe3855f52c70?s=128&d=identicon&r=PG&f=1", "display_name": "Gabriel", "link": "https://stackoverflow.com/users/5019483/gabriel"}, "edited": false, "score": 0, "creation_date": 1435159741, "post_id": 31028400, "comment_id": 50086016, "body": "Make the same change to the signature of <code>DelCheckBox()</code> by adding the parameter, and work with the known worksheet, just like I did with the <code>AddCheckBox()</code> routine."}, {"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "reply_to_user": {"reputation": 25, "user_id": 5019483, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/66dba25acd5f39a14f9cfe3855f52c70?s=128&d=identicon&r=PG&f=1", "display_name": "Gabriel", "link": "https://stackoverflow.com/users/5019483/gabriel"}, "edited": false, "score": 0, "creation_date": 1435832102, "post_id": 31028400, "comment_id": 50369318, "body": "Glad to hear it. An upvote and clicking the check mark will help others find a solution if they have the same problem."}], "tags": [], "owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "is_accepted": false, "score": 0, "last_activity_date": 1435154716, "last_edit_date": 1435154716, "creation_date": 1435153658, "answer_id": 31028400, "question_id": 31027966, "link": "https://stackoverflow.com/questions/31027966/apply-code-the-same-code-to-multiple-worksheets-in-the-same-workbook/31028400#31028400", "title": "Apply code the same code to multiple worksheets in the same workbook", "body": "<p>Give this a shot:</p>\n\n<pre><code>Sub Driver()\n  Dim ws as Worksheet\n  'Since your worksheet names are somewhat variable, \n  'I'd suggest passing an array of known names from a driver routine to your worker routine.\n  For each ws in Worksheets(Array(\"Analysis Flow Racking % Refill\", _\n                                  \"Analysis Flow Racking 1 Picks\", _\n                                  \"Analysis Line Cupboards %Refill\"))\n                                  'continue with the rest of your worksheets here...\n    AddCheckBox ws\n  Next\n  'If however, you're processing all the worksheets in the workbook, then this will be easier\n  For each ws in ActiveWorkbook.Sheets\n    AddCheckBox ws\n  Next\nEnd Sub\n</code></pre>\n\n<p>You will now need to modify your <code>AddCheckBox()</code> routine to accept the worksheet as a parameter:</p>\n\n<pre><code>Sub AddCheckBox(ByVal TheSheet as Worksheet)\n\n  Application.ScreenUpdating = False\n  DelCheckBox  'Do the delete macro\n  'or delete all checkboxes in the worksheet\n  ' ActiveSheet.CheckBoxes.Delete\n  ActiveWindow.View = xlNormalView\n  Dim LastRow as integer   'always declare your variables!\n  lastRow = ActiveSheet.Range(\"B\" &amp; ActiveSheet.Rows.Count).End(xlUp).Row\n\n  Dim cell As Range\n  For Each cell In TheSheet.Range(\"A5:A\" &amp; lastRow)\n    With TheSheet.CheckBoxes.Add(cell.Left, _\n                                 cell.Top, cell.Width, cell.Height)\n      .LinkedCell = cell.Offset(, 8).Address(External:=True)\n      '.Interior.ColorIndex = 37   'or  xlNone or xlAutomatic\n      .Caption = \"\"\n      '.Border.Weight = xlThin\n    End With\n  Next\n\n  'Note: removed WITH from here - it only effected 1 row and was confusing    \n  TheSheet.Range(\"A5:A\" &amp; lastRow).Rows.RowHeight = 15\n  ''''''''''''''''''''''''''''''\n  TheSheet.CheckBoxes.Select\n  Selection.ShapeRange.Align msoAlignCenters, msoFalse\n  Selection.ShapeRange.IncrementLeft 50\n  Range(\"A10000\").Select\n  '\n  'I believe that this code can be replaced with this:\n  TheSheet.Checkboxes.ShapeRange.Align msoAlignCenters msoFalse\n  TheSheet.Checkboxes.ShapeRange.IncrementLeft 50\n  ''''''''''''''''''''''''''''''\n  ActiveWindow.View = xlPageLayoutView\n  Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 5019483, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/66dba25acd5f39a14f9cfe3855f52c70?s=128&d=identicon&r=PG&f=1", "display_name": "Gabriel", "link": "https://stackoverflow.com/users/5019483/gabriel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 199, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1435154716, "creation_date": 1435152530, "last_edit_date": 1531164843, "question_id": 31027966, "link": "https://stackoverflow.com/questions/31027966/apply-code-the-same-code-to-multiple-worksheets-in-the-same-workbook", "title": "Apply code the same code to multiple worksheets in the same workbook", "body": "<p>I'm pretty new to VBA and I need a piece of code to apply in the same way to some work sheets in my workbook. </p>\n\n<p>The name of the worksheets I need the code to be applied are as follows:</p>\n\n<p>Analysis Flow Racking % Refill</p>\n\n<p>Analysis Flow Racking 1 Picks</p>\n\n<p>Analysis Line Cupboards %Refill</p>\n\n<p>Analysis Line Cupboards by Pick</p>\n\n<p>Analysis PFB</p>\n\n<p>Analysis  Cupboards % Refill</p>\n\n<p>Analysis  Cupboards by Picks</p>\n\n<p>Analysis Flow Racking 2 Picks</p>\n\n<p>The code is found below:\nAny help that you can provide will be much appreciated. Many thanks</p>\n\n<pre><code> Sub AddCheckBox()\n\n Application.ScreenUpdating = False\n\n Dim cell As Range\n\n DelCheckBox  'Do the delete macro\n'or delete all checkboxes in the worksheet\n' ActiveSheet.CheckBoxes.Delete\nActiveWindow.View = xlNormalView\nlastRow = ActiveSheet.Range(\"B\" &amp; ActiveSheet.Rows.Count).End(xlUp).Row\n\nFor Each cell In Range(\"A5:A\" &amp; lastRow)\nWith ActiveSheet.CheckBoxes.Add(cell.Left, _\ncell.Top, cell.Width, cell.Height)\n.LinkedCell = cell.Offset(, 8).Address(External:=True)\n'.Interior.ColorIndex = 37   'or  xlNone or xlAutomatic\n.Caption = \"\"\n'.Border.Weight = xlThin\nEnd With\nNext\n\n With Range(\"A5:A\" &amp; lastRow)\n.Rows.RowHeight = 15\nWorksheets(\"Analysis Flow Racking % Refill \").CheckBoxes.Select\nSelection.ShapeRange.Align msoAlignCenters, msoFalse\nSelection.ShapeRange.IncrementLeft 50\nRange(\"A10000\").Select\n\n\nEnd With\nActiveWindow.View = xlPageLayoutView\nApplication.ScreenUpdating = True\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "printing"], "answers": [{"comments": [{"owner": {"reputation": 103, "user_id": 4887991, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/chlAy.jpg?s=128&g=1", "display_name": "Thijsk", "link": "https://stackoverflow.com/users/4887991/thijsk"}, "edited": false, "score": 0, "creation_date": 1435221626, "post_id": 31028526, "comment_id": 50112997, "body": "The problem is that this would still give me an error message, as the domain is either G:\\Moe\\WD\\... or G:\\WD\\... Fixing the static partition to a network reference will not solve this problem. Thanks for the suggestion though!"}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "reply_to_user": {"reputation": 103, "user_id": 4887991, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/chlAy.jpg?s=128&g=1", "display_name": "Thijsk", "link": "https://stackoverflow.com/users/4887991/thijsk"}, "edited": false, "score": 0, "creation_date": 1435227890, "post_id": 31028526, "comment_id": 50116810, "body": "I&#39;ve updated my answer allowing  you to use mapped locations or ask for a file location."}], "tags": [], "owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "is_accepted": true, "score": 0, "last_activity_date": 1435227859, "last_edit_date": 1435227859, "creation_date": 1435153964, "answer_id": 31028526, "question_id": 31027750, "link": "https://stackoverflow.com/questions/31027750/excel-vba-to-solve-vba-error-by-if-error-then-rule/31028526#31028526", "title": "Excel vba to solve vba error by &quot;if error, then&quot; rule", "body": "<p>For the network locations you'll need to use the UNC path which will not change rather than the mapped path which can change on different computers.  </p>\n\n<p>To find your UNC paths open a command prompt (Run - <strong>cmd.exe</strong>) and type in <strong>net use</strong>.  </p>\n\n<p>The resulting table will give the local and remote names of the drives- just replace your mapped (local) connection with the remote one.</p>\n\n<p>For example, \n<strong>G:\\Moe\\WD\\Planning&amp;Control\\Client.xlsm</strong>\nmay become\n<strong>\\\\MyServerName\\Moe\\WD\\Planning&amp;Control\\Client.xlsm</strong></p>\n\n<p>Edit - the server name can also be found on the file explorer - <strong>windows key + E</strong> to open.\nIt will appear in the folder name as <strong>Moe on 'MyServerName' (G:)</strong></p>\n\n<p>To only use the mapped locations you could try:</p>\n\n<pre><code>Sub Test()\n\n    Dim wrkBk As Workbook\n    Dim sFileLocation As String\n\n    On Error GoTo ERROR_HANDLER\n\n    sFileLocation = \"S:\\Bartrup-CookD_SomeLocation\\New Microsoft Excel Worksheet.xlsx\"\n\n    Set wrkBk = Workbooks.Open(sFileLocation)\n\n    On Error GoTo 0\n    Exit Sub\n\nERROR_HANDLER:\n    Select Case Err.Number\n        Case 1004 'Microsoft Excel cannot access the file\n            sFileLocation = \"S:\\Bartrup-CookD\\New Microsoft Excel Worksheet.xlsx\"\n            Resume\n        Case Else\n            MsgBox \"Error \" &amp; Err.Number &amp; vbCr &amp; _\n                \" (\" &amp; Err.Description &amp; \") in procedure Test.\"\n            Err.Clear\n            Application.EnableEvents = True\n    End Select\n\nEnd Sub\n</code></pre>\n\n<p>or ask the user to select the correct file:</p>\n\n<pre><code>Public Sub AskForFile()\n\n    Dim vFile As Variant\n    Dim wrkBk As Workbook\n\n    vFile = GetFile(\"S:\\Bartrup-CookD\\\")\n    If vFile &lt;&gt; \"\" Then\n        Set wrkBk = Workbooks.Open(vFile)\n    End If\n\nEnd Sub\n\nPublic Function GetFile(Optional startFolder As Variant = -1) As Variant\n    Dim fle As FileDialog\n    Dim vItem As Variant\n    Set fle = Application.FileDialog(msoFileDialogFilePicker)\n    With fle\n        .Title = \"Select a File\"\n        .AllowMultiSelect = False\n        .Filters.Add \"Excel Files\", \"*.xls*\", 1\n        If startFolder = -1 Then\n            .InitialFileName = Application.DefaultFilePath\n        Else\n            If Right(startFolder, 1) &lt;&gt; \"\\\" Then\n                .InitialFileName = startFolder &amp; \"\\\"\n            Else\n                .InitialFileName = startFolder\n            End If\n        End If\n        If .Show &lt;&gt; -1 Then GoTo NextCode\n        vItem = .SelectedItems(1)\n    End With\nNextCode:\n    GetFile = vItem\n    Set fle = Nothing\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 103, "user_id": 4887991, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/chlAy.jpg?s=128&g=1", "display_name": "Thijsk", "link": "https://stackoverflow.com/users/4887991/thijsk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 147, "favorite_count": 0, "accepted_answer_id": 31028526, "answer_count": 1, "score": 0, "last_activity_date": 1435227859, "creation_date": 1435151989, "question_id": 31027750, "link": "https://stackoverflow.com/questions/31027750/excel-vba-to-solve-vba-error-by-if-error-then-rule", "title": "Excel vba to solve vba error by &quot;if error, then&quot; rule", "body": "<p>First of all, thanks for all the answers I have gotten on my previous questions, you really helped me out. The excel has evolved and now I'm ready to open different excel sheets in the background and print out different sheets on different printers. However, I'm working on a network that changes it's settings (which appear to change randomly).</p>\n\n<pre><code>Sub Client_Overzetten()\n\nApplication.ScreenUpdating = False\n'\nWorkbooks.Open (\"G:\\Moe\\WD\\Planning&amp;Control\\Client.xlsm\")\n....etc...\n</code></pre>\n\n<p>However, if my colleague would try to open this file, he will get an error, as the same document has a different link (due to access restrictions).\nHis link is</p>\n\n<pre><code>G:\\WD\\Planning&amp;Control\\Client.xlsm\")\n</code></pre>\n\n<p>Is there a formula to go to another location the moment it hits an error? Something like:</p>\n\n<pre><code>Sub Kids_II_Overzetten()\n'\n\nApplication.ScreenUpdating = False\n'\nWorkbooks.Open (\"G:\\Moe\\WD\\Planning&amp;Control\\Client.xlsm\")\nIf error, then \nWorkbooks.Open (\"G:\\WD\\Planning&amp;Control\\Client.xlsm\")\n</code></pre>\n\n<p>I have the same problem with the serverports of the printer, these ports change randomly</p>\n\n<pre><code>ActivePrinter = \"\\\\w8vvmprint01\\Moecombi07 op Ne07:\"\n</code></pre>\n\n<p>However, the next day it can be the same, or can be a different port</p>\n\n<pre><code>ActivePrinter = \"\\\\w8vvmprint01\\Moecombi07 op Ne03:\"\n</code></pre>\n\n<p>With the solving of the problem of my first question, can I answer my second question as well (on error, go to the next line)?\nThanks in advance :)</p>\n"}, {"tags": ["vba", "ms-access-2002"], "comments": [{"owner": {"reputation": 31, "user_id": 3136767, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8da040222020dc38eef3e985c1eb49cb?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin Whalen", "link": "https://stackoverflow.com/users/3136767/kevin-whalen"}, "reply_to_user": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1435152803, "post_id": 31027749, "comment_id": 50080560, "body": "Hm, yeah =/  It&#39;s odd, because UnderlyingQuery works fine, and the Source also works fine in the query designer.  I&#39;m going to try some dependable source that&#39;s never failed on me..."}, {"owner": {"reputation": 31, "user_id": 3136767, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8da040222020dc38eef3e985c1eb49cb?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin Whalen", "link": "https://stackoverflow.com/users/3136767/kevin-whalen"}, "reply_to_user": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1435152913, "post_id": 31027749, "comment_id": 50080662, "body": "Well, SELECT * from SimpleTable worked.  I can&#39;t share a copy of the database but let me work on adding UnderlyingQuery.  Understand, it&#39;ll take a moment because I need to mask field names (sensitive data).  I appreciate your help and will comment back in a minute"}, {"owner": {"reputation": 31, "user_id": 3136767, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8da040222020dc38eef3e985c1eb49cb?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin Whalen", "link": "https://stackoverflow.com/users/3136767/kevin-whalen"}, "reply_to_user": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1435153743, "post_id": 31027749, "comment_id": 50081330, "body": "I added additional detail.  I apologize that I can&#39;t share it all with you, but work wouldn&#39;t be happy with me!"}, {"owner": {"reputation": 31, "user_id": 3136767, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8da040222020dc38eef3e985c1eb49cb?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin Whalen", "link": "https://stackoverflow.com/users/3136767/kevin-whalen"}, "reply_to_user": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1435160222, "post_id": 31027749, "comment_id": 50086369, "body": "It was my fault that I didn&#39;t add this - I was using an ADO recordset, but switching that to DAO worked.  Thanks for your help, even though you couldn&#39;t do much because of my restrictions."}], "owner": {"reputation": 31, "user_id": 3136767, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8da040222020dc38eef3e985c1eb49cb?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin Whalen", "link": "https://stackoverflow.com/users/3136767/kevin-whalen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 42, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1435160245, "creation_date": 1435151982, "last_edit_date": 1435160245, "question_id": 31027749, "link": "https://stackoverflow.com/questions/31027749/recordsource-fails-when-set-in-vba-but-works-fine-in-query-designer", "title": "Recordsource fails when set in VBA, but works fine in query designer", "body": "<p>Edit: This was fixed by using a DAO recordset instead of ADO.</p>\n\n<p>I'm trying to set a recordsource in code that will be output to an Excel workbook.  When VBA hits .Open, it errors with, \"You tried to execute a query that does not include the specified expression 'WP1 + WP2 + WP3 + WP4 + WP5' as part of an aggregate expression.  <em>However</em>, if I paste the source into a query window, it works fine. Below I have cut out irrelevant fields in the Source.  </p>\n\n<p>Here is the offending part of the code: </p>\n\n<pre><code>With rst\n.ActiveConnection = CodeProject.Connection\n.CursorType = adOpenKeyset\n.LockType = adLockOptimistic\n.Source = \"SELECT UnderlyingQuery3.WP1, UnderlyingQuery3.WP2, UnderlyingQuery3.WP3, UnderlyingQuery3.WP4, UnderlyingQuery3.WP5 FROM UnderlyingQuery3 ORDER BY [irrelevant fields...]\"\n.Open Options:=adCmdText\nEnd With\n</code></pre>\n\n<p>UnderlyingQuery3 works fine.  Note, UnderlyingQuery3 contains</p>\n\n<pre><code>SELECT (WP1 + WP2 + WP3 + WP4 + WP5) AS WP5Yr FROM (...)\n</code></pre>\n\n<p>However, WP6 does not get carried through to the query that is failing.</p>\n\n<p>I have tried building another query rather than writing SQL into the Source. That query works fine from the query window.  However, setting that query as the source (with Options:=adCmdStoredProc) still fails with the same error.</p>\n\n<p>I have also performed a Compact &amp; Repair and a decompile/recompile to no effect.  I have no evidence of possible corruption outside of this.</p>\n\n<p>Structure of UnderlyingQuery3:</p>\n\n<pre><code>SELECT \nUnderlyingQuery2.WP1, \nUnderlyingQuery2.WP2, \nUnderlyingQuery2.WP3, \nUnderlyingQuery2.WP4, \nUnderlyingQuery2.WP5, \nUnderlyingQuery2.WP5Yr, \nFROM UnderlyingQuery2;\n</code></pre>\n\n<p>Structure of UnderlyingQuery2:</p>\n\n<pre><code>SELECT \n(CENSORED FIELDS), \nSum(DATA.WP1) AS WP1, \nSum(DATA.WP2) AS WP2, \nSum(DATA.WP3) AS WP3, \nSum(DATA.WP4) AS WP4, \nSum(DATA.WP5) AS WP5,\nWP1+WP2+WP3+WP4+WP5 AS WP5Yr \nFROM UnderlyingQuery1 AS DATA \nGROUP BY (CENSORED FIELDS) \nUNION ALL \nSELECT \n(CONSTANTS REPRESENTING AGGREGATES OF CENSORED FIELDS),\nSum(DATA.WP1) AS WP1, \nSum(DATA.WP2) AS WP2, \nSum(DATA.WP3) AS WP3, \nSum(DATA.WP4) AS WP4, \nSum(DATA.WP5) AS WP5 \nFROM UnderlyingQuery1 AS DATA\n</code></pre>\n\n<p>I'm working on fixing the formatting but here it is!  I truly think UnderlyingQuery1 is irrelevant here.  It just does an inner join of the raw data table to a parameter table to select certain years and other criteria for the data</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1435153237, "post_id": 31027679, "comment_id": 50080949, "body": "Is <a href=\"http://stackoverflow.com/questions/15887257/how-to-count-up-text-of-a-different-font-colour-in-excel\">THIS</a> what you want?"}], "answers": [{"comments": [{"owner": {"reputation": 95, "user_id": 3680657, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/5lgzP.jpg?s=128&g=1", "display_name": "Tom Crews", "link": "https://stackoverflow.com/users/3680657/tom-crews"}, "edited": false, "score": 0, "creation_date": 1435326358, "post_id": 31028476, "comment_id": 50168205, "body": "This was very helpful! However, it was not working for my spreadsheet. I ended up using <code>=COUNTIF(F:F,&quot;Queens&quot;)-COUNTIFS(F:F,&quot;Queens&quot;,I:I,&quot;x&quot;)</code> Since the code was not picking up the string by using the cell number for some reason. Would have been lost without your help, thank you!"}], "tags": [], "owner": {"reputation": 735, "user_id": 4619569, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EEDZ7.jpg?s=128&g=1", "display_name": "nicolaus-hee", "link": "https://stackoverflow.com/users/4619569/nicolaus-hee"}, "is_accepted": true, "score": 1, "last_activity_date": 1437211478, "last_edit_date": 1437211478, "creation_date": 1435153831, "answer_id": 31028476, "question_id": 31027679, "link": "https://stackoverflow.com/questions/31027679/count-cells-by-their-color-in-excel/31028476#31028476", "title": "Count cells by their color in Excel", "body": "<p><strong>Solution:</strong> This can be done without VBA <em>if you can add the county name for each entry</em>. Let's say, you are putting them into column J (see yellow cells in below picture).</p>\n\n<p>Then, to count totals, simply use the <code>COUNTIF</code> function to get the total number of rows for a county and substract those who are marked \"X\" using the <code>COUNTIFS</code> function. In cell N2, I entered:</p>\n\n<p><code>=COUNTIF(J:J,L2)-COUNTIFS(J:J,L2,H:H,\"X\")</code></p>\n\n<p>Add the other county names below the existing ones in column L and copy the formula from N2 to the cells below.</p>\n\n<p><strong>Explanation:</strong> <code>COUNTIF</code> counts the number of rows that match <em>one</em> criterion. Here, we are setting the county name (L2 for the first county) and we are looking for it in column J. Next, we need the number of rows that match both the county and the completion state of \"X\". <code>COUNTIFS</code> will do the trick as it counts the number of rows that match <em>two or more</em> criteria. In this case, we want the number of rows of a given county (column J) and we want them to be the value of a value in column L (\"Bronx\" for N2, \"Manhattan\" for N3 etc.). The second criterion is their completion state (column H) which you want to be X (specified in the formula as \"X\"). You then substract the second from the first number.</p>\n\n<p><strong>Edit:</strong> By the way, <em>sorting</em> does not affect these formulas, they will continue to work.</p>\n\n<p><img src=\"https://i.stack.imgur.com/Mfs5v.png\" alt=\"enter image description here\"></p>\n"}], "owner": {"reputation": 95, "user_id": 3680657, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/5lgzP.jpg?s=128&g=1", "display_name": "Tom Crews", "link": "https://stackoverflow.com/users/3680657/tom-crews"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1931, "favorite_count": 0, "accepted_answer_id": 31028476, "answer_count": 1, "score": 0, "last_activity_date": 1437211478, "creation_date": 1435151818, "last_edit_date": 1435301082, "question_id": 31027679, "link": "https://stackoverflow.com/questions/31027679/count-cells-by-their-color-in-excel", "title": "Count cells by their color in Excel", "body": "<p>This question is simple: How can I update a total number count in Excel that decreases based on how many red X's there are in a given column.</p>\n\n<p>Where this becomes too complicated for me: I have made macros to sort cells based on numbers or color. There are five different colors, each representing a different county in my area. I have a total for each county. (ex. yellow = 41, blue = 15, red...) and want to update each colors total respectively (by subtracting 1 for each X) IF there is an X in the completed column. </p>\n\n<p>So issues:</p>\n\n<ul>\n<li>How to keep track of a row of cells, though they may be sorted three\ndifferent ways at any given time (Is there a permanent cell ID?). </li>\n<li>How to update a number count for just a certain range of cells of the\nsame color.</li>\n</ul>\n\n<hr>\n\n<p>Attached is a picture of the top of the spreadsheet to better understand how this looks: </p>\n\n<p><img src=\"https://i.stack.imgur.com/9sIfk.png\" alt=\"spreadsheet\"></p>\n\n<p>any help is greatly appreciated, my unfamiliarity with excel functions is probably the root cause of this problem.</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 2, "creation_date": 1435154534, "post_id": 31027956, "comment_id": 50081939, "body": "You&#39;ve also defined <b>pastesheet</b>, but used <b>pastehseet</b> - although this wouldn&#39;t have caused too much of a problem as you then went on to use <b>Sheets(&quot;Raw Data&quot;)</b> instead."}, {"owner": {"reputation": 600, "user_id": 4842061, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c029acc451f8ec880d76203cfa9a17c5?s=128&d=identicon&r=PG&f=1", "display_name": "Trum", "link": "https://stackoverflow.com/users/4842061/trum"}, "reply_to_user": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1435154609, "post_id": 31027956, "comment_id": 50082015, "body": "Another good spot, I fixed what was definitely making it fall over but didn&#39;t notice that one."}, {"owner": {"reputation": 53, "user_id": 5040968, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d560c150d2a862397ec7e7e80dac9b43?s=128&d=identicon&r=PG&f=1", "display_name": "Sergio Oropeza", "link": "https://stackoverflow.com/users/5040968/sergio-oropeza"}, "edited": false, "score": 0, "creation_date": 1435162950, "post_id": 31027956, "comment_id": 50088312, "body": "Thanks, I actually switched it to that when I went over it, now it works like a beauty. :)"}], "tags": [], "owner": {"reputation": 600, "user_id": 4842061, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c029acc451f8ec880d76203cfa9a17c5?s=128&d=identicon&r=PG&f=1", "display_name": "Trum", "link": "https://stackoverflow.com/users/4842061/trum"}, "is_accepted": true, "score": 1, "last_activity_date": 1435154880, "last_edit_date": 1435154880, "creation_date": 1435152511, "answer_id": 31027956, "question_id": 31027549, "link": "https://stackoverflow.com/questions/31027549/vba-sub-or-function-not-defined/31027956#31027956", "title": "VBA Sub or Function not defined", "body": "<pre><code>Dim copysheet As Worksheet\nDim pastesheet As Worksheet\n\nSet copysheet = Worksheets(\"Daily Sheet\")\nSet pastesheet = Worksheets(\"Raw Data\")\n\ncopysheet.Range(\"G5\").Copy\nSheets(\"Raw Data\").Range(\"A\" &amp; Rows.Count).End(xlUp).offset(1).PasteSpecial Paste:=xlPasteValues\n\ncopysheet.Range(\"G7\").Copy\nSheets(\"Raw Data\").Range(\"B\" &amp; Rows.Count).End(xlUp).offset(1).PasteSpecial Paste:=xlPasteValues\n\ncopysheet.Range(\"G14\").Copy\nSheets(\"Raw Data\").Range(\"C\" &amp; Rows.Count).End(xlUp).offset(1).PasteSpecial Paste:=xlPasteValues\n\ncopysheet.Range(\"G9\").Copy\nSheets(\"Raw Data\").Range(\"D\" &amp; Rows.Count).End(xlUp).offset(1).PasteSpecial Paste:=xlPasteValues\n\ncopysheet.Range(\"G11\").Copy\nSheets(\"Raw Data\").Range(\"G\" &amp; Rows.Count).End(xlUp).offset(1).PasteSpecial Paste:=xlPasteValues\n\ncopysheet.Range(\"G13\").Copy\nSheets(\"Raw Data\").Range(\"H\" &amp; Rows.Count).End(xlUp).offset(1).PasteSpecial Paste:=xlPasteValues\n\n\nSheets(\"Daily Sheet\").Range(\"G5:G14\").clear\nWorksheets(\"Daily Sheet\").Range(\"K9\").Select\n</code></pre>\n\n<p>Appears to do what you want.</p>\n\n<p>The issues I found were:</p>\n\n<p>The use of sheet - not sheets (that explains the error you were getting, as it thought sheet was another macro or similar</p>\n\n<p>Similarly, you had missed the x off of the end of xlvalues on the paste specials.</p>\n\n<p>Finally, you need to use Worksheets(ws.name) for the selection at the end.</p>\n\n<p>Hope that this helps</p>\n"}], "owner": {"reputation": 53, "user_id": 5040968, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d560c150d2a862397ec7e7e80dac9b43?s=128&d=identicon&r=PG&f=1", "display_name": "Sergio Oropeza", "link": "https://stackoverflow.com/users/5040968/sergio-oropeza"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2949, "favorite_count": 0, "accepted_answer_id": 31027956, "answer_count": 1, "score": 1, "last_activity_date": 1435169026, "creation_date": 1435151503, "last_edit_date": 1435169026, "question_id": 31027549, "link": "https://stackoverflow.com/questions/31027549/vba-sub-or-function-not-defined", "title": "VBA Sub or Function not defined", "body": "<p>Im writing a code and I'm kinda of new to this.\nI keep getting a compile error on my macro code, a compile error that the sub or function is not defined. I tried to use to vba menu &lt; tools &lt; reference but I cannot click on it. Any suggestions? Below is the macro code I am trying to run</p>\n\n<pre><code>Sub Update()\n'\n'\n\nApplication.ScreenUpdating = True\n\nDim copysheet As Worksheet\nDim pastesheet As Worksheet\n\nSet copysheet = Worksheets(\"Daily Sheet\")\nSet pastehseet = Worksheets(\"Raw Data\")\n\ncopysheet.Range(\"G5\").Copy\nSheet(\"Raw Data\").Range(\"A\" &amp; Rows.Count).End(xlUp).Offset(1).PasteSpecial _\nPaste:=xlPasteValue, Operation:=xlNone, Skipblanks_:=False, Transpose:=False\n\ncopysheet.Range(\"G7\").Copy\nSheet(\"Raw Data\").Range(\"B\" &amp; Rows.Count).End(xlUp).Offset(1).PasteSpecial _\nPaste:=xlPasteValue, Operation:=xlNone, Skipblanks_:=False, Transpose:=False\n\ncopysheet.Range(\"G14\").Copy\nSheet(\"Raw Data\").Range(\"C\" &amp; Rows.Count).End(xlUp).Offset(1).PasteSpecial _\nPaste:=xlPasteValue, Operation:=xlNone, Skipblanks_:=False, Transpose:=False\n\ncopysheet.Range(\"G9\").Copy\nSheet(\"Raw Data\").Range(\"D\" &amp; Rows.Count).End(xlUp).Offset(1).PasteSpecial _\nPaste:=xlPasteValue, Operation:=xlNone, Skipblanks_:=False, Transpose:=False\n\ncopysheet.Range(\"G11\").Copy\nSheet(\"Raw Data\").Range(\"G\" &amp; Rows.Count).End(xlUp).Offset(1).PasteSpecial _\nPaste:=xlPasteValue, Operation:=xlNone, Skipblanks_:=False, Transpose:=False\n\ncopysheet.Range(\"G13\").Copy\nSheet(\"Raw Data\").Range(\"H\" &amp; Rows.Count).End(xlUp).Offset(1).PasteSpecial _\nPaste:=xlPasteValue, Operation:=xlNone, Skipblanks_:=False, Transpose:=False\n\n\nSheets(\"Daily Sheet\").Range(\"G5:G14\").Select.ClearContents\nSheets(\"Daily Sheet\").Range(\"K9\").Select\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-word"], "answers": [{"comments": [{"owner": {"reputation": 166, "user_id": 5040054, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Md7bI.jpg?s=128&g=1", "display_name": "Nick Morgan", "link": "https://stackoverflow.com/users/5040054/nick-morgan"}, "edited": false, "score": 0, "creation_date": 1435154864, "post_id": 31028541, "comment_id": 50082214, "body": "@S O that&#39;s got some stuff I&#39;ve never used... I&#39;m still learning VBA. Could you explain a little more about how I would incorporate that?"}, {"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "reply_to_user": {"reputation": 166, "user_id": 5040054, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Md7bI.jpg?s=128&g=1", "display_name": "Nick Morgan", "link": "https://stackoverflow.com/users/5040054/nick-morgan"}, "edited": false, "score": 0, "creation_date": 1435155039, "post_id": 31028541, "comment_id": 50082354, "body": "the top line creates an array of all <code>.doc*</code> file names in all folders/subfolders of the path given by <code>strFolder</code>. You can then loop through this array (using the <code>For Each</code> syntax and run whatever code you need against that file, e.g. <code>Documents.Open(fil)</code>"}, {"owner": {"reputation": 166, "user_id": 5040054, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Md7bI.jpg?s=128&g=1", "display_name": "Nick Morgan", "link": "https://stackoverflow.com/users/5040054/nick-morgan"}, "edited": false, "score": 0, "creation_date": 1435155829, "post_id": 31028541, "comment_id": 50082997, "body": "so this puts all of the documents within the selection of subfolders into the Immediate bin? should I clear this at the end of the program? with something like this maybe?  Dim x As Long   For x = 1 To 10     Debug.Print x Next  Debug.Print Now  Application.SendKeys &quot;^g ^a {DEL}&quot;"}, {"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "reply_to_user": {"reputation": 166, "user_id": 5040054, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Md7bI.jpg?s=128&g=1", "display_name": "Nick Morgan", "link": "https://stackoverflow.com/users/5040054/nick-morgan"}, "edited": false, "score": 0, "creation_date": 1435156196, "post_id": 31028541, "comment_id": 50083328, "body": "I&#39;ve just used <code>Debug.Print</code> for demo purposes, you would replace that line with the actual code that you plan on running for each file."}, {"owner": {"reputation": 166, "user_id": 5040054, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Md7bI.jpg?s=128&g=1", "display_name": "Nick Morgan", "link": "https://stackoverflow.com/users/5040054/nick-morgan"}, "edited": false, "score": 0, "creation_date": 1435156287, "post_id": 31028541, "comment_id": 50083412, "body": "Oh! That makes much more sense. Thank you so much for your help"}, {"owner": {"reputation": 166, "user_id": 5040054, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Md7bI.jpg?s=128&g=1", "display_name": "Nick Morgan", "link": "https://stackoverflow.com/users/5040054/nick-morgan"}, "edited": false, "score": 0, "creation_date": 1435157435, "post_id": 31028541, "comment_id": 50084250, "body": "I&#39;m not sure why, but my With Selection.Find isn&#39;t finding stuff within the files anymore once it&#39;s placed into the code there. Do I need to add some sort of command to make it look within the document?"}, {"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "reply_to_user": {"reputation": 166, "user_id": 5040054, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Md7bI.jpg?s=128&g=1", "display_name": "Nick Morgan", "link": "https://stackoverflow.com/users/5040054/nick-morgan"}, "edited": false, "score": 0, "creation_date": 1435157672, "post_id": 31028541, "comment_id": 50084431, "body": "I don&#39;t know what your code looks like - I&#39;d post it as a separate question and post all of the code you are using."}, {"owner": {"reputation": 166, "user_id": 5040054, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Md7bI.jpg?s=128&g=1", "display_name": "Nick Morgan", "link": "https://stackoverflow.com/users/5040054/nick-morgan"}, "edited": false, "score": 0, "creation_date": 1435158057, "post_id": 31028541, "comment_id": 50084702, "body": "ah of course... Can I tag you there? Sorry to take your time, you&#39;re just the first really helpful commenter on this problem I&#39;ve had haha"}, {"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "reply_to_user": {"reputation": 166, "user_id": 5040054, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Md7bI.jpg?s=128&g=1", "display_name": "Nick Morgan", "link": "https://stackoverflow.com/users/5040054/nick-morgan"}, "edited": false, "score": 0, "creation_date": 1435158329, "post_id": 31028541, "comment_id": 50084900, "body": "Don&#39;t think you can tag people, but if you use the <code>VBA</code> tag it should show up in my feed."}], "tags": [], "owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "is_accepted": true, "score": 0, "last_activity_date": 1435156296, "last_edit_date": 1435156296, "creation_date": 1435154006, "answer_id": 31028541, "question_id": 31027502, "link": "https://stackoverflow.com/questions/31027502/replace-text-in-documents-in-subfolders-vba/31028541#31028541", "title": "Replace text in documents in subfolders vba", "body": "<p>Use CMD to get all the files into an array and work with that instead - quicker and cleaner.</p>\n\n<pre><code>Sub S_O()\n\nDim fileArray As Variant\n\nfileArray = Filter(Split(CreateObject(\"WScript.Shell\").Exec(\"CMD /C DIR \"\"\" &amp; strFolder &amp; \"\\*.doc*\"\" /S /B /A:-D\").StdOut.ReadAll, vbCrLf), \".\")\n\nFor Each fil In fileArray\n    '//\n    '// Insert your code for doing the replacements here\n    '// e.g. Workbooks.Open(fil)\n    '// ...\nNext\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 166, "user_id": 5040054, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Md7bI.jpg?s=128&g=1", "display_name": "Nick Morgan", "link": "https://stackoverflow.com/users/5040054/nick-morgan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 399, "favorite_count": 0, "accepted_answer_id": 31028541, "answer_count": 1, "score": -1, "last_activity_date": 1435156296, "creation_date": 1435151346, "last_edit_date": 1495542819, "question_id": 31027502, "link": "https://stackoverflow.com/questions/31027502/replace-text-in-documents-in-subfolders-vba", "title": "Replace text in documents in subfolders vba", "body": "<p>I found this thread with the same issue as mine, but I've copied the code into my project, and it doesn't seem to work. </p>\n\n<p><a href=\"https://stackoverflow.com/questions/16908344/vba-macro-replace-text-in-word-file-in-all-sub-folders\">VBA macro: replace text in word file in all sub folders</a></p>\n\n<p>I was stepping through the code, and it gets to line 32 (under the For Each varItem in colSubFolders) but then it skips right over the find/replace section to the end of the code. Is the problem in my file format?</p>\n\n<p>EDIT: Additionally, when I get to varitem in ln 31, the value of \"varitem\" is the name of the folder, not the names of the word documents in the folder: I think this is where the issue is. </p>\n\n<pre><code>Sub DoLangesNow()\nDim file\nDim path As String\nDim strFolder As String\nDim strSubFolder As String\nDim strFile As String\nDim colSubFolders As New Collection\nDim varItem As Variant\n\n ' Parent folder including trailing backslash\n 'YOU MUST EDIT THIS.\n     strFolder = \"L:\\Admin\\Corporate Books\\2015\\2014 Consents macro\\company Annual Consents\"\n     ' Loop through the subfolders and fill Collection object\n     strSubFolder = Dir(strFolder &amp; \"*\", vbDirectory)\n     Do While Not strSubFolder = \"\"\n         Select Case strSubFolder\n             Case \".\", \"..\"\n                 ' Current folder or parent folder - ignore\n             Case Else\n                 ' Add to collection\n                 colSubFolders.Add Item:=strSubFolder, Key:=strSubFolder\n         End Select\n         ' On to the next one\n         strSubFolder = Dir\n     Loop\n     ' Loop through the collection\n     For Each varItem In colSubFolders\n         ' Loop through word docs in subfolder\n         'YOU MUST EDIT THIS if you want to change the files extension\n         strFile = Dir(strFolder &amp; varItem &amp; \"\\\" &amp; \"*.doc\")\n         Do While strFile &lt;&gt; \"\"\n         Set file = Documents.Open(FileName:=strFolder &amp; _\n                 varItem &amp; \"\\\" &amp; strFile)\n</code></pre>\n"}, {"tags": ["sql-server", "vba", "excel", "stored-procedures"], "comments": [{"owner": {"reputation": 2038, "user_id": 479518, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/39cab39c00ecc78ecf0d9dab18320204?s=128&d=identicon&r=PG&f=1", "display_name": "Juliusz", "link": "https://stackoverflow.com/users/479518/juliusz"}, "edited": false, "score": 0, "creation_date": 1435151929, "post_id": 31027172, "comment_id": 50079923, "body": "Quick one - it seems that there is mess with adVarWChar/adVarChar. I have no idea why you want to use Unicode for all parameters, but if you do - keep it consistent."}, {"owner": {"reputation": 1334, "user_id": 2903056, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/426cd8a78bf3c830d6ef082c9bbc290a?s=128&d=identicon&r=PG&f=1", "display_name": "steenbergh", "link": "https://stackoverflow.com/users/2903056/steenbergh"}, "reply_to_user": {"reputation": 2038, "user_id": 479518, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/39cab39c00ecc78ecf0d9dab18320204?s=128&d=identicon&r=PG&f=1", "display_name": "Juliusz", "link": "https://stackoverflow.com/users/479518/juliusz"}, "edited": false, "score": 0, "creation_date": 1435152197, "post_id": 31027172, "comment_id": 50080121, "body": "@Juliusz The specs for addextendedproperty ask for a levelxtype of type &#39;sysname&#39;, which is basically a nvarchar(128) and levelxname, which is varchar. Hence the mixed parameter types."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 5044615, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/671030000f2f8cc7004f493ffbf4152a?s=128&d=identicon&r=PG&f=1", "display_name": "Alexey Nikolaev", "link": "https://stackoverflow.com/users/5044615/alexey-nikolaev"}, "edited": false, "score": 0, "creation_date": 1435152674, "post_id": 31027775, "comment_id": 50080457, "body": "My Schema is called dbo, table - tbConsolidator, and column name must be entered by user. I tried to change them to Dbo, TbConsolidator and enter new column name with first capital letter, but it doesn&#39;t work."}, {"owner": {"reputation": 11, "user_id": 5044615, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/671030000f2f8cc7004f493ffbf4152a?s=128&d=identicon&r=PG&f=1", "display_name": "Alexey Nikolaev", "link": "https://stackoverflow.com/users/5044615/alexey-nikolaev"}, "edited": false, "score": 0, "creation_date": 1435152909, "post_id": 31027775, "comment_id": 50080658, "body": "Ah, sorry. I was about types, not names. N&#39;Schema&#39;,  N&#39;Table&#39;,  N&#39;Column don&#39;t work also."}, {"owner": {"reputation": 1334, "user_id": 2903056, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/426cd8a78bf3c830d6ef082c9bbc290a?s=128&d=identicon&r=PG&f=1", "display_name": "steenbergh", "link": "https://stackoverflow.com/users/2903056/steenbergh"}, "reply_to_user": {"reputation": 11, "user_id": 5044615, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/671030000f2f8cc7004f493ffbf4152a?s=128&d=identicon&r=PG&f=1", "display_name": "Alexey Nikolaev", "link": "https://stackoverflow.com/users/5044615/alexey-nikolaev"}, "edited": false, "score": 0, "creation_date": 1435153096, "post_id": 31027775, "comment_id": 50080836, "body": "@AlexeyNikolaev Shame, I can&#39;t find anything else/obvious in your code. One other suggestion I found was to change <code>cmd.CommandType = adCmdStoredProc</code> to <code>cmd.CommandType = 4</code> (4 is the enumerated value of adCmdStoredProc), but that was concernnig a completely different error message..."}, {"owner": {"reputation": 1334, "user_id": 2903056, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/426cd8a78bf3c830d6ef082c9bbc290a?s=128&d=identicon&r=PG&f=1", "display_name": "steenbergh", "link": "https://stackoverflow.com/users/2903056/steenbergh"}, "reply_to_user": {"reputation": 11, "user_id": 5044615, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/671030000f2f8cc7004f493ffbf4152a?s=128&d=identicon&r=PG&f=1", "display_name": "Alexey Nikolaev", "link": "https://stackoverflow.com/users/5044615/alexey-nikolaev"}, "edited": false, "score": 0, "creation_date": 1435153251, "post_id": 31027775, "comment_id": 50080961, "body": "@AlexeyNikolaev One other thing: scrap the &quot;N&#39;&quot; in the adVarChar parameters. The N in front of a string makes it Unicode, and you&#39;re now inputting Unicode in non-Unicode fields. That may be your conflict."}, {"owner": {"reputation": 11, "user_id": 5044615, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/671030000f2f8cc7004f493ffbf4152a?s=128&d=identicon&r=PG&f=1", "display_name": "Alexey Nikolaev", "link": "https://stackoverflow.com/users/5044615/alexey-nikolaev"}, "edited": false, "score": 0, "creation_date": 1435153355, "post_id": 31027775, "comment_id": 50081034, "body": "Thank you anyway) With cmd.CommandType = 4 nothing changed, I still receive the same error."}, {"owner": {"reputation": 1334, "user_id": 2903056, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/426cd8a78bf3c830d6ef082c9bbc290a?s=128&d=identicon&r=PG&f=1", "display_name": "steenbergh", "link": "https://stackoverflow.com/users/2903056/steenbergh"}, "reply_to_user": {"reputation": 11, "user_id": 5044615, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/671030000f2f8cc7004f493ffbf4152a?s=128&d=identicon&r=PG&f=1", "display_name": "Alexey Nikolaev", "link": "https://stackoverflow.com/users/5044615/alexey-nikolaev"}, "edited": false, "score": 0, "creation_date": 1435153596, "post_id": 31027775, "comment_id": 50081212, "body": "@AlexeyNikolaev I&#39;ve edited my answer; seems to me you&#39;re reversing Name and Type parameter-type-wise."}], "tags": [], "owner": {"reputation": 1334, "user_id": 2903056, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/426cd8a78bf3c830d6ef082c9bbc290a?s=128&d=identicon&r=PG&f=1", "display_name": "steenbergh", "link": "https://stackoverflow.com/users/2903056/steenbergh"}, "is_accepted": false, "score": 0, "last_activity_date": 1435153546, "last_edit_date": 1435153546, "creation_date": 1435152051, "answer_id": 31027775, "question_id": 31027172, "link": "https://stackoverflow.com/questions/31027172/vba-excel-ado-sp-addextendedproperty-stored-procedure-execution/31027775#31027775", "title": "VBA Excel ADO sp_addextendedproperty stored procedure execution", "body": "<p>When I look at the example code for <code>sp_addextendedproperty()</code> on MSDN, I see the <code>levelxtype</code> parameters entered with the first letter capitalised only:</p>\n\n<pre><code>USE AdventureWorks2012;\nGO\nEXEC sp_addextendedproperty \n@name = N'Caption', \n@value = 'Postal code is a required column.',\n@level0type = N'Schema', @level0name = 'Person',\n@level1type = N'Table',  @level1name = 'Address',\n@level2type = N'Column', @level2name = 'PostalCode';\nGO\n</code></pre>\n\n<p>Example <a href=\"https://msdn.microsoft.com/en-us/library/ms180047.aspx\" rel=\"nofollow\">here</a></p>\n\n<p>Perhaps you could try that?</p>\n\n<p>EDIT</p>\n\n<p>When I place your code next to the example, it seems to me you're reversing Name and Type. Try this:</p>\n\n<pre><code>Set name = cmd.CreateParameter(\"@name\", adVarWChar, adParamInput, 128, \"N'MS_Description'\")\ncmd.Parameters.Append name\n\nSet value = cmd.CreateParameter(\"@value\", adVariant, adParamInput, , \"N'\" &amp; InsertField.TextBox2.value &amp; \"'\")\ncmd.Parameters.Append value\n\nSet level0type = cmd.CreateParameter(\"@level0type\", adVarWChar, adParamInput, 128, \"N'Schema'\")\ncmd.Parameters.Append level0type\n\nSet level0name = cmd.CreateParameter(\"@level0name\", adVarChar, adParamInput, 128, \"'dbo'\")\ncmd.Parameters.Append level0name\n\nSet level1type = cmd.CreateParameter(\"@level1type\", adVarWChar, adParamInput, 128, \"N'Table'\")\ncmd.Parameters.Append level1type\n\nSet level1name = cmd.CreateParameter(\"@level1name\", adVarChar, adParamInput, 128, \"'tbConsolidator'\")\ncmd.Parameters.Append level1name\n\nSet level2type = cmd.CreateParameter(\"@level2type\", adVarWChar, adParamInput, 128, \"N'Column'\")\ncmd.Parameters.Append level2type\n\nSet level2name = cmd.CreateParameter(\"@level2name\", adVarChar, adParamInput, 128, \"'\" &amp; InsertField.TextBox1.value &amp; \"'\")\ncmd.Parameters.Append level2name\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 5044615, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/671030000f2f8cc7004f493ffbf4152a?s=128&d=identicon&r=PG&f=1", "display_name": "Alexey Nikolaev", "link": "https://stackoverflow.com/users/5044615/alexey-nikolaev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 264, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1435153546, "creation_date": 1435150468, "last_edit_date": 1435150987, "question_id": 31027172, "link": "https://stackoverflow.com/questions/31027172/vba-excel-ado-sp-addextendedproperty-stored-procedure-execution", "title": "VBA Excel ADO sp_addextendedproperty stored procedure execution", "body": "<p>I'm trying to create a userform in Excel which allows users to add new column and description to it to an existing SQL server table.</p>\n\n<p>I do with ADO library in VBA. To add description to a column created I need to run a system stored procedure sp_addextendedproperty. </p>\n\n<p>I can't pass parameters to it, I always receive an error\n<strong>Error -2147217900: An invalid parameter or option was specified for procedure 'sp_addextendedproperty'.</strong></p>\n\n<pre><code>Private Sub InsertField_bt_Click()\n    Set con = New ADODB.Connection\n    con.Provider = \"sqloledb\"\n    sConnectionString = \"Server=rumossql12;Database=PharmNet;UID=(login here);Pwd=(password here)\"\n    con.Open sConnectionString\n\n    Set cmd = New ADODB.Command\n    cmd.CommandType = adCmdStoredProc\n    cmd.ActiveConnection = con\n    cmd.CommandText = \"sp_addextendedproperty\"\n\n    Dim name As ADODB.Parameter\n    Dim value As ADODB.Parameter\n    Dim level0type As ADODB.Parameter\n    Dim level0name As ADODB.Parameter\n    Dim level1type As ADODB.Parameter\n    Dim level1name As ADODB.Parameter\n    Dim level2type As ADODB.Parameter\n    Dim level2name As ADODB.Parameter\n\n    Set name = cmd.CreateParameter(\"@name\", adVarWChar, adParamInput, 128, \"N'MS_Description'\")\n    cmd.Parameters.Append name\n\n    Set value = cmd.CreateParameter(\"@value\", adVariant, adParamInput, , \"N'\" &amp; InsertField.TextBox2.value &amp; \"'\")\n    cmd.Parameters.Append value\n\n    Set level0type = cmd.CreateParameter(\"@level0type\", adVarChar, adParamInput, 128, \"N'SCHEMA'\")\n    cmd.Parameters.Append level0type\n\n    Set level0name = cmd.CreateParameter(\"@level0name\", adVarWChar, adParamInput, 128, \"N'dbo'\")\n    cmd.Parameters.Append level0name\n\n    Set level1type = cmd.CreateParameter(\"@level1type\", adVarChar, adParamInput, 128, \"N'TABLE'\")\n    cmd.Parameters.Append level1type\n\n    Set level1name = cmd.CreateParameter(\"@level1name\", adVarWChar, adParamInput, 128, \"N'tbConsolidator'\")\n    cmd.Parameters.Append level1name\n\n    Set level2type = cmd.CreateParameter(\"@level2type\", adVarChar, adParamInput, 128, \"N'COLUMN'\")\n    cmd.Parameters.Append level2type\n\n    Set level2name = cmd.CreateParameter(\"@level2name\", adVarWChar, adParamInput, 128, \"N'\" &amp; InsertField.TextBox1.value &amp; \"'\")\n    cmd.Parameters.Append level2name\n\n    On Error GoTo ErrHandler\n\n\n    sSQL = \"ALTER TABLE PharmNet.dbo.tbConsolidator ADD \" &amp; InsertField.TextBox1.value &amp; \" NVARCHAR(255) NULL\"\n    'con.Execute sSQL\n    cmd.Execute\n    InsertField.Hide\n\nErrHandler:\n    MsgBox \"Error \" &amp; Err.Number &amp; \": \" &amp; Err.Description, vbCritical, \"ErrorThingy\"\n    Sheet2.Cells(1, 1).value = \"Error \" &amp; Err.Number &amp; \": \" &amp; Err.Description\n    con.Close\n    Set con = Nothing\nEnd Sub\n</code></pre>\n\n<p>Why can it happen?\nThank you in advance for your help! :)</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 23, "user_id": 1164194, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c00d949a88fb97ead880d4919b75c39e?s=128&d=identicon&r=PG", "display_name": "Francisco Rodr&#237;guez Gonz&#225;lez", "link": "https://stackoverflow.com/users/1164194/francisco-rodr%c3%adguez-gonz%c3%a1lez"}, "reply_to_user": {"reputation": 2832, "user_id": 1161309, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b27b718aa1e9d3835ef807359666eb34?s=128&d=identicon&r=PG", "display_name": "Raystafarian", "link": "https://stackoverflow.com/users/1161309/raystafarian"}, "edited": false, "score": 0, "creation_date": 1435150327, "post_id": 31027015, "comment_id": 50078714, "body": "How can I use the remove duplicates in the way described above? I can&#39;t control which duplicates to delete (or at least I don&#39;t know how)"}, {"owner": {"reputation": 1949, "user_id": 1723119, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/8182f3271d9881acad7c1a4d8844ca15?s=128&d=identicon&r=PG", "display_name": "99moorem", "link": "https://stackoverflow.com/users/1723119/99moorem"}, "edited": false, "score": 1, "creation_date": 1435150332, "post_id": 31027015, "comment_id": 50078720, "body": "@Raystafarian Because he is only comparing the last part of two different strings. OP I would read up on array&#39;s, accessing the sheet is a very costly thing in terms of CPU time, an array would cut your time dramatically. e.g. read sheet range into array - process - clear sheet - read array back to sheet"}, {"owner": {"reputation": 23, "user_id": 1164194, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c00d949a88fb97ead880d4919b75c39e?s=128&d=identicon&r=PG", "display_name": "Francisco Rodr&#237;guez Gonz&#225;lez", "link": "https://stackoverflow.com/users/1164194/francisco-rodr%c3%adguez-gonz%c3%a1lez"}, "reply_to_user": {"reputation": 1949, "user_id": 1723119, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/8182f3271d9881acad7c1a4d8844ca15?s=128&d=identicon&r=PG", "display_name": "99moorem", "link": "https://stackoverflow.com/users/1723119/99moorem"}, "edited": false, "score": 0, "creation_date": 1435150438, "post_id": 31027015, "comment_id": 50078801, "body": "That sounds promising, but how could I do it?"}, {"owner": {"reputation": 2832, "user_id": 1161309, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b27b718aa1e9d3835ef807359666eb34?s=128&d=identicon&r=PG", "display_name": "Raystafarian", "link": "https://stackoverflow.com/users/1161309/raystafarian"}, "reply_to_user": {"reputation": 1949, "user_id": 1723119, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/8182f3271d9881acad7c1a4d8844ca15?s=128&d=identicon&r=PG", "display_name": "99moorem", "link": "https://stackoverflow.com/users/1723119/99moorem"}, "edited": false, "score": 0, "creation_date": 1435150615, "post_id": 31027015, "comment_id": 50078920, "body": "@99moorem I missed that. Perhaps text to columns the second column and remove the prefixes then highlight duplicates, move and remove and then recompile"}, {"owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "reply_to_user": {"reputation": 1949, "user_id": 1723119, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/8182f3271d9881acad7c1a4d8844ca15?s=128&d=identicon&r=PG", "display_name": "99moorem", "link": "https://stackoverflow.com/users/1723119/99moorem"}, "edited": false, "score": 0, "creation_date": 1435150834, "post_id": 31027015, "comment_id": 50079074, "body": "A couple of suggestions: definitely use arrays instead of the range, like @99moorem suggested. Secondly, start  by sorting the first column, then copy entire range to a variable array and keep looping over the same values in column 1 - when val in col 1 changes you&#39;re done with that particular set of duplicates and the next one begins"}, {"owner": {"reputation": 23, "user_id": 1164194, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c00d949a88fb97ead880d4919b75c39e?s=128&d=identicon&r=PG", "display_name": "Francisco Rodr&#237;guez Gonz&#225;lez", "link": "https://stackoverflow.com/users/1164194/francisco-rodr%c3%adguez-gonz%c3%a1lez"}, "reply_to_user": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "edited": false, "score": 0, "creation_date": 1435151582, "post_id": 31027015, "comment_id": 50079648, "body": "@paulbica I&#39;m a newbie with VBA. Could you help me with some code? Thank you"}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 1164194, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c00d949a88fb97ead880d4919b75c39e?s=128&d=identicon&r=PG", "display_name": "Francisco Rodr&#237;guez Gonz&#225;lez", "link": "https://stackoverflow.com/users/1164194/francisco-rodr%c3%adguez-gonz%c3%a1lez"}, "edited": false, "score": 0, "creation_date": 1435151419, "post_id": 31027249, "comment_id": 50079525, "body": "Wow! This works, but I don&#39;t know if it deletes the duplicate with the S_ZS_ or the one with the S_LA_"}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "reply_to_user": {"reputation": 23, "user_id": 1164194, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c00d949a88fb97ead880d4919b75c39e?s=128&d=identicon&r=PG", "display_name": "Francisco Rodr&#237;guez Gonz&#225;lez", "link": "https://stackoverflow.com/users/1164194/francisco-rodr%c3%adguez-gonz%c3%a1lez"}, "edited": false, "score": 0, "creation_date": 1435155079, "post_id": 31027249, "comment_id": 50082390, "body": "Sort the data in descending order according to column B. This will put all of the S_ZS_ above all of the S_LA_. Then when you remove the duplicates the first ones (The S_ZS_) will be retained. If you need the original ordering you can re-sort (if the original order is somewhat ad hoc you can create a new column with the numbers 1,2,3, in order and then re-sort according to that column). This assumes that there is at most 1 S_ZS_ that you want to retain (for each duplicate). If there is more than 1 -- you would need to use VBA after all (I think)."}], "tags": [], "owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "is_accepted": false, "score": 0, "last_activity_date": 1435150687, "creation_date": 1435150687, "answer_id": 31027249, "question_id": 31027015, "link": "https://stackoverflow.com/questions/31027015/deleting-rows-based-on-duplicate-cells-and-the-content-of-a-second-column-vba/31027249#31027249", "title": "Deleting rows based on duplicate cells and the content of a second column (VBA)", "body": "<p>A non-VBA solution:\nInsert a new column C\nAssuming that the data starts in row 1, in C1 enter:</p>\n\n<pre><code>=CONCATENATE(A1,MID(B1,5,LEN(B1)-4))\n</code></pre>\n\n<p>Copy the formula down column C. Then use the remove duplicates feaure keyed to column C.</p>\n"}, {"comments": [{"owner": {"reputation": 23, "user_id": 1164194, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c00d949a88fb97ead880d4919b75c39e?s=128&d=identicon&r=PG", "display_name": "Francisco Rodr&#237;guez Gonz&#225;lez", "link": "https://stackoverflow.com/users/1164194/francisco-rodr%c3%adguez-gonz%c3%a1lez"}, "edited": false, "score": 0, "creation_date": 1435159460, "post_id": 31028134, "comment_id": 50085790, "body": "Thank you, but I can&#39;t make it work. It deletes evereything"}, {"owner": {"reputation": 1949, "user_id": 1723119, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/8182f3271d9881acad7c1a4d8844ca15?s=128&d=identicon&r=PG", "display_name": "99moorem", "link": "https://stackoverflow.com/users/1723119/99moorem"}, "reply_to_user": {"reputation": 23, "user_id": 1164194, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c00d949a88fb97ead880d4919b75c39e?s=128&d=identicon&r=PG", "display_name": "Francisco Rodr&#237;guez Gonz&#225;lez", "link": "https://stackoverflow.com/users/1164194/francisco-rodr%c3%adguez-gonz%c3%a1lez"}, "edited": false, "score": 0, "creation_date": 1435221817, "post_id": 31028134, "comment_id": 50113124, "body": "I have made some changes to the above code. Also code expects Col A and Col B to be laid out as in question"}, {"owner": {"reputation": 1949, "user_id": 1723119, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/8182f3271d9881acad7c1a4d8844ca15?s=128&d=identicon&r=PG", "display_name": "99moorem", "link": "https://stackoverflow.com/users/1723119/99moorem"}, "reply_to_user": {"reputation": 23, "user_id": 1164194, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c00d949a88fb97ead880d4919b75c39e?s=128&d=identicon&r=PG", "display_name": "Francisco Rodr&#237;guez Gonz&#225;lez", "link": "https://stackoverflow.com/users/1164194/francisco-rodr%c3%adguez-gonz%c3%a1lez"}, "edited": false, "score": 0, "creation_date": 1435222489, "post_id": 31028134, "comment_id": 50113570, "body": "Just for my own curiosity how long did this code take vs your original?"}, {"owner": {"reputation": 23, "user_id": 1164194, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c00d949a88fb97ead880d4919b75c39e?s=128&d=identicon&r=PG", "display_name": "Francisco Rodr&#237;guez Gonz&#225;lez", "link": "https://stackoverflow.com/users/1164194/francisco-rodr%c3%adguez-gonz%c3%a1lez"}, "edited": false, "score": 0, "creation_date": 1435228607, "post_id": 31028134, "comment_id": 50117229, "body": "Actually I ended up doing a mix of my own code and yours. I took 18 minutes to complete the task with the mix. With my first code, I had to force close excel after 2 hours. I&#39;ll try your full code this evening and I&#39;ll tell you. Thank you!"}], "tags": [], "owner": {"reputation": 1949, "user_id": 1723119, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/8182f3271d9881acad7c1a4d8844ca15?s=128&d=identicon&r=PG", "display_name": "99moorem", "link": "https://stackoverflow.com/users/1723119/99moorem"}, "is_accepted": true, "score": 0, "last_activity_date": 1435221766, "last_edit_date": 1435221766, "creation_date": 1435152958, "answer_id": 31028134, "question_id": 31027015, "link": "https://stackoverflow.com/questions/31027015/deleting-rows-based-on-duplicate-cells-and-the-content-of-a-second-column-vba/31028134#31028134", "title": "Deleting rows based on duplicate cells and the content of a second column (VBA)", "body": "<p>I believe this is nearly there - MAKE SURE TO TAKE A BACKUP OF YOUR DATA BEFORE RUNNING asthis will overwrite the data</p>\n\n<pre><code>Sub test()\nDim IN_arr()\nDim OUT_arr()\n\nIN_arr = ActiveSheet.UsedRange.Value2\nCount = 1\nReDim OUT_arr(UBound(IN_arr, 2) - 1, Count)\nFound = 1\n\nFor i = 1 To UBound(IN_arr, 1)\n    Found = 1\n    For c = 1 To UBound(IN_arr, 1)\n        Comp1 = Right(IN_arr(i, 2), Len(IN_arr(i, 2)) - InStr(1, IN_arr(i, 2), \"S_LA\") - 3) 'Compare last section\n        Comp2 = Right(IN_arr(c, 2), Len(IN_arr(c, 2)) - InStr(1, IN_arr(c, 2), \"S_ZS\") - 3)\n\n        Comp3 = IN_arr(i, 1) 'Compare first section\n        Comp4 = IN_arr(c, 1)\n\n        If Comp1 = Comp2 And i &lt;&gt; c And Comp3 = Comp4 Then\n            Found = 0\n        End If\n    Next\n    If Found = 0 Then\n        'do not keep row\n    Else\n        'keep row\n        If OUT_arr(UBound(IN_arr, 2) - 1, Count - 1) &lt;&gt; \"\" Then\n            Count = Count + 1\n            ReDim Preserve OUT_arr(UBound(IN_arr, 2) - 1, Count)\n        End If\n\n        For cols = 0 To UBound(IN_arr, 2) - 1\n            OUT_arr(cols, Count - 1) = IN_arr(i, cols + 1)\n        Next\n\n\n    End If\nNext\n\nActiveSheet.UsedRange.ClearContents\nActiveSheet.Range(\"A1\").Resize(Count, UBound(OUT_arr, 1) + 1).Value = Application.Transpose(OUT_arr)\n\nEnd Sub\n</code></pre>\n\n<p>Please note made some small changes to code</p>\n"}], "owner": {"reputation": 23, "user_id": 1164194, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c00d949a88fb97ead880d4919b75c39e?s=128&d=identicon&r=PG", "display_name": "Francisco Rodr&#237;guez Gonz&#225;lez", "link": "https://stackoverflow.com/users/1164194/francisco-rodr%c3%adguez-gonz%c3%a1lez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 648, "favorite_count": 0, "accepted_answer_id": 31028134, "answer_count": 2, "score": 2, "last_activity_date": 1435221766, "creation_date": 1435150049, "last_edit_date": 1435154698, "question_id": 31027015, "link": "https://stackoverflow.com/questions/31027015/deleting-rows-based-on-duplicate-cells-and-the-content-of-a-second-column-vba", "title": "Deleting rows based on duplicate cells and the content of a second column (VBA)", "body": "<p>I have some trouble deleting duplicate rows, since the way I have to do it is a kind of hard. Let me explain.</p>\n\n<p>This is what I have (actually I have more than 90,000 rows!)</p>\n\n<pre><code>+-----------+------------------+\n|    Ref    |       Sup        |\n+-----------+------------------+\n| 10000-001 | S_LA_LLZ_INOR    |\n| 10000-001 | S_LA_RADAR_STNFN |\n| 10000-001 | S_LA_VOR_LRO     |\n| 10000-001 | S_LA_DME_LRO     |\n| 10000-001 | S_LA_DME_INOR    |\n| 1000-001  | S_LA_GP_INOR     |\n| 1000-001  | S_LA_LLZ_ITF     |\n| 1000-001  | S_ZS_LLZ_ITF     |\n| 1000-002  | S_LA_GP_INOR     |\n| 1000-002  | S_LA_LLZ_ITF     |\n+-----------+------------------+\n</code></pre>\n\n<p>What I have to do is search in column A for duplicates. Then I have to check in column B if the chain of characters after <code>S_LA_</code> or <code>S_ZS_</code> are the same. If they are the same. I have to delete the row with the <code>S_LA_</code> </p>\n\n<p>So, in the rows above I would have to delete the row with <code>1000-001|S_LA_LLZ_ITF</code>.</p>\n\n<p>I have written a code. It works, but it's painfully slow when working with 10,000+ rows.</p>\n\n<pre><code>Dim LastRowcheck As Long\nDim str1 As String\nDim str2 As String\nDim str3 As String\nDim str4 As String\nDim str5 As String\nDim str6 As String\nDim prueba As Integer\nDim prueba1 As Integer\nDim n1 As Long\nDim n3 As Long\nDim colNum As Integer\nDim colNum1 As Integer\nDim iCntr As Long\n\ncolNum = WorksheetFunction.Match(\"Ref\", ActiveSheet.Range(\"1:1\"), 0)\ncolNum1 = WorksheetFunction.Match(\"Sup\",ActiveSheet.Range(\"1:1\"), 0)\n\nWith ActiveSheet\n  LastRowcheck = .Range(\"A\" &amp; .Rows.Count).End(xlUp).Row\n  For n1 = 2 To LastRowcheck\n      str1 = Cells(n1, colNum).Value\n      For n3 = n1 + 1 To LastRowcheck + 1\n          str2 = Cells(n3, colNum).Value\n          prueba = StrComp(num1, num2)\n          If prueba = 0 Then\n              str3 = Cells(n1, colNum1).Value\n              str4 = Cells(n3, colNum1).Value\n              str5 = Right(str3, Len(str3) - 5)\n              str6 = Right(str4, Len(str4) - 5)\n              prueba1 = StrComp(str5, str6)\n                  If prueba1 = 0 Then\n                      If StrComp(num3, num4) = 1 Then\n                          Cells(n3, colNum).Interior.ColorIndex = 3\n                      ElseIf StrComp(num3, num4) = -1 Then\n                          Cells(n1, colNum).Interior.ColorIndex = 3\n                      End If\n                  End If\n              End If\n          Next n3\n      Next n1\n\n  For iCntr = LastRowcheck To 2 Step -1\n      If Cells(iCntr, colNum).Interior.ColorIndex = 3 Then\n          Rows(iCntr).Delete\n      End If\n  Next iCntr\nEnd With\n</code></pre>\n\n<p>I would appreciate any help or guidance you could give me.</p>\n"}, {"tags": ["excel", "vba", "checkbox"], "answers": [{"comments": [{"owner": {"reputation": 309, "user_id": 1686300, "user_type": "registered", "accept_rate": 26, "profile_image": "https://www.gravatar.com/avatar/07035700acafeee6de9d4705a182ef55?s=128&d=identicon&r=PG", "display_name": "nobby", "link": "https://stackoverflow.com/users/1686300/nobby"}, "edited": false, "score": 0, "creation_date": 1435325694, "post_id": 31033687, "comment_id": 50167740, "body": "With a slight bit of tweaking, this is <i>almost</i> working perfectly. Only issue I have is that it keeps finding one extra shape, and I can&#39;t tell what it think&#39;s it&#39;s seeing. My Excel sheet does have a few other cells, but only 14 entries are checkboxes. But it keeps finding 15. Any thoughts?"}, {"owner": {"reputation": 309, "user_id": 1686300, "user_type": "registered", "accept_rate": 26, "profile_image": "https://www.gravatar.com/avatar/07035700acafeee6de9d4705a182ef55?s=128&d=identicon&r=PG", "display_name": "nobby", "link": "https://stackoverflow.com/users/1686300/nobby"}, "edited": false, "score": 0, "creation_date": 1435326144, "post_id": 31033687, "comment_id": 50168044, "body": "Ah, disregard, I found out how to show all Shapes from the Selection Pain menu in Excel and I do indeed have an extra shape."}], "tags": [], "owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "is_accepted": false, "score": 0, "last_activity_date": 1435168691, "creation_date": 1435168691, "answer_id": 31033687, "question_id": 31026957, "link": "https://stackoverflow.com/questions/31026957/import-checkbox-settings-from-excel/31033687#31033687", "title": "Import CheckBox Settings From Excel", "body": "<p>You'll have to loop through all the shapes on the worksheet and test each one to make sure you have a checkbox. Here is an example (I don't have Visual Basic on my workstation here, but this should work):</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Option Explicit\n\nSub GetCheckBoxes()\n    Dim oSheet As Worksheet\n    Dim oShape As Shape\n\n    Set oSheet = ActiveSheet\n\n    For Each oShape In oSheet.Shapes\n        If (oShape.Type = msoFormControl) And (oShape.FormControlType = xlCheckBox) Then\n            If oShape.ControlFormat.Value = 1 Then\n                Debug.Print \"box '\" &amp; oShape.Name &amp; \"' is checked!\"\n            Else\n                Debug.Print \"box '\" &amp; oShape.Name &amp; \"' is not checked!\"\n            End If\n        End If\n    Next oShape\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 309, "user_id": 1686300, "user_type": "registered", "accept_rate": 26, "profile_image": "https://www.gravatar.com/avatar/07035700acafeee6de9d4705a182ef55?s=128&d=identicon&r=PG", "display_name": "nobby", "link": "https://stackoverflow.com/users/1686300/nobby"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 237, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1435168691, "creation_date": 1435149892, "last_edit_date": 1435154803, "question_id": 31026957, "link": "https://stackoverflow.com/questions/31026957/import-checkbox-settings-from-excel", "title": "Import CheckBox Settings From Excel", "body": "<p>I have an Excel worksheet that has 14 entries with checkboxes in it. I'd like to read the state of those checkboxes into a corresponding checkbox in Visual Basic. I'm struggling with this access, however. I believe I can only access the checkboxes in the Excel sheet by name, as I don't think they have an index like the Visual Basic checkbox does, so I think I have to check all 14 individually. So two questions:</p>\n\n<p>1) Is it true I have to reference the Excel checkbox by name, as they're not associated with a specific index, correct (which also means 14 individual lines for access, rather than some sort of for loop)?</p>\n\n<p>2) How do I actually read the value of the checkboxes into my Vsual Basic program? I have tried this:</p>\n\n<pre><code>    Dim oExcel As Excel.Application\n    Dim oBook As Excel.Workbook\n    Dim oSheet As Excel.Worksheet\n\n    oExcel = New Excel.Application      'Create a new instance of Excel\n    oExcel.Workbooks.Open(\"C:\\QA Controller Test Files\\\" &amp; SelectController.Text &amp; \".xlsm\")\n    oSheet = oExcel.Worksheets(1)\n\n    Dim checked As Boolean = oSheet.Shapes(\"Verify USB Revision Reporting\").ControlFormat.Value\n        If checked Then TestSelection.CheckedItems(1) = True\n</code></pre>\n\n<p>I get an error message that says \"Interface 'Microsoft.Office.Interop.Excel.Shapes' cannot be indexed because it has no default property. </p>\n"}, {"tags": ["vba", "excel", "office-2010"], "comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1435150275, "post_id": 31026865, "comment_id": 50078671, "body": "That&#39;s not going to work. Conditional compilation works from constants declared in the project properties, or built-in ones. You can&#39;t use a variable you pass."}, {"owner": {"reputation": 942, "user_id": 4974730, "user_type": "registered", "accept_rate": 60, "profile_image": "https://lh3.googleusercontent.com/-Hvpxpah3yUo/AAAAAAAAAAI/AAAAAAAAAGU/GfmmmHA1IO0/photo.jpg?sz=128", "display_name": "Thomas Shera", "link": "https://stackoverflow.com/users/4974730/thomas-shera"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1435150379, "post_id": 31026865, "comment_id": 50078756, "body": "@Rory what do you mean? What&#39;s the simplest way to implement constants in project properties / built-in ones? Thanks."}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1435150779, "post_id": 31026865, "comment_id": 50079039, "body": "<code>Tools - VBAproject properties</code> then enter them in the Conditional compilation arguments box. However, I think you have completely missed the point of variable types. For example, there is no reason to ever declare a column number variable as <code>Double</code> rather than <code>Long</code>. A given variable typically has only one appropriate type, and that is not related to the hardware your code is running on."}, {"owner": {"reputation": 2953, "user_id": 2801253, "user_type": "registered", "profile_image": "https://graph.facebook.com/1332362525/picture?type=large", "display_name": "Mark Fitzgerald", "link": "https://stackoverflow.com/users/2801253/mark-fitzgerald"}, "edited": false, "score": 1, "creation_date": 1435150957, "post_id": 31026865, "comment_id": 50079170, "body": "possible duplicate of <a href=\"http://stackoverflow.com/questions/30987487/vba-compile-error-statement-invalid-outside-type-block\">VBA &quot;Compile Error: Statement invalid outside Type Block&quot;</a>"}, {"owner": {"reputation": 942, "user_id": 4974730, "user_type": "registered", "accept_rate": 60, "profile_image": "https://lh3.googleusercontent.com/-Hvpxpah3yUo/AAAAAAAAAAI/AAAAAAAAAGU/GfmmmHA1IO0/photo.jpg?sz=128", "display_name": "Thomas Shera", "link": "https://stackoverflow.com/users/4974730/thomas-shera"}, "reply_to_user": {"reputation": 2953, "user_id": 2801253, "user_type": "registered", "profile_image": "https://graph.facebook.com/1332362525/picture?type=large", "display_name": "Mark Fitzgerald", "link": "https://stackoverflow.com/users/2801253/mark-fitzgerald"}, "edited": false, "score": 0, "creation_date": 1435151040, "post_id": 31026865, "comment_id": 50079229, "body": "@MarkFitzgerald this isn&#39;t a duplicate. This is a new problem with a modified version of that code."}, {"owner": {"reputation": 2953, "user_id": 2801253, "user_type": "registered", "profile_image": "https://graph.facebook.com/1332362525/picture?type=large", "display_name": "Mark Fitzgerald", "link": "https://stackoverflow.com/users/2801253/mark-fitzgerald"}, "edited": false, "score": 0, "creation_date": 1435151556, "post_id": 31026865, "comment_id": 50079627, "body": "Apologies! I should have read the two problems more carefully. They are different due to the modifications you made after the answer to your prior question."}], "answers": [{"comments": [{"owner": {"reputation": 942, "user_id": 4974730, "user_type": "registered", "accept_rate": 60, "profile_image": "https://lh3.googleusercontent.com/-Hvpxpah3yUo/AAAAAAAAAAI/AAAAAAAAAGU/GfmmmHA1IO0/photo.jpg?sz=128", "display_name": "Thomas Shera", "link": "https://stackoverflow.com/users/4974730/thomas-shera"}, "edited": false, "score": 0, "creation_date": 1435151455, "post_id": 31027400, "comment_id": 50079561, "body": "OK&lt;, thanks, so if I do this, I have my MsgBox part, and then GoTo FunctionLong / FunctionDouble / FunctionInteger, correct?"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "reply_to_user": {"reputation": 942, "user_id": 4974730, "user_type": "registered", "accept_rate": 60, "profile_image": "https://lh3.googleusercontent.com/-Hvpxpah3yUo/AAAAAAAAAAI/AAAAAAAAAGU/GfmmmHA1IO0/photo.jpg?sz=128", "display_name": "Thomas Shera", "link": "https://stackoverflow.com/users/4974730/thomas-shera"}, "edited": false, "score": 0, "creation_date": 1435185410, "post_id": 31027400, "comment_id": 50100563, "body": "@ThomasShera - The sample code above assumes only one sub, and the type would be set at compile time.  If you need to switch at runtime, you would need to create one function for each type, then use an <code>If</code> or <code>Select</code> to call the appropriate function depending on the passed type."}], "tags": [], "owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "is_accepted": true, "score": 1, "last_activity_date": 1435151101, "creation_date": 1435151101, "answer_id": 31027400, "question_id": 31026865, "link": "https://stackoverflow.com/questions/31026865/vba-type-mismatch-conditional-compiling/31027400#31027400", "title": "VBA Type Mismatch (Conditional Compiling)", "body": "<p>The type mismatch is that the compiler is expecting a <code>Const</code> - it has nothing do with the values you're checking against. The variable <code>VarType</code> isn't a constant, so this code won't work as structured currently.  There simply isn't a way to select how variables are declared at runtime - that's what Variants are for.  If you need to do this pre-compile, you need to declare a constant,  change the constant to the value you want to compile with, then recompile.  For example:</p>\n\n<pre><code>Option Explicit\n\n#Const VarType = \"Long\"\n\nSub Function1()\n\n    #If VarType = \"Long\" Then\n        Dim RangeNOut As Long, vRangeNIn As Long, Ind6 As Long, Ind4 As Long, Ind5 As Long\n        Dim Step2 As Long, MRow As Long, ColIn As Long, Ind3 As Long, Mcol As Long\n        Dim MxRNo As Long, BgrSum As Long, RowIn As Long, Ind As Long, M40eff As Long, Step As Long\n        Dim ColNo As Long, Startcol As Long, Startrow As Long, MeanComp As Long\n        Dim PlateNo As Long, MonoVal As Long, Ind1 As Long, EntryRow2 As Long, EntryRow As Long\n        Dim Ind2 As Long, BgrValP As Long, BgrRow As Long, M40eff As Long\n        Dim BrgSum As Long, BgrVal As Long, RangeNIn As Long, RangeNOut As Long, TLCorn As Long\n        Dim Volcorr As Long, BRCorn As Long, MEeff As Long, MediaVal As Long\n    #ElseIf VarType = \"Double\" Or \"double\" Then\n        '....\n        '....\n        '....\n        '....\n    #End If\n</code></pre>\n\n<p>If you need to be able to do this at runtime, you'll have to write a distinct function for each type and select between them with standard <code>If</code> or <code>Select</code> syntax, not precompiler switching.</p>\n"}], "owner": {"reputation": 942, "user_id": 4974730, "user_type": "registered", "accept_rate": 60, "profile_image": "https://lh3.googleusercontent.com/-Hvpxpah3yUo/AAAAAAAAAAI/AAAAAAAAAGU/GfmmmHA1IO0/photo.jpg?sz=128", "display_name": "Thomas Shera", "link": "https://stackoverflow.com/users/4974730/thomas-shera"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 378, "favorite_count": 0, "accepted_answer_id": 31027400, "answer_count": 1, "score": 0, "last_activity_date": 1442277105, "creation_date": 1435149619, "last_edit_date": 1442277105, "question_id": 31026865, "link": "https://stackoverflow.com/questions/31026865/vba-type-mismatch-conditional-compiling", "title": "VBA Type Mismatch (Conditional Compiling)", "body": "<p>My Dim statements are not working: there is an error mesasge:</p>\n\n<p>Compile error:\nType mismatch</p>\n\n<p>I am conditionally compiling a VBA macro which uses a lot of algebra, a lot of numbers, and a lot of files, so execution time will be massive unless I tweak the data types. It is best to allow the user to do this, based on the speed of the user's computer and how much time is available. </p>\n\n<p>Here is the code:</p>\n\n<pre><code>' Develop fake data to at glance recognize whether program works.\n' Source http://www.cpearson.com/excel/optimize.htm\nOption Explicit\n\nSub Function1(ByVal VarType As String)\n\n    Dim mVers As String\n    Dim userChoice As Variant\n\n'   Give the user macro options based on how fast or slow the computer is using advanced conditional compliling\n    userChoice = MsgBox(\"This macro by default treats all numbers as doubles for maximum precision. If you are running this macro on an old computer, you may want to relare numbers as singles, to speed up the macro.\" &amp; vbNewLine &amp; \"You can also use integers for a quick estimate of data results.\")\n    userChoice = VarType\n\n    #If VarType = \"Long\" Or \"long\" Then\n        Dim RangeNOut As Long, vRangeNIn As Long, Ind6 As Long, Ind4 As Long, Ind5 As Long\n        Dim Step2 As Long, MRow As Long, ColIn As Long, Ind3 As Long, Mcol As Long\n        Dim MxRNo As Long, BgrSum As Long, RowIn As Long, Ind As Long, M40eff As Long, Step As Long\n        Dim ColNo As Long, Startcol As Long, Startrow As Long, MeanComp As Long\n        Dim PlateNo As Long, MonoVal As Long, Ind1 As Long, EntryRow2 As Long, EntryRow As Long\n        Dim Ind2 As Long, BgrValP As Long, BgrRow As Long, M40eff As Long\n        Dim BrgSum As Long, BgrVal As Long, RangeNIn As Long, RangeNOut As Long, TLCorn As Long\n        Dim Volcorr As Long, BRCorn As Long, MEeff As Long, MediaVal As Long\n\n    #If VarType = \"Double\" Or \"double\" Then\n        Dim RangeNOut As Double, vRangeNIn As Double, Ind6 As Double, Ind4 As Double, Ind5 As Double\n        Dim Step2 As Double, MRow As Double, ColIn As Double, Ind3 As Double, Mcol As Double\n        Dim MxRNo As Double, BgrSum As Double, RowIn As Double, Ind As Double, M40eff As Double, Step As Double\n        Dim ColNo As Double, Startcol As Double, Startrow As Double, MeanComp As Double\n        Dim PlateNo As Double, MonoVal As Double, Ind1 As Double, EntryRow2 As Double, EntryRow As Double\n        Dim Ind2 As Double, BgrValP As Double, BgrRow As Double, M40eff As Double\n        Dim BrgSum As Double, BgrVal As Double, RangeNIn As Double, RangeNOut As Double, TLCorn As Double\n        Dim Volcorr As Double, BRCorn As Double, MEeff As Double, MediaVal As Double\n\n    #ElseIf VarType = \"Single\" Or \"single\" Then\n        Dim RangeNOut As Single, vRangeNIn As Single, ecInd6 As Single, Ind4 As Single, Ind5 As Single\n        Step2 As Single, MRow As Single, ColIn As Single, Ind3 As Single, Mcol As Single\n        Dim MxRNo As Single, BgrSum As Single, RowIn As Single, Ind As Single, M40eff As Single, Step As Single\n        Dim ColNo As Single, Startcol As Single, Startrow As Single, MeanComp As Single\n        Dim PlateNo As Single, MonoVal As Single, Ind1 As Single, EntryRow2 As Single, EntryRow As Single\n        Dim Ind2 As Single, BgrValP As Single, BgrRow As Single, M40eff As Single\n        Dim BrgSum As Single, BgrVal As Single, RangeNIn As Single, RangeNOut As Single, TLCorn As Single\n        Dim Volcorr As Single, BRCorn As Single, MEeff As Single, MediaVal As Single\n\n    #ElseIf VarType = \"Integer\" Or \"integer\" Then\n        Dim RangeNOut As Integer, vRangeNIn As Integer, ecInd6 As Integer, Ind4 As Integer, Ind5 As Integer\n        Dim Step2 As Integer, MRow As Integer, ColIn As Integer, Ind3 As Integer, Mcol As Integer\n        Dim MxRNo As Integer, BgrSum As Integer, RowIn As Integer, Ind As Integer, M40eff As Integer\n        Dim Step As Integer, ColNo As Integer, Startcol As Integer, Startrow As Integer, MeanComp As Integer\n        Dim PlateNo As Integer, MonoVal As Integer, Ind1 As Integer, EntryRow2 As Integer, EntryRow As Integer\n        Dim Ind2 As Integer, BgrValP As Integer, BgrRow As Integer, M40eff As Integer\n        Dim BrgSum As Integer, BgrVal As Integer, RangeNIn As Integer, RangeNOut As Integer, TLCorn As Integer\n        Dim Volcorr As Integer, BRCorn As Integer, MEeff As Integer, MediaVal As Integer\n\n    #Else\n        MsgBox \"VarType \" &amp; VarType &amp; \" is not valid. Check spelling.\"\n    #End If\n</code></pre>\n\n<p>The line which causes the type mismatch error message:</p>\n\n<pre><code>#If VarType = \"Long\" Or \"long\" Then\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1435148627, "post_id": 31026371, "comment_id": 50077454, "body": "If you need to cater for all sheet types (including chart sheets) you&#39;ll have to open the workbook and loop through the sheets."}, {"owner": {"reputation": 735, "user_id": 4619569, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EEDZ7.jpg?s=128&g=1", "display_name": "nicolaus-hee", "link": "https://stackoverflow.com/users/4619569/nicolaus-hee"}, "edited": false, "score": 0, "creation_date": 1435149277, "post_id": 31026371, "comment_id": 50077969, "body": "Use either <a href=\"http://stackoverflow.com/questions/14358443/vba-list-of-sheets-hyperlinked\">this</a> or <a href=\"http://stackoverflow.com/questions/10654797/how-can-i-use-vba-to-list-all-worksheets-in-a-workbook-within-a-string\">this</a> answer and wrap it in <code>Workbook.Open</code> and <code>.Close</code> commands."}, {"owner": {"reputation": 12766, "user_id": 863240, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/a2221c5cbaa548f9022616b4f6d6a59a?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Du\u0161ek", "link": "https://stackoverflow.com/users/863240/daniel-du%c5%a1ek"}, "edited": false, "score": 0, "creation_date": 1435150192, "post_id": 31026371, "comment_id": 50078602, "body": "If you don&#39;t want to open each excel workbook to get the sheet names you can use ADO and query the closed workbook. Example e.g. <a href=\"http://www.mrexcel.com/forum/excel-questions/47074-get-worksheet-names-closed-workbook.html\" rel=\"nofollow noreferrer\">here</a>."}, {"owner": {"reputation": 22957, "user_id": 78522, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3facb4a672d9fbeb9f2ed6b5acc65633?s=128&d=identicon&r=PG", "display_name": "Patrick Honorez", "link": "https://stackoverflow.com/users/78522/patrick-honorez"}, "reply_to_user": {"reputation": 12766, "user_id": 863240, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/a2221c5cbaa548f9022616b4f6d6a59a?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Du\u0161ek", "link": "https://stackoverflow.com/users/863240/daniel-du%c5%a1ek"}, "edited": false, "score": 0, "creation_date": 1567075415, "post_id": 31026371, "comment_id": 101858934, "body": "@dee unofrtunately this example is very old and only works with .XLS files."}, {"owner": {"reputation": 12766, "user_id": 863240, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/a2221c5cbaa548f9022616b4f6d6a59a?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Du\u0161ek", "link": "https://stackoverflow.com/users/863240/daniel-du%c5%a1ek"}, "reply_to_user": {"reputation": 22957, "user_id": 78522, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3facb4a672d9fbeb9f2ed6b5acc65633?s=128&d=identicon&r=PG", "display_name": "Patrick Honorez", "link": "https://stackoverflow.com/users/78522/patrick-honorez"}, "edited": false, "score": 0, "creation_date": 1567174788, "post_id": 31026371, "comment_id": 101897188, "body": "@PatrickHonorez good to know, thanks for this information!"}], "answers": [{"tags": [], "owner": {"reputation": 46, "user_id": 5032978, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153015846792087/picture?type=large", "display_name": "Andrew Toomey", "link": "https://stackoverflow.com/users/5032978/andrew-toomey"}, "is_accepted": false, "score": 2, "last_activity_date": 1435149979, "creation_date": 1435149979, "answer_id": 31026991, "question_id": 31026371, "link": "https://stackoverflow.com/questions/31026371/excel-vba-list-all-sheets-in-a-specific-file/31026991#31026991", "title": "Excel VBA list all sheets in a specific file", "body": "<p>You'll have to open the workbook and loop through the sheet objects</p>\n\n<pre><code>Application.Workbooks.Open Filename:=folderspec &amp; f1.Name\nFor i = 1 to ActiveWorkbook.Sheets.Count\n    strFlenme = ActiveWorkbook.FullName\n    strShtNme = ActiveWorkbook.Sheets(i).Name\n    Debug.print strFlenme &amp; \" - \" &amp; i &amp; \" '\" &amp; strShtNme &amp; \"'\" \nNext\n</code></pre>\n"}], "owner": {"reputation": 577, "user_id": 1220515, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/f7ab7d1734e1db3bfa21eaffc468f228?s=128&d=identicon&r=PG", "display_name": "cornerstone", "link": "https://stackoverflow.com/users/1220515/cornerstone"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1426, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1435169044, "creation_date": 1435148348, "last_edit_date": 1435169044, "question_id": 31026371, "link": "https://stackoverflow.com/questions/31026371/excel-vba-list-all-sheets-in-a-specific-file", "title": "Excel VBA list all sheets in a specific file", "body": "<p>I am trying to print a list of all the excel files under a specific folder. Along with the file names, I should also be able to print the names of all the sheets under the excel file.</p>\n\n<p>Below is a sample of my code for printing the file names is as below. However, I am not able to figure out how to read the list of sheet names under the file?</p>\n\n<pre><code>    Sub ButtonRun_Excel_Compare_Report_Click()\n    Sheet1.Cells.Clear\n    ShowFolderList (\"D:\\temp\")\nEnd Sub\n\nSub ShowFolderList(folderspec)\n    Dim fs, f, f1, fc, s, sFldr\n    Set fs = CreateObject(\"Scripting.FileSystemObject\")\n    Set f = fs.GetFolder(folderspec)\n    Set fc = f.SubFolders\n     For Each f1 In fc\n        If Right(f1, 1) &lt;&gt; \"\\\" Then ShowFolderList f1 &amp; \"\\\" Else ShowFolderList f1\n    Next\n    Set fc = f.Files\n    Rowcnt = 1\n    For Each f1 In fc\n\n        If f1.Name Like \"*.xls\" Then\n\n            'How to loop through the Sheets under exach file?\n\n            Sheet1.Cells(Rowcnt, 1) = f1.Name\n            'Sheet1.Cells(Rowcnt, 2) = f1.Path\n            Rowcnt = Rowcnt + 1\n            'Debug.Print folderspec &amp; f1.Name\n        End If\n    Next\nEnd Sub\n</code></pre>\n\n<p>Appreciate the help. Thanks</p>\n"}, {"tags": ["excel", "ms-access", "vba"], "comments": [{"owner": {"reputation": 18134, "user_id": 2143262, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pvJyO.jpg?s=128&g=1", "display_name": "Kazimierz Jawor", "link": "https://stackoverflow.com/users/2143262/kazimierz-jawor"}, "edited": false, "score": 1, "creation_date": 1435146536, "post_id": 31025684, "comment_id": 50076024, "body": "use <code>Activesheet.Cells(a,b).Select</code>... and try to avoid <code>Selection</code> if possible!"}, {"owner": {"reputation": 255, "user_id": 2462955, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/wTr3k.png?s=128&g=1", "display_name": "Abhii", "link": "https://stackoverflow.com/users/2462955/abhii"}, "reply_to_user": {"reputation": 18134, "user_id": 2143262, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pvJyO.jpg?s=128&g=1", "display_name": "Kazimierz Jawor", "link": "https://stackoverflow.com/users/2143262/kazimierz-jawor"}, "edited": false, "score": 0, "creation_date": 1435148449, "post_id": 31025684, "comment_id": 50077329, "body": "It can&#39;t be done with help of range.?"}], "answers": [{"comments": [{"owner": {"reputation": 255, "user_id": 2462955, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/wTr3k.png?s=128&g=1", "display_name": "Abhii", "link": "https://stackoverflow.com/users/2462955/abhii"}, "edited": false, "score": 0, "creation_date": 1435149672, "post_id": 31025745, "comment_id": 50078238, "body": "I want it in a range format. If it is Possible. Otherwise, I can use cells."}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "reply_to_user": {"reputation": 255, "user_id": 2462955, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/wTr3k.png?s=128&g=1", "display_name": "Abhii", "link": "https://stackoverflow.com/users/2462955/abhii"}, "edited": false, "score": 0, "creation_date": 1435149703, "post_id": 31025745, "comment_id": 50078258, "body": "Why? What difference does it make to you?"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "reply_to_user": {"reputation": 255, "user_id": 2462955, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/wTr3k.png?s=128&g=1", "display_name": "Abhii", "link": "https://stackoverflow.com/users/2462955/abhii"}, "edited": false, "score": 0, "creation_date": 1435152382, "post_id": 31025745, "comment_id": 50080224, "body": "Your example is only one cell. If you need multiple, you can use <code>Range(Cells(x, y), Cells(j, k))</code> where the two cells are the top left and bottom right cells in the range you want."}], "tags": [], "owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "is_accepted": true, "score": 1, "last_activity_date": 1435146581, "creation_date": 1435146581, "answer_id": 31025745, "question_id": 31025684, "link": "https://stackoverflow.com/questions/31025684/dynamic-naming-of-range-of-excel-using-vba/31025745#31025745", "title": "Dynamic Naming of Range of Excel using vba", "body": "<p>First, it's <code>Activesheet</code> not <code>ActiveWorksheet</code>. Second you need to use the <code>Cells</code> property rather than <code>Range</code> if you have a row and column number:</p>\n\n<pre><code>Activesheet.Cells(a, b).select\n</code></pre>\n\n<p>where <code>a</code> is the row number and <code>b</code> the column (can be a number or letter)</p>\n"}], "owner": {"reputation": 255, "user_id": 2462955, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/wTr3k.png?s=128&g=1", "display_name": "Abhii", "link": "https://stackoverflow.com/users/2462955/abhii"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 0, "accepted_answer_id": 31025745, "answer_count": 1, "score": 0, "last_activity_date": 1594644263, "creation_date": 1435146408, "last_edit_date": 1594644263, "question_id": 31025684, "link": "https://stackoverflow.com/questions/31025684/dynamic-naming-of-range-of-excel-using-vba", "title": "Dynamic Naming of Range of Excel using vba", "body": "<p>I have two variables :</p>\n\n<p>a=5\nb=8</p>\n\n<p>I want to define a Range like </p>\n\n<pre><code>'Activeworksheet.Range(a,b).select\n    selection.copy\n    Activeworksheet.Range((a+1),(b+a)).select\n    selection.paste\n    `\n</code></pre>\n\n<p>This can be done for one variable like </p>\n\n<pre><code>Activeworksheet.Range(\"E\" &amp; b).select\n</code></pre>\n\n<p>and when I am trying this</p>\n\n<pre><code> Activeworksheet.Range(&amp;a &amp; b).select\n</code></pre>\n\n<p>Its also not working. </p>\n\n<p>How to name the range dynamically using two variables.</p>\n"}, {"tags": ["vba", "layout", "powerpoint", "slide"], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 4424336, "user_type": "registered", "profile_image": "https://graph.facebook.com/925271900863524/picture?type=large", "display_name": "John Niezen", "link": "https://stackoverflow.com/users/4424336/john-niezen"}, "edited": false, "score": 0, "creation_date": 1435233006, "post_id": 31029287, "comment_id": 50120071, "body": "Thanks for the update, works. &lt;br/&gt; &#39; iFileNum = FreeFile()   Open sFileName For Output As iFileNum   For x = 1 To ActivePresentation.Slides.Count     With ActivePresentation       Print #iFileNum, .Slides(x).CustomLayout.Name &amp; vbTab &amp; .Slides(x).CustomLayout.Index     End With     Next   Close iFileNum &#39;"}, {"owner": {"reputation": 11, "user_id": 4424336, "user_type": "registered", "profile_image": "https://graph.facebook.com/925271900863524/picture?type=large", "display_name": "John Niezen", "link": "https://stackoverflow.com/users/4424336/john-niezen"}, "edited": false, "score": 0, "creation_date": 1435233413, "post_id": 31029287, "comment_id": 50120302, "body": "Sorry for the wrong formatting, tried it, but now system gives me a 5 minute warning."}, {"owner": {"reputation": 12482, "user_id": 1667023, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JXaUt.png?s=128&g=1", "display_name": "Steve Rindsberg", "link": "https://stackoverflow.com/users/1667023/steve-rindsberg"}, "reply_to_user": {"reputation": 11, "user_id": 4424336, "user_type": "registered", "profile_image": "https://graph.facebook.com/925271900863524/picture?type=large", "display_name": "John Niezen", "link": "https://stackoverflow.com/users/4424336/john-niezen"}, "edited": false, "score": 0, "creation_date": 1435246154, "post_id": 31029287, "comment_id": 50130499, "body": "Just to be sure, you mean that the code works but SO won&#39;t let you reformat.  In other words, all ok, right?"}, {"owner": {"reputation": 11, "user_id": 4424336, "user_type": "registered", "profile_image": "https://graph.facebook.com/925271900863524/picture?type=large", "display_name": "John Niezen", "link": "https://stackoverflow.com/users/4424336/john-niezen"}, "edited": false, "score": 0, "creation_date": 1435335932, "post_id": 31029287, "comment_id": 50174432, "body": "Yes it does Steve.  &lt;br/&gt; Now figuring out how to get 1 specific layout to count and then make it available for the TOC."}], "tags": [], "owner": {"reputation": 12482, "user_id": 1667023, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JXaUt.png?s=128&g=1", "display_name": "Steve Rindsberg", "link": "https://stackoverflow.com/users/1667023/steve-rindsberg"}, "is_accepted": false, "score": 0, "last_activity_date": 1435155948, "creation_date": 1435155948, "answer_id": 31029287, "question_id": 31025472, "link": "https://stackoverflow.com/questions/31025472/find-the-slidelayout-in-powerpoint/31029287#31029287", "title": "Find the slidelayout in PowerPoint", "body": "<p>You don't need all that mess with idSlide; oSlide gives you a reference to each slide in the presentation, so:</p>\n\n<pre><code>For Each oSlide In ActivePresentation.Slides\n    Debug.Print oSlide.CustomLayout.Name\nNext\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 4424336, "user_type": "registered", "profile_image": "https://graph.facebook.com/925271900863524/picture?type=large", "display_name": "John Niezen", "link": "https://stackoverflow.com/users/4424336/john-niezen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 87, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1435155948, "creation_date": 1435145716, "last_edit_date": 1435147106, "question_id": 31025472, "link": "https://stackoverflow.com/questions/31025472/find-the-slidelayout-in-powerpoint", "title": "Find the slidelayout in PowerPoint", "body": "<p>I am trying to figure out if a specific custom layout is in my presentation.\nI want to use this to create a slide with a TOC that lists the slides with this specific layout.</p>\n\n<p>After some searching and trying I got this far, but it aborts on the below bold item, any suggestions :</p>\n\n<pre><code>Sub ShowSlideLayouts()\n\n  Dim oSlide As Slide\n  Dim idSlide As String\n  Dim oLayoutName As String\n  Dim sFileName As String\n  Dim iFileNum As String\n\n  sFileName = \"C:\\temp\\PowerPointLayouts.TXT\"\n\n  iFileNum = FreeFile()\n  Open sFileName For Output As iFileNum\n\n  For Each oSlide In ActivePresentation.Slides\n    idSlide = ActivePresentation.Slides.***SlideID*** &lt;-- wrong method/member\n\n    'Print #iFileNum, oSlide.Layout\n    Print #iFileNum, ActivePresentation.Slides(idSlide).CustomLayout.Name\n    'Print #iFileNum, ActivePresentation.Slides.getAttribute(\"layout\")\n    'For Each oLayoutName In ActivePresentation.Slides().CustomLayouts.Name\n    'MsgBox ActivePresentation.Slides(idSlide).CustomLayout.Name\n        'Print #iFileNum, oLayoutName.Id &amp; vbTab &amp; oLayoutName.Caption\n   ' Next\n\n Next\n\n  Close iFileNum\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "types"], "answers": [{"tags": [], "owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "is_accepted": false, "score": 1, "last_activity_date": 1435146327, "creation_date": 1435146327, "answer_id": 31025653, "question_id": 31025457, "link": "https://stackoverflow.com/questions/31025457/vba-error-1004-in-function/31025653#31025653", "title": "VBA Error 1004 in function", "body": "<p>The error isn't a type error. The problem is that you are trying to access a cell that doesn't exist. Your loop evidently fails to reach a cell that holds the value \"Row labels\" and eventually tries to access Cells(0,1) -- which triggers error 1004. As to why this is happening -- you haven't provided enough details to say.</p>\n"}, {"tags": [], "owner": {"reputation": 5002, "user_id": 2559297, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/lxuup.jpg?s=128&g=1", "display_name": "D_Bester", "link": "https://stackoverflow.com/users/2559297/d-bester"}, "is_accepted": false, "score": 1, "last_activity_date": 1435147537, "creation_date": 1435147537, "answer_id": 31026070, "question_id": 31025457, "link": "https://stackoverflow.com/questions/31025457/vba-error-1004-in-function/31026070#31026070", "title": "VBA Error 1004 in function", "body": "<p>I suspect that the value in the cell is actually \"Row Labels\" or \"ROW LABELS\" or Row labels \" or something else that doesn't actually match exactly. Try this:</p>\n\n<pre><code>Do Until Trim(Ucase(Cells(lig - i, 1))) = \"ROW LABELS\" \n</code></pre>\n\n<p>Or if you simply want to stop at row one use this:</p>\n\n<pre><code>Do Until lig - i = 1\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 37, "user_id": 5024299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0fbdf932ba7a36b35bb5793bf7d78d9a?s=128&d=identicon&r=PG&f=1", "display_name": "Roux", "link": "https://stackoverflow.com/users/5024299/roux"}, "edited": false, "score": 0, "creation_date": 1435149427, "post_id": 31026277, "comment_id": 50078081, "body": "Thanks, it was indeed trying to reach a non existant cell."}, {"owner": {"reputation": 1949, "user_id": 1723119, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/8182f3271d9881acad7c1a4d8844ca15?s=128&d=identicon&r=PG", "display_name": "99moorem", "link": "https://stackoverflow.com/users/1723119/99moorem"}, "reply_to_user": {"reputation": 37, "user_id": 5024299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0fbdf932ba7a36b35bb5793bf7d78d9a?s=128&d=identicon&r=PG&f=1", "display_name": "Roux", "link": "https://stackoverflow.com/users/5024299/roux"}, "edited": false, "score": 0, "creation_date": 1435149687, "post_id": 31026277, "comment_id": 50078250, "body": "you may also want to handle col =0 as that will also cause an error"}], "tags": [], "owner": {"reputation": 1949, "user_id": 1723119, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/8182f3271d9881acad7c1a4d8844ca15?s=128&d=identicon&r=PG", "display_name": "99moorem", "link": "https://stackoverflow.com/users/1723119/99moorem"}, "is_accepted": true, "score": 0, "last_activity_date": 1435148104, "creation_date": 1435148104, "answer_id": 31026277, "question_id": 31025457, "link": "https://stackoverflow.com/questions/31025457/vba-error-1004-in-function/31026277#31026277", "title": "VBA Error 1004 in function", "body": "<p>i=0 will cause an error as the cells(0,1) does not exist in the sheet. You may also want an exit clause for if your logic is never found as you will get an error when you hit the end of the sheet. if you pass this lig =1 you will also get an error (as lig - i (1-1) would result in 0)so you may also want to handle that scenario</p>\n\n<pre><code>Function week(lig As Integer, col As Integer) As Integer\n    Dim i As Integer\n    i = 1'Changed to 1\n    Do Until Cells(lig - i, 1) = \"Row labels\"\n        i = i + 1\n        if i &gt; 1000000 then exit do 'Exit clause\n    Loop\n    if i &lt; 1000000 then \n        week = Cells(lig - i, col)\n    else\n        week = 0'Handle 0's in calling code\n    end if\nEnd Function\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 4022, "user_id": 4413676, "user_type": "registered", "accept_rate": 70, "profile_image": "https://lh6.googleusercontent.com/-voVpW4gy9dA/AAAAAAAAAAI/AAAAAAAACqY/6b-0Iza8ws8/photo.jpg?sz=128", "display_name": "HarveyFrench", "link": "https://stackoverflow.com/users/4413676/harveyfrench"}, "is_accepted": false, "score": 0, "last_activity_date": 1436715136, "creation_date": 1436715136, "answer_id": 31369473, "question_id": 31025457, "link": "https://stackoverflow.com/questions/31025457/vba-error-1004-in-function/31369473#31369473", "title": "VBA Error 1004 in function", "body": "<p>You might like to consider re-writing as follows, which I think is clearer.</p>\n\n<pre><code>Function week(lig As Integer, col As Integer) As Integer\n\n    Dim i As Integer\n\n    ' Thsi function will return 0 if no row with the text is found\n    week = 0\n\n    For i = lig To 1 Step -1\n\n        If Cells(i, 1) = \"Row labels\" Then\n            week = Cells(i, col)\n            Exit For\n        End If\n\n    Next i\n\n\nEnd Function\n\n' EVEN BETTER USE THIS (or similar)!\n\nFunction week(MyCell As Range) As Integer\n\n    Dim i As Integer\n\n    week = 0\n\n    For i = MyCell.Row To 1 Step -1\n\n        If MyCell.Parent.Cells(i, 1) = \"Row labels\" Then\n            week = MyCell.Parent.Cells(i, MyCell.Column)\n            Exit For\n        End If\n\n        ' Note\n        ' MyCell.Parent. returns the sheet containing the cell\n        ' Just using Cells(i, 1) (wihtout preceeding with \"MyCell.Parent.\" will pick up\n        ' cells on the currently active sheet, which may not be the sheet with the cell!\n        '\n\n    Next i\n\n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 37, "user_id": 5024299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0fbdf932ba7a36b35bb5793bf7d78d9a?s=128&d=identicon&r=PG&f=1", "display_name": "Roux", "link": "https://stackoverflow.com/users/5024299/roux"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 215, "favorite_count": 0, "accepted_answer_id": 31026277, "answer_count": 4, "score": 1, "last_activity_date": 1436715136, "creation_date": 1435145675, "question_id": 31025457, "link": "https://stackoverflow.com/questions/31025457/vba-error-1004-in-function", "title": "VBA Error 1004 in function", "body": "<p>I'm trying to write a function which returns the value of a specific cell located on the same column as the one I give in argument, (lig= row number, col=column number), but everytime I run it, I get an error '1004\", here's my code:</p>\n\n<pre><code>Function week(lig As Integer, col As Integer) As Integer\n    Dim i As Integer\n    i = 0\n    Do Until Cells(lig - i, 1) = \"Row labels\"\n        i = i + 1\n    Loop\n    week = Cells(lig - i, col)\nEnd Function\n</code></pre>\n\n<p>The line in which the error appears is : </p>\n\n<pre><code> Do Until Cells(lig - i, 1) = \"Row labels\"\n</code></pre>\n\n<p>I know that I test the values of cells containing integers before getting to this one, I suspeect a type error, but I can't fix it. \nCould anyone please help ?</p>\n"}, {"tags": ["vba", "excel", "userform"], "comments": [{"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1435144466, "post_id": 31024876, "comment_id": 50074675, "body": "where are both the textboxes?"}, {"owner": {"reputation": 67, "user_id": 5041477, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/26dc5350290fc3757e1431e361c54d8e?s=128&d=identicon&r=PG&f=1", "display_name": "d00nn12", "link": "https://stackoverflow.com/users/5041477/d00nn12"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1435144579, "post_id": 31024876, "comment_id": 50074760, "body": "in a userform excel textboxname(txtKordinatat)"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1435144611, "post_id": 31024876, "comment_id": 50074775, "body": "both are on the same form?"}, {"owner": {"reputation": 67, "user_id": 5041477, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/26dc5350290fc3757e1431e361c54d8e?s=128&d=identicon&r=PG&f=1", "display_name": "d00nn12", "link": "https://stackoverflow.com/users/5041477/d00nn12"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1435144742, "post_id": 31024876, "comment_id": 50074855, "body": "No I do not want to copy from textbox1 in TextBox2 //. I just need a paste text into the textbox where I&#39;m writing"}], "answers": [{"comments": [{"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1435146255, "post_id": 31025331, "comment_id": 50075857, "body": "++ For figuring it out yourself ;)"}], "tags": [], "owner": {"reputation": 67, "user_id": 5041477, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/26dc5350290fc3757e1431e361c54d8e?s=128&d=identicon&r=PG&f=1", "display_name": "d00nn12", "link": "https://stackoverflow.com/users/5041477/d00nn12"}, "is_accepted": false, "score": 2, "last_activity_date": 1435147204, "last_edit_date": 1495539826, "creation_date": 1435145290, "answer_id": 31025331, "question_id": 31024876, "link": "https://stackoverflow.com/questions/31024876/paste-text-to-textbox-via-button-vba-excel/31025331#31025331", "title": "Paste text to textbox via button VBA Excel", "body": "<p>As mentioned in the comments, the post from <a href=\"https://stackoverflow.com/questions/9022245/get-text-from-clipboard-using-gettext-avoid-error-on-empty-clipboard\">Get text from clipboard using GetText - avoid error on empty clipboard</a> helped me arrive at the solution that I was looking for.</p>\n\n<pre><code>    Dim DataObj As MsForms.DataObject\n    Set DataObj = New MsForms.DataObject \n\n    On Error GoTo Whoa\n\n    '~~&gt; Get data from the clipboard.\n    DataObj.GetFromClipboard\n\n    '~~&gt; Get clipboard contents\n    Me.txtKordinatat.Value = DataObj.GetText(1)\n\n    Exit Sub\nWhoa:\n    If Err &lt;&gt; 0 Then MsgBox \"Data on clipboard is not text or is empty\"\n</code></pre>\n"}], "owner": {"reputation": 67, "user_id": 5041477, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/26dc5350290fc3757e1431e361c54d8e?s=128&d=identicon&r=PG&f=1", "display_name": "d00nn12", "link": "https://stackoverflow.com/users/5041477/d00nn12"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1876, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1435147204, "creation_date": 1435143887, "last_edit_date": 1435144379, "question_id": 31024876, "link": "https://stackoverflow.com/questions/31024876/paste-text-to-textbox-via-button-vba-excel", "title": "Paste text to textbox via button VBA Excel", "body": "<p>I want a copy and a paste button in MS Excel, the copy button looks like this  </p>\n\n<pre><code>Private Sub CommandButton1_Click()\nDim MyData As New DataObject\nMyData.SetText TextBox1.Text\nMyData.PutInClipboard\nEnd Sub\n</code></pre>\n\n<p>Now, how can I make/code a PASTE button in a similar fashion?</p>\n"}, {"tags": ["excel", "error-handling", "vba"], "answers": [{"tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 0, "last_activity_date": 1435143245, "creation_date": 1435143245, "answer_id": 31024658, "question_id": 31024466, "link": "https://stackoverflow.com/questions/31024466/on-error-cancel-what-already-done/31024658#31024658", "title": "On error -&gt; cancel what already done", "body": "<p>You can try:</p>\n\n<pre><code>Application.UnDo\n</code></pre>\n\n<p>in your error code.  <em>It does not always work.</em></p>\n"}, {"tags": [], "owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "is_accepted": false, "score": 0, "last_activity_date": 1443406544, "last_edit_date": 1443406544, "creation_date": 1443406157, "answer_id": 32814818, "question_id": 31024466, "link": "https://stackoverflow.com/questions/31024466/on-error-cancel-what-already-done/32814818#32814818", "title": "On error -&gt; cancel what already done", "body": "<p>VBA execution causes the Undo history to be erased</p>\n\n<ul>\n<li>code that changes the interface in any way will clear the Undo buffer (stack)</li>\n<li><p>the history is a list (or collection) of strings</p>\n\n<ul>\n<li><code>Application.CommandBars(\"Standard\").Controls(\"&amp;Undo\").Control.ListCount</code> is 0</li>\n</ul></li>\n</ul>\n\n<p>but you might be able to do something like this</p>\n\n<pre><code>Option Explicit\n\nPublic Sub makeFiles()\n    Dim i As Long, currentWB As Long, newWBs As Long\n\n    On Error GoTo cancelAction\n\n    currentWB = Workbooks.Count\n    For i = 1 To 6\n        Workbooks.Add\n        newWBs = newWBs + 1\n        ActiveSheet.Cells(1, 1).Value = 4\n\n        'generate an error\n        If i = 3 Then Workbooks.Item(Workbooks.Count + 1).Activate\n    Next\n\ncancelAction:\n\n    Do While newWBs &gt; 0     'Workbooks.Count &gt; 1\n        Workbooks(currentWB + newWBs).Close False\n        newWBs = newWBs - 1\n    Loop\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 17, "user_id": 4601496, "user_type": "registered", "accept_rate": 38, "profile_image": "https://graph.facebook.com/934402706583614/picture?type=large", "display_name": "FabriManga", "link": "https://stackoverflow.com/users/4601496/fabrimanga"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 394, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1443406544, "creation_date": 1435142634, "last_edit_date": 1531164843, "question_id": 31024466, "link": "https://stackoverflow.com/questions/31024466/on-error-cancel-what-already-done", "title": "On error -&gt; cancel what already done", "body": "<p>Is there a way to say to the code that, everytime there is an error, cancel what it's previously done?\nFor example, I have a code which creates 6 workbooks and when there is an error at the half of the code I have to cancel every workbook and launch the macro again!</p>\n\n<p>thanks in advance</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1321, "user_id": 3506217, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/B1laD.jpg?s=128&g=1", "display_name": "Miss Palmer", "link": "https://stackoverflow.com/users/3506217/miss-palmer"}, "edited": false, "score": 0, "creation_date": 1435143451, "post_id": 31024340, "comment_id": 50073987, "body": "why not loop the for each loop in another that loops through all the columns you need?"}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1435145634, "post_id": 31024340, "comment_id": 50075448, "body": "Do you <i>really</i> need to check each of the (typically) 1048576 cells in the column? Or -- just the cells that are actually used? Also -- if the cell color is due to conditional formatting -- why not directly count the cells that satisfy the condition?"}, {"owner": {"reputation": 381, "user_id": 4995716, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/ac9a0782abeab1e5b93879cc24d69df5?s=128&d=identicon&r=PG&f=1", "display_name": "Tony", "link": "https://stackoverflow.com/users/4995716/tony"}, "reply_to_user": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1435146274, "post_id": 31024340, "comment_id": 50075866, "body": "@JohnColeman I am just looking to count the coloured cells in the used rows of data. I am trying to break down a summary per column header so i can fix any errors quickly."}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1435147052, "post_id": 31024340, "comment_id": 50076404, "body": "@Tony something like Range(Cells(1,2),Cells(rows.Count,2).End(xlUp)) is a standard trick to get the range at the top of a column that contains all of the cells which actually have values. Note that the 2 can be replaced by a variable which steps through a range of columns in a loop."}], "answers": [{"comments": [{"owner": {"reputation": 381, "user_id": 4995716, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/ac9a0782abeab1e5b93879cc24d69df5?s=128&d=identicon&r=PG&f=1", "display_name": "Tony", "link": "https://stackoverflow.com/users/4995716/tony"}, "edited": false, "score": 0, "creation_date": 1435158170, "post_id": 31025892, "comment_id": 50084789, "body": "your second solution is great however when i adjust the range and remove the &quot;Col &quot; &amp; Chr(64 + j)&quot; it produces the list of numbers and then a list of &quot;n/a&quot; after"}, {"owner": {"reputation": 2832, "user_id": 1161309, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b27b718aa1e9d3835ef807359666eb34?s=128&d=identicon&r=PG", "display_name": "Raystafarian", "link": "https://stackoverflow.com/users/1161309/raystafarian"}, "reply_to_user": {"reputation": 381, "user_id": 4995716, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/ac9a0782abeab1e5b93879cc24d69df5?s=128&d=identicon&r=PG&f=1", "display_name": "Tony", "link": "https://stackoverflow.com/users/4995716/tony"}, "edited": false, "score": 0, "creation_date": 1435160264, "post_id": 31025892, "comment_id": 50086389, "body": "Why remove the col &amp; char? It&#39;s the string for the array that takes the column number and converts it to a letter. If you&#39;re not starting at A, just change the 64 to a larger number. Or start J at the correct column."}, {"owner": {"reputation": 381, "user_id": 4995716, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/ac9a0782abeab1e5b93879cc24d69df5?s=128&d=identicon&r=PG&f=1", "display_name": "Tony", "link": "https://stackoverflow.com/users/4995716/tony"}, "edited": false, "score": 0, "creation_date": 1435161073, "post_id": 31025892, "comment_id": 50086985, "body": "i already have the list of columns to associate to the numbers in the array, therefore i do not need to display &quot;Col A&quot; etc. However when I change Range(&quot;D1:E&quot; &amp; lastcol) = arr()  to D10 it produces a list of &quot;n/a&quot; after  the array"}, {"owner": {"reputation": 2832, "user_id": 1161309, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b27b718aa1e9d3835ef807359666eb34?s=128&d=identicon&r=PG", "display_name": "Raystafarian", "link": "https://stackoverflow.com/users/1161309/raystafarian"}, "reply_to_user": {"reputation": 381, "user_id": 4995716, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/ac9a0782abeab1e5b93879cc24d69df5?s=128&d=identicon&r=PG&f=1", "display_name": "Tony", "link": "https://stackoverflow.com/users/4995716/tony"}, "edited": false, "score": 0, "creation_date": 1435161142, "post_id": 31025892, "comment_id": 50087030, "body": "You&#39;ll need to dimension the array to a single (vertical) array and print only the count. You could make it an integer array instead of string."}, {"owner": {"reputation": 2832, "user_id": 1161309, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b27b718aa1e9d3835ef807359666eb34?s=128&d=identicon&r=PG", "display_name": "Raystafarian", "link": "https://stackoverflow.com/users/1161309/raystafarian"}, "reply_to_user": {"reputation": 381, "user_id": 4995716, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/ac9a0782abeab1e5b93879cc24d69df5?s=128&d=identicon&r=PG&f=1", "display_name": "Tony", "link": "https://stackoverflow.com/users/4995716/tony"}, "edited": false, "score": 0, "creation_date": 1435224415, "post_id": 31025892, "comment_id": 50114680, "body": "If you have a specific range where you want to print the counts, you don&#39;t need the array at all - you can just print directly there after the count loop. If you need help with that, just let me know where the output range is and what columns you actually need to help, but I&#39;m sure you can probably figure that part out no problem."}], "tags": [], "owner": {"reputation": 2832, "user_id": 1161309, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b27b718aa1e9d3835ef807359666eb34?s=128&d=identicon&r=PG", "display_name": "Raystafarian", "link": "https://stackoverflow.com/users/1161309/raystafarian"}, "is_accepted": true, "score": 0, "last_activity_date": 1435149031, "last_edit_date": 1435149031, "creation_date": 1435147035, "answer_id": 31025892, "question_id": 31024340, "link": "https://stackoverflow.com/questions/31024340/count-coloured-cells-in-each-column-and-return-count/31025892#31025892", "title": "Count coloured cells in each column and return count", "body": "<p>Your way is fine, but it can be refined -</p>\n\n<pre><code>Sub test()\nDim lastrow As Integer\nlastrow = Cells(Rows.Count, \"A\").End(xlUp).Row\nDim cntclr As Integer\ncntclr = 0\nFor i = 1 To lastrow\n    If Cells(i, 1).Interior.Color = vbRed Then\n        cntclr = cntclr + 1\n    End If\nNext\nMsgBox (cntclr)\nEnd Sub\n</code></pre>\n\n<p>If you want to do it for each column, this will do it and print the results, just change the range where the array populates </p>\n\n<pre><code>Sub test()\nDim lastrow As Integer\nlastrow = Cells(Rows.Count, \"A\").End(xlUp).Row\n\nDim lastcol As Integer\nlastcol = Cells(1, Columns.Count).End(xlToLeft).Column\n\nDim arr() As String\nReDim arr(1 To lastcol, 1)\nDim cntClr As Integer\nDim strCol As String\nDim strCnt As String\n\nFor j = 1 To lastcol\n\n    cntClr = 0\n    For i = 1 To lastrow\n    If Cells(i, j).Interior.Color = vbRed Then\n        cntClr = cntClr + 1\n    End If\n    Next\n    strCol = \"Col \" &amp; Chr(64 + j)\n    strCnt = Str(cntClr)\n    arr(j, 0) = strCol\n    arr(j, 1) = cntClr\n\nNext\nRange(\"D1:E\" &amp; lastcol) = arr()\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 11963, "user_id": 2707864, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/LYdpu.png?s=128&g=1", "display_name": "sancho.s ReinstateMonicaCellio", "link": "https://stackoverflow.com/users/2707864/sancho-s-reinstatemonicacellio"}, "is_accepted": false, "score": 0, "last_activity_date": 1435147941, "last_edit_date": 1435147941, "creation_date": 1435147300, "answer_id": 31025974, "question_id": 31024340, "link": "https://stackoverflow.com/questions/31024340/count-coloured-cells-in-each-column-and-return-count/31025974#31025974", "title": "Count coloured cells in each column and return count", "body": "<p>Use</p>\n\n<pre><code>Sub errors()\n\n    Dim Sheet1 As String\n    Dim mycell As Range\n    Dim datecol As Long\n    Dim col As Long\n\n    Sheet1 = \"different\"\n\n    Dim ws As Worksheet, lastrow As Long\n    Dim myrng as Range\n    Set ws = ActiveWorkbook.Sheets(Sheet1)\n    lastrow = ws.Range(\"B\" &amp; ws.Rows.Count).End(xlUp).Row\n    ' If you think you may have colored cells with no data\n    ' Set myrng = ws.UsedRange.Rows\n    ' lastrow = myrng(myrng.Count).Row\n\n    Set myrng = ws.Range(\"B1:B\" &amp; lastrow)\n    For Each mycell In myrng\n        If mycell.Interior.Color = vbRed Then\n            datecol = datecol + 1\n        End If\n    Next mycell\n\n    Debug.Print datecol\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 381, "user_id": 4995716, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/ac9a0782abeab1e5b93879cc24d69df5?s=128&d=identicon&r=PG&f=1", "display_name": "Tony", "link": "https://stackoverflow.com/users/4995716/tony"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 137, "favorite_count": 0, "accepted_answer_id": 31025892, "answer_count": 2, "score": 0, "last_activity_date": 1435149031, "creation_date": 1435142210, "question_id": 31024340, "link": "https://stackoverflow.com/questions/31024340/count-coloured-cells-in-each-column-and-return-count", "title": "Count coloured cells in each column and return count", "body": "<p>I've been trying to find an easier way to return the amount of coloured cells per column. My code so far:</p>\n\n<pre><code>Sub errors()\n\nDim Sheet1 As String\nDim mycell As Range\nDim datecol As Long\nDim col As Long\n\nSheet1 = \"different\"    \n\nFor Each mycell In ActiveWorkbook.Worksheets(shtSheet1).Range(\"B:B\")\n    If mycell.Interior.Color = vbRed Then\n        datecol = datecol + 1\nEnd If\nNext mycell\n\nDebug.Print datecol\n\nEnd Sub\n</code></pre>\n\n<p>If I have 40 columns this is pretty tedious and slow, is  there a better way to do this (pretty new in learning vba) hence I am repeating several For each loops and specifying the column. I need help improving the code or a new method for returning the amount of coloured cells per column.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 0, "creation_date": 1435140038, "post_id": 31023494, "comment_id": 50071739, "body": "You&#39;re missing an <code>End Select</code>. Does this code even run?"}, {"owner": {"reputation": 2923, "user_id": 4497791, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/vCgRs.png?s=128&g=1", "display_name": "eirikdaude", "link": "https://stackoverflow.com/users/4497791/eirikdaude"}, "edited": false, "score": 0, "creation_date": 1435141180, "post_id": 31023494, "comment_id": 50072475, "body": "You also have two <code>End Ifs</code> too many"}, {"owner": {"reputation": 45, "user_id": 3651045, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/92ee48269159cf941aa265cc4c82dc19?s=128&d=identicon&r=PG&f=1", "display_name": "Kimberly", "link": "https://stackoverflow.com/users/3651045/kimberly"}, "reply_to_user": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 0, "creation_date": 1435194617, "post_id": 31023494, "comment_id": 50102912, "body": "@Bathsheba hi, even i add in, it will not able to have the result that expected, the textbox1 will be blank."}, {"owner": {"reputation": 45, "user_id": 3651045, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/92ee48269159cf941aa265cc4c82dc19?s=128&d=identicon&r=PG&f=1", "display_name": "Kimberly", "link": "https://stackoverflow.com/users/3651045/kimberly"}, "reply_to_user": {"reputation": 2923, "user_id": 4497791, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/vCgRs.png?s=128&g=1", "display_name": "eirikdaude", "link": "https://stackoverflow.com/users/4497791/eirikdaude"}, "edited": false, "score": 0, "creation_date": 1435194672, "post_id": 31023494, "comment_id": 50102926, "body": "@eirikdaude is there any other method can solve this?"}], "owner": {"reputation": 45, "user_id": 3651045, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/92ee48269159cf941aa265cc4c82dc19?s=128&d=identicon&r=PG&f=1", "display_name": "Kimberly", "link": "https://stackoverflow.com/users/3651045/kimberly"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 34, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1435142356, "creation_date": 1435139940, "last_edit_date": 1435142356, "question_id": 31023494, "link": "https://stackoverflow.com/questions/31023494/case-statement-issues", "title": "Case Statement issues", "body": "<p>I have an userform. </p>\n\n<p>I wish to find out if it is possible that for a case statement able to check for multiple criteria.</p>\n\n<p>For example:</p>\n\n<ul>\n<li>I have my Customer in ComboBox1, each customer have different type of progress and specification.</li>\n<li>I have the type of progress in ComboBox2 and specification at TextBox1.</li>\n<li>If user selects Customer (ComboBox1) ABC, then the type of progress(ComboBox2) should list out Ni and NiAu.</li>\n<li>When user select Ni, specification (TextBox1) should show 30S while if user select NiAu, specification (TextBox1) should show 40S.</li>\n<li>If user select Customer (ComboBox1) DEF, then the type of progress (ComboBox2) should list out Pd and PdAu. When user select Pd, specification (TextBox1) should show 10A while if user select PdAu, specification (TextBox1) should show 15S.</li>\n</ul>\n\n<p>My code looks like this but it will not list out the specification accordingly.</p>\n\n<pre><code>Private Sub ComboBox1_Change()\n\n  Select Case ComboBox1\n\n  Case \"ABC\"\n    ComboBox2.List =  Array(\"Ni\", \"NiAu\")\n    If ComboBox2.Value=\"Ni\"\n      TextBox1.Value=\"30S\"\n    Else If ComboBox2.Value=\"NiAu\"\n      TextBox1.Value=\"40S\"\n    End If\n    End If\n\n  Case \"DEF\"\n    ComboBox2.List =  Array(\"Pd\", \"PdAu\")\n    If ComboBox2.Value=\"Pd\"\n      TextBox1.Value=\"10A\"\n    Else If ComboBox2.Value=\"PdAu\"\n      TextBox1.Value=\"15S\"\n    End If\n    End If\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "if-statement", "record-count"], "answers": [{"comments": [{"owner": {"reputation": 37, "user_id": 3787739, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/53e85ffe4f2bcd381b4b59e96fb0672a?s=128&d=identicon&r=PG&f=1", "display_name": "MusicMan", "link": "https://stackoverflow.com/users/3787739/musicman"}, "edited": false, "score": 0, "creation_date": 1435147167, "post_id": 31023471, "comment_id": 50076488, "body": "The code jumps to the MsgBox &quot;There are no more 800 records to update.&quot;, vbCritical"}, {"owner": {"reputation": 37, "user_id": 3787739, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/53e85ffe4f2bcd381b4b59e96fb0672a?s=128&d=identicon&r=PG&f=1", "display_name": "MusicMan", "link": "https://stackoverflow.com/users/3787739/musicman"}, "edited": false, "score": 0, "creation_date": 1435149431, "post_id": 31023471, "comment_id": 50078084, "body": "No ... I&#39;m not sure how to do that. I don&#39;t think it&#39;s picking up the recordcount correctly"}], "tags": [], "owner": {"reputation": 5550, "user_id": 1732204, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/X4pln.png?s=128&g=1", "display_name": "PaulFrancis", "link": "https://stackoverflow.com/users/1732204/paulfrancis"}, "is_accepted": false, "score": 0, "last_activity_date": 1435139882, "creation_date": 1435139882, "answer_id": 31023471, "question_id": 31023217, "link": "https://stackoverflow.com/questions/31023217/vba-recordcount-issue/31023471#31023471", "title": "VBA RecordCount Issue", "body": "<p>After you have opened the recordset, you have to move to the last record using the <code>MoveLast</code> method, then go back to the first record using the <code>MoveFirst</code>. Then you get the count, which would be accurate. Something like.</p>\n\n<pre><code>Dim db As DAO.Database\nDim rsDoctorData As DAO.Recordset\nDim rsDoctorContact As DAO.Recordset\nDim strSQLDoctor800 As String\nDim strSQLDoctorContact As String\n\nDim DoctorID As Integer\nDim DoctorName As String\nDim ContactTaken As Boolean\n\nstrSQLDoctor800 = \"SELECT TOP 800 tbl_Full_Data_Doctor.ID_Full_Data, Rnd  ([ID_Full_Data]) AS Random, tbl_Full_Data_Doctor.Reference,     \" &amp; _\n                  \"tbl_Full_Data_Doctor.id_Site, tbl_Full_Data_Doctor.id_Local, tbl_Full_Data_Doctor.Date, tbl_Full_Data_Doctor.Time, tbl_Full_Data_Doctor.Age, \" &amp; _\n                  \"tbl_Full_Data_Doctor.Gender, tbl_Full_Data_Doctor.Complaint, tbl_Full_Data_Doctor.LTM_Medicine, tbl_Full_Data_Doctor.Specialty, \" &amp; _\n                  \"tbl_Full_Data_Doctor.Category, tbl_Full_Data_Doctor.Add_Training, tbl_Full_Data_Doctor.Comments, tbl_Full_Data_Doctor.Taken, \" &amp; _\n                  \"tbl_Full_Data_Doctor.Second_Cat_Contact_id, tbl_Full_Data_Doctor.Second_Cat_Contact_Name \" _\n                &amp; \" FROM tbl_Full_Data_Doctor \" _\n                &amp; \" WHERE (((tbl_Full_Data_Doctor.Taken) = False)) \" _\n                &amp; \" ORDER BY Rnd([ID_Full_Data]); \"\n\nstrSQLDoctorContact = \"SELECT TOP 1 tbl_Contacts.ID, tbl_Contacts.idSite, tbl_Contacts.role, tbl_Contacts.name, tbl_Contacts.email, tbl_Contacts.phone, \" &amp; _\n                      \"tbl_Contacts.involvement, tbl_Contacts.Taken\" _\n                    &amp; \" FROM tbl_Contacts \" _\n                    &amp; \" WHERE (((tbl_Contacts.role)= 'Doctor') AND ((tbl_Contacts.involvement)=True) AND ((tbl_Contacts.Taken)=False)); \"\n\nSet db = CurrentDb\nSet rsDoctorData = db.OpenRecordset(strSQLDoctor800)\nSet rsDoctorContact = db.OpenRecordset(strSQLDoctorContact)\n\nIf rsDoctorContact.RecordCount &lt;&gt; 0 Then\n    If rsDoctorData.RecordCount &lt;&gt; 0 Then   \n        rsDoctorData.MoveLast\n        rsDoctorData.MoveFirst\n        If rsDoctorData.RecordCount &lt; 800 Then\n            While Not rsDoctorData.EOF\n                With rsDoctorData\n                    .Edit\n                    .Fields(\"Taken\") = 1\n                    .Fields(\"Second_Cat_Contact_id\") = DoctorID\n                    .Fields(\"Second_Cat_Contact_name\") = DoctorName\n                    .Update\n                    rsDoctorData.MoveNext\n                End With\n            Wend\n\n            DoCmd.SetWarnings (False)\n            DoCmd.OpenQuery \"upd_Doctor_Taken\"\n            DoCmd.SetWarnings (True)\n        Else\n            MsgBox \"There are no more 800 records to update.\", vbCritical\n        End If\n    End If\n[Forms]![frm_Randomise].Refresh\nElse\n    MsgBox \"There are no Doctors to assign\", vbCritical, \"PIED Project\"\nEnd If\n\nSet rsDoctorData = Nothing\nSet rsDoctorContact = Nothing\nSet db = Nothing\n</code></pre>\n"}], "owner": {"reputation": 37, "user_id": 3787739, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/53e85ffe4f2bcd381b4b59e96fb0672a?s=128&d=identicon&r=PG&f=1", "display_name": "MusicMan", "link": "https://stackoverflow.com/users/3787739/musicman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 89, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1435139882, "creation_date": 1435139231, "question_id": 31023217, "link": "https://stackoverflow.com/questions/31023217/vba-recordcount-issue", "title": "VBA RecordCount Issue", "body": "<p>For some reason the below part of the code isn't working.</p>\n\n<p>If rsDoctorData.RecordCount &lt; 800 Then</p>\n\n<p>I want it to display a message when there are less than 800 records. I've read I need to go to the last record to get the record count but I'm uncertain how to get it to work.</p>\n\n<p>Any thoughts/advice are welcome</p>\n\n<p>Thanks for your help in advance.</p>\n\n<pre><code>Dim db As DAO.Database\nDim rsDoctorData As DAO.Recordset\nDim rsDoctorContact As DAO.Recordset\nDim strSQLDoctor800 As String\nDim strSQLDoctorContact As String\n\nDim DoctorID As Integer\nDim DoctorName As String\nDim ContactTaken As Boolean\n\nstrSQLDoctor800 = \"SELECT TOP 800 tbl_Full_Data_Doctor.ID_Full_Data, Rnd  ([ID_Full_Data]) AS Random, tbl_Full_Data_Doctor.Reference,     tbl_Full_Data_Doctor.id_Site, tbl_Full_Data_Doctor.id_Local, tbl_Full_Data_Doctor.Date, tbl_Full_Data_Doctor.Time, tbl_Full_Data_Doctor.Age, tbl_Full_Data_Doctor.Gender, tbl_Full_Data_Doctor.Complaint, tbl_Full_Data_Doctor.LTM_Medicine, tbl_Full_Data_Doctor.Specialty, tbl_Full_Data_Doctor.Category, tbl_Full_Data_Doctor.Add_Training, tbl_Full_Data_Doctor.Comments, tbl_Full_Data_Doctor.Taken, tbl_Full_Data_Doctor.Second_Cat_Contact_id, tbl_Full_Data_Doctor.Second_Cat_Contact_Name\" _\n    &amp; \" FROM tbl_Full_Data_Doctor \" _\n    &amp; \" WHERE (((tbl_Full_Data_Doctor.Taken) = False)) \" _\n    &amp; \" ORDER BY Rnd([ID_Full_Data]); \"\n\nstrSQLDoctorContact = \"SELECT TOP 1 tbl_Contacts.ID, tbl_Contacts.idSite, tbl_Contacts.role, tbl_Contacts.name, tbl_Contacts.email, tbl_Contacts.phone, tbl_Contacts.involvement, tbl_Contacts.Taken\" _\n&amp; \" FROM tbl_Contacts \" _\n&amp; \" WHERE (((tbl_Contacts.role)= 'Doctor') AND ((tbl_Contacts.involvement)=True) AND ((tbl_Contacts.Taken)=False)); \"\n\n\nSet db = CurrentDb\nSet rsDoctorData = db.OpenRecordset(strSQLDoctor800)\nSet rsDoctorContact = db.OpenRecordset(strSQLDoctorContact)\n\nIf rsDoctorContact.RecordCount &lt;&gt; 0 Then\n\nDoctorID = DLookup(\"[ID]\", \"qry_Doctor_Contact_Taken\")\nDoctorName = DLookup(\"[name]\", \"qry_Doctor_Contact_Taken\")\nContactTaken = DLookup(\"[Taken]\", \"qry_Doctor_Contact_Taken\")\n\n        If rsDoctorData.RecordCount &lt; 800 Then\n\n            While Not rsDoctorData.EOF\n\n                With rsDoctorData\n                    .Edit\n                    .Fields(\"Taken\") = 1\n                    .Fields(\"Second_Cat_Contact_id\") = DoctorID\n                    .Fields(\"Second_Cat_Contact_name\") = DoctorName\n                    .Update\n                    rsDoctorData.MoveNext\n\n                End With\n\n            Wend\n\n                DoCmd.SetWarnings (False)\n\n                    DoCmd.OpenQuery \"upd_Doctor_Taken\"\n\n                DoCmd.SetWarnings (True)\n\n        Else\n\n            MsgBox \"There are no more 800 records to update.\", vbCritical\n\n        End If\n\n    [Forms]![frm_Randomise].Refresh\n\nElse\n\n    MsgBox \"There are no Doctors to assign\", vbCritical, \"PIED Project\"\n\nEnd If\n\nSet rsDoctorData = Nothing\nSet rsDoctorContact = Nothing\nSet db = Nothing\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "vlookup"], "comments": [{"owner": {"reputation": 2832, "user_id": 1161309, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b27b718aa1e9d3835ef807359666eb34?s=128&d=identicon&r=PG", "display_name": "Raystafarian", "link": "https://stackoverflow.com/users/1161309/raystafarian"}, "edited": false, "score": 0, "creation_date": 1435139269, "post_id": 31022954, "comment_id": 50071189, "body": "Try <code>cells(i,2).value</code> perhaps."}, {"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 1, "creation_date": 1435141297, "post_id": 31022954, "comment_id": 50072548, "body": "At which line do you get the error message? Is the file name really &quot;Stock_Final&quot; or is it &quot;Stock_Final.xls&quot; or &quot;Stock_Final.xlsx&quot; or &quot;Stock_Final.xlsm&quot;...? Your entire code is implicit and not explicit. You might want to change that. As Raystafarian suggests you might want to append <code>.Value</code> or <code>.Value2</code>or <code>.Formula</code> as is appropriate. Also you might want to add to <code>Cells(i, 49)</code> which workbook and which worksheet you&#39;d like VBA to use."}, {"owner": {"reputation": 1, "user_id": 5043913, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a310a21f0c717cab366bcb1eafd27f63?s=128&d=identicon&r=PG&f=1", "display_name": "Vaibhav Doshi", "link": "https://stackoverflow.com/users/5043913/vaibhav-doshi"}, "edited": false, "score": 0, "creation_date": 1435142993, "post_id": 31022954, "comment_id": 50073698, "body": "Both the file name and sheet name within the file is Stock_Final."}, {"owner": {"reputation": 1, "user_id": 5043913, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a310a21f0c717cab366bcb1eafd27f63?s=128&d=identicon&r=PG&f=1", "display_name": "Vaibhav Doshi", "link": "https://stackoverflow.com/users/5043913/vaibhav-doshi"}, "edited": false, "score": 0, "creation_date": 1435143056, "post_id": 31022954, "comment_id": 50073735, "body": "for Cells(i.49), it is the active workbook.how do i reference it better?"}], "owner": {"reputation": 1, "user_id": 5043913, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a310a21f0c717cab366bcb1eafd27f63?s=128&d=identicon&r=PG&f=1", "display_name": "Vaibhav Doshi", "link": "https://stackoverflow.com/users/5043913/vaibhav-doshi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 86, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1435138642, "creation_date": 1435138527, "last_edit_date": 1435138642, "question_id": 31022954, "link": "https://stackoverflow.com/questions/31022954/vba-vlook-from-one-workbook-to-another", "title": "VBA Vlook from one workbook to another", "body": "<p>I am trying to use Vlook from one sheet to another. The macro would open the target file (Stock_Final) and then using for function put the corresponding values in the main sheet (DV2.5028)</p>\n\n<p>I have written the macro below but it gives me the following error <strong>'Unable to get the Vlookup property of the worksheet function class'</strong> </p>\n\n<pre><code>Sub LookupValues()\n    Dim colI_Cell As Long\n    Dim colI_Range As Range\n    Dim rngLookupRange As Range\n    Dim rngFound As Range\n    Dim wb As Workbook\n    Dim Val As Integer\n    Dim i As Integer\n    Dim Sht As Worksheet\n\n    ThisWorkbook.Worksheets(\"Sheet1\").Activate\n\n    colI_Cell = Range(\"A1\").CurrentRegion.Rows.Count\n\n    Set wb = Workbooks.Open(\"C:\\Users\\vpd702450\\Desktop\\New folder\\Stock_Final\", True, True)\n    Set rngLookupRange = wb.Worksheets(\"Stock_Final\").Range(\"B7:F20000\")\n\n    For i = 2 To colI_Cell\n        Cells(i, 49) = Application.WorksheetFunction.VLookup(Cells(i, 2), rngLookupRange, 5, False)\n    Next i\nEnd Sub\n</code></pre>\n\n<p>Thanks in advance.</p>\n"}, {"tags": ["excel", "vba", "variables"], "comments": [{"owner": {"reputation": 1949, "user_id": 1723119, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/8182f3271d9881acad7c1a4d8844ca15?s=128&d=identicon&r=PG", "display_name": "99moorem", "link": "https://stackoverflow.com/users/1723119/99moorem"}, "edited": false, "score": 1, "creation_date": 1435137564, "post_id": 31022402, "comment_id": 50069995, "body": "Can you post code you tried already?"}, {"owner": {"reputation": 11, "user_id": 2287712, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ec83d129f696e5cb9904bf1273c4ee7?s=128&d=identicon&r=PG", "display_name": "user2287712", "link": "https://stackoverflow.com/users/2287712/user2287712"}, "reply_to_user": {"reputation": 1949, "user_id": 1723119, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/8182f3271d9881acad7c1a4d8844ca15?s=128&d=identicon&r=PG", "display_name": "99moorem", "link": "https://stackoverflow.com/users/1723119/99moorem"}, "edited": false, "score": 0, "creation_date": 1435138579, "post_id": 31022402, "comment_id": 50070687, "body": "I am struggling to get the code into here... maybe advice alone could do? Effectively I  am declaring everything as variant, and then use the custom function to check if it needs to stay empty     &#39;Function checkIfEmpty(rowNo, colNo) As Variant If IsEmpty(Sheet2.Cells(rowNo, colNo)) = True Then      checkIfEmpty = Empty     &#39;If variableTypeIfEmpty = &quot;Nothing&quot; Then Set checkIfEmpty = Nothing Else checkIfEmpty = Sheet2.Cells(rowNo, colNo).Value End If   End Function &#39;"}, {"owner": {"reputation": 1321, "user_id": 3506217, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/B1laD.jpg?s=128&g=1", "display_name": "Miss Palmer", "link": "https://stackoverflow.com/users/3506217/miss-palmer"}, "edited": false, "score": 1, "creation_date": 1435138856, "post_id": 31022402, "comment_id": 50070884, "body": "can you not just use <code>IsEmpty()</code> to check between 0 and NULL?"}, {"owner": {"reputation": 11, "user_id": 2287712, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ec83d129f696e5cb9904bf1273c4ee7?s=128&d=identicon&r=PG", "display_name": "user2287712", "link": "https://stackoverflow.com/users/2287712/user2287712"}, "reply_to_user": {"reputation": 1321, "user_id": 3506217, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/B1laD.jpg?s=128&g=1", "display_name": "Miss Palmer", "link": "https://stackoverflow.com/users/3506217/miss-palmer"}, "edited": false, "score": 0, "creation_date": 1435138985, "post_id": 31022402, "comment_id": 50070975, "body": "@MissPalmer, I need to get variable value as empty, but if I declare this as numerical (single, double etc.) it will always be 0 or whatever is in the the corresponding cell"}, {"owner": {"reputation": 1949, "user_id": 1723119, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/8182f3271d9881acad7c1a4d8844ca15?s=128&d=identicon&r=PG", "display_name": "99moorem", "link": "https://stackoverflow.com/users/1723119/99moorem"}, "edited": false, "score": 0, "creation_date": 1435138995, "post_id": 31022402, "comment_id": 50070987, "body": "Post your code in your original question above and it can be formatted properly"}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 2287712, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ec83d129f696e5cb9904bf1273c4ee7?s=128&d=identicon&r=PG", "display_name": "user2287712", "link": "https://stackoverflow.com/users/2287712/user2287712"}, "edited": false, "score": 0, "creation_date": 1435148961, "post_id": 31024453, "comment_id": 50077733, "body": "I never thought of creating new classes... the idea of additional checks on empty is also something I missed. I will try this out. Thank you!"}], "tags": [], "owner": {"reputation": 12766, "user_id": 863240, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/a2221c5cbaa548f9022616b4f6d6a59a?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Du\u0161ek", "link": "https://stackoverflow.com/users/863240/daniel-du%c5%a1ek"}, "is_accepted": false, "score": 0, "last_activity_date": 1435145573, "last_edit_date": 1435145573, "creation_date": 1435142604, "answer_id": 31024453, "question_id": 31022402, "link": "https://stackoverflow.com/questions/31022402/resetting-variables-in-excel-vba/31024453#31024453", "title": "resetting variables in excel vba", "body": "<p>Maybe you could create your own classes? Example for <code>Single</code>.</p>\n\n<blockquote>\n  <p>Class Single2</p>\n</blockquote>\n\n<pre><code>Private m_value As Single\nPrivate m_hasValue As Boolean\n\nPublic Property Let Initialize(ByVal source As Range)\n    m_hasValue = False\n    m_value = 0\n\n    If source Is Nothing Then _\n        Exit Property\n\n    ' add any checks you need to recognize the source cell as non-empty\n    ' ... to distinguish between empty entry and 0\n    If Trim(source.Value) = \"\" Then _\n        Exit Property\n\n    If Not IsNumeric(source.Value) Then _\n        Exit Property\n\n    m_value = CSng(source.Value)\n    m_hasValue = True\n\nEnd Property\n\nPublic Property Get Value() As Single\n    Value = m_value\nEnd Property\n\nPublic Property Get HasValue() As Boolean\n    HasValue = m_hasValue\nEnd Property\n</code></pre>\n\n<p>And use the class like this:</p>\n\n<blockquote>\n  <p>Module:</p>\n</blockquote>\n\n<pre><code>Dim lease As Single2\nSet lease = New Single2\nlease.Initialize = Range(\"a1\")\n\nIf lease.HasValue Then\n    Debug.Print \"lease has value ... \" &amp; lease.Value\nElse\n    Debug.Print \"lease hasn't value ... \"\nEnd If\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 11, "user_id": 2287712, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ec83d129f696e5cb9904bf1273c4ee7?s=128&d=identicon&r=PG", "display_name": "user2287712", "link": "https://stackoverflow.com/users/2287712/user2287712"}, "edited": false, "score": 0, "creation_date": 1435148792, "post_id": 31024877, "comment_id": 50077604, "body": "so, if there is a numerical value, it changes to integer, if there is no value - it stays as variant and remains empty, is that correct? I agree that the efficiency gains are minimal.  Interestingly, if you increase the test size, efficiency difference narrows, which is rather strange."}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "reply_to_user": {"reputation": 11, "user_id": 2287712, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ec83d129f696e5cb9904bf1273c4ee7?s=128&d=identicon&r=PG", "display_name": "user2287712", "link": "https://stackoverflow.com/users/2287712/user2287712"}, "edited": false, "score": 0, "creation_date": 1435149446, "post_id": 31024877, "comment_id": 50078095, "body": "In my test() sub, v is <i>always</i> a variant. Variants are, implicitly, data structures which have a type tag. In VBA terminology, the value of the type tag determines the <i>subtype</i> of the variant. The typename function returns the subtype of the variant, not the type. In <i>this</i> case the numerical subtype was integer, but it could be e.g. long or double. As far as my informal test goes -- Windows is multi-threaded which means that, from the point of view of the timing code, there is some random fluctuation. Don&#39;t read too much into a single run."}], "tags": [], "owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "is_accepted": false, "score": 3, "last_activity_date": 1435145096, "last_edit_date": 1435145096, "creation_date": 1435143896, "answer_id": 31024877, "question_id": 31022402, "link": "https://stackoverflow.com/questions/31022402/resetting-variables-in-excel-vba/31024877#31024877", "title": "resetting variables in excel vba", "body": "<p>You can't empty a variable of type integer, since empty is not an integer. If you have a variant variable which is currently of subtype integer you can reset it to empty: </p>\n\n<pre><code>Sub test()\n    Dim v As Variant\n    Debug.Print TypeName(v)\n    v = 1\n    Debug.Print TypeName(v)\n    v = Empty\n    Debug.Print TypeName(v)\nEnd Sub\n</code></pre>\n\n<p>output:</p>\n\n<pre><code>Empty\nInteger\nEmpty\n</code></pre>\n\n<p>Also, the performance hit of using variants might not be as great as you fear. An informal test:</p>\n\n<pre><code>Sub InformalTest(n As Long)\n    Dim i As Long, sum1 As Double\n    Dim j As Variant, sum2 As Variant\n    Dim start As Double, elapsed1 As Double, elapsed2 As Double\n\n    start = Timer\n    For i = 1 To n\n        sum1 = sum1 + 1#\n    Next i\n    elapsed1 = Timer - start\n\n    start = Timer\n    For j = 1 To n\n        sum2 = sum2 + 1#\n    Next j\n    elapsed2 = Timer - start\n\n    Debug.Print \"Nonvariant time: \" &amp; elapsed1 &amp; \", Nonvariant sum: \" &amp; sum1\n    Debug.Print \"Variant time: \" &amp; elapsed2 &amp; \", Variant sum: \" &amp; sum2\nEnd Sub\n</code></pre>\n\n<p>Sample output:</p>\n\n<pre><code>InformalTest 1000000\nNonvariant time: 0.060546875, Nonvariant sum: 1000000\nVariant time: 0.099609375, Variant sum: 1000000\n\nInformalTest 10000000\nNonvariant time: 0.521484375, Nonvariant sum: 10000000\nVariant time: 0.599609375, Variant sum: 10000000\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 2287712, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ec83d129f696e5cb9904bf1273c4ee7?s=128&d=identicon&r=PG", "display_name": "user2287712", "link": "https://stackoverflow.com/users/2287712/user2287712"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 21642, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1435145573, "creation_date": 1435137047, "last_edit_date": 1435142135, "question_id": 31022402, "link": "https://stackoverflow.com/questions/31022402/resetting-variables-in-excel-vba", "title": "resetting variables in excel vba", "body": "<p>I am trying to build a model with VBA doing some work for me. Assume I have 4 variables - unit, lease start date, lease p.a, and alternative lease p.a. There are more, but that does not matter for my problem. VBA loops through each line and gets the value for unit i in respective column. </p>\n\n<p>So, logically, I could declare unit as string, lease start date as date, lease p.a as single, and alternative lease p.a. as single.  The problem I have is that I need to distinguish between empty entry and 0. The default numerical value is going to be 0. the distinction between 0 and empty is crucial. The only way I found to get around this is to declare everything as Variant and then check if the corresponding range is empty. If it is empty, then lease the Variant default value (Empty), otherwise assign the value. </p>\n\n<p>I have a feeling that this is going to seriously affect my code performance. Ultimately, there will be lots of variables and I want to refer to those variables in the code. Like, <code>if isempty(AltLease) = true then</code> do one thing, otherwise something else. </p>\n\n<p>I also find that I can not empty single or date variables(date is actually not a problem, since it drops to 1900). Can anyone suggest something?</p>\n\n<p>Here is the code:</p>\n\n<pre><code>Dim tUnitName As Variant\nDim tNumberOfUnits As Variant\nDim tLeaseCurLeaseLengthDef as Variant\nDim tLeaseCurLeaseLengthAlt as Variant\n\n\nSub tenancyScheduleNew()\nDim lRow As Long\nDim i As Long\nlRow = Sheet2.Cells(Rows.Count, 2).End(xlUp).Row\nFor i = 3 To lRow\n    reAssignVariables i\nNext i\nEnd Sub\n\nSub reAssignVariables(i As Long)\ntAssetName = checkIfEmpty(i, getColumn(\"Sheet4\", \"tAssetName\", 3))\ntNumberOfUnits = checkIfEmpty(i, getColumn(\"Sheet4\", \"tNumberOfUnits\", 3))\ntLeaseCurLeaseLengthDef = checkIfEmpty(i, getColumn(\"Sheet4\", \"tLeaseCurLeaseLengthDef\", 3))\ntLeaseCurLeaseLengthDef = checkIfEmpty(i, getColumn(\"Sheet4\", \"tLeaseCurLeaseLengthAlt\", 3))\n\nEnd Sub\n\nFunction getColumn(sh As String, wh As String, colNo As Long) As Long\nDim refSheet As Worksheet\nDim rFound As Range\nSet refSheet = Sheets(sh)\nWith refSheet\n    Set rFound = .Columns(1).Find(What:=wh, After:=.Cells(1, 1), LookIn:=xlValues, LookAt:=xlWhole)\n    On Error GoTo 0\n    If Not rFound Is Nothing Then\n        getColumn = rFound.Offset(0, colNo - 1).Value\n    Else\n    End If\nEnd With\n\nEnd Function\n</code></pre>\n\n<p>This is the way I am doing it now, which I think will slow the performance down. This is only small part of variables that I have made - there is going to be much more. I just need to understand how to construct it correctly in the first place. More specifically, if there is a value in <code>tLeaseCurLeaseLengthAlt</code>, then code should use that, alternatively, use default value. </p>\n"}, {"tags": ["excel", "vba", "sap-query"], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 4825722, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a718119b12fae5a171df03f7eed905de?s=128&d=identicon&r=PG&f=1", "display_name": "Sai", "link": "https://stackoverflow.com/users/4825722/sai"}, "edited": false, "score": 0, "creation_date": 1435221774, "post_id": 31022502, "comment_id": 50113092, "body": "Thanks @99moorem. it was perfect  !"}, {"owner": {"reputation": 1949, "user_id": 1723119, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/8182f3271d9881acad7c1a4d8844ca15?s=128&d=identicon&r=PG", "display_name": "99moorem", "link": "https://stackoverflow.com/users/1723119/99moorem"}, "reply_to_user": {"reputation": 33, "user_id": 4825722, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a718119b12fae5a171df03f7eed905de?s=128&d=identicon&r=PG&f=1", "display_name": "Sai", "link": "https://stackoverflow.com/users/4825722/sai"}, "edited": false, "score": 0, "creation_date": 1435221885, "post_id": 31022502, "comment_id": 50113173, "body": "Can you make it as the answer if it has worked for you. little tick to the left of the post"}], "tags": [], "owner": {"reputation": 1949, "user_id": 1723119, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/8182f3271d9881acad7c1a4d8844ca15?s=128&d=identicon&r=PG", "display_name": "99moorem", "link": "https://stackoverflow.com/users/1723119/99moorem"}, "is_accepted": true, "score": 3, "last_activity_date": 1435137325, "creation_date": 1435137325, "answer_id": 31022502, "question_id": 31022300, "link": "https://stackoverflow.com/questions/31022300/vba-code-for-making-entire-rows-bold-based-on-a-cell-value-in-the-query-table/31022502#31022502", "title": "VBA Code for Making Entire Rows Bold based on a Cell value in the Query table", "body": "<p>This will only work for active sheet, change activesheet to sheets(\"sheetabc\") to reference another sheet</p>\n\n<pre><code>Sub test()\nWith ActiveSheet\n    For Each cell In .Range(\"G15:\" &amp; .Range(\"G15\").End(xlDown).Address)\n        If .Cells(cell.Row, 12).Value = \"Main investigation\" Then\n            cell.EntireRow.Font.Bold = True\n        End If\n    Next\nEnd With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 4825722, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a718119b12fae5a171df03f7eed905de?s=128&d=identicon&r=PG&f=1", "display_name": "Sai", "link": "https://stackoverflow.com/users/4825722/sai"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 25088, "favorite_count": 0, "accepted_answer_id": 31022502, "answer_count": 1, "score": 3, "last_activity_date": 1604081499, "creation_date": 1435136784, "last_edit_date": 1604081499, "question_id": 31022300, "link": "https://stackoverflow.com/questions/31022300/vba-code-for-making-entire-rows-bold-based-on-a-cell-value-in-the-query-table", "title": "VBA Code for Making Entire Rows Bold based on a Cell value in the Query table", "body": "<p>I have a table in the range (G15:AL540) generated through SAP Query . I need to make all the rows Bold , if the Cells in Column L Contains the word \"Main Investigation\". I did it using Conditional Formatting ( =$L16=\"Main investigation\") and it worked. But I need to write it in VBA , so that this formatting is applied automatically when the Query is refreshed. </p>\n\n<p>Thanks!</p>\n"}, {"tags": ["vba", "excel", "variables", "filter"], "answers": [{"comments": [{"owner": {"reputation": 789, "user_id": 4596273, "user_type": "registered", "accept_rate": 59, "profile_image": "https://graph.facebook.com/816411745073346/picture?type=large", "display_name": "Ben Smith", "link": "https://stackoverflow.com/users/4596273/ben-smith"}, "edited": false, "score": 0, "creation_date": 1435138106, "post_id": 31022682, "comment_id": 50070385, "body": "Thank you! That works, I&#39;m getting it so that it then displays the value in a cell, so beneath your code I have added the following: <code>Range(&quot;E205&quot;).Select</code> <code>ActiveCell.Value = sCriterion</code> But this will only work when I run the macro, is there a way of getting the code to run automatically when the filter is applied?"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "reply_to_user": {"reputation": 789, "user_id": 4596273, "user_type": "registered", "accept_rate": 59, "profile_image": "https://graph.facebook.com/816411745073346/picture?type=large", "display_name": "Ben Smith", "link": "https://stackoverflow.com/users/4596273/ben-smith"}, "edited": false, "score": 0, "creation_date": 1435138942, "post_id": 31022682, "comment_id": 50070946, "body": "If you have any subtotal formulas in place, you can use the <code>Worksheet_Calculate</code> event to update the filter criteria."}, {"owner": {"reputation": 789, "user_id": 4596273, "user_type": "registered", "accept_rate": 59, "profile_image": "https://graph.facebook.com/816411745073346/picture?type=large", "display_name": "Ben Smith", "link": "https://stackoverflow.com/users/4596273/ben-smith"}, "edited": false, "score": 0, "creation_date": 1435140037, "post_id": 31022682, "comment_id": 50071738, "body": "I don&#39;t have any subtotal formulas, but can you show me how I would use <code>Wordsheet_Calculate</code> to automatically run the macro when a filter is applied?"}, {"owner": {"reputation": 789, "user_id": 4596273, "user_type": "registered", "accept_rate": 59, "profile_image": "https://graph.facebook.com/816411745073346/picture?type=large", "display_name": "Ben Smith", "link": "https://stackoverflow.com/users/4596273/ben-smith"}, "edited": false, "score": 0, "creation_date": 1435144285, "post_id": 31022682, "comment_id": 50074551, "body": "Ok, so just to make sure I&#39;ve got this correct, I make a new module and then insert the code: <code>Private Sub Worksheet_Calculate() Dim ftr                   As Filter  Set ftr = ActiveSheet.AutoFilter.Filters(2) If ftr.On Then Range(&quot;E205&quot;).value = Mid$(ftr.Criteria1, 2) End Sub</code> into the module, then when I apply a filter the value will be displayed in E205? is this correct?"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "reply_to_user": {"reputation": 789, "user_id": 4596273, "user_type": "registered", "accept_rate": 59, "profile_image": "https://graph.facebook.com/816411745073346/picture?type=large", "display_name": "Ben Smith", "link": "https://stackoverflow.com/users/4596273/ben-smith"}, "edited": false, "score": 0, "creation_date": 1435146387, "post_id": 31022682, "comment_id": 50075940, "body": "No - it goes in the worksheet code module - see the last line of the answer."}, {"owner": {"reputation": 789, "user_id": 4596273, "user_type": "registered", "accept_rate": 59, "profile_image": "https://graph.facebook.com/816411745073346/picture?type=large", "display_name": "Ben Smith", "link": "https://stackoverflow.com/users/4596273/ben-smith"}, "edited": false, "score": 0, "creation_date": 1435149033, "post_id": 31022682, "comment_id": 50077788, "body": "Ok, that works! But I get this error come up in a pop up: Method &#39;Value&#39; of object &#39;Range&#39; failed"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "reply_to_user": {"reputation": 789, "user_id": 4596273, "user_type": "registered", "accept_rate": 59, "profile_image": "https://graph.facebook.com/816411745073346/picture?type=large", "display_name": "Ben Smith", "link": "https://stackoverflow.com/users/4596273/ben-smith"}, "edited": false, "score": 0, "creation_date": 1435149512, "post_id": 31022682, "comment_id": 50078141, "body": "I&#39;ve amended the code. If you still get an error please tell me what is output to the immediate window in the VB Editor as the filter criterion."}, {"owner": {"reputation": 789, "user_id": 4596273, "user_type": "registered", "accept_rate": 59, "profile_image": "https://graph.facebook.com/816411745073346/picture?type=large", "display_name": "Ben Smith", "link": "https://stackoverflow.com/users/4596273/ben-smith"}, "edited": false, "score": 0, "creation_date": 1435149826, "post_id": 31022682, "comment_id": 50078341, "body": "Sorry for all the questions, but is it possible to do this for multiple filters? So as well as having this work for the area I also want it to work for the region?"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "reply_to_user": {"reputation": 789, "user_id": 4596273, "user_type": "registered", "accept_rate": 59, "profile_image": "https://graph.facebook.com/816411745073346/picture?type=large", "display_name": "Ben Smith", "link": "https://stackoverflow.com/users/4596273/ben-smith"}, "edited": false, "score": 0, "creation_date": 1435149912, "post_id": 31022682, "comment_id": 50078394, "body": "Yes - just repeat the code and change the filter number and target cell."}], "tags": [], "owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "is_accepted": true, "score": 1, "last_activity_date": 1435149473, "last_edit_date": 1435149473, "creation_date": 1435137789, "answer_id": 31022682, "question_id": 31022107, "link": "https://stackoverflow.com/questions/31022107/vba-retrieve-data-from-a-filter-and-store-it-in-a-variable/31022682#31022682", "title": "VBA: Retrieve data from a filter and store it in a variable", "body": "<p>Essentially you want something like this:</p>\n\n<pre><code>Dim ftr                   As Filter\nDim sCriterion            As String\nSet ftr = ActiveSheet.AutoFilter.Filters(2)\nIf ftr.On Then sCriterion = Mid$(ftr.Criteria1, 2)\n</code></pre>\n\n<p>as long as you <strong>know</strong> they will only have filtered on one value. Otherwise you need to check the <code>Operator</code> and then determine what sort of filter is in place.</p>\n\n<p>For an automatic event code, you could use:</p>\n\n<pre><code>Private Sub Worksheet_Calculate()\nDim ftr                   As Filter\nOn Error Goto hell\nSet ftr = ActiveSheet.AutoFilter.Filters(2)\nIf ftr.On Then\n   application.enableevents = False\n   debug.print ftr.criteria1\n   Range(\"E205\").value = Mid$(ftr.Criteria1, 2)\nEnd If\n\nhell:\n   application.enableevents = true\nEnd Sub\n</code></pre>\n\n<p>Right-click the worksheet tab, choose <em>View Code</em> and then paste that in.</p>\n"}], "owner": {"reputation": 789, "user_id": 4596273, "user_type": "registered", "accept_rate": 59, "profile_image": "https://graph.facebook.com/816411745073346/picture?type=large", "display_name": "Ben Smith", "link": "https://stackoverflow.com/users/4596273/ben-smith"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1725, "favorite_count": 0, "accepted_answer_id": 31022682, "answer_count": 1, "score": 0, "last_activity_date": 1435149473, "creation_date": 1435136277, "question_id": 31022107, "link": "https://stackoverflow.com/questions/31022107/vba-retrieve-data-from-a-filter-and-store-it-in-a-variable", "title": "VBA: Retrieve data from a filter and store it in a variable", "body": "<p>I have a filter on the column heading \"Area\" which when applied shows only the records where the area matches the filter applied, e.g. 5.</p>\n\n<p><strong>Is there a piece of code that stores the value from the filter in a variable?</strong></p>\n\n<p>The code the filter uses is:</p>\n\n<pre><code>ActiveSheet.Range(\"$A$3:$BN$197\").AutoFilter Field:=2, Criteria1:=\n</code></pre>\n\n<p>So what I want is something like:</p>\n\n<pre><code>dim Filter As String\nFilter = ActiveSheet.Range(\"$A$3:$BN$197\").AutoFilter Field:=2, Criteria1:=\n</code></pre>\n\n<p>But the problem is because it is a filter, the area filtering on can change, i.e. one user may filter on area 5 whilst another on area 4.</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 55, "user_id": 4809602, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/dfc90f61e2709299c772528dab587d8f?s=128&d=identicon&r=PG&f=1", "display_name": "Atheisthotdog", "link": "https://stackoverflow.com/users/4809602/atheisthotdog"}, "edited": false, "score": 0, "creation_date": 1435137279, "post_id": 31022141, "comment_id": 50069795, "body": "Thank you for that, I fixed it and I&#39;ll edit the code accordingly. The error remains though."}, {"owner": {"reputation": 55, "user_id": 4809602, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/dfc90f61e2709299c772528dab587d8f?s=128&d=identicon&r=PG&f=1", "display_name": "Atheisthotdog", "link": "https://stackoverflow.com/users/4809602/atheisthotdog"}, "edited": false, "score": 0, "creation_date": 1435138210, "post_id": 31022141, "comment_id": 50070445, "body": "The same I was before, the fact that I had the variable wrong didn&#39;t matter I guess. It starts in the For Each segment after I return the number 6"}], "tags": [], "owner": {"reputation": 1949, "user_id": 1723119, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/8182f3271d9881acad7c1a4d8844ca15?s=128&d=identicon&r=PG", "display_name": "99moorem", "link": "https://stackoverflow.com/users/1723119/99moorem"}, "is_accepted": false, "score": 2, "last_activity_date": 1435136377, "creation_date": 1435136377, "answer_id": 31022141, "question_id": 31022047, "link": "https://stackoverflow.com/questions/31022047/compare-two-workbooks-using-vba/31022141#31022141", "title": "Compare two workbooks using VBA", "body": "<p>Answer is set as boolean and the msgbox will return a integer. Declare an integer and then use an if statement to put true/false in your answer variable. Something similar to below</p>\n\n<pre><code>Dim temp as integer\n\ntemp = MsgBox(\"Uma vez aberto o relat\u00f3rio deseja comparar os dois?\", vbYesNo + vbQuestion, \"Comparar\")\n\nif temp = 6 then\n    Answer = true\nelse\n    Answer = false\nendif\n</code></pre>\n"}], "owner": {"reputation": 55, "user_id": 4809602, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/dfc90f61e2709299c772528dab587d8f?s=128&d=identicon&r=PG&f=1", "display_name": "Atheisthotdog", "link": "https://stackoverflow.com/users/4809602/atheisthotdog"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 77, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1435138285, "creation_date": 1435136136, "last_edit_date": 1435138285, "question_id": 31022047, "link": "https://stackoverflow.com/questions/31022047/compare-two-workbooks-using-vba", "title": "Compare two workbooks using VBA", "body": "<p>I was trying to compare two different Workbooks, one named \"after\" (which is up to date) and another called \"before\" and I wanted to highlight the differences so it would be easy to pin down what changed between the two.</p>\n\n<p>Okay so after I tested it a bit I got stuck in an error </p>\n\n<blockquote>\n  <p>\"Object doesn't support this property or method\".</p>\n</blockquote>\n\n<p>Here's the full code with added comments so you can follow my thought process:</p>\n\n<pre><code>Sub OpenCsv()\nDim zcf, FolderPath, after, before, shtAfter, shtBefore As String\nDim MotherWB As Workbook, MotherWS As Worksheet\nDim wb As Workbook, ws, worksheetz As Worksheet\nDim oneRange, aCell As Range\nDim rng As Range\nDim Answer As Integer\nDim mycell As Range\nDim mydiffs As Integer\n\n\n'Sorts Things for MotherWB\nSet oneRange = Range(\"A4:Z9000\")\nSet aCell = Range(\"F4\")\noneRange.Sort Key1:=aCell, Order1:=xlAscending, Header:=xlYes\n\n'Opens and sets both Workbooks with their respective sheets\nFolderPath = Application.ActiveWorkbook.Path\nafter = FolderPath + \"\\\" + \"after.csv\"\nbefore = FolderPath + \"\\\" + \"before.xlsm\"\nWorkbooks.Open (after)\nSet wb = Workbooks(\"after.csv\")\nSet ws = wb.Worksheets(\"after\")\nSet MotherWB = Workbooks(\"before.xlsm\")\nSet MotherWS = MotherWB.Worksheets(\"before\")\n\n'Makes ws looks like MotherWS so we compare them\n With ws\n    Columns(\"A:Z\").AutoFit\n    Selection.TextToColumns _\n    Destination:=Range(\"A1:A9000\"), _\n    DataType:=xlDelimited, _\n    TextQualifier:=xlDoubleQuote, _\n    ConsecutiveDelimiter:=False, _\n    Tab:=False, _\n    Semicolon:=False, _\n    Comma:=True, _\n    Space:=False, _\n    Other:=False\n    Set oneRange = Range(\"A4:Z9000\")\n    Set aCell = Range(\"F4\")\n    oneRange.Sort Key1:=aCell, Order1:=xlAscending, Header:=xlYes\n\n    End With\n\n\n'Questions if you want to compare both\nAnswer = MsgBox(\"Uma vez aberto o relat\u00f3rio deseja comparar os dois?\", vbYesNo + vbQuestion, \"Comparar\")\n\nIf Answer = 6 Then\n\n\n'For each cell in after that is not the same in before, color it yellow\n    For Each mycell In wb.ws(after).UsedRange\n        If Not mycell.Value = MotherWB.MotherWS(before).Cells(mycell.row, mycell.Column).Value Then\n            mycell.Interior.Color = vbYellow\n            mydiffs = mydiffs + 1\n\n        End If\n    Next\n\n  'Display a message box to demonstrate the differences\n    MsgBox mydiffs &amp; \" differences found\", vbInformation\n\n    ActiveWorkbook.Sheets(after).Select\n\nEnd If\n\nEnd Sub\n</code></pre>\n\n<p>It gets the error after I return 6 from the answer, saying what I stated above. What am I doing wrong?</p>\n"}, {"tags": ["excel", "vba", "powerpoint"], "comments": [{"owner": {"reputation": 6482, "user_id": 1056632, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7TOmD.jpg?s=128&g=1", "display_name": "Rachel Hettinger", "link": "https://stackoverflow.com/users/1056632/rachel-hettinger"}, "edited": false, "score": 0, "creation_date": 1435153604, "post_id": 31021996, "comment_id": 50081222, "body": "Which line is throwing the error?"}, {"owner": {"reputation": 307, "user_id": 4704290, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/l3RmA.jpg?s=128&g=1", "display_name": "svacx", "link": "https://stackoverflow.com/users/4704290/svacx"}, "reply_to_user": {"reputation": 6482, "user_id": 1056632, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7TOmD.jpg?s=128&g=1", "display_name": "Rachel Hettinger", "link": "https://stackoverflow.com/users/1056632/rachel-hettinger"}, "edited": false, "score": 0, "creation_date": 1435155332, "post_id": 31021996, "comment_id": 50082579, "body": "<code>For each sld in ActivePresentation.Slides</code>"}], "answers": [{"tags": [], "owner": {"reputation": 6482, "user_id": 1056632, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7TOmD.jpg?s=128&g=1", "display_name": "Rachel Hettinger", "link": "https://stackoverflow.com/users/1056632/rachel-hettinger"}, "is_accepted": true, "score": 0, "last_activity_date": 1435163501, "creation_date": 1435163501, "answer_id": 31032101, "question_id": 31021996, "link": "https://stackoverflow.com/questions/31021996/powerpoint-loop-through-line-charts-active-x-error/31032101#31032101", "title": "Powerpoint loop through line charts - Active X Error", "body": "<p>I explicitly declared a <code>Presentation</code> variable to use instead of <code>ActivePresentation</code> and that seemed to do the trick. FYI: I also changed the declarations for the <code>sld</code> and <code>shp</code> variables to explicitly reference the PowerPoint object library.</p>\n\n<pre><code>Sub pptDataChange()\n\n'Define variables of excel\nDim mySheet As Excel.Worksheet\n\n'Define variables to open on PPT\nDim PowerPointApp As PowerPoint.Application\nDim myPresentation As PowerPoint.Presentation\nDim sld As PowerPoint.Slide\nDim shp As PowerPoint.Shape\nDim chrt As Chart\n\n'Copy range from Excel\nSet mySheet = ThisWorkbook.Worksheets(\"Sheet1\")\n\n'Create instance of Powerpoint\nOn Error Resume Next\n\n    'Open Powerpoint with Powerpoint is already opened\n    Set PowerPointApp = GetObject(class:=\"PowerPoint.Application\")\n\n    'Clear errors\n    Err.Clear\n\n    'If Powerpoint is closed, open Powerpoint\n    If PowerPointApp Is Nothing Then\n        Set PowerPointApp = CreateObject(class:=\"PowerPoint.Application\")\n    End If\n\n    'Handle error if Powerpoint isn't installed or not found\n    If Err.Number = 429 Then\n        MsgBox (\"PowerPoint not found, aborting...\")\n        Exit Sub\n    End If\n\nOn Error GoTo 0\n\n'Make Powerpoint visible and active\nPowerPointApp.Visible = True\nPowerPointApp.Activate\n\n'Open Powerpoint Presentation from PATH and set it as the active\nDim pres As PowerPoint.Presentation\nSet pres = PowerPointApp.Presentations.Open(\"File.pptx\")\n\nFor Each sld In pres.Slides\n    For Each shp In sld.Shapes\n       'Iterate through charts and change data of chart using something like If sld Has.Chart Then ...\n    Next shp\nNext sld\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 307, "user_id": 4704290, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/l3RmA.jpg?s=128&g=1", "display_name": "svacx", "link": "https://stackoverflow.com/users/4704290/svacx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 140, "favorite_count": 0, "accepted_answer_id": 31032101, "answer_count": 1, "score": 0, "last_activity_date": 1435163501, "creation_date": 1435135972, "last_edit_date": 1435145432, "question_id": 31021996, "link": "https://stackoverflow.com/questions/31021996/powerpoint-loop-through-line-charts-active-x-error", "title": "Powerpoint loop through line charts - Active X Error", "body": "<p>I've made a code to open Powerpoint from excel, and loop through all the slides, find the graph and change some columns. I have the code for doing the replacement but cant' seem to loop through the slides because it throws an ActiveX error 429 that is basically saying that powerpoint is not found :O.</p>\n\n<pre><code>Sub pptDataChange()    \n\n'Define variables of excel\nDim mySheet As Excel.Worksheet\n\n'Define variables to open on PPT\nDim PowerPointApp As PowerPoint.Application\nDim myPresentation As PowerPoint.Presentation\nDim sld As Slide\nDim shp As Shape\nDim chrt As Chart\n\n'Copy range from Excel\nSet mySheet = ThisWorkbook.Worksheets(\"Sheet1\")\n\n'Create instance of Powerpoint\nOn Error Resume Next\n\n    'Open Powerpoint with Powerpoint is already opened\n    Set PowerPointApp = GetObject(class:=\"PowerPoint.Application\")\n\n    'Clear errors\n    Err.Clear\n\n    'If Powerpoint is closed, open Powerpoint\n    If PowerPointApp Is Nothing Then\n        Set PowerPointApp = CreateObject(class:=\"PowerPoint.Application\")\n    End If\n\n    'Handle error if Powerpoint isn't installed or not found\n    If Err.Number = 429 Then\n        MsgBox (\"PowerPoint not found, aborting...\")\n        Exit Sub\n    End If\n\nOn Error GoTo 0\n\n'Make Powerpoint visible and active\nPowerPointApp.Visible = True\nPowerPointApp.Activate\n\n'Open Powerpoint Presentation from PATH and set it as the active\nPowerPointApp.Presentations.Open (\"File.pptx\")\n\nFor Each sld In ActivePresentation.Slides\n    For Each shp in sld\n       'Iterate through charts and change data of chart using something like If sld Has.Chart Then ...\nNext sld\n\nExit Sub\n</code></pre>\n\n<p>What I'm thinking is that maybe it's because of the ActivePresentation, but I've tried referencing to <code>myPresentation</code> but It was the same.</p>\n\n<p>Can you please help?</p>\n"}, {"tags": ["sql", "ms-access", "vba", "ms-access-2010"], "comments": [{"owner": {"reputation": 2148, "user_id": 2836853, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/eGs6K.png?s=128&g=1", "display_name": "Newd", "link": "https://stackoverflow.com/users/2836853/newd"}, "edited": false, "score": 0, "creation_date": 1435149488, "post_id": 31021977, "comment_id": 50078127, "body": "What event are you setting the query with?"}, {"owner": {"reputation": 3003, "user_id": 1540019, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/8ca15171e2123d2218198e6a0a77e3d9?s=128&d=identicon&r=PG", "display_name": "rohrl77", "link": "https://stackoverflow.com/users/1540019/rohrl77"}, "reply_to_user": {"reputation": 2148, "user_id": 2836853, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/eGs6K.png?s=128&g=1", "display_name": "Newd", "link": "https://stackoverflow.com/users/2836853/newd"}, "edited": false, "score": 0, "creation_date": 1435149656, "post_id": 31021977, "comment_id": 50078227, "body": "I&#39;m using <code>AfterUpdate()</code> and the code is just one line: <code>libFilterSelection.Requery</code>"}, {"owner": {"reputation": 2148, "user_id": 2836853, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/eGs6K.png?s=128&g=1", "display_name": "Newd", "link": "https://stackoverflow.com/users/2836853/newd"}, "edited": false, "score": 1, "creation_date": 1435150135, "post_id": 31021977, "comment_id": 50078565, "body": "Regarding <code>query only filters based on the last dropdown that I have selected</code>.  Can you test that a few times and make 100% certain that this is the case by changing the order in which you select dropdown options?  That particular symptom seems very odd.  Also before <code>libFilterSelection.Requery</code>  please <code>Debug.Print Forms(&quot;frmMain&quot;).Controls(&quot;ddnRDR&quot;).Text</code> and each other control in the query as well so we can see what the values are showing as, which is what the query would be using as well."}, {"owner": {"reputation": 3003, "user_id": 1540019, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/8ca15171e2123d2218198e6a0a77e3d9?s=128&d=identicon&r=PG", "display_name": "rohrl77", "link": "https://stackoverflow.com/users/1540019/rohrl77"}, "reply_to_user": {"reputation": 2148, "user_id": 2836853, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/eGs6K.png?s=128&g=1", "display_name": "Newd", "link": "https://stackoverflow.com/users/2836853/newd"}, "edited": false, "score": 0, "creation_date": 1435152097, "post_id": 31021977, "comment_id": 50080048, "body": "Awesome suggestions! I hadn&#39;t thought about using debug print before running the query... when I inserted the code you suggested I got an error message. So I removed the <code>.Text</code> from the end and the code worked. I saw that the values being passed were the actual values in the dropdown fields, except for the country one. That was a value (probably Access&#39; internal reference as it is a join query). That got me thinking... I removed the <code>.Text</code> from all the query parameters except the Country one and now it works!"}, {"owner": {"reputation": 3003, "user_id": 1540019, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/8ca15171e2123d2218198e6a0a77e3d9?s=128&d=identicon&r=PG", "display_name": "rohrl77", "link": "https://stackoverflow.com/users/1540019/rohrl77"}, "reply_to_user": {"reputation": 2148, "user_id": 2836853, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/eGs6K.png?s=128&g=1", "display_name": "Newd", "link": "https://stackoverflow.com/users/2836853/newd"}, "edited": false, "score": 0, "creation_date": 1435152707, "post_id": 31021977, "comment_id": 50080489, "body": "@Newd Opps... I was a bit too fast. It seems to filter correctly in some instances. I does however, as you suggested, depend on the order in which I click the dropdowns!"}, {"owner": {"reputation": 3003, "user_id": 1540019, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/8ca15171e2123d2218198e6a0a77e3d9?s=128&d=identicon&r=PG", "display_name": "rohrl77", "link": "https://stackoverflow.com/users/1540019/rohrl77"}, "reply_to_user": {"reputation": 2148, "user_id": 2836853, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/eGs6K.png?s=128&g=1", "display_name": "Newd", "link": "https://stackoverflow.com/users/2836853/newd"}, "edited": false, "score": 0, "creation_date": 1435154487, "post_id": 31021977, "comment_id": 50081899, "body": "Is it possible that Access evaluates an SQL statement based on the order in which the parameters are given to it? When I set all the filters and sort &quot;country&quot; last, it works ok. But if I go back and then filter one of the prior criteria, I get results for many countries again."}, {"owner": {"reputation": 2148, "user_id": 2836853, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/eGs6K.png?s=128&g=1", "display_name": "Newd", "link": "https://stackoverflow.com/users/2836853/newd"}, "edited": false, "score": 1, "creation_date": 1435160274, "post_id": 31021977, "comment_id": 50086399, "body": "At the times that it doesn&#39;t filter correctly. What does the <code>Debug.Print</code>&#39;s say?"}, {"owner": {"reputation": 1926, "user_id": 992660, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/8c0282d3af4d0d388ba24e32e71ca66b?s=128&d=identicon&r=PG", "display_name": "John Bingham", "link": "https://stackoverflow.com/users/992660/john-bingham"}, "edited": false, "score": 0, "creation_date": 1435206909, "post_id": 31021977, "comment_id": 50105702, "body": "I don&#39;t know what the particular issue is, but it can be easily fixed by changing the AfterUpdate of the various comboboxes to call a new procedure &quot;SetListboxRowSource()&quot; which then builds the row source string explicitly with the available values already selected in the comboboxes, and sets the listbox&#39;s rowsource property to that string."}], "owner": {"reputation": 3003, "user_id": 1540019, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/8ca15171e2123d2218198e6a0a77e3d9?s=128&d=identicon&r=PG", "display_name": "rohrl77", "link": "https://stackoverflow.com/users/1540019/rohrl77"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 60, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1435152288, "creation_date": 1435135883, "last_edit_date": 1435152288, "question_id": 31021977, "link": "https://stackoverflow.com/questions/31021977/why-does-listbox-not-filter-based-on-mulitple-dropdown-fields", "title": "Why does Listbox not filter based on mulitple dropdown fields", "body": "<p><strong>The Case:</strong> \nI have a listbox that has a query as a datasource. The query contains parameters that are based on dropdown fields which are on the same userform as the listbox.</p>\n\n<p>If I use only a single dropdown field as a parameter in the query, the listbox updates and shows the filtered results.</p>\n\n<p><strong>The Issue:</strong>\nIf I reference multiple dropdown fields, the query only filters based on the last dropdown that I have selected. Why is that and how can I change it to filter based on the selected values in all four dropdowns?</p>\n\n<p><strong>The SQL:</strong></p>\n\n<pre><code>SELECT tblFUNDS.MorningsStar_Fund_Name, tblFUNDS.ISIN, tblFUNDS.RDR AS [Retro Frei], tblMorningstar_Data.[DEU Tax Transparence], tblMorningstar_Data.[Distribution Status], tblISIN_Country_Table.Country\nFROM (tblFUNDS INNER JOIN tblISIN_Country_Table ON tblFUNDS.ISIN = tblISIN_Country_Table.ISIN) INNER JOIN tblMorningstar_Data ON (tblFUNDS.Fund_Selection = tblMorningstar_Data.Fund_Selection) AND (tblFUNDS.ISIN = tblMorningstar_Data.ISIN)\nGROUP BY tblFUNDS.MorningsStar_Fund_Name, tblFUNDS.ISIN, tblFUNDS.RDR, tblMorningstar_Data.[DEU Tax Transparence], tblMorningstar_Data.[Distribution Status], tblISIN_Country_Table.Country, tblFUNDS.Fund_Selection\nHAVING (((tblFUNDS.RDR) Like Nz([Forms]![frmMain]![ddnRDR].[Text],'*')) AND ((tblMorningstar_Data.[DEU Tax Transparence]) Like Nz([Forms]![frmMain]![ddnTax].[Text],'*')) AND ((tblMorningstar_Data.[Distribution Status]) Like Nz([Forms]![frmMain]![ddnDistribution].[Text],'*')) AND ((tblISIN_Country_Table.Country) Like Nz([Forms]![frmMain]![ddnCountry].[Text],'*')) AND ((tblFUNDS.Fund_Selection)=0));\n</code></pre>\n\n<p>The relevant part of my query that does the filtering is this:</p>\n\n<pre><code>HAVING (((tblFUNDS.RDR) Like Nz([Forms]![frmMain]![ddnRDR].[Text],'*')) AND ((tblMorningstar_Data.[DEU Tax Transparence]) Like Nz([Forms]![frmMain]![ddnTax].[Text],'*')) AND ((tblMorningstar_Data.[Distribution Status]) Like Nz([Forms]![frmMain]![ddnDistribution].[Text],'*')) AND ((tblISIN_Country_Table.Country) Like Nz([Forms]![frmMain]![ddnCountry].[Text],'*')) AND ((tblFUNDS.Fund_Selection)=0));\n</code></pre>\n"}, {"tags": ["vba", "excel", "informatica"], "comments": [{"owner": {"reputation": 15969, "user_id": 95, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/99fc91f87b0148b12d5a6a68f4b9cb3d?s=128&d=identicon&r=PG", "display_name": "Marek Grzenkowicz", "link": "https://stackoverflow.com/users/95/marek-grzenkowicz"}, "edited": false, "score": 0, "creation_date": 1435143003, "post_id": 31021750, "comment_id": 50073701, "body": "You should investigate the topic of running Excel macros programmatically - <a href=\"http://stackoverflow.com/questions/11149357/programmatic-execution-excel-macro-on-remote-machine-from-a-website\" title=\"programmatic execution excel macro on remote machine from a website\">stackoverflow.com/questions/11149357/&hellip;</a> or <a href=\"http://stackoverflow.com/questions/10232150/run-excel-macro-from-outside-excel-using-vbscript-from-command-line\" title=\"run excel macro from outside excel using vbscript from command line\">stackoverflow.com/questions/10232150/&hellip;</a>."}], "answers": [{"tags": [], "owner": {"reputation": 3441, "user_id": 1747257, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/FZsXW.jpg?s=128&g=1", "display_name": "Barshan Das", "link": "https://stackoverflow.com/users/1747257/barshan-das"}, "is_accepted": false, "score": 0, "last_activity_date": 1436867243, "creation_date": 1436867243, "answer_id": 31403208, "question_id": 31021750, "link": "https://stackoverflow.com/questions/31021750/excel-macros-on-informatica/31403208#31403208", "title": "Excel Macros on Informatica", "body": "<p>I am little bit confused about your question ( not  clear about the scenario you are describing). What I can suggest is:</p>\n\n<p>Step 1: It will be great if you can convert the macro into a vbscript (.vbs file). Alternatively, if you find that tough, write a small vb script that will call the macro.  Follow the link Marek Grzenkowicz provided in comment.</p>\n\n<p>Step 2: Add one command task in your informatica mapping. Then add this vbscript file name with full path in \"commands\" field so that when the command task will run, it will call the vbscript file.</p>\n"}], "owner": {"reputation": 1, "user_id": 5023641, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00f571122e9e6da9a0fdfbcd853e1123?s=128&d=identicon&r=PG&f=1", "display_name": "Sudhir", "link": "https://stackoverflow.com/users/5023641/sudhir"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1004, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1436867243, "creation_date": 1435135253, "last_edit_date": 1435169214, "question_id": 31021750, "link": "https://stackoverflow.com/questions/31021750/excel-macros-on-informatica", "title": "Excel Macros on Informatica", "body": "<p>I am trying to load an Excel which has macros, now challenge is to run the macros before loading that data, and we are using Informatica for data loading.</p>\n\n<p>Do we have any way to run the Macros on Excel using informatica and then load the data?</p>\n"}, {"tags": ["javascript", "excel", "vba"], "comments": [{"owner": {"reputation": 4412, "user_id": 4872454, "user_type": "registered", "accept_rate": 70, "profile_image": "https://lh6.googleusercontent.com/-fPzmBm5i9b0/AAAAAAAAAAI/AAAAAAAAABs/ZEqW4BT6YNI/photo.jpg?sz=128", "display_name": "Vimalan Jaya Ganesh", "link": "https://stackoverflow.com/users/4872454/vimalan-jaya-ganesh"}, "edited": false, "score": 0, "creation_date": 1435132607, "post_id": 31020865, "comment_id": 50066986, "body": "Can you share the code you have tried so far?"}, {"owner": {"reputation": 3, "user_id": 5043505, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b003a5e36c1250be7f137b39ddb27d68?s=128&d=identicon&r=PG&f=1", "display_name": "REII", "link": "https://stackoverflow.com/users/5043505/reii"}, "reply_to_user": {"reputation": 4412, "user_id": 4872454, "user_type": "registered", "accept_rate": 70, "profile_image": "https://lh6.googleusercontent.com/-fPzmBm5i9b0/AAAAAAAAAAI/AAAAAAAAABs/ZEqW4BT6YNI/photo.jpg?sz=128", "display_name": "Vimalan Jaya Ganesh", "link": "https://stackoverflow.com/users/4872454/vimalan-jaya-ganesh"}, "edited": false, "score": 0, "creation_date": 1435568690, "post_id": 31020865, "comment_id": 50237139, "body": "@VimalanJayaGanesh because i&#39;m very new to coding, i tried with the solution given by SO and edit a bit"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 5043505, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b003a5e36c1250be7f137b39ddb27d68?s=128&d=identicon&r=PG&f=1", "display_name": "REII", "link": "https://stackoverflow.com/users/5043505/reii"}, "edited": false, "score": 0, "creation_date": 1435135133, "post_id": 31021230, "comment_id": 50068428, "body": "thank you very much! it works smoothly.  may i know if you can also extract the data for this site as well? <a href=\"http://shippingma.alibaba.com/solution/shipping_lcl_list.htm?dep=CNSHA&amp;des=DEHAM&amp;weight=1000&amp;volume=1\" rel=\"nofollow noreferrer\">shippingma.alibaba.com/solution/&hellip;</a>"}, {"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "reply_to_user": {"reputation": 3, "user_id": 5043505, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b003a5e36c1250be7f137b39ddb27d68?s=128&d=identicon&r=PG&f=1", "display_name": "REII", "link": "https://stackoverflow.com/users/5043505/reii"}, "edited": false, "score": 0, "creation_date": 1435135698, "post_id": 31021230, "comment_id": 50068776, "body": "At first glance, it looks like that data only comes in the format of a HTML table - so you would need to scrape that data, it won&#39;t parse to csv format."}, {"owner": {"reputation": 3, "user_id": 5043505, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b003a5e36c1250be7f137b39ddb27d68?s=128&d=identicon&r=PG&f=1", "display_name": "REII", "link": "https://stackoverflow.com/users/5043505/reii"}, "edited": false, "score": 0, "creation_date": 1435136786, "post_id": 31021230, "comment_id": 50069467, "body": "S O, i checked the sources code of the html structure.  it is using JSON.parse to load a file in their server i guess... scrape the data meaning?"}, {"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "reply_to_user": {"reputation": 3, "user_id": 5043505, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b003a5e36c1250be7f137b39ddb27d68?s=128&d=identicon&r=PG&f=1", "display_name": "REII", "link": "https://stackoverflow.com/users/5043505/reii"}, "edited": false, "score": 0, "creation_date": 1435136835, "post_id": 31021230, "comment_id": 50069500, "body": "It&#39;s off-topic to this question though - please post this as a separate question."}], "tags": [], "owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "is_accepted": true, "score": 0, "last_activity_date": 1435133704, "creation_date": 1435133704, "answer_id": 31021230, "question_id": 31020865, "link": "https://stackoverflow.com/questions/31020865/importing-data-from-a-webpage-written-in-script-seajs-to-excel/31021230#31021230", "title": "Importing data from a webpage written in script (seajs) to Excel", "body": "<p>This will get the last 60 days and output to a csv file on your desktop. You can change the \"USD\" part of the URL as required.</p>\n\n<pre><code>Sub GetRates()\n\n    Dim myURL As String, sFilename As String\n    Dim WinHttpReq As Object, oStream As Object\n\n    myURL = \"http://www.oanda.com/currency/historical-rates/download?quote_currency=USD&amp;end_date=\" &amp; Format(Now(), \"yyyy-m-d\") &amp; \"&amp;period=daily&amp;display=absolute&amp;rate=0&amp;data_range=d60&amp;price=bid&amp;view=graph&amp;base_currency_0=CAD&amp;download=csv\"\n    sFilename = Environ$(\"USERPROFILE\") &amp; \"\\Desktop\\rates.csv\"\n\n\n    Set WinHttpReq = CreateObject(\"Microsoft.XMLHTTP\")\n    WinHttpReq.Open \"GET\", myURL, False\n    WinHttpReq.Send\n\n    myURL = WinHttpReq.ResponseBody\n\n    If WinHttpReq.Status = 200 Then\n        Set oStream = CreateObject(\"ADODB.Stream\")\n        oStream.Open\n        oStream.Type = 1\n        oStream.Write WinHttpReq.ResponseBody\n        oStream.SaveToFile sFilename, 2\n       oStream.Close\n    End If\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3, "user_id": 5043505, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b003a5e36c1250be7f137b39ddb27d68?s=128&d=identicon&r=PG&f=1", "display_name": "REII", "link": "https://stackoverflow.com/users/5043505/reii"}, "is_accepted": false, "score": 0, "last_activity_date": 1435569658, "creation_date": 1435569658, "answer_id": 31112035, "question_id": 31020865, "link": "https://stackoverflow.com/questions/31020865/importing-data-from-a-webpage-written-in-script-seajs-to-excel/31112035#31112035", "title": "Importing data from a webpage written in script (seajs) to Excel", "body": "<p>thank you very much @S O!  because i'm new to code, i made some adjustment to your code to get various type of currency pair exchange rate.  </p>\n\n<p>i saved org currency list in col A and target currency list in col B.</p>\n\n<p>below is the code i use:</p>\n\n<pre><code>Sub GetRates()\n\nDim myURL As String, sFilename As String\nDim WinHttpReq As Object, oStream As Object\nDim i As Long, lastrow As Long\n\nWith ActiveSheet\nlastrow = Sheet1.Range(\"A\" &amp; .Rows.Count).End(xlUp).Row\nFor i = 2 To lastrow\n\nmyURL = \"http://www.oanda.com/currency/historical-rates/download?quote_currency=\" &amp; Sheet1.Range(\"A\" &amp; i).Value &amp; \"&amp;end_date=\" &amp; Format(Now(), \"yyyy-m-d\") &amp; \"&amp;period=daily&amp;display=absolute&amp;rate=0&amp;data_range=d60&amp;price=bid&amp;view=graph&amp;base_currency_0=\" &amp; Sheet1.Range(\"B\" &amp; i).Value &amp; \"&amp;download=csv\"\nsFilename = Environ$(\"USERPROFILE\") &amp; \"\\Desktop\\\" &amp; Sheet1.Range(\"A\" &amp; i).Value &amp; Sheet1.Range(\"B\" &amp; i).Value &amp; \".csv\"\n\nSet WinHttpReq = CreateObject(\"Microsoft.XMLHTTP\")\nWinHttpReq.Open \"GET\", myURL, False\nWinHttpReq.Send\n\nmyURL = WinHttpReq.ResponseBody\n\nIf WinHttpReq.Status = 200 Then\n    Set oStream = CreateObject(\"ADODB.Stream\")\n    oStream.Open\n    oStream.Type = 1\n    oStream.Write WinHttpReq.ResponseBody\n    oStream.SaveToFile sFilename, 2\n   oStream.Close\nEnd If\n\nNext i\nEnd With\n</code></pre>\n\n<p>End Sub</p>\n"}], "owner": {"reputation": 3, "user_id": 5043505, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b003a5e36c1250be7f137b39ddb27d68?s=128&d=identicon&r=PG&f=1", "display_name": "REII", "link": "https://stackoverflow.com/users/5043505/reii"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 221, "favorite_count": 0, "accepted_answer_id": 31021230, "answer_count": 2, "score": 0, "last_activity_date": 1435569658, "creation_date": 1435132523, "last_edit_date": 1435184075, "question_id": 31020865, "link": "https://stackoverflow.com/questions/31020865/importing-data-from-a-webpage-written-in-script-seajs-to-excel", "title": "Importing data from a webpage written in script (seajs) to Excel", "body": "<p>I would like to ask about how can we get the data from an HTML which is using JavaScript to show data in a table.</p>\n\n<p><a href=\"http://www.oanda.com/currency/historical-rates/\" rel=\"nofollow\">http://www.oanda.com/currency/historical-rates/</a> </p>\n\n<p>I need to extract various kinds of currency exchange rates from the site - from USD to other currency and vice versa. I tried to use the <kbd>Get External Data</kbd> > <kbd>From Web</kbd> function in Excel, but the website may protect these kind of queries, so I cannot get the table I want (error message saying the currency ex rate I'm looking for does not exist). Because I need to input the original currency and target currency in the website, I cannot get the table without inputting the org and target currency. This is the only recognize site the company uses, so I have to stick with this site.</p>\n\n<p>Everyday I need to convert up to 2k times, is there any VBA for me to use so that I could run the code to auto extracting the exchange rates?</p>\n"}, {"tags": ["excel", "vba", "function", "events", "mousedown"], "answers": [{"comments": [{"owner": {"reputation": 75, "user_id": 3019338, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/7a30c385af9c9f66f63ffdb53d9e8b0b?s=128&d=identicon&r=PG&f=1", "display_name": "user3019338", "link": "https://stackoverflow.com/users/3019338/user3019338"}, "edited": false, "score": 0, "creation_date": 1435143896, "post_id": 31020940, "comment_id": 50074288, "body": "Perfect! Thank you Fran&#231;ois"}], "tags": [], "owner": {"reputation": 91, "user_id": 5020580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94b2c6c202ab6050066bd65a45e7ec45?s=128&d=identicon&r=PG&f=1", "display_name": "Fran&#231;ois Bonnefoi", "link": "https://stackoverflow.com/users/5020580/fran%c3%a7ois-bonnefoi"}, "is_accepted": true, "score": 0, "last_activity_date": 1435132769, "creation_date": 1435132769, "answer_id": 31020940, "question_id": 31020772, "link": "https://stackoverflow.com/questions/31020772/vba-excel-2010-mousedown-event-on-active-x-controls-command-button/31020940#31020940", "title": "vba Excel 2010 - MouseDown event on Active X Controls Command Button", "body": "<pre><code>Private Sub CommandButton1_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)\n    test CommandButton1, Shift, X, Y\nEnd Sub\n\nPrivate Sub CommandButton2_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)\n    test CommandButton2, Shift, X, Y\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 75, "user_id": 3019338, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/7a30c385af9c9f66f63ffdb53d9e8b0b?s=128&d=identicon&r=PG&f=1", "display_name": "user3019338", "link": "https://stackoverflow.com/users/3019338/user3019338"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1890, "favorite_count": 0, "accepted_answer_id": 31020940, "answer_count": 1, "score": 0, "last_activity_date": 1435132769, "creation_date": 1435132221, "question_id": 31020772, "link": "https://stackoverflow.com/questions/31020772/vba-excel-2010-mousedown-event-on-active-x-controls-command-button", "title": "vba Excel 2010 - MouseDown event on Active X Controls Command Button", "body": "<p>On <a href=\"https://msdn.microsoft.com/en-us/library/aa716234(v=vs.60).aspx\" rel=\"nofollow\">this page</a> Microsoft explains how to know if a combinaison of Shift, Ctrl and Alt is pressed when MouseDown event occurs:</p>\n\n<p><code>Private Sub Form_MouseDown(Button As Integer, _\n      Shift As Integer, X As Single, Y As Single)\n   ShiftTest = Shift And 7\n   Select Case ShiftTest\n      Case 1 ' or vbShiftMask\n         Print \"You pressed the SHIFT key.\"\n      Case 2 ' or vbCtrlMask\n         Print \"You pressed the CTRL key.\"\n      Case 4 ' or vbAltMask\n         Print \"You pressed the ALT key.\"\n      Case 3\n         Print \"You pressed both SHIFT and CTRL.\"\n      Case 5\n         Print \"You pressed both SHIFT and ALT.\"\n      Case 6\n         Print \"You pressed both CTRL and ALT.\"\n      Case 7\n         Print \"You pressed SHIFT, CTRL, and ALT.\"\n      End Select\nEnd Sub</code></p>\n\n<p>It works just fine. I have many CommandButtons, would it be possible not to copy paste all these lines and replace them by a function called instead ?</p>\n\n<p>This is the idea but it is not working:</p>\n\n<p><code>\nPrivate Sub CommandButton1_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)\n    call test(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)\nEnd Sub</code></p>\n\n<p><code>Private Sub CommandButton2_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)\n    call test(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)\nEnd Sub</code></p>\n\n<p>Same for CommandButton3 and 4...</p>\n\n<p><code>Private Sub test(Button As Integer, _\n      Shift As Integer, X As Single, Y As Single)\n   ShiftTest = Shift And 7\n   Select Case ShiftTest\n      Case 1 ' or vbShiftMask\n         Print \"You pressed the SHIFT key.\"\n      Case 2 ' or vbCtrlMask\n         Print \"You pressed the CTRL key.\"\n      Case 4 ' or vbAltMask\n         Print \"You pressed the ALT key.\"\n      Case 3\n         Print \"You pressed both SHIFT and CTRL.\"\n      Case 5\n         Print \"You pressed both SHIFT and ALT.\"\n      Case 6\n         Print \"You pressed both CTRL and ALT.\"\n      Case 7\n         Print \"You pressed SHIFT, CTRL, and ALT.\"\n      End Select\nEnd Sub</code></p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 0, "creation_date": 1435131150, "post_id": 31020012, "comment_id": 50066087, "body": "It maybe morning here and maybe my mind isn&#39;t ready, but I almost didn&#39;t understand any part of what you are asking... You want to copy a range of data containing E2 and then rename the worksheet to E2 value?"}, {"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 2, "creation_date": 1435131632, "post_id": 31020012, "comment_id": 50066375, "body": "<code>sheetName = [E2]: Workbooks(&quot;otherWorkbook&quot;).Sheets(sheetName).Activate</code>"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 5043397, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07094c46c5490d04bab941b05a055caa?s=128&d=identicon&r=PG&f=1", "display_name": "jesslynn", "link": "https://stackoverflow.com/users/5043397/jesslynn"}, "edited": false, "score": 0, "creation_date": 1435139192, "post_id": 31022721, "comment_id": 50071118, "body": "nope. What i want is the value in Cell E2 would be the sheet name ."}, {"owner": {"reputation": 1, "user_id": 5043397, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07094c46c5490d04bab941b05a055caa?s=128&d=identicon&r=PG&f=1", "display_name": "jesslynn", "link": "https://stackoverflow.com/users/5043397/jesslynn"}, "edited": false, "score": 0, "creation_date": 1435139229, "post_id": 31022721, "comment_id": 50071152, "body": "x.Sheets(&quot;Sheet1&quot;).Rows(1).Columns(&quot;B&quot;).CopyDestination:=y.S&zwnj;&#8203;heets(&quot;The sheet name that is in Cell E2&quot;).Range(&quot;B&quot; &amp;Rows.Count).End(xlUp).Offset(1)"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "reply_to_user": {"reputation": 1, "user_id": 5043397, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07094c46c5490d04bab941b05a055caa?s=128&d=identicon&r=PG&f=1", "display_name": "jesslynn", "link": "https://stackoverflow.com/users/5043397/jesslynn"}, "edited": false, "score": 0, "creation_date": 1435139602, "post_id": 31022721, "comment_id": 50071441, "body": "E2 of which sheet? The code I posted uses E2 on Sheet1 of workbook x, which is what you asked for."}], "tags": [], "owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "is_accepted": false, "score": 0, "last_activity_date": 1435137931, "creation_date": 1435137931, "answer_id": 31022721, "question_id": 31020012, "link": "https://stackoverflow.com/questions/31020012/how-to-let-the-cell-e2-be-the-worksheet-name-in-the-macro-code/31022721#31022721", "title": "How to let the cell E2 be the worksheet name in the macro code?", "body": "<p>It <em>appears</em> to me that you want:</p>\n\n<pre><code>Dim x As Workbook\nDim y As Workbook\nSet x = Workbooks.Open(\"\")\nSet y = Workbooks.Open(\"\")\nx.Sheets(\"Sheet1\").Rows(1).Columns(\"B\").Copy Destination:=y.Sheets(x.Sheets(\"Sheet1\").Range(\"E2\").Value).Range(\"B\" &amp;Rows.Count).End(xlUp).Offset(1)\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 5043397, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07094c46c5490d04bab941b05a055caa?s=128&d=identicon&r=PG&f=1", "display_name": "jesslynn", "link": "https://stackoverflow.com/users/5043397/jesslynn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 86, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1435140779, "creation_date": 1435129866, "last_edit_date": 1435135100, "question_id": 31020012, "link": "https://stackoverflow.com/questions/31020012/how-to-let-the-cell-e2-be-the-worksheet-name-in-the-macro-code", "title": "How to let the cell E2 be the worksheet name in the macro code?", "body": "<p>This is a brief description..\n1) The sheet name of workbook 2 is not known yet\n2) The user would then write the sheet name in workbook1 sheet1 Cell E2</p>\n\n<pre><code>Dim x As Workbook\nDim y As Workbook\nSet x = Workbooks.Open(\"\")\nSet y = Workbooks.Open(\"\")\n</code></pre>\n\n<p>From here, the macro must be able to detect the worksheet name in  Cell E2 in workbook1 and paste it in the workbook1 (sheet:???) below without manually keying in.</p>\n\n<pre><code>    x.Sheets(\"Sheet1\").Rows(1).Columns(\"B\").CopyDestination:=y.Sheets(\"???\").Range(\"B\" &amp;Rows.Count).End(xlUp).Offset(1)\n</code></pre>\n"}, {"tags": ["excel", "import", "format", "cell", "vba"], "answers": [{"comments": [{"owner": {"reputation": 71, "user_id": 4967029, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/f47b4666e7516b8b4342aaf02da5a64a?s=128&d=identicon&r=PG", "display_name": "Luis", "link": "https://stackoverflow.com/users/4967029/luis"}, "edited": false, "score": 0, "creation_date": 1435131652, "post_id": 31020452, "comment_id": 50066385, "body": "I think the better is the first one. Thank you for the quick reply :D"}], "tags": [], "owner": {"reputation": 1901, "user_id": 3590073, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddae1c2a3e6170997e7eaa0e9854a903?s=128&d=identicon&r=PG&f=1", "display_name": "aucuparia", "link": "https://stackoverflow.com/users/3590073/aucuparia"}, "is_accepted": true, "score": 2, "last_activity_date": 1435131251, "creation_date": 1435131251, "answer_id": 31020452, "question_id": 31019665, "link": "https://stackoverflow.com/questions/31019665/importing-disrupts-format-of-cell/31020452#31020452", "title": "Importing Disrupts Format Of Cell", "body": "<p>You are just doing a straight copy/paste, which will copy formats and values.  There are two options for just bringing through values (which I assume is what you want).</p>\n\n<p>The first is to use <code>Range.Copy</code> to copy cells to the clipboard and then <code>Range.PasteSpecial(xlPasteValues)</code> to just paste the values:</p>\n\n<pre><code>.Application.Union(.Range(\"D2:D\" &amp; Lstrw), .Range(\"F2:F\" &amp; Lstrw), .Range(\"I2:I\" &amp; Lstrw), .Range(\"M2:M\" &amp; Lstrw)).Copy\nTargetWb.Sheets(7).Range(\"A\" &amp; targetRow).PasteSpecial(xlPasteValues)\n</code></pre>\n\n<p>The second option is to use the <code>Value</code> property to get and set cell values without affecting formats.  In this case you would have to modify your loop as you can't get all the values from a non-contiguous range in one statement (the <code>Value</code> property just returns the values from the first area in an array).  You would do something like:</p>\n\n<pre><code>targetColumn = 1\nFor Each sourceArea In .Application.Union(.Range(\"D2:D\" &amp; Lstrw), .Range(\"F2:F\" &amp; Lstrw), .Range(\"I2:I\" &amp; Lstrw), .Range(\"M2:M\" &amp; Lstrw)).Areas\n    TargetWb.Sheets(7).Range(TargetWb.Sheets(7).Range.Cells(targetRow, targetColumn), TargetWb.Sheets(7).Range.Cells(targetRow, targetColumn + Lstrw - 1)).Value = sourceArea.Value\n    targetColumn = targetColumn + 1\nNext sourceArea\n</code></pre>\n\n<p>This is conceptually simple (<code>targetRange.Value = sourceRange.Value</code>) but looks ugly because of having to loop through areas, and construct the equivalent target range with the right number of cells.  But it is more flexible than the first option, and there probably are neater ways of getting the right target ranges.</p>\n"}], "owner": {"reputation": 71, "user_id": 4967029, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/f47b4666e7516b8b4342aaf02da5a64a?s=128&d=identicon&r=PG", "display_name": "Luis", "link": "https://stackoverflow.com/users/4967029/luis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 22, "favorite_count": 0, "accepted_answer_id": 31020452, "answer_count": 1, "score": 0, "last_activity_date": 1435131251, "creation_date": 1435128869, "last_edit_date": 1531161705, "question_id": 31019665, "link": "https://stackoverflow.com/questions/31019665/importing-disrupts-format-of-cell", "title": "Importing Disrupts Format Of Cell", "body": "<p>my problem is related to the importation of data, when I do this action trough a macro linked to a button, the data from the other file comes into the target workbook and disrupts all the previous cell format there. It is like it transfers the same format from the source sheet that the data comes from. </p>\n\n<p>I will post my code and if it isn't enough I will post the workbooks.</p>\n\n<pre><code>Sub ImportData()\nApplication.ScreenUpdating = False\nDim Path As String, Lstrw As Long\nDim SourceWb As Workbook\nDim TargetWb As Workbook\n\nPath = \"C:\\Users\\DZPH8SH\\Desktop\\Status 496 800 semana 12 2015.xls\" 'Para modificar ter acesso a pasta onde ir\u00e1 ficar o ficheiro\n\nSet SourceWb = Workbooks.Open(Path)\nSet TargetWb = ThisWorkbook\n\nDim n As Integer, targetRow As Long\ntargetRow = 3\n\n'Para importar os sheets que o utilizador quiser, modifique o n \"=\"\n\nFor n = 1 To 2\n\n   With SourceWb.Sheets(n)\n        Lstrw = .Cells.Find(What:=\"*\", SearchOrder:=xlRows, SearchDirection:=xlPrevious, LookIn:=xlValues).Row\n        .Application.Union(.Range(\"D2:D\" &amp; Lstrw), .Range(\"F2:F\" &amp; Lstrw), .Range(\"I2:I\" &amp; Lstrw), .Range(\"M2:M\" &amp; Lstrw)).Copy Destination:=TargetWb.Sheets(7).Range(\"A\" &amp; targetRow)\n        'move the targetRow to the first empty row after pasting the source data\n        targetRow = targetRow + Lstrw\n   End With\n\nNext\nSourceWb.Close savechanges:=False\nApplication.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n\n<p>Thanks for any reply in advance.</p>\n"}]