[{"tags": ["vba"], "comments": [{"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1538005079, "post_id": 52527304, "comment_id": 91994396, "body": "Do you want formulas or values placed in your cells"}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 6512023, "user_type": "registered", "profile_image": "https://graph.facebook.com/1059812500778395/picture?type=large", "display_name": "Rakesh Gupta", "link": "https://stackoverflow.com/users/6512023/rakesh-gupta"}, "edited": false, "score": 0, "creation_date": 1538024382, "post_id": 52527427, "comment_id": 91998606, "body": "Thanks very much for this, forgot to mention that instead to R2, I would like to check data for each row means r2, r3, r4 etc.. Is it possible."}, {"owner": {"reputation": 11, "user_id": 6512023, "user_type": "registered", "profile_image": "https://graph.facebook.com/1059812500778395/picture?type=large", "display_name": "Rakesh Gupta", "link": "https://stackoverflow.com/users/6512023/rakesh-gupta"}, "edited": false, "score": 0, "creation_date": 1538117669, "post_id": 52527427, "comment_id": 92038644, "body": "I tested it, it was doing only for R2."}, {"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "reply_to_user": {"reputation": 11, "user_id": 6512023, "user_type": "registered", "profile_image": "https://graph.facebook.com/1059812500778395/picture?type=large", "display_name": "Rakesh Gupta", "link": "https://stackoverflow.com/users/6512023/rakesh-gupta"}, "edited": false, "score": 0, "creation_date": 1538117724, "post_id": 52527427, "comment_id": 92038674, "body": "How many rows do you have? So on the 3rd row, it is still looking at <code>R2</code>?"}, {"owner": {"reputation": 11, "user_id": 6512023, "user_type": "registered", "profile_image": "https://graph.facebook.com/1059812500778395/picture?type=large", "display_name": "Rakesh Gupta", "link": "https://stackoverflow.com/users/6512023/rakesh-gupta"}, "edited": false, "score": 0, "creation_date": 1538198978, "post_id": 52527427, "comment_id": 92068552, "body": "For X = 2 To 100  Cells(X, 5).Formula = &quot;=VLOOKUP(D&quot; &amp; X &amp; &quot;,A:B,2,FALSE)&quot;  Next X  With Range(&quot;E2:E100&quot;)     .Value = .Value  End With"}], "tags": [], "owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "is_accepted": false, "score": 0, "last_activity_date": 1538005776, "last_edit_date": 1538005776, "creation_date": 1538005219, "answer_id": 52527427, "question_id": 52527304, "link": "https://stackoverflow.com/questions/52527304/vba-vookup-copy-paste-based-on-column/52527427#52527427", "title": "VBA VookUP Copy Paste Based on Column", "body": "<p>The <code>With</code> block is a lot and can be broken out into individual variables for better readability if you wanted. </p>\n\n<p>Breaking it apart</p>\n\n<ol>\n<li><code>ThisWorkbook</code></li>\n<li><code>Sheets(\"Sheet1\")</code></li>\n<li><code>Range(\"T2:T\" &amp; LROw)</code></li>\n<li>Where <code>LRow</code> = <code>Range(\"T\" &amp; Rows.Count).End(xlUp).Row)</code></li>\n</ol>\n\n<hr>\n\n<pre><code>Sub MyVlookup()\n\nWith ThisWorkbook.Sheets(\"Sheet1\").Range(\"T2:T\" &amp; Range(\"T\"  &amp; Rows.Count).End(xlUp).Row)\n    .Formula = \"=VLOOKUP(R2, P:Q, 2, 0)\"\n    .Value = .Value 'Remove this if you want the formula to show in the sheet\nEnd With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 6512023, "user_type": "registered", "profile_image": "https://graph.facebook.com/1059812500778395/picture?type=large", "display_name": "Rakesh Gupta", "link": "https://stackoverflow.com/users/6512023/rakesh-gupta"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 18, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1538005776, "creation_date": 1538004211, "question_id": 52527304, "link": "https://stackoverflow.com/questions/52527304/vba-vookup-copy-paste-based-on-column", "title": "VBA VookUP Copy Paste Based on Column", "body": "<p>I have a name of companies and tickers in Column P and Q and What I am trying to get is voookup of Column R to Column P and if Value Matches then paste it to Column T. I have this voolup code = \"=VLOOKUP(R2,P:Q,2,FALSE)\" and trying to covert it to VBA.</p>\n\n<pre><code>Dim i As Integer\nDim p, q, r, t As String\n\nSub esindia()\n\nFor i = 2 To 20000 Step 1\n\np = Sheet1.Range(\"p2\" &amp; i)\nq = Sheet1.Range(\"q2\" &amp; i)\nr = Sheet1.Range(\"r2\" &amp; i)\nt = Sheet1.Range(\"t2\" &amp; i)\n\n    If r = p Then\n     t = r\n     Sheet1.Range(\"t\" &amp; i) = r\n   Else\n     p = r\n     Sheet1.Range(\"t\" &amp; i) = r\n End If\nNext\n\nEnd Sub\n</code></pre>\n\n<p>Am I Missing anything here, help is much appreciated.</p>\n"}, {"tags": ["excel", "vba", "for-loop", "triggers"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1538003613, "post_id": 52527190, "comment_id": 91994082, "body": "Application.enableevents = false. Make sure to set to true before exiting."}, {"owner": {"reputation": 103, "user_id": 8441019, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/231adba7c07746c0499a2ed30bd5ee93?s=128&d=identicon&r=PG&f=1", "display_name": "UserX", "link": "https://stackoverflow.com/users/8441019/userx"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1538003691, "post_id": 52527190, "comment_id": 91994108, "body": "@ScottCraner Does the rest of the code, look accurte for the expected result?"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1538004451, "post_id": 52527190, "comment_id": 91994285, "body": "I would also add a test to ensure that it only fires when column b changes. But otherwise just looking at it it should do what you want."}], "answers": [{"tags": [], "owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "is_accepted": false, "score": 0, "last_activity_date": 1538005435, "creation_date": 1538005435, "answer_id": 52527447, "question_id": 52527190, "link": "https://stackoverflow.com/questions/52527190/trigger-that-will-update-cells-in-column-of-the-same-value/52527447#52527447", "title": "Trigger that will update cells in column of the same value", "body": "<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\nIf Target.Column &lt;&gt; 2 Then Exit Sub\n\nApplication.ScreenUpdating = False\n    For Each cel In Range(\"A1:A\" &amp; Range(\"A\" &amp; Rows.Count).End(xlUp).Row)\n        If cel = Target.Offset(, -1) Then\n            cel.Offset(, 1) = Target\n        End If\n    Next cel\nApplication.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "is_accepted": false, "score": 0, "last_activity_date": 1538005774, "last_edit_date": 1538005774, "creation_date": 1538005456, "answer_id": 52527451, "question_id": 52527190, "link": "https://stackoverflow.com/questions/52527190/trigger-that-will-update-cells-in-column-of-the-same-value/52527451#52527451", "title": "Trigger that will update cells in column of the same value", "body": "<p>I would try to avoid looping if possible. Perhaps use a UDF instead, using the <code>.Find()</code> method?</p>\n\n<pre><code>Option Explicit\n\nFunction myLookup(ByVal rng As Range) As String\n\n    Application.Volatile\n\n    Dim ws As Worksheet, lookupRng As Range, retRng As Range\n    Set ws = rng.Parent\n    With ws\n        Set lookupRng = .Range(.Cells(1, rng.Column), .Cells(rng.Row - 1, rng.Column))\n    End With\n\n    Set retRng = lookupRng.Find(rng.Value, ws.Cells(1, rng.Column))\n    If retRng Is Nothing Then\n        myLookup = vbNullString\n    Else\n        With retRng\n            myLookup = ws.Cells(.Row, .Column + 1)\n        End With\n    End If\n\nEnd Function\n</code></pre>\n\n<p>You would place this UDF in the worksheet as follows:</p>\n\n<p><a href=\"https://i.stack.imgur.com/XOtDC.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/XOtDC.png\" alt=\"enter image description here\"></a></p>\n\n<p>and fill down. This will prevent circular references because it will search for the cells <em>above it</em> only within the <code>lookupRng</code>.</p>\n\n<p>And, the final result:</p>\n\n<p><a href=\"https://i.stack.imgur.com/tBupB.gif\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/tBupB.gif\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 103, "user_id": 8441019, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/231adba7c07746c0499a2ed30bd5ee93?s=128&d=identicon&r=PG&f=1", "display_name": "UserX", "link": "https://stackoverflow.com/users/8441019/userx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 33, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1593644831, "creation_date": 1538003308, "last_edit_date": 1593644831, "question_id": 52527190, "link": "https://stackoverflow.com/questions/52527190/trigger-that-will-update-cells-in-column-of-the-same-value", "title": "Trigger that will update cells in column of the same value", "body": "<p>I am trying to write a macro that will update all cells in a column that have the same value as the adjacent column below are before and after of what I am trying to accomplish. In this example you would update B1 and then any cells in A1 with the same value would update to the B1 value</p>\n\n<p><a href=\"https://i.stack.imgur.com/OtIPx.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/OtIPx.jpg\" alt=\"Before\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/SD6Lg.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/SD6Lg.jpg\" alt=\"After\"></a></p>\n\n<p>Here is the code I am using</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\nDim rng1 As Range\nDim cel As Range\n\nSet rng1 = Range(\"A1\", Range(\"A2\").End(xlDown))\n\nFor Each cel In rng1\n    If cel = Target.Offset(0, -1).Value Then\n    cel.Offset(0, 1).Value = Target.Value\n    End If\nNext cel\n\nEnd Sub\n</code></pre>\n\n<p>I am not sure if what I wrote is correct, but I keep getting out of stack space error, which I think is from the macro continuously looping every time through changing the same cells. I believe this should be possible but I am a little lost.</p>\n"}, {"tags": ["excel", "ms-access", "exception", "vba"], "comments": [{"owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "edited": false, "score": 1, "creation_date": 1538002954, "post_id": 52526981, "comment_id": 91993917, "body": "What is your goal when you <b>Open</b> the workbook? What do you expect to happen other than it activating <code>Sheet1</code>?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user9187178"}, "reply_to_user": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "edited": false, "score": 0, "creation_date": 1538004352, "post_id": 52526981, "comment_id": 91994262, "body": "@K.D\u1d00\u1d20\u026as : Initially I made the sheet considering that we will manually enter the details in the sheet, but now we do not have to manually enter the details. It is taking reference from other sheet and posting those values here. Meaning that there is no change of values in this sheet. Since there is no change of values, the Worksheet_Change command is not being called."}, {"owner": {"user_type": "does_not_exist", "display_name": "user9187178"}, "reply_to_user": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "edited": false, "score": 0, "creation_date": 1538004775, "post_id": 52526981, "comment_id": 91994351, "body": "@K.D\u1d00\u1d20\u026as: When we will open the workbook, the color coding will automatically happen. Just like shown in the image. All the color codes will be adjusted based on the count."}, {"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1538004864, "post_id": 52526981, "comment_id": 91994365, "body": "You need to declare the new range. Is the range always <code>(&quot;B2:V11&quot;)</code>?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user9187178"}, "reply_to_user": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1538005022, "post_id": 52526981, "comment_id": 91994384, "body": "@urdearboy: The range will always be constant"}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user9187178"}, "edited": false, "score": 0, "creation_date": 1538007765, "post_id": 52527496, "comment_id": 91994993, "body": "Thank you So much for your efforts. The code does work!!  But it is making the excel loading process very slow.  Can there be better solution ? Sorry, the question might be stupid as i am not from a technical background. Appreciate your efforts."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 1, "creation_date": 1538008639, "post_id": 52527496, "comment_id": 91995197, "body": "@AnkitDalal I&#39;m not surprised that it slows it down a bit on open - you&#39;re running your change code on 210 individual cells. I&#39;m guessing that the redraws are a pretty big performance hit - you could try turning off screen updating before you hit the loop."}, {"owner": {"user_type": "does_not_exist", "display_name": "user9187178"}, "edited": false, "score": 0, "creation_date": 1538009026, "post_id": 52527496, "comment_id": 91995291, "body": "That should be fine. I am happy that it worked without much alterations on the existing code. Again thanks for the instant and correct response.."}], "tags": [], "owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "is_accepted": true, "score": 0, "last_activity_date": 1538006301, "last_edit_date": 1538006301, "creation_date": 1538005786, "answer_id": 52527496, "question_id": 52526981, "link": "https://stackoverflow.com/questions/52526981/executing-the-vba-code-on-opening-the-excel-instead-of-changing-value/52527496#52527496", "title": "Executing the VBA code on opening the excel instead of Changing value", "body": "<p>The problem is that Target is an undeclared <code>Variant</code> in your <code>Workbook_Open</code> implementation. That means when it gets passed as a parameter that needs to be a <code>Range</code>, the implicit cast fails and results in an error 424 (Object required). </p>\n\n<p>If you want to \"simulate\" every cell in your target range changing, you can simply loop over <code>B2:V11</code> and pass it each individual cell (untested with your data, but should give the gist): </p>\n\n<pre><code>Private Sub Workbook_Open()\n    Sheet1.Activate\n    Dim cell As Range\n    For Each cell In Sheet1.Range(\"B2:V11\")\n        'Worksheet_Change needs to be Public\n        Sheet1.Worksheet_Change cell\n    Next\nEnd Sub\n</code></pre>\n\n<p>Note that this is by no means the ideal solution to what you are trying to do and is a sign that you need to refactor your code a little bit to extract the functionality that you currently have in <code>Worksheet_Change</code> into a free-standing procedure.  If you need to run the same code from the <code>Worksheet_Change</code> handler, you can call that procedure.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user9187178"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 52, "favorite_count": 0, "accepted_answer_id": 52527496, "answer_count": 1, "score": 1, "last_activity_date": 1594628378, "creation_date": 1538001851, "last_edit_date": 1594628378, "question_id": 52526981, "link": "https://stackoverflow.com/questions/52526981/executing-the-vba-code-on-opening-the-excel-instead-of-changing-value", "title": "Executing the VBA code on opening the excel instead of Changing value", "body": "<p>I have a VBA code for a Rota Sheet that is activated on change of any value in the row.</p>\n\n<p>I want the code to be activated upon opening the excel.</p>\n\n<p>Code:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\nDim rng As Range\nSet rng = Range(\"B2:V11\")\n\nIf Not Intersect(Target, rng) Is Nothing Then\n\n    'scan each row (month)\n    Dim countRow As Long\n\n    Dim i As Long\n    For i = 1 To rng.Rows.count\n        If Not Intersect(Target, rng.Rows(i)) Is Nothing Then\n            If WorksheetFunction.CountIf(rng.Rows(i), \"V\") &gt; 0 Then\n                countRow = 0\n\n                Dim cel As Range\n                For Each cel In rng.Rows(i).Cells\n                    If cel.Value2 = \"V\" Then\n                        countRow = countRow + 1\n                        VacationChange cel, countRow\n                    Else\n                        VacationChange cel, 0\n                    End If\n                Next cel\n            End If\n        End If\n    Next i\n\n    'scan each column (day)\n    Dim j As Long\n    For j = 1 To rng.Columns.count\n        If Not Intersect(Target, rng.Columns(j)) Is Nothing Then\n            If WorksheetFunction.CountIf(rng.Columns(j), \"V\") &gt; 5 Then\n                VacationChange rng.Columns(j).Cells(0, 1), 6\n            Else\n                VacationChange rng.Columns(j).Cells(0, 1), 0\n            End If\n        End If\n    Next j\n\nEnd If\nEnd Sub\n\nPrivate Function VacationChange(ByVal rng As Range, ByVal count As Long)\n\nWith rng.Interior\n    Select Case count\n        Case 0\n            'clear cell colors\n            .Pattern = xlNone\n            .Color = xlNone\n            .TintAndShade = 0\n            .PatternTintAndShade = 0\n        Case 1 To 3\n            'blue\n            .Pattern = xlSolid\n            .Color = 15773696\n            .TintAndShade = 0\n            .PatternTintAndShade = 0\n        Case 4 To 5\n            'yellow\n            .Pattern = xlSolid\n            .ThemeColor = xlThemeColorAccent4\n            .TintAndShade = 0.399975585192419\n            .PatternTintAndShade = 0\n        Case Else\n            'red\n            .Pattern = xlSolid\n            .Color = 255\n            .TintAndShade = 0\n            .PatternTintAndShade = 0\n    End Select\nEnd With\n\nEnd Function\n</code></pre>\n\n<p>I spent efforts by trying:\n1. Using below code in Workbook: which is throwing 424 error</p>\n\n<pre><code>Private Sub Workbook_Open()\nSheet1.Activate\nCall Worksheet_Change(Target)\nEnd Sub\n</code></pre>\n\n<ol start=\"2\">\n<li>Pasting the entire code under Workbook_Open() function which is not working</li>\n</ol>\n\n<p>Can anyone suggest what i am missing in the code ?</p>\n\n<p>Sample Output image is attached\n<a href=\"https://i.stack.imgur.com/AwggX.png\" rel=\"nofollow noreferrer\">enter image description here</a></p>\n"}, {"tags": ["forms", "ms-access", "vba"], "comments": [{"owner": {"reputation": 2944, "user_id": 10095272, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0Shi9.jpg?s=128&g=1", "display_name": "Strawberryshrub", "link": "https://stackoverflow.com/users/10095272/strawberryshrub"}, "edited": false, "score": 0, "creation_date": 1538023956, "post_id": 52526837, "comment_id": 91998514, "body": "Is the recordsource of the forms based on a query (Maybe you requery always a different recordsource based on code)? Do your forms remember the filter (this way it requerys with the filter on)? Do you work in W-LAN (If you lose the connection to the backend the requerys dosnt work anymore)?"}, {"owner": {"reputation": 2524, "user_id": 6186333, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/ad477c5a0eb77e7fca29602b23db102f?s=128&d=identicon&r=PG&f=1", "display_name": "SandPiper", "link": "https://stackoverflow.com/users/6186333/sandpiper"}, "reply_to_user": {"reputation": 2944, "user_id": 10095272, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0Shi9.jpg?s=128&g=1", "display_name": "Strawberryshrub", "link": "https://stackoverflow.com/users/10095272/strawberryshrub"}, "edited": false, "score": 0, "creation_date": 1538055846, "post_id": 52526837, "comment_id": 92016302, "body": "@Strawberryshrub the record source is based on a query, which itself is based on another query. I do not have a filter on the form itself. The product front/back are all self contained. There is no external connection."}, {"owner": {"reputation": 2524, "user_id": 6186333, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/ad477c5a0eb77e7fca29602b23db102f?s=128&d=identicon&r=PG&f=1", "display_name": "SandPiper", "link": "https://stackoverflow.com/users/6186333/sandpiper"}, "edited": false, "score": 0, "creation_date": 1542832827, "post_id": 52526837, "comment_id": 93714566, "body": "I still have no idea what caused this bizarre bug, but I came up with a solution for it (below). Thank you for your help!"}], "answers": [{"tags": [], "owner": {"reputation": 2524, "user_id": 6186333, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/ad477c5a0eb77e7fca29602b23db102f?s=128&d=identicon&r=PG&f=1", "display_name": "SandPiper", "link": "https://stackoverflow.com/users/6186333/sandpiper"}, "is_accepted": true, "score": 0, "last_activity_date": 1542832798, "creation_date": 1542832798, "answer_id": 53420153, "question_id": 52526837, "link": "https://stackoverflow.com/questions/52526837/access-form-requery-working-inconsistently/53420153#53420153", "title": "Access Form.Requery Working Inconsistently", "body": "<p>I managed to solve this problem, but I still do not know what is causing it. I found that either opening the form from VBA code or from Access Macro would still present the same problem, but closing the form once and reopening it would make the problem go away for the duration of the session. Therefore, I modified the code for the button to open the display form to first open the form, close it, and then reopen it. Problem solved.</p>\n\n<pre><code>Private Sub Button_DisplayName_Click()\n    DoCmd.OpenForm \u201cFORM_NAME\u201d\n    DoCmd.Close acForm, \u201cFORM_NAME\u201d, acSaveNo\n    DoCmd.OpenForm \u201cFORM_NAME\u201d\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 15410039, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/71ec42de5457935615e99af88fa27fe4?s=128&d=identicon&r=PG", "display_name": "MattF", "link": "https://stackoverflow.com/users/15410039/mattf"}, "is_accepted": false, "score": 0, "last_activity_date": 1615920158, "creation_date": 1615920158, "answer_id": 66661470, "question_id": 52526837, "link": "https://stackoverflow.com/questions/52526837/access-form-requery-working-inconsistently/66661470#66661470", "title": "Access Form.Requery Working Inconsistently", "body": "<p>Had similar issue with this bug. Re-assigning the records is what finally worked for me, weird but it seems to consistently clear this glitch in my case.</p>\n<pre><code>rs = Me.Form.RecordSource\nMe.Form.RecordSource = rs\nMe.Requery\n</code></pre>\n"}], "owner": {"reputation": 2524, "user_id": 6186333, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/ad477c5a0eb77e7fca29602b23db102f?s=128&d=identicon&r=PG&f=1", "display_name": "SandPiper", "link": "https://stackoverflow.com/users/6186333/sandpiper"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1093, "favorite_count": 0, "accepted_answer_id": 53420153, "answer_count": 2, "score": 1, "last_activity_date": 1615920158, "creation_date": 1538000827, "question_id": 52526837, "link": "https://stackoverflow.com/questions/52526837/access-form-requery-working-inconsistently", "title": "Access Form.Requery Working Inconsistently", "body": "<p>I am having an issue with an Access Form Requery method working inconsistently.</p>\n\n<p>I have two forms. The first form is a <code>Data_Entry</code> form for the user. The second form is a <code>Dashboard</code> display that arranges and formats important data from the first form. On the <code>Data_Entry</code> form, there is a button the user can press to force a Requery event on both the <code>Data_Entry</code> and <code>Dashboard</code> forms. It is very simple code:</p>\n\n<pre><code>Private Sub Button_Update_Click()\n    Form_Data_Entry.Requery\n    Form_Dashboard.Requery\nEnd Sub\n</code></pre>\n\n<p>Within the <code>Dashboard</code> form, I also have a timer event that triggers every 60 seconds:</p>\n\n<pre><code>Private Sub Form_Timer()\n    Me.Requery\nEnd Sub\n</code></pre>\n\n<p>About 50% of the time these all work as expected. About 45% of the time, the update button on the <code>Data_Entry</code> form will Requery itself, but will do nothing to the dashboard; however, clicking on the <code>Dashboard</code> and pressing F5 will force the Requery, as will the timer event. The other 5% of the time, neither the update button nor F5 nor the timer will Requery the <code>Dashboard</code>.</p>\n\n<p>100% of the time, the update button will requery the <code>Data_Entry</code> form without issue.</p>\n\n<p>If I close the <code>Dashboard</code> and reopen it, it will work again as expected\u2026 for awhile. Sometimes it will go for hours without issue, other times only 15 minutes.</p>\n\n<p>I am at a loss as to what is causing this inconsistent behavior. It doesn\u2019t appear to be a VBA issue. Is this some kind of deeper problem within the Access source code itself, or am I missing something obscure elsewhere?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1538001375, "post_id": 52526582, "comment_id": 91993530, "body": "You know that it is not possible, if X is between 2 and 5 it is not possible to find a number between 1 and 6 that when subtracted is greater than your desired number of 5, what then?"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1538001619, "post_id": 52526582, "comment_id": 91993580, "body": "also this can be done with a formula, no need for vba."}, {"owner": {"reputation": 23, "user_id": 10275484, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Kn-kYRBGZLE/AAAAAAAAAAI/AAAAAAAAAK0/qeEj79O5G1Y/photo.jpg?sz=128", "display_name": "alireza taghizadeh", "link": "https://stackoverflow.com/users/10275484/alireza-taghizadeh"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1538037182, "post_id": 52526582, "comment_id": 92004676, "body": "if X is between 2 and 5, To prevent this problem we put in column E between 4 and 10 definitely"}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 10275484, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Kn-kYRBGZLE/AAAAAAAAAAI/AAAAAAAAAK0/qeEj79O5G1Y/photo.jpg?sz=128", "display_name": "alireza taghizadeh", "link": "https://stackoverflow.com/users/10275484/alireza-taghizadeh"}, "edited": false, "score": 0, "creation_date": 1538035437, "post_id": 52529074, "comment_id": 92003711, "body": "I want to every number in range (c2:c21) be less than D1 &lt;Sub bbbb() Dim i As Integer Dim AbsValRng As Range Set AbsValRng = Range(&quot;C1:C21&quot;) Dim RndmzRng As Range Set RndmzRng = Range(&quot;B1:B21&quot;) Dim cel As Range     With ActiveSheet         RndmzRng.Formula = &quot;=RANDBETWEEN(1,6)&quot;         AbsValRng.Formula = &quot;=ABS(RC[-2]-RC[-1])&quot;     End With End Sub&gt;"}], "tags": [], "owner": {"reputation": 2538, "user_id": 6388698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7gWUL.png?s=128&g=1", "display_name": "GMalc", "link": "https://stackoverflow.com/users/6388698/gmalc"}, "is_accepted": false, "score": 0, "last_activity_date": 1538070073, "last_edit_date": 1538070073, "creation_date": 1538019493, "answer_id": 52529074, "question_id": 52526582, "link": "https://stackoverflow.com/questions/52526582/selecting-number-in-column-x-randomly-to-achieve-desired-number/52529074#52529074", "title": "Selecting number in column &quot;x&quot; randomly to achieve desired number", "body": "<p>You can accomplish what you want by using <code>RANDBETWEEN</code> and <code>ABS</code> Formulas. </p>\n\n<pre><code>Dim RndmzRng As Range\nSet RndmzRng = Range(\"B2:B21\")\n\nDim AbsValRng As Range\nSet AbsValRng = Range(\"C2:C21\")\n\nDim cel As range\n\n    With ActiveSheet\n        RndmzRng.Formula = \"=RANDBETWEEN(1,6)\" 'so you don't need data in ColE\n        'can be use with cell references, \"=RANDBETWEEN($E$2,$E$3\") where E2=1 and E3=6\n        AbsValRng.Formula = \"=ABS(B2-A2)\" 'Absolute formula\n\n        For Each cel In AbsValRng 'colors the cells green that are &gt; the value in Range(\"D1\")\n            If cel.Value &gt; Range(\"D1\").Value Then\n                cel.Value = cel.Value - Range(\"D1\").Value\n            End If\n        Next\n    End With\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2538, "user_id": 6388698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7gWUL.png?s=128&g=1", "display_name": "GMalc", "link": "https://stackoverflow.com/users/6388698/gmalc"}, "edited": false, "score": 0, "creation_date": 1538065313, "post_id": 52538202, "comment_id": 92022449, "body": "Scott, the OPs comment to me below is &quot;I want to every number in range (c2:c21) be less than D1&quot;, and in his question he states &quot;so that absolute difference between An and Bn is more than my desirable number (D1)&quot;, It can&#39;t be both, i&#39;m not sure the OP knows what he wants."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 2538, "user_id": 6388698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7gWUL.png?s=128&g=1", "display_name": "GMalc", "link": "https://stackoverflow.com/users/6388698/gmalc"}, "edited": false, "score": 0, "creation_date": 1538065600, "post_id": 52538202, "comment_id": 92022603, "body": "@GMalc I agree, I just had this done last night, but forgot to hit post.  I liked it so I posted it.  If I am wrong, then I will delete."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 23, "user_id": 10275484, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Kn-kYRBGZLE/AAAAAAAAAAI/AAAAAAAAAK0/qeEj79O5G1Y/photo.jpg?sz=128", "display_name": "alireza taghizadeh", "link": "https://stackoverflow.com/users/10275484/alireza-taghizadeh"}, "edited": false, "score": 0, "creation_date": 1538076642, "post_id": 52538202, "comment_id": 92027628, "body": "So you want it between 0 and the Value in D1?  First if this answered your question as is then please mark it as correct by clicking the check mark by the answer.  Second new questions get new post.  Make sure you link to this one and show what you attempted to modify to get your desired result.  @alirezataghizadeh"}, {"owner": {"reputation": 23, "user_id": 10275484, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Kn-kYRBGZLE/AAAAAAAAAAI/AAAAAAAAAK0/qeEj79O5G1Y/photo.jpg?sz=128", "display_name": "alireza taghizadeh", "link": "https://stackoverflow.com/users/10275484/alireza-taghizadeh"}, "edited": false, "score": 0, "creation_date": 1538076934, "post_id": 52538202, "comment_id": 92027743, "body": "Exactly what I wanted. This screenshot was just an example, but my job is different That formula could solve my problem. Now I want to be  ABS($E$2:$E$7-A2)&gt;$D$1&gt;0 , I used  \u064eAnd function; but did not run"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 23, "user_id": 10275484, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Kn-kYRBGZLE/AAAAAAAAAAI/AAAAAAAAAK0/qeEj79O5G1Y/photo.jpg?sz=128", "display_name": "alireza taghizadeh", "link": "https://stackoverflow.com/users/10275484/alireza-taghizadeh"}, "edited": false, "score": 0, "creation_date": 1538077061, "post_id": 52538202, "comment_id": 92027793, "body": "@alirezataghizadeh see my last comment, this answered this question, as a new question and mark this correct by clicking the check mark by the answer.  This forum is different than others, new questions get new posts."}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 0, "last_activity_date": 1538054955, "creation_date": 1538054955, "answer_id": 52538202, "question_id": 52526582, "link": "https://stackoverflow.com/questions/52526582/selecting-number-in-column-x-randomly-to-achieve-desired-number/52538202#52538202", "title": "Selecting number in column &quot;x&quot; randomly to achieve desired number", "body": "<p>Put this in B2 and copy down:</p>\n\n<pre><code>=AGGREGATE(15,6,$E$2:$E$7/(ABS($E$2:$E$7-A2)&gt;=$D$1),RANDBETWEEN(1,SUMPRODUCT(--(ABS($E$2:$E$7-A2)&gt;=$D$1))))\n</code></pre>\n\n<p>I changed the numbers in E2:E7 so it would return values that are greater.  As stated in the comments.  Getting numbers 1-6 to work with 1-10 left many errors as one cannot find a number 1-6 that returns a number greater than 5 with an <code>X</code> of 2-5.</p>\n\n<p><a href=\"https://i.stack.imgur.com/MbROc.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/MbROc.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 23, "user_id": 10275484, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Kn-kYRBGZLE/AAAAAAAAAAI/AAAAAAAAAK0/qeEj79O5G1Y/photo.jpg?sz=128", "display_name": "alireza taghizadeh", "link": "https://stackoverflow.com/users/10275484/alireza-taghizadeh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 46, "favorite_count": 0, "accepted_answer_id": 52538202, "answer_count": 2, "score": 1, "last_activity_date": 1545850059, "creation_date": 1537999191, "last_edit_date": 1545850059, "question_id": 52526582, "link": "https://stackoverflow.com/questions/52526582/selecting-number-in-column-x-randomly-to-achieve-desired-number", "title": "Selecting number in column &quot;x&quot; randomly to achieve desired number", "body": "<p>I have numbers in a column (i.e., 1 to 10 in column A) and a few numbers in another column (i.e six numbers in column E).</p>\n\n<p>I want to place numbers of column E in column B randomly, so that absolute difference between An and Bn is more than my desirable number (D1).</p>\n\n<p>I used RandomSelection function:</p>\n\n<pre><code>Function RandomSelection(aRng As Range)\nDim index As Integer\nRandomize\nindex = Int(aRng.Count * Rnd + 1)\nRandomSelection = aRng.Cells(index).Value\nEnd Function\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/xpRsS.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/xpRsS.jpg\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["vba", "sap", "pywin32", "pywinauto"], "answers": [{"tags": [], "owner": {"reputation": 7644, "user_id": 3648361, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Y1aeF.jpg?s=128&g=1", "display_name": "Vasily Ryabov", "link": "https://stackoverflow.com/users/3648361/vasily-ryabov"}, "is_accepted": true, "score": 1, "last_activity_date": 1537996934, "creation_date": 1537996934, "answer_id": 52526194, "question_id": 52526104, "link": "https://stackoverflow.com/questions/52526104/sap-gui-scripting-create-pdf-from-print-screen-in-pywin32/52526194#52526194", "title": "SAP GUI Scripting - Create PDF from print screen in pywin32", "body": "<p>It should be much easier with pywinauto: <code>pip install pywinauto</code>. The code should look like this:</p>\n\n<pre><code>from pywinauto import Application\n\n# handle Print dialog\napp = Application(backend=\"win32\").connect(title=\"Print\") # timeout (in sec.) is optional\napp.PrintDialog.OK.click() # or .click_input() for real click\napp.PrintDialog.wait_not(\"visible\") # to make sure it is closed\n\n# handle Save dialog\napp = Application(backend=\"win32\").connect(title=\"Save Print Output As\") # maybe not needed if it is the same process\napp[\"Save Print Output As\"].FileNameEdit.set_text(file_path) # or .type_keys(file_path, with_spaces=True)\napp[\"Save Print Output As\"].SaveButton.click() # or .click_input()\napp[\"Save Print Output As\"].wait_not(\"visible\")\n</code></pre>\n"}], "owner": {"reputation": 97, "user_id": 10112876, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/142a1c16defd4d909a15ce01d1247529?s=128&d=identicon&r=PG&f=1", "display_name": "rgh_dsa", "link": "https://stackoverflow.com/users/10112876/rgh-dsa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 632, "favorite_count": 0, "accepted_answer_id": 52526194, "answer_count": 1, "score": 0, "last_activity_date": 1537996934, "creation_date": 1537996435, "question_id": 52526104, "link": "https://stackoverflow.com/questions/52526104/sap-gui-scripting-create-pdf-from-print-screen-in-pywin32", "title": "SAP GUI Scripting - Create PDF from print screen in pywin32", "body": "<p>I am trying to script a SAP process which looks at a custom report. The report can be \"printed\" and then saved as a pdf. However, once you specify \"LOCL\" as the output device and select the check box it goes to a print screen that isn't included in the gui scripting output. </p>\n\n<p>Does anyone know how to write script in vba or python to continue? I have attached a screenshot of the print dialog box that pops up that I can't figure out how to work in vba or python. Then the second dialog that comes up is asking for filepath and filename.</p>\n\n<p>It should be possible with pywin32 but I can't figure it out.\n<a href=\"https://i.stack.imgur.com/2iyFE.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/2iyFE.jpg\" alt=\"enter image description here\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/6WgMU.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/6WgMU.jpg\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 2, "creation_date": 1537993130, "post_id": 52525433, "comment_id": 91990738, "body": "<b>IMPORT</b> your data and use the text import wizard to declare the Date column format at the time of importing."}, {"owner": {"reputation": 65, "user_id": 5013847, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76b69deca8bd9458774a872a9b16b4a6?s=128&d=identicon&r=PG&f=1", "display_name": "busymind", "link": "https://stackoverflow.com/users/5013847/busymind"}, "edited": false, "score": 0, "creation_date": 1537993545, "post_id": 52525433, "comment_id": 91990910, "body": "The data is coming from database the user does not interact with the data. Everything is done with macro. I need to have a valid date format later to sort and process the worksheet. From what I see is that having leading zero is not taken as date by excel"}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1537993673, "post_id": 52525433, "comment_id": 91990974, "body": "Then have the macro IMPORT the data properly."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1537993678, "post_id": 52525433, "comment_id": 91990976, "body": "@RonRosenfeld yup missed that."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1537993747, "post_id": 52525433, "comment_id": 91991010, "body": "If you want a text string that is uniform put <code>r.NumberFormat = &quot;@&quot;</code> before assigning the value."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1537993897, "post_id": 52525433, "comment_id": 91991073, "body": "If you want a date output then you will need to change the format to match your local settings."}, {"owner": {"reputation": 65, "user_id": 5013847, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76b69deca8bd9458774a872a9b16b4a6?s=128&d=identicon&r=PG&f=1", "display_name": "busymind", "link": "https://stackoverflow.com/users/5013847/busymind"}, "edited": false, "score": 0, "creation_date": 1537994176, "post_id": 52525433, "comment_id": 91991183, "body": "When data is generated from ERP application opens directly the excel file and the user cannot or does not know. The data from DB have issues for now, I try to fix the dates before running the analysis through macro."}], "answers": [{"tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": false, "score": 0, "last_activity_date": 1537994236, "creation_date": 1537994236, "answer_id": 52525701, "question_id": 52525433, "link": "https://stackoverflow.com/questions/52525433/leading-zero-vba-excel-wrong-dates/52525701#52525701", "title": "Leading zero vba excel wrong dates", "body": "<p>The date formats do not match your local date format and as such Excel is trying to convert.</p>\n\n<p>You need to either put the date in and format it appropriately or make the cell text so excel does not try to convert.</p>\n\n<pre><code>Dim i As Long\nFor i = 2 To lastRow\n    Dim fDate As Date\n\n    Dim r As Range\n\n    Set r = Cells(i, Column_DateStamp)\n    strDate = Split(r.Text, \"/\")\n\n    fDate = DateSerial(strDate(2), strDate(1), strDate(0))\n\n    r.Clear\n    'True date - comment out if you want string\n    r.NumberFormat = \"dd/mm/yyyy\"\n    r.Value2 = fDate\n    'String - Uncomment if you want string\n'    r.NumberFormat = \"@\"\n'    r.Value2 = Format(fDate, \"dd/mm/yyyy\")\n\nNext i\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "is_accepted": false, "score": 0, "last_activity_date": 1537994442, "creation_date": 1537994442, "answer_id": 52525753, "question_id": 52525433, "link": "https://stackoverflow.com/questions/52525433/leading-zero-vba-excel-wrong-dates/52525753#52525753", "title": "Leading zero vba excel wrong dates", "body": "<p>Examining your screenshot, the problem is consistent with your Windows Regional Settings being <code>MDY</code> and the Database settings being <code>DMY</code>.  This will always result in incorrect action by Excel.</p>\n\n<p>Whoever wrote the ERP application should be able to make the change to input, to Excel, an unambiguous date format; or trigger the excel text import wizard at the time of import.</p>\n\n<p>You can try this macro in the meantime.  It should work, but read the notes carefully for possible pitfalls:</p>\n\n<pre><code>Option Explicit\nSub ConvertDates()\n    'converts dates that have been mismatched MDY / DMY\n    'Assumes dates are all in selected column\n    '   Only need to select a single cell in the column\n    '   will place results in a column next to original data\n    ' If adjacent column is not blank, a column will be inserted\n    'Figures out the original format by analyzing a \"text\" date\n    'Time components are converted directly.  This might be OK unless\n    ' in a non standard format such as 1400Z\n\nDim R As Range, C As Range\nDim sDelim As String\nDim FileDateFormat As String * 3\nDim i As Long, j As Long, V As Variant\nDim vDateParts As Variant\nDim YR As Long, MN As Long, DY As Long\nDim TM As Double\nDim vRes As Variant 'to hold the results of conversion\n\nSet R = Selection\n\n'Test that selected cell contains a date\nIf Not IsDate(R(1)) Then\n    MsgBox \"Select a cell containing a date\"\n    Exit Sub\nEnd If\n\nSet R = Intersect(R.EntireColumn, ActiveSheet.UsedRange)\nReDim vRes(1 To R.Rows.Count, 1 To 1)\n\n'Find a \"text date\" cell to analyze\nFor Each C In R\n    With C\n    If IsDate(.Value) And Not IsNumeric(.Value2) Then\n        'find delimiter\n        For i = 1 To Len(.Text)\n            If Not Mid(.Text, i, 1) Like \"#\" Then\n                sDelim = Mid(.Text, i, 1)\n                Exit For\n            End If\n        Next i\n\n        'split off any times\n        V = Split(.Text &amp; \" 00:00\")\n        vDateParts = Split(V(0), sDelim)\n\n        If vDateParts(0) &gt; 12 Then\n            FileDateFormat = \"DMY\"\n            Exit For\n        ElseIf vDateParts(1) &gt; 12 Then\n            FileDateFormat = \"MDY\"\n            Exit For\n        Else\n            MsgBox \"cannot analyze data\"\n            Exit Sub\n        End If\n    End If\n    End With\nNext C\n\nIf sDelim = \"\" Then\n   MsgBox \"cannot find problem\"\n   Exit Sub\nEnd If\n\n'Check that analyzed date format different from Windows Regional Settings\nSelect Case Application.International(xlDateOrder)\n    Case 0 'MDY\n        If FileDateFormat = \"MDY\" Then\n            MsgBox \"File Date Format and Windows Regional Settings match\" &amp; vbLf _\n                &amp; \"Look for problem elsewhere\"\n            Exit Sub\n        End If\n    Case 1 'DMY\n        If FileDateFormat = \"DMY\" Then\n            MsgBox \"File Date Format and Windows Regional Settings match\" &amp; vbLf _\n                &amp; \"Look for problem elsewhere\"\n            Exit Sub\n        End If\nEnd Select\n\n'Process dates\n'Could shorten this segment but probably more understandable this way\nj = 0\nSelect Case FileDateFormat\n    Case \"DMY\"\n        For Each C In R\n        With C\n            If IsDate(.Value) And IsNumeric(.Value2) Then\n            'Reverse the day and the month\n                YR = Year(.Value2)\n                MN = Day(.Value2)\n                DY = Month(.Value2)\n                TM = .Value2 - Int(.Value2)\n            ElseIf IsDate(.Value) And Not IsNumeric(.Value2) Then\n                V = Split(.Text &amp; \" 00:00\") 'remove the time\n                vDateParts = Split(V(0), sDelim)\n                YR = vDateParts(2)\n                MN = vDateParts(1)\n                DY = vDateParts(0)\n                TM = TimeValue(V(1))\n            Else\n                YR = 0\n            End If\n\n            j = j + 1\n            If YR = 0 Then\n                vRes(j, 1) = C.Value\n            Else\n                vRes(j, 1) = DateSerial(YR, MN, DY) + TM\n            End If\n        End With\n        Next C\n    Case \"MDY\"\n        For Each C In R\n        With C\n            If IsDate(.Value) And IsNumeric(.Value2) Then\n            'Reverse the day and the month\n                YR = Year(.Value2)\n                MN = Day(.Value2)\n                DY = Month(.Value2)\n                TM = .Value2 - Int(.Value2)\n            ElseIf IsDate(.Value) And Not IsNumeric(.Value2) Then\n                V = Split(.Text &amp; \" 00:00\") 'remove the time\n                vDateParts = Split(V(0), sDelim)\n                YR = vDateParts(2)\n                MN = vDateParts(0)\n                DY = vDateParts(1)\n                TM = TimeValue(V(1))\n            Else\n                YR = 0\n            End If\n\n            j = j + 1\n            If YR = 0 Then\n                vRes(j, 1) = C.Value\n            Else\n                vRes(j, 1) = DateSerial(YR, MN, DY) + TM\n            End If\n        End With\n        Next C\nEnd Select\n\nWith R.Offset(0, 1).EntireColumn\n    Set C = .Find(what:=\"*\", LookIn:=xlFormulas)\n    If Not C Is Nothing Then .EntireColumn.Insert\nEnd With\n\nR.Offset(0, 1).Value = vRes\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 65, "user_id": 5013847, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76b69deca8bd9458774a872a9b16b4a6?s=128&d=identicon&r=PG&f=1", "display_name": "busymind", "link": "https://stackoverflow.com/users/5013847/busymind"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 980, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1538054669, "creation_date": 1537992875, "last_edit_date": 1537993459, "question_id": 52525433, "link": "https://stackoverflow.com/questions/52525433/leading-zero-vba-excel-wrong-dates", "title": "Leading zero vba excel wrong dates", "body": "<p>I have this dates from DB and  I want to fix the date in VBA excel because excel switch the date with month when filter the column</p>\n\n<pre><code>27/08/2018\n31/08/2018\n12/9/2018\n2/8/2018    wrong date reported at filter in excel need 02/08/2018\n6/8/2018    wrong date reported at filter in excel need 06/08/2018\n13/08/2018\n17/08/2018\n20/08/2018\n20/08/2018\n</code></pre>\n\n<p>I have tried this </p>\n\n<pre><code>For i = 2 To lastRow\n    Dim fDate As Date\n    Dim dayF As String\n    Dim monthF As String\n    Dim yearF As String\n\n\n    Set r = Cells(i, Column_DateStamp)\n    strDate = Split(r.Text, \"/\")\n\n    dayF = CStr(Format(strDate(0), \"00\"))\n    monthF = CStr(Format(strDate(1), \"00\"))\n    yearF = CStr(Format(strDate(2), \"0000\"))\n    fDate = Format(DateSerial(strDate(2), CStr(Format(strDate(1), \"00\")), CStr(Format(strDate(0), \"00\"))), \"dd/mm/yyyy\")\n    r.Clear\n    r.Value = fDate\nNext i\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/UlOt7.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/UlOt7.png\" alt=\"enter image description here\"></a><a href=\"https://i.stack.imgur.com/HZb3I.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/HZb3I.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["excel", "vba", "file", "loops", "copy"], "comments": [{"owner": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 0, "creation_date": 1537992304, "post_id": 52525157, "comment_id": 91990341, "body": "<a href=\"https://stackoverflow.com/questions/22645347/loop-through-all-subfolders-using-vba\" title=\"loop through all subfolders using vba\">stackoverflow.com/questions/22645347/&hellip;</a>"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1537994785, "post_id": 52525157, "comment_id": 91991419, "body": "When the first folder is found does it stop there, or continue with any other existing ones?"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1537997343, "post_id": 52525157, "comment_id": 91992349, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/15480389/excel-vba-check-if-directory-exists-error\">Excel VBA Check if directory exists error</a>"}, {"owner": {"reputation": 361, "user_id": 8172841, "user_type": "registered", "profile_image": "https://graph.facebook.com/10213855898812088/picture?type=large", "display_name": "Jamie Riis", "link": "https://stackoverflow.com/users/8172841/jamie-riis"}, "edited": false, "score": 1, "creation_date": 1538001840, "post_id": 52525157, "comment_id": 91993629, "body": "There are tons of examples on this site as well as Microsoft.  I think you can quickly find your answer with a little more research"}], "owner": {"reputation": 9, "user_id": 10420756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/760ba538bb906db9589bb74c0c6467ef?s=128&d=identicon&r=PG&f=1", "display_name": "doe", "link": "https://stackoverflow.com/users/10420756/doe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 44, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1538053706, "creation_date": 1537991599, "last_edit_date": 1538053706, "question_id": 52525157, "link": "https://stackoverflow.com/questions/52525157/copying-files-from-varies-folders-loops-to-another-folder-using-vba", "title": "Copying files from varies folders loops to another folder using vba", "body": "<p>I'm trying to copy files from varies folders(excel files) to one folder. I want it to copy the excel files from those folders, but the folder may or may not exsist and would like to be able to resume to the next on error if the folder doesn't exist. new to vba.  Below is essentially what I would like but the loop doesn't work and I want to be able to just search the last 10 folder by the extensions below and if it doesn't exist to go on to the next one and so on until it reaches 10 folders names and copies all the excel files from that folder</p>\n\n<pre><code>Sub Day2()\nDim FSO As Object\nDim FromPath As String\nDim ToPath As String\nDim FileExt As String\nDim i As Integer\nFor i = 1 To 10\nFromPath = \"Sample folder\\Sample - Submited to TD by Date\\\" &amp; Format((Now - i), \"yyyy\") &amp; \"\\\" &amp; Format((Now - i), \"yyyy\") &amp; \"_\" &amp; Format((Now - i), \"mm\") &amp; \"\\\" &amp; _\n\"Submitted Requests - \" &amp; Format((Now - i), \"mm\") &amp; \"-\" &amp; Format((Now - i), \"dd\") &amp; \"-\" &amp; Format((Now - i), \"yy\")\nToPath = \"\\Sample\\To Combine\\\" \nFileExt = \"*.xl*\"\nIf Right(FromPath, 1) &lt;&gt; \"\\\" Then\n    FromPath = FromPath &amp; \"\\\"\nEnd If\nSet FSO = CreateObject(\"scripting.filesystemobject\")\nFSO.CopyFile Source:=FromPath &amp; FileExt, Destination:=ToPath\nNext i\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 2, "creation_date": 1537994232, "post_id": 52525048, "comment_id": 91991207, "body": "FWIW a splash screen that&#39;s shown without any actual work getting done and disappears after a preset number of seconds, is just plain obnoxious. Anyway, what specific version and bitness of Excel is the error being thrown for?"}, {"owner": {"reputation": 43, "user_id": 9211006, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/15500ef2e6370a2bbf45cea35b956018?s=128&d=identicon&r=PG&f=1", "display_name": "Hunter B", "link": "https://stackoverflow.com/users/9211006/hunter-b"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1537995701, "post_id": 52525048, "comment_id": 91991776, "body": "@Mathieu Guindon   I use the splash screen to show users some basic reminders and instructions the first 10 times they open the worksheet (my end users aren&#39;t exactly saavy).   But the problem PC is running 64 bit Excel 2013."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 2, "creation_date": 1537996265, "post_id": 52525048, "comment_id": 91991973, "body": "And the other machines are running 32-bit earlier Excel? You&#39;ll need to wrap all <code>Declare</code> statements with <code>#If VBA7</code> conditional-compilation logic to include the <code>PtrSafe</code> keyword as needed, and using <code>LongPtr</code> instead of <code>Long</code>. As for instructions, consider just having an &quot;Instructions&quot; worksheet, that can be activated automatically, or just the first 10 times they open the workbook."}, {"owner": {"reputation": 43, "user_id": 9211006, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/15500ef2e6370a2bbf45cea35b956018?s=128&d=identicon&r=PG&f=1", "display_name": "Hunter B", "link": "https://stackoverflow.com/users/9211006/hunter-b"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1538155074, "post_id": 52525048, "comment_id": 92058624, "body": "@MathieuGuindon I tried adding the conditional compilation logic as you described, but the error persists. Also, we are all running 64 bit excel so the issue is not related to that. Any more ideas? I appreciate the help!"}], "owner": {"reputation": 43, "user_id": 9211006, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/15500ef2e6370a2bbf45cea35b956018?s=128&d=identicon&r=PG&f=1", "display_name": "Hunter B", "link": "https://stackoverflow.com/users/9211006/hunter-b"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 372, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1537991031, "creation_date": 1537991031, "question_id": 52525048, "link": "https://stackoverflow.com/questions/52525048/splash-screen-causing-run-time-error-453-cant-find-dll-entry-point-findwin", "title": "Splash Screen Causing -- Run-Time Error 453: &quot;Can&#39;t find DLL entry point FindWindowA in user32&quot;", "body": "<p>I have a user of a excel vba macro getting the following error: </p>\n\n<p>Run-Time Error 453: \"Can't find DLL entry point FindWindowA in user32\"</p>\n\n<p>This one user is the only one out of a handful of testers getting this error. Any ideas what might be causing this? I am assuming the error is stemming from this API function: </p>\n\n<pre><code>Public Declare Function FindWindowA _\n                   Lib \"user32\" (ByVal lpClassName As String, _\n                   ByVal lpWindowName As String) As Long\n</code></pre>\n\n<p><a href=\"https://wellsr.com/vba/2016/excel/create-awesome-excel-splash-screen-for-your-spreadsheet/\" rel=\"nofollow noreferrer\">HERE IS THE TUTORIAL WHERE THE CODE CAME FROM -- TUTORIAL TO MAKE AN EXCEL SPLASH SCREEN</a></p>\n\n<p>Any help with this would be great! Not sure what is going wrong for her. \nThanks!</p>\n"}, {"tags": ["excel", "vba", "csv"], "comments": [{"owner": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 0, "creation_date": 1537991014, "post_id": 52524963, "comment_id": 91989748, "body": "it must be because column A, which you use to determine <code>DataLastRow</code> doesn&#39;t have any values in it"}, {"owner": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 0, "creation_date": 1537991045, "post_id": 52524963, "comment_id": 91989758, "body": "Also based on the way you&#39;re doing this, you cant just remove the <code>With ...</code> and <code>End With</code>, because they&#39;re not being used"}, {"owner": {"reputation": 25, "user_id": 4745199, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-TI8IIKBj2QY/AAAAAAAAAAI/AAAAAAAAANU/Mwmh-h14tcA/photo.jpg?sz=128", "display_name": "Micah Yarborough", "link": "https://stackoverflow.com/users/4745199/micah-yarborough"}, "reply_to_user": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 0, "creation_date": 1537991176, "post_id": 52524963, "comment_id": 91989825, "body": "Yeah the With is going, there was other stuff.  Column A Does in fact have data.  That&#39;s why its so weird."}, {"owner": {"reputation": 1110, "user_id": 5572384, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Y2BvJ.jpg?s=128&g=1", "display_name": "StoneGiant", "link": "https://stackoverflow.com/users/5572384/stonegiant"}, "edited": false, "score": 1, "creation_date": 1537991327, "post_id": 52524963, "comment_id": 91989893, "body": "What&#39;s odd to me is that you are getting values from whatever sheet is being referenced by <code>ws</code>, but you are deleting rows in the active sheet. Those aren&#39;t necessarily the same thing."}, {"owner": {"reputation": 25, "user_id": 4745199, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-TI8IIKBj2QY/AAAAAAAAAAI/AAAAAAAAANU/Mwmh-h14tcA/photo.jpg?sz=128", "display_name": "Micah Yarborough", "link": "https://stackoverflow.com/users/4745199/micah-yarborough"}, "edited": false, "score": 0, "creation_date": 1537991700, "post_id": 52524963, "comment_id": 91990074, "body": "This script has gone through a million changes over the course of a month.  It a little messy right now.  Removed the ActiveSheet and With statements.  Still deletes all data except headers.  To reiterate, Column A does have data in it.  So confusing.  Works for 73 out of 80 files.  :(  Column A is one of the columns guaranteed to always have data in it from the file provider which is why I use that one.  I&#39;d post the file but it has sensitive info"}, {"owner": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "reply_to_user": {"reputation": 1110, "user_id": 5572384, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Y2BvJ.jpg?s=128&g=1", "display_name": "StoneGiant", "link": "https://stackoverflow.com/users/5572384/stonegiant"}, "edited": false, "score": 0, "creation_date": 1537991760, "post_id": 52524963, "comment_id": 91990090, "body": "@StoneGiant good point. Wouldn\u2019t be the first time I saw <code>set ws = Activesheet</code>, though"}, {"owner": {"reputation": 25, "user_id": 4745199, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-TI8IIKBj2QY/AAAAAAAAAAI/AAAAAAAAANU/Mwmh-h14tcA/photo.jpg?sz=128", "display_name": "Micah Yarborough", "link": "https://stackoverflow.com/users/4745199/micah-yarborough"}, "edited": false, "score": 0, "creation_date": 1537991823, "post_id": 52524963, "comment_id": 91990109, "body": "To clarify, all files only contain one sheet as well, so ActiveSheet would always have been the correct sheet unless I&#39;m crazy lol"}, {"owner": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 0, "creation_date": 1537992090, "post_id": 52524963, "comment_id": 91990232, "body": "It depends on how you\u2019re iterating through all the workbooks but idk"}, {"owner": {"reputation": 25, "user_id": 4745199, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-TI8IIKBj2QY/AAAAAAAAAAI/AAAAAAAAANU/Mwmh-h14tcA/photo.jpg?sz=128", "display_name": "Micah Yarborough", "link": "https://stackoverflow.com/users/4745199/micah-yarborough"}, "edited": false, "score": 0, "creation_date": 1537992333, "post_id": 52524963, "comment_id": 91990359, "body": "Yeah this one for the books, holy moly"}, {"owner": {"reputation": 1110, "user_id": 5572384, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Y2BvJ.jpg?s=128&g=1", "display_name": "StoneGiant", "link": "https://stackoverflow.com/users/5572384/stonegiant"}, "edited": false, "score": 1, "creation_date": 1537992377, "post_id": 52524963, "comment_id": 91990385, "body": "Can you let us see the entire method?"}, {"owner": {"reputation": 25, "user_id": 4745199, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-TI8IIKBj2QY/AAAAAAAAAAI/AAAAAAAAANU/Mwmh-h14tcA/photo.jpg?sz=128", "display_name": "Micah Yarborough", "link": "https://stackoverflow.com/users/4745199/micah-yarborough"}, "edited": false, "score": 0, "creation_date": 1537992983, "post_id": 52524963, "comment_id": 91990676, "body": "Edited to show full script.  Its super ugly....not my fault  LOL  Also the files come from 67 different sources so we have to account for everything before upload to MySQL database"}, {"owner": {"reputation": 1110, "user_id": 5572384, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Y2BvJ.jpg?s=128&g=1", "display_name": "StoneGiant", "link": "https://stackoverflow.com/users/5572384/stonegiant"}, "edited": false, "score": 1, "creation_date": 1537994588, "post_id": 52524963, "comment_id": 91991334, "body": "Don&#39;t worry about the messy code. We all have to deal with it. As I suspected, <code>ws</code> is not always the active sheet. Notice that you are looping through a set of sheets with the <code>For each ws...</code> statement. I would explore that. You have mix of code, some dealing with the active sheet, some dealing with <code>ws</code>. With that kind of cross-over, you can have unexpected results. Maybe spend some time cleaning things up?"}, {"owner": {"reputation": 25, "user_id": 4745199, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-TI8IIKBj2QY/AAAAAAAAAAI/AAAAAAAAANU/Mwmh-h14tcA/photo.jpg?sz=128", "display_name": "Micah Yarborough", "link": "https://stackoverflow.com/users/4745199/micah-yarborough"}, "edited": false, "score": 0, "creation_date": 1538009576, "post_id": 52524963, "comment_id": 91995414, "body": "Yeah will likely tackle that tonight."}, {"owner": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 0, "creation_date": 1538067346, "post_id": 52524963, "comment_id": 92023459, "body": "phew, you&#39;re right, that is some ugly code lol"}], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 4745199, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-TI8IIKBj2QY/AAAAAAAAAAI/AAAAAAAAANU/Mwmh-h14tcA/photo.jpg?sz=128", "display_name": "Micah Yarborough", "link": "https://stackoverflow.com/users/4745199/micah-yarborough"}, "edited": false, "score": 0, "creation_date": 1538009698, "post_id": 52525688, "comment_id": 91995444, "body": "Will check this out as well, def remove loop.  Note: Double checked and there is only one sheet in the files that this is happening with."}, {"owner": {"reputation": 25, "user_id": 4745199, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-TI8IIKBj2QY/AAAAAAAAAAI/AAAAAAAAANU/Mwmh-h14tcA/photo.jpg?sz=128", "display_name": "Micah Yarborough", "link": "https://stackoverflow.com/users/4745199/micah-yarborough"}, "edited": false, "score": 0, "creation_date": 1538025242, "post_id": 52525688, "comment_id": 91998876, "body": "This deleted everything including Header.  Its almost as if its applying the delete from the empty file that the code lives in even though the working file is open and changes are applied as the script runs.  All changes affect the script properly except the delete.  Also added updated code.  Loop is still in there but will remove after testing thoroughly.  Any other ideas are appreciated.  Thanks to everyone for looking."}, {"owner": {"reputation": 1110, "user_id": 5572384, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Y2BvJ.jpg?s=128&g=1", "display_name": "StoneGiant", "link": "https://stackoverflow.com/users/5572384/stonegiant"}, "reply_to_user": {"reputation": 25, "user_id": 4745199, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-TI8IIKBj2QY/AAAAAAAAAAI/AAAAAAAAANU/Mwmh-h14tcA/photo.jpg?sz=128", "display_name": "Micah Yarborough", "link": "https://stackoverflow.com/users/4745199/micah-yarborough"}, "edited": false, "score": 0, "creation_date": 1538065107, "post_id": 52525688, "comment_id": 92022343, "body": "When dealing with multiple workbooks and worksheets, it is usually best to be very explicit about what are dealing with. You have a lot of code that needs to be updated, but my suggestion is to assign the opened workbook and subsequent worksheets to variables and reference those instead of depending on Active references. Once you&#39;ve ruled out Excel&#39;s guessing at what you&#39;re trying to do, it makes it easier to diagnose problems."}], "tags": [], "owner": {"reputation": 1110, "user_id": 5572384, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Y2BvJ.jpg?s=128&g=1", "display_name": "StoneGiant", "link": "https://stackoverflow.com/users/5572384/stonegiant"}, "is_accepted": true, "score": 0, "last_activity_date": 1537994763, "last_edit_date": 1537994763, "creation_date": 1537994164, "answer_id": 52525688, "question_id": 52524963, "link": "https://stackoverflow.com/questions/52524963/excel-vba-weird-issue/52525688#52525688", "title": "Excel VBA Weird Issue", "body": "<p>My guess is that the workbooks that are failing actually have multiple sheets. Note the <code>For Each ws In wB.Sheets</code> statement at the top of the code. That loop completes well down near the bottom of the code. If there are multiple sheets, <code>ws</code> will most definitely not always be pointing at the active worksheet.</p>\n\n<p>If you always want to work only with the active sheet, remove the loop completely and change these lines in your code:</p>\n\n<pre><code>DataLastRow = ws.Cells(ws.Rows.Count, \"A\").End(xlUp).Row\nSheetLastRow = ws.Cells.SpecialCells(xlLastCell).Row\n.\n.\n.\nws.SaveAs sPath &amp; NameOfWorkbook &amp; \".csv\", xlCSV\n</code></pre>\n\n<p>To</p>\n\n<pre><code>DataLastRow = Cells(ws.Rows.Count, \"A\").End(xlUp).Row\nSheetLastRow = Cells.SpecialCells(xlLastCell).Row\n.\n.\n.\nSaveAs sPath &amp; NameOfWorkbook &amp; \".csv\", xlCSV\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 4745199, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-TI8IIKBj2QY/AAAAAAAAAAI/AAAAAAAAANU/Mwmh-h14tcA/photo.jpg?sz=128", "display_name": "Micah Yarborough", "link": "https://stackoverflow.com/users/4745199/micah-yarborough"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 76, "favorite_count": 0, "accepted_answer_id": 52525688, "answer_count": 1, "score": 0, "last_activity_date": 1593599285, "creation_date": 1537990666, "last_edit_date": 1593599285, "question_id": 52524963, "link": "https://stackoverflow.com/questions/52524963/excel-vba-weird-issue", "title": "Excel VBA Weird Issue", "body": "<p>Excel Script deletes empty records(blank lines(,,,,,,,,,,,,,,,,,)) from a directory of files and saves as csv.  On a few random files out of 80 it deletes all rows except the header row.  Any ideas.  Debug led me to code below, last line is where removal happens, but looks as though it definitely should work for all files and def does for most.</p>\n\n<p>No merged columns exist and no weird formatting.</p>\n\n<p>Edited to show Full Script: (Warning: Very Ugly at the moment(Debugging and Circumstances))</p>\n\n<pre><code>Sub SaveToCSVs()\nDim fDir As String\nDim wB As Workbook\nDim ws As Worksheet\nDim fPath As String\nDim sPath As String\nDim LastRow As Long\nDim cell As Range\nDim cellMid As Range\nDim MiddleName As String\nDim MiddleNameColumn As ListColumn\nDim d As Double\nDim C As Range\n\nDim LR As Long, i As Long\n\nfPath = \"C:\\PPEAug\\Rosters EMP ID\\\"\nsPath = \"C:\\PPEAug\\Rosters EMP ID\\Converted\\\"\nfDir = Dir(fPath)\n\nDo While (fDir &lt;&gt; \"\")\n\nIf Right(fDir, 4) = \".xls\" Or Right(fDir, 5) = \".xlsx\" Then\n\nOn Error Resume Next\n    Set wB = Workbooks.Open(fPath &amp; fDir)\n    Set ws = wB.ActiveSheet\n    Set objExcel = CreateObject(\"Excel.Application\")\n    objExcel.Visible = False\n    objExcel.DisplayAlerts = False\n    Application.DisplayAlerts = False\n\nFor Each ws In wB.Sheets\n\n\nWith Range(\"A:Z\")\n    .Value2 = Evaluate(\"INDEX(Trim(\" &amp; .Address(0, 0) &amp; \"),,)\")\n    End With\n\nColumns(\"D:D\").Select\n    Selection.Replace What:=\"-\", Replacement:=\"\", LookAt:=xlPart, _\n    SearchOrder:=xlByColumns, MatchCase:=False, SearchFormat:=False, _\n    ReplaceFormat:=False\n    Range(\"D2:D5000\").Select\n\nDim rg As Range\n    For Each rg In Selection\n    rg.NumberFormat = \"@\"\n    If Len(rg.Value) &lt; 12 And Len(rg.Value) &gt; 0 Then\n    rg.Value = WorksheetFunction.Rept(\"0\", 12 - Len(rg.Value)) &amp; rg.Value\nEnd If\nNext\n\nColumns(\"E:E\").Select\n    Set rg = Selection\n    rg.NumberFormat = \"000-00-0000\"\n\nColumns(\"I:I\").Select\n    Selection.Insert Shift:=xlToRight, CopyOrigin:=xlFormatFromLeftOrAbove\n\nColumns(\"J:J\").Select\n    Selection.Insert Shift:=xlToRight, CopyOrigin:=xlFormatFromLeftOrAbove\n\nColumns(\"H:H\").Select\n    Selection.TextToColumns Destination:=Range(\"H1\"), DataType:=xlDelimited, _\n    TextQualifier:=xlDoubleQuote, ConsecutiveDelimiter:=True, Tab:=True, _\n    Semicolon:=False, Comma:=False, Space:=True, Other:=False, FieldInfo _\n    :=Array(Array(1, 1), Array(2, 1)), TrailingMinusNumbers:=True\n\nColumns(\"H:H\").Select\n    Selection.Insert Shift:=xlToRight, CopyOrigin:=xlFormatFromLeftOrAbove\n\nColumns(\"H:H\").Select\n    Selection.Insert Shift:=xlToRight, CopyOrigin:=xlFormatFromLeftOrAbove\n\n\n\n        Columns(\"G:G\").Select\nSelection.Replace What:=\" \", Replacement:=\"-\", LookAt:=xlPart, _\n    SearchOrder:=xlByColumns, MatchCase:=False, SearchFormat:=False, _\n    ReplaceFormat:=False\nSelection.Replace What:=\"-JR\", Replacement:=\" JR\", LookAt:=xlPart, _\n    SearchOrder:=xlByColumns, MatchCase:=False, SearchFormat:=False, _\n    ReplaceFormat:=False\nSelection.Replace What:=\"-SR\", Replacement:=\" SR\", LookAt:=xlPart, _\n    SearchOrder:=xlByColumns, MatchCase:=False, SearchFormat:=False, _\n    ReplaceFormat:=False\nSelection.Replace What:=\"-II\", Replacement:=\" II\", LookAt:=xlPart, _\n    SearchOrder:=xlByColumns, MatchCase:=False, SearchFormat:=False, _\n    ReplaceFormat:=False\nSelection.Replace What:=\"-III\", Replacement:=\" III\", LookAt:=xlPart, _\n    SearchOrder:=xlByColumns, MatchCase:=False, SearchFormat:=False, _\n    ReplaceFormat:=False\nSelection.Replace What:=\"-IV\", Replacement:=\" IV\", LookAt:=xlPart, _\n    SearchOrder:=xlByColumns, MatchCase:=False, SearchFormat:=False, _\n    ReplaceFormat:=False\nSelection.Replace What:=\".\", Replacement:=\"\", LookAt:=xlPart, _\n    SearchOrder:=xlByColumns, MatchCase:=False, SearchFormat:=False, _\n    ReplaceFormat:=False\nSelection.Replace What:=\", \", Replacement:=\" \", LookAt:=xlPart, _\n    SearchOrder:=xlByColumns, MatchCase:=False, SearchFormat:=False, _\n    ReplaceFormat:=False\nSelection.Replace What:=\",\", Replacement:=\" \", LookAt:=xlPart, _\n    SearchOrder:=xlByColumns, MatchCase:=False, SearchFormat:=False, _\n    ReplaceFormat:=False\n    Dim rCell As Range, strChar As String\n    strChar = \"-\"\n\nColumns(\"B:B\").Select\n    Selection.Replace What:=\"'\", Replacement:=\"\", LookAt:=xlPart, _\n    SearchOrder:=xlByColumns, MatchCase:=False, SearchFormat:=False, _\n    ReplaceFormat:=False\n\nRange(\"G1\").Select\n    ActiveCell.FormulaR1C1 = \"LAST NAME\"\n\nColumns(\"G:G\").Select\n    Selection.TextToColumns Destination:=Range(\"G1\"), DataType:=xlDelimited, _\n    TextQualifier:=xlDoubleQuote, ConsecutiveDelimiter:=True, Tab:=True, _\n    Semicolon:=False, Comma:=False, Space:=True, Other:=False, FieldInfo _\n    :=Array(Array(1, 1), Array(2, 1)), TrailingMinusNumbers:=True\n\nFor Each cell In Range(\"$A$1:\" &amp; Range(\"$A$1\").SpecialCells(xlLastCell).Address)\n    If Len(cell) &gt; 0 Then cell = UCase(cell)\nNext cell\nRange(\"A1\").Select\n    ActiveCell.FormulaR1C1 = \"AFFILIATE\"\nRange(\"B1\").Select\n    ActiveCell.FormulaR1C1 = \"PPE\"\nRange(\"C1\").Select\n    ActiveCell.FormulaR1C1 = \"DUES AMT\"\nRange(\"D1\").Select\n    ActiveCell.FormulaR1C1 = \"EMP ID\"\nRange(\"E1\").Select\n    ActiveCell.FormulaR1C1 = \"SSN\"\nRange(\"F1\").Select\n    ActiveCell.FormulaR1C1 = \"DOB\"\nRange(\"G1\").Select\n    ActiveCell.FormulaR1C1 = \"LAST NAME\"\nRange(\"H1\").Select\n    ActiveCell.FormulaR1C1 = \"NAME SUFFIX\"\nRange(\"I1\").Select\n    ActiveCell.FormulaR1C1 = \"PlaceHolder\"\nRange(\"J1\").Select\n    ActiveCell.FormulaR1C1 = \"FIRST NAME\"\nRange(\"K1\").Select\n    ActiveCell.FormulaR1C1 = \"MIDDLE NAME\"\nRange(\"L1\").Select\n    ActiveCell.FormulaR1C1 = \"SECOND MIDDLE\"\nRange(\"M1\").Select\n    ActiveCell.FormulaR1C1 = \"ADDRESS 1\"\nRange(\"N1\").Select\n    ActiveCell.FormulaR1C1 = \"ADDRESS 2\"\nRange(\"O1\").Select\n    ActiveCell.FormulaR1C1 = \"CITY\"\nRange(\"P1\").Select\n    ActiveCell.FormulaR1C1 = \"STATE\"\nRange(\"Q1\").Select\n    ActiveCell.FormulaR1C1 = \"ZIP\"\nColumns(\"I:I\").Select\n    Selection.Replace What:=\".\", Replacement:=\"\", LookAt:=xlPart, _\n    SearchOrder:=xlByColumns, MatchCase:=False, SearchFormat:=False, _\n    ReplaceFormat:=False\n\nColumns(\"A:A\").Select\n    Selection.Replace What:=\"L\", Replacement:=\"l\", LookAt:=xlPart, _\n    SearchOrder:=xlByColumns, MatchCase:=True, SearchFormat:=False, _\n    ReplaceFormat:=False\n    Selection.Replace What:=\"A\", Replacement:=\"a\", LookAt:=xlPart, _\n    SearchOrder:=xlByColumns, MatchCase:=True, SearchFormat:=False, _\n    ReplaceFormat:=False\n    Selection.Replace What:=\"B\", Replacement:=\"b\", LookAt:=xlPart, _\n    SearchOrder:=xlByColumns, MatchCase:=True, SearchFormat:=False, _\n    ReplaceFormat:=False\n\nRange(\"A1\").Select\n    ActiveCell.FormulaR1C1 = \"AFFIlIATE\"\n\n\n\nColumns(\"G:G\").Select\n    For Each C In Selection\n    If Right(C.Value, 1) = \"-\" Then\n    C.Value = Left(C.Value, Len(C.Value) - 1)\nEnd If\nNext C\nColumns(\"G:G\").Select\n    For Each C In Selection\n    If Right(C.Value, 1) = \"-\" Then\n    C.Value = Left(C.Value, Len(C.Value) - 1)\nEnd If\nNext C\nColumns(\"H:H\").Select\n    For Each C In Selection\n    If Right(C.Value, 1) = \"-\" Then\n    C.Value = Left(C.Value, Len(C.Value) - 1)\nEnd If\nNext C\nColumns(\"H:H\").Select\n    For Each C In Selection\n    If Right(C.Value, 1) = \"-\" Then\n    C.Value = Left(C.Value, Len(C.Value) - 1)\nEnd If\nNext C\nColumns(\"J:J\").Select\n    For Each C In Selection\n    If Right(C.Value, 1) = \"-\" Then\n    C.Value = Left(C.Value, Len(C.Value) - 1)\nEnd If\nNext C\nColumns(\"J:J\").Select\n    For Each C In Selection\n    If Right(C.Value, 1) = \"-\" Then\n    C.Value = Left(C.Value, Len(C.Value) - 1)\nEnd If\nNext C\nColumns(\"K:K\").Select\n    For Each C In Selection\n    If Right(C.Value, 1) = \"-\" Then\n    C.Value = Left(C.Value, Len(C.Value) - 1)\nEnd If\nNext C\nColumns(\"K:K\").Select\n    For Each C In Selection\n    If Right(C.Value, 1) = \"-\" Then\n    C.Value = Left(C.Value, Len(C.Value) - 1)\nEnd If\nNext C\n\nRange(\"A1\").Select\n    Application.CutCopyMode = False\n\n'DataLastRow = ws.Cells(ws.Rows.Count, \"B\").End(xlUp).Row\n'SheetLastRow = ws.Cells.SpecialCells(xlLastCell).Row\n'ws.Rows(DataLastRow + 1 &amp; \":\" &amp; SheetLastRow).Delete\n\nNameOfWorkbook = Left(wB.Name, (InStrRev(wB.Name, \".\", -1, vbTextCompare) - 1))\nws.SaveAs sPath &amp; NameOfWorkbook &amp; \".csv\", xlCSV\nNext ws\nwB.Close False\nSet wB = Nothing\n\n    End If\n\n    fDir = Dir\n    On Error GoTo 0\nLoop\nMsgBox \"PPE Roster Conversion Completed.\" \nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "excel-2016"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1537993037, "post_id": 52524912, "comment_id": 91990702, "body": "Shouldn&#39;t the <code>Destination</code> in the <code>AutoFill</code> include <i>both</i> the starting cell and the destination cell?"}, {"owner": {"reputation": 85, "user_id": 9686996, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a04184cd2a2b92a173d96d974fde5d4?s=128&d=identicon&r=PG&f=1", "display_name": "Sylphie", "link": "https://stackoverflow.com/users/9686996/sylphie"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1537993341, "post_id": 52524912, "comment_id": 91990823, "body": "@BigBen Oh, maybe. I\u2019ve tried making the destination the whole second row (Destination:=ActiveSheet.ListObjects(\u201cTable1\u201d).ListRows(2).&zwnj;&#8203;Range) and got the same error as before"}, {"owner": {"reputation": 85, "user_id": 9686996, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a04184cd2a2b92a173d96d974fde5d4?s=128&d=identicon&r=PG&f=1", "display_name": "Sylphie", "link": "https://stackoverflow.com/users/9686996/sylphie"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1537993410, "post_id": 52524912, "comment_id": 91990851, "body": "@BigBen I don\u2019t know how I\u2019d write it to only refer to two table cells, which is why I just skipped straight to the whole row"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1537993729, "post_id": 52524912, "comment_id": 91990999, "body": "Works for me by enclosing the two cells within a <code>Range</code> call - like <code>Range(.DataBodyRange(1, 2), .DataBodyRange(1, 3))</code>. You should be able to grab the entire <code>Range</code> of a <code>ListColumn</code>, excluding the first cell, and autofill to the right in one go, though, instead of looping through rows."}, {"owner": {"reputation": 85, "user_id": 9686996, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a04184cd2a2b92a173d96d974fde5d4?s=128&d=identicon&r=PG&f=1", "display_name": "Sylphie", "link": "https://stackoverflow.com/users/9686996/sylphie"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1537993965, "post_id": 52524912, "comment_id": 91991098, "body": "@BigBen I&#39;m getting the same error with <code>With ActiveSheet.ListObjects(&quot;Table1&quot;)                  .ListColumns.Add         .ListRows(2).Range.Select         Selection.AutoFill Destination:=Range(.DataBodyRange(1, 2), .DataBodyRange(1, 3)), Type:=xlFillDefault                  End With</code> Would you be able to post what worked for you? <b>Edit</b> Also tried <code>.ListColumns.Add         .DataBodyRange(1, 2).Select         Selection.AutoFill Destination:=Range(.DataBodyRange(1, 2), .DataBodyRange(1, 3)), Type:=xlFillDefault</code> but it didn&#39;t work"}], "answers": [{"comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "reply_to_user": {"reputation": 85, "user_id": 9686996, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a04184cd2a2b92a173d96d974fde5d4?s=128&d=identicon&r=PG&f=1", "display_name": "Sylphie", "link": "https://stackoverflow.com/users/9686996/sylphie"}, "edited": false, "score": 0, "creation_date": 1538072256, "post_id": 52525847, "comment_id": 92025701, "body": "Great! Glad to help."}], "tags": [], "owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "is_accepted": true, "score": 0, "last_activity_date": 1538072467, "last_edit_date": 1538072467, "creation_date": 1537994954, "answer_id": 52525847, "question_id": 52524912, "link": "https://stackoverflow.com/questions/52524912/how-to-copy-a-formula-horizontally-within-a-table-using-excel-vba/52525847#52525847", "title": "How to copy a formula horizontally within a table using Excel VBA?", "body": "<ul>\n<li>The <code>Destination</code> should include <em>both</em> the starting cell/range and the destination cell/range. </li>\n<li>The <code>AutoFill</code> can also be done in one go, instead of the current loop from the 2nd row to the last row. </li>\n<li>No need to use <code>Select</code> or <code>Selection</code>.</li>\n</ul>\n\n<p>Something then like this demonstrates the concept - modify as needed:</p>\n\n<pre><code>Option Explicit\n\nSub AutoFillRight()\n    Dim myTbl As ListObject: Set myTbl = Sheet1.ListObjects(\"Table1\")\n    Dim sourceRng As Range, destRng As Range\n    Dim lastRow As Long, lastCol As Long\n\n    With myTbl\n        .ListColumns.Add\n\n        lastRow = .ListRows.Count\n        lastCol = .ListColumns.Count\n\n        If lastRow &gt; 1 Then\n            Set sourceRng = Range(.DataBodyRange(2, lastCol - 1), .DataBodyRange(lastRow, lastCol - 1))\n            Set destRng = Range(.DataBodyRange(2, lastCol - 1), .DataBodyRange(lastRow, lastCol))\n\n            sourceRng.AutoFill Destination:=destRng, Type:=xlFillDefault\n        End If\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 85, "user_id": 9686996, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a04184cd2a2b92a173d96d974fde5d4?s=128&d=identicon&r=PG&f=1", "display_name": "Sylphie", "link": "https://stackoverflow.com/users/9686996/sylphie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 822, "favorite_count": 0, "accepted_answer_id": 52525847, "answer_count": 1, "score": 3, "last_activity_date": 1538072467, "creation_date": 1537990453, "question_id": 52524912, "link": "https://stackoverflow.com/questions/52524912/how-to-copy-a-formula-horizontally-within-a-table-using-excel-vba", "title": "How to copy a formula horizontally within a table using Excel VBA?", "body": "<p>So I have data that looks like this </p>\n\n<p><a href=\"https://i.stack.imgur.com/Rui5l.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Rui5l.png\" alt=\"tables in excel\"></a></p>\n\n<p>The top two tables are averaging together certain data from the third table.</p>\n\n<p>I'm trying to write a macro to add an extra column to each table, and simultaneously copy over the formula from the previous column. The adding of a new column is going great, but the copying-over is causing me problems. </p>\n\n<p>This is what I have so far:</p>\n\n<pre><code> Sub What()\n\nDim m As Integer\nDim n As Integer\nDim TableName As String\nDim i As Integer\nDim x As Integer\nDim LastRow As Integer\n\nFor i = 1 to 12\nTableName = \"Table\" &amp; i\n\n    With ActiveSheet.ListObjects(TableName)\n\n        .ListColumns.Add\n\n    n = .ListColumns.Count\n    m = n - 1\n\n             'this is filling in the first row, with the column number (needed for formulas in the real data)\n        .DataBodyRange(1, n).Value = n\n        .DataBodyRange(1, n).NumberFormat = \"General\"\n\n    LastRow = .ListRows.Count\n\n             'this is where I'm trying to copy the formula over to the right\n        For x = 2 To LastRow\n            .DataBodyRange(x, n) = .DataBodyRange(x, m).Formula\n        Next x\n\n    End With\n\n  Next i \n\nEnd Sub\n</code></pre>\n\n<p>The problem with this is that it's copying the formula straight, so my new column F of Table A1 is still averaging together the values of column E from Table A3.</p>\n\n<p>Before the code I have now, I tried AutoFill (like this: </p>\n\n<pre><code>Range(\"K4\").Select\n        Selection.AutoFill Destination:=Range(\"K4:L4\"), Type:=xlFillDefault\n</code></pre>\n\n<p>) </p>\n\n<p>but I don't need it to refer to a range, I need it to refer to a table cell, a la <a href=\"https://www.thespreadsheetguru.com/blog/2014/6/20/the-vba-guide-to-listobject-excel-tables\" rel=\"nofollow noreferrer\">ActiveSheet.ListObjects(\"Table1\").DataBodyRange(3, 2)</a>. Naively I attempted to sub this in for the destination</p>\n\n<pre><code>ActiveSheet.ListObjects(\"Table1\").ListColumns.Add\n        ActiveSheet.ListObjects(\"Table1\").DataBodyRange(1, 2).Select\n        Selection.AutoFill Destination:=ActiveSheet.ListObjects(\"Table1\").DataBodyRange(1, 3), Type:=xlFillDefault\n</code></pre>\n\n<p>and was told </p>\n\n<blockquote>\n  <p>Run-time error '1004':  AutoFill method of Range class failed</p>\n</blockquote>\n\n<p>All the resources I've googled refer to filling a formula down a column, but due to the orientation of my data I need it to copy horizontally, not vertically, and I haven't found anything for that. Can someone please help me with this?</p>\n\n<p>Thanks so much~ </p>\n"}, {"tags": ["vba", "excel", "excel-formula"], "comments": [{"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1537988344, "post_id": 52524316, "comment_id": 91988475, "body": "Do you just want to skip all weekends?"}, {"owner": {"reputation": 73, "user_id": 10009861, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c7fea6917c76cacb80742af4afb8bf6?s=128&d=identicon&r=PG&f=1", "display_name": "L.Th", "link": "https://stackoverflow.com/users/10009861/l-th"}, "reply_to_user": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1537988483, "post_id": 52524316, "comment_id": 91988541, "body": "@urdearboy Not all, just of actual week. For example, the next weekend is 09/29 and 09/30. these days i want skip, but the weekends later, for example, 10/06 and 10/07. Can be counted"}], "answers": [{"comments": [{"owner": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 0, "creation_date": 1537992580, "post_id": 52525023, "comment_id": 91990486, "body": "May as well list your source if you\u2019re just pasting it here"}, {"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1537999406, "post_id": 52525023, "comment_id": 91992985, "body": "Is this your working solution or where you are at so far?"}, {"owner": {"reputation": 73, "user_id": 10009861, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c7fea6917c76cacb80742af4afb8bf6?s=128&d=identicon&r=PG&f=1", "display_name": "L.Th", "link": "https://stackoverflow.com/users/10009861/l-th"}, "reply_to_user": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1538050016, "post_id": 52525023, "comment_id": 92012583, "body": "@urdearboy Yes, it is my solution, works like i wanted. I&#39;ll accept my answer tomorrow, &#39;cause now, i can&#39;t, is disabled to accept."}, {"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 1, "creation_date": 1538054384, "post_id": 52525023, "comment_id": 92015266, "body": "Oh, good job! Do you mind if I edit and clean up some indentation?"}, {"owner": {"reputation": 73, "user_id": 10009861, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c7fea6917c76cacb80742af4afb8bf6?s=128&d=identicon&r=PG&f=1", "display_name": "L.Th", "link": "https://stackoverflow.com/users/10009861/l-th"}, "reply_to_user": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1538076981, "post_id": 52525023, "comment_id": 92027755, "body": "@urdearboy Of course not, &#39;cause that i posted here. If helps someone, is available to use :)"}, {"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1538077572, "post_id": 52525023, "comment_id": 92028020, "body": "I indented and here are a few suggestions: You did not give <code>Day</code> a variable type. You need to declare the variable <code>i</code>. You don&#39;t need to create the new variable <code>FinalDay</code>. Just continue analyzing <code>Day</code> and it will be updated if it needs to be."}], "tags": [], "owner": {"reputation": 73, "user_id": 10009861, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c7fea6917c76cacb80742af4afb8bf6?s=128&d=identicon&r=PG&f=1", "display_name": "L.Th", "link": "https://stackoverflow.com/users/10009861/l-th"}, "is_accepted": true, "score": 0, "last_activity_date": 1538077431, "last_edit_date": 1538077431, "creation_date": 1537990931, "answer_id": 52525023, "question_id": 52524316, "link": "https://stackoverflow.com/questions/52524316/vba-add-days-with-weekends-less-the-weekend-of-actual-week/52525023#52525023", "title": "VBA - Add days with weekends, less the weekend of actual week", "body": "<p>I got it here! i'll post the code, if help someone.</p>\n\n<pre><code>Sub Example()\n\nDim Day, FinalDay As Date, ActualWeekend As String, DaysToAdd As Integer\n\nDaysToAdd = 14\nDay = CDate(Left(Now() + 1, 10)) 'here i add +1 to see if the final day ends on 10/13, but you can put any date as you wish\nActualWeekend = True\n\nFor i = 1 To DaysToAdd\n    If (Weekday(CDate(Day) + 1) = 7 Or Weekday(CDate(Day) + 1) = 1) And ActualWeekend = True Then\n        Day = CDate(WorksheetFunction.WorkDay(Day, 1))\n        ActualWeekend = False\n    Else\n        Day = Day + 1\n    End If\nNext i\n\nFinalDay = Day\n\nIf Weekday(CDate(FinalDay)) = 7 Or Weekday(CDate(FinalDay)) = 1 Then\n    FinalDay = CDate(WorksheetFunction.WorkDay(FinalDay, -1))\nEnd If\n\nMsgBox FinalDay\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 13906, "user_id": 9814069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mtoT.jpg?s=128&g=1", "display_name": "VBasic2008", "link": "https://stackoverflow.com/users/9814069/vbasic2008"}, "is_accepted": false, "score": 0, "last_activity_date": 1538009694, "creation_date": 1538009694, "answer_id": 52527923, "question_id": 52524316, "link": "https://stackoverflow.com/questions/52524316/vba-add-days-with-weekends-less-the-weekend-of-actual-week/52527923#52527923", "title": "VBA - Add days with weekends, less the weekend of actual week", "body": "<h2>Due Date: First Weekend Skip, Last Weekend Less</h2>\n\n<pre><code>Option Explicit\n'With Project ==================================================================\n'  .Title: DueDateFWSLWL - Due Date: First Weekend Skip, Last Weekend Less\n'  .Author: YMG\n''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''\n'  With .Contents\n'    Sub DueDateTester\n'*** Function DueDateFWSLWL ***\n'    Function WeekDayShifter\n'  End With\n'===============================================================================\n'\n'-------------------------------------------------------------------------------\nSub DueDateTester()\n'\n'Description\n'  Practical use of the DueDateFWSLWL Function.\n'Parameters\n'  None\n'Returns\n'  Various outputs of dates as the result of the DueDateFWSLWL Function.\n'\n'-- Customize BEGIN --------------------\n  Const Days As Long = 14\n'-- Customize END ----------------------\n'\n  Debug.Print DueDateFWSLWL(Days)\n  MsgBox DueDateFWSLWL(Days), vbInformation, \"Due Date\"\n''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''\n'or\n  Dim loF1 As Long\n  Dim str1 As String\n  str1 = \"Due Date from 1 to 100\"\n  For loF1 = 1 To 100 Step 2\n    str1 = str1 &amp; vbCrLf &amp; loF1 &amp; Chr(9) &amp; DueDateFWSLWL(loF1)\n  Next\n    Debug.Print str1\n    MsgBox str1, vbInformation, \"Due Date\"\n''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''\n'or\n'In Excel used as any other function e.g. type into cell A1 the number of days,\n'and into another cell =DueDateFWSLWL(A1)\n'etc.\n'\nEnd Sub\n'\n'-------------------------------------------------------------------------------\nFunction DueDateFWSLWL(Days As Long) As Date\n'\n'Description\n'  Calculates a 'due' date after a specified number of days counting from today,\n'  not counting the first weekend and shifting back to friday if it results on a\n'  weekend.\n'Parameters\u00b8\n'  cDays - The number of days.\n'Returns\n'  The 'due' date.\n'Precendents\n'  Function WeekDayShifter\n'\n  Dim Today As Date\n  Dim iWD As Integer\n  Dim iFirstWeekend As Integer\n  Dim loDays As Long\n''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''\n  'Date Function: Returns a Variant (Date) containing the current system date.\n  Today = Date\n  iWD = WeekDayShifter(Weekday(Today))\n  iFirstWeekend = 7 - iWD 'Results from 0-6\n  If iFirstWeekend &lt; Days + 2 Then\n    Select Case iFirstWeekend\n      Case 0 'It's a sunday.\n        loDays = Days '+ 0 '0 for monday.\n      Case 1 'It's a saturday.\n        loDays = Days + 1 '1 for sunday.\n      Case Else 'It's a workday.\n        loDays = Days + 2 '2 for first weekend (Saturday &amp; Sunday).\n    End Select\n   Else\n'\n'Time has run out. Sorry.\n'\n'This code might be wrong BEGIN ------------------------------------------------\n'But its only here for some ridiculous inputs like 1 or 2 days, so I don't care.\n    Select Case WeekDayShifter(Weekday(Today + Days))\n      Case 0 'It's a sunday.\n        loDays = Days - 2 '2 for sunday.\n      Case 1 'It's a saturday.\n        loDays = Days - 1 '1 for saturday.\n      Case Else 'It's a workday\n        loDays = Days '-0 '0 for workday.\n    End Select\n'This code might be wrong END --------------------------------------------------\n'\n  End If\n''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''\n  DueDateFWSLWL = Today + loDays\n  Select Case WeekDayShifter(Weekday(DueDateFWSLWL))\n    Case 7 'Sunday\n      DueDateFWSLWL = DueDateFWSLWL - 2\n    Case 6 'Saturday\n      DueDateFWSLWL = DueDateFWSLWL - 1\n  End Select\n'\nEnd Function\n'\n'-------------------------------------------------------------------------------\nFunction WeekDayShifter(Weekday As Integer) As Integer\n'\n'Description\n'  Shifts the results of the Weekday Function so that monday is the first day of\n'  the week and sunday the last (7th).\n'Parameters\n'  Weekday - Default weekday from the Visual Basic Weekday Function.\n'Returns\n'  A 'shifted' weekday integer.\n'Dependents\n'  Function DueDateFWSLWL\n'\n  If Not IsNumeric(Weekday) Or Weekday &lt; 1 Or Weekday &gt; 7 Then Exit Function\n  If Weekday &lt;&gt; 1 Then\n    WeekDayShifter = Weekday - 1 'From monday to saturday\n   Else\n    WeekDayShifter = 7 'Sunday\n  End If\n'\n''''''''''''''''''''''''''''''''''''''''\n' Weekday Function: ' WeekDayShifter:  '\n'  1 - Sunday *     '  1 - Monday      '\n'  2 - Monday       '  2 - Tuesday     '\n'  3 - Tuesday      '  3 - Wednesday   '\n'  4 - Wednesday    '  4 - Thursday    '\n'  5 - Thursday     '  5 - Friday      '\n'  6 - Friday       '  6 - Saturday *  '\n'  7 - Saturday *   '  7 - Sunday *    '\n''''''''''''''''''''''''''''''''''''''''\n'\nEnd Function\n'-------------------------------------------------------------------------------\n'\n'With Idea Source --------------------------------------------------------------\n'  .Title: VBA - Add days with weekends, less the weekend of actual week\n'  .TitleURL: https://stackoverflow.com/questions/52524316/vba-add-days-with-weekends-less-the-weekend-of-actual-week\n'  .Author: L.Th\n'  .AuthorURL: https://stackoverflow.com/users/10009861/l-th\n'End With ----------------------------------------------------------------------\n'\n'End With ======================================================================\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "is_accepted": false, "score": 0, "last_activity_date": 1538010440, "creation_date": 1538010440, "answer_id": 52527992, "question_id": 52524316, "link": "https://stackoverflow.com/questions/52524316/vba-add-days-with-weekends-less-the-weekend-of-actual-week/52527992#52527992", "title": "VBA - Add days with weekends, less the weekend of actual week", "body": "<p>You can also do this with a worksheet function.\nThe VBA equivalent:</p>\n\n<pre><code>Function dueDate(startDt As Date, numDays As Long) As Date\n\nWith Application.WorksheetFunction\n    dueDate = .WorkDay(.WorkDay(startDt, 5) + numDays - 5 + 1, -1)\nEnd With\n\nEnd Function\n</code></pre>\n\n<p><em>The worksheet function is the same:</em></p>\n\n<pre><code>=WORKDAY(WORKDAY(StartDt,5)+numDays-5+1,-1)\n</code></pre>\n"}], "owner": {"reputation": 73, "user_id": 10009861, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c7fea6917c76cacb80742af4afb8bf6?s=128&d=identicon&r=PG&f=1", "display_name": "L.Th", "link": "https://stackoverflow.com/users/10009861/l-th"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 455, "favorite_count": 0, "accepted_answer_id": 52525023, "answer_count": 3, "score": -3, "last_activity_date": 1538077431, "creation_date": 1537987822, "last_edit_date": 1538030915, "question_id": 52524316, "link": "https://stackoverflow.com/questions/52524316/vba-add-days-with-weekends-less-the-weekend-of-actual-week", "title": "VBA - Add days with weekends, less the weekend of actual week", "body": "<p>I want to create a VBA code where you take one weekday, <code>d</code> add <code>n</code> number of days to it and it will return the date <code>n</code> number of days later, <code>y</code>, excluding the weekend during the week of <code>d</code>. Note: if <code>y</code> falls on the weekend, it should return the previous weekday. </p>\n\n<pre><code>d + n - (weekend of d week) = y\n</code></pre>\n\n<p>For example, tomorrow is 09/27, if I count 14 days after, including weekends, less the weekend of this week. Would be, something like this: </p>\n\n<pre><code>09/27 + 14 days - (weekend of 09/27 week) = 10/12\n\n\nTomorrow: 09/27\n+1: 09/28\nNot Counted: 09/29 (Saturday of this week)\nNot Counted: 09/30 (Sunday of this week)\n+2: 10/01 (Here pass for the next workday, and from here can count the weekends after)\n+3: 10/02\n+4: 10/03\n+5: 10/04\n+6: 10/05\n+7: 10/06 (this day is Saturday, can be counted)\n+8: 10/07 (this day is Sunday, can be counted)\n+9: 10/08\n+10: 10/09\n+11: 10/10\n+12: 10/11\n+13: 10/12\n+14 10/13 &lt;- adding the days fall on this date. But, this day is a Saturday, so, comes back to previous workday, which is 10/12\n</code></pre>\n\n<p>How can I build something like this ?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "edited": false, "score": 1, "creation_date": 1538346239, "post_id": 52524148, "comment_id": 92100293, "body": "I stopped answering VBA web-scraping questions because I am now totally convinced that the best strategy is to use a Chrome Extension, see here <a href=\"https://exceldevelopmentplatform.blogspot.com/2018/06/python-javascript-mutationobserver_8.html\" rel=\"nofollow noreferrer\">exceldevelopmentplatform.blogspot.com/2018/06/&hellip;</a> and if you are wondering how to get the data into an Excel.exe then turn it into a web server with this <a href=\"https://exceldevelopmentplatform.blogspot.com/2018/03/vba-c-excel-as-web-server-with-rest.html\" rel=\"nofollow noreferrer\">exceldevelopmentplatform.blogspot.com/2018/03/&hellip;</a>  ... just some friendly advice."}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "reply_to_user": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "edited": false, "score": 0, "creation_date": 1538405228, "post_id": 52524148, "comment_id": 92122078, "body": "@SMeaden Thanks for the advice, however I think it&#39;s a bit irrelevant in this scenario."}, {"owner": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "edited": false, "score": 0, "creation_date": 1538484083, "post_id": 52524148, "comment_id": 92151108, "body": "Ok, &quot;when I go onto a fresh computer and add a new macro to this workbook, I can reproduce the issue.&quot;  what is in that macro?  I think the problematic code is not present in the text of the question."}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "reply_to_user": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "edited": false, "score": 0, "creation_date": 1538490072, "post_id": 52524148, "comment_id": 92154962, "body": "@SMeaden The code in the workbook is entirely web-scraping, so I&#39;ve omitted it. I&#39;m essentially trying to open Excel from another program (Filemaker Pro) and run this web-scraping code from Excel without the user ever seeing Excel (as it&#39;s the middle man)."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 2, "creation_date": 1538521404, "post_id": 52524148, "comment_id": 92169273, "body": "How are you instantiating Excel? A new Excel.Application shouldn&#39;t be visible by default."}, {"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 2, "creation_date": 1538531892, "post_id": 52524148, "comment_id": 92171465, "body": "@dwirony you will need to shows us some more code - no need to include all the web scraping stuff, but do include all code that creates/references the Excel app, and any code that opens/closes workbooks, including code in Filemaker, and an <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> of any code in Excel"}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1538576327, "post_id": 52524148, "comment_id": 92191698, "body": "@Comintern Opening the Excel workbook from Filemaker Pro."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1538576580, "post_id": 52524148, "comment_id": 92191867, "body": "@dwirony - Using what code?"}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "reply_to_user": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 0, "creation_date": 1538576589, "post_id": 52524148, "comment_id": 92191872, "body": "@chrisneilsen I&#39;ve added a larger scope of how my process is laid out."}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1538576601, "post_id": 52524148, "comment_id": 92191880, "body": "@Comintern I&#39;ve edited my question with the script."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1538577456, "post_id": 52524148, "comment_id": 92192448, "body": "If you&#39;re shelling Excel, it&#39;s just like opening it manually. Can you shell a .vbs to open it instead?"}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1538581044, "post_id": 52524148, "comment_id": 92194941, "body": "@Comintern Possibly... I&#39;ll have to look more into the capabilities of FMP... So you think using a .vbs script will trigger my <code>Workbook_Open</code> event?"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1538581489, "post_id": 52524148, "comment_id": 92195171, "body": "It should - the workaround seems to be open Excel in a way in which it isn&#39;t visible ever, and you can do that with VBS. If you&#39;re using <code>Workbook_Open</code> <i>only</i> to hide the application, it would be irrelevant."}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1538582020, "post_id": 52524148, "comment_id": 92195496, "body": "@Comintern Hmmm so I can use <code>Send Event</code> script in FMP to open the Excel application; it opens Excel without bringing it the foreground, but I can still see on my taskbar that the application itself is open..."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1538583197, "post_id": 52524148, "comment_id": 92196164, "body": "I&#39;m not familiar with FMP at all. Does it let you do something like <code>Open URL [With dialog:Off; &quot;C:\\Users\\Username\\Desktop\\MyScript.vbs&quot;]</code>?"}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1538600813, "post_id": 52524148, "comment_id": 92204606, "body": "@Comintern Conversely I&#39;m not familiar with vbscript at all - but it looks like I can use <code>Send Event</code> to run a text file containing a vbscript? It just feels like I&#39;m straying away too far here..."}, {"owner": {"reputation": 1560, "user_id": 5618307, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FVWb0.jpg?s=128&g=1", "display_name": "IqbalHamid", "link": "https://stackoverflow.com/users/5618307/iqbalhamid"}, "edited": false, "score": 0, "creation_date": 1538755668, "post_id": 52524148, "comment_id": 92268886, "body": "I have done this years ago without getting the symptoms you are experiencing.  I will post the answer when I get home tonight hopefully before the deadline."}, {"owner": {"reputation": 1560, "user_id": 5618307, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FVWb0.jpg?s=128&g=1", "display_name": "IqbalHamid", "link": "https://stackoverflow.com/users/5618307/iqbalhamid"}, "edited": false, "score": 0, "creation_date": 1538762080, "post_id": 52524148, "comment_id": 92271685, "body": "@Dwirony Please see my answer below.  I have suggested a possible explanation for why you are seeing a third instance and suggested a solution to prevent it.  I suspect that you may not be shutting down Excel in code properly.  You may be hiding it, instead.  So when you execute Applicatio.visible = true, you see the previous instance which was never shut down or unloaded from memory."}], "answers": [{"comments": [{"owner": {"reputation": 2685, "user_id": 1523914, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/95939ded1fb2423fbe9ba7989a0006ab?s=128&d=identicon&r=PG", "display_name": "Excel Developers", "link": "https://stackoverflow.com/users/1523914/excel-developers"}, "edited": false, "score": 0, "creation_date": 1538489346, "post_id": 52610106, "comment_id": 92154530, "body": "If you need to pass parameters to your macro I explain how to do that in my answer here <a href=\"https://stackoverflow.com/a/15203389/1523914\">stackoverflow.com/a/15203389/1523914</a>."}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1538513943, "post_id": 52610106, "comment_id": 92166857, "body": "I&#39;m not sure if this will suffice, since I am trying to stealthily load and hide Excel from another program. If I open a new instance of Excel, won&#39;t I still see my old shell of Excel still open?"}, {"owner": {"reputation": 968, "user_id": 5910169, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/601a40180e3fa49fbf4e55145adf54d9?s=128&d=identicon&r=PG&f=1", "display_name": "Frank Ball", "link": "https://stackoverflow.com/users/5910169/frank-ball"}, "edited": false, "score": 0, "creation_date": 1538578990, "post_id": 52610106, "comment_id": 92193548, "body": "Are you trying to hide all instances of Excel or just the one doing the screen-scraping?  If what you&#39;re trying to do is to hide everything, then do the screen scrape and then restore any other instances of Excel to their prior visible state, you&#39;re going to have to capture all the other instances of Excel and their Visible state and then once you have finished your screen-scraping process, restore each instance to it&#39;s prior state.  If you just want to hide the instance of Excel that&#39;s running the screen-scraping, then @ExcelDevelopers solution should work."}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "reply_to_user": {"reputation": 968, "user_id": 5910169, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/601a40180e3fa49fbf4e55145adf54d9?s=128&d=identicon&r=PG&f=1", "display_name": "Frank Ball", "link": "https://stackoverflow.com/users/5910169/frank-ball"}, "edited": false, "score": 0, "creation_date": 1538600845, "post_id": 52610106, "comment_id": 92204615, "body": "@FrankBall I want to hide all instances of Excel, which should just be one instance as Excel won&#39;t even be open to begin with."}, {"owner": {"reputation": 968, "user_id": 5910169, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/601a40180e3fa49fbf4e55145adf54d9?s=128&d=identicon&r=PG&f=1", "display_name": "Frank Ball", "link": "https://stackoverflow.com/users/5910169/frank-ball"}, "edited": false, "score": 0, "creation_date": 1538661364, "post_id": 52610106, "comment_id": 92228956, "body": "So if a user is running this and they already have an open instance of Excel, how do you want to handle that?  If this isn&#39;t being ran by  user, then what&#39;s the need for hiding Excel?"}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "reply_to_user": {"reputation": 968, "user_id": 5910169, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/601a40180e3fa49fbf4e55145adf54d9?s=128&d=identicon&r=PG&f=1", "display_name": "Frank Ball", "link": "https://stackoverflow.com/users/5910169/frank-ball"}, "edited": false, "score": 0, "creation_date": 1538676045, "post_id": 52610106, "comment_id": 92237300, "body": "@FrankBall A user will be running this. And I haven&#39;t anticipated what will happen if they already have Excel open, I&#39;d have to tell them ahead of time to not have it open..."}, {"owner": {"reputation": 968, "user_id": 5910169, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/601a40180e3fa49fbf4e55145adf54d9?s=128&d=identicon&r=PG&f=1", "display_name": "Frank Ball", "link": "https://stackoverflow.com/users/5910169/frank-ball"}, "edited": false, "score": 0, "creation_date": 1538679133, "post_id": 52610106, "comment_id": 92238197, "body": "Then you may want to take a look at this:  <a href=\"https://excelribbon.tips.net/T009452_Finding_Other_Instances_of_Excel_in_a_Macro.html\" rel=\"nofollow noreferrer\">excelribbon.tips.net/&hellip;</a>"}], "tags": [], "owner": {"reputation": 2685, "user_id": 1523914, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/95939ded1fb2423fbe9ba7989a0006ab?s=128&d=identicon&r=PG", "display_name": "Excel Developers", "link": "https://stackoverflow.com/users/1523914/excel-developers"}, "is_accepted": false, "score": 3, "last_activity_date": 1547622595, "last_edit_date": 1547622595, "creation_date": 1538489218, "answer_id": 52610106, "question_id": 52524148, "link": "https://stackoverflow.com/questions/52524148/hiding-the-excel-application-during-run-time/52610106#52610106", "title": "Hiding the Excel application during run-time", "body": "<p>I was able to reproduce your issue. First, I tested hiding the Application without having PERSONAL.xlsb loaded, and it worked fine. Then I loaded PERSONAL.xlsb and got the same behavior you did: an extra Excel shell became visible after Application.Visible = True.</p>\n\n<p>I'm not sure why you sometimes get two extra shells, but maybe you have another addin (.xlam) loaded? You could try adding some code to unload all addins first, but I have an alternative solution: why not just launch a new instance of Excel, load your macro workbook in it and run the macro? For example, if your workbook is called C:\\Book1.xlsb and the macro in it is \"MyMacro\" then create a second workbook with code that will launch Book1. Like this:</p>\n\n<pre><code>Sub LaunchIt()\n\n    Dim xlApp As Excel.Application\n    Dim wb As Workbook\n\n    Set xlApp = New Excel.Application\n\n    With xlApp\n        Set wb = .Workbooks.Open(\"C:\\Book1.xlsb\")\n        .Run \"'\" &amp; wb.Name &amp; \"'!MyMacro\"\n        wb.Close SaveChanges:=False\n        .Quit\n    End With\n\nEnd Sub\n</code></pre>\n\n<p>The new instance of Excel is not visible by default, so no need to set visibility. I tested it and it worked for me.</p>\n"}, {"comments": [{"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1538662185, "post_id": 52645894, "comment_id": 92229498, "body": "All 3 excels still show up, then I get a subscript out of range on line <code>x.Windows(1).Visible = True</code>."}, {"owner": {"reputation": 3078, "user_id": 8537807, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2J8ds.png?s=128&g=1", "display_name": "EvR", "link": "https://stackoverflow.com/users/8537807/evr"}, "reply_to_user": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1538665777, "post_id": 52645894, "comment_id": 92231905, "body": "So there is a PERSONAL.XLSB on the background opened, strange, it works on my side . Just added a for each loop in previous answer as another workaround."}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1538675987, "post_id": 52645894, "comment_id": 92237277, "body": "Changed the <code>For Each</code> loop, still the same results with no error. 3 Excel applications."}], "tags": [], "owner": {"reputation": 3078, "user_id": 8537807, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2J8ds.png?s=128&g=1", "display_name": "EvR", "link": "https://stackoverflow.com/users/8537807/evr"}, "is_accepted": false, "score": 0, "last_activity_date": 1538665576, "last_edit_date": 1538665576, "creation_date": 1538653573, "answer_id": 52645894, "question_id": 52524148, "link": "https://stackoverflow.com/questions/52524148/hiding-the-excel-application-during-run-time/52645894#52645894", "title": "Hiding the Excel application during run-time", "body": "<p>I can reproduce this behavior also, but setting the Visible-property of the window to false will solve it.</p>\n\n<pre><code>Private Sub Workbook_Open()\nDim x As Workbook\nWith Application\n    .Visible = False\n    .Wait (Now + TimeValue(\"0:00:05\"))\n    .Visible = True\n        For Each x In .Workbooks\n            If x.Name = \"PERSONAL.XLSB\" Then 'maybe also other addins(?)\n                x.Windows(1).Visible = True\n                x.Windows(1).Visible = False 'toggle\n                x.Saved = True 'for not getting save-alerts\n            End If\n        Next\nEnd With\nEnd Sub\n</code></pre>\n\n<p>Edit:</p>\n\n<p>or changing the for each loop to:</p>\n\n<pre><code>    For Each myAdd In AddIns\n        myAdd.Installed = False\n    Next myAdd\n</code></pre>\n\n<p>works on my side (But: on closing you've to set your previous installed addins back to True)</p>\n"}, {"comments": [{"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1538758899, "post_id": 52670261, "comment_id": 92270351, "body": "And what are these userforms? I&#39;m trying to hide Excel during run-time, then have only my main workbook re-appear afterwards."}, {"owner": {"reputation": 1560, "user_id": 5618307, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FVWb0.jpg?s=128&g=1", "display_name": "IqbalHamid", "link": "https://stackoverflow.com/users/5618307/iqbalhamid"}, "reply_to_user": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1538760356, "post_id": 52670261, "comment_id": 92270924, "body": "@dwirony: I have re-edited my answer so it addresses your question.  Basically, my userforms are forms I created to provide a GUI front end for user interaction.  As I hide my Excel, I am effectively creating a Windows application powered by Excel VBA with little to give it away that there is an Excel spreadsheet behind the application.  Hope this makes it clearer for you!"}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1538762232, "post_id": 52670261, "comment_id": 92271753, "body": "No dice - this just hides the workbook, not the application. I&#39;m trying to complete hide the application during run-time. There are no previous version of Excel open, I&#39;ve checked all the processes in task manager. One of the re-appearing workbooks is my <code>PERSONAL.xlsb</code>, the other one is unknown."}, {"owner": {"reputation": 1560, "user_id": 5618307, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FVWb0.jpg?s=128&g=1", "display_name": "IqbalHamid", "link": "https://stackoverflow.com/users/5618307/iqbalhamid"}, "reply_to_user": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1538763482, "post_id": 52670261, "comment_id": 92272278, "body": "@dwirony ThisWorkbook.Windows(1).Visible = False will hide the workbook.    Application.visible = false DOES hide the entire EXCEL application.  No trace of it remains visible!  I promise you.  I have used this code successfully.  I can email it to you so you can run it and see for yourself.  What do you mean by application?  Are you trying to hide some additional UI forms?"}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1538764591, "post_id": 52670261, "comment_id": 92272771, "body": "Yes, <code>Application.Visible = False</code> hides the application just fine, but when I use <code>Application.Visible = True</code> I get 3 instances of the application. Your code that you&#39;ve just provided is not hitting <code>Application.Visible = False</code> because I <i>technically</i> have two workbooks open - my main workbook and the <code>PERSONAL.xlsb</code> which opens automatically."}, {"owner": {"reputation": 1560, "user_id": 5618307, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FVWb0.jpg?s=128&g=1", "display_name": "IqbalHamid", "link": "https://stackoverflow.com/users/5618307/iqbalhamid"}, "reply_to_user": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1538767822, "post_id": 52670261, "comment_id": 92274139, "body": "@dwirony In that case, simply take Application.Visible = False outside of the if-else block.  That is, get rid of the if-else block and replace it with Application.visible = False.   The if else is only there so as not to affect other open and unconnected spreadsheets."}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1538767861, "post_id": 52670261, "comment_id": 92274154, "body": "There won&#39;t be any other open spreadsheets when this code runs."}], "tags": [], "owner": {"reputation": 1560, "user_id": 5618307, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FVWb0.jpg?s=128&g=1", "display_name": "IqbalHamid", "link": "https://stackoverflow.com/users/5618307/iqbalhamid"}, "is_accepted": false, "score": 0, "last_activity_date": 1538761403, "last_edit_date": 1538761403, "creation_date": 1538758767, "answer_id": 52670261, "question_id": 52524148, "link": "https://stackoverflow.com/questions/52524148/hiding-the-excel-application-during-run-time/52670261#52670261", "title": "Hiding the Excel application during run-time", "body": "<p>If I have understood you correctly, you wish to go invisible to the user during a particular operation then reappear once that operation has completed?</p>\n\n<p>If so, then take a look at the code I used to make my application actually start with Excel invisible with only a particular form on show:</p>\n\n<p>When the user has finished and wishes to quit the application, he presses cmdQuit command button.  The code behind this would make Excel re-appear:  Code pasted below.  I hope this helps to inspire you to find the solution for your situation.</p>\n\n<p><strong>Notes:</strong>\n<br>\n1.  Ideally we would like to make the entire excel invisible!  So, if there is only <em>one</em> instance of Excel open on the machine, then use <code>Application.visible = true</code>.  However, it may be that other spreadsheets are open.  If this is the case, then only hide the current workbook.  Hence <code>ThisWorkbook.Windows(1).Visible = False</code> is used after in the <code>Else</code> block.\n<br><br>\n2.  Once Excel has been made invisible, we load up our forms.  These are windows which provide a front end GUI for interaction with the user.  I am thus able to create a proper application from Excel almost without any indication that Excel is running behind the scenes.\n<br><br>\n3.  Once the user has finished, he presses an exit button which I have called cmdExit.  You can see the code bend this button below.  It unloads the GUI forms and makes Excel visible again for the user.  This is similar to what you want to achieve.</p>\n\n<pre><code>Private Sub Workbook_Open()\n\n    Stop\n\n    ' Hide Excel...\n'    ActiveWorkbook.Windows(1).Visible = False\n    If Workbooks.Count &lt; 2 Then\n        Application.Visible = False\n    Else\n        ThisWorkbook.Windows(1).Visible = False\n    End If\n\n    Load frmMain\n    frmMain.Show vbModal\n\nEnd Sub\n\n\nPrivate Sub cmdQuit_Click()\n\n    'ThisWorkbook.Windows(1).Visible = True\n    Application.Visible = True\n    Unload frmMoreOccupationLines\n    Unload Me\n\nEnd Sub\n</code></pre>\n\n<p><br></p>\n\n<p>I think the reason you might be seeing more than one workbook may be because you have inadvertantly left previous instances of Excel still open but hidden (invisible).  They have not been unloaded and still remain in memory.  Does that make sense?  So when you do <code>Application.visible=true</code>, you are seeing all the previous instances which you did not properly quit.  So a solution for m you may be to ensure you implement a proper unload and exit strategy in your code.</p>\n\n<p>So I guess you might be looking for a solution like as shown below:</p>\n\n<pre><code>Sub Test()\n    If Workbooks.Count &lt; 2 Then\n        Application.Visible = False\n    Else\n        ThisWorkbook.Windows(1).Visible = False\n    End If\n\n    Application.Wait (Now + TimeValue(\"0:00:05\"))\n\n    If Workbooks.Count &lt; 2 Then\n        Application.Visible = True\n    Else\n        ThisWorkbook.Windows(1).Visible = True\n    End If\nEnd Sub\n\n\nPrivate Sub cmdQuit_Click()\n    Application.Visible = True\n    'Unload Me\n    Application.Quit\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4033, "favorite_count": 6, "answer_count": 3, "score": 14, "last_activity_date": 1547622595, "creation_date": 1537986895, "last_edit_date": 1538577042, "question_id": 52524148, "link": "https://stackoverflow.com/questions/52524148/hiding-the-excel-application-during-run-time", "title": "Hiding the Excel application during run-time", "body": "<p>I'm trying to hide Excel during a long script in which I do some web-scraping. I'm able to hide the application just fine, the problem is that when I change <code>.Visible</code> back to <code>True</code>, I'm getting 1-2 more additional applications (just empty Excel shells). I'm guessing one of these are my <code>PERSONAL.xlsb</code> workbook, but I'm not sure what the other one is - sometimes I get one extra, sometimes I get two. The only way I can close these shell files is by ending the <code>EXCEL.EXE</code> process via task manager.</p>\n\n<p>I've tried hiding just the main window (<code>Windows(1)</code>) as well to no avail (it just hides the workbook, not the application):</p>\n\n<pre><code>Sub Test()\n\nWindows(ThisWorkbook.Name).Visible = False\n\nApplication.Wait (Now + TimeValue(\"0:00:05\"))\n\nWindows(ThisWorkbook.Name).Visible = True\n\nEnd Sub\n</code></pre>\n\n<p><strong>How can I just have my main workbook re-appear?</strong></p>\n\n<p>Sample code:</p>\n\n<pre><code>Sub Test()\n\nApplication.Visible = False\n\nApplication.Wait (Now + TimeValue(\"0:00:05\"))\n\nApplication.Visible = True\n\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/HW3CQ.png\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/HW3CQ.png\" alt=\"enter image description here\"></a></p>\n\n<p>Edit: This is on Windows 7, Excel 2016</p>\n\n<p>Edit2: Running just <code>Application.Visible = True</code> by itself also gives me these two phantom applications.</p>\n\n<p>Edit3: The issue definitely has to do with having macros stored in the <code>PERSONAL.xlsb</code> file - when I go onto a fresh computer and add a new macro to this workbook, I can reproduce the issue. However, I'm still not sure how to avoid it...</p>\n\n<p>Task manager:</p>\n\n<p><a href=\"https://i.stack.imgur.com/Hp8mk.png\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/Hp8mk.png\" alt=\"img1\"></a></p>\n\n<p>The script that opens Excel from Filemaker Pro:</p>\n\n<p><code>Open URL [With dialog:Off; \"C:\\Users\\Username\\Desktop\\TestFile.xlsm\"]</code></p>\n\n<p>Inside <code>TestFile.xlsm</code>:</p>\n\n<pre><code>Private Sub Workbook_Open()\n\nApplication.Visible = False\n\n'Refresh a query in the Excel workbook that is linked to Filemaker Pro\n\n'Webscrape, webscrape, webscrape from a worksheet inside this Excel document\n'to a hidden Internet Explorer Window (ewww, IE!)\n\nApplication.Wait (Now + TimeValue(\"0:00:05\"))\n\nApplication.Visible = True\n\n'Either close Excel completely or reload my main instance of Excel\n\nEnd Sub\n</code></pre>\n\n<p><strong>I've realized that I can just completely quit Excel with Excel.Application.Quit, but I haven't decided if I want to exit out right away, or repaint a UserForm in Excel that summarizes the import process</strong></p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 255, "user_id": 1806531, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1e5c2468b26cc8a209c909e52942e9e8?s=128&d=identicon&r=PG", "display_name": "Kaish", "link": "https://stackoverflow.com/users/1806531/kaish"}, "edited": false, "score": 0, "creation_date": 1537986410, "post_id": 52523978, "comment_id": 91987540, "body": "Even though I figured out my original question, I&#39;m still not sure on the answer to my add on part (i.e instead of selecting hyperlinks and printing them, how would I delete all values that don&#39;t contain a link). Does anyone know the answer to this?"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1537986489, "post_id": 52523978, "comment_id": 91987584, "body": "The second part would require you to create a range, loop through it, and see if a hyperlink exists in that row. If not, delete entire row."}], "answers": [{"tags": [], "owner": {"reputation": 255, "user_id": 1806531, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1e5c2468b26cc8a209c909e52942e9e8?s=128&d=identicon&r=PG", "display_name": "Kaish", "link": "https://stackoverflow.com/users/1806531/kaish"}, "is_accepted": true, "score": 0, "last_activity_date": 1586964923, "creation_date": 1586964923, "answer_id": 61232687, "question_id": 52523978, "link": "https://stackoverflow.com/questions/52523978/read-column-select-hyperlink-and-then-paste-link-name/61232687#61232687", "title": "Read column, select hyperlink, and then paste link name", "body": "<p>Changing the \"HL.Address\" to HL.Range pastes that range.</p>\n"}], "owner": {"reputation": 255, "user_id": 1806531, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1e5c2468b26cc8a209c909e52942e9e8?s=128&d=identicon&r=PG", "display_name": "Kaish", "link": "https://stackoverflow.com/users/1806531/kaish"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 162, "favorite_count": 0, "accepted_answer_id": 61232687, "answer_count": 1, "score": 0, "last_activity_date": 1593880191, "creation_date": 1537986115, "last_edit_date": 1593880191, "question_id": 52523978, "link": "https://stackoverflow.com/questions/52523978/read-column-select-hyperlink-and-then-paste-link-name", "title": "Read column, select hyperlink, and then paste link name", "body": "<p>I have a column of data. I want to select the cells that contain a hyperlink and print just the values of those cells.</p>\n<p>I have the following code to extract the hyperlink. I want if there is a link in cell A1 called &quot;hello&quot;, it doesn't print the link itself, but prints &quot;hello&quot;.</p>\n<pre><code>Sub ExtractHL()\n\nDim HL As Hyperlink\n\nFor Each HL In ActiveSheet.Hyperlinks\n\n    HL.Range.Offset(0, 1).Value = HL.Address\n\nNext\n\nEnd Sub\n</code></pre>\n<p>The other idea I just had was to say that if a cell in a row DOESN'T contain a hyperlink, then to delete that row, but I'm not sure how to negate the &quot;for each HL in sheet&quot; line.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 1, "creation_date": 1537985882, "post_id": 52523876, "comment_id": 91987284, "body": "It depends on what you want to do with the range <code>A1:C150</code>. You should qualify your ranges. <code>So ThisworkBook.Sheets(&quot;Sheet1&quot;).Range(&quot;A1:C150&quot;)</code>. There are a bunch of ways to short cut this as well"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1537985990, "post_id": 52523876, "comment_id": 91987333, "body": "This is a very broad question - have you <a href=\"https://www.google.com/search?q=excel+vba+private+sub+public+sub\" rel=\"nofollow noreferrer\">searched at all?</a>  There are myriad sources explaining the various ways to call a subroutine.  While it&#39;s a totally separate question (and should be asked in a separate question...but do research first please) To look through cells, you need a loop: <code>Dim myRng as Range, cel as Range &#47;&#47; set myRng = Range(&quot;A1:C150&quot;) &#47;&#47; for each cel in myRng &#47;&#47; &#39; do whatever with cel &#47;&#47; next cel</code>"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1537987174, "post_id": 52523876, "comment_id": 91987947, "body": "<code>Sub</code> denotes an executable procedure that defines a scope. If no access modifier is specified, your procedure is implicitly <code>Public</code>. Best make it an early habit to be explicit about such things, and always do <code>Public Sub</code>. Use the <code>Private</code> modifier when the procedure only needs to be visible (/invoked from) the module it&#39;s written in - that&#39;s useful for breaking down your script into small, named steps that the caller doesn&#39;t need to care about, i.e. <code>Public Sub DoTheThing()</code> might be calling <code>Private Sub DoStepOne()</code> and <code>DoStepTwo()</code>. Use descriptive names starting with a verb!"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1537987389, "post_id": 52523876, "comment_id": 91988053, "body": "You &quot;start&quot; a procedure by attaching it to a shape in some worksheet (&quot;assign macro...&quot;), or by invoking it from an <i>event handler</i> procedure, by name - e.g. <code>DoSomething</code> invokes procedure <code>DoSomething</code>. With parameters, <code>DoSomething &quot;abc&quot;, 42</code> passes string literal value <code>&quot;abc&quot;</code> to the first parameter, and integer literal value <code>42</code> to the second parameter. The signature for <code>DoSomething</code> in that case might look like <code>Public Sub DoSomething(ByVal thing As String, ByVal foo As Long)</code>."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1537987430, "post_id": 52523876, "comment_id": 91988066, "body": "That said, an entire <i>book</i> could be written to properly answer everything you&#39;re asking for - that&#39;s slightly too broad to be a good fit for this site, unfortunately."}, {"owner": {"reputation": 25, "user_id": 10416060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67e0d06787f8d0a6046876165c089f21?s=128&d=identicon&r=PG&f=1", "display_name": "Ranger9", "link": "https://stackoverflow.com/users/10416060/ranger9"}, "reply_to_user": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 1, "creation_date": 1537989611, "post_id": 52523876, "comment_id": 91989100, "body": "@urdearboy Thank you for the responses, they did help. Ill do a bit more research before asking questions like this is in the future. This is my second day on this site, and i&#39;m attempting to teach myself VBA - ill be sure to be more specific in my questions for the future."}, {"owner": {"reputation": 25, "user_id": 10416060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67e0d06787f8d0a6046876165c089f21?s=128&d=identicon&r=PG&f=1", "display_name": "Ranger9", "link": "https://stackoverflow.com/users/10416060/ranger9"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1537989678, "post_id": 52523876, "comment_id": 91989132, "body": "@brucewayne same as above"}, {"owner": {"reputation": 25, "user_id": 10416060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67e0d06787f8d0a6046876165c089f21?s=128&d=identicon&r=PG&f=1", "display_name": "Ranger9", "link": "https://stackoverflow.com/users/10416060/ranger9"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1537989693, "post_id": 52523876, "comment_id": 91989143, "body": "@MathieuGuindon same as above"}], "answers": [{"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 1, "last_activity_date": 1537986098, "creation_date": 1537986098, "answer_id": 52523974, "question_id": 52523876, "link": "https://stackoverflow.com/questions/52523876/excel-vba-starting-a-sub/52523974#52523974", "title": "Excel VBA starting a Sub", "body": "<p>Something like this:</p>\n\n<pre><code>Sub RunThis()\n    With Worksheets(\"Sheet1\").Range(\"A1\")\n        .Offset(1, 0).Value = IIf(.Value = \"Title\", \"Hyperlink\", \"\")\n    End With\nEnd Sub \n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 10416060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67e0d06787f8d0a6046876165c089f21?s=128&d=identicon&r=PG&f=1", "display_name": "Ranger9", "link": "https://stackoverflow.com/users/10416060/ranger9"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 103, "favorite_count": 0, "accepted_answer_id": 52523974, "answer_count": 1, "score": 0, "last_activity_date": 1537986098, "creation_date": 1537985680, "question_id": 52523876, "link": "https://stackoverflow.com/questions/52523876/excel-vba-starting-a-sub", "title": "Excel VBA starting a Sub", "body": "<p>How would I start the below code? </p>\n\n<pre><code>Worksheets(\"Sheet1\").Activate \n    'Can't select unless the sheet is active \nDim Title As Integer, result As String \ntitleDetail = Range(\"A1\").Value \nIf titleDetail = \"Title\" Then result = \"Hyperlink\" \nSelection.Offset(1, 0).Range(\"A1\").Value = result   \n</code></pre>\n\n<p>Any script always has to begin with either Private Sub, Public Sub, etc. correct? How do I determine which to use? </p>\n\n<p>Secondly, when I declare my range (titleDetail = Range(\"A1\").Value) right now its only going to look in cell A1 correct? What would be the proper syntax to look through any cells from A1:C150? </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "edited": false, "score": 0, "creation_date": 1537986225, "post_id": 52523719, "comment_id": 91987431, "body": "<code>On Error Resume Next </code> is a sin and not error handling. Learn and use <code>On Error goto</code>"}, {"owner": {"reputation": 3, "user_id": 8692462, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17c2e1201f9b75ece3f06dcbbc5e7ba3?s=128&d=identicon&r=PG&f=1", "display_name": "John", "link": "https://stackoverflow.com/users/8692462/john"}, "reply_to_user": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "edited": false, "score": 0, "creation_date": 1537986520, "post_id": 52523719, "comment_id": 91987600, "body": "Not sure if I understand what you are commented. On error Resume Next is one of error handling technique in VBA. Please click on the following link and learn more. <a href=\"https://docs.microsoft.com/en-us/dotnet/visual-basic/language-reference/statements/on-error-statement\" rel=\"nofollow noreferrer\">docs.microsoft.com/en-us/dotnet/visual-basic/language-refere&zwnj;&#8203;nce/&hellip;</a>"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1537986820, "post_id": 52523719, "comment_id": 91987752, "body": "@John that&#39;s not a VBA link, but VB.Net - <a href=\"https://docs.microsoft.com/en-us/office/vba/language/reference/user-interface-help/on-error-statement\" rel=\"nofollow noreferrer\">here</a> is the link you were looking for. <code>On Error Resume Next</code> &quot;allows execution to continue despite a run-time error&quot; - which is why in most cases it&#39;s advised against. It&#39;s not immediately clear why you need it in this case."}, {"owner": {"reputation": 3, "user_id": 8692462, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17c2e1201f9b75ece3f06dcbbc5e7ba3?s=128&d=identicon&r=PG&f=1", "display_name": "John", "link": "https://stackoverflow.com/users/8692462/john"}, "edited": false, "score": 0, "creation_date": 1537987195, "post_id": 52523719, "comment_id": 91987960, "body": "Okay, Go through it. It has all error handling techniques for VBA."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 8692462, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17c2e1201f9b75ece3f06dcbbc5e7ba3?s=128&d=identicon&r=PG&f=1", "display_name": "John", "link": "https://stackoverflow.com/users/8692462/john"}, "edited": false, "score": 0, "creation_date": 1538071752, "post_id": 52524041, "comment_id": 92025468, "body": "Why do you count the number of records ? Failed to understand it. But thank you for your response."}, {"owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "reply_to_user": {"reputation": 3, "user_id": 8692462, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17c2e1201f9b75ece3f06dcbbc5e7ba3?s=128&d=identicon&r=PG&f=1", "display_name": "John", "link": "https://stackoverflow.com/users/8692462/john"}, "edited": false, "score": 0, "creation_date": 1538072372, "post_id": 52524041, "comment_id": 92025750, "body": "Counting the cells takes care of the error trapping, if there are no cells, then c =0 but if c&lt;&gt;0 then you can move forward and copy the cells."}, {"owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "reply_to_user": {"reputation": 3, "user_id": 8692462, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17c2e1201f9b75ece3f06dcbbc5e7ba3?s=128&d=identicon&r=PG&f=1", "display_name": "John", "link": "https://stackoverflow.com/users/8692462/john"}, "edited": false, "score": 0, "creation_date": 1538072768, "post_id": 52524041, "comment_id": 92025910, "body": "So for your example, if c=0 then you can activate sheet 3 or else do all that other stuff"}, {"owner": {"reputation": 3, "user_id": 8692462, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17c2e1201f9b75ece3f06dcbbc5e7ba3?s=128&d=identicon&r=PG&f=1", "display_name": "John", "link": "https://stackoverflow.com/users/8692462/john"}, "edited": false, "score": 0, "creation_date": 1538074140, "post_id": 52524041, "comment_id": 92026523, "body": "Not yet working.On Error Resume Next     Dim c As Long     c = Sheets(&quot;Sheet1&quot;).Range(&quot;A3:K16000&quot;).SpecialCells(xlCellTypeC&zwnj;&#8203;onstants).Count     If c = 0 Then     Sheets(&quot;Sheet3&quot;).Activate    Else     Sheets(&quot;Sheet1&quot;).Range(&quot;A1:K2&quot;).Copy Sheets(&quot;Sheet2&quot;).Range(&quot;A1&quot;)     Sheets(&quot;Sheet1&quot;).Range(&quot;A3:K16000&quot;).SpecialCells(xlCellTypeC&zwnj;&#8203;onstants).Copy Sheets(&quot;Sheet1&quot;).Range(&quot;A3&quot;)     Sheets(&quot;Sheet1&quot;).Activate     Sheets(&quot;Sheet2&quot;).Range(&quot;A3:T3&quot;).Delete     End If"}, {"owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "reply_to_user": {"reputation": 3, "user_id": 8692462, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17c2e1201f9b75ece3f06dcbbc5e7ba3?s=128&d=identicon&r=PG&f=1", "display_name": "John", "link": "https://stackoverflow.com/users/8692462/john"}, "edited": false, "score": 0, "creation_date": 1538137478, "post_id": 52524041, "comment_id": 92049102, "body": "I ran your code and it works, if the range is blank it activates sheet 3, if the c&gt;0 then it performs the other lines of code. Can you clarify &quot;Not yet working&quot;?"}, {"owner": {"reputation": 3, "user_id": 8692462, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17c2e1201f9b75ece3f06dcbbc5e7ba3?s=128&d=identicon&r=PG&f=1", "display_name": "John", "link": "https://stackoverflow.com/users/8692462/john"}, "edited": false, "score": 0, "creation_date": 1539089268, "post_id": 52524041, "comment_id": 92367978, "body": "I keep getting the error &#39;ERROR This Action won&#39;t work on multiple selections&#39;"}, {"owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "reply_to_user": {"reputation": 3, "user_id": 8692462, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17c2e1201f9b75ece3f06dcbbc5e7ba3?s=128&d=identicon&r=PG&f=1", "display_name": "John", "link": "https://stackoverflow.com/users/8692462/john"}, "edited": false, "score": 0, "creation_date": 1539091237, "post_id": 52524041, "comment_id": 92369400, "body": "You can&#39;t use multiple selections, you can just copy the entire range. <code>Sheets(&quot;Sheet1&quot;).Range(&quot;A3:K16000&quot;).Copy Sheets(&quot;Sheet2&quot;).Range(&quot;A3&quot;)</code>"}, {"owner": {"reputation": 3, "user_id": 8692462, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17c2e1201f9b75ece3f06dcbbc5e7ba3?s=128&d=identicon&r=PG&f=1", "display_name": "John", "link": "https://stackoverflow.com/users/8692462/john"}, "edited": false, "score": 0, "creation_date": 1539091618, "post_id": 52524041, "comment_id": 92369681, "body": "Thanks much. Truly appreciated."}], "tags": [], "owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "is_accepted": true, "score": 0, "last_activity_date": 1537986446, "creation_date": 1537986446, "answer_id": 52524041, "question_id": 52523719, "link": "https://stackoverflow.com/questions/52523719/special-cells-in-excel-to-copy-from-sheet1-to-sheet2-with-error-handling/52524041#52524041", "title": "Special Cells in Excel to Copy from sheet1 to sheet2 with error handling", "body": "<p>If you do an error check first to see if you have any results then you can move forwards. for example.</p>\n\n<pre><code>Sub Button1_Click()\n    Dim c As Long\n    On Error Resume Next\n    c = Sheets(\"Sheet1\").Range(\"A3:K16000\").SpecialCells(xlCellTypeConstants).Count\n    If c = 0 Then\n        MsgBox \"No Cells found -do something!\"\n    Else\n        MsgBox c &amp; \" Blank Cells found- do something else!!\"\n    End If\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 8692462, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17c2e1201f9b75ece3f06dcbbc5e7ba3?s=128&d=identicon&r=PG&f=1", "display_name": "John", "link": "https://stackoverflow.com/users/8692462/john"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 53, "favorite_count": 0, "accepted_answer_id": 52524041, "answer_count": 1, "score": -1, "last_activity_date": 1537986446, "creation_date": 1537985010, "last_edit_date": 1537985086, "question_id": 52523719, "link": "https://stackoverflow.com/questions/52523719/special-cells-in-excel-to-copy-from-sheet1-to-sheet2-with-error-handling", "title": "Special Cells in Excel to Copy from sheet1 to sheet2 with error handling", "body": "<p>I'm trying to Copy Sheet1 data to sheet2. I did handle 1004 error. If there is error, I want to open Sheet3  else copy data from sheet1 to sheet2. Please see my code. Truly appreciated for any help in advance.</p>\n\n<pre><code>Sub cmdButtonData_Click()\n\nDim SellStartDate As Date  \nDim SellEndDate As Date   \n\nSellStartDate = Sheets(\"Launch\").Range(\"H10\").Value   \nSellEndDate = Sheets(\"Launch\").Range(\"H11\").Value  \nSheets(\"Sheet2\").Cells.Clear\n\nOn Error Resume Next  \n'I have the connection string here.\nIf Err.Number &lt;&gt; 0 Then\n    Sheets(\"Sheet3\").Activate\nElse\n    'Copy the data\n    Sheets(\"Sheet1\").Range(\"A1:K2\").Copy Sheets(\"Sheet2\").Range(\"A1\")\n    Sheets(\"Sheet1\").Range(\"A3:K16000\").SpecialCells(xlCellTypeConstants).Copy \n    Sheets(\"Sheet2\").Range(\"A3\")\n    Sheets(\"Sheet1\").Activate\n    Sheets(\"Sheet2\").Range(\"A3:T3\").Delete\nEnd If\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["ms-access", "vba", "ms-access-2016"], "answers": [{"tags": [], "owner": {"reputation": 3725, "user_id": 6777839, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YYN3g.jpg?s=128&g=1", "display_name": "Wolfgang Kais", "link": "https://stackoverflow.com/users/6777839/wolfgang-kais"}, "is_accepted": true, "score": 2, "last_activity_date": 1538010544, "last_edit_date": 1538010544, "creation_date": 1538005241, "answer_id": 52527429, "question_id": 52523366, "link": "https://stackoverflow.com/questions/52523366/writing-a-function-to-update-labels-onclick-access-vba/52527429#52527429", "title": "Writing a function to update labels OnClick Access VBA", "body": "<p>You could use toggle buttons, they can even have an associated label that, when clicked, toggles the button. You could use a white X as the caption for all the toggle buttons, let the them appear with white forecolors (so you won't see the white X) and dark green color when pressed. Just play with the colors until they fit. This way, you won't need any code to toggle the color or caption.</p>\n\n<p>As an example, I used</p>\n\n<ul>\n<li>Caption: X</li>\n<li>BackColor: #FFFFFF</li>\n<li>BorderStyle: Solid</li>\n<li>BorderWidth: Hairline</li>\n<li>BorderColor: #000000</li>\n<li>HoverColor: #008000</li>\n<li>PressedColor: #008000</li>\n<li>HoverForeColor: #008000</li>\n<li>PressedForeColor: #FFFFFF</li>\n<li>TextColor: #FFFFFF</li>\n</ul>\n\n<p>Screenshot:</p>\n\n<p><a href=\"https://i.stack.imgur.com/S2OdA.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/S2OdA.jpg\" alt=\"Example\"></a></p>\n"}, {"tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": false, "score": 1, "last_activity_date": 1538048930, "creation_date": 1538048930, "answer_id": 52536326, "question_id": 52523366, "link": "https://stackoverflow.com/questions/52523366/writing-a-function-to-update-labels-onclick-access-vba/52536326#52536326", "title": "Writing a function to update labels OnClick Access VBA", "body": "<blockquote>\n  <p>I want to know if there is a way I can create a more generic function\n  that I can reuse on each OnClick event instead of pasting the same\n  code with minor alterations 36 times.</p>\n</blockquote>\n\n<p>That is exactly what <strong>WithEvents</strong> is for.</p>\n\n<p>I had a form with 60 controls, and wrote an article on how to do this:</p>\n\n<p><a href=\"https://www.experts-exchange.com/articles/29554/Create-Windows-Phone-Colour-Palette-and-Selector-using-WithEvents.html\" rel=\"nofollow noreferrer\">Create Windows Phone Colour Palette and Selector using WithEvents</a></p>\n\n<p>The core is this simple class:</p>\n\n<pre><code>Option Explicit\n\n' Helper class for form Palette for event handling of textboxes.\n' 2017-04-19. Gustav Brock, Cactus Data ApS, CPH.\n' Version 1.0.0\n' License: MIT.\n\n' *\n\nPrivate Const EventProcedure    As String = \"[Event Procedure]\"\n\nPrivate WithEvents ClassTextBox As Access.TextBox\n\n\nPublic Sub Initialize(ByRef TextBox As Access.TextBox)\n\n    Set ClassTextBox = TextBox\n\n    ClassTextBox.OnClick = EventProcedure\n\nEnd Sub\n\n\nPublic Sub Terminate()\n\n    Set ClassTextBox = Nothing\n\nEnd Sub\n\n\nPrivate Sub ClassTextBox_Click()\n\n    ' Select full content.\n    ClassTextBox.SelStart = 0\n    ClassTextBox.SelLength = Len(ClassTextBox.Value)\n    ' Display the clicked value.\n    ClassTextBox.Parent!CopyClicked.Value = ClassTextBox.Value\n    ' Copy the clicked value to the clipboard.\n    DoCmd.RunCommand acCmdCopy\n\nEnd Sub\n</code></pre>\n\n<p>And the required code in the form is only:</p>\n\n<pre><code>Option Explicit\n\n' Form to display the Windows Phone 7.5/8.0 colour theme.\n' Also works as a basic example of implementing WithEvents for a form.\n' 2017-04-19. Gustav Brock, Cactus Data ApS, CPH.\n' Version 1.0.0\n' License: MIT.\n\n' *\n\nPrivate ControlCollection   As Collection\n\n\nPrivate Sub Form_Load()\n\n    ' Load events for all colour value textboxes.\n\n    Dim EventProcedure  As ClassTextboxSelect\n    Dim Control         As Access.Control\n\n    Set ControlCollection = New Collection\n\n    For Each Control In Me.Controls\n        If Control.ControlType = acTextBox Then\n            Set EventProcedure = New ClassTextboxSelect\n            EventProcedure.Initialize Control\n            ControlCollection.Add EventProcedure, Control.Name\n        End If\n    Next\n\n    Set EventProcedure = Nothing\n    Set Control = Nothing\n\nEnd Sub\n\n\nPrivate Sub Form_Unload(Cancel As Integer)\n\n    ' Unload events for all colour value textboxes.\n\n    Dim EventProcedure  As ClassTextboxSelect\n\n    For Each EventProcedure In ControlCollection\n        EventProcedure.Terminate\n    Next\n\n    Set EventProcedure = Nothing\n    Set ControlCollection = Nothing\n\nEnd Sub\n</code></pre>\n\n<p>Full code is also on <strong>GitHub</strong>: <a href=\"https://github.com/GustavBrock/VBA.ModernTheme\" rel=\"nofollow noreferrer\">VBA.ModernTheme</a></p>\n"}], "owner": {"reputation": 23, "user_id": 10264984, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-tK0fFyaY7rU/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaMZofCZVCfehn_bVvwyfq7yo_Vusw/mo/photo.jpg?sz=128", "display_name": "Eric Hutchins", "link": "https://stackoverflow.com/users/10264984/eric-hutchins"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 679, "favorite_count": 0, "accepted_answer_id": 52527429, "answer_count": 2, "score": 0, "last_activity_date": 1538048930, "creation_date": 1537983585, "last_edit_date": 1537989243, "question_id": 52523366, "link": "https://stackoverflow.com/questions/52523366/writing-a-function-to-update-labels-onclick-access-vba", "title": "Writing a function to update labels OnClick Access VBA", "body": "<p>I'm creating a form that allows the user to select any number of Sigs so I can autopopulate a recordset with values.  I recreated an option group of check boxes because management/supervisors have said the default check boxes are too small.  </p>\n\n<p><a href=\"https://i.stack.imgur.com/xj47w.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/xj47w.png\" alt=\"My Sig Form\"></a>I have this code, which works, but I want to know if there is a way I can create a more generic function that I can reuse on each OnClick event instead of pasting the same code with minor alterations 36 times.</p>\n\n<pre><code>Private Sub lblChkSig1_Click()\n    mblnArray(0) = Not (mblnArray(0))\n    If mblnArray(0) Then\n        lblChkSig1.Caption = Chr(80)    'check mark\n        lblChkSig1.BackColor = RGB(0, 128, 0)     'Dark Green\n    Else\n        lblChkSig1.Caption = \"\"\n        lblChkSig1.BackColor = RGB(255, 255, 255)    'White\n    End If\nEnd Sub\n</code></pre>\n\n<p>The array <code>mblnArray</code> is just an array of 36 boolean values that I use to so I can iterate through them all quickly.  I have done this before, but only with as many as 4 values where redoing all the code wasn't an issue.  Now that I have a larger set of options, I decided I'd like to change it to make it reusable.  </p>\n\n<p>I came up with this function as a replacement, but I can't figure out how to dynamically change which label is updated.</p>\n\n<pre><code>Private Sub UpdateChecks(iPos As Integer)\n    Dim ctlCurrentControl as Label\n    Set cltCurrentControl = Me.ActiveControl\n\n    mblnArray(iPos) = Not (mblnArray(iPos))\n    If mblnArray(iPos) Then\n        ctlCurrentControl.Caption = Chr(80)    'check mark\n        ctlCurrentControl.BackColor = RGB(0, 128, 0)     'Green\n    Else\n        ctlCurrentControl.Caption = \"\"\n        ctlCurrentControl.BackColor = RGB(255, 255, 255)    'White\n    End If\n\nEnd Sub\n</code></pre>\n\n<p>I found out while looking for solutions that labels can't be the form's Active Control.  I also tried</p>\n\n<pre><code>Dim ctlCurrentControl as Label\nSet ctlCurrentControl = \"lblChkSig\" &amp; iPos\n</code></pre>\n\n<p>but that did not work either.  I don't know where to proceed from here.  I am not certain this can even be done, but it would be very helpful if there is a solution.</p>\n"}, {"tags": ["ms-access", "vba", "ms-access-2013"], "comments": [{"owner": {"reputation": 143, "user_id": 7480185, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh3.googleusercontent.com/-gurNcdV0CkQ/AAAAAAAAAAI/AAAAAAAAHWA/StXs4OsnKC8/photo.jpg?sz=128", "display_name": "Robert Loughrey", "link": "https://stackoverflow.com/users/7480185/robert-loughrey"}, "reply_to_user": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1537983719, "post_id": 52523177, "comment_id": 91986317, "body": "I have lots of forms and queries and I dont want to have a  frmQASingleView for every type of query I want to see. Maybe I should see if there is a way in VBA to set the forms recordsource property as I open the form?"}, {"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 1, "creation_date": 1537984418, "post_id": 52523177, "comment_id": 91986608, "body": "So then maybe you want to do <code>Forms!frmQASingleView.RecordSource = &quot;something&quot;</code>, is that right?"}, {"owner": {"reputation": 143, "user_id": 7480185, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh3.googleusercontent.com/-gurNcdV0CkQ/AAAAAAAAAAI/AAAAAAAAHWA/StXs4OsnKC8/photo.jpg?sz=128", "display_name": "Robert Loughrey", "link": "https://stackoverflow.com/users/7480185/robert-loughrey"}, "reply_to_user": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1537985370, "post_id": 52523177, "comment_id": 91987054, "body": "That worked! I changed the code to DoCmd.OpenForm &quot;frmQASingleView&quot; Forms!frmQASingleView.RecordSource = &quot;qQATeam&quot; and that worked very well. If you move that into an answer I&#39;ll give you the credit, and thank you very much!"}], "answers": [{"tags": [], "owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "is_accepted": true, "score": 1, "last_activity_date": 1537986748, "last_edit_date": 1537986748, "creation_date": 1537986344, "answer_id": 52524021, "question_id": 52523177, "link": "https://stackoverflow.com/questions/52523177/vba-docmd-open-form-on-a-group-of-records/52524021#52524021", "title": "VBA DoCmd.Open form on a group of records", "body": "<p>You can alter the <code>RecordSource</code> for <code>frmQASingleView</code> at runtime.  So if you change it to use the same query, <code>qQATeam</code>, as the first form, it has to display the same 6 rows.  :-)</p>\n\n<p>Suggest you first open the form empty and hidden.</p>\n\n\n\n<pre class=\"lang-vba prettyprint-override\"><code>DoCmd.OpenForm FormName:=\"frmQASingleView\", View:=acNormal, WhereCondition:=\"1=2\", WindowMode:=acHidden\n</code></pre>\n\n<p>Then change its <code>RecordSource</code> and unhide it.</p>\n\n<pre class=\"lang-vba prettyprint-override\"><code>Forms!frmQASingleView.RecordSource = \"qQATeam\"\nDoCmd.OpenForm FormName:=\"frmQASingleView\" View:=acNormal, WindowMode:=acWindowNormal\n</code></pre>\n"}], "owner": {"reputation": 143, "user_id": 7480185, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh3.googleusercontent.com/-gurNcdV0CkQ/AAAAAAAAAAI/AAAAAAAAHWA/StXs4OsnKC8/photo.jpg?sz=128", "display_name": "Robert Loughrey", "link": "https://stackoverflow.com/users/7480185/robert-loughrey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 453, "favorite_count": 0, "accepted_answer_id": 52524021, "answer_count": 1, "score": 1, "last_activity_date": 1537986748, "creation_date": 1537982727, "last_edit_date": 1537986440, "question_id": 52523177, "link": "https://stackoverflow.com/questions/52523177/vba-docmd-open-form-on-a-group-of-records", "title": "VBA DoCmd.Open form on a group of records", "body": "<p>I have a form (frmQATeam) that summarizes records based on a query. (qQATeam) It only shows some of the smaller fields so I want to have a button that takes me to a full screen view of the complete record(frmQASingleView) including the memo fields and other larger format items. I want to see every record that appears on the summary form, not just one. On this button I am using VBA to pull the full view form up. I have tried a: </p>\n\n<p>WHERE method: <code>DoCmd.OpenForm \"frmQASingleView\", , ,\"Id = \" Me.ID</code> but that provides only the selected record, and not all 6 that are showing in frmQAteam.</p>\n\n<p>FilterName Method: <code>DoCmd.OpenForm \"QASingleView\", , \"qQATeamViewAll\"</code> but this method returns all records in the table. </p>\n\n<p>And a method I saw suggested elsewhere on the net (yes its in navigation subforms)</p>\n\n<p><code>Dim rs As Object\nDim lngBookmark As Long\nlngBookmark = Me.ID\nDoCmd.OpenForm \"frmQASingleView\"\nSet rs = Forms!MainMenu.Form!btnManagersMenu.Form!NavigationSubform.Form.RecordsetClone\nrs.FindFirst \"ID = \" &amp; lngBookmark</code></p>\n\n<p>But this method also returns all records in the Table.</p>\n\n<p>My final attempt was to set up a macro even though people have warned me against them to use the OpenForm setting and set the filter based on the query. In this case I discovered that you cannot use a macro to filter a query that is based on two or more tables with a relationship. </p>\n\n<p>I'm at my wits end and I'm hoping someone can help. </p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 61, "user_id": 10067065, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Dajq8eHXsZo/AAAAAAAAAAI/AAAAAAAAAC8/HyFBv438kmo/photo.jpg?sz=128", "display_name": "Mike P.", "link": "https://stackoverflow.com/users/10067065/mike-p"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1537982780, "post_id": 52523146, "comment_id": 91985874, "body": "I added a backslash on the end of foldername and no dice"}, {"owner": {"reputation": 61, "user_id": 10067065, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Dajq8eHXsZo/AAAAAAAAAAI/AAAAAAAAAC8/HyFBv438kmo/photo.jpg?sz=128", "display_name": "Mike P.", "link": "https://stackoverflow.com/users/10067065/mike-p"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1537982964, "post_id": 52523146, "comment_id": 91985967, "body": "folderName = &quot;C:\\mp180423\\Desktop\\CSVtoEXCEL\\&quot; I changed the code to include the backslash but it didn&#39;t change anything"}, {"owner": {"reputation": 61, "user_id": 10067065, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Dajq8eHXsZo/AAAAAAAAAAI/AAAAAAAAAC8/HyFBv438kmo/photo.jpg?sz=128", "display_name": "Mike P.", "link": "https://stackoverflow.com/users/10067065/mike-p"}, "edited": false, "score": 0, "creation_date": 1537983599, "post_id": 52523146, "comment_id": 91986262, "body": "I was able to figure it out, the foldername needed an extra backslash in the front."}, {"owner": {"reputation": 951, "user_id": 4207055, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LYMqh.png?s=128&g=1", "display_name": "Guy Louzon", "link": "https://stackoverflow.com/users/4207055/guy-louzon"}, "edited": false, "score": 0, "creation_date": 1537983824, "post_id": 52523146, "comment_id": 91986357, "body": "did you try running step by step (F8)? do that and put your mouse over variables, its a simple way to debug your code and you can isolate the problem quickly"}, {"owner": {"reputation": 951, "user_id": 4207055, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LYMqh.png?s=128&g=1", "display_name": "Guy Louzon", "link": "https://stackoverflow.com/users/4207055/guy-louzon"}, "edited": false, "score": 0, "creation_date": 1537983926, "post_id": 52523146, "comment_id": 91986389, "body": "Im asking because once you isolate the problem your question can be answered... (your workfile array might be empty, the while condition wrong etc...)"}, {"owner": {"reputation": 61, "user_id": 10067065, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Dajq8eHXsZo/AAAAAAAAAAI/AAAAAAAAAC8/HyFBv438kmo/photo.jpg?sz=128", "display_name": "Mike P.", "link": "https://stackoverflow.com/users/10067065/mike-p"}, "reply_to_user": {"reputation": 951, "user_id": 4207055, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LYMqh.png?s=128&g=1", "display_name": "Guy Louzon", "link": "https://stackoverflow.com/users/4207055/guy-louzon"}, "edited": false, "score": 0, "creation_date": 1537984093, "post_id": 52523146, "comment_id": 91986470, "body": "I did use F8 to walk through but I wasn&#39;t getting any error message that the folderName wasn&#39;t reading correctly, so it was difficult to determine what was wrong"}, {"owner": {"reputation": 61, "user_id": 10067065, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Dajq8eHXsZo/AAAAAAAAAAI/AAAAAAAAAC8/HyFBv438kmo/photo.jpg?sz=128", "display_name": "Mike P.", "link": "https://stackoverflow.com/users/10067065/mike-p"}, "reply_to_user": {"reputation": 951, "user_id": 4207055, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LYMqh.png?s=128&g=1", "display_name": "Guy Louzon", "link": "https://stackoverflow.com/users/4207055/guy-louzon"}, "edited": false, "score": 0, "creation_date": 1537984133, "post_id": 52523146, "comment_id": 91986489, "body": "but the code works, just the file name needed to be updated to the correct location"}, {"owner": {"reputation": 951, "user_id": 4207055, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LYMqh.png?s=128&g=1", "display_name": "Guy Louzon", "link": "https://stackoverflow.com/users/4207055/guy-louzon"}, "edited": false, "score": 0, "creation_date": 1537984768, "post_id": 52523146, "comment_id": 91986764, "body": "in each step, look at variables values, and see that each line of did what you expect it to do, not something else"}, {"owner": {"reputation": 61, "user_id": 10067065, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Dajq8eHXsZo/AAAAAAAAAAI/AAAAAAAAAC8/HyFBv438kmo/photo.jpg?sz=128", "display_name": "Mike P.", "link": "https://stackoverflow.com/users/10067065/mike-p"}, "reply_to_user": {"reputation": 951, "user_id": 4207055, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LYMqh.png?s=128&g=1", "display_name": "Guy Louzon", "link": "https://stackoverflow.com/users/4207055/guy-louzon"}, "edited": false, "score": 0, "creation_date": 1537985378, "post_id": 52523146, "comment_id": 91987059, "body": "thanks for the tip @Guy L"}, {"owner": {"reputation": 951, "user_id": 4207055, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LYMqh.png?s=128&g=1", "display_name": "Guy Louzon", "link": "https://stackoverflow.com/users/4207055/guy-louzon"}, "edited": false, "score": 0, "creation_date": 1537985462, "post_id": 52523146, "comment_id": 91987088, "body": "sure. hope it helps"}], "answers": [{"comments": [{"owner": {"reputation": 1562, "user_id": 4535386, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/vRFmJ.jpg?s=128&g=1", "display_name": "YesItsMe", "link": "https://stackoverflow.com/users/4535386/yesitsme"}, "edited": false, "score": 0, "creation_date": 1609431830, "post_id": 52619462, "comment_id": 115843209, "body": "you can change   it to  &quot;.xlsx&quot;, FileFormat _         :=51, if you want to save it as xlsx"}], "tags": [], "owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "is_accepted": false, "score": 1, "last_activity_date": 1538538793, "creation_date": 1538538793, "answer_id": 52619462, "question_id": 52523146, "link": "https://stackoverflow.com/questions/52523146/fast-way-to-batch-convert-multiple-csv-files-into-excel-files/52619462#52619462", "title": "fast way to batch convert multiple csv files into excel files", "body": "<p>This will do what you want!</p>\n\n<pre><code>Sub CSVtoXLSB2()\nDim wb As Workbook\nDim CSVPath As String\nDim sProcessFile As String\n\nCSVPath = \"C:\\your_path_here\\\"\nsProcessFile = Dir(CSVPath &amp; \"*.csv\")\nDo Until sProcessFile = \"\"   ' Loop until no file found.\n    Set wb = Application.Workbooks.Open(CSVPath &amp; sProcessFile)\n    wb.SaveAs CSVPath &amp; Split(wb.Name, \".\")(0) &amp; \".xlsb\", FileFormat _\n        :=50, Password:=\"\", WriteResPassword:=\"\", ReadOnlyRecommended:=False, _\n        CreateBackup:=False\n    wb.Close\n    sProcessFile = Dir()   ' Get next entry.\nLoop\nSet wb = Nothing\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 61, "user_id": 10067065, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Dajq8eHXsZo/AAAAAAAAAAI/AAAAAAAAAC8/HyFBv438kmo/photo.jpg?sz=128", "display_name": "Mike P.", "link": "https://stackoverflow.com/users/10067065/mike-p"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2399, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1594024665, "creation_date": 1537982613, "last_edit_date": 1594024665, "question_id": 52523146, "link": "https://stackoverflow.com/questions/52523146/fast-way-to-batch-convert-multiple-csv-files-into-excel-files", "title": "fast way to batch convert multiple csv files into excel files", "body": "<p>I have a folder with .csv type files, that I need to change to .xlsx type file. This is the code I have below and I cannot get the files in my folder to be converted to .xlsx I've run the code and I don't get an error message, the code just isn't converting any csv files to xlsx files. the files in my folder are capitalized CSV files instead of lower case CSV files if that makes a difference. \nAny help is greatly appreciated! </p>\n\n<pre><code>Sub ConvertCSVToXlsx()\n\n    Dim myfile As String\n    Dim oldfname As String, newfname As String\n    Dim workfile\n    Dim folderName As String\n\n    Application.DisplayAlerts = False\n    Application.ScreenUpdating = False\n\n'   Capture name of current file\n    myfile = ActiveWorkbook.Name\n\n'   Set folder name to work through\n    folderName = \"C:\\Users\\m\\Desktop\\CSVtoEXCEL\\\"\n\n'   Loop through all CSV filres in folder\n    workfile = Dir(folderName &amp; \"*.CSV\")\n    Do While workfile &lt;&gt; \"\"\n'       Open CSV file\n        Workbooks.Open Filename:=folderName &amp; workfile\n'       Capture name of old CSV file\n        oldfname = ActiveWorkbook.FullName\n'       Convert to XLSX\n        newfname = folderName &amp; Left(ActiveWorkbook.Name, Len(ActiveWorkbook.Name) - 4) &amp; \".xlsx\"\n        ActiveWorkbook.SaveAs Filename:=newfname, FileFormat:=xlOpenXMLWorkbook, CreateBackup:=False\n        ActiveWorkbook.Close\n'       Delete old CSV file\n        Kill oldfname\n        Windows(myfile).Activate\n        workfile = Dir()\n    Loop\n\n    Application.DisplayAlerts = True\n    Application.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "excel-formula"], "comments": [{"owner": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "edited": false, "score": 0, "creation_date": 1537976904, "post_id": 52521566, "comment_id": 91982886, "body": "Welcome to SO. What do you mean by <i>another way</i>?"}, {"owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 0, "creation_date": 1537978999, "post_id": 52521566, "comment_id": 91984006, "body": "According to how and where from you are calling the macro, there is different possibilities. See <a href=\"https://stackoverflow.com/questions/29858176/how-to-call-a-macro-from-a-button-and-pass-arguments\" title=\"how to call a macro from a button and pass arguments\">stackoverflow.com/questions/29858176/&hellip;</a> and <a href=\"https://support.microsoft.com/en-gb/help/153307/how-to-call-microsoft-excel-macros-that-take-parameters\" rel=\"nofollow noreferrer\">support.microsoft.com/en-gb/help/153307/&hellip;</a> for example"}], "answers": [{"tags": [], "owner": {"reputation": 11547, "user_id": 832052, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/VA1xt.png?s=128&g=1", "display_name": "djv", "link": "https://stackoverflow.com/users/832052/djv"}, "is_accepted": false, "score": -1, "last_activity_date": 1537976470, "creation_date": 1537976470, "answer_id": 52521583, "question_id": 52521566, "link": "https://stackoverflow.com/questions/52521566/vba-sub-with-inputs/52521583#52521583", "title": "VBA sub with inputs", "body": "<p>With a single argument, you don't use parenthesis</p>\n\n<pre><code>do_something 1\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1156, "user_id": 10315836, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hZjRU.png?s=128&g=1", "display_name": "Valon Miller", "link": "https://stackoverflow.com/users/10315836/valon-miller"}, "is_accepted": false, "score": 1, "last_activity_date": 1537977644, "last_edit_date": 1537977644, "creation_date": 1537977222, "answer_id": 52521815, "question_id": 52521566, "link": "https://stackoverflow.com/questions/52521566/vba-sub-with-inputs/52521815#52521815", "title": "VBA sub with inputs", "body": "<p>The code that you provided does not compile. Maybe you were trying to provide a simple example...?</p>\n\n<p>It does not compile because <code>Input</code> is a reserved word, used to read data from a file object. You cannot use it as a variable name. (I have assumed that \"xxxxx\" is indicating where code should go, i.e. <code>'Do something here</code>.)</p>\n\n<p>The following code works, but you cannot run it without passing a value:</p>\n\n<pre><code>Sub do_something(i As Integer)\n    MsgBox i\nEnd Sub\n</code></pre>\n\n<p>If you want to make the variable optional, you can add the <code>Optional</code> keyword. Then it will run even if a value is not passed:</p>\n\n<pre><code>Sub do_something(Optional i As Integer)\n    MsgBox i\nEnd Sub\n</code></pre>\n\n<p>You could also use a globally scoped variable, which would allow the sub to run without directly supplying a value:</p>\n\n<pre><code>Option Explicit\n\nPublic i As Integer\n\nSub do_something()\n    MsgBox i\nEnd Sub\n</code></pre>\n\n<p>Regarding <code>Input</code>: <a href=\"https://docs.microsoft.com/en-us/office/vba/language/reference/user-interface-help/inputstatement\" rel=\"nofollow noreferrer\">https://docs.microsoft.com/en-us/office/vba/language/reference/user-interface-help/inputstatement</a></p>\n"}, {"tags": [], "owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "is_accepted": false, "score": 2, "last_activity_date": 1537977345, "creation_date": 1537977345, "answer_id": 52521853, "question_id": 52521566, "link": "https://stackoverflow.com/questions/52521566/vba-sub-with-inputs/52521853#52521853", "title": "VBA sub with inputs", "body": "<p>Set up your sub something like this:</p>\n\n<pre><code>Sub do_something(param As Integer)\n    MsgBox \"The parameter passed to this Sub is \" &amp; param\nEnd Sub\n</code></pre>\n\n<p>To call it:</p>\n\n<pre><code>do_something 1\n</code></pre>\n\n<hr>\n\n<p>If you want more than one parameter..</p>\n\n<pre><code>Sub do_something(param1 As Integer, param2 As String)\n    MsgBox \"The parameters passed to this Sub is \" &amp; param1 &amp; \" and \" &amp; param2\nEnd Sub\n</code></pre>\n\n<p>To call it:</p>\n\n<pre><code>do_something 4,\"Hello\"\n</code></pre>\n\n<p>Or for a bit or reading chaos:</p>\n\n<pre><code>do_something param2:=\"Hello\", param1:=4\n</code></pre>\n"}], "owner": {"reputation": 195, "user_id": 10414921, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-o7DRr9Yj9iQ/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DUWFKIbOgOHsrqmpkOE5s6UJlvDAA/mo/photo.jpg?sz=128", "display_name": "Garry W", "link": "https://stackoverflow.com/users/10414921/garry-w"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3068, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1594024729, "creation_date": 1537976410, "last_edit_date": 1594024729, "question_id": 52521566, "link": "https://stackoverflow.com/questions/52521566/vba-sub-with-inputs", "title": "VBA sub with inputs", "body": "<p>How do I feed parameters into a sub? When I run a Macro, the sub just runs without asking for any input. </p>\n\n<pre><code>Sub do_something(input as integer)\n    xxxxxx\nend sub\n</code></pre>\n\n<p>I know I can use the sub in another sub/function where I can give it a input. Like the following,</p>\n\n<pre><code>sub caller_function()\n    call do_something(1)\nend sub\n</code></pre>\n\n<p>Is there another way to use do_something?\nThanks in advance!</p>\n"}, {"tags": ["excel", "vba", "outlook"], "answers": [{"tags": [], "owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "is_accepted": false, "score": 0, "last_activity_date": 1545855850, "creation_date": 1545855850, "answer_id": 53936771, "question_id": 52521549, "link": "https://stackoverflow.com/questions/52521549/extracting-contact-information-from-outlook-address-book-with-advanced-find/53936771#53936771", "title": "Extracting Contact Information From Outlook Address book with Advanced Find", "body": "<p>Outlook won't let you access ambiguous names. A name either uniquely resolves, or it fails for whatever other reason (not found or ambiguous).</p>\n"}], "owner": {"reputation": 343, "user_id": 9626171, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9587856742de2015aec848c7749c4b15?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan", "link": "https://stackoverflow.com/users/9626171/jordan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 556, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1592700826, "creation_date": 1537976330, "last_edit_date": 1592700826, "question_id": 52521549, "link": "https://stackoverflow.com/questions/52521549/extracting-contact-information-from-outlook-address-book-with-advanced-find", "title": "Extracting Contact Information From Outlook Address book with Advanced Find", "body": "<p>I use this code to extract information from a list of names from my global contacts list.</p>\n\n<p>There are often duplicate names and the code then cannot decide who is the correct contact so it skips them. I am trying to narrow the results down to only use names from my site and if the contact is not from that site (meaning they should not appear in search), to skip it and return offsite to their row. </p>\n\n<p>I want to do this using the advanced find function of the Outlook address book where I can put in a first name, last name, and city. Is there a way I could modify the code to use advanced find instead of a general find?</p>\n\n<pre><code>Sub GetOutlookInfo()\n\nDim I As Integer\nDim ToAddr As String\nDim ActivePersonVerified As Boolean\nDim ol As Outlook.Application\nDim DummyEMail As MailItem\nDim ActivePersonRecipient As Recipient\nDim oAE As Outlook.AddressEntry\nDim oExUser As Outlook.ExchangeUser\nDim oPA As Outlook.PropertyAccessor\nDim AliasRange As Range\nDim RowsInRange As Integer\n\n'Instantiate Outlook\nSet ol = CreateObject(\"Outlook.Application\")\n\n'E-mail aliases are in a named range \"aliasrange\"\n'Assign the named range to a range object\nSet AliasRange = Range(\"A1:A1000\")\n\n'Create a dummy e-mail to add aliases to\nSet DummyEMail = ol.CreateItem(olMailItem)\nRowsInRange = AliasRange.Rows.Count\n\n'Loop through the aliases to retrieve the Exchange data\nFor I = 3 To RowsInRange\n\n    'Assign the current alias to a variable ToAddr\n    ToAddr = AliasRange.Cells(I, 1)\n\n    'Exit loop\n    If ToAddr = \"\" Then\n        Exit For\n    End If\n\n    'Use the alias to create a recipient object and add it to the dummy e-mail\n    Set ActivePersonRecipient = DummyEMail.Recipients.Add(ToAddr)\n    ActivePersonRecipient.Type = olTo\n\n   'Resolve the recipient to ensure it is valid\n    ActivePersonVerified = ActivePersonRecipient.Resolve\n\n    'If valid, use the  AddressEntry property of the recipient to return an AddressEntry object\n\n    If ActivePersonVerified Then\n        Set oAE = ActivePersonRecipient.AddressEntry\n\n        'Use the GetExchangeUser method of the AddressEntry object to retrieve the ExchangeUser object for the recipient.\n        Set oExUser = oAE.GetExchangeUser\n\n        'Write the properties of the  ExchangeUser object to adjacent columns on the worksheet.\n        AliasRange.Cells(I, 1).Offset(0, 1).Value = oExUser.Name \n        AliasRange.Cells(I, 1).Offset(0, 2).Value = oExUser.Manager\n        AliasRange.Cells(I, 1).Offset(0, 3).Value = oExUser.Department\n        AliasRange.Cells(I, 1).Offset(0, 4).Value = oExUser.JobTitle\n        AliasRange.Cells(I, 1).Offset(0, 5).Value = oExUser.OfficeLocation\n        AliasRange.Cells(I, 1).Offset(0, 6).Value = oExUser.City\n        AliasRange.Cells(I, 1).Offset(0, 7).Value = oExUser.StateOrProvince\n        AliasRange.Cells(I, 1).Offset(0, 8).Value = oExUser.StreetAddress\n        AliasRange.Cells(I, 1).Offset(0, 9).Value = oExUser.Alias\n    End If\n\n    'Remove the recipient from the e-mail\n    ActivePersonRecipient.Delete\n\nNext I\n\nExitOutlookEmail:\n\n    Set DummyEMail = Nothing\n    Set ol = Nothing\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["sql", "ms-access", "vba", "ms-access-2016"], "answers": [{"tags": [], "owner": {"reputation": 2071, "user_id": 9990662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8262X.jpg?s=128&g=1", "display_name": "Zack", "link": "https://stackoverflow.com/users/9990662/zack"}, "is_accepted": false, "score": 1, "last_activity_date": 1537977032, "creation_date": 1537977032, "answer_id": 52521748, "question_id": 52521424, "link": "https://stackoverflow.com/questions/52521424/need-help-correcting-my-sql-for-a-crosstab-query/52521748#52521748", "title": "Need help correcting my SQL for a crosstab query", "body": "<p>\nI think you might be better off with your first approach: You just have to set the parameters in your query before getting the recordset:</p>\n\n<pre><code>Public Sub ProcessQuery()\n    Dim db As DAO.Database, qdf As DAO.QueryDef, rs As DAO.Recordset\n\n    Set db = CurrentDb\n    Set qdf = db.QueryDefs(\"qry_Comparison_Bulk\")\n\n    ' set parameters\n    qdf.Parameters(1).value = [Forms]![frm_BulkComparison_Select]![Item 1]\n\n    Set rs1 = qdf.OpenRecordset\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "reply_to_user": {"reputation": 85, "user_id": 8543970, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Bag0e.jpg?s=128&g=1", "display_name": "Lando", "link": "https://stackoverflow.com/users/8543970/lando"}, "edited": false, "score": 0, "creation_date": 1537980536, "post_id": 52522035, "comment_id": 91984769, "body": "You&#39;re welcome.  If it were me, I would also revise the query to use <code>IN()</code> instead of <code>[Field]=this OR [Field]=that OR [Field]= ...</code> and so on.  Something like this: <code>FROM tbl_Formulas AS f WHERE f.BillType IN ([Forms]![frm_BulkComparison_Select]![bill1], [Forms]![frm_BulkComparison_Select]![bill2], [Forms]![frm_BulkComparison_Select]![bill3])</code>"}, {"owner": {"reputation": 85, "user_id": 8543970, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Bag0e.jpg?s=128&g=1", "display_name": "Lando", "link": "https://stackoverflow.com/users/8543970/lando"}, "edited": false, "score": 0, "creation_date": 1537980973, "post_id": 52522035, "comment_id": 91984975, "body": "I can make that change. Thanks for the advice."}], "tags": [], "owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "is_accepted": true, "score": 2, "last_activity_date": 1537978392, "last_edit_date": 1537978392, "creation_date": 1537978020, "answer_id": 52522035, "question_id": 52521424, "link": "https://stackoverflow.com/questions/52521424/need-help-correcting-my-sql-for-a-crosstab-query/52522035#52522035", "title": "Need help correcting my SQL for a crosstab query", "body": "<p>I'm guessing your <code>qry_Comparison_Bulk</code> query references form controls like this <code>tbl_Formulas.BillType=[Forms]![frm_BulkComparison_Select]![bill1]</code> </p>\n\n<p>And the query works when run from the Access query designer.  The problem is that when you try to use that named query with <code>OpenRecordset</code>, each of those controls is treated as a parameter for which you have not supplied a value.  </p>\n\n<p>So supply the values ...</p>\n\n<pre class=\"lang-vba prettyprint-override\"><code>Dim qdf As DAO.QueryDef\nDim prm As DAO.Parameter\nDim rs As DAO.Recordset\nSet qdf = CurrentDb.QueryDefs(\"qry_Comparison_Bulk\")\nFor Each prm In qdf.Parameters\n    prm.Value = Eval(prm.Name)\nNext\nSet rs = qdf.OpenRecordset()\n</code></pre>\n\n<p><code>prm.Name</code> will be what Access interprets to be the parameter name ... like <code>[Forms]![frm_BulkComparison_Select]![bill1]</code> ... so <code>Eval(prm.Name)</code> is equivalent to <code>Eval([Forms]![frm_BulkComparison_Select]![bill1])</code> ... and returns the value of that control ... which you then assign to <code>prm.Value</code></p>\n"}], "owner": {"reputation": 85, "user_id": 8543970, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Bag0e.jpg?s=128&g=1", "display_name": "Lando", "link": "https://stackoverflow.com/users/8543970/lando"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 86, "favorite_count": 0, "accepted_answer_id": 52522035, "answer_count": 2, "score": 1, "last_activity_date": 1537980781, "creation_date": 1537975953, "last_edit_date": 1537980781, "question_id": 52521424, "link": "https://stackoverflow.com/questions/52521424/need-help-correcting-my-sql-for-a-crosstab-query", "title": "Need help correcting my SQL for a crosstab query", "body": "<p>I'm using the below code to export a crosstab query to excel. </p>\n\n<p>I've tried <code>Set rs1 = CurrentDb.OpenRecordset(\"qry_Comparison_Bulk\")</code> but I always get Error: Too few parameters. Expected 19. There are 19 parameters stored in that query. My next thought was to just recreate the SQL in VBA. Now I'm getting Error: Too many crosstab column headers (424). 424 is the total number of items in my db so I'm thinking that the filter isn't working appropriately.</p>\n\n<pre><code>Set rs1 = CurrentDb.OpenRecordset(\"TRANSFORM Sum(tbl_Formulas.Input) AS SumOfInput \" _\n&amp; \"SELECT tbl_Formulas.BillType, tbl_Formulas.RawMaterial \" _\n&amp; \"FROM tbl_Formulas \" _\n&amp; \"WHERE (tbl_Formulas.BillType)='\" &amp; [Forms]![frm_BulkComparison_Select]![bill1] &amp; \"' Or (tbl_Formulas.BillType)='\" &amp; [Forms]! [frm_BulkComparison_Select]![bill2] &amp; \"' Or (tbl_Formulas.BillType)='\" &amp; [Forms]![frm_BulkComparison_Select]![bill3] &amp; \"' AND (tbl_Formulas.Item)='\" &amp;[Forms]![frm_BulkComparison_Select]![Item 1] &amp; \"' Or \" _ \n&amp; \"(tbl_Formulas.Item)='\" &amp; [Forms]![frm_BulkComparison_Select]![Item 2] &amp; \"' Or (tbl_Formulas.Item)='\" &amp; [Forms]![frm_BulkComparison_Select]![Item 3] &amp; \"' Or (tbl_Formulas.Item)='\" &amp; [Forms]![frm_BulkComparison_Select]![Item 4] &amp; \"' Or (tbl_Formulas.Item)='\" &amp; [Forms]![frm_BulkComparison_Select]![Item 5] &amp; \"' Or \" _\n&amp; \"(tbl_Formulas.Item)='\" &amp; [Forms]![frm_BulkComparison_Select]![Item 6] &amp; \"' Or (tbl_Formulas.Item)='\" &amp; [Forms]![frm_BulkComparison_Select]![Item 7] &amp; \"' Or (tbl_Formulas.Item)='\" &amp; [Forms]![frm_BulkComparison_Select]![Item 8] &amp; \"' Or (tbl_Formulas.Item)='\" &amp; [Forms]![frm_BulkComparison_Select]![Item 9] &amp; \"' Or \" _\n&amp; \"(tbl_Formulas.Item)='\" &amp; [Forms]![frm_BulkComparison_Select]![Item 10] &amp; \"' Or (tbl_Formulas.Item)='\" &amp; [Forms]![frm_BulkComparison_Select]![Item 11] &amp; \"' Or (tbl_Formulas.Item)='\" &amp; [Forms]![frm_BulkComparison_Select]![Item 12] &amp; \"' Or (tbl_Formulas.Item)='\" &amp; [Forms]![frm_BulkComparison_Select]![Item 13] &amp; \"' Or \" _\n&amp; \"(tbl_Formulas.Item)='\" &amp; [Forms]![frm_BulkComparison_Select]![Item 14] &amp; \"' Or (tbl_Formulas.Item)='\" &amp; [Forms]![frm_BulkComparison_Select]![Item 15] &amp; \"' AND (tbl_Formulas.BP)='\" &amp; [Forms]![frm_BulkComparison_Select]![BP] &amp; \"' \" _\n&amp; \"GROUP BY tbl_Formulas.BillType, tbl_Formulas.RawMaterial \" _\n&amp; \"PIVOT tbl_Formulas.Item;\")\n</code></pre>\n\n<p>There are '\" &amp; ... &amp; \"'delimiters to avoid the use of parameters as the values for each of the fields are text. </p>\n\n<p>Further, my form is set up with 15 text boxes for \"Item\", 3 text boxes for \"BillType\", and 1 text box for \"BP\"</p>\n"}, {"tags": ["vba", "excel", "excel-formula"], "answers": [{"comments": [{"owner": {"reputation": 5, "user_id": 10140308, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d25098fd70e5ab57630cd1608f59e508?s=128&d=identicon&r=PG&f=1", "display_name": "Cory Britton", "link": "https://stackoverflow.com/users/10140308/cory-britton"}, "edited": false, "score": 0, "creation_date": 1537977364, "post_id": 52521596, "comment_id": 91983182, "body": "Thanks! I was sure it would be a vlookup but I am still trying to learn the ropes!"}, {"owner": {"reputation": 5, "user_id": 10140308, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d25098fd70e5ab57630cd1608f59e508?s=128&d=identicon&r=PG&f=1", "display_name": "Cory Britton", "link": "https://stackoverflow.com/users/10140308/cory-britton"}, "edited": false, "score": 0, "creation_date": 1537979181, "post_id": 52521596, "comment_id": 91984104, "body": "Do you know if there is a way to do it across two separate workbooks? Currently I am copy/paste the worksheet 2 from a different workbook."}, {"owner": {"reputation": 1156, "user_id": 10315836, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hZjRU.png?s=128&g=1", "display_name": "Valon Miller", "link": "https://stackoverflow.com/users/10315836/valon-miller"}, "reply_to_user": {"reputation": 5, "user_id": 10140308, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d25098fd70e5ab57630cd1608f59e508?s=128&d=identicon&r=PG&f=1", "display_name": "Cory Britton", "link": "https://stackoverflow.com/users/10140308/cory-britton"}, "edited": false, "score": 0, "creation_date": 1537979909, "post_id": 52521596, "comment_id": 91984485, "body": "yes, you have to provide the path <code>=VLOOKUP($D2,[C:\\...\\Book2.xlsx]Sheet2!$A:$B,2,FALSE)</code> where &quot;C:\\...\\&quot; is the actual path of your workbook. This will create a link that has to be updated, usually when the workbook is opened. And the user needs to have access to that path. If you are configuring this from a workbook that is already open, then <code>=VLOOKUP($D2,[Book2]Sheet2!$A:$B,2,FALSE)</code> where <code>Book2</code> is the name of the second workbook, will work; it will figure out the rest of the path (if it is a saved workbook.)"}, {"owner": {"reputation": 5, "user_id": 10140308, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d25098fd70e5ab57630cd1608f59e508?s=128&d=identicon&r=PG&f=1", "display_name": "Cory Britton", "link": "https://stackoverflow.com/users/10140308/cory-britton"}, "edited": false, "score": 0, "creation_date": 1538057450, "post_id": 52521596, "comment_id": 92017464, "body": "One more request on top of returning the value. I would I add on top of the formula to say change the return value from &quot;Lend&quot; to &quot;L&quot;. I am sure there is a few IF statements involved but don&#39;t know if that is the best was to go. There are 6 values I will need to do this for."}, {"owner": {"reputation": 1156, "user_id": 10315836, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hZjRU.png?s=128&g=1", "display_name": "Valon Miller", "link": "https://stackoverflow.com/users/10315836/valon-miller"}, "reply_to_user": {"reputation": 5, "user_id": 10140308, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d25098fd70e5ab57630cd1608f59e508?s=128&d=identicon&r=PG&f=1", "display_name": "Cory Britton", "link": "https://stackoverflow.com/users/10140308/cory-britton"}, "edited": false, "score": 0, "creation_date": 1538057891, "post_id": 52521596, "comment_id": 92017755, "body": "There are a few ways you could do that, but if you are only looking to change &quot;Lend&quot; then <code>=SUBSTITUTE(IFERROR(VLOOKUP($D2,[Book2]Sheet2!$A:$B,2,FALSE)&zwnj;&#8203;,&quot;Not Found!&quot;),&quot;Lend&quot;,&quot;L&quot;)</code>"}, {"owner": {"reputation": 5, "user_id": 10140308, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d25098fd70e5ab57630cd1608f59e508?s=128&d=identicon&r=PG&f=1", "display_name": "Cory Britton", "link": "https://stackoverflow.com/users/10140308/cory-britton"}, "edited": false, "score": 0, "creation_date": 1538058083, "post_id": 52521596, "comment_id": 92017901, "body": "Essentially I have 6 different strings that I will only need to return the first character of. Hopefully that clarification makes it easier."}, {"owner": {"reputation": 5, "user_id": 10140308, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d25098fd70e5ab57630cd1608f59e508?s=128&d=identicon&r=PG&f=1", "display_name": "Cory Britton", "link": "https://stackoverflow.com/users/10140308/cory-britton"}, "edited": false, "score": 0, "creation_date": 1538058197, "post_id": 52521596, "comment_id": 92017980, "body": "Lend = L; Collect = C ; Protect = P; Efficiency = E; Compliance/Risk/Legal = CRL; Other = O"}], "tags": [], "owner": {"reputation": 1156, "user_id": 10315836, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hZjRU.png?s=128&g=1", "display_name": "Valon Miller", "link": "https://stackoverflow.com/users/10315836/valon-miller"}, "is_accepted": true, "score": 0, "last_activity_date": 1537980332, "last_edit_date": 1537980332, "creation_date": 1537976500, "answer_id": 52521596, "question_id": 52521418, "link": "https://stackoverflow.com/questions/52521418/how-to-fill-cell-with-data-from-a-separate-worksheet-in-excel/52521596#52521596", "title": "How to fill cell with data from a separate worksheet in excel?", "body": "<p>Put this in F2 On Sheet 1, update the sheet name <code>Sheet2</code> to whatever your second sheet is named, then copy down:</p>\n\n<pre><code>=VLOOKUP($D2,Sheet2!$A:$B,2,FALSE)\n</code></pre>\n\n<p>Then you can apply conditional formatting to Column F on Sheet 1.</p>\n\n<p>If you might have values in Sheet 1 that aren't in Sheet 2, this will handle the error:</p>\n\n<pre><code>=IFERROR(VLOOKUP($D2,Sheet2!$A:$B,2,FALSE),\"Not Found!\")\n</code></pre>\n\n<p><strong>[Updated for additional question about spanning accross workbooks]</strong></p>\n\n<p>For another open workbook, use the following and replace <code>[Book2]</code> with the path of the second workbook or the name of an open workbook:</p>\n\n<pre><code>=IFERROR(VLOOKUP($D2,[Book2]Sheet2!$A:$B,2,FALSE),\"Not Found!\")\n</code></pre>\n\n<p>Also note, Excel will automatically build all of the references if you select them manually while building the formula in the formula bar: <a href=\"https://support.office.com/en-us/article/overview-of-formulas-in-excel-ecfdc708-9162-49e8-b993-c311f47ca173\" rel=\"nofollow noreferrer\">Excel Formulas Overview on MSDN</a></p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 10261725, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e9f9561a17c16d06717e17da2049f926?s=128&d=identicon&r=PG&f=1", "display_name": "VBAjake", "link": "https://stackoverflow.com/users/10261725/vbajake"}, "is_accepted": false, "score": 0, "last_activity_date": 1537977107, "creation_date": 1537977107, "answer_id": 52521780, "question_id": 52521418, "link": "https://stackoverflow.com/questions/52521418/how-to-fill-cell-with-data-from-a-separate-worksheet-in-excel/52521780#52521780", "title": "How to fill cell with data from a separate worksheet in excel?", "body": "<p>More information is needed to provide you with an exact code but here is a good start</p>\n\n<p>'Assuming there are 10 rows in each worksheet</p>\n\n<pre><code>dim i as integer\ndim j as integer\n\nfor i = 1 to 10\n    for j = 1 to 10 \n        if sheet1.cells(i,4).value = sheet2.cells(j,1).value then\n            sheet1.cells(i,6).value = sheet1.cells(j,2).value\n            sheet1.cells(i,6).interior.color = vbyellow\n        end if\n    next j\nnext i\n</code></pre>\n\n<p>the color can also be controlled with the rgb function, simply replace the vbyellow in the above code: </p>\n\n<p>For example rgb(255,204,255) will be a light pink</p>\n"}], "owner": {"reputation": 5, "user_id": 10140308, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d25098fd70e5ab57630cd1608f59e508?s=128&d=identicon&r=PG&f=1", "display_name": "Cory Britton", "link": "https://stackoverflow.com/users/10140308/cory-britton"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 77, "favorite_count": 0, "accepted_answer_id": 52521596, "answer_count": 2, "score": 0, "last_activity_date": 1537980332, "creation_date": 1537975943, "last_edit_date": 1537976278, "question_id": 52521418, "link": "https://stackoverflow.com/questions/52521418/how-to-fill-cell-with-data-from-a-separate-worksheet-in-excel", "title": "How to fill cell with data from a separate worksheet in excel?", "body": "<p>I am attempting to match 2 columns in two separate worksheets and then fill data from worksheet 2 in worksheet 1. </p>\n\n<p>I need to match Column A(Worksheet 2) to Column D(Worksheet 1). Once Matched I need to fill Column F(Worksheet 1) with the data from Column B(Worksheet 2). Once data is populated I would also like to change the color of Column F(Worksheet 1) based on the data that is present. <a href=\"https://i.stack.imgur.com/Kpu8G.png\" rel=\"nofollow noreferrer\">Worksheet 1</a>\n<a href=\"https://i.stack.imgur.com/MNnAL.png\" rel=\"nofollow noreferrer\">Worksheet 2</a></p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 366, "user_id": 6370648, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gTPiL.png?s=128&g=1", "display_name": "Dawid SA Tokyo", "link": "https://stackoverflow.com/users/6370648/dawid-sa-tokyo"}, "edited": false, "score": 1, "creation_date": 1537975288, "post_id": 52521128, "comment_id": 91981910, "body": "You need to change the &#39;GetFile&#39; parameter - you are missing the file name in it. Try this: &#39;Application.ActiveWorkbook.Path &amp; &quot;\\&quot; &amp; ActiveWorkbook.Name&#39;"}, {"owner": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 2, "creation_date": 1537975289, "post_id": 52521128, "comment_id": 91981912, "body": "you&#39;ll have to do <code>Activeworkbook.FullName</code> instead. <code>.Path</code> does not include the name of the file"}, {"owner": {"reputation": 580, "user_id": 1046884, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/4397c31a66aaf33dd73431227519ac47?s=128&d=identicon&r=PG", "display_name": "sc1324", "link": "https://stackoverflow.com/users/1046884/sc1324"}, "edited": false, "score": 0, "creation_date": 1537976323, "post_id": 52521128, "comment_id": 91982569, "body": "Thank you, the revised code will work with dynamic names. Thank you both."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1538067382, "post_id": 52521128, "comment_id": 92023487, "body": "you can use my answer <a href=\"https://stackoverflow.com/a/52297421/6241235\">here</a>"}], "answers": [{"tags": [], "owner": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "is_accepted": true, "score": 1, "last_activity_date": 1538066651, "creation_date": 1538066651, "answer_id": 52541647, "question_id": 52521128, "link": "https://stackoverflow.com/questions/52521128/get-the-last-modified-file-or-folder-in-a-directory-with-dynamic-name/52541647#52541647", "title": "Get the last modified file or folder in a directory with dynamic name", "body": "<p>Guess I'll post an answer just to close this one out</p>\n\n<pre><code>Sub Main()\n    'Setting Summary Report\n\n    'Last author\n    Dim sAuthor As String\n    sAuthor = ActiveWorkbook.BuiltinDocumentProperties(\"Last Author\")\n\n    'Last modified time\n    Dim fso As Object\n    Set fso = CreateObject(\"Scripting.FileSystemObject\")\n\n    Dim file As Object\n    Set file = fso.GetFile(ActiveWorkbook.FullName)\n\n    Dim fileModDate As String\n    fileModDate = file.DateLastModified\n\n    'Updating range to last author and modified time\n    Worksheets(\"Sheet1\").Range(\"A2\").Value2 = sAuthor &amp; \" \" &amp; fileModDate\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 580, "user_id": 1046884, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/4397c31a66aaf33dd73431227519ac47?s=128&d=identicon&r=PG", "display_name": "sc1324", "link": "https://stackoverflow.com/users/1046884/sc1324"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 441, "favorite_count": 1, "accepted_answer_id": 52541647, "answer_count": 1, "score": 0, "last_activity_date": 1538066651, "creation_date": 1537975031, "question_id": 52521128, "link": "https://stackoverflow.com/questions/52521128/get-the-last-modified-file-or-folder-in-a-directory-with-dynamic-name", "title": "Get the last modified file or folder in a directory with dynamic name", "body": "<p>I am trying to display the last person who accessed excel file and time in excel sheet but the file name changes every day (file name contains date).</p>\n\n<p>My current codes gives me an error of file not found which I tried both <code>ActiveWorkbook.path</code> and <code>Application.ActiveWorkbook.Path</code>. </p>\n\n<pre><code>Sub Main()\n'Setting Summary Report\nDim sAuthor As String\nsAuthor = ActiveWorkbook.BuiltinDocumentProperties(\"Last Author\")\n 'Last modified person &amp; time\n    Dim fileModDate As String\n    Dim fs\n    Dim f\n    Set fs = CreateObject(\"Scripting.FileSystemObject\")\n    Set f = fs.GetFile(Application.ActiveWorkbook.Path)\n    fileModDate = f.DateLastModified\n    Worksheets(\"Sheet1\").Range(\"A2\") = sAuthor &amp; \" \" &amp; fileModDate\nEnd Sub\n</code></pre>\n\n<p>I could re-save the file as an uniform name like test or something, but I wasn't sure if the codes can be modified for this to work so I don't have to re-save the file.</p>\n"}, {"tags": ["excel", "vba", "for-loop", "exit"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 2, "creation_date": 1537974659, "post_id": 52520968, "comment_id": 91981529, "body": "If you&#39;re deleting rows you need to loop backwards."}, {"owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "edited": false, "score": 3, "creation_date": 1537974814, "post_id": 52520968, "comment_id": 91981632, "body": "Why don&#39;t you write <code>For j = ... To 2 Step -1</code> ?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 2, "creation_date": 1537975102, "post_id": 52520968, "comment_id": 91981813, "body": "If your code looks exactly like this in your editor, look into what <a href=\"http://rubberduckvba.com/indentation\" rel=\"nofollow noreferrer\">indentation</a> can do for your code&#39;s readability (disclaimer: I own that website)."}, {"owner": {"reputation": 3, "user_id": 3609746, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/342168ce6077843997c41d519dcaaf18?s=128&d=identicon&r=PG&f=1", "display_name": "user3609746", "link": "https://stackoverflow.com/users/3609746/user3609746"}, "edited": false, "score": 0, "creation_date": 1537975518, "post_id": 52520968, "comment_id": 91982050, "body": "To 2 Step -1 is the answer.  That&#39;s what happens when you just steal bits of code and you don&#39;t actually know what it all means!  Apologies for the lack of indentation...my original format of code got an error from stackoverflow saying all code needed indention of 4 spaces.  I took that too literally.  Rookie mistakes.  Thanks for your help folks!"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1537975797, "post_id": 52520968, "comment_id": 91982231, "body": "the 4 spaces are required for the Markdown syntax to recognize a code block as such - you can still preserve your original &amp; correct indentation: just paste your code, then select it all and press Ctrl+K (or use the <code>{}</code> button in the editing toolbar)"}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1537976851, "post_id": 52520968, "comment_id": 91982860, "body": "I&#39;d also add that the first block of code is stepping through all the rows, while the second starts at the last row containing data - that&#39;s got to be saving a few seconds."}], "answers": [{"tags": [], "owner": {"reputation": 1385, "user_id": 8555648, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-CK4leGQFE84/AAAAAAAAAAI/AAAAAAAAAgY/HrlhEh-LPIQ/photo.jpg?sz=128", "display_name": "newacc2240", "link": "https://stackoverflow.com/users/8555648/newacc2240"}, "is_accepted": false, "score": 0, "last_activity_date": 1537979207, "creation_date": 1537979207, "answer_id": 52522319, "question_id": 52520968, "link": "https://stackoverflow.com/questions/52520968/excel-vba-for-loop-optimization-exit-when-j-2/52522319#52522319", "title": "Excel VBA For Loop Optimization - Exit when j = 2", "body": "<p>As mentioned in the comments, you should looking backward for deletions. If you do the deletions from <code>row#2</code> to the last row, there might be some rows should be deleted but remained there. Take this for example, assuming we are going to delete <code>row#3</code> and <code>row#4</code>. If we do it forward, the <code>row#4</code> becomes to new <code>row#3</code> after deleting old <code>row#3</code>. And the next row to be checked is <code>row#4</code>, that is the original <code>row#5</code>. So the data in <code>row#4</code> is actually in <code>row#3</code> now and it'll never be deleted.</p>\n\n<p>However, when your data is quite massive, the deletions would take so many resource that it drags down the speed. It would be better to find all the ranges to be deleted and delete them at once in the end. We can do it by <code>Union</code> method. And this can also prevent the problem mentioned before, so we can do it forward as other loops.</p>\n\n<p>Lastly, you can avoid selecting ranges since it is not so efficient. <code>Range().Delete</code> can simply delete the range and without selecting it.</p>\n\n<p>The code would be like this.</p>\n\n<pre><code>'pseudo code\nSub deletion()\n    For i = 2 To lastrow\n        If shouldBeDeleted Then\n             If deletingRng Is Nothing Then\n                 Set deletingRng = Cells(i, X)\n             Else\n                 Set deletingRng = Union(deletingRng, Cells(i, X)\n             End If\n        End If\n     Next i\n\n     deletingRng.Delete Shift:=xlUp\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 3609746, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/342168ce6077843997c41d519dcaaf18?s=128&d=identicon&r=PG&f=1", "display_name": "user3609746", "link": "https://stackoverflow.com/users/3609746/user3609746"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 54, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1537979207, "creation_date": 1537974570, "last_edit_date": 1537974724, "question_id": 52520968, "link": "https://stackoverflow.com/questions/52520968/excel-vba-for-loop-optimization-exit-when-j-2", "title": "Excel VBA For Loop Optimization - Exit when j = 2", "body": "<p>I'm trying to optimize code that will delete rows that meet certain criteria.  I have working code, but the following code creates 7 seconds of wait time to execute:</p>\n\n<pre><code>Dim j As Long\nFor j = 2 To Rows.Count\nIf (Range(\"J\" &amp; j).Value &lt;&gt; \"\") Then\nRange(\"A\" &amp; j &amp; \":R\" &amp; j).Select\nSelection.Delete Shift:=xlUp\nEnd If\nNext j\n</code></pre>\n\n<p>The following code runs instantly; however, I can't get it to work once j = 2.  What code needs to be added to stop the loop before it deletes the column headers in row 1?</p>\n\n<pre><code>' Delete rows where column J is not blank\nFor j = Range(\"J\" &amp; Rows.Count).End(xlUp).Row To 1 Step -1\nIf (Range(\"J\" &amp; j).Value &lt;&gt; \"\") Then\nRange(\"A\" &amp; j &amp; \":R\" &amp; j).Select\nSelection.Delete Shift:=xlUp\nEnd If\nNext j\n</code></pre>\n"}, {"tags": ["excel", "vba", "formula", "excel-r1c1-notation"], "comments": [{"owner": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "edited": false, "score": 1, "creation_date": 1537976111, "post_id": 52520768, "comment_id": 91982430, "body": "Welcome to SO. My eyes could be wrong but I&#39;m pretty sure that VLOOKUP has only 4 arguments, and in your formula you have 5. Your formula is <code>VLOOKUP(RC[-1],(J3,&#39;Agent Table&#39;!D:J,7,0)</code>. Should it not be <code>VLOOKUP(J3,&#39;Agent Table&#39;!D:J,7,0)</code> ??? That would fit your example of <code>VLOOKUP(J3,&#39;Int Data&#39;!D:J,7,0)</code>. 4 Arguments, not 5."}, {"owner": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "edited": false, "score": 0, "creation_date": 1537976342, "post_id": 52520768, "comment_id": 91982584, "body": "Besides, parenthesis quantity must be the same in both cases always, but you have 4 <code>(</code> and only 2 <code>)</code>. Something is wrong there"}], "answers": [{"comments": [{"owner": {"reputation": 224, "user_id": 10419493, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/57992f514d2fea11816e84519957ec5e?s=128&d=identicon&r=PG&f=1", "display_name": "SeT", "link": "https://stackoverflow.com/users/10419493/set"}, "edited": false, "score": 0, "creation_date": 1537974604, "post_id": 52520821, "comment_id": 91981496, "body": "Hi Vityata, I tried your suggestion but regrettably, it doesn&#39;t work. I&#39;m not trying to record the macro though. Thanks"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 224, "user_id": 10419493, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/57992f514d2fea11816e84519957ec5e?s=128&d=identicon&r=PG&f=1", "display_name": "SeT", "link": "https://stackoverflow.com/users/10419493/set"}, "edited": false, "score": 0, "creation_date": 1537974767, "post_id": 52520821, "comment_id": 91981604, "body": "@MarkH - I know you are not trying to record the macro. This is just in case, if you were trying to. In general, write a formula in Excel, select it and run the code from here - <a href=\"https://stackoverflow.com/a/49363501/5448626\">stackoverflow.com/a/49363501/5448626</a> It will print you the correct code in the format you select. E.g. replace <code>strFormula = Selection.Formula</code> with <code>strFormula = Selection.FormulaR1C1</code>."}, {"owner": {"reputation": 224, "user_id": 10419493, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/57992f514d2fea11816e84519957ec5e?s=128&d=identicon&r=PG&f=1", "display_name": "SeT", "link": "https://stackoverflow.com/users/10419493/set"}, "edited": false, "score": 0, "creation_date": 1537975361, "post_id": 52520821, "comment_id": 91981961, "body": "Thanks again Vityata but still no luck with it. Still the same error message. Any other thoughts? Thanks"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 224, "user_id": 10419493, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/57992f514d2fea11816e84519957ec5e?s=128&d=identicon&r=PG&f=1", "display_name": "SeT", "link": "https://stackoverflow.com/users/10419493/set"}, "edited": false, "score": 0, "creation_date": 1537975736, "post_id": 52520821, "comment_id": 91982204, "body": "@MarkH - what did you get as a result in the immediate window after using the function from the linked answer in my previous comment?"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 224, "user_id": 10419493, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/57992f514d2fea11816e84519957ec5e?s=128&d=identicon&r=PG&f=1", "display_name": "SeT", "link": "https://stackoverflow.com/users/10419493/set"}, "edited": false, "score": 0, "creation_date": 1537975938, "post_id": 52520821, "comment_id": 91982320, "body": "@MarkH - actually in the formula <code>J3</code> is not passed in R1C1 format."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1537976005, "post_id": 52520821, "comment_id": 91982372, "body": "Both reference must be in same format either R1C1 or A1"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 2, "creation_date": 1537976189, "post_id": 52520821, "comment_id": 91982475, "body": "<code>&#39;Agent Table&#39;!D:J</code> should be <code>&#39;Agent Table&#39;!C4:C10</code>"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1537976343, "post_id": 52520821, "comment_id": 91982586, "body": "Also there are too many <code>(</code>: <code>ActiveCell.FormulaR1C1 = &quot;=IFERROR(VLOOKUP(R3C10,&#39;Agent Table&#39;!C4:C10,7,0),&quot;&quot;&quot;&quot;)&quot;</code>"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1537976428, "post_id": 52520821, "comment_id": 91982625, "body": "@ScottCraner - I have edited while improving the preivous one :)"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1537976487, "post_id": 52520821, "comment_id": 91982669, "body": "Still need to fix the <code>&quot;&quot;</code> to <code>&quot;&quot;&quot;&quot;</code>"}, {"owner": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "edited": false, "score": 0, "creation_date": 1537976520, "post_id": 52520821, "comment_id": 91982692, "body": "Just one question. How do you know the area to search is <code>C4:C10</code> instead of <code>D:J</code>? :O"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "edited": false, "score": 2, "creation_date": 1537976560, "post_id": 52520821, "comment_id": 91982715, "body": "@FoxfireAndBurnsAndBurns C4:C10 in R1C1 is columns D:J."}, {"owner": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1537976620, "post_id": 52520821, "comment_id": 91982748, "body": "Omg!!!!! Facepalm! Thanks @ScottCraner I read that still as <code>A1</code> style. My bad. Thanks for aclaration"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1537976690, "post_id": 52520821, "comment_id": 91982787, "body": "To be honest, since seeing this approach - <a href=\"https://stackoverflow.com/questions/49363434/excel-vba-formula-german-french-italian-russian-dutch-foreign-function/49363501#49363501\" title=\"excel vba formula german french italian russian dutch foreign function\">stackoverflow.com/questions/49363434/&hellip;</a> I have never ever tried anything else."}, {"owner": {"reputation": 224, "user_id": 10419493, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/57992f514d2fea11816e84519957ec5e?s=128&d=identicon&r=PG&f=1", "display_name": "SeT", "link": "https://stackoverflow.com/users/10419493/set"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1537977057, "post_id": 52520821, "comment_id": 91982977, "body": "@ScottCraner - thanks very much for rectifying my line. It does work perfectly."}, {"owner": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "reply_to_user": {"reputation": 224, "user_id": 10419493, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/57992f514d2fea11816e84519957ec5e?s=128&d=identicon&r=PG&f=1", "display_name": "SeT", "link": "https://stackoverflow.com/users/10419493/set"}, "edited": false, "score": 0, "creation_date": 1538040125, "post_id": 52520821, "comment_id": 92006379, "body": "@MarkH, If this answer worked, please, mark it as correct so it can help future users. Thanks!"}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": true, "score": 3, "last_activity_date": 1537976612, "last_edit_date": 1537976612, "creation_date": 1537974125, "answer_id": 52520821, "question_id": 52520768, "link": "https://stackoverflow.com/questions/52520768/issue-with-formular1c1/52520821#52520821", "title": "Issue with FormulaR1C1", "body": "<p>You need <code>.FormulaR1C1</code> and not <code>.Formula</code>: </p>\n\n<p><code>ActiveCell.FormulaR1C1 = \"=IFERROR(VLOOKUP(R3C10,'Agent Table'!C4:C10,7, 0)\"\"\"\")\"</code></p>\n\n<p><code>R3C10</code> is the <code>R1C1</code> notation for <code>J3</code>.</p>\n\n<p>If you are using the Macro Recorder to see the formula, select \"Use Relative References\" in the developer tab to change the way the address is displayed:</p>\n\n<p><a href=\"https://i.stack.imgur.com/56YPh.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/56YPh.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 10261725, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e9f9561a17c16d06717e17da2049f926?s=128&d=identicon&r=PG&f=1", "display_name": "VBAjake", "link": "https://stackoverflow.com/users/10261725/vbajake"}, "is_accepted": false, "score": 0, "last_activity_date": 1537977523, "creation_date": 1537977523, "answer_id": 52521898, "question_id": 52520768, "link": "https://stackoverflow.com/questions/52520768/issue-with-formular1c1/52521898#52521898", "title": "Issue with FormulaR1C1", "body": "<p>You are combining A1 and R1C1 referencing in the same formula, this should be avoided.</p>\n\n<p>Generally R1C1 is the preferred reference style for VBA. It may require a few more keystrokes but it provides greater control when accessing the cells.</p>\n"}], "owner": {"reputation": 224, "user_id": 10419493, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/57992f514d2fea11816e84519957ec5e?s=128&d=identicon&r=PG&f=1", "display_name": "SeT", "link": "https://stackoverflow.com/users/10419493/set"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 579, "favorite_count": 0, "accepted_answer_id": 52520821, "answer_count": 2, "score": 1, "last_activity_date": 1537977523, "creation_date": 1537973947, "last_edit_date": 1537974075, "question_id": 52520768, "link": "https://stackoverflow.com/questions/52520768/issue-with-formular1c1", "title": "Issue with FormulaR1C1", "body": "<p>I need a little help with the below formula in VBA:</p>\n\n<pre><code>=IFERROR(VLOOKUP(J3,'Int Data'!D:J,7,0),\"\")\n</code></pre>\n\n<p>I've tried to run the following:</p>\n\n<pre><code>Range(\"AP2\").Select    \nActiveCell.Formula = \"=IFERROR((VLOOKUP(RC[-1],(J3,'Agent Table'!D:J,7,0),\"\")\"    \nRange(\"AP2\").Select    \nSelection.Copy    \nSelection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=False    \nCells.Select    \nCells.EntireColumn.AutoFit\n</code></pre>\n\n<p>When I try to run this statement - </p>\n\n<p><code>ActiveCell.Formula = \"=IFERROR((VLOOKUP(RC[-1],(J3,'Agent Table'!D:J,7,0),\"\")\"</code></p>\n\n<p>I got a: </p>\n\n<blockquote>\n  <p>Run-time error '1004'</p>\n</blockquote>\n\n<p>Can you please advise what is wrong with this statement?</p>\n"}, {"tags": ["vba", "ms-access", "svn"], "answers": [{"comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1537974542, "post_id": 52520843, "comment_id": 91981454, "body": "Yup. Joys of case-sensitive diffing a case-insensitive language."}], "tags": [], "owner": {"reputation": 848, "user_id": 9930052, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b31bc4725aa5b89c228cb8e64fe2c4a?s=128&d=identicon&r=PG&f=1", "display_name": "Gener4tor", "link": "https://stackoverflow.com/users/9930052/gener4tor"}, "is_accepted": false, "score": 0, "last_activity_date": 1537974181, "creation_date": 1537974181, "answer_id": 52520843, "question_id": 52520689, "link": "https://stackoverflow.com/questions/52520689/prevent-vbe-from-constantly-changing-modules-in-the-background/52520843#52520843", "title": "Prevent VBE from constantly changing modules in the background", "body": "<p>ok, the question seems to be asked already:</p>\n\n<p>See here: <a href=\"https://stackoverflow.com/questions/5872263/annoying-vba-naming-behaviour?rq=1\">Annoying vba naming behaviour</a>\nand here: <a href=\"https://stackoverflow.com/questions/4852735/how-does-one-restore-default-case-to-a-variable-in-vba-excel-2010/4852999#4852999\">How does one restore default case to a variable in VBA (Excel 2010)?</a></p>\n\n<p>sry...</p>\n"}, {"comments": [{"owner": {"reputation": 848, "user_id": 9930052, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b31bc4725aa5b89c228cb8e64fe2c4a?s=128&d=identicon&r=PG&f=1", "display_name": "Gener4tor", "link": "https://stackoverflow.com/users/9930052/gener4tor"}, "edited": false, "score": 0, "creation_date": 1537974719, "post_id": 52520885, "comment_id": 91981563, "body": "Im quite sure, that the vbe does also start a &quot;global change&quot; when you just &quot;touch&quot; a already written line. We are talking about &gt;100 projects with 50-150 modules each. So I cans see how its possible to  ensure everyone uses the same capitalization all the time..."}, {"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "reply_to_user": {"reputation": 848, "user_id": 9930052, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b31bc4725aa5b89c228cb8e64fe2c4a?s=128&d=identicon&r=PG&f=1", "display_name": "Gener4tor", "link": "https://stackoverflow.com/users/9930052/gener4tor"}, "edited": false, "score": 0, "creation_date": 1537975060, "post_id": 52520885, "comment_id": 91981782, "body": "I don&#39;t disagree with you @Gener4tor, unfortunately, that&#39;s what you get."}, {"owner": {"reputation": 6051, "user_id": 62477, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d5de80ba94b348835287cdb2ea8f3a9c?s=128&d=identicon&r=PG", "display_name": "HardCode", "link": "https://stackoverflow.com/users/62477/hardcode"}, "edited": false, "score": 0, "creation_date": 1537982453, "post_id": 52520885, "comment_id": 91985711, "body": "Sometimes it won&#39;t change a line until you change something on that line yourself, and it is re-parsed. Then the case suddenly changes. I don&#39;t miss VBA :D"}], "tags": [], "owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "is_accepted": false, "score": 2, "last_activity_date": 1537974325, "creation_date": 1537974325, "answer_id": 52520885, "question_id": 52520689, "link": "https://stackoverflow.com/questions/52520689/prevent-vbe-from-constantly-changing-modules-in-the-background/52520885#52520885", "title": "Prevent VBE from constantly changing modules in the background", "body": "<p>If you </p>\n\n<pre><code>Dim DESCRIPTION As String\n</code></pre>\n\n<p><em>anywhere</em> in your Access project, the VBE will \"helpfully\" change <em>all</em> references of the text \"description\" to upper case for you. To test this out, type the following in a module where you have your <code>Err.DESCRIPTION</code> text:</p>\n\n<pre><code>Dim Description As String\n</code></pre>\n\n<p>Then delete that line. It will fix the capitalization everywhere.</p>\n\n<p>Thereafter, just ensure that you're not using \"funky\" capitalization of any reserved word or method or property of any referenced library.</p>\n\n<p>Just for fun:</p>\n\n<pre><code>Dim value As Long\nActiveWorksheet.Range(\"A1\").value\n</code></pre>\n\n<p>Note the case of the method <code>.Value</code> has been \"fixed\" for you. (Yeah, it's Excel, but it'll work the same in Access.)</p>\n"}], "owner": {"reputation": 848, "user_id": 9930052, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b31bc4725aa5b89c228cb8e64fe2c4a?s=128&d=identicon&r=PG&f=1", "display_name": "Gener4tor", "link": "https://stackoverflow.com/users/9930052/gener4tor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 45, "favorite_count": 0, "closed_date": 1537974503, "answer_count": 2, "score": 0, "last_activity_date": 1537974325, "creation_date": 1537973722, "question_id": 52520689, "link": "https://stackoverflow.com/questions/52520689/prevent-vbe-from-constantly-changing-modules-in-the-background", "closed_reason": "Duplicate", "title": "Prevent VBE from constantly changing modules in the background", "body": "<p>We use the SaveAsText to export vba code from an access database to a textfile and put this file into an svn-database. See here: <a href=\"https://stackoverflow.com/questions/50816715/extract-vba-code-from-access-via-c-sharp\">Extract VBA-Code from Access via C#</a></p>\n\n<p>The problem is, that VBE (= the VBA Development enviroment) seems to change a lot of stuff in the background. For example:</p>\n\n<pre><code>xerrdesc = Err.Description\n</code></pre>\n\n<p>is changed to:</p>\n\n<pre><code>xerrdesc = Err.DESCRIPTION\n</code></pre>\n\n<p>in dozens of modules.</p>\n\n<p>We where not able to find out why the VBE changes this. For us it looks quite random. Sometimes the stuff is changed to capital letters like in the example. Sometimes its changed to lowercase letter and so on.</p>\n\n<p>The result is some kind of \"noise\" in the repository. There are a lot of changes we did not intend.</p>\n\n<p>Is there a way to prevent the VBE from changing code in the background?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1537974668, "post_id": 52520686, "comment_id": 91981534, "body": "You can&#39;t assign a picture to a chart: you first need to create an empty chart, then paste the picture into it, then export the chart."}, {"owner": {"reputation": 13, "user_id": 10419125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/36cba4e930f686618a1ad225ed3526c4?s=128&d=identicon&r=PG&f=1", "display_name": "zerosdb", "link": "https://stackoverflow.com/users/10419125/zerosdb"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1537976342, "post_id": 52520686, "comment_id": 91982585, "body": "but, if i got the img in a location such as  &quot;preview.image2.picture&quot;, why wouldnt it load?  it&#39;s telling me i have no object ...."}, {"owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "edited": false, "score": 0, "creation_date": 1537982062, "post_id": 52520686, "comment_id": 91985515, "body": "How are you displaying your images on the user form? Are you using an image control or just setting the picture property of user form?"}, {"owner": {"reputation": 13, "user_id": 10419125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/36cba4e930f686618a1ad225ed3526c4?s=128&d=identicon&r=PG&f=1", "display_name": "zerosdb", "link": "https://stackoverflow.com/users/10419125/zerosdb"}, "edited": false, "score": 0, "creation_date": 1537982570, "post_id": 52520686, "comment_id": 91985775, "body": "i&#39;m using Image1.Picture = LoadPicture(&quot;Z:\\Tesoreria\\Documentos Compartidos\\MACRO\\Precisi&#243;n Cash Flow (D&#233;bitos y Cr&#233;ditos).bmp&quot;), (the chart previously got exported to that location and the name depends on the &quot;combobox2&quot;)"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1537983453, "post_id": 52520686, "comment_id": 91986200, "body": "If the image file is located in an accessible location then you could use VBA to copy the file to the user&#39;s local PC."}, {"owner": {"reputation": 13, "user_id": 10419125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/36cba4e930f686618a1ad225ed3526c4?s=128&d=identicon&r=PG&f=1", "display_name": "zerosdb", "link": "https://stackoverflow.com/users/10419125/zerosdb"}, "edited": false, "score": 0, "creation_date": 1537983830, "post_id": 52520686, "comment_id": 91986361, "body": "Hi Tim, how would you do that?, it&#39;s in an accesible location. i tried, and kinda failed XD. so if you got another way i&#39;d love to see it!!!"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1538004637, "post_id": 52520686, "comment_id": 91994326, "body": "<code>FileCopy sourcePath, destinationPath</code>"}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 10419125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/36cba4e930f686618a1ad225ed3526c4?s=128&d=identicon&r=PG&f=1", "display_name": "zerosdb", "link": "https://stackoverflow.com/users/10419125/zerosdb"}, "edited": false, "score": 0, "creation_date": 1537983518, "post_id": 52523142, "comment_id": 91986226, "body": "error in this line  SavePicture UserForm2.Image2.Picture, GetFolder1 &amp; (&quot;\\&quot;) &amp; ComboBox2.Text &amp; &quot;.bmp&quot;"}, {"owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "reply_to_user": {"reputation": 13, "user_id": 10419125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/36cba4e930f686618a1ad225ed3526c4?s=128&d=identicon&r=PG&f=1", "display_name": "zerosdb", "link": "https://stackoverflow.com/users/10419125/zerosdb"}, "edited": false, "score": 0, "creation_date": 1537984424, "post_id": 52523142, "comment_id": 91986612, "body": "<code>UserForm2.Image2</code> needs to be correct names of your userform and the image control on that form."}, {"owner": {"reputation": 13, "user_id": 10419125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/36cba4e930f686618a1ad225ed3526c4?s=128&d=identicon&r=PG&f=1", "display_name": "zerosdb", "link": "https://stackoverflow.com/users/10419125/zerosdb"}, "edited": false, "score": 0, "creation_date": 1537985508, "post_id": 52523142, "comment_id": 91987109, "body": "+ if any1 uses this,    u gotta add the  dim getfolder1 as string"}], "tags": [], "owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "is_accepted": true, "score": 2, "last_activity_date": 1537982598, "creation_date": 1537982598, "answer_id": 52523142, "question_id": 52520686, "link": "https://stackoverflow.com/questions/52520686/export-image-from-a-userfom/52523142#52523142", "title": "export image from a userfom", "body": "<p>Use <code>SavePicture</code> method. No need for Chart when you have the picture loaded in an Image control.</p>\n\n<hr>\n\n<pre><code>Public Sub SavePictureToDisk()\n\n    Dim fldr As FileDialog\n\n    Set fldr = Application.FileDialog(msoFileDialogFolderPicker)\n\n    With fldr\n        .Title = \"Select a Folder\"\n        .AllowMultiSelect = False\n        .InitialFileName = Application.DefaultFilePath\n        If .Show &lt;&gt; -1 Then GoTo NextCode\n\n        GetFolder1 = .SelectedItems(1)\n\n      '/ Here save the ImageControl's picture to disk.\n      SavePicture UserForm2.Image2.Picture, GetFolder1 &amp; (\"\\\") &amp; comboBox2.Text &amp; \".bmp\"\n    End With\n\nNextCode:\n\n    Set fldr = Nothing\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 10419125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/36cba4e930f686618a1ad225ed3526c4?s=128&d=identicon&r=PG&f=1", "display_name": "zerosdb", "link": "https://stackoverflow.com/users/10419125/zerosdb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 43, "favorite_count": 1, "accepted_answer_id": 52523142, "answer_count": 1, "score": 1, "last_activity_date": 1537982626, "creation_date": 1537973700, "last_edit_date": 1537982626, "question_id": 52520686, "link": "https://stackoverflow.com/questions/52520686/export-image-from-a-userfom", "title": "export image from a userfom", "body": "<p>I have a panel control which shows images in a userform generated from charts in the sheet \"chart\". They depend from a combobox2 which has a \"preview\" button that shows the chart's image in full quality in a secondary userform.</p>\n\n<p>What I've been trying to do is make an export button for the user to be able to download the imnage to their PC (since the workbook is in a shared folder) by choosing the path. \n   BUT the issue comes in the image that I'm trying to export. I need a way to get the active picture in the image2 (that is in the second userform) so the user can download it.</p>\n\n<p>Here is what I have up to now, but I get \"nothing\" from the <code>Set oChart</code>, iIneed to fill it somehow with the selected image</p>\n\n<pre><code>Function GetFolder1() As String\n\n    Dim fldr As FileDialog\n    Dim oChart As Chart\n    Dim sitem As String\n\n    Set oChart = Image2.Picture        \n\n    Set fldr = Application.FileDialog(msoFileDialogFolderPicker)\n\n    With fldr\n        .Title = \"Select a Folder\"\n        .AllowMultiSelect = False\n        .InitialFileName = Application.DefaultFilePath\n        If .Show &lt;&gt; -1 Then GoTo NextCode\n\n        GetFolder1 = .SelectedItems(1)\n\n     oChart.Export Filename:=GetFolder1 &amp; (\"\\\") &amp; ComboBox2.Text &amp; (\".bmp\")\n    End With\n\nNextCode:\n\n    Set fldr = Nothing       \nEnd Function\n</code></pre>\n\n<p>(got this code from this webpage)\nthnx!</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 235, "user_id": 4990837, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/10152990063981295/picture?type=large", "display_name": "Gray Meiring", "link": "https://stackoverflow.com/users/4990837/gray-meiring"}, "edited": false, "score": 0, "creation_date": 1538034311, "post_id": 52521697, "comment_id": 92003112, "body": "Thank you so much! It works and I&#39;ve learnt a few things. much appreciated"}], "tags": [], "owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "is_accepted": true, "score": 0, "last_activity_date": 1537976854, "creation_date": 1537976854, "answer_id": 52521697, "question_id": 52520458, "link": "https://stackoverflow.com/questions/52520458/excel-pivot-table-drill-down-to-single-sheet-assistance-with-my-current-code/52521697#52521697", "title": "Excel Pivot Table Drill Down to Single Sheet (assistance with my current code)", "body": "<p>I believe you can meet your 2 requirements by just making changes to the NewSheet event.</p>\n\n<p>I've commented the changes to make this self explanatory(?)</p>\n\n<pre><code>Private Sub Workbook_NewSheet(ByVal Sh As Object)\nIf CS &lt;&gt; \"\" Then\n    With Application\n        ScreenUpdating = False\n        Dim NR&amp;\n        With Sheets(\"DrillDown\")\n\n            'Set this to always start at the top of the page\n            NR = 1\n            '..and to clear the Drilldown tab..\n            .Cells.ClearContents\n\n            'instead of this..\n            '   If WorksheetFunction.CountA(.Rows(1)) = 0 Then\n            '   NR = 1\n            'Else\n            '   NR = .Cells.Find(What:=\"*\", After:=[A1], SearchOrder:=xlByRows, SearchDirection:=xlPrevious).Row + 2\n            'End If\n\n            Range(\"A1\").CurrentRegion.Copy .Cells(NR, 1)\n\n        End With\n        .DisplayAlerts = False\n        ActiveSheet.Delete\n        .DisplayAlerts = True\n        'Below is commented out to stop user being returned to Pivot\n        ' Sheets(CS).Select \n        .ScreenUpdating = True\n        End With\n    End If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 235, "user_id": 4990837, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/10152990063981295/picture?type=large", "display_name": "Gray Meiring", "link": "https://stackoverflow.com/users/4990837/gray-meiring"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 106, "favorite_count": 0, "accepted_answer_id": 52521697, "answer_count": 1, "score": 0, "last_activity_date": 1537976854, "creation_date": 1537973092, "question_id": 52520458, "link": "https://stackoverflow.com/questions/52520458/excel-pivot-table-drill-down-to-single-sheet-assistance-with-my-current-code", "title": "Excel Pivot Table Drill Down to Single Sheet (assistance with my current code)", "body": "<p>Good day,</p>\n\n<p>I have a report with a pivot table in Excel. My manager asked that when she double clicks in the pivot table, that the source data not be on a new sheet every time. Being a VBA noob, I managed to get assistance online, and I have the following code which does work, however I need some help tweaking it to get my desired result. Please could someone assist me.</p>\n\n<p>Current workbook code:  </p>\n\n<pre><code>Private Sub Workbook_NewSheet(ByVal Sh As Object)\nIf CS &lt;&gt; \"\" Then\nWith Application\nScreenUpdating = False\nDim NR&amp;\nWith Sheets(\"DrillDown\")\nIf WorksheetFunction.CountA(.Rows(1)) = 0 Then\nNR = 1\nElse\nNR = .Cells.Find(What:=\"*\", After:=[A1], SearchOrder:=xlByRows, \nSearchDirection:=xlPrevious).Row + 2\nEnd If\nRange(\"A1\").CurrentRegion.Copy .Cells(NR, 1)\nEnd With\n.DisplayAlerts = False\nActiveSheet.Delete\n.DisplayAlerts = True\n Sheets(CS).Select\n.ScreenUpdating = True\nEnd With\nEnd If\nEnd Sub\n\nPrivate Sub Workbook_SheetBeforeDoubleClick(ByVal Sh As Object, ByVal Target \nAs Range, Cancel As Boolean)\nIf ActiveSheet.Name = \"Movement Of Stock\" Then\nCS = \"Movement Of Stock\"\nElseIf ActiveSheet.Name = \"DrillDown\" Then\nIf Not IsEmpty(Target) Then\nIf Target.Row &gt; Range(\"A1\").CurrentRegion.Rows.Count + 1 _\nOr Target.CurrentRegion.Cells(1, 1).Address = \"$A$1\" Then\nCancel = True\nWith Target.CurrentRegion\n.Resize(.Rows.Count + 1).EntireRow.Delete\nEnd With\nEnd If\nEnd If\nEnd If\nEnd Sub\n</code></pre>\n\n<p>Current module code: </p>\n\n<pre><code>Public CS$\n</code></pre>\n\n<p>The current code works fine, and drops the source data into the DrillDown worksheet, and then brings me back to my pivot table. When I double click somewhere else, again it works, and puts that data under the previous with a row separating. </p>\n\n<p>1) What I would like is that every time I double click in the pivot table, any data in the DrillDown worksheet cleared first, and then new data added (in other words, I don't want the data to stack from each double click). </p>\n\n<p>2) The current code also returns the user back to the pivot table after double clicking. I would like to the user to be taken to the DrillDown sheet rather.</p>\n\n<p>Much appreciated for the assistance! </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 0, "creation_date": 1537973734, "post_id": 52520227, "comment_id": 91980947, "body": "you&#39;d use something like <code>Format(Date, &quot;mm.dd.yyyy hh:mm:ss&quot;)</code> to get it to the format listed there"}], "answers": [{"comments": [{"owner": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 1, "creation_date": 1537974355, "post_id": 52520741, "comment_id": 91981348, "body": "you might want to set the year in <code>startDate</code> using <code>Year(Now())</code> so OP doesn&#39;t have to open this again :)"}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": true, "score": 2, "last_activity_date": 1537975006, "last_edit_date": 1537975006, "creation_date": 1537973875, "answer_id": 52520741, "question_id": 52520227, "link": "https://stackoverflow.com/questions/52520227/extract-multiple-html-tables-via-vba/52520741#52520741", "title": "Extract multiple html tables via VBA", "body": "<p>This should give you some ideas in terms of generating the dates in a loop and concatenating into the URL the current date. It also demonstrates how to add new sheets.\nI think there are likely better scraping methods than generating queryTables like this. If you can share HTML for one link (And the lay out is the same for each day) it may be possible to devise a much better approach.</p>\n\n<p>Following on from @Marcucciby2's comment you might also get <code>startdate</code> with something like:  <code>startDate = DateSerial(YEAR(Date), 1, 1)</code></p>\n\n<p>Unless the historic tables are refreshed then you probably only want to run the below once. Then remove the loop and simply have the date generated from <code>dateString = Format$(Date, \"dd.mm.yyyy\")</code>, or <code>Date-1</code> to get the prior day. You mention wanting it to be added automatically; You could tie to a change event that is linked to a cell where you select a date from a drop down. </p>\n\n<pre><code>Option Explicit\nPublic Sub test()\n    Dim url  As String, startDate As Long, endDate As Long, i As Long, dateString As String\n\n    startDate = DateValue(\"2018-01-01\")\n    endDate = CLng(Date)\n\n    For i = startDate To endDate\n        DoEvents\n        dateString = Format$(i, \"dd.mm.yyyy\")\n        url = \"http://www.xyz342.net/abc/date_from=\" &amp; dateString &amp; \" 00:00:00&amp;date_to=\" &amp; dateString &amp; \" 00:00:00&amp;abc=2\"\n        AddQueryTable url, dateString\n    Next\nEnd Sub\n\nPublic Sub AddQueryTable(ByVal url As String, ByVal dateString As String)\n    Dim ws As Worksheet\n    Set ws = ThisWorkbook.Worksheets.Add\n    ws.NAME = dateString\n    On Error Resume Next\n    With ws.QueryTables.Add(Connection:=\"URL;\" &amp; url, Destination:=ws.Range(\"a1\"))\n        .Refresh BackgroundQuery:=False\n        .SaveData = True\n    End With\n    On Error GoTo 0\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 351, "user_id": 5558763, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cdbae96eaf725796f697c739f2cc3f64?s=128&d=identicon&r=PG&f=1", "display_name": "Krypt", "link": "https://stackoverflow.com/users/5558763/krypt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 43, "favorite_count": 0, "accepted_answer_id": 52520741, "answer_count": 1, "score": 0, "last_activity_date": 1537975006, "creation_date": 1537972386, "question_id": 52520227, "link": "https://stackoverflow.com/questions/52520227/extract-multiple-html-tables-via-vba", "title": "Extract multiple html tables via VBA", "body": "<p>I've got a URL like this:</p>\n\n<pre><code>http://www.xyz342.net/abc/date_from=24.05.2018 00:00:00&amp;date_to=24.05.2018 00:00:00&amp;abc=2\n</code></pre>\n\n<p>I've used the following vba code to extract the table into excel:</p>\n\n<pre><code>Sub GetWebTable()\n    With ActiveSheet.QueryTables.Add(Connection:=\"URL;http://www.xyz342.net/abc/date_from=24.05.2018 00:00:00&amp;date_to=24.05.2018 00:00:00&amp;abc=2\", Destination:=Range(\"a1\"))\n    .Refresh BackgroundQuery:=False\n    .SaveData = True\n    End With\nEnd Sub\n</code></pre>\n\n<p><strong>Task:</strong> I want to extract the table for each day of 2018 automatically until today. Therefore the date in that above given URL has to be changed every time <code>(e.g. http://www.xyz342.net/abc/date_from=20.09.2018 00:00:00&amp;date_to=20.09.2018 00:00:00&amp;abc=2 gives the table for 20.09.2018)</code>. How can I do that?</p>\n\n<p>Perfect would be a new worksheet for each day. Every future day should be automatically added.</p>\n"}, {"tags": ["excel", "ms-access", "excel-formula", "vba"], "comments": [{"owner": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 0, "creation_date": 1537973303, "post_id": 52520220, "comment_id": 91980635, "body": "Could you just add the &#39;end of line&#39; anchor <code>$</code> at the end, like this <code>[r|R][f|F][0-9]{9}$</code> ?"}], "answers": [{"comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1537972713, "post_id": 52520303, "comment_id": 91980199, "body": "Agreed. Much more sensible."}, {"owner": {"reputation": 5, "user_id": 9176266, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e9f0ee8d6d0e6e41bfd57f20290305e8?s=128&d=identicon&r=PG&f=1", "display_name": "Vignesh Yalax", "link": "https://stackoverflow.com/users/9176266/vignesh-yalax"}, "edited": false, "score": 0, "creation_date": 1537975323, "post_id": 52520303, "comment_id": 91981930, "body": "Great Thanks. It worked. I changed the entire code though.. :P"}, {"owner": {"reputation": 704, "user_id": 4999393, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae8b5ed2ea0bdebd8989c9122f6c7c22?s=128&d=identicon&r=PG&f=1", "display_name": "Jericho Johnson", "link": "https://stackoverflow.com/users/4999393/jericho-johnson"}, "reply_to_user": {"reputation": 5, "user_id": 9176266, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e9f0ee8d6d0e6e41bfd57f20290305e8?s=128&d=identicon&r=PG&f=1", "display_name": "Vignesh Yalax", "link": "https://stackoverflow.com/users/9176266/vignesh-yalax"}, "edited": false, "score": 2, "creation_date": 1537981365, "post_id": 52520303, "comment_id": 91985181, "body": "@VigneshYalax As a new contributor, you might not realize that since this answer solved your problem, it is customary to &quot;Accept&quot; the answer so that Erik gets credit for helping you, and so that others are helped when searching similar problems."}], "tags": [], "owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "is_accepted": true, "score": 4, "last_activity_date": 1537972580, "creation_date": 1537972580, "answer_id": 52520303, "question_id": 52520220, "link": "https://stackoverflow.com/questions/52520220/vba-regular-expression-matching-pattern/52520303#52520303", "title": "VBA Regular Expression Matching Pattern", "body": "<p>You shouldn't use regex for this at all. A simple <code>Like</code> statement would do.</p>\n\n<p>Just use <code>strinput Like \"RF#########\"</code>. That returns true if it starts with RF (case insensitive) and then has 9 digits, else false.</p>\n"}, {"comments": [{"owner": {"reputation": 5, "user_id": 9176266, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e9f0ee8d6d0e6e41bfd57f20290305e8?s=128&d=identicon&r=PG&f=1", "display_name": "Vignesh Yalax", "link": "https://stackoverflow.com/users/9176266/vignesh-yalax"}, "edited": false, "score": 0, "creation_date": 1537973063, "post_id": 52520311, "comment_id": 91980446, "body": "Hello Thanks for the quick response. It worked but my problem now is I am using two conditions like it can start with number or RF. Below is the code please help me buddy.  Set myrange = Range(&quot;C2:C&quot; &amp; Rng)     For Each c In myrange         strinput = c.Value         patn = &quot;([0-9]{9,10})|([r|R][f|F][0-9]{9})&quot;         If patn &lt;&gt; &quot;&quot; Then             With regex                 .Global = True                 .MultiLine = True                 .IgnoreCase = False                 .Pattern = patn"}, {"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 2, "creation_date": 1537973912, "post_id": 52520311, "comment_id": 91981067, "body": "^^^ Scope creep!"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 5, "user_id": 9176266, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e9f0ee8d6d0e6e41bfd57f20290305e8?s=128&d=identicon&r=PG&f=1", "display_name": "Vignesh Yalax", "link": "https://stackoverflow.com/users/9176266/vignesh-yalax"}, "edited": false, "score": 0, "creation_date": 1537974656, "post_id": 52520311, "comment_id": 91981528, "body": "@VigneshYalax Second method added. It is good practice to state the exact requirement first time in the question to elicit fit for purpose answers."}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": false, "score": 1, "last_activity_date": 1537974137, "last_edit_date": 1537974137, "creation_date": 1537972599, "answer_id": 52520311, "question_id": 52520220, "link": "https://stackoverflow.com/questions/52520220/vba-regular-expression-matching-pattern/52520311#52520311", "title": "VBA Regular Expression Matching Pattern", "body": "<p>Wrap it in boundaries?</p>\n\n<pre><code>\\bRF\\d{9}\\b\n</code></pre>\n\n<p>Try <a href=\"https://regex101.com/r/EGHL4V/1\" rel=\"nofollow noreferrer\">here</a></p>\n\n<p>\\bRF\\d{9}\\b\n/\ngm</p>\n\n<p><code>\\b</code> assert position at a word boundary <code>(^\\w|\\w$|\\W\\w|\\w\\W)</code></p>\n\n<p><code>RF</code> matches the characters RF literally (case sensitive)</p>\n\n<p><code>\\d{9}</code> matches a digit (equal to <code>[0-9]</code>)</p>\n\n<p><code>{9}</code> Quantifier \u2014 Matches exactly 9 times</p>\n\n<p><code>\\b</code> assert position at a word boundary <code>(^\\w|\\w$|\\W\\w|\\w\\W)</code></p>\n\n<hr>\n\n<p>Update:</p>\n\n<p>There are lots of ways to state having a lead of 2 numbers or RF. One might be:</p>\n\n<pre><code>\\b(\\d{2}|RF)\\d{9}\\b\n</code></pre>\n\n<p>Try <a href=\"https://regex101.com/r/C0GWZ3/1\" rel=\"nofollow noreferrer\">it</a>.</p>\n\n<p>Someone more familiar with regex can no doubt advise on efficient regex methods.</p>\n"}, {"comments": [{"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 1, "creation_date": 1537976239, "post_id": 52521134, "comment_id": 91982505, "body": "That&#39;s risky. -5.5 is numeric, but OP doesn&#39;t want to match dots or dashes."}], "tags": [], "owner": {"reputation": 1, "user_id": 10261725, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e9f9561a17c16d06717e17da2049f926?s=128&d=identicon&r=PG&f=1", "display_name": "VBAjake", "link": "https://stackoverflow.com/users/10261725/vbajake"}, "is_accepted": false, "score": 0, "last_activity_date": 1537975631, "last_edit_date": 1537975631, "creation_date": 1537975075, "answer_id": 52521134, "question_id": 52520220, "link": "https://stackoverflow.com/questions/52520220/vba-regular-expression-matching-pattern/52521134#52521134", "title": "VBA Regular Expression Matching Pattern", "body": "<p>You can also use string functions like left() right() len() and isnumeric()</p>\n\n<p><strong>To check that the entire string is 11 characters long (RF + 9 digits) you could use:</strong></p>\n\n<pre><code>If len(yourstring) = 11 then\n</code></pre>\n\n<p><strong>To check that the string starts with RF use:</strong></p>\n\n<pre><code>If left(yourstring,2)=\"RF\" then\n</code></pre>\n\n<p><strong>To check that the last 9 characters are numbers only first dimension a variant:</strong></p>\n\n<pre><code>dim num_check as variant\nnum_check = right(yourstring,9)\nIf isnumeric(num_check) = False then\n</code></pre>\n\n<p>You can nest or combine these if statements to get the desired result.</p>\n"}], "owner": {"reputation": 5, "user_id": 9176266, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e9f0ee8d6d0e6e41bfd57f20290305e8?s=128&d=identicon&r=PG&f=1", "display_name": "Vignesh Yalax", "link": "https://stackoverflow.com/users/9176266/vignesh-yalax"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 316, "favorite_count": 0, "accepted_answer_id": 52520303, "answer_count": 3, "score": 0, "last_activity_date": 1594628438, "creation_date": 1537972365, "last_edit_date": 1594628438, "question_id": 52520220, "link": "https://stackoverflow.com/questions/52520220/vba-regular-expression-matching-pattern", "title": "VBA Regular Expression Matching Pattern", "body": "<p>I have records like RF123456789, RF1234567890 etc.</p>\n\n<p>I just want to match the records which are starting with 'RF' followed by exactly 9 digits of number. If it is more than 9 digit or less than 9 digit It should show Invaid. I have wrote the below code, but the problem with this is , if the number is more than 9 also it is showing valid. I understand that I have written to check only if it starts with RF and followed by 9 digits, so in case of 10 digits it is obviously matching my pattern. Is there any way I could restrict it for only 9 digits rather that 10?</p>\n\n<pre><code>Set myrange = Range(\"C2:C\" &amp; Rng)\nFor Each c In myrange\n    strinput = c.Value\n    patn = \"([r|R][f|F][0-9]{9})\"\n    If patn &lt;&gt; \"\" Then\n        With regex\n            .Global = True\n            .MultiLine = True\n            .IgnoreCase = False\n            .Pattern = patn\n        End With\n        If regex.Test(strinput) Then\n            c.Offset(0, 5) = \"Valid\"\n        Else\n            c.Offset(0, 5) = \"Invalid\"\n        End If\n    End If\n\n    ''checking Column D and E are matching or not''\n    If c.Offset(0, 1) &lt;&gt; \"\" Then\n        If c.Offset(0, 1) = c.Offset(0, 2) Then\n            c.Offset(0, 6) = \"Matching\"\n        Else\n            c.Offset(0, 6) = \"Not Matching\"\n        End If\n    Else\n        c.Offset(0, 6) = \"Empty\"\n    End If\nNext\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 1, "creation_date": 1537972376, "post_id": 52520028, "comment_id": 91979942, "body": "Setting SearchFormat to False just means it will ignore formatting. It will just find the first instance."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 1, "creation_date": 1537972763, "post_id": 52520028, "comment_id": 91980235, "body": "If you want to find non-bold items why not set the format to that!?"}, {"owner": {"reputation": 1, "user_id": 1925590, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9158e56768ccff622840fb65eae3c004?s=128&d=identicon&r=PG", "display_name": "user1925590", "link": "https://stackoverflow.com/users/1925590/user1925590"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1538145917, "post_id": 52520028, "comment_id": 92054058, "body": "Didn&#39;t know you could. Thanks for the tip"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1538148179, "post_id": 52520028, "comment_id": 92055335, "body": "Is your problem actually solved?"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 1925590, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9158e56768ccff622840fb65eae3c004?s=128&d=identicon&r=PG", "display_name": "user1925590", "link": "https://stackoverflow.com/users/1925590/user1925590"}, "edited": false, "score": 0, "creation_date": 1537972688, "post_id": 52520092, "comment_id": 91980169, "body": "Thanks, very informative. I knew about After, but I was assuming that the find format would skip the Bold cell and wrap around back to the beginning. Didn&#39;t realize SearchFormat worked that way. I suppose I could put Found.Select in an If block and test for Bold..."}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 0, "last_activity_date": 1537972372, "last_edit_date": 1537972372, "creation_date": 1537972051, "answer_id": 52520092, "question_id": 52520028, "link": "https://stackoverflow.com/questions/52520028/why-is-my-vba-searchformat-working-backwards/52520092#52520092", "title": "Why is my VBA SearchFormat working backwards?", "body": "<p><em>The correct first element to look after is not passed. And VBA is taking the default one, which is the first, but it starts looking after it.</em></p>\n\n<p>This is some example data, searching for number in columns B:</p>\n\n<p><a href=\"https://i.stack.imgur.com/q9xz5.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/q9xz5.png\" alt=\"enter image description here\"></a></p>\n\n<pre><code>Sub TestMe()\n    Dim myR     As Range\n    Dim myS     As Range\n    Set myS = Range(\"B1:B5\") 'change the range to \"C1:C5\" correspondingly \n    With myS\n        Set myR = .Find(1)\n        Debug.Print myR.Row\n        Set myR = .Find(1, after:=.Cells(.Cells.Count))\n        Debug.Print myR.Row\n    End With\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://msdn.microsoft.com/zh-tw/library/ff839746(v=office.14).aspx\" rel=\"nofollow noreferrer\">This is the \"After\" parameter in MSDN</a>:</p>\n\n<blockquote>\n  <p>The cell after which you want the search to begin. This corresponds to the position of the active cell when a search is done from the user interface. Notice that After must be a single cell in the range. Remember that the search begins after this cell; the specified cell isn\u2019t searched until the method wraps back around to this cell. If you do no specify this argument, the search starts after the cell in the upper-left corner of the range.</p>\n</blockquote>\n\n<p>Thus you give the last cell possible as a start. It knows that it should start After it. So, it theoretically has nothing better to do and simply starts from the beginning of the range. The idea of the After parameter is to set the last value that would be checked. Thus, if we have only one value it is always returned correctly, no matter of the After  parameter. With more than one value, it returns the first value it finds.</p>\n\n<p>Thus, in the code above, because of the usage of After the <code>Range.Find()</code> searches the cells in the following sequence:</p>\n\n<p><strong>B1 > B2 > B3 > B4 > B5</strong></p>\n\n<p>Without the After the sequence is the following:</p>\n\n<p><strong>B2 > B3 > B4 > B5 > B1</strong></p>\n\n<p>It is worthy to run the code with the examples a couple of times. Indeed, the default parameter is not set the way one would expect. I mean, if I give a range and I look into it, I expect to check the first cell first by default. And not to check the first cell last, because it is the default parameter of After, when it is not set.</p>\n"}], "owner": {"reputation": 1, "user_id": 1925590, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9158e56768ccff622840fb65eae3c004?s=128&d=identicon&r=PG", "display_name": "user1925590", "link": "https://stackoverflow.com/users/1925590/user1925590"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 189, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1537972372, "creation_date": 1537971869, "last_edit_date": 1537972222, "question_id": 52520028, "link": "https://stackoverflow.com/questions/52520028/why-is-my-vba-searchformat-working-backwards", "title": "Why is my VBA SearchFormat working backwards?", "body": "<p>Okay, this one has me flabbergasted. I set the FindFormat for Bold, and the SearchFormat to False, so the first non-bold instance of the search string would be selected. But when I leave the Found.Select line in Debug, it\u2019s the bold instance that\u2019s selected! Am I missing something? PS i was previously declared...</p>\n\n<pre><code>Range(Cells(3, 3).Address(), Cells(lRow, 3).Address()).Select\n\nDim cn(0 To 300) As String\nDim Found As Range\nApplication.FindFormat.Font.Bold = True\ni = 0\n\nWith Selection\n\n    For Each Drawing In dn\n            Set Found = .Find(Drawing, SearchFormat:=False)\n            Found.Select\n            ActiveCell.Offset(0, 3).Select\n            cn(i) = ActiveCell.Value\n            i = i + 1\n    Next\n\nEnd With\n</code></pre>\n"}, {"tags": ["excel", "vba", "excel-2007"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1537973869, "post_id": 52519925, "comment_id": 91981026, "body": "I&#39;d use <code>Me</code> instead of <code>Application.ActiveSheet</code> tbh."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1537975330, "post_id": 52519925, "comment_id": 91981937, "body": "You could also use the <a href=\"https://docs.microsoft.com/en-us/office/vba/language/reference/user-interface-help/dateadd-function\" rel=\"nofollow noreferrer\"><code>DateAdd</code> function</a> instead of adding 365 days to <code>Now</code> - won&#39;t cause errors when there&#39;s a leap year."}, {"owner": {"reputation": 1, "user_id": 10419253, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1d9eecce631d0501a96deab2e2f2d77?s=128&d=identicon&r=PG&f=1", "display_name": "fg42pr", "link": "https://stackoverflow.com/users/10419253/fg42pr"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1537978024, "post_id": 52519925, "comment_id": 91983524, "body": "not to worried on the date thing atm. just getting the code to work on multiple pages is my target"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1537978624, "post_id": 52519925, "comment_id": 91983826, "body": "<a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.application.intersect\" rel=\"nofollow noreferrer\"><code>Intersect</code></a> will fail if &quot;one or more ranges from a different worksheet are specified&quot;. Since you&#39;re using the Worksheet_Change event, <code>Target</code> should always be on the <code>ActiveSheet</code> - however, <code>Me</code> is preferable."}], "owner": {"reputation": 1, "user_id": 10419253, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1d9eecce631d0501a96deab2e2f2d77?s=128&d=identicon&r=PG&f=1", "display_name": "fg42pr", "link": "https://stackoverflow.com/users/10419253/fg42pr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 335, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1593645165, "creation_date": 1537971589, "last_edit_date": 1593645165, "question_id": 52519925, "link": "https://stackoverflow.com/questions/52519925/runtime-error-1004-method-intersect-of-object-global-failed", "title": "Runtime Error 1004 Method Intersect&#39; of object _Global failed", "body": "<p>This is my first time posting here. I have been learning how to better myself with excel 2007 slowly through the years. Ive begun using some vb code to help speed up some data entry while out on the job. So I found some code online and began with that. Everything worked perfect until I applied same code to a few more sheets. Now I am getting </p>\n\n<blockquote>\n  <p>Runtime Error '1004':, Method 'Intersect' of object '_Global' failed</p>\n</blockquote>\n\n<p>Here is the basic version I am working with. It varies on different sheets.</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\nDim WorkRng As Range\nDim Rng As Range\nDim xOffsetColumn As Integer\nSet WorkRng = Intersect(Application.ActiveSheet.Range(\"D:D\"), Target)\nxOffsetColumn = 5\nIf Not WorkRng Is Nothing Then\nApplication.EnableEvents = False\nFor Each Rng In WorkRng\n    If Not VBA.IsEmpty(Rng.Value) Then\n        Rng.Offset(0, xOffsetColumn).Value = Now + 365\n        Rng.Offset(0, xOffsetColumn).NumberFormat = \"mm/dd/yyyy\"\n    Else\n        Rng.Offset(0, xOffsetColumn).ClearContents\n    End If\nNext\nApplication.EnableEvents = True\nElse\nSet WorkRng = Intersect(Application.ActiveSheet.Range(\"E:E\"), Target)\nxOffsetColumn = 4\nIf Not WorkRng Is Nothing Then\n   Application.EnableEvents = False\n   For Each Rng In WorkRng\n       If Not VBA.IsEmpty(Rng.Value) Then\n           Rng.Offset(0, xOffsetColumn).Value = Now + 365\n           Rng.Offset(0, xOffsetColumn).NumberFormat = \"mm/dd/yyyy\"\n       Else\n           Rng.Offset(0, xOffsetColumn).ClearContents\n       End If\n   Next\n   Application.EnableEvents = True\n   End If\nEnd If\nEnd Sub\n</code></pre>\n\n<p>This seems to be the problem I believe</p>\n\n<pre><code> Set WorkRng = Intersect(Application.ActiveSheet.Range(\"D:D\"), Target)\n</code></pre>\n\n<p>I'm still pretty green seeing I am self teaching, any help is much appreciated at this point. Thank you</p>\n"}, {"tags": ["excel", "vba", "debugging"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 2, "creation_date": 1537971634, "post_id": 52519888, "comment_id": 91979420, "body": "Put <code>Option Explicit</code> at the top of the module. Then remove the extra underscore from <code>lr__counter</code> everywhere you find it."}, {"owner": {"reputation": 619, "user_id": 4760587, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/234b9dfb72246255b87123719ef464f0?s=128&d=identicon&r=PG", "display_name": "Marek Fekete", "link": "https://stackoverflow.com/users/4760587/marek-fekete"}, "edited": false, "score": 1, "creation_date": 1537971641, "post_id": 52519888, "comment_id": 91979429, "body": "You did notice that you have two underscores in the <code>lr__counter</code> variable name in the <code>Debug.Print()</code> call, right?"}, {"owner": {"reputation": 678, "user_id": 10223558, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8aab0b9efcc3f6ef4d67308d870b1c6b?s=128&d=identicon&r=PG&f=1", "display_name": "L8n", "link": "https://stackoverflow.com/users/10223558/l8n"}, "edited": false, "score": 0, "creation_date": 1537971823, "post_id": 52519888, "comment_id": 91979558, "body": "While we&#39;re at it, try to avoid using underscores. They are used for implementing Interfaces and may cause issues further down the line"}, {"owner": {"reputation": 14442, "user_id": 7475225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/niMZR.jpg?s=128&g=1", "display_name": "Mike - SMT", "link": "https://stackoverflow.com/users/7475225/mike-smt"}, "reply_to_user": {"reputation": 678, "user_id": 10223558, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8aab0b9efcc3f6ef4d67308d870b1c6b?s=128&d=identicon&r=PG&f=1", "display_name": "L8n", "link": "https://stackoverflow.com/users/10223558/l8n"}, "edited": false, "score": 0, "creation_date": 1537972739, "post_id": 52519888, "comment_id": 91980218, "body": "@L8n The underscores are a habit from PEP8. I started out my first language with Python."}, {"owner": {"reputation": 14442, "user_id": 7475225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/niMZR.jpg?s=128&g=1", "display_name": "Mike - SMT", "link": "https://stackoverflow.com/users/7475225/mike-smt"}, "reply_to_user": {"reputation": 619, "user_id": 4760587, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/234b9dfb72246255b87123719ef464f0?s=128&d=identicon&r=PG", "display_name": "Marek Fekete", "link": "https://stackoverflow.com/users/4760587/marek-fekete"}, "edited": false, "score": 0, "creation_date": 1537972760, "post_id": 52519888, "comment_id": 91980232, "body": "@MarekFekete That was it. Not sure how I managed two underscores but that fixed the problem."}], "answers": [{"comments": [{"owner": {"reputation": 14442, "user_id": 7475225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/niMZR.jpg?s=128&g=1", "display_name": "Mike - SMT", "link": "https://stackoverflow.com/users/7475225/mike-smt"}, "edited": false, "score": 1, "creation_date": 1537972824, "post_id": 52519947, "comment_id": 91980270, "body": "I was trying to use <code>On Error GoTo 0</code> but it was not doing anything. Turns out it was the double underscore... Got to love spending hours on a typo..."}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 14442, "user_id": 7475225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/niMZR.jpg?s=128&g=1", "display_name": "Mike - SMT", "link": "https://stackoverflow.com/users/7475225/mike-smt"}, "edited": false, "score": 0, "creation_date": 1537972908, "post_id": 52519947, "comment_id": 91980332, "body": "@Mike-SMT - put <code>Option Explicit</code> on the top of the module, then it would point the typo once you run it."}, {"owner": {"reputation": 14442, "user_id": 7475225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/niMZR.jpg?s=128&g=1", "display_name": "Mike - SMT", "link": "https://stackoverflow.com/users/7475225/mike-smt"}, "edited": false, "score": 1, "creation_date": 1537972982, "post_id": 52519947, "comment_id": 91980391, "body": "That Is good to know I will probably use <code>Option Explicit</code> from now on while developing."}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 14442, "user_id": 7475225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/niMZR.jpg?s=128&g=1", "display_name": "Mike - SMT", "link": "https://stackoverflow.com/users/7475225/mike-smt"}, "edited": false, "score": 0, "creation_date": 1537973033, "post_id": 52519947, "comment_id": 91980424, "body": "@Mike-SMT - almost everyone uses it. It is actually a built-in feature in the VBEditor, see the screenshot."}, {"owner": {"reputation": 14442, "user_id": 7475225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/niMZR.jpg?s=128&g=1", "display_name": "Mike - SMT", "link": "https://stackoverflow.com/users/7475225/mike-smt"}, "edited": false, "score": 0, "creation_date": 1537973220, "post_id": 52519947, "comment_id": 91980560, "body": "@Thanks for the option to add <code>Option Explicit</code> by default but I would rather hard code it so I get in the habit of using it and knowing when to use it."}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": true, "score": 2, "last_activity_date": 1537973167, "last_edit_date": 1537973167, "creation_date": 1537971649, "answer_id": 52519947, "question_id": 52519888, "link": "https://stackoverflow.com/questions/52519888/debug-print-not-printing-the-correct-value-of-a-variable/52519947#52519947", "title": "Debug.Print not printing the correct value of a variable", "body": "<p>Put <code>Option Explicit</code> and see where the code explodes. - <a href=\"https://docs.microsoft.com/en-us/dotnet/visual-basic/language-reference/statements/option-explicit-statement\" rel=\"nofollow noreferrer\">Option Explicit</a></p>\n\n<p>A way to have automatically written <code>Option Explicit</code> is to select \"Require Variable Declaration\" in the <em>VBEditor>Tools>Options</em>:</p>\n\n<p><a href=\"https://i.stack.imgur.com/1ydv4.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/1ydv4.png\" alt=\"enter image description here\"></a></p>\n\n<p>In general, I guess it is here:</p>\n\n<pre><code>lr_counter = inv_wb.Worksheets(7).Cells(Rows.Count, \"A\").End(xlUp).Row\nSet rng1 = inv_wb.Worksheets(7).Range(\"A2:G\" &amp; lr_counter)\nDebug.Print (\"Last Row for G90_CTR_WS: \" &amp; lr__counter)\n</code></pre>\n\n<p><code>lr__counter</code> is with 2 <code>_</code> and is declared with 1.</p>\n"}], "owner": {"reputation": 14442, "user_id": 7475225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/niMZR.jpg?s=128&g=1", "display_name": "Mike - SMT", "link": "https://stackoverflow.com/users/7475225/mike-smt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 498, "favorite_count": 0, "accepted_answer_id": 52519947, "answer_count": 1, "score": 0, "last_activity_date": 1537973167, "creation_date": 1537971447, "last_edit_date": 1537971861, "question_id": 52519888, "link": "https://stackoverflow.com/questions/52519888/debug-print-not-printing-the-correct-value-of-a-variable", "title": "Debug.Print not printing the correct value of a variable", "body": "<p>I have a macro that moves some data around in different spreadsheets and I have been trying to figure out why my <code>Debug.Print</code> is not printing the long data. It prints the string but wont print the long.</p>\n\n<p>The below code does not produce an error message and the data is moved as I would expect it to be however when I try to use a print statement to print to the Immediate window all I get is the string portion of the print.</p>\n\n<p>I have tried to convert to string using <code>CStr()</code> on my long just in case it was a problem with concatenating non-string with string with no change in results. I have tried just printing the long by itself and all it prints is an empty line to the Immediate window.</p>\n\n<p>My question is this:</p>\n\n<p>Is there a reason for my code to not print the long?</p>\n\n<p>I know the results of my MACRO do exactly what I need them to do by manually verify each step with breakpoints but why is Debug.Print not printing the long?</p>\n\n<p>Example results from Debug.Print</p>\n\n<pre><code>Last Row for G90_CTR_WS: \nLast Row for L90_CTR_WS: \nLast Row for BU_WB: \nLast Row for rng1: \nLast Row for rng2: \n</code></pre>\n\n<p>Code:</p>\n\n<pre><code>On Error GoTo 0\nlr_counter = inv_wb.Worksheets(7).Cells(Rows.Count, \"A\").End(xlUp).Row\nSet rng1 = inv_wb.Worksheets(7).Range(\"A2:G\" &amp; lr_counter)\nDebug.Print (\"Last Row for G90_CTR_WS: \" &amp; lr__counter)\n\nlr_counter = inv_wb.Worksheets(6).Cells(Rows.Count, \"A\").End(xlUp).Row\nrng1.Cut Destination:=inv_wb.Worksheets(6).Range(\"A\" &amp; lr_counter + 1)\nDebug.Print (\"Last Row for L90_CTR_WS: \" &amp; lr__counter)\n\ncheck_for_file = Dir(workbook_directory &amp; \"\\*backup*\")\nSet bu_wb = Workbooks.Open(workbook_directory &amp; \"\\\" &amp; check_for_file)\n\nlr_counter = bu_wb.Worksheets(1).Cells(Rows.Count, \"B\").End(xlUp).Row\nSet rng1 = bu_wb.Worksheets(1).Range(\"B2:B\" &amp; lr_counter)\nDebug.Print (\"Last Row for BU_WB: \" &amp; lr__counter)\n\nbu_wb.Close SaveChanges:=False\n\nlr_counter = inv_wb.Worksheets(6).Cells(Rows.Count, \"A\").End(xlUp).Row\nSet rng2 = inv_wb.Worksheets(6).Range(\"A2:A\" &amp; lr_counter)\nDebug.Print (\"Last Row for rng1: \" &amp; lr__counter)\n\ncheck_for_file = Dir(workbook_directory &amp; \"\\*vehicle*list*\")\nSet vl_wb = Workbooks.Open(workbook_directory &amp; \"\\\" &amp; check_for_file)\nlr_counter = vl_wb.Worksheets(1).Cells(Rows.Count, \"I\").End(xlUp).Row\nSet rng3 = vl_wb.Worksheets(1).Range(\"I2:I\" &amp; lr_counter)\nDebug.Print (\"Last Row for rng2: \" &amp; lr__counter)\n</code></pre>\n"}, {"tags": ["vba", "outlook"], "comments": [{"owner": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 0, "creation_date": 1537971404, "post_id": 52519702, "comment_id": 91979278, "body": "Does it print out the <code>saving...</code> debug line?"}, {"owner": {"reputation": 55, "user_id": 6737120, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mtdAg.jpg?s=128&g=1", "display_name": "pawlactb", "link": "https://stackoverflow.com/users/6737120/pawlactb"}, "reply_to_user": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 0, "creation_date": 1537971586, "post_id": 52519702, "comment_id": 91979380, "body": "It does not. Which I find odd because the rule running this script is applied to every message in the inbox."}, {"owner": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 0, "creation_date": 1537971739, "post_id": 52519702, "comment_id": 91979493, "body": "Maybe have it msgbox <code>MItem.Attachments.Count</code> before the loop to make sure that you&#39;re grabbing mails with attachements"}, {"owner": {"reputation": 55, "user_id": 6737120, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mtdAg.jpg?s=128&g=1", "display_name": "pawlactb", "link": "https://stackoverflow.com/users/6737120/pawlactb"}, "reply_to_user": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 0, "creation_date": 1537971956, "post_id": 52519702, "comment_id": 91979657, "body": "I added the msgbox, and nothing is appearing."}, {"owner": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 0, "creation_date": 1537972069, "post_id": 52519702, "comment_id": 91979726, "body": "Are you checking that the function passing this one mail items checks that the messages <i>have</i> attachments first? You could check in this one that the &#39;right&#39; messages are being passed to it by printing the <code>MItem.Subject</code> or something like that"}, {"owner": {"reputation": 55, "user_id": 6737120, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mtdAg.jpg?s=128&g=1", "display_name": "pawlactb", "link": "https://stackoverflow.com/users/6737120/pawlactb"}, "reply_to_user": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 0, "creation_date": 1537972343, "post_id": 52519702, "comment_id": 91979909, "body": "So I added a msgbox with the message subject to the function, and that isn&#39;t appearing either. Is there a reason this rule wouldn&#39;t be calling the script?"}, {"owner": {"reputation": 55, "user_id": 6737120, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mtdAg.jpg?s=128&g=1", "display_name": "pawlactb", "link": "https://stackoverflow.com/users/6737120/pawlactb"}, "reply_to_user": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 0, "creation_date": 1537972588, "post_id": 52519702, "comment_id": 91980104, "body": "I&#39;m using rules to run a script. Is there a better way to do that?"}, {"owner": {"reputation": 55, "user_id": 6737120, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mtdAg.jpg?s=128&g=1", "display_name": "pawlactb", "link": "https://stackoverflow.com/users/6737120/pawlactb"}, "reply_to_user": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 0, "creation_date": 1537973535, "post_id": 52519702, "comment_id": 91980796, "body": "Let us <a href=\"https://chat.stackoverflow.com/rooms/180813/discussion-between-tyler-p-and-marcucciboy2\">continue this discussion in chat</a>."}, {"owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "edited": false, "score": 0, "creation_date": 1537992506, "post_id": 52519702, "comment_id": 91990454, "body": "This post describes attachments not being recognized when a rule runs <a href=\"https://stackoverflow.com/questions/49483298/why-does-attachments-count-return-0-on-incoming-mail-with-attachments\" title=\"why does attachments count return 0 on incoming mail with attachments\">stackoverflow.com/questions/49483298/&hellip;</a>"}, {"owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "edited": false, "score": 0, "creation_date": 1537992618, "post_id": 52519702, "comment_id": 91990499, "body": "This post describes slowing processing so missing information becomes available <a href=\"https://stackoverflow.com/questions/45661919/outlook-run-script-rule-not-triggering-vba-script-for-incoming-messages\" title=\"outlook run script rule not triggering vba script for incoming messages\">stackoverflow.com/questions/45661919/&hellip;</a>"}], "owner": {"reputation": 55, "user_id": 6737120, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mtdAg.jpg?s=128&g=1", "display_name": "pawlactb", "link": "https://stackoverflow.com/users/6737120/pawlactb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 178, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1592942299, "creation_date": 1537970863, "last_edit_date": 1592942299, "question_id": 52519702, "link": "https://stackoverflow.com/questions/52519702/save-emails-with-attachments-outlook-vba-rule", "title": "Save emails with attachments outlook vba rule", "body": "<p>I am trying to have my outlook client save all attachments sent to a shared inbox to disk. Here is the vba function I'm using:</p>\n\n<pre><code>Public Sub CSD_SaveAttachmentsToDisk(MItem As Outlook.MailItem)\n\nDim oAttachment As Outlook.Attachment\nDim sSaveFolder As String\nsSaveFolder = \"C:\\Users\\user\\Documents\\\"\nFor Each oAttachment In MItem.Attachments\n    Debug.Print (\"saving...\")\n    oAttachment.SaveAsFile sSaveFolder &amp; oAttachment.DisplayName\nNext oAttachment\nEnd Sub\n</code></pre>\n\n<p>I'm using outlook 2016, and have a rule which calls this script on all messages. Some guidance in figuring out why the messages aren't saved would be helpful. Thanks in advance.</p>\n\n<p><a href=\"https://i.stack.imgur.com/SoHvc.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/SoHvc.png\" alt=\"Rule settings\"></a></p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1537978105, "post_id": 52519697, "comment_id": 91983558, "body": "It&#39;s not quite clear how these &quot;tag rows&quot; can be identified. Do you know that they&#39;ll always be the same row numbers? So you could put these numbers in an array then loop the array?"}, {"owner": {"reputation": 1, "user_id": 10418659, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/792f0ba1c8b0707b4a6e23c64e757aa1?s=128&d=identicon&r=PG&f=1", "display_name": "JKennedy", "link": "https://stackoverflow.com/users/10418659/jkennedy"}, "reply_to_user": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1538006882, "post_id": 52519697, "comment_id": 91994763, "body": "Yes tag rows will always be the same rows. All tags have a &lt;&lt;...&gt;&gt; format, but I can&#39;t find a way to search for this. I&#39;ll have a go using looped array, thanks."}], "owner": {"reputation": 1, "user_id": 10418659, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/792f0ba1c8b0707b4a6e23c64e757aa1?s=128&d=identicon&r=PG&f=1", "display_name": "JKennedy", "link": "https://stackoverflow.com/users/10418659/jkennedy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 26, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1537978127, "creation_date": 1537970843, "last_edit_date": 1537978127, "question_id": 52519697, "link": "https://stackoverflow.com/questions/52519697/finding-tagnames-from-multiple-rows", "title": "Finding TagNames from multiple rows", "body": "<p>I am attempting to complete a find and replace function through to a word document using a sheet with many separate tables of data. Is it possible to refer to different rows of <code>TagName</code> to return the <code>TagValue</code> in the row immediately underneath?</p>\n\n<p>The code below is able to achieve this in a row 7. But my next table of data begins in row 15. I'm hoping there is an easier option than repeating this code for every table.</p>\n\n<pre><code>For CustCol = 5 To 14\n\n    TagName = .Cells(7, CustCol).Value\n    TagValue = .Cells(8, CustCol).Value\n\n    With WordDoc.Content.Find\n        .Text = TagName\n        .Replacement.Text = TagValue\n        .Wrap = wdFindContinue\n        .Execute Replace:=wdReplaceAll\n    End With\n\nNext CustCol\n</code></pre>\n\n<p>Any help or input would be appreciated!</p>\n"}, {"tags": ["vba", "ms-access"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 2, "creation_date": 1537972627, "post_id": 52519665, "comment_id": 91980120, "body": "Did you copy this from the Query Wizard?  How are you assessing it contains 1 record?"}], "answers": [{"comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1537976362, "post_id": 52520778, "comment_id": 91982597, "body": "If you look at ADO and different arguments for cursor etc, you can use the recordcount property"}], "tags": [], "owner": {"reputation": 1, "user_id": 10419010, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f79f5db2886733c1b9d91997b2257843?s=128&d=identicon&r=PG&f=1", "display_name": "goosie2018", "link": "https://stackoverflow.com/users/10419010/goosie2018"}, "is_accepted": false, "score": 0, "last_activity_date": 1537975384, "last_edit_date": 1537975384, "creation_date": 1537973964, "answer_id": 52520778, "question_id": 52519665, "link": "https://stackoverflow.com/questions/52519665/why-the-recordset-from-vba-just-return-one-record/52520778#52520778", "title": "Why the Recordset from VBA just return one record?", "body": "<p>Thank guys,</p>\n\n<p>This was a very novel question.</p>\n\n<p>Here is the answer.</p>\n\n<p>The RecordCount property does not report the amount of records you have.</p>\n\n<blockquote>\n  <p>The value of the RecordCount property equals the number of records\n  that have actually been accessed. For example, when you first create a\n  dynaset or snapshot, you have accessed (or visited) only one record.\n  If you check the RecordCount property immediately after creating the\n  dynaset or snapshot (assuming it has at least one record), the value\n  is 1. To visit all the records, use the MoveLast method immediately\n  after opening the Recordset, and then use MoveFirst to return to the\n  first record. This is not done automatically because it may be slow,\n  especially for large result sets.</p>\n  \n  <p><a href=\"https://docs.microsoft.com/en-us/office/vba/access/concepts/data-access-objects/count-the-number-of-records-in-a-dao-recordset\" rel=\"nofollow noreferrer\">Count the number of records in a DAO Recordset</a></p>\n</blockquote>\n\n<p>Thanks!!!</p>\n"}, {"tags": [], "owner": {"reputation": 123, "user_id": 10026099, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mPOUv.jpg?s=128&g=1", "display_name": "QuanTn", "link": "https://stackoverflow.com/users/10026099/quantn"}, "is_accepted": false, "score": 0, "last_activity_date": 1600671716, "last_edit_date": 1600671716, "creation_date": 1600671118, "answer_id": 63987429, "question_id": 52519665, "link": "https://stackoverflow.com/questions/52519665/why-the-recordset-from-vba-just-return-one-record/63987429#63987429", "title": "Why the Recordset from VBA just return one record?", "body": "<p>Add following statement :</p>\n<pre><code>rvivienda.MoveNext \n</code></pre>\n<p>will return the next record of the recordset\nor :</p>\n<pre><code>rvivienda.MoveLast\n</code></pre>\n<p>will return the last record of the recordset</p>\n<p>You will see the result.</p>\n<p>The <a href=\"https://stackoverflow.com/a/52520778/10026099\">goosie2018's answer</a> is CORRECT. I just show you the simple way to understand.</p>\n<p><strong>SUMMARY</strong></p>\n<p>So, I think the recordset you get from the database will not show the result look like an Array or a List, but a cursor. And the default cursor points to the first row, so if you use :</p>\n<pre><code>rvivienda.RecordCount\n</code></pre>\n<p>you should receive the number of records you actually got.</p>\n<p>Sorry for my English ! And thanks for reading.</p>\n"}], "owner": {"reputation": 1, "user_id": 10419010, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f79f5db2886733c1b9d91997b2257843?s=128&d=identicon&r=PG&f=1", "display_name": "goosie2018", "link": "https://stackoverflow.com/users/10419010/goosie2018"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 537, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1600671716, "creation_date": 1537970769, "last_edit_date": 1537972443, "question_id": 52519665, "link": "https://stackoverflow.com/questions/52519665/why-the-recordset-from-vba-just-return-one-record", "title": "Why the Recordset from VBA just return one record?", "body": "<p>I have 3 tables, \"persons\", \"per_resi\" and \"residence\"\nThis three tables form a many to many relation.</p>\n\n<p>Table \"person\" fields:  id, name etc....</p>\n\n<p>Table \"residence\" fields: id, Street etc.....</p>\n\n<p>Table \"per_resi\" fields: person_id and residence_id  (together principal index)</p>\n\n<p>Well, the problem is when I design a query in the graphic Access tool it Works as it should be.</p>\n\n<p><img src=\"https://i.stack.imgur.com/s4DQT.jpg\" alt=\"enter image description here\"></p>\n\n<p>But if I do in VBA it only return 1 record.</p>\n\n<pre><code>Dim svivienda As String\nDim rvivienda As Recordset\n\nsvivienda = \"SELECT tbl_persona.Id, tbl_vivienda.Calle, tbl_vivienda.Numero \" _\n          &amp; \"FROM tbl_vivienda INNER JOIN (tbl_persona INNER JOIN tbl_perso_viv ON tbl_persona.Id = tbl_perso_viv.Id_persona) \" _\n          &amp; \"ON tbl_vivienda.Id = tbl_perso_viv.Id_vivienda WHERE tbl_persona.Id = \" &amp; 168 &amp; \";\"\n\nSet rvivienda = CurrentDb.OpenRecordset(svivienda, dbOpenDynaset)\n</code></pre>\n\n<p>I have tried LEFT JOIN and RIGHT JOIN but always the same just one record on the recordset.</p>\n\n<p>Any ideas?</p>\n\n<p>MS access 2013</p>\n\n<p>Thanks in advance.</p>\n"}, {"tags": ["excel", "vba", "formula"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 4, "creation_date": 1537969580, "post_id": 52519143, "comment_id": 91978065, "body": "Why not just use neighbouringCell=&quot;&lt;&quot; as your conditional formatting rule? Use relative references."}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 10261725, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e9f9561a17c16d06717e17da2049f926?s=128&d=identicon&r=PG&f=1", "display_name": "VBAjake", "link": "https://stackoverflow.com/users/10261725/vbajake"}, "is_accepted": false, "score": 0, "last_activity_date": 1537978771, "creation_date": 1537978771, "answer_id": 52522208, "question_id": 52519143, "link": "https://stackoverflow.com/questions/52519143/highlighting-cells-depend-of-other-cell-content/52522208#52522208", "title": "Highlighting cells depend of other cell content", "body": "<p>I don't know that conditional formatting can get you there as I don't believe it accepts relative references. </p>\n\n<p>You will likely need to use VBA</p>\n\n<p>With little information provided I'll just assume there are 10 rows and you want to highlight column 2 based on column 1 in Sheet1:</p>\n\n<pre><code>for i = 1 to 10\n    if Sheet1.cells(i,1).value = \"&lt;\" then\n        Sheet1.cells(i,2).interior.color = vbyellow\n    end if\nnext i\n</code></pre>\n\n<p>Hope this helps</p>\n"}], "owner": {"reputation": 1, "user_id": 10418344, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e23ae763a02325c399e310e6162018bb?s=128&d=identicon&r=PG&f=1", "display_name": "jakubsz", "link": "https://stackoverflow.com/users/10418344/jakubsz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 27, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1537978771, "creation_date": 1537969213, "last_edit_date": 1537969508, "question_id": 52519143, "link": "https://stackoverflow.com/questions/52519143/highlighting-cells-depend-of-other-cell-content", "title": "Highlighting cells depend of other cell content", "body": "<p>I am still trying to solve my problem: <a href=\"https://stackoverflow.com/questions/52516361/clear-cell-contents-depend-on-other-cell-content?noredirect=1#comment91972528_52516361\">Clear Cell contents depend on other cell content</a></p>\n\n<p>However, this time I was thinking if is possible to highlight cells depending on what is in another cell.</p>\n\n<p>Imagine I have two columns, one with symbol \"N\" or \"&lt;\", and the other column with values. I need a way to mark all the values where \"&lt;\" is in neigbouring cell. </p>\n\n<p>I hope I not overcomplicate this:) Thank you for your time.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1537968528, "post_id": 52518844, "comment_id": 91977413, "body": "What have you tried so far? Share your latest code attempt. Also, you have not found the time to credit any of answers you got here to your previous posts here. I&#39;m sure you can find the time to give credit to people that spent time to answer your questions."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 1, "creation_date": 1537968567, "post_id": 52518844, "comment_id": 91977439, "body": "Echoing the previous comment, please see <a href=\"https://meta.stackoverflow.com/questions/284236/why-is-can-someone-help-me-not-an-actual-question\">Why is &quot;Can someone help me&quot; not an actual question?</a>."}, {"owner": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "edited": false, "score": 0, "creation_date": 1537968941, "post_id": 52518844, "comment_id": 91977663, "body": "Oooooo This is fun. So there are tons of different ways to approach your issue. Since you&#39;re looking for code, ill explain what you need to teach yourself to get there: 1.Looping through Ranges 2. Referring to cell value that corresponds to the current position of the loop. 3.Setting a cell value in a worksheet. 4. Bonus points if you &quot;Store range in an array&quot; and process it that way. I have provided you with enough stuff that you should be able to google yourself into something that works easily."}, {"owner": {"reputation": 3, "user_id": 9209157, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3e52083ce5b25356eb51cee3286bd2da?s=128&d=identicon&r=PG&f=1", "display_name": "Aditya Roy", "link": "https://stackoverflow.com/users/9209157/aditya-roy"}, "edited": false, "score": 0, "creation_date": 1537970292, "post_id": 52518844, "comment_id": 91978532, "body": "Above is the code that I have written. However, when I run the code, it will paste the text &quot;done&quot; in the entire range. I want to paste the value only on the concern cell. it would be great if you could kindly solve it."}], "owner": {"reputation": 3, "user_id": 9209157, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3e52083ce5b25356eb51cee3286bd2da?s=128&d=identicon&r=PG&f=1", "display_name": "Aditya Roy", "link": "https://stackoverflow.com/users/9209157/aditya-roy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 41, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1537979228, "creation_date": 1537968204, "last_edit_date": 1537979228, "question_id": 52518844, "link": "https://stackoverflow.com/questions/52518844/paste-value-using-multiple-loops", "title": "Paste value using multiple loops", "body": "<p>I have a dataset where <code>range(\"B1:L1\")</code> contains dates and <code>range(\"A2:A10\")</code> contains names. </p>\n\n<p><code>Range(\"O5\")</code> contain the <code>concern date</code> and <code>range(\"O6\")</code> contain the <code>concern name</code>. </p>\n\n<p>I want to search <code>range(\"O5\")</code> date in <code>range(\"B1:L1\")</code> and <code>range(\"O6\")</code>name in <code>range(\"A2:A10\")</code> and if criterias met then enter text <code>\"done\"</code> in the concern cell only. </p>\n\n<p>For example if the <code>concern date</code> is in <code>D1</code> and concern name is in <code>A6</code> then text should be pasted in <code>D6</code>. </p>\n\n<p>Can someone please help me with the code?  </p>\n\n<hr>\n\n<p><strong>Code</strong></p>\n\n<hr>\n\n<pre><code>Sub Status()\n    Worksheets(\"Sheet1\").Select\n    For Each cel In Range(\"B1:L1\")\n        For Each zzz In Range(\"A2:A10\")\n            If cel.Value = Range(\"O5\").Value And zzz.Value = Range(\"O6\").Value Then\n                Range(cel, zzz).Select\n                Selection = \"Done\"\n            End If\n        Next zzz\n    Next cel\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-access"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1537967922, "post_id": 52518700, "comment_id": 91976985, "body": "What data type is &quot;no&quot;?  Looks like a string, so will need to be like <code>&quot;test123&quot;</code>"}, {"owner": {"reputation": 389, "user_id": 9098538, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/d5863ffca9fd9167d26eb2233bc2cd6f?s=128&d=identicon&r=PG&f=1", "display_name": "Shadyjunior", "link": "https://stackoverflow.com/users/9098538/shadyjunior"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1537968847, "post_id": 52518700, "comment_id": 91977607, "body": "Both &quot;ItemNo&quot; &amp; &quot;No&quot; are text type."}, {"owner": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "edited": false, "score": 0, "creation_date": 1537969052, "post_id": 52518700, "comment_id": 91977740, "body": "It also appears you never set ItemNo in the code. Is this variable being set somewhere?"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1537969495, "post_id": 52518700, "comment_id": 91978012, "body": "@R.Langdell so you will need parenthesis as my example"}], "answers": [{"comments": [{"owner": {"reputation": 389, "user_id": 9098538, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/d5863ffca9fd9167d26eb2233bc2cd6f?s=128&d=identicon&r=PG&f=1", "display_name": "Shadyjunior", "link": "https://stackoverflow.com/users/9098538/shadyjunior"}, "edited": false, "score": 0, "creation_date": 1537968914, "post_id": 52518788, "comment_id": 91977647, "body": "I have tried this but to no success. When I have tried;  DoCmd.OpenForm &quot;MAINProductInformation&quot;, , , &quot;NoCode =&quot; &amp; ItemNo  But it keeps returning &quot;Enter Parameter Value&quot;"}, {"owner": {"reputation": 11170, "user_id": 726127, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/TA0YX.jpg?s=128&g=1", "display_name": "Brad", "link": "https://stackoverflow.com/users/726127/brad"}, "edited": false, "score": 0, "creation_date": 1537984636, "post_id": 52518788, "comment_id": 91986697, "body": "I assume <code>ItemNo</code> is a control"}], "tags": [], "owner": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "is_accepted": false, "score": 0, "last_activity_date": 1537968957, "last_edit_date": 1537968957, "creation_date": 1537968043, "answer_id": 52518788, "question_id": 52518700, "link": "https://stackoverflow.com/questions/52518700/access-goto-record-not-finding-record-correctly/52518788#52518788", "title": "Access: GoTo Record Not finding record correctly", "body": "<p>change too:</p>\n\n<pre><code> LintelID = DLookup(\"ID\", \"ImportProductAndTypes\", \"No ='\" &amp; ItemNo &amp; \"'\")\n</code></pre>\n\n<p>It also appears you never set ItemNo in the code. Is this variable being set somewhere?</p>\n"}], "owner": {"reputation": 389, "user_id": 9098538, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/d5863ffca9fd9167d26eb2233bc2cd6f?s=128&d=identicon&r=PG&f=1", "display_name": "Shadyjunior", "link": "https://stackoverflow.com/users/9098538/shadyjunior"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 38, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1537968957, "creation_date": 1537967781, "question_id": 52518700, "link": "https://stackoverflow.com/questions/52518700/access-goto-record-not-finding-record-correctly", "title": "Access: GoTo Record Not finding record correctly", "body": "<p>The first form table that you can see is translating data from a query.</p>\n\n<p><a href=\"https://i.stack.imgur.com/BcS4x.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/BcS4x.png\" alt=\"enter image description here\"></a></p>\n\n<p>On the click of the button to the left side of the table, the code is as follows;</p>\n\n<pre><code>Private Sub btnProductInfo_Click()\nOn Error GoTo Err_mySUB\n'---------------------'\n\n        Dim LintelID As String\n\n        LintelID = DLookup(\"ID\", \"ImportProductAndTypes\", \"No =\" &amp; ItemNo)\n\n         'DoCmd.OpenForm \"MAINProductInformation\", , , \"NoCode =\" &amp; Chr(34) &amp; Me.ItemNo &amp; Chr(34), acFormEdit\n\n'---------------------'\nExit_mySUB:\n    Exit Sub\nErr_mySUB:\n    MsgBox Err.Number &amp; \": \" &amp; Err.Description &amp; \" (\" &amp; Erl &amp; \")\"\n    Resume Exit_mySUB\nEnd Sub\n</code></pre>\n\n<p>I started off with the DoCmd.OpenForm function first which takes the text value of the ItemNo (Item Code) column of the query and then is supposed to open the form \"MAINProductInformation\" on the record which uses the code of the one referenced.</p>\n\n<p>This was not working as expected so I decided to add an ID column to the table \"ImportProductAndTypes\" in which the form being opened would need to reference to go to the record. What I was finding is that for whatever reason the item is not being found within the table even though the value is in there...</p>\n\n<p><a href=\"https://i.stack.imgur.com/HPcLD.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/HPcLD.png\" alt=\"enter image description here\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/zXmQM.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/zXmQM.png\" alt=\"enter image description here\"></a></p>\n\n<p>Please help as I am at such a loss here!!!</p>\n"}, {"tags": ["excel", "vba", "text", "alignment", "edit"], "comments": [{"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 1, "creation_date": 1537967150, "post_id": 52518410, "comment_id": 91976456, "body": "Can you mention how the cells are formatted? E.g. select the cell and press CTRL+1?"}], "owner": {"reputation": 11, "user_id": 8065978, "user_type": "registered", "profile_image": "https://graph.facebook.com/10213139388987775/picture?type=large", "display_name": "Hunter Stephenson", "link": "https://stackoverflow.com/users/8065978/hunter-stephenson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 26, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1537967106, "creation_date": 1537966964, "last_edit_date": 1537967106, "question_id": 52518410, "link": "https://stackoverflow.com/questions/52518410/excel-edit-inside-a-cell-aligns-content-left-instead-of-center", "title": "Excel &quot;Edit Inside a Cell&quot; Aligns Content Left Instead of Center", "body": "<p>I have an issue with software I have been creating in Excel. At a random point when creating the software, all of the cells are now left aligning temporarily when being edited inside of the cell, rather than maintaining their alignment. Take a look at the attached GIF. Has anyone seen this before? </p>\n\n<p>Why is it that when a new excel file is created, the desired behavior occurs? (text maintains its alignment while being edited)</p>\n\n<p><a href=\"https://i.stack.imgur.com/Z6h59.gif\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Z6h59.gif\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 22957, "user_id": 78522, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3facb4a672d9fbeb9f2ed6b5acc65633?s=128&d=identicon&r=PG", "display_name": "Patrick Honorez", "link": "https://stackoverflow.com/users/78522/patrick-honorez"}, "edited": false, "score": 0, "creation_date": 1537966426, "post_id": 52517911, "comment_id": 91975982, "body": "Why don&#39;t you just autofilter then copy the visible rows ?"}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 10418743, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bfd6dd714de0b8c1701498f513d6afda?s=128&d=identicon&r=PG", "display_name": "SuzyT", "link": "https://stackoverflow.com/users/10418743/suzyt"}, "edited": false, "score": 0, "creation_date": 1537968218, "post_id": 52518116, "comment_id": 91977206, "body": "Hi there, thanks for your response. I copied and pasted the code above and got an error . Not sure what this means, are you able to help me resolve it so i can run it and see if it works?"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 11, "user_id": 10418743, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bfd6dd714de0b8c1701498f513d6afda?s=128&d=identicon&r=PG", "display_name": "SuzyT", "link": "https://stackoverflow.com/users/10418743/suzyt"}, "edited": false, "score": 1, "creation_date": 1537968545, "post_id": 52518116, "comment_id": 91977425, "body": "@SuzyT - this is because there is no worksheet called <code>Tracked</code>. Take a look and change <code>Tracked</code> to <code>Tracker</code> or vice versa."}, {"owner": {"reputation": 11, "user_id": 10418743, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bfd6dd714de0b8c1701498f513d6afda?s=128&d=identicon&r=PG", "display_name": "SuzyT", "link": "https://stackoverflow.com/users/10418743/suzyt"}, "edited": false, "score": 0, "creation_date": 1537976466, "post_id": 52518116, "comment_id": 91982655, "body": "Great, thank you. Thats worked and i think the problem has been solved. Thanks very much :)"}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 0, "last_activity_date": 1537968558, "last_edit_date": 1537968558, "creation_date": 1537966033, "answer_id": 52518116, "question_id": 52517911, "link": "https://stackoverflow.com/questions/52517911/vba-code-to-transfer-only-flagged-rows-of-data-from-one-excel-worksheet-to-anoth/52518116#52518116", "title": "VBA code to transfer only flagged rows of data from one excel worksheet to another", "body": "<p>Try this, you need to declare 2 last rows, for the two worksheets. It is not tested, but it could work:</p>\n\n<pre><code>Option Explicit\n\nPrivate Sub Workbook_Open()\n\n    Dim i&amp;, LastRow&amp;, LastRowTracker&amp;\n\n    LastRow = Worksheets(\"Master\").Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n    LastRowTracker = Worksheets(\"Tracked\").Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n    Sheets(\"Tracked\").Range(\"A13:BN25782\").ClearContents\n\n    For i = 13 To LastRow\n        If Sheets(\"Master\").Cells(i, \"F\").Value = \"Yes\" Then\n            LastRowTracker = LastRowTracker + 1\n            Sheets(\"Master\").Cells(i, \"F\").EntireRow.Copy _\n                Destination:=Sheets(\"Tracked\").Cells(LastRowTracker, \"A\")\n        End If\n    Next i\n\nEnd Sub\n</code></pre>\n\n<p>As you are looping through the <code>Master</code>, the <code>LastRowTracker</code> is incremented only if it gets into the <code>If</code> conditon.</p>\n"}], "owner": {"reputation": 11, "user_id": 10418743, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bfd6dd714de0b8c1701498f513d6afda?s=128&d=identicon&r=PG", "display_name": "SuzyT", "link": "https://stackoverflow.com/users/10418743/suzyt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 132, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1537968558, "creation_date": 1537965365, "last_edit_date": 1537965834, "question_id": 52517911, "link": "https://stackoverflow.com/questions/52517911/vba-code-to-transfer-only-flagged-rows-of-data-from-one-excel-worksheet-to-anoth", "title": "VBA code to transfer only flagged rows of data from one excel worksheet to another", "body": "<p>I have a RACI matrix in excel which captures lots of tasks, issues and decisions that need to be made about a project im working on, but my project manager only wants to track a few of the items on it. I have a column in in the master that flags these rows. </p>\n\n<p>What i want to do, is that each time the workbook is opened a macro runs in the background that updates that tracker and displays all the columns of data but only the rows of data that have been flagged.</p>\n\n<p>The master worksheet is called: Master \nThe tracker worksheet is called \"Tracked\"</p>\n\n<p>I have managed to partially complete this task using the following VBA code, but when I view the tracker worksheet some of the rows of data are not below the column headers but are at the top of the page and some are underneath the headers (see screenshot). Would appreciate any guidance to fix this so the rows of data only start populating in the free rows underneath the column headers in the tracker worksheet</p>\n\n<pre><code>Private Sub Workbook_Open()\nDim i, LastRow\nLastRow = Sheets(\"Master\").Range(\"A\" &amp; Rows.Count).End(xlUp).Row\nSheets(\"Tracked\").Range(\"A13:BN25782\").ClearContents\nFor i = 13 To LastRow\nIf Sheets(\"Master\").Cells(i, \"F\").Value = \"Yes\" Then\nSheets(\"Master\").Cells(i, \"F\").EntireRow.Copy Destination:=Sheets(\"Tracked\").Range(\"A13\").End(xlUp).Offset(1)\nEnd If\nNext i\nEnd Sub\n</code></pre>\n\n<p>Tracker worksheet:\n<img src=\"https://i.stack.imgur.com/Av7Hp.png\" alt=\"image of code output in tracker worksheet\"></p>\n"}, {"tags": ["vba", "ms-word"], "comments": [{"owner": {"reputation": 2812, "user_id": 7177346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3606be407227771ae3f6077af6a801e5?s=128&d=identicon&r=PG", "display_name": "freeflow", "link": "https://stackoverflow.com/users/7177346/freeflow"}, "edited": false, "score": 0, "creation_date": 1537964499, "post_id": 52517458, "comment_id": 91974747, "body": "You have the .Format option set to True so you are instructing the Find/Replace to copy formatting. Try setting it to false."}, {"owner": {"reputation": 1, "user_id": 10418476, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-D5Ui1NGcdYQ/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DVLYXofo-4DcgphXTv4MezWoO_hbQ/mo/photo.jpg?sz=128", "display_name": "Sash", "link": "https://stackoverflow.com/users/10418476/sash"}, "reply_to_user": {"reputation": 2812, "user_id": 7177346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3606be407227771ae3f6077af6a801e5?s=128&d=identicon&r=PG", "display_name": "freeflow", "link": "https://stackoverflow.com/users/7177346/freeflow"}, "edited": false, "score": 0, "creation_date": 1537967227, "post_id": 52517458, "comment_id": 91976500, "body": "Yeah sorry this was false earlier and I changed it to True as I was experimenting with defining a format, but this was ignored as well by the code. thanks"}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1537975593, "post_id": 52517458, "comment_id": 91982106, "body": "Look in File/Options/Advanced, at the &quot;Cut, copy and paste&quot; section. You should see &quot;Pasting from other program&quot; in the list of options. Try &quot;Keep text only&quot; as the setting. If that doesn&#39;t help, you may also want to look at the &quot;User smart cut and paste&quot; settings. If all else fails, you&#39;ll need to do each Find/Replace separately, in a loop."}, {"owner": {"reputation": 9249, "user_id": 9170274, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BrcC8.jpg?s=128&g=1", "display_name": "macropod", "link": "https://stackoverflow.com/users/9170274/macropod"}, "edited": false, "score": 0, "creation_date": 1538011519, "post_id": 52517458, "comment_id": 91995801, "body": "There is nothing about your code to indicate how Excel is involved in either a single replacement or via Find/Replace with Replace All. That said, if you&#39;ve copied some formatted content to the clipboard and you&#39;re using that with the ^c replace expression, as your macro suggests, then it&#39;s the formatted content that will be output, regardless of whether you have .Format = True. For some generalised code to use an Excel workbook as the data source for a series of Find/Replace actions, see: <a href=\"http://www.msofficeforums.com/word-vba/22669-created-vba-find-replace-body-header-footer.html#post70404\" rel=\"nofollow noreferrer\">msofficeforums.com/word-vba/&hellip;</a>"}, {"owner": {"reputation": 1, "user_id": 10418476, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-D5Ui1NGcdYQ/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DVLYXofo-4DcgphXTv4MezWoO_hbQ/mo/photo.jpg?sz=128", "display_name": "Sash", "link": "https://stackoverflow.com/users/10418476/sash"}, "edited": false, "score": 0, "creation_date": 1538043404, "post_id": 52517458, "comment_id": 92008461, "body": "Macropod  Thanks for your help. The VBA word script opens a spreadsheet, filters based on a primary key and copies certain cell and pastes in word document in several places from clipboard."}, {"owner": {"reputation": 1, "user_id": 10418476, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-D5Ui1NGcdYQ/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DVLYXofo-4DcgphXTv4MezWoO_hbQ/mo/photo.jpg?sz=128", "display_name": "Sash", "link": "https://stackoverflow.com/users/10418476/sash"}, "edited": false, "score": 0, "creation_date": 1538043879, "post_id": 52517458, "comment_id": 92008735, "body": "Cindy Meister Thanks for the response. I tried both under settings and this did not help. I was thinking of doing a loop but not my strong suit. can you get me started? I have updated the code above which works fine as it only does one instance of replace and obeys the destination formatting."}], "answers": [{"tags": [], "owner": {"reputation": 13, "user_id": 10869491, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-240ioPcJYRA/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcaPJI2MtMdrSG7nrE1JKWSQkA02gA/mo/photo.jpg?sz=128", "display_name": "Wayne Whittenberg", "link": "https://stackoverflow.com/users/10869491/wayne-whittenberg"}, "is_accepted": false, "score": 0, "last_activity_date": 1547673569, "creation_date": 1547673569, "answer_id": 54225545, "question_id": 52517458, "link": "https://stackoverflow.com/questions/52517458/use-replaceall-in-find-replace-but-drop-the-source-format/54225545#54225545", "title": "Use ReplaceAll in find/replace, but drop the source format", "body": "<p>The simplest way would be to define a range object prior to executing your code such as:</p>\n\n<pre><code>set rng = Selection.FormattedText\n</code></pre>\n\n<p>Then after doing a ReplaceAll, select the range and apply any style you want such as:</p>\n\n<pre><code>rng.Select\nSelection.Style = ActiveDocument.Styles(\"Normal\")\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 10418476, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-D5Ui1NGcdYQ/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DVLYXofo-4DcgphXTv4MezWoO_hbQ/mo/photo.jpg?sz=128", "display_name": "Sash", "link": "https://stackoverflow.com/users/10418476/sash"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 200, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1592387613, "creation_date": 1537963815, "last_edit_date": 1592387613, "question_id": 52517458, "link": "https://stackoverflow.com/questions/52517458/use-replaceall-in-find-replace-but-drop-the-source-format", "title": "Use ReplaceAll in find/replace, but drop the source format", "body": "<p>I need some help. I have some code which copies a filtered range from an Excel worksheet and pastes it in Word in various locations, replacing a specific word. The issue is when I don't use <code>wdReplaceAll</code> it seems to paste the value using the destination format (one time). However when I use ReplaceAll the source Excel format is included, which I don't want. Now I have tried insisting on a specific format with ReplaceAll which did not work but frankly I would prefer destination format. Can anyone help?:</p>\n\n<pre><code>Selection.Find.ClearFormatting\nSelection.Find.Replacement.ClearFormatting\nWith Selection.Find\n    .Text = \"What\"\n    .Replacement.Text = \"^c\"\n    .Forward = True\n    .Wrap = wdFindContinue\n    .Format = False\n    .MatchCase = True\n    .MatchWholeWord = False\n    .MatchWildcards = False\n    .MatchSoundsLike = False\n    .MatchAllWordForms = False\nEnd With\nSelection.Find.Execute\nSelection.PasteAndFormat (wdFormatPlainText)\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "edited": false, "score": 2, "creation_date": 1537963027, "post_id": 52516715, "comment_id": 91973808, "body": "You can use a <a href=\"https://docs.microsoft.com/en-us/sql/odbc/microsoft/schema-ini-file-text-file-driver?view=sql-server-2017\" rel=\"nofollow noreferrer\">schema file</a> to describe the fields of your text resp. csv file. But I would suggest to use <a href=\"https://support.office.com/en-us/article/get-transform-in-excel-881c63c6-37c5-4ca2-b616-59e18d75b4de\" rel=\"nofollow noreferrer\">Get &amp; Transform</a> instead"}, {"owner": {"reputation": 11, "user_id": 10418188, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/19d5df0638d1c2472ce8ef255cc4a6db?s=128&d=identicon&r=PG&f=1", "display_name": "Killuminati", "link": "https://stackoverflow.com/users/10418188/killuminati"}, "reply_to_user": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "edited": false, "score": 0, "creation_date": 1537963839, "post_id": 52516715, "comment_id": 91974323, "body": "I&#39;m not familiar with schema.ini. Do I literally just create the file and leave it in the same folder? Get &amp; Transform has been painstakingly slow, this worked wonders one generic number IDs."}, {"owner": {"reputation": 11, "user_id": 10418188, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/19d5df0638d1c2472ce8ef255cc4a6db?s=128&d=identicon&r=PG&f=1", "display_name": "Killuminati", "link": "https://stackoverflow.com/users/10418188/killuminati"}, "reply_to_user": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "edited": false, "score": 0, "creation_date": 1537964310, "post_id": 52516715, "comment_id": 91974624, "body": "Just had a whirl with schema.ini, worked like a charm @Storax! Thank you, you should have posted this as an answer!"}, {"owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "edited": false, "score": 0, "creation_date": 1537964424, "post_id": 52516715, "comment_id": 91974693, "body": "No Problem, but it would be great if you posted your solution now for all the others who might be also in need of this."}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1537966999, "post_id": 52516715, "comment_id": 91976357, "body": "Your post <code>SELECT * FROM [file] WHERE CStr(ID) = 34897562FD</code> wouldn&#39;t work as it would need to be <code>SELECT * FROM [file] WHERE CStr(ID) = &#39;34897562FD&#39;</code>"}, {"owner": {"reputation": 11, "user_id": 10418188, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/19d5df0638d1c2472ce8ef255cc4a6db?s=128&d=identicon&r=PG&f=1", "display_name": "Killuminati", "link": "https://stackoverflow.com/users/10418188/killuminati"}, "edited": false, "score": 0, "creation_date": 1537967922, "post_id": 52516715, "comment_id": 91976983, "body": "Yeh I&#39;ve accidently missed the &#39; out when typing it out!"}], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 10418188, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/19d5df0638d1c2472ce8ef255cc4a6db?s=128&d=identicon&r=PG&f=1", "display_name": "Killuminati", "link": "https://stackoverflow.com/users/10418188/killuminati"}, "is_accepted": false, "score": 1, "last_activity_date": 1537966878, "creation_date": 1537966878, "answer_id": 52518375, "question_id": 52516715, "link": "https://stackoverflow.com/questions/52516715/adodb-imported-csv-change-data-type/52518375#52518375", "title": "ADODB imported .csv change data type", "body": "<p>Thanks to Storax's recommendation on using a schema file I have got this working.</p>\n\n<p>I created a schema file in the same location as the file. The file looked like;</p>\n\n<pre><code>[test_file.csv]\nFormat=CSVDelimited\nColNameHeader=True\nMaxScanRows=0\n</code></pre>\n\n<p>I can now return the IDs I am looking for! Many thanks to Storax for this solution!</p>\n"}, {"tags": [], "owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "is_accepted": false, "score": 1, "last_activity_date": 1537970698, "creation_date": 1537970698, "answer_id": 52519647, "question_id": 52516715, "link": "https://stackoverflow.com/questions/52516715/adodb-imported-csv-change-data-type/52519647#52519647", "title": "ADODB imported .csv change data type", "body": "<p>One could take Killuminati's solution and add also the field names as needed. The parameter <code>MaxScanRows</code> just makes sure that the OLEDB driver will scan the whole file as stated also in the <a href=\"https://docs.microsoft.com/en-us/sql/odbc/microsoft/schema-ini-file-text-file-driver?view=sql-server-2017\" rel=\"nofollow noreferrer\">documentation</a> </p>\n\n<blockquote>\n  <p>The data types of the fields can also be determined. Use the\n  MaxScanRows option to indicate how many rows should be scanned when\n  determining the column types. If you set MaxScanRows to 0, the whole\n  file is scanned. The MaxScanRows setting in Schema.ini overrides the\n  setting in the Windows Registry, file by file.</p>\n</blockquote>\n\n<p>In order to declare the data type for each field one could use a schema.ini like that</p>\n\n<pre><code>[test_file.csv]\nFormat=Delimited(;)\nDecimalSymbol=,\nColNameHeader=False\nCol1=Field1 Text \nCol2=Field2 Text \nCol3=Field3 Text \nCol4=StartDate Date\nCol5=EndDate Date\nCol6=Price Currency \n</code></pre>\n\n<p>The entry after the equal sign is name of the field resp. column. If the file contains a header it can be the same but does not have to but it is required. </p>\n\n<p>Code could look like that</p>\n\n<pre><code>Sub ADO()\nDim rs As New ADODB.Recordset\nDim conn As New ADODB.Connection\nDim myPath As String\n    myPath = ThisWorkbook.Path &amp; \"\\TextFiles\\\"\n    conn.Open \"Provider=Microsoft.Jet.OLEDB.4.0;Data Source=\" &amp; myPath &amp; \";Extended Properties=\"\"text;HDR=No;FMT=Delimited()\"\";\"\n    With rs\n        .ActiveConnection = conn\n        .CursorType = adOpenKeyset\n        .LockType = adLockOptimistic\n        .Open \"SELECT * FROM [test_file.csv]\"\n        .AddNew\n        .Fields(\"Field1\") = \"Doe\"\n        .Fields(\"Field2\") = \"John\"\n        .Fields(\"Field3\") = \"123456\"\n        .Fields(\"StartDate\") = Date\n        .Fields(\"EndDate\") = \"05.10.2018\"\n        .Fields(\"Price\") = 1234.56\n        .Update\n    End With\n    conn.Close\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 10418188, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/19d5df0638d1c2472ce8ef255cc4a6db?s=128&d=identicon&r=PG&f=1", "display_name": "Killuminati", "link": "https://stackoverflow.com/users/10418188/killuminati"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 395, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1537970698, "creation_date": 1537961425, "question_id": 52516715, "link": "https://stackoverflow.com/questions/52516715/adodb-imported-csv-change-data-type", "title": "ADODB imported .csv change data type", "body": "<p>I have some very large .csv files that I want to query and pull entries out. I've set this up using ADO in Excel 2016 successfully, or so it seemed, and remarkably fast. I am looking to query a field ID using;</p>\n\n<pre><code>SELECT * FROM &lt;file&gt; WHERE ID = #.\n</code></pre>\n\n<p>This has worked fine up until the ID numbers which contain letters, i.e. 960545H4. These appear much further down the file, around ~400k rows in.</p>\n\n<p>I believe the problem is that excel is assuming this field (under the header ID) is numeric based one the first x number of entries. I want this to be set to text.</p>\n\n<p>Is there anyway to set the datatype of the field/column so that I can query successfully?</p>\n\n<pre><code>Sub testSQL()\n\nDim xlcon as ADOB.Connection\nDim xlrs as ADOB.RecordSet\nDim nextRow as Integer\nDim datafilepath as String\nDim datafilename as String\n\nSet xlcon = New ADOB.Connection\nSet xlrs = New ADOB.RecordSet\ndatafilepath = \"U:\\Common\\\"\ndatafilename = \"test_file\"\n\nxlcon.Provider = \"Microsoft.Jet.OLEDB.4.0\"\nxlcon.ConnectionString = \"Data Source=\" &amp; datafilepath &amp; \";\" &amp; \"Extended Properties=\"\"text;HDR=Yes;FMT=Delimited,\"\"\"\n\nxlcon.Open\n\nxlrs.Open \"SELECT * FROM [\" &amp; datafilename &amp; \".csv] WHERE ID = '023487562HH'\", xlcon\n\n'the rest of the code...\n</code></pre>\n\n<p>I was hoping something slong the lines of;</p>\n\n<pre><code>SELECT * FROM [file] WHERE CStr(ID) = 34897562FD\n</code></pre>\n\n<p>but this doesn't seem to work.</p>\n\n<p>Any help is greatly appreciated!!</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1239, "user_id": 5045048, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/IUWJK.jpg?s=128&g=1", "display_name": "Shravan Yadav", "link": "https://stackoverflow.com/users/5045048/shravan-yadav"}, "edited": false, "score": 0, "creation_date": 1537960849, "post_id": 52516361, "comment_id": 91972528, "body": "please share the code. What you have tried so far?"}, {"owner": {"reputation": 1, "user_id": 10418344, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e23ae763a02325c399e310e6162018bb?s=128&d=identicon&r=PG&f=1", "display_name": "jakubsz", "link": "https://stackoverflow.com/users/10418344/jakubsz"}, "reply_to_user": {"reputation": 1239, "user_id": 5045048, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/IUWJK.jpg?s=128&g=1", "display_name": "Shravan Yadav", "link": "https://stackoverflow.com/users/5045048/shravan-yadav"}, "edited": false, "score": 0, "creation_date": 1537962148, "post_id": 52516361, "comment_id": 91973283, "body": "I haven&#39;t use the code yet As I&#39;m  new to VBA. I just learned that something Like VBA even exists. I am not looking for someone to do the work for me, but my wife asked for help (this is for her) and I am trying to help her. When I google this problem, I was send to this website couple of times when others had simmilar problems."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 10418344, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e23ae763a02325c399e310e6162018bb?s=128&d=identicon&r=PG&f=1", "display_name": "jakubsz", "link": "https://stackoverflow.com/users/10418344/jakubsz"}, "edited": false, "score": 0, "creation_date": 1537961923, "post_id": 52516501, "comment_id": 91973131, "body": "Thank you, I have use filter option, however this would work if I would have only one set of results. Hence I have several sites results in one table this dose not work. I will look the loops now. Thanks for the advice"}, {"owner": {"reputation": 1, "user_id": 10418344, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e23ae763a02325c399e310e6162018bb?s=128&d=identicon&r=PG&f=1", "display_name": "jakubsz", "link": "https://stackoverflow.com/users/10418344/jakubsz"}, "edited": false, "score": 0, "creation_date": 1537962222, "post_id": 52516501, "comment_id": 91973325, "body": "Is it possible to add excel file somewhere here so you can check what I work with?"}], "tags": [], "owner": {"reputation": 4239, "user_id": 6480658, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/79a2edab9dc17e4c66e1d91ebe7a40f7?s=128&d=identicon&r=PG&f=1", "display_name": "jamheadart", "link": "https://stackoverflow.com/users/6480658/jamheadart"}, "is_accepted": false, "score": 0, "last_activity_date": 1537960688, "creation_date": 1537960688, "answer_id": 52516501, "question_id": 52516361, "link": "https://stackoverflow.com/questions/52516361/clear-cell-contents-depend-on-other-cell-content/52516501#52516501", "title": "Clear Cell contents depend on other cell content", "body": "<p>There are a few ways to go about this and you don't really need VBA.</p>\n\n<p><strong>Without VBA</strong> - Create a filter on your results and simply filter away the \"&lt;\" - you could copy and paste this filtered table to another sheet</p>\n\n<p>You could use a cell formula to help you identify results: <code>=IF(A1=\"&lt;\",\"\",B1)</code> which would look at <code>A1</code>, if <code>A1</code> was a <code>&lt;</code> then it'd return nothing, otherwise it'll return value in cell <code>B1</code>.</p>\n\n<p><strong>With VBA</strong> - you'd basically be applying the same logic, just written in code. If you really want to do this, then look up how to do a loop first and how to use IF logic...</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 10418344, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e23ae763a02325c399e310e6162018bb?s=128&d=identicon&r=PG&f=1", "display_name": "jakubsz", "link": "https://stackoverflow.com/users/10418344/jakubsz"}, "is_accepted": false, "score": 0, "last_activity_date": 1537965858, "creation_date": 1537965858, "answer_id": 52518065, "question_id": 52516361, "link": "https://stackoverflow.com/questions/52516361/clear-cell-contents-depend-on-other-cell-content/52518065#52518065", "title": "Clear Cell contents depend on other cell content", "body": "<p><a href=\"https://i.stack.imgur.com/tLBUV.jpg\" rel=\"nofollow noreferrer\">enter image description here</a>\nThis is the worksheet I work with. I would like to clear all the values where &lt; is next to them. This is just part of much bigger table. </p>\n"}], "owner": {"reputation": 1, "user_id": 10418344, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e23ae763a02325c399e310e6162018bb?s=128&d=identicon&r=PG&f=1", "display_name": "jakubsz", "link": "https://stackoverflow.com/users/10418344/jakubsz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 51, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1537965858, "creation_date": 1537960194, "last_edit_date": 1537960532, "question_id": 52516361, "link": "https://stackoverflow.com/questions/52516361/clear-cell-contents-depend-on-other-cell-content", "title": "Clear Cell contents depend on other cell content", "body": "<p>My first post here, maybe someone will be able to help.  </p>\n\n<p>I have a large Excel table with data from labs. Some results are below LOD And I need to remove them as I do not need them.<br>\nSo basically I need to clear data in one cell, say <code>E11</code>, if data in <code>D11</code> shows \"&lt;\". Meaning below LOD.  </p>\n\n<p>If possible I would like to replace value in <code>E11</code> with \"-\".  </p>\n\n<p>Is there any one who could help me please. </p>\n"}, {"tags": ["php", "excel", "vba", "export", "phpexcel"], "answers": [{"tags": [], "owner": {"reputation": 1721, "user_id": 411262, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/03UPY.png?s=128&g=1", "display_name": "Rob Ruchte", "link": "https://stackoverflow.com/users/411262/rob-ruchte"}, "is_accepted": false, "score": 1, "last_activity_date": 1538010544, "creation_date": 1538010544, "answer_id": 52528006, "question_id": 52515528, "link": "https://stackoverflow.com/questions/52515528/how-to-export-data-to-excel-template-retaining-vba-code-and-data-validation-us/52528006#52528006", "title": "How to export data to Excel template, retaining VBA code and data validation, using PHP?", "body": "<p>I have spent a great deal of time working on this problem, and the problem of memory consumption for large data sets. All of the PHP libs I have found keep all of the cells in memory, which is not viable for anything more than a small sheet.</p>\n\n<p>What I ended up doing was writing a set of Java utilities using <a href=\"https://poi.apache.org/\" rel=\"nofollow noreferrer\">Apache POI</a> and packaged them with <a href=\"http://php-java-bridge.sourceforge.net/pjb/\" rel=\"nofollow noreferrer\">PHP/Java Bridge</a> so I can call them from PHP. This will allow you to create a new workbook based upon a template, keeping the macros intact. You can also use POI's streaming API, so you can handle massive data sets without crashing your server.</p>\n\n<p>If you have Java chops, I highly recommend going this route, it's really the only way to do brain surgery on Excel files from PHP.</p>\n\n<p>If you have any questions about how to do this or would like some example code, I'll be glad to help.</p>\n"}], "owner": {"reputation": 1, "user_id": 4716771, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-LsYKRKj5Sdo/AAAAAAAAAAI/AAAAAAAAACs/2Xc-SF84qDo/photo.jpg?sz=128", "display_name": "Kaustubh Chonkar", "link": "https://stackoverflow.com/users/4716771/kaustubh-chonkar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 69, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1609623904, "creation_date": 1537957510, "last_edit_date": 1609623904, "question_id": 52515528, "link": "https://stackoverflow.com/questions/52515528/how-to-export-data-to-excel-template-retaining-vba-code-and-data-validation-us", "title": "How to export data to Excel template, retaining VBA code and data validation, using PHP?", "body": "<p>I need to export data to an Excel template that contains VBA code and data validation in PHP.</p>\n<p>I tried using PHPExcel library but it is removing the VBA code and data validations from the template.</p>\n<p>I tried using PHPReport library, didn't get proper solution.</p>\n<p>The template contains multiple worksheets and they are interdependent.<br />\nE.g.: Worksheet 1 contains employee data, then worksheet 2 contains salary with respect to employee name.</p>\n"}, {"tags": ["vba", "excel", "copy", "range"], "answers": [{"tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": false, "score": 2, "last_activity_date": 1537959950, "last_edit_date": 1537959950, "creation_date": 1537957193, "answer_id": 52515421, "question_id": 52515111, "link": "https://stackoverflow.com/questions/52515111/copy-down-in-column/52515421#52515421", "title": "Copy down in column", "body": "<p>Find the last populated row of column A, by coming up from the bottom of the sheet, and use that for column B in the \"fill down\". I have used Right$ in place of your Mid. You could also use  Mid$(.Range(\"A1\").Value, 11, 2). The formula steps are unnecessary and can be removed.</p>\n\n<p>Change the sheet name to the appropriate sheet name.</p>\n\n<pre><code>Sub TEST()\n    With ThisWorkbook.Worksheets(\"Sheet2\")\n        .Range(\"B3\").Formula = \"=RIGHT(A1,2)\"\n        .Range(\"B3\").Value = .Range(\"B3\").Value\n        If .Cells(.Rows.Count, \"A\").End(xlUp).Row &gt; 3 Then\n            .Range(\"B4:B\" &amp; .Cells(.Rows.Count, \"A\").End(xlUp).Row) = .Range(\"B3\")\n        End If\n    End With\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p>You could simplify, my preference, to:</p>\n\n<pre><code>Option Explicit\nPublic Sub TEST()\n    With ThisWorkbook.Worksheets(\"Sheet2\")\n        If .Cells(.Rows.Count, \"A\").End(xlUp).Row &gt;= 3 Then\n            .Range(\"B3:B\" &amp; .Cells(.Rows.Count, \"A\").End(xlUp).Row) = Right$(.Range(\"A1\"), 2)\n        End If\n    End With\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 2, "creation_date": 1537959962, "post_id": 52515987, "comment_id": 91972040, "body": "Well spotted there. +1"}, {"owner": {"reputation": 127, "user_id": 3563995, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/3c2f61b08bb597aaf75fbda8786f2461?s=128&d=identicon&r=PG&f=1", "display_name": "Akire", "link": "https://stackoverflow.com/users/3563995/akire"}, "edited": false, "score": 0, "creation_date": 1537962161, "post_id": 52515987, "comment_id": 91973296, "body": "Thanks, this was the easiest to use in the data I have."}], "tags": [], "owner": {"reputation": 1112, "user_id": 7354796, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7efd450f69bda421b8348f3f694ae621?s=128&d=identicon&r=PG&f=1", "display_name": "OwlsSleeping", "link": "https://stackoverflow.com/users/7354796/owlssleeping"}, "is_accepted": true, "score": 1, "last_activity_date": 1537967813, "last_edit_date": 1537967813, "creation_date": 1537958966, "answer_id": 52515987, "question_id": 52515111, "link": "https://stackoverflow.com/questions/52515111/copy-down-in-column/52515987#52515987", "title": "Copy down in column", "body": "<p>One slight amendment to QHarr's solution:</p>\n\n<p>You should either force a worksheet.calculate or use a VBA formula when pasting values. If not you will get blanks if the manual recalculation setting is used. For example</p>\n\n<pre><code>Sub Coppy_down()\nWith Sheet1\n.Range(\"B3\", .Range(\"B\" &amp; .Cells(Rows.Count, \"A\").End(xlUp).Row)).Value = Mid(.Range(\"A1\").Value, 11, 2)\nEnd With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 127, "user_id": 3563995, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/3c2f61b08bb597aaf75fbda8786f2461?s=128&d=identicon&r=PG&f=1", "display_name": "Akire", "link": "https://stackoverflow.com/users/3563995/akire"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 40, "favorite_count": 0, "accepted_answer_id": 52515987, "answer_count": 2, "score": 0, "last_activity_date": 1537967813, "creation_date": 1537956235, "question_id": 52515111, "link": "https://stackoverflow.com/questions/52515111/copy-down-in-column", "title": "Copy down in column", "body": "<p>I have a problem with a part of a bigger VBA Macro, so no; I can not do this another way.</p>\n\n<p>I want to copy a value down in an empty column, but only in as many rows as I have in the worksheet.</p>\n\n<p>I want it to automatically count how many rows that is active in the worksheet and that that row as the last one, but I get stuck and it does not want to do as I want.</p>\n\n<p>Below is the code that I am working with.</p>\n\n<pre><code>Sub Coppy_down()\nRange(\"B3\").Formula = \"=Mid(A1, 11, 2)\"\nRange(\"B3\").Value = Range(\"B3\").Value\nRange(\"B3\").Copy Range(\"B3\", Range(\"B\" &amp; Rows.Count).End(xlUp))\n\nEnd Sub\n</code></pre>\n\n<p>My data looks as this (I did not find how to attach)</p>\n\n<pre><code>     A             B\n  1  District: SE   \n  2  Date         District\n  3  8/17/2018    \n  4  8/24/2018  \n  5  8/31/2018  \n  6  9/7/2018   \n  7  9/14/2018  \n  8  9/21/2018  \n  9  9/28/2018\n</code></pre>\n\n<p>And I want to fill cell B3:B9 with SE, but not that it might be B3:B4 or B3:B15, so it need to be flexible.</p>\n\n<p>Thanks</p>\n"}, {"tags": ["excel", "vba"], "owner": {"reputation": 41, "user_id": 10390480, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-OQcScz8iYHk/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaMZpPH_qgrjL_X7QskdiRZBxKX0FA/mo/photo.jpg?sz=128", "display_name": "Archit Kacker", "link": "https://stackoverflow.com/users/10390480/archit-kacker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 40, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1537965410, "creation_date": 1537955920, "last_edit_date": 1537965410, "question_id": 52515004, "link": "https://stackoverflow.com/questions/52515004/excel-macro-how-to-set-a-fixed-name-to-the-pivot-chart", "title": "Excel Macro- How to set a fixed name to the pivot chart?", "body": "<p>The below is the code that I have used. I want to fix my chart numbers of this and the other charts that I have created so that I can format them later. Also if someone can suggest how to shorten up the code.</p>\n\n<pre><code>'Declare Variables\nDim PCache7 As PivotCache\nDim PTable7 As PivotTable\n\n\n'Define Data Range\nLastRow = DSheet.Cells(Rows.Count, 1).End(xlUp).Row\nLastCol = DSheet.Cells(1, Columns.Count).End(xlToLeft).Column\nSet PRange = DSheet.Cells(1, 1).Resize(LastRow, LastCol)\n\n'Define Pivot Cache\nSet PCache7 = ActiveWorkbook.PivotCaches.Create _\n(SourceType:=xlDatabase, SourceData:=PRange). _\nCreatePivotTable(TableDestination:=PSheet.Cells(2, 12), _\nTableName:=\"AnalyticsPivotTable7\")\n\n'Insert Blank Pivot Table\nSet PTable7 = PCache.CreatePivotTable _\n(TableDestination:=PSheet.Cells(2, 12), TableName:=\"AnalyticsPivotTable7\")\n\n'Insert Row Fields\nWith ActiveSheet.PivotTables(\"AnalyticsPivotTable7\").PivotFields(\"Issue Type\")\n        .Orientation = xlRowField\n        .Position = 1\nEnd With\n\n\n'Insert Data Field\nWith ActiveSheet.PivotTables(\"AnalyticsPivotTable7\").PivotFields(\"IncidentID\")\n        .Orientation = xlDataField\n        .Position = 1\n        .Function = xlCount\n        .NumberFormat = \"#,##0\"\n\nEnd With\n'Insert Data Field\nWith ActiveSheet.PivotTables(\"AnalyticsPivotTable7\").PivotFields(\"IncidentID\")\n        .Orientation = xlDataField\n        .Position = 2\n        .Function = xlCount\n        .Calculation = xlPercentOfTotal\n        .NumberFormat = \"#0.0%\"\n\n\nEnd With\n'Format Pivot Table\nActiveSheet.PivotTables(\"AnalyticsPivotTable7\").ShowTableStyleRowStripes = True\nActiveSheet.PivotTables(\"AnalyticsPivotTable7\").TableStyle2 =    \"PivotStyleMedium9\"\nRange(\"N4:N16\").Select\n    ActiveSheet.PivotTables(\"AnalyticsPivotTable7\").PivotFields(\"Issue Type\"). _\n        AutoSort xlDescending, \"Count of IncidentID2\", ActiveSheet.PivotTables( _\n        \"AnalyticsPivotTable7\").PivotColumnAxis.PivotLines(2), 1\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2189, "user_id": 8726447, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/961e6112f7d5aac9646ce1469e89fe20?s=128&d=identicon&r=PG&f=1", "display_name": "MarcinSzaleniec", "link": "https://stackoverflow.com/users/8726447/marcinszaleniec"}, "edited": false, "score": 0, "creation_date": 1537953953, "post_id": 52514170, "comment_id": 91968299, "body": "In what circumstances you get range address?  Maybe place Debug.Assert instr(RecColRef.TargetSheet.Cells(Val(strRow)), 5).Address, &quot;:&quot;) &gt; 0 to catch and examine it."}, {"owner": {"reputation": 154, "user_id": 10319711, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WXECF.jpg?s=128&g=1", "display_name": "Tomasz", "link": "https://stackoverflow.com/users/10319711/tomasz"}, "reply_to_user": {"reputation": 2189, "user_id": 8726447, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/961e6112f7d5aac9646ce1469e89fe20?s=128&d=identicon&r=PG&f=1", "display_name": "MarcinSzaleniec", "link": "https://stackoverflow.com/users/8726447/marcinszaleniec"}, "edited": false, "score": 0, "creation_date": 1537954789, "post_id": 52514170, "comment_id": 91968822, "body": "I already kind of have that as I use the resultant string address to access the elements in a collection by key and that throws an exception when the wrong form of address is returned.  This is in code from a modeless UserForm, where the user does editing and uses the form to accomplish certain lookups.  When it returns the wrong form, it will keep returning the wrong form, until I manually switch to a different sheet in the underlying Workbook, then it starts returning the correct form again."}, {"owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "edited": false, "score": 1, "creation_date": 1537961222, "post_id": 52514170, "comment_id": 91972748, "body": "This looks interesting. I&#39;m keen to understand <i>why</i> this is happening as, in my mind, it just shouldn&#39;t. Have you tried removing the qualifying sheet and workbook objects (I know it&#39;s best practice, but for an <code>.Address</code>, they&#39;re irrelevant <i>in most cases</i>)?"}, {"owner": {"reputation": 558, "user_id": 7778672, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/2LGnC.jpg?s=128&g=1", "display_name": "Inarion", "link": "https://stackoverflow.com/users/7778672/inarion"}, "reply_to_user": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "edited": false, "score": 1, "creation_date": 1537961402, "post_id": 52514170, "comment_id": 91972843, "body": "In addition to what @CLR said, can you somehow qualify the circumstances when this happens? I.E. what does &quot;sometimes&quot; mean? I totally agree that this <i>shouldn&#39;t</i> happen."}, {"owner": {"reputation": 154, "user_id": 10319711, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WXECF.jpg?s=128&g=1", "display_name": "Tomasz", "link": "https://stackoverflow.com/users/10319711/tomasz"}, "edited": false, "score": 1, "creation_date": 1537964725, "post_id": 52514170, "comment_id": 91974877, "body": "I only saw it a couple of times during my debugging, and first time I was not paying close attention.  My users saw this problem several times though.  Not very clear about the circumstances, some said they were reformatting cells and it happened right after.  I just though I missed some setting somewhere in excel that was responsible for this, but if not I now am applying the SPLIT workaround from one of the answers, so I will probably never see it again."}, {"owner": {"reputation": 4239, "user_id": 6480658, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/79a2edab9dc17e4c66e1d91ebe7a40f7?s=128&d=identicon&r=PG&f=1", "display_name": "jamheadart", "link": "https://stackoverflow.com/users/6480658/jamheadart"}, "edited": false, "score": 0, "creation_date": 1538117370, "post_id": 52514170, "comment_id": 92038514, "body": "&#39;will probably never see it again&#39; - at least that&#39;s the plan! :D"}], "answers": [{"comments": [{"owner": {"reputation": 154, "user_id": 10319711, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WXECF.jpg?s=128&g=1", "display_name": "Tomasz", "link": "https://stackoverflow.com/users/10319711/tomasz"}, "edited": false, "score": 1, "creation_date": 1537960882, "post_id": 52514363, "comment_id": 91972547, "body": "Great workaround thanks.  If after a few more days no better answer I will mark this as the solution."}], "tags": [], "owner": {"reputation": 4239, "user_id": 6480658, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/79a2edab9dc17e4c66e1d91ebe7a40f7?s=128&d=identicon&r=PG&f=1", "display_name": "jamheadart", "link": "https://stackoverflow.com/users/6480658/jamheadart"}, "is_accepted": true, "score": 2, "last_activity_date": 1537954433, "last_edit_date": 1537954433, "creation_date": 1537954003, "answer_id": 52514363, "question_id": 52514170, "link": "https://stackoverflow.com/questions/52514170/range-address-for-single-cell-a1-sometimes-returns-cell-range-adress-a1a1-i/52514363#52514363", "title": "Range Address for Single Cell (A1) sometimes returns Cell Range Adress &quot;A1:A1&quot; instead of &quot;A1&quot;", "body": "<p>Try wrapping it in a SPLIT function</p>\n\n<pre><code>varAddr = split(RecColRef.TargetSheet.Cells(Val(strRow), 5).Address, \":\")(0)\n</code></pre>\n\n<p>If a range with \":\" occurs, this will split it in to two parts e.g. <code>Split(\"E1:E1\", \":\")</code> and return only the first part <code>(0)</code> - if it's a \"normal\" range e.g. <code>E1</code> it'll still return the same.</p>\n"}, {"comments": [{"owner": {"reputation": 154, "user_id": 10319711, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WXECF.jpg?s=128&g=1", "display_name": "Tomasz", "link": "https://stackoverflow.com/users/10319711/tomasz"}, "edited": false, "score": 0, "creation_date": 1537964929, "post_id": 52515800, "comment_id": 91975008, "body": "That would have been good to try, wish I had thought of it when I reproduced the problem.  I did try <code>varAddr = RecColRef.TargetSheet.Cells(1,1)</code> and that yelded <code>&quot;A1:A1&quot;</code>."}], "tags": [], "owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "is_accepted": false, "score": 1, "last_activity_date": 1537958375, "creation_date": 1537958375, "answer_id": 52515800, "question_id": 52514170, "link": "https://stackoverflow.com/questions/52514170/range-address-for-single-cell-a1-sometimes-returns-cell-range-adress-a1a1-i/52515800#52515800", "title": "Range Address for Single Cell (A1) sometimes returns Cell Range Adress &quot;A1:A1&quot; instead of &quot;A1&quot;", "body": "<p>or</p>\n\n<p><code>varAddr = RecColRef.TargetSheet.Cells(Val(strRow), 5).cells(1,1).Address</code></p>\n"}], "owner": {"reputation": 154, "user_id": 10319711, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WXECF.jpg?s=128&g=1", "display_name": "Tomasz", "link": "https://stackoverflow.com/users/10319711/tomasz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 102, "favorite_count": 1, "accepted_answer_id": 52514363, "answer_count": 2, "score": 1, "last_activity_date": 1537958375, "creation_date": 1537953447, "last_edit_date": 1537956283, "question_id": 52514170, "link": "https://stackoverflow.com/questions/52514170/range-address-for-single-cell-a1-sometimes-returns-cell-range-adress-a1a1-i", "title": "Range Address for Single Cell (A1) sometimes returns Cell Range Adress &quot;A1:A1&quot; instead of &quot;A1&quot;", "body": "<p>When I try to get a range address for this expression:</p>\n\n<pre><code>varAddr = RecColRef.TargetSheet.Cells(Val(strRow), 5).Address\n</code></pre>\n\n<p>Most of the time varAddr will have <code>\"$E$7\"</code> in it, but sometimes it will have <code>\"$E$7:$E$7\"</code>.\nHow can I force it to always return a single cell address <code>\"$E$7\"</code>?</p>\n\n<p>edit: removed extra \"(\" from code which was preventing it from compiling</p>\n"}, {"tags": ["vba", "excel", "userform"], "answers": [{"tags": [], "owner": {"reputation": 1385, "user_id": 8555648, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-CK4leGQFE84/AAAAAAAAAAI/AAAAAAAAAgY/HrlhEh-LPIQ/photo.jpg?sz=128", "display_name": "newacc2240", "link": "https://stackoverflow.com/users/8555648/newacc2240"}, "is_accepted": false, "score": 2, "last_activity_date": 1537954217, "last_edit_date": 1537954217, "creation_date": 1537953595, "answer_id": 52514222, "question_id": 52513821, "link": "https://stackoverflow.com/questions/52513821/vba-move-multiple-elements-at-once-in-userform/52514222#52514222", "title": "VBA: Move multiple elements at once in userform", "body": "<p>There is a <code>Tag</code> property of every object, you can assign all the objects you'd like to move a tag like <code>toBeMoved</code>. Then the code would be very clear:</p>\n\n<pre><code>Private Sub Filtereigenschaften_Click()\n    Dim obj As Object\n    Dim adj As Variant\n\n    Filtergruppe.Visible = IIf(Filtereigenschaften.Value, True, False)\n    adj = IIf(Filtereigenschaften.Value, Ausklapphoehe, -Ausklapphoehe)\n\n    UserForm.Height = UserForm.Height + adj\n    For Each obj In Controls\n        If obj.Tag = toBeMoved Then obj.Top = obj.Top + adj\n    Next obj\nEnd Sub\n</code></pre>\n\n<p>The method for assigning a value into <code>.Tag</code> can be written in <code>UserForm_Initialize()</code>, or edit it through Properties Window (press F4 if it is hidden) manually.</p>\n"}, {"comments": [{"owner": {"reputation": 35, "user_id": 4483142, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f42d64896748230fb4447035e8dcae?s=128&d=identicon&r=PG&f=1", "display_name": "bananabombo", "link": "https://stackoverflow.com/users/4483142/bananabombo"}, "edited": false, "score": 0, "creation_date": 1537955361, "post_id": 52514382, "comment_id": 91969268, "body": "thanks! didnt know i can hide the border and the caption of a Frame."}], "tags": [], "owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "is_accepted": true, "score": 1, "last_activity_date": 1537954445, "last_edit_date": 1537954445, "creation_date": 1537954034, "answer_id": 52514382, "question_id": 52513821, "link": "https://stackoverflow.com/questions/52513821/vba-move-multiple-elements-at-once-in-userform/52514382#52514382", "title": "VBA: Move multiple elements at once in userform", "body": "<p>To use a \"<strong>Group</strong>\", place a <code>Frame</code> to your form and place/drag the controls on it.\nWhen you move the frame, all controls on it move with it. Set the <code>border</code> and <code>caption</code>-properties of the frame if you want to make the frame itself invisible. If you write something like <code>Me.Frame1.Visible = false</code>, it hides also all controls on that frame.</p>\n\n<p>To access controls using <strong>tag</strong>:  </p>\n\n<pre><code>Sub ControlsByTag(tag As String)\n    Dim ctrl As Control\n    For Each ctrl In Me.Controls\n        Debug.Print ctrl.Name, ctrl.tag\n    Next ctrl\nEnd Sub\n</code></pre>\n\n<p>To use <strong>arrays</strong>:</p>\n\n<pre><code>' Assign to array:\nDim a\na = Array(Me.CommandButton1, Me.CommandButton2)\n\n' Loop over the array:\nDim i As Long\nFor i = LBound(a) To UBound(a)\n    Debug.Print a(i).Name, a(i).tag\nNext i\n</code></pre>\n"}], "owner": {"reputation": 35, "user_id": 4483142, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f42d64896748230fb4447035e8dcae?s=128&d=identicon&r=PG&f=1", "display_name": "bananabombo", "link": "https://stackoverflow.com/users/4483142/bananabombo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 797, "favorite_count": 0, "accepted_answer_id": 52514382, "answer_count": 2, "score": 1, "last_activity_date": 1537954445, "creation_date": 1537952409, "question_id": 52513821, "link": "https://stackoverflow.com/questions/52513821/vba-move-multiple-elements-at-once-in-userform", "title": "VBA: Move multiple elements at once in userform", "body": "<p>I want to expand my userform when i click on a Checkbox. Some elements should move by the same value that my userform expands so that they always keep the same distance from the bottom border of the form.</p>\n\n<p>At the moment i move every element individually like so where \"Ausklapphoehe\" is the value for moving/expanding (it's working perfectly but ist not nicely coded i think):</p>\n\n<pre><code>Private Sub Filtereigenschaften_Click()\n    If Filtereigenschaften.Value = False Then                       \n        Filtergruppe.Visible = False\n\n        UserForm.Height = UserForm.Height - Ausklapphoehe\n        Button.Top = Button.Top - Ausklapphoehe\n        FHLabel.Top = FHLabel.Top - Ausklapphoehe\n        FHBox.Top = FHBox.Top - Ausklapphoehe\n        NutenabstandLabel.Top = NutenabstandLabel.Top - Ausklapphoehe\n        NutenabstandBox.Top = NutenabstandBox.Top - Ausklapphoehe\n        SpinButton.Top = SpinButton.Top - Ausklapphoehe\n        VersionLabel.Top = VersionLabel.Top - Ausklapphoehe\n    End If\n    If Filtereigenschaften.Value = True Then                        \n        Filtergruppe.Visible = True\n\n        UserForm.Height = UserForm.Height + Ausklapphoehe\n        Button.Top = Button.Top + Ausklapphoehe\n        FHLabel.Top = FHLabel.Top + Ausklapphoehe\n        FHBox.Top = FHBox.Top + Ausklapphoehe\n        NutenabstandLabel.Top = NutenabstandLabel.Top + Ausklapphoehe\n        NutenabstandBox.Top = NutenabstandBox.Top + Ausklapphoehe\n        SpinButton.Top = SpinButton.Top + Ausklapphoehe\n        VersionLabel.Top = VersionLabel.Top + Ausklapphoehe\n    End If\nEnd Sub\n</code></pre>\n\n<p>I have three ideas to shorten the code:</p>\n\n<ol>\n<li>Store the element\"IDs\" in an Array and perform the repeating Task by iterating over the Array (dont know how to store the elements in an Array)</li>\n<li>Simply Group the elements and perform Task just to the Group (dont know how to adress Groups in vba code)</li>\n<li>give the elements a mutual tag and just adress the elements over the tag  (dont know how to adress tags)</li>\n</ol>\n"}, {"tags": ["excel", "vba", "ms-office", "vbe"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1538057906, "post_id": 52513747, "comment_id": 92017767, "body": "Is Office itself in German?"}, {"owner": {"reputation": 379, "user_id": 6210991, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Y6nJN.jpg?s=128&g=1", "display_name": "KySoto", "link": "https://stackoverflow.com/users/6210991/kysoto"}, "edited": false, "score": 1, "creation_date": 1538058007, "post_id": 52513747, "comment_id": 92017842, "body": "Have you tried reinstalling office/having IT reinstall office?"}, {"owner": {"reputation": 31, "user_id": 7755482, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/878e3b17f2f494c663be9018b7bc3745?s=128&d=identicon&r=PG&f=1", "display_name": "Cezary Doma\u0144ski", "link": "https://stackoverflow.com/users/7755482/cezary-doma%c5%84ski"}, "edited": false, "score": 0, "creation_date": 1538078294, "post_id": 52513747, "comment_id": 92028346, "body": "Of course not - it&#39;s in English alongside with Windows. I would like to avoid reinstallation of office, but it seems that is the last available option."}], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 7755482, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/878e3b17f2f494c663be9018b7bc3745?s=128&d=identicon&r=PG&f=1", "display_name": "Cezary Doma\u0144ski", "link": "https://stackoverflow.com/users/7755482/cezary-doma%c5%84ski"}, "edited": false, "score": 0, "creation_date": 1537988617, "post_id": 52514514, "comment_id": 91988599, "body": "It doesn&#39;t work. I don&#39;t have VBA folder under C:\\Program Files\\Common Files\\microsoft shared\\ path. What can I do to change the VBA language? Any other options?"}, {"owner": {"reputation": 558, "user_id": 7778672, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/2LGnC.jpg?s=128&g=1", "display_name": "Inarion", "link": "https://stackoverflow.com/users/7778672/inarion"}, "reply_to_user": {"reputation": 31, "user_id": 7755482, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/878e3b17f2f494c663be9018b7bc3745?s=128&d=identicon&r=PG&f=1", "display_name": "Cezary Doma\u0144ski", "link": "https://stackoverflow.com/users/7755482/cezary-doma%c5%84ski"}, "edited": false, "score": 0, "creation_date": 1538031126, "post_id": 52514514, "comment_id": 92001454, "body": "@CezaryDoma\u0144ski You&#39;ll need to have a look around your C: drive. It may be in <code>C:\\Program Files (x86)\\Common Files\\...</code>. Have you tried to locate <code>VBEUIINTL.dll</code> as advised in the linked/quoted post? Also, did you check the settings mentioned in the first paragraph of my answer?"}, {"owner": {"reputation": 31, "user_id": 7755482, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/878e3b17f2f494c663be9018b7bc3745?s=128&d=identicon&r=PG&f=1", "display_name": "Cezary Doma\u0144ski", "link": "https://stackoverflow.com/users/7755482/cezary-doma%c5%84ski"}, "edited": false, "score": 0, "creation_date": 1538046857, "post_id": 52514514, "comment_id": 92010632, "body": "yea, i&#39;ve chcekd your first proposal and my regional setup are English UK, not Germany as you suggest. I&#39;ve tried to found the VBEUIINTL.dll file in disc C but nothing found.."}, {"owner": {"reputation": 558, "user_id": 7778672, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/2LGnC.jpg?s=128&g=1", "display_name": "Inarion", "link": "https://stackoverflow.com/users/7778672/inarion"}, "reply_to_user": {"reputation": 31, "user_id": 7755482, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/878e3b17f2f494c663be9018b7bc3745?s=128&d=identicon&r=PG&f=1", "display_name": "Cezary Doma\u0144ski", "link": "https://stackoverflow.com/users/7755482/cezary-doma%c5%84ski"}, "edited": false, "score": 0, "creation_date": 1538050949, "post_id": 52514514, "comment_id": 92013153, "body": "@CezaryDoma\u0144ski, well... Sounds strange, but possible nonetheless. Go into your VBE and select the &quot;Extras&quot; menu and then &quot;Verweise&quot;. At the top of this references list there should be an entry <code>Visual Basic For Applications</code>. Select it and its full path should be displayed at the bottom in the line prefixed with &quot;Pfad:&quot;. This happens to be the path we are looking for."}, {"owner": {"reputation": 31, "user_id": 7755482, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/878e3b17f2f494c663be9018b7bc3745?s=128&d=identicon&r=PG&f=1", "display_name": "Cezary Doma\u0144ski", "link": "https://stackoverflow.com/users/7755482/cezary-doma%c5%84ski"}, "edited": false, "score": 0, "creation_date": 1538056418, "post_id": 52514514, "comment_id": 92016721, "body": "I found VBEUIINTL.dll file in C:\\Program Files (x86)\\Microsoft Office\\root\\vfs\\ProgramFilesCommonX86\\Microsoft Shared\\VBA, copied files as you suggest but it doesn&#39;t work. Still VBA is in german"}, {"owner": {"reputation": 558, "user_id": 7778672, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/2LGnC.jpg?s=128&g=1", "display_name": "Inarion", "link": "https://stackoverflow.com/users/7778672/inarion"}, "reply_to_user": {"reputation": 31, "user_id": 7755482, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/878e3b17f2f494c663be9018b7bc3745?s=128&d=identicon&r=PG&f=1", "display_name": "Cezary Doma\u0144ski", "link": "https://stackoverflow.com/users/7755482/cezary-doma%c5%84ski"}, "edited": false, "score": 0, "creation_date": 1538058771, "post_id": 52514514, "comment_id": 92018384, "body": "@CezaryDoma\u0144ski It seems I am out of ideas on this issue, but the guys commenting on your question might be able to help you some more."}, {"owner": {"reputation": 31, "user_id": 7755482, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/878e3b17f2f494c663be9018b7bc3745?s=128&d=identicon&r=PG&f=1", "display_name": "Cezary Doma\u0144ski", "link": "https://stackoverflow.com/users/7755482/cezary-doma%c5%84ski"}, "edited": false, "score": 0, "creation_date": 1538078409, "post_id": 52514514, "comment_id": 92028392, "body": "Nonetheless I really appreciate your effort to resolve my case. Take care bro"}], "tags": [], "owner": {"reputation": 558, "user_id": 7778672, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/2LGnC.jpg?s=128&g=1", "display_name": "Inarion", "link": "https://stackoverflow.com/users/7778672/inarion"}, "is_accepted": false, "score": 1, "last_activity_date": 1537954452, "creation_date": 1537954452, "answer_id": 52514514, "question_id": 52513747, "link": "https://stackoverflow.com/questions/52513747/changing-language-of-visual-basic-editor-to-english/52514514#52514514", "title": "Changing language of Visual Basic Editor to English", "body": "<p>Have a look at the setting at <code>Control Panel &gt; Region and Language &gt; Administrative</code>. If it's showing \"Germany/German\" for non-unicode programs, you might be able to change it there.</p>\n\n<hr>\n\n<p><a href=\"https://answers.microsoft.com/en-us/msoffice/forum/msoffice_excel-mso_windows8-mso_2013_release/vba-editor-language-change/9ec962d5-89b8-4604-aed5-06d2d338db3e\" rel=\"nofollow noreferrer\">This thread at answers.microsoft.com</a> suggests to have a look at the folder <code>C:\\Program Files\\Common Files\\microsoft shared\\VBA\\VBA7.1</code>.</p>\n\n<blockquote>\n  <p>Hello, I've had the same problem and finally found the solution. The\n  language file for VBA editor interface is stored in the following\n  folder with different subfolders:</p>\n  \n  <p>C:\\Program Files\\Common Files\\microsoft shared\\VBA\\VBA7.1</p>\n  \n  <p>(you may need to search for VBEUIINTL.dll if you can't find this\n  folder on your computer) </p>\n  \n  <p>in this folder the 1033 subfolder and its contents are for English\n  interface. The other ones are for different languages.  Somehow VBA\n  chooses the wrong subfolder. So you basically need to copy the\n  contents of 1033 folder ( as a workaround ):</p>\n  \n  <p>\"C:\\Program Files\\Common Files\\microsoft shared\\VBA\\VBA7.1\\1033\\APC71ITL.DLL\"<br>\n  \"C:\\Program Files\\Common Files\\microsoft shared\\VBA\\VBA7.1\\1033\\VBE7INTL.DLL\"<br>\n  \"C:\\Program Files\\Common Files\\microsoft shared\\VBA\\VBA7.1\\1033\\VBEUIINTL.DLL\"  </p>\n  \n  <p>to the 2052 folder (for chinese for example, may be you have\n  different), for changing the language.</p>\n  \n  <p>Before doing this , restart and don't start any office products. Then\n  copy the files; overwrite if asked. I also suggest you to take a\n  backup of VBA7.1 folder in case something goes wrong.</p>\n</blockquote>\n\n<p>The suggestion to restart seems a bit unneeded to me - just make sure all office programs that support VBA (Excel, Word, Access, PowerPoint, Outlook) are closed.  </p>\n\n<p>Also this latter method seems more like treating the symptoms - to me it doesn't appear to be the correct way of changing the language of your VBE (merely one suboptimal way).</p>\n"}, {"comments": [{"owner": {"reputation": 31, "user_id": 7755482, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/878e3b17f2f494c663be9018b7bc3745?s=128&d=identicon&r=PG&f=1", "display_name": "Cezary Doma\u0144ski", "link": "https://stackoverflow.com/users/7755482/cezary-doma%c5%84ski"}, "edited": false, "score": 0, "creation_date": 1537969091, "post_id": 52514600, "comment_id": 91977771, "body": "I doesn&#39;t have VBA folder on path &quot;C:\\Program Files\\Common Files\\Microsoft Shared\\&quot; so I cannot applied your solutions. Any other ideas?"}, {"owner": {"reputation": 558, "user_id": 7778672, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/2LGnC.jpg?s=128&g=1", "display_name": "Inarion", "link": "https://stackoverflow.com/users/7778672/inarion"}, "edited": false, "score": 1, "creation_date": 1538031290, "post_id": 52514600, "comment_id": 92001545, "body": "This looks pretty similar to what I found. Would you mind adding a reference/link to you original source?"}], "tags": [], "owner": {"reputation": 21, "user_id": 7256550, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ye1pBJKPSNs/AAAAAAAAAAI/AAAAAAAAANc/llh_MO56SCc/photo.jpg?sz=128", "display_name": "jackrider", "link": "https://stackoverflow.com/users/7256550/jackrider"}, "is_accepted": false, "score": 0, "last_activity_date": 1537954741, "creation_date": 1537954741, "answer_id": 52514600, "question_id": 52513747, "link": "https://stackoverflow.com/questions/52513747/changing-language-of-visual-basic-editor-to-english/52514600#52514600", "title": "Changing language of Visual Basic Editor to English", "body": "<p>The language file for VBA editor interface is stored in the following folder with different subfolders:</p>\n\n<pre><code>\"C:\\Program Files\\Common Files\\Microsoft Shared\\VBA\\VBA7.1\"\n</code></pre>\n\n<p>You need to search for VBEUIINTL.dll</p>\n\n<p>This folder has around 1033 subfolder and its contents are for English interface. The other ones are for different languages. Sometimes VBA chooses the wrong subfolder. So you basically need to copy the contents of 1033 folder:</p>\n\n<pre><code>\"C:\\Program Files\\Common Files\\microsoft shared\\VBA\\VBA7.1\\1033\\APC71ITL.DLL\"\n\"C:\\Program Files\\Common Files\\microsoft shared\\VBA\\VBA7.1\\1033\\VBE7INTL.DLL\"\n\"C:\\Program Files\\Common Files\\microsoft shared\\VBA\\VBA7.1\\1033\\VBEUIINTL.DLL\"\n</code></pre>\n\n<p>to the your current folder for changing the language.</p>\n\n<p>Before you do this, make a back-up first.</p>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 5093128, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wGFDX.jpg?s=128&g=1", "display_name": "Vikitorony", "link": "https://stackoverflow.com/users/5093128/vikitorony"}, "is_accepted": false, "score": 1, "last_activity_date": 1554814023, "creation_date": 1554814023, "answer_id": 55593280, "question_id": 52513747, "link": "https://stackoverflow.com/questions/52513747/changing-language-of-visual-basic-editor-to-english/55593280#55593280", "title": "Changing language of Visual Basic Editor to English", "body": "<p>I had the same issue except my VBA's interface was French.<br>\nWindows 8.1 and Office 2013 were installed with Hungarian language, Regional and \"non-unicode\" settings are also set to Hungarian.</p>\n\n<p>I have 3 folders in <code>C:\\Program Files (x86)\\Common Files\\Microsoft Shared\\VBA\\VBA7.1\\</code>:<br>\n- 1033 - English (US)<br>\n- 1036 - French<br>\n- 1038 - Hungarian<br>\nSource of Language Codes: <a href=\"https://renenyffenegger.ch/notes/Windows/development/Internationalization/language#windows-languages\" rel=\"nofollow noreferrer\">renenyffenegger.ch</a>  </p>\n\n<p>Unfortunately I don't have administrator rights, so I couldn't modify files or folders inside <code>Program Files (x86)</code>.<br>\nI don't understand how but I can modify <code>HKEY_CURRENT_USER</code> in Registry (regedit.exe).  </p>\n\n<p>I'm not sure which one was the solution so I share two things.</p>\n\n<p><strong>First of all, you have to close all Office applications.</strong></p>\n\n<p><strong>#1</strong><br>\nIn <code>HKEY_CURRENT_USER\\Software\\Microsoft\\Office\\15.0\\Common\\LanguageResources</code> there are more <code>REG_MULTI_SZ</code> Values with data like <code>0;1038;1033;1036</code>.</p>\n\n<p>Delete the unwanted language code from everywhere. (1031 - German, 1036 - French, etc. see link above)<br>\nI deleted 1036 which resulted: <code>0;1038;1033</code></p>\n\n<p>They will be automatically restored after you start Excel, but don't worry about it.</p>\n\n<p><strong>#2</strong><br>\nIn <code>HKEY_CURRENT_USER\\Software\\Microsoft\\Office\\15.0\\Common\\LanguageResources\\EnabledLanguages</code> set unwanted language code from <code>ExplicitOn</code> to <code>Off</code> or <code>On</code>.</p>\n\n<p>It doesn't matter what you set because after next start of Excel it will be set to <code>On</code> automatically. </p>\n\n<p>In my case one or both of these was the solution and VBA's interface language is finally English.</p>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 11756372, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/f935fae1a2e42a6a4b751cf70b21d4ee?s=128&d=identicon&r=PG", "display_name": "IfyouneedaFix", "link": "https://stackoverflow.com/users/11756372/ifyouneedafix"}, "is_accepted": false, "score": 1, "last_activity_date": 1562614949, "creation_date": 1562614949, "answer_id": 56941636, "question_id": 52513747, "link": "https://stackoverflow.com/questions/52513747/changing-language-of-visual-basic-editor-to-english/56941636#56941636", "title": "Changing language of Visual Basic Editor to English", "body": "<p>This worked for me (Windows 10 user).</p>\n\n<p>All settings> Time &amp; Language> Region &amp; Language. </p>\n\n<p>Under \"Preferred Languages\", add the language that you want to use. \nIf that language is already on the list, make sure it's at the top (you can move it by single-clicking on it and using the up/down arrows on the left). </p>\n\n<p>You'll notice a comment under the heading that says: \"Apps and languages will appear in the first language that they support.\"\nIn my case, the top language was Norwegian and the next on the list was Chinese. VBA for some reason wouldn't recognize Norwegian, and assumed Chinese would be the next best thing.\nI installed English (US), moved it to the top of the list, and restarted my computer. Boom.</p>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 12557311, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/9dee44a409aab19767c802b68519255e?s=128&d=identicon&r=PG", "display_name": "B&#248;rge Aune", "link": "https://stackoverflow.com/users/12557311/b%c3%b8rge-aune"}, "edited": false, "score": 0, "creation_date": 1576659190, "post_id": 59388340, "comment_id": 104967342, "body": "In Windows go to -&gt; Start menu -&gt; Microsoft office tools -&gt; Office Language Preferences."}], "tags": [], "owner": {"reputation": 1, "user_id": 12557311, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/9dee44a409aab19767c802b68519255e?s=128&d=identicon&r=PG", "display_name": "B&#248;rge Aune", "link": "https://stackoverflow.com/users/12557311/b%c3%b8rge-aune"}, "is_accepted": false, "score": 0, "last_activity_date": 1576658701, "creation_date": 1576658701, "answer_id": 59388340, "question_id": 52513747, "link": "https://stackoverflow.com/questions/52513747/changing-language-of-visual-basic-editor-to-english/59388340#59388340", "title": "Changing language of Visual Basic Editor to English", "body": "<p><a href=\"https://i.stack.imgur.com/DYpXB.png\" rel=\"nofollow noreferrer\">Change Sort Order to Language</a></p>\n\n<p>Check the order, windows default first, your language so English. This solved the problem for me.</p>\n"}, {"tags": [], "owner": {"reputation": 23, "user_id": 11736046, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Tgb4afYKYjY/AAAAAAAAAAI/AAAAAAAAAl4/rabdhnk37fw/photo.jpg?sz=128", "display_name": "Robert de Clair", "link": "https://stackoverflow.com/users/11736046/robert-de-clair"}, "is_accepted": false, "score": 1, "last_activity_date": 1598192737, "creation_date": 1598192737, "answer_id": 63548084, "question_id": 52513747, "link": "https://stackoverflow.com/questions/52513747/changing-language-of-visual-basic-editor-to-english/63548084#63548084", "title": "Changing language of Visual Basic Editor to English", "body": "<p>I tried above solutions and didn't works for me.\nThis one works and not need administrator rights.</p>\n<p>Close all Office apps.\nOpen any Office app I.E. Excel</p>\n<p>Choose: Options, Language</p>\n<p>Select default language for edition: English (this option probably isnt neccessary but I did this when i looked for solution)\nSet English from order list as top of language for display\nSet English from order list as top of language for help</p>\n<p>Looks like VBA language is based on these two options and is selected in order.\nMy primary language is Polish, and my VBA editor was in Italian.\nTo change VBA language to English i set order from these lists so English is choosed as first language if something can't be displayed in Polish. (previously Italian was as number 3 an this list)\n<a href=\"https://i.stack.imgur.com/ObtPZ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ObtPZ.png\" alt=\"VBA Language setup\" /></a></p>\n"}], "owner": {"reputation": 31, "user_id": 7755482, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/878e3b17f2f494c663be9018b7bc3745?s=128&d=identicon&r=PG&f=1", "display_name": "Cezary Doma\u0144ski", "link": "https://stackoverflow.com/users/7755482/cezary-doma%c5%84ski"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 12787, "favorite_count": 0, "answer_count": 6, "score": 2, "last_activity_date": 1598192737, "creation_date": 1537952170, "last_edit_date": 1579941491, "question_id": 52513747, "link": "https://stackoverflow.com/questions/52513747/changing-language-of-visual-basic-editor-to-english", "title": "Changing language of Visual Basic Editor to English", "body": "<p>After Microsoft Office updated to the 2016 version I found the VBA interface is in German. How can I restore it to English?</p>\n\n<p>My Windows 10 settings are set to English and the local setting preferences are all for English UK as well (dates, decimals etc.).</p>\n\n<p>I set the Office Preference Language to English.</p>\n\n<p><a href=\"https://i.stack.imgur.com/Dvx0d.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Dvx0d.png\" alt=\"Please find screen-shot attached\"></a></p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1537955144, "post_id": 52513667, "comment_id": 91969091, "body": "You need to use a loop and <code>.FINDNEXT</code> as explained <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.range.find\" rel=\"nofollow noreferrer\">here</a>.  There&#39;s also plenty of examples if you search on here for <code>VBA</code> and <code>FINDNEXT</code>."}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 1, "creation_date": 1537956090, "post_id": 52513667, "comment_id": 91969763, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/27959717/find-and-findnext-in-vba\">Find and FindNext in VBA</a>"}], "owner": {"reputation": 1, "user_id": 9223340, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-7Vkf-n7mP7M/AAAAAAAAAAI/AAAAAAAAAsk/HWlP8LNqf2w/photo.jpg?sz=128", "display_name": "ganji madhukar", "link": "https://stackoverflow.com/users/9223340/ganji-madhukar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 188, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1594024856, "creation_date": 1537951920, "last_edit_date": 1594024856, "question_id": 52513667, "link": "https://stackoverflow.com/questions/52513667/excel-vba-find-next-value", "title": "excel vba find next value", "body": "<p>I need to get next record in \"SQL\" sheet. I have written code to find the value from \"temp1\" sheet but i want find next value.</p>\n\n<pre><code>Sub Macro1()\n    Sheets(\"candidate data\").Select\n    With ActiveSheet\n        .Cells(.Rows.Count, 1).End(xlUp).EntireRow.Select\n        .Cells(.Rows.Count, 1).End(xlUp).EntireRow.Copy\n        'Participant details gets updated\n        Sheets(\"Temp1\").Activate\n        'Paste the row in a transpose format\n        Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n                               :=False, Transpose:=True\n        Rows(\"1:1\").Select\n        Application.CutCopyMode = False\n        'Search for email\n        Dim myvar As Variant\n        'Store the name of the assessee in a variable\n        myvar = Worksheets(\"Temp1\").Range(\"A8\").Value\n        'Search for this assesee name in the list and select the row where the candidate name is there\n        'but i need find next value at this point from \"SQL\" sheet and paste the value in \"temp2\" sheet\n        Sheets(\"SQL\").Select\n        Cells.Find(What:=myvar, after:=ActiveCell, LookIn:= _\n                   xlFormulas, LookAt:=xlPart, SearchOrder:=xlByRows, SearchDirection:= _\n                   xlNext, MatchCase:=False, SearchFormat:=False).Activate\n        'Select the entire row\n        ActiveCell.EntireRow.Copy\n        'Participant details gets updated\n        Sheets(\"Temp2\").Activate\n        'Paste the row in a transpose format\n        Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n                               :=False, Transpose:=True\n        Rows(\"1:1\").Select\n        Application.CutCopyMode = False\n\n    End With\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 951, "user_id": 4207055, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LYMqh.png?s=128&g=1", "display_name": "Guy Louzon", "link": "https://stackoverflow.com/users/4207055/guy-louzon"}, "edited": false, "score": 1, "creation_date": 1537951624, "post_id": 52513539, "comment_id": 91966840, "body": "Can you add a sample of the excel, and the VBA function ?"}, {"owner": {"reputation": 558, "user_id": 7778672, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/2LGnC.jpg?s=128&g=1", "display_name": "Inarion", "link": "https://stackoverflow.com/users/7778672/inarion"}, "edited": false, "score": 0, "creation_date": 1537952639, "post_id": 52513539, "comment_id": 91967483, "body": "Then the obvious question would be: Does the Lookup actually return anything?"}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 1, "creation_date": 1537952726, "post_id": 52513539, "comment_id": 91967532, "body": "What if you change the watch to <code>ThisWorkbook.Worksheets(&quot;Sheet1&quot;).Cells(11, 4)</code>?  Not sure if a watch continues to look at the initial <code>Activesheet</code> as you change sheets."}], "answers": [{"comments": [{"owner": {"reputation": 558, "user_id": 7778672, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/2LGnC.jpg?s=128&g=1", "display_name": "Inarion", "link": "https://stackoverflow.com/users/7778672/inarion"}, "edited": false, "score": 0, "creation_date": 1537955163, "post_id": 52514132, "comment_id": 91969113, "body": "You need to clarify what the <code>Lookup</code> function is doing in both scenarios. Does it return a value? An error? How do you expect us to answer your question with only knowing half of what&#39;s going on?"}, {"owner": {"reputation": 371, "user_id": 1681788, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/a727980561588ff2c6577dd5d903c895?s=128&d=identicon&r=PG", "display_name": "Mark Barnes", "link": "https://stackoverflow.com/users/1681788/mark-barnes"}, "reply_to_user": {"reputation": 558, "user_id": 7778672, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/2LGnC.jpg?s=128&g=1", "display_name": "Inarion", "link": "https://stackoverflow.com/users/7778672/inarion"}, "edited": false, "score": 0, "creation_date": 1537976181, "post_id": 52514132, "comment_id": 91982471, "body": "@Inarion - in both scenarios the <code>Lookup</code> function returns exactly the same result.  As I said, there&#39;s no data in rows 1000-10000, so changing the size of the lookup won&#39;t make any difference. That&#39;s what&#39;s confusing."}, {"owner": {"reputation": 558, "user_id": 7778672, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/2LGnC.jpg?s=128&g=1", "display_name": "Inarion", "link": "https://stackoverflow.com/users/7778672/inarion"}, "edited": false, "score": 0, "creation_date": 1538059184, "post_id": 52514132, "comment_id": 92018694, "body": "It seems to me the issue is too complex (especially when only seen remotely and with limited information). What I&#39;d try to do is to strip away parts of the surroundings (data, parts of the formula, whatever else there is) until the problem stops occuring. Then you&#39;ve got yourself a fine <a href=\"https://stackoverflow.com/help/mcve\">MCVE</a> that the experts (and aspiring experts) here can examine."}, {"owner": {"reputation": 371, "user_id": 1681788, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/a727980561588ff2c6577dd5d903c895?s=128&d=identicon&r=PG", "display_name": "Mark Barnes", "link": "https://stackoverflow.com/users/1681788/mark-barnes"}, "reply_to_user": {"reputation": 558, "user_id": 7778672, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/2LGnC.jpg?s=128&g=1", "display_name": "Inarion", "link": "https://stackoverflow.com/users/7778672/inarion"}, "edited": false, "score": 0, "creation_date": 1538157243, "post_id": 52514132, "comment_id": 92059513, "body": "I&#39;m guessing, but I think the problem is caused by an issue to do with the order in which functions are calculated. For some reason, when the <code>LOOKUP</code> function has many rows, it&#39;s calculated after my function, and so my function returns no value. That problem doesn&#39;t actually affect my worksheet, because as soon as the <code>LOOKUP</code> function is calculated, Excel goes back to my VBA function and runs it again. So looking at the Worksheet, you wouldn&#39;t know it was running twice. It&#39;s only when you add breakpoints that you see it happening and get confused, as I did."}], "tags": [], "owner": {"reputation": 371, "user_id": 1681788, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/a727980561588ff2c6577dd5d903c895?s=128&d=identicon&r=PG", "display_name": "Mark Barnes", "link": "https://stackoverflow.com/users/1681788/mark-barnes"}, "is_accepted": false, "score": 0, "last_activity_date": 1537953359, "creation_date": 1537953359, "answer_id": 52514132, "question_id": 52513539, "link": "https://stackoverflow.com/questions/52513539/why-would-cellsx-y-value-return-empty-for-non-empty-cells-in-excel-vba/52514132#52514132", "title": "Why would Cells(x,y).Value return empty for non-empty cells in Excel VBA?", "body": "<p>I've answered my second question, \"how do I stop Cells(11,4).Value returning Empty?\".</p>\n\n<p>If I change</p>\n\n<p><code>LOOKUP(2,1/(D18:D9998&lt;&gt;\"\"),$B18:$B9998)</code></p>\n\n<p>to</p>\n\n<p><code>LOOKUP(2,1/(D18:D999&lt;&gt;\"\"),$B18:$B999)</code></p>\n\n<p>Then the problem goes away. (There's no data in rows 1000-10000, by the way. I just put in a very large number to be sure the formula would still work in the future.)</p>\n\n<p>I haven't yet answered my first question: \"why?\". Bug? Limitation? Something else?</p>\n"}], "owner": {"reputation": 371, "user_id": 1681788, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/a727980561588ff2c6577dd5d903c895?s=128&d=identicon&r=PG", "display_name": "Mark Barnes", "link": "https://stackoverflow.com/users/1681788/mark-barnes"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 451, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1537953359, "creation_date": 1537951461, "last_edit_date": 1537952344, "question_id": 52513539, "link": "https://stackoverflow.com/questions/52513539/why-would-cellsx-y-value-return-empty-for-non-empty-cells-in-excel-vba", "title": "Why would Cells(x,y).Value return empty for non-empty cells in Excel VBA?", "body": "<p>I have an Excel VBA function. In a loop, I use <code>Cells(x,y).Value</code> to return the value of certain cells. But sometimes that returns empty, even the cell is not empty.</p>\n\n<p>One example in my worksheet is <code>Cells(11,4).Value</code>. So I placed both <code>Cells(11,4)</code> and <code>Cells(11,4).Value</code> in Watches.</p>\n\n<p>In Watches, drilling down into <code>Cells(11,4)</code> shows <strong>Text</strong> to be \"42.71%\", and <strong>Value2</strong> to be \"0.42708218178176\", which is what I would expect.</p>\n\n<p>But also in Watches, <code>Cells(11,4).Value</code> still shows \"Empty\".</p>\n\n<p>Adding to the mystery, if I delete another watch, then <code>Cells(11,4).Value</code> will suddenly now be populated!</p>\n\n<p><a href=\"https://i.stack.imgur.com/vbfEI.gif\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/vbfEI.gif\" alt=\"enter image description here\"></a></p>\n\n<p>The obvious questions are:</p>\n\n<ul>\n<li>Why?</li>\n<li>What can I do to stop <code>Cells(11,4).Value</code> returning Empty?</li>\n</ul>\n\n<p><strong>Edited to add:</strong>\nThe VBA is lengthy and irrelevant (i.e. if I strip it back to a single line, I get the same result).</p>\n\n<p>More relevant is the formula contained in cell D11 (the cell I'm interested in). It's this:\n=<code>(((D8+D9)/D5)^(1/(DATEDIF(D3,IF(D6&gt;0,D6,LOOKUP(2,1/(D18:D9998&lt;&gt;\"\"),$B18:$B9998)),\"d\")/365.25))-1)</code></p>\n\n<p>That <code>IF</code> function returns two possible values: <code>D6</code> or <code>LOOKUP(2,1/(D18:D9998&lt;&gt;\"\"),$B18:$B9998)</code>. (The latter is intended to get the value from column B for the last value in column D.)</p>\n\n<p>If I put a value in <code>D6</code> (so the <code>IF</code> statement doesn't do the LOOKUP), then <code>Cells.Value</code> returns the correct result. If there's no value in <code>D6</code>, and the <code>IF</code> statement returns the <code>LOOKUP</code> formula, then <code>Cells.Value</code> will return <code>Empty</code>.</p>\n"}, {"tags": ["html", "excel", "vba", "web-scraping", "custom-function"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1537953965, "post_id": 52513408, "comment_id": 91968315, "body": "You would need a default URL as otherwise how are you going to pass an URL to GetHTML on workbook open (prompt?) ?  How are you doing to update that URL when you want to change it? Can you provide an actual URL and the full fromthewebpage function with example call and expected results? It doesn&#39;t sound like a UDF is the ideal way to go. Why can&#39;t you use a sub to deliver the array results to the sheet and then have your function access that area of the sheet? Or even better just use formulas?"}, {"owner": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "edited": false, "score": 0, "creation_date": 1538060993, "post_id": 52513408, "comment_id": 92019907, "body": "You may just declare <code>udarray</code> variable as static within <code>fromthewebpage</code> function and store the array once you parse all the data. When call the function, first check if array is populated, and if no, parse the data."}], "answers": [{"tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": false, "score": 1, "last_activity_date": 1537956206, "last_edit_date": 1537956206, "creation_date": 1537955761, "answer_id": 52514958, "question_id": 52513408, "link": "https://stackoverflow.com/questions/52513408/vba-gethtml-as-custom-function-avoid-several-html-retrivals/52514958#52514958", "title": "VBA: getHTML as custom function - Avoid several HTML retrivals", "body": "<p>So, I mentioned in comments the idea of using a sub to retrieve the HTML info and returning your array to the sheet. You can then use a function or formulas to index into that info.</p>\n\n<p>In the case below the sub picks the URL up from worksheet1 range A1. You could tie the sub to a button or a worksheet change event with target being A1 so updates when URL is changed.</p>\n\n<p>The below is illustrative. I use StackOverflow question links to populate an array of what I believe to be your specified dimensions (easy to change though if not). </p>\n\n<p><code>GetHTML</code> returns the array to the sheet. The function <code>GetInfo</code> allows you to index into that array and return an item by specifying the row and column in the array. It is to mirror your specifying two arguments into a function signature to retrieve a string.</p>\n\n<pre><code>Option Explicit\nPublic Sub GetHTML()\n    Dim html As htmldocument, ws As Worksheet\n    Set html = New htmldocument: Set ws = ThisWorkbook.Worksheets(\"Sheet1\")\n    On Error GoTo errhand\n    With CreateObject(\"MSXML2.XMLHTTP\")\n        .Open \"GET\", ws.[A1], False\n        .Send\n        html.body.innerhtml = .ResponseText\n    End With\n\n    Dim arr(0 To 13, 0 To 4)\n    Dim i As Long, r As Long, c As Long\n    Dim aNodeList As Object\n    Set aNodeList = html.querySelectorAll(\"#question-mini-list h3 &gt; a[href]\")\n    For i = 0 To (14 * 5) - 1\n       If i = 0 Then\n           arr(r, c) = aNodeList.Item(i)\n       ElseIf i Mod 5 = 0 And i &lt;&gt; 0 Then\n           r = r + 1: c = 0\n           arr(r, c) = aNodeList.Item(i)\n       Else\n          c = c + 1\n          arr(r, c) = aNodeList.Item(i)\n       End If\n    Next\n\n    ws.[B1].Resize(UBound(arr, 1) + 1, UBound(arr, 2) + 1) = arr\nerrhand:\n    If Err.Number &lt;&gt; 0 Then Err.Clear\nEnd Sub\n\nPublic Function GetInfo(ByVal r As Long, ByVal c As Long) As String\n    GetInfo = ThisWorkbook.Worksheets(\"Sheet1\").Range(\"B1:F14\").Cells(r + 1, c + 1)\nEnd Function\n</code></pre>\n\n<hr>\n\n<p><strong>In sheet UDF call:</strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/D78t4.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/D78t4.png\" alt=\"enter image description here\"></a></p>\n\n<hr>\n\n<p><strong>Worksheet_Change event</strong></p>\n\n<p>If linking sub <code>GetHTML</code> execution to a <code>Worksheet_Change</code> event with URL in A1 then in sheet 1 code pane:</p>\n\n<pre><code>Option Explicit\nPrivate Sub Worksheet_Change(ByVal Target As Range)\n    Application.EnableEvents = False\n    If Target.Address = [A1].Address Then\n        GetHTML\n    End If\n    Application.EnableEvents = True\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 527, "user_id": 2523167, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/17ca2b603237786878dade33be4b7c5d?s=128&d=identicon&r=PG", "display_name": "user2523167", "link": "https://stackoverflow.com/users/2523167/user2523167"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 253, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1557473635, "creation_date": 1537950967, "last_edit_date": 1557473635, "question_id": 52513408, "link": "https://stackoverflow.com/questions/52513408/vba-gethtml-as-custom-function-avoid-several-html-retrivals", "title": "VBA: getHTML as custom function - Avoid several HTML retrivals", "body": "<p>I am using this to retrieve HTML from a webpage</p>\n\n<pre><code>Function GetHTML(url As String) As String    \n    With CreateObject(\"MSXML2.XMLHTTP\")\n        .Open \"GET\", url, False\n        .Send\n        GetHTML = .ResponseText\n    End With\n\nEnd Function\n</code></pre>\n\n<p>I have created another custom function (fromthewebpage) to extract info from the HTML and put it into an 2d array.</p>\n\n<pre><code>Function fromthewebpage(month,user)\n    testtext=GetHTML(\"http://example.com\")\n    ....\n    ....\n    fromthewebpage= udarray(month,user)\nEnd function\n</code></pre>\n\n<p>When I need the info in the sheet I recall it with =fromthewebpage(x,y) in a cell.</p>\n\n<p>But the size of the array is 13*4 and I need the whole array and each use of the fromthewebpage(x,y) function call GetHTML independently, resulting in 52 retrievals of the page. Are there ways to only call GetHTML once and reuse that info for each use of fromthewebpage.</p>\n\n<p>I imagine either 1) calling GetHTML when opening the workbook and storing the info in a persistent array that I can reference when using fromthewebpage or 2) making fromthewebpage an array function. But I don\u00b4t know if that is possible and how to do it.</p>\n"}, {"tags": ["excel", "vba", "copy-paste"], "answers": [{"comments": [{"owner": {"reputation": 149, "user_id": 9534456, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/518d95ecc6ddc3a203e0b2cf9e60e698?s=128&d=identicon&r=PG&f=1", "display_name": "kit99", "link": "https://stackoverflow.com/users/9534456/kit99"}, "edited": false, "score": 0, "creation_date": 1537951876, "post_id": 52513541, "comment_id": 91967006, "body": "Thanks, but this script does not take into account that there is an empty row between each team/person/town-section. It fills in team name in empty rows as well... I could of course run a script to remove empty rows, but is there a way to take these rows into account in your script?"}, {"owner": {"reputation": 951, "user_id": 4207055, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LYMqh.png?s=128&g=1", "display_name": "Guy Louzon", "link": "https://stackoverflow.com/users/4207055/guy-louzon"}, "reply_to_user": {"reputation": 149, "user_id": 9534456, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/518d95ecc6ddc3a203e0b2cf9e60e698?s=128&d=identicon&r=PG&f=1", "display_name": "kit99", "link": "https://stackoverflow.com/users/9534456/kit99"}, "edited": false, "score": 0, "creation_date": 1537952033, "post_id": 52513541, "comment_id": 91967102, "body": "Can you add some sample data / a small image with an example ? it&#39;s hard to imagine by your description, even without that edge case..."}], "tags": [], "owner": {"reputation": 951, "user_id": 4207055, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LYMqh.png?s=128&g=1", "display_name": "Guy Louzon", "link": "https://stackoverflow.com/users/4207055/guy-louzon"}, "is_accepted": false, "score": 0, "last_activity_date": 1537951464, "creation_date": 1537951464, "answer_id": 52513541, "question_id": 52513264, "link": "https://stackoverflow.com/questions/52513264/excel-vba-how-to-copy-paste-when-range-varies/52513541#52513541", "title": "Excel vba - How to copy/paste when range varies", "body": "<p>Actually wrote such a script myselft a few years ago, since a lot of analytics toolds exports information to excel like that</p>\n\n<p>Select the range you want to work on, i.e A1:A7000, and run the script:</p>\n\n<pre><code>Sub fill2()\n Dim cell As Object\n For Each cell In Selection\n    If cell = \"\" Then cell = cell.OffSet(-1, 0)\n Next cell\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 149, "user_id": 9534456, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/518d95ecc6ddc3a203e0b2cf9e60e698?s=128&d=identicon&r=PG&f=1", "display_name": "kit99", "link": "https://stackoverflow.com/users/9534456/kit99"}, "edited": false, "score": 1, "creation_date": 1537952571, "post_id": 52513624, "comment_id": 91967446, "body": "Why all the headache when it can be solved in such an easy way... :-) Thanks a lot for helping out!"}, {"owner": {"reputation": 984, "user_id": 4111774, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/--M62DZJBeLQ/AAAAAAAAAAI/AAAAAAAAAFM/LAIHBy_xpqM/photo.jpg?sz=128", "display_name": "Lookaji", "link": "https://stackoverflow.com/users/4111774/lookaji"}, "edited": false, "score": 0, "creation_date": 1537952994, "post_id": 52513624, "comment_id": 91967694, "body": "Sure enough, but the VBA approach gives total flexibility in all cases where you need to make something more like introducing parameters in the future :)"}], "tags": [], "owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "is_accepted": false, "score": 1, "last_activity_date": 1537951780, "creation_date": 1537951780, "answer_id": 52513624, "question_id": 52513264, "link": "https://stackoverflow.com/questions/52513264/excel-vba-how-to-copy-paste-when-range-varies/52513624#52513624", "title": "Excel vba - How to copy/paste when range varies", "body": "<p>If you're ok with a formula only approach you could add this formula to cell D2 and copy down.  </p>\n\n<pre><code>=IF(B2&lt;&gt;\"\",IF(A2=\"\",D1,A2),\"\")\n</code></pre>\n\n<p>Then copy column D and paste values into column A.</p>\n"}, {"comments": [{"owner": {"reputation": 149, "user_id": 9534456, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/518d95ecc6ddc3a203e0b2cf9e60e698?s=128&d=identicon&r=PG&f=1", "display_name": "kit99", "link": "https://stackoverflow.com/users/9534456/kit99"}, "edited": false, "score": 0, "creation_date": 1537954712, "post_id": 52513924, "comment_id": 91968764, "body": "This one works great, and like you say, it does take empty rows into account. Thanks a lot! :-)"}], "tags": [], "owner": {"reputation": 984, "user_id": 4111774, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/--M62DZJBeLQ/AAAAAAAAAAI/AAAAAAAAAFM/LAIHBy_xpqM/photo.jpg?sz=128", "display_name": "Lookaji", "link": "https://stackoverflow.com/users/4111774/lookaji"}, "is_accepted": true, "score": 1, "last_activity_date": 1537952791, "creation_date": 1537952791, "answer_id": 52513924, "question_id": 52513264, "link": "https://stackoverflow.com/questions/52513264/excel-vba-how-to-copy-paste-when-range-varies/52513924#52513924", "title": "Excel vba - How to copy/paste when range varies", "body": "<p>I came up with a quick solution that takes into account blank lines:</p>\n\n<pre><code>Option Explicit\n\nSub completeTeams()\n    Dim i As Long\n    Const startDataRow = 2\n    Dim lastDataRow As Long\n    Dim lastTeamRow As Long\n\n    Dim lastTeamFound As String\n    Dim teamCellData As String\n\n    Dim isEmptyLine As Boolean\n\n    Rem getting the last row with data (so using column B or C)\n    lastDataRow = ActiveSheet.Cells(ActiveSheet.Rows.Count, \"B\").End(xlUp).Row\n\n    teamCellData = vbNullString\n    lastTeamFound = ActiveSheet.Cells(startDataRow, \"A\").Text\n\n    For i = startDataRow To lastDataRow\n        Rem trying to get the actual team name\n        teamCellData = ActiveSheet.Cells(i, \"A\").Text\n\n        Rem check to skip empty lines\n        isEmptyLine = Len(teamCellData) = 0 And Len(ActiveSheet.Cells(i, \"B\").Text) = 0\n        If isEmptyLine Then GoTo skipBlankLine\n\n        If Len(teamCellData) &gt; 0 Then\n            lastTeamFound = teamCellData\n        End If\n\n        ActiveSheet.Cells(i, \"A\").Value = lastTeamFound\n\nskipBlankLine:\n    Next\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 149, "user_id": 9534456, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/518d95ecc6ddc3a203e0b2cf9e60e698?s=128&d=identicon&r=PG&f=1", "display_name": "kit99", "link": "https://stackoverflow.com/users/9534456/kit99"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 368, "favorite_count": 0, "accepted_answer_id": 52513924, "answer_count": 3, "score": 0, "last_activity_date": 1594050995, "creation_date": 1537950483, "last_edit_date": 1594050995, "question_id": 52513264, "link": "https://stackoverflow.com/questions/52513264/excel-vba-how-to-copy-paste-when-range-varies", "title": "Excel vba - How to copy/paste when range varies", "body": "<p>Got a sheet holding 7000 rows. Data is in columns A-C. Column A is teams, B is persons, and C is towns. Row 1 holds headers.\nCell A2 is the first team name. Cell B2: C23 is persons and towns (no empty cells). However, cell A3: A23 is empty. The team name is only written out for the first row of persons/towns.</p>\n\n<p>Row 24 is blank. \nIn A25 there is a new team name. B25:C38 is persons/towns. A26: A38 is empty.</p>\n\n<p>What I want to do is to copy/paste team name in A2 down to empty cells in A3: A23. And then do the same with the team name in A25 to A26: A38. And so on down about 7000 rows for 370 teams.</p>\n\n<p>But the number of rows in use for each team varies, so how can a VBA take this into account? \nThe only fixed information is that there is an empty row between each team/person/town-section. </p>\n"}, {"tags": ["vba", "ms-word"], "comments": [{"owner": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 0, "creation_date": 1537971209, "post_id": 52512830, "comment_id": 91979153, "body": "Okay, you can use the <a href=\"http://vbadud.blogspot.com/2008/07/add-words-to-autocorrect-entries.html\" rel=\"nofollow noreferrer\">AutoCorrect</a> feature to replace text with other text which, while it may not cover all of the cases you listed, should cover some of them (ex replace: <code>&quot;&#47;&quot;</code> with: <code>&quot; &#47; &quot;</code>)"}, {"owner": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 0, "creation_date": 1537971301, "post_id": 52512830, "comment_id": 91979217, "body": "Otherwise it might make more sense to use replace or find and then navigate a handful of characters left and right of the found range instead of having it loop through every single character in the document"}, {"owner": {"reputation": 9249, "user_id": 9170274, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BrcC8.jpg?s=128&g=1", "display_name": "macropod", "link": "https://stackoverflow.com/users/9170274/macropod"}, "edited": false, "score": 1, "creation_date": 1537972649, "post_id": 52512830, "comment_id": 91980139, "body": "@Willie-Taljaard You might want to rethink what you&#39;re doing. Applying double spaces after every . could make a real mess of abbreviations such as e.g., i.e., etc. Applying double spaces after every : can make a mess of times, ratios, biblical chapter:verse references and so on. Applying spaces before &amp; after every / could make a mess of dates &amp; fractions, as well as to common expressions like and/or."}], "owner": {"reputation": 1, "user_id": 6503421, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-yOj-R0dH4fU/AAAAAAAAAAI/AAAAAAAAArQ/sxQTUGO9LUY/photo.jpg?sz=128", "display_name": "Willie Taljaard", "link": "https://stackoverflow.com/users/6503421/willie-taljaard"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 68, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1537948959, "creation_date": 1537948959, "question_id": 52512830, "link": "https://stackoverflow.com/questions/52512830/ms-word-vba-how-to-make-my-macro-faster-to-insert-a-space-before-and-after-a-ch", "title": "MS Word VBA how to make my macro faster, to insert a space before and after a character withe condition&#39;s to when to insert the space&#39;s?", "body": "<p>I need a Macro for MS Word that will check the document and apply rules to a\"/\" \":\" and a \".\" it  must add a \"Space\" before and after a \"/\" It must add s \"Space\"\"Space\" after a \":\" and a\".\" only if there is not \"space's\" as described. </p>\n\n<p>I have used the (Selection.MoveRight Unit:=wdCharacter, Count:=-1, Extend:=wdMove)  to move the cursor to the place where checks and changes must take place. It work but is unbelievable slow</p>\n\n<p>Hear is my code:</p>\n\n<p>Sub FIX_Space1()</p>\n\n<pre><code>Dim Title As String\nDim CharCount As Integer\nDim Message As String\nDim Char1 As String\nDim NextChar As String\nDim NextChar1 As String\nDim x As Long\n\nActiveDocument.Range(0, 0).Select\nSelection.WholeStory\n\nTitle = \"CharCount\"\nCharCount = Len(Selection)\n\n\nFor x = 0 To CharCount\n    ActiveDocument.Range(0, 0).Select\n    Selection.MoveRight Unit:=wdCharacter, Count:=x, Extend:=wdMove\n    NextChar = Selection\n    '## check for \"/\"\n    If NextChar = \"/\" Then\n       'Check for space one back\n       Selection.MoveRight Unit:=wdCharacter, Count:=-1, Extend:=wdMove\n       NextChar1 = Selection\n       If NextChar1 = \" \" Then\n       Else\n        Selection.MoveRight Unit:=wdCharacter, Count:=1, Extend:=wdMove\n        Selection.Text = \" \"\n       End If\n       'Check for space one forward\n       Selection.MoveRight Unit:=wdCharacter, Count:=2, Extend:=wdMove\n       NextChar1 = Selection\n       If NextChar1 = \" \" Then\n       Else\n        Selection.Text = \" \"\n       End If\n    End If\n\n    '## check for \":\"\n    If NextChar = \":\" Then\n       'Check for : one forward\n       Selection.MoveRight Unit:=wdCharacter, Count:=1, Extend:=wdMove\n       NextChar1 = Selection\n       If NextChar1 = \" \" Then\n            Selection.MoveRight Unit:=wdCharacter, Count:=1, Extend:=wdMove\n            NextChar1 = Selection\n            If NextChar1 = \" \" Then\n            Else\n                Selection.Text = \" \"\n            End If\n       Else\n        Selection.Text = \"  \"\n       End If\n    End If\n\n    '## check for \".\"\n    If NextChar = \".\" Then\n       'Check for : one forward\n       Selection.MoveRight Unit:=wdCharacter, Count:=1, Extend:=wdMove\n       NextChar1 = Selection\n       If NextChar1 = \" \" Then\n            Selection.MoveRight Unit:=wdCharacter, Count:=1, Extend:=wdMove\n            NextChar1 = Selection\n            If NextChar1 = \" \" Then\n            Else\n                Selection.Text = \" \"\n            End If\n       Else\n        Selection.Text = \"  \"\n       End If\n    End If\n\nNext x\n</code></pre>\n\n<p>End Sub</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "edited": false, "score": 0, "creation_date": 1537950405, "post_id": 52512757, "comment_id": 91966137, "body": "What have you tried so far?"}, {"owner": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "edited": false, "score": 0, "creation_date": 1537950514, "post_id": 52512757, "comment_id": 91966202, "body": "Welcome to SO. <i>Will VBA work for users using lower version of Excel?</i> Please, specify what you consider lower version of Excel, but probably yes, it will work in mostly cases. Also check out the <a href=\"https://stackoverflow.com/tour\">tour</a>, and more good information at <a href=\"https://stackoverflow.com/help/on-topic\">&quot;help center&quot;.</a>"}, {"owner": {"reputation": 1, "user_id": 10417378, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5a54016d8940206c60c2795cc02353f?s=128&d=identicon&r=PG&f=1", "display_name": "Whip B", "link": "https://stackoverflow.com/users/10417378/whip-b"}, "reply_to_user": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "edited": false, "score": 0, "creation_date": 1537951099, "post_id": 52512757, "comment_id": 91966523, "body": "@Tom I&#39;ve tried following this but I am not sure how to change the code based on my conditions as I am quite an amateur with Excel <a href=\"https://stackoverflow.com/questions/35382249/lock-unlock-a-cell-using-conditional-formatting\" title=\"lock unlock a cell using conditional formatting\">stackoverflow.com/questions/35382249/&hellip;</a>"}, {"owner": {"reputation": 1, "user_id": 10417378, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5a54016d8940206c60c2795cc02353f?s=128&d=identicon&r=PG&f=1", "display_name": "Whip B", "link": "https://stackoverflow.com/users/10417378/whip-b"}, "reply_to_user": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "edited": false, "score": 0, "creation_date": 1537951326, "post_id": 52512757, "comment_id": 91966661, "body": "@FoxfireAndBurnsAndBurns I&#39;m using Excel 2016. Previously I&#39;ve made an automated tax calculator based on salary range inputted by user. I used IF for that and some users complained that the tax amount was not displayed/auto computed even after I saved the file to lower version."}, {"owner": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "edited": false, "score": 0, "creation_date": 1537951900, "post_id": 52512757, "comment_id": 91967023, "body": "Normal Excel formulas should not cause any issue between different Excel versions. Anyways, about your question, I think the only way to do it is if you develop a code in VBA to lock/unlock D3 with your criteria."}], "owner": {"reputation": 1, "user_id": 10417378, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5a54016d8940206c60c2795cc02353f?s=128&d=identicon&r=PG&f=1", "display_name": "Whip B", "link": "https://stackoverflow.com/users/10417378/whip-b"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 53, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1537951553, "creation_date": 1537948702, "last_edit_date": 1537951553, "question_id": 52512757, "link": "https://stackoverflow.com/questions/52512757/cell-locked-unlocked-based-on-condition-in-other-cell", "title": "Cell Locked / Unlocked based on Condition in Other Cell", "body": "<p>Seek assistance for the following.\nI'm trying to create a template to minimise user's data input therefore it is a protected sheet except for several cells where I'll unlock the cell to allow user to key-in their figure.</p>\n\n<p>I'm trying to achieve the following.</p>\n\n<p>Cell D3 will be conditioned based on the YES/NO drop down menu in cell C3.<br>\nIf YES selected, user will be able to key-in their figure<br>\nIf NO selected, cell will be locked and value from A3 will be taken</p>\n\n<p>I believe this involves VBA; which brings to my next question:</p>\n\n<p>Will VBA work for users using lower version of Excel?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1537948650, "post_id": 52512590, "comment_id": 91965102, "body": "Do you really need to use <code>Application.Inputbox</code> rather than VBA&#39;s <code>Inputbox</code>?"}, {"owner": {"reputation": 2923, "user_id": 4497791, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/vCgRs.png?s=128&g=1", "display_name": "eirikdaude", "link": "https://stackoverflow.com/users/4497791/eirikdaude"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1537948868, "post_id": 52512590, "comment_id": 91965236, "body": "@Rory I like being able to force the valuetype in application.inputbox. Is the cancel value simpler to catch from a regular inputbox?"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1537949135, "post_id": 52512590, "comment_id": 91965388, "body": "Not really, just a different method. You could use <code>If VarType(testvalue) = vbBoolean Then</code> to catch the Cancel."}], "answers": [{"comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1537956404, "post_id": 52513134, "comment_id": 91969937, "body": "This only works with <code>VBA.Inputbox</code>, not <code>Application.Inputbox</code> which is what is being used here."}, {"owner": {"reputation": 1534, "user_id": 5373986, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5937e22068b8355cf94c4c18f747660f?s=128&d=identicon&r=PG&f=1", "display_name": "Taazar", "link": "https://stackoverflow.com/users/5373986/taazar"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1537956753, "post_id": 52513134, "comment_id": 91970159, "body": "@Rory If you look at his second example of code he does use <code>VBA.InputBox</code>. There isn&#39;t really any difference between them that would stop him changing that one input box."}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1538037613, "post_id": 52513134, "comment_id": 92004923, "body": "Apologies - I didn&#39;t see that the original question had been edited to add that."}], "tags": [], "owner": {"reputation": 1534, "user_id": 5373986, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5937e22068b8355cf94c4c18f747660f?s=128&d=identicon&r=PG&f=1", "display_name": "Taazar", "link": "https://stackoverflow.com/users/5373986/taazar"}, "is_accepted": false, "score": 0, "last_activity_date": 1537950029, "creation_date": 1537950029, "answer_id": 52513134, "question_id": 52512590, "link": "https://stackoverflow.com/questions/52512590/differentiate-between-entering-0-and-pressing-cancel-in-application-inputbox/52513134#52513134", "title": "Differentiate between entering 0 and pressing cancel in application.inputbox", "body": "<p>Instead of <code>VarType</code> you can use <code>StrPtr</code> which will only give 0 if the input box was cancelled, although I'm not sure how it reacts to <code>Application.InputBox()</code>. If you are using just the standard <code>InputBox()</code> however it works perfectly, therefore to detect a cancelled <code>InputBox</code> you would add this into your code:</p>\n\n<pre><code>If StrPtr(testvalue) = 0 Then\n    Call MsgBox(\"Input cancelled.\", \"Cancelled\")\nEnd If\n</code></pre>\n\n<p>*Something to be aware of when using this method is that it relies on buggy behaviour in <code>InputBox</code>. Microsoft aren't going to fix it as it would break a lot of people's code but it is something to take note of.</p>\n"}, {"comments": [{"owner": {"reputation": 1534, "user_id": 5373986, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5937e22068b8355cf94c4c18f747660f?s=128&d=identicon&r=PG&f=1", "display_name": "Taazar", "link": "https://stackoverflow.com/users/5373986/taazar"}, "edited": false, "score": 0, "creation_date": 1537950654, "post_id": 52513263, "comment_id": 91966278, "body": "If you want the code to react differently to cancel and an empty input make sure to keep <code>Len</code> and <code>StrPtr</code> in two separate if statements with the <code>StrPtr</code> being first as it doesn&#39;t give 0 for an empty input."}, {"owner": {"reputation": 2923, "user_id": 4497791, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/vCgRs.png?s=128&g=1", "display_name": "eirikdaude", "link": "https://stackoverflow.com/users/4497791/eirikdaude"}, "reply_to_user": {"reputation": 1534, "user_id": 5373986, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5937e22068b8355cf94c4c18f747660f?s=128&d=identicon&r=PG&f=1", "display_name": "Taazar", "link": "https://stackoverflow.com/users/5373986/taazar"}, "edited": false, "score": 0, "creation_date": 1537951246, "post_id": 52513263, "comment_id": 91966613, "body": "You are actually right that they behave differently - upon testing <code>StrPtr</code> returns 528887244 (and on the second test 522748828) while <code>Len</code> returned 5 both times I pressed cancel. At any rate, I can&#39;t use either, so I&#39;ll remove that paragraph. @Taazar"}], "tags": [], "owner": {"reputation": 2923, "user_id": 4497791, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/vCgRs.png?s=128&g=1", "display_name": "eirikdaude", "link": "https://stackoverflow.com/users/4497791/eirikdaude"}, "is_accepted": false, "score": 1, "last_activity_date": 1537951338, "last_edit_date": 1537951338, "creation_date": 1537950477, "answer_id": 52513263, "question_id": 52512590, "link": "https://stackoverflow.com/questions/52512590/differentiate-between-entering-0-and-pressing-cancel-in-application-inputbox/52513263#52513263", "title": "Differentiate between entering 0 and pressing cancel in application.inputbox", "body": "<p>Apparently <code>double</code> is a numerical type as well >_> Chalk this one up to me being stupid, checking for the wrong thing, and making the wrong assumptions. Thanks to rory in the comments for getting me to check further on what types the various functions returned.</p>\n\n<p>To be more explicit, when a numerical value is entered into <code>Application.InputBox</code>, it returns a <code>Double</code>, so that is what I should check for when wanting to ensure a numerical value. </p>\n"}, {"comments": [{"owner": {"reputation": 2923, "user_id": 4497791, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/vCgRs.png?s=128&g=1", "display_name": "eirikdaude", "link": "https://stackoverflow.com/users/4497791/eirikdaude"}, "edited": false, "score": 0, "creation_date": 1537951588, "post_id": 52513378, "comment_id": 91966819, "body": "Hi, I don&#39;t know if you saw the answer I posted before posting your own, but my issue was basically that I was checking for the wrong numerical type. Checking if the type is boolean will work even if the inputbox doesn&#39;t accept that as a valid input. This was more of a goof-up on my part than anything else."}], "tags": [], "owner": {"reputation": 3078, "user_id": 8537807, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2J8ds.png?s=128&g=1", "display_name": "EvR", "link": "https://stackoverflow.com/users/8537807/evr"}, "is_accepted": false, "score": 0, "last_activity_date": 1537950878, "creation_date": 1537950878, "answer_id": 52513378, "question_id": 52512590, "link": "https://stackoverflow.com/questions/52512590/differentiate-between-entering-0-and-pressing-cancel-in-application-inputbox/52513378#52513378", "title": "Differentiate between entering 0 and pressing cancel in application.inputbox", "body": "<p>You could adjust your type to 1+4 and check for the Vartype</p>\n\n<pre><code>Sub test()\n    Dim testvalue As Variant\n\n    testvalue = Application.InputBox(Prompt:=\"Whatever\", Title:=\"Whatever\", Default:=10, Type:=5)\n\n    If VarType(testvalue) &lt;&gt; vbBoolean Then\n        MsgBox (\"Test != False\")\n\n    Else\n        MsgBox (\"Test = False\")\n    End If\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 2923, "user_id": 4497791, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/vCgRs.png?s=128&g=1", "display_name": "eirikdaude", "link": "https://stackoverflow.com/users/4497791/eirikdaude"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 65, "favorite_count": 0, "answer_count": 3, "score": 2, "last_activity_date": 1537951338, "creation_date": 1537948179, "last_edit_date": 1537949563, "question_id": 52512590, "link": "https://stackoverflow.com/questions/52512590/differentiate-between-entering-0-and-pressing-cancel-in-application-inputbox", "title": "Differentiate between entering 0 and pressing cancel in application.inputbox", "body": "<p>I have a macro which takes a value from <code>Application.InputBox</code> and then tries to ensure that a numerical value has been put into it, and that cancel has not been pressed.</p>\n\n<pre><code>Sub test()\n    Dim testvalue As Variant\n\n    testvalue = Application.InputBox(Prompt:=\"Whatever\", Title:=\"Whatever\", Default:=10, Type:=1)\n\n    If testvalue &lt;&gt; False Then\n        MsgBox (\"Test != False\")\n    Else\n        MsgBox (\"Test = False\")\n    End If\n\n    If VarType(testvalue) = vbInteger Or VarType(testvalue) = vbLong Then\n        MsgBox (\"Numerical value\")\n    Else\n        MsgBox (\"Nonnumerical value\")\n    End If\nEnd Sub\n</code></pre>\n\n<p>However, it seems to have trouble differentiating between having 0 put into the InputBox and cancel being pressed. In both cases, the if-statements will return that <code>Test = False</code> and that <code>Test is a nonnumerical value</code>. To be fair, the second if-statements does the same for other integers as well, but I thought there might be some small chance of differentiating between integers stored in the variant and a boolean value stored in it using the <code>VarType</code> method.</p>\n\n<p>Is there any way to differentiate between 0 and cancel being the return-value for the inputbox, or will I have to make my own custom form?</p>\n\n<p>Trying to use VBA's <code>InputBox</code> as suggested in the comments returns \"String\", no matter what value is entered into it, or what button is pressed:</p>\n\n<pre><code>Sub test2()\n    Dim testvalue As Variant\n\n    testvalue = InputBox(\"Test\")\n\n    Select Case VarType(testvalue)\n        Case vbBoolean:\n            Debug.Print \"Boolean\"\n        Case vbInteger:\n            Debug.Print \"Integer\"\n        Case vbLong:\n            Debug.Print \"Long\"\n        Case vbString:\n            Debug.Print \"String\"\n        Case vbVariant:\n            Debug.Print \"Variant\"\n    End Select\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 132, "user_id": 8988624, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c37c08fab3084b272ef09fdfe48d72a3?s=128&d=identicon&r=PG", "display_name": "prextor", "link": "https://stackoverflow.com/users/8988624/prextor"}, "edited": false, "score": 0, "creation_date": 1537943719, "post_id": 52511219, "comment_id": 91962589, "body": "That&#39;s it! Thanks!"}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 2, "last_activity_date": 1537943089, "creation_date": 1537943089, "answer_id": 52511219, "question_id": 52511150, "link": "https://stackoverflow.com/questions/52511150/concatenate-two-ranges-without-looping/52511219#52511219", "title": "Concatenate two ranges without looping", "body": "<p>You can do this:</p>\n\n<pre><code>Dim r As Long    \n\nWith ws_AUoM\n\n    r = .Cells(.Rows.Count, \"B\").End(xlUp).Row\n\n    .Range(\"O2:O\" &amp; r).Value = .Evaluate(\"B2:B\" &amp; r &amp; \" &amp; F2:F\" &amp; r)\n\nEnd With\n</code></pre>\n\n<p><code>Evaluate</code> knows you're giving it an array formula, and will return the resulting array, which you can assign directly to the sheet.</p>\n"}], "owner": {"reputation": 132, "user_id": 8988624, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c37c08fab3084b272ef09fdfe48d72a3?s=128&d=identicon&r=PG", "display_name": "prextor", "link": "https://stackoverflow.com/users/8988624/prextor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 182, "favorite_count": 0, "accepted_answer_id": 52511219, "answer_count": 1, "score": 0, "last_activity_date": 1537943089, "creation_date": 1537942770, "question_id": 52511150, "link": "https://stackoverflow.com/questions/52511150/concatenate-two-ranges-without-looping", "title": "Concatenate two ranges without looping", "body": "<p>I want to concatenate two ranges into one WIHTOUT using a loop.</p>\n\n<p>Below is the code. The lines with comment's is basically the solution I want to avoid.</p>\n\n<pre><code>With ws_AUoM\n\n    lCountEntriesInAUoMFile = .Cells(Rows.Count, \"B\").End(xlUp).Row\n\n    .Range(\"O2:O\" &amp; lCountEntriesInAUoMFile).Value = .Range(\"B2:B\" &amp; lCountEntriesInAUoMFile).Value &amp; .Range(\"F2:F\" &amp; lCountEntriesInAUoMFile).Value\n\n'    For lLoopCounterAUoM = 2 To lCountEntriesInAUoMFile\n'\n'        .Cells(lLoopCounterAUoM, \"O\").Value = .Cells(lLoopCounterAUoM, \"B\").Value &amp; .Cells(lLoopCounterAUoM, \"F\").Value\n'\n'    Next lLoopCounterAUoM\n\n\nEnd With\n</code></pre>\n\n<p>This line:</p>\n\n<pre><code>.Range(\"O2:O\" &amp; lCountEntriesInAUoMFile).Value = .Range(\"B2:B\" &amp; lCountEntriesInAUoMFile).Value &amp; .Range(\"F2:F\" &amp; lCountEntriesInAUoMFile).Value\n</code></pre>\n\n<p>returns the error \"Type Mismatch\". I have double checked the sizes and location of each range. Yet it does not work. What am I missing here?</p>\n"}, {"tags": ["excel", "vba", "userform", "transpose"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1537942294, "post_id": 52510848, "comment_id": 91961942, "body": "Is the user selecting the whole range, or just a single cell?  Can you show how the userform is triggered?"}, {"owner": {"reputation": 29, "user_id": 9427963, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/k7Rv6.png?s=128&g=1", "display_name": "Flohabenicht", "link": "https://stackoverflow.com/users/9427963/flohabenicht"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1537943007, "post_id": 52510848, "comment_id": 91962254, "body": "Hi Tim,  I&#39;ve updated the post with the userform trigger code, thanks for your help."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1537943434, "post_id": 52510848, "comment_id": 91962460, "body": "If you add a public variable to your userform, you can update it with the row number of the triggering cell selection"}, {"owner": {"reputation": 29, "user_id": 9427963, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/k7Rv6.png?s=128&g=1", "display_name": "Flohabenicht", "link": "https://stackoverflow.com/users/9427963/flohabenicht"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1537943673, "post_id": 52510848, "comment_id": 91962565, "body": "Can you please show me how to do that?"}, {"owner": {"reputation": 1444, "user_id": 9122140, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6207fe125b0cbaefce70e98e5ce2c6f?s=128&d=identicon&r=PG&f=1", "display_name": "AcsErno", "link": "https://stackoverflow.com/users/9122140/acserno"}, "edited": false, "score": 0, "creation_date": 1537943724, "post_id": 52510848, "comment_id": 91962596, "body": "Just a quick shot in the dark: what if you replace <code>For Each xcell In xrg</code> with <code>For Each xcell In Selection</code>? Or, as it looks you select only a single for one calculation, replace <code>xcell</code> with <code>Activecell</code>."}, {"owner": {"reputation": 29, "user_id": 9427963, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/k7Rv6.png?s=128&g=1", "display_name": "Flohabenicht", "link": "https://stackoverflow.com/users/9427963/flohabenicht"}, "reply_to_user": {"reputation": 1444, "user_id": 9122140, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6207fe125b0cbaefce70e98e5ce2c6f?s=128&d=identicon&r=PG&f=1", "display_name": "AcsErno", "link": "https://stackoverflow.com/users/9122140/acserno"}, "edited": false, "score": 0, "creation_date": 1537945700, "post_id": 52510848, "comment_id": 91963506, "body": "@AcsErno It worked like a charm, you&#39;re a star. Final question while i&#39;m at it, as soon as I reclick on a one of the triggers, is it possible to have the userform popup with the values I previously entered instead of having it blank?"}, {"owner": {"reputation": 1444, "user_id": 9122140, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6207fe125b0cbaefce70e98e5ce2c6f?s=128&d=identicon&r=PG&f=1", "display_name": "AcsErno", "link": "https://stackoverflow.com/users/9122140/acserno"}, "edited": false, "score": 0, "creation_date": 1537946591, "post_id": 52510848, "comment_id": 91963968, "body": "Every variables are dropped when you <code>.Unload</code> the form. Vars keep their value when you <code>.Hide</code> the form. Please note that <code>.Show</code>-ing a hidden form will trigger <code>Userform_activate</code> instead of <code>Userform_initialize</code>. Alternatively you can <code>.Show</code> and <code>.Unload</code> the form and keep important values in global vars and load them when <code>userform_initialize</code>-ing."}], "answers": [{"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 0, "last_activity_date": 1537944046, "creation_date": 1537944046, "answer_id": 52511447, "question_id": 52510848, "link": "https://stackoverflow.com/questions/52510848/transfer-userform-input-to-range-of-cells/52511447#52511447", "title": "Transfer Userform input to range of cells", "body": "<p>Untested:</p>\n\n<p>Worksheet:</p>\n\n<pre><code>Private Sub Worksheet_SelectionChange(ByVal Target As Range)\n    Dim rng As Range\n    Set rng = Intersect(Target, Me.Range(\"Userformrange\"))\n\n    If Not rng Is Nothing Then\n        If MsgBox(\"Would you like to add or edit a rating?\", vbYesNo) = vbYes Then\n            ' \"TheCell\" is a public global in your userform (or make a property Get/Let)\n            Set UserForm1.TheCell = rng.Cells(1) 'only dealing with one row at a time...\n            UserForm1.Show\n        Else\n            Exit Sub\n        End If\n    End If\nEnd Sub\n</code></pre>\n\n<p>Userform:   </p>\n\n<pre><code>Public TheCell As Range 'public variable in your form\n\nPrivate Sub Calculateseveritybutton_Click()\n    If Textbox1.Value = \"0-25\" Or Textbox2.Value = \"0-25\" Then\n        MsgBox \"Minor and Major finding values are both required!\", vbExclamation\n    Else\n        With TheCell.EntireRow\n            .Cells(1, \"AI\").Value = Textbox1.Value 'Cells is *relative* here...\n            .Cells(1, \"AJ\").Value = Textbox2.Value\n            MsgBox (\"Rating calculated\")\n            Textbox3.Font.Size = 14\n            Textbox3.TextAlign = 2\n        End With\n    End If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 29, "user_id": 9427963, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/k7Rv6.png?s=128&g=1", "display_name": "Flohabenicht", "link": "https://stackoverflow.com/users/9427963/flohabenicht"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 33, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1539121902, "creation_date": 1537941360, "last_edit_date": 1539121902, "question_id": 52510848, "link": "https://stackoverflow.com/questions/52510848/transfer-userform-input-to-range-of-cells", "title": "Transfer Userform input to range of cells", "body": "<p>I felt like I had to ask help from experts as I've been losing quite a lot of time trying to figure this out without much success. </p>\n\n<p>I'm in the midst of building a simple database where users will have to enter values based on drop-down menus. The exception to that is, <strong>column AB</strong> which contains a userform in which the operator will have to enter two numerical values i.e \"Minor findings\" &amp; \"Major findings\", both ranging from 1 to 25.</p>\n\n<p>Currently, the userform is automatically triggered as soon as the user selects a specific range of cells <strong>AB14:AB200</strong></p>\n\n<p>The user then presses a button entitled <strong>caclculate severity</strong> which is supposed to then transpose the two values onto the two columns <strong>AI</strong> &amp; <strong>AJ</strong> </p>\n\n<p>The issue I'm facing is the following: The user can trigger the userform from cell <strong>AB56</strong>, enter the two values, press <strong>calculare severity</strong>, but the output will always be transposed onto the first rows of the range (AI14 &amp; AJ14) instead of (AI56 &amp; AJ56).</p>\n\n<p>I've attached a sample of my code along with a screenshot of the database. </p>\n\n<p><img src=\"https://i.stack.imgur.com/gJpR2.png\" alt=\"DATABASE SCREENSHOT\"></p>\n\n<pre><code>Private Sub Calculateseveritybutton_Click()\n\nWorksheets(\"International CCU Tracker\").Activate\nSet xrg = Worksheets(\"International CCU Tracker\").Range(\"AB14:AB200\")\n\nFor Each xcell In xrg\n\n' replace the sheet name and range A2 or B2 with yours\nIf Textbox1.Value = \"0-25\" And Textbox2.Value = \"0-25\" Then\nMsgBox (\"Please enter a Minor and Major finding value\")\n\nElseIf Textbox1.Value &lt;&gt; \"0-25\" And Textbox2.Value = \"0-25\" Then\nSheets(\"International ccu tracker\").Range(\"AI\" &amp; xcell.Row).Value = Textbox1.Value\nMsgBox (\"Please enter a Major finding value\")\n\nElseIf Textbox1.Value = \"0-25\" And Textbox2.Value &lt;&gt; \"0-25\" Then\nSheets(\"International ccu tracker\").Range(\"AJ\" &amp; xcell.Row).Value = Textbox2.Value\nMsgBox (\"Please enter a Minor finding value\")\n\n\nElseIf Textbox1.Value &lt;&gt; \"0-25\" And Textbox2.Value &lt;&gt; \"0-25\" Then\nWorksheets(\"International ccu tracker\").Range(\"AI\" &amp; xcell.Row).Value = Textbox1.Value\nWorksheets(\"International ccu tracker\").Range(\"AJ\" &amp; xcell.Row).Value = Textbox2.Value\nMsgBox (\"Rating calculated\")\n\nTextbox3.Font.Size = 14\nTextbox3.TextAlign = 2\n\nEnd If\nNext xcell\nExit Sub\nEnd Sub\n</code></pre>\n\n<p>This is the Userform trigger code</p>\n\n<pre><code>Private Sub Worksheet_SelectionChange(ByVal Target As Range)\n    Dim question As Integer\n\n    If Not Intersect(Target, Me.Range(\"Userformrange\")) Is Nothing Then\n\n        question = MsgBox(\"Would you like to add or edit a rating?\", vbYesNo)\n        If question = vbYes Then\n            UserForm1.Show\n        Else \n            Exit Sub\n        End If\n    End If\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 1259, "user_id": 3179957, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/E4LGF.jpg?s=128&g=1", "display_name": "Programnik", "link": "https://stackoverflow.com/users/3179957/programnik"}, "is_accepted": false, "score": 1, "last_activity_date": 1537936825, "last_edit_date": 1537936825, "creation_date": 1537935996, "answer_id": 52509947, "question_id": 52509843, "link": "https://stackoverflow.com/questions/52509843/excel-vba-changing-tab-colour-if-first-3-letter-of-tab-name-xxx/52509947#52509947", "title": "Excel &amp; VBA - Changing tab colour if first 3 letter of tab name = &quot;xxx&quot;", "body": "<p>Try this:</p>\n\n<pre><code>Dim sheet As Worksheet\nFor Each sheet In ActiveWorkbook.Worksheets\nDim name As String\nname = sheet.name\n\nIf Len(name) &gt; 3 Then\n    Dim bit As String\n    bit = Mid(name, 1, 3)\n    Select Case bit\n        Case \"CIS\"\n\n            sheet.Tab.Color = 16776960\n        Case \"NAS\"\n            'etc etc\n\n    End Select\n\nEnd If\nNext\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 3, "user_id": 10416528, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-o5Rh_zYZkjM/AAAAAAAAAAI/AAAAAAAABkk/TJf0AjqmvAM/photo.jpg?sz=128", "display_name": "Aden Wessels", "link": "https://stackoverflow.com/users/10416528/aden-wessels"}, "edited": false, "score": 0, "creation_date": 1537938056, "post_id": 52509964, "comment_id": 91960449, "body": "Cheers for that. Will have a go."}, {"owner": {"reputation": 3, "user_id": 10416528, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-o5Rh_zYZkjM/AAAAAAAAAAI/AAAAAAAABkk/TJf0AjqmvAM/photo.jpg?sz=128", "display_name": "Aden Wessels", "link": "https://stackoverflow.com/users/10416528/aden-wessels"}, "edited": false, "score": 0, "creation_date": 1538001751, "post_id": 52509964, "comment_id": 91993611, "body": "In the end, I went for an approach that copies a sheet, prompts for a sheet name and based on the entered name colours the tab."}], "tags": [], "owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "is_accepted": true, "score": 2, "last_activity_date": 1537936634, "last_edit_date": 1537936634, "creation_date": 1537936088, "answer_id": 52509964, "question_id": 52509843, "link": "https://stackoverflow.com/questions/52509843/excel-vba-changing-tab-colour-if-first-3-letter-of-tab-name-xxx/52509964#52509964", "title": "Excel &amp; VBA - Changing tab colour if first 3 letter of tab name = &quot;xxx&quot;", "body": "<p>This will automatically execute every time you add a new sheet. </p>\n\n<p>There are a good amount of events you can tie this to in order to have the macro fire automatically without user intervention. A few notable ones that may suit your needs better than the <code>NewSheet</code> event that I used below are <code>SheetChange</code>, <code>SheetBeforeDelete</code>, <code>SheetActivate</code>, etc.  </p>\n\n<hr>\n\n<p>This code will need to be placed in the coding space under <code>ThisWorkbook</code> rather a sheet or module in VBE. </p>\n\n<pre><code>Option Explicit\n\nPrivate Sub Workbook_NewSheet(ByVal Sh As Object)\n\nDim ws As Worksheet\n\nFor Each ws In Worksheets\n    Select Case Left(ws.Name, 3)\n        Case \"CIS\"\n            ws.Tab.Color = RGB(0, 255, 255)\n        Case \"NAS\"\n            ws.Tab.Color = RGB(66, 134, 244)\n        'Case \"ABC\"\n            'Add as many of these as you need inbetween _\n             Select Case and End Select\n    End Select\nNext ws\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2944, "user_id": 10095272, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0Shi9.jpg?s=128&g=1", "display_name": "Strawberryshrub", "link": "https://stackoverflow.com/users/10095272/strawberryshrub"}, "is_accepted": false, "score": 0, "last_activity_date": 1537936646, "creation_date": 1537936646, "answer_id": 52510025, "question_id": 52509843, "link": "https://stackoverflow.com/questions/52509843/excel-vba-changing-tab-colour-if-first-3-letter-of-tab-name-xxx/52510025#52510025", "title": "Excel &amp; VBA - Changing tab colour if first 3 letter of tab name = &quot;xxx&quot;", "body": "<p>This should do the trick. First you need to count all the sheets and then run through each of them and check for the first 3 letters. If this is true you can color it:</p>\n\n<pre><code>For i = 1 To Sheets.Count\n\n   If Left(Sheets(i).Name, 3) = \"CIS\" Then\n      Sheets(i).Tab.Color = RGB(0, 255, 255)\n   End If\n\n   If Left(Sheets(i).Name, 3) = \"NAS\" Then\n      Sheets(i).Tab.Color = RGB(66, 134, 244)\n   End If  \n\nNext i\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 10416528, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-o5Rh_zYZkjM/AAAAAAAAAAI/AAAAAAAABkk/TJf0AjqmvAM/photo.jpg?sz=128", "display_name": "Aden Wessels", "link": "https://stackoverflow.com/users/10416528/aden-wessels"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 415, "favorite_count": 0, "accepted_answer_id": 52509964, "answer_count": 3, "score": -1, "last_activity_date": 1537936825, "creation_date": 1537935267, "question_id": 52509843, "link": "https://stackoverflow.com/questions/52509843/excel-vba-changing-tab-colour-if-first-3-letter-of-tab-name-xxx", "title": "Excel &amp; VBA - Changing tab colour if first 3 letter of tab name = &quot;xxx&quot;", "body": "<p>New to VBA in excel, but hoping to get some help with a macro while I find my feet. Any help would be greatly appreciated.</p>\n\n<p>I have a workbook where I would like to automatically colour tabs based on the tab names. My tab/sheet names are often codes. Some of my existing sheet names (for example) are:</p>\n\n<ul>\n<li>CIS22ABC</li>\n<li>CIS22CBA</li>\n<li>NAS22XYZ</li>\n<li>NAS22ZXY</li>\n<li>MY DATA</li>\n<li>ADMIN, etc.</li>\n</ul>\n\n<p>I am trying to implement a script that runs across entire Workbook (i.e. under \"ThisWorkbook\") that searches first 3 letters of every tab name and makes tab colours based on these letters. There are lots of sheets being added and removed all the time - so an array of names won't work.</p>\n\n<p>In short, I am hoping to do the following:</p>\n\n<ul>\n<li>If first 3 letter of sheet name = \"CIS\" then Tab.Color = RGB(0, 255, 255)</li>\n<li>If first 3 letter of sheet name = \"NAS\" then Tab.Color = RGB(66, 134, 244)</li>\n<li>Otherwise do nothing!</li>\n</ul>\n\n<p>Again, any help would be great. Thank you.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1403, "user_id": 124828, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/88e1c43c5ffccb482d907db8704d6e05?s=128&d=identicon&r=PG", "display_name": "Jules", "link": "https://stackoverflow.com/users/124828/jules"}, "edited": false, "score": 0, "creation_date": 1537925647, "post_id": 52508704, "comment_id": 91957681, "body": "I would guess Rows is not an object."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 1, "creation_date": 1537925649, "post_id": 52508704, "comment_id": 91957682, "body": "Works fine for me. Do you have a sheet with a codename of <code>Sheet1</code>?"}, {"owner": {"reputation": 29, "user_id": 10416127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6678c37c1f93709de4ded8aa3312ee6?s=128&d=identicon&r=PG&f=1", "display_name": "VJ4407", "link": "https://stackoverflow.com/users/10416127/vj4407"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1537925796, "post_id": 52508704, "comment_id": 91957699, "body": "@Comintern  Yes, I have. And it does not work for me."}, {"owner": {"reputation": 29, "user_id": 10416127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6678c37c1f93709de4ded8aa3312ee6?s=128&d=identicon&r=PG&f=1", "display_name": "VJ4407", "link": "https://stackoverflow.com/users/10416127/vj4407"}, "edited": false, "score": 0, "creation_date": 1537926135, "post_id": 52508704, "comment_id": 91957768, "body": "I am trying to Copy particular rows from Sheet1 to Sheet2. Sheet1 is were the data lies and Sheet2 is were I want the data to be copied."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 1, "creation_date": 1537926271, "post_id": 52508704, "comment_id": 91957782, "body": "The sheet name is not the same as the code name. Does it show up as <code>Sheet1 (Sheet1)</code> in the project explorer?"}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1537926528, "post_id": 52508704, "comment_id": 91957827, "body": "Works fine for me too. If you paste it into a new workbook with 2 sheets, I bet it will also work fine.  You could try referring to the worksheets by name instead of by codename.  (Use <code>Range(&quot;Sheet1&quot;).</code> instead of <code>Sheet1.</code>, assuming that is the name showing on the tab at the bottom of the worksheet.  It&#39;s odd that you&#39;re back and forth between both methods."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 3, "creation_date": 1537926570, "post_id": 52508704, "comment_id": 91957831, "body": "@KenWhite assuming <code>ThisWorkbook.Worksheets(&quot;Sheet1&quot;).CodeName</code> is <code>&quot;Sheet1&quot;</code>, then <code>Sheet1</code> is a global/project-scope identifier automagically declared by VBA, yes. And using code-name identifiers like this is absolutely the single most robust way of accessing a worksheet that exists at compile-time in <code>ThisWorkbook</code>."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 2, "creation_date": 1537926753, "post_id": 52508704, "comment_id": 91957861, "body": "Except, given the error number, I very much suspect that OP doesn&#39;t know that, and <code>Option Explicit</code> isn&#39;t specified, and <code>Sheet1</code> was deleted and another sheet was added and its <code>Name</code> was set to <code>&quot;Sheet1&quot;</code>, yet the worksheet object probably has a code-name like <code>Sheet4</code> or something."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1537926891, "post_id": 52508704, "comment_id": 91957890, "body": "The only other scenario I can think of is that there is an actual global variable declared somewhere else named <code>Sheet1</code>, but I&#39;m going with @MathieuGuindon&#39;s suspicion on this one."}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 1, "creation_date": 1537926934, "post_id": 52508704, "comment_id": 91957899, "body": "@Vijay - Let&#39;s determine for sure what your worksheets are called.  Run this sub:  <code>Sub listShts(): Dim s: For Each s In Sheets: Debug.Print &quot;Name=&quot; &amp; s.Name, &quot;CodeName=&quot; &amp; s.CodeName: Next s: End Sub</code> (all on one line like that is fine) and check the results in the immediate pane (Ctrl+G)"}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1537926998, "post_id": 52508704, "comment_id": 91957907, "body": "...Or, there are multiple workbooks open and the intended one is not the active one.  . . . no point in speculating though."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "reply_to_user": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 1, "creation_date": 1537927134, "post_id": 52508704, "comment_id": 91957934, "body": "@ashleedawg The active workbook should be irrelevant - using the code name of the sheet is scoped to the project and doesn&#39;t refer implicitly to the active workbook."}], "answers": [{"comments": [{"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1537932491, "post_id": 52508885, "comment_id": 91959074, "body": "++ nicely explained :)"}], "tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": true, "score": 4, "last_activity_date": 1537927087, "creation_date": 1537927087, "answer_id": 52508885, "question_id": 52508704, "link": "https://stackoverflow.com/questions/52508704/run-time-error-424-object-required-excel-vba/52508885#52508885", "title": "Run-time error &#39;424&#39; Object Required : Excel VBA", "body": "<p>Error 424 \"object required\" has only one reason to pop up on that line of code.</p>\n\n<p><code>Option Explicit</code> isn't specified, and <code>Sheet1</code> isn't declared anywhere.</p>\n\n<p>Look at the properties of your \"Sheet1\" module (F4), then note the value of the <code>(Name)</code> property:</p>\n\n<p><img src=\"https://i.stack.imgur.com/PBxJm.png\" alt=\"Properties of module &#39;Sheet1&#39;\"></p>\n\n<p>The <code>Name</code> property is what you're seeing in Excel. The <code>(Name)</code> property isn't visible anywhere in Excel, and that value determines the name of a global-scope identifier that VBA declares automagically for you.</p>\n\n<p>You can't do <code>Sheet1.Cells(...)</code> if no worksheet has a <code>(Name)</code> property value of <code>Sheet1</code>.</p>\n\n<p>But specify <code>Option Explicit</code> anyway. The reason for error 424 is that <code>Sheet1</code> being undeclared, at run-time it's an implicit <code>Variant</code> with the default value of <code>Empty</code>, which isn't an object, thus against which a member call is illegal - only an object could ever possibly have a <code>Cells</code> member.</p>\n\n<p>Protip: give the <code>(Name)</code> property a meaningful name, e.g. <code>SummarySheet</code>. Then you can do <code>SummarySheet.Cells(...)</code>.</p>\n"}], "owner": {"reputation": 29, "user_id": 10416127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6678c37c1f93709de4ded8aa3312ee6?s=128&d=identicon&r=PG&f=1", "display_name": "VJ4407", "link": "https://stackoverflow.com/users/10416127/vj4407"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 744, "favorite_count": 0, "accepted_answer_id": 52508885, "answer_count": 1, "score": -1, "last_activity_date": 1616626806, "creation_date": 1537925361, "last_edit_date": 1537926409, "question_id": 52508704, "link": "https://stackoverflow.com/questions/52508704/run-time-error-424-object-required-excel-vba", "title": "Run-time error &#39;424&#39; Object Required : Excel VBA", "body": "<p>I am very new to coding and I am trying to copy data's from one worksheet to another worksheet on a particular rows. </p>\n\n<pre><code>Sub copycolumns()\n    Dim lastrow As Long, erow As Long\n    lastrow = Sheet1.Cells(Rows.Count, 1).End(xlUp).Row '*/error shows here/*\n    For i = 2 To lastrow\n        Sheet1.Cells(i, 1).Copy\n        erow = Sheet2.Cells(Rows.Count, 1).End(xlUp).Offset(1, 0).Row\n        Sheet1.Paste Destination:=Worksheets(\"Sheet2\").Cells(erow, 1)\n        Sheet1.Cells(i, 3).Copy\n        Sheet1.Paste Destination:=Worksheets(\"Sheet2\").Cells(erow, 2)\n        Sheet1.Cells(i, 6).Copy\n        Sheet1.Paste Destination:=Worksheets(\"Sheet2\").Cells(erow, 3)\n    Next i\n    Application.CutCopyMode = False\n    Sheet2.Columns().AutoFit\n    Range(\"A1\").Select\nEnd Sub\n</code></pre>\n\n<p>What I am missing in here?</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 10415989, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-49jdlpxMclc/AAAAAAAAAAI/AAAAAAAABiw/orddJPu27mM/photo.jpg?sz=128", "display_name": "Pancho Friessen", "link": "https://stackoverflow.com/users/10415989/pancho-friessen"}, "edited": false, "score": 0, "creation_date": 1537973003, "post_id": 52508658, "comment_id": 91980403, "body": "updated code as follows, still get Run-time error &#39;91&#39;:Sub RETRIEVE_QUOTE()       &#39;Opens Ref. Quote     Dim H As Range     Set H = Range(&quot;H4&quot;)      If H.Value &lt;&gt; &quot;&quot; Then     Dim Path As String     Path = &quot;U:\\V3.5.0\\QUOTES\\&quot;      Dim file_name As Range     file_name = &quot;QUOTE#&quot; &amp; H.Value &amp; &quot;.xlsx&quot;      Dim wb As Workbook     Set wb = wb.Open(Path &amp; file_name)     End If"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "reply_to_user": {"reputation": 1, "user_id": 10415989, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-49jdlpxMclc/AAAAAAAAAAI/AAAAAAAABiw/orddJPu27mM/photo.jpg?sz=128", "display_name": "Pancho Friessen", "link": "https://stackoverflow.com/users/10415989/pancho-friessen"}, "edited": false, "score": 0, "creation_date": 1537977390, "post_id": 52508658, "comment_id": 91983193, "body": "make sure <code>Path &amp; file_name</code> variable concatenation is a valid and legal file name that exists on your machine."}], "tags": [], "owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "is_accepted": true, "score": 0, "last_activity_date": 1537924856, "creation_date": 1537924856, "answer_id": 52508658, "question_id": 52508443, "link": "https://stackoverflow.com/questions/52508443/open-closed-wb-in-path-file-name-quote-active-sheet-cell-range-h5-value/52508658#52508658", "title": "open closed wb in path, file name &quot;Quote#&quot; &amp; active sheet cell range &quot;h5&quot;.value.xlsx", "body": "<p>The code above is riddled with syntax issues. I will not explain everything, but please compare my code to yours so you can learn.</p>\n\n<p>I made assumptions that you wanted to check the H4 actually has a value and that it will feed into the workbook name. </p>\n\n<pre><code>Dim H As Range\nSet H = Range(\"H4\")\n\nIf H.Value &lt;&gt; \"\" Then\n\n    Dim Path As String\n    Path = \"U:\\V3.5.0\\QUOTES\\\"\n\n    Dim file_name As Range\n    file_name = \"QUOTE#\" &amp; H.Value &amp; \".xlsx\"\n\n    Dim wb As Workbook\n    Set wb = wb.Open(path &amp; file_name)\n\nEnd If\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 10415989, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-49jdlpxMclc/AAAAAAAAAAI/AAAAAAAABiw/orddJPu27mM/photo.jpg?sz=128", "display_name": "Pancho Friessen", "link": "https://stackoverflow.com/users/10415989/pancho-friessen"}, "edited": false, "score": 0, "creation_date": 1537985713, "post_id": 52523879, "comment_id": 91987201, "body": "thank you for your help.After a few chnages, it works great"}], "tags": [], "owner": {"reputation": 1, "user_id": 10415989, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-49jdlpxMclc/AAAAAAAAAAI/AAAAAAAABiw/orddJPu27mM/photo.jpg?sz=128", "display_name": "Pancho Friessen", "link": "https://stackoverflow.com/users/10415989/pancho-friessen"}, "is_accepted": false, "score": 0, "last_activity_date": 1537985690, "creation_date": 1537985690, "answer_id": 52523879, "question_id": 52508443, "link": "https://stackoverflow.com/questions/52508443/open-closed-wb-in-path-file-name-quote-active-sheet-cell-range-h5-value/52523879#52523879", "title": "open closed wb in path, file name &quot;Quote#&quot; &amp; active sheet cell range &quot;h5&quot;.value.xlsx", "body": "<p>Sub RETRIEVE_QUOTE()\n    'Checks if Quote# is entered\n    Application.ScreenUpdating = False\n    Dim H As Range\n    Set H = Range(\"H4\")\n    If H.Value = \"\" Then\n        MsgBox \"Please Enter Quote#!\"\n        Exit Sub\n    End If\n   'Checks if PO# is entered\n    Dim R As Range\n    Set R = Range(\"H5\")\n    If R.Value = \"\" Then\n        MsgBox \"Please Enter PO#!\"\n        Exit Sub\n    End If\n    'Checks if DUE DATE is entered\n    Dim D As Range\n    Set D = Range(\"H6\")\n    If D.Value = \"\" Then\n        MsgBox \"Please Enter DUE DATE!\"\n        Exit Sub\n    End If\n    'Opens Ref. Quote\n    If H.Value &lt;> \"\" Then\n    Dim Path As String\n    Path = \"U:\\V3.5.0\\QUOTES\\\"\n    Dim file_name As String\n    file_name = \"QUOTE#\" &amp; H.Value &amp; \".xlsx\"\n    Workbooks.Open filename:=(Path &amp; file_name)\n    End If</p>\n"}], "owner": {"reputation": 1, "user_id": 10415989, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-49jdlpxMclc/AAAAAAAAAAI/AAAAAAAABiw/orddJPu27mM/photo.jpg?sz=128", "display_name": "Pancho Friessen", "link": "https://stackoverflow.com/users/10415989/pancho-friessen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 26, "favorite_count": 0, "accepted_answer_id": 52508658, "answer_count": 2, "score": 0, "last_activity_date": 1593644843, "creation_date": 1537923113, "last_edit_date": 1593644843, "question_id": 52508443, "link": "https://stackoverflow.com/questions/52508443/open-closed-wb-in-path-file-name-quote-active-sheet-cell-range-h5-value", "title": "open closed wb in path, file name &quot;Quote#&quot; &amp; active sheet cell range &quot;h5&quot;.value.xlsx", "body": "<p>I've been looking for a while now with no success to run a macro to open a specific wb.\nAny help would be greatly appreciated.</p>\n\n<pre><code>'Opens Ref. Quote\nDim H As Range\nSet H = Range(\"H4\")\nIf H = \"\" Then\nDim wb As Workbook\nDim ps As Workbook\nDim Path As String\nDim file_name As Range\nPath = \"U:\\V3.5.0\\QUOTES\\\"\nfile_name = \"QUOTE#\" &amp; \"H\" &amp; (\".xlsx\")\nwb.Open\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 296, "user_id": 10297628, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/451ff84ef23bae11a9746ec65cf1c284?s=128&d=identicon&r=PG&f=1", "display_name": "Shelty", "link": "https://stackoverflow.com/users/10297628/shelty"}, "is_accepted": true, "score": 0, "last_activity_date": 1537924095, "creation_date": 1537924095, "answer_id": 52508569, "question_id": 52508429, "link": "https://stackoverflow.com/questions/52508429/excel-vba-create-hyperlink-of-existing-cell-based-on-value-above-cell/52508569#52508569", "title": "Excel VBA create hyperlink of existing cell based on value above cell", "body": "<p>I can give you a few tips. You have to know how to declare a range that includes all the cells you want to look for \"Title\" in. Then you can for example use 'For Each' loop to go through all these cells (in that defined range) and check if their value is \"Title\". If it is, then you can use Offset Property to go one cell down and put that hyperlink in it. </p>\n\n<p>You can start with this:</p>\n\n<p><a href=\"https://www.excel-easy.com/vba/loop.html\" rel=\"nofollow noreferrer\">https://www.excel-easy.com/vba/loop.html</a></p>\n\n<p><a href=\"https://www.excel-easy.com/vba/if-then-statement.html\" rel=\"nofollow noreferrer\">https://www.excel-easy.com/vba/if-then-statement.html</a></p>\n\n<p><a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.range(object)\" rel=\"nofollow noreferrer\">https://docs.microsoft.com/en-us/office/vba/api/excel.range(object)</a></p>\n\n<p><a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.range.value\" rel=\"nofollow noreferrer\">https://docs.microsoft.com/en-us/office/vba/api/excel.range.value</a></p>\n\n<p><a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.range.formula\" rel=\"nofollow noreferrer\">https://docs.microsoft.com/en-us/office/vba/api/excel.range.formula</a></p>\n\n<p><a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.range.offset\" rel=\"nofollow noreferrer\">https://docs.microsoft.com/en-us/office/vba/api/excel.range.offset</a></p>\n"}], "owner": {"reputation": 25, "user_id": 10416060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67e0d06787f8d0a6046876165c089f21?s=128&d=identicon&r=PG&f=1", "display_name": "Ranger9", "link": "https://stackoverflow.com/users/10416060/ranger9"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 38, "favorite_count": 0, "closed_date": 1537961023, "accepted_answer_id": 52508569, "answer_count": 1, "score": -1, "last_activity_date": 1537985336, "creation_date": 1537922983, "last_edit_date": 1537985336, "question_id": 52508429, "link": "https://stackoverflow.com/questions/52508429/excel-vba-create-hyperlink-of-existing-cell-based-on-value-above-cell", "closed_reason": "Needs more focus", "title": "Excel VBA create hyperlink of existing cell based on value above cell", "body": "<p>I currently have a sheet called Title Detail. On the sheet there are several values named Title. Under each cell with the string \"Title\" I would like to create a hyperlink to that same cell.</p>\n\n<p>I'm extremely new to VBA, and attempting to teach myself so any help would be greatly appreciated. </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1537928401, "post_id": 52508355, "comment_id": 91958202, "body": "When looking at highlighted cells only in your sample data, why is the 2nd <code>VAN HOOK 2</code> yellow and not green? It is part of a consecutive run of dates (6/1 &amp; 6/2). This seems inconsistent since the next green portion has the first date of the run green. Or am I missing something"}, {"owner": {"reputation": 72, "user_id": 10409433, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-zoUtm0MExDc/AAAAAAAAAAI/AAAAAAAABUw/1SkMx895o-8/photo.jpg?sz=128", "display_name": "Jesse_V", "link": "https://stackoverflow.com/users/10409433/jesse-v"}, "reply_to_user": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1537931616, "post_id": 52508355, "comment_id": 91958904, "body": "@urdearboy I\u2019m sorry, that is a mistake on my part. They are part of the same run."}, {"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 1, "creation_date": 1537931700, "post_id": 52508355, "comment_id": 91958916, "body": "You should fix that in your problem"}], "answers": [{"tags": [], "owner": {"reputation": 1444, "user_id": 9122140, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6207fe125b0cbaefce70e98e5ce2c6f?s=128&d=identicon&r=PG&f=1", "display_name": "AcsErno", "link": "https://stackoverflow.com/users/9122140/acserno"}, "is_accepted": false, "score": 0, "last_activity_date": 1537945984, "creation_date": 1537945984, "answer_id": 52511985, "question_id": 52508355, "link": "https://stackoverflow.com/questions/52508355/vba-find-changing-conditional-values-in-one-column-based-on-consecutive-dates/52511985#52511985", "title": "VBA - Find Changing Conditional Values in one Column based on Consecutive Dates in another Column", "body": "<p>Try this snippet: </p>\n\n<pre><code>Dim bOn As Boolean  ' block is on or off\nDim r As Range\nDim rDC As Range    ' range where to look for 60\nDim lBegin As Long, lEnd As Long  ' 1st and last row of the current block\nDim d As Date\n\nSet rDC = Range(\"j1:j\" &amp; ActiveSheet.UsedRange.Rows)\n\nbOn = False         ' no block has begun\nFor Each r In rDC\n    If r.Value = 60 Then\n        If Not bOn Then\n            lBegin = r.Row      ' remember row where the block begins\n            lEnd = 0\n            d = r.Offset(0, -2).Value ' save 1st date in block\n            bOn = True\n        End If\n    End If\n    If bOn Then\n        If r.Offset(1, -2) = d + 1 Then  ' check date in next row\n            d = d + 1\n        Else        ' end of consecutive dates\n            lEnd = r.Row\n\n ' At this point lBegin and lEnd contains the 1st and last row of a block of consecutive dates\n\n            If lBegin &gt; 0 And lEnd &gt; 0 Then\n                Range(Cells(lBegin, \"A\"), Cells(lEnd, \"J\")).Copy\n            End If\n            lBegin = 0\n            bOn = False\n        End If\n    End If\nNext r\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 72, "user_id": 10409433, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-zoUtm0MExDc/AAAAAAAAAAI/AAAAAAAABUw/1SkMx895o-8/photo.jpg?sz=128", "display_name": "Jesse_V", "link": "https://stackoverflow.com/users/10409433/jesse-v"}, "edited": false, "score": 0, "creation_date": 1537973873, "post_id": 52512189, "comment_id": 91981031, "body": "This works great! Thank you so much for taking the time to put this together. Very helpful from a learning perspective too."}], "tags": [], "owner": {"reputation": 1385, "user_id": 8555648, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-CK4leGQFE84/AAAAAAAAAAI/AAAAAAAAAgY/HrlhEh-LPIQ/photo.jpg?sz=128", "display_name": "newacc2240", "link": "https://stackoverflow.com/users/8555648/newacc2240"}, "is_accepted": true, "score": 0, "last_activity_date": 1537946733, "creation_date": 1537946733, "answer_id": 52512189, "question_id": 52508355, "link": "https://stackoverflow.com/questions/52508355/vba-find-changing-conditional-values-in-one-column-based-on-consecutive-dates/52512189#52512189", "title": "VBA - Find Changing Conditional Values in one Column based on Consecutive Dates in another Column", "body": "<pre><code>Private Sub coloring()\n    Dim color1 As Variant, color2 As Variant, usingColor As Variant\n    color1 = RGB(180, 255, 180) 'Green\n    color2 = RGB(255, 255, 150) 'Yellow\n    usingColor = color1\n\n    Dim found60 As Boolean: found60 = False\n    Dim rng As Range\n\n    For Each rng In Range(Range(\"J2\"), Cells(ActiveSheet.UsedRange.Rows.Count, \"J\"))\n        If found60 Then\n            'Checking date is consecutive or not\n            If rng.Offset(0, -2).Value - 1 = rng.Offset(-1, -2).Value Then \n                rng.EntireRow.Interior.Color = usingColor\n            Else\n                found60 = False\n                usingColor = IIf(usingColor = color1, color2, color1)\n            End If\n        End If\n\n        'We haven't found a 60 or the last series is over\n        If Not found60 Then\n            If rng.Value = 60 Then\n                found60 = True\n                rng.EntireRow.Interior.Color = usingColor\n            End If\n        End If\n    Next rng\nEnd Sub\n</code></pre>\n\n<p>Logic: Every time we entry a row, we check first if we had found a 60 on the last row. If we did, check the date. If the date is consecutive, we color it; if not, then we found the last date of the series. And we go back to find 60.</p>\n\n<p>result: <a href=\"https://i.stack.imgur.com/ipL8L.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ipL8L.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 72, "user_id": 10409433, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-zoUtm0MExDc/AAAAAAAAAAI/AAAAAAAABUw/1SkMx895o-8/photo.jpg?sz=128", "display_name": "Jesse_V", "link": "https://stackoverflow.com/users/10409433/jesse-v"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 80, "favorite_count": 0, "accepted_answer_id": 52512189, "answer_count": 2, "score": 2, "last_activity_date": 1537946733, "creation_date": 1537922389, "last_edit_date": 1537942852, "question_id": 52508355, "link": "https://stackoverflow.com/questions/52508355/vba-find-changing-conditional-values-in-one-column-based-on-consecutive-dates", "title": "VBA - Find Changing Conditional Values in one Column based on Consecutive Dates in another Column", "body": "<p>I am new to VBA and having trouble figuring out how to make this work. I am trying to:</p>\n\n<ol>\n<li>Select all <code>DOWNTIME_CODES</code> that equal 60</li>\n<li>Select any <code>DOWNTIME_CODES</code> that follow a code 60 and where DATE_VALUE is consecutive after a 60. (EX. VAN HOOK 2 between the dates 9/3 and 9/12).</li>\n</ol>\n\n<p>I have been trying to create a macro that treats <code>DOWNTIME_CODE</code> = 60 as a starting point and then looks at date to see if it is consecutive, even if the <code>DOWNTIME_CODE</code> changes to a 70, 21 or whatever. There are a few hundred <code>COMPLETION_NAMES</code> so I cannot do this manually, and need to be able to loop through all the completions. I have tried to use an <code>IF THEN</code> statement to identify a code 60 and then another <code>IF THEN</code> inside that to check if <code>DATE_VALUE</code> is consecutive, and then copy those results out of the main table, and then start searching for the next  code 60. There can be separate code 60's for one completion and it is possible to have only one </p>\n\n<p>This is one of the version of the code I have worked on, it is a simplified conceptualization. I have not been able to make it very far and cannot find anything similar. This is the closest example I have found: </p>\n\n<ul>\n<li><a href=\"https://stackoverflow.com/questions/47238058/vba-conditional-sum-column-b-until-change-of-value-in-column-a\">VBA - conditional Sum column B until change of value in column A</a> and </li>\n<li><a href=\"https://stackoverflow.com/questions/24411046/vba-need-a-conditional-sum-based-on-a-change-in-another-column?noredirect=1&amp;lq=1\">VBA, Need a conditional Sum based on a change in another column</a></li>\n</ul>\n\n<p>and here is a general idea of how I have been approaching the problem.  </p>\n\n<pre><code>If DOWNTIME_CODE = 60 Then\n    If DATE_VALUE = DATE_VALUE.Offset(-1) Then\n        cell.Offset(0, 2) = CHECK\n    End If\nElse\n    DOWNTIME_CODE = DOWNTIME_CODE + DOWNTIME_CODE.Offset(0, 1)\nEnd If\n</code></pre>\n\n<p>Example Data:<br>\n<a href=\"https://i.stack.imgur.com/tq0s3.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/tq0s3.png\" alt=\"Example Data\"></a></p>\n\n<p>Any help on an approach or guidance on how to do this would be greatly appreciated! Thank you for taking the time to read my post!</p>\n"}, {"tags": ["vba", "excel", "oledb"], "answers": [{"comments": [{"owner": {"reputation": 27, "user_id": 6686711, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56205ef5d6f3fa97fd3720edcab0e00f?s=128&d=identicon&r=PG&f=1", "display_name": "Costas", "link": "https://stackoverflow.com/users/6686711/costas"}, "edited": false, "score": 0, "creation_date": 1537975697, "post_id": 52511676, "comment_id": 91982184, "body": "I had tried setting the connection itself to turn off background refresh. Tried BackgroundQuery=False before the .Refresh in the VBA. Both failed. Placing it above the .CommandText however seems to work. The problem now is when I select a new item it throws a debug at the End With for some reason and sometimes on one or more of the last three copy\\value lines and even the End Sub. Not every time but it&#39;s the exception when it doesn&#39;t."}, {"owner": {"reputation": 27, "user_id": 6686711, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56205ef5d6f3fa97fd3720edcab0e00f?s=128&d=identicon&r=PG&f=1", "display_name": "Costas", "link": "https://stackoverflow.com/users/6686711/costas"}, "edited": false, "score": 0, "creation_date": 1537983586, "post_id": 52511676, "comment_id": 91986258, "body": "Sphinx, I have created a new spreadsheet. Created new buttons, data sources, copied and pasted the VBA code. The only thing that I changed is switching from OLEDBConnection to an ODBCConnection (Excel calls it out as &quot;Database Query&quot;). Interestingly the OLEDB connection seems faster but even if I enable the BackgroundQuery it now works correctly although I will disable it as the screen refreshes are annoying. I don&#39;t need it in code, just disable in the connection properties. Something must have gotten corrupt in the original book. I might try OLE DB again but... Thanks, will mark"}], "tags": [], "owner": {"reputation": 588, "user_id": 7049751, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a6b0e27ce4e8c20a20d34e793f4e4636?s=128&d=identicon&r=PG&f=1", "display_name": "Sphinx", "link": "https://stackoverflow.com/users/7049751/sphinx"}, "is_accepted": true, "score": 0, "last_activity_date": 1537944921, "creation_date": 1537944921, "answer_id": 52511676, "question_id": 52508344, "link": "https://stackoverflow.com/questions/52508344/excel-ole-db-connection-refresh-issues/52511676#52511676", "title": "Excel OLE DB connection refresh issues", "body": "<p>You need to wait till query is complete before proceeding with calculations. <BR> \nWhat you need is to add <code>.BackgroundQuery = False</code> to your connection before <code>.refresh</code> <BR> </p>\n\n<pre><code>With ActiveWorkbook.Connections(\"CJP_DeliveryRecap_Detail\").OLEDBConnection\n    .BackgroundQuery = False\n    .CommandText = \"SELECT SKU, SKU_Desc, Served, Billed FROM mySQLdb ......\"\n    .Refresh\nEnd With\n</code></pre>\n\n<p>This should help</p>\n"}, {"tags": [], "owner": {"reputation": 41, "user_id": 7371818, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-uXKsru5FxWs/AAAAAAAAAAI/AAAAAAAAFNk/05_iRdx0EXc/photo.jpg?sz=128", "display_name": "CrawlingKingSnake", "link": "https://stackoverflow.com/users/7371818/crawlingkingsnake"}, "is_accepted": false, "score": -1, "last_activity_date": 1560965354, "creation_date": 1560965354, "answer_id": 56673060, "question_id": 52508344, "link": "https://stackoverflow.com/questions/52508344/excel-ole-db-connection-refresh-issues/56673060#56673060", "title": "Excel OLE DB connection refresh issues", "body": "<p>If the stored procedure being called from Excel does not contain \"SET NOCOUNT ON\" it will not run properly from Excel. I had the same issue and SET NOCOUNT ON was not included in my stored proc; the second i added it, it worked!</p>\n"}], "owner": {"reputation": 27, "user_id": 6686711, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56205ef5d6f3fa97fd3720edcab0e00f?s=128&d=identicon&r=PG&f=1", "display_name": "Costas", "link": "https://stackoverflow.com/users/6686711/costas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1590, "favorite_count": 0, "accepted_answer_id": 52511676, "answer_count": 2, "score": 0, "last_activity_date": 1560965354, "creation_date": 1537922250, "question_id": 52508344, "link": "https://stackoverflow.com/questions/52508344/excel-ole-db-connection-refresh-issues", "title": "Excel OLE DB connection refresh issues", "body": "<p>I have an Excel workbook with two dynamic OLE DB queries. I'm having issues with refreshes.</p>\n\n<p>To set things up I have a SQL table-valued function as the source. The data is of the nature of...</p>\n\n<pre><code>SGrp   SG_Desc   SKU   SKU_Desc   Server   Billed\n1      Item 1    111   whatever    15        12\n1      Item 2    222   some more   10         9\n2      Item 3    333   zzz         10         8\n3      Item 4    555   abc         20        18\n</code></pre>\n\n<p>On the first sheet (\"Overall\") I have a data connection that summarizes the groups with the command text of dynamically modified with one button.</p>\n\n<pre><code>SELECT SGrp, SG_Desc, SUM(Served) AS Served, SUM(Billed) AS Billed FROM mySQLdb ('8/19/2018','8/25/2018') WHERE SGrp &lt;&gt; '' GROUP BY SGrp, SG_Desc ORDER BY SG_Desc\n</code></pre>\n\n<p>I then have a cell with a data validation list that selects the group and a button to execute the VBA to dynamically modify the other connection. There's also two cells with the report start &amp; end date for filtering. When I push the \"Detail\" button it runs the code below.</p>\n\n<pre><code>Private Sub RunDetail_Click()\n\nDim StartDate As Date\nDim EndDate As Date\nDim SGrp As String\n\nRange(\"A1\").Value = Range(\"G8\").Value2\n\nStartDate = Sheets(\"Overall\").Range(\"H1\").Value\nEndDate = Sheets(\"Overall\").Range(\"H2\").Value\nSGrp = Sheets(\"Overall\").Range(\"A1\").Value\n\nSGrp = LTrim(RTrim(SGrp))\n\nWith ActiveWorkbook.Connections(\"CJP_DeliveryRecap_Detail\").OLEDBConnection\n    .CommandText = \"SELECT SKU, SKU_Desc, Served, Billed FROM mySQLdb ('\" &amp; StartDate &amp; \"','\" &amp; EndDate &amp; \"') WHERE SG_Desc='\" &amp; SGrp &amp; \"'\"\n'    .Refresh\n'    ActiveWorkbook.Connections(\"CJP_DeliveryRecap_Detail\").Refresh\nEnd With\n\n'RefreshOLEDB\n'ThisWorkbook.RefreshAll\nActiveWorkbook.Connections(\"CJP_DeliveryRecap_Detail\").Refresh\n'Application.CalculateUntilAsyncQueriesDone\n\nApplication.Wait (Now + TimeValue(\"0:00:03\"))\n\nDim rc As Integer\nDim i As Integer\n\nWorksheets(\"Detail\").Activate\n\nWith Worksheets(\"Detail\").Range(\"CJP_DeliveryRecap_Detail\")\n    rc = .Rows.Count\nEnd With\n\nWith Worksheets(\"Detail\").Range(\"E1048576\")\n    .Select\n    .End(xlUp).Select\nEnd With\ni = Selection.Row\n\nWorksheets(\"Detail\").Range(\"E5\").Select\n\nWorksheets(\"Detail\").Range(\"E5:G\" &amp; i).ClearContents\n\nWorksheets(\"Detail\").Range(\"E5\").Value = 1\nWorksheets(\"Detail\").Range(\"F5\").Value = \"=+CJP_DeliveryRecap_Detail[@Served]*E5\"\nWorksheets(\"Detail\").Range(\"G5\").Value = \"=+CJP_DeliveryRecap_Detail[@Billed]*E5\"\nSheets(\"Detail\").Range(\"E5:G5\").Copy Sheets(\"Detail\").Range(\"E6:E\" &amp; rc + 4)\nSheets(\"Detail\").Range(\"F1\").Value = (\"=SUM(F5:F\" &amp; rc + 4 &amp; \")\")\nSheets(\"Detail\").Range(\"G1\").Value = (\"=SUM(G5:G\" &amp; rc + 4 &amp; \")\")\n\nEnd Sub\n</code></pre>\n\n<p>So, what is it doing? The first \"strange\" thing is I occasionally get errors in the code that I have to continue on. A lot of times, but not all, it hits the Application.Wait line, then the Worksheets(\"Detail\").Activate line, and sometimes the line where I set values or copy data.</p>\n\n<p>There are some comments where I've been testing various refreshes etc. The issue is because while when the code completes it displays the data conn detail correctly but the calculations as to the size of the results is from the prior set. If I click the button a second time then it calculates them correctly. I would of course prefer not to have a arbitrary 3sec delay but simply run the rest of the code after the resultant records have been retrieved.</p>\n\n<p>Where am I going wrong as I've been banging my head against the wall with this. Most of what I do is in Access but Excel was the proper tool in this case.</p>\n\n<p>I just thought of, but not thrilled to, would it work to have a separate sub to handle the record size calcs and cell values clear\\set and call that from the button click or would that still not be generated until after the original sub ends.</p>\n\n<p>Thanks in advance,</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 2, "creation_date": 1537921327, "post_id": 52508143, "comment_id": 91956869, "body": "&quot;It doesn&#39;t work&quot; isn&#39;t very descriptive and without seeing an example of your data or knowing what you&#39;re trying to <i>do</i>, it&#39;s tough to help.  My only suggestion at this point is to <b>step through the code</b> line by line, monitoring the values of your variables, to figure out what&#39;s going on.  See Chip Pearson&#39;s <a href=\"http://www.cpearson.com/excel/DebuggingVBA.aspx\" rel=\"nofollow noreferrer\"><b>Debugging VBA</b></a>."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1537928089, "post_id": 52508143, "comment_id": 91958118, "body": "This works perfectly fine for me. Are the values in column F what you expect them to be?  BTW, <code>Do While .Cells(i, &quot;F&quot;).Value2 = &quot;&quot;</code> is potentially an infinite loop if you happen to delete everything to the right of it."}, {"owner": {"reputation": 23, "user_id": 10410320, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d32e3b33e36e07c12dc8fd8d6f96efae?s=128&d=identicon&r=PG&f=1", "display_name": "James G", "link": "https://stackoverflow.com/users/10410320/james-g"}, "edited": false, "score": 0, "creation_date": 1537993949, "post_id": 52508143, "comment_id": 91991091, "body": "True, &quot;it doesn&#39;t work&quot; wasn&#39;t very helpful on my part.  What I meant was that running the macro didn&#39;t produce any change to the spreadsheet.  Got it working now, though, thanks!"}], "answers": [{"tags": [], "owner": {"reputation": 5852, "user_id": 1690392, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/A3DKR.jpg?s=128&g=1", "display_name": "nutsch", "link": "https://stackoverflow.com/users/1690392/nutsch"}, "is_accepted": false, "score": 1, "last_activity_date": 1537921514, "creation_date": 1537921514, "answer_id": 52508282, "question_id": 52508143, "link": "https://stackoverflow.com/questions/52508143/loop-to-delete-blank-cells-from-a-column/52508282#52508282", "title": "Loop to delete blank cells from a column", "body": "<p>You are deleting blank cells by shifting the cells to the right in their place. If these cells are blank too, nothing will appear to change. If you want to remove the entire row instead, change your code to this: </p>\n\n<pre><code>Sub test()\nDim i As Long\nWith Worksheets(\"sheet1\")\nFor i =  .Cells(.Rows.Count, \"F\").End(xlUp).Row to 4 Step-1\n    IF .Cells(i, \"F\").Value2 = \"\"\n        .Cells(i, \"F\").entirerow.Delete shift:=xlUp\n    Loop\nNext i\nEnd With\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 23, "user_id": 10410320, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d32e3b33e36e07c12dc8fd8d6f96efae?s=128&d=identicon&r=PG&f=1", "display_name": "James G", "link": "https://stackoverflow.com/users/10410320/james-g"}, "edited": false, "score": 0, "creation_date": 1537994053, "post_id": 52509161, "comment_id": 91991132, "body": "Thanks!!  This helped a lot.  I changed the If Then into a Do While loop and it works like a dream now."}, {"owner": {"reputation": 575, "user_id": 7951002, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155077501585446/picture?type=large", "display_name": "MT32", "link": "https://stackoverflow.com/users/7951002/mt32"}, "reply_to_user": {"reputation": 23, "user_id": 10410320, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d32e3b33e36e07c12dc8fd8d6f96efae?s=128&d=identicon&r=PG&f=1", "display_name": "James G", "link": "https://stackoverflow.com/users/10410320/james-g"}, "edited": false, "score": 0, "creation_date": 1538025383, "post_id": 52509161, "comment_id": 91998914, "body": "@JamesG please upvote and mark the solution as the answer if it helped you."}], "tags": [], "owner": {"reputation": 575, "user_id": 7951002, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155077501585446/picture?type=large", "display_name": "MT32", "link": "https://stackoverflow.com/users/7951002/mt32"}, "is_accepted": true, "score": 0, "last_activity_date": 1537929439, "creation_date": 1537929439, "answer_id": 52509161, "question_id": 52508143, "link": "https://stackoverflow.com/questions/52508143/loop-to-delete-blank-cells-from-a-column/52509161#52509161", "title": "Loop to delete blank cells from a column", "body": "<p>Try this:</p>\n\n<pre><code>Sub test()\nDim i As Long\nDim lastrow as integer\n\nWith Worksheets(\"sheet1\")\nlastrow= cells(rows.count, 6).end(xlup).row     'define your last filled row\n\nFor i = 4 To lastrow\n    if IsEmpty(cells(i,6))= TRUE then\n    Cells(i,6).Delete shift:=xlToLeft\nNext i\nEnd With\nEnd Sub\n</code></pre>\n\n<p>However, I normally find deleting cells from the bottom up works better. So....perhaps you could try this as well:</p>\n\n<pre><code>Sub test()\nDim i As Long\nDim lastrow as integer\n\nWith Worksheets(\"sheet1\")\nlastrow= cells(rows.count, 6).end(xlup).row     'define your last filled row\n\nFor i = lastrow To 4 step -1\n    if IsEmpty(cells(i,6))= TRUE then\n    Cells(i,6).Delete shift:=xlToLeft\nNext i\nEnd With\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2672, "user_id": 10405778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e5abab1318bc4dde6e9ed2a626ef76c?s=128&d=identicon&r=PG&f=1", "display_name": "Ahmed AU", "link": "https://stackoverflow.com/users/10405778/ahmed-au"}, "is_accepted": false, "score": 0, "last_activity_date": 1537931991, "creation_date": 1537931991, "answer_id": 52509448, "question_id": 52508143, "link": "https://stackoverflow.com/questions/52508143/loop-to-delete-blank-cells-from-a-column/52509448#52509448", "title": "Loop to delete blank cells from a column", "body": "<p>Assuming \n 1. intent of the code is to only eliminate blanks in column F\n 2. deletion of entire row is uncalled for.\n 3. deleting cell xlLeft will inadvertently put the content (or blank cell) of Column G into column F.\n the following code may be tried</p>\n\n<pre><code>   Sub test()\n   Dim i As Long\n   With Worksheets(\"sheet1\")\n   For i = .Cells(.Rows.Count, \"F\").End(xlUp).Row To 4 Step -1\n       If .Cells(i, \"F\").Value2 = \"\" Then\n      .Range(.Cells(i + 1, \"F\"), .Cells(.Cells(.Rows.Count, \"F\").End(xlUp).Row, \"F\")).Cut\n      .Cells(i, \"F\").Select\n      .Paste\n       End If\n    Next i\n    End With\n    End Sub\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 10410320, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d32e3b33e36e07c12dc8fd8d6f96efae?s=128&d=identicon&r=PG&f=1", "display_name": "James G", "link": "https://stackoverflow.com/users/10410320/james-g"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 246, "favorite_count": 0, "accepted_answer_id": 52509161, "answer_count": 3, "score": 0, "last_activity_date": 1537931991, "creation_date": 1537920252, "question_id": 52508143, "link": "https://stackoverflow.com/questions/52508143/loop-to-delete-blank-cells-from-a-column", "title": "Loop to delete blank cells from a column", "body": "<p>I need to delete the blank cells in column F from F4 on down.  There will be between 0 and lots of blank cells per row.</p>\n\n<p>I'm very new to coding, and my most successful approach has been to take code that did something similar and cannibalized it.</p>\n\n<p>Here's the code that worked for something similar:</p>\n\n<pre><code>Sub test()\nDim i As Long\nWith Worksheets(\"Sheet1\")\n    For i = 4 To .Cells(.Rows.Count, \"F\").End(xlUp).Row\n        Do While .Cells(i, \"F\").Value2 = .Cells(1, \"B\").Value2 And Not \nIsEmpty(.Cells(i, \"F\"))\n            .Cells(i, \"F\").Resize(1, 4).Delete shift:=xlToLeft\n        Loop\nNext i\nEnd With\nEnd Sub\n</code></pre>\n\n<p>And here's what I tried to do with it:</p>\n\n<pre><code>Sub test()\nDim i As Long\nWith Worksheets(\"sheet1\")\nFor i = 4 To .Cells(.Rows.Count, \"F\").End(xlUp).Row\n    Do While .Cells(i, \"F\").Value2 = \"\"\n        .Cells(i, \"F\").Resize(1, 4).Delete shift:=xlToLeft\n    Loop\nNext i\nEnd With\nEnd Sub\n</code></pre>\n\n<p>I don't get any errors when I run it, but it doesn't work either.  </p>\n\n<p>Any guidance is appreciated!</p>\n"}, {"tags": ["excel", "vba", "checkbox", "userform"], "comments": [{"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1537916897, "post_id": 52507665, "comment_id": 91955915, "body": "Is there a column filled with priority? If so, filter on that value. Did you look up any answers about how to use <code>Range.Autofilter</code>? There are plenty of solutions on that"}, {"owner": {"reputation": 129, "user_id": 2578215, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/632651222/picture?type=large", "display_name": "Mark Austin", "link": "https://stackoverflow.com/users/2578215/mark-austin"}, "reply_to_user": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1537917497, "post_id": 52507665, "comment_id": 91956047, "body": "Yes the column is filled with the priority level (updated picture above). I was able to find information on the Range.Autofilter, but i am struggling to find info on how to link the value of the checkbox to the required criteria for the autofilter. If the user checks the priority level 1 box and clicks ok i want the autofilter to associate a true value as a 1 in the range autofilter criteria and any combination of check priority."}, {"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1537918414, "post_id": 52507665, "comment_id": 91956235, "body": "This isn&#39;t relevant but does this really need to rely on <code>ActiveSheet</code>?"}, {"owner": {"reputation": 129, "user_id": 2578215, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/632651222/picture?type=large", "display_name": "Mark Austin", "link": "https://stackoverflow.com/users/2578215/mark-austin"}, "reply_to_user": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1537972148, "post_id": 52507665, "comment_id": 91979784, "body": "That is a good point, no it does not need to be active sheet. I can define the sheet is applies to."}], "answers": [{"comments": [{"owner": {"reputation": 129, "user_id": 2578215, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/632651222/picture?type=large", "display_name": "Mark Austin", "link": "https://stackoverflow.com/users/2578215/mark-austin"}, "edited": false, "score": 0, "creation_date": 1537919213, "post_id": 52507910, "comment_id": 91956411, "body": "Yeah i have a button that will call this code. This code above only allows for one priority to be applied. If they user selects 1 and 3 then only priority 1 will be applied. I had a similar code above with all the combination and was trying to clean it up."}], "tags": [], "owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "is_accepted": false, "score": 0, "last_activity_date": 1537918247, "creation_date": 1537918247, "answer_id": 52507910, "question_id": 52507665, "link": "https://stackoverflow.com/questions/52507665/vba-filter-based-on-checked-boxes/52507910#52507910", "title": "VBA Filter Based on Checked Boxes", "body": "<p>You will just need to check the names of the check-boxes and line them up to the correct criteria. Notice that your criteria is just the value you want to filter, here <code>1, 2, or 3</code>. </p>\n\n<p>For your test statement, you could also just say <code>If CheckBox1 Then</code> which will return either <code>If True Then</code> where <code>True</code> corresponds to a checked box.</p>\n\n<p>I wrote it out explicitly in the below code so it is clear. I'm guessing this will probably need to be called when a submit button of some sort is clicked. </p>\n\n<hr>\n\n<pre><code>If CheckBox1 = True Then\n    ActiveSheet.Range(\"$W$7:$AG$4501\").AutoFilter Field:=6, Criteria:= 1\nElseIf CheckBox2 = True Then\n    ActiveSheet.Range(\"$W$7:$AG$4501\").AutoFilter Field:=6, Criteria:= 2\nElseIf CheckBox3 = True Then\n    ActiveSheet.Range(\"$W$7:$AG$4501\").AutoFilter Field:=6, Criteria:= 3\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 129, "user_id": 2578215, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/632651222/picture?type=large", "display_name": "Mark Austin", "link": "https://stackoverflow.com/users/2578215/mark-austin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 951, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1537918247, "creation_date": 1537916158, "last_edit_date": 1537917080, "question_id": 52507665, "link": "https://stackoverflow.com/questions/52507665/vba-filter-based-on-checked-boxes", "title": "VBA Filter Based on Checked Boxes", "body": "<p>I was wondering if anyone could help me out. I have created a user form that changes the filters on an excel sheet. I have column that contains a priority level from 1-3. When the form is launched i have a option to print the report to PDF, but i want to allow the user to apply/filter out result based on the priority, before they print to PDF. I have three check boxes that i want to use in a filter code (See image below). This where i get stuck, i am not sure how to input code into the Criteria portion so when the user would check the box priority 1, it would filter out that section before it prints. I was going to assign the numerical value that is associated with priority if the value is true. Then use that number as the value \"criteria\" when the filter is applied. Is there a better way to do this?  </p>\n\n<pre><code>ActiveSheet.Range(\"$W$7:$AG$4501\").AutoFilter Field:=6, Criteria:= \"What Do i Put Here?\" \n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/noBHg.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/noBHg.png\" alt=\"enter image description here\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/l6G4O.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/l6G4O.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 361, "user_id": 8172841, "user_type": "registered", "profile_image": "https://graph.facebook.com/10213855898812088/picture?type=large", "display_name": "Jamie Riis", "link": "https://stackoverflow.com/users/8172841/jamie-riis"}, "edited": false, "score": 0, "creation_date": 1537918006, "post_id": 52507577, "comment_id": 91956154, "body": "The code you provided will never get you to where you want to go and doesn&#39;t show any real effort to solve the problem.  All of us here will help you solve problems but we&#39;re not here to write your solution.  I suggest you get a book like &quot;Programming Excel with VBA: A Practical Real-World Guide &quot; to help you as you learn about VBA programming.  It will help you solve the problem. When you get stuck with a coding issue ask a question. Your should review <a href=\"https://stackoverflow.com/help/mcve\">How to create a Minimal, Complete, and Verifiable example</a>."}], "answers": [{"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 0, "last_activity_date": 1537919073, "creation_date": 1537919073, "answer_id": 52508009, "question_id": 52507577, "link": "https://stackoverflow.com/questions/52507577/vba-pushing-data-from-one-workbook-to-another-irrespective-of-file-names/52508009#52508009", "title": "VBA - Pushing data from one workbook to another, irrespective of file names", "body": "<p>\"Workbook A holds the macros\" - in this case you would use </p>\n\n<pre><code>ThisWorkbook\n</code></pre>\n\n<p>to refer to Workbook A</p>\n\n<p>...and</p>\n\n<pre><code>Workbooks(ThisWorkbook.Sheets(\"Sheet1\").Range(\"A1\").Value)\n</code></pre>\n\n<p>to refer to Workbook B</p>\n"}], "owner": {"reputation": 1, "user_id": 10301192, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/009fbc0b4e0eab479b778ee16d5b363d?s=128&d=identicon&r=PG&f=1", "display_name": "Szlav", "link": "https://stackoverflow.com/users/10301192/szlav"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 94, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1537919073, "creation_date": 1537915353, "question_id": 52507577, "link": "https://stackoverflow.com/questions/52507577/vba-pushing-data-from-one-workbook-to-another-irrespective-of-file-names", "title": "VBA - Pushing data from one workbook to another, irrespective of file names", "body": "<p>Been in a pickle for a while (week or so) here and was hoping someone in this magical community could help me out. There is likely a very easy solution for an experienced individual, which I am not. </p>\n\n<p>First, my goal is as follows: Push data from Workbook A to Workbook B via macro. \nConditions: </p>\n\n<p>Workbook A must be able to be renamed without compromising the macro (it is a tool used in day-to-day functions and saved as a new name each use). Workbook A holds the macros. </p>\n\n<p>Workbook B receives the data. Its name will also change with time, but in this case it needs to be based off written text in a cell from Workbook A (name change about yearly due to versioning) Let's just call it Cell A1 for argument's sake.</p>\n\n<p>There may be additional workbooks open at the same time, related or unrelated. </p>\n\n<p>To keep it simple, I will just post one line in my current macro, but I will be applying this to dozens. This works when I do not rename the files. I likely need help defining variables (strings?) and direction in what functions to use.</p>\n\n<pre><code>Windows(\"Workbook_B 4.7.5.xls\").Activate\n'*Workbook B name will ideally be derived from a cell value in Workbook A*\n\nRange(\"V12\") = \"='[Workbook_A V1.2.5 .xlsm]SHEET_A '!R8C7\"\n</code></pre>\n\n<p>In this chunk, the goal is to activate Workbook B and copy the value (or formula if it is easier), from cell G8 on Workbook A Sheet A to Workbook B(sheet is already active and sheet names will never change in either workbook). </p>\n\n<p>Cheers!</p>\n"}, {"tags": ["excel", "vba", "templates", "outlook"], "comments": [{"owner": {"reputation": 25, "user_id": 9209581, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aab987960fc8f9182a210c8354400bb1?s=128&d=identicon&r=PG&f=1", "display_name": "Richard2018", "link": "https://stackoverflow.com/users/9209581/richard2018"}, "reply_to_user": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1537921431, "post_id": 52507451, "comment_id": 91956890, "body": "The code works, I want it to send an email template and not an embedded message.  If my template is called temp.oft I wang it to open that for the message."}, {"owner": {"reputation": 25, "user_id": 9209581, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aab987960fc8f9182a210c8354400bb1?s=128&d=identicon&r=PG&f=1", "display_name": "Richard2018", "link": "https://stackoverflow.com/users/9209581/richard2018"}, "edited": false, "score": 0, "creation_date": 1537927328, "post_id": 52507451, "comment_id": 91957972, "body": "I have found the following code and it opens the template, I just need to add a to, from, cc, subject line and attachment.              Sub OutlookTemplate1()  Dim myolapp As Object Dim myitem As Object  Set myolapp = CreateObject(&quot;Outlook.Application&quot;) myolapp.Session.Logon &#39;Modify the link and title of the file to work with your example Set myitem = myolapp.CreateItemFromTemplate(&quot;C:\\Users\\e4h7x8r\\Desktop\\Tes&zwnj;&#8203;t_Templates.oft&quot;) myitem.Display &#39;or send End Sub"}, {"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 1, "creation_date": 1537927372, "post_id": 52507451, "comment_id": 91957980, "body": "You should not use a function here"}, {"owner": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 0, "creation_date": 1537969944, "post_id": 52507451, "comment_id": 91978283, "body": "You might just want to use the built-in <a href=\"https://support.office.com/en-us/article/send-an-email-message-based-on-a-template-56c645fc-1b25-4059-808b-55ee72b6bc2d\" rel=\"nofollow noreferrer\">template</a> and use vba to kick it off"}], "answers": [{"comments": [{"owner": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 0, "creation_date": 1537969654, "post_id": 52513972, "comment_id": 91978112, "body": "I agree that an approach with some external place to store the message makes more sense"}, {"owner": {"reputation": 25, "user_id": 9209581, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aab987960fc8f9182a210c8354400bb1?s=128&d=identicon&r=PG&f=1", "display_name": "Richard2018", "link": "https://stackoverflow.com/users/9209581/richard2018"}, "edited": false, "score": 0, "creation_date": 1537971892, "post_id": 52513972, "comment_id": 91979605, "body": "I got the following to work by creating small sets of the text in each function.   it might not be the cleanest but it work.  Thank you.Sub Sample_Auto_Generated_Email_Final()  Set Mail_Object = CreateObject(&quot;Outlook.Application&quot;)         With Mail_Object.CreateItem(o)             .Subject = &quot;MAR Report&quot;             .To = &quot;Richard.Sabbara@x.com&quot;             .Body = GetMessageBody() &amp; GetMessageBody2()             .Attachments.Add &quot;C:\\Users\\e4h7x8r\\Desktop\\History.txt&quot;             .Attachments.Add &quot;C:\\Users\\e4h7x8r\\Desktop\\Dr. C Report.xlsx&quot;             .Send     End With  End Sub"}], "tags": [], "owner": {"reputation": 828, "user_id": 10252988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/047bac7a125b9725dc9a257f8f0e0266?s=128&d=identicon&r=PG&f=1", "display_name": "Alina Li", "link": "https://stackoverflow.com/users/10252988/alina-li"}, "is_accepted": true, "score": 2, "last_activity_date": 1537952905, "creation_date": 1537952905, "answer_id": 52513972, "question_id": 52507451, "link": "https://stackoverflow.com/questions/52507451/macro-to-send-template/52513972#52513972", "title": "Macro to Send Template", "body": "<p>You could create a document the suffix named .docx, put you template in this document.</p>\n\n<p>Replace your code to the below code:</p>\n\n<pre><code>Sub Sample_Auto_Generated_Email()\nDim Email_Subject, Email_Send_From, Email_Send_To, _\nEmail_Cc, Email_Body As String\nDim Mail_Object, Mail_Single As Variant\nDim wd As Object, editor As Object\nDim doc As Object\nDim oMail As MailItem\n\n    Set wd = CreateObject(\"Word.Application\")\n    Set doc = wd.documents.Open(\"D:\\aa.docx\")\n    doc.Content.Copy\n    doc.Close\n    Set wd = Nothing\n    Email_Subject = \"Sample MAR Email\"\n\n    Email_Send_From = \u201c\"\n\n    Email_Send_To = \"\"\n    Set objOutl = CreateObject(\"Outlook.Application\")\n    Set objMailItem = objOutl.CreateItem(olMailItem)\n    objMailItem.Display\n    strEmailAddr = \"\"\n    objMailItem.Recipients.Add strEmailAddr\n    objMailItem.Subject = \"Sample\"\n    objMailItem.BodyFormat = olFormatRichText\n    Set editor = objMailItem.GetInspector.WordEditor\n        editor.Content.Paste\n    'objMailItem.HTMLBody =\n    objMailItem.Send\n    Set objMailItem = Nothing\n    Set objOutl = Nothing\n\n    End Sub\n</code></pre>\n\n<p>This is my result:</p>\n\n<p><a href=\"https://i.stack.imgur.com/iNlcz.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/iNlcz.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 25, "user_id": 9209581, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aab987960fc8f9182a210c8354400bb1?s=128&d=identicon&r=PG&f=1", "display_name": "Richard2018", "link": "https://stackoverflow.com/users/9209581/richard2018"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 130, "favorite_count": 0, "accepted_answer_id": 52513972, "answer_count": 1, "score": 0, "last_activity_date": 1537952905, "creation_date": 1537914431, "question_id": 52507451, "link": "https://stackoverflow.com/questions/52507451/macro-to-send-template", "title": "Macro to Send Template", "body": "<p>I have a long email that I need to send to our providers using a macro.  I have tried setting the email up as a function and then calling the function but I hit the maximum number of carriage returns.  </p>\n\n<p>I would like the make the email a template so that it's easier to update and then send.  So far what I have is this and it works for shorter messages, my message is long so I think that a template will be best.</p>\n\n<pre><code>Sub Sample_Auto_Generated_Email()\nDim Email_Subject, Email_Send_From, Email_Send_To, _\nEmail_Cc, Email_Body As String\nDim Mail_Object, Mail_Single As Variant\n\n    Email_Subject = \"Sample MAR Email\"\n\n    Email_Send_From = \"Richard.Sabbara@x.com\"\n\n    Email_Send_To = \"Richard.Sabbara@x.com\"\n    Set objOutl = CreateObject(\"Outlook.Application\")\n    Set objMailItem = objOutl.CreateItem(olMailItem)\n\n    objMailItem.Display\n    strEmailAddr = \"Richard.Sabbara@x.com\"\n    objMailItem.Recipients.Add strEmailAddr\n    objMailItem.Subject = \"Sample\"\n    objMailItem.Body = GetMessageBody()  \n    objMailItem.Send\n    Set objMailItem = Nothing\n    Set objOutl = Nothing\n\n    End Sub\n\n    ' This Function has been added.\n    Function GetMessageBody() As String\n    GetMessageBody = \"Good Afternoon\" &amp; vbNewLine &amp; _\n    Chr(10) &amp; _\n    \"Attached is your Monthly Action Report (MAR) for May 2018.\" &amp; vbNewLine &amp; _\n    Chr(10) &amp; _\n    \"This report has been password protected with your practice password provided         \n    to you by your ACOP Care Coordinator in April 2018.\" &amp; vbNewLine &amp; _\n    Chr(10) &amp; _\n    \"Technical questions (such as, how to access the MAR, password issues, not \n    receiving the email, etc.), please contact the Physician Engagement team at \n    providerservices@ax.com.\"\n    Chr (10) &amp; _\n    \"Questions related to the patient data contained within the MAR, please `enter code here`\n    contact your ACO Partner Care Coordinator.\"\n    Chr (10) &amp; _\n    \"Thank you,\"\n    End Function\n</code></pre>\n"}, {"tags": ["vba", "excel", "web-scraping", "screen-scraping"], "answers": [{"comments": [{"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1537917094, "post_id": 52507088, "comment_id": 91955957, "body": "Huh, I&#39;ve never seen this before - I&#39;m out of the office now, I&#39;ll try this tomorrow and report back..."}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1537969363, "post_id": 52507088, "comment_id": 91977933, "body": "Hmm this presents an empty locales window for me... just says &quot;No Variables&quot;."}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1537970687, "post_id": 52507088, "comment_id": 91978791, "body": "@dwirony - yeah, I was thinking about something else when I wrote it yesterday. Take a look at the updated answer and change it with your own web resource. The <code>watch window</code> is really a great help in cases like this."}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 1, "last_activity_date": 1537970642, "last_edit_date": 1537970642, "creation_date": 1537911871, "answer_id": 52507088, "question_id": 52507010, "link": "https://stackoverflow.com/questions/52507010/screenscraping-going-down-through-several-tag-names-to-a-class-name/52507088#52507088", "title": "Screenscraping - going down through several tag names to a class name", "body": "<p>Run only this:</p>\n\n<pre><code>Sub TestMe()\n\n    Dim objApp  As Object\n    Set objApp = CreateObject(\"InternetExplorer.Application\")\n\n    objApp.Navigate \"www.stackoverflow.com\"\n    Do While objApp.readyState &lt;&gt; 4\n        DoEvents\n    Loop\n\n    Dim myDocument As Object:  Set myDocument = objApp.Document\n    Dim myElement As Object: Set myElement = myDocument.getElementById(\"footer\")\n\n    Stop\n\nEnd Sub\n</code></pre>\n\n<ul>\n<li>It stops on the <code>Stop</code> line. </li>\n<li>With mouse select the word <code>myElement</code>, so it becomes blue.</li>\n<li>Press <kbd>Shift</kbd>+<kbd>F9</kbd> and enter the local window.</li>\n<li>In the local window, see the whole tree and replicate it in your code.</li>\n</ul>\n\n<p><a href=\"https://i.stack.imgur.com/KQC2J.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/KQC2J.png\" alt=\"enter image description here\"></a></p>\n"}, {"comments": [{"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1537969824, "post_id": 52510493, "comment_id": 91978216, "body": "So the query selector really does work like a charm, I&#39;ve just never been able to figure it out... Do you have any good resources for me to read up on it a bit more? Going off of what&#39;s visible has always worked for me in the past..."}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1537970041, "post_id": 52510493, "comment_id": 91978360, "body": "Really great, thanks! I&#39;ve already been able to add the next couple of steps with ease using the selector, I guess my main concern is what if I don&#39;t have an ID element to build off of (last question)?"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1537970117, "post_id": 52510493, "comment_id": 91978415, "body": "That is where CSS selectors are brilliant. Much more versatile.  I added an id selector in but there are a ton of different ways to get to elements without id. What else are you after? Have a look at those links as well as they show you some of the different selector types and combination methods. You can select by relative position, tag, class, attribute, id....."}, {"owner": {"reputation": 19801, "user_id": 9189799, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/U2hEg.jpg?s=128&g=1", "display_name": "SIM", "link": "https://stackoverflow.com/users/9189799/sim"}, "edited": false, "score": 1, "creation_date": 1537972119, "post_id": 52510493, "comment_id": 91979750, "body": "You really have become the go-to guy when it comes to work using <code>.querySelector()</code> @QHarr. Keep it going!!"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1537972208, "post_id": 52510493, "comment_id": 91979823, "body": "Lol...@SIM  Passing on your teachings! Just gutted that VBA supports so little :-(  I was just looking at <a href=\"https://developer.mozilla.org/en-US/docs/Web/CSS/Column_combinator\" rel=\"nofollow noreferrer\">this</a> but can only see it ever being useful in CSS direct."}, {"owner": {"reputation": 19801, "user_id": 9189799, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/U2hEg.jpg?s=128&g=1", "display_name": "SIM", "link": "https://stackoverflow.com/users/9189799/sim"}, "edited": false, "score": 0, "creation_date": 1537972372, "post_id": 52510493, "comment_id": 91979940, "body": "I hope someday we will be able to use pseudo selectors within vba."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1537972396, "post_id": 52510493, "comment_id": 91979958, "body": "Me 2. Does python allow for it? I have slacked off on my python stuff :-("}, {"owner": {"reputation": 19801, "user_id": 9189799, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/U2hEg.jpg?s=128&g=1", "display_name": "SIM", "link": "https://stackoverflow.com/users/9189799/sim"}, "edited": false, "score": 1, "creation_date": 1537972541, "post_id": 52510493, "comment_id": 91980068, "body": "Yeah, when you use <code>lxml</code> library (not every psudo selectors yet). However, <code>BeautifulSoup</code> don&#39;t."}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1537973410, "post_id": 52510493, "comment_id": 91980711, "body": "@QHarr Thanks for the help! Luckily this site that I&#39;m working with is really well built, seems to be a nice setup all throughout to work with, so nothing without an ID yet - I&#39;m sure I&#39;ll run into something funky soon though..."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1537973919, "post_id": 52510493, "comment_id": 91981073, "body": "@dwirony Then come holler at the dawghaus or post here."}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1537975981, "post_id": 52510493, "comment_id": 91982351, "body": "@QHarr Will do!"}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1538495294, "post_id": 52510493, "comment_id": 92158245, "body": "@QHarr Hey those resources are gone and so is the link to the dawghaus - would you mind sharing those again?"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1538495387, "post_id": 52510493, "comment_id": 92158303, "body": "On train but yes will get them to you later today."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1538495458, "post_id": 52510493, "comment_id": 92158349, "body": "Dhaus link <a href=\"https://chat.stackoverflow.com/rooms/169987/dawgs-waffle-haus\">chat.stackoverflow.com/rooms/169987/dawgs-waffle-haus</a>"}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": true, "score": 3, "last_activity_date": 1537948516, "last_edit_date": 1537948516, "creation_date": 1537939539, "answer_id": 52510493, "question_id": 52507010, "link": "https://stackoverflow.com/questions/52507010/screenscraping-going-down-through-several-tag-names-to-a-class-name/52510493#52510493", "title": "Screenscraping - going down through several tag names to a class name", "body": "<p>You should be able to use:</p>\n\n<pre><code>ie.document.querySelector(\"#main .textbox125.PatientID\")\n</code></pre>\n\n<p>This targets the parent id of <code>main</code> and the target element class <code>.textbox125 PatientID</code>. As compound class names are not allowed an additional <code>.</code> is required to remove whitespace.</p>\n\n<p>If you don't want to use querySelector, using only what is visible, a guess would be using tag name and go for:</p>\n\n<pre><code>ie.document.getElementsByTagName(\"input\")(1)\n</code></pre>\n\n<p>Remember:</p>\n\n<p>You can always right click to get a basic selector/xpath on an element</p>\n\n<p><img src=\"https://i.stack.imgur.com/kVqnd.png\" width=\"300\"></p>\n\n<p>And, the longer the path you use the more fragile your method becomes.</p>\n\n<hr>\n\n<p>Longer path:</p>\n\n<p>From what I can see you want the <strong>second</strong> <code>td</code> tag i.e. index 1 and then repeat that with the child <code>input</code> tags. This is based on what is visible! Really need the actual HTML to test with please as I am not confident with the viability of this.</p>\n\n<pre><code>IE.Document.GetElementById(\"main\"). _\nGetElementsByTagName(\"div\")(0). _\nGetElementsByTagName(\"div\")(0). _\nGetElementsByTagName(\"div\")(0). _\nGetElementsByTagName(\"table\")(0). _\nGetElementsByTagName(\"tbody\")(0). _\nGetElementsByTagName(\"tr\")(0). _\nGetElementsByTagName(\"td\")(1). _\nGetElementsByTagName(\"input\")(1).Value = patientid\n</code></pre>\n"}], "owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 191, "favorite_count": 1, "accepted_answer_id": 52510493, "answer_count": 2, "score": 3, "last_activity_date": 1537970642, "creation_date": 1537911344, "last_edit_date": 1537970479, "question_id": 52507010, "link": "https://stackoverflow.com/questions/52507010/screenscraping-going-down-through-several-tag-names-to-a-class-name", "title": "Screenscraping - going down through several tag names to a class name", "body": "<p>Having a hard time getting to the blue line to give it a value (it's a text box):</p>\n\n<p><a href=\"https://i.stack.imgur.com/5Mju9.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/5Mju9.png\" alt=\"img1\"></a></p>\n\n<p>Here is my current attempt to reach it - code is returning the typical <code>Run-time error '91': Object variable or With block variable not set</code></p>\n\n<pre><code>IE.Document.GetElementById(\"main\"). _\nGetElementsByTagName(\"div\")(0). _\nGetElementsByTagName(\"div\")(0). _\nGetElementsByTagName(\"div\")(0). _\nGetElementsByTagName(\"table\")(0). _\nGetElementsByTagName(\"tbody\")(0). _\nGetElementsByTagName(\"tr\")(0). _\nGetElementsByTagName(\"td\")(0). _\nGetElementsByClassName(\"textbox125 PatientID\")(0).Value = patientid\n</code></pre>\n\n<p>It's been a little while since I've done screenscraping, I'm guessing I have an extra tag name in there or I'm on the wrong item number for one of the tags... And before anyone asks, I don't really like query selector and I prefer to write out my scraping this way :).</p>\n"}, {"tags": ["excel", "vba", "if-statement"], "comments": [{"owner": {"reputation": 804, "user_id": 8127394, "user_type": "registered", "accept_rate": 6, "profile_image": "https://graph.facebook.com/226887584491743/picture?type=large", "display_name": "Cohen", "link": "https://stackoverflow.com/users/8127394/cohen"}, "edited": false, "score": 0, "creation_date": 1537910284, "post_id": 52506801, "comment_id": 91954070, "body": "Is this a for loop? Can\u2019t see the for in your code. Paste all ur code pls"}], "answers": [{"comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1537910431, "post_id": 52506821, "comment_id": 91954119, "body": "You could simplify the <code>Select Case</code> too, based on the concatenation of the Range value and &quot;_Sim&quot;."}, {"owner": {"reputation": 1156, "user_id": 10315836, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hZjRU.png?s=128&g=1", "display_name": "Valon Miller", "link": "https://stackoverflow.com/users/10315836/valon-miller"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1537910677, "post_id": 52506821, "comment_id": 91954198, "body": "Agreed, there are other modifications too, like using <code>With</code> to get rid of all the <code>ThisWorkbook</code> references, but I don&#39;t know what the rest of the code looks like, so I want to provide a solution with the least assumptions being made."}, {"owner": {"reputation": 103, "user_id": 6327633, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/61d5abf24358e17082652e9b095fb6a8?s=128&d=identicon&r=PG&f=1", "display_name": "actuario99", "link": "https://stackoverflow.com/users/6327633/actuario99"}, "edited": false, "score": 0, "creation_date": 1537910794, "post_id": 52506821, "comment_id": 91954240, "body": "Thanks! Didn&#39;t think a new line would make a difference."}, {"owner": {"reputation": 1156, "user_id": 10315836, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hZjRU.png?s=128&g=1", "display_name": "Valon Miller", "link": "https://stackoverflow.com/users/10315836/valon-miller"}, "edited": false, "score": 0, "creation_date": 1537910875, "post_id": 52506821, "comment_id": 91954273, "body": "You&#39;re welcome, if this solution resolved the issue you were experiencing please mark it as the correct answer."}], "tags": [], "owner": {"reputation": 1156, "user_id": 10315836, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hZjRU.png?s=128&g=1", "display_name": "Valon Miller", "link": "https://stackoverflow.com/users/10315836/valon-miller"}, "is_accepted": true, "score": 6, "last_activity_date": 1537910264, "creation_date": 1537910264, "answer_id": 52506821, "question_id": 52506801, "link": "https://stackoverflow.com/questions/52506801/what-am-i-missing-in-this-code-else-without-if-error/52506821#52506821", "title": "What am I missing in this code: &quot;Else without if error&quot;?", "body": "<p>You need the actions on new lines:</p>\n\n<pre><code>If wsD.Range(\"C4\") = \"AL\" Then\n    Set wsS = ThisWorkbook.Sheets(\"AL_Sim\")\nElseIf wsD.Range(\"C4\") = \"COLL\" Then\n    Set wsS = ThisWorkbook.Sheets(\"COLL_Sim\")\nElseIf wsD.Range(\"C4\") = \"COMP\" Then\n    Set wsS = ThisWorkbook.Sheets(\"COMP_Sim\")\nElseIf wsD.Range(\"C4\") = \"GL\" Then\n    Set wsS = ThisWorkbook.Sheets(\"GL_Sim\")\nElseIf wsD.Range(\"C4\") = \"EPL\" Then\n    Set wsS = ThisWorkbook.Sheets(\"EPL_Sim\")\nElseIf wsD.Range(\"C4\") = \"LAW\" Then\n    Set wsS = ThisWorkbook.Sheets(\"LAW_Sim\")\nElseIf wsD.Range(\"C4\") = \"POL\" Then\n    Set wsS = ThisWorkbook.Sheets(\"POL_Sim\")\nEnd If\n</code></pre>\n\n<p><code>Select Case</code> would be better here:</p>\n\n<pre><code>Select Case wsD.Range(\"C4\")\n    Case Is = \"AL\"\n        Set wsS = ThisWorkbook.Sheets(\"AL_Sim\")\n    Case Is = \"COLL\"\n        Set wsS = ThisWorkbook.Sheets(\"COLL_Sim\")\n    Case Is = \"COMP\"\n        Set wsS = ThisWorkbook.Sheets(\"COMP_Sim\")\n    Case Is = \"GL\"\n        Set wsS = ThisWorkbook.Sheets(\"GL_Sim\")\n    Case Is = \"EPL\"\n        Set wsS = ThisWorkbook.Sheets(\"EPL_Sim\")\n    Case Is = \"LAW\"\n        Set wsS = ThisWorkbook.Sheets(\"LAW_Sim\")\n    Case Is = \"POL\"\n        Set wsS = ThisWorkbook.Sheets(\"POL_Sim\")\nEnd Select\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": false, "score": 9, "last_activity_date": 1537910878, "creation_date": 1537910878, "answer_id": 52506939, "question_id": 52506801, "link": "https://stackoverflow.com/questions/52506801/what-am-i-missing-in-this-code-else-without-if-error/52506939#52506939", "title": "What am I missing in this code: &quot;Else without if error&quot;?", "body": "<p>The <code>If</code> statement has two legal syntaxes.</p>\n\n<p>Inline:</p>\n\n<pre><code>If {bool-expression} Then {statement}\n</code></pre>\n\n<p>And block:</p>\n\n<pre><code>If {bool-expression} Then\n    {statements}\nEnd If\n</code></pre>\n\n<p>So if there's a statement on the same line following the <code>Then</code> keyword, VBA parses the <code>If</code> statement as the inline syntax.</p>\n\n<p>Thus, since the statement is complete, the next statement beginning with <code>ElseIf</code> makes no sense to the compiler: there's an \"else without if\".</p>\n"}, {"tags": [], "owner": {"reputation": 5229, "user_id": 5512705, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/OoYN6.png?s=128&g=1", "display_name": "Samuel Hulla", "link": "https://stackoverflow.com/users/5512705/samuel-hulla"}, "is_accepted": false, "score": 7, "last_activity_date": 1558864192, "last_edit_date": 1558864192, "creation_date": 1537911179, "answer_id": 52506986, "question_id": 52506801, "link": "https://stackoverflow.com/questions/52506801/what-am-i-missing-in-this-code-else-without-if-error/52506986#52506986", "title": "What am I missing in this code: &quot;Else without if error&quot;?", "body": "<p>There is a little known fact <em>(or how I like to refer it, Microsoft's little practical joke..)</em> in <a href=\"/questions/tagged/vba\" class=\"post-tag\" title=\"show questions tagged &#39;vba&#39;\" rel=\"tag\">vba</a>, that the <strong><code>If..Then..End If</code></strong> condition has actually two established forms:</p>\n\n<ol>\n<li>Single-line syntax</li>\n<li>Multi-line syntax</li>\n</ol>\n\n<p>You basically mixed up multi-line and single-line syntax into one <em>mush</em>, as per <a href=\"https://docs.microsoft.com/en-us/dotnet/visual-basic/language-reference/statements/if-then-else-statement\" rel=\"nofollow noreferrer\">MSDN</a>:</p>\n\n<blockquote>\n  <p>What follows the <code>Then</code> keyword is examined to determine whether a\n  statement is a single-line <code>If</code>. <strong>If anything other than a comment\n  appears after <code>Then</code> on the same line, the statement is treated as a\n  single-line If statement.</strong> If <code>Then</code> is absent, it must be the start of a\n  multiple-line <code>If...Then...Else</code>.</p>\n</blockquote>\n\n<p>Example of a single-line statement:</p>\n\n<pre><code>If &lt;condition&gt; Then &lt;expression&gt;\n</code></pre>\n\n<p>and multi-line <em>(what you attempted to do)</em>:</p>\n\n<pre><code>If &lt;condition&gt; Then\n  &lt;expression&gt;\nElseIf &lt;condition&gt; Then 'optional, note comment isn't evaluated as single-line expression\n  &lt;expression&gt;\nEnd If\n</code></pre>\n\n<p>So to sum it up, your code threw an error, because the <code>ElseIf</code> got evaluated as an <em><code>&lt;expression&gt;</code></em> after the <code>If..Then</code> statement, instead to evaluating to a conditional like you intended it to.</p>\n\n<hr>\n\n<blockquote>\n  <p>The unwritten rule goes, <strong>always write in multi-line syntax</strong>.<br>\n  Not only you will steer clear of unnecessary errors (like you just\n  encountered), but it is also inarguably easier to read and the\n  standard amongst coders.</p>\n</blockquote>\n"}], "owner": {"reputation": 103, "user_id": 6327633, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/61d5abf24358e17082652e9b095fb6a8?s=128&d=identicon&r=PG&f=1", "display_name": "actuario99", "link": "https://stackoverflow.com/users/6327633/actuario99"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 311, "favorite_count": 2, "accepted_answer_id": 52506821, "answer_count": 3, "score": 3, "last_activity_date": 1558864192, "creation_date": 1537910108, "last_edit_date": 1537910250, "question_id": 52506801, "link": "https://stackoverflow.com/questions/52506801/what-am-i-missing-in-this-code-else-without-if-error", "title": "What am I missing in this code: &quot;Else without if error&quot;?", "body": "<p>I am trying to run this code which first declares <code>wsD</code> and then <code>WsS</code> depending on a cell in the \"Data\" tab. I keep getting an </p>\n\n<blockquote>\n  <p>else without if error. </p>\n</blockquote>\n\n<pre><code>Set wsD = ThisWorkbook.Sheets(\"Data\")\n\n    If wsD.Range(\"C4\") = \"AL\" Then Set wsS = ThisWorkbook.Sheets(\"AL_Sim\")\n    ElseIf wsD.Range(\"C4\") = \"COLL\" Then Set wsS = ThisWorkbook.Sheets(\"COLL_Sim\")\n    ElseIf wsD.Range(\"C4\") = \"COMP\" Then Set wsS = ThisWorkbook.Sheets(\"COMP_Sim\")\n    ElseIf wsD.Range(\"C4\") = \"GL\" Then Set wsS = ThisWorkbook.Sheets(\"GL_Sim\")\n    ElseIf wsD.Range(\"C4\") = \"EPL\" Then Set wsS = ThisWorkbook.Sheets(\"EPL_Sim\")\n    ElseIf wsD.Range(\"C4\") = \"LAW\" Then Set wsS = ThisWorkbook.Sheets(\"LAW_Sim\")\n    ElseIf wsD.Range(\"C4\") = \"POL\" Then Set wsS = ThisWorkbook.Sheets(\"POL_Sim\")\n\n    End If\nNext\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 5229, "user_id": 5512705, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/OoYN6.png?s=128&g=1", "display_name": "Samuel Hulla", "link": "https://stackoverflow.com/users/5512705/samuel-hulla"}, "edited": false, "score": 0, "creation_date": 1537910126, "post_id": 52506759, "comment_id": 91954009, "body": "From the first glance, you have an incorrect expression <i>(semantically speaking)</i> for <code>LstRow</code>. The line should be <code>LstRow = Cells(Rows.Count, 1).End(xlUp).Row</code> instead <i>(you have <code>Rows.Count</code> as value for <code>Column</code>)</i>"}, {"owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 0, "creation_date": 1537910328, "post_id": 52506759, "comment_id": 91954083, "body": "If you want to insert a formula, you need to use <code>Range.Formula</code> and not <code>Range.Value</code>"}, {"owner": {"reputation": 7206, "user_id": 8107092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dce232725da0108d5e43f3eebcaddd91?s=128&d=identicon&r=PG&f=1", "display_name": "Dy.Lee", "link": "https://stackoverflow.com/users/8107092/dy-lee"}, "edited": false, "score": 0, "creation_date": 1537929127, "post_id": 52506759, "comment_id": 91958353, "body": "index and match formula is wrong."}, {"owner": {"reputation": 7206, "user_id": 8107092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dce232725da0108d5e43f3eebcaddd91?s=128&d=identicon&r=PG&f=1", "display_name": "Dy.Lee", "link": "https://stackoverflow.com/users/8107092/dy-lee"}, "edited": false, "score": 0, "creation_date": 1537929223, "post_id": 52506759, "comment_id": 91958384, "body": "INDEX(array, row_num, [column_num])"}], "answers": [{"tags": [], "owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "is_accepted": false, "score": 0, "last_activity_date": 1537915574, "creation_date": 1537915574, "answer_id": 52507598, "question_id": 52506759, "link": "https://stackoverflow.com/questions/52506759/unsure-how-to-dynamically-paste-a-formula-to-last-column-and-last-row/52507598#52507598", "title": "Unsure How to Dynamically Paste a Formula To Last Column and Last Row", "body": "<p>You need to properly qualify your instances of <code>Range</code> and <code>Cells</code> with a worksheet. You can either directly do this, dim a worksheet variable, or use a <code>With</code> block like so: </p>\n\n<pre><code>Dim LRow as Long\n\nWith ThisworkBook.Sheets(\"????\")\n    LRow = .Range(\"A\" &amp; .Rows.Count).End(xlUp).Row \n    .Range(\"C2:AX5330\").Formula = \"=INDEX($A2,MATCH(D$1,$B2,0))\" 'Make sure your cell references are correct here\n    .Range(\"C2:AX5330\").Value = .Range(\"C2:AX55330\").Value 'Place as values instead of formula\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 10415508, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bc4d0d50a7f360352753199a6ec59217?s=128&d=identicon&r=PG&f=1", "display_name": "AnchorJoe645", "link": "https://stackoverflow.com/users/10415508/anchorjoe645"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 149, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1537915574, "creation_date": 1537909874, "question_id": 52506759, "link": "https://stackoverflow.com/questions/52506759/unsure-how-to-dynamically-paste-a-formula-to-last-column-and-last-row", "title": "Unsure How to Dynamically Paste a Formula To Last Column and Last Row", "body": "<p>VBA question using Excel 2016 (64 bit) </p>\n\n<p>I have header data in the first two columns (A:B) and the top row (1). I would like to dynamically paste a formula downward, starting from cell C2, to the last row <em>and</em> the last column. The working prototype is as follows: </p>\n\n<pre><code>    Dim LstCol As Long\n        LstCol = Cells(1, Columns.Count).End(xlToLeft).Column\n        Range(Cells(2, \"C\"), Cells(2, LstCol)).Value =         \"=INDEX(RC1,MATCH(R1C,RC2,0))\"\n    Dim LstRow As Long\n        LstRow = Cells(1, Rows.Count).End(xlUp).Row\n        Range(Cells(2, \"C\"), Cells(2, LstRow)).Value = \"=INDEX(RC1,MATCH(RC1,R2C,0))\"\n</code></pre>\n\n<p>The first Dim works as intended. The formula is successfully deployed throughout the second row to the final column (or perhaps it starts at the last column and moves leftward). However, the second Dim stops on an error. I'm unsure how to spread the data from the last row (to the last column) upwards to the second row (and the corresponding last column).</p>\n\n<p>In my example, the first two columns have header data from 1 to 5330 (A1:B5330). I also have header data in the first row (C1:AX1). My target is to fill the formula =INDEX($A2,MATCH(D$1,$B2,0)) from C2:AX5330 dynamically. </p>\n\n<p>Where am I going wrong?</p>\n"}, {"tags": ["vba", "time", "powerpoint"], "comments": [{"owner": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 0, "creation_date": 1537911124, "post_id": 52506688, "comment_id": 91954373, "body": "If you use a userform could you make a global variable to note the last time it was clicked and subtract from that instead? Then you\u2019d just not display the diff if the start date is the default for dates"}], "answers": [{"tags": [], "owner": {"reputation": 12482, "user_id": 1667023, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JXaUt.png?s=128&g=1", "display_name": "Steve Rindsberg", "link": "https://stackoverflow.com/users/1667023/steve-rindsberg"}, "is_accepted": false, "score": 2, "last_activity_date": 1537911690, "creation_date": 1537911690, "answer_id": 52507064, "question_id": 52506688, "link": "https://stackoverflow.com/questions/52506688/get-elapsed-time-between-2-clicks-on-the-same-object-in-power-point-slide-using/52507064#52507064", "title": "Get elapsed time between 2 clicks on the same object in power point slide using VBA", "body": "<p>Try this small mod to what you've got:</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n\nStatic StartTime As Double\nStatic Running As Boolean\n\nRunning = Not Running\n\nIf Running Then\n    StartTime = Now\nElse\n    Running = False\n    MsgBox DateDiff(\"s\", StartTime, Now)\nEnd If\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "is_accepted": true, "score": 2, "last_activity_date": 1537913219, "creation_date": 1537913219, "answer_id": 52507286, "question_id": 52506688, "link": "https://stackoverflow.com/questions/52506688/get-elapsed-time-between-2-clicks-on-the-same-object-in-power-point-slide-using/52507286#52507286", "title": "Get elapsed time between 2 clicks on the same object in power point slide using VBA", "body": "<p>It's easiest to follow if you add VBA code to your presentation first, before adding a special shape that you'll click. The code here goes in a regular module and will be associated directly to the designated shape on whichever slide you choose.</p>\n\n<pre><code>Option Explicit\n\nPrivate alreadyStarted As Boolean\n\nPublic Sub ClickCatcher(ByRef actionShape As Shape)\n    Debug.Print \"shape clicked: \" &amp; actionShape.Name\n    If Not alreadyStarted Then\n        StartCounter\n        alreadyStarted = True\n    Else\n        Dim elapsed As Double\n        elapsed = TimeElapsed() / 1000#\n        MsgBox \"Time Elapsed: \" &amp; Format(elapsed, \"#.000 sec\")\n        alreadyStarted = False\n    End If\nEnd Sub\n</code></pre>\n\n<p>(I'll show you the timer code below)</p>\n\n<p>It's easy to see that using the global variable <code>alreadyStarted</code>, you can toggle the timer to start and stop and report the elapsed time (in milliseconds).</p>\n\n<p>The <code>Debug.Print</code> statement shows the name of the shape that was clicked. This <strong>might</strong> be important if you have more than one action shape. So you could perhaps check for the name of the timer shape and not some other one.</p>\n\n<p>The final setup you need is to add an \"action shape\" to you selected slide. You can do this from the <em>INSERT</em> ribbon, then select <em>Shapes</em> and scroll all the way to the bottom until you see the Action Shapes. Select any of them you like and add it to a slide. Immediately you'll see a pop-up dialog asking you for the action setting. Make sure you select <em>Run Macro</em> and that the name of your routine is selected (<code>ClickCatcher</code> in this case).</p>\n\n<p><a href=\"https://i.stack.imgur.com/43Fiz.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/43Fiz.png\" alt=\"enter image description here\"></a></p>\n\n<p>Now go into Presentation mode and click once on that shape, then click a second time and the <code>MsgBox</code> will pop up showing the elapsed time.</p>\n\n<p>Here's the precision timer code. I'd suggest to create a separate code module and copy this code there.</p>\n\n<pre><code>Option Explicit\n\n'------------------------------------------------------------------------------\n' For Precision Counter methods\n'\nPrivate Type LargeInteger\n    lowpart As Long\n    highpart As Long\nEnd Type\n\nPrivate Declare Function QueryPerformanceCounter Lib _\n                         \"kernel32\" (lpPerformanceCount As LargeInteger) As Long\nPrivate Declare Function QueryPerformanceFrequency Lib _\n                         \"kernel32\" (lpFrequency As LargeInteger) As Long\n\nPrivate counterStart As LargeInteger\nPrivate counterEnd As LargeInteger\nPrivate crFrequency As Double\n\nPrivate Const TWO_32 = 4294967296#               ' = 256# * 256# * 256# * 256#\n\n'==============================================================================\n' Precision Timer Controls\n'\nPrivate Function LI2Double(lgInt As LargeInteger) As Double\n    '--- converts LARGE_INTEGER to Double\n    Dim low As Double\n    low = lgInt.lowpart\n    If low &lt; 0 Then\n        low = low + TWO_32\n    End If\n    LI2Double = lgInt.highpart * TWO_32 + low\nEnd Function\n\nPublic Sub StartCounter()\n    '--- Captures the high precision counter value to use as a starting\n    '    reference time.\n    Dim perfFrequency As LargeInteger\n    QueryPerformanceFrequency perfFrequency\n    crFrequency = LI2Double(perfFrequency)\n    QueryPerformanceCounter counterStart\nEnd Sub\n\nPublic Function TimeElapsed() As Double\n    '--- Returns the time elapsed since the call to StartCounter in microseconds\n    If crFrequency = 0# Then\n        Err.Raise Number:=11, _\n                  Description:=\"Must call 'StartCounter' in order to avoid \" &amp; _\n                                \"divide by zero errors.\"\n    End If\n    Dim crStart As Double\n    Dim crStop As Double\n    QueryPerformanceCounter counterEnd\n    crStart = LI2Double(counterStart)\n    crStop = LI2Double(counterEnd)\n    TimeElapsed = 1000# * (crStop - crStart) / crFrequency\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 2994, "user_id": 1108064, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/QNxwp.jpg?s=128&g=1", "display_name": "Teo", "link": "https://stackoverflow.com/users/1108064/teo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 93, "favorite_count": 0, "accepted_answer_id": 52507286, "answer_count": 2, "score": 2, "last_activity_date": 1537913219, "creation_date": 1537909535, "question_id": 52506688, "link": "https://stackoverflow.com/questions/52506688/get-elapsed-time-between-2-clicks-on-the-same-object-in-power-point-slide-using", "title": "Get elapsed time between 2 clicks on the same object in power point slide using VBA", "body": "<p>Premise: I never used VBA before..</p>\n\n<p><strong>What I would like to obtain:</strong>\n directly inside the slide, when I click on a shape or a button, I want to start the timer and when I click again on <strong>the same</strong> object, I want show the elapsed time between the first click and the second one..</p>\n\n<p>Here what I did:</p>\n\n<p>I created a form and I put the following code</p>\n\n<pre><code>Private startTime As Date\nPrivate endTime As Date\n\n\nPrivate Sub CommandButton1_Click()\nstartTime = Now\n\nEnd Sub\n\nPrivate Sub CommandButton2_Click()\n    endTime = Now\n\n\n    TextBox2.Value = startTime\n    TextBox3.Value = endTime\n    TextBox1.Value = DateDiff(\"s\", startTime, endTime)\n\nEnd Sub\n</code></pre>\n\n<p>As you can see, I'm using 2 button.. how can I do the same with only 1 button?</p>\n\n<p>Is it possible to do that without using a form?</p>\n\n<p>I think it will be more beautiful directly inside the slide (and actually, it is what I need to do)\nIf not.. how can I make the form more beautiful? Like change color, style and so on</p>\n\n<p>Could you give me any advice?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 3, "creation_date": 1537908961, "post_id": 52506459, "comment_id": 91953535, "body": "A UDF cannot open a workbook. A UDF takes input, computes a result, returns that result. Any more than that and what you want is a macro, not a UDF."}, {"owner": {"reputation": 1, "user_id": 7921441, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-b4yWDM_DBvk/AAAAAAAAAAI/AAAAAAAAACI/OAU3wzDZ-9c/photo.jpg?sz=128", "display_name": "Jake Ladson", "link": "https://stackoverflow.com/users/7921441/jake-ladson"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1537913060, "post_id": 52506459, "comment_id": 91954984, "body": "@MathieuGuindon Ah ok. Thank you for the help!"}], "owner": {"reputation": 1, "user_id": 7921441, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-b4yWDM_DBvk/AAAAAAAAAAI/AAAAAAAAACI/OAU3wzDZ-9c/photo.jpg?sz=128", "display_name": "Jake Ladson", "link": "https://stackoverflow.com/users/7921441/jake-ladson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 70, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1537908428, "creation_date": 1537908428, "question_id": 52506459, "link": "https://stackoverflow.com/questions/52506459/cant-link-to-external-file-with-index-match-function", "title": "Cant link to external file with Index Match function", "body": "<p>I am trying to link to an external file in my index match function. It works fine when I use a different sheet from the same workbook but I cant seem to get it to use the external workbook. </p>\n\n<pre><code>Public Function convertToCases(item As Double, eaches As Integer)\nSet parts = Workbooks.Open(\"G:\\Inventory\\Baselines\\StandardFiles\\PartDataWithRaw.xlsx\")\n\n'    =INDEX('Part Data'!A:G,MATCH(E2,'Part Data'!A:A,0),6)\ncaseEach = Application.WorksheetFunction.Index(Worksheets(\"Sheet2\").Range(\"A:G\"), Application.WorksheetFunction.Match(item, Worksheets(\"Sheet2\").Range(\"A:A\"), 0), 6)\n    convertToCases = eaches / caseEach\n\nEnd Function\n</code></pre>\n\n<p>Ive looked everywhere and cant seem to find out why it is not working. I am getting a #VALUE error when I try and use it in excel. </p>\n\n<p>Thanks for the help!</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 155, "user_id": 9901759, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216039690767111/picture?type=large", "display_name": "Yavuz Topal", "link": "https://stackoverflow.com/users/9901759/yavuz-topal"}, "edited": false, "score": 0, "creation_date": 1537947745, "post_id": 52506435, "comment_id": 91964613, "body": "that code doesnt work much. The values are supposed to be pasted into an other sheets named &quot;ws&quot;.Moreover, I have more cells to copy in order to paste it into another sheet and the question is whether there is a more compact way to code it.Otherwise i would have about 10 line of code just to copy ten cells"}, {"owner": {"reputation": 1629, "user_id": 5379555, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PrDxe.jpg?s=128&g=1", "display_name": "Pawel Czyz", "link": "https://stackoverflow.com/users/5379555/pawel-czyz"}, "reply_to_user": {"reputation": 155, "user_id": 9901759, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216039690767111/picture?type=large", "display_name": "Yavuz Topal", "link": "https://stackoverflow.com/users/9901759/yavuz-topal"}, "edited": false, "score": 0, "creation_date": 1537949731, "post_id": 52506435, "comment_id": 91965742, "body": "My answer was a general guideline. If you want a more percise solution to your particular problem then post complete code. If you have more cells to copy then a loop should be a way to go.  Please edit your question with complete code."}, {"owner": {"reputation": 155, "user_id": 9901759, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216039690767111/picture?type=large", "display_name": "Yavuz Topal", "link": "https://stackoverflow.com/users/9901759/yavuz-topal"}, "edited": false, "score": 0, "creation_date": 1537957219, "post_id": 52506435, "comment_id": 91970428, "body": "Thank you. I just did. This works but it pretty cumbersome and long. I dont know if the loop command would have the desired effect."}, {"owner": {"reputation": 1629, "user_id": 5379555, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PrDxe.jpg?s=128&g=1", "display_name": "Pawel Czyz", "link": "https://stackoverflow.com/users/5379555/pawel-czyz"}, "reply_to_user": {"reputation": 155, "user_id": 9901759, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216039690767111/picture?type=large", "display_name": "Yavuz Topal", "link": "https://stackoverflow.com/users/9901759/yavuz-topal"}, "edited": false, "score": 0, "creation_date": 1538237579, "post_id": 52506435, "comment_id": 92077095, "body": "I have edited my answer. Your copying range do not have any pattern so loop might not be the best way. I have changed copying to assigning values as it is much better option."}, {"owner": {"reputation": 155, "user_id": 9901759, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216039690767111/picture?type=large", "display_name": "Yavuz Topal", "link": "https://stackoverflow.com/users/9901759/yavuz-topal"}, "edited": false, "score": 0, "creation_date": 1538318448, "post_id": 52506435, "comment_id": 92092836, "body": "I see, this line &quot;ws.Range(&quot;J106&quot;).Value = wsEigene.Range(&quot;C29&quot;).Value&quot; shall be adjusted furhter to the other cells to be copied from?"}, {"owner": {"reputation": 1629, "user_id": 5379555, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PrDxe.jpg?s=128&g=1", "display_name": "Pawel Czyz", "link": "https://stackoverflow.com/users/5379555/pawel-czyz"}, "reply_to_user": {"reputation": 155, "user_id": 9901759, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216039690767111/picture?type=large", "display_name": "Yavuz Topal", "link": "https://stackoverflow.com/users/9901759/yavuz-topal"}, "edited": false, "score": 0, "creation_date": 1538318757, "post_id": 52506435, "comment_id": 92092945, "body": "Yes - this is a guideline, a general rule - copying is not the best way to move data. Just try it and if it is faster and easier to ready then modify the rest of your code :)"}], "tags": [], "owner": {"reputation": 1629, "user_id": 5379555, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PrDxe.jpg?s=128&g=1", "display_name": "Pawel Czyz", "link": "https://stackoverflow.com/users/5379555/pawel-czyz"}, "is_accepted": true, "score": 1, "last_activity_date": 1538237518, "last_edit_date": 1538237518, "creation_date": 1537908326, "answer_id": 52506435, "question_id": 52506332, "link": "https://stackoverflow.com/questions/52506332/copy-and-paste-values-in-predetermined-cells/52506435#52506435", "title": "Copy and paste values in predetermined cells", "body": "<p>The best way is to avoid copying. Much faster is assigning value of a source cell to a target cell. Especially, if all you need is the value of a cell. You can do it this way:</p>\n\n<pre><code>Dim wbEigene As Workbook\nSet wbEigene = Workbooks(\"Eigene Fundingspreads.xlsm\")\nDim wsPlainVanilla as Worksheet\nSet wsPlainVanilla = wbEigene.Worksheets(\"Plain Vanilla\")\n\n'this way is more efficient than copying:\nws.Range(\"J106\").Value = wsEigene.Range(\"C29\").Value\n</code></pre>\n\n<p>Dim all your sheets and workbooks and use these variables to make your code more readable and easy to maintain.</p>\n"}, {"tags": [], "owner": {"reputation": 155, "user_id": 9901759, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216039690767111/picture?type=large", "display_name": "Yavuz Topal", "link": "https://stackoverflow.com/users/9901759/yavuz-topal"}, "is_accepted": false, "score": 1, "last_activity_date": 1538389417, "creation_date": 1538389417, "answer_id": 52589092, "question_id": 52506332, "link": "https://stackoverflow.com/questions/52506332/copy-and-paste-values-in-predetermined-cells/52589092#52589092", "title": "Copy and paste values in predetermined cells", "body": "<p>The final answer would be this:</p>\n\n<pre><code>ws.Range(\"J106\").Value = wsEigene.Range(\"C29\").Value\n\nws.Range(\"L106\").Value = wsEigene.Range(\"C31\").Value\n\nws.Range(\"J106\").Value = wsEigene.Range(\"C29\").Value\n\nws.Range(\"N106\").Value = wsEigene.Range(\"C33\").Value\n</code></pre>\n"}], "owner": {"reputation": 155, "user_id": 9901759, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216039690767111/picture?type=large", "display_name": "Yavuz Topal", "link": "https://stackoverflow.com/users/9901759/yavuz-topal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 72, "favorite_count": 0, "accepted_answer_id": 52506435, "answer_count": 2, "score": 0, "last_activity_date": 1593592165, "creation_date": 1537907841, "last_edit_date": 1593592165, "question_id": 52506332, "link": "https://stackoverflow.com/questions/52506332/copy-and-paste-values-in-predetermined-cells", "title": "Copy and paste values in predetermined cells", "body": "<p>All what the code does is to copy three values and paste it into a new sheet   </p>\n\n<p>The question is whether there is a shorter way in order to have the code more compact?</p>\n\n<p>A loop would an option. However, the last lines to be copied and paste do not have a difference of 2. That is why i thought that a loop with \"step 2\" wouldnt yield the desired result.  </p>\n\n<pre><code>   Dim wb As Workbook, wq As Object\n   Dim ws As Worksheet, datDatum\n   Dim cell As Range\n\n   Set wb = Workbooks.Add\n   Set ws = wb.Worksheets(\"Table\")\n    ws.Select\n\n   Workbooks(\"Eigene Fundingspreads.xlsm\").Sheets(\"Plain \n   Vanilla\").Range(\"C29\").Copy\n   ws.Range(\"J106\").PasteSpecial Paste:=xlPasteValues  \n\n   Workbooks(\"Eigene Fundingspreads.xlsm\").Sheets(\"Plain \n   Vanilla\").Range(\"C31\").Copy\n   ws.Range(\"L106\").PasteSpecial Paste:=xlPasteValues\n\n  Workbooks(\"Eigene Fundingspreads.xlsm\").Sheets(\"Plain \n  Vanilla\").Range(\"C33\").Copy\n  ws.Range(\"N106\").PasteSpecial Paste:=xlPasteValues\n\n  Workbooks(\"Eigene Fundingspreads.xlsm\").Sheets(\"Plain \n  Vanilla\").Range(\"C36\").Copy\n  ws.Range(\"Q106\").PasteSpecial Paste:=xlPasteValues\n</code></pre>\n\n<p>Second Round of copying</p>\n\n<pre><code>  Workbooks(\"Eigene Fundingspreads.xlsm\").Sheets(\"Plain \n  Vanilla\").Range(\"L29\").Copy\n  ws.Range(\"J113\").PasteSpecial Paste:=xlPasteValues\n\n Workbooks(\"Eigene Fundingspreads.xlsm\").Sheets(\"Plain \n Vanilla\").Range(\"L31\").Copy\n ws.Range(\"L113\").PasteSpecial Paste:=xlPasteValues\n\n Workbooks(\"Eigene Fundingspreads.xlsm\").Sheets(\"Plain \n Vanilla\").Range(\"L33\").Copy\n ws.Range(\"N113\").PasteSpecial Paste:=xlPasteValues\n\n Workbooks(\"Eigene Fundingspreads.xlsm\").Sheets(\"Plain \n Vanilla\").Range(\"L36\").Copy\n ws.Range(\"Q113\").PasteSpecial Paste:=xlPasteValues\n</code></pre>\n"}, {"tags": ["vba", "ms-word"], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 10415215, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c132106ffb7a5e8a7448e656cda4d607?s=128&d=identicon&r=PG&f=1", "display_name": "Jasiper", "link": "https://stackoverflow.com/users/10415215/jasiper"}, "edited": false, "score": 0, "creation_date": 1538062127, "post_id": 52511223, "comment_id": 92020689, "body": "0 down vote accept  Thank you so much! This completely answered my question and even gave me some new ideas."}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "reply_to_user": {"reputation": 21, "user_id": 10415215, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c132106ffb7a5e8a7448e656cda4d607?s=128&d=identicon&r=PG&f=1", "display_name": "Jasiper", "link": "https://stackoverflow.com/users/10415215/jasiper"}, "edited": false, "score": 0, "creation_date": 1538074904, "post_id": 52511223, "comment_id": 92026859, "body": "Glad it helped @Jasiper :-) Since you&#39;re new to Stack Overflow: When a contribution answers a question you should click the checkmark to its left. That tells others with a similar problem that the contribution answered the question (comments tend to get removed over time). It also lets people who answer  know that the question has an answer. And, finally, it awards site &quot;reputaition points&quot; to the person who answered. Later, once you have enough reputation you&#39;ll also be able to upvote all contributions (questions and answers) you find useful... And downvote things you consider low quality."}], "tags": [], "owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "is_accepted": false, "score": 0, "last_activity_date": 1537943105, "creation_date": 1537943105, "answer_id": 52511223, "question_id": 52506092, "link": "https://stackoverflow.com/questions/52506092/how-to-get-selection-text-to-read-displaytext-of-macro-field-code/52511223#52511223", "title": "How to get Selection.Text to read displaytext of Macro field code", "body": "<p>You can read the field code, directly, instead of the selection (or the <code>Field.Result</code> which also doesn't give the text).</p>\n\n<p>It's not quite clear how this macro is to be used throughout the document, so the code sample below provides two variations. </p>\n\n<p>Both check whether the selection contains fields and if so, whether the (first) field is a <code>MacroButton</code> field. The field code is then tested.</p>\n\n<p>In the variation that's commented out (the simpler one) the code then simply checks whether the <code>MacroButton</code> display text is present in the field code. If it is, that text is assigned to the string variable being tested by the <code>Select</code> statement.</p>\n\n<p>If this is insufficient because the display text is \"unknown\" (more than one MacroButton field, perhaps) then it's necessary to locate the part of the field code that contains the display text. In this case, the function <code>InstrRev</code> locates the end point of the combined field name and macro name, plus the intervening spaces, in the entire field code, searching from the <em>end</em> of the string. After that, the <code>Mid</code> function extracts the display text and assigns it to the string variable tested by the <code>Select</code> statement.</p>\n\n<p>In both variations, if the selection does <em>not</em> contain a <code>MacroButton</code> field then the selected test is assigned to the string variable for the <code>Select</code> statement.</p>\n\n<p>(Note that for my tests I needed to use <code>Case Else</code> in the <code>Select</code> statement. You probably want to change that back to <code>Case \"B\"</code>...)</p>\n\n<pre><code>Sub Display_Field_DisplayText()\n    Dim Str As String, strDisplayText As String\n    Dim textLoc As Long\n    Dim strFieldText As String, strMacroName As String\n    Dim strFieldName As String, strFieldCode As String\n\n    strDisplayText = \"text to display\"\n\n    If Selection.Fields.Count &gt; 0 Then\n        If Selection.Fields(1).Type = wdFieldMacroButton Then\n            strFieldName = \"MacroButton \"\n            strMacroName = \"Display_Field_DisplayText \"\n            strFieldCode = strFieldName &amp; strMacroName\n            Str = Selection.Fields(1).code.text\n            textLoc = InStrRev(Str, strFieldCode)\n            strFieldText = Mid(Str, textLoc + Len(strFieldCode))\n\n            MsgBox strFieldText\n            Str = strFieldText\n            'If InStr(Selection.Fields(1).code.text, strDisplayText) &gt; 0 Then\n             '   Str = strDisplayText\n            'End If\n        End If\n    Else\n        Str = Selection.text\n    End If\n\n    Select Case Str\n        Case strDisplayText\n            MsgBox \"A was selected\"\n        Case Else\n            MsgBox \"B was selected\"\n    End Select\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 10415215, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c132106ffb7a5e8a7448e656cda4d607?s=128&d=identicon&r=PG&f=1", "display_name": "Jasiper", "link": "https://stackoverflow.com/users/10415215/jasiper"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 334, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1538062102, "creation_date": 1537906768, "last_edit_date": 1537940156, "question_id": 52506092, "link": "https://stackoverflow.com/questions/52506092/how-to-get-selection-text-to-read-displaytext-of-macro-field-code", "title": "How to get Selection.Text to read displaytext of Macro field code", "body": "<p>I'm having some trouble figuring this out, and would really appreciate some help. I'm trying to write a macro that uses the selection.text property as a Case text-expression. When the macro is clicked in Microsoft Word, the selected text is automatically set to the DisplayText. This method worked great for the formatting via Selection.Font.Color for a quick and dirty formatting toggling macro, but it doesn't work for the actual text. </p>\n\n<p>When debugging with MsgBox, it is showing a box (Eg: \u25a1 ) as the value.</p>\n\n<p>For example, </p>\n\n<p>Word Field Code: </p>\n\n<pre><code>{ MACROBUTTON Macro_name DisplayText }\n</code></pre>\n\n<p>VBA Code run when highlighting \"DisplayText\" in Word: </p>\n\n<pre><code>Sub Macro_name()    \n    Dim Str As String\n\n    Str = Selection.Text\n\n    MsgBox Str\n\n    Select Case Str            \n        Case \"DisplayText\"\n            MsgBox \"A was selected\"\n        Case \"B\"\n            MsgBox \"B was selected\"\n    End Select        \nEnd Sub\n</code></pre>\n\n<p>What is output is a Message Box that only shows \u25a1\nWhen I run this macro with some regular text selected, it works just fine. </p>\n\n<p>My question is this: Is there a way to have the macro read the displaytext part of the field code for use in the macro?</p>\n"}, {"tags": ["excel", "vba", "click", "double-click"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 1, "creation_date": 1537905182, "post_id": 52505684, "comment_id": 91952048, "body": "Those events don&#39;t support the <code>HideText As Boolean</code> argument and <code>HideRow As Boolean</code> argument. In the code you provided, <code>HideRow</code> is not used at all, but <code>HiddenRows</code> is - related?"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 1, "creation_date": 1537905913, "post_id": 52505684, "comment_id": 91952306, "body": "Both will throw the same compile error. There&#39;s no way that the &quot;single-click&quot; code was working before if it included the <code>HideText</code> argument."}, {"owner": {"reputation": 65, "user_id": 10158134, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-CRAM41oNNq8/AAAAAAAAAAI/AAAAAAAAAE0/1m4i6sqODpc/photo.jpg?sz=128", "display_name": "Casey", "link": "https://stackoverflow.com/users/10158134/casey"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1537906409, "post_id": 52505684, "comment_id": 91952500, "body": "Moving my Boolean dimensioning into the code (instead of the sub heading) and matching the variable name for &quot;HiddenRows&quot; fixed my problem. Thank you both, so much!"}], "answers": [{"comments": [{"owner": {"reputation": 65, "user_id": 10158134, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-CRAM41oNNq8/AAAAAAAAAAI/AAAAAAAAAE0/1m4i6sqODpc/photo.jpg?sz=128", "display_name": "Casey", "link": "https://stackoverflow.com/users/10158134/casey"}, "edited": false, "score": 0, "creation_date": 1538028793, "post_id": 52506051, "comment_id": 92000301, "body": "Ironically, I am able to get the code to compile as long as I add any boolean to the event name (including HideRow), but removing them causes the code to fail to compile. I currently have a made up and unused boolean declared in the parentheses so it will compile. ::shrugs::  Also, I&#39;m unable to find any information on event handler signatures, event signatures, or even a decent article on members inherited from the worksheet class. Would you have a suggested place for me to educate myself on those things?  Thanks!"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 65, "user_id": 10158134, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-CRAM41oNNq8/AAAAAAAAAAI/AAAAAAAAAE0/1m4i6sqODpc/photo.jpg?sz=128", "display_name": "Casey", "link": "https://stackoverflow.com/users/10158134/casey"}, "edited": false, "score": 0, "creation_date": 1538046164, "post_id": 52506051, "comment_id": 92010201, "body": "The object browser (F2), and the two dropdowns in the code pane."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 65, "user_id": 10158134, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-CRAM41oNNq8/AAAAAAAAAAI/AAAAAAAAAE0/1m4i6sqODpc/photo.jpg?sz=128", "display_name": "Casey", "link": "https://stackoverflow.com/users/10158134/casey"}, "edited": false, "score": 0, "creation_date": 1538047593, "post_id": 52506051, "comment_id": 92011102, "body": "@Casey the code may compile, but pay attention to the dropdowns at the top of the code pane: if it says &quot;(general)&quot; in the left one, it&#39;s not an event handler - just a procedure that will never run ;-)"}], "tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": false, "score": 5, "last_activity_date": 1537906756, "last_edit_date": 1537906756, "creation_date": 1537906561, "answer_id": 52506051, "question_id": 52505684, "link": "https://stackoverflow.com/questions/52505684/run-one-macro-on-cell-click-and-a-different-macro-on-cell-double-click/52506051#52506051", "title": "Run one macro on cell click and a different macro on cell double-click", "body": "<p>You can't change event handler signatures as you please - that's not how events work.</p>\n\n<p>Worksheet events are defined in some <code>WorksheetEvents</code> interface, and the method signatures are what they are and they're set in stone: the event source (i.e. the worksheet) is what's providing the values for the parameters - how will the worksheet know what value to provide for this <code>HideRow</code> argument? It won't, and since the <code>Worksheet</code> module you're in is inheriting its members from the <code>Worksheet</code> class, if you name a procedure <code>Worksheet_BeforeDoubleClick</code> in a worksheet module then because VBA doesn't support <em>method overloading</em> the only way to get that to compile is to have that procedure have the exact* same signature it's defined with.</p>\n\n<p>Make the event handler signatures match the signatures they are expected to have, and the code will compile again.</p>\n\n<p>*almost: the parameter <em>names</em> don't really matter - their type, and their order, does.</p>\n"}], "owner": {"reputation": 65, "user_id": 10158134, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-CRAM41oNNq8/AAAAAAAAAAI/AAAAAAAAAE0/1m4i6sqODpc/photo.jpg?sz=128", "display_name": "Casey", "link": "https://stackoverflow.com/users/10158134/casey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 707, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1537906756, "creation_date": 1537904749, "last_edit_date": 1537905407, "question_id": 52505684, "link": "https://stackoverflow.com/questions/52505684/run-one-macro-on-cell-click-and-a-different-macro-on-cell-double-click", "title": "Run one macro on cell click and a different macro on cell double-click", "body": "<p>I have a database with category headers that contain .Interior.Color and .Font formatting which is applied to selected rows, when the category header cells are clicked.</p>\n\n<p>I want to add the functionality that when a category header cell is double-clicked, all rows in the document that do not match that category will be hidden.</p>\n\n<p>I added the following to my Sheet1 (Code):</p>\n\n<pre><code>Private Sub Worksheet_BeforeDoubleClick(ByVal Target As Range, HideRow As \nBoolean)\n\nIf Not Application.Intersect(Target, Range(\"C1:W1\")) Is Nothing Then\n    LstRow = Cells.Find(What:=\"*\", After:=Range(\"A1\"), lookat:=xlPart, _\n             LookIn:=xlFormulas, SearchOrder:=xlByRows, _ \n             SearchDirection:=xlPrevious, MatchCase:=False).Row   \n    'Finds last row with data\n    Set Dyn_AllEntries = ActiveSheet.Range(\"C5:C\" &amp; LstRow)  'range w/ all data\n    If HiddenRows &lt;&gt; True Then  'Checks to see if the macro was already run\n        For Each cl In Dyn_AllEntries\n            If cl.Offset(0, 11) &lt;&gt; Target Then  'check if category matches\n                cl.EntireRow.Hidden = True   'if not, hide row\n            End If\n        Next cl\n        HiddenRows = True   'set boolean, to verify the macro is active\n    ElseIf HiddenRows = True Then  'check if macro is active\n        For Each cl In Dyn_AllEntries\n            If cl.Offset(0, 11) &lt;&gt; Target And LCase(cl.Offset(0, -2)) &lt;&gt; _ \n            \"true\" Then  'if category not match &amp; row not hidden by other macro\n                cl.EntireRow.Hidden = False   'unhide row\n            End If\n        Next cl\n        HiddenRows = False    'set boolean so I know macro isn't active\n    End If\nEnd If\nEnd Sub\n</code></pre>\n\n<p>Now, the code I wrote for when a cell is selected is giving me an error on compile: </p>\n\n<blockquote>\n  <p>Procedure declaration does not match description of event or procedure having the same name.</p>\n</blockquote>\n\n<p>My \"single-click\" code is named <code>Private Sub Worksheet_SelectionChange(ByVal Target As Range, HideText As Boolean)</code> and my \"double-click\" code is named <code>Private Sub Worksheet_BeforeDoubleClick(ByVal Target As Range, HideRow As Boolean)</code>. </p>\n\n<p>Both are within the Sheet1 (Code) module. My \"single-click\" code has not changed, since it was working before I added the \"double-click\" code.</p>\n\n<p>Is it not possible to run two different macros of the same cell, for different selection actions?</p>\n\n<p>Here's what the sheet looks like, if that helps: <a href=\"https://i.stack.imgur.com/FeTrs.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/FeTrs.png\" alt=\"Sheet1\"></a></p>\n"}, {"tags": ["excel", "ms-access", "vba", "ms-access-2010"], "comments": [{"owner": {"reputation": 5229, "user_id": 5512705, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/OoYN6.png?s=128&g=1", "display_name": "Samuel Hulla", "link": "https://stackoverflow.com/users/5512705/samuel-hulla"}, "edited": false, "score": 0, "creation_date": 1537907702, "post_id": 52505536, "comment_id": 91953021, "body": "Please provide a <a href=\"https://stackoverflow.com/help/mcve\">Minimal, Complete and Verifiable Example</a>, as of now, sadly it is <b>unclear what exactly you&#39;re currently asking</b> / what your code is supposed to accomplish"}, {"owner": {"reputation": 7, "user_id": 6802741, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-2I2wvsqtF_U/AAAAAAAAAAI/AAAAAAAAAAA/e2aEqUT_1No/photo.jpg?sz=128", "display_name": "96jeremy", "link": "https://stackoverflow.com/users/6802741/96jeremy"}, "reply_to_user": {"reputation": 5229, "user_id": 5512705, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/OoYN6.png?s=128&g=1", "display_name": "Samuel Hulla", "link": "https://stackoverflow.com/users/5512705/samuel-hulla"}, "edited": false, "score": 0, "creation_date": 1537918756, "post_id": 52505536, "comment_id": 91956302, "body": "Actually this code works the table wasn&#39;t updating very quickly. All I was asking is how to have a table become populated with more than one excel sheet filled with data."}, {"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "edited": false, "score": 0, "creation_date": 1537968543, "post_id": 52505536, "comment_id": 91977423, "body": "Yes, that was easy to figure out, me think. See answer, please."}], "answers": [{"tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": false, "score": 1, "last_activity_date": 1537951481, "creation_date": 1537951481, "answer_id": 52513546, "question_id": 52505536, "link": "https://stackoverflow.com/questions/52505536/import-new-data-into-existing-table-access-vba/52513546#52513546", "title": "Import new data into existing table access vba", "body": "<p><em>Link</em> the table:</p>\n\n<pre><code>DoCmd.TransferSpreadsheet acLink, \u2026\n</code></pre>\n\n<p>Then create an append query, that uses this linked table as source and writes (appends) your data to your Sample table.</p>\n"}, {"comments": [{"owner": {"reputation": 7, "user_id": 6802741, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-2I2wvsqtF_U/AAAAAAAAAAI/AAAAAAAAAAA/e2aEqUT_1No/photo.jpg?sz=128", "display_name": "96jeremy", "link": "https://stackoverflow.com/users/6802741/96jeremy"}, "edited": false, "score": 0, "creation_date": 1538079798, "post_id": 52514377, "comment_id": 92029032, "body": "Worked perfectly. Thank you."}], "tags": [], "owner": {"reputation": 3448, "user_id": 1049569, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/RHBO1.jpg?s=128&g=1", "display_name": "kiks73", "link": "https://stackoverflow.com/users/1049569/kiks73"}, "is_accepted": true, "score": 0, "last_activity_date": 1537954031, "creation_date": 1537954031, "answer_id": 52514377, "question_id": 52505536, "link": "https://stackoverflow.com/questions/52505536/import-new-data-into-existing-table-access-vba/52514377#52514377", "title": "Import new data into existing table access vba", "body": "<p>If your intent is to append records to the table, you should use your <code>ImportExcelSpreadsheet</code> function to import every time to a new temporary table.</p>\n\n<p>After that, you could append all the content of the temporary table to the destination table, and then remove the temporary table:</p>\n\n<pre><code>' Import to temp table\nImportExcelSpreadsheet(\"filename.xlsx\", \"temp_table\")\n' Append to destination table\nDoCmd.RunSQL \"INSERT INTO destination_table SELECT * FROM temp_table\"\n' Remove temp table\nDoCmd.DeleteObject acTable, \"temp_table\"\n</code></pre>\n"}], "owner": {"reputation": 7, "user_id": 6802741, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-2I2wvsqtF_U/AAAAAAAAAAI/AAAAAAAAAAA/e2aEqUT_1No/photo.jpg?sz=128", "display_name": "96jeremy", "link": "https://stackoverflow.com/users/6802741/96jeremy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5902, "favorite_count": 0, "closed_date": 1537961794, "accepted_answer_id": 52514377, "answer_count": 2, "score": -1, "last_activity_date": 1594628226, "creation_date": 1537904098, "last_edit_date": 1594628226, "question_id": 52505536, "link": "https://stackoverflow.com/questions/52505536/import-new-data-into-existing-table-access-vba", "closed_reason": "Needs details or clarity", "title": "Import new data into existing table access vba", "body": "<p>Currently I can input excel data into new tables, but I would like to append the new data to the table everytime I select a new excel sheet? The code I am using now is shown below. </p>\n\n<pre><code>Option Compare Database\nOption Explicit\n\nPublic Sub ImportExcelSpreadsheet(fileName As String, tableName As String)\nOn Error GoTo BadFormat\n    DoCmd.TransferSpreadsheet acImport, acSpreadsheetTypeExcel12, \"Sample\", \nfileName, True\n\nExit Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "user-defined-functions"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1537903907, "post_id": 52505325, "comment_id": 91951494, "body": "I think you need to look into <code>Application.Volatile</code>."}, {"owner": {"reputation": 61, "user_id": 6579390, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-bOXORKfvS_0/AAAAAAAAAAI/AAAAAAAAAD8/x55l06CbSss/photo.jpg?sz=128", "display_name": "Me_", "link": "https://stackoverflow.com/users/6579390/me"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1537906315, "post_id": 52505325, "comment_id": 91952460, "body": "I looked into it as you suggested. Now the behavior its the same, only that when I click on one of the cells that are using the function, all the others that are using it also fixes themselves."}, {"owner": {"reputation": 2242, "user_id": 9101981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a24c02fa607778b89aa21709e3bd534b?s=128&d=identicon&r=PG&f=1", "display_name": "AJD", "link": "https://stackoverflow.com/users/9101981/ajd"}, "edited": false, "score": 2, "creation_date": 1537906332, "post_id": 52505325, "comment_id": 91952467, "body": "Perhaps change <code>SUM</code> to another name to avoid conflict with the built in function. What data type are you returning?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1537921603, "post_id": 52505325, "comment_id": 91956925, "body": "FYI the error occuring in your UDF is &quot;Unable to get the Interior property of the Range class&quot; and it happens when trying to read the ColorIndex of <code>rColor</code>. I have no idea why that&#39;s getting raised though."}], "answers": [{"tags": [], "owner": {"reputation": 3078, "user_id": 8537807, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2J8ds.png?s=128&g=1", "display_name": "EvR", "link": "https://stackoverflow.com/users/8537807/evr"}, "is_accepted": false, "score": 0, "last_activity_date": 1537946758, "creation_date": 1537946758, "answer_id": 52512196, "question_id": 52505325, "link": "https://stackoverflow.com/questions/52505325/vba-udf-for-excel-goes-value-after-using-hidden-true-on-another-udf/52512196#52512196", "title": "VBA UDF for Excel goes VALUE! after using hidden = true on another UDF", "body": "<p>Set (at least) one of the cells mentioned in your Function to Dirty when clicking on the commandbutton. This will trigger a recalculation.</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n\nColumns(\"B\").ColumnWidth = 30\nWith Me.CommandButton1\n    If .Caption = \"Customer Relationship\" &amp; vbCrLf &amp; \"Management Processes\" Then\n        .Caption = \"Customer Relationship\" &amp; vbCrLf &amp; \"Management Processes \"\n        Rows(\"11:74\").Hidden = False\n    Else\n        .Caption = \"Customer Relationship\" &amp; vbCrLf &amp; \"Management Processes\"\n        Rows(\"11:74\").Hidden = True\n    End If\n    'Worksheets(1).Calculate\nEnd With\nCells(1, 6).Dirty 'For Cell F1\nEnd Sub \n</code></pre>\n"}], "owner": {"reputation": 61, "user_id": 6579390, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-bOXORKfvS_0/AAAAAAAAAAI/AAAAAAAAAD8/x55l06CbSss/photo.jpg?sz=128", "display_name": "Me_", "link": "https://stackoverflow.com/users/6579390/me"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 68, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1537946758, "creation_date": 1537902991, "question_id": 52505325, "link": "https://stackoverflow.com/questions/52505325/vba-udf-for-excel-goes-value-after-using-hidden-true-on-another-udf", "title": "VBA UDF for Excel goes VALUE! after using hidden = true on another UDF", "body": "<p>i've built a Excel worksheet with several formulas for a project. Then, i added a CommandButton for collapse/expand certain cell groups.</p>\n\n<p>CommandButton code is:</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n\nColumns(\"B\").ColumnWidth = 30\nWith Me.CommandButton1\n    If .Caption = \"Customer Relationship\" &amp; vbCrLf &amp; \"Management Processes\" Then\n        .Caption = \"Customer Relationship\" &amp; vbCrLf &amp; \"Management Processes \"\n        Rows(\"11:74\").Hidden = False\n    Else\n        .Caption = \"Customer Relationship\" &amp; vbCrLf &amp; \"Management Processes\"\n        Rows(\"11:74\").Hidden = True\n    End If\n    'Worksheets(1).Calculate\nEnd With\nEnd Sub\n</code></pre>\n\n<p>It works correctly. Now, on the worksheet, i have a cell that uses another UDF to sum cells based on their background color, code for that one is:</p>\n\n<pre><code>Function ColorFunction(rColor As Range, rRange As Range, \nOptional SUM As Boolean)\n    Dim rCell As Range\n    Dim lCol As Long\n    Dim vResult\n    lCol = rColor.Interior.ColorIndex\n\nIf SUM = True Then\n    For Each rCell In rRange\n      If rCell.Interior.ColorIndex = lCol Then\n        vResult = WorksheetFunction.SUM(rCell, vResult)\n      End If\n    Next rCell\nElse\n    For Each rCell In rRange\n      If rCell.Interior.ColorIndex = lCol Then\n        vResult = 1 + vResult\n      End If\n    Next rCell\nEnd If\nColorFunction = vResult\nEnd Function\n</code></pre>\n\n<p>And it works like a charm as well. Here comes the issue: When I press the CommandButton, the cells collapse/expands correctly, but the cell with the sum-by-color function goes VALUE!, then if I click on the formula bar inside the formula and back on the worksheet, it automagically fixes itself without me changing anything.</p>\n\n<p>I tried to:\na- Add a recalculate on the button, no dice.\nb- Discard the function, i tried with other code, it does the same weird thing.\nc- Discard that the formula had gone nuts because it couldn't \"see\" the collapsed cells anymore. It does see them, when i collapse the group, and \"fix\" the formula clicking on it, it sums correctly, even if cells are hidden at that moment.</p>\n\n<p>Any help?\nThanks in advance</p>\n"}, {"tags": ["vba", "excel", "graph", "excel-charts"], "comments": [{"owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 0, "creation_date": 1537903501, "post_id": 52505279, "comment_id": 91951328, "body": "This can be done with VBA: <code>MyChart.FullSeriesCollection(x).Points(y).Format.Fill.ForeCo&zwnj;&#8203;lor.RGB = RGB(255, 0, 0)</code> where <code>x</code> is the series collection and <code>y</code> is the point in the collection you want to change"}], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 10415045, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05b5a438ff7b144d17ba8ebb182552e0?s=128&d=identicon&r=PG&f=1", "display_name": "H.Cani", "link": "https://stackoverflow.com/users/10415045/h-cani"}, "edited": false, "score": 0, "creation_date": 1539010765, "post_id": 52508907, "comment_id": 92336575, "body": "Thank you Dy.Lee, I ran the code you provided and keep getting a &quot;Compile error: Invalid outside procedure&quot;, so I&#39;m not clear what I need to edit."}, {"owner": {"reputation": 31, "user_id": 10415045, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05b5a438ff7b144d17ba8ebb182552e0?s=128&d=identicon&r=PG&f=1", "display_name": "H.Cani", "link": "https://stackoverflow.com/users/10415045/h-cani"}, "edited": false, "score": 0, "creation_date": 1539024867, "post_id": 52508907, "comment_id": 92343142, "body": "My apologies, I modified the code that resulted in that error. I corrected it now, so thank you for that."}, {"owner": {"reputation": 31, "user_id": 10415045, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05b5a438ff7b144d17ba8ebb182552e0?s=128&d=identicon&r=PG&f=1", "display_name": "H.Cani", "link": "https://stackoverflow.com/users/10415045/h-cani"}, "edited": false, "score": 0, "creation_date": 1539024878, "post_id": 52508907, "comment_id": 92343147, "body": "One last question: Within the code, how do I specify that I want to color change to occur if the marker is below a threshold? For example, the chart is based on the following results: 99.6%, 99.9%, 99.5%, 99.5%, 99.9% and 99.7%. If the results are above 99.0%, the dots (markers) stay green. If they fall below 99.0% (98%, for example), the dot (marker) should turn red. How do I make this modification?"}], "tags": [], "owner": {"reputation": 7206, "user_id": 8107092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dce232725da0108d5e43f3eebcaddd91?s=128&d=identicon&r=PG&f=1", "display_name": "Dy.Lee", "link": "https://stackoverflow.com/users/8107092/dy-lee"}, "is_accepted": false, "score": 1, "last_activity_date": 1539224748, "last_edit_date": 1539224748, "creation_date": 1537927305, "answer_id": 52508907, "question_id": 52505279, "link": "https://stackoverflow.com/questions/52505279/how-can-i-vary-the-marker-colors-in-an-excel-graph/52508907#52508907", "title": "How can I vary the marker colors in an Excel graph?", "body": "<p>test bellow.</p>\n\n<pre><code>Sub setMarkerColor()\n    Dim myCht As ChartObject\n    Dim n  As Long\n    Dim adr As String\n    Dim p As Double\n\n    Application.ScreenUpdating = False\n    For Each myCht In ActiveSheet.ChartObjects\n        With myCht.Chart\n            adr = .SeriesCollection(1).Formula '&lt;~~ First grapth, if 2nd change to .SeriesCollection(2).Formula\n            adr = Split(adr, \",\")(2)\n            For n = 1 To Range(adr).Cells.Count\n               p = Range(adr)(n)\n               If p &lt; 15 Then '&lt;~~ set value 15\n                   '.SeriesCollection(1).Points(n).HasDataLabel = True\n                   With .SeriesCollection(1).Points(n) '&lt;~~ First grapth, if 2nd change to .SeriesCollection(2).Points(n)\n                    .MarkerForegroundColor = RGB(0, 255, 0)\n                    .MarkerBackgroundColor = RGB(255, 0, 0)\n                    End With\n               End If\n            Next n\n        End With\n    Next myCht\n    Application.ScreenUpdating = True\n End Sub\n</code></pre>\n\n<p>edition</p>\n\n<pre><code>Sub setMarkerColor()\n    Dim myCht As ChartObject\n    Dim n  As Long\n    Dim adr As String\n    Dim p As Double\n    Dim myVal As Long\n    Application.ScreenUpdating = False\n    For Each myCht In ActiveSheet.ChartObjects\n        With myCht.Chart\n            adr = .SeriesCollection(1).Formula '&lt;~~ First grapth, if 2nd change to .SeriesCollection(2).Formula\n            adr = Split(adr, \",\")(2)\n            For n = 1 To Range(adr).Cells.Count\n               p = Range(adr)(n)\n               If p &gt;= 0.99 Then '&lt;~~ set value 0.99\n                    myVal = RGB(0, 255, 0)\n                Else\n                    myVal = RGB(255, 0, 0)\n                End If\n                   '.SeriesCollection(1).Points(n).HasDataLabel = True\n                   With .SeriesCollection(1).Points(n) '&lt;~~ First grapth, if 2nd change to .SeriesCollection(2).Points(n)\n                    .MarkerForegroundColor = RGB(0, 255, 0)\n                    .MarkerBackgroundColor = myVal\n                    End With\n\n            Next n\n        End With\n    Next myCht\n    Application.ScreenUpdating = True\n End Sub\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 10415045, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05b5a438ff7b144d17ba8ebb182552e0?s=128&d=identicon&r=PG&f=1", "display_name": "H.Cani", "link": "https://stackoverflow.com/users/10415045/h-cani"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 104, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1539224748, "creation_date": 1537902786, "last_edit_date": 1537908019, "question_id": 52505279, "link": "https://stackoverflow.com/questions/52505279/how-can-i-vary-the-marker-colors-in-an-excel-graph", "title": "How can I vary the marker colors in an Excel graph?", "body": "<p>I have an Excel line graph with markers.</p>\n\n<p><a href=\"https://i.stack.imgur.com/VGwPj.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/VGwPj.png\" alt=\"enter image description here\"></a></p>\n\n<p><strong>I need to change the color of the marker if it is below a threshold.</strong><br>\nFor example, the graph below is monthly results where the markers are above a threshold. If the results are below a certain point, I need the marker to change color (2nd graph).</p>\n\n<p><a href=\"https://i.stack.imgur.com/4kkvt.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/4kkvt.png\" alt=\"enter image description here\"></a></p>\n\n<p>I know how to change the marker colors manually. Can this be done automatically?\nThank you, in advance, for your help.</p>\n"}, {"tags": ["excel", "vba", "vlookup"], "comments": [{"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 2, "creation_date": 1537901007, "post_id": 52504811, "comment_id": 91950153, "body": "Your column index needs to be 2. You are searching in columns <code>C:D</code>, there is no 6th index in this range"}, {"owner": {"reputation": 3, "user_id": 10414863, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ad9e6dbbb0da084dbaacc63d05d7e4b?s=128&d=identicon&r=PG&f=1", "display_name": "SVB", "link": "https://stackoverflow.com/users/10414863/svb"}, "reply_to_user": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1537901276, "post_id": 52504811, "comment_id": 91950268, "body": "So if my necessary information is 6 columns away, I should change the search from columns <code>C:H</code> ? @urdearboy"}, {"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1537901561, "post_id": 52504811, "comment_id": 91950396, "body": "Yes. The third argument should always be between 2 and the column span of your search range. So, with <code>C:D</code>, the only valid value for the 3rd argument is 2 since 2 is also your column span"}, {"owner": {"reputation": 3, "user_id": 10414863, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ad9e6dbbb0da084dbaacc63d05d7e4b?s=128&d=identicon&r=PG&f=1", "display_name": "SVB", "link": "https://stackoverflow.com/users/10414863/svb"}, "reply_to_user": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1537901718, "post_id": 52504811, "comment_id": 91950469, "body": "Thanks @urdearboy your solution worked! I guess I fundamentally misunderstood that the column_index had to be included in the table_array. I thought they were unrelated. However, this does now explain why the table_array must be at least 2 columns wide"}], "answers": [{"tags": [], "owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "is_accepted": true, "score": 2, "last_activity_date": 1537902089, "last_edit_date": 1537902089, "creation_date": 1537901267, "answer_id": 52504926, "question_id": 52504811, "link": "https://stackoverflow.com/questions/52504811/vba-vlookup-not-finding-values-that-exist/52504926#52504926", "title": "VBA Vlookup not finding values that exist", "body": "<p>If you are trying to return the 6th value from <code>Column C</code> your range needs to be updated to `PAsheet.Range(\"C2:H2000\")</p>\n\n<pre><code>cell.Value = WorksheetFunction.VLookup(cell.Offset(, -6), PAsheet.Range(\"C2:H2000\"), 6, False)\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 10414863, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ad9e6dbbb0da084dbaacc63d05d7e4b?s=128&d=identicon&r=PG&f=1", "display_name": "SVB", "link": "https://stackoverflow.com/users/10414863/svb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 727, "favorite_count": 0, "accepted_answer_id": 52504926, "answer_count": 1, "score": 0, "last_activity_date": 1537902089, "creation_date": 1537900879, "question_id": 52504811, "link": "https://stackoverflow.com/questions/52504811/vba-vlookup-not-finding-values-that-exist", "title": "VBA Vlookup not finding values that exist", "body": "<p>I am working with two different Worksheets in one workbook. My task is to look up the model# of a product from Sheet1, find that same model# in Sheet2, and get the cost of that product, which is located a few columns away.</p>\n\n<p>So naturally, I tried to use Vlookup, because that function is enough for this query.</p>\n\n<p>I will post my code below, and then explain the problems I am facing. I am new to VBA and have searched many many different Stack posts, and tried the various solutions, to no avail.</p>\n\n<hr>\n\n<hr>\n\n<hr>\n\n<pre><code>Private Sub CommandButton1_Click()\n\nDim tbdCell As Range\nDim model As Range\nDim cell As Range\nDim PAsheet As Worksheet\nDim DB As Worksheet\nDim target As Variant\nSet DB = Worksheets(\"Database\")\nSet PAsheet = Sheets(\"Pricing Agreement\")\n\n\nSet tbdCell = Range(\"N2:N4700\")\nOn Error GoTo ErrHandler:\nFor Each cell In tbdCell\n    Set model = cell.Offset(0, -6)\n    cell = WorksheetFunction.VLookup((CStr(model)), PAsheet.Range(CStr(\"C2:D2000\")), 6, True)\n    Next cell\n\n    Exit Sub\n\n\nErrHandler:\n    Select Case Err.Number\n        Case 0\n\n        Case 1004\n            cell = \"missing\"\n            Resume Next\n        Case Else\n            MsgBox Err.Number &amp; vbNewLine &amp; Err.Description\n            Exit Sub\n\n    End Select\n\nEnd Sub\n</code></pre>\n\n<hr>\n\n<hr>\n\n<hr>\n\n<p>So upon debugging and testing, most things work until we get to the line where I use the Vlookup function. I invariably get error 1004, even though the data exists in the other spreadsheet. So the cells that I need to fill will always fill with \"missing\" as posted above in the Error Handling Code.</p>\n\n<p>I tried using the Application version of the function. I tried using different variables and declaring them as Variant type. I even tried making the table_array range just one row with 2 column coverage, in an attempt to force a match for one particular model #. So far, to avoid a type mismatch, I cast 'model'(the model#) into a String, and I also cast the search range in PAsheet to String. The final thing I tried was to not search for an exact match(last argument was set to true)</p>\n\n<p>So in anticipation of future questions about the data that the Vlookup is based on, I will include necessary information about how both sheets are formatted.</p>\n\n<p><strong>Info that you may need:</strong></p>\n\n<p>We start in column N, where the prices are missing in Sheet1(Database).</p>\n\n<p>I set model to the value in the same row, 6 columns to the left(Column H). </p>\n\n<p>Testing with MsgBox proved this to work for me, and on debug, the model variable displays the correct info, so this isn't the issue.</p>\n\n<p>In PAsheet, the model #s are in column C. Originally I made the search table from C2:C2000 or so, but I was led to believe that you need at least a two column table for Vlookup to work, so I changed C2000 to D2000. Now the search range is a two column table. </p>\n\n<p>In PAsheet, the cost of the product is in Column H, which is 5 away from column C. I need this value, so I put 6 in the column_index  argument. It was 5 before, because I thought that you didn't count the first column, but I fixed  that.</p>\n\n<p>Finally I mostly tested with \"False\" as the last argument, but either way it doesn't work.</p>\n\n<hr>\n\n<p>So after trying more than two dozen variations and strategies, I still get \"missing\" in the cells that I need to fill.</p>\n\n<p>So, what am I doing wrong here? Thanks in advance.</p>\n"}, {"tags": ["excel", "vba", "function", "excel-formula", "user-defined-functions"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 4, "creation_date": 1537900379, "post_id": 52504599, "comment_id": 91949853, "body": "Use a helper column in which you put the MIN formula for each row, then use SUMPRODUCT on that column and column H."}, {"owner": {"reputation": 5229, "user_id": 5512705, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/OoYN6.png?s=128&g=1", "display_name": "Samuel Hulla", "link": "https://stackoverflow.com/users/5512705/samuel-hulla"}, "edited": false, "score": 0, "creation_date": 1537908275, "post_id": 52504599, "comment_id": 91953251, "body": "Hard to tell without a <a href=\"https://stackoverflow.com/help/mcve\">minimal, complete and verifiable example</a> but perhaps you coud <a href=\"https://www.techonthenet.com/excel/formulas/transpose.php\" rel=\"nofollow noreferrer\"><code>transpose</code></a> the data to treat it like a column?"}], "owner": {"reputation": 25, "user_id": 10043951, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9fb4b2b4f764d1bedd2a4d286a39787a?s=128&d=identicon&r=PG&f=1", "display_name": "Juan Pablo Alfonso Santos", "link": "https://stackoverflow.com/users/10043951/juan-pablo-alfonso-santos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 73, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1537974368, "creation_date": 1537899934, "last_edit_date": 1537974368, "question_id": 52504599, "link": "https://stackoverflow.com/questions/52504599/sumproduct-function-of-conditionally-formatted-cells", "title": "SUMPRODUCT function of conditionally formatted cells", "body": "<p>I have a list of prices (which vary) starting on M13 and every 3 columns to the right until CJ13, I wanted to highlight the lowest price by row with conditional formatting so I implemented the formula: </p>\n\n<p><code>=AND(COUNT($M13:$CJ13)&lt;&gt;0,M13=MIN($M13:$CJ13))</code></p>\n\n<p>which worked perfectly.</p>\n\n<p>Now I want to get the result of SUMPRODUCT by column of the highlighted cells (M, P, etc) with the corresponding value  in column H (column H will never move). So it would be: the highlighted value multiplied by the value on the same row on column H, plus the next highlihted value multiplied by its corresponding in column H, etc. </p>\n\n<p>I would appreciate any help, UDF or function or any idea on how to do it. \nI believe the reason it has been difficut lies in the conditional formatting since a color based criteria will read the color behind the CF (background color which is blue) and not the CF color (green Colorindex=43).</p>\n"}, {"tags": ["excel", "vba", "jscript", "ecmascript-3"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 1, "creation_date": 1537899256, "post_id": 52504386, "comment_id": 91949286, "body": "Well..I am still gonna say it, why can&#39;t this be done with a standard xmlhttp request please?"}, {"owner": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "edited": false, "score": 1, "creation_date": 1537900482, "post_id": 52504386, "comment_id": 91949893, "body": "<code>d.write(x.ResponseText);</code>"}, {"owner": {"reputation": 142, "user_id": 4908790, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/d1cfd0fe20c8a330a906c9f03edb5f81?s=128&d=identicon&r=PG&f=1", "display_name": "JasperD", "link": "https://stackoverflow.com/users/4908790/jasperd"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 1, "creation_date": 1537900723, "post_id": 52504386, "comment_id": 91950011, "body": "@QHarr jscript is quicker in parsing, xmlhttp in jscript has an async onreadystatechange option, string modification is easier in jscript - AND I just want to know how it&#39;s done :)"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1537900813, "post_id": 52504386, "comment_id": 91950069, "body": "Fair play then  :-)"}, {"owner": {"reputation": 142, "user_id": 4908790, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/d1cfd0fe20c8a330a906c9f03edb5f81?s=128&d=identicon&r=PG&f=1", "display_name": "JasperD", "link": "https://stackoverflow.com/users/4908790/jasperd"}, "reply_to_user": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "edited": false, "score": 0, "creation_date": 1537902209, "post_id": 52504386, "comment_id": 91950736, "body": "@omegastripes - that works for stackoverflow.com, but not for some more complex sites, that DO render in a CreateObject(&quot;HTMLFile&quot;) in VBA. Anything I can do about that or &#39;tough luck&#39;?"}, {"owner": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "edited": false, "score": 0, "creation_date": 1537907977, "post_id": 52504386, "comment_id": 91953135, "body": "Could you please provide an example of such more complex site?"}], "owner": {"reputation": 142, "user_id": 4908790, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/d1cfd0fe20c8a330a906c9f03edb5f81?s=128&d=identicon&r=PG&f=1", "display_name": "JasperD", "link": "https://stackoverflow.com/users/4908790/jasperd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 135, "favorite_count": 1, "answer_count": 0, "score": 0, "last_activity_date": 1537899039, "creation_date": 1537899039, "question_id": 52504386, "link": "https://stackoverflow.com/questions/52504386/parse-xmlhttp-responsetext-html-in-jscript-es3-in-vba", "title": "Parse XMLHTTP responseText (HTML) in Jscript ES3 in VBA", "body": "<p>for reasons I won't bore you with, I am using a scriptcontrol JScript object in VBA to retrieve a webpage.\nI do this as follows (in 32bit Excel, for 64bit I use a MSHTA work-around).</p>\n\n<pre><code>Sub Test()\nDim S as Object\n    Set S = CreateObject(\"ScriptControl\")\n        S.Language = \"JScript\"\n\n        S.Eval(\"var x = new ActiveXObject('MSXML2.XMLHTTP');\")\n        S.Eval(\"x.open('GET', 'https://stackoverflow.com/', false);\")\n        S.Eval(\"x.Send\")\nEnd Sub\n</code></pre>\n\n<p>Now this works fine and the returning response is in x.ResponseText, but how can I parse this in a HTML Document from which I can get specific document elements?\nJScript = ES3 and doesn't have DOMParser, jquery or the standard document.whatever. </p>\n\n<p>I added John Resig's pure javascript HTML parser from <a href=\"https://johnresig.com/blog/pure-javascript-html-parser/\" rel=\"nofollow noreferrer\">https://johnresig.com/blog/pure-javascript-html-parser/</a> and while I can add the code (S.Addcode), it errors on me when using HTMLToDom;</p>\n\n<pre><code>S.AddCode JohnsCode\nS.Eval (\"var d = new ActiveXObject('HTMLFile');\")\nS.Eval (\"HTMLToDom(x.ResponseText, d);\") &lt;-- this errors.\n</code></pre>\n\n<p>Am I missing something obvious here or is parsing a HTML response into a HTML Document where I can retrieve specific elements not possible in JScript/ES3?</p>\n\n<p>Thanks for your help!</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 6, "creation_date": 1537898678, "post_id": 52504282, "comment_id": 91949021, "body": "The value is not being found so it is returning nothing."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 2, "creation_date": 1537899138, "post_id": 52504282, "comment_id": 91949223, "body": "Avoid making member calls on an object reference that has any chance of being <code>Nothing</code> at run-time. <code>Range.Find</code> returns <code>Nothing</code> when it doesn&#39;t find what it&#39;s looking for, so the single easiest way to avoid this error with <code>Range.Find</code>, is to capture the result in a <code>Range</code> object variable, then verify whether it&#39;s <code>Nothing</code>, and <i>then</i> make member calls against it <i>if it isn&#39;t</i>."}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1537899150, "post_id": 52504282, "comment_id": 91949229, "body": "to confirm, you want to search ROW #2 (not the 2nd column) correct?"}], "answers": [{"comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1537899267, "post_id": 52504413, "comment_id": 91949290, "body": "That ninja-edit is what earned you my upvote. Thank you for adding an explanation. You know how much I like &quot;code dump&quot; answers ;-)"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1537899320, "post_id": 52504413, "comment_id": 91949313, "body": "@MathieuGuindon - noone likes them. :)"}, {"owner": {"reputation": 107, "user_id": 9410048, "user_type": "registered", "profile_image": "https://graph.facebook.com/990260100984145/picture?type=large", "display_name": "Stefano", "link": "https://stackoverflow.com/users/9410048/stefano"}, "edited": false, "score": 0, "creation_date": 1537945442, "post_id": 52504413, "comment_id": 91963374, "body": "@Vityata thanks but it does not solve the issue. Consider that I am managing dates. My code works when using texts or numbers but not with dates."}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 107, "user_id": 9410048, "user_type": "registered", "profile_image": "https://graph.facebook.com/990260100984145/picture?type=large", "display_name": "Stefano", "link": "https://stackoverflow.com/users/9410048/stefano"}, "edited": false, "score": 0, "creation_date": 1537946749, "post_id": 52504413, "comment_id": 91964063, "body": "@Stefano - dates are a bit more difficult. See the edit. There you should always put <code>xlWhole</code> as the LookAt argument - <a href=\"https://stackoverflow.com/questions/48932196/range-find-not-making-a-difference-between-january-and-november-february-and-de\" title=\"range find not making a difference between january and november february and de\">stackoverflow.com/questions/48932196/&hellip;</a>"}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 5, "last_activity_date": 1537946919, "last_edit_date": 1537946919, "creation_date": 1537899139, "answer_id": 52504413, "question_id": 52504282, "link": "https://stackoverflow.com/questions/52504282/excel-vba-how-to-solve-run-time-error-91/52504413#52504413", "title": "Excel VBA: How to solve Run-time error &#39;91&#39;?", "body": "<p>Assign the <code>result</code> to a Range and use the <code>.Find()</code> to set the range. \nIf nothing is found, then the <code>Range()</code> would be <code>Nothing</code>:</p>\n\n<pre><code>Sub TestMe()\n\n    Dim result As Range\n\n    With Worksheets(1)\n        Set result = .Range(\"2:2\").Find(\"Something\", LookAt:=xlWhole)\n    End With\n\n    If Not result Is Nothing Then\n        Debug.Print result.Address\n    Else\n        Debug.Print \"Something is not on the second row!\"\n    End If\n\nEnd Sub\n</code></pre>\n\n<p>The <code>LookAt:=xlWhole</code> argument is a must, if one is working with dates:</p>\n\n<ul>\n<li><p><a href=\"https://stackoverflow.com/questions/48932196/range-find-not-making-a-difference-between-january-and-november-february-and-de\">Range.Find not making a difference between January and November (February and December) in VBA Excel</a></p></li>\n<li><p><a href=\"http://%20https://docs.microsoft.com/en-us/office/vba/api/Excel.Range.Find\" rel=\"nofollow noreferrer\">Excel.Range.Find Documentation</a></p></li>\n</ul>\n"}], "owner": {"reputation": 107, "user_id": 9410048, "user_type": "registered", "profile_image": "https://graph.facebook.com/990260100984145/picture?type=large", "display_name": "Stefano", "link": "https://stackoverflow.com/users/9410048/stefano"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6918, "favorite_count": 0, "closed_date": 1537899389, "answer_count": 1, "score": 1, "last_activity_date": 1537946919, "creation_date": 1537898580, "last_edit_date": 1537945380, "question_id": 52504282, "link": "https://stackoverflow.com/questions/52504282/excel-vba-how-to-solve-run-time-error-91", "closed_reason": "Duplicate", "title": "Excel VBA: How to solve Run-time error &#39;91&#39;?", "body": "<p>I get the error:</p>\n\n<p><code>Run-time error '91': Object variable or With block variable not set</code> </p>\n\n<p>when I try to execute this code:</p>\n\n<pre><code>MsgBox Worksheets(\"Sheet2\").Range(\"2:2\").Find(Worksheets(\"Sheet1\").Range(\"E5\").Value, , , xlWhole)\n</code></pre>\n\n<p>Why? What is wrong with this row?</p>\n\n<p><strong>EDIT</strong></p>\n\n<p>The code works if I am managing text or numbers. But I have that issue what I have <strong>dates</strong> on <code>Worksheets(\"Sheet1\").Range(\"E5\")</code> and <code>Worksheets(\"Sheet2\").Range(\"2:2\")</code>.</p>\n"}, {"tags": ["excel", "vba", "copy"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 4, "creation_date": 1537898111, "post_id": 52504147, "comment_id": 91948814, "body": "A <code>Workbook</code> doesn&#39;t have a <code>Range</code> property, but a <code>Worksheet</code> does - <code>wsFrom</code> instead of <code>wbFrom</code>. Same goes for <code>wsTarget</code> instead of <code>wbTarget</code>."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1537898864, "post_id": 52504147, "comment_id": 91949095, "body": "That linked code is wrong."}, {"owner": {"reputation": 13, "user_id": 9834687, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Maria Fakhry", "link": "https://stackoverflow.com/users/9834687/maria-fakhry"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1537898990, "post_id": 52504147, "comment_id": 91949159, "body": "It worked thank you"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1537899639, "post_id": 52504147, "comment_id": 91949478, "body": "And this makes an extremely good argument <i>against</i> <a href=\"https://www.joelonsoftware.com/2005/05/11/making-wrong-code-look-wrong/\" rel=\"nofollow noreferrer\">Systems Hungarian</a> prefixes such as <code>wb</code> and <code>ws</code>, which obviously failed their purpose here. cc @BigBen"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1537899763, "post_id": 52504147, "comment_id": 91949551, "body": "@MathieuGuindon completely agree."}], "owner": {"reputation": 13, "user_id": 9834687, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Maria Fakhry", "link": "https://stackoverflow.com/users/9834687/maria-fakhry"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 493, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1537898064, "creation_date": 1537898064, "question_id": 52504147, "link": "https://stackoverflow.com/questions/52504147/debug-error-438-excel-vba-copy-from-one-workbook-to-another", "title": "Debug Error 438 Excel VBA copy from one workbook to another", "body": "<p>When I run this code, i get the following error\"Run-time error'438' : Object doesn't support this property or method\" on this line of the code:    </p>\n\n<p>'copy the range from source book</p>\n\n<p>wbFrom.Range(\"A:A\").Copy</p>\n\n<pre><code>Sub CopyOpenItems()\n'\n' CopyOpenItems Macro\n' Copy open items to sheet.\n'\n' Keyboard Shortcut: Ctrl+Shift+O\n'\nDim wbTarget As Workbook 'workbook where the data is to be pasted\nDim wbFrom As Workbook 'workbook from where the data is to be copied\nDim wsFrom As Worksheet\nDim wsTarget As Worksheet\n\n'set to the current active workbook (the source book)\nSet wbTarget = ActiveWorkbook\nSet wsTarget = wbTarget.Worksheets(1)\n\n\n'open a workbook that has same name as the sheet name\nSet wbFrom = Workbooks.Open(\"......\")\nSet wsFrom = wbFrom.Worksheets(1)\n\n\n'activate the source book\nwbFrom.Activate\n\n'clear any thing on clipboard to maximize available memory\nApplication.CutCopyMode = False\n\n'copy the range from source book\nwbFrom.Range(\"A:A\").Copy\n\n'paste the data on the target book\nwbTarget.Range(\"A:A\").PasteSpecial\n\nwbFrom.Range(\"C:C\").Copy\nwbTarget.Range(\"C:C\").PasteSpecial\n\nwbFrom.Range(\"D:D\").Copy\nwbTarget.Range(\"D:D\").PasteSpecial\n\nwbFrom.Range(\"F:F\").Copy\nwbTarget.Range(\"F:F\").PasteSpecial\n\nwbFrom.Range(\"J:J\").Copy\nwbTarget.Range(\"J:J\").PasteSpecial\n\nwbFrom.Range(\"K:K\").Copy\nwbTarget.Range(\"K:K\").PasteSpecial\n\n'clear any thing on clipboard to maximize available memory\nApplication.CutCopyMode = False\n\n'save the target book\nwbTarget.Save\nwbFrom.Save\n\n\n'close the workbook\nwbFrom.Close\n\n'activate the source book again\nwbFrom.Activate\n\n\n'clear memory\nSet wbTarget = Nothing\nSet wbFrom = Nothing\n\nEnd Sub\n</code></pre>\n\n<p>I can't figure out what's wrong with it. The point of the code i guess is pretty straightforward, copy selected columns from one workbook and paste it into another.\nAlso, this code is a slightly modified version of the one that could be find on this link\n<a href=\"https://ccm.net/faq/24666-copy-data-to-another-workbook-in-excel\" rel=\"nofollow noreferrer\">https://ccm.net/faq/24666-copy-data-to-another-workbook-in-excel</a></p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 1, "creation_date": 1537897404, "post_id": 52503729, "comment_id": 91948475, "body": "Remove <code>On Error Resume Next</code>. It&#39;s a very powerful way of sweeping all the errors under the carpet and hiding things from you. There are <i>very</i> few cases where it&#39;s appropriate to wrap 1 or 2 lines of code with it, and this ain&#39;t one of &#39;em. Comment out <code>Application.ScreenUpdating=False</code> until you&#39;ve got your code working exactly as you want it. That&#39;s also hiding things from you."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 10414650, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9fd1326b3bc820e6f7d57a1294261e20?s=128&d=identicon&r=PG&f=1", "display_name": "stackoverflown", "link": "https://stackoverflow.com/users/10414650/stackoverflown"}, "edited": false, "score": 0, "creation_date": 1537907403, "post_id": 52504039, "comment_id": 91952895, "body": "Thanks Valon, the first solution is the one I was looking for!"}], "tags": [], "owner": {"reputation": 1156, "user_id": 10315836, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hZjRU.png?s=128&g=1", "display_name": "Valon Miller", "link": "https://stackoverflow.com/users/10315836/valon-miller"}, "is_accepted": true, "score": 0, "last_activity_date": 1537897596, "creation_date": 1537897596, "answer_id": 52504039, "question_id": 52503729, "link": "https://stackoverflow.com/questions/52503729/copy-formulas-from-one-column-to-variable-number-of-columns/52504039#52504039", "title": "Copy formulas from one column to variable number of columns", "body": "<p>It's not clear what you are asking to do, are you trying to copy the formulas or the values? i.e. do you want to preserve the formulas/formatting, or do you only want to keep the actual values that had been calculated in Column E - I think you want the formulas. But here's both solutions:</p>\n\n<blockquote>\n  <p>I then want to copy the forumlas from column E to the newly inserted columns.</p>\n</blockquote>\n\n<pre><code>For i = 1 To y - 3\n\n    ThisWorkbook.Sheets(\"Input\").Range(\"E:E\").Copy\n    ThisWorkbook.Sheets(\"Input\").Columns(xNo).Insert Shift:=xlRight\n\n    lastColumn = ActiveSheet.Cells(10, Columns.Count).End(xlToLeft).Column - 3\n\n    'Move to next column\n    xNo = xNo + 1\nNext i\n</code></pre>\n\n<blockquote>\n  <p>What is the best way to copy the values from column E to the newly created columns?</p>\n</blockquote>\n\n<pre><code>For i = 1 To y - 3\n\n    ThisWorkbook.Sheets(\"Input\").Columns(xNo).Insert Shift:=xlRight\n\n    ThisWorkbook.Sheets(\"Input\").Range(\"E:E\").Copy\n    ThisWorkbook.Sheets(\"Input\").Columns(xNo).PasteSpecial xlPasteValues\n\n    lastColumn = ActiveSheet.Cells(10, Columns.Count).End(xlToLeft).Column - 3\n\n    'Move to next column\n    xNo = xNo + 1\nNext i\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 10414650, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9fd1326b3bc820e6f7d57a1294261e20?s=128&d=identicon&r=PG&f=1", "display_name": "stackoverflown", "link": "https://stackoverflow.com/users/10414650/stackoverflown"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 0, "accepted_answer_id": 52504039, "answer_count": 1, "score": 0, "last_activity_date": 1537897596, "creation_date": 1537896372, "question_id": 52503729, "link": "https://stackoverflow.com/questions/52503729/copy-formulas-from-one-column-to-variable-number-of-columns", "title": "Copy formulas from one column to variable number of columns", "body": "<p>I've written a Macro which inserts a variable number of columns to the left of column F, based on an inputted number into a userform, less 3.  i.e. if user punches in 6, the macro will add 3 columns to the left of column F (the original columns F, G, and H contain other data).</p>\n\n<pre><code>'Code for \"done\" button in months prompt\nPublic Sub Done_Button_Click()\n\nDim ColumnNum%\nDim xNo As Variant\n\nApplication.ScreenUpdating = False\n\nFor Each Worksheet In Worksheets\n    Worksheet.Unprotect\nNext Worksheet\n\n\n'refernces column \"F\"\nxNo = 6\n'References user input from text box (number of months)\ny = Add_Columns.Months_Input.Value\n\nFor i = 1 To y - 3\n\n    ThisWorkbook.Sheets(\"Input\").Columns(xNo).Insert Shift:=xlRight\n\n    lastColumn = ActiveSheet.Cells(10, Columns.Count).End(xlToLeft).Column  - 3\n\n'Move to next column\n    xNo = xNo + 1\nNext i\n\n'Hide prompt\nUnload Me\n\nApplication.ScreenUpdating = False\n\n'Protect All Sheets\n\nOn Error Resume Next\nWorksheets(\"DATA\").Protect\nWorksheets(\"Input\").Protect\nWorksheets(\"Output\").Protect\nWorksheets(\"Chart\").Protect\n\n'Jump Back to Input Sheet\nSheets(\"Input\").Select\nRange(\"A1\").Select\n\n'Save Workbook\nActiveWorkbook.Save\n\nApplication.ScreenUpdating = True\n\nEnd Sub\n'User input for number of months\nPublic Sub Months_Input_Change()\nDim y As String\ny = Add_Columns.Months_Input.Value\nEnd Sub\n\n'Tells prompt to reference cell B5 for number of months\nPrivate Sub Userform_Activate()\nCMiC_Months.Value = Format(ActiveSheet.Range(\"B5\").Value, \"0.0\")\nWith Add_Columns\n    .Top = Application.Top + 350\n    .Left = Application.Left + 350\nEnd With\nEnd Sub\n</code></pre>\n\n<p>I then want to copy the forumlas from column E to the newly inserted columns.  However, no matter how I try to program the copy+paste function, it seems to either copy forumlas from column A and B, or copy over forumlas to the right of the newly inserted range.</p>\n\n<p>What is the best way to copy the values from column E to the newly created columns?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 1, "creation_date": 1537895197, "post_id": 52503412, "comment_id": 91947408, "body": "Your code won&#39;t compile because you&#39;re missing a <code>With</code> block."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1537895251, "post_id": 52503412, "comment_id": 91947426, "body": "Something like <code>With ActiveSheet</code> (or other sheet) above your <code>For ColNum</code> statement, and then make sure there&#39;s and <code>End With</code> after the <code>Next</code>."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1537895287, "post_id": 52503412, "comment_id": 91947447, "body": "So, whatever you did for this to &quot;work&quot; with Copy, you did not do the same thing here, because the code you show above will not work with Copy (or anything) :)"}], "answers": [{"tags": [], "owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "is_accepted": false, "score": 4, "last_activity_date": 1537895444, "creation_date": 1537895444, "answer_id": 52503503, "question_id": 52503412, "link": "https://stackoverflow.com/questions/52503412/compile-error-invalid-or-unqualified-reference-when-transferring-values-from-sh/52503503#52503503", "title": "Compile Error: Invalid or Unqualified Reference when transferring values from sheet 2 to sheet 1", "body": "<p><a href=\"https://i.stack.imgur.com/SSPQb.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/SSPQb.png\" alt=\"enter image description here\"></a></p>\n\n<p>You're getting a compile error. You need to qualify your <code>.Cells</code> either explicitly or in a <code>With</code> block, like:</p>\n\n<pre><code>With ActiveSheet ' ## Modify as needed\n\n    ' adds one to row num so that insertion happens at right place\n    For ColNum = 2 To 9\n            Sheets(1).Range(.Cells(RowNum1, ColNum), .Cells(RowNum1 + 5, ColNum)).Value = _\n    Sheets(2).Range(.Cells(RowStartData1, 4), .Cells(RowStartData1 + 5, 4)).Value\n\n        RowStartData1 = RowStartData1 + 6\n\n    Next ColNum\n\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 10414586, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-6wzsMowvX_Y/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DUjRAnUeqnBJYZb3EmSbCiGhjtFVg/mo/photo.jpg?sz=128", "display_name": "David Aitchison", "link": "https://stackoverflow.com/users/10414586/david-aitchison"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 652, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1537895465, "creation_date": 1537895079, "last_edit_date": 1537895465, "question_id": 52503412, "link": "https://stackoverflow.com/questions/52503412/compile-error-invalid-or-unqualified-reference-when-transferring-values-from-sh", "title": "Compile Error: Invalid or Unqualified Reference when transferring values from sheet 2 to sheet 1", "body": "<p>the ranges in my data should be correct, as they worked with copy, however I'm just trying to get the values in the specified ranges in <code>sheets(2)</code> to <code>sheets(1)</code></p>\n\n<pre><code>Private Sub insertData(RowStartData1 As Long, RowNum1 As Long)\n' RowStartData1 is where the row the data starts on.\n' RowNum1 is the row num - 1 where data should be inserted\n\nDim ColNum As Integer\n\nRowNum1 = RowNum1 + 1\n' adds one to row num so that insertion happens at right place\nFor ColNum = 2 To 9\n        Sheets(1).Range(.Cells(RowNum1, ColNum), .Cells(RowNum1 + 5, ColNum)).Value = \nSheets(2).Range(.Cells(RowStartData1, 4), .Cells(RowStartData1 + 5, 4)).Value\n\n    RowStartData1 = RowStartData1 + 6\n\nNext ColNum\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "text"], "comments": [{"owner": {"reputation": 573, "user_id": 506017, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Jnsvp.png?s=128&g=1", "display_name": "Eliot K", "link": "https://stackoverflow.com/users/506017/eliot-k"}, "edited": false, "score": 2, "creation_date": 1537895306, "post_id": 52503376, "comment_id": 91947458, "body": "Are the line breaks/carriange returns always going to be in the last column?"}, {"owner": {"reputation": 703, "user_id": 9914902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/570635b78e628529da1527be3f6c87c0?s=128&d=identicon&r=PG&f=1", "display_name": "JosephC", "link": "https://stackoverflow.com/users/9914902/josephc"}, "edited": false, "score": 2, "creation_date": 1537895851, "post_id": 52503376, "comment_id": 91947710, "body": "Show your code.  And Does Excel Crash?  or is it just &quot;Not Responding&quot; while it works?"}, {"owner": {"reputation": 41, "user_id": 2520338, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/3223f00dc7a4d1b139ed7b0456b2a890?s=128&d=identicon&r=PG", "display_name": "user2520338", "link": "https://stackoverflow.com/users/2520338/user2520338"}, "reply_to_user": {"reputation": 573, "user_id": 506017, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Jnsvp.png?s=128&g=1", "display_name": "Eliot K", "link": "https://stackoverflow.com/users/506017/eliot-k"}, "edited": false, "score": 0, "creation_date": 1537896429, "post_id": 52503376, "comment_id": 91947990, "body": "@EliotK - es it is always in the last column."}, {"owner": {"reputation": 41, "user_id": 2520338, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/3223f00dc7a4d1b139ed7b0456b2a890?s=128&d=identicon&r=PG", "display_name": "user2520338", "link": "https://stackoverflow.com/users/2520338/user2520338"}, "edited": false, "score": 0, "creation_date": 1537896466, "post_id": 52503376, "comment_id": 91948004, "body": "It shows &quot;Not Responding&quot;, takes forever and ultimately crashes."}, {"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 2, "creation_date": 1537896655, "post_id": 52503376, "comment_id": 91948102, "body": "Have you tried importing it to Excel as is, then cleaning up the CR/LF once it&#39;s in Excel? That might be easier."}, {"owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 0, "creation_date": 1537897863, "post_id": 52503376, "comment_id": 91948705, "body": "Alternatively, you could remove extra carriage returns in a text editor before importing into Excel"}], "answers": [{"tags": [], "owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "is_accepted": false, "score": 1, "last_activity_date": 1537899420, "last_edit_date": 1537899420, "creation_date": 1537898995, "answer_id": 52504378, "question_id": 52503376, "link": "https://stackoverflow.com/questions/52503376/how-to-remove-empty-lines-from-large-txt-file-using-excel-vba/52504378#52504378", "title": "How to remove empty lines from large txt file using excel VBA?", "body": "<p>If the extra newlines are always associated with the last column, I'd concentrate on the pipe delimiters, not on the lines. A \"record\" would constitute of 3 fields, so read the entire file into a buffer, and then assume that every third item needs to have any newlines replaced.  Something like this:</p>\n\n<pre><code>Public Sub ReplaceStringInFile()\n    Dim filepath As String\n    ' Edit as needed\n    filepath = Application.ActiveWorkbook.Path + \"\\DATAFILE\" + Format(Now(), \"yyyymmdd\") + \".txt\"\n\n    Dim handle As Integer\n    handle = FreeFile\n    Open filepath For Input As #handle\n    Dim buffer As String\n    'Read the entire file.\n    buffer = Input(LOF(handle), handle)\n    Close #handle\n\n    handle = FreeFile\n    Open filepath For Output As #handle\n\n    Dim lines() As String\n    lines = Split(buffer, \"|\")\n    Dim idx As Long\n    'This is your output buffer.\n    Dim record(0 To 2) As String\n    'I'd probably add more bounds checking here, but this should give the gist.\n    For idx = LBound(lines) To UBound(lines) - 2 Step 3\n        record(0) = lines(idx)\n        record(1) = lines(idx + 1)\n        'Do your replacement here.\n        record(2) = Trim$(Replace$(lines(idx + 2), vbCrLf, \" \"))\n        Print #handle, Join(record, \"|\")\n    Next\n\n    Close #handle\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 41, "user_id": 2520338, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/3223f00dc7a4d1b139ed7b0456b2a890?s=128&d=identicon&r=PG", "display_name": "user2520338", "link": "https://stackoverflow.com/users/2520338/user2520338"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 419, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1537899420, "creation_date": 1537894937, "last_edit_date": 1537896392, "question_id": 52503376, "link": "https://stackoverflow.com/questions/52503376/how-to-remove-empty-lines-from-large-txt-file-using-excel-vba", "title": "How to remove empty lines from large txt file using excel VBA?", "body": "<p>I'm trying to import a large TXT file into an excel file using VBA. The file is pipe delimited. But the source file is kind of messed up in that there are random line breaks which doesn't let me import the ifles correctly. </p>\n\n<pre><code>COLUMN1|COLUMN2|COLUMN3\nDataA1|DataA2|DataTextA3\n\nDataTextA3Continued\n\nDataB1|DataB2|DataTextB3\n</code></pre>\n\n<p>There technically shouldn't be that carriage return between <code>DataTextA3</code> and <code>DataTextA3Continued</code> but this is the file I'm getting. How do I go about removing this in VBA? I tried replacing using <code>vbCrLf</code> but the file is large (20MB) and it crashes excel. Appreciate the help!</p>\n\n<p>Thanks!</p>\n\n<p>Code below. </p>\n\n<pre><code>Sub ReplaceStringInFile()\n\nDim sBuf As String\nDim sTemp As String\nDim iFileNum As Integer\nDim sFileName As String\n\n' Edit as needed\nsFileName = Application.ActiveWorkbook.Path + \"\\DATAFILE\" + Format(Now(), \"yyyymmdd\") + \".txt\"\n\niFileNum = FreeFile\nOpen sFileName For Input As iFileNum\n\nDo Until EOF(iFileNum)\n    Line Input #iFileNum, sBuf\n    sTemp = sTemp &amp; sBuf &amp; vbCrLf\nLoop\nClose iFileNum\n\nsTemp = Replace(sTemp, vbCrLf, \"THAT\")\n\niFileNum = FreeFile\nOpen sFileName For Output As iFileNum\nPrint #iFileNum, sTemp\nClose iFileNum\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 0, "creation_date": 1537896522, "post_id": 52503354, "comment_id": 91948030, "body": "Might be easier to insert an appointment in their Outlook calendar. By scheduling it and including them in the &quot;meeting&quot;."}, {"owner": {"reputation": 105, "user_id": 8854939, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/05d3cfcc895aaa3a6f2564ecd32e08ec?s=128&d=identicon&r=PG&f=1", "display_name": "Barbaaz", "link": "https://stackoverflow.com/users/8854939/barbaaz"}, "reply_to_user": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 0, "creation_date": 1537900096, "post_id": 52503354, "comment_id": 91949711, "body": "@FreeMan The thing is, they don&#39;t have access to Outlook."}, {"owner": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 0, "creation_date": 1537913063, "post_id": 52503354, "comment_id": 91954985, "body": "Does this not already work? In what way do you want it to be like an outlook reminder?"}, {"owner": {"reputation": 105, "user_id": 8854939, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/05d3cfcc895aaa3a6f2564ecd32e08ec?s=128&d=identicon&r=PG&f=1", "display_name": "Barbaaz", "link": "https://stackoverflow.com/users/8854939/barbaaz"}, "edited": false, "score": 0, "creation_date": 1537959828, "post_id": 52503354, "comment_id": 91971951, "body": "@Ma.rcucciboy2 it works. However, if the operators log into their workstations later than 8.30 am, that reminder does not popup."}], "answers": [{"tags": [], "owner": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "is_accepted": true, "score": 1, "last_activity_date": 1538066218, "creation_date": 1538066218, "answer_id": 52541549, "question_id": 52503354, "link": "https://stackoverflow.com/questions/52503354/notification-popup-in-excel/52541549#52541549", "title": "Notification popup in Excel", "body": "<p>Well I don't think we really have to change much to get this working for you. If you are rather set on the 'main' alarm being at 8:30, then if they log in after that you can set it to remind them to add their info in an hour. </p>\n\n<pre><code>Private Sub Workbook_Open()\n\n    If Weekday(Now()) = vbMonday Then\n        If TimeValue(Now()) &lt; TimeValue(\"8:30:00\") Then\n            Application.OnTime TimeValue(\"08:30:00\"), \"DisplayAlarm\"\n        Else\n            Application.OnTime Now() + TimeValue(\"1:00:00\"), \"DisplayAlarm\"\n        End If\n    End If\n\nEnd Sub\n\nSub DisplayAlarm()\n    MsgBox \"Don't forget to input your data!\", vbOKOnly\nEnd Sub\n</code></pre>\n\n<p>If you just want it to notify everyone after an hour of waiting, you can use this instead.</p>\n\n<pre><code>Private Sub Workbook_Open()\n\n    If Weekday(Now()) = vbMonday Then\n        Application.OnTime Now() + TimeValue(\"1:00:00\"), \"DisplayAlarm\"\n    End If\n\nEnd Sub\n\nSub DisplayAlarm()\n    MsgBox \"Don't forget to input your data!\", vbOKOnly\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 105, "user_id": 8854939, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/05d3cfcc895aaa3a6f2564ecd32e08ec?s=128&d=identicon&r=PG&f=1", "display_name": "Barbaaz", "link": "https://stackoverflow.com/users/8854939/barbaaz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 83, "favorite_count": 0, "accepted_answer_id": 52541549, "answer_count": 1, "score": -1, "last_activity_date": 1538066218, "creation_date": 1537894862, "last_edit_date": 1537895724, "question_id": 52503354, "link": "https://stackoverflow.com/questions/52503354/notification-popup-in-excel", "title": "Notification popup in Excel", "body": "<p>I have a file in which operators have to input data.</p>\n\n<p>However, sometimes they forget to do so.</p>\n\n<p>I already had the file start as soon as they log into their workstation, but I need to have a reminder \"bothering\" them.</p>\n\n<p>Managed to have a MsgBox popup at a set time.</p>\n\n<p>Is it possible to have it working like an Outlook reminder?</p>\n\n<p>This is what I have so far.</p>\n\n<pre><code>Private Sub Workbook_Open()\n\nIf Weekday(Now()) = vbMonday Then\n    Application.OnTime \"08:30:00\", \"DisplayAlarm\"\nEnd If\n\nEnd Sub\n\nSub DisplayAlarm()\n    MsgBox \"Don't forget to input your data!\", vbOKOnly\nEnd Sub\n</code></pre>\n"}, {"tags": ["html", "excel", "vba", "web-scraping", "getelementsbytagname"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 2, "creation_date": 1537894726, "post_id": 52503297, "comment_id": 91947166, "body": "You can only Click an individual member of a collection - not the whole collection. E.g.  <code>doc.getElementsByTagName(&quot;a&quot;)(0).Click</code>"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1537894770, "post_id": 52503297, "comment_id": 91947185, "body": "Can you give an example of what is in  Range(&quot;Title&quot;) and the expected result please?"}, {"owner": {"reputation": 3, "user_id": 10414475, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-lJb426mOuug/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DVclf4n01kxsaoay_2jBqKdfQE7_A/mo/photo.jpg?sz=128", "display_name": "Nick Carn", "link": "https://stackoverflow.com/users/10414475/nick-carn"}, "edited": false, "score": 0, "creation_date": 1537902264, "post_id": 52503297, "comment_id": 91950759, "body": "Range title would be a film title."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 10414475, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-lJb426mOuug/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DVclf4n01kxsaoay_2jBqKdfQE7_A/mo/photo.jpg?sz=128", "display_name": "Nick Carn", "link": "https://stackoverflow.com/users/10414475/nick-carn"}, "edited": false, "score": 0, "creation_date": 1537902658, "post_id": 52503544, "comment_id": 91950946, "body": "Great! Was looking at result_text but trying getElementByClassName with innerText and getting errors. Will try this first thing tomorrow. querySelector method!"}, {"owner": {"reputation": 3, "user_id": 10414475, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-lJb426mOuug/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DVclf4n01kxsaoay_2jBqKdfQE7_A/mo/photo.jpg?sz=128", "display_name": "Nick Carn", "link": "https://stackoverflow.com/users/10414475/nick-carn"}, "edited": false, "score": 0, "creation_date": 1537974985, "post_id": 52503544, "comment_id": 91981730, "body": "That works beautifully... I&#39;m now going to spend some quality time understanding why!  Thanks so much QHarr."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 3, "user_id": 10414475, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-lJb426mOuug/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DVclf4n01kxsaoay_2jBqKdfQE7_A/mo/photo.jpg?sz=128", "display_name": "Nick Carn", "link": "https://stackoverflow.com/users/10414475/nick-carn"}, "edited": false, "score": 0, "creation_date": 1537975031, "post_id": 52503544, "comment_id": 91981768, "body": "Any questions let me know."}, {"owner": {"reputation": 3, "user_id": 10414475, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-lJb426mOuug/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DVclf4n01kxsaoay_2jBqKdfQE7_A/mo/photo.jpg?sz=128", "display_name": "Nick Carn", "link": "https://stackoverflow.com/users/10414475/nick-carn"}, "edited": false, "score": 0, "creation_date": 1537975113, "post_id": 52503544, "comment_id": 91981821, "body": "The bits I&#39;ll be looking into will be Option Explicit and Application.EnableEvents=True"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 3, "user_id": 10414475, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-lJb426mOuug/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DVclf4n01kxsaoay_2jBqKdfQE7_A/mo/photo.jpg?sz=128", "display_name": "Nick Carn", "link": "https://stackoverflow.com/users/10414475/nick-carn"}, "edited": false, "score": 0, "creation_date": 1537975197, "post_id": 52503544, "comment_id": 91981865, "body": "Ah... well they are easy. Plenty of documentation on those. You should always be using Option Explicit - enable it under the Tools &gt;Options &gt; Require variable declaration."}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": true, "score": 1, "last_activity_date": 1538467241, "last_edit_date": 1538467241, "creation_date": 1537895643, "answer_id": 52503544, "question_id": 52503297, "link": "https://stackoverflow.com/questions/52503297/vba-excel-run-time-error-438-getelementbyclassname/52503544#52503544", "title": "VBA Excel Run time error 438 / getElementbyClassName", "body": "<p>So, addressing your code</p>\n\n<ol>\n<li>You can use a shorter version of <code>Target.Address = Range(\"Title\").Address</code></li>\n<li>You don't want the first <code>a</code> tag element. You want the first search result <code>a</code> tag element.</li>\n</ol>\n\n<p>You can use a CSS selector combination to get the first search result <code>a</code> tag element as shown below.</p>\n\n<p>I use a CSS selector combination of <code>.result_text a</code> to target elements within parent class <code>result_text</code> with tag <code>a</code>. The <code>.</code> is a <a href=\"https://developer.mozilla.org/en-US/docs/Web/CSS/Class_selectors\" rel=\"nofollow noreferrer\">class selector</a>.</p>\n\n<p>This combination is known as a <a href=\"https://developer.mozilla.org/en-US/docs/Web/CSS/Descendant_selectors\" rel=\"nofollow noreferrer\">descendant selector</a>.</p>\n\n<p>Using search term in sheet of <code>Red October</code> this is what the CSS query first result is:</p>\n\n<p><a href=\"https://i.stack.imgur.com/yb3AN.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/yb3AN.png\" alt=\"enter image description here\"></a></p>\n\n<p>It is a relative link with base string <code>https://www.imdb.com</code>.</p>\n\n<p>Applying via <code>querySelector</code> method means only first matched result is returned i.e. the top result.</p>\n\n<hr>\n\n<p>VBA:</p>\n\n<pre><code>Option Explicit\nPrivate Sub Worksheet_Change(ByVal Target As Range)\n  Application.EnableEvents = False\n  If Target.Address = Range(\"Title\").Address Then\n    Dim ie As New InternetExplorer\n    ie.Visible = True\n    ie.navigate \"https://www.imdb.com/find?ref_=nv_sr_fn&amp;q=\" &amp; Range(\"Title\").value\n    Do\n     DoEvents\n    Loop Until ie.readyState = READYSTATE_COMPLETE\n    Dim doc As HTMLDocument\n    Set doc = ie.document\n    doc.querySelector(\".result_text a\").Click\n    'other code\n  End If\n  Application.EnableEvents = True\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 3, "user_id": 10414475, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-lJb426mOuug/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DVclf4n01kxsaoay_2jBqKdfQE7_A/mo/photo.jpg?sz=128", "display_name": "Nick Carn", "link": "https://stackoverflow.com/users/10414475/nick-carn"}, "edited": false, "score": 0, "creation_date": 1537975746, "post_id": 52503902, "comment_id": 91982210, "body": "Thanks - this is an important lesson but going through all the tags seemed more variable and arduous than the query selector which is very targeted.  Very much appreciate your advice."}], "tags": [], "owner": {"reputation": 188, "user_id": 6400144, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/226f717105f9cf7442c8f26eaaaadbd7?s=128&d=identicon&r=PG&f=1", "display_name": "fabio.avigo", "link": "https://stackoverflow.com/users/6400144/fabio-avigo"}, "is_accepted": false, "score": 0, "last_activity_date": 1537897051, "creation_date": 1537897051, "answer_id": 52503902, "question_id": 52503297, "link": "https://stackoverflow.com/questions/52503297/vba-excel-run-time-error-438-getelementbyclassname/52503902#52503902", "title": "VBA Excel Run time error 438 / getElementbyClassName", "body": "<p>This line of code:</p>\n\n<pre><code>doc.getElementsByTagName(\"a\")\n</code></pre>\n\n<p>gives you the <strong>Collection</strong> of Hyperlinks in your HTML Document. That is, it gives you ALL the elements that match your given criteria, if any are available. \nHowever, some issues may arrive:</p>\n\n<ol>\n<li><p>There may not be any hyperlinks available - So there are no elements to click on.</p></li>\n<li><p>You are not referencing any element to click. If you want the first one in the collection of found items, you could go with the index, as suggested. Else, you might look for another clicking criteria (such as what is its text or another given attribute).</p></li>\n<li><p>Even still, a found element might not be clickable by your browser, if, for example, it is shadowed by another element.</p></li>\n</ol>\n"}], "owner": {"reputation": 3, "user_id": 10414475, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-lJb426mOuug/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DVclf4n01kxsaoay_2jBqKdfQE7_A/mo/photo.jpg?sz=128", "display_name": "Nick Carn", "link": "https://stackoverflow.com/users/10414475/nick-carn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 276, "favorite_count": 0, "accepted_answer_id": 52503544, "answer_count": 2, "score": 0, "last_activity_date": 1538467241, "creation_date": 1537894580, "last_edit_date": 1537975064, "question_id": 52503297, "link": "https://stackoverflow.com/questions/52503297/vba-excel-run-time-error-438-getelementbyclassname", "title": "VBA Excel Run time error 438 / getElementbyClassName", "body": "<p>I'm a newbie, attempting to web scrape aspect ratio details from the imdb.com website.<br>\nI've plundered some code on You Tube and adapted it using inspect element.\nThe code opens imdb and runs a search by title but returns a Run Time error 438.\nIdeally I'd like it to return the html of the top result so I could perform a further click the top result to follow through to the page with tech details from where I could get the aspect ratio information and paste it into a cell.</p>\n\n<p>Unfortunately I get a fail from my Click instruction - haven't even got to the point of extracting the aspect ratio info.</p>\n\n<p>Can anyone see where I've gone wrong?</p>\n\n<p>Many thanks,</p>\n\n<p>Nick</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n  If Target.Row = Range(\"Title\").Row And Target.Column = Range(\"Title\").Column Then\n    Dim ie As New InternetExplorer\n    ie.Visible = True\n    ie.navigate \"https://www.imdb.com/find?ref_=nv_sr_fn&amp;q=\" &amp; Range(\"Title\").Value\n    Do\n     DoEvents\n    Loop Until ie.readyState = READYSTATE_COMPLETE\n    Dim doc As HTMLDocument\n    Set doc = ie.document\n    Dim sDD As String\n    doc.getElementsByTagName(\"a\").Click\n  End If\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 703, "user_id": 9914902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/570635b78e628529da1527be3f6c87c0?s=128&d=identicon&r=PG&f=1", "display_name": "JosephC", "link": "https://stackoverflow.com/users/9914902/josephc"}, "edited": false, "score": 4, "creation_date": 1537894638, "post_id": 52503204, "comment_id": 91947121, "body": "Not sure if it&#39;s the problem, but aspect ratio might be locked on the images.  If so put <code>s.LockAspectRatio = msoFalse</code> above your s.width line.  And you shouldn&#39;t need your <code>s.select</code>"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "reply_to_user": {"reputation": 703, "user_id": 9914902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/570635b78e628529da1527be3f6c87c0?s=128&d=identicon&r=PG&f=1", "display_name": "JosephC", "link": "https://stackoverflow.com/users/9914902/josephc"}, "edited": false, "score": 0, "creation_date": 1537894692, "post_id": 52503204, "comment_id": 91947151, "body": "@JosephC that&#39;s indeed the problem :)"}], "answers": [{"tags": [], "owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "is_accepted": true, "score": 5, "last_activity_date": 1537894678, "creation_date": 1537894678, "answer_id": 52503322, "question_id": 52503204, "link": "https://stackoverflow.com/questions/52503204/how-to-resize-all-images-on-a-worksheet/52503322#52503322", "title": "How to resize all images on a worksheet?", "body": "<p>I think you're only missing a minor thing. By default (when I test it) images inserted to the sheet have <code>LockAspectRatio=True</code>. </p>\n\n<p>You need to set this to <code>False</code>, otherwise the changes may be unpredictable: if you step through the code using <kbd>F8</kbd> you can observe that <code>Width</code> changes, but then on the next line <code>Height</code> reverts the width change from previous.</p>\n\n<p>So, set this to false and the images should retain the specified width/height.</p>\n\n<pre><code>Option Explicit\nSub ChangeAllPics()\nDim s As Shape\nDim ws As Worksheet\nSet ws = ActiveSheet\n\nFor Each s In ActiveSheet.Shapes\n    s.LockAspectRatio = msoFalse\n    s.Width = 500\n    s.Height = 200\n\nNext s\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "is_accepted": false, "score": 0, "last_activity_date": 1537984558, "creation_date": 1537984558, "answer_id": 52523602, "question_id": 52503204, "link": "https://stackoverflow.com/questions/52503204/how-to-resize-all-images-on-a-worksheet/52523602#52523602", "title": "How to resize all images on a worksheet?", "body": "<p>David's answer was just what I was looking for.  I'll add one more thing that has helped me a lot in the past day or so.  The script below takes all images on a sheet and organizes them in a fashion so that all are staked one below the another, none are overlapping, and all have a small space between them.  This makes everything very organized and easy to follow.</p>\n\n<pre><code>Sub AutoSpace_Shapes_Vertical()\n'Automatically space and align shapes\n\nDim shp As Shape\nDim lCnt As Long\nDim dTop As Double\nDim dLeft As Double\nDim dHeight As Double\nConst dSPACE As Double = 20\n\n  'Set variables\n  lCnt = 1\n\n  ActiveSheet.Shapes.SelectAll\n\n  'Loop through selected shapes (charts, slicers, timelines, etc.)\n  For Each shp In Selection.ShapeRange\n    With shp\n      'If not first shape then move it below previous shape and align left.\n      If lCnt &gt; 1 Then\n        .Top = dTop + dHeight + dSPACE\n        .Left = dLeft\n      End If\n\n      'Store properties of shape for use in moving next shape in the collection.\n      dTop = .Top\n      dLeft = .Left\n      dHeight = .Height\n    End With\n\n    'Add to shape counter\n    lCnt = lCnt + 1\n\n  Next shp\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1225, "favorite_count": 0, "accepted_answer_id": 52503322, "answer_count": 2, "score": 1, "last_activity_date": 1537984558, "creation_date": 1537894245, "question_id": 52503204, "link": "https://stackoverflow.com/questions/52503204/how-to-resize-all-images-on-a-worksheet", "title": "How to resize all images on a worksheet?", "body": "<p>I have several images on a worksheet.  I want to resize them all to the same size, but I can't seem to get it working quite right.  I thought it would be like the code below, but this actually makes everything different sizes.</p>\n\n<pre><code>Sub ChangeAllPics()\nDim s As Shape\nFor Each s In ActiveSheet.Shapes\ns.Select\n    s.Width = 500\n    s.Height = 200\nNext s\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 4, "creation_date": 1537893494, "post_id": 52502890, "comment_id": 91946516, "body": "Your workbook reference fails because the computer has the Windows Explorer &quot;hide extensions for know filetypes&quot; option unchecked.  The full workbook file name (including extension) will <i>always</i> work, regardless of that setting, so use that."}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1537894095, "post_id": 52502890, "comment_id": 91946827, "body": "Do you need to add the extension on to the workbook path also, <code>mybook.xlsx</code> for example?"}, {"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 0, "creation_date": 1537894264, "post_id": 52502890, "comment_id": 91946923, "body": "On this line: <code>WS_Count = Application.Workbooks(&quot;Start Here - Brand and TO Data Input&quot;).Worksheets.Count**</code> are the two asterisks <code>*</code> a typo or copy/paste error?"}, {"owner": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "reply_to_user": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 0, "creation_date": 1537895203, "post_id": 52502890, "comment_id": 91947412, "body": "@FreeMan It was probably OP trying to mark it as the error line for us"}, {"owner": {"reputation": 47, "user_id": 7982279, "user_type": "registered", "profile_image": "https://graph.facebook.com/10210721448206598/picture?type=large", "display_name": "James O&#39; Sullivan", "link": "https://stackoverflow.com/users/7982279/james-o-sullivan"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1537944089, "post_id": 52502890, "comment_id": 91962739, "body": "Thanks @TimWilliams - that&#39;s worked!"}, {"owner": {"reputation": 47, "user_id": 7982279, "user_type": "registered", "profile_image": "https://graph.facebook.com/10210721448206598/picture?type=large", "display_name": "James O&#39; Sullivan", "link": "https://stackoverflow.com/users/7982279/james-o-sullivan"}, "reply_to_user": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 0, "creation_date": 1537944195, "post_id": 52502890, "comment_id": 91962799, "body": "@FreeMan - yeah, I was trying to use bold formatting. I&#39;ve removed now."}], "owner": {"reputation": 47, "user_id": 7982279, "user_type": "registered", "profile_image": "https://graph.facebook.com/10210721448206598/picture?type=large", "display_name": "James O&#39; Sullivan", "link": "https://stackoverflow.com/users/7982279/james-o-sullivan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 45, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1537944148, "creation_date": 1537893126, "last_edit_date": 1537944148, "question_id": 52502890, "link": "https://stackoverflow.com/questions/52502890/active-workbooks-not-working-on-excel-2010", "title": "Active.workbooks not working on Excel 2010", "body": "<p>I'm providing a number of excel files in a folder to people. People open 'Start Here', click a macro button, and it auto generates some files.</p>\n\n<p>The whole thing works well when the folder and files are on computer 1. When I use them on my other computer, I get an error on the first line.</p>\n\n<p>Computer 1 - Windows 10 &amp; Office 365\nComputer 2 - Windows 10 &amp; Office 2010</p>\n\n<p>Can anyone tell me why? Is there any code that I can include at the beginning (i.e. including reference libraries) that could help make the file more suitable on different systems?</p>\n\n<p>Error on code line:</p>\n\n<pre><code>WS_Count = Application.Workbooks(\"Start Here - Brand and TO Data Input\").Worksheets.Count\n</code></pre>\n\n<p>run-time error 9; subscript out of range</p>\n\n<p>Note, when I change this to Activeworkbook.Worksheets.Count it works, but I'd rather not do that as I need to reference different workbooks as I progress. As it works on one computer and another, it doesn't seem to b a typo.....</p>\n\n<p>Full code:</p>\n\n<pre><code>Sub GenerateAssessments()\n    Dim currentdirectory As String\n    Dim CXsourcefile As String\n    Dim BACsourcefile As String\n\n    Dim WS_Count As Integer\n    Dim ws As Integer\n    Dim ws2 As Integer\n    Dim ws3 As Integer\n    Dim I As Integer\n\n    Dim Country As String\n    Dim CXnewname As String\n    Dim BACnewname As String\n\n    Dim BACWorkbook As Workbook\n    Dim CXWorkbook As Workbook\n    Dim xlobj As Object\n\n    Dim CountBrandsIncluded As Integer 'CountBrandsIncluded contains the number of brands, 'adding eleven to give the row of the last brand to  'included in the range Brand TOData\n    Dim EndRowBrandsIncluded As Integer\n\n    Dim CountBrandsNotIncluded As Integer\n    Dim StartRowBrandsNotIncluded As Integer\n    Dim EndRowBrandsNotIncluded As Integer\n\n    Dim StartColumnBrandsNotNeededBACTab As Integer\n    Dim StartColumnBrandsNotNeededQsTabs As Integer\n\n    Dim BrandTODataIncluded As Variant\n    Dim BrandTODataNotIncluded As Variant\n    Dim TotalBrandTOStated As Currency\n\n    Dim ErrorInpute As Variant\n    Dim wsprotect As Worksheet\n    Dim pwd As String\n\n\n\n    currentdirectory = Application.ActiveWorkbook.Path 'Find driectory of current workbook\n    CXsourcefile = currentdirectory &amp; \"\\\" &amp; \"CXSource.xlsx\" 'set CX source destination and file\n    BACsourcefile = currentdirectory &amp; \"\\\" &amp; \"BACSource.xlsx\"\n\n\n    WS_Count = Application.Workbooks(\"Start Here - Brand and TO Data Input\").Worksheets.Count\n    'Find number of worksheets in active workbook\n\n    'activate code for each sheet by looping\n    For I = 1 To WS_Count ' Begin the loop.\n        If Application.Workbooks(\"Start Here - Brand and TO Data Input\").Worksheets(I).Visible = True Then 'Run the loop on visible sheets only\n            Application.Workbooks(\"Start Here - Brand and TO Data Input\").Worksheets(I).Activate ' Set the worksheet as active\n            'Insert your code here to execute on each sheet.\n\n            'Country specific names and directories\n            Country = Application.Workbooks(\"Start Here - Brand and TO Data Input\").ActiveSheet.Range(\"S2\") 'get country and active sheet and create copies of the BAC and CX files\n            CXnewname = currentdirectory &amp; \"\\\" &amp; Country &amp; \" Consumer Experience Benchmark - protected with red metrics.xlsx\" 'set country specific name for new CX file\n            BACnewname = currentdirectory &amp; \"\\\" &amp; Country &amp; \" Business Adoption Continuum Benchmark - protected with red metrics.xlsx\" 'set country specific name for new BAC file\n\n            'no. of brands and row referncing for country tab\n            'included brands\n            CountBrandsIncluded = Application.Workbooks(\"Start Here - Brand and TO Data Input\").ActiveSheet.Range(\"P10\") 'get no. brands included\n            EndRowBrandsIncluded = 11 + CountBrandsIncluded 'Brands start at S12 'set last row of brands to be included\n\n            'excluded brands' rows\n            CountBrandsNotIncluded = Application.Workbooks(\"Start Here - Brand and TO Data Input\").ActiveSheet.Range(\"P12\") 'get no. brands excluded\n            StartRowBrandsNotIncluded = 11 + CountBrandsIncluded + 1\n            EndRowBrandsNotIncluded = 11 + CountBrandsIncluded + CountBrandsNotIncluded\n\n            'unneeded brand columns in BAC and Qs tabs\n            StartColumnBrandsNotNeededBACTab = 4 + CountBrandsIncluded + 1\n            StartColumnBrandsNotNeededQsTabs = 7 + CountBrandsIncluded + 1\n            StartColumnBrandsNotNeededDigitalCXTab = 6 + CountBrandsIncluded + 1\n\n            'copy total brand TO Data\n            TotalBrandTOStated = Application.Workbooks(\"Start Here - Brand and TO Data Input\").ActiveSheet.Range(\"T4:T4\").Value\n            'copy brand data to be included\n            BrandTODataIncluded = Application.Workbooks(\"Start Here - Brand and TO Data Input\").ActiveSheet.Range(\"S12:T\" &amp; EndRowBrandsIncluded).Value\n            'copy data not being included\n            BrandTODataNotIncluded = Application.Workbooks(\"Start Here - Brand and TO Data Input\").ActiveSheet.Range(\"S\" &amp; StartRowBrandsNotIncluded &amp; \":T\" &amp; EndRowBrandsNotIncluded).Value\n\n            'Create country BAC and CX Files\n            Set xlobj = CreateObject(\"Scripting.FileSystemObject\") 'Copy File Script : object.copyfile,source,destination,file overright(True is default)\n                xlobj.CopyFile CXsourcefile, CXnewname, False 'Copy CX file\n            Set xlobj = Nothing\n1\n            Set xlobj = CreateObject(\"Scripting.FileSystemObject\")\n                xlobj.CopyFile BACsourcefile, BACnewname, False\n            Set xlobj = Nothing\n\n            'Open and edit country's BAC file\n            Set BACWorkbook = Workbooks.Open(BACnewname) 'open new country's BAC file\n\n                BACWorkbook.Sheets(\"Brand + TO Data Inputs\").Range(\"T4:T4\").Value = TotalBrandTOStated\n                BACWorkbook.Sheets(\"Brand + TO Data Inputs\").Range(\"S3:S3\").Value = Country\n                BACWorkbook.Sheets(\"Brand + TO Data Inputs\").Range(\"S12:T\" &amp; EndRowBrandsIncluded).Value = BrandTODataIncluded\n                BACWorkbook.Sheets(\"Brand + TO Data Inputs\").Range(\"S\" &amp; StartRowBrandsNotIncluded &amp; \":\" &amp; \"U51\").Delete Shift:=xlUp\n                BACWorkbook.Sheets(\"Brand + TO Data Inputs\").Range(\"S\" &amp; StartRowBrandsNotIncluded &amp; \":T\" &amp; EndRowBrandsNotIncluded).Value = BrandTODataNotIncluded\n\n                BACWorkbook.Sheets(\"Consolidated BAC\").Select\n                BACWorkbook.Sheets(\"Consolidated BAC\").Range(Cells(1, StartColumnBrandsNotNeededBACTab), Cells(1, 44)).EntireColumn.Delete\n\n                ws = 4\n                For ws = 4 To 8\n                BACWorkbook.Sheets(ws).Select\n                BACWorkbook.Sheets(ws).Range(Cells(1, StartColumnBrandsNotNeededQsTabs), Cells(1, 47)).EntireColumn.Delete\n                Next\n\n                'hide all except Qs tabs\n                For ws4 = 1 To 3\n                BACWorkbook.Sheets(ws4).Select\n                BACWorkbook.Sheets(ws4).Visible = xlSheetHidden\n                Next ws4\n\n                'password protect the sheets and workbook\n                pwd = \"Digital2\" ' Put your password here\n                For Each ws4 In Worksheets\n                    ws4.Protect Password:=pwd\n                Next\n\n                BACWorkbook.Protect Structure:=True, Windows:=False, Password:=pwd\n\n                'save and close\n                BACWorkbook.Save\n                BACWorkbook.Close\n\n            Set CXWorkbook = Workbooks.Open(CXnewname)\n\n                CXWorkbook.Sheets(\"Brand + TO Data Inputs\").Range(\"T4:T4\").Value = TotalBrandTOStated\n                CXWorkbook.Sheets(\"Brand + TO Data Inputs\").Range(\"S3:S3\").Value = Country\n                CXWorkbook.Sheets(\"Brand + TO Data Inputs\").Range(\"S12:T\" &amp; EndRowBrandsIncluded).Value = BrandTODataIncluded\n                CXWorkbook.Sheets(\"Brand + TO Data Inputs\").Range(\"S\" &amp; StartRowBrandsNotIncluded &amp; \":\" &amp; \"U51\").Delete Shift:=xlUp\n                CXWorkbook.Sheets(\"Brand + TO Data Inputs\").Range(\"S\" &amp; StartRowBrandsNotIncluded &amp; \":T\" &amp; EndRowBrandsNotIncluded).Value = BrandTODataNotIncluded\n\n\n\n                CXWorkbook.Sheets(\"Digital CX Brand Baselines\").Select\n                CXWorkbook.Sheets(\"Digital CX Brand Baselines\").Range(Cells(1, StartColumnBrandsNotNeededDigitalCXTab), Cells(1, 46)).EntireColumn.Delete\n\n                'rename the brand tabs\n                Z = 5 + CountBrandsIncluded\n\n                For y = 6 To Z\n                    On Error GoTo errorbox\n                        CXWorkbook.Sheets(y).Activate\n                        ActiveSheet.Name = Range(\"K3\").Value\nContinue1:\n                Next y\n\n                'delete extra brand tabs\n                Application.DisplayAlerts = False\n                ws2 = 5 + CountBrandsIncluded\n                ws3 = ActiveWorkbook.Sheets.Count\n                Do Until ws2 = ws3\n                    Sheets(ws3).Select\n                    CXWorkbook.Sheets(ws3).Delete\n                    ws3 = ActiveWorkbook.Sheets.Count\n                Loop\n\n                Application.DisplayAlerts = True\n\n                'hide all except Qs tabs\n                For ws4 = 1 To 4\n                CXWorkbook.Sheets(ws4).Select\n                CXWorkbook.Sheets(ws4).Visible = xlSheetHidden\n                Next ws4\n\n                For ws4 = 6 To ws3\n                CXWorkbook.Sheets(ws4).Select\n                CXWorkbook.Sheets(ws4).Visible = xlSheetHidden\n                Next ws4\n\n                'password protect the sheets and workbook\n                pwd = \"Digital2\" ' Put your password here\n                For Each ws4 In Worksheets\n                    ws4.Protect Password:=pwd\n                Next\n\n                CXWorkbook.Protect Structure:=True, Windows:=False, Password:=pwd\n\n                'save and close\n                CXWorkbook.Save\n                CXWorkbook.Close\n        End If\n\n    Next I\n    Exit Sub\n\n\nerrorbox:\nErrorInput = InputBox(\"The brand name is not a valid Excel tab name. Please enter another.\")\nActiveSheet.Name = ErrorInput\nResume Continue1\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 1, "creation_date": 1537891843, "post_id": 52502476, "comment_id": 91945636, "body": "What happened to your rows with 39365627 and 39365640? Are they being shifted down? Are they going to have matching IDs somewhere in this column adjacent to them? Are they always in the correct order? We need to see a bigger set of data, IMO."}, {"owner": {"reputation": 1385, "user_id": 8555648, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-CK4leGQFE84/AAAAAAAAAAI/AAAAAAAAAgY/HrlhEh-LPIQ/photo.jpg?sz=128", "display_name": "newacc2240", "link": "https://stackoverflow.com/users/8555648/newacc2240"}, "edited": false, "score": 0, "creation_date": 1537892662, "post_id": 52502476, "comment_id": 91946072, "body": "I believe that it may be faster by copying data into a new worksheet rather than inserting so many rows inside your data."}, {"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 0, "creation_date": 1537892662, "post_id": 52502476, "comment_id": 91946073, "body": "As a tip, <code>Application.ScreenUpdating = False</code> is a good thing to have in your code once it&#39;s all working as intended. Until then, it&#39;s hiding what&#39;s going on and that&#39;ll make figuring out issues more difficult. Just comment it out for now (put a single quote <code>&#39;</code> at the beginning of the line)."}, {"owner": {"reputation": 1170, "user_id": 1420771, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/87b1adba7967dea43e9ae82ab68b861e?s=128&d=identicon&r=PG", "display_name": "Meules", "link": "https://stackoverflow.com/users/1420771/meules"}, "reply_to_user": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1537892784, "post_id": 52502476, "comment_id": 91946138, "body": "@dwirony: Yes your absolutely right. I&#39;ve updated my question."}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1537892895, "post_id": 52502476, "comment_id": 91946193, "body": "@Meules Thanks for the update - in that case my code that I posted below might work for you, however I still can&#39;t see what columns you&#39;re using/what row you&#39;re starting on, etc., so you might have to make some adjustments..."}, {"owner": {"reputation": 1170, "user_id": 1420771, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/87b1adba7967dea43e9ae82ab68b861e?s=128&d=identicon&r=PG", "display_name": "Meules", "link": "https://stackoverflow.com/users/1420771/meules"}, "reply_to_user": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1537893177, "post_id": 52502476, "comment_id": 91946348, "body": "@dwirony: I&#39;m starting on row 1. Row 1 has headers for the column. Row 2 is the first &quot;data&quot; row.  Columns are A to F. But I&#39;ll update the image, one sec."}], "answers": [{"comments": [{"owner": {"reputation": 1170, "user_id": 1420771, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/87b1adba7967dea43e9ae82ab68b861e?s=128&d=identicon&r=PG", "display_name": "Meules", "link": "https://stackoverflow.com/users/1420771/meules"}, "edited": false, "score": 0, "creation_date": 1537892871, "post_id": 52502740, "comment_id": 91946181, "body": "You were to quick :) I&#39;ve updated my question as per your request. It&#39;s my first time posting such question so I&#39;m not sure which data is needed for an anwer :)"}, {"owner": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "reply_to_user": {"reputation": 1170, "user_id": 1420771, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/87b1adba7967dea43e9ae82ab68b861e?s=128&d=identicon&r=PG", "display_name": "Meules", "link": "https://stackoverflow.com/users/1420771/meules"}, "edited": false, "score": 0, "creation_date": 1537893079, "post_id": 52502740, "comment_id": 91946300, "body": "@Meules just try to include as many &#39;cases&#39; of data differences as possible in your example"}, {"owner": {"reputation": 1170, "user_id": 1420771, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/87b1adba7967dea43e9ae82ab68b861e?s=128&d=identicon&r=PG", "display_name": "Meules", "link": "https://stackoverflow.com/users/1420771/meules"}, "edited": false, "score": 0, "creation_date": 1537893812, "post_id": 52502740, "comment_id": 91946679, "body": "@dwirony: I&#39;ve updated the images again. I&#39;m not sure if the amount of rows is important? The problem is in my case that column A has around 13k rows and column B around 8k. Column B is shorter because of the missing id&#39;s."}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "reply_to_user": {"reputation": 1170, "user_id": 1420771, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/87b1adba7967dea43e9ae82ab68b861e?s=128&d=identicon&r=PG", "display_name": "Meules", "link": "https://stackoverflow.com/users/1420771/meules"}, "edited": false, "score": 0, "creation_date": 1537894213, "post_id": 52502740, "comment_id": 91946901, "body": "@Meules Did you try my code? I&#39;m guess it should work now that I can see your layout"}, {"owner": {"reputation": 1170, "user_id": 1420771, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/87b1adba7967dea43e9ae82ab68b861e?s=128&d=identicon&r=PG", "display_name": "Meules", "link": "https://stackoverflow.com/users/1420771/meules"}, "edited": false, "score": 0, "creation_date": 1537894803, "post_id": 52502740, "comment_id": 91947200, "body": "@dwirony: I&#39;ve tested a small portion of the sheet and it looks like it works! I&#39;m testing a bit more now and let you know immediately."}, {"owner": {"reputation": 1170, "user_id": 1420771, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/87b1adba7967dea43e9ae82ab68b861e?s=128&d=identicon&r=PG", "display_name": "Meules", "link": "https://stackoverflow.com/users/1420771/meules"}, "edited": false, "score": 0, "creation_date": 1537896968, "post_id": 52502740, "comment_id": 91948251, "body": "@dwirony: I&#39;ve tested it on the full sheet. Your code works until row 4823. Can that be because of limits or something? While I was typing this it seems that those id&#39;s need to be in order. For example I have on row 1 value 1234 and on row 2 1233 then script stops and adds all rows again for all matching values. Any way I think I can find a solution for this. Many thx!!! You saved me :)"}], "tags": [], "owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "is_accepted": true, "score": 1, "last_activity_date": 1537892677, "creation_date": 1537892677, "answer_id": 52502740, "question_id": 52502476, "link": "https://stackoverflow.com/questions/52502476/excel-add-and-copy-row-values-based-on-the-amount-of-matches/52502740#52502740", "title": "Excel add and copy row values based on the amount of matches", "body": "<p>Here's a small example - without being able to see more of your data, it's impossible to know where to go from here.  </p>\n\n<pre><code>Sub Test()\n\nDim i As Long\nDim id As String\n\nFor i = 1 To Cells(Rows.Count, 1).End(xlUp).Row\n    id = Cells(i, 1).Value\n    If Cells(i + 1, 1).Value = id And Cells(i + 1, 2).Value &lt;&gt; id Then\n        Range(Cells(i + 1, 2), Cells(i + 1, 6)).Insert Shift:=xlDown\n        Range(Cells(i + 1, 2), Cells(i + 1, 6)).Value = Range(Cells(i, 2), Cells(i, 6)).Value\n    End If\nNext i\n\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/advVM.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/advVM.png\" alt=\"img1\"></a></p>\n"}], "owner": {"reputation": 1170, "user_id": 1420771, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/87b1adba7967dea43e9ae82ab68b861e?s=128&d=identicon&r=PG", "display_name": "Meules", "link": "https://stackoverflow.com/users/1420771/meules"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 57, "favorite_count": 0, "accepted_answer_id": 52502740, "answer_count": 1, "score": 1, "last_activity_date": 1537894113, "creation_date": 1537891660, "last_edit_date": 1537894113, "question_id": 52502476, "link": "https://stackoverflow.com/questions/52502476/excel-add-and-copy-row-values-based-on-the-amount-of-matches", "title": "Excel add and copy row values based on the amount of matches", "body": "<p>First of all I'm completely new to VB and have not much experience with Excel.\nSecond I'm not sure if this is the correct forum to ask this question, but I saw more questions regarding my issue. </p>\n\n<p>I have an Excel sheet with two columns with id's in it. Something like this:\n<a href=\"https://i.stack.imgur.com/oJxjT.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/oJxjT.png\" alt=\"enter image description here\"></a></p>\n\n<p>As you can see in the first picture (in column 1) you have 3 equal id's (in blue). In the second column you have that same id (on second row) just one time. Is there a way to create some sort of function to duplicate the second column as many times as the first column has that id?\nSo it looks like the second image:\n<a href=\"https://i.stack.imgur.com/8gUYu.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/8gUYu.png\" alt=\"enter image description here\"></a></p>\n\n<p><strong>EDIT:</strong> The idea of the function/formula is that rows shift down. Not every ID in column 1 has multiple same ID's. For example the black cell is just a single one.Further column A is used as reference and only column b to F should be \"changed\". </p>\n\n<p>I tried programs like <a href=\"https://www.extendoffice.com/product/kutools-for-excel.html\" rel=\"nofollow noreferrer\">Kutools</a> to accomplish this but without success. Since the sheet has around 15k rows it would take a lot off time to do it by hand. </p>\n\n<p>I'm able to add an empty row with VB when a cell matches a value, but I'm not able to copy.</p>\n\n<p>I tried this which obviously doesn't work:</p>\n\n<pre><code>Sub BlankLine()\n\n    Dim Rng As Range\n    Dim WorkRng As Range\n    On Error Resume Next\n    xTitleId                   = \"MyTest\"\n    Set WorkRng                = Application.Selection\n    Set WorkRng                = Application.InputBox(\"Range\", xTitleId, WorkRng.Address, Type: = 8)\n    Set WorkRng                = WorkRng.Columns(1)\n    xLastRow                   = WorkRng.Rows.Count\n    Application.ScreenUpdating = False\n    For xRowIndex = xLastRow To 1 Step - 1\n        Set Rng                   = WorkRng.Range(\"A\" &amp; xRowIndex)\n        If Rng.Value = \"0\" Then\n            Rng.Offset(1, 0).EntireRow.Insert Shift: = xlDown\n        End If\n    Next\n    Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n\n<p>Is this even possible and is somebody willing to give some directions? Thanks in advance... </p>\n"}, {"tags": ["vba", "outlook"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2261597"}, "edited": false, "score": 0, "creation_date": 1537891308, "post_id": 52502114, "comment_id": 91945311, "body": "I googled, (did you?): <a href=\"https://docs.microsoft.com/en-us/office/vba/api/outlook.mailitem.senton\" rel=\"nofollow noreferrer\">docs.microsoft.com/en-us/office/vba/api/outlook.mailitem.sen&zwnj;&#8203;ton</a>"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 1, "creation_date": 1537891447, "post_id": 52502114, "comment_id": 91945411, "body": "Based on the title of the question - how is the <a href=\"https://docs.microsoft.com/en-us/office/vba/api/outlook.mailitem.receivedtime\" rel=\"nofollow noreferrer\"><code>ReceivedTime</code></a> property not working?"}, {"owner": {"reputation": 3311, "user_id": 6147374, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d05b5955de351d18e1c8d715f97f0be2?s=128&d=identicon&r=PG&f=1", "display_name": "Ibo", "link": "https://stackoverflow.com/users/6147374/ibo"}, "edited": false, "score": 0, "creation_date": 1537891491, "post_id": 52502114, "comment_id": 91945441, "body": "check this out: <a href=\"https://stackoverflow.com/questions/43766570/how-to-get-outlook-email-received-time\" title=\"how to get outlook email received time\">stackoverflow.com/questions/43766570/&hellip;</a>"}, {"owner": {"reputation": 286, "user_id": 1683416, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/SRLyh.png?s=128&g=1", "display_name": "donviti", "link": "https://stackoverflow.com/users/1683416/donviti"}, "edited": false, "score": 0, "creation_date": 1537891522, "post_id": 52502114, "comment_id": 91945462, "body": "@peakpeak do you feel better now that you tried to belittle me?  bravo and helpful"}, {"owner": {"reputation": 286, "user_id": 1683416, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/SRLyh.png?s=128&g=1", "display_name": "donviti", "link": "https://stackoverflow.com/users/1683416/donviti"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1537891572, "post_id": 52502114, "comment_id": 91945489, "body": "@BigBen  I can&#39;t seem to even be able to create the object to pull the date and drop it into a column.  I&#39;m not even bother putting the code I had in b/c nothing literally nothing has even come close to working"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1537891664, "post_id": 52502114, "comment_id": 91945529, "body": "Is <code>Item</code> not the <code>MailItem</code> in question? Although as is your code assumes that <code>Item</code> is in fact a <code>MailItem</code>"}, {"owner": {"reputation": 286, "user_id": 1683416, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/SRLyh.png?s=128&g=1", "display_name": "donviti", "link": "https://stackoverflow.com/users/1683416/donviti"}, "reply_to_user": {"reputation": 3311, "user_id": 6147374, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d05b5955de351d18e1c8d715f97f0be2?s=128&d=identicon&r=PG&f=1", "display_name": "Ibo", "link": "https://stackoverflow.com/users/6147374/ibo"}, "edited": false, "score": 0, "creation_date": 1537891667, "post_id": 52502114, "comment_id": 91945531, "body": "@Ibo thank you, I found that but I honestly can&#39;t figure out how to use that code and drop the date into a column.  I admit I&#39;m struggling with this"}, {"owner": {"reputation": 286, "user_id": 1683416, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/SRLyh.png?s=128&g=1", "display_name": "donviti", "link": "https://stackoverflow.com/users/1683416/donviti"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1537891738, "post_id": 52502114, "comment_id": 91945576, "body": "@BigBen it could be man, but my comprehension of VBA is hitting a wall with how to drop that into a column"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1537891871, "post_id": 52502114, "comment_id": 91945653, "body": "What do you mean by &quot;drop it into a column&quot; - write it into a particular cell? Just set the cell&#39;s <code>.Value</code> equal to the <code>ReceivedTime</code>."}, {"owner": {"reputation": 286, "user_id": 1683416, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/SRLyh.png?s=128&g=1", "display_name": "donviti", "link": "https://stackoverflow.com/users/1683416/donviti"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1537892145, "post_id": 52502114, "comment_id": 91945784, "body": "@BigBen yes.  I feel like I have tried doing it but I can&#39;t seem to get anything to work"}, {"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 2, "creation_date": 1537892368, "post_id": 52502114, "comment_id": 91945908, "body": "this code: <code>cells.Select : Selection.Delete</code> is quite dangerous! It will delete the contents of whatever cell happens to be selected when you run it."}, {"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 2, "creation_date": 1537892486, "post_id": 52502114, "comment_id": 91945968, "body": "Your code is kinda all over the place, but I think the issue is here: <code>sourceSH.cells(1, 4) = &quot;Received Time&quot;</code>. That should <i>probably</i> be <code>sourceSH.cells(1, 4) = Item.ReceivedTime</code>, but there&#39;s no guarantee that&#39;s it."}, {"owner": {"reputation": 286, "user_id": 1683416, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/SRLyh.png?s=128&g=1", "display_name": "donviti", "link": "https://stackoverflow.com/users/1683416/donviti"}, "reply_to_user": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 0, "creation_date": 1537893086, "post_id": 52502114, "comment_id": 91946306, "body": "@FreeMan I don&#39;t disagree that it&#39;s all over the place at all."}, {"owner": {"reputation": 286, "user_id": 1683416, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/SRLyh.png?s=128&g=1", "display_name": "donviti", "link": "https://stackoverflow.com/users/1683416/donviti"}, "reply_to_user": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 0, "creation_date": 1537893630, "post_id": 52502114, "comment_id": 91946579, "body": "@FreeMan holy crap.  That&#39;s gonna be good enough.  man what a fool.  Any idea how to get that to populate the array?  The number of rows varies by day, and ideally I&#39;d like that to populate the column all the way down next to the other data...."}, {"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 1, "creation_date": 1537893909, "post_id": 52502114, "comment_id": 91946738, "body": "Instead of <code>sourceSH.cells(1, 4) = Item.ReceivedTime</code> you&#39;d want <code>sourceSH.cells(currentRow, currentCol) = Item.ReceivedTime</code> where <code>currentRow</code> and/or <code>currentCol</code> change as you loop through all the email messages you&#39;re reading."}, {"owner": {"reputation": 286, "user_id": 1683416, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/SRLyh.png?s=128&g=1", "display_name": "donviti", "link": "https://stackoverflow.com/users/1683416/donviti"}, "reply_to_user": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 0, "creation_date": 1537895311, "post_id": 52502114, "comment_id": 91947463, "body": "@FreeMan  Thank you, it&#39;s not looping through the email messages.  It&#39;s taking an HTML table which is in the body of the email.  I then am attaching the date of the email to each row that has data from the column.  So if today&#39;s email has 20 names, ideally I want 20 dates.  Tomorrow could be 15, so I&#39;ll want 15.  This has been a big help.  I&#39;ll try to figure out how to insert the date for each row"}, {"owner": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 1, "creation_date": 1537896135, "post_id": 52502114, "comment_id": 91947855, "body": "You would get way more useful help if your explanation in your question wasn&#39;t barely 3 sentences :p"}, {"owner": {"reputation": 286, "user_id": 1683416, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/SRLyh.png?s=128&g=1", "display_name": "donviti", "link": "https://stackoverflow.com/users/1683416/donviti"}, "reply_to_user": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 0, "creation_date": 1537897275, "post_id": 52502114, "comment_id": 91948415, "body": "@Marcucciboy2 I don&#39;t disagree with that but sometimes I give too much info and it confuses people more"}, {"owner": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 1, "creation_date": 1537897340, "post_id": 52502114, "comment_id": 91948446, "body": "In those cases, if the underlying question is good, many people wouldn&#39;t hesitate to edit that up for you to help make a coherent and concise question (I do it all the time)"}], "answers": [{"comments": [{"owner": {"reputation": 286, "user_id": 1683416, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/SRLyh.png?s=128&g=1", "display_name": "donviti", "link": "https://stackoverflow.com/users/1683416/donviti"}, "edited": false, "score": 0, "creation_date": 1537962744, "post_id": 52510845, "comment_id": 91973641, "body": "So that is almost what I need and I think I can work with that.  It is giving me a bunch of different dates and running past the rows with data.  Thank you, the m=1 thing is what I&#39;m failing to understand and this is a big help"}, {"owner": {"reputation": 161, "user_id": 10308648, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e9afe6ea28d5466be955d0ec36da547?s=128&d=identicon&r=PG&f=1", "display_name": "Evanzheng", "link": "https://stackoverflow.com/users/10308648/evanzheng"}, "reply_to_user": {"reputation": 286, "user_id": 1683416, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/SRLyh.png?s=128&g=1", "display_name": "donviti", "link": "https://stackoverflow.com/users/1683416/donviti"}, "edited": false, "score": 0, "creation_date": 1538019001, "post_id": 52510845, "comment_id": 91997312, "body": "m=1 just specifies that it starts to loop from there. It is not the point. could you please mark the answer if it helps"}], "tags": [], "owner": {"reputation": 161, "user_id": 10308648, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e9afe6ea28d5466be955d0ec36da547?s=128&d=identicon&r=PG&f=1", "display_name": "Evanzheng", "link": "https://stackoverflow.com/users/10308648/evanzheng"}, "is_accepted": false, "score": 0, "last_activity_date": 1537941340, "creation_date": 1537941340, "answer_id": 52510845, "question_id": 52502114, "link": "https://stackoverflow.com/questions/52502114/capture-email-received-time-in-an-excel-spreadsheet/52510845#52510845", "title": "Capture Email Received Time in an Excel Spreadsheet", "body": "<p>You can use MailItem.ReceivedTime Property to get the time of email.</p>\n\n<p>Please try the following code.</p>\n\n<pre><code>    Public Sub Driver()\n    Dim xlApp As Object\n    Dim sourceWB As Workbook\n    Dim strFile As String\n    Dim olItems As Outlook.Items\n    Dim sourceSH As Worksheet\n    Dim olFolder As Outlook.folder\n    Dim olNameSpace As Outlook.NameSpace\n    Dim objEmail As Object\n    Dim intRowIndex As Integer\n    Dim intEmailIndex As Integer\n    Dim objFolder As Outlook.MAPIFolder\n    Dim m As Long\n    Set xlApp = CreateObject(\"Excel.Application\")\n    With xlApp\n        .Visible = True\n        .EnableEvents = False\n        .EnableEvents = False\n        .DisplayAlerts = False\n    End With\n    Set olNameSpace = Application.GetNamespace(\"MAPI\")\n    Set olFolder = olNameSpace.GetDefaultFolder(olFolderInbox)\n    Set olItems = olFolder.Items\n    'olItems.Sort (\"[ReceivedTime]\")\n    strFile = \"C:\\Users\\dfddg\\Desktop\\Book1.xlsx\"\n    Set sourceWB = Workbooks.Open(strFile, , False, , , , , , , True)\n    Set sourceSH = sourceWB.Worksheets(\"Sheet1\")\n    sourceWB.Activate\n    m = 1\n    For Each Item In olItems\n    sourceSH.cells(m, 4) = Item.ReceivedTime\n    'MsgBox Item.ReceivedTime\n    'MsgBox Item.Subject\n    m = m + 1\n    Next\n    sourceWB.Save\n    sourceWB.Close\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 286, "user_id": 1683416, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/SRLyh.png?s=128&g=1", "display_name": "donviti", "link": "https://stackoverflow.com/users/1683416/donviti"}, "is_accepted": false, "score": 0, "last_activity_date": 1537986126, "creation_date": 1537986126, "answer_id": 52523981, "question_id": 52502114, "link": "https://stackoverflow.com/questions/52502114/capture-email-received-time-in-an-excel-spreadsheet/52523981#52523981", "title": "Capture Email Received Time in an Excel Spreadsheet", "body": "<p>Ok, I figured out something that is probably not advisable, but it worked for me.  I added a specialcells function that searches for the blank cells in a column and then it adds the Date that I need.  Thanks so much for all the help </p>\n\n<pre><code>Public Sub Driver()\n\n\nDim Item As MailItem, x%\nDim r As Object  'As Word.Range\nDim doc As Object 'As Word.Document\nDim xlApp As Object\nDim olItems As Outlook.Items\nDim sourceWB As Workbook\nDim sourceSH As Worksheet\nDim olFolder As Outlook.Folder\nDim strFile As String\nDim olEleColl As MSHTML.IHTMLElementCollection\nDim olNameSpace As Outlook.NameSpace\nDim olHTML As MSHTML.HTMLDocument: Set olHTML = New MSHTML.HTMLDocument\nDim OutlookApp As Object\nDim OutlookMail As Object\n\nDim objEmail As Outlook.MailItem\nDim intRowIndex As Integer\nDim intEmailIndex As Integer\nDim objFolder As Outlook.MAPIFolder\n\nSet xlApp = CreateObject(\"Excel.Application\")\n    With xlApp\n        .Visible = True\n        .EnableEvents = False\n        .EnableEvents = False\n        .DisplayAlerts = False\n    End With\n    Set olNameSpace = Application.GetNamespace(\"MAPI\")\n\nSet olFolder = olNameSpace.GetDefaultFolder(olFolderInbox)\nSet olItems = olFolder.Items\n'olItems.Sort (\"[ReceivedTime]\")\nSet Item = olItems(olItems.Count)\n\n'save Outlook email's html body (tables)\nWith olHTML\n    .Body.innerHTML = Item.HTMLBody\n    Set olEleColl = .getElementsByTagName(\"table\")\nEnd With\n\nstrFile = \"C:\\xls\\Driver.xlsx\"\n\n Set sourceWB = Workbooks.Open(strFile, , False, , , , , , , True)\n Set sourceSH = sourceWB.Worksheets(\"Sheet1\")\n    sourceWB.Activate\n\ncells.Select\n    Selection.Delete\n\nFor Each Item In Application.ActiveExplorer.Selection\nSet doc = Item.GetInspector.WordEditor\n    For x = 1 To doc.tables.Count\n     Set r = doc.tables(x)\n\n\n        r.Range.Copy\n       sourceSH.Paste\nActiveSheet.Pictures.Delete\nrows(4).Delete\n    rows(1).EntireRow.Delete\n    rows(1).EntireRow.Delete\n    rows(1).EntireRow.Delete\n Range(\"D:E\").Delete\n       sourceSH.cells(sourceSH.rows.Count, 1).End(3).Offset(1).Select\n\n\nsourceSH.cells(2, 4) = Item.ReceivedTime\nsourceSH.cells(1, 4) = \"Received Time\"\nRange(\"D2\").CurrentRegion.SpecialCells(xlCellTypeBlanks).Value = Item.ReceivedTime\n\n\n    Next\nNext\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 286, "user_id": 1683416, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/SRLyh.png?s=128&g=1", "display_name": "donviti", "link": "https://stackoverflow.com/users/1683416/donviti"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 858, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1592942311, "creation_date": 1537890351, "last_edit_date": 1592942311, "question_id": 52502114, "link": "https://stackoverflow.com/questions/52502114/capture-email-received-time-in-an-excel-spreadsheet", "title": "Capture Email Received Time in an Excel Spreadsheet", "body": "<p>I need to start from scratch.  I have code as long as my arm.  I \"simply\" want to figure out how to take the date that an email was sent and insert it into a specific column in Excel.  I have already figured out how to take the HTML table in the body of the email and place it in Excel.  NOW, \"all\" I need to do is capture the date of email and drop in Column </p>\n\n<pre><code>Public Sub Driver()\n\n    Dim Item As MailItem, x%\n    Dim r As Object                              'As Word.Range\n    Dim doc As Object                            'As Word.Document\n    Dim xlApp As Object\n    Dim olItems As Outlook.Items\n    Dim sourceWB As Workbook\n    Dim sourceSH As Worksheet\n    Dim olFolder As Outlook.Folder\n    Dim strFile As String\n    Dim olEleColl As MSHTML.IHTMLElementCollection\n    Dim olNameSpace As Outlook.NameSpace\n    Dim olHTML As MSHTML.HTMLDocument: Set olHTML = New MSHTML.HTMLDocument\n    Dim OutlookApp As Object\n    Dim OutlookMail As Object\n\n    Dim objEmail As Outlook.MailItem\n    Dim intRowIndex As Integer\n    Dim intEmailIndex As Integer\n    Dim objFolder As Outlook.MAPIFolder\n\n    Set xlApp = CreateObject(\"Excel.Application\")\n    With xlApp\n        .Visible = True\n        .EnableEvents = False\n        .EnableEvents = False\n        .DisplayAlerts = False\n    End With\n\n    Set olNameSpace = Application.GetNamespace(\"MAPI\")\n    Set olFolder = olNameSpace.GetDefaultFolder(olFolderInbox)\n    Set olItems = olFolder.Items\n    'olItems.Sort (\"[ReceivedTime]\")\n    Set Item = olItems(olItems.Count)\n\n    'save Outlook email's html body (tables)\n    With olHTML\n        .Body.innerHTML = Item.HTMLBody\n        Set olEleColl = .getElementsByTagName(\"table\")\n    End With\n\n    strFile = \"C:\\xls\\Driver.xlsx\"\n\n    Set sourceWB = Workbooks.Open(strFile, , False, , , , , , , True)\n    Set sourceSH = sourceWB.Worksheets(\"Sheet1\")\n    sourceWB.Activate\n\n    cells.Select\n    Selection.Delete\n\n    For Each Item In Application.ActiveExplorer.Selection\n        Set doc = Item.GetInspector.WordEditor\n\n        For x = 1 To doc.tables.Count\n            Set r = doc.tables(x)\n            r.Range.Copy\n            sourceSH.Paste\n\n            ActiveSheet.Pictures.Delete\n            rows(4).Delete\n            rows(1).EntireRow.Delete\n            rows(1).EntireRow.Delete\n            rows(1).EntireRow.Delete\n            Range(\"D:E\").Delete\n\n            sourceSH.cells(sourceSH.rows.Count, 1).End(3).Offset(1).Select\n\n            sourceSH.cells(1, 4) = \"Received Time\"\n\n        Next\n    Next\n\n    sourceWB.Save\n    sourceWB.Close\n\n    Set sourceWB = Nothing\n    xlApp.Quit\n    Set xlApp = Nothing\n\n    Set OutlookApp = CreateObject(\"Outlook.Application\")\n    Set OutlookMail = OutlookApp.CreateItem(0)\n\n    On Error Resume Next\n    With OutlookMail\n        .To = \"me@memememe.com\"\n\n        .CC = \"\"\n        .BCC = \"\"\n        .Subject = \"If this works!\"\n        .Body = \"Test.\"\n        .Attachments.Add (\"c:\\xls\\Driver.xlsx\")\n        .Send\n    End With\n\n    Set OutlookMail = Nothing\n    Set OutlookApp = Nothing\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 1, "creation_date": 1537890026, "post_id": 52501927, "comment_id": 91944571, "body": "I wouldn&#39;t use <code>Application.Find</code> in VBA code - you&#39;re looking for <code>Instr</code>."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 2, "creation_date": 1537890049, "post_id": 52501927, "comment_id": 91944581, "body": "<code>X-(y-1)</code> = <code>X-y+1</code>"}, {"owner": {"reputation": 7206, "user_id": 8107092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dce232725da0108d5e43f3eebcaddd91?s=128&d=identicon&r=PG&f=1", "display_name": "Dy.Lee", "link": "https://stackoverflow.com/users/8107092/dy-lee"}, "edited": false, "score": 0, "creation_date": 1537890361, "post_id": 52501927, "comment_id": 91944779, "body": "22-13-1=8  is result."}, {"owner": {"reputation": 76, "user_id": 9916855, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c25f064e245b789d88bf6d42d2f74f8?s=128&d=identicon&r=PG", "display_name": "John Wilson", "link": "https://stackoverflow.com/users/9916855/john-wilson"}, "edited": false, "score": 0, "creation_date": 1537901619, "post_id": 52501927, "comment_id": 91950422, "body": "Comintern - I use both. Depends on which side of the bed I wake up on in the morning but yes, instr is the better choice."}], "answers": [{"comments": [{"owner": {"reputation": 76, "user_id": 9916855, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c25f064e245b789d88bf6d42d2f74f8?s=128&d=identicon&r=PG", "display_name": "John Wilson", "link": "https://stackoverflow.com/users/9916855/john-wilson"}, "edited": false, "score": 0, "creation_date": 1537894272, "post_id": 52502132, "comment_id": 91946928, "body": "Valon thanks for the clarification. Now it makes perfect sense."}, {"owner": {"reputation": 1156, "user_id": 10315836, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hZjRU.png?s=128&g=1", "display_name": "Valon Miller", "link": "https://stackoverflow.com/users/10315836/valon-miller"}, "reply_to_user": {"reputation": 76, "user_id": 9916855, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c25f064e245b789d88bf6d42d2f74f8?s=128&d=identicon&r=PG", "display_name": "John Wilson", "link": "https://stackoverflow.com/users/9916855/john-wilson"}, "edited": false, "score": 0, "creation_date": 1537894566, "post_id": 52502132, "comment_id": 91947086, "body": "You&#39;re welcome, please mark this as the correct answer if it resolved the issue you were experiencing."}], "tags": [], "owner": {"reputation": 1156, "user_id": 10315836, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hZjRU.png?s=128&g=1", "display_name": "Valon Miller", "link": "https://stackoverflow.com/users/10315836/valon-miller"}, "is_accepted": true, "score": 2, "last_activity_date": 1537890393, "creation_date": 1537890393, "answer_id": 52502132, "question_id": 52501927, "link": "https://stackoverflow.com/questions/52501927/excel-vba-math-just-not-adding-up/52502132#52502132", "title": "Excel VBA Math just not adding up", "body": "<p>Its correct, the problem is you cant do <code>Application.Find(\":\", MyStr)-1</code> by itself:</p>\n\n<p><code>VBA.Len(MyStr) - Application.Find(\":\", MyStr)-1</code></p>\n\n<p>= 22 - 13 -1</p>\n\n<p>= 9 - 1</p>\n\n<p>= 8</p>\n\n<p>You are mistakenly thinking of it as:</p>\n\n<p>= 22 - ( 13 - 1 )</p>\n"}], "owner": {"reputation": 76, "user_id": 9916855, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c25f064e245b789d88bf6d42d2f74f8?s=128&d=identicon&r=PG", "display_name": "John Wilson", "link": "https://stackoverflow.com/users/9916855/john-wilson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 76, "favorite_count": 0, "accepted_answer_id": 52502132, "answer_count": 1, "score": 0, "last_activity_date": 1594024744, "creation_date": 1537889731, "last_edit_date": 1594024744, "question_id": 52501927, "link": "https://stackoverflow.com/questions/52501927/excel-vba-math-just-not-adding-up", "title": "Excel VBA Math just not adding up", "body": "<p>I have a line of code that's working perfectly and getting what I want but I'm a little confused as to how it's doing it??</p>\n\n<p><strong>MyStr = \"MANUFACTURER: LIEBHERR\"</strong></p>\n\n<p>Here's the code and the result:</p>\n\n<p><strong>?VBA.Right(MyStr, VBA.Len(MyStr) - Application.Find(\":\", MyStr)-1) = LIEBHERR</strong></p>\n\n<p>Perfect !!!!!!</p>\n\n<p>So here's my question.</p>\n\n<p><strong>?VBA.Len(MyStr) = 22</strong></p>\n\n<p><strong>?Application.Find(\":\", MyStr)-1 = 12</strong></p>\n\n<p>So combining the two statements above and using the VBA.Right command when I subtract 12 from 22 it looks to me that I should get 10 \nbut.......</p>\n\n<p><strong>?VBA.Len(MyStr) - Application.Find(\":\", MyStr)-1 = 8</strong></p>\n\n<p>Again, I'm getting what I want but I'm confused as to what I'm missing in my math???</p>\n"}, {"tags": ["vba", "charts", "powerpoint"], "comments": [{"owner": {"reputation": 5283, "user_id": 485674, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9720c6f1a3dead1c68d0f42776633d4d?s=128&d=identicon&r=PG", "display_name": "Jon Peltier", "link": "https://stackoverflow.com/users/485674/jon-peltier"}, "edited": false, "score": 0, "creation_date": 1539134072, "post_id": 52501875, "comment_id": 92387627, "body": "There is an <code>Application</code> object in PowerPoint. How are you using it that causes the error?"}, {"owner": {"reputation": 337, "user_id": 4374280, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/100001915578210/picture?type=large", "display_name": "Jason Stallard", "link": "https://stackoverflow.com/users/4374280/jason-stallard"}, "reply_to_user": {"reputation": 5283, "user_id": 485674, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9720c6f1a3dead1c68d0f42776633d4d?s=128&d=identicon&r=PG", "display_name": "Jon Peltier", "link": "https://stackoverflow.com/users/485674/jon-peltier"}, "edited": false, "score": 0, "creation_date": 1539162836, "post_id": 52501875, "comment_id": 92398008, "body": "There is a PowerPoint.Application object in PowerPoint and an Excel.Application object in Excel but no Excel.Application in PowerPoint or PowerPoint.Appication object in Excel."}, {"owner": {"reputation": 5283, "user_id": 485674, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9720c6f1a3dead1c68d0f42776633d4d?s=128&d=identicon&r=PG", "display_name": "Jon Peltier", "link": "https://stackoverflow.com/users/485674/jon-peltier"}, "edited": false, "score": 0, "creation_date": 1539178104, "post_id": 52501875, "comment_id": 92407460, "body": "But from Excel you can refer to the PowerPoint.Application and vice versa. You can set a reference to the PowerPoint object model in your Excel VB Project. You use &#39;Dim pptApp As PowerPoint.Application` to declare a variable that references a PowerPoint instance. You use <code>Set pptApp = CreateObject(, &quot;PowerPoint.Application&quot;)</code> to open PowerPoint from Excel and assign the variable to that PowerPoint instance."}, {"owner": {"reputation": 5283, "user_id": 485674, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9720c6f1a3dead1c68d0f42776633d4d?s=128&d=identicon&r=PG", "display_name": "Jon Peltier", "link": "https://stackoverflow.com/users/485674/jon-peltier"}, "edited": false, "score": 0, "creation_date": 1539178139, "post_id": 52501875, "comment_id": 92407481, "body": "So if you share the code that produces the error, someone might be able to help."}, {"owner": {"reputation": 337, "user_id": 4374280, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/100001915578210/picture?type=large", "display_name": "Jason Stallard", "link": "https://stackoverflow.com/users/4374280/jason-stallard"}, "reply_to_user": {"reputation": 5283, "user_id": 485674, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9720c6f1a3dead1c68d0f42776633d4d?s=128&d=identicon&r=PG", "display_name": "Jon Peltier", "link": "https://stackoverflow.com/users/485674/jon-peltier"}, "edited": false, "score": 0, "creation_date": 1539268185, "post_id": 52501875, "comment_id": 92448251, "body": "I&#39;ve edited the question to include the line <code>Dim sourceXL As excel.Application</code> and also that I have Office 2013."}], "answers": [{"comments": [{"owner": {"reputation": 337, "user_id": 4374280, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/100001915578210/picture?type=large", "display_name": "Jason Stallard", "link": "https://stackoverflow.com/users/4374280/jason-stallard"}, "edited": false, "score": 0, "creation_date": 1539329989, "post_id": 52765333, "comment_id": 92471031, "body": "No; I had not. I was unaware of that requirement. Thank you Jon."}], "tags": [], "owner": {"reputation": 5283, "user_id": 485674, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9720c6f1a3dead1c68d0f42776633d4d?s=128&d=identicon&r=PG", "display_name": "Jon Peltier", "link": "https://stackoverflow.com/users/485674/jon-peltier"}, "is_accepted": true, "score": 1, "last_activity_date": 1539276998, "creation_date": 1539276998, "answer_id": 52765333, "question_id": 52501875, "link": "https://stackoverflow.com/questions/52501875/copy-charts-from-excel-to-powerpoint-using-vba/52765333#52765333", "title": "Copy charts from Excel to PowerPoint using VBA", "body": "<p>Have you set a reference to Excel? In the VBE, go to the Tools menu > References, scroll down to Microsoft Excel, and check the box.</p>\n"}], "owner": {"reputation": 337, "user_id": 4374280, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/100001915578210/picture?type=large", "display_name": "Jason Stallard", "link": "https://stackoverflow.com/users/4374280/jason-stallard"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 37, "favorite_count": 0, "accepted_answer_id": 52765333, "answer_count": 1, "score": 0, "last_activity_date": 1593729927, "creation_date": 1537889572, "last_edit_date": 1593729927, "question_id": 52501875, "link": "https://stackoverflow.com/questions/52501875/copy-charts-from-excel-to-powerpoint-using-vba", "title": "Copy charts from Excel to PowerPoint using VBA", "body": "<p>I have a slide deck that changes it's name daily. The source data is in several statically named Excel 2013 worksheets. It would be neater to run a macro from the PPTM but all the examples I have found for copying charts is from the XLSM side.\nIs there a PowerPoint 2013 equivalent of <code>PowerPoint.Application</code>? <code>Dim sourceXL As excel.Application</code> gives <em>Run-time error '424': Oject required</em> as Excel is not recognised whereas .Application is.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 5, "creation_date": 1537887852, "post_id": 52501286, "comment_id": 91943261, "body": "Please share the code you are using. It&#39;s not immediately clear why you can&#39;t determine or populate the last row."}, {"owner": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 0, "creation_date": 1537888845, "post_id": 52501286, "comment_id": 91943896, "body": "<a href=\"https://www.rondebruin.nl/win/s9/win005.htm\" rel=\"nofollow noreferrer\">rondebruin.nl/win/s9/win005.htm</a>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user10299872"}, "edited": false, "score": 0, "creation_date": 1537889561, "post_id": 52501286, "comment_id": 91944281, "body": "It&#39;s wortyh noting an oddity which someone will probably explain easily. Note the line of code &quot;Range(&quot;D3&quot;).FormulaR1C1 = &quot;=[OrderForm.xlsx]Order!R[15]C[1]&quot;. You would expect to see in D3 the contents of C15 from orderform.xlsx. However when you check the formula it enters it refers to F18??? This is the same for the other ones that copy down???? Not the foggiest why."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1537891326, "post_id": 52501286, "comment_id": 91945325, "body": "I think you mean E18. This is a relative reference so 15 rows down and 1 column to the right. Starting in D3 that takes you to E18."}, {"owner": {"user_type": "does_not_exist", "display_name": "user10299872"}, "edited": false, "score": 0, "creation_date": 1537892210, "post_id": 52501286, "comment_id": 91945826, "body": "SJR, ok so in laymans terms, break that down for me. My understanding is that D3 = R15C1 (A15) from order form.xlsx. But you are right, it is E18, so how come it starts from the cell being populated instead of just pulling through from the correct cell in the original form?. Happy to go to chat if needed. Also worth noting that if these referrences are not relative they don&#39;t populate down, hence being as they are."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1537893489, "post_id": 52501286, "comment_id": 91946513, "body": "R15C1 is A1 and static, but R[15]C[1] is relative - the square brackets signify this. It is relative to where the formula is placed, just as on a worksheet if you use RC notation (I don&#39;t). If you want C15 from a formula in D3 you need r[12]c[-1]."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1537893557, "post_id": 52501286, "comment_id": 91946544, "body": "Can you use @SJR and then I am notified of your response? Also you have an answer below."}, {"owner": {"user_type": "does_not_exist", "display_name": "user10299872"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1537949756, "post_id": 52501286, "comment_id": 91965757, "body": "@SJR yeah no worries. As mentioned previously the below answer doesn&#39;t work."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1537965187, "post_id": 52501286, "comment_id": 91975171, "body": "&quot;Doesn&#39;t work&quot; is not a helpful description."}, {"owner": {"user_type": "does_not_exist", "display_name": "user10299872"}, "edited": false, "score": 0, "creation_date": 1537969019, "post_id": 52501286, "comment_id": 91977713, "body": "I didn&#39;t re type it as I have already explained what it did once, and that was simply nothing. It didn&#39;t highlight the cell, or give any indication of which was the last cell in the column. Very literally it made no change what so ever. I"}], "answers": [{"tags": [], "owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "is_accepted": false, "score": 2, "last_activity_date": 1537888026, "creation_date": 1537888026, "answer_id": 52501391, "question_id": 52501286, "link": "https://stackoverflow.com/questions/52501286/find-last-used-cell-in-column-and-populate-the-cell-following/52501391#52501391", "title": "Find last used cell in column and populate the cell following", "body": "<p><code>Range(\"A\" &amp; LastRow)</code> where <code>LastRow</code> is a variable containing the last row in question (100 in your example)</p>\n\n<p>For the line below it: <code>Range(\"A\" &amp; LastRow + 1)</code></p>\n\n<p>For the sum: <code>Range(\"A\" &amp; LastRow + 1).Formula = \"=SUM(A1:A\" &amp; LastRow &amp; \")\"</code></p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user10299872"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 79, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1554822669, "creation_date": 1537887742, "last_edit_date": 1554822669, "question_id": 52501286, "link": "https://stackoverflow.com/questions/52501286/find-last-used-cell-in-column-and-populate-the-cell-following", "title": "Find last used cell in column and populate the cell following", "body": "<p>I am populating a spreadsheet using VBA. This VBA writes a formula to the last row, but is formatted not to give 0 values, so will only populate if it has anything greater than 1.</p>\n\n<p>Let's say it copies down 100 rows, how do I find the last dynamic row, but then populate the row below it?.</p>\n\n<p>It is a totals line. I can copy down, but can't determine the end row and how to populate it.  </p>\n\n<p>Everything I have found gives me the last row, but it doesn't tell me how to use that info within VBA. </p>\n\n<p>Example-<br>\nIf A1:A100 = 1<br>\nA101 = Total 100</p>\n\n<pre><code>Sub ButtonMacroLatest()\n'Hide alerts\nApplication.DisplayAlerts = False\n'\n' Macro8 Macro\n'\n\n'Save to users device\n    ChDir \"U:\\WINDOWS\"\n    ActiveWorkbook.SaveAs Filename:=\"U:\\WINDOWS\\OrderForm.xlsx\", FileFormat:= _\n        xlOpenXMLWorkbook, CreateBackup:=False\n\n'Create new workbook and populate\n    Workbooks.Add\n    ActiveCell.FormulaR1C1 = \"MSG\"\n    Range(\"B1\").FormulaR1C1 = \"=[OrderForm.xlsx]Order!R[1]C\"\n    Range(\"C1\").FormulaR1C1 = \"=[OrderForm.xlsx]Order!R[1]C[3]\"\n    Range(\"D1\").FormulaR1C1 = \"1400008000\"\n    Range(\"E1\").FormulaR1C1 = \"501346009175\"\n    Range(\"F1\").FormulaR1C1 = \"=TODAY()\"\n    Range(\"G1\").FormulaR1C1 = \"=Now()\"\n    Selection.NumberFormat = \"[$-x-systime]h:mm:ss AM/PM\"\n    Range(\"A2\").FormulaR1C1 = \"HDR\"\n    Range(\"B2\").FormulaR1C1 = \"C\"\n    Range(\"C2\").FormulaR1C1 = \"=[OrderForm.xlsx]Order!R4C2\"\n    Range(\"G2\").FormulaR1C1 = \"=[OrderForm.xlsx]Order!R[1]C[3]\"\n    Range(\"H2\").FormulaR1C1 = \"=[OrderForm.xlsx]Order!R2C4\"\n    Range(\"K2\").FormulaR1C1 = \"STD\"\n    Range(\"L2\").FormulaR1C1 = \"=[OrderForm.xlsx]Order!R5C2\"\n    Range(\"N2\").FormulaR1C1 = \"=[OrderForm.xlsx]Order!R7C2\"\n    Range(\"O2\").FormulaR1C1 = \"=[OrderForm.xlsx]Order!R8C2\"\n    Range(\"Q2\").FormulaR1C1 = \"=[OrderForm.xlsx]Order!R9C2\"\n    Range(\"R2\").FormulaR1C1 = \"=[OrderForm.xlsx]Order!R12C2\"\n    Range(\"A3\").FormulaR1C1 = \"POS\"\n    Range(\"B3\").FormulaR1C1 = \"=Row()*10-20\"\n    Range(\"C3\").FormulaR1C1 = \"=[OrderForm.xlsx]Order!R[15]C[3]\"\n    Range(\"D3\").FormulaR1C1 = \"=[OrderForm.xlsx]Order!R[15]C[1]\"\n    Range(\"E3\").FormulaR1C1 = \"=[OrderForm.xlsx]Order!R[15]C[2]\"\n    Range(\"F3\").FormulaR1C1 = \"=[OrderForm.xlsx]Order!R[15]C[5]\"\n    Range(\"G3\").FormulaR1C1 = \"=[OrderForm.xlsx]Order!R[15]C[7]\"\n    Range(\"H3\").FormulaR1C1 = \"GBP\"\n    Range(\"L3\").FormulaR1C1 = \"TRA\"\n    Range(\"M3\").FormulaR1C1 = \"=COUNTIF(C[-3], \"\"POS\"\")+COUNTIF(C[-3], \"\"HDR\"\")\"\n\n'Fills column to last row of data from Cell C15\n    Dim LastRow As Long\n    LastRow = Cells.Find(What:=\"*\", SearchOrder:=xlByRows, SearchDirection:=xlPrevious).Row\n    Range(\"C15:C\" &amp; LastRow).FillDown\n    Range(\"D15:D\" &amp; LastRow).FillDown\n    Range(\"E15:E\" &amp; LastRow).FillDown\n\n    'Preformat cells to remove 0 value\n    Range(\"A1:Z1000\").Select\n    Range(\"Z1000\").Activate\n    Selection.NumberFormat = \"#;#;\"\n\n'Finds the last non-blank cell on a sheet/range.\nRange(\"C\" &amp; LastRow + 1).Formula = \"=[OrderForm.xlsx]Order!R[15]C[7]\"\n\n'Reinstate alerts\nApplication.DisplayAlerts = True\nMsgBox \"We have saved a copy of your order form to your computer at C:\\X\\X\"\nEnd Sub\n</code></pre>\n\n<p>I have tried the advice given but it doesn't populate anything. Granted I have changed this slightly to reference another sheet.</p>\n\n<p>The rows that copy down C:E are numeric part numbers. The total at the bottom will now be for the number of populated rows. How would I do this?. Sorry to move the goalpost, it only came up in conversation in a meeting I've just come out of.</p>\n"}, {"tags": ["excel", "vba", "internet-explorer", "google-image-search"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1537887176, "post_id": 52500988, "comment_id": 91942793, "body": "Can you provide a complete URL or two and expected results please?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2261597"}, "edited": false, "score": 0, "creation_date": 1537887418, "post_id": 52500988, "comment_id": 91942965, "body": "<i>I keep on getting Error 1004 (Application-defined or Object-defined error)</i> On what line?"}], "answers": [{"tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": false, "score": 0, "last_activity_date": 1537889011, "last_edit_date": 1537889011, "creation_date": 1537888221, "answer_id": 52501440, "question_id": 52500988, "link": "https://stackoverflow.com/questions/52500988/excel-macro-to-pull-google-image-links/52501440#52501440", "title": "Excel Macro To Pull Google Image Links", "body": "<p><strong>Notes on your code:</strong></p>\n\n<p>You need <code>Option Explicit</code> at the top of your code to check on variable declarations  and typos amongst other advantages. There are a number of missing declarations e.g. <code>result</code>, and used ones later e.g. <code>Set IE = CreateObject(\"InternetExplorer.Application\")</code>. You have two different variables (one late bound and one early) both creating IE instances. You only in fact use one.</p>\n\n<p>Your current error  may be down to you trying to work with an object here:\n <code>result = aEle</code> which won't work without the <code>Set</code> keyword to provide the required reference.</p>\n\n<p>Without example URLs and expected output it is difficult to advise on the later loops in your code. You appear to have a duplicate loop over IMG elements but this time with some restrictions. It is likely these loops can be merged.</p>\n\n<hr>\n\n<p><strong>An example:</strong></p>\n\n<p>The following uses an arbitrary concatenation in to pull the <code>img src</code> links in from search results based on <code>A2N0015C3KUU</code>.</p>\n\n<p>It uses a CSS selector combination of <code>#ires img[src]</code> to target elements with <code>img</code> tags and <code>src</code> attributes within the parent element with id <code>ires</code> (search results).</p>\n\n<p>It is to demonstrate the principle of gathering <code>aNodeList</code> of matching elements and writing out to a sheet. The <code>querySelectorAll</code> method applied the CSS selector combination to the <code>HTMLDocument</code> and returns the nodeList. The <code>nodeList</code> is looped along its <code>.Length</code>, with items accessed by index starting at 0.</p>\n\n<pre><code>Option Explicit\nPublic Sub GetInfo()\n    Dim IE As New InternetExplorer\n    With IE\n        .Visible = True\n        .navigate \"https://www.google.com/search?hl=en&amp;biw=1600&amp;bih=796&amp;tbm=isch&amp;sa=1&amp;ei=CTOpW_2jO6nAjwT67rqACw&amp;q=A2N0015C3KUU&amp;oq=1&amp;%20%22&amp;oq=A2N0015C3KUU&amp;gs_l=img.12...0.0..1704...0.0..0.0.0.......1......gws-wiz-img.9wB6WwQJhwA\"\n\n        While .Busy Or .readyState &lt; 4: DoEvents: Wend\n\n        Dim aNodeList As Object, i As Long\n        Set aNodeList = IE.document.querySelectorAll(\"#ires img[src]\")\n        For i = 0 To aNodeList.Length - 1\n            ActiveSheet.Cells(i + 2, 4) = aNodeList.item(i).src\n        Next\n        'Quit '&lt;== Remember to quit application\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 10413906, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a5e196ebf36b5519bfe221f5f3322d0c?s=128&d=identicon&r=PG&f=1", "display_name": "OReed", "link": "https://stackoverflow.com/users/10413906/oreed"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 666, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1537889011, "creation_date": 1537886744, "question_id": 52500988, "link": "https://stackoverflow.com/questions/52500988/excel-macro-to-pull-google-image-links", "title": "Excel Macro To Pull Google Image Links", "body": "<p>The goal is to get images from Google Images that match the part numbers in my database. My code runs, and it pulls up the correct Google pages but refuses to put the links into the spreadsheet. I have tried everything I can think of, but as of now, I keep on getting Error 1004 (Application-defined or Object-defined error).`</p>\n\n<pre><code>Sub SearchBotGoogleImgLink()\nDim objIE As Object\nSet IE = CreateObject(\"InternetExplorer.Application\")\nDim HTMLdoc As HTMLDocument\nDim imgElements As IHTMLElementCollection\nDim imgElement As HTMLImg\nDim aElement As HTMLAnchorElement\nDim n As Integer\nDim i As Integer\nDim url As String\nDim url2 As String\nDim m As Long\nDim lastRow As Long\nDim url3 As String\nDim SearchRow As Long\nDim aEle As HTMLLinkElement\n\n\n    Worksheets(\"Sheet1\").Select\nSearchRow = 1\n\nDo Until IsEmpty(ActiveSheet.Cells(SearchRow, 1))\nSheets(\"Sheet1\").Select\n    Application.StatusBar = SearchRow - 1 &amp; \" of \" &amp; \"4368\" &amp; \" Items Done\"\n        Item = Trim(ActiveSheet.Cells(SearchRow, 1))\n        url = \"https://www.google.com/search?hl=en&amp;biw=1600&amp;bih=796&amp;tbm=isch&amp;sa=1&amp;ei=CTOpW_2jO6nAjwT67rqACw&amp;q=A2N0015C3KUU&amp;oq=\" &amp; Cells(SearchRow, 1) &amp; \"&amp;oq=A2N0015C3KUU&amp;gs_l=img.12...0.0..1704...0.0..0.0.0.......1......gws-wiz-img.9wB6WwQJhwA\"\n        Set objIE = New InternetExplorer\n        objIE.Visible = True\n        objIE.navigate url\n        Do While objIE.Busy = True Or objIE.readyState &lt;&gt; 4: DoEvents: Loop\n        For Each aEle In objIE.document.getElementsByTagName(\"IMG\")\n        result = aEle\n            Sheets(\"Sheet1\").Range(SearchRow &amp; \"C\").Value = result\n            Sheets(\"Sheet1\").Range(SearchRow &amp; \"D\") = aEle.innerHTML\n            Sheets(\"Sheet1\").Range(SearchRow &amp; \"F\").Value = aEle.innerText\n            Debug.Print aEle.innerText\n    Next\nLoop\n'For i = 1 To lastRow\n    'url = \"https://www.google.com/search?hl=en&amp;biw=1600&amp;bih=796&amp;tbm=isch&amp;sa=1&amp;ei=CTOpW_2jO6nAjwT67rqACw&amp;q=A2N0015C3KUU&amp;oq=\" &amp; Cells(SearchRow, 1) &amp; \"&amp;oq=A2N0015C3KUU&amp;gs_l=img.12...0.0..1704...0.0..0.0.0.......1......gws-wiz-img.9wB6WwQJhwA\"\n\n    Set HTMLdoc = objIE.document\n\n    Set imgElements = HTMLdoc.getElementsByTagName(\"IMG\")\n\n    n = 1\n    For Each imgElement In imgElements\n        If InStr(ingElement.src, sImageSearchString) Then\n            If imgElement.ParentNode.nodeName = \"A\" Then\n                Set aElement = imgElement.ParentNode\n                If n = 2 Then\n                    url2 = aElement.href 'imgElement.src\n                    url3 = imgElement.src 'aElement.href\n\n                n = n + 1\n                End If\n            End If\n        End If\n    Next\n\n    Cells(SearchRow, 5) = url2\n\n IE.Quit\n Set IE = Nothing\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "loops"], "comments": [{"owner": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 1, "creation_date": 1537885895, "post_id": 52500654, "comment_id": 91941854, "body": "<a href=\"https://www.rondebruin.nl/win/s9/win005.htm\" rel=\"nofollow noreferrer\">rondebruin.nl/win/s9/win005.htm</a>"}, {"owner": {"reputation": 1156, "user_id": 10315836, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hZjRU.png?s=128&g=1", "display_name": "Valon Miller", "link": "https://stackoverflow.com/users/10315836/valon-miller"}, "edited": false, "score": 1, "creation_date": 1537887795, "post_id": 52500654, "comment_id": 91943215, "body": "When you say &quot;cell B3 has a drop-down list&quot;, are you referring to Data Validation with Type = List? If so, what is the source of that list? Does it reference a range? Can you provide the exact formula from the RefEdit (Source:) box in the Data Validation window?"}, {"owner": {"reputation": 11, "user_id": 3182547, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-xyB5yNNK72w/AAAAAAAAAAI/AAAAAAAAAAA/qy4BKVVlVkY/photo.jpg?sz=128", "display_name": "Kevin Devine", "link": "https://stackoverflow.com/users/3182547/kevin-devine"}, "edited": false, "score": 0, "creation_date": 1537889485, "post_id": 52500654, "comment_id": 91944247, "body": "B3 has a source of hidden cells in a sheet called &quot;DATA_PROPERTY&quot;.  Until I un-hid the sheet, cell B3 would not indicate the source. Now I know B3 is the list of properties in DATA_PROPERTY which is a dynamic list based on Database connection SQL view. I was able to successfully query the number of rows I need, and all I have to do is subtract 1 from LastRow to get the total # of properties."}], "answers": [{"tags": [], "owner": {"reputation": 1529, "user_id": 8422565, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c5b35d27f031eb1bf9dfe43e27fef08?s=128&d=identicon&r=PG&f=1", "display_name": "Kubie", "link": "https://stackoverflow.com/users/8422565/kubie"}, "is_accepted": false, "score": 0, "last_activity_date": 1537886429, "creation_date": 1537886429, "answer_id": 52500877, "question_id": 52500654, "link": "https://stackoverflow.com/questions/52500654/vba-macro-loop-through-activecell-embedded-values/52500877#52500877", "title": "VBA Macro Loop through ActiveCell Embedded Values", "body": "<p>To find last row, also at this link: <a href=\"https://stackoverflow.com/questions/11169445/error-in-finding-last-used-cell-in-vba?rq=1\">Error in finding last used cell in VBA</a></p>\n\n<pre><code>With ThisWorkbook.Worksheets(\"sheet name\")\n    LastRow = .Cells(.Rows.Count, \"A\").End(xlUp).Row ' if col is \"A\"\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 3182547, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-xyB5yNNK72w/AAAAAAAAAAI/AAAAAAAAAAA/qy4BKVVlVkY/photo.jpg?sz=128", "display_name": "Kevin Devine", "link": "https://stackoverflow.com/users/3182547/kevin-devine"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 38, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1537886429, "creation_date": 1537885797, "question_id": 52500654, "link": "https://stackoverflow.com/questions/52500654/vba-macro-loop-through-activecell-embedded-values", "title": "VBA Macro Loop through ActiveCell Embedded Values", "body": "<p>I am trying to find a better solution to more dynamically loop through a cell with a Dynamic list of values from a Database Connection.  The cell \"B3\" has a drop-down list of the items I want to loop through, and when a particular item is selected it refreshes the worksheet to reflect that items values (Select * from Table where Item = X). The number of items changes per quarter, as the items are the list of properties we appraise. Sometimes there are 50, sometimes 5 items.  How do I modify this code so I do not have to go into the Macro and update the For i = 1 to 49 loop? I want is so it just can either query the item list and find the number of items or does a Do While loop and loops through all the values until the last one.</p>\n\n<pre><code>Dim strfindrow As String\nFor i = 1 To 49\n    Range(\"B3\").Select\n    strfindrow = \"=DATA_PROPERTY!R[\" + Trim(Str(i - 2)) + \"]C[-1]\"\n    ActiveCell.FormulaR1C1 = strfindrow\n    Range(\"B3\").Select\n    ActiveWindow.SelectedSheets.PrintOut Copies:=1\nNext\nEnd Sub\n</code></pre>\n"}]