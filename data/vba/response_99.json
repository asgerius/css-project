[{"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 7, "creation_date": 1480548879, "post_id": 40900023, "comment_id": 69014150, "body": "This is a great opportunity to learn VBA - Turn on the macro recorder. Then, do a find for &quot;Medium&quot;, and add 10 rows below.  Then, do it again.  Then, stop the recorder and you&#39;ll have a skeleton of what to do. Have a think on that, and check out <a href=\"http://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba-macros\">how to avoid using <code>.Select</code></a> and try your best.  You can then try and set up a simple loop (google something like &quot;VBA loops&quot; or &quot;VBA for loop&quot;). Then, come back and let us know where you&#39;re stuck! (showing the code, of course) :D"}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 6860409, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d9bd97dca544ce020fe73d1edf31292f?s=128&d=identicon&r=PG&f=1", "display_name": "Dylan Kindler", "link": "https://stackoverflow.com/users/6860409/dylan-kindler"}, "edited": false, "score": 0, "creation_date": 1481079559, "post_id": 40942332, "comment_id": 69225374, "body": "This is awesome, thanks so much! The looping is what always trips me up. Thank you so much!!!"}, {"owner": {"reputation": 21753, "user_id": 3978545, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jmQsw.png?s=128&g=1", "display_name": "Wolfie", "link": "https://stackoverflow.com/users/3978545/wolfie"}, "reply_to_user": {"reputation": 11, "user_id": 6860409, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d9bd97dca544ce020fe73d1edf31292f?s=128&d=identicon&r=PG&f=1", "display_name": "Dylan Kindler", "link": "https://stackoverflow.com/users/6860409/dylan-kindler"}, "edited": false, "score": 0, "creation_date": 1481100046, "post_id": 40942332, "comment_id": 69233005, "body": "No priblem. Please accept this as the answer if it did the job!"}, {"owner": {"reputation": 21753, "user_id": 3978545, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jmQsw.png?s=128&g=1", "display_name": "Wolfie", "link": "https://stackoverflow.com/users/3978545/wolfie"}, "reply_to_user": {"reputation": 11, "user_id": 6860409, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d9bd97dca544ce020fe73d1edf31292f?s=128&d=identicon&r=PG&f=1", "display_name": "Dylan Kindler", "link": "https://stackoverflow.com/users/6860409/dylan-kindler"}, "edited": false, "score": 0, "creation_date": 1481100144, "post_id": 40942332, "comment_id": 69233073, "body": "@DylanKindler No problem. Please accept this as the answer if it did the job!"}, {"owner": {"reputation": 11, "user_id": 6860409, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d9bd97dca544ce020fe73d1edf31292f?s=128&d=identicon&r=PG&f=1", "display_name": "Dylan Kindler", "link": "https://stackoverflow.com/users/6860409/dylan-kindler"}, "edited": false, "score": 0, "creation_date": 1481219249, "post_id": 40942332, "comment_id": 69299021, "body": "How do I do that?"}, {"owner": {"reputation": 21753, "user_id": 3978545, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jmQsw.png?s=128&g=1", "display_name": "Wolfie", "link": "https://stackoverflow.com/users/3978545/wolfie"}, "reply_to_user": {"reputation": 11, "user_id": 6860409, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d9bd97dca544ce020fe73d1edf31292f?s=128&d=identicon&r=PG&f=1", "display_name": "Dylan Kindler", "link": "https://stackoverflow.com/users/6860409/dylan-kindler"}, "edited": false, "score": 0, "creation_date": 1481273903, "post_id": 40942332, "comment_id": 69319800, "body": "@DylanKindler Click the tick (check mark) on left under the vote arrows"}], "tags": [], "owner": {"reputation": 21753, "user_id": 3978545, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jmQsw.png?s=128&g=1", "display_name": "Wolfie", "link": "https://stackoverflow.com/users/3978545/wolfie"}, "is_accepted": false, "score": 1, "last_activity_date": 1480720835, "creation_date": 1480720835, "answer_id": 40942332, "question_id": 40900023, "link": "https://stackoverflow.com/questions/40900023/add-multiple-rows-in-excel-starting-from-same-cell-value-vba/40942332#40942332", "title": "Add multiple rows in Excel starting from same cell value VBA", "body": "<p>You can easily do this with VBA. To get to the VBA editor, press ALT+F11 when in Excel. The create a new module (Insert>Module) and paste the following code:</p>\n\n<pre><code>Sub insertRows()\n\n    Dim vcell As Range\n    Dim i As Integer\n    Dim j As Integer\n    Dim lastRow As Integer\n\n    ' Use WITH for shorthand (everything starting \".\")\n    ' because all cell references are to current sheet\n    With ThisWorkbook.ActiveSheet\n\n        ' Cycle through each cell in the used range of column 1,\n        ' start by getting the last row\n        lastRow = .UsedRange.Rows.Count\n\n        ' Go bottom to top as inserting new rows pushes everything down\n        For i = lastRow To 1 Step -1\n\n            ' Set cell as row i, column 1\n            Set vcell = .Cells(i, 1)\n\n            ' If it is a cell with value LARGE then do some action\n            If vcell.Value = \"Large\" Then\n\n                ' loop for desired number of times, e.g. 3\n                For j = 1 To 3\n\n                    ' Insert a new row above VCELL\n                    vcell.EntireRow.Insert\n\n                Next j\n\n            End If\n\n        Next i\n\n    End With\n\nEnd Sub\n</code></pre>\n\n<p>To Run the code press F5 or click the green play button.</p>\n\n<p>I've commented the code (all lines starting with an apostrophe) for explanation. This code cycles up through the column, and when a cell value is \"Large\", 3 rows are inserted. Of course in your example, change this to 10 and you can later change \"Large\" to anything you wish.</p>\n\n<p>Below is the result: </p>\n\n<p><a href=\"https://i.stack.imgur.com/PBBH4.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/PBBH4.png\" alt=\"Before and after for the column\"></a></p>\n\n<p>Hope this helps</p>\n"}], "owner": {"reputation": 11, "user_id": 6860409, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d9bd97dca544ce020fe73d1edf31292f?s=128&d=identicon&r=PG&f=1", "display_name": "Dylan Kindler", "link": "https://stackoverflow.com/users/6860409/dylan-kindler"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1004, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1480720835, "creation_date": 1480547928, "last_edit_date": 1480548323, "question_id": 40900023, "link": "https://stackoverflow.com/questions/40900023/add-multiple-rows-in-excel-starting-from-same-cell-value-vba", "title": "Add multiple rows in Excel starting from same cell value VBA", "body": "<p>I have a sheet that has multiple blocks of recurring rows. Something like this:</p>\n\n<pre><code>SALAD\nSmall\nMedium\nLarge\n\nFRIES\nSmall\nMedium\nLarge\n\nBURGERS\nSmall\nMedium\nLarge\n</code></pre>\n\n<p>How can I add, say, 10 rows in between \"Medium\" and \"Large\" in each section?</p>\n\n<p>My sheet has hundreds of these types of sections, so I can't do it manually. </p>\n\n<p>If you want to just add one row, I can use the control + F, search \"Large,\" select all, and add a row. But I'd have to do that each time for each row I want to add, 10 times in total.</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 2, "last_activity_date": 1480548068, "creation_date": 1480548068, "answer_id": 40900049, "question_id": 40899975, "link": "https://stackoverflow.com/questions/40899975/excel-adds-empty-row-at-end-of-output-file/40900049#40900049", "title": "Excel adds empty row at end of output file", "body": "<p>For writing the last line (when RowNdx=EndRow) use </p>\n\n<pre><code>Print #FNum, WholeLine;  '&lt;&lt;&lt; note the semicolon\n</code></pre>\n"}], "owner": {"reputation": 105, "user_id": 7143169, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/20b147e4c754fea37adf92aec7a59374?s=128&d=identicon&r=PG&f=1", "display_name": "Schbabako", "link": "https://stackoverflow.com/users/7143169/schbabako"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 38, "favorite_count": 0, "accepted_answer_id": 40900049, "answer_count": 1, "score": 0, "last_activity_date": 1480548068, "creation_date": 1480547598, "question_id": 40899975, "link": "https://stackoverflow.com/questions/40899975/excel-adds-empty-row-at-end-of-output-file", "title": "Excel adds empty row at end of output file", "body": "<p>I have a small but really annoying problem. I have written a code that analyses a certain amount of data and plots me the results in cell format. In the end the result shall be converted into a file format. This is my export to file:</p>\n\n<pre><code>Sub ExportToTextFile()\n\nDim WholeLine As String\nDim FNum As Integer\nDim sav_dir As String\nDim file_dir As String\nDim fsobj, fsfolder\nDim RowNdx As Long\nDim ColNdx As Integer\nDim StartRow As Long\nDim EndRow As Long\nDim StartCol As Integer\nDim EndCol As Integer\nDim CellValue As String\nsav_dir = file_path\n\nSet fsobj = CreateObject(\"Scripting.FileSystemObject\")\nIf Not fsobj.FolderExists(sav_dir) Then\n       fsobj.CreateFolder sav_dir\nEnd If\nSheets(\"Map_TXT\").Select\n\nRows(\"217:1320\").Select\nApplication.CutCopyMode = False\nSelection.Delete\n\nFNum = FreeFile()\n    StartRow = .Cells(1).Row\n    StartCol = .Cells(1).Column\n    EndRow = 216\n    EndCol = .Cells(.Cells.count).Column\nEnd With\n\nOpen file_dir For Append Access Write As #FNum\nFor RowNdx = StartRow To EndRow\n    WholeLine = \"\"\n    For ColNdx = StartCol To EndCol\n\n        If Cells(RowNdx, ColNdx).Value = \"\" Then\n            CellValue = Chr(0) 'Chr(34) &amp; Chr(34)\n        Else\n            CellValue = Cells(RowNdx, ColNdx).Value\n        End If\n        WholeLine = WholeLine &amp; CellValue\n    Next ColNdx\n    WholeLine = Left(WholeLine, Len(WholeLine))\n    Print #FNum, WholeLine\nNext RowNdx\nClose #FNum\nEndMacro:\nOn Error \nEnd Sub\n</code></pre>\n\n<p>So no matter what i do, this functions adds an empty row at the end of my output file. This empty row is row number 217 and i have to get rid of this last row.\nCan someone provide me with a solution on how to delete the last row in that file?\nThank  you in advance</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 28755, "user_id": 5047996, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/la3kD.png?s=128&g=1", "display_name": "aschipfl", "link": "https://stackoverflow.com/users/5047996/aschipfl"}, "edited": false, "score": 1, "creation_date": 1480550080, "post_id": 40899944, "comment_id": 69014515, "body": "&quot;I need code&quot; is not a question! Please read at least the entire <a href=\"http://stackoverflow.com/tour\">tour page</a> to learn how to use this site!"}], "answers": [{"tags": [], "owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "is_accepted": false, "score": 0, "last_activity_date": 1480892187, "creation_date": 1480892187, "answer_id": 40964710, "question_id": 40899944, "link": "https://stackoverflow.com/questions/40899944/excel-vba-code-to-copy-a-row-if-an-uppercase-or-a-lowercase-in-a-column-to-next/40964710#40964710", "title": "Excel VBA code to copy a row if an uppercase or a lowercase in a column to next sheet", "body": "<p>Something like this shoudl do it.</p>\n\n<pre><code>Sub CopyData()\nDim Rng As Range, cell As Range\nDim rw As Long\nSet Rng = Worksheets(\"Sheet1\").Range(\"Z:Z\")\nrw = 1\nFor Each cell In Rng\nIf LCase(cell.Value) = \"X\" Then\nWorksheets(\"Sheet2\").Cells(rw, \"A\") = cell.Offset(0, -1)\nrw = rw + 1\nEnd If\nNext\nEnd Sub\n</code></pre>\n\n<p>However, I don't know what this means:\n\"when on another row a lower case x is present in the same column.\"</p>\n\n<p>What is the logic???</p>\n"}], "owner": {"reputation": 1, "user_id": 7233481, "user_type": "registered", "profile_image": "https://graph.facebook.com/10210998677754113/picture?type=large", "display_name": "Jymie Calarco", "link": "https://stackoverflow.com/users/7233481/jymie-calarco"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 113, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1480892187, "creation_date": 1480547425, "last_edit_date": 1531164843, "question_id": 40899944, "link": "https://stackoverflow.com/questions/40899944/excel-vba-code-to-copy-a-row-if-an-uppercase-or-a-lowercase-in-a-column-to-next", "title": "Excel VBA code to copy a row if an uppercase or a lowercase in a column to next sheet", "body": "<p>I want to copy a row to another sheet (sheet4) when in column Z a upper case X is present and when on another row a lower case x is present in the same column. Thus automatically copying both rows to sheet4.</p>\n\n<p>To further explain </p>\n\n<p>I need the VBA code to pick up both letters throughout the current sheet in just column Z </p>\n\n<p>Thanks</p>\n"}, {"tags": ["vba", "ms-word"], "answers": [{"tags": [], "owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "is_accepted": true, "score": 1, "last_activity_date": 1480550169, "creation_date": 1480550169, "answer_id": 40900387, "question_id": 40899921, "link": "https://stackoverflow.com/questions/40899921/vba-word-footer-shapes-collection-contains-both-footer-and-header-shapes/40900387#40900387", "title": "VBA (Word) - Footer shapes collection contains both footer and header shapes", "body": "<p>Try this instead:</p>\n\n<pre><code>For Each shp In ActiveDocument.Sections(1).Footers(1).Range.ShapeRange\n</code></pre>\n"}], "owner": {"reputation": 2031, "user_id": 6097926, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/187bc2674bbdf7651e7137e1427b9bd6?s=128&d=identicon&r=PG&f=1", "display_name": "Ryszard J\u0119draszyk", "link": "https://stackoverflow.com/users/6097926/ryszard-j%c4%99draszyk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 387, "favorite_count": 0, "accepted_answer_id": 40900387, "answer_count": 1, "score": 0, "last_activity_date": 1480550169, "creation_date": 1480547278, "question_id": 40899921, "link": "https://stackoverflow.com/questions/40899921/vba-word-footer-shapes-collection-contains-both-footer-and-header-shapes", "title": "VBA (Word) - Footer shapes collection contains both footer and header shapes", "body": "<p>My document has only one header / footer type - <code>wdHeaderFooterPrimary</code>, constant = 1. I try to interact with shapes from footer, but collection contains also shapes from header.</p>\n\n<p>I could distinguish which one is from header and which one from footer by <code>.top</code> property, but for so many elements and thousands of files it would take ages.</p>\n\n<p>Is there any other way I can refer only to footer shapes?</p>\n\n<pre><code>Dim shp as Object\n\nFor Each shp in ActiveDocument.Sections(1).Footers(1).Shapes\n    debug.print shp.name\nNext shp\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2953, "user_id": 2801253, "user_type": "registered", "profile_image": "https://graph.facebook.com/1332362525/picture?type=large", "display_name": "Mark Fitzgerald", "link": "https://stackoverflow.com/users/2801253/mark-fitzgerald"}, "edited": false, "score": 0, "creation_date": 1480547314, "post_id": 40899623, "comment_id": 69013591, "body": "Does the sheet have anything on it?  You can&#39;t print a blank sheet."}, {"owner": {"reputation": 13, "user_id": 6492392, "user_type": "registered", "accept_rate": 25, "profile_image": "https://graph.facebook.com/1015696255210208/picture?type=large", "display_name": "Collin Dando", "link": "https://stackoverflow.com/users/6492392/collin-dando"}, "reply_to_user": {"reputation": 2953, "user_id": 2801253, "user_type": "registered", "profile_image": "https://graph.facebook.com/1332362525/picture?type=large", "display_name": "Mark Fitzgerald", "link": "https://stackoverflow.com/users/2801253/mark-fitzgerald"}, "edited": false, "score": 0, "creation_date": 1480548876, "post_id": 40899623, "comment_id": 69014148, "body": "I have changed my question to reflect that there is data on the sheet"}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1480549875, "post_id": 40899623, "comment_id": 69014458, "body": "Does the file actually print?"}, {"owner": {"reputation": 2953, "user_id": 2801253, "user_type": "registered", "profile_image": "https://graph.facebook.com/1332362525/picture?type=large", "display_name": "Mark Fitzgerald", "link": "https://stackoverflow.com/users/2801253/mark-fitzgerald"}, "edited": false, "score": 0, "creation_date": 1480551364, "post_id": 40899623, "comment_id": 69014904, "body": "In Excel 2010, Workbook_BeforePrint does fire on preview but not in 2016.  Undocumented feature maybe."}, {"owner": {"reputation": 13, "user_id": 6492392, "user_type": "registered", "accept_rate": 25, "profile_image": "https://graph.facebook.com/1015696255210208/picture?type=large", "display_name": "Collin Dando", "link": "https://stackoverflow.com/users/6492392/collin-dando"}, "edited": false, "score": 0, "creation_date": 1480551557, "post_id": 40899623, "comment_id": 69014962, "body": "Thank you, Mark &amp; A.S.H. !"}], "answers": [{"tags": [], "owner": {"reputation": 32, "user_id": 2595265, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mRoIK.jpg?s=128&g=1", "display_name": "OzRoz", "link": "https://stackoverflow.com/users/2595265/ozroz"}, "is_accepted": false, "score": 0, "last_activity_date": 1486680209, "creation_date": 1486680209, "answer_id": 42148298, "question_id": 40899623, "link": "https://stackoverflow.com/questions/40899623/workbook-beforeprint-not-firing/42148298#42148298", "title": "&quot;Workbook BeforePrint&quot; Not Firing", "body": "<p>Excel 2013 and later doesn't run Workbook_BeforePrint on Print Preview. However, you can get it to run for testing by adding the 'Print Preview Full Screen' icon to your QAT (Quick Access Toolbar)<a href=\"https://i.stack.imgur.com/he065.jpg\" rel=\"nofollow noreferrer\">see screenshot</a></p>\n"}], "owner": {"reputation": 13, "user_id": 6492392, "user_type": "registered", "accept_rate": 25, "profile_image": "https://graph.facebook.com/1015696255210208/picture?type=large", "display_name": "Collin Dando", "link": "https://stackoverflow.com/users/6492392/collin-dando"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1175, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1492146213, "creation_date": 1480545860, "last_edit_date": 1492146213, "question_id": 40899623, "link": "https://stackoverflow.com/questions/40899623/workbook-beforeprint-not-firing", "title": "&quot;Workbook BeforePrint&quot; Not Firing", "body": "<p>UPDATED:</p>\n\n<p>Of all the things that I tried, printing this simplified workbook was not one of them. The BeforePrint does fire, however, only after the preview pane and clicking print does the message box appear.</p>\n\n<p>It was my understanding that one should be able to preview the change before printing actually occurs. Am I wrong?</p>\n\n<hr>\n\n<p>I am using Excel 2016. I am trying to get my header to obtain the value in A1 and have found examples of doing this. However, I have not had any luck in getting the BeforePrint Event to work.</p>\n\n<p>My Original Code (The way I wanted it)</p>\n\n<pre><code>Private Sub Workbook_BeforePrint(Cancel As Boolean)\n    ActiveSheet.PageSetup.CenterHeader = Range(\"A1\").Value\nEnd Sub\n</code></pre>\n\n<p>Troubleshooting that I have tried:</p>\n\n<ol>\n<li>Started a brand new workbook so that nothing could be wrong with the one that I was attempting to add this function to.</li>\n<li>Just make a simple message box appear instead of doing something more complicated.</li>\n<li>Attempted to run other events to make sure I had gotten the thought process of events correct.</li>\n<li>Design Mode is not on</li>\n<li>Macros Security is set to allow Macros</li>\n<li>The sheet has some random letters in one of the cells to allow for editing (Updated per comments)</li>\n</ol>\n\n<p>Below are the three events that I have attempted to troubleshoot my issue. The \"BeforeSave\" &amp; \"Open\" Events both work fine.</p>\n\n<pre><code>Private Sub Workbook_BeforePrint(Cancel As Boolean)\n\n    MsgBox \"Printing... Maybe...\"\n\nEnd Sub\n\nPrivate Sub Workbook_BeforeSave(ByVal SaveAsUI As Boolean, Cancel As Boolean)\n\n    MsgBox \"Saving...\"\n\nEnd Sub\n\nPrivate Sub Workbook_Open()\n\n    Debug.Print \"Running Open\"\n    MsgBox \"Welcome\"\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "is_accepted": false, "score": 0, "last_activity_date": 1480544686, "creation_date": 1480544686, "answer_id": 40899373, "question_id": 40899132, "link": "https://stackoverflow.com/questions/40899132/copy-form-external-workbook-xldown-into-current-workbook/40899373#40899373", "title": "Copy form External Workbook XLDOWN into Current workbook", "body": "<p>Give this a shot. There were a few issues in the code you provided that should be clear after seeing the refactored code below.</p>\n\n<pre><code>Dim wbSource As Workbook, wbDest As Workbook\nDim wsSource As Worksheet, wsDest As Worksheet\nDim rngSource As Range, rngDest As Range\n\n'set up source workbook, sheet, range\nSet wbSource = Workbooks.Open(\"G:\\GAGC\\Accounting\\Payroll\\Payroll\\Analysis Macro Upload\\DDR.xlsx\", , True)\nSet wsSource = wbSource.Worksheets(\"Everett\")\nSet rngSource = wsSource.Range(wsSource.Range(\"A9\"), wsSource.Range(\"A9\").End(xlDown))\n\n'set up destination workbook, sheet, range\nSet wbDest = ThisWorkbook\nSet wsDest = wbDest.Worksheets(\"2016\")\nSet rngDest = wsDest.Range(\"A4\") 'Destination Cell\n\nrngSource.Copy Destination:=rngDest\n\nwbSource.Close False\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 7233296, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab19c24ef2778a96071fed5459d42fcd?s=128&d=identicon&r=PG&f=1", "display_name": "Mitch", "link": "https://stackoverflow.com/users/7233296/mitch"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 139, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1480544686, "creation_date": 1480543703, "last_edit_date": 1480544351, "question_id": 40899132, "link": "https://stackoverflow.com/questions/40899132/copy-form-external-workbook-xldown-into-current-workbook", "title": "Copy form External Workbook XLDOWN into Current workbook", "body": "<p>I am trying to copy all the results from cell \"A9\" tell the end of the data using XLDOWN from  the the file named \"DDR\" &amp; tab named \"everett\" and paste it back into the workbook im currently using. </p>\n\n<p>Any help will be greatly appreciated </p>\n\n<pre><code>Sub XLDOWN1()\n'\n' XLDOWN1 Macro\n'\n\n'\n    Dim wbSource As Workbook, wbDest As Workbook\n    Dim wsSource As Worksheet, wsDest As Worksheet\n    Dim rngSource As Range, rngDest As Range\n\n    Set wbSource = Workbooks.Open(\"G:\\GAGC\\Accounting\\Payroll\\Payroll\\Analysis Macro Upload\\DDR.xlsx\", , True)\n    Set wsSource = wbSource.Worksheets(\"Everett\")\n\n\n    ws.Range(\"A9\", Range(\"A9\").End(xlDown)).Select\n    Selection.Copy\n\n\n\n    Set rngSource = wsSource.Range(\"A9\").Range(Selection, Selection.End(xlDown))\n    Set wbDest = ThisWorkbook\n    Set wsDest = wbDest.Worksheets(\"2016\")\n    Set rngDest = wsDest.Range(\"A4\") 'Destination Cell\n\n    rngDest.Value = rngSource.Value 'Copies values over only\n\n    wbSource.Close (False) 'Close without saving changes\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 185, "user_id": 7227935, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/9649a2d89a247a414031a239212d589c?s=128&d=identicon&r=PG&f=1", "display_name": "kumquatwhat", "link": "https://stackoverflow.com/users/7227935/kumquatwhat"}, "reply_to_user": {"reputation": 6762, "user_id": 845655, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/ySyzL.jpg?s=128&g=1", "display_name": "DeanOC", "link": "https://stackoverflow.com/users/845655/deanoc"}, "edited": false, "score": 0, "creation_date": 1480542527, "post_id": 40898778, "comment_id": 69011458, "body": "lm is &quot;May&quot;, j is 22, and kk is &quot;02&quot;.  Every single sheet thus far has followed this format.."}, {"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 0, "creation_date": 1480542536, "post_id": 40898778, "comment_id": 69011465, "body": "Can you post the whole code please? It sounds like a context issue whereby the right workbook isn&#39;t active or something."}, {"owner": {"reputation": 6762, "user_id": 845655, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/ySyzL.jpg?s=128&g=1", "display_name": "DeanOC", "link": "https://stackoverflow.com/users/845655/deanoc"}, "edited": false, "score": 1, "creation_date": 1480542620, "post_id": 40898778, "comment_id": 69011508, "body": "Given that lm is &quot;May&quot;, is it possible that this sheet already exists?"}, {"owner": {"reputation": 185, "user_id": 7227935, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/9649a2d89a247a414031a239212d589c?s=128&d=identicon&r=PG&f=1", "display_name": "kumquatwhat", "link": "https://stackoverflow.com/users/7227935/kumquatwhat"}, "edited": false, "score": 0, "creation_date": 1480542779, "post_id": 40898778, "comment_id": 69011599, "body": "At the end of the code I delete the first sheet; prior to that I was running into memory issues.  The only sheet remaining is called &quot;Results&quot;."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1480542955, "post_id": 40898778, "comment_id": 69011676, "body": "did you reach the max capacity for worksheets in a workbook?"}, {"owner": {"reputation": 185, "user_id": 7227935, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/9649a2d89a247a414031a239212d589c?s=128&d=identicon&r=PG&f=1", "display_name": "kumquatwhat", "link": "https://stackoverflow.com/users/7227935/kumquatwhat"}, "edited": false, "score": 0, "creation_date": 1480543071, "post_id": 40898778, "comment_id": 69011745, "body": "At first, yeah, but I ran into problems in February when I did that.  Once I started deleting each sheet as I finished with it, I haven&#39;t heard from that error since.  Does a deleted sheet still hold memory somehow?"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1480543156, "post_id": 40898778, "comment_id": 69011770, "body": "you can also reduce the <code>Select Case</code> with two statements. <code>mmm = Format(i &amp; &quot;&#47;1&#47;2016&quot;,&quot;mmm&quot;)</code> and <code>lm = Format(i &amp; &quot;&#47;1&#47;2016&quot;,&quot;mmmm&quot;)</code>"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1480543923, "post_id": 40898778, "comment_id": 69012126, "body": "@ScottHoltzman - or <code>Format(&quot;1&#47;&quot; &amp; i &amp; &quot;&#47;2016&quot;,&quot;mmm&quot;)</code> etc if the OP lives in a civilised country that uses dd/mm/yyyy format dates!  ;)"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1480545076, "post_id": 40898778, "comment_id": 69012635, "body": "FWIW - The code ran happily for me.  Is it possible that there is something in the code that does the actual processing of the data that might be making some other workbook the Active one?"}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 1, "creation_date": 1480546062, "post_id": 40898778, "comment_id": 69013088, "body": "can&#39;t you use the same sheet all the time by just clearing it (<code>Sheets(1).UsedRange.ClearContents</code>), filling&amp;sorting it and, once you&#39;re done  with it, iterate with next one?"}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 1, "creation_date": 1480546110, "post_id": 40898778, "comment_id": 69013112, "body": "Since at each iteration you add a sheet then delete it, why dont you try to use the same sheet but with deleting its content and then filling it again with the new content? (EDIT, just noticed the same comment by  user3598756)."}, {"owner": {"reputation": 185, "user_id": 7227935, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/9649a2d89a247a414031a239212d589c?s=128&d=identicon&r=PG&f=1", "display_name": "kumquatwhat", "link": "https://stackoverflow.com/users/7227935/kumquatwhat"}, "edited": false, "score": 0, "creation_date": 1480547226, "post_id": 40898778, "comment_id": 69013549, "body": "I don&#39;t think the other workbook is active, because the code still manages to input a new sheet, and then that becomes active - it&#39;s just renaming it that it&#39;s having trouble with.  As to just recyling one sheet...well, I dunno&#39;, maybe.  I will give it a shot."}, {"owner": {"reputation": 392, "user_id": 4888843, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ef82d1015fe3787231add5f346bcb5b?s=128&d=identicon&r=PG&f=1", "display_name": "Hrothgar", "link": "https://stackoverflow.com/users/4888843/hrothgar"}, "edited": false, "score": 1, "creation_date": 1480556100, "post_id": 40898778, "comment_id": 69016108, "body": "If you watch the codenames of your sheets, you will find that as they are created and deleted, the codenames continue to increment.  When you hit something around 8 or 9 thousand, it thunders in.  I found this while developing a macro that reads about 2400 files, and creates a number of sheets.  After about 10 passes, it started to fail.  I had to close the codebook and open it again to reset the codename counter.  If anyone knows how to do it in code, I&#39;d sure love to hear about it."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 1, "creation_date": 1480566190, "post_id": 40898778, "comment_id": 69018532, "body": "Not related to your issue, but not all months have 31 days.  You can use <code>If Month(DateSerial(Year(Now), i, j)) = i Then &#39;...</code> to check if the day is valid for the month (yes, it works with leap years)."}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "reply_to_user": {"reputation": 392, "user_id": 4888843, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ef82d1015fe3787231add5f346bcb5b?s=128&d=identicon&r=PG&f=1", "display_name": "Hrothgar", "link": "https://stackoverflow.com/users/4888843/hrothgar"}, "edited": false, "score": 0, "creation_date": 1480608393, "post_id": 40898778, "comment_id": 69042691, "body": "@Hrothgar - I&#39;ve never tested that, so just did.  It fell over at <code>Sheet10915</code>, although I&#39;ve no idea of the significance of the number.  <a href=\"https://support.office.com/en-gb/article/Excel-specifications-and-limits-1672b34d-7043-467e-8e27-269d656771c3#bmworksheetworkbook\" rel=\"nofollow noreferrer\">support.office.com/en-gb/article/&hellip;</a>"}, {"owner": {"reputation": 185, "user_id": 7227935, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/9649a2d89a247a414031a239212d589c?s=128&d=identicon&r=PG&f=1", "display_name": "kumquatwhat", "link": "https://stackoverflow.com/users/7227935/kumquatwhat"}, "edited": false, "score": 0, "creation_date": 1480688586, "post_id": 40898778, "comment_id": 69079816, "body": "Renaming the sheet worked.  Turns out there were other issues in the code, so my results are completely incorrect, but at least it runs.  Thanks everybody!"}], "owner": {"reputation": 185, "user_id": 7227935, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/9649a2d89a247a414031a239212d589c?s=128&d=identicon&r=PG&f=1", "display_name": "kumquatwhat", "link": "https://stackoverflow.com/users/7227935/kumquatwhat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 154, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1480607137, "creation_date": 1480542223, "last_edit_date": 1480607137, "question_id": 40898778, "link": "https://stackoverflow.com/questions/40898778/sheets-add-suddenly-started-giving-error-1004-after-working-7000-times", "title": "sheets.add suddenly started giving error 1004 after working 7000 times", "body": "<p>I have code that's supposed to open a text file of data, record certain values from it, record them, close it, and open the next file.  There is one file for every hour of every day of the year thus far, and in order to keep track of these worksheets, I've been renaming them.  </p>\n\n<p>I got to around the end of May when I got an error 1004 \"Method 'Add' of object 'Sheets' failed\", even though it's already worked roughly 7000 times.  </p>\n\n<p>The line in question reads:</p>\n\n<pre><code>Sheets.Add(Before:=Sheets(1)).Name = lm &amp; \" \" &amp; j &amp; \" Hour \" &amp; kk\n</code></pre>\n\n<p>What could be going wrong here?  I'm new to VBA, so it could easily be something I overlooked, but why only now is it bugging out?  </p>\n\n<p>(last semi-related note: just signed up to ask this question specifically; if I've posted anything incorrectly or in a bad format, I apologise!)</p>\n\n<p>edit: in case it helps, the code upt o that point is: </p>\n\n<pre><code>For i = 1 To 12                                     'for all months\n  For j = 1 To 31                                 'for all days\n    For k = 0 To 23                             'for all hours\n      Select Case i\n        Case \"1\"\n          mmm = \"Jan\"\n          lm = \"January\"\n        Case \"2\"\n          mmm = \"Feb\"\n          lm = \"February\"\n        Case \"3\"\n          mmm = \"Mar\"\n          lm = \"March\"\n        Case \"4\"\n          mmm = \"Apr\"\n          lm = \"April\"\n        Case \"5\"\n          mmm = \"May\"\n          lm = \"May\"\n        Case \"6\"\n          mmm = \"Jun\"\n          lm = \"June\"\n        Case \"7\"\n          mmm = \"Jul\"\n          lm = \"July\"\n        Case \"8\"\n          mmm = \"Aug\"\n          lm = \"August\"\n        Case \"9\"\n          mmm = \"Sep\"\n          lm = \"September\"\n        Case \"10\"\n          mmm = \"Oct\"\n          lm = \"October\"\n        Case \"11\"\n          mmm = \"Nov\"\n          lm = \"November\"\n        Case \"12\"\n          mmm = \"Dec\"\n          lm = \"December\"\n      End Select\n\n      If i &lt; 10 Then\n        ii = \"0\" &amp; i\n      Else\n        ii = i\n      End If\n      If j &lt; 10 Then\n        jj = \"0\" &amp; j\n      Else\n        jj = j\n      End If\n      If k &lt; 10 Then\n        kk = \"0\" &amp; k\n      Else\n        kk = k\n      End If\n\n      Sheets.Add(Before:=Sheets(1)).Name = lm &amp; \" \" &amp; j &amp; \" Hour \" &amp; kk\n\n 'the code after this just opens up the text file at a path determined by \n 'the month, day, and hour, sorts data.  then comes: \n\n      Sheets(1).Delete\n    Next k\n  Next j\nNext i\n</code></pre>\n"}, {"tags": ["ms-access", "filter", "vba", "dao", "ms-access-2013"], "comments": [{"owner": {"reputation": 4173, "user_id": 2895550, "user_type": "registered", "profile_image": "https://graph.facebook.com/1184544414/picture?type=large", "display_name": "Wayne G. Dunn", "link": "https://stackoverflow.com/users/2895550/wayne-g-dunn"}, "edited": false, "score": 0, "creation_date": 1480544387, "post_id": 40898680, "comment_id": 69012320, "body": "Since I don&#39;t know what launches these forms (all at once?), or how you navigate to any given record, or if you properly linked the child and parent forms, or what other code is involved... did you try a subform refresh when the record is selected? This is not the way to go... do you have proper links?"}, {"owner": {"reputation": 9, "user_id": 7042672, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/68d291db2071a051170a2a50f20791c4?s=128&d=identicon&r=PG&f=1", "display_name": "trappertam", "link": "https://stackoverflow.com/users/7042672/trappertam"}, "reply_to_user": {"reputation": 4173, "user_id": 2895550, "user_type": "registered", "profile_image": "https://graph.facebook.com/1184544414/picture?type=large", "display_name": "Wayne G. Dunn", "link": "https://stackoverflow.com/users/2895550/wayne-g-dunn"}, "edited": false, "score": 0, "creation_date": 1480551723, "post_id": 40898680, "comment_id": 69015007, "body": "The child &amp; parent forms are properly linked, The forms do not open together, they disseminate one form per user type of user after login, i.e., Analyst will use Analyst form, Salesman will use Sales form. I agree, it is not the way to go, so no, I am not requesting a subform refresh when a record is selected. My links function: they pull up the correct record, fields display the correct dropdowns, etc. I know it has to do with the filter trigger, I&#39;ve used every troubleshooting tool I&#39;ve had pointed at me &amp; I&#39;m just out of ideas &amp; research."}, {"owner": {"reputation": 9, "user_id": 7042672, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/68d291db2071a051170a2a50f20791c4?s=128&d=identicon&r=PG&f=1", "display_name": "trappertam", "link": "https://stackoverflow.com/users/7042672/trappertam"}, "reply_to_user": {"reputation": 4173, "user_id": 2895550, "user_type": "registered", "profile_image": "https://graph.facebook.com/1184544414/picture?type=large", "display_name": "Wayne G. Dunn", "link": "https://stackoverflow.com/users/2895550/wayne-g-dunn"}, "edited": false, "score": 0, "creation_date": 1480554547, "post_id": 40898680, "comment_id": 69015714, "body": "I&#39;ll be happy to put them up. How/where would you like me to do this?"}, {"owner": {"reputation": 9, "user_id": 7042672, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/68d291db2071a051170a2a50f20791c4?s=128&d=identicon&r=PG&f=1", "display_name": "trappertam", "link": "https://stackoverflow.com/users/7042672/trappertam"}, "reply_to_user": {"reputation": 4173, "user_id": 2895550, "user_type": "registered", "profile_image": "https://graph.facebook.com/1184544414/picture?type=large", "display_name": "Wayne G. Dunn", "link": "https://stackoverflow.com/users/2895550/wayne-g-dunn"}, "edited": false, "score": 0, "creation_date": 1480561697, "post_id": 40898680, "comment_id": 69017429, "body": "Here you go. User table has the login info. &quot;Sales&quot; form is functional, the &quot;Analyst&quot;, &quot;Engineer&quot;, &quot;Operations&quot;, &quot;HelpDesk&quot; pages are the pages that are failing to function correctly on initial open. If you attempt to open the form without logging in you will receive an error, unless you are in design mode. Feel free to make any changes you wish, I have a backed up copy. Thank you again, sir!   <a href=\"https://www.dropbox.com/s/9mb8mp32xvpw4iy/HotelTest.accdb?dl=0\" rel=\"nofollow noreferrer\">dropbox.com/s/9mb8mp32xvpw4iy/HotelTest.accdb?dl=0</a>"}, {"owner": {"reputation": 4173, "user_id": 2895550, "user_type": "registered", "profile_image": "https://graph.facebook.com/1184544414/picture?type=large", "display_name": "Wayne G. Dunn", "link": "https://stackoverflow.com/users/2895550/wayne-g-dunn"}, "edited": false, "score": 0, "creation_date": 1480571695, "post_id": 40898680, "comment_id": 69020195, "body": "Well, I&#39;ve got to admit that I&#39;m stumped... so far... I believe I have a workaround. Since subform &#39;SFSiteAnalyst&#39; is the problem, and it looks to be the same as &#39;SFSiteSales&#39;, make a backup copy of the &#39;bad&#39; subform, then clone SFSiteSales and rename as SFSiteAnalyst. I hav tried opening that subform by itself, deleting all controls, adding back; compact &amp; repair, etc. but no luck...yet...  I also extracted every control and every property for all objects and did a quick compare without seeing a glaring difference (over 3600 properties!)  Will try a few more things tomorrow!"}, {"owner": {"reputation": 9, "user_id": 7042672, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/68d291db2071a051170a2a50f20791c4?s=128&d=identicon&r=PG&f=1", "display_name": "trappertam", "link": "https://stackoverflow.com/users/7042672/trappertam"}, "reply_to_user": {"reputation": 4173, "user_id": 2895550, "user_type": "registered", "profile_image": "https://graph.facebook.com/1184544414/picture?type=large", "display_name": "Wayne G. Dunn", "link": "https://stackoverflow.com/users/2895550/wayne-g-dunn"}, "edited": false, "score": 0, "creation_date": 1480600678, "post_id": 40898680, "comment_id": 69037103, "body": "I went ahead and did as you suggest in the workaround, all is well and working. If you want to go ahead and put that up as an answer, I&#39;ll take it. If you want to keep working towards finding the ultimate solution, you are welcome to do so. But you found resolution to the craziness, and I&#39;m extremely grateful!"}], "answers": [{"comments": [{"owner": {"reputation": 9, "user_id": 7042672, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/68d291db2071a051170a2a50f20791c4?s=128&d=identicon&r=PG&f=1", "display_name": "trappertam", "link": "https://stackoverflow.com/users/7042672/trappertam"}, "edited": false, "score": 0, "creation_date": 1480619121, "post_id": 40916521, "comment_id": 69049042, "body": "If I change Data Entry to no, won&#39;t that cause issues with other properties of the form/subform not allowing data entry or changes to the existing records? Regarding the <code>doCmd.Save acForm</code> I&#39;d like to remove them, but when I try it cascades issues. My boss is paranoid about saving records. I noticed during testing some records auto-saved. Is there a resource you know of that provides the rules regarding Access auto-saves specifically, so I can learn appropriate use of the save command structure?"}, {"owner": {"reputation": 4173, "user_id": 2895550, "user_type": "registered", "profile_image": "https://graph.facebook.com/1184544414/picture?type=large", "display_name": "Wayne G. Dunn", "link": "https://stackoverflow.com/users/2895550/wayne-g-dunn"}, "reply_to_user": {"reputation": 9, "user_id": 7042672, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/68d291db2071a051170a2a50f20791c4?s=128&d=identicon&r=PG&f=1", "display_name": "trappertam", "link": "https://stackoverflow.com/users/7042672/trappertam"}, "edited": false, "score": 0, "creation_date": 1480619964, "post_id": 40916521, "comment_id": 69049487, "body": "Re Data Entry, setting to Yes means no records displayed... See: <a href=\"https://support.office.com/en-us/article/DataEntry-Property-f4236759-27f6-4fcd-abb0-4aa4acd8fe87\" rel=\"nofollow noreferrer\">support.office.com/en-us/article/&hellip;</a>  Re DoCmd.Save acForm, that is not the way to save a changed record. Use either DoCmd.RunCommand acCmdSaveRecord, or If Me.Dirty Then   Me.Dirty = False End If Changed records save automatically when moving to another record. In som applications, I prefer to have code that checks to see if Dirty, then prompt user to ask if they want to save (i.e. user bouncing around on a form and accidentally chances a value)"}, {"owner": {"reputation": 9, "user_id": 7042672, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/68d291db2071a051170a2a50f20791c4?s=128&d=identicon&r=PG&f=1", "display_name": "trappertam", "link": "https://stackoverflow.com/users/7042672/trappertam"}, "edited": false, "score": 0, "creation_date": 1480647647, "post_id": 40916521, "comment_id": 69059831, "body": "Thank you again, Wayne. I guess my common-sense thinking, uh, wasn&#39;t. I&#39;ve removed as many of the <code>DoCmd.Save acForm</code> statements as possible and switched to the <code>If Me.Dirty Then Me.Dirty = False</code> instead where appropriate. If you&#39;re willing to take this one step further, I have one other issue - form lockup on save - that has come up as a result of that change. However, under forum rules, it should rightfully be dealt with in a different question. Would you be willing to help on that, since you&#39;re now familiar with the db? I&#39;ll repost in a different question. Thank you again for the learning!"}], "tags": [], "owner": {"reputation": 4173, "user_id": 2895550, "user_type": "registered", "profile_image": "https://graph.facebook.com/1184544414/picture?type=large", "display_name": "Wayne G. Dunn", "link": "https://stackoverflow.com/users/2895550/wayne-g-dunn"}, "is_accepted": true, "score": 1, "last_activity_date": 1480612351, "creation_date": 1480612351, "answer_id": 40916521, "question_id": 40898680, "link": "https://stackoverflow.com/questions/40898680/form-filters-failing-fast-and-furious/40916521#40916521", "title": "Form filters failing fast and furious", "body": "<p>After a lot of searching, I found the cause of your problem.</p>\n\n<p>Form 'sfSiteAnalyst' has the property 'Data Entry' set to Yes. Change to No and it works just fine.</p>\n\n<p>Just comparing the 3,889 properties for that form and controls led to finding 58 that were different -- but the other differences were meaningless (top, border, etc.)</p>\n\n<p>Also, I notice there are many places where you issue a 'DoCmd.Save acForm, ...' that caused me problems with testing. Are they really necessary?</p>\n"}], "owner": {"reputation": 9, "user_id": 7042672, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/68d291db2071a051170a2a50f20791c4?s=128&d=identicon&r=PG&f=1", "display_name": "trappertam", "link": "https://stackoverflow.com/users/7042672/trappertam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 101, "favorite_count": 0, "accepted_answer_id": 40916521, "answer_count": 1, "score": 0, "last_activity_date": 1594640903, "creation_date": 1480541758, "last_edit_date": 1594640903, "question_id": 40898680, "link": "https://stackoverflow.com/questions/40898680/form-filters-failing-fast-and-furious", "title": "Form filters failing fast and furious", "body": "<p>As a precursor, I am a newbie to Access and Stackoverflow, so any errors in context, statements, verbiage, etc., are purely unintentional. I have a good heart, good intentions, and mean no offense.</p>\n\n<p>I have 5 forms in my unsplit, DAO 2013 Access db that all use identical coding regarding this specific issue. On opening, all forms are set to open to a new, blank record.</p>\n\n<p>When a customer record is searched and the record is opened, all forms have a subform container which is tabbed and contains the bulk of the customer's record information.</p>\n\n<p>On 1 of these forms, the navigation bar states \"no filter\" and shows the customer's record information in the subform container. Regardless of the filter state, the customer record information should show, so this is what should happen.</p>\n\n<p>On 4 of these forms, the form navigation bar states \"Unfiltered\" and displays none of the customer's record information in the subform container. If I click the filter button on the bottom of the form (or the filter toggle in the ribbon) twice the customer record information will display on the second click - and the form moves to \"Filtered\" and then again \"Unfiltered\". All Subforms then behave normally in the second \"Unfiltered\" state.</p>\n\n<p>There are -0- manual VBA filters (i.e., <code>me.customer.filter = false</code>) currently set in my db, -0- queries used to find records - everything is built using VBA to locate records.</p>\n\n<p>End users will not be able to use the filter controls once the db goes live. This is my final bug. I appreciate any suggestions or solutions that may be offered.</p>\n\n<p>These are the solutions I have attempted:</p>\n\n<ul>\n<li><p>used <code>Me.FilterOn = False</code> and <code>Me.Filter = \"\"</code> to turn off all filters on the 4 affected forms on opening, but this caused the filter toggle to become unavailable and the subform container to not display any customer record information on the 4 forms</p></li>\n<li><p>used <code>Me.FilterOn = False</code> and <code>Me.Filter = \"\"</code> to turn off all filters on the 4 affected forms on current, but this caused the filter toggle to become unavailable and the subform container to not display any customer record information on the 4 forms</p></li>\n<li><p>used VBA above to turn off all filters on all 5 forms on opening, this caused the filter toggle to become unavailable and the subform container to not display any customer record information on all 5 forms</p></li>\n<li><p>decompiled, repaired/compressed, and rebuilt into a new db a couple of times</p></li>\n<li><p>using VBA to force the unfiltered/filtered/unfiltered state to occur on opening, but subforms interfered and my deadline doesn't leave me time to figure it out.</p></li>\n<li><p>attempting to base everything off queries instead of tables, but as these subforms must be editable and the queries must be unique, this was not an option</p></li>\n<li><p>compared the one form against the others to see what is different vs. what is the same on opening/searching. in this, they are identical.</p></li>\n</ul>\n\n<p>As a final wrap up, if anyone would like to look at my setup, just let me know, I have a stripped down version ready. I did not post any code here as I'm not sure what you'll want to look at.</p>\n\n<p>Thank you again,</p>\n\n<p>Trapper</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 1, "creation_date": 1480541630, "post_id": 40898539, "comment_id": 69011008, "body": "<i>Unfortunately it is not returning an array, it is returning an error. Subscript out of range</i> - Which line returns the error? Or, maybe more to the point, when you call this function from another sub are you assigning the result to a variant object type as well?"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1480541805, "post_id": 40898539, "comment_id": 69011117, "body": "If you declare an array with open brackets, at some point you have to dimension it in your code. The alternative is to declare <code>Dim numArr As Variant</code>. If there is no dash in the response you are not assigning a value to numArr anywhere. That said, I can&#39;t see what your code is actually achieving."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1480541886, "post_id": 40898539, "comment_id": 69011160, "body": "What if the user input needs to be <code>-1</code>? How do you tell a valid <code>-1</code> from the <code>-1</code> &quot;error value&quot;? Use structured error handling instead of magic return values, and avoid <code>GoTo</code>."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1480542087, "post_id": 40898539, "comment_id": 69011252, "body": "Your solution isn&#39;t half as &quot;generic&quot; as it claims to be. Why not make a custom UserForm and <i>actually</i> validate user input as it happens, using customizeable validation rules, instead of prompting with an <code>InputBox</code> and then verifying and prompting again?"}, {"owner": {"reputation": 241, "user_id": 6654790, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/9019a96fdfbf926d154a20a696611015?s=128&d=identicon&r=PG&f=1", "display_name": "bdpolinsky", "link": "https://stackoverflow.com/users/6654790/bdpolinsky"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1480542320, "post_id": 40898539, "comment_id": 69011354, "body": "@Mat&#39;sMug thanks; going to begin researching how to implement the userform tomorrow"}], "answers": [{"tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": false, "score": 0, "last_activity_date": 1480543760, "creation_date": 1480543760, "answer_id": 40899154, "question_id": 40898539, "link": "https://stackoverflow.com/questions/40898539/validating-user-input-excel-vba/40899154#40899154", "title": "Validating user input excel vba", "body": "<p>this should do:</p>\n\n<pre><code>Public Function getUserInput() As Variant\n    'this function gets a user input from an input box and puts it out into the proper format\n    Dim numArr As Variant\n    Dim goOn As Boolean\n\n    Do\n        numArr = Split(WorksheetFunction.Trim(InputBox(\"Enter the rows you'd like to print in the format 'nnnn' or 'nnnn-mmmm'\")), \"-\")\n        Select Case UBound(numArr)\n            Case 0\n                goOn = Format(numArr(0), \"0000\") Like \"####\"\n            Case 1\n                goOn = Format(numArr(0), \"0000\") Like \"####\" And Format(numArr(1), \"0000\") Like \"####\"\n        End Select\n        If Not goOn Then MsgBox \"Please enter the number in a valid format - either a single number no larger than 9999 or two numbers no larger than 9999 separated by only one dash (ex: XX-XX)\"        \n    Loop While Not goOn\n    getUserInput = numArr\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 241, "user_id": 6654790, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/9019a96fdfbf926d154a20a696611015?s=128&d=identicon&r=PG&f=1", "display_name": "bdpolinsky", "link": "https://stackoverflow.com/users/6654790/bdpolinsky"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 609, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1480543760, "creation_date": 1480541290, "question_id": 40898539, "link": "https://stackoverflow.com/questions/40898539/validating-user-input-excel-vba", "title": "Validating user input excel vba", "body": "<p>I have the following user input set up in excel vba. The function when called asks the user to input a single number no greater than 9999, or two numbers in the format XXXX-XXXX where two numbers are separated by a dash. In that case, the numbers cannot be greater than 9999 in either case, or at least shouldn't.</p>\n\n<p>The goal is to return either a single number (IE 50) or a range (IE low value is 50,high value is 75). Currently as set up it should be returning an array, where the first position is the low value, and the second position is high value. Or, if the user only enters one number, it should return that one number in the first position of an array.</p>\n\n<p>Currently it checks that A) user has entered in a number, B) the number is not greater than 4 digits long. </p>\n\n<p>Unfortunately it is not returning an array, it is returning an error. Subscript out of range. </p>\n\n<p>Also, are there any other likely user inputs that should be checked for here? The application is not going to be widely used by people, but I'd like to minimize potential errors as well.</p>\n\n<pre><code>Public Function getUserInput() As Variant\n'this function gets a user input from an input box and puts it out into the proper format\n\n\n        Dim inputString As String\n        Dim numArr() As String\n\n        Dim i As Long\n\n      '  On Error GoTo NotValidInput\n        inputString = Trim(InputBox(\"Enter the rows you'd like to print\"))\n\n      'has the user entered a dash into their user input\n\n         If InStr(inputString, \"-\") &gt; 0 Then\n                numArr() = Split(inputString, \"-\")\n\n                If UBound(numArr) &lt;&gt; 1 Then\n                    GoTo NotValidNumberFormat\n                End If\n                If (IsNumeric(numArr(0)) And Len(numArr(0)) &lt;= 4) And (IsNumeric(numArr(1)) And Len(numArr(1)) &lt;= 4) Then\n\n                    getUserInput = numArr\n                    Exit Function\n                Else\n                    GoTo NotValidNumberFormat\n                End If\n        'no dash\n        '60\n\n         Else\n            If (IsNumeric(CInt(inputString))) And Len(inputString) &lt;= 4 Then\n                    getUserInput = numArr\n                Exit Function\n            Else\n                GoTo NotValidNumberFormat\n            End If\n         End If\n\n\nExit Function\n\nNotValidNumberFormat:\n'if the conversion failed, return error\nMsgBox (\"Please enter the number in a valid format - either a single number no larger than 9999 or two numbers no larger than 9999 separated by only one dash (IE XX-XX)\")\n\ngetUserInput = -1\n\nEnd Function\n</code></pre>\n"}, {"tags": ["excel", "vba", "with-statement"], "answers": [{"comments": [{"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1480541583, "post_id": 40898561, "comment_id": 69010988, "body": "You could use the original code and remove the code that deals with <code>firstAddress</code>.  The code will just loop until c is nothing once all <code>|</code> have been replaced."}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "reply_to_user": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1480541858, "post_id": 40898561, "comment_id": 69011142, "body": "@DarrenBartrup-Cook Good point. I honestly didn&#39;t pay too much attention to the what the code was trying to do, but  focused instead on the particular bug that they ran into. Perhaps you could post an answer which shows how the code can be streamlined."}, {"owner": {"reputation": 1, "user_id": 2186454, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e66f06aafff948d7b1e46e6a7ef4899f?s=128&d=identicon&r=PG", "display_name": "John Seiver", "link": "https://stackoverflow.com/users/2186454/john-seiver"}, "edited": false, "score": 0, "creation_date": 1480545975, "post_id": 40898561, "comment_id": 69013052, "body": "All, see second question update.  This ode works.  Thanks very much to Darren and John!"}], "tags": [], "owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "is_accepted": false, "score": 1, "last_activity_date": 1480541364, "creation_date": 1480541364, "answer_id": 40898561, "question_id": 40898375, "link": "https://stackoverflow.com/questions/40898375/excel-vba-error/40898561#40898561", "title": "Excel VBA Error", "body": "<p>You have to test if <code>c</code> is nothing in a condition that doesn't simultaneously (albeit implicitly) assume that it isn't nothing. Something like this (untested):</p>\n\n<pre><code>With Sheets(\"DATASHEET\").Range(\"AG1:BG53\")\n    Set c = .Find(\"|\", LookIn:=xlValues)\n    If Not c Is Nothing Then\n       firstAddress = c.Address\n       Do\n          c.Value = \"\"\n          Set c = .FindNext(c)\n          If c is Nothing Then Exit Do\n       Loop While c.Address &lt;&gt; firstAddress\n     End If\nEnd With\n</code></pre>\n\n<p>The problem is that VBA, unlike most programming languages, doesn't short-circuit logical operators. Both <code>A</code> And <code>B</code> are <em>always</em> evaluated in <code>A and B</code>, even if <code>A</code> is False. As a consequence, you sometimes need to write code in a more round-about way in VBA.</p>\n"}, {"tags": [], "owner": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "is_accepted": false, "score": 0, "last_activity_date": 1480593556, "last_edit_date": 1480593556, "creation_date": 1480549479, "answer_id": 40900288, "question_id": 40898375, "link": "https://stackoverflow.com/questions/40898375/excel-vba-error/40900288#40900288", "title": "Excel VBA Error", "body": "<p>It can be simplified with the <a href=\"https://www.ablebits.com/office-addins-blog/2015/09/29/using-excel-find-replace/#change-chell-formatting\" rel=\"nofollow noreferrer\">Excel Find and Replace Format</a>:</p>\n\n<pre><code>Application.ReplaceFormat.Clear                      ' optional\nApplication.ReplaceFormat.Interior.ColorIndex = 15   ' set the replacement format\n[DATASHEET!AG1:BG53].Replace \"|\", \"\", LookAt:=xlPart, ReplaceFormat:=True\n</code></pre>\n\n<p>But this like your updated code will replace all cells that <strong>contain</strong> <code>|</code>. </p>\n\n<p>To find only cells that <strong>start with</strong> <code>|</code>, you can replace the find condition in your code to:</p>\n\n<pre><code>Set c = .Find(\"|*\", , LookIn:=xlValues, LookAt:=xlWhole)\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 2186454, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e66f06aafff948d7b1e46e6a7ef4899f?s=128&d=identicon&r=PG", "display_name": "John Seiver", "link": "https://stackoverflow.com/users/2186454/john-seiver"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 515, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1480593556, "creation_date": 1480540691, "last_edit_date": 1480546230, "question_id": 40898375, "link": "https://stackoverflow.com/questions/40898375/excel-vba-error", "title": "Excel VBA Error", "body": "<p>I am trying to use VBA to automatically change the color of cells that contain the piping character \"|\".</p>\n\n<p>When detected, I would like the code to remove the piping character \"|\" and change the cell color to gray.  The code is not working and is listed below:</p>\n\n<pre><code>    With Sheets(\"DATASHEET\").Range(\"AG1:BG53\")\n    Set c = .Find(\"|\", LookIn:=xlValues)\n      If Not c Is Nothing Then\n          firstAddress = c.Address\n          Do\n          c.Value = \"\"\n          c.Pattern = xlSolid\n          c.PatternColorIndex = xlAutomatic\n          c.ThemeColor = xlThemeColorDark1\n          c.TintAndShade = -0.249977111117893\n          c.PatternTintAndShade = 0\n          Loop While Not c Is Nothing And c.Address &lt;&gt; firstAddress\n      End If\n    End With\n</code></pre>\n\n<p>When I run the VBA, I get the following error:</p>\n\n<p><em>Run-time error '91':</em>\n<em>Object variable or With block variable not set</em></p>\n\n<p>The code fails here:</p>\n\n<p><em>Loop While Not c Is Nothing And c.Address &lt;> firstAddress</em></p>\n\n<p>After the crash, my Debug Watches have the following values:</p>\n\n<p><em>Expression <code>firstAddress\" = $AG$37</code> (which is the first cell in the range that is merged and centered - a requirement)</em></p>\n\n<p><em>Expression c.Address = Object variable or With block variable not set</em></p>\n\n<p><em>Expression c.Value = Object variable or With block variable not set</em></p>\n\n<p>I would appreciate any help.</p>\n\n<p>Thanks!</p>\n\n<p>jmseiver</p>\n\n<p>Update:</p>\n\n<p>This code works, thanks Darren!</p>\n\n<pre><code>With Sheets(\"DATASHEET\").Range(\"AG1:BG53\")\n            Set c = .Find(\"|\", LookIn:=xlValues)\n            If Not c Is Nothing Then\n                Do\n                c.Value = \"\"\n                With Selection.Interior\n                    .Pattern = xlSolid\n                    .PatternColorIndex = xlAutomatic\n                    .ThemeColor = xlThemeColorDark1\n                    .TintAndShade = -0.249977111117893\n                    .PatternTintAndShade = 0\n                End With\n                Set c = .FindNext(c)\n                Loop While Not c Is Nothing\n            End If\n        End With\n</code></pre>\n\n<p>This code does not:</p>\n\n<pre><code>With Sheets(\"DATASHEET\").Range(\"AG1:BG53\")\n            Set c = .Find(\"|\", LookIn:=xlValues)\n            If Not c Is Nothing Then\n                Do\n                c.Value = \"\"\n                With Selection.Interior\n                    .Pattern = xlSolid\n                    .PatternColorIndex = xlAutomatic\n                    .ThemeColor = xlThemeColorDark1\n                    .TintAndShade = -0.249977111117893\n                    .PatternTintAndShade = 0\n                End With\n                Set c = .FindNext(c)\n                Loop While Not c Is Nothing\n            End If\n        End With\n</code></pre>\n\n<p>Changing the cell color is the purpose of the routine.  The additional With - End With does not work.</p>\n\n<p>It doesn't bomb, it just doesn't change the cell color.</p>\n\n<p>?</p>\n\n<p>Thanks to everyone for their time so far!</p>\n\n<p>jmseiver</p>\n\n<p>Update 2:</p>\n\n<p>This code works!</p>\n\n<pre><code>'color any cell with updated data to gray\n        With Sheets(\"DATASHEET\").Range(\"AG1:BG53\")\n            Set c = .Find(\"|\", LookIn:=xlValues)\n            If Not c Is Nothing Then\n                Do\n                c.Replace What:=\"|\", Replacement:=\"\"\n                c.Interior.ColorIndex = 15\n                Set c = .FindNext(c)\n                Loop While Not c Is Nothing\n            End If\n        End With\n</code></pre>\n\n<p>In summary, the purpose of this code is 1) find all cells whose first character is the piping character \"|\", 2) remove the piping character \"|\", and 3) color the cell gray.</p>\n\n<p>Thanks again Darren and John!</p>\n\n<p>jmseiver</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1480540703, "post_id": 40898308, "comment_id": 69010509, "body": "You might want to bail out early when <code>Target</code> isn&#39;t <code>Sheet3!S17</code>..."}, {"owner": {"reputation": 489, "user_id": 4021184, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/715e799fa6bcbb7af072f14a37e3caef?s=128&d=identicon&r=PG&f=1", "display_name": "ranopano", "link": "https://stackoverflow.com/users/4021184/ranopano"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1480540759, "post_id": 40898308, "comment_id": 69010545, "body": "Can you elaborate? Sorry still fairly new to VBA."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1480540785, "post_id": 40898308, "comment_id": 69010569, "body": "Are you changing cell S17 directly, or is the result of a formula?"}, {"owner": {"reputation": 489, "user_id": 4021184, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/715e799fa6bcbb7af072f14a37e3caef?s=128&d=identicon&r=PG&f=1", "display_name": "ranopano", "link": "https://stackoverflow.com/users/4021184/ranopano"}, "edited": false, "score": 0, "creation_date": 1480540810, "post_id": 40898308, "comment_id": 69010588, "body": "The result of a formula"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1480541680, "post_id": 40898308, "comment_id": 69011038, "body": "Try handling <code>Worksheet_Calculate</code> instead."}, {"owner": {"reputation": 489, "user_id": 4021184, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/715e799fa6bcbb7af072f14a37e3caef?s=128&d=identicon&r=PG&f=1", "display_name": "ranopano", "link": "https://stackoverflow.com/users/4021184/ranopano"}, "edited": false, "score": 0, "creation_date": 1480543012, "post_id": 40898308, "comment_id": 69011704, "body": "This works! Thank you!!!"}], "answers": [{"tags": [], "owner": {"reputation": 294, "user_id": 5518412, "user_type": "registered", "profile_image": "https://graph.facebook.com/900413473399114/picture?type=large", "display_name": "Praveen Behera", "link": "https://stackoverflow.com/users/5518412/praveen-behera"}, "is_accepted": false, "score": 1, "last_activity_date": 1480581818, "creation_date": 1480581818, "answer_id": 40906034, "question_id": 40898308, "link": "https://stackoverflow.com/questions/40898308/hide-unhide-command-button-based-on-dynamically-changing-cell-value/40906034#40906034", "title": "Hide/Unhide Command Button based on dynamically changing cell value", "body": "<p>Here is your code -</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\nIf Target = Range(\"S17\") Then\n\nIf Target.Value = \"(All)\" Then\nCommandButton6.Visible = False\n\nElse\n\nCommandButton6.Visible = True\n\nEnd If\n\nEnd If\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 489, "user_id": 4021184, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/715e799fa6bcbb7af072f14a37e3caef?s=128&d=identicon&r=PG&f=1", "display_name": "ranopano", "link": "https://stackoverflow.com/users/4021184/ranopano"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4178, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1480581818, "creation_date": 1480540459, "question_id": 40898308, "link": "https://stackoverflow.com/questions/40898308/hide-unhide-command-button-based-on-dynamically-changing-cell-value", "title": "Hide/Unhide Command Button based on dynamically changing cell value", "body": "<p>I'd like to create some VBA code that will hide a command button based on a cell's value.</p>\n\n<p>If cell \"S17\"= \"(All)\" then the command button should be hidden, otherwise it can remain visible.</p>\n\n<p>As I stated, the value in cell S17 changes dynamically, so the code will need to update whenever the user makes a change.</p>\n\n<p>Here is my code so far:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n If Sheet3.Range(\"S17\").Value = \"(All)\" Then\n CommandButton6.Visible = False\nElse\n CommandButton6.Visible = True\nEnd If\nEnd Sub\n</code></pre>\n\n<p>Currently this isn't doing anything. If cell S17 = \"(All)\" the command button is still visible.</p>\n"}, {"tags": ["vba", "excel"], "owner": {"reputation": 11, "user_id": 7232988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9287b50e004f07f492ca60b7ea01741?s=128&d=identicon&r=PG&f=1", "display_name": "Margaritaville_Mike", "link": "https://stackoverflow.com/users/7232988/margaritaville-mike"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 256, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1480540006, "creation_date": 1480539296, "last_edit_date": 1495539955, "question_id": 40898025, "link": "https://stackoverflow.com/questions/40898025/using-imapi-in-excel-vba-to-burn-dvds", "title": "using IMAPI in excel vba to burn dvd(s)", "body": "<p>I am encountering a run-time error while using IMAPI. The error: </p>\n\n<blockquote>\n  <p>Adding a file or folder would result in a result image having a size larger than the current configured limit.</p>\n</blockquote>\n\n<p>It works great for anything that doesn't exceed the type of media in the optical drive, else I get the above.</p>\n\n<p>I saw a post from A_J <a href=\"https://stackoverflow.com/q/37225746/\">here</a> that leans toward a possible solution in C#:</p>\n\n<pre><code>fileSystemImage.FreeMediaBlocks = int.MaxValue;\n</code></pre>\n\n<p>I am looking for help in writing the above, but in 2013 Excel VBA.</p>\n\n<p>Below is a copy of what I'm using:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Option Explicit\n\nSub TestCDWrite()\n\nApplication.DisplayAlerts = False\n\n  Dim objDiscMaster As IMAPI2.MsftDiscMaster2\n  Dim objRecorder As IMAPI2.MsftDiscRecorder2\n  Dim DataWriter As IMAPI2.MsftDiscFormat2Data\n  Dim intDrvIndex As Integer\n  'The Object browser, but not intellisense, presents types for these, but they cannot be used in VBA\n  Dim stream As Variant\n  Dim FS As Variant\n  Dim Result As Variant\n  Dim FSI As Object\n  Dim strBurnPath As String\n  Dim strUniqueID As String\n\n  ' *** CD/DVD disc file system types\n  Const FsiFileSystemISO9660 = 1\n  Const FsiFileSystemJoliet = 2\n  Const FsiFileSystemUDF102 = 4\n\n  'On Error GoTo TestCDWrite_Error\n\n  intDrvIndex = 0\n  strBurnPath = Worksheets(\"mphoi\").Range(\"AF2\")\n  ' Create a DiscMaster2 object to connect to optical drives.\n  Set objDiscMaster = New IMAPI2.MsftDiscMaster2\n\n  ' Create a DiscRecorder2 object for the specified burning device.\n  Set objRecorder = New IMAPI2.MsftDiscRecorder2\n\n  strUniqueID = objDiscMaster.Item(intDrvIndex)\n  objRecorder.InitializeDiscRecorder (strUniqueID)\n\n  ' Create a DiscFormat2Data object and set the recorder\n  Set DataWriter = New IMAPI2.MsftDiscFormat2Data\n  DataWriter.Recorder = objRecorder\n  DataWriter.ClientName = \"IMAPIv2 TEST\"\n\n  ' Create a new file system image object\n  Set FSI = New IMAPI2FS.MsftFileSystemImage\n  fsi.freemediablocks=int.maxvalue\n\n  ' Import the last session, if the disc is not empty, or initialize\n  ' the file system, if the disc is empty\n  If Not DataWriter.MediaHeuristicallyBlank Then\n    On Error Resume Next\n    FSI.MultisessionInterfaces = DataWriter.MultisessionInterfaces\n    If Err.Number &lt;&gt; 0 Then\n        MsgBox \"Multisession is not supported on this disc\", vbExclamation, \"Data Archiving\"\n      GoTo ExitHere\n    End If\n    On Error GoTo 0\n        MsgBox \"Importing data from previous session ...\", vbInformation, \"Data Archiving\"\n    FS = FSI.ImportFileSystem()\n  Else\n    FS = FSI.ChooseImageDefaults(objRecorder)\n  End If\n\n  ' Add the directory and its contents to the file system\n    MsgBox \"Adding \" &amp; strBurnPath &amp; \" folder to the disc...\", vbInformation, \"Data Archiving\"\n  FSI.Root.AddTree strBurnPath, False\n\n  ' Create an image from the file system image object\n\n  Set Result = FSI.CreateResultImage()\n  Set stream = Result.ImageStream\n\n  ' Write stream to disc using the specified recorder\n    MsgBox \"Writing content to the disc...\", vbInformation, \"Data Archiving\"\n  DataWriter.Write (stream)\n\n    MsgBox \"Completed writing Archive data to disk \", vbInformation, \"Data Archiving\"\n\nExitHere:\n  Exit Sub\n'Error handling block\nTestCDWrite_Error:\n  Select Case Err.Number\n   Case Else\n   MsgBox \"Error \" &amp; Err.Number &amp; \": \" &amp; Err.Description, vbCritical, \"TestCode.TestCDWrite\"\n  End Select\n  Resume ExitHere\n\n  Application.DisplayAlerts = True\n'End Error handling block\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 686, "user_id": 6701192, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mkUyD.jpg?s=128&g=1", "display_name": "PartyHatPanda", "link": "https://stackoverflow.com/users/6701192/partyhatpanda"}, "edited": false, "score": 0, "creation_date": 1480539419, "post_id": 40897941, "comment_id": 69009813, "body": "To be fair, I haven&#39;t used <code>.ClearContents</code>, but what&#39;s stopping you from just using a fully qualified a declaration? <code>Sheets(&quot;Sheet2&quot;).Range(&quot;insertRangeHere&quot;).ClearContents</code>"}, {"owner": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "edited": false, "score": 0, "creation_date": 1480540491, "post_id": 40897941, "comment_id": 69010389, "body": "I love it when quizzes have a hidden sheet with the answers :]"}, {"owner": {"reputation": 13883, "user_id": 6815131, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c38385f9eb57b70176498fa5c3b4c99?s=128&d=identicon&r=PG&f=1", "display_name": "Joe C", "link": "https://stackoverflow.com/users/6815131/joe-c"}, "edited": false, "score": 0, "creation_date": 1480543522, "post_id": 40897941, "comment_id": 69011937, "body": "Welcome to Stack Overflow!  Please review our <a href=\"http://meta.stackoverflow.com/questions/260648/stack-overflow-question-checklist\">SO Question Checklist</a> to help you to ask a good question, and thus get a good answer."}, {"owner": {"reputation": 1, "user_id": 7231372, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e328a306e06f5009959d3c0adc5758f0?s=128&d=identicon&r=PG&f=1", "display_name": "user7231372", "link": "https://stackoverflow.com/users/7231372/user7231372"}, "edited": false, "score": 0, "creation_date": 1480603588, "post_id": 40897941, "comment_id": 69039230, "body": "Thanks Joe,  So sorry if I broke protocol.  Some kind participants did give me some direction.  I searched multiple web resources and could not find a solution."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 7231372, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e328a306e06f5009959d3c0adc5758f0?s=128&d=identicon&r=PG&f=1", "display_name": "user7231372", "link": "https://stackoverflow.com/users/7231372/user7231372"}, "edited": false, "score": 0, "creation_date": 1480607771, "post_id": 40898154, "comment_id": 69042280, "body": "thanks for helping.  I&#39;m using Excel 2010 if that makes a difference."}, {"owner": {"reputation": 1, "user_id": 7231372, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e328a306e06f5009959d3c0adc5758f0?s=128&d=identicon&r=PG&f=1", "display_name": "user7231372", "link": "https://stackoverflow.com/users/7231372/user7231372"}, "edited": false, "score": 0, "creation_date": 1480610110, "post_id": 40898154, "comment_id": 69043761, "body": "I used the code you posted and got error: &quot;Run-time error &#39;1004&#39;  Method &#39;Range&#39; of object &#39;_Worksheet&#39; failed.  I&#39;m using a button click to run the macro.  button located on Sheet1, cells to be cleared located on Sheet1.  D1:D395 located on sheet2  Appears I need reference"}, {"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "reply_to_user": {"reputation": 1, "user_id": 7231372, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e328a306e06f5009959d3c0adc5758f0?s=128&d=identicon&r=PG&f=1", "display_name": "user7231372", "link": "https://stackoverflow.com/users/7231372/user7231372"}, "edited": false, "score": 0, "creation_date": 1480610624, "post_id": 40898154, "comment_id": 69044067, "body": "Did you change the relevant parts of this code to point to your correct sheets? I&#39;m guessing it&#39;s bombing on the <code>Sheet2.Range(listCell).clearContents</code> line. Hit the debug button and see what the value is stored in <code>listCell</code> variable in your <code>Locals</code> window in VBE. It should be a comma seperated list of cell references that is built from the <code>D1:D395</code> range of Sheet2."}, {"owner": {"reputation": 1, "user_id": 7231372, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e328a306e06f5009959d3c0adc5758f0?s=128&d=identicon&r=PG&f=1", "display_name": "user7231372", "link": "https://stackoverflow.com/users/7231372/user7231372"}, "edited": false, "score": 0, "creation_date": 1480618957, "post_id": 40898154, "comment_id": 69048949, "body": "Hmmm?  Yes, both Range statements indicate Sheet2.  The local window shows the comma separated listing of applicable cells to be cleared. What points the ClearContents statement to the cells on Sheet1?  It is the active sheet when the button is clicked."}, {"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "reply_to_user": {"reputation": 1, "user_id": 7231372, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e328a306e06f5009959d3c0adc5758f0?s=128&d=identicon&r=PG&f=1", "display_name": "user7231372", "link": "https://stackoverflow.com/users/7231372/user7231372"}, "edited": false, "score": 0, "creation_date": 1480619043, "post_id": 40898154, "comment_id": 69049007, "body": "You would want to change <code>Sheet2.Range(listCell).ClearContents</code> to <code>Sheet1.Range(listCell).clearContents</code> That&#39;s telling excel &quot;In Sheet1 there is a Range of cells denoted by the list of cells in <code>listCell</code>. Clear the contents of those cells in that sheet&quot;"}, {"owner": {"reputation": 1, "user_id": 7231372, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e328a306e06f5009959d3c0adc5758f0?s=128&d=identicon&r=PG&f=1", "display_name": "user7231372", "link": "https://stackoverflow.com/users/7231372/user7231372"}, "edited": false, "score": 0, "creation_date": 1481211277, "post_id": 40898154, "comment_id": 69293818, "body": "I cannot seem to resolve this.  This code still throws an 1004 error."}, {"owner": {"reputation": 1, "user_id": 7231372, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e328a306e06f5009959d3c0adc5758f0?s=128&d=identicon&r=PG&f=1", "display_name": "user7231372", "link": "https://stackoverflow.com/users/7231372/user7231372"}, "edited": false, "score": 0, "creation_date": 1481211928, "post_id": 40898154, "comment_id": 69294300, "body": "Help Please?   This code throws a 1004 error.                                       Sub clearall() Dim rngCell, listCells As String     For Each rngCell In Sheet2.Range(&quot;D1:D395&quot;).Cells         If listCell &lt;&gt; &quot;&quot; Then listCell = listCell &amp; &quot;,&quot; &amp; rngCell.Value Else listCell = rngCell.Value     Next Sheet1.Range(listCell).ClearContents  End Sub                                                                                                           When the code runs listCell contains the string of cell addresses to be cleared.  The target cells are on Sheet1."}, {"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "reply_to_user": {"reputation": 1, "user_id": 7231372, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e328a306e06f5009959d3c0adc5758f0?s=128&d=identicon&r=PG&f=1", "display_name": "user7231372", "link": "https://stackoverflow.com/users/7231372/user7231372"}, "edited": false, "score": 0, "creation_date": 1481212074, "post_id": 40898154, "comment_id": 69294414, "body": "Does the list of cells in <code>listCell</code> look like a list of cells once the <code>Sheet1.Range(listCell).clearContents</code> code runs?  Put a breakpoint on that line (using your f9 key) and run the macro and see what&#39;s happening. Is that the line that it&#39;s debugging on or does it debug before that?"}, {"owner": {"reputation": 1, "user_id": 7231372, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e328a306e06f5009959d3c0adc5758f0?s=128&d=identicon&r=PG&f=1", "display_name": "user7231372", "link": "https://stackoverflow.com/users/7231372/user7231372"}, "edited": false, "score": 0, "creation_date": 1481213150, "post_id": 40898154, "comment_id": 69295196, "body": "Yes, that line.  listCell shows &quot;B6,B12,B18.... consistent with the cell addresses to be cleared.  From the"}, {"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "reply_to_user": {"reputation": 1, "user_id": 7231372, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e328a306e06f5009959d3c0adc5758f0?s=128&d=identicon&r=PG&f=1", "display_name": "user7231372", "link": "https://stackoverflow.com/users/7231372/user7231372"}, "edited": false, "score": 0, "creation_date": 1481213456, "post_id": 40898154, "comment_id": 69295393, "body": "Are there any values in <code>listCell</code> that are blank. Like: `B6,B12,B18,,,B26,&#39;?"}, {"owner": {"reputation": 1, "user_id": 7231372, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e328a306e06f5009959d3c0adc5758f0?s=128&d=identicon&r=PG&f=1", "display_name": "user7231372", "link": "https://stackoverflow.com/users/7231372/user7231372"}, "edited": false, "score": 0, "creation_date": 1481214165, "post_id": 40898154, "comment_id": 69295866, "body": "Not sure how to see past what shows in Locals window. Every cell in Range(D1:D395) has a value.  listCell appears to contain those, but Locals window only shows me the first 20 or so values"}, {"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "reply_to_user": {"reputation": 1, "user_id": 7231372, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e328a306e06f5009959d3c0adc5758f0?s=128&d=identicon&r=PG&f=1", "display_name": "user7231372", "link": "https://stackoverflow.com/users/7231372/user7231372"}, "edited": false, "score": 0, "creation_date": 1481214216, "post_id": 40898154, "comment_id": 69295897, "body": "toss a line above that one that is erroring: <code>debug.print listCell</code> and make sure your immediate window is showing. It will dump the whole thing in the output there."}, {"owner": {"reputation": 1, "user_id": 7231372, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e328a306e06f5009959d3c0adc5758f0?s=128&d=identicon&r=PG&f=1", "display_name": "user7231372", "link": "https://stackoverflow.com/users/7231372/user7231372"}, "edited": false, "score": 0, "creation_date": 1481223224, "post_id": 40898154, "comment_id": 69301113, "body": "I really appreciate your patient assistance.  It shows all the cell addresses to clear."}, {"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "reply_to_user": {"reputation": 1, "user_id": 7231372, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e328a306e06f5009959d3c0adc5758f0?s=128&d=identicon&r=PG&f=1", "display_name": "user7231372", "link": "https://stackoverflow.com/users/7231372/user7231372"}, "edited": false, "score": 0, "creation_date": 1481226321, "post_id": 40898154, "comment_id": 69302699, "body": "Do you have any VBA events firing on that sheet that might be getting kicked off when we clear the contents? Is <code>Sheet2</code> definitely the right one. Is &quot;Sheet2&quot; the name of the tab on excel front end. For fun, try switching that code to <code>Sheets(&quot;Sheet2&quot;).Range(listCell).clearContents</code>."}, {"owner": {"reputation": 1, "user_id": 7231372, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e328a306e06f5009959d3c0adc5758f0?s=128&d=identicon&r=PG&f=1", "display_name": "user7231372", "link": "https://stackoverflow.com/users/7231372/user7231372"}, "edited": false, "score": 0, "creation_date": 1481228643, "post_id": 40898154, "comment_id": 69303861, "body": "Get Error 9 subscript out of range.   Sheet1 is where the cells to clear are located.  I note the variable listCells is declared, but listCell called in the code."}, {"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "reply_to_user": {"reputation": 1, "user_id": 7231372, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e328a306e06f5009959d3c0adc5758f0?s=128&d=identicon&r=PG&f=1", "display_name": "user7231372", "link": "https://stackoverflow.com/users/7231372/user7231372"}, "edited": false, "score": 0, "creation_date": 1481228725, "post_id": 40898154, "comment_id": 69303908, "body": "The declaration is a mistake for sure, but it won&#39;t effect the code. Feel free to change it though. If we are clearing cells in a tab named &quot;Sheet1&quot; then do a <code>Sheets(&quot;Sheet1&quot;).Range(listCells).clearContents</code>."}], "tags": [], "owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "is_accepted": false, "score": 0, "last_activity_date": 1480539830, "creation_date": 1480539830, "answer_id": 40898154, "question_id": 40897941, "link": "https://stackoverflow.com/questions/40897941/vba-excel-looping-thru-an-array/40898154#40898154", "title": "vba excel looping thru an array", "body": "<p>While you could just hard code your list in VBA instead of your <code>Sheet2</code> range, here is how you could reference that list of cells in <code>sheet2</code> and clear the contents all at once:</p>\n\n<pre><code>Sub clearall()\n    Dim rngCell, listCells As String\n    For Each rngCell In Sheet2.Range(\"D1:D395\").Cells\n        If listCell &lt;&gt; \"\" Then listCell = listCell &amp; \",\" &amp; rngCell.Value Else listCell = rngCell.Value\n    Next\n    Sheet2.Range(listCell).ClearContents\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 7231372, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e328a306e06f5009959d3c0adc5758f0?s=128&d=identicon&r=PG&f=1", "display_name": "user7231372", "link": "https://stackoverflow.com/users/7231372/user7231372"}, "edited": false, "score": 0, "creation_date": 1480603694, "post_id": 40898179, "comment_id": 69039325, "body": "Thx. my intent is to clear only specific cells in the column.  If they happen to be blank don&#39;t want that to throw an error."}], "tags": [], "owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "is_accepted": false, "score": 0, "last_activity_date": 1480539926, "creation_date": 1480539926, "answer_id": 40898179, "question_id": 40897941, "link": "https://stackoverflow.com/questions/40897941/vba-excel-looping-thru-an-array/40898179#40898179", "title": "vba excel looping thru an array", "body": "<p>If you just want to clear the cells in column A which have something in them you could use this</p>\n\n<pre><code>Sheet1.Range(\"A:A\").SpecialCells(xlCellTypeConstants).ClearContents\n'or\nSheet1.Range(\"A1:A395\").SpecialCells(xlCellTypeConstants).ClearContents\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 7231372, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e328a306e06f5009959d3c0adc5758f0?s=128&d=identicon&r=PG&f=1", "display_name": "user7231372", "link": "https://stackoverflow.com/users/7231372/user7231372"}, "edited": false, "score": 0, "creation_date": 1480610741, "post_id": 40899306, "comment_id": 69044154, "body": "Yeah,  some of the target cells may be blank."}], "tags": [], "owner": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "is_accepted": false, "score": 0, "last_activity_date": 1480544415, "creation_date": 1480544415, "answer_id": 40899306, "question_id": 40897941, "link": "https://stackoverflow.com/questions/40897941/vba-excel-looping-thru-an-array/40899306#40899306", "title": "vba excel looping thru an array", "body": "<p>The VBA <code>Join</code> function can be used to join values into string, and the Excel <code>Transpose</code> function is needed to \"flip\" the column values 2D array to a 1D row values array:</p>\n\n<pre><code>stringAdress = Join([Transpose(Sheet2!D1:D395)], \",\")\n\nThisWorkbook.Worksheets(\"Sheet1\").Range(stringAdress).ClearContents\n</code></pre>\n\n<p>If any of the cells in the <code>Sheet2!D1:D395</code> range are blank, the above will result in error. </p>\n\n<p>In Excel 2016, the <a href=\"https://support.office.com/en-us/article/TEXTJOIN-function-357b449a-ec91-49d0-80c3-0e8fc845691c\" rel=\"nofollow noreferrer\"><code>TextJoin</code></a> function can be used to ignore empty cells (not tested):</p>\n\n<pre><code>stringAdress = [TextJoin(\",\", True, Sheet2!D1:D395)]\n\nThisWorkbook.Worksheets(\"Sheet1\").Range(stringAdress).ClearContents\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 7231372, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e328a306e06f5009959d3c0adc5758f0?s=128&d=identicon&r=PG&f=1", "display_name": "user7231372", "link": "https://stackoverflow.com/users/7231372/user7231372"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 101, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1480544415, "creation_date": 1480538977, "last_edit_date": 1531164843, "question_id": 40897941, "link": "https://stackoverflow.com/questions/40897941/vba-excel-looping-thru-an-array", "title": "vba excel looping thru an array", "body": "<p>I'm a rookie at vba.\nI created a solution that works on a micro basis, but can't get the same code to run when I add additional parameters to that code. \nI created a multiple choice quiz with answer cells which test against the answers on a separate (hidden) sheet.  An adjacent cell shows Yes or No response.  That functionality which I researched on the web works well.  I'm trying to clear.contents for all the cells so that the user can complete the quiz, clear all responses to give it another go. </p>\n\n<p>I have 395 questions which I created code to clear \"Range(\"B2\").ClearContents\"\nMy subroutine has 395 such commands and takes 45-60 seconds.  I'm looking for a more efficient solution.  I don't want to clear the entire column only the 395 non-adjacent cells which have user input.</p>\n\n<pre><code>Sub Test_Clear()\nRange(\"B2,B5,B7,B9,B11\").ClearContents\nEnd Sub\n</code></pre>\n\n<p>My list of cells is on Sheet2  D1:D395  Each cell in D1:D395 lists a cell on Sheet1 which I want to clear (i.e. B6, B11, B17, B22, B35 etc.) How can I reference those cells on Sheet2 and perform the ClearContents?</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 7040135, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a87d9f7b6fb54d7fa847a10b982d469?s=128&d=identicon&r=PG&f=1", "display_name": "andnand", "link": "https://stackoverflow.com/users/7040135/andnand"}, "edited": false, "score": 0, "creation_date": 1480539881, "post_id": 40897904, "comment_id": 69010069, "body": "Thank you. 2nd part missing but Thanks"}, {"owner": {"user_type": "does_not_exist", "display_name": "user1641172"}, "reply_to_user": {"reputation": 1, "user_id": 7040135, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a87d9f7b6fb54d7fa847a10b982d469?s=128&d=identicon&r=PG&f=1", "display_name": "andnand", "link": "https://stackoverflow.com/users/7040135/andnand"}, "edited": false, "score": 0, "creation_date": 1480540176, "post_id": 40897904, "comment_id": 69010223, "body": "You can get the whole row too, it&#39;s usually one question and answer per post on this site mind ;-)"}, {"owner": {"user_type": "does_not_exist", "display_name": "user1641172"}, "reply_to_user": {"reputation": 1, "user_id": 7040135, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a87d9f7b6fb54d7fa847a10b982d469?s=128&d=identicon&r=PG&f=1", "display_name": "andnand", "link": "https://stackoverflow.com/users/7040135/andnand"}, "edited": false, "score": 0, "creation_date": 1480540474, "post_id": 40897904, "comment_id": 69010381, "body": "added a bit to set the whole row to the same <code>color</code>, note the use of <code>color</code> instead of <code>colorindex</code> for the <code>entireRow</code>"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user1641172"}, "is_accepted": true, "score": 1, "last_activity_date": 1480540147, "last_edit_date": 1480540147, "creation_date": 1480538850, "answer_id": 40897904, "question_id": 40897745, "link": "https://stackoverflow.com/questions/40897745/cell-interior-color-index-excel-vba/40897904#40897904", "title": "Cell Interior Color Index Excel VBA", "body": "<p>The sheetchange function has <code>target</code> as an argument, that's the cell that you changed. You can use it to change the relevant cell:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    If Target.Column = 2 Then\n        Target.Offset(0,1).Interior.ColorIndex = Target.Value\n        'and for the whole row\n        Target.EntireRow.Interior.Color = Target.Offset(0,1).Interior.Color\n    Endif \nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 7040135, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a87d9f7b6fb54d7fa847a10b982d469?s=128&d=identicon&r=PG&f=1", "display_name": "andnand", "link": "https://stackoverflow.com/users/7040135/andnand"}, "edited": false, "score": 0, "creation_date": 1480539929, "post_id": 40897949, "comment_id": 69010095, "body": "Thank you, works great, how about partial row until last column has data"}], "tags": [], "owner": {"reputation": 922, "user_id": 6124497, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7cc7e273f4fb6461113b19f47881f18d?s=128&d=identicon&r=PG&f=1", "display_name": "nvkrj", "link": "https://stackoverflow.com/users/6124497/nvkrj"}, "is_accepted": false, "score": 0, "last_activity_date": 1480574427, "last_edit_date": 1480574427, "creation_date": 1480539005, "answer_id": 40897949, "question_id": 40897745, "link": "https://stackoverflow.com/questions/40897745/cell-interior-color-index-excel-vba/40897949#40897949", "title": "Cell Interior Color Index Excel VBA", "body": "<p>Right click on the sheet's name on which you want this functionality, and click on 'View Code'.</p>\n\n<p>Now you need to write a VBA function that fires on any change to the worksheet. This is an inbuilt function called <code>Worksheet_Change(Range)</code>. The range object (it's argument) is the range that had changed when this function fired.</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\nEnd Sub\n</code></pre>\n\n<p>Inside the function you need to check whether the changed cell was in column B. This is done by the Column property of the Target range.</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    If Target.Column = 2 Then\n        ' The changed cell was in column B\n    End If\nEnd Sub\n</code></pre>\n\n<p>Now you need to get the cell's value and put it as the row's ColorIndex.</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    If Target.Column = 2 Then\n        ColorValue = Target.Value\n        Target.EntireRow.Interior.ColorIndex = ColorValue\n    End If\nEnd Sub\n</code></pre>\n\n<p>Edit: To color the cells only till the last value in the row, you need to count the number of filled cells in the row. The following code does that (see the comments to understand it)</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\n    ' Check if the edited cell is in column B\n    If Target.Column = 2 Then\n\n        ' Get the value of the edited cell\n        ColorValue = Target.Value\n\n        ' Get the row number of the edited cell\n        RowNumber = Target.Row\n\n        ' Get the number of filled cells in this row\n        CellsCount = Application.WorksheetFunction.CountA(Range(RowNumber &amp; \":\" &amp; RowNumber))\n\n        ' Apply the color formatting till the last column in this row\n        Range(Cells(RowNumber, 1), Cells(RowNumber, CellsCount)).Interior.ColorIndex = ColorValue\n\n    End If\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 526, "user_id": 7164307, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/b469705184f2479532aec6bc97f25b46?s=128&d=identicon&r=PG&f=1", "display_name": "D. O.", "link": "https://stackoverflow.com/users/7164307/d-o"}, "is_accepted": false, "score": 0, "last_activity_date": 1480539974, "creation_date": 1480539974, "answer_id": 40898186, "question_id": 40897745, "link": "https://stackoverflow.com/questions/40897745/cell-interior-color-index-excel-vba/40898186#40898186", "title": "Cell Interior Color Index Excel VBA", "body": "<p>The code of Nick Dewitt is OK, but it color only the column C.</p>\n\n<p>If you want to color the entire row, starting from C depending of how much columns are in the row :</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    Dim lastcol As Integer, i As Integer\n\n    If Target.Column = 2 Then\n        lastcol = Cells(Target.Row, Columns.Count).End(xlToLeft).Column\n        For i = 3 To lastcol\n            Target.Offset(0, i - 2).Interior.ColorIndex = Target.Value\n        Next i\n    End If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 7040135, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a87d9f7b6fb54d7fa847a10b982d469?s=128&d=identicon&r=PG&f=1", "display_name": "andnand", "link": "https://stackoverflow.com/users/7040135/andnand"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1905, "favorite_count": 0, "accepted_answer_id": 40897904, "answer_count": 3, "score": 0, "last_activity_date": 1480574427, "creation_date": 1480538304, "question_id": 40897745, "link": "https://stackoverflow.com/questions/40897745/cell-interior-color-index-excel-vba", "title": "Cell Interior Color Index Excel VBA", "body": "<p>Based on a language table, column A = Language, B = number, C = coloredcell</p>\n\n<p>I would like to know what is the VBA so whenever I type a number on Column B (using Workbook_SheetChange), C is colored with the Colorindex equal to the number typed.</p>\n\n<p>On the other hand, and I am sure is part of the solution to the previous question, on VBA how do I write cell.Interior.ColorIndex = (a specific cell value, If B2=4 -> for the row, whole or until last column has data, cell.Interior.ColorIndex = 4) and color the whole row.</p>\n\n<p>Thank you</p>\n"}, {"tags": ["excel", "ms-office", "onenote", "onenote-api", "vba"], "comments": [{"owner": {"reputation": 6095, "user_id": 1274820, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/620aa435151f022b9c4070eae088d788?s=128&d=identicon&r=PG", "display_name": "user1274820", "link": "https://stackoverflow.com/users/1274820/user1274820"}, "edited": false, "score": 0, "creation_date": 1481146566, "post_id": 40897339, "comment_id": 69263013, "body": "Can&#39;t you save onenote files as .xls or .xlsx? Might be worth a try? <a href=\"https://support.office.com/en-us/article/Convert-a-OneNote-table-to-an-Excel-worksheet-f693d0ec-aad7-4441-9596-e5e1e641935d\" rel=\"nofollow noreferrer\">support.office.com/en-us/article/&hellip;</a>"}, {"owner": {"reputation": 1048, "user_id": 2246694, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/dc41ea5df1de5d3f193ea41ad197700b?s=128&d=identicon&r=PG", "display_name": "cdhagmann", "link": "https://stackoverflow.com/users/2246694/cdhagmann"}, "reply_to_user": {"reputation": 6095, "user_id": 1274820, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/620aa435151f022b9c4070eae088d788?s=128&d=identicon&r=PG", "display_name": "user1274820", "link": "https://stackoverflow.com/users/1274820/user1274820"}, "edited": false, "score": 0, "creation_date": 1481217105, "post_id": 40897339, "comment_id": 69297807, "body": "@user1274820 it causes the same issues"}], "owner": {"reputation": 1048, "user_id": 2246694, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/dc41ea5df1de5d3f193ea41ad197700b?s=128&d=identicon&r=PG", "display_name": "cdhagmann", "link": "https://stackoverflow.com/users/2246694/cdhagmann"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 81, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1481146081, "creation_date": 1480536864, "last_edit_date": 1531161705, "question_id": 40897339, "link": "https://stackoverflow.com/questions/40897339/merge-cells-and-content-in-excel", "title": "Merge cells and content in Excel", "body": "<p>I have a table in OneNote 2013 with 200 rows and 8 columns. The data looks something like this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/Dbtpi.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Dbtpi.png\" alt=\"enter image description here\"></a></p>\n\n<p>I have been tasked with transfering it to Excel. However, a simple copy and paste yields:</p>\n\n<p><a href=\"https://i.stack.imgur.com/PE3eo.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/PE3eo.png\" alt=\"enter image description here\"></a></p>\n\n<p>Is there a way that I might be able to make it look more like the original, or something like this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/SuY5x.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/SuY5x.png\" alt=\"enter image description here\"></a></p>\n\n<p>I know the basics of VBA and I have a guess that I could use the fact that Column A is always shown as spanning even is the number of bullet points, etcetera changes.</p>\n"}, {"tags": ["vba", "excel", "ms-access", "odbc", "ado"], "answers": [{"tags": [], "owner": {"reputation": 3238, "user_id": 3042438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b930cad6b909cf6546dfe29bdeb8af88?s=128&d=identicon&r=PG&f=1", "display_name": "SunKnight0", "link": "https://stackoverflow.com/users/3042438/sunknight0"}, "is_accepted": false, "score": 3, "last_activity_date": 1480536848, "creation_date": 1480536848, "answer_id": 40897332, "question_id": 40897048, "link": "https://stackoverflow.com/questions/40897048/does-the-ms-access-database-odbc-driver-support-multiple-users/40897332#40897332", "title": "Does the &quot;MS Access Database&quot; ODBC driver support multiple users?", "body": "<p>Generally, yes. I run some web based applications using Access as the back end via ODBC and there has never been a problem with concurrency.</p>\n\n<p>Be aware however that the ODBC driver is not IP based, it needs local or network share access to the database file.</p>\n"}, {"tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": false, "score": 1, "last_activity_date": 1480579179, "creation_date": 1480579179, "answer_id": 40905367, "question_id": 40897048, "link": "https://stackoverflow.com/questions/40897048/does-the-ms-access-database-odbc-driver-support-multiple-users/40905367#40905367", "title": "Does the &quot;MS Access Database&quot; ODBC driver support multiple users?", "body": "<p>Excel VBA can via DAO connect to the Access database file directly and with a maximum of 255 users concurrently.</p>\n\n<p>No need to bother with ODBC.</p>\n"}], "owner": {"reputation": 858, "user_id": 2496046, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/bd9b13a03c118e4d796f5e2d3f290e6d?s=128&d=identicon&r=PG", "display_name": "Greg Lovern", "link": "https://stackoverflow.com/users/2496046/greg-lovern"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 223, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1480579179, "creation_date": 1480535787, "question_id": 40897048, "link": "https://stackoverflow.com/questions/40897048/does-the-ms-access-database-odbc-driver-support-multiple-users", "title": "Does the &quot;MS Access Database&quot; ODBC driver support multiple users?", "body": "<p>I'm writing a tool in Excel VBA that will need to write to a simple table on the organization's network. Several people will be using the tool to write to that table, possibly at the same time.</p>\n\n<p>I had hoped to use the ODBC text driver to write to a CSV file to use as the table, but I see that it does not support multiple users.</p>\n\n<p>What about the \"MS Access Database\" odbc driver? If I use ADO to create and manage that database, will multiple users be able to write to it at the same time?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user1641172"}, "edited": false, "score": 2, "creation_date": 1480535630, "post_id": 40896948, "comment_id": 69007763, "body": "you aren&#39;t incrementing reportRow inside the loop, you are incrementing linecount so the do loop will never finish if cell(3,1) is not blank."}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user1641172"}, "is_accepted": true, "score": 2, "last_activity_date": 1480535803, "creation_date": 1480535803, "answer_id": 40897052, "question_id": 40896948, "link": "https://stackoverflow.com/questions/40896948/loop-causing-excel-to-freeze/40897052#40897052", "title": "loop causing excel to freeze?", "body": "<p>You need to increment <code>reportRow</code> in the do loop or it won't finish.</p>\n\n<pre><code>Do While cooSummary.Cells(reportRow, 1) &lt;&gt; \"\"\n    lineCount = lineCount + 1  \n    reportRow = reportRow + 1\nLoop\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 7095841, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/81504fc7aafdb3da2999fcc09fe292bc?s=128&d=identicon&r=PG&f=1", "display_name": "Ravi Gowda", "link": "https://stackoverflow.com/users/7095841/ravi-gowda"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 39, "favorite_count": 0, "accepted_answer_id": 40897052, "answer_count": 1, "score": 0, "last_activity_date": 1480535803, "creation_date": 1480535420, "last_edit_date": 1531164843, "question_id": 40896948, "link": "https://stackoverflow.com/questions/40896948/loop-causing-excel-to-freeze", "title": "loop causing excel to freeze?", "body": "<p>I am trying to copy contents from each variable in a collection and it freezes everytime it runs the first file</p>\n\n<pre><code>RecursiveDir colFiles, path, \"*.xlsm\", True\nFor Each varFile In colFiles\n    lineCount = 0\n    reportRow = 3\n    Set reportBook = Workbooks.Open(varFile)\n    Set cooSummary = reportBook.Sheets(\"Audit\")\n    Do While cooSummary.Cells(reportRow, 1) &lt;&gt; \"\"\n        lineCount = lineCount + 1  \n    Loop\n    lineNum = lineNum + 1\n    With cooSummary\n         scanDate = FileDateTime(varFile)\n         scanned = lineCount\n         auditor = .Cells(1, 2)\n    End With\n    ReDim Preserve reportArray(3, lineNum)\n    reportArray(0, lineNum) = scanDate\n    reportArray(1, lineNum) = scanned\n    reportArray(2, lineNum) = auditor\n    reportRow = reportRow + 1\n    reportBook.Close SaveChanges:=False\nNext varFile\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 4173, "user_id": 2895550, "user_type": "registered", "profile_image": "https://graph.facebook.com/1184544414/picture?type=large", "display_name": "Wayne G. Dunn", "link": "https://stackoverflow.com/users/2895550/wayne-g-dunn"}, "edited": false, "score": 4, "creation_date": 1480533805, "post_id": 40896428, "comment_id": 69006897, "body": "You have the file you are trying to copy already open. You either need to copy before opening, or use a &#39;SaveAs&#39;."}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 4173, "user_id": 2895550, "user_type": "registered", "profile_image": "https://graph.facebook.com/1184544414/picture?type=large", "display_name": "Wayne G. Dunn", "link": "https://stackoverflow.com/users/2895550/wayne-g-dunn"}, "edited": false, "score": 0, "creation_date": 1480533826, "post_id": 40896428, "comment_id": 69006907, "body": "@WayneG.Dunn beat me with 7 seconds :)"}, {"owner": {"reputation": 241, "user_id": 6654790, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/9019a96fdfbf926d154a20a696611015?s=128&d=identicon&r=PG&f=1", "display_name": "bdpolinsky", "link": "https://stackoverflow.com/users/6654790/bdpolinsky"}, "edited": false, "score": 0, "creation_date": 1480535235, "post_id": 40896428, "comment_id": 69007552, "body": "wayne G dunn has it correct."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1480536573, "post_id": 40896428, "comment_id": 69008258, "body": "If you continue to use your own <code>copyFile</code> <code>Sub</code> (I refuse to call it a <code>Function</code> because you aren&#39;t returning a value!), you will also need to change <code>fso.copyFile sourceFile, targetFile</code> to <code>fso.copyFile sourceFile.FullName, targetFile</code> because the default property of <code>sourceFile</code> in that situation is just the <code>.Name</code> property (i.e. without a path)."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1480536723, "post_id": 40896428, "comment_id": 69008334, "body": "P.S.  Changing <code>sourceFile</code> to <code>sourceFile.FullName</code> would actually allow your code to work (despite the file being open), but it is almost certainly not what you want to happen.  (Assuming, of course, that <code>&quot;C:\\original\\path\\here&quot;</code> is actually the name of a Word document and not just a path.)"}], "answers": [{"comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1480537017, "post_id": 40896641, "comment_id": 69008496, "body": "Once you perform <code>objDoc.Close</code> you won&#39;t be able to get at its <code>Name</code> property (or, better still, its <code>FullName</code> property) for use in the <code>FileCopy</code> command."}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 0, "last_activity_date": 1480534257, "last_edit_date": 1495540903, "creation_date": 1480534257, "answer_id": 40896641, "question_id": 40896428, "link": "https://stackoverflow.com/questions/40896428/printing-a-word-document-from-excel-vba/40896641#40896641", "title": "Printing a word document from excel vba", "body": "<p>Try something like this:</p>\n\n<pre><code> Sub UpdateActionsRows()\n\n    Dim userInput As Long\n    userInput = 50\n\n' set up word application, document\n    Dim objWord As Word.Application\n    Dim objDoc As Document\n\n    Set objWord = CreateObject(\"Word.Application\")\n    Set objDoc = objWord.Documents.Open(\"C:\\original\\path\\here\")\n    objDoc.Close\n\n    FileCopy objDoc, \"C:\\original\\path\\there\"\n    objWord.Quit\nEnd Sub\n</code></pre>\n\n<p>I have not tested it and it can be written better, but is hopefully works. And as  @Wayne G. Dunn, the error is because you are trying to copy opened file. Here you may see more - <a href=\"https://stackoverflow.com/questions/16943003/vba-to-copy-a-file-from-one-directory-to-another\">VBA to copy a file from one directory to another</a></p>\n"}], "owner": {"reputation": 241, "user_id": 6654790, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/9019a96fdfbf926d154a20a696611015?s=128&d=identicon&r=PG&f=1", "display_name": "bdpolinsky", "link": "https://stackoverflow.com/users/6654790/bdpolinsky"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1471, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1480534257, "creation_date": 1480533425, "question_id": 40896428, "link": "https://stackoverflow.com/questions/40896428/printing-a-word-document-from-excel-vba", "title": "Printing a word document from excel vba", "body": "<p>The following code, when finished, is supposed to get user input of a number (here its hardcoded to 50, and doesn't focus on a specific row - it doesn't feed the data in); look up that specific row or rows in a sheet, copy a blank template of the word document, feed that data into a word document in a specific order, and then print the word document.  </p>\n\n<p>The code below what it tries to do is, using excel, copy a word document located at C:\\original\\path\\here to C:\\original\\path\\there. Unfortunately, each time I try running this in Microsoft excel, Excel hangs and then I have to restart it.</p>\n\n<p>So why? What needs to be done? Microsoft word Object Library 14 is referenced in the VBA editor.</p>\n\n<pre><code> Sub UpdateActionsRows()\n\n    Dim userInput As Long\n    userInput = 50\n\n' set up word application, document\n    Dim objWord As Word.Application\n    Dim objDoc As Document\n\n    Set objWord = CreateObject(\"Word.Application\")\n    Set objDoc = objWord.Documents.Open(\"C:\\original\\path\\here\")\n\n    copyFile objDoc, userInput\n\n    objDoc.Close\n    objWord.Quit\nEnd Sub\n</code></pre>\n\n<p>copyfile</p>\n\n<pre><code>Function copyFile(sourceFile As Document, inputRows As Long)\n    Dim fso As Object\n    Set fso = VBA.CreateObject(\"Scripting.FileSystemObject\")\n\n    Dim targetFile As String\n    targetFile = \"C:\\original\\file\\there.docx\" \n    fso.copyFile sourceFile, targetFile\n\nEnd Function\n</code></pre>\n"}, {"tags": ["excel", "macros", "vba"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 3, "creation_date": 1480533137, "post_id": 40896294, "comment_id": 69006493, "body": "there is no column 0.  Column A is 1 not 0."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1480537664, "post_id": 40896294, "comment_id": 69008806, "body": "As Scott mentioned, there is no column 0.  However ... are you really trying to access column 0, or are you trying to perform some sort of Offset from the current cell?  At the moment your code, even if you change the <code>, 0</code> and <code>, 1</code> to <code>, 1</code> and <code>, 2</code> respectively, is just taking the one (active) cell and placing that same value into 10 rows with the same corresponding description placed into the column next to it.  Are you instead trying to process the 10 different values in the 10 rows starting from the current cell?"}], "answers": [{"comments": [{"owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "edited": false, "score": 0, "creation_date": 1480535070, "post_id": 40896854, "comment_id": 69007467, "body": "Ups, sorry, did not see Scott&#39;s comment"}, {"owner": {"reputation": 1, "user_id": 7232621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ee4838dd7c83242992423db7fb427f92?s=128&d=identicon&r=PG&f=1", "display_name": "B.Prasad", "link": "https://stackoverflow.com/users/7232621/b-prasad"}, "edited": false, "score": 0, "creation_date": 1480576040, "post_id": 40896854, "comment_id": 69021921, "body": "Scott Craner, Actually I want to create a macro for given set of data. Let say there is a column and which include the monthly income of several people. I want to catergorize as &gt;10000 &quot;low income&quot;, 10001-50000: Medium income and &gt;50000 then High income. Inthe same time i want to count the number of data in each category. Please help me to write that macro"}], "tags": [], "owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "is_accepted": false, "score": 0, "last_activity_date": 1480535030, "creation_date": 1480535030, "answer_id": 40896854, "question_id": 40896294, "link": "https://stackoverflow.com/questions/40896294/vba-excel-macro/40896854#40896854", "title": "VBA-Excel Macro", "body": "<p>There is  no Cells (1,0). The index for row or column always starts with 1</p>\n"}], "owner": {"reputation": 1, "user_id": 7232621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ee4838dd7c83242992423db7fb427f92?s=128&d=identicon&r=PG&f=1", "display_name": "B.Prasad", "link": "https://stackoverflow.com/users/7232621/b-prasad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 39, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1480537367, "creation_date": 1480532943, "last_edit_date": 1531164843, "question_id": 40896294, "link": "https://stackoverflow.com/questions/40896294/vba-excel-macro", "title": "VBA-Excel Macro", "body": "<p>Please help me to solve this. Once I run this VBA macro it shows an error mentioning the Application-defined or object define error. </p>\n\n<p>Code:</p>\n\n<pre><code>Sub income_status()\nDim i As Integer\n\nFor i = 1 To 10\n  Cells(i, 0) = ActiveCell.Value\n\n  If Cells(i, 0) &lt;= 10000 Then\n    Cells(i, 1) = \"Low Income\"\n  ElseIf Cells(i, 0) &gt; 10000 And Cells(i, 0) &lt;= 50000 Then\n    Cells(i, 1) = \"Medium Income\"\n  Else\n    Cells(i, 1) = \"High Income\"\n  End If    \nNext i\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "ms-word"], "answers": [{"tags": [], "owner": {"reputation": 858, "user_id": 2496046, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/bd9b13a03c118e4d796f5e2d3f290e6d?s=128&d=identicon&r=PG", "display_name": "Greg Lovern", "link": "https://stackoverflow.com/users/2496046/greg-lovern"}, "is_accepted": false, "score": 0, "last_activity_date": 1480537686, "creation_date": 1480537686, "answer_id": 40897565, "question_id": 40895647, "link": "https://stackoverflow.com/questions/40895647/word-vba-to-refresh-embedded-excel-chart/40897565#40897565", "title": "Word VBA to refresh embedded Excel chart", "body": "<p>I found the answer here:</p>\n\n<p><a href=\"http://answers.microsoft.com/en-us/msoffice/forum/msoffice_word-msoffice_custom/what-is-the-vba-equivalent-of-refresh-data-for/b8405aca-716a-e011-8dfc-68b599b31bf5\" rel=\"nofollow noreferrer\">http://answers.microsoft.com/en-us/msoffice/forum/msoffice_word-msoffice_custom/what-is-the-vba-equivalent-of-refresh-data-for/b8405aca-716a-e011-8dfc-68b599b31bf5</a></p>\n\n<pre><code>thisdocument.InlineShapes(1).LinkFormat.Update\n</code></pre>\n\n<p>It worked fine in my tests.</p>\n\n<p>And to break the link (in the word template) after updating, to avoid inadvertently updating the chart to one from a later run showing different data:</p>\n\n<pre><code>thisdocument.InlineShapes(1).LinkFormat.BreakLink\n</code></pre>\n"}], "owner": {"reputation": 858, "user_id": 2496046, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/bd9b13a03c118e4d796f5e2d3f290e6d?s=128&d=identicon&r=PG", "display_name": "Greg Lovern", "link": "https://stackoverflow.com/users/2496046/greg-lovern"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1326, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1480537686, "creation_date": 1480530627, "last_edit_date": 1531164843, "question_id": 40895647, "link": "https://stackoverflow.com/questions/40895647/word-vba-to-refresh-embedded-excel-chart", "title": "Word VBA to refresh embedded Excel chart", "body": "<p>I have embedded charts in a Word doc. When I update the data in Excel, so that the chart in the Excel workbook updates, and then go to the Word doc, I can manually select the embedded chart, select Design > Refresh Data, and the embedded chart in Word updates to show the new data.</p>\n\n<p>When I try to record the Word VBA to do that, it won't let me do those actions.</p>\n\n<p>I've looked everywhere I can think of in Word's object browser. I see that I can identify the embedded chart like this:</p>\n\n<pre><code>thisdocument.InlineShapes(1)\n</code></pre>\n\n<p>But I don't see how to refresh it. What do I need to do?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 717, "user_id": 5363379, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/a0abd0a1495ff633ee9f3c0d06d50c6c?s=128&d=identicon&r=PG&f=1", "display_name": "tjb1", "link": "https://stackoverflow.com/users/5363379/tjb1"}, "edited": false, "score": 0, "creation_date": 1480528374, "post_id": 40894940, "comment_id": 69003867, "body": "Has nothing to do with <code>ws.Range(&quot;A6:G&quot; &amp; lastRow).Copy     ActiveSheet.Range(&quot;A2&quot;).End(xlUp).Insert shift:=xlDown</code> ??"}, {"owner": {"reputation": 739, "user_id": 2259735, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/b5c3cfaaaae0be97a5d9a22e702202e4?s=128&d=identicon&r=PG", "display_name": "jonplaca", "link": "https://stackoverflow.com/users/2259735/jonplaca"}, "reply_to_user": {"reputation": 717, "user_id": 5363379, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/a0abd0a1495ff633ee9f3c0d06d50c6c?s=128&d=identicon&r=PG&f=1", "display_name": "tjb1", "link": "https://stackoverflow.com/users/5363379/tjb1"}, "edited": false, "score": 0, "creation_date": 1480528563, "post_id": 40894940, "comment_id": 69003984, "body": "@tjb1 - no (I do not think so), that portion is looking at the other sheets, copying relevant cells and columns, and then inserting the cells into the consolidated worksheet."}, {"owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "edited": false, "score": 0, "creation_date": 1480529401, "post_id": 40894940, "comment_id": 69004466, "body": "I ran your code and did not have any unintended rows added to the CONSOLIDATED worksheet at all. It seemed to work fine. Perhaps you have other UDFs or an add-in or something else at work?"}, {"owner": {"reputation": 1987, "user_id": 4434652, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/94ee978abf31b6cb604ec929a54ae4e1?s=128&d=identicon&r=PG&f=1", "display_name": "Brian", "link": "https://stackoverflow.com/users/4434652/brian"}, "edited": false, "score": 0, "creation_date": 1480532166, "post_id": 40894940, "comment_id": 69005974, "body": "I am wondering something about this line: <code>ws.Range(&quot;A6:G&quot; &amp; lastRow).Copy</code>. Does <code>lastRow</code> ever return a value of <code>&lt;6</code>? When I put <code>? Range(&quot;A6:G1&quot;).Address</code> in the immediate window it returns <code>$A$1:$G$6</code>."}, {"owner": {"reputation": 1987, "user_id": 4434652, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/94ee978abf31b6cb604ec929a54ae4e1?s=128&d=identicon&r=PG&f=1", "display_name": "Brian", "link": "https://stackoverflow.com/users/4434652/brian"}, "edited": false, "score": 0, "creation_date": 1480532344, "post_id": 40894940, "comment_id": 69006070, "body": "And are there 6 worksheets you are looping through? It may be copying a blank row for each worksheet."}, {"owner": {"reputation": 739, "user_id": 2259735, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/b5c3cfaaaae0be97a5d9a22e702202e4?s=128&d=identicon&r=PG", "display_name": "jonplaca", "link": "https://stackoverflow.com/users/2259735/jonplaca"}, "reply_to_user": {"reputation": 1987, "user_id": 4434652, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/94ee978abf31b6cb604ec929a54ae4e1?s=128&d=identicon&r=PG&f=1", "display_name": "Brian", "link": "https://stackoverflow.com/users/4434652/brian"}, "edited": false, "score": 0, "creation_date": 1480532586, "post_id": 40894940, "comment_id": 69006212, "body": "@Brian - good questions. <code>lastRow</code> is always &gt; 6 and there are never any blank rows in the copied data"}, {"owner": {"reputation": 1987, "user_id": 4434652, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/94ee978abf31b6cb604ec929a54ae4e1?s=128&d=identicon&r=PG&f=1", "display_name": "Brian", "link": "https://stackoverflow.com/users/4434652/brian"}, "edited": false, "score": 0, "creation_date": 1480532692, "post_id": 40894940, "comment_id": 69006263, "body": "@jonplaca So there is always, at least, one row of data to be copied from each worksheet? How many worksheets are being looped?"}, {"owner": {"reputation": 739, "user_id": 2259735, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/b5c3cfaaaae0be97a5d9a22e702202e4?s=128&d=identicon&r=PG", "display_name": "jonplaca", "link": "https://stackoverflow.com/users/2259735/jonplaca"}, "reply_to_user": {"reputation": 1987, "user_id": 4434652, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/94ee978abf31b6cb604ec929a54ae4e1?s=128&d=identicon&r=PG&f=1", "display_name": "Brian", "link": "https://stackoverflow.com/users/4434652/brian"}, "edited": false, "score": 0, "creation_date": 1480532881, "post_id": 40894940, "comment_id": 69006356, "body": "@brian - yes, each sheet has at least 1 row of data (an average of ~240 rows per copy procedure). Roughly 14 sheets total"}, {"owner": {"reputation": 739, "user_id": 2259735, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/b5c3cfaaaae0be97a5d9a22e702202e4?s=128&d=identicon&r=PG", "display_name": "jonplaca", "link": "https://stackoverflow.com/users/2259735/jonplaca"}, "reply_to_user": {"reputation": 1987, "user_id": 4434652, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/94ee978abf31b6cb604ec929a54ae4e1?s=128&d=identicon&r=PG&f=1", "display_name": "Brian", "link": "https://stackoverflow.com/users/4434652/brian"}, "edited": false, "score": 0, "creation_date": 1480534177, "post_id": 40894940, "comment_id": 69007057, "body": "@Brian - For now, I am just going to deal with this error. Some users have pointed out that they haven&#39;t had an issue so perhaps it&#39;s a client-side error. Thanks for the feedback!"}], "answers": [{"comments": [{"owner": {"reputation": 739, "user_id": 2259735, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/b5c3cfaaaae0be97a5d9a22e702202e4?s=128&d=identicon&r=PG", "display_name": "jonplaca", "link": "https://stackoverflow.com/users/2259735/jonplaca"}, "edited": false, "score": 0, "creation_date": 1480544826, "post_id": 40898682, "comment_id": 69012498, "body": "Wow, this is noticeably faster. However, at <code>.Cells(.Rows.Count,1).End(xlUp).Offset(1)... &#39;&lt;--| just copy values and speed things up!</code> I get an <code>Object Defined Error: 1004</code>. Yet, despite this error, the values are properly pasted (however, the submodule just quits and doesn&#39;t proceed onto <code>addHeaders .Name</code>. I believe this might be an issue w.r.t <code>ws.Range(&quot;A6:G&quot; &amp; lastRow)..</code> but always find these errors the most difficult :("}, {"owner": {"reputation": 739, "user_id": 2259735, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/b5c3cfaaaae0be97a5d9a22e702202e4?s=128&d=identicon&r=PG", "display_name": "jonplaca", "link": "https://stackoverflow.com/users/2259735/jonplaca"}, "edited": false, "score": 0, "creation_date": 1480545399, "post_id": 40898682, "comment_id": 69012789, "body": "&quot;1&quot; which shouldn&#39;t be the case since all ranges &gt; 1. Note, when the function runs, it pastes all the proper information into CONSOLIDATED, but leaves 1, blank row at the top of the CONSOLIDATED sheet (prior to adding headers). I started to think that perhaps the function was also running on the CONSOLIDATE page in it&#39;s final stage, resulting in <code>lastRow</code> = <code>1</code>, but the <code>Select Case ws.Name...do nothing</code> statement should exempt the CONSOLIDATED worksheet from being effected."}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "reply_to_user": {"reputation": 739, "user_id": 2259735, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/b5c3cfaaaae0be97a5d9a22e702202e4?s=128&d=identicon&r=PG", "display_name": "jonplaca", "link": "https://stackoverflow.com/users/2259735/jonplaca"}, "edited": false, "score": 0, "creation_date": 1480545555, "post_id": 40898682, "comment_id": 69012875, "body": "this means that the current <code>ws</code> column &quot;E&quot;  has no data, thus resulting in <code>lastRow = 1</code>. Check <code>ws.name</code> when it errors out and see why that worksheet has no data in column &quot;E&quot;"}], "tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": true, "score": 1, "last_activity_date": 1480541783, "creation_date": 1480541783, "answer_id": 40898682, "question_id": 40894940, "link": "https://stackoverflow.com/questions/40894940/vba-unexpected-row-insert/40898682#40898682", "title": "VBA - Unexpected row insert", "body": "<p>your issues derives from use of <code>Activate</code>/<code>ActiveSheet</code></p>\n\n<p>you have to abandon this coding habit, that can subtly mislead you, and use <em>fully qualified range references</em> to assure you're acting on wanted workbook/worksheet range </p>\n\n<p>here follows a refactoring of your code with such <em>fully qualified range references</em> and a \"Value to Value\" <code>range</code> copy instead of a <code>Copy</code>/<code>Insert</code> to considerably speed things up:</p>\n\n<pre><code>Option Explicit\n\nSub consolidateConvert()\n    Dim ws As Worksheet\n    Dim lastRow As Long\n\n    With Worksheets(\"CONSOLIDATED\") '&lt;--| reference \"CONSOLIDATED\" worksheet\n        .UsedRange.ClearContents '&lt;--| clear its content\n\n        'Iterate through workbooks\n        For Each ws In Worksheets\n            Select Case ws.Name\n                Case \"CONSOLIDATED\", \"PIVOT\", \"TITLE\", \"APPENDIX - CURRENCY CONVERTER\", \"MACRO\" ' &lt;--| discard \"CONSOLIDATED\", \"TITLE\", \"PIVOT\", \"APPENDIX - CURRENCY CONVERTER\" and \"MACRO\" worksheets\n                    ' do nothing\n                Case Else\n                    'Find last row of current worksheet\n                    lastRow = ws.Cells(ws.Rows.Count, \"E\").End(xlUp).row\n                    'Copy current worksheet cells and insert into CONSOLIDATED worksheet\n                    .Cells(.Rows.Count, 1).End(xlUp).Offset(1).Resize(lastRow - 5, 7).Value = ws.Range(\"A6:G\" &amp; lastRow).Value '&lt;--| just copy values and speed thing up!\n            End Select\n        Next ws\n        addHeaders .Name '&lt;--| call AddHeaders passing reference worksheet name (i.e. \"CONSOLIDATED\")\n    End With\n\n    currencyConvert '&lt;--| if it acts on \"CONSOLIDATED\" sheet, you may want to \"treat\" it as 'addHeaders': take it into 'End With' and pass it '.Name' as a parameter \n\nEnd Sub\n\nSub addHeaders(shtName As String)\n    Dim headers As Variant\n\n    headers = Array(\"Fiscal Year\", \"Month\", \"Fiscal Month\", \"Month Year\", \"Unit\", \"Project\", \"Local Expense\", \"Base Expense\") '&lt;--| Define desired headers\n    ThisWorkbook.Worksheets(shtName).Range(\"A1\").Resize(, UBound(headers) - LBound(headers) + 1).Value = headers '&lt;--| write headers from cell A1 rightwards\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 739, "user_id": 2259735, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/b5c3cfaaaae0be97a5d9a22e702202e4?s=128&d=identicon&r=PG", "display_name": "jonplaca", "link": "https://stackoverflow.com/users/2259735/jonplaca"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 141, "favorite_count": 0, "accepted_answer_id": 40898682, "answer_count": 1, "score": 1, "last_activity_date": 1480543695, "creation_date": 1480528037, "last_edit_date": 1480543695, "question_id": 40894940, "link": "https://stackoverflow.com/questions/40894940/vba-unexpected-row-insert", "title": "VBA - Unexpected row insert", "body": "<p><strong>OBJECTIVE</strong></p>\n\n<p>Copy a group of rows from multiple worksheets and insert into a <code>CONSOLIDATED</code> worksheet. </p>\n\n<p><strong>APPROACH</strong></p>\n\n<ol>\n<li>Go to <code>CONSOLIDATED</code> worksheet and remove pre-existing information</li>\n<li>Use an IF statement to find relevant worksheets where we intend to pull data from</li>\n<li>Copy relevant columns and rows on each worksheet (e.g A6:G(lastrow))</li>\n<li>Append copied data to <code>CONSOLIDATED</code> worksheet <strong>!!!ERROR</strong></li>\n</ol>\n\n<p><strong>(ugly) CODE</strong></p>\n\n<pre><code>Sub consolidateConvert()\nDim ws As Worksheet\n\n'Set CONSOLIDATED as the active worksheet\nApplication.ScreenUpdating = False\nSheets(\"CONSOLIDATED\").Activate\n\n\n'Clear previous content from active sheet\nActiveSheet.Range(\"A1:G10000\").ClearContents\n\n'Iterate through workbooks, except for CONSOLIDATED, TITLE, and PIVOT worksheets\nFor Each ws In Worksheets\n  If ws.Name &lt;&gt; \"CONSOLIDATED\" And ws.Name &lt;&gt; \"PIVOT\" And ws.Name &lt;&gt; \"TITLE\" _\n     And ws.Name &lt;&gt; \"APPENDIX - CURRENCY CONVERTER\" And ws.Name &lt;&gt; \"MACRO\" Then\n\n'Find last row of current worksheet\n    Dim lastRow As Long\n    lastRow = ws.Cells(ws.Rows.Count, \"E\").End(xlUp).Row\n\n'Copy current worksheet cells and insert into CONSOLIDATED worksheet\n    ws.Range(\"A6:G\" &amp; lastRow).Copy\n    ActiveSheet.Range(\"A2\").End(xlUp).Insert shift:=xlDown\n  End If\nNext ws\n\nCall currencyConvert\nCall addHeaders\n</code></pre>\n\n<p><code>currencyConvert</code> is a function that isn't relevant to this particular question. However, I've added <code>addHeaders</code> function below:</p>\n\n<pre><code>Sub addHeaders()\nDim ws As Worksheet\nDim headers() As Variant\n\n'Define worksheet and desired headers\nSet ws = ThisWorkbook.Sheets(\"CONSOLIDATED\")\nheaders() = Array(\"Fiscal Year\", \"Month\", \"Fiscal Month\", \"Month Year\", \"Unit\", \"Project\", \"Local Expense\", \"Base Expense\")\n\n'Insert row for header placement\nRows(1).Insert shift:=xlShiftDown\n\n'Insert headers\nWith ws\n  For i = LBound(headers()) To UBound(headers())\n    .Cells(1, 1 + i).Value = headers(i)\n  Next i\nEnd With\nEnd Sub\n</code></pre>\n\n<p><strong>OUTPUT</strong></p>\n\n<p>Below is a screenshot of the unexpected output. Rows 2-7 are unexpected and include some random text strings that aren't present anywhere else within the workbook. Strings may be some weird inheritance issue in VBA but not quite sure (hence the question(s) below). </p>\n\n<p><a href=\"https://i.stack.imgur.com/dMCDZ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/dMCDZ.png\" alt=\"error with weird text strings\"></a></p>\n\n<p><strong>QUESTIONS</strong></p>\n\n<ol>\n<li>As mentioned before, Rows 2-7 are added unintentionally and are accompanied with some weird strings. Does anyone have any insight on why ~6 rows are being added (when only 1 should be added - see <code>addHeaders()</code>)? Additionally, what is the origin of the unintended strings (\"CatalogNickname\", \"EnvironmentKey\", etc.)?</li>\n</ol>\n"}, {"tags": ["excel", "spreadsheet", "vba"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 4, "creation_date": 1480527508, "post_id": 40894762, "comment_id": 69003325, "body": "please post the data as text.  Many will not trust downloading files from unknown sources."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1480527647, "post_id": 40894762, "comment_id": 69003403, "body": "There is a way. How much flexibility do you have over the contents of Sheet1? The additional info in the &quot;Killed By&quot; column is problematic (e.g., ` - Lvl 1 (&#39;(@@)&#39;)`. If you can add a helper column, this is easy using COUNTIF function."}], "answers": [{"tags": [], "owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "is_accepted": false, "score": 0, "last_activity_date": 1480528013, "creation_date": 1480528013, "answer_id": 40894926, "question_id": 40894762, "link": "https://stackoverflow.com/questions/40894762/a-method-to-calculate-the-total-ammount-of-kills-a-specific-player-got/40894926#40894926", "title": "A method to calculate the total ammount of kills a specific player got", "body": "<p>The additional info in the \"Killed By\" column is problematic (e.g., <code>- Lvl 1 ('(@@)')</code>. </p>\n\n<p><strong>If you can add a helper column, this is easy using COUNTIF function.</strong></p>\n\n<p>In column H, Sheet1, add this formula and drag down:</p>\n\n<pre><code>=IFERROR(TRIM(LEFT(G5,FIND(\"-\",G5)-1)),\"\")\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/R8y5n.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/R8y5n.png\" alt=\"enter image description here\"></a></p>\n\n<p>Then, on your FFA Output sheet, use this formula, drag down:</p>\n\n<pre><code>=COUNTIF(Sheet1!H:H,'FFA Output'!E2)\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/mqsRe.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/mqsRe.png\" alt=\"enter image description here\"></a></p>\n\n<p><strong>If you can't use a helper column, then you probably need a VBA solution.</strong></p>\n\n<p>A VBA solution would just loop the column and essentially extract the Player Name from the Killed By column and keep a tally of each. This would basically translate the functions used in the formula solution (above) to VBA code.</p>\n"}, {"tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 1, "last_activity_date": 1480528687, "creation_date": 1480528687, "answer_id": 40895119, "question_id": 40894762, "link": "https://stackoverflow.com/questions/40894762/a-method-to-calculate-the-total-ammount-of-kills-a-specific-player-got/40895119#40895119", "title": "A method to calculate the total ammount of kills a specific player got", "body": "<p>to do it in one formula:</p>\n\n<pre><code>=SUMPRODUCT(--(ISNUMBER(SEARCH(E2 &amp; \" - \",Sheet1!$G$5:$G$26))))\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/oiydd.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/oiydd.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 13, "user_id": 7225089, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f5b4ab042cd31c5c0be4c576428a1392?s=128&d=identicon&r=PG&f=1", "display_name": "rere rer", "link": "https://stackoverflow.com/users/7225089/rere-rer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 43, "favorite_count": 0, "accepted_answer_id": 40895119, "answer_count": 2, "score": -1, "last_activity_date": 1480528687, "creation_date": 1480527422, "last_edit_date": 1531161705, "question_id": 40894762, "link": "https://stackoverflow.com/questions/40894762/a-method-to-calculate-the-total-ammount-of-kills-a-specific-player-got", "title": "A method to calculate the total ammount of kills a specific player got", "body": "<p>I have a spreadsheet with a table of information on it, showing who died during a game.</p>\n\n<p>I was wondering if there is a way to detect how many players each person killed and display that on the FFA output section of my spreadsheet?</p>\n\n<p><a href=\"https://docs.google.com/spreadsheets/d/e/2PACX-1vQonKwIfRRcOjo3gUd5uRyI-P08Bm15aYmpSIYdvyoON394naVxg9bF9pkmG7x1eQi6z1msG5qrERyg/pub?output=xlsx\" rel=\"nofollow noreferrer\">EXCEL File on Google Drive :)</a> </p>\n"}, {"tags": ["excel", "string", "vba", "loops", "connection"], "comments": [{"owner": {"reputation": 922, "user_id": 6124497, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7cc7e273f4fb6461113b19f47881f18d?s=128&d=identicon&r=PG&f=1", "display_name": "nvkrj", "link": "https://stackoverflow.com/users/6124497/nvkrj"}, "edited": false, "score": 0, "creation_date": 1480531283, "post_id": 40894709, "comment_id": 69005474, "body": "Can you post a link to your excel file, or it&#39;s screenshot? That would help in debugging your code.."}, {"owner": {"reputation": 25, "user_id": 6929411, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d302c3aada956e9d1aa3936de02e47f4?s=128&d=identicon&r=PG&f=1", "display_name": "EdC", "link": "https://stackoverflow.com/users/6929411/edc"}, "reply_to_user": {"reputation": 922, "user_id": 6124497, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7cc7e273f4fb6461113b19f47881f18d?s=128&d=identicon&r=PG&f=1", "display_name": "nvkrj", "link": "https://stackoverflow.com/users/6124497/nvkrj"}, "edited": false, "score": 0, "creation_date": 1480532695, "post_id": 40894709, "comment_id": 69006266, "body": "I don&#39;t know how. What would be the option in StackOverflow to upload a file?"}, {"owner": {"reputation": 922, "user_id": 6124497, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7cc7e273f4fb6461113b19f47881f18d?s=128&d=identicon&r=PG&f=1", "display_name": "nvkrj", "link": "https://stackoverflow.com/users/6124497/nvkrj"}, "edited": false, "score": 0, "creation_date": 1480532954, "post_id": 40894709, "comment_id": 69006399, "body": "Mmm.. you could upload your file to (DropBox|Google Drive|One Drive...) and post a link here?"}, {"owner": {"reputation": 25, "user_id": 6929411, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d302c3aada956e9d1aa3936de02e47f4?s=128&d=identicon&r=PG&f=1", "display_name": "EdC", "link": "https://stackoverflow.com/users/6929411/edc"}, "reply_to_user": {"reputation": 922, "user_id": 6124497, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7cc7e273f4fb6461113b19f47881f18d?s=128&d=identicon&r=PG&f=1", "display_name": "nvkrj", "link": "https://stackoverflow.com/users/6124497/nvkrj"}, "edited": false, "score": 0, "creation_date": 1480533737, "post_id": 40894709, "comment_id": 69006865, "body": "It should show up now, under the final block of code. Some parts of the first sheet are messy, due to trouble with subtotals, but the only column I&#39;m concerned with right now in the first sheet is column O."}, {"owner": {"reputation": 922, "user_id": 6124497, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7cc7e273f4fb6461113b19f47881f18d?s=128&d=identicon&r=PG&f=1", "display_name": "nvkrj", "link": "https://stackoverflow.com/users/6124497/nvkrj"}, "edited": false, "score": 0, "creation_date": 1480533810, "post_id": 40894709, "comment_id": 69006902, "body": "It&#39;s showing &quot;request access&quot;, that is, people don&#39;t have access to your file unless you give them permission to access it. I&#39;ve requested access to your file and you should receive an email for it."}, {"owner": {"reputation": 25, "user_id": 6929411, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d302c3aada956e9d1aa3936de02e47f4?s=128&d=identicon&r=PG&f=1", "display_name": "EdC", "link": "https://stackoverflow.com/users/6929411/edc"}, "reply_to_user": {"reputation": 922, "user_id": 6124497, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7cc7e273f4fb6461113b19f47881f18d?s=128&d=identicon&r=PG&f=1", "display_name": "nvkrj", "link": "https://stackoverflow.com/users/6124497/nvkrj"}, "edited": false, "score": 0, "creation_date": 1480533956, "post_id": 40894709, "comment_id": 69006963, "body": "It should now be set to &quot;view&quot; for you"}, {"owner": {"reputation": 922, "user_id": 6124497, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7cc7e273f4fb6461113b19f47881f18d?s=128&d=identicon&r=PG&f=1", "display_name": "nvkrj", "link": "https://stackoverflow.com/users/6124497/nvkrj"}, "edited": false, "score": 0, "creation_date": 1480534489, "post_id": 40894709, "comment_id": 69007179, "body": "Thanks.. I&#39;m looking into it."}, {"owner": {"reputation": 922, "user_id": 6124497, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7cc7e273f4fb6461113b19f47881f18d?s=128&d=identicon&r=PG&f=1", "display_name": "nvkrj", "link": "https://stackoverflow.com/users/6124497/nvkrj"}, "edited": false, "score": 0, "creation_date": 1480534757, "post_id": 40894709, "comment_id": 69007322, "body": "I have many questions regarding your code. First, why have you hard coded values such as <code>$A$1996:$G$1996</code> ?"}, {"owner": {"reputation": 922, "user_id": 6124497, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7cc7e273f4fb6461113b19f47881f18d?s=128&d=identicon&r=PG&f=1", "display_name": "nvkrj", "link": "https://stackoverflow.com/users/6124497/nvkrj"}, "edited": false, "score": 0, "creation_date": 1480535440, "post_id": 40894709, "comment_id": 69007670, "body": "One thing that I found amiss in your code was <code>QueryTables.Add(Connection:= url, Flight:=Range</code> should be <code>QueryTables.Add(Connection:=url, Destination:=Range</code>, because there is no parameter named &quot;Flight&quot; for the query table add method."}], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 6929411, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d302c3aada956e9d1aa3936de02e47f4?s=128&d=identicon&r=PG&f=1", "display_name": "EdC", "link": "https://stackoverflow.com/users/6929411/edc"}, "edited": false, "score": 0, "creation_date": 1480621296, "post_id": 40897586, "comment_id": 69050266, "body": "I see now. Thank you very much for looking over my code. I noticed later on, as well, that I should start the macro by selecting Sheet 1. The Flight variable didn&#39;t initialize when I started off with Sheet 2 active."}, {"owner": {"reputation": 922, "user_id": 6124497, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7cc7e273f4fb6461113b19f47881f18d?s=128&d=identicon&r=PG&f=1", "display_name": "nvkrj", "link": "https://stackoverflow.com/users/6124497/nvkrj"}, "reply_to_user": {"reputation": 25, "user_id": 6929411, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d302c3aada956e9d1aa3936de02e47f4?s=128&d=identicon&r=PG&f=1", "display_name": "EdC", "link": "https://stackoverflow.com/users/6929411/edc"}, "edited": false, "score": 0, "creation_date": 1480658922, "post_id": 40897586, "comment_id": 69062989, "body": "@EdC: From a performance point of view, activating/selecting sheets is a drag. Instead you should reference the sheet objects and get their ranges from their references. For example, <code>Sheets(&#39;Sheet1&#39;).Range(&quot;A1&quot;).Value</code> will give you the first cell&#39;s value. Also if you feel the answer was helpful enough and answered your problem, can you please accept it (:))?"}], "tags": [], "owner": {"reputation": 922, "user_id": 6124497, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7cc7e273f4fb6461113b19f47881f18d?s=128&d=identicon&r=PG&f=1", "display_name": "nvkrj", "link": "https://stackoverflow.com/users/6124497/nvkrj"}, "is_accepted": false, "score": 0, "last_activity_date": 1480537777, "creation_date": 1480537777, "answer_id": 40897586, "question_id": 40894709, "link": "https://stackoverflow.com/questions/40894709/excel-vba-macro-not-initializing-strings-for-cell-value-not-accepting-site-con/40897586#40897586", "title": "Excel VBA: Macro not Initializing Strings for Cell Value, not Accepting Site Connection", "body": "<p>The obvious mistake in your code is that you are not updating the <code>Flight</code>, <code>url</code> and <code>name</code> variables inside your loop.</p>\n\n<p>Correcting the above mistakes, and a few syntax errors (like using ActiveCell instead of ActiveSheet), the following code does what you want.</p>\n\n<pre><code>Sub PULLFROMGCM()\n'\n' PULLFROMGCM Macro\n' Pulls data from great circle mapper\n'\n' Keyboard Shortcut: Ctrl+Shift+T\n'\nDim Flight As String\nDim url As String\nDim ToInfinity As Long\nDim name As String\nDim Milesflown As String\nToInfinity = 1993\n\n\nDo While Not IsEmpty(Cells(ToInfinity, 15))\n\n' Update the variables in your loop as well\nFlight = Cells(ToInfinity, 15).Value\nurl = \"URL;http://www.gcmap.com/dist?P=\" &amp; Flight\nname = \"dist?P=\" &amp; Flight\n\n' Calculate how far sheet 2 has rows\nSheets(\"Sheet2\").Select\nHowFar = Application.WorksheetFunction.CountA(Range(\"A:A\")) + 3\n\n    With ActiveSheet.QueryTables.Add(Connection:= _\n        url, Destination:=Range(\"A\" &amp; (HowFar + 1) &amp; \":G\" &amp; (HowFar + 1)))\n        .name = name\n        .FieldNames = True\n        .RowNumbers = False\n        .FillAdjacentFormulas = False\n        .PreserveFormatting = True\n        .RefreshOnFileOpen = False\n        .BackgroundQuery = True\n        .RefreshStyle = xlInsertDeleteCells\n        .SavePassword = False\n        .SaveData = True\n        .AdjustColumnWidth = True\n        .RefreshPeriod = 0\n        .WebSelectionType = xlSpecifiedTables\n        .WebFormatting = xlWebFormattingNone\n        .WebTables = \"\"\"mdist\"\"\"\n        .WebPreFormattedTextToColumns = True\n        .WebConsecutiveDelimitersAsOne = True\n        .WebSingleBlockTextImport = False\n        .WebDisableDateRecognition = False\n        .WebDisableRedirections = False\n        .Refresh BackgroundQuery:=False\n    End With\n    Milesflown = Range(\"G\" &amp; (HowFar + 6)).Value\n    ActiveSheet.Range(\"A\" &amp; (HowFar + 1) &amp; \":G\" &amp; (HowFar + 5)).Select\n    Selection.QueryTable.Delete\n    Selection.ClearContents\n    Sheets(\"Sheet1\").Select\n\nIf InStr(Milesflown, \"mi\") &lt;&gt; 0 Then\n    Milesflown = Replace(Milesflown, \"mi\", \"\")\n    Cells(ToInfinity, 12).Value = Milesflown\nEnd If\n\nMsgBox (Milesflown)\n    ToInfinity = ToInfinity + 1\n\nLoop\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 6929411, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d302c3aada956e9d1aa3936de02e47f4?s=128&d=identicon&r=PG&f=1", "display_name": "EdC", "link": "https://stackoverflow.com/users/6929411/edc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 482, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1480537777, "creation_date": 1480527284, "last_edit_date": 1480533713, "question_id": 40894709, "link": "https://stackoverflow.com/questions/40894709/excel-vba-macro-not-initializing-strings-for-cell-value-not-accepting-site-con", "title": "Excel VBA: Macro not Initializing Strings for Cell Value, not Accepting Site Connection", "body": "<p>I am trying to write a loop macro to Excel VBA that takes a flight path from a cell in Sheet 1 (starting at row 1993), inserts the path into a website that calculates the flight data (Great Circle Mapper, shown here: <a href=\"http://www.gcmap.com/\" rel=\"nofollow noreferrer\">http://www.gcmap.com/</a>), pulls the data from a table on the website into Sheet 2 (starting at row 1996), deletes excess data, and removes \"mi\" from the miles flown (to leave a numerical value).</p>\n\n<p>My first problem seems to begin with the start of the macro. </p>\n\n<p>While I have defined the counter variable, the cell value variable, and the URL string variable (to concatenate with the cell value variable), debugging shows that only the counter variable gets properly initialized. The cell value variable (\"Flight\" which is supposed to start at row 1993, column O) does not get initialized, which then causes the URL and name variables not to run properly. Shown here:</p>\n\n<pre><code>ToInfinity = 1993\nFlight = Cells(ToInfinity, 15).Value\nurl = \"URL;http://www.gcmap.com/dist?P=\" &amp; Flight\nname = \"dist?P=\" &amp; Flight\n</code></pre>\n\n<p>As for my second problem, on the few times the macro has initialized each variable, the connection argument shown here: </p>\n\n<pre><code>(\"With ActiveSheet.QueryTables.Add(Connection:= _\n    url, Flight:=Range(\"$A$1996:$G$1996\"))\n</code></pre>\n\n<p>Gives me a runtime error, and this block of code is highlighted by the debugger.</p>\n\n<p>The entirety of my code is shown below:</p>\n\n<pre><code>Sub PULLFROMGCM()\n'\n' PULLFROMGCM Macro\n' Pulls data from great circle mapper\n'\n' Keyboard Shortcut: Ctrl+Shift+T\n'\nDim Flight As String \n'String variable for each flight path to be analyzed by the website, \"Great Circle Mapper\"\n'\nDim url As String\nDim ToInfinity As Long\n' Counter variable for loop, beginning at row 1993 on sheet 1'\nDim name As String\nDim Milesflown As String\nToInfinity = 1993\nFlight = Cells(ToInfinity, 15).Value\nurl = \"URL;http://www.gcmap.com/dist?P=\" &amp; Flight\nname = \"dist?P=\" &amp; Flight\nDo While Not IsEmpty(Cells(ToInfinity, 15))\n\n\n\nSheets(\"Sheet2\").Select\n    With ActiveSheet.QueryTables.Add(Connection:= _\n        url, Flight:=Range(\"$A$1996:$G$1996\"))\n        .CommandType = 0\n        .name = name\n        .FieldNames = True\n    .RowNumbers = False\n    .FillAdjacentFormulas = False\n    .PreserveFormatting = True\n    .RefreshOnFileOpen = False\n    .BackgroundQuery = True\n    .RefreshStyle = xlInsertDeleteCells\n    .SavePassword = False\n    .SaveData = True\n    .AdjustColumnWidth = True\n    .RefreshPeriod = 0\n    .WebSelectionType = xlSpecifiedTables\n    .WebFormatting = xlWebFormattingNone\n    .WebTables = \"\"\"mdist\"\"\"\n    .WebPreFormattedTextToColumns = True\n    .WebConsecutiveDelimitersAsOne = True\n    .WebSingleBlockTextImport = False\n    .WebDisableDateRecognition = False\n    .WebDisableRedirections = False\n    .Refresh BackgroundQuery:=False\nEnd With\nMilesflown = \"G:2001\"\nActiveCell.Range(\"A1996:G2000\").Select\nSelection.QueryTable.Delete\nSelection.ClearContents\nSheets(\"Sheet1\").Select\n\nIf InStr(Milesflown, \"mi\") &lt;&gt; 0 Then\nCells(ToInfinity, 11).Value = Left(Milesflown, \" \")\nEnd If\nToInfinity = ToInfinity + 1\nLoop\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://drive.google.com/file/d/0BxR5TrrROtV_ZGFEVlhLaXFkcEU/view\" rel=\"nofollow noreferrer\">Link to Excel file from Google Drive</a></p>\n"}, {"tags": ["vba", "excel", "copy-paste"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 2, "creation_date": 1480526228, "post_id": 40894229, "comment_id": 69002540, "body": "The string literal in <code>Range(&quot;something&quot;)</code> can be anything Excel can understand as referring to a range of cells: <code>&quot;A1&quot;</code>, <code>&quot;A1:B12&quot;</code>, <code>&quot;$A:$B&quot;</code>, <code>&quot;SomeNamedRange&quot;</code>, whatever. But no, not a formula."}, {"owner": {"reputation": 13, "user_id": 7222160, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5ohjk.jpg?s=128&g=1", "display_name": "Haley", "link": "https://stackoverflow.com/users/7222160/haley"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1480526727, "post_id": 40894229, "comment_id": 69002848, "body": "Phooey.  Thank you for clarifying!"}], "answers": [{"comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1480526613, "post_id": 40894388, "comment_id": 69002776, "body": "Isn&#39;t that formula going to be a circular reference?"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1480527117, "post_id": 40894388, "comment_id": 69003085, "body": "@Comintern - Maybe, to be honest I didn&#39;t really check the formula, but was just noting how you would do it in VBA. I think perhaps the <code>$C$3</code> is referring to another sheet? Maybe it should be <code>&quot;=&quot;&quot;DataInput_&quot;&quot;&amp;SUBSTITUTE(&#39;Data Input&#39;!$C$3, &quot;&quot; &quot;&quot;, &quot;&quot;&quot;&quot;)&quot;</code>?"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 1, "creation_date": 1480527321, "post_id": 40894388, "comment_id": 69003216, "body": "Hard to tell what&#39;s intended I guess, but it can&#39;t just be <code>$C$3</code> if it&#39;s going into <code>.Range(&quot;C3&quot;)</code>."}, {"owner": {"reputation": 13, "user_id": 7222160, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5ohjk.jpg?s=128&g=1", "display_name": "Haley", "link": "https://stackoverflow.com/users/7222160/haley"}, "edited": false, "score": 0, "creation_date": 1480527442, "post_id": 40894388, "comment_id": 69003286, "body": "Hello BruceWayne!  Thank you for helping!  When I enter your code, there are no errors (yay!) but now it just fills in with &quot;0&quot;."}, {"owner": {"reputation": 13, "user_id": 7222160, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5ohjk.jpg?s=128&g=1", "display_name": "Haley", "link": "https://stackoverflow.com/users/7222160/haley"}, "edited": false, "score": 0, "creation_date": 1480527847, "post_id": 40894388, "comment_id": 69003533, "body": "Hi again, thank you both for help!  I just updated the &#39;Data Input&#39;!$C$3 and it&#39;s moving in the right direction!  The formula is working, but it is not pulling from the dropdown on Add Extra Section.  Would I enter &quot;=&quot;&quot;DataInput_&quot;&quot;&amp;SUBSTITUTE(&#39;Add Extra Section&#39;!$C$3, &quot;&quot; &quot;&quot;, &quot;&quot;&quot;&quot;)&quot; ?  When I do, however, I get the error 1004 Method Range of object _Worksheet failed  *I am still using my original copySheet.range... code to get the error.  When I use BruceWayne&#39;s code, I still just get a &quot;0&quot;"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 13, "user_id": 7222160, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5ohjk.jpg?s=128&g=1", "display_name": "Haley", "link": "https://stackoverflow.com/users/7222160/haley"}, "edited": false, "score": 0, "creation_date": 1480528206, "post_id": 40894388, "comment_id": 69003761, "body": "@Haley - Try replacing the <code>.Formula</code> line with this one: <code>addSection.Formula = &quot;=&quot;&quot;DataInput_&quot;&quot;&amp;SUBSTITUTE(&#39;Add Extra Section&#39;!$C$3,&quot;&quot; &quot;&quot;,&quot;&quot;&quot;&quot;)&quot;</code>. I tested with a named range <code>DataInput_OilFurnace</code> and the cell correctly filled in with the named range.  This is with <code>Oil Furnace</code> in <code>&#39;Add Extra Section&#39;!C3</code>."}, {"owner": {"reputation": 13, "user_id": 7222160, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5ohjk.jpg?s=128&g=1", "display_name": "Haley", "link": "https://stackoverflow.com/users/7222160/haley"}, "edited": false, "score": 0, "creation_date": 1480528845, "post_id": 40894388, "comment_id": 69004154, "body": "Nope, unfortunately still getting a &quot;0&quot; when I replace it.  I am using only the code you have written: pasteSheet.Cells(pasteSheet.Rows.Count, 1).End(xlUp).Offset(1, 0).Value = addSection.Value"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 13, "user_id": 7222160, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5ohjk.jpg?s=128&g=1", "display_name": "Haley", "link": "https://stackoverflow.com/users/7222160/haley"}, "edited": false, "score": 0, "creation_date": 1480529173, "post_id": 40894388, "comment_id": 69004341, "body": "@Haley - What are you expecting the formula to return? <code>DataInput_OilFurnace</code>, correct? (Again, assuming that <code>Oil Furnace</code> is in cell C3 on your &quot;Add Extra Section&quot; sheet) ...I think there may be a circle here, since the formula is going into &quot;Add Extra Section&quot; Cell C3.  Change <code>Set addSection</code> to <code>Set addSection = copySheet.Range(&quot;C3&quot;)</code> and see if that helps."}, {"owner": {"reputation": 13, "user_id": 7222160, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5ohjk.jpg?s=128&g=1", "display_name": "Haley", "link": "https://stackoverflow.com/users/7222160/haley"}, "edited": false, "score": 0, "creation_date": 1480529698, "post_id": 40894388, "comment_id": 69004618, "body": "It worked!  You are a wonderful person!  Thank you!    If I could trouble you a bit more...I am not sure why it works.  Set addSection = copySheet.range(&quot;C3&quot;) --&gt;  To make sure I understand it, we are telling excel to look in the copy sheet at cell C3, but then immediately replacing that with the addSection.Formula?  I guess I am confused about where the &quot;C3&quot; goes?  But again, thank you!"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 13, "user_id": 7222160, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5ohjk.jpg?s=128&g=1", "display_name": "Haley", "link": "https://stackoverflow.com/users/7222160/haley"}, "edited": false, "score": 0, "creation_date": 1480531078, "post_id": 40894388, "comment_id": 69005358, "body": "@Haley - See my edit, I <i>hope</i> I made it a little more clear. Let me know if you&#39;re still confused! Also, a nice tip for learning VBA is that you can press <code>F8</code> to walk through a macro, line by line, and watch what&#39;s happening in Excel as it happens."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 13, "user_id": 7222160, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5ohjk.jpg?s=128&g=1", "display_name": "Haley", "link": "https://stackoverflow.com/users/7222160/haley"}, "edited": false, "score": 0, "creation_date": 1480533083, "post_id": 40894388, "comment_id": 69006466, "body": "@Haley - You&#39;re very welcome!! See my last edit though, I think it would probably be a better way to do this. <i>I</i> think it&#39;s even more clear, and you don&#39;t have to use the worksheet. Just grab the string, remove the spaces, and put it in the destination cell.  Note that you won&#39;t have &quot;DataInput_[range name]&quot; in the DataInput sheet, but AFAIK you don&#39;t really need that. You&#39;re only doing that so you can then copy/paste."}], "tags": [], "owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "is_accepted": true, "score": 1, "last_activity_date": 1480533039, "last_edit_date": 1480533039, "creation_date": 1480526292, "answer_id": 40894388, "question_id": 40894229, "link": "https://stackoverflow.com/questions/40894229/vba-rangecan-a-formula-go-here/40894388#40894388", "title": "VBA .range(&quot;Can a formula go here?&quot;)", "body": "<p>Are you getting an error? I would think your <code>pasteSheet.Cells(...</code> line may throw an error.  See how you added the sheet name before <code>.Cells()</code>? You should always do that with <code>Rows()</code> and <code>Columns()</code> too, so that line would be: <code>pasteSheet.Cells(pasteSheet.Rows.Count, 1).End(xlUp).Offset(1, 0).PasteSpecial</code>.  </p>\n\n<p>Also, you can't do <code>mySheet.Range([formula])</code>. That needs to be broken up.  You would instead want to do</p>\n\n<pre><code>Set addSection = Worksheets(\"Add Extra Section\").Range(\"C3\")\naddSection.Formula = \"=\"\"DataInput_\"\"&amp;SUBSTITUTE($C$3, \"\" \"\", \"\"\"\")\"\n</code></pre>\n\n<p>I <em>think</em> that should do it for you.  Also a quick note, if you are doing <code>PasteSpecial</code> just to get the value pasted, a slightly quicker way is to set the ranges equal to eachother, thus avoiding the use of the clipboard:</p>\n\n<p><code>Range([destination range]).Value = Range([range to copy]).Value</code></p>\n\n<p>So, try this:</p>\n\n<pre><code>Sub AddExtraSection()\n\nDim copySheet As Worksheet\nDim pasteSheet As Worksheet\nDim addSection As Range\n\nSet copySheet = Worksheets(\"Data Input\")\nSet pasteSheet = Worksheets(\"Add Extra Section\")\nSet addSection = pasteSheet.Range(\"C3\")\naddSection.Formula = \"=\"\"DataInput_\"\"&amp;SUBSTITUTE($C$3, \"\" \"\", \"\"\"\")\"\n\npasteSheet.Cells(pasteSheet.Rows.Count, 1).End(xlUp).Offset(1, 0).Value = addSection.Value\nEnd Sub\n</code></pre>\n\n<p>Edit: Per comments below, we can tighten the code up and make it a little more clear.</p>\n\n<pre><code>Sub AddExtraSection()\n\nDim pasteSheet As Worksheet\n\nSet pasteSheet = Worksheets(\"Add Extra Section\")\n'Next line will put \"DataInput_[RANGE NAME]\" in cell C3 of \"Data Input\" worksheet\nWorksheets(\"Data Input\").Range(\"C3\").Formula = \"=\"\"DataInput_\"\"&amp;SUBSTITUTE('Add Extra Section'!$C$3, \"\" \"\", \"\"\"\")\"\n\npasteSheet.Cells(pasteSheet.Rows.Count, 1).End(xlUp).Offset(1, 0).Value = _\n    Worksheets(\"Data Input\").Range(\"C3\").Value\nEnd Sub\n</code></pre>\n\n<p>We never really used the <code>copySheet</code>, so I removed that. Also, unless you plan on expanding this macro out, having <code>pasteSheet</code> and <code>addSection</code> adds confusion, so I tried to keep it simple.</p>\n\n<p>On your Data Input sheet, we want to get the named range listed in cell C3.</p>\n\n<p>The named range is listed in \"Add Extra Section\" sheet, cell C3. Take that string and remove spaces.  Then, add \"DataInput_\" to the beginning.  This is what the <code>...Formula =</code> line does. (Look at the formula backwards, Excel will first substitute the spaces out, and then concatenate that with \"DataInput_\").</p>\n\n<p>Then, finally, take the \"DataInput_[NAMED RANGE]\" string, and put that in your \"Add Extra Section\"'s last row +1.</p>\n\n<p>Edit2: Sorry, but thinking about this, an even better way would be to avoid using the worksheet, and do the work in VBA itself:</p>\n\n<pre><code>Sub updateNamedRange()\nDim destinationCell As Range, inputCell As Range\n\nSet destinationCell = Worksheets(\"Add Extra Section\").Cells(Worksheets(\"Add Extra Section\").Rows.Count, 1).End(xlUp).Offset(1, 0)\nSet inputCell = Worksheets(\"Add Extra Section\").Cells(3, 3)\n\ndestinationCell.Value = \"DataInput_\" &amp; WorksheetFunction.Substitute(inputCell, \" \", \"\")\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 7222160, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5ohjk.jpg?s=128&g=1", "display_name": "Haley", "link": "https://stackoverflow.com/users/7222160/haley"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 108, "favorite_count": 0, "accepted_answer_id": 40894388, "answer_count": 1, "score": 0, "last_activity_date": 1480533039, "creation_date": 1480525787, "last_edit_date": 1480529915, "question_id": 40894229, "link": "https://stackoverflow.com/questions/40894229/vba-rangecan-a-formula-go-here", "title": "VBA .range(&quot;Can a formula go here?&quot;)", "body": "<p>My end goal is to have the users select the range they would like to duplicate from a dropdown list and then upon clicking the \"add\" button, it will paste onto the sheet. </p>\n\n<p>My ranges are named in the fashion of WorkSheet_RangeName, so for example the section for \"Oil Furnace\" will have the named ranged of \"DataInput_OilFurnace\".  Thus all my ranges will start with \"DataInput_\" and the spaces will need to be removed.</p>\n\n<pre><code>Sub AddExtraSection()\n\nDim copySheet As Worksheet\nDim pasteSheet As Worksheet\nDim addSection As Range\n\nSet copySheet = Worksheets(\"Data Input\")\nSet pasteSheet = Worksheets(\"Add Extra Section\")\nSet addSection = Worksheets(\"Add Extra Section\").Range(\"C3\").Formula = _\n\"=\"\"DataInput_\"\"&amp;SUBSTITUTE($C$3, \"\" \"\", \"\"\"\")\"\n\ncopySheet.range(addSection).Copy\npasteSheet.Cells(Rows.Count, 1).End(xlUp).Offset(1, 0).PasteSpecial\n\nEnd Sub\n</code></pre>\n\n<p>If I can't use a formula, can I have the range name be a specific cell (as in, I have a formula beneath my dropdown that populates with the name of the Range)?</p>\n\n<pre><code>Set addSection = Worksheets(\"Add Extra Section\").ActiveCell.Offset(1, 0).Formula = \"=INDIRECT($C$4)\"\n</code></pre>\n\n<p>I am very new to VBA so if all this seems like cobbled together half-guesses...it's because it is!  Thank you for any and all help!</p>\n\n<p><strong><em>EDIT - SOLUTION</em></strong></p>\n\n<p>a.k.a A range cannot have a formula within it and I needed to fix my set addSection</p>\n\n<pre><code>Sub AddExtraSection()\n\nDim copySheet As Worksheet\nDim pasteSheet As Worksheet\nDim addSection As range\n\nSet copySheet = Worksheets(\"Data Input\")\nSet pasteSheet = Worksheets(\"Add Extra Section\")\nSet addSection = copySheet.range(\"C3\")\naddSection.Formula = \"=\"\"DataInput_\"\"&amp;SUBSTITUTE('Add Extra Section'!C3,\"\" \"\",\"\"\"\")\"\n\ncopySheet.range(addSection).Copy\npasteSheet.Cells(Rows.Count, 1).End(xlUp).Offset(1, 0).PasteSpecial\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["database", "forms", "vba", "ms-access", "database-design"], "answers": [{"comments": [{"owner": {"reputation": 143, "user_id": 2934877, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/870ce5fd32d145fd41a9a6be09c0652f?s=128&d=identicon&r=PG", "display_name": "Steven", "link": "https://stackoverflow.com/users/2934877/steven"}, "edited": false, "score": 0, "creation_date": 1480530413, "post_id": 40895491, "comment_id": 69004995, "body": "So if I need to edit a form, or better yet develop a brand new form that&#39;s more robust, do I accomplish that on the front end? At the same time they&#39;re using it for data entry? Another question -- we&#39;re having issues with certain users accessing the database. Most of the time they can access, others it talks about a locked state. We&#39;re also seeing an issue where some users can&#39;t open the data entry form and it&#39;s giving them an error with the file path to the backend. Works for other users though. Why could that be? Thank you!"}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "reply_to_user": {"reputation": 143, "user_id": 2934877, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/870ce5fd32d145fd41a9a6be09c0652f?s=128&d=identicon&r=PG", "display_name": "Steven", "link": "https://stackoverflow.com/users/2934877/steven"}, "edited": false, "score": 0, "creation_date": 1480532212, "post_id": 40895491, "comment_id": 69006010, "body": "See edit. For the other question, please post as new question with more details (setup, exact error messages etc.)"}, {"owner": {"reputation": 3238, "user_id": 3042438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b930cad6b909cf6546dfe29bdeb8af88?s=128&d=identicon&r=PG&f=1", "display_name": "SunKnight0", "link": "https://stackoverflow.com/users/3042438/sunknight0"}, "edited": false, "score": 0, "creation_date": 1480535352, "post_id": 40895491, "comment_id": 69007607, "body": "It is not necessary for every user to have their own front end. They can still share a single network based front end while you can do development on a separate copy of the front end. There are however some advantages, depending on your design and how advanced the front end is, to each user having their own front end."}], "tags": [], "owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "is_accepted": false, "score": 2, "last_activity_date": 1480532189, "last_edit_date": 1495541630, "creation_date": 1480530029, "answer_id": 40895491, "question_id": 40893768, "link": "https://stackoverflow.com/questions/40893768/clarification-on-splitting-an-access-database/40895491#40895491", "title": "Clarification on splitting an Access Database", "body": "<p>1) Yes, of course.</p>\n\n<p>2) Every user should have their own local copy of the frontend.</p>\n\n<p>You develop the new frontend version on your local computer, then when it's ready you put it on a network drive, and everyone gets their new local frontend from there. </p>\n\n<p>Here are some ideas how to automate this: <a href=\"https://stackoverflow.com/a/33782644/3820271\">https://stackoverflow.com/a/33782644/3820271</a></p>\n\n<p>You should never make design changes on a database that other users are currently using. (shudder)</p>\n\n<p><strong>Edit</strong> re. comment:</p>\n\n<p>All forms are in the frontend, so yes. You work on your development frontend, connected to a development backend (a copy of the production backend). </p>\n\n<p>The other users can meanwhile work with their local frontends on the production backend. </p>\n\n<p>When you are ready for release, make the necessary changes in the production backend (if there are changes in table structures). Make a copy of your dev frontend and link the tables from prod backend. This is the new prod frontend, which is distributed to all users.</p>\n"}], "owner": {"reputation": 143, "user_id": 2934877, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/870ce5fd32d145fd41a9a6be09c0652f?s=128&d=identicon&r=PG", "display_name": "Steven", "link": "https://stackoverflow.com/users/2934877/steven"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 35, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1480532189, "creation_date": 1480524373, "question_id": 40893768, "link": "https://stackoverflow.com/questions/40893768/clarification-on-splitting-an-access-database", "title": "Clarification on splitting an Access Database", "body": "<p>I've read multiple articles and watched videos but this is a big change to the structure so I want to confirm the idea that I have.</p>\n\n<p>Splitting will separate the tables and forms/queries into separate files. I get that much. But two questions.</p>\n\n<p>1) Should I backup my database beforehand?</p>\n\n<p>2) Can I edit the forms in design/layout view while they're being used by, say, a data entry team?</p>\n\n<p>The issue I'm running into now is that I created a simplistic front end for another team to use but I now need to buff it up while they use it. I heard this was the most efficient way to do so.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 3, "creation_date": 1480523255, "post_id": 40893290, "comment_id": 69000618, "body": "<code>oRng.Column</code> ...? and you probably want to change the reference to StartCol too?"}, {"owner": {"reputation": 394, "user_id": 3779976, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/1a8e7ad6a17ea44db739320c435a4026?s=128&d=identicon&r=PG", "display_name": "GregdeLima", "link": "https://stackoverflow.com/users/3779976/gregdelima"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1480523524, "post_id": 40893290, "comment_id": 69000801, "body": "Dang I tried that once and something about the <code>oRng</code> was returning only a <code>1 to n</code>. But yeah I think that worked."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 3, "creation_date": 1480523539, "post_id": 40893290, "comment_id": 69000810, "body": "Note that <code>Range</code> and <code>Cells</code> calls should be qualified with <code>oWkst</code>. Otherwise your code will break when you set <code>oWkst</code> to anything other than <code>ActiveSheet</code>."}, {"owner": {"reputation": 1162, "user_id": 6893386, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d02aee16378d73f403c3d0ab868a4f4e?s=128&d=identicon&r=PG&f=1", "display_name": "bobajob", "link": "https://stackoverflow.com/users/6893386/bobajob"}, "edited": false, "score": 0, "creation_date": 1480525614, "post_id": 40893290, "comment_id": 69002207, "body": "In this case, the Ranges are being built up from the Cells, so only the Cells should be qualified. The Ranges are quite safe either way."}], "answers": [{"tags": [], "owner": {"reputation": 526, "user_id": 7164307, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/b469705184f2479532aec6bc97f25b46?s=128&d=identicon&r=PG&f=1", "display_name": "D. O.", "link": "https://stackoverflow.com/users/7164307/d-o"}, "is_accepted": true, "score": 1, "last_activity_date": 1480525955, "creation_date": 1480525955, "answer_id": 40894289, "question_id": 40893290, "link": "https://stackoverflow.com/questions/40893290/vba-copy-formula-to-last-row-then-next-column/40894289#40894289", "title": "VBA Copy Formula to Last Row Then Next Column", "body": "<p>Try to modify</p>\n\n<pre><code>Range(Cells(2, StartCol), Cells(LastRow, [CURRENT COLUMN])).PasteSpecial (xlPasteFormulas\n</code></pre>\n\n<p>to</p>\n\n<pre><code>Range(Cells(2, oRng.Column), Cells(LastRow, oRng.Column)).PasteSpecial (xlPasteFormulas)\n</code></pre>\n"}], "owner": {"reputation": 394, "user_id": 3779976, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/1a8e7ad6a17ea44db739320c435a4026?s=128&d=identicon&r=PG", "display_name": "GregdeLima", "link": "https://stackoverflow.com/users/3779976/gregdelima"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 758, "favorite_count": 0, "accepted_answer_id": 40894289, "answer_count": 1, "score": 0, "last_activity_date": 1480525955, "creation_date": 1480523060, "question_id": 40893290, "link": "https://stackoverflow.com/questions/40893290/vba-copy-formula-to-last-row-then-next-column", "title": "VBA Copy Formula to Last Row Then Next Column", "body": "<p>I'm working with the code below, and where I'm having a hard time getting this around is the piece in brackets <code>[CURRENT COLUMN]</code></p>\n\n<p>I can't quite seem to get it to use the currently used column to paste the formula down.</p>\n\n<p>The goal is to go from columns <code>K</code> to <code>END</code> then if there is a formula in row 2 of that column, copy that formula down and proceed to the next column.</p>\n\n<pre><code>Option Explicit\nSub recalcdash()\nDim oWkbk As Workbook\nDim oWkst As Worksheet\nDim oRng As Range\nDim LastCol As Long\nDim LastRow As Long\nDim StartCol As Integer\nDim StartRow As Long\n\n\nStartCol = 11\nSet oWkst = ActiveSheet\n\n\nLastRow = oWkst.Range(\"A\" &amp; oWkst.Rows.Count).End(xlUp).Row\nLastCol = oWkst.Cells(2, oWkst.Columns.Count).End(xlToLeft).Column\n\nFor Each oRng In Range(Cells(2, 11), Cells(2, LastCol))\n        If oRng.HasFormula Then\n            oRng.Copy\n            Range(Cells(2, StartCol), Cells(LastRow, [CURRENT COLUMN])).PasteSpecial (xlPasteFormulas)\n        End If\n        Next oRng\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 1008, "user_id": 6894767, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0cac8b20e633ad4ea6819333bf38d120?s=128&d=identicon&r=PG", "display_name": "Werrf", "link": "https://stackoverflow.com/users/6894767/werrf"}, "edited": false, "score": 0, "creation_date": 1480524165, "post_id": 40893218, "comment_id": 69001231, "body": "One of the things I&#39;m doing with the loop is looking for blank cells in that column. Since there could be blanks at the end of the data, while there is still data in the other columns, using <code>.end(xlup)</code> on that column could give a misleading result."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 1008, "user_id": 6894767, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0cac8b20e633ad4ea6819333bf38d120?s=128&d=identicon&r=PG", "display_name": "Werrf", "link": "https://stackoverflow.com/users/6894767/werrf"}, "edited": false, "score": 0, "creation_date": 1480524465, "post_id": 40893218, "comment_id": 69001463, "body": "You could use Find to find the last used row in any column and then limit your code to that reduced range."}], "tags": [], "owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "is_accepted": true, "score": 1, "last_activity_date": 1480522865, "creation_date": 1480522865, "answer_id": 40893218, "question_id": 40893162, "link": "https://stackoverflow.com/questions/40893162/cant-loop-through-a-range-after-defining-it-with-range-columnsn/40893218#40893218", "title": "Can&#39;t loop through a range after defining it with range.columns(n)", "body": "<p>You have to specify the Cells property, for reasons I'm not entirely sure I'd have thought the last option was the best though as you want to restrict your range as much as possible.</p>\n\n<pre><code>Set rngUserIDs = rngAll.columns(1)\nFor each rngCell in rngUserIDs.Cells\n    Do Something\nnext rngCell\n</code></pre>\n"}], "owner": {"reputation": 1008, "user_id": 6894767, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0cac8b20e633ad4ea6819333bf38d120?s=128&d=identicon&r=PG", "display_name": "Werrf", "link": "https://stackoverflow.com/users/6894767/werrf"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 25, "favorite_count": 0, "accepted_answer_id": 40893218, "answer_count": 1, "score": 0, "last_activity_date": 1480522865, "creation_date": 1480522722, "last_edit_date": 1531164843, "question_id": 40893162, "link": "https://stackoverflow.com/questions/40893162/cant-loop-through-a-range-after-defining-it-with-range-columnsn", "title": "Can&#39;t loop through a range after defining it with range.columns(n)", "body": "<p>I've run into this a few times, always rather annoyingly. I can work around it, but I'm trying to figure out if there's a reason for it or an easier workaround.</p>\n\n<p>I've defined a range that contains all my data with </p>\n\n<pre><code>Set rngAll = range(\"A8\",cells(usedrange.rows.count,usedrange.columns.count))\n</code></pre>\n\n<p>Now I want to look through each cell in the first column of that range, and I'm trying to do this:</p>\n\n<pre><code>Set rngUserIDs = rngAll.columns(1)\nFor each rngCell in rngUserIDs\n    Do Something\nnext rngCell\n</code></pre>\n\n<p>When I run the code, instead of looking at each individual cell in <code>rngUserIDs</code>, <code>rngCell</code> sets itself to match the entirety of <code>rngUserIDs</code>. If <code>rngUserIDs</code> = A8:A1000, instead of starting at A8 and looping down, <code>rngCell</code> immediately = A8:A1000, does its something, then exits the loop.</p>\n\n<p>If I set rngUserIDs any other way, such as:</p>\n\n<pre><code>set rngUserIDs = Range(\"A8\",\"A\" &amp; range(\"A\" &amp; rows.count).end(xlup).row)\nFor Each rngCell in rngUserIDs\n    Do Something\nnext rngCell\n</code></pre>\n\n<p>it works perfectly, looking at each cell in turn.</p>\n\n<p>Is there a reason for this behaviour? Is there anything I can do about it? Yes, I can work around it, but for various structural reasons it would be convenient if I could just use the first column of <code>rngAll</code>.</p>\n"}, {"tags": ["sql", "ms-access", "textbox", "vba"], "comments": [{"owner": {"reputation": 615, "user_id": 5711024, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qXr4o.jpg?s=128&g=1", "display_name": "Pierre Chevallier", "link": "https://stackoverflow.com/users/5711024/pierre-chevallier"}, "edited": false, "score": 0, "creation_date": 1480522066, "post_id": 40892853, "comment_id": 68999779, "body": "Which Office Application are you using, Excel? Access? The following <a href=\"http://stackoverflow.com/questions/38196833/multiple-arithmetic-operations-in-vba-userforms/38198479#38198479\">link</a> might help you regarding populating texbox in VBA."}, {"owner": {"reputation": 14066, "user_id": 6426692, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/KDZsR.jpg?s=128&g=1", "display_name": "Ilyes", "link": "https://stackoverflow.com/users/6426692/ilyes"}, "edited": false, "score": 0, "creation_date": 1480522179, "post_id": 40892853, "comment_id": 68999861, "body": "What error you got? what is the issue? and what DB you use?"}, {"owner": {"reputation": 133, "user_id": 5759481, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/78f6ea3216c01450ca8391644544f09d?s=128&d=identicon&r=PG&f=1", "display_name": "Jessica Mather", "link": "https://stackoverflow.com/users/5759481/jessica-mather"}, "edited": false, "score": 0, "creation_date": 1480522199, "post_id": 40892853, "comment_id": 68999878, "body": "I updated the information in my answer, but I am using Access."}, {"owner": {"reputation": 843, "user_id": 7036750, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/d83c5665d281ea3cf93a1551a8db98fc?s=128&d=identicon&r=PG&f=1", "display_name": "Prasanna Kumar J", "link": "https://stackoverflow.com/users/7036750/prasanna-kumar-j"}, "edited": false, "score": 0, "creation_date": 1480522225, "post_id": 40892853, "comment_id": 68999892, "body": "Please mention error mesage."}, {"owner": {"reputation": 133, "user_id": 5759481, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/78f6ea3216c01450ca8391644544f09d?s=128&d=identicon&r=PG&f=1", "display_name": "Jessica Mather", "link": "https://stackoverflow.com/users/5759481/jessica-mather"}, "edited": false, "score": 0, "creation_date": 1480522277, "post_id": 40892853, "comment_id": 68999924, "body": "It says &quot;Expected Function or Variable&quot;"}, {"owner": {"reputation": 802, "user_id": 4940017, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/e5f61ab8654fafe38285853682641da8?s=128&d=identicon&r=PG&f=1", "display_name": "Rahul Hendawe", "link": "https://stackoverflow.com/users/4940017/rahul-hendawe"}, "edited": false, "score": 1, "creation_date": 1480522524, "post_id": 40892853, "comment_id": 69000101, "body": "I think <a href=\"http://stackoverflow.com/questions/30354597/passing-query-result-to-a-textbox-control-on-an-access-form\">Passing query result to a textbox control on an access form</a>  is may help in your case!"}, {"owner": {"reputation": 802, "user_id": 4940017, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/e5f61ab8654fafe38285853682641da8?s=128&d=identicon&r=PG&f=1", "display_name": "Rahul Hendawe", "link": "https://stackoverflow.com/users/4940017/rahul-hendawe"}, "edited": false, "score": 0, "creation_date": 1480523133, "post_id": 40892853, "comment_id": 69000536, "body": "what is the datatype of <code>Department_ID</code>  and <code>Me.cboDepartment</code>? this may mismatch and hence gives error.."}, {"owner": {"reputation": 133, "user_id": 5759481, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/78f6ea3216c01450ca8391644544f09d?s=128&d=identicon&r=PG&f=1", "display_name": "Jessica Mather", "link": "https://stackoverflow.com/users/5759481/jessica-mather"}, "edited": false, "score": 0, "creation_date": 1480523137, "post_id": 40892853, "comment_id": 69000540, "body": "I figured out the reason for this error is because some of the values don&#39;t contain a value for building. I tried to set the parameter so that the WHERE also included a &quot;AND Building IS NOT NULL&quot; to eliminate get rid of the null values. But the same error is still coming up."}], "answers": [{"tags": [], "owner": {"reputation": 305, "user_id": 6435422, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ebd2c80f456dc3596617b2d8505f70b?s=128&d=identicon&r=PG&f=1", "display_name": "Lybren", "link": "https://stackoverflow.com/users/6435422/lybren"}, "is_accepted": false, "score": 1, "last_activity_date": 1480527027, "creation_date": 1480527027, "answer_id": 40894618, "question_id": 40892853, "link": "https://stackoverflow.com/questions/40892853/how-do-i-populate-the-value-of-a-textbox-from-my-database/40894618#40894618", "title": "How do I populate the value of a textbox from my database?", "body": "<p>Most certainly the reason is behind you combobox.\nIf you are using a combobox with more than 1 column, hiding the column that has an <code>ID</code> because you use a query to populate said combobox, <strong>Then</strong> you are passing the underlying ID to the select query.  </p>\n\n<p>To actually pass what is written on the combobox to the select clause use it's text property.  </p>\n\n<pre><code>sSQL = \"SELECT Building FROM tblDepartment WHERE \" _\n&amp; \"Department_ID = '\" &amp; Me.cboDepartment.Text &amp; \"'\"\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": true, "score": 1, "last_activity_date": 1480580566, "creation_date": 1480580566, "answer_id": 40905724, "question_id": 40892853, "link": "https://stackoverflow.com/questions/40892853/how-do-i-populate-the-value-of-a-textbox-from-my-database/40905724#40905724", "title": "How do I populate the value of a textbox from my database?", "body": "<p>For such a simple task, <em>DLookup</em> is much simpler, and it returns a Null if no building is found. </p>\n\n<p>Also, leave out the single quotes as <em>Department_ID</em> most likely is numeric:</p>\n\n<pre><code>Me!txtLocation.Value = DLookup(\"Building\", \"tblDepartment\", \"Department_ID = \" &amp; Me!cboDepartment.Value &amp; \"\")\n</code></pre>\n"}], "owner": {"reputation": 133, "user_id": 5759481, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/78f6ea3216c01450ca8391644544f09d?s=128&d=identicon&r=PG&f=1", "display_name": "Jessica Mather", "link": "https://stackoverflow.com/users/5759481/jessica-mather"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 279, "favorite_count": 0, "accepted_answer_id": 40905724, "answer_count": 2, "score": 0, "last_activity_date": 1480580566, "creation_date": 1480521835, "last_edit_date": 1480522915, "question_id": 40892853, "link": "https://stackoverflow.com/questions/40892853/how-do-i-populate-the-value-of-a-textbox-from-my-database", "title": "How do I populate the value of a textbox from my database?", "body": "<p>This is my code that I have so far, I tried looking up the solution to my problem but could not find exactly what I was looking for. I am doing this in Access.</p>\n\n<pre><code>Dim rs As DAO.Recordset\nsSQL = \"SELECT Building FROM tblDepartment WHERE Department_ID = \n'\" &amp; Me.cboDepartment &amp; \"'\"\nSet rs = CurrentDb.OpenRecordset(sSQL)\nMe.txtLocation = rs.Fields(1).Value\n</code></pre>\n\n<p>I also tried this:</p>\n\n<pre><code>Dim db As DAO.Database\nSet db = CurrentDb()\nsSQL = \"SELECT Building FROM tblDepartment WHERE \" _\n&amp; \"Department_ID = '\" &amp; Me.cboDepartment.Value &amp; \"'\"\nMe.txtLocation.Value = db.Execute(sSQL)\n</code></pre>\n\n<p>Third attempt was this:</p>\n\n<pre><code>Sub spGetBuilding()\nDim rs As DAO.Recordset\nsSQL = \"SELECT Building FROM tblDepartment WHERE Department_ID = '\" &amp; Me.cboDepartment &amp; \"'\"\nSet rs = CurrentDb.OpenRecordset(sSQL)\n\nIf rs.RecordCount &gt; 0 Then\n    Me.txtLocation = rs.Fields(0).Value\nElse\n    Me.txtLocation = 0\nEnd If\n\nSet rs = Nothing\nEnd Sub\n</code></pre>\n\n<p>But it returned the error message \"Data type mismatch in criteria expression\"</p>\n\n<p>I figured out the reason for this error is because some of the values don't contain a value for building. I tried to set the parameter so that the WHERE also included a \"AND Building IS NOT NULL\" to eliminate get rid of the null values. But the same error is still coming up.</p>\n"}, {"tags": ["vba", "ms-access-2010"], "answers": [{"tags": [], "owner": {"reputation": 747, "user_id": 4962615, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/2dqmW.jpg?s=128&g=1", "display_name": "Sturgus", "link": "https://stackoverflow.com/users/4962615/sturgus"}, "is_accepted": true, "score": 0, "last_activity_date": 1480527215, "creation_date": 1480527215, "answer_id": 40894686, "question_id": 40892731, "link": "https://stackoverflow.com/questions/40892731/runcode-macro-action-from-hybrid-access-web-database-error/40894686#40894686", "title": "RunCode macro action from &#39;hybrid&#39; Access web database error", "body": "<p>After some extra digging, I came across <a href=\"http://www.utteraccess.com/forum/lofiversion/index.php/t1968469.html\" rel=\"nofollow noreferrer\">this post in another forum</a>.\nHere, the author simply explains that what I'm trying to do doesn't work (when you would think that it should).</p>\n\n<p>Because it's on another forum, I'll spell out the workaround that also worked for me (credit: jakedrew, UtterAccess post, Jun 9 2011).  Basically, you need to use a client-form in addition to a client-macro as intermediate steps to get from your web form to VBA.  I made this effective for my current application by doing the following:</p>\n\n<ol>\n<li><p>I re-saved my function as a sub instead:</p>\n\n<pre><code>Public Sub DoTest(ByVal intArg As Integer)\n    MsgBox \"Test sub runs smoothly with argument = \" &amp; intArg\nEnd Sub\n</code></pre></li>\n<li><p>Create a client-form (mine is named \"frmVBA_Bridge\") and create the following <code>OnOpen</code> event:</p>\n\n<pre><code>Private Sub Form_Open(Cancel As Integer)\n    ' run your code using this command.  Note that if you don't have an argument, you won't include the part of this line following the comma\n    Application.Run TempVars(\"SubName\").Value, TempVars(\"Arg1\").Value\n    ' reset the \"parameters\"\n    TempVars(\"SubName\").Value = \"\"\n    TempVars(\"Arg1\").Value = 0\n    DoCmd.Close acForm, Me.Name, acSaveYes\nEnd Sub\n</code></pre></li>\n<li><p>The client-side macro \"Macro1\" now instead does:</p>\n\n<pre><code>OpenForm\n  Form Name  frmVBA_Bridge\n  View Form\n  Where Condition\n  Data Mode\n  Window Mode  Hidden\n</code></pre></li>\n<li><p>The web form's button's on-click embedded macro gets changed to:</p>\n\n<pre><code>If  IsClient() = True Then\n  SetTempVar\n    Name SubName\n    Expression =\"DoTest\"\n  SetTempVar\n    Name Arg1\n    Expression = 100\n  RunMacro\n    Macro Name Macro1\nEnd If\n</code></pre></li>\n</ol>\n\n<p>Quite a bit of a workaround for such a simple thing, but it seems to do the job!</p>\n"}], "owner": {"reputation": 747, "user_id": 4962615, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/2dqmW.jpg?s=128&g=1", "display_name": "Sturgus", "link": "https://stackoverflow.com/users/4962615/sturgus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 130, "favorite_count": 0, "accepted_answer_id": 40894686, "answer_count": 1, "score": 0, "last_activity_date": 1522466807, "creation_date": 1480521458, "last_edit_date": 1495542648, "question_id": 40892731, "link": "https://stackoverflow.com/questions/40892731/runcode-macro-action-from-hybrid-access-web-database-error", "title": "RunCode macro action from &#39;hybrid&#39; Access web database error", "body": "<p>I have an Access web database</p>\n\n<ul>\n<li>In this database, I have a web form with a button on it</li>\n<li>In its on-click event macro, it calls <code>RunMacro Macro1</code> (client-macro) which fires successfully</li>\n<li>in Macro1, if I call <code>RunCode Function Name: DoTest()</code> it returns the error: \"The function you entered can't be used in this expression... Error Number 2426 (or 2950 if I have an \"=\" symbol in front of my function)</li>\n</ul>\n\n<p>This issue is easily reproduced by doing these steps:</p>\n\n<ol>\n<li>Create a blank <strong>web</strong> database in MS Access</li>\n<li>Add and save a table</li>\n<li>Create a default form from that table and put a button on it</li>\n<li><p>Create a new VBA module \"Module1\" and put the following function in it:</p>\n\n<pre><code>Public Function DoTest()\n    MsgBox \"Test function runs smoothly\"\nEnd Function\n</code></pre></li>\n<li>Create a client-macro \"Macro1\" with <code>RunCode: Function Name: DoTest()</code> (Note that IntelliSense recognizes the macro, and it runs fine from here)</li>\n<li>Create the form's button's on-click macro event <code>RunMacro: Macro Name: Macro1</code></li>\n<li>Click the form's button from form-view to receive the error:</li>\n</ol>\n\n<blockquote>\n  <p><strong>The function you entered can't be used in this expression.</strong> </p>\n  \n  <ul>\n  <li>You may have used a DoEvents, LBound, UBound, Spc, or Tab function in an\n  expression.  </li>\n  <li>You may have used an aggregate function, such as Count, in a design grid or in a calculated control or field.</li>\n  </ul>\n</blockquote>\n\n<p>Clicking \"Ok\" shows error number 2426 or 2950 depending on if you have an equals sign before your function name or not in the client-side macro's RunCode command.</p>\n\n<p>I've tried all of the tips from this <a href=\"https://stackoverflow.com/questions/17244980/ms-access-runcode-macro-cannot-find-my-procedure\">very similar question</a> without any luck. Access seems to find the function fine, as replacing the function name with gibberish gives a very different error.</p>\n\n<p>What the heck am I doing wrong?</p>\n\n<p>In my actual web database which uses Access Services published to SharePoint 2010, I use an <code>If IsClient() Then</code> macro statement on the form's button's on-click event to ensure that the VBA is only running in the client mode, but that is not relevant to the error I'm receiving.</p>\n"}, {"tags": ["vba", "excel", "combobox"], "comments": [{"owner": {"reputation": 1472, "user_id": 1726522, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/0DUTN.gif?s=128&g=1", "display_name": "CMArg", "link": "https://stackoverflow.com/users/1726522/cmarg"}, "edited": false, "score": 4, "creation_date": 1480521742, "post_id": 40892699, "comment_id": 68999551, "body": "<code>ComboBox3.Enabled = False</code>?"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 2, "creation_date": 1480521803, "post_id": 40892699, "comment_id": 68999590, "body": "Lock it using .locked, or diable it using .enabled"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 2, "creation_date": 1480521944, "post_id": 40892699, "comment_id": 68999689, "body": "FWIW <code>Case Is = 0</code> can be written more simply as <code>Case 0</code>."}, {"owner": {"reputation": 731, "user_id": 7170188, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/710cf6e1876c352c31e53fe5a4986993?s=128&d=identicon&r=PG&f=1", "display_name": "franciscofcosta", "link": "https://stackoverflow.com/users/7170188/franciscofcosta"}, "edited": false, "score": 0, "creation_date": 1480522001, "post_id": 40892699, "comment_id": 68999728, "body": "Thanks for your help. That works! I&#39;ve just then inserted a <code>ComboBox3.Enabled = True</code> after each <code>Case Is =</code> so that <code>ComboBox3</code> &quot;unfreezes&quot; if the user changes the selection. Thank you!"}], "answers": [{"tags": [], "owner": {"reputation": 526, "user_id": 7164307, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/b469705184f2479532aec6bc97f25b46?s=128&d=identicon&r=PG&f=1", "display_name": "D. O.", "link": "https://stackoverflow.com/users/7164307/d-o"}, "is_accepted": false, "score": 1, "last_activity_date": 1480522323, "creation_date": 1480522323, "answer_id": 40893025, "question_id": 40892699, "link": "https://stackoverflow.com/questions/40892699/how-to-freeze-combobox-excel-vba/40893025#40893025", "title": "How to freeze ComboBox Excel VBA", "body": "<p>use \"MatchRequired\" of the combobox, set it to TRUE, then the user can select or type only the items existing in the combobox. no need to freeze it.</p>\n"}, {"comments": [{"owner": {"reputation": 1472, "user_id": 1726522, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/0DUTN.gif?s=128&g=1", "display_name": "CMArg", "link": "https://stackoverflow.com/users/1726522/cmarg"}, "edited": false, "score": 0, "creation_date": 1480525993, "post_id": 40893059, "comment_id": 69002408, "body": "You can add <code>ComboBox3.Enabled = False</code> just after <code>ComboBox3.Clear</code>, to start with that cmb disabled. And instead of listing all other cases (2, 3, 4, etc), just write <code>Case Else</code>"}], "tags": [], "owner": {"reputation": 731, "user_id": 7170188, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/710cf6e1876c352c31e53fe5a4986993?s=128&d=identicon&r=PG&f=1", "display_name": "franciscofcosta", "link": "https://stackoverflow.com/users/7170188/franciscofcosta"}, "is_accepted": true, "score": 0, "last_activity_date": 1480522427, "creation_date": 1480522427, "answer_id": 40893059, "question_id": 40892699, "link": "https://stackoverflow.com/questions/40892699/how-to-freeze-combobox-excel-vba/40893059#40893059", "title": "How to freeze ComboBox Excel VBA", "body": "<p>As prescribed in the comments, <code>ComboBox3</code> is \"frozen\" with <code>ComboBox3.Enabled = False</code>. However, in order to avoid the case where a user \"freezes\" the <code>ComboBox</code> and then selects another option in <code>ComboBox2</code>, it is necessary to insert a <code>ComboBox3.Enabled = True</code> before each index case.</p>\n\n<p>The corrected code is below.</p>\n\n<pre><code>Private Sub ComboBox2_Change()\n\nDim index As Integer\n index = ComboBox2.ListIndex\n\n ComboBox3.Clear\n\nSelect Case index\n    Case Is = 0\n        ComboBox3.Enabled = True\n        With ComboBox3\n            .AddItem \"Administrative\"\n            .AddItem \"Civil\"\n            .AddItem \"Criminal\"\n        End With\n    Case Is = 1\n        ComboBox3.Enabled = True\n        With ComboBox3\n            .AddItem \"Arts and Culture\"\n            .AddItem \"Blog/Social Media\"\n            .AddItem \"Business and Economics\"\n            .AddItem \"General News\"\n            .AddItem \"Intelligence and Security\"\n            .AddItem \"Official News Agency/Official Press\"\n            .AddItem \"Energy\"\n            .AddItem \"Pharmaceutical and Medical News\"\n            .AddItem \"Politics\"\n            .AddItem \"Religion\"\n            .AddItem \"Society, Lifestyle and Opinion\"\n            .AddItem \"Sport\"\n        End With\n    Case Is = 2\n        ComboBox3.Enabled = False\n    Case Is = 3\n        ComboBox3.Enabled = False\n    Case Is = 4\n        ComboBox3.Enabled = False\n    Case Is = 5\n        ComboBox3.Enabled = False\n    Case Is = 6\n        ComboBox3.Enabled = False\n    Case Is = 7\n        ComboBox3.Enabled = False\n    Case Is = 8\n        ComboBox3.Enabled = False\n    Case Is = 9\n        ComboBox3.Enabled = False\n    Case Is = 10\n        ComboBox3.Enabled = False\nEnd Select\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 731, "user_id": 7170188, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/710cf6e1876c352c31e53fe5a4986993?s=128&d=identicon&r=PG&f=1", "display_name": "franciscofcosta", "link": "https://stackoverflow.com/users/7170188/franciscofcosta"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 594, "favorite_count": 0, "accepted_answer_id": 40893059, "answer_count": 2, "score": 0, "last_activity_date": 1480522427, "creation_date": 1480521358, "question_id": 40892699, "link": "https://stackoverflow.com/questions/40892699/how-to-freeze-combobox-excel-vba", "title": "How to freeze ComboBox Excel VBA", "body": "<p>I am writing a script on an Excel VBA <code>UserForm</code>. The form has three different fields that are <code>ComboBox</code> to be filled in by the user. I want to make the contents of <code>ComboBox 3</code> dependent on what is inputted in <code>Combobox2</code>.</p>\n\n<p><code>ComboBox2</code> is populated as follows:</p>\n\n<pre><code>  With ComboBox2\n        .AddItem \"Legal Information\"\n        .AddItem \"Media\"\n        .AddItem \"Official Disclosures\"\n        .AddItem \"Patents and Trademarks\"\n        .AddItem \"Private Corporate Information\"\n        .AddItem \"Private Individual Information\"\n        .AddItem \"Property Information\"\n        .AddItem \"Public Company Information\"\n        .AddItem \"Public Tenders\"\n        .AddItem \"Ships, Vessels and Aircraft Information\"\n        .AddItem \"Watchlists/Blacklists\"\n    End With\n</code></pre>\n\n<p>Depending on what the user inputs in <code>ComboBox2</code>, <code>ComboBox3</code> is populated by different options. I am doing such as follows:</p>\n\n<pre><code>Private Sub ComboBox2_Change()\n\nDim index As Integer\n index = ComboBox2.ListIndex\n\n ComboBox3.Clear\n\nSelect Case index\n     Case Is = 0\n         With ComboBox3\n             .AddItem \"Administrative\"\n             .AddItem \"Civil\"\n             .AddItem \"Criminal\"\n         End With\n     Case Is = 1\n         With ComboBox3\n             .AddItem \"Arts and Culture\"\n             .AddItem \"Blog/Social Media\"\n             .AddItem \"Business and Economics\"\n             .AddItem \"General News\"\n             .AddItem \"Intelligence and Security\"\n             .AddItem \"Official News Agency/Official Press\"\n             .AddItem \"Energy\"\n             .AddItem \"Pharmaceutical and Medical News\"\n             .AddItem \"Politics\"\n             .AddItem \"Religion\"\n             .AddItem \"Society, Lifestyle and Opinion\"\n             .AddItem \"Sport\"\n         End With\n\nEnd Sub\n</code></pre>\n\n<p>I'd like for<code>ComboBox3</code> to be frozen, i.e., impossible for the user to fill in, in case any other of the options of <code>ComboBox2</code> is selected - in the event <code>Case is = 2, 3, 4, 5, 6, 7, 8, 9, 10</code>. How should I do this. Thank you.</p>\n"}, {"tags": ["html", "excel", "vba", "automation", "dynamic-programming"], "comments": [{"owner": {"reputation": 1148, "user_id": 7231593, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kvB-QD-A2Xs/AAAAAAAAAAI/AAAAAAAAAE4/LRTmHQQqx44/photo.jpg?sz=128", "display_name": "John Muggins", "link": "https://stackoverflow.com/users/7231593/john-muggins"}, "edited": false, "score": 0, "creation_date": 1480598271, "post_id": 40892613, "comment_id": 69035441, "body": "Correction.  I AM able to set the select box(es) to an object and then return the current value.  But I am not able to click on the box(es) or change their value(s).  Do I need to somehow activate the division or span first, in order to get the inpout box to ;op up?  They all evaluate what you type in them and then the drop down list adjust to the letters that you type.  For example, if the user types &quot;a&quot; then all options with &quot;a&quot; will show on the list, etc, like google does.  But the value must be somewhere on the list in order to be validated."}, {"owner": {"reputation": 1148, "user_id": 7231593, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kvB-QD-A2Xs/AAAAAAAAAAI/AAAAAAAAAE4/LRTmHQQqx44/photo.jpg?sz=128", "display_name": "John Muggins", "link": "https://stackoverflow.com/users/7231593/john-muggins"}, "edited": false, "score": 0, "creation_date": 1481210238, "post_id": 40892613, "comment_id": 69293037, "body": "Again, another correction.  I&#39;m not familiar with how javascript is working to createe these select boxes on the html sheet, but I have found some different code for another javascript module pertaining to one of the dropdown boxes.  [code] &lt;script type=&quot;text/template&quot; id=&quot;portOfEntryDropdown&quot;&gt; &lt;select class=&quot;span2-input&quot; id=&quot;&lt;@=name@&gt;&quot; name=&quot;&lt;@=name@&gt;&quot;&gt; \t&lt;@ _.each(list, function(option) { @&gt; \t&lt;@ var optionText = option.cd; @&gt; \t\t&lt;option value=&quot;&lt;@=option.cd@&gt;&quot;&gt;&lt;@=optionText@&gt;&lt;/option&gt; \t&lt;@\t}); @&gt; &lt;/select&gt; &lt;/script&gt; [/code]  Does this make sense to anyone?"}], "owner": {"reputation": 1148, "user_id": 7231593, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kvB-QD-A2Xs/AAAAAAAAAAI/AAAAAAAAAE4/LRTmHQQqx44/photo.jpg?sz=128", "display_name": "John Muggins", "link": "https://stackoverflow.com/users/7231593/john-muggins"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 374, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1480670800, "creation_date": 1480521129, "last_edit_date": 1480522390, "question_id": 40892613, "link": "https://stackoverflow.com/questions/40892613/vba-excel-ie-automation-control-dynamic-dropdown-ie11", "title": "VBA Excel IE Automation - Control Dynamic Dropdown IE11", "body": "<p>I am attempting to access and change a dynamically created dropdown list on a webpage in IE11.  I don't seem to be setting the boxes to an object.  </p>\n\n<p>The HTML code does not show the actual dropdown, but only division where a script puts it:</p>\n\n<pre><code>&lt;span id=\"valid_portOfUnlading\" class=\"control-grop\"&gt;\n    &lt;span class=\"span2\"&gt;&lt;label for=\"portOfUnladingCode\"&gt;Port of Unlading&lt;/label&gt;&lt;/span&gt;\n    &lt;span class=\"span2 span2-input\"&gt;&lt;div id=\"anchor_portOfUnlading\" title=\"Port of Unlading\"&gt;&lt;/div&gt;&lt;/span&gt;\n&lt;/span&gt;\n</code></pre>\n\n<p>I have learned the form ID's and element ID's from getElementById.   The form ID for this dropdown element is \"editEntryForm\" or \"manualEntryForm\" (Not Sure which.)    The ID for the select box is \"edit_portOfUnladingCode\"  So far I have tried the following:</p>\n\n<pre><code>Set evt = myDoc.createEvent(\"HTMLEvents\")\nevt.initEvent \"change\", True, False\nSet lst = myDoc.getElementById(\"edit_portOfUnladingCode\")\nlst.selectedIndex = 6\nlst.dispatchEvent evt\n\nSet evt = myDoc.createEvent(\"HTMLEvents\")\nevt.initEvent \"change\", True, False\nSet lst = myDoc.getElementById(\"edit_portOfUnladingCode\")(0)\nlst.selectedIndex = 6\nlst.dispatchEvent evt\n\nSet evt = myDoc.createEvent(\"HTMLEvents\")\nevt.initEvent \"change\", True, False\nSet lst = myDoc.getElementById(\"edit_portOfUnladingCode\")(1)\nlst.selectedIndex = 6\nlst.dispatchEvent evt\n</code></pre>\n\n<p>And also ......</p>\n\n<pre><code>    myDoc.getElementById(\"edit_portOfUnladingCode\").Click\n    myDoc.getElementById(\"edit_portOfUnladingCode\")(0).Click\n    myDoc.getElementById(\"edit_portOfUnladingCode\")(1).Click\n\n\n'   works on version 8 but not 9 or later apparently\n    myDoc.getElementById(\"edit_portOfUnladingCode\").Focus\n    myDoc.getElementById(\"edit_portOfUnladingCode\").selectedIndex = 6\n    myDoc.getElementById(\"edit_portOfUnladingCode\").FireEvent (\"onchange\")\n\n    myDoc.getElementById(\"edit_portOfUnladingCode\")(0).Focus\n    myDoc.getElementById(\"edit_portOfUnladingCode\")(0).selectedIndex = 6\n    myDoc.getElementById(\"edit_portOfUnladingCode\")(0).FireEvent (\"onchange\")\n\n    myDoc.getElementById(\"edit_portOfUnladingCode\")(1).Focus\n    myDoc.getElementById(\"edit_portOfUnladingCode\")(1).selectedIndex = 6\n    myDoc.getElementById(\"edit_portOfUnladingCode\")(1).FireEvent (\"onchange\")\n</code></pre>\n\n<p>I'm at my wits end.  Hoping a VBA automation guru can help me out.  Thanks in advance.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 161252, "user_id": 40347, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ab9833194869e7f99d6e388f4aee76c1?s=128&d=identicon&r=PG", "display_name": "Dirk Vollmar", "link": "https://stackoverflow.com/users/40347/dirk-vollmar"}, "edited": false, "score": 0, "creation_date": 1480521341, "post_id": 40892517, "comment_id": 68999271, "body": "What Excel version are you on? And does &quot;Slicer_mode&quot; actually exist? Add a debug watch to <code>ActiveWorkbook.SlicerCaches</code> and check its contents."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 2, "creation_date": 1480521731, "post_id": 40892517, "comment_id": 68999541, "body": "Please embed the code into the question. You spent more effort taking that screenshot and uploading it here than it would have been to copy+paste the actual code into the post."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 7231682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/22c9da9963070d2373cb665850b6af39?s=128&d=identicon&r=PG&f=1", "display_name": "SaTu", "link": "https://stackoverflow.com/users/7231682/satu"}, "edited": false, "score": 0, "creation_date": 1480522919, "post_id": 40892695, "comment_id": 69000389, "body": "Thanks I tried adding above line to the code to activate the workbook, but the error is still there."}, {"owner": {"reputation": 76, "user_id": 7132406, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-e3JX76SHxZg/AAAAAAAAAAI/AAAAAAAAIaM/gZ6LTkMMZ3M/photo.jpg?sz=128", "display_name": "Tilan04", "link": "https://stackoverflow.com/users/7132406/tilan04"}, "reply_to_user": {"reputation": 1, "user_id": 7231682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/22c9da9963070d2373cb665850b6af39?s=128&d=identicon&r=PG&f=1", "display_name": "SaTu", "link": "https://stackoverflow.com/users/7231682/satu"}, "edited": false, "score": 0, "creation_date": 1480523379, "post_id": 40892695, "comment_id": 69000713, "body": "Ok. Then we need to make sure that the slicer name is wrote correctly. If it&#39;s ok check make this change <code>For Each slice In ActiveWorkbook.SlicerCaches</code> instead the line that you wrote before."}, {"owner": {"reputation": 1, "user_id": 7231682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/22c9da9963070d2373cb665850b6af39?s=128&d=identicon&r=PG&f=1", "display_name": "SaTu", "link": "https://stackoverflow.com/users/7231682/satu"}, "edited": false, "score": 0, "creation_date": 1480524385, "post_id": 40892695, "comment_id": 69001404, "body": "Ok. I tried that as well, but the issue still persists... I am unable to understand the cause of the error... :/"}], "tags": [], "owner": {"reputation": 76, "user_id": 7132406, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-e3JX76SHxZg/AAAAAAAAAAI/AAAAAAAAIaM/gZ6LTkMMZ3M/photo.jpg?sz=128", "display_name": "Tilan04", "link": "https://stackoverflow.com/users/7132406/tilan04"}, "is_accepted": false, "score": 0, "last_activity_date": 1480521349, "creation_date": 1480521349, "answer_id": 40892695, "question_id": 40892517, "link": "https://stackoverflow.com/questions/40892517/runtime-error-5-invalid-procedure-call-or-arguement/40892695#40892695", "title": "Runtime error 5: Invalid procedure call or arguement", "body": "<p>First make sure that the ActiveWorkbook is the correct one.</p>\n\n<pre><code>ThisWorkbook.Activate\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 7231682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/22c9da9963070d2373cb665850b6af39?s=128&d=identicon&r=PG&f=1", "display_name": "SaTu", "link": "https://stackoverflow.com/users/7231682/satu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 588, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1480521349, "creation_date": 1480520854, "last_edit_date": 1480521150, "question_id": 40892517, "link": "https://stackoverflow.com/questions/40892517/runtime-error-5-invalid-procedure-call-or-arguement", "title": "Runtime error 5: Invalid procedure call or arguement", "body": "<p>I am new to VBA coding and have just started working on them. I tried writing a code to count the number of selected items in a slicer, but while compiling I got the following error: </p>\n\n<blockquote>\n  <p>Runtime error 5 - invalid procedure call or argument.</p>\n</blockquote>\n\n<p>I have highlighted the line in which I am getting the error. Can someone please help me with the error?</p>\n\n<p><img src=\"https://i.stack.imgur.com/crNR9.png\" alt=\"enter image description here\"></p>\n\n<p>I have tried using similar declarations for myslicer variable in other workbooks for different purposes and it works in those files.</p>\n"}, {"tags": ["excel", "runtime-error", "pivot-table", "vba"], "comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 1, "creation_date": 1480520962, "post_id": 40892406, "comment_id": 68998998, "body": "Do you have &quot;DATA&quot; already defined as a Named range when running this code ? otherwise, it will throw an error at the first line. At what line are you getting this error ?"}, {"owner": {"reputation": 11, "user_id": 7211585, "user_type": "registered", "profile_image": "https://graph.facebook.com/10211196056248389/picture?type=large", "display_name": "Ryan Hulet", "link": "https://stackoverflow.com/users/7211585/ryan-hulet"}, "reply_to_user": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1480521500, "post_id": 40892406, "comment_id": 68999396, "body": "The first with statement names the range and is not showing an error.  I receive the error here:  <code>ActiveWorkbook.PivotCaches.Create(SourceType:=xlDatabase, SourceData:= _         Range(&quot;DATA&quot;), Version:=xlPivotTableVersion14).CreatePivotTable TableDestination:= _         &quot;&#39;External Analytics!&#39;R1C15&quot;, TableName:=&quot;PivotTable3&quot;, DefaultVersion:= _         xlPivotTableVersion14</code>"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1480522703, "post_id": 40892406, "comment_id": 69000245, "body": "<code>ActiveWorkbook.Names(&quot;DATA&quot;).Name = &quot;DATA&quot;</code>? Huh?"}, {"owner": {"reputation": 11, "user_id": 7211585, "user_type": "registered", "profile_image": "https://graph.facebook.com/10211196056248389/picture?type=large", "display_name": "Ryan Hulet", "link": "https://stackoverflow.com/users/7211585/ryan-hulet"}, "edited": false, "score": 0, "creation_date": 1480526877, "post_id": 40892406, "comment_id": 69002931, "body": "That is how the macro recorder recorded naming my &quot;data&quot; range. It completes without error."}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1480531539, "post_id": 40892406, "comment_id": 69005623, "body": "@Ryan Hulet try the code in mu answer below&#39; let me know if it works for you"}, {"owner": {"reputation": 11, "user_id": 7211585, "user_type": "registered", "profile_image": "https://graph.facebook.com/10211196056248389/picture?type=large", "display_name": "Ryan Hulet", "link": "https://stackoverflow.com/users/7211585/ryan-hulet"}, "reply_to_user": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1480544008, "post_id": 40892406, "comment_id": 69012161, "body": "@Shai Rado, please see the comment on your answer. Thanks"}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 7211585, "user_type": "registered", "profile_image": "https://graph.facebook.com/10211196056248389/picture?type=large", "display_name": "Ryan Hulet", "link": "https://stackoverflow.com/users/7211585/ryan-hulet"}, "edited": false, "score": 0, "creation_date": 1480537487, "post_id": 40895854, "comment_id": 69008714, "body": "PvtTbl.ChangePivotCache PTCache returns invalid procedure call or argument"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "reply_to_user": {"reputation": 11, "user_id": 7211585, "user_type": "registered", "profile_image": "https://graph.facebook.com/10211196056248389/picture?type=large", "display_name": "Ryan Hulet", "link": "https://stackoverflow.com/users/7211585/ryan-hulet"}, "edited": false, "score": 0, "creation_date": 1480565300, "post_id": 40895854, "comment_id": 69018305, "body": "@RyanHulet it happens after you ran this MACRO already once ? you were able to create the <code>PivotTable</code> on your first time running this code ?"}, {"owner": {"reputation": 11, "user_id": 7211585, "user_type": "registered", "profile_image": "https://graph.facebook.com/10211196056248389/picture?type=large", "display_name": "Ryan Hulet", "link": "https://stackoverflow.com/users/7211585/ryan-hulet"}, "edited": false, "score": 0, "creation_date": 1480603267, "post_id": 40895854, "comment_id": 69038980, "body": "No this was the first time running the code.  was unable to run the code without errors at all."}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "reply_to_user": {"reputation": 11, "user_id": 7211585, "user_type": "registered", "profile_image": "https://graph.facebook.com/10211196056248389/picture?type=large", "display_name": "Ryan Hulet", "link": "https://stackoverflow.com/users/7211585/ryan-hulet"}, "edited": false, "score": 0, "creation_date": 1480603602, "post_id": 40895854, "comment_id": 69039248, "body": "that&#39;s strange, since you are getting to the <code>Else</code> section, which means the <code>PivotTable</code> is already created"}, {"owner": {"reputation": 11, "user_id": 7211585, "user_type": "registered", "profile_image": "https://graph.facebook.com/10211196056248389/picture?type=large", "display_name": "Ryan Hulet", "link": "https://stackoverflow.com/users/7211585/ryan-hulet"}, "edited": false, "score": 0, "creation_date": 1480631910, "post_id": 40895854, "comment_id": 69055580, "body": "it is not processing your dim codes.  does not create a pivot table, it just skips over then returns an error on the else since the pivot table has not been created"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "reply_to_user": {"reputation": 11, "user_id": 7211585, "user_type": "registered", "profile_image": "https://graph.facebook.com/10211196056248389/picture?type=large", "display_name": "Ryan Hulet", "link": "https://stackoverflow.com/users/7211585/ryan-hulet"}, "edited": false, "score": 0, "creation_date": 1480691371, "post_id": 40895854, "comment_id": 69081775, "body": "Can u uploaded your file to Dropbox or something and send me the link?"}], "tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": false, "score": 0, "last_activity_date": 1480531334, "creation_date": 1480531334, "answer_id": 40895854, "question_id": 40892406, "link": "https://stackoverflow.com/questions/40892406/run-time-error-1004-vba-to-create-pivot-table/40895854#40895854", "title": "Run time error &#39;1004&#39; VBA to create pivot table", "body": "<p>Assuming form your post, the the Named Range \"DATA\" is defined correctly, the code below will create the <code>PivotTable</code> according to the data in \"DATA\" named Range, and the settings you wanted in your post.</p>\n\n<pre><code>Option Explicit\n\nSub DynamicCreatePivot()\n\nDim wsSheet             As Worksheet\nDim PvtTbl              As PivotTable\nDim PTCache             As PivotCache\n\n' set Pivot destination sheet\nSet wsSheet = ThisWorkbook.Sheets(\"External Analytics\")\n\n' set Pivot Cache to the data in \"DATA\" named range\nSet PTCache = ActiveWorkbook.PivotCaches.Add(xlDatabase, \"DATA\")\n\n' add this line in case the Pivot table doesn't exit &gt;&gt; first time running this Macro\nOn Error Resume Next\nSet PvtTbl = wsSheet.PivotTables(\"PivotTable3\") ' check if \"PivotTable3\" Pivot Table already created (in past runs of this Macro)\n\nOn Error GoTo 0\nIf PvtTbl Is Nothing Then ' if Pivot Table is not created\n\n    ' create a new Pivot Table in \"External Analytics\" sheet, start from Cell O1 (R1C15)\n    Set PvtTbl = wsSheet.PivotTables.Add(PivotCache:=PTCache, TableDestination:=wsSheet.Range(\"O1\"), TableName:=\"PivotTable3\")\n\n    'Create the headings and row and column orientation\n    With PvtTbl.PivotFields(\"Resolver\")\n        .Orientation = xlRowField\n        .Position = 1\n    End With\nElse ' Pivot Table already created &gt;&gt; in precious code runs\n    ' just refresh the Pivot cache with the updated Range (named range \"DATA\")\n    PvtTbl.ChangePivotCache PTCache\n    PvtTbl.RefreshTable\nEnd If\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 7211585, "user_type": "registered", "profile_image": "https://graph.facebook.com/10211196056248389/picture?type=large", "display_name": "Ryan Hulet", "link": "https://stackoverflow.com/users/7211585/ryan-hulet"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1474, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1480531334, "creation_date": 1480520467, "last_edit_date": 1531164843, "question_id": 40892406, "link": "https://stackoverflow.com/questions/40892406/run-time-error-1004-vba-to-create-pivot-table", "title": "Run time error &#39;1004&#39; VBA to create pivot table", "body": "<p>I am working on a macro to create a Pivot Table for a dynamic named range \"DATA\".  I get a \"Run-time error '1004' Method 'Range' of object'_Global' failed.  From what I see on other posts it may be because I am not referencing a specific sheet?   How would I correct for this?</p>\n\n<pre><code>With ActiveWorkbook.Names(\"DATA\")\n    .Name = \"DATA\"\n    .RefersToR1C1 = _\n    \"=OFFSET('Closed Cases'!R1C2,0,0,COUNTA('Closed Cases'!C6),25)\"\n    .Comment = \"\"\nEnd With\nActiveWorkbook.PivotCaches.Create(SourceType:=xlDatabase, SourceData:= _\n    Range(\"DATA\"), Version:=xlPivotTableVersion14).CreatePivotTable TableDestination:= _\n    \"'External Analytics!'R1C15\", TableName:=\"PivotTable3\", DefaultVersion:= _\n    xlPivotTableVersion14\nSheets(\"External Analytics\").Select\nCells(1, 1).Select\nWith ActiveSheet.PivotTables(\"PivotTable3\").PivotFields(\"Resolver\")\n    .Orientation = xlRowField\n    .Position = 1\nEnd With\n</code></pre>\n"}, {"tags": ["vba", "excel", "userform"], "comments": [{"owner": {"reputation": 1856, "user_id": 4949483, "user_type": "registered", "accept_rate": 86, "profile_image": "https://graph.facebook.com/10207184362590012/picture?type=large", "display_name": "Rdster", "link": "https://stackoverflow.com/users/4949483/rdster"}, "edited": false, "score": 1, "creation_date": 1480520250, "post_id": 40892020, "comment_id": 68998505, "body": "You set findvalue using the Set statement, and then tried to just assign it another value."}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "reply_to_user": {"reputation": 1856, "user_id": 4949483, "user_type": "registered", "accept_rate": 86, "profile_image": "https://graph.facebook.com/10207184362590012/picture?type=large", "display_name": "Rdster", "link": "https://stackoverflow.com/users/4949483/rdster"}, "edited": false, "score": 1, "creation_date": 1480521101, "post_id": 40892020, "comment_id": 68999088, "body": "@Rdster, but that shouldn&#39;t raise any error since it&#39;s just confirming current &quot;findvalue&quot; value"}, {"owner": {"reputation": 140, "user_id": 5753961, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-fkAt-xcK_E8/AAAAAAAAAAI/AAAAAAAAEqA/3HXrHaSP0F8/photo.jpg?sz=128", "display_name": "Todd Brannon", "link": "https://stackoverflow.com/users/5753961/todd-brannon"}, "reply_to_user": {"reputation": 1856, "user_id": 4949483, "user_type": "registered", "accept_rate": 86, "profile_image": "https://graph.facebook.com/10207184362590012/picture?type=large", "display_name": "Rdster", "link": "https://stackoverflow.com/users/4949483/rdster"}, "edited": false, "score": 0, "creation_date": 1480521864, "post_id": 40892020, "comment_id": 68999635, "body": "@Rdster The text box and combo box elements are populated once a record is double clicked (a separate subroutine) in a list box (pulled from the data table on DataSH) on the same UF. &#39;findvalue&#39; is set to the Record ID that is populated in the tbRecID text box element upon that event. The rest of the code is supposed to return the value from the UF elements (namely those changed) to the appropriated field in the DataSH table (and by extension the list box) using the &#39;findvalue&#39; object as a reference point. At least I think I explained that correctly."}, {"owner": {"reputation": 1856, "user_id": 4949483, "user_type": "registered", "accept_rate": 86, "profile_image": "https://graph.facebook.com/10207184362590012/picture?type=large", "display_name": "Rdster", "link": "https://stackoverflow.com/users/4949483/rdster"}, "edited": false, "score": 0, "creation_date": 1480522029, "post_id": 40892020, "comment_id": 68999754, "body": "Then why bother with the Find?  If you are just going to assign the value of the textbox...The Find does nothing.  But one of the answers posted is most likely what you need."}], "answers": [{"tags": [], "owner": {"reputation": 1451, "user_id": 2882327, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/OiCh4.png?s=128&g=1", "display_name": "Limak", "link": "https://stackoverflow.com/users/2882327/limak"}, "is_accepted": false, "score": 0, "last_activity_date": 1480521329, "creation_date": 1480521329, "answer_id": 40892685, "question_id": 40892020, "link": "https://stackoverflow.com/questions/40892020/userform-command-button-code-error-91-object-variable-or-with-block-variable/40892685#40892685", "title": "UserForm command button code - Error 91: Object variable or With block variable not set", "body": "<p>Error 91 pops up (in this situation), because you are trying to assign value to some range that have not been set, so your <code>Me.tbRecID.Value</code> doesn't exist in <code>DataSH.Range(\"B:B\")</code>. To avoid this problem, you can add some error exception, for example:</p>\n\n<pre><code>    Set findvalue = DataSH.Range(\"B:B\"). _\n    Find(What:=Me.tbRecID.Value, LookIn:=xlValues, LookAt:=xlWhole)\n    'update the values\nOn Error GoTo ErrHand:\n    findvalue = tbRecID.Value\nOn Error GoTo 0\n    findvalue.Offset(0, 1) = tbRecDate.Value\n    findvalue.Offset(0, 2) = cmbRecLoc.Value\n    findvalue.Offset(0, 3) = cmbRecCust.Value\n    findvalue.Offset(0, 4) = tbRecAmt.Value\n    findvalue.Offset(0, 5) = cmbRecComm.Value\n    findvalue.Offset(0, 6) = cmbRecPrin.Value\n    findvalue.Offset(0, 7) = tbRecTerr.Value\n    findvalue.Offset(0, 8) = tbRecRep.Value\nErrHand:\n[rest of your code]\n</code></pre>\n\n<p>This will force program to bypass lines which uses <code>findvalue</code> if there is no range assigned to this variable. </p>\n"}, {"comments": [{"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1480524006, "post_id": 40892748, "comment_id": 69001127, "body": "If my answer solved your question then you may want to mark it as accepet. Thank you!"}], "tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": false, "score": 0, "last_activity_date": 1480521496, "creation_date": 1480521496, "answer_id": 40892748, "question_id": 40892020, "link": "https://stackoverflow.com/questions/40892020/userform-command-button-code-error-91-object-variable-or-with-block-variable/40892748#40892748", "title": "UserForm command button code - Error 91: Object variable or With block variable not set", "body": "<p>Your code is simply failing at finding \"Me.tbRecID.Value\" in \"DataSH.Range(\"B:B\")\"</p>\n\n<p>So wrap your code in a \"If Then End If\" to be executed  if findvalue has been actually set to a valid Range</p>\n\n<pre><code>Set findvalue = DataSH.Range(\"B:B\"). _\nFind(What:=Me.tbRecID.Value, LookIn:=xlValues, LookAt:=xlWhole)\nIf Not findvalue Is Nothing Then\n    findvalue.Offset(0, 1) = tbRecDate.Value\n    findvalue.Offset(0, 2) = cmbRecLoc.Value\n    findvalue.Offset(0, 3) = cmbRecCust.Value\n    findvalue.Offset(0, 4) = tbRecAmt.Value\n    findvalue.Offset(0, 5) = cmbRecComm.Value\n    findvalue.Offset(0, 6) = cmbRecPrin.Value\n    findvalue.Offset(0, 7) = tbRecTerr.Value\n    findvalue.Offset(0, 8) = tbRecRep.Value\nEnd If\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1480521836, "post_id": 40892783, "comment_id": 68999613, "body": "That would raise an error right from &quot;Set DataSH = Sheet1&quot; statement"}, {"owner": {"reputation": 1856, "user_id": 4949483, "user_type": "registered", "accept_rate": 86, "profile_image": "https://graph.facebook.com/10207184362590012/picture?type=large", "display_name": "Rdster", "link": "https://stackoverflow.com/users/4949483/rdster"}, "edited": false, "score": 0, "creation_date": 1480522104, "post_id": 40892783, "comment_id": 68999800, "body": "No, it works as he has it.  As long as the Data sheet is Sheet1. One is the Name of the sheet in the properties window...the other is the (Name)."}, {"owner": {"reputation": 140, "user_id": 5753961, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-fkAt-xcK_E8/AAAAAAAAAAI/AAAAAAAAEqA/3HXrHaSP0F8/photo.jpg?sz=128", "display_name": "Todd Brannon", "link": "https://stackoverflow.com/users/5753961/todd-brannon"}, "reply_to_user": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1480523250, "post_id": 40892783, "comment_id": 69000613, "body": "@user3598756 That&#39;s the ticket! I was setting it to the Excel default Sheet1 name. I have been doing that without any previous problems just in case the sheet name got changed. However, when I set it to the actual sheet name like in your solution, works like a charm. Problem solved. Many thanks1!"}, {"owner": {"reputation": 140, "user_id": 5753961, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-fkAt-xcK_E8/AAAAAAAAAAI/AAAAAAAAEqA/3HXrHaSP0F8/photo.jpg?sz=128", "display_name": "Todd Brannon", "link": "https://stackoverflow.com/users/5753961/todd-brannon"}, "reply_to_user": {"reputation": 1856, "user_id": 4949483, "user_type": "registered", "accept_rate": 86, "profile_image": "https://graph.facebook.com/10207184362590012/picture?type=large", "display_name": "Rdster", "link": "https://stackoverflow.com/users/4949483/rdster"}, "edited": false, "score": 0, "creation_date": 1480523310, "post_id": 40892783, "comment_id": 69000659, "body": "@Rdster I was thinking the same thing, but after changing it, the subroutine now runs as expected. Scratching my head on this one."}], "tags": [], "owner": {"reputation": 526, "user_id": 7164307, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/b469705184f2479532aec6bc97f25b46?s=128&d=identicon&r=PG&f=1", "display_name": "D. O.", "link": "https://stackoverflow.com/users/7164307/d-o"}, "is_accepted": true, "score": 1, "last_activity_date": 1480521607, "creation_date": 1480521607, "answer_id": 40892783, "question_id": 40892020, "link": "https://stackoverflow.com/questions/40892020/userform-command-button-code-error-91-object-variable-or-with-block-variable/40892783#40892783", "title": "UserForm command button code - Error 91: Object variable or With block variable not set", "body": "<p>I think DataSH is not setted. Is \"Sheet1\" a name of a sheet or is it a worksheet variable? if it is a name then you must set DataSH like this :</p>\n\n<pre><code>Set DataSH = thisworkbook.worksheets(\"Sheet1\") \n</code></pre>\n\n<p>and not <code>Set DataSH = Sheet1</code></p>\n"}], "owner": {"reputation": 140, "user_id": 5753961, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-fkAt-xcK_E8/AAAAAAAAAAI/AAAAAAAAEqA/3HXrHaSP0F8/photo.jpg?sz=128", "display_name": "Todd Brannon", "link": "https://stackoverflow.com/users/5753961/todd-brannon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 224, "favorite_count": 0, "accepted_answer_id": 40892783, "answer_count": 3, "score": 0, "last_activity_date": 1480521607, "creation_date": 1480519340, "last_edit_date": 1531164843, "question_id": 40892020, "link": "https://stackoverflow.com/questions/40892020/userform-command-button-code-error-91-object-variable-or-with-block-variable", "title": "UserForm command button code - Error 91: Object variable or With block variable not set", "body": "<p>I have code for a command button click event that keeps throwing error 91. When I step through the code it throws the error right after the 'Set findvalue' code executes. See code snippet below. I can't figure it out upon inspection of the code itself.</p>\n\n<p>'findvalue' is dimensioned as a range object. 'DataSH' is the worksheet where the master data table exists beginning with the column for Record ID (column B). The user form elements are set to their respective columns in the data table on DataSH. </p>\n\n<pre><code>    Private Sub cmdEdit_Click()\n    'declare the variables\n    Dim findvalue As Range\n    Dim cNum As Integer\n    Dim DataSH As Worksheet\n    'error handling\n    On Error GoTo errHandler:\n    'hold in memory and stop screen flicker\n    Application.ScreenUpdating = False\n    Set DataSH = Sheet1\n</code></pre>\n\n<p>The click event sub routine that this snippet is taken from is setup to update the appropriate column data on the row for the selected Record ID (row number identifier) in DataSH based on the value in those UF elements (i.e. changed or deleted values). The point is to update the master data table on DataSH with any changes made in the UF elements (text boxes and combo boxes).</p>\n\n<pre><code>    Set findvalue = DataSH.Range(\"B:B\"). _\n    Find(What:=Me.tbRecID.Value, LookIn:=xlValues, LookAt:=xlWhole)\n    'update the values\n    findvalue = tbRecID.Value\n    findvalue.Offset(0, 1) = tbRecDate.Value\n    findvalue.Offset(0, 2) = cmbRecLoc.Value\n    findvalue.Offset(0, 3) = cmbRecCust.Value\n    findvalue.Offset(0, 4) = tbRecAmt.Value\n    findvalue.Offset(0, 5) = cmbRecComm.Value\n    findvalue.Offset(0, 6) = cmbRecPrin.Value\n    findvalue.Offset(0, 7) = tbRecTerr.Value\n    findvalue.Offset(0, 8) = tbRecRep.Value\n</code></pre>\n"}, {"tags": ["excel", "vba", "validation", "reference", "formula"], "comments": [{"owner": {"reputation": 24120, "user_id": 5159168, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/r0oiE.jpg?s=128&g=1", "display_name": "Andreas", "link": "https://stackoverflow.com/users/5159168/andreas"}, "edited": false, "score": 0, "creation_date": 1480518503, "post_id": 40891180, "comment_id": 68997213, "body": "UDF. That way you can use <code>=VALIDATE(A1)</code> if A1 is the cell you wish to validate. Then you create your validation script in VBA"}, {"owner": {"reputation": 852, "user_id": 6563468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a4c2119cfc1ee9a6c5deeec2ead9a261?s=128&d=identicon&r=PG&f=1", "display_name": "Logan Reed", "link": "https://stackoverflow.com/users/6563468/logan-reed"}, "edited": false, "score": 0, "creation_date": 1480518588, "post_id": 40891180, "comment_id": 68997281, "body": "If you are already using VBA and have very complex validation rules, why not validate in <code>Worksheet_Change</code> event?"}], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 7230989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cc646db8c8e3dfdffb8f065f6ba114ae?s=128&d=identicon&r=PG&f=1", "display_name": "Jorg Vermeulen", "link": "https://stackoverflow.com/users/7230989/jorg-vermeulen"}, "is_accepted": false, "score": 1, "last_activity_date": 1486485424, "creation_date": 1486485424, "answer_id": 42095253, "question_id": 40891180, "link": "https://stackoverflow.com/questions/40891180/is-it-possible-to-base-data-validation-on-a-string-in-a-single-cell-in-excel-201/42095253#42095253", "title": "Is it possible to base data validation on a string in a single cell in excel 2010", "body": "<p>TNX for the support.</p>\n\n<p>The solution was a bit more difficult. </p>\n\n<p>I was able to make it work but only by combining VBA and Excel Formulas. Also i added a value to the dataSource with both the id and optionid in it.</p>\n\n<p><strong>Excel:</strong></p>\n\n<p>For The data validation i use an fuction who utilizes an offset which is dynamic and based on 2 values. This way i dont get the error that a validation is more than 255 characters. </p>\n\n<p>data validation formula:\n=OFFSET(List!$A$2;MATCH(CONCATENATE(V18;\"|\";E18);List!$F:$F;0)-2;1;COUNTIF(List!$F:$F;CONCATENATE(V18;\"|\";E18)))</p>\n\n<p>One is for the id and one is the optionid.</p>\n\n<p><strong>VBA:</strong></p>\n\n<p>I now use the on change event to produce the values needed for the dropdowns(data validation) but not letting vba insert the values for the data validation. It gets these values via a pre-loaded array which is started with a workbook_open event. (if this isnt loaded it will load it again).</p>\n\n<p>When i select an item it writes the id and optionid to a different cell. I then use these to produce the next dropdowns etc with the offset function. (one dropdown can result in multiple rows of new dropdowns)</p>\n\n<ul>\n<li><p>Also added some functionality for delete and change (in the middle) events. </p></li>\n<li><p>Also the onChange event now triggers the next dropdown and write its value if there is only one option. This will of course trigger the next.</p></li>\n</ul>\n"}], "owner": {"reputation": 11, "user_id": 7230989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cc646db8c8e3dfdffb8f065f6ba114ae?s=128&d=identicon&r=PG&f=1", "display_name": "Jorg Vermeulen", "link": "https://stackoverflow.com/users/7230989/jorg-vermeulen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 303, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1486485424, "creation_date": 1480516901, "question_id": 40891180, "link": "https://stackoverflow.com/questions/40891180/is-it-possible-to-base-data-validation-on-a-string-in-a-single-cell-in-excel-201", "title": "Is it possible to base data validation on a string in a single cell in excel 2010", "body": "<p>I am building a multilevel dependent dropdown structure in Excel based on a parent-child structure. Building this with vba is not a problem but the problem is reopening the file. It removes the validation because they have too many characters (more than 255?)</p>\n\n<p>The generated validation strings are too long for Excel to store so they are removed after reopening. </p>\n\n<p>A solution could be to write the validation string in a cell and base the validation on this cell value. Only problem is when i link the data validation to this cell its only one option. </p>\n\n<p>the value in the cell is something like A,B,C,D (already tried with or without \"\") </p>\n\n<p>Does anyone have a suggestion for an excel formula to use in the data validation to generate multiple options from a string like A,B,C,D located in one single cell.</p>\n"}, {"tags": ["vba", "excel", "macros"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 2, "creation_date": 1480516305, "post_id": 40890924, "comment_id": 68995590, "body": "You need to google loop through worksheets in vba."}, {"owner": {"reputation": 37, "user_id": 5500639, "user_type": "registered", "accept_rate": 86, "profile_image": "https://graph.facebook.com/10154283032189622/picture?type=large", "display_name": "Tarek Khedr", "link": "https://stackoverflow.com/users/5500639/tarek-khedr"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1480516460, "post_id": 40890924, "comment_id": 68995695, "body": "Can you show me how is that ? i am not a developer. Thank you"}, {"owner": {"reputation": 1856, "user_id": 4949483, "user_type": "registered", "accept_rate": 86, "profile_image": "https://graph.facebook.com/10207184362590012/picture?type=large", "display_name": "Rdster", "link": "https://stackoverflow.com/users/4949483/rdster"}, "edited": false, "score": 2, "creation_date": 1480516520, "post_id": 40890924, "comment_id": 68995743, "body": "Wow, that recorder code is verbose...clean it up some with <a href=\"http://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba-macros\" title=\"how to avoid using select in excel vba macros\">stackoverflow.com/questions/10714251/&hellip;</a>"}, {"owner": {"reputation": 1856, "user_id": 4949483, "user_type": "registered", "accept_rate": 86, "profile_image": "https://graph.facebook.com/10207184362590012/picture?type=large", "display_name": "Rdster", "link": "https://stackoverflow.com/users/4949483/rdster"}, "edited": false, "score": 2, "creation_date": 1480516847, "post_id": 40890924, "comment_id": 68995987, "body": "Luckily, you don&#39;t have to be a developer to be able to Google."}, {"owner": {"reputation": 37, "user_id": 5500639, "user_type": "registered", "accept_rate": 86, "profile_image": "https://graph.facebook.com/10154283032189622/picture?type=large", "display_name": "Tarek Khedr", "link": "https://stackoverflow.com/users/5500639/tarek-khedr"}, "reply_to_user": {"reputation": 1856, "user_id": 4949483, "user_type": "registered", "accept_rate": 86, "profile_image": "https://graph.facebook.com/10207184362590012/picture?type=large", "display_name": "Rdster", "link": "https://stackoverflow.com/users/4949483/rdster"}, "edited": false, "score": 0, "creation_date": 1480518479, "post_id": 40890924, "comment_id": 68997202, "body": "@Rdster : I think the reason that i asked the question here is that i the results i found on &quot;google&quot;  were complicated to me. Thanks for your info &quot; Luckily, you don&#39;t have to be a developer to be able to Google&quot;"}, {"owner": {"reputation": 1856, "user_id": 4949483, "user_type": "registered", "accept_rate": 86, "profile_image": "https://graph.facebook.com/10207184362590012/picture?type=large", "display_name": "Rdster", "link": "https://stackoverflow.com/users/4949483/rdster"}, "edited": false, "score": 0, "creation_date": 1480518657, "post_id": 40890924, "comment_id": 68997344, "body": "@TarekKhedr Seriously???  <a href=\"https://support.microsoft.com/en-us/kb/142126\" rel=\"nofollow noreferrer\">support.microsoft.com/en-us/kb/142126</a> was the very first hit on Google after searching for &quot;Excel VBA loop through all worksheets&quot;.  Looks almost exactly the same as the answer below.  Not very complicated at all."}, {"owner": {"reputation": 37, "user_id": 5500639, "user_type": "registered", "accept_rate": 86, "profile_image": "https://graph.facebook.com/10154283032189622/picture?type=large", "display_name": "Tarek Khedr", "link": "https://stackoverflow.com/users/5500639/tarek-khedr"}, "reply_to_user": {"reputation": 1856, "user_id": 4949483, "user_type": "registered", "accept_rate": 86, "profile_image": "https://graph.facebook.com/10207184362590012/picture?type=large", "display_name": "Rdster", "link": "https://stackoverflow.com/users/4949483/rdster"}, "edited": false, "score": 0, "creation_date": 1480518831, "post_id": 40890924, "comment_id": 68997466, "body": "Give me a break Mr VBA developer, I have tried that code and i can&#39;t get it running, i don&#39;t know why. If you don&#39;t want to help then thank you and there is no need for such a comments. @Rdster"}, {"owner": {"reputation": 1856, "user_id": 4949483, "user_type": "registered", "accept_rate": 86, "profile_image": "https://graph.facebook.com/10207184362590012/picture?type=large", "display_name": "Rdster", "link": "https://stackoverflow.com/users/4949483/rdster"}, "edited": false, "score": 0, "creation_date": 1480519057, "post_id": 40890924, "comment_id": 68997633, "body": "That would have been a great thing to include in your original post.  And if you can&#39;t get it running, why accept it as the answer????"}], "answers": [{"tags": [], "owner": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "is_accepted": false, "score": 0, "last_activity_date": 1506013910, "last_edit_date": 1506013910, "creation_date": 1480516775, "answer_id": 40891133, "question_id": 40890924, "link": "https://stackoverflow.com/questions/40890924/excel-macro-to-apply-on-all-sheets/40891133#40891133", "title": "excel macro to apply on all sheets", "body": "<p>Edit this to fit your needs:</p>\n\n<pre><code> Sub Theloopofloops()\n\n Dim wbk As Workbook\n Dim Filename As String\n Dim path As String\n Dim rCell As Range\n Dim rRng As Range\n Dim wsO As Worksheet\n Dim sheet As Worksheet\n\n\n path = \"pathtofile(s)\" &amp; \"\\\"\n Filename = Dir(path &amp; \"*.xl??\")\n Set wsO = ThisWorkbook.Sheets(\"Sheet1\") 'included in case you need to differentiate_\n              between workbooks i.e currently opened workbook vs workbook containing code\n\n Do While Len(Filename) &gt; 0\n     DoEvents\n     Set wbk = Workbooks.Open(path &amp; Filename, True, True)\n         For Each sheet In ActiveWorkbook.Worksheets  'this needs to be adjusted for specifiying sheets. Repeat loop for each sheet so thats on a per sheet basis\n                Set rRng = sheet.Range(\"a1:a1000\") 'OBV needs to be changed\n                For Each rCell In rRng.Cells\n                If rCell &lt;&gt; \"\" And rCell.Value &lt;&gt; vbNullString And rCell.Value &lt;&gt; 0 Then\n\n                   'code that does stuff\n\n                End If\n                Next rCell\n         Next sheet\n     wbk.Close False\n     Filename = Dir\n Loop\n End Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 37, "user_id": 5500639, "user_type": "registered", "accept_rate": 86, "profile_image": "https://graph.facebook.com/10154283032189622/picture?type=large", "display_name": "Tarek Khedr", "link": "https://stackoverflow.com/users/5500639/tarek-khedr"}, "edited": false, "score": 0, "creation_date": 1480517157, "post_id": 40891134, "comment_id": 68996210, "body": "Thank you , I will give this a try"}, {"owner": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "edited": false, "score": 0, "creation_date": 1480517287, "post_id": 40891134, "comment_id": 68996292, "body": "Activating sheets is unnecessary and sloppy. What if there are tons of sheets? You want his script to run forever? lol"}, {"owner": {"user_type": "does_not_exist", "display_name": "user7168530"}, "edited": false, "score": 1, "creation_date": 1480517340, "post_id": 40891134, "comment_id": 68996336, "body": "Haha I just included it as an example to work from. Include what you will ;)"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user7168530"}, "is_accepted": true, "score": 1, "last_activity_date": 1480516776, "creation_date": 1480516776, "answer_id": 40891134, "question_id": 40890924, "link": "https://stackoverflow.com/questions/40890924/excel-macro-to-apply-on-all-sheets/40891134#40891134", "title": "excel macro to apply on all sheets", "body": "<p>You could use something like this to loop through your worksheets. As an example, this macro just activates each sheet and shows a message box with the name, but you just need to copy paste what code you want to run on each sheet in its place. And just to reiterate what @Rdster has said, you might want to invest some time in organising your code better as it is very clunky :)</p>\n\n<pre><code>Sub WorksheetLoop()\n\nDim Count1 As Integer\nDim i As Integer\n\n'Set Count1 equal to the number of worksheets in the active workbook.\n\nCount1 = ActiveWorkbook.Worksheets.Count\n\nFor i = 1 To Count1\n\n    Worksheets(i).Activate\n\n    MsgBox ActiveWorkbook.Worksheets(i).Name\n\nNext\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 37, "user_id": 5500639, "user_type": "registered", "accept_rate": 86, "profile_image": "https://graph.facebook.com/10154283032189622/picture?type=large", "display_name": "Tarek Khedr", "link": "https://stackoverflow.com/users/5500639/tarek-khedr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1552, "favorite_count": 0, "accepted_answer_id": 40891134, "answer_count": 2, "score": -2, "last_activity_date": 1506013910, "creation_date": 1480516204, "question_id": 40890924, "link": "https://stackoverflow.com/questions/40890924/excel-macro-to-apply-on-all-sheets", "title": "excel macro to apply on all sheets", "body": "<p>I have an excel with multiple sheets. I have created a macro on one sheet with the  macro code below. How can i edit this code to be applied on all sheets in the workbook in one run. Thank you</p>\n\n<p>Sub scoresheet()\n'\n' scoresheet Macro\n'</p>\n\n<p>'</p>\n\n<pre><code>ActiveWindow.ScrollColumn = 6\nActiveWindow.ScrollColumn = 5\nActiveWindow.ScrollColumn = 4\nActiveWindow.ScrollColumn = 3\nActiveWindow.ScrollColumn = 2\nActiveWindow.ScrollColumn = 1\nColumns(\"F:F\").Select\nSelection.Insert Shift:=xlToRight, CopyOrigin:=xlFormatFromLeftOrAbove\nColumns(\"E:E\").Select\nSelection.TextToColumns Destination:=Range(\"E1\"), DataType:=xlDelimited, _\n    TextQualifier:=xlDoubleQuote, ConsecutiveDelimiter:=False, Tab:=False, _\n    Semicolon:=False, Comma:=False, Space:=False, Other:=True, OtherChar _\n    :=\"-\", FieldInfo:=Array(Array(1, 1), Array(2, 1)), TrailingMinusNumbers:=True\nColumns(\"I:I\").Select\nSelection.Insert Shift:=xlToRight, CopyOrigin:=xlFormatFromLeftOrAbove\nColumns(\"H:H\").Select\nSelection.TextToColumns Destination:=Range(\"H1\"), DataType:=xlDelimited, _\n    TextQualifier:=xlDoubleQuote, ConsecutiveDelimiter:=False, Tab:=False, _\n    Semicolon:=False, Comma:=False, Space:=False, Other:=True, OtherChar _\n    :=\"-\", FieldInfo:=Array(1, 1), TrailingMinusNumbers:=True\nRange(\"I1\").Select\nActiveCell.FormulaR1C1 = \"3fga\u00a0\"\nWith ActiveCell.Characters(Start:=1, Length:=5).Font\n    .Name = \"Verdana\"\n    .FontStyle = \"Bold\"\n    .Size = 7.5\n    .Strikethrough = False\n    .Superscript = False\n    .Subscript = False\n    .OutlineFont = False\n    .Shadow = False\n    .Underline = xlUnderlineStyleNone\n    .Color = -1\n    .TintAndShade = 0\n    .ThemeFont = xlThemeFontNone\nEnd With\nColumns(\"L:L\").Select\nSelection.Insert Shift:=xlToRight, CopyOrigin:=xlFormatFromLeftOrAbove\nColumns(\"K:K\").Select\nSelection.TextToColumns Destination:=Range(\"K1\"), DataType:=xlDelimited, _\n    TextQualifier:=xlDoubleQuote, ConsecutiveDelimiter:=False, Tab:=False, _\n    Semicolon:=False, Comma:=False, Space:=False, Other:=True, OtherChar _\n    :=\"-\", FieldInfo:=Array(1, 1), TrailingMinusNumbers:=True\nColumns(\"Y:AB\").Select\nSelection.Delete Shift:=xlToLeft\nColumns(\"Z:Z\").Select\nSelection.Insert Shift:=xlToRight, CopyOrigin:=xlFormatFromLeftOrAbove\nColumns(\"Y:Y\").Select\nSelection.TextToColumns Destination:=Range(\"Y1\"), DataType:=xlDelimited, _\n    TextQualifier:=xlDoubleQuote, ConsecutiveDelimiter:=False, Tab:=False, _\n    Semicolon:=False, Comma:=False, Space:=False, Other:=True, OtherChar _\n    :=\"-\", FieldInfo:=Array(1, 1), TrailingMinusNumbers:=True\nRange(\"Y1\").Select\nActiveCell.FormulaR1C1 = \"op_fgm\"\nWith ActiveCell.Characters(Start:=1, Length:=6).Font\n    .Name = \"Verdana\"\n    .FontStyle = \"Bold\"\n    .Size = 7.5\n    .Strikethrough = False\n    .Superscript = False\n    .Subscript = False\n    .OutlineFont = False\n    .Shadow = False\n    .Underline = xlUnderlineStyleNone\n    .Color = -1\n    .TintAndShade = 0\n    .ThemeFont = xlThemeFontNone\nEnd With\nRange(\"Z1\").Select\nActiveCell.FormulaR1C1 = \"op_fga\u00a0\"\nWith ActiveCell.Characters(Start:=1, Length:=7).Font\n    .Name = \"Verdana\"\n    .FontStyle = \"Bold\"\n    .Size = 7.5\n    .Strikethrough = False\n    .Superscript = False\n    .Subscript = False\n    .OutlineFont = False\n    .Shadow = False\n    .Underline = xlUnderlineStyleNone\n    .Color = -1\n    .TintAndShade = 0\n    .ThemeFont = xlThemeFontNone\nEnd With\nColumns(\"AA:AA\").Select\nSelection.Delete Shift:=xlToLeft\nColumns(\"AB:AB\").Select\nSelection.Insert Shift:=xlToRight, CopyOrigin:=xlFormatFromLeftOrAbove\nColumns(\"AA:AA\").Select\nSelection.TextToColumns Destination:=Range(\"AA1\"), DataType:=xlDelimited, _\n    TextQualifier:=xlDoubleQuote, ConsecutiveDelimiter:=False, Tab:=False, _\n    Semicolon:=False, Comma:=False, Space:=False, Other:=True, OtherChar _\n    :=\"-\", FieldInfo:=Array(1, 1), TrailingMinusNumbers:=True\nRange(\"AA1\").Select\nActiveCell.FormulaR1C1 = \"op_3fg\"\nWith ActiveCell.Characters(Start:=1, Length:=6).Font\n    .Name = \"Verdana\"\n    .FontStyle = \"Bold\"\n    .Size = 7.5\n    .Strikethrough = False\n    .Superscript = False\n    .Subscript = False\n    .OutlineFont = False\n    .Shadow = False\n    .Underline = xlUnderlineStyleNone\n    .Color = -1\n    .TintAndShade = 0\n    .ThemeFont = xlThemeFontNone\nEnd With\nRange(\"AB1\").Select\nActiveCell.FormulaR1C1 = \"op_3fga\u00a0\"\nWith ActiveCell.Characters(Start:=1, Length:=8).Font\n    .Name = \"Verdana\"\n    .FontStyle = \"Bold\"\n    .Size = 7.5\n    .Strikethrough = False\n    .Superscript = False\n    .Subscript = False\n    .OutlineFont = False\n    .Shadow = False\n    .Underline = xlUnderlineStyleNone\n    .Color = -1\n    .TintAndShade = 0\n    .ThemeFont = xlThemeFontNone\nEnd With\nColumns(\"AC:AC\").Select\nSelection.Delete Shift:=xlToLeft\nColumns(\"AD:AD\").Select\nSelection.Insert Shift:=xlToRight, CopyOrigin:=xlFormatFromLeftOrAbove\nColumns(\"AC:AC\").Select\nSelection.TextToColumns Destination:=Range(\"AC1\"), DataType:=xlDelimited, _\n    TextQualifier:=xlDoubleQuote, ConsecutiveDelimiter:=False, Tab:=False, _\n    Semicolon:=False, Comma:=False, Space:=False, Other:=True, OtherChar _\n    :=\"-\", FieldInfo:=Array(1, 1), TrailingMinusNumbers:=True\nRange(\"AC1\").Select\nActiveCell.FormulaR1C1 = \"op_ftm\"\nWith ActiveCell.Characters(Start:=1, Length:=6).Font\n    .Name = \"Verdana\"\n    .FontStyle = \"Bold\"\n    .Size = 7.5\n    .Strikethrough = False\n    .Superscript = False\n    .Subscript = False\n    .OutlineFont = False\n    .Shadow = False\n    .Underline = xlUnderlineStyleNone\n    .Color = -1\n    .TintAndShade = 0\n    .ThemeFont = xlThemeFontNone\nEnd With\nRange(\"AD1\").Select\nActiveCell.FormulaR1C1 = \"op_fta\u00a0\"\nWith ActiveCell.Characters(Start:=1, Length:=7).Font\n    .Name = \"Verdana\"\n    .FontStyle = \"Bold\"\n    .Size = 7.5\n    .Strikethrough = False\n    .Superscript = False\n    .Subscript = False\n    .OutlineFont = False\n    .Shadow = False\n    .Underline = xlUnderlineStyleNone\n    .Color = -1\n    .TintAndShade = 0\n    .ThemeFont = xlThemeFontNone\nEnd With\nColumns(\"AE:AE\").Select\nSelection.Delete Shift:=xlToLeft\nRange(\"AE1\").Select\nActiveCell.FormulaR1C1 = \"op_off\u00a0\"\nWith ActiveCell.Characters(Start:=1, Length:=7).Font\n    .Name = \"Verdana\"\n    .FontStyle = \"Bold\"\n    .Size = 7.5\n    .Strikethrough = False\n    .Superscript = False\n    .Subscript = False\n    .OutlineFont = False\n    .Shadow = False\n    .Underline = xlUnderlineStyleNone\n    .Color = -1\n    .TintAndShade = 0\n    .ThemeFont = xlThemeFontNone\nEnd With\nRange(\"AF1\").Select\nActiveCell.FormulaR1C1 = \"op_def\u00a0\"\nWith ActiveCell.Characters(Start:=1, Length:=7).Font\n    .Name = \"Verdana\"\n    .FontStyle = \"Bold\"\n    .Size = 7.5\n    .Strikethrough = False\n    .Superscript = False\n    .Subscript = False\n    .OutlineFont = False\n    .Shadow = False\n    .Underline = xlUnderlineStyleNone\n    .Color = -1\n    .TintAndShade = 0\n    .ThemeFont = xlThemeFontNone\nEnd With\nColumns(\"AG:AH\").Select\nSelection.Delete Shift:=xlToLeft\nRange(\"AG1\").Select\nActiveCell.FormulaR1C1 = \"op_pf\u00a0\"\nWith ActiveCell.Characters(Start:=1, Length:=6).Font\n    .Name = \"Verdana\"\n    .FontStyle = \"Bold\"\n    .Size = 7.5\n    .Strikethrough = False\n    .Superscript = False\n    .Subscript = False\n    .OutlineFont = False\n    .Shadow = False\n    .Underline = xlUnderlineStyleNone\n    .Color = -1\n    .TintAndShade = 0\n    .ThemeFont = xlThemeFontNone\nEnd With\nRange(\"AH1\").Select\nActiveCell.FormulaR1C1 = \"op_ast\u00a0\"\nWith ActiveCell.Characters(Start:=1, Length:=7).Font\n    .Name = \"Verdana\"\n    .FontStyle = \"Bold\"\n    .Size = 7.5\n    .Strikethrough = False\n    .Superscript = False\n    .Subscript = False\n    .OutlineFont = False\n    .Shadow = False\n    .Underline = xlUnderlineStyleNone\n    .Color = -1\n    .TintAndShade = 0\n    .ThemeFont = xlThemeFontNone\nEnd With\nRange(\"AI1\").Select\nActiveCell.FormulaR1C1 = \"op_to\u00a0\"\nWith ActiveCell.Characters(Start:=1, Length:=6).Font\n    .Name = \"Verdana\"\n    .FontStyle = \"Bold\"\n    .Size = 7.5\n    .Strikethrough = False\n    .Superscript = False\n    .Subscript = False\n    .OutlineFont = False\n    .Shadow = False\n    .Underline = xlUnderlineStyleNone\n    .Color = -1\n    .TintAndShade = 0\n    .ThemeFont = xlThemeFontNone\nEnd With\nRange(\"AJ1\").Select\nActiveCell.FormulaR1C1 = \"op_blk\u00a0\"\nWith ActiveCell.Characters(Start:=1, Length:=7).Font\n    .Name = \"Verdana\"\n    .FontStyle = \"Bold\"\n    .Size = 7.5\n    .Strikethrough = False\n    .Superscript = False\n    .Subscript = False\n    .OutlineFont = False\n    .Shadow = False\n    .Underline = xlUnderlineStyleNone\n    .Color = -1\n    .TintAndShade = 0\n    .ThemeFont = xlThemeFontNone\nEnd With\nRange(\"AK1\").Select\nActiveCell.FormulaR1C1 = \"op_stl\u00a0\"\nWith ActiveCell.Characters(Start:=1, Length:=7).Font\n    .Name = \"Verdana\"\n    .FontStyle = \"Bold\"\n    .Size = 7.5\n    .Strikethrough = False\n    .Superscript = False\n    .Subscript = False\n    .OutlineFont = False\n    .Shadow = False\n    .Underline = xlUnderlineStyleNone\n    .Color = -1\n    .TintAndShade = 0\n    .ThemeFont = xlThemeFontNone\nEnd With\nColumns(\"AL:AM\").Select\nSelection.Delete Shift:=xlToLeft\nRange(\"T1\").Select\nActiveCell.FormulaR1C1 = \"to\u00a0\"\nWith ActiveCell.Characters(Start:=1, Length:=3).Font\n    .Name = \"Verdana\"\n    .FontStyle = \"Bold\"\n    .Size = 7.5\n    .Strikethrough = False\n    .Superscript = False\n    .Subscript = False\n    .OutlineFont = False\n    .Shadow = False\n    .Underline = xlUnderlineStyleNone\n    .Color = -1\n    .TintAndShade = 0\n    .ThemeFont = xlThemeFontNone\nEnd With\nRows(\"1:1\").Select\nRange(\"P1\").Activate\nWith Selection.Font\n    .ThemeColor = xlThemeColorDark1\n    .TintAndShade = 0\nEnd With\nRange(\"X1\").Select\n</code></pre>\n\n<p>End Sub</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1480516174, "post_id": 40890873, "comment_id": 68995495, "body": "You are missing an End If in the last Else IF in the first long If statement."}, {"owner": {"reputation": 4621, "user_id": 1939638, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vu1kQ.jpg?s=128&g=1", "display_name": "Matt Cremeens", "link": "https://stackoverflow.com/users/1939638/matt-cremeens"}, "edited": false, "score": 0, "creation_date": 1480516177, "post_id": 40890873, "comment_id": 68995497, "body": "You are missing an <code>end if</code> here:   <code>If xlCell.Offset(0, 5).Value = 100 Then                 xlCell.Value = &quot;Done&quot;             Else                 xlCell.Value = &quot;At Risk&quot;</code>"}, {"owner": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "edited": false, "score": 1, "creation_date": 1480516215, "post_id": 40890873, "comment_id": 68995519, "body": "I like how all three of us are on this LOL"}, {"owner": {"reputation": 4621, "user_id": 1939638, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vu1kQ.jpg?s=128&g=1", "display_name": "Matt Cremeens", "link": "https://stackoverflow.com/users/1939638/matt-cremeens"}, "edited": false, "score": 3, "creation_date": 1480516267, "post_id": 40890873, "comment_id": 68995560, "body": "If I don&#39;t rush to answer the easy ones, then I don&#39;t know if I&#39;d answer any. :)"}, {"owner": {"reputation": 1987, "user_id": 4434652, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/94ee978abf31b6cb604ec929a54ae4e1?s=128&d=identicon&r=PG&f=1", "display_name": "Brian", "link": "https://stackoverflow.com/users/4434652/brian"}, "reply_to_user": {"reputation": 4621, "user_id": 1939638, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vu1kQ.jpg?s=128&g=1", "display_name": "Matt Cremeens", "link": "https://stackoverflow.com/users/1939638/matt-cremeens"}, "edited": false, "score": 0, "creation_date": 1480516337, "post_id": 40890873, "comment_id": 68995613, "body": "@MattCremeens Exactly!"}, {"owner": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "reply_to_user": {"reputation": 4621, "user_id": 1939638, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vu1kQ.jpg?s=128&g=1", "display_name": "Matt Cremeens", "link": "https://stackoverflow.com/users/1939638/matt-cremeens"}, "edited": false, "score": 0, "creation_date": 1480516511, "post_id": 40890873, "comment_id": 68995736, "body": "@MattCremeens sadly i have to take whatever low hanging fruit i can get O_o"}, {"owner": {"reputation": 55, "user_id": 7229848, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/6bf0740775ef2058d5fcaf755e4797f9?s=128&d=identicon&r=PG&f=1", "display_name": "FrasercT", "link": "https://stackoverflow.com/users/7229848/fraserct"}, "edited": false, "score": 0, "creation_date": 1480516556, "post_id": 40890873, "comment_id": 68995764, "body": "Thanks guys, such a rookie error on my part!"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1480522330, "post_id": 40890873, "comment_id": 68999970, "body": "Also, a small note, I see you may be using multiple worksheets. Your very first <code>Range(&quot;A1&quot;)</code> should have the workbook and worksheet you expect that value to come from, just to be explicit with the code. ie <code>Set xlCell = wb.Worksheets(&quot;Dashboard&quot;).Range(&quot;A2&quot;)</code>"}], "answers": [{"comments": [{"owner": {"reputation": 55, "user_id": 7229848, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/6bf0740775ef2058d5fcaf755e4797f9?s=128&d=identicon&r=PG&f=1", "display_name": "FrasercT", "link": "https://stackoverflow.com/users/7229848/fraserct"}, "edited": false, "score": 0, "creation_date": 1480516469, "post_id": 40890916, "comment_id": 68995705, "body": "Thank you! I think I need a break, always useful having a second pair of eyes to check over things :)"}, {"owner": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "reply_to_user": {"reputation": 55, "user_id": 7229848, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/6bf0740775ef2058d5fcaf755e4797f9?s=128&d=identicon&r=PG&f=1", "display_name": "FrasercT", "link": "https://stackoverflow.com/users/7229848/fraserct"}, "edited": false, "score": 0, "creation_date": 1480516595, "post_id": 40890916, "comment_id": 68995804, "body": "@FrasercT help a guy out with a check mark and a mark up :D"}], "tags": [], "owner": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "is_accepted": true, "score": 1, "last_activity_date": 1480516187, "creation_date": 1480516187, "answer_id": 40890916, "question_id": 40890873, "link": "https://stackoverflow.com/questions/40890873/need-some-help-finding-where-my-next-without-for-error-is-coming-from/40890916#40890916", "title": "Need some help finding where my Next without For error is coming from", "body": "<p>youre missing an end if here</p>\n\n<pre><code>    ElseIf xlCell.Offset(0, 6).Value &lt; Date And xlCell.Offset(0, 7).Value &gt; wb.Worksheets(\"DashBoard\").Cells(25, 4).Value And (Counter / xlCell.Offset(0, 3)) * 100 / 0.75 &lt; xlCell.Offset(0, 4) &lt;= Counter / xlCell.Offset(0, 3) * 100 Then\n        If xlCell.Offset(0, 5).Value = 100 Then\n            xlCell.Value = \"Done\"\n        Else\n            xlCell.Value = \"At Risk\"\n    End If\n</code></pre>\n"}], "owner": {"reputation": 55, "user_id": 7229848, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/6bf0740775ef2058d5fcaf755e4797f9?s=128&d=identicon&r=PG&f=1", "display_name": "FrasercT", "link": "https://stackoverflow.com/users/7229848/fraserct"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 32, "favorite_count": 0, "accepted_answer_id": 40890916, "answer_count": 1, "score": -1, "last_activity_date": 1480516187, "creation_date": 1480516047, "last_edit_date": 1480516098, "question_id": 40890873, "link": "https://stackoverflow.com/questions/40890873/need-some-help-finding-where-my-next-without-for-error-is-coming-from", "title": "Need some help finding where my Next without For error is coming from", "body": "<pre><code>Set xlCell = Range(\"A2\")\n    For index = 1 To i\n        'update values in the status column\n        If xlCell.Offset(0, 12).Value = \"True\" Then\n            xlCell.Value = \"\"\n        ElseIf xlCell.Offset(0, 7).Value &lt; Date Then 'Done and overdue tasks\n            If xlCell.Offset(0, 5).Value = 100 Then\n                If xlCell.Offset(0, 7).Value &gt; wb.Worksheets(\"Dashboard\").Cells(25, 3).Value Then\n                    xlCell.Value = \"Done\"\n                End If\n            ElseIf xlCell.Offset(0, 5).Value &lt; 100 Then\n                xlCell.Value = \"Overdue\"\n            End If\n        ElseIf xlCell.Offset(0, 7).Value &lt; wb.Worksheets(\"Dashboard\").Cells(25, 4).Value Then 'Doing this week tasks\n            If xlCell.Offset(0, 5).Value = 100 Then\n                xlCell.Value = \"Done\"\n            Else\n                xlCell.Value = \"To be completed this week\"\n            End If\n        ElseIf xlCell.Offset(0, 7).Value &lt; wb.Worksheets(\"Dashboard\").Cells(25, 5).Value Then 'to be done next week\n            If xlCell.Offset(0, 5).Value = 100 Then\n                xlCell.Value = \"Done\"\n            Else\n                xlCell.Value = \"To complete next week\"\n            End If\n        ElseIf xlCell.Offset(0, 6).Value &lt; Date And xlCell.Offset(0, 7).Value &gt; wb.Worksheets(\"DashBoard\").Cells(25, 4).Value And xlCell.Offset(0, 4).Value &lt;= (Counter / xlCell.Offset(0, 3)) * 100 / 0.75 Then\n            If xlCell.Offset(0, 5).Value = 100 Then\n                xlCell.Value = \"Done\"\n            Else\n                xlCell.Value = \"Off Track\"\n            End If\n        ElseIf xlCell.Offset(0, 6).Value &lt; Date And xlCell.Offset(0, 7).Value &gt; wb.Worksheets(\"DashBoard\").Cells(25, 4).Value And (Counter / xlCell.Offset(0, 3)) * 100 / 0.75 &lt; xlCell.Offset(0, 4) &lt;= Counter / xlCell.Offset(0, 3) * 100 Then\n            If xlCell.Offset(0, 5).Value = 100 Then\n                xlCell.Value = \"Done\"\n            Else\n                xlCell.Value = \"At Risk\"\n        End If\n        'Hide rows not required\n        If xlCell.Offset(0, 12).Value = \"True\" Then\n           If xlCell.Offset(0, 7).Value &lt; wb.Worksheets(\"Dashboard\").Cells(25, 3).Value Then\n                If xlCell.Offset(0, 5).Value = 100 Then\n                    xlCell.EntireRow.Hidden = True\n                End If\n            ElseIf xlCell.Offset(0, 6).Value &gt; wb.Worksheets(\"Dashboard\").Cells(25, 5).Value Then\n                xlCell.EntireRow.Hidden = True\n            End If\n        ElseIf xlCell.Value = \"\" Then\n            xlCell.EntireRow.Hidden = True\n        End If\n        Set xlCell = xlCell.Offset(1, 0)\n    Next index\n</code></pre>\n"}, {"tags": ["regex", "excel", "vba"], "comments": [{"owner": {"reputation": 481661, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1480515530, "post_id": 40890643, "comment_id": 68995015, "body": "Do you need your expected result is just a single string or an array/collection?"}, {"owner": {"reputation": 717, "user_id": 5363379, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/a0abd0a1495ff633ee9f3c0d06d50c6c?s=128&d=identicon&r=PG&f=1", "display_name": "tjb1", "link": "https://stackoverflow.com/users/5363379/tjb1"}, "reply_to_user": {"reputation": 481661, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1480515606, "post_id": 40890643, "comment_id": 68995084, "body": "I can work with either one but ideally I need to return the largest number out of the collection."}, {"owner": {"reputation": 481661, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1480515843, "post_id": 40890643, "comment_id": 68995248, "body": "Well, try <code>strPattern = &quot;(?:^|\\D)(\\d{7})(?!\\d)&quot;</code> and then <code>s = s &amp; &quot; Word: &quot; &amp; match.SubMatches(0) &amp; &quot; &quot;</code>. The point is that you need to iterate all submatches using <code>match.SubMatches(0)</code> and then you may check which is the largest."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1480516126, "post_id": 40890643, "comment_id": 68995458, "body": "For the pattern can you not just use <code>\\d{7}</code>?"}, {"owner": {"reputation": 481661, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1480516168, "post_id": 40890643, "comment_id": 68995490, "body": "@SJR: Unless there are 8+ digit chunks that should not be matched."}, {"owner": {"reputation": 717, "user_id": 5363379, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/a0abd0a1495ff633ee9f3c0d06d50c6c?s=128&d=identicon&r=PG&f=1", "display_name": "tjb1", "link": "https://stackoverflow.com/users/5363379/tjb1"}, "reply_to_user": {"reputation": 481661, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1480516517, "post_id": 40890643, "comment_id": 68995740, "body": "@WiktorStribi\u017cew that works but I&#39;m unsure of how, could you change it to an answer and elaborate on the pattern?"}, {"owner": {"reputation": 717, "user_id": 5363379, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/a0abd0a1495ff633ee9f3c0d06d50c6c?s=128&d=identicon&r=PG&f=1", "display_name": "tjb1", "link": "https://stackoverflow.com/users/5363379/tjb1"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 1, "creation_date": 1480516616, "post_id": 40890643, "comment_id": 68995818, "body": "@SJR the reasoning for the \\D was to not extract 7 digits from a larger number."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1480517903, "post_id": 40890643, "comment_id": 68996746, "body": "Both - ah, ok I thought the OP was looking at at seven digit numbers."}], "answers": [{"comments": [{"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 1, "creation_date": 1480518594, "post_id": 40891161, "comment_id": 68997292, "body": "Nice explanation."}], "tags": [], "owner": {"reputation": 481661, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "is_accepted": true, "score": 4, "last_activity_date": 1480516843, "creation_date": 1480516843, "answer_id": 40891161, "question_id": 40890643, "link": "https://stackoverflow.com/questions/40890643/regex-return-seven-digit-number-match-only/40891161#40891161", "title": "Regex return seven digit number match only", "body": "<p>I suggest using the following pattern:</p>\n\n<pre><code>strPattern = \"(?:^|\\D)(\\d{7})(?!\\d)\"\n</code></pre>\n\n<p>Then, you will be able to access capturing group #1 contents (i.e. the text captured with the <code>(\\d{7})</code> part of the regex) via <code>match.SubMatches(0)</code>, and then you may check which value is the largest.</p>\n\n<p><strong>Pattern details</strong>:</p>\n\n<ul>\n<li><code>(?:^|\\D)</code> - a non-capturing group (does not create any submatch) matching the start of string (<code>^</code>) or a non-digit (<code>\\D</code>) </li>\n<li><code>(\\d{7})</code> -  Capturing group 1 matching 7 digits</li>\n<li><code>(?!\\d)</code> - a negative lookahead failing the match if there is a digit immediately after the 7 digits.</li>\n</ul>\n"}], "owner": {"reputation": 717, "user_id": 5363379, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/a0abd0a1495ff633ee9f3c0d06d50c6c?s=128&d=identicon&r=PG&f=1", "display_name": "tjb1", "link": "https://stackoverflow.com/users/5363379/tjb1"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1302, "favorite_count": 1, "accepted_answer_id": 40891161, "answer_count": 1, "score": 1, "last_activity_date": 1550758555, "creation_date": 1480515410, "last_edit_date": 1550758555, "question_id": 40890643, "link": "https://stackoverflow.com/questions/40890643/regex-return-seven-digit-number-match-only", "title": "Regex return seven digit number match only", "body": "<p>I've been trying to build a regular expression to extract a 7 digit number from a string but having difficulty getting the pattern correct.</p>\n\n<p>Example string - <code>WO1519641 WO1528113TB WO1530212 TB</code></p>\n\n<p>Example return - <code>1519641, 1528113, 1530212</code></p>\n\n<p>My code I'm using in Excel is...</p>\n\n<pre><code>Private Sub Extract7Digits()\n    Dim regEx As New RegExp\n    Dim strPattern As String\n    Dim strInput As String\n    Dim strReplace As String\n    Dim Myrange As Range\n\n    Set Myrange = ActiveSheet.Range(\"A1:A300\")\n\n    For Each c In Myrange\n        strPattern = \"\\D(\\d{7})\\D\"\n        'strPattern = \"(?:\\D)(\\d{7})(?:\\D)\"\n        'strPattern = \"(\\d{7}(\\D\\d{7}\\D))\"\n\n        strInput = c.Value\n\n        With regEx\n            .Global = True\n            .MultiLine = True\n            .IgnoreCase = False\n            .Pattern = strPattern\n        End With\n\n        If regEx.test(strInput) Then\n            Set matches = regEx.Execute(strInput)\n            For Each Match In matches\n                s = s &amp; \" Word: \" &amp; Match.Value &amp; \" \"\n            Next\n                c.Offset(0, 1) = s\n            Else\n                s = \"\"\n        End If\n\n    Next\nEnd Sub\n</code></pre>\n\n<p>I've tried all 3 patterns in that code but I end up getting a return of <code>O1519641, O1528113T, O1530212</code> when using <code>\"\\D(\\d{7})\\D\"</code>. As I understand now the <code>()</code> doesn't mean anything because of the way I am storing the matches while I initially thought they meant that the expression would <em>return</em> what was inside the <code>()</code>.  </p>\n\n<p>I've been testing things on <a href=\"http://regexr.com/\" rel=\"nofollow noreferrer\">http://regexr.com/</a> but I'm still unsure of how to get it to allow the number to be inside the string as <code>WO1528113TB</code> is but only return the numbers.  Do I need to run a RegEx on the returned value of the RegEx to exclude the letters the second time around?</p>\n"}, {"tags": ["excel", "vba", "recursion", "drilldown"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user7168530"}, "edited": false, "score": 0, "creation_date": 1480515063, "post_id": 40890405, "comment_id": 68994669, "body": "Hi. Does the data contained in Sheet2 fall into only two columns? Also, would I be correct in saying that there should be a &#39;Part 13&#39; under Module 1 in your final list example? Also, do you have any code that you have attempted?"}, {"owner": {"reputation": 73, "user_id": 2754071, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4ed0ae4b84031ea27d82962c401a97a5?s=128&d=identicon&r=PG&f=1", "display_name": "jvels", "link": "https://stackoverflow.com/users/2754071/jvels"}, "edited": false, "score": 0, "creation_date": 1481020867, "post_id": 40890405, "comment_id": 69195260, "body": "I have update my question with code"}], "owner": {"reputation": 73, "user_id": 2754071, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4ed0ae4b84031ea27d82962c401a97a5?s=128&d=identicon&r=PG&f=1", "display_name": "jvels", "link": "https://stackoverflow.com/users/2754071/jvels"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 64, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1481020781, "creation_date": 1480514664, "last_edit_date": 1481020781, "question_id": 40890405, "link": "https://stackoverflow.com/questions/40890405/drill-down-in-list-structur", "title": "drill down in list structur", "body": "<p>I have Excel file with two sheets:</p>\n\n<p>Sheet1 contain list of materials:</p>\n\n<pre><code>Module 1\nModule 3\nModule 7\n</code></pre>\n\n<p>Sheet2 contain a list Bill of materials:</p>\n\n<pre><code>Module 1    Part 1\nModule 1    Part 2\nModule 1    Part9\nPart 9  Part11\nPart 9  Part13\nPart 9  Part14\nModule 2    Part 20\nModule 2    Part 21\nModule 3    Part 45\nModule 3    Part 46\nModule 3    Part 48\nModule 3    Part 49\nModule 4    Part 71\nModule 4    Part 82\nModule 7    Part 77\nModule 7    Part 78\nPart 78 Part 100\nPart 78 Part 101\nPart 78 Part 103\nPart 103    Part177\nPart 103    Part178\n</code></pre>\n\n<p>I would like to Drill down into the list I have in sheet1 and get a list of all materials the structure contains from sheet 2:</p>\n\n<pre><code>Module 1\nPart 1\nPart 2\nPart 9\nPart 11\nPart 14\nModule 3\nPart 45\nPart 46\nPart 48\nPart 49\nModule 7\nPart 77\nPart 78\nPart 100\nPart 101\nPart 103\nPart 177\nPart 178\n</code></pre>\n\n<p>I know it is some recursion vba macro I need to \"drill down\" in the structure. Any sugestion how i can do that with a vba macro?</p>\n\n<pre><code>    Sub GetQuantities()\n\nConst ModelCol = \"A\"\nConst ModelQntyCol = \"B\"\nConst ParentCol = \"C\"\nConst Childcol = \"D\"\nConst ChildQuantCol = \"E\"\nConst ModelOutCol = \"F\"\nConst PartCol = \"G\"\nConst PartQntCol = \"H\"\n\n\nConst StartDataRow = 3\nSummaryRowCount = StartDataRow\n\nLastrow = Range(ParentCol &amp; Rows.Count).End(xlUp).Row\n\nSet ParentRange = Columns(ParentCol)\nSet ChildRange = Columns(Childcol)\nSet TopLevelPart = Columns(ModelCol)\n\nFor RowCount = StartDataRow To Lastrow\n  Child = Range(Childcol &amp; RowCount)\n  'Check if child is lowest level part by search through parent column\n  Set c = ParentRange.Find(what:=Child, LookIn:=xlValues, lookat:=xlWhole)\n  If c Is Nothing Then\n   ChildQuant = Range(ChildQuantCol &amp; RowCount)\n   'part is lowest level part\n   'now search for all parents\n   PartParent = Range(ParentCol &amp; RowCount)\n\n   'loop until part is found as another parent\n   Do\n     Set c = ChildRange.Find(what:=PartParent, LookIn:=xlValues, lookat:=xlWhole)\n     If Not c Is Nothing Then\n      Quant = Range(ChildQuantCol &amp; c.Row)\n      ChildQuant = ChildQuant * Quant\n      PartParent = Range(ParentCol &amp; c.Row)\n     End If\n   Loop While Not c Is Nothing\n\n   'Parent should now contain a top level part\n   'search for top level part\n   Set c = TopLevelPart.Find(what:=PartParent, LookIn:=xlValues, lookat:=xlWhole)\n   If c Is Nothing Then\n     MsgBox (\"Cannot find top Level Part : \" &amp; PartParent)\n   Else\n     Quant = Range(ModelQntyCol &amp; c.Row)\n     ChildQuant = ChildQuant * Quant\n     Range(ModelOutCol &amp; SummaryRowCount) = PartParent\n     Range(PartCol &amp; SummaryRowCount) = Child\n     Range(PartQntCol &amp; SummaryRowCount) = ChildQuant\n     SummaryRowCount = SummaryRowCount + 1\n   End If\n  End If\n\nNext RowCount\n\n\nEnd Sub\n</code></pre>\n\n<p>It give a list of all childes all top level materials contains. Like below:</p>\n\n<pre><code>Module 1    Part 1  1\nModule 1    Part 2  1\nModule 1    Part11  1\nModule 1    Par13   1\nModule 1    Part14  1\nModule 3    Part45  1\nModule 3    Part46  1\nModule 3    Part48  1\nModule 3    Part49  1\nModule 7    Part77  1\nModule 7    Part100 1\nModule 7    Part101 1\nModule 7    Part177 1\nModule 7    Part178 1\n</code></pre>\n\n<p>But I would like to have all levels between include in the list e.g.:</p>\n\n<pre><code>Part78   Part100\nPart78   Part101\nPart78   Part103\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1480514525, "post_id": 40890281, "comment_id": 68994277, "body": "How are you downloading the images? Also, <a href=\"http://stackoverflow.com/posts/40890281/edit\">edit your question</a> to include your code - it will be next to impossible to answer without it."}, {"owner": {"reputation": 2654, "user_id": 1177083, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/KKeqN.jpg?s=128&g=1", "display_name": "4ndro1d", "link": "https://stackoverflow.com/users/1177083/4ndro1d"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1480514599, "post_id": 40890281, "comment_id": 68994327, "body": "Edited. No download at all I guess?"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1480514909, "post_id": 40890281, "comment_id": 68994549, "body": "If it works with other URLs, my first guess would be the length of the string. I&#39;d test it with something 255 characters or less."}, {"owner": {"reputation": 2654, "user_id": 1177083, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/KKeqN.jpg?s=128&g=1", "display_name": "4ndro1d", "link": "https://stackoverflow.com/users/1177083/4ndro1d"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1480515876, "post_id": 40890281, "comment_id": 68995282, "body": "Well it is only about 125 chars long. I will try to find another image with a similar length tho"}, {"owner": {"reputation": 2654, "user_id": 1177083, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/KKeqN.jpg?s=128&g=1", "display_name": "4ndro1d", "link": "https://stackoverflow.com/users/1177083/4ndro1d"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1480516063, "post_id": 40890281, "comment_id": 68995410, "body": "Found one, which is working. Appneded those working URLs to the question"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1480516454, "post_id": 40890281, "comment_id": 68995691, "body": "The specific problem URL works for me when I test it."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 1, "creation_date": 1480516625, "post_id": 40890281, "comment_id": 68995822, "body": "Try <code>.Insert Trim(v)</code> -- if there are leading/trailing whitespace, that could result as an invalid URL and would raise the 1004."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1480535311, "post_id": 40890281, "comment_id": 69007589, "body": "The HTTP response code for the &quot;problem&quot; link is 206 (&quot;partial content&quot;, <a href=\"https://httpstatuses.com/206\" rel=\"nofollow noreferrer\">httpstatuses.com/206</a>), whereas the working ones are all 200 (success).  Thatm ight be the issue."}, {"owner": {"reputation": 2654, "user_id": 1177083, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/KKeqN.jpg?s=128&g=1", "display_name": "4ndro1d", "link": "https://stackoverflow.com/users/1177083/4ndro1d"}, "edited": false, "score": 0, "creation_date": 1480537138, "post_id": 40890281, "comment_id": 69008544, "body": "sounds reasonable. any hints on how I could fix this?"}, {"owner": {"reputation": 2654, "user_id": 1177083, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/KKeqN.jpg?s=128&g=1", "display_name": "4ndro1d", "link": "https://stackoverflow.com/users/1177083/4ndro1d"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1480538458, "post_id": 40890281, "comment_id": 69009268, "body": "@DavidZemens tried it without success."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1480541405, "post_id": 40890281, "comment_id": 69010894, "body": "Sorry - no ideas about a fix: just pointing out what might be the root of the problem."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1480552277, "post_id": 40890281, "comment_id": 69015152, "body": "Here&#39;s the thing: the URL is working, with <i>your</i> code, when I test it. This tells me the problem isn&#39;t in the VBA, but it&#39;s on the host end. You can&#39;t fix that, you can only handle the error. Do you need help with that aspect of this? If so, let me know :)"}, {"owner": {"reputation": 2654, "user_id": 1177083, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/KKeqN.jpg?s=128&g=1", "display_name": "4ndro1d", "link": "https://stackoverflow.com/users/1177083/4ndro1d"}, "edited": false, "score": 0, "creation_date": 1480580621, "post_id": 40890281, "comment_id": 69024018, "body": "I would really appreciate that. I will try to run it on my laptop as well but probably the problem is on the network site, router firewalls or whatever?  really need this data to write my master thesis tho :D I will call for help in case it is not working from the laptop as well"}, {"owner": {"reputation": 2654, "user_id": 1177083, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/KKeqN.jpg?s=128&g=1", "display_name": "4ndro1d", "link": "https://stackoverflow.com/users/1177083/4ndro1d"}, "edited": false, "score": 0, "creation_date": 1480595964, "post_id": 40890281, "comment_id": 69033937, "body": "Okay same story here :( Last try I can do is using my mobile phone&#39;s data volume and create a hotspot."}, {"owner": {"reputation": 2654, "user_id": 1177083, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/KKeqN.jpg?s=128&g=1", "display_name": "4ndro1d", "link": "https://stackoverflow.com/users/1177083/4ndro1d"}, "edited": false, "score": 0, "creation_date": 1480596231, "post_id": 40890281, "comment_id": 69034126, "body": "Also not working... I am on Windows 10 and used Excel 2016/365. What are you using?"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1480604743, "post_id": 40890281, "comment_id": 69040129, "body": "It&#39;s probably not <i>your</i> network connection, it&#39;s the host where the image resides. (Although your network connection could also be a problem)"}, {"owner": {"reputation": 640, "user_id": 4934536, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh6.googleusercontent.com/-FH3r_zUz8aI/AAAAAAAAAAI/AAAAAAAAAg4/jLT4QUBRzi0/photo.jpg?sz=128", "display_name": "Kurt Ludikovsky", "link": "https://stackoverflow.com/users/4934536/kurt-ludikovsky"}, "edited": false, "score": 0, "creation_date": 1546384225, "post_id": 40890281, "comment_id": 94836266, "body": "I have a similar problem with excel 2016. The issue seems to be that Excel is sending an HTTP &#39;OPTIONS&#39;- and/or &#39;HEAD&#39;-request before sending the actual &#39;GET&#39; request (at least in my tracedown). If the server is not capable of handling those requests the response will be a &#39;405 Method Not Allowed&#39; response, which results in an VBA error. interessting is that it worked for me about 3-4 weeks ago and suddenly stopped working."}], "answers": [{"comments": [{"owner": {"reputation": 2654, "user_id": 1177083, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/KKeqN.jpg?s=128&g=1", "display_name": "4ndro1d", "link": "https://stackoverflow.com/users/1177083/4ndro1d"}, "edited": false, "score": 0, "creation_date": 1480682185, "post_id": 40913806, "comment_id": 69075649, "body": "Error with URL comment - nothing else :( I don&#39;t really get it ^^ This is how it looke for me: <a href=\"https://s17.postimg.org/zfd6bw17z/Capture.png\" rel=\"nofollow noreferrer\">s17.postimg.org/zfd6bw17z/Capture.png</a>"}, {"owner": {"reputation": 2654, "user_id": 1177083, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/KKeqN.jpg?s=128&g=1", "display_name": "4ndro1d", "link": "https://stackoverflow.com/users/1177083/4ndro1d"}, "edited": false, "score": 0, "creation_date": 1480684586, "post_id": 40913806, "comment_id": 69077144, "body": "It is working. On my wifes&#39;s laptop.. I seriously don&#39;t know why because it&#39;s basically the same model as mine running the same software. Only difference was the logged in microsoft account. If I find some time I will try to confirm that.."}], "tags": [], "owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "is_accepted": true, "score": 2, "last_activity_date": 1480604287, "creation_date": 1480604287, "answer_id": 40913806, "question_id": 40890281, "link": "https://stackoverflow.com/questions/40890281/excel-convert-url-to-images-1004/40913806#40913806", "title": "Excel convert URL to images (1004)", "body": "<p>The problem (as far as I can tell) is <strong>not</strong> your device, but it's on the server that is hosting the image, and is failing to return the document. I'm not sure where Tim's comment above (pertaining to the 206 response code) comes from, but if that's the case, or if the URL is returning some error code, then your VBA would also fail and there is likely <strong>nothing you can do to resolve that</strong> if the problem is at the host.</p>\n\n<p>I manually enter the URL today and download the file, no problem.</p>\n\n<p>I check the <a href=\"https://httpstatus.io/\" rel=\"nofollow noreferrer\">response code</a> and it's returning correctly a 200 (success).</p>\n\n<p><a href=\"https://i.stack.imgur.com/aGaMD.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/aGaMD.png\" alt=\"enter image description here\"></a></p>\n\n<p>The best you can do at this point is to simply trap the error, and flag it for later review.</p>\n\n<p>In my test, I used some deliberatly bad URL just to ensure error handling is working as expected. These are the only ones that failed for me.</p>\n\n<p><a href=\"https://i.stack.imgur.com/pMgin.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/pMgin.png\" alt=\"enter image description here\"></a></p>\n\n<p>Here's the code I used, modified only slightly from yours and includes an error-handler to add a COMMENT to the cells which URLs return the error. This way you can later review manually and add those images if needed.</p>\n\n<pre><code>Sub InstallPictures()\n    Dim i As Long\n    Dim v As String\n    Dim cl As Range\n    Dim pic As Shape\n    Dim errors As New Collection\n\n    i = 2\n    Set cl = Cells(i, 15)\n    Do While Trim(cl.Value) &lt;&gt; vbNullString\n        v = Trim(cl.Value)\n        cl.ClearComments\n\n        With ActiveSheet.Pictures\n            On Error GoTo ErrHandler\n            Set p = .Insert(Trim(v))\n            On Error GoTo 0\n            ' I added this code to resize &amp; arrange the pictures\n            ' you can remove it if you don't need it\n            p.TopLeftCell = cl.Offset(0, -1)\n            p.Top = cl.Offset(0, -1).Top\n            p.Left = cl.Offset(0, -1).Left\n            p.Height = Cells(i, 15).Height\n            p.Width = Cells(1, 15).Width\n            '''''''''''''''''''''''''''''\n        End With\n\nNextCell:\n        i = i + 1\n        Set cl = Cells(i, 15)\n    Loop\n\n    If errors.Count &gt; 0 Then\n        MsgBox \"There were errors, please review the comments as some files may need to be manually downloaded\"\n    End If\n\n    Exit Sub\n\n\nErrHandler:\n    Call ErrorNote(v, cl, errors)\n    Resume NextCell\nEnd Sub\n\nPrivate Sub ErrorNote(url$, cl As Range, ByRef errs As Collection)\n' Adds an item to the errs collection and flags the offending\n' cell with a Comment indicating the error occurred. \n    On Error Resume Next\n    errs.Add (url)\n    With cl\n        .ClearComments\n        .AddComment (\"Error with URL: \" &amp; vbCrLf &amp; url)\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 2654, "user_id": 1177083, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/KKeqN.jpg?s=128&g=1", "display_name": "4ndro1d", "link": "https://stackoverflow.com/users/1177083/4ndro1d"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4177, "favorite_count": 0, "accepted_answer_id": 40913806, "answer_count": 1, "score": 3, "last_activity_date": 1480604287, "creation_date": 1480514304, "last_edit_date": 1495541837, "question_id": 40890281, "link": "https://stackoverflow.com/questions/40890281/excel-convert-url-to-images-1004", "title": "Excel convert URL to images (1004)", "body": "<p>I have an excel document linked to an SQL database which contains several columns of image URLs.</p>\n\n<p>One of those URLs looks like this:\n<a href=\"https://imissit.blob.core.windows.net/iris/596480cf967e0c990c37fba3725ada0c/814040e2-0ccb-4b05-bdb3-d9dc9cc798d9/texture.png\" rel=\"nofollow noreferrer\">https://imissit.blob.core.windows.net/iris/596480cf967e0c990c37fba3725ada0c/814040e2-0ccb-4b05-bdb3-d9dc9cc798d9/texture.png</a>\n<a href=\"https://i.stack.imgur.com/e6xvN.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/e6xvN.png\" alt=\"https://imissit.blob.core.windows.net/iris/596480cf967e0c990c37fba3725ada0c/814040e2-0ccb-4b05-bdb3-d9dc9cc798d9/texture.png\"></a></p>\n\n<p>I found different approaches and methods on how to convert those URLs to images ( e.g. \n<a href=\"https://stackoverflow.com/questions/15588995/excel-vba-insert-images-from-image-name-in-column/15589423\">Excel VBA Insert Images From Image Name in Column</a> and <a href=\"https://superuser.com/questions/940861/how-can-i-display-a-url-as-an-image-in-an-excel-cell\">https://superuser.com/questions/940861/how-can-i-display-a-url-as-an-image-in-an-excel-cell</a>) within the excel document using macros. I tried those approaches but none of them works for my kind of URL. I tried other URLs (random images on the web, http and https and for those images it WORKS).</p>\n\n<p>This is one of the snippets I tried, which works for other images:</p>\n\n<pre><code>   Sub InstallPictures()\n    Dim i As Long, v As String\n    For i = 2 To 2\n        v = Cells(i, \"O\").Value\n        If v = \"\" Then Exit Sub\n        With ActiveSheet.Pictures\n            .Insert (v)\n        End With\n    Next i\nEnd Sub\n</code></pre>\n\n<p>Anyway when trying it with my URL I get a runtime error 1004: Insert method of picture object cannot be executed(translated). Different approaches result in slightly different runtime errors (although 1004 is consistent).</p>\n\n<p>Here are some image URLs I tried that work:</p>\n\n<p><a href=\"https://docs.oracle.com/cd/E21454_01/html/821-2584/figures/HTTPS_Collab_Sample.png\" rel=\"nofollow noreferrer\">https://docs.oracle.com/cd/E21454_01/html/821-2584/figures/HTTPS_Collab_Sample.png</a></p>\n\n<p><a href=\"http://www.w3schools.com/css/paris.jpg\" rel=\"nofollow noreferrer\">http://www.w3schools.com/css/paris.jpg</a></p>\n\n<p><a href=\"https://scontent.ftxl1-1.fna.fbcdn.net/v/t1.0-9/13043727_278733959131361_2241170037980408109_n.jpg?oh=bec505696c5f66cde0cc3b574a70547c&amp;oe=58CC35C5\" rel=\"nofollow noreferrer\">https://scontent.ftxl1-1.fna.fbcdn.net/v/t1.0-9/13043727_278733959131361_2241170037980408109_n.jpg?oh=bec505696c5f66cde0cc3b574a70547c&amp;oe=58CC35C5</a></p>\n\n<p>What is different from my URL to the others and why those methods don't work? What is the correct approach?</p>\n"}, {"tags": ["javascript", "vba", "internet-explorer", "onchange"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1480515913, "post_id": 40889982, "comment_id": 68995309, "body": "Have you tried .FireEvent?"}, {"owner": {"reputation": 31, "user_id": 4609912, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh6.googleusercontent.com/-EjTzX5pzRxY/AAAAAAAAAAI/AAAAAAAAADo/dYaY_k4EOi4/photo.jpg?sz=128", "display_name": "Yashish Karkera", "link": "https://stackoverflow.com/users/4609912/yashish-karkera"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1480519948, "post_id": 40889982, "comment_id": 68998270, "body": "I have tried the below .firevent but no luck. Let me know if I&#39;m missing something.        HTML.getElementById(&quot;TAT_Deaprtment_REASSIGN_DIALOG_FACILITY&zwnj;&#8203;_AUTOCOMPLETE&quot;).Valu&zwnj;&#8203;e = &quot;DropDownValuetobeselected&quot; HTML.getElementById(&quot;TAT_Deaprtment_REASSIGN_DIALOG_FACILITY&zwnj;&#8203;_AUTOCOMPLETE &quot;).FireEvent (&quot;onchange&quot;)"}, {"owner": {"reputation": 831, "user_id": 2159907, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/23f3e67a3c0fd17bfb9bf369b35fd431?s=128&d=identicon&r=PG", "display_name": "Rob Parsons", "link": "https://stackoverflow.com/users/2159907/rob-parsons"}, "edited": false, "score": 0, "creation_date": 1480533364, "post_id": 40889982, "comment_id": 69006617, "body": "HI, you set the select elements selectedIndex property or value property if you have a string value...  once you have set all of the forms&#39; elements values, you then fire the forms submit event either by sending a click to the default button or firing the forms event handler... preferably you want user action to decide to submit the form with the automated values inserted."}], "owner": {"reputation": 31, "user_id": 4609912, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh6.googleusercontent.com/-EjTzX5pzRxY/AAAAAAAAAAI/AAAAAAAAADo/dYaY_k4EOi4/photo.jpg?sz=128", "display_name": "Yashish Karkera", "link": "https://stackoverflow.com/users/4609912/yashish-karkera"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 567, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1528880840, "creation_date": 1480513450, "last_edit_date": 1592644375, "question_id": 40889982, "link": "https://stackoverflow.com/questions/40889982/vba-code-to-click-on-form-dropdown-from-ie", "title": "VBA code to click on Form Dropdown from IE", "body": "<p>I am trying to automate some bit of IE, I'm successfully so far but got stuck with clicking on a dropdown from the IE dropdown as it is having a change event.\nI was able to click on the dropdown but unable to make the selection from the dropdown.</p>\n<p>The code I'm trying to input the value is working but change event is not working.</p>\n<pre><code>HTML.getElementById(&quot;TAT_Deaprtment_REASSIGN_DIALOG_FACILITY_AUTOCOMPLETE&quot;).Value = &quot;DropDownValuetobeselected&quot;\n</code></pre>\n<p>The code I'm trying to click on the dropdown is working, but unable to make the selecetion and trigger change event.</p>\n<pre><code>Set addressInput = HTML.getElementById(&quot;TAT_ARROW&quot;)\naddressInput.Focus\naddressInput.Click\n</code></pre>\n<p>Below the screenshot of the IE dropdown form</p>\n<h3>IE Dropdown Screenshot</h3>\n<p><img src=\"https://i.stack.imgur.com/fVFVs.jpg\" alt=\"IE Dropdown Screenshot\" /></p>\n<p>Below is the source code:-</p>\n<pre><code>&lt;TD class=IconArea&gt;&lt;A id=TAT_ARROW href=&quot;javascript:void(0)&quot; jQuery1480509731310=&quot;51&quot;&gt;&lt;/A&gt;&lt;/TD&gt;\n\n&lt;SELECT onchange=&quot;;processDialog('CMD_REFRESH_DIALOG', 'ETQ$DIALOG_PARENT_TYPE=DOCUMENT&amp;amp;REFRESH_FIELD_NAME=TAT_Deaprtment_REASSIGN_DIALOG_FACILITY', 'TAT_Deaprtment_REASSIGN_DIALOG_FACILITY');&quot; onfocus=&quot;window.status=unescape('Field name is TAT_Deaprtment_REASSIGN_DIALOG_FACILITY');&quot; onblur=&quot;window.status='';&quot; class=FormField style=&quot;DISPLAY: none&quot; size=1 name=TAT_Deaprtment_REASSIGN_DIALOG_FACILITY optionsLoaded=&quot;true&quot;&gt;&lt;OPTION class=FormField value=39&gt;DropDownValuetobeselected&lt;/OPTION&gt;&lt;OPTION class=FormField selected value=&quot;&quot;&gt;&amp;nbsp;&lt;/OPTION&gt;&lt;/SELECT&gt;\n</code></pre>\n<p>Also Posted Here:- <a href=\"http://www.ozgrid.com/forum/showthread.php?t=201953&amp;p=781673#post781673\" rel=\"nofollow noreferrer\">Link</a></p>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 1, "creation_date": 1480513988, "post_id": 40889976, "comment_id": 68993861, "body": "Either switch to late binding or change the reference to Microsoft Office 15.0 Object Library."}, {"owner": {"reputation": 205, "user_id": 7016089, "user_type": "registered", "accept_rate": 67, "profile_image": "https://graph.facebook.com/10211115229465070/picture?type=large", "display_name": "Leandro Moreira", "link": "https://stackoverflow.com/users/7016089/leandro-moreira"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1480514039, "post_id": 40889976, "comment_id": 68993904, "body": "can you show me how? can you write it in the code?"}, {"owner": {"reputation": 4621, "user_id": 4709298, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/fe41ea7cc395df33b3ad744599248d80?s=128&d=identicon&r=PG&f=1", "display_name": "Preston", "link": "https://stackoverflow.com/users/4709298/preston"}, "edited": false, "score": 1, "creation_date": 1480514047, "post_id": 40889976, "comment_id": 68993912, "body": "<a href=\"http://stackoverflow.com/questions/9476268/filedialog-doesnt-work\" title=\"filedialog doesnt work\">stackoverflow.com/questions/9476268/filedialog-doesnt-work</a>"}], "answers": [{"tags": [], "owner": {"reputation": 49, "user_id": 9375703, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-WjtZeI0YXRI/AAAAAAAAAAI/AAAAAAAAEkc/Ou7t0-8IN7Q/photo.jpg?sz=128", "display_name": "Double E CPU", "link": "https://stackoverflow.com/users/9375703/double-e-cpu"}, "is_accepted": false, "score": 0, "last_activity_date": 1547666575, "creation_date": 1547666575, "answer_id": 54223932, "question_id": 40889976, "link": "https://stackoverflow.com/questions/40889976/filedialog-does-not-work-in-some-excel-versions-vba/54223932#54223932", "title": "FileDialog does not work in some excel versions VBA", "body": "<p>To use late binding use the FileDialog() function from the Excel.Application Object. Excel.Application.FileDialog() Is a function that returns a FileDialog Object for an open Workbook. If you declare a variable as a specific object such as Office.FileDialog it will create the object of the version that is used in the VBA reference the code was written with and at runtime on a different pc will ignore other version references and look for the specific version that the variable was declared with. </p>\n\n<p>You can use the reference to the active workbook but is not explicitly needed in Excel</p>\n\n<pre><code>Dim strategyFileDialog As Object \nSet strategyFileDialog = ActiveWorkbook.Application.FileDialog(3)\n\n'Filedialog Enumerations: \n'msoFileDialogFilePicker = 3 File picker dialog box. \n'msoFileDialogFolderPicker = 4 Folder picker dialog box. \n'msoFileDialogOpen = 1 Open dialog box. \n'msoFileDialogSaveAs = 2 Save As dialog box \n</code></pre>\n"}], "owner": {"reputation": 205, "user_id": 7016089, "user_type": "registered", "accept_rate": 67, "profile_image": "https://graph.facebook.com/10211115229465070/picture?type=large", "display_name": "Leandro Moreira", "link": "https://stackoverflow.com/users/7016089/leandro-moreira"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1097, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1547666575, "creation_date": 1480513437, "question_id": 40889976, "link": "https://stackoverflow.com/questions/40889976/filedialog-does-not-work-in-some-excel-versions-vba", "title": "FileDialog does not work in some excel versions VBA", "body": "<p>I have a code that works in the excel version 2010 normally, but in the 2013 version does not. Take a look.</p>\n\n<pre><code>Sub select_strategy()\n'Subroutine that lets the user select a strategy table\n'\n    'Declare local variables\n    Dim strategyFileDialog As Office.FileDialog\n    'Declare local variables\n    Dim intStrategySelection As Integer\n\n    'Initialize global variables\n    Call initialize_global_variables\n\n    ' Allows the user to select the strategy table to use\n    Set strategyFileDialog = Application.FileDialog(msoFileDialogFilePicker)\n\n    With strategyFileDialog\n        .Title = \"Select Strategy Table\"\n        .InitialFileName = ActiveWorkbook.Path\n        .AllowMultiSelect = False\n    End With\n\n    intStrategySelection = strategyFileDialog.Show  'updates cell only if a file is selected\n     If intStrategySelection &lt;&gt; 0 Then\n        wsMain.Cells(2, 3) = strategyFileDialog.SelectedItems(1)\n     Else\n        wsMain.Cells(2, 3) = \"\"\n     End If\n\nEnd Sub\n</code></pre>\n\n<p>The error for the 2013 version is Compile error: Cant find project or library.\nAny ideas how to solve it?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 1, "creation_date": 1480513517, "post_id": 40889789, "comment_id": 68993513, "body": "What are the values of <code>col</code> and <code>row</code> when the error raises? I think it looks like you&#39;re assigning these long/integer values, and that will result in an invalid range address string (<code>col &amp; row &amp; &quot;:&quot; &amp; col &amp; row</code>)"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 2, "creation_date": 1480513575, "post_id": 40889789, "comment_id": 68993551, "body": "Are you sure that&#39;s the correct error line?  I get a 1004 on <code>CopyRange.Copy</code> because it can&#39;t be used on multiple selections.  Also, <code>row</code> and <code>col</code> are always the same, so you&#39;ll end up with ranges like <code>&quot;B2:B2&quot;</code>."}], "answers": [{"comments": [{"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 3, "creation_date": 1480513589, "post_id": 40889994, "comment_id": 68993562, "body": "On the first pass, <code>copyRange</code> is column A, as given by: <code>Set CopyRange = [A:A]</code>"}, {"owner": {"reputation": 35, "user_id": 6155961, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/0009e74349f01b170fd3ed2b4a5ba108?s=128&d=identicon&r=PG&f=1", "display_name": "Zigouma", "link": "https://stackoverflow.com/users/6155961/zigouma"}, "edited": false, "score": 0, "creation_date": 1480513848, "post_id": 40889994, "comment_id": 68993750, "body": "I delete set copyRange = [A:A] and tried it as Darren mention it and now it works but just for a small parameter!! i can&#39;t take a lot of columns and rows"}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1480514257, "post_id": 40889994, "comment_id": 68994070, "body": "My mistake - I did spot that and thought I&#39;d deleted my answer, but think I was in the middle of editing it to account for another answer that was deleted which pointed out the stuff that @DavidZemens indicated in his comment.  I&#39;ll get my coat :)"}], "tags": [], "owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "is_accepted": false, "score": 0, "last_activity_date": 1480513480, "creation_date": 1480513480, "answer_id": 40889994, "question_id": 40889789, "link": "https://stackoverflow.com/questions/40889789/vba-run-time-error-1004-application-defined-or-object-defined/40889994#40889994", "title": "VBA - Run Time Error 1004 &#39;Application Defined or Object Defined&#39;", "body": "<p>Union can only join two or more ranges.  On your first pass <code>CopyRange</code> will be nothing so the union method will fail.</p>\n\n<p>Try something like:  </p>\n\n<pre><code>If copyrange Is Nothing Then\n    Set copyrange = Range(col &amp; Row &amp; \":\" &amp; col &amp; Row)\nElse\n    Set copyrange = Union(copyrange, Range(col &amp; Row &amp; \":\" &amp; col &amp; Row))\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 35, "user_id": 6155961, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/0009e74349f01b170fd3ed2b4a5ba108?s=128&d=identicon&r=PG&f=1", "display_name": "Zigouma", "link": "https://stackoverflow.com/users/6155961/zigouma"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 399, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1480516795, "creation_date": 1480512929, "last_edit_date": 1480516795, "question_id": 40889789, "link": "https://stackoverflow.com/questions/40889789/vba-run-time-error-1004-application-defined-or-object-defined", "title": "VBA - Run Time Error 1004 &#39;Application Defined or Object Defined&#39;", "body": "<p>I want to copy a range of table and paste it in a new workbook. I want to copy ranges composed of other columns and rows but as variable. For example, I copy columns C and E with the rows from 1 to 17, 20, from 32 to 39 and 45. And I want to proceed that maximum 10 times (for the columns) and if I finish selecting the columns to copy, I exit. To be more clear, there is an example: I select column B, D, F and than select the rows to be copied (they are the same for all the columns) and finally copy them and paste them in a new workbook. So I stopped after three times and copy what I selected and go out.</p>\n\n<p>My Code:</p>\n\n<pre><code>Sub Macro33()\nDim col As String, row As String\n'Dim row As Integer\nDim CopyRange As Range\nSet CopyRange = [A:A]\n\n  For i = 1 To 10\n    col = InputBox(\"Column number \" &amp; i &amp; \", if finish write 'done'\")\n    If col = \"done\" Then\n      MsgBox (\"copy finished\")\n      GoTo ExitIteration\n    Else\n      row = InputBox(\"row number to copy (max to 62), if finish write 'done'\")\n      Do While row &lt;&gt; \"done\"\n        Set CopyRange = Union(CopyRange, Range(col &amp; row &amp; \":\" &amp; col &amp; row))\n        row = InputBox(\"row number to copy (max to 62), if finish write 'done'\")\n      Loop\n    End If\n  Next\n\n ExitIteration:\n   CopyRange.copy\n   Workbooks.Add\n   ActiveSheet.Paste\n   Windows(\"Pedro.xlsm\").Activate\n End Sub\n</code></pre>\n\n<p>The problem is in the Line:</p>\n\n<pre><code>  Set CopyRange = Union(CopyRange, Range(col &amp; row &amp; \":\" &amp; col &amp; row))\n</code></pre>\n\n<p>I always get <strong>application-defined or object-defined error (error 1004)</strong> and can't find any solution for it!!\nAny help please?</p>\n"}, {"tags": ["vba", "excel", "filter"], "answers": [{"comments": [{"owner": {"reputation": 27, "user_id": 5014499, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b908dc58ee856e6ec820950d6a817657?s=128&d=identicon&r=PG&f=1", "display_name": "Sebastian Schmitz", "link": "https://stackoverflow.com/users/5014499/sebastian-schmitz"}, "edited": false, "score": 0, "creation_date": 1480513384, "post_id": 40889832, "comment_id": 68993424, "body": "That&#39;s a great workaround! I can use the numbers in the first row, then a empty row with the buttons and then content. Can&#39;t believe i hadn&#39;t thoought of that."}, {"owner": {"reputation": 770, "user_id": 7086396, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-yLANabdeAgw/AAAAAAAAAAI/AAAAAAAAAQ4/eCyC7wOMQlU/photo.jpg?sz=128", "display_name": "Moacir", "link": "https://stackoverflow.com/users/7086396/moacir"}, "reply_to_user": {"reputation": 27, "user_id": 5014499, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b908dc58ee856e6ec820950d6a817657?s=128&d=identicon&r=PG&f=1", "display_name": "Sebastian Schmitz", "link": "https://stackoverflow.com/users/5014499/sebastian-schmitz"}, "edited": false, "score": 0, "creation_date": 1480513656, "post_id": 40889832, "comment_id": 68993614, "body": "I know how you feel. I also sometimes overthink things. :)"}], "tags": [], "owner": {"reputation": 770, "user_id": 7086396, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-yLANabdeAgw/AAAAAAAAAAI/AAAAAAAAAQ4/eCyC7wOMQlU/photo.jpg?sz=128", "display_name": "Moacir", "link": "https://stackoverflow.com/users/7086396/moacir"}, "is_accepted": true, "score": 1, "last_activity_date": 1480513073, "creation_date": 1480513073, "answer_id": 40889832, "question_id": 40889707, "link": "https://stackoverflow.com/questions/40889707/excel-filter-show-button-on-top-of-cell/40889832#40889832", "title": "Excel Filter - Show Button on top of cell", "body": "<p>Add a space on the cell above.</p>\n"}], "owner": {"reputation": 27, "user_id": 5014499, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b908dc58ee856e6ec820950d6a817657?s=128&d=identicon&r=PG&f=1", "display_name": "Sebastian Schmitz", "link": "https://stackoverflow.com/users/5014499/sebastian-schmitz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 995, "favorite_count": 0, "accepted_answer_id": 40889832, "answer_count": 1, "score": 0, "last_activity_date": 1480513073, "creation_date": 1480512696, "question_id": 40889707, "link": "https://stackoverflow.com/questions/40889707/excel-filter-show-button-on-top-of-cell", "title": "Excel Filter - Show Button on top of cell", "body": "<p>If you create a Table in Excel all columns get an autofilter.The Button is always shown on the right of the columnheader:</p>\n\n<p><a href=\"https://i.stack.imgur.com/9uZma.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/9uZma.png\" alt=\"Picture of Button position\"></a></p>\n\n<p>My Table has ~60 Columns. To safe horizontal space i would like to move the Button on top/below the cell:</p>\n\n<p><a href=\"https://i.stack.imgur.com/RUkFE.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/RUkFE.png\" alt=\"enter image description here\"></a></p>\n\n<p>Does anybody know how to move a autofilterbutton on top of a cell?</p>\n"}, {"tags": ["mysql", "vba", "ms-access", "math"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user7168530"}, "edited": false, "score": 0, "creation_date": 1480510951, "post_id": 40888989, "comment_id": 68991736, "body": "Hi. Have you considered using a pivot table to do this? Just change value field setting to &#39;Average&#39; when you drag in the value column..."}, {"owner": {"reputation": 17, "user_id": 7230826, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5741a04856985e6f0f722104e6d077c6?s=128&d=identicon&r=PG&f=1", "display_name": "Izzy Schneider ", "link": "https://stackoverflow.com/users/7230826/izzy-schneider"}, "edited": false, "score": 0, "creation_date": 1480511326, "post_id": 40888989, "comment_id": 68991964, "body": "@wilson88 Thank you. I&#39;ll try to use it. But according to my task, i need to do this in VBA. I have a several calculations which i have made in VBA and this one should be also a part of it."}, {"owner": {"reputation": 415, "user_id": 6339516, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/piSbx.jpg?s=128&g=1", "display_name": "J.B.", "link": "https://stackoverflow.com/users/6339516/j-b"}, "edited": false, "score": 0, "creation_date": 1480511578, "post_id": 40888989, "comment_id": 68992133, "body": "Hi, You can write VBA to create pivot table as suggested by @wilson88 and add the vlookup formula using VBA which will pull the average from pivot table to your desired column."}, {"owner": {"reputation": 2866, "user_id": 2584786, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/KbRVX.jpg?s=128&g=1", "display_name": "Neo", "link": "https://stackoverflow.com/users/2584786/neo"}, "edited": false, "score": 0, "creation_date": 1480511846, "post_id": 40888989, "comment_id": 68992339, "body": "I would suggest that you show your efforts so far.  With code your way more likely to get help from the folks you want help from.  <a href=\"http://stackoverflow.com/help/how-to-ask\">stackoverflow.com/help/how-to-ask</a>"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1480511924, "post_id": 40888989, "comment_id": 68992411, "body": "It&#39;s easy enough with formula to."}], "answers": [{"comments": [{"owner": {"reputation": 17, "user_id": 7230826, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5741a04856985e6f0f722104e6d077c6?s=128&d=identicon&r=PG&f=1", "display_name": "Izzy Schneider ", "link": "https://stackoverflow.com/users/7230826/izzy-schneider"}, "edited": false, "score": 0, "creation_date": 1480512897, "post_id": 40889065, "comment_id": 68993082, "body": "Awesome. Thank you very for this. It works perfect. Now I can end with my calculations :)"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user7168530"}, "is_accepted": true, "score": 0, "last_activity_date": 1480512320, "last_edit_date": 1480512320, "creation_date": 1480510869, "answer_id": 40889065, "question_id": 40888989, "link": "https://stackoverflow.com/questions/40888989/calculate-average-value-in-vba/40889065#40889065", "title": "Calculate average value in VBA", "body": "<p>Fair enough. If you have your heart set on a VBA solution this one should do the trick (for your example)...</p>\n\n<pre><code>Sub Av()\n\nDim LastRow As Long\n\nLastRow = ActiveSheet.Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n\nFor i = 2 To LastRow\n\n    Cells(i, 3).Value = Application.WorksheetFunction.SumIf(Range(\"A2:A\" &amp; LastRow), Range(\"A\" &amp; i), Range(\"B2:B\" &amp; LastRow)) / _\nApplication.WorksheetFunction.CountIf(Range(\"A2:A\" &amp; LastRow), Range(\"A\" &amp; i))\n\nNext\n\nEnd Sub\n</code></pre>\n\n<p>This solution will preserve your table rows in the example you posted (as non unique by ID)</p>\n"}, {"tags": [], "owner": {"reputation": 5, "user_id": 7085382, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/--giQSbXEtts/AAAAAAAAAAI/AAAAAAAAACQ/9DTj0wyq7hA/photo.jpg?sz=128", "display_name": "Rhys Williams", "link": "https://stackoverflow.com/users/7085382/rhys-williams"}, "is_accepted": false, "score": 0, "last_activity_date": 1480511785, "creation_date": 1480511785, "answer_id": 40889395, "question_id": 40888989, "link": "https://stackoverflow.com/questions/40888989/calculate-average-value-in-vba/40889395#40889395", "title": "Calculate average value in VBA", "body": "<p>If you didn't want to use a pivot table as wilson88 suggest you could try the following,</p>\n\n<p>Create a list from your data set that has no duplicates ID in it.</p>\n\n<p>In the column next to this list you can do a sumif formula to get the sum from you data set of each ID.</p>\n\n<p>Then in the column next to this you can do a countif formula to count the number of times that user id appears. Then you can divide the sumif column by the countif column to get the average.</p>\n\n<p>Once you get the idea of this you can combine the formulas into one cell as the following</p>\n\n<p>=sumif(\"ID RANGE\",\"ID\",\"sum Range\")/Countif(\"ID_RANGE\",\"ID\")</p>\n\n<p>This would be the manual way to produce a pivot table, you Can use vba to produce the formula's.</p>\n\n<p>Sheet1.range(\"A1:A100\").value = \"=enterformulahere\"</p>\n"}, {"tags": [], "owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "is_accepted": false, "score": 0, "last_activity_date": 1480512177, "creation_date": 1480512177, "answer_id": 40889553, "question_id": 40888989, "link": "https://stackoverflow.com/questions/40888989/calculate-average-value-in-vba/40889553#40889553", "title": "Calculate average value in VBA", "body": "<p>You could also use the array formula to find the unique id's </p>\n\n<p>Im using id's in a1:a10 and my values in b1:b10</p>\n\n<p>Using this array in d1:d10</p>\n\n<p><code>=INDEX($A$2:$A$10,MATCH(0,COUNTIF($D$1:D1,$A$2:$A$10),0))</code></p>\n\n<p>Gives me the unique ID's, then as above, simple SUMIF/COUNTIF</p>\n\n<p><code>=SUMIF($A$1:$A$10,$D1,$B$1:$B$10)/COUNTIF($A$1:$A$10,$D1)</code></p>\n\n<p><a href=\"https://i.stack.imgur.com/4Kda5.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/4Kda5.png\" alt=\"enter image description here\"></a></p>\n\n<p>Hope this helps</p>\n"}], "owner": {"reputation": 17, "user_id": 7230826, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5741a04856985e6f0f722104e6d077c6?s=128&d=identicon&r=PG&f=1", "display_name": "Izzy Schneider ", "link": "https://stackoverflow.com/users/7230826/izzy-schneider"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 330, "favorite_count": 0, "accepted_answer_id": 40889065, "answer_count": 3, "score": 0, "last_activity_date": 1480513201, "creation_date": 1480510658, "last_edit_date": 1480513201, "question_id": 40888989, "link": "https://stackoverflow.com/questions/40888989/calculate-average-value-in-vba", "title": "Calculate average value in VBA", "body": "<p>I need to calculate the average value of different numbers in VBA, but it has become complicated and I'm not sure what to do next.</p>\n\n<p>I turned to Google to find potential solutions to my problem, however I didn't find anything relevant.</p>\n\n<p>Here is my table:</p>\n\n<p><a href=\"https://i.stack.imgur.com/Pu24h.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Pu24h.png\" alt=\"Table example\"></a></p>\n\n<p>Each ID:</p>\n\n<ul>\n<li>...is a non-unique number. </li>\n<li>...has an associated Value.  </li>\n</ul>\n\n<p>The average values for each ID need to be calculated in VBA. </p>\n\n<p>Example</p>\n\n<ul>\n<li>The values with an Id of 'ID1' are 2,3 and 4, and so have an average of 3</li>\n<li>The values with an Id of 'ID2' are both 4, and so have an average of 4</li>\n<li>...</li>\n</ul>\n\n<p>What I have now either calculates average value for a whole column or simply  repeats the value.</p>\n\n<p>I would be very grateful for help and advice. </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1162, "user_id": 6893386, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d02aee16378d73f403c3d0ab868a4f4e?s=128&d=identicon&r=PG&f=1", "display_name": "bobajob", "link": "https://stackoverflow.com/users/6893386/bobajob"}, "edited": false, "score": 0, "creation_date": 1480510405, "post_id": 40888777, "comment_id": 68991374, "body": "Does <code>If Len(CStr(cell)) &gt; 0 Then cell = UCase(CStr(cell))</code> help at all?"}, {"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 5, "creation_date": 1480510451, "post_id": 40888777, "comment_id": 68991406, "body": "You&#39;ve probably got a cell with an error in it - have you tried debugging your code to see what line is causing the error? Simply ignoring the error is bad practice."}, {"owner": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "edited": false, "score": 0, "creation_date": 1480512489, "post_id": 40888777, "comment_id": 68992822, "body": "Numerics might screw this up too. Basic error handling should solve for this :)"}], "answers": [{"tags": [], "owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "is_accepted": false, "score": 1, "last_activity_date": 1480512734, "creation_date": 1480512734, "answer_id": 40889718, "question_id": 40888777, "link": "https://stackoverflow.com/questions/40888777/vba-upper-type-mismatch-error/40889718#40889718", "title": "VBA (Upper) Type Mismatch Error", "body": "<p>To see what cell (or cells) is the problem, you could try:</p>\n\n<pre><code>On Error Resume Next 'to enable in-line error-catching\n    For Each cell In Range(\"$A$1:\" &amp; Range(\"$A$1\").SpecialCells(xlLastCell).Address)\n        If Len(cell) &gt; 0 Then cell = UCase(cell)\n        If Err.Number &gt; 0 Then\n            Debug.Print cell.Address\n            Err.Clear\n        End If\n    Next cell\nOn Error GoTo 0 'Turn off On Error Resume Next\n</code></pre>\n\n<p><code>On Error Resume Next</code> is often abused, especially by new VBA programmers. Don't turn it on at the beginning of a sub and never turn it off and never check <code>Err.Number</code>. I find it a very good idea to think of it having a specific scope, and emphasizing that scope by indenting the statements in it, as I have done above. @MacroMan raises a good point that errors shouldn't be simply ignored (which is what happens if you abuse this construct).</p>\n"}, {"tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": false, "score": 0, "last_activity_date": 1480513285, "creation_date": 1480513285, "answer_id": 40889906, "question_id": 40888777, "link": "https://stackoverflow.com/questions/40888777/vba-upper-type-mismatch-error/40889906#40889906", "title": "VBA (Upper) Type Mismatch Error", "body": "<p>Add the following error trapping in the middle of your code:</p>\n\n<pre><code>On Error Resume Next\nIf Len(cell) &gt; 0 Then cell = UCase(cell)\n\nIf Err.Number &lt;&gt; 0 Then\n    MsgBox \"Cell \" &amp; cell.Address &amp; \" has an error !\"\nEnd If\nOn Error GoTo 0\n</code></pre>\n\n<p><strong>Note</strong>: Your code is fine with Numeric values, it's the <code>#NA</code> and <code>#DIV/0</code> that's raising the errors when running your original code.</p>\n"}, {"comments": [{"owner": {"reputation": 1569, "user_id": 2250361, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/4e701c7a98cb09ad426232270bdf41d8?s=128&d=identicon&r=PG", "display_name": "GPH", "link": "https://stackoverflow.com/users/2250361/gph"}, "edited": false, "score": 0, "creation_date": 1480515066, "post_id": 40890041, "comment_id": 68994670, "body": "perfect, was falling over at the #N/A however the file doesn&#39;t have any formula&#39;s. Thanks."}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": true, "score": 1, "last_activity_date": 1480513592, "creation_date": 1480513592, "answer_id": 40890041, "question_id": 40888777, "link": "https://stackoverflow.com/questions/40888777/vba-upper-type-mismatch-error/40890041#40890041", "title": "VBA (Upper) Type Mismatch Error", "body": "<p>If you want to convert <strong>all</strong> cells to upper case text <em>(including formulas)</em>:</p>\n\n<pre><code>Sub MyUpperCase()\n    Application.ScreenUpdating = False\n        Dim cell As Range, v As String\n\n        For Each cell In Range(\"$A$1:\" &amp; Range(\"$A$1\").SpecialCells(xlLastCell).Address)\n            v = cell.Text\n            If Len(v) &gt; 0 Then cell.Value = UCase(v)\n        Next cell\n    Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n\n<p>Be aware that all formulas not returning <em>Null</em> will also be converted to Text.</p>\n"}], "owner": {"reputation": 1569, "user_id": 2250361, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/4e701c7a98cb09ad426232270bdf41d8?s=128&d=identicon&r=PG", "display_name": "GPH", "link": "https://stackoverflow.com/users/2250361/gph"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 439, "favorite_count": 0, "accepted_answer_id": 40890041, "answer_count": 3, "score": 0, "last_activity_date": 1480513592, "creation_date": 1480510043, "last_edit_date": 1531164843, "question_id": 40888777, "link": "https://stackoverflow.com/questions/40888777/vba-upper-type-mismatch-error", "title": "VBA (Upper) Type Mismatch Error", "body": "<p>I am running a bit of VBA to switch an entire Excel worksheet to upper case. </p>\n\n<p>However it trips over and gives a Type Mismatch error and fails half way through.</p>\n\n<pre><code>Sub MyUpperCase()\n\n    Application.ScreenUpdating = False\n\n    Dim cell As Range\n    For Each cell In Range(\"$A$1:\" &amp; Range(\"$A$1\").SpecialCells(xlLastCell).Address)\n        If Len(cell) &gt; 0 Then cell = UCase(cell)\n    Next cell\n\n    Application.ScreenUpdating = True\n\n\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/dSel8.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/dSel8.png\" alt=\"enter image description here\"></a></p>\n\n<p>I'm assuming it is tripping over a specific cell however there are hundreds of lines. Is there a way to get it to skip errors</p>\n"}, {"tags": ["vba", "excel", "internet-explorer", "automation"], "comments": [{"owner": {"reputation": 415, "user_id": 6339516, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/piSbx.jpg?s=128&g=1", "display_name": "J.B.", "link": "https://stackoverflow.com/users/6339516/j-b"}, "edited": false, "score": 0, "creation_date": 1480510034, "post_id": 40888679, "comment_id": 68991124, "body": "After setting the value in dropdown, can you please try the following code: ie.Document.all.Item(&quot;docCategory&quot;).FireEvent (&quot;onchange&quot;)"}, {"owner": {"reputation": 31, "user_id": 7230732, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/060583774d582f932f34d37d8122482b?s=128&d=identicon&r=PG&f=1", "display_name": "Sara", "link": "https://stackoverflow.com/users/7230732/sara"}, "reply_to_user": {"reputation": 415, "user_id": 6339516, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/piSbx.jpg?s=128&g=1", "display_name": "J.B.", "link": "https://stackoverflow.com/users/6339516/j-b"}, "edited": false, "score": 0, "creation_date": 1480584032, "post_id": 40888679, "comment_id": 69025899, "body": "Thank you for the help... it worked good :)"}], "owner": {"reputation": 31, "user_id": 7230732, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/060583774d582f932f34d37d8122482b?s=128&d=identicon&r=PG&f=1", "display_name": "Sara", "link": "https://stackoverflow.com/users/7230732/sara"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 235, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1480509725, "creation_date": 1480509725, "last_edit_date": 1531164843, "question_id": 40888679, "link": "https://stackoverflow.com/questions/40888679/drop-drown-selection-in-ie-to-activate-another-drop-down", "title": "Drop drown selection in ie to activate another drop down", "body": "<p>I'm trying to select drop down in IE. I did tried few codes and the below one works fine for me to select a drop down.</p>\n\n<blockquote>\n  <p>ie.Document.all.Item(\"docCategory\").selectedIndex = \"2\"</p>\n</blockquote>\n\n<p>The problem is based on the option selected in first drop down the second drop down and text boxes will open.</p>\n\n<p>By using the code above I'm able to select the option in drop down but that is not opening/ activating the next drop down.</p>\n\n<p>Kindly help.</p>\n\n<p>For first drop down:</p>\n\n<pre><code>&lt;SELECT style=\"DISPLAY: block\" name=docCategory old_value=\"0\"&gt;\n&lt;OPTION value=%&gt;Any Category&lt;/OPTION&gt;\n&lt;OPTION value=FINANCE&gt;Finance Document&lt;/OPTION&gt;\n&lt;OPTION selected value=INBOUND&gt;Inbound Document&lt;/OPTION&gt;\n&lt;OPTION value=PROCESS&gt;Internal Process&lt;/OPTION&gt;\n&lt;OPTION value=OUTBOUND&gt;Outbound Document&lt;/OPTION&gt;\n&lt;/SELECT&gt;\n</code></pre>\n\n<p>For second drop down:</p>\n\n<pre><code>&lt;SELECT style=\"DISPLAY: block\" name=docType old_value=\"0\"&gt;\n&lt;OPTION selected value=%&gt;Any Type&lt;/OPTION&gt;\n&lt;OPTION value=A&gt;AAA&lt;/OPTION&gt;\n&lt;OPTION value=B&gt;BBB&lt;/OPTION&gt;\n&lt;OPTION value=C&gt;CCC&lt;/OPTION&gt;\n&lt;OPTION value=D&gt;DDD&lt;/OPTION&gt;\n&lt;/SELECT&gt;\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 717, "user_id": 5363379, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/a0abd0a1495ff633ee9f3c0d06d50c6c?s=128&d=identicon&r=PG&f=1", "display_name": "tjb1", "link": "https://stackoverflow.com/users/5363379/tjb1"}, "edited": false, "score": 0, "creation_date": 1480509964, "post_id": 40888339, "comment_id": 68991070, "body": "Why can&#39;t you use Data Validation?"}, {"owner": {"reputation": 2356, "user_id": 5332500, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/A9pzj.png?s=128&g=1", "display_name": "Rosetta", "link": "https://stackoverflow.com/users/5332500/rosetta"}, "edited": false, "score": 1, "creation_date": 1480514852, "post_id": 40888339, "comment_id": 68994506, "body": "this OP has two questions, (1) data validation (2) prevent pasting from overriding data validation. Both are asked before."}], "answers": [{"comments": [{"owner": {"reputation": 1108, "user_id": 3819867, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e08ff6f1bdf2ba013a902e5448de0cb6?s=128&d=identicon&r=PG&f=1", "display_name": "user3819867", "link": "https://stackoverflow.com/users/3819867/user3819867"}, "edited": false, "score": 1, "creation_date": 1480514398, "post_id": 40888953, "comment_id": 68994170, "body": "In case users are pasting values this solution doesn&#39;t work."}], "tags": [], "owner": {"reputation": 5, "user_id": 7085382, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/--giQSbXEtts/AAAAAAAAAAI/AAAAAAAAACQ/9DTj0wyq7hA/photo.jpg?sz=128", "display_name": "Rhys Williams", "link": "https://stackoverflow.com/users/7085382/rhys-williams"}, "is_accepted": false, "score": -2, "last_activity_date": 1480510562, "creation_date": 1480510562, "answer_id": 40888953, "question_id": 40888339, "link": "https://stackoverflow.com/questions/40888339/enforce-users-to-select-value-from-drop-down-list/40888953#40888953", "title": "Enforce users to select value from drop-down list", "body": "<p>Like Tjb1 says,</p>\n\n<p>Use data validation ( found in the data tab- allow - list )to lock the list to your selection then hide the tab or lock the tab with the list in.</p>\n\n<p>Through data validation you can add input message or error alert to inform the user.</p>\n"}, {"tags": [], "owner": {"reputation": 1108, "user_id": 3819867, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e08ff6f1bdf2ba013a902e5448de0cb6?s=128&d=identicon&r=PG&f=1", "display_name": "user3819867", "link": "https://stackoverflow.com/users/3819867/user3819867"}, "is_accepted": false, "score": 1, "last_activity_date": 1480514880, "creation_date": 1480514880, "answer_id": 40890479, "question_id": 40888339, "link": "https://stackoverflow.com/questions/40888339/enforce-users-to-select-value-from-drop-down-list/40890479#40890479", "title": "Enforce users to select value from drop-down list", "body": "<p>You need to first have a <code>Validation</code> set up. In case people paste and thus surpass your security measure you need to resort to more though solutions:<br>\nI created a simple function that can check against each cell in <code>Target</code> range on a <code>Worksheet_Change</code> event.<br>\n<strong>DISCLAIMER:</strong> <em>Do note we are not a coding service, if you do not understand these terms we are not to blame; in this case you need to read more on the basics.</em></p>\n\n<pre><code>Function isValid(rng As Range) As Boolean\n'isValid = rng.Validation.Formula1\nDim str As String, formstr As String, rng2 As Range, rng3 As Range\nstr = rng.Validation.Formula1\n'str = Replace(str, \"INDIREKT\", \"INDIRECT\") 'hungarian specific\nSet rng2 = Evaluate(str)\nFor Each rng3 In rng2\n    If rng3 = rng Then\n        isValid = True\n        Exit Function\n    End If\nNext rng3\nEnd Function\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": false, "score": 0, "last_activity_date": 1480518694, "creation_date": 1480518694, "answer_id": 40891808, "question_id": 40888339, "link": "https://stackoverflow.com/questions/40888339/enforce-users-to-select-value-from-drop-down-list/40891808#40891808", "title": "Enforce users to select value from drop-down list", "body": "<p>place this code in dropdown worksheet code pane:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    If Target.Address = $A$1 Then '&lt;--| change $A$1 to actual address of your dropdown cell\n        If Not Application.CutCopyMode = False Then\n            MsgBox \"Warning !!\" &amp; vbCrLf &amp; vbCrLf &amp; \"You are NOT allowed to paste over the drop-down list\"\n            Application.CutCopyMode = False\n        End If\n    End If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 6869021, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/804ddb74379f9ab69b9e26831b46ee9f?s=128&d=identicon&r=PG&f=1", "display_name": "gmainak", "link": "https://stackoverflow.com/users/6869021/gmainak"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 117, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1480518694, "creation_date": 1480508762, "last_edit_date": 1531164843, "question_id": 40888339, "link": "https://stackoverflow.com/questions/40888339/enforce-users-to-select-value-from-drop-down-list", "title": "Enforce users to select value from drop-down list", "body": "<p>I'm trying to make sure that users are selecting values in a column from a drop-down list. The list is in a different page. Also if the users are overwriting the drop-down list using \"PASTE\", then I need to pop-up a message box warning them about the same.</p>\n\n<p>How can I achieve this using VBA Macro</p>\n\n<p>Best Regards,</p>\n\n<p>gmainak</p>\n"}, {"tags": ["arrays", "vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 57, "user_id": 7224232, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/03ae8d081e7455c1ba07c6dd46e6794f?s=128&d=identicon&r=PG&f=1", "display_name": "mad2", "link": "https://stackoverflow.com/users/7224232/mad2"}, "edited": false, "score": 0, "creation_date": 1480510891, "post_id": 40888653, "comment_id": 68991692, "body": "thanks..can you help me once more. suppose &quot;&quot;Cells.Find(What:=i&quot;&quot; is not true, that means the element that i&#39;m searching is not found, then it should go to the next element."}, {"owner": {"user_type": "does_not_exist", "display_name": "user7168530"}, "reply_to_user": {"reputation": 57, "user_id": 7224232, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/03ae8d081e7455c1ba07c6dd46e6794f?s=128&d=identicon&r=PG&f=1", "display_name": "mad2", "link": "https://stackoverflow.com/users/7224232/mad2"}, "edited": false, "score": 0, "creation_date": 1480511371, "post_id": 40888653, "comment_id": 68992001, "body": "No prob. If you add the &#39;Skip:&#39; keyword after that section of code in the loop but just before the &#39;next&#39; (which I cant see in your macro), then it would skip that &#39;Cells.Find&#39; bit of code altogether completely (so yes)."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user7168530"}, "is_accepted": false, "score": 0, "last_activity_date": 1480509654, "creation_date": 1480509654, "answer_id": 40888653, "question_id": 40888308, "link": "https://stackoverflow.com/questions/40888308/evaluate-next-value-in-array-if-condition-becomes-false-in-macro/40888653#40888653", "title": "Evaluate next value in array, if condition becomes false in macro", "body": "<p>You could just add a CountIf bit of logic in there to test if the i'th element of the array exists in the range? And then jump past the section of code that makes changes if it doesnt exist (ie = 0)? In my example, i've used the term 'skip'. So like this....</p>\n\n<pre><code>Dim Ar() As Variant\nAr() = Array(\"jumpsuit\", \"matang\", \"bikini\")\nDim i As Variant\nFor Each i In Ar\nSheets(\"tops\").Select\nActiveSheet.Range(\"B1\").Select\n\nIf Application.WorksheetFunction.CountIf(ActiveSheet.Range(\"$A$1:$D$1335\"), i) = 0 Then\n\n    GoTo Skip\n\nEnd If\n\nSelection.AutoFilter\nActiveSheet.Range(\"$A$1:$D$1335\").AutoFilter Field:=2, Criteria1:=\"*\" &amp; i &amp; \"*\", Operator:=xlAnd\nActiveCell.Offset(0, 1).Range(\"A1\").Select\nSheets(\"Sheet1\").Select\nCells.Find(What:=i, After:=ActiveCell, LookIn:=xlFormulas, _\n    LookAt:=xlPart, SearchOrder:=xlByRows, SearchDirection:=xlNext, _\n    MatchCase:=False, SearchFormat:=False).Activate\nActiveCell.Range(\"A1\").Select\nSelection.Copy\nSelection.End(xlUp).Select\nSheets(\"tops\").Select\nDo\nActiveCell.Offset(1, 0).Select\nLoop While ActiveCell.EntireRow.Hidden = True\nActiveSheet.Paste\n</code></pre>\n\n<p>Then just put the 'skip:' term somewhere just before the next (I cant see it in your code, is it because this is just a section of a larger sub?)</p>\n"}, {"comments": [{"owner": {"reputation": 57, "user_id": 7224232, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/03ae8d081e7455c1ba07c6dd46e6794f?s=128&d=identicon&r=PG&f=1", "display_name": "mad2", "link": "https://stackoverflow.com/users/7224232/mad2"}, "edited": false, "score": 0, "creation_date": 1480510898, "post_id": 40888757, "comment_id": 68991700, "body": "thanks.. can you help me once more. suppose &quot;&quot;Cells.Find(What:=i&quot;&quot; is not true, that means the element that i&#39;m searching is not found, then it should go to the next element."}], "tags": [], "owner": {"reputation": 76, "user_id": 7132406, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-e3JX76SHxZg/AAAAAAAAAAI/AAAAAAAAIaM/gZ6LTkMMZ3M/photo.jpg?sz=128", "display_name": "Tilan04", "link": "https://stackoverflow.com/users/7132406/tilan04"}, "is_accepted": false, "score": 0, "last_activity_date": 1480509980, "creation_date": 1480509980, "answer_id": 40888757, "question_id": 40888308, "link": "https://stackoverflow.com/questions/40888308/evaluate-next-value-in-array-if-condition-becomes-false-in-macro/40888757#40888757", "title": "Evaluate next value in array, if condition becomes false in macro", "body": "<p>Make a function that check a list with the wanted values after put them in a sheet.</p>\n\n<pre><code>Function checking(value as string)\nDim x as integer\nDim numWantedvalues as Integer\n\nnumWantedvalues = WorksheetFunction.CountA(ThisWorkbook.Sheets(\"Sheet2\").Range(\"A:A\"))\n\nFor x = 1 to numWantedvalues\n    If ThisWorkbook.Sheets(\"Sheet2\").Range(\"A\" &amp; x) = value Then\n        checking = True\n    End If\nNext x\nend function\n</code></pre>\n\n<p>Then introduce the function in your code:</p>\n\n<pre><code>If checking(arValue) = True Then\n    'Actions that you want to do\nEnd If\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 57, "user_id": 7224232, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/03ae8d081e7455c1ba07c6dd46e6794f?s=128&d=identicon&r=PG&f=1", "display_name": "mad2", "link": "https://stackoverflow.com/users/7224232/mad2"}, "edited": false, "score": 0, "creation_date": 1480510876, "post_id": 40888759, "comment_id": 68991683, "body": "can you help me once more. suppose &quot;&quot;Cells.Find(What:=i&quot;&quot; is not true, that means the element that i&#39;m searching is not found, then it should go to the next element."}, {"owner": {"reputation": 57, "user_id": 7224232, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/03ae8d081e7455c1ba07c6dd46e6794f?s=128&d=identicon&r=PG&f=1", "display_name": "mad2", "link": "https://stackoverflow.com/users/7224232/mad2"}, "edited": false, "score": 0, "creation_date": 1480511365, "post_id": 40888759, "comment_id": 68991995, "body": "I have tried On Error Resume Next. but it&#39;s not working. Can you elaborate. Or send me exact code, the way you send me earlier"}], "tags": [], "owner": {"reputation": 1162, "user_id": 6893386, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d02aee16378d73f403c3d0ab868a4f4e?s=128&d=identicon&r=PG&f=1", "display_name": "bobajob", "link": "https://stackoverflow.com/users/6893386/bobajob"}, "is_accepted": true, "score": 0, "last_activity_date": 1480509988, "creation_date": 1480509988, "answer_id": 40888759, "question_id": 40888308, "link": "https://stackoverflow.com/questions/40888308/evaluate-next-value-in-array-if-condition-becomes-false-in-macro/40888759#40888759", "title": "Evaluate next value in array, if condition becomes false in macro", "body": "<p>Try wrapping everything after your Autofilter in a test for no results:</p>\n\n<p><code>If ActiveSheet.AutoFilter.Range.Columns(2).SpecialCells(xlCellTypeVisible).Count - 1 &gt; 0 Then</code></p>\n\n<p>ie:</p>\n\n<pre><code>Dim Ar() As Variant\nAr() = Array(\"jumpsuit\", \"matang\", \"bikini\")\nDim i As Variant\nFor Each i In Ar\n    Sheets(\"tops\").Select\n    ActiveSheet.Range(\"B1\").Select\n    Selection.AutoFilter\n    ActiveSheet.Range(\"$A$1:$D$1335\").AutoFilter Field:=2, Criteria1:=\"*\" &amp; i &amp; \"*\", Operator:=xlAnd\n   If ActiveSheet.AutoFilter.Range.Columns(2).SpecialCells(xlCellTypeVisible).Count - 1 &gt; 0 Then\n        ActiveCell.Offset(0, 1).Range(\"A1\").Select\n        Sheets(\"Sheet1\").Select\n        Cells.Find(What:=i, After:=ActiveCell, LookIn:=xlFormulas, _\n            LookAt:=xlPart, SearchOrder:=xlByRows, SearchDirection:=xlNext, _\n            MatchCase:=False, SearchFormat:=False).Activate\n        ActiveCell.Range(\"A1\").Select\n        Selection.Copy\n        Selection.End(xlUp).Select\n        Sheets(\"tops\").Select\n        Do\n        ActiveCell.Offset(1, 0).Select\n        Loop While ActiveCell.EntireRow.Hidden = True\n        ActiveSheet.Paste\n    End If\nNext i\n</code></pre>\n"}], "owner": {"reputation": 57, "user_id": 7224232, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/03ae8d081e7455c1ba07c6dd46e6794f?s=128&d=identicon&r=PG&f=1", "display_name": "mad2", "link": "https://stackoverflow.com/users/7224232/mad2"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 79, "favorite_count": 0, "accepted_answer_id": 40888759, "answer_count": 3, "score": 0, "last_activity_date": 1480509988, "creation_date": 1480508664, "question_id": 40888308, "link": "https://stackoverflow.com/questions/40888308/evaluate-next-value-in-array-if-condition-becomes-false-in-macro", "title": "Evaluate next value in array, if condition becomes false in macro", "body": "<p>There are 3 values in array. Out of those, 1 value is not there in the column for which I'm filtering the data (\"matang\"). I want to know how should i make it skip if there is no result for that keyword. That means after filtering using that keyword, no results are displayed. I want to skip that keyword and move onto next element of array. I have tried On Error Resume Next. So any other option?</p>\n\n<pre><code>    Dim Ar() As Variant\n    Ar() = Array(\"jumpsuit\", \"matang\", \"bikini\")\n    Dim i As Variant\n    For Each i In Ar\n    Sheets(\"tops\").Select\n    ActiveSheet.Range(\"B1\").Select\n    Selection.AutoFilter\n    ActiveSheet.Range(\"$A$1:$D$1335\").AutoFilter Field:=2, Criteria1:=\"*\" &amp; i &amp; \"*\", Operator:=xlAnd\n    ActiveCell.Offset(0, 1).Range(\"A1\").Select\n    Sheets(\"Sheet1\").Select\n    Cells.Find(What:=i, After:=ActiveCell, LookIn:=xlFormulas, _\n        LookAt:=xlPart, SearchOrder:=xlByRows, SearchDirection:=xlNext, _\n        MatchCase:=False, SearchFormat:=False).Activate\n    ActiveCell.Range(\"A1\").Select\n    Selection.Copy\n    Selection.End(xlUp).Select\n    Sheets(\"tops\").Select\n    Do\n    ActiveCell.Offset(1, 0).Select\n    Loop While ActiveCell.EntireRow.Hidden = True\n    ActiveSheet.Paste\n</code></pre>\n"}, {"tags": ["arrays", "vba", "excel"], "comments": [{"owner": {"reputation": 717, "user_id": 5363379, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/a0abd0a1495ff633ee9f3c0d06d50c6c?s=128&d=identicon&r=PG&f=1", "display_name": "tjb1", "link": "https://stackoverflow.com/users/5363379/tjb1"}, "edited": false, "score": 0, "creation_date": 1480510188, "post_id": 40888176, "comment_id": 68991241, "body": "You want to exit both loops?"}, {"owner": {"reputation": 15, "user_id": 3237098, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/178383a8b5694cc38855e5169090931a?s=128&d=identicon&r=PG&f=1", "display_name": "Tahmaseeb", "link": "https://stackoverflow.com/users/3237098/tahmaseeb"}, "reply_to_user": {"reputation": 717, "user_id": 5363379, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/a0abd0a1495ff633ee9f3c0d06d50c6c?s=128&d=identicon&r=PG&f=1", "display_name": "tjb1", "link": "https://stackoverflow.com/users/5363379/tjb1"}, "edited": false, "score": 0, "creation_date": 1480522301, "post_id": 40888176, "comment_id": 68999942, "body": "yea, i want to exit both loops because i dont want just dates without the lineno and quantity. so loop should exit at last quantity value."}], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 3237098, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/178383a8b5694cc38855e5169090931a?s=128&d=identicon&r=PG&f=1", "display_name": "Tahmaseeb", "link": "https://stackoverflow.com/users/3237098/tahmaseeb"}, "edited": false, "score": 0, "creation_date": 1480589418, "post_id": 40890368, "comment_id": 69029697, "body": "Thanks @Limak, i kinda mashed your answer with user3598756 to get my own answer. thanks for your help too :)"}], "tags": [], "owner": {"reputation": 1451, "user_id": 2882327, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/OiCh4.png?s=128&g=1", "display_name": "Limak", "link": "https://stackoverflow.com/users/2882327/limak"}, "is_accepted": false, "score": 1, "last_activity_date": 1480514568, "creation_date": 1480514568, "answer_id": 40890368, "question_id": 40888176, "link": "https://stackoverflow.com/questions/40888176/find-index-of-blank-entry-in-a-2d-array-excel-vba/40890368#40890368", "title": "Find Index of blank entry in a 2D Array Excel VBA", "body": "<p>This code escapes loop when some value of array is empty. Is that what you need?</p>\n\n<pre><code>For i = 0 To 6\n    For j = 0 To 2\n        If Line_Qty(i, j) = \"\" Then Exit For\n        Worksheets(\"DY_SET\").Cells(i + 1, j + 1).Value = Line_Qty(i, j)\n    Next j\n    Worksheets(\"DY_SET\").Range(\"A\" &amp; i + 2).NumberFormat = \"yyyy-mm-dd\"\nNext i\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 15, "user_id": 3237098, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/178383a8b5694cc38855e5169090931a?s=128&d=identicon&r=PG&f=1", "display_name": "Tahmaseeb", "link": "https://stackoverflow.com/users/3237098/tahmaseeb"}, "edited": false, "score": 0, "creation_date": 1480522981, "post_id": 40891159, "comment_id": 69000429, "body": "thanks a lot, it works perfectly, i was thinking index point of view, thats why i was stuck, truncating the array wasnt even in my head. thanks a lot again."}], "tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": true, "score": 1, "last_activity_date": 1480516843, "creation_date": 1480516843, "answer_id": 40891159, "question_id": 40888176, "link": "https://stackoverflow.com/questions/40888176/find-index-of-blank-entry-in-a-2d-array-excel-vba/40891159#40891159", "title": "Find Index of blank entry in a 2D Array Excel VBA", "body": "<p>You could first \"truncate\" the array and then paste surviving values, like follows:</p>\n\n<pre><code>Dim Line_QtyCopy(0 to 6, 0 to 2) As Variant\n\n' search Line_Qty first row with empty qty\nFor i = 0 To 6\n    If Line_Qty(i, 2) = \"\" Then Exit For\nNext i\n\nWith Worksheets(\"DY_SET\").Range(\"A1\") '&lt;--| reference target range\n    If i &lt;7 Then '&lt;--| if found empty qty before reaching array end\n        i = i - 1 '&lt;--| update row index to last not emoty one\n        ReDim Line_QtyCopy(0 to i, 0 to 2) '&lt;--| size a new array to the number of rows\n        ' fill it up to last not empty qty in Line_Qty\n        For i = 0 To i\n            For j = 0 To 2\n                Line_QtyCopy(i,j) = Line_Qty(i, j)\n            Next\n        Next\n        .Resize(i).Value = Line_QtyCopy '&lt;--| write it down from cell A1\n    Else\n        .Resize(6).Value = Line_Qty\n    End If\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 3237098, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/178383a8b5694cc38855e5169090931a?s=128&d=identicon&r=PG&f=1", "display_name": "Tahmaseeb", "link": "https://stackoverflow.com/users/3237098/tahmaseeb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 630, "favorite_count": 0, "accepted_answer_id": 40891159, "answer_count": 2, "score": 1, "last_activity_date": 1565768696, "creation_date": 1480508259, "last_edit_date": 1565768696, "question_id": 40888176, "link": "https://stackoverflow.com/questions/40888176/find-index-of-blank-entry-in-a-2d-array-excel-vba", "title": "Find Index of blank entry in a 2D Array Excel VBA", "body": "<p>I have an 2D Array <code>Dim Line_Qty(6, 2)</code> with values in it like the following:</p>\n\n<pre><code>**Date      Line_No  Quantity**\n\n2016-11-15   1       5856\n\n2016-11-15   2       5451\n\n2016-11-15   3       5499\n\n2016-11-15      \n\n2016-11-15      \n\n2016-11-15      \n</code></pre>\n\n<p>What i want to find is the index of the first blank which is  <code>Line_Qty(4, 1)</code></p>\n\n<p>the purpose of this is that i am pasting these values in excel sheet and i want to stop pasting till the last entry of Quantity.</p>\n\n<p>my pasting code is this </p>\n\n<pre><code>For i = 0 To 6\nFor j = 0 To 2\n\nWorksheets(\"DY_SET\").Cells(i + 1, j + 1).Value = Line_Qty(i, j)\nWorksheets(\"DY_SET\").Range(\"A\" &amp; i + 2).NumberFormat = \"yyyy-mm-dd\"\n\nNext j\nNext i\n</code></pre>\n\n<p>Hope i made myself clear, and thanks in advance</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2356, "user_id": 5332500, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/A9pzj.png?s=128&g=1", "display_name": "Rosetta", "link": "https://stackoverflow.com/users/5332500/rosetta"}, "edited": false, "score": 2, "creation_date": 1480505640, "post_id": 40887109, "comment_id": 68988434, "body": "have you try range(&quot;A1&quot;).specialcells(xllastcell)?"}, {"owner": {"reputation": 5709, "user_id": 640694, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/a15bc522697439dbdf2e58e4d98ee22b?s=128&d=identicon&r=PG", "display_name": "Passiday", "link": "https://stackoverflow.com/users/640694/passiday"}, "reply_to_user": {"reputation": 2356, "user_id": 5332500, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/A9pzj.png?s=128&g=1", "display_name": "Rosetta", "link": "https://stackoverflow.com/users/5332500/rosetta"}, "edited": false, "score": 0, "creation_date": 1480519371, "post_id": 40887109, "comment_id": 68997845, "body": "Thanks, you pointing out to the SpecialCells method helped me to come up with this: <code>ws.Range(&quot;A1:&quot; &amp; ws.Cells.SpecialCells(xlLastCell).Address)</code>"}], "answers": [{"tags": [], "owner": {"reputation": 145, "user_id": 6821241, "user_type": "registered", "accept_rate": 29, "profile_image": "https://i.stack.imgur.com/ugKRa.jpg?s=128&g=1", "display_name": "Martin Router King", "link": "https://stackoverflow.com/users/6821241/martin-router-king"}, "is_accepted": false, "score": 0, "last_activity_date": 1480508639, "creation_date": 1480508639, "answer_id": 40888298, "question_id": 40887109, "link": "https://stackoverflow.com/questions/40887109/excel-vba-range-for-all-relevant-cells/40888298#40888298", "title": "Excel VBA Range for all relevant cells", "body": "<p>I think you should use these functions to find the last Row/Column</p>\n\n<pre><code>lastRow = Sheets(\"Sheetname\").Cells(Rows.Count, 1).End(xlUp).Row\n\nlastCol = Sheets(\"Sheetname\").Cells(1, Columns.Count).End(xlToLeft).Column\n</code></pre>\n\n<p>You specify the name of the sheet and the row/columb-number that you want to find the last cell with information, and it return the number of it. </p>\n\n<p>(In the example the last row in first column, and last column in first row are find)</p>\n\n<p>lastCol will give you an Long as an asnwer. If you want to convert this number into the column letter you can use the next function</p>\n\n<pre><code>Function Col_Letter(lngCol As Long) As String\n    Dim vArr\n    vArr = Split(Cells(1, lngCol).Address(True, False), \"$\")\n    Col_Letter = vArr(0)\nEnd Function\n</code></pre>\n\n<p>I hope you find this useful</p>\n"}, {"tags": [], "owner": {"reputation": 5709, "user_id": 640694, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/a15bc522697439dbdf2e58e4d98ee22b?s=128&d=identicon&r=PG", "display_name": "Passiday", "link": "https://stackoverflow.com/users/640694/passiday"}, "is_accepted": true, "score": 0, "last_activity_date": 1480519466, "creation_date": 1480519466, "answer_id": 40892066, "question_id": 40887109, "link": "https://stackoverflow.com/questions/40887109/excel-vba-range-for-all-relevant-cells/40892066#40892066", "title": "Excel VBA Range for all relevant cells", "body": "<p>Thanks to user Rosetta, I've come up with this expression for the sought range:</p>\n\n<pre><code>ws.Range(\"A1:\" &amp; ws.Cells.SpecialCells(xlLastCell).Address)\n</code></pre>\n"}], "owner": {"reputation": 5709, "user_id": 640694, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/a15bc522697439dbdf2e58e4d98ee22b?s=128&d=identicon&r=PG", "display_name": "Passiday", "link": "https://stackoverflow.com/users/640694/passiday"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1300, "favorite_count": 0, "accepted_answer_id": 40892066, "answer_count": 2, "score": 0, "last_activity_date": 1480519466, "creation_date": 1480505025, "last_edit_date": 1480506530, "question_id": 40887109, "link": "https://stackoverflow.com/questions/40887109/excel-vba-range-for-all-relevant-cells", "title": "Excel VBA Range for all relevant cells", "body": "<p>My macro creates a large text file by writing all the data from all sheets in the active workbook.</p>\n\n<p>In each worksheet, it is necessary to determine a certain rectangular range of cells that would be saved in the text file. It's upper left corner would always be A1, but the lower right corner should be chosen so that the range includes all cells with any content (formatting does not matter).</p>\n\n<p>I thought ws.Range(\"A1\").CurrentRegion would do the trick, but it does not work when A1 and the nearby cells are empty. If the only cell with data in the sheet is Q10, then the range should be A1:Q10.</p>\n\n<p>Of course, I could loop over the ws.Cells range to discover the range of interest, but that's quite time consuming, I hope there's more effective way. If I select all cells in a sheet and do a copy-paste to notepad, I do not end up with hundreds of empty columns and thousands of empty rows, only the relevant data are copied. The question is how to replicate that with VBA. </p>\n\n<p>This is my code so far:</p>\n\n<pre><code>Sub CreateTxt()\n    'This macro copies the contents from all sheets in one text file\n    'Each sheet contents are prefixed by the sheet name in square brackets\n    Dim pth As String\n    Dim fs As Object\n    Dim rng As Range\n\n    pth = ThisWorkbook.Path\n\n    Set fs = CreateObject(\"Scripting.FileSystemObject\")\n    Dim outputFile As Object\n    Set outputFile = fs.CreateTextFile(pth &amp; \"\\Output.txt\", True)\n\n    Dim WS_Count As Integer\n    Dim ws As Worksheet\n    Dim I As Integer\n\n    WS_Count = ActiveWorkbook.Worksheets.Count\n\n    For I = 1 To WS_Count\n        Set ws = ActiveWorkbook.Worksheets(I)\n        outputFile.WriteLine (\"[\" &amp; ws.Name &amp; \"]\")\n        Debug.Print ws.Name\n        Set rng = ws.Range(\"A1\").CurrentRegion\n        outputFile.WriteLine (GetTextFromRangeText(rng, vbTab, vbCrLf))\n    Next I\n\n    outputFile.Close\nEnd Sub\n\nFunction GetTextFromRangeText(ByVal poRange As Range, colSeparator As String, rowSeparator As String) As String\n    Dim vRange As Variant\n    Dim sRow As String\n    Dim sRet As String\n    Dim I As Integer\n    Dim j As Integer\n\n    If Not poRange Is Nothing Then\n\n        vRange = poRange\n\n        Debug.Print TypeName(vRange)\n        For I = LBound(vRange) To UBound(vRange)\n            sRow = \"\"\n            For j = LBound(vRange, 2) To UBound(vRange, 2)\n                If j &gt; LBound(vRange, 2) Then\n                    sRow = sRow &amp; colSeparator\n                End If\n                sRow = sRow &amp; vRange(I, j)\n            Next j\n            If sRet &lt;&gt; \"\" Then\n                sRet = sRet &amp; rowSeparator\n            End If\n            sRet = sRet &amp; sRow\n        Next I\n    End If\n\n    GetTextFromRangeText = sRet\nEnd Function\n</code></pre>\n\n<p>if there is anything in A1:B2 cells, this macro works. It breaks when the A1:B2 is empty and the CurrentRegion property returns Empty.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1480505943, "post_id": 40886963, "comment_id": 68988589, "body": "I don&#39;t understand, what and where are your drop-down lost ? you have a drop-down in cell &quot;J16&quot; in every sheet ?"}, {"owner": {"reputation": 73, "user_id": 7204188, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/c1155f06a3bb6966aedb791ce2cab6cd?s=128&d=identicon&r=PG&f=1", "display_name": "ayyappan km", "link": "https://stackoverflow.com/users/7204188/ayyappan-km"}, "reply_to_user": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1480568952, "post_id": 40886963, "comment_id": 69019217, "body": "yes i have drop down list in cell j16 in each sheet"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1480570428, "post_id": 40886963, "comment_id": 69019731, "body": "what is the source or value that these dron down should have?"}, {"owner": {"reputation": 73, "user_id": 7204188, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/c1155f06a3bb6966aedb791ce2cab6cd?s=128&d=identicon&r=PG&f=1", "display_name": "ayyappan km", "link": "https://stackoverflow.com/users/7204188/ayyappan-km"}, "reply_to_user": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1480570974, "post_id": 40886963, "comment_id": 69019922, "body": "Source is in E1 to E10,"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1480571085, "post_id": 40886963, "comment_id": 69019963, "body": "I am not sure what needs to be done here ??? are these drop-downs already defined in each sheet ? if they are why do you need to update them by code ?"}, {"owner": {"reputation": 73, "user_id": 7204188, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/c1155f06a3bb6966aedb791ce2cab6cd?s=128&d=identicon&r=PG&f=1", "display_name": "ayyappan km", "link": "https://stackoverflow.com/users/7204188/ayyappan-km"}, "reply_to_user": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1480571284, "post_id": 40886963, "comment_id": 69020033, "body": "This code should select names one by one and update in each sheet- cell J16, actualy i have 40 names and 40 worksheet, instead of selecting manually i am asking through codes. In drop down list 40 names available that one by one to be updated from active sheet to last sheet. please help"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1480571692, "post_id": 40886963, "comment_id": 69020193, "body": "sorry, but I didn&#39;t understand anything. I realy don&#39;t understand the concept and logics of what you are trying to achieve. You need to edit your post here, and explain better what you are trying to do."}, {"owner": {"reputation": 73, "user_id": 7204188, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/c1155f06a3bb6966aedb791ce2cab6cd?s=128&d=identicon&r=PG&f=1", "display_name": "ayyappan km", "link": "https://stackoverflow.com/users/7204188/ayyappan-km"}, "reply_to_user": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1480572093, "post_id": 40886963, "comment_id": 69020349, "body": "Sir, i need to input company name in Cell J16 for 40 Worksheet. I have the list of companies in some other rows, so i have made drop down list in cell j16, currently i will select the names in each sheet through drop down list for 40 worksheets. instead of doing this manually i am asking to do by code. the data which was selected through in drop down list is also my worksheet name, that i will change through the above code. So i am combining this 2 process."}], "answers": [{"comments": [{"owner": {"reputation": 73, "user_id": 7204188, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/c1155f06a3bb6966aedb791ce2cab6cd?s=128&d=identicon&r=PG&f=1", "display_name": "ayyappan km", "link": "https://stackoverflow.com/users/7204188/ayyappan-km"}, "edited": false, "score": 0, "creation_date": 1480577644, "post_id": 40903923, "comment_id": 69022632, "body": "Thanks for your help, its working fine, but i need to update the companies names in 40 worksheet, (Name will be different), instead of putting Test1, how do i select from drop down list like drop down name 1, drop down name 2..........."}], "tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": false, "score": 0, "last_activity_date": 1480573539, "creation_date": 1480573539, "answer_id": 40903923, "question_id": 40886963, "link": "https://stackoverflow.com/questions/40886963/rename-worksheet-with-dropdown-list/40903923#40903923", "title": "Rename Worksheet with Dropdown list", "body": "<p>The code below will lopp through all <code>ws</code> sheets, and modifies the value of cell in \"J16\" to \"Test 1\" (just for testing purposes).</p>\n\n<pre><code>Option Explicit\n\n\nSub ModifyDropDownValue()\n\nDim ws As Worksheet\n\nFor Each ws In Worksheets\n    With ws\n        ' modify the value in cell J16\n        .Range(\"J16\").Value = \"Test 1\"\n    End With\nNext ws\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 73, "user_id": 7204188, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/c1155f06a3bb6966aedb791ce2cab6cd?s=128&d=identicon&r=PG&f=1", "display_name": "ayyappan km", "link": "https://stackoverflow.com/users/7204188/ayyappan-km"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 513, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1480573539, "creation_date": 1480504592, "last_edit_date": 1531164843, "question_id": 40886963, "link": "https://stackoverflow.com/questions/40886963/rename-worksheet-with-dropdown-list", "title": "Rename Worksheet with Dropdown list", "body": "<p>I am using the below code to rename worksheet. </p>\n\n<pre><code>Option Explicit\n\nSub RenWSs()\n\n    Dim ws As Worksheet\n    Dim shtName\n    Dim newName As String\n    Dim i As Integer\n    Dim RngStr  As String\n\n    RngStr = Application.InputBox(prompt:=\"Select the Range for the new Sheet's name\", Type:=2)\n    For Each ws In Worksheets\n        With ws\n            If Trim(.Range(RngStr)) &lt;&gt; \"\" Then\n                shtName = Split(Trim(.Range(RngStr)), \" \")\n                newName = shtName(0)\n                On Error GoTo ws_name_error\n                .Name = .Range(RngStr)\n                GoTo done\nrepeat:\n                .Name = newName &amp; i\n                GoTo done\nws_name_error:\n                i = i + 1\n                Resume repeat\n            End If\n        End With\n        On Error GoTo 0\ndone:\n    Next\n\nEnd Sub\n</code></pre>\n\n<p>In this i am selecting the new name through Input Box and its working fine. Now what i want is, before calling the input box, the below process has to be done.</p>\n\n<p>I have names in drop down list, each names in drop down list to be updated one by one in all worksheets like J16 is the cell.</p>\n\n<p>Please help me </p>\n"}, {"tags": ["vba", "excel", "if-statement"], "comments": [{"owner": {"reputation": 1162, "user_id": 6893386, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d02aee16378d73f403c3d0ab868a4f4e?s=128&d=identicon&r=PG&f=1", "display_name": "bobajob", "link": "https://stackoverflow.com/users/6893386/bobajob"}, "edited": false, "score": 0, "creation_date": 1480503418, "post_id": 40886140, "comment_id": 68986998, "body": "The edited version won&#39;t work. Your original version will. Better yet, get rid of the comparison between <code>Category</code> and <code>&quot;&quot;</code> entirely in Option 1 - comparing <code>Category</code> to the user input is sufficient here."}, {"owner": {"reputation": 731, "user_id": 7170188, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/710cf6e1876c352c31e53fe5a4986993?s=128&d=identicon&r=PG&f=1", "display_name": "franciscofcosta", "link": "https://stackoverflow.com/users/7170188/franciscofcosta"}, "reply_to_user": {"reputation": 1162, "user_id": 6893386, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d02aee16378d73f403c3d0ab868a4f4e?s=128&d=identicon&r=PG&f=1", "display_name": "bobajob", "link": "https://stackoverflow.com/users/6893386/bobajob"}, "edited": false, "score": 0, "creation_date": 1480503746, "post_id": 40886140, "comment_id": 68987226, "body": "Thank you for your help! I have done that and the end result is the same. Option 1 is still triggered regardless of the user input."}], "answers": [{"tags": [], "owner": {"reputation": 305, "user_id": 6317652, "user_type": "registered", "profile_image": "https://graph.facebook.com/1036004296437081/picture?type=large", "display_name": "PedroMVM", "link": "https://stackoverflow.com/users/6317652/pedromvm"}, "is_accepted": false, "score": 1, "last_activity_date": 1480504409, "creation_date": 1480504409, "answer_id": 40886902, "question_id": 40886140, "link": "https://stackoverflow.com/questions/40886140/if-statement-vba/40886902#40886902", "title": "If Statement VBA", "body": "<p>I think you should divide your code in three separated subroutines:\n - The first will run when a user triggers the search, then it must check if <code>country</code> has a valid value (giving error message if not) and then check if <code>Category</code> has a value, going to a second subroutine if it has value or going to a third subroutine if it is empty;\n - The second subroutine must get the value of both <code>country</code> and <code>Category</code> variables and return the expected result;\n - The third subroutine must get only <code>country</code> variable and return the expected result.</p>\n\n<p>You can put both variables in the beginning of module (before any <code>Sub</code> and using <code>Private</code> instead of <code>Dim</code>) to leave them accessible to any subroutine in that module or you can create subroutines with parameters, where you can pass values to another <code>Sub</code> without making them accessible to all <code>Sub</code>s in that module. I prefer the second alternative. In case you don't know how to pass parameters to another module, it is an example:</p>\n\n<pre><code>Sub QueryCountryAndCategory (QCountry as String, QCategory as String)\n</code></pre>\n\n<p>In this <code>Sub</code>, <code>QCountry</code> and <code>QCategory</code> are variables that will be accessible only in that module and it will receive values passed by caller subroutine, something like this (using your variables):</p>\n\n<pre><code>QueryCountryAndCategory(country, Category)\n</code></pre>\n\n<p>Or like this:</p>\n\n<pre><code>QueryCountryAndCategory(QCountry:=country, QCategory:=Category)\n</code></pre>\n\n<p>Remember that long codes are hard to maintain and hard to test. When your code becomes long, always consider dividing it in some <code>Sub</code>s or <code>Function</code>s (which will return a value). It's also easier to test, as you can run each Sub alone to see if it is working properly.</p>\n"}, {"tags": [], "owner": {"reputation": 1162, "user_id": 6893386, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d02aee16378d73f403c3d0ab868a4f4e?s=128&d=identicon&r=PG&f=1", "display_name": "bobajob", "link": "https://stackoverflow.com/users/6893386/bobajob"}, "is_accepted": true, "score": 1, "last_activity_date": 1480504894, "creation_date": 1480504894, "answer_id": 40887061, "question_id": 40886140, "link": "https://stackoverflow.com/questions/40886140/if-statement-vba/40887061#40887061", "title": "If Statement VBA", "body": "<p>The problem is that your code will go to Option 1 if any line fails to meet the criteria, whereas we want it to only fail if every line fails to meet the criteria. We therefore need to do two scans of the data, the first to check if there are any passing lines (if not then we offer to clear the Category), and then another to copy the relevant data.</p>\n\n<p>Try this:</p>\n\n<pre><code>Option Explicit\n\nPrivate Sub CommandButton1_Click()\n\n    Dim country As String 'Search query country, user-inputted\n    Dim Category As String 'Search query category user-inputted\n    Dim finalrow As Integer\n    Dim i As Integer 'row counter\n    Dim ws As Worksheet\n    Dim foundMatch As Boolean\n    foundMatch = False\n\n    Set ws = Sheets(\"Database\")\n\n    country = Sheets(\"Results\").Range(\"D5\").Value\n    Category = Sheets(\"Results\").Range(\"D6\").Value\n    finalrow = Sheets(\"Database\").Range(\"A200000\").End(xlUp).Row\n\n    For i = 2 To finalrow\n        If Sheets(\"Database\").Cells(i, 1) = country And _\n            (Sheets(\"Database\").Cells(i, 3) = Category Or Category = \"\") Then\n                foundMatch = True\n        End If\n    Next i\n\n    If Not foundMatch Then\n        Dim question As Integer\n        question = MsgBox(\"Unfortunately, the Database has no sources regarding \" &amp; Category &amp; \" in \" &amp; country &amp; \". Would you perhaps want to broaden your search and see all sources regarding \" &amp; country &amp; \"?\", vbYesNo + vbQuestion, \"Empty Sheet\")\n           If question = vbYes Then\n                Sheets(\"Results\").Range(\"D6\").ClearContents\n                Category = Sheets(\"Results\").Range(\"D6\").Value\n            Else\n                Sheets(\"Results\").Range(\"D5\").ClearContents\n                Sheets(\"Results\").Range(\"D6\").ClearContents\n                Me.Hide\n                WelcomeForm.Show\n                Exit Sub\n            End If\n    End If\n\n    For i = 2 To finalrow\n        If Sheets(\"Database\").Cells(i, 1) = country And _\n            (Sheets(\"Database\").Cells(i, 3) = Category Or Category = \"\") Then\n                'Copy the headers of the \"Database\" sheet\n                With Sheets(\"Database\")\n                    .Range(\"A1:I1\").Copy\n                End With\n                Sheets(\"Results\").Range(\"B10:J10\").PasteSpecial\n\n                'Copy the rows of the table that match the search query\n                With Sheets(\"Database\")\n                    .Range(.Cells(i, 1), .Cells(i, 9)).Copy\n                End With\n                Sheets(\"Results\").Range(\"B20000\").End(xlUp).Offset(1, 0).PasteSpecial xlPasteFormulasAndNumberFormats\n        End If\n    Next i\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 770, "user_id": 7086396, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-yLANabdeAgw/AAAAAAAAAAI/AAAAAAAAAQ4/eCyC7wOMQlU/photo.jpg?sz=128", "display_name": "Moacir", "link": "https://stackoverflow.com/users/7086396/moacir"}, "is_accepted": false, "score": 0, "last_activity_date": 1480505467, "creation_date": 1480505467, "answer_id": 40887261, "question_id": 40886140, "link": "https://stackoverflow.com/questions/40886140/if-statement-vba/40887261#40887261", "title": "If Statement VBA", "body": "<p>On        <code>(Category &lt;&gt; \"\" Or Sheets(\"Database\").Cells(i, 3) &lt;&gt; Category) Then</code> replace the <code>OR</code> for an <code>AND</code></p>\n\n<p>That check must consider both</p>\n\n<ol>\n<li>The <code>category</code> is not empty AND</li>\n<li>The <code>category</code> was not found</li>\n</ol>\n\n<p>The way the IF is working is that it will always trigger if either</p>\n\n<ol>\n<li>The <code>category</code> isnt empty (So, if you type anything in the <code>category</code> it will match here)</li>\n<li>The <code>category</code> doesnt match (If the <code>category</code> is empty but it actually has anything on the list)</li>\n</ol>\n"}], "owner": {"reputation": 731, "user_id": 7170188, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/710cf6e1876c352c31e53fe5a4986993?s=128&d=identicon&r=PG&f=1", "display_name": "franciscofcosta", "link": "https://stackoverflow.com/users/7170188/franciscofcosta"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 233, "favorite_count": 0, "accepted_answer_id": 40887061, "answer_count": 3, "score": 0, "last_activity_date": 1480505467, "creation_date": 1480502255, "last_edit_date": 1480502768, "question_id": 40886140, "link": "https://stackoverflow.com/questions/40886140/if-statement-vba", "title": "If Statement VBA", "body": "<p>I am writing a script in Excel VBA with an <code>If</code> and an <code>ElseIf</code> statements for a database search. The search is conducted through a <code>UserForm</code> that has two fields, labelled as <code>Country</code> and <code>Category</code> and defined in the script as follows:</p>\n\n<pre><code>Dim country As String\nDim Category As String\ncountry = Sheets(\"Results\").Range(\"D5\").Value\nCategory = Sheets(\"Results\").Range(\"D6\").Value\n</code></pre>\n\n<p>The information is searched and presented in respect of the country searched and, as such, the minimum required for a search to run is the <code>Country</code> being provided by the user with a country that is in the database.</p>\n\n<p>Taking the user-inputted criteria, the search runs through a table of data in a sheet called <code>Database</code> and pastes the results in another sheet called <code>Results</code>. Depending on the search criteria, the script will run several options prescribed by an <code>If</code> statement.</p>\n\n<p><strong>OPTION 1</strong> - The user has provided a country and a category and:</p>\n\n<ul>\n<li>The <code>country</code> exists in the database but;</li>\n<li>The <code>Category</code> does not exist for the specific country.</li>\n</ul>\n\n<p>In this case a <code>MsgBox</code> will pop up with saying that the specific combination of country and category provided by the user does not exist in the database. The message will ask the user if it would like to run a search just for all entries of the country provided, in this case. I have written the respective code as follows:</p>\n\n<pre><code>finalrow = Sheets(\"Database\").Range(\"A200000\").End(xlUp).Row\n\nFor i = 2 To finalrow\n\n    If Sheets(\"Database\").Cells(i, 1) = country And _\n        (Category &lt;&gt; \"\" Or Sheets(\"Database\").Cells(i, 3) &lt;&gt; Category) Then\n                Dim question As Integer\n                question = MsgBox(\"Unfortunately, the Database has no sources regarding \" &amp; Category &amp; \" in \" &amp; country &amp; \". Would you perhaps want to broaden your search and see all sources regarding \" &amp; country &amp; \"?\", vbYesNo + vbQuestion, \"Empty Sheet\")\n                   If question = vbYes Then\n                        Sheets(\"Results\").Range(\"D6\").ClearContents\n                        Category = Sheets(\"Results\").Range(\"D6\").Value\n                        boolRestart = True\n                    Else\n                        Sheets(\"Results\").Range(\"D5\").ClearContents\n                        Sheets(\"Results\").Range(\"D6\").ClearContents\n                        Me.Hide\n                        WelcomeForm.Show\n                        Exit Sub\n                    End If\n</code></pre>\n\n<p><strong>OPTION 2</strong> - The user has provided a <code>country</code> and:</p>\n\n<ul>\n<li>The <code>country</code> exists in the database and;</li>\n<li>The user has also provided a <code>Category</code> that exists in the database for the specific country or;</li>\n<li>The user has left the <code>Category</code> field empty.</li>\n</ul>\n\n<p>In this case, the search will run. This is written in the script as follows:</p>\n\n<pre><code>ElseIf Sheets(\"Database\").Cells(i, 1) = country And _\n        (Sheets(\"Database\").Cells(i, 3) = Category Or Category = \"\") Then\n\n        'Copy the headers of the \"Database\" sheet\n        With Sheets(\"Database\")\n            .Range(\"A1:I1\").Copy\n        End With\n        Sheets(\"Results\").Range(\"B10:J10\").PasteSpecial\n\n        'Copy the rows of the table that match the search query\n        With Sheets(\"Database\")\n            .Range(.Cells(i, 1), .Cells(i, 9)).Copy\n        End With\n        Sheets(\"Results\").Range(\"B20000\").End(xlUp).Offset(1, 0).PasteSpecial xlPasteFormulasAndNumberFormats\n\n    End If\n</code></pre>\n\n<p>I have tried to write the script in several different ways but the search engine keeps on not working as I want to. What is happening now is that when I input a <code>Country</code> that I know to be in the database, regardless of inputting a <code>Category</code> as well or not, <strong>OPTION 1</strong> is always triggered. I have tried to take out <strong>OPTION 1</strong> altogether and run just an <code>If</code> statement with <strong>OPTION 2</strong> as is and the search runs fine with <code>Country</code> filled in and with both <code>Country</code> and <code>Category</code> filled in. However, as soon as <strong>OPTION 1</strong> in in the code, this is always the option ran, regardless of what is inputted by the user.</p>\n\n<p>The full code is here , for your reference:</p>\n\n<pre><code>Dim country As String 'Search query country, user-inputted\nDim Category As String 'Search query category user-inputted\nDim finalrow As Integer\nDim i As Integer 'row counter\nDim ws As Worksheet\n\nSet ws = Sheets(\"Database\")\n\ncountry = Sheets(\"Results\").Range(\"D5\").Value\nCategory = Sheets(\"Results\").Range(\"D6\").Value\nfinalrow = Sheets(\"Database\").Range(\"A200000\").End(xlUp).Row\n\nFor i = 2 To finalrow\n\n    If Sheets(\"Database\").Cells(i, 1) = country And _\n        (Category &lt;&gt; \"\" Or Sheets(\"Database\").Cells(i, 3) &lt;&gt; Category) Then\n                Dim question As Integer\n                question = MsgBox(\"Unfortunately, the Database has no sources regarding \" &amp; Category &amp; \" in \" &amp; country &amp; \". Would you perhaps want to broaden your search and see all sources regarding \" &amp; country &amp; \"?\", vbYesNo + vbQuestion, \"Empty Sheet\")\n                   If question = vbYes Then\n                        Sheets(\"Results\").Range(\"D6\").ClearContents\n                        Category = Sheets(\"Results\").Range(\"D6\").Value\n                        boolRestart = True\n                    Else\n                        Sheets(\"Results\").Range(\"D5\").ClearContents\n                        Sheets(\"Results\").Range(\"D6\").ClearContents\n                        Me.Hide\n                        WelcomeForm.Show\n                        Exit Sub\n                    End If\n\n    ElseIf Sheets(\"Database\").Cells(i, 1) = country And _\n        (Sheets(\"Database\").Cells(i, 3) = Category Or Category = \"\") Then\n\n        'Copy the headers of the \"Database\" sheet\n        With Sheets(\"Database\")\n            .Range(\"A1:I1\").Copy\n        End With\n        Sheets(\"Results\").Range(\"B10:J10\").PasteSpecial\n\n        'Copy the rows of the table that match the search query\n        With Sheets(\"Database\")\n            .Range(.Cells(i, 1), .Cells(i, 9)).Copy\n        End With\n        Sheets(\"Results\").Range(\"B20000\").End(xlUp).Offset(1, 0).PasteSpecial xlPasteFormulasAndNumberFormats\n\n    End If\n\nNext I\n</code></pre>\n\n<p>Thank you very much for your help.</p>\n"}, {"tags": ["ms-access", "split", "vba"], "comments": [{"owner": {"reputation": 1155, "user_id": 3990112, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/lbvKP.png?s=128&g=1", "display_name": "Maharshi", "link": "https://stackoverflow.com/users/3990112/maharshi"}, "edited": false, "score": 0, "creation_date": 1480503253, "post_id": 40886110, "comment_id": 68986884, "body": "Add some code when you post a question. or state your query which you have used so far."}, {"owner": {"reputation": 1684, "user_id": 5936117, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/KO8Gd.jpg?s=128&g=1", "display_name": "MoondogsMaDawg", "link": "https://stackoverflow.com/users/5936117/moondogsmadawg"}, "edited": false, "score": 0, "creation_date": 1480513649, "post_id": 40886110, "comment_id": 68993608, "body": "<a href=\"https://msdn.microsoft.com/en-us/library/8460tsh1(v=vs.90).aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/8460tsh1(v=vs.90).aspx</a>"}], "answers": [{"tags": [], "owner": {"reputation": 305, "user_id": 6435422, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ebd2c80f456dc3596617b2d8505f70b?s=128&d=identicon&r=PG&f=1", "display_name": "Lybren", "link": "https://stackoverflow.com/users/6435422/lybren"}, "is_accepted": false, "score": 1, "last_activity_date": 1480517285, "creation_date": 1480517285, "answer_id": 40891305, "question_id": 40886110, "link": "https://stackoverflow.com/questions/40886110/split-strings-from-table-by-space-into-separate-columns/40891305#40891305", "title": "Split strings from table by space into separate columns", "body": "<p>Had a similar case recently.<br>\nTo be able to run split in query design create a function in a standard module to be able to call it from the expression builder.  </p>\n\n<pre><code>Public Function ESplit(Pstring As String, PSeparator As String, PIndex As Integer) As String\n    '************************************\n    'Use Split in Expression Builder\n    'PString - String containing source to be separated\n    'PSeparator - String containing delimitator\n    'PIndex - Element of the source to be returned, starts at 0\n    '************************************\n    ESplit = Split(Pstring, PSeparator)(PIndex)\nEnd Function\n</code></pre>\n\n<p>Then assign columns that you want to have the words with expressions calling this function.</p>\n\n<p>Source<br>\nD1 na 256km sm\u011br B\u0159eclav.  </p>\n\n<p>Expr1: ESplit(Source,\" \",0)<br>\nThis will yield D1</p>\n"}], "owner": {"reputation": 1, "user_id": 7230274, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5ad62057b3f06d71899e48af32e4f9f?s=128&d=identicon&r=PG&f=1", "display_name": "Jan Mare\u0161", "link": "https://stackoverflow.com/users/7230274/jan-mare%c5%a1"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 921, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1480517285, "creation_date": 1480502166, "last_edit_date": 1480503814, "question_id": 40886110, "link": "https://stackoverflow.com/questions/40886110/split-strings-from-table-by-space-into-separate-columns", "title": "Split strings from table by space into separate columns", "body": "<p>I process tables in MS ACCESS 2016 and I have one column in a table which is text (string) like this example: D1 na 256km sm\u011br B\u0159eclav. </p>\n\n<p>I need to split that text into separate columns for every word so I can prepare data to delete some words and so on. I have already tried some examples in VBA for Access but it didn't work.</p>\n\n<p>I need to Split them. Does anybody know how? The Split function doesn't work in an SQL query, and I don't know how to properly do it in VBA. </p>\n"}, {"tags": ["excel", "vba", "parameters", "directory", "7zip"], "answers": [{"comments": [{"owner": {"reputation": 76, "user_id": 7132406, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-e3JX76SHxZg/AAAAAAAAAAI/AAAAAAAAIaM/gZ6LTkMMZ3M/photo.jpg?sz=128", "display_name": "Tilan04", "link": "https://stackoverflow.com/users/7132406/tilan04"}, "edited": false, "score": 0, "creation_date": 1480503824, "post_id": 40886382, "comment_id": 68987273, "body": "Thanks for the info. But the subroutine has the same behavior with the missing space."}, {"owner": {"reputation": 76, "user_id": 7132406, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-e3JX76SHxZg/AAAAAAAAAAI/AAAAAAAAIaM/gZ6LTkMMZ3M/photo.jpg?sz=128", "display_name": "Tilan04", "link": "https://stackoverflow.com/users/7132406/tilan04"}, "edited": false, "score": 0, "creation_date": 1480509055, "post_id": 40886382, "comment_id": 68990513, "body": "Is this &quot;c:\\program files\\7-zip\\7z.exe&quot; a -tzip &quot;H:\\folder.7z&quot; &quot;H:\\folder&quot; -m0=lzma2 -mx=9 -aoa"}], "tags": [], "owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "is_accepted": false, "score": 0, "last_activity_date": 1480502950, "creation_date": 1480502950, "answer_id": 40886382, "question_id": 40885650, "link": "https://stackoverflow.com/questions/40885650/vba-incorrect-parameter-using-7z-with-command/40886382#40886382", "title": "VBA Incorrect parameter using 7z with command", "body": "<p>A space is missing in your command line after the source:</p>\n\n<pre><code>strCommand = z7Path &amp; \" a -tzip \" &amp; Chr(34) &amp; ThisWorkbook.Path &amp; \"\\\" &amp; fnDestination &amp; Chr(34) &amp; \" \" &amp; source &amp; \" -m0=lzma2 -mx=9 -aoa\"\n</code></pre>\n"}], "owner": {"reputation": 76, "user_id": 7132406, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-e3JX76SHxZg/AAAAAAAAAAI/AAAAAAAAIaM/gZ6LTkMMZ3M/photo.jpg?sz=128", "display_name": "Tilan04", "link": "https://stackoverflow.com/users/7132406/tilan04"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 264, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1480502950, "creation_date": 1480500908, "question_id": 40885650, "link": "https://stackoverflow.com/questions/40885650/vba-incorrect-parameter-using-7z-with-command", "title": "VBA Incorrect parameter using 7z with command", "body": "<p>I want to compress a folder with 7z using a macro but when I add the parameters to the command line the program show me an error with them (it's in Spanish but I suppose that the correct translation is \"Incorrect parameter\").</p>\n\n<blockquote>\n  <p>System error: El par\u00e1metro no es correcto.</p>\n</blockquote>\n\n<p>There is the subroutine:</p>\n\n<pre><code>Sub ZipDLEFolder()\n\nDim strCommand As String\nDim z7Path As String\nDim fnDestination As String\nDim source As String\n\nz7Path = ThisWorkbook.Sheets(\"Sheet2\").Range(\"J5\")\nfnDestination = ThisWorkbook.Sheets(\"Sheet2\").Range(\"J6\")\nsource = Chr(34) &amp; ThisWorkbook.Path &amp; \"\\\" &amp; ThisWorkbook.Sheets(\"Sheet2\").Range(\"D6\") &amp; Chr(34)\nstrCommand = z7Path &amp; \" a -tzip \" &amp; Chr(34) &amp; ThisWorkbook.Path &amp; \"\\\" &amp; fnDestination &amp; Chr(34) &amp; \" \" &amp; source &amp; \"-m0=lzma2 -mx=9 -aoa\"\n\nThisWorkbook.Sheets(\"Sheet2\").Range(\"J23\") = strCommand\nShell strCommand, 1\n</code></pre>\n\n<p>The parameters are important to make the smallest version of the file for using it in an email. In the previous version I used a .bat file and works fine with this:</p>\n\n<pre><code>@ECHO OFF\nREM Set variable\nset \"destiny=%~dp0folder.7z\"\nset \"source=%~dp0\\folder\"\n\nRem compress the file\nc:\\program files\\7-zip\\7z.exe a -t7z %destiny% %source% -m0=lzma2 -mx=9 -aoa\n\nexit\n</code></pre>\n"}, {"tags": ["vba", "excel", "excel-2010"], "comments": [{"owner": {"reputation": 634, "user_id": 6671476, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c4a11114810d210447b9dc60467e815?s=128&d=identicon&r=PG&f=1", "display_name": "RCaetano", "link": "https://stackoverflow.com/users/6671476/rcaetano"}, "edited": false, "score": 0, "creation_date": 1480500977, "post_id": 40885626, "comment_id": 68985292, "body": "Maybe you should check <a href=\"https://msdn.microsoft.com/en-us/library/office/ff196215.aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/office/ff196215.aspx</a> :) You just need to create the <code>Private Sub Workbook_Open()</code> and add the code as you need. The code should be inserted in ThisWorkbook <a href=\"http://www.contextures.com/images/vba02.gif\" rel=\"nofollow noreferrer\">contextures.com/images/vba02.gif</a>"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 1, "creation_date": 1480501412, "post_id": 40885626, "comment_id": 68985594, "body": "@Wolfie84367   take a look here, answer similar to your post <a href=\"http://stackoverflow.com/questions/40803543/excel-vba-add-beforedoubleclick-event-handler-to-dynamically-created-worksheets/40810859#40810859\" title=\"excel vba add beforedoubleclick event handler to dynamically created worksheets\">stackoverflow.com/questions/40803543/&hellip;</a>"}, {"owner": {"reputation": 102, "user_id": 6350601, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/qRneh.jpg?s=128&g=1", "display_name": "Wolfie84367", "link": "https://stackoverflow.com/users/6350601/wolfie84367"}, "reply_to_user": {"reputation": 634, "user_id": 6671476, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c4a11114810d210447b9dc60467e815?s=128&d=identicon&r=PG&f=1", "display_name": "RCaetano", "link": "https://stackoverflow.com/users/6671476/rcaetano"}, "edited": false, "score": 0, "creation_date": 1480504087, "post_id": 40885626, "comment_id": 68987425, "body": "@RCaetano I appreciate the reply. However I think you failed to understand the question. As you can see from the attached code extract I am not a novice/new to VB script."}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1480505260, "post_id": 40885626, "comment_id": 68988185, "body": "Adding code to an existing module, or importing a <code>bas</code> file?  A <code>bas</code> file can be imported on the <code>Workbook_Open</code> event using <code>ThisWorkbook.VBProject.VBComponents.Import (FullPathString)</code>, remembering to set the option for trusting access to the VBA project."}, {"owner": {"reputation": 634, "user_id": 6671476, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c4a11114810d210447b9dc60467e815?s=128&d=identicon&r=PG&f=1", "display_name": "RCaetano", "link": "https://stackoverflow.com/users/6671476/rcaetano"}, "reply_to_user": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 1, "creation_date": 1480505389, "post_id": 40885626, "comment_id": 68988282, "body": "Sorry, my bad :/ You can check <a href=\"http://www.cpearson.com/Excel/vbe.aspx\" rel=\"nofollow noreferrer\">cpearson.com/Excel/vbe.aspx</a> for a full detailed explanation and examples or even better: just look at @ShaiRado link ;)"}], "owner": {"reputation": 102, "user_id": 6350601, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/qRneh.jpg?s=128&g=1", "display_name": "Wolfie84367", "link": "https://stackoverflow.com/users/6350601/wolfie84367"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 69, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1480500846, "creation_date": 1480500846, "last_edit_date": 1531164843, "question_id": 40885626, "link": "https://stackoverflow.com/questions/40885626/adding-vba-code-when-opening-a-workbook", "title": "Adding VBA Code when opening a workbook", "body": "<p>I have an excel VB module that I want to add to a newly opened workbook.</p>\n\n<p>I have the following code in a static excel workbook to open a variable workbook based on filename.</p>\n\n<pre><code>   Sub OpenYest_File()\n\nDim FilePath As String, Rng As Range, FName As String, Ext As String, wb As Workbook, FileDate As String\n\nYDate = Date - 1\nFileDate = Format(YDate, \"yyyymmdd\")\n\nMsgBox FileDate\n'set variables\nFilePath = \"J:\\Prepay\\Pay Go Appt &amp; GE Site\\Data Analyst\\Data Analyst Use\\Raw Info\\Gas Meter Exchanges\\\"\nExt = \"*\" &amp; FileDate &amp; \".tsv\"\nFName = Dir(FilePath &amp; Ext)\n'Set Rng = Sheets(\"Raw Data\").Range(\"A1\").End(xlDown)\n\nDo While FName &lt;&gt; \"\"\n    Set wb = Workbooks.Open(Filename:=FilePath &amp; FName, Local:=True)\n    FName = Dir\nLoop\n\nEnd Sub\n</code></pre>\n\n<p>I also have another module that I have written but want to add this to the newly opened excel workbook.</p>\n\n<p>Is there any way to insert VB code to a workbook on open?</p>\n\n<p>Your help is appreciated.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 11381, "user_id": 2859347, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/00bC9.png?s=128&g=1", "display_name": "CallumDA", "link": "https://stackoverflow.com/users/2859347/callumda"}, "edited": false, "score": 0, "creation_date": 1480500815, "post_id": 40885169, "comment_id": 68985163, "body": "broadly speaking you want to access the worksheet as few times as possible. So if you could pull in your data (all 30k lines) once and then output to the new worksheet once it would be very quick"}], "answers": [{"tags": [], "owner": {"reputation": 11381, "user_id": 2859347, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/00bC9.png?s=128&g=1", "display_name": "CallumDA", "link": "https://stackoverflow.com/users/2859347/callumda"}, "is_accepted": false, "score": 1, "last_activity_date": 1480502791, "last_edit_date": 1480502791, "creation_date": 1480501459, "answer_id": 40885865, "question_id": 40885169, "link": "https://stackoverflow.com/questions/40885169/excel-vba-taking-long-time-to-copy-date-from-one-workbook-to-another/40885865#40885865", "title": "Excel VBA taking long time to copy date from one workbook to another", "body": "<p>You can use the following code as an example for how to perform this kind of task by only accessing the worksheet twice. Generally, I try to avoid copy and paste in VBA but this should speed things up nicely</p>\n\n<pre><code>Sub Test()\n    x.Sheets(\"New Report\").Range(\"A:A,C:C,E:E\").Copy\n    y.Sheets(\"Unmached\").Range(\"A1\").PasteSpecial xlPasteAll\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 11381, "user_id": 2859347, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/00bC9.png?s=128&g=1", "display_name": "CallumDA", "link": "https://stackoverflow.com/users/2859347/callumda"}, "edited": false, "score": 0, "creation_date": 1480504450, "post_id": 40886835, "comment_id": 68987669, "body": "Given that your ranges aren&#39;t correct this is pretty much a duplicate of the answer I already provided"}, {"owner": {"reputation": 294, "user_id": 5518412, "user_type": "registered", "profile_image": "https://graph.facebook.com/900413473399114/picture?type=large", "display_name": "Praveen Behera", "link": "https://stackoverflow.com/users/5518412/praveen-behera"}, "reply_to_user": {"reputation": 11381, "user_id": 2859347, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/00bC9.png?s=128&g=1", "display_name": "CallumDA", "link": "https://stackoverflow.com/users/2859347/callumda"}, "edited": false, "score": 0, "creation_date": 1480505831, "post_id": 40886835, "comment_id": 68988530, "body": "this is my own answer. Rest, let the asker decide the ranges. @Yousuva Raja, Please check the ranges, check if required."}, {"owner": {"reputation": 160, "user_id": 7229645, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BSOXb.jpg?s=128&g=1", "display_name": "Kelvin", "link": "https://stackoverflow.com/users/7229645/kelvin"}, "edited": false, "score": 0, "creation_date": 1480512889, "post_id": 40886835, "comment_id": 68993077, "body": "Hi Callum and Praveen, thanks for your suggestion. After Q column everything gets messed up and the ranges are pasting in different columns. But this is much faster than what i had. Thanks again for your support:)"}], "tags": [], "owner": {"reputation": 294, "user_id": 5518412, "user_type": "registered", "profile_image": "https://graph.facebook.com/900413473399114/picture?type=large", "display_name": "Praveen Behera", "link": "https://stackoverflow.com/users/5518412/praveen-behera"}, "is_accepted": false, "score": 0, "last_activity_date": 1480505555, "last_edit_date": 1480505555, "creation_date": 1480504209, "answer_id": 40886835, "question_id": 40885169, "link": "https://stackoverflow.com/questions/40885169/excel-vba-taking-long-time-to-copy-date-from-one-workbook-to-another/40886835#40886835", "title": "Excel VBA taking long time to copy date from one workbook to another", "body": "<p>This is the code as per your requirement. This will not take more than 5-10 SECONDS</p>\n\n<p>Change the sheet name and workbook name as required and do one thing, check if ranges are accurate. hope you got the idea let me know if you still face issues -</p>\n\n<pre><code>Application.ScreenUpdating = False\n\nDim ws1, ws2 As Workbook\n\nSet ws1 = ThisWorkbook\nSet ws2 = Workbooks.Open(\"E:\\Praveen Behera files\\book2.xlsx\")\n\n'l is lastrow\n l = ws1.sheets(\"Sheet1\").range(\"A500000\").end(xlup).row\n\nws1.Sheets(\"Sheet1\").Range(\"\" &amp; \"C2:C\" &amp; l &amp; \",G2:G\" &amp; l &amp; \",I2:I\" &amp; l &amp; \",L2:L\" &amp; l &amp; \",M2:M\" &amp; l &amp; \",O2:O\" &amp; l &amp; \",Q2:Q\" &amp; l &amp; \",S2:S\" &amp; l &amp; \",T2:T\" &amp; l &amp; \",U2:U\" &amp; l &amp; \",V2:V\" &amp; l &amp; \",W2:W\" &amp; l &amp; \",X2:X\" &amp; l &amp; \",Z2:Z\" &amp; l &amp; \",AA2:AA\" &amp; l &amp; \",AC2:AC\" &amp; l &amp; \",AD2:AD\" &amp; l &amp; \",AE2:AE\" &amp; l &amp; \",AG2:AG\" &amp; l &amp; \",AH2:AH\" &amp; l &amp; \",AJ2:AJ\" &amp; l &amp; \",AO2:AO\" &amp; l &amp; \",AP2:AP\" &amp; l &amp; \",AR2:AR\" &amp; l &amp; \",AU2:AU\" &amp; l &amp; \",AW2:AW\" &amp; l &amp; \",AX2:AX\" &amp; l &amp; \",AY2:AY\" &amp; l &amp; \",BB2:BB\" &amp; l &amp; \",BC2:BC\" &amp; l &amp; \",BD2:BD\" &amp; l &amp; \"\").Copy Destination:=ws2.Sheets(\"Sheet1\").Range(\"A2\")\n\nws1.Sheets(\"Sheet1\").Range(\"\" &amp; \"BE2:BE\" &amp; l &amp; \",BF2:BF\" &amp; l &amp; \",BH2:BH\" &amp; l &amp; \",BI2:BI\" &amp; l &amp; \",BJ2:BJ\" &amp; l &amp; \",BK2:BK\" &amp; l &amp; \",BL2:BL\" &amp; l &amp; \",BM2:BM\" &amp; l &amp; \"\").Copy Destination:=ws2.Sheets(\"Sheet1\").Range(\"AF2\")\n\nApplication.ScreenUpdating = True\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 160, "user_id": 7229645, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BSOXb.jpg?s=128&g=1", "display_name": "Kelvin", "link": "https://stackoverflow.com/users/7229645/kelvin"}, "edited": false, "score": 0, "creation_date": 1480512740, "post_id": 40886875, "comment_id": 68992990, "body": "Hi Jean thanks for your edited code. I dont have any know on arraypos. I guess your Array contains a wrong line---  x.Sheets(&quot;New Rep2-1ort&quot;).Range(&quot;A1&quot;).Offset(i, 33).Value, _  So it throws me a out of script error."}, {"owner": {"reputation": 2531, "user_id": 5309373, "user_type": "registered", "accept_rate": 94, "profile_image": "https://lh3.googleusercontent.com/-k6yHporwn6o/AAAAAAAAAAI/AAAAAAAAADQ/1NNWYFs6DwA/photo.jpg?sz=128", "display_name": "Jean-Pierre Oosthuizen", "link": "https://stackoverflow.com/users/5309373/jean-pierre-oosthuizen"}, "reply_to_user": {"reputation": 160, "user_id": 7229645, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BSOXb.jpg?s=128&g=1", "display_name": "Kelvin", "link": "https://stackoverflow.com/users/7229645/kelvin"}, "edited": false, "score": 0, "creation_date": 1480581724, "post_id": 40886875, "comment_id": 69024606, "body": "@YousuvaRaja Not sure where that line came from, I though it was from your code, but I have corrected to come from <code>x.Sheets(&quot;New Report&quot;).Range(&quot;A1&quot;).Offset(i, 33).Value</code> Please check it again. Also I am not sure what you mean <i>I dont have any know on arraypos</i> <code>ArrayPos</code> is just a variable I declared to use to extract data from the <code>DaraArray</code>"}, {"owner": {"reputation": 160, "user_id": 7229645, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BSOXb.jpg?s=128&g=1", "display_name": "Kelvin", "link": "https://stackoverflow.com/users/7229645/kelvin"}, "edited": false, "score": 0, "creation_date": 1480772261, "post_id": 40886875, "comment_id": 69106586, "body": "Thanks Jean it worked and just taking less than a 2 minutes :)"}, {"owner": {"reputation": 2531, "user_id": 5309373, "user_type": "registered", "accept_rate": 94, "profile_image": "https://lh3.googleusercontent.com/-k6yHporwn6o/AAAAAAAAAAI/AAAAAAAAADQ/1NNWYFs6DwA/photo.jpg?sz=128", "display_name": "Jean-Pierre Oosthuizen", "link": "https://stackoverflow.com/users/5309373/jean-pierre-oosthuizen"}, "reply_to_user": {"reputation": 160, "user_id": 7229645, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BSOXb.jpg?s=128&g=1", "display_name": "Kelvin", "link": "https://stackoverflow.com/users/7229645/kelvin"}, "edited": false, "score": 0, "creation_date": 1481089415, "post_id": 40886875, "comment_id": 69228185, "body": "@YousuvaRaja I am happy that it works, remember to up vote and mark the correct answer to your question."}, {"owner": {"reputation": 160, "user_id": 7229645, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BSOXb.jpg?s=128&g=1", "display_name": "Kelvin", "link": "https://stackoverflow.com/users/7229645/kelvin"}, "edited": false, "score": 0, "creation_date": 1481182512, "post_id": 40886875, "comment_id": 69275469, "body": "Hi Jean am new to this site and I dont know where to up vote.. can you please help me?"}, {"owner": {"reputation": 2531, "user_id": 5309373, "user_type": "registered", "accept_rate": 94, "profile_image": "https://lh3.googleusercontent.com/-k6yHporwn6o/AAAAAAAAAAI/AAAAAAAAADQ/1NNWYFs6DwA/photo.jpg?sz=128", "display_name": "Jean-Pierre Oosthuizen", "link": "https://stackoverflow.com/users/5309373/jean-pierre-oosthuizen"}, "reply_to_user": {"reputation": 160, "user_id": 7229645, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BSOXb.jpg?s=128&g=1", "display_name": "Kelvin", "link": "https://stackoverflow.com/users/7229645/kelvin"}, "edited": false, "score": 0, "creation_date": 1481196824, "post_id": 40886875, "comment_id": 69284156, "body": "@YousuvaRaja there are Up and Down arrows to the left of the top of the answer, you do it there."}], "tags": [], "owner": {"reputation": 2531, "user_id": 5309373, "user_type": "registered", "accept_rate": 94, "profile_image": "https://lh3.googleusercontent.com/-k6yHporwn6o/AAAAAAAAAAI/AAAAAAAAADQ/1NNWYFs6DwA/photo.jpg?sz=128", "display_name": "Jean-Pierre Oosthuizen", "link": "https://stackoverflow.com/users/5309373/jean-pierre-oosthuizen"}, "is_accepted": true, "score": 1, "last_activity_date": 1480581566, "last_edit_date": 1480581566, "creation_date": 1480504325, "answer_id": 40886875, "question_id": 40885169, "link": "https://stackoverflow.com/questions/40885169/excel-vba-taking-long-time-to-copy-date-from-one-workbook-to-another/40886875#40886875", "title": "Excel VBA taking long time to copy date from one workbook to another", "body": "<p>I tested this with 55k lines of just numbers and it took roughly 45s. </p>\n\n<p>I just inputted the original data into an array and the looped through the array to put the data back into the new sheet.</p>\n\n<p>You will need to confirm if I have captured the correct cells etc.</p>\n\n<pre><code>Option Explicit\n\nSub alignment()\n\n    Dim x As Workbook\n    Dim y As Workbook\n\n    Set x = Workbooks.Open(\"C:\\Users\\raja\\Desktop\\New Report.xls\")\n    Set y = Workbooks.Open(\"C:\\Users\\raja\\Desktop\\ACQ047.xlsx\")\n\n\n    y.Sheets(\"unmached\").Range(\"A2\").Activate\n    y.Sheets(\"unmached\").Rows(ActiveCell.Row &amp; \":\" &amp; Rows.Count).Delete Shift:=xlUp\n    x.Sheets(\"New Report\").Rows(1).EntireRow.Delete\n    x.Sheets(\"New Report\").Range(\"A1\").EntireRow.Insert\n\n    Dim Lastrow As Long\n    Lastrow = x.Sheets(\"New Report\").Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n\n    Application.ScreenUpdating = False '!!!!\n    Application.Calculation = xlCalculationManual '!!!!\n\n    Dim DataArray As Variant\n    ReDim DataArray(39)\n\n    For i = 1 To Lastrow\n\n        With x.Sheets(\"New Report\").Range(\"A1\")\n\n            DataArray = Array(.Offset(i, 2).Value, .Offset(i, 6).Value, .Offset(i, 8).Value, _\n                              .Offset(i, 11).Value, .Offset(i, 12).Value, .Offset(i, 14).Value, _\n                              .Offset(i, 16).Value, .Offset(i, 18).Value, .Offset(i, 19).Value, _\n                              .Offset(i, 20).Value, .Offset(i, 21).Value, .Offset(i, 22).Value, _\n                              .Offset(i, 23).Value, .Offset(i, 25).Value, .Offset(i, 26).Value, _\n                              .Offset(i, 28).Value, .Offset(i, 30).Value, .Offset(i, 32).Value, _\n                              .Offset(i, 33).Value, .Offset(i, 35).Value, .Offset(i, 40).Value, _\n                              .Offset(i, 41).Value, .Offset(i, 49).Value, .Offset(i, 50).Value, _\n                              .Offset(i, 46).Value, .Offset(i, 48).Value, .Offset(i, 43).Value, _\n                              .Offset(i, 29).Value, .Offset(i, 53).Value, .Offset(i, 54).Value, _\n                              .Offset(i, 55).Value, .Offset(i, 56).Value, .Offset(i, 57).Value, _\n                              .Offset(i, 59).Value, .Offset(i, 60).Value, .Offset(i, 61).Value, _\n                              .Offset(i, 62).Value, .Offset(i, 63).Value, .Offset(i, 64).Value)\n\n        End With\n\n        With y.Sheets(\"Unmached\").Range(\"A1048576\").End(xlUp)\n\n           Dim ArrayPos As Long\n\n            For ArrayPos = 0 To 38\n               .Offset(1, 38 - ArrayPos).Value = DataArray(39 - ArrayPos)\n            Next ArrayPos\n\n        End With\n\n    Next i\n\n    Application.Calculation = xlCalculationAutomatic '!!!!\n    Application.ScreenUpdating = True '!!!\n\n    y.Sheets(\"unmached\").Range(\"A1\").Select\n\n    ActiveWorkbook.Close SaveChanges:=True\n\n    x.Sheets(\"New Report\").Range(\"A1\").Select\n\n    ActiveWorkbook.Close SaveChanges:=False\n\n    MsgBox \" Report Generated\"\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 160, "user_id": 7229645, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BSOXb.jpg?s=128&g=1", "display_name": "Kelvin", "link": "https://stackoverflow.com/users/7229645/kelvin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 293, "favorite_count": 0, "accepted_answer_id": 40886875, "answer_count": 3, "score": 2, "last_activity_date": 1480581566, "creation_date": 1480499652, "question_id": 40885169, "link": "https://stackoverflow.com/questions/40885169/excel-vba-taking-long-time-to-copy-date-from-one-workbook-to-another", "title": "Excel VBA taking long time to copy date from one workbook to another", "body": "<p>I am trying to copy data from one excel to another using VBA. But its taking more than 15 mins for 30K lines. Is there a way I could make it faster?</p>\n\n<p>I need to align 39 columns from New Report workbook to ACQ047 WB.</p>\n\n<p>Below is my code:</p>\n\n<pre><code>Sub alignment()\n\nDim x As Workbook\nDim y As Workbook\n\nSet x = Workbooks.Open(\"C:\\Users\\raja\\Desktop\\New Report.xls\")\nSet y = Workbooks.Open(\"C:\\Users\\raja\\Desktop\\ACQ047.xlsx\")\n\nDim Lastrow As Long\n\n\ny.Sheets(\"unmached\").Range(\"A2\").Activate\ny.Sheets(\"unmached\").Rows(ActiveCell.Row &amp; \":\" &amp; Rows.Count).Delete Shift:=xlUp\n\n\n\n\nx.Sheets(\"New Report\").Rows(1).EntireRow.Delete\nx.Sheets(\"New Report\").Range(\"A1\").EntireRow.Insert\nLastrow = x.Sheets(\"New Report\").Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n\nApplication.ScreenUpdating = False '!!!!\nApplication.Calculation = xlCalculationManual '!!!!\n\nFor i = 1 To Lastrow\nCopyVal = x.Sheets(\"New Report\").Range(\"A1\").Offset(i, 2).Value\nCopyVal2 = x.Sheets(\"New Report\").Range(\"A1\").Offset(i, 6).Value\nCopyVal3 = x.Sheets(\"New Report\").Range(\"A1\").Offset(i, 8).Value\nCopyVal4 = x.Sheets(\"New Report\").Range(\"A1\").Offset(i, 11).Value\nCopyVal5 = x.Sheets(\"New Report\").Range(\"A1\").Offset(i, 12).Value\nCopyVal6 = x.Sheets(\"New Report\").Range(\"A1\").Offset(i, 14).Value\nCopyVal7 = x.Sheets(\"New Report\").Range(\"A1\").Offset(i, 16).Value\nCopyVal8 = x.Sheets(\"New Report\").Range(\"A1\").Offset(i, 18).Value\nCopyVal9 = x.Sheets(\"New Report\").Range(\"A1\").Offset(i, 19).Value\nCopyVal10 = x.Sheets(\"New Report\").Range(\"A1\").Offset(i, 20).Value\nCopyVal11 = x.Sheets(\"New Report\").Range(\"A1\").Offset(i, 21).Value\nCopyVal12 = x.Sheets(\"New Report\").Range(\"A1\").Offset(i, 22).Value\nCopyVal13 = x.Sheets(\"New Report\").Range(\"A1\").Offset(i, 23).Value\nCopyVal14 = x.Sheets(\"New Report\").Range(\"A1\").Offset(i, 25).Value\nCopyVal15 = x.Sheets(\"New Report\").Range(\"A1\").Offset(i, 26).Value\nCopyVal16 = x.Sheets(\"New Report\").Range(\"A1\").Offset(i, 28).Value\nCopyVal17 = x.Sheets(\"New Report\").Range(\"A1\").Offset(i, 30).Value\nCopyVal18 = x.Sheets(\"New Report\").Range(\"A1\").Offset(i, 32).Value\nCopyVal19 = x.Sheets(\"New Report\").Range(\"A1\").Offset(i, 33).Value\nCopyVal20 = x.Sheets(\"New Report\").Range(\"A1\").Offset(i, 35).Value\nCopyVal21 = x.Sheets(\"New Report\").Range(\"A1\").Offset(i, 40).Value\nCopyVal22 = x.Sheets(\"New Report\").Range(\"A1\").Offset(i, 41).Value\nCopyVal23 = x.Sheets(\"New Report\").Range(\"A1\").Offset(i, 49).Value\nCopyVal24 = x.Sheets(\"New Report\").Range(\"A1\").Offset(i, 50).Value\nCopyVal25 = x.Sheets(\"New Report\").Range(\"A1\").Offset(i, 46).Value\nCopyVal26 = x.Sheets(\"New Report\").Range(\"A1\").Offset(i, 48).Value\nCopyVal27 = x.Sheets(\"New Report\").Range(\"A1\").Offset(i, 43).Value\nCopyVal28 = x.Sheets(\"New Report\").Range(\"A1\").Offset(i, 29).Value\nCopyVal29 = x.Sheets(\"New Report\").Range(\"A1\").Offset(i, 53).Value\nCopyVal30 = x.Sheets(\"New Report\").Range(\"A1\").Offset(i, 54).Value\nCopyVal31 = x.Sheets(\"New Report\").Range(\"A1\").Offset(i, 55).Value\nCopyVal32 = x.Sheets(\"New Report\").Range(\"A1\").Offset(i, 56).Value\nCopyVal33 = x.Sheets(\"New Report\").Range(\"A1\").Offset(i, 57).Value\nCopyVal34 = x.Sheets(\"New Report\").Range(\"A1\").Offset(i, 59).Value\nCopyVal35 = x.Sheets(\"New Report\").Range(\"A1\").Offset(i, 60).Value\nCopyVal36 = x.Sheets(\"New Report\").Range(\"A1\").Offset(i, 61).Value\nCopyVal37 = x.Sheets(\"New Report\").Range(\"A1\").Offset(i, 62).Value\nCopyVal38 = x.Sheets(\"New Report\").Range(\"A1\").Offset(i, 63).Value\nCopyVal39 = x.Sheets(\"New Report\").Range(\"A1\").Offset(i, 64).Value\n\n\n\n  y.Sheets(\"Unmached\").Range(\"A1048576\").End(xlUp).Offset(1, 38).Value = CopyVal39\n  y.Sheets(\"Unmached\").Range(\"A1048576\").End(xlUp).Offset(1, 37).Value = CopyVal38\n  y.Sheets(\"Unmached\").Range(\"A1048576\").End(xlUp).Offset(1, 36).Value = CopyVal37\n  y.Sheets(\"Unmached\").Range(\"A1048576\").End(xlUp).Offset(1, 35).Value = CopyVal36\n  y.Sheets(\"Unmached\").Range(\"A1048576\").End(xlUp).Offset(1, 34).Value = CopyVal35\n  y.Sheets(\"Unmached\").Range(\"A1048576\").End(xlUp).Offset(1, 33).Value = CopyVal34\n  y.Sheets(\"Unmached\").Range(\"A1048576\").End(xlUp).Offset(1, 32).Value = CopyVal33\n  y.Sheets(\"Unmached\").Range(\"A1048576\").End(xlUp).Offset(1, 31).Value = CopyVal32\n  y.Sheets(\"Unmached\").Range(\"A1048576\").End(xlUp).Offset(1, 30).Value = CopyVal31\n  y.Sheets(\"Unmached\").Range(\"A1048576\").End(xlUp).Offset(1, 29).Value = CopyVal30\n  y.Sheets(\"Unmached\").Range(\"A1048576\").End(xlUp).Offset(1, 28).Value = CopyVal29\n  y.Sheets(\"Unmached\").Range(\"A1048576\").End(xlUp).Offset(1, 27).Value = CopyVal28\n  y.Sheets(\"Unmached\").Range(\"A1048576\").End(xlUp).Offset(1, 26).Value = CopyVal27\n  y.Sheets(\"Unmached\").Range(\"A1048576\").End(xlUp).Offset(1, 25).Value = CopyVal26\n  y.Sheets(\"Unmached\").Range(\"A1048576\").End(xlUp).Offset(1, 24).Value = CopyVal25\n  y.Sheets(\"Unmached\").Range(\"A1048576\").End(xlUp).Offset(1, 23).Value = CopyVal24\n  y.Sheets(\"Unmached\").Range(\"A1048576\").End(xlUp).Offset(1, 22).Value = CopyVal23\ny.Sheets(\"Unmached\").Range(\"A1048576\").End(xlUp).Offset(1, 21).Value = CopyVal22\ny.Sheets(\"Unmached\").Range(\"A1048576\").End(xlUp).Offset(1, 20).Value = CopyVal21\ny.Sheets(\"Unmached\").Range(\"A1048576\").End(xlUp).Offset(1, 19).Value = CopyVal20\ny.Sheets(\"Unmached\").Range(\"A1048576\").End(xlUp).Offset(1, 18).Value = CopyVal19\ny.Sheets(\"Unmached\").Range(\"A1048576\").End(xlUp).Offset(1, 17).Value = CopyVal18\ny.Sheets(\"Unmached\").Range(\"A1048576\").End(xlUp).Offset(1, 16).Value = CopyVal17\ny.Sheets(\"Unmached\").Range(\"A1048576\").End(xlUp).Offset(1, 15).Value = CopyVal16\ny.Sheets(\"Unmached\").Range(\"A1048576\").End(xlUp).Offset(1, 14).Value = CopyVal15\ny.Sheets(\"Unmached\").Range(\"A1048576\").End(xlUp).Offset(1, 13).Value = CopyVal14\ny.Sheets(\"Unmached\").Range(\"A1048576\").End(xlUp).Offset(1, 12).Value = CopyVal13\ny.Sheets(\"Unmached\").Range(\"A1048576\").End(xlUp).Offset(1, 11).Value = CopyVal12\ny.Sheets(\"Unmached\").Range(\"A1048576\").End(xlUp).Offset(1, 10).Value = CopyVal11\ny.Sheets(\"Unmached\").Range(\"A1048576\").End(xlUp).Offset(1, 9).Value = CopyVal10\ny.Sheets(\"Unmached\").Range(\"A1048576\").End(xlUp).Offset(1, 8).Value = CopyVal9\ny.Sheets(\"Unmached\").Range(\"A1048576\").End(xlUp).Offset(1, 7).Value = CopyVal8\ny.Sheets(\"Unmached\").Range(\"A1048576\").End(xlUp).Offset(1, 6).Value = CopyVal7\ny.Sheets(\"Unmached\").Range(\"A1048576\").End(xlUp).Offset(1, 5).Value = CopyVal6\ny.Sheets(\"Unmached\").Range(\"A1048576\").End(xlUp).Offset(1, 4).Value = CopyVal5\ny.Sheets(\"Unmached\").Range(\"A1048576\").End(xlUp).Offset(1, 3).Value = CopyVal4\ny.Sheets(\"Unmached\").Range(\"A1048576\").End(xlUp).Offset(1, 2).Value = CopyVal3\ny.Sheets(\"Unmached\").Range(\"A1048576\").End(xlUp).Offset(1, 1).Value = CopyVal2\ny.Sheets(\"Unmached\").Range(\"A1048576\").End(xlUp).Offset(1, 0).Value = CopyVal\n\nNext\n\n\nApplication.Calculation = xlCalculationAutomatic '!!!!\nApplication.ScreenUpdating = True '!!!\n\ny.Sheets(\"unmached\").Range(\"A1\").Select\n\nActiveWorkbook.Close SaveChanges:=True\n\nx.Sheets(\"New Report\").Range(\"A1\").Select\n\nActiveWorkbook.Close SaveChanges:=False\n\nMsgBox \" Report Generated\"\n\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "date"], "comments": [{"owner": {"reputation": 505, "user_id": 6204844, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pK6Ih.jpg?s=128&g=1", "display_name": "Clusks", "link": "https://stackoverflow.com/users/6204844/clusks"}, "edited": false, "score": 0, "creation_date": 1480499827, "post_id": 40885002, "comment_id": 68984447, "body": "Hi, Michael S, are you able to show us what you&#39;ve tried so far in VBA or what exactly you&#39;re having a problem with?"}, {"owner": {"reputation": 2531, "user_id": 5309373, "user_type": "registered", "accept_rate": 94, "profile_image": "https://lh3.googleusercontent.com/-k6yHporwn6o/AAAAAAAAAAI/AAAAAAAAADQ/1NNWYFs6DwA/photo.jpg?sz=128", "display_name": "Jean-Pierre Oosthuizen", "link": "https://stackoverflow.com/users/5309373/jean-pierre-oosthuizen"}, "edited": false, "score": 0, "creation_date": 1480500394, "post_id": 40885002, "comment_id": 68984869, "body": "Why not just use filters. Highlight the first row and then in the Excel Data tab select filter"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 7229312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9a8635d78e01af576b21d0cdc7f6fe1?s=128&d=identicon&r=PG&f=1", "display_name": "Michael S", "link": "https://stackoverflow.com/users/7229312/michael-s"}, "edited": false, "score": 0, "creation_date": 1480586456, "post_id": 40886698, "comment_id": 69027555, "body": "Thanks so much! I&#39;ll try this out first thing in the morning. Best wishes."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user7168530"}, "is_accepted": false, "score": 0, "last_activity_date": 1480503829, "creation_date": 1480503829, "answer_id": 40886698, "question_id": 40885002, "link": "https://stackoverflow.com/questions/40885002/expanding-date-ranges-with-associated-data-with-vba/40886698#40886698", "title": "Expanding date ranges with associated data with VBA", "body": "<p>Try this. Should work for your example...</p>\n\n<pre><code>Sub Dates()\n\nDim LastRow As Long\nDim RowIns As Integer\n\nLastRow = ActiveSheet.Cells(Rows.Count, 1).End(xlUp).Row\n\nFor i = 2 To LastRow\n\nCont:\n\n    If Cells(i, 1).Value = \"\" Then\n\n        GoTo Cont2\n\n    End If\n\n    RowIns = Cells(i, 4).Value - Cells(i, 3).Value\n\n    If RowIns &lt;= 0 Then\n\n        i = i + 1\n\n        GoTo Cont\n\n    End If\n\n    Rows(i + 1 &amp; \":\" &amp; RowIns + i).Insert Shift:=xlDown\n\n    Range(\"C\" &amp; i).Select\n    Selection.AutoFill Destination:=Range(\"C\" &amp; i &amp; \":C\" &amp; RowIns + i), Type:=xlFillDefault\n\n    Range(\"A\" &amp; i &amp; \":B\" &amp; i).Select\n    Selection.AutoFill Destination:=Range(\"A\" &amp; i &amp; \":B\" &amp; RowIns + i), Type:=xlFillCopy\n\n    LastRow = ActiveSheet.Cells(Rows.Count, 1).End(xlUp).Row\n\n    i = i + RowIns + 1\n\n    GoTo Cont\n\nNext\n\nCont2:\n\nColumns(4).EntireColumn.Delete\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 7229312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9a8635d78e01af576b21d0cdc7f6fe1?s=128&d=identicon&r=PG&f=1", "display_name": "Michael S", "link": "https://stackoverflow.com/users/7229312/michael-s"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 55, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1480503829, "creation_date": 1480499193, "last_edit_date": 1480502601, "question_id": 40885002, "link": "https://stackoverflow.com/questions/40885002/expanding-date-ranges-with-associated-data-with-vba", "title": "Expanding date ranges with associated data with VBA", "body": "<p>I have a huge amount of data that I need to process to allow for a data analysis. \nCurrently, the data is in <a href=\"https://i.stack.imgur.com/DNiIV.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/DNiIV.png\" alt=\"this form\"></a>, and my goal is to use VBA to produce <a href=\"https://i.stack.imgur.com/jLPZb.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/jLPZb.png\" alt=\"this\"></a>.  </p>\n\n<p>Any ideas?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 7168, "user_id": 6842716, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cxds5.png?s=128&g=1", "display_name": "JohnG", "link": "https://stackoverflow.com/users/6842716/johng"}, "edited": false, "score": 0, "creation_date": 1480499498, "post_id": 40884835, "comment_id": 68984230, "body": "You should view <a href=\"http://stackoverflow.com/help/mcve\">How to create a Minimal, Complete, and Verifiable example</a>  It is not clear what you are asking."}, {"owner": {"reputation": 11381, "user_id": 2859347, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/00bC9.png?s=128&g=1", "display_name": "CallumDA", "link": "https://stackoverflow.com/users/2859347/callumda"}, "edited": false, "score": 1, "creation_date": 1480499611, "post_id": 40884835, "comment_id": 68984307, "body": "<code>AVERAGEIFS()</code> didn&#39;t work?"}, {"owner": {"reputation": 1, "user_id": 7229763, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/496666c69eaf02e4337698f2879b0263?s=128&d=identicon&r=PG&f=1", "display_name": "ArmBro", "link": "https://stackoverflow.com/users/7229763/armbro"}, "edited": false, "score": 0, "creation_date": 1480520839, "post_id": 40884835, "comment_id": 68998907, "body": "they do, but I would need to change the average if conditions for a ton of worksheets (I think 50+) and I would like to build on the vba to subsequently plot data and do a couple other tasks. Also, if I can have a working VBA, I can leave it to my successors for their theses!"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 7229763, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/496666c69eaf02e4337698f2879b0263?s=128&d=identicon&r=PG&f=1", "display_name": "ArmBro", "link": "https://stackoverflow.com/users/7229763/armbro"}, "edited": false, "score": 0, "creation_date": 1480545585, "post_id": 40899300, "comment_id": 69012890, "body": "true, i hadnt thought of that one! I&#39;ll have to learn how to plot data from pivot tables, but Im sure I can do that! Any pointers on that one?"}, {"owner": {"reputation": 54, "user_id": 5112104, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f806327b373260b8da3b4a5ea2b517c2?s=128&d=identicon&r=PG", "display_name": "ChipperG", "link": "https://stackoverflow.com/users/5112104/chipperg"}, "reply_to_user": {"reputation": 1, "user_id": 7229763, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/496666c69eaf02e4337698f2879b0263?s=128&d=identicon&r=PG&f=1", "display_name": "ArmBro", "link": "https://stackoverflow.com/users/7229763/armbro"}, "edited": false, "score": 0, "creation_date": 1480598955, "post_id": 40899300, "comment_id": 69035918, "body": "If you create and select a PivotTable it will give you the ability to create a PivotChart based off that data.  You can find the option in the Ribbon at the top."}], "tags": [], "owner": {"reputation": 54, "user_id": 5112104, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f806327b373260b8da3b4a5ea2b517c2?s=128&d=identicon&r=PG", "display_name": "ChipperG", "link": "https://stackoverflow.com/users/5112104/chipperg"}, "is_accepted": false, "score": 0, "last_activity_date": 1480544383, "creation_date": 1480544383, "answer_id": 40899300, "question_id": 40884835, "link": "https://stackoverflow.com/questions/40884835/i-would-like-to-take-averages-of-values-in-a-column-depending-on-values-in-the-c/40899300#40899300", "title": "I would like to take averages of values in a column depending on values in the cells of another column", "body": "<p>It is not a VBA solution, but I believe a PivotTable can create the averages you are looking for.</p>\n\n<p><a href=\"https://i.stack.imgur.com/8frD8.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/8frD8.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 1, "user_id": 7229763, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/496666c69eaf02e4337698f2879b0263?s=128&d=identicon&r=PG&f=1", "display_name": "ArmBro", "link": "https://stackoverflow.com/users/7229763/armbro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 43, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1480544383, "creation_date": 1480498778, "last_edit_date": 1531161705, "question_id": 40884835, "link": "https://stackoverflow.com/questions/40884835/i-would-like-to-take-averages-of-values-in-a-column-depending-on-values-in-the-c", "title": "I would like to take averages of values in a column depending on values in the cells of another column", "body": "<p>I have large amounts of data relating to an experiment I am performing in a stepwise manner. I would like to take the averages of each step however they are all in the same column so cannot simply take the average of a whole column. Fortunately the data logger I am using can log statuses in another column for each data point. </p>\n\n<p>I was thinking a vba would be able to discern each step from the others by reading the statuses which correspond to each data point (and I can have different statuses for each step: ie Step 1; Step 2; Step 3 etc), then calculate the average and output it in a specific cell. </p>\n\n<p><a href=\"https://i.stack.imgur.com/qjhpW.jpg\" rel=\"nofollow noreferrer\">this is a simplified version of the type of worksheet I will be looking for</a></p>\n\n<p>I have tried all the average functions in excel itself and I don't think they are suited to what I want them to do. Therefore I assume that I will  have to use either for or if loops in an excel macro, which is fine, but I'm quite new to programming and in particular VBAs and I just don't know where to start!</p>\n"}, {"tags": ["vba", "excel", "excel-2010"], "answers": [{"comments": [{"owner": {"reputation": 4621, "user_id": 4709298, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/fe41ea7cc395df33b3ad744599248d80?s=128&d=identicon&r=PG&f=1", "display_name": "Preston", "link": "https://stackoverflow.com/users/4709298/preston"}, "edited": false, "score": 0, "creation_date": 1480504445, "post_id": 40884985, "comment_id": 68987667, "body": "@Claude G, please respond here, your response below isn&#39;t an answer, so should be in the comments with the relevant question.  Cheers"}, {"owner": {"reputation": 33, "user_id": 2928759, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/12ddf086b8b346c3aa5b3ca2d8b09b2c?s=128&d=identicon&r=PG&f=1", "display_name": "Claude G", "link": "https://stackoverflow.com/users/2928759/claude-g"}, "edited": false, "score": 0, "creation_date": 1480508584, "post_id": 40884985, "comment_id": 68990213, "body": "In parts yes, but if I do it this way, the whole chart is moved and for example the lines are no more adjusted to the initial size, so I want to adjust the origins of my lines in the graph so that everything fits again with the other graphs."}, {"owner": {"reputation": 4621, "user_id": 4709298, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/fe41ea7cc395df33b3ad744599248d80?s=128&d=identicon&r=PG&f=1", "display_name": "Preston", "link": "https://stackoverflow.com/users/4709298/preston"}, "reply_to_user": {"reputation": 33, "user_id": 2928759, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/12ddf086b8b346c3aa5b3ca2d8b09b2c?s=128&d=identicon&r=PG&f=1", "display_name": "Claude G", "link": "https://stackoverflow.com/users/2928759/claude-g"}, "edited": false, "score": 0, "creation_date": 1480510891, "post_id": 40884985, "comment_id": 68991690, "body": "I&#39;m sorry I don&#39;t understand, you want to change the data series or the axis?  Can you post the code you have so I can update that?"}, {"owner": {"reputation": 33, "user_id": 2928759, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/12ddf086b8b346c3aa5b3ca2d8b09b2c?s=128&d=identicon&r=PG&f=1", "display_name": "Claude G", "link": "https://stackoverflow.com/users/2928759/claude-g"}, "edited": false, "score": 0, "creation_date": 1480514145, "post_id": 40884985, "comment_id": 68993983, "body": "Let say it in this way, I get several graphs, and by some of them, after I have updated the data series, the origin is no longer in the middle of the graph but lays on the left side and I want to push it back in the middle"}, {"owner": {"reputation": 4621, "user_id": 4709298, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/fe41ea7cc395df33b3ad744599248d80?s=128&d=identicon&r=PG&f=1", "display_name": "Preston", "link": "https://stackoverflow.com/users/4709298/preston"}, "reply_to_user": {"reputation": 33, "user_id": 2928759, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/12ddf086b8b346c3aa5b3ca2d8b09b2c?s=128&d=identicon&r=PG&f=1", "display_name": "Claude G", "link": "https://stackoverflow.com/users/2928759/claude-g"}, "edited": false, "score": 0, "creation_date": 1480515163, "post_id": 40884985, "comment_id": 68994729, "body": "@ClaudeG, I get you.  Try the final snippet in my answer, it will allow you to set the axis as you wish based on values in A1, A2"}], "tags": [], "owner": {"reputation": 4621, "user_id": 4709298, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/fe41ea7cc395df33b3ad744599248d80?s=128&d=identicon&r=PG&f=1", "display_name": "Preston", "link": "https://stackoverflow.com/users/4709298/preston"}, "is_accepted": false, "score": 0, "last_activity_date": 1480515088, "last_edit_date": 1480515088, "creation_date": 1480499151, "answer_id": 40884985, "question_id": 40884792, "link": "https://stackoverflow.com/questions/40884792/reset-the-origin-of-a-graph-with-vba/40884985#40884985", "title": "reset the origin of a graph with VBA", "body": "<p>When inserting a new chart:</p>\n\n<pre><code>Set myChart = ActiveSheet.Shapes.AddChart(xlLine, 500, 200).Chart\n</code></pre>\n\n<p>When adjusting an old chart:</p>\n\n<pre><code>'Set myChart = Sheets(1).\nWith myChart\n     .Top = 50\n     .Left = 50\nEnd With\n</code></pre>\n\n<p>To Name the Series:</p>\n\n<pre><code>.SeriesCollection(1).Name = Range(\"B\" &amp; lngStartRow - 1).Value\n.SeriesCollection(2).Name = Range(\"C\" &amp; lngStartRow - 1).Value\n</code></pre>\n\n<p>To change the series data itself:</p>\n\n<pre><code>set CHARTDATA = range(\"A1:A2\").values\nmyChart.Chart.SetSourceData Source:=CHARTDATA\n</code></pre>\n\n<p>To change the x-axis on which the dataseries are placed, try this, dependant on the values in A1 and A2:</p>\n\n<pre><code>With myChart.Chart.Axes(xlCategory)\n    .MinimumScale = ActiveSheet.Range(\"A1\").Value\n    .MaximumScale = ActiveSheet.Range(\"A2\").Value\nEnd With\n</code></pre>\n\n<p>Note that I haven't had time to check the last series data, let me know if it works and i can update later if not.</p>\n\n<p>Was this what you were looking for?</p>\n"}], "owner": {"reputation": 33, "user_id": 2928759, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/12ddf086b8b346c3aa5b3ca2d8b09b2c?s=128&d=identicon&r=PG&f=1", "display_name": "Claude G", "link": "https://stackoverflow.com/users/2928759/claude-g"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 541, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1480515088, "creation_date": 1480498663, "last_edit_date": 1531164843, "question_id": 40884792, "link": "https://stackoverflow.com/questions/40884792/reset-the-origin-of-a-graph-with-vba", "title": "reset the origin of a graph with VBA", "body": "<p>I have a problem with my graphs. After transmitting the values for the x- and y- axis, I have the problem that sometimes the origin moves, therefore, I need to reset the origin to its normal position, nevertheless, I do not know how to address the origin of a graph in VBA and to manipulate it?</p>\n\n<p>Thanks in Advance</p>\n"}, {"tags": ["vba", "excel", "powerpoint"], "answers": [{"tags": [], "owner": {"reputation": 2476, "user_id": 2674672, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/AvMmQ.jpg?s=128&g=1", "display_name": "Jamie Garroch - MVP", "link": "https://stackoverflow.com/users/2674672/jamie-garroch-mvp"}, "is_accepted": false, "score": 0, "last_activity_date": 1480521266, "creation_date": 1480521266, "answer_id": 40892663, "question_id": 40884385, "link": "https://stackoverflow.com/questions/40884385/reference-excel-cell-in-powerpoint-macro-for-filename/40892663#40892663", "title": "Reference Excel cell in PowerPoint macro for filename", "body": "<p>What problem are you facing using ExportAsFixedFormat directly from the Excel VBE? According to the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff746080.aspx?f=255&amp;MSPPError=-2147217396\" rel=\"nofollow noreferrer\">documentation</a> (which seems to be incorrect) and the PowerPoint VBE IntelliSense, the second argument, FixedFormatType can only be one of two values:</p>\n\n<pre><code>ExportAsFixedFormat(Path, FixedFormatType, Intent, FrameSlides, _\n                    HandoutOrder, OutputType, PrintHiddenSlides, PrintRange, _\n                    RangeType, SlideShowName, IncludeDocProperties, KeepIRMSettings)\n\nFixedFormatType:\n\nppFixedFormatTypePDF = 2\nppFixedFormatTypeXPS = 1\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 3, "user_id": 7229828, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/920c7057d668473efa1ebb125112249b?s=128&d=identicon&r=PG&f=1", "display_name": "cellintern", "link": "https://stackoverflow.com/users/7229828/cellintern"}, "edited": false, "score": 0, "creation_date": 1480589013, "post_id": 40893519, "comment_id": 69029438, "body": "Thanks Darren, you&#39;ve put alot of work into this answer but one of your lines of code actually opened my eyes. I kept trying to use ExportAsFixedFormat from Excel VBA but <code>PP.SaveAs ThisWorkbook.Path &amp; Application.PathSeparator &amp; &quot;ABC&quot;, 32 &#39;ppSaveAsPDF</code> this worked great. Just using SaveAs with the pdf numeration. Great! Thanks again!"}], "tags": [], "owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "is_accepted": true, "score": 0, "last_activity_date": 1480525022, "last_edit_date": 1480525022, "creation_date": 1480523698, "answer_id": 40893519, "question_id": 40884385, "link": "https://stackoverflow.com/questions/40884385/reference-excel-cell-in-powerpoint-macro-for-filename/40893519#40893519", "title": "Reference Excel cell in PowerPoint macro for filename", "body": "<p>Why not open the presentation and save it as a PDF from Excel if the main bulk of the code is in Excel anyway?</p>\n\n<pre><code>Sub SavePPTXasPDF()\n\n    Dim PPT As Object\n    Dim PP As Object\n\n    Set PPT = CreatePPT\n    Set PP = PPT.Presentations.Open(\"&lt;FullPathToPresentation&gt;\")\n\n    PP.SaveAs ThisWorkbook.Path &amp; Application.PathSeparator &amp; \"ABC\", 32 'ppSaveAsPDF\n\nEnd Sub\n\n\nPublic Function CreatePPT(Optional bVisible As Boolean = True) As Object\n\n    Dim oTmpPPT As Object\n\n    ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''\n    'Defer error trapping in case Powerpoint is not running. '\n    ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''\n    On Error Resume Next\n    Set oTmpPPT = GetObject(, \"Powerpoint.Application\")\n\n    ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''\n    'If an error occurs then create an instance of Powerpoint. '\n    'Reinstate error handling.                                 '\n    ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''\n    If Err.Number &lt;&gt; 0 Then\n        Err.Clear\n        On Error GoTo ERROR_HANDLER\n        Set oTmpPPT = CreateObject(\"Powerpoint.Application\")\n    End If\n\n    oTmpPPT.Visible = bVisible\n    Set CreatePPT = oTmpPPT\n\n    On Error GoTo 0\n    Exit Function\n\nERROR_HANDLER:\n    Select Case Err.Number\n\n        Case Else\n            MsgBox \"Error \" &amp; Err.Number &amp; vbCr &amp; _\n                \" (\" &amp; Err.Description &amp; \") in procedure CreatePPT.\"\n            Err.Clear\n    End Select\n\nEnd Function\n</code></pre>\n\n<p>or if you want to run the code in Powerpoint:  </p>\n\n<pre><code>Public Sub Test()\n\n    Dim oXL As Object\n    Dim oWB As Object\n    Dim FName           As String\n    Dim FPath           As String\n\n    Set oXL = CreateXL\n    Set oWB = oXL.workbooks.Open(\"&lt;Path&amp;FileName&gt;\")\n\n    'Or if Workbook is already open:\n    'Set oWB = oXL.workbooks(\"&lt;FileName&gt;\")\n\n    FPath = oWB.worksheets(\"Sheet1\").Range(\"A1\")\n    FName = oWB.worksheets(\"Sheet1\").Range(\"A3\")\n\n    ActivePresentation.ExportAsFixedFormat FPath &amp; FName &amp; \" Development\" &amp; \".pdf\", 32\n\nEnd Sub\n\nPublic Function CreateXL(Optional bVisible As Boolean = True) As Object\n\n    Dim oTmpXL As Object\n\n    '''''''''''''''''''''''''''''''''''''''''''''''''''''\n    'Defer error trapping in case Excel is not running. '\n    '''''''''''''''''''''''''''''''''''''''''''''''''''''\n    On Error Resume Next\n    Set oTmpXL = GetObject(, \"Excel.Application\")\n\n    '''''''''''''''''''''''''''''''''''''''''''''''''''''''\n    'If an error occurs then create an instance of Excel. '\n    'Reinstate error handling.                            '\n    '''''''''''''''''''''''''''''''''''''''''''''''''''''''\n    If Err.Number &lt;&gt; 0 Then\n        Err.Clear\n        On Error GoTo ERROR_HANDLER\n        Set oTmpXL = CreateObject(\"Excel.Application\")\n    End If\n\n    oTmpXL.Visible = bVisible\n    Set CreateXL = oTmpXL\n\n    On Error GoTo 0\n    Exit Function\n\nERROR_HANDLER:\n    Select Case Err.Number\n\n        Case Else\n            MsgBox \"Error \" &amp; Err.Number &amp; vbCr &amp; _\n                \" (\" &amp; Err.Description &amp; \") in procedure CreateXL.\"\n            Err.Clear\n    End Select\n\nEnd Function\n</code></pre>\n\n<p>Or you could, as you requested, open the presentation from within Excel and execute code stored in the presentation:  </p>\n\n<pre><code>Sub SavePPTXasPDF()\n\n    Dim PPT As Object\n    Dim PP As Object\n\n    Set PPT = CreatePPT\n    Set PP = PPT.Presentations.Open(\"&lt;FullPath&gt;\")\n    PPT.Run PP.Name &amp; \"!Test\"\n\nEnd Sub  \n</code></pre>\n\n<p>This would use the <code>Test</code> macro and use the <code>Set oWB = oXL.workbooks(\"&lt;FileName&gt;\")</code> line of code which is currently commented out in my example above.</p>\n"}], "owner": {"reputation": 3, "user_id": 7229828, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/920c7057d668473efa1ebb125112249b?s=128&d=identicon&r=PG&f=1", "display_name": "cellintern", "link": "https://stackoverflow.com/users/7229828/cellintern"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 892, "favorite_count": 0, "accepted_answer_id": 40893519, "answer_count": 2, "score": 0, "last_activity_date": 1490093106, "creation_date": 1480497510, "last_edit_date": 1490093106, "question_id": 40884385, "link": "https://stackoverflow.com/questions/40884385/reference-excel-cell-in-powerpoint-macro-for-filename", "title": "Reference Excel cell in PowerPoint macro for filename", "body": "<p>I can't get SaveAsFixedFormat working from Excel VBA to export a PowerPoint file as PDF. I have resorted to starting a macro in the preset-powerpoint from Excel VBA that exports the presentation as pdf directly from PowerPoint.</p>\n\n<p>Is there any way to reference a cell in the Excel file in this macro that is running in PowerPoint to get the filename?</p>\n\n<pre><code>Sub pppdf()\n\nActivePresentation.ExportAsFixedFormat \"M:\\random\\test.pdf\", 32\n\nEnd Sub\n</code></pre>\n\n<p>I can save the PowerPoint file as .pptx from Excel and use varying filenames and paths but now I would like to reference those same paths and filenames in the PowerPoint macro that is exporting to pdf.</p>\n\n<p>In the end I'd like the code to look somewhat like this but this obviously needs some work to function from PowerPoint:</p>\n\n<pre><code>Dim FName           As String\nDim FPath           As String\n\nFPath = Range(\"SavingPath\").Value\nFName = Sheets(\"randomworksheet\").Range(\"A1\").Text\n\nActivePresentation.ExportAsFixedFormat FPath &amp; FName &amp; \" Development\" &amp; \".pdf\", 32\n</code></pre>\n\n<p>This PowerPoint macro would be started from Excel and both the PowerPoint file and the Excel Workbook and sheet will be open when this is executed.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1476, "user_id": 2438045, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c63177f6a7ecfe4f3b5b62ef8c5900a?s=128&d=identicon&r=PG", "display_name": "Seb", "link": "https://stackoverflow.com/users/2438045/seb"}, "edited": false, "score": 0, "creation_date": 1480497688, "post_id": 40884310, "comment_id": 68982953, "body": "Please show us what you already have and what you already tried."}, {"owner": {"reputation": 55, "user_id": 7229848, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/6bf0740775ef2058d5fcaf755e4797f9?s=128&d=identicon&r=PG&f=1", "display_name": "FrasercT", "link": "https://stackoverflow.com/users/7229848/fraserct"}, "reply_to_user": {"reputation": 1476, "user_id": 2438045, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c63177f6a7ecfe4f3b5b62ef8c5900a?s=128&d=identicon&r=PG", "display_name": "Seb", "link": "https://stackoverflow.com/users/2438045/seb"}, "edited": false, "score": 0, "creation_date": 1480497767, "post_id": 40884310, "comment_id": 68983004, "body": "Public Function WorkDayDiff(ByRef StartDate As Range) As Integer         Set xlCell = Range(&quot;N2&quot;)         For Counter = 1 To DateDiff(&quot;1&quot;, StartDate.Value, Now())          If Weekday(CDate(StartDate.Value + Counter)) &gt; 1 And Weekday(CDate(StartDate.Value + Counter)) &lt; 7 Then WorkDayDiff = WorkDayDiff + 1      Next Counter     End Function"}, {"owner": {"reputation": 55, "user_id": 7229848, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/6bf0740775ef2058d5fcaf755e4797f9?s=128&d=identicon&r=PG&f=1", "display_name": "FrasercT", "link": "https://stackoverflow.com/users/7229848/fraserct"}, "reply_to_user": {"reputation": 1476, "user_id": 2438045, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c63177f6a7ecfe4f3b5b62ef8c5900a?s=128&d=identicon&r=PG", "display_name": "Seb", "link": "https://stackoverflow.com/users/2438045/seb"}, "edited": false, "score": 0, "creation_date": 1480497806, "post_id": 40884310, "comment_id": 68983030, "body": "The issue I&#39;m having is with the output into a column in my spreadsheet."}, {"owner": {"reputation": 1476, "user_id": 2438045, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c63177f6a7ecfe4f3b5b62ef8c5900a?s=128&d=identicon&r=PG", "display_name": "Seb", "link": "https://stackoverflow.com/users/2438045/seb"}, "edited": false, "score": 0, "creation_date": 1480499818, "post_id": 40884310, "comment_id": 68984440, "body": "Next time please edit your question and try not to post code into a comment."}], "answers": [{"comments": [{"owner": {"reputation": 55, "user_id": 7229848, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/6bf0740775ef2058d5fcaf755e4797f9?s=128&d=identicon&r=PG&f=1", "display_name": "FrasercT", "link": "https://stackoverflow.com/users/7229848/fraserct"}, "edited": false, "score": 0, "creation_date": 1480497706, "post_id": 40884377, "comment_id": 68982965, "body": "thanks for the reply, but my whole worksheet is generated by a macro which erases any data in it when you run the macro; this is why I need a solution I can fit into my code. Is there a way to paste this formula into my code?"}, {"owner": {"reputation": 55, "user_id": 7229848, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/6bf0740775ef2058d5fcaf755e4797f9?s=128&d=identicon&r=PG&f=1", "display_name": "FrasercT", "link": "https://stackoverflow.com/users/7229848/fraserct"}, "edited": false, "score": 0, "creation_date": 1480498098, "post_id": 40884377, "comment_id": 68983253, "body": "Thanks, I&#39;ll give this a go!"}, {"owner": {"reputation": 530, "user_id": 5902659, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c6ed01eb79ca1012c98545e01aaca144?s=128&d=identicon&r=PG&f=1", "display_name": "user1", "link": "https://stackoverflow.com/users/5902659/user1"}, "reply_to_user": {"reputation": 55, "user_id": 7229848, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/6bf0740775ef2058d5fcaf755e4797f9?s=128&d=identicon&r=PG&f=1", "display_name": "FrasercT", "link": "https://stackoverflow.com/users/7229848/fraserct"}, "edited": false, "score": 0, "creation_date": 1480498703, "post_id": 40884377, "comment_id": 68983674, "body": "Hi, did this work for you? need any further development? :) Please mark as an answer if it was useful for you"}, {"owner": {"reputation": 55, "user_id": 7229848, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/6bf0740775ef2058d5fcaf755e4797f9?s=128&d=identicon&r=PG&f=1", "display_name": "FrasercT", "link": "https://stackoverflow.com/users/7229848/fraserct"}, "edited": false, "score": 0, "creation_date": 1480498861, "post_id": 40884377, "comment_id": 68983775, "body": "Yes! Never knew you could put excel formulas in VBA like that. Thanks!"}, {"owner": {"reputation": 530, "user_id": 5902659, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c6ed01eb79ca1012c98545e01aaca144?s=128&d=identicon&r=PG&f=1", "display_name": "user1", "link": "https://stackoverflow.com/users/5902659/user1"}, "reply_to_user": {"reputation": 55, "user_id": 7229848, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/6bf0740775ef2058d5fcaf755e4797f9?s=128&d=identicon&r=PG&f=1", "display_name": "FrasercT", "link": "https://stackoverflow.com/users/7229848/fraserct"}, "edited": false, "score": 0, "creation_date": 1480498985, "post_id": 40884377, "comment_id": 68983858, "body": "yep! you can also make it dynamic if range is unknown :)"}], "tags": [], "owner": {"reputation": 530, "user_id": 5902659, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c6ed01eb79ca1012c98545e01aaca144?s=128&d=identicon&r=PG&f=1", "display_name": "user1", "link": "https://stackoverflow.com/users/5902659/user1"}, "is_accepted": true, "score": 2, "last_activity_date": 1480498020, "last_edit_date": 1480498020, "creation_date": 1480497480, "answer_id": 40884377, "question_id": 40884310, "link": "https://stackoverflow.com/questions/40884310/working-day-counter-for-vba/40884377#40884377", "title": "Working day counter for VBA", "body": "<p>Fairly simple, see formula below:\n<code>=NETWORKDAYS(C13,C14,calenderyear16)</code></p>\n\n<p>Put your start date in cell C13 (or wherever you need it), and end date in C14 (or wherever you need it). </p>\n\n<p><code>calenderyear16</code> is just a range of cells that i have named. You must also create the same named range. This named range contains all of the bank holidays in the year.</p>\n\n<p>You can obtain the list of bank holidays for each year from Gov.uk website</p>\n\n<p>In VBA:</p>\n\n<p><code>Range(\"C15\").Formula = \"=NETWORKDAYS(C13,C14,calenderyear16)\"</code></p>\n\n<p>you can change <code>range(\"C15\")</code> to be <code>cells(row number, column number)</code> and you can use a dynamic range as well if you wish. hope this works! :)</p>\n"}], "owner": {"reputation": 55, "user_id": 7229848, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/6bf0740775ef2058d5fcaf755e4797f9?s=128&d=identicon&r=PG&f=1", "display_name": "FrasercT", "link": "https://stackoverflow.com/users/7229848/fraserct"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 319, "favorite_count": 0, "accepted_answer_id": 40884377, "answer_count": 1, "score": 1, "last_activity_date": 1480498020, "creation_date": 1480497293, "question_id": 40884310, "link": "https://stackoverflow.com/questions/40884310/working-day-counter-for-vba", "title": "Working day counter for VBA", "body": "<p>I'm quite new to VBA and I need to add something to code I've been given that will count the number of working days between a start date and today's date and output this data in a column at the end of my spreadsheet. My attempts so far have all failed, grateful for any help people can give!</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 530, "user_id": 5902659, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c6ed01eb79ca1012c98545e01aaca144?s=128&d=identicon&r=PG&f=1", "display_name": "user1", "link": "https://stackoverflow.com/users/5902659/user1"}, "edited": false, "score": 0, "creation_date": 1480497633, "post_id": 40884210, "comment_id": 68982907, "body": "what is aArticles? what type of variable is it?"}, {"owner": {"reputation": 91, "user_id": 5041299, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/31tK6.jpg?s=128&g=1", "display_name": "Verd&#39;O", "link": "https://stackoverflow.com/users/5041299/verdo"}, "reply_to_user": {"reputation": 530, "user_id": 5902659, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c6ed01eb79ca1012c98545e01aaca144?s=128&d=identicon&r=PG&f=1", "display_name": "user1", "link": "https://stackoverflow.com/users/5902659/user1"}, "edited": false, "score": 0, "creation_date": 1480497895, "post_id": 40884210, "comment_id": 68983099, "body": "It&#39;s an Array. aProd and aArt are similar. My code for my dataset1 but as I try to run it with another dataset, the error shows up (worked yesterday with dataset  and 2)"}, {"owner": {"reputation": 1761, "user_id": 1050927, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/445e633a360a3597153c4c84e61db91d?s=128&d=identicon&r=PG&f=1", "display_name": "Prisoner", "link": "https://stackoverflow.com/users/1050927/prisoner"}, "edited": false, "score": 0, "creation_date": 1480497953, "post_id": 40884210, "comment_id": 68983140, "body": "I think you better check your data first, or provide <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> to support your question."}, {"owner": {"reputation": 530, "user_id": 5902659, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c6ed01eb79ca1012c98545e01aaca144?s=128&d=identicon&r=PG&f=1", "display_name": "user1", "link": "https://stackoverflow.com/users/5902659/user1"}, "edited": false, "score": 0, "creation_date": 1480498068, "post_id": 40884210, "comment_id": 68983230, "body": "please provide a larger subset of the code"}, {"owner": {"reputation": 91, "user_id": 5041299, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/31tK6.jpg?s=128&g=1", "display_name": "Verd&#39;O", "link": "https://stackoverflow.com/users/5041299/verdo"}, "reply_to_user": {"reputation": 1761, "user_id": 1050927, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/445e633a360a3597153c4c84e61db91d?s=128&d=identicon&r=PG&f=1", "display_name": "Prisoner", "link": "https://stackoverflow.com/users/1050927/prisoner"}, "edited": false, "score": 0, "creation_date": 1480499117, "post_id": 40884210, "comment_id": 68983944, "body": "I don&#39;t know if you have a notification when I edit the post so... @Alex"}, {"owner": {"reputation": 91, "user_id": 5041299, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/31tK6.jpg?s=128&g=1", "display_name": "Verd&#39;O", "link": "https://stackoverflow.com/users/5041299/verdo"}, "reply_to_user": {"reputation": 530, "user_id": 5902659, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c6ed01eb79ca1012c98545e01aaca144?s=128&d=identicon&r=PG&f=1", "display_name": "user1", "link": "https://stackoverflow.com/users/5902659/user1"}, "edited": false, "score": 0, "creation_date": 1480499290, "post_id": 40884210, "comment_id": 68984073, "body": "I cant tag 2 users so... @mo.h"}, {"owner": {"reputation": 530, "user_id": 5902659, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c6ed01eb79ca1012c98545e01aaca144?s=128&d=identicon&r=PG&f=1", "display_name": "user1", "link": "https://stackoverflow.com/users/5902659/user1"}, "edited": false, "score": 0, "creation_date": 1480502839, "post_id": 40884210, "comment_id": 68986612, "body": "I got a different error: <code>unable to get the Match property of the WroksheetFunction class</code> that was for the aHdr variable. start there perhaps?"}, {"owner": {"reputation": 91, "user_id": 5041299, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/31tK6.jpg?s=128&g=1", "display_name": "Verd&#39;O", "link": "https://stackoverflow.com/users/5041299/verdo"}, "edited": false, "score": 0, "creation_date": 1480503194, "post_id": 40884210, "comment_id": 68986839, "body": "Did the error shows up for a specific index of aHdr? If yes then, is this index 1?"}, {"owner": {"reputation": 91, "user_id": 5041299, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/31tK6.jpg?s=128&g=1", "display_name": "Verd&#39;O", "link": "https://stackoverflow.com/users/5041299/verdo"}, "edited": false, "score": 0, "creation_date": 1480503593, "post_id": 40884210, "comment_id": 68987120, "body": "Aaaaand it&#39;s probably for aHdr(1): just rename B1 in &quot;CODE P&quot; instead of &quot;CODP&quot; and it will work"}, {"owner": {"reputation": 91, "user_id": 5041299, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/31tK6.jpg?s=128&g=1", "display_name": "Verd&#39;O", "link": "https://stackoverflow.com/users/5041299/verdo"}, "reply_to_user": {"reputation": 530, "user_id": 5902659, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c6ed01eb79ca1012c98545e01aaca144?s=128&d=identicon&r=PG&f=1", "display_name": "user1", "link": "https://stackoverflow.com/users/5902659/user1"}, "edited": false, "score": 0, "creation_date": 1480580524, "post_id": 40884210, "comment_id": 69023976, "body": "@mo.h I just find out that the reason of the error message is when the length of my description is over 255 characters. I can now know if it woorks or not but still did not explain why it stoped working from day to day... I don&#39;t know if there is a way to &quot;ignore&quot; the limitation of 255 but I can change my code to copy the value in a different way. Anyway, thanks for your time =)"}, {"owner": {"reputation": 530, "user_id": 5902659, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c6ed01eb79ca1012c98545e01aaca144?s=128&d=identicon&r=PG&f=1", "display_name": "user1", "link": "https://stackoverflow.com/users/5902659/user1"}, "edited": false, "score": 0, "creation_date": 1480583766, "post_id": 40884210, "comment_id": 69025752, "body": "@Verd&#39;O i did not receive any of your previous replies as you did not tag me. Please rememebr to tag a user so they are notified :) and i think it was index 8"}, {"owner": {"reputation": 91, "user_id": 5041299, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/31tK6.jpg?s=128&g=1", "display_name": "Verd&#39;O", "link": "https://stackoverflow.com/users/5041299/verdo"}, "reply_to_user": {"reputation": 530, "user_id": 5902659, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c6ed01eb79ca1012c98545e01aaca144?s=128&d=identicon&r=PG&f=1", "display_name": "user1", "link": "https://stackoverflow.com/users/5902659/user1"}, "edited": false, "score": 0, "creation_date": 1480585062, "post_id": 40884210, "comment_id": 69026536, "body": "@mo.h well... I don&#39;t remember having this error on aHdr(8) but anyway, the limitation kinda sucks... :/ I will remember to tag people next time ^^"}], "owner": {"reputation": 91, "user_id": 5041299, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/31tK6.jpg?s=128&g=1", "display_name": "Verd&#39;O", "link": "https://stackoverflow.com/users/5041299/verdo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 185, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1480585091, "creation_date": 1480496967, "last_edit_date": 1531164843, "question_id": 40884210, "link": "https://stackoverflow.com/questions/40884210/error-13-with-transpose", "title": "Error 13 with .Transpose", "body": "<pre><code>With WorksheetFunction\n    aProducts = .Transpose(.Transpose(aProducts))\n    aArticles = .Transpose(.Transpose(aArticles))\nEnd With\n</code></pre>\n\n<p>Hi, guys</p>\n\n<p>This code worked yesterday but not anymore: it still works with \"aProducts\" but the error 13: type mismatch shows up for \"aArticles\". </p>\n\n<p>Is it a recurrent error? Do you have any idea why it stoped working? </p>\n\n<p><strong>EDIT 1</strong> </p>\n\n<p>Link to the file : <a href=\"https://drive.google.com/open?id=0B5DpGwPWsIfbSWlDbkxCVWtMWU0\" rel=\"nofollow noreferrer\">https://drive.google.com/open?id=0B5DpGwPWsIfbSWlDbkxCVWtMWU0</a>\nYou just have to run Sub final_code</p>\n\n<p>Remember to rename the dataset 1 or 2 as \"Donn\u00e9es\" if you want to test</p>\n\n<p>Thanks for your time.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 3541, "user_id": 1616731, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/c9adb6c09548c81a8a9a46d7497081f6?s=128&d=identicon&r=PG&f=1", "display_name": "Tim Wilkinson", "link": "https://stackoverflow.com/users/1616731/tim-wilkinson"}, "edited": false, "score": 0, "creation_date": 1480496515, "post_id": 40883946, "comment_id": 68982261, "body": "At the moment you won&#39;t get past <code>Do While row &lt;&gt; &quot;done&quot;</code> because every time they input something other than &quot;done&quot;, it will just loop back to the <code>InputBox</code> each time."}, {"owner": {"reputation": 35, "user_id": 6155961, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/0009e74349f01b170fd3ed2b4a5ba108?s=128&d=identicon&r=PG&f=1", "display_name": "Zigouma", "link": "https://stackoverflow.com/users/6155961/zigouma"}, "reply_to_user": {"reputation": 3541, "user_id": 1616731, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/c9adb6c09548c81a8a9a46d7497081f6?s=128&d=identicon&r=PG&f=1", "display_name": "Tim Wilkinson", "link": "https://stackoverflow.com/users/1616731/tim-wilkinson"}, "edited": false, "score": 0, "creation_date": 1480496709, "post_id": 40883946, "comment_id": 68982382, "body": "So what the solution to get my code working ?"}, {"owner": {"reputation": 861, "user_id": 2185841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a5f1c8c3345afa24238a2598f7fe9d76?s=128&d=identicon&r=PG", "display_name": "Skip Intro", "link": "https://stackoverflow.com/users/2185841/skip-intro"}, "edited": false, "score": 0, "creation_date": 1480500583, "post_id": 40883946, "comment_id": 68985006, "body": "Isn&#39;t this just a rehash of your previous question? See <a href=\"http://stackoverflow.com/questions/40806057/vba-copy-selected-columns-and-rows-from-an-excel-table-and-convert-paste-it-in-a?noredirect=1#comment68833714_40806057\" title=\"vba copy selected columns and rows from an excel table and convert paste it in a\">stackoverflow.com/questions/40806057/&hellip;</a>"}, {"owner": {"reputation": 35, "user_id": 6155961, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/0009e74349f01b170fd3ed2b4a5ba108?s=128&d=identicon&r=PG&f=1", "display_name": "Zigouma", "link": "https://stackoverflow.com/users/6155961/zigouma"}, "edited": false, "score": 0, "creation_date": 1480501605, "post_id": 40883946, "comment_id": 68985743, "body": "actually yes. But i&#39;m trying to solve it but I didn&#39;t get any solution :("}], "answers": [{"comments": [{"owner": {"reputation": 35, "user_id": 6155961, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/0009e74349f01b170fd3ed2b4a5ba108?s=128&d=identicon&r=PG&f=1", "display_name": "Zigouma", "link": "https://stackoverflow.com/users/6155961/zigouma"}, "edited": false, "score": 0, "creation_date": 1480501790, "post_id": 40884410, "comment_id": 68985878, "body": "i get always application-defined or object-defined error (error 1004)"}, {"owner": {"reputation": 35, "user_id": 6155961, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/0009e74349f01b170fd3ed2b4a5ba108?s=128&d=identicon&r=PG&f=1", "display_name": "Zigouma", "link": "https://stackoverflow.com/users/6155961/zigouma"}, "edited": false, "score": 0, "creation_date": 1480502167, "post_id": 40884410, "comment_id": 68986158, "body": "this error comes in the step of //  Set CopyRange = Union(CopyRange, Range(col &amp; row, [col &amp; row]))"}], "tags": [], "owner": {"reputation": 3541, "user_id": 1616731, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/c9adb6c09548c81a8a9a46d7497081f6?s=128&d=identicon&r=PG&f=1", "display_name": "Tim Wilkinson", "link": "https://stackoverflow.com/users/1616731/tim-wilkinson"}, "is_accepted": false, "score": 0, "last_activity_date": 1480497558, "creation_date": 1480497558, "answer_id": 40884410, "question_id": 40883946, "link": "https://stackoverflow.com/questions/40883946/vba-use-range-with-variable-for-columns-and-rows/40884410#40884410", "title": "VBA Use range with variable for columns and rows", "body": "<p>You're not doing anything inside your loop apart from waiting for \"done\" to be entered.</p>\n\n<pre><code>For i = 1 To 10\ncol = InputBox(\"Column number \" &amp; i &amp; \", if finish write 'done'\")\nIf col = \"done\" Then\n    MsgBox (\"copy finished\")\n    GoTo ExitIteration\nElse\n    Do While row &lt;&gt; \"done\"\n        row = InputBox(\"row number to copy (max to 62), if finish write 'done'\")\n        Set CopyRange = Union(CopyRange, Range(col &amp; row, [col &amp; row]))\n    Loop\nEnd If\nNext\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 76, "user_id": 7132406, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-e3JX76SHxZg/AAAAAAAAAAI/AAAAAAAAIaM/gZ6LTkMMZ3M/photo.jpg?sz=128", "display_name": "Tilan04", "link": "https://stackoverflow.com/users/7132406/tilan04"}, "is_accepted": false, "score": 0, "last_activity_date": 1480504824, "creation_date": 1480504824, "answer_id": 40887034, "question_id": 40883946, "link": "https://stackoverflow.com/questions/40883946/vba-use-range-with-variable-for-columns-and-rows/40887034#40887034", "title": "VBA Use range with variable for columns and rows", "body": "<p>I haven't time to write the code and make a example for my idea, sorry for that. But I will try to expose it...</p>\n\n<p>Create a new sheet to feed your code with de initial/final columns and rows and compose a different ranges to accomplish your desire of proceed 10 maximum times. Use a three level loops to reach each one the cells that you need. </p>\n"}], "owner": {"reputation": 35, "user_id": 6155961, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/0009e74349f01b170fd3ed2b4a5ba108?s=128&d=identicon&r=PG&f=1", "display_name": "Zigouma", "link": "https://stackoverflow.com/users/6155961/zigouma"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 781, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1480504824, "creation_date": 1480496099, "last_edit_date": 1480496497, "question_id": 40883946, "link": "https://stackoverflow.com/questions/40883946/vba-use-range-with-variable-for-columns-and-rows", "title": "VBA Use range with variable for columns and rows", "body": "<p>I want to copy a range of table and paste it in a new workbook. I want to copy ranges composed of other columns and rows but as variable. For example, I copy columns C and E with the rows from 1 to 17, 20, from 32 to 39 and 45. And I want to proceed that maximum 10 times (for the columns) and if I finish selecting the columns to copy, I exit. To be more clear, there is an exampel: I select column B, D, F and than select the rows to be copied (they are the same for all the columns) and finally copy them and paste them in a new workbook. So I stoped after three times and copy what I selected and go out.</p>\n\n<p><strong>My Code</strong> </p>\n\n<pre><code>Sub Macro3()\n\nDim ColNum As Long\nDim col As String\nDim CopyRange As Range, row As String\n\nFor i = 1 To 10\n    col = InputBox(\"Column number \" &amp; i &amp; \", if finish write 'done'\")\n    Do While row &lt;&gt; \"done\"\n        row = InputBox(\"row number to copy (max to 62), if finish write 'done'\")\n    Loop\n    If col = \"done\" Then\n        MsgBox (\"copy finished\")\n        GoTo ExitIteration\n    Else\n        Set CopyRange = Union(CopyRange, Range(col &amp; row, [col &amp; row]))\n    End If\nNext\n\nExitIteration:\n\nCopyRange.Copy\nWorkbooks.Add\nActiveSheet.Paste\nWindows(\"Pedro.xlsm\").Activate\n\nEnd Sub\n</code></pre>\n\n<p>Any help please solving it ?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1480495511, "post_id": 40883755, "comment_id": 68981627, "body": "Are you sure it freezes after, not during?"}, {"owner": {"reputation": 526, "user_id": 3094555, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/La3AK.jpg?s=128&g=1", "display_name": "Pingu", "link": "https://stackoverflow.com/users/3094555/pingu"}, "reply_to_user": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1480495676, "post_id": 40883755, "comment_id": 68981724, "body": "Yes, I tried to add a user form that will pop up after the loop. I can only close the user form after 5 seconds."}, {"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1480495763, "post_id": 40883755, "comment_id": 68981761, "body": "Might be about calculations, but then it should not really depend on number of iterations because it would recalculate after each one. Try switching off automatic calculations too though."}, {"owner": {"reputation": 526, "user_id": 3094555, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/La3AK.jpg?s=128&g=1", "display_name": "Pingu", "link": "https://stackoverflow.com/users/3094555/pingu"}, "reply_to_user": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1480495971, "post_id": 40883755, "comment_id": 68981903, "body": "Yes I have tried that as well. But still the same :("}], "answers": [{"comments": [{"owner": {"reputation": 526, "user_id": 3094555, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/La3AK.jpg?s=128&g=1", "display_name": "Pingu", "link": "https://stackoverflow.com/users/3094555/pingu"}, "edited": false, "score": 0, "creation_date": 1480497610, "post_id": 40884027, "comment_id": 68982889, "body": "Yes indeed copying in this way is faster, it works much better now :) thanks"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user7168530"}, "is_accepted": true, "score": 1, "last_activity_date": 1480496715, "last_edit_date": 1480496715, "creation_date": 1480496391, "answer_id": 40884027, "question_id": 40883755, "link": "https://stackoverflow.com/questions/40883755/vba-in-excel-screen-freezes-for-a-few-seconds-after-consecutive-copies-and-past/40884027#40884027", "title": "VBA in Excel: Screen freezes for a few seconds after consecutive copies and pastes", "body": "<p>I don't think this is an issue isolated to your computer, as I encounter a similar lag time in the calculations (proportional to upper bound of iteration, as you've rightly pointed out). Its just a consequence of iterating a copy and/or paste unfortunately, as this (I find) takes longer to do in VBA than most things (and ultimately slows down code). What might be worth a try is the following:</p>\n\n<pre><code>Sub test()\n   Application.ScreenUpdating = False\n   Application.Calculation = xlCalculationManual\n   For i = 1 To 1000\n       'Range(\"A\" &amp; i).Copy Destination:=Range(\"B\" &amp; i)\n       Cells(i, 2).Value = Cells(i, 1).Value\n   Next\n   Application.ScreenUpdating = True\n   Application.Calculation = xlCalculationAutomatic\nEnd Sub\n</code></pre>\n\n<p>Technically it does the exact same thing as your code, but without copying. I'm not sure how this will relate back to your actual work (as opposed to this example) but I find it is quicker to run on my machine.</p>\n\n<p>Basically, my point is that Copy and/or Pasting in big iterations is just slow in VBA full stop, so my advice is to avoid where possible. Good link to an article on it below :)</p>\n\n<p><a href=\"http://www.ozgrid.com/VBA/SpeedingUpVBACode.htm\" rel=\"nofollow noreferrer\">http://www.ozgrid.com/VBA/SpeedingUpVBACode.htm</a></p>\n"}], "owner": {"reputation": 526, "user_id": 3094555, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/La3AK.jpg?s=128&g=1", "display_name": "Pingu", "link": "https://stackoverflow.com/users/3094555/pingu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 284, "favorite_count": 0, "accepted_answer_id": 40884027, "answer_count": 1, "score": 1, "last_activity_date": 1480496715, "creation_date": 1480495402, "last_edit_date": 1480496001, "question_id": 40883755, "link": "https://stackoverflow.com/questions/40883755/vba-in-excel-screen-freezes-for-a-few-seconds-after-consecutive-copies-and-past", "title": "VBA in Excel: Screen freezes for a few seconds after consecutive copies and pastes", "body": "<p>I wrote a simple code to replicate the problem:</p>\n\n<pre><code>Sub test()\n    Application.ScreenUpdating = False\n    Application.Calculation = xlCalculationManual\n    For i = 1 To 1000\n        Range(\"A\" &amp; i).Copy Destination:=Range(\"B\" &amp; i)\n    Next\n    Application.ScreenUpdating = True\n    Application.Calculation = xlCalculationAutomatic\nEnd Sub\n</code></pre>\n\n<p>If I execute the above program block, after the program is completed, the screen will freeze for about 5 seconds before releasing the control to the user.</p>\n\n<p>If I change the number of times of copies (from 1000 to other values in the code), I can see that the freezing time is proportional to the number of copies.</p>\n\n<p>Is this the problem of my computer, or it actually happens on every computer? How can I solve this?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 0, "creation_date": 1480496365, "post_id": 40883639, "comment_id": 68982187, "body": "you are using Fname for the filename, but Fname is initialized with the return from <code>Dir</code> at the start of the proc (and will be &quot;C:\\Users\\wazeer.ahamed\\Documents\\Outlookemails_Macro\\&quot; )"}], "answers": [{"tags": [], "owner": {"reputation": 76, "user_id": 7132406, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-e3JX76SHxZg/AAAAAAAAAAI/AAAAAAAAIaM/gZ6LTkMMZ3M/photo.jpg?sz=128", "display_name": "Tilan04", "link": "https://stackoverflow.com/users/7132406/tilan04"}, "is_accepted": false, "score": 0, "last_activity_date": 1480506865, "creation_date": 1480506865, "answer_id": 40887712, "question_id": 40883639, "link": "https://stackoverflow.com/questions/40883639/excel-vba-movefile-syntax/40887712#40887712", "title": "Excel VBA - movefile syntax", "body": "<p>I think that the code can be more simple and dynamic if you play with your own excel file. </p>\n\n<ul>\n<li>Use \"A1\" range to put the source folder.</li>\n<li>Use \"B:B\" range to put the\nname of the files.</li>\n<li>Use \"C:C\" range to concatenate the previous\ncolumns.</li>\n<li>Use \"D1\" range to put the destination folder.</li>\n</ul>\n\n<hr>\n\n<pre><code>Sub copyFiles()\n'Macro for copy files\n'Set variable\nDim source As String\nDim destination As String\nDim x As Integer\nDim destinationNumber As Integer\n\ndestinationNumber = WorksheetFunction.CountA(ThisWorkbook.Sheets(\"Sheet1\").Range(\"C:C\"))\n\nApplication.ScreenUpdating = False\nApplication.DisplayAlerts = False\n\n'Create the folder if not exist\nIf Dir(ThisWorkbook.Path &amp; \"\\\" &amp; ThisWorkbook.Sheets(\"Sheet1\").Range(\"D1\"), 16) = \"\" Then\n    MkDir ThisWorkbook.Path &amp; \"\\\" &amp; ThisWorkbook.Sheets(\"Sheet1\").Range(\"D1\")\nEnd If\n\n'Run the loop to copy all the files\nFor x = 1 To destinationNumber\n    source = ThisWorkbook.Sheets(\"Sheet1\").Range(\"C\" &amp; x)\n    destination = ThisWorkbook.Sheets(\"Sheet1\").Range(\"D1\")\n    FileCopy source, destination\nNext x\n\nApplication.ScreenUpdating = True\nApplication.DisplayAlerts = True\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p>With this you can change the folders' paths and file names whenever you want. I've used FileCopy to preserve your files in the source but if you need to delete it's better use other method.</p>\n"}], "owner": {"reputation": 1, "user_id": 7174766, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94af5eb16317208337eba32ac249cbf7?s=128&d=identicon&r=PG&f=1", "display_name": "Wazeer Ahamed", "link": "https://stackoverflow.com/users/7174766/wazeer-ahamed"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1629, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1480506865, "creation_date": 1480494968, "last_edit_date": 1480496707, "question_id": 40883639, "link": "https://stackoverflow.com/questions/40883639/excel-vba-movefile-syntax", "title": "Excel VBA - movefile syntax", "body": "<p>Please help with the code for copying files one by one to the destination folder. I tried with \"for Each loop but it is copying all the files at once to the destination folder. I am new to to vba and would be helpful if someone could crack the code for me. thanks in advance. here's the code i have managed to come up with. </p>\n\n<p>I am getting run time error 53, File not found,e highlighting the below syntax.</p>\n\n<pre><code>FSO.movefile Source:=\"C:\\Users\\wazeer.ahamed\\Documents\\Outlookemails_Macro\\\" &amp; Fname, Destination:=\"C:\\Users\\wazeer.ahamed\\Documents\\TcktIDfolder\\\" &amp; Fname\n\nSub Example1()\n\n'Extracting file names Dim objFSO As Object Dim objFolder As Object Dim newobjFile As Object    \nDim lastID As Long Dim myRRange As Range Dim Maxvalue As Integer    \nDim sFolder As String Dim dFolder As String\n\n\nSub Example1()\n\n'Extracting file names\nDim FSO\nDim objFolder As Object\nDim newobjFile As Object\nDim FromDir As String\nDim ToDir As String    \n\nDim lastID As Long\nDim myRRange As Range\nDim Maxvalue As Integer    \nDim Fname As String                    \n\nFromDir = \"C:\\Users\\wazeer.ahamed\\Documents\\Outlookemails_Macro\\\"\nToDir = \"C:\\Users\\wazeer.ahamed\\Documents\\TcktIDfolder\\\"    \nFname = Dir(FromDir)\n\nIf Len(FromDir) = 0 Then\n    MsgBox \"No files\"\n    Exit Sub\nEnd If    \n\nSet myRange = Worksheets(\"Sheet1\").Range(\"C:C\")    \nMaxvalue = Application.WorksheetFunction.Max(myRange)    \nlastID = Maxvalue\n\n'finding the next availabe row    \nerow = Worksheets(\"Sheet1\").Cells(Rows.Count, 1).End(xlUp).Offset(1, 0).Row\n\n'Extracting file names\n\n'Create an instance of the FileSystemObject\nSet FSO = CreateObject(\"Scripting.FileSystemObject\")\n'Get the folder object\nSet objFolder = FSO.GetFolder(\"C:\\Users\\wazeer.ahamed\\Documents\\Outlookemails_Macro\")\n\n'loops through each file in the directory and prints their names and path        \nFor Each newobjFile In objFolder.Files\n\n     'print file name       \n    Cells(erow, 1) = Fname    \n\n    'print file path\n    Cells(erow, 2) = newobjFile.Path\n\n    'PrintUniqueID\n    Cells(erow, 3) = lastID + 1\n\n    FSO.movefile Source:=\"C:\\Users\\wazeer.ahamed\\Documents\\Outlookemails_Macro\\\" &amp; Fname, Destination:=\"C:\\Users\\wazeer.ahamed\\Documents\\TcktIDfolder\\\" &amp; Fname     \n    Cells(erow, 5) = \"file succesfully copied\"                   \nNext newobjFile        \n\nSet FSO = Nothing\nSet newobjFile = Nothing\nSet objFolder = Nothing             \n\nEnd Sub    \n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 11, "user_id": 7220123, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/930da4d7f555d8123e0acabf31ead518?s=128&d=identicon&r=PG&f=1", "display_name": "Tabraiz", "link": "https://stackoverflow.com/users/7220123/tabraiz"}, "edited": false, "score": 0, "creation_date": 1480494814, "post_id": 40883581, "comment_id": 68981264, "body": "Can you guys please help me as i am getting bug in this part of code ActiveWorkbook.SaveAs filename:=fName, FileFormat:=51"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1481015315, "post_id": 40883581, "comment_id": 69191677, "body": "have you tested any of the solutions provided below ? any feedback would be nice..."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 7220123, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/930da4d7f555d8123e0acabf31ead518?s=128&d=identicon&r=PG&f=1", "display_name": "Tabraiz", "link": "https://stackoverflow.com/users/7220123/tabraiz"}, "edited": false, "score": 0, "creation_date": 1480499717, "post_id": 40884426, "comment_id": 68984378, "body": "wilson88 Can you please explain why End if should be at end of code?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user7168530"}, "reply_to_user": {"reputation": 11, "user_id": 7220123, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/930da4d7f555d8123e0acabf31ead518?s=128&d=identicon&r=PG&f=1", "display_name": "Tabraiz", "link": "https://stackoverflow.com/users/7220123/tabraiz"}, "edited": false, "score": 0, "creation_date": 1480500186, "post_id": 40884426, "comment_id": 68984704, "body": "Its a multiple line syntax rule for If statements in VBA (which applies here as your &#39;Exit Sub&#39; statement is on another line).   If it was on one line, you wouldn&#39;t need to (but I always use it anyway as I prefer to write if statements in blocks as it is easier to comprehend).  more info linked :) <a href=\"https://msdn.microsoft.com/en-us/library/752y8abs.aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/752y8abs.aspx</a>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user7168530"}, "reply_to_user": {"reputation": 11, "user_id": 7220123, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/930da4d7f555d8123e0acabf31ead518?s=128&d=identicon&r=PG&f=1", "display_name": "Tabraiz", "link": "https://stackoverflow.com/users/7220123/tabraiz"}, "edited": false, "score": 0, "creation_date": 1480500381, "post_id": 40884426, "comment_id": 68984859, "body": "I think your document isnt saving because it thinks that the ActiveWorkbook.SaveAs filename:=fName, FileFormat:=51 statement is part of the If block. So therefore it will exit the sub before the document is saved..."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user7168530"}, "is_accepted": false, "score": 0, "last_activity_date": 1480497597, "creation_date": 1480497597, "answer_id": 40884426, "question_id": 40883581, "link": "https://stackoverflow.com/questions/40883581/runtime-error-1004-document-not-saved-with-vba-excel-2016/40884426#40884426", "title": "Runtime error 1004 document not saved with Vba Excel 2016", "body": "<p>I think you are missing an 'End If' at the bottom of your code. The 'If fName = False Then...' part. Try the following</p>\n\n<pre><code>Private Sub Save_Click()\n\n'Popup the Window \"Save As\"\n\nApplication.DisplayAlerts = False\n\n\nMsgBox \"Do not change the default file name proposed on the next step please !\"\n\nDim fName As Variant\n\nDim DName As String  ' Variable storing name of excel workbook which has to be saved\n\nDName = UserForm.CustomerApplication.Value &amp; \" - \" &amp; UserForm.L2GType.Value\n\n&amp; \" - \" &amp; UserForm.Title.Value &amp; \" - \" &amp; UserForm.Country.Value &amp; \"(\" &amp; \n\nYear(Date) &amp; \")\"\n\nfName = Application.GetSaveAsFilename(InitialFileName:=DName, _\n\nFileFilter:=\"Excel Files (*.XLSX), *.XLSX\", Title:=\"Save As\")\n\nIf fName = False Then\n\n Exit Sub\n\nEnd If\n\nActiveWorkbook.SaveAs filename:=fName, FileFormat:=51\n\nActiveWorkbook.Close\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 11, "user_id": 7220123, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/930da4d7f555d8123e0acabf31ead518?s=128&d=identicon&r=PG&f=1", "display_name": "Tabraiz", "link": "https://stackoverflow.com/users/7220123/tabraiz"}, "edited": false, "score": 0, "creation_date": 1480510517, "post_id": 40885769, "comment_id": 68991445, "body": "Shai Rado i changed my code as like you told but still not working give same error. i need to save excel workbook without macro enabled"}, {"owner": {"reputation": 11, "user_id": 7220123, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/930da4d7f555d8123e0acabf31ead518?s=128&d=identicon&r=PG&f=1", "display_name": "Tabraiz", "link": "https://stackoverflow.com/users/7220123/tabraiz"}, "edited": false, "score": 0, "creation_date": 1480511880, "post_id": 40885769, "comment_id": 68992365, "body": "Shai Rado i am using excel 2016 so is there something wrong with file format?"}, {"owner": {"reputation": 11, "user_id": 7220123, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/930da4d7f555d8123e0acabf31ead518?s=128&d=identicon&r=PG&f=1", "display_name": "Tabraiz", "link": "https://stackoverflow.com/users/7220123/tabraiz"}, "edited": false, "score": 0, "creation_date": 1480514445, "post_id": 40885769, "comment_id": 68994204, "body": "Shai Rado ActiveWorkbook.SaveAs filename:=fName, FileFormat:=51"}, {"owner": {"reputation": 11, "user_id": 7220123, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/930da4d7f555d8123e0acabf31ead518?s=128&d=identicon&r=PG&f=1", "display_name": "Tabraiz", "link": "https://stackoverflow.com/users/7220123/tabraiz"}, "edited": false, "score": 0, "creation_date": 1480514500, "post_id": 40885769, "comment_id": 68994255, "body": "I am getting error on line :  ActiveWorkbook.SaveAs filename:=fName, FileFormat:=51"}], "tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": false, "score": 0, "last_activity_date": 1480502124, "last_edit_date": 1480502124, "creation_date": 1480501207, "answer_id": 40885769, "question_id": 40883581, "link": "https://stackoverflow.com/questions/40883581/runtime-error-1004-document-not-saved-with-vba-excel-2016/40885769#40885769", "title": "Runtime error 1004 document not saved with Vba Excel 2016", "body": "<p><code>fName</code> is a <code>String</code>, therefore you can't compare it with <code>False</code>, but with <code>\"False\"</code>.</p>\n\n<p>Try replacing the last section of your code with the lines below:</p>\n\n<pre><code>fName = Application.GetSaveAsFilename(InitialFileName:=DName, _\n        fileFilter:=\"Excel Files (*.XLSX), *.XLSX\", Title:=\"Save As\")\n\nIf fName &lt;&gt; \"False\" Then\n    Application.DisplayAlerts = False\n    ActiveWorkbook.SaveAs Filename:=fName, FileFormat:=51\nElse\n    MsgBox \"No File was selected !\"\n    Exit Sub\nEnd If\n\nApplication.DisplayAlerts = True\n</code></pre>\n\n<p><strong>Note</strong>: using <code>FileFormat:=51</code>, means <code>xlOpenXMLWorkbook</code>, an .xlsx format (without MACROs).</p>\n\n<p><strong>However</strong> since you want to use the <code>SaveAs</code> command with <code>ThisWorkbook</code>, which contains this code, you will get a prompt screen that asks if you want to save it as <code>.xslx</code> , which means all your code will be lost. </p>\n\n<p>You can select <code>FileFormat:=52</code>, means <code>xlOpenXMLWorkbookMacroEnabled</code>, an .xlsm format (<strong>with MACROs</strong>).</p>\n"}], "owner": {"reputation": 11, "user_id": 7220123, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/930da4d7f555d8123e0acabf31ead518?s=128&d=identicon&r=PG&f=1", "display_name": "Tabraiz", "link": "https://stackoverflow.com/users/7220123/tabraiz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2570, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1537948480, "creation_date": 1480494716, "last_edit_date": 1480494924, "question_id": 40883581, "link": "https://stackoverflow.com/questions/40883581/runtime-error-1004-document-not-saved-with-vba-excel-2016", "title": "Runtime error 1004 document not saved with Vba Excel 2016", "body": "<p>I am getting a <code>Runtime error 1004 document not saved</code> using vba when I want to save an Excel workbook in my folder on desktop. Here are the details of my code:</p>\n\n<pre><code>Private Sub Save_Click()\n\n'Popup the Window \"Save As\"\n\nApplication.DisplayAlerts = False\n\n\nMsgBox \"Do not change the default file name proposed on the next step please !\"\n\nDim fName As Variant\n\nDim DName As String  ' Variable storing name of excel workbook which has to be saved\n\nDName = UserForm.CustomerApplication.Value &amp; \" - \" &amp; UserForm.L2GType.Value\n\n&amp; \" - \" &amp; UserForm.Title.Value &amp; \" - \" &amp; UserForm.Country.Value &amp; \"(\" &amp; \n\nYear(Date) &amp; \")\"\n\nfName = Application.GetSaveAsFilename(InitialFileName:=DName, _\n\nFileFilter:=\"Excel Files (*.XLSX), *.XLSX\", Title:=\"Save As\")\n\nIf fName = False Then\n\n Exit Sub\n\nActiveWorkbook.SaveAs filename:=fName, FileFormat:=51\n\nActiveWorkbook.Close\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["oracle", "vba", "odbc", "driver", "instantclient"], "comments": [{"owner": {"reputation": 3194, "user_id": 4991677, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/7dabe78477c4b3697c3284fb556b1eca?s=128&d=identicon&r=PG&f=1", "display_name": "FDavidov", "link": "https://stackoverflow.com/users/4991677/fdavidov"}, "edited": false, "score": 0, "creation_date": 1480494504, "post_id": 40883422, "comment_id": 68981086, "body": "Not a solution for your problem but.... Are you aware that you can send e-mails directly from Oracle (both plain text as well as full HTML documents)?"}], "answers": [{"tags": [], "owner": {"reputation": 38299, "user_id": 3027266, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3249486ec6096e443cb8e93489fe0a09?s=128&d=identicon&r=PG&f=1", "display_name": "Wernfried Domscheit", "link": "https://stackoverflow.com/users/3027266/wernfried-domscheit"}, "is_accepted": false, "score": 1, "last_activity_date": 1480498066, "creation_date": 1480498066, "answer_id": 40884583, "question_id": 40883422, "link": "https://stackoverflow.com/questions/40883422/oracle-instant-client-12-1-odbc-run-time-error/40884583#40884583", "title": "Oracle instant client 12_1 + odbc Run-time Error", "body": "<p>What do you mean by \"created the <code>tnsnames.ora</code>-file in the same directory\"</p>\n\n<p>Location of <code>tnsnames.ora</code> file can be determined by several ways:</p>\n\n<ul>\n<li>Directory where your running <code>.exe</code> file resides. (Most likely not a smart idea for MS-Access program folder)</li>\n<li>Your current working directory</li>\n<li>Folder as specified by Environment Variable <code>TNS_ADMIN</code></li>\n<li>Folder as specified in Registry value <code>HKLM\\SOFTWARE\\Wow6432Node\\ORACLE\\KEY_OraClient12_1_home1\\TNS_ADMIN</code> (or similar)</li>\n<li>Folder <code>%ORACLE_HOME%\\network\\admin</code>, i.e. <code>C:\\Oracle\\instantclient_12_1\\network\\admin</code></li>\n</ul>\n\n<p>I don't know whether all of these conditions apply for ODBC, also I don't know the order of precedence, I never found any documentation about that.</p>\n\n<p>You should check all of them, usually Environment Variable <code>TNS_ADMIN</code> has highest precedence.</p>\n\n<p>Actually I don't know whether Connection-String is case-sensitive. Try <code>DBQ</code> instead of <code>Dbq</code></p>\n\n<p>btw, did you remove the 64-bit Oracle Client again? If not then your <code>PATH</code> variable may still point to 64-bit client which will not work with 32-bit Access and 32-bit ODBC driver.</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 7229541, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7bb7463ef8c2873583c58aa9ce28a6e9?s=128&d=identicon&r=PG&f=1", "display_name": "Marke", "link": "https://stackoverflow.com/users/7229541/marke"}, "is_accepted": false, "score": 0, "last_activity_date": 1480501009, "creation_date": 1480501009, "answer_id": 40885683, "question_id": 40883422, "link": "https://stackoverflow.com/questions/40883422/oracle-instant-client-12-1-odbc-run-time-error/40885683#40885683", "title": "Oracle instant client 12_1 + odbc Run-time Error", "body": "<p>Thanks, Wernfried! You got me to the right direction!</p>\n\n<p>I didn't create the environment variables at the other computers:</p>\n\n<p>Oracle_Home -> Path to the folder e.g. C:\\Oracle\\instantclient_12_1\nTNS_ADMIN -> Path to the tnsnames.ora file e.g. C:\\Oracle\\instantclient_12_1\\network (or wherever you saved it!)</p>\n\n<p>now restart.</p>\n\n<p>The connection in the code (for me vba) will now find the tnsnames file and be able to resolve the connection string to the databank.</p>\n"}], "owner": {"reputation": 1, "user_id": 7229541, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7bb7463ef8c2873583c58aa9ce28a6e9?s=128&d=identicon&r=PG&f=1", "display_name": "Marke", "link": "https://stackoverflow.com/users/7229541/marke"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 845, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1480501009, "creation_date": 1480494120, "question_id": 40883422, "link": "https://stackoverflow.com/questions/40883422/oracle-instant-client-12-1-odbc-run-time-error", "title": "Oracle instant client 12_1 + odbc Run-time Error", "body": "<p>At work I programmed a little something in access vba to automatically create mails and send them out. To get all the information needed, I need to get access to a server of my company. \nEverything worked for me: Programmed the vba, installed oracle instant client 12_1 and the odbc part both in <code>C:\\Oracle\\instantclient_12_1</code> (both 32bit), installed the <code>odbc_install.exe</code> and created the <code>tnsnames.ora</code>-file in the same directory.</p>\n\n<p>When I try to do the same for my colleagues, eventually the:\n<code>Run-time Error '-2147467259 (80004005) [Microsoft][ODBC Driver Manager] Data source name not found and no default driver specified</code>\nappears.</p>\n\n<p>I have absolutely no idea why. Tried to install 64bit driver, which can clearly not work :P Tried to change the connection strings in vba and the tnsnames.ora file...</p>\n\n<p>I did not yet create a user-dsn connection, which I really want to avoid doing and was not really necessary.</p>\n\n<p>Do you have an idea what could be the problem or how I can fix this?</p>\n\n<p>.</p>\n\n<p>.</p>\n\n<p>Here are the connection strings I used in vba:</p>\n\n<p><code>Set CMDB_cn = New ADODB.Connection\nSet CMDB_rst = New ADODB.Recordset\nDim strConnect, str1 As String\nstrConnect = \"Driver={Oracle in instantclient_12_1};Dbq=blabla;Uid=user;Pwd=swordfish;\"\nstr1 = \"select * From db.table WHERE Name = 'Mr. Nobody';\"\nCMDB_cn.Open strConnect</code></p>\n\n<p>And tnsnames.ora:</p>\n\n<pre><code>blabla=(DESCRIPTION=(ADDRESS_LIST=(ADDRESS=(PROTOCOL=TCP)(HOST=123.456.789.123)(PORT=1234)))(CONNECT_DATA=(SID=serverName)(SERVER=DEDICATED)))\n</code></pre>\n"}, {"tags": ["excel", "vba", "macros", "hex", "decimal"], "comments": [{"owner": {"reputation": 4067, "user_id": 2970789, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dd4ed57e10989bdb3f3ac58326b7354?s=128&d=identicon&r=PG&f=1", "display_name": "Ambie", "link": "https://stackoverflow.com/users/2970789/ambie"}, "edited": false, "score": 1, "creation_date": 1480491593, "post_id": 40882463, "comment_id": 68979640, "body": "If you want the answer to show leading zeros, you could use the <code>Places</code> option, eg <code>=DEC2HEX(B5, 9)</code>."}, {"owner": {"reputation": 211, "user_id": 7229377, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/805e74a482523cbba74d67f66f9cec41?s=128&d=identicon&r=PG&f=1", "display_name": "Jeeva", "link": "https://stackoverflow.com/users/7229377/jeeva"}, "reply_to_user": {"reputation": 4067, "user_id": 2970789, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dd4ed57e10989bdb3f3ac58326b7354?s=128&d=identicon&r=PG&f=1", "display_name": "Ambie", "link": "https://stackoverflow.com/users/2970789/ambie"}, "edited": false, "score": 0, "creation_date": 1480491887, "post_id": 40882463, "comment_id": 68979786, "body": "hi Ambie, yea, i have tried that solutions too but no luck"}, {"owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 0, "creation_date": 1480492112, "post_id": 40882463, "comment_id": 68979896, "body": "Why do you say B26801FB is a wrong value?"}, {"owner": {"reputation": 211, "user_id": 7229377, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/805e74a482523cbba74d67f66f9cec41?s=128&d=identicon&r=PG&f=1", "display_name": "Jeeva", "link": "https://stackoverflow.com/users/7229377/jeeva"}, "reply_to_user": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 0, "creation_date": 1480492538, "post_id": 40882463, "comment_id": 68980084, "body": "@VincentG , Initially 0B26801FB is converted to decimal by using =HEX2DEC formula. By using that i get 2993160699. However when i want reconvert back to hexadecimal, i get B26801FB where the zero is missing."}, {"owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 0, "creation_date": 1480493542, "post_id": 40882463, "comment_id": 68980583, "body": "Leading zero are usually meaningless. If you want to force them, you need to use the answer provided by Ambie or David, with the correct number of places (in your case, 9). If you want to keep the original formatting, you will need to memorize it somewhere. If you want to have only one leading zero, whatever the length of the string is, there is ways to do that too (for example <code>=IF(B5=0;&quot;0&quot;;DEC2HEX(B5;LEN(DEC2HEX(B5))+1))</code>)"}], "answers": [{"comments": [{"owner": {"reputation": 211, "user_id": 7229377, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/805e74a482523cbba74d67f66f9cec41?s=128&d=identicon&r=PG&f=1", "display_name": "Jeeva", "link": "https://stackoverflow.com/users/7229377/jeeva"}, "edited": false, "score": 0, "creation_date": 1480491158, "post_id": 40882502, "comment_id": 68979413, "body": "Hi david, i plan to not add a code for this. plan to do by using formula. However i will be really appreciate there is code for this. For more information, i have uploaded the pic on my question above."}, {"owner": {"reputation": 333, "user_id": 3876115, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/sbyA2.png?s=128&g=1", "display_name": "David", "link": "https://stackoverflow.com/users/3876115/david"}, "reply_to_user": {"reputation": 211, "user_id": 7229377, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/805e74a482523cbba74d67f66f9cec41?s=128&d=identicon&r=PG&f=1", "display_name": "Jeeva", "link": "https://stackoverflow.com/users/7229377/jeeva"}, "edited": false, "score": 0, "creation_date": 1480491738, "post_id": 40882502, "comment_id": 68979708, "body": "@Jeeva i have edit my answer. Take a look if it runs."}, {"owner": {"reputation": 211, "user_id": 7229377, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/805e74a482523cbba74d67f66f9cec41?s=128&d=identicon&r=PG&f=1", "display_name": "Jeeva", "link": "https://stackoverflow.com/users/7229377/jeeva"}, "edited": false, "score": 0, "creation_date": 1480492054, "post_id": 40882502, "comment_id": 68979865, "body": "But there is 2 zeros infront. The answer should be 0B26801FB. By the way what is the cell format?"}, {"owner": {"reputation": 333, "user_id": 3876115, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/sbyA2.png?s=128&g=1", "display_name": "David", "link": "https://stackoverflow.com/users/3876115/david"}, "reply_to_user": {"reputation": 211, "user_id": 7229377, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/805e74a482523cbba74d67f66f9cec41?s=128&d=identicon&r=PG&f=1", "display_name": "Jeeva", "link": "https://stackoverflow.com/users/7229377/jeeva"}, "edited": false, "score": 0, "creation_date": 1480492641, "post_id": 40882502, "comment_id": 68980129, "body": "I have writed it @Jeeva, see my answer please. You can change the number after the cell. Change 10 by 9 only."}, {"owner": {"reputation": 211, "user_id": 7229377, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/805e74a482523cbba74d67f66f9cec41?s=128&d=identicon&r=PG&f=1", "display_name": "Jeeva", "link": "https://stackoverflow.com/users/7229377/jeeva"}, "edited": false, "score": 0, "creation_date": 1480492692, "post_id": 40882502, "comment_id": 68980157, "body": "Initially 0B26801FB is converted to decimal by using =HEX2DEC formula. By using that i get 2993160699. However when i want reconvert back to hexadecimal, i get B26801FB where the zero is missing."}, {"owner": {"reputation": 333, "user_id": 3876115, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/sbyA2.png?s=128&g=1", "display_name": "David", "link": "https://stackoverflow.com/users/3876115/david"}, "reply_to_user": {"reputation": 211, "user_id": 7229377, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/805e74a482523cbba74d67f66f9cec41?s=128&d=identicon&r=PG&f=1", "display_name": "Jeeva", "link": "https://stackoverflow.com/users/7229377/jeeva"}, "edited": false, "score": 0, "creation_date": 1480492715, "post_id": 40882502, "comment_id": 68980168, "body": "It runs ok in my excel. Pease dont forget to accept my answer. Thanks."}, {"owner": {"reputation": 211, "user_id": 7229377, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/805e74a482523cbba74d67f66f9cec41?s=128&d=identicon&r=PG&f=1", "display_name": "Jeeva", "link": "https://stackoverflow.com/users/7229377/jeeva"}, "edited": false, "score": 0, "creation_date": 1480493444, "post_id": 40882502, "comment_id": 68980538, "body": "its working now. Seems that both type data is must be general. Thanks"}], "tags": [], "owner": {"reputation": 333, "user_id": 3876115, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/sbyA2.png?s=128&g=1", "display_name": "David", "link": "https://stackoverflow.com/users/3876115/david"}, "is_accepted": true, "score": 0, "last_activity_date": 1480491710, "last_edit_date": 1480491710, "creation_date": 1480490531, "answer_id": 40882502, "question_id": 40882463, "link": "https://stackoverflow.com/questions/40882463/excel-change-from-decimal-to-hexadecimal/40882502#40882502", "title": "Excel - Change from Decimal to Hexadecimal", "body": "<p>You can format the return of the value with a number of positions.</p>\n\n<pre><code>=DEC2HEX(B5;NUMBER_POSITIONS)\n\n=DEC2HEX(B5;9)\n</code></pre>\n\n<p>Take a look the picture...</p>\n\n<p><a href=\"https://i.stack.imgur.com/vI6X8.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/vI6X8.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 211, "user_id": 7229377, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/805e74a482523cbba74d67f66f9cec41?s=128&d=identicon&r=PG&f=1", "display_name": "Jeeva", "link": "https://stackoverflow.com/users/7229377/jeeva"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 656, "favorite_count": 0, "closed_date": 1480511284, "accepted_answer_id": 40882502, "answer_count": 1, "score": -1, "last_activity_date": 1480492748, "creation_date": 1480490334, "last_edit_date": 1480492748, "question_id": 40882463, "link": "https://stackoverflow.com/questions/40882463/excel-change-from-decimal-to-hexadecimal", "closed_reason": "Not suitable for this site", "title": "Excel - Change from Decimal to Hexadecimal", "body": "<p>I'm creating a simple program where to convert decimal to hexadecimal. However while converting using =DEC2HEX(B5), i get the answer of B26801FB. However the correct answer is 0B26801FB where the zero in front the string is missing. The B5 value is 2993160699 in the General format.</p>\n\n<p>I have tested using all the format but i dint get 0B26801FB. Please Help</p>\n\n<p><img src=\"https://i.stack.imgur.com/nU9PB.jpg\" alt=\"image\"></p>\n"}, {"tags": ["excel", "database", "vba", "ms-access"], "comments": [{"owner": {"reputation": 27, "user_id": 6856358, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/1284069181605389/picture?type=large", "display_name": "Ibrahim Al Rosid", "link": "https://stackoverflow.com/users/6856358/ibrahim-al-rosid"}, "edited": false, "score": 0, "creation_date": 1480490876, "post_id": 40882459, "comment_id": 68979292, "body": "this is working too without writing in the excel sheets...                 .AddNew                 .Fields(&quot;username&quot;) = login2.operatorname.Value                 .Update"}], "answers": [{"tags": [], "owner": {"reputation": 22511, "user_id": 1599619, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/KJvfU.jpg?s=128&g=1", "display_name": "Chris Travers", "link": "https://stackoverflow.com/users/1599619/chris-travers"}, "is_accepted": true, "score": 0, "last_activity_date": 1480492733, "creation_date": 1480492733, "answer_id": 40883071, "question_id": 40882459, "link": "https://stackoverflow.com/questions/40882459/make-a-login-system-using-vba-with-access-database/40883071#40883071", "title": "Make a Login System using VBA with Access Database", "body": "<p>If you are tying Excel to Access, then bypassing that will be trivial.  So I assume you are not trying to enforce security using Access from excel with this method.</p>\n\n<p>If you are then you need to go back to the drawing board.  You cannot store the credentials in Access and then expect to use them to enforce security later.  Instead, you need to spend some time re-architecting your solution around:</p>\n\n<ul>\n<li>The security wizard</li>\n<li>MS Access users</li>\n<li>MS Access groups</li>\n</ul>\n\n<p>In addition I would STRONGLY recommend hashing the password with a salt so that it can be tested but not read.  As it is anyone with Excel can probably read the passwords of the users.</p>\n"}], "owner": {"reputation": 27, "user_id": 6856358, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/1284069181605389/picture?type=large", "display_name": "Ibrahim Al Rosid", "link": "https://stackoverflow.com/users/6856358/ibrahim-al-rosid"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 683, "favorite_count": 0, "accepted_answer_id": 40883071, "answer_count": 1, "score": 0, "last_activity_date": 1593957585, "creation_date": 1480490319, "last_edit_date": 1593957585, "question_id": 40882459, "link": "https://stackoverflow.com/questions/40882459/make-a-login-system-using-vba-with-access-database", "title": "Make a Login System using VBA with Access Database", "body": "<p><a href=\"https://i.stack.imgur.com/DXcFH.jpg\" rel=\"nofollow noreferrer\">userform for login existing account</a></p>\n\n<p><a href=\"https://i.stack.imgur.com/ZBnyy.jpg\" rel=\"nofollow noreferrer\">access database table</a></p>\n\n<p>as the image links above, i want to ask about how to connect excel and access database. I will make some points about my problems:</p>\n\n<blockquote>\n  <ul>\n  <li>there are 2 buttons, \"Login\" and \"New Account\". For Login, it should be validating both username and password from \"login\" table, then the fullname of user will be copied.</li>\n  <li>Login for existed user will have a combobox, where they can find their username but not the password. </li>\n  <li>for the \"new account\" button, it will ask new username, new fullname, and new password(cant post more than 2 photos rn). I still can figured it out how to do that</li>\n  </ul>\n</blockquote>\n\n<pre><code>Dim cn As ADODB.Connection, rs As ADODB.Recordset, r As Long\n\n    Set cn = New ADODB.Connection\n    cn.Open \"Provider=Microsoft.ACE.OLEDB.12.0;\" &amp; _\n    \"Data Source=E:\\Digital QC Project\\Database.accdb;\"\n\n    Set rs = New ADODB.Recordset\n    rs.Open \"login\", cn, adOpenKeyset, adLockOptimistic, adCmdTable\n\n    With rs\n            .AddNew\n            .Fields(\"username\") = Range(\"A4\").Value\n            .Fields(\"password\") = Range(\"B4\").Value\n            .Fields(\"fullname\") = Range(\"C4\").Value\n            .Update\n    End With\n\n    rs.Close\n    Set rs = Nothing\n    cn.Close\n    Set cn = Nothing\n</code></pre>\n\n<p>is that possible to work on first and second point?\nthanks stackoverflow!</p>\n"}, {"tags": ["sql-server", "vba", "ms-access", "dao", "ms-access-2016"], "comments": [{"owner": {"reputation": 88348, "user_id": 2548, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adb9f3f81dc0b13a7339a10d0abedbfc?s=128&d=identicon&r=PG", "display_name": "Fionnuala", "link": "https://stackoverflow.com/users/2548/fionnuala"}, "edited": false, "score": 0, "creation_date": 1480490267, "post_id": 40882237, "comment_id": 68979007, "body": "Perhaps you would like to ad your references?"}], "answers": [{"comments": [{"owner": {"reputation": 443, "user_id": 1045151, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/2oguu.jpg?s=128&g=1", "display_name": "Sham Yemul", "link": "https://stackoverflow.com/users/1045151/sham-yemul"}, "edited": false, "score": 0, "creation_date": 1480596212, "post_id": 40893016, "comment_id": 69034110, "body": "so if I have  reference of Microsoft Office 16.0 Access database engine Object Library. I can declare DAO.Recordset ?"}, {"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "reply_to_user": {"reputation": 443, "user_id": 1045151, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/2oguu.jpg?s=128&g=1", "display_name": "Sham Yemul", "link": "https://stackoverflow.com/users/1045151/sham-yemul"}, "edited": false, "score": 0, "creation_date": 1480599205, "post_id": 40893016, "comment_id": 69036098, "body": "Yes, just proceed."}, {"owner": {"reputation": 443, "user_id": 1045151, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/2oguu.jpg?s=128&g=1", "display_name": "Sham Yemul", "link": "https://stackoverflow.com/users/1045151/sham-yemul"}, "edited": false, "score": 0, "creation_date": 1480674764, "post_id": 40893016, "comment_id": 69070984, "body": "for aceDAO recordset the explicit declaration would be DAO.Recordset I checked and confirmed."}], "tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": true, "score": 0, "last_activity_date": 1480522292, "creation_date": 1480522292, "answer_id": 40893016, "question_id": 40882237, "link": "https://stackoverflow.com/questions/40882237/explicit-declaration-of-acedao-recordset-in-microsoft-access-2016-vba/40893016#40893016", "title": "Explicit declaration of aceDAO recordset in Microsoft Access 2016 VBA", "body": "<p>The object type is <code>DAO</code> and the reference is <em>Microsoft Office 16.0 Access database engine Object Library</em>.</p>\n"}], "owner": {"reputation": 443, "user_id": 1045151, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/2oguu.jpg?s=128&g=1", "display_name": "Sham Yemul", "link": "https://stackoverflow.com/users/1045151/sham-yemul"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 687, "favorite_count": 0, "accepted_answer_id": 40893016, "answer_count": 1, "score": 0, "last_activity_date": 1513002228, "creation_date": 1480489518, "last_edit_date": 1513002228, "question_id": 40882237, "link": "https://stackoverflow.com/questions/40882237/explicit-declaration-of-acedao-recordset-in-microsoft-access-2016-vba", "title": "Explicit declaration of aceDAO recordset in Microsoft Access 2016 VBA", "body": "<p>I have project that uses Microsoft SQL Server 2012 Express as backend and Access 2016 as front-end. My previous code was in Access 2003 and SQL Server 2000 database. Now I migrated backend to SQL Server 2012 Express. Also converted the .mdb to .accdb file format. I had recordsets of DAO as well as ADO in my project. The software is installed on several nodes at my client's place. To make it easier for the recordset declaration I used DAO.recordset and ADO.Recordset, I do have DAO reference prior to ADO reference in the reference window of VBA code. But now when I upgraded to Access 2016 I wanted to use aceDAO recordset instead of DAO. </p>\n\n<p>I am trying to find-out explicit declaration syntax for aceDAO recordset I tried </p>\n\n<pre><code>Dim recPayment as aceDAO.Recordset \n</code></pre>\n\n<p>I am getting compile error \"User-defined type not defined\"</p>\n\n<p>I can not rely on priority of references in reference window of VBA, sometimes they are changed at client's machine if something is broken. And this will surely give me problem.</p>\n"}, {"tags": ["vba", "combobox"], "answers": [{"comments": [{"owner": {"reputation": 305, "user_id": 6789922, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/ce93c7043b20cc43e4cb0b85648282ed?s=128&d=identicon&r=PG&f=1", "display_name": "speedyraz", "link": "https://stackoverflow.com/users/6789922/speedyraz"}, "edited": false, "score": 0, "creation_date": 1480485178, "post_id": 40881125, "comment_id": 68976850, "body": "thanks @tim , it works  , but how if i want to show values alphabetically / ascending order ."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 305, "user_id": 6789922, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/ce93c7043b20cc43e4cb0b85648282ed?s=128&d=identicon&r=PG&f=1", "display_name": "speedyraz", "link": "https://stackoverflow.com/users/6789922/speedyraz"}, "edited": false, "score": 0, "creation_date": 1480485317, "post_id": 40881125, "comment_id": 68976891, "body": "Then you&#39;ll need to sort the arrays before assigning them to the <code>List</code> property.  Plenty of examples of sorting in VBA to be found via Google.  E.g.: <a href=\"http://stackoverflow.com/questions/152319/vba-array-sort-function\" title=\"vba array sort function\">stackoverflow.com/questions/152319/vba-array-sort-function</a> (plenty of choice there)"}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 1, "last_activity_date": 1480485236, "last_edit_date": 1480485236, "creation_date": 1480484530, "answer_id": 40881125, "question_id": 40880597, "link": "https://stackoverflow.com/questions/40880597/vba-auto-populate-unique-values-in-2nd-combobox-based-on-1st-combobox-data/40881125#40881125", "title": "VBA .Auto populate unique values in 2nd combobox based on 1st combobox data", "body": "<p>While populating your dictionary you need to check whether the set of values for the current key already contains the current value.</p>\n\n<p>I would use arrays to hold the various values from ColB for each key:</p>\n\n<pre><code>Option Explicit\n\nDim Dic As Object\n\nPrivate Sub ComboBox1_Change()\n    With ComboBox2\n        .List = Dic.Item(ComboBox1.Value)\n        .Value = \"\" '### clear any previous selection\n    End With\nEnd Sub\n\nPrivate Sub ComboBox1_DropButtonClick()\n\n    Dim rng As Range\n    Dim Dn As Range, arr, v\n\n    Set rng = Sheet2.Range(\"A2\", Sheet2.Cells(Rows.Count, \"A\").End(xlUp))\n\n    Set Dic = CreateObject(\"scripting.dictionary\")\n    Dic.CompareMode = vbTextCompare\n    For Each Dn In rng\n\n        v = Dn.Offset(0, 1)\n\n        If Not Dic.exists(Dn.Value) Then\n            Dic.Add Dn.Value, Array(v)\n        Else\n            arr = Dic(Dn.Value)\n            'no match will return an error value: test for this\n            If IsError(Application.Match(v, arr, 0)) Then\n                ReDim Preserve arr(UBound(arr) + 1)\n                arr(UBound(arr)) = v\n                Dic(Dn.Value) = arr 'replace with expanded array\n            End If\n        End If\n\n    Next\n\n    ComboBox1.List = Dic.keys\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 305, "user_id": 6789922, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/ce93c7043b20cc43e4cb0b85648282ed?s=128&d=identicon&r=PG&f=1", "display_name": "speedyraz", "link": "https://stackoverflow.com/users/6789922/speedyraz"}, "edited": false, "score": 0, "creation_date": 1480486188, "post_id": 40881387, "comment_id": 68977211, "body": "thanks @ thomas  , but values in second combobox should be unique ."}, {"owner": {"reputation": 305, "user_id": 6789922, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/ce93c7043b20cc43e4cb0b85648282ed?s=128&d=identicon&r=PG&f=1", "display_name": "speedyraz", "link": "https://stackoverflow.com/users/6789922/speedyraz"}, "edited": false, "score": 0, "creation_date": 1480489661, "post_id": 40881387, "comment_id": 68978729, "body": "hi Thomas , it gives &quot;run time error 91 : - failed to compare the two elements in array&quot;  on   oDictionary(ComboBox1.Text).Sort  under combobox1_change ."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "reply_to_user": {"reputation": 305, "user_id": 6789922, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/ce93c7043b20cc43e4cb0b85648282ed?s=128&d=identicon&r=PG&f=1", "display_name": "speedyraz", "link": "https://stackoverflow.com/users/6789922/speedyraz"}, "edited": false, "score": 0, "creation_date": 1480490037, "post_id": 40881387, "comment_id": 68978901, "body": "@speedyraz you must have mixed data (Strings and Numbers) values types in column B.  You could cast them all to strings but it will not sort correctly.  You&#39;ll have to use another solution."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "reply_to_user": {"reputation": 305, "user_id": 6789922, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/ce93c7043b20cc43e4cb0b85648282ed?s=128&d=identicon&r=PG&f=1", "display_name": "speedyraz", "link": "https://stackoverflow.com/users/6789922/speedyraz"}, "edited": false, "score": 0, "creation_date": 1480490440, "post_id": 40881387, "comment_id": 68979094, "body": "@speedyraz If all the values in column B are supposed to be numeric then you can cast them using <code>oDictionary(r.Text).Add CDbl(r.Offset(0, 1).Value)</code>  and it will work properly."}, {"owner": {"reputation": 305, "user_id": 6789922, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/ce93c7043b20cc43e4cb0b85648282ed?s=128&d=identicon&r=PG&f=1", "display_name": "speedyraz", "link": "https://stackoverflow.com/users/6789922/speedyraz"}, "edited": false, "score": 0, "creation_date": 1480652339, "post_id": 40881387, "comment_id": 69060994, "body": "hi @Thomas  , for numeric values in combobox1 giving list index = -1 ,  so accordingly code not working , how to deal with it ? So that irrespective to type of list values of combobox1 , it shows corresponding values in combobox 2 ."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "reply_to_user": {"reputation": 305, "user_id": 6789922, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/ce93c7043b20cc43e4cb0b85648282ed?s=128&d=identicon&r=PG&f=1", "display_name": "speedyraz", "link": "https://stackoverflow.com/users/6789922/speedyraz"}, "edited": false, "score": 0, "creation_date": 1480659343, "post_id": 40881387, "comment_id": 69063178, "body": "If <code>ComboBox1.ListIndex &gt; -1</code> then there isn&#39;t an exact match in the <code>ComboBox1.List</code> but you can change <code>If ComboBox1.ListIndex &gt; -1 Then</code> to <code>If oDictionary.Exists(ComboBox1.Text). Then</code>."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "reply_to_user": {"reputation": 305, "user_id": 6789922, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/ce93c7043b20cc43e4cb0b85648282ed?s=128&d=identicon&r=PG&f=1", "display_name": "speedyraz", "link": "https://stackoverflow.com/users/6789922/speedyraz"}, "edited": false, "score": 0, "creation_date": 1480659620, "post_id": 40881387, "comment_id": 69063301, "body": "@speedyraz I just tested the code it seems to work fine.  If you can link me the workbook using a service like DropBox or Google Docs then I&#39;ll debug it for you."}, {"owner": {"reputation": 305, "user_id": 6789922, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/ce93c7043b20cc43e4cb0b85648282ed?s=128&d=identicon&r=PG&f=1", "display_name": "speedyraz", "link": "https://stackoverflow.com/users/6789922/speedyraz"}, "edited": false, "score": 0, "creation_date": 1480670936, "post_id": 40881387, "comment_id": 69068583, "body": "thanks @Thomas , It worked . thanks again ..... But can you tall me , Why numeric values gives -1 as list index ??"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "reply_to_user": {"reputation": 305, "user_id": 6789922, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/ce93c7043b20cc43e4cb0b85648282ed?s=128&d=identicon&r=PG&f=1", "display_name": "speedyraz", "link": "https://stackoverflow.com/users/6789922/speedyraz"}, "edited": false, "score": 0, "creation_date": 1480683893, "post_id": 40881387, "comment_id": 69076703, "body": "The listindex is the index of the selected item in a list (combobox or listbox).  When a list is a 0 based array of values.  They are initiated at -1 to indicate that there is no selected value.  If you want to unselect all the items in a list you set it&#39;s listindex to -1.  When you type a value into a combobox to matches its list that value automatically gets selected. So if a combobox has a listindex of -1 then there isn&#39;t a matching value.  If a combobox.value will return the value typed into its text area or an empty string, if blank.  I listbox with a listindex of -1 returns null."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "is_accepted": true, "score": 1, "last_activity_date": 1480487431, "last_edit_date": 1480487431, "creation_date": 1480485754, "answer_id": 40881387, "question_id": 40880597, "link": "https://stackoverflow.com/questions/40880597/vba-auto-populate-unique-values-in-2nd-combobox-based-on-1st-combobox-data/40881387#40881387", "title": "VBA .Auto populate unique values in 2nd combobox based on 1st combobox data", "body": "<p><a href=\"https://i.stack.imgur.com/hEQJO.gif\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/hEQJO.gif\" alt=\"enter image description here\"></a></p>\n\n<h2>Fill Comboboxes using a Dictionary of ArrayList</h2>\n\n<pre><code>Private oDictionary As Object\n\nSub RefreshComboBoxes()\n    Dim r As Range\n    Dim list As Object\n    Set oDictionary = CreateObject(\"Scripting.Dictionary\")\n\n    With Sheet1\n        For Each r In .Range(\"A2\", .Cells(.Rows.Count, \"A\").End(xlUp))\n\n            If Not oDictionary.Exists(r.Text) Then\n                Set list = CreateObject(\"System.Collections.ArrayList\")\n                oDictionary.Add r.Text, list\n            End If\n            If Not oDictionary(r.Text).Contains(r.Offset(0, 1).Value) Then\n                oDictionary(r.Text).Add r.Offset(0, 1).Value\n            End If\n        Next\n    End With\n\n    ComboBox1.list = oDictionary.Keys\n    ComboBox2.Clear\n\nEnd Sub\n\n\nPrivate Sub ComboBox1_Change()\n    If ComboBox1.ListIndex &gt; -1 Then\n        ComboBox2.Clear\n        oDictionary(ComboBox1.Text).Sort\n        ComboBox2.list = oDictionary(ComboBox1.Text).ToArray\n    End If\nEnd Sub\n\nPrivate Sub UserForm_Initialize()\n    RefreshComboBoxes\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 305, "user_id": 6789922, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/ce93c7043b20cc43e4cb0b85648282ed?s=128&d=identicon&r=PG&f=1", "display_name": "speedyraz", "link": "https://stackoverflow.com/users/6789922/speedyraz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 823, "favorite_count": 0, "accepted_answer_id": 40881387, "answer_count": 2, "score": 0, "last_activity_date": 1589543933, "creation_date": 1480481681, "last_edit_date": 1589543933, "question_id": 40880597, "link": "https://stackoverflow.com/questions/40880597/vba-auto-populate-unique-values-in-2nd-combobox-based-on-1st-combobox-data", "title": "VBA .Auto populate unique values in 2nd combobox based on 1st combobox data", "body": "<p>I need to populate two combo boxes from excel sheet, the data will be like below:</p>\n\n<pre>\nColumn   | A Column B\n----------------------\nA | 1\nA | 2\nA | 3\nA | 3\nA | 5\nB |10\nB | 11\nB | 12\nA | 1 \nA | 5\nA | 2\n</pre>\n\n<p>So from the above data, one combo box should hold unique values A &amp; B.</p>\n\n<p>On selecting a value from the 1st combo box A or B, respective values should be populated in 2nd combo box.</p>\n\n<p>So the data should be like below:</p>\n\n<p>If A is selected in the 1st combo box, then 2nd combo box should only show the values 1,2,3,4 &amp; 5.\nIf B is selected in the 1st combo box, then 2nd combo box should only show the values 10,11 &amp; 12.</p>\n\n<p>for that i have following code  : -</p>\n\n<pre><code> Private Sub ComboBox1_Change()\n\n Dim rng As Range\n Set rng = Sheet2.Range(\"B2\", Sheet2.Cells(Rows.Count, \"b\").End(xlUp))\n\n Set oDictionary = CreateObject(\"Scripting.Dictionary\")\n Sheet1.ComboBox2.Clear\n\n With Sheet1.ComboBox2\nFor Each cel In rng\nIf ComboBox1.Value = cel.Offset(, -1).Value Then\n\n        oDictionary(cel.Value) = 0\n        .AddItem (cel.Value)\n\n    End If\n   Next cel\n   End With\n  End Sub\n\n\n  Private Sub ComboBox1_DropButtonClick()\n\n  Dim rng As Range\n\n\n\n Set rng = Sheet2.Range(\"A2\", Sheet2.Cells(Rows.Count, \"A\").End(xlUp))\n\n Set oDictionary = CreateObject(\"Scripting.Dictionary\") 'to put uniqe values     from rng variable to combo box1\n  With oDictionary\n  For Each cel In rng\n  If Not .exists(cel.Value) Then\n        .Add cel.Value, Nothing\n    End If\n  Next cel\n\nSheet1.ComboBox1.List = .keys\nEnd With\nEnd Sub\n</code></pre>\n\n<p>problem is that it combobox does not shows unique values .</p>\n\n<p>how  i can get unique values in combobox2 .</p>\n\n<p>you can ignore my coding and provide simplest way to do above said task ...</p>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 1, "creation_date": 1480480199, "post_id": 40880266, "comment_id": 68975199, "body": "At just a glace, I&#39;d imagine it&#39;s because the <code>TableName</code> is hard-coded. Is the error on the <code>ActiveWorkbook.PivotCaches.Create</code> line?"}, {"owner": {"reputation": 305, "user_id": 5280490, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/e9d908dc4437289101d602b3608afb31?s=128&d=identicon&r=PG&f=1", "display_name": "gerard baste", "link": "https://stackoverflow.com/users/5280490/gerard-baste"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1480480635, "post_id": 40880266, "comment_id": 68975338, "body": "Yes it is in that line, but why is the fact that the TableNAme hardcoded a bad thing?"}, {"owner": {"reputation": 4067, "user_id": 2970789, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dd4ed57e10989bdb3f3ac58326b7354?s=128&d=identicon&r=PG&f=1", "display_name": "Ambie", "link": "https://stackoverflow.com/users/2970789/ambie"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1480490941, "post_id": 40880266, "comment_id": 68979316, "body": "Agree with @Comintern, but you&#39;d also get that error if your computer didn&#39;t recognise the L1C1 notation. For example, English settings would need the notation as R1C1. So if you&#39;ve used the code on a different computer, this error could occur. As a test, try changing your cell references to absolute, eg &quot;A1:D1001&quot; for &quot;L1C1:L1001C4&quot; and &quot;A3&quot; for &quot;L3C1&quot;."}, {"owner": {"reputation": 530, "user_id": 5902659, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c6ed01eb79ca1012c98545e01aaca144?s=128&d=identicon&r=PG&f=1", "display_name": "user1", "link": "https://stackoverflow.com/users/5902659/user1"}, "edited": false, "score": 0, "creation_date": 1480498184, "post_id": 40880266, "comment_id": 68983322, "body": "dont do step 1. simply open a new worksheet, then select create pivot table. It will prompt you to select the range you want in your table. Do that via the record macro and it should work"}, {"owner": {"reputation": 305, "user_id": 5280490, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/e9d908dc4437289101d602b3608afb31?s=128&d=identicon&r=PG&f=1", "display_name": "gerard baste", "link": "https://stackoverflow.com/users/5280490/gerard-baste"}, "edited": false, "score": 0, "creation_date": 1480524021, "post_id": 40880266, "comment_id": 69001139, "body": "I tried Ambie and mo.h&#39;s solutions but it still doesn&#39;t work, I guess I&#39;ll have to study more about pivot tables and VBA to be able to fix it at some point."}], "owner": {"reputation": 305, "user_id": 5280490, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/e9d908dc4437289101d602b3608afb31?s=128&d=identicon&r=PG&f=1", "display_name": "gerard baste", "link": "https://stackoverflow.com/users/5280490/gerard-baste"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 78, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1480479942, "creation_date": 1480479833, "last_edit_date": 1480479942, "question_id": 40880266, "link": "https://stackoverflow.com/questions/40880266/what-is-wrong-with-this-recorded-macro", "title": "What is wrong with this recorded macro?", "body": "<p>I have just started learning VBA and I have tried to record a macro to see How Excel works. I recorded a simple task :</p>\n\n<ol>\n<li>I copied the range A1:D1001 in a sheet </li>\n<li>I created a pivot table from it </li>\n<li>I added a row field and a value</li>\n</ol>\n\n<p>When I stopped the recording and tried to run the macro, I received the following error message:</p>\n\n<p>\"Run Time Error 5 - Invalid Procedure Call or Argument\"</p>\n\n<p>I don't understand how it could happen since Excel itself wrote this macro.</p>\n\n<p>Here is the code:</p>\n\n<pre><code>Sub Macro2()\n'\n' Macro2 Macro\n'\n\n'\n    Range(\"A1:D1001\").Select\n    Sheets.Add\n    ActiveWorkbook.PivotCaches.Create(SourceType:=xlDatabase, SourceData:= _\n        \"Moz Keyword Explorer 'diy beaut!L1C1:L1001C4\", Version:= _\n        xlPivotTableVersion14).CreatePivotTable TableDestination:=\"Feuil1!L3C1\", _\n        TableName:=\"Tableau crois\u00e9 dynamique1\", DefaultVersion:= _\n        xlPivotTableVersion14\n    Sheets(\"Feuil1\").Select\n    Cells(3, 1).Select\n    With ActiveSheet.PivotTables(\"Tableau crois\u00e9 dynamique1\").PivotFields(\"Keyword\" _\n        )\n        .Orientation = xlRowField\n        .Position = 1\n    End With\n    ActiveSheet.PivotTables(\"Tableau crois\u00e9 dynamique1\").AddDataField ActiveSheet. _\n        PivotTables(\"Tableau crois\u00e9 dynamique1\").PivotFields(\"Max Volume\"), _\n        \"NB sur Max Volume\", xlCount\n    ExecuteExcel4Macro _\n        \"PIVOT.FIELD.PROPERTIES(\"\"Tableau crois\u00e9 dynamique1\"\",\"\"NB sur Max Volume\"\",,,2)\"\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 193, "user_id": 3321598, "user_type": "registered", "accept_rate": 53, "profile_image": "https://graph.facebook.com/518975326/picture?type=large", "display_name": "Gareth", "link": "https://stackoverflow.com/users/3321598/gareth"}, "edited": false, "score": 0, "creation_date": 1480481261, "post_id": 40879903, "comment_id": 68975513, "body": "Is there a way for the filename to not be in the macro so when I run the macro it asks me to choose which file I want to use?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 193, "user_id": 3321598, "user_type": "registered", "accept_rate": 53, "profile_image": "https://graph.facebook.com/518975326/picture?type=large", "display_name": "Gareth", "link": "https://stackoverflow.com/users/3321598/gareth"}, "edited": false, "score": 1, "creation_date": 1480481485, "post_id": 40879903, "comment_id": 68975587, "body": "You can use <code>Application.GetOpenFileName()</code> for that."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 193, "user_id": 3321598, "user_type": "registered", "accept_rate": 53, "profile_image": "https://graph.facebook.com/518975326/picture?type=large", "display_name": "Gareth", "link": "https://stackoverflow.com/users/3321598/gareth"}, "edited": false, "score": 0, "creation_date": 1480484955, "post_id": 40879903, "comment_id": 68976776, "body": "<a href=\"https://msdn.microsoft.com/en-us/library/office/hh710200(v=office.14).aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/office/&hellip;</a>"}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 1, "last_activity_date": 1480477409, "creation_date": 1480477409, "answer_id": 40879903, "question_id": 40879703, "link": "https://stackoverflow.com/questions/40879703/being-able-to-change-spreadsheet-in-vlookup-macro/40879903#40879903", "title": "Being able to change spreadsheet in VLOOKUP macro", "body": "<pre><code>Dim fName As String\n\nfName = \"Z401 Toyota 25 Nov 16.xlsx\"\n\nActiveCell.FormulaR1C1 = \"=VLOOKUP(RC[-11],'[\" &amp; fName &amp; _\n                          \"]MPF_D_PRI_RSK_20161122_092440_W'!C9:C10,2,0)\"\n</code></pre>\n"}], "owner": {"reputation": 193, "user_id": 3321598, "user_type": "registered", "accept_rate": 53, "profile_image": "https://graph.facebook.com/518975326/picture?type=large", "display_name": "Gareth", "link": "https://stackoverflow.com/users/3321598/gareth"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 23, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1480477409, "creation_date": 1480476155, "last_edit_date": 1531161705, "question_id": 40879703, "link": "https://stackoverflow.com/questions/40879703/being-able-to-change-spreadsheet-in-vlookup-macro", "title": "Being able to change spreadsheet in VLOOKUP macro", "body": "<p>I have a macro that does a VLOOKUP from a specific excel spreadsheet, it is current hard-coded into the macro. I was wondering if there is a way to make it so the specific excel spreadsheet can change (i.e. prompts me to select a spreadsheet then the VLOOKUP uses the new spreadsheet instead of the hard-coded one)?</p>\n\n<p>Here is a portion of the code which shows the hard-coded file:</p>\n\n<pre><code>ActiveCell.FormulaR1C1 = _\n        \"=VLOOKUP(RC[-11],'[Z401 Toyota 25 Nov 16.xlsx]MPF_D_PRI_RSK_20161122_092440_W'!C9:C10,2,0)\"\n</code></pre>\n\n<p>I'd like the filename in there to be interchangeable. Is this possible somehow through a variable?</p>\n\n<p>Thanks in advance.</p>\n"}, {"tags": ["excel", "vba", "restart", "autorest"], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "is_accepted": false, "score": 0, "last_activity_date": 1480477312, "creation_date": 1480477312, "answer_id": 40879888, "question_id": 40879575, "link": "https://stackoverflow.com/questions/40879575/vba-auto-restart/40879888#40879888", "title": "VBA auto restart", "body": "<p>Create a boolean variable to track the state if the schedule and pass the next state to the reopen macro as a parameter.  </p>\n\n<p><strong>Note:</strong> <code>TimeSerial</code> only takes integers as a parameters</p>\n\n<p><a href=\"https://i.stack.imgur.com/ZihY8.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ZihY8.png\" alt=\"enter image description here\"></a></p>\n\n<pre><code>Public ScheduleS As Boolean\n\nSub ReStart()    'method inside here will be looping until stop\n    Application.OnTime Now + 0.000001, \"'ReOpen\" &amp; Chr(34) &amp; (Not ScheduleS) &amp; Chr(34) &amp; \"'\"\n    ThisWorkbook.Close SaveChanges:=True\nEnd Sub\n\nSub ReOpen(bSchedule As Boolean)\n    ScheduleS = bSchedule\n    MsgBox ScheduleS\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 49, "user_id": 6434313, "user_type": "registered", "accept_rate": 30, "profile_image": "https://graph.facebook.com/10153573233054147/picture?type=large", "display_name": "Wai Hung", "link": "https://stackoverflow.com/users/6434313/wai-hung"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1046, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1480477312, "creation_date": 1480475300, "question_id": 40879575, "link": "https://stackoverflow.com/questions/40879575/vba-auto-restart", "title": "VBA auto restart", "body": "<p>I am creating a auto restart VBA excel program.\nWhen the condition is fulfilled(eg. \"L\"), this program will try to restart and try to fulfill the opposite condition (eg. \"S\")</p>\n\n<p>So, that i want to create is:\nif i start with L\n    fulfill L==>restart==> fulfill S==>restart==> fulfill L==>restart.........\nand similarly \nif i start with S\n    fulfill S==>restart==> fulfill L==>restart==> fulfill S==>restart.........</p>\n\n<p>I have the following code:</p>\n\n<pre><code>    Sub Start() 'start the program\n        continue = True\n        Call SPTrader.setBasicValue\n        Call auto_open\n    End Sub\n\n    Sub auto_open() 'only use this will auto open\n        If (continue = True) Then\n          Call ScheduleStartProgram\n        End If\n    End Sub\n\n    Private Sub ScheduleStartProgram() 'method inside here will be looping until stop\n     t = 6 / 10 'set time to 0.6s\n          TimeToRun = now() + TimeSerial(0, 0, t)\n          Call DayTrade.findCurrenyClosestValue\n    End Sub\n\n\nSub findCurrenyClosestValue() 'dynamic find the closest value\n         Call findClosestMarketPrice\nEnd Sub\n\nPrivate Sub findClosestMarketPrice() 'find next price\n   currentMarketPrice = ThisWorkbook.Sheets(\"TradingPage\").Cells(6, 11).Value 'set Market Price\n    If (ThisWorkbook.Sheets(\"TradingPage\").Range(\"U6\") &lt;&gt; 0 And currentMarketPrice &gt;= ThisWorkbook.Sheets(\"TradingPage\").Range(\"U6\") And ThisWorkbook.Sheets(\"TradingPage\").Range(\"U5\").Text = \"S\" Or ThisWorkbook.Sheets(\"TradingPage\").Range(\"U5\").Text = \"s\" And ThisWorkbook.Sheets(\"TradingPage\").Range(\"U6\") &lt;&gt; 0 And currentMarketPrice &gt;= ThisWorkbook.Sheets(\"TradingPage\").Range(\"U6\")) Then  'test stop poin\n        Call TimeOut.TimeOut(3) 'time out 3s\n        ThisWorkbook.Sheets(\"TradingPage\").Range(\"S3\") = ThisWorkbook.Sheets(\"TradingPage\").Range(\"U6\").Text\n        ThisWorkbook.Sheets(\"TradingPage\").Range(\"U5\") = \"L\"\n        ThisWorkbook.Sheets(\"SP trader\").Range(\"C5\") = 0  'set amount=0\n        ThisWorkbook.Sheets(\"SP trader\").Range(\"C6\") = 0 'set amount=0\n        ThisWorkbook.Sheets(\"TradingPage\").Range(\"U6\") = 0\n        Call StartAndStop.auto_close\n        'End\n        Call StartAndStop.Start  'restart\n         Exit Sub\n\n\n    ElseIf (ThisWorkbook.Sheets(\"TradingPage\").Range(\"U6\") &lt;&gt; 0 And currentMarketPrice &lt;= ThisWorkbook.Sheets(\"TradingPage\").Range(\"U6\") And ThisWorkbook.Sheets(\"TradingPage\").Range(\"U5\").Text = \"L\" Or ThisWorkbook.Sheets(\"TradingPage\").Range(\"U5\").Text = \"l\" And ThisWorkbook.Sheets(\"TradingPage\").Range(\"U6\") &lt;&gt; 0 And currentMarketPrice &lt;= ThisWorkbook.Sheets(\"TradingPage\").Range(\"U6\")) Then 'test stop point\n        Call TimeOut.TimeOut(3) 'time out 3s\n        ThisWorkbook.Sheets(\"TradingPage\").Range(\"S3\") = ThisWorkbook.Sheets(\"TradingPage\").Range(\"U6\").Text\n        ThisWorkbook.Sheets(\"TradingPage\").Range(\"U5\") = \"S\"\n        ThisWorkbook.Sheets(\"SP trader\").Range(\"C5\") = 0  'set amount=0\n        ThisWorkbook.Sheets(\"SP trader\").Range(\"C6\") = 0 'set amount=0\n        ThisWorkbook.Sheets(\"TradingPage\").Range(\"U6\") = 0\n        Call StartAndStop.auto_close\n        Call StartAndStop.Start  'restart\n        Exit Sub\n  Else 'mainly run here\n      If (currentMarketPrice &gt;= currentClosestPrice And ThisWorkbook.Sheets(\"TradingPage\").Range(\"U5\") = \"L\" Or ThisWorkbook.Sheets(\"TradingPage\").Range(\"U5\") = \"l\" And currentMarketPrice &gt;= currentClosestPrice) Then\n       nextPriceYPosition = nextPriceYPosition - 1  \n       nextPriceXPosition = 17\n       currentClosestPrice = ThisWorkbook.Sheets(\"TradingPage\").Cells(nextPriceYPosition, nextPriceXPosition)\n       If (stopPointMethodPosition = 1 And counter = 0) Then ' in order to ensure the stopPointMethodPosition no equal 0\n                 stopPointMethodPosition = 0\n                 counter = counter + 1\n       End If\n       stopPointMethodPosition = stopPointMethodPosition + 1\n       End If\n      If (currentMarketPrice &lt;= currentClosestPrice And ThisWorkbook.Sheets(\"TradingPage\").Range(\"U5\") = \"S\" Or ThisWorkbook.Sheets(\"TradingPage\").Range(\"U5\") = \"s\" And currentMarketPrice &lt;= currentClosestPrice) Then\n            nextPriceYPosition = nextPriceYPosition + 1\n            If nextPriceYPosition = 40 Then   ' if next price at the boundary, show message\n                Call StartAndStop.auto_close\n                End\n            End If\n            nextPriceXPosition = 17\n            currentClosestPrice = ThisWorkbook.Sheets(\"TradingPage\").Cells(nextPriceYPosition, nextPriceXPosition)\n            If (stopPointMethodPosition = 1 And counter = 0) Then   ' in order to ensure the stopPointMethodPosition no equal 0\n                 stopPointMethodPosition = 0\n                 counter = counter + 1\n            End If\n            stopPointMethodPosition = stopPointMethodPosition + 1\n      End If\n       If (ThisWorkbook.Sheets(\"TradingPage\").Range(\"U5\").Value &lt;&gt; \"NA\") Then  'for safety\n                 Call FindMethodPosition.runAllFindMethodPosition\n       End If\n      If (ThisWorkbook.Sheets(\"TradingPage\").Range(\"U5\").Value = \"L\" Or ThisWorkbook.Sheets(\"TradingPage\").Range(\"U5\").Value = \"l\") Then\n           ThisWorkbook.Sheets(\"TradingPage\").Cells(nextPriceYPosition + 1, nextPriceXPosition).Font.Color = RGB(0, 0, 255) 'set now price blue\n      ElseIf (ThisWorkbook.Sheets(\"TradingPage\").Range(\"U5\").Value = \"S\" Or ThisWorkbook.Sheets(\"TradingPage\").Range(\"U5\").Value = \"s\") Then\n           ThisWorkbook.Sheets(\"TradingPage\").Cells(nextPriceYPosition - 1, nextPriceXPosition).Font.Color = RGB(0, 0, 255) 'set now price blue\n      End If\n   End If\nEnd Sub\n</code></pre>\n\n<p>For example, when i start with L and currentMarketPrice &lt;= ThisWorkbook.Sheets(\"TradingPage\").Range(\"U6\"), it go into findClosestMarketPrice() and successfully return \"s\" and Call StartAndStop.Start  'restart</p>\n\n<p>But after \"Call StartAndStop.Start\" when it start with S and currentMarketPrice >= ThisWorkbook.Sheets(\"TradingPage\").Range(\"U6\")\nit automatually go into findClosestMarketPrice() twice times.\nLike:\nif i start with L\n    fulfill L==>restart==> fulfill S==>restart==> fulfill L==>fulfill L==>restart==>fulfill S==>fulfill S==>restart.........\nand similarly \nif i start with S\n    fulfill S==>restart==> fulfill L==>restart==> fulfill S==>fulfill S==>restart==>fulfill L==>fulfill L==>restart.........</p>\n\n<p>and this is wrong!</p>\n\n<p>how can i create the program like this:\nif i start with L\n    fulfill L==>restart==> fulfill S==>restart==> fulfill L==>restart.........\nand similarly \nif i start with S\n    fulfill S==>restart==> fulfill L==>restart==> fulfill S==>restart.........</p>\n"}, {"tags": ["vba", "excel", "macros", "excel-2010"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1480469639, "post_id": 40878738, "comment_id": 68972464, "body": "Impossible to tell without your code - please <a href=\"http://stackoverflow.com/posts/40878738/edit\">edit your question</a> to include it."}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 2, "creation_date": 1480470665, "post_id": 40878738, "comment_id": 68972705, "body": "&quot;my VBA code or a bug.&quot; As a general rule of thumb -- it is your code. I&#39;ve made thousands of programming errors in my lifetime, but have only encountered situations where the bug is in the programming language implementations or major software tools a small number of times."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1480475122, "post_id": 40878738, "comment_id": 68973860, "body": "Try &quot;editing&quot; one of the cells on sheet1 that should be blank but appears to be showing something - does it show an existing value in the cell as you edit it?  Does the problem disappear after saving the file and then reopening it?  (My gut feeling is that it is a memory issue, perhaps not even related to Excel itself.)"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1480491019, "post_id": 40878738, "comment_id": 68979348, "body": "Another thing that might be worth trying is inserting an <code>Application.ScreenUpdating = False</code> at the start of your code, and an <code>Application.ScreenUpdating = True</code> at the end."}], "answers": [{"tags": [], "owner": {"reputation": 349, "user_id": 7170445, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/721a896bb14dadef7b06aa4bfa1c47fd?s=128&d=identicon&r=PG&f=1", "display_name": "Sam Woolerton", "link": "https://stackoverflow.com/users/7170445/sam-woolerton"}, "is_accepted": true, "score": 0, "last_activity_date": 1480486502, "creation_date": 1480486502, "answer_id": 40881521, "question_id": 40878738, "link": "https://stackoverflow.com/questions/40878738/vba-error-or-bug-sheet-2-data-showing-in-sheet-1/40881521#40881521", "title": "VBA error or bug? Sheet 2 data showing in sheet 1", "body": "<p>Problem was resolved when I used a different, faster computer than the one where the problem initially appeared.</p>\n\n<p>Looks like YowE3k was correct and it was specific to my computer</p>\n"}, {"tags": [], "owner": {"reputation": 9, "user_id": 9215405, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zerk7.png?s=128&g=1", "display_name": "Cerberus", "link": "https://stackoverflow.com/users/9215405/cerberus"}, "is_accepted": false, "score": 1, "last_activity_date": 1543071211, "last_edit_date": 1543071211, "creation_date": 1543070871, "answer_id": 53459322, "question_id": 40878738, "link": "https://stackoverflow.com/questions/40878738/vba-error-or-bug-sheet-2-data-showing-in-sheet-1/53459322#53459322", "title": "VBA error or bug? Sheet 2 data showing in sheet 1", "body": "<p>There can be another cause of previously selected sheet \"bleeding\" through to the currently visible one.</p>\n\n<p>In my case, it has helped to ensure that the last visible sheet after execution of the macro was the last activated sheet in the macro using <code>Sheets(\"Name\").Activate</code> or <code>Sheet.Activate</code>, not just selected.</p>\n"}], "owner": {"reputation": 349, "user_id": 7170445, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/721a896bb14dadef7b06aa4bfa1c47fd?s=128&d=identicon&r=PG&f=1", "display_name": "Sam Woolerton", "link": "https://stackoverflow.com/users/7170445/sam-woolerton"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 820, "favorite_count": 0, "accepted_answer_id": 40881521, "answer_count": 2, "score": 0, "last_activity_date": 1543071211, "creation_date": 1480469218, "last_edit_date": 1480475995, "question_id": 40878738, "link": "https://stackoverflow.com/questions/40878738/vba-error-or-bug-sheet-2-data-showing-in-sheet-1", "title": "VBA error or bug? Sheet 2 data showing in sheet 1", "body": "<p>I have an Excel spreadsheet that started acting strangely in the last couple of days, and I'm not sure if it's my VBA code or a bug. After running a macro to add a new row of data in sheet 1 to a table in sheet 2, sheet 2 can be seen 'through'sheet 1 - it's like the cells go 'no fill' but actually show through to sheet 2 instead of being white.</p>\n\n<p><a href=\"https://i.stack.imgur.com/yjxBf.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/yjxBf.png\" alt=\"enter image description here\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/0mifu.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/0mifu.png\" alt=\"enter image description here\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/ZSKWA.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ZSKWA.png\" alt=\"enter image description here\"></a></p>\n\n<p><a href=\"https://drive.google.com/file/d/0B8j98hGYskAwWlRrakk2cTk5LUE/view?usp=sharing\" rel=\"nofollow noreferrer\">Here's the spreadsheet, stored in Google Drive</a>, please feel free to download and look at the code etc. </p>\n\n<p>Is my VBA code causing this or is it a bug, and how could I fix it?</p>\n\n<p>EDIT: Here's the code. First sub is called on button press, and it calls sortTable at the end</p>\n\n<pre><code>Sub addRows()\n\n    Dim rowLast As Long\n    rowLast = Worksheets(\"Inventory\").Cells(Rows.Count, \"C\").End(xlUp).row\n    Dim relevantRow As Integer\n    relevantRow = rowLast + 1\n\n    Dim numRepeats As Integer\n    Dim numRepeatsRange As Range\n    Set numRepeatsRange = Range(\"newInv\")\n    numRepeats = numRepeatsRange.Count\n\n    Dim relevantColumn As Integer\n    Dim relevantColumnRange As String\n    Dim copyFromCell As Range\n    Dim copyToCell As Range\n\n    Dim counter As Integer\n    For counter = 1 To numRepeats\n        relevantColumn = Worksheets(\"Index Lookup\").Cells(counter + 1, 2).Value\n        Set copyFromCell = Worksheets(\"Input\").Cells(16, counter + 1)\n        Set copyToCell = Worksheets(\"Inventory\").Cells(relevantRow, relevantColumn)\n        copyToCell.Value = copyFromCell.Value\n    Next counter\n\n    Call sortTable\n    Worksheets(\"Input\").Range(\"newInv\").ClearContents\n    Worksheets(\"Input\").Range(\"C16\").Select\n\nEnd Sub\n\n\nSub sortTable()\n\n    ActiveWorkbook.Worksheets(\"Inventory\").ListObjects(\"Table14\").Sort.SortFields. _\n        Clear\n    ActiveWorkbook.Worksheets(\"Inventory\").ListObjects(\"Table14\").Sort.SortFields. _\n        Add Key:=Range(\"C15\"), SortOn:=xlSortOnValues, Order:=xlAscending, _\n        DataOption:=xlSortNormal\n    With ActiveWorkbook.Worksheets(\"Inventory\").ListObjects(\"Table14\").Sort\n        .Header = xlYes\n        .MatchCase = False\n        .Orientation = xlTopToBottom\n        .SortMethod = xlPinYin\n        .Apply\n    End With\n\nEnd Sub\n</code></pre>\n\n<p>EDIT2: The cells in question reset to normal upon taking any action that directly affects them - changing worksheet, selecting them (or even dragging selection over them but not actually selecting them), editing one of the affected cells. The visual disturbance goes in front of my buttons, but if I click in that area then their macros run - this is solely a visual problem.</p>\n\n<p>I've found a temporary workaround: Below the above code in sub addRows, I select cells A1:Z500, and then select C16 (selecting all clears the visual error, but it looks bad, so I reset selection to C16). The random info still flashes up on the screen but disappears really quickly.\nI'd still prefer to not have to do this - any ideas?</p>\n\n<p>EDIT3: I looked into it further and taking out the call to sortTable removed the problem. Something in sortTable (which only acts on sheet 2) is causing this weird visual error in sheet 1</p>\n"}, {"tags": ["vba", "excel", "macros"], "comments": [{"owner": {"reputation": 94, "user_id": 2480580, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Bs2TV.png?s=128&g=1", "display_name": "Andy", "link": "https://stackoverflow.com/users/2480580/andy"}, "edited": false, "score": 0, "creation_date": 1480465959, "post_id": 40878266, "comment_id": 68971491, "body": "<a href=\"http://stackoverflow.com/questions/19351832/copy-from-one-workbook-and-paste-into-another\" title=\"copy from one workbook and paste into another\">stackoverflow.com/questions/19351832/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "is_accepted": false, "score": 0, "last_activity_date": 1480481654, "creation_date": 1480481654, "answer_id": 40880592, "question_id": 40878266, "link": "https://stackoverflow.com/questions/40878266/vba-to-copy-paste-from-another-workbook-based-on-criteria/40880592#40880592", "title": "VBA to copy paste from another workbook based on criteria", "body": "<p>Here are two ways to use <strong>WorksheetFunctions</strong> to test if a range meets your conditions.</p>\n\n<h2>VBA WorksheetFunction.Min and WorksheetFunction.Max</h2>\n\n<pre><code>With wbkWorkbook1.Worksheets(\"RAW DATA\")\n\n    If WorksheetFunction.Min(.Range(\"B2:B25\")) &lt; -0.1 Or WorksheetFunction.Min(.Range(\"B2:B25\")) &lt; -0.1 Then\n\n    End If\n\nEnd With\n</code></pre>\n\n<h2><code>Worksheet.Evaluate</code> to return the value of a formula that tests ranges of that worksheet.</h2>\n\n<pre><code>If wbkWorkbook1.Worksheets(\"RAW DATA\").Evaluate(\"OR(MIN(B2:B25)&gt;=-0.1,MAX(B2:B25)&lt;=0.1)\") Then\n\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 6917283, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81048d39d006b77a981fc6c149368d8a?s=128&d=identicon&r=PG&f=1", "display_name": "tylerj", "link": "https://stackoverflow.com/users/6917283/tylerj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 766, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1480481654, "creation_date": 1480465774, "question_id": 40878266, "link": "https://stackoverflow.com/questions/40878266/vba-to-copy-paste-from-another-workbook-based-on-criteria", "title": "VBA to copy paste from another workbook based on criteria", "body": "<p>I have a total 3 workbooks named wb1, wb2 and wb3. I've written a vba program to copy and paste the data to the macro enabled workbook. The problem I have is to refine the copy&amp;paste in such a way that if the data in column B2:B25 in wb1 is between -0.1 to 0.1, then the next successive column C2:C25 and the original B2:B25 values will not be copied. The copy&amp;pasting will continue until all the columns up to AG has been checked</p>\n\n<p>Simliarly, the program will also copy&amp;paste from wb2 &amp; wb3 based on the above criteria. The only difference is the paste location which will be A5:AG8 and A40:AG43, respectively.</p>\n\n<p>Example\nIn wb1:</p>\n\n<pre><code>A      B   C        D      F\n0.09   1   0.0026   0      -0.17\n800    2   0.00457  -0.05  -0.15\n1600   3.1 0.00345  0.01   -0.1\n</code></pre>\n\n<p>The program will copy paste all data from column A to C but omits D &amp; F to the excel macro in A13:AG36 which will look like the result below.</p>\n\n<pre><code>A      B   C        \n0.09   1   0.0026   \n800    2   0.00457  \n1600   3.1 0.00345 \n</code></pre>\n\n<p>This will continue for next successive columns until AG; if G2:G25 have all values between -0.1 to 0.1 then both G and H are omitted.</p>\n\n<p>The program below simply copy and pastes the data to the excel macro workbook without any filter. How do I make it in a way that it implements the changes above?</p>\n\n<pre><code>Sub TransferTRA015()\n\n\nDim strPath2 As String\nDim strPath3 As String\nDim strPath4 As String\nDim wbkWorkbook1 As Workbook\nDim wbkWorkbook2 As Workbook\nDim wbkWorkbook3 As Workbook\nDim wbkWorkbook4 As Workbook\n\nApplication.ScreenUpdating = False\n\n\nstrPath2 = \"C:\\Users\\transducer1.CCS\\Desktop\\LabVIEW Data\\TRA015\\TRA015_TEST_Room.xlsx\"\nstrPath3 = \"C:\\Users\\transducer1.CCS\\Desktop\\LabVIEW Data\\TRA015\\TRA015_TEST_Cold.xlsx\"\nstrPath4 = \"C:\\Users\\transducer1.CCS\\Desktop\\LabVIEW Data\\TRA015\\TRA015_TEST_Hot.xlsx\"\n\n\nSet wbkWorkbook1 = ThisWorkbook '### changed this\nSet wbkWorkbook2 = Workbooks.Open(strPath2)\nSet wbkWorkbook3 = Workbooks.Open(strPath3)\nSet wbkWorkbook4 = Workbooks.Open(strPath4)\n\n\n'### change the sheet and range to what you need\nwbkWorkbook1.Worksheets(\"RAW DATA\").Range(\"A13:AG36\").Value = _\n    wbkWorkbook2.Worksheets(\"sheet1\").Range(\"A2:AG25\").Value\n\n\nwbkWorkbook1.Worksheets(\"RAW DATA\").Range(\"A5:AG8\").Value = _\n    wbkWorkbook4.Worksheets(\"sheet1\").Range(\"A2:AG5\").Value\n\nwbkWorkbook1.Worksheets(\"RAW DATA\").Range(\"A40:AG43\").Value = _\n    wbkWorkbook3.Worksheets(\"sheet1\").Range(\"A2:AG5\").Value\n\n\nwbkWorkbook2.Close (True)\nwbkWorkbook3.Close (True)\nwbkWorkbook4.Close (True)\n\nApplication.ScreenUpdating = False\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["sql-server", "vba", "excel", "excel-2013"], "comments": [{"owner": {"reputation": 6885, "user_id": 123422, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ft4KH.jpg?s=128&g=1", "display_name": "Paul Abbott", "link": "https://stackoverflow.com/users/123422/paul-abbott"}, "edited": false, "score": 1, "creation_date": 1480465810, "post_id": 40878235, "comment_id": 68971457, "body": "This actually executes?  I don&#39;t see where you are assigning the connection to the command.  Also, supplying user id and password with <code>Integrated Security=SSPI</code> is contradictory.  Surely that is not the entire error message."}, {"owner": {"reputation": 193, "user_id": 7153317, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ac1fcd24fa41b834e0599990bf08fb61?s=128&d=identicon&r=PG&f=1", "display_name": "StarsFlyFree FromCozyNights", "link": "https://stackoverflow.com/users/7153317/starsflyfree-fromcozynights"}, "reply_to_user": {"reputation": 6885, "user_id": 123422, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ft4KH.jpg?s=128&g=1", "display_name": "Paul Abbott", "link": "https://stackoverflow.com/users/123422/paul-abbott"}, "edited": false, "score": 0, "creation_date": 1480466188, "post_id": 40878235, "comment_id": 68971554, "body": "@PaulAbbott - sorry, copy/paste error.  I added in cmd.ActiveConnection = con .... I am only wanting to be able to have any user who opens the workbook be able to execute the connection to SQL Server.  Regardless of the computer it is opened on."}, {"owner": {"reputation": 6885, "user_id": 123422, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ft4KH.jpg?s=128&g=1", "display_name": "Paul Abbott", "link": "https://stackoverflow.com/users/123422/paul-abbott"}, "edited": false, "score": 0, "creation_date": 1480466363, "post_id": 40878235, "comment_id": 68971593, "body": "So are you trying to authenticate with a SQL username and password or the current windows login?"}, {"owner": {"reputation": 193, "user_id": 7153317, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ac1fcd24fa41b834e0599990bf08fb61?s=128&d=identicon&r=PG&f=1", "display_name": "StarsFlyFree FromCozyNights", "link": "https://stackoverflow.com/users/7153317/starsflyfree-fromcozynights"}, "reply_to_user": {"reputation": 6885, "user_id": 123422, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ft4KH.jpg?s=128&g=1", "display_name": "Paul Abbott", "link": "https://stackoverflow.com/users/123422/paul-abbott"}, "edited": false, "score": 0, "creation_date": 1480466385, "post_id": 40878235, "comment_id": 68971596, "body": "I want to authenticate with a SQL username and password."}, {"owner": {"reputation": 6885, "user_id": 123422, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ft4KH.jpg?s=128&g=1", "display_name": "Paul Abbott", "link": "https://stackoverflow.com/users/123422/paul-abbott"}, "edited": false, "score": 0, "creation_date": 1480466414, "post_id": 40878235, "comment_id": 68971608, "body": "Then take <code>Integrated Security=SSPI</code> out."}, {"owner": {"reputation": 2709, "user_id": 5552667, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/80ab93af25a6711aced7ee104a7e2ed6?s=128&d=identicon&r=PG&f=1", "display_name": "ZLK", "link": "https://stackoverflow.com/users/5552667/zlk"}, "edited": false, "score": 0, "creation_date": 1480466659, "post_id": 40878235, "comment_id": 68971671, "body": "... and <code>Trusted_Connection=Yes</code>... FYI both of those should be for using windows credentials instead of a given username/password."}], "answers": [{"tags": [], "owner": {"reputation": 1206, "user_id": 2676140, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/28c2b7445b21c07765a3a7d603655b6f?s=128&d=identicon&r=PG&f=1", "display_name": "user2676140", "link": "https://stackoverflow.com/users/2676140/user2676140"}, "is_accepted": true, "score": 0, "last_activity_date": 1480467006, "creation_date": 1480467006, "answer_id": 40878433, "question_id": 40878235, "link": "https://stackoverflow.com/questions/40878235/run-sql-query-from-vba/40878433#40878433", "title": "Run SQL Query From VBA", "body": "<p>There are two ways to connect to SQL Server through VBA<br>\n1) Integrated Security=SSPI;<br>\n2) Provide a valid username &amp; password through the VBA</p>\n\n<p>When you use SSPI, the windows login credentials of the logged in user (i.e. of the Excel workbook) will be used.</p>\n\n<p>Now for you, since you are not wanting to use windows credentials you need to provide a SQL server logon with the User ID and password you specify, and that must also be associated with an account in the database with the privileges that you need.</p>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user7075507"}, "is_accepted": false, "score": 0, "last_activity_date": 1483282742, "creation_date": 1483282742, "answer_id": 41416381, "question_id": 40878235, "link": "https://stackoverflow.com/questions/40878235/run-sql-query-from-vba/41416381#41416381", "title": "Run SQL Query From VBA", "body": "<p>These two samples work perfectly fine for me.</p>\n\n<pre><code>Option Explicit\n\nSub CallSprocOne()\n\nDim con As Connection\nDim rst As Recordset\nDim strConn As String\n\nSet con = New Connection\nstrConn = \"Provider=SQLOLEDB;\"\nstrConn = strConn &amp; \"Data Source=LAPTOP\\SQL_EXPRESS;\"\nstrConn = strConn &amp; \"Initial Catalog=Northwind;\"\nstrConn = strConn &amp; \"Integrated Security=SSPI;\"\n\ncon.Open strConn\n\n'Put a country name in Cell E1\nSet rst = con.Execute(\"Exec dbo.TestNewProc '\" &amp; ActiveSheet.Range(\"E1\").Text &amp; \"'\")\n\n'The total count of records is returned to Cell A5\nActiveSheet.Range(\"A5\").CopyFromRecordset rst\n\nrst.Close\ncon.Close\n\nEnd Sub\n\n\nSub CallSprocTwo()\n\nDim con As Connection\nDim rst As Recordset\n\nSet con = New Connection\ncon.Open \"Provider=SQLOLEDB;Data Source=LAPTOP\\SQL_EXPRESS;Initial Catalog=Northwind;Integrated Security=SSPI;\"\n\nSet rst = con.Execute(\"Exec dbo.[Ten Most Expensive Products]\")\n'Results of SProc are returned to Cell A1\nActiveSheet.Range(\"A1\").CopyFromRecordset rst\n\nrst.Close\ncon.Close\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 193, "user_id": 7153317, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ac1fcd24fa41b834e0599990bf08fb61?s=128&d=identicon&r=PG&f=1", "display_name": "StarsFlyFree FromCozyNights", "link": "https://stackoverflow.com/users/7153317/starsflyfree-fromcozynights"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4816, "favorite_count": 0, "accepted_answer_id": 40878433, "answer_count": 2, "score": 0, "last_activity_date": 1483282742, "creation_date": 1480465554, "last_edit_date": 1480466133, "question_id": 40878235, "link": "https://stackoverflow.com/questions/40878235/run-sql-query-from-vba", "title": "Run SQL Query From VBA", "body": "<p>I am using this syntax to run a SQL Server 2008 stored procedure from Excel 2013.  Everything executes as it should on one PC, but if I attempt to run it on a second PC it errors out with an </p>\n\n<blockquote>\n  <p>OLEDB Connection error</p>\n</blockquote>\n\n<p>Shouldn't since I am hardcoding the servername, username, and password the syntax run w/o a hitch on any PC?</p>\n\n<pre><code>Function RunSQLServerProc()\nDim con As ADODB.Connection\nDim cmd As ADODB.Command\nDim rs As ADODB.Recordset\nSet con = New ADODB.Connection\nSet cmd = New ADODB.Command\nSet rs = New ADODB.Recordset\ncon.Open \"Provider=SQLOLEDB;Data Source=Server;Initial Catalog=Database;User Id=userid;Password=password;Integrated Security=SSPI;Trusted_Connection=Yes;\"\ncmd.ActiveConnection = con\ncmd.CommandText = \"TestProc\"\nSet rs = cmd.Execute(, , adCmdStoredProc)\nEnd Function\n</code></pre>\n"}, {"tags": ["excel", "conditional-formatting", "vba"], "answers": [{"comments": [{"owner": {"reputation": 94, "user_id": 2480580, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Bs2TV.png?s=128&g=1", "display_name": "Andy", "link": "https://stackoverflow.com/users/2480580/andy"}, "edited": false, "score": 0, "creation_date": 1480466330, "post_id": 40878268, "comment_id": 68971585, "body": "Alec said:My Spreadsheet is much longer than this example. So I think <code>conditional formatting</code> is not a good idea(speed will slower). How about <code>VBA</code>?"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 94, "user_id": 2480580, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Bs2TV.png?s=128&g=1", "display_name": "Andy", "link": "https://stackoverflow.com/users/2480580/andy"}, "edited": false, "score": 0, "creation_date": 1480468319, "post_id": 40878268, "comment_id": 68972144, "body": "@Andy sorry - true, but I&#39;d try CF first because it&#39;s also dynamic...but good point, if it&#39;s too much data a simple VBA loop may do the trick."}], "tags": [], "owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "is_accepted": false, "score": 1, "last_activity_date": 1480465779, "creation_date": 1480465779, "answer_id": 40878268, "question_id": 40878074, "link": "https://stackoverflow.com/questions/40878074/highlight-rows-based-on-inputdate/40878268#40878268", "title": "Highlight Rows based on InputDate", "body": "<p>This can be done with Conditional Formatting. First, don't use a merged cell if you can help it (it looks like your input date is \"A and B 85\"). </p>\n\n<p>Let's say your input date is $A$85, you can go to Conditional Formatting. I'm also going to assume your date data starts in <code>$P$87</code></p>\n\n<p>Highlight row 87 (or just <code>A87:P87</code> if you don't want the entire row highlighted).</p>\n\n<p>In Conditional Formatting, use this formula:</p>\n\n<p><code>=And($P87&lt;&gt;\"\",$P87&lt;=$A$85)</code></p>\n\n<p>Then click the Format, and go to \"Fill\", and choose Yellow, or whatever color you want.</p>\n\n<p>Then, change the range the conditional formatting is applied to to say <code>=$A87:$P1000</code> to have all rows in between <code>87</code> and <code>1000</code> highlighted if the date is older than your input date.</p>\n\n<p><a href=\"https://i.stack.imgur.com/OFZOh.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/OFZOh.jpg\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 141, "user_id": 6268362, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/a4202013a491ecfa1b479a4c8d1a219c?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/6268362/alec"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 106, "favorite_count": 1, "answer_count": 1, "score": -3, "last_activity_date": 1480465779, "creation_date": 1480464570, "last_edit_date": 1531161705, "question_id": 40878074, "link": "https://stackoverflow.com/questions/40878074/highlight-rows-based-on-inputdate", "title": "Highlight Rows based on InputDate", "body": "<p>I'm new to Excel and I would like to highlight all the rows that are older than my input date.My Spreadsheet is much longer than this example picture, and users might add a row with a new date. </p>\n\n<p>How can I achive this?  Thank you!</p>\n\n<p><a href=\"https://i.stack.imgur.com/xecAz.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/xecAz.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["arrays", "vba", "excel"], "comments": [{"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 0, "creation_date": 1480465165, "post_id": 40877738, "comment_id": 68971288, "body": "Arrays obtained for a Range&#39;s Value property (as you are doing) are 2D, so for a row as in your code, use <code>If AdjustedProductionValues(1, i) = 0 Then</code>.  Similar for <code>FinalProductionValues</code>"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 3, "creation_date": 1480465520, "post_id": 40877738, "comment_id": 68971379, "body": "2D and <i>one-based</i>, not zero-based, so <code>i</code> should start at 1 not at 0"}, {"owner": {"reputation": 75, "user_id": 4681622, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/8dae5fea8dec28e231791ae6c2b9f781?s=128&d=identicon&r=PG&f=1", "display_name": "ant_sol", "link": "https://stackoverflow.com/users/4681622/ant-sol"}, "edited": false, "score": 0, "creation_date": 1480473782, "post_id": 40877738, "comment_id": 68973503, "body": "Thank you for the help! I got everything working!"}], "owner": {"reputation": 75, "user_id": 4681622, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/8dae5fea8dec28e231791ae6c2b9f781?s=128&d=identicon&r=PG&f=1", "display_name": "ant_sol", "link": "https://stackoverflow.com/users/4681622/ant-sol"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 621, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1480474870, "creation_date": 1480462444, "last_edit_date": 1525816189, "question_id": 40877738, "link": "https://stackoverflow.com/questions/40877738/vba-loop-through-array-assign-value-to-different-array", "title": "VBA - Loop Through Array, Assign Value to Different Array", "body": "<p>I'm creating two arrays based on a range in my Excel sheet:\nAdjustedProductionValues,\nProductionTargetValues</p>\n\n<p>I'm creating a third array to hold new values:\nFinalProductionValues</p>\n\n<p>I want to loop through AdjustedProductionValues; if the value is 0 I want to assign the value of ProductionTargetValues to a new array FinalProductionValues. Otherwise, I want to assign the value of AdjustedProductionValues to FinalProductionValues.</p>\n\n<p>I keep getting an error of Subscript out of range. I've tried ReDim a couple different ways with no success. I get the error at the If statement.</p>\n\n<p>How do I fix this?</p>\n\n<pre><code>Sub TEST()\n\n    Dim AdjustedProductionValues()          As Variant\n    Dim ProductionTargetValues()            As Variant\n    Dim FinalProductionValues()             As Variant\n    ReDim FinalProductionValues(1 To 1)     As Variant\n    Dim i                                   As Integer\n\n    'Assigning Adjusted Production and Production Target numbers into lists\n    Worksheets(\"SUMMARY\").Activate\n\n    AdjustedProductionValues = Range(Range(\"E35\"), Range(\"E35\").End(xlToRight))\n    ProductionTargetValues = Range(Range(\"E34\"), Range(\"E34\").End(xlToRight))\n\n    'checking each Adjusted Production value\n    'if it's 0 then assigns the Adjusted Production value to a new list\n    'if it's not 0 it assignes the Production Target to the new list\n\n    For i = 0 To UBound(AdjustedProductionValues)\n        ReDim Preserve FinalProductionValues(1 To UBound(FinalProductionValues) + 1) As Variant\n        If AdjustedProductionValues(i) = 0 Then\n            FinalProductionValues(UBound(FinalProductionValues)) = ProductionTargetValues(i)\n        Else\n            FinalProductionValues(UBound(FinalProductionValues)) = AdjustedProductionValues(i)\n        End If\n    Next i\n\nEnd Sub\n</code></pre>\n\n<p><strong>UPDATE W/ FIX</strong>\nI fixed my code with this:</p>\n\n<pre><code>For i = 1 To UBound(AdjustedProductionValues, 2)\n    ReDim Preserve FinalProductionValues(1 To UBound(FinalProductionValues) + 1) As Variant\n    If AdjustedProductionValues(1, i) = 0 Then\n        FinalProductionValues(UBound(FinalProductionValues)) = ProductionTargetValues(1, i)\n    Else\n        FinalProductionValues(UBound(FinalProductionValues)) = AdjustedProductionValues(1, i)\n    End If\nNext i\n</code></pre>\n\n<p>I checked my work by using the following: </p>\n\n<pre><code>Worksheets(\"Sheet2\").Activate\nDim NumRows As Long\nDim NumCols As Long\nNumRows = 1\nNumCols = UBound(FinalProductionValues, 1) - LBound(FinalProductionValues, 1) + 1\nRange(\"A1\").Resize(NumRows, NumCols).Value = FinalProductionValues\n</code></pre>\n\n<p>Got help checking my code with <a href=\"http://www.cpearson.com/excel/ArraysAndRanges.aspx\" rel=\"nofollow noreferrer\">this link.</a></p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1480462852, "post_id": 40877704, "comment_id": 68970688, "body": "Works for me in a quick test.  Does anything happen when you click the link ?"}, {"owner": {"reputation": 489, "user_id": 4021184, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/715e799fa6bcbb7af072f14a37e3caef?s=128&d=identicon&r=PG&f=1", "display_name": "ranopano", "link": "https://stackoverflow.com/users/4021184/ranopano"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1480462993, "post_id": 40877704, "comment_id": 68970728, "body": "When I click the link, it brings me to the correct sheet, however the table is not being filtered at all."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1480466781, "post_id": 40877704, "comment_id": 68971700, "body": "Try adding <code>Msgbox Sheet3.Range(&quot;S17&quot;).Value</code> to your code - is the value what you expect?"}, {"owner": {"reputation": 489, "user_id": 4021184, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/715e799fa6bcbb7af072f14a37e3caef?s=128&d=identicon&r=PG&f=1", "display_name": "ranopano", "link": "https://stackoverflow.com/users/4021184/ranopano"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1480466976, "post_id": 40877704, "comment_id": 68971760, "body": "Where in my code do I add that?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1480467025, "post_id": 40877704, "comment_id": 68971784, "body": "Anywhere inside the <code>If</code> block"}, {"owner": {"reputation": 489, "user_id": 4021184, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/715e799fa6bcbb7af072f14a37e3caef?s=128&d=identicon&r=PG&f=1", "display_name": "ranopano", "link": "https://stackoverflow.com/users/4021184/ranopano"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1480467187, "post_id": 40877704, "comment_id": 68971832, "body": "No, when I click the hyperlink there is no message box that pops up."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1480467320, "post_id": 40877704, "comment_id": 68971871, "body": "I&#39;m not clear how that could happen: you say the table sheet is activated, so your <code>If</code> code must be executing."}, {"owner": {"reputation": 489, "user_id": 4021184, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/715e799fa6bcbb7af072f14a37e3caef?s=128&d=identicon&r=PG&f=1", "display_name": "ranopano", "link": "https://stackoverflow.com/users/4021184/ranopano"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1480467443, "post_id": 40877704, "comment_id": 68971907, "body": "Here&#39;s another thing-  Sheet15 is a hidden sheet. That&#39;s why I put the visible statements in the code. However, unless I manually unhide the sheet, the hyperlink doesn&#39;t work. So I feel like the code is just not working to begin with."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1480467485, "post_id": 40877704, "comment_id": 68971919, "body": "Can you share the workbook?  Via Dropbox or something..."}, {"owner": {"reputation": 489, "user_id": 4021184, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/715e799fa6bcbb7af072f14a37e3caef?s=128&d=identicon&r=PG&f=1", "display_name": "ranopano", "link": "https://stackoverflow.com/users/4021184/ranopano"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1480537455, "post_id": 40877704, "comment_id": 69008698, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/129472/discussion-between-darren-and-tim-williams\">continue this discussion in chat</a>."}], "answers": [{"comments": [{"owner": {"reputation": 489, "user_id": 4021184, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/715e799fa6bcbb7af072f14a37e3caef?s=128&d=identicon&r=PG&f=1", "display_name": "ranopano", "link": "https://stackoverflow.com/users/4021184/ranopano"}, "edited": false, "score": 0, "creation_date": 1480463402, "post_id": 40877834, "comment_id": 68970826, "body": "Hmm so just want to clarify... The link just says &quot;Click Here&quot;, so the value of the link doesn&#39;t actually change. What I&#39;d like to do is have it so If the user clicks on a cell (Say &quot;A13&quot;), I want the link to filter the table based on A13&#39;s value. If that makes sense?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 489, "user_id": 4021184, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/715e799fa6bcbb7af072f14a37e3caef?s=128&d=identicon&r=PG&f=1", "display_name": "ranopano", "link": "https://stackoverflow.com/users/4021184/ranopano"}, "edited": false, "score": 0, "creation_date": 1480464796, "post_id": 40877834, "comment_id": 68971194, "body": "I&#39;m not following you.  The user clicks on a link which just says &quot;Click Here&quot;, so where is the value to filter the table by located?  At the destination of the hyperlink?  Is there a link in A13 ?"}, {"owner": {"reputation": 489, "user_id": 4021184, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/715e799fa6bcbb7af072f14a37e3caef?s=128&d=identicon&r=PG&f=1", "display_name": "ranopano", "link": "https://stackoverflow.com/users/4021184/ranopano"}, "edited": false, "score": 0, "creation_date": 1480465023, "post_id": 40877834, "comment_id": 68971253, "body": "I think I&#39;m seeing what you&#39;re getting at and where my error might be... OK, so say column A is a list of cities. If the user clicks on cell A13 which is &quot;Chicago&quot;, he can then click the hyperlink which will bring him to another sheet. This table will be filtered to show just &quot;Chicago&quot;. Is the error that the user would technically be clicking on two cells? So when the user clicks the hyperlink, it&#39;s not actually referencing &quot;Chicago&quot;, it&#39;s just bringing him to the table. Is this right?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 489, "user_id": 4021184, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/715e799fa6bcbb7af072f14a37e3caef?s=128&d=identicon&r=PG&f=1", "display_name": "ranopano", "link": "https://stackoverflow.com/users/4021184/ranopano"}, "edited": false, "score": 0, "creation_date": 1480465236, "post_id": 40877834, "comment_id": 68971303, "body": "Yes - that&#39;s the issue.  You could replace the hyperlink with a button and use <code>Selection.Value</code> to get the selected city, or put hyperlinks on all of the city names..."}, {"owner": {"reputation": 489, "user_id": 4021184, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/715e799fa6bcbb7af072f14a37e3caef?s=128&d=identicon&r=PG&f=1", "display_name": "ranopano", "link": "https://stackoverflow.com/users/4021184/ranopano"}, "edited": false, "score": 0, "creation_date": 1480465385, "post_id": 40877834, "comment_id": 68971341, "body": "This is an easy fix. I&#39;ve created a cell in &quot;S17&quot; that has the value to filter the table to. Sticking with this example, the cell simply states &quot;Chicago&quot;. I&#39;ll update my code so you can see what I mean..."}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 1, "last_activity_date": 1480463089, "creation_date": 1480463089, "answer_id": 40877834, "question_id": 40877704, "link": "https://stackoverflow.com/questions/40877704/dynamic-hyperlink-that-filters-a-table-based-on-the-activecell-value-vba/40877834#40877834", "title": "Dynamic hyperlink that filters a table based on the ActiveCell value (VBA)", "body": "<p>Note: unless the hyperlink points to itself, <code>ActiveCell.Value</code> will be the <em>value at the link destination</em>: use <code>Target.Range.Value</code> if you want the value from the cell containing the link.</p>\n\n<pre><code>Private Sub Worksheet_FollowHyperlink(ByVal Target As Hyperlink)\n    If Target.Type = msoHyperlinkRange And Target.Range.Address = \"$S$15\" Then\n        Application.ScreenUpdating = False\n        With Sheet15\n            .Visible = True\n            .ListObjects(\"Table17\").Range.AutoFilter Field:=19, _\n                                     Criteria1:=Target.Range.Value\n            .Activate\n        End With\n        Application.ScreenUpdating = True\n    End If\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 489, "user_id": 4021184, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/715e799fa6bcbb7af072f14a37e3caef?s=128&d=identicon&r=PG&f=1", "display_name": "ranopano", "link": "https://stackoverflow.com/users/4021184/ranopano"}, "edited": false, "score": 0, "creation_date": 1480537397, "post_id": 40882682, "comment_id": 69008669, "body": "I&#39;m running into an issue with this because I am already running another Worksheet_SelectionChange event on this sheet."}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "reply_to_user": {"reputation": 489, "user_id": 4021184, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/715e799fa6bcbb7af072f14a37e3caef?s=128&d=identicon&r=PG&f=1", "display_name": "ranopano", "link": "https://stackoverflow.com/users/4021184/ranopano"}, "edited": false, "score": 0, "creation_date": 1480537490, "post_id": 40882682, "comment_id": 69008717, "body": "What kind of issue?"}, {"owner": {"reputation": 489, "user_id": 4021184, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/715e799fa6bcbb7af072f14a37e3caef?s=128&d=identicon&r=PG&f=1", "display_name": "ranopano", "link": "https://stackoverflow.com/users/4021184/ranopano"}, "edited": false, "score": 0, "creation_date": 1480537573, "post_id": 40882682, "comment_id": 69008762, "body": "&quot;Compile error: Ambiguous name detected: Worksheet_SelectionChange&quot;"}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "reply_to_user": {"reputation": 489, "user_id": 4021184, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/715e799fa6bcbb7af072f14a37e3caef?s=128&d=identicon&r=PG&f=1", "display_name": "ranopano", "link": "https://stackoverflow.com/users/4021184/ranopano"}, "edited": false, "score": 0, "creation_date": 1480538183, "post_id": 40882682, "comment_id": 69009118, "body": "You just merge them into a unique &quot;Worksheet_SelectionChange()&quot; sub. It&#39;ll begin with:     &quot;If Target.Address &lt;&gt; &quot;$S$15&quot; Then Set lastCell = Intersect(Target, Columns(&quot;A&quot;)) &quot; and goes on with the code you already have in it"}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "reply_to_user": {"reputation": 489, "user_id": 4021184, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/715e799fa6bcbb7af072f14a37e3caef?s=128&d=identicon&r=PG&f=1", "display_name": "ranopano", "link": "https://stackoverflow.com/users/4021184/ranopano"}, "edited": false, "score": 0, "creation_date": 1480540978, "post_id": 40882682, "comment_id": 69010685, "body": "@Darren, did you get through it?"}, {"owner": {"reputation": 489, "user_id": 4021184, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/715e799fa6bcbb7af072f14a37e3caef?s=128&d=identicon&r=PG&f=1", "display_name": "ranopano", "link": "https://stackoverflow.com/users/4021184/ranopano"}, "edited": false, "score": 0, "creation_date": 1480543307, "post_id": 40882682, "comment_id": 69011842, "body": "Sort of. I&#39;m still trying to work on it. I merged the two subs together, but now neither are working."}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "reply_to_user": {"reputation": 489, "user_id": 4021184, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/715e799fa6bcbb7af072f14a37e3caef?s=128&d=identicon&r=PG&f=1", "display_name": "ranopano", "link": "https://stackoverflow.com/users/4021184/ranopano"}, "edited": false, "score": 1, "creation_date": 1480543606, "post_id": 40882682, "comment_id": 69011977, "body": "there must be only one <code>Worksheet_SelectionChange()</code>. Keep your <i>old</i> one and just add as its first line after the header <code>If Target.Address &lt;&gt; &quot;$S$15&quot; Then Set lastCell = Intersect(Target, Columns(&quot;A&quot;))</code>. If your <i>old</i> <code>Worksheet_SelectionChange()</code> worked, then this <i>new</i> one should, too"}, {"owner": {"reputation": 489, "user_id": 4021184, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/715e799fa6bcbb7af072f14a37e3caef?s=128&d=identicon&r=PG&f=1", "display_name": "ranopano", "link": "https://stackoverflow.com/users/4021184/ranopano"}, "reply_to_user": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1480543900, "post_id": 40882682, "comment_id": 69012116, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/129477/discussion-between-darren-and-user3598756\">continue this discussion in chat</a>."}, {"owner": {"reputation": 489, "user_id": 4021184, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/715e799fa6bcbb7af072f14a37e3caef?s=128&d=identicon&r=PG&f=1", "display_name": "ranopano", "link": "https://stackoverflow.com/users/4021184/ranopano"}, "edited": false, "score": 0, "creation_date": 1480544109, "post_id": 40882682, "comment_id": 69012194, "body": "Hi, I sent you a Chat message"}], "tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": true, "score": 1, "last_activity_date": 1480519174, "last_edit_date": 1480519174, "creation_date": 1480491139, "answer_id": 40882682, "question_id": 40877704, "link": "https://stackoverflow.com/questions/40877704/dynamic-hyperlink-that-filters-a-table-based-on-the-activecell-value-vba/40882682#40882682", "title": "Dynamic hyperlink that filters a table based on the ActiveCell value (VBA)", "body": "<p>sticking to your original plans, and assuming column \"A\" is the one with cities names, place the following in your worksheet code pane</p>\n\n<pre><code>Option Explicit\n\nDim lastCell As Range '&lt;--| declare a module scoped range variable to store the last cell selected by the user, if \"valid\"\n\nPrivate Sub Worksheet_SelectionChange(ByVal Target As Range)\n    If Target.Address = \"$S$15\" Then Exit Sub '&lt;-- do nothing if user selected cell with hyperlink\n    Set lastCell = Intersect(Target, Columns(\"A\")) '&lt;-- change \"Columns(\"A\") to a named range with your cities\nEnd Sub\n\nPrivate Sub Worksheet_FollowHyperlink(ByVal Target As Hyperlink)\n    If lastCell Is Nothing Then Exit Sub '&lt;--| no action if lastCell has not been properly set by 'Worksheet_SelectionChange()'\n\n    If Target.Type = msoHyperlinkRange And Target.Range.Address = \"$S$15\" Then\n        Application.ScreenUpdating = False\n        Sheet15.Visible = True\n        Sheet15.ListObjects(\"Table17\").Range.AutoFilter Field:=19, Criteria1:=lastCell.Value '&lt;--| set the criteria as 'lastCell' value\n        Sheet15.Activate\n        Application.ScreenUpdating = True\n    End If\nEnd Sub\n</code></pre>\n\n<p>as per comments, you change  <code>Columns(\"A\")</code> reference in <code>Worksheet_SelectionChange()</code> to your actual range with cities names (perhaps a <em>named range</em>)</p>\n"}], "owner": {"reputation": 489, "user_id": 4021184, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/715e799fa6bcbb7af072f14a37e3caef?s=128&d=identicon&r=PG&f=1", "display_name": "ranopano", "link": "https://stackoverflow.com/users/4021184/ranopano"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1207, "favorite_count": 0, "accepted_answer_id": 40882682, "answer_count": 2, "score": 0, "last_activity_date": 1480519174, "creation_date": 1480462200, "last_edit_date": 1480465558, "question_id": 40877704, "link": "https://stackoverflow.com/questions/40877704/dynamic-hyperlink-that-filters-a-table-based-on-the-activecell-value-vba", "title": "Dynamic hyperlink that filters a table based on the ActiveCell value (VBA)", "body": "<p>I'm creating a dynamic hyperlink that will filter a table on another sheet (Sheet15). </p>\n\n<p>My goal is to have the user be able to select a cell on Sheet3 and have the VALUE of this cell be the filter on the other sheet. </p>\n\n<p>Here is my code so far:</p>\n\n<pre><code>Private Sub Worksheet_FollowHyperlink(ByVal Target As Hyperlink)\n    If Target.Type = msoHyperlinkRange And Target.Range.Address = \"$S$15\" Then\n        Application.ScreenUpdating = False\n        Sheet15.Visible = True\n        Sheet15.ListObjects(\"Table17\").Range.AutoFilter Field:=19, Criteria1:=ActiveCell.Value\n        Sheet15.Activate\n        Application.ScreenUpdating = True\n    End If\nEnd Sub\n</code></pre>\n\n<p>However, when I click the hyperlink, the table is not filtered at all, so I gotta be doing something wrong. </p>\n\n<p>Can anyone assist?</p>\n\n<hr>\n\n<p><strong>UPDATE</strong></p>\n\n<p>Here is updated code. </p>\n\n<p>Cell S17 is now the value that I want to filter the table to:</p>\n\n<pre><code>Private Sub Worksheet_FollowHyperlink(ByVal Target As Hyperlink)\n    If Target.Type = msoHyperlinkRange And Target.Range.Address = \"$S$15\" Then\n        Application.ScreenUpdating = False\n        Sheet15.Visible = True\n        Sheet15.ListObjects(\"Table17\").Range.AutoFilter Field:=19, Criteria1:=Sheet3.Range(\"S17\").Value\n        Sheet15.Activate\n        Application.ScreenUpdating = True\n    End If\nEnd Sub\n</code></pre>\n\n<p>But the issue remains. When I click they hyperlink, I will be brought to this other sheet, but the table is not filtered at all. </p>\n"}, {"tags": ["vba", "outlook"], "answers": [{"tags": [], "owner": {"reputation": 3145, "user_id": 4560433, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/412786b272a5c096e45967bc79cde0a9?s=128&d=identicon&r=PG&f=1", "display_name": "OpiesDad", "link": "https://stackoverflow.com/users/4560433/opiesdad"}, "is_accepted": true, "score": 2, "last_activity_date": 1480461690, "creation_date": 1480461690, "answer_id": 40877601, "question_id": 40877266, "link": "https://stackoverflow.com/questions/40877266/outlook-vba-getting-the-current-views-start-and-end-date/40877601#40877601", "title": "Outlook/VBA: Getting the Current View&#39;s Start and End Date", "body": "<p>You want the <code>CalendarView.DisplayDates</code> property.  This is an array containing each date displayed.  Get the first and last value in the array.  See <a href=\"https://msdn.microsoft.com/en-us/library/office/ff864304.aspx\" rel=\"nofollow noreferrer\">here</a>.</p>\n\n<p>Code reproduced and altered for clarity below:</p>\n\n<pre><code>Sub DisplayDayRange()\n\n Dim objView As CalendarView\n Dim varArray As Variant\n Dim beginDate As Date\n Dim endDate As Date\n\n    ' Check if the current view is a calendar view.\n\n    If Application.ActiveExplorer.CurrentView.ViewType = olCalendarView Then       \n\n        ' Obtain a CalendarView object reference for the     \n        ' current calendar view.\n\n        Set objView = Application.ActiveExplorer.CurrentView\n\n        ' Obtain the DisplayedDates value, a string  \n        ' array of dates representing the dates displayed           \n        ' in the calendar view.\n\n        varArray = objView.DisplayedDates\n\n        ' If the example obtained a valid array, display  \n        ' a dialog box with a summary of its contents.\n\n        If IsArray(varArray) Then\n\n            beginDate = varArray(LBound(varArray))\n            endDate = varArray(UBound(varArray))\n            MsgBox \"There are \" &amp; (UBound(varArray) - LBound(varArray)) + 1 &amp; \" days displayed, from \" &amp; beginDate &amp; \" to \" &amp; endDate  \n        End If     \n    End If\n\n End Sub\n</code></pre>\n"}], "owner": {"reputation": 305, "user_id": 2271875, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/a31d8ac2c9c4a637e3da857bf8698cd7?s=128&d=identicon&r=PG", "display_name": "user2271875", "link": "https://stackoverflow.com/users/2271875/user2271875"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 876, "favorite_count": 0, "accepted_answer_id": 40877601, "answer_count": 1, "score": 2, "last_activity_date": 1480461690, "creation_date": 1480459982, "question_id": 40877266, "link": "https://stackoverflow.com/questions/40877266/outlook-vba-getting-the-current-views-start-and-end-date", "title": "Outlook/VBA: Getting the Current View&#39;s Start and End Date", "body": "<p>I've programmed VBA for various Office applications, but I'm new to Outlook, so I'm still learning the various Outlook objects.</p>\n\n<p>In the Outlook calendar view, I'm either in a \"Day\", \"Work Week\", \"Week\", \"Month\", or \"Schedule View\" arrangement. I can change between these however I want to see my events. Today being November 29, 2016, displayed above my calendar (Outlook 2016) I see:</p>\n\n<ul>\n<li><strong>Day</strong>: \"November 29, 2016\"</li>\n<li><strong>Work Week</strong>: \"November 28 - December 2, 2016\"</li>\n<li><strong>Week</strong>: \"November 26 - December 2, 2016\"</li>\n<li>etc...</li>\n</ul>\n\n<p>This is obviously a date range for my current <em>view</em> (probably the incorrect term).</p>\n\n<p>How do I reference the beginning and/or end dates of this <em>view</em> in VBA? I want to clarify that I do <em>NOT</em> want the beginning and end dates of a <em>selection</em> (which is what I'm finding online), but of the actual view--what I'm seeing at the moment on my Outlook client application.</p>\n\n<p>Thanks in advance for your time and assistance.</p>\n"}, {"tags": ["excel", "vba", "vlookup"], "comments": [{"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 1, "creation_date": 1480457433, "post_id": 40876523, "comment_id": 68968478, "body": "your code works for me <i>provided</i> <code>Vendorspec.xlsx</code> workbook is open <i>and</i> <code>vid</code> is a valid workbook scoped named range in that workbook <i>and</i> the value of <code>specsec</code> exists in the first column of range <code>vid</code> <i>and</i> <code>vid</code> is at least four columns wide"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1480458226, "post_id": 40876523, "comment_id": 68968820, "body": "Can you try without usind <code>.FormulaR1C1</code>, just with <code>ActiveCell = Application...</code>?"}, {"owner": {"reputation": 2097, "user_id": 4402759, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/0d2b1f35b8f999526905db3f4b0fefcd?s=128&d=identicon&r=PG&f=1", "display_name": "nbayly", "link": "https://stackoverflow.com/users/4402759/nbayly"}, "edited": false, "score": 0, "creation_date": 1480458420, "post_id": 40876523, "comment_id": 68968913, "body": "I don&#39;t think you can assign a function like that to FormulaR1C1 as it will calculate the WorksheetFunction and just push the result. If you want the formula to remain in the cell that you have to push the formula as a string. If you just want the results of the formula to stay in the cell than use <code>ActiveCell.Value2</code>."}, {"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "reply_to_user": {"reputation": 2097, "user_id": 4402759, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/0d2b1f35b8f999526905db3f4b0fefcd?s=128&d=identicon&r=PG&f=1", "display_name": "nbayly", "link": "https://stackoverflow.com/users/4402759/nbayly"}, "edited": false, "score": 0, "creation_date": 1480460134, "post_id": 40876523, "comment_id": 68969687, "body": "@nbayly you <i>can</i> do that assignment, but there is little point.  The end result of assigning a value (in this case the result of the vlookup) to <code>FormulaR1C1</code>, <code>Formula</code>, <code>Value</code>, or <code>Value2</code> is the same"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1480460414, "post_id": 40876523, "comment_id": 68969787, "body": "I can never remember which one does it, but between <code>Application.WorksheetFunction.VLookup</code> (early-bound) and <code>Application.VLookup</code> (late-bound, no intellisense), one will raise a runtime error when the VLOOKUP fails, and the other will <i>return an error value</i> instead. Also, if you intend to set the <i>value</i> of <code>ActiveCell</code>, then set its <code>.Value</code>. If you intend to give it a <i>formula</i>, assign its <code>.Formula</code> with a string that contains that formula. It&#39;s not clear from the code what your intent is."}], "answers": [{"tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": false, "score": 1, "last_activity_date": 1480461167, "last_edit_date": 1480461167, "creation_date": 1480460639, "answer_id": 40877404, "question_id": 40876523, "link": "https://stackoverflow.com/questions/40876523/excel-2013-on-w10-vba-vlookup-in-a-different-worksheet-produces-error-1004/40877404#40877404", "title": "Excel 2013 on W10: VBA Vlookup in a different worksheet produces error 1004", "body": "<p>Your lookup is simply failing, and the error message is utterly misleading.</p>\n\n<p>It's not that VBA couldn't find the <code>WorksheetFunction.VLookup</code> member, it's just that your VLookup raised an error.</p>\n\n<p>You need to either:</p>\n\n<ul>\n<li>Handle that runtime error with an <code>On Error GoTo</code> statement</li>\n</ul>\n\n<p>Or</p>\n\n<ul>\n<li>Use the late-bound version <code>Application.VLookup</code>, which doesn't give you <em>IntelliSense</em>, but instead of throwing a runtime error when the lookup fails, it will return \"Error 2042\" and you can test whether the lookup failed or not by wrapping it in <code>IsError</code>.</li>\n</ul>\n\n<hr>\n\n<p>Type <code>42</code> in cell <code>A1</code> of the active sheet. Then in the <em>immediate pane</em>:</p>\n\n<pre><code>?iserror(application.VLookup(42,Range(\"A:B\"),1,false))\n</code></pre>\n\n<p>returns <code>False</code></p>\n\n<pre><code>?iserror(application.VLookup(43,Range(\"A:B\"),1,false))\n</code></pre>\n\n<p>returns <code>True</code></p>\n\n<pre><code>?application.WorksheetFunction.VLookup(42,Range(\"A:B\"),1,false)\n</code></pre>\n\n<p>returns <code>42</code></p>\n\n<pre><code>?application.WorksheetFunction.VLookup(43,Range(\"A:B\"),1,false)\n</code></pre>\n\n<p>raises a runtime error:</p>\n\n<p><img src=\"https://i.stack.imgur.com/UcI0V.png\" alt=\"Unable to get the VLookup property of the WorksheetFunction class\"></p>\n\n<p>That message would be better worded as \"VLookup function failed to find specified lookup value in specified lookup range\", or something like that.</p>\n\n<hr>\n\n<p>The reason your lookup is failing is the same any VLOOKUP might fail for: verify your <code>lookup_value</code> actually exists in your <code>lookup_range</code>. Watch out for leading and/or trailing spaces, and \"text-formatted\" columns. In other words, assuming you <em>want</em> to throw a runtime error when the lookup fails, it's a data problem, not a code problem.</p>\n"}], "owner": {"reputation": 1, "user_id": 7227493, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17f9b9ddb851fc1d5d4ded589d4d4f1c?s=128&d=identicon&r=PG&f=1", "display_name": "Bill Compton", "link": "https://stackoverflow.com/users/7227493/bill-compton"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 348, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1480461167, "creation_date": 1480456672, "last_edit_date": 1480456774, "question_id": 40876523, "link": "https://stackoverflow.com/questions/40876523/excel-2013-on-w10-vba-vlookup-in-a-different-worksheet-produces-error-1004", "title": "Excel 2013 on W10: VBA Vlookup in a different worksheet produces error 1004", "body": "<p>I'm developing an application which uses specification codes to vlookup those codes in another spreadsheet, and return vendor numbers from the second spreadsheet to the first, listing them in the same column with the specification code.  </p>\n\n<pre><code>ActiveCell.FormulaR1C1 = Application.WorksheetFunction.VLookup(specsec, [Vendorspec.xlsx!vid], 4)\n</code></pre>\n\n<p>in the above code line:</p>\n\n<ul>\n<li>specsec is the specification code, of the form XX XX XX.XX</li>\n<li>The name of the vlookup target file is \"VendorSpec.xlsx\".  In this worksheet, each code is a unique entry in column 1, with the first of several vendor numbers in column 4.  Future code will cycle through the columns, returning all subsequent vendor IDs for the current code. </li>\n</ul>\n\n<p>The code line produces error \"Run-time error '1004': Unable to get the vlookup property of the worksheet function class\".</p>\n\n<p>Can anyone suggest a fix?</p>\n\n<p>Thank you.</p>\n"}, {"tags": ["ms-access", "vba", "ms-access-2013"], "comments": [{"owner": {"reputation": 108, "user_id": 4821289, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c35ff843706b7080567527300d0a021?s=128&d=identicon&r=PG", "display_name": "Matthew Peltzer", "link": "https://stackoverflow.com/users/4821289/matthew-peltzer"}, "edited": false, "score": 0, "creation_date": 1480457021, "post_id": 40876248, "comment_id": 68968270, "body": "On a lark I tried importing the CSV via TransferSpreadsheet, and it mostly worked, except that the same data misinterpretation is occurring.  So I am really at a loss in regards to the 3051 error."}, {"owner": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "edited": false, "score": 1, "creation_date": 1480460570, "post_id": 40876248, "comment_id": 68969853, "body": "Is it possible to include your code in your question (between code tags)"}, {"owner": {"reputation": 4173, "user_id": 2895550, "user_type": "registered", "profile_image": "https://graph.facebook.com/1184544414/picture?type=large", "display_name": "Wayne G. Dunn", "link": "https://stackoverflow.com/users/2895550/wayne-g-dunn"}, "edited": false, "score": 0, "creation_date": 1480462023, "post_id": 40876248, "comment_id": 68970395, "body": "Have you checked to see if the &#39;Read Only&#39; attribute is set? Have you tried to move the file to the same folder as the database?"}, {"owner": {"reputation": 108, "user_id": 4821289, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c35ff843706b7080567527300d0a021?s=128&d=identicon&r=PG", "display_name": "Matthew Peltzer", "link": "https://stackoverflow.com/users/4821289/matthew-peltzer"}, "reply_to_user": {"reputation": 4173, "user_id": 2895550, "user_type": "registered", "profile_image": "https://graph.facebook.com/1184544414/picture?type=large", "display_name": "Wayne G. Dunn", "link": "https://stackoverflow.com/users/2895550/wayne-g-dunn"}, "edited": false, "score": 0, "creation_date": 1480477305, "post_id": 40876248, "comment_id": 68974420, "body": "@WayneG.Dunn yes to both, with no difference.  I have also put the file in C:\\Temp\\data.csv to rule out a too-long filepath issue (which I don&#39;t think it is)."}, {"owner": {"reputation": 4173, "user_id": 2895550, "user_type": "registered", "profile_image": "https://graph.facebook.com/1184544414/picture?type=large", "display_name": "Wayne G. Dunn", "link": "https://stackoverflow.com/users/2895550/wayne-g-dunn"}, "edited": false, "score": 1, "creation_date": 1480477788, "post_id": 40876248, "comment_id": 68974565, "body": "Have you tried placing a breakpoint on the line that gets the error and looking at all your variables to make sure they are correct?  Can you post the code you are trying to run (including DIM&#39;s, etc.)?"}, {"owner": {"reputation": 4173, "user_id": 2895550, "user_type": "registered", "profile_image": "https://graph.facebook.com/1184544414/picture?type=large", "display_name": "Wayne G. Dunn", "link": "https://stackoverflow.com/users/2895550/wayne-g-dunn"}, "edited": false, "score": 0, "creation_date": 1480478565, "post_id": 40876248, "comment_id": 68974777, "body": "Below is what I just tried (CSV, w/field names)... does your code look similar? DoCmd.TransferText acImportDelim, , &quot;tablename&quot;, &quot;C:\\temp\\0_Vista.csv&quot;, True"}, {"owner": {"reputation": 108, "user_id": 4821289, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c35ff843706b7080567527300d0a021?s=128&d=identicon&r=PG", "display_name": "Matthew Peltzer", "link": "https://stackoverflow.com/users/4821289/matthew-peltzer"}, "edited": false, "score": 0, "creation_date": 1480519375, "post_id": 40876248, "comment_id": 68997850, "body": "I&#39;ve added my code to my original post.  I&#39;m starting to think its not the code that&#39;s the problem, but perhaps system settings of some sort.  I looked again at the &#39;Read Only&#39; attribute; it is not set for the file being imported, or any other file in the folder, however the folder its self has a blue square in the checkbox (not a checkmark, but a square which I think denotes some contained files are Read Only).  Unsetting the folder&#39;s Read Only attribute appears to work, but when I open the properties dialog for the folder again, the blue square has returned."}, {"owner": {"reputation": 4173, "user_id": 2895550, "user_type": "registered", "profile_image": "https://graph.facebook.com/1184544414/picture?type=large", "display_name": "Wayne G. Dunn", "link": "https://stackoverflow.com/users/2895550/wayne-g-dunn"}, "edited": false, "score": 2, "creation_date": 1480527051, "post_id": 40876248, "comment_id": 69003047, "body": "The reason for your error is because you have opened the Excel file, modified it (added &#39;test&#39; to all of row 2), did NOT close it."}, {"owner": {"reputation": 108, "user_id": 4821289, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c35ff843706b7080567527300d0a021?s=128&d=identicon&r=PG", "display_name": "Matthew Peltzer", "link": "https://stackoverflow.com/users/4821289/matthew-peltzer"}, "edited": false, "score": 0, "creation_date": 1480528407, "post_id": 40876248, "comment_id": 69003886, "body": "That was exactly it.  Only in this case it is not an excel file per se (.xls), but a .csv.  Moving the code that works with excel files out of the way of the code that works with csv files corrects the issue.  The reason I modify the Excel file is to attempt to force Excel/Access to read the data as text rather than a date or number or other format.  I suppose because I was feeding Excel a .csv, some conversion was occurring and the filename wasn&#39;t making it to the error message."}, {"owner": {"reputation": 4173, "user_id": 2895550, "user_type": "registered", "profile_image": "https://graph.facebook.com/1184544414/picture?type=large", "display_name": "Wayne G. Dunn", "link": "https://stackoverflow.com/users/2895550/wayne-g-dunn"}, "edited": false, "score": 0, "creation_date": 1480528917, "post_id": 40876248, "comment_id": 69004196, "body": "I agree it was a CSV, but you opened it in Excel, and since it was hidden you never realized it was opened in a modified state."}], "owner": {"reputation": 108, "user_id": 4821289, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c35ff843706b7080567527300d0a021?s=128&d=identicon&r=PG", "display_name": "Matthew Peltzer", "link": "https://stackoverflow.com/users/4821289/matthew-peltzer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1765, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1594654438, "creation_date": 1480455612, "last_edit_date": 1594654438, "question_id": 40876248, "link": "https://stackoverflow.com/questions/40876248/docmd-transfertext-error-3051", "title": "DoCmd.TransferText error 3051", "body": "<p>I am attempting to import data into my MS Access project via TransferText, but am receiving error #3051: \"The Microsoft Access database engine cannot open or write to the file ''.  It is already opened exclusively by another user, or you need permissions to view and write its data.\"</p>\n\n<p>It is odd to me that the filename given in the error message is blank.  I have checked and rechecked the file name, even to perform a check \"If Not fso.FileExists(file_name) Then ... End If\" prior to the TransferText call.</p>\n\n<p>I have also checked and rechecked the table name and the file permissions.  The table is successfully emptied before the TransferText call, so I know that works.  The file is in a subfolder relative to the Access database file in a folder on my desktop.  I have not set or unset any permissions for any of the folders or files.</p>\n\n<p>Until now I had been using DoCmd.TransferSpreadsheet to import the data that is downloaded from a web based tool, but I found Excel was misinterpreting some alphanumeric codes as numbers in scientific format, such as 1E100 would become 1E+100 in the Excel file, so the data was corrupted before getting to the Access database.  These codes are getting corrupted in uncorrectable ways, so I can't  modify the data after import.  I found I could save the data from the web tool as a CSV file rather than an Excel file; this led me to try to use DoCmd.TransferText.</p>\n\n<p>Below is the code I am using:</p>\n\n<pre><code>Private Function ImportExcel( _\n ByVal file_name As String, _\n ByVal table_name As String _\n) As Integer\n    On Error GoTo Error\n\n    Dim fso As FileSystemObject, folder_name As String\n\n    Dim xl_book As Excel.Workbook\n    Dim xl_sheet As Excel.Worksheet\n\n    Dim i As Integer\n\n' suppress excel's file-not-found popup\n    Set fso = New FileSystemObject\n    If Not fso.FileExists(file_name) Then\n        ImportExcel = -1\n        GoTo Finish\n    End If\n\n' gets a workbook from a global application object\n    Set xl_book = Util.GetExcelWorkbook( _\n        file_name:=file_name, _\n        visible:=False, _\n        use_cache:=True _\n    )\n\n    If xl_book Is Nothing Then\n        ImportExcel = -1\n        GoTo Finish\n    End If\n\n' always use the first worksheet\n    Set xl_sheet = xl_book.Sheets(1)\n\n' fake the first record to force columns types\n    xl_sheet.range(\"A2\").EntireRow.Insert\n    For i = 1 To xl_sheet.UsedRange.columns.count\n        xl_sheet.Cells(2, i) = \"test\"\n    Next i\n\n' make sure the table is closed\n    DoCmd.Close _\n        ObjectType:=acTable, _\n        ObjectName:=table_name, _\n        Save:=acSaveNo\n\n' link to file\n    DoCmd.SetWarnings False\n    If \".csv\" = Right(file_name, 4) Then\n' empty table\n        DoCmd.RunSQL \"DELETE * FROM \" &amp; table_name, True\n' import data\n        Debug.Print table_name\n        Debug.Print file_name\n        DoCmd.TransferText _\n            TransferType:=acImportDelim, _\n            SpecificationName:=table_name &amp; \" Import Spec\", _\n            TableName:=table_name, _\n            FileName:=file_name, _\n            HasFieldNames:=True\n    Else\n' delete table\n        On Error Resume Next\n        DoCmd.DeleteObject _\n            ObjectType:=acTable, _\n            ObjectName:=table_name\n        If 0 &lt;&gt; Err.Number Then\n            Resume Next\n        End If\n        On Error GoTo Error\n' import data\n        DoCmd.TransferSpreadsheet _\n            TransferType:=acImport, _\n            TableName:=table_name, _\n            FileName:=file_name, _\n            HasFieldNames:=True, _\n            range:=xl_sheet.NAME() &amp; \"!\" &amp; _\n                xl_sheet.range( _\n                    xl_sheet.Cells(1, 1), _\n                    xl_sheet.Cells( _\n                        xl_sheet.UsedRange.rows.count, _\n                        xl_sheet.UsedRange.columns.count _\n                    ) _\n                ).Address(RowAbsolute:=False, ColumnAbsolute:=False), _\n            SpreadsheetType:=acSpreadsheetTypeExcel9\n    End If\n    DoCmd.SetWarnings True\n\nFinish:\n    Set xl_sheet = Nothing\n    If Not xl_book Is Nothing Then\n        xl_book.Close SaveChanges:=False\n    End If\n    Set xl_book = Nothing\n\n    Set fso = Nothing\n\n    Exit Function\n\nError:    \n    Resume Finish\nEnd Function\n</code></pre>\n\n<p>The two Debug.Print calls just prior to the DoCmd.TransferText call print exactly what is expected.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 530, "user_id": 6803420, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1g4Lk.jpg?s=128&g=1", "display_name": "Captain Grumpy", "link": "https://stackoverflow.com/users/6803420/captain-grumpy"}, "edited": false, "score": 1, "creation_date": 1480458854, "post_id": 40876016, "comment_id": 68969123, "body": "Without testing it looks like you need to reset your lionecount variable for each file, so under for each varfile throw in a linecount = 0"}, {"owner": {"reputation": 530, "user_id": 6803420, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1g4Lk.jpg?s=128&g=1", "display_name": "Captain Grumpy", "link": "https://stackoverflow.com/users/6803420/captain-grumpy"}, "edited": false, "score": 1, "creation_date": 1480480654, "post_id": 40876016, "comment_id": 68975344, "body": "If you are doing the line number on a workbook by workbook basis you, from the looks of it, would need to relocate the paste data code up to the varFile loop and likely clear it for each iteration."}], "owner": {"reputation": 31, "user_id": 7095841, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/81504fc7aafdb3da2999fcc09fe292bc?s=128&d=identicon&r=PG&f=1", "display_name": "Ravi Gowda", "link": "https://stackoverflow.com/users/7095841/ravi-gowda"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 35, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1480455092, "creation_date": 1480454751, "last_edit_date": 1531164843, "question_id": 40876016, "link": "https://stackoverflow.com/questions/40876016/getting-the-linecount-in-a-collection-of-files", "title": "Getting the linecount in a collection of files?", "body": "<p>Everytime I run this and try to paste it it will just keep incrementing the lineCount for each line it reads.</p>\n\n<p>I want to grab the unique lineCount for each varFile and store it in an array.</p>\n\n<p>How can I do this?</p>\n\n<pre><code>'Collect all data from audit templates\nRecursiveDir colFiles, path, \"*.xlsm\", True\nFor Each varFile In colFiles\n    reportRow = 2\n    Set reportBook = Workbooks.Open(varFile)\n    Set cooSummary = reportBook.Sheets(\"Audit\")\n    reportRow = 2\n    Do While cooSummary.Cells(reportRow, 1) &lt;&gt; \"\"\n        lineCount = lineCount + 1\n        lineNum = lineNum + 1\n        With cooSummary\n            scanDate = FileDateTime(varFile)\n            scanned = lineCount\n            auditor = .Cells(1, 2)\n        End With\n        ReDim Preserve reportArray(3, lineNum)\n        reportArray(0, lineNum) = scanDate\n        reportArray(1, lineNum) = scanned\n        reportArray(2, lineNum) = auditor\n        reportRow = reportRow + 1\n    Loop\nreportBook.Close SaveChanges:=False\nNext varFile\n\n'Paste data into Scan Sheet\nFor lineNum = 1 To UBound(reportArray, 2)\n    With scanSheet\n        .Cells(baseRow, 1) = reportArray(0, lineNum) 'Date Scanned\n        .Cells(baseRow, 2) = reportArray(1, lineNum) 'Scanned\n        .Cells(baseRow, 3) = reportArray(2, lineNum) 'Auditor\n        .Cells(baseRow, 4).Formula = \"=IF(LEN(C\" &amp; baseRow &amp; \")&gt;10,C\" &amp; baseRow &amp; \",IF(LEN(C\" &amp; baseRow &amp; \")&gt;=5,TRIM(LEFT(TRIM(C\" &amp; baseRow &amp; \"),3)), C\" &amp; baseRow &amp; \"))\" 'Auditor1\n        .Cells(baseRow, 5).Formula = \"=IF(LEN(C\" &amp; baseRow &amp; \")&gt;10,\"\"\"\",IF(LEN(C\" &amp; baseRow &amp; \")&gt;=5,TRIM(RIGHT(TRIM(C\" &amp; baseRow &amp; \"),3)), \"\"\"\"))\" 'Auditor 2\n        .Cells(baseRow, 6).Formula = \"=IF(E\" &amp; baseRow &amp; \"=\"\"\"\",B\" &amp; baseRow &amp; \",B\" &amp; baseRow &amp; \"/2)\" 'Average Scanned\n        .Cells(baseRow, 7).Formula = \"=IF(AND(ISNA(VLOOKUP(D\" &amp; baseRow &amp; \",Summary!A:C,1,0)),ISNA(VLOOKUP(E\" &amp; baseRow &amp; \",Summary!A:C,1,0))),\"\"MISSING\"\",\"\"GOOD\"\")\" 'Auditor CK\n    End With\n    baseRow = baseRow + 1\nNext lineNum\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 1, "creation_date": 1480454725, "post_id": 40875815, "comment_id": 68967153, "body": "It may be due to hardware, but I couldn&#39;t put a string longer than 318,341,104 total length in characters in the ID field.  That length and lower was fine, and seeing as how the entire Lord of the Rings trilogy contains 481,103 words, each word would have to have a length of over 650 characters in order to reach that character limit.  So that&#39;s a really large number and not really limiting at all.  It handles numbers the same way Excel cells handle numbers (precision to 15 digits, same large and small limitations as Double variables).  It can also only seem to handle ascii characters"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1480455545, "post_id": 40875815, "comment_id": 68967538, "body": "Option 3 - store in cell comments"}, {"owner": {"reputation": 145, "user_id": 5443708, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/64xZJ.jpg?s=128&g=1", "display_name": "NamSandStorm", "link": "https://stackoverflow.com/users/5443708/namsandstorm"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1480455657, "post_id": 40875815, "comment_id": 68967610, "body": "@TimWilliams yes, I have done that too in the past, I did not specify that the meta information should be hidden from view. let me amend the question"}, {"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 1, "creation_date": 1480458598, "post_id": 40875815, "comment_id": 68969002, "body": "Storing data in <code>ID</code> does not persist across a file close/reopen.  Is this an issue for you?"}, {"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 0, "creation_date": 1480458732, "post_id": 40875815, "comment_id": 68969063, "body": "Option 4 - hidden <code>Names</code>, Option 5 - <a href=\"https://msdn.microsoft.com/en-us/library/bb608618(v=vs.100).aspx\" rel=\"nofollow noreferrer\">Custom XML Parts</a>"}, {"owner": {"reputation": 145, "user_id": 5443708, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/64xZJ.jpg?s=128&g=1", "display_name": "NamSandStorm", "link": "https://stackoverflow.com/users/5443708/namsandstorm"}, "reply_to_user": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 0, "creation_date": 1480493565, "post_id": 40875815, "comment_id": 68980597, "body": "@chrisneilsen For what I have been doing, having the info persistent was not necessary, but I honestly did not realise that the data is dropped when closing Excel."}], "owner": {"reputation": 145, "user_id": 5443708, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/64xZJ.jpg?s=128&g=1", "display_name": "NamSandStorm", "link": "https://stackoverflow.com/users/5443708/namsandstorm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 97, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1480455769, "creation_date": 1480453863, "last_edit_date": 1531161705, "question_id": 40875815, "link": "https://stackoverflow.com/questions/40875815/options-to-add-information-to-cells-other-than-in-the-cell-itself-in-excel-usin", "title": "options to add information to cells, other than in the cell itself in Excel using VBA", "body": "<p>I need to store custom information (metadata) together with some cells in Excel using VBA.</p>\n\n<p>Option 1 seems to be the common solution, Option 2 is the one I devised. </p>\n\n<p>Option 1: The first (standard) solution I found online is the method of using another worksheet to store the additional information. This worksheet is then hidden from view to the user. I find this a little awkward. </p>\n\n<p>Option 2: Unless the worksheet is intended to be exported to html, the .ID parameter of the cell is going to be unused. So all one has to do is change the ID to whatever data one wants to store, and voila! Instant spare data field. </p>\n\n<p>As hinted at, care has to be taken when exporting to html, however.</p>\n\n<p>Option 3: One could use the comments. But in this case the information would be exposed to the user. If it is a lot of info, it may be annoying. If it is important information, the user may modify / delete it.</p>\n\n<p>Now my questions:</p>\n\n<p>a) Is there another way to store data together with a cell other than the two options above? </p>\n\n<p>b) has anyone used Option B before and found any limits (except html related). I have not tested how much data one can store in this field. Any ideas?</p>\n"}, {"tags": ["vba", "excel", "listbox"], "comments": [{"owner": {"reputation": 4173, "user_id": 2895550, "user_type": "registered", "profile_image": "https://graph.facebook.com/1184544414/picture?type=large", "display_name": "Wayne G. Dunn", "link": "https://stackoverflow.com/users/2895550/wayne-g-dunn"}, "edited": false, "score": 0, "creation_date": 1480453254, "post_id": 40875504, "comment_id": 68966479, "body": "On close, you could save the dimension in a hidden sheet / cell, then on open, resize?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1480454760, "post_id": 40875504, "comment_id": 68967177, "body": "&quot;sharing&quot; is confusing here. Please clarify/confirm that we&#39;re not talking about a <i>shared workbook</i> (which are famously broken in all kinds of ways)."}, {"owner": {"reputation": 777, "user_id": 1218959, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/37cdc38e927f8909e66e091d25282f41?s=128&d=identicon&r=PG", "display_name": "tempidope", "link": "https://stackoverflow.com/users/1218959/tempidope"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1480455872, "post_id": 40875504, "comment_id": 68967691, "body": "@Mat&#39;sMug I meant attaching as an email attachment over outlook."}, {"owner": {"reputation": 777, "user_id": 1218959, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/37cdc38e927f8909e66e091d25282f41?s=128&d=identicon&r=PG", "display_name": "tempidope", "link": "https://stackoverflow.com/users/1218959/tempidope"}, "reply_to_user": {"reputation": 4173, "user_id": 2895550, "user_type": "registered", "profile_image": "https://graph.facebook.com/1184544414/picture?type=large", "display_name": "Wayne G. Dunn", "link": "https://stackoverflow.com/users/2895550/wayne-g-dunn"}, "edited": false, "score": 0, "creation_date": 1480455920, "post_id": 40875504, "comment_id": 68967712, "body": "@WayneG.Dunn That would still need a macro, which means that code should trigger right after &quot;Enable Content&quot; is clicked. I&#39;m not able to figure out the event for this."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1480456105, "post_id": 40875504, "comment_id": 68967822, "body": "@JKarthik &quot;on open&quot; would be the <code>Workbook_Open</code> event handler, in <code>ThisWorkbook</code>. Can you tell us what the property values are for the listbox control? Is it configured to &quot;move and size with cells&quot;?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1480456191, "post_id": 40875504, "comment_id": 68967875, "body": "FWIW I can&#39;t repro in Excel 2010 (64-bit)."}, {"owner": {"reputation": 777, "user_id": 1218959, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/37cdc38e927f8909e66e091d25282f41?s=128&d=identicon&r=PG", "display_name": "tempidope", "link": "https://stackoverflow.com/users/1218959/tempidope"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1480456299, "post_id": 40875504, "comment_id": 68967923, "body": "@Mat&#39;sMug It&#39;s Move and Don&#39;t Size With Cells"}, {"owner": {"reputation": 4173, "user_id": 2895550, "user_type": "registered", "profile_image": "https://graph.facebook.com/1184544414/picture?type=large", "display_name": "Wayne G. Dunn", "link": "https://stackoverflow.com/users/2895550/wayne-g-dunn"}, "edited": false, "score": 0, "creation_date": 1480461276, "post_id": 40875504, "comment_id": 68970123, "body": "So currently the user must go to Trust Center to Enable Content? Maybe you could have a &#39;main form&#39; that set&#39;s the size as required. I simply tested resizing an ActiveX control (for an Image)."}, {"owner": {"reputation": 777, "user_id": 1218959, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/37cdc38e927f8909e66e091d25282f41?s=128&d=identicon&r=PG", "display_name": "tempidope", "link": "https://stackoverflow.com/users/1218959/tempidope"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1481128818, "post_id": 40875504, "comment_id": 69252682, "body": "@Mat&#39;sMug you&#39;re suggestion for Workbook_Open helped. Move it to answer and I&#39;ll accept it."}], "answers": [{"comments": [{"owner": {"reputation": 852, "user_id": 6563468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a4c2119cfc1ee9a6c5deeec2ead9a261?s=128&d=identicon&r=PG&f=1", "display_name": "Logan Reed", "link": "https://stackoverflow.com/users/6563468/logan-reed"}, "edited": false, "score": 1, "creation_date": 1480458049, "post_id": 40876461, "comment_id": 68968732, "body": "I had the same problem during presentations and it is infuriating. I have better luck with <code>MSForms</code> controls instead of <code>ActiveX</code> at the price of lesser functionality."}], "tags": [], "owner": {"reputation": 170, "user_id": 6142378, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/593e89e4256dd201a541c13e29abdf5d?s=128&d=identicon&r=PG&f=1", "display_name": "Dammer15", "link": "https://stackoverflow.com/users/6142378/dammer15"}, "is_accepted": false, "score": 1, "last_activity_date": 1480456452, "creation_date": 1480456452, "answer_id": 40876461, "question_id": 40875504, "link": "https://stackoverflow.com/questions/40875504/vba-activex-control-changes-size-after-sharing/40876461#40876461", "title": "VBA ActiveX control changes size after sharing", "body": "<p>Your problem has nothing to do with sharing the document via email. It has everything to do with window scaling. To prove this to yourself try connecting to a projector with the the excel document open. Use some Active X controls and they will shrink or Expand. I've had this problem and found the only way to avoid it in a reasonable manor is to implant a form inside the excel document that holds all the needed controls or ensure the end user is not scaling their display in any manor.</p>\n"}], "owner": {"reputation": 777, "user_id": 1218959, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/37cdc38e927f8909e66e091d25282f41?s=128&d=identicon&r=PG", "display_name": "tempidope", "link": "https://stackoverflow.com/users/1218959/tempidope"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 213, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1480456452, "creation_date": 1480452526, "question_id": 40875504, "link": "https://stackoverflow.com/questions/40875504/vba-activex-control-changes-size-after-sharing", "title": "VBA ActiveX control changes size after sharing", "body": "<p>I have a simple excel form with an ActiveX control (ListBox)</p>\n\n<p>When I share this over email, the recipient does the following steps:\n1. Open the excel\n2. Enable Content for the macro</p>\n\n<p>Now - the ListBox grows in size. </p>\n\n<p>I'm unable to dynamically resize or figure out the exact event for \"Enable Content\".</p>\n\n<p>Is there anyway I can retain the dimensions of the ListBox?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 3, "creation_date": 1480451209, "post_id": 40875143, "comment_id": 68965399, "body": "You don&#39;t really state what the <i>actual problem</i> is. Hard to help without knowing specific problem."}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1480454344, "post_id": 40875143, "comment_id": 68966960, "body": "As Scott said, we can only guess.Here&#39;s one guess: what if many of the worksheets you are copying have the same name?"}, {"owner": {"reputation": 5, "user_id": 6693573, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-38gVlHsfjfo/AAAAAAAAAAI/AAAAAAAAAEY/e66OSajagMU/photo.jpg?sz=128", "display_name": "Rafael Clemente", "link": "https://stackoverflow.com/users/6693573/rafael-clemente"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1480456994, "post_id": 40875143, "comment_id": 68968253, "body": "@Scott Holtzman Hi, Sorry about that. I thought I did. When I run the code it needs to get the name of each sheet from the old workbook and make new sheets in the new workbook with those names. Also needs to copy the information that is in each worksheet to the new sheets in the new workbook."}, {"owner": {"reputation": 5, "user_id": 6693573, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-38gVlHsfjfo/AAAAAAAAAAI/AAAAAAAAAEY/e66OSajagMU/photo.jpg?sz=128", "display_name": "Rafael Clemente", "link": "https://stackoverflow.com/users/6693573/rafael-clemente"}, "reply_to_user": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1480456998, "post_id": 40875143, "comment_id": 68968257, "body": "@A.S.H None of the sheets will ever have the same name. Each of the worksheets are label by the date they have entered the information."}], "answers": [{"comments": [{"owner": {"reputation": 5, "user_id": 6693573, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-38gVlHsfjfo/AAAAAAAAAAI/AAAAAAAAAEY/e66OSajagMU/photo.jpg?sz=128", "display_name": "Rafael Clemente", "link": "https://stackoverflow.com/users/6693573/rafael-clemente"}, "edited": false, "score": 0, "creation_date": 1480463256, "post_id": 40877462, "comment_id": 68970793, "body": "Thanks, I will try this out. I was thinking about splitting the workload with <code>i = 1 To Worksheets.count</code> and <code>For ws in wbCopyFrom</code>."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "is_accepted": true, "score": 0, "last_activity_date": 1480460912, "creation_date": 1480460912, "answer_id": 40877462, "question_id": 40875143, "link": "https://stackoverflow.com/questions/40875143/going-to-each-worksheet-without-going-backwards/40877462#40877462", "title": "Going to each worksheet without going backwards", "body": "<p>There is no reason to activate the sheets.  </p>\n\n<p>Create a function to copy the Template and return a reference to the new worksheet.</p>\n\n<p><code>For each ws in Worksheets</code> is preferable over <code>For i = 1 to Worksheets.Count</code></p>\n\n<p>If you just want to copy the values of a contiguous range, it is better to do a direct assignment <code>Range(\"B1:B10\").Value =</code>Range(\"A1:A10\").VAlue<code>as opposed to</code>Range(\"A1:A10\").Copy: <code>Range(\"B1:B10\").PasteSpecial xlPasteValues</code></p>\n\n<p>The <code>Worksheets</code> collection starts at index 1. This loop ships the last worksheet.</p>\n\n<pre><code>sheetcounts = wbCopyFrom.Worksheets.Count - 1 \n\n\n\nSet wsCopyFrom = wbCopyFrom.Worksheets(Sheets.Count)\n\nSub CpyOldTest()\n    Dim vFile As Variant\n    Dim wbCopyFrom As Workbook, wsTemplate As Workbook\n    Dim ws As Worksheet\n    'On Error Resume Next\n    Set wsTemplate = ThisWorkbook.Worksheets(\"Template\")\n\n    '-------------------------------------------------------------\n    'Open file with data to be copied\n    vFile = Application.GetOpenFilename(\"Excel Files (*.xl*),\" &amp; _\n                                        \"*.xl*\", 1, \"Select Excel File\", \"Open\", False)\n\n    'If Cancel then Exit\n    If TypeName(vFile) = \"Boolean\" Then\n        Exit Sub\n    Else\n        Application.ScreenUpdating = False\n        Set wbCopyFrom = Workbooks.Open(vFile)\n        For Each ws In wbCopyFrom.Worksheets\n            With getTemplateCopy\n                .Name = ws.Name\n                .Range(\"B2:B10\").Value = ws.Range(\"B2:B10\").Value      'Patient Information\n                .Range(\"C12:C17\").Value = ws.Range(\"C12:C17\").Value    'Physician and Home Health care\n                .Range(\"B19:D21\").Value = ws.Range(\"B19:D21\").Value    'Diagnosis/TPN/Assessment Type\n                '-------------------------------------------------------------------\n                'Calculated Needs\n                .Range(\"E5\").Value = ws.Range(\"E5\").Value\n                .Range(\"E7\").Value = ws.Range(\"E7\").Value\n                .Range(\"E9:E10\").Value = ws.Range(\"E9:E10\").Value\n                .Range(\"E12:E14\").Value = ws.Range(\"E12:E14\").Value\n                '-------------------------------------------------------------------\n                .Range(\"B23:C28\").Value = ws.Range(\"B23:C28\").Value    'Intake/Lipids\n                .Range(\"C30:C37\").Value = ws.Range(\"C30:C37\").Value  'TPN Components\n                .Range(\"F1\").Value = ws.Range(\"F1\").Value    'IBW adjustment\n                '.Range(\"F12\").value = ws.Range (\"F12\").value 'Protein Needs\n                .Range(\"E19:F23\").Value = ws.Range(\"E19:F23\").Value  'Notes\n                '-------------------------------------------------------------------\n                .Range(\"D23\").Value = ws.Range(\"D23\").Value    'Intake\n                .Range(\"D25\").Value = ws.Range(\"D25\").Value    'Amino Acid\n                .Range(\"D27\").Value = ws.Range(\"D27\").Value    'Total MLs\n                .Range(\"D29\").Value = ws.Range(\"D29\").Value    'KCal\n                .Range(\"E25:E27\").Value = ws.Range(\"E25:E27\").Value    'IV/Lipid/Fluid Bags\n                .Range(\"F29:F30\").Value = ws.Range(\"F29:F30\").Value    'Access Device\n                .Range(\"F32\").Value = ws.Range(\"F33\").Value    'Lab Frequency\n                '-------------------------------------------------------------------\n                'Lab Data\n                .Range(\"J2:P12\").Value = ws.Range(\"J2:P12\").Value\n                .Range(\"J14:P32\").Value = ws.Range(\"J14:P32\").Value\n                .Range(\"G4:H32\").Value = ws.Range(\"G4:H32\").Value\n                .Range(\"I25:I32\").Value = ws.Range(\"I25:I32\").Value\n                .Range(\"K37:P44\").Value = ws.Range(\"K34:P41\").Value    'TPN\n                .Range(\"K46:P53\").Value = ws.Range(\"K43:P50\").Value\n                '------------------------------------------------------------------\n                .Range(\"B42:F42\").Value = ws.Range(\"B39:F39\").Value    'Additives\n                .Range(\"A44:F50\").Value = ws.Range(\"A41:F47\").Value    'Subjective\n                .Range(\"A53:F53\").Value = ws.Range(\"A50:F50\").Value    'Meds\n                .Range(\"A56:F59\").Value = ws.Range(\"A53:F56\").Value    'Assessment Diagnosis\n                .Range(\"A62:F66\").Value = ws.Range(\"A59:F63\").Value  'Nutrition Goals\n                .Range(\"A69:F75\").Value = ws.Range(\"A66:F72\").Value    'Plan of Care\n                '------------------------------------------------------------------\n                .Range(\"K65:P70\").Value = ws.Range(\"K62:P67\").Value    'List of Dietitians\n                .Range(\"C76:C77\").Value = ws.Range(\"C73:C74\").Value    'Dates\n                .Range(\"B78:H78\").Value = ws.Range(\"B75:H75\").Value    'Education\n                .Range(\"B79:D79\").Value = ws.Range(\"B76:D76\").Value    'Discussed\n                .Range(\"A82:B82\").Value = ws.Range(\"A79:B80\").Value    'Dietitian\n                .Range(\"D82:E82\").Value = ws.Range(\"D79:E79\").Value    'Evaluation\n                '------------------------------------------------------------------\n                'Pharmacy Information\n                .Range(\"B89:D90\").Value = ws.Range(\"B86:D87\").Value\n                .Range(\"B91:B92\").Value = ws.Range(\"B88:B89\").Value\n                '------------------------------------------------------------------\n                .Range(\"G89:G92\").Value = ws.Range(\"G86:G89\").Value    'Next due dates\n            End With\n        Next\n\n        'Close file that was opened\n        wbCopyFrom.Close SaveChanges:=False\n\n        Application.ScreenUpdating = True\n    End If\n\nEnd Sub\n\nFunction getTemplateCopy() As Worksheet\n    Dim ws As Worksheet\n    Set ws = ThisWorkbook.Worksheets(\"Template\")\n    ws.Copy After:=ws\n    Set getTemplateCopy = ThisWorkbook.ActiveSheet\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 5, "user_id": 6693573, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-38gVlHsfjfo/AAAAAAAAAAI/AAAAAAAAAEY/e66OSajagMU/photo.jpg?sz=128", "display_name": "Rafael Clemente", "link": "https://stackoverflow.com/users/6693573/rafael-clemente"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 106, "favorite_count": 0, "accepted_answer_id": 40877462, "answer_count": 1, "score": 0, "last_activity_date": 1480460912, "creation_date": 1480451047, "last_edit_date": 1480451271, "question_id": 40875143, "link": "https://stackoverflow.com/questions/40875143/going-to-each-worksheet-without-going-backwards", "title": "Going to each worksheet without going backwards", "body": "<p>I'm having a hard time trying to go through each worksheet in a workbook, get the name of a worksheet from another workbook and rename my main workbook worksheet. So, right now I have it so that the user can select a file they want to copy over to a new workbook with a different layout then the old one they have used. Then it gets the count of how many worksheets are in the old workbook and copies the worksheet in the new (Main)workbook. Afterwards it gets the name of each tab and renames the worksheet in the new (Main)workbook. </p>\n\n<p>Mostly having trouble in this area of the code </p>\n\n<pre><code>For i = 1 To sheetcounts\n            wbCopyTo.Activate\n            wsCopyTo.Copy After:=ActiveSheet\n            wbCopyTo.Worksheets(1).Activate\n            'wbCopyFrom.Sheets(ActiveSheet.Index + 1).Select\n            wbCopyFrom.ActiveSheet.Next.Activate\n\n            wbCopyTo.ActiveSheet.Name = wbCopyFrom.ActiveSheet.Name\n</code></pre>\n\n<p>Here is the whole thing</p>\n\n<pre><code> `Sub CpyOldTest()\nDim vFile As Variant\nDim wbCopyTo As Workbook\nDim wsCopyTo As Worksheet\nDim wbCopyFrom As Workbook\nDim wsCopyFrom As Worksheet\nDim cCounter As Integer\nDim rCounter As Integer\n\nDim sheetcounts As Integer\nDim i As Integer\n\n\nSet wbCopyTo = ThisWorkbook\nSet wsCopyTo = ActiveSheet\n\n'On Error Resume Next\n\n\n\n    '-------------------------------------------------------------\n    'Open file with data to be copied\n    vFile = Application.GetOpenFilename(\"Excel Files (*.xl*),\" &amp; _\n    \"*.xl*\", 1, \"Select Excel File\", \"Open\", False)\n\n    'If Cancel then Exit\n    If TypeName(vFile) = \"Boolean\" Then\n        Exit Sub\n    Else\n        Set wbCopyFrom = Workbooks.Open(vFile)\n        Set wsCopyFrom = wbCopyFrom.Worksheets(Sheets.Count)\n        'Get Count and Copy\n        sheetcounts = wbCopyFrom.Worksheets.Count - 1\n\n        For i = 1 To sheetcounts\n            wbCopyTo.Activate\n            wsCopyTo.Copy After:=ActiveSheet\n            wbCopyTo.Worksheets(1).Activate\n            'wbCopyFrom.Sheets(ActiveSheet.Index + 1).Select\n            wbCopyFrom.ActiveSheet.Next.Activate\n\n            wbCopyTo.ActiveSheet.Name = wbCopyFrom.ActiveSheet.Name\n\n            'Copy Range\n     Application.ScreenUpdating = False\n            'Patient Information\n     wsCopyFrom.Range(\"B2:B10\").Copy\n     wsCopyTo.Range(\"B2:B10\").PasteSpecial Paste:=xlPasteValues, _\n            Operation:=xlNone, SkipBlanks:=False, Transpose:=False\n            'Physician and Home Health care\n     wsCopyFrom.Range(\"C12:C17\").Copy\n     wsCopyTo.Range(\"C12:C17\").PasteSpecial Paste:=xlPasteValues, _\n            Operation:=xlNone, SkipBlanks:=False, Transpose:=False\n            'Diagnosis/TPN/Assessment Type\n     wsCopyFrom.Range(\"B19:D21\").Copy\n     wsCopyTo.Range(\"B19:D21\").PasteSpecial Paste:=xlPasteValues, _\n            Operation:=xlNone, SkipBlanks:=False, Transpose:=False\n            'Calculated Needs\n     wsCopyFrom.Range(\"E5\").Copy\n     wsCopyTo.Range(\"E5\").PasteSpecial Paste:=xlPasteValues, _\n            Operation:=xlNone, SkipBlanks:=False, Transpose:=False\n     wsCopyFrom.Range(\"E7\").Copy\n     wsCopyTo.Range(\"E7\").PasteSpecial Paste:=xlPasteValues, _\n            Operation:=xlNone, SkipBlanks:=False, Transpose:=False\n     wsCopyFrom.Range(\"E9:E10\").Copy\n     wsCopyTo.Range(\"E9:E10\").PasteSpecial Paste:=xlPasteValues, _\n            Operation:=xlNone, SkipBlanks:=False, Transpose:=False\n     wsCopyFrom.Range(\"E12:E14\").Copy\n     wsCopyTo.Range(\"E12:E14\").PasteSpecial Paste:=xlPasteValues, _\n            Operation:=xlNone, SkipBlanks:=False, Transpose:=False\n            'Intake/Lipids\n     wsCopyFrom.Range(\"B23:C28\").Copy\n     wsCopyTo.Range(\"B23:C28\").PasteSpecial Paste:=xlPasteValues, _\n            Operation:=xlNone, SkipBlanks:=False, Transpose:=False\n            'TPN Components\n     wsCopyFrom.Range(\"C30:C37\").Copy\n     wsCopyTo.Range(\"C30:C37\").PasteSpecial Paste:=xlPasteValues, _\n            Operation:=xlNone, SkipBlanks:=False, Transpose:=False\n            'IBW adjustment\n     wsCopyFrom.Range(\"F1\").Copy\n     wsCopyTo.Range(\"F1\").PasteSpecial Paste:=xlPasteValues, _\n            Operation:=xlNone, SkipBlanks:=False, Transpose:=False\n            'Protein Needs\n     'wsCopyFrom.Range(\"F12\").Copy\n     'wsCopyTo.Range(\"F12\").PasteSpecial Paste:=xlPasteValues, _\n            Operation:=xlNone, SkipBlanks:=False, Transpose:=False\n            'Notes\n     wsCopyFrom.Range(\"E19:F23\").Copy\n     wsCopyTo.Range(\"E19:F23\").PasteSpecial Paste:=xlPasteValues, _\n            Operation:=xlNone, SkipBlanks:=False, Transpose:=False\n            'Intake\n     wsCopyFrom.Range(\"D23\").Copy\n     wsCopyTo.Range(\"D23\").PasteSpecial Paste:=xlPasteValues, _\n            Operation:=xlNone, SkipBlanks:=False, Transpose:=False\n            'Amino Acid\n     wsCopyFrom.Range(\"D25\").Copy\n     wsCopyTo.Range(\"D25\").PasteSpecial Paste:=xlPasteValues, _\n            Operation:=xlNone, SkipBlanks:=False, Transpose:=False\n            'Total MLs\n     wsCopyFrom.Range(\"D27\").Copy\n     wsCopyTo.Range(\"D27\").PasteSpecial Paste:=xlPasteValues, _\n            Operation:=xlNone, SkipBlanks:=False, Transpose:=False\n            'KCal\n     wsCopyFrom.Range(\"D29\").Copy\n     wsCopyTo.Range(\"D29\").PasteSpecial Paste:=xlPasteValues, _\n            Operation:=xlNone, SkipBlanks:=False, Transpose:=False\n            'IV/Lipid/Fluid Bags\n     wsCopyFrom.Range(\"E25:E27\").Copy\n     wsCopyTo.Range(\"E25:E27\").PasteSpecial Paste:=xlPasteValues, _\n            Operation:=xlNone, SkipBlanks:=False, Transpose:=False\n            'Access Device\n     wsCopyFrom.Range(\"F29:F30\").Copy\n     wsCopyTo.Range(\"F29:F30\").PasteSpecial Paste:=xlPasteValues, _\n            Operation:=xlNone, SkipBlanks:=False, Transpose:=False\n            'Lab Frequency\n     wsCopyFrom.Range(\"F33\").Copy\n     wsCopyTo.Range(\"F32\").PasteSpecial Paste:=xlPasteValues, _\n            Operation:=xlNone, SkipBlanks:=False, Transpose:=False\n'-------------------------------------------------------------------\n            'Lab Data\n     wsCopyFrom.Range(\"J2:P12\").Copy\n     wsCopyTo.Range(\"J2:P12\").PasteSpecial Paste:=xlPasteValues, _\n            Operation:=xlNone, SkipBlanks:=False, Transpose:=False\n     wsCopyFrom.Range(\"J14:P32\").Copy\n     wsCopyTo.Range(\"J14:P32\").PasteSpecial Paste:=xlPasteValues, _\n            Operation:=xlNone, SkipBlanks:=False, Transpose:=False\n     wsCopyFrom.Range(\"G4:H32\").Copy\n     wsCopyTo.Range(\"G4:H32\").PasteSpecial Paste:=xlPasteValues, _\n            Operation:=xlNone, SkipBlanks:=False, Transpose:=False\n     wsCopyFrom.Range(\"I25:I32\").Copy\n     wsCopyTo.Range(\"I25:I32\").PasteSpecial Paste:=xlPasteValues, _\n            Operation:=xlNone, SkipBlanks:=False, Transpose:=False\n            'TPN\n     wsCopyFrom.Range(\"K34:P41\").Copy\n     wsCopyTo.Range(\"K37:P44\").PasteSpecial Paste:=xlPasteValues, _\n            Operation:=xlNone, SkipBlanks:=False, Transpose:=False\n     wsCopyFrom.Range(\"K43:P50\").Copy\n     wsCopyTo.Range(\"K46:P53\").PasteSpecial Paste:=xlPasteValues, _\n            Operation:=xlNone, SkipBlanks:=False, Transpose:=False\n'------------------------------------------------------------------\n            'Additives\n     wsCopyFrom.Range(\"B39:F39\").Copy\n     wsCopyTo.Range(\"B42:F42\").PasteSpecial Paste:=xlPasteValues, _\n            Operation:=xlNone, SkipBlanks:=False, Transpose:=False\n            'Subjective\n     wsCopyFrom.Range(\"A41:F47\").Copy\n     wsCopyTo.Range(\"A44:F50\").PasteSpecial Paste:=xlPasteValues, _\n            Operation:=xlNone, SkipBlanks:=False, Transpose:=False\n            'Meds\n     wsCopyFrom.Range(\"A50:F50\").Copy\n     wsCopyTo.Range(\"A53:F53\").PasteSpecial Paste:=xlPasteValues, _\n            Operation:=xlNone, SkipBlanks:=False, Transpose:=False\n            'Assessment Diagnosis\n     wsCopyFrom.Range(\"A53:F56\").Copy\n     wsCopyTo.Range(\"A56:F59\").PasteSpecial Paste:=xlPasteValues, _\n            Operation:=xlNone, SkipBlanks:=False, Transpose:=False\n            'Nutrition Goals\n     wsCopyFrom.Range(\"A59:F63\").Copy\n     wsCopyTo.Range(\"A62:F66\").PasteSpecial Paste:=xlPasteValues, _\n            Operation:=xlNone, SkipBlanks:=False, Transpose:=False\n            'Plan of Care\n     wsCopyFrom.Range(\"A66:F72\").Copy\n     wsCopyTo.Range(\"A69:F75\").PasteSpecial Paste:=xlPasteValues, _\n            Operation:=xlNone, SkipBlanks:=False, Transpose:=False\n'------------------------------------------------------------------\n            'List of Dietitians\n     wsCopyFrom.Range(\"K62:P67\").Copy\n     wsCopyTo.Range(\"K65:P70\").PasteSpecial Paste:=xlPasteValues, _\n            Operation:=xlNone, SkipBlanks:=False, Transpose:=False\n            'Dates\n     wsCopyFrom.Range(\"C73:C74\").Copy\n     wsCopyTo.Range(\"C76:C77\").PasteSpecial Paste:=xlPasteValues, _\n            Operation:=xlNone, SkipBlanks:=False, Transpose:=False\n            'Education\n     wsCopyFrom.Range(\"B75:H75\").Copy\n     wsCopyTo.Range(\"B78:H78\").PasteSpecial Paste:=xlPasteValues, _\n            Operation:=xlNone, SkipBlanks:=False, Transpose:=False\n            'Discussed\n     wsCopyFrom.Range(\"B76:D76\").Copy\n     wsCopyTo.Range(\"B79:D79\").PasteSpecial Paste:=xlPasteValues, _\n            Operation:=xlNone, SkipBlanks:=False, Transpose:=False\n            'Dietitian\n     wsCopyFrom.Range(\"A79:B80\").Copy\n     wsCopyTo.Range(\"A82:B82\").PasteSpecial Paste:=xlPasteValues, _\n            Operation:=xlNone, SkipBlanks:=False, Transpose:=False\n            'Evaluation\n     wsCopyFrom.Range(\"D79:E79\").Copy\n     wsCopyTo.Range(\"D82:E82\").PasteSpecial Paste:=xlPasteValues, _\n            Operation:=xlNone, SkipBlanks:=False, Transpose:=False\n            'Pharmacy Information\n     wsCopyFrom.Range(\"B86:D87\").Copy\n     wsCopyTo.Range(\"B89:D90\").PasteSpecial Paste:=xlPasteValues, _\n            Operation:=xlNone, SkipBlanks:=False, Transpose:=False\n     wsCopyFrom.Range(\"B88:B89\").Copy\n     wsCopyTo.Range(\"B91:B92\").PasteSpecial Paste:=xlPasteValues, _\n            Operation:=xlNone, SkipBlanks:=False, Transpose:=False\n            'Next due dates\n     wsCopyFrom.Range(\"G86:G89\").Copy\n     wsCopyTo.Range(\"G89:G92\").PasteSpecial Paste:=xlPasteValues, _\n            Operation:=xlNone, SkipBlanks:=False, Transpose:=False\n        Next i\n\n    'Close file that was opened\n    wbCopyFrom.Close SaveChanges:=False\n    Application.ScreenUpdating = True\n\n    End If\n\nEnd Sub\n</code></pre>\n\n<p>I've tried many ways to get pass this and still no luck. Just wondering if I can get some help here. Sorry about the bad layout of the code just trying to get this done before I clean it up. Thank you.</p>\n"}, {"tags": ["vba", "macros"], "comments": [{"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1480454834, "post_id": 40875053, "comment_id": 68967204, "body": "What is the exact key combination you are pressing to run it?"}, {"owner": {"reputation": 11, "user_id": 7048770, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dca5081e668ba70834b981c981ec00e1?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew", "link": "https://stackoverflow.com/users/7048770/andrew"}, "reply_to_user": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1480455242, "post_id": 40875053, "comment_id": 68967415, "body": "Alt + Ctrl + Enter"}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 7048770, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dca5081e668ba70834b981c981ec00e1?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew", "link": "https://stackoverflow.com/users/7048770/andrew"}, "edited": false, "score": 0, "creation_date": 1480456916, "post_id": 40876244, "comment_id": 68968216, "body": "Unfortunately still no result on when the key is pressed"}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "reply_to_user": {"reputation": 11, "user_id": 7048770, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dca5081e668ba70834b981c981ec00e1?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew", "link": "https://stackoverflow.com/users/7048770/andrew"}, "edited": false, "score": 0, "creation_date": 1480457724, "post_id": 40876244, "comment_id": 68968611, "body": "@Andrew did you try to use any other key combination with the same code for the same function? I mean try to narrow the problem by verifying if it is only due to the key combination, to the place you call it (in Workbook_open, etc..? (p.s: it worked perfectly for me)"}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "reply_to_user": {"reputation": 11, "user_id": 7048770, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dca5081e668ba70834b981c981ec00e1?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew", "link": "https://stackoverflow.com/users/7048770/andrew"}, "edited": false, "score": 1, "creation_date": 1480457926, "post_id": 40876244, "comment_id": 68968682, "body": "@Andrew and by the way, try to move the macro to an independent code <code>Module</code>, not in the workbook&#39;s code module."}], "tags": [], "owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "is_accepted": false, "score": 0, "last_activity_date": 1480457967, "last_edit_date": 1480457967, "creation_date": 1480455594, "answer_id": 40876244, "question_id": 40875053, "link": "https://stackoverflow.com/questions/40875053/onkey-macro-linking/40876244#40876244", "title": ".OnKey Macro linking", "body": "<p>If you want the <code>Ctrl + Alt + Enter</code> combination, remove the <code>{}</code> from the key:</p>\n\n<pre><code>Application.OnKey \"^%~\", \"DailyStatusSorter\"\n</code></pre>\n\n<p>If you keep <code>\"^%{~}\"</code>, you will need to press <code>Ctrl + Alt + Shift + ~</code></p>\n\n<p>p.s.: move the macro to an independent code Module, not in the workbook's code module</p>\n"}], "owner": {"reputation": 11, "user_id": 7048770, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dca5081e668ba70834b981c981ec00e1?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew", "link": "https://stackoverflow.com/users/7048770/andrew"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 22, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1480457967, "creation_date": 1480450693, "last_edit_date": 1480456557, "question_id": 40875053, "link": "https://stackoverflow.com/questions/40875053/onkey-macro-linking", "title": ".OnKey Macro linking", "body": "<p>Here is my code. All the macros work when their respective key is pressed except the <code>Sorter</code>. Not sure why the <code>Handler</code> is not calling the macro when the key is pressed. Any ideas?</p>\n\n<pre><code>Public Sub Workbook_Open()\nApplication.OnKey \"^%{~}\", \"DailyStatusSorter\"\nEnd Sub\n\nPublic Sub DailyStatusSorter()\n' DailyStatusSorter Macro\n' Sorts Daily Staus buy completed, priority , then date from oldest to newest.\nActiveWorkbook.Worksheets(\"Sheet1\").ListObjects(\"Daily_Status\").Sort.SortFields _\n    .Clear\nActiveWorkbook.Worksheets(\"Sheet1\").ListObjects(\"Daily_Status\").Sort.SortFields _\n    .Add Key:=Range(\"Daily_Status[Last edited by]\"), SortOn:=xlSortOnCellColor _\n    , Order:=xlAscending, DataOption:=xlSortNormal\nActiveWorkbook.Worksheets(\"Sheet1\").ListObjects(\"Daily_Status\").Sort.SortFields _\n    .Add Key:=Range(\"Daily_Status[Priority]\"), SortOn:=xlSortOnValues, Order _\n    :=xlAscending, DataOption:=xlSortNormal\nActiveWorkbook.Worksheets(\"Sheet1\").ListObjects(\"Daily_Status\").Sort.SortFields _\n    .Add Key:=Range(\"Daily_Status[Date]\"), SortOn:=xlSortOnValues, Order:= _\n    xlAscending, DataOption:=xlSortNormal\nWith ActiveWorkbook.Worksheets(\"Sheet1\").ListObjects(\"Daily_Status\").Sort\n    .Header = xlYes\n    .MatchCase = False\n    .Orientation = xlTopToBottom\n    .SortMethod = xlPinYin\n    .Apply\nEnd With\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 3, "creation_date": 1480450650, "post_id": 40874946, "comment_id": 68965078, "body": "You can&#39;t do that directly, but you can emulate it with <code>Worksheet.Change()</code> In the change event, check if the user has just entered a value in C8:C12, and if all of those cells have a value, and if so invoke the macro you want. The Change event acts as a gate keeper."}, {"owner": {"reputation": 15, "user_id": 7143401, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/71b501ffac761fd287ff016476725d55?s=128&d=identicon&r=PG&f=1", "display_name": "Derek", "link": "https://stackoverflow.com/users/7143401/derek"}, "reply_to_user": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1480451743, "post_id": 40874946, "comment_id": 68965665, "body": "How would I go about checking if the cells have a numeric value? I have a Worksheet.Change() running that triggers the macro when the range changes."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1480451812, "post_id": 40874946, "comment_id": 68965705, "body": "Will the values be entered on Sheet1? Same as the PageSetup code? And C8:C12 will be wiped out every time after all the values are entered?"}, {"owner": {"reputation": 15, "user_id": 7143401, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/71b501ffac761fd287ff016476725d55?s=128&d=identicon&r=PG&f=1", "display_name": "Derek", "link": "https://stackoverflow.com/users/7143401/derek"}, "edited": false, "score": 0, "creation_date": 1480451930, "post_id": 40874946, "comment_id": 68965765, "body": "C8:C12 are set to be cleared only when the workbook is opened. The values will all be entered on Sheet1."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 1, "creation_date": 1480452100, "post_id": 40874946, "comment_id": 68965845, "body": "Derek - The code you provided and your question are a bit confusing. If you have worksheet_change event code already, please edit your question with that code and let us know what is not working. The description, code and comments are a bit all over the place."}], "answers": [{"tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 0, "last_activity_date": 1480450929, "creation_date": 1480450929, "answer_id": 40875117, "question_id": 40874946, "link": "https://stackoverflow.com/questions/40874946/trigger-macro-once-all-cells-in-a-range-have-value/40875117#40875117", "title": "Trigger macro once all cells in a range have value", "body": "<pre><code>Public b_is_run As Boolean\n\nPrivate Sub Worksheet_Change(ByVal Target As Range)\n    If Not b_is_run And (WorksheetFunction.CountA(Range(\"c8:C12\")) = 5) Then\n        b_is_run = True\n        Debug.Print \"run here\"\n    End If\nEnd Sub\n\nPublic Sub restart()\n    b_is_run = False\nEnd Sub\n</code></pre>\n\n<p>You have a public boolean <code>b_is_run</code>, which checks whether the code is run once, and if it is, it does not run it again. If you want to restart - close the worksheet or <code>restart()</code></p>\n"}, {"comments": [{"owner": {"reputation": 15, "user_id": 7143401, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/71b501ffac761fd287ff016476725d55?s=128&d=identicon&r=PG&f=1", "display_name": "Derek", "link": "https://stackoverflow.com/users/7143401/derek"}, "edited": false, "score": 0, "creation_date": 1480603674, "post_id": 40883352, "comment_id": 69039305, "body": "Thank you for the help! Everything is working how I would like it to now"}], "tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": true, "score": 0, "last_activity_date": 1480518953, "last_edit_date": 1480518953, "creation_date": 1480493855, "answer_id": 40883352, "question_id": 40874946, "link": "https://stackoverflow.com/questions/40874946/trigger-macro-once-all-cells-in-a-range-have-value/40883352#40883352", "title": "Trigger macro once all cells in a range have value", "body": "<p>my understanding is you have to</p>\n\n<ul>\n<li><p>place the following code in <code>ThisWorkbook</code> code pane:</p>\n\n<pre><code>Private Sub Workbook_Open()\n    Application.ScreenUpdating = False\n    Application.EnableEvents = False '&lt;--| this to avoid subsequent '.Range(\"Inputs\").ClearContents' trigger 'Worksheet_Change()'\n    With Sheet1\n        .Range(\"User\").Value = Environ(\"UserName\")\n        .Range(\"Run_Date\").Value = Format(Date, \"mm/dd/yy\")\n        .Range(\"Inputs\").ClearContents\n    End With\n    Application.Run \"Page_Setup\"\n    Application.EnableEvents = True\n    Application.ScreenUpdating = True\nEnd Sub\n</code></pre></li>\n<li><p>place the following code in your <code>Sheet1</code> code pane:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    With Range(\"Inputs\") '&lt;--| reference your \"inputs\" range\n        If Not Intersect(.Cells, Target) Is Nothing Then '&lt;--| if change affects referenced range\n            If WorksheetFunction.Count(.Cells) = .Cells.Count Then '&lt;--| if referenced range is \"full\" with numbers\n                Application.ScreenUpdating = False\n                Application.EnableEvents = False\n                Sheet1.Unprotect\n                Sheet2.Unprotect\n                On Error GoTo ErrHandler '&lt;--| make sure you always exit this event handler properly\n\n                Application.Run \"Case1\"\n\nErrHandler:     '&lt;--| restore settings\n                Sheet1.Protect '&lt;-- add password if needed\n                Sheet2.Protect '&lt;-- add password if needed\n                Application.ScreenUpdating = True\n                Application.EnableEvents = True\n            End If\n        End If\n    End With\nEnd Sub\n</code></pre></li>\n</ul>\n"}], "owner": {"reputation": 15, "user_id": 7143401, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/71b501ffac761fd287ff016476725d55?s=128&d=identicon&r=PG&f=1", "display_name": "Derek", "link": "https://stackoverflow.com/users/7143401/derek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 307, "favorite_count": 0, "accepted_answer_id": 40883352, "answer_count": 2, "score": 1, "last_activity_date": 1480518953, "creation_date": 1480450291, "last_edit_date": 1480452698, "question_id": 40874946, "link": "https://stackoverflow.com/questions/40874946/trigger-macro-once-all-cells-in-a-range-have-value", "title": "Trigger macro once all cells in a range have value", "body": "<p>I would like to trigger a macro to run only after all of the cells within a given range have a value. I want to have my input range open without the values entered when the workbook was closed. Currently the code below runs when the workbook is opened. </p>\n\n<pre><code>Sub Page_Setup()\n\nSheet1.Unprotect\nApplication.EnableEvents = False\nApplication.ScreenUpdating = False\n\nSheet1.Range(\"Inputs\").Style = \"40% - Accent2\"\nSheet1.Range(\"Calcs\").Style = \"40% - Accent3\"\nSheet1.Range(\"C8:C12\").Value = \"-\"\nSheet1.Range(\"Calcs\").Value = \"-\"\nSheet1.Range(\"C13\").Value = 64\nSheet1.Range(\"C14:C16\").Value = 0\n\nApplication.EnableEvents = True\nApplication.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n\n<p>I want the macro to run once the user has entered a value in each cell from C8 to C12. Thanks in advance for any help. </p>\n\n<p>Edit: </p>\n\n<p>What I would like is for the macro to run only if the range \"C8:C12\" have a numeric value. I prefer to clear that range when the workbook is initially opened to avoid showing the values that were entered (and calculated by the macro) when the workbook was closed. The code below runs when the workbook opens up.</p>\n\n<pre><code>Private Sub Workbook_Open()\n\nApplication.ScreenUpdating = False\n\nSheet1.Range(\"User\").Value = Environ(\"UserName\")\nSheet1.Range(\"Run_Date\").Value = Format(Date, \"mm/dd/yy\")\nApplication.Run (\"Page_Setup\")\n\nApplication.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n\n<p>Then I would like to trigger a separate macro (Case1) to run once C8:C12 all have numeric values. I have the code below</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\nSheet1.Unprotect\nSheet2.Unprotect\nApplication.ScreenUpdating = False\nApplication.EnableEvents = False\n\nDim KeyCells As Range\n\nSet KeyCells = Worksheets(\"Sheet1\").Range(\"Inputs\")\n\n    If Not Application.Intersect(KeyCells, Range(Target.Address)) Is Nothing   Then\n\n    Application.Run (\"Case1\")\n\nEnd If\n\nApplication.ScreenUpdating = True\nApplication.EnableEvents = True\n\nEnd Sub\n</code></pre>\n\n<p>My problem is that Case1 will return an error if the cells do not have a numeric value. Sorry for the confusion and I hope this clarifies my question.</p>\n"}, {"tags": ["windows", "vba", "batch-file"], "comments": [{"owner": {"reputation": 4649, "user_id": 5601284, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/qVVND.jpg?s=128&g=1", "display_name": "byxor", "link": "https://stackoverflow.com/users/5601284/byxor"}, "edited": false, "score": 0, "creation_date": 1480448869, "post_id": 40874414, "comment_id": 68964129, "body": "What code have you tried so far? We can help you by answering specific problems you have with it."}, {"owner": {"reputation": 11858, "user_id": 1417694, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adedbee0609fe9349993fedfd446acdc?s=128&d=identicon&r=PG", "display_name": "Squashman", "link": "https://stackoverflow.com/users/1417694/squashman"}, "edited": false, "score": 2, "creation_date": 1480448982, "post_id": 40874414, "comment_id": 68964189, "body": "Use <code>FOR &#47;R</code> to iterate through your folder structure."}, {"owner": {"reputation": 852, "user_id": 6563468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a4c2119cfc1ee9a6c5deeec2ead9a261?s=128&d=identicon&r=PG&f=1", "display_name": "Logan Reed", "link": "https://stackoverflow.com/users/6563468/logan-reed"}, "edited": false, "score": 0, "creation_date": 1480449309, "post_id": 40874414, "comment_id": 68964373, "body": "<a href=\"http://www.giannistsakiris.com/2008/12/03/how-to-create-shortcuts-in-windows-from-the-command-line/\" rel=\"nofollow noreferrer\">How to create Shortcuts in Windows from the command line</a>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6017774"}, "edited": false, "score": 2, "creation_date": 1480449540, "post_id": 40874414, "comment_id": 68964490, "body": "Just do a search for <code>*.VOB</code>, <i>Ctrl + A</i> to select all, right click and choose <i>Copy</i>, in the folder you want the shortcut, right click and choose <i>Paste Shortcut</i>."}, {"owner": {"reputation": 51388, "user_id": 388389, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/zK42B.png?s=128&g=1", "display_name": "npocmaka", "link": "https://stackoverflow.com/users/388389/npocmaka"}, "edited": false, "score": 0, "creation_date": 1480453057, "post_id": 40874414, "comment_id": 68966363, "body": "check this - <a href=\"http://stackoverflow.com/a/30028948/388389\">stackoverflow.com/a/30028948/388389</a>"}], "owner": {"reputation": 31, "user_id": 7227304, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9927bbef8234de62d9c51464e2a6c11a?s=128&d=identicon&r=PG&f=1", "display_name": "M.T.", "link": "https://stackoverflow.com/users/7227304/m-t"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 88, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1480452759, "creation_date": 1480448357, "last_edit_date": 1490005100, "question_id": 40874414, "link": "https://stackoverflow.com/questions/40874414/create-bat-or-vba-script-to-create-shortcuts-for-my-movies", "title": "Create .bat or VBA script to create shortcuts for my movies", "body": "<p>I rip all of my movies to my HDD so I can watch them in other rooms, on vacation, etc. The folder structure is <code>[Movie name]&gt;Video&gt;movie.vob</code>. I want to create a <code>.bat</code> file that will look through all of my movie folders and create shortcuts to all of the <code>.vob</code> files in a different folder so that I have a master list of links directly to the movies. </p>\n\n<p>I found <a href=\"https://superuser.com/questions/455364/how-to-create-a-shortcut-using-a-batch-script\">this link</a> that shows how to make a shortcut via a <code>.bat</code> file, but I am unsure how to make a loop (or even if I can) in a <code>.bat</code> file that will search 3 folders deep in a hierarchy to find a file. </p>\n\n<p>VBA would also work since I already have an Access database that reads <code>[Movie name]</code> and creates a PDF list of the movie titles. I could incorporate the shortcut creation in the pdf creation. </p>\n\n<p>Thanks in advance!</p>\n"}, {"tags": ["excel", "worksheet", "vba"], "answers": [{"comments": [{"owner": {"reputation": 526, "user_id": 7164307, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/b469705184f2479532aec6bc97f25b46?s=128&d=identicon&r=PG&f=1", "display_name": "D. O.", "link": "https://stackoverflow.com/users/7164307/d-o"}, "edited": false, "score": 0, "creation_date": 1480449809, "post_id": 40874679, "comment_id": 68964629, "body": "Thank you JNevill."}, {"owner": {"reputation": 53, "user_id": 3617389, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52cf395ec3b03232eda4e8845bb984fb?s=128&d=identicon&r=PG&f=1", "display_name": "aamailhot", "link": "https://stackoverflow.com/users/3617389/aamailhot"}, "edited": false, "score": 0, "creation_date": 1580692911, "post_id": 40874679, "comment_id": 106169008, "body": "I think you need an &#39;else isSheetProtectedWithPassword = false&#39; at the end...?"}, {"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "reply_to_user": {"reputation": 53, "user_id": 3617389, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52cf395ec3b03232eda4e8845bb984fb?s=128&d=identicon&r=PG&f=1", "display_name": "aamailhot", "link": "https://stackoverflow.com/users/3617389/aamailhot"}, "edited": false, "score": 1, "creation_date": 1580740460, "post_id": 40874679, "comment_id": 106186293, "body": "Hi @user3617389. The default for a boolean is <code>FALSE</code> so it&#39;s unnecessary. If you want to be explicit about it though, then not only will you need that <code>else</code> you will also  need to add <code>isSheetProtectedWithPassword = false</code> after the <code>End If</code> (A line it will only reach if the contents are NOT protected and the error isn&#39;t raised."}], "tags": [], "owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "is_accepted": true, "score": 12, "last_activity_date": 1480449368, "creation_date": 1480449368, "answer_id": 40874679, "question_id": 40874165, "link": "https://stackoverflow.com/questions/40874165/excel-vba-check-if-a-worksheet-is-protected-with-a-password/40874679#40874679", "title": "Excel VBA - Check if a worksheet is protected WITH A PASSWORD", "body": "<p>I don't believe there is a direct way of doing this by way of a property. Alternatively, though, you could attempt to unprotect the worksheet with a blank password and catch the error should it fail:</p>\n\n<pre><code>Function isSheetProtectedWithPassword(ws As Worksheet) As Boolean\n    If ws.ProtectContents Then\n        On Error GoTo errorLabel\n        ws.Unprotect \"\"\n        ws.Protect\n    End If\nerrorLabel:\n    If Err.Number = 1004 Then isSheetProtectedWithPassword = True\nEnd Function\n</code></pre>\n\n<p>You can call this like:</p>\n\n<pre><code>isSheetProtectedWithPassword(Worksheets(\"Sheet1\"))\n</code></pre>\n\n<p>And it will return <code>True</code> or <code>False</code></p>\n"}], "owner": {"reputation": 526, "user_id": 7164307, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/b469705184f2479532aec6bc97f25b46?s=128&d=identicon&r=PG&f=1", "display_name": "D. O.", "link": "https://stackoverflow.com/users/7164307/d-o"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 11750, "favorite_count": 0, "accepted_answer_id": 40874679, "answer_count": 1, "score": 4, "last_activity_date": 1480449368, "creation_date": 1480447473, "last_edit_date": 1531164843, "question_id": 40874165, "link": "https://stackoverflow.com/questions/40874165/excel-vba-check-if-a-worksheet-is-protected-with-a-password", "title": "Excel VBA - Check if a worksheet is protected WITH A PASSWORD", "body": "<p>We can check if a sheet is protected using ProtectContents property. But how check if it is protected with a password?</p>\n\n<pre><code>if ws.ProtectContents then\n    ''do something\nend if \n</code></pre>\n"}, {"tags": ["excel", "vba", "offset"], "comments": [{"owner": {"reputation": 19, "user_id": 7189671, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-EID1g711Yzg/AAAAAAAAAAI/AAAAAAAAAd4/jLWVKa_kSTo/photo.jpg?sz=128", "display_name": "Connor Howard", "link": "https://stackoverflow.com/users/7189671/connor-howard"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1480447895, "post_id": 40874081, "comment_id": 68963611, "body": "there are no instances of cell being in a row less than 17 where cell.value = SORNG.value"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1480448000, "post_id": 40874081, "comment_id": 68963659, "body": "@ConnorHoward put a breakpoint on the <code>Set tmprng</code> line, hit the breakpoint and type <code>?cell.Address</code>. You&#39;re running into an error, there <i>is</i> a problem with the row number."}, {"owner": {"reputation": 19, "user_id": 7189671, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-EID1g711Yzg/AAAAAAAAAAI/AAAAAAAAAd4/jLWVKa_kSTo/photo.jpg?sz=128", "display_name": "Connor Howard", "link": "https://stackoverflow.com/users/7189671/connor-howard"}, "edited": false, "score": 1, "creation_date": 1480448100, "post_id": 40874081, "comment_id": 68963723, "body": "no. and the second value in the offset adjusts the column not the row. but its closest column is Z (26)"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1480448154, "post_id": 40874081, "comment_id": 68963757, "body": "oops you are correct, sorry but you should do what @Mat&#39;sMug stated.  Just to verify."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 2, "creation_date": 1480448378, "post_id": 40874081, "comment_id": 68963856, "body": "Also please stick <code>Option Explicit</code> at the top of your module, and declare every variable you&#39;re using. That will eliminate the risk of a typo fudging everything up."}, {"owner": {"reputation": 19, "user_id": 7189671, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-EID1g711Yzg/AAAAAAAAAAI/AAAAAAAAAd4/jLWVKa_kSTo/photo.jpg?sz=128", "display_name": "Connor Howard", "link": "https://stackoverflow.com/users/7189671/connor-howard"}, "edited": false, "score": 0, "creation_date": 1480449283, "post_id": 40874081, "comment_id": 68964359, "body": "thanks for the input. I used the answer from @user3598756 and that fixed my problem the way that you were steering me towards."}], "answers": [{"comments": [{"owner": {"reputation": 19, "user_id": 7189671, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-EID1g711Yzg/AAAAAAAAAAI/AAAAAAAAAd4/jLWVKa_kSTo/photo.jpg?sz=128", "display_name": "Connor Howard", "link": "https://stackoverflow.com/users/7189671/connor-howard"}, "edited": false, "score": 0, "creation_date": 1480449203, "post_id": 40874463, "comment_id": 68964316, "body": "Thanks. this did the trick. I am very new to this and am only now trying to adapt the cleanest practices of avoiding active/select. I still dont understand how it would have gotten to &quot;cell.Offset(28, -17)&quot; with a value of 17 or less if every instance of &quot;cell.Value = SORNG.Value&quot; occurs after column Y"}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "reply_to_user": {"reputation": 19, "user_id": 7189671, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-EID1g711Yzg/AAAAAAAAAAI/AAAAAAAAAd4/jLWVKa_kSTo/photo.jpg?sz=128", "display_name": "Connor Howard", "link": "https://stackoverflow.com/users/7189671/connor-howard"}, "edited": false, "score": 0, "creation_date": 1480511584, "post_id": 40874463, "comment_id": 68992140, "body": "You are welcome. Wouldn&#39;t say why it got to such columns indexes since I don&#39;t have your data. But you could step through your previous code (F8 key) and query immediate window (?cell.Value, cell.Address, cell.Parent.Name) to see what&#39;s actually happening."}], "tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": true, "score": 0, "last_activity_date": 1480448541, "creation_date": 1480448541, "answer_id": 40874463, "question_id": 40874081, "link": "https://stackoverflow.com/questions/40874081/run-time-error-1004-application-defined-or-object-defined-error-when-setting/40874463#40874463", "title": "Run-time error &#39;1004&#39;, Application-defined or object-defined error when setting variable =cell.offset", "body": "<p>it because <code>For Each cell In Sheet1.Cells</code> loops through <em>all</em> cells of <code>Sheet1</code> and therefore it also loop through cell belonging to column 1 to 17 which causes   <code>cell.Offset(28, -17)</code> to fail since it'd try to reach a \"negative column\" cell </p>\n\n<p>moreover you must avoid <code>Activate</code>/<code>Select</code> coding habits and use fully qualified range reference</p>\n\n<p>try this code:</p>\n\n<pre><code>Option Explicit\n\nSub Removetemplate()\n    Dim SOCell As Range, WSOCell As Range\n    Dim WSORng As Range\n\n    ' Set numrows = number of rows of data.\n    With Worksheets(\"WorkingSO\")\n        Set WSORng = .Range(\"L2\", .Range(\"L2\").End(xlDown)) 'set \"WorkingSO\" worksheet range to loop through\n    End With\n\n    With Worksheets(\"Sales Orders\") '&lt;--| reference \"Sales Orders\" worksheet\n        For Each WSOCell In WSORng '&lt;--| loop through WSORng cells\n            For Each SOCell In .Columns(\"R\").SpecialCells(xlCellTypeConstants) '&lt;--| loop through currently referenced worksheet (i.e. \"Sales Orders\") column \"R\" cells with any constant value\n                If SOCell.Value = WSOCell.Value Then '&lt;--| if current \"Sales Orders\" cell value matches current \"WorkingSO\" one\n                    If InStr(SOCell.Offset(28, -17), \"TEMPLATE\") &gt; 0 Then WSOCell.ClearContents '&lt;--| if \"Sales Orders\" cell offsetted 28 rows down and 17 columns left form current one has \"TEMPLATE\", then clear current \"WorkingSO\" cell\n                End If\n            Next\n        Next\n    End With\nEnd Sub\n</code></pre>\n\n<p>where you have to change <code>.Columns(\"R\")</code> to the actual \"Sales Orders\" worksheet column index you want to look for \"WorkingSO\" column \"L\" values in</p>\n"}], "owner": {"reputation": 19, "user_id": 7189671, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-EID1g711Yzg/AAAAAAAAAAI/AAAAAAAAAd4/jLWVKa_kSTo/photo.jpg?sz=128", "display_name": "Connor Howard", "link": "https://stackoverflow.com/users/7189671/connor-howard"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1153, "favorite_count": 0, "accepted_answer_id": 40874463, "answer_count": 1, "score": 0, "last_activity_date": 1480457918, "creation_date": 1480447206, "last_edit_date": 1480457918, "question_id": 40874081, "link": "https://stackoverflow.com/questions/40874081/run-time-error-1004-application-defined-or-object-defined-error-when-setting", "title": "Run-time error &#39;1004&#39;, Application-defined or object-defined error when setting variable =cell.offset", "body": "<p>This is my code. It runs through a list of values starting at <code>Cell L1</code>, finds them in another worksheet and then finds an offset cell. If that cell contains <code>\"TEMPLATE\"</code> it is to remove the value from the original list.   </p>\n\n<pre><code>Sub Removetemplate()\n\nDim x As Variant\nDim myString As String\nDim temprng As Range\nDim cell As Object\n\n  ' Set numrows = number of rows of data.\n  Worksheets(\"WorkingSO\").Activate\n  NumRows = Range(\"L2\", Range(\"L2\").End(xlDown)).Rows.Count\n  ' Select cell L2.\n  Set SORNG = Range(\"L2\")\n  SORNG.Select\n  ' Establish \"For\" loop to loop \"numrows\" number of times.\n  Worksheets(\"Sales Orders\").Activate\n  For x = 1 To NumRows\n\n        For Each cell In Sheet1.Cells\n                If cell.Value = SORNG.Value Then\n                    Set temprng = cell.Offset(28, -17)\n                    myString = temprng.Value\n                        If InStr(myString, \"TEMPLATE\") &gt; 0 Then\n                            SORNG.ClearContents\n                        End If\n                End If\n        Next\n\n\n\n     ' Selects cell down 1 row from active cell.\n     Set SORNG = SORNG.Offset(1, 0)\n  Next\n\n\n\nEnd Sub\n</code></pre>\n\n<p>The <code>1004 error</code> occurs at the line <code>Set temprng = cell.Offset(28, -17)</code>. Im not 100% sure but I believe that it works the first time through but fails on the second loop.</p>\n"}, {"tags": ["database", "forms", "ms-access", "vba"], "comments": [{"owner": {"reputation": 4173, "user_id": 2895550, "user_type": "registered", "profile_image": "https://graph.facebook.com/1184544414/picture?type=large", "display_name": "Wayne G. Dunn", "link": "https://stackoverflow.com/users/2895550/wayne-g-dunn"}, "edited": false, "score": 0, "creation_date": 1480452559, "post_id": 40874057, "comment_id": 68966087, "body": "Since you&#39;ve tagged &#39;Forms&#39;, I assume your data is presented/selected on a form? Is your form &#39;bound&#39; to an underlying recordset? Where are the &#39;selecting&#39;? Is it a ComboBox?"}, {"owner": {"reputation": 143, "user_id": 2934877, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/870ce5fd32d145fd41a9a6be09c0652f?s=128&d=identicon&r=PG", "display_name": "Steven", "link": "https://stackoverflow.com/users/2934877/steven"}, "reply_to_user": {"reputation": 4173, "user_id": 2895550, "user_type": "registered", "profile_image": "https://graph.facebook.com/1184544414/picture?type=large", "display_name": "Wayne G. Dunn", "link": "https://stackoverflow.com/users/2895550/wayne-g-dunn"}, "edited": false, "score": 0, "creation_date": 1480456986, "post_id": 40874057, "comment_id": 68968251, "body": "@WayneG.Dunn - Yes the form is bound to an underlying table which contains other data relevant to the provider. Yes it is a combo box of a list of specialties. These specialties and their correlating codes are located in a separate table entitled Crosswalk_ProviderHSD. I want the code field to update once the specialty is selected from the drop down."}, {"owner": {"reputation": 4173, "user_id": 2895550, "user_type": "registered", "profile_image": "https://graph.facebook.com/1184544414/picture?type=large", "display_name": "Wayne G. Dunn", "link": "https://stackoverflow.com/users/2895550/wayne-g-dunn"}, "edited": false, "score": 1, "creation_date": 1480459206, "post_id": 40874057, "comment_id": 68969271, "body": "Typically you use a combobox that has multiple columns - some of which you may choose to hide. Then you &#39;bind&#39; the control to a certain column of the combobox so that when you select &#39;Nurse...&#39;, the actual database value is saved as &#39;000&#39;. i.e. the rowsource of the combobox selects whatever fields you want from the &#39;Crosswalk...&#39; table (Nurse P...), including it&#39;s unique key (000). Set the ControlSource to the HSD Code in your bound table; set olumn width to 0 to hide certain columns; set Bound Column to the &#39;Nurse..&#39; column.  Immediate save or save when moving to another record?"}, {"owner": {"reputation": 494, "user_id": 751666, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f0f9cbf93fc27f94ce0ce88f1f49ac3c?s=128&d=identicon&r=PG", "display_name": "tahwos", "link": "https://stackoverflow.com/users/751666/tahwos"}, "edited": false, "score": 0, "creation_date": 1480475645, "post_id": 40874057, "comment_id": 68974002, "body": "You might be overthinking it a bit... all of this should be possible with queries. Can you list all of your controls, and table names with pertinent fields? If your changing the underlying data, of a bound control, AfterUpdate with a Requery, may be more appropriate."}, {"owner": {"reputation": 143, "user_id": 2934877, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/870ce5fd32d145fd41a9a6be09c0652f?s=128&d=identicon&r=PG", "display_name": "Steven", "link": "https://stackoverflow.com/users/2934877/steven"}, "reply_to_user": {"reputation": 4173, "user_id": 2895550, "user_type": "registered", "profile_image": "https://graph.facebook.com/1184544414/picture?type=large", "display_name": "Wayne G. Dunn", "link": "https://stackoverflow.com/users/2895550/wayne-g-dunn"}, "edited": false, "score": 0, "creation_date": 1480525939, "post_id": 40874057, "comment_id": 69002380, "body": "@WayneG.Dunn I tried your example but I can&#39;t find the ControlSource option"}, {"owner": {"reputation": 4173, "user_id": 2895550, "user_type": "registered", "profile_image": "https://graph.facebook.com/1184544414/picture?type=large", "display_name": "Wayne G. Dunn", "link": "https://stackoverflow.com/users/2895550/wayne-g-dunn"}, "edited": false, "score": 0, "creation_date": 1480527422, "post_id": 40874057, "comment_id": 69003277, "body": "I was referring to using a ComboBox, thus there is a property like: Me.cboSomeName.ControlSource"}, {"owner": {"reputation": 143, "user_id": 2934877, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/870ce5fd32d145fd41a9a6be09c0652f?s=128&d=identicon&r=PG", "display_name": "Steven", "link": "https://stackoverflow.com/users/2934877/steven"}, "edited": false, "score": 0, "creation_date": 1480528196, "post_id": 40874057, "comment_id": 69003757, "body": "Under the lookup function for the field right? Not on the form? If so then yeah I understand that. I didn&#39;t know that VBA was involved though. That leads me to believe that you were talking about the form. In that case, let me try it all again."}, {"owner": {"reputation": 143, "user_id": 2934877, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/870ce5fd32d145fd41a9a6be09c0652f?s=128&d=identicon&r=PG", "display_name": "Steven", "link": "https://stackoverflow.com/users/2934877/steven"}, "reply_to_user": {"reputation": 494, "user_id": 751666, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f0f9cbf93fc27f94ce0ce88f1f49ac3c?s=128&d=identicon&r=PG", "display_name": "tahwos", "link": "https://stackoverflow.com/users/751666/tahwos"}, "edited": false, "score": 0, "creation_date": 1480544345, "post_id": 40874057, "comment_id": 69012297, "body": "@tahwos - My specialty code tables are named differently on the FE than they are the BE, so I&#39;ll list both names. <i>Crosswalk_ProviderHSD</i> is the BE table with fields <i>Specialty</i> and <i>HSD_Code</i>. The FE table has the same field names, but is titled <i>ProviderSpecialtyCodes</i>. The field names on the form are <i>Specialty</i> and <i>SpecialtyCode</i> respectively."}, {"owner": {"reputation": 494, "user_id": 751666, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f0f9cbf93fc27f94ce0ce88f1f49ac3c?s=128&d=identicon&r=PG", "display_name": "tahwos", "link": "https://stackoverflow.com/users/751666/tahwos"}, "edited": false, "score": 0, "creation_date": 1480638889, "post_id": 40874057, "comment_id": 69057756, "body": "@Steven, So you have two different tables, or 1 table with two different names? Because Access only cares, about the table names, as you see them in the Front End. If it is a linked table, and you renamed it, in the front end, then you need to use that name, when referencing it."}], "answers": [{"tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": false, "score": 2, "last_activity_date": 1480491365, "creation_date": 1480491365, "answer_id": 40882742, "question_id": 40874057, "link": "https://stackoverflow.com/questions/40874057/vba-code-to-update-a-field-in-access/40882742#40882742", "title": "VBA Code to update a field in access", "body": "<p>You can't update the field in its own <em>BeforeUpdate</em> event. And your DLookup syntax is wrong.</p>\n\n<p>Try this:</p>\n\n<pre><code>Private Sub Form_BeforeUpdate(Cancel As Integer)\n    Me.SpecialtyCode.Value = _\n    DLookup(\"[HSD_Code]\", \"Crosswalk_ProviderHSD\", \"[Specialty] = '\" &amp; Me.Specialty.Value &amp; \"'\")\nEnd Sub\n</code></pre>\n\n<p>That said, listen to the comments regarding queries.</p>\n"}], "owner": {"reputation": 143, "user_id": 2934877, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/870ce5fd32d145fd41a9a6be09c0652f?s=128&d=identicon&r=PG", "display_name": "Steven", "link": "https://stackoverflow.com/users/2934877/steven"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 660, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1480491365, "creation_date": 1480447098, "last_edit_date": 1480456746, "question_id": 40874057, "link": "https://stackoverflow.com/questions/40874057/vba-code-to-update-a-field-in-access", "title": "VBA Code to update a field in access", "body": "<p>My goal is to update the specialty code field based on the entry in the specialty field. As an example, if they select <code>Nurse Practitioner</code>, I want the specialty code field to automatically update to <code>000</code>.</p>\n\n<p>I've used the following code but to no avail:</p>\n\n<pre><code>Private Sub SpecialtyCode_BeforeUpdate(Cancel As Integer)\nMe.SpecialtyCode.Value = DLookup(\"[HSD_Code]\", \"Crosswalk_ProviderHSD\", \n\"[Specialty] = Me.Specialty.Value\")\nEnd Sub\n</code></pre>\n\n<p>HSD Code is the specialty code I want to pull and the crosswalk is the table I want to reference.</p>\n\n<p>I'd like to do the same for county and region data given a ZIP Code. I know my code is wrong. What's the proper syntax? Is there a more efficient way of accomplishing this?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1856, "user_id": 4949483, "user_type": "registered", "accept_rate": 86, "profile_image": "https://graph.facebook.com/10207184362590012/picture?type=large", "display_name": "Rdster", "link": "https://stackoverflow.com/users/4949483/rdster"}, "edited": false, "score": 0, "creation_date": 1480447238, "post_id": 40874055, "comment_id": 68963239, "body": "First thing would be to stop using ActiveCell and Select...<a href=\"http://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba-macros\" title=\"how to avoid using select in excel vba macros\">stackoverflow.com/questions/10714251/&hellip;</a>"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1480448597, "post_id": 40874055, "comment_id": 68963963, "body": "What problems are you having?  I can see that <code>Year1Start</code> won&#39;t like accessing the unknown variable <code>Target</code> (you probably need to pass it as a parameter), but is that the only issue?"}], "answers": [{"comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1480451542, "post_id": 40875115, "comment_id": 68965565, "body": "Now the only problem is what happens when <code>Target</code> has a value of 0.45 - but that&#39;s something for the OP to work out."}], "tags": [], "owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "is_accepted": false, "score": 1, "last_activity_date": 1480451426, "last_edit_date": 1480451426, "creation_date": 1480450920, "answer_id": 40875115, "question_id": 40874055, "link": "https://stackoverflow.com/questions/40874055/a-sub-procedure-that-is-able-to-check-the-value-of-a-cell-in-the-same-row-as-the/40875115#40875115", "title": "A sub procedure that is able to check the value of a cell in the same row as the activecell from a Private Sub Worksheet_change", "body": "<p>I had some down time and decided to refactor the code as you can definitely accomplish this in one procedure inside the <code>Worksheet_Change</code> utilizing some good indentation and different programming techniques. </p>\n\n<p>Specifically notice my use of <code>Select Case</code>, multiple <code>If</code> blocks (for readability)  and how I work directly with objects, instead of using <code>ActiveCell</code> and <code>Select</code>.</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\nSelect Case Cells(3, Target.Column)\n\n    Case Is = \"AUT\", \"SPR\", \"SUM\"\n\n        If Target.Column &gt;= 1 And Target.Row &gt;= 4 And Target.Row &lt;= 500 Then\n\n            If Cells(Target.Row, \"M\").Value = \"MLD\" Then\n\n                If Cells(Target.Row, \"ET\").Value = 1 And Cells(Target.Row, Target.Column - 1) = 2 Then\n\n                    If Cells(Target.Row, \"EM\").Value = 0.4 Then\n\n                        Dim sVal As String, r As Integer, g As Integer, b As Integer\n\n                        Select Case Target.Offset(, 1).Value\n\n                            Case Is &lt; 0.44: sVal = \"R\": r = 255: g = 0: b = 0\n\n                            Case Is = 0.44: sVal = \"Y\": r = 255: g = 255: b = 51\n\n                            Case Is = 0.46: sVal = \"G\": r = 51: g = 225: b = 51\n\n                            Case Is &gt;= 0.48: sVal = \"B\": r = 55: g = 142: b = 225\n\n                            Case Is = \"\": sVal = \"\":\n\n                        End Select\n\n                        Target.Offset(, 2).Value = sVal\n\n                        If Len(Target.Offset(, 1)) = 0 Then\n                            Target.Interior.ColorIndex = 0\n                        Else\n                            Target.Interior.Color = RGB(r, g, b)\n                        End If\n\n                    End If\n\n                End If\n\n            End If\n\n        End If\n\nEnd Select\n\nEnd Sub\n</code></pre>\n\n<p><em>Note - A way to trim this code down would be to use a helper column in the spreadsheet as a flag column to test against in the code with the conditions in the 2nd, 3rd &amp; 4th <code>If</code> blocks.</em></p>\n"}], "owner": {"reputation": 1, "user_id": 7227016, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7fe07e0fa4eba014bd4863537fb7fe15?s=128&d=identicon&r=PG&f=1", "display_name": "Sean B", "link": "https://stackoverflow.com/users/7227016/sean-b"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 56, "favorite_count": 1, "answer_count": 1, "score": -1, "last_activity_date": 1480451561, "creation_date": 1480447091, "last_edit_date": 1480451561, "question_id": 40874055, "link": "https://stackoverflow.com/questions/40874055/a-sub-procedure-that-is-able-to-check-the-value-of-a-cell-in-the-same-row-as-the", "title": "A sub procedure that is able to check the value of a cell in the same row as the activecell from a Private Sub Worksheet_change", "body": "<p>I am relatively new to using Excel VBA. I created an analysis tool for an assessment in school so that the teachers workload could be reduced. The spreadsheet got far too large and due to the multiple scenarios needed and conditional formatting the spreadsheet became slow and problematic. </p>\n\n<p>I have a <code>Private Sub worksheet_change (ByVal Target As Range)</code> as follows which works. </p>\n\n<pre><code>   Private Sub Worksheet_Change(ByVal Target As Range)  \n\n   If (Cells(3, Target.Column) = \"AUT\" Or Cells(3, Target.Column) = \"SPR\" Or Cells(3, Target.Column) = \"SUM\") And Target.Column &gt;= 1 And Target.Row &gt;= 4 And Target.Row &lt;= 500 Then\n\n      If Cells(Target.Row, \"M\").Value = \"MLD\" And Cells(Target.Row, \"ET\").Value = 1 And Cells(Target.Row, Target.Column - 1) = 2 Then         \n      Call Year1Start         \n      End If      \n    End If      \n    End Sub\n</code></pre>\n\n<p>I've tried to create a <code>Sub</code> procedure but to no avail: </p>\n\n<pre><code>    Sub Year1Start()\n\n       If Cells(Target.Row, \"EM\").Value = 0.4 Then\n\n       Call Y1StartY2DataEntry040\n\n    End If\n\n    End Sub\n\n    Sub Y1StartY2DataEntry040()\n\n    'check the various outputs for year 1 start with year 2 data entry:\n    'y1=0.4     R0.42,Y0.44,G0.46, B0.48\n\n    ActiveCell.Offset(0, 1).Select\n\n    If ActiveCell.Value &lt; 0.44 Then\n    ActiveCell.Offset(0, 1).Select\n    ActiveCell.Value = \"R\"\n    ActiveCell.Offset(0, -2).Select\n    ActiveCell.Interior.Color = RGB(255, 0, 0)\n    ActiveCell.Offset(0, 1).Select\n    End If\n\n    If ActiveCell.Value = 0.44 Then\n    ActiveCell.Offset(0, 1).Select\n    ActiveCell.Value = \"Y\"\n    ActiveCell.Offset(0, -2).Select\n    ActiveCell.Interior.Color = RGB(255, 255, 51)\n    ActiveCell.Offset(0, 1).Select\n    End If\n\n    If ActiveCell.Value = 0.46 Then\n    ActiveCell.Offset(0, 1).Select\n    ActiveCell.Value = \"G\"\n    ActiveCell.Offset(0, -2).Select\n    ActiveCell.Interior.Color = RGB(51, 225, 51)\n    ActiveCell.Offset(0, 1).Select\n    End If\n\n    If ActiveCell.Value &gt;= 0.48 Then\n    ActiveCell.Offset(0, 1).Select\n    ActiveCell.Value = \"B\"\n    ActiveCell.Offset(0, -2).Select\n    ActiveCell.Interior.Color = RGB(55, 142, 225)\n    ActiveCell.Offset(0, 1).Select\n    End If\n\n    If ActiveCell.Value = isblank Then\n    ActiveCell.Offset(0, -1).Select\n    ActiveCell.Interior.ColorIndex = 0\n    ActiveCell.Offset(0, 2).Select\n    ActiveCell.Value = \"\"\n    ActiveCell.Offset(0, -2).Select\n    End If\n\n    End Sub\n</code></pre>\n\n<p>Basically I need to check to see if the value is true then it calls a new procedure.</p>\n\n<p>I need to do it this way because I got procedure too large before. </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1480446931, "post_id": 40873363, "comment_id": 68963058, "body": "If you just want to grab the information from the cell above change your <code>If</code> block to .... <code>If IsEmpty(cell) Then cell.value = cell.offset(-1).Value</code> ... no need for an <code>End If</code> in this case."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 7227076, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/74158811d3e5ce8380a00aada4cfdd46?s=128&d=identicon&r=PG&f=1", "display_name": "GeoffB", "link": "https://stackoverflow.com/users/7227076/geoffb"}, "edited": false, "score": 0, "creation_date": 1480509128, "post_id": 40874257, "comment_id": 68990542, "body": "Thank you very much. Just the job!"}], "tags": [], "owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "is_accepted": false, "score": 1, "last_activity_date": 1480448140, "last_edit_date": 1480448140, "creation_date": 1480447824, "answer_id": 40874257, "question_id": 40873363, "link": "https://stackoverflow.com/questions/40873363/finding-gaps-in-column-data/40874257#40874257", "title": "Finding gaps in column data", "body": "<p>Hopefully this code will achieve a linear fill:</p>\n\n<pre><code>Sub LinearFill()\n    Dim lngLastRow As Long\n    Dim endRow As Long\n    Dim startValue As Double\n    Dim endValue As Double\n    Dim thisRow As Long\n\n    With ActiveSheet\n        lngLastRow = .Cells(.Rows.Count, \"F\").End(xlUp).Row   'Search Column F, change as required.\n        For thisRow = 3 to lngLastRow - 1\n            If IsEmpty(.Cells(thisRow, \"F\")) Then\n                startValue = CDbl(.Cells(thisRow - 1, \"F\").Value)\n                endRow = .Cells(thisRow, \"F\").End(xlDown).Row\n                endValue = CDbl(.Cells(endRow, \"F\").Value)\n                .Cells(thisRow, \"F\").Value = startValue + (endValue - startValue) / (endRow - thisRow + 1)\n            End If\n        Next\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 7227076, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/74158811d3e5ce8380a00aada4cfdd46?s=128&d=identicon&r=PG&f=1", "display_name": "GeoffB", "link": "https://stackoverflow.com/users/7227076/geoffb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 692, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1480448140, "creation_date": 1480444884, "last_edit_date": 1531164843, "question_id": 40873363, "link": "https://stackoverflow.com/questions/40873363/finding-gaps-in-column-data", "title": "Finding gaps in column data", "body": "<p>I've seen many questions asked about finding gaps in column data but haven't been able to transpose the answers to meet my needs. I'm an amateur as far as vba is concerned just to make my life challenging!</p>\n\n<p>I have a column of number data in an Excel file. The column contains single and several consecutive blank cells. I need to locate the empty locations and use the Excel function to infill the gaps with data with linear series fill function. Thanks in advance for any guidance.</p>\n\n<p>My code so far is </p>\n\n<pre><code>Dim lngLastRow As Long\n\nlngLastRow = Cells(Rows.Count, \"F\").End(xlUp).Row   'Search Column F, change as required.    \n\nFor Each cell In Range(\"F3:F\" &amp; lngLastRow) 'Starting cell is F3       \n   If IsEmpty(Range(\"F3\").Value) = True Then\n\n  'store this row and check is next cell is blank &amp; apply fill process      \n\n   End If\nNext cell\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 852, "user_id": 6563468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a4c2119cfc1ee9a6c5deeec2ead9a261?s=128&d=identicon&r=PG&f=1", "display_name": "Logan Reed", "link": "https://stackoverflow.com/users/6563468/logan-reed"}, "edited": false, "score": 0, "creation_date": 1480445817, "post_id": 40873347, "comment_id": 68962446, "body": "Do you need to reload entire file just on start or on every new line? Reload entire file or just keep adding new lines to the spreadsheet?"}, {"owner": {"reputation": 1213, "user_id": 1354522, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8936dc371fd2d9bdd770b47005646c62?s=128&d=identicon&r=PG", "display_name": "GELR", "link": "https://stackoverflow.com/users/1354522/gelr"}, "edited": false, "score": 1, "creation_date": 1480450994, "post_id": 40873347, "comment_id": 68965274, "body": "For the keep updated part: <a href=\"http://stackoverflow.com/questions/1586169/how-do-i-know-when-a-file-has-been-modified-in-a-vba-macro\" title=\"how do i know when a file has been modified in a vba macro\">stackoverflow.com/questions/1586169/&hellip;</a>. This already have a solution out there :)."}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 7226667, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-BI8q4UJsIgQ/AAAAAAAAAAI/AAAAAAAAABE/q2a8OsvC47Q/photo.jpg?sz=128", "display_name": "WU YICHENG", "link": "https://stackoverflow.com/users/7226667/wu-yicheng"}, "edited": false, "score": 0, "creation_date": 1480522445, "post_id": 40874086, "comment_id": 69000047, "body": "Thank you so much! I&#39;m also studying on VBA. Can you tell me which function here keep the data updated?"}, {"owner": {"reputation": 852, "user_id": 6563468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a4c2119cfc1ee9a6c5deeec2ead9a261?s=128&d=identicon&r=PG&f=1", "display_name": "Logan Reed", "link": "https://stackoverflow.com/users/6563468/logan-reed"}, "reply_to_user": {"reputation": 13, "user_id": 7226667, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-BI8q4UJsIgQ/AAAAAAAAAAI/AAAAAAAAABE/q2a8OsvC47Q/photo.jpg?sz=128", "display_name": "WU YICHENG", "link": "https://stackoverflow.com/users/7226667/wu-yicheng"}, "edited": false, "score": 0, "creation_date": 1480522789, "post_id": 40874086, "comment_id": 69000307, "body": "If you call this again, it will refresh the entire list from the file - i.e. it always reloads a full file. This can handle pretty large files quickly - you probably won&#39;t have issues with up to ~5-700000 records. But if you want to only load latest updates - remember the position in the file and use <code>Seek</code> command to read only changes."}], "tags": [], "owner": {"reputation": 852, "user_id": 6563468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a4c2119cfc1ee9a6c5deeec2ead9a261?s=128&d=identicon&r=PG&f=1", "display_name": "Logan Reed", "link": "https://stackoverflow.com/users/6563468/logan-reed"}, "is_accepted": true, "score": 1, "last_activity_date": 1480447239, "creation_date": 1480447239, "answer_id": 40874086, "question_id": 40873347, "link": "https://stackoverflow.com/questions/40873347/how-to-read-text-file-in-excel-vba-and-keep-updated/40874086#40874086", "title": "How to read text file in Excel VBA and keep updated", "body": "<p>This will do the trick. You can assign it to a button or shortcut - it will refresh data from file in reverse upon each invocation.</p>\n\n<pre><code>Sub reverseFile()\n\n    ' put the file into the same dir as spreasheet\n    Const FILE_NAME = \"sensorData.txt\"\n\n    Dim fileNum As Integer\n    Dim line As String\n    Dim c As New Collection\n    Dim a() As String\n    Dim i As Long\n\n    ' read file line-by-line\n    fileNum = FreeFile()\n    Open ThisWorkbook.Path &amp; Application.PathSeparator _\n            &amp; FILE_NAME For Input As #fileNum\n\n    While Not EOF(fileNum)\n        Line Input #fileNum, line\n        c.Add line\n    Wend\n\n    Close #fileNum\n\n    ' reverse the input lines into array\n    ReDim a(1 To c.Count)\n    For i = LBound(a) To UBound(a): a(i) = c(c.Count - i + 1): Next i\n\n    ' display results in the spreadsheet\n    With Worksheets(\"Sheet1\").[a1]\n        .CurrentRegion.Clear\n        .Resize(UBound(a), 1) = Application.Transpose(a)\n    End With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 7226667, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-BI8q4UJsIgQ/AAAAAAAAAAI/AAAAAAAAABE/q2a8OsvC47Q/photo.jpg?sz=128", "display_name": "WU YICHENG", "link": "https://stackoverflow.com/users/7226667/wu-yicheng"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1725, "favorite_count": 0, "accepted_answer_id": 40874086, "answer_count": 1, "score": 1, "last_activity_date": 1480709490, "creation_date": 1480444832, "last_edit_date": 1480709490, "question_id": 40873347, "link": "https://stackoverflow.com/questions/40873347/how-to-read-text-file-in-excel-vba-and-keep-updated", "title": "How to read text file in Excel VBA and keep updated", "body": "<p>I'm new to Excel VBA. I'm doing a project using Arduino and Gobetwino to log sensors data into a text file. To continue, I need to use a macro to log data from the text file to Excel and keep it updated every time I open it or run the macro. In addition, Gobetwino will write data in the text file line by line with date and content like the following:</p>\n\n<pre><code>11/28/2016 12:00:00 sensor triggered\n11/29/2016 00:00:05 sensor triggered\n11/29/2016 05:00:00 sensor triggered\n</code></pre>\n\n<p>I need to see the latest data in first line in Excel.</p>\n\n<p>Can someone help me write VBA code for this?</p>\n"}, {"tags": ["ms-access", "vba", "ms-access-2013"], "comments": [{"owner": {"reputation": 4173, "user_id": 2895550, "user_type": "registered", "profile_image": "https://graph.facebook.com/1184544414/picture?type=large", "display_name": "Wayne G. Dunn", "link": "https://stackoverflow.com/users/2895550/wayne-g-dunn"}, "edited": false, "score": 0, "creation_date": 1480453151, "post_id": 40873059, "comment_id": 68966429, "body": "First, I sure hope you have a frontend/backend setup if you have 65 people! To give a suggestion on the form interface, it depends on the number of controls/complexity of the form you have. We developed a &#39;report interface&#39; that depending on the role of the user, they could see anywhere from one to 20 filters (controls), thus used one form with a &#39;map&#39; table. How complex is your form?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2363207"}, "reply_to_user": {"reputation": 4173, "user_id": 2895550, "user_type": "registered", "profile_image": "https://graph.facebook.com/1184544414/picture?type=large", "display_name": "Wayne G. Dunn", "link": "https://stackoverflow.com/users/2895550/wayne-g-dunn"}, "edited": false, "score": 0, "creation_date": 1480458299, "post_id": 40873059, "comment_id": 68968854, "body": "Yes, it is a split database. How are you using that map table? Sounds interesting."}, {"owner": {"reputation": 4173, "user_id": 2895550, "user_type": "registered", "profile_image": "https://graph.facebook.com/1184544414/picture?type=large", "display_name": "Wayne G. Dunn", "link": "https://stackoverflow.com/users/2895550/wayne-g-dunn"}, "edited": false, "score": 0, "creation_date": 1480459844, "post_id": 40873059, "comment_id": 68969570, "body": "Map Table has fields: ID (PK), ReportName, CtlName, CtlOrder, CtlTop, CtlLeft, SkipLabel (Bool), CtlRecordSource. All ctls hidden unless used by report. When user selects report from combobox, list of fields retrieved from map table and the form is altered."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2363207"}, "reply_to_user": {"reputation": 4173, "user_id": 2895550, "user_type": "registered", "profile_image": "https://graph.facebook.com/1184544414/picture?type=large", "display_name": "Wayne G. Dunn", "link": "https://stackoverflow.com/users/2895550/wayne-g-dunn"}, "edited": false, "score": 0, "creation_date": 1480475550, "post_id": 40873059, "comment_id": 68973978, "body": "Interesting, never thought about putting that data into a table. Have you run across any issues with that approach?"}, {"owner": {"reputation": 4173, "user_id": 2895550, "user_type": "registered", "profile_image": "https://graph.facebook.com/1184544414/picture?type=large", "display_name": "Wayne G. Dunn", "link": "https://stackoverflow.com/users/2895550/wayne-g-dunn"}, "edited": false, "score": 0, "creation_date": 1480476539, "post_id": 40873059, "comment_id": 68974220, "body": "Not a one! In our case, our controls were all the same height, so it was simple to calculate the &#39;tops&#39; to place in the table. Most of the &#39;lefts&#39; were the same since we had listed filters in a column - except for some &#39;from/to&#39; pairs. Performance was great (I believe we turned off painting till finished)."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2363207"}, "reply_to_user": {"reputation": 4173, "user_id": 2895550, "user_type": "registered", "profile_image": "https://graph.facebook.com/1184544414/picture?type=large", "display_name": "Wayne G. Dunn", "link": "https://stackoverflow.com/users/2895550/wayne-g-dunn"}, "edited": false, "score": 0, "creation_date": 1480516572, "post_id": 40873059, "comment_id": 68995781, "body": "Thanks for the info. Feel free to make this an answer and I&#39;ll accept it. I am curious too if you had to do anything special to tie the newly re-purposed controls to their events/VBA. For example, if I have a button and I re-purpose it, then I may have different events to trigger from the new button. As I mentioned in the question I have tried some aspects of this scenario but I don&#39;t yet feel comfortable with it. If you have any pointers on working with these newly re-purposed controls in terms of events or VBA code, I would be interested in hearing them. Thanks again."}], "answers": [{"comments": [{"owner": {"reputation": 88348, "user_id": 2548, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adb9f3f81dc0b13a7339a10d0abedbfc?s=128&d=identicon&r=PG", "display_name": "Fionnuala", "link": "https://stackoverflow.com/users/2548/fionnuala"}, "edited": false, "score": 0, "creation_date": 1480526320, "post_id": 40894128, "comment_id": 69002601, "body": "Why ADOB with MS Access? DAO is recommended and much faster. ADODB does have its place, but not always."}, {"owner": {"reputation": 4173, "user_id": 2895550, "user_type": "registered", "profile_image": "https://graph.facebook.com/1184544414/picture?type=large", "display_name": "Wayne G. Dunn", "link": "https://stackoverflow.com/users/2895550/wayne-g-dunn"}, "reply_to_user": {"reputation": 88348, "user_id": 2548, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adb9f3f81dc0b13a7339a10d0abedbfc?s=128&d=identicon&r=PG", "display_name": "Fionnuala", "link": "https://stackoverflow.com/users/2548/fionnuala"}, "edited": false, "score": 0, "creation_date": 1480527138, "post_id": 40894128, "comment_id": 69003104, "body": "We migrated from Access to SQL Server, thus the ADO stuff  :)  I agree with DAO and use it as my first choice!"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2363207"}, "edited": false, "score": 0, "creation_date": 1480527949, "post_id": 40894128, "comment_id": 69003607, "body": "Thanks for the detailed answer! It will take me some time to work through it but it addresses the exact problem I was struggling with."}, {"owner": {"reputation": 88348, "user_id": 2548, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adb9f3f81dc0b13a7339a10d0abedbfc?s=128&d=identicon&r=PG", "display_name": "Fionnuala", "link": "https://stackoverflow.com/users/2548/fionnuala"}, "edited": false, "score": 0, "creation_date": 1480529601, "post_id": 40894128, "comment_id": 69004573, "body": "@WayneG.Dunn Not linked tables? :("}, {"owner": {"reputation": 4173, "user_id": 2895550, "user_type": "registered", "profile_image": "https://graph.facebook.com/1184544414/picture?type=large", "display_name": "Wayne G. Dunn", "link": "https://stackoverflow.com/users/2895550/wayne-g-dunn"}, "edited": false, "score": 0, "creation_date": 1480530242, "post_id": 40894128, "comment_id": 69004911, "body": "My explanation may bounce around a bit... very large and complex application deployed to 70+ countries; all developed with DAO... I got assigned weeks after it rolled out to try and solve performance issues. Big delay due to network speeds to the server... so one item of hundreds was to &#39;make static&#39; (i.e. make local) any table that users couldn&#39;t update, including this table. Later needed to move to SQL server, so I wrote code to automatically change <i>all</i> code from DAO to ADO... thus this guy fell victim  :)"}], "tags": [], "owner": {"reputation": 4173, "user_id": 2895550, "user_type": "registered", "profile_image": "https://graph.facebook.com/1184544414/picture?type=large", "display_name": "Wayne G. Dunn", "link": "https://stackoverflow.com/users/2895550/wayne-g-dunn"}, "is_accepted": true, "score": 0, "last_activity_date": 1480525434, "creation_date": 1480525434, "answer_id": 40894128, "question_id": 40873059, "link": "https://stackoverflow.com/questions/40873059/should-i-re-purpose-subform-controls-on-one-form-or-just-create-multiple-forms/40894128#40894128", "title": "Should I re-purpose subform controls on one form or just create multiple forms?", "body": "<p>Below is a brief description of one way to 'repurpose' or reformat a form for several uses. Re your question of changing the VBA code, a simple solution would be to check a label value or some value you set in the control, then call the appropriate VBA subroutine.</p>\n\n<p>We had over 100 reports available, each with their own selection criteria/options and we did not want to create a unique filter form for every report. The solution was to identify the selection options available by report, identify the logical order of those options, then create a table that would present the options to the user.</p>\n\n<p>First, we created the table: ctlReportOptions (PK = ID, ReportName, OptionOrder)\nFields: ID (Int), ReportName (text), OptionOrder (Int), ControlName (text), ControlTop (Int), ControlLeft (Int), SkipLabel (Y/N), ControlRecordsourc(text)\nNote 1: ID is not an AutoNumber.</p>\n\n<p>Next we populated with records that would define the view the user would see.\nNote 2: Using an ID of zero, we created records for EVERY field on the report so we could always redraw for the developers.</p>\n\n<p>Then we created the form and placed controls for every possible filter. \nWe set the 'Default Value' property to be used as our default.</p>\n\n<p>Some of the controls:\nComboBox to select the report name. Add code for Change event as follows:</p>\n\n<pre><code>Private Sub cboChooseReport_Change()\nDim strSQL      As String\nDim rs          As ADODB.recordSet\nDim i           As Integer\nDim iTop        As Integer\nDim iLeft       As Integer\nDim iLblTop     As Integer\nDim iLblLeft    As Integer\nDim iLblWidth   As Integer\nDim iTab        As Integer\nDim strLabel    As String\n\n    On Error GoTo Error_Trap\n    ' Select only optional controls (ID &lt;&gt; 0); skip cotrols always present.\n    strSQL = \"SELECT ctlRptOpt.ControlName, 'lbl' &amp; Mid([ControlName],4,99) AS LabelName, SkipLabel \" &amp; _\n                \"From ctlRptOpt WHERE (((ctlRptOpt.ID)&lt;&gt;0)) \" &amp; _\n                \"GROUP BY ctlRptOpt.ControlName, 'lbl' &amp; Mid([ControlName],4,99), SkipLabel;\"\n    Set rs = New ADODB.recordSet\n    rs.Open strSQL, CurrentProject.Connection, adOpenDynamic\n\n    Do While Not rs.EOF\n        Me(rs!ControlName).Visible = False      ' Hide control\n        If rs!skiplabel = False Then            ' Hide Label if necessary\n            Me(rs!LabelName).Visible = False\n        End If\n        rs.MoveNext\n    Loop\n    rs.Close\n\n    iTop = 0\n    iTab = 0\n\n    ' Get list of controls used by this report; order by desired sequence.\n    strSQL = \"select * from ctlRptOpt \" &amp; _\n                \"where [ID] = \" &amp; Me.cboChooseReport.Column(3) &amp; _\n                \" order by OptionOrder;\"\n    Set rs = New ADODB.recordSet\n    rs.Open strSQL, CurrentProject.Connection, adOpenDynamic\n\n    If rs.EOF Then      ' No options needed\n        Me.cmdShowQuery.Visible = True\n        Me.lblReportCriteria.Visible = False\n        Me.cmdShowQuery.left = 2000\n        Me.cmdShowQuery.top = 1500\n        Me.cmdShowQuery.TabIndex = 1\n        Me.cmdReset.Visible = False\n        rs.Close\n        Set rs = Nothing\n        GoTo Proc_Exit              ' Exit\n    End If\n\n    ' Setup the display of controls.\n    Me.lblReportCriteria.Visible = True\n    Do While Not rs.EOF\n        If rs!skiplabel = False Then\n            strLabel = \"lbl\" &amp; Mid(rs!ControlName, 4)\n            iLblWidth = Me.Controls(strLabel).Width\n            Me(strLabel).top = rs!ControlTop\n            Me(strLabel).left = rs!ControlLeft - (Me(strLabel).Width + 50)\n            Me(strLabel).Visible = True\n        End If\n\n        iTab = iTab + 1         ' Set new Tab Order for the controls\n        Me(rs!ControlName).top = rs!ControlTop\n        Me(rs!ControlName).left = rs!ControlLeft\n        Me(rs!ControlName).Visible = True\n        If left(rs!ControlName, 3) &lt;&gt; \"lbl\" Then\n            Me(rs!ControlName).TabIndex = iTab\n        End If\n\n        If Me(rs!ControlName).top &gt;= iTop Then\n            iTop = rs!ControlTop + Me(rs!ControlName).Height          ' Save last one\n        End If\n\n        ' If not a label and not a 'cmd', it's a filter! Set a default.\n        If left(rs!ControlName, 3) &lt;&gt; \"lbl\" And left(rs!ControlName, 3) &lt;&gt; \"cmd\" Then\n            If Me(rs!ControlName).DefaultValue = \"=\"\"*\"\"\" Then\n'                Me(rs!ControlName) = \"*\"\n            ElseIf left(Me(rs!ControlName).DefaultValue, 2) = \"=#\" And right(Me(rs!ControlName).DefaultValue, 1) = \"#\" Then\n                i = Len(Me(rs!ControlName).DefaultValue)\n'                Me(rs!ControlName) = Mid(Me(rs!ControlName).DefaultValue, 3, i - 3)\n            ElseIf Me(rs!ControlName).DefaultValue = \"True\" Then\n'                Me(rs!ControlName) = True\n            ElseIf Me(rs!ControlName).DefaultValue = \"False\" Then\n'                Me(rs!ControlName) = False\n            End If\n        Else\n            If Me(rs!ControlName).top + Me(rs!ControlName).Height &gt;= iTop Then\n                iTop = rs!ControlTop + Me(rs!ControlName).Height          ' Save last one\n            End If\n        End If\n        rs.MoveNext\n    Loop\n    rs.Close\n    Set rs = Nothing\n\n    If Me.cboChooseReport.Column(1) &lt;&gt; \"rptInventoryByDate\" Then        ' It's special\n        Me.cmdShowQuery.Visible = True\n        Me.cmdShowQuery.left = 2000\n        Me.cmdShowQuery.top = iTop + 300\n        iTab = iTab + 1\n        Me.cmdShowQuery.TabIndex = iTab\n    Else\n        Me.cmdShowQuery.Visible = False\n    End If\n    Me.cmdReset.Visible = True\n    Me.cmdReset.left = 5000\n    Me.cmdReset.top = iTop + 300\n    Me.cmdReset.TabIndex = iTab + 1\n\nProc_Exit:\n    Exit Sub\nError_Trap:\n    Err.Source = \"Form_frmReportChooser: cboChooseReport_Change  at Line: \" &amp; Erl\n    DocAndShowError     ' Save error to database for analysis, then display to user.\n    Resume Proc_Exit    ' Exit code.\n    Resume Next         ' All resumption if debugging.\n    Resume\nEnd Sub\n</code></pre>\n\n<p>lblReportCriteria: We displayed the final set of filters so when users complained of nothing showing on the report, we asked them to send us a screen print. We also passed this text to the report and it was printed as a footer on the last page.</p>\n\n<p>cmdReset: Reset all controls back to their default values.</p>\n\n<p>cmdShowQuery: Executes the running of the report</p>\n\n<pre><code>Private Sub cmdShowQuery_Click()    \nDim qdfDelReport101             As ADODB.Command\nDim qdfAppReport101             As ADODB.Command\nDim qdfDelReport102             As ADODB.Command\nDim qdfAppReport102             As ADODB.Command\nDim qryBase                     As ADODB.Command\nDim strQueryName                As String\nDim strAny_Open_Reports         As String\nDim strOpen_Report              As String\nDim qdfVendorsInfo              As ADODB.Command\nDim rsVendorName                As ADODB.recordSet\nDim strVendorName               As String\nDim rsrpqFormVendorsInfo        As ADODB.recordSet\n\n    On Error GoTo Error_Trap\n    If Not IsNull(Me.cboChooseReport.value) And Me.cboChooseReport.value &lt;&gt; \" \" Then\n        strAny_Open_Reports = Any_Open_Reports()\n        If Len(strAny_Open_Reports) = 0 Then\n\n            If Me.cboChooseReport.value = \"rptAAA\" Then\n                BuildReportCriteria                 '\n                If Me.chkBankBal = True Then\n                    DoCmd.OpenReport \"rptAAA_Opt1\", acViewPreview\n                Else\n                    DoCmd.OpenReport \"rptAAA_Opt2\", acViewPreview\n                End If\n            ElseIf Me.cboChooseReport.value = \"rptBBB\" Then\n                If IsNull(Me.txtFromDate) Or Not IsDate(Me.txtFromDate) Then\n                    MsgBox \"You must enter a valid From Date\", vbOKOnly, \"Invalid Date\"\n                    Exit Sub\n                End If\n                If IsNull(Me.txtToDate) Or Not IsDate(Me.txtToDate) Then\n                    MsgBox \"You must enter a valid To Date\", vbOKOnly, \"Invalid Date\"\n                    Exit Sub\n                End If\n\n                Me.txtStartDate = Me.txtFromDate\n                Me.txtEndDate = Me.txtToDate\n                DoCmd.OpenReport Me.cboChooseReport.value, acViewPreview\n            ElseIf Me.cboChooseReport.value = \"rptCCC\" Then\n                If Me.txtVendorName = \"*\" Then\n                    gvstr_VendorName = \"*\"\n                Else\n                    Set rsVendorName = New ADODB.recordSet\n                    rsVendorName.Open \"selVendorName\", gv_DBS_Local, adOpenDynamic\n\n                    Set qdfVendorsInfo = New ADODB.Command\n                    qdfVendorsInfo.ActiveConnection = gv_DBS_SQLServer\n                    qdfVendorsInfo.CommandText = (\"qryVendorsInfo\")\n                    qdfVendorsInfo.CommandType = adCmdStoredProc\n                    strVendorName = rsVendorName(\"VendorName\")\n                    gvstr_VendorName = strVendorName\n                End If\n                DoCmd.OpenReport \"rptFormVendorReport\", acViewPreview\n            Else\n                BuildReportCriteria\n                If Me.cboChooseReport.value = \"rptXXXXXX\" Then\n                ElseIf Me.cboChooseReport.value = \"rptyyyy\" Then\n                    On Error Resume Next         ' All resumption if debugging.\n                    DoCmd.DeleteObject acTable, \"temp_xxxx\"\n                    On Error GoTo Error_Trap\n                    Set qryBase = New ADODB.Command\n                    qryBase.ActiveConnection = gv_DBS_Local\n                    qryBase.CommandText = (\"mtseldata...\")\n                    qryBase.CommandType = adCmdStoredProc\n                    qryBase.Execute\n                End If\n                DoCmd.Hourglass False\n                DoCmd.OpenReport Me.cboChooseReport.value, acViewPreview\n            End If\n        Else\n            MsgBox \"You cannot open this form/report because you already have a form/report(s) open: \" &amp; _\n                    vbCrLf &amp; strAny_Open_Reports &amp; _\n                    vbCrLf &amp; \"Please close the open form/report(s) before continuing.\"\n\n             strOpen_Report = Open_Report\n             DoCmd.SelectObject acReport, strOpen_Report\n             DoCmd.ShowToolbar \"tbForPost\"\n        End If\n    Else\n         MsgBox \"Please Choose Report\", vbExclamation, \"Choose Report\"\n    End If\n\n    Exit Sub\n\nError_Trap:\n    Err.Source = \"Form_frmReportChooser: cmdShowQuery_Click - Report: \" &amp; Nz(Me.cboChooseReport.value) &amp; \"    at Line: \" &amp; Erl\n    If Err.Number = 2501 Then   ' MsgBox \"You chose not to open this report.\", vbOKOnly, \"Report cancelled\"\n        Exit Sub\n    ElseIf Err.Number = 0 Or Err.Number = 7874 Then\n        Resume Next         ' All resumption if debugging.\n\n    ElseIf Err.Number = 3146 Then   ' ODBC -- call failed -- can have multiple errors\nDim errLoop     As Error\nDim strError    As String\nDim Errs1       As Errors\n\n    ' Enumerate Errors collection and display properties of each Error object.\n    i = 1\n      Set Errs1 = gv_DBS_SQLServer.Errors\n        Err.Description = Err.Description &amp; \"; Err.Count = \" &amp; gv_DBS_SQLServer.Errors.Count &amp; \"; \"\n        For Each errLoop In Errs1\n            With errLoop\n                Err.Description = Err.Description &amp; \"Error #\" &amp; i &amp; \":\" &amp; \" ADO Error#\" &amp; .Number &amp; _\n                        \" Description= \" &amp; .Description\n                i = i + 1\n            End With\n        Next\n\n    End If\n    DocAndShowError     ' Save error to database for analysis, then display to user.\n    Exit Sub\n    Resume Next         ' All resumption if debugging.\n    Resume\nEnd Sub\n</code></pre>\n\n<p>Function to build a string showing all of the selection criteria:</p>\n\n<pre><code>Function BuildReportCriteria()\nDim frmMe           As Form\nDim ctlEach         As Control\nDim strCriteria     As String\nDim prp             As Property\nDim strSQL          As String\nDim rs              As ADODB.recordSet\n\n    On Error GoTo Error_Trap\n\n    strSQL = \"select * from ctlRptOpt \" &amp; _\n                \"where ID = \" &amp; Me.cboChooseReport.Column(3) &amp; _\n                \" order by OptionOrder;\"\n    Set rs = New ADODB.recordSet\n    rs.Open strSQL, CurrentProject.Connection, adOpenDynamic\n\n    If rs.EOF Then\n        strCriteria = \"     Report Criteria:  None\"\n    Else\n        strCriteria = \"     Report Criteria:  \"\n    End If\n\n    Do While Not rs.EOF\n        Set ctlEach = Me.Controls(rs!ControlName)\n        If ctlEach.ControlType = acTextBox Or ctlEach.ControlType = acComboBox Then\n            If ctlEach.value &lt;&gt; \"*\" And ctlEach.Name &lt;&gt; \"cboChooseReport\" And ctlEach.Name &lt;&gt; \"cboLocCountry\" Then\n                strCriteria = strCriteria &amp; ctlEach.Tag &amp; \" = \" &amp; ctlEach.value &amp; \" , \"\n            End If\n         End If\n        rs.MoveNext\n    Loop\n    rs.Close\n    Set rs = Nothing\n\n    If Me.chkOblBal = -1 Then\n        strCriteria = strCriteria &amp; \"Non-zero balances only = Yes\"\n    Else\n    'return string with all choosen criteria and remove last \" , \" from the end of string\n        strCriteria = left$(strCriteria, Len(strCriteria) - 3)\n    End If\n    fvstr_ReportCriteria = strCriteria\n\n    Set ctlEach = Nothing\n\n    Exit Function\nError_Trap:\n    If Err.Number = 2447 Then\n        Resume Next         ' All resumption if debugging.\n    End If\n    Err.Source = \"Form_frmReportChooser: BuildReportCriteria  at Line: \" &amp; Erl\n    DocAndShowError     ' Save error to database for analysis, then display to user.\n    Exit Function\n    Resume Next         ' All resumption if debugging.\nEnd Function\n</code></pre>\n\n<p>Finally, each report had it's own query that would filter based on the values in the controls on this form.</p>\n\n<p>Hope this helps. If you are curious about any of the weird things you see, let me know. (i.e. we always used line numbers in the code (I deleted before posting) that allowed us to identify exact line where code fails)</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user2363207"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 184, "favorite_count": 0, "accepted_answer_id": 40894128, "answer_count": 1, "score": 0, "last_activity_date": 1480525434, "creation_date": 1480443802, "last_edit_date": 1495539957, "question_id": 40873059, "link": "https://stackoverflow.com/questions/40873059/should-i-re-purpose-subform-controls-on-one-form-or-just-create-multiple-forms", "title": "Should I re-purpose subform controls on one form or just create multiple forms?", "body": "<p>In my office of 65 people, I want to create a \"portal\" for all the employees out of a single .accdb file. It will allow each employee to navigate to a new \"screen\" from a dropdown menu. </p>\n\n<p>Should I use a single form with plug-and-play subform controls in order to centralize the VBA code, or should I just use different forms? </p>\n\n<p>I'm thinking it would be nice to have one form with plug-and-play subform controls. When the employee selects a new \"screen\", the VBA just sets the <code>SourceObject</code> property of each subform control and then re-arranges the subforms based on the layout of the selected \"screen\".</p>\n\n<p>For instance, we currently use a couple of Access database forms to enter and review errors that we find in our workflow system. So in this scenario, to review the errors I would just say  </p>\n\n<pre><code>SubForm1.SourceObject = \"Form.ErrorCriteria\"\nSubForm2.SourceObject = \"Form.ErrorResults\"\n</code></pre>\n\n<p>And then I would just move them into place (these values would be pulled dynamically based upon the \"screen\" selected):</p>\n\n<pre><code>SubForm1.Move WindowWidth * 0.05, WindowHeight * 0.05, WindowWidth * 0.9, WindowHeight * 0.2\nSubForm2.Move WindowWidth * 0.05, WindowHeight * 0.25, WindowWidth * 0.9, WindowHeight * 0.65\n</code></pre>\n\n<p>So this creates a small header section (<code>SubForm1</code>) on the form where I can select the criteria for the errors I want to see (data range, which team committed the error, etc) and then I can view the errors in the much larger section below the header (<code>SubForm2</code>) that holds the datasheet with the results.</p>\n\n<p>I can propogate events up to the main form from the <code>ErrorCriteria</code> and <code>ErrorResults</code> forms that are now bound to the subform controls. That will help me to use the basic MVC design pattern for VBA described <a href=\"https://stackoverflow.com/a/28347000/2363207\">here</a>. I can treat the main form as the view, even though parts of that view are buried in subform controls. The controller only has to know about that one view. </p>\n\n<p>My problem comes when the user selects a new \"screen\" from the dropdown menu. I think it would be nice to just re-purpose the subform controls, like so:</p>\n\n<pre><code>SubForm1.SourceObject = \"Form.WarehouseCriteria\"\nSubForm2.SourceObject = \"Form.InventoryResults\"\n</code></pre>\n\n<p>And then just move/resize those subforms to the appropriate layout for the \"Inventory\" screen. </p>\n\n<p>This approach seems to make the user interface design cleaner in my mind because you basically only ever have to deal with one main form that acts as a template and then you plug in the values (the <code>SourceObject</code> properties) into that template. </p>\n\n<p>But each time we change the \"screen\", we have a totally different \"Model\" behind the scenes and a new \"View\" too according to the MVC design pattern. I wonder if that would clutter up the MVC VBA code behind the scenes, or if the VBA code itself could be modularized too (possibly using Interfaces) to make it just as adaptable as the user interface. </p>\n\n<p>What is the cleanest way to do this from both a User Interface perspective, and from a VBA perspective. Use one main form as template where other forms could be swapped in and out as subforms, or just close the current form and open a new form when the user selects a new \"screen\" from the dropdown menu.</p>\n"}, {"tags": ["excel", "date", "format", "vba"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 1, "creation_date": 1480443869, "post_id": 40872871, "comment_id": 68961284, "body": "The time portion of a <code>Date</code> is a fraction.  Using <code>CLng</code> on a <code>Date</code> that only contains a time will round away from noon. What exactly are you trying to calculate?"}, {"owner": {"reputation": 109, "user_id": 7191500, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/2FDjM.jpg?s=128&g=1", "display_name": "jmeddy", "link": "https://stackoverflow.com/users/7191500/jmeddy"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1480449172, "post_id": 40872871, "comment_id": 68964301, "body": "In Column AA are Dates with format (mm/dd/yyyy) and Column AB has the respective Times with format (hh:mm:ss). I would like to subtract the date and time from Now(). Thanks for the info on CLng. Initially, I concatenated the date and time and then used CLng, which worked great for me. But for others, it didn&#39;t work so I thought there may have been something wrong with how I concatenated so I split up the date and time. But that wasn&#39;t the case."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1480449457, "post_id": 40872871, "comment_id": 68964448, "body": "Do you have dates and times in columns AA and AB, or do you have strings that look like dates and times in those columns?  (If you switch the cell format to <code>General</code> temporarily and the cells show numbers, then the contents were dates/times, but if they continue to show things that look like dates and times, then the contents are just strings.)"}, {"owner": {"reputation": 109, "user_id": 7191500, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/2FDjM.jpg?s=128&g=1", "display_name": "jmeddy", "link": "https://stackoverflow.com/users/7191500/jmeddy"}, "edited": false, "score": 1, "creation_date": 1480449587, "post_id": 40872871, "comment_id": 68964509, "body": "I did a Format check on it and it is Text format."}], "answers": [{"comments": [{"owner": {"reputation": 109, "user_id": 7191500, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/2FDjM.jpg?s=128&g=1", "display_name": "jmeddy", "link": "https://stackoverflow.com/users/7191500/jmeddy"}, "edited": false, "score": 0, "creation_date": 1480448626, "post_id": 40873825, "comment_id": 68963973, "body": "Thanks for the reply. I tried it and am getting a Type Mismatch for the same section: <code>(Range(&quot;AA&quot; &amp; i).Value2 + Range(&quot;AB&quot; &amp; i).Value2)</code>.. When I hover the mouse over <code>Range(&quot;AA&quot; &amp; i).Value2</code> I get MM/DD/YYYY and for <code>Range(&quot;AB&quot; &amp; i).Value2</code> I get hh:mm:ss.   CDbl(Now()) gives the numerical representation of 42703.48.. Seems like I still need to find a way to convert to numerical representation without using regional settings?"}, {"owner": {"reputation": 109, "user_id": 7191500, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/2FDjM.jpg?s=128&g=1", "display_name": "jmeddy", "link": "https://stackoverflow.com/users/7191500/jmeddy"}, "edited": false, "score": 0, "creation_date": 1480450646, "post_id": 40873825, "comment_id": 68965075, "body": "I&#39;m not 100% sure but i think your answer would&#39;ve worked if my date/time format in columns AA/AB weren&#39;t text..?"}], "tags": [], "owner": {"reputation": 86, "user_id": 5647459, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9870136b504fc406965536c1247097b?s=128&d=identicon&r=PG&f=1", "display_name": "Phillip Beck", "link": "https://stackoverflow.com/users/5647459/phillip-beck"}, "is_accepted": false, "score": 0, "last_activity_date": 1480446343, "creation_date": 1480446343, "answer_id": 40873825, "question_id": 40872871, "link": "https://stackoverflow.com/questions/40872871/vba-2010-cdate-type-mismatch-issue/40873825#40873825", "title": "VBA 2010 - CDate Type Mismatch Issue", "body": "<p>You can use the <code>Value2</code> property of the <code>Range</code> object to get the numerical representation of a <code>DateTime</code>. Try:</p>\n\n<pre><code>If CDbl(Now()) - (Range(\"AA\" &amp; i).Value2 + Range(\"AB\" &amp; i).Value2) &gt;= 7 Then\n</code></pre>\n\n<p>Just be sure to convert <code>Now()</code> to <code>Double</code>, otherwise it will use just the date part of the <code>DateTime</code>.</p>\n\n<p>I find it easier to work with the numerical representation of the <code>DateTime</code>, as it allows you to bypass the regional settings.</p>\n"}, {"comments": [{"owner": {"reputation": 109, "user_id": 7191500, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/2FDjM.jpg?s=128&g=1", "display_name": "jmeddy", "link": "https://stackoverflow.com/users/7191500/jmeddy"}, "edited": false, "score": 0, "creation_date": 1480450574, "post_id": 40874816, "comment_id": 68965034, "body": "That worked for me! I am going to make sure it works for the others real quick, but I think this may do the trick. I will followup asap."}, {"owner": {"reputation": 109, "user_id": 7191500, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/2FDjM.jpg?s=128&g=1", "display_name": "jmeddy", "link": "https://stackoverflow.com/users/7191500/jmeddy"}, "edited": false, "score": 0, "creation_date": 1480451485, "post_id": 40874816, "comment_id": 68965533, "body": "I see.. I was hoping there would be a solution to avoid having to customize the code for each individual based on their settings..  It would be a lot of work to update this for each person each time there is a revision. Is there an option to change the format from text to a usable format to bypass this?"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 109, "user_id": 7191500, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/2FDjM.jpg?s=128&g=1", "display_name": "jmeddy", "link": "https://stackoverflow.com/users/7191500/jmeddy"}, "edited": false, "score": 0, "creation_date": 1480451761, "post_id": 40874816, "comment_id": 68965674, "body": "@jmeddy - If the values in AA and AB are stored in the user&#39;s date/time settings, the first method I supplied would work.  If the values in AA and AB are stored in a fixed mm/dd/yyyy and hh:mm:ss setting then the alternate code I supplied will work, irrespective of the user&#39;s settings."}, {"owner": {"reputation": 109, "user_id": 7191500, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/2FDjM.jpg?s=128&g=1", "display_name": "jmeddy", "link": "https://stackoverflow.com/users/7191500/jmeddy"}, "edited": false, "score": 0, "creation_date": 1480460927, "post_id": 40874816, "comment_id": 68970001, "body": "It is working like a charm with the alternate code you provided. Thank you very much!"}], "tags": [], "owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "is_accepted": true, "score": 2, "last_activity_date": 1480450611, "last_edit_date": 1480450611, "creation_date": 1480449837, "answer_id": 40874816, "question_id": 40872871, "link": "https://stackoverflow.com/questions/40872871/vba-2010-cdate-type-mismatch-issue/40874816#40874816", "title": "VBA 2010 - CDate Type Mismatch Issue", "body": "<p>If columns AA and AB contain text rather than dates and times, try using the following statement:</p>\n\n<pre><code>If Now() - (DateValue(Range(\"AA\" &amp; i)) + TimeValue(Range(\"AB\" &amp; i))) &gt;= 7 Then\n</code></pre>\n\n<p>This will probably still be problematic if the users have a local date setting of, for instance, <code>dd/mm/yyyy</code> but your columns are storing a string representing a date in some other locale's date setting.  If that is the case, you may need to parse the fields and do it as follows:</p>\n\n<pre><code>Dim myDateStr As String\nDim myTimeStr As String\nDim myDateTime As Date\nmyDateStr = Range(\"AA\" &amp; i)\nmyTimeStr = Range(\"AB\" &amp; i)\nmyDateTime = DateSerial(CInt(Mid(myDateStr, 7, 4)), CInt(Mid(myDateStr, 1, 2)), CInt(Mid(myDateStr, 4, 2))) + _\n             TimeSerial(CInt(Mid(myTimeStr, 1, 2)), CInt(Mid(myTimeStr, 4, 2)), CInt(Mid(myTimeStr, 7, 2)))\n\nIf Now() - myDateTime &gt;= 7 Then\n</code></pre>\n"}], "owner": {"reputation": 109, "user_id": 7191500, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/2FDjM.jpg?s=128&g=1", "display_name": "jmeddy", "link": "https://stackoverflow.com/users/7191500/jmeddy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 727, "favorite_count": 0, "accepted_answer_id": 40874816, "answer_count": 2, "score": 0, "last_activity_date": 1480450611, "creation_date": 1480443190, "last_edit_date": 1531164843, "question_id": 40872871, "link": "https://stackoverflow.com/questions/40872871/vba-2010-cdate-type-mismatch-issue", "title": "VBA 2010 - CDate Type Mismatch Issue", "body": "<p>I have the following code that runs without issue on some laptops and then others it will error out with a Type Mismatch. In Column AA are Dates with format (mm/dd/yyyy) and Column AB has the respective Times with format (hh:mm:ss).\nI am subtracting the date and time from Now(). I am unable to really troubleshoot the issue because it works fine on my laptop. For others, it errors out. <code>CLng(CDate(Now()))</code> has a value but the other two induce type mismatch. I've tried the two lines below and also another which concatenated the date and time, then performed CLng(CDate(. </p>\n\n<pre><code>'If CLng(CDate(Now())) - CLng(CDate(Range(\"AA\" &amp; i).Value)) + CLng(CDate(Range(\"AB\" &amp; i).Value)) &gt;= 7 Then\n If CLng(CDate(Now())) - CLng(CDate(FMT(Range(\"AA\" &amp; i), \"mm/dd/yyyy\"))) + CLng(CDate(FMT(Range(\"AB\" &amp; i), \"hh:mm:ss\"))) &gt;= 7 Then\n</code></pre>\n\n<p>where FMT is a public function:</p>\n\n<pre><code>Public Function FMT$(ByVal Value, ByVal strFormat)\nFMT = VBA.Format$(Value, strFormat)\nEnd Function\n</code></pre>\n\n<p>I am requesting my colleague to send me a screenshot of his region date/time settings.. I was thinking this could be the case. I've read other questions similar to this but not able to figure it out. Thanks in advance.</p>\n"}, {"tags": ["vba", "email", "outlook"], "comments": [{"owner": {"reputation": 2787, "user_id": 3688861, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54740a77960418f6992ef8e8cf88deba?s=128&d=identicon&r=PG&f=1", "display_name": "Tragamor", "link": "https://stackoverflow.com/users/3688861/tragamor"}, "edited": false, "score": 0, "creation_date": 1481133020, "post_id": 40872771, "comment_id": 69255330, "body": "The body of the reply is dependent on the recipient and whether they edit the reply before sending. Therefore you have two options that I can see. Either the recipients will each require a VBA backend to alter the message to return to you (unlikely to be achievable) or you can add a hash code of sorts (or date-time) to the subject so that you can know which e-mail it refers to when the vote is received"}, {"owner": {"reputation": 2787, "user_id": 3688861, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54740a77960418f6992ef8e8cf88deba?s=128&d=identicon&r=PG&f=1", "display_name": "Tragamor", "link": "https://stackoverflow.com/users/3688861/tragamor"}, "edited": false, "score": 0, "creation_date": 1481133103, "post_id": 40872771, "comment_id": 69255373, "body": "<a href=\"http://stackoverflow.com/questions/7710191/getting-messageid-from-email-in-outlook-vba-2003\" title=\"getting messageid from email in outlook vba 2003\">stackoverflow.com/questions/7710191/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 313, "user_id": 7163759, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Lw4Ay.jpg?s=128&g=1", "display_name": "SalvadorVayshun", "link": "https://stackoverflow.com/users/7163759/salvadorvayshun"}, "edited": false, "score": 0, "creation_date": 1481143778, "post_id": 41024891, "comment_id": 69261486, "body": "Very inventive. In fact, so inventive, that I ended up doing that very thing to solve the issue. I wanted to keep the question open to see if there were any other alternatives or ideas that others may have for me. However, great idea, because that is exactly what I used to get around this!"}, {"owner": {"reputation": 2787, "user_id": 3688861, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54740a77960418f6992ef8e8cf88deba?s=128&d=identicon&r=PG&f=1", "display_name": "Tragamor", "link": "https://stackoverflow.com/users/3688861/tragamor"}, "reply_to_user": {"reputation": 313, "user_id": 7163759, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Lw4Ay.jpg?s=128&g=1", "display_name": "SalvadorVayshun", "link": "https://stackoverflow.com/users/7163759/salvadorvayshun"}, "edited": false, "score": 0, "creation_date": 1481146474, "post_id": 41024891, "comment_id": 69262968, "body": "The extension to this is that if the hash is reversible, you could set up a newmail event to check for the hash, search sent items for the original e-mail (based on the hash time stamp) then copy the sent e-mail body into the reply body. Therefore actually completing what the remit of the original question was."}, {"owner": {"reputation": 313, "user_id": 7163759, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Lw4Ay.jpg?s=128&g=1", "display_name": "SalvadorVayshun", "link": "https://stackoverflow.com/users/7163759/salvadorvayshun"}, "edited": false, "score": 0, "creation_date": 1481202991, "post_id": 41024891, "comment_id": 69288082, "body": "I agree. This wholely fulfills the requirements of the question, and it can be used to get around the issue at hand. I&#39;m going to keep the question open until the end of the week, in hopes that someone comes along with a way to truly pass the information in the body. It seems like such a simple issue to solve, yet there is no direct way to solve it. Typical Microsoft."}], "tags": [], "owner": {"reputation": 2787, "user_id": 3688861, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54740a77960418f6992ef8e8cf88deba?s=128&d=identicon&r=PG&f=1", "display_name": "Tragamor", "link": "https://stackoverflow.com/users/3688861/tragamor"}, "is_accepted": true, "score": 1, "last_activity_date": 1481188361, "last_edit_date": 1481188361, "creation_date": 1481135887, "answer_id": 41024891, "question_id": 40872771, "link": "https://stackoverflow.com/questions/40872771/votingoptions-response-reply-with-custom-body/41024891#41024891", "title": "VotingOptions Response Reply with Custom Body", "body": "<p>As I mentioned in the comments above, I think adding a small hash to the subject is the only way you can track message thread replies. Below is some code for generating a hash based on the date and time to add as a prefix to the subject</p>\n\n<pre><code>Sub TestHash()\n    Dim lDate As Date: lDate = Now\n    MsgBox DateTimeHash(lDate)\nEnd Sub\n\nFunction DateTimeHash(lDate As Date) As String\n    DateTimeHash = \"#\" &amp; fBase36Encode(DateValue(lDate)) &amp; _\n    fBase36Encode(60 * (60 * Hour(lDate) + Minute(lDate)) + Second(lDate)) &amp; \"#\"\nEnd Function\n\nFunction fBase36Encode(ByRef lngNumToConvert As Long) As String\n    'Will Convert any Positive Integer to a Base36 String\n    fBase36Encode = \"0\"\n    If lngNumToConvert = 0 Then Exit Function\n\n    Dim strAlphabet As String: strAlphabet = \"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ\"\n    fBase36Encode = vbNullString\n    Do While lngNumToConvert &lt;&gt; 0\n        fBase36Encode = Mid(strAlphabet, lngNumToConvert Mod 36 + 1, 1) &amp; fBase36Encode\n        lngNumToConvert = lngNumToConvert \\ 36\n    Loop\nEnd Function\n</code></pre>\n\n<p><strong>* EDIT *</strong></p>\n\n<p>Using a reversible base 64 hash instead:</p>\n\n<pre><code>Sub TestHash()\n    Dim lDate As Date: lDate = Now\n    Debug.Print DateTimeHash(lDate)\n    Debug.Print DateTimeUnhash(DateTimeHash(lDate))\nEnd Sub\n\nFunction DateTimeHash(ByRef lDate As Date) As String\n    Dim Secs As String: Secs = Encode64(60 * (60 * Hour(lDate) + Minute(lDate)) + Second(lDate))\n    DateTimeHash = \"#\" &amp; Encode64(DateValue(lDate)) &amp; String(3 - Len(Secs), \"0\") &amp; Secs &amp; \"#\"\nEnd Function\n\nFunction DateTimeUnhash(ByRef Hash As String) As Date\n    Hash = Replace(Hash, \"#\", \"\")\n    Dim Days As Long: Days = Decode64(Left(Hash, Len(Hash) - 3))\n    Dim Secs As Long: Secs = Decode64(Right(Hash, 3))\n    DateTimeUnhash = DateAdd(\"d\", Days, \"0\") + DateAdd(\"s\", Secs, \"0\")\nEnd Function\n\nFunction Encode64(ByRef Value As Long) As String\n    'Will Convert any Positive Integer to a Base64 String\n    Const Base64 = \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\"\n\n    Encode64 = IIf(Value &gt; 0, vbNullString, \"0\")\n    If Encode64 = \"0\" Then Exit Function\n    Do While Value &lt;&gt; 0\n        Encode64 = Mid(Base64, Value Mod 64 + 1, 1) &amp; Encode64\n        Value = Value \\ 64\n    Loop\nEnd Function\n\nFunction Decode64(ByRef Value As String) As Long\n    'Will Convert any Base64 String to a Positive Integer\n    Const Base64 = \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\"\n\n    Decode64 = IIf(Value = \"\", -1, 0)\n    Dim i As Long: For i = 1 To Len(Value)\n        If Decode64 = -1 Then Exit Function ' Error detected with Value string\n        Decode64 = Decode64 * 64\n        Decode64 = IIf(InStr(Base64, Mid(Value, i, 1)) &gt; 0, _\n            Decode64 + InStr(Base64, Mid(Value, i, 1)) - 1, -1)\n    Next i\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 313, "user_id": 7163759, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Lw4Ay.jpg?s=128&g=1", "display_name": "SalvadorVayshun", "link": "https://stackoverflow.com/users/7163759/salvadorvayshun"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1200, "favorite_count": 0, "accepted_answer_id": 41024891, "answer_count": 1, "score": 0, "last_activity_date": 1593415088, "creation_date": 1480442825, "last_edit_date": 1593415088, "question_id": 40872771, "link": "https://stackoverflow.com/questions/40872771/votingoptions-response-reply-with-custom-body", "title": "VotingOptions Response Reply with Custom Body", "body": "<p>I have a very particular issue, and one that I believe may even be a duplicate of <a href=\"https://stackoverflow.com/questions/39774710/outlook-vba-include-original-body-message-in-votingoptions-respose\">this question</a>, but it was never answered. I have a macro that runs when I accept specific emails. It replies to the email with a voting option of either \"Approved\" or \"Rejected\". When the recipient of the voting option responds with their choice, the received \"choice\" email does not have a body. Is there a way to retain the body?</p>\n\n<p>I've tried this so far:</p>\n\n<pre><code>With objMsg\n  .To = strEmail\n  .HTMLBody = Item.HTMLBody\n  .Subject = \"Is This Approved?\"\n  .VotingOptions = \"Approved;Rejected\"\n  .VotingResponse = \"Yes\"\n  .Attachments.Add Item\n  .Display\n  .Send\nEnd With\n</code></pre>\n\n<p>However I believe this is only effecting the initial email and not the responses. I've look at the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff861332.aspx\" rel=\"nofollow noreferrer\">MailItem Object</a> as well, but didn't see any options for Voting outside of <code>.VotingOptions</code> and <code>.VotingResponse</code>. Is there anything I could be missing that would help me to complete this goal?</p>\n\n<p>Additionally, I would be open to ideas outside of Voting buttons (such as a Task or something like that) as long as it can include the body in the response.</p>\n\n<p>Any ideas would be greatly appreciated.</p>\n"}]