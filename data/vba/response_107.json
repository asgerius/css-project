[{"tags": ["vba", "excel", "listbox", "userform"], "comments": [{"owner": {"reputation": 1472, "user_id": 1726522, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/0DUTN.gif?s=128&g=1", "display_name": "CMArg", "link": "https://stackoverflow.com/users/1726522/cmarg"}, "edited": false, "score": 1, "creation_date": 1485389757, "post_id": 41863864, "comment_id": 70911621, "body": "Can&#39;t look closer to your problem right now, but wouldn&#39;t be easier to have only one UserForm with three ComboBoxes (month, location, audit), the input and the submit? Of course you should change <code>ActiveSheet</code> with <code>Worksheet(ComboMonth.value)</code> or similar. I will try later if there are not any other responses."}, {"owner": {"reputation": 3, "user_id": 7460372, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63cb3d636960416123f27b74cc2fbd53?s=128&d=identicon&r=PG", "display_name": "user7460372", "link": "https://stackoverflow.com/users/7460372/user7460372"}, "reply_to_user": {"reputation": 1472, "user_id": 1726522, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/0DUTN.gif?s=128&g=1", "display_name": "CMArg", "link": "https://stackoverflow.com/users/1726522/cmarg"}, "edited": false, "score": 0, "creation_date": 1485391135, "post_id": 41863864, "comment_id": 70912010, "body": "@CMArg the reason I&#39;ve separated the userforms is that once I get this part to work and learn a little more about vba I plan to add a few additional items and functions to the userform that selects the month. In your opinion is vba a good first language to learn? I&#39;m dabbling in a little c# and c++ also but so far vba has been the easiest for me to understand. I&#39;m very new to this so any advice would be appreciated."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 7460372, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63cb3d636960416123f27b74cc2fbd53?s=128&d=identicon&r=PG", "display_name": "user7460372", "link": "https://stackoverflow.com/users/7460372/user7460372"}, "edited": false, "score": 0, "creation_date": 1485394702, "post_id": 41864436, "comment_id": 70912862, "body": "thank you so much!  That&#39;s EXACTLY what I needed. Once I learn vba better which language would you recommend learning next. My long term goal is to build a stand alone program that functions similarly without using excel or access."}, {"owner": {"reputation": 1472, "user_id": 1726522, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/0DUTN.gif?s=128&g=1", "display_name": "CMArg", "link": "https://stackoverflow.com/users/1726522/cmarg"}, "reply_to_user": {"reputation": 3, "user_id": 7460372, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63cb3d636960416123f27b74cc2fbd53?s=128&d=identicon&r=PG", "display_name": "user7460372", "link": "https://stackoverflow.com/users/7460372/user7460372"}, "edited": false, "score": 0, "creation_date": 1485429941, "post_id": 41864436, "comment_id": 70926455, "body": "Really don&#39;t know which language would be fine, since I just know only a little bit of VBA and PHP, and do not belong to a &quot;programmers&#39; community&quot; nor anything similar. You should ask to someone else. Glad to help with your code."}], "tags": [], "owner": {"reputation": 1472, "user_id": 1726522, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/0DUTN.gif?s=128&g=1", "display_name": "CMArg", "link": "https://stackoverflow.com/users/1726522/cmarg"}, "is_accepted": true, "score": 0, "last_activity_date": 1485392823, "creation_date": 1485392823, "answer_id": 41864436, "question_id": 41863864, "link": "https://stackoverflow.com/questions/41863864/vba-userform-to-place-data/41864436#41864436", "title": "Vba userform to place data", "body": "<p>A very shrunken example. <code>ListIndex</code> indicates the number of the selected item of the ComboBox, starting at 0. Just change both <code>+1</code> to get to the proper row/column. For example, if Audit1 goes to column F, Audit2 to G and Audit3 to I, then in the ComboBox for audit write <code>ComboBoxAudit.ListIndex + 6</code>.</p>\n\n<pre><code>Private Sub Marsubmit_Click()\n    Dim C1 As Integer\n    Dim C2 As Integer\n    Dim T1 As String\n\n    C1 = ComboBox1.ListIndex + 1\n    C2 = ComboBox2.ListIndex + 1\n    T1 = TextBox1.Value\n\n    Worksheets(\"Mar\").Cells(C1, C2) = T1\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 7460372, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63cb3d636960416123f27b74cc2fbd53?s=128&d=identicon&r=PG", "display_name": "user7460372", "link": "https://stackoverflow.com/users/7460372/user7460372"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 429, "favorite_count": 1, "accepted_answer_id": 41864436, "answer_count": 1, "score": 0, "last_activity_date": 1485392823, "creation_date": 1485388558, "last_edit_date": 1531164843, "question_id": 41863864, "link": "https://stackoverflow.com/questions/41863864/vba-userform-to-place-data", "title": "Vba userform to place data", "body": "<p>Ok guys I have an excel workbook which tracks scoring information. \nThere are 12 sheets, one for each month.\nOn these sheets b2:b54 contain office locations. \nF1:I1 contains titles \"audit 1\" \"audit 2\" and so on. </p>\n\n<p>When the book opens, a userform initializes with 12 buttons for the months. \nI'll use March as my example. When the user clicks the March button it takes them to the March sheet.</p>\n\n<p>Once the March sheet opens, another userform initializes. </p>\n\n<p>This userform contains 2 list boxes, 1 textbox, and a submit button.  </p>\n\n<p>The idea is that the user would choose from the office location from listbox 1 which would determine the row to place the score on. </p>\n\n<p>The user would select the type of audit from listbox 2 which would determine the column to place the score in. </p>\n\n<p>The user would enter the score in  textbox1 which would be the data needed for entry. </p>\n\n<p>Upon pressing the \"submit\" button, the score would be placed at the intersection of the chosen office and type of audit. </p>\n\n<p>I'm trying to work at this one piece at a time. So here's my first issue: </p>\n\n<p>I can't figure out how to add the data from textbox1 to the intersection of the row containing the selection from listbox 1 and the column containing the selection listbox 2.</p>\n\n<p>The following code is what I'm attempting at the moment with no luck:</p>\n\n<p>Private Sub Marsubmit_Click()</p>\n\n<p>Dim MarR As String</p>\n\n<pre><code>Dim MarC As Integer\n\n    Dim M_A As String\n\n        Dim M_B As String\n\n        Dim M_S As String\n\n        Dim M_C As Range\n\n    Dim C As Integer\n\n    Dim R As Integer\n\n\n\n    R = 2\n\n    C = 2\n\n\n\n\n\n\n\n        M_S = Marscbx.Value\n\n            M_B = Formboxmar.Value\n\n                M_A = Officeboxmar.Value\n\n                MarC = 2\n\n\n\n                If M_B = ActiveSheet.Range(\"F1\").Value Then MarC = MarC + 4\n\n                If M_B = ActiveSheet.Range(\"G1\").Value Then MarC = MarC + 5\n\n                If M_B = ActiveSheet.Range(\"H1\").Value Then MarC = MarC + 6\n\n                If M_B = ActiveSheet.Range(\"I1\").Value Then MarC = MarC + 7\n\n\n\n\n\n\n\n               If M_A = ActiveSheet.Cell(C, R).Value Then MarR = \"True\"\n\n               If MarR = \"True\" Then M_C = ActiveSheet.Cell(C, MarC)\n\n            Do Until MarR = \"True\"\n\n               C = C + 1\n\n               Loop\n\n\n\n                ActiveSheet.Range(M_C).Value = M_S\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 2478, "user_id": 6110371, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/O93Qp.jpg?s=128&g=1", "display_name": "VBA Pete", "link": "https://stackoverflow.com/users/6110371/vba-pete"}, "is_accepted": false, "score": 2, "last_activity_date": 1485386974, "last_edit_date": 1485386974, "creation_date": 1485385480, "answer_id": 41863308, "question_id": 41863221, "link": "https://stackoverflow.com/questions/41863221/vba-how-to-concatenate-range-of-cells-in-a-column-with-strings-and-generate-it/41863308#41863308", "title": "VBA: How to concatenate range of cells in a column with strings and generate it in another column?", "body": "<p>I would put the code in a <strong>FOR Loop</strong>:</p>\n\n<pre><code>Sub Concatenator()\n\nDim lastLng As Long\n\nlastLng = ActiveSheet.UsedRange.Rows(ActiveSheet.UsedRange.Rows.Count).Row\n\n    For x = 1 To lastLng\n\n    Cells(x, 2).Value = \"'\" &amp; Cells(x, 1).Value &amp; \"',\"\n\n    Next x\n\nEnd Sub\n</code></pre>\n\n<p>Alternatively, if you don't want to use a loop, you can use the code below to paste your formula in column B:</p>\n\n<pre><code>Sub Concatenator()\n\nDim lastLng As Long\n\nlastLng = ActiveSheet.UsedRange.Rows(ActiveSheet.UsedRange.Rows.Count).Row\n\n    Range(\"B1:B\" &amp; lastLng).Formula = \"=\"\"'\"\" &amp; A1 &amp; \"\",'\"\"\"\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": false, "score": 0, "last_activity_date": 1485415280, "creation_date": 1485415280, "answer_id": 41868518, "question_id": 41863221, "link": "https://stackoverflow.com/questions/41863221/vba-how-to-concatenate-range-of-cells-in-a-column-with-strings-and-generate-it/41868518#41868518", "title": "VBA: How to concatenate range of cells in a column with strings and generate it in another column?", "body": "<p>or you could use this</p>\n\n<pre><code>Sub Concatenator()   \n    Range(\"A1\", Cells(Rows.count, 1).End(xlUp)).SpecialCells(xlCellTypeConstants, xlTextValues).Offset(, 1).Formula = \"=concatenate(\"\"'\"\",RC[-1],\"\"'\"\")\"    \nEnd Sub\n</code></pre>\n\n<p>or this:</p>\n\n<pre><code>Sub Concatenator()\n    With Range(\"A1\", Cells(Rows.count, 1).End(xlUp))\n        .Offset(, 1).Value = Application.Transpose(Split(Replace(\"'\" &amp; Join(Application.Transpose(.Value), \"'|''\") &amp; \"'\", \"'''\", \"''\"), \"|\"))\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 3187773, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac76c423905905d02ffc055867fce348?s=128&d=identicon&r=PG&f=1", "display_name": "LSX", "link": "https://stackoverflow.com/users/3187773/lsx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2898, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1485415280, "creation_date": 1485384989, "last_edit_date": 1485409873, "question_id": 41863221, "link": "https://stackoverflow.com/questions/41863221/vba-how-to-concatenate-range-of-cells-in-a-column-with-strings-and-generate-it", "title": "VBA: How to concatenate range of cells in a column with strings and generate it in another column?", "body": "<p>I just can't work around this particular problem of mine where I have to concatenate all cells with data to a string, (e.g. \" or ') in one column and then generate that concatenated result in another column.</p>\n\n<p>Expected result:</p>\n\n<pre><code>Column A = ABCD\nColumn B = 'ABCD',\n</code></pre>\n\n<p><strong>My Code</strong></p>\n\n<pre><code>Option Explicit\n\nSub Concatenator ()\n\n    Columns(\"B\") = \"'\" &amp; Range(Range(\"A1\"), Range(\"A1\").End(xlDown)) &amp; \"',\"\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "reporting-services", "ssrs-2012", "sql-server-data-tools", "ssdt-bi"], "comments": [{"owner": {"reputation": 4171, "user_id": 2333593, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bbaef5354ed4a50d7c5d78f008956484?s=128&d=identicon&r=PG", "display_name": "Peter Schott", "link": "https://stackoverflow.com/users/2333593/peter-schott"}, "edited": false, "score": 1, "creation_date": 1485404883, "post_id": 41863170, "comment_id": 70916207, "body": "Does it have to be split in the SSRS code? Could it be a parameter to the TSQL and you use a string splitting or delimited string to table type function to use the values there? That&#39;s what we did with a lot of our CSV variables - just passed them into a varchar(max) and passed through to SQL to parse out."}, {"owner": {"reputation": 8653, "user_id": 803019, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b856f939f6a128a1353942ab7901ebce?s=128&d=identicon&r=PG", "display_name": "niktrs", "link": "https://stackoverflow.com/users/803019/niktrs"}, "edited": false, "score": 0, "creation_date": 1485413313, "post_id": 41863170, "comment_id": 70918390, "body": "Can you provide a screenshot how the report would be rendered if it worked?"}, {"owner": {"reputation": 51, "user_id": 6780741, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/8c5115036f9544d51033bda6983b5d56?s=128&d=identicon&r=PG&f=1", "display_name": "user6780741", "link": "https://stackoverflow.com/users/6780741/user6780741"}, "reply_to_user": {"reputation": 4171, "user_id": 2333593, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bbaef5354ed4a50d7c5d78f008956484?s=128&d=identicon&r=PG", "display_name": "Peter Schott", "link": "https://stackoverflow.com/users/2333593/peter-schott"}, "edited": false, "score": 1, "creation_date": 1485450273, "post_id": 41863170, "comment_id": 70939872, "body": "@Peter Schott - your recommendation worked as my actual solution. It handles the variable entry by users perfectly. Thank you!"}], "answers": [{"comments": [{"owner": {"reputation": 51, "user_id": 6780741, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/8c5115036f9544d51033bda6983b5d56?s=128&d=identicon&r=PG&f=1", "display_name": "user6780741", "link": "https://stackoverflow.com/users/6780741/user6780741"}, "edited": false, "score": 0, "creation_date": 1485385224, "post_id": 41863218, "comment_id": 70910254, "body": "Gotcha, What if the number of ID&#39;s passed is variable though? I passed 2 as an example but the number will vary."}], "tags": [], "owner": {"reputation": 391, "user_id": 2117421, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FYQT2.jpg?s=128&g=1", "display_name": "singhsac", "link": "https://stackoverflow.com/users/2117421/singhsac"}, "is_accepted": false, "score": 3, "last_activity_date": 1485384975, "creation_date": 1485384975, "answer_id": 41863218, "question_id": 41863170, "link": "https://stackoverflow.com/questions/41863170/how-do-i-split-an-ssrs-text-value-by-comma/41863218#41863218", "title": "How do I split an ssrs text value by comma?", "body": "<p>Split function returns an array and you can select item by its index</p>\n\n<p>First value would be\n<code>=Split(Parameters!CustomerID_EnrollerList.Value,\",\")(0)</code></p>\n\n<p>And Second value would be\n<code>=Split(Parameters!CustomerID_EnrollerList.Value,\",\")(1)</code></p>\n"}], "owner": {"reputation": 51, "user_id": 6780741, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/8c5115036f9544d51033bda6983b5d56?s=128&d=identicon&r=PG&f=1", "display_name": "user6780741", "link": "https://stackoverflow.com/users/6780741/user6780741"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1794, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1485384975, "creation_date": 1485384731, "question_id": 41863170, "link": "https://stackoverflow.com/questions/41863170/how-do-i-split-an-ssrs-text-value-by-comma", "title": "How do I split an ssrs text value by comma?", "body": "<p>I have an SSRS report that takes a parameter called Customer ID Enroller List. Its datatype in SSMS is varchar(max) and its datatype in SSDT/SSRS is listed as text. </p>\n\n<p>As an example, the user may pass in 2 customerID's like the following: </p>\n\n<pre><code>2110012639,2110179997\n</code></pre>\n\n<p>I'd like to create document map based the passed parameters but I need to split the values first. I've tried using the following code: </p>\n\n<pre><code>=Split(Parameters!CustomerID_EnrollerList.Value,\",\") \n</code></pre>\n\n<p>My report runs but the value returned in the textbox is #Error. Any ideas on how to split a text datatype parameter by a comma delimiter? </p>\n"}, {"tags": ["vba", "excel", "pivot-table"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1485385658, "post_id": 41862748, "comment_id": 70910410, "body": "What line does the error occur on? Where&#39;s the start of the macro?"}, {"owner": {"reputation": 1, "user_id": 6707353, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/8f2f3c0edc84474e9e5b3acaa26f9e00?s=128&d=identicon&r=PG&f=1", "display_name": "J.Woe", "link": "https://stackoverflow.com/users/6707353/j-woe"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1485389636, "post_id": 41862748, "comment_id": 70911585, "body": "Hi BruceWayne, the error starts in the first section of code, which is also where the macro begins. I recorded this macro and attempted to implement the record in my data. It gives me that error."}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1485865283, "post_id": 41862748, "comment_id": 71093507, "body": "@J.Woe have you tested the code in my answer below ? is it working for you like you intended ?"}, {"owner": {"reputation": 1, "user_id": 6707353, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/8f2f3c0edc84474e9e5b3acaa26f9e00?s=128&d=identicon&r=PG&f=1", "display_name": "J.Woe", "link": "https://stackoverflow.com/users/6707353/j-woe"}, "edited": false, "score": 0, "creation_date": 1485889403, "post_id": 41862748, "comment_id": 71109814, "body": "Hi Shai Rado, I really appreciate the follow up. I implemented your code, but it gave an error of &#39;Variable not defined&#39; while highlighting &#39;shtReport.&#39;. I tried fixing it and came up with this line of code, edited in the original post for your oversight. It now gives me an &#39;Object variable or With block variable not set&#39; error. Thanks again, your thoroughness is appreciated."}], "answers": [{"tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": false, "score": 0, "last_activity_date": 1485411855, "creation_date": 1485411855, "answer_id": 41867900, "question_id": 41862748, "link": "https://stackoverflow.com/questions/41862748/pivot-table-vba-error-from-recorded-macro/41867900#41867900", "title": "Pivot Table VBA Error from Recorded Macro", "body": "<p>The code below will get you started on automating the creation and updating of <code>PivotTables</code> in VBA:</p>\n\n<pre><code>Option Explicit\n\nSub SutoPivot()\n\nDim PvtTbl                          As PivotTable\nDim PvtCache                        As PivotCache\n\n' set the Pivot Cache  (NOT SURE what is \"TableX\" ?)\nSet PvtCache = ActiveWorkbook.PivotCaches.Create(SourceType:=xlDatabase, SourceData:=\"TableX\", Version:=xlPivotTableVersion14)\n\n' add this line in case the Pivot table doesn't exit &gt;&gt; first time running this Macro\nOn Error Resume Next\nSet PvtTbl = Worksheets(\"Invoice Data\").PivotTables(\"PivotTable1a\")\n\nOn Error GoTo 0\nIf PvtTbl Is Nothing Then\n    ' create a new Pivot Table in \"Invoice Data\" sheet, start from Cell Y1\n    Set PvtTbl = shtReport.PivotTables.Add(PivotCache:=PvtCache, TableDestination:=Worksheets(\"Invoice Data\").Range(\"Y1\"), TableName:=\"PivotTable1a\")\n\n    With PvtTbl.PivotFields(\"Director\")\n        .Orientation = xlRowField\n        .Position = 1\n    End With\n\n    With PvtTbl.PivotFields(\"Manager\")\n        .Orientation = xlRowField\n        .Position = 2\n    End With\n\n    With PvtTbl.PivotFields(\"Owner\")\n        .Orientation = xlRowField\n        .Position = 3\n    End With\n\n    With PvtTbl.PivotFields(\"Account Name\")\n        .Orientation = xlRowField\n        .Position = 4\n    End With\n\n    With PvtTbl.PivotFields(\"Business Name\")\n        .Orientation = xlRowField\n        .Position = 5\n    End With\n\n    PvtTbl.AddDataField PvtTbl.PivotFields(\"Annual Aggregate Volume\"), _\n        \"Sum of Annual Aggregate Volume\", xlSum\n\n    With PvtTbl.PivotFields(\"Sum of Annual Aggregate Volume\")\n        .NumberFormat = \"#,##0\"\n    End With\n\nElse\n    ' just refresh the Pivot cache with the updated Range  \n    PvtTbl.ChangePivotCache PvtCache\n    PvtTbl.RefreshTable\nEnd If\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 6707353, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/8f2f3c0edc84474e9e5b3acaa26f9e00?s=128&d=identicon&r=PG&f=1", "display_name": "J.Woe", "link": "https://stackoverflow.com/users/6707353/j-woe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1108, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1485889899, "creation_date": 1485382928, "last_edit_date": 1485889899, "question_id": 41862748, "link": "https://stackoverflow.com/questions/41862748/pivot-table-vba-error-from-recorded-macro", "title": "Pivot Table VBA Error from Recorded Macro", "body": "<p>Below is my update to the code. TableX is the referenced table that my pivot tables will use. After declaring the 'shtReport' variable as a Worksheet and further naming the variable, the error 'Object variable or With block variable not set' occurs.  </p>\n\n<pre><code>Option Explicit\n\n    Sub SutoPivot()\n\n    Dim PvtTbl                          As PivotTable\n    Dim PvtCache                        As PivotCache\n    Dim shtReport                       As Worksheet\n\n    ' set the Pivot Cache  (NOT SURE what is \"TableX\" ?)\n    Set PvtCache = ActiveWorkbook.PivotCaches.Create(SourceType:=xlDatabase, SourceData:=\"TableX\", Version:=xlPivotTableVersion14)\n    Set shtReport = Worksheets(\"Invoice Data\")\n\n    ' add this line in case the Pivot table doesn't exit &gt;&gt; first time running this Macro\n    On Error Resume Next\n    Set PvtTbl = Worksheets(\"Invoice Data\").PivotTables(\"PivotTable1a\")\n\n    On Error GoTo 0\n    If PvtTbl Is Nothing Then\n        ' create a new Pivot Table in \"Invoice Data\" sheet, start from Cell Y1\n        Set PvtTbl = shtReport.PivotTables.Add(PivotCache:=PvtCache, TableDestination:=Worksheets(\"Invoice Data\").Range(\"Y1\"), _ TableName:=\"PivotTable1a\")\n\n        With PvtTbl.PivotFields(\"Sales Director\")\n            .Orientation = xlRowField\n            .Position = 1\n        End With\n\n        With PvtTbl.PivotFields(\"Manager\")\n            .Orientation = xlRowField\n            .Position = 2\n        End With\n\n        With PvtTbl.PivotFields(\"Owner\")\n            .Orientation = xlRowField\n            .Position = 3\n        End With\n\n        With PvtTbl.PivotFields(\"Account Name\")\n            .Orientation = xlRowField\n            .Position = 4\n        End With\n\n        With PvtTbl.PivotFields(\"Business Name\")\n            .Orientation = xlRowField\n            .Position = 5\n        End With\n\n        With PvtTbl.PivotFields(\"Annual Aggregate Volume\")\n            .Orientation = xlValuesField\n            .Position = 1\n        End With\n\n        PvtTbl.AddDataField PvtTbl.PivotFields(\"Annual Aggregate Volume\"),\n            \"Sum of Annual Aggregate Volume\", xlSum\n\n        With PvtTbl.PivotFields(\"Sum of Annual Aggregate Volume\")\n            .NumberFormat = \"#,##0\"\n        End With\n\n    Else\n        ' just refresh the Pivot cache with the updated Range\n        PvtTbl.ChangePivotCache PvtCache\n        PvtTbl.RefreshTable\n    End If\n\n    End Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-access"], "comments": [{"owner": {"reputation": 273, "user_id": 6490191, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/892b65d788a19cd018c74394494fc302?s=128&d=identicon&r=PG&f=1", "display_name": "Steve W", "link": "https://stackoverflow.com/users/6490191/steve-w"}, "edited": false, "score": 0, "creation_date": 1485383255, "post_id": 41862735, "comment_id": 70909421, "body": "Your count will never be a negative number.  Swap your operator to &quot;&gt;&quot;"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1485383283, "post_id": 41862735, "comment_id": 70909437, "body": "<code>&quot;SELECT count(*) FROM ReassignedLoans&quot;</code> is a <code>String</code> and <code>0</code> is an <code>Integer</code>.  You need to actually <b><i>run</i></b> the query."}, {"owner": {"reputation": 273, "user_id": 6490191, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/892b65d788a19cd018c74394494fc302?s=128&d=identicon&r=PG&f=1", "display_name": "Steve W", "link": "https://stackoverflow.com/users/6490191/steve-w"}, "edited": false, "score": 1, "creation_date": 1485383496, "post_id": 41862735, "comment_id": 70909542, "body": "Wow, it must be getting late in the day... missed that completely.  Use DCount"}, {"owner": {"reputation": 25, "user_id": 7460230, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0JPcH.jpg?s=128&g=1", "display_name": "ClarissaHD", "link": "https://stackoverflow.com/users/7460230/clarissahd"}, "edited": false, "score": 0, "creation_date": 1485383703, "post_id": 41862735, "comment_id": 70909639, "body": "Thanks Steve, yeah i had it backwards (they always trip me up) but regardless of the direction, it gave me type mismatch."}], "answers": [{"tags": [], "owner": {"reputation": 273, "user_id": 6490191, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/892b65d788a19cd018c74394494fc302?s=128&d=identicon&r=PG&f=1", "display_name": "Steve W", "link": "https://stackoverflow.com/users/6490191/steve-w"}, "is_accepted": true, "score": 1, "last_activity_date": 1485383325, "creation_date": 1485383325, "answer_id": 41862843, "question_id": 41862735, "link": "https://stackoverflow.com/questions/41862735/skipping-a-docmd-line-with-an-if-statement/41862843#41862843", "title": "Skipping a Docmd line with an if statement", "body": "<pre><code>If DCOUNT(\"someField\",\"ReassignedLoans\") &gt; 0 Then\n DoCmd.OpenQuery \"IDReassignedLoansUpdate\"\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 7460230, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0JPcH.jpg?s=128&g=1", "display_name": "ClarissaHD", "link": "https://stackoverflow.com/users/7460230/clarissahd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 18, "favorite_count": 0, "accepted_answer_id": 41862843, "answer_count": 1, "score": 0, "last_activity_date": 1593956789, "creation_date": 1485382840, "last_edit_date": 1593956789, "question_id": 41862735, "link": "https://stackoverflow.com/questions/41862735/skipping-a-docmd-line-with-an-if-statement", "title": "Skipping a Docmd line with an if statement", "body": "<p>I have searched and searched and found nothing that's helping me on this one.</p>\n\n<p>I have a table (ReassignedLoans) that is usually blank, so I want to skip the query being run, unless the table isn't blank. I'm fairly confident that an If..then is what i want, but the query is giving me a \"type mismatch\" error.</p>\n\n<p>what am i missing?</p>\n\n<pre><code>If \"SELECT count(*) FROM ReassignedLoans\" &lt; 0 Then\n DoCmd.OpenQuery \"IDReassignedLoansUpdate\"\nEnd If\n</code></pre>\n\n<p>Thank you all for your help</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 1, "creation_date": 1485381816, "post_id": 41862293, "comment_id": 70908733, "body": "you don&#39;t even need to set the range and go: <code>Range(&quot;A2&quot;, Range(&quot;A2&quot;).End(xlDown).Offset(1)).Copy</code>"}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": false, "score": 3, "last_activity_date": 1485381030, "creation_date": 1485381030, "answer_id": 41862293, "question_id": 41862260, "link": "https://stackoverflow.com/questions/41862260/excel-vba-can-i-simply-extend-a-range-by-one/41862293#41862293", "title": "Excel VBA: Can I simply extend a range by one?", "body": "<p>Yes:</p>\n\n<pre><code>Set twoRange = Range(\"A2\", Range(\"A2\").End(xlDown).Offset(1))\ntwoRange.Copy\n</code></pre>\n\n<p>You use Offset to move one more cell down.  Offset uses this format: `Offset(Rows,[columns])</p>\n\n<p>You also do not need to select the range to copy the range.</p>\n"}, {"tags": [], "owner": {"reputation": 4621, "user_id": 1939638, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vu1kQ.jpg?s=128&g=1", "display_name": "Matt Cremeens", "link": "https://stackoverflow.com/users/1939638/matt-cremeens"}, "is_accepted": false, "score": 0, "last_activity_date": 1485381102, "creation_date": 1485381102, "answer_id": 41862311, "question_id": 41862260, "link": "https://stackoverflow.com/questions/41862260/excel-vba-can-i-simply-extend-a-range-by-one/41862311#41862311", "title": "Excel VBA: Can I simply extend a range by one?", "body": "<p>You can do</p>\n\n<pre><code>Set twoRange = Range(\"A2:A\" &amp; Range(\"A2\").End(xlDown).Row + 1)\n</code></pre>\n\n<p>which adds one to the row found by using the <code>xlDown</code> approach.</p>\n"}], "owner": {"reputation": 189, "user_id": 1319469, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/c83fb4134167a11422c23048fb8a85e3?s=128&d=identicon&r=PG", "display_name": "gctwnl", "link": "https://stackoverflow.com/users/1319469/gctwnl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 855, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1485381102, "creation_date": 1485380940, "question_id": 41862260, "link": "https://stackoverflow.com/questions/41862260/excel-vba-can-i-simply-extend-a-range-by-one", "title": "Excel VBA: Can I simply extend a range by one?", "body": "<p>I have a statement in VBA to create a Range, which then is selected and copied. After that I paste that somewhere else. But the last line is pasted without a newline, so I'd like to extend my range by one. My current statement is:</p>\n\n<pre><code>Set twoRange = Range(\"A2\", Range(\"A2\").End(xlDown))\ntwoRange.Select\ntwoRange.Copy\n</code></pre>\n\n<p>What is the simplest way to extend this range one row down?</p>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 4621, "user_id": 1939638, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vu1kQ.jpg?s=128&g=1", "display_name": "Matt Cremeens", "link": "https://stackoverflow.com/users/1939638/matt-cremeens"}, "edited": false, "score": 1, "creation_date": 1485380100, "post_id": 41862047, "comment_id": 70907878, "body": "What row in A do you want to copy?"}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 1, "creation_date": 1485380133, "post_id": 41862047, "comment_id": 70907897, "body": "what is <code>Set Y = Workbooks.Open(&quot;insert filepath&quot;)</code> doing? Do you have a workbook named &quot;insert filepath&quot;? and what&#39;s the error description?"}, {"owner": {"reputation": 1, "user_id": 6746074, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/173df5873a022c7fe29ca254e6088a45?s=128&d=identicon&r=PG&f=1", "display_name": "Eric C", "link": "https://stackoverflow.com/users/6746074/eric-c"}, "edited": false, "score": 0, "creation_date": 1485435391, "post_id": 41862047, "comment_id": 70929374, "body": "I want the entire column. Would I need to adjust the code to A:A? I removed the file path for the post. The file opens effortlessly. The issue is when attempting to move the data between the two files. It prompts for a debug at the X.Sheets(&quot;Temp&quot;) portion."}], "answers": [{"tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 0, "last_activity_date": 1485380375, "creation_date": 1485380375, "answer_id": 41862131, "question_id": 41862047, "link": "https://stackoverflow.com/questions/41862047/vba-code-error-out-at-copy-paste-portion/41862131#41862131", "title": "VBA - Code Error Out at Copy/Paste Portion", "body": "<p>Try these:</p>\n\n<pre><code>X.Sheets(\"TEMP\").Range(\"A3\").Copy Destination:=Y.Sheets(\"Text Template\").Range(\"D3\")\nX.Sheets(\"TEMP\").Range(\"R3\").Copy Destination:=Y.Sheets(\"Text Template\").Range(\"F3\")\nX.Sheets(\"TEMP\").Range(\"AU3\").Copy Destination:=Y.Sheets(\"Text Template\").Range(\"B3\")\n</code></pre>\n\n<p>Here you can read more for the range object:\n<a href=\"https://msdn.microsoft.com/en-us/library/office/ff838238.aspx?f=255&amp;MSPPError=-2147217396\" rel=\"nofollow noreferrer\">https://msdn.microsoft.com/en-us/library/office/ff838238.aspx?f=255&amp;MSPPError=-2147217396</a></p>\n\n<p>If you want to copy only the columns, use like this:</p>\n\n<pre><code>Columns(\"A:A\").Copy\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 6746074, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/173df5873a022c7fe29ca254e6088a45?s=128&d=identicon&r=PG&f=1", "display_name": "Eric C", "link": "https://stackoverflow.com/users/6746074/eric-c"}, "edited": false, "score": 0, "creation_date": 1485438464, "post_id": 41862136, "comment_id": 70931423, "body": "Thank you the With statement resolved the error. I appreciate the support."}], "tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": false, "score": 0, "last_activity_date": 1485380388, "creation_date": 1485380388, "answer_id": 41862136, "question_id": 41862047, "link": "https://stackoverflow.com/questions/41862047/vba-code-error-out-at-copy-paste-portion/41862136#41862136", "title": "VBA - Code Error Out at Copy/Paste Portion", "body": "<p>supposing the code down to <code>Set Y = Workbooks.Open(\"insert filepath\")\n</code> runs smothlessly, then substitute:</p>\n\n<pre><code>X.Sheets(\"TEMP\").Range(\"A\").Copy Destination:=Y.Sheets(\"Text Template\").Range(\"D3\")\nX.Sheets(\"TEMP\").Range(\"R\").Copy Destination:=Y.Sheets(\"Text Template\").Range(\"F3\")\nX.Sheets(\"TEMP\").Range(\"AU\").Copy Destination:=Y.Sheets(\"Text Template\").Range(\"B3\")\n</code></pre>\n\n<p>with:</p>\n\n<pre><code>With X.Sheets(\"TEMP\")\n    .Range(\"A1\", .Cells(.Rows.Count, \"A\").End(xlUp)).Copy Destination:=Y.Sheets(\"Text Template\").Range(\"D3\")\n    .Range(\"R1\", .Cells(.Rows.Count, \"R\").End(xlUp)).Copy Destination:=Y.Sheets(\"Text Template\").Range(\"F3\")\n    .Range(\"AU1\", .Cells(.Rows.Count, \"AU\").End(xlUp)).Copy Destination:=Y.Sheets(\"Text Template\").Range(\"B3\")\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 6746074, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/173df5873a022c7fe29ca254e6088a45?s=128&d=identicon&r=PG&f=1", "display_name": "Eric C", "link": "https://stackoverflow.com/users/6746074/eric-c"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 27, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1485380388, "creation_date": 1485379986, "last_edit_date": 1485380047, "question_id": 41862047, "link": "https://stackoverflow.com/questions/41862047/vba-code-error-out-at-copy-paste-portion", "title": "VBA - Code Error Out at Copy/Paste Portion", "body": "<p>All,</p>\n\n<p>The code is erring out at this portion <code>X.Sheets(\"TEMP\").Range(\"A\").Copy Destination:=Y.Sheets(\"Text Template\").Range(\"D3\")</code>. Can you advise how this can be resolved? My goal is to take the active sheet and migrate data to an existing saved workbook. The active workbook is different daily so routing it though the file path is not the most supportive option. </p>\n\n<p>Any advice is greatly appreciated. </p>\n\n<pre><code>Sub Datamove()\n    '\n    Worksheets.Add().Name = \"TEMP\"\n    Sheets(\"MCI\").Select\n    Cells.Select\n    Selection.Copy\n    Sheets(\"TEMP\").Select\n    Sheets(\"TEMP\").Paste\n\n  ActiveSheet.Range(\"$A$1:$AH$799\").AutoFilter Field:=2, Criteria1:=Array( _\n        \"MC1A\", \"MC1B\", \"MC1C\", \"MC1D\", \"MC1E\", \"MC1F\", \"MC1G\", \"MC1H\", \"MC1J\", \"MC1K\", \"MC1L\", _\n        \"MC1M\", \"MC1N\", \"MC1P\", \"MC1Q\", \"MC1R\", \"MC2A\", \"MC2B\", \"MC2C\", \"MC2D\", \"MC2E\", \"MC3A\", _\n        \"MC3C\"), Operator:=xlFilterValues\n    ActiveSheet.Range(\"$A$1:$AH$799\").AutoFilter Field:=4, Criteria1:= _\n        \"Residential\"\n    ActiveSheet.Range(\"$A$1:$AH$799\").AutoFilter Field:=5, Criteria1:=\"=\"\n\n\nDim X As Workbook\nDim Y As Workbook\n\nSet X = ActiveWorkbook\nSet Y = Workbooks.Open(\"insert filepath\")\n\nX.Sheets(\"TEMP\").Range(\"A\").Copy Destination:=Y.Sheets(\"Text Template\").Range(\"D3\")\nX.Sheets(\"TEMP\").Range(\"R\").Copy Destination:=Y.Sheets(\"Text Template\").Range(\"F3\")\nX.Sheets(\"TEMP\").Range(\"AU\").Copy Destination:=Y.Sheets(\"Text Template\").Range(\"B3\")\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "object", "qualifiers"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1485380582, "post_id": 41862027, "comment_id": 70908104, "body": "Was the migration to SharePoint also accompanied by a migration to Office 365?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1485381011, "post_id": 41862027, "comment_id": 70908335, "body": "How did you figure out qualifying <code>ThisWorkbook</code> would fix it?"}, {"owner": {"reputation": 51, "user_id": 6487595, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1cc68c62b441be4298d1df6c32ad3ffa?s=128&d=identicon&r=PG", "display_name": "Jeffrey Knight", "link": "https://stackoverflow.com/users/6487595/jeffrey-knight"}, "edited": false, "score": 0, "creation_date": 1485461392, "post_id": 41862027, "comment_id": 70946323, "body": "Thanks guys -  Yes, the migration to SharePoint (actually OneDrive) was done with the migration to Office 365.   I have since tried this with a version of the spreadsheet that was simply on our network drive (NOT SharePoint) and compared it with one that WAS on SharePoint. The SharePoint code gave the error (when &quot;Excel.&quot; is removed) but the file from the network drive did not give the error. It may not have to do with location, but SharePoint seems to be a culprit."}, {"owner": {"reputation": 51, "user_id": 6487595, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1cc68c62b441be4298d1df6c32ad3ffa?s=128&d=identicon&r=PG", "display_name": "Jeffrey Knight", "link": "https://stackoverflow.com/users/6487595/jeffrey-knight"}, "edited": false, "score": 0, "creation_date": 1485972598, "post_id": 41862027, "comment_id": 71151083, "body": "BEST GUESS and giving up: This seems to be specific to my user/profile. Others in the building are using the file with no trouble."}], "answers": [{"comments": [{"owner": {"reputation": 51, "user_id": 6487595, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1cc68c62b441be4298d1df6c32ad3ffa?s=128&d=identicon&r=PG", "display_name": "Jeffrey Knight", "link": "https://stackoverflow.com/users/6487595/jeffrey-knight"}, "edited": false, "score": 1, "creation_date": 1485460343, "post_id": 41862222, "comment_id": 70945787, "body": "Thanks a bunch. I tried your test (in the immediate window after the error occurs in break mode). The &quot;ThisWorkbook&quot; generates the same error it did before (Automation error - catastrophic failure&quot; -2147418113 , fwiw). The other two - prefaced with either &quot;Excel.&quot; or &quot;Application.&quot; work fine."}], "tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": false, "score": 2, "last_activity_date": 1485380784, "creation_date": 1485380784, "answer_id": 41862222, "question_id": 41862027, "link": "https://stackoverflow.com/questions/41862027/difference-between-excel-thisworkbook-and-just-thisworkbook/41862222#41862222", "title": "Difference between Excel.ThisWorkbook and just ThisWorkbook?", "body": "<p><code>ThisWorkbook</code> is a global-scope <code>Workbook</code> object that you can use to refer to the workbook instance that contains the very VBA code that you're looking at.</p>\n\n<p>So <em>in theory</em>, an unqualified <code>ThisWorkbook</code> is <strong>exactly</strong> the same object as <code>Excel.ThisWorkbook</code> or <code>Application.ThisWorkbook</code>.</p>\n\n<p>Proof:</p>\n\n<pre><code>Sub Test()\n    Debug.Print ObjPtr(ThisWorkbook), _\n                ObjPtr(Excel.ThisWorkbook), _\n                ObjPtr(Application.ThisWorkbook)\nEnd Sub\n</code></pre>\n\n<p>Outputs 3 times the same pointer address.</p>\n\n<p><code>Excel.ThisWorkbook</code> is a member (<code>Property Get</code>) of the hidden <code>Excel._Global</code> module, and <code>Application.ThisWorkbook</code> is a member (<code>Property Get</code>) of the <code>Excel.Application</code> class.</p>\n\n<p>Not sure what's up with your file, but there's not <em>supposed</em> to be <em>any</em> difference between the two.</p>\n"}, {"comments": [{"owner": {"reputation": 51, "user_id": 6487595, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1cc68c62b441be4298d1df6c32ad3ffa?s=128&d=identicon&r=PG", "display_name": "Jeffrey Knight", "link": "https://stackoverflow.com/users/6487595/jeffrey-knight"}, "edited": false, "score": 0, "creation_date": 1485460110, "post_id": 41863122, "comment_id": 70945654, "body": "Thanks for that. I tried removing the Excel. and got the same error again (&quot;Automation error - catastrophic failure&quot;  -2147418113 , fwiw). I&#39;m also getting the problem at work now so location doesn&#39;t seem to enter into it."}, {"owner": {"reputation": 51, "user_id": 6487595, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1cc68c62b441be4298d1df6c32ad3ffa?s=128&d=identicon&r=PG", "display_name": "Jeffrey Knight", "link": "https://stackoverflow.com/users/6487595/jeffrey-knight"}, "edited": false, "score": 0, "creation_date": 1485465063, "post_id": 41863122, "comment_id": 70948328, "body": "UPDATE: I just found that the problem goes away altogether when I move the workbook containing the code to our local network drive (not SharePoint) so the culprit seems to be SharePoint in some fashion or another."}], "tags": [], "owner": {"reputation": 8811, "user_id": 5757159, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/yxD51.png?s=128&g=1", "display_name": "ThunderFrame", "link": "https://stackoverflow.com/users/5757159/thunderframe"}, "is_accepted": false, "score": 5, "last_activity_date": 1485384499, "creation_date": 1485384499, "answer_id": 41863122, "question_id": 41862027, "link": "https://stackoverflow.com/questions/41862027/difference-between-excel-thisworkbook-and-just-thisworkbook/41863122#41863122", "title": "Difference between Excel.ThisWorkbook and just ThisWorkbook?", "body": "<p><strong>Does it work if you change it <em>back</em> to <code>ThisWorkbook</code>?</strong></p>\n\n<p>I suspect it will, and the reason would be because the VBA recompiled itself (and didn't compile properly the first time - hence the propensity to crash).</p>\n\n<p>Recompilation occurs when the version details embedded in the file differ from the version of Office/VBA in use, or there's a change from 32 to 64 bit Office. Editing the line is enough to recompile the line, so adding <code>Excel.</code> before <code>ThisWorkbook</code> was enough to make it recompile. Removing <code>Excel.</code> before <code>ThisWorkbook</code> should force it to recompile again.</p>\n\n<p>The only other thing it might be is if there's a variable named <code>ThisWorkbook</code>, but then I'd expect you to get error 91, \"Object variable or With block variable not set\", or some other error, but not a crash.</p>\n"}, {"tags": [], "owner": {"reputation": 51, "user_id": 6487595, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1cc68c62b441be4298d1df6c32ad3ffa?s=128&d=identicon&r=PG", "display_name": "Jeffrey Knight", "link": "https://stackoverflow.com/users/6487595/jeffrey-knight"}, "is_accepted": false, "score": 0, "last_activity_date": 1485972733, "creation_date": 1485972733, "answer_id": 41986756, "question_id": 41862027, "link": "https://stackoverflow.com/questions/41862027/difference-between-excel-thisworkbook-and-just-thisworkbook/41986756#41986756", "title": "Difference between Excel.ThisWorkbook and just ThisWorkbook?", "body": "<p>This appears to be a bug in my particular user/profile. Others are now using the code/workbook with no reports of trouble. Yay!!?</p>\n"}], "owner": {"reputation": 51, "user_id": 6487595, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1cc68c62b441be4298d1df6c32ad3ffa?s=128&d=identicon&r=PG", "display_name": "Jeffrey Knight", "link": "https://stackoverflow.com/users/6487595/jeffrey-knight"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 470, "favorite_count": 0, "answer_count": 3, "score": 3, "last_activity_date": 1528276413, "creation_date": 1485379896, "question_id": 41862027, "link": "https://stackoverflow.com/questions/41862027/difference-between-excel-thisworkbook-and-just-thisworkbook", "title": "Difference between Excel.ThisWorkbook and just ThisWorkbook?", "body": "<p>I have some VBA code that ran fine in Excel at my desk at work but at home it's crashtastic. Turns out all I had to do was change</p>\n\n<pre><code>Set shtObj = ThisWorkbook.Sheets(1)\n</code></pre>\n\n<p>to</p>\n\n<pre><code>Set shtObj = Excel.ThisWorkbook.Sheets(1)\n</code></pre>\n\n<p>Anyone know why? Our organization has just moved to a SharePoint platform, which I suspect is causing all manner of voodoo to creep up, but I'm just guessing.</p>\n"}, {"tags": ["vba", "office365", "powerpoint"], "comments": [{"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1485380789, "post_id": 41861758, "comment_id": 70908205, "body": "What do you mean by <i>&quot;it opens the files 4 times per link&quot;</i>? <i>it</i> the macro? files the ppt files?"}, {"owner": {"reputation": 303, "user_id": 7471141, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/22babd4c799029e887d50c12e1a8fa86?s=128&d=identicon&r=PG&f=1", "display_name": "shorton", "link": "https://stackoverflow.com/users/7471141/shorton"}, "reply_to_user": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1485382023, "post_id": 41861758, "comment_id": 70908831, "body": "I mean for the single link in the file, when I run that code, as soon as it hits the line that changes the sourcefullname, I see it open an excel file 4 times.  I have a bandwidth monitor running and I can see it there, each download (the source and target files are on a network share), and in excel which is open with an unrelated file, I get 4 popup dialogs that say &quot;downloading file...&quot;  As the number of links to change goes up, the file opens go up accordingly.  Edit:  Each set of file open&#39;s is associated with a single iteration of the innermost loop and happen when that line is executed"}, {"owner": {"reputation": 303, "user_id": 7471141, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/22babd4c799029e887d50c12e1a8fa86?s=128&d=identicon&r=PG&f=1", "display_name": "shorton", "link": "https://stackoverflow.com/users/7471141/shorton"}, "reply_to_user": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1485382209, "post_id": 41861758, "comment_id": 70908911, "body": "Note there is a single link in my test file.  The real file has hundreds."}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1485383833, "post_id": 41861758, "comment_id": 70909696, "body": "So basically you&#39;re looking for a way to change those hyperlinks in offline mode."}, {"owner": {"reputation": 303, "user_id": 7471141, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/22babd4c799029e887d50c12e1a8fa86?s=128&d=identicon&r=PG&f=1", "display_name": "shorton", "link": "https://stackoverflow.com/users/7471141/shorton"}, "reply_to_user": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1485468485, "post_id": 41861758, "comment_id": 70950120, "body": "re offline mode, I don&#39;t know.  I&#39;m online, network fully on, so I don&#39;t understand why it would be offline.  Maybe I misundrstood what you meant.  I just want to change the links (path and or filename) with a script and I don&#39;t want it to have to download a file 4 times for every link in the PPT.  Which is what it&#39;s doing now.  Office 2016 seems to have killed it."}, {"owner": {"reputation": 303, "user_id": 7471141, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/22babd4c799029e887d50c12e1a8fa86?s=128&d=identicon&r=PG&f=1", "display_name": "shorton", "link": "https://stackoverflow.com/users/7471141/shorton"}, "reply_to_user": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1485468638, "post_id": 41861758, "comment_id": 70950184, "body": "Right now, even if the PPT is linked to say 3 charts in a particular single  excel file, the script above will cause a file to be downloaded a total of 12 times, 4 times for each link/chart.  I presume those 4 times (have no simple way I see to verify) is it downloading the source and the target files 2 times each (net 4)."}, {"owner": {"reputation": 303, "user_id": 7471141, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/22babd4c799029e887d50c12e1a8fa86?s=128&d=identicon&r=PG&f=1", "display_name": "shorton", "link": "https://stackoverflow.com/users/7471141/shorton"}, "reply_to_user": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1485478333, "post_id": 41861758, "comment_id": 70953391, "body": "Edited original post for better formatting and clarity."}], "owner": {"reputation": 303, "user_id": 7471141, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/22babd4c799029e887d50c12e1a8fa86?s=128&d=identicon&r=PG&f=1", "display_name": "shorton", "link": "https://stackoverflow.com/users/7471141/shorton"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 373, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1485478861, "creation_date": 1485378749, "last_edit_date": 1485478861, "question_id": 41861758, "link": "https://stackoverflow.com/questions/41861758/office-2016-365-vba-fails-to-update-ppt-links-from-old-script", "title": "Office 2016/365 VBA fails to update PPT links from old script", "body": "<p>I have a need to change lists of links in large PPT presentations.  I had working code that did it fine.  Recently I upgraded to Office 2016 and now the script is not working correctly.</p>\n\n<p>I simple put my old and new path strings in a 2 dimensional array and loop through them correcting the links in the PPT.</p>\n\n<p>This has some debug code in it, and come commented lines where I was trying things to fix it, please ignore.</p>\n\n<pre><code>For j = 0 To UBound(MyArray)\n\n  oldString = MyArray(j, 0)\n  newString = MyArray(j, 1)\n\n  If Len(oldString) &gt; 1 Then\n    For Each pptSlide In ActivePresentation.Slides\n      For Each pptShape In pptSlide.Shapes\n        If (pptShape.Type = msoLinkedOLEObject) Or (pptShape.Type = msoChart) Then\n'           With pptShape.LinkFormat\n\n                If InStr(1, (pptShape.LinkFormat.SourceFullName), (oldString), 1) Then\n\n                ' debug points\n                q = pptShape.Id\n                r = pptShape.Name\n                s = pptSlide.SlideIndex\n                t = pptSlide.SlideNumber\n\n                ' The actual source link\n                x = pptShape.LinkFormat.SourceFullName\n                ' substitute source link with new string\n                y = Replace(x, oldString, newString)\n                ' Further adjust new link so any spaces in tab names have %20\n                y = Replace(y, \"%20\", \" \")\n                'y = Replace(y, \" \", \"%20\")\n                'y = Replace(y, \"file:///\", \"\")\n\n\n                ' ignore errors when can't see new link\n                On Error Resume Next\n\n                pptShape.LinkFormat.SourceFullName = y\n                DoEvents\n                ' debug assignment\n                w = pptShape.LinkFormat.SourceFullName\n\n                   Debug.Print \"old string \" &amp; oldString\n                   Debug.Print \"replacement string \" &amp; newString\n                   Debug.Print \"org link x \" &amp; x\n                   Debug.Print \"new link y \" &amp; y\n                   Debug.Print \"result   w \" &amp; w\n                   Debug.Print \"---\"\n                   Debug.Print \"\"\n\n\n                End If\n\n'            End With\n        End If\n      DoEvents\n      Next pptShape\n    DoEvents\n    Next pptSlide\n\n  End If\n\nNext\n</code></pre>\n\n<p>PPT 2016 has changed the links to look like HTML, with a preceeding file:/// and changed all spaces to \"%20\"</p>\n\n<p>Here's a couple of examples running my script.  Now, if I have a different path and a different filename, it's requiring 2 passes of the code with different \"matching\" strings (one with and one without %20) in each pass.  If the filename is the same, then it will do it in one pass of the code, but it opens the files 4 times per link.  As I have hundreds of links that's extremely time consuming.</p>\n\n<p>Also in office 2015, as long as I had the target open, no reopening happened.  Now, if I have the target open, I get an error saying it can't open 2 files by the same name.</p>\n\n<p><strong>Example 1</strong> with diff paths and diff filenames, all flies closed.</p>\n\n<p>Array fed to code with links to be changed:</p>\n\n<blockquote>\n<pre><code>MyArray(0, 0) = \"file:///\\\\aFolder\\bFolder\\Reports\\daily%20report%20generator.xlsm!Site%20Completions!R2C2:R17C17\"\nMyArray(0, 1) = \"file:///\\\\aFolder\\bFolder\\Reports\\Rpt-Other\\daily%20report%20generator2.xlsm!Site%20Completions!R2C2:R17C17\"\n</code></pre>\n</blockquote>\n\n<p>Orig link reported in debugger:</p>\n\n<blockquote>\n<pre><code>file:///\\\\aFolder\\bFolder\\Reports\\daily%20report%20generator.xlsm!Site%20Completions!R2C2:R17C17\n</code></pre>\n</blockquote>\n\n<p>1st pass, opens files twice (assume target and source), results in the link missing the %20's but no path or filename changed:</p>\n\n<blockquote>\n<pre><code>\\\\aFolder\\bFolder\\Reports\\daily report generator.xlsm!Site Completions!R2C2:R17C17\n</code></pre>\n</blockquote>\n\n<p>Change the array's 1st element (source path) and run the code a 2nd time.  This time the match string is the same except w/o %20.  Again, it opened 2 files in this pass, this time it changed the path and filename:</p>\n\n<blockquote>\n<pre><code>\\\\aFolder\\bFolder\\Reports\\Rpt-Other\\daily report generator2.xlsm!Site Completions!R2C2:R17C17\n</code></pre>\n</blockquote>\n\n<p><strong>2nd example</strong>, filenames are the same, only path changes.  Neither file open.  There is only one link to update.</p>\n\n<p>Original link:</p>\n\n<blockquote>\n<pre><code>file:///\\\\aFolder\\bFolder\\Reports\\daily%20report%20generator.xlsm!Site%20Completions!R2C2:R17C17\n</code></pre>\n</blockquote>\n\n<p>pass 1 opens a file 4 times, but does not take 2 runs of the script as it did in example 1, results in:</p>\n\n<blockquote>\n<pre><code>\\\\aFolder\\bFolder\\Reports\\Rpt-Other\\daily report generator.xlsm!Site Completions!R2C2:R17C17\n</code></pre>\n</blockquote>\n\n<p>Not a big deal but worth noting maybe: If I save file, links don't change, but if I Save, close reopen, PPT adds file:/// and %20's back to the original links.</p>\n\n<p>It appears the HTMLizing of the filenames has hosed the way it's working. And it's causing the files to be opened 4 times per link.  Apparently twice per source and target.  </p>\n\n<p>Worst of all in the 1st example, which changes both the filename and the path, I have to run the scrip twice, changing the source/match string from with to without \"%20\" to get it to succeed. </p>\n\n<p>Anyone know how to fix this?</p>\n\n<p>1/26/17: Edited some for better formatting and clarity.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1485379958, "post_id": 41861582, "comment_id": 70907816, "body": "show the macro calling Userform1"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1485380857, "post_id": 41861582, "comment_id": 70908242, "body": "Seems to me there was a similar question I answered not too long ago... let me check my history."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 1, "creation_date": 1485380989, "post_id": 41861582, "comment_id": 70908320, "body": "similar, but there was not an accepted answer (though there were several attempts, one of which may be useful for you): <a href=\"http://stackoverflow.com/questions/41244457/unable-to-close-opened-excel-workbook/41287563#41287563\" title=\"unable to close opened excel workbook\">stackoverflow.com/questions/41244457/&hellip;</a>"}, {"owner": {"reputation": 37, "user_id": 3752138, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56b644c4f4b4ecfb48ffdd46f95c45da?s=128&d=identicon&r=PG&f=1", "display_name": "user3752138", "link": "https://stackoverflow.com/users/3752138/user3752138"}, "edited": false, "score": 0, "creation_date": 1485381212, "post_id": 41861582, "comment_id": 70908432, "body": "@&quot;David Zemens&quot; Thanks. I saw that there were a few similar questions to the one I asked, but I couldn&#39;t find a solution that works for me."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 1, "creation_date": 1485381301, "post_id": 41861582, "comment_id": 70908474, "body": "You&#39;re trying to unload the default instance of the form from <i>inside the default instance</i> of the form.  Change <code>Unload UserForm1</code> to <code>Unload Me</code>."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 2, "creation_date": 1485381767, "post_id": 41861582, "comment_id": 70908714, "body": "Possibly relevant: <a href=\"http://stackoverflow.com/documentation/vba/5351/user-forms#t=20170125220228566528\">UserForms on Documentation.SO</a>"}, {"owner": {"reputation": 3101, "user_id": 6783806, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dce70a8f2f353bdac58089c38f1ba5a5?s=128&d=identicon&r=PG&f=1", "display_name": "Mukul Varshney", "link": "https://stackoverflow.com/users/6783806/mukul-varshney"}, "edited": false, "score": 0, "creation_date": 1485397174, "post_id": 41861582, "comment_id": 70913481, "body": "Try statement Application.ScreenUpdating= True, before filesToOpen.show statement. filedialog will be shown, so lets allow screen update."}, {"owner": {"reputation": 37, "user_id": 3752138, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56b644c4f4b4ecfb48ffdd46f95c45da?s=128&d=identicon&r=PG&f=1", "display_name": "user3752138", "link": "https://stackoverflow.com/users/3752138/user3752138"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1485434584, "post_id": 41861582, "comment_id": 70928937, "body": "@mat&#39;s I&#39;ll look over this. Thanks"}], "answers": [{"tags": [], "owner": {"reputation": 129, "user_id": 2842822, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/451fbfc9bc7fedbdb95b477d63ab4c24?s=128&d=identicon&r=PG&f=1", "display_name": "CassieD", "link": "https://stackoverflow.com/users/2842822/cassied"}, "is_accepted": false, "score": 0, "last_activity_date": 1512494344, "creation_date": 1512494344, "answer_id": 47659208, "question_id": 41861582, "link": "https://stackoverflow.com/questions/41861582/cannot-close-workbook-after-running-sub-with-userform/47659208#47659208", "title": "Cannot close workbook after running sub with userform", "body": "<p>The root of the problem is the change to using multiple excel interfaces in 2013.  Microsoft addresses the issue in the <strong>Solutions for SDI Issues</strong> section of this <a href=\"https://msdn.microsoft.com/en-us/VBA/Excel-VBA/articles/programming-for-the-single-document-interface-in-excel?f=255&amp;MSPPError=-2147217396\" rel=\"nofollow noreferrer\">page</a>.</p>\n\n<blockquote>\n  <p>A workbook cannot be closed by clicking the red \"X\" Close button when\n  that workbook is programmatically opened via a modal user form. To\n  work around this issue, it is suggested that you add the following\n  code to the user form Layout event procedure and then open the user\n  form as modeless</p>\n\n<pre><code>Private Sub UserForm_Layout()\n    Static fSetModal As Boolean\n    If fSetModal = False Then\n        fSetModal = True\n        Me.Hide\n        Me.Show 1\n    End If\nEnd Sub\n</code></pre>\n  \n  <p>Another option is to open the workbook window, activate any other\n  window, and then reactivate the workbook window. You should now be\n  able to close the workbook using the Close button.</p>\n</blockquote>\n\n<p>So these are the two options they present and one I came up with.</p>\n\n<p>Option 1) You can switch your dialog to modeless using their code, or by setting the ShowModel property to false in your userform.</p>\n\n<p>Option 2) As you discovered, manually switching between workbooks after opening via modal userform resyncs everything.  Not a good solution for the users of my code, and I don't recommend relying on it.</p>\n\n<p>Option 3) It's worth mentioning, if you don't open the file via the userform then there's no issue.  So if last thing the userform needs to do is open the file, you can easily save the file path in a string, unload the troublesome userform and move the workbooks.open call after closing.  Here's an example of what I mean</p>\n\n<pre><code>Public EDIT_FILE_DIRECTORY As String\n\nPublic Sub Main()\n\n    fileOpenerForm.Show \n\n    If EDIT_FILE_DIRECTORY &lt;&gt; \"\" Then\n        Call Workbooks.Open(EDIT_FILE_DIRECTORY)\n    End If\n\nEnd Sub\n</code></pre>\n\n<p>And in the userform something along these lines, where the filename is created based on userform parameters and a listbox selection:</p>\n\n<pre><code>Private Sub OpenSelectedWorkbooks_Button_Click()\n\n    Dim workbookName As String\n\n    workbookName = selectionList.Item(Me.FileSelection_ListBox.ListIndex + 1)\n\n    EDIT_FILE_DIRECTORY = ROOT_DIR &amp; GetSelectedSubfolder &amp; \"\\\" &amp; workbookName\n\n    Unload Me\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 73, "user_id": 9972600, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-6P43_PxJYBk/AAAAAAAAAAI/AAAAAAAAwaU/BEexIRwNoWA/photo.jpg?sz=128", "display_name": "Cyril GUICHARD", "link": "https://stackoverflow.com/users/9972600/cyril-guichard"}, "is_accepted": false, "score": 0, "last_activity_date": 1533819768, "creation_date": 1533819768, "answer_id": 51767802, "question_id": 41861582, "link": "https://stackoverflow.com/questions/41861582/cannot-close-workbook-after-running-sub-with-userform/51767802#51767802", "title": "Cannot close workbook after running sub with userform", "body": "<p>Try <code>fileOpenerForm Show 0</code> to open open it with Modal = False  (Makes the macro run while the Userform is visible)</p>\n\n<p>Do not forget to add <code>fileOpenerForm.Hide</code> later on.</p>\n\n<p>Also <code>Load fileOpenerForm</code> and <code>Unload fileOpenerForm</code> may be useful</p>\n"}], "owner": {"reputation": 37, "user_id": 3752138, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56b644c4f4b4ecfb48ffdd46f95c45da?s=128&d=identicon&r=PG&f=1", "display_name": "user3752138", "link": "https://stackoverflow.com/users/3752138/user3752138"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2074, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1533819768, "creation_date": 1485378110, "last_edit_date": 1494056753, "question_id": 41861582, "link": "https://stackoverflow.com/questions/41861582/cannot-close-workbook-after-running-sub-with-userform", "title": "Cannot close workbook after running sub with userform", "body": "<p>I have a macro that opens a userform to capture a start and end date. After clicking OK on the userform, a file dialog box opens to select an Excel Workbook to open.</p>\n\n<p>Immediately after I run the below sub, I can't close the workbook that is opened by using the 'X' in the top-right corner. I also can't save the workbook by clicking the save icon.</p>\n\n<p>However, if I click on another workbook or switch to a different sheet in the workbook that was opened, and then click back to the one opened by the sub everything works as it's supposed to.</p>\n\n<p>Also, I replace the userform with two input boxes, to capture each of the two dates, I am able to close the workbook that is opened with no issue.</p>\n\n<p>Maybe there's something funny with the userform code?</p>\n\n<p>This is all that is in the userform.</p>\n\n<pre><code> Private Sub Ok_button_Click()\n call module1.forecast\n unload userform1\n end Sub\n</code></pre>\n\n<p>And this is the main sub.</p>\n\n<pre><code> Sub forecast()\n dim start_SFY as long\n dim end_SFY as long\n dim filesToOpen as object\n dim wb as workbook\n\n Application.ScreenUpdating= False\n\n start_SFY = userform1.textbox1.value\n end_SFY = userform1.textbox2.value\n\n set filesToOpen = application.fileDialog(msoFileDialogOpen)\n filesToOpen.show\n set wb = application.workbooks.open(filesToOpen.selecteditems(1),false)\n\n Application.ScreenUpdating= True\n End Sub\n</code></pre>\n\n<p>Here's the sub showing userform1</p>\n\n<pre><code> Sub run_userform()\n userform1.show\n End Sub\n</code></pre>\n\n<p>Also, here is the Excel version:</p>\n\n<p>Excel 2013 64-bit (15.04753.1003) Part of Microsoft Office 365 ProPlus</p>\n\n<p>Can someone maybe try to replicate the issue that I'm having? I'm wondering if this is an issue related to my employer's version of Excel or something?</p>\n\n<p>This sort of thing has never happened to me before.</p>\n\n<p>Also, I can close the program with VBA. It's just when trying to click the 'X' that it won't close.</p>\n\n<p><strong>Update:</strong></p>\n\n<p><s>I was able to get the code, with no changes, to work fine at home on Excel 2016. I'm going to get a coworker to test on their system today.</s></p>\n\n<p>When I was home, I didn't put a button to call the sub on a worksheet. I called it from the VBA editor. After some testing this morning, it seems that the button is the issue. If I call the sub from the VBA editor, I can close the opened workbook. However, if I use a command button (form control, not ActiveX as I get an error saying, \"Cannot draw object\" whenever I try to add any kind of ActiveX object to a worksheet) the opened workbook will not close.</p>\n\n<p><strong>I think I have found the problem</strong></p>\n\n<p>This issue seems to be with the 'form control command button'. ActiveX was disabled in the Trust Center. When I enabled it and created a command button, I was able to close the opened workbook. I then tried the command form button again, and could not close the opened workbook. I was also successfully able to close the opened workbook when I ran the sub from the sub listbox in the developer tab, and when I place the sub in the Excel Ribbon and ran it from there.</p>\n\n<p>Any idea as to why the control form command button would cause this issue?</p>\n"}, {"tags": ["vba", "excel-2007", "excel-2013", "resolve", "outlook-2013"], "comments": [{"owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "edited": false, "score": 0, "creation_date": 1485379468, "post_id": 41861242, "comment_id": 70907590, "body": "Under Tools | References check off Outlook"}, {"owner": {"reputation": 11, "user_id": 7443869, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/03e1fd47919302c92ba74c0b15e51c71?s=128&d=identicon&r=PG&f=1", "display_name": "JohnHolliday", "link": "https://stackoverflow.com/users/7443869/johnholliday"}, "reply_to_user": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "edited": false, "score": 0, "creation_date": 1485811924, "post_id": 41861242, "comment_id": 71071736, "body": "Do you mean to <i>remove</i> a check from a box or <i>add</i> a check to a box? I should have stated in my original post that I have the following references checked:  Visual Basic for Applications Microsoft Excel 15.0 Object Library Microsoft Office 15.0 Object Library Microsoft Outlook 15.0 Object Library OLE Automation OutlookAddin 1.0 Type Library  I&#39;ve unchecked each one in turn and retried the macro. Obviously, some of them cause an initial fail so they have to stay. The others, whether checked or unchecked, still cause the resolve failure.  Thanks."}, {"owner": {"reputation": 9, "user_id": 6362540, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f724bd5655c211810c1d11ddcbf6942b?s=128&d=identicon&r=PG&f=1", "display_name": "Dennis Hancy", "link": "https://stackoverflow.com/users/6362540/dennis-hancy"}, "edited": false, "score": 0, "creation_date": 1589289561, "post_id": 41861242, "comment_id": 109238160, "body": "For what it&#39;s worth, I am having the same problem in Excel 2016. It used to work fine in what I believe was Excel 2010. One thing I&#39;ve noticed: When I type in the code: lappRecipient.**Resolve**, it reformats it to lappRecipient.**resolve** (lower case resolve) Not sure if that&#39;s significant, but I thought it was odd."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 7443869, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/03e1fd47919302c92ba74c0b15e51c71?s=128&d=identicon&r=PG&f=1", "display_name": "JohnHolliday", "link": "https://stackoverflow.com/users/7443869/johnholliday"}, "edited": false, "score": 0, "creation_date": 1486059393, "post_id": 41964811, "comment_id": 71194534, "body": "Thank you and a great idea, but it didn&#39;t work.  I increased <b>maxTries</b> to 20,000 then to 200,000 and it still failed. I suspect this may have something to do with a security setting I am not privy to. I am not a local administrator though I don&#39;t know why that would matter. And my Outlook and server teams are currently not forthcoming with assistance. Thank you very much for the suggestion."}], "tags": [], "owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "is_accepted": false, "score": 1, "last_activity_date": 1485887057, "creation_date": 1485887057, "answer_id": 41964811, "question_id": 41861242, "link": "https://stackoverflow.com/questions/41861242/excel-2013-outlook-recipient-resolve-fails/41964811#41964811", "title": "Excel 2013 Outlook Recipient Resolve fails", "body": "<p>Try waiting to see if there is a delayed response.</p>\n\n<pre><code>Private Sub openOutlook2()\n\nDim lappOutlook As Outlook.Application\nDim lappNamespace As Outlook.Namespace\nDim lappRecipient As Outlook.Recipient\n\nDim strAcc As String\n\nDim maxTries As Long\nDim errCount As Long\n\nSet lappOutlook = CreateObject(\"Outlook.Application\")\nSet lappNamespace = lappOutlook.GetNamespace(\"MAPI\")\n\nstrAcc = \"smithj1\"\nSet lappRecipient = lappNamespace.CreateRecipient(strAcc)\n\nmaxTries = 2000\n\nOn Error GoTo errorResume\n\nRetry:\n\n    DoEvents\n\n    ' For testing error logic. No error with my Excel 2013 Outlook 2013 setup.\n    ' Should normally be commented out\n    'Err.Raise 287\n\n    lappRecipient.Resolve\n\nOn Error GoTo 0\n\nIf lappRecipient.Resolved Then\n     Debug.Print strAcc &amp; \" resolved.\"\n     MsgBox strAcc &amp; \"  resolved.\"\nElse\n    Debug.Print strAcc &amp; \" not resolved.\"\n    MsgBox \"No error: \" &amp; strAcc &amp; \" not resolved.\"\nEnd If\n\nExitRoutine:\n\n    Set lappOutlook = Nothing\n    Set lappNamespace = Nothing\n    Set lappRecipient = Nothing\n\n    Debug.Print \"Done.\"\n\n    Exit Sub\n\nerrorResume:\n\n    errCount = errCount + 1\n\n    ' Try until Outlook responds\n    If errCount &gt; maxTries Then\n\n        ' Check if Outlook is there and Resolve is the issue\n        lappNamespace.GetDefaultFolder(olFolderInbox).Display\n        GoTo ExitRoutine\n\n    End If\n\n    Debug.Print errCount &amp; \" - \" &amp; Err.Number &amp; \": \" &amp; Err.Description\n    Resume Retry\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 7443869, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/03e1fd47919302c92ba74c0b15e51c71?s=128&d=identicon&r=PG&f=1", "display_name": "JohnHolliday", "link": "https://stackoverflow.com/users/7443869/johnholliday"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1828, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1589289561, "creation_date": 1485376675, "question_id": 41861242, "link": "https://stackoverflow.com/questions/41861242/excel-2013-outlook-recipient-resolve-fails", "title": "Excel 2013 Outlook Recipient Resolve fails", "body": "<p>I have the following code that worked fine in Excel 2007 but fails in Excel 2013.</p>\n\n<pre><code>Dim lappOutlook As Outlook.Application\nDim lappNamespace As Outlook.Namespace\nDim lappRecipient As Outlook.RECIPIENT\n\nSet lappOutlook = CreateObject(\"Outlook.Application\")\nSet lappNamespace = lappOutlook.GetNamespace(\"MAPI\")\nSet lappRecipient = lappNamespace.CreateRecipient(\"smithj1\")\n\nlappRecipient.Resolve\n</code></pre>\n\n<p>What I'm doing is parsing emails from a folder in my inbox. However, I need to resolve the recipient but that fails. The code you see starts out the sub and the remainder of the code follows the resolve method.</p>\n\n<p>The error returned is:</p>\n\n<p>Run-time error '287':\nApplication-defined or object-defined error</p>\n\n<p>The error help really does not provide any useful information. Especially since this worked perfectly in Excel 2007 but now fails after an \"upgrade\" to Excel 2013.</p>\n\n<p>I have tried \"smithj1@company.org\" and \"John Smith\" and \"John A. Smith\", etc. (those are not the real name) but nothing works. When I copied this to a laptop that still had Office 2007 on it, the code ran perfectly. Within the hour, the laptop was \"upgraded\" automatically to Office 2013 and the code failed.</p>\n\n<p>Any help would be greatly appreciated. </p>\n"}, {"tags": ["vba", "excel", "combobox"], "comments": [{"owner": {"reputation": 526, "user_id": 7164307, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/b469705184f2479532aec6bc97f25b46?s=128&d=identicon&r=PG&f=1", "display_name": "D. O.", "link": "https://stackoverflow.com/users/7164307/d-o"}, "edited": false, "score": 0, "creation_date": 1485378947, "post_id": 41861206, "comment_id": 70907287, "body": "Why your code is in cboOptions_Change?"}, {"owner": {"reputation": 186, "user_id": 6254385, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/e349d5b647f71eb3b9ad40760e093fce?s=128&d=identicon&r=PG&f=1", "display_name": "quadrature", "link": "https://stackoverflow.com/users/6254385/quadrature"}, "reply_to_user": {"reputation": 526, "user_id": 7164307, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/b469705184f2479532aec6bc97f25b46?s=128&d=identicon&r=PG&f=1", "display_name": "D. O.", "link": "https://stackoverflow.com/users/7164307/d-o"}, "edited": false, "score": 0, "creation_date": 1485379067, "post_id": 41861206, "comment_id": 70907353, "body": "Because that&#39;s where it needs to be for the combo box to populate. The original combo box sits in Sheet1 and is the reference point for everything else. I suppose I can create it inside a standard module, alternatively..."}, {"owner": {"reputation": 526, "user_id": 7164307, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/b469705184f2479532aec6bc97f25b46?s=128&d=identicon&r=PG&f=1", "display_name": "D. O.", "link": "https://stackoverflow.com/users/7164307/d-o"}, "edited": false, "score": 0, "creation_date": 1485379220, "post_id": 41861206, "comment_id": 70907450, "body": "So, are the conditions corrects? Because, if they aren&#39;t, you will have nothing in the combobox."}, {"owner": {"reputation": 186, "user_id": 6254385, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/e349d5b647f71eb3b9ad40760e093fce?s=128&d=identicon&r=PG&f=1", "display_name": "quadrature", "link": "https://stackoverflow.com/users/6254385/quadrature"}, "reply_to_user": {"reputation": 526, "user_id": 7164307, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/b469705184f2479532aec6bc97f25b46?s=128&d=identicon&r=PG&f=1", "display_name": "D. O.", "link": "https://stackoverflow.com/users/7164307/d-o"}, "edited": false, "score": 0, "creation_date": 1485379325, "post_id": 41861206, "comment_id": 70907520, "body": "They are working, yes. Depending on if the active cell is in Col A, B or C, the selection changes for any activated sheet."}], "answers": [{"tags": [], "owner": {"reputation": 186, "user_id": 6254385, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/e349d5b647f71eb3b9ad40760e093fce?s=128&d=identicon&r=PG&f=1", "display_name": "quadrature", "link": "https://stackoverflow.com/users/6254385/quadrature"}, "is_accepted": false, "score": 1, "last_activity_date": 1485452498, "creation_date": 1485452498, "answer_id": 41879628, "question_id": 41861206, "link": "https://stackoverflow.com/questions/41861206/combo-box-not-returning-chosen-listindex-value/41879628#41879628", "title": "Combo box not returning chosen listindex value", "body": "<p>The nature of the problem seems to be that using more than one array for one combo box breaks down how the listindex values are calculated. I broke down the code to its component features to see if the issue persisted</p>\n\n<p>1) Made a new file and put the code in Sheet1 \n2) Made separate fixed arrays for each kind of input\n3) Created a separate routine for each kind of input</p>\n\n<p>Using ON ERROR RESUME NEXT at the beginning of each routine overlooks the error and the code works properly. Alternatively, putting in a break where the integer variable is given the listindex value of the combo box allows the user to make a choice and assign a value to the integer variable, before continuing. Otherwise, its default value is -1 and returns an error; using <code>.list(.listindex)</code> did not make any difference, suggesting that the code needs to wait for user input (using a combobox event other than Change?).</p>\n\n<p>May just need to establish a separate combo box for each column. Anyway, the code below is the sticks-and-stones version of the above, for a single sheet, and it will do the job if applied to each sheet module in the workbook:</p>\n\n<pre><code>Sub monthnames()\n'add month names to the first cell of each sheet\n\nDim n As Integer\n'Sheets(1).Activate\nFor n = 1 To 12\n    Sheets.Add After:=ActiveSheet\n    ThisWorkbook.Sheets(n).Cells(1, 1) = MonthName(n)\n    Next\nEnd Sub\n\nPrivate Sub cboOptions_Change()\n\nDim myarray(1 To 4) As String\nDim myarray2(1 To 5) As String\nDim myarray3(1 To 2) As String\n\ncboOptions.Enabled = True\ncboOptions.Visible = True\n\nDim n As Integer\n\nn = ActiveCell.Row\n If n &gt;= 3 And n &lt; 10000 Then\n\n    If Range(ActiveCell.Address).Address = Range(\"A\" &amp; n).Address Then\n        myarray(1) = \"Apartment\"\n        myarray(2) = \"Room\"\n        myarray(3) = \"Townhouse\"\n        myarray(4) = \"House\"\n        cboOptions.List = myarray()\n        inputdata myarray(), n\n\n    ElseIf Range(ActiveCell.Address).Address = Range(\"B\" &amp; n).Address Then\n\n        myarray2(1) = \"1\"\n        myarray2(2) = \"2\"\n        myarray2(3) = \"3\"\n        myarray2(4) = \"4\"\n        myarray2(5) = \"5\"\n        cboOptions.List = myarray2()\n        inputdata2 myarray2(), n\n\n   ElseIf Range(ActiveCell.Address).Address = Range(\"C\" &amp; n).Address Then\n\n        myarray3(1) = \"Heat &amp; Water\"\n        myarray3(2) = \"All-inclusive\"\n        cboOptions.List = myarray3()\n        inputdata3 myarray3(), n\n    Else\n\n        cboOptions.Enabled = False\n        cboOptions.Visible = False\n\n    End If\n\n  End If\n\n\nEnd Sub\n\n\nSub inputdata(myarray, n) 'myarray3, )\n\nOn Error Resume Next\nDim x As Integer\n\n    cboOptions.Left = Range(ActiveCell.Address).Left\n    cboOptions.Top = Range(ActiveCell.Address).Top\n    Columns(ActiveCell.Column).ColumnWidth = cboOptions.Width * 0.18\n\n    If Range(ActiveCell.Address).Address = Range(\"A\" &amp; n).Address Then\n\n    x = cboOptions.ListIndex + 1\n\n    Range(ActiveCell.Address) = myarray(x)\n\nElse\n\n    Exit Sub\n\nEnd If\n\nEnd Sub\n\nSub inputdata2(myarray2, n)\nOn Error Resume Next\nDim y As Integer\n\n    cboOptions.Left = Range(ActiveCell.Address).Left\n    cboOptions.Top = Range(ActiveCell.Address).Top\n    Columns(ActiveCell.Column).ColumnWidth = cboOptions.Width * 0.18\n\n\n\n    If Range(ActiveCell.Address).Address = Range(\"B\" &amp; n).Address Then\n\ny = cboOptions.ListIndex + 1\n\n    Range(ActiveCell.Address) = myarray2(y)\n\nElse\n\n    Exit Sub\n\nEnd If\n\nEnd Sub\n\nSub inputdata3(myarray3, n)\nOn Error Resume Next\nDim z As Integer\n\n    cboOptions.Left = Range(ActiveCell.Address).Left\n    cboOptions.Top = Range(ActiveCell.Address).Top\n    Columns(ActiveCell.Column).ColumnWidth = cboOptions.Width * 0.18\n\nIf Range(ActiveCell.Address).Address = Range(\"C\" &amp; n).Address Then\n\nz = cboOptions.ListIndex + 1\n\n    Range(ActiveCell.Address) = myarray3(z)\n\nElse\n\n    Exit Sub\n\nEnd If\n\nEnd Sub\n\nPrivate Sub Worksheet_SelectionChange(ByVal Target As Range)\nCall cboOptions_Change\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 186, "user_id": 6254385, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/e349d5b647f71eb3b9ad40760e093fce?s=128&d=identicon&r=PG&f=1", "display_name": "quadrature", "link": "https://stackoverflow.com/users/6254385/quadrature"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 383, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1485452498, "creation_date": 1485376577, "question_id": 41861206, "link": "https://stackoverflow.com/questions/41861206/combo-box-not-returning-chosen-listindex-value", "title": "Combo box not returning chosen listindex value", "body": "<p>I'm creating a workbook, which tracks available rentals per month. It is divided into 12 sheets, one for each month. The first three columns of each sheet track the type of accommodation, number of bedrooms and what's included in the rental price. The concept there is that there will be a drop-down combo box that allows the user to fill in with a point-and-click option rather than typing things out in order to reduce input errors.</p>\n\n<p>I set up a fixed array, the contents in which changes depending on what column that active cell is in, and then the array is assigned to the combo box. The code lives in the Sheet1 Module under the combo box code and the ThisWorkbook module calls it under SheetSelectionChange, so as to avoid repeating the code in each sheet. </p>\n\n<p>A Standard Module makes the array public</p>\n\n<p>All 12 combo boxes share the same name, cboOptions, and they populate correctly, regardless of what sheet is chosen. My problem is that none of the combo boxes return the listindex value of the choice that's made, regardless of the code telling it to do so. I've been testing to see the value of the position returned against the value of the position chosen, but I have not been able to establish a pattern. I thought about clearing the variables and arrays, thinking that might be what's messing with the code, but it seems to be having no effect. I've read what I could on the issue, but I'm out of ideas on what might be the problem...thank you in advance!</p>\n\n<p>Code in Sheet1 module:</p>\n\n<pre><code>    Private Sub cboOptions_Change()\n\nErase myarray()\ncboOptions.Visible = True\ncboOptions.Enabled = True\ncboOptions.Clear\n\nn = ActiveCell.Row\n If n &gt;= 3 And n &lt; 10000 Then\n\n    If ActiveSheet.Range(ActiveCell.Address).Address = Range(\"A\" &amp; n).Address Then\n\n        myarray(1) = \"Apartment\"\n        myarray(2) = \"Room\"\n        myarray(3) = \"Townhouse\"\n        myarray(4) = \"House\"\n\n\n    ElseIf ActiveSheet.Range(ActiveCell.Address).Address = Range(\"B\" &amp; n).Address Then\n\n        myarray(1) = \"1\"\n        myarray(2) = \"2\"\n        myarray(3) = \"3\"\n        myarray(4) = \"4\"\n        myarray(5) = \"5\"\n\n\n    ElseIf ActiveSheet.Range(ActiveCell.Address).Address = Range(\"C\" &amp; n).Address Then\n\n        myarray(1) = \"Heat &amp; Water\"\n        myarray(2) = \"All-inclusive\"\n\n    Else\n\n        cboOptions.Enabled = False\n        cboOptions.Visible = False\n\n    End If\n\n  End If\n'ActiveSheet.cboOptions.ListIndex = 0\n\n\n'Dim x As Long\n'MsgBox ActiveSheet.Name\n\nWith ActiveSheet\n.cboOptions.Left = .Range(ActiveCell.Address).Left\n.cboOptions.Top = .Range(ActiveCell.Address).Top\n\n.cboOptions.List = myarray()\n\n\nWith .cboOptions\n'the problem is that x needs to get assigned a value from the combo box before it continues to execute\n\n    x = .List(.ListIndex)\n    'MsgBox x\n    End With\n    .Range(ActiveCell.Address) = x 'myarray(x)\n.Columns(ActiveCell.Column).ColumnWidth = cboOptions.Width * 0.18\nx = 0\n\nErase myarray()\n\nEnd With\n\nEnd Sub\n</code></pre>\n\n<p>Code in ThisWorkbook:</p>\n\n<pre><code>Sub Workbook_SheetSelectionChange(ByVal sh As Object, ByVal Target As Range)\n\nApplication.Run \"Sheet1.cboOptions_Change\"\n\nEnd Sub\n</code></pre>\n\n<p>Code in Module1:</p>\n\n<pre><code>Option Explicit\nPublic myarray(0 To 5) As String\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1018, "user_id": 6706734, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/89cf86a3fd50974771d8041b8f13e5b0?s=128&d=identicon&r=PG&f=1", "display_name": "J_Lard", "link": "https://stackoverflow.com/users/6706734/j-lard"}, "edited": false, "score": 0, "creation_date": 1485377238, "post_id": 41861103, "comment_id": 70906436, "body": "Can you be more specific as to what you&#39;re trying to do? Also, post the code you&#39;ve tried and what you think the error is."}, {"owner": {"reputation": 4067, "user_id": 2970789, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dd4ed57e10989bdb3f3ac58326b7354?s=128&d=identicon&r=PG&f=1", "display_name": "Ambie", "link": "https://stackoverflow.com/users/2970789/ambie"}, "edited": false, "score": 0, "creation_date": 1485377481, "post_id": 41861103, "comment_id": 70906556, "body": "Have you looked at Application object&#39;s events? It ha various <code>Deactivare</code> events."}, {"owner": {"reputation": 1, "user_id": 7471033, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7cc1ed41750585af0ba048016a9a705d?s=128&d=identicon&r=PG&f=1", "display_name": "Dianna", "link": "https://stackoverflow.com/users/7471033/dianna"}, "edited": false, "score": 0, "creation_date": 1485381795, "post_id": 41861103, "comment_id": 70908720, "body": "What i want to do is to Copy data in certain cells if the user clicks out of Excel."}, {"owner": {"reputation": 1, "user_id": 7471033, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7cc1ed41750585af0ba048016a9a705d?s=128&d=identicon&r=PG&f=1", "display_name": "Dianna", "link": "https://stackoverflow.com/users/7471033/dianna"}, "edited": false, "score": 0, "creation_date": 1485381832, "post_id": 41861103, "comment_id": 70908741, "body": "Below is the code i have tried.  the deactivate only works when closing the workbook, but not when i click on a ptt document.     there has to be a solution for this    Private Sub Workbook_WindowDeactivate(ByVal Wn As Window) Wn.ActiveCell.Copy End Sub"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1485382126, "post_id": 41861103, "comment_id": 70908871, "body": "The <code>WindowDeactivate</code> event only fires when the active window <i>within</i> Excel changes.  Are you trying to copy to the clipboard any time Excel loses <i>focus</i>?"}, {"owner": {"reputation": 1, "user_id": 7471033, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7cc1ed41750585af0ba048016a9a705d?s=128&d=identicon&r=PG&f=1", "display_name": "Dianna", "link": "https://stackoverflow.com/users/7471033/dianna"}, "edited": false, "score": 0, "creation_date": 1485382485, "post_id": 41861103, "comment_id": 70909049, "body": "Yes. this is what i want to do and build from that"}, {"owner": {"reputation": 1, "user_id": 7471033, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7cc1ed41750585af0ba048016a9a705d?s=128&d=identicon&r=PG&f=1", "display_name": "Dianna", "link": "https://stackoverflow.com/users/7471033/dianna"}, "edited": false, "score": 0, "creation_date": 1485383781, "post_id": 41861103, "comment_id": 70909677, "body": "could this be done with &quot;user32.dll&quot; ?"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1485384387, "post_id": 41861103, "comment_id": 70909928, "body": "@Dianna - The best way to do it via API functions would be with either a hook or a subclass.  I&#39;d take a look at <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/ms644990(v=vs.85).aspx\" rel=\"nofollow noreferrer\"><code>SetWindowsHookEx</code></a>. You&#39;d basically want to listen for <code>WM_SETFOCUS</code> events and compare the hWnd to the window you want to hook."}, {"owner": {"reputation": 1, "user_id": 7471033, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7cc1ed41750585af0ba048016a9a705d?s=128&d=identicon&r=PG&f=1", "display_name": "Dianna", "link": "https://stackoverflow.com/users/7471033/dianna"}, "edited": false, "score": 0, "creation_date": 1485385530, "post_id": 41861103, "comment_id": 70910368, "body": "Don&#39;t know where to start with that but  I&#39;ll need to find out some how. Would the code be cross compatible across various VBA 64 bit machines?"}], "answers": [{"tags": [], "owner": {"reputation": 4067, "user_id": 2970789, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dd4ed57e10989bdb3f3ac58326b7354?s=128&d=identicon&r=PG&f=1", "display_name": "Ambie", "link": "https://stackoverflow.com/users/2970789/ambie"}, "is_accepted": false, "score": 1, "last_activity_date": 1485492995, "creation_date": 1485492995, "answer_id": 41887175, "question_id": 41861103, "link": "https://stackoverflow.com/questions/41861103/vba-running-a-sub-routine-before-excel-application-window-is-deactivated/41887175#41887175", "title": "VBA - Running a sub routine before excel application window is deactivated", "body": "<p>Unless you want to investigate subclassing, I don't see any other option but hooking to a WinEvent (which, as @Comitern says, is done using API functions).</p>\n\n<p>The problem is that once you have hooks running, Excel can become a bit temperamental. Basically, if your code develops an error or you break the code during development, odds are the application will crash. Speaking personally, it drives me to insanity. As a result I created a class to protect myself as much as possible. It's a bit of a monster class so I've deleted all the code that doesn't pertain to your task, but it's still pretty big. I'm also ashamed to admit I'm still on 32 bit, so the APIs are for that. There are plenty of websites that show you the 64 bit equivalents, so you could just replace the relevant data types.</p>\n\n<p>Ok, so here goes...</p>\n\n<p>First, insert a class module (Insert ~> Class Module) and name it <em>clsEventHookPair</em>. It's just a data field class and code is:</p>\n\n<pre><code>Option Explicit\n\nPublic EventID As WinEventId\nPublic EventHook As Long\n</code></pre>\n\n<p>Second, insert another class module and name it <em>clsWinEventListener</em>. This is the class that manages the hooks:</p>\n\n<pre><code>Option Explicit\n\nPrivate Const TAG As String = \"clsWinEventListener\"\nPublic Event WinEventHooked()\nPublic hWinEventHook As Long\nPublic WinEvent As WinEventId\nPublic hWnd As Long\nPublic idObject As Long\nPublic idChild As Long\nPublic dwEventThread As Long\nPublic dwmsEventTime As Long\nPrivate mWinEventHookList As Collection\nPrivate mTmpList As Collection\n\nPublic Sub AttachHook(evId As WinEventId)\n    Dim ehp As clsEventHookPair\n\n    'Check if hook is already running and remove it\n    Me.DetachHook evId\n\n    If mWinEventHookList Is Nothing Then\n        Set mWinEventHookList = New Collection\n    End If\n\n    'Populate our hook list with new hook details\n    Set ehp = New clsEventHookPair\n    With ehp\n        .EventID = evId\n        .EventHook = modHook.HookUp(.EventID)\n        mWinEventHookList.Add ehp, CStr(.EventID)\n        Debug.Print TAG &amp; \": Event hooked up [id=\" &amp; .EventID &amp; \", hk=\" &amp; .EventHook &amp; \"]\"\n    End With\n    Exit Sub\n\nEH:\n    Me.DetachAll\n    MsgBox Err.Number &amp; vbCrLf &amp; vbCrLf &amp; Err.Description\nEnd Sub\n\nPublic Sub DetachHook(evId As WinEventId)\n    Dim ehp As clsEventHookPair\n\n    If Not mWinEventHookList Is Nothing Then\n        'Check the hook is in our list\n        On Error Resume Next\n        Set ehp = mWinEventHookList(CStr(evId))\n        On Error GoTo 0\n\n        'Detach hook and remove from our list\n        On Error GoTo EH\n        If Not ehp Is Nothing Then\n            With ehp\n                modHook.Unhook .EventHook\n                mWinEventHookList.Remove CStr(.EventID)\n                Debug.Print TAG &amp; \": Event unhooked [id=\" &amp; .EventID &amp; \", hk=\" &amp; .EventHook &amp; \"]\"\n            End With\n        End If\n    End If\n    Exit Sub\n\nEH:\n    Me.DetachAll\n    MsgBox Err.Number &amp; vbCrLf &amp; vbCrLf &amp; Err.Description\nEnd Sub\n\nPublic Sub DetachAll()\n    Dim ehp As clsEventHookPair\n\n    'Remove all hooks from our list.\n    'Mainly used in event of error being thrown.\n    Debug.Print TAG &amp; \": Commencing emergency detach...\"\n    If Not mWinEventHookList Is Nothing Then\n        For Each ehp In mWinEventHookList\n            Me.DetachHook ehp.EventID\n        Next\n    End If\n    Set mWinEventHookList = Nothing\n    Debug.Print TAG &amp; \": Emergency detach complete.\"\nEnd Sub\n\nPublic Sub PauseHooks()\n    Dim ehp As clsEventHookPair\n\n    'Detaches the hooks but keeps a record of the eventIds\n    'so that we can attach hooks again on resume.\n    'Note: we can't keep the old event hook ids as\n    'we'll get new ones when reattached.\n    On Error GoTo EH\n    Debug.Print TAG &amp; \": Pausing hooks ...\"\n    If Not mWinEventHookList Is Nothing Then\n        Set mTmpList = New Collection\n        For Each ehp In mWinEventHookList\n            With ehp\n                mTmpList.Add .EventID\n                Me.DetachHook .EventID\n            End With\n        Next\n        Set mWinEventHookList = Nothing\n    End If\n    Exit Sub\n\nEH:\n    Me.DetachAll\n    MsgBox Err.Number &amp; vbCrLf &amp; vbCrLf &amp; Err.Description\nEnd Sub\n\nPublic Sub ResumeHooks()\n    Dim evId As Variant\n\n    'Re attach the 'paused' hooks\n    On Error GoTo EH\n    Debug.Print TAG &amp; \": Resuming hooks ...\"\n    If Not mTmpList Is Nothing Then\n        For Each evId In mTmpList\n            Me.AttachHook CLng(evId)\n        Next\n        Set mTmpList = Nothing\n    End If\n    Exit Sub\n\nEH:\n    Me.DetachAll\n    MsgBox Err.Number &amp; vbCrLf &amp; vbCrLf &amp; Err.Description\nEnd Sub\n\nPublic Sub ConsumeHookEvent()\n    Dim isTargetHook As Boolean\n    Dim ehp As clsEventHookPair\n\n    If mWinEventHookList Is Nothing Then Exit Sub\n\n    On Error GoTo EH\n    For Each ehp In mWinEventHookList\n        With ehp\n            'Check the hook event is one we want and fire the class event\n            'Shouldn't be needed but included in case we've left a rogue hook running.\n            If .EventHook = Me.hWinEventHook And .EventID = Me.WinEvent Then\n                RaiseEvent WinEventHooked\n                Exit Sub\n            End If\n        End With\n    Next\n    Exit Sub\n\nEH:\n    Me.DetachAll\n    MsgBox Err.Number &amp; vbCrLf &amp; vbCrLf &amp; Err.Description\nEnd Sub\n\nPublic Sub CountHooks()\n    Dim c As Long\n\n    'Used during development to ensure I don't break the code with hooks running\n    If Not mWinEventHookList Is Nothing Then\n        c = mWinEventHookList.Count\n    End If\n    Debug.Print TAG &amp; \": \" &amp; c &amp; \" current hook\" &amp; IIf(c &lt;&gt; 1, \"s.\", \".\")\nEnd Sub\n\nPrivate Sub Class_Initialize()\n    'Assign this class to the modHook module\n    'so that it can call the ConsumeHookEvent method\n    Set modHook.Listener = Me\n\n    'Remove after development.\n    'I use this to remove all the hooks\n    'if I want to break the code.\n    frmHook.UseWhileDeveloping Me\nEnd Sub\n\nPrivate Sub Class_Terminate()\n    'Remove the hooks\n    Me.DetachAll\n    Set modHook.Listener = Nothing\nEnd Sub\n</code></pre>\n\n<p>Third, insert a new module and name in <em>modHook</em>. This is the module that contains the APIs and I've converted the eventId constants to enums so that I can exploit intellisense (not great programming technique but I just couldn't keep track of all my constants). Code is:</p>\n\n<pre><code>Option Explicit\n\nPrivate Const TAG As String = \"modHook\"\nPublic Enum WinEventId\n    EventSystemSound = &amp;H1\n    EventSystemAlert = &amp;H2\n    EventSystemForeground = &amp;H3\n    EventSystemMenuStart = &amp;H4\n    EventSystemMenuEnd = &amp;H5\n    EventSystemMenuPopUpStart = &amp;H6\n    EventSystemMenuPopUpEnd = &amp;H7\n    EventSystemCaptureStart = &amp;H8\n    EventSystemCaptureEnd = &amp;H9\n    EventSystemMoveSizeStart = &amp;HA\n    EventSystemMoveSizeEnd = &amp;HB\n    EventSystemContextHelpStart = &amp;HC\n    EventSystemContextHelpEnd = &amp;HD\n    EventSystemDragdropStart = &amp;HE\n    EventSystemDragDropEnd = &amp;HF\n    EventSystemDialogStart = &amp;H10\n    EventSystemDialogEnd = &amp;H11\n    EventSystemScrollingStart = &amp;H12\n    EventSystemScrollingEnd = &amp;H13\n    EventSystemSwitchStart = &amp;H14\n    EventSystemSwitchEnd = &amp;H15\n    EventSystemMinimizeStart = &amp;H16\n    EventSystemMinimizeEnd = &amp;H17\n    EventSystemDesktopSwitch = &amp;H20\n    EventSystemEnd = &amp;HFF\n    EventObjectCreate = &amp;H8000\n    EventObjectDestroy = &amp;H8001\n    EventObjectShow = &amp;H8002\n    EventObjectHide = &amp;H8003\n    EventObjectReorder = &amp;H8004\n    EventObjectFocus = &amp;H8005\n    EventObjectSelection = &amp;H8006\n    EventObjectSelectionAdd = &amp;H8007\n    EventObjectSelectionRemove = &amp;H8008\n    EventObjectSelectionWithin = &amp;H8009\n    EventObjectStateChange = &amp;H800A\n    EventObjectLocationChange = &amp;H800B\n    EventObjectNameChange = &amp;H800C\n    EventObjectDescriptionChange = &amp;H800D\n    EventObjectValueChange = &amp;H800E\n    EventObjectParentChange = &amp;H800F\n    EventObjectHelpChange = &amp;H8010\n    EventObjectDefactionChange = &amp;H8011\n    EventObjectAcceleratorChange = &amp;H8012\n    EventObjectInvoked = &amp;H8013\n    EventObjectTextSelectionChanged = &amp;H8014\n    EventObjectContentScrolled = &amp;H8015\n    EventSystemArrangmentPreview = &amp;H8016\n    EventObjectLiveregionChanged = &amp;H8019\n    EventObjectHostedObjectsInvalidated = &amp;H8020\n    EventObjectDragStart = &amp;H8021\n    EventObjectDragcancel = &amp;H8022\n    EventObjectDragcomplete = &amp;H8023\n    EventObjectDragEnter = &amp;H8024\n    EventObjectDragLeave = &amp;H8025\n    EventObjectDragDropped = &amp;H8026\n    EventObjectImeShow = &amp;H8027\n    EventObjectImeHide = &amp;H8028\n    EventObjectImeChange = &amp;H8029\n    EventObjectTextEditConversionTargetChanged = &amp;H8030\n    EventObjectEnd = &amp;H80FF\nEnd Enum\nPrivate Declare Function SetWinEventHook Lib \"user32.dll\" _\n    (ByVal eventMin As Long, _\n    ByVal eventMax As Long, _\n    ByVal hmodWinEventProc As Long, _\n    ByVal pfnWinEventProc As Long, _\n    ByVal idProcess As Long, _\n    ByVal idThread As Long, _\n    ByVal dwFlags As Long) As Long\n\nPrivate Declare Function UnhookWinEvent Lib \"user32\" _\n    (ByVal hWinEventHook As Long) As Long\n\nPrivate mListener As clsWinEventListener\n\nPublic Property Set Listener(val As clsWinEventListener)\n    Dim res As VbMsgBoxResult\n\n    'Check if we have, and want, another instance of listener\n    If Not mListener Is Nothing And Not val Is Nothing Then\n        res = MsgBox(TAG &amp; \": multiple instances of listener.\" &amp; _\n                     vbCrLf &amp; vbCrLf &amp; \"Do you want to continue?\", _\n                     vbYesNo, \"Developer warning\")\n        If res = vbNo Then\n            mListener.DetachAll\n            End\n        End If\n    End If\n\n    Set mListener = val\nEnd Property\n\nPublic Function HookUp(evId As WinEventId) As Long\n    HookUp = SetWinEventHook(evId, evId, 0, AddressOf WinEventProc, 0, 0, 0)\nEnd Function\n\nPrivate Function WinEventProc _\n    (ByVal hWinEventHook As Long, _\n    ByVal WinEvent As Long, _\n    ByVal hWnd As Long, _\n    ByVal idObject As Long, _\n    ByVal idChild As Long, _\n    ByVal dwEventThread As Long, _\n    ByVal dwmsEventTime As Long) As Long\n\n    On Error GoTo EH\n    'Pass event parameters to listener\n    'and call listener's consume event method\n    If Not mListener Is Nothing Then\n        With mListener\n            .hWinEventHook = hWinEventHook\n            .WinEvent = WinEvent\n            .hWnd = hWnd\n            .idObject = idObject\n            .idChild = idChild\n            .dwEventThread = dwEventThread\n            .dwmsEventTime = dwmsEventTime\n            .ConsumeHookEvent\n        End With\n    End If\n    Exit Function\n\nEH:\n    If Not mListener Is Nothing Then mListener.DetachAll\n    MsgBox Err.Number &amp; vbCrLf &amp; vbCrLf &amp; Err.Description\nEnd Function\n\nPublic Sub Unhook(winEventHook As Long)\n    Dim ret As Long\n\n    ret = UnhookWinEvent(winEventHook)\nEnd Sub\n</code></pre>\n\n<p>Fourth, this one's optional but I also have a <code>Userform</code> on show while I'm developing so that I can hit a button to remove the hooks before I break the code. It saved me on many occasions but up to you I guess. If you want it, insert a UserForm and name it <em>frmHook</em>. Add two buttons called <em>btnUnHook</em> and btnCount. The first is used to remove the hooks and the second just writes the number of running hooks to the immediate window. Basically, hit the unhook button whenever you want to exit the code. Code behind is:</p>\n\n<pre><code>Option Explicit\nPrivate mListener As clsWinEventListener\n\nPublic Sub UseWhileDeveloping(lstnr As clsWinEventListener)\n    Set mListener = lstnr\n    Me.Show False\nEnd Sub\n\nPrivate Sub btnCount_Click()\n    mListener.CountHooks\nEnd Sub\n\nPrivate Sub btnUnHook_Click()\n    mListener.DetachAll\nEnd Sub\n\nPrivate Sub UserForm_Terminate()\n    mListener.DetachAll\nEnd Sub\n</code></pre>\n\n<p>And finally, you can access this lot in any object module. Typically, people hook up at the <code>Workbook_Open</code> event, so I've done the same in the code below:</p>\n\n<pre><code>Option Explicit\n\nPrivate WithEvents mListener As clsWinEventListener\n\nPrivate Sub mListener_WinEventHooked()\n    On Error GoTo EH\n\n    'Handler for the hook event\n    If mListener.WinEvent = EventSystemForeground Then\n        If mListener.hWnd &lt;&gt; Application.hWnd Then\n            mListener.PauseHooks 'don't need this but I remove hooks while working on sheets\n            MsgBox \"Excel lost focus.\"\n            '... code goes here ...\n            mListener.ResumeHooks 're-attch the hooks\n        End If\n    End If\n    Exit Sub\n\nEH:\n    If Not mListener Is Nothing Then mListener.DetachAll\nEnd Sub\n\nPrivate Sub Workbook_BeforeClose(Cancel As Boolean)\n\n    'Remove all hooks before close\n    If Not mListener Is Nothing Then\n        mListener.DetachAll\n    End If\nEnd Sub\n\nPrivate Sub Workbook_Open()\n    On Error GoTo EH\n    Set mListener = New clsWinEventListener\n\n    'Hook up to desired events here\n    mListener.AttachHook EventSystemForeground\n    Exit Sub\n\nEH:\n    If Not mListener Is Nothing Then mListener.DetachAll\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 7471033, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7cc1ed41750585af0ba048016a9a705d?s=128&d=identicon&r=PG&f=1", "display_name": "Dianna", "link": "https://stackoverflow.com/users/7471033/dianna"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 420, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1485492995, "creation_date": 1485376200, "last_edit_date": 1485382799, "question_id": 41861103, "link": "https://stackoverflow.com/questions/41861103/vba-running-a-sub-routine-before-excel-application-window-is-deactivated", "title": "VBA - Running a sub routine before excel application window is deactivated", "body": "<p>I'm really stuck here. I'm trying to run a sub routine - copy range values -  before the excel window is deactivated. I'm using 64bit vba and none of the current subroutine at the workbook level offer this solution. I would like to copy data any time Excel loses focus. Any ideas how this can be done ? </p>\n\n<pre><code>Private Sub Workbook_WindowDeactivate(ByVal Wn As Window)\n    Wn.ActiveCell.Copy\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "csv"], "answers": [{"comments": [{"owner": {"reputation": 173, "user_id": 7044405, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/f742859043d35ddb70d58dd4b5c0c582?s=128&d=identicon&r=PG&f=1", "display_name": "Navid", "link": "https://stackoverflow.com/users/7044405/navid"}, "edited": false, "score": 0, "creation_date": 1485377292, "post_id": 41861229, "comment_id": 70906458, "body": "Thanks for your response. I got a question though. about        arr1 = wb1.Worksheets(&quot;WHATEVER_ITS_NAME_IS&quot;).Range(&quot;A1:Z1&quot;).Value   number of my columns are more than (A1:Z1) is there any way that we can set it up to the end of last cell?"}, {"owner": {"reputation": 328, "user_id": 3203246, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/ff559ad8929b01e3ef1a0c743f670743?s=128&d=identicon&r=PG&f=1", "display_name": "johnzilla", "link": "https://stackoverflow.com/users/3203246/johnzilla"}, "reply_to_user": {"reputation": 173, "user_id": 7044405, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/f742859043d35ddb70d58dd4b5c0c582?s=128&d=identicon&r=PG&f=1", "display_name": "Navid", "link": "https://stackoverflow.com/users/7044405/navid"}, "edited": false, "score": 0, "creation_date": 1485378532, "post_id": 41861229, "comment_id": 70907057, "body": "Yeah sure, try range.resize(rows, cols). MSDN is a great reference for all the Excel VBA functions, objects, methods out there."}], "tags": [], "owner": {"reputation": 328, "user_id": 3203246, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/ff559ad8929b01e3ef1a0c743f670743?s=128&d=identicon&r=PG&f=1", "display_name": "johnzilla", "link": "https://stackoverflow.com/users/3203246/johnzilla"}, "is_accepted": false, "score": 2, "last_activity_date": 1485378579, "last_edit_date": 1485378579, "creation_date": 1485376632, "answer_id": 41861229, "question_id": 41860974, "link": "https://stackoverflow.com/questions/41860974/vba-copy-rows-from-csv-into-columns-in-new-worksheet/41861229#41861229", "title": "VBA: copy rows from csv into columns in new worksheet", "body": "<p>Try something like:</p>\n\n<pre><code>Dim wb1 As Workbook, wb2 As Workbook\nDim colnum\nDim arr1\nDim range2 As Range\n\ncolnum = 20\nSet wb2 = ThisWorkbook\n\nSet range2 = wb2.Worksheets(\"Sheet1\").Range(\"A1\")   'wherever I want to paste my data to\nFor Each file In fs.getfolder(CSVPath).file\n       If Right(file.Name, 3) = \"csv\" Then\n            Set wb1 = Application.Workbooks.Open(file.Path)\n            arr1 = wb1.Worksheets(\"WHATEVER_ITS_NAME_IS\").Range(\"A1\").resize(1, colnum).Value\n            rowlen = UBound(arr1, 1) - LBound(arr1, 1) + 1\n            collen = UBound(arr1, 2) - LBound(arr1, 2) + 1\n\n            range2.Resize(rowlen, collen).Value = arr1\n        End If\nNext\n</code></pre>\n\n<p>There's lots of ways to skin this cat. Not sure if my code works but maybe this will help. Usually I don't like to loop through every cell. In VBA, these sort of loops are very slow. It's better to just copy the whole array at once. Use the property Range.Value to set/get the array data from the Range object        </p>\n"}, {"tags": [], "owner": {"reputation": 424, "user_id": 5625975, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2cc7b4783c17e0439f28d0aa0c9b24a5?s=128&d=identicon&r=PG&f=1", "display_name": "William Humphries", "link": "https://stackoverflow.com/users/5625975/william-humphries"}, "is_accepted": false, "score": 0, "last_activity_date": 1618492347, "creation_date": 1618492347, "answer_id": 67109148, "question_id": 41860974, "link": "https://stackoverflow.com/questions/41860974/vba-copy-rows-from-csv-into-columns-in-new-worksheet/67109148#67109148", "title": "VBA: copy rows from csv into columns in new worksheet", "body": "<p>I found <a href=\"https://www.homeandlearn.org/open_a_text_file_in_vba.html\" rel=\"nofollow noreferrer\">this article</a> to open and read from a text/csv file and then looped through all items in the string/variant to add to the Excel sheet.</p>\n<p>VBA code is below</p>\n<pre><code>Sub FillInExcelFromCSV(tempCSV As String, tempXL As String, rowToFill As Integer)\n\nDim i, counter As Integer\nSet tempFile = GetObject(tempCSV)\nSet tempXLFile = GetObject(tempXL)\nrow_number = 1\n\nOpen tempCSV For Binary As #1\n  Do Until EOF(1)\n    Line Input #1, LineFromFile\n    LineItems = Split(LineFromFile, &quot;,&quot;) 'Gets data from CSV\n    counter = 1\n    For Each csvVal In LineItems\n        Debug.Print (csvVal)\n        tempXLFile.Worksheets(&quot;Sheet1&quot;).Cells(rowToFill, counter).Value = csvVal\n        counter = counter + 1\n    Next\n    row_number = row_number + 1\n    Exit Do\n  Loop\nClose #1\nEnd Sub\n\nSub vbaTest()\n  Call FillInExcelFromCSV(&quot;C:\\dataFrom.csv&quot;,&quot;C:\\dataTo.xlsx&quot;, 5)\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 173, "user_id": 7044405, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/f742859043d35ddb70d58dd4b5c0c582?s=128&d=identicon&r=PG&f=1", "display_name": "Navid", "link": "https://stackoverflow.com/users/7044405/navid"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1145, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1618492347, "creation_date": 1485375723, "question_id": 41860974, "link": "https://stackoverflow.com/questions/41860974/vba-copy-rows-from-csv-into-columns-in-new-worksheet", "title": "VBA: copy rows from csv into columns in new worksheet", "body": "<p>I am beginner in VBA and have to write a code that does the following:</p>\n\n<p>1- retrieve all csv files in a folder</p>\n\n<p>2- put the file names in first row of a new work sheet.</p>\n\n<p>3- copy all the Column titles(first row) from the csv files</p>\n\n<p>4- paste them in one column under each file name in new work sheet.</p>\n\n<p>I know I need to use range but I am confused how to use it.</p>\n\n<p>This is what I have done to get the csv files. I have problems with copying the rows into columns:</p>\n\n<pre><code>Dim CSVPath\nDim FS\nDim file\nDim wkb As Excel.Workbook\nDim ResultsSheet As Worksheet\nDim RowPtr As Range\nDim CSVUsed As Range\n\nSet ResultsSheet = Sheet1\n\n'Clear the results sheet\nResultsSheet.Cells.Delete\n\nSet FS = CreateObject(\"Scripting.FileSystemObject\")\n\n'The CSV files are stored in a \"CSV\" subfolder of the folder where\n'this workbook is stored.\nCSVPath = ThisWorkbook.Path &amp; \"\\CSV\"\n\nIf Not FS.FolderExists(CSVPath) Then\n    MsgBox \"CSV folder does not exist.\"\n    Exit Sub\nEnd If\n\nFor Each file In FS.GetFolder(CSVPath).Files\n    If Right(file.Name, 3) = \"csv\" Then 'Only look at files with .csv extension\n        Set wkb = Application.Workbooks.Open(file.Path)  \n\nNext\n</code></pre>\n\n<p>and also I know the loop should be something like this:</p>\n\n<pre><code>FinalRow = Cells(Rows.Count, 1).End(xlUp).Row \n\n   For x = 2 To FinalRow \n</code></pre>\n\n<p>any help is appreciated</p>\n"}, {"tags": ["excel", "ms-access", "vba"], "comments": [{"owner": {"reputation": 1540, "user_id": 7149748, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7517a3bbc9ae7afe5772ab3632edf5d?s=128&d=identicon&r=PG&f=1", "display_name": "Skippy", "link": "https://stackoverflow.com/users/7149748/skippy"}, "edited": false, "score": 0, "creation_date": 1485376620, "post_id": 41860933, "comment_id": 70906104, "body": "Just a thought - does your template already contain a (perhaps hidden) sheet called &quot;qryLineItemsExportBuffer&quot;?"}, {"owner": {"reputation": 31, "user_id": 7470812, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df25b63701239a128ffee2f15cfb828b?s=128&d=identicon&r=PG&f=1", "display_name": "mgzgrtn", "link": "https://stackoverflow.com/users/7470812/mgzgrtn"}, "reply_to_user": {"reputation": 1540, "user_id": 7149748, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7517a3bbc9ae7afe5772ab3632edf5d?s=128&d=identicon&r=PG&f=1", "display_name": "Skippy", "link": "https://stackoverflow.com/users/7149748/skippy"}, "edited": false, "score": 0, "creation_date": 1485376951, "post_id": 41860933, "comment_id": 70906277, "body": "It does contain a blank sheet with that name, yes. It must do so, because the other sheets in the workbook template have formulas which refer to the sheet, anticipating the input of data there. I cannot have those references without such a sheet present, however, otherwise I&#39;ll get #REF! errors."}, {"owner": {"reputation": 1540, "user_id": 7149748, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7517a3bbc9ae7afe5772ab3632edf5d?s=128&d=identicon&r=PG&f=1", "display_name": "Skippy", "link": "https://stackoverflow.com/users/7149748/skippy"}, "edited": false, "score": 0, "creation_date": 1485377467, "post_id": 41860933, "comment_id": 70906544, "body": "Oh yes, how stupid of me! In that case I&#39;m guessing that there must be some switch that determines whether your code tries to add data to an existing sheet or create a new sheet. You say you already have this working in another application. Is it the same versions of Access/Excel? Can you try substituting elements of the non-working system into the working one and vice versa to see whether the problem is with your Access code or the Excel template?"}, {"owner": {"reputation": 31, "user_id": 7470812, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df25b63701239a128ffee2f15cfb828b?s=128&d=identicon&r=PG&f=1", "display_name": "mgzgrtn", "link": "https://stackoverflow.com/users/7470812/mgzgrtn"}, "reply_to_user": {"reputation": 1540, "user_id": 7149748, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7517a3bbc9ae7afe5772ab3632edf5d?s=128&d=identicon&r=PG&f=1", "display_name": "Skippy", "link": "https://stackoverflow.com/users/7149748/skippy"}, "edited": false, "score": 0, "creation_date": 1485378322, "post_id": 41860933, "comment_id": 70906960, "body": "Hmm. So I had already tried making a blank template with the named sheet, and changing the name, and none of that worked. However, what did work just now was using the Excel template from the other application! It overwrites into the sheet correctly rather than making a new one. So I&#39;m looking through the old template trying to figure out where the difference in setting is, and cannot find it. I will keep looking."}, {"owner": {"reputation": 31, "user_id": 7470812, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df25b63701239a128ffee2f15cfb828b?s=128&d=identicon&r=PG&f=1", "display_name": "mgzgrtn", "link": "https://stackoverflow.com/users/7470812/mgzgrtn"}, "reply_to_user": {"reputation": 1540, "user_id": 7149748, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7517a3bbc9ae7afe5772ab3632edf5d?s=128&d=identicon&r=PG&f=1", "display_name": "Skippy", "link": "https://stackoverflow.com/users/7149748/skippy"}, "edited": false, "score": 0, "creation_date": 1485385883, "post_id": 41860933, "comment_id": 70910479, "body": "I kept digging deeper into the template sheet for the previous application - it turned out that there was a Excel named range that had the same name as the destination sheet and the generating query - so I had not noticed that it was exporting to the named range, not the sheet name or the query name! Thank you for the suggestion!"}, {"owner": {"reputation": 1540, "user_id": 7149748, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7517a3bbc9ae7afe5772ab3632edf5d?s=128&d=identicon&r=PG&f=1", "display_name": "Skippy", "link": "https://stackoverflow.com/users/7149748/skippy"}, "edited": false, "score": 0, "creation_date": 1485419827, "post_id": 41860933, "comment_id": 70921100, "body": "Great news, glad you found it. That&#39;s actually something I could use myself. I have previously got around this by assuming Access will create the new sheet; I then have code in my Excel &#39;template&#39; that looks for the new sheet, copies the data from this new sheet to a known location on a previously existing sheet (where all my references point to) and then deleting the new sheet. Next time this instance of the workbook is opened the new sheet doesn&#39;t exist any more so there&#39;s nothing to do."}, {"owner": {"reputation": 31, "user_id": 7470812, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df25b63701239a128ffee2f15cfb828b?s=128&d=identicon&r=PG&f=1", "display_name": "mgzgrtn", "link": "https://stackoverflow.com/users/7470812/mgzgrtn"}, "reply_to_user": {"reputation": 1540, "user_id": 7149748, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7517a3bbc9ae7afe5772ab3632edf5d?s=128&d=identicon&r=PG&f=1", "display_name": "Skippy", "link": "https://stackoverflow.com/users/7149748/skippy"}, "edited": false, "score": 0, "creation_date": 1485438427, "post_id": 41860933, "comment_id": 70931401, "body": "Yes, that&#39;s how I would have otherwise done it, but for end-user reasons I could not include any code in the Excel file itself."}], "answers": [{"tags": [], "owner": {"reputation": 31, "user_id": 7470812, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df25b63701239a128ffee2f15cfb828b?s=128&d=identicon&r=PG&f=1", "display_name": "mgzgrtn", "link": "https://stackoverflow.com/users/7470812/mgzgrtn"}, "is_accepted": false, "score": 3, "last_activity_date": 1485385782, "creation_date": 1485385782, "answer_id": 41863365, "question_id": 41860933, "link": "https://stackoverflow.com/questions/41860933/exporting-the-results-of-an-access-2013-select-query-into-an-excel-2013-sheet-wi/41863365#41863365", "title": "Exporting the results of an Access 2013 select query into an Excel 2013 sheet without creating a new worksheet or breaking references", "body": "<p>I've found the correct way to use the DoCmd.TransferSpreadsheet method to export the results of Access queries to a specific sheet or range in an Excel worksheet, without creating new sheets. <a href=\"https://msdn.microsoft.com/en-us/library/office/ff844793(v=office.15).aspx\" rel=\"nofollow noreferrer\" title=\"The documentation for this method\">The documentation for this method</a> strongly suggests that you cannot set a Range parameter for exports to Excel from Access, and I have not found any other sources online which mention this capability. But in fact, you can effectively set a destination range for DoCmd.TransferSpreadsheet by using Excel's Name Manager.</p>\n\n<p>Let's say we want to transfer the results of Access query 'qryItemsExport' to a sheet in a workbook, named 'DestinationWorkbook.xlsx', in the same folder as the Access database.</p>\n\n<p>First, go into the workbook's name manager and set a named range called 'qryItemsExport' where you'd like the data to go. Then, use the following VBA in the Access project:</p>\n\n<pre><code>Dim xlsxDestinationWorkbook as String\n\nxlsxDestinationWorkbook = Application.CurrentProject.Path &amp; \"\\\" &amp; \"DestinationWorkbook.xlsx\"\n\nDoCmd.TransferSpreadsheet acExport, acSpreadsheetTypeExcel12Xml, \"qryItemsExport\", xlsxDestinationWorkbook\n</code></pre>\n\n<p>The first line declares the workbook name variable as a string. The second line assigns the workbook name variable to the version currently in the same folder as the Access project. The third line exports the data from the query to the destination workbook, for an Excel 2010+ format. Because the command attempts to export to the destination 'qryItemsExport', this goes to the previously named range and places the data in that location, starting in the upper-left-hand-corner. It does not create new sheets or rename existing ones, so references to the sheet being copied to will stay intact.</p>\n"}], "owner": {"reputation": 31, "user_id": 7470812, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df25b63701239a128ffee2f15cfb828b?s=128&d=identicon&r=PG&f=1", "display_name": "mgzgrtn", "link": "https://stackoverflow.com/users/7470812/mgzgrtn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 679, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1485385782, "creation_date": 1485375548, "question_id": 41860933, "link": "https://stackoverflow.com/questions/41860933/exporting-the-results-of-an-access-2013-select-query-into-an-excel-2013-sheet-wi", "title": "Exporting the results of an Access 2013 select query into an Excel 2013 sheet without creating a new worksheet or breaking references", "body": "<p>This problem is fairly simple but it's baffling me, especially since this code works perfectly fine in a different application I have made, so I suspect there is some hidden setting somewhere that's causing the problem.</p>\n\n<p>I need to transfer the results of an Access select query into a copy of a template Excel sheet. This template has a few other sheets in it that refer to the sheet that will receive the Access query data, which then do some formatting and calculations with it. All I need is for this single query's results to be transferred to the correct sheet, with no formatting or anything. Overwriting the whole sheet is fine too.</p>\n\n<p>My problem is that, instead of copying to the sheet \"qryLineItemsExportBuffer\", it creates a <em>new</em> sheet, named \"qryLineItemsExportBuffer1\" and puts the query results there - so all the references in the workbook are looking in the wrong place. I also cannot use the DoCmd.TransferSpreadsheet [Range] parameter to define a destination sheet, <a href=\"https://msdn.microsoft.com/en-us/library/office/ff844793(v=office.15).aspx\" rel=\"nofollow noreferrer\" title=\"this does not work when exporting, only while importing.\">because this does not work when exporting, only while importing.</a></p>\n\n<p>Here is my code - it 1. opens the template, 2. saves a copy with a new name, 3. transfers the query result, and then 4. opens the copy and recalculates/rebuilds links:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Private Sub cmdExportInvoiceRequestForm_Click()\n\nDim instExcelTemplate As Object\nDim xlsxInvoiceRequestTemplate As Excel.Workbook\nDim xlsxInvoiceRequestNewName As String\nDim xlsxInvoiceRequestCopy As Excel.Workbook\n\n    xlsxInvoiceRequestNewName = Application.CurrentProject.Path &amp; \"\\\" &amp; CustomerName &amp; \"-InvoiceRequest-\" &amp; Format(Date, \"dd-mm-yyyy\") &amp; \".xlsx\" 'create the name for the new invoice report\n    MsgBox xlsxInvoiceRequestNewName 'user is shown the name and date\n    MsgBox Application.CurrentProject.Path 'user is shown the destination folder\n\n    'start an Excel instance and open the template workbook.\n    Set instExcelTemplate = CreateObject(\"Excel.Application\")\n    Set xlsxInvoiceRequestTemplate = instExcelTemplate.Workbooks.Open(Application.CurrentProject.Path &amp; \"\\Templates\\CustomerInvoiceRequestFormTemplate.xlsx\") 'open the invoice report template\n    xlsxInvoiceRequestTemplate.SaveAs FileName:=(xlsxInvoiceRequestNewName) 'save the template as a new file in the correct directory\n    instExcelTemplate.Workbooks.Close 'close the Excel instance.\n\n    'transfer the qryLineItemsExportBuffer results to the newly created workbook.\n    DoCmd.TransferSpreadsheet acExport, 10, \"qryLineItemsExportBuffer\", xlsxInvoiceRequestNewName\n    'start an excel instance and open the new workbook.\n    Set instExcelCopy = CreateObject(\"Excel.Application\")\n    Set xlsxInvoiceRequestCopy = instExcelCopy.Workbooks.Open(xlsxInvoiceRequestNewName)\n    instExcelCopy.CalculateFullRebuild 'recalculate all values and rebuild links in the workbook. This is necessary because it does not do this when opened manually. Can be done in Excel with CTRL+SHIFT+ALT+F9.\n    xlsxInvoiceRequestCopy.Save 'save the copy\n    instExcelCopy.Workbooks.Close 'close the Excel instance.\n    Set xlsxInvoiceRequestCopy = Nothing\n    Set instExcelCopy = Nothing\n    xlsxInvoiceRequestNewName = \"\"\n\n\nEnd Sub\n</code></pre>\n\n<p>I also cannot put any code into the Excel template itself, so I can't make it copy the data over from the new sheet.</p>\n\n<p>What am I missing?</p>\n"}, {"tags": ["excel", "ie-automation", "vba"], "comments": [{"owner": {"reputation": 14064, "user_id": 765395, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Xc817.png?s=128&g=1", "display_name": "Robin Mackenzie", "link": "https://stackoverflow.com/users/765395/robin-mackenzie"}, "edited": false, "score": 0, "creation_date": 1485430411, "post_id": 41860876, "comment_id": 70926679, "body": "Suggest you go here: <a href=\"https://validator.w3.org/check\" rel=\"nofollow noreferrer\">validator.w3.org/check</a> and paste in the HTML you posted. It is invalid - <code>12 Errors, 9 warning(s)</code> is what I get."}, {"owner": {"reputation": 55, "user_id": 7175240, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/447d0d6c91dd774709b3bf0bb4d88d58?s=128&d=identicon&r=PG&f=1", "display_name": "TMc", "link": "https://stackoverflow.com/users/7175240/tmc"}, "reply_to_user": {"reputation": 14064, "user_id": 765395, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Xc817.png?s=128&g=1", "display_name": "Robin Mackenzie", "link": "https://stackoverflow.com/users/765395/robin-mackenzie"}, "edited": false, "score": 0, "creation_date": 1485555350, "post_id": 41860876, "comment_id": 70990312, "body": "Robin, thanks for the feedback. The HTML I posted is a portion of a much larger page so I am not surprised it does not pass a validity check. My question has more to do with the accuracy of the VBA code than the accuracy of the HTML."}, {"owner": {"reputation": 14064, "user_id": 765395, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Xc817.png?s=128&g=1", "display_name": "Robin Mackenzie", "link": "https://stackoverflow.com/users/765395/robin-mackenzie"}, "edited": false, "score": 0, "creation_date": 1485558795, "post_id": 41860876, "comment_id": 70991503, "body": "Invalid markup may prevent the DOM being parsed. Suggest you test your code on a valid page first"}], "owner": {"reputation": 55, "user_id": 7175240, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/447d0d6c91dd774709b3bf0bb4d88d58?s=128&d=identicon&r=PG&f=1", "display_name": "TMc", "link": "https://stackoverflow.com/users/7175240/tmc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 894, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1511534516, "creation_date": 1485375344, "last_edit_date": 1531164843, "question_id": 41860876, "link": "https://stackoverflow.com/questions/41860876/ie-automation-with-excel-vba-iframes", "title": "IE Automation with Excel VBA - iframes", "body": "<p>I have had success recently, with the help of this forum, automating IE with Excel VBA. Today, however, I am stuck on a new problem and could use some help. I am trying to click on a hyperlink that will take you to a new page on the web site. I believe the hyperlink (id=\"page2\") is contained in an iframe but I don't know how to access it.</p>\n\n<p>Here is the relevant HTML:</p>\n\n<pre><code>&lt;frame id=\"workspaceFrame\" name=\"workspaceFrame\" frameborder=\"0\" marginheight=\"0\" marginwidth=\"0\" noresize=\"\" src=\"home.aspx\"&gt;\n&lt;!DOCTYPE html PUBLIC \"-//W3C//DTD HTML 4.0 Transitional//EN\"&gt;\n&lt;html&gt;\n&lt;head&gt;\n&lt;body leftmargin=\"0\" rightmargin=\"0\" topmargin=\"0\" bottommargin=\"0\" scroll=\"no\"&gt;\n&lt;form id=\"_ctl0\" name=\"_ctl0\" method=\"post\" action=\"listingframes.aspx?isContentSearch=\" style=\"margin:0px;\"&gt;\n&lt;table class=\"list\" style=\"WIDTH: 100%; HEIGHT: 100%\" cellspacing=\"0\" cellpadding=\"0\" border=\"0\"&gt;\n&lt;tbody&gt;\n&lt;tr&gt;\n&lt;tr height=\"100%\"&gt;\n&lt;td&gt;\n&lt;iframe id=\"listingframe\" name=\"listingframe\" src=\"listingredirect.aspx\" marginheight=\"0\" marginwidth=\"0\" scrolling=\"auto\" width=\"100%\" height=\"100%\" frameborder=\"0\"&gt;\n&lt;!DOCTYPE html PUBLIC \"-//W3C//DTD HTML 4.0 Transitional//EN\"&gt;\n&lt;html xmlns:boe=\"\"&gt;\n&lt;head&gt;\n&lt;body onload=\"onLoad()\" style=\"MARGIN: 0px\" ms_positioning=\"FlowLayout\"&gt;\n&lt;form id=\"Form1\" name=\"Form1\" method=\"post\" action=\"listing.aspx?listingparentid=1541&amp;showfolders=true\"&gt;\n&lt;input name=\"__EVENTTARGET\" value=\"\" type=\"hidden\"&gt;\n&lt;input name=\"__EVENTARGUMENT\" value=\"\" type=\"hidden\"&gt;\n&lt;input name=\"__VIEWSTATE\" value=\"\" type=\"hidden\"&gt;\n&lt;script language=\"javascript\" type=\"text/javascript\"&gt;\n&lt;script language=\"javascript\"&gt;\n&lt;script language=\"javascript\"&gt;\n&lt;input id=\"listingparentid\" name=\"listingparentid\" type=\"hidden\"&gt;\n&lt;input id=\"search\" name=\"search\" type=\"hidden\"&gt;\n&lt;input id=\"searchType\" name=\"searchType\" type=\"hidden\"&gt;\n&lt;input id=\"searchText\" name=\"searchText\" type=\"hidden\"&gt;\n&lt;input id=\"filterType\" name=\"filterType\" type=\"hidden\"&gt;\n&lt;input id=\"advancedSearch\" name=\"advancedSearch\" type=\"hidden\"&gt;\n&lt;input id=\"selectedItems\" name=\"selectedItems\" type=\"hidden\"&gt;\n&lt;input id=\"command\" name=\"command\" type=\"hidden\"&gt;\n&lt;input id=\"sortby\" name=\"sortby\" type=\"hidden\"&gt;\n&lt;input id=\"markObj\" name=\"markObj\" type=\"hidden\"&gt;\n&lt;script language=\"javascript\"&gt;\n&lt;a id=\"MarkAsReadLinkButton\" href=\"javascript:__doPostBack('MarkAsReadLinkButton','')\" style=\"display:none\"&gt;&lt;/a&gt;\n&lt;a id=\"MarkAsUnreadLinkButton\" href=\"javascript:__doPostBack('MarkAsUnreadLinkButton','')\" style=\"display:none\"&gt;&lt;/a&gt;\n&lt;table width=\"100%\" cellspacing=\"0\" cellpadding=\"0\" border=\"0\"&gt;\n&lt;tbody&gt;\n&lt;tr class=\"reportTitlebar\"&gt;\n&lt;tr&gt;\n&lt;td class=\"main\" headers=\"tr_1 h_select\" width=\"24px\" align=\"center\"&gt;\n&lt;td class=\"main\" headers=\"tr_1 h_doctype\" width=\"24px\" align=\"center\"&gt;\n&lt;td class=\"main\" headers=\"tr_1 h_toggle\" width=\"24px\" align=\"center\"&gt;\n&lt;td class=\"list\"&gt; &lt;/td&gt;\n&lt;td id=\"tr_1\" class=\"main\" headers=\"h_title\"&gt;\n&lt;a class=\"list\" href=\"javascript:gotoAction(\"Report/report_view.aspx?id=933&amp;reportNumber=933&amp;reportType=CrystalEnterprise.Report&amp;windowProperty=fullscreen=yes,location=no,scrollbars=yes,menubars=no,toolbars=no,resizable=yes\",933,true,\"iv\",\"fullscreen=yes,location=no,scrollbars=yes,menubars=no,toolbars=no,resizable=yes\",\"\");\"&gt;102_RM TSM Invoiced-Sales Report with Customer.rpt&lt;/a&gt;\n&lt;/td&gt;\n&lt;td class=\"list\"&gt; &lt;/td&gt;\n&lt;td class=\"main\" headers=\"tr_1 h_lastrun\"&gt;Never run&lt;/td&gt;\n&lt;td class=\"list\"&gt; &lt;/td&gt;\n&lt;td class=\"main\" headers=\"tr_1 h_doctype\"&gt;Crystal Report&lt;/td&gt;\n&lt;td class=\"list\"&gt; &lt;/td&gt;\n&lt;td class=\"main\" headers=\"tr_1 h_owner\"&gt;Administrator&lt;/td&gt;\n&lt;td class=\"list\"&gt; &lt;/td&gt;\n&lt;td class=\"main\" headers=\"tr_1 h_instances\"&gt;0&lt;/td&gt;\n&lt;/tr&gt;\n&lt;tr&gt;\n&lt;tr&gt;\n&lt;tr&gt;\n&lt;tr&gt;\n&lt;tr&gt;\n&lt;tr&gt;\n&lt;tr&gt;\n&lt;tr&gt;\n&lt;tr&gt;\n&lt;tr&gt;\n&lt;tr&gt;\n&lt;tr&gt;\n&lt;tr&gt;\n&lt;tr&gt;\n&lt;tr&gt;\n&lt;tr&gt;\n&lt;tr&gt;\n&lt;tr&gt;\n&lt;tr&gt;\n&lt;tr&gt;\n&lt;tr&gt;\n&lt;tr&gt;\n&lt;tr&gt;\n&lt;tr&gt;\n&lt;tr&gt;\n&lt;tr&gt;\n&lt;tr&gt;\n&lt;tr&gt;\n&lt;tr&gt;\n&lt;tr&gt;\n&lt;tr&gt;\n&lt;tr&gt;\n&lt;tr&gt;\n&lt;tr&gt;\n&lt;tr&gt;\n&lt;tr&gt;\n&lt;tr&gt;\n&lt;tr&gt;\n&lt;tr&gt;\n&lt;/tbody&gt;\n&lt;/table&gt;\n&lt;p align=\"right\"&gt;\n&lt;a id=\"page1\" class=\"listSelected\" disabled=\"disabled\" onclick=\"if(typeof(changePage) != 'undefined') changePage(1)\"&gt;1&lt;/a&gt;\n&lt;a id=\"page2\" class=\"list\" onclick=\"if(typeof(changePage) != 'undefined') changePage(2)\" href=\"javascript:__doPostBack('page2','')\"&gt;2&lt;/a&gt;\n</code></pre>\n\n<p>The relevant vba code is as follows along with what I have tried so far and the corresponding error. Through trial and error, I found out that the sub-frame I'm interested in is located at: Frames(0).Frames(0).Frames(1).Frames(1)</p>\n\n<pre><code>Dim Window          As MSHTML.IHTMLWindow2\nDim button          As HTMLInputButtonElement\nDim iFrame          As HTMLIFrame\nDim ieApp           As SHDocVw.InternetExplorer\nDim ieDoc           As MSHTML.HTMLDocument\nDim button          As HTMLInputButtonElement\nDim div             As HTMLDivElement\n\n' Create a new instance of IE\n    Set ieApp = New InternetExplorer\n\n' Uncomment this line for debugging purposes.\n    ieApp.Visible = True\n' Go to the page we're interested in.\n    ieApp.Navigate \"MyURL.com\"\n\n\n    Do While ieApp.Busy: DoEvents: Loop\n    Do Until ieApp.ReadyState = READYSTATE_COMPLETE: DoEvents: Loop\n\n    Set ieDoc = ieApp.Document\n\n' Try #1\n' Error: Automation error\n    Set Window = ieDoc.Frames(0).Frames(0).Frames(1).Frames(1)\n    Call Window.execScript(\"__doPostBack('page2','');\", \"JavaScript\")\n\n' Try #2\n' Error: Object variable or With block variable not set\n    Set button = ieDoc.getElementById(\"page2\")\n    button.Click\n\n' Try #3\n' Error: Automation error\n    Set Window = ieDoc.Frames(0).Frames(0).Frames(1).Frames(1)(\"listingframe\")\n    Call Window.execScript(\"__doPostBack('page2','');\", \"JavaScript\")\n</code></pre>\n\n<p>Any thoughts on what I might be doing wrong or other suggestions would greatly be appreciated.</p>\n\n<p>TMc</p>\n"}, {"tags": ["vba", "excel-2010"], "answers": [{"tags": [], "owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "is_accepted": false, "score": 1, "last_activity_date": 1485396240, "last_edit_date": 1485396240, "creation_date": 1485394810, "answer_id": 41864668, "question_id": 41860832, "link": "https://stackoverflow.com/questions/41860832/find-do-loop-excel-2010/41864668#41864668", "title": "Find/Do Loop - Excel 2010", "body": "<p>The following achieves the loop for the first part of your code. I have no clue what you are trying to do next. Don't forget to set the source sheet's name where indicated.</p>\n\n<pre><code>Dim r As Range, first As Range, x As Range\nSet r = Sheets(\"source\").Range(\"J28:J115\") ' &lt;-- set the name to your source sheet\nSet first = r.Find(\"spike\", r(1, 1), xlValues, xlWhole, xlByRows, xlNext, False, False)\nIf Not first Is Nothing Then\n    Set x = first\n    Do\n        Sheets(\"Spike\").Range(\"B\" &amp; Rows.Count).End(xlUp).Offset(1).Value = x.offset(, -8).Value\n\n        Set x = r.FindNext(x) ' , xlValues, xlWhole, xlByRows, xlNext)\n    Loop Until x.Address = first.Address\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 7470961, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dbfcc8d4ae6a61dcf3a51c88c67ea35d?s=128&d=identicon&r=PG&f=1", "display_name": "K Scott", "link": "https://stackoverflow.com/users/7470961/k-scott"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 33, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1485396240, "creation_date": 1485375241, "question_id": 41860832, "link": "https://stackoverflow.com/questions/41860832/find-do-loop-excel-2010", "title": "Find/Do Loop - Excel 2010", "body": "<p>I would like to use the find/do function to find the word Spike within range J28:J115.  When it is found, two values are obtained and pasted into another worksheet.  I want it to look for the word, place the values, and then look for the word again until all values have been placed.</p>\n\n<p>Here is my code so far.</p>\n\n<pre><code>' Find Spike Sample Name, paste in QAQC file'\n\n    Windows(\"a\").Activate\n    Range(\"J28:J115\").Select\n    Selection.Find(What:=\"spike\", After:=ActiveCell, LookIn:=xlFormulas, _\n    LookAt:=xlPart, SearchOrder:=xlByRows, SearchDirection:=xlNext, _\n    MatchCase:=False, SearchFormat:=False).Activate\n    ActiveCell.Offset(0, -8).Select\n    Selection.Copy\n    Windows(\"b\").Activate\n    Sheets(\"Spike\").Select\n    Range(\"B\" &amp; Rows.Count).End(xlUp).Offset(1).Select\n    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n    :=False, Transpose:=False\n\n'Copy Sample Value, paste in QAQC file'\n    Windows(\"Macro 20170113 NH3 BP Jan13 Stan Jan9 with smp blk JZ.xlsx\").Activate\n    Range(\"J28:J115\").Select\n    Selection.Find(What:=\"spike\", After:=ActiveCell, LookIn:=xlFormulas, _\n    LookAt:=xlPart, SearchOrder:=xlByRows, SearchDirection:=xlNext, _\n    MatchCase:=False, SearchFormat:=False).Activate\n    ActiveCell.Offset(0, 1).Select\n    Selection.Copy\n    Windows(\"Macro Ammonia QA-QC Chart 20161104.xlsx\").Activate\n    Range(\"C\" &amp; Rows.Count).End(xlUp).Offset(1).Select\n    Selection.PasteSpecial Paste:=xlPasteValuesAndNumberFormats, Operation:=xlNone, SkipBlanks _\n    :=False, Transpose:=False\n    Selection.NumberFormat = \"0.0\"\n    ActiveCell = ActiveCell * 100\n</code></pre>\n"}, {"tags": ["vba", "excel", "loops"], "comments": [{"owner": {"reputation": 3, "user_id": 7470927, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0aef93956d875ed556b00dace31439ca?s=128&d=identicon&r=PG&f=1", "display_name": "Jomunjie", "link": "https://stackoverflow.com/users/7470927/jomunjie"}, "edited": false, "score": 0, "creation_date": 1485377307, "post_id": 41860749, "comment_id": 70906469, "body": "Thanks for the link to the previously answered question.  I tried adjusting my code to match what was posted, but all it does is continue to loop the same &quot; &#39;do something&quot; in the same worksheet, and still does not select or loop through the remaining worksheets.  Updated code on original posting.  Any suggestions?"}, {"owner": {"reputation": 1018, "user_id": 6706734, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/89cf86a3fd50974771d8041b8f13e5b0?s=128&d=identicon&r=PG&f=1", "display_name": "J_Lard", "link": "https://stackoverflow.com/users/6706734/j-lard"}, "edited": false, "score": 0, "creation_date": 1485378295, "post_id": 41860749, "comment_id": 70906944, "body": "You need to add a <code>.</code> in front of the <code>Rows</code>, <code>Range</code>, <code>Cells</code>, etc. calls. Otherwise you&#39;re just modifying the current &quot;active sheet&quot;. So the first line after the <code>With</code> statement would be <code>.Rows(&quot;1:6&quot;).Select</code>."}, {"owner": {"reputation": 3, "user_id": 7470927, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0aef93956d875ed556b00dace31439ca?s=128&d=identicon&r=PG&f=1", "display_name": "Jomunjie", "link": "https://stackoverflow.com/users/7470927/jomunjie"}, "reply_to_user": {"reputation": 1018, "user_id": 6706734, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/89cf86a3fd50974771d8041b8f13e5b0?s=128&d=identicon&r=PG&f=1", "display_name": "J_Lard", "link": "https://stackoverflow.com/users/6706734/j-lard"}, "edited": false, "score": 0, "creation_date": 1485378921, "post_id": 41860749, "comment_id": 70907272, "body": "Gave that a shot.  The code is now recognizing the number of sheets I have in my workbook, but still repeating the same code on only the first worksheet.  So it knows there are nine total sheets, and continues to repeat the code nine times on the same worksheet.  With the dots (.) inserted after each call command, it gives me an error after completing the code one time.      Tells me &quot;Select method of Range class failed&quot;, when it hits &quot;.rows(&quot;1:6&quot;).Select&quot;.  Some progress?"}, {"owner": {"reputation": 1018, "user_id": 6706734, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/89cf86a3fd50974771d8041b8f13e5b0?s=128&d=identicon&r=PG&f=1", "display_name": "J_Lard", "link": "https://stackoverflow.com/users/6706734/j-lard"}, "edited": false, "score": 0, "creation_date": 1485380744, "post_id": 41860749, "comment_id": 70908172, "body": "Try doing this: <code>Dim ws as Worksheet</code>, <code>For Each ws In ThisWorkbook.Sheets</code>, <code>With ws</code>, <code>.Rows(&quot;1:6&quot;).Insert Shift:=xlDown</code>, <code>.Range(&quot;K3:Q3&quot;).Value = .Range(&quot;K7:Q7&quot;).Value</code>... and so on. Try to avoid using <code>Select</code> or <code>Activate</code> where you can."}, {"owner": {"reputation": 3, "user_id": 7470927, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0aef93956d875ed556b00dace31439ca?s=128&d=identicon&r=PG&f=1", "display_name": "Jomunjie", "link": "https://stackoverflow.com/users/7470927/jomunjie"}, "reply_to_user": {"reputation": 1018, "user_id": 6706734, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/89cf86a3fd50974771d8041b8f13e5b0?s=128&d=identicon&r=PG&f=1", "display_name": "J_Lard", "link": "https://stackoverflow.com/users/6706734/j-lard"}, "edited": false, "score": 0, "creation_date": 1485382323, "post_id": 41860749, "comment_id": 70908968, "body": "Thanks J_Lard.  This still didn&#39;t make much of a difference.  I am going bonkers as to why my code will not cycle through each worksheet.  It doesn&#39;t make sense to me.   After it cycles through the &quot;End With&quot;, &quot;Next iIndex&quot;, it just goes to end sub.  Even when i try the For Each ws In ThisWorkbook.Sheets, With ws it just goes to &lt;!--end sub --&gt;"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1485415852, "post_id": 41860749, "comment_id": 70919294, "body": "What type of code module is the code in, and is it in the same workbook as the sheets you want to loop over?"}, {"owner": {"reputation": 3, "user_id": 7470927, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0aef93956d875ed556b00dace31439ca?s=128&d=identicon&r=PG&f=1", "display_name": "Jomunjie", "link": "https://stackoverflow.com/users/7470927/jomunjie"}, "edited": false, "score": 0, "creation_date": 1485438183, "post_id": 41860749, "comment_id": 70931246, "body": "It is not, it is in a module within my personal macro library.  I attempted to copy the macro to the workbook itself, but still no change.  I&#39;m at a loss here.  This should be simple, i&#39;m sure of it, but this just wont work!"}, {"owner": {"reputation": 3, "user_id": 7470927, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0aef93956d875ed556b00dace31439ca?s=128&d=identicon&r=PG&f=1", "display_name": "Jomunjie", "link": "https://stackoverflow.com/users/7470927/jomunjie"}, "edited": false, "score": 0, "creation_date": 1485441959, "post_id": 41860749, "comment_id": 70933810, "body": "Scratch my last comment.  Moving the code to a module directly attached to the spreadsheet I&#39;m working on fixes the problem, and it now loops through each worksheet.  Why does this not work when saved within my personal macro workbook?"}], "owner": {"reputation": 3, "user_id": 7470927, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0aef93956d875ed556b00dace31439ca?s=128&d=identicon&r=PG&f=1", "display_name": "Jomunjie", "link": "https://stackoverflow.com/users/7470927/jomunjie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 53, "favorite_count": 0, "closed_date": 1485375058, "answer_count": 0, "score": 0, "last_activity_date": 1505081083, "creation_date": 1485374963, "last_edit_date": 1505081083, "question_id": 41860749, "link": "https://stackoverflow.com/questions/41860749/vba-for-loop-not-looping-through-spreadsheets", "closed_reason": "Duplicate", "title": "VBA For Loop, Not Looping Through Spreadsheets", "body": "<p>Updated code based on recommended solution, still does not work.  Only loops through same worksheet.</p>\n\n<p>Updated code now shown below.</p>\n\n<p>I am pulling my hair out here!  I am trying to create a simple look, my first attempt ever, that will add rows to the top of my data, insert sum totals, resize the columns, and then move on to the next worksheet.  Everything works perfect, except when it comes to going to the next worksheet.</p>\n\n<p>Depending on how I have the code written, it either recycles the same process into the same worksheet, or simply ends after completing the process on the current worksheet.  I've tried about ten different wants, and no matter what I do, it doesnt work.</p>\n\n<p>The crazy thing is, I copy and past an identical code into a new module, and it works perfect!</p>\n\n<p>I dont understand where I am going wrong.  Couple of things, the macro is saved in my personal workbook, but moving it to the current workbook doesnt fix the problem.  Also, the tabs of each worksheet have unique names, so something like, Company 1, company 2... and so on, for about ten companies.</p>\n\n<p>Here is the code, please tell me I'm not crazy here!</p>\n\n<pre><code>Sub WorksheetLoop()\n\n' Loop Through Worksheets, Add Totals\n\nDim WS As Excel.Worksheet\nDim iIndex As Integer\nDim LastRow As Long\n\n' = Loop Sum Formula Through All Worksheets\n\n    For iIndex = 1 To ActiveWorkbook.Worksheets.Count\n        Set WS = Worksheets(iIndex)\n        With WS\n\n        Rows(\"1:6\").Select\n        Selection.Insert Shift:=xlDown\n\n        Range(\"K7:Q7\").Select\n        Selection.Copy\n        Range(\"K3\").Select\n        ActiveSheet.Paste\n\n        LastRow = Range(\"A20000\").End(xlUp).Row\n\n        Range(\"K4\").Select\n        ActiveCell.Formula = \"=Sum(K8:K\" &amp; LastRow &amp; \")\"\n\n        Range(\"K4:Q4\").Select\n        Selection.FillRight\n\n        Range(\"K:Q\").Select\n        Cells.EntireColumn.AutoFit\n\n        Range(\"A1\").Select\n\n        End With\n\n    Next iIndex\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1485374955, "post_id": 41860704, "comment_id": 70905176, "body": "You will need to use Worksheet_Calculate() event.  Though <code>Target</code> is not a part of this event and will need to change the code slightly."}, {"owner": {"reputation": 113, "user_id": 6754729, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87fa46c83c3426d52f58979d9fa9bb64?s=128&d=identicon&r=PG", "display_name": "brink", "link": "https://stackoverflow.com/users/6754729/brink"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1485387887, "post_id": 41860704, "comment_id": 70911106, "body": "Thanks @ScottCraner.  Could you be a little more in depth than that?  I don&#39;t know much about writing vba code."}], "answers": [{"comments": [{"owner": {"reputation": 113, "user_id": 6754729, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87fa46c83c3426d52f58979d9fa9bb64?s=128&d=identicon&r=PG", "display_name": "brink", "link": "https://stackoverflow.com/users/6754729/brink"}, "edited": false, "score": 0, "creation_date": 1598637007, "post_id": 63607670, "comment_id": 112533930, "body": "I&#39;ll give this a try though I found a work around by adding a sort button to the sheet and I use that when I need the data sorted."}], "tags": [], "owner": {"reputation": 1322, "user_id": 13702221, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/db04aaa022f6f19b0d675af8672fde95?s=128&d=identicon&r=PG", "display_name": "RetiredGeek", "link": "https://stackoverflow.com/users/13702221/retiredgeek"}, "is_accepted": false, "score": 0, "last_activity_date": 1598489719, "creation_date": 1598489719, "answer_id": 63607670, "question_id": 41860704, "link": "https://stackoverflow.com/questions/41860704/vba-that-will-auto-sort-a-column-containing-formulas-in-the-cells/63607670#63607670", "title": "VBA that will auto sort a column containing formulas in the cells?", "body": "<p>Brink,</p>\n<p>You need to provide sort a little more information and you don't want to check on column D for changes, rather check the columns it depends on for its input (B &amp; C).</p>\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n \n  Dim lLastRow As Long\n  \n  If Not Intersect(Target, Range(&quot;B:C&quot;)) Is Nothing Then\n  \n    lLastRow = [A1].End(xlDown).Row\n  \n    With ActiveWorkbook.Worksheets(&quot;Sheet1&quot;).Sort\n        .SortFields.Clear\n        .SortFields.Add2 Key:=Range(&quot;D1:D&quot; &amp; lLastRow), _\n          SortOn:=xlSortOnValues, _\n          Order:=xlAscending, _\n          DataOption:=xlSortNormal\n        .SetRange Range(&quot;A1:D&quot; &amp; lLastRow)\n        .Header = xlYes\n        .MatchCase = False\n        .Orientation = xlTopToBottom\n        .SortMethod = xlPinYin\n        .Apply\n    End With\n    \n  End If\n    \nEnd Sub 'Worksheet_Change\n</code></pre>\n<p>HTH</p>\n<p><a href=\"https://i.stack.imgur.com/30jb3.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/30jb3.jpg\" alt=\"enter image description here\" /></a></p>\n"}], "owner": {"reputation": 113, "user_id": 6754729, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87fa46c83c3426d52f58979d9fa9bb64?s=128&d=identicon&r=PG", "display_name": "brink", "link": "https://stackoverflow.com/users/6754729/brink"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 353, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1598489719, "creation_date": 1485374826, "last_edit_date": 1485375093, "question_id": 41860704, "link": "https://stackoverflow.com/questions/41860704/vba-that-will-auto-sort-a-column-containing-formulas-in-the-cells", "title": "VBA that will auto sort a column containing formulas in the cells?", "body": "<p>I have a column (D) that's calculating the average of the two columns next to it (B, C). I need to auto sort the result of the formula in column D in decending order when ever a change is made to B or C. Column D cells contain the formula =IFERROR(C2/B2,0)</p>\n\n<p>B and C are updated via a formula that adds data from another sheet.</p>\n\n<pre><code>a       b   c   d\n5L2R    1   0   0%  \n5R2T    2   0   0%  \n5P1V    1   1   100%    \n611Q    1   1   100%    \n5I31    1   1   100%    \n5N32    1   1   100%    \n642O    1   1   100%    \n</code></pre>\n\n<p>I tried various different code from other similar posts but nothing is working.</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\nOn Error Resume Next\nIf Not Intersect(Target, Range(\"D:D\")) Is Nothing Then\nRange(\"D1\").Sort Key1:=Range(\"D2\"), _\nOrder1:=xlAscending, Header:=xlYes, _\nOrderCustom:=1, MatchCase:=False, _\nOrientation:=xlTopToBottom\nEnd If\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "web-services"], "comments": [{"owner": {"reputation": 2478, "user_id": 6110371, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/O93Qp.jpg?s=128&g=1", "display_name": "VBA Pete", "link": "https://stackoverflow.com/users/6110371/vba-pete"}, "edited": false, "score": 0, "creation_date": 1485374401, "post_id": 41860538, "comment_id": 70904878, "body": "What is your question? Does the code return an error?"}, {"owner": {"reputation": 17, "user_id": 3121549, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9065dc6d6ffd48b4a1f2f0b4cf8d4ea8?s=128&d=identicon&r=PG&f=1", "display_name": "FaizanRoshan", "link": "https://stackoverflow.com/users/3121549/faizanroshan"}, "reply_to_user": {"reputation": 2478, "user_id": 6110371, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/O93Qp.jpg?s=128&g=1", "display_name": "VBA Pete", "link": "https://stackoverflow.com/users/6110371/vba-pete"}, "edited": false, "score": 0, "creation_date": 1485416788, "post_id": 41860538, "comment_id": 70919628, "body": "If i use all header name in code then code is too long i need to make it as short as possible. so that i i enter all header name in single line code. so that i will not set all header name for find. It will make loop to make it short. but i don&#39;t know how to make it short"}, {"owner": {"reputation": 2478, "user_id": 6110371, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/O93Qp.jpg?s=128&g=1", "display_name": "VBA Pete", "link": "https://stackoverflow.com/users/6110371/vba-pete"}, "edited": false, "score": 0, "creation_date": 1485448958, "post_id": 41860538, "comment_id": 70939098, "body": "I just posted an answer. Let me know if it helps."}], "answers": [{"comments": [{"owner": {"reputation": 17, "user_id": 3121549, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9065dc6d6ffd48b4a1f2f0b4cf8d4ea8?s=128&d=identicon&r=PG&f=1", "display_name": "FaizanRoshan", "link": "https://stackoverflow.com/users/3121549/faizanroshan"}, "edited": false, "score": 0, "creation_date": 1485971016, "post_id": 41878548, "comment_id": 71150147, "body": "Thank You for Help"}, {"owner": {"reputation": 2478, "user_id": 6110371, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/O93Qp.jpg?s=128&g=1", "display_name": "VBA Pete", "link": "https://stackoverflow.com/users/6110371/vba-pete"}, "reply_to_user": {"reputation": 17, "user_id": 3121549, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9065dc6d6ffd48b4a1f2f0b4cf8d4ea8?s=128&d=identicon&r=PG&f=1", "display_name": "FaizanRoshan", "link": "https://stackoverflow.com/users/3121549/faizanroshan"}, "edited": false, "score": 0, "creation_date": 1485971289, "post_id": 41878548, "comment_id": 71150311, "body": "@FaizanRoshan No problem. Don&#39;t forget to tick the answer button, if my answer worked for you."}], "tags": [], "owner": {"reputation": 2478, "user_id": 6110371, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/O93Qp.jpg?s=128&g=1", "display_name": "VBA Pete", "link": "https://stackoverflow.com/users/6110371/vba-pete"}, "is_accepted": true, "score": 0, "last_activity_date": 1485448892, "creation_date": 1485448892, "answer_id": 41878548, "question_id": 41860538, "link": "https://stackoverflow.com/questions/41860538/vba-to-copy-data-with-name-of-header-from-ws1-to-ws2/41878548#41878548", "title": "Vba to copy data with name of header from ws1 to ws2", "body": "<p>Let me know if the following loop, the runs through the filter, works for you: </p>\n\n<pre><code>Sub FilterData()\n    Dim Header As Variant\n    Dim x As Long, i As Long\n    Dim FromColumn As Range\n\n    Header = Array(\"Name\", \"Date\", \"Num\", \"Item\", \"Qty\", \"Sales Price\", \"Amount\")\n\n    x = 1\n\n    For i = LBound(Header) To UBound(Header)\n        With ThisWorkbook.Sheets(\"RawData\").Rows(1)\n            Set FromColumn = .Find(Header(i), after:=.Cells(1, 1), MatchCase:=False)\n        End With\n\n        If Not FromColumn Is Nothing Then\n            FromColumn.EntireColumn.Copy Destination:=Sheets(\"Filter Data\").Cells(1, x)\n\n        x = x + 1\n        End If\n    Next i\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 17, "user_id": 3121549, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9065dc6d6ffd48b4a1f2f0b4cf8d4ea8?s=128&d=identicon&r=PG&f=1", "display_name": "FaizanRoshan", "link": "https://stackoverflow.com/users/3121549/faizanroshan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 247, "favorite_count": 0, "accepted_answer_id": 41878548, "answer_count": 1, "score": 0, "last_activity_date": 1485448892, "creation_date": 1485374253, "question_id": 41860538, "link": "https://stackoverflow.com/questions/41860538/vba-to-copy-data-with-name-of-header-from-ws1-to-ws2", "title": "Vba to copy data with name of header from ws1 to ws2", "body": "<p>I use this code to copy data from ws1 to other ws base of columns header. I need to find lot of columns header, in this code i repeat code for each col header data. what I need a code where i enter all header name &amp; columns range (for paste) in one line to find and paste match complete columns in other ws.</p>\n\n<pre><code>Sheets.add After:=Sheets(Sheets.count)\nActiveSheet.Name = \"Filter Data\"\nSheets(\"RawData\").Activate\nWith Sheets(\"RawData\").Rows(1)\n'Find \"Name,Date,Num,Item,Qty,Sales Price,Amount &amp; etc\" in Row 1\n    Set na = .Find(\"Name\", lookat:=xlPart)\n    Set da = .Find(\"Date\", lookat:=xlPart)\n    Set nu = .Find(\"Num\", lookat:=xlPart)\n    Set it = .Find(\"Item\", lookat:=xlPart)\n    Set qt = .Find(\"Qty\", lookat:=xlPart)\n    Set sp = .Find(\"Sales Price\", lookat:=xlPart)\n    Set am = .Find(\"Amount\", lookat:=xlPart)\n    'If found, copy the column to Sheet (Filter Data)\n        Columns(na.Column).EntireColumn.Copy _\n        Destination:=Sheets(\"Filter Data\").Range(\"A1\")\n        Columns(da.Column).EntireColumn.Copy _\n        Destination:=Sheets(\"Filter Data\").Range(\"B1\")\n        Columns(nu.Column).EntireColumn.Copy _\n        Destination:=Sheets(\"Filter Data\").Range(\"C1\")\n        Columns(it.Column).EntireColumn.Copy _\n        Destination:=Sheets(\"Filter Data\").Range(\"D1\")\n        Columns(qt.Column).EntireColumn.Copy _\n        Destination:=Sheets(\"Filter Data\").Range(\"E1\")\n        Columns(sp.Column).EntireColumn.Copy _\n        Destination:=Sheets(\"Filter Data\").Range(\"F1\")\n        Columns(am.Column).EntireColumn.Copy _\n        Destination:=Sheets(\"Filter Data\").Range(\"G1\")\n    'Else: MsgBox \"Name Not Found\"\nEnd With\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 1, "creation_date": 1485374385, "post_id": 41860341, "comment_id": 70904870, "body": "Won&#39;t that also pick up the number <code>173.2</code>?"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1485374533, "post_id": 41860341, "comment_id": 70904945, "body": "@YowE3K yes it would.  Put your comment as an answer so I may delete mine."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1485374648, "post_id": 41860341, "comment_id": 70905009, "body": "I&#39;ve posted an answer, but it might be best to leave yours as the OP said that worked."}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": false, "score": 1, "last_activity_date": 1485373589, "creation_date": 1485373589, "answer_id": 41860341, "question_id": 41860312, "link": "https://stackoverflow.com/questions/41860312/code-in-vba-excel/41860341#41860341", "title": "Code in VBA Excel", "body": "<p>Use this:</p>\n\n<pre><code>IF (Left(Cells(x, 18), 2) = \"17\" and Len(Cells(x, 18))=5 Then\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "is_accepted": false, "score": 2, "last_activity_date": 1485374621, "creation_date": 1485374621, "answer_id": 41860652, "question_id": 41860312, "link": "https://stackoverflow.com/questions/41860312/code-in-vba-excel/41860652#41860652", "title": "Code in VBA Excel", "body": "<p>If your cells contain numbers, you should really be using numeric tests such as</p>\n\n<pre><code>If Cells(x,18).Value &gt;= 17000 And Cells(x,18).Value &lt;= 17999 Then\n</code></pre>\n"}], "owner": {"reputation": 177, "user_id": 7443078, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/2c1584d62ac86e07b29a52ace8307f9d?s=128&d=identicon&r=PG&f=1", "display_name": "Olivia", "link": "https://stackoverflow.com/users/7443078/olivia"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 23, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1485374621, "creation_date": 1485373488, "last_edit_date": 1531164843, "question_id": 41860312, "link": "https://stackoverflow.com/questions/41860312/code-in-vba-excel", "title": "Code in VBA Excel", "body": "<p>I am trying to write a code in Excel using VBA.\nI have a huge table with lot of data in it, and I want to filter the table using few column headings.\nIn that I want to filter the column heading \"Design Group\". And I want only those numbers which start with \"17\" and has 5 digits \"17###\".</p>\n\n<p>I tried using something like this:\n(Left(Cells(x, 18), 2) = Format(17, \"17###\")\nBut, obviously this does not work!</p>\n\n<p>It would be really helpful if someone can find a way around this.\nThanks!</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2182, "user_id": 4721281, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/9ca3ef336c479bc32997b548b75e7c24?s=128&d=identicon&r=PG&f=1", "display_name": "MGP", "link": "https://stackoverflow.com/users/4721281/mgp"}, "edited": false, "score": 1, "creation_date": 1485431352, "post_id": 41860149, "comment_id": 70927156, "body": "Basicly the &quot;.&quot; means, that you will either call a function or a property of the element before the &quot;.&quot;"}], "answers": [{"comments": [{"owner": {"reputation": 127, "user_id": 7464127, "user_type": "registered", "accept_rate": 67, "profile_image": "https://graph.facebook.com/10154510957598702/picture?type=large", "display_name": "Isra Shaikh", "link": "https://stackoverflow.com/users/7464127/isra-shaikh"}, "edited": false, "score": 0, "creation_date": 1485456215, "post_id": 41860645, "comment_id": 70943476, "body": "Thanks! yeah trying to understand it as i use it so this seemed to be a common sight. Makes so much sense now! Thankyou!"}], "tags": [], "owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "is_accepted": true, "score": 1, "last_activity_date": 1485374592, "creation_date": 1485374592, "answer_id": 41860645, "question_id": 41860149, "link": "https://stackoverflow.com/questions/41860149/vba-dot-notation/41860645#41860645", "title": "VBA Dot notation", "body": "<p>If I'm understanding this correctly, you're curious about how VBA defines what is happening in a line of code.  </p>\n\n<p>The VBA notation for working will be dependent on what you're doing, meaning how deep you will need to go.</p>\n\n<pre><code>ActiveWorkbook.Sheets(\"Sheet1\").Range(\"A1\").Formula=\"\"\n</code></pre>\n\n<p>This would be a pretty common display for a single line of code if you wanted a formula hard coded into A1.  You specify the workbook, the sheet, the cell/range to be worked in, then what you want to happen.</p>\n\n<p>You can shorten some of this if you want to work do multiple things in the, arbitrarily, sheet (sheet1).  You can use a With statement which will have the following nomenclature:</p>\n\n<pre><code>With ActiveWorkbook.Sheets(\"Sheet1\")\n     .Range(\"A1\").Formula=\"\"\n     .Range(\"B1\").Formula=\"\"\nEnd With\n</code></pre>\n\n<p>The use of the \".\" is what ties you do what is being operated on.  Think of it as part of a name.  Your name is Isra Shaikh (based on username).  If we want to punch you, and not your brother named Herb, we could want to specify:</p>\n\n<pre><code>SurName(\"Shaikh\").PreName(\"Herb\").Punch\n</code></pre>\n\n<p>If we wanted to punch both of you:</p>\n\n<pre><code>SurName(\"Shaikh\").PreName(\"Isra\").Punch\nSurName(\"Shaikh\").PreName(\"Herb\").Punch\n</code></pre>\n\n<p>or more combined:</p>\n\n<pre><code>With SurName(\"Shaikh\")\n    .PreName(\"Isra\").Punch\n    .PreName(\"Herb\").Punch\nEnd With\n</code></pre>\n\n<p>Notice how the With statement doesn't end with a \".\", but what happens inside the With is preceded with the \".\"; this is how VBA knows what all is being worked on.  Also note that you start from the widest, to the narrowest, component (workbook -> cell).</p>\n\n<p>Hoping that is enough of a description!</p>\n"}], "owner": {"reputation": 127, "user_id": 7464127, "user_type": "registered", "accept_rate": 67, "profile_image": "https://graph.facebook.com/10154510957598702/picture?type=large", "display_name": "Isra Shaikh", "link": "https://stackoverflow.com/users/7464127/isra-shaikh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1886, "favorite_count": 0, "accepted_answer_id": 41860645, "answer_count": 1, "score": 0, "last_activity_date": 1485374592, "creation_date": 1485372957, "last_edit_date": 1531164843, "question_id": 41860149, "link": "https://stackoverflow.com/questions/41860149/vba-dot-notation", "title": "VBA Dot notation", "body": "<p>Hi so im new to programming specifically with VBA. Worked basics with Matlab previously so understand the for and if loops etc.\nHowever I do not understand how the dot notation works. \nMeaning ActiveCell.Range etc</p>\n\n<p>Where do we use it and in what context.</p>\n\n<p>Thanks</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 533, "user_id": 7315468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f038bb9934e81791e469421adef9d645?s=128&d=identicon&r=PG&f=1", "display_name": "Vinnie", "link": "https://stackoverflow.com/users/7315468/vinnie"}, "edited": false, "score": 0, "creation_date": 1485372737, "post_id": 41860000, "comment_id": 70903952, "body": "It will cause you some trouble if you always delete sheet1 when there&#39;s update."}, {"owner": {"reputation": 117, "user_id": 1238009, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8a925575f3c28761f46c266f2f64c3e6?s=128&d=identicon&r=PG", "display_name": "Crna Krv", "link": "https://stackoverflow.com/users/1238009/crna-krv"}, "reply_to_user": {"reputation": 533, "user_id": 7315468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f038bb9934e81791e469421adef9d645?s=128&d=identicon&r=PG&f=1", "display_name": "Vinnie", "link": "https://stackoverflow.com/users/7315468/vinnie"}, "edited": false, "score": 0, "creation_date": 1485372952, "post_id": 41860000, "comment_id": 70904049, "body": "@Vinnie actually I make a copy of that spreadsheet which I use as a template, and it&#39;s that copy that is updated."}], "answers": [{"comments": [{"owner": {"reputation": 117, "user_id": 1238009, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8a925575f3c28761f46c266f2f64c3e6?s=128&d=identicon&r=PG", "display_name": "Crna Krv", "link": "https://stackoverflow.com/users/1238009/crna-krv"}, "edited": false, "score": 0, "creation_date": 1485373509, "post_id": 41860162, "comment_id": 70904379, "body": "How could I automated doing that over the entire spreadsheet, i.e. using parameters for tab2 and sheet1 ?"}, {"owner": {"reputation": 533, "user_id": 7315468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f038bb9934e81791e469421adef9d645?s=128&d=identicon&r=PG&f=1", "display_name": "Vinnie", "link": "https://stackoverflow.com/users/7315468/vinnie"}, "reply_to_user": {"reputation": 117, "user_id": 1238009, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8a925575f3c28761f46c266f2f64c3e6?s=128&d=identicon&r=PG", "display_name": "Crna Krv", "link": "https://stackoverflow.com/users/1238009/crna-krv"}, "edited": false, "score": 0, "creation_date": 1485373823, "post_id": 41860162, "comment_id": 70904549, "body": "What do you want to automate on those sheets?"}, {"owner": {"reputation": 117, "user_id": 1238009, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8a925575f3c28761f46c266f2f64c3e6?s=128&d=identicon&r=PG", "display_name": "Crna Krv", "link": "https://stackoverflow.com/users/1238009/crna-krv"}, "edited": false, "score": 0, "creation_date": 1485378112, "post_id": 41860162, "comment_id": 70906854, "body": "for instance if I have 20 sheets I want to delete"}, {"owner": {"reputation": 533, "user_id": 7315468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f038bb9934e81791e469421adef9d645?s=128&d=identicon&r=PG&f=1", "display_name": "Vinnie", "link": "https://stackoverflow.com/users/7315468/vinnie"}, "reply_to_user": {"reputation": 117, "user_id": 1238009, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8a925575f3c28761f46c266f2f64c3e6?s=128&d=identicon&r=PG", "display_name": "Crna Krv", "link": "https://stackoverflow.com/users/1238009/crna-krv"}, "edited": false, "score": 0, "creation_date": 1485379060, "post_id": 41860162, "comment_id": 70907346, "body": "You have to determine which ones to delete."}], "tags": [], "owner": {"reputation": 533, "user_id": 7315468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f038bb9934e81791e469421adef9d645?s=128&d=identicon&r=PG&f=1", "display_name": "Vinnie", "link": "https://stackoverflow.com/users/7315468/vinnie"}, "is_accepted": false, "score": 0, "last_activity_date": 1485372990, "creation_date": 1485372990, "answer_id": 41860162, "question_id": 41860000, "link": "https://stackoverflow.com/questions/41860000/after-data-update-preserve-cell-values-instead-of-formulas-and-delete-data-shee/41860162#41860162", "title": "After data update, preserve cell values instead of formulas and delete data sheet", "body": "<p>Try this: </p>\n\n<pre><code>Sub Sample()\n        Dim ws As Worksheet\n\n        Set ws = ThisWorkbook.Sheets(\"tab2\")\n\n        ws.UsedRange.Value = ws.UsedRange.Value\n\n        Application.DisplayAlerts = False\n            Sheets(\"sheet1\").Delete\n        Application.DisplayAlerts = True\n\n        ActiveWorkbook.Save\n\n    End Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "is_accepted": false, "score": 1, "last_activity_date": 1485373151, "creation_date": 1485373151, "answer_id": 41860218, "question_id": 41860000, "link": "https://stackoverflow.com/questions/41860000/after-data-update-preserve-cell-values-instead-of-formulas-and-delete-data-shee/41860218#41860218", "title": "After data update, preserve cell values instead of formulas and delete data sheet", "body": "<p>You've got the values only in Sheet2.</p>\n\n<p>You want to delete Sheet1 (there should be a pop-up to check if you really want to delete the sheet... we're going to turn that off before you do, then back on after):</p>\n\n<pre><code>Application.DisplayAlerts = False \nSheets(\"Sheet1\").Delete\nApplication.DisplayAlerts = True\n</code></pre>\n\n<p>Then to .SaveAs (prompts for file name to save as)</p>\n\n<pre><code>ThisWorkbook.SaveAs Filename:=fName\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 65, "user_id": 3672328, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af97e15e18c4f485da364e8982fa3d2d?s=128&d=identicon&r=PG&f=1", "display_name": "CSSWormy", "link": "https://stackoverflow.com/users/3672328/csswormy"}, "is_accepted": false, "score": 0, "last_activity_date": 1537790230, "creation_date": 1537790230, "answer_id": 52478889, "question_id": 41860000, "link": "https://stackoverflow.com/questions/41860000/after-data-update-preserve-cell-values-instead-of-formulas-and-delete-data-shee/52478889#52478889", "title": "After data update, preserve cell values instead of formulas and delete data sheet", "body": "<p>Why not just scratch the idea of two sheets and extrapolate on the answer I got in my question.</p>\n\n<p><a href=\"https://stackoverflow.com/questions/52466275/use-formula-to-update-cells-but-as-values\">Use formula to update cells, but as values</a></p>\n\n<p>Try a macro with </p>\n\n<pre><code>Range(\"A1:P10\").Select\nWith Selection\n    .Value = .Value\nEnd With\n</code></pre>\n\n<p>This will turn every formula in the range you've selected into it's value.  Just don't try using <code>Cells.Select</code>.  When I tried it, I got a memory related error.  If your spreadsheets are various sizes, then calculate the bottom cell first.</p>\n\n<pre><code>Sub Convert()\n    ' Table Bottom\n    Dim TB As Long\n    ' Set Table Bottom Variable\n    TB = Range(\"A65000\").End(xlUp).Row 'finds bottom row\n    ' Change Formulas in Range to Values\n    Range(\"A1:P\" &amp; TB).Select\n    With Selection\n        .Value = .Value\n    End With\nEnd Sub\n</code></pre>\n\n<p>Sometimes I have to change the column for finding the bottom row depending on the spreadsheet, but this is the general idea.</p>\n\n<p>I think this will accomplish what you're ultimately trying to do if you put this at the end of the code that is pulling the updates, or if you just run it separately after the updates have been completed.  It doesn't seem like your goal is to have two different spreadsheets.  Just one spreadsheet that is only values.</p>\n"}], "owner": {"reputation": 117, "user_id": 1238009, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8a925575f3c28761f46c266f2f64c3e6?s=128&d=identicon&r=PG", "display_name": "Crna Krv", "link": "https://stackoverflow.com/users/1238009/crna-krv"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 36, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1537790230, "creation_date": 1485372418, "question_id": 41860000, "link": "https://stackoverflow.com/questions/41860000/after-data-update-preserve-cell-values-instead-of-formulas-and-delete-data-shee", "title": "After data update, preserve cell values instead of formulas and delete data sheet", "body": "<p>I have a xlsx spreadsheet with a bunch of sheets that either contain data or formulas.  Lets say sheet1 has the data and sheet2 has formulas referring to the data in sheet1.  I'm trying to do the following when sheet1 is updated with new data (coming from a SAS program):</p>\n\n<ol>\n<li>convert sheet2 to only values (i.e. remove the formulas behind)</li>\n<li>delete sheet1</li>\n<li>save file</li>\n</ol>\n\n<p>I would need to automate this througout the spreadsheet and have the macro/program run automaticcaly when there's an update.</p>\n\n<p>So far, here's what I got (pasting values instead of formulas):</p>\n\n<pre><code>Sub Sample()\n    Dim ws As Worksheet\n\n    Set ws = ThisWorkbook.Sheets(\"tab2\")\n\n    ws.UsedRange.Value = ws.UsedRange.Value\nEnd Sub\n</code></pre>\n\n<p>I am really not familiar with VBA.</p>\n"}, {"tags": ["excel", "vba", "dropdownbox"], "answers": [{"tags": [], "owner": {"reputation": 407, "user_id": 7205641, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d10b4685e2efa582d02918786410e15f?s=128&d=identicon&r=PG&f=1", "display_name": "mastersom", "link": "https://stackoverflow.com/users/7205641/mastersom"}, "is_accepted": true, "score": 0, "last_activity_date": 1485386748, "creation_date": 1485386748, "answer_id": 41863556, "question_id": 41859953, "link": "https://stackoverflow.com/questions/41859953/fill-multiple-excel-dropdowns-in-a-loop/41863556#41863556", "title": "fill multiple excel dropdowns in a loop", "body": "<p>Code is right. But the problem what naming the dropdowns. They should have unique names.</p>\n"}], "owner": {"reputation": 407, "user_id": 7205641, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d10b4685e2efa582d02918786410e15f?s=128&d=identicon&r=PG&f=1", "display_name": "mastersom", "link": "https://stackoverflow.com/users/7205641/mastersom"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 50, "favorite_count": 0, "accepted_answer_id": 41863556, "answer_count": 1, "score": 0, "last_activity_date": 1485386748, "creation_date": 1485372251, "last_edit_date": 1485378908, "question_id": 41859953, "link": "https://stackoverflow.com/questions/41859953/fill-multiple-excel-dropdowns-in-a-loop", "title": "fill multiple excel dropdowns in a loop", "body": "<p>I have a for loop which creates multiple dropdowns in different parts of my excel sheet. However i am having a hard time filling these with a list. The list should be obtained from the sheets in ws. I guess the <strong>problem here is that, when naming my combo box, it doesnt get assigned as an object</strong>.\nHere is the code i have. Anybody have an idea on how to do this? Thanks in advance.</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n\nSet ws = Sheets(Array(\"rpi301\", \"rpi302\", \"rpi303\", \"rpi304\", \"rpi305\"))\n\nFor Each Sh In ws\n    Set Cell = Range(Sh.Range(\"B8\").Value &amp; CStr(Sh.Range(\"B9\").Value))\n    With Cell\n        ActiveSheet.DropDowns.Add(.Left, .Top, .Width, .Height).Name = \"Combo\"\n        ActiveSheet.Shapes(\"Combo\").ControlFormat.ListFillRange = Sh.Range(\"B2:B7\")\n    End With\nNext \nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "download"], "answers": [{"comments": [{"owner": {"reputation": 173, "user_id": 4273095, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/A34DI.png?s=128&g=1", "display_name": "Seraphim", "link": "https://stackoverflow.com/users/4273095/seraphim"}, "edited": false, "score": 0, "creation_date": 1485371297, "post_id": 41859590, "comment_id": 70903172, "body": "I see, I tried what you said and found that I do have to login everytime. What do you think could be a workaround to get the files downloaded?"}, {"owner": {"reputation": 26, "user_id": 7470713, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/3bcebc56ed83c28391ec98715a2894c9?s=128&d=identicon&r=PG", "display_name": "Hello", "link": "https://stackoverflow.com/users/7470713/hello"}, "reply_to_user": {"reputation": 173, "user_id": 4273095, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/A34DI.png?s=128&g=1", "display_name": "Seraphim", "link": "https://stackoverflow.com/users/4273095/seraphim"}, "edited": false, "score": 0, "creation_date": 1485373454, "post_id": 41859590, "comment_id": 70904342, "body": "You&#39;ll have to make the same requests your browser is sending. Open your browsers dev tools and look at the network tab for the requests being sent. Mostly likely your browser is sending a POST request for the login form. Search around for how to make POST requests and managing cookies."}], "tags": [], "owner": {"reputation": 26, "user_id": 7470713, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/3bcebc56ed83c28391ec98715a2894c9?s=128&d=identicon&r=PG", "display_name": "Hello", "link": "https://stackoverflow.com/users/7470713/hello"}, "is_accepted": true, "score": 1, "last_activity_date": 1486137827, "last_edit_date": 1486137827, "creation_date": 1485371058, "answer_id": 41859590, "question_id": 41859488, "link": "https://stackoverflow.com/questions/41859488/automating-file-download-of-a-link-that-looks-like-this-https-www-domain-com/41859590#41859590", "title": "Automating File Download of a link that looks like this: https://www.domain.com/TableData/TableA.csv", "body": "<p>Your browser stores cookies which likely allows you to login automatically. Try browsing the page in different tabs in an incognito browser and you'll likely have to login each time.</p>\n\n<p>You'll have to find a way to make the same requests your browser is sending to login, and use the cookies stored to make the requests to download the files.</p>\n"}], "owner": {"reputation": 173, "user_id": 4273095, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/A34DI.png?s=128&g=1", "display_name": "Seraphim", "link": "https://stackoverflow.com/users/4273095/seraphim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 160, "favorite_count": 0, "accepted_answer_id": 41859590, "answer_count": 1, "score": 0, "last_activity_date": 1486137827, "creation_date": 1485370690, "last_edit_date": 1531164843, "question_id": 41859488, "link": "https://stackoverflow.com/questions/41859488/automating-file-download-of-a-link-that-looks-like-this-https-www-domain-com", "title": "Automating File Download of a link that looks like this: https://www.domain.com/TableData/TableA.csv", "body": "<p>I am trying to write an application that will download .csv and .xls files and save them into a folder that will be accessed later by a VBA macro. I am posting this question after the unsuccessful use of the solution in the following link: <a href=\"https://stackoverflow.com/questions/17877389/how-do-i-download-a-file-using-vba-without-internet-explorer\">How do i download a file using VBA (Without internet explorer)</a></p>\n\n<p>The macro runs successfully, but the downloaded .csv file only contains the html from the login page. I find that strange because when I copy and paste the link directly into the browser without logging in, I am immediately prompted with a save, open, close window for the file. </p>\n\n<p>As much as possible I am trying to avoid using SendKeys, but I can't seem to find another solution that works. I am not opposed to options other than VBA. Any help would be appreciated, thank you.</p>\n"}, {"tags": ["sql-server", "excel", "vba", "stored-procedures"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1485370018, "post_id": 41859054, "comment_id": 70902396, "body": "Does your query actually return numeric values as numbers? Are decimal separators involved? Is the data stored in numeric fields?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1485370393, "post_id": 41859054, "comment_id": 70902627, "body": "Excel should recognize numbers as numbers, as long as the query&#39;s metadata is saying numbers <i>are</i> numbers. Look at the stored procedure, see what it&#39;s selecting from where, verify that the tables are storing numbers as numbers, alter the procedure accordingly to cast number-as-text fields into actual-numbers, and Excel should just pick it up."}, {"owner": {"reputation": 1512, "user_id": 2936675, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/886c2f804bb37c2dbd5d92fb5b3344ce?s=128&d=identicon&r=PG&f=1", "display_name": "nwhaught", "link": "https://stackoverflow.com/users/2936675/nwhaught"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1485371191, "post_id": 41859054, "comment_id": 70903100, "body": "Well I&#39;ll be darned, the field is an nvarchar. Thanks! Hopefully that&#39;s the dumbest thing I&#39;ll do today.  :)"}], "answers": [{"tags": [], "owner": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "is_accepted": true, "score": 0, "last_activity_date": 1485551970, "creation_date": 1485551970, "answer_id": 41903184, "question_id": 41859054, "link": "https://stackoverflow.com/questions/41859054/make-excel-recognize-numeric-fields-from-imported-stored-procedure/41903184#41903184", "title": "Make Excel recognize numeric fields from imported stored procedure", "body": "<p>Formalising answer from comments ...</p>\n\n<p>Please ensure that the numeric fields returned from a stored procedure are defined as a numeric type <a href=\"https://technet.microsoft.com/en-us/library/dd424925.aspx\" rel=\"nofollow noreferrer\">Understand the 9 Numeric Data Types in SQL Server 2008 </a> (and not nvarchar) if you want Excel to recognise them as numeric.</p>\n"}], "owner": {"reputation": 1512, "user_id": 2936675, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/886c2f804bb37c2dbd5d92fb5b3344ce?s=128&d=identicon&r=PG&f=1", "display_name": "nwhaught", "link": "https://stackoverflow.com/users/2936675/nwhaught"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 35, "favorite_count": 0, "accepted_answer_id": 41903184, "answer_count": 1, "score": 0, "last_activity_date": 1485551970, "creation_date": 1485369310, "question_id": 41859054, "link": "https://stackoverflow.com/questions/41859054/make-excel-recognize-numeric-fields-from-imported-stored-procedure", "title": "Make Excel recognize numeric fields from imported stored procedure", "body": "<p>I have created a linked table in my excel sheet that connects to a stored procedure on my SQL server, and update it via a macro as</p>\n\n<p><code>Sheet.Range(\"TableName\").ListObject.QueryTable.Refresh BackgroundQuery:=False</code></p>\n\n<p>This works great, but pulls in numeric columns as text, and when my macro tries to do math with these text values it fails.</p>\n\n<p>My current workaround is calling</p>\n\n<p><code>Sheet.Range(\"TableName[[#All],[NumericField]]\").Value = Sheet.Range(\"TableName[[#All],[NumericField]]\").Value</code></p>\n\n<p>for each numeric field, which gets Excel to recognize those fields as numeric. This works, but feels clunky.</p>\n\n<p><strong>Are there any other (better) ways to get Excel to recognize that a field in my stored procedure is numeric?</strong></p>\n"}, {"tags": ["excel", "crash", "userform", "vba"], "comments": [{"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1485369747, "post_id": 41859012, "comment_id": 70902209, "body": "If this is for a company, have they made any pushes recently that would affect this?  With a company choosing when/how to push updates, it may be outside the window of just the past couple weeks."}, {"owner": {"reputation": 1, "user_id": 7470545, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0337c596b196da0cfa0f1e7bc65bf684?s=128&d=identicon&r=PG&f=1", "display_name": "C. Began", "link": "https://stackoverflow.com/users/7470545/c-began"}, "reply_to_user": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1485369826, "post_id": 41859012, "comment_id": 70902275, "body": "we are a small company, we do not roll out updates, we just use what comes down the pipe through microsoft as they come"}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1485370272, "post_id": 41859012, "comment_id": 70902547, "body": "I&#39;m not seeing anything related to updates to excel 2013 that went out recently.  All I can suggest is removing the installed addins and trying with a &quot;clean&quot; version of Excel to see if it runs.  Depending what the Userform code has run in the background, it could call something that is duplicated... just trying to think of possible solutions."}, {"owner": {"reputation": 1, "user_id": 7470545, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0337c596b196da0cfa0f1e7bc65bf684?s=128&d=identicon&r=PG&f=1", "display_name": "C. Began", "link": "https://stackoverflow.com/users/7470545/c-began"}, "reply_to_user": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1485373931, "post_id": 41859012, "comment_id": 70904617, "body": "Have already tried on a brand new clean install of excel with no addons, i have manually compiled and done a step by step walk though of all the code... this is a head scratcher"}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1485374971, "post_id": 41859012, "comment_id": 70905187, "body": "What is the exact line of code which it is getting stuck?"}, {"owner": {"reputation": 42767, "user_id": 480982, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/U21Ey.jpg?s=128&g=1", "display_name": "Thomas Weller", "link": "https://stackoverflow.com/users/480982/thomas-weller"}, "edited": false, "score": 0, "creation_date": 1485376269, "post_id": 41859012, "comment_id": 70905921, "body": "Error code: (NTSTATUS) 0xc0000028 (3221225512) - An invalid or unaligned stack was encountered during an unwind operation."}], "owner": {"reputation": 1, "user_id": 7470545, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0337c596b196da0cfa0f1e7bc65bf684?s=128&d=identicon&r=PG&f=1", "display_name": "C. Began", "link": "https://stackoverflow.com/users/7470545/c-began"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 383, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1485369195, "creation_date": 1485369195, "last_edit_date": 1531161705, "question_id": 41859012, "link": "https://stackoverflow.com/questions/41859012/excel-started-crashing-on-multiple-computers-and-multiple-versions-of-userform", "title": "Excel Started Crashing on multiple computers and multiple versions of userform", "body": "<p>I built a userform and reporting workbook for our receiving department about 2 years ago and in the process of building it saved multiple revisions in case i ever wanted to take a step back. I was finally happy with the build and gave it to them to use.  Well fast forward a year and a half and now, suddenly everytime they get to the same step in the userform it crashes excel on every computer we try it on. Not only that, but it crashes at the same spot on different builds that still have saved. Is there something they patched on Excel within the past few weeks (1-25-17 as i write this) that would start causing these macros to start crashing?</p>\n\n<ul>\n<li>Problem signature:</li>\n<li>Problem Event Name: APPCRASH</li>\n<li>Application Name:    EXCEL.EXE</li>\n<li>Application Version: 15.0.4893.1002</li>\n<li>Application Timestamp:   5866f585</li>\n<li>Fault Module Name:   ntdll.dll</li>\n<li>Fault Module Version:    6.1.7601.23572</li>\n<li>Fault Module Timestamp:  57fd0651</li>\n<li>Exception Code: c0000028</li>\n<li>Exception Offset:    00000000000c8078</li>\n<li>OS Version:  6.1.7601.2.1.0.256.48</li>\n<li><p>Locale ID:   1033</p></li>\n<li><p>Additional information about the problem:</p></li>\n<li><h2>LCID:    1033</h2></li>\n</ul>\n\n<p>List item</p>\n\n<p>skulcid:    1033</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 743, "user_id": 7386565, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4d17bff6b180e634d412328b6b418f2?s=128&d=identicon&r=PG&f=1", "display_name": "J. Garth", "link": "https://stackoverflow.com/users/7386565/j-garth"}, "edited": false, "score": 0, "creation_date": 1485370025, "post_id": 41858892, "comment_id": 70902402, "body": "Can you see where the error is getting generated by clicking debug and stepping through the code?"}, {"owner": {"reputation": 1856, "user_id": 4949483, "user_type": "registered", "accept_rate": 86, "profile_image": "https://graph.facebook.com/10207184362590012/picture?type=large", "display_name": "Rdster", "link": "https://stackoverflow.com/users/4949483/rdster"}, "reply_to_user": {"reputation": 743, "user_id": 7386565, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4d17bff6b180e634d412328b6b418f2?s=128&d=identicon&r=PG&f=1", "display_name": "J. Garth", "link": "https://stackoverflow.com/users/7386565/j-garth"}, "edited": false, "score": 0, "creation_date": 1485370252, "post_id": 41858892, "comment_id": 70902535, "body": "No it runs fine, the error only appears when opening the file...and it highlights nothing."}, {"owner": {"reputation": 2351, "user_id": 5640342, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/mCXYH.jpg?s=128&g=1", "display_name": "ChrisB", "link": "https://stackoverflow.com/users/5640342/chrisb"}, "edited": false, "score": 0, "creation_date": 1485984402, "post_id": 41858892, "comment_id": 71157409, "body": "I got the same error in Excel 2016.  Restarting Excel after closing all open instances worked for me."}], "answers": [{"comments": [{"owner": {"reputation": 1856, "user_id": 4949483, "user_type": "registered", "accept_rate": 86, "profile_image": "https://graph.facebook.com/10207184362590012/picture?type=large", "display_name": "Rdster", "link": "https://stackoverflow.com/users/4949483/rdster"}, "edited": false, "score": 0, "creation_date": 1485545460, "post_id": 41899526, "comment_id": 70985459, "body": "I can start workbooks with no _Open events and still get the error, and it isn&#39;t happening to just one workbook.  I&#39;m inclined to believe this error is due to an Add-In.  I&#39;ll try removing them and seeing what errors I get over the next few days to see if I can narrow it down.  Thanks for the research...I&#39;m limited to only VBA on this system, no Visual Studio."}], "tags": [], "owner": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "is_accepted": false, "score": 1, "last_activity_date": 1485537431, "creation_date": 1485537431, "answer_id": 41899526, "question_id": 41858892, "link": "https://stackoverflow.com/questions/41858892/error-an-item-with-the-same-key-has-already-been-added/41899526#41899526", "title": "Error - An Item with the same key has already been added", "body": "<p>This looks like a Scripting.Dictionary error but in facts the following code throws an error of code 457 which is different from yours and the error message for dictionaries is different too 'This key is already associated with an element of this collection'  This can be verified with the code </p>\n\n<pre><code>Option Explicit\n\nSub Tst()\n    On Error Resume Next\n    Dim dic As New Scripting.Dictionary\n    dic.Add 1, 0\n    dic.Add 1, 0\n    Debug.Print Err.Number, Err.Description\nEnd Sub\n</code></pre>\n\n<p>So it is not your VBA code IMHO, but it looks rather like a C# error and we can verify this with some code, opening a Windows Forms C# project in Visual Studio and then edit Form1_Load to the following</p>\n\n<pre><code>using System;\nusing System.Collections.Generic;\nusing System.Windows.Forms;\n\nnamespace WindowsFormsApplication3\n{\n    public partial class Form1 : Form\n    {\n        public Form1()\n        {\n            InitializeComponent();\n        }\n\n        private void Form1_Load(object sender, EventArgs e)\n        {\n            try\n            {\n                Dictionary&lt;long, long&gt; dicTest = new Dictionary&lt;long, long&gt;();\n                dicTest.Add(1, 0);\n                dicTest.Add(1, 0);\n            }\n            catch (Exception ex) {\n                System.Windows.Forms.MessageBox.Show(string.Format(\"{0} {1}\", ex.HResult, ex.Message));\n            }\n        }\n    }\n}\n</code></pre>\n\n<p>and this throws the message box with the error number and message that you reported.  Thus it is a C# Dictionary error IMHO, and note how we trapped it with a try catch block whereas I think you have code C# that is not catching the error.</p>\n\n<p>So next question is which workbook is responsible.  I would suggest in your experiments using <code>Application.EnableEvents = False</code> which turns off event handling, such that event handlers written in any language VBA, C# , VB,NET do not run.   Then you can run your workbook's initialisation routines manually, if no error occurs your workbook is not guilty whereas the other workbooks/addins must be guilty at which you report the bug to their author. </p>\n\n<p>I hope you make progress with this.  It is difficult to take this further without feedback.</p>\n"}], "owner": {"reputation": 1856, "user_id": 4949483, "user_type": "registered", "accept_rate": 86, "profile_image": "https://graph.facebook.com/10207184362590012/picture?type=large", "display_name": "Rdster", "link": "https://stackoverflow.com/users/4949483/rdster"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 893, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1485537431, "creation_date": 1485368744, "last_edit_date": 1531164843, "question_id": 41858892, "link": "https://stackoverflow.com/questions/41858892/error-an-item-with-the-same-key-has-already-been-added", "title": "Error - An Item with the same key has already been added", "body": "<p>Upon opening a macro enabled Excel file, I get the following:</p>\n\n<blockquote>\n  <p>Run-Time Error '-2147024809 (80070057)': An Item with the same key has already been added.</p>\n</blockquote>\n\n<p>I've seen lots of similar questions for other languages, but nothing for VBA.  I did find one thing online for VBA, but it says it has something to do with the Scripting.Dictionary library.</p>\n\n<p>However, I have no reference to MS Scripting Runtime, nor do I ever bind to it, and I have no Dictionaries or Arrays or anything of the sort in this file.  The only thing I can think of is I have a small Userform that is only a Progress bar.  Every item on that Userform is uniquely named, and none of them are words that should be reserved or used by the system.</p>\n\n<p>Has anyone run into this or have any ideas?</p>\n\n<p><strong>Edit:</strong></p>\n\n<p>Ok, strange thing just happened...I closed the 2 other VBA Projects (Add-Ins) that were opened in the VBE, before opening my file, and the error didn't come up.  Those 2 other files have been open the whole time I've been working on this file...</p>\n\n<p>Then I closed Excel altogether...left the other 2 files open, and opened my file with no error.  I have no idea...</p>\n\n<p><strong>Update:</strong></p>\n\n<p>Just got the same error opening a different file.  In case my question wasn't already clear enough...Does anyone know what this error might have to with, or how to stop it?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1485369643, "post_id": 41858747, "comment_id": 70902139, "body": "What about conditional formatting? The formula could be, for example, <code>A2&lt;&gt;&quot;&quot;</code>?  What have you tried?"}, {"owner": {"reputation": 3638, "user_id": 1652222, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/4W5ez.jpg?s=128&g=1", "display_name": "ManishChristian", "link": "https://stackoverflow.com/users/1652222/manishchristian"}, "edited": false, "score": 0, "creation_date": 1485369699, "post_id": 41858747, "comment_id": 70902173, "body": "There are tons of option available on <a href=\"https://www.google.com/search?q=excel+vba+change+cell+color+in+range+if+cell+contains+value&amp;oq=excel+vba+change+cell+color+in+range+if+cell+contains+value&amp;aqs=chrome..69i57.23423j0j7&amp;sourceid=chrome&amp;ie=UTF-8#q=excel+vba+change+cell+color+in+range\" rel=\"nofollow noreferrer\"><b>internet</b></a>. Have you tried any?"}, {"owner": {"reputation": 890, "user_id": 1971254, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/8dff409464c507258b4b89b22c6f8c9a?s=128&d=identicon&r=PG&f=1", "display_name": "Rickson", "link": "https://stackoverflow.com/users/1971254/rickson"}, "reply_to_user": {"reputation": 3638, "user_id": 1652222, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/4W5ez.jpg?s=128&g=1", "display_name": "ManishChristian", "link": "https://stackoverflow.com/users/1652222/manishchristian"}, "edited": false, "score": 0, "creation_date": 1485370478, "post_id": 41858747, "comment_id": 70902670, "body": "@ManishChristian Most of them do use conditional formatting which I have tried but tried but did not really like. The remaining ones do not take into acound that only the cells within a predefined shall be considered."}, {"owner": {"reputation": 3638, "user_id": 1652222, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/4W5ez.jpg?s=128&g=1", "display_name": "ManishChristian", "link": "https://stackoverflow.com/users/1652222/manishchristian"}, "edited": false, "score": 0, "creation_date": 1485370772, "post_id": 41858747, "comment_id": 70902847, "body": "Share some dummy data and code that you&#39;ve tried so far."}, {"owner": {"reputation": 890, "user_id": 1971254, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/8dff409464c507258b4b89b22c6f8c9a?s=128&d=identicon&r=PG&f=1", "display_name": "Rickson", "link": "https://stackoverflow.com/users/1971254/rickson"}, "reply_to_user": {"reputation": 3638, "user_id": 1652222, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/4W5ez.jpg?s=128&g=1", "display_name": "ManishChristian", "link": "https://stackoverflow.com/users/1652222/manishchristian"}, "edited": false, "score": 0, "creation_date": 1485386006, "post_id": 41858747, "comment_id": 70910525, "body": "@ManishChristian Done."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1485416113, "post_id": 41858747, "comment_id": 70919396, "body": "<code>If Len(cell.Value) &gt; 0 Then</code>"}, {"owner": {"reputation": 3638, "user_id": 1652222, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/4W5ez.jpg?s=128&g=1", "display_name": "ManishChristian", "link": "https://stackoverflow.com/users/1652222/manishchristian"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1485440505, "post_id": 41858747, "comment_id": 70932755, "body": "Have you tried to change your <code>If</code> statement with what @TimWilliams have suggested?"}], "answers": [{"tags": [], "owner": {"reputation": 890, "user_id": 1971254, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/8dff409464c507258b4b89b22c6f8c9a?s=128&d=identicon&r=PG&f=1", "display_name": "Rickson", "link": "https://stackoverflow.com/users/1971254/rickson"}, "is_accepted": true, "score": 0, "last_activity_date": 1485465489, "creation_date": 1485465489, "answer_id": 41883144, "question_id": 41858747, "link": "https://stackoverflow.com/questions/41858747/colorize-cells-containing-data-in-a-selected-range/41883144#41883144", "title": "Colorize cells containing data in a selected range", "body": "<p>The hint of Tim Williams did the trick. Thanks!</p>\n\n<p>The following code works:</p>\n\n<pre><code>Sub ColorizeCells()\n    Dim Data As Range\n    Dim cell As Range\n    Set Data = Selection\n\n    For Each cell In Data\n        If Len(cell.Value) &gt; 0 Then\n            cell.Interior.ColorIndex = 4\n        End If\n    Next\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 890, "user_id": 1971254, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/8dff409464c507258b4b89b22c6f8c9a?s=128&d=identicon&r=PG&f=1", "display_name": "Rickson", "link": "https://stackoverflow.com/users/1971254/rickson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 64, "favorite_count": 0, "accepted_answer_id": 41883144, "answer_count": 1, "score": 0, "last_activity_date": 1485465489, "creation_date": 1485368217, "last_edit_date": 1531161705, "question_id": 41858747, "link": "https://stackoverflow.com/questions/41858747/colorize-cells-containing-data-in-a-selected-range", "title": "Colorize cells containing data in a selected range", "body": "<p>Does someone know how to realize the following?</p>\n\n<p>I have selected a range of cells in an Excel sheet. After pressing a shortcut key, each cell in the selected range that contains data shall have fill color red.</p>\n\n<p>There seems not to be a default Excel functionality for that but perhaps it can be done with VBA?</p>\n\n<p>Unfortunately, the following code does not work as expected:</p>\n\n<pre><code>Sub ColorizeCells()\n    Dim Data As Range\n    Dim cell As Range\n    Set Data = Selection\n\n    For Each cell In Data\n        If Not cell.Value Is Nothing Then\n            cell.Interior.ColorIndex = 4\n        End If\n    Next\n\nEnd Sub\n</code></pre>\n\n<p>Any suggestions on this are highly appreciated.</p>\n"}, {"tags": ["excel", "vba", "for-loop"], "comments": [{"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1485367853, "post_id": 41858364, "comment_id": 70901118, "body": "<code>vItem.Value</code> --&gt; <code>vItem</code>. that&#39;s it. But try to rewrite your code and get rid of the <code>Select</code> stuff."}, {"owner": {"reputation": 11, "user_id": 7470388, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e8bca2a9579c06f77a80bb216b91b405?s=128&d=identicon&r=PG&f=1", "display_name": "Vicente Gre", "link": "https://stackoverflow.com/users/7470388/vicente-gre"}, "reply_to_user": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1485369355, "post_id": 41858364, "comment_id": 70901986, "body": "Thanks. I don&#39;t really know how to replace the Select Stuff."}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1485370116, "post_id": 41858364, "comment_id": 70902465, "body": "Does it work now?"}, {"owner": {"reputation": 11, "user_id": 7470388, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e8bca2a9579c06f77a80bb216b91b405?s=128&d=identicon&r=PG&f=1", "display_name": "Vicente Gre", "link": "https://stackoverflow.com/users/7470388/vicente-gre"}, "reply_to_user": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1485373722, "post_id": 41858364, "comment_id": 70904495, "body": "Yes, everything works just fine. Thank you."}], "owner": {"reputation": 11, "user_id": 7470388, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e8bca2a9579c06f77a80bb216b91b405?s=128&d=identicon&r=PG&f=1", "display_name": "Vicente Gre", "link": "https://stackoverflow.com/users/7470388/vicente-gre"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 370, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1485366901, "creation_date": 1485366901, "question_id": 41858364, "link": "https://stackoverflow.com/questions/41858364/do-until-selection-value-equals-the-for-each-value", "title": "Do Until Selection Value equals the For Each value", "body": "<p>I'm currently trying to use a Do Until within a For each but I'm having a problem. What I'm trying is to Do Until selection value equals the value selected for the For each section in the following code:</p>\n\n<pre><code>Private Sub Copiar()\n\nDim Eselect As Variant\nDim vItem As Variant\nDim Col As Integer\n\nEselect = Array(CBE1.Value, CBE2.Value, CBE3.Value, CBE4.Value, CBE5.Value)\n\nFor Each vItem In Eselect\n    Range(\"C2\").Select\n    Do Until Selection.Value = vItem.Value\n        Selection.Offset(0, 1).Select\n    Loop\n    Col = ActiveCell.Column\n    Columns(Col).Copy\n    Sheets(2).Active\n    Range(\"A1\").Select\n    If Range(\"A1\") = \"\" Then\n        Columns(Col).Copy\n    Else\n        Do Until Selection.Value = \"\"\n            Offset.Selection(0, 1) = Selection.Value\n        Loop\n        Columns(Col).Copy\n   End If\nNext\n</code></pre>\n\n<p>End Sub</p>\n\n<p>The problem is specifically where is says \"Do Until Selection.Value = vItem.Value\" because I can't use vItem.Value and I don't know what I should use for to search until it find the value that For Each has selected. (I'm obviously just learning VBA).</p>\n\n<p>The whole idea is for it to search a specific value (multiple times, one for each ComboBox Value: CBEi) in a row and return the column, then copy that column on another sheet.</p>\n\n<p>Any help would be appreciated.</p>\n\n<p>Vicente.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 371, "user_id": 6736247, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/02978b1fa42fb47db1cbb90c71664e8d?s=128&d=identicon&r=PG&f=1", "display_name": "Eleshar", "link": "https://stackoverflow.com/users/6736247/eleshar"}, "edited": false, "score": 0, "creation_date": 1485366996, "post_id": 41858226, "comment_id": 70900618, "body": "When you debug the code, is any particular line highlighted? Also what is the role of VLOOKUP in all this? Are you just trying to open an excel workbook so that VLOOKUPed data is updated in another workbook?"}, {"owner": {"reputation": 123, "user_id": 5124315, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/D0B2S.jpg?s=128&g=1", "display_name": "Abigal", "link": "https://stackoverflow.com/users/5124315/abigal"}, "reply_to_user": {"reputation": 371, "user_id": 6736247, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/02978b1fa42fb47db1cbb90c71664e8d?s=128&d=identicon&r=PG&f=1", "display_name": "Eleshar", "link": "https://stackoverflow.com/users/6736247/eleshar"}, "edited": false, "score": 0, "creation_date": 1485367559, "post_id": 41858226, "comment_id": 70900961, "body": "The line highlighted is &quot;If Not IsError(Application.Match(.Value, Sht.Range(&quot;H:H&quot;), 0)) Then&quot; . One part of the code opens and closes the file that&#39;s in the intranet and the other is a vlookup from a userform dropdown list called &quot;xxxx.List&quot; that is the lookup value and is meant to return the data of the 3rd worksheet called &quot;database&quot; of column I. Table area is column H. Does that make sense?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1485416596, "post_id": 41858226, "comment_id": 70919580, "body": "It&#39;s not clear what you&#39;re doing here - you open a file &quot;Private.xlsm&quot; and then close a different file &quot;database.xlsm&quot; ?  What are each of these files?"}, {"owner": {"reputation": 123, "user_id": 5124315, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/D0B2S.jpg?s=128&g=1", "display_name": "Abigal", "link": "https://stackoverflow.com/users/5124315/abigal"}, "edited": false, "score": 0, "creation_date": 1485421926, "post_id": 41858226, "comment_id": 70922196, "body": "The file to be opened and closed is called database, I have changed our link to the intranet to private/private... for privacy reasons. Shall I elaborate more?"}, {"owner": {"reputation": 123, "user_id": 5124315, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/D0B2S.jpg?s=128&g=1", "display_name": "Abigal", "link": "https://stackoverflow.com/users/5124315/abigal"}, "edited": false, "score": 0, "creation_date": 1485433189, "post_id": 41858226, "comment_id": 70928158, "body": "Is my explanation still unclear? Shall i edit my post totally and try again?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1485498530, "post_id": 41858226, "comment_id": 70958339, "body": "It would help to make your code consistent.  If &quot;Private.xlsm&quot; and then  &quot;database.xlsm&quot; are the same file then why are you closing it <i>before</i> trying to read data from the sheet?  It needs to be open for that to work."}, {"owner": {"reputation": 123, "user_id": 5124315, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/D0B2S.jpg?s=128&g=1", "display_name": "Abigal", "link": "https://stackoverflow.com/users/5124315/abigal"}, "edited": false, "score": 0, "creation_date": 1485525164, "post_id": 41858226, "comment_id": 70973062, "body": "The debug error &quot;type mismatch&quot; is on line:  &quot;Me.TextBox1 = Sht.Range(&quot;H&quot; &amp; Application.Match(.Value, Sheet3.Range(&quot;H9:H100&quot;), 2)).Value&quot;"}], "owner": {"reputation": 123, "user_id": 5124315, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/D0B2S.jpg?s=128&g=1", "display_name": "Abigal", "link": "https://stackoverflow.com/users/5124315/abigal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 75, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1485423696, "creation_date": 1485366447, "last_edit_date": 1531164843, "question_id": 41858226, "link": "https://stackoverflow.com/questions/41858226/excel-userform-vba-vlookup-from-intranet-file-2", "title": "Excel Userform VBA VLOOKUP from intranet file (2)", "body": "<p>Following up from my previous post (of same title). I have a user form from which I need to look up data based on a list of items in a drop down box \"XXXXList\". The VBA code works partially. The code is able to look for and open the right file from the intranet called \"database\". But once the file is opened, I get the following error message \"Automation error\". </p>\n\n<p>The code i have is: </p>\n\n<pre><code>Private Sub ContractsList_AfterUpdate()\n\nDim WB As Workbook\nDim Sht As Worksheet\n\n' set workbook to workbook location at internet\n\nSet WB = Workbooks.Open(\"https://Private.Private.Private.uk/Private/Private/Private/Private/Private.xlsm\")\nSet Sht = WB.Worksheets(\"Availabledata\")\nApplication.Wait (Now + TimeValue(\"00:00:01\"))\nWorkbooks(\"database.xlsm\").Close\n\nWith Me.XXXXList\n    'value to be found in Column H of 3rd worhseet\n    If Not IsError(Application.Match(.Value, Sht.Range(\"H:H\"), 0)) Then\n        'Lookup values based on first control\n        Me.TextBox1 = Sht.Range(\"H\" &amp; Application.Match(.Value, Sheet3.Range(\"H9:H100\"), 2)).Value '&lt;-- value not found in Column H\n    Else\n        MsgBox \"This contract is not on the list\"\n        .Value = \"\"\n        Exit Sub\n    End If\nEnd With\n\nEnd Sub\n</code></pre>\n\n<p>Also, the worksheet \"database.xlsm\" is meant to flash open for a second and then close immediately, but instead it asks me if I want to save the data. </p>\n\n<p>I don't want really want that, is it possible to skip that step and close it automatically? </p>\n"}, {"tags": ["vba", "ms-access", "adodb"], "comments": [{"owner": {"reputation": 24083, "user_id": 6167855, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/U9Nf3.jpg?s=128&g=1", "display_name": "scsimon", "link": "https://stackoverflow.com/users/6167855/scsimon"}, "edited": false, "score": 0, "creation_date": 1485364926, "post_id": 41857747, "comment_id": 70899293, "body": "is your variable nullable in your proc? Regardless, a hack is this line of code right after your <code>as</code> in your proc to pass in a blank string but in the proc use it as a null <code>if @param=&#39;&#39; set @param = NULL</code>. So basically passing in a blank string will turn into a NULL inside the proc."}, {"owner": {"reputation": 1540, "user_id": 7149748, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7517a3bbc9ae7afe5772ab3632edf5d?s=128&d=identicon&r=PG&f=1", "display_name": "Skippy", "link": "https://stackoverflow.com/users/7149748/skippy"}, "reply_to_user": {"reputation": 24083, "user_id": 6167855, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/U9Nf3.jpg?s=128&g=1", "display_name": "scsimon", "link": "https://stackoverflow.com/users/6167855/scsimon"}, "edited": false, "score": 0, "creation_date": 1485369576, "post_id": 41857747, "comment_id": 70902097, "body": "Yes, I did think about doing that. I would have to redefine the parameter in the stored proc as string &#39;coz I can&#39;t pass an empty string to a datetime parameter. This would then have implications for validating a non-empty string before casting it as datetime. I just wondered if there was a &#39;proper&#39; way of passing the null and avoiding the hassle of using a string instead. If not then I might go the long way round and use a Command object with defined Parameter objects (which can be set to Null)."}, {"owner": {"reputation": 24083, "user_id": 6167855, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/U9Nf3.jpg?s=128&g=1", "display_name": "scsimon", "link": "https://stackoverflow.com/users/6167855/scsimon"}, "edited": false, "score": 0, "creation_date": 1485370071, "post_id": 41857747, "comment_id": 70902434, "body": "Ah i see what you mean about the datetime parameter. I&#39;m not sure about how to do it because I don&#39;t use ADO but perhaps this helps <a href=\"http://stackoverflow.com/q/1747641/6167855\">stackoverflow.com/q/1747641/6167855</a>"}, {"owner": {"reputation": 1540, "user_id": 7149748, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7517a3bbc9ae7afe5772ab3632edf5d?s=128&d=identicon&r=PG&f=1", "display_name": "Skippy", "link": "https://stackoverflow.com/users/7149748/skippy"}, "reply_to_user": {"reputation": 24083, "user_id": 6167855, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/U9Nf3.jpg?s=128&g=1", "display_name": "scsimon", "link": "https://stackoverflow.com/users/6167855/scsimon"}, "edited": false, "score": 0, "creation_date": 1485375057, "post_id": 41857747, "comment_id": 70905234, "body": "Yes, that&#39;s going the Command.Execute route, explicitly declaring Parameter objects. I may end up doing this, but I prefer the more compact Connection.{proc_name} route. Just looks like this might not support passing Null parameters."}], "answers": [{"comments": [{"owner": {"reputation": 1540, "user_id": 7149748, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7517a3bbc9ae7afe5772ab3632edf5d?s=128&d=identicon&r=PG&f=1", "display_name": "Skippy", "link": "https://stackoverflow.com/users/7149748/skippy"}, "edited": false, "score": 0, "creation_date": 1565118268, "post_id": 57369394, "comment_id": 101249236, "body": "Thanks, tried this, but it fails with <code>Compile error: Variable not defined</code> and highlights <code>dbnull</code>"}, {"owner": {"reputation": 3404, "user_id": 2181188, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/7JwZP.jpg?s=128&g=1", "display_name": "Fandango68", "link": "https://stackoverflow.com/users/2181188/fandango68"}, "reply_to_user": {"reputation": 1540, "user_id": 7149748, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7517a3bbc9ae7afe5772ab3632edf5d?s=128&d=identicon&r=PG&f=1", "display_name": "Skippy", "link": "https://stackoverflow.com/users/7149748/skippy"}, "edited": false, "score": 0, "creation_date": 1565222819, "post_id": 57369394, "comment_id": 101288729, "body": "@Skippy I&#39;ve updated the answer. For datetime I use 0 but that is translated inside a function in sql, which makes it the &quot;default&quot; date in sql - 31/12/1899 12:00:00. If you need datetime logic, I&#39;ll update the answer."}], "tags": [], "owner": {"reputation": 3404, "user_id": 2181188, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/7JwZP.jpg?s=128&g=1", "display_name": "Fandango68", "link": "https://stackoverflow.com/users/2181188/fandango68"}, "is_accepted": false, "score": 1, "last_activity_date": 1565222732, "last_edit_date": 1565222732, "creation_date": 1565068914, "answer_id": 57369394, "question_id": 41857747, "link": "https://stackoverflow.com/questions/41857747/pass-null-parameter-to-sql-stored-procedure-using-adodb-connection-object-from-a/57369394#57369394", "title": "Pass NULL parameter to SQL stored procedure using ADODB Connection object from Access VBA", "body": "<p>Just use <code>null</code> in VBA. It doesn't matter what data type you're using.</p>\n\n<p>i.e.</p>\n\n<pre><code>    Dim parm1 As ADODB.Parameter\n    Set parm1 = New ADODB.Parameter\n    parm1.Direction = adParamInput\n    parm1.Name = \"StatisticsDate\"\n    parm1.Type = adVarChar\n    parm1.Size = 50\n    If IsEmpty(wsCell) Then\n        parm1.Value = Null   'there is no DBNull - sorry\n    Else\n        parm1.Value = CDec(wsCell)\n    End If\n</code></pre>\n"}], "owner": {"reputation": 1540, "user_id": 7149748, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7517a3bbc9ae7afe5772ab3632edf5d?s=128&d=identicon&r=PG&f=1", "display_name": "Skippy", "link": "https://stackoverflow.com/users/7149748/skippy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1531, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1594540478, "creation_date": 1485364822, "last_edit_date": 1594540478, "question_id": 41857747, "link": "https://stackoverflow.com/questions/41857747/pass-null-parameter-to-sql-stored-procedure-using-adodb-connection-object-from-a", "title": "Pass NULL parameter to SQL stored procedure using ADODB Connection object from Access VBA", "body": "<p>I know it is possible to call a SQL Server stored procedure and populate a recordset in Access VBA by using the sp like a method on an ADODB Connection object:</p>\n\n<pre><code>Dim cnnTest As New ADODB.Connection\nDim rsTest As New ADODB.Recordset\n\ncnnTest.ConnectionString = strMyConnectionString\ncnn.Open\ncnn.procMyTestProcedure param1, param2, rsTest\n</code></pre>\n\n<p>This will call stored procedure <code>procMyTestProcedure</code> passing prarmeters <code>param1</code> and <code>param2</code>, returning the results to my local <code>rsTest</code> recordset. This all works fine and I have been using this technique for years. I have now come across a situation where I need to be able to pass a NULL as one of the parameters, but nothing I have tried so far seems to work. I have tried passing an empty string, the value Null and a local variable of type variant set to Null. None of these has worked. Does anyone know how to do this please? The parameter in the stored procedure is of type <code>smalldatetime</code>.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1485365251, "post_id": 41857718, "comment_id": 70899525, "body": "Compare The return values of <code>AscW()</code> with the ranges given here: <a href=\"http://www.rikai.com/library/kanjitables/kanji_codes.unicode.shtml\" rel=\"nofollow noreferrer\">rikai.com/library/kanjitables/kanji_codes.unicode.shtml</a> ?"}, {"owner": {"reputation": 13, "user_id": 7465908, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6jcyV.jpg?s=128&g=1", "display_name": "mixadelic", "link": "https://stackoverflow.com/users/7465908/mixadelic"}, "reply_to_user": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1485365764, "post_id": 41857718, "comment_id": 70899846, "body": "Awesome, that sounds like it&#39;ll work! I&#39;d have to split the string into an array characters and compare each of them in a loop right? (Sorry, total newbie at this)."}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1485366396, "post_id": 41857718, "comment_id": 70900242, "body": "<code>Mid(s,i,1)</code> is the character in string <code>s</code> at index <code>i</code> (where the indexing is 1-based). I haven&#39;t used Unicode and VBA much at all and have the impression that VBA&#39;s Unicode handling is somewhat problematic. More recent versions of Excel have a worksheet function called <code>Unicode</code>. If you have such a version you could call this function from VBA: <a href=\"https://support.office.com/en-us/article/UNICODE-function-adb74aaa-a2a5-4dde-aff6-966e4e81f16f\" rel=\"nofollow noreferrer\">support.office.com/en-us/article/&hellip;</a>"}, {"owner": {"reputation": 13, "user_id": 7465908, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6jcyV.jpg?s=128&g=1", "display_name": "mixadelic", "link": "https://stackoverflow.com/users/7465908/mixadelic"}, "reply_to_user": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1485366895, "post_id": 41857718, "comment_id": 70900537, "body": "My main struggle is with Unicode encoding, but luckily I do think I have a version with <code>Unicode</code> so I&#39;ll look into it. Thank you very much!"}], "owner": {"reputation": 13, "user_id": 7465908, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6jcyV.jpg?s=128&g=1", "display_name": "mixadelic", "link": "https://stackoverflow.com/users/7465908/mixadelic"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 525, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1485364738, "creation_date": 1485364738, "question_id": 41857718, "link": "https://stackoverflow.com/questions/41857718/get-vba-to-recognize-different-japanese-writing-systems", "title": "Get VBA to recognize different Japanese writing systems", "body": "<p>Is there a way to get Excel VBA to recognize different Japanese writing systems? </p>\n\n<p>For example, say I wanted to perform a StrConv function with a Japanese sentence as my string, is there a way to separate out the hiragana/katakana/kanji and just do the StrConv on one writing system or the other?</p>\n"}, {"tags": ["vba", "excel", "user-defined-functions"], "comments": [{"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 2, "creation_date": 1485365297, "post_id": 41857688, "comment_id": 70899558, "body": "You have duplicate names in your scope.  You ask for variables <code>Candidate</code> and <code>Countries</code> to be passed to your function as arguments, and then you declare variables with identical names in the function itself.  Those can&#39;t be identical names, which is probably causing part of your issue. You then also try to use <code>Candidate.Value</code> when you tried to <code>Dim Candidate As String</code> and String variables don&#39;t have a .Value property (though the passed argument could if it was passed as a cell reference)."}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1485366205, "post_id": 41857688, "comment_id": 70900124, "body": "you should consider using the second parameter <code>Countries As Range</code>, will make your <b>UDF</b> code a lot simpler"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 1, "creation_date": 1485366800, "post_id": 41857688, "comment_id": 70900475, "body": "And you should declare <code>OECDCountry</code> to be a <code>String</code>.  And you will need to declare your UDF as being <code>Volatile</code> so that a change to the column listing all the countries will allow your UDF to be reinvoked.  And have you considered using <code>VLOOKUP</code> to do everything without the need for a UDF?"}], "answers": [{"comments": [{"owner": {"reputation": 277, "user_id": 6171363, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/f4c242bfa9b857f9771b918c56b17afc?s=128&d=identicon&r=PG&f=1", "display_name": "Patapunfate", "link": "https://stackoverflow.com/users/6171363/patapunfate"}, "edited": false, "score": 0, "creation_date": 1486138819, "post_id": 41899932, "comment_id": 71231473, "body": "Thank you for the answer. It was more difficult than I expected but now I think I understood"}], "tags": [], "owner": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "is_accepted": true, "score": 0, "last_activity_date": 1485538914, "creation_date": 1485538914, "answer_id": 41899932, "question_id": 41857688, "link": "https://stackoverflow.com/questions/41857688/invalid-name-entered-in-udf-with-vba-for-excel/41899932#41899932", "title": "Invalid name entered in UDF with VBA for Excel", "body": "<p>Well, I must say that I think that the OECD countries is an example of static data in that it does not change very often.  I would store the data on a sheet somewhere and then upon first request read it into a cache using a Scripting.Dictionary and then one can use the Exists method.  Here is my solution</p>\n\n<pre><code>Option Explicit\n\nPrivate mdicRunTimeCacheOECDCountries As Scripting.Dictionary\n\nSub DevTimeSetup_RunOnce()\n\n    ' ___          _____ _           ___      _               ___           ___\n    '|   \\ _____ _|_   _(_)_ __  ___/ __| ___| |_ _  _ _ __  | _ \\_  _ _ _ / _ \\ _ _  __ ___\n    '| |) / -_) V / | | | | '  \\/ -_)__ \\/ -_)  _| || | '_ \\ |   / || | ' \\ (_) | ' \\/ _/ -_)\n    '|___/\\___|\\_/  |_| |_|_|_|_\\___|___/\\___|\\__|\\_,_| .__/_|_|_\\\\_,_|_||_\\___/|_||_\\__\\___|\n    '                                                 |_| |___|                                           http://www.network-science.de/ascii/\n    '* just some code to set up a sheet with some data as OP supplied none\n    '* so that anyone can play with this problem\n    Dim rngOECD As Excel.Range\n    Set rngOECD = Sheet1.Range(Sheet1.Cells(1, 1), Sheet1.Cells(7, 1))\n    rngOECD.Value2 = [{\"USA\";\"UK\";\"Germany\";\"France\";\"Italy\";\"Japan\";\"Canada\"}] 'not full OECD, just G7\n    rngOECD.Name = \"OECDCountries\"\n\nEnd Sub\n\n\nPrivate Function GetRunTimeCacheOECDCountries() As Scripting.Dictionary\n    If mdicRunTimeCacheOECDCountries Is Nothing Then\n        Set mdicRunTimeCacheOECDCountries = New Scripting.Dictionary\n\n        Dim rngOECD As Excel.Range\n        Set rngOECD = Sheet1.Range(\"OECDCountries\")\n\n        Dim rngLoop As Excel.Range\n        For Each rngLoop In rngOECD\n            mdicRunTimeCacheOECDCountries.Add rngLoop.Value2, 0\n        Next\n\n    End If\n    Set GetRunTimeCacheOECDCountries = mdicRunTimeCacheOECDCountries\nEnd Function\n\n\n\nPublic Function OECD(Candidate) As Long\n    OECD = VBA.IIf(GetRunTimeCacheOECDCountries.Exists(Candidate), 1, 0)\nEnd Function\n</code></pre>\n\n<p>and call from worksheet with a cell formula like this</p>\n\n<p><code>=OECD(\"UK\")</code></p>\n"}], "owner": {"reputation": 277, "user_id": 6171363, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/f4c242bfa9b857f9771b918c56b17afc?s=128&d=identicon&r=PG&f=1", "display_name": "Patapunfate", "link": "https://stackoverflow.com/users/6171363/patapunfate"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 132, "favorite_count": 0, "accepted_answer_id": 41899932, "answer_count": 1, "score": 0, "last_activity_date": 1485538914, "creation_date": 1485364643, "last_edit_date": 1592644375, "question_id": 41857688, "link": "https://stackoverflow.com/questions/41857688/invalid-name-entered-in-udf-with-vba-for-excel", "title": "Invalid name entered in UDF with VBA for Excel", "body": "<p>I am making a simple UDF that checks if a given country is a member of the OECD. I have two inputs:</p>\n<ol>\n<li><p>Excel cell containing the name of the country</p>\n</li>\n<li><p>Input containing the first cell of a column containing all the OECD countries.</p>\n</li>\n</ol>\n<p>The function compares the content of the cell <code>Candidate</code> and of the column of <code>countries</code> via a loop. If the candidate name does not match with any of the OECD countries, in the end the function classifies it as a non-OECD country.</p>\n<p>My code is like this:</p>\n<pre><code>Function OECD(Candidate, Countries)\n    Dim Candidate As String\n    Dim Countries As String\n    OECDCountry = Countries 'Variable that changes at every iteration, I compare the name of the candidate to this\n    For i = 1 To 34     \n        If Candidate.Value = OECDCountry Then\n            OECD = 2                 \n        Else: OECDCountry = Countries.Offset(i, 0)\n    Next i\n\n'If the column next to the candidate name, where I am running this function, is still empty, record the country as non-OECD\n\n    If Candidate.Offset(0, 1) &lt;&gt; 2 Then OECD = 1                \nEnd Function\n</code></pre>\n<p>However, when I try to use the function, I receive the following error message while selecting the second input:</p>\n<blockquote>\n<p>The name that you entered is not valid. Reasons for this can include:</p>\n<p>-The name does not begin with a letter or an underscore</p>\n<p>-The name contains a space or other invalid characters</p>\n<p>-The name conflicts with an Excel built-in name or the name of another object in the workbook</p>\n</blockquote>\n<p>Why do I receive this error message and how can I fix it?</p>\n"}, {"tags": ["regex", "excel", "vba", "textbox"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1485364489, "post_id": 41857339, "comment_id": 70899026, "body": "Set the <code>MaxLength</code> property for each box, and handle textbox events, e.g. <code>txtPalletID_KeyDown</code> if you want to intercept individual keys (and actually <i>prevent</i> them from even being entered in the first place), or <code>txtPalletID_Exit</code> to validate the content when the focus switches to another control (and possibly cancel it and force the focus back into the textbox); that way you can make the <code>Agregar</code> button disabled until all fields are known to be valid... but that&#39;s quite broad a subject for a single SO question. Try something, get stuck, come back with a <i>specific</i> issue =)"}, {"owner": {"reputation": 211, "user_id": 6595126, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/GnFW1.jpg?s=128&g=1", "display_name": "Deluq", "link": "https://stackoverflow.com/users/6595126/deluq"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1485368013, "post_id": 41857339, "comment_id": 70901208, "body": "let me give it a try thanks :)"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1485423290, "post_id": 41857339, "comment_id": 70922928, "body": "@Deluq read my answer and code below"}], "answers": [{"comments": [{"owner": {"reputation": 211, "user_id": 6595126, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/GnFW1.jpg?s=128&g=1", "display_name": "Deluq", "link": "https://stackoverflow.com/users/6595126/deluq"}, "edited": false, "score": 0, "creation_date": 1485468704, "post_id": 41870422, "comment_id": 70950210, "body": "Shai, Thanks for your time !"}], "tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": true, "score": 2, "last_activity_date": 1485423209, "creation_date": 1485423209, "answer_id": 41870422, "question_id": 41857339, "link": "https://stackoverflow.com/questions/41857339/apply-regex-into-a-textbox-form-vba/41870422#41870422", "title": "Apply Regex into a textbox form VBA", "body": "<p>I'v created a sample <code>User_Form</code> and a <code>CommandButton</code> (like a \"confirm\" button) that's once it's pressed it checks that all the values entered in the <code>TextBox</code>es are according to the rules.</p>\n\n<p>The code below will get you started, it checks the values in \"Pallet ID\" (9-digits) and \"Carton ID\" (10-digits).</p>\n\n<p><strong>Code</strong></p>\n\n<pre><code>Option Explicit\n\nPrivate Sub CommandButton1_Click()\n\nDim Reg1 As Object\nDim Reg2 As Object\n\nDim RegMatches As Object\n\n' ====== Test PalletID_Tb =====\nSet Reg1 = CreateObject(\"VBScript.RegExp\")\nWith Reg1\n    .Global = True\n    .IgnoreCase = True\n    .Pattern = \"\\d{9,9}\" ' Match any set of 9 digits\nEnd With\n\nSet RegMatches = Reg1.Execute(Me.PalletID_Tb.Value)\n\nIf RegMatches.Count = 1 Then '&lt;-- make sure there is only 1 match (9 digits and not 18 or 27)\n    MsgBox \"Value in Pallet ID is OK\"\nElse\n    MsgBox \"Pallet ID must have a 9 digit format\"\n    Me.PalletID_Tb.Value = \"\"\n    Exit Sub\nEnd If\n\n' ====== Test CartonID_Tb =====\nSet Reg2 = CreateObject(\"VBScript.RegExp\")\nWith Reg2\n    .Global = True\n    .IgnoreCase = True\n    .Pattern = \"\\d{10,10}\" ' Match any set of 10 digits\nEnd With\n\nSet RegMatches = Reg2.Execute(Me.CartonID_Tb.Value)\n\nIf RegMatches.Count = 1 Then '&lt;-- make sure there is only 1 match (10 digits and not 20)\n    MsgBox \"Value in Carton ID is OK\"\nElse\n    MsgBox \"Carton ID must have a 10 digit format\"\n    Me.CartonID_Tb.Value = \"\"\n    Exit Sub\nEnd If\n\n' Do something if passed the 2 conditions\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 211, "user_id": 6595126, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/GnFW1.jpg?s=128&g=1", "display_name": "Deluq", "link": "https://stackoverflow.com/users/6595126/deluq"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1020, "favorite_count": 0, "accepted_answer_id": 41870422, "answer_count": 1, "score": -1, "last_activity_date": 1485423209, "creation_date": 1485363633, "question_id": 41857339, "link": "https://stackoverflow.com/questions/41857339/apply-regex-into-a-textbox-form-vba", "title": "Apply Regex into a textbox form VBA", "body": "<p>I need your help guys. How can I limit my textboxes? This is my Form Below.\n<a href=\"https://i.stack.imgur.com/qWNeG.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/qWNeG.png\" alt=\"enter image description here\"></a></p>\n\n<p>What I need is to create if statement for the following textboxes:\nPallet ID: Must only contain 9 numbers\nCarton ID: Must only contain 10 numbers\nSerials (all 6): Must startwith FOC and only contain CAPS and Numbers [A-Z][0-9]</p>\n\n<p>I did this in Javascript but now I need to have a backup in a excelsheet. Any ideas?</p>\n\n<p>Thanks for your attention,</p>\n"}, {"tags": ["vba", "excel", "pivot-table", "autofilter"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 7463030, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2163bbc623c6b75eb3dd75255d0837f7?s=128&d=identicon&r=PG&f=1", "display_name": "David Robinson", "link": "https://stackoverflow.com/users/7463030/david-robinson"}, "edited": false, "score": 0, "creation_date": 1485369018, "post_id": 41858074, "comment_id": 70901801, "body": "Thank you. Yes, that works. I recorded the macro and edited it in. Should have thought of that :-)  Thanks again Cyril."}], "tags": [], "owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "is_accepted": false, "score": 0, "last_activity_date": 1485365888, "creation_date": 1485365888, "answer_id": 41858074, "question_id": 41856894, "link": "https://stackoverflow.com/questions/41856894/how-to-auto-refresh-excel-auto-filter-results-after-excel-pivottable-auto-update/41858074#41858074", "title": "How to auto refresh Excel auto-filter results after Excel PivotTable auto update", "body": "<p>Two things I can think of... running a macro on activation or deactivation of a sheet.  </p>\n\n<pre><code>Private Sub Worksheet_Activate()\nWorksheet_Change 'Macro name\nEnd Sub\n</code></pre>\n\n<p>This would be tied specifically to the sheet for your summary.  Similarly, you would use Worksheet_Deactivate() tied to your other sheet.  You can also throw in the pivot table update to this same macro.</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 7463030, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2163bbc623c6b75eb3dd75255d0837f7?s=128&d=identicon&r=PG&f=1", "display_name": "David Robinson", "link": "https://stackoverflow.com/users/7463030/david-robinson"}, "is_accepted": false, "score": 0, "last_activity_date": 1485369374, "creation_date": 1485369374, "answer_id": 41859076, "question_id": 41856894, "link": "https://stackoverflow.com/questions/41856894/how-to-auto-refresh-excel-auto-filter-results-after-excel-pivottable-auto-update/41859076#41859076", "title": "How to auto refresh Excel auto-filter results after Excel PivotTable auto update", "body": "<p>The result of recording the macro (not updating the filter, but re-applying the choice of filtering by \"Y\") and editing it in is...</p>\n\n<pre><code>Private Sub Worksheet_Activate()\n    ActiveSheet.PivotTables(\"PivotTable1\").RefreshTable\n    On Error Resume Next\n        ActiveSheet.PivotTables(\"PivotTable1\").PivotFields(\"Selection\") _\n    .CurrentPage = \"Y\"\nEnd Sub\n</code></pre>\n\n<p>It works for me. I had to add the On Error to (clumsily) catch the case where there was no \"Y\" to filter by.</p>\n\n<p>If anyone needs a more generic solution to refresh the filtering without re-applying a specific filter choice, the above will not work, but that's no problem in my use case.</p>\n\n<p>Many thanks.</p>\n"}], "owner": {"reputation": 1, "user_id": 7463030, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2163bbc623c6b75eb3dd75255d0837f7?s=128&d=identicon&r=PG&f=1", "display_name": "David Robinson", "link": "https://stackoverflow.com/users/7463030/david-robinson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 6130, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1485369374, "creation_date": 1485362217, "question_id": 41856894, "link": "https://stackoverflow.com/questions/41856894/how-to-auto-refresh-excel-auto-filter-results-after-excel-pivottable-auto-update", "title": "How to auto refresh Excel auto-filter results after Excel PivotTable auto update", "body": "<p>I have created a \"Summary\" tab using an Excel Pivot Table.</p>\n\n<p>The Pivot Table shows the sums of selected values in various categories stored in a \"Details\" tab.</p>\n\n<p>The Details tab contains...</p>\n\n<pre><code>Select?   Type   Price\n   Y      Shoe   $1.25\n   N      Shoe   $1.50\n   Y      Boot   $2.00\n   N      Clog   $3.00\n   Y      Shoe   $0.50\n</code></pre>\n\n<p>The Summary tab shows a Pivot Table like this...</p>\n\n<pre><code>Select?       Y\n\nRow Labels    Sum of Price\nBoot          $2.00\nShoe          $1.75\n</code></pre>\n\n<p><strong>Whenever something is changed in the Details tab, and someone switches to the Summary tab, I want the Pivot Table to auto update to match the new data.</strong></p>\n\n<p>This is easy if just the values change (using the first code snippet below), but if the Y and N change, the filtering does not update. Anything that has changed from N to Y is not shown until the filtering is manually updated.</p>\n\n<p><em>This is what I have so far...</em></p>\n\n<p>The code to auto-update a Pivot Table is e.g. ...</p>\n\n<pre><code>Private Sub Worksheet_Activate()\n    Sheets(\"Summary\").PivotTables(\"PivotTable1\").RefreshTable\nEnd Sub\n</code></pre>\n\n<p>The code to auto-refresh an Excel auto-filter column in a table (that's <em>not</em> a Pivot Table) is e.g. ...</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    With ActiveWorkbook.Worksheets(\"Details\").ListObjects(\"Table1\")\n         .AutoFilter.ApplyFilter\n    End With\nEnd Sub\n</code></pre>\n\n<p>...but I cannot figure out how to apply AutoFilter.ApplyFilter to a Pivot Table. Any ideas? Or Equivalent?</p>\n\n<p>The nearest thing I found to touch the Pivot Table filter is this code which will turn the part I want to update yellow...</p>\n\n<pre><code>Worksheets(\"Details\").PivotTables(\"PivotTable1\") _\n    .PageRange.Interior.Color = vbYellow\n</code></pre>\n\n<p>...but I don't want to turn it yellow :-) , I want to re-apply the filter to the modified data so I see what I <em>should</em> see, rather than the wrong values and missing rows.</p>\n\n<p>Many thanks.</p>\n"}, {"tags": ["mysql", "vba", "excel", "odbc"], "comments": [{"owner": {"reputation": 4114, "user_id": 5751805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da1c3545802a510a9b283f706d74283a?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan", "link": "https://stackoverflow.com/users/5751805/jordan"}, "edited": false, "score": 0, "creation_date": 1485361162, "post_id": 41856335, "comment_id": 70896707, "body": "Are you sure the columns are simply not wide enough to show the date? If a column is not wide enough to display a date in full it will only show <code>#####</code>"}], "answers": [{"comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1485364007, "post_id": 41856647, "comment_id": 70898714, "body": "That is a <i>somewhat</i> acceptable solution, only because <i>the data</i> contains dates that are outside the valid date range (format <code>0</code> as a short date in Excel, you&#39;ll get <code>1&#47;0&#47;1900</code>, so the earliest valid date in Excel is <code>1&#47;1&#47;1900</code>). The problem it creates, is that Excel won&#39;t treat dates as such. See <a href=\"http://www.exceluser.com/formulas/earlydates.htm\" rel=\"nofollow noreferrer\">how to work with dates before 1900 in Excel</a> for more information."}, {"owner": {"reputation": 21, "user_id": 6949811, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f84485eeebbbaa991aa54c28758363c2?s=128&d=identicon&r=PG&f=1", "display_name": "user6949811", "link": "https://stackoverflow.com/users/6949811/user6949811"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1485446491, "post_id": 41856647, "comment_id": 70937358, "body": "In this case, the fact that they aren&#39;t formatted as dates within Excel isn&#39;t a big deal to me. But I understand where you&#39;re coming from if down the road I need to format them as dates."}], "tags": [], "owner": {"reputation": 21, "user_id": 6949811, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f84485eeebbbaa991aa54c28758363c2?s=128&d=identicon&r=PG&f=1", "display_name": "user6949811", "link": "https://stackoverflow.com/users/6949811/user6949811"}, "is_accepted": false, "score": 1, "last_activity_date": 1485367838, "last_edit_date": 1485367838, "creation_date": 1485361564, "answer_id": 41856647, "question_id": 41856335, "link": "https://stackoverflow.com/questions/41856335/excel-vba-odbc-connection-imported-column-formatting/41856647#41856647", "title": "Excel VBA ODBC connection imported column formatting", "body": "<p>Posting the answer to my own question for future posterity:</p>\n\n<p>Where my <code>SELECT</code> statement is <code>EFF_DATE</code>, I changed it to read <code>CAST(EFF_DATE as varchar(30))</code> which then maintains the format from the database itself.</p>\n"}], "owner": {"reputation": 21, "user_id": 6949811, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f84485eeebbbaa991aa54c28758363c2?s=128&d=identicon&r=PG&f=1", "display_name": "user6949811", "link": "https://stackoverflow.com/users/6949811/user6949811"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 518, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1485367838, "creation_date": 1485360627, "last_edit_date": 1485363592, "question_id": 41856335, "link": "https://stackoverflow.com/questions/41856335/excel-vba-odbc-connection-imported-column-formatting", "title": "Excel VBA ODBC connection imported column formatting", "body": "<p>I'm looking for a way to reformat some fields that are being imported to my sheet using an ODBC connection. The fields in particular are the date fields. I need to import these as text or some other format because the data in the database will sometimes have dates of \"1850-01-01\" or \"0001-01-01\". When importing into excel, the dates just show as #### signs.</p>\n\n<p>Here is the <em>edited</em> query I'm currently using:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Public Sub REFRESH_DATA()\n\nDim cnDB As New ADODB.Connection    'Declare the connection object.\nDim rsRecords As New ADODB.Recordset 'Declare a Recordset object.\n\n'Open the connection\n\ncnDB.Open \"DSN=DB;Database=DB;Servername=server.net;UID=username;Password=password;Port=0000;ReadOnly=0;SQLBitOneZero=0;LegacySQLTables=0;NumericAsChar=0;ShowSystemTables=0;LoginTimeout=0;QueryTimeout=0;DateFormat=1;SecurityLevel=onlySecured;CaCertFile=\"\n\nrsRecords.Open \"SELECT REGION_CD, CUST_NO, EFF_DATE FROM DATABASE.TABLE\", cnDB\n\n'Print the records in the correct table\n.Range(\"A2\").CopyFromRecordset rsRecords\n\n'Close everything\nrsRecords.Close\nSet rsRecords = Nothing\ncnDB.Close\nSet cnDB = Nothing\n\nEnd Sub\n</code></pre>\n\n<p>The column <code>EFF_DATE</code> is the column in question.</p>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1485364781, "post_id": 41856025, "comment_id": 70899185, "body": "Use <i>IntelliSense</i> to browse an object&#39;s members in the code pane, or use the <i>Object Browser</i> (F2) to explore what&#39;s available."}], "answers": [{"comments": [{"owner": {"reputation": 99, "user_id": 4787901, "user_type": "registered", "accept_rate": 57, "profile_image": "https://lh4.googleusercontent.com/-MOyyJF7wZGM/AAAAAAAAAAI/AAAAAAAAAYY/JXxpjKl8A64/photo.jpg?sz=128", "display_name": "Dennis Grasso", "link": "https://stackoverflow.com/users/4787901/dennis-grasso"}, "edited": false, "score": 0, "creation_date": 1485361054, "post_id": 41856154, "comment_id": 70896640, "body": "thank you! the method &quot;checked&quot; comes from internet.. I also googled for &quot;get checkbox value&quot; .. anyway thanks!! :)"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1485364651, "post_id": 41856154, "comment_id": 70899110, "body": "Note, <code>If printa.Value = True Then</code> is redundant. <code>If printa.Value Then</code> would be enough."}], "tags": [], "owner": {"reputation": 356, "user_id": 6834551, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/576a6f5a5155d448f650296fb4b4e749?s=128&d=identicon&r=PG&f=1", "display_name": "finjo", "link": "https://stackoverflow.com/users/6834551/finjo"}, "is_accepted": true, "score": 1, "last_activity_date": 1485360124, "creation_date": 1485360124, "answer_id": 41856154, "question_id": 41856025, "link": "https://stackoverflow.com/questions/41856025/excel-vb-get-the-value-checked-unchecked-for-a-checkbox/41856154#41856154", "title": "Excel VB: get the value checked/unchecked for a checkbox", "body": "<p>The property you want to use is <code>Value</code>:</p>\n\n<pre><code>If printa.Value = True Then\n    objDoc.PrintOut\nElse\n    objDoc.Close\nEnd If\n</code></pre>\n\n<p>(There's also a typo in your <code>objDoc.Close</code>)</p>\n"}], "owner": {"reputation": 99, "user_id": 4787901, "user_type": "registered", "accept_rate": 57, "profile_image": "https://lh4.googleusercontent.com/-MOyyJF7wZGM/AAAAAAAAAAI/AAAAAAAAAYY/JXxpjKl8A64/photo.jpg?sz=128", "display_name": "Dennis Grasso", "link": "https://stackoverflow.com/users/4787901/dennis-grasso"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 710, "favorite_count": 0, "accepted_answer_id": 41856154, "answer_count": 1, "score": 0, "last_activity_date": 1485360124, "creation_date": 1485359751, "question_id": 41856025, "link": "https://stackoverflow.com/questions/41856025/excel-vb-get-the-value-checked-unchecked-for-a-checkbox", "title": "Excel VB: get the value checked/unchecked for a checkbox", "body": "<p>I'm not able to get the value of a checkbox..</p>\n\n<p>I've googled a lot but I really can't find the error.</p>\n\n<p>Anyway this is my code:</p>\n\n<pre><code>If printa.Checked = True Then\nobjDoc.PrintOut\nElse\nbjDoc.Close\nEnd If\n</code></pre>\n\n<p>The chechbox's name in the Userform is \"printa\".</p>\n\n<p>I get the error that it can't find the method or the object.</p>\n\n<p>Any advice?</p>\n\n<p>Thanks\nDennis</p>\n"}, {"tags": ["vba", "excel", "if-statement", "invalid-argument"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 5, "creation_date": 1485359282, "post_id": 41855779, "comment_id": 70895335, "body": "<code>Worksheets(&quot;Graph&quot;).Range(Cells(i, 7), Cells(i, 10)).ClearContents</code>  Range only allows two arguments a start cell and an end cell."}, {"owner": {"reputation": 215, "user_id": 5244615, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/ad068c341805464626762aee390d44b4?s=128&d=identicon&r=PG&f=1", "display_name": "Dullspark", "link": "https://stackoverflow.com/users/5244615/dullspark"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1485359569, "post_id": 41855779, "comment_id": 70895560, "body": "Well that was simple, thank you!"}], "answers": [{"tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": true, "score": 1, "last_activity_date": 1485359452, "creation_date": 1485359452, "answer_id": 41855912, "question_id": 41855779, "link": "https://stackoverflow.com/questions/41855779/wrong-number-of-arguments-or-invalid-property-assignment-error-when-trying-to/41855912#41855912", "title": "&quot;Wrong number of arguments or invalid property assignment&quot; Error when trying to delete values in cells", "body": "<p>Try something like this:</p>\n\n<pre><code>with Worksheets(\"Graph\")\n    .Range(.Cells(i, 7), .Cells(i, 10)).ClearContents\nend with\n</code></pre>\n\n<p>The idea is that the <code>.</code> is a way to refer the worksheet and that is needed, when you refer to cells.</p>\n"}], "owner": {"reputation": 215, "user_id": 5244615, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/ad068c341805464626762aee390d44b4?s=128&d=identicon&r=PG&f=1", "display_name": "Dullspark", "link": "https://stackoverflow.com/users/5244615/dullspark"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 758, "favorite_count": 0, "accepted_answer_id": 41855912, "answer_count": 1, "score": 0, "last_activity_date": 1528980682, "creation_date": 1485359084, "last_edit_date": 1528980682, "question_id": 41855779, "link": "https://stackoverflow.com/questions/41855779/wrong-number-of-arguments-or-invalid-property-assignment-error-when-trying-to", "title": "&quot;Wrong number of arguments or invalid property assignment&quot; Error when trying to delete values in cells", "body": "<p>the segment of my code is as follows,</p>\n\n<pre><code>If Not Column2 = Empty Then\n    Set Rg2 = sheet.Cells.Find(What:=Column2)\n    If Not Rg2 Is Nothing Then\n        Column2Width = Rg2.MergeArea.Columns.Count - 1\n        StartCol2Column = Rg2.Column\n        EndCol2Column = StartCol2Column + Column2Width\n    Else\n        MsgBox Column2 &amp; \" not found in \" &amp; BalkanSheet.Name\n    End If\n    Else\n    Worksheets(\"Graph\").Range(Cells(i, 7), Cells(i, 8), Cells(i, 9), Cells(i, 10)).Value = \"\"\nEnd If\n</code></pre>\n\n<p>When i try to run it i get an error with the line <code>Worksheets(\"Graph\").Range(Cells(i, 7), Cells(i, 8), Cells(i, 9), Cells(i, 10)).Value = \"\"</code>, saying \"Wrong number of arguments or invalid property assignment\".</p>\n\n<p>The i value is a variable that is set earlier in the code. What i want the code to do is if the If statement is false (Else) then it will delete the values in the cells specified. </p>\n\n<p>Any ideas?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 3638, "user_id": 1652222, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/4W5ez.jpg?s=128&g=1", "display_name": "ManishChristian", "link": "https://stackoverflow.com/users/1652222/manishchristian"}, "edited": false, "score": 1, "creation_date": 1485359717, "post_id": 41855683, "comment_id": 70895689, "body": "DOM properties for element on both the tabs are same, so why don&#39;t you first click on desired tab and then enter the value..."}], "answers": [{"tags": [], "owner": {"reputation": 11755, "user_id": 4797603, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/AwTvE.jpg?s=128&g=1", "display_name": "Ronnie Royston", "link": "https://stackoverflow.com/users/4797603/ronnie-royston"}, "is_accepted": false, "score": 0, "last_activity_date": 1485371157, "creation_date": 1485371157, "answer_id": 41859620, "question_id": 41855683, "link": "https://stackoverflow.com/questions/41855683/excel-vba-with-gift-card-web-site/41859620#41859620", "title": "Excel VBA With Gift Card Web Site", "body": "<p>You'll need to use Microsoft's very own XMLHTTPRequest (may need to add a reference in VBA) to POST or PUT, otherwise you'll have to use the crappy <code>sendkeys</code> library to interact with websites.  XHR should work just fine for you.  Just google VBA XHR PUT.</p>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 6928507, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca995b1bda1358e65cb0d956abcc68eb?s=128&d=identicon&r=PG&f=1", "display_name": "Eric B", "link": "https://stackoverflow.com/users/6928507/eric-b"}, "is_accepted": true, "score": 0, "last_activity_date": 1485696009, "creation_date": 1485696009, "answer_id": 41921339, "question_id": 41855683, "link": "https://stackoverflow.com/questions/41855683/excel-vba-with-gift-card-web-site/41921339#41921339", "title": "Excel VBA With Gift Card Web Site", "body": "<p>I was able to accomplish what I wanted with <code>IE.Document.getElementsByName(\"CardNumber\")(1).Value = \"1234\"</code>. Thanks for the suggestions.</p>\n"}], "owner": {"reputation": 11, "user_id": 6928507, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca995b1bda1358e65cb0d956abcc68eb?s=128&d=identicon&r=PG&f=1", "display_name": "Eric B", "link": "https://stackoverflow.com/users/6928507/eric-b"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 82, "favorite_count": 1, "accepted_answer_id": 41921339, "answer_count": 2, "score": 0, "last_activity_date": 1485696009, "creation_date": 1485358839, "last_edit_date": 1485370888, "question_id": 41855683, "link": "https://stackoverflow.com/questions/41855683/excel-vba-with-gift-card-web-site", "title": "Excel VBA With Gift Card Web Site", "body": "<p>Update: I'm redoing my question to hopefully make is simple to understand.</p>\n\n<p>From the web site <a href=\"https://mygift.giftcardmall.com\" rel=\"nofollow noreferrer\">https://mygift.giftcardmall.com</a>, I'm trying to find out how I can enter info for the \"Card Number\" box in the \"Check Balance / Transactions\" tab only.</p>\n\n<p>I have tried <code>IE.Document.getElementByid(\"CardNumber\").Value = \"1234\"</code> but this only enters the value on the \"Card Number\" box of the \"Register Card\" tab. Any suggestions are greatly appreciated. Thanks</p>\n"}, {"tags": ["excel", "vba", "sorting", "excel-formula"], "comments": [{"owner": {"reputation": 3541, "user_id": 1616731, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/c9adb6c09548c81a8a9a46d7497081f6?s=128&d=identicon&r=PG&f=1", "display_name": "Tim Wilkinson", "link": "https://stackoverflow.com/users/1616731/tim-wilkinson"}, "edited": false, "score": 2, "creation_date": 1485358345, "post_id": 41855377, "comment_id": 70894645, "body": "Is the question &quot;Can it be done?&quot; in which case the answer is yes, if you are asking how, your best bet is to post what you have done so far and where you are getting errors and then we can help from there."}, {"owner": {"reputation": 15, "user_id": 6889209, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0168fe3fb55113ed336956806832bf5?s=128&d=identicon&r=PG&f=1", "display_name": "c.p.man", "link": "https://stackoverflow.com/users/6889209/c-p-man"}, "reply_to_user": {"reputation": 3541, "user_id": 1616731, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/c9adb6c09548c81a8a9a46d7497081f6?s=128&d=identicon&r=PG&f=1", "display_name": "Tim Wilkinson", "link": "https://stackoverflow.com/users/1616731/tim-wilkinson"}, "edited": false, "score": 0, "creation_date": 1485360706, "post_id": 41855377, "comment_id": 70896384, "body": "Hi Tim, thanks for your response. Please forgive me if my question was not clear enough. Indeed, the question is can it be done? and thereafter could any one guide me in the right direction?"}, {"owner": {"reputation": 3541, "user_id": 1616731, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/c9adb6c09548c81a8a9a46d7497081f6?s=128&d=identicon&r=PG&f=1", "display_name": "Tim Wilkinson", "link": "https://stackoverflow.com/users/1616731/tim-wilkinson"}, "edited": false, "score": 0, "creation_date": 1485361389, "post_id": 41855377, "comment_id": 70896866, "body": "Should probably look up a few things, look up &#39;how to fire macro on cell change&#39;, that will take care of your dropdown change. Look at search a range for a value and returning the column, that will give you which column to filter by for use in something like <code>ActiveSheet.Range(&quot;$A$1:$M$60&quot;).AutoFilter Field:=2</code>. Then look up the VBA for sorting values highest to lowest."}], "owner": {"reputation": 15, "user_id": 6889209, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0168fe3fb55113ed336956806832bf5?s=128&d=identicon&r=PG&f=1", "display_name": "c.p.man", "link": "https://stackoverflow.com/users/6889209/c-p-man"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 76, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1485360886, "creation_date": 1485358061, "last_edit_date": 1485360886, "question_id": 41855377, "link": "https://stackoverflow.com/questions/41855377/sorting-extracting-data-on-excel-through-a-drop-down-list", "title": "Sorting &amp; Extracting Data On Excel Through a Drop Down List", "body": "<p>I am trying to develop a database interface on Excel for my colleagues which will allow them to sort through metrics of our Facebook videos. </p>\n\n<p>The database looks like this: </p>\n\n<p><a href=\"https://i.stack.imgur.com/oT8Xr.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/oT8Xr.png\" alt=\"Database example\"></a></p>\n\n<p>To date they have been using the custom sort feature on excel each time they want to find the best video per specified criteria e.g views, shares, or comments</p>\n\n<p>In order to simplify the process, I thought of building a small interface on a separate excel tab which would allow the same custom sorting features but through the use of a drop down list. </p>\n\n<p>e.g Let's say they would like to sort the best performing videos by user engagement: </p>\n\n<p><a href=\"https://i.stack.imgur.com/FWOCf.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/FWOCf.png\" alt=\"Drop down sort example\"></a></p>\n\n<p>This would then return the top 5 videos with the highest engagement. </p>\n\n<p>Custom sort allows multiple sorts on excel So I was wondering if I could go a step further and replicate this feature through multiple drop down lists? </p>\n\n<p>I hope that I was clear enough with my questioning and my snapshot examples. I look forward to hearing your responses. </p>\n\n<p>Many thanks!</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 0, "creation_date": 1485358139, "post_id": 41855236, "comment_id": 70894481, "body": "Could you simply comment the culprit lines? Or are you using these on another computer?"}], "answers": [{"comments": [{"owner": {"reputation": 408, "user_id": 3017280, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/fa065db304d3d31ffe60aeeba84ba13f?s=128&d=identicon&r=PG&f=1", "display_name": "Knackiedoo", "link": "https://stackoverflow.com/users/3017280/knackiedoo"}, "edited": false, "score": 0, "creation_date": 1485362652, "post_id": 41855913, "comment_id": 70897742, "body": "Many thanks.  This looks to be just what I am after.  I will test this tomorrow."}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1485362699, "post_id": 41855913, "comment_id": 70897774, "body": "I knew about conditional compilation when using different versions of Excel, 64/32 bit type stuff.  Never knew about the argument option in the properties though.  18 years with Excel and still learning.  Cheers.  :)"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 2, "creation_date": 1485363349, "post_id": 41855913, "comment_id": 70898253, "body": "@DarrenBartrup-Cook you can also define module-level precompiler constants with <code>#Const</code>, e.g. <code>#Const DEBUG_MODE = 1</code>. Also my <a href=\"http://rubberduckvba.com\" rel=\"nofollow noreferrer\">Rubberduck</a> addin unfortunately doesn&#39;t see project-level constants (they&#39;re nowhere in the darn VBIDE API!), but will correctly evaluate &quot;dead code&quot; (off <code>#If</code> directives) as such, and ignore it... so if you&#39;re using Rubberduck it&#39;s probably better to use <code>#Const</code> directives instead of project-level constants."}, {"owner": {"reputation": 408, "user_id": 3017280, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/fa065db304d3d31ffe60aeeba84ba13f?s=128&d=identicon&r=PG&f=1", "display_name": "Knackiedoo", "link": "https://stackoverflow.com/users/3017280/knackiedoo"}, "edited": false, "score": 1, "creation_date": 1485371081, "post_id": 41855913, "comment_id": 70903018, "body": "Very many thanks for pointing me in the direction of Conditional Compilation.  It works perfectly.  I ended up using a test of Environ$(&quot;computername&quot;) in the calling module to set #Const in the offending module, so I don&#39;t need to modify anything when using the code on different computers (I know the name of the problem one). I could even search for POWERPNT.EXE or similar to set #Const if I wanted to make it more generic, though I don&#39;t need to go that far at present. Problem solved!"}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 0, "creation_date": 1485417249, "post_id": 41855913, "comment_id": 70919821, "body": "@Mat&#39;sMug : &lt;3 Always learning stuff when I read your posts! :)"}], "tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": true, "score": 2, "last_activity_date": 1485360403, "last_edit_date": 1485360403, "creation_date": 1485359453, "answer_id": 41855913, "question_id": 41855236, "link": "https://stackoverflow.com/questions/41855236/avoiding-cant-find-project-or-library-on-computer-without-app-installed/41855913#41855913", "title": "Avoiding &quot;Can&#39;t find project or library&quot; on computer without app installed", "body": "<blockquote>\n  <p><em>Is there any way around this, e.g. getting Excel to ignore this module and not try to compile it unless it is called?</em></p>\n</blockquote>\n\n<p>You could try <em>conditional compilation</em>, that's pretty much exactly what it does.</p>\n\n<p>Open up the <em>project properties</em> dialog, and define a project-level conditional compilation constant:</p>\n\n<p><img src=\"https://i.stack.imgur.com/wc6PV.png\" alt=\"Project Properties dialog\"></p>\n\n<p>Now wrap the PowerPoint-dependent module with <code>#If</code> directives:</p>\n\n<pre><code>Option Explicit\n#If HAS_POWERPOINT = 1 Then\n'... entire module body ...\n#End If\n</code></pre>\n\n<p>Then, everywhere you have a piece of code that calls into the conditionally-compiled module, surround it with <code>#If</code> directives:</p>\n\n<pre><code>#If HAS_POWERPOINT = 1 Then\n    MyProcedureThatRunsOffPowerPoint \"foo\", \"bar\", 42\n#Else\n    'PowerPoint-dependent module doesn't exist, what do we do instead?\n#End If\n</code></pre>\n\n<p>Now when you distribute the macro to the machine that doesn't have PowerPoint installed, you go to <em>project properties</em> and set the constant to 0, then recompile the project.</p>\n"}], "owner": {"reputation": 408, "user_id": 3017280, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/fa065db304d3d31ffe60aeeba84ba13f?s=128&d=identicon&r=PG&f=1", "display_name": "Knackiedoo", "link": "https://stackoverflow.com/users/3017280/knackiedoo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 554, "favorite_count": 3, "accepted_answer_id": 41855913, "answer_count": 1, "score": 2, "last_activity_date": 1485360403, "creation_date": 1485357666, "last_edit_date": 1485357968, "question_id": 41855236, "link": "https://stackoverflow.com/questions/41855236/avoiding-cant-find-project-or-library-on-computer-without-app-installed", "title": "Avoiding &quot;Can&#39;t find project or library&quot; on computer without app installed", "body": "<p>I have created an Excel file which contains one module which refers to Powerpoint.  </p>\n\n<p>I want to use the other modules in this file on a server which does not have Powerpoint installed (long story...), but cannot do this without incurring the dreaded <em>Can't find project or library</em> error message. </p>\n\n<p>Of course I can simply create another version with the offending module deleted, which obviously works fine. \n<br>However, there are several reasons why I don't want to do this, not least that I really don't want to have to maintain multiple versions if I can help it.  </p>\n\n<p>Is there any way around this, e.g. getting Excel to ignore this module and not try to compile it unless it is called?  </p>\n\n<p>I have waded through 41 posts on stackoverflow on this topic, without finding anything that helps, which makes me suspect that I am asking the impossible.</p>\n\n<p>There are some suggestions that late binding might help, but it does not seem to make any difference.  Here is the offending code:</p>\n\n<pre><code>Dim PowerPointApp As Object\nOn Error Resume Next\n  Set PowerPointApp = GetObject(class:=\"PowerPoint.Application\")\n  Err.Clear\n  If PowerPointApp Is Nothing Then\n    Set PowerPointApp = CreateObject(class:=\"PowerPoint.Application\")\n  End If\nOn Error GoTo 0\n</code></pre>\n\n<p>None of the other modules make any reference to Powerpoint.</p>\n"}, {"tags": ["vba", "ms-access", "sql-like"], "comments": [{"owner": {"reputation": 7422, "user_id": 1586390, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f07270207034d2bcbe347b028edc8f02?s=128&d=identicon&r=PG", "display_name": "Sorceri", "link": "https://stackoverflow.com/users/1586390/sorceri"}, "edited": false, "score": 1, "creation_date": 1485357805, "post_id": 41855153, "comment_id": 70894235, "body": "you only need the * at the end: Like &#39;&quot; &amp; StreetInitial &amp; &quot;*&#39;;&quot;"}, {"owner": {"reputation": 15, "user_id": 7437446, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/92f1dd27945548532d87d954e65ec537?s=128&d=identicon&r=PG&f=1", "display_name": "NSmith", "link": "https://stackoverflow.com/users/7437446/nsmith"}, "reply_to_user": {"reputation": 7422, "user_id": 1586390, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f07270207034d2bcbe347b028edc8f02?s=128&d=identicon&r=PG", "display_name": "Sorceri", "link": "https://stackoverflow.com/users/1586390/sorceri"}, "edited": false, "score": 0, "creation_date": 1485357968, "post_id": 41855153, "comment_id": 70894356, "body": "Wow, thanks a million! Obviously wasnt paying attention when i wrote that!"}], "owner": {"reputation": 15, "user_id": 7437446, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/92f1dd27945548532d87d954e65ec537?s=128&d=identicon&r=PG&f=1", "display_name": "NSmith", "link": "https://stackoverflow.com/users/7437446/nsmith"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 985, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1485357435, "creation_date": 1485357435, "question_id": 41855153, "link": "https://stackoverflow.com/questions/41855153/ms-access-vba-using-like-with-textbox-value", "title": "Ms Access VBA - Using Like with textbox value", "body": "<p>Just having a little trouble using the Like operator with strSQL in vba for ms access. Currently i have a form that when textboxes are filled in, the listboxes rowsources are re-queried using the value of a textbox. Most of these work perfectly, except when i attempt this strSQL query:</p>\n\n<pre><code>SelectedContract = Me.List4.Column(0)\nStreetInitial = Text6 + \"*\"\nDim ConId As Integer\nConId = DLookup(\"[id]\", \"[Portal Contract]\", \"[contract_no] = \"\"\" &amp; SelectedContract &amp; \"\"\"\")\n\n\nDim selectParas As String\nselectParas = \"SELECT a.street, a.mh1, a.mh2, a.diameter, a.thickness, a.parameters_id, a.installation_date \" &amp; _\n              \" FROM [Portal Sample] As a WHERE a.contract_id = \" &amp; ConId &amp; \" And a.street Like '*\" &amp; StreetInitial &amp; \"*';\"\n\nMe.List9.RowSource = selectParas\nMe.List9.Requery\n</code></pre>\n\n<p>Text6 prompts the user for the street initial, and i am trying to search all entries that start with that initial. I tried appending * to the string to see if the Like in the selectParas statement would treat it as the special character and only search for entries beginning with text6 with any following characters, but it doesn't seem to be working, and returns all entries that just contain the character in Text6.</p>\n"}, {"tags": ["vba", "excel", "import", "ms-access-2010"], "comments": [{"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1485359546, "post_id": 41854870, "comment_id": 70895539, "body": "<i>import access records into excel</i>...really it should be the other way!"}], "answers": [{"tags": [], "owner": {"reputation": 136, "user_id": 4074875, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9903b480829907faba4011dfc1a1c147?s=128&d=identicon&r=PG", "display_name": "user4074875", "link": "https://stackoverflow.com/users/4074875/user4074875"}, "is_accepted": true, "score": 1, "last_activity_date": 1485357401, "creation_date": 1485357401, "answer_id": 41855140, "question_id": 41854870, "link": "https://stackoverflow.com/questions/41854870/import-mdb-table-into-excel-via-vba-need-field-names-headers/41855140#41855140", "title": "Import MDB Table into EXCEL via vba - Need field names/headers", "body": "<p>This is what I use-</p>\n\n<pre><code>Private Sub PullSummaryData()\nConst strDb As String = \"C:\\db\\AccessDatabase.accdb\"\nDim rs As ADODB.Recordset\nDim cn As ADODB.Connection\nDim i As Integer\n\nSheets(\"Summary\").Select\n\n  Const strQry As String = \"SELECT * FROM [AccessDataTable]\"\n\n  Set cn = New ADODB.Connection\n  cn.Open \"Provider=Microsoft.ACE.OLEDB.12.0;Data Source=\" &amp; strDb &amp; \";\"\n\n  Set rs = New ADODB.Recordset\n\n  With rs\n    Set .ActiveConnection = cn\n    .Open strQry\n  End With\n\nWith Sheets(\"Summary\")\n  For i = 1 To rs.Fields.Count\n    .Cells(2,i).Value = rs.Fields(i-1).Name  'fields is a 0 based collection\n  Next i\n  .Range(\"A3\").CopyFromRecordset rs\nEnd With\n\n  rs.Close\n  cn.Close\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 504, "user_id": 1560582, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/e2f2053d3cf39be2d61c25c0a3f93f00?s=128&d=identicon&r=PG", "display_name": "kamelkid2", "link": "https://stackoverflow.com/users/1560582/kamelkid2"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 350, "favorite_count": 0, "accepted_answer_id": 41855140, "answer_count": 1, "score": 0, "last_activity_date": 1485357401, "creation_date": 1485356657, "question_id": 41854870, "link": "https://stackoverflow.com/questions/41854870/import-mdb-table-into-excel-via-vba-need-field-names-headers", "title": "Import MDB Table into EXCEL via vba - Need field names/headers", "body": "<p>I have this bit of code that I found online that will import access records into excel. strFilePath is the filepath for the MDB and strTableName is the table name I am looking to import</p>\n\n<pre><code>Sub importAccessdata()\n\nDim cnn As ADODB.Connection\nDim rs As ADODB.Recordset\nDim sQRY As String\nDim strFilePath As String\n\nstrFilePath = Sheets(\"Setup\").Range(\"C2\").Value\nstrTableName = Sheets(\"Setup\").Range(\"C4\").Value\n\nSet cnn = New ADODB.Connection\nSet rs = New ADODB.Recordset\n\ncnn.Open \"Provider=Microsoft.ACE.OLEDB.12.0;\" &amp; _\n\"Data Source=\" &amp; strFilePath &amp; \";\"\n\nsQRY = \"SELECT * FROM \" &amp; strTableName &amp; \"\"\n\nrs.CursorLocation = adUseClient\nrs.Open sQRY, cnn, adOpenStatic, adLockReadOnly\n\nApplication.ScreenUpdating = False\nSheet3.Range(\"A1\").CopyFromRecordset rs\n\nrs.Close\nSet rs = Nothing\ncnn.Close\nSet cnn = Nothing\nExit Sub\n\nEnd Sub\n</code></pre>\n\n<p>All of the records import very fast however I cannot get the field names to populate with them! Is there a simple modification I can do to carry the field names with the data?</p>\n"}, {"tags": ["html", "excel", "vba", "webpage"], "answers": [{"comments": [{"owner": {"reputation": 39, "user_id": 6932499, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/61b4a1e714f7a9246f0b044e0398dd9c?s=128&d=identicon&r=PG&f=1", "display_name": "Jimmy Huang", "link": "https://stackoverflow.com/users/6932499/jimmy-huang"}, "edited": false, "score": 0, "creation_date": 1485360161, "post_id": 41855675, "comment_id": 70895998, "body": "many thanks! It works, but why I only just need <code>.value</code> there? also, how can I simulate press ENTER button on the website !?"}, {"owner": {"reputation": 3638, "user_id": 1652222, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/4W5ez.jpg?s=128&g=1", "display_name": "ManishChristian", "link": "https://stackoverflow.com/users/1652222/manishchristian"}, "reply_to_user": {"reputation": 39, "user_id": 6932499, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/61b4a1e714f7a9246f0b044e0398dd9c?s=128&d=identicon&r=PG&f=1", "display_name": "Jimmy Huang", "link": "https://stackoverflow.com/users/6932499/jimmy-huang"}, "edited": false, "score": 0, "creation_date": 1485360909, "post_id": 41855675, "comment_id": 70896530, "body": "Glad to help. You just need to use <code>.value</code> because there is no such method as <code>.txtamount.Value</code> or <code>.txtamount.Text</code>. Check this <a href=\"https://msdn.microsoft.com/en-us/library/ms535841(v=vs.85).aspx\" rel=\"nofollow noreferrer\">link</a> for more info. Also check this <a href=\"http://stackoverflow.com/questions/17179872/i-need-to-find-and-press-a-button-on-a-webpage-using-vba\">link</a> to see how you can press a button. P.S. Google is your friend... :)"}], "tags": [], "owner": {"reputation": 3638, "user_id": 1652222, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/4W5ez.jpg?s=128&g=1", "display_name": "ManishChristian", "link": "https://stackoverflow.com/users/1652222/manishchristian"}, "is_accepted": false, "score": 1, "last_activity_date": 1485358815, "creation_date": 1485358815, "answer_id": 41855675, "question_id": 41854326, "link": "https://stackoverflow.com/questions/41854326/using-excel-vba-to-operate-web-page/41855675#41855675", "title": "Using excel vba to operate web page", "body": "<p>You're almost there. You need to use just <strong><code>.value</code></strong> to set or retrieve the displayed value for the control object. So here is your working code:  </p>\n\n<pre><code>For Each oHTML_Element_2 In HTMLDoc.getElementsByTagName(\"input\")\n    If oHTML_Element_2.className = \"name2\" And oHTML_Element_2.Type = \"text\" Then\n        oHTML_Element_2.Value = 123\n    End If\nNext  \n</code></pre>\n\n<p>Also, you don't need to click the object in order to set some value. You're good as long as it's getting identified properly.</p>\n"}], "owner": {"reputation": 39, "user_id": 6932499, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/61b4a1e714f7a9246f0b044e0398dd9c?s=128&d=identicon&r=PG&f=1", "display_name": "Jimmy Huang", "link": "https://stackoverflow.com/users/6932499/jimmy-huang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 503, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1485358815, "creation_date": 1485355158, "last_edit_date": 1485355411, "question_id": 41854326, "link": "https://stackoverflow.com/questions/41854326/using-excel-vba-to-operate-web-page", "title": "Using excel vba to operate web page", "body": "<p>I tried to operate certain website by using vba, but I really can't figure out why my code doesn't work, could someone help me to check my code please ..</p>\n\n<p>Web Page Source Code: </p>\n\n<pre><code>&lt;td class=\"grid-cell purchaseOrderPUGrid-col4 cur center  cell-update \" eno=\"edit\" _col=\"10\" field=\"selfVOService\"&gt;EUR 0.00&lt;/td&gt;\n&lt;input name=\"name1\" class=\"name2\" style=\"width: 156px;\" onpaste=\"return false\" oncontextmenu=\"return false\" type=\"text\"&gt;\n</code></pre>\n\n<p>My source code:</p>\n\n<pre><code>For Each oHTML_Element_2 In HTMLDoc.getElementsByTagName(\"input\")\n    If oHTML_Element_2.className = \"name2\" And oHTML_Element_2.Type = \"text\" Then\n        oHTML_Element_2.Click\n        oHTML_Element_2.txtamount.Value = \"123\"\n        oHTML_Element_2.txtamount.Text = \"123\"\n    End If\nNext\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1743, "user_id": 3629691, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RkvSZ.jpg?s=128&g=1", "display_name": "CodeJockey", "link": "https://stackoverflow.com/users/3629691/codejockey"}, "edited": false, "score": 0, "creation_date": 1485355129, "post_id": 41854123, "comment_id": 70892346, "body": "Stupid answer: the <code>With Selection.Format.Line</code> is breaking your code.  Looks like you are starting with &quot;Chart 19&quot;, selecting the legend and then selecting the first legend entry.  Make sure there is actually a legend entry and that the LegendEntries collection is 1 based (not 0)"}, {"owner": {"reputation": 873, "user_id": 5103224, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/d7d1ca72bbff93c0a014b5b770482a53?s=128&d=identicon&r=PG&f=1", "display_name": "Lowpar", "link": "https://stackoverflow.com/users/5103224/lowpar"}, "edited": false, "score": 0, "creation_date": 1485355174, "post_id": 41854123, "comment_id": 70892376, "body": "You can use With ActiveChart.Legend.LegendEntries(5).Format.Line, remove the selection. Select causes errors"}, {"owner": {"reputation": 3541, "user_id": 1616731, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/c9adb6c09548c81a8a9a46d7497081f6?s=128&d=identicon&r=PG&f=1", "display_name": "Tim Wilkinson", "link": "https://stackoverflow.com/users/1616731/tim-wilkinson"}, "edited": false, "score": 0, "creation_date": 1485355228, "post_id": 41854123, "comment_id": 70892421, "body": "Do you have at least 5 entries in the Legend?"}, {"owner": {"reputation": 1743, "user_id": 3629691, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RkvSZ.jpg?s=128&g=1", "display_name": "CodeJockey", "link": "https://stackoverflow.com/users/3629691/codejockey"}, "reply_to_user": {"reputation": 873, "user_id": 5103224, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/d7d1ca72bbff93c0a014b5b770482a53?s=128&d=identicon&r=PG&f=1", "display_name": "Lowpar", "link": "https://stackoverflow.com/users/5103224/lowpar"}, "edited": false, "score": 0, "creation_date": 1485355266, "post_id": 41854123, "comment_id": 70892446, "body": "@Lowpar Excellent Point.  For more on avoiding <code>.Select</code>: <a href=\"http://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba-macros?rq=1\" title=\"how to avoid using select in excel vba macros\">stackoverflow.com/questions/10714251/&hellip;</a>"}, {"owner": {"reputation": 143, "user_id": 7158160, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6b6cfc02deb3ef70841abf62ba076496?s=128&d=identicon&r=PG&f=1", "display_name": "Atlas", "link": "https://stackoverflow.com/users/7158160/atlas"}, "reply_to_user": {"reputation": 1743, "user_id": 3629691, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RkvSZ.jpg?s=128&g=1", "display_name": "CodeJockey", "link": "https://stackoverflow.com/users/3629691/codejockey"}, "edited": false, "score": 0, "creation_date": 1485355425, "post_id": 41854123, "comment_id": 70892555, "body": "@CodeJockey Sorry, I tried removing Select before posting the question, same story. I did <code>With ActiveChart.Legend.LegendEntries(1).Format.Line</code> and got the same error. Not only that, but to test where error cropped up, re-opened unedited copy of the workbook and pasted the code back into the module to force vba to perform the macro the same way I did it when recording and even then it broke."}], "answers": [{"tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": true, "score": 1, "last_activity_date": 1485355635, "creation_date": 1485355635, "answer_id": 41854491, "question_id": 41854123, "link": "https://stackoverflow.com/questions/41854123/recorded-macro-breaks-on-legend-formatting/41854491#41854491", "title": "Recorded macro breaks on Legend formatting", "body": "<p>The code below sets the <code>ChartObject</code> of \"Chart 19\" to a variable, and later just modify the needed parameters without needing to use <code>ActiveChart</code>, <code>Selection</code> and <code>Select</code>.</p>\n\n<pre><code>Option Explicit\n\nSub Total()\n\nDim ChtObj As ChartObject\n\nSet ChtObj = Worksheets(\"Sheet4\").ChartObjects(\"Chart 19\") '&lt;-- modify \"Sheet4\" to your sheet's name where you have your charts\n\nWith ChtObj\n    With .Chart.SeriesCollection(1).Format.Line\n        .Visible = msoTrue\n        .ForeColor.ObjectThemeColor = msoThemeColorText1\n        .Transparency = 0\n    End With\n\n    With .Chart.SeriesCollection(5).Format.Line\n        .Visible = msoTrue\n        .ForeColor.RGB = RGB(255, 255, 0)\n        .Transparency = 0\n    End With\n\n    With .Chart.SeriesCollection(6).Format.Line\n       .Visible = msoTrue\n        .ForeColor.RGB = RGB(0, 176, 80)\n        .Transparency = 0\n    End With            \nEnd With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 143, "user_id": 7158160, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6b6cfc02deb3ef70841abf62ba076496?s=128&d=identicon&r=PG&f=1", "display_name": "Atlas", "link": "https://stackoverflow.com/users/7158160/atlas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 222, "favorite_count": 0, "accepted_answer_id": 41854491, "answer_count": 1, "score": 1, "last_activity_date": 1485355938, "creation_date": 1485354582, "last_edit_date": 1531161705, "question_id": 41854123, "link": "https://stackoverflow.com/questions/41854123/recorded-macro-breaks-on-legend-formatting", "title": "Recorded macro breaks on Legend formatting", "body": "<pre><code>Sub Total()\nActiveChart.ClearToMatchStyle\nActiveChart.ChartStyle = 227\nActiveSheet.ChartObjects(\"Chart 19\").Activate\nActiveChart.Legend.Select\nActiveChart.Legend.LegendEntries(1).Select\nWith Selection.Format.Line\n    .Visible = msoTrue\n    .ForeColor.ObjectThemeColor = msoThemeColorText1\n    .ForeColor.TintAndShade = 0\n    .ForeColor.Brightness = 0\n    .Transparency = 0\nEnd With\nActiveChart.Legend.LegendEntries(5).Select\nWith Selection.Format.Line\n    .Visible = msoTrue\n    .ForeColor.RGB = RGB(255, 255, 0)\n    .Transparency = 0\nEnd With\nActiveChart.Legend.LegendEntries(6).Select\nWith Selection.Format.Line\n    .Visible = msoTrue\n    .ForeColor.RGB = RGB(0, 176, 80)\n    .Transparency = 0\nEnd With\nEnd Sub\n</code></pre>\n\n<p>I tried to recreate this macro multiple times to mould it to my need, so I ran it once to test it and it broke once it got to the <code>With Selection.Format.Line</code>, <a href=\"https://i.stack.imgur.com/X1vOT.png\" rel=\"nofollow noreferrer\">giving me this error</a>. Which part of the macro is causing this error?</p>\n\n<p>Edit: Shai Rado posted perfect fix <a href=\"https://stackoverflow.com/questions/41854123/recorded-macro-breaks-on-legend-formatting/41854491#41854491\">Recorded macro breaks on Legend formatting</a></p>\n"}, {"tags": ["vba", "excel", "excel-2013"], "comments": [{"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1485355120, "post_id": 41854036, "comment_id": 70892339, "body": "Can you write <code>Organizer.Activate</code>, before the code that fails?"}, {"owner": {"reputation": 44, "user_id": 7469388, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ff13e884261bada051c5aedba692034?s=128&d=identicon&r=PG&f=1", "display_name": "Pulsater", "link": "https://stackoverflow.com/users/7469388/pulsater"}, "reply_to_user": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1485380557, "post_id": 41854036, "comment_id": 70908095, "body": "Hello Vityata,         Organizer.Activate had no affect.  The error occurred again on the Organizer.Sheets(&quot;Partnumber_Vendor_Database&quot;).Select. I even removed the &quot;organizer.&quot; on Organizer.Sheets(&quot;Partnumber_Vendor_Database&quot;).Select.  Good thinking though! :)"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1485380767, "post_id": 41854036, "comment_id": 70908194, "body": "<code>Organizer.Worksheets(&quot;Partnumber_Vendor_Database&quot;).Select</code>?"}, {"owner": {"reputation": 44, "user_id": 7469388, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ff13e884261bada051c5aedba692034?s=128&d=identicon&r=PG&f=1", "display_name": "Pulsater", "link": "https://stackoverflow.com/users/7469388/pulsater"}, "reply_to_user": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1485539313, "post_id": 41854036, "comment_id": 70982345, "body": "Still not working. It is coming up with a automation error."}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1485541713, "post_id": 41854036, "comment_id": 70983621, "body": "Well. What you can actually do is to record a macro. Then select a few times the &quot;Partnumber_Vendor_Database&quot; sheet and check the code, that the macro recorder generates. Then put the code in your code. Check this as well - <a href=\"http://stackoverflow.com/questions/12270922/what-is-causing-automation-error-unspecified-error-on-worksheet-activate\" title=\"what is causing automation error unspecified error on worksheet activate\">stackoverflow.com/questions/12270922/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 44, "user_id": 7469388, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ff13e884261bada051c5aedba692034?s=128&d=identicon&r=PG&f=1", "display_name": "Pulsater", "link": "https://stackoverflow.com/users/7469388/pulsater"}, "edited": false, "score": 0, "creation_date": 1485381951, "post_id": 41854333, "comment_id": 70908793, "body": "Hello Rdnoberga,  What you said definitely makes sense.  Due to this fill being a template that multiple users will copy, rename, and save in different folders of there department I thought by setting this as a object  as the active workbook it would make the most sense.       I thought by putting in the &quot;Organizer.&quot; it would select the correct workbook.  If there is another way too get around this please let me know! :)    I changed the code from Organizer.Sheets(&quot;Partnumber_Vendor_Database&quot;).Select to Organizer.Sheets(2).Select. However this came up with a error stating &quot;Automation Error&quot;."}, {"owner": {"reputation": 391, "user_id": 1115743, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/700b27a0e37c8c135ef34daf357a495f?s=128&d=identicon&r=PG", "display_name": "rdnobrega", "link": "https://stackoverflow.com/users/1115743/rdnobrega"}, "reply_to_user": {"reputation": 44, "user_id": 7469388, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ff13e884261bada051c5aedba692034?s=128&d=identicon&r=PG&f=1", "display_name": "Pulsater", "link": "https://stackoverflow.com/users/7469388/pulsater"}, "edited": false, "score": 0, "creation_date": 1485433673, "post_id": 41854333, "comment_id": 70928424, "body": "Warren, try this: change the name of the sheet object entitled &quot;Partnumber_Vendor_Database&quot;. This can be changed in the property window in the VBA Editor. See here: <a href=\"http://imgur.com/a/MEskD\" rel=\"nofollow noreferrer\">link</a>. This way, you can change the name to Something like Vendor_DB and access it directly on your code. So, instead of using <code>Organizer.Sheets(&quot;Partnumber_Vendor_Database&quot;).Select</code> you can just type <code>Vendor_DB.Select</code>. Let me know if it worked out :)"}, {"owner": {"reputation": 44, "user_id": 7469388, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ff13e884261bada051c5aedba692034?s=128&d=identicon&r=PG&f=1", "display_name": "Pulsater", "link": "https://stackoverflow.com/users/7469388/pulsater"}, "edited": false, "score": 0, "creation_date": 1485539334, "post_id": 41854333, "comment_id": 70982355, "body": "Link is blocked at work. I will try to take a look tonight."}], "tags": [], "owner": {"reputation": 391, "user_id": 1115743, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/700b27a0e37c8c135ef34daf357a495f?s=128&d=identicon&r=PG", "display_name": "rdnobrega", "link": "https://stackoverflow.com/users/1115743/rdnobrega"}, "is_accepted": true, "score": 0, "last_activity_date": 1485355174, "creation_date": 1485355174, "answer_id": 41854333, "question_id": 41854036, "link": "https://stackoverflow.com/questions/41854036/copy-from-a-workbook-to-another-workbook/41854333#41854333", "title": "Copy from a workbook to another workbook", "body": "<p>Althoug it is easy to use, avoid <code>ActiveWorkbook</code>, <code>ActiveSheet</code> and <code>Sheets(&lt;Title of the Sheet.)</code>.</p>\n\n<p>The problem with the first two is that is hard to tell if the activeworkbook is actually the workbook you are looking for, specially when there are more than 1 workbook open. To workaround this, one solution is the use the <code>Workbooks</code> object to select the correct work book by its NAME (property <code>CodeName</code>). The Same for the Sheets, change the REAL NAMES of the Sheets so you can properlly call them.</p>\n\n<p>The third is basically the same principle. In general, do not use titles of Sheets as references, use the REAL NAME of the object. Use the Property window in the VBA code to change that.</p>\n\n<p>The error may come from 2 situations:</p>\n\n<p>1 - Your selected workbook is not the actual workbook you want to work on.</p>\n\n<p>2 - The Sheet \"Partnumber_Vendor_Database\" had its title changed or miswritten.</p>\n\n<p>Hope it helps.</p>\n"}], "owner": {"reputation": 44, "user_id": 7469388, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ff13e884261bada051c5aedba692034?s=128&d=identicon&r=PG&f=1", "display_name": "Pulsater", "link": "https://stackoverflow.com/users/7469388/pulsater"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 74, "favorite_count": 0, "accepted_answer_id": 41854333, "answer_count": 1, "score": 0, "last_activity_date": 1485355174, "creation_date": 1485354280, "last_edit_date": 1485354363, "question_id": 41854036, "link": "https://stackoverflow.com/questions/41854036/copy-from-a-workbook-to-another-workbook", "title": "Copy from a workbook to another workbook", "body": "<p>I am having issues developing this code. I was able to develop the code to copy new data from my workbook to an existing path but am running into issues when trying to retrieve data from the existing path work book. </p>\n\n<p>The concept is that there is a workbook in my system that will be collecting data. The data comes from different users that are working on project information. Once they have completed the project this new information along with existing information gets uploaded back to the workbook collecting that data. The work book collecting the data will always have a defined path. The workbooks that users are working off of will be in multiple places across the system. </p>\n\n<p>The below macro keeps failing on the \"Organizer.Sheets(\"Partnumber_Vendor_Database\").Select\". I am unsure why. </p>\n\n<p>\"Organizer\" is the local database the user will use.\n\"Partnumber_Vendor_File\" is the local database the information is stored.</p>\n\n<p>If you can see that this code could be developed better please let me know! :)</p>\n\n<pre><code>Sub Find_Partnumber_Vendor_File()\n\n'   This sub is to open the partnumber_Vendor file to update the local database.\n\n    On Error Resume Next\n\n    Dim Organizer As Workbook\n    Set Organizer = Application.ActiveWorkbook\n\n\n    Dim Partnumber_Vendor_File As Workbook\n    Set Partnumber_Vendor_File = Workbooks.Open(\"S:\\Supply Chain\\PURCHASING\\Forms and Templates\\BOM Organizer\\Partnumber_Vendor_File.xlsx\")\n\n    If Err.Number = 1004 Then\n    MsgBox \"Could not open. Check path in VBA\"\n    Exit Sub\n    End If\n\n    If Partnumber_Vendor_File.ReadOnly Then\n        MsgBox \"Sorry, partnumber to vendor database was already in use, try later\"\n        Exit Sub\n    End If\n\n    On Error GoTo 0\n\n    Dim Data As Long\n    Data = ActiveSheet.Cells(Rows.count, 1).End(xlUp).Row\n    Range(\"A1:\" &amp; \"D\" &amp; Data).Copy\n\n\n    Organizer.Sheets(\"Partnumber_Vendor_Database\").Select\n    Range(\"A1:D1\").Select\n    Selection.Insert Shift:=xlDown\n\n    Partnumber_Vendor_File.Close\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "optimization"], "comments": [{"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 1, "creation_date": 1485352743, "post_id": 41853401, "comment_id": 70890614, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/41824236/excel-if-statement-shorten-down\">Excel if statement shorten down?</a>"}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 0, "creation_date": 1485352804, "post_id": 41853401, "comment_id": 70890675, "body": "Almost, the same question, you stop answering there and didn&#39;t accept the answer... And you don&#39;t seem to have look for any info on <code>Select Case</code> that was suggested there... Just saying..."}, {"owner": {"reputation": 47, "user_id": 7446845, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5ce8a4ddb898389e59c53a329d38c630?s=128&d=identicon&r=PG&f=1", "display_name": "Hosey93", "link": "https://stackoverflow.com/users/7446845/hosey93"}, "reply_to_user": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 0, "creation_date": 1485352932, "post_id": 41853401, "comment_id": 70890771, "body": "Apologies, I thought that the <code>Select Case</code> command only worked if it was looking at another column too. My bad. Thanks for the tip though I really appreciate it. Just trying to learn."}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 2, "creation_date": 1485353162, "post_id": 41853401, "comment_id": 70890919, "body": "No worries, it&#39;s just annoying to see people <b>asking a lot of questions and not accepting answers...</b> (so you might want to <i>accept the useful ones from your profile</i> ;) ) The learning part is normal, but you&#39;d probably be better with a bit of googling <code>VBA your issue&#47;method&#47;...</code> ;) Good luck"}, {"owner": {"reputation": 47, "user_id": 7446845, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5ce8a4ddb898389e59c53a329d38c630?s=128&d=identicon&r=PG&f=1", "display_name": "Hosey93", "link": "https://stackoverflow.com/users/7446845/hosey93"}, "reply_to_user": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 0, "creation_date": 1485353460, "post_id": 41853401, "comment_id": 70891136, "body": "Yeah for a while there i couldn&#39;t accept answers because my rep was so low however I can accept now. Thanks for your help I greatly appreciate it."}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 2, "creation_date": 1485353556, "post_id": 41853401, "comment_id": 70891218, "body": "Ok, so you are confused between accepting and upvoting, see <a href=\"http://stackoverflow.com/tour\">stackoverflow.com/tour</a>"}, {"owner": {"reputation": 4621, "user_id": 4709298, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/fe41ea7cc395df33b3ad744599248d80?s=128&d=identicon&r=PG&f=1", "display_name": "Preston", "link": "https://stackoverflow.com/users/4709298/preston"}, "edited": false, "score": 0, "creation_date": 1485354033, "post_id": 41853401, "comment_id": 70891555, "body": "@Hosey93 if you think of another question with &quot;is there a way to optimize...&quot;, &quot;Can anyone shorten...&quot;, &quot;Excel if statemeent shorten down&quot; please put it on code review: it does not belong here.  <a href=\"http://codereview.stackexchange.com/\">codereview.stackexchange.com</a>"}, {"owner": {"reputation": 47, "user_id": 7446845, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5ce8a4ddb898389e59c53a329d38c630?s=128&d=identicon&r=PG&f=1", "display_name": "Hosey93", "link": "https://stackoverflow.com/users/7446845/hosey93"}, "reply_to_user": {"reputation": 4621, "user_id": 4709298, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/fe41ea7cc395df33b3ad744599248d80?s=128&d=identicon&r=PG&f=1", "display_name": "Preston", "link": "https://stackoverflow.com/users/4709298/preston"}, "edited": false, "score": 1, "creation_date": 1485354255, "post_id": 41853401, "comment_id": 70891713, "body": "@tompreston Hi. Yes, ok sorry Tom, just getting to grips with the community and how this all works. Will do in future. Thanks for the feedback."}, {"owner": {"reputation": 4621, "user_id": 4709298, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/fe41ea7cc395df33b3ad744599248d80?s=128&d=identicon&r=PG&f=1", "display_name": "Preston", "link": "https://stackoverflow.com/users/4709298/preston"}, "edited": false, "score": 0, "creation_date": 1485354399, "post_id": 41853401, "comment_id": 70891809, "body": "@Hosey93 Top guy :)"}], "answers": [{"comments": [{"owner": {"reputation": 47, "user_id": 7446845, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5ce8a4ddb898389e59c53a329d38c630?s=128&d=identicon&r=PG&f=1", "display_name": "Hosey93", "link": "https://stackoverflow.com/users/7446845/hosey93"}, "edited": false, "score": 0, "creation_date": 1485352833, "post_id": 41853481, "comment_id": 70890699, "body": "Awesome, works great. I tried using the <code>select case</code> command but I must have been doing it wrong as it works now."}], "tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": true, "score": 1, "last_activity_date": 1485352624, "creation_date": 1485352624, "answer_id": 41853481, "question_id": 41853401, "link": "https://stackoverflow.com/questions/41853401/vba-is-there-anyway-to-optimize-this-code/41853481#41853481", "title": "VBA is there anyway to optimize this code?", "body": "<p>Exactly what <code>Select Case</code> is all about, try the code below :</p>\n\n<pre><code>Sub RoutingCheck()\n\nDim i As Long, c1 As Range, c2 As Range, c3 As Range, c4 As Range\n\nFor i = 2 To 456\n    Set c3 = Range(\"C\" &amp; i)\n    Set c4 = Range(\"D\" &amp; i)\n\n    Select Case c3.Value\n        Case 1 To 6\n            c3.Interior.Color = vbGreen\n        Case Else\n            c3.Interior.Color = vbRed\n    End Select\n\nNext i\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 47, "user_id": 7446845, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5ce8a4ddb898389e59c53a329d38c630?s=128&d=identicon&r=PG&f=1", "display_name": "Hosey93", "link": "https://stackoverflow.com/users/7446845/hosey93"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 26, "favorite_count": 0, "accepted_answer_id": 41853481, "answer_count": 1, "score": -1, "last_activity_date": 1485352624, "creation_date": 1485352379, "question_id": 41853401, "link": "https://stackoverflow.com/questions/41853401/vba-is-there-anyway-to-optimize-this-code", "title": "VBA is there anyway to optimize this code?", "body": "<p>Currently working on something that requires me to use the following code. Just wondering if there is anyway to shorten it down or combine it as such. Any help would be great. And apologies for posting so many questions over the previous few days.</p>\n\n<pre><code>Sub RoutingCheck()\n\n\n   Dim i As Long, c1 As Range, c2 As Range, c3 As Range, c4 As Range\n\n   For i = 2 To 456\n      Set c3 = Range(\"C\" &amp; i)\n      Set c4 = Range(\"D\" &amp; i)\n\nIf c3.Value &lt;&gt; 1 Or c3.Value &lt;&gt; 2 Or c3.Value &lt;&gt; 3 Or c3.Value &lt;&gt; 4 Or c3.Value &lt;&gt; 5 Or c3.Value &lt;&gt; 6 Or c3.Value &lt;&gt; 98 Then c3.Interior.color = vbRed\nIf c3.Value = 1 Or c3.Value = 2 Or c3.Value = 3 Or c3.Value = 4 Or c3.Value = 5 Or c3.Value = 6 Or c3.Value = 98 Then c3.Interior.color = vbGreen\n\n\nEnd If\nNext i\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["arrays", "vba", "excel", "msgbox"], "comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1485352272, "post_id": 41852985, "comment_id": 70890259, "body": "I think it&#39;s because you are limited by the length of the <code>msg</code> (so it&#39;s skipping or something) . You could try to save each row in a String, so you&#39;ll have an array of <code>String</code>s , and then loop and show them in a <code>MsgBox</code>"}, {"owner": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "edited": false, "score": 0, "creation_date": 1485352410, "post_id": 41852985, "comment_id": 70890358, "body": "For what its worth i really like the idea of trying to see the output of an array visually."}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "reply_to_user": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "edited": false, "score": 0, "creation_date": 1485352477, "post_id": 41852985, "comment_id": 70890404, "body": "@DougCoats only if you promise to +1 :)"}, {"owner": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "reply_to_user": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1485352507, "post_id": 41852985, "comment_id": 70890434, "body": "@ShaiRado I did tho &lt;3"}], "answers": [{"comments": [{"owner": {"reputation": 1115, "user_id": 2450597, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/5a0db5f577b75e0cdc9532ee1cba8fa2?s=128&d=identicon&r=PG&f=1", "display_name": "Trenera", "link": "https://stackoverflow.com/users/2450597/trenera"}, "edited": false, "score": 0, "creation_date": 1485352030, "post_id": 41853229, "comment_id": 70890064, "body": "Hi CMArg, I believe they are correct in my code, as otherwise I get &quot;Subscript out of range&quot; Error"}, {"owner": {"reputation": 1472, "user_id": 1726522, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/0DUTN.gif?s=128&g=1", "display_name": "CMArg", "link": "https://stackoverflow.com/users/1726522/cmarg"}, "reply_to_user": {"reputation": 1115, "user_id": 2450597, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/5a0db5f577b75e0cdc9532ee1cba8fa2?s=128&d=identicon&r=PG&f=1", "display_name": "Trenera", "link": "https://stackoverflow.com/users/2450597/trenera"}, "edited": false, "score": 1, "creation_date": 1485352229, "post_id": 41853229, "comment_id": 70890221, "body": "you&#39;re scanning the array properly, but the first line of the messagebox is showing the 8 first elements of your first dimension (that has 23 elements), the second row another 8 and so. And I think thats not what you want.."}, {"owner": {"reputation": 1472, "user_id": 1726522, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/0DUTN.gif?s=128&g=1", "display_name": "CMArg", "link": "https://stackoverflow.com/users/1726522/cmarg"}, "reply_to_user": {"reputation": 1115, "user_id": 2450597, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/5a0db5f577b75e0cdc9532ee1cba8fa2?s=128&d=identicon&r=PG&f=1", "display_name": "Trenera", "link": "https://stackoverflow.com/users/2450597/trenera"}, "edited": false, "score": 1, "creation_date": 1485352314, "post_id": 41853229, "comment_id": 70890289, "body": "See Doug answer: you have <code>ii</code> and <code>i</code> interchanged (in <code>arr(ii, i)</code>)..."}, {"owner": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "edited": false, "score": 0, "creation_date": 1485352377, "post_id": 41853229, "comment_id": 70890329, "body": "Thats def the issue"}, {"owner": {"reputation": 1115, "user_id": 2450597, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/5a0db5f577b75e0cdc9532ee1cba8fa2?s=128&d=identicon&r=PG&f=1", "display_name": "Trenera", "link": "https://stackoverflow.com/users/2450597/trenera"}, "edited": false, "score": 0, "creation_date": 1485352523, "post_id": 41853229, "comment_id": 70890443, "body": "CMArg, you were right. I changed the code so: first loop is for h and the for w. I didn&#39;t paid attentined to that in the begginning, as I just saw i and ii interchanged in your answer. Thanks!"}, {"owner": {"reputation": 1472, "user_id": 1726522, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/0DUTN.gif?s=128&g=1", "display_name": "CMArg", "link": "https://stackoverflow.com/users/1726522/cmarg"}, "edited": false, "score": 0, "creation_date": 1485352799, "post_id": 41853229, "comment_id": 70890669, "body": "Good. And I will keep you code for examine arrays. They use to be a headache to me..."}], "tags": [], "owner": {"reputation": 1472, "user_id": 1726522, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/0DUTN.gif?s=128&g=1", "display_name": "CMArg", "link": "https://stackoverflow.com/users/1726522/cmarg"}, "is_accepted": true, "score": 3, "last_activity_date": 1485353678, "last_edit_date": 1485353678, "creation_date": 1485351923, "answer_id": 41853229, "question_id": 41852985, "link": "https://stackoverflow.com/questions/41852985/vba-msgbox-a-2d-array-matrix/41853229#41853229", "title": "VBA - MsgBox a 2D Array (Matrix)", "body": "<p>You have <code>w</code> and <code>h</code> interchanged.</p>\n\n<pre><code>Dim msg As String\n\nFor i = 0 To h\n    For ii = 0 To w\n        msg = msg &amp; arr(i, ii) &amp; vbTab\n    Next ii\n    msg = msg &amp; vbCrLf\nNext i\n\nMsgBox msg\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "is_accepted": false, "score": 3, "last_activity_date": 1485352209, "creation_date": 1485352209, "answer_id": 41853330, "question_id": 41852985, "link": "https://stackoverflow.com/questions/41852985/vba-msgbox-a-2d-array-matrix/41853330#41853330", "title": "VBA - MsgBox a 2D Array (Matrix)", "body": "<p>this works perfectly for me</p>\n\n<pre><code>Private Sub this()\n    Dim this(22, 7) As Integer\n    Dim msg$\n    For i = LBound(this, 1) To UBound(this, 1)\n        For j = LBound(this, 2) To UBound(this, 2)\n            msg = msg &amp; this(i, j) &amp; vbTab\n        Next j\n    Next i\n    MsgBox msg\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/0EdpG.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/0EdpG.jpg\" alt=\"enter image description here\"></a></p>\n"}, {"tags": [], "owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "is_accepted": false, "score": 0, "last_activity_date": 1485354369, "creation_date": 1485354369, "answer_id": 41854069, "question_id": 41852985, "link": "https://stackoverflow.com/questions/41852985/vba-msgbox-a-2d-array-matrix/41854069#41854069", "title": "VBA - MsgBox a 2D Array (Matrix)", "body": "<p>It might be more flexible to write a function which returns a string, a sort of 2-dimensional join, which allows you to choose both the item delimiter (defaulting to <code>vbTab</code>) and the row delimiter (defaulting to <code>vbCrLf</code>).</p>\n\n<p>You can <code>MsgBox</code> this string -- or write it to the immediate window -- or (with a comma chosen as one of the delimiters) -- write it to a CSV file, etc.:</p>\n\n<pre><code>Function MatrixJoin(M As Variant, Optional delim1 As String = vbTab, Optional delim2 As String = vbCrLf) As String\n    Dim i As Long, j As Long\n    Dim row As Variant, rows As Variant\n\n    ReDim rows(LBound(M, 1) To UBound(M, 1))\n    ReDim row(LBound(M, 2) To UBound(M, 2))\n\n    For i = LBound(M, 1) To UBound(M, 1)\n        For j = LBound(M, 2) To UBound(M, 2)\n            row(j) = M(i, j)\n        Next j\n        rows(i) = Join(row, delim1)\n    Next i\n    MatrixJoin = Join(rows, delim2)\nEnd Function\n</code></pre>\n\n<p>Tested by:</p>\n\n<pre><code>Sub test()\n    Dim A As Variant\n    A = Range(\"A1:B3\").Value\n    MsgBox MatrixJoin(A)\n    Debug.Print MatrixJoin(A, \",\", \";\")\nEnd Sub\n</code></pre>\n\n<p>Screenshots of output:</p>\n\n<p><a href=\"https://i.stack.imgur.com/B0W2e.gif\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/B0W2e.gif\" alt=\"enter image description here\"></a></p>\n\n<hr>\n\n<p><a href=\"https://i.stack.imgur.com/6EMNJ.gif\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/6EMNJ.gif\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 1115, "user_id": 2450597, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/5a0db5f577b75e0cdc9532ee1cba8fa2?s=128&d=identicon&r=PG&f=1", "display_name": "Trenera", "link": "https://stackoverflow.com/users/2450597/trenera"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6322, "favorite_count": 0, "accepted_answer_id": 41853229, "answer_count": 3, "score": 2, "last_activity_date": 1485354369, "creation_date": 1485351242, "last_edit_date": 1531164843, "question_id": 41852985, "link": "https://stackoverflow.com/questions/41852985/vba-msgbox-a-2d-array-matrix", "title": "VBA - MsgBox a 2D Array (Matrix)", "body": "<p>I am trying to visualize a 2D Matrix (Array) using a MsgBox, but the code I have doesn't give me the correct representation.</p>\n\n<pre><code>Sub test()\n\nDim M(22, 7) As Double\nTwoD_Array_Matrix_In_MSGBOX (M)\n\nEnd Sub\n'_________________________________________________________________________\n\nPublic Function TwoD_Array_Matrix_In_MSGBOX(arr As Variant)\n\nh = UBound(arr, 1)\nw = UBound(arr, 2)\n'MsgBox (\"h = \" &amp; CStr(h + 1) &amp; vbCrLf &amp; \"w = \" &amp; CStr(w + 1)) ' to check if the width and hight of the Matrix are correct\nDim msg As String\n\nFor i = 0 To w\n    For ii = 0 To h\n        msg = msg &amp; arr(ii, i) &amp; vbTab\n    Next ii\n    msg = msg &amp; vbCrLf\nNext i\n\nMsgBox msg\n\nEnd Function\n</code></pre>\n\n<p>This is the result I get:</p>\n\n<p><a href=\"https://i.stack.imgur.com/FPiSV.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/FPiSV.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 533, "user_id": 7315468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f038bb9934e81791e469421adef9d645?s=128&d=identicon&r=PG&f=1", "display_name": "Vinnie", "link": "https://stackoverflow.com/users/7315468/vinnie"}, "edited": false, "score": 1, "creation_date": 1485351523, "post_id": 41852897, "comment_id": 70889722, "body": "What error do you get?"}, {"owner": {"reputation": 239, "user_id": 7424955, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/a3a1a84a7bf05408c05b081da20fa17a?s=128&d=identicon&r=PG&f=1", "display_name": "tombata", "link": "https://stackoverflow.com/users/7424955/tombata"}, "reply_to_user": {"reputation": 533, "user_id": 7315468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f038bb9934e81791e469421adef9d645?s=128&d=identicon&r=PG&f=1", "display_name": "Vinnie", "link": "https://stackoverflow.com/users/7315468/vinnie"}, "edited": false, "score": 0, "creation_date": 1485352185, "post_id": 41852897, "comment_id": 70890185, "body": "I updated my question"}, {"owner": {"reputation": 1548, "user_id": 6466694, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/828581c05a0412f2360afd492a5a37af?s=128&d=identicon&r=PG&f=1", "display_name": "Darrell H", "link": "https://stackoverflow.com/users/6466694/darrell-h"}, "edited": false, "score": 0, "creation_date": 1485352539, "post_id": 41852897, "comment_id": 70890465, "body": "So, you identify the column with &quot;Exchange&quot; and then you step the variable IntCounter by 1 before exiting the loop and proceeding to the Autofilter.  Are you sure you are filtering the right column?"}, {"owner": {"reputation": 239, "user_id": 7424955, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/a3a1a84a7bf05408c05b081da20fa17a?s=128&d=identicon&r=PG&f=1", "display_name": "tombata", "link": "https://stackoverflow.com/users/7424955/tombata"}, "edited": false, "score": 0, "creation_date": 1485354373, "post_id": 41852897, "comment_id": 70891789, "body": "When the code exits the if, intCounter has a value of 43 and that seems to be the problem, but I cant fix it"}, {"owner": {"reputation": 1548, "user_id": 6466694, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/828581c05a0412f2360afd492a5a37af?s=128&d=identicon&r=PG&f=1", "display_name": "Darrell H", "link": "https://stackoverflow.com/users/6466694/darrell-h"}, "edited": false, "score": 1, "creation_date": 1485354759, "post_id": 41852897, "comment_id": 70892064, "body": "A quick workaround is to set the Field in your Autofilter to <code>RngExchange.Column</code>.  That will be the original column you searched for in your loop, prior to adding 1 to the counter."}], "answers": [{"comments": [{"owner": {"reputation": 239, "user_id": 7424955, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/a3a1a84a7bf05408c05b081da20fa17a?s=128&d=identicon&r=PG&f=1", "display_name": "tombata", "link": "https://stackoverflow.com/users/7424955/tombata"}, "edited": false, "score": 0, "creation_date": 1485354642, "post_id": 41853443, "comment_id": 70891994, "body": "When the code exits the if, intCounter has a value of 43 and that seems to be the problem, but I cant fix it"}], "tags": [], "owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "is_accepted": true, "score": 1, "last_activity_date": 1485354903, "last_edit_date": 1485354903, "creation_date": 1485352542, "answer_id": 41853443, "question_id": 41852897, "link": "https://stackoverflow.com/questions/41852897/vba-code-to-search-a-column-and-sort-it/41853443#41853443", "title": "VBA code to search a column and sort it", "body": "<p>You have to check and set the <code>AutoFilterMode</code> before using <code>AutoFilter</code></p>\n\n<pre><code>Sub SortExchangesEurope()\n    Dim wS As Worksheet\n    Dim intCounter As Integer\n    Dim rngExchange As Range\n\n    Set wS = Sheets(\"Sheet1\")\n    intCounter = 1\n\n    With wS\n        Do While .Cells(2, intCounter).Value &lt;&gt; \"Exchange\" Then\n           intCounter = intCounter + 1\n        Loop\n        Set rngExchange = .Range(.Cells(2, intCounter), .Cells(2, intCounter))\n\n        '.Activate\n        '.Range(\"B2\").Activate\n        If Not .AutoFilterMode Then .AutoFilterMode = True\n\n        .Range(\"$A$2:$AP$778\").AutoFilter Field:=intCounter, Criteria1:=Array( _\n            \"XBEL\", \"XBUD\", \"XBSE\", \"XQMH\", \"XWAR\", _\n            \"BMEX\", \"XLIS\", \"XLIT\", \"XBUL\", \"ASEX\", _\n            \"XDUB\", \"XBRU\", \"XLUX\", \"XSTO\", \"XSWX\", _\n            \"XHEL\", \"XMOS\", \"MISX\", \"XCSE\", \"XVTX\", _\n            \"IEPA\", \"XMIL\", \"XLIS\", \"BMEX\", _\n            \"XLJU\", \"ASEX\", \"XRIS\", \"XBRA\", \"xlOn\", _\n            \"XOSL\", \"XPAR\", \"XPRA\", \"XICE\", \"XIST\", _\n            \"XTAL\", \"XMIL\", \"XTRN\", \"XBRU\", \"XLDN\", _\n            \"XAMS\", \"XZAG\", \"XSWX\", \"XATH\", \"XMAD\", \"XOME\", _\n            \"XMRV\", \"XADE\", \"XVTX\", \"XTAH\", \"RTSX\", \"XLTO\", _\n            \"XDMI\", \"MFOX\", \"XMAD\", \"XMAT\", \"XTLX\", \"ICEU\", _\n            \"XMON\", \"XTUR\", \"XBRD\", \"XEDX\", \"XOME\", \"XLIF\"), Operator:=xlFilterValues\n\n    End With 'wS\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 239, "user_id": 7424955, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/a3a1a84a7bf05408c05b081da20fa17a?s=128&d=identicon&r=PG&f=1", "display_name": "tombata", "link": "https://stackoverflow.com/users/7424955/tombata"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 145, "favorite_count": 0, "accepted_answer_id": 41853443, "answer_count": 1, "score": 0, "last_activity_date": 1485354903, "creation_date": 1485351010, "last_edit_date": 1485352170, "question_id": 41852897, "link": "https://stackoverflow.com/questions/41852897/vba-code-to-search-a-column-and-sort-it", "title": "VBA code to search a column and sort it", "body": "<p>I am writing a VBA code that has to find a specific column on sheet and sort it on specific citeria. This is my code</p>\n\n<pre><code>Sub SortExchangesEurope()\n\n    Dim intCounter As Integer\n    Dim rngExchange As Range\n    intCounter = 1\n\n    Do While Worksheets(\"Sheet1\").Cells(2, intCounter) &lt;&gt; \"\"\n        If Worksheets(\"Sheet1\").Cells(2, intCounter).Value = \"Exchange\" Then\n            With Worksheets(\"Sheet1\")\n                Set rngExchange = .Range(.Cells(2, intCounter), .Cells(2, intCounter))\n               MsgBox intCounter\n             End With\n        End If\n\n        intCounter = intCounter + 1\n    Loop\n\n    Worksheets(\"Sheet1\").Range(\"$A$2:$AP$778\").AutoFilter Field:=intCounter, Criteria1:=Array( _\n        \"XBEL\", \"XBUD\", \"XBSE\", \"XQMH\", \"XWAR\", _\n        \"BMEX\", \"XLIS\", \"XLIT\", \"XBUL\", \"ASEX\", _\n        \"XDUB\", \"XBRU\", \"XLUX\", \"XSTO\", \"XSWX\", _\n        \"XHEL\", \"XMOS\", \"MISX\", \"XCSE\", \"XVTX\", _\n        \"IEPA\", \"XMIL\", \"XLIS\", \"BMEX\", _\n        \"XLJU\", \"ASEX\", \"XRIS\", \"XBRA\", \"xlOn\", _\n        \"XOSL\", \"XPAR\", \"XPRA\", \"XICE\", \"XIST\", _\n        \"XTAL\", \"XMIL\", \"XTRN\", \"XBRU\", \"XLDN\", _\n        \"XAMS\", \"XZAG\", \"XSWX\", \"XATH\", \"XMAD\", \"XOME\", _\n        \"XMRV\", \"XADE\", \"XVTX\", \"XTAH\", \"RTSX\", \"XLTO\", _\n        \"XDMI\", \"MFOX\", \"XMAD\", \"XMAT\", \"XTLX\", \"ICEU\", _\n        \"XMON\", \"XTUR\", \"XBRD\", \"XEDX\", \"XOME\", \"XLIF\"), Operator:=xlFilterValues\n\nEnd Sub\n</code></pre>\n\n<p>The first part looks for the column that the name is in and the second part must sort only the field with the given codes in them. Both parts work fine separately,but they do not work together.</p>\n\n<p>autofilter of range class failed  - I receive this error</p>\n"}, {"tags": ["vba", "web-scraping"], "comments": [{"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 0, "creation_date": 1485351593, "post_id": 41852648, "comment_id": 70889765, "body": "Hi mate, I see that you have already quite a few questions with answers and yet none were accepted, (not upvoted either, but you couldn&#39;t). Please accept the answers that helped you fixed your problems."}], "answers": [{"comments": [{"owner": {"reputation": 207, "user_id": 7180194, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/tnExZ.jpg?s=128&g=1", "display_name": "MITHU", "link": "https://stackoverflow.com/users/7180194/mithu"}, "edited": false, "score": 0, "creation_date": 1485357701, "post_id": 41853086, "comment_id": 70894151, "body": "You are the gem of a guy. It works as i expected it to. Thanks a trillion."}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "reply_to_user": {"reputation": 207, "user_id": 7180194, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/tnExZ.jpg?s=128&g=1", "display_name": "MITHU", "link": "https://stackoverflow.com/users/7180194/mithu"}, "edited": false, "score": 0, "creation_date": 1485357790, "post_id": 41853086, "comment_id": 70894219, "body": "@ShahinIqbal : Did you see my comment on your question? Go to your profile and accept answers that helped you! ;)"}, {"owner": {"reputation": 207, "user_id": 7180194, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/tnExZ.jpg?s=128&g=1", "display_name": "MITHU", "link": "https://stackoverflow.com/users/7180194/mithu"}, "edited": false, "score": 0, "creation_date": 1485359925, "post_id": 41853086, "comment_id": 70895829, "body": "I studied your rewritten portion and found an idea that is if in my mistaken portion of code i use &quot;or&quot; in place of &quot;and&quot; and place &quot;on error resume next&quot; before the last argument then it also work as i wanted. By the way, how to accept your answer as i don&#39;t know the process yet."}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "reply_to_user": {"reputation": 207, "user_id": 7180194, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/tnExZ.jpg?s=128&g=1", "display_name": "MITHU", "link": "https://stackoverflow.com/users/7180194/mithu"}, "edited": false, "score": 0, "creation_date": 1485359976, "post_id": 41853086, "comment_id": 70895862, "body": "@ShahinIqbal : <a href=\"http://stackoverflow.com/tour\">stackoverflow.com/tour</a> and go to your profile to see your old questions"}], "tags": [], "owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "is_accepted": true, "score": 1, "last_activity_date": 1485351485, "creation_date": 1485351485, "answer_id": 41853086, "question_id": 41852648, "link": "https://stackoverflow.com/questions/41852648/scraper-omitting-a-whole-lead-if-a-single-item-is-missing-out-of-four/41853086#41853086", "title": "Scraper omitting a whole lead if a single item is missing out of four", "body": "<p>Just change</p>\n\n<pre><code>If parse.Length &gt; 0 And sas.Length &gt; 0 And qas.Length &gt; 0 And jas.Length &gt; 0 Then\n    For i = 0 To parse.Length - 1\n    Cells(x, 1) = parse(i).innerText\n    Cells(x, 2) = sas(i).innerText\n    Cells(x, 3) = qas(i).innerText\n    Cells(x, 4) = jas(i).getAttribute(\"href\")\n\n    x = x + 1\n    Next i\nEnd If\n</code></pre>\n\n<p>To</p>\n\n<pre><code>If Parse.Length &gt; 0 Then\n    For i = 0 To Parse.Length - 1\n        Cells(i + 1, 1) = Parse(i).innerText\n    Next i\nEnd If\nIf sas.Length &gt; 0 Then\n    For i = 0 To sas.Length - 1\n        Cells(i + 1, 2) = sas(i).innerText\n    Next i\nEnd If\nIf qas.Length &gt; 0 Then\n    For i = 0 To qas.Length - 1\n        Cells(i + 1, 3) = qas(i).innerText\n    Next i\nEnd If\nIf jas.Length &gt; 0 Then\n    For i = 0 To jas.Length - 1\n        Cells(i + 1, 4) = jas(i).getAttribute(\"href\")\n    Next i\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 207, "user_id": 7180194, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/tnExZ.jpg?s=128&g=1", "display_name": "MITHU", "link": "https://stackoverflow.com/users/7180194/mithu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 40, "favorite_count": 0, "accepted_answer_id": 41853086, "answer_count": 1, "score": 0, "last_activity_date": 1485351485, "creation_date": 1485350289, "last_edit_date": 1485351087, "question_id": 41852648, "link": "https://stackoverflow.com/questions/41852648/scraper-omitting-a-whole-lead-if-a-single-item-is-missing-out-of-four", "title": "Scraper omitting a whole lead if a single item is missing out of four", "body": "<p>I made a scraper which is running fine but while pulling info from\na certain lead if it sees any item missing out of four then it skips\nthat lead and go on to the next lead. </p>\n\n<p>the process so that it will pull the rest info irrespective\nof one or two items are missing</p>\n\n<pre><code>Option Explicit\nConst url As String = \"http://www.yellowpages.com\"\nConst pageurl As String = \"http://www.yellowpages.com/search?search_terms=Coffee%20Shops&amp;geo_location_terms=AZ&amp;page=\"\nSub yptest()\nDim http As New MSXML2.XMLHTTP60, html As New HTMLDocument, hmm As New HTMLDocument\nDim topics As Object, topic As Object, posts As Object, post As Object, lng As Object, mng As Object, nng As Object\nDim parse As Object, par As Object, pas As Object, pae As Object, sas As Object, jas As Object\nDim x As Long, zz As String, ss As String, y As Long, qas As Object, i As Long, t As Long\n\nx = 2\n\nfor t = 1 to 10\n\nhttp.Open \"GET\", pageurl &amp; t, False\nhttp.send\nhtml.body.innerHTML = http.responseText\n\nSet topics = html.getElementsByClassName(\"info\")\n\nFor y = 0 To topics.Length - 1\nSet posts = topics(y).getElementsByTagName(\"a\")(0)\nzz = posts.getAttribute(\"href\")\nss = url &amp; Mid(zz, InStr(zz, \":\") + 1)\n\n    http.Open \"GET\", ss, False\n    http.send\n    hmm.body.innerHTML = http.responseText\n\nSet parse = hmm.getElementsByClassName(\"sales-info\")\nSet sas = hmm.getElementsByClassName(\"address\")\nSet qas = hmm.getElementsByClassName(\"phone\")\nSet jas = hmm.getElementsByClassName(\"email-business\")\n\n    If parse.Length &gt; 0 And sas.Length &gt; 0 And qas.Length &gt; 0 And jas.Length &gt; 0 Then\n        For i = 0 To parse.Length - 1\n        Cells(x, 1) = parse(i).innerText\n        Cells(x, 2) = sas(i).innerText\n        Cells(x, 3) = qas(i).innerText\n        Cells(x, 4) = jas(i).getAttribute(\"href\")\n\n        x = x + 1\n        Next i\n    End If\nNext y\nnext t\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "sorting", "methods"], "comments": [{"owner": {"reputation": 4621, "user_id": 4709298, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/fe41ea7cc395df33b3ad744599248d80?s=128&d=identicon&r=PG&f=1", "display_name": "Preston", "link": "https://stackoverflow.com/users/4709298/preston"}, "edited": false, "score": 0, "creation_date": 1485350526, "post_id": 41852640, "comment_id": 70889023, "body": "This might be better on codereview: <a href=\"http://codereview.stackexchange.com/\">codereview.stackexchange.com</a>"}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1485351965, "post_id": 41852640, "comment_id": 70890023, "body": "Repeatedly reading the worksheet is <b>very</b> costly.  I would either use either auto-filter or advanced filter; if not fast enough, read the entire data table into an array (a single statement); collect the rows to be kept in a Collection or Dictionary object; fill a results array with the Collection; write the array back to the worksheet.  You will speed up the process probably by a factor of ten."}, {"owner": {"reputation": 1, "user_id": 7297285, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3d860ab99c97eb2c842fb84b2e57f743?s=128&d=identicon&r=PG&f=1", "display_name": "SemiSentientSapien", "link": "https://stackoverflow.com/users/7297285/semisentientsapien"}, "edited": false, "score": 0, "creation_date": 1485354249, "post_id": 41852640, "comment_id": 70891710, "body": "Good idea&#39;s both.  I&#39;ll shake both trees and see which yields fruit.  Much thanks!"}], "owner": {"reputation": 1, "user_id": 7297285, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3d860ab99c97eb2c842fb84b2e57f743?s=128&d=identicon&r=PG&f=1", "display_name": "SemiSentientSapien", "link": "https://stackoverflow.com/users/7297285/semisentientsapien"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 47, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1485350274, "creation_date": 1485350274, "question_id": 41852640, "link": "https://stackoverflow.com/questions/41852640/more-efficient-method-to-sort-read-in-text-file", "title": "More efficient method to sort read-in text file", "body": "<p>I've read in a text file to excel from a database and I've done it in such a way that it filters out unnecessary columns.  My approach to filter rows was to use two subroutines and call the 2nd from within the first.  It takes ~8 seconds for the sheet to be filtered and there is only 400 or so rows.  The fact that it takes that long (even though it works) is that my code is inefficient.  If anyone has a better method I would greatly appreciate the knowledge! To delimit rows I've used the following VBA:</p>\n\n<pre><code>Sub FilterAndDelete()\nDim LR As Long, i As Long\nLR = Range(\"A\" &amp; Rows.Count).End(xlUp).Row\nFor i = LR To 1 Step -1\nSelect Case Left(Range(\"A\" &amp; i).Value, 3)\n    Case \"CHA\", \"HAM\", \"BKN\"\n        Call FilterAndDeleteB\n    Case Else\n        Rows(i).Delete\n        Call FilterAndDeleteB\nEnd Select\nNext i\nEnd Sub\n\nSub FilterAndDeleteB()\nDim Br As Long, i As Long\nBr = Range(\"B\" &amp; Rows.Count).End(xlUp).Row\nFor i = Br To 1 Step -1\nSelect Case Left(Range(\"B\" &amp; i).Value, 1)\n    Case \"-\"\n        Rows(i).Delete\n    Case Else\n        'do nothing\nEnd Select\nNext i\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1485350462, "post_id": 41852583, "comment_id": 70888982, "body": "you need to define which worksheet, like <code>Worksheets(&quot;Sheet1&quot;)</code>. But you confised a lot of things here, what exactly are you trying to achieve ? remove all &quot;0&quot; from <code>Range(&quot;F30:W1000&quot;)</code> ?"}, {"owner": {"reputation": 119, "user_id": 7425110, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/85308c4b83628b40f47ddd06a406ce0c?s=128&d=identicon&r=PG&f=1", "display_name": "Chrisftw", "link": "https://stackoverflow.com/users/7425110/chrisftw"}, "reply_to_user": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1485350813, "post_id": 41852583, "comment_id": 70889223, "body": "hi, i forgot to add the worksheet in the post indeed, but it is in my code. Yes I would like to Find all 0s and then delete the cell and shift them up."}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1485350878, "post_id": 41852583, "comment_id": 70889261, "body": "all the other cells inside the range have values inside them ? or you have some empty cells ?"}, {"owner": {"reputation": 119, "user_id": 7425110, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/85308c4b83628b40f47ddd06a406ce0c?s=128&d=identicon&r=PG&f=1", "display_name": "Chrisftw", "link": "https://stackoverflow.com/users/7425110/chrisftw"}, "reply_to_user": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1485351245, "post_id": 41852583, "comment_id": 70889524, "body": "the other cells are not empty. they have values."}], "answers": [{"tags": [], "owner": {"reputation": 1195, "user_id": 1788855, "user_type": "registered", "accept_rate": 29, "profile_image": "https://i.stack.imgur.com/9Ng0t.jpg?s=128&g=1", "display_name": "Carl Colijn", "link": "https://stackoverflow.com/users/1788855/carl-colijn"}, "is_accepted": false, "score": 1, "last_activity_date": 1485351365, "creation_date": 1485351365, "answer_id": 41853035, "question_id": 41852583, "link": "https://stackoverflow.com/questions/41852583/vba-findall-method-in-range-with-delete/41853035#41853035", "title": "VBA FindAll method in range with delete", "body": "<p>Your <code>EmptyCells.Delete Shift:=xlShiftUp</code> is placed outside of the <code>Do</code> loop, so it will not be executed during the looping over the cells.  Spotting these kinds of errors is made easier if you indent your code consistently, like e.g.:</p>\n\n<pre><code>Do Until EmptyCells Is Nothing\n    Debug.Print EmptyCells.Address\n    Set EmptyCells = Worksheets(\"Sheet1\").Range(\"F30:W1000\").FindNext(after=EmptyCells)\n    If EmptyCells.Address = FirstAddr Then\n        Exit Do\n    End If\nLoop\nEmptyCells.Delete Shift:=xlShiftUp\n</code></pre>\n\n<p>Formatting it like this shows you in one look that the .Delete is not happening to all cells but only once in the end.</p>\n"}, {"comments": [{"owner": {"reputation": 1195, "user_id": 1788855, "user_type": "registered", "accept_rate": 29, "profile_image": "https://i.stack.imgur.com/9Ng0t.jpg?s=128&g=1", "display_name": "Carl Colijn", "link": "https://stackoverflow.com/users/1788855/carl-colijn"}, "edited": false, "score": 0, "creation_date": 1485351446, "post_id": 41853039, "comment_id": 70889667, "body": "(comment applied only to 1st version) Note that this also deletes any cells that were empty previous to this; e.g. it deletes all &#39;0&#39; cells and all empty cells."}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "reply_to_user": {"reputation": 1195, "user_id": 1788855, "user_type": "registered", "accept_rate": 29, "profile_image": "https://i.stack.imgur.com/9Ng0t.jpg?s=128&g=1", "display_name": "Carl Colijn", "link": "https://stackoverflow.com/users/1788855/carl-colijn"}, "edited": false, "score": 0, "creation_date": 1485351583, "post_id": 41853039, "comment_id": 70889759, "body": "see my note above ^"}], "tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": false, "score": 1, "last_activity_date": 1485351459, "last_edit_date": 1485351459, "creation_date": 1485351367, "answer_id": 41853039, "question_id": 41852583, "link": "https://stackoverflow.com/questions/41852583/vba-findall-method-in-range-with-delete/41853039#41853039", "title": "VBA FindAll method in range with delete", "body": "<p>The following code will work properly in case all cells in Range(\"F30:W1000\") have values inside them (no blank values in the begining).</p>\n\n<p>First, replace all cells inside the range that have \"0\" inside them with \"\", so now they are actualy blank. </p>\n\n<p>Now, using the <code>SpecialCells(xlCellTypeBlanks)</code> we can set another range, and delete all of them at once.</p>\n\n<p><strong>Note</strong>: like I wrote in the begining, this will work only if all cells inside the range have values, if there are empty cells (which the PO said there are none) they will be deleted too.</p>\n\n<p><strong>Code</strong></p>\n\n<pre><code>Sub FindAllDelete()\n\nDim Rng As Range\nDim EmptyCells As Range\n\nWith Worksheets(\"Sheet1\") '&lt;-- modify \"Sheet1\" to your sheet's name\n    Set Rng = .Range(\"F30:W1000\")\n\n    With Rng\n        .Replace What:=\"0\", Replacement:=\"\", LookAt:=xlWhole, _\n        SearchOrder:=xlByRows, MatchCase:=False\n    End With\n\n    Set EmptyCells = Rng.SpecialCells(xlCellTypeBlanks)\n    EmptyCells.Delete xlShiftUp\nEnd With\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1485351661, "post_id": 41853127, "comment_id": 70889806, "body": "also nice (thought of doing this as a second option, but you beat me to it)"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1485352422, "post_id": 41853127, "comment_id": 70890370, "body": "not only I +1 your answer, but also the PO has accepted it as answer, positive people are rewarded :)"}], "tags": [], "owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "is_accepted": true, "score": 2, "last_activity_date": 1485351618, "creation_date": 1485351618, "answer_id": 41853127, "question_id": 41852583, "link": "https://stackoverflow.com/questions/41852583/vba-findall-method-in-range-with-delete/41853127#41853127", "title": "VBA FindAll method in range with delete", "body": "<p>I prefer the answer given by @Shai Rado as it doesn't involve any looping, but saying that I wrote the code so I'm going to post it....</p>\n\n<p>This way unions all the 0 ranges, or you could delete them as you find them and just continue the loop until <code>EmptyCells Is Nothing</code>.</p>\n\n<pre><code>Public Sub FindAllDelete()\n\n    Dim EmptyCells As Range\n    Dim AllCells As Range\n    Dim FirstAddr As String\n\n    With Worksheets(\"Sheet1\").Range(\"F30:W1000\")\n        Set EmptyCells = .Find(0)\n\n        If Not EmptyCells Is Nothing Then\n            FirstAddr = EmptyCells.Address\n            Do\n                If EmptyCells.Address = FirstAddr Then\n                    Set AllCells = EmptyCells\n                Else\n                    Set AllCells = Union(AllCells, EmptyCells)\n                End If\n\n                Set EmptyCells = .FindNext(EmptyCells)\n\n            Loop While EmptyCells.Address &lt;&gt; FirstAddr\n        End If\n\n    End With\n\n    AllCells.Delete Shift:=xlShiftUp\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1485351913, "post_id": 41853166, "comment_id": 70889978, "body": "Feels like I&#39;m plus 1&#39;ing everyone today.  Is a good solution if you&#39;re doing it infrequently or don&#39;t need to trust someone else to do it (you know the ones - they&#39;re good at Excel because they saw a chart once)."}], "tags": [], "owner": {"reputation": 31, "user_id": 7457659, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9017fcff8468cbb0e18c1f6b54e022aa?s=128&d=identicon&r=PG&f=1", "display_name": "OliverQueen", "link": "https://stackoverflow.com/users/7457659/oliverqueen"}, "is_accepted": false, "score": 1, "last_activity_date": 1485353725, "last_edit_date": 1485353725, "creation_date": 1485351707, "answer_id": 41853166, "question_id": 41852583, "link": "https://stackoverflow.com/questions/41852583/vba-findall-method-in-range-with-delete/41853166#41853166", "title": "VBA FindAll method in range with delete", "body": "<p>This can be done without VBA, you can use <kbd>CTRL</kbd> + <kbd>H</kbd> to replace the 0's with a blank and then delete the blanks using <kbd>CTRL</kbd> + <kbd>G</kbd> selecting blanks and deleting</p>\n"}], "owner": {"reputation": 119, "user_id": 7425110, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/85308c4b83628b40f47ddd06a406ce0c?s=128&d=identicon&r=PG&f=1", "display_name": "Chrisftw", "link": "https://stackoverflow.com/users/7425110/chrisftw"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 135, "favorite_count": 0, "accepted_answer_id": 41853127, "answer_count": 4, "score": 0, "last_activity_date": 1485353725, "creation_date": 1485350105, "last_edit_date": 1485350859, "question_id": 41852583, "link": "https://stackoverflow.com/questions/41852583/vba-findall-method-in-range-with-delete", "title": "VBA FindAll method in range with delete", "body": "<p>Outcome : Find and Remove a value in a range and shift cells up.</p>\n\n<p>Having some issues with an infinite loop in my code. I believe the problem might be with the LastCell.</p>\n\n<p>I need to locate all the 0 in a range. Select, delete and shift cells up.</p>\n\n<pre><code>sub(FindAllDelete)\n\nDim EmptyCells As Range\nDim LastCell As Range\nDim FirstAddr As String\n\nWith Worksheets(\"Sheet1\").Range(\"F30:W1000\")\nSet LastCell = Range(\"W1000\")\nEnd With\nSet EmptyCells = Worksheets(\"Sheet1\").Range(\"F30:W1000\").Find(What:=\"0\", After:=LastCell)\n\nIf Not EmptyCells Is Nothing Then\n    FirstAddr = LastCell.Address\nEnd If\n\n  Do Until EmptyCells Is Nothing\n     Debug.Print EmptyCells.Address\n     Set EmptyCells = Worksheets(\"Sheet1\").Range(\"F30:W1000\").FindNext(after=EmptyCells)\n    If EmptyCells.Address = FirstAddr Then\n  Exit Do\n    End If\n    Loop\n    EmptyCells.Delete Shift:=xlShiftUp\n</code></pre>\n"}, {"tags": ["vba", "excel", "hyperlink"], "comments": [{"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 1, "creation_date": 1485353491, "post_id": 41852534, "comment_id": 70891158, "body": "You should be able to utilize the hyperlink() function, including a formula for how the hyperlink is built.  If values are in columns A and B for naming, then you could have something similar to =&quot;C://File/&quot;&amp;A&amp;&quot; &quot;&amp;B&quot;.pdf&quot; in column C.  Then in column D you can =hyperlink() what is displayed in column C."}], "answers": [{"tags": [], "owner": {"reputation": 1195, "user_id": 1788855, "user_type": "registered", "accept_rate": 29, "profile_image": "https://i.stack.imgur.com/9Ng0t.jpg?s=128&g=1", "display_name": "Carl Colijn", "link": "https://stackoverflow.com/users/1788855/carl-colijn"}, "is_accepted": false, "score": 0, "last_activity_date": 1485353520, "creation_date": 1485353520, "answer_id": 41853786, "question_id": 41852534, "link": "https://stackoverflow.com/questions/41852534/mass-excel-hyperlinks/41853786#41853786", "title": "Mass Excel hyperlinks", "body": "<p>You can use the <a href=\"https://support.office.com/en-us/article/HYPERLINK-function-333C7CE6-C5AE-4164-9C47-7DE9B76F577F\" rel=\"nofollow noreferrer\">HYPERLINK formula</a>.  The 1st parameter allows you to dynamically build up the URL to point to, so if you say you have the correct numbers already in a column, you can use that to build the URL.  Provided the URL for each scanned document can uniquely be derived using only that number, of course.</p>\n\n<p>If the scanned documents are on the web, then you can use e.g.:</p>\n\n<pre><code>=HYPERLINK(\"https://www.myserver.com/scans/\"&amp;A4&amp;\".pdf\",\"Scan nr. \"&amp;A4)\n</code></pre>\n\n<p>If they're on your own computer (or on a network drive), then you can use e.g.:</p>\n\n<pre><code>=HYPERLINK(\"file:///D:/scans/\"&amp;A4&amp;\".pdf\",\"Scan nr. \"&amp;A4)\n</code></pre>\n\n<p>--- EDIT ---\nAs Cyril pointed out, you can also just use e.g.:</p>\n\n<pre><code>=HYPERLINK(\"D:\\scans\\\"&amp;A4&amp;\".pdf\",\"Scan nr. \"&amp;A4)\n</code></pre>\n\n<p>which makes it a bit more readable.  Also note that Excel really likes to warn you when using these types of links ;)</p>\n"}], "owner": {"reputation": 1, "user_id": 3509596, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d9e93696287f49f3d84d386bff17c67?s=128&d=identicon&r=PG&f=1", "display_name": "Devin Hartman", "link": "https://stackoverflow.com/users/3509596/devin-hartman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 87, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1485353520, "creation_date": 1485349937, "last_edit_date": 1485350547, "question_id": 41852534, "link": "https://stackoverflow.com/questions/41852534/mass-excel-hyperlinks", "title": "Mass Excel hyperlinks", "body": "<p>I've looked around and can't seem to find any help for what I am looking to do.</p>\n\n<p>I have a document that I am using to record data related to repairs and such on machines. </p>\n\n<p>All of my entries are done in a numeric order. </p>\n\n<p>I have to scan hard copies in and hyperlink to them from the excel sheet. </p>\n\n<p>All the files are named to me in a numerical order as well that matches the number in column A. </p>\n\n<p>Is there a way to do this as a formula?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1472, "user_id": 1726522, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/0DUTN.gif?s=128&g=1", "display_name": "CMArg", "link": "https://stackoverflow.com/users/1726522/cmarg"}, "edited": false, "score": 1, "creation_date": 1485348785, "post_id": 41852009, "comment_id": 70887818, "body": "Googling &quot;excel vba find blank cells&quot;: <a href=\"http://stackoverflow.com/a/14962028/1726522\">this</a>. Googling &quot;excel vba message box&quot;: <a href=\"https://msdn.microsoft.com/en-us/library/aa445082(v=vs.60).aspx\" rel=\"nofollow noreferrer\">this</a>. Just join  both."}], "answers": [{"tags": [], "owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "is_accepted": false, "score": 0, "last_activity_date": 1485349343, "last_edit_date": 1485349343, "creation_date": 1485348936, "answer_id": 41852182, "question_id": 41852009, "link": "https://stackoverflow.com/questions/41852009/excel-vba-code-to-search-range-of-cells-to-see-if-it-contains-a-space/41852182#41852182", "title": "Excel VBA Code to search range of cells to see if it contains a space", "body": "<p>How about..</p>\n\n<pre><code>Set r = Range(\"A1:A1000\").Find(What:=\" \", LookIn:=xlFormulas, LookAt _\n        :=xlPart, SearchOrder:=xlByRows, SearchDirection:=xlNext, MatchCase:= _\n        False, SearchFormat:=False)\nIf r Is Nothing Then\n' code to run if nothing found\nElse\n MsgBox \"Space found in cell \" &amp; r.Address\nEnd If\n</code></pre>\n\n<p><strong>EDIT</strong> - removed the <code>After:</code> parameter as this caused issues when cell beyond search area was active.</p>\n"}, {"tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": false, "score": 0, "last_activity_date": 1485348964, "creation_date": 1485348964, "answer_id": 41852194, "question_id": 41852009, "link": "https://stackoverflow.com/questions/41852009/excel-vba-code-to-search-range-of-cells-to-see-if-it-contains-a-space/41852194#41852194", "title": "Excel VBA Code to search range of cells to see if it contains a space", "body": "<p>Just an example:\n</p>\n\n<pre><code>Dim cell As Range\n\nSet cell = Range(\"A1:A1000\").Find(What:=\" \", After:=ActiveCell, LookIn:=xlFormulas, _\n        LookAt:=xlWhole, SearchOrder:=xlByRows, SearchDirection:=xlNext, _\n        MatchCase:=False, SearchFormat:=False)\n\nIf cell Is Nothing Then\n    Stop 'do something\nElse\n    Stop 'do something else\nEnd If\n</code></pre>\n\n<p>More info: <a href=\"https://msdn.microsoft.com/en-us/library/office/ff839746.aspx\" rel=\"nofollow noreferrer\">https://msdn.microsoft.com/en-us/library/office/ff839746.aspx</a></p>\n"}], "owner": {"reputation": 1, "user_id": 4610995, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4804c91a0f49c26561243ea2104ddb51?s=128&d=identicon&r=PG&f=1", "display_name": "TAB1980", "link": "https://stackoverflow.com/users/4610995/tab1980"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 616, "favorite_count": 0, "answer_count": 2, "score": -2, "last_activity_date": 1485349343, "creation_date": 1485348412, "last_edit_date": 1531164843, "question_id": 41852009, "link": "https://stackoverflow.com/questions/41852009/excel-vba-code-to-search-range-of-cells-to-see-if-it-contains-a-space", "title": "Excel VBA Code to search range of cells to see if it contains a space", "body": "<p>I have search high and low, but I am after a vba code to search a range, ie A1:A1000, and if it finds a cell that contains a space, then to pop up with a message box.</p>\n\n<p>Thanks</p>\n"}, {"tags": ["excel", "vba", "algorithm", "performance"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1485349151, "post_id": 41852006, "comment_id": 70888079, "body": "I hardly doubt anyone can improve code without knowing <i>exactly</i> what it does / should do."}, {"owner": {"reputation": 21753, "user_id": 3978545, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jmQsw.png?s=128&g=1", "display_name": "Wolfie", "link": "https://stackoverflow.com/users/3978545/wolfie"}, "edited": false, "score": 0, "creation_date": 1485353422, "post_id": 41852006, "comment_id": 70891101, "body": "You need to at least comment your code as to what each section is meant to achieve... Or just explain what the whole code is trying to achieve and someone might have a quicker way to do it!"}, {"owner": {"reputation": 286, "user_id": 2101161, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/14b33674a7952dec3c13c2f38cd4ff06?s=128&d=identicon&r=PG", "display_name": "unseen_rider", "link": "https://stackoverflow.com/users/2101161/unseen-rider"}, "edited": false, "score": 0, "creation_date": 1485374213, "post_id": 41852006, "comment_id": 70904765, "body": "Done. Please review updated question"}, {"owner": {"reputation": 1195, "user_id": 1788855, "user_type": "registered", "accept_rate": 29, "profile_image": "https://i.stack.imgur.com/9Ng0t.jpg?s=128&g=1", "display_name": "Carl Colijn", "link": "https://stackoverflow.com/users/1788855/carl-colijn"}, "edited": false, "score": 0, "creation_date": 1485412720, "post_id": 41852006, "comment_id": 70918191, "body": "Maybe <a href=\"http://math.stackexchange.com/questions/2093497/finding-number-of-coprime-tuples-from-1-to-n/2094773\" title=\"finding number of coprime tuples from 1 to n\">math.stackexchange.com/questions/2093497/&hellip;</a> ?"}, {"owner": {"reputation": 286, "user_id": 2101161, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/14b33674a7952dec3c13c2f38cd4ff06?s=128&d=identicon&r=PG", "display_name": "unseen_rider", "link": "https://stackoverflow.com/users/2101161/unseen-rider"}, "reply_to_user": {"reputation": 1195, "user_id": 1788855, "user_type": "registered", "accept_rate": 29, "profile_image": "https://i.stack.imgur.com/9Ng0t.jpg?s=128&g=1", "display_name": "Carl Colijn", "link": "https://stackoverflow.com/users/1788855/carl-colijn"}, "edited": false, "score": 0, "creation_date": 1485479491, "post_id": 41852006, "comment_id": 70953647, "body": "@carlcolijn yes that is the mathematics question (now referenced). Are you able to advise on the time complexity part of my question?"}], "answers": [{"tags": [], "owner": {"reputation": 1195, "user_id": 1788855, "user_type": "registered", "accept_rate": 29, "profile_image": "https://i.stack.imgur.com/9Ng0t.jpg?s=128&g=1", "display_name": "Carl Colijn", "link": "https://stackoverflow.com/users/1788855/carl-colijn"}, "is_accepted": false, "score": 1, "last_activity_date": 1485354501, "creation_date": 1485354501, "answer_id": 41854101, "question_id": 41852006, "link": "https://stackoverflow.com/questions/41852006/excel-vba-how-to-make-code-more-efficient-and-take-less-time/41854101#41854101", "title": "Excel VBA How to make code more efficient and take less time", "body": "<p>Without exactly knowing your data, nor how big it may be, it might be optimized by fetching all data needed in one go into VBA arrays.</p>\n\n<p>Your code basically fetches the <code>.Value</code> over and over again from the cells in column 1 and 2.  Every time you cross the VBA/Excel border like this you pay a (small) overhead cost, but paying that price too many times does add up.</p>\n\n<p>Instead try to fetch the data in columns 1 and 2 only once, and work from these arrays instead.  Like e.g.:</p>\n\n<pre><code>Dim col1Values As Variant\ncol1Values = sht2.Range(sht2.Cells(1, 1), sht2.Cells(lastrow_sht2, 1)).Value\nDim col2Values As Variant\ncol2Values = sht2.Range(sht2.Cells(1, 2), sht2.Cells(lastrow_sht2, 2)).Value\n</code></pre>\n\n<p>and from then on not use <code>sht2.Cells(m, 1).Value</code> anymore but <code>col1Values(m, 1)</code>.  (note that the arrays Excel returns here are 2-dimensional arrays, where the 1st index is the row and the 2nd the column.)</p>\n"}, {"comments": [{"owner": {"reputation": 1195, "user_id": 1788855, "user_type": "registered", "accept_rate": 29, "profile_image": "https://i.stack.imgur.com/9Ng0t.jpg?s=128&g=1", "display_name": "Carl Colijn", "link": "https://stackoverflow.com/users/1788855/carl-colijn"}, "edited": false, "score": 1, "creation_date": 1485413272, "post_id": 41854454, "comment_id": 70918380, "body": "<code>.ScreenUpdating</code> and <code>.Calculation</code> are beneficial only if you&#39;re changing the contents of cells; in this case cells are only read, not written to."}, {"owner": {"reputation": 1195, "user_id": 1788855, "user_type": "registered", "accept_rate": 29, "profile_image": "https://i.stack.imgur.com/9Ng0t.jpg?s=128&g=1", "display_name": "Carl Colijn", "link": "https://stackoverflow.com/users/1788855/carl-colijn"}, "edited": false, "score": 0, "creation_date": 1485413344, "post_id": 41854454, "comment_id": 70918398, "body": "And a good way to use the <code>.Calculation</code> property fail-proof is to apply RAII to it (<a href=\"https://en.wikipedia.org/wiki/Resource_acquisition_is_initialization\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/Resource_acquisition_is_initializatio&zwnj;&#8203;n</a>); make a class module that disables <code>.Calculation</code> in it&#39;s <code>Class_Initialize</code>, and that resets it to it&#39;s initial value in <code>Class_Terminate</code>.  Then just <code>New</code> one of these at the top of your sub, and once it goes out of scope (also on errors), <code>.Calculation</code> is reset automatically for you.  If you need to enable calculation midway, just set the thing to Nothing at that spot."}], "tags": [], "owner": {"reputation": 391, "user_id": 1115743, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/700b27a0e37c8c135ef34daf357a495f?s=128&d=identicon&r=PG", "display_name": "rdnobrega", "link": "https://stackoverflow.com/users/1115743/rdnobrega"}, "is_accepted": false, "score": 1, "last_activity_date": 1485355531, "creation_date": 1485355531, "answer_id": 41854454, "question_id": 41852006, "link": "https://stackoverflow.com/questions/41852006/excel-vba-how-to-make-code-more-efficient-and-take-less-time/41854454#41854454", "title": "Excel VBA How to make code more efficient and take less time", "body": "<p>Also, you can disable calculation and screenupdating during your operation with this at the beginning of your code:</p>\n\n<pre><code> Application.ScreenUpdating = False\n Application.Calculation = xlCalculationManual\n</code></pre>\n\n<p>And at the end, turn back to normal:</p>\n\n<pre><code> Application.ScreenUpdating = True\n Application.Calculation = xlCalculationAutomatic\n</code></pre>\n\n<p>Be careful with macro crashes. Remember to put it back to normal those variables when the crash happens.</p>\n"}], "owner": {"reputation": 286, "user_id": 2101161, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/14b33674a7952dec3c13c2f38cd4ff06?s=128&d=identicon&r=PG", "display_name": "unseen_rider", "link": "https://stackoverflow.com/users/2101161/unseen-rider"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 445, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1594205024, "creation_date": 1485348401, "last_edit_date": 1594205024, "question_id": 41852006, "link": "https://stackoverflow.com/questions/41852006/excel-vba-how-to-make-code-more-efficient-and-take-less-time", "title": "Excel VBA How to make code more efficient and take less time", "body": "<p>I have the following code below. I would like advice and suggestions on how it can be improved / rewrote to minimize;</p>\n\n<p>1) Time taken\n2) Number of operations</p>\n\n<p>Presume all variables that are integer in code can be very large - eg each <code>dim as Long</code>, and > 0.</p>\n\n<p>Purpose of code, is to count the number of tuples (a,b,c,d) for a solution to a mathematics question (<a href=\"https://math.stackexchange.com/questions/2093497/finding-number-of-coprime-tuples-from-1-to-n/2094773\">https://math.stackexchange.com/questions/2093497/finding-number-of-coprime-tuples-from-1-to-n/2094773</a>) stored in variable <code>i</code>, and storing each possible tuple (a,b,c,d) in <code>Array_abcd()</code>.</p>\n\n<p>** In particular, the slowest part seems to be the code under  <code>'Calculate tuples for F(i,j)=1 stored in Array_u_Fij()</code> - where I calculate the time complexity to be of Big-O n^5.**\n- This is now where I'm requesting help.</p>\n\n<p>Function Modulo:</p>\n\n<pre><code>Function Modulo(x as long, y as long, p as long) as Long\n\nModulo = x * y mod p\n\nEnd Function\n</code></pre>\n\n<p>Main Sub:</p>\n\n<pre><code>Sub Number_tuples()\n\n'This is limited by the number of rows and column an \n'.xlsm file can have.\nApplication.screenupdating=false\nApplication.displayalerts=false\nApplication.calculation=xlcalculationmanual\n\nPrime1=599\nPrime2=601\np=Prime1 * Prime2\n\n'Set up sheet 1\n...\n'Set up sheet 2\n...\n\n'Declare Array_Ints()\nRedim Array_ints(4)\n\n'Store list of integers to be given in question\n'This can be any list of integers\nArray_ints(0)=1\nArray_ints(1)=10\nArray_ints(2)=100\nArray_ints(3)=1000\n\n'Calculate N\nN=Ubound(Array_ints)\n\n'Declare array Array_nu_Fij()\nRedim Array_nu_Fij(N,N,2)\n\n'Calculate all non-unique Fij and store results in Array_nu_Fij(), and put matrix of nu_Fij values in sheet 1\n...\nArray_nu_Fij(i,j,0) = Modulo(a,b,p)\nArray_nu_Fij(i,j,1) = Cstr(a) &amp; \",\" &amp; Cstr(b)\nsht1.cells(i+2, j+1).value=Array_nu_Fij(i,j,0)\n...\n\n'Declare Array_u_Fij()\nReDim Array_Fij(N*N,3)\n\n'Calculate all unique Fij\n'Store uFij value in Array_u_Fij(o,0), and a_b in Array(o,1)\n'Put a_b value in worksheet 2\n...\n\n'Put freq from worksheet 2 in Array_u_Fij()\n...\n\n\n'Calculate size of 1st col of Array_u_Fij()\nlastrow_new_sht2= sht2.Cells(sht2.Rows.Count, \"A\"). End(xlUp).Row\nstartrow_sht2 = 3\nsize_u_Fij_1col = lastrow_new_sht2 - startrow_sht2 + 1\n\n'Declare Array_abcd()\nReDim Array_abcd(N*N)\n\n'Calculate tuples for F(i,j)=1 stored in Array_u_Fij()\ni=0\nFor m = 0 to size_u_Fij_1col - 1\n    'Store current u_Fij and freq being considered\n    u_fij_1= Array_u_Fij(m,0)\n    Freq = Array_u_Fij(m,1)\n    a_b = Array_u_Fij(m,2)\n    c_d = \"\"\n        While freq &gt; 1\n            'First compare u_Fij_1 with current u_Fij_1\n            For freq_gt_1 = 2 to freq\n                'Check if u_Fij_1 = 1\n                If u_fij_1 = 1 then\n                    dblGCD = 1\n                    i = i +1\n                    Array_abcd(m)= Array_abcd(m) &amp; \"||\" &amp; a_b\n                Else\n                    'GCD of u_Fij_1 with other u_Fij_1\n                    dblGCD = u_Fij_1\n                    If dblGCD = 1 then\n                        i = i + 1\n                        Array_abcd(m)= Array_abcd(m) &amp; \"||\" &amp; a_b\n                    Else\n                    End if\n                End if\n            Next freq_gt_1\n\n            '2nd compare u_Fij_1 with u_Fij_2&lt;&gt;u_Fij_1\n            For q = 1 to lastrow_sht2\n                If m+q &gt;= size_u_Fij_1col then\n                     'Array_u_Fij(m+q) doesn't exist\n                     'Hence no need to check\n                Else\n                    u_Fij_2 = Array_u_Fij(m+q+1,0)\n                    freq_other = Array_u_Fij(m+q+1,1)\n                    c_d = Array_u_Fij(m+q+1,2)\n                    'Only consider freq_other &gt; 0\n                    While freq_other &gt; 0\n                        if u_Fij_1 =1 then\n                            'GCD is 1\n                            dblGCD = 1\n                            Array_abcd(m)= Array_abcd(m) &amp; \"||\" &amp; a_b &amp; \",\" &amp; c_d\n                            i = i + 1\n                       Elseif u_Fij_1 = u_Fij_2 then\n                             dblGCD = u_Fij_1\n                             If dblGCD = 1 then\n                                 i = i + 1\n                                 Array_abcd(m)= Array_abcd(m) &amp; \"||\" &amp; a_b &amp; \",\" &amp; c_d                                 \n                             Else\n                             End if\n                        Elseif u_fij_2 = 1 then\n                             dblGCD = 1\n                             i = i +1\n                             Array_abcd(m)= Array_abcd(m) &amp; \"||\" &amp; a_b &amp; \",\" &amp; c_d \n                        Else\n                             dblGCD = Application.WorksheetFunction.GCD(u_Fij_1,u_Fij_2)\n                             If dblGCD = 1 then\n                                 i = i + 1\n                                 Array_abcd(m)= Array_abcd(m) &amp; \"||\" &amp; a_b &amp; \",\" &amp; c_d                                 \n                             Else\n                             End if\n                    Else \n                    End if\n                    Freq_other = freq_other - 1\n                Wend\n            End if\n        Next q\n        Freq=freq - 1\n    Wend\n\n    While freq=1\n         'Compare a=u_Fij_1 with b=u_Fij_2&lt;&gt;1\n         For q = 0 To size_uFij_1col\n             'Check if m+q is equal to or larger than size of \n             'array\n             If m+q &gt;= size_uFij_1col then\n                 'Do nothing\n             Else\n                 If u_fij_1 = 1 then\n                     dblGCD = 1\n                     Array_abcd(m)=Array_abcd(m) &amp; \"||\" &amp; a_b &amp; \",\" &amp; c_d\n                     i= i+1\n                 Else\n                     'u_Fij_1 &lt;&gt;1. Now need to consider freq of other u_Fij_2=b&lt;&gt;a\n                     u_Fij_2 = Array_u_Fij(m+q+1,0)\n                     freq_other=Array_uFij(m+q+1,1)\n                     c_d=Array_uFij(m+q+1,2)\n                     'Only consider freq_other &gt; 0\n                     While freq_other &gt; 0\n                         'Check if u_Fij_2 =1\n                         If u_Fij_2 = 1 then\n                             'GCD is 1\n                             Array_abcd(m)=Array_abcd(m) &amp; \"||\" &amp; a_b &amp; \",\" &amp; c_d\n                             i = i + 1\n                         Else\n                             'Need to determine GCD\n                             dblGCD = Application.WorksheetFunction.GCD(u_Fij_1,u_Fij_2)\n                             If dblGCD = 1 then\n                                 I = I+ 1\n                                 Array_abcd(m)=Array_abcd(m) &amp; \"||\" &amp; a_b &amp; \",\" &amp; c_d\n                             Else\n                             End if             \n                         End if\n                         Freq_other = Freq_other - 1\n                     Wend\n                     End if\n             End if\n        Next q\n        Freq=freq - 1\n    Wend\nNext m\n\nApplication.screenupdating=true\nApplication.displayalerts=true\nApplication.calculation=xlcalculationautomatic\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["asp.net", "vb.net", "vba", "visual-studio"], "answers": [{"comments": [{"owner": {"reputation": 111, "user_id": 7141389, "user_type": "registered", "profile_image": "https://graph.facebook.com/1405289732832510/picture?type=large", "display_name": "hugofsousa", "link": "https://stackoverflow.com/users/7141389/hugofsousa"}, "edited": false, "score": 0, "creation_date": 1485362948, "post_id": 41852490, "comment_id": 70897952, "body": "I thought if I did not put the exception for you it would be obvious that it was not necessary. Excuse me. Edited"}, {"owner": {"reputation": 150063, "user_id": 87698, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/33f12c2270fa9d3627845b9f41a08f4f?s=128&d=identicon&r=PG", "display_name": "Heinzi", "link": "https://stackoverflow.com/users/87698/heinzi"}, "reply_to_user": {"reputation": 111, "user_id": 7141389, "user_type": "registered", "profile_image": "https://graph.facebook.com/1405289732832510/picture?type=large", "display_name": "hugofsousa", "link": "https://stackoverflow.com/users/7141389/hugofsousa"}, "edited": false, "score": 0, "creation_date": 1485363292, "post_id": 41852490, "comment_id": 70898218, "body": "@HugoFagundes: Unfortunately, it&#39;s not at all obvious: There are lots (and lots) of people who <i>really</i> do this. Thanks for updating your question! I upvoted it and hope that some MySql expert can help you here."}], "tags": [], "owner": {"reputation": 150063, "user_id": 87698, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/33f12c2270fa9d3627845b9f41a08f4f?s=128&d=identicon&r=PG", "display_name": "Heinzi", "link": "https://stackoverflow.com/users/87698/heinzi"}, "is_accepted": false, "score": 2, "last_activity_date": 1485355789, "last_edit_date": 1485355789, "creation_date": 1485349808, "answer_id": 41852490, "question_id": 41851790, "link": "https://stackoverflow.com/questions/41851790/mysql-transaction-rollback-failed/41852490#41852490", "title": "MYSQL Transaction.Rollback failed", "body": "<blockquote>\n  <p>Can anyone tell me why?</p>\n</blockquote>\n\n<p>Yes, the exception thrown by your code will tell you why.</p>\n\n<p>What, you don't get an exception? Let's see... oh, you get them, but you throw them away:</p>\n\n<pre><code>Public Sub Rollback()\n    Try\n        transaction.Rollback()\n        connection.Close()\n    Catch\n    EndTry\nEnd Sub\n</code></pre>\n\n<p>Don't do that. If people are trying to help you (and exceptions are the .NET runtime's way of helping you find bugs), listen to them. Don't close your ears and go <em>\"lalala, I can't hear you!\"</em>. That's what an empty <code>Catch</code> blog does.</p>\n\n<p>Remove those fake exception handlers from your code (everywhere, not just in this method), and you will get useful error messages.</p>\n"}], "owner": {"reputation": 111, "user_id": 7141389, "user_type": "registered", "profile_image": "https://graph.facebook.com/1405289732832510/picture?type=large", "display_name": "hugofsousa", "link": "https://stackoverflow.com/users/7141389/hugofsousa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 108, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1485491413, "creation_date": 1485347626, "last_edit_date": 1485491413, "question_id": 41851790, "link": "https://stackoverflow.com/questions/41851790/mysql-transaction-rollback-failed", "title": "MYSQL Transaction.Rollback failed", "body": "<p>I've recently been implementing a request sequence in Visual Basics, and would like to rollback when some fails. I therefore did as follows:</p>\n\n<pre><code>Public Class DAO\n    Dim connection As New MysqlConnection\n    Dim command As New MySqlCommand\n    Dim dr As MySqlDataReader\n    Dim transaction As MySqlTransaction\n\n    Public Sub New()\n        connection = New MySqlConnection(`MYDATA_FROM_DATABASE`)\n        connection.Open()\n        transaction = connection.BeginTransaction\n        command.Connection = connection\n        command.Transaction = transaction\n    End Sub\n\n    Public Sub Rollback()\n        System.Diagnostics.Debug.WriteLine(Me.GetType.Name &amp; \" - Rollback\")\n        Try\n            transaction.Rollback()\n            connection.Close()\n            System.Diagnostics.Debug.WriteLine(\"Rollback success\")\n        Catch\n            System.Diagnostics.Debug.WriteLine(\"Rollback failed - \" &amp; ex.Message)\n        End Try\n    End Sub\n\n    Public Sub Close()\n        System.Diagnostics.Debug.WriteLine(Me.GetType.Name &amp; \" - Closing\")\n        Try\n            transaction.Commit()\n            connection.Close()\n            System.Diagnostics.Debug.WriteLine(\"Commit success\")\n        Catch ex As Exception\n            System.Diagnostics.Debug.WriteLine(\"Commit failed - \" &amp; ex.Message)\n        End Try\n    End Sub\nEnd Class\n</code></pre>\n\n<p>And with that I create other DAOS classes, inheriting from that one. The other classes have other methods, for example:</p>\n\n<pre><code>Public Class UserDAO\n    Inherits DAO\n\n    Public Function Insere(name As String) As Boolean\n        Try\n            command.commandText = \"INSERT INTO User(Name) VALUES('\" &amp; name &amp; \"')\"\n            command.ExecuteNonQuery\n            Return True\n        Catch\n            Return False\n        End Try\n    End Function \nEnd Class\n</code></pre>\n\n<p>And, for example, I want to insert 3 users, and if it gives error I undo everything:</p>\n\n<p>Suppose a method in any other location of the code</p>\n\n<pre><code>Public Sub Insert3Users\n    Dim UserDAO As New UserDAO\n    If UserDAO.Insere(\"USER_1\") And UserDAO.Insere(\"USER_2\") And UserDAO.Insere(\"USER_3\") Then\n        UserDAO.Close()\n    Else\n        UserDAO.Rollback()\n    End If\nEnd Sub\n</code></pre>\n\n<p>After calling this <code>Insert3Users</code> method, I can force the rollback, calling instead <code>Close()</code> the <code>Rollback()</code> method of the DAO class, even when it succeeds.</p>\n\n<p>And taking the test I do not succeed in Rollback. Can anyone tell me why?</p>\n\n<p><strong>EDIT - Exceptions</strong></p>\n\n<p><strong>Output:</strong></p>\n\n<blockquote>\n  <p>UserDAO - Rollback<br>Rollback success</p>\n</blockquote>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 865, "user_id": 6588969, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ec413f82a9798b72db70b0585a7bec99?s=128&d=identicon&r=PG&f=1", "display_name": "Julian Kuchlbauer", "link": "https://stackoverflow.com/users/6588969/julian-kuchlbauer"}, "edited": false, "score": 1, "creation_date": 1485348874, "post_id": 41851594, "comment_id": 70887894, "body": "You have the needed Formula in your question already. What exactly do you want?"}, {"owner": {"reputation": 23, "user_id": 6235729, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-NpYpmR9O5BI/AAAAAAAAAAI/AAAAAAAAASI/k6n4zX2FYYo/photo.jpg?sz=128", "display_name": "Houyam", "link": "https://stackoverflow.com/users/6235729/houyam"}, "reply_to_user": {"reputation": 865, "user_id": 6588969, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ec413f82a9798b72db70b0585a7bec99?s=128&d=identicon&r=PG&f=1", "display_name": "Julian Kuchlbauer", "link": "https://stackoverflow.com/users/6588969/julian-kuchlbauer"}, "edited": false, "score": 0, "creation_date": 1485353143, "post_id": 41851594, "comment_id": 70890910, "body": "I need code VBA"}, {"owner": {"reputation": 865, "user_id": 6588969, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ec413f82a9798b72db70b0585a7bec99?s=128&d=identicon&r=PG&f=1", "display_name": "Julian Kuchlbauer", "link": "https://stackoverflow.com/users/6588969/julian-kuchlbauer"}, "edited": false, "score": 0, "creation_date": 1485353646, "post_id": 41851594, "comment_id": 70891266, "body": "For what? Why isn&#39;t the formula suitable as well?"}, {"owner": {"reputation": 23, "user_id": 6235729, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-NpYpmR9O5BI/AAAAAAAAAAI/AAAAAAAAASI/k6n4zX2FYYo/photo.jpg?sz=128", "display_name": "Houyam", "link": "https://stackoverflow.com/users/6235729/houyam"}, "reply_to_user": {"reputation": 865, "user_id": 6588969, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ec413f82a9798b72db70b0585a7bec99?s=128&d=identicon&r=PG&f=1", "display_name": "Julian Kuchlbauer", "link": "https://stackoverflow.com/users/6588969/julian-kuchlbauer"}, "edited": false, "score": 0, "creation_date": 1485354062, "post_id": 41851594, "comment_id": 70891580, "body": "I wanted the code in vba because I have filtering by critere, so every time I perform a filtering of the date X up to Y date, I must have it automatically calculated for the row of &quot;Calculate defect&quot; and &quot;Cumul Defect &quot;To make a graph. I do not know how to do the code in vba to compute each line of &quot;Quantity_prod&quot; and put the calculation of each row in the column &quot;Calculate defect&quot;"}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 6235729, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-NpYpmR9O5BI/AAAAAAAAAAI/AAAAAAAAASI/k6n4zX2FYYo/photo.jpg?sz=128", "display_name": "Houyam", "link": "https://stackoverflow.com/users/6235729/houyam"}, "edited": false, "score": 0, "creation_date": 1485356290, "post_id": 41854402, "comment_id": 70893169, "body": "This is what I wanted, but for &quot;Const AndRew As Integer = 200&quot; but for this code I need  just take the lines I filtered,"}, {"owner": {"reputation": 23, "user_id": 6235729, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-NpYpmR9O5BI/AAAAAAAAAAI/AAAAAAAAASI/k6n4zX2FYYo/photo.jpg?sz=128", "display_name": "Houyam", "link": "https://stackoverflow.com/users/6235729/houyam"}, "edited": false, "score": 0, "creation_date": 1485356323, "post_id": 41854402, "comment_id": 70893195, "body": "Because in the filtering the lines they are not fix"}, {"owner": {"reputation": 865, "user_id": 6588969, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ec413f82a9798b72db70b0585a7bec99?s=128&d=identicon&r=PG&f=1", "display_name": "Julian Kuchlbauer", "link": "https://stackoverflow.com/users/6588969/julian-kuchlbauer"}, "reply_to_user": {"reputation": 23, "user_id": 6235729, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-NpYpmR9O5BI/AAAAAAAAAAI/AAAAAAAAASI/k6n4zX2FYYo/photo.jpg?sz=128", "display_name": "Houyam", "link": "https://stackoverflow.com/users/6235729/houyam"}, "edited": false, "score": 0, "creation_date": 1485356525, "post_id": 41854402, "comment_id": 70893333, "body": "But the first row is fix? Can there be empty rows or would it be enough, to iterate through the rows, until an empty row appears?"}, {"owner": {"reputation": 23, "user_id": 6235729, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-NpYpmR9O5BI/AAAAAAAAAAI/AAAAAAAAASI/k6n4zX2FYYo/photo.jpg?sz=128", "display_name": "Houyam", "link": "https://stackoverflow.com/users/6235729/houyam"}, "edited": false, "score": 0, "creation_date": 1485356933, "post_id": 41854402, "comment_id": 70893602, "body": "The column G is not fixed it depends on filtering, for example sometimes I can have 500 line sometimes I can have more so &quot;EndRow&quot; it must take what is in column G"}, {"owner": {"reputation": 23, "user_id": 6235729, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-NpYpmR9O5BI/AAAAAAAAAAI/AAAAAAAAASI/k6n4zX2FYYo/photo.jpg?sz=128", "display_name": "Houyam", "link": "https://stackoverflow.com/users/6235729/houyam"}, "edited": false, "score": 0, "creation_date": 1485357283, "post_id": 41854402, "comment_id": 70893840, "body": "But it gives me that 0 in &quot;Calculate defect&quot;"}, {"owner": {"reputation": 865, "user_id": 6588969, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ec413f82a9798b72db70b0585a7bec99?s=128&d=identicon&r=PG&f=1", "display_name": "Julian Kuchlbauer", "link": "https://stackoverflow.com/users/6588969/julian-kuchlbauer"}, "reply_to_user": {"reputation": 23, "user_id": 6235729, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-NpYpmR9O5BI/AAAAAAAAAAI/AAAAAAAAASI/k6n4zX2FYYo/photo.jpg?sz=128", "display_name": "Houyam", "link": "https://stackoverflow.com/users/6235729/houyam"}, "edited": false, "score": 0, "creation_date": 1485357357, "post_id": 41854402, "comment_id": 70893900, "body": "What exactly do you mean?"}, {"owner": {"reputation": 23, "user_id": 6235729, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-NpYpmR9O5BI/AAAAAAAAAAI/AAAAAAAAASI/k6n4zX2FYYo/photo.jpg?sz=128", "display_name": "Houyam", "link": "https://stackoverflow.com/users/6235729/houyam"}, "edited": false, "score": 0, "creation_date": 1485357555, "post_id": 41854402, "comment_id": 70894053, "body": "In the column &quot;Calculated defect&quot; it calculates the filtered faults after the number 0 which displays for hundreds of rows"}, {"owner": {"reputation": 865, "user_id": 6588969, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ec413f82a9798b72db70b0585a7bec99?s=128&d=identicon&r=PG&f=1", "display_name": "Julian Kuchlbauer", "link": "https://stackoverflow.com/users/6588969/julian-kuchlbauer"}, "reply_to_user": {"reputation": 23, "user_id": 6235729, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-NpYpmR9O5BI/AAAAAAAAAAI/AAAAAAAAASI/k6n4zX2FYYo/photo.jpg?sz=128", "display_name": "Houyam", "link": "https://stackoverflow.com/users/6235729/houyam"}, "edited": false, "score": 0, "creation_date": 1485358021, "post_id": 41854402, "comment_id": 70894398, "body": "Please have another try on the now edited code. Please keep in mind that every time you refilter, the code has to be executed."}, {"owner": {"reputation": 23, "user_id": 6235729, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-NpYpmR9O5BI/AAAAAAAAAAI/AAAAAAAAASI/k6n4zX2FYYo/photo.jpg?sz=128", "display_name": "Houyam", "link": "https://stackoverflow.com/users/6235729/houyam"}, "edited": false, "score": 0, "creation_date": 1485363037, "post_id": 41854402, "comment_id": 70898019, "body": "Does not work by the old code it passes the error I tell you"}, {"owner": {"reputation": 23, "user_id": 6235729, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-NpYpmR9O5BI/AAAAAAAAAAI/AAAAAAAAASI/k6n4zX2FYYo/photo.jpg?sz=128", "display_name": "Houyam", "link": "https://stackoverflow.com/users/6235729/houyam"}, "edited": false, "score": 0, "creation_date": 1485365189, "post_id": 41854402, "comment_id": 70899482, "body": "the is old code Sub calcul() Dim ws As Worksheet &#39;set worksheet variable Set ws = Sheet7  With ws  Const SourceColumn As String = &quot;G&quot; Const DestColumn As String = &quot;K&quot; Const TotalCell As String = &quot;H4&quot; Const StartRow As Integer = 11 Const EndRow As Integer = 100  For i = StartRow To EndRow    ws.Range(DestColumn &amp; i).Formula = &quot;=(&quot; &amp; SourceColumn &amp; i &amp; &quot;/&quot; &amp; TotalCell &amp; &quot;)*100&quot; Next i End With   End Sub"}, {"owner": {"reputation": 23, "user_id": 6235729, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-NpYpmR9O5BI/AAAAAAAAAAI/AAAAAAAAASI/k6n4zX2FYYo/photo.jpg?sz=128", "display_name": "Houyam", "link": "https://stackoverflow.com/users/6235729/houyam"}, "edited": false, "score": 0, "creation_date": 1485421967, "post_id": 41854402, "comment_id": 70922225, "body": "Is there a possibility of you sending the file?"}, {"owner": {"reputation": 865, "user_id": 6588969, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ec413f82a9798b72db70b0585a7bec99?s=128&d=identicon&r=PG&f=1", "display_name": "Julian Kuchlbauer", "link": "https://stackoverflow.com/users/6588969/julian-kuchlbauer"}, "reply_to_user": {"reputation": 23, "user_id": 6235729, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-NpYpmR9O5BI/AAAAAAAAAAI/AAAAAAAAASI/k6n4zX2FYYo/photo.jpg?sz=128", "display_name": "Houyam", "link": "https://stackoverflow.com/users/6235729/houyam"}, "edited": false, "score": 0, "creation_date": 1485499309, "post_id": 41854402, "comment_id": 70958635, "body": "Sending what file?"}, {"owner": {"reputation": 865, "user_id": 6588969, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ec413f82a9798b72db70b0585a7bec99?s=128&d=identicon&r=PG&f=1", "display_name": "Julian Kuchlbauer", "link": "https://stackoverflow.com/users/6588969/julian-kuchlbauer"}, "reply_to_user": {"reputation": 23, "user_id": 6235729, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-NpYpmR9O5BI/AAAAAAAAAAI/AAAAAAAAASI/k6n4zX2FYYo/photo.jpg?sz=128", "display_name": "Houyam", "link": "https://stackoverflow.com/users/6235729/houyam"}, "edited": false, "score": 0, "creation_date": 1485505489, "post_id": 41854402, "comment_id": 70961274, "body": "No problem, kind to be of service."}], "tags": [], "owner": {"reputation": 865, "user_id": 6588969, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ec413f82a9798b72db70b0585a7bec99?s=128&d=identicon&r=PG&f=1", "display_name": "Julian Kuchlbauer", "link": "https://stackoverflow.com/users/6588969/julian-kuchlbauer"}, "is_accepted": true, "score": 0, "last_activity_date": 1485357981, "last_edit_date": 1485357981, "creation_date": 1485355371, "answer_id": 41854402, "question_id": 41851594, "link": "https://stackoverflow.com/questions/41851594/calculate-each-cells-of-columns-and-to-put-in-another-columns-code-vba/41854402#41854402", "title": "Calculate each cells of columns and to put in another columns code vba", "body": "<p>You can use this code.\nJust change the constants according to your needs.</p>\n\n<pre><code>Const SourceColumn As String = \"G\"\nConst DestColumn As String = \"L\"\nConst TotalCell As String = \"H4\"\nConst StartRow As Integer = 11\nDim i As Long\ni = StartRow\nFor i = StartRow To UsedRange.Cells(UsedRange.Cells.Count).Row\n    Range(DestColumn &amp; i).Clear\nNext i\nWhile Range(SourceColumn &amp; i).Value &lt;&gt; vbNullString\n    Range(DestColumn &amp; i).Formula = \"=(\" &amp; SourceColumn &amp; i &amp; \"/\" &amp; TotalCell &amp; \")*100\"\n    i = i + 1\nWend\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 6235729, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-NpYpmR9O5BI/AAAAAAAAAAI/AAAAAAAAASI/k6n4zX2FYYo/photo.jpg?sz=128", "display_name": "Houyam", "link": "https://stackoverflow.com/users/6235729/houyam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 74, "favorite_count": 0, "accepted_answer_id": 41854402, "answer_count": 1, "score": 0, "last_activity_date": 1485357981, "creation_date": 1485347059, "last_edit_date": 1531164843, "question_id": 41851594, "link": "https://stackoverflow.com/questions/41851594/calculate-each-cells-of-columns-and-to-put-in-another-columns-code-vba", "title": "Calculate each cells of columns and to put in another columns code vba", "body": "<p>I need a code for my worksheet below:\n<a href=\"https://i.stack.imgur.com/b6yGT.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/b6yGT.png\" alt=\"this my tab\"></a> </p>\n\n<p>I want to calculate each cell in the \"Quantity Prod\" column ((G11 / Total: H4) * 100), and put in the column \"Calculate defect\".</p>\n"}, {"tags": ["vba", "find", "ms-word"], "comments": [{"owner": {"reputation": 999, "user_id": 1334432, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/d1de489181c287291a422a9b592dccac?s=128&d=identicon&r=PG", "display_name": "jimscafe", "link": "https://stackoverflow.com/users/1334432/jimscafe"}, "edited": false, "score": 0, "creation_date": 1485397328, "post_id": 41851471, "comment_id": 70913523, "body": "Not sure why R3uK destroyed the immediate window output I provided and reformatted the numbers as above, it doesn&#39;t make sense as currently displayed."}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1486669410, "post_id": 41851471, "comment_id": 71457174, "body": "Jim, is the information now displayed the way you intended? (Because it&#39;s still not making a lot of sense). FWIW I wouldn&#39;t use InRange(Selection.Range), I&#39;d create a second Range object and do dupRange = oRng.Duplicate. Word Ranges are odd beasts - if you do Set dupRange = oRng any changes you make to the one are reflected in the other, so you have to use Duplicate. And you should&#39;t rely on Selection as that could change. Also note this makes no sense: Set sText = Application.Selection as Selection returns a RANGE object. Should be: sText = Selection.Text if you want the text."}], "owner": {"reputation": 999, "user_id": 1334432, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/d1de489181c287291a422a9b592dccac?s=128&d=identicon&r=PG", "display_name": "jimscafe", "link": "https://stackoverflow.com/users/1334432/jimscafe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 118, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1485347026, "creation_date": 1485346701, "last_edit_date": 1485347026, "question_id": 41851471, "link": "https://stackoverflow.com/questions/41851471/find-text-in-word-using-range-finds-text-beyond-the-text-selected", "title": "Find text in Word using Range finds text beyond the text selected", "body": "<p>I am trying to find numbers at the start of a paragraph where the operator has selected the paragraphs to be searched.\nFor some reason the search finds the number (text) at the start of the next paragraph, even if the selection ends half-way through the first paragraph.</p>\n\n<pre><code>Set oRng = Application.Selection.Range\nSet sText = Application.Selection\nMsgBox sText\nDebug.Print Application.Selection.Paragraphs.count\nDebug.Print oRng.start &amp; \" \" &amp; oRng.End\nDebug.Print \"-------------------------------------\"\nWith oRng.Find\n    .Text = \"^13[0-9A-Da-d]{1,10}\"\n    .MatchWildcards = True\n    Do While oRng.InRange(Selection.Range)\n        Debug.Print Selection.Range.start &amp; \" \" &amp; Selection.Range.End\n        Debug.Print oRng.start &amp; \" \" &amp; oRng.End\n        If .Execute Then\n            Debug.Print Selection.Range.start &amp; \" \" &amp; Selection.Range.End\n            Debug.Print oRng.start &amp; \" \" &amp; oRng.End\n            Debug.Print oRng.Text\n            Set xRng = Application.ActiveDocument.Range(start:=oRng.start + 1, End:=oRng.start + 12)\n            'getRefs.Add Mid(oRng.Text, 2)\n            getRefs.Add xRng.Text\n        Else\n            Exit Do\n        End If\n        oRng.Collapse wdCollapseEnd\n    Loop\nEnd With\n</code></pre>\n\n<p>The output I get is as follows :-\n 2 </p>\n\n<h2>1389 1753</h2>\n\n<p>1389 1753\n1389 1753\n1389 1753\n1399 1401</p>\n\n<p>1\n1389 1753\n1401 1401\n1389 1753\n1754 1756</p>\n\n<p>2</p>\n\n<p>The first 2 is the number of paragraphs, the first of which does not begin with a number.\nThen the start and end of the selection.\nThe entry 1754 1756 is the range of the text at the start of the third paragraph which from the above is clearly not in the initial selection.</p>\n\n<p>The paragraphs might look like this :-\nTitle\n1. Text here sd\n2. More text here\n(Except the paragraphs are longer than just a few words.)\nI am using xRng to get text including the found text (less paragraph marker) and some following text.</p>\n"}, {"tags": ["sql", "excel", "ms-access", "vba"], "answers": [{"comments": [{"owner": {"reputation": 552, "user_id": 6046766, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/a9801af62bcf72ae7979f12d7b6f2bce?s=128&d=identicon&r=PG&f=1", "display_name": "Davy C", "link": "https://stackoverflow.com/users/6046766/davy-c"}, "edited": false, "score": 0, "creation_date": 1485352775, "post_id": 41851558, "comment_id": 70890645, "body": "Many thanks for your input. That looks great for SQL Server, but this is Access 2007 unfortunately."}], "tags": [], "owner": {"reputation": 5449, "user_id": 5093602, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hpV0c.gif?s=128&g=1", "display_name": "Chanukya", "link": "https://stackoverflow.com/users/5093602/chanukya"}, "is_accepted": false, "score": 0, "last_activity_date": 1485346950, "creation_date": 1485346950, "answer_id": 41851558, "question_id": 41851311, "link": "https://stackoverflow.com/questions/41851311/ms-access-2007-pivoting-data-in-query-and-calling-from-excel/41851558#41851558", "title": "MS Access 2007 pivoting data in query and calling from Excel", "body": "<p>By imagining data i tried like this  </p>\n\n<pre><code>DECLARE @cols AS NVARCHAR(MAX),\n    @query  AS NVARCHAR(MAX)\n\nselect @cols = STUFF((SELECT ',' + QUOTENAME(fiscal_per_month) \n                    from table\n                    group by fiscal_per_month\n            FOR XML PATH(''), TYPE\n            ).value('.', 'NVARCHAR(MAX)') \n        ,1,1,'')\n\nset @query = 'SELECT item_code,item_code_desc,' + @cols + ',total from \n             (\n                select *,sum(quantity)over(partition by year) as total\n                from table\n            ) x\n            pivot \n            (\n                sum(quantity)\n                for months in (' + @cols + ')\n            ) p '\n\nexec(@query);\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 552, "user_id": 6046766, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/a9801af62bcf72ae7979f12d7b6f2bce?s=128&d=identicon&r=PG&f=1", "display_name": "Davy C", "link": "https://stackoverflow.com/users/6046766/davy-c"}, "is_accepted": false, "score": 0, "last_activity_date": 1485354620, "creation_date": 1485354620, "answer_id": 41854138, "question_id": 41851311, "link": "https://stackoverflow.com/questions/41851311/ms-access-2007-pivoting-data-in-query-and-calling-from-excel/41854138#41854138", "title": "MS Access 2007 pivoting data in query and calling from Excel", "body": "<p>Duh. This is what the \"Crosstab\" query is for, so I solved this myself. Running through the wizard produced this code, which works well:</p>\n\n<pre><code>TRANSFORM Sum(qry_AllProducts.[Quantity]) AS SumOfQuantity\n</code></pre>\n\n<p>SELECT qry_AllProducts.[ItemCode], qry_AllProducts.[ItemCodeDesc], qry_AllProducts.[FiscalCalYear], Sum(qry_AllProducts.[Quantity]) AS [Total Of Quantity]\nFROM qry_AllProducts\nGROUP BY qry_AllProducts.[ItemCode], qry_AllProducts.[ItemCodeDesc], qry_AllProducts.[FiscalCalYear]\nPIVOT qry_AllProducts.[FiscalCalPeriod];</p>\n\n<p>The only trick is that you can't actually pull this via an ADODB SQL command from Excel, so I had to create an additional \"Make Table\" query, pointing to the results of the crosstab, which then sits as a temp table in the database. This can then be queried from Excel. I'll need to figure out how it should refresh, but this works. Thanks for looking.</p>\n"}], "owner": {"reputation": 552, "user_id": 6046766, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/a9801af62bcf72ae7979f12d7b6f2bce?s=128&d=identicon&r=PG&f=1", "display_name": "Davy C", "link": "https://stackoverflow.com/users/6046766/davy-c"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 75, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1594651226, "creation_date": 1485346167, "last_edit_date": 1594651226, "question_id": 41851311, "link": "https://stackoverflow.com/questions/41851311/ms-access-2007-pivoting-data-in-query-and-calling-from-excel", "title": "MS Access 2007 pivoting data in query and calling from Excel", "body": "<p>I'm a bit stumped on this. There's similar threads here on Stackoverflow, but I haven't found an answer, and it's actually hard to know how to describe what I'm searching for to put into the search box.</p>\n\n<p>I have this query in an MS Access database, which returns items sold grouped by product and total quantity. The way the data is stored, it's broken down by year, and then again by month in the year (FiscalPeriod 01-12 (Jan-Dec)). At the moment, my query looks like this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/kbAVl.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/kbAVl.jpg\" alt=\"enter image description here\"></a></p>\n\n<pre><code>SELECT CI_item.ItemCode, CI_item.ItemCodeDesc, Im_ItemWhseHistoryByPeriod.FiscalCalYear, Im_ItemWhseHistoryByPeriod.FiscalCalPeriod, ([QuantitySold]+[QuantityIssued]-[QuantityReturnedCustomer]) AS Quantity FROM CI_item INNER JOIN Im_ItemWhseHistoryByPeriod ON CI_item.ItemCode = Im_ItemWhseHistoryByPeriod.ItemCode;\n</code></pre>\n\n<p>I'm trying to figure out a way of pulling at the months into their own columns so I can achieve something like this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/SMjqS.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/SMjqS.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>I've tried some experimenting with the \"Pivot View\" in the Access query, but this doesn't give me what I want, and I won't be able to query it from Excel using SQL statements. I considered breaking this down into lots of different queries pulled together, but I just wondered if anyone knows of a better way. I'm not an expert at all at SQL queries, particularly in the awkward Access editor.</p>\n\n<p>Many thanks in advance!</p>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 0, "creation_date": 1485346449, "post_id": 41851252, "comment_id": 70886423, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/41833275/copy-data-using-vlookup-and-if\">copy data using vlookup and if</a>"}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 0, "creation_date": 1485346470, "post_id": 41851252, "comment_id": 70886444, "body": "<a href=\"http://stackoverflow.com/questions/41804530/vlookup-and-if-condition-copy-data-vba\" title=\"vlookup and if condition copy data vba\">stackoverflow.com/questions/41804530/&hellip;</a>"}], "owner": {"reputation": 27, "user_id": 3217660, "user_type": "registered", "accept_rate": 33, "profile_image": "https://graph.facebook.com/1187995807944634/picture?type=large", "display_name": "Atul Kant Godiyal", "link": "https://stackoverflow.com/users/3217660/atul-kant-godiyal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 77, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1485360125, "creation_date": 1485346020, "last_edit_date": 1485360125, "question_id": 41851252, "link": "https://stackoverflow.com/questions/41851252/excel-vba-lookup-and-multiple-if-function", "title": "excel vba lookup and multiple if function", "body": "<p>i have this code to copy data from one sheet to other based on multiple conditions</p>\n\n<p>I have three sheets namely master,jan,feb. I want that value of cell B5 in sheet feb should be value of cell H7 in sheet master only if any of the cell of sheet feb in range I5:AM is non blank and value of cell an5 in sheet jan = \"WRK.\" and so on look down up to row 81. And then lookup first emplty cell in range B5:B81 and select it If the date of any cell in range O:7:O100 in master sheet lies in current month of current year then copy cell b in parrallel to cell O and paste in first blank cell of sheet feb Range B:5B81. </p>\n\n<pre><code>Option Explicit\n\nSub CopyRows()\n\nDim Cl As Range\nDim str As String\nDim RowUpdCrnt As Long\nDim LR As Long\n\nSheets(\"Feb\").Range(\"B5:B81\").Value = \"\"\n\nLR = Cells(Sheets(\"Feb\").Rows.Count, 1).End(xlUp).Row\nRowUpdCrnt = 5\n\n' In my test data, the \"WRK.\"s are in column AN.  This For-Each only selects column AN.\n' I assume all my \"WRK.\"s are in a single column.  Replace \"B\" by the appropriate\n' column letter for your data.\n\n\nWith Sheets(\"Jan\")\n  ' loop until last row with data in Column AN (and not the entire column) to save time\n  For Each Cl In .Range(\"AN1:AN\" &amp; .Cells(.Rows.Count, \"AN\").End(xlUp).Row)\n    If Cl.Value Like str And Sheets(\"Feb\").Range(Cl.Address).Value &lt;&gt; \"\" Then\n    'if the cell contains the correct value copy it to next empty row on sheet 2 &amp;  delete the row\n      If Not IsError(Application.Vlookup(.Range(\"B\" &amp; Cl.Row).Value, Sheets(\"Master\").Range(\"H7:H200\"), 1, 0)) Then   ' &lt;-- verify the VLookup was successful\n        Sheets(\"Feb\").Range(\"B\" &amp; RowUpdCrnt).Value = Application.Vlookup(.Range(\"B\" &amp; Cl.Row).Value, Sheets(\"Master\").Range(\"H7:H200\"), 1, 0)\n        RowUpdCrnt = RowUpdCrnt + 1\n      End If  \n\n      If Application.Worksheets(\"Feb\").Range(\"I5:AK81\") &lt;&gt; \"\" And Application.Worksheets(\"Jan\").Range(\"I5:AM81\") &lt;&gt; \"TRF.\" Then\n        Application.Worksheet(\"Feb\").Range(\"B5:B81\") = Application.Vlookup(Application.Worksheet(\"Jan\").Range(\"B5\"), Application.WorksheetFunction(\"Master\").Range(\"H7:Q200\"), 1, 0).Copy\n        With Sheets(\"Feb\").Range(\"B5\").PasteSpecial(xlPasteValues)\n          Dim objDate As Date\n          Dim ObjDate2 As Date\n          'year, month, day\n          objDate = DateSerial(1, 1, 2017)\n          ObjDate2 = DateSerial(31, 1, 2017)\n          If Application.Worksheets(\"master\").Range(\"H7:H200\").Value &gt; ObjDate2 And Application.Worksheets(\"master\").Range(\"H7:H200\").Value &lt; objDate Then      \n            If Not IsError(Application.Vlookup(.Range(\"B\" &amp; Cl.Row).Value, Sheets(\"Master\").Range(\"H7:H200\"), 1, 0)) Then   ' &lt;-- verify the VLookup was successful\n              Sheets(\"Feb\").Range(\"B\" &amp; RowUpdCrnt).Value = Application.Vlookup(.Range(\"B\" &amp; Cl.Row).Value, Sheets(\"Master\").Range(\"H7:H200\"), 1, 0)\n              RowUpdCrnt = RowUpdCrnt + 1\n            End If\n          End If\n        End With\n        Application.CutCopyMode = False\n      End If\n    End If\n  Next Cl\nEnd With\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1485346156, "post_id": 41851245, "comment_id": 70886262, "body": "what is &quot;cell 1 across&quot; ? you mean 1 cell to the left ? right? tob? down? diagonal ?"}, {"owner": {"reputation": 3541, "user_id": 1616731, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/c9adb6c09548c81a8a9a46d7497081f6?s=128&d=identicon&r=PG&f=1", "display_name": "Tim Wilkinson", "link": "https://stackoverflow.com/users/1616731/tim-wilkinson"}, "edited": false, "score": 0, "creation_date": 1485346388, "post_id": 41851245, "comment_id": 70886382, "body": "You are already in a <code>With</code> so remove <code>Target</code> from <code>Target.Offset(, 2).Select</code> for a start."}, {"owner": {"reputation": 933, "user_id": 7415328, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/e492112338fd835b68222137dbd84a31?s=128&d=identicon&r=PG&f=1", "display_name": "user7415328", "link": "https://stackoverflow.com/users/7415328/user7415328"}, "reply_to_user": {"reputation": 3541, "user_id": 1616731, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/c9adb6c09548c81a8a9a46d7497081f6?s=128&d=identicon&r=PG&f=1", "display_name": "Tim Wilkinson", "link": "https://stackoverflow.com/users/1616731/tim-wilkinson"}, "edited": false, "score": 0, "creation_date": 1485346450, "post_id": 41851245, "comment_id": 70886424, "body": "@TimWilkinson thanks it still doesn&#39;t work though with or without the Target"}, {"owner": {"reputation": 10104, "user_id": 111794, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c209be384649abcc5a4bf8babb132572?s=128&d=identicon&r=PG", "display_name": "Zev Spitz", "link": "https://stackoverflow.com/users/111794/zev-spitz"}, "edited": false, "score": 1, "creation_date": 1485349816, "post_id": 41851245, "comment_id": 70888516, "body": "<i>This is not working. Please can someone show me where I am going wrong?</i> The first thing you are doing wrong is asking a vague question. We don&#39;t have your screen in front of you, we don&#39;t know what you expect to happen, and we have no idea in what way the program is defeating those expectations. You say the program is supposed to do two things: 1) delete a row, and 2) select another cell. Does the program delete any row? the wrong row? Is any cell selected? Is the wrong cell selected?"}, {"owner": {"reputation": 10104, "user_id": 111794, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c209be384649abcc5a4bf8babb132572?s=128&d=identicon&r=PG", "display_name": "Zev Spitz", "link": "https://stackoverflow.com/users/111794/zev-spitz"}, "edited": false, "score": 1, "creation_date": 1485350027, "post_id": 41851245, "comment_id": 70888676, "body": "Have you performed basic debugging steps, like setting a breakpoint and following the code along with the debugger? Maybe the code is falling on some side error and going to the error handler? Do you understand what all the parts of this code do, or did you just copy/paste it from some random corner of the Internet?"}], "answers": [{"tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": false, "score": 0, "last_activity_date": 1485346468, "creation_date": 1485346468, "answer_id": 41851400, "question_id": 41851245, "link": "https://stackoverflow.com/questions/41851245/vba-select-offset-cell-after-selecting-target-not-working/41851400#41851400", "title": "vba select offset cell after selecting target? Not working?", "body": "<p>Try the code below:</p>\n\n<pre><code>Private Sub Worksheet_SelectionChange(ByVal Target As Range)\n\n    Application.EnableEvents = True\n    On Error GoTo Errormask '&lt;-- don't see the need for this line\n\n    With Target\n        If .Column = 30 And .Row &gt; 16 And .Value Like \"Remove\" Then\n            .EntireRow.Delete\n            .Offset(, 2).Select\n        End If\n    End With\n\nErrormask: '&lt;-- don't see the need for this line\n   Application.DisplayAlerts = False\n   Exit Sub '&lt;-- don't see the need for this line, anyway at the end of the Sub\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 933, "user_id": 7415328, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/e492112338fd835b68222137dbd84a31?s=128&d=identicon&r=PG&f=1", "display_name": "user7415328", "link": "https://stackoverflow.com/users/7415328/user7415328"}, "edited": false, "score": 0, "creation_date": 1485350260, "post_id": 41851603, "comment_id": 70888838, "body": "i only want this to take affect for rows 17 onwards yes. With this code it keeps coming up with a type mismatch error when i click on cells in other places in the workbook."}, {"owner": {"reputation": 3541, "user_id": 1616731, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/c9adb6c09548c81a8a9a46d7497081f6?s=128&d=identicon&r=PG&f=1", "display_name": "Tim Wilkinson", "link": "https://stackoverflow.com/users/1616731/tim-wilkinson"}, "reply_to_user": {"reputation": 933, "user_id": 7415328, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/e492112338fd835b68222137dbd84a31?s=128&d=identicon&r=PG&f=1", "display_name": "user7415328", "link": "https://stackoverflow.com/users/7415328/user7415328"}, "edited": false, "score": 0, "creation_date": 1485351438, "post_id": 41851603, "comment_id": 70889661, "body": "Does this happen when you click on a merged cell?"}, {"owner": {"reputation": 933, "user_id": 7415328, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/e492112338fd835b68222137dbd84a31?s=128&d=identicon&r=PG&f=1", "display_name": "user7415328", "link": "https://stackoverflow.com/users/7415328/user7415328"}, "edited": false, "score": 0, "creation_date": 1485351980, "post_id": 41851603, "comment_id": 70890034, "body": "thanks tried the edit, doesn&#39;t seem to perform the delete row or anything now."}], "tags": [], "owner": {"reputation": 3541, "user_id": 1616731, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/c9adb6c09548c81a8a9a46d7497081f6?s=128&d=identicon&r=PG&f=1", "display_name": "Tim Wilkinson", "link": "https://stackoverflow.com/users/1616731/tim-wilkinson"}, "is_accepted": true, "score": 0, "last_activity_date": 1485352332, "last_edit_date": 1485352332, "creation_date": 1485347083, "answer_id": 41851603, "question_id": 41851245, "link": "https://stackoverflow.com/questions/41851245/vba-select-offset-cell-after-selecting-target-not-working/41851603#41851603", "title": "vba select offset cell after selecting target? Not working?", "body": "<p>In your <code>with</code>, do the offset on the line below before deleting the entire row.</p>\n\n<pre><code>Private Sub Worksheet_SelectionChange(ByVal Target As Range)\nWith Target\nIf Target.CurrentRegion.Count = 1 And Target.Cells.Count = 1 Then\n    If .Column = 30 And .Row &gt; 16 And .Value Like \"Remove\" Then\n        .Offset(1, 2).Select\n        .EntireRow.Delete\n    End If\nEnd If\nEnd With\nApplication.DisplayAlerts = False\nEnd Sub\n</code></pre>\n\n<p>Are you sure you have this in the code of your sheet and not in a module?</p>\n\n<p><strong>EDIT</strong></p>\n\n<p>I have added a new <code>If</code> to check the select cell isn't merged first, and only a single cell is selected.</p>\n"}], "owner": {"reputation": 933, "user_id": 7415328, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/e492112338fd835b68222137dbd84a31?s=128&d=identicon&r=PG&f=1", "display_name": "user7415328", "link": "https://stackoverflow.com/users/7415328/user7415328"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 660, "favorite_count": 0, "accepted_answer_id": 41851603, "answer_count": 2, "score": 0, "last_activity_date": 1485352332, "creation_date": 1485346003, "last_edit_date": 1485346269, "question_id": 41851245, "link": "https://stackoverflow.com/questions/41851245/vba-select-offset-cell-after-selecting-target-not-working", "title": "vba select offset cell after selecting target? Not working?", "body": "<p>I am using this code:</p>\n\n<pre><code>Private Sub Worksheet_SelectionChange(ByVal Target As Range)\n\n    Application.EnableEvents = True\n    On Error GoTo Errormask\n\n    With Target\n        If .Column = 30 And .Row &gt; 16 And .Value = \"Remove\" Then\n            .EntireRow.Delete\n            Target.Offset(, 2).Select\n        End If\n    End With\n\nErrormask:\n   Application.DisplayAlerts = False\n   Exit Sub\n\nEnd Sub\n</code></pre>\n\n<p>If a user clicks on the cell in column 30 which contains \"remove\", it should delete the row and then select the cell 1 across.</p>\n\n<p>This is not working. Please can someone show me where i am going wrong?</p>\n"}, {"tags": ["vba", "excel", "web-scraping"], "comments": [{"owner": {"reputation": 4114, "user_id": 5751805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da1c3545802a510a9b283f706d74283a?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan", "link": "https://stackoverflow.com/users/5751805/jordan"}, "edited": false, "score": 1, "creation_date": 1485346016, "post_id": 41851152, "comment_id": 70886173, "body": "Your code doesn&#39;t know which element within the class of <code>nav nav-list primary left-menu</code> it is getting the <code>&lt;a&gt;</code> tags from, change this:  <code>Set ele = html.getElementsByClassName(&quot;nav nav-list primary left-menu&quot;)</code> to  <code>Set ele = html.getElementsByClassName(&quot;nav nav-list primary left-menu&quot;)(0)</code>"}], "answers": [{"tags": [], "owner": {"reputation": 12766, "user_id": 863240, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/a2221c5cbaa548f9022616b4f6d6a59a?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Du\u0161ek", "link": "https://stackoverflow.com/users/863240/daniel-du%c5%a1ek"}, "is_accepted": true, "score": 2, "last_activity_date": 1585940205, "last_edit_date": 1585940205, "creation_date": 1485350222, "answer_id": 41852622, "question_id": 41851152, "link": "https://stackoverflow.com/questions/41851152/vba-web-scrape-getelementsbyclassname/41852622#41852622", "title": "VBA Web Scrape (getelementsbyclassname)", "body": "<p>If I understood your problem correctly you want the following:</p>\n\n<pre><code>Dim lists As IHTMLElementCollection\nDim anchorElements As IHTMLElementCollection\nDim ulElement As HTMLUListElement\nDim liElement As HTMLLIElement\nDim row As Long\n\nSet lists = html.getElementsByClassName(\"nav nav-list primary left-menu\")\nrow = 1\n\nFor Each ulElement In lists\n    For Each liElement In ulElement.getElementsByTagName(\"li\")\n        Set anchorElements = liElement.getElementsByTagName(\"a\")\n        If anchorElements.Length &gt; 0 Then\n            Cells(row, 1) = anchorElements.Item(0).innerText\n            row = row + 1\n        End If\n    Next liElement\nNext ulElement\n</code></pre>\n\n<p>Resulting  in this (for all lists):</p>\n\n<pre><code>VBA - Home\nVBA - Overview\nVBA - Excel Macros\nVBA - Excel Terms\nVBA - Macro Comments\nVBA - Message Box\nVBA - Input Box\nVBA - Variables\nVBA - Constants\nVBA - Operators\nVBA - Decisions\nVBA - Loops\nVBA - Strings\nVBA - Date and Time\nVBA - Arrays\nVBA - Functions\nVBA - SubProcedure\nVBA - Events\nVBA - Error Handling\nVBA - Excel Objects\nVBA - Text Files\nVBA - Programming Charts\nVBA - Userforms\nVBA - Quick Guide\nVBA - Useful Resources\nVBA - Discussion\nDeveloper's Best Practices\nQuestions and Answers\nEffective Resume Writing\nHR Interview Questions\nComputer Glossary\nWho is Who\n</code></pre>\n\n<p>If you want content of anchors of just the first list then just like this.</p>\n\n<pre><code>For Each liElement In lists.Item(0).getElementsByTagName(\"li\")\n    Set anchorElements = liElement.getElementsByTagName(\"a\")\n    If anchorElements.Length &gt; 0 Then\n        Cells(row, 1) = anchorElements.Item(0).innerText\n        row = row + 1\n    End If\nNext liElement\n</code></pre>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user7664559"}, "is_accepted": false, "score": 0, "last_activity_date": 1488836854, "creation_date": 1488836854, "answer_id": 42636212, "question_id": 41851152, "link": "https://stackoverflow.com/questions/41851152/vba-web-scrape-getelementsbyclassname/42636212#42636212", "title": "VBA Web Scrape (getelementsbyclassname)", "body": "<p>How about this one:</p>\n\n<pre><code>Sub TutorailsPoint()\nConst URL = \"https://www.tutorialspoint.com//vba/index.htm\"\nDim http As New MSXML2.XMLHTTP60, html As New HTMLDocument\nDim topics As Object, posts As Object, topic As Object\nDim x As Long\n\nx = 2\n\nhttp.Open \"GET\", URL, False\nhttp.send\nhtml.body.innerHTML = http.responseText\n\nSet topics = html.getElementsByClassName(\"nav nav-list primary left-menu\")\nFor Each posts In topics\n    For Each topic In posts.getElementsByTagName(\"a\")\n        Cells(x, 1) = topic.innerText\n        x = x + 1\n    Next topic\nNext posts\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 207, "user_id": 7180194, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/tnExZ.jpg?s=128&g=1", "display_name": "MITHU", "link": "https://stackoverflow.com/users/7180194/mithu"}, "is_accepted": false, "score": 0, "last_activity_date": 1505684076, "last_edit_date": 1505684076, "creation_date": 1503951030, "answer_id": 45926647, "question_id": 41851152, "link": "https://stackoverflow.com/questions/41851152/vba-web-scrape-getelementsbyclassname/45926647#45926647", "title": "VBA Web Scrape (getelementsbyclassname)", "body": "<p>Here is another way you may like. It will give you just the tutorials and nothing else:</p>\n\n<pre><code>Sub TpData()\n    Const URL = \"https://www.tutorialspoint.com//vba/index.htm\"\n    Dim http As New XMLHTTP60, html As New HTMLDocument, post As Object\n\n    With http\n        .Open \"GET\", URL, False\n        .send\n        html.body.innerHTML = .responseText\n    End With\n\n    For Each post In html.getElementsByClassName(\"left-menu\")(1).getElementsByTagName(\"li\")\n        With post.getElementsByTagName(\"a\")\n            If .Length Then i = i + 1: Cells(i, 1) = .item(0).innerText\n        End With\n    Next post\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 41, "user_id": 5756947, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-5Fm8bwedHeU/AAAAAAAAAAI/AAAAAAAAABE/3B7fl_WKN_4/photo.jpg?sz=128", "display_name": "Sajan Kaundal", "link": "https://stackoverflow.com/users/5756947/sajan-kaundal"}, "is_accepted": false, "score": 2, "last_activity_date": 1585939736, "last_edit_date": 1585939736, "creation_date": 1561834067, "answer_id": 56820050, "question_id": 41851152, "link": "https://stackoverflow.com/questions/41851152/vba-web-scrape-getelementsbyclassname/56820050#56820050", "title": "VBA Web Scrape (getelementsbyclassname)", "body": "<pre><code>Sub Button1_Click()\n\nDim internet As Object\nDim URL As String\n\nSet internet = CreateObject(\"InternetExplorer.Application\")\ninternet.Visible = True\n\nFor i = 2 To 3\n\nURL = Sheets(\"Sheet2\").Range(\"A\" &amp; i).Value\n            internet.Navigate URL\n\n Application.Wait Now + TimeSerial(0, 0, 15)\n\n Do Until internet.ReadyState &gt;= 4\n    DoEvents\nLoop\n\n\n Set a = internet.document\n         Set lists = a.GetElementsByClassName(\"mg-results-td is-sv uk-flex uk-flex-middle\")(0)\n         'Range(\"B\" &amp; i).Value = e.NextSibling.innerText\n         'Range(\"B\" &amp; i).Value = \"Sajan\"\n         'For Each ulElement In lists\n             Range(\"B\" &amp; i).Value = lists.innerText\n         'Next ulElement\n\n'internet.GoBack\nApplication.Wait Now + TimeSerial(0, 0, 50)\nNext i\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 43, "user_id": 7251793, "user_type": "registered", "profile_image": "https://graph.facebook.com/1115141568605635/picture?type=large", "display_name": "Dushyant", "link": "https://stackoverflow.com/users/7251793/dushyant"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 13221, "favorite_count": 1, "accepted_answer_id": 41852622, "answer_count": 4, "score": 1, "last_activity_date": 1585940205, "creation_date": 1485345728, "last_edit_date": 1485346324, "question_id": 41851152, "link": "https://stackoverflow.com/questions/41851152/vba-web-scrape-getelementsbyclassname", "title": "VBA Web Scrape (getelementsbyclassname)", "body": "<p>I am trying to scrape a list of VBA course items given at the right pane of the following link \"www.tutorialspoint.com/vba/index.htm\"</p>\n\n<p>But I am unable to scrape the list due to some error:</p>\n\n<pre class=\"lang-VBA prettyprint-override\"><code>Sub tutorailpointsscrap()\n      Dim ie As InternetExplorer\n\n      Set ie = New InternetExplorer\n\n      With ie\n      .navigate \"https://www.tutorialspoint.com//vba/index.htm\"\n      .Visible = True\n      Do While ie.readyState &lt;&gt; READYSTATE_COMPLETE\n      DoEvents\n      Loop\n      End With\n\n      Dim html As HTMLDocument\n      Set html = ie.document\n\n\n      Dim ele As IHTMLElement\n\n      Dim lists As IHTMLElementCollection\n      Dim row As Long\n\n      Set ele = html.getElementsByClassName(\"nav nav-list primary left-menu\")\n\n      Set lists = ele.getElementsByTagName(\"a\")\n      row = 1\n\n\n      For Each li In lists\n      Cells(row, 1) = li.innerText\n      row = row + 1\n      Next\n\n      ie.Quit\n\n  End Sub\n</code></pre>\n\n<p>The HTML that contains the data is:</p>\n\n<pre class=\"lang-html prettyprint-override\"><code>&lt;ul class=\"nav nav-list primary left-menu\"&gt;\n&lt;li class=\"heading\"&gt;VBA Tutorial&lt;/li&gt;\n&lt;li&gt;&lt;a href=\"/vba/index.htm\" style=\"background-color: rgb(214, 214, 214);\"&gt;VBA - Home&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\"/vba/vba_overview.htm\"&gt;VBA - Overview&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\"/vba/vba_excel_macros.htm\"&gt;VBA - Excel Macros&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\"/vba/vba_excel_terms.htm\"&gt;VBA - Excel Terms&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\"/vba/vba_macro_comments.htm\"&gt;VBA - Macro Comments&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\"/vba/vba_message_box.htm\"&gt;VBA - Message Box&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\"/vba/vba_input_box.htm\"&gt;VBA - Input Box&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\"/vba/vba_variables.htm\"&gt;VBA - Variables&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\"/vba/vba_constants.htm\"&gt;VBA - Constants&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\"/vba/vba_operators.htm\"&gt;VBA - Operators&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\"/vba/vba_decisions.htm\"&gt;VBA - Decisions&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\"/vba/vba_loops.htm\"&gt;VBA - Loops&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\"/vba/vba_strings.htm\"&gt;VBA - Strings&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\"/vba/vba_date_time.htm\"&gt;VBA - Date and Time&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\"/vba/vba_arrays.htm\"&gt;VBA - Arrays&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\"/vba/vba_functions.htm\"&gt;VBA - Functions&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\"/vba/vba_sub_procedure.htm\"&gt;VBA - SubProcedure&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\"/vba/vba_events.htm\"&gt;VBA - Events&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\"/vba/vba_error_handling.htm\"&gt;VBA - Error Handling&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\"/vba/vba_excel_objects.htm\"&gt;VBA - Excel Objects&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\"/vba/vba_text_files.htm\"&gt;VBA - Text Files&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\"/vba/vba_programming_charts.htm\"&gt;VBA - Programming Charts&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=\"/vba/vba_userforms.htm\"&gt;VBA - Userforms&lt;/a&gt;&lt;/li&gt;\n&lt;/ul&gt;\n</code></pre>\n"}, {"tags": ["mysql", "database", "vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 5785305, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7bcadf40001cbdbf2073a87dbab59a82?s=128&d=identicon&r=PG&f=1", "display_name": "Piedy", "link": "https://stackoverflow.com/users/5785305/piedy"}, "is_accepted": false, "score": 0, "last_activity_date": 1485346438, "creation_date": 1485346438, "answer_id": 41851391, "question_id": 41851040, "link": "https://stackoverflow.com/questions/41851040/reference-subsets-columns-of-a-table-in-excel/41851391#41851391", "title": "Reference subsets (columns) of a table in Excel", "body": "<p>Because you're seeking for some subsets of your data, you could transform the Range into a Table, load it to Excel Power Query and get rid of the columns you don't need.</p>\n\n<p>Then load it again to another Sheet of your choice.</p>\n\n<p>You can repeat this process as wished.</p>\n"}], "owner": {"reputation": 8331, "user_id": 2378710, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/2faf91f2efa646f23b07220deb997687?s=128&d=identicon&r=PG", "display_name": "Jamgreen", "link": "https://stackoverflow.com/users/2378710/jamgreen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 28, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1485346438, "creation_date": 1485345420, "question_id": 41851040, "link": "https://stackoverflow.com/questions/41851040/reference-subsets-columns-of-a-table-in-excel", "title": "Reference subsets (columns) of a table in Excel", "body": "<p>I have a very large table in Excel with 200 columns about some students.</p>\n\n<p>The first 10 columns identifies the student by name, age, etc.</p>\n\n<p>The remaining 190 columns can be split into categories.</p>\n\n<p>So my question is whether it is possible to create new sheets which duplicates some columns from the table, so I can split the table into 10 tables instead of having everything in the same table?</p>\n\n<p>I know I can do this manually, but the problem is that the data set will be updated in the future, so I wonder if it is possible to use references or something like that?</p>\n\n<p>If it is not possible, how would you solve such problem? Would you populate everything to a database (MySQL? Oracle?) and then extract in the sheets? The problem is also that I have to create some additional columns in each sheet, so I can not just override all content in a sheet.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1485357925, "post_id": 41850560, "comment_id": 70894324, "body": "I believe formulatext:= is equivalent to .formula= where you would put the calculation in... e.g. formulatext:= &quot;=&quot;&amp;Cells(i+1,34) would give the value in the cell at column 34, row i+1."}, {"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1486574094, "post_id": 41850560, "comment_id": 71407334, "body": "<code>FormulaText</code> accepts address of a cell with the formula. See <a href=\"http://stackoverflow.com/q/38630759/11683\">stackoverflow.com/q/38630759/11683</a> and read the comments."}], "owner": {"reputation": 1, "user_id": 5515110, "user_type": "registered", "profile_image": "https://graph.facebook.com/475260602627430/picture?type=large", "display_name": "\uae40\uc885\ud604", "link": "https://stackoverflow.com/users/5515110/%ea%b9%80%ec%a2%85%ed%98%84"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 373, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1505081120, "creation_date": 1485343987, "last_edit_date": 1505081120, "question_id": 41850560, "link": "https://stackoverflow.com/questions/41850560/how-to-use-solver-functions-in-vba", "title": "How to use solver functions in VBA?", "body": "<p>I made a macro for using the Excel solver quickly. But I don't know how to use the fomulatext function.</p>\n\n<p>I want to change a constraint, when the row is changed.(when changed the row, I want to use its 34th column as the right-hand side).</p>\n\n<p>Here's my code and the <code>solveradd CellRef:=Range(Cells(i + 1, 27), Cells(i + 1, 29)), relation:=1, formulatext:=\"Cells(i + 1, 34)\"</code> is my wondering point (especially the <code>\"Cells(i + 1, 34)\"</code> part).</p>\n\n<pre><code>For i = 1 To nrepeat\n\nSolverReset\nsolveradd CellRef:=Range(Cells(i + 1, 21), Cells(i + 1, 23)), relation:=3, formulatext:=0\nsolveradd CellRef:=Range(Cells(i + 1, 24), Cells(i + 1, 26)), relation:=1, formulatext:=0\nsolveradd CellRef:=Range(Cells(i + 1, 31), Cells(i + 1, 33)), relation:=3, formulatext:=0.0001\nsolveradd CellRef:=Range(Cells(i + 1, 27), Cells(i + 1, 29)), relation:=1, formulatext:=\"Cells(i + 1, 34)\"\nsolveradd CellRef:=Cells(i + 1, 30), relation:=2, formulatext:=1\nSolverOk SetCell:=Cells(i + 1, 34), MaxMinVal:=2, ByChange:=Range(Cells(i + 1, 31), Cells(i + 1, 34)), Engine:=1\nSolverSolve Userfinish:=True\n</code></pre>\n"}, {"tags": ["vba", "excel", "checkbox", "locking"], "answers": [{"tags": [], "owner": {"reputation": 318, "user_id": 6666679, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d594489d8f20eb953f0e175224cc5bf4?s=128&d=identicon&r=PG&f=1", "display_name": "LukasV", "link": "https://stackoverflow.com/users/6666679/lukasv"}, "is_accepted": false, "score": 0, "last_activity_date": 1485346125, "creation_date": 1485346125, "answer_id": 41851295, "question_id": 41850440, "link": "https://stackoverflow.com/questions/41850440/locking-excel-sheets-that-have-activex-checkboxes/41851295#41851295", "title": "Locking Excel Sheets that have ActiveX Checkboxes", "body": "<p>Select all the dropdown menus (unless they are Combo Boxes, then you don't need this step), right click and select <code>Format Cells</code>, go to tab <code>Protection</code>, untick box <code>Locked</code>, click <code>OK</code>.</p>\n\n<p>Then right click on the sheet tab, select <code>Protect Sheet...</code>, unselect box <code>Select locked cells</code> and <code>Select unlocked cells</code>, scroll down to the very bottom and select \"Edit objects\", choose a password and click <code>OK</code>.</p>\n\n<p>I hope that is what you are searching for.</p>\n"}], "owner": {"reputation": 1, "user_id": 7052295, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6b2c9be26cef9a882d06d6c59391b238?s=128&d=identicon&r=PG&f=1", "display_name": "joesmedley", "link": "https://stackoverflow.com/users/7052295/joesmedley"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 241, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1485346125, "creation_date": 1485343620, "last_edit_date": 1485343942, "question_id": 41850440, "link": "https://stackoverflow.com/questions/41850440/locking-excel-sheets-that-have-activex-checkboxes", "title": "Locking Excel Sheets that have ActiveX Checkboxes", "body": "<p>I have an excel file that uses multiple ActiveX Checkboxes, of course these all have a linked cell and when clicked pulls data from another sheet to show a figure next to the checkbox.</p>\n\n<p>The file also uses concatenation to provide information once a person has chosen from some data validation drop downs above - The concatenation occurs on the sheets elsewhere so of course many cells change values depending on selection of the drop downs and check boxes.</p>\n\n<p>Is there a way of locking the sheet or workbook that means a person can still choose desired information in the drop downs, for it to concatenate and display information in other cells, and for check boxes to check and show information whilst the user is unable to view and/or select/change any formulas or cells in the sheet?</p>\n\n<p>Hope this is clear, thanks for your help!!</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 1, "creation_date": 1485342649, "post_id": 41850007, "comment_id": 70884061, "body": "If <code>mywbk</code> is public variable, make sure to have <code>Set mywkb = Nothing</code> at the end of your code."}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 1, "creation_date": 1485342999, "post_id": 41850007, "comment_id": 70884263, "body": "what&#39;s the line erroring out? what&#39;s the value of <code>mywbk.Name</code> right before erroring out?"}, {"owner": {"reputation": 435, "user_id": 4994393, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/W8OxP.jpg?s=128&g=1", "display_name": "jacek_wi", "link": "https://stackoverflow.com/users/4994393/jacek-wi"}, "edited": false, "score": 0, "creation_date": 1485343585, "post_id": 41850007, "comment_id": 70884669, "body": "edited to answer both comments"}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1485343659, "post_id": 41850007, "comment_id": 70884710, "body": "have you got any <code>On Error resume Next</code> or <code>ON Error GoTo someLabel</code> statement ruling before that piece of code?"}, {"owner": {"reputation": 435, "user_id": 4994393, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/W8OxP.jpg?s=128&g=1", "display_name": "jacek_wi", "link": "https://stackoverflow.com/users/4994393/jacek-wi"}, "edited": false, "score": 0, "creation_date": 1485344082, "post_id": 41850007, "comment_id": 70884979, "body": "no, I have no error handling at all in this code"}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1485344275, "post_id": 41850007, "comment_id": 70885114, "body": "and <i>&quot;the value when the error happens is&quot;</i>...?"}, {"owner": {"reputation": 435, "user_id": 4994393, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/W8OxP.jpg?s=128&g=1", "display_name": "jacek_wi", "link": "https://stackoverflow.com/users/4994393/jacek-wi"}, "edited": false, "score": 0, "creation_date": 1485345163, "post_id": 41850007, "comment_id": 70885654, "body": "corrected, thanks, SO interpreted the value as some code"}, {"owner": {"reputation": 2709, "user_id": 4579015, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/56bbb7da70756a6470a57e2ee5ca341f?s=128&d=identicon&r=PG&f=1", "display_name": "LocEngineer", "link": "https://stackoverflow.com/users/4579015/locengineer"}, "edited": false, "score": 0, "creation_date": 1485345306, "post_id": 41850007, "comment_id": 70885740, "body": "The error might as well be with <code>mypath</code>. Put a break point there and single step through it to check whether the error actually occurs at <code>ThisWorkbook.Worksheets(&quot;List&quot;).Range(&quot;B&quot; &amp; row).Value</code>"}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1485347566, "post_id": 41850007, "comment_id": 70887111, "body": "I was asking for <code>mywbk.Name</code> right before erroring out"}], "owner": {"reputation": 435, "user_id": 4994393, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/W8OxP.jpg?s=128&g=1", "display_name": "jacek_wi", "link": "https://stackoverflow.com/users/4994393/jacek-wi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 161, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1485345321, "creation_date": 1485342462, "last_edit_date": 1485345321, "question_id": 41850007, "link": "https://stackoverflow.com/questions/41850007/excel-automation-error-on-half-of-code-executions", "title": "Excel Automation Error on half of code executions", "body": "<p>I have a macro that goes through a list where each line tells it to do something to a specified file. To cut down on number of Save-Close-Open operations, my list is sorted by file path (each file typically appears in several lines and every line works on a different worksheet in that file). The below code handles file manipulation.</p>\n\n<pre><code>mypath = ThisWorkbook.Worksheets(\"List\").Range(\"B\" &amp; row).Value\n\nIf mywbk Is Nothing Then\n    Set mywbk = Workbooks.Open(mypath)\nElse\n    If mywbk.FullName = mypath Then\n        'do nothing\n    Else\n        mywbk.Save\n        mywbk.Close\n        Set mywbk = Workbooks.Open(mypath)\n    End If\nEnd If\n</code></pre>\n\n<p><code>mywbk</code> is <code>Workbook</code>, <code>mypath</code> is <code>String</code>. What I expect the code to do is to check if anything is stored currently in mywbk, if nothing, set it to file I currently want to work on, if something already is there, I want to check if I still want to work on this file (and then nothing needs to happen), or if I have to change the file (so I save and close the previous one and open the new one).</p>\n\n<p>The problem I have is run-time error <code>'-2147221080 (800401a8)'</code> which happens right on the first time I go through this part of code, but only every second run of the macro - if I click <code>End</code> on error screen and run once more, everything works as expected. Then on next run I get the error again and so on. What is the reason for this behaviour and is there any way to fix it?</p>\n\n<p>Edit - clarifications after comments:</p>\n\n<p><code>mywbk</code> is Private variable </p>\n\n<p>The error happens on <code>If mywbk.FullName = mypath Then</code>, the value when the error happens is <code>&lt;Automation error&gt;</code></p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 26602, "user_id": 761095, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/6qOuP.png?s=128&g=1", "display_name": "bahrep", "link": "https://stackoverflow.com/users/761095/bahrep"}, "edited": false, "score": 0, "creation_date": 1485341925, "post_id": 41849657, "comment_id": 70883570, "body": "This post appears to be <a href=\"http://stackoverflow.com/help/on-topic\">off-topic</a> as per <i>Questions that lack sufficient information to diagnose the problem.</i> Please edit your post accordingly to add sufficient detail so that people may help you."}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1485342038, "post_id": 41849657, "comment_id": 70883658, "body": "Do you want to find the Sum for Column E  (looking for last row using <code>I = .Range(&quot;E2&quot;).End(xlDown).Row</code>) or Column B (<code>cumul = cumul + Cells(E, 2)</code>) ?"}, {"owner": {"reputation": 23, "user_id": 6235729, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-NpYpmR9O5BI/AAAAAAAAAAI/AAAAAAAAASI/k6n4zX2FYYo/photo.jpg?sz=128", "display_name": "Houyam", "link": "https://stackoverflow.com/users/6235729/houyam"}, "edited": false, "score": 0, "creation_date": 1485342322, "post_id": 41849657, "comment_id": 70883834, "body": "hey,My tab like that Name tab E1: production,E2 :56, E3: 67, E4: 67 etc... and i want the sum for all this columns"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1485342794, "post_id": 41849657, "comment_id": 70884142, "body": "So you want to sum all values in Column E (until last row with data) ? and put the Sum in the first avaialble row in Column E ?"}, {"owner": {"reputation": 23, "user_id": 6235729, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-NpYpmR9O5BI/AAAAAAAAAAI/AAAAAAAAASI/k6n4zX2FYYo/photo.jpg?sz=128", "display_name": "Houyam", "link": "https://stackoverflow.com/users/6235729/houyam"}, "edited": false, "score": 0, "creation_date": 1485342946, "post_id": 41849657, "comment_id": 70884230, "body": "I sum the row E and put the sum in another cell for example in b"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1485347112, "post_id": 41849657, "comment_id": 70886852, "body": "@Houyam have you tested the code and my answer below ? did it work for you ?"}], "answers": [{"tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": true, "score": 0, "last_activity_date": 1485343189, "creation_date": 1485343189, "answer_id": 41850283, "question_id": 41849657, "link": "https://stackoverflow.com/questions/41849657/the-sum-of-a-column-using-macro-excel-2010-vba/41850283#41850283", "title": "The sum of a column using macro Excel 2010 vba", "body": "<p>If I understood you correctly, the code below will SUM all the values in Column E (starting from Cell E2), and will put the result in Cell B2. (you can modify the location easily)</p>\n\n<p><strong>Note</strong>: I've added \"Option 2\", instead of using a <code>For</code> loop, you can use the <code>WorksheetFunction.Sum</code> to sum all the values inside a Range without needing to iterate.</p>\n\n<p><strong>Code</strong></p>\n\n<pre><code>Option Explicit\n\nSub SumColE()\n\nDim cumul As Long, I As Long, E As Long\n\nWith Worksheets(\"Sheet1\") ' &lt;-- modify \"Sheet1\" to your sheet's name\n    I = .Range(\"E2\").End(xlDown).Row '&lt;-- get last row in Column E        \n    cumul = 0\n\n    ' option 1: using a loop\n    For E = 2 To I\n        cumul = cumul + .Range(\"E\" &amp; E) '&lt;-- Sum up values in Column E\n    Next E\n    .Range(\"B2\").Value = cumul '&lt;-- put the result in B2\n\n    ' option 2: using WorksheetFunction SUM\n    .Range(\"B2\").Value = Application.WorksheetFunction.Sum(.Range(\"E2:E\" &amp; I))        \nEnd With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 6235729, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-NpYpmR9O5BI/AAAAAAAAAAI/AAAAAAAAASI/k6n4zX2FYYo/photo.jpg?sz=128", "display_name": "Houyam", "link": "https://stackoverflow.com/users/6235729/houyam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3042, "favorite_count": 0, "accepted_answer_id": 41850283, "answer_count": 1, "score": 0, "last_activity_date": 1485498737, "creation_date": 1485341462, "last_edit_date": 1531164843, "question_id": 41849657, "link": "https://stackoverflow.com/questions/41849657/the-sum-of-a-column-using-macro-excel-2010-vba", "title": "The sum of a column using macro Excel 2010 vba", "body": "<p>I use this macro for calculating the sum but it doesn't work. This is what I tried so far:</p>\n\n<pre><code>Sub sum()\n\nI = .Range(\"E2\").End(xlDown).Row\n\ncumul = 0\nFor E = 2 To I\n cumul = cumul + Cells(E, 2)\nNext\nRange(\"E7\") = cumul\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1485342251, "post_id": 41849608, "comment_id": 70883799, "body": "Close each of your <code>For</code> with <code>Next</code> (you have 2 <code>For</code> loops), and also close your <code>If</code> with <code>End If</code>."}, {"owner": {"reputation": 5173, "user_id": 1981088, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1Iicg.png?s=128&g=1", "display_name": "help-info.de", "link": "https://stackoverflow.com/users/1981088/help-info-de"}, "edited": false, "score": 0, "creation_date": 1485683908, "post_id": 41849608, "comment_id": 71020238, "body": "Improved formatting and deleted useless text."}], "answers": [{"tags": [], "owner": {"reputation": 530, "user_id": 5902659, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c6ed01eb79ca1012c98545e01aaca144?s=128&d=identicon&r=PG&f=1", "display_name": "user1", "link": "https://stackoverflow.com/users/5902659/user1"}, "is_accepted": false, "score": 0, "last_activity_date": 1485342448, "creation_date": 1485342448, "answer_id": 41850001, "question_id": 41849608, "link": "https://stackoverflow.com/questions/41849608/copy-paste-data-using-unique-identifier/41850001#41850001", "title": "Copy Paste data using unique identifier", "body": "<p>Seeing as i do not have any dummy data to reproduce its actually kind of tough. But try the below with your data and let me know what happens</p>\n\n<pre><code>Option Explicit\nSub link_data()\nDim i, lastrow\nDim i2, lastrow2\nDim A\nDim D\n\nlastrow = Sheet1.Range(\"A\" &amp; Rows.Count).End(xlUp).Row\nlastrow2 = Sheet2.Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n\nFor i = 2 To lastrow\n    For i2 = 2 To lastrow2\n    Set D = Sheets(\"Sheet1\").Cells(i, \"AW\")\n    Set A = Sheets(\"Sheet2\").Cells(i2, \"AI\")\n        If Sheet1.Cells(D).Value = Sheet2.Cells(A) Then\n            Sheet2.Cells(i2, \"AI\").EntireRow.Copy Destination:=Sheet1.Cells(i, \"AX\")\n        End If\n    Next i2\nNext i\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": true, "score": 0, "last_activity_date": 1485347513, "creation_date": 1485347513, "answer_id": 41851755, "question_id": 41849608, "link": "https://stackoverflow.com/questions/41849608/copy-paste-data-using-unique-identifier/41851755#41851755", "title": "Copy Paste data using unique identifier", "body": "<p>maybe you're after this:</p>\n\n<pre><code>Sub link_data()\n    Dim i As Long, lastrow As Long, i2 As Long, lastrow2 As Long\n    Dim A As Range, D As Range\n\n    lastrow = Sheet1.Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n    lastrow2 = Sheet2.Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n    For i = 2 To lastrow\n        Set D = Sheet1.Cells(i, \"AW\")\n        For i2 = 2 To lastrow2\n            Set A = Sheet2.Cells(i2, \"AI\")\n            If D.Value = A.Value Then\n                Intersect(A.Parent.UsedRange, A.EntireRow).Copy Destination:=Sheet1.Cells(i, Columns.Count).End(xlToLeft).Offset(, 1)\n            End If\n        Next\n    Next\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 47, "user_id": 7343935, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6448aa576e89f8b57fda47af7d109e44?s=128&d=identicon&r=PG&f=1", "display_name": "Excel-lit", "link": "https://stackoverflow.com/users/7343935/excel-lit"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 50, "favorite_count": 0, "accepted_answer_id": 41851755, "answer_count": 2, "score": 0, "last_activity_date": 1485683908, "creation_date": 1485341352, "last_edit_date": 1485683908, "question_id": 41849608, "link": "https://stackoverflow.com/questions/41849608/copy-paste-data-using-unique-identifier", "title": "Copy Paste data using unique identifier", "body": "<p>I want to use following VBA code to link data from two sheets which are within same workbook. Each entry in both sheets have a unique identifier. I am hoping to use that identifier and copy whole row from sheet2 and past it on the right hand side of sheet1's last column. </p>\n\n<p>How to fix this code?</p>\n\n<pre><code>Sub link_data()\n    Dim i, lastrow\n    im i2, lastrow2\n\n    Dim A As Double\n    Dim D As Double\n    lastrow = Sheet1.Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n    lastrow2 = Sheet2.Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n    For i = 2 To lastrow\n    For i2 = 2 To lastrow2\n    Set D = Sheet1.Cells(i, \"AW\")\n    Set A = Sheet2.Cells(i2, \"AI\")\n    If Sheet1.Cells(D).Value = Sheet2.Cells(A) Then\n    Sheet2.Cells(A).EntireRow.Copy Destination:=Sheet1.Cells(i, \"AX\").end(xlRight).Offset(1)\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "loops", "colors"], "answers": [{"comments": [{"owner": {"reputation": 47, "user_id": 7446845, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5ce8a4ddb898389e59c53a329d38c630?s=128&d=identicon&r=PG&f=1", "display_name": "Hosey93", "link": "https://stackoverflow.com/users/7446845/hosey93"}, "edited": false, "score": 0, "creation_date": 1485340844, "post_id": 41849317, "comment_id": 70882875, "body": "Thanks for your answer, I&#39;m only new to VBA and it&#39;s been doing my head in, this works great."}, {"owner": {"reputation": 1362, "user_id": 5979902, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/OmvV7.jpg?s=128&g=1", "display_name": "Martin Dreher", "link": "https://stackoverflow.com/users/5979902/martin-dreher"}, "reply_to_user": {"reputation": 47, "user_id": 7446845, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5ce8a4ddb898389e59c53a329d38c630?s=128&d=identicon&r=PG&f=1", "display_name": "Hosey93", "link": "https://stackoverflow.com/users/7446845/hosey93"}, "edited": false, "score": 0, "creation_date": 1485344546, "post_id": 41849317, "comment_id": 70885268, "body": "Glad I could help. Be sure to mark the question as answered. Also consider if <code>objCell.Value &gt; 0</code> really does what you need, of if you need something like <code>IsEmpty</code>."}], "tags": [], "owner": {"reputation": 1362, "user_id": 5979902, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/OmvV7.jpg?s=128&g=1", "display_name": "Martin Dreher", "link": "https://stackoverflow.com/users/5979902/martin-dreher"}, "is_accepted": true, "score": 1, "last_activity_date": 1485341204, "last_edit_date": 1485341204, "creation_date": 1485340551, "answer_id": 41849317, "question_id": 41848937, "link": "https://stackoverflow.com/questions/41848937/vba-color-row-cells-if-they-are-unequal-to-blank/41849317#41849317", "title": "VBA Color row cells if they are unequal to blank", "body": "<p>When working with Excel-VBA, it's enourmously helpful to grasp the idea of <code>Objects</code> and <code>Collections</code> and how to loop them.</p>\n\n<p>The Watch-window is your best friend here, as is the <code>With</code> keyword when writing code.</p>\n\n<p>In your case:\na <code>Cell</code> is an object inside the <code>Worksheet.Cells</code>-collection (in your case, also an object inside the <code>ActiveSheet.Rows(1).Cells</code>-collection.</p>\n\n<p>This does what you want, based on the information you gave us (you didnt specify that you do NOT want to loop the whole row ;) )</p>\n\n<pre><code>Option Explicit\n\nSub ColorCells()\n    Dim objCell As Object\n    With ActiveSheet\n        With .Rows(1)\n            For Each objCell In .Cells\n                With objCell\n                    If .Value &gt; 0 Then .Interior.ColorIndex = 48\n                End With\n            Next objCell\n        End With\n    End With\nEnd Sub\n</code></pre>\n\n<p>This should give you an idea how Excel-<code>Objects</code> work. </p>\n\n<p>Obviously, we can write this shorter:</p>\n\n<pre><code>Sub ColorCells()\n    Dim objCell As Object\n    For Each objCell In ActiveSheet.Rows(1).Cells\n        If objCell.Value &gt; 0 Then objCell.Interior.ColorIndex = 48\n    Next objCell\nEnd Sub\n</code></pre>\n\n<p><strong>Note:</strong></p>\n\n<ul>\n<li><p>This code will loop all 16k <code>Cells</code> in your <code>Row</code>. Obviously, we could stop at your last used <code>Cell</code>. However, since this runs in under a second, i left that out on purpose to keep the code clean</p></li>\n<li><p>While you could do this with conditional formatting, i support the idea of doing this with code ONCE, with no traces (that is, your conditional formats), left.</p></li>\n<li><p>I understand what you tried to do with <code>.CountA</code> and <code>.EntireRow</code>, this doesnt work here.</p></li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 1358, "user_id": 4114591, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/aIySb.jpg?s=128&g=1", "display_name": "Michael Z.", "link": "https://stackoverflow.com/users/4114591/michael-z"}, "is_accepted": false, "score": 0, "last_activity_date": 1499665526, "creation_date": 1499665526, "answer_id": 45004507, "question_id": 41848937, "link": "https://stackoverflow.com/questions/41848937/vba-color-row-cells-if-they-are-unequal-to-blank/45004507#45004507", "title": "VBA Color row cells if they are unequal to blank", "body": "<p>You could also do something like this with a formula. You could modify the function to handle more logic and colors.</p>\n\n<p>This will color the row green if the expression is true. You specify the color as RGB.</p>\n\n<p><code>=ColorRowIF(A1=B1, 1, 181, 0)</code>  </p>\n\n<p>Or in your case</p>\n\n<p><code>=ColorRowIF(ISBLANK(B2), 1, 181, 0)</code></p>\n\n<pre><code>Public Function ColorRowIF(Condition As Boolean, r As Integer, g As Integer, b As Integer) As String\n    Dim row As Integer\n    row = Application.Caller.row\n\n    If Condition = True Then\n        ActiveSheet.Evaluate \"ColorRow(\" &amp; row &amp; \", \" &amp; r &amp; \", \" &amp; g &amp; \", \" &amp; b &amp; \")\"\n    Else\n        'ws.Rows(r).Interior.Color = vbRed\n    End If\n\n    ColorRowIF = Condition\nEnd Function\n\n\nPublic Sub ColorRow(row As Integer, r As Integer, g As Integer, b As Integer)\n\n    Dim ws As Worksheet\n    Set ws = ActiveSheet\n    ws.Rows(row).Interior.Color = RGB(r, g, b)\n\nEnd Sub\n\n\nFunction IsDate(CellDate As Date) As Boolean\n    If CellDate &gt;= 1 And CellDate &lt;= #12/31/2199# Then\n    ' 1 is equal to January 1, 1900\n        IsDate = True\n    Else\n        IsDate = False\n        End If\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 47, "user_id": 7446845, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5ce8a4ddb898389e59c53a329d38c630?s=128&d=identicon&r=PG&f=1", "display_name": "Hosey93", "link": "https://stackoverflow.com/users/7446845/hosey93"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 702, "favorite_count": 0, "accepted_answer_id": 41849317, "answer_count": 2, "score": 0, "last_activity_date": 1499665526, "creation_date": 1485339509, "question_id": 41848937, "link": "https://stackoverflow.com/questions/41848937/vba-color-row-cells-if-they-are-unequal-to-blank", "title": "VBA Color row cells if they are unequal to blank", "body": "<p>I'm using the code shown below to essentially make the first row of the spreadsheet color grey based on if the cell is empty or not. For example Cell A1 is not blank so color it grey, cell B1 is not blank so color it Grey but cell C1 is blank so don't color it at all. So far my script colors the whole row grey based on A1. Is there an alternative for this?</p>\n\n<pre><code>Sub test()\nDim c As Integer\nc = Application.WorksheetFunction.CountA(ActiveSheet.Range(\"A1\"))\nIf c &gt; 0 Then\n    ActiveSheet.Range(\"A1\").EntireRow.Interior.ColorIndex = 48\nEnd If\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "edited": false, "score": 0, "creation_date": 1485339859, "post_id": 41848916, "comment_id": 70882135, "body": "You might want to clarify your question. Do you mean you want the 50th, 70th, 120th etc. column? Or columns that contain 50, 70, 120 etc? Also, do you want to select them or do something with them? Do you have any VBA you&#39;ve attempted so far?"}, {"owner": {"reputation": 41, "user_id": 5034565, "user_type": "registered", "profile_image": "https://graph.facebook.com/447268908778592/picture?type=large", "display_name": "Data Miner", "link": "https://stackoverflow.com/users/5034565/data-miner"}, "reply_to_user": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "edited": false, "score": 0, "creation_date": 1485343090, "post_id": 41848916, "comment_id": 70884327, "body": "thanks@CLR . yes i mean the 50th, 70th, 120th. I neede just to select them. for the VBA I was used this macro                                            Sub Macro() Range(&quot;a1,b1,d1,e1,g1,h1&quot;).EntireColumn.Select           End Sub                                                                                                          but this only valid if the headers of the columns are letters."}], "answers": [{"comments": [{"owner": {"reputation": 41, "user_id": 5034565, "user_type": "registered", "profile_image": "https://graph.facebook.com/447268908778592/picture?type=large", "display_name": "Data Miner", "link": "https://stackoverflow.com/users/5034565/data-miner"}, "edited": false, "score": 0, "creation_date": 1485347557, "post_id": 41849309, "comment_id": 70887103, "body": "thanks @Wujaszkun. This quite good if i want to select small number of columns but if i want to select let&#39;s 50 columns, the code will be quite long."}, {"owner": {"reputation": 343, "user_id": 4898713, "user_type": "registered", "profile_image": "https://graph.facebook.com/1189342967759685/picture?type=large", "display_name": "Wujaszkun", "link": "https://stackoverflow.com/users/4898713/wujaszkun"}, "reply_to_user": {"reputation": 41, "user_id": 5034565, "user_type": "registered", "profile_image": "https://graph.facebook.com/447268908778592/picture?type=large", "display_name": "Data Miner", "link": "https://stackoverflow.com/users/5034565/data-miner"}, "edited": false, "score": 0, "creation_date": 1485348261, "post_id": 41849309, "comment_id": 70887509, "body": "@Data Miner - It was just a sample code, in a final version you&#39;ll probably want to make it more flexible and use some kind of loop to add the columns to the <code>Union</code>, like CLR did in his answer."}], "tags": [], "owner": {"reputation": 343, "user_id": 4898713, "user_type": "registered", "profile_image": "https://graph.facebook.com/1189342967759685/picture?type=large", "display_name": "Wujaszkun", "link": "https://stackoverflow.com/users/4898713/wujaszkun"}, "is_accepted": false, "score": 0, "last_activity_date": 1485340512, "creation_date": 1485340512, "answer_id": 41849309, "question_id": 41848916, "link": "https://stackoverflow.com/questions/41848916/is-there-a-way-by-which-i-can-select-particular-columns-from-an-excel-sheet-base/41849309#41849309", "title": "Is there a way by which I can select particular columns from an excel sheet based on the column number?", "body": "<p>You could use <code>union</code> to select multiple columns. I have created a short macro just to give you an idea how it works. </p>\n\n<pre><code>Sub select_columns()\n\nDim myColumns, myColumn(1 To 5) As Range\n\nSet myColumn(1) = Columns(1).EntireColumn\nSet myColumn(2) = Columns(3).EntireColumn\nSet myColumn(3) = Columns(5).EntireColumn\nSet myColumn(4) = Columns(7).EntireColumn\nSet myColumn(5) = Columns(9).EntireColumn\n\nSet myColumns = Union(myColumn(1), myColumn(2), myColumn(3), myColumn(4), myColumn(5))\n\nmyColumns.Select\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "is_accepted": false, "score": 1, "last_activity_date": 1485346735, "last_edit_date": 1485346735, "creation_date": 1485345302, "answer_id": 41851001, "question_id": 41848916, "link": "https://stackoverflow.com/questions/41848916/is-there-a-way-by-which-i-can-select-particular-columns-from-an-excel-sheet-base/41851001#41851001", "title": "Is there a way by which I can select particular columns from an excel sheet based on the column number?", "body": "<p>Taking @Wujaskun's answer and building upon it - you could do the following which would allow you to specify the column numbers in just one line and remove the need for repetitive coding:</p>\n\n<pre><code>Sub select_columns()\n\nDim myColumns As Range\n\nmyColumnNumbers = Array(1, 5, 9, 13, 17) '.. and on and on..\n\nReDim myColumn(UBound(myColumnNumbers)) As Range\n\nFor Each c In myColumnNumbers\n\n    If myColumns Is Nothing Then\n        Set myColumns = Columns(c).EntireColumn\n    Else\n        Set myColumns = Union(myColumns, Columns(c).EntireColumn)\n    End If\n\nNext\n\nmyColumns.Select\n\nSet myColumns = Nothing\n\nEnd Sub\n</code></pre>\n\n<p>One slight warning, don't repeat column numbers (or the first one at least) as this will cause the Union to reset. </p>\n\n<p><strong>EDIT</strong> - I've now improved the code to allow (or at least not cause issue) if the first column number is repeated. </p>\n"}], "owner": {"reputation": 41, "user_id": 5034565, "user_type": "registered", "profile_image": "https://graph.facebook.com/447268908778592/picture?type=large", "display_name": "Data Miner", "link": "https://stackoverflow.com/users/5034565/data-miner"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1485346735, "creation_date": 1485339465, "last_edit_date": 1531164843, "question_id": 41848916, "link": "https://stackoverflow.com/questions/41848916/is-there-a-way-by-which-i-can-select-particular-columns-from-an-excel-sheet-base", "title": "Is there a way by which I can select particular columns from an excel sheet based on the column number?", "body": "<p>I have an excel sheet with thousands of  columns, and I want to select some of them, each has a column number, is there way by which I can select columns that meet the specific condition? e.g column with numbers 50, 70, 120, 154, 200. how to select them from an excel file with 2000 columns? is there any macros can do that?\nthanks </p>\n"}, {"tags": ["vba", "powerpoint", "powerpoint2016"], "comments": [{"owner": {"reputation": 71, "user_id": 4102017, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-sNieQ1MB2mA/AAAAAAAAAAI/AAAAAAAAABc/X6TlsLpT-7g/photo.jpg?sz=128", "display_name": "Edwin Ederle", "link": "https://stackoverflow.com/users/4102017/edwin-ederle"}, "edited": false, "score": 0, "creation_date": 1485340589, "post_id": 41848822, "comment_id": 70882684, "body": "BTW: the error occurs on the last line shp...left = 10"}], "answers": [{"comments": [{"owner": {"reputation": 71, "user_id": 4102017, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-sNieQ1MB2mA/AAAAAAAAAAI/AAAAAAAAABc/X6TlsLpT-7g/photo.jpg?sz=128", "display_name": "Edwin Ederle", "link": "https://stackoverflow.com/users/4102017/edwin-ederle"}, "edited": false, "score": 1, "creation_date": 1485357598, "post_id": 41853692, "comment_id": 70894079, "body": "The weird thing. It worked on PPT 2013 and it is not read-only, I can change the visible property as well as changing the text shpBubble.TextFrame.TextRange.Text = &quot;X&quot; Only changing the position (top, left, ..) gives me that error"}, {"owner": {"reputation": 2476, "user_id": 2674672, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/AvMmQ.jpg?s=128&g=1", "display_name": "Jamie Garroch - MVP", "link": "https://stackoverflow.com/users/2674672/jamie-garroch-mvp"}, "reply_to_user": {"reputation": 71, "user_id": 4102017, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-sNieQ1MB2mA/AAAAAAAAAAI/AAAAAAAAABc/X6TlsLpT-7g/photo.jpg?sz=128", "display_name": "Edwin Ederle", "link": "https://stackoverflow.com/users/4102017/edwin-ederle"}, "edited": false, "score": 0, "creation_date": 1485363746, "post_id": 41853692, "comment_id": 70898530, "body": "I updated my answer accordingly. Looks like a bug and I&#39;ve forwarded to a PowerPoint MVP expert in the VBA field to confirm."}, {"owner": {"reputation": 12482, "user_id": 1667023, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JXaUt.png?s=128&g=1", "display_name": "Steve Rindsberg", "link": "https://stackoverflow.com/users/1667023/steve-rindsberg"}, "reply_to_user": {"reputation": 71, "user_id": 4102017, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-sNieQ1MB2mA/AAAAAAAAAAI/AAAAAAAAABc/X6TlsLpT-7g/photo.jpg?sz=128", "display_name": "Edwin Ederle", "link": "https://stackoverflow.com/users/4102017/edwin-ederle"}, "edited": false, "score": 1, "creation_date": 1485370097, "post_id": 41853692, "comment_id": 70902454, "body": "I&#39;ve verified that the problem appears in several releases of PPT 2016 but not in my copy of 2013.  I&#39;ve forwarded a simplified description of the problem to several acquaintances on the PPT team at MS.  I don&#39;t think that there&#39;s any question about it: you&#39;ve unearthed a bug, @EdwinEderle"}, {"owner": {"reputation": 71, "user_id": 4102017, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-sNieQ1MB2mA/AAAAAAAAAAI/AAAAAAAAABc/X6TlsLpT-7g/photo.jpg?sz=128", "display_name": "Edwin Ederle", "link": "https://stackoverflow.com/users/4102017/edwin-ederle"}, "edited": false, "score": 0, "creation_date": 1485374881, "post_id": 41853692, "comment_id": 70905134, "body": "A silly question: Can I hope that the PPT team at MS might give a workaround on short notice?"}, {"owner": {"reputation": 12482, "user_id": 1667023, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JXaUt.png?s=128&g=1", "display_name": "Steve Rindsberg", "link": "https://stackoverflow.com/users/1667023/steve-rindsberg"}, "edited": false, "score": 0, "creation_date": 1485448842, "post_id": 41853692, "comment_id": 70939026, "body": "We may all <i>hope</i> whatever we choose to. ;-)  Whether MS acts on our hopes and dreams ... another story.  As I understand it, though, they do give higher priority to regression bugs like this. Fixes get released to O365 (ie subscription) users fairly quickly.  It may take longer before non-subscription versions get the fix."}], "tags": [], "owner": {"reputation": 2476, "user_id": 2674672, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/AvMmQ.jpg?s=128&g=1", "display_name": "Jamie Garroch - MVP", "link": "https://stackoverflow.com/users/2674672/jamie-garroch-mvp"}, "is_accepted": false, "score": 2, "last_activity_date": 1485363648, "last_edit_date": 1485363648, "creation_date": 1485353221, "answer_id": 41853692, "question_id": 41848822, "link": "https://stackoverflow.com/questions/41848822/code-stopped-working-in-powerpoint-2016/41853692#41853692", "title": "Code stopped working in Powerpoint 2016", "body": "<p><strong><em>UPDATE</em></strong></p>\n\n<p>Having tested in PowerPoint 2010 and 2013, where it works, this now looks like a bug in 2016!</p>\n\n<p><strong>* END *</strong></p>\n\n<p>I managed to recreate the error in PowerPoint 2016 (PC) by manually adding a shape to a test chart (select the chart then click <strong>Format</strong> / <strong>Insert Shapes</strong>) and trying to write to several of it's properties including position and formatting such as changing fill colour. All generate an error.</p>\n\n<p>Maybe one workaround is to use the .Delete method to delete the desired shape and then add a new shape at the required size and position. Something like this:</p>\n\n<pre><code>Sub test11()\n  Dim sld As Slide\n  Dim objChart As Chart 'Object\n  Dim shpBubble As Shape 'Object\n  Set sld = ActivePresentation.Slides(\"ScatterPlot01_Purch6\")\n  Set objChart = sld.Shapes(\"Chart01\").Chart\n  sld.Select\n  objChart.Select ' this won't work as you can only select the parent shape sld.Shapes(\"Chart01\")\n\n  With objChart\n    .Shapes(\"P01\").Delete\n    .Shapes.AddShape msoShapeOval, 10, 10, 20, 20\n  End With\nEnd Sub\n</code></pre>\n\n<p>The challenge is that because the new shape is added as read only, the formatting can't be set!</p>\n"}], "owner": {"reputation": 71, "user_id": 4102017, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-sNieQ1MB2mA/AAAAAAAAAAI/AAAAAAAAABc/X6TlsLpT-7g/photo.jpg?sz=128", "display_name": "Edwin Ederle", "link": "https://stackoverflow.com/users/4102017/edwin-ederle"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 185, "favorite_count": 1, "answer_count": 1, "score": 3, "last_activity_date": 1593773533, "creation_date": 1485339212, "last_edit_date": 1593773533, "question_id": 41848822, "link": "https://stackoverflow.com/questions/41848822/code-stopped-working-in-powerpoint-2016", "title": "Code stopped working in Powerpoint 2016", "body": "<p>Code that perfectly works in earlier versions of PPT stopped working in 2016.\nWhen I try to change the left property of a shape in a chart, I get a <code>Method left of object shape failed</code> error.\nI can perfectly read the <code>.Left</code> property.</p>\n\n<p>I am running out of ideas? What can I do?</p>\n\n<pre><code>Sub test11()\n  Dim sld As Slide\n  Dim objChart As Object\n  Dim shpBubble As Object\n  Set sld = ActivePresentation.Slides(\"ScatterPlot01_Purch6\")\n  Set objChart = sld.Shapes(\"Chart01\").Chart\n  sld.Select\n  objChart.Select\n\n  Set shpBubble = objChart.Shapes(\"P01\")\n  'shpBubble.Select\n\n  Debug.Print shpBubble.Left, shpBubble.Visible\n  shpBubble.Left = 10\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "web-scraping"], "comments": [{"owner": {"reputation": 1341, "user_id": 6512922, "user_type": "registered", "accept_rate": 87, "profile_image": "https://graph.facebook.com/1131570370198708/picture?type=large", "display_name": "Jeremy", "link": "https://stackoverflow.com/users/6512922/jeremy"}, "edited": false, "score": 0, "creation_date": 1485338272, "post_id": 41848354, "comment_id": 70881045, "body": "Why am I getting done voted?"}, {"owner": {"reputation": 1341, "user_id": 6512922, "user_type": "registered", "accept_rate": 87, "profile_image": "https://graph.facebook.com/1131570370198708/picture?type=large", "display_name": "Jeremy", "link": "https://stackoverflow.com/users/6512922/jeremy"}, "reply_to_user": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 0, "creation_date": 1485338594, "post_id": 41848354, "comment_id": 70881272, "body": "@R3uK Thanks for the edit - I couldn&#39;t format it to code for some reason"}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 0, "creation_date": 1485338855, "post_id": 41848354, "comment_id": 70881470, "body": "You&#39;ll need a line of normal text between lists and code! ;) Apparently you were down voted because your question is too broad, you may need to prioritize! ;) And ask other question later or elsewhere (ie, 3. isn&#39;t very clear and could be ask on SuperUser)"}, {"owner": {"reputation": 1341, "user_id": 6512922, "user_type": "registered", "accept_rate": 87, "profile_image": "https://graph.facebook.com/1131570370198708/picture?type=large", "display_name": "Jeremy", "link": "https://stackoverflow.com/users/6512922/jeremy"}, "reply_to_user": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 1, "creation_date": 1485339658, "post_id": 41848354, "comment_id": 70881995, "body": "Thanks @R3uK - I&#39;ll remove 3 and will just learn when I attempt to scrape!"}], "answers": [{"comments": [{"owner": {"reputation": 1341, "user_id": 6512922, "user_type": "registered", "accept_rate": 87, "profile_image": "https://graph.facebook.com/1131570370198708/picture?type=large", "display_name": "Jeremy", "link": "https://stackoverflow.com/users/6512922/jeremy"}, "edited": false, "score": 0, "creation_date": 1485634919, "post_id": 41902620, "comment_id": 71010175, "body": "You are both a Gentleman (or lady - can&#39;t tell!) and a scholar -Thank you for this! I work in financial services so aware of brokers fees etc. -The above was just an example site :)"}], "tags": [], "owner": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "is_accepted": true, "score": 4, "last_activity_date": 1485549453, "creation_date": 1485549453, "answer_id": 41902620, "question_id": 41848354, "link": "https://stackoverflow.com/questions/41848354/website-data-table-scraper/41902620#41902620", "title": "Website data table scraper", "body": "<p>If you want to use Excel functions to navigate the tables why not dump the tables first onto a worksheet this code works for me </p>\n\n<pre><code>Option Explicit\n\nSub Scraper()\n    Dim appIE As Object\n\n    ' As per http://stackoverflow.com/questions/27066963/scraping-data-from-website-using-vba\n\n    Set appIE = CreateObject(\"internetexplorer.application\")\n\n    With appIE\n       .Navigate \"http://uk.investing.com/rates-bonds/financial-futures\" 'Sample page\n       .Visible = True\n    End With\n\n    Do While appIE.Busy\n        DoEvents\n        Application.Wait (Now + TimeValue(\"0:00:01\")) 'If page not open, wait a second befor trying again\n    Loop\n\n    'Debug.Print TypeName(appIE.document)\n\n    Dim doc As Object 'MSHTML.HTMLDocument\n    Set doc = appIE.document\n\n    '* appIE busy is good but you need to wait for the whole document to completely load and initialise so use this\n    While doc.readyState &lt;&gt; \"complete\"\n        DoEvents\n    Wend\n\n    '* we can select all the tables because they share the same CSS class name\n    Dim tablesSelectedByClass As Object 'MSHTML.HTMLElementCollection\n    Set tablesSelectedByClass = doc.getElementsByClassName(\"genTbl\")\n\n    '* you can change this, it was just convenient for me to add sheets to my workbook\n    Dim shNewResults As Excel.Worksheet\n    Set shNewResults = ThisWorkbook.Worksheets.Add\n\n    Dim lRowCursor As Long  '* this controls pasting down the sheet\n    lRowCursor = 1\n\n    Dim lTableIndexLoop As Long\n    For lTableIndexLoop = 0 To tablesSelectedByClass.Length - 1\n\n        Dim tableLoop As Object 'MSHTML.HTMLTable\n        Set tableLoop = tablesSelectedByClass.Item(lTableIndexLoop)\n\n        If LenB(tableLoop.ID) &gt; 0 Then  '* there are some extra nonsense tables, this subselects\n\n            Dim sParentColumn As String, objParentColumn As Object ' MSHTML.HTMLSemanticElement\n            Set objParentColumn = FindMyColumn(tableLoop, sParentColumn) '* need to understand is table on left hand or right hand side\n\n            Dim vHeader As Variant: vHeader = Empty\n            If sParentColumn = \"leftColumn\" Then\n                '* tables on the left have a preceding H3 element with the table's description\n                Dim objH3Headers As Object\n                Set objH3Headers = objParentColumn.getElementsByTagName(\"H3\")\n                vHeader = objH3Headers.Item(lTableIndexLoop).innerText\n            Else\n                '* tables on the right have a hidden attribute we can use\n                vHeader = tableLoop.Attributes.Item(\"data-gae\").Value\n                If Len(vHeader) &gt; 3 Then\n                    vHeader = Mid$(vHeader, 4)\n                    Mid$(vHeader, 1, 1) = Chr(Asc(Mid$(vHeader, 1, 1)) - 32)\n                End If\n            End If\n\n            '* tables on the right do not have column headers\n            Dim bHasColumnHeaders As Boolean\n            bHasColumnHeaders = (tableLoop.ChildNodes.Length = 2)\n\n            Dim vTableCells() As Variant   '* this will be our table data container which we will paste in one go\n            Dim lRowCount As Long: lRowCount = 0\n            Dim lColumnCount As Long: lColumnCount = 0\n            Dim lDataHeadersSectionIdx As Long: lDataHeadersSectionIdx = 0\n            Dim objColumnHeaders As Object: Set objColumnHeaders = Nothing\n\n            If bHasColumnHeaders Then\n\n                Set objColumnHeaders = tableLoop.ChildNodes.Item(0).ChildNodes.Item(0)\n\n                lRowCount = lRowCount + 1\n\n                lDataHeadersSectionIdx = 1\n            Else\n                lDataHeadersSectionIdx = 0\n            End If\n\n            Dim objDataRows As Object 'MSHTML.HTMLElementCollection\n            Set objDataRows = tableLoop.ChildNodes.Item(lDataHeadersSectionIdx).ChildNodes\n            lColumnCount = objDataRows.Item(0).ChildNodes.Length\n\n            lRowCount = lRowCount + objDataRows.Length\n\n            ReDim vTableCells(1 To lRowCount, 1 To lColumnCount) As Variant\n\n            '* we have them get the column headers\n            Dim lColLoop As Long\n            If bHasColumnHeaders Then\n                For lColLoop = 1 To lColumnCount\n                    vTableCells(1, lColLoop) = objColumnHeaders.ChildNodes.Item(lColLoop - 1).innerText\n                Next\n            End If\n\n            '* get the data cells\n            Dim lRowLoop As Long\n            For lRowLoop = 1 To lRowCount - VBA.IIf(bHasColumnHeaders, 1, 0)\n                For lColLoop = 1 To lColumnCount\n                    vTableCells(lRowLoop + VBA.IIf(bHasColumnHeaders, 1, 0), lColLoop) = objDataRows.Item(lRowLoop - 1).ChildNodes.Item(lColLoop - 1).innerText\n                Next\n            Next\n\n            '* paste our table description\n            shNewResults.Cells(lRowCursor, 1).Value2 = vHeader\n            lRowCursor = lRowCursor + 1\n\n            '* paste our table data\n            shNewResults.Cells(lRowCursor, 1).Resize(lRowCount, lColumnCount).Value2 = vTableCells\n            lRowCursor = lRowCursor + lRowCount + 1\n        End If\n\n    Next\n\nEnd Sub\n\nFunction FindMyColumn(ByVal node As Object, ByRef psColumn As String) As Object\n    '* this code ascends the DOM looking for \"column\" in the id of each node\n    While InStr(1, node.ID, \"column\", vbTextCompare) = 0 And Not node.ParentNode Is Nothing\n        DoEvents\n        Set node = node.ParentNode\n    Wend\n    If InStr(1, node.ID, \"column\", vbTextCompare) &gt; 0 Then\n        Set FindMyColumn = node\n        psColumn = CStr(node.ID)\n    End If\n\n\nEnd Function\n</code></pre>\n\n<p>By the way, if you trade a lot the brokers get rich and you get poor, brokerage charges really impact in long run.</p>\n"}], "owner": {"reputation": 1341, "user_id": 6512922, "user_type": "registered", "accept_rate": 87, "profile_image": "https://graph.facebook.com/1131570370198708/picture?type=large", "display_name": "Jeremy", "link": "https://stackoverflow.com/users/6512922/jeremy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4018, "favorite_count": 5, "accepted_answer_id": 41902620, "answer_count": 1, "score": 0, "last_activity_date": 1490418456, "creation_date": 1485337950, "last_edit_date": 1495542326, "question_id": 41848354, "link": "https://stackoverflow.com/questions/41848354/website-data-table-scraper", "title": "Website data table scraper", "body": "<p>Before I ask my question, I'm an amateur coder with basically no meaningful experience beyond VBA in ms office apps (I know - noob!)</p>\n\n<p>I'm trying to create a web scraper using VBA to import data into excel and as per my comments in the below extract of code, the best I've been able to find on this is was in the winning answer to <a href=\"https://stackoverflow.com/questions/27066963/scraping-data-from-website-using-vba\">this question</a>.</p>\n\n<p>Below, I'm using investing.com as an example but in reality my project will be across multiple sites and will feed into a matrices which will be updating daily and self cannibalizing as events expire - For this reason I'd rather front-up the workload on the code side to make the inputs on an ongoing basis as minimal as possible (for me).</p>\n\n<p>With that in mind, can I ask if there's a way to do any of the following (brace yourself, this will be cringe-worthy basic knowledge for some):</p>\n\n<ol>\n<li><p>Is there a way in which I can and navigate to a url and run a <code>for each</code> loop on every table on that page (without have a known id for any)? this is to speed up my code as much as it's to minimise my inputs as there'll be quite a bit of data to be updated and I was planning on putting a 2 minute looping trigger on the refresh.</p></li>\n<li><p>Instead of doing what I've been doing below, is it possible to reference a table, rather than a row, and do something along the lines of Cells(2,5).value to return the value within row 1, column 4? (assuming that both the array indexing starts at 0 in both dimensions?) Further to that, my first column (my primary key in some ways) may not be in the same order on all sources so is there a way in which I could do the equivalent to <code>Columns(\"A:A\").Find(What:=[Primary key], After:=Cells(1, 1), LookIn:=xlValues, LookAt:=xlWhole, SearchOrder:=xlByRows, SearchDirection:=xlNext, MatchCase:=True, SearchFormat:=False).Row</code> to find what row within the table relates to the even I'm looking for?</p></li>\n</ol>\n\n<p>Code :</p>\n\n<pre><code>Sub Scraper()\nDim appIE, allRowOfData As Object\n\n' As per https://stackoverflow.com/questions/27066963/scraping-data-from-website-using-vba\n\nSet appIE = CreateObject(\"internetexplorer.application\")\n\nWith appIE\n   .Navigate \"http://uk.investing.com/rates-bonds/financial-futures\" 'Sample page\n   .Visible = False\nEnd With\n\nDo While appIE.Busy\n    Application.Wait (Now + TimeValue(\"0:00:01\")) 'If page not open, wait a second befor trying again\nLoop\n\nSet allRowOfData = appIE.document.getElementById(\"pair_8907\") \n'tr id=\"[ID of row within table]\"\nDim myValue As String: myValue = allRowOfData.Cells(8).innerHTML \n'The 8 is the column number of the table \n'(note: column numbers start at 0 so the 9th column should have \"8\" entered here\n\nSet appIE = Nothing\n\nRange(\"A1\").Value = myValue\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 79, "user_id": 3700472, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/ec16235e5f436bc54923e3925e3df07f?s=128&d=identicon&r=PG&f=1", "display_name": "Uhujkill", "link": "https://stackoverflow.com/users/3700472/uhujkill"}, "edited": false, "score": 0, "creation_date": 1485340586, "post_id": 41848638, "comment_id": 70882683, "body": "Hi Aeneas, I have inputted your code, but it doesn&#39;t seem to work. I should add, that the column 8 has a drop down list, and is protected by a password. Is this maybe the reason it doesn&#39;t work? Thanks."}, {"owner": {"reputation": 245, "user_id": 6593650, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a67fbc8a0efa3c4df79f5e5514586f8?s=128&d=identicon&r=PG&f=1", "display_name": "Aeneas", "link": "https://stackoverflow.com/users/6593650/aeneas"}, "reply_to_user": {"reputation": 79, "user_id": 3700472, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/ec16235e5f436bc54923e3925e3df07f?s=128&d=identicon&r=PG&f=1", "display_name": "Uhujkill", "link": "https://stackoverflow.com/users/3700472/uhujkill"}, "edited": false, "score": 0, "creation_date": 1485340900, "post_id": 41848638, "comment_id": 70882917, "body": "You need to be more specific than just saying &quot;it doesn&#39;t work&quot;. What are the errors/issues?"}, {"owner": {"reputation": 79, "user_id": 3700472, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/ec16235e5f436bc54923e3925e3df07f?s=128&d=identicon&r=PG&f=1", "display_name": "Uhujkill", "link": "https://stackoverflow.com/users/3700472/uhujkill"}, "edited": false, "score": 0, "creation_date": 1485341863, "post_id": 41848638, "comment_id": 70883531, "body": "Apologies, after inputting your code, i can still input the same values into two rows, one above another. i.e. C1 = &quot;test&quot; H1 = &quot;Dirty&quot; and C2 = &quot;test&quot;, H2 = &quot;Dirty&quot;. Ideally, this code should prevent this from happening."}, {"owner": {"reputation": 245, "user_id": 6593650, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a67fbc8a0efa3c4df79f5e5514586f8?s=128&d=identicon&r=PG&f=1", "display_name": "Aeneas", "link": "https://stackoverflow.com/users/6593650/aeneas"}, "reply_to_user": {"reputation": 79, "user_id": 3700472, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/ec16235e5f436bc54923e3925e3df07f?s=128&d=identicon&r=PG&f=1", "display_name": "Uhujkill", "link": "https://stackoverflow.com/users/3700472/uhujkill"}, "edited": false, "score": 0, "creation_date": 1485343057, "post_id": 41848638, "comment_id": 70884305, "body": "The code excludes the first row as I assumed this would be column names. I&#39;ve updated now to include first row"}, {"owner": {"reputation": 79, "user_id": 3700472, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/ec16235e5f436bc54923e3925e3df07f?s=128&d=identicon&r=PG&f=1", "display_name": "Uhujkill", "link": "https://stackoverflow.com/users/3700472/uhujkill"}, "edited": false, "score": 0, "creation_date": 1485343830, "post_id": 41848638, "comment_id": 70884816, "body": "Apologies for this Aeneas, i may be making a silly mistake somewhere. I have uploaded the excel workbook to onedrive here - <a href=\"https://1drv.ms/x/s!Akn8Uf5lYAQ_xTXLeGWv9sD3CtYb\" rel=\"nofollow noreferrer\">1drv.ms/x/s!Akn8Uf5lYAQ_xTXLeGWv9sD3CtYb</a> . Thanks for your help again."}, {"owner": {"reputation": 245, "user_id": 6593650, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a67fbc8a0efa3c4df79f5e5514586f8?s=128&d=identicon&r=PG&f=1", "display_name": "Aeneas", "link": "https://stackoverflow.com/users/6593650/aeneas"}, "reply_to_user": {"reputation": 79, "user_id": 3700472, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/ec16235e5f436bc54923e3925e3df07f?s=128&d=identicon&r=PG&f=1", "display_name": "Uhujkill", "link": "https://stackoverflow.com/users/3700472/uhujkill"}, "edited": false, "score": 0, "creation_date": 1485344819, "post_id": 41848638, "comment_id": 70885447, "body": "Sorry I am unable to download documents where I am. Do you have macros enabled and did you add the code to the right sheet module?"}, {"owner": {"reputation": 79, "user_id": 3700472, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/ec16235e5f436bc54923e3925e3df07f?s=128&d=identicon&r=PG&f=1", "display_name": "Uhujkill", "link": "https://stackoverflow.com/users/3700472/uhujkill"}, "edited": false, "score": 0, "creation_date": 1485346690, "post_id": 41848638, "comment_id": 70886584, "body": "Hi Aeneas, yeah i have applied it to the correct module, and macros should be enabled."}, {"owner": {"reputation": 245, "user_id": 6593650, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a67fbc8a0efa3c4df79f5e5514586f8?s=128&d=identicon&r=PG&f=1", "display_name": "Aeneas", "link": "https://stackoverflow.com/users/6593650/aeneas"}, "reply_to_user": {"reputation": 79, "user_id": 3700472, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/ec16235e5f436bc54923e3925e3df07f?s=128&d=identicon&r=PG&f=1", "display_name": "Uhujkill", "link": "https://stackoverflow.com/users/3700472/uhujkill"}, "edited": false, "score": 0, "creation_date": 1485349631, "post_id": 41848638, "comment_id": 70888376, "body": "I would suggest putting a break point on the first line of code and see if it gets hit when you update a cell on the sheet. If it does step through the code to see what&#39;s going wrong."}, {"owner": {"reputation": 79, "user_id": 3700472, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/ec16235e5f436bc54923e3925e3df07f?s=128&d=identicon&r=PG&f=1", "display_name": "Uhujkill", "link": "https://stackoverflow.com/users/3700472/uhujkill"}, "edited": false, "score": 0, "creation_date": 1485421208, "post_id": 41848638, "comment_id": 70921820, "body": "Hi Aeneas, unfortunately i am still at a loss with this. I think it may be due to the fact that column H has a data validation list. The link above, is still active."}, {"owner": {"reputation": 245, "user_id": 6593650, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a67fbc8a0efa3c4df79f5e5514586f8?s=128&d=identicon&r=PG&f=1", "display_name": "Aeneas", "link": "https://stackoverflow.com/users/6593650/aeneas"}, "reply_to_user": {"reputation": 79, "user_id": 3700472, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/ec16235e5f436bc54923e3925e3df07f?s=128&d=identicon&r=PG&f=1", "display_name": "Uhujkill", "link": "https://stackoverflow.com/users/3700472/uhujkill"}, "edited": false, "score": 0, "creation_date": 1485425976, "post_id": 41848638, "comment_id": 70924388, "body": "Selecting a value from a drop down validation list should still trigger the WorkSheet_Change event. Can you attach a screen shot of your vba window with the code showing?"}, {"owner": {"reputation": 79, "user_id": 3700472, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/ec16235e5f436bc54923e3925e3df07f?s=128&d=identicon&r=PG&f=1", "display_name": "Uhujkill", "link": "https://stackoverflow.com/users/3700472/uhujkill"}, "edited": false, "score": 0, "creation_date": 1485431685, "post_id": 41848638, "comment_id": 70927343, "body": "You can find the screenshot here <a href=\"https://1drv.ms/i/s!Akn8Uf5lYAQ_xTa60voC1GRFGVx6\" rel=\"nofollow noreferrer\">1drv.ms/i/s!Akn8Uf5lYAQ_xTa60voC1GRFGVx6</a> Thanks Aeneas"}, {"owner": {"reputation": 245, "user_id": 6593650, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a67fbc8a0efa3c4df79f5e5514586f8?s=128&d=identicon&r=PG&f=1", "display_name": "Aeneas", "link": "https://stackoverflow.com/users/6593650/aeneas"}, "reply_to_user": {"reputation": 79, "user_id": 3700472, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/ec16235e5f436bc54923e3925e3df07f?s=128&d=identicon&r=PG&f=1", "display_name": "Uhujkill", "link": "https://stackoverflow.com/users/3700472/uhujkill"}, "edited": false, "score": 0, "creation_date": 1485436675, "post_id": 41848638, "comment_id": 70930149, "body": "I was hoping you would include the Project Properties window as I believe you have the code in a general module sheet rather than the Sheet object which has the events associated with the sheet"}, {"owner": {"reputation": 245, "user_id": 6593650, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a67fbc8a0efa3c4df79f5e5514586f8?s=128&d=identicon&r=PG&f=1", "display_name": "Aeneas", "link": "https://stackoverflow.com/users/6593650/aeneas"}, "reply_to_user": {"reputation": 79, "user_id": 3700472, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/ec16235e5f436bc54923e3925e3df07f?s=128&d=identicon&r=PG&f=1", "display_name": "Uhujkill", "link": "https://stackoverflow.com/users/3700472/uhujkill"}, "edited": false, "score": 0, "creation_date": 1485437746, "post_id": 41848638, "comment_id": 70930921, "body": "I have added a screen shot to the answer. Hopefully this shows you where to put the code"}, {"owner": {"reputation": 79, "user_id": 3700472, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/ec16235e5f436bc54923e3925e3df07f?s=128&d=identicon&r=PG&f=1", "display_name": "Uhujkill", "link": "https://stackoverflow.com/users/3700472/uhujkill"}, "edited": false, "score": 0, "creation_date": 1485438023, "post_id": 41848638, "comment_id": 70931131, "body": "Apologies i had the code in the general module, instead of the worksheet object. I have tested it now, and although the error appears, i think i may have described my intentions incorrectly.  The code at the moment prevents the user from entering the same value in the row below, in either column C or H. I want it to to prevent the user inputting the same value in column H, if the same product number is inputted in column C (when the row above relates to the same product, and the same fault category)"}, {"owner": {"reputation": 79, "user_id": 3700472, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/ec16235e5f436bc54923e3925e3df07f?s=128&d=identicon&r=PG&f=1", "display_name": "Uhujkill", "link": "https://stackoverflow.com/users/3700472/uhujkill"}, "edited": false, "score": 0, "creation_date": 1485438033, "post_id": 41848638, "comment_id": 70931140, "body": "In other words, the user can have two different issues with the same product (Column C), they just cannot use up two rows to describe the same fault category (Column H) relating to that same product. I hope this makes sense. Apologies once again"}, {"owner": {"reputation": 245, "user_id": 6593650, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a67fbc8a0efa3c4df79f5e5514586f8?s=128&d=identicon&r=PG&f=1", "display_name": "Aeneas", "link": "https://stackoverflow.com/users/6593650/aeneas"}, "reply_to_user": {"reputation": 79, "user_id": 3700472, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/ec16235e5f436bc54923e3925e3df07f?s=128&d=identicon&r=PG&f=1", "display_name": "Uhujkill", "link": "https://stackoverflow.com/users/3700472/uhujkill"}, "edited": false, "score": 1, "creation_date": 1485438674, "post_id": 41848638, "comment_id": 70931557, "body": "See updated code. Please note it will only check when Col H is changed and only the rows above not below"}, {"owner": {"reputation": 79, "user_id": 3700472, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/ec16235e5f436bc54923e3925e3df07f?s=128&d=identicon&r=PG&f=1", "display_name": "Uhujkill", "link": "https://stackoverflow.com/users/3700472/uhujkill"}, "edited": false, "score": 0, "creation_date": 1485439498, "post_id": 41848638, "comment_id": 70932062, "body": "That&#39;s it man! Is it not possible to check above and below? Thanks"}, {"owner": {"reputation": 79, "user_id": 3700472, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/ec16235e5f436bc54923e3925e3df07f?s=128&d=identicon&r=PG&f=1", "display_name": "Uhujkill", "link": "https://stackoverflow.com/users/3700472/uhujkill"}, "edited": false, "score": 0, "creation_date": 1485769283, "post_id": 41848638, "comment_id": 71045775, "body": "Hi Aeneas, is it possible for the code to ignore a duplicate if there is a row with other data between the referenced duplicate. In other words, if row ten has data relating to set 1, row eleven has data relating to set 2, and then row twelve has data relating to set 1 again, can the program ignore the duplicate in this case? As at the moment, the program compares duplicates all the way up the column. If this is not possible, don&#39;t worry about it. Thanks."}, {"owner": {"reputation": 245, "user_id": 6593650, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a67fbc8a0efa3c4df79f5e5514586f8?s=128&d=identicon&r=PG&f=1", "display_name": "Aeneas", "link": "https://stackoverflow.com/users/6593650/aeneas"}, "reply_to_user": {"reputation": 79, "user_id": 3700472, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/ec16235e5f436bc54923e3925e3df07f?s=128&d=identicon&r=PG&f=1", "display_name": "Uhujkill", "link": "https://stackoverflow.com/users/3700472/uhujkill"}, "edited": false, "score": 1, "creation_date": 1485859992, "post_id": 41848638, "comment_id": 71090184, "body": "The code for what you are now asking for is a lot simpler than what I&#39;ve already provided. You just need to check the above and below rows and no looping is needed."}, {"owner": {"reputation": 79, "user_id": 3700472, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/ec16235e5f436bc54923e3925e3df07f?s=128&d=identicon&r=PG&f=1", "display_name": "Uhujkill", "link": "https://stackoverflow.com/users/3700472/uhujkill"}, "edited": false, "score": 0, "creation_date": 1485865261, "post_id": 41848638, "comment_id": 71093494, "body": "Hi Aeneas, that&#39;s me got it working. If i ever needed to change the source column from 8 to 7, would i just update the following part to;  If Target.Row &gt; 1 And Target.Column = 7"}], "tags": [], "owner": {"reputation": 245, "user_id": 6593650, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a67fbc8a0efa3c4df79f5e5514586f8?s=128&d=identicon&r=PG&f=1", "display_name": "Aeneas", "link": "https://stackoverflow.com/users/6593650/aeneas"}, "is_accepted": true, "score": 1, "last_activity_date": 1485440997, "last_edit_date": 1485440997, "creation_date": 1485338739, "answer_id": 41848638, "question_id": 41848231, "link": "https://stackoverflow.com/questions/41848231/excel-2007-prevent-same-data-entry-in-cell-as-in-row-above/41848638#41848638", "title": "Excel 2007 - Prevent same data entry in cell, as in row above", "body": "<p>If you add this VB to the worksheet module it should work...</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\nIf Target.Row &gt; 1 And Target.Column = 8 And Target.Rows.Count = 1 And Target.Columns.Count = 1 Then\n\n    'Search Down\n    If Target.Offset(1, -5).Value &lt;&gt; \"\" Then\n        r = Target.Offset(0, -5).End(xlDown).Row\n        Do\n            If Cells(r, 3).Value &amp; Cells(r, 8).Value = Target.Offset(0, -5).Value &amp; Target.Value Then\n                MsgBox (\"Duplicate Data detected below\")\n                Application.EnableEvents = False\n                Target.Value = \"\"\n                Application.EnableEvents = True\n                Exit Do\n            End If\n            r = r - 1\n        Loop Until Target.Row = r\n    End If\n\n    'Search Up\n    r = 1\n    Do\n        If Target.Offset(-r, -5).Value &amp; Target.Offset(-r, 0).Value = Target.Offset(0, -5).Value &amp; Target.Value Then\n            MsgBox (\"Duplicate Data detected above\")\n            Application.EnableEvents = False\n            Target.Value = \"\"\n            Application.EnableEvents = True\n            Exit Do\n        End If\n        r = r + 1\n    Loop Until Target.Row = r\n\n\nEnd If\n\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/lyW8q.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/lyW8q.jpg\" alt=\"enter image description here\"></a></p>\n"}, {"tags": [], "owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "is_accepted": false, "score": 0, "last_activity_date": 1485351627, "creation_date": 1485351627, "answer_id": 41853129, "question_id": 41848231, "link": "https://stackoverflow.com/questions/41848231/excel-2007-prevent-same-data-entry-in-cell-as-in-row-above/41853129#41853129", "title": "Excel 2007 - Prevent same data entry in cell, as in row above", "body": "<p>If I'm reading your request correctly this <strong>can</strong> be done with Cell Validation:</p>\n\n<p>Apply the following data validation custom formula to the range in both columns C and H:</p>\n\n<p><code>=COUNTIFS($H1:$H2,H1,$C1:$C2,C1)=1</code></p>\n\n<p>Obviously it won't work in previous versions of Excel that haven't got the <code>SUMIFS</code> function.</p>\n"}], "owner": {"reputation": 79, "user_id": 3700472, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/ec16235e5f436bc54923e3925e3df07f?s=128&d=identicon&r=PG&f=1", "display_name": "Uhujkill", "link": "https://stackoverflow.com/users/3700472/uhujkill"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 209, "favorite_count": 1, "accepted_answer_id": 41848638, "answer_count": 2, "score": 0, "last_activity_date": 1485440997, "creation_date": 1485337556, "last_edit_date": 1531161705, "question_id": 41848231, "link": "https://stackoverflow.com/questions/41848231/excel-2007-prevent-same-data-entry-in-cell-as-in-row-above", "title": "Excel 2007 - Prevent same data entry in cell, as in row above", "body": "<p>I have an excel sheet which allows user input in a set format, i.e. Column C is for Product number and column H is for fault category. </p>\n\n<p>I am wanting to know if it possible to <strong>prevent</strong> the user inputting the same values in C2 and H2, if they already exist in C1 and H1. </p>\n\n<p>Please note, that this is not possible with data validation, as that looks for unique values in a column - I don't have any issue with duplicate values across two rows, as long as the duplicates do not exist in both columns C &amp; H, on the next row down.</p>\n\n<p>I am wanting to ensure the users use one row if there are multiple issues with a product, but they all relate to the same fault category.</p>\n\n<p>I am not great with VBA, so you're help would be greatly appreciated. </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 0, "creation_date": 1485337815, "post_id": 41848228, "comment_id": 70880725, "body": "What have you tried so far?? There are plenty of question of this type (even just on SO) so you should easily find a basis to work with"}, {"owner": {"reputation": 1362, "user_id": 5979902, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/OmvV7.jpg?s=128&g=1", "display_name": "Martin Dreher", "link": "https://stackoverflow.com/users/5979902/martin-dreher"}, "edited": false, "score": 0, "creation_date": 1485339176, "post_id": 41848228, "comment_id": 70881684, "body": "another new post with the same topic and 2 answers on how to achieve what you want: <a href=\"http://stackoverflow.com/questions/41846542/vba-convert-rows-to-columns\" title=\"vba convert rows to columns\">stackoverflow.com/questions/41846542/&hellip;</a>"}], "owner": {"reputation": 35, "user_id": 5142945, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9153eaee694d9c2d9a7cc51dda5a85c0?s=128&d=identicon&r=PG&f=1", "display_name": "Piyush Goyal", "link": "https://stackoverflow.com/users/5142945/piyush-goyal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 45, "favorite_count": 0, "closed_date": 1485339420, "answer_count": 0, "score": 0, "last_activity_date": 1485337542, "creation_date": 1485337542, "question_id": 41848228, "link": "https://stackoverflow.com/questions/41848228/transpose-multiple-columns-to-multiple-rows-in-excel", "closed_reason": "Duplicate", "title": "Transpose multiple columns to multiple rows in Excel", "body": "<p>I have huge amount of data in an Excel spreadsheet that is currently in multiple rows. I'd like to transform this into multiple rows with three columns.</p>\n\n<p>ID    Low     Med     high<br>\n1     10      20      30<br>\n2     11      22      33<br>\n3     22      32      21  </p>\n\n<p>Desired Outcome:<br>\n1   Low    10<br>\n1   Med    20<br>\n1   High   30<br>\n2   Low    11<br>\n2   Med    22<br>\n2   High   33<br>\n3   Low    22<br>\n3   Med    32<br>\n3   High   21  </p>\n\n<p>I would really appreciate your help. Thank You in advance!!</p>\n"}, {"tags": ["vba", "excel", "excel-formula", "readability"], "comments": [{"owner": {"reputation": 3970, "user_id": 2757925, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/a6804067a1c00a041299978a7b580ace?s=128&d=identicon&r=PG&f=1", "display_name": "V.K.", "link": "https://stackoverflow.com/users/2757925/v-k"}, "edited": false, "score": 2, "creation_date": 1485336838, "post_id": 41847930, "comment_id": 70880072, "body": "Personally I think it is a very bad practice to use such monstrous formulas. Reserve some ancillary cells where you can put intermediary formulas. The benefits are:  1) readability and maintainability (you can name the intermediary cells with some meaningful names)  2) you will soon find that some of the parts of the formulas are shared by many cells. Then you can do this calculation only once in one intermediary cell instead of repeating in every formula. Your workbook will be smaller and faster."}, {"owner": {"reputation": 22957, "user_id": 78522, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3facb4a672d9fbeb9f2ed6b5acc65633?s=128&d=identicon&r=PG", "display_name": "Patrick Honorez", "link": "https://stackoverflow.com/users/78522/patrick-honorez"}, "edited": false, "score": 1, "creation_date": 1485337114, "post_id": 41847930, "comment_id": 70880238, "body": "There seems to be a free tool for that purpose (I haven&#39;t used tried it yet) <a href=\"https://www.formuladesk.com/\" rel=\"nofollow noreferrer\">formuladesk.com</a>"}, {"owner": {"reputation": 3333, "user_id": 6609896, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/Zhi35.jpg?s=128&g=1", "display_name": "Greedo", "link": "https://stackoverflow.com/users/6609896/greedo"}, "edited": false, "score": 0, "creation_date": 1485337608, "post_id": 41847930, "comment_id": 70880583, "body": "I agree, and disagree! What I meant by <i>helper columns</i> is what you describe as ancillary/intermediary cells. I embrace helper columns when I would otherwise be repeating a large chunk of code in my formula. I chose a bad example because in this one I do it once. But most of the code doesn&#39;t contain any repetitions. It&#39;s in those cases, <i>where the formula is complicated despite intermediate steps</i> that I want a solution. Sometimes there are just a lot of variables that need to be juggled about at once. I will update the example accordingly."}, {"owner": {"reputation": 3333, "user_id": 6609896, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/Zhi35.jpg?s=128&g=1", "display_name": "Greedo", "link": "https://stackoverflow.com/users/6609896/greedo"}, "edited": false, "score": 0, "creation_date": 1485337854, "post_id": 41847930, "comment_id": 70880740, "body": "Obviously you <i>could</i> split up any formula between many cells, like <code>=(A1+A2)&#47;A3</code> into <code>=(A1+A2)</code> in cell B1 and <code>=B1&#47;A3</code> in cell B2. That gives shorter formulas, perhaps more readable. However unless I repeat code in a formula (like <code>=(A1+A2)&#47;A3+(A1+A2)^A3)</code>, I am against splitting that formula up - it actually hinders my ability to appreciate the formula as a whole. And since there are no repeated calculations I don&#39;t think splitting it up in <i>that</i> way would speed up the calculation either."}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1485337876, "post_id": 41847930, "comment_id": 70880757, "body": "cant you put what you have in a tree view control, not sure I undersrand what you are after, this could be an endless logic piece.  From my side, I use a lot of helper columns in design, then sometimes leave them in, if they help explain errors, but if say last month in the current year, i&#39;ll have as a helper in design, then pull into the formula at the end.  For example, <a href=\"http://stackoverflow.com/questions/41554272/how-do-you-generate-custom-rows-in-excel-without-vb/41554831#41554831\" title=\"how do you generate custom rows in excel without vb\">stackoverflow.com/questions/41554272/&hellip;</a> uses a lot of helper columns, but I wouldn&#39;t leave them all, but I&#39;d leave them in if they help solve an issue"}, {"owner": {"reputation": 1195, "user_id": 1788855, "user_type": "registered", "accept_rate": 29, "profile_image": "https://i.stack.imgur.com/9Ng0t.jpg?s=128&g=1", "display_name": "Carl Colijn", "link": "https://stackoverflow.com/users/1788855/carl-colijn"}, "edited": false, "score": 0, "creation_date": 1485355537, "post_id": 41847930, "comment_id": 70892623, "body": "Like V.K. said: if the formulas become too big to read, then make them smaller.  It not only helps with your ability to read them, but that of your successor as well (been there, not nice to inherit things like this).  Most times the intermediate steps have a true meaning as well, so you can label them accordingly, only further strengthening understandability.  I always strive for the most simple formulas in my solutions, and my users are very thankful for it, because it enables them to follow the formula path and even adjust it themselves.  Sure you get more columns, but it&#39;s worth it."}, {"owner": {"reputation": 3333, "user_id": 6609896, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/Zhi35.jpg?s=128&g=1", "display_name": "Greedo", "link": "https://stackoverflow.com/users/6609896/greedo"}, "reply_to_user": {"reputation": 1195, "user_id": 1788855, "user_type": "registered", "accept_rate": 29, "profile_image": "https://i.stack.imgur.com/9Ng0t.jpg?s=128&g=1", "display_name": "Carl Colijn", "link": "https://stackoverflow.com/users/1788855/carl-colijn"}, "edited": false, "score": 0, "creation_date": 1485435987, "post_id": 41847930, "comment_id": 70929744, "body": "@CarlColijn Initially when I read your comment I thought - that&#39;s got to be right - surely a formula can always be sectioned off into different cells based on the true meaning of intermediate steps. So I took that long formula at the top, and considered what I was trying to do, and what steps I took to create the formula in the first place. What I now see is that sometimes you make a trade off between formula <i>efficiency</i> (number of steps/ elements) and formula  <i>readability</i> (or specifically a formula in which you can follow the formula path). Sometimes you can&#39;t have both."}, {"owner": {"reputation": 3333, "user_id": 6609896, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/Zhi35.jpg?s=128&g=1", "display_name": "Greedo", "link": "https://stackoverflow.com/users/6609896/greedo"}, "edited": false, "score": 0, "creation_date": 1485436624, "post_id": 41847930, "comment_id": 70930122, "body": "Eg. I split my formula into 6 individual portions with their own meaning, and based on my train of logic I can see the best order to put those ideas in the formula (say A,B,C,D,E,F). However A, C and E are grouped inside an <code>IF()</code> formula, giving you 2 options. 1: split the formula up anyway, break the 1 IF into 3 to give <code>IF(A),B,IF(C),D,IF(E),F</code> - that makes the formula logical and readable. 2: leave in 1 block <code>IF(A,C,E),B,D,F</code>, makes the formula more efficient yet loses the train of the thought process. I personally tend to 2) - as readable as possible for max efficiency. Which do you use?"}], "answers": [{"tags": [], "owner": {"reputation": 2465, "user_id": 2570277, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0483cce5f2ea53671a36477fed79898b?s=128&d=identicon&r=PG", "display_name": "Nick", "link": "https://stackoverflow.com/users/2570277/nick"}, "is_accepted": true, "score": 2, "last_activity_date": 1485357425, "creation_date": 1485357425, "answer_id": 41855150, "question_id": 41847930, "link": "https://stackoverflow.com/questions/41847930/vba-to-make-excel-formulae-more-readable/41855150#41855150", "title": "VBA to make Excel formulae more readable", "body": "<p>I use this site to work with long formulas and it has helped me alot. </p>\n\n<p>It doesn't have the UI components you mention, but it does a great job of \"beautifying\" the output.</p>\n\n<p><a href=\"http://excelformulabeautifier.com/\" rel=\"nofollow noreferrer\">Excel Formula Beautifier</a></p>\n"}], "owner": {"reputation": 3333, "user_id": 6609896, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/Zhi35.jpg?s=128&g=1", "display_name": "Greedo", "link": "https://stackoverflow.com/users/6609896/greedo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 649, "favorite_count": 2, "accepted_answer_id": 41855150, "answer_count": 1, "score": 4, "last_activity_date": 1485357425, "creation_date": 1485336691, "last_edit_date": 1485338817, "question_id": 41847930, "link": "https://stackoverflow.com/questions/41847930/vba-to-make-excel-formulae-more-readable", "title": "VBA to make Excel formulae more readable", "body": "<p>I've had a glance around on the site, but advice on making Excel formulae (formulas?) more readable tends to be directed towards <em>'use named ranges'</em> or <em>'use helper columns'</em>. I'm not after techniques to make formulae easier to read, I'd like to create a macro to display the formulae in a more readable manner. <strong><em>You can skip to the end for a shortened problem description. I say this because although usually I like to explain my approach, I feel this time that my approach may be a distraction from the essence of the problem. Also, I think that the problem can be distilled down quite nicely without all the preceding background</em></strong></p>\n\n<h1>Problem background</h1>\n\n<p>I have a lot of nasty nest-within-nest complicated formulae, here's one I wrote today (see <a href=\"https://drive.google.com/file/d/0BxIuVxIOOZc_dGxXcHNZVXZrMDg/view?usp=sharing\" rel=\"nofollow noreferrer\" title=\"Sample document\">Excel sample document</a>)</p>\n\n<p><a href=\"https://i.stack.imgur.com/Nrt4b.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Nrt4b.png\" alt=\"![Excel Code sample\"></a></p>\n\n<p>or as code:</p>\n\n<pre><code>=IFERROR(IF(Latest[Weekday Num]=5,0,M13+MAX(Table3[Lunchtime],Latest[Lunchtime])-INDEX(Table4[Out],Latest[Weekday Num]))+Table3[Time remaining]-SUMIFS(Table4[Work time],Table4[Weekday Num],\"&gt;\"&amp;Latest[Weekday Num],Table4[Weekday Num],\"&lt;5\")+Latest[Clocked In]-S13,\"Refresh csv\")\n</code></pre>\n\n<p>As ugly as it may be, IMO it's actually quite well constructed; <code>IFS</code> and <code>SUMIFS</code> where possible to avoid nesting of formulae, all named ranges stored in tables, helper columns used where applicable. Yet under certain circumstances it returns a buggy result and the formula is <strong><em>not</em></strong> pleasant to read through. <em>(It's not the longest either, I have compiled formulae with several a4 pages, of code, although that was when I couldn't use vba to construct helper columns)</em></p>\n\n<p>I would like a macro which takes this formula and splits it into a sort of tree of branching functions, where each nested function is another twig - perhaps split the components of the formula across cells in the workbook</p>\n\n<h3>Current approach</h3>\n\n<p>I have so far attempted the following approach: Columns A&amp;B are used to split the formula into smaller parts. <strong>I define these parts as being the functions and arguments of Excel formulae</strong>, so the formula <code>IF(A1=1,A2,B1)</code> is split into to <code>IF(</code>, <code>A1=1,</code>, <code>A2,</code> and <code>B1)</code>. I do this with the following formula in column B:</p>\n\n<pre><code>=LEFT(A2,IFERROR(MAX(1,MIN(IFERROR(FIND(\"(\",A2),LEN(A2)+1),IFERROR(FIND(\")\",A2),LEN(A2)+1),FIND(\",\",A2))),LEN(A2)))\n</code></pre>\n\n<p>Meanwhile, column A looks at the last component found by column B, and chops it off the long formula <em>(using <code>=SUBSTITUTE(A2,B3,\"\",1)</code>)</em>.\nSo, for an original formula in A2 (as text), B2 is the first component of it (such as<code>IF(</code> in my example) and A3 is the formula in A2 <em>minus</em> the first component in B2. I drag down to iterate.</p>\n\n<h3>The macro</h3>\n\n<p>That gives me a list of the components of the formula in each of the cells of column B. My macro then decides what <em>level</em> each component is, and indents the component by that many cells. The <em>level</em> is defined as the number of open brackets preceding a component of the formula * <em>or 'segment' in my code</em> that haven't been closed. The macro comments explain this.</p>\n\n<pre><code>Sub DispFormula()\n'takes a split-up formula and indents lines appropriately\n\nDim CurrLev As Integer, OBrac As Integer, CBrac As Integer\nDim Segment As Range 'each part of the split up formula\nLastRow = Sheets(\"sheet1\").Cells(Rows.Count, 2).End(xlUp).Row\n\nSet orange = Range(\"B2:B\" &amp; LastRow) 'all the segments make an orange\n\nCurrLev = 0 'the \"level\" of the \"segment\" - it's level is a measure of how many layers deep the formula is nested\n            'if(a=1,b,c) is split into 4 components: `if(`, `a=1,`, `b,` &amp; `c)` where `if(` is level 0 and all the other segments are level 1\n\nOBrac = 0 'how many open brackets have happened/ precede a segment of the formula\nCBrac = 0 'how many closed brackets have happened\nOn Error Resume Next\nFor Each Segment In orange\n    If InStr(Segment, \"(\") &lt;&gt; 0 Then\n        OBrac = OBrac + 1\n    ElseIf InStr(Segment, \")\") &lt;&gt; 0 Then\n        CBrac = CBrac + 1\n    End If\n    Cells(Segment.Row, CurrLev + 3) = Segment 'copies the segment value into a column indented by a number of cells equal to the order of the segment\n    CurrLev = OBrac - CBrac 'current level is how many brackets have been opened - how many have been closed,\n                            'ie. the number of brackets preceding a segment which are currently open\nNext Segment\n\n\nEnd Sub\n</code></pre>\n\n<h3>How it could be improved</h3>\n\n<p>That's how far I've got so far. What I really want though is for the tree of indentations to be replaced with a tree of dropdown lists. For a formula <code>=IF(MAX(arg1,arg2)=1,arg3,MIN(arg1,arg2))</code> I would like to split into segments: <code>IF(</code>, <code>MAX(</code>, <code>ARG1,</code>, <code>ARG2)</code>, <code>=1,</code>, <code>ARG3,</code>, <code>MIN(</code>, <code>ARG1,</code> &amp; <code>ARG2))</code> htn display them. Not like this: (as I currently am)</p>\n\n<pre><code>IF(     \n    MAX(    \n        ARG1,\n        ARG2)\n    =1, \n    ARG3,   \n    MIN(    \n        ARG1,\n        ARG2))\n</code></pre>\n\n<p>But like this: (or similar)</p>\n\n<pre><code>IF(\u25c0\n</code></pre>\n\n<p>Which when you click on <code>\u25c0</code> becomes this:</p>\n\n<pre><code>IF(\u25bc\n    MAX(\u25c0   \n    =1, \n    ARG3,   \n    MIN(\u25c0\n</code></pre>\n\n<p>And then expanding <code>Min</code> to     </p>\n\n<pre><code>IF(\u25bc\n    MAX(\u25c0   \n    =1, \n    ARG3,   \n    MIN(\u25bc\n        ARG1,\n        ARG2))\n</code></pre>\n\n<hr>\n\n<h1>Shortened problem description</h1>\n\n<hr>\n\n<p>To summarise:</p>\n\n<ul>\n<li>I have a formula in Excel; formulae in Excel have the  general form <code>FUNCTION(argument1, arg2, arg3...)</code></li>\n<li>Each argument may be simple (a constant, a text string, a cell reference) or complex (another formula with its own function and arguments)</li>\n<li>I would like a macro which takes an input formula, and creates some form of user interface (be it specially located cells as in my example, or some other approach) to display the function in a tree like fashion</li>\n<li>That means in the first layer of the UI, I display the function, layer 2 has the arguments of the function, if the arguments are complex they will have further sub layers</li>\n<li>To access the sub layers, each function can be expanded with a dropdown arrow or some other means to reveal its arguments (the 'layer' below it). Like a Reddit post where you can click on the [+] to get 1 layer deeper.</li>\n</ul>\n"}, {"tags": ["excel", "vba", "charts", "visio", "flowchart"], "comments": [{"owner": {"reputation": 1470, "user_id": 1925536, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/21476b57657bcb422d5e9d5cbffc63e8?s=128&d=identicon&r=PG&f=1", "display_name": "SilverShotBee", "link": "https://stackoverflow.com/users/1925536/silvershotbee"}, "edited": false, "score": 0, "creation_date": 1485336706, "post_id": 41847896, "comment_id": 70879965, "body": "Have you tried anything yourself?..."}, {"owner": {"reputation": 535, "user_id": 5113999, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c182661a69960f30a88c361f4ac7da1a?s=128&d=identicon&r=PG&f=1", "display_name": "Rowen Chumacera", "link": "https://stackoverflow.com/users/5113999/rowen-chumacera"}, "edited": false, "score": 0, "creation_date": 1485336901, "post_id": 41847896, "comment_id": 70880109, "body": "There are alignment options that you can use. Just select the objects you want to align and click Format in the menu, the Align option should be there. Well, assuming you&#39;re using Excel 2013. Aligning shapes in Excel sucks, though."}, {"owner": {"reputation": 23, "user_id": 5332737, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sCsBx.png?s=128&g=1", "display_name": "Yuvaraj", "link": "https://stackoverflow.com/users/5332737/yuvaraj"}, "edited": false, "score": 0, "creation_date": 1485336947, "post_id": 41847896, "comment_id": 70880132, "body": "I mean i am trying to do this using VBA. like a tool kind of thing"}, {"owner": {"reputation": 23, "user_id": 5332737, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sCsBx.png?s=128&g=1", "display_name": "Yuvaraj", "link": "https://stackoverflow.com/users/5332737/yuvaraj"}, "edited": false, "score": 0, "creation_date": 1485336989, "post_id": 41847896, "comment_id": 70880157, "body": "I have written a VBA code that makes auto alignment. But it is not that good looking"}, {"owner": {"reputation": 1470, "user_id": 1925536, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/21476b57657bcb422d5e9d5cbffc63e8?s=128&d=identicon&r=PG&f=1", "display_name": "SilverShotBee", "link": "https://stackoverflow.com/users/1925536/silvershotbee"}, "edited": false, "score": 0, "creation_date": 1485337339, "post_id": 41847896, "comment_id": 70880395, "body": "@Yuvaraj Share your code, this is a website for helping with poor code, not writing you one from scratch"}, {"owner": {"reputation": 23, "user_id": 5332737, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sCsBx.png?s=128&g=1", "display_name": "Yuvaraj", "link": "https://stackoverflow.com/users/5332737/yuvaraj"}, "edited": false, "score": 0, "creation_date": 1485347530, "post_id": 41847896, "comment_id": 70887090, "body": "Have added the code"}], "owner": {"reputation": 23, "user_id": 5332737, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sCsBx.png?s=128&g=1", "display_name": "Yuvaraj", "link": "https://stackoverflow.com/users/5332737/yuvaraj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 540, "favorite_count": 1, "answer_count": 0, "score": 0, "last_activity_date": 1492192397, "creation_date": 1485336585, "last_edit_date": 1492192397, "question_id": 41847896, "link": "https://stackoverflow.com/questions/41847896/auto-align-flow-chart-in-excel", "title": "Auto Align flow chart in Excel", "body": "<p>Having a flowchart in Excel, Need to Automatically align it beautifully like we can do in Visio. Is there any code available for doing this in Excel?</p>\n\n<p>Thanks.</p>\n\n<p>I have written a vba code, But it is not giving beautiful result as in Visio</p>\n\n<pre><code>Sub auto_align()\n    On Error Resume Next\n\n    'Compile the diagram\n    Call Compiler\n\n    'Clear array values\n    For i = 0 To 99\n        numberofchildnodes(i) = 0\n        numberofnodesineachrow(i) = 0\n        listofnodes(i) = \"\"\n        nodeindexarray(i) = 0\n        parentnodearray(i) = 0\n        rownumberarray(i) = 0\n        columnnumberarray(i) = 0\n        numberofnodesineachrowarray(i) = 0\n    Next\n\n   'Get amount of space that must be given in the diagram between each nodes\n   rowspac = InputBox(\"Enter the space between rows, usually 100\", \"Test Modelling Tool\")\n   colspac = InputBox(\"Enter the space between adjacent nodes, usually 200\", \"Test Modelling Tool\")\n\n  'Find the listof nodes\n  i = 2\n  Do While Sheet6.Cells(1, i) &lt;&gt; \"\"\n\n    listofnodes(i - 2) = Sheet6.Cells(1, i)\n    i = i + 1\n\n  Loop\n  'Find the number of nodes\n    noofnodes = i - 2\n    orignoofnodes = noofnodes\n\n  'Find the begining node\n    For i = 2 To noofnodes + 1\n\n    b = False\n    E = False\n\n        j = 2\n        Do While Sheet6.Cells(j, 1) &lt;&gt; \"\"\n\n            If Sheet6.Cells(j, i) = \"B\" Then\n                b = True\n            End If\n            If Sheet6.Cells(j, i) = \"E\" Then\n                E = True\n            End If\n\n            j = j + 1\n\n        Loop\n\n        If b = True And E = False Then\n\n            strt_node = Sheet6.Cells(1, i)\n            Exit For\n\n        End If\n\n    Next\n\n    'Initialize values for start node\n    For i = 0 To noofnodes - 1\n\n        If listofnodes(i) = strt_node Then\n            Exit For\n        End If\n\n    Next\n\n    parentnodearray(i) = 0\n    nodeindexarray(i) = 1\n    rownumberarray(i) = 1\n    columnnumberarray(i) = 1\n\n    nodeindex = 1\n\n    'Call row order algorithm\n\n    'Initialize row number and column number\n    r = 1\n    cc = 1\n    dumnod = 1\n    'Loop until all the nodes has row number updated\n    Do\n\n        'Traverse through all the nodes\n        For i = 0 To noofnodes - 1\n\n            'If row number matches the exiting row number, update the row number for childs\n            If rownumberarray(i) = r Then\n                Call roworderalg(listofnodes(i))\n            End If\n\n        Next\n\n        'Increment the row\n        r = r + 1\n        'reinitialize column number\n        cc = 1\n\n        'Check if row number updated for all the nodes\n        rowupdatedforallnodes = True\n        For i = 0 To noofnodes - 1\n            If rownumberarray(i) = 0 Then\n                rowupdatedforallnodes = False\n            End If\n        Next\n\n        'Sort all the array inorder to maintain the order of calling the nodes in each row\n        Call BubbleSort\n\n    Loop While rowupdatedforallnodes = False\n\n    'Find the number of rows\n    r = rownumberarray(0)\n    For i = 0 To noofnodes - 1\n\n        If rownumberarray(i) &gt; r Then\n\n            r = rownumberarray(i)\n\n        End If\n\n    Next\n\n    'From last row minus 1 row to 1st row\n    i = r - 1\n    Do\n\n        For j = 0 To noofnodes - 1\n            'if a node falls in given row number\n            If rownumberarray(j) = i Then\n                'update the column number as sum of child nodes column number divided by number of child nodes\n                columnnumberarray(j) = findcolumnnumberofparent(j)\n\n            End If\n\n        Next\n    i = i - 1\n    Loop While i &lt;&gt; 0\n\n\n    i = 2\n    Do While Sheet6.Cells(1, i) &lt;&gt; \"\"\n        'Move all the nodes in the diagram according to row and column position which is obtained by multiplying the space factor obtained from the user\n        x = findnumberofnode(Sheet6.Cells(1, i))\n        Sheet1.Shapes(Sheet6.Cells(1, i)).Top = rownumberarray(x) * rowspac\n        Sheet1.Shapes(Sheet6.Cells(1, i)).Left = columnnumberarray(x) * colspac\n\n        i = i + 1\n    Loop\n\n    'Reroute all the connectors to ensure there is no intersection between connectors\n    i = 2\n    Do While Sheet6.Cells(i, 1) &lt;&gt; \"\"\n\n        Sheet1.Shapes(Sheet6.Cells(i, 1)).RerouteConnections\n        i = i + 1\n\n    Loop\n    Sheet1.Activate\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "powerpoint"], "answers": [{"comments": [{"owner": {"reputation": 101, "user_id": 7369282, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/10f2593a6483d8ee4c8235b9ba06ba0e?s=128&d=identicon&r=PG", "display_name": "Superhans", "link": "https://stackoverflow.com/users/7369282/superhans"}, "edited": false, "score": 0, "creation_date": 1485360207, "post_id": 41847853, "comment_id": 70896035, "body": "Thanks for this but I get a run time time error type 13 mis match whatever that is with your amended code  - Unfortunately I have no idea what that means - Any ideas?"}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "reply_to_user": {"reputation": 101, "user_id": 7369282, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/10f2593a6483d8ee4c8235b9ba06ba0e?s=128&d=identicon&r=PG", "display_name": "Superhans", "link": "https://stackoverflow.com/users/7369282/superhans"}, "edited": false, "score": 0, "creation_date": 1485361091, "post_id": 41847853, "comment_id": 70896662, "body": "@superhans : Try the edit, I don&#39;t know why but apparently PowerPoint changes the type when it&#39;s pasted!"}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "reply_to_user": {"reputation": 101, "user_id": 7369282, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/10f2593a6483d8ee4c8235b9ba06ba0e?s=128&d=identicon&r=PG", "display_name": "Superhans", "link": "https://stackoverflow.com/users/7369282/superhans"}, "edited": false, "score": 0, "creation_date": 1485371385, "post_id": 41847853, "comment_id": 70903218, "body": "@superhans : I changed the code in my answer to (I hope !) solve the issue!"}, {"owner": {"reputation": 939, "user_id": 208304, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4e50eeb34cba348b1c05d743ebb81b3a?s=128&d=identicon&r=PG", "display_name": "Jared Thirsk", "link": "https://stackoverflow.com/users/208304/jared-thirsk"}, "edited": false, "score": 0, "creation_date": 1539913859, "post_id": 41847853, "comment_id": 92682739, "body": "If the sheet is long, can Powerpoint show it with a vertical scrollbar?"}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "reply_to_user": {"reputation": 939, "user_id": 208304, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4e50eeb34cba348b1c05d743ebb81b3a?s=128&d=identicon&r=PG", "display_name": "Jared Thirsk", "link": "https://stackoverflow.com/users/208304/jared-thirsk"}, "edited": false, "score": 0, "creation_date": 1540198314, "post_id": 41847853, "comment_id": 92760296, "body": "@JaredThirsk : I&#39;d say no... The only thing I found, might be (inside <code>With PPShape</code>): <code>.AutoShapeType = msoShapeVerticalScroll</code> (If not recognized in Excel =&gt; <code>Const msoShapeVerticalScroll = 101 (&amp;H65)</code>) Let me know how it goes !"}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "reply_to_user": {"reputation": 939, "user_id": 208304, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4e50eeb34cba348b1c05d743ebb81b3a?s=128&d=identicon&r=PG", "display_name": "Jared Thirsk", "link": "https://stackoverflow.com/users/208304/jared-thirsk"}, "edited": false, "score": 0, "creation_date": 1540368792, "post_id": 41847853, "comment_id": 92834650, "body": "@JaredThirsk : so ?"}, {"owner": {"reputation": 939, "user_id": 208304, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4e50eeb34cba348b1c05d743ebb81b3a?s=128&d=identicon&r=PG", "display_name": "Jared Thirsk", "link": "https://stackoverflow.com/users/208304/jared-thirsk"}, "edited": false, "score": 0, "creation_date": 1540490514, "post_id": 41847853, "comment_id": 92895938, "body": "@R3uK I went with another approach, flipping between one half on each slide, and using a custom back button with a full history."}], "tags": [], "owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "is_accepted": true, "score": 2, "last_activity_date": 1485360987, "last_edit_date": 1485360987, "creation_date": 1485336463, "answer_id": 41847853, "question_id": 41847640, "link": "https://stackoverflow.com/questions/41847640/resizing-excel-chart-using-vba-in-powerpoint/41847853#41847853", "title": "Resizing Excel Chart Using VBA in Powerpoint", "body": "<p>Define a Shape object and play around :</p>\n\n<pre><code>'Opens a new PowerPoint presentation based on template and pastes data into Slide 2 of Powerpoint from Excel\n\nDim PPapp As PowerPoint.Application, PPpres As PowerPoint.Presentation, PPslide As PowerPoint.Slide, PPShape As Object\nDim XLws As Worksheet\n\nSet XLws = ActiveSheet\nSet PPapp = New PowerPoint.Application\nSet PPpres = PPapp.Presentations.Open(\"C:\\Users\\Colin\\Dropbox (Edge45)\\Edge45 Team Folder\\Edge45 Company Documents\\Templates\\Powerpoint Templates\\Edge45 Audit Template Macro.potm\", Untitled:=msoTrue)\nPPapp.Visible = True\nSet PPslide = PPpres.Slides(2)\nXLws.Range(\"A1:D16\").Copy\nSet PPShape = PPslide.Shapes.PasteSpecial(DataType:=ppPasteHTML, Link:=msoFalse)\nApplication.CutCopyMode = False\n\nWith PPShape\n    .Top = 10\n    .Height = 100\n    .Left = 10\n    .Width = 100\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 101, "user_id": 7369282, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/10f2593a6483d8ee4c8235b9ba06ba0e?s=128&d=identicon&r=PG", "display_name": "Superhans", "link": "https://stackoverflow.com/users/7369282/superhans"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4318, "favorite_count": 0, "accepted_answer_id": 41847853, "answer_count": 1, "score": 1, "last_activity_date": 1485360987, "creation_date": 1485335897, "last_edit_date": 1485336221, "question_id": 41847640, "link": "https://stackoverflow.com/questions/41847640/resizing-excel-chart-using-vba-in-powerpoint", "title": "Resizing Excel Chart Using VBA in Powerpoint", "body": "<p>I know this question has been asked before but as I am no VBA expert, I can't seem to get any of the solutions to work for my particular scenario so I was hoping someone could help.</p>\n\n<p>I have some VBA code that copies a selection from Excel, opens a new powerpoint presentation based on a template and then pastes the data into slide two of powerpoint.</p>\n\n<p>The only thing I want to do now is manipulate the size and position of the chart once it is there. What do I need to add to this code below to make that happen?</p>\n\n<pre><code>   'Opens a new PowerPoint presentation based on template and pastes data into Slide 2 of Powerpoint from Excel\n\nDim PPapp As PowerPoint.Application, PPpres As PowerPoint.Presentation, PPslide As PowerPoint.Slide\nDim XLws As Worksheet\n\n    Set XLws = ActiveSheet\n    Set PPapp = New PowerPoint.Application\n    Set PPpres = PPapp.Presentations.Open(\"C:\\Users\\Colin\\Dropbox (Edge45)\\Edge45 Team Folder\\Edge45 Company Documents\\Templates\\Powerpoint Templates\\Edge45 Audit Template Macro.potm\", Untitled:=msoTrue)\n    PPapp.Visible = True\n    Set PPslide = PPpres.Slides(2)\n    XLws.Range(\"A1:D16\").Copy\n    PPslide.Shapes.PasteSpecial DataType:=ppPasteHTML, Link:=msoFalse\n    Application.CutCopyMode = False\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 4, "creation_date": 1485335395, "post_id": 41847193, "comment_id": 70879082, "body": "<code>Set MDDHighPos = ...</code> as you are assigning an object variable."}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1485335495, "post_id": 41847193, "comment_id": 70879154, "body": "@SJR : You beat me to it! ;)"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 1, "creation_date": 1485335577, "post_id": 41847193, "comment_id": 70879204, "body": "@R3uK - your time will come!"}, {"owner": {"reputation": 343, "user_id": 4898713, "user_type": "registered", "profile_image": "https://graph.facebook.com/1189342967759685/picture?type=large", "display_name": "Wujaszkun", "link": "https://stackoverflow.com/users/4898713/wujaszkun"}, "edited": false, "score": 2, "creation_date": 1485335916, "post_id": 41847193, "comment_id": 70879397, "body": "@DGMS89 - I&#39;m just curious, why do you increase the rows in <code>MDDHighPos.Row + 1 &lt; MDDLowPos.Row + 1</code>?"}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 0, "creation_date": 1485336131, "post_id": 41847193, "comment_id": 70879565, "body": "To find the low value after the high, define a new range start right after the high value until the last row and use <code>MDDLow</code> and <code>MDDLowPos</code> again! ;)"}, {"owner": {"reputation": 1291, "user_id": 7321700, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/8TOGq.png?s=128&g=1", "display_name": "DGMS89", "link": "https://stackoverflow.com/users/7321700/dgms89"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1485336365, "post_id": 41847193, "comment_id": 70879752, "body": "@SJR Thanks for the answer. Works perfectly now. Care to write it as an answer?"}, {"owner": {"reputation": 1291, "user_id": 7321700, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/8TOGq.png?s=128&g=1", "display_name": "DGMS89", "link": "https://stackoverflow.com/users/7321700/dgms89"}, "reply_to_user": {"reputation": 343, "user_id": 4898713, "user_type": "registered", "profile_image": "https://graph.facebook.com/1189342967759685/picture?type=large", "display_name": "Wujaszkun", "link": "https://stackoverflow.com/users/4898713/wujaszkun"}, "edited": false, "score": 0, "creation_date": 1485336435, "post_id": 41847193, "comment_id": 70879795, "body": "@Wujaszkun That was just for testing purposes. I was trying to see if there was any impact from the fact that my range starts in row 2. Apparently I couldn&#39;t find any."}, {"owner": {"reputation": 1291, "user_id": 7321700, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/8TOGq.png?s=128&g=1", "display_name": "DGMS89", "link": "https://stackoverflow.com/users/7321700/dgms89"}, "reply_to_user": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 0, "creation_date": 1485336553, "post_id": 41847193, "comment_id": 70879872, "body": "@R3uK Thanks for the answer. I need to find the highest value before the lowest (drawdown calculation). Can I use the same procedure for that?"}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 0, "creation_date": 1485336705, "post_id": 41847193, "comment_id": 70879964, "body": "@DGMS89 : I don&#39;t see why not! ;)"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1485336798, "post_id": 41847193, "comment_id": 70880030, "body": "@DGMS89 - thanks, will do. Hadn&#39;t spotted the second bit but if you define a range from the first cell in MDDRange to MDDLowPos, then find the max and then do the find on that max value."}], "answers": [{"comments": [{"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 0, "creation_date": 1485336773, "post_id": 41847913, "comment_id": 70880013, "body": "Hehe! Btw, you could have provided a base of answer to the 2nd problem mentioned! ;)"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 0, "creation_date": 1485336843, "post_id": 41847913, "comment_id": 70880074, "body": "@R3uK - yes, I had missed that, but added a comment above."}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 0, "creation_date": 1485337027, "post_id": 41847913, "comment_id": 70880179, "body": "I edited to add the definition of the new range to use to find the new min! ;)"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 0, "creation_date": 1485337152, "post_id": 41847913, "comment_id": 70880264, "body": "@R3uK - not sure that&#39;s right as the OP wants to find the highest before the min where the max is after the min?"}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 0, "creation_date": 1485337336, "post_id": 41847913, "comment_id": 70880392, "body": "My bad, I indeed did the opposite!^^ Corrected it!"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 0, "creation_date": 1485338006, "post_id": 41847913, "comment_id": 70880841, "body": "@R3uK - you happy not to post as an answer, I don&#39;t want to take credit for your answer."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 1, "creation_date": 1485338685, "post_id": 41847913, "comment_id": 70881335, "body": "@R3uK- you&#39;re a scholar and a gent."}], "tags": [], "owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "is_accepted": true, "score": 2, "last_activity_date": 1485337389, "last_edit_date": 1485337389, "creation_date": 1485336631, "answer_id": 41847913, "question_id": 41847193, "link": "https://stackoverflow.com/questions/41847193/finding-the-row-position-of-a-value-and-using-it-for-calculation-in-vba/41847913#41847913", "title": "Finding the row position of a value and using it for calculation in VBA", "body": "<p>Here you go. Am assuming your variable declarations are at the beginning...</p>\n\n<pre><code>Set MDDRange = Worksheets(\"TIME\").Range(Col_Letter(lColumn) &amp; 2, Col_Letter(lColumn) &amp; LastRow) '.Value\n\n        MDDHigh = Application.WorksheetFunction.Min(MDDRange)\n        Set MDDHighPos = Worksheets(\"TIME SERIES\").Range(MDDRange).Find(MDDHigh, LookIn:=xlWhole)\n\n        MDDLow = Application.WorksheetFunction.Max(MDDRange)\n        Set MDDLowPos = Worksheets(\"TIME\").Range(MDDRange).Find(MDDLow, LookIn:=xlWhole)\n\n\n'if to see if mddhigh comes before mddlow\n\n        If MDDHighPos.Row + 1 &lt; MDDLowPos.Row + 1 Then ' error is here\n\n            MDD = (MDDLow - MDDHigh) / MDDHigh\n\n            Worksheets(\"STATS\").Cells(6, lColumn).Value = MDD\n\n        Else\n            'if my high value is not before my low, how to find the highest value before the low?\n\n             Set MDDRange = Worksheets(\"TIME\").Range(Col_Letter(lColumn) &amp; \"2\", Col_Letter(lColumn) &amp; MDDLowPos.Row - 1)\n             'And here you go again! ;)\n\n        End If\n</code></pre>\n"}], "owner": {"reputation": 1291, "user_id": 7321700, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/8TOGq.png?s=128&g=1", "display_name": "DGMS89", "link": "https://stackoverflow.com/users/7321700/dgms89"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 57, "favorite_count": 0, "accepted_answer_id": 41847913, "answer_count": 1, "score": 2, "last_activity_date": 1485337936, "creation_date": 1485334585, "last_edit_date": 1485337936, "question_id": 41847193, "link": "https://stackoverflow.com/questions/41847193/finding-the-row-position-of-a-value-and-using-it-for-calculation-in-vba", "title": "Finding the row position of a value and using it for calculation in VBA", "body": "<p>I have a code that defines a range and finds the highest and lowest value of that range.</p>\n\n<p>What I want to do is get those values, find the rows for each of them, see if the row of the high value is smaller then the row of the low value, then do a calculation.</p>\n\n<p><strong>Problem 1</strong> For some reason I keep getting an invalid qualifier error in the line the uses the row for the comparison.</p>\n\n<p><strong>Problem 2</strong> If the low value comes before the high, how can I find the highest value in the range that comes before the low?</p>\n\n<p>The relevant part of the code is:</p>\n\n<pre><code> Set MDDRange = Worksheets(\"TIME\").Range(Col_Letter(lColumn) &amp; 2, Col_Letter(lColumn) &amp; LastRow) '.Value\n\n        MDDHigh = Application.WorksheetFunction.Min(MDDRange)\n        MDDHighPos = Worksheets(\"TIME SERIES\").Range(MDDRange).Find(MDDHigh, LookIn:=xlWhole)\n\n        MDDLow = Application.WorksheetFunction.Max(MDDRange)\n        MDDLowPos = Worksheets(\"TIME\").Range(MDDRange).Find(MDDLow, LookIn:=xlWhole)\n\n\n'if to see if mddhigh comes before mddlow\n\n        If MDDHighPos.Row + 1 &lt; MDDLowPos.Row + 1 Then ' error is here\n\n            MDD = (MDDLow - MDDHigh) / MDDHigh\n\n            Worksheets(\"STATS\").Cells(6, lColumn).Value = MDD\n\n        Else\n            'if my high value is not before my low, how to find the highest value before the low?\n        End If\n</code></pre>\n\n<p>Any help will be deeply appreciated.</p>\n\n<p><strong>Modified Part correcting both problems (this is from the accepted answer from SJR and modifications from R3uK):</strong></p>\n\n<pre><code>Set MDDRange = Worksheets(\"TIME\").Range(Col_Letter(lColumn) &amp; 2, Col_Letter(lColumn) &amp; LastRow) '.Value\n\n        MDDHigh = Application.WorksheetFunction.Max(MDDRange)\n        Set MDDHighPos = MDDRange.Find(MDDHigh)\n\n        MDDLow = Application.WorksheetFunction.Min(MDDRange)\n        Set MDDLowPos = MDDRange.Find(MDDLow)\n\n        a = MDDHighPos.Row\n        b = MDDLowPos.Row\n\n'if to see if mddhigh comes before mddlow\n\n        If a &lt; b Then\n\n            MDD = ((MDDLow - MDDHigh) / MDDHigh)\n\n            Worksheets(\"STATS\").Cells(6, lColumn).Value = MDD\n\n        Else\n'this creates a new range from begin of old range to the lowest value, and finds the highest value in this range, then calculates the drawdown\n\n            Set MDDRangeNew = Worksheets(\"TIME\").Range(Col_Letter(lColumn) &amp; 2, Col_Letter(lColumn) &amp; b)\n\n            MDDHighNew = Application.WorksheetFunction.Max(MDDRangeNew)\n\n            MDD = ((MDDLow - MDDHighNew) / MDDHighNew)\n\n            Worksheets(\"STATS\").Cells(6, lColumn).Value = MDD\n\n        End If\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 1, "creation_date": 1485333825, "post_id": 41846874, "comment_id": 70878099, "body": "You need to specify the path when opening a workbook - <code>Workbooks.Open &quot;D:\\FORMULAS\\&quot; &amp; fname</code>"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1485334126, "post_id": 41846874, "comment_id": 70878298, "body": "@YowE3K damn you&#39;re fast today :)"}], "answers": [{"comments": [{"owner": {"reputation": 53, "user_id": 5185584, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/82be57ab8c266c3100193c532a641ac5?s=128&d=identicon&r=PG&f=1", "display_name": "Baber62", "link": "https://stackoverflow.com/users/5185584/baber62"}, "edited": false, "score": 0, "creation_date": 1485336169, "post_id": 41847032, "comment_id": 70879594, "body": "I am linking this code to a button on the Quick Access Toolbar, however, when I change the code to suit the above coding it gave an error message as follows: Cannot run the macro &#39;PERSONAL.XLSB!Formula_Spreadsheet&#39;. This macro may not be available in this workbook or all macros may be disabled."}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "reply_to_user": {"reputation": 53, "user_id": 5185584, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/82be57ab8c266c3100193c532a641ac5?s=128&d=identicon&r=PG&f=1", "display_name": "Baber62", "link": "https://stackoverflow.com/users/5185584/baber62"}, "edited": false, "score": 0, "creation_date": 1485336250, "post_id": 41847032, "comment_id": 70879664, "body": "@Baber62 what error? Copy this entire code to your button, I ran it without getting any errros"}, {"owner": {"reputation": 53, "user_id": 5185584, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/82be57ab8c266c3100193c532a641ac5?s=128&d=identicon&r=PG&f=1", "display_name": "Baber62", "link": "https://stackoverflow.com/users/5185584/baber62"}, "edited": false, "score": 0, "creation_date": 1485336647, "post_id": 41847032, "comment_id": 70879935, "body": "@ Shai Radio My bad I hadn&#39;t realised that I had changed the name of the macro from Formula_Spreadsheet to FormulaOpen. The coding works fine. Thanks, appreciated."}], "tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": true, "score": 6, "last_activity_date": 1485334090, "creation_date": 1485334090, "answer_id": 41847032, "question_id": 41846874, "link": "https://stackoverflow.com/questions/41846874/excel-macro-to-open-file-with-partial-filename/41847032#41847032", "title": "Excel macro to open file with partial filename", "body": "<p>Try something like the code below:</p>\n\n<pre><code>Dim fname As Variant\nDim myPath As String\n\nmyPath = \"D:\\FORMULAS\\\"\nfname = Dir(myPath &amp; \"BABERs FORMULAS*\")\n\nIf fname &lt;&gt; \"\" Then\n    Workbooks.Open (myPath &amp; fname)\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 53, "user_id": 5185584, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/82be57ab8c266c3100193c532a641ac5?s=128&d=identicon&r=PG&f=1", "display_name": "Baber62", "link": "https://stackoverflow.com/users/5185584/baber62"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 15341, "favorite_count": 0, "accepted_answer_id": 41847032, "answer_count": 1, "score": 2, "last_activity_date": 1485334090, "creation_date": 1485333621, "last_edit_date": 1485333950, "question_id": 41846874, "link": "https://stackoverflow.com/questions/41846874/excel-macro-to-open-file-with-partial-filename", "title": "Excel macro to open file with partial filename", "body": "<p>I have tried looking on various forums and cannot seem to find a solution that fits my needs.</p>\n\n<p>I have a file \"BABERs FORMULAS - 24 Jan 2017 - Rev 079 11-27.xlsm\". I use a macro to save the changes to the file which adds the date, revision number and timestamp to the filename. The file is located at the following path \"D:\\FORMULAS\".</p>\n\n<p>The macro I have is as below but this then gives me a Run-time error '1004' and says to check that the spelling of the file name and verify the location is correct.</p>\n\n<pre><code>Dim fname as Variant\nfname = Dir(\"D:\\FORMULAS\\BABERs FORMULAS*\")\n\nIf fname &lt;&gt; \"\" then\n    Workbooks.open (fname)\nEnd If\n</code></pre>\n\n<p>Any ideas where I could be going wrong? Any assistance would be appreciated.</p>\n"}, {"tags": ["string", "vba", "range"], "answers": [{"comments": [{"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1485444737, "post_id": 41850403, "comment_id": 70936000, "body": "@Jeweller89, did you get through it?"}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1485518474, "post_id": 41850403, "comment_id": 70968805, "body": "@Jeweller89, it&#39;d be nice of you giving proper feedback to people trying at helping you. thank you"}], "tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": false, "score": 0, "last_activity_date": 1485343512, "creation_date": 1485343512, "answer_id": 41850403, "question_id": 41846857, "link": "https://stackoverflow.com/questions/41846857/pass-the-content-of-several-ranges-into-another-sub/41850403#41850403", "title": "Pass the content of several ranges into another sub", "body": "<p>let's call your Sub after \"DoIt\"</p>\n\n<pre><code>Option Explicit\n\nSub doit(rngSrc As Range, rngTgt As Range)\n    Dim cell As Range\n    Dim arr, rng As Range\n    Dim c As ColorStop\n    Dim isGreen As Boolean\n    Dim e As Long\n\n    For Each cell In rngSrc\n        isGreen = False\n        On Error Resume Next\n        With cell.Interior.Gradient.ColorStops\n        End With\n        e = Err.Number\n        On Error GoTo 0\n        If e = 0 Then\n            For Each c In cell.Interior.Gradient.ColorStops\n                arr = LongToRGB(c.Color)\n                If arr(2) / IIf(arr(1) = 0, 1, arr(1)) &gt; 1.25 And arr(2) / IIf(arr(3) = 0, 1, arr(3)) &gt; 1.25 Then\n                    isGreen = True\n                    Exit For\n                End If\n            Next c\n        Else\n            arr = LongToRGB(cell.Interior.Color)\n            If arr(2) / IIf(arr(1) = 0, 1, arr(1)) &gt; 1.25 And arr(2) / IIf(arr(3) = 0, 1, arr(3)) &gt; 1.25 Then isGreen = True\n        End If\n        If isGreen Then\n            If rng Is Nothing Then Set rng = cell.Offset(, -1).Resize(, 2) Else Set rng = Union(rng, cell.Offset(, -1).Resize(, 2))\n        End If\n    Next cell\n\n    If Not rng Is Nothing Then rng.Copy: rngTgt.PasteSpecial xlPasteValues\nEnd Sub\n</code></pre>\n\n<p>then your \"main\" code will be:</p>\n\n<pre><code>Option Explicit\n\nSub Con_CCC()\n    Dim rngSrc As Range, rngTgt As Range\n\n    Worksheets(\"Index Changes\").Range(\"P7:P24\").ClearContents\n\n    Set rngSrc = Sheets(\"Output\").Range(\"J13:J100\")\n    Set rngTgt = Sheets(\"Index Changes\").Range(\"Y7\")\n\n    doit rngSrc, rngTgt '&lt;--| call your 'DoIt()' sub passing 'rngSrc' and 'rngTgt' ranges\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 19, "user_id": 7325653, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edca11c161eb7216d06297a8eef6470a?s=128&d=identicon&r=PG&f=1", "display_name": "Jeweller89", "link": "https://stackoverflow.com/users/7325653/jeweller89"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 21, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1485343512, "creation_date": 1485333574, "question_id": 41846857, "link": "https://stackoverflow.com/questions/41846857/pass-the-content-of-several-ranges-into-another-sub", "title": "Pass the content of several ranges into another sub", "body": "<p>I have the following code which I will need to pass on several ranges (rngSrc and rngTgt).    </p>\n\n<pre><code> Sub Con_CCC()\n\n Dim arr, rngSrc As Range, rngTgt As Range, rng As Range, cell As Range\n Dim c As ColorStop\n Dim isGreen As Boolean\n Dim e As Long\n\n Worksheets(\"Index Changes\").Range(\"P7:P24\").ClearContents\n\n Set rngSrc = Sheets(\"Output\").Range(\"J13:J100\")\n Set rngTgt = Sheets(\"Index Changes\").Range(\"Y7\")\n\n  For Each cell In rngSrc\n   isGreen = False\n   On Error Resume Next\n     With cell.Interior.Gradient.ColorStops\n     End With\n     e = Err.Number\n   On Error GoTo 0\n   If e = 0 Then\n     For Each c In cell.Interior.Gradient.ColorStops\n         arr = LongToRGB(c.Color)\n         If arr(2) / IIf(arr(1) = 0, 1, arr(1)) &gt; 1.25 And arr(2) / IIf(arr(3) = 0, 1, arr(3)) &gt; 1.25 Then\n            isGreen = True\n            Exit For\n         End If\n     Next c\n  Else\n     arr = LongToRGB(cell.Interior.Color)\n     If arr(2) / IIf(arr(1) = 0, 1, arr(1)) &gt; 1.25 And arr(2) / IIf(arr(3) = 0, 1, arr(3)) &gt; 1.25 Then isGreen = True\n  End If\n  If isGreen Then\n     If rng Is Nothing Then Set rng = cell.Offset(, -1).Resize(, 2) Else Set rng = Union(rng, cell.Offset(, -1).Resize(, 2))\n  End If\nNext cell\n\nIf Not rng Is Nothing Then rng.Copy: rngTgt.PasteSpecial xlPasteValues\n\nEnd Sub\n</code></pre>\n\n<p>In essence I will need a sub which contains the following code only and then takes the different rngSrc and rngTgt set in my other sub's.</p>\n\n<pre><code>   For Each cell In rngSrc\n    isGreen = False\n    On Error Resume Next\n     With cell.Interior.Gradient.ColorStops\n     End With\n   e = Err.Number\n  On Error GoTo 0\n  If e = 0 Then\n    For Each c In cell.Interior.Gradient.ColorStops\n     arr = LongToRGB(c.Color)\n     If arr(2) / IIf(arr(1) = 0, 1, arr(1)) &gt; 1.25 And arr(2) / IIf(arr(3) = 0, 1, arr(3)) &gt; 1.25 Then\n        isGreen = True\n        Exit For\n     End If\n Next c\nElse\n   arr = LongToRGB(cell.Interior.Color)\n   If arr(2) / IIf(arr(1) = 0, 1, arr(1)) &gt; 1.25 And arr(2) / IIf(arr(3) = 0, 1, arr(3)) &gt; 1.25 Then isGreen = True\n End If\n If isGreen Then\n If rng Is Nothing Then Set rng = cell.Offset(, -1).Resize(, 2) Else Set rng = Union(rng, cell.Offset(, -1).Resize(, 2))\nEnd If\nNext cell\n\n If Not rng Is Nothing Then rng.Copy: rngTgt.PasteSpecial xlPasteValues \n</code></pre>\n"}, {"tags": ["string", "vba", "excel"], "comments": [{"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 0, "creation_date": 1485333876, "post_id": 41846798, "comment_id": 70878127, "body": "Your result seems to be outputed in 2 columns (G and V), am I right? If you don&#39;t need the full path of the files and you don&#39;t have the same names for files, you could use the filenames as keys into your dictionnary <code>pathsEmails(fle.name) = book.Worksheets(1).Range(&quot;C15&quot;).Value</code>. Or loop on the columns to remove everything before the &quot;\\&quot;"}, {"owner": {"reputation": 933, "user_id": 7415328, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/e492112338fd835b68222137dbd84a31?s=128&d=identicon&r=PG&f=1", "display_name": "user7415328", "link": "https://stackoverflow.com/users/7415328/user7415328"}, "reply_to_user": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 0, "creation_date": 1485333969, "post_id": 41846798, "comment_id": 70878189, "body": "@R3uK yes column V contains the email and column G contains the workbook file path"}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 0, "creation_date": 1485334092, "post_id": 41846798, "comment_id": 70878276, "body": "Ok! And do you have the same file&#39;s names sometimes? And do you need to use the full path of the files elsewhere than in the code you posted?"}, {"owner": {"reputation": 933, "user_id": 7415328, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/e492112338fd835b68222137dbd84a31?s=128&d=identicon&r=PG&f=1", "display_name": "user7415328", "link": "https://stackoverflow.com/users/7415328/user7415328"}, "reply_to_user": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 0, "creation_date": 1485334347, "post_id": 41846798, "comment_id": 70878440, "body": "@R3uK no i only use the full path in the code posted. And each file name is different"}, {"owner": {"reputation": 10104, "user_id": 111794, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c209be384649abcc5a4bf8babb132572?s=128&d=identicon&r=PG", "display_name": "Zev Spitz", "link": "https://stackoverflow.com/users/111794/zev-spitz"}, "edited": false, "score": 0, "creation_date": 1485348736, "post_id": 41846798, "comment_id": 70887794, "body": "Your edit is actually another question; and you could have figured it out quite simply, as you already know how to use the <code>Replace</code> function. Also, your first question isn&#39;t rocket science and you could have found the answer with a little bit of research into the File object, using the <code>Name</code> property instead of the <code>Path</code> property."}], "answers": [{"comments": [{"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 1, "creation_date": 1485333974, "post_id": 41846944, "comment_id": 70878193, "body": "As it loops on folders, this won&#39;t work unless by chance they are all named with the same length.."}], "tags": [], "owner": {"reputation": 21, "user_id": 7467926, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ee730207e4e1d969becc7a6292f17ba3?s=128&d=identicon&r=PG&f=1", "display_name": "Phanindra", "link": "https://stackoverflow.com/users/7467926/phanindra"}, "is_accepted": false, "score": 0, "last_activity_date": 1485342369, "last_edit_date": 1485342369, "creation_date": 1485333828, "answer_id": 41846944, "question_id": 41846798, "link": "https://stackoverflow.com/questions/41846798/trim-a-string-file-path-in-vba/41846944#41846944", "title": "trim a string / file path in vba?", "body": "<p>Why not use something like <code>mid(fle.path,11,len(fle.path) - 11)</code>?</p>\n"}, {"comments": [{"owner": {"reputation": 933, "user_id": 7415328, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/e492112338fd835b68222137dbd84a31?s=128&d=identicon&r=PG&f=1", "display_name": "user7415328", "link": "https://stackoverflow.com/users/7415328/user7415328"}, "edited": false, "score": 0, "creation_date": 1485337857, "post_id": 41847372, "comment_id": 70880742, "body": "thanks this worked great. One other thing, sometimes i have more than one email in cell C15 see updated question."}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "reply_to_user": {"reputation": 933, "user_id": 7415328, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/e492112338fd835b68222137dbd84a31?s=128&d=identicon&r=PG&f=1", "display_name": "user7415328", "link": "https://stackoverflow.com/users/7415328/user7415328"}, "edited": false, "score": 0, "creation_date": 1485338280, "post_id": 41847372, "comment_id": 70881057, "body": "@user7415328 : You&#39;ll have to loop on the range where you outputed the mails and use something like <code>Cell=Replace(Cell,&quot;&#47;&quot;,&quot;,&quot;)</code> ;)"}, {"owner": {"reputation": 933, "user_id": 7415328, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/e492112338fd835b68222137dbd84a31?s=128&d=identicon&r=PG&f=1", "display_name": "user7415328", "link": "https://stackoverflow.com/users/7415328/user7415328"}, "edited": false, "score": 0, "creation_date": 1485338924, "post_id": 41847372, "comment_id": 70881515, "body": "thanks i have tried this but it doesn&#39;t seem to work for me. Could you please show me how to put this into context with the code you have provided? I&#39;m sorry but i&#39;m brand new to vba"}], "tags": [], "owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "is_accepted": true, "score": 1, "last_activity_date": 1485339217, "last_edit_date": 1485339217, "creation_date": 1485335191, "answer_id": 41847372, "question_id": 41846798, "link": "https://stackoverflow.com/questions/41846798/trim-a-string-file-path-in-vba/41847372#41847372", "title": "trim a string / file path in vba?", "body": "<p>Using files' names as keys, you should have the desired output :</p>\n\n<p>(if not, try : <code>pathsEmails(Replace(fle.Path,weekFolder.Path,vbNullString)) = book.Worksheets(1).Range(\"C15\").Value</code>)</p>\n\n<pre><code>Option Explicit\nSub SO()\n    'clear the existing list here -- not implemented\n    '...\n    Dim wS As Worksheet\n    Dim LastRow As Long\n    Dim i as Long\n\n    Set wS = ThisWorkbook.ActiveSheet\n    With wS\n        LastRow = .Range(\"G\" &amp; .Rows.Count).End(xlUp).Row\n\n        .Range(\"G17:G\" &amp; LastRow).ClearContents\n        .Range(\"V17:V\" &amp; LastRow).ClearContents\n        .Range(\"AD17:AD\" &amp; LastRow).ClearContents\n    End With\n\n    Dim pathsEmails As New Dictionary\n    Dim app As New Excel.Application\n    Dim fso As New FileSystemObject\n    Dim weekFolder As Folder\n    Dim supplierFolder As Folder\n    Dim fle As File\n    'replace 1 with either the name or the index of the worksheet which holds the week folder path\n    'replace B4 with the address of the cell which holds the week folder path\n    Set weekFolder = fso.GetFolder(wS.Range(\"I8\").Value)\n    For Each supplierFolder In weekFolder.SubFolders\n        For Each fle In supplierFolder.Files\n            'test whether this is an Excel file\n            If fle.Type Like \"*Excel*\" Then\n                'open the workbook, read and save the email, and close the workbook\n                Dim book As Workbook\n                On Error Resume Next\n                Set book = app.Workbooks.Open(fle.Path, , True)\n                pathsEmails(fle.Name) = book.Worksheets(1).Range(\"C15\").Value\n                book.Close False\n            End If\n        Next fle\n    Next supplierFolder\n    app.Quit\n\n    'copy the paths and emails to the worksheet\n    '(as above) replace 1 with either the name or the index of the worksheet which holds the week folder path\n    'paths are pasted in starting at cell B6, downwards\n    'emails are pasted in starting at cell C6, downwards\n    With wS\n        .Range(\"G17\").Resize(UBound(pathsEmails.Keys) + 1, 1).Value = WorksheetFunction.Transpose(pathsEmails.Keys)\n        .Range(\"V17\").Resize(UBound(pathsEmails.Items) + 1, 1).Value = WorksheetFunction.Transpose(pathsEmails.Items)\n        'Clear empty cells\n        On Error Resume Next\n        LastRow = .Range(\"G\" &amp; .Rows.Count).End(xlUp).Row\n        For i = 17 To LastRow\n            .Range(\"V\" &amp; i)=Replace(.Range(\"V\" &amp; i),\"/\",\",\")\n        Next i\n        .Range(\"V17:V\" &amp; LastRow).SpecialCells(xlBlanks).EntireRow.Delete\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 933, "user_id": 7415328, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/e492112338fd835b68222137dbd84a31?s=128&d=identicon&r=PG&f=1", "display_name": "user7415328", "link": "https://stackoverflow.com/users/7415328/user7415328"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 613, "favorite_count": 0, "accepted_answer_id": 41847372, "answer_count": 2, "score": 0, "last_activity_date": 1485342369, "creation_date": 1485333395, "last_edit_date": 1485338191, "question_id": 41846798, "link": "https://stackoverflow.com/questions/41846798/trim-a-string-file-path-in-vba", "title": "trim a string / file path in vba?", "body": "<p>I have the following code which produces a list of excel file paths and email addresses contained in those workbooks.</p>\n\n<p>Code:</p>\n\n<pre><code>Option Explicit\nSub SO()\n    'clear the existing list here -- not implemented\n    '...\n    Range(\"G17:G\" &amp; ActiveSheet.Cells.SpecialCells(xlCellTypeLastCell).Row).ClearContents\n    Range(\"V17:V\" &amp; ActiveSheet.Cells.SpecialCells(xlCellTypeLastCell).Row).ClearContents\n    Range(\"AD17:AD\" &amp; ActiveSheet.Cells.SpecialCells(xlCellTypeLastCell).Row).ClearContents\n    Dim pathsEmails As New Dictionary\n    Dim app As New Excel.Application\n\n    Dim fso As New FileSystemObject\n    Dim weekFolder As Folder\n    'replace 1 with either the name or the index of the worksheet which holds the week folder path\n    'replace B4 with the address of the cell which holds the week folder path\n    Set weekFolder = fso.GetFolder(Worksheets(1).Range(\"I8\").Value)\n\n    Dim supplierFolder As Folder, fle As file\n    For Each supplierFolder In weekFolder.SubFolders\n        For Each fle In supplierFolder.files\n\n            'test whether this is an Excel file\n            If fle.Type Like \"*Excel*\" Then\n\n                'open the workbook, read and save the email, and close the workbook\n                Dim book As Workbook\n                On Error Resume Next\n                Set book = app.Workbooks.Open(fle.path, , True)\n                pathsEmails(fle.path) = book.Worksheets(1).Range(\"C15\").Value\n                book.Close False\n\n            End If\n\n        Next\n    Next\n\n    app.Quit\n\n\n    'copy the paths and emails to the worksheet\n    '(as above) replace 1 with either the name or the index of the worksheet which holds the week folder path\n    'paths are pasted in starting at cell B6, downwards\n    'emails are pasted in starting at cell C6, downwards\n    Worksheets(1).Range(\"G17\").Resize(UBound(pathsEmails.Keys) + 1, 1).Value = WorksheetFunction.Transpose(pathsEmails.Keys)\n    Worksheets(1).Range(\"V17\").Resize(UBound(pathsEmails.Items) + 1, 1).Value = WorksheetFunction.Transpose(pathsEmails.Items)\n\n    'Clear empty cells\n    On Error Resume Next\n    Range(\"V17:V\" &amp; ActiveSheet.Cells.SpecialCells(xlCellTypeLastCell).Row).SpecialCells(xlBlanks).EntireRow.Delete\n\n\nEnd Sub\n</code></pre>\n\n<p>This produces a result like so:</p>\n\n<pre><code>G:\\folder1\\file.xls                email@email.com\n</code></pre>\n\n<p>How can i trim my file path to produce just the following:</p>\n\n<pre><code>file.xls                        email@email.com\n</code></pre>\n\n<p>I have tried </p>\n\n<pre><code>replace(pathsEmails(fle.path), \"G:\\folder1\\\" , \"\")\n</code></pre>\n\n<p>But this doesn't work. Please can someone show me where i am going wrong?</p>\n\n<p>Edit:</p>\n\n<p>Sometimes i have more than one email address in the cell C15. </p>\n\n<pre><code>email@email.com / tom@email.com\n</code></pre>\n\n<p>So this causes the emails in the workbook to be listed like so:</p>\n\n<pre><code>email@email.com / tom@email.com\n</code></pre>\n\n<p>Is there anyway i can replace the <code>/</code> and replace it with a <code>,</code> (to make it email friendly)</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 635, "user_id": 5444243, "user_type": "registered", "profile_image": "https://graph.facebook.com/10206921510469410/picture?type=large", "display_name": "Gabor", "link": "https://stackoverflow.com/users/5444243/gabor"}, "edited": false, "score": 0, "creation_date": 1485332898, "post_id": 41846542, "comment_id": 70877477, "body": "Do you have the possibility to use PowerQuery? That would make it very simple. all you have to do is to unpivot the data."}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 0, "creation_date": 1485333439, "post_id": 41846542, "comment_id": 70877825, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/15775143/excel-convert-columns-to-new-rows\">Excel convert columns to new rows</a>"}, {"owner": {"reputation": 11, "user_id": 7457604, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-PIccOIPee7s/AAAAAAAAAAI/AAAAAAAAAB0/Iq4PVdjKUUo/photo.jpg?sz=128", "display_name": "Vidma", "link": "https://stackoverflow.com/users/7457604/vidma"}, "edited": false, "score": 0, "creation_date": 1485333729, "post_id": 41846542, "comment_id": 70878035, "body": "i use this post as a base of my code, but can&#39;t figure out how to pass the YEAR data from TABLE1 row  to TABLE2 YEAR column."}, {"owner": {"reputation": 1362, "user_id": 5979902, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/OmvV7.jpg?s=128&g=1", "display_name": "Martin Dreher", "link": "https://stackoverflow.com/users/5979902/martin-dreher"}, "edited": false, "score": 0, "creation_date": 1485333835, "post_id": 41846542, "comment_id": 70878109, "body": "even without PowerQuery, this is easily doable by a) automating a pivot (use the macro recorder to get you started) b) creating a sql-querytable on <code>ThisWorkbook</code> or c) just transposing the ranges if you put some effort into it."}, {"owner": {"reputation": 11, "user_id": 7457604, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-PIccOIPee7s/AAAAAAAAAAI/AAAAAAAAAB0/Iq4PVdjKUUo/photo.jpg?sz=128", "display_name": "Vidma", "link": "https://stackoverflow.com/users/7457604/vidma"}, "reply_to_user": {"reputation": 1362, "user_id": 5979902, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/OmvV7.jpg?s=128&g=1", "display_name": "Martin Dreher", "link": "https://stackoverflow.com/users/5979902/martin-dreher"}, "edited": false, "score": 0, "creation_date": 1485334053, "post_id": 41846542, "comment_id": 70878249, "body": "@Martin Dreher I am compleatly new to vba. did you saw the code I used? It&#39;s jus need a bit of twick to fit my needs. Just can&#39;t figure out how start to read the first row of TABLE1 (excluding A1)"}, {"owner": {"reputation": 1362, "user_id": 5979902, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/OmvV7.jpg?s=128&g=1", "display_name": "Martin Dreher", "link": "https://stackoverflow.com/users/5979902/martin-dreher"}, "edited": false, "score": 0, "creation_date": 1485334097, "post_id": 41846542, "comment_id": 70878278, "body": "sry, corporate IT blocked me from getting there. couldnt read it. imo this shouldnt require too much code.... looking into it, let&#163;s see with what i can come up"}, {"owner": {"reputation": 11, "user_id": 7457604, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-PIccOIPee7s/AAAAAAAAAAI/AAAAAAAAAB0/Iq4PVdjKUUo/photo.jpg?sz=128", "display_name": "Vidma", "link": "https://stackoverflow.com/users/7457604/vidma"}, "reply_to_user": {"reputation": 1362, "user_id": 5979902, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/OmvV7.jpg?s=128&g=1", "display_name": "Martin Dreher", "link": "https://stackoverflow.com/users/5979902/martin-dreher"}, "edited": false, "score": 0, "creation_date": 1485416254, "post_id": 41846542, "comment_id": 70919446, "body": "@Martin Dreher maybe the image get you wrong. I just placed the both sheets in one window as there was error message saying I can&#39;t use more than two links on my post. so, the idea is that i have TABLE1 in SHEET1 and in same sheet I have Active-X button with VBA code. When you run code you get the new sheet (and each time you click it generates the increading number of sheet) where you get the outcome of TABLE2. I do not need the outcome in same sheet. Also, the data is dinamic and there will be different quantities of countries and data."}, {"owner": {"reputation": 1362, "user_id": 5979902, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/OmvV7.jpg?s=128&g=1", "display_name": "Martin Dreher", "link": "https://stackoverflow.com/users/5979902/martin-dreher"}, "edited": false, "score": 0, "creation_date": 1485417250, "post_id": 41846542, "comment_id": 70919823, "body": "The obvious solution to that is to use <code>With ThisWorkbook.Worksheets(&quot;sheet50&quot;)</code> to <code>With ThisWorkbook.Worksheets.Add</code> and then create your query table on <code>Destination:=.Cells(1, 1)</code>."}], "answers": [{"tags": [], "owner": {"reputation": 1362, "user_id": 5979902, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/OmvV7.jpg?s=128&g=1", "display_name": "Martin Dreher", "link": "https://stackoverflow.com/users/5979902/martin-dreher"}, "is_accepted": false, "score": 0, "last_activity_date": 1485338062, "last_edit_date": 1495540376, "creation_date": 1485336396, "answer_id": 41847827, "question_id": 41846542, "link": "https://stackoverflow.com/questions/41846542/vba-convert-rows-to-columns/41847827#41847827", "title": "VBA convert rows to columns", "body": "<p>K, might aswell give you some hints on how I would do this based on the information I have.</p>\n\n<p>I recon there's a ton of ways to achieve this...</p>\n\n<ul>\n<li>by automating a <code>PivotTable</code>-Object</li>\n<li>by creating a <code>Recordset</code>, then looping it's records and field-names <a href=\"https://stackoverflow.com/questions/41543005/vba-speeding-up-code/41546220#41546220\">as shown in this example</a></li>\n<li>by looping your Table1-<code>Range</code> in the x and y direction (like you do)</li>\n<li>or, as described below, using a <code>QueryTable</code> with some basic <code>SQL</code></li>\n</ul>\n\n<p><strong>Using a query table:</strong></p>\n\n<p>A query table is basically a link to some external data (a textfile, a database, another excel-doc).</p>\n\n<p>Points i like about query tables:</p>\n\n<ul>\n<li>connects to virtually any data source</li>\n<li>needs to be set-up once, can be refreshed afterwards</li>\n<li>changes to it's content (filters, additional columns, order, calculated fields) can be made with basic <a href=\"http://www.w3schools.com/sql/default.asp\" rel=\"nofollow noreferrer\">SQL-knowledge</a>, eliminating the need to overthink some VBA-logic.</li>\n</ul>\n\n<p>For our purpose, it is largely described with two properties (there's more to it, but we keep it simple):</p>\n\n<ul>\n<li><p>The <code>Connection</code> / <code>ConnectionString</code> stores information on your linked data (filetype, location, etc). In our case, this is the exact Excel-File we're working on. Check out <a href=\"https://www.connectionstrings.com/\" rel=\"nofollow noreferrer\">connectionstrings.com</a> for more info on other fiole-types.</p>\n\n<p>Here's how your <code>Connection</code> will likely look, assuming you use an <code>xlsm</code>-File:</p>\n\n<pre><code>OLEDB;Provider=Microsoft.ACE.OLEDB.12.0;;Password=;User ID=Admin;\nMode=Share Deny Write;\nData Source=I:\\yourfolder\\ThisFile.xlsm;\nExtended Properties=\"Excel 12.0 Macro;HDR=YES\"\n</code></pre>\n\n<p>To keep things simple, paste this into <strong>one</strong> cell and read it into a string-variable with <code>con = YourSheet.Cells(1,1)</code>. Editing it in a cell is a lot more comfortable than inside VBA.</p></li>\n<li><p>the <code>CommandText</code> stores information on what data to get. We use <code>CommandType = xlCmdSql</code> here, which means that our <code>CommandText</code> will be an SQL-String, closely resembling this one:</p>\n\n<pre><code>SELECT Country, \"1990\" as y1, [1990] AS y_value\nFROM [Tabelle1$A2:G5]\nUNION ALL\nSELECT Country, \"1991\" as y1, [1991] AS y_value\nFROM [Tabelle1$A2:G5]\nUNION ALL\nSELECT Country, \"1992\" as y1, [1992] AS y_value\nFROM [Tabelle1$A2:G5]\n....\n</code></pre>\n\n<p>Again, paste this into <strong>one</strong> cell, adjust the Excel-ranges to your Table1-Range, and read it into a string variable with <code>cmd = YourSheet.Cells(1,2)</code>. </p>\n\n<p>Note: creating this SQL is obviously the messy part if you got 10+years. In that case, find a way to write the SQL semi-automatically, e.g. with formulas, and then concatenate them into one string.</p></li>\n<li><p>This gets us started. We now can create a <code>QueryTable</code> with the aforementioned properties. The final sub looks something like </p>\n\n<pre><code>Option Explicit\n\nSub CreateQT()\n\n    With ThisWorkbook.Worksheets(\"sheet50\")\n\nchkQT:\n        If .QueryTables.Count &gt; 0 Then .QueryTables(.QueryTables.Count).Delete: GoTo chkQT\n\n        Dim con As String\n        con = .range(\"con\").Value\n        Dim cmd As String\n        cmd = .range(\"cmd\").Value\n\n        With .QueryTables.Add(Connection:=con, Destination:=.Cells(10, 1))\n\n            .CommandType = xlCmdSql\n            .CommandText = cmd\n\n            .FieldNames = True\n            .RowNumbers = False\n            .FillAdjacentFormulas = False\n            .PreserveFormatting = True\n            .RefreshOnFileOpen = False\n            .BackgroundQuery = False\n            .SaveData = True\n            .AdjustColumnWidth = True\n            .PreserveColumnInfo = True\n            .RefreshStyle = xlOverwriteCells\n            .RefreshPeriod = 0\n            .Refresh BackgroundQuery:=False\n            .MaintainConnection = False\n        End With\n    End With\n\nEnd Sub\n</code></pre>\n\n<p>This code contains some properties you might not need, however, since this isn't much of a performance issue, we can always get rid of them later.</p></li>\n</ul>\n\n<p>Works for me, let me know if you need any help.</p>\n\n<p><a href=\"https://i.stack.imgur.com/JE3RP.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/JE3RP.png\" alt=\"enter image description here\"></a></p>\n\n<p>Hope this helps.</p>\n"}, {"comments": [{"owner": {"reputation": 11, "user_id": 7457604, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-PIccOIPee7s/AAAAAAAAAAI/AAAAAAAAAB0/Iq4PVdjKUUo/photo.jpg?sz=128", "display_name": "Vidma", "link": "https://stackoverflow.com/users/7457604/vidma"}, "edited": false, "score": 0, "creation_date": 1485415971, "post_id": 41848153, "comment_id": 70919339, "body": "sorry, but the VBA is complytly not suiting and with non VBA  I get errors"}, {"owner": {"reputation": 1362, "user_id": 5979902, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/OmvV7.jpg?s=128&g=1", "display_name": "Martin Dreher", "link": "https://stackoverflow.com/users/5979902/martin-dreher"}, "edited": false, "score": 0, "creation_date": 1485418016, "post_id": 41848153, "comment_id": 70920165, "body": "Consider the possibility that the VBA code is suiting (since it is), and that you described your problem incompletely (therefore Marco is using <code>Sheet50</code> instead of <code>Worksheets.Add</code>). If you get trouble adjusting this simplest of all possible solutions to your needs, you should aquire some basic VBA knowledge first."}, {"owner": {"reputation": 11, "user_id": 7457604, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-PIccOIPee7s/AAAAAAAAAAI/AAAAAAAAAB0/Iq4PVdjKUUo/photo.jpg?sz=128", "display_name": "Vidma", "link": "https://stackoverflow.com/users/7457604/vidma"}, "reply_to_user": {"reputation": 1362, "user_id": 5979902, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/OmvV7.jpg?s=128&g=1", "display_name": "Martin Dreher", "link": "https://stackoverflow.com/users/5979902/martin-dreher"}, "edited": false, "score": 0, "creation_date": 1485418554, "post_id": 41848153, "comment_id": 70920397, "body": "@Martin Dreher you right Marting as I said I have no knowledge of VBA at all. That&#39;s why I found the code suiting me of 90% ans ask here for help for that 10%. It&#39;s shame I cant post the code here, and not sure if you saw it but if there is way to tweek it  it would be enough for me. Or rpobably I am on the wrong site. Can you tel me some other site I can use to get hepl. thanks"}, {"owner": {"reputation": 2182, "user_id": 4721281, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/9ca3ef336c479bc32997b548b75e7c24?s=128&d=identicon&r=PG&f=1", "display_name": "MGP", "link": "https://stackoverflow.com/users/4721281/mgp"}, "reply_to_user": {"reputation": 11, "user_id": 7457604, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-PIccOIPee7s/AAAAAAAAAAI/AAAAAAAAAB0/Iq4PVdjKUUo/photo.jpg?sz=128", "display_name": "Vidma", "link": "https://stackoverflow.com/users/7457604/vidma"}, "edited": false, "score": 0, "creation_date": 1485418799, "post_id": 41848153, "comment_id": 70920520, "body": "@Vidma please see the eddited code. This should do, what you want."}, {"owner": {"reputation": 11, "user_id": 7457604, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-PIccOIPee7s/AAAAAAAAAAI/AAAAAAAAAB0/Iq4PVdjKUUo/photo.jpg?sz=128", "display_name": "Vidma", "link": "https://stackoverflow.com/users/7457604/vidma"}, "edited": false, "score": 0, "creation_date": 1485419976, "post_id": 41848153, "comment_id": 70921183, "body": "Sorry, took time to understand what changes I should do. It worked perfectly. THANK YOU A LOT!"}, {"owner": {"reputation": 11, "user_id": 7457604, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-PIccOIPee7s/AAAAAAAAAAI/AAAAAAAAAB0/Iq4PVdjKUUo/photo.jpg?sz=128", "display_name": "Vidma", "link": "https://stackoverflow.com/users/7457604/vidma"}, "edited": false, "score": 0, "creation_date": 1485423757, "post_id": 41848153, "comment_id": 70923191, "body": "now i try to paste data to new workbook - Dim ws As Worksheet, ows As Workbook, nws As Worksheet Dim i As Long, j As Long, c As Long Set ws = ActiveSheet Set ows = Workbooks.Add(xlWBATWorksheet) Set nws = Worksheets.Add  and got small problem, as the new workbook opens with two sheets instead of one ... can&#39;t figure out where i am wrong ..."}, {"owner": {"reputation": 2182, "user_id": 4721281, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/9ca3ef336c479bc32997b548b75e7c24?s=128&d=identicon&r=PG&f=1", "display_name": "MGP", "link": "https://stackoverflow.com/users/4721281/mgp"}, "reply_to_user": {"reputation": 11, "user_id": 7457604, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-PIccOIPee7s/AAAAAAAAAAI/AAAAAAAAAB0/Iq4PVdjKUUo/photo.jpg?sz=128", "display_name": "Vidma", "link": "https://stackoverflow.com/users/7457604/vidma"}, "edited": false, "score": 0, "creation_date": 1485424104, "post_id": 41848153, "comment_id": 70923399, "body": "@Vidma You want to create a new Workbook for every time you run the Sub, instead of a new sheet?"}, {"owner": {"reputation": 11, "user_id": 7457604, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-PIccOIPee7s/AAAAAAAAAAI/AAAAAAAAAB0/Iq4PVdjKUUo/photo.jpg?sz=128", "display_name": "Vidma", "link": "https://stackoverflow.com/users/7457604/vidma"}, "edited": false, "score": 0, "creation_date": 1485428913, "post_id": 41848153, "comment_id": 70925979, "body": "@Marco Getrost Yes, and now I fugered out how to do that - Dim ws As Worksheet, ows As Workbook, nws As Worksheet Dim i As Long, j As Long, c As Long Set ws = ActiveSheet Set ows = Workbooks.Add(xlWBATWorksheet) Set nws = Sheets(&quot;Sheet1&quot;) -   but run in problemmulti languages. One machine has english and &quot;Sheet1&quot; works fine, but another one has lithuanian and the new workbook has sheet named as &quot;Lapas1&quot; and I get error  .. need to find the way to have some language dependant code of Set nws = Sheets(&quot;Sheet1&quot;)"}, {"owner": {"reputation": 2182, "user_id": 4721281, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/9ca3ef336c479bc32997b548b75e7c24?s=128&d=identicon&r=PG&f=1", "display_name": "MGP", "link": "https://stackoverflow.com/users/4721281/mgp"}, "edited": false, "score": 0, "creation_date": 1485429088, "post_id": 41848153, "comment_id": 70926054, "body": "@ Vidma What you could do is instead of refering to the sheet via Set nws = Sheets(&quot;Sheet1&quot;), you could do this: Set nws = Sheets(1) if its in the first position. But then it will always have to be on the same position."}], "tags": [], "owner": {"reputation": 2182, "user_id": 4721281, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/9ca3ef336c479bc32997b548b75e7c24?s=128&d=identicon&r=PG&f=1", "display_name": "MGP", "link": "https://stackoverflow.com/users/4721281/mgp"}, "is_accepted": false, "score": 1, "last_activity_date": 1485418768, "last_edit_date": 1485418768, "creation_date": 1485337313, "answer_id": 41848153, "question_id": 41846542, "link": "https://stackoverflow.com/questions/41846542/vba-convert-rows-to-columns/41848153#41848153", "title": "VBA convert rows to columns", "body": "<p>Assuming you use the Setup as shown in your example, this worked for me: </p>\n\n<pre><code>Sub tt()\n\nDim ws As Worksheet, nws As Worksheet\nDim i As Long, j As Long, c As Long\nSet ws = ActiveSheet\nSet nws = Worksheets.Add\ni = 0\nc = 0\n\nnws.Range(\"A1\").Value = \"Country\"\nnws.Range(\"B1\").Value = \"Year\"\nnws.Range(\"C1\").Value = \"Value\"\nnws.Range(\"D1\").Value = \"Text\"\nDo While ws.Cells(2 + i, 1).Value &lt;&gt; \"\"\n    j = 0\n    Do While ws.Cells(1, 2 + j).Value &lt;&gt; \"\"\n\n        nws.Cells(2 + c, 1).Value = ws.Cells(2 + i, 1).Value\n        nws.Cells(2 + c, 2).Value = ws.Cells(1, 2 + j).Value\n        nws.Cells(2 + c, 3).Value = ws.Cells(2 + i, 2 + j).Value\n        nws.Cells(2 + c, 4).Value = \"YES\"\n        c = c + 1\n        j = j + 1\n    Loop\n    i = i + 1\nLoop\n\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p>For a non-VBa Solution, you can do this with the native Worksheets-Functions like such:</p>\n\n<p>Assuming you have the setup like in the picture put these Formulas in A9, B9 and C9 and drag down as suited:</p>\n\n<p>For A9;</p>\n\n<pre><code>=INDIRECT(CONCATENATE(\"A\",ROUNDDOWN((ROW(1:1)-1)/COUNTA($B$2:$G$2),0)+3))\n</code></pre>\n\n<p>For B9:</p>\n\n<pre><code>=INDEX($B$2:$G$2,MOD((ROW(1:1)-1),COUNTA($B$2:$G$2))+1)\n</code></pre>\n\n<p>For C9:</p>\n\n<pre><code>=INDEX($A$3:$G$5,MATCH(E9,$A$3:$A$5,0),MOD(ROW(1:1)-1,COUNTA($B$2:$G$2))+2)\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 7457604, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-PIccOIPee7s/AAAAAAAAAAI/AAAAAAAAAB0/Iq4PVdjKUUo/photo.jpg?sz=128", "display_name": "Vidma", "link": "https://stackoverflow.com/users/7457604/vidma"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2028, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1485418768, "creation_date": 1485332459, "last_edit_date": 1485333578, "question_id": 41846542, "link": "https://stackoverflow.com/questions/41846542/vba-convert-rows-to-columns", "title": "VBA convert rows to columns", "body": "<p>I try to make convertion from TABLE1 to TABLE2</p>\n\n<p><img src=\"https://i.stack.imgur.com/ERfev.jpg\" alt=\"TABLES\"></p>\n\n<p>using vba </p>\n\n<pre><code>code should go here, but when i paste it, i got erro that I have to much    code\n</code></pre>\n\n<p>so, i add link to TXT document <a href=\"https://1drv.ms/t/s!AiWBl-dHp1isc0y9gOdQzJCBr7g\" rel=\"nofollow noreferrer\">vba code</a></p>\n\n<p>but can't figure out how to move the YEAR data from TABLE1 B1:G1 to column B of TABLE2.</p>\n"}, {"tags": ["sql-server", "excel", "vba", "ssis"], "answers": [{"comments": [{"owner": {"reputation": 719, "user_id": 1113251, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/3dd1b402ab75a80e146321e9267fdd07?s=128&d=identicon&r=PG", "display_name": "James Khan", "link": "https://stackoverflow.com/users/1113251/james-khan"}, "edited": false, "score": 0, "creation_date": 1485425116, "post_id": 41847563, "comment_id": 70923946, "body": "I will test this . What then happens to the failed files ? How can I only move the processed files in the same loop and not the failed files ? Maybe I can check for the Site in the Import table and take that down another path. Hmmmmm"}], "tags": [], "owner": {"reputation": 238, "user_id": 7462678, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4df877a81ee2390c7d2e181b33023c4f?s=128&d=identicon&r=PG&f=1", "display_name": "LS_85", "link": "https://stackoverflow.com/users/7462678/ls-85"}, "is_accepted": true, "score": 1, "last_activity_date": 1485335711, "last_edit_date": 1592644375, "creation_date": 1485335711, "answer_id": 41847563, "question_id": 41846449, "link": "https://stackoverflow.com/questions/41846449/continuation-after-excel-file-import-error/41847563#41847563", "title": "Continuation after Excel File Import Error", "body": "<p>You can achieve this by setting the task property ForceExecutionResult to Success.\nIf you are looking for something more <a href=\"https://www.mssqltips.com/sqlservertip/3575/continue-a-foreach-loop-after-an-error-in-a-sql-server-integration-services-package/\" rel=\"nofollow noreferrer\">robust</a></p>\n"}], "owner": {"reputation": 719, "user_id": 1113251, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/3dd1b402ab75a80e146321e9267fdd07?s=128&d=identicon&r=PG", "display_name": "James Khan", "link": "https://stackoverflow.com/users/1113251/james-khan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 35, "favorite_count": 0, "accepted_answer_id": 41847563, "answer_count": 1, "score": 1, "last_activity_date": 1485335711, "creation_date": 1485332065, "question_id": 41846449, "link": "https://stackoverflow.com/questions/41846449/continuation-after-excel-file-import-error", "title": "Continuation after Excel File Import Error", "body": "<p>Probably a basic SSIS question ...</p>\n\n<p>I have a Loop Container which loops over a directory of Excel File and imports and moves each individual file to another folder ( About 380 Excel Files). </p>\n\n<p>Please no comments about not using a robust file format for importing that volume of files in SSIS, as I completely agree.</p>\n\n<p>The problem I have is that many of the Excel Files, about 80 had Excel File import Errors and I had to stop , put the problem file aside and restart about 20 times before I could identify all the problem Excel files to manually fix. </p>\n\n<p>So is there any way I can get the process to skip problem Excel Files that cause the Excel source in the Data Flow to go RED, and just process all the good files?</p>\n\n<p>Finding a solution to this will save me at least an hour when running the process ?</p>\n\n<p>This is SSIS 2008.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1775, "user_id": 5066895, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/bHw56.png?s=128&g=1", "display_name": "Dieter Meemken", "link": "https://stackoverflow.com/users/5066895/dieter-meemken"}, "edited": false, "score": 0, "creation_date": 1485331724, "post_id": 41846305, "comment_id": 70876828, "body": "Can you explain a bit more?"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 7467534, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b7c4f94aaeea5e3fc69b7266b1d52ca4?s=128&d=identicon&r=PG&f=1", "display_name": "Aghil", "link": "https://stackoverflow.com/users/7467534/aghil"}, "edited": false, "score": 0, "creation_date": 1485839040, "post_id": 41849516, "comment_id": 71079722, "body": "Thank you for the reply, Can you share me your mail-id so that i can share   my text file with you. mean while i will try the code what you have send and very sorry for the late reply, i was on vacation,"}, {"owner": {"reputation": 1, "user_id": 7467534, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b7c4f94aaeea5e3fc69b7266b1d52ca4?s=128&d=identicon&r=PG&f=1", "display_name": "Aghil", "link": "https://stackoverflow.com/users/7467534/aghil"}, "edited": false, "score": 0, "creation_date": 1485842142, "post_id": 41849516, "comment_id": 71080794, "body": "Hi @Aeneas I tried to upload the text file here but its not working. i am getting few error when running the code. I run line by line and got error in the very first line of this if loop.                                                             If InStr(0, LineString, &quot;(Cutter PA)&quot;) &gt; 0 Then         CutterPA = Val(Split(LineString, &quot;=&quot;)(1))  End If                                                                                                         The error what i am getting is &quot; Invalid procedure call or argument&quot;"}, {"owner": {"reputation": 245, "user_id": 6593650, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a67fbc8a0efa3c4df79f5e5514586f8?s=128&d=identicon&r=PG&f=1", "display_name": "Aeneas", "link": "https://stackoverflow.com/users/6593650/aeneas"}, "reply_to_user": {"reputation": 1, "user_id": 7467534, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b7c4f94aaeea5e3fc69b7266b1d52ca4?s=128&d=identicon&r=PG&f=1", "display_name": "Aghil", "link": "https://stackoverflow.com/users/7467534/aghil"}, "edited": false, "score": 0, "creation_date": 1485858704, "post_id": 41849516, "comment_id": 71089293, "body": "I removed the optional parameter from the InStr function. Please try again"}], "tags": [], "owner": {"reputation": 245, "user_id": 6593650, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a67fbc8a0efa3c4df79f5e5514586f8?s=128&d=identicon&r=PG&f=1", "display_name": "Aeneas", "link": "https://stackoverflow.com/users/6593650/aeneas"}, "is_accepted": false, "score": 0, "last_activity_date": 1485858626, "last_edit_date": 1485858626, "creation_date": 1485341098, "answer_id": 41849516, "question_id": 41846305, "link": "https://stackoverflow.com/questions/41846305/how-to-import-specific-data-from-a-notepad-to-excel-worksheet-using-vba/41849516#41849516", "title": "How to import specific data from a Notepad to Excel Worksheet using VBA", "body": "<p>Something along these lines should work. I haven't got your text file to test but you should be able to work it out from it....</p>\n\n<pre><code>Sub ImportText()\n\nDim LineString As String\nDim sSourceFile As String\nDim r As Long\nDim fLen As Long\nDim fn As Integer\nDim CutterPA, CutterBR, CutterRad As Double\n\n'Text file and path\nsSourceFile = \"C:\\filtest.txt\"\n\n'sSourceFile doesn't exist\nIf Len(Dir(sSourceFile)) = 0 Then Exit Sub\n\n'Gets a free file number from the operating system\nfn = FreeFile\n\n'Opens the file for input\nOpen sSourceFile For Input As #fn\nfLen = LOF(fn)\nr = 2\nWhile Not EOF(fn)\n   Line Input #fn, LineString\n\n    If InStr(LineString, \"(Cutter PA)\") &gt; 0 Then\n        CutterPA = Val(Split(LineString, \"=\")(1))\n    End If\n\n    If InStr(LineString, \"(Cutter BR)\") &gt; 0 Then\n        CutterBR = Val(Split(LineString, \"=\")(1))\n    End If\n\n    If InStr(LineString, \"(Cutter Radius)\") &gt; 0 Then\n        CutterRad = Val(Split(LineString, \"=\")(1))\n    End If\n\n    'Write values if new item\n    If InStr(LineString, \"(***********\") &gt; 0 Then\n        With ActiveSheet\n            .Cells(r, 1).Value = CutterPA\n            .Cells(r, 2).Value = CutterBR\n            .Cells(r, 3).Value = CutterRad\n        End With\n\n        r = r + 1\n    End If\n\n\nWend\n\n'Closes the text file\nClose #fn\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 7467534, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b7c4f94aaeea5e3fc69b7266b1d52ca4?s=128&d=identicon&r=PG&f=1", "display_name": "Aghil", "link": "https://stackoverflow.com/users/7467534/aghil"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 154, "favorite_count": 0, "answer_count": 1, "score": -5, "last_activity_date": 1485858626, "creation_date": 1485331518, "last_edit_date": 1485335245, "question_id": 41846305, "link": "https://stackoverflow.com/questions/41846305/how-to-import-specific-data-from-a-notepad-to-excel-worksheet-using-vba", "title": "How to import specific data from a Notepad to Excel Worksheet using VBA", "body": "<p>First i will show how exactly my notepad looks.Please see the attached image. Then i will explain what i am looking for.</p>\n\n<p><a href=\"https://i.stack.imgur.com/dNq87.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/dNq87.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>From this i want to import the  \"Cutter PA Value', Cutter BR Value &amp; Cutter Radius Value into separate column's of excel worksheet. My Excel sheet will have column names as Cutter PA, Cutter Radius, Cutter BR. i want notepad values to be feed inside each corresponding column.\nPlease guide me how to solve this problem.</p>\n"}, {"tags": ["excel", "excel-2010", "vba"], "answers": [{"tags": [], "owner": {"reputation": 533, "user_id": 7315468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f038bb9934e81791e469421adef9d645?s=128&d=identicon&r=PG&f=1", "display_name": "Vinnie", "link": "https://stackoverflow.com/users/7315468/vinnie"}, "is_accepted": false, "score": 0, "last_activity_date": 1485331914, "creation_date": 1485331914, "answer_id": 41846414, "question_id": 41846209, "link": "https://stackoverflow.com/questions/41846209/excel-modify-macro-for-data-from-text-to-open-dialog-box/41846414#41846414", "title": "Excel modify macro for &quot;data from text&quot; to open dialog box?", "body": "<p>Try this:</p>\n\n<pre><code>Path = Application.GetOpenFilename()\n    With ActiveSheet.QueryTables.Add(Connection:= _\n        \"TEXT;\" &amp; Path, Destination:=Range(\"$A$1\"))\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 23, "user_id": 7463058, "user_type": "registered", "profile_image": "https://graph.facebook.com/10202721807322316/picture?type=large", "display_name": "Tony Georgiev", "link": "https://stackoverflow.com/users/7463058/tony-georgiev"}, "edited": false, "score": 0, "creation_date": 1485416695, "post_id": 41846418, "comment_id": 70919604, "body": "Thanks! Works like a charm. Could you just explain line 15 &quot;.Name = &quot;filename&quot;&quot; &quot;filename&quot; was put by me there to censor my actual used filename.  When I first recorded the macro it used to be &quot;.Name = &quot;&lt;my file&#39;s actual name&gt;&quot;  So in reality this &quot;filename&quot; that is there right now relates to absolutely nothing yet it causes no problems - why is that? could it cause any problems in some situations?  Thanks!"}, {"owner": {"reputation": 423, "user_id": 4288279, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-MrInmPwcjiM/AAAAAAAAAAI/AAAAAAAAAUA/FdUlqZL2p5I/photo.jpg?sz=128", "display_name": "Tackgnol", "link": "https://stackoverflow.com/users/4288279/tackgnol"}, "reply_to_user": {"reputation": 23, "user_id": 7463058, "user_type": "registered", "profile_image": "https://graph.facebook.com/10202721807322316/picture?type=large", "display_name": "Tony Georgiev", "link": "https://stackoverflow.com/users/7463058/tony-georgiev"}, "edited": false, "score": 0, "creation_date": 1485428048, "post_id": 41846418, "comment_id": 70925495, "body": "Hi as far as I see in the documentation <a href=\"https://msdn.microsoft.com/en-us/library/office/ff820914.aspx\" rel=\"nofollow noreferrer\">link</a>  The name can be anything you want it to be :) so you can replace that particular piece of code with anything. If you go in Excel Data -&gt; Connections you will see it is under your filename. You can however use this name to refer to it in VBA: ActiveSheet.QueryTables(&quot;filename&quot;)."}], "tags": [], "owner": {"reputation": 423, "user_id": 4288279, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-MrInmPwcjiM/AAAAAAAAAAI/AAAAAAAAAUA/FdUlqZL2p5I/photo.jpg?sz=128", "display_name": "Tackgnol", "link": "https://stackoverflow.com/users/4288279/tackgnol"}, "is_accepted": true, "score": 1, "last_activity_date": 1485331926, "creation_date": 1485331926, "answer_id": 41846418, "question_id": 41846209, "link": "https://stackoverflow.com/questions/41846209/excel-modify-macro-for-data-from-text-to-open-dialog-box/41846418#41846418", "title": "Excel modify macro for &quot;data from text&quot; to open dialog box?", "body": "<p>Hey I have modified your code: </p>\n\n<pre><code>Sub random_name()\n'\n' random_name Macro\n'\n\n'\nDim connectioString As String\n\nconnectioString = \"TEXT;\" &amp; ListFile\n\n\n    With ActiveSheet.QueryTables.Add(Connection:= _\n        connectioString _\n        , Destination:=Range(\"$A$1\"))\n        .Name = \"filename\"\n        .FieldNames = True\n        .RowNumbers = False\n        .FillAdjacentFormulas = False\n        .PreserveFormatting = True\n        .RefreshOnFileOpen = False\n        .RefreshStyle = xlInsertDeleteCells\n        .SavePassword = False\n        .SaveData = True\n        .AdjustColumnWidth = True\n        .RefreshPeriod = 0\n        .TextFilePromptOnRefresh = False\n        .TextFilePlatform = 1252\n        .TextFileStartRow = 1\n        .TextFileParseType = xlDelimited\n        .TextFileTextQualifier = xlTextQualifierDoubleQuote\n        .TextFileConsecutiveDelimiter = False\n        .TextFileTabDelimiter = True\n        .TextFileSemicolonDelimiter = False\n        .TextFileCommaDelimiter = False\n        .TextFileSpaceDelimiter = False\n        .TextFileColumnDataTypes = Array(1, 1, 1, 1, 1, 1, 2, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, _\n        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1)\n        .TextFileTrailingMinusNumbers = True\n        .Refresh BackgroundQuery:=False\n    End With\nEnd Sub\n</code></pre>\n\n<p>beneth this paste this function: </p>\n\n<pre><code>Function ListFile()\n' ----- Creating a dialog object -----------------------------------\n    Dim oDiag As FileDialog\n    Dim vrtSelectedItem As Variant\n    Dim i As Integer\n    Set oDiag = Application.FileDialog(msoFileDialogFilePicker)\n    i = 0\n    With oDiag\n' ----- Going thru all of the files --------------------------------\n        .AllowMultiSelect = False\n        If .Show = -1 Then\n\n           ListFile = .SelectedItems(1)\n\n        End If\n    End With\n\n    Set oDiag = Nothing\n\nEnd Function\n</code></pre>\n\n<p>I am not at this point a 100% sure if filedialog required a reference tell me if it works :)</p>\n"}], "owner": {"reputation": 23, "user_id": 7463058, "user_type": "registered", "profile_image": "https://graph.facebook.com/10202721807322316/picture?type=large", "display_name": "Tony Georgiev", "link": "https://stackoverflow.com/users/7463058/tony-georgiev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 335, "favorite_count": 0, "accepted_answer_id": 41846418, "answer_count": 2, "score": 1, "last_activity_date": 1485331926, "creation_date": 1485331042, "last_edit_date": 1531161705, "question_id": 41846209, "link": "https://stackoverflow.com/questions/41846209/excel-modify-macro-for-data-from-text-to-open-dialog-box", "title": "Excel modify macro for &quot;data from text&quot; to open dialog box?", "body": "<p>So I work with CSV files and I need to open excel go to Data -> From text and format certain columns certain ways.\nI recorded a macro that does that but it always opens the file I used when recording the macro. \nHow do I modify the macro so it opens the dialog box and let me choose a file each time? \nI found this piece of code on the internet but I don't know how to integrate it with my recorded macro in VBA.</p>\n\n<pre><code>Dim MyFile As String\nMyFile = Application.GetOpenFilename()\n</code></pre>\n\n<p>Now how and where and what do I replace in the below macro (the code for which is created using the \"record macro\" button in excel)?</p>\n\n<pre><code>Sub random_name()\n'\n' random_name Macro\n'\n\n'\n    With ActiveSheet.QueryTables.Add(Connection:= _\n        \"TEXT;MyFile = Application.GetOpenFilename()\" _\n        , Destination:=Range(\"$A$1\"))\n        .Name = \"filename\"\n        .FieldNames = True\n        .RowNumbers = False\n        .FillAdjacentFormulas = False\n        .PreserveFormatting = True\n        .RefreshOnFileOpen = False\n        .RefreshStyle = xlInsertDeleteCells\n        .SavePassword = False\n        .SaveData = True\n        .AdjustColumnWidth = True\n        .RefreshPeriod = 0\n        .TextFilePromptOnRefresh = False\n        .TextFilePlatform = 1252\n        .TextFileStartRow = 1\n        .TextFileParseType = xlDelimited\n        .TextFileTextQualifier = xlTextQualifierDoubleQuote\n        .TextFileConsecutiveDelimiter = False\n        .TextFileTabDelimiter = True\n        .TextFileSemicolonDelimiter = False\n        .TextFileCommaDelimiter = False\n        .TextFileSpaceDelimiter = False\n        .TextFileColumnDataTypes = Array(1, 1, 1, 1, 1, 1, 2, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, _\n        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1)\n        .TextFileTrailingMinusNumbers = True\n        .Refresh BackgroundQuery:=False\n    End With\nEnd Sub\n</code></pre>\n\n<p>Thanks!</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 101, "user_id": 7439308, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/c98a75eb1c0cde73ac464852b9a3e2f0?s=128&d=identicon&r=PG&f=1", "display_name": "stack mark", "link": "https://stackoverflow.com/users/7439308/stack-mark"}, "edited": false, "score": 0, "creation_date": 1485336754, "post_id": 41846529, "comment_id": 70880001, "body": "Thank you. What If I need to color SATURDAY (entries after 18:00) , if it is greater than 1? @R3uK"}, {"owner": {"reputation": 101, "user_id": 7439308, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/c98a75eb1c0cde73ac464852b9a3e2f0?s=128&d=identicon&r=PG&f=1", "display_name": "stack mark", "link": "https://stackoverflow.com/users/7439308/stack-mark"}, "edited": false, "score": 0, "creation_date": 1485338220, "post_id": 41846529, "comment_id": 70881007, "body": "It works for SATURDAY. But How will it check the time I need to color it only if the time is more than 18:00"}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "reply_to_user": {"reputation": 101, "user_id": 7439308, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/c98a75eb1c0cde73ac464852b9a3e2f0?s=128&d=identicon&r=PG&f=1", "display_name": "stack mark", "link": "https://stackoverflow.com/users/7439308/stack-mark"}, "edited": false, "score": 0, "creation_date": 1485338340, "post_id": 41846529, "comment_id": 70881096, "body": "@stackmark : Apparently, you didn&#39;t see the 2nd test : <code>TimeValue(.Range(&quot;K&quot; &amp; r))&gt;TimeValue(&quot;18:00:00&quot;)</code> ;)"}], "tags": [], "owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "is_accepted": true, "score": 1, "last_activity_date": 1485337240, "last_edit_date": 1485337240, "creation_date": 1485332410, "answer_id": 41846529, "question_id": 41846017, "link": "https://stackoverflow.com/questions/41846017/ignore-saturday-value-in-vba/41846529#41846529", "title": "Ignore saturday value in VBA", "body": "<p>Logically, there is no need to add that test :</p>\n\n<ul>\n<li>Your first test is to check if the date is a SUNDAY</li>\n<li>If it is not, you won't go further for that row</li>\n<li>So if the date is a SATURDAY, you won't color anything!</li>\n</ul>\n\n<p>I've modified a bit your code :</p>\n\n<ul>\n<li>As you declared your variables <code>r</code> and <code>lastrow</code> were <code>Variant</code>s!</li>\n<li>I've added a reference to the sheet (here <code>Sheet1</code>) to increase robustness and performance</li>\n</ul>\n\n<p>Here is your code :</p>\n\n<pre><code>Sub SundayDatefilter()\nApplication.ScreenUpdating = False\nDim wS As Worksheet, _\n    r As Long, _\n    LastRow As Long, _\n    RemainingDay As Long\n\nSet wS = ThisWorkbook.Sheets(\"Sheet1\")\nWith wS\n    LastRow = .Range(\"M:P\").Cells(.Rows.Count, \"A\").End(xlUp).Row\n   For r = 2 To LastRow\n      RemainingDay = 0\n        If Weekday(.Range(\"K\" &amp; r).Value, vbSunday) = 1 Then\n            RemainingDay = Round((24 - Format(TimeValue(.Range(\"K\" &amp; r)), \"h\")) / 24, 1)\n\n            If InStr(1, .Range(\"P\" &amp; r).Text, \"*Moved to SA*\", vbTextCompare) &gt; 0 Then\n\n                If .Range(\"M\" &amp; r) - RemainingDay &gt;= 1 Then\n                    .Range(\"M\" &amp; r).Cells.Font.ColorIndex = 3\n                Else\n                    .Range(\"M\" &amp; r).Cells.Font.ColorIndex = 0\n                End If\n            End If\n        End If\n        If Weekday(.Range(\"K\" &amp; r).Value, vbSunday) = 7 and TimeValue(.Range(\"K\" &amp; r))&gt;TimeValue(\"18:00:00\") Then\n            RemainingDay = Round((24 - Format(TimeValue(.Range(\"K\" &amp; r)), \"h\")) / 24, 1)\n\n            If InStr(1, .Range(\"P\" &amp; r).Text, \"*Moved to SA*\", vbTextCompare) &gt; 0 Then\n\n                If .Range(\"M\" &amp; r) - RemainingDay &gt;= 1 Then\n                    .Range(\"M\" &amp; r).Cells.Font.ColorIndex = 3\n                Else\n                    .Range(\"M\" &amp; r).Cells.Font.ColorIndex = 0\n                End If\n            End If\n        End If\n    Next r\nEnd With 'wS\nApplication.ScreenUpdating = True\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 101, "user_id": 7439308, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/c98a75eb1c0cde73ac464852b9a3e2f0?s=128&d=identicon&r=PG&f=1", "display_name": "stack mark", "link": "https://stackoverflow.com/users/7439308/stack-mark"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 36, "favorite_count": 0, "accepted_answer_id": 41846529, "answer_count": 1, "score": -2, "last_activity_date": 1485337240, "creation_date": 1485330350, "last_edit_date": 1485331415, "question_id": 41846017, "link": "https://stackoverflow.com/questions/41846017/ignore-saturday-value-in-vba", "title": "Ignore saturday value in VBA", "body": "<p>I have the below code that does the following:</p>\n\n<ol>\n<li>Checks the date in Col K</li>\n<li>If the date is a Sunday and if the \"P\" col has the text \"Moved to SA\",<br> it will not color the values in Col M in red.</li>\n</ol>\n\n<p>Example format: <code>M/D/YYY TIME - 1/22/2017 21:00</code></p>\n\n<p>What I want to add to the above logic is:</p>\n\n<ul>\n<li>The code should also check for Saturday along with the time <br>i.e. If the time on Saturday is more than 6PM (18:00), then it should not color the value in Col M.</li>\n</ul>\n\n<p>I just need to add this one condition in my code.</p>\n\n<pre><code>Sub SundayDatefilter()\n\nDim r, lastrow, remainingDay As Long\n\nlastrow = Range(\"M:P\").Cells(Rows.count, \"A\").End(xlUp).Row\n\nApplication.ScreenUpdating = False\n\n   For r = 2 To lastrow\n      remainingDay = 0\n\n     If Weekday(Range(\"K\" &amp; r).Value, vbSunday) = 1 Then\n        remainingDay = Round((24 - Format(TimeValue(Range(\"K\" &amp; r)), \"h\")) / 24, 1)\n\n        If InStr(1, Range(\"P\" &amp; r).Text, \"*Moved to SA*\", vbTextCompare) &gt; 0 Then\n           If Range(\"M\" &amp; r) - remainingDay &gt;= 1 Then\n              Range(\"M\" &amp; r).Cells.Font.ColorIndex = 3\n           Else\n              Range(\"M\" &amp; r).Cells.Font.ColorIndex = 0\n           End If\n        End If\n     End If\n  Next r\n  Application.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1485330329, "post_id": 41845520, "comment_id": 70876136, "body": "could you share your <code>Named Range</code> defintion ? what is the name of your <code>Name Range</code> ? is it Workbook level or Worksheet level ?"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 1, "creation_date": 1485330367, "post_id": 41845520, "comment_id": 70876156, "body": "If you want to set <code>myData</code> to the range on the &quot;OnlinePayees&quot; worksheet which has a &quot;name&quot; of &quot;OnlinePayeeNames&quot;, you can just use <code>Set MyData = Worksheets(&quot;OnlinePayees&quot;).Range(&quot;OnlinePayeeNames&quot;)</code>"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 7467542, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VMXnv.jpg?s=128&g=1", "display_name": "Geneous42", "link": "https://stackoverflow.com/users/7467542/geneous42"}, "edited": false, "score": 0, "creation_date": 1485329369, "post_id": 41845626, "comment_id": 70875710, "body": "I&#39;m interested in leaving the definition of the range in the worksheet rather than hard-coding it in the event macro.  I tried:"}, {"owner": {"reputation": 960, "user_id": 5151278, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-ilDIXFcHqdo/AAAAAAAAAAI/AAAAAAAADnQ/j3pEZAQLJ28/photo.jpg?sz=128", "display_name": "Maxime Port&#233;", "link": "https://stackoverflow.com/users/5151278/maxime-port%c3%a9"}, "reply_to_user": {"reputation": 1, "user_id": 7467542, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VMXnv.jpg?s=128&g=1", "display_name": "Geneous42", "link": "https://stackoverflow.com/users/7467542/geneous42"}, "edited": false, "score": 0, "creation_date": 1485329507, "post_id": 41845626, "comment_id": 70875777, "body": "Could you explain your difference between &quot;range definition&quot; and &quot;hard-coding&quot; ?"}, {"owner": {"reputation": 1, "user_id": 7467542, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VMXnv.jpg?s=128&g=1", "display_name": "Geneous42", "link": "https://stackoverflow.com/users/7467542/geneous42"}, "edited": false, "score": 0, "creation_date": 1485329911, "post_id": 41845626, "comment_id": 70875944, "body": "I&#39;m interested in leaving the definition of the range in the worksheet rather than hard-coding it in the event macro.  I tried:  msgbox Worksheets(&quot;OnlinePayees&quot;).OnlinePayeeNames.Address  where OnlinePayeeNames is the Range name, but got #438 &quot;Object doesn&#39;t support this property or method&quot;"}, {"owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "edited": false, "score": 1, "creation_date": 1485330035, "post_id": 41845626, "comment_id": 70876013, "body": "Try <code>Worksheets(&quot;OnlinePayees&quot;).Range(&quot;OnlinePayeeNames&quot;).Address</code>"}, {"owner": {"reputation": 1, "user_id": 7467542, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VMXnv.jpg?s=128&g=1", "display_name": "Geneous42", "link": "https://stackoverflow.com/users/7467542/geneous42"}, "edited": false, "score": 0, "creation_date": 1485330139, "post_id": 41845626, "comment_id": 70876050, "body": "I used &quot;Range definition&quot; to be what I defined in the woorksheet itself using the Name Manager.  &quot;Hard-coded&quot; I meant a macro statement such as  Range(&quot;A2:D100&quot;) Hope this helps."}, {"owner": {"reputation": 1, "user_id": 7467542, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VMXnv.jpg?s=128&g=1", "display_name": "Geneous42", "link": "https://stackoverflow.com/users/7467542/geneous42"}, "edited": false, "score": 0, "creation_date": 1485330334, "post_id": 41845626, "comment_id": 70876144, "body": "Ah, that is so beautiful... Thank you CLR.  I&#39;ve been programming for 50 years, but there are new wrinkles all the time."}], "tags": [], "owner": {"reputation": 960, "user_id": 5151278, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-ilDIXFcHqdo/AAAAAAAAAAI/AAAAAAAADnQ/j3pEZAQLJ28/photo.jpg?sz=128", "display_name": "Maxime Port&#233;", "link": "https://stackoverflow.com/users/5151278/maxime-port%c3%a9"}, "is_accepted": false, "score": 1, "last_activity_date": 1485328839, "creation_date": 1485328839, "answer_id": 41845626, "question_id": 41845520, "link": "https://stackoverflow.com/questions/41845520/googled-can-a-vba-function-in-excel-return-the-cell-ids-of-a-range/41845626#41845626", "title": "Googled &quot;Can a VBA function in Excel return the cell ids of a range?&quot;", "body": "<p>If you simply want the address of a Range, use</p>\n\n<pre><code>Dim MyRange as Range\nSet MyRange = Worksheets(\"Sheet1\").Range(\"A2:D100\")\n' Here do what you want\nMsgbox MyRange.Address\n</code></pre>\n\n<p>.Address will return the \"A2:D100\" address</p>\n\n<p><a href=\"https://msdn.microsoft.com/fr-fr/library/office/ff837625.aspx\" rel=\"nofollow noreferrer\">https://msdn.microsoft.com/fr-fr/library/office/ff837625.aspx</a></p>\n"}], "owner": {"reputation": 1, "user_id": 7467542, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VMXnv.jpg?s=128&g=1", "display_name": "Geneous42", "link": "https://stackoverflow.com/users/7467542/geneous42"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 40, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1523571260, "creation_date": 1485328382, "last_edit_date": 1531164843, "question_id": 41845520, "link": "https://stackoverflow.com/questions/41845520/googled-can-a-vba-function-in-excel-return-the-cell-ids-of-a-range", "title": "Googled &quot;Can a VBA function in Excel return the cell ids of a range?&quot;", "body": "<p>I believe I'm looking for the inverse of the Range Function.  I have a named range in my worksheet and in an event macro. I'm interested in getting the range definition string back, such as \"A1:A12\".   </p>\n\n<p>Here is the code I'm working on:</p>\n\n<pre><code>Private Sub UserForm_Initialize()\n    Dim MyData As Range\n    Dim r As Long\n    With Me.ListBox1\n        .RowSource = \"\"\n        Set MyData = Worksheets(\"Sheet1\").Range(\"A2:D100\")   'Adjust the range accordingly\n        .List = MyData.Cells.Value\n        For r = .ListCount - 1 To 0 Step -1\n            If .List(r, 3) = \"\" Then\n                .RemoveItem r\n            End If\n        Next r\n    End With\nEnd Sub\n</code></pre>\n\n<p>I'd rather use the name of the Range in the <code>\"Set MyData =\"</code> statement above instead of hard-coding the range in the event macro.</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 71, "user_id": 7286256, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/86af2722c80dff17ad49f97a986754a9?s=128&d=identicon&r=PG&f=1", "display_name": "Nataniell", "link": "https://stackoverflow.com/users/7286256/nataniell"}, "edited": false, "score": 0, "creation_date": 1485329212, "post_id": 41845583, "comment_id": 70875621, "body": "Perfect. Thank you. Is it possible to aply this to combinated formula like this? <code>&quot;=DATA_SELECTED!$A$2&amp;&quot; &#47; &quot;&amp;DATA_SELECTED!C2&quot;</code>"}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "reply_to_user": {"reputation": 71, "user_id": 7286256, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/86af2722c80dff17ad49f97a986754a9?s=128&d=identicon&r=PG&f=1", "display_name": "Nataniell", "link": "https://stackoverflow.com/users/7286256/nataniell"}, "edited": false, "score": 0, "creation_date": 1485330264, "post_id": 41845583, "comment_id": 70876108, "body": "yes. always use <code>&amp;</code> to concatenate every <i>member</i> of your string"}, {"owner": {"reputation": 71, "user_id": 7286256, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/86af2722c80dff17ad49f97a986754a9?s=128&d=identicon&r=PG&f=1", "display_name": "Nataniell", "link": "https://stackoverflow.com/users/7286256/nataniell"}, "edited": false, "score": 0, "creation_date": 1485332667, "post_id": 41845583, "comment_id": 70877334, "body": "<code>.Range(&quot;L3&quot;).Formula = &quot;=DATA_SELECTED!$A$&quot; &amp; (1 + iRow) &amp; &quot; &#47; &quot; &amp; &quot;DATA_SELECTED!$C$&quot; &amp; (1 + iRow)</code> That is not working for me &quot;/&quot; is writed as mathematical division not as text separator. I need that cell look like &quot;40/2&quot; but now shows &quot;20&quot;"}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "reply_to_user": {"reputation": 71, "user_id": 7286256, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/86af2722c80dff17ad49f97a986754a9?s=128&d=identicon&r=PG&f=1", "display_name": "Nataniell", "link": "https://stackoverflow.com/users/7286256/nataniell"}, "edited": false, "score": 0, "creation_date": 1485342629, "post_id": 41845583, "comment_id": 70884047, "body": "for this latter need I&#39;d go with <code>.Range(&quot;L3&quot;).Formula = &quot;=concatenate(offset(DATA_SELECTED!$A$2,&quot; &amp; iRow &amp; &quot;,0),&quot;&quot;&#47;&quot;&quot;,offset(DATA_SELECTED!$C$2,&quot; &amp; iRow &amp; &quot;,0))&quot;</code>"}], "tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": true, "score": 0, "last_activity_date": 1485328635, "creation_date": 1485328635, "answer_id": 41845583, "question_id": 41845419, "link": "https://stackoverflow.com/questions/41845419/vba-macro-for-copy-sheets-insert-formulas-and-change-row-reference-by-1/41845583#41845583", "title": "VBA - Macro for copy sheets, insert formulas and change row reference by +1", "body": "<p>maybe something like this</p>\n\n<pre><code>Option Explicit\n\nSub CopySheetsFromAList()    \n    Dim MyCell As Range, MyRange As Range\n    Dim ws As Worksheet\n    Dim iRow As Long\n\n    Set MyRange = Sheets(\"DATA\").Range(\"A1\")\n    Set MyRange = Range(MyRange, MyRange.End(xlDown))\n    Set ws = Sheets(\"Sheet1\")\n\n    For Each MyCell In MyRange\n        ws.Copy after:=Sheets(Sheets.Count)\n        iRow = iRow + 1\n        With Sheets(Sheets.Count)\n            .Name = MyCell.Value\n            .Range(\"C3\").Formula = \"=DATA_SELECTED!$M$\" &amp; (1 + iRow)\n            .Range(\"C4\").Formula = \"=DATA_SELECTED!$N$\" &amp; (1 + iRow)\n            .Range(\"C6\").Formula = \"=DATA_SELECTED!$K$\" &amp; (1 + iRow)\n            .Range(\"C7\").Formula = \"=DATA_SELECTED!$Y$\" &amp; (1 + iRow)\n        End With\n    Next MyCell    \nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 71, "user_id": 7286256, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/86af2722c80dff17ad49f97a986754a9?s=128&d=identicon&r=PG&f=1", "display_name": "Nataniell", "link": "https://stackoverflow.com/users/7286256/nataniell"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 55, "favorite_count": 0, "accepted_answer_id": 41845583, "answer_count": 1, "score": 0, "last_activity_date": 1485328635, "creation_date": 1485327975, "last_edit_date": 1531164843, "question_id": 41845419, "link": "https://stackoverflow.com/questions/41845419/vba-macro-for-copy-sheets-insert-formulas-and-change-row-reference-by-1", "title": "VBA - Macro for copy sheets, insert formulas and change row reference by +1", "body": "<p>I have macro for copy one sample sheet. Numbers of sheets copies are based by different sheet values. I need insert different formulas for every copy to specific range, where row number of formula is elevated by +1. Is it possible to do this?</p>\n\n<p>Example what I need: </p>\n\n<pre><code>- Sheet1 \"=DATA_SELECTED!$N$2\"\n- Sheet2 \"=DATA_SELECTED!$N$3\"\n- Sheet3 \"=DATA_SELECTED!$N$4\"\n</code></pre>\n\n<p>This is what I have right now without +1 in formulas.   </p>\n\n<pre><code>Sub CopySheetsFromAList()\n\nDim MyCell As Range, MyRange As Range\n\nSet MyRange = Sheets(\"DATA\").Range(\"A1\")\nSet MyRange = Range(MyRange, MyRange.End(xlDown))\nSet ws = Sheets(\"Sheet1\")\n\nFor Each MyCell In MyRange\n    ws.Copy after:=Sheets(Sheets.Count)\n    Sheets(Sheets.Count).Name = MyCell.Value\n    Sheets(Sheets.Count).Range(\"C3\").Formula = \"=DATA_SELECTED!$M$2\"\n    Sheets(Sheets.Count).Range(\"C4\").Formula = \"=DATA_SELECTED!$N$2\"\n    Sheets(Sheets.Count).Range(\"C6\").Formula = \"=DATA_SELECTED!$K$2\"\n    Sheets(Sheets.Count).Range(\"C7\").Formula = \"=DATA_SELECTED!$Y$2\"\nNext MyCell\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 7, "user_id": 2194182, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d1e6b81d90e944bbde7218993bcdf18d?s=128&d=identicon&r=PG", "display_name": "user2194182", "link": "https://stackoverflow.com/users/2194182/user2194182"}, "edited": false, "score": 0, "creation_date": 1485328423, "post_id": 41845256, "comment_id": 70875251, "body": "thanks for that bit of code. It works. How do I close this post"}], "tags": [], "owner": {"reputation": 3448, "user_id": 1049569, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/RHBO1.jpg?s=128&g=1", "display_name": "kiks73", "link": "https://stackoverflow.com/users/1049569/kiks73"}, "is_accepted": true, "score": 0, "last_activity_date": 1485327353, "creation_date": 1485327353, "answer_id": 41845256, "question_id": 41845190, "link": "https://stackoverflow.com/questions/41845190/listbox2-to-display-sheets-of-selected-workbooks-only-from-listbox1/41845256#41845256", "title": "Listbox2 to display sheets of selected workbooks only from Listbox1", "body": "<p>You need a</p>\n\n<pre><code>ListBox2.Clear\n</code></pre>\n\n<p>In your ListBox1_Click() sub before the for each statement </p>\n"}], "owner": {"reputation": 7, "user_id": 2194182, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d1e6b81d90e944bbde7218993bcdf18d?s=128&d=identicon&r=PG", "display_name": "user2194182", "link": "https://stackoverflow.com/users/2194182/user2194182"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 140, "favorite_count": 0, "accepted_answer_id": 41845256, "answer_count": 1, "score": 0, "last_activity_date": 1526287112, "creation_date": 1485327025, "last_edit_date": 1531164843, "question_id": 41845190, "link": "https://stackoverflow.com/questions/41845190/listbox2-to-display-sheets-of-selected-workbooks-only-from-listbox1", "title": "Listbox2 to display sheets of selected workbooks only from Listbox1", "body": "<p>There are 2 Listboxes - Listbox1 and Listbox2</p>\n\n<p>I have a code that populates Listbox1 with workbooks from a folder. Clicking on any workbook will display all relevant sheets in Listbox2.</p>\n\n<pre><code>Private Sub ListBox1_Click()\n\nDim idx As Long, sName As String\nDim bk As Workbook, sh As Worksheet\n\nidx = ListBox1.ListIndex\nsName = ListBox1.List(idx)\nApplication.DisplayAlerts = False\n\nSet bk = Workbooks.Open(\"D:\\Counts\\\" &amp; sName)\nApplication.DisplayAlerts = True\nFor Each sh In bk.Worksheets\n    ListBox2.AddItem sh.Name\nNext\nbk.Close SaveChanges:=False\n\nEnd Sub\n\n'====================================\n\nPrivate Sub UserForm_Activate()\n\n   Dim DIRECTORY As String\n   'Clear Listboxes\n   ListBox1.Clear\n\n   'list directories\n   DIRECTORY = Dir(\"D:\\Counts\\*.xls\", vbNormal)\n   Do Until DIRECTORY = \"\"\n        'add filename to listbox\n       ListBox1.AddItem DIRECTORY\n       DIRECTORY = Dir()\n   Loop\n\nEnd Sub\n</code></pre>\n\n<p><strong>Problem</strong> -</p>\n\n<p>The code keeps adding sheets to Listbox2</p>\n\n<p><strong>Requirement</strong> -</p>\n\n<p>I want the code to display sheets of selected workbook one at a time.</p>\n\n<p>So, if I click on first workbook, the code should display sheets relevant to first workbook. If I click on second workbook, the code should display sheets relevant to second workbook only, so on and so forth.</p>\n\n<p>What part of the code should be changed to achieve this.</p>\n"}, {"tags": ["vba", "excel", "if-statement"], "comments": [{"owner": {"reputation": 3347, "user_id": 5722505, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e2356a75bc16cc5aae3fce6b5ff1b9e?s=128&d=identicon&r=PG&f=1", "display_name": "Egan Wolf", "link": "https://stackoverflow.com/users/5722505/egan-wolf"}, "edited": false, "score": 2, "creation_date": 1485326709, "post_id": 41844786, "comment_id": 70874490, "body": "Your code works fine if there is &quot;text1&quot; in first row. If not, it just adds 1 to <code>x</code> and does nothing else. You can add one more loop to check again <code>If Cells(x, y).Value = &quot;text1&quot;</code> or add <code>GoTo</code> statement. If you want to check how your code is working you can press F8. It will run your code line by line and results will be immediately seen in worksheet."}, {"owner": {"reputation": 127, "user_id": 7464127, "user_type": "registered", "accept_rate": 67, "profile_image": "https://graph.facebook.com/10154510957598702/picture?type=large", "display_name": "Isra Shaikh", "link": "https://stackoverflow.com/users/7464127/isra-shaikh"}, "reply_to_user": {"reputation": 3347, "user_id": 5722505, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e2356a75bc16cc5aae3fce6b5ff1b9e?s=128&d=identicon&r=PG&f=1", "display_name": "Egan Wolf", "link": "https://stackoverflow.com/users/5722505/egan-wolf"}, "edited": false, "score": 0, "creation_date": 1485368321, "post_id": 41844786, "comment_id": 70901383, "body": "THANKYOU SO MUCH! Added go to after my else and it worked! @EganWolf"}], "answers": [{"comments": [{"owner": {"reputation": 127, "user_id": 7464127, "user_type": "registered", "accept_rate": 67, "profile_image": "https://graph.facebook.com/10154510957598702/picture?type=large", "display_name": "Isra Shaikh", "link": "https://stackoverflow.com/users/7464127/isra-shaikh"}, "edited": false, "score": 0, "creation_date": 1485368369, "post_id": 41845966, "comment_id": 70901414, "body": "Thanks but Egan was right. After checking the first it would stop. Added a GoTo after my else and it works perfectly"}], "tags": [], "owner": {"reputation": 2342, "user_id": 6283475, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/s6Dic.jpg?s=128&g=1", "display_name": "KyloRen", "link": "https://stackoverflow.com/users/6283475/kyloren"}, "is_accepted": false, "score": 1, "last_activity_date": 1485330614, "last_edit_date": 1485330614, "creation_date": 1485330174, "answer_id": 41845966, "question_id": 41844786, "link": "https://stackoverflow.com/questions/41844786/if-and-dountil-vba-code-wont-display-output/41845966#41845966", "title": "If and DoUntil VBA code wont display output", "body": "<p>Really hard to see what is going wrong here as your code should be doing what you want.</p>\n\n<p>The only other thing that could throw your results is when you have different <code>case</code> ,as VBA will treat a string with an upper case character as being different, so you may not actually be entering the loop at all. And I am assuming that <code>text1</code> is just a sample string for the question.</p>\n\n<p>So comparing the string in lower case will ensure that if you have any upper case characters they will be compared correctly, using the <code>LCase</code> function should help with that.</p>\n\n<p>Full code,</p>\n\n<pre><code>Private Sub CommandButton7_Click()\n\n Dim x As Long, y As Long\n Dim a As Long\n\n   y = 1 'starts with the first column\n\n    x = 1  'first row\n    a = 70 'this is the row where i want the data to be posted\n            If LCase(Cells(x, y).Value) = LCase(\"text1\") Then 'check first for specific text\n            Do Until LCase(Cells(x, y).Value) = LCase(\"text2\") 'stop here\n                Cells(a, y).Value = Cells(x, y).Value 'copy that data to new row\n                Cells(a, y + 1).Value = Cells(x, y + 1).Value 'and the column adjacent to it\n                x = x + 1\n                a = a + 1\n            Loop\n            Else: x = x + 1 'if not on that row then check the next row\n\n        End If\n End Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 423, "user_id": 4288279, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-MrInmPwcjiM/AAAAAAAAAAI/AAAAAAAAAUA/FdUlqZL2p5I/photo.jpg?sz=128", "display_name": "Tackgnol", "link": "https://stackoverflow.com/users/4288279/tackgnol"}, "is_accepted": false, "score": 0, "last_activity_date": 1485331066, "creation_date": 1485331066, "answer_id": 41846217, "question_id": 41844786, "link": "https://stackoverflow.com/questions/41844786/if-and-dountil-vba-code-wont-display-output/41846217#41846217", "title": "If and DoUntil VBA code wont display output", "body": "<p>Kind of hard to see the big picture but I think I produced the result you want with:</p>\n\n<pre><code>Sub FindText()\n\n\nDim textFound As Range\nDim x As Long, y As Long\nDim a As Long\ny = 1 'starts with the first column\n\nx = 0  'first row\na = 70 'this is the row where i want the data to be posted\n\nSet textFound = ActiveSheet.Columns(y).Cells.Find(\"Text1\")\n\nDo Until textFound.Offset(x, 0).Value = \"Text2\"\n\n    Cells(a + x, y).Value = textFound.Offset(x, 0).Value\n    Cells(a + x, y + 1).Value = textFound.Offset(x, 1).Value\n    x = x + 1\nLoop\n\n\nEnd Sub\n</code></pre>\n\n<p>This code is far from perfect but should work in most circumstances. </p>\n"}], "owner": {"reputation": 127, "user_id": 7464127, "user_type": "registered", "accept_rate": 67, "profile_image": "https://graph.facebook.com/10154510957598702/picture?type=large", "display_name": "Isra Shaikh", "link": "https://stackoverflow.com/users/7464127/isra-shaikh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 74, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1485332724, "creation_date": 1485325363, "last_edit_date": 1485332724, "question_id": 41844786, "link": "https://stackoverflow.com/questions/41844786/if-and-dountil-vba-code-wont-display-output", "title": "If and DoUntil VBA code wont display output", "body": "<p>Cant seem to figure out why my code is not showing output. New VBA programmer only know basics so any help would be helpful.</p>\n\n<p>What I want is for Excel to start checking a specific column for a specific text1 and then start copying and pasting those values till it reaches text2. After that I want it to check the next fifth column in the same manner.\nIf you could suggest modifications to my code.\nWithout putting in a for loop for the column my code looks like this.</p>\n\n<pre><code>Private Sub CommandButton7_Click()\n    Dim x As Long, y As Long\n    Dim a As Long\n\n    y = 1 'starts with the first column\n    x = 1  'first row\n    a = 70 'this is the row where i want the data to be posted\n\n    If Cells(x, y).Value = \"text1\" Then 'check first for specific text\n        Do Until Cells(x, y).Value = \"text2\" 'stop here\n            Cells(a, y).Value = Cells(x, y).Value 'copy that data to new row\n            Cells(a, y + 1).Value = Cells(x, y + 1).Value 'and the column adjacent to it\n            x = x + 1\n            a = a + 1\n        Loop\n    Else\n        x = x + 1 'if not on that row then check the next row       \n    End If\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "events"], "answers": [{"tags": [], "owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "is_accepted": true, "score": 1, "last_activity_date": 1485346962, "creation_date": 1485346962, "answer_id": 41851563, "question_id": 41844754, "link": "https://stackoverflow.com/questions/41844754/changing-color-of-an-unlocked-cell-in-a-locked-sheet/41851563#41851563", "title": "Changing color of an unlocked cell, in a locked sheet", "body": "<p>You'll need to <code>AllowFormattingCells:=True</code> to allow cells coloring :</p>\n\n<pre><code>Worksheets(atar).Protect UserInterfaceOnly:=True, AllowFormattingCells:=True, Password:=\"shani\"\n</code></pre>\n"}], "owner": {"reputation": 229, "user_id": 5243835, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/4000fa928b8628205aed35c1fe21ee02?s=128&d=identicon&r=PG&f=1", "display_name": "Tzvibe", "link": "https://stackoverflow.com/users/5243835/tzvibe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1200, "favorite_count": 1, "accepted_answer_id": 41851563, "answer_count": 1, "score": 1, "last_activity_date": 1485346996, "creation_date": 1485325167, "last_edit_date": 1485346996, "question_id": 41844754, "link": "https://stackoverflow.com/questions/41844754/changing-color-of-an-unlocked-cell-in-a-locked-sheet", "title": "Changing color of an unlocked cell, in a locked sheet", "body": "<p>I'm dealing with a strange problem.</p>\n\n<p>My code creates a locked sheet, with a few unlocked cells.</p>\n\n<p>The code also creates a <code>Worksheet_Change</code> sub, that changes the interior color of the edited cell.</p>\n\n<p>It works fine, but when i close the file and open it again, although the unlocked cell is editable, the <code>Worksheet_Change</code> sub gives an error for changing the color :</p>\n\n<blockquote>\n  <p>\"Application-defined or object-defined error\".</p>\n</blockquote>\n\n<hr>\n\n<p>When i tried changing the value insted of the color in the sub, it did work.</p>\n\n<p>Locking the sheet:</p>\n\n<pre><code>ThisWorkbook.Sheets(atar).Cells(exlRow, 7).Locked = False\nWorksheets(atar).Protect UserInterfaceOnly:=True, Password:=\"shani\" 'lock sheet\n</code></pre>\n\n<p>Created sub:</p>\n\n<pre><code> Private Sub Worksheet_Change(ByVal Target As Excel.Range)\n\n    Target.Interior.Color = RGB(0, 255, 0)\n\n End Sub\n</code></pre>\n"}, {"tags": ["ms-access", "combobox", "vba", "relationship"], "comments": [{"owner": {"reputation": 6188, "user_id": 5339178, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5DL9b.jpg?s=128&g=1", "display_name": "Sergey S.", "link": "https://stackoverflow.com/users/5339178/sergey-s"}, "edited": false, "score": 1, "creation_date": 1485323929, "post_id": 41844363, "comment_id": 70873280, "body": "Remove this line: <code>Me.[Vlasnik.ID_VU].Value = Me.cboID_VU2.Column(0)</code>, your table has autonumber, it will give next correct value. You giving ID, which already exists in table"}, {"owner": {"reputation": 25, "user_id": 6819162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d8321c55a2798f41a2ae727027117571?s=128&d=identicon&r=PG&f=1", "display_name": "i_n", "link": "https://stackoverflow.com/users/6819162/i-n"}, "reply_to_user": {"reputation": 6188, "user_id": 5339178, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5DL9b.jpg?s=128&g=1", "display_name": "Sergey S.", "link": "https://stackoverflow.com/users/5339178/sergey-s"}, "edited": false, "score": 0, "creation_date": 1485324268, "post_id": 41844363, "comment_id": 70873413, "body": "But the problem is that I want to select owner that I have in the table Customers, and with that comes his ID, and the way you were suggesting would make new customer every time."}, {"owner": {"reputation": 6188, "user_id": 5339178, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5DL9b.jpg?s=128&g=1", "display_name": "Sergey S.", "link": "https://stackoverflow.com/users/5339178/sergey-s"}, "edited": false, "score": 0, "creation_date": 1485328358, "post_id": 41844363, "comment_id": 70875205, "body": "You have wrong base query for <code>Nova narudzba</code>. You cannot use it for inserting new records to <code>Narudzba</code> because it will insert also new customer for each inserted order. Remove Customer&#39;s table from base query and set combobox for <code>Narudzba.ID_VU</code> with rowsource from <code>Vlasnik</code> table"}, {"owner": {"reputation": 6188, "user_id": 5339178, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5DL9b.jpg?s=128&g=1", "display_name": "Sergey S.", "link": "https://stackoverflow.com/users/5339178/sergey-s"}, "edited": false, "score": 0, "creation_date": 1485328491, "post_id": 41844363, "comment_id": 70875284, "body": "And the same for <code>O klima uredaju</code> table - remove it from query and make detail subform for order details"}], "owner": {"reputation": 25, "user_id": 6819162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d8321c55a2798f41a2ae727027117571?s=128&d=identicon&r=PG&f=1", "display_name": "i_n", "link": "https://stackoverflow.com/users/6819162/i-n"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 161, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1485323603, "creation_date": 1485323603, "question_id": 41844363, "link": "https://stackoverflow.com/questions/41844363/the-changes-you-requested-to-the-table-were-not-successful-because-they-would-cr", "title": "The changes you requested to the table were not successful because they would create duplicate values in the index, primary key or relationship", "body": "<p>When I am adding new record in my [form][2] I get error from the title. I have 2 tables: Orders (Narudzba) and Vlasnik (Customers). I have created combobox to fill known fields when any customer in combobox is selected but it is not working as expected. </p>\n\n<p><a href=\"https://i.stack.imgur.com/EX0ST.png\" rel=\"nofollow noreferrer\">This how tables are connected.</a>, every primary key is set as autonumber.</p>\n\n<p>This is the code I used \"On change\" event for combobox.</p>\n\n<pre><code>Me.[Vlasnik.ID_VU].Value = Me.cboID_VU2.Column(0)\nMe.[Naziv tvrtke].Value = Me.cboID_VU2.Column(1)\nMe.[Ime korisnika].Value = Me.cboID_VU2.Column(2)\nMe.[Prezime korisnika].Value = Me.cboID_VU2.Column(3)\nMe.[Adresa korisnika].Value = Me.cboID_VU2.Column(4)\nMe.[Telefon].Value = Me.cboID_VU2.Column(5)\nMe.[Mail].Value = Me.cboID_VU2.Column(6)\n</code></pre>\n\n<p>This how form looks like : i.imgur.com/6vgZVEa.png</p>\n\n<p>If anyone would like to check DB and see where the problem is, <a href=\"https://drive.google.com/file/d/0B8_l3-XmPYT2bDltX2hjTTg2SWM/view?usp=sharing\" rel=\"nofollow noreferrer\">DB</a></p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 276, "user_id": 3752769, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91b8da84b24c97eaf05897d3b65d4909?s=128&d=identicon&r=PG&f=1", "display_name": "sn152", "link": "https://stackoverflow.com/users/3752769/sn152"}, "edited": false, "score": 0, "creation_date": 1485324083, "post_id": 41844309, "comment_id": 70873343, "body": "Why have commented out this line <code>Windows(&quot;Project tracker spreadsheet VBA&quot;).Activate</code>? Remove the single quote before this line in your code."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 1, "creation_date": 1485324870, "post_id": 41844309, "comment_id": 70873691, "body": "What is the name of the &quot;old&quot; workbook?  If it is <code>&quot;Project tracker spreadsheet VBA.xlsm&quot;</code> then you should use <code>Workbooks(&quot;Project tracker spreadsheet VBA.xlsm&quot;).Sheets(&quot;Contact List&quot;).Copy Before:=Workbooks(projectref &amp; &quot;Contact_List.xlsx&quot;).Sheets(&quot;Sheet1&quot;)</code>"}], "answers": [{"tags": [], "owner": {"reputation": 3101, "user_id": 6783806, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dce70a8f2f353bdac58089c38f1ba5a5?s=128&d=identicon&r=PG&f=1", "display_name": "Mukul Varshney", "link": "https://stackoverflow.com/users/6783806/mukul-varshney"}, "is_accepted": false, "score": 0, "last_activity_date": 1485326523, "creation_date": 1485326523, "answer_id": 41845047, "question_id": 41844309, "link": "https://stackoverflow.com/questions/41844309/runtime-error-9-subscript-out-of-range-when-copying-a-seet-to-a-new-wrokbook/41845047#41845047", "title": "runtime error 9 - subscript out of range when copying a seet to a new wrokbook", "body": "<p>I don't know how to insert code in comments so using answers space to guide you.\nIt appears Windows(\"Project tracker spreadsheet VBA\") is not available. Could be the window text is incorrect. To confirm this. Please insert below code lines where the line has been commented out. This may give you some clue.  </p>\n\n<pre><code>found = False\n  For Each Item In Windows\n    Debug.Print Item.Caption\n    If Item.Caption = \"Project tracker spreadsheet VBA\" Then\n      found = True\n      Exit For\n    End If\n  Next\n\n  If Not found Then\n    MsgBox \"Window(Project tracker spreadsheet VBA) -  Not found\"\n  End If\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 859, "user_id": 2901545, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/e99f0e740e64b32a2fece89ed33a4c29?s=128&d=identicon&r=PG&f=1", "display_name": "scb998", "link": "https://stackoverflow.com/users/2901545/scb998"}, "edited": false, "score": 0, "creation_date": 1485464373, "post_id": 41845205, "comment_id": 70947923, "body": "brilliant - worked a treat! thanks for the advice as well :)"}], "tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": true, "score": 1, "last_activity_date": 1485327093, "creation_date": 1485327093, "answer_id": 41845205, "question_id": 41844309, "link": "https://stackoverflow.com/questions/41844309/runtime-error-9-subscript-out-of-range-when-copying-a-seet-to-a-new-wrokbook/41845205#41845205", "title": "runtime error 9 - subscript out of range when copying a seet to a new wrokbook", "body": "<p>First, regarding your error, you are already defining and setting the new workbook with <code>Set newWorkbook = Workbooks.Add</code>, so why not use it when you \"Contact List\" sheet between workbooks.</p>\n\n<p>To copy a worksheet between workbooks, you need to fully qualify the <code>Worksheet</code> object, <code>ThisWorkbook.Sheets(\"Contact List\").Copy Before:=NewWorkbook.Sheets(\"Sheet1\")</code></p>\n\n<p>Second, it's better to avoid using <code>Activate</code> when you can work directly with fully qualified <code>Range</code>s and <code>Worksheets</code>.</p>\n\n<p><strong>Full Edited Code</strong>:</p>\n\n<pre><code>Option Explicit\n\nPrivate Sub btn_conact_Click()\n\nDim projectref As String\nDim savelocation As String\nDim projectSearchRange As Range\nDim LastRow As Integer\nDim NewWorkbook As Workbook\n\n'set search value (porject key - unique)\nprojectref = cmb_Project.Value\n\nApplication.ScreenUpdating = False\n\n'find the project reference in the tracking spreadsheet\nWith Sheets(\"Project Tracking\")\n    Set projectSearchRange = .Range(\"A:A\").Find(projectref, , xlValues, xlWhole)\n    If Not projectSearchRange Is Nothing Then '&lt;-- verify that find was successful\n        LastRow = projectSearchRange.Row\n        'file directory to save the new workbook in\n        savelocation = .Cells(LastRow, 5).Value\n    Else '&lt;-- find was unsuccessful\n        MsgBox \"Unable to find \" &amp; projectref\n        Exit Sub\n    End If\nEnd With\n\n'template for the contact list\nSheets(\"Contact List\").Cells(7, 3).Value = projectref\n\n'create new workbook\nSet NewWorkbook = Workbooks.Add\nWith NewWorkbook\n    .Title = \"Contact List for Project\" &amp; projectref\n    .SaveAs Filename:=savelocation &amp; \"/\" &amp; projectref &amp; \"Contact_List.xlsx\"\nEnd With\n\n' ===== Fixed the error on thie line =====\nThisWorkbook.Sheets(\"Contact List\").Copy Before:=NewWorkbook.Sheets(\"Sheet1\")\nNewWorkbook.Activate '&lt;-- not sure why you want to Activate, but here you go\nApplication.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 859, "user_id": 2901545, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/e99f0e740e64b32a2fece89ed33a4c29?s=128&d=identicon&r=PG&f=1", "display_name": "scb998", "link": "https://stackoverflow.com/users/2901545/scb998"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 298, "favorite_count": 0, "accepted_answer_id": 41845205, "answer_count": 2, "score": 0, "last_activity_date": 1485327131, "creation_date": 1485323318, "last_edit_date": 1485327131, "question_id": 41844309, "link": "https://stackoverflow.com/questions/41844309/runtime-error-9-subscript-out-of-range-when-copying-a-seet-to-a-new-wrokbook", "title": "runtime error 9 - subscript out of range when copying a seet to a new wrokbook", "body": "<p>I have a simple bit of code as shown below:</p>\n\n<pre><code>Private Sub btn_conact_Click()\n\nDim projectref As String\nDim savelocation As String\nDim projectSearchRange As Range\nDim LastRow As Integer\n\n'set search value (porject key - unique)    \nprojectref = cmb_Project.Value\n\nApplication.ScreenUpdating = False\n'find the project reference in the tracking spreadsheet\n\nSheets(\"Project Tracking\").Activate\nSet projectSearchRange = Range(\"A:A\").Find(projectref, , xlValues, xlWhole)\nLastRow = projectSearchRange.Row\n'file directory to save the new workbook in\nsavelocation = Cells(LastRow, 5).Value    \n\n'template for the contact list\nSheets(\"Contact List\").Activate\n\nCells(7, 3).Value = projectref\n'create new workbook\nSet newWorkbook = Workbooks.Add\nWith newWorkbook\n    .Title = \"Contact List for Project\" &amp; projectref\n    .SaveAs Filename:=savelocation &amp; \"/\" &amp; projectref &amp; \"Contact_List.xlsx\"\nEnd With\n\n'Windows(\"Project tracker spreadsheet VBA\").Activate\nSheets(\"Contact List\").Copy Before:=Workbooks(projectref &amp; \"Contact_List.xlsx\").Sheets(\"Sheet1\") 'runtime error 9: subscript out of range\nWindows(projectref &amp; \" Contact_List.xlsx\").Activate\nApplication.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n\n<p>As can be seen, I am getting a runtime error on the 4th last line of code, which is really a rather important line...</p>\n\n<p>My question is, can anybody see where I could have possibly made a mistake which would cause this error? is successfully creates and saves the new workbook in the specified location, but is just falling over when it tries to copy the required sheet from the old workbook(Project tracker spreadsheet VBA) to the new one created by this code.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 7467257, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/79d7da4d67829e47f721c958c7ab7fb6?s=128&d=identicon&r=PG&f=1", "display_name": "ExcelMr", "link": "https://stackoverflow.com/users/7467257/excelmr"}, "edited": false, "score": 0, "creation_date": 1485363929, "post_id": 41845662, "comment_id": 70898652, "body": "Hi Teylyn! It is awesome. This code has worked for me perfectly as I wanted. I am using this code with form button that perform two actions: 1) Open new form for data entry; 2) Unhide new row set to record data upon submission. Actually I have multiple tables and wanted to use this approach to avoid issues with destination cell linkages by adding new row in my file with coding so am using hiding action to deal with it. But thank you so much for your great help!"}, {"owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "reply_to_user": {"reputation": 15, "user_id": 7467257, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/79d7da4d67829e47f721c958c7ab7fb6?s=128&d=identicon&r=PG&f=1", "display_name": "ExcelMr", "link": "https://stackoverflow.com/users/7467257/excelmr"}, "edited": false, "score": 0, "creation_date": 1485377822, "post_id": 41845662, "comment_id": 70906713, "body": "Glad to help. Could you please mark the answer as explained in the <a href=\"https://stackoverflow.com/tour\">Tour</a>, so others can find it more easily."}, {"owner": {"reputation": 15, "user_id": 7467257, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/79d7da4d67829e47f721c958c7ab7fb6?s=128&d=identicon&r=PG&f=1", "display_name": "ExcelMr", "link": "https://stackoverflow.com/users/7467257/excelmr"}, "edited": false, "score": 0, "creation_date": 1485399316, "post_id": 41845662, "comment_id": 70913988, "body": "Yes done but it shows that people with less than 15 reputation can mark but it is not available publicly. I will visit this answer back again and mark it once I reach to that score. This was my first ever post in this forum. Thanks Again!"}, {"owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "reply_to_user": {"reputation": 15, "user_id": 7467257, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/79d7da4d67829e47f721c958c7ab7fb6?s=128&d=identicon&r=PG&f=1", "display_name": "ExcelMr", "link": "https://stackoverflow.com/users/7467257/excelmr"}, "edited": false, "score": 0, "creation_date": 1485416998, "post_id": 41845662, "comment_id": 70919720, "body": "If you ask the question you can mark the answer. You need reputation only to upvote, not to mark the answer. The two are different. Watch the <a href=\"https://stackoverflow.com/tour\">Tour</a> again."}], "tags": [], "owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "is_accepted": true, "score": 0, "last_activity_date": 1485329430, "last_edit_date": 1485329430, "creation_date": 1485329021, "answer_id": 41845662, "question_id": 41843965, "link": "https://stackoverflow.com/questions/41843965/hide-unhide-last-row-with-data-in-a-table-sequentially-using-button-vba-excel/41845662#41845662", "title": "Hide unhide last row with data in a table sequentially using button - VBA Excel", "body": "<p>If you want to unhide one row at a time you can't use a range from startRow to lastRow, right? That will always unhide all rows from start row to last row.</p>\n\n<p>If your intention is to unhide one row with each time the button is clicked, try this macro on the button. It will ignore rows that are already unhidden and unhide the first hidden row starting from the top, then end.</p>\n\n<pre><code>Sub test()\nDim startRow As Long: startRow = 1\nDim lastRow  As Long: lastRow = ActiveSheet.UsedRange.Rows.Count\n\nDo While startRow &lt; lastRow + 1\n    If ActiveSheet.Rows(startRow &amp; \":\" &amp; startRow).Hidden = True Then\n        ActiveSheet.Rows(startRow &amp; \":\" &amp; startRow).Hidden = False\n        startRow = lastRow + 1\n    End If\n    startRow = startRow + 1\nLoop\n\n\nEnd Sub\n</code></pre>\n\n<p>Another, non-VBA approach would be to keep the rows visible and use formatting to hide the text. Then you can enter a trigger value into a cell that is checked by a conditional formatting rule and the value will be formatted to show.  That way you can select any order to unhide answers.</p>\n\n<p><a href=\"https://i.stack.imgur.com/8tKGh.gif\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/8tKGh.gif\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 15, "user_id": 7467257, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/79d7da4d67829e47f721c958c7ab7fb6?s=128&d=identicon&r=PG&f=1", "display_name": "ExcelMr", "link": "https://stackoverflow.com/users/7467257/excelmr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 389, "favorite_count": 0, "accepted_answer_id": 41845662, "answer_count": 1, "score": 0, "last_activity_date": 1485329430, "creation_date": 1485321631, "last_edit_date": 1531164843, "question_id": 41843965, "link": "https://stackoverflow.com/questions/41843965/hide-unhide-last-row-with-data-in-a-table-sequentially-using-button-vba-excel", "title": "Hide unhide last row with data in a table sequentially using button - VBA Excel", "body": "<p>I am looking for a code to hide/Unhide last row with data but in a sequence using button.</p>\n\n<p>I have created a table with a questions in top row and expecting 1 to 10 responses in the rows below. \nI will hide all 10 rows in a table and will ask responders to use button to unhide one row at a time for their answer.</p>\n\n<p>I have tried following code but it unhide all rows whereas I need to unhide one row upon each click in sequence.</p>\n\n<pre><code>Dim startRow As Long: startRow = 1\nDim lastRow  As Long: lastRow = ActiveSheet.UsedRange.Rows.Count\n\nActiveSheet.Rows(startRow &amp; \":\" &amp; lastRow).Hidden = False\n</code></pre>\n\n<p>I hope will get some good responses from the community with thanks in advance.</p>\n"}, {"tags": ["excel", "vba", "duplicates"], "comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1485325415, "post_id": 41843816, "comment_id": 70873947, "body": "What code have you tried so far?  If you paste it into the question, and tell us which bit isn&#39;t working as you expect, we can assist you to fix whatever issues you are having."}, {"owner": {"reputation": 18763, "user_id": 472495, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/4rtxd.png?s=128&g=1", "display_name": "halfer", "link": "https://stackoverflow.com/users/472495/halfer"}, "edited": false, "score": 0, "creation_date": 1561328069, "post_id": 41843816, "comment_id": 100015985, "body": "Without an attempt being provided, and without one being made and edited in despite being asked, this question can be closed as Too Broad."}], "answers": [{"tags": [], "owner": {"reputation": 5527, "user_id": 4082955, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e670bd7627dcaaceead20dfdc02a7589?s=128&d=identicon&r=PG&f=1", "display_name": "Fratyx", "link": "https://stackoverflow.com/users/4082955/fratyx"}, "is_accepted": false, "score": 0, "last_activity_date": 1485325478, "creation_date": 1485325478, "answer_id": 41844812, "question_id": 41843816, "link": "https://stackoverflow.com/questions/41843816/how-to-clear-not-delete-the-last-duplicate-cell-not-row-for-the-duplicate-va/41844812#41844812", "title": "How to clear (not delete) the last duplicate cell (not row) for the duplicate values found?", "body": "<p>Maybe that would help:</p>\n\n<pre><code>For Each cell In Application.Intersect(InsertNameOfTableHere.UsedRange.Offset(1, 0), InsertNameOfTableHere.Columns(1))\n    If cell = cell.Offset(-1, 0) And cell &lt;&gt; cell.Offset(1, 0) Then\n        cell.Value = \"\"\n    End If\nNext\n</code></pre>\n"}], "owner": {"reputation": 53, "user_id": 5536138, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/2e5b3a47e7e152e82df4d838e03fffd4?s=128&d=identicon&r=PG&f=1", "display_name": "vinay agarwal", "link": "https://stackoverflow.com/users/5536138/vinay-agarwal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 57, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1579471219, "creation_date": 1485320957, "last_edit_date": 1579471219, "question_id": 41843816, "link": "https://stackoverflow.com/questions/41843816/how-to-clear-not-delete-the-last-duplicate-cell-not-row-for-the-duplicate-va", "title": "How to clear (not delete) the last duplicate cell (not row) for the duplicate values found?", "body": "<p>I have a sorted column:</p>\n\n<pre><code>**NAMES**\nAmit\nAmit\nAmit\nJack\nJack\nJack\nJack\n</code></pre>\n\n<p>I want to clear (not delete) the last duplicate cell (not row) for the duplicate values found.</p>\n\n<p>In above example third Amit and fourth Jack will be cleared from the cell.</p>\n\n<p>I found many macros/VBA that clear duplicates, but none clear only last duplicate values.</p>\n"}, {"tags": ["vba", "excel", "autofill", "sumifs"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1485325046, "post_id": 41843698, "comment_id": 70873774, "body": "You&#39;re not putting a formula in the cell, just a value.  You need to use an actual formula if you want to fill it down."}, {"owner": {"reputation": 3, "user_id": 7166257, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/d0c19439f1a98ad3d874b31900e21cac?s=128&d=identicon&r=PG&f=1", "display_name": "Mark", "link": "https://stackoverflow.com/users/7166257/mark"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1485326067, "post_id": 41843698, "comment_id": 70874194, "body": "@TimWilliams, thanks for the reply, i have tried to use  Sub Sumifsfunction()     With ThisWorkbook.Sheets(&quot;Sheet1&quot;) Range(&quot;L2:L100&quot;).Formula = &quot;=SUMifs(G:G,A:A,E2,F:F,&quot;John&quot;)&quot; End With End Sub  but getting expected: end of statement error"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1485326202, "post_id": 41843698, "comment_id": 70874267, "body": "You haven&#39;t doubled your double-quotation marks within that string.  (And you have a <code>With</code> block, but not using it for anything.)  You could have used <code>.Range(&quot;L2:L100&quot;).Formula = &quot;=SUMifs(G:G,A:A,A2,F:F,&quot;&quot;John&quot;&quot;)&quot;</code>"}, {"owner": {"reputation": 3, "user_id": 7166257, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/d0c19439f1a98ad3d874b31900e21cac?s=128&d=identicon&r=PG&f=1", "display_name": "Mark", "link": "https://stackoverflow.com/users/7166257/mark"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1485326523, "post_id": 41843698, "comment_id": 70874411, "body": "@YowE3K , Yes that was the problem with my codes, ur code helped me to figure it out, thanks mate :)"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 7166257, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/d0c19439f1a98ad3d874b31900e21cac?s=128&d=identicon&r=PG&f=1", "display_name": "Mark", "link": "https://stackoverflow.com/users/7166257/mark"}, "edited": false, "score": 0, "creation_date": 1485326468, "post_id": 41844897, "comment_id": 70874387, "body": "Thanks a lot the first code u provided worked exactly like what i want, thanks a lot  :)"}], "tags": [], "owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "is_accepted": true, "score": 1, "last_activity_date": 1485325889, "creation_date": 1485325889, "answer_id": 41844897, "question_id": 41843698, "link": "https://stackoverflow.com/questions/41843698/vba-to-filldown-formula-with-changing-cell-reference/41844897#41844897", "title": "VBA to FillDown Formula with changing cell reference", "body": "<p>It sounds like you are after something like:</p>\n\n<pre><code>Sub SumIfs()\n    With ThisWorkbook.Sheets(\"Sheet1\")\n        .Range(\"L2:L\" &amp; .Range(\"G\" &amp; .Rows.Count).End(xlUp).Row).Formula = _\n                    \"=SUMIFS(G:G,A:A,A2,F:F,\"\"John\"\")\"\n    End With\nEnd Sub\n</code></pre>\n\n<p>If you want the <strong>value</strong>, rather than the <strong>formula</strong>, inserted into column L, you could extend that code to:</p>\n\n<pre><code>Sub SumIfs()\n    Dim LastRow As Long\n    With ThisWorkbook.Sheets(\"Sheet1\")\n        'Assume we want to create values for every cell in column L down until\n        'we get to the last cell in column G\n        LastRow = .Range(\"G\" &amp; .Rows.Count).End(xlUp).Row\n        'Paste the formula\n        .Range(\"L2:L\" &amp; LastRow).Formula = _\n                    \"=SUMIFS(G:G,A:A,A2,F:F,\"\"John\"\")\"\n        'Convert to values\n        .Range(\"L2:L\" &amp; LastRow).Value = _\n                   .Range(\"L2:L\" &amp; LastRow).Value\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 7166257, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/d0c19439f1a98ad3d874b31900e21cac?s=128&d=identicon&r=PG&f=1", "display_name": "Mark", "link": "https://stackoverflow.com/users/7166257/mark"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1542, "favorite_count": 0, "accepted_answer_id": 41844897, "answer_count": 1, "score": 0, "last_activity_date": 1485325889, "creation_date": 1485320362, "last_edit_date": 1485321509, "question_id": 41843698, "link": "https://stackoverflow.com/questions/41843698/vba-to-filldown-formula-with-changing-cell-reference", "title": "VBA to FillDown Formula with changing cell reference", "body": "<p>I have a Sumifs function to be done in macro with 2 criterias. my  excel file is quite big. So my code looks like this :</p>\n\n<pre><code>Sub SumIfs()\nThisWorkbook.Sheets(\"Sheet1\").Activate\nRange(\"L2\") = Application.WorksheetFunction.SUMifs(Range(\"G:G\"),Range(\"A:A\"),\"Pen\",Range(\"F:F\"),\"John\")\nEnd Sub\n</code></pre>\n\n<p>But i would like to change the \"Pen\" to its cell reference, which means \"A2\" and \" John\" remains constant for all the cells down in the F:F range. And the to fill the formula down for all the cells below. I used this code,</p>\n\n<pre><code>Application.WorksheetFunction.SUMifs(Range(\"G:G\"),Range(\"A:A\"), A2,Range(\"F:F\"),\"John\")\n</code></pre>\n\n<p>But it only shows the value for A2 down in the cells when I did the filldown function. Please Help me with this. Thanks in Advance.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 535, "user_id": 5113999, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c182661a69960f30a88c361f4ac7da1a?s=128&d=identicon&r=PG&f=1", "display_name": "Rowen Chumacera", "link": "https://stackoverflow.com/users/5113999/rowen-chumacera"}, "edited": false, "score": 0, "creation_date": 1485337418, "post_id": 41843222, "comment_id": 70880442, "body": "Care to show a screenshot of a sample sheet with input data and another screenshot with how the output will look like?"}, {"owner": {"reputation": 101, "user_id": 7439308, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/c98a75eb1c0cde73ac464852b9a3e2f0?s=128&d=identicon&r=PG&f=1", "display_name": "stack mark", "link": "https://stackoverflow.com/users/7439308/stack-mark"}, "reply_to_user": {"reputation": 535, "user_id": 5113999, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c182661a69960f30a88c361f4ac7da1a?s=128&d=identicon&r=PG&f=1", "display_name": "Rowen Chumacera", "link": "https://stackoverflow.com/users/5113999/rowen-chumacera"}, "edited": false, "score": 0, "creation_date": 1485337846, "post_id": 41843222, "comment_id": 70880737, "body": "<a href=\"https://s23.postimg.org/5cw1q5ujf/stack.jpg\" rel=\"nofollow noreferrer\">link</a> - here is the link. Col K has the date and time, Col M has the value. Here time is Sunday 9PM, to the remaining hour is 0.3. So 1.5-0.3 is 1.2, which is still greater than 1 so this should not be colored. If it is less than 1 then it should be colored. But the values should remain the same and the subtraction should not be seen in the excel."}, {"owner": {"reputation": 535, "user_id": 5113999, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c182661a69960f30a88c361f4ac7da1a?s=128&d=identicon&r=PG&f=1", "display_name": "Rowen Chumacera", "link": "https://stackoverflow.com/users/5113999/rowen-chumacera"}, "edited": false, "score": 0, "creation_date": 1485338940, "post_id": 41843222, "comment_id": 70881526, "body": "I am tracing the code now and I&#39;m getting 0.125, not 0.3. Also, you should use <code>Double</code> as the data type of <code>remainingDay</code> as <code>Long</code> ignores the decimal part because it&#39;s an integer."}], "answers": [{"comments": [{"owner": {"reputation": 101, "user_id": 7439308, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/c98a75eb1c0cde73ac464852b9a3e2f0?s=128&d=identicon&r=PG&f=1", "display_name": "stack mark", "link": "https://stackoverflow.com/users/7439308/stack-mark"}, "edited": false, "score": 0, "creation_date": 1485340090, "post_id": 41848949, "comment_id": 70882322, "body": "I tried it, but it doesn&#39;t give the desired result. Even after the subtraction, if the value in M is greater than 1, it is being colored. So basically, even after the subtraction, if the value is &gt; 1, the it should not be colored."}, {"owner": {"reputation": 535, "user_id": 5113999, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c182661a69960f30a88c361f4ac7da1a?s=128&d=identicon&r=PG&f=1", "display_name": "Rowen Chumacera", "link": "https://stackoverflow.com/users/5113999/rowen-chumacera"}, "reply_to_user": {"reputation": 101, "user_id": 7439308, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/c98a75eb1c0cde73ac464852b9a3e2f0?s=128&d=identicon&r=PG&f=1", "display_name": "stack mark", "link": "https://stackoverflow.com/users/7439308/stack-mark"}, "edited": false, "score": 0, "creation_date": 1485387707, "post_id": 41848949, "comment_id": 70911058, "body": "Then you just have to flip the <code>If</code> condition for this."}, {"owner": {"reputation": 535, "user_id": 5113999, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c182661a69960f30a88c361f4ac7da1a?s=128&d=identicon&r=PG&f=1", "display_name": "Rowen Chumacera", "link": "https://stackoverflow.com/users/5113999/rowen-chumacera"}, "reply_to_user": {"reputation": 101, "user_id": 7439308, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/c98a75eb1c0cde73ac464852b9a3e2f0?s=128&d=identicon&r=PG&f=1", "display_name": "stack mark", "link": "https://stackoverflow.com/users/7439308/stack-mark"}, "edited": false, "score": 0, "creation_date": 1485389258, "post_id": 41848949, "comment_id": 70911476, "body": "Edited my answer, by the way."}], "tags": [], "owner": {"reputation": 535, "user_id": 5113999, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c182661a69960f30a88c361f4ac7da1a?s=128&d=identicon&r=PG&f=1", "display_name": "Rowen Chumacera", "link": "https://stackoverflow.com/users/5113999/rowen-chumacera"}, "is_accepted": false, "score": 0, "last_activity_date": 1485387596, "last_edit_date": 1485387596, "creation_date": 1485339543, "answer_id": 41848949, "question_id": 41843222, "link": "https://stackoverflow.com/questions/41843222/subtract-remaining-hour-from-a-day-using-vba/41848949#41848949", "title": "Subtract remaining hour from a day using VBA", "body": "<p>As I mentioned in my comment, just change the data type of remainingDay as <code>Long</code> is an integer type (no decimal part).</p>\n\n<pre><code>Sub SundayDatefilter()\n   Dim r, lastrow, remainingDay As Double   '&lt;--- Correction\n\n   lastrow = Range(\"M:P\").Cells(Rows.Count, \"A\").End(xlUp).Row\n\n   Application.ScreenUpdating = False\n\n   For r = 2 To lastrow\n      remainingDay = 0\n\n      If Weekday(Range(\"K\" &amp; r).Value, vbSunday) = 1 Then\n         remainingDay = Round((24 - Format(TimeValue(Range(\"K\" &amp; r)), \"h\")) / 24, 1)\n\n         If InStr(1, Range(\"P\" &amp; r).Text, \"waiting\", vbTextCompare) &gt; 0 Then\n            If Range(\"M\" &amp; r) - remainingDay &lt; 1 Then   '&lt;--- Correction\n               Range(\"M\" &amp; r).Cells.Font.ColorIndex = 3\n            Else\n               Range(\"M\" &amp; r).Cells.Font.ColorIndex = 0\n            End If\n         End If\n      End If\n   Next r\n\n   Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 101, "user_id": 7439308, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/c98a75eb1c0cde73ac464852b9a3e2f0?s=128&d=identicon&r=PG&f=1", "display_name": "stack mark", "link": "https://stackoverflow.com/users/7439308/stack-mark"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 90, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1485387596, "creation_date": 1485317320, "last_edit_date": 1485349806, "question_id": 41843222, "link": "https://stackoverflow.com/questions/41843222/subtract-remaining-hour-from-a-day-using-vba", "title": "Subtract remaining hour from a day using VBA", "body": "<p>I have the below code that will identify a Sunday and highlight values in Col M if they are greater than 1 and has the text \"waiting\" in col P.</p>\n\n<p>What I want to do is:</p>\n\n<ol>\n<li>I have the date and time format in MM/D/YYYY TIME (example) - 1/22/2017 23:30</li>\n<li>I want to subtract the Sunday time of the date with a cut of time of 23:59 and that remaining number should be subtracted with the value in col M and if still the value is greater than col M then it should be highlighted in Red.</li>\n</ol>\n\n<p><strong>Sample Scenario:</strong> </p>\n\n<p>If the date/time is 1/22/2017 21:00 in col K, then the remaining hour here is 0.3 hours..this should be subtracted from the value in col M, lets say col M has 1.3, so 1.3-0.3 = 1. So it should be highlighted.</p>\n\n<p><strong>Sample Output:</strong>\n<a href=\"https://i.stack.imgur.com/TrCBO.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/TrCBO.jpg\" alt=\"Sample Output\"></a></p>\n\n<p><strong>Code:</strong></p>\n\n<pre><code>Sub SundayDatefilter()\n\nDim r, lastrow, remainingDay As Long\n\nlastrow = Range(\"M:P\").Cells(Rows.count, \"A\").End(xlUp).Row\n\nApplication.ScreenUpdating = False\n\n   For r = 2 To lastrow\n      remainingDay = 0\n\n        If Weekday(Range(\"K\" &amp; r).Value, vbSunday) = 1 Then\n                remainingDay = Round((24 - Format(TimeValue(Range(\"K\" &amp; r)), \"h\")) / 24, 1)\n\n             If InStr(1, Range(\"P\" &amp; r).Text, \"waiting\", vbTextCompare) &gt; 0     Then\n\n                 If Range(\"M\" &amp; r) - remainingDay &gt;= 1 Then\n                     Range(\"M\" &amp; r).Cells.Font.ColorIndex = 3\n                 Else\n                     Range(\"M\" &amp; r).Cells.Font.ColorIndex = 0\n                 End If\n             End If\n        End If\n    Next r\n      Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "row", "vba"], "answers": [{"tags": [], "owner": {"reputation": 4067, "user_id": 2970789, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dd4ed57e10989bdb3f3ac58326b7354?s=128&d=identicon&r=PG&f=1", "display_name": "Ambie", "link": "https://stackoverflow.com/users/2970789/ambie"}, "is_accepted": false, "score": 0, "last_activity_date": 1485319792, "last_edit_date": 1485319792, "creation_date": 1485318697, "answer_id": 41843428, "question_id": 41842855, "link": "https://stackoverflow.com/questions/41842855/delete-empty-rows-in-an-excel-table-using-vba/41843428#41843428", "title": "Delete empty rows in an Excel table using VBA", "body": "<p>It really all depends on what you mean by empty. I notice you're using <code>xlCellTypeBlanks</code>, so if you wanted to continue using that range property, then you could just compare the row's cell count with your <code>SpecialCells</code> cell count - if they match, then you have an 'empty' row.</p>\n\n<p>There are many others ways of doing this, but I'm not aware of one which doesn't need to iterate each row in your table. Assuming you want to go the <code>SpecialCells</code> route, your iteration could be something like this:</p>\n\n<pre><code>Dim lo As ListObject\nDim lRow As ListRow\nDim rng As Range\nDim delRows As Collection\n\nSet lo = Sheet1.ListObjects(\"Table1\") 'change to your table name\nOn Error Resume Next\nFor Each lRow In lo.ListRows\n    Set rng = Nothing\n    Set rng = lRow.Range.SpecialCells(xlCellTypeBlanks)\n    If Not rng Is Nothing Then\n        If rng.Count = lRow.Range.Cells.Count Then\n            If delRows Is Nothing Then\n                Set delRows = New Collection\n                delRows.Add lRow\n            Else\n                delRows.Add lRow, Before:=1\n            End If\n        End If\n    End If\nNext\nOn Error GoTo 0\n\nIf Not delRows Is Nothing Then\n    For Each lRow In delRows\n        lRow.Delete\n    Next\nEnd If\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1383, "user_id": 5981533, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/688353da6deb0ac1d22eb9d42e032269?s=128&d=identicon&r=PG", "display_name": "Amorpheuses", "link": "https://stackoverflow.com/users/5981533/amorpheuses"}, "is_accepted": false, "score": 0, "last_activity_date": 1485355687, "last_edit_date": 1485355687, "creation_date": 1485330501, "answer_id": 41846065, "question_id": 41842855, "link": "https://stackoverflow.com/questions/41842855/delete-empty-rows-in-an-excel-table-using-vba/41846065#41846065", "title": "Delete empty rows in an Excel table using VBA", "body": "<p>This is an alternate solution but should be considered in bad form since it effectively is altering the table count when it deletes a row.  That's what amounts to bad programming practice. </p>\n\n<p>Also if there are embedded blanks, it won't catch them.  FYI I debugged using Sheet 1 instead of Sheet 9.</p>\n\n<p>On the plus side it is more concise (for whatever that might be worth).</p>\n\n<p>There are also VBA quirks that I don't fully appreciate.  For example if you replace 'rng' in the find command with it's expression you'll get an error which I'd consider counter-intuitive unless someone knows why this should make sense.  </p>\n\n<pre><code>Sub DeleteEmptyTableRows()\n    Dim MainSheet As Worksheet\n    Dim tabRng As Range, rng As Range, found As Range\n    Dim row As Integer\n\n    Set MainSheet = Sheet1\n    MainSheet.Select\n\n    Set tabRng = MainSheet.Range(\"table3\")\n\n    row = 1\n    Do While row &lt; tabRng.Rows.Count + 1:\n      Set rng = tabRng.Rows(row)\n      Set found = rng.Find(\"*\", rng.Cells(, 1), SearchDirection:=xlPrevious)\n      If found Is Nothing Then\n         tabRng.Rows(row).EntireRow.Delete Shift:=xlUp\n      Else\n         row = row + 1\n      End If\n    Loop\nEnd Sub\n</code></pre>\n\n<p>If you find any bugs, please let me know.  Aside from not deleting entries that had blanks in them, it worked for whatever test data I used.</p>\n"}], "owner": {"reputation": 1, "user_id": 7466957, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f342b373e37f8c44c8e253132451a7f1?s=128&d=identicon&r=PG&f=1", "display_name": "Atif Khan", "link": "https://stackoverflow.com/users/7466957/atif-khan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 3410, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1485355687, "creation_date": 1485314580, "last_edit_date": 1531161705, "question_id": 41842855, "link": "https://stackoverflow.com/questions/41842855/delete-empty-rows-in-an-excel-table-using-vba", "title": "Delete empty rows in an Excel table using VBA", "body": "<p>I am trying to run a code to delete rows when the whole row has no data. I am currently using the code below, but it is deleting rows when even one cell is empty. I think I need to use intersect function but not sure how to as yet.</p>\n\n<pre><code>    Dim Rng As Range\n    Dim MainSheet As Worksheet\n    Set MainSheet = Sheet9\n    MainSheet.Select\n\n    On Error Resume Next\n    Set Rng = MainSheet.Range(\"table3\").SpecialCells(xlCellTypeBlanks)\n\n    On Error Resume Next\n    If Not Rng Is Nothing Then\n       Rng.Delete Shift:=xlUp\n    End If\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 33, "user_id": 7039339, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6db0a8663bc6d8bebfd3689ff025842b?s=128&d=identicon&r=PG&f=1", "display_name": "SakuraiHiro", "link": "https://stackoverflow.com/users/7039339/sakuraihiro"}, "edited": false, "score": 0, "creation_date": 1485313777, "post_id": 41842676, "comment_id": 70870297, "body": "the macro is suppose to run across multiple sheets"}], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 7039339, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6db0a8663bc6d8bebfd3689ff025842b?s=128&d=identicon&r=PG&f=1", "display_name": "SakuraiHiro", "link": "https://stackoverflow.com/users/7039339/sakuraihiro"}, "edited": false, "score": 0, "creation_date": 1485392432, "post_id": 41847648, "comment_id": 70912305, "body": "I have another excel with similar code (just different email content and template) but for some reason clicking the button does not create the email. It only works when I click run in vba"}], "tags": [], "owner": {"reputation": 150, "user_id": 3980752, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KzaOO.jpg?s=128&g=1", "display_name": "pylund", "link": "https://stackoverflow.com/users/3980752/pylund"}, "is_accepted": true, "score": 0, "last_activity_date": 1485335912, "creation_date": 1485335912, "answer_id": 41847648, "question_id": 41842676, "link": "https://stackoverflow.com/questions/41842676/how-to-assign-thisworkbook-macro-to-form-control/41847648#41847648", "title": "How to assign Thisworkbook macro to Form control", "body": "<p>You have two ways to accomplish this depending on the type of button you want to use to run the macro:</p>\n\n<p>a) If the button is a simply Shape (Insert > Shapes), you need to move the contents of Workbook_Open to a new sub within your Module1 (let's call it \"trigger\") and right-click the shape > Assign macro > \"trigger\".</p>\n\n<pre><code>Sub trigger()\n        Dim ws As Worksheet\n        For Each ws In ThisWorkbook.Worksheets\n            If ws.Cells(1, 1).Value = \"Feedback Report (FR) Log\" Then CheckDates ws:=ws\n            End If\n        Next ws\nEnd Sub\n</code></pre>\n\n<p>b) If the button is not a shape but a form button, you need to double-click it while on the design view and move the contents of \"trigger\" to its own click sub (CommandButton1_click()).</p>\n\n<p>c) Finally, remember to remove the contents of Workbook_Open() sub.</p>\n"}], "owner": {"reputation": 33, "user_id": 7039339, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6db0a8663bc6d8bebfd3689ff025842b?s=128&d=identicon&r=PG&f=1", "display_name": "SakuraiHiro", "link": "https://stackoverflow.com/users/7039339/sakuraihiro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 273, "favorite_count": 0, "accepted_answer_id": 41847648, "answer_count": 1, "score": 0, "last_activity_date": 1490586725, "creation_date": 1485313352, "last_edit_date": 1490586725, "question_id": 41842676, "link": "https://stackoverflow.com/questions/41842676/how-to-assign-thisworkbook-macro-to-form-control", "title": "How to assign Thisworkbook macro to Form control", "body": "<p>I have a workbook to send out email reminders based on the due date. I would like to change it such that the macro will run when I click a button instead of running automatically when it is opened.</p>\n\n<p>ThisWorkbook:</p>\n\n<pre><code>Sub Workbook_Open()\nDim ws As Worksheet\nFor Each ws In ThisWorkbook.Worksheets\n    If ws.Cells(1, 1).Value = \"Feedback Report (FR) Log\" Then CheckDates ws:=ws\nNext ws\nEnd Sub\n</code></pre>\n\n<p>Module1:</p>\n\n<pre><code>Option Explicit\n\nDim Bcell As Range\nDim iTo, iSubject, iBody As String\nDim ImportanceLevel As String\n\nPublic Sub CheckDates(ws As Worksheet)\nFor Each Bcell In Range(\"a4\", Range(\"a\" &amp; Rows.Count).End(xlUp))\n\n    ' if email column is not empty then command continues\n    If Bcell.Offset(0, 15) &lt;&gt; Empty Then         \n\n        ' mail will not be sent if current time is within 23.7 hours\n        '  from time of mail last sent.\n        If Now() - Bcell.Offset(0, 49) &gt; 0.9875 Then\n\n        If Bcell.Offset(0, 25) = Empty Then\n\n        If DateDiff(\"d\", Now(), Bcell.Offset(0, 13)) = 7 Then\n\n        iTo = Bcell.Offset(0, 15)\n\n        iSubject = Bcell &amp; \" Due\"\n\n        iBody = \"&lt;font face=\"\"Calibri\"\" size=\"\"3\"\"&gt;\" &amp; \"Dear all,&lt;br/&gt;&lt;br/&gt;\" &amp; _\n        \"&lt;u&gt;FR No. \" &amp; Bcell &amp; \"&lt;/u&gt;&lt;br/&gt;&lt;br/&gt;\" &amp; \"Please be reminded that \" &amp; Bcell &amp; \" will be due by &lt;b&gt;&lt;FONT COLOR=#ff0000&gt;\" &amp; _\n        Bcell.Offset(0, 13) &amp; \"&lt;/font&gt;&lt;/b&gt;.\" &amp; _\n        \" Kindly ensure that the FR is closed by the due date and provide the draft FR report with preliminary investigation (Section B &amp; D filled) to Quality.&lt;br/&gt;&lt;br/&gt;\" _\n        &amp; \"Thank you&lt;br/&gt;&lt;br/&gt;\" &amp; \"Best Regards,&lt;br/&gt;\" &amp; \"Quality Department&lt;br/&gt;&lt;br/&gt;\" _\n        &amp; \"company Pte Ltd.&lt;br/&gt;\" &amp; \"&lt;/font&gt;\"\n\n        SendEmail\n        Bcell.Offset(0, 49) = Now()\n\n        End If\n        End If\n        End If\n    End If\n            iTo = Empty\n            iSubject = Empty\n            iBody = Empty\n    Next Bcell\n\nEnd Sub\n\n\n\nPrivate Sub SendEmail()\n\n    Dim OutApp As Object\n    Dim OutMail As Object\n    Dim strbody As String\n\n\n    Set OutApp = CreateObject(\"Outlook.Application\")\n    Set OutMail = OutApp.CreateItem(0)\n\n    On Error Resume Next\n\n    With OutMail\n        .To = iTo\n        .CC = \"email@email.com\"\n        .BCC = \"\"\n        .Subject = iSubject\n        .HTMLBody = iBody\n        .Importance = ImportanceLevel\n        'You can add a file like this\n        '.Attachments.Add (\"C:\\test.txt\")\n        .send\n\n    End With\n\n    On Error GoTo 0\n\n    Set OutMail = Nothing\n    Set OutApp = Nothing\n\nEnd Sub\n</code></pre>\n"}]