[{"tags": ["vba", "powerpoint"], "comments": [{"owner": {"reputation": 1, "user_id": 6116205, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3e3b398dea951bd4747591e4c348150a?s=128&d=identicon&r=PG&f=1", "display_name": "davo", "link": "https://stackoverflow.com/users/6116205/davo"}, "edited": false, "score": 0, "creation_date": 1524700885, "post_id": 50032871, "comment_id": 87081926, "body": "IGNORE. As is so often the case - you ask a question and then work out the answer. For those that want to know, Shape(3) is the bullet-point list object on the slide master..."}, {"owner": {"reputation": 3475, "user_id": 2343636, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/dEWuG.jpg?s=128&g=1", "display_name": "Mahib", "link": "https://stackoverflow.com/users/2343636/mahib"}, "edited": false, "score": 0, "creation_date": 1524701101, "post_id": 50032871, "comment_id": 87081977, "body": "Please provide the solution on the answer section. You can answer your question. Anyone else come across this same issue they can see your solution."}], "owner": {"reputation": 1, "user_id": 6116205, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3e3b398dea951bd4747591e4c348150a?s=128&d=identicon&r=PG&f=1", "display_name": "davo", "link": "https://stackoverflow.com/users/6116205/davo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 82, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1524700441, "creation_date": 1524700441, "question_id": 50032871, "link": "https://stackoverflow.com/questions/50032871/vba-applying-bullet-point-style-from-the-slide-master-to-selected-text-boxes", "title": "VBA - applying bullet-point style from the slide master to selected text boxes", "body": "<p>In VBA for PowerPoint, I want to applying bullet-point style from the slide master to selected text boxes. Is this even possible? I've been searching the internet for ages on this, and can't seem to find anything even close.</p>\n\n<p>I can select or place text boxes on the slide in VBA, but I want to use the bullet-point layout as defined on the slide master - I just don't know how to select it, and once selected I assume I use the Shape.PickUp and Apply (or is there another way of doing this that I haven't thought of?)</p>\n\n<p>Any help greatly appreciated.</p>\n\n<p>David.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "is_accepted": false, "score": 0, "last_activity_date": 1524698373, "creation_date": 1524698373, "answer_id": 50032640, "question_id": 50032475, "link": "https://stackoverflow.com/questions/50032475/editing-a-comment-and-retaining-formatting-using-vba/50032640#50032640", "title": "Editing a comment and retaining formatting using VBA", "body": "<p>This changes all new characters at once (if the new comment is only one font size, and Bold)</p>\n\n<hr>\n\n<pre><code>Option Explicit\n\nPublic Sub AddDifferentComment(ByRef toRng As Range, ByRef newRng As Range)\n    Dim toTxt As TextFrame, newTxt As TextFrame, newStart As Long, divLine As String\n\n    divLine = Chr(10) &amp; \"---------------------------\" &amp; Chr(10)\n\n    Set newTxt = newRng.Comment.Shape.TextFrame\n    Set toTxt = toRng.Comment.Shape.TextFrame\n\n    newStart = toTxt.Characters.Count + Len(divLine) + 1\n\n    toRng.Comment.Text divLine &amp; newTxt.Characters.Text, newStart\n\n    With toTxt.Characters(newStart, newTxt.Characters.Count + 1).Font\n        .Size = newTxt.Characters.Font.Size\n        .Bold = newTxt.Characters.Font.Bold\n    End With\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p>I haven't measured it but it's probably faster</p>\n"}], "owner": {"reputation": 1, "user_id": 9700402, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/367733ad491c9c319092ba41cd667456?s=128&d=identicon&r=PG&f=1", "display_name": "BenW", "link": "https://stackoverflow.com/users/9700402/benw"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 381, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1524698373, "creation_date": 1524697083, "last_edit_date": 1531164843, "question_id": 50032475, "link": "https://stackoverflow.com/questions/50032475/editing-a-comment-and-retaining-formatting-using-vba", "title": "Editing a comment and retaining formatting using VBA", "body": "<p>I  have a workbook where i am comparing two worksheets that should be identical for the most part, including comments. When there is a difference, I am marking the cell yellow in the main sheet and then creating a formatted comment with details on what is different. That cell will now have BOTH comments.</p>\n\n<p>As many of the cells have formatted comments already, I have created a function that inserts a new comment at the end of an existing comment and keeps the formatting of both comments.</p>\n\n<p>Below is the code for what i have. This would be called after i compare the comment text of the two fields and determine they are different.</p>\n\n<p>The code seems to work fine. However copying one character at a is inefficient. I would be able to insert the comment with something like TF.Characters(TF.Characters.Count+1).Insert (DiffR.Comment.text). But how can i copy over the font structure for the bold and size formatting of the comment with a single statement using SOMETHING LIKE TF.Characters(start position before the copy,start position before the copy + copytf.characters.count).Font = CopyTF(0,copytf.characters.count).font? This doesn't seem to work...</p>\n\n<pre><code>Public Sub AddDifferentComment(R As Range, DiffR As Range)\nDim TF As TextFrame, CopyTF As TextFrame, theChar As String\nDim SeparatorStr As String\nDim i As Integer\n\nSeparatorStr = Chr(10) &amp; \"---------------------------\" &amp; Chr(10)\n\n\nSet TF = R.Comment.Shape.TextFrame\nSet CopyTF = DiffR.Comment.Shape.TextFrame\n\nTF.Characters(TF.Characters.Count).Insert (SeparatorStr)\n\nFor i = 1 To CopyTF.Characters.Count\n    theChar = CopyTF.Characters(i, 1).text\n    TF.Characters(TF.Characters.Count + 1).Insert (theChar)\n    TF.Characters(TF.Characters.Count).Font.Bold = CopyTF.Characters(i, 1).Font.Bold\n    TF.Characters(TF.Characters.Count).Font.Size = CopyTF.Characters(i, 1).Font.Size\nNext i\nEnd Sub\n</code></pre>\n\n<p>Another way to view this is: Is there an efficient way to make one comment equal to FORMATTED comments of two different cells, concatenated?</p>\n\n<p>I also tried to do this with storing arrays of characters as the format changed, which works but is surprisingly slow when i review the character by character.  If this could be sped up it would be fine.</p>\n\n<pre><code>Public Sub GetFormattedStringsFromComment(R As Range, ByRef strCommentA() As String, ByRef bBoldA() As Boolean, ByRef theSizeA() As Integer, ArrayCount As Integer)\nDim TF As TextFrame\nDim i As Integer, bLastBold As Boolean, LastSize As Integer, bNewFormat As Boolean, theStr As String\n\n    If Not HasComment(R) Then Exit Sub\n\n    i = -1\n    Do While strCommentA(i + 1) &lt;&gt; \"\"\n        i = i + 1\n    Loop\n    ArrayCount = i\n\n    Set TF = R.Comment.Shape.TextFrame\n    For i = 1 To TF.Characters.Count\n        If i &gt; 1 Then\n            'Check to see if it is a changed format and if so add to the arrays\n            If bLastBold &lt;&gt; TF.Characters(i, 1).Font.Bold Or LastSize &lt;&gt; TF.Characters(i, 1).Font.Size Then\n                ArrayCount = ArrayCount + 1\n                strCommentA(ArrayCount) = theStr\n                bBoldA(ArrayCount) = bLastBold\n                theSizeA(ArrayCount) = LastSize\n                theStr = \"\"\n            End If\n        End If\n        theStr = theStr &amp; TF.Characters(i, 1).text\n        bLastBold = TF.Characters(i, 1).Font.Bold\n        LastSize = TF.Characters(i, 1).Font.Size\n    Next i\n    ArrayCount = ArrayCount + 1\n    strCommentA(ArrayCount) = theStr\n    bBoldA(ArrayCount) = bLastBold\n    theSizeA(ArrayCount) = LastSize\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 9642715, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32383bea61a7098c50e18aa9c84de6e3?s=128&d=identicon&r=PG&f=1", "display_name": "mostlydeleted", "link": "https://stackoverflow.com/users/9642715/mostlydeleted"}, "edited": false, "score": 0, "creation_date": 1524779563, "post_id": 50032541, "comment_id": 87121199, "body": "Tim, this worked quite well! Thank you so much! My only issue is then getting the icon to display. I thought that if I was embedding it as I would an object through the insert tab, it would just display the Adobe PDF icon. Is there a way to have it just default to a standard icon? Or define the icon for all of the objects that are being embedded? Also, I&#39;m assuming that if I want to change the offset of where it overlays the icon, I just need to adjust the Offset argument?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 3, "user_id": 9642715, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32383bea61a7098c50e18aa9c84de6e3?s=128&d=identicon&r=PG&f=1", "display_name": "mostlydeleted", "link": "https://stackoverflow.com/users/9642715/mostlydeleted"}, "edited": false, "score": 0, "creation_date": 1524782325, "post_id": 50032541, "comment_id": 87122057, "body": "If you record a macro while inserting a file it will give you the type of parameters you need to supply: they are file-type-specific, but you could maybe substitute a generic icon for all files.  Yes, the Offset controls the placement -in this case a zero offset for row and one column over to the right."}, {"owner": {"reputation": 3, "user_id": 9642715, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32383bea61a7098c50e18aa9c84de6e3?s=128&d=identicon&r=PG&f=1", "display_name": "mostlydeleted", "link": "https://stackoverflow.com/users/9642715/mostlydeleted"}, "edited": false, "score": 0, "creation_date": 1525098751, "post_id": 50032541, "comment_id": 87222192, "body": "Great! Thanks so much Tim this is exactly what I needed."}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 0, "last_activity_date": 1524697517, "creation_date": 1524697517, "answer_id": 50032541, "question_id": 50032332, "link": "https://stackoverflow.com/questions/50032332/embedding-contextual-object-icon-using-excel-vba/50032541#50032541", "title": "Embedding Contextual Object Icon using Excel VBA", "body": "<p>Try this.</p>\n\n<p>Note if you want to use <code>DisplayAsIcon:=True</code> then you need to supply the path to the icon file and the index. </p>\n\n<p><a href=\"https://msdn.microsoft.com/en-us/vba/excel-vba/articles/oleobjects-add-method-excel\" rel=\"nofollow noreferrer\">https://msdn.microsoft.com/en-us/vba/excel-vba/articles/oleobjects-add-method-excel</a></p>\n\n<pre><code>Sub Insert_PDF_Object()\n    Dim c As Range, fName\n    Set c = ActiveSheet.Range(\"A2\")\n\n    Do While Len(c.Value) &gt; 0\n\n        fName = \"c:\\_Stuff\\Test\\\" &amp; c.Value &amp; \".pdf\"\n\n        If Dir(fName, vbNormal) &lt;&gt; \"\" Then\n            c.RowHeight = 80\n            c.Worksheet.OLEObjects.Add Filename:=fName, Link:=False, _\n                DisplayAsIcon:=True, _\n                Left:=c.Offset(0, 1).Left, _\n                Top:=c.Offset(0, 1).Top, _\n                Width:=80, Height:=80\n        End If\n\n        Set c = c.Offset(1, 0)\n    Loop\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 9642715, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32383bea61a7098c50e18aa9c84de6e3?s=128&d=identicon&r=PG&f=1", "display_name": "mostlydeleted", "link": "https://stackoverflow.com/users/9642715/mostlydeleted"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 819, "favorite_count": 0, "accepted_answer_id": 50032541, "answer_count": 1, "score": 0, "last_activity_date": 1524697517, "creation_date": 1524696194, "question_id": 50032332, "link": "https://stackoverflow.com/questions/50032332/embedding-contextual-object-icon-using-excel-vba", "title": "Embedding Contextual Object Icon using Excel VBA", "body": "<p>I'm somewhat inexperienced with VBA coding and need help inserting an object into an Excel spreadsheet based on a cell reference.</p>\n\n<p>What I need to be able to do is pull a PDF in as an object icon based on another cell's contents, overlay it over a specific cell and then move down a row to repeat indefinitely until a blank cell occurs.<br>\nOne problem with this is that the item number in column A may not have a corresponding file that matches it in my file directory, so I need for the code to run regardless of an error in the search for the PDF. Here's an example of the layout of my sheet.  <a href=\"https://i.stack.imgur.com/4nBH7.png\" rel=\"nofollow noreferrer\">Spreadsheet Example</a></p>\n\n<p>Here's the small bit of code that I have cobbled together already, however I'm not confident that it's even remotely usable.</p>\n\n<pre><code>Dim varItem\nSub Insert_PDF_Object()\n\n    Range(\"A2\").Select    \n\n    Do Until IsEmpty(ActiveCell)\n        varItem= ActiveCell.Offset(0, 0)\n        ActiveCell.Offset(0, 0).RowHeight = 80\n        Get_Object\n        ActiveCell.Offset(1, 0).Select\n    Loop\n\n    Range(\"A3\").Select\n\nEnd Sub\n\nSub Get_Object()\n\n        Worksheets(\"Sheet1\").OLEObjects.Add Filename:=\"c:\\Test\\\"&amp; \n            Range(\"A2\").Value &amp; \".pdf\", Link:=False, DisplayAsIcon:=True, \n            Left:=40, Top:=40, Width:=100, Height:=100\nEnd Sub\n</code></pre>\n\n<p>Any help anyone can provide would really be great! </p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 9700470, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94c3bed450871fb91feecbaadd016d8e?s=128&d=identicon&r=PG&f=1", "display_name": "TysYourGuy", "link": "https://stackoverflow.com/users/9700470/tysyourguy"}, "edited": false, "score": 0, "creation_date": 1524748182, "post_id": 50032736, "comment_id": 87103819, "body": "Your suggestion to use DateDiff works perfectly.  Can I used something like <code>Worksheets(&quot;PRT_Scores&quot;).Columns(12).NumberFormat = &quot;h:mm:ss&quot;</code> to make sure that the number format is always set correctly?"}, {"owner": {"reputation": 9743, "user_id": 2127508, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24b1d5bcb39ec4baad76d20c66506318?s=128&d=identicon&r=PG", "display_name": "barrowc", "link": "https://stackoverflow.com/users/2127508/barrowc"}, "reply_to_user": {"reputation": 13, "user_id": 9700470, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94c3bed450871fb91feecbaadd016d8e?s=128&d=identicon&r=PG&f=1", "display_name": "TysYourGuy", "link": "https://stackoverflow.com/users/9700470/tysyourguy"}, "edited": false, "score": 0, "creation_date": 1524779725, "post_id": 50032736, "comment_id": 87121258, "body": "Yes - setting the number format that way should be fine"}], "tags": [], "owner": {"reputation": 9743, "user_id": 2127508, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24b1d5bcb39ec4baad76d20c66506318?s=128&d=identicon&r=PG", "display_name": "barrowc", "link": "https://stackoverflow.com/users/2127508/barrowc"}, "is_accepted": true, "score": 0, "last_activity_date": 1524699242, "creation_date": 1524699242, "answer_id": 50032736, "question_id": 50032221, "link": "https://stackoverflow.com/questions/50032221/how-to-compare-mmss-1-mile-run-times-to-detmine-which-is-faster/50032736#50032736", "title": "How to compare &quot;mm:ss&quot; 1 mile run times to detmine which is faster", "body": "<p>When you call the <a href=\"https://msdn.microsoft.com/en-us/VBA/Language-Reference-VBA/articles/timevalue-function\" rel=\"nofollow noreferrer\">TimeValue function</a>, it expects you to pass it a String that can be interpreted as a time value. When you store a time value in a worksheet cell, it converts the value into a fraction of 24 hours and stores it as a floating point number.</p>\n\n<p>So, the value \"12:00\" in a worksheet cell is stored as \"0.5\" because it is seen as 12 hours. When you then call <code>TimeValue</code> on the value of that cell, it's equivalent to <code>TimeValue(0.5)</code>. The argument passed isn't a String that can be interpreted as a time value and thus you get a type mismatch.</p>\n\n<p>Also, to store the value of 12 minutes and zero seconds in a cell, you need to enter \"00:12:00\" - i.e. use hh:mm:ss format. If you only specify two values then this will be interpreted as hh:mm format which you can verify by inputting a value like \"45:30\".</p>\n\n<p>To actually compare the values, you can try the following (using r1 and r2 to represent the two cells that you want to compare):</p>\n\n<ul>\n<li><code>r1.Value &lt; r2.Value</code></li>\n</ul>\n\n<p>This is the simplest comparison but it could give incorrect results if either of the cells is formatted as Text and stores the time value as a String rather than a floating point number</p>\n\n<ul>\n<li><code>DateDiff(\"s\", r1.Value, r2.Value) &gt; 0</code></li>\n</ul>\n\n<p>The <a href=\"https://msdn.microsoft.com/en-us/VBA/Language-Reference-VBA/articles/datediff-function\" rel=\"nofollow noreferrer\">DateDiff function</a> tells you how many time units have elapsed between two date/time values - the \"s\" parameter indicates that we want to count seconds.</p>\n\n<p>A positive result indicates that the second date/time was later than the first. A negative result indicates that the second date/time was earlier than the first. This function can successfully compare floating point values with string values - <code>DateDiff(\"s\",8.33333333333333E-03,\"00:11:40\")</code> will return -20 as expected.</p>\n\n<ul>\n<li><code>TimeValue(r1.Text) &lt; TimeValue(r2.Text)</code></li>\n</ul>\n\n<p>This uses the displayed text of the worksheet cell rather than the stored value. If the displayed text changes then the comparison could be incorrect. If the cell format was changed from General to Number causing the text to change from \"00:12:00\" to \"0.008333\" then a type mismatch error could occur</p>\n\n<hr>\n\n<p>All three solutions can work in some circumstances but I would lean towards using <code>DateDiff</code>. Comparisons like this are what that function is designed to do</p>\n"}], "owner": {"reputation": 13, "user_id": 9700470, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94c3bed450871fb91feecbaadd016d8e?s=128&d=identicon&r=PG&f=1", "display_name": "TysYourGuy", "link": "https://stackoverflow.com/users/9700470/tysyourguy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 26, "favorite_count": 0, "accepted_answer_id": 50032736, "answer_count": 1, "score": 1, "last_activity_date": 1524699242, "creation_date": 1524695367, "last_edit_date": 1531164843, "question_id": 50032221, "link": "https://stackoverflow.com/questions/50032221/how-to-compare-mmss-1-mile-run-times-to-detmine-which-is-faster", "title": "How to compare &quot;mm:ss&quot; 1 mile run times to detmine which is faster", "body": "<p>I need to compare mile run times with the times listed in the presidential physical fitness chart to determine if a runner's time is faster than the minimum listed in the chart, or not.</p>\n\n<p>This comparison turns cell \"A1\" black</p>\n\n<pre><code>If TimeValue(\"11:00\") &gt; TimeValue(\"10:00\" Then\nRange(\"A1\").Interior.ColorIndex = 5\nEnd If\n</code></pre>\n\n<p>When cell 2,14 contains 12:00 and cell 3,12 contains 11:40 \nThis comparison gives me: Run-time error '13': Type mismatch</p>\n\n<pre><code>If TimeValue(Worksheets(\"Individual_Stats\").Cells(2, 14)) &gt; TimeValue(Worksheets(\"PRT_Scores\").Cells(3, 12)) Then\nRange(\"A1\").Interior.ColorIndex = 5\nEnd If\n</code></pre>\n\n<p>How can I compare two mm:ss times to see which is greater or lesser?</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["vba", "excel", "loops", "worksheet"], "comments": [{"owner": {"reputation": 848, "user_id": 9221684, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gcnG9.jpg?s=128&g=1", "display_name": "warner_sc", "link": "https://stackoverflow.com/users/9221684/warner-sc"}, "edited": false, "score": 0, "creation_date": 1524694907, "post_id": 50031932, "comment_id": 87080368, "body": "What is the sheet name of your column of sheet names?"}, {"owner": {"reputation": 15, "user_id": 9700518, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156135248698672/picture?type=large", "display_name": "Vicky del Real", "link": "https://stackoverflow.com/users/9700518/vicky-del-real"}, "reply_to_user": {"reputation": 848, "user_id": 9221684, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gcnG9.jpg?s=128&g=1", "display_name": "warner_sc", "link": "https://stackoverflow.com/users/9221684/warner-sc"}, "edited": false, "score": 0, "creation_date": 1524697492, "post_id": 50031932, "comment_id": 87081117, "body": "It&#39;s just called Sheet1"}], "answers": [{"tags": [], "owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "is_accepted": true, "score": 0, "last_activity_date": 1524721675, "creation_date": 1524721675, "answer_id": 50035647, "question_id": 50031932, "link": "https://stackoverflow.com/questions/50031932/need-help-on-excel-vba-loop-code-that-creates-new-worksheets-using-cells-in-rang/50035647#50035647", "title": "Need help on Excel VBA loop code that creates new worksheets using cells in range", "body": "<p>Whatever that \u201cBDH\u201d in your formula may be, you may try this:</p>\n\n<pre><code>Sub Macro2()\n    Dim valuesRng As Range, hRng As Range, cell As Range\n\n    With Sheet1\n        Set valuesRng = .Range(\"D1\", .Range(\"D1\").End(xlDown))\n        Set hRng = .Range(\"H2:H5\")\n    End with\n\n    For Each cell in valuesRng\n        With Sheets.Add(After:=Sheets(Sheets.Count))\n            .Name = cell.Value\n            .Range(\"A1\").Value= cell.Value\n            .Range(\"A2:A5\").Value= hRng.Value\n            .Range(\"B6\").FormulaR1C1 = \"=BDH(R[-5]C[-1],R[-2]C[-1],R[-4]C[-1],R[-3]C[-1],)\"\n            .Range(\"D6\").FormulaR1C1 = \"=BDH(R[-5]C[-3],R[-1]C[-3],R[-4]C[-3],R[-3]C[-3],)\"\n        End with\n    Next\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 9700518, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156135248698672/picture?type=large", "display_name": "Vicky del Real", "link": "https://stackoverflow.com/users/9700518/vicky-del-real"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 59, "favorite_count": 0, "accepted_answer_id": 50035647, "answer_count": 1, "score": 0, "last_activity_date": 1524721675, "creation_date": 1524693493, "last_edit_date": 1531164843, "question_id": 50031932, "link": "https://stackoverflow.com/questions/50031932/need-help-on-excel-vba-loop-code-that-creates-new-worksheets-using-cells-in-rang", "title": "Need help on Excel VBA loop code that creates new worksheets using cells in range", "body": "<p>My code below attempts to create a worksheet for each cell value in Column D and then do work in each worksheet 1 at a time (i.e., paste values and run 2 formulas). It errors out on the selection.copy command and the activesheet.name command.</p>\n\n<p>I am looking to create 1 worksheet at a time, run formulas in that worksheet, and repeat instead of adding all of the worksheets at once and then renaming them using the cell values in column D.</p>\n\n<p>I apologize in advance for the lengthiness, I'm a VBA beginner and most of this code came from using the record function.</p>\n\n<pre><code>Sub Macro2()\n\nDim x As Integer\nNumRows = Range(\"D1\", Range(\"D1\").End(xlDown)).Rows.Count\nRange(\"D1\").Select\nFor x = 1 To NumRows\n\n\nSelection.Copy\nSheets.Add After:=ActiveSheet\nActiveSheet.Select\nActiveSheet.Name = Selection.Paste\nActiveSheet.Paste\nSelection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n    :=False, Transpose:=False\nSheets(\"Sheet1\").Select\nRange(\"H2:H5\").Select\nApplication.CutCopyMode = False\nSelection.Copy\nSheets(Selection.Paste).Select\nRange(\"A2\").Select\nActiveSheet.Paste\nRange(\"A5\").Select\nApplication.CutCopyMode = False\nRange(\"B6\").Select\nActiveCell.FormulaR1C1 = \"=BDH(R[-5]C[-1],R[-2]C[-1],R[-4]C[-1],R[-3]C[-1],)\"\nRange(\"D6\").Select\nActiveCell.FormulaR1C1 = \"=BDH(R[-5]C[-3],R[-1]C[-3],R[-4]C[-3],R[-3]C[-3],)\"\nRange(\"D6\").Select\nSheets(Selection.Paste).Select\n\nNext\n\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/HMzR8.png\" rel=\"nofollow noreferrer\">Sheet1</a></p>\n\n<p>Thanks in advance!</p>\n"}, {"tags": ["vba", "ms-word", "mailmerge"], "comments": [{"owner": {"reputation": 9249, "user_id": 9170274, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BrcC8.jpg?s=128&g=1", "display_name": "macropod", "link": "https://stackoverflow.com/users/9170274/macropod"}, "edited": false, "score": 0, "creation_date": 1524788200, "post_id": 50031198, "comment_id": 87123543, "body": "&#171;Currently MS Word only allows for the insertion of 1 mail merge field at a time&#187; While that is true as far as it goes, there is no need to close the mergefields dialogue box between insertions. Unlike a simple field insertion macro, that allows you to insert the fields out of order, so you don&#39;t have to re-arrange them afterwards."}], "answers": [{"tags": [], "owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "is_accepted": true, "score": 1, "last_activity_date": 1524720899, "creation_date": 1524720899, "answer_id": 50035514, "question_id": 50031198, "link": "https://stackoverflow.com/questions/50031198/vba-ms-word-insert-all-mail-merge-fields-into-word-doc-at-once/50035514#50035514", "title": "VBA MS Word - Insert all mail merge fields into Word doc at once", "body": "<p>There's no functionality in Word to insert all merge fields at once, so you need to insert them individually, in a loop.</p>\n\n<p>The following does that, separating each merge field by a space.</p>\n\n<p>(Note: Normally, when you insert something in Word, the target <code>Range</code> encompasses what was inserted - not so with merge fields. That's why <code>Range.Start</code> is moved to the end of the document after each insertion, before adding a space to it. Then the <code>Range</code> needs to be \"collapsed\" beyond that space before doing the next insertion.)</p>\n\n<pre><code>Sub InsertAllMergeFields()\n    Dim doc As word.Document\n    Dim rng As word.Range\n    Dim mm As word.MailMergeDataField\n\n    Set doc = ActiveDocument\n    Set rng = doc.content\n    If doc.MailMerge.MainDocumentType &lt;&gt; wdNotAMergeDocument Then\n        For Each mm In doc.MailMerge.DataSource.DataFields\n            doc.MailMerge.Fields.Add rng, mm.NAME\n            rng.Start = doc.content.End\n            rng.InsertAfter \" \"\n            rng.Collapse wdCollapseEnd\n        Next\n    End If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 27, "user_id": 9700207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/396812f25dac013b6a1c1d0875cf32aa?s=128&d=identicon&r=PG&f=1", "display_name": "Don Don", "link": "https://stackoverflow.com/users/9700207/don-don"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1142, "favorite_count": 0, "accepted_answer_id": 50035514, "answer_count": 1, "score": 1, "last_activity_date": 1576752104, "creation_date": 1524689665, "last_edit_date": 1576752104, "question_id": 50031198, "link": "https://stackoverflow.com/questions/50031198/vba-ms-word-insert-all-mail-merge-fields-into-word-doc-at-once", "title": "VBA MS Word - Insert all mail merge fields into Word doc at once", "body": "<p>Currently MS Word only allows for the insertion of 1 mail merge field at a time. I am looking for a VBA code that would allow me to insert all merge fields into a Word doc at once and/or a code that would input a mail merge field where the name of the same mail merge text appears in the doc.</p>\n\n<p>For the second possibility I have found the following code that allows the user to convert text that matches a mail merge name into a mail merge field one at a time ( <a href=\"http://apsona.com/blog/how-to-quickly-create-merge-fields-in-word/\" rel=\"nofollow noreferrer\">http://apsona.com/blog/how-to-quickly-create-merge-fields-in-word/</a> ). I am dealing with a data source that contains thousands of mail merge fields so ideally I would want to do this for all of them at once or create a loop or something similar.</p>\n\n<pre><code>Sub MakeMergeField()\n\nSelection.Copy\nSelection.Fields.Add Range:=Selection.Range, Type:=wdFieldEmpty, Text:= _\n\"MERGEFIELD \"\"\" + Selection.Text + \"\"\", PreserveFormatting:=True\"\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1524690242, "post_id": 50031143, "comment_id": 87078680, "body": "Without seeing the source worksheet it&#39;s difficult to say what the problem is.  I would suggest though to use <code>Value</code> here, and not <code>Value2</code>"}, {"owner": {"reputation": 315, "user_id": 9057704, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/92b8098293d8382d61623df795e1aa51?s=128&d=identicon&r=PG&f=1", "display_name": "Gregory", "link": "https://stackoverflow.com/users/9057704/gregory"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1524691003, "post_id": 50031143, "comment_id": 87079011, "body": "@TimWilliams I think I have it figured out -- I wasn&#39;t extending my output range to accommodate the unmerged size. Regarding the use of value instead of value2, what&#39;s your reasoning for this?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1524691531, "post_id": 50031143, "comment_id": 87079240, "body": "If your data has any dates in it then they&#39;ll all be converted to numeric format: <code>Value</code> won&#39;t mess with your data at all."}, {"owner": {"reputation": 315, "user_id": 9057704, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/92b8098293d8382d61623df795e1aa51?s=128&d=identicon&r=PG&f=1", "display_name": "Gregory", "link": "https://stackoverflow.com/users/9057704/gregory"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1524691686, "post_id": 50031143, "comment_id": 87079293, "body": "@TimWilliams Very interesting. I was not aware of this limitation for .value2; it seemed to be the clear winner across the board...until you shared this with me, that is LOL"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1524691911, "post_id": 50031143, "comment_id": 87079381, "body": "<a href=\"https://stackoverflow.com/questions/17359835/what-is-the-difference-between-text-value-and-value2\" title=\"what is the difference between text value and value2\">stackoverflow.com/questions/17359835/&hellip;</a>"}, {"owner": {"reputation": 543, "user_id": 7420518, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DweYi.png?s=128&g=1", "display_name": "IvenBach", "link": "https://stackoverflow.com/users/7420518/ivenbach"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1524693998, "post_id": 50031143, "comment_id": 87080080, "body": "@TimWilliams It&#39;s <code>Value2</code> that doesn&#39;t do any conversion."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 543, "user_id": 7420518, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DweYi.png?s=128&g=1", "display_name": "IvenBach", "link": "https://stackoverflow.com/users/7420518/ivenbach"}, "edited": false, "score": 0, "creation_date": 1524695434, "post_id": 50031143, "comment_id": 87080483, "body": "@IvenBach - if I enter &quot;3/16/2018&quot; into a cell and select it, then enter <code>? Selection.Value2</code> in the Immediate pane I get <code>43175</code>.  If I use <code>Value</code> I get <code>3&#47;16&#47;2018</code>, which is what I&#39;d prefer to get if I were putting a whole range into an array."}], "owner": {"reputation": 315, "user_id": 9057704, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/92b8098293d8382d61623df795e1aa51?s=128&d=identicon&r=PG&f=1", "display_name": "Gregory", "link": "https://stackoverflow.com/users/9057704/gregory"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 45, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1524689409, "creation_date": 1524689409, "question_id": 50031143, "link": "https://stackoverflow.com/questions/50031143/having-trouble-pulling-merged-worksheet-into-an-array", "title": "Having trouble pulling merged worksheet into an array", "body": "<p>A report that I pull is horribly setup, and my attempts to fix it are not going well.</p>\n\n<p>I've gotten a good amount of it done, but unmerging all the cells in the used range is rather difficult, because, for some reason, when the report is converted, it reports itself as having 29,000 rows of data (there's really on ~850). </p>\n\n<p>My workaround was to simply pull the entiresheet into an array, thinking that all of the cells will be unmerged / played correctly. Instead, the array seems to be cutting out entire columns of data.</p>\n\n<p>Is there an efficient way to remedy this?</p>\n\n<p>Please find my current code below.</p>\n\n<pre><code>If wbLoop.Name = \"Report.xlsx\" Then\n\n        If wbLoop.Sheets(1).Cells(1, 1).Value2 = \"\" Then wbLoop.Sheets(1).Cells(1, 1).EntireColumn.Delete\n\n        Do Until wbLoop.Sheets(1).Cells(1, 1).Value2 = \"Finance1\"\n            wbLoop.Sheets(1).Cells(1, 1).EntireRow.Delete\n        Loop\n\n        arrReport() = wbLoop.Worksheets(\"Report\").UsedRange.Value2\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 246, "user_id": 9361443, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4adec54ed9e27194eaa721d4f8079d40?s=128&d=identicon&r=PG&f=1", "display_name": "shash", "link": "https://stackoverflow.com/users/9361443/shash"}, "edited": false, "score": 1, "creation_date": 1524688916, "post_id": 50030882, "comment_id": 87078060, "body": "First a suggestion, you edit the above code into a single &#39;If-Else If- End If&#39; tree. Looks neater and will perform better. Now one possible alternative would be to call the macro with a parameter that is a string identifier for the sheet."}], "answers": [{"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 2, "last_activity_date": 1524690023, "last_edit_date": 1524690023, "creation_date": 1524689202, "answer_id": 50031102, "question_id": 50030882, "link": "https://stackoverflow.com/questions/50030882/vba-which-sheet-called-macro-then-do-something/50031102#50031102", "title": "VBA - Which sheet called macro, then do something", "body": "<p>First read this link and adjust your code to remove all unneeded select/activate actions:\n<a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">How to avoid using Select in Excel VBA</a></p>\n\n<p>Then you can do something like this:</p>\n\n<pre><code>If ActiveSheet.Name Like \"Run*\" Then\n    With Worksheets(\"Results\" &amp; Replace(ActiveSheet.Name, \"Run\", \"\"))\n        '? all your charts are called \"Chart 9\"?\n        For Each A In .ChartObjects(\"Chart 9\").Chart.SeriesCollection\n            A.Delete\n        Next A\n        .Activate\n    End With\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 153, "user_id": 8359849, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/4582ae2a3f809e95961ce5cc0ade1106?s=128&d=identicon&r=PG&f=1", "display_name": "dre", "link": "https://stackoverflow.com/users/8359849/dre"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 226, "favorite_count": 0, "accepted_answer_id": 50031102, "answer_count": 1, "score": 0, "last_activity_date": 1524690023, "creation_date": 1524688358, "last_edit_date": 1531161705, "question_id": 50030882, "link": "https://stackoverflow.com/questions/50030882/vba-which-sheet-called-macro-then-do-something", "title": "VBA - Which sheet called macro, then do something", "body": "<p>Is there another way besides Activesheet.Name to get which sheet is calling a macro?</p>\n\n<p>I currently have code where you press a button then it runs a simulation program, then once it runs the program it goes to another sheet in the workbook and pastes information.</p>\n\n<p>This works if I run the macro one at a time on each sheet, but I want to be able to run them all at the same time.</p>\n\n<p>Example:\nI have a input sheet \"Run1\" that contains the button, then once the simulation is done it does something in a sheet called \"Results1\"</p>\n\n<p>I have created duplicate sheets of \"Run1\" and \"Results1\" and incremented the number at the end</p>\n\n<pre><code>If ActiveSheet.Name = \"Run1\" Then\n    t = 1\nEnd If\nIf ActiveSheet.Name = \"Run2\" Then\n    t = 2\nEnd If\nIf ActiveSheet.Name = \"Run3\" Then\n    t = 3\nEnd If\n\nIf ActiveSheet.Name = \"Run4\" Then\n    t = 4\nEnd If\n\nIf ActiveSheet.Name = \"Run5\" Then\n    t = 5\nEnd If\n\nIf ActiveSheet.Name = \"Run6\" Then\n    t = 6\nEnd If\n\nWorksheets(\"Results\" &amp; t).Activate\n\nFor Each A In ActiveSheet.ChartObjects(\"Chart 9\").Chart.SeriesCollection\n    A.Delete\nNext A\n</code></pre>\n\n<p>If I click all the buttons at the same time, it throws an error, because its trying to go to a Results sheet based on which Run sheet the user is currently on. And since the simulation program is running, the code doesn't complete synchronously, excel can't find the Results sheet that the first button macro is calling because it isn't active.</p>\n"}, {"tags": ["json", "xml", "vba", "gateway"], "comments": [{"owner": {"reputation": 4607, "user_id": 5361412, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/NntGT.png?s=128&g=1", "display_name": "Kolob Canyon", "link": "https://stackoverflow.com/users/5361412/kolob-canyon"}, "edited": false, "score": 1, "creation_date": 1524689638, "post_id": 50030869, "comment_id": 87078387, "body": "json programming?"}, {"owner": {"reputation": 39, "user_id": 6835566, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/72ed87f23a65f1907892251177aa9f72?s=128&d=identicon&r=PG&f=1", "display_name": "Dan", "link": "https://stackoverflow.com/users/6835566/dan"}, "reply_to_user": {"reputation": 4607, "user_id": 5361412, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/NntGT.png?s=128&g=1", "display_name": "Kolob Canyon", "link": "https://stackoverflow.com/users/5361412/kolob-canyon"}, "edited": false, "score": 0, "creation_date": 1524690189, "post_id": 50030869, "comment_id": 87078652, "body": "@KolobCanyon yes it looks like it is json programming.  I need the json converted to xml.  I converted it with a converter but I don&#39;t think it is right.  I need that code converted to vba."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1524690493, "post_id": 50030869, "comment_id": 87078785, "body": "Are you sure they even support XML ?"}, {"owner": {"reputation": 39, "user_id": 6835566, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/72ed87f23a65f1907892251177aa9f72?s=128&d=identicon&r=PG&f=1", "display_name": "Dan", "link": "https://stackoverflow.com/users/6835566/dan"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1524692804, "post_id": 50030869, "comment_id": 87079711, "body": "@TimWilliams ok i just found out that they don&#39;t support xml.  I have to submit a json string in vba.  I tried piecing a json string together but it isn&#39;t working. It says that -H isn&#39;t a litteral.  It iwll work if I submit the proper json string to the gateway.  Any ideas on what that would look like?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1524695564, "post_id": 50030869, "comment_id": 87080527, "body": "<a href=\"https://stackoverflow.com/search?q=vba+post+json\">stackoverflow.com/search?q=vba+post+json</a>   You&#39;re confusing the curl tool arguments with the json payload."}], "answers": [{"tags": [], "owner": {"reputation": 39, "user_id": 6835566, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/72ed87f23a65f1907892251177aa9f72?s=128&d=identicon&r=PG&f=1", "display_name": "Dan", "link": "https://stackoverflow.com/users/6835566/dan"}, "is_accepted": false, "score": 0, "last_activity_date": 1524697943, "creation_date": 1524697943, "answer_id": 50032597, "question_id": 50030869, "link": "https://stackoverflow.com/questions/50030869/how-do-you-convert-this-json-programming-to-an-xml-to-submit-via-vba/50032597#50032597", "title": "How do you convert this json programming to an xml to submit via vba", "body": "<p>I needed to submit a json string to get a json response.</p>\n\n<pre><code>XML_Request1 = \"{\" &amp; Chr(34) &amp; \"carrier\" &amp; Chr(34) &amp; \": \" &amp; Chr(34) &amp; \n\"fedex\" &amp; Chr(34) &amp; \",\" &amp; Chr(34) &amp; \"type\" &amp; Chr(34) &amp; \": \" &amp; Chr(34) &amp; \n\"TRACKING_NUMBER_OR_DOORTAG\" &amp; Chr(34) &amp; \",\" &amp; _\nChr(34) &amp; \"action\" &amp; Chr(34) &amp; \": \" &amp; Chr(34) &amp; \"track\" &amp; Chr(34) &amp; \",\" &amp; \nChr(34) &amp; \"parameters\" &amp; Chr(34) &amp; \": {\" &amp; Chr(34) &amp; \"key\" &amp; Chr(34) &amp; \": \" \n&amp; Chr(34) &amp; \"key\" &amp; Chr(34) &amp; \",\" &amp; _\nChr(34) &amp; \"password\" &amp; Chr(34) &amp; \": \" &amp; Chr(34) &amp; \"password\" &amp; Chr(34) &amp; \",\" \n&amp; Chr(34) &amp; \"meterNumber\" &amp; Chr(34) &amp; \": \" &amp; Chr(34) &amp; \"meter number\" &amp; \nChr(34) &amp; \",\" &amp; _\nChr(34) &amp; \"accountNumber\" &amp; Chr(34) &amp; \": \" &amp; Chr(34) &amp; \"account\" &amp; Chr(34) &amp; \n\",\" &amp; Chr(34) &amp; \"service\" &amp; Chr(34) &amp; \": \" &amp; Chr(34) &amp; \n\"GROUND_HOME_DELIVERY\" &amp; Chr(34) &amp; \",\" &amp; _\nChr(34) &amp; \"tracking_number\" &amp; Chr(34) &amp; \": \" &amp; Chr(34) &amp; trackingNumber &amp; \nChr(34) &amp; \"}}\"\n</code></pre>\n\n<p>I went to a json online formatter to put together the proper string:</p>\n\n<pre><code>{\n\"carrier\": \"fedex\",\n\"type\": \"TRACKING_NUMBER_OR_DOORTAG\",\n\"action\": \"track\",\n\"parameters\": {\n  \"key\": \"YOURKEY\",\n  \"password\": \"YOURPASS\",\n  \"meterNumber\": \"YOURMETER\",\n  \"accountNumber\": \"510087348\",\n  \"service\": \"GROUND_HOME_DELIVERY\",\n  \"tracking_number\": \".\"\n }\n}\n</code></pre>\n\n<p>I submitted the payload and got a valid response.</p>\n"}], "owner": {"reputation": 39, "user_id": 6835566, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/72ed87f23a65f1907892251177aa9f72?s=128&d=identicon&r=PG&f=1", "display_name": "Dan", "link": "https://stackoverflow.com/users/6835566/dan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 77, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1524697943, "creation_date": 1524688294, "question_id": 50030869, "link": "https://stackoverflow.com/questions/50030869/how-do-you-convert-this-json-programming-to-an-xml-to-submit-via-vba", "title": "How do you convert this json programming to an xml to submit via vba", "body": "<p>i have this code from a shipping website.  I can submit to the gateway like any other carrier however they don't have a formatted xml example.  They gave this example I wanted to know how to convert it to a properly formatted xml.</p>\n\n<pre><code>curl -X POST \\\nhttps://api.rocketship.it/v1 \\\n-H 'Cache-Control: no-cache' \\\n-H 'Content-Type: application/json' \\\n-H 'x-api-key: YOUR_RS_API_KEY' \\\n-d '{\n\"carrier\": \"UPS\",\n\"action\": \"track\",\n\"params\": {\n    \"username\": \"YOUR_USERNAME\",\n    \"password\": \"YOUR_PASSWORD\",\n    \"tracking_number\": \"1Z12345E0205271688\"\n}\n}'\n</code></pre>\n\n<p>I just need the tags like submitting to fedex or ups.  This is what i submit to transpak.  It has the xml and xmlhttp code to submit it.</p>\n\n<pre><code>XMLRequest1 = \"&lt;?xml version='1.0' encoding='utf-8'?&gt;\" &amp; _\n\"&lt;soap:Envelope xmlns:xsi=\" &amp; Chr(34) &amp; \"http://www.w3.org/2001/XMLSchema- \ninstance\" &amp; Chr(34) &amp; \" xmlns:xsd=\" &amp; Chr(34) &amp; \n\"http://www.w3.org/2001/XMLSchema\" &amp; Chr(34) &amp; \" xmlns:soap=\" &amp; Chr(34) &amp; \n\"http://schemas.xmlsoap.org/soap/envelope/\" &amp; Chr(34) &amp; \"&gt;\" &amp; _\n\"&lt;soap:Body&gt;\" &amp; \"&lt;ShipmentInquiry xmlns=\" &amp; Chr(34) &amp; \"http://tempuri.org/\" \n&amp; Chr(34) &amp; \"&gt;\" &amp; \"&lt;Housebill&gt;\" &amp; trackingNumber &amp; \"&lt;/Housebill&gt;\" &amp; _\n\"&lt;/ShipmentInquiry&gt;\" &amp; \"&lt;/soap:Body&gt;\" &amp; \"&lt;/soap:Envelope&gt;\"\n</code></pre>\n\n<p>That is teh xml that I need to submit to the example I gave above.  I need it formatted similarly.</p>\n\n<pre><code>XML_Method = \"POST\"\n\nXML_Track_URL = \"http://freight.transpak.com/WTKServices/Shipments.asmx\"\n\nOn Error GoTo 0\nTrackTRANSPACK = \"Test\" ' default if not supported or not tracked by request\nSet XMLHTTP = CreateObject(\"Microsoft.xmlhttp\")\nXMLHTTP.Open XML_Method, XML_Track_URL, False\n'xmlhttp.setRequestHeader \"Content-Type\", \"text/xml; charset=utf-8\"\nXMLHTTP.send XML_Request1 ' okay to send blank string, if not needed (non-UPS tracking)\nTrackTRANSPACK = CStr(XMLHTTP.responseText)\n</code></pre>\n\n<p>Any help would be appreciated.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 2, "creation_date": 1524688138, "post_id": 50030749, "comment_id": 87077682, "body": "The limit of a formula array insert is 255 characters with VBA"}, {"owner": {"reputation": 115, "user_id": 8233748, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/43cc9cdb2aa802c95002376797d373a7?s=128&d=identicon&r=PG&f=1", "display_name": "Oliver Bird", "link": "https://stackoverflow.com/users/8233748/oliver-bird"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1524688783, "post_id": 50030749, "comment_id": 87077992, "body": "which means I would need to create ranges for the cells.Thank you! May I ask where you got that info. I want to check it out."}], "answers": [{"comments": [{"owner": {"reputation": 115, "user_id": 8233748, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/43cc9cdb2aa802c95002376797d373a7?s=128&d=identicon&r=PG&f=1", "display_name": "Oliver Bird", "link": "https://stackoverflow.com/users/8233748/oliver-bird"}, "edited": false, "score": 0, "creation_date": 1524689175, "post_id": 50031064, "comment_id": 87078175, "body": "I SEE! That&#39;s creative. Thank you!"}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": true, "score": 1, "last_activity_date": 1524689066, "creation_date": 1524689066, "answer_id": 50031064, "question_id": 50030749, "link": "https://stackoverflow.com/questions/50030749/insert-array-formula-in-excel-vba/50031064#50031064", "title": "Insert Array formula in Excel VBA", "body": "<p>There is an option of last resort:  Use a human.</p>\n\n<p>Have the macro place the formula into the cell as a <code>String</code> and have the user complete the process:</p>\n\n<pre><code>Sub pinocchio()\n    Range(\"D3\") = \"'=1+2\"\n    MsgBox \"User:  Make this into a real array formula\"\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 115, "user_id": 8233748, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/43cc9cdb2aa802c95002376797d373a7?s=128&d=identicon&r=PG&f=1", "display_name": "Oliver Bird", "link": "https://stackoverflow.com/users/8233748/oliver-bird"}, "edited": false, "score": 0, "creation_date": 1524745184, "post_id": 50031213, "comment_id": 87101534, "body": "That&#39;s another elegant way to do that! Awesome"}, {"owner": {"reputation": 9506, "user_id": 2312614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ra7Jm.jpg?s=128&g=1", "display_name": "Subodh Tiwari sktneer", "link": "https://stackoverflow.com/users/2312614/subodh-tiwari-sktneer"}, "reply_to_user": {"reputation": 115, "user_id": 8233748, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/43cc9cdb2aa802c95002376797d373a7?s=128&d=identicon&r=PG&f=1", "display_name": "Oliver Bird", "link": "https://stackoverflow.com/users/8233748/oliver-bird"}, "edited": false, "score": 0, "creation_date": 1524750791, "post_id": 50031213, "comment_id": 87105765, "body": "@OliverBird Thanks! Any automation is incomplete if you are forced to ask the user to take some manual actions. So to me, actually it doesn&#39;t make any sense entering the formula as a regular formula and then ask the user to reenter it as an Array Formula. :)"}], "tags": [], "owner": {"reputation": 9506, "user_id": 2312614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ra7Jm.jpg?s=128&g=1", "display_name": "Subodh Tiwari sktneer", "link": "https://stackoverflow.com/users/2312614/subodh-tiwari-sktneer"}, "is_accepted": false, "score": 2, "last_activity_date": 1524689759, "creation_date": 1524689759, "answer_id": 50031213, "question_id": 50030749, "link": "https://stackoverflow.com/questions/50030749/insert-array-formula-in-excel-vba/50031213#50031213", "title": "Insert Array formula in Excel VBA", "body": "<p>Or you may break the long formula into few parts and replace it in the end with the actual formula like below...</p>\n\n<pre><code>Dim LogicalTest As String, FalseValue As String\n\nLogicalTest = \"('RMS Maint'!$AA$2:$AA$3542=$B$1)*('RMS Maint'!$M$2:$M$3542=$D$2)*('RMS Maint'!$U$2:$U$3542=\"\"Late\"\")*ROW('RMS Maint'!$A$2:$A$3542)=0\"\nFalseValue = \"('RMS Maint'!$AA$2:$AA$3542=$B$1)*('RMS Maint'!$M$2:$M$3542=$D$2)*('RMS Maint'!$U$2:$U$3542=\"\"Late\"\")*ROW('RMS Maint'!$A$2:$A$3542)\"\n\nRange(\"D3\").FormulaArray = \"=IFERROR(INDEX('RMS Maint'!C$1:C$3542,SMALL(IF(\"\"LogicalTest\"\",\"\"\"\",\"\"FalseValue\"\"),ROW('RMS Maint'!1:3541)),1),\"\"\"\")\"\n\nRange(\"D3\").Replace \"\"\"LogicalTest\"\"\", LogicalTest, LookAt:=xlPart\nRange(\"D3\").Replace \"\"\"FalseValue\"\"\", FalseValue, LookAt:=xlPart\n</code></pre>\n"}], "owner": {"reputation": 115, "user_id": 8233748, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/43cc9cdb2aa802c95002376797d373a7?s=128&d=identicon&r=PG&f=1", "display_name": "Oliver Bird", "link": "https://stackoverflow.com/users/8233748/oliver-bird"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 855, "favorite_count": 0, "accepted_answer_id": 50031064, "answer_count": 2, "score": 1, "last_activity_date": 1524689759, "creation_date": 1524687784, "question_id": 50030749, "link": "https://stackoverflow.com/questions/50030749/insert-array-formula-in-excel-vba", "title": "Insert Array formula in Excel VBA", "body": "<p>I recorded the array formula in order to put in VBA. Here is what I have after the recording. However, when I run the Macro, it just doesn't work. </p>\n\n<p>Will it be because of the negative sign?</p>\n\n<p><strong>From Macro</strong></p>\n\n<pre><code>Range(\"D3\").FormulaArray = \"=IFERROR(INDEX('RMS \nMaint'!R1C[-2]:R3542C[-2],SMALL(IF(('RMS Maint'!R2C27:R3542C27=R1C2)*('RMS \nMaint'!R2C13:R3542C13=R2C4)*('RMS Maint'!R2C21:R3542C21=\"\"Late\"\")*ROW('RMS \nMaint'!R2C1:R3542C1)=0,\"\"\"\",('RMS Maint'!R2C27:R3542C27=R1C2)*('RMS \nMaint'!R2C13:R3542C13=R2C4)*('RMS Maint'!R2C21:R3542C21=\"\"Late\"\")*ROW('RMS \nMaint'!R2C1:R3542C1)),ROW('RMS Maint'!R[-2]:R[3538])),1),\"\"\"\")\"\n</code></pre>\n\n<p><strong>From Excel formula</strong></p>\n\n<pre><code>=IFERROR(INDEX('RMS Maint'!C$1:C$3542,SMALL(IF(('RMS \nMaint'!$AA$2:$AA$3542=$B$1)*('RMS Maint'!$M$2:$M$3542=$D$2)*('RMS \nMaint'!$U$2:$U$3542=\"Late\")*ROW('RMS Maint'!$A$2:$A$3542)=0,\"\",('RMS \nMaint'!$AA$2:$AA$3542=$B$1)*('RMS Maint'!$M$2:$M$3542=$D$2)*('RMS \nMaint'!$U$2:$U$3542=\"Late\")*ROW('RMS Maint'!$A$2:$A$3542)),ROW('RMS \nMaint'!1:3541)),1),\"\")\n</code></pre>\n\n<p>The error is <em>1004 - Unable to set the FormulaArray property of the Range class</em></p>\n\n<p>I'm sorry for the code format. It looked terrible.</p>\n"}, {"tags": ["vba", "loops"], "comments": [{"owner": {"reputation": 1941, "user_id": 1267370, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/32MVo.jpg?s=128&g=1", "display_name": "mooseman", "link": "https://stackoverflow.com/users/1267370/mooseman"}, "edited": false, "score": 0, "creation_date": 1524688838, "post_id": 50030621, "comment_id": 87078018, "body": "You never change rng1 inside your loop, so how could it ever end?"}], "answers": [{"tags": [], "owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "is_accepted": false, "score": 0, "last_activity_date": 1524689104, "last_edit_date": 1524689104, "creation_date": 1524688727, "answer_id": 50030976, "question_id": 50030621, "link": "https://stackoverflow.com/questions/50030621/vba-do-delete-column-where-find-is-true-until-find-is-false-then-exit-do/50030976#50030976", "title": "VBA Do (delete column where find is true) Until Find is False then exit do", "body": "<p>Check the search result inside the loop as well</p>\n\n<hr>\n\n<pre><code>Dim rng1 As Range, target1 As String, firstFound As String\n\ntarget1 = \"Income From    Trans\"\n\nSet rng1 = Cells.Find(What:=target1, After:=ActiveCell, LookIn:=xlFormulas, _\n                      LookAt:=xlPart, SearchOrder:=xlByRows, _\n                      SearchDirection:=xlNext, MatchCase:=False)\n\nIf Not rng1 Is Nothing Then\n\n    Do\n\n        firstFound = rng1.Address\n\n        Set rng1 = Cells.Find(What:=target1, After:=ActiveCell, LookIn:=xlValues, _\n                              LookAt:=xlPart, SearchOrder:=xlByRows, _\n                              SearchDirection:=xlNext, MatchCase:=False, _\n                              SearchFormat:=False)\n\n        If Not rng1 Is Nothing Then rng1.EntireColumn.Delete\n\n    Loop While Not rng1 Is Nothing And rng1.Address &lt;&gt; firstFound\n\nEnd If\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 543, "user_id": 7420518, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DweYi.png?s=128&g=1", "display_name": "IvenBach", "link": "https://stackoverflow.com/users/7420518/ivenbach"}, "is_accepted": false, "score": 0, "last_activity_date": 1524688926, "creation_date": 1524688926, "answer_id": 50031025, "question_id": 50030621, "link": "https://stackoverflow.com/questions/50030621/vba-do-delete-column-where-find-is-true-until-find-is-false-then-exit-do/50031025#50031025", "title": "VBA Do (delete column where find is true) Until Find is False then exit do", "body": "<p>Your code <code>Set rng1 = Cells.Find...</code> will set <code>rng1</code> to be a range object, assuming it finds your value. Next is your loop which will ultimately cause <code>rng1</code> to be deleted. It continues to loop because even though <code>rng1</code> is deleted it still was assigned and therefore isn't <code>Nothing</code>. It ends with an <a href=\"https://msdn.microsoft.com/en-us/vba/language-reference-vba/articles/object-variable-not-set-error-91\" rel=\"nofollow noreferrer\">run time error message of 91</a> because <code>rng1</code> was set but deleted. You can see in the locals window View>Locals Window that its type is still <code>Range\\Range</code> even though it's actually been deleted.</p>\n\n<p>You have implicit cell references from the unqualified <code>Cells</code> usage. That means this code will run on whatever worksheet happens to be the <code>ActiveSheet</code>. Implicit references can have unintended side effects when you don't realize this. It's best to fully qualify them so there's no ambiguity as to which sheet they reside on. I'm assuming <code>ActiveCell</code> falls into this category too since you want it to wrap delete until there \"Income from Trans\" is no longer found.</p>\n\n<p>The code <code>.Activate</code> followed by <code>ActiveCell.</code> isn't needed and can be shortened by removing both so it ends up as <code>SearchFormat:=False).EntireColum...</code>. Selecting a range object isn't usually necessary. Joining the two makes it apparent what you're doing.</p>\n\n<p>Below you'll find a simpler version that uses <code>.Find</code> is in your original to find the first instance. After that it uses <a href=\"https://msdn.microsoft.com/en-us/vba/excel-vba/articles/range-findnext-method-excel\" rel=\"nofollow noreferrer\">.FindNext()</a> to continue looping until all are found. This eventually exits because it is setting the range variable <code>found</code> after every deletion, ultimately leaving <code>found</code> as <code>Nothing</code> after it's deleted the last. The <code>RemoveColumns</code> has parameters which allow you to use this on more than just a single sheet.</p>\n\n<pre><code>Sub Test()\n    RemoveColumns Sheet1, \"Income From    Trans\"\nEnd Sub\n\nSub RemoveColumns(ByVal sheetToSearch As Worksheet, ByVal value As String)\n    Dim found As Range\n    Set found = sheetToSearch.Cells.Find(What:=value, After:=sheetToSearch.Range(\"A1\"), LookIn:=xlFormulas, _\n                                LookAt:=xlPart, SearchOrder:=xlByRows, SearchDirection:=xlNext, _\n                                MatchCase:=False)\n    Do Until found Is Nothing\n        found.EntireColumn.Delete\n        Set found = sheetToSearch.Cells.FindNext\n    Loop\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 9700122, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4e710d6d800de9e3baa126249bbe8e47?s=128&d=identicon&r=PG&f=1", "display_name": "j p", "link": "https://stackoverflow.com/users/9700122/j-p"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 87, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1524689107, "creation_date": 1524687274, "last_edit_date": 1524689107, "question_id": 50030621, "link": "https://stackoverflow.com/questions/50030621/vba-do-delete-column-where-find-is-true-until-find-is-false-then-exit-do", "title": "VBA Do (delete column where find is true) Until Find is False then exit do", "body": "<p>I have an excel file that has the text \"Income from Trans\" where I will need to delete the entire column. </p>\n\n<p>This is my current code in VBA 2010 that works until there are no more cells with \"Income from Trans\"; I can't get it to break out of the loop.</p>\n\n<p>Any idea why?</p>\n\n<pre><code>Dim rng1 As Range\nDim target1 As String\n\ntarget1 = \"Income From    Trans\"\nSet rng1 = Cells.Find(What:=target1, _\nAfter:=ActiveCell, _\nLookIn:=xlFormulas, _\nLookAt:=xlPart, _\nSearchOrder:=xlByRows, _\nSearchDirection:=xlNext, _\nMatchCase:=False)\n\nDo Until rng1 Is Nothing\n    Cells.Find(What:=target1, After:=ActiveCell, _\n        LookIn:=xlValues, LookAt:=xlPart, SearchOrder:=xlByRows, \nSearchDirection _\n         :=xlNext, MatchCase:=False, SearchFormat:=False).Activate\nActiveCell.EntireColumn.Delete\nLoop\n</code></pre>\n"}, {"tags": ["excel", "for-loop", "nested-loops", "vba"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1524687283, "post_id": 50030581, "comment_id": 87077274, "body": "Get rid of the second loop and just us <code>a</code> as the counter for both"}, {"owner": {"reputation": 3, "user_id": 9620295, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d9984713cb6a10b280ab483e9cf0e351?s=128&d=identicon&r=PG&f=1", "display_name": "GriffinB", "link": "https://stackoverflow.com/users/9620295/griffinb"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1524687413, "post_id": 50030581, "comment_id": 87077335, "body": "can you elaborate @ScottCraner"}], "answers": [{"tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": true, "score": 0, "last_activity_date": 1524688311, "last_edit_date": 1524688311, "creation_date": 1524687752, "answer_id": 50030741, "question_id": 50030581, "link": "https://stackoverflow.com/questions/50030581/simultaneously-changing-variables-for-loops-vba/50030741#50030741", "title": "Simultaneously changing variables for loops VBA", "body": "<p><em>(based on Scott's comment)</em></p>\n\n<p>Both <em>BRarr1</em> and <em>BRarr2</em> have <code>ubound</code>=14</p>\n\n<p>So only use one loop:</p>\n\n<p>Replace:</p>\n\n<pre><code>For a = LBound(BRarr1) To UBound(BRarr1)\n    For b = LBound(BRarr2) To UBound(BRarr2)\n</code></pre>\n\n<p>with something like:</p>\n\n<pre><code> For ZZ = 0 to 14\n</code></pre>\n\n<p>and use <code>ZZ</code> wherever you used either <code>a</code> or <code>b</code> </p>\n"}], "owner": {"reputation": 3, "user_id": 9620295, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d9984713cb6a10b280ab483e9cf0e351?s=128&d=identicon&r=PG&f=1", "display_name": "GriffinB", "link": "https://stackoverflow.com/users/9620295/griffinb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 251, "favorite_count": 0, "accepted_answer_id": 50030741, "answer_count": 1, "score": 0, "last_activity_date": 1524688311, "creation_date": 1524687109, "last_edit_date": 1531164843, "question_id": 50030581, "link": "https://stackoverflow.com/questions/50030581/simultaneously-changing-variables-for-loops-vba", "title": "Simultaneously changing variables for loops VBA", "body": "<p>Attempting to get BRarr1 and BRarr2 to both change at same time. I am aware that the way it runs currently it will change b before it will change a. </p>\n\n<p>Is there a way to Run something like this so that both sheets change before proceeding through code? </p>\n\n<p>for ex. I need to run through BR01 and BR01A then run through BR5 and BR05A ...etc</p>\n\n<pre><code>Sub BranchAnalysis()\nDim s1 As Worksheet\nDim s2 As Worksheet\nDim a As Integer\nDim b As Integer\nDim BRarr1\nDim BRarr2\n\nBRarr1 = Array(\"BR1\", \"BR5\", \"BR10\", \"BR11\", \"BR13\", \"BR18\", \"BR20\", \"BR21\", \n                \"BR22\", \"BR23\", \"BR25\", \"BR28\", \"BR29\", \"BR33\", \"BR35\")\nBRarr2 = Array(\"BR01A\", \"BR05A\", \"BR10A\", \"BR11A\", \"BR13A\", \"BR18A\", \n              \"BR20A\", \"BR21A\", \"BR22A\", \"BR23A\", \"BR25A\", \"BR28A\", \"BR29A\", \n               \"BR33A\", \"BR35A\")\n\nFor a = LBound(BRarr1) To UBound(BRarr1)\n    For b = LBound(BRarr2) To UBound(BRarr2)\n\n    Set s1 = Workbooks(\"Primary to Network vBG2.xlsm\").Worksheets(\"\" &amp; BRarr1(a) &amp; \"\")\n    Set s2 = Workbooks(\"Primary to Network vBG2.xlsm\").Worksheets(\"\" &amp; BRarr2(b) &amp; \"\")\n\n    r1 = Workbooks(\"Primary to Network vBG2.xlsm\").Worksheets(\"\" &amp; BRarr1(a) &amp; \"\").UsedRange.Rows.count\n    r2 = Workbooks(\"Primary to Network vBG2.xlsm\").Worksheets(\"\" &amp; BRarr2(b) &amp; \"\").UsedRange.Rows.count\n\n    Dim i, j As Long\n\n    'line items count\n    Dim count1 As Long\n    count1 = 0\n    For j = 2 To r2\n        For i = 2 To r1\n        If s2.Cells(j, 1).Value = s1.Cells(i, 1).Value Then\n           count1 = count1 + 1\n           s2.Cells(j, 2).Value = count1\n        Else\n        End If\n        Next i\n        count1 = 0\n    Next j\n\nblah blah more code\n\n    Next b\nnext a\n</code></pre>\n"}, {"tags": ["excel", "whitespace", "trim", "removing-whitespace", "vba"], "comments": [{"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1524686072, "post_id": 50030301, "comment_id": 87076730, "body": "In VBA, it&#39;s not Substitute, it&#39;s <a href=\"https://msdn.microsoft.com/en-us/vba/language-reference-vba/articles/replace-function\" rel=\"nofollow noreferrer\">Replace</a>"}, {"owner": {"reputation": 1275, "user_id": 3597095, "user_type": "registered", "accept_rate": 95, "profile_image": "https://graph.facebook.com/60709793/picture?type=large", "display_name": "obizues", "link": "https://stackoverflow.com/users/3597095/obizues"}, "reply_to_user": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1524686430, "post_id": 50030301, "comment_id": 87076879, "body": "I changed the method from Substitute to Replace, however it is still not removing the white space with the edited method above."}, {"owner": {"reputation": 31907, "user_id": 1016435, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aec5b5b34bc32793b277190147e60b5b?s=128&d=identicon&r=PG", "display_name": "xQbert", "link": "https://stackoverflow.com/users/1016435/xqbert"}, "edited": false, "score": 0, "creation_date": 1524686466, "post_id": 50030301, "comment_id": 87076893, "body": "do you know what ASCII value the white space actually is? It could be non-display characters other than chr(160)..."}, {"owner": {"reputation": 1275, "user_id": 3597095, "user_type": "registered", "accept_rate": 95, "profile_image": "https://graph.facebook.com/60709793/picture?type=large", "display_name": "obizues", "link": "https://stackoverflow.com/users/3597095/obizues"}, "reply_to_user": {"reputation": 31907, "user_id": 1016435, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aec5b5b34bc32793b277190147e60b5b?s=128&d=identicon&r=PG", "display_name": "xQbert", "link": "https://stackoverflow.com/users/1016435/xqbert"}, "edited": false, "score": 0, "creation_date": 1524686562, "post_id": 50030301, "comment_id": 87076941, "body": "@xQbert I did not think of that.  Is there a way I can somehow identify what character it is?"}, {"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1524686719, "post_id": 50030301, "comment_id": 87077019, "body": "<code>=code(right(A1,1))</code>"}, {"owner": {"reputation": 31907, "user_id": 1016435, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aec5b5b34bc32793b277190147e60b5b?s=128&d=identicon&r=PG", "display_name": "xQbert", "link": "https://stackoverflow.com/users/1016435/xqbert"}, "edited": false, "score": 0, "creation_date": 1524686730, "post_id": 50030301, "comment_id": 87077023, "body": "that only checks 1 character at a time however... but it&#39;s a start  ( i can&#39;t think of another way off the cuff  maybe a regular expression to only allow alphanumeric   or maybe ..<a href=\"https://www.techonthenet.com/excel/formulas/alphanumeric.php\" rel=\"nofollow noreferrer\">techonthenet.com/excel/formulas/alphanumeric.php</a>"}, {"owner": {"reputation": 1275, "user_id": 3597095, "user_type": "registered", "accept_rate": 95, "profile_image": "https://graph.facebook.com/60709793/picture?type=large", "display_name": "obizues", "link": "https://stackoverflow.com/users/3597095/obizues"}, "reply_to_user": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1524686860, "post_id": 50030301, "comment_id": 87077075, "body": "@tigeravatar, that is assuming that every cell has trailing whitespace"}, {"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1524687035, "post_id": 50030301, "comment_id": 87077152, "body": "@obizues Hard to give better suggestions without any sample data.  We&#39;re just going off descriptions here.  I&#39;m assuming you can tell which cell has trailing white space that you&#39;re trying to get rid of.  Point the formula to that cell to check the code to get the ascii value."}, {"owner": {"reputation": 31907, "user_id": 1016435, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aec5b5b34bc32793b277190147e60b5b?s=128&d=identicon&r=PG", "display_name": "xQbert", "link": "https://stackoverflow.com/users/1016435/xqbert"}, "edited": false, "score": 0, "creation_date": 1524687178, "post_id": 50030301, "comment_id": 87077219, "body": "Maybe.. <a href=\"https://www.ozgrid.com/forum/forum/help-forums/excel-general/46253-remove-non-alphanumeric-characters-from-a-string\" rel=\"nofollow noreferrer\">ozgrid.com/forum/forum/help-forums/excel-general/&hellip;</a> assuming you only want to keep alphanumeric values no special characters or spaces"}, {"owner": {"reputation": 181, "user_id": 6850280, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/525e4db5ded7a05307f423fd469f935e?s=128&d=identicon&r=PG&f=1", "display_name": "matt2103", "link": "https://stackoverflow.com/users/6850280/matt2103"}, "edited": false, "score": 1, "creation_date": 1524687314, "post_id": 50030301, "comment_id": 87077290, "body": "Record macro-&gt; highlight whitespace-&gt; ctrl+C-&gt; ctrl+H-&gt; ctrl+V-&gt; leave &quot;Replace with&quot; blank and replace all.  Stop recording, use macro as needed."}], "answers": [{"tags": [], "owner": {"reputation": 1275, "user_id": 3597095, "user_type": "registered", "accept_rate": 95, "profile_image": "https://graph.facebook.com/60709793/picture?type=large", "display_name": "obizues", "link": "https://stackoverflow.com/users/3597095/obizues"}, "is_accepted": true, "score": 0, "last_activity_date": 1524687431, "creation_date": 1524687431, "answer_id": 50030660, "question_id": 50030301, "link": "https://stackoverflow.com/questions/50030301/how-can-i-remove-all-trailing-whitespace-from-my-excel-column/50030660#50030660", "title": "How can I remove all trailing whitespace from my excel column?", "body": "<p>It was two parts together:</p>\n\n<p>First convert the non-breaking spaces:</p>\n\n<pre><code>Sub ConvertNonBreakingSpaces()\nDim c As Range\n    For Each c In Selection.Cells\n        c.Value = Replace(c.Value, Chr(160), Chr(32))\n    Next\nEnd Sub\n</code></pre>\n\n<p>Then remove all the normal spaces (chr(32)) using the Trim function.</p>\n\n<pre><code>Sub ClearSpaces()\nDim c As Range\n    For Each c In Selection.Cells\n        c.Value = Trim(c.Value)\n    Next\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1275, "user_id": 3597095, "user_type": "registered", "accept_rate": 95, "profile_image": "https://graph.facebook.com/60709793/picture?type=large", "display_name": "obizues", "link": "https://stackoverflow.com/users/3597095/obizues"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2545, "favorite_count": 0, "accepted_answer_id": 50030660, "answer_count": 1, "score": 1, "last_activity_date": 1524687431, "creation_date": 1524685885, "last_edit_date": 1531161705, "question_id": 50030301, "link": "https://stackoverflow.com/questions/50030301/how-can-i-remove-all-trailing-whitespace-from-my-excel-column", "title": "How can I remove all trailing whitespace from my excel column?", "body": "<p>I used the trim function to remove the trailing spaces in column list of names in excel.  However, there are still quite a few names that have additional whitespace after the name that is not removed.</p>\n\n<p>I also tried to create my own:</p>\n\n<pre><code>Sub NoSpaces()\n    Dim c As Range\n    For Each c In Selection.Cells\n        c.Value = Replace(c.Value, Chr(160), Chr(32))\n    Next\nEnd Sub\n</code></pre>\n\n<p>However, I get the error:</p>\n\n<blockquote>\n  <p>Compile Error:</p>\n  \n  <p>Sub or Function not defined</p>\n</blockquote>\n\n<p>Any help would be appreciated.</p>\n\n<p><strong>Edit: Reflected method change to \"Replace\" as suggested.</strong></p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 5283, "user_id": 485674, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9720c6f1a3dead1c68d0f42776633d4d?s=128&d=identicon&r=PG", "display_name": "Jon Peltier", "link": "https://stackoverflow.com/users/485674/jon-peltier"}, "is_accepted": false, "score": 2, "last_activity_date": 1525048878, "creation_date": 1525048878, "answer_id": 50092671, "question_id": 50030223, "link": "https://stackoverflow.com/questions/50030223/vba-select-all-chart-filter/50092671#50092671", "title": "VBA, select all chart filter", "body": "<p>You need to loop through them all:</p>\n\n<pre><code>Sub UnfilterCategories()\n  Dim iCat As Long, nCat As Long\n  With ActiveChart.ChartGroups(1)\n    nCat = .FullCategoryCollection.Count\n    For iCat = 1 To nCat\n      .FullCategoryCollection(iCat).IsFiltered = False\n    Next\n  End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1245, "user_id": 8462962, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/78712f98200d7713ac696675bbb57d59?s=128&d=identicon&r=PG&f=1", "display_name": "excelguy", "link": "https://stackoverflow.com/users/8462962/excelguy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 815, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1525048878, "creation_date": 1524685582, "question_id": 50030223, "link": "https://stackoverflow.com/questions/50030223/vba-select-all-chart-filter", "title": "VBA, select all chart filter", "body": "<p>How do I select all for chart filters? </p>\n\n<p>Filtering out in vba is</p>\n\n<pre><code>  ActiveChart.ChartGroups(1).FullCategoryCollection(1).IsFiltered = True\n</code></pre>\n\n<p>and filtering in is </p>\n\n<pre><code>ActiveChart.ChartGroups(1).FullCategoryCollection(1).IsFiltered = False\n</code></pre>\n\n<p>The above is done for 1 data point, But how do you select all to filter in(or select all)</p>\n"}, {"tags": ["excel", "vba", "indexing", "match"], "answers": [{"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 0, "last_activity_date": 1524691827, "last_edit_date": 1524691827, "creation_date": 1524691449, "answer_id": 50031571, "question_id": 50030187, "link": "https://stackoverflow.com/questions/50030187/excel-vba-index-match-multiple-criterias-to-return-exact-match/50031571#50031571", "title": "Excel Vba Index Match multiple criterias to return Exact match", "body": "<pre><code>Application.WorksheetFunction.FunctionHere\n</code></pre>\n\n<p>throws a run-time error if something is wrong (such as no match found for example), whereas</p>\n\n<pre><code>Application.FunctionHere\n</code></pre>\n\n<p>will instead return either a result or an error value which you can test using <code>IsError()</code></p>\n\n<p>That doesn't help you with the <code>-1</code> adjustment, so you can't do this all in a single line of code: you need to test each return value before passing them to <code>Index()</code></p>\n\n<pre><code>Sub IndexMatch()\n\n    Dim subIndx, nmIndx, mark\n\n    subIndx = Application.Match([G2], [StSubject], 0)\n    nmIndx = Application.Match([F2], [StName], 0)\n\n    If Not IsError(subIndx) And Not IsError(nmIndx) Then\n        mark = Application.Index([StMark], nmIndx, subIndx - 1)\n    Else\n        mark = \"No Match\"\n    End If\n\n    [H2] = mark\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 9649272, "user_type": "registered", "profile_image": "https://graph.facebook.com/10214244539779666/picture?type=large", "display_name": "Peter Grandjean", "link": "https://stackoverflow.com/users/9649272/peter-grandjean"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 104, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1524691827, "creation_date": 1524685423, "question_id": 50030187, "link": "https://stackoverflow.com/questions/50030187/excel-vba-index-match-multiple-criterias-to-return-exact-match", "title": "Excel Vba Index Match multiple criterias to return Exact match", "body": "<p>I have a vba code that I will use to look for values that meet exact 2 criterias.\nIn most cases the vba returns the expected values\nbut if I change the criterias, or if I enter criterias that are not in the ranges I look into, the VBA returns a wrong value.\nIf the criterias are not met, I would prefer to have a text \"CriteriasNotMet\" shown as result in H2</p>\n\n<p>My code is:</p>\n\n<pre><code>Sub IndexMatch()\nmyName = [F2]\nmySubject = [G2]\nmark = Application.WorksheetFunction.Index([StMark], _\nApplication.WorksheetFunction.Match(myName, ([StName]), 0) + _\nApplication.WorksheetFunction.Match(mySubject, ([StSubject]), 0) - 1)\n\n[H2] = mark\n\nEnd Sub\n</code></pre>\n\n<p>Can anyone explain where I am doing something wrong ?</p>\n\n<p>Thank you and god aften</p>\n\n<p>Peter\nDenmark</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 1, "creation_date": 1524684595, "post_id": 50029786, "comment_id": 87076101, "body": "Have you tried the following?: 1) going to the view tab and <code>Arrange All</code> 2) going to the view tab and <code>Unhide</code> 3) <code>open and repair</code>"}, {"owner": {"reputation": 219, "user_id": 7915605, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/75SYC.jpg?s=128&g=1", "display_name": "Mike Shanahan", "link": "https://stackoverflow.com/users/7915605/mike-shanahan"}, "reply_to_user": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 0, "creation_date": 1524685063, "post_id": 50029786, "comment_id": 87076286, "body": "Unhide!!  That did it!  Repost as an answer and I&#39;ll flag it.  Thanks a million cybernetic.nomad!!"}], "answers": [{"tags": [], "owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "is_accepted": true, "score": 2, "last_activity_date": 1524686015, "creation_date": 1524686015, "answer_id": 50030331, "question_id": 50029786, "link": "https://stackoverflow.com/questions/50029786/xlsm-file-corrupted-beyond-repair/50030331#50030331", "title": "XLSM file corrupted... beyond repair?", "body": "<p>Have you tried the following?</p>\n\n<p>1) going to the view tab and <code>Arrange All</code></p>\n\n<p>2) going to the view tab and <code>Unhide</code> </p>\n\n<p>3) open and repair</p>\n\n<p>You're welcome</p>\n"}], "owner": {"reputation": 219, "user_id": 7915605, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/75SYC.jpg?s=128&g=1", "display_name": "Mike Shanahan", "link": "https://stackoverflow.com/users/7915605/mike-shanahan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 531, "favorite_count": 0, "accepted_answer_id": 50030331, "answer_count": 1, "score": 0, "last_activity_date": 1524686015, "creation_date": 1524683631, "last_edit_date": 1531161705, "question_id": 50029786, "link": "https://stackoverflow.com/questions/50029786/xlsm-file-corrupted-beyond-repair", "title": "XLSM file corrupted... beyond repair?", "body": "<p>I have an Microsoft Excel File that I use for my budget and financial tracking.  It has some simple macros that copy the generic budget, allocates funds to different places, and processes transactions.</p>\n\n<p>My wife was updating this file for the coming month, when she says she accidentally hit a few random keystrokes when our toddler grabbed her arm.  </p>\n\n<p>The keystrokes resulted in closing the file, but now the file will not open at all!  Opening the file prompts the user to enable editing and permit macros, but following your response, no matter what the response, the file is not opened.  Excel remains open, but no workbook !!</p>\n\n<p>Any thoughts on this?  I can share the workbook and the most recently non-corrupted version (last months), but I have no idea how to correct this, if it is even possible.  Any help anyone can provide would be most appreciated!  Thanks!</p>\n"}, {"tags": ["vba", "excel", "powerquery"], "comments": [{"owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "edited": false, "score": 0, "creation_date": 1524684171, "post_id": 50029607, "comment_id": 87075902, "body": "isn&#39;t that initial <code>Application.EnableEvents = False</code> preventing any triggering of <code>Worksheet_Change()</code> event?"}, {"owner": {"reputation": 3, "user_id": 9699588, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-CECLeC12VEo/AAAAAAAAAAI/AAAAAAAAATM/3WFrz9VipV8/photo.jpg?sz=128", "display_name": "Monkey Bunny", "link": "https://stackoverflow.com/users/9699588/monkey-bunny"}, "reply_to_user": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "edited": false, "score": 0, "creation_date": 1524685358, "post_id": 50029607, "comment_id": 87076417, "body": "@DisplayName trying that now. thanks for the feedback."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 9699588, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-CECLeC12VEo/AAAAAAAAAAI/AAAAAAAAATM/3WFrz9VipV8/photo.jpg?sz=128", "display_name": "Monkey Bunny", "link": "https://stackoverflow.com/users/9699588/monkey-bunny"}, "edited": false, "score": 0, "creation_date": 1524684711, "post_id": 50029734, "comment_id": 87076153, "body": "Hey @paul thanks for the response! I need some clarification.  So do I keep the top part?  Also I am super noob with VBA and just have the worksheet level code. I don&#39;t have modules or anything not sure if that would be needed.if this is how it should look it throws an error.  The &quot;Option Explicit&quot; parts shows up under the first sub. Error: &quot;only comments may appear after end sub, end function, or end property."}, {"owner": {"reputation": 3, "user_id": 9699588, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-CECLeC12VEo/AAAAAAAAAAI/AAAAAAAAATM/3WFrz9VipV8/photo.jpg?sz=128", "display_name": "Monkey Bunny", "link": "https://stackoverflow.com/users/9699588/monkey-bunny"}, "edited": false, "score": 0, "creation_date": 1524684765, "post_id": 50029734, "comment_id": 87076179, "body": "Sorry to clarify further - I had two sub initially. When I pasted the code into the second sub to replace it, it puts the Option Explicit into the 1st sub and throws and error."}, {"owner": {"reputation": 3, "user_id": 9699588, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-CECLeC12VEo/AAAAAAAAAAI/AAAAAAAAATM/3WFrz9VipV8/photo.jpg?sz=128", "display_name": "Monkey Bunny", "link": "https://stackoverflow.com/users/9699588/monkey-bunny"}, "edited": false, "score": 0, "creation_date": 1524685662, "post_id": 50029734, "comment_id": 87076549, "body": "it no longer throws a compile error. I saved the code. Saved the excel book. Closed excel and reopened. The value in A2 updated upon refresh but the value in B2 stayed at zero.  Maybe I am missing something at the macro level or module level?"}, {"owner": {"reputation": 3, "user_id": 9699588, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-CECLeC12VEo/AAAAAAAAAAI/AAAAAAAAATM/3WFrz9VipV8/photo.jpg?sz=128", "display_name": "Monkey Bunny", "link": "https://stackoverflow.com/users/9699588/monkey-bunny"}, "edited": false, "score": 0, "creation_date": 1524686059, "post_id": 50029734, "comment_id": 87076725, "body": "Okay so the code works if I manually change the Value in A2, but it doesn&#39;t work if the query runs and updates the A2 value or if I manually refresh it."}, {"owner": {"reputation": 3, "user_id": 9699588, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-CECLeC12VEo/AAAAAAAAAAI/AAAAAAAAATM/3WFrz9VipV8/photo.jpg?sz=128", "display_name": "Monkey Bunny", "link": "https://stackoverflow.com/users/9699588/monkey-bunny"}, "edited": false, "score": 0, "creation_date": 1524687349, "post_id": 50029734, "comment_id": 87077306, "body": "Code change compiled, but same results. The value in A2 and was &gt; than B2, but B2 didn&#39;t update.  To test I set both values in A2 and B2 = 12.  Then ran a refresh to trigger the query. A2 updated to 32, but B2 stayed at 12."}, {"owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "reply_to_user": {"reputation": 3, "user_id": 9699588, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-CECLeC12VEo/AAAAAAAAAAI/AAAAAAAAATM/3WFrz9VipV8/photo.jpg?sz=128", "display_name": "Monkey Bunny", "link": "https://stackoverflow.com/users/9699588/monkey-bunny"}, "edited": false, "score": 0, "creation_date": 1524687551, "post_id": 50029734, "comment_id": 87077400, "body": "I made another change. Can you place a break point in <code>Worksheet_Calculate()</code> on line <code>Me.Range(&quot;B2&quot;).Value2 = Me.Range(&quot;B2&quot;).Value2</code>. If the code execution stops there when you trigger the refresh please press <code>F8</code> to see where the next line of execution will jump"}], "tags": [], "owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "is_accepted": true, "score": 0, "last_activity_date": 1524687751, "last_edit_date": 1524687751, "creation_date": 1524683407, "answer_id": 50029734, "question_id": 50029607, "link": "https://stackoverflow.com/questions/50029607/how-do-i-update-a-cell-based-on-a-triggered-event-using-a-formula/50029734#50029734", "title": "How do I update a cell based on a triggered event using a formula?", "body": "<p>Try replacing your code with this</p>\n\n<hr>\n\n<pre><code>Option Explicit\n\nPrivate Sub Worksheet_Calculate()\n    Me.Range(\"B2\").Value2 = Me.Range(\"B2\").Value2\nEnd Sub\n\nPrivate Sub Worksheet_Change(ByVal Target As Range)\n    If Val(Me.Range(\"A2\")) &gt; Val(Me.Range(\"B2\")) Then\n        Application.EnableEvents = False\n        Me.Range(\"B2\") = Me.Range(\"A2\")\n        Application.EnableEvents = True\n    End If\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p>To place a break point click the gray bar on the left, as in the image bellow</p>\n\n<p><a href=\"https://i.stack.imgur.com/t4vYH.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/t4vYH.png\" alt=\"PlaceABreakPoint\"></a></p>\n"}], "owner": {"reputation": 3, "user_id": 9699588, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-CECLeC12VEo/AAAAAAAAAAI/AAAAAAAAATM/3WFrz9VipV8/photo.jpg?sz=128", "display_name": "Monkey Bunny", "link": "https://stackoverflow.com/users/9699588/monkey-bunny"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 59, "favorite_count": 0, "accepted_answer_id": 50029734, "answer_count": 1, "score": 0, "last_activity_date": 1524687751, "creation_date": 1524682919, "last_edit_date": 1524685464, "question_id": 50029607, "link": "https://stackoverflow.com/questions/50029607/how-do-i-update-a-cell-based-on-a-triggered-event-using-a-formula", "title": "How do I update a cell based on a triggered event using a formula?", "body": "<p>My end goal is have the Power SQL query refresh A2 each minute.\nAfter each update occurs in A2 the macro should compare the value in A2 with the value in B2.</p>\n\n<pre><code>IF A2 &gt; B2 Then B2 = A2 Else B2 = B2\n</code></pre>\n\n<p>Here's what I have tried to hobble together... most of the SO articles all show how to display a message box, but I need a cell to update.</p>\n\n<pre><code>Private Sub Worksheet_Calculate()\n\n    Application.EnableEvents = False\n\n    ActiveSheet.Calculate\n    DoEvents\n\n    With Range(\"B2\")\n        .Value = .Value\n        DoEvents\n    End With\n\n    Application.EnableEvents = True\nEnd Sub\n\nPrivate Sub Worksheet_Change(ByVal Target As Range)\n\n    If Target.Address = \"$A$2\" And Range(\"A2\").Value &gt; Range(\"B2\").Value Then\n        Range(\"B2\").Value = Range(\"A2\").Value\n    End If\n\nEnd Sub\n</code></pre>\n\n<p>Please help! I am able to get message boxes to populate when the value changes, but not get the cell B2 to update if A2 > B2.</p>\n\n<p>Thanks,</p>\n\n<p>PP</p>\n\n<p><a href=\"https://i.stack.imgur.com/BQxAN.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/BQxAN.jpg\" alt=\"View of excel sheet with data populating A2\"></a></p>\n"}, {"tags": ["excel", "excel-2007", "vba"], "comments": [{"owner": {"reputation": 181, "user_id": 6850280, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/525e4db5ded7a05307f423fd469f935e?s=128&d=identicon&r=PG&f=1", "display_name": "matt2103", "link": "https://stackoverflow.com/users/6850280/matt2103"}, "edited": false, "score": 0, "creation_date": 1524682617, "post_id": 50029079, "comment_id": 87075093, "body": "What cell are you referring to with <code>ActiveCell</code>?  Why don&#39;t you just point to it directly with <code>Range(&quot;Ax&quot;)</code> or <code>Cells(x,x)</code>?"}, {"owner": {"reputation": 3, "user_id": 8441056, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11e38ead6753898d15031de5b458e612?s=128&d=identicon&r=PG&f=1", "display_name": "Matt", "link": "https://stackoverflow.com/users/8441056/matt"}, "reply_to_user": {"reputation": 181, "user_id": 6850280, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/525e4db5ded7a05307f423fd469f935e?s=128&d=identicon&r=PG&f=1", "display_name": "matt2103", "link": "https://stackoverflow.com/users/6850280/matt2103"}, "edited": false, "score": 0, "creation_date": 1524682898, "post_id": 50029079, "comment_id": 87075249, "body": "The ActiveCell is the Cell it currently is in as it is having multiple entries added at any given point. So as it is using the LastRow feature wouldnt know which cell to go up to. So A2:ALastRow ID it is adding it for."}, {"owner": {"reputation": 181, "user_id": 6850280, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/525e4db5ded7a05307f423fd469f935e?s=128&d=identicon&r=PG&f=1", "display_name": "matt2103", "link": "https://stackoverflow.com/users/6850280/matt2103"}, "edited": false, "score": 0, "creation_date": 1524685557, "post_id": 50029079, "comment_id": 87076507, "body": "<code>ws.Range(&quot;A&quot; &amp; LastRow)</code> refers to a cell in the last row.  What does <code>CStr(ActiveCell.Row - 1)</code> refer to?  Do you mean to write <code>CStr(LastRow - 1)</code>"}, {"owner": {"reputation": 3, "user_id": 8441056, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11e38ead6753898d15031de5b458e612?s=128&d=identicon&r=PG&f=1", "display_name": "Matt", "link": "https://stackoverflow.com/users/8441056/matt"}, "reply_to_user": {"reputation": 181, "user_id": 6850280, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/525e4db5ded7a05307f423fd469f935e?s=128&d=identicon&r=PG&f=1", "display_name": "matt2103", "link": "https://stackoverflow.com/users/6850280/matt2103"}, "edited": false, "score": 0, "creation_date": 1524686330, "post_id": 50029079, "comment_id": 87076837, "body": "Thanks Sorry, not thinking straight that worked, i am sure i had tried it."}, {"owner": {"reputation": 181, "user_id": 6850280, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/525e4db5ded7a05307f423fd469f935e?s=128&d=identicon&r=PG&f=1", "display_name": "matt2103", "link": "https://stackoverflow.com/users/6850280/matt2103"}, "edited": false, "score": 0, "creation_date": 1524691317, "post_id": 50029079, "comment_id": 87079145, "body": "Great, glad I could help!  I&#39;ve reposted my comment as an answer, if you could accept it, it&#39;d help me a bunch.  Cheers!"}], "answers": [{"tags": [], "owner": {"reputation": 181, "user_id": 6850280, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/525e4db5ded7a05307f423fd469f935e?s=128&d=identicon&r=PG&f=1", "display_name": "matt2103", "link": "https://stackoverflow.com/users/6850280/matt2103"}, "is_accepted": true, "score": 0, "last_activity_date": 1524691212, "creation_date": 1524691212, "answer_id": 50031514, "question_id": 50029079, "link": "https://stackoverflow.com/questions/50029079/how-to-get-a-value-to-call-a-function-in-excel/50031514#50031514", "title": "How to get a value to call a function in excel", "body": "<p>Replace <code>CStr(ActiveCell.Row - 1)</code> with <code>CStr(LastRow - 1)</code></p>\n"}], "owner": {"reputation": 3, "user_id": 8441056, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11e38ead6753898d15031de5b458e612?s=128&d=identicon&r=PG&f=1", "display_name": "Matt", "link": "https://stackoverflow.com/users/8441056/matt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 40, "favorite_count": 0, "accepted_answer_id": 50031514, "answer_count": 1, "score": 0, "last_activity_date": 1524691212, "creation_date": 1524680931, "last_edit_date": 1531164843, "question_id": 50029079, "link": "https://stackoverflow.com/questions/50029079/how-to-get-a-value-to-call-a-function-in-excel", "title": "How to get a value to call a function in excel", "body": "<p>I am trying to get a value return to run a call function in Excel</p>\n\n<p>Sub ID_Num is what i want to call on in the first ws.range of Sub SubmitButton, but i cannot work out how to call a function, so i have tried pulling in the code from the function as shown below. This works once and adds a number but after that it stops - something to do with the ActiveCell.Row part</p>\n\n<pre><code>ws.Range(\"A\" &amp; LastRow).Value = \"=MAX(A2:A\" + CStr(ActiveCell.Row - 1) + \")+1\"    'Adds the ID into Col A &amp; Last Blank Row\"\n</code></pre>\n\n<p>My current code is:</p>\n\n<pre><code>Sub ID_Num()\n\n Dim LastRow As Long, ws As Worksheet\n\nSet ws = Sheets(\"Data\")\n\nActiveCell.Formula = \"=MAX(A1:A\" + CStr(ActiveCell.Row - 1) + \")+1\"\n\nActiveCell.Formula = ActiveCell.Value 'Convert formula to a value\n\nEnd Sub\n\n\n\nSub SubmitButton()\n\nDim LastRow As Long, ws As Worksheet\n\nSet ws = Sheets(\"Data\")\n\nLastRow = ws.Range(\"A\" &amp; Rows.Count).End(xlUp).Row + 1 'Finds the last blank row\n\nws.Range(\"A\" &amp; LastRow).Value = \"=MAX(A2:A\" + CStr(ActiveCell.Row - 1) + \")+1\"    'Adds the ID into Col A &amp; Last Blank Row\"\nws.Range(\"B\" &amp; LastRow).Value = Environ(\"userdomain\") &amp; \"\\\" &amp; Environ(\"username\") 'Adds the UserName into Col B &amp; Last Blank Row\nws.Range(\"C\" &amp; LastRow).Value = Format(Now(), \"dd/mm/yyyy hh:mm\") 'Adds the Date_Time into Col C &amp; Last Blank Row\nws.Range(\"D\" &amp; LastRow).Value = Sheets(\"Form\").Range(\"C5\") 'Adds the Name into Col D &amp; Last Blank Row\nws.Range(\"E\" &amp; LastRow).Value = Sheets(\"Form\").Range(\"C7\") 'Adds the Service into Col E &amp; Last Blank Row\nws.Range(\"F\" &amp; LastRow).Value = Sheets(\"Form\").Range(\"F7\") 'Adds the Team into Col F &amp; Last Blank Row\nws.Range(\"G\" &amp; LastRow).Value = Sheets(\"Form\").Range(\"C9\") 'Adds the Cycle into Col G &amp; Last Blank Row\nws.Range(\"H\" &amp; LastRow).Value = Sheets(\"Form\").Range(\"F5\") 'Adds the Date into Col H &amp; Last Blank Row\nws.Range(\"I\" &amp; LastRow).Value = Sheets(\"Form\").Range(\"C11\") 'Adds the Section into Col I &amp; Last Blank Row\nws.Range(\"J\" &amp; LastRow).Value = Sheets(\"Form\").Range(\"C13\") 'Adds the Functionality into Col J &amp; Last Blank Row\nws.Range(\"K\" &amp; LastRow).Value = Sheets(\"Form\").Range(\"C15\") 'Adds the Form into Col K &amp; Last Blank Row\nws.Range(\"L\" &amp; LastRow).Value = Sheets(\"Form\").Range(\"C17\") 'Adds the Report into Col L &amp; Last Blank Row\nws.Range(\"M\" &amp; LastRow).Value = Sheets(\"Form\").Range(\"C19\") 'Adds the System1_ID into Col M &amp; Last Blank Row\nws.Range(\"N\" &amp; LastRow).Value = Sheets(\"Form\").Range(\"F19\") 'Adds the System2_ID into Col N &amp; Last Blank Row\nws.Range(\"O\" &amp; LastRow).Value = Sheets(\"Form\").Range(\"B22\") 'Adds the Comment into Col O &amp; Last Blank Row\n\n\nEnd Sub\n</code></pre>\n\n<p>Any help would be greatly appreciated. </p>\n"}, {"tags": ["excel", "vba", "excel-formula"], "comments": [{"owner": {"reputation": 715, "user_id": 8716187, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9d379e724336936aa82cb81f348ef72?s=128&d=identicon&r=PG&f=1", "display_name": "Wookies-Will-Code", "link": "https://stackoverflow.com/users/8716187/wookies-will-code"}, "edited": false, "score": 0, "creation_date": 1524680882, "post_id": 50028999, "comment_id": 87074200, "body": "How do you feel about VBA?  This might be a quick Macro or User Defined Function (UDF).  Also might be needlessly difficult to do on the formula bar, but Data Validation rules might help in that regard."}, {"owner": {"user_type": "does_not_exist", "display_name": "user8517443"}, "reply_to_user": {"reputation": 715, "user_id": 8716187, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9d379e724336936aa82cb81f348ef72?s=128&d=identicon&r=PG&f=1", "display_name": "Wookies-Will-Code", "link": "https://stackoverflow.com/users/8716187/wookies-will-code"}, "edited": false, "score": 0, "creation_date": 1524680954, "post_id": 50028999, "comment_id": 87074238, "body": "I&#39;m somewhat comfortable with VBA however I&#39;m unaware how to create a Macro of this nature"}, {"owner": {"reputation": 715, "user_id": 8716187, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9d379e724336936aa82cb81f348ef72?s=128&d=identicon&r=PG&f=1", "display_name": "Wookies-Will-Code", "link": "https://stackoverflow.com/users/8716187/wookies-will-code"}, "edited": false, "score": 0, "creation_date": 1524681184, "post_id": 50028999, "comment_id": 87074351, "body": "Would you want &quot;Complete&quot; or &quot;Incomplete&quot; to be placed in an adjacent column to B##? or would you like an alert box when the sub is finished saying complete if they are all present and incomplete if 1 or more is not?  (Do you want to know which ones are missing and which ones are found?) -- Also important: Are the ranges always going to be the same B1:B100 and C2:C200?  as well as the tab names or tab location in the workbook (1, 2)?  This is very doable, but accounting for potential changes in format is where good programming comes in."}, {"owner": {"user_type": "does_not_exist", "display_name": "user8517443"}, "reply_to_user": {"reputation": 715, "user_id": 8716187, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9d379e724336936aa82cb81f348ef72?s=128&d=identicon&r=PG&f=1", "display_name": "Wookies-Will-Code", "link": "https://stackoverflow.com/users/8716187/wookies-will-code"}, "edited": false, "score": 0, "creation_date": 1524681285, "post_id": 50028999, "comment_id": 87074405, "body": "I would just like one box on the side of the sheet, sitting at the top of column M that has a big green complete or a big red incomplete so the user can easily see if they haven&#39;t updated properly"}, {"owner": {"user_type": "does_not_exist", "display_name": "user8517443"}, "reply_to_user": {"reputation": 715, "user_id": 8716187, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9d379e724336936aa82cb81f348ef72?s=128&d=identicon&r=PG&f=1", "display_name": "Wookies-Will-Code", "link": "https://stackoverflow.com/users/8716187/wookies-will-code"}, "edited": false, "score": 0, "creation_date": 1524681889, "post_id": 50028999, "comment_id": 87074712, "body": "Wookies, thanks for the help, Gary&#39;s students equation worked perfectly for what I needed"}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user8517443"}, "edited": false, "score": 0, "creation_date": 1524681857, "post_id": 50029248, "comment_id": 87074698, "body": "Thank you this worked perfectly well when combined with an If statement,  Much appreciated!"}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 0, "creation_date": 1524681991, "post_id": 50029248, "comment_id": 87074758, "body": "@oryan5000  You are quite welcome! .................you gotta love <code>SUMPRODUCT()</code>"}, {"owner": {"reputation": 715, "user_id": 8716187, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9d379e724336936aa82cb81f348ef72?s=128&d=identicon&r=PG&f=1", "display_name": "Wookies-Will-Code", "link": "https://stackoverflow.com/users/8716187/wookies-will-code"}, "edited": false, "score": 0, "creation_date": 1524682397, "post_id": 50029248, "comment_id": 87074969, "body": "Clever and straight forward - WWC"}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "reply_to_user": {"reputation": 715, "user_id": 8716187, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9d379e724336936aa82cb81f348ef72?s=128&d=identicon&r=PG&f=1", "display_name": "Wookies-Will-Code", "link": "https://stackoverflow.com/users/8716187/wookies-will-code"}, "edited": false, "score": 0, "creation_date": 1524682543, "post_id": 50029248, "comment_id": 87075047, "body": "@Wookies-Will-Code  It is pretty neat, but if there are duplicated values <b>within</b> one of the columns, all bets are off."}, {"owner": {"reputation": 715, "user_id": 8716187, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9d379e724336936aa82cb81f348ef72?s=128&d=identicon&r=PG&f=1", "display_name": "Wookies-Will-Code", "link": "https://stackoverflow.com/users/8716187/wookies-will-code"}, "edited": false, "score": 0, "creation_date": 1524687458, "post_id": 50029248, "comment_id": 87077354, "body": "I was mashing up running each B value versus every C (nested For) with a Boolean break at the first &quot;Not Found&quot; into Incomplete, if you don&#39;t break then you know you reached a a complete status. But . .  other answers came in faster."}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": true, "score": 4, "last_activity_date": 1524681593, "creation_date": 1524681593, "answer_id": 50029248, "question_id": 50028999, "link": "https://stackoverflow.com/questions/50028999/excel-equation-to-determine-if-every-value-in-one-range-has-a-match-with-a-value/50029248#50029248", "title": "Excel Equation to determine if every value in one range has a match with a value in another range", "body": "<p>Well to <strong>count</strong> the number of matches, we can use:</p>\n\n<pre><code>=SUMPRODUCT(COUNTIF(Sheet1!B1:B100,Sheet2!C2:C200))\n</code></pre>\n\n<p>To test if everything in the first sheet can be found in the second sheet:</p>\n\n<pre><code>=SUMPRODUCT(COUNTIF(Sheet1!B1:B100,Sheet2!C2:C200)) = COUNTA(Sheet1!B1:B100)\n</code></pre>\n\n<p>or</p>\n\n<pre><code>=SUMPRODUCT(COUNTIF(Sheet1!B1:B100,Sheet2!C2:C200)) = 100\n</code></pre>\n\n<p>if there are no blanks or dups.</p>\n"}, {"comments": [{"owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "edited": false, "score": 0, "creation_date": 1524682356, "post_id": 50029402, "comment_id": 87074942, "body": "hoping the brave down voter supply any savy advice to enhance my answer"}, {"owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "edited": false, "score": 0, "creation_date": 1524682949, "post_id": 50029402, "comment_id": 87075284, "body": "you are welcome. while... there seem to be some shy guy not appreciating it"}, {"owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "edited": false, "score": 0, "creation_date": 1524684419, "post_id": 50029402, "comment_id": 87076023, "body": "he/she must be veeeery lonely"}], "tags": [], "owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "is_accepted": false, "score": 1, "last_activity_date": 1524682129, "creation_date": 1524682129, "answer_id": 50029402, "question_id": 50028999, "link": "https://stackoverflow.com/questions/50028999/excel-equation-to-determine-if-every-value-in-one-range-has-a-match-with-a-value/50029402#50029402", "title": "Excel Equation to determine if every value in one range has a match with a value in another range", "body": "<p>just to add a VBA solution</p>\n\n<pre><code>Sub columnsMatch()\n    Dim filters As Variant\n    filters = Application.Transpose(Worksheets(\"Sheet2\").Range(\"C2:C200\").Value)\n\n    With Worksheets(\"Sheet1\").Range(\"b1:b100\") 'reference \"Sheet1\" sheet range B1:B100\n        .AutoFilter Field:=1, Criteria1:=filters, Operator:=xlFilterValues ' filter referenced range with values from \"Sheet2\" sheet range C2:C200\n        .Parent.Range(\"M1\").Value = IIf(Application.WorksheetFunction.Subtotal(103, .Cells) = .Count And Not IsError(Application.Match(.Cells(1, 1).Value, filters, 0)), \"Complete\", \"Incomplete\")\n        .Parent.AutoFilterMode = False ' remove filters\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user8517443"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 56, "favorite_count": 0, "accepted_answer_id": 50029248, "answer_count": 2, "score": 1, "last_activity_date": 1524682129, "creation_date": 1524680594, "last_edit_date": 1524681915, "question_id": 50028999, "link": "https://stackoverflow.com/questions/50028999/excel-equation-to-determine-if-every-value-in-one-range-has-a-match-with-a-value", "title": "Excel Equation to determine if every value in one range has a match with a value in another range", "body": "<p>As a completeness check for the user of a financial model, I need an equation that will tell if every product heirarchy has been accounted for.  This means every value in range B1:B100 on Tab1 should be accounted for in range C2:c200 on Tab2.  If this condition is met, the formula should say \"Complete\", if not \"Incomplete\".  Anyone aware of how to create a function like this?</p>\n\n<pre><code>=if(Every value in tab1!b1:b100 has a match in tab2!c2:c200, \"Complete\", \"Incomplete\")\n</code></pre>\n"}, {"tags": ["vba", "outlook", "mailitem"], "answers": [{"comments": [{"owner": {"reputation": 261, "user_id": 6411120, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/12cb89f52df40db97b55b861f636838a?s=128&d=identicon&r=PG&f=1", "display_name": "Prgrm.celeritas", "link": "https://stackoverflow.com/users/6411120/prgrm-celeritas"}, "edited": false, "score": 0, "creation_date": 1524681724, "post_id": 50029186, "comment_id": 87074638, "body": "Thank you for your answer. I should have been clearer, but I have tried it with <code>Set email = Application.ActiveExplorer.ActiveInlineResponse</code> and it does nothing. That is what I meant it does not work."}, {"owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "reply_to_user": {"reputation": 261, "user_id": 6411120, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/12cb89f52df40db97b55b861f636838a?s=128&d=identicon&r=PG&f=1", "display_name": "Prgrm.celeritas", "link": "https://stackoverflow.com/users/6411120/prgrm-celeritas"}, "edited": false, "score": 0, "creation_date": 1524682128, "post_id": 50029186, "comment_id": 87074828, "body": "You can get the <code>EntryID</code> value and try to get a new instance of the item by calling <code>NameSpace.GetItemFromID</code> where you can set the body. Or just display it in a new inspector window by calling the <code>Display</code> method."}, {"owner": {"reputation": 261, "user_id": 6411120, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/12cb89f52df40db97b55b861f636838a?s=128&d=identicon&r=PG&f=1", "display_name": "Prgrm.celeritas", "link": "https://stackoverflow.com/users/6411120/prgrm-celeritas"}, "edited": false, "score": 0, "creation_date": 1524690127, "post_id": 50029186, "comment_id": 87078626, "body": "I was mistaken. I had something else in my code that made the <code>ActiveInlineRespose</code> not work. It works as you you said it would."}, {"owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "reply_to_user": {"reputation": 261, "user_id": 6411120, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/12cb89f52df40db97b55b861f636838a?s=128&d=identicon&r=PG&f=1", "display_name": "Prgrm.celeritas", "link": "https://stackoverflow.com/users/6411120/prgrm-celeritas"}, "edited": false, "score": 0, "creation_date": 1524690185, "post_id": 50029186, "comment_id": 87078650, "body": "Great news! Thank you for letting me know."}], "tags": [], "owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "is_accepted": true, "score": 2, "last_activity_date": 1524681347, "creation_date": 1524681347, "answer_id": 50029186, "question_id": 50028786, "link": "https://stackoverflow.com/questions/50028786/writeable-active-inline-response-in-outlook/50029186#50029186", "title": "Writeable active inline response in outlook", "body": "<blockquote>\n  <p>It works great except that the email has be in its own window (i.e. popped-out) otherwise it will fail.</p>\n</blockquote>\n\n<p>That is because you have the following statement in the code:</p>\n\n<pre><code>Set email = Application.ActiveInspector.CurrentItem\n</code></pre>\n\n<blockquote>\n  <p>However the documentations says that it is read-only, and indeed it does not work.</p>\n</blockquote>\n\n<p>Try to use the following code instead:</p>\n\n<pre><code>Set email = Application.ActiveExplorer.ActiveInlineResponse\n</code></pre>\n\n<p>The <a href=\"https://msdn.microsoft.com/en-us/vba/outlook-vba/articles/explorer-activeinlineresponse-property-outlook\" rel=\"nofollow noreferrer\">ActiveInlineResponse</a> property is read-only, but not the object's properties you are going to use. That means you can't set another mail item to the inline response, but will be able to set up properties of the retrieved item.</p>\n"}, {"comments": [{"owner": {"reputation": 261, "user_id": 6411120, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/12cb89f52df40db97b55b861f636838a?s=128&d=identicon&r=PG&f=1", "display_name": "Prgrm.celeritas", "link": "https://stackoverflow.com/users/6411120/prgrm-celeritas"}, "edited": false, "score": 0, "creation_date": 1524689524, "post_id": 50030516, "comment_id": 87078336, "body": "How do I &quot;merge&quot; two HTML strings?"}, {"owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "reply_to_user": {"reputation": 261, "user_id": 6411120, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/12cb89f52df40db97b55b861f636838a?s=128&d=identicon&r=PG&f=1", "display_name": "Prgrm.celeritas", "link": "https://stackoverflow.com/users/6411120/prgrm-celeritas"}, "edited": false, "score": 0, "creation_date": 1524689997, "post_id": 50030516, "comment_id": 87078557, "body": "Take everything between the <code>&lt;body&gt;</code> and <code>&lt;&#47;body&gt;</code> tags in the first HTML string, insert it immediately after the <code>&lt;body&gt;</code> tag in the second HTML string. You will then need to copy the styles from the headers, etc. Not easy. Let somebody else do the job - do use <code>Selection.Paste</code> in the Word Object Model."}], "tags": [], "owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "is_accepted": false, "score": 0, "last_activity_date": 1524690064, "last_edit_date": 1524690064, "creation_date": 1524686845, "answer_id": 50030516, "question_id": 50028786, "link": "https://stackoverflow.com/questions/50028786/writeable-active-inline-response-in-outlook/50030516#50030516", "title": "Writeable active inline response in outlook", "body": "<p>You cannot concatenate two HTML strings and expect a valid HTML back. The two must be merged.</p>\n\n<p>That being said, use Word Object Model to paste from the clipboard:</p>\n\n<pre><code>Application.ActiveEXplorer.ActiveInlineResponseWordEditor.Application.Selection.Paste() \n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "is_accepted": false, "score": 1, "last_activity_date": 1524719661, "last_edit_date": 1524719661, "creation_date": 1524686983, "answer_id": 50030546, "question_id": 50028786, "link": "https://stackoverflow.com/questions/50028786/writeable-active-inline-response-in-outlook/50030546#50030546", "title": "Writeable active inline response in outlook", "body": "<p><em>Maybe you're trying to work with <a href=\"https://msdn.microsoft.com/en-us/vba/outlook-vba/articles/application-activeexplorer-method-outlook\" rel=\"nofollow noreferrer\">ActiveExplorer + Selection.Item Method (Outlook)</a></em></p>\n\n<p><em>Example</em> </p>\n\n<blockquote>\n<pre><code>Option Explicit\nPublic Sub Example()    \n    Dim email  As Outlook.MailItem\n    Set email = Application.ActiveExplorer.Selection.Item(1)\n        Debug.Print email.Subject ' print on immediate window    \nEnd Sub\n</code></pre>\n</blockquote>\n\n<p><em><a href=\"https://www.slipstick.com/developer/outlook-vba-work-with-open-item-or-select-item/\" rel=\"nofollow noreferrer\">Or Work with both opened and selected items</a></em></p>\n\n<blockquote>\n<pre><code>Function GetCurrentItem() As Object\n    Dim objApp As Outlook.Application\n\n    Set objApp = Application\n\n    On Error Resume Next\n    Select Case TypeName(objApp.ActiveWindow)\n        Case \"Explorer\"\n            Set GetCurrentItem = objApp.ActiveExplorer.Selection.Item(1)\n        Case \"Inspector\"\n            Set GetCurrentItem = objApp.ActiveInspector.CurrentItem\n    End Select\n\n    Set objApp = Nothing\nEnd Function\n</code></pre>\n</blockquote>\n"}], "owner": {"reputation": 261, "user_id": 6411120, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/12cb89f52df40db97b55b861f636838a?s=128&d=identicon&r=PG&f=1", "display_name": "Prgrm.celeritas", "link": "https://stackoverflow.com/users/6411120/prgrm-celeritas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 656, "favorite_count": 0, "accepted_answer_id": 50029186, "answer_count": 3, "score": 1, "last_activity_date": 1592896076, "creation_date": 1524679777, "last_edit_date": 1592896076, "question_id": 50028786, "link": "https://stackoverflow.com/questions/50028786/writeable-active-inline-response-in-outlook", "title": "Writeable active inline response in outlook", "body": "<p>I have the following code from some blog that inserts HTML from the clipboard into an outlook email. </p>\n\n<pre><code>Sub PrependClipboardHTML()\nDim email As Outlook.MailItem\nDim cBoard As DataObject\n\nSet email = Application.ActiveInspector.CurrentItem\nSet cBoard = New DataObject\n\n\ncBoard.GetFromClipboard\nemail.HTMLBody = cBoard.GetText + email.HTMLBody\n\nSet cBoard = Nothing\nSet email = Nothing\n\nEnd Sub\n</code></pre>\n\n<p>It works great except that the email has be in its own window (i.e. popped-out) otherwise it will fail. </p>\n\n<p>I was looking around on the documentation and found <code>Application.ActiveExplorer.ActiveInlineResponse</code> <a href=\"https://msdn.microsoft.com/en-us/vba/outlook-vba/articles/explorer-activeinlineresponse-property-outlook\" rel=\"nofollow noreferrer\">here</a>. </p>\n\n<p>However the documentations says that it is read-only, and indeed it does not work. Is there way to get a writable version of the inline response? </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 217, "user_id": 6699361, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7ed976d9a2cceca3ac3a220c901a4ad1?s=128&d=identicon&r=PG&f=1", "display_name": "Pawel", "link": "https://stackoverflow.com/users/6699361/pawel"}, "edited": false, "score": 1, "creation_date": 1524681582, "post_id": 50028736, "comment_id": 87074562, "body": "I really don&#39;t get what are you trying to do. You want to loop through all the files in the folder in some specific order or just loop through each file in folder and it doesn&#39;t matter which file is first and which is last?"}, {"owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 0, "creation_date": 1524681693, "post_id": 50028736, "comment_id": 87074621, "body": "Have you given any thought to standardizing the files? There are several ways to batch convert XLS to XLSX, also, there are several utilities out there that allow for renaming of files with search/replace, including use of regular expressions to find patterns."}, {"owner": {"reputation": 2242, "user_id": 9101981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a24c02fa607778b89aa21709e3bd534b?s=128&d=identicon&r=PG&f=1", "display_name": "AJD", "link": "https://stackoverflow.com/users/9101981/ajd"}, "edited": false, "score": 1, "creation_date": 1524686854, "post_id": 50028736, "comment_id": 87077070, "body": "Research the <code>FileSystemObject</code> (include a reference to <code>Microsoft Scripting Runtime</code> in your VBA project). This will have tools to help you easily look at the files. However, it is not clear what you are trying to do - how are you as a human choosing which files to check?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1524687281, "post_id": 50028736, "comment_id": 87077272, "body": "Neither &quot;handle&quot; nor &quot;deal with&quot; tell us anything about what you need to achieve here.  What is the significance of the filenames when you&#39;re processing the folder - do you need to take any action based on the specific name, or what?"}, {"owner": {"reputation": 29, "user_id": 9466648, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3edf072b413b8b0f6de716f880159ecf?s=128&d=identicon&r=PG&f=1", "display_name": "Kob", "link": "https://stackoverflow.com/users/9466648/kob"}, "reply_to_user": {"reputation": 217, "user_id": 6699361, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7ed976d9a2cceca3ac3a220c901a4ad1?s=128&d=identicon&r=PG&f=1", "display_name": "Pawel", "link": "https://stackoverflow.com/users/6699361/pawel"}, "edited": false, "score": 0, "creation_date": 1524742666, "post_id": 50028736, "comment_id": 87099813, "body": "Hi @Pawel. Thank you for your comment. I already explained more about the nature of these data and what I really want. Please light up any idea to handle this task for me (Kindly start to read from <b>EDIT</b> part)"}, {"owner": {"reputation": 29, "user_id": 9466648, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3edf072b413b8b0f6de716f880159ecf?s=128&d=identicon&r=PG&f=1", "display_name": "Kob", "link": "https://stackoverflow.com/users/9466648/kob"}, "reply_to_user": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 0, "creation_date": 1524742786, "post_id": 50028736, "comment_id": 87099897, "body": "Hi @cybernetic.nomad. Thank you for your suggestion. I will research more on that."}, {"owner": {"reputation": 29, "user_id": 9466648, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3edf072b413b8b0f6de716f880159ecf?s=128&d=identicon&r=PG&f=1", "display_name": "Kob", "link": "https://stackoverflow.com/users/9466648/kob"}, "reply_to_user": {"reputation": 2242, "user_id": 9101981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a24c02fa607778b89aa21709e3bd534b?s=128&d=identicon&r=PG&f=1", "display_name": "AJD", "link": "https://stackoverflow.com/users/9101981/ajd"}, "edited": false, "score": 0, "creation_date": 1524742935, "post_id": 50028736, "comment_id": 87099996, "body": "Thank you for your suggestion @AJD. I already explained more about what do I want and the nature of these data. Kindly ready it from edit part in case you have more suggestion on this matter."}, {"owner": {"reputation": 29, "user_id": 9466648, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3edf072b413b8b0f6de716f880159ecf?s=128&d=identicon&r=PG&f=1", "display_name": "Kob", "link": "https://stackoverflow.com/users/9466648/kob"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1524743085, "post_id": 50028736, "comment_id": 87100102, "body": "@TimWilliams Sorry for providing too few information. I again explained more on what I want and the nature of these file. Please read it from <b>EDIT</b> part. I am looking forward to hearing your advice."}], "answers": [{"tags": [], "owner": {"reputation": 217, "user_id": 6699361, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7ed976d9a2cceca3ac3a220c901a4ad1?s=128&d=identicon&r=PG&f=1", "display_name": "Pawel", "link": "https://stackoverflow.com/users/6699361/pawel"}, "is_accepted": false, "score": 0, "last_activity_date": 1524682175, "creation_date": 1524682175, "answer_id": 50029415, "question_id": 50028736, "link": "https://stackoverflow.com/questions/50028736/vba-loop-through-non-patterned-files-in-folder-seek-for-opinions-edit/50029415#50029415", "title": "VBA loop through non-patterned files in folder (seek for opinions) [EDIT]", "body": "<p>If you just want to loop through all files in folder use this:</p>\n\n<pre><code>   dim file as variant\n       file = Dir(\"&lt;PathToFolder&gt;\")\n\n        While (file &lt;&gt; \"\")\n        'Your logic here\n        file = Dir\n        wend\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 29, "user_id": 9466648, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3edf072b413b8b0f6de716f880159ecf?s=128&d=identicon&r=PG&f=1", "display_name": "Kob", "link": "https://stackoverflow.com/users/9466648/kob"}, "edited": false, "score": 0, "creation_date": 1524836109, "post_id": 50051001, "comment_id": 87143761, "body": "Thank you for your advice @AJD. I will research and try your suggestion. Thanks :)"}], "tags": [], "owner": {"reputation": 2242, "user_id": 9101981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a24c02fa607778b89aa21709e3bd534b?s=128&d=identicon&r=PG&f=1", "display_name": "AJD", "link": "https://stackoverflow.com/users/9101981/ajd"}, "is_accepted": false, "score": 2, "last_activity_date": 1524772872, "creation_date": 1524772872, "answer_id": 50051001, "question_id": 50028736, "link": "https://stackoverflow.com/questions/50028736/vba-loop-through-non-patterned-files-in-folder-seek-for-opinions-edit/50051001#50051001", "title": "VBA loop through non-patterned files in folder (seek for opinions) [EDIT]", "body": "<p>Firstly, use <code>FileSystemObject</code> (include a reference to <code>Microsoft Scripting Runtime</code> in your VBA project) which has some helpful functions within it. You could always code your own, but why reinvent the wheel in this case?</p>\n\n<p>Don't have time to codes something this morning, so here is the pseudocode:</p>\n\n<pre><code>Open a Folder using your known filepath\nLoop through all the files in the Folder (For each f in Folder.Files\n    extract the date code from your filename (e.g. using RegEx)\n    Add to a collection (e.g. array or Dictionary item) of the filename and the extracted date code (your key).\n(end loop)\nSort your collection based on the extracted date code\n</code></pre>\n\n<p>This now gives you an ordered list of files, which you can open in turn and extract the data. An added bonus is that the key in the collection gives you a consistent date representation which you can use as an index in your collated information.</p>\n"}], "owner": {"reputation": 29, "user_id": 9466648, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3edf072b413b8b0f6de716f880159ecf?s=128&d=identicon&r=PG&f=1", "display_name": "Kob", "link": "https://stackoverflow.com/users/9466648/kob"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 89, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1524772872, "creation_date": 1524679592, "last_edit_date": 1524742371, "question_id": 50028736, "link": "https://stackoverflow.com/questions/50028736/vba-loop-through-non-patterned-files-in-folder-seek-for-opinions-edit", "title": "VBA loop through non-patterned files in folder (seek for opinions) [EDIT]", "body": "<p>I am here for seeking any advice or opinion as I want to loop through every excel files in folder. As you can see from my attached picture, my excel files are different both in file types (.xls &lt;> .xlsx) and filename (especially on 2018). I also need to loop through \"Revised\" or \"revised\" files as well since it is possibly that any file will be revised next time.</p>\n\n<p>And yes, I also did some research on this. My understanding is I need to modify all of the file names into the pattern one before build up a VBA to loop. At first, I thought about decomposing all filenames and put it back in pattern form, but it sound too idealistic. Another way is using the date in each file to label the workbook name, but again I found that those date had different styles. Some files label the date by using string such as \"January 2012\" or \"March 2014\", while the others using the date form such as \"19/08/2013\". </p>\n\n<p>Therefore, I would be appreciated if anyone could suggest me on;</p>\n\n<ol>\n<li>How can I handle with the different file name (.xls and .xlsx) within the same VBA?</li>\n<li>How should I deal with these different file names (some files have \"revised\" at the back; some do not have \"-\" between \"Cons\" and date; and some use month name instead of number)? Are they any pattern that I overlook?</li>\n</ol>\n\n<p>Please noted that I am just a newbie VBA coder, so it would be great if you left your answers with an explanation or any kind of examples. </p>\n\n<p>Many thanks.</p>\n\n<p><strong>--------------------------------------------------------[EDIT]-------------------------------------------------------------------</strong></p>\n\n<p>First of all sorry for my poor explanation before. I provided too few information to understand overall picture. Let's start this over again.</p>\n\n<ol>\n<li><p>My data are about steel consumption which release from the authority\nevery month. My task is to gather all of these data (such as\nproduction, import, export and consumption of every data in each\nrow) and generate into time series pattern (please see attached\nexcel screen) <img src=\"https://i.stack.imgur.com/85Ne8.png\" alt=\"xxx\"></p></li>\n<li><p>As it is possibly that these data will be revised anytime, I thus\ndecide to download all of these file every time in every month (one\nfile per one month). In addition to those revised file, the\nauthority will unexpectedly rename those file for example, from\n\"Cons 201601.xlsx\" into \"Cons 201601 - revised.xlsx)\". This make me\nmore difficult to work on this (please see attached folder for\nreference). <a href=\"https://i.stack.imgur.com/lzS6M.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/lzS6M.png\" alt=\"enter image description here\"></a></p></li>\n<li><p>Moreover, this authority seems to have a problem with file naming as\nthey had different pattern of filename in the past compare to the\npresent ones. Example is per below table; <pre>Cons 201701-Revised.xlsx \nCons 201710-Revised1.xlsx \nCons 201711.xlsx\nCons-200902.xls \nCons-201212_revise.xls \nCons-201401-revised.xls</pre></p></li>\n<li><p>I mention above file name in order to create a VBA to loop through\nthese file, select some content and paste into another workbook in\nchronological order. This means that I cannot use \"Loop while or Do\nwhile function\" in my VBA. At first I decided to use two integer\nvariables, both of which were set for years and months \n(e.g. <code>For i = 2009 to 2018</code> and <code>For j = 1 to 12</code>) in order to created the system of filename (such as <code>filename = \"Cons\" &amp; \"-\" &amp; i &amp; j</code>). But,\nas I stated before, non-patterned name by the authority had\nprevented me from creating this kind of loop.</p></li>\n<li><p>I also tried to use the date in cell B2 in figure 1 to label the\ndate in order to create the loop which I already explained before.\nHowever, again, the authority did not use the same pattern to date\nmonth and year. After I checked with many file, these are example of\nthe date style in cell B2 <pre>January 2012 (string) \nFebruary 2009 (string) \nJan-16 (1/1/2016 date in custom format) </pre></p></li>\n<li><p>Given above limitations, could you guys again suggest me any possible\nway to create chronological loop so as to copy and paste data to another\nworkbook to form a set of time series data for each product?</p></li>\n</ol>\n\n<p>Thank you for your kind help :)</p>\n"}, {"tags": ["excel", "vba", "excel-formula"], "answers": [{"comments": [{"owner": {"reputation": 4329, "user_id": 1406420, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/qApC0.jpg?s=128&g=1", "display_name": "Stryker", "link": "https://stackoverflow.com/users/1406420/stryker"}, "edited": false, "score": 0, "creation_date": 1524679788, "post_id": 50028542, "comment_id": 87073639, "body": "I get a 400 error. Added an image. please see above. Runtime error-1004, Application=-defined or object defined error. I am using Excel 2016"}, {"owner": {"reputation": 4329, "user_id": 1406420, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/qApC0.jpg?s=128&g=1", "display_name": "Stryker", "link": "https://stackoverflow.com/users/1406420/stryker"}, "edited": false, "score": 0, "creation_date": 1524679898, "post_id": 50028542, "comment_id": 87073701, "body": "It is modal pop window showing the error, doesn&#39;t say which line"}, {"owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "reply_to_user": {"reputation": 4329, "user_id": 1406420, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/qApC0.jpg?s=128&g=1", "display_name": "Stryker", "link": "https://stackoverflow.com/users/1406420/stryker"}, "edited": false, "score": 0, "creation_date": 1524679962, "post_id": 50028542, "comment_id": 87073732, "body": "When you hit the error, click \u201cDebug\u201d button and you\u2019ll be brought to the offending line"}, {"owner": {"reputation": 4329, "user_id": 1406420, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/qApC0.jpg?s=128&g=1", "display_name": "Stryker", "link": "https://stackoverflow.com/users/1406420/stryker"}, "edited": false, "score": 0, "creation_date": 1524680083, "post_id": 50028542, "comment_id": 87073805, "body": "The Mainsheet and the error is on this line :             If Application.WorksheetFunction.Subtotal(103, .Cells) &gt; 1 Then .Resize(.Rows.Count - 1).Offset(1).SpecialCells(xlCellTypeVisible).EntireRow.Delet&zwnj;&#8203;e &#39; if any filtered cells other than header then delete their entire row As soon as it reaches .Resize...."}, {"owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "reply_to_user": {"reputation": 4329, "user_id": 1406420, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/qApC0.jpg?s=128&g=1", "display_name": "Stryker", "link": "https://stackoverflow.com/users/1406420/stryker"}, "edited": false, "score": 0, "creation_date": 1524680228, "post_id": 50028542, "comment_id": 87073866, "body": "then &quot;MainSheet&quot; sheet layout is not as you show right after &quot;MainSheet&quot; (i.e. : &quot;ColA ColB  ColC..), is it?"}, {"owner": {"reputation": 4329, "user_id": 1406420, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/qApC0.jpg?s=128&g=1", "display_name": "Stryker", "link": "https://stackoverflow.com/users/1406420/stryker"}, "edited": false, "score": 0, "creation_date": 1524680268, "post_id": 50028542, "comment_id": 87073875, "body": "You are correct, I wanted to show a simple few col. Image is the correct layout."}, {"owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "reply_to_user": {"reputation": 4329, "user_id": 1406420, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/qApC0.jpg?s=128&g=1", "display_name": "Stryker", "link": "https://stackoverflow.com/users/1406420/stryker"}, "edited": false, "score": 0, "creation_date": 1524680387, "post_id": 50028542, "comment_id": 87073932, "body": "then just adapt my code (which is built as per your &quot;MainSheet&quot; original layout) to match your actual &quot;Vendor&quot; column index"}, {"owner": {"reputation": 4329, "user_id": 1406420, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/qApC0.jpg?s=128&g=1", "display_name": "Stryker", "link": "https://stackoverflow.com/users/1406420/stryker"}, "edited": false, "score": 0, "creation_date": 1524680587, "post_id": 50028542, "comment_id": 87074047, "body": "I did adjust but still the same. Changed the col to use G1 instead of C1 as shown in image. but no luck. Here is the modified code:         With .Range(&quot;G1&quot;, .Cells(.Rows.Count, 3).End(xlUp))"}, {"owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "reply_to_user": {"reputation": 4329, "user_id": 1406420, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/qApC0.jpg?s=128&g=1", "display_name": "Stryker", "link": "https://stackoverflow.com/users/1406420/stryker"}, "edited": false, "score": 0, "creation_date": 1524680663, "post_id": 50028542, "comment_id": 87074086, "body": "try typing in Immediate Window (CTRL-G to pop it out) <code>?.Range(&quot;G1&quot;, .Cells(.Rows.Count, 3).End(xlUp)).Address </code> and press return and see if the outcome fits your expectations"}, {"owner": {"reputation": 4329, "user_id": 1406420, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/qApC0.jpg?s=128&g=1", "display_name": "Stryker", "link": "https://stackoverflow.com/users/1406420/stryker"}, "reply_to_user": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "edited": false, "score": 0, "creation_date": 1524681020, "post_id": 50028542, "comment_id": 87074269, "body": "Let us <a href=\"https://chat.stackoverflow.com/rooms/169792/discussion-between-stryker-and-displayname\">continue this discussion in chat</a>."}], "tags": [], "owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "is_accepted": true, "score": 1, "last_activity_date": 1524678908, "creation_date": 1524678908, "answer_id": 50028542, "question_id": 50028401, "link": "https://stackoverflow.com/questions/50028401/excel-delete-rows-if-a-cell-in-a-particular-column-contains-values-found-in-ano/50028542#50028542", "title": "Excel- Delete rows if a cell in a particular column contains values found in another column", "body": "<p>use AutoFilter():</p>\n\n<pre><code>Option Explicit\n\nPublic Sub Find_Vendor()\n    Dim filters As Variant\n    With Sheets(\"LookupColumnSheet\") ' change \"LookupColumnSheet\" to your actual sheet with lookup values name\n        filters = Application.Transpose(.Range(\"A1\", .Cells(.Rows.Count, 1).End(xlUp)).Value) ' collect \"LookupColumnSheet\" sheet column A values from row 1 down to last not empty row\n    End With\n\n    With Sheets(\"MainSheet\") 'reference \"MainSheet\" sheet (change \"MainSheet\" to your actual \"MainSheet\" sheet name\n        With .Range(\"C1\", .Cells(.Rows.Count, 3).End(xlUp)) ' reference referenced sheet column C cells from row 1 down to last not empty one\n            .AutoFilter Field:=1, Criteria1:=filters, Operator:=xlFilterValues ' filter referenced range with values from \"LookupColumnSheet\" sheet column A\n            If Application.WorksheetFunction.Subtotal(103, .Cells) &gt; 1 Then .Resize(.Rows.Count - 1).Offset(1).SpecialCells(xlCellTypeVisible).EntireRow.Delete ' if any filtered cells other than header then delete their entire row\n        End With\n        .AutoFilterMode = False ' remove filters\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 4329, "user_id": 1406420, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/qApC0.jpg?s=128&g=1", "display_name": "Stryker", "link": "https://stackoverflow.com/users/1406420/stryker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 608, "favorite_count": 0, "accepted_answer_id": 50028542, "answer_count": 1, "score": 0, "last_activity_date": 1524680107, "creation_date": 1524678328, "last_edit_date": 1524680107, "question_id": 50028401, "link": "https://stackoverflow.com/questions/50028401/excel-delete-rows-if-a-cell-in-a-particular-column-contains-values-found-in-ano", "title": "Excel- Delete rows if a cell in a particular column contains values found in another column", "body": "<p>I want to delete all the rows if the value in Vendor column is found in another column. (lookupVendor Col in another sheet)</p>\n\n<p><a href=\"https://i.stack.imgur.com/X9uho.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/X9uho.png\" alt=\"enter image description here\"></a></p>\n\n<p><strong><code>MainSheet</code></strong></p>\n\n<p><strong><code>LookupColumn</code></strong></p>\n\n<pre><code>VendorCol\ngoogle \nmicrosoft\napple\nvendorA\nVendorB\n</code></pre>\n\n<p>Here is what I have but it only delete for one value.\nHow can I make it use the entire LookupColumn and detete any rows that colc value is found in lookupColumn.\nMy simple VBA code handles one value at a time.(which is not efficient)</p>\n\n<pre><code>Sub Find_Vendor()\n    Dim rng As Range\n    Dim what As String\n    what = \"Microsoft\"\n    Do\n        Set rng = ActiveSheet.UsedRange.Find(what)\n        If rng Is Nothing Then\n            Exit Do\n        Else\n            Rows(rng.Row).Delete\n        End If\n    Loop\nEnd Sub\n</code></pre>\n\n<p>Mainsheet: Contains 600,000 rows\nLookupColumn contains 400 entries.\nThe existing code is super slow for the volume of data I have.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 39, "user_id": 9603305, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd2946a28ea3815dfc18e060ce9e920a?s=128&d=identicon&r=PG&f=1", "display_name": "AJames", "link": "https://stackoverflow.com/users/9603305/ajames"}, "is_accepted": true, "score": 0, "last_activity_date": 1526608752, "last_edit_date": 1526608752, "creation_date": 1525913516, "answer_id": 50263989, "question_id": 50028386, "link": "https://stackoverflow.com/questions/50028386/adding-cell-border-based-on-value-of-2-cells-in-a-range/50263989#50263989", "title": "Adding Cell border based on value of 2 cells in a range", "body": "<p>no code yet, but i will default the border to be xlbottom and then make 2 if then tests to remove border and add it to the next range</p>\n\n<p>Edited with code:</p>\n\n<pre><code>FirstRow = FirstRow + 1\nSet pdRng = Range(\"A\" &amp; FirstRow - 1)\nSet piRng = Range(\"C\" &amp; FirstRow - 1)\nDo Until FirstRow = LastRow + 1\n    Set dRng = Range(\"A\" &amp; FirstRow)\n    Set iRng = Range(\"C\" &amp; FirstRow)\n    If dRng &lt;&gt; pdRng Or iRng &lt;&gt; piRng Then\n        Range(\"A\" &amp; FirstRow &amp; \":I\" &amp; FirstRow).Borders(xlEdgeBottom).LineStyle = xlContinuous\n        FirstRow = FirstRow + 1\n        Set pdRng = Range(\"A\" &amp; FirstRow - 1)\n        Set piRng = Range(\"C\" &amp; FirstRow - 1)\n    Else\n        dRng.ClearContents\n        Range(\"A\" &amp; FirstRow &amp; \":I\" &amp; FirstRow).Borders(xlEdgeTop).LineStyle = xlNone\n        Range(\"A\" &amp; FirstRow &amp; \":I\" &amp; FirstRow).Borders(xlEdgeBottom).LineStyle = xlContinuous\n        FirstRow = FirstRow + 1\n        Set piRng = Range(\"C\" &amp; FirstRow - 1)\n    End If\nLoop\n</code></pre>\n\n<p>Using the following function for FirstRow:</p>\n\n<pre><code>FirstRow = IIf(IsEmpty(Sheets(\"Sheet1\").Range(\"B1\")), Sheets(\"Sheet1\").Range(\"B1\").End(xlDown).Row, 1)\n</code></pre>\n"}], "owner": {"reputation": 39, "user_id": 9603305, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd2946a28ea3815dfc18e060ce9e920a?s=128&d=identicon&r=PG&f=1", "display_name": "AJames", "link": "https://stackoverflow.com/users/9603305/ajames"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 42, "favorite_count": 0, "accepted_answer_id": 50263989, "answer_count": 1, "score": 0, "last_activity_date": 1526608752, "creation_date": 1524678262, "last_edit_date": 1531164843, "question_id": 50028386, "link": "https://stackoverflow.com/questions/50028386/adding-cell-border-based-on-value-of-2-cells-in-a-range", "title": "Adding Cell border based on value of 2 cells in a range", "body": "<p>I am looking to make a report pretty for manglement. There are dates in column A and initials in column C.  If the dates are the same for a group of rows, say 01/01/1901 and the initials are the same for the same group of rows, I would like to add a border to the last row in this grouping.  There are many groupings of variable length.  I have the below code so far and I have pasted what I am looking for as well.  Any help is appreciated.</p>\n\n<p>Thanks!!</p>\n\n<pre><code>    Function ExCap(Rng As Range)\n    Application.Volatile\n    ExCap = \"\"\n    For f = 1 To Len(Rng)\n    If Asc(Mid(Rng.Value, f, 1)) &gt;= 65 And Asc(Mid(Rng.Value, f, 1)) &lt;= 90 Then\n    ExCap = ExCap &amp; Mid(Rng.Value, f, 1)\n    End If\n    Next f\n    End Function\n    Function GetColumnLetter(colNum As Long) As String\n        Dim vARR\n        vARR = Split(Cells(1, colNum).Address(True, False), \"\")\n        GetColumnLetter = vARR(0)\n    End Function\n    Function funcCreateList(argCreateList)\n        For Each Worksheet In ThisWorkbook.Worksheets\n            If argCreateList = Worksheet.Name Then\n                Exit Function ' if found - exit function\n            End If\n        Next Worksheet\n        Worksheets.Add(After:=Worksheets(Worksheets.Count)).Name = argCreateList\n    End Function\n    Function InCom(s As String)\n        Dim i As Long\n        Dim result As String\n\n    If s = \"\" Then Exit Function\n\n        For i = 1 To Len(s) Step 2\n            On Error Resume Next\n            result = result &amp; Left(s, 2) &amp; \", \"\n            s = Mid(s, 3, Len(s) - 2)\n        Next i\n\n        InCom = Left(result, Len(result) - 2)\n    End Function\n    Function IsFileOpen(FileName As String)\n    Dim iFilenum As Long\n    Dim iErr As Long\n\n    On Error Resume Next\n    iFilenum = FreeFile()\n    Open FileName For Input Lock Read As #iFilenum\n    Close iFilenum\n    iErr = Err\n    On Error GoTo 0\n\n    Select Case iErr\n    Case 0: IsFileOpen = False\n    Case 70: IsFileOpen = True\n    Case Else: Error iErr\n    End Select\n    End Function\n\n\n\n    Sub Weekly_Report()\n    Dim wrpath As String, wmr As Workbook, wtd As Workbook, wed As [enter image description here][1]Workbook, ws1 As Worksheet\n    Dim LastRow As Long, myCol As String, LastCol As Long, Rng As Range, Piv As Worksheet\n\n\n    Application.ScreenUpdating = False\n\n\n    wrpath = \"c:\\mypathtoaraise\u201d\n\n    ChDir (wrpath)\n\n    If IsFileOpen(wrpath &amp; \"wmr.xls\") = 0 Then\n    Workbooks.Open (wrpath &amp; \"wmr.xls\")\n    Else\n    Workbooks(\"wmr.xls\").Activate\n    End If\n\n    Set wmr = Workbooks(\"wmrxls\")\n    Set ws1 = Sheets(\"Sheet1\")\n    LastRow = ws1.Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n\n\n    Do Until LastRow = 1\n        Set Rng = Range(\"C\" &amp; LastRow)\n        Range(\"J\" &amp; LastRow) = InCom(ExCap(Rng))\n        Rng.Value = Range(\"J\" &amp; LastRow).Value\n\n        Set Rng = Range(\"G\" &amp; LastRow)\n        Range(\"K\" &amp; LastRow) = InCom(ExCap(Rng))\n        Rng.Value = Range(\"K\" &amp; LastRow).Value\n\n        LastRow = LastRow - 1\n    Loop\n\n    Range(\"J:K\").ClearContents\n\n    LastRow = ws1.Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n    LastCol = ws1.Range(\"A1\").CurrentRegion.Columns.Count\n    myCol = GetColumnLetter(LastCol)\n\n    Rows(\"2:\" &amp; LastRow).Select\n    ActiveWorkbook.Worksheets(\"Sheet1\").Sort.SortFields.Clear\n    ActiveWorkbook.Worksheets(\"Sheet1\").Sort.SortFields.Add Key:=Range(\"B2:B\" &amp; LastRow) _\n            , SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:=xlSortNormal\n        With ActiveWorkbook.Worksheets(\"Sheet1\").Sort\n            .SetRange Range(\"A2:\" &amp; myCol &amp; LastRow)\n            .Header = xlGuess\n            .MatchCase = False\n            .Orientation = xlTopToBottom\n            .SortMethod = xlPinYin\n            .Apply\n        End With\n    Range(\"A2\").Select\n\n    Columns(\"B:B\").Select\n    Selection.Cut\n    Columns(\"A:A\").Select\n    Selection.Insert Shift:=xlToRight\n    Range(\"A2\").Select\n</code></pre>\n"}, {"tags": ["excel", "format", "vba"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 9469304, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/956bb5c5f1555459aa54d1a2ef44c4a6?s=128&d=identicon&r=PG&f=1", "display_name": "SamBee", "link": "https://stackoverflow.com/users/9469304/sambee"}, "edited": false, "score": 1, "creation_date": 1524679531, "post_id": 50028532, "comment_id": 87073514, "body": "Incredible, thank you for the speedy reply! It does the job perfectly, I shall just adapt it for my exact needs."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 3, "user_id": 9469304, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/956bb5c5f1555459aa54d1a2ef44c4a6?s=128&d=identicon&r=PG&f=1", "display_name": "SamBee", "link": "https://stackoverflow.com/users/9469304/sambee"}, "edited": false, "score": 0, "creation_date": 1524679786, "post_id": 50028532, "comment_id": 87073638, "body": "Glad it works. I will come back later and tidy it up a bit."}, {"owner": {"reputation": 3, "user_id": 9469304, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/956bb5c5f1555459aa54d1a2ef44c4a6?s=128&d=identicon&r=PG&f=1", "display_name": "SamBee", "link": "https://stackoverflow.com/users/9469304/sambee"}, "edited": false, "score": 0, "creation_date": 1524683421, "post_id": 50028532, "comment_id": 87075547, "body": "Something that has come up since implementing that. How would I go about then removing the &#39;1&#39;s and &#39;2&#39;s without resetting the formatting?  the Replace function sadly overwrites the bold"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 3, "user_id": 9469304, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/956bb5c5f1555459aa54d1a2ef44c4a6?s=128&d=identicon&r=PG&f=1", "display_name": "SamBee", "link": "https://stackoverflow.com/users/9469304/sambee"}, "edited": false, "score": 0, "creation_date": 1524688818, "post_id": 50028532, "comment_id": 87078010, "body": "If you remove the numbers, is there any way to distinguish the bits of text you are interested in from the rest? If not, you can search for each string, which is stored in vOut, and its location and then use Characters again. I don&#39;t have time now, but if you get stuck I can re-work the code later."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 3, "user_id": 9469304, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/956bb5c5f1555459aa54d1a2ef44c4a6?s=128&d=identicon&r=PG&f=1", "display_name": "SamBee", "link": "https://stackoverflow.com/users/9469304/sambee"}, "edited": false, "score": 0, "creation_date": 1524689333, "post_id": 50028532, "comment_id": 87078249, "body": "Another complication is if you have duplicates, e.g. there is more than 1 y in your string."}], "tags": [], "owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "is_accepted": true, "score": 0, "last_activity_date": 1524678871, "creation_date": 1524678871, "answer_id": 50028532, "question_id": 50028187, "link": "https://stackoverflow.com/questions/50028187/make-multiple-but-separate-characters-in-string-bold/50028532#50028532", "title": "Make multiple but separate characters in string bold", "body": "<p>This is a bit rushed (and a bit of a hack), but should start you off at least. It uses regular expressions. You could turn some of it into a sub with parameters.</p>\n\n<pre><code>Sub Regex2()\n\nDim oMatches As Object, i As Long, vOut\n\nWith CreateObject(\"VBScript.RegExp\")\n    .Global = True\n    .Pattern = \"\\s([a-z]+)1\"\n    Set oMatches = .Execute(Range(\"A1\"))\nEnd With\n\nReDim vOut(0 To oMatches.Count - 1, 1 To 3)\n\nFor i = 0 To oMatches.Count - 1\n    vOut(i, 1) = oMatches(i).submatches(0)\n    vOut(i, 2) = oMatches(i).firstindex\n    vOut(i, 3) = oMatches(i).Length\nNext i\n\nFor i = LBound(vOut) To UBound(vOut)\n    Range(\"A1\").Characters(vOut(i, 2) + 1, vOut(i, 3) - 1).Font.Bold = True\nNext i\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 9469304, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/956bb5c5f1555459aa54d1a2ef44c4a6?s=128&d=identicon&r=PG&f=1", "display_name": "SamBee", "link": "https://stackoverflow.com/users/9469304/sambee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 118, "favorite_count": 0, "accepted_answer_id": 50028532, "answer_count": 1, "score": 0, "last_activity_date": 1524678904, "creation_date": 1524677438, "last_edit_date": 1531161705, "question_id": 50028187, "link": "https://stackoverflow.com/questions/50028187/make-multiple-but-separate-characters-in-string-bold", "title": "Make multiple but separate characters in string bold", "body": "<p>I have a cell that has text, like this: </p>\n\n<p>k a2 d eu1 n   -   oe2 r gj y2 t lj e2 r i1   -   t y1 r kj   -   jh e2 z aa1 </p>\n\n<p>Eventually it should be like this: </p>\n\n<p>k a2 d <strong>eu</strong>1 n   -   oe2 r gj y2 t lj e2 r <strong>i</strong>1   -   t <strong>y</strong>1 r kj   -   jh e2 z <strong>aa</strong>1</p>\n\n<p>For the purposes of this the value of the cell is stored in variable v3. </p>\n\n<pre><code>Public Sub Guide()\n\n\nDim v3 As String\nDim i, j As Integer\nDim pos, pos1 As Long\n\nv3 = Sheets(\"Script\").Cells(12, 8).Value\n\ni = 1\nj = 0\n\nDo\n   j = InStr(i, v3, \"1\", vbTextCompare)\n   i = j + 1\n\n\n   pos = InStrRev(v3, \" \", (j - 1))\n   pos1 = (j - 1) - pos\n\n Call BoldText(v3, j - pos1, pos1)\n\nLoop Until j = 0\n\n\nEnd Sub\n</code></pre>\n\n<p>This is how I get the position of the letter before 1, <code>(j - 1)</code>, and how many characters between the previous space and 1, <code>pos1</code>...     </p>\n\n<p>This is \"BoldText\": </p>\n\n<pre><code>Sub BoldText(Txt, strt As Integer, Lngt)\nDim Ln As Long\n\nLn = Len(Txt)\n\n\n\nRange(\"H12\").Select\n\nWith ActiveCell.Characters(Start:=1, Length:=(strt - 1)).Font\n        .FontStyle = \"Regular\"\nEnd With\nWith ActiveCell.Characters(Start:=strt, Length:=Lngt).Font\n        .FontStyle = \"Bold\"\nEnd With\nWith ActiveCell.Characters(Start:=(strt + Lngt + 1), Length:=(Ln - strt)).Font\n        .FontStyle = \"Regular\"\nEnd With\n\n\nEnd Sub\n</code></pre>\n\n<p>So this way it keeps characters <code>1 to (one before the bold)</code>  regular font. The ones we want go bold, then <code>(one after bold) to End</code> regular again. </p>\n\n<p>How would it be possible to achieve this with multiple instances so that the end result is achieved? </p>\n\n<p>At the moment, on each loop it resets the last.  Excel expects it to be in the syntax of <code>1 to (x - 1)</code> = regular font, <code>x</code> = bold font, <code>x + 1 to (y-1)</code> = regular, <code>y</code> = bold, <code>y + 1 to (z - 1)</code> etc...  I'm just not sure how to script that.  </p>\n\n<p>Many thanks in advance. \nIf you need anything clearer then I can do my best to explain some more. </p>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 498, "user_id": 4175929, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6b7fda691816cbdf05d24dd2149beeee?s=128&d=identicon&r=PG", "display_name": "Jeffrey", "link": "https://stackoverflow.com/users/4175929/jeffrey"}, "edited": false, "score": 3, "creation_date": 1524676924, "post_id": 50027985, "comment_id": 87072144, "body": "You are using a continuation character &quot;_&quot; after a statement and then trying to start a new statement."}, {"owner": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "reply_to_user": {"reputation": 498, "user_id": 4175929, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6b7fda691816cbdf05d24dd2149beeee?s=128&d=identicon&r=PG", "display_name": "Jeffrey", "link": "https://stackoverflow.com/users/4175929/jeffrey"}, "edited": false, "score": 0, "creation_date": 1524682672, "post_id": 50027985, "comment_id": 87075121, "body": "@Jeffrey - expand on that a bit with old code vs new code - and add as an answer. OP should mark it as such."}, {"owner": {"reputation": 7422, "user_id": 1586390, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f07270207034d2bcbe347b028edc8f02?s=128&d=identicon&r=PG", "display_name": "Sorceri", "link": "https://stackoverflow.com/users/1586390/sorceri"}, "reply_to_user": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "edited": false, "score": 1, "creation_date": 1524690087, "post_id": 50027985, "comment_id": 87078605, "body": "@dbmitch OP has 10 questions and has only ever marked 1 as answered. Good to supply the answer with details but I do not believe the OP will mark it answered."}, {"owner": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "edited": false, "score": 0, "creation_date": 1524691695, "post_id": 50027985, "comment_id": 87079298, "body": "@jpl458 - is that true? Will you mark an answer as the correct one - or are you just asking questions here?"}], "answers": [{"tags": [], "owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "is_accepted": true, "score": 1, "last_activity_date": 1524722071, "creation_date": 1524722071, "answer_id": 50035727, "question_id": 50027985, "link": "https://stackoverflow.com/questions/50027985/access-vba-expected-end-of/50035727#50035727", "title": "ACCESS VBA Expected end of", "body": "<p>Either concatenate in a single statement - using the line-continuation character <code>_</code> ...</p>\n\n<pre><code>TblLenSQL = \"SELECT Count(dbo_Transaction_Table.Sequence_Number) AS CountOfSequence_Number,\" &amp; _\n            \" From dbo_Transaction_Table\"\n</code></pre>\n\n<p>... or don't - using multiple statements ...</p>\n\n<pre><code>TblLenSQL = \"SELECT Count(dbo_Transaction_Table.Sequence_Number) AS CountOfSequence_Number,\"\nTblLenSQL = TblLenSQL &amp; \" From dbo_Transaction_Table\"\n</code></pre>\n\n<p>... there is no both.</p>\n\n<p>Your SQL statement is incomplete (<code>SELECT x, FROM y</code>) but you are probably aware of that.</p>\n"}], "owner": {"reputation": 375, "user_id": 3216034, "user_type": "registered", "accept_rate": 26, "profile_image": "https://www.gravatar.com/avatar/eb061981ca8df90d46d66da96a0b0577?s=128&d=identicon&r=PG&f=1", "display_name": "jpl458", "link": "https://stackoverflow.com/users/3216034/jpl458"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 49, "favorite_count": 0, "accepted_answer_id": 50035727, "answer_count": 1, "score": 0, "last_activity_date": 1524722071, "creation_date": 1524676752, "last_edit_date": 1524691078, "question_id": 50027985, "link": "https://stackoverflow.com/questions/50027985/access-vba-expected-end-of", "title": "ACCESS VBA Expected end of", "body": "<p>Been away form coding and don't have my reference docs.  Have this bit of code. </p>\n\n<pre><code>Private Sub RunPivotButton_Click()\n  Dim TblLenSQL As String\n  TblLenSQL = \"SELECT Count(dbo_Transaction_Table.Sequence_Number) AS \n  CountOfSequence_Number,\" _\n  TblLenSQL = TblLenSQL &amp; \" From dbo_Transaction_Table\"\n\n  Dim CRDcon As ADODB.Connection\n  Set TranCnt = CurrentProject.Connection\n  Dim CountRS As New ADODB.Recordset\n  crdRs.ActiveConnection = TranCnt\n  crdRs.CursorType = adOpenStatic\n  crdRs.Open TblLenSQL\nEnd Sub\n</code></pre>\n\n<p>When I add the second line of code for building the query I get </p>\n\n<blockquote>\n  <p>\"Expected Ed of statement TblLenSQL = TblLenSQL &amp; \" From\n  dbo_Transaction_Table\"</p>\n</blockquote>\n\n<p>Something basic and trivial but I can't see it.</p>\n\n<p>Thanks\n jpl458 </p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "is_accepted": false, "score": 0, "last_activity_date": 1524676539, "creation_date": 1524676539, "answer_id": 50027924, "question_id": 50027672, "link": "https://stackoverflow.com/questions/50027672/macro-to-clean-data-from-blank-using-autofilter-with-headers-name/50027924#50027924", "title": "Macro to clean Data from Blank using Autofilter with headers name", "body": "<p>Can you try this? I couldn't declare a variable called \"Tab\". Since it was already defined as a range on WrKS you don't need the sheet reference on the AF line. Also, when using Find best to check the value is found to avoid errors. You should really use sheet references everywhere (or activate the sheet at the beginning).</p>\n\n<pre><code>Sub DeleteBlank()\n\nDim WrkS As Worksheet, LsC As Range, FsC As Range, Tab1 As Range\nDim LsH As Range, RNbr As Long, CNbr As Long, HdrRow As Range, FltCol As Variant\n\nSet WrkS = Worksheets(\"data\")\n\nSet LsC = Cells.Find(what:=\"*\", SearchOrder:=xlRows, SearchDirection:=xlPrevious, LookIn:=xlValues)\nSet FsC = Cells.Find(what:=\"*\", after:=LastCell, SearchOrder:=xlRows, SearchDirection:=xlNext, LookIn:=xlValues)\n\nIf Not FsC Is Nothing Then\n    If Not LsC Is Nothing Then\n        RNbr = FsC.Row\n        CNbr = LsC.Column\n        Set LsH = Cells(RNbr, CNbr)\n        Set HdrRow = Range(FsC, LsH)\n        Set Tab1 = WrkS.UsedRange\n        FltCol = HdrRow.Find(what:=\"name\", LookAt:=xlWhole).Column\n        Tab1.AutoFilter Field:=FltCol, Criteria1:=\"=\"\n    End If\nEnd If\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "is_accepted": false, "score": 0, "last_activity_date": 1524677255, "creation_date": 1524677255, "answer_id": 50028129, "question_id": 50027672, "link": "https://stackoverflow.com/questions/50027672/macro-to-clean-data-from-blank-using-autofilter-with-headers-name/50028129#50028129", "title": "Macro to clean Data from Blank using Autofilter with headers name", "body": "<p>maybe you can shorten it down to this</p>\n\n<pre><code>Option Explicit\n\nSub DeleteBlank()\n\n    With Worksheets(\"data\").UsedRange ' reference relevant worksheet \"usedrange\"\n        With Intersect(.Rows(1).Find(what:=\"name\", LookAt:=xlWhole).EntireColumn, .Cells) 'reference its column whose top cell content is \"name\"\n            .AutoFilter Field:=1, Criteria1:=\"=\" 'filter referenced column blank cells\n            If Application.WorksheetFunction.Subtotal(103, .Cells) &gt; 1 Then .Resize(.Rows.Count - 1).Offset(1).SpecialCells(xlCellTypeVisible).EntireRow.Delete ' if any filtered cells other than first row (header) then delete their entire row\n        End With\n        .Parent.AutoFilterMode = False\n    End With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 47, "user_id": 9613229, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3117e3559f2fa95dab7bff89b62c4ca?s=128&d=identicon&r=PG&f=1", "display_name": "DataScientist", "link": "https://stackoverflow.com/users/9613229/datascientist"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 39, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1524677255, "creation_date": 1524675647, "last_edit_date": 1531164843, "question_id": 50027672, "link": "https://stackoverflow.com/questions/50027672/macro-to-clean-data-from-blank-using-autofilter-with-headers-name", "title": "Macro to clean Data from Blank using Autofilter with headers name", "body": "<p>I'm trying to make a Macro to clean Dataset deleting  a blank cells  using an Autofilter method with a header instead of a column number . As you can see. There is no Cells number in this Macro and there will not. Everything has to be automatic. that is the Idea.</p>\n\n<p>I fegurate 90% of the code. I arrived at the water source but I can not drink.</p>\n\n<p>I got the error for the last line. </p>\n\n<blockquote>\n  <p>Error 1004: AutoFilter method of Range class failed.</p>\n</blockquote>\n\n<p>Here is the code:</p>\n\n<pre><code>Sub DeleteBlank()\n\nDim WrkS As Worksheet, LsC As Range, FsC As Range, Tab As Range\nDim LsH As Range, RNbr As Long, CNbr As Long, HdrRow As Range, FltCol As Variant\n\n\nSet WrkS = Worksheets(\"data\")\n\n' Last cells \n\nSet LsC = Cells(Cells.Find(what:=\"*\", SearchOrder:=xlRows, _\n  SearchDirection:=xlPrevious, LookIn:=xlValues).row, _\n  Cells.Find(what:=\"*\", SearchOrder:=xlByColumns, _\n  SearchDirection:=xlPrevious, LookIn:=xlValues).Column)\n\n' First cells \n\nSet FsC = Cells(Cells.Find(what:=\"*\", after:=LastCell, SearchOrder:=xlRows, _\n  SearchDirection:=xlNext, LookIn:=xlValues).row, _\n  Cells.Find(what:=\"*\", after:=LastCell, SearchOrder:=xlByColumns, _\n  SearchDirection:=xlNext, LookIn:=xlValues).Column)\n\nFsC.Activate\n\nRNbr = ActiveCell.row\n\nLsC.Activate\n\nCNbr = ActiveCell.Column\n\n'to set the last header \n\nSet LsH = Cells(RNbr, CNbr)\n\n' to set the header Row\n\nSet HdrRow = Range(FsC, LsH)\n\nSet Tab = WrkS.UsedRAnge  \n\n' to get the Column name in wich i have to delete all blank \n\nWith HdrRow\n\nFltCol = .Find(what:=\"name\", LookAt:=xlWhole).Column\n\nEnd With\n\n' the problem is below \n' Error 1004: AutoFilter method of Range class failed.\nWrkS.Tab.AutoFilter Field:=FltCol, Criteria1:=\"=\"\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "fonts", "font-size"], "comments": [{"owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "edited": false, "score": 0, "creation_date": 1524682634, "post_id": 50027667, "comment_id": 87075101, "body": "What is the name of your Sheet, and how is this sub (<code>Increase_Character_Size</code>) called?"}, {"owner": {"reputation": 752, "user_id": 9538700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bf60807a4c8210fb503d2f875a3299cd?s=128&d=identicon&r=PG", "display_name": "horst", "link": "https://stackoverflow.com/users/9538700/horst"}, "edited": false, "score": 0, "creation_date": 1524685926, "post_id": 50027667, "comment_id": 87076676, "body": "Your code works as intended. Put the sub in the Sheet Module and rename it to <code>Sub Worksheet_Change(ByVal Target As Range)</code>"}, {"owner": {"reputation": 1, "user_id": 9699162, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MJt6U.png?s=128&g=1", "display_name": "Kuseikos", "link": "https://stackoverflow.com/users/9699162/kuseikos"}, "edited": false, "score": 0, "creation_date": 1524686074, "post_id": 50027667, "comment_id": 87076731, "body": "the sheet is called &quot;Punti&quot; and the sub is included in the sheet&#39;s code. The macro is (supposedly) called whenever the value in any column between 7 and 16 or  between 17 and 26 is changed and set to the specific value &quot;11&quot;"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 9699162, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MJt6U.png?s=128&g=1", "display_name": "Kuseikos", "link": "https://stackoverflow.com/users/9699162/kuseikos"}, "edited": false, "score": 0, "creation_date": 1524773124, "post_id": 50028449, "comment_id": 87118463, "body": "Thank you! I appended the code and it worked! Thank you all for the help!"}], "tags": [], "owner": {"reputation": 83, "user_id": 8585970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/22f697fdac54ab148b296b5fb7e62ed5?s=128&d=identicon&r=PG&f=1", "display_name": "Oskar", "link": "https://stackoverflow.com/users/8585970/oskar"}, "is_accepted": false, "score": 0, "last_activity_date": 1524678480, "creation_date": 1524678480, "answer_id": 50028449, "question_id": 50027667, "link": "https://stackoverflow.com/questions/50027667/change-font-size-whenever-specific-value-is-entered-in-a-range/50028449#50028449", "title": "Change font size whenever specific value is entered in a range", "body": "<p><code>Cells(1,1).Font.Size = 12</code> works instantly in my Excel. Maybe you are changing a wrong cell or the conditions in the if are not correct?</p>\n\n<p>Are you using a special event to do what you want to do? Something like: <code>Private Sub Worksheet_Change(ByVal Target as Range)</code>?</p>\n"}, {"tags": [], "owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "is_accepted": false, "score": 0, "last_activity_date": 1524689871, "creation_date": 1524689871, "answer_id": 50031241, "question_id": 50027667, "link": "https://stackoverflow.com/questions/50027667/change-font-size-whenever-specific-value-is-entered-in-a-range/50031241#50031241", "title": "Change font size whenever specific value is entered in a range", "body": "<p>Place the code in the Sheet Module, <code>Worksheet_Change()</code> event:</p>\n\n<hr>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    With Target\n        If Val(.Value) = 11 And .CountLarge = 1 Then\n            If .Column &gt;= 7 And .Column &lt;= 26 Then .Font.Size = 12\n        End If\n    End With\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p>Or append the action to <code>Worksheet_Change()</code> if it already has other actions</p>\n"}], "owner": {"reputation": 1, "user_id": 9699162, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MJt6U.png?s=128&g=1", "display_name": "Kuseikos", "link": "https://stackoverflow.com/users/9699162/kuseikos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 144, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1524689871, "creation_date": 1524675630, "last_edit_date": 1524678311, "question_id": 50027667, "link": "https://stackoverflow.com/questions/50027667/change-font-size-whenever-specific-value-is-entered-in-a-range", "title": "Change font size whenever specific value is entered in a range", "body": "<p>My problem is rather simple: I have a range of cells on Excel where the user can enter any value from 3 to 11. I already have a macro that runs whenever a 3 or an 11 is entered on my sheet in the same range. However, I would like to have a second macro that triggers only whenever an 11 is entered, to automatically increase the font size from 11 to 12.</p>\n\n<p>Here is what I am trying to do:</p>\n\n<pre><code>Sub Increase_Character_Size(ByVal Target As Range)\n\nIf (Target.Column &gt;= 7 And Target.Column &lt;= 16) Or (Target.Column &gt;= 17 And Target.Column &lt;= 26) And Len(Target.Value) &gt; 0 Then\n    If Target.Value = 11 Then\n        Cells(Target.Row, Target.Column).Font.Size = 12\n    Else\n        Cells(Target.Row, Target.Column).Font.Size = 11\n    End If\nEnd If\n\nEnd Sub\n</code></pre>\n\n<p>However it doesn't seem to have any effect at all.\nAny suggestions? Thank you in advance!</p>\n\n<p>Note: I am pretty new at the Font.Size coding so forgive grotesque mistakes here!</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 9698587, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cb6bf386d5f8d7f975818fc9aa0e9214?s=128&d=identicon&r=PG&f=1", "display_name": "Attractivetoaster", "link": "https://stackoverflow.com/users/9698587/attractivetoaster"}, "edited": false, "score": 0, "creation_date": 1524689926, "post_id": 50028083, "comment_id": 87078526, "body": "That is actually super helpful :)"}, {"owner": {"reputation": 1, "user_id": 9698587, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cb6bf386d5f8d7f975818fc9aa0e9214?s=128&d=identicon&r=PG&f=1", "display_name": "Attractivetoaster", "link": "https://stackoverflow.com/users/9698587/attractivetoaster"}, "edited": false, "score": 0, "creation_date": 1524690150, "post_id": 50028083, "comment_id": 87078638, "body": "Also, as for my question...I&#39;m not too sure of how to put it other than that, I just need to figure out how to make a macro that will look for a specific set of addresses/numbers (I want those lists to be in the same workbook as the macro)  in other workbooks and delete them completely.  Do you know of anything specific I could check out to help me eventually make this?"}, {"owner": {"reputation": 83, "user_id": 8585970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/22f697fdac54ab148b296b5fb7e62ed5?s=128&d=identicon&r=PG&f=1", "display_name": "Oskar", "link": "https://stackoverflow.com/users/8585970/oskar"}, "reply_to_user": {"reputation": 1, "user_id": 9698587, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cb6bf386d5f8d7f975818fc9aa0e9214?s=128&d=identicon&r=PG&f=1", "display_name": "Attractivetoaster", "link": "https://stackoverflow.com/users/9698587/attractivetoaster"}, "edited": false, "score": 0, "creation_date": 1524724128, "post_id": 50028083, "comment_id": 87088335, "body": "The question is too broad and when you state it like that it looks as if you wanted someone to post a full working macro. Instead people are more likely to answer when the question is more specific. For example: &quot;How do I delete a row in Excel using vba?&quot;. Most of the questions like that are already answered on Stack Overflow or elsewhere. You literally just google &quot;vba row delete&quot; and click the first link. Also it&#39;s good to write about something you tried but didn&#39;t work. Chances are that it&#39;s easier to fix it that to write new code. So just try it and use google a lot. Good luck ;)"}], "tags": [], "owner": {"reputation": 83, "user_id": 8585970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/22f697fdac54ab148b296b5fb7e62ed5?s=128&d=identicon&r=PG&f=1", "display_name": "Oskar", "link": "https://stackoverflow.com/users/8585970/oskar"}, "is_accepted": false, "score": 0, "last_activity_date": 1524677077, "creation_date": 1524677077, "answer_id": 50028083, "question_id": 50026643, "link": "https://stackoverflow.com/questions/50026643/using-an-excel-macro-to-find-duplicates-across-multiple-workbooks/50028083#50028083", "title": "Using an Excel Macro to find duplicates across multiple workbooks", "body": "<p>Full answer would be probably very long. To give you some hints:</p>\n\n<p>To loop through all files in a given folder:</p>\n\n<pre><code>Application.ScreenUpdating = False\n\nDim MyFolder as String, MyFile as String, wbk as Workbook\nMyFile = Dir(MyFolder) 'DIR gets the first file of the folder\n\n'Loop through all files in a folder until DIR cannot find anymore\nDo While MyFile &lt;&gt; \u201c\u201d\n\n    Set wbk = Workbooks.Open(Filename:=MyFolder &amp; MyFile)\n\n    ' Some code\n    ' Some code\n    ' Some code\n\n    wbk.Close savechanges:=True\n    MyFile = Dir 'DIR gets the next file in the folder\n\nLoop\n\nApplication.ScreenUpdating = True\n</code></pre>\n\n<p>To check if some cell has a value that can be found in some range in another workbook, you can use: <code>WorksheetFunction.VLookup</code>.</p>\n\n<p>To delete a row: <code>ws.Rows(row_number).Delete</code> where ws is a worksheet.</p>\n\n<p>If you are just starting it might take you some time before you make it work. Maybe next time try to be more specific with your question.</p>\n"}], "owner": {"reputation": 1, "user_id": 9698587, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cb6bf386d5f8d7f975818fc9aa0e9214?s=128&d=identicon&r=PG&f=1", "display_name": "Attractivetoaster", "link": "https://stackoverflow.com/users/9698587/attractivetoaster"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 695, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1524677077, "creation_date": 1524671944, "last_edit_date": 1531161705, "question_id": 50026643, "link": "https://stackoverflow.com/questions/50026643/using-an-excel-macro-to-find-duplicates-across-multiple-workbooks", "title": "Using an Excel Macro to find duplicates across multiple workbooks", "body": "<p>So I'm pretty new to macros, literally just started learning them.\nBasically, I have a dilemma. I have a workbook with 4 sheets that each have about 800k rows or more, this is a list of address and numbers i want to remove from my other lists. Is there a way for me to create a macro (in that workbook) that will search for all those address/numbers across other workbooks that will be in the same folder? </p>\n\n<p>basically, I'd like the macro to either delete the rows that have that information, or i'd like it to highlight them so i can go and delete them.</p>\n\n<p>Is that possible..?</p>\n\n<p>Thanks! :)</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1524671951, "post_id": 50026488, "comment_id": 87069533, "body": "A <code>Function</code> in VBA returns a value - i.e. <code>GetAccountList = myreturnvalue</code> should be somewhere in this code. Just because it takes arguments doesn&#39;t mean it needs to be a <code>Function</code> - in your case, this should be a <code>Subroutine</code>."}, {"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "reply_to_user": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 1, "creation_date": 1524672119, "post_id": 50026488, "comment_id": 87069638, "body": "@dwirony it does not <i>need</i> to be a function, but it should not fail if it is declared as a function (it will simply return <code>Variant&#47;Empty</code> by default)."}, {"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 2, "creation_date": 1524672148, "post_id": 50026488, "comment_id": 87069657, "body": "When you are saying &quot;running as a Function&quot;, do you mean a <a href=\"https://stackoverflow.com/a/3622544/11683\">function that is called from a sheet cell</a>?"}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "reply_to_user": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1524672183, "post_id": 50026488, "comment_id": 87069682, "body": "@GSerg Yes you&#39;re right, I just wanted to clear up the difference in case he&#39;s new to VBA syntax. I don&#39;t know why the results are different here."}, {"owner": {"reputation": 43, "user_id": 9698509, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Jeff Barefoot", "link": "https://stackoverflow.com/users/9698509/jeff-barefoot"}, "reply_to_user": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1524672536, "post_id": 50026488, "comment_id": 87069852, "body": "@GSerg :  YES, I&#39;m trying to write a function that can be called from the worksheet.  So a user could enter =GetAccountList(10000,19999) and get a list of all of the accounts that start with a &quot;1&quot;.  This will be implemented as an Excel Add-In.  We have other functions that do this, like &quot;GetEndingBalance()&quot;, but they all return a single value, not a recordset.  My intent is for any user in our finance dept that has this Add-In to be able to quickly/easily extract a list of valid account numbers from our ERP."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 3, "creation_date": 1524672576, "post_id": 50026488, "comment_id": 87069876, "body": "You can&#39;t do that. A worksheet UDF <b>returns a value</b>, it doesn&#39;t populate other cells."}, {"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1524672726, "post_id": 50026488, "comment_id": 87069964, "body": "This is not how UDFs are supposed to work. You should return an array of data from your function and let Excel put it in cells. But you will be limited to the cells into which you have entered the function, you will not be able to spill data into more rows, and any additional data will be silently lost. Use either a sub or a querytable. And, from experience, the more fancy things like network access you do from worksheet functions, the more likely Excel is to crash."}, {"owner": {"reputation": 43, "user_id": 9698509, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Jeff Barefoot", "link": "https://stackoverflow.com/users/9698509/jeff-barefoot"}, "edited": false, "score": 0, "creation_date": 1524673029, "post_id": 50026488, "comment_id": 87070124, "body": "Thanks everyone...I appreciate that fast response.  That definitely explains the problem.  Can I implement a QueryTable from a UDF, and populate a range of cells?"}, {"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1524673581, "post_id": 50026488, "comment_id": 87070465, "body": "You cannot do anything from a UDF. You can set up a querytable in advance and then refresh it with different parameters from a sub, or you can set up a new querytable each time from a sub, or you can use <code>CopyFromRecordset</code> from a sub, but you cannot do any of that from a worksheet function."}, {"owner": {"reputation": 43, "user_id": 9698509, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Jeff Barefoot", "link": "https://stackoverflow.com/users/9698509/jeff-barefoot"}, "edited": false, "score": 0, "creation_date": 1524674058, "post_id": 50026488, "comment_id": 87070711, "body": "My goal is to allow my users - who know how to use Excel functions, but not Macros, etc - to get a list of account numbers on-demand from any Excel document that they are working in.  So, they&#39;d be able to open a new workbook, go to a cell and type [something] that allows them to see a list of account numbers.  Any thoughts as to a direction, or is this a no-go?"}, {"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1524674431, "post_id": 50026488, "comment_id": 87070898, "body": "Set up a ribbon tab for them with buttons to push. Attach the buttons to subs."}, {"owner": {"reputation": 43, "user_id": 9698509, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Jeff Barefoot", "link": "https://stackoverflow.com/users/9698509/jeff-barefoot"}, "reply_to_user": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1524676940, "post_id": 50026488, "comment_id": 87072163, "body": "@GSerg, that&#39;s a reasonable way to implement.  Thanks."}], "owner": {"reputation": 43, "user_id": 9698509, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Jeff Barefoot", "link": "https://stackoverflow.com/users/9698509/jeff-barefoot"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 41, "favorite_count": 0, "closed_date": 1524677637, "answer_count": 0, "score": 1, "last_activity_date": 1524671467, "creation_date": 1524671467, "last_edit_date": 1531164843, "question_id": 50026488, "link": "https://stackoverflow.com/questions/50026488/excel-custom-function-wont-copyfromrecordset", "closed_reason": "Duplicate", "title": "Excel Custom Function won&#39;t CopyFromRecordset", "body": "<p>I have a simple Excel VBA query that returns two fields.  If I run it as [Public Sub] it works fine.  If it run it as [Public Function] it fails.  Why would this be...what is the difference between the two?</p>\n\n<p>The code below opens the connection and queries the data.  Messageboxes:</p>\n\n<p>1 - Shows 75 records</p>\n\n<p>2 - Shows \"getting ready to write out records\"</p>\n\n<p>3a - Third Messagebox never fires if running as a Function.  </p>\n\n<p>3b - If running as a SUB, then the RecordSet contents are written into cells A5:B81 (from the previous line of code), and the messagebox shows 75 records</p>\n\n<p>Any thoughts?  I'm fairly new to VBA/Excel Automation, but have a lot of experience elsewhere.</p>\n\n<p>Thanks!</p>\n\n<pre><code>Public Function GetAccountList(cMainStart As String, cMainEnd As String)\n\n    ' Check to see if data connection is open...if not, connect\n    ' declares CON and RS.  Opens Connection\n    OpenGLJSJ\n\n    Dim cSQL As String\n    Set rs = New ADODB.Recordset\n    Set rs.ActiveConnection = con\n    rs.CursorLocation = adUseClient\n\n    cSQL = \"SELECT distinct Main, Sub From tblGLAccountsPeriodBalance where Main&gt;='\" &amp; cMainStart &amp; \"' and Main&lt;='\" &amp; cMainEnd &amp; \"'\"\n\n    rs.Open cSQL, con, adOpenForwardOnly, adLockReadOnly, adCmdTxt\n\n    MsgBox rs.RecordCount\n    MsgBox \"getting ready to write out records\"\n    Worksheets(\"test\").Range(\"a5\").CopyFromRecordset rs\n    MsgBox rs.RecordCount\n\nEnd Function\n</code></pre>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "edited": false, "score": 3, "creation_date": 1524689448, "post_id": 50026379, "comment_id": 87078296, "body": "Show your VBA code - you need to specify the Excel application object"}], "answers": [{"comments": [{"owner": {"reputation": 139, "user_id": 6276155, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca1f1d55c28d744ff23715c1c2903609?s=128&d=identicon&r=PG&f=1", "display_name": "LEBoyd", "link": "https://stackoverflow.com/users/6276155/leboyd"}, "edited": false, "score": 0, "creation_date": 1524831845, "post_id": 50037403, "comment_id": 87141037, "body": "Thanks!  Perfect."}], "tags": [], "owner": {"reputation": 148, "user_id": 3077926, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o1OUf.png?s=128&g=1", "display_name": "Calaris", "link": "https://stackoverflow.com/users/3077926/calaris"}, "is_accepted": true, "score": 0, "last_activity_date": 1524728402, "creation_date": 1524728402, "answer_id": 50037403, "question_id": 50026379, "link": "https://stackoverflow.com/questions/50026379/2010-access-vba-how-to-set-displaygridlines-in-excel-to-false/50037403#50037403", "title": "2010 Access vba How to set displaygridlines in Excel to false?", "body": "<p>If I understand your question correctly, you want to open a (new?) workbook in Excel from an Access VBA script and then hide the Excel gridlines. This can be done with the following code:</p>\n\n<pre><code>Private Function xlWithoutGrids()\nDim xlApp As New Excel.Application\n\nWith xlApp\n    .Visible = True\n    .Workbooks.Add\n    .ActiveWindow.DisplayGridlines = False\nEnd With\n\nEnd Function\n</code></pre>\n\n<p>Make sure you have a reference to the Microsoft Excel Object library from your Access database (Tools > References).</p>\n"}], "owner": {"reputation": 139, "user_id": 6276155, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca1f1d55c28d744ff23715c1c2903609?s=128&d=identicon&r=PG&f=1", "display_name": "LEBoyd", "link": "https://stackoverflow.com/users/6276155/leboyd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 936, "favorite_count": 0, "accepted_answer_id": 50037403, "answer_count": 1, "score": 0, "last_activity_date": 1524728402, "creation_date": 1524671095, "last_edit_date": 1524689476, "question_id": 50026379, "link": "https://stackoverflow.com/questions/50026379/2010-access-vba-how-to-set-displaygridlines-in-excel-to-false", "title": "2010 Access vba How to set displaygridlines in Excel to false?", "body": "<p>I'm trying to set displaygridlines = false in Access VBA.  I started with Excel to record the macro on turning this off, which give the displaygridlines=false.  But this does not work in Access VBA.  The only reference I could find on the site was <a href=\"https://stackoverflow.com/questions/40368373/how-can-i-turn-off-gridlines-in-excel-using-vba-without-using-activewindow\">How can I turn off gridlines in excel using VBA, without using ActiveWindow</a> but this is for Excel.</p>\n\n<p>The \"Method or data member not found\" is the error when compiling.</p>\n\n<p>Does anyone know how to turn off gridlines in Excel from Access VBA?</p>\n"}, {"tags": ["vba", "excel", "ms-word"], "answers": [{"comments": [{"owner": {"reputation": 93, "user_id": 828875, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/486604256ef4d3c2bf846fc841ac15bf?s=128&d=identicon&r=PG", "display_name": "DaR", "link": "https://stackoverflow.com/users/828875/dar"}, "edited": false, "score": 0, "creation_date": 1524669194, "post_id": 50025764, "comment_id": 87067657, "body": "Wow I can&#39;t believe I overlooked that... thank you so much. I feel like a fool :p"}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "reply_to_user": {"reputation": 93, "user_id": 828875, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/486604256ef4d3c2bf846fc841ac15bf?s=128&d=identicon&r=PG", "display_name": "DaR", "link": "https://stackoverflow.com/users/828875/dar"}, "edited": false, "score": 0, "creation_date": 1524669574, "post_id": 50025764, "comment_id": 87067935, "body": "@Dar It happens! :)"}], "tags": [], "owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "is_accepted": true, "score": 6, "last_activity_date": 1524669134, "creation_date": 1524669134, "answer_id": 50025764, "question_id": 50025665, "link": "https://stackoverflow.com/questions/50025665/vba-find-replace/50025764#50025764", "title": "VBA Find &amp; Replace", "body": "<p>Change </p>\n\n<p><code>.Execute FindText:=\"^^p\", ReplaceWith:=\"^p\", Replace:=2</code></p>\n\n<p>to </p>\n\n<p><code>.Execute FindText:=\"^p^p\", ReplaceWith:=\"^p\", Replace:=2</code></p>\n"}], "owner": {"reputation": 93, "user_id": 828875, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/486604256ef4d3c2bf846fc841ac15bf?s=128&d=identicon&r=PG", "display_name": "DaR", "link": "https://stackoverflow.com/users/828875/dar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 741, "favorite_count": 0, "accepted_answer_id": 50025764, "answer_count": 1, "score": 2, "last_activity_date": 1524673744, "creation_date": 1524668837, "last_edit_date": 1524673744, "question_id": 50025665, "link": "https://stackoverflow.com/questions/50025665/vba-find-replace", "title": "VBA Find &amp; Replace", "body": "<p>I'm using Excel VBA to generate word documents from a spreadsheet. I want to find and replace all double paragraphs with single paragraphs as part of the last step.</p>\n\n<p>Base code:</p>\n\n<pre><code>Dim objWord\nDim objDoc\nDim objSelection\n\nSet objWord = CreateObject(\"Word.Application\")\nSet objDoc = objWord.Documents.Add\nSet objSelection = objWord.Selection\n\nobjSelection.TypeText \"Test\"\nobjSelection.TypeText (vbCr)\nobjSelection.TypeText (vbCr)\nobjWord.Visible = True\n</code></pre>\n\n<p>Finding and replacing basic text works:</p>\n\n<pre><code>With objWord.ActiveDocument\n    Set myRange = .Content\n    With myRange.Find\n        .Execute FindText:=\"test\", ReplaceWith:=\"apple\", Replace:=2\n    End With\nEnd With\n</code></pre>\n\n<p>Finding and replacing paragraphs does NOT work:</p>\n\n<pre><code>With objWord.ActiveDocument\n    Set myRange = .Content\n    With myRange.Find\n        .Execute FindText:=\"^^p\", ReplaceWith:=\"^p\", Replace:=2\n    End With\nEnd With\n</code></pre>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 26680, "user_id": 1806780, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/NCB41.jpg?s=128&g=1", "display_name": "Sami Kuhmonen", "link": "https://stackoverflow.com/users/1806780/sami-kuhmonen"}, "edited": false, "score": 0, "creation_date": 1524668634, "post_id": 50025567, "comment_id": 87067233, "body": "Please edit your question, format the code properly and add an actual question. Take a look at the <a href=\"https://stackoverflow.com/help\">help center</a> for more information."}, {"owner": {"reputation": 11, "user_id": 9611258, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bc64dba84f0e6afdfd6d7048255a8c15?s=128&d=identicon&r=PG&f=1", "display_name": "wasif khan", "link": "https://stackoverflow.com/users/9611258/wasif-khan"}, "reply_to_user": {"reputation": 26680, "user_id": 1806780, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/NCB41.jpg?s=128&g=1", "display_name": "Sami Kuhmonen", "link": "https://stackoverflow.com/users/1806780/sami-kuhmonen"}, "edited": false, "score": 0, "creation_date": 1524668661, "post_id": 50025567, "comment_id": 87067256, "body": "i got type mismatch error whenever i add list item in datagrid"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1524669079, "post_id": 50025567, "comment_id": 87067568, "body": "Please <a href=\"http://rubberduckvba.com/indentation\" rel=\"nofollow noreferrer\">indent your code</a>. Code with non-indented nested blocks like this is dangerously hard to follow, and easy to tweak and break. EDIT: Fixed that for you ;-)"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1524669239, "post_id": 50025567, "comment_id": 87067685, "body": "You need to have <code>Option Explicit</code> specified at the top, and every variable declared with an explicit type. What is <code>Adodc1</code>? A connection? A recordset?"}, {"owner": {"reputation": 11, "user_id": 9611258, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bc64dba84f0e6afdfd6d7048255a8c15?s=128&d=identicon&r=PG&f=1", "display_name": "wasif khan", "link": "https://stackoverflow.com/users/9611258/wasif-khan"}, "edited": false, "score": 0, "creation_date": 1524669406, "post_id": 50025567, "comment_id": 87067801, "body": "when i select item from list to add in datagrid but it shows mismatch error"}, {"owner": {"reputation": 11, "user_id": 9611258, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bc64dba84f0e6afdfd6d7048255a8c15?s=128&d=identicon&r=PG&f=1", "display_name": "wasif khan", "link": "https://stackoverflow.com/users/9611258/wasif-khan"}, "edited": false, "score": 0, "creation_date": 1524669454, "post_id": 50025567, "comment_id": 87067839, "body": "yes i have option explicit on the top of my code"}, {"owner": {"reputation": 11, "user_id": 9611258, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bc64dba84f0e6afdfd6d7048255a8c15?s=128&d=identicon&r=PG&f=1", "display_name": "wasif khan", "link": "https://stackoverflow.com/users/9611258/wasif-khan"}, "edited": false, "score": 0, "creation_date": 1524669512, "post_id": 50025567, "comment_id": 87067884, "body": "adodc1 is a connection"}, {"owner": {"reputation": 11, "user_id": 9611258, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bc64dba84f0e6afdfd6d7048255a8c15?s=128&d=identicon&r=PG&f=1", "display_name": "wasif khan", "link": "https://stackoverflow.com/users/9611258/wasif-khan"}, "edited": false, "score": 0, "creation_date": 1524669741, "post_id": 50025567, "comment_id": 87068058, "body": "its local db well i edit it"}, {"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 1, "creation_date": 1524669782, "post_id": 50025567, "comment_id": 87068093, "body": "It would be much more helpful if you let us know on which line the error happens. Are you sure <code>adodc1</code> is in fact <code>ADODB.Connection</code>? Normally this name is assigned to the ADODC control."}, {"owner": {"reputation": 11, "user_id": 9611258, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bc64dba84f0e6afdfd6d7048255a8c15?s=128&d=identicon&r=PG&f=1", "display_name": "wasif khan", "link": "https://stackoverflow.com/users/9611258/wasif-khan"}, "edited": false, "score": 0, "creation_date": 1524669964, "post_id": 50025567, "comment_id": 87068227, "body": "Set rs = Grid.DataSource this line contain error and adodc1 is a component which i use to get data from db and show in the gridview"}, {"owner": {"reputation": 11, "user_id": 9611258, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bc64dba84f0e6afdfd6d7048255a8c15?s=128&d=identicon&r=PG&f=1", "display_name": "wasif khan", "link": "https://stackoverflow.com/users/9611258/wasif-khan"}, "edited": false, "score": 0, "creation_date": 1524670078, "post_id": 50025567, "comment_id": 87068304, "body": "basically adodc control you are right sorry for your inconvenience"}, {"owner": {"reputation": 11, "user_id": 9611258, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bc64dba84f0e6afdfd6d7048255a8c15?s=128&d=identicon&r=PG&f=1", "display_name": "wasif khan", "link": "https://stackoverflow.com/users/9611258/wasif-khan"}, "edited": false, "score": 0, "creation_date": 1524670403, "post_id": 50025567, "comment_id": 87068533, "body": "first time i select item from list to add in datagrid it will perfect working when i select another item to add in datagrid then it shows mismatch error"}], "owner": {"reputation": 11, "user_id": 9611258, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bc64dba84f0e6afdfd6d7048255a8c15?s=128&d=identicon&r=PG&f=1", "display_name": "wasif khan", "link": "https://stackoverflow.com/users/9611258/wasif-khan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 67, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1524680994, "creation_date": 1524668596, "last_edit_date": 1524680994, "question_id": 50025567, "link": "https://stackoverflow.com/questions/50025567/type-mismatch-error-while-using-vba", "title": "Type mismatch error while using VBA", "body": "<p>I'm using VBA and I have an error while running the attached code, it says Type mismatch.</p>\n\n<p>Can someone help me where to find the mistake?\nplease</p>\n\n<pre><code>Private Sub List1_DblClick()        \n    Dim val As String\n    Dim val2 As String\n    Dim i As Integer\n\n    Dim rs As ADODB.Recordset\n\n    Set GSBMconn = New ADODB.Connection\n\n    'Set rs = New ADODB.Recordset\n\n    For i = 0 To List1.ListCount - 1\n        If List1.Selected(i) Then\n            val = List1.List(i)\n\n            Debug.Print (val)\n            Set rs = Grid.DataSource\n\n            rs.AddNew        \n\n            Adodc1.ConnectionString = \"Provider=Microsoft.Jet.OLEDB.4.0;Data Source=cmd\\cmd.mdb;Persist Security Info=False;Jet OLEDB:Database Password=\"\n\n            With Adodc1\n                .RecordSource = \"SELECT *\" &amp; _\n                                \"FROM StockLevel3 \" &amp; _\n                                \"WHERE ItemName = '\" &amp; val &amp; \"'; \"\n            End With\n\n            Set Grid.DataSource = Adodc1\n\n            Adodc1.Refresh\n        End If\n    Next\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 1, "creation_date": 1524667945, "post_id": 50025285, "comment_id": 87066741, "body": "Your value is not being found and hence you are trying to activate a non-existent range. What is <code>Sheet</code>?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1524668529, "post_id": 50025285, "comment_id": 87067162, "body": "Remove the <code>.Activate</code> and test for <code>If Not rng Is Nothing Then</code>"}, {"owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1524668932, "post_id": 50025285, "comment_id": 87067465, "body": "Like @TimWilliams mentions, you cannot set a range and activate it at the same time. remove the <code>.Activate</code> ..if you want to select the cell, then next line could be <code>rng.select</code>---<a href=\"http://www.xlorate.com/vba-examples.html#Find%20Data%20in%20other%20Sheet\" rel=\"nofollow noreferrer\">&quot;Find Data in another sheet</a>"}, {"owner": {"reputation": 3, "user_id": 9698059, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Karl Goddard", "link": "https://stackoverflow.com/users/9698059/karl-goddard"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1524720153, "post_id": 50025285, "comment_id": 87086683, "body": "@SJR Sheet is another piece of code that takes you to the sheet in which the search is to be done, there are about 15 sheets to check so one of the inputs is used to locate the sheet and the other for this piece of code"}], "answers": [{"comments": [{"owner": {"reputation": 848, "user_id": 9221684, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gcnG9.jpg?s=128&g=1", "display_name": "warner_sc", "link": "https://stackoverflow.com/users/9221684/warner-sc"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 1, "creation_date": 1524671283, "post_id": 50025973, "comment_id": 87069118, "body": "@SJR Thank you, updated my answer to check if rng is nothing"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 1, "creation_date": 1524672070, "post_id": 50025973, "comment_id": 87069611, "body": "Apologies, it was me, inadvertently. I have now reversed it. It seems that if you downvote and then upvote it goes from -1 to +1!"}], "tags": [], "owner": {"reputation": 848, "user_id": 9221684, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gcnG9.jpg?s=128&g=1", "display_name": "warner_sc", "link": "https://stackoverflow.com/users/9221684/warner-sc"}, "is_accepted": true, "score": 1, "last_activity_date": 1524671246, "last_edit_date": 1524671246, "creation_date": 1524669746, "answer_id": 50025973, "question_id": 50025285, "link": "https://stackoverflow.com/questions/50025285/searching-for-a-value-from-a-specific-cell-on-another-sheet/50025973#50025973", "title": "Searching for a value from a specific cell on another sheet", "body": "<p>You can't declare and <code>.Activate</code> a variable <code>range</code> at the same time:</p>\n\n<pre><code>    Dim rng As Range\n\n    Set rng = Cells.Find(What:=vfind, After:=ActiveCell, LookIn:=xlValues, _\n         LookAt:=xlWhole, SearchOrder:=xlByRows, SearchDirection:=xlNext, _\n         MatchCase:=True, SearchFormat:=False).Activate\n</code></pre>\n\n<p>suggestion, avoid using <code>.Select</code> and <code>Activate</code>, explanation here <a href=\"https://www.excelcampus.com/vba/how-to-avoid-the-select-method/\" rel=\"nofollow noreferrer\">How to Avoid the Select Method in VBA &amp; Why</a></p>\n\n<p>Code:</p>\n\n<pre><code>Sub Find_7_day()\n\n        Dim vfind As String\n        Dim rng As Range\n\n        vfind = Sheets(\"Test Data\").Range(\"$E$3\").Value\n\n        Call Sheet\n\n        Set rng = Cells.Find(What:=vfind, LookIn:=xlValues, _\n        LookAt:=xlWhole, SearchOrder:=xlByRows, _\n        SearchDirection:=xlNext, _\n        MatchCase:=True, _\n        SearchFormat:=False)\n\n        If rng Is Nothing Then\n        MsgBox vfind &amp; \" \" &amp; \"dont exist\"\n        Exit Sub\n        End If\n\n       If rng.Value = vfind Then\n            Call Old_7_day\n            Call Form_7_day_fill\n        Else\n            Sheets(\"Test Data\").Select\n        End If\n\n        Exit Sub\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 9698059, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Karl Goddard", "link": "https://stackoverflow.com/users/9698059/karl-goddard"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 64, "favorite_count": 0, "accepted_answer_id": 50025973, "answer_count": 1, "score": 0, "last_activity_date": 1524671246, "creation_date": 1524667748, "last_edit_date": 1524670702, "question_id": 50025285, "link": "https://stackoverflow.com/questions/50025285/searching-for-a-value-from-a-specific-cell-on-another-sheet", "title": "Searching for a value from a specific cell on another sheet", "body": "<p>I am using userforms to input data, at a certain point part of the data is copied to one of the sheets in the workbook. </p>\n\n<p>My code then needs to use one of the values in the sheet to check if this value apears on another sheet, if it does it copies values linked to that value to the original sheet and then populates the userform so that further info can be captured. </p>\n\n<p>If I activate <code>on error resume next</code> everything works except the tab function stops working on the userform, if I run it without <code>on error resume next</code>, I get run-time error:</p>\n\n<blockquote>\n  <p>'91' Object variable or with block variable not set. </p>\n</blockquote>\n\n<p>How do i fix this?</p>\n\n<pre><code>Sub Find_7_day()\n\n        Dim vfind\n\n        Dim rng As Range\n\n        Sheets(\"Test Data\").Select\n        Sheets(\"Test Data\").Range(\"$E$3\").Select\n        vfind = ActiveCell\n\n        'On Error Resume Next\n        Call Sheet\n        Set rng = Cells.Find(What:=vfind, After:=ActiveCell,        LookIn:=xlValues, _\n             LookAt:=xlWhole, SearchOrder:=xlByRows,     SearchDirection:=xlNext, _\n             MatchCase:=True, SearchFormat:=False).Activate\n\n       If ActiveCell = vfind Then\n            Call Old_7_day\n            Call Form_7_day_fill\n        Else\n            Sheets(\"Test Data\").Select\n        End If\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 2110, "user_id": 3666741, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/3o38Y.jpg?s=128&g=1", "display_name": "cSteusloff", "link": "https://stackoverflow.com/users/3666741/csteusloff"}, "edited": false, "score": 0, "creation_date": 1524667925, "post_id": 50025208, "comment_id": 87066728, "body": "Possible duplicate <a href=\"https://stackoverflow.com/questions/31690814/how-do-i-get-a-list-of-unique-values-from-a-range-in-excel-vba\" title=\"how do i get a list of unique values from a range in excel vba\">stackoverflow.com/questions/31690814/&hellip;</a>"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1524668586, "post_id": 50025208, "comment_id": 87067197, "body": "Of a non-filtered list?  Or only unique <i>visible</i> values?"}, {"owner": {"reputation": 3, "user_id": 9490447, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4cb52f610855b3a79a09a40cdad0737e?s=128&d=identicon&r=PG&f=1", "display_name": "C.Romain", "link": "https://stackoverflow.com/users/9490447/c-romain"}, "edited": false, "score": 0, "creation_date": 1524668791, "post_id": 50025208, "comment_id": 87067360, "body": "I have a non filtered list and would like to get a list without duplicates from my listobject"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1524669602, "post_id": 50025208, "comment_id": 87067958, "body": "Please read <a href=\"https://meta.stackoverflow.com/q/284236/1188513\"><i>Why is \u201cCan someone help me?\u201d not an actual question?</i></a>"}, {"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1524670756, "post_id": 50025208, "comment_id": 87068773, "body": "Use a scripting dictionary."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 9490447, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4cb52f610855b3a79a09a40cdad0737e?s=128&d=identicon&r=PG&f=1", "display_name": "C.Romain", "link": "https://stackoverflow.com/users/9490447/c-romain"}, "edited": false, "score": 0, "creation_date": 1524734809, "post_id": 50027611, "comment_id": 87094859, "body": "Thanks a lot for your answer"}], "tags": [], "owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "is_accepted": true, "score": 0, "last_activity_date": 1524675399, "creation_date": 1524675399, "answer_id": 50027611, "question_id": 50025208, "link": "https://stackoverflow.com/questions/50025208/vba-get-list-without-duplicates-from-listobject/50027611#50027611", "title": "vba get list without duplicates from listobject", "body": "<p>you could use this <em>helper</em> function:</p>\n\n<pre><code>Function GetUniqueValues(rng As Range) As Variant\n    Dim cell As Range\n\n    With CreateObject(\"Scripting.Dictionary\")\n        For Each cell In rng\n            .Item(cell.Value) = 1\n        Next\n        GetUniqueValues = .keys\n    End With\nEnd Function\n</code></pre>\n\n<p>to be called by your \"main\" module as follows:</p>\n\n<pre><code>Option Explicit\n\nSub main()\n    Dim uniqueValues As Variant\n\n    uniqueValues = GetUniqueValues(ActiveSheet.ListObjects(1).ListColumns(1).DataBodyRange)\n\n    '... rest of your code\nEnd Sub\n</code></pre>\n\n<p>just change <code>ActiveSheet</code>, <code>ListObjects(1)</code> and <code>ListColumns(1)</code> references as per your needs</p>\n"}], "owner": {"reputation": 3, "user_id": 9490447, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4cb52f610855b3a79a09a40cdad0737e?s=128&d=identicon&r=PG&f=1", "display_name": "C.Romain", "link": "https://stackoverflow.com/users/9490447/c-romain"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 88, "favorite_count": 0, "accepted_answer_id": 50027611, "answer_count": 1, "score": -2, "last_activity_date": 1524675399, "creation_date": 1524667525, "last_edit_date": 1524669359, "question_id": 50025208, "link": "https://stackoverflow.com/questions/50025208/vba-get-list-without-duplicates-from-listobject", "title": "vba get list without duplicates from listobject", "body": "<p>Is there a vba command to get directly a list without duplicates from the header <a href=\"https://i.stack.imgur.com/HlVcM.png\" rel=\"nofollow noreferrer\">autofilter</a> of a list object.</p>\n\n<p>My input is <a href=\"https://i.stack.imgur.com/So01U.png\" rel=\"nofollow noreferrer\">this list</a> and I search a way to get this list without duplicates from my object ListObject in vba</p>\n\n<p>Thanks in advance.</p>\n"}, {"tags": ["excel", "vlookup", "userform", "vba"], "comments": [{"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 1, "creation_date": 1524666269, "post_id": 50024692, "comment_id": 87065506, "body": "Did you update your <code>Lookup</code> range to extend to columns 11 and 12?"}, {"owner": {"reputation": 307, "user_id": 1892705, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/23cfc5646d6a3104e4177e5da49f89ce?s=128&d=identicon&r=PG", "display_name": "Dustin Burns", "link": "https://stackoverflow.com/users/1892705/dustin-burns"}, "reply_to_user": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1524666618, "post_id": 50024692, "comment_id": 87065798, "body": "Thanks, that&#39;s what was going on, appreciate the help!"}], "answers": [{"comments": [{"owner": {"reputation": 307, "user_id": 1892705, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/23cfc5646d6a3104e4177e5da49f89ce?s=128&d=identicon&r=PG", "display_name": "Dustin Burns", "link": "https://stackoverflow.com/users/1892705/dustin-burns"}, "edited": false, "score": 1, "creation_date": 1524666598, "post_id": 50024858, "comment_id": 87065785, "body": "That was it thank you, knew it was something simple!"}], "tags": [], "owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "is_accepted": false, "score": 2, "last_activity_date": 1524666524, "creation_date": 1524666524, "answer_id": 50024858, "question_id": 50024692, "link": "https://stackoverflow.com/questions/50024692/multiple-vlookup-statements-when-assigning-value-to-userform-box/50024858#50024858", "title": "Multiple vlookup statements when assigning value to userform box", "body": "<p>I'm 90% sure your named range <code>Lookup</code> doesn't extend to columns 11 and 12. Attempting to use <code>Application.WorksheetFunction.Vlookup</code> and asking for a return column outside the range will return a </p>\n\n<blockquote>\n  <p>Run-time error '1004' - Unable to get the VLookup property of the WorksheetFunction class.</p>\n</blockquote>\n\n<p>This is one of the plights of using named ranges in code - it's not something you can clearly see while debugging, and the error you receive is rather ambiguous :).</p>\n"}], "owner": {"reputation": 307, "user_id": 1892705, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/23cfc5646d6a3104e4177e5da49f89ce?s=128&d=identicon&r=PG", "display_name": "Dustin Burns", "link": "https://stackoverflow.com/users/1892705/dustin-burns"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 94, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1524666524, "creation_date": 1524666064, "last_edit_date": 1531164843, "question_id": 50024692, "link": "https://stackoverflow.com/questions/50024692/multiple-vlookup-statements-when-assigning-value-to-userform-box", "title": "Multiple vlookup statements when assigning value to userform box", "body": "<p>Good Morning,</p>\n\n<p>I've created a userform where users can look up the name of a person, and it returns (among other things) their address.  The statement used for the address lookup went like this:</p>\n\n<pre><code>.Address = Application.WorksheetFunction.VLookup(Me.Name1, _\nWorksheets(\"Caselist\").Range(\"Lookup\"), 10, 0)\n</code></pre>\n\n<p>This worked fine.  Since then, I've split the Address cell into 3 separate cells (Street, City, Zip).  I'd like to combine the values in all 3 cells before I add them to the Userform, so users can see the complete address.  I've tried a statement like this:</p>\n\n<pre><code>.Address = Application.WorksheetFunction.VLookup(Me.Name1,Worksheets(\"Caselist\") _ \n.Range(\"Lookup\"), 10, 0) &amp; _ \nApplication.WorksheetFunction.VLookup(Me.Name1,Worksheets(\"Caselist\") _ \n.Range(\"Lookup\"), 11, 0) &amp; \" MI, \" &amp; _\nApplication.WorksheetFunction.VLookup(Me.Name1,Worksheets(\"Caselist\") _\n.Range(\"Lookup\"), 12, 0)\n</code></pre>\n\n<p>I know that's hard to look at, but it essentially is 3 Vlookup statements connected together using \"&amp;\" to create one string.  When I attempt this, I get the following error</p>\n\n<p>\"Unable to get the VLookup property of the WorksheetFunction class\"</p>\n\n<p>I haven't found any way to format this successfully online.  Any ideas how to do this?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 84, "user_id": 4110863, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/4452c1c4de7c8214f66a6c440ab9a6ed?s=128&d=identicon&r=PG&f=1", "display_name": "R2B Boondocks", "link": "https://stackoverflow.com/users/4110863/r2b-boondocks"}, "edited": false, "score": 0, "creation_date": 1524666404, "post_id": 50024647, "comment_id": 87065626, "body": "Check this out: <a href=\"https://stackoverflow.com/questions/19351832/copy-from-one-workbook-and-paste-into-another\" title=\"copy from one workbook and paste into another\">stackoverflow.com/questions/19351832/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 848, "user_id": 9221684, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gcnG9.jpg?s=128&g=1", "display_name": "warner_sc", "link": "https://stackoverflow.com/users/9221684/warner-sc"}, "is_accepted": true, "score": 0, "last_activity_date": 1524667391, "creation_date": 1524667391, "answer_id": 50025160, "question_id": 50024647, "link": "https://stackoverflow.com/questions/50024647/opening-xlsx-files-and-copying-pasting-data/50025160#50025160", "title": "Opening .XLSX files and copying/pasting data", "body": "<p>Avoid using <code>.Activate</code> and <code>.Select</code></p>\n\n<p><a href=\"https://www.excelcampus.com/vba/how-to-avoid-the-select-method/\" rel=\"nofollow noreferrer\">How to Avoid the Select Method in VBA &amp; Why</a></p>\n\n<pre><code>Private Sub CommandButton1_Click()\n\nDim Path As String\nDim File As String\nDim PasteFile As String\nDim Month As String\nDim FY As String\n\nMonth = \"feb\"\nFY = \"18\"\nPasteFile = ThisWorkbook.Name\n\nApplication.ScreenUpdating = False\nApplication.EnableEvents = False\nApplication.Calculation = xlCalculationManual\n\nPath = \"[file path]\"\nFile = Dir(Path)\nDo While File &lt;&gt; \"*.txt\" Or File &lt;&gt; \"\"\n\n    If File = \"[file name]\" &amp; Month &amp; FY &amp; \".xlsx\" Then\n\n    Workbooks.Open Path &amp; File\n\n    With Workbooks(File).Worksheets(\"Sheet1\")\n    .Range(.Cells(1, 1), .Cells(5, 5)).Copy\n    End With\n\n    With Workbooks(myFile).Worksheets(\"Sheet1\")\n    .Cells(10, 3).PasteSpecial xlPasteValues\n    End With\n\n    End If\n\nFile = Dir()\nLoop\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 17, "user_id": 9105910, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/480a7379b533e3166a0f76935cd80c6f?s=128&d=identicon&r=PG&f=1", "display_name": "tjm02c", "link": "https://stackoverflow.com/users/9105910/tjm02c"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 148, "favorite_count": 0, "accepted_answer_id": 50025160, "answer_count": 1, "score": 0, "last_activity_date": 1524667391, "creation_date": 1524665918, "last_edit_date": 1531164843, "question_id": 50024647, "link": "https://stackoverflow.com/questions/50024647/opening-xlsx-files-and-copying-pasting-data", "title": "Opening .XLSX files and copying/pasting data", "body": "<p>I am trying to create a macro that loops through all the non-txt files in a folder, open them, copy a selection from the opened file, and then paste it to a specific sheet in the file with the macro (depending on which file is being copied). I've got the first two parts working, but I'm not able to get the copy part to work. It keeps copying the file that should be the paste file. Any idea what I'm doing wrong?</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n\nDim Path As String\nDim File As String\nDim PasteFile As String\nDim Month As String\nDim FY As String\n\nMonth = \"feb\"\nFY = \"18\"\nPasteFile = ThisWorkbook.Name\n\nApplication.ScreenUpdating = False\nApplication.EnableEvents = False\nApplication.Calculation = xlCalculationManual\n\nPath = \"[file path]\"\nfile = Dir(Path)\nDo While file &lt;&gt; \"*.txt\" Or file &lt;&gt; \"\"\n\n    If file = \"[file name]\" &amp; Month &amp; FY &amp; \".xlsx\" Then\n    Workbooks.Open Path &amp; file\n    Workbooks(file).Worksheets(\"Sheet1\").Activate\n    Range(Cells(1, 1), Cells(5, 5)).Copy\n    Workbooks(myFile).Worksheets(\"Sheet1\").Activate\n    Cells(10, 3).PasteSpecial xlPasteValues\n\n    End If\nFile = Dir()\nLoop\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "foreach", "duplicates"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1524664460, "post_id": 50023870, "comment_id": 87064291, "body": "Are Range 1 and Range 2 values expected to be in the same order? To simplify, why not just loop through Range 1, trying to find each value in Range 2 and deleting if not found?"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1524664638, "post_id": 50023870, "comment_id": 87064416, "body": "Or copy all of range two over range 1 and use remove duplicates?"}, {"owner": {"reputation": 83, "user_id": 7599706, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/1791a6db0fed6a57416ecd64e2193f24?s=128&d=identicon&r=PG&f=1", "display_name": "pwm2017", "link": "https://stackoverflow.com/users/7599706/pwm2017"}, "edited": false, "score": 0, "creation_date": 1524665945, "post_id": 50023870, "comment_id": 87065290, "body": "bigben - no they will not be in the same order, and Range 2 will have duplicates."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1524667653, "post_id": 50023870, "comment_id": 87066522, "body": "Since they are not in the same order then, your <code>CellinCarArea.Value &lt;&gt; CellinProjectList.Value</code> approach - i.e. sequentially comparing cell by cell - will cause unnecessary deletion."}], "answers": [{"tags": [], "owner": {"reputation": 9506, "user_id": 2312614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ra7Jm.jpg?s=128&g=1", "display_name": "Subodh Tiwari sktneer", "link": "https://stackoverflow.com/users/2312614/subodh-tiwari-sktneer"}, "is_accepted": false, "score": 1, "last_activity_date": 1524670059, "creation_date": 1524670059, "answer_id": 50026078, "question_id": 50023870, "link": "https://stackoverflow.com/questions/50023870/excel-compare-two-ranges-and-delete-duplicate-cell-values/50026078#50026078", "title": "Excel: Compare two ranges and delete duplicate cell values", "body": "<p>You may have this Function on a Standard Module...</p>\n\n<pre><code>Function DeleteFromRange1(ByVal Rng1 As Range, ByVal Rng2 As Range) As Variant\nDim x, y, z(), dict\nDim i As Long, j As Long\n\nSet dict = CreateObject(\"Scripting.Dictionary\")\nx = Rng1.Value\ny = Rng2.Value\n\nFor i = 1 To UBound(y, 1)\n    dict.Item(y(i, 1)) = \"\"\nNext i\n\nFor i = 1 To UBound(x, 1)\n    If dict.exists(x(i, 1)) Then\n        j = j + 1\n        ReDim Preserve z(1 To j)\n        z(j) = x(i, 1)\n    End If\nNext i\nDeleteFromRange1 = z\nEnd Function\n</code></pre>\n\n<p>Then you may call this function from your macro like below.</p>\n\n<p>Don't forget to set the Rng1 and Rng2 as per your requirement before calling the function.</p>\n\n<pre><code>Sub CleanProjectLists()\nDim Rng1 As Range, Rng2 As Range\nDim arr\n\nApplication.ScreenUpdating = False\n\n'Set your Range1 here\n'Set Rng1 = .....\n\n'Set your Range2 here\n'Set Rng2 = .....\n\n'Then call this function\narr = DeleteFromRange1(Rng1, Rng2)\nRng1.Clear\nRng1.Cells(1).Resize(UBound(arr), 1).Value = Application.Transpose(arr)\nApplication.ScreenUpdating = True\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "is_accepted": false, "score": 1, "last_activity_date": 1524673664, "creation_date": 1524673664, "answer_id": 50027133, "question_id": 50023870, "link": "https://stackoverflow.com/questions/50023870/excel-compare-two-ranges-and-delete-duplicate-cell-values/50027133#50027133", "title": "Excel: Compare two ranges and delete duplicate cell values", "body": "<p>you could use <code>AutoFilter()</code>:</p>\n\n<pre><code>Public Sub CleanProjectLists()    \n    Dim filters As Variant\n    With Sheets(\"Engine Ancillaries\")\n        filters = Application.Transpose(.Range(\"B9\", .Cells(.Rows.Count, \"B\").End(xlUp)).Value) ' collect \"Engine Ancillaries\" column B values from row 9 down to last not empty row\n    End With\n\n    Dim ProjectColumn As Long\n    ProjectColumn = 8\n    Dim filteredRng As Range\n    With Sheets(\"VBA_Data\") 'reference \"VBA_Data\" sheet\n        With .Range(.Cells(1, ProjectColumn), .Cells(.Rows.Count, ProjectColumn).End(xlUp)) ' reference referenced sheet 'ProjectColumn' column cells from row 2 down to last not empty one\n            .AutoFilter Field:=1, Criteria1:=filters, Operator:=xlFilterValues ' filter referenced range with values from \"Engine Ancillaries\" sheet column B\n            If Application.WorksheetFunction.Subtotal(103, .Cells) &gt; 1 Then Set filteredRng = .Resize(.Rows.Count - 1).Offset(1).SpecialCells(xlCellTypeVisible) ' if any filtered cells collect them in 'filteredRng' range\n            .Parent.AutoFilterMode = False ' remove filters\n            If filteredRng.Address = .Resize(.Rows.Count - 1).Offset(1).Address Then Exit Sub ' if all cells values were in 'filters' then no cells are to be cleared\n            filteredRng.EntireRow.Hidden = True 'hide cells whose values were in \"Engine Ancillaries\" sheet column B\n            .Offset(1, -1).Resize(.Rows.Count - 1, 4).SpecialCells(xlCellTypeVisible).EntireRow.ClearContents ' clear visible cells (i.e. those cells whose value was not in \"Engine Ancillaries\" sheet column B)\n            filteredRng.EntireRow.Hidden = False ' un-hide rows\n        End With\n    End With\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 83, "user_id": 7599706, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/1791a6db0fed6a57416ecd64e2193f24?s=128&d=identicon&r=PG&f=1", "display_name": "pwm2017", "link": "https://stackoverflow.com/users/7599706/pwm2017"}, "is_accepted": true, "score": 1, "last_activity_date": 1524728054, "creation_date": 1524728054, "answer_id": 50037314, "question_id": 50023870, "link": "https://stackoverflow.com/questions/50023870/excel-compare-two-ranges-and-delete-duplicate-cell-values/50037314#50037314", "title": "Excel: Compare two ranges and delete duplicate cell values", "body": "<p>This seems to work</p>\n\n<pre><code>Set CarArea = Sheets(\"Engine Ancillaries\")\nProjectColumn = 8\nLastrowJobslist = CarArea.Cells(Rows.Count, 2).End(xlUp).Row\nLastrowProjectList = Sheets(\"VBA_Data\").Cells(Rows.Count, \nProjectColumn).End(xlUp).Row\nSet Jobslist = CarArea.Range(CarArea.Cells(9, 2), \nCarArea.Cells(LastrowJobslist, 2))\nSet ProjectList = Sheets(\"VBA_Data\").Range(Sheets(\"VBA_Data\").Cells(2, \nProjectColumn), Sheets(\"VBA_Data\").Cells(LastrowProjectList, ProjectColumn))\nFor Each CellinProjectList In ProjectList\n    ProjectListValue = CellinProjectList.Value\n    NoDuplicates = Application.WorksheetFunction.CountIf(Jobslist, ProjectListValue)\n    If NoDuplicates = 0 Then\n        CellinProjectList.ClearContents\n        CellinProjectList.Offset(0, -1).ClearContents\n        CellinProjectList.Offset(0, 1).ClearContents\n        CellinProjectList.Offset(0, 2).ClearContents\n    End If\nNext CellinProjectList\nRange(Sheets(\"VBA_Data\").Cells(2, ProjectColumn - 1), \nSheets(\"VBA_Data\").Cells(LastrowProjectList, ProjectColumn + 2)).Sort \nkey1:=Sheets(\"VBA_Data\").Range(Sheets(\"VBA_Data\").Cells(2, ProjectColumn), \nSheets(\"VBA_Data\").Cells(LastrowProjectList, ProjectColumn)), _\norder1:=xlAscending, Header:=xlNo\n</code></pre>\n"}], "owner": {"reputation": 83, "user_id": 7599706, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/1791a6db0fed6a57416ecd64e2193f24?s=128&d=identicon&r=PG&f=1", "display_name": "pwm2017", "link": "https://stackoverflow.com/users/7599706/pwm2017"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 945, "favorite_count": 0, "accepted_answer_id": 50037314, "answer_count": 3, "score": 1, "last_activity_date": 1524728054, "creation_date": 1524663640, "last_edit_date": 1524666934, "question_id": 50023870, "link": "https://stackoverflow.com/questions/50023870/excel-compare-two-ranges-and-delete-duplicate-cell-values", "title": "Excel: Compare two ranges and delete duplicate cell values", "body": "<p>I have two ranges of data:</p>\n\n<ul>\n<li>Range1 is a list of available project names</li>\n<li>Range2 is a list of project names that are in use</li>\n</ul>\n\n<p>I'm trying to write VBA code that will compare these two ranges, and if any value exists in Range1, but not in Range2, then I want to delete that value from Range1.</p>\n\n<p>I have the following code so far, but it currently deletes everything in Range1, whether or not the project names are in Range2.</p>\n\n<pre><code>Public Sub CleanProjectLists()\n\nDim CellinProjectList As Range\nDim CellinCarArea As Range\n\nDim ProjectColumn As Long\n\nDim LastrowCarArea As Integer\nDim LastrowProjectList As Integer\n\nSet CheckSheet = Sheets(\"Engine Ancillaries\")\nProjectColumn = 8\n\nLastrowProjectList = Sheets(\"VBA_Data\").Cells(Rows.Count, \nProjectColumn).End(xlUp).Row\nLastrowCarArea = CheckSheet.Cells(Rows.Count, 2).End(xlUp).Row\n\n    For Each CellinCarArea In CheckSheet.Range(\"B9:B\" &amp; LastrowCarArea)\n        For Each CellinProjectList In Sheets(\"VBA_Data\").Range(Sheets(\"VBA_Data\").Cells(2, ProjectColumn), Sheets(\"VBA_Data\").Cells(LastrowProjectList, ProjectColumn))\n                    If CellinCarArea.Value &lt;&gt; CellinProjectList.Value Then\n                        Sheets(\"VBA_Data\").Select\n                        CellinProjectList.Offset(0, -1).Select\n                        ActiveCell.Resize(, 4).ClearContents\n                        Exit For\n                        End If\n        Next CellinProjectList\n    Next CellinCarArea\n</code></pre>\n\n<p>End Sub</p>\n\n<p>How can this be achieved?</p>\n"}, {"tags": ["excel", "reference", "vba"], "comments": [{"owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "edited": false, "score": 0, "creation_date": 1524663645, "post_id": 50023826, "comment_id": 87063755, "body": "What are you asking?"}, {"owner": {"reputation": 25, "user_id": 8685655, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/abe9de9c393bfc2c2c46f7966174e701?s=128&d=identicon&r=PG", "display_name": "Pawe\u0142", "link": "https://stackoverflow.com/users/8685655/pawe%c5%82"}, "reply_to_user": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "edited": false, "score": 0, "creation_date": 1524663747, "post_id": 50023826, "comment_id": 87063824, "body": "Why the &quot;MsgBox&quot; line doesn&#39;t work?"}], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 8685655, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/abe9de9c393bfc2c2c46f7966174e701?s=128&d=identicon&r=PG", "display_name": "Pawe\u0142", "link": "https://stackoverflow.com/users/8685655/pawe%c5%82"}, "edited": false, "score": 0, "creation_date": 1524664006, "post_id": 50023936, "comment_id": 87063979, "body": "Yes, it&#39;s a valid name. Typing the index of name of the workbook instead of RefersTo argument helped. Thank you."}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": true, "score": 1, "last_activity_date": 1524666491, "last_edit_date": 1524666491, "creation_date": 1524663814, "answer_id": 50023936, "question_id": 50023826, "link": "https://stackoverflow.com/questions/50023826/referring-to-workbook-names/50023936#50023936", "title": "Referring to Workbook Names", "body": "<p>Just make sure <strong><em>Nazwa2</em></strong> is a valid Name:</p>\n\n<pre><code>Sub add()\n\nSheets(1).Range(\"A1\").Name = \"Nazwa2\"\nThisWorkbook.Names.add Name:=\"Letee\", RefersTo:=\"Nazwa2\"\nMsgBox ThisWorkbook.Names(1)\n\nEnd Sub\n</code></pre>\n\n<p>To see the chain of names:</p>\n\n<pre><code>Sub addx()\n\n    Sheets(1).Range(\"A1\").Name = \"Nazwa2\"\n    ThisWorkbook.Names.add Name:=\"Letee\", RefersTo:=\"Nazwa2\"\n\n    i = 1\n    For Each nm In ActiveWorkbook.Names\n         Cells(i, 1).Value = nm.Name\n         Cells(i, 2).Value = \"'\" &amp; nm.RefersTo\n     i = i + 1\n    Next\n\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/MrfZ8.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/MrfZ8.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 25, "user_id": 8685655, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/abe9de9c393bfc2c2c46f7966174e701?s=128&d=identicon&r=PG", "display_name": "Pawe\u0142", "link": "https://stackoverflow.com/users/8685655/pawe%c5%82"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 161, "favorite_count": 0, "accepted_answer_id": 50023936, "answer_count": 1, "score": 0, "last_activity_date": 1524666491, "creation_date": 1524663487, "last_edit_date": 1531164843, "question_id": 50023826, "link": "https://stackoverflow.com/questions/50023826/referring-to-workbook-names", "title": "Referring to Workbook Names", "body": "<p>I have a trouble connected with getting name of <code>Workbook</code> object by given reference (<code>RefersTo</code>). Code below:</p>\n\n<pre><code>Sub add()\n\n  ThisWorkbook.Names.add Name:=\"Letee\", RefersTo:=\"Nazwa2\"\n  MsgBox ThisWorkbook.Names(RefersTo:=\"Nazwa2\")\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "sap-gui"], "answers": [{"tags": [], "owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "is_accepted": false, "score": 0, "last_activity_date": 1524671352, "creation_date": 1524671352, "answer_id": 50026447, "question_id": 50023803, "link": "https://stackoverflow.com/questions/50023803/loop-copy-in-sap-stops-when-edge-of-screen-is-met-vba/50026447#50026447", "title": "Loop Copy In SAP Stops When Edge Of Screen Is Met VBA", "body": "<p>Add a </p>\n\n<pre><code>session.findById(\"wnd[0]/usr/lbl[12,\" &amp; CStr(i) &amp; \"]\").setFocus\n</code></pre>\n\n<p>This might not be neccessary for each line, so you could set the focus every 10th step.</p>\n"}], "owner": {"reputation": 343, "user_id": 9626171, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9587856742de2015aec848c7749c4b15?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan", "link": "https://stackoverflow.com/users/9626171/jordan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 122, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1610052506, "creation_date": 1524663437, "last_edit_date": 1610052506, "question_id": 50023803, "link": "https://stackoverflow.com/questions/50023803/loop-copy-in-sap-stops-when-edge-of-screen-is-met-vba", "title": "Loop Copy In SAP Stops When Edge Of Screen Is Met VBA", "body": "<p>I got some help yesterday about using a loop to copy data down an SAP column to transfer the data over to excel. I was able to get it copying and moving down the column, however it now stops copying (error 619 can not find ID) when it reaches the bottom of my screen. I assume it is because it cannot \"see\" the values anymore but I was wondering if anyone knew a work around. Here is the relevant code I have so far. Note: i starts at 16 because of how the script is recording the position of the fields. It starts at 16 and moves up by 1 from there.</p>\n\n<pre><code>'Copy Number of Batches in Column\nNumber_of_Batches = session.findById(\"wnd[0]/usr/lbl[74,13]\").Text\nsession.findById(\"wnd[0]/usr/lbl[74,13]\").caretPosition = 5\n\n'Variable for copying down the SAP Column\nFor i = 16 To Number_of_Batches + 15\n\n'Loops through each bactch for the material code\n'Do\n\n'**** Must convert to a string here****\n'Copy down SAP column\nsession.findById(\"wnd[0]\").maximize\nCurrent_Batch = session.findById(\"wnd[0]/usr/lbl[12,\" &amp; CStr(i) &amp; \"]\").Text\nsession.findById(\"wnd[0]/usr/lbl[12,\" &amp; CStr(i) &amp; \"]\").caretPosition = 6\nsession.findById(\"wnd[0]\").sendVKey 0\n\n'Pastes to all SAP Batches Column\nCells(Z, 10) = Current_Batch\n\nZ = Z + 1\n\nNext i\n</code></pre>\n"}, {"tags": ["vba", "unit-testing", "rubberduck"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1524664192, "post_id": 50023782, "comment_id": 87064109, "body": "You probably mean to use <code>Assert.SequenceEquals</code> to compare the contents of both arrays, right?"}, {"owner": {"reputation": 1532, "user_id": 5996109, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/ea8a30cf336f9bdd23ecafdae26e2b2a?s=128&d=identicon&r=PG&f=1", "display_name": "Alfa Bravo", "link": "https://stackoverflow.com/users/5996109/alfa-bravo"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1524664606, "post_id": 50023782, "comment_id": 87064391, "body": "@MathieuGuindon I have changed is to your suggestion, but now I get the following error <code>unable to cast object of type &#39;system.int64&#39; to type &#39;system.array&#39;</code>"}, {"owner": {"reputation": 1404, "user_id": 643342, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/BAdMW.png?s=128&g=1", "display_name": "this", "link": "https://stackoverflow.com/users/643342/this"}, "edited": false, "score": 0, "creation_date": 1524664712, "post_id": 50023782, "comment_id": 87064465, "body": "Please don&#39;t be loose with the data type. If you look at the <code>VarPtr</code>&#39;s autocompletion or in the object browser (with hidden member shown), you will see that it returns a <code>LongPtr</code> and you should use that. <code>LongLong</code> works because you are on 64-bit Office but the same code would fail on 32-bit Office because it should be <code>Long</code> there. Only <code>LongPtr</code> can change size to accommodate, and thus is the correct data type to use w/ <code>VarPtr</code> (or anything else that exposes a raw pointer rather than just an ordinary integer)"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1524664826, "post_id": 50023782, "comment_id": 87064539, "body": "Gah, re-reading the article (I wrote it ...lol), I see what you&#39;re trying to do - in order to get a definitive answer we&#39;ll need to see at least the signature for <code>wsService.WriteAllData</code> (i.e. how the <code>Variant</code> parameter is being passed) - <code>VarPtr</code> <i>should</i> return the same value if the variant arrays are passed <code>ByRef</code>, but not if they&#39;re passed <code>ByVal</code>. Signature should be something like <code>Private Sub IWorksheetService_WriteAllData(ByRef data As Variant)</code>."}, {"owner": {"reputation": 1532, "user_id": 5996109, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/ea8a30cf336f9bdd23ecafdae26e2b2a?s=128&d=identicon&r=PG&f=1", "display_name": "Alfa Bravo", "link": "https://stackoverflow.com/users/5996109/alfa-bravo"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1524665391, "post_id": 50023782, "comment_id": 87064925, "body": "@MathieuGuindon Hi, on your example you already had it as <code>Private Sub IWorksheetService_WriteAllData(ByRef data As Variant)</code>, and that is the way I had it from the beginning, but it shows two different pointers, and I have your code verbatim, that is also why I have the <code>AreEqual</code> and not <code>SequenceEquals</code>"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1524665891, "post_id": 50023782, "comment_id": 87065247, "body": "Hmm, that whole <code>VarPtr</code> stuff might have been a stretch / me trying to figure out something to test for in a short example that involves dependencies and stubs. I&#39;ll update the article to a simpler test that asserts the two arrays contain the same values, with <code>SequenceEquals</code>. I can assure you that the code did work on my 32-bit Excel when I wrote it.. I shouldn&#39;t have involved pointers there, it needlessly complicates things. That said, <i>how to test whether a method is working with a specific array</i> is a very valid question nonetheless."}, {"owner": {"reputation": 1532, "user_id": 5996109, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/ea8a30cf336f9bdd23ecafdae26e2b2a?s=128&d=identicon&r=PG&f=1", "display_name": "Alfa Bravo", "link": "https://stackoverflow.com/users/5996109/alfa-bravo"}, "edited": false, "score": 0, "creation_date": 1524666543, "post_id": 50023782, "comment_id": 87065743, "body": "I will refresh your article every day to check for the updated version :p"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1524667000, "post_id": 50023782, "comment_id": 87066069, "body": "Okay, I just repro&#39;d the failing <code>WorksheetServiceWorksOffDataFromDataService</code> test on 32-bit Office 2010. Gosh, wtf..."}], "answers": [{"comments": [{"owner": {"reputation": 1532, "user_id": 5996109, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/ea8a30cf336f9bdd23ecafdae26e2b2a?s=128&d=identicon&r=PG&f=1", "display_name": "Alfa Bravo", "link": "https://stackoverflow.com/users/5996109/alfa-bravo"}, "edited": false, "score": 0, "creation_date": 1524669289, "post_id": 50025613, "comment_id": 87067718, "body": "And now everything is green ... :)"}], "tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": true, "score": 4, "last_activity_date": 1524668700, "creation_date": 1524668700, "answer_id": 50025613, "question_id": 50023782, "link": "https://stackoverflow.com/questions/50023782/how-to-unit-test-vba-code-two-different-pointers/50025613#50025613", "title": "How to unit test VBA code? - Two different pointers", "body": "<p><code>VarPtr</code> is what's artificially complicating that test, introducing frail and flawed pointer logic that doesn't need to be there.</p>\n\n<hr>\n\n<p>Change your stub data service to return some non-empty data - literally anything will do:</p>\n\n<pre><code>Option Explicit\nImplements IDataService\n'@Folder \"Services.Stubs\"\n\nPrivate Function IDataService_GetSomeTable() As Variant\n    IDataService_GetSomeTable = GetSomeTable\nEnd Function\n\nPublic Function GetSomeTable() As Variant\n    Dim result(1 To 50, 1 To 10) As Variant\n    result(1, 1) = \"test\"\n    GetSomeTable = result\nEnd Function\n</code></pre>\n\n<p>Now change the stub worksheet service to keep a copy of the actual data (rather than just a <code>LongPtr</code>):</p>\n\n<pre><code>Option Explicit\nImplements IWorksheetService\n'@Folder \"Services.Stubs\"\n\nPrivate Type TStub\n    WasWritten As Boolean\n    WrittenData As Variant\nEnd Type\nPrivate this As TStub\n\nPrivate Sub IWorksheetService_WriteAllData(ByRef data As Variant)\n    this.WasWritten = True\n    this.WrittenData = data\nEnd Sub\n\nPublic Property Get DataWasWritten() As Boolean\n    DataWasWritten = this.WasWritten\nEnd Property\n\nPublic Property Get WrittenData() As Variant\n    WrittenData = this.WrittenData\nEnd Property\n</code></pre>\n\n<p>Now change the test to assert that <code>IDataService.GetSomeTable</code> is returning <em>the same data</em> that <code>IWorksheetService.WriteAllData</code> works with - you can do that using <code>Assert.SequenceEquals</code>, which compares all elements of two arrays and fails if anything is different:</p>\n\n<pre><code>'@TestMethod\nPublic Sub WorksheetServiceWorksOffDataFromDataService()\n    'Arrange\n    Dim dataServiceStub As StubDataService\n    Set dataServiceStub = New StubDataService\n    Dim expected As Variant\n    expected = dataServiceStub.GetSomeTable\n\n    Dim wsServiceStub As StubWorksheetService\n    Set wsServiceStub = New StubWorksheetService\n\n    'Act\n    With New Macro\n        .Run dataServiceStub, wsServiceStub\n    End With\n\n    Dim actual As Variant\n    actual = wsServiceStub.WrittenData\n\n    'Assert\n    Assert.SequenceEquals expected, actual\nEnd Sub\n</code></pre>\n\n<p>This makes the test much simpler, and it passes:</p>\n\n<p><a href=\"https://i.stack.imgur.com/R2nv3.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/R2nv3.png\" alt=\"Passing tests in Rubberduck test explorer\"></a></p>\n\n<hr>\n\n<p>I will be updating the article with this simpler test later today.</p>\n"}], "owner": {"reputation": 1532, "user_id": 5996109, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/ea8a30cf336f9bdd23ecafdae26e2b2a?s=128&d=identicon&r=PG&f=1", "display_name": "Alfa Bravo", "link": "https://stackoverflow.com/users/5996109/alfa-bravo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 449, "favorite_count": 1, "accepted_answer_id": 50025613, "answer_count": 1, "score": 6, "last_activity_date": 1524668700, "creation_date": 1524663372, "question_id": 50023782, "link": "https://stackoverflow.com/questions/50023782/how-to-unit-test-vba-code-two-different-pointers", "title": "How to unit test VBA code? - Two different pointers", "body": "<p>I am working on <a href=\"https://rubberduckvba.wordpress.com/2017/10/19/how-to-unit-test-vba-code/\" rel=\"noreferrer\">this</a> excellent tutorial, but in the end my first test is not passing, due to the fact that I can clearly see I am creating two different arrays (and pointers), and trying to compare them with one another.</p>\n\n<p>Now the tutorial from what I can see leaves out a few lines of code that I have added, which is also where I see the problem, but without those lines the code does not even run of coarse.</p>\n\n<p>All my other test methods are the same as the example, except for this method that I created the following lines - else nothing happens when you run the test.</p>\n\n<pre><code>Public Sub Run(ByVal dataService As IDataService, ByVal wsService As IWorksheetService)\nDim data As Variant                   'Added this line\ndata = dataService.GetSomeTable       'Added this line\nCall wsService.WriteAllData(data)     'Added this line\nEnd Sub\n</code></pre>\n\n<p>And here is where I can see the code going south...</p>\n\n<pre><code>'@TestMethod\nPublic Sub WorksheetServiceWorksOffDataFromDataService()\n    'Arrange\n    Dim dataServiceStub As MyDataServiceStub\n    Set dataServiceStub = New MyDataServiceStub\n    Dim expected As LongLong\n    expected = VarPtr(dataServiceStub.GetSomeTable)  'expected creates an Array\n\nDim wsServiceStub As MyWorksheetServiceStub\nSet wsServiceStub = New MyWorksheetServiceStub\n\n'Act\nWith New MyTestableMacro\n    .Run dataServiceStub, wsServiceStub 'here we create a second array\nEnd With\n\nDim actual As LongLong\nactual = wsServiceStub.WrittenArrayPointer 'here we point to the address of the second array\n\n'Assert\nAssert.AreEqual expected, actual  ' this test fails cause it points to two different addresses\nEnd Sub\n</code></pre>\n\n<p>I had to change the type from Long as in the tutorial for the array pointers to LongLong due to the fact that the number on 64 bit is too long for Long. LongPtr also worked</p>\n"}, {"tags": ["excel", "vba", "move", "shape", "visible"], "comments": [{"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1524662567, "post_id": 50023399, "comment_id": 87063093, "body": "Not sure what your issue is. Is your issue that the shape is not moving? or your code is throwing an error message? or <code>screen is freezing</code>? or the combination?"}], "answers": [{"tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": true, "score": 0, "last_activity_date": 1524663189, "last_edit_date": 1524663189, "creation_date": 1524662690, "answer_id": 50023573, "question_id": 50023399, "link": "https://stackoverflow.com/questions/50023399/move-shape-visible/50023573#50023573", "title": "Move Shape visible", "body": "<p>Put a <code>DoEvents</code> immediately after the <code>.IncrementLeft</code>.  This should allow the worksheet to display the Shape as it moves.</p>\n\n<p>By adjusting the size of the increment, you can get the motion to speed-up or slow-down.</p>\n"}], "owner": {"reputation": 7, "user_id": 9697384, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "InfinityCubeInteractive", "link": "https://stackoverflow.com/users/9697384/infinitycubeinteractive"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 53, "favorite_count": 0, "accepted_answer_id": 50023573, "answer_count": 1, "score": 0, "last_activity_date": 1524663189, "creation_date": 1524662154, "last_edit_date": 1524662760, "question_id": 50023399, "link": "https://stackoverflow.com/questions/50023399/move-shape-visible", "title": "Move Shape visible", "body": "<p>I'm trying to move a group of pictures in Excel with VBA, this works fine, but I want that the user can see how the picture is moving.</p>\n\n<p>It's for a little game, a \"Horse Race\".</p>\n\n<p>Here is my code for moving the horses.</p>\n\n<pre><code>Sub TrackProgress()\nDim Tracks() As GroupObject\nDim Agents(), HorseCount As Integer\nDim AgentCount As Integer\nDim TrackCount As Integer\nDim Progress As Double\nDim MaxPx As Double\n\nAgentCount = Sheets(\"Config\").Range(\"O5\").Value\nTrackCount = Round(AgentCount / HorsesPerTrack, 0)\nReDim Tracks(1 To TrackCount)\nReDim Agents(1 To AgentCount)\nMaxPx = Sheets(\"Config\").Range(\"O15\").Value\n\n\nSheets(\"HorseRaceTrack\").Select\n\nFor i = 6 To Sheets(\"Config\").Cells(Rows.Count, 5).End(xlUp).Row\n\n    If Sheets(\"Config\").Cells(i, 4).Value = \"Active\" Then\n        Agents(i - 5) = Sheets(\"Config\").Cells(i, 5).Value\n    End If\n\nNext i\n\nFor i = 1 To AgentCount\n\n    If Not IsError(Sheets(\"Config\").Cells(i + 5, 7).Value) Then\n        Progress = Sheets(\"Config\").Cells(i + 5, 7).Value\n        Do Until Sheets(\"HorseRaceTrack\").Shapes(\"Horse_\" &amp; Agents(i)).Left &gt;= (MaxPx * Progress)\n            Sheets(\"HorseRaceTrack\").Shapes(\"Horse_\" &amp; Agents(i)).IncrementLeft 1.3636220472\n            'Sleep 1000 ' Pferd beweg sich nicht fl\u00fcssig....\n        Loop\n    Else\n        GoTo NextOne\n    End If\n\nNextOne:\nNext i\n\nEnd Sub\n</code></pre>\n\n<p>I already tried to use \"sleep 500\" but the screen is also freezing</p>\n\n<p>Thanks for your help!</p>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 1, "creation_date": 1524667363, "post_id": 50023126, "comment_id": 87066304, "body": "If this code runs in Access, you can&#39;t do <code>workbooks(&quot;foo&quot;).bar</code>. You must use your Excel Application object, e.g. <code>objExcel.Workboks(...)</code>."}], "answers": [{"comments": [{"owner": {"reputation": 27, "user_id": 9664804, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18755364273b98f62a0cf4fc202a3dab?s=128&d=identicon&r=PG&f=1", "display_name": "Drac", "link": "https://stackoverflow.com/users/9664804/drac"}, "edited": false, "score": 0, "creation_date": 1524665079, "post_id": 50023978, "comment_id": 87064708, "body": "Hello Erin, thank you for looking into this for me and offering a possible solution. I just tried this and your code does exactly what it is supposed to do for me. yet when i get a True value it still gives the error when trying to execute my line."}, {"owner": {"reputation": 100, "user_id": 3919757, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ae394ac1e62c9c3b9e469c23224f284?s=128&d=identicon&r=PG&f=1", "display_name": "Erin B", "link": "https://stackoverflow.com/users/3919757/erin-b"}, "reply_to_user": {"reputation": 27, "user_id": 9664804, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18755364273b98f62a0cf4fc202a3dab?s=128&d=identicon&r=PG&f=1", "display_name": "Drac", "link": "https://stackoverflow.com/users/9664804/drac"}, "edited": false, "score": 0, "creation_date": 1524665143, "post_id": 50023978, "comment_id": 87064758, "body": "Try referencing using the GetObject function. Still a runtime error 9?"}, {"owner": {"reputation": 27, "user_id": 9664804, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18755364273b98f62a0cf4fc202a3dab?s=128&d=identicon&r=PG&f=1", "display_name": "Drac", "link": "https://stackoverflow.com/users/9664804/drac"}, "edited": false, "score": 1, "creation_date": 1524665226, "post_id": 50023978, "comment_id": 87064816, "body": "On the other hand this gives me the option to give the user a warning to close it himself :) I think ill do that for now. Thanks !"}, {"owner": {"reputation": 27, "user_id": 9664804, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18755364273b98f62a0cf4fc202a3dab?s=128&d=identicon&r=PG&f=1", "display_name": "Drac", "link": "https://stackoverflow.com/users/9664804/drac"}, "edited": false, "score": 0, "creation_date": 1524665746, "post_id": 50023978, "comment_id": 87065150, "body": "Hello Erin, That did actually close something. now only Excel is still open but no workbook inside it. no error though"}, {"owner": {"reputation": 100, "user_id": 3919757, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ae394ac1e62c9c3b9e469c23224f284?s=128&d=identicon&r=PG&f=1", "display_name": "Erin B", "link": "https://stackoverflow.com/users/3919757/erin-b"}, "reply_to_user": {"reputation": 27, "user_id": 9664804, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18755364273b98f62a0cf4fc202a3dab?s=128&d=identicon&r=PG&f=1", "display_name": "Drac", "link": "https://stackoverflow.com/users/9664804/drac"}, "edited": false, "score": 0, "creation_date": 1524665939, "post_id": 50023978, "comment_id": 87065287, "body": "Yeah, it only closes the file referenced, not the excel application in case the user has other files open as well."}, {"owner": {"reputation": 27, "user_id": 9664804, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18755364273b98f62a0cf4fc202a3dab?s=128&d=identicon&r=PG&f=1", "display_name": "Drac", "link": "https://stackoverflow.com/users/9664804/drac"}, "edited": false, "score": 0, "creation_date": 1524665995, "post_id": 50023978, "comment_id": 87065325, "body": "I think I can work with that. thanks a lot for your time and help."}], "tags": [], "owner": {"reputation": 100, "user_id": 3919757, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ae394ac1e62c9c3b9e469c23224f284?s=128&d=identicon&r=PG&f=1", "display_name": "Erin B", "link": "https://stackoverflow.com/users/3919757/erin-b"}, "is_accepted": true, "score": 0, "last_activity_date": 1524665081, "last_edit_date": 1524665081, "creation_date": 1524663947, "answer_id": 50023978, "question_id": 50023126, "link": "https://stackoverflow.com/questions/50023126/workbooks-close-does-not-work-for-me/50023978#50023978", "title": "workbooks.close does not work for me", "body": "<p>You have to check to see if it's open, and reference the open object properly. The function below (which I picked up off SO somewhere), returns a true/false value about the file in particular:</p>\n\n<p>You would use it as such:</p>\n\n<pre><code>Private Sub Command1_Click()\nDim xls As Object\n\nIf IsWorkBookOpen(\"C:/Users/Desktop/Workbook.xlsm\") = True Then\n    Set xls = GetObject(\"C:/Users/Desktop/Workbook.xlsm\")\n    xls.Close True\nElse\n    'do stuff if closed\nEnd If\n\nEnd Sub\n</code></pre>\n\n<p>Function:</p>\n\n<pre><code>Function IsWorkBookOpen(FileName As String)\n    Dim ff As Long, ErrNo As Long\n\n    On Error Resume Next\n    ff = FreeFile()\n    Open FileName For Input Lock Read As #ff\n    Close ff\n    ErrNo = Err\n    On Error GoTo 0\n\n    Select Case ErrNo\n    Case 0:    IsWorkBookOpen = False\n    Case 70:   IsWorkBookOpen = True\n    Case Else: Error ErrNo\n    End Select\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 27, "user_id": 9664804, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18755364273b98f62a0cf4fc202a3dab?s=128&d=identicon&r=PG&f=1", "display_name": "Drac", "link": "https://stackoverflow.com/users/9664804/drac"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 842, "favorite_count": 0, "accepted_answer_id": 50023978, "answer_count": 1, "score": 0, "last_activity_date": 1524689689, "creation_date": 1524661387, "last_edit_date": 1524689689, "question_id": 50023126, "link": "https://stackoverflow.com/questions/50023126/workbooks-close-does-not-work-for-me", "title": "workbooks.close does not work for me", "body": "<p>Hope someone can help with my following problem.</p>\n\n<p>I want to make sure a specific workbook is closed before It gets an update.\nfor that I was planning to start with.</p>\n\n<p><code>Private Sub Command1_Click()\nworkbooks(\"workbookname.XLSM\").close Savechanges = False\nEnd Sub</code></p>\n\n<p>I also tried</p>\n\n<p><code>workbooks(\"workbookname.Xlsm\").close</code> </p>\n\n<p>Both i have run separately and both give me Error code 9.</p>\n\n<p>The specific file will always be on the desktop of the user.</p>\n\n<p>I thought it might have something to do with my references so I checked and have the following references turned on. (some for other specific reasons).</p>\n\n<ul>\n<li>Visual Basic For Applications </li>\n<li>Microsoft Access 16.0 Object Library</li>\n<li>OLE Automation </li>\n<li>Microsoft DAO 3.6 Object Library </li>\n<li>Microsoft Excel 16.0</li>\n<li>Object Library Microsoft Scripting Runtime.</li>\n</ul>\n\n<p>Really hope someone can help me with this. I've been surfing quite a large number of forums but no where i could find the same problem or solution.</p>\n\n<p>w.k.r. Drac.</p>\n"}, {"tags": ["sql", "excel", "vba"], "comments": [{"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1524661271, "post_id": 50022802, "comment_id": 87062140, "body": "have you checked to see that all your VBA reference are ok? (i.e. none of them have &#39;Missing&#39; infront of them). Also, which line throws the error?"}, {"owner": {"reputation": 13, "user_id": 3130038, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a79f3d7769c278fd2ac7c274e52ef33?s=128&d=identicon&r=PG&f=1", "display_name": "user3130038", "link": "https://stackoverflow.com/users/3130038/user3130038"}, "reply_to_user": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1524661468, "post_id": 50022802, "comment_id": 87062272, "body": "Yes none of them have missing in VBA references"}, {"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1524668767, "post_id": 50022802, "comment_id": 87067339, "body": "First wrap function in <a href=\"http://www.cpearson.com/excel/errorhandling.htm\" rel=\"nofollow noreferrer\">error handling</a> to possibly get a more specific error message. And where is the SQL query derived? Show VBA assignment of <i>Query</i> string. Try <code>debug.Print StrQuery</code>"}], "answers": [{"tags": [], "owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "is_accepted": false, "score": 0, "last_activity_date": 1524668202, "creation_date": 1524668202, "answer_id": 50025423, "question_id": 50022802, "link": "https://stackoverflow.com/questions/50022802/having-excel-function-vba-connection-to-sql-issue-compile-error/50025423#50025423", "title": "Having Excel function VBA connection to SQL issue - Compile Error", "body": "<p>Make sure you include the reference to </p>\n\n<blockquote>\n  <p>Microsoft ActiveX Data Objects 2.1 Library</p>\n</blockquote>\n\n<p><a href=\"https://i.stack.imgur.com/g3Iu6.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/g3Iu6.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 13, "user_id": 3130038, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a79f3d7769c278fd2ac7c274e52ef33?s=128&d=identicon&r=PG&f=1", "display_name": "user3130038", "link": "https://stackoverflow.com/users/3130038/user3130038"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 138, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1524668202, "creation_date": 1524660495, "last_edit_date": 1524667190, "question_id": 50022802, "link": "https://stackoverflow.com/questions/50022802/having-excel-function-vba-connection-to-sql-issue-compile-error", "title": "Having Excel function VBA connection to SQL issue - Compile Error", "body": "<p>Hi I am trying to run a function in my excel table where a query is run through the function and data is generated but I have managed to fix the query which works when I use in SQL but when I run the function from Excel I get the following error:</p>\n\n<blockquote>\n  <p>Compile Error:  User-defined type not defined.</p>\n</blockquote>\n\n<p><strong>error which I get in EXCEL VB:</strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/M1Zw7.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/M1Zw7.png\" alt=\"enter image description here\"></a></p>\n\n<p>The function I am running is: </p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Function Download_Standard_BOM(Query As String)\n    Dim cnn As New ADODB.Connection\n    Dim rst As New ADODB.Recordset\n    Dim ConnectionString As String\n    Dim StrQuery As String\n\n    ConnectionString = \"Driver={SQL Server};Server=STORESYSTEM \n;Database=STORE;Trusted_Connection=Yes;\"\n\n    cnn.Open ConnectionString\n    StrQuery = Query 'Sheets(\"Tests Scenario\").Range(\"J2\").Offset(i, 0).Value\n    cnn.CommandTimeout = 100\n    rst.Open StrQuery, cnn, adOpenStatic, adLockOptimistic\n    Download_Standard_BOM = rst(\"NAME\")\nEnd Function\n</code></pre>\n\n<p>and the SQL query I am running is: </p>\n\n<pre class=\"lang-sql prettyprint-override\"><code>SELECT TOP 1 NAME\nFROM [SERVER].[dbo].[STORE]\nWHERE SecurityE = 'SGX' AND\n      Trans = ' 0' AND\n      Type = '9' AND\n      Status = '0' AND\n      SubId = 'Reversal'\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 1, "creation_date": 1524660465, "post_id": 50022699, "comment_id": 87061495, "body": "You are missing a <code>Next</code> for the first <code>For Each</code> loop (directly after the <code>Next</code> and before the <code>End If</code>)."}, {"owner": {"reputation": 1118, "user_id": 8282232, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/775ef4ecf830083680ae6dbae8da395c?s=128&d=identicon&r=PG&f=1", "display_name": "AntiDrondert", "link": "https://stackoverflow.com/users/8282232/antidrondert"}, "edited": false, "score": 0, "creation_date": 1524660470, "post_id": 50022699, "comment_id": 87061500, "body": "<code>For Each wrkSht In ActiveWorkbook.Worksheets</code> you do not have <code>End For</code>"}, {"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1524660472, "post_id": 50022699, "comment_id": 87061502, "body": "Your <code>If wrkSht.Name &lt;&gt; &quot;New Servers&quot; Then</code> condition should be in your <code>For Each wrkSht In ActiveWorkbook.Worksheets</code> loop as outside of that loop, <code>wrkSht</code> is just a <code>Worksheet</code> object and isn&#39;t pointing to a worksheet"}, {"owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "reply_to_user": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1524660770, "post_id": 50022699, "comment_id": 87061722, "body": "@Zac is correct, plus the missing <code>next</code> as indicated by @peh. You need the <code>if sheet&lt;&gt;&quot;name&quot; then</code> after <code>for each sh</code> and <code>end if</code> before <code>next sh</code>"}, {"owner": {"reputation": 707, "user_id": 6404012, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-nccfgilpFMs/AAAAAAAAAAI/AAAAAAAAAbY/Om5Ipcplj7U/photo.jpg?sz=128", "display_name": "Eitel Dagnin", "link": "https://stackoverflow.com/users/6404012/eitel-dagnin"}, "edited": false, "score": 0, "creation_date": 1524661162, "post_id": 50022699, "comment_id": 87062047, "body": "Thank you so much all of you :) I amended the code above too as it is working now :)"}, {"owner": {"reputation": 5598, "user_id": 3964075, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9cbf64d99cdcd5bb751d16fcfa75b2f?s=128&d=identicon&r=PG&f=1", "display_name": "BrakNicku", "link": "https://stackoverflow.com/users/3964075/braknicku"}, "edited": false, "score": 0, "creation_date": 1524661308, "post_id": 50022699, "comment_id": 87062168, "body": "The question after last edit doesn&#39;t make sense - there&#39;s no error, so the question should be deleted or the edit rolled back."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1524661336, "post_id": 50022699, "comment_id": 87062184, "body": "@EitelDagnin Instead of changing your question to the solution, it is probably better to leave the question in its original state and post your solution as an answer. Also you can accept your own answer as solution after a while (I think one day)."}, {"owner": {"reputation": 707, "user_id": 6404012, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-nccfgilpFMs/AAAAAAAAAAI/AAAAAAAAAbY/Om5Ipcplj7U/photo.jpg?sz=128", "display_name": "Eitel Dagnin", "link": "https://stackoverflow.com/users/6404012/eitel-dagnin"}, "edited": false, "score": 1, "creation_date": 1524661821, "post_id": 50022699, "comment_id": 87062542, "body": "Apologies, I will &quot;undo&quot; the changes and post the solution."}], "answers": [{"tags": [], "owner": {"reputation": 707, "user_id": 6404012, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-nccfgilpFMs/AAAAAAAAAAI/AAAAAAAAAbY/Om5Ipcplj7U/photo.jpg?sz=128", "display_name": "Eitel Dagnin", "link": "https://stackoverflow.com/users/6404012/eitel-dagnin"}, "is_accepted": true, "score": 4, "last_activity_date": 1524662060, "creation_date": 1524662060, "answer_id": 50023370, "question_id": 50022699, "link": "https://stackoverflow.com/questions/50022699/vba-loop-through-all-sheets-and-exclude-one/50023370#50023370", "title": "VBA - Loop Through All Sheets And Exclude One", "body": "<p>Here is the working solution to my quesiton:</p>\n\n<pre><code>Sub Servers3_DeleteIrrelevantColumns()\n\n    'Initialize variables\n    Dim currentColumn As Integer\n    Dim columnHeading As String\n    Dim wrkSht As Worksheet\n\n    'Rename headers on all sheets if matched\n\n    For Each wrkSht In ActiveWorkbook.Worksheets\n\n        If wrkSht.Name &lt;&gt; \"New Servers\" Then\n\n            wrkSht.Cells(1, 1).EntireRow.Replace What:=\"*ServerName*\", Replacement:=\"Server Name\", Lookat:=xlWhole\n\n            For currentColumn = wrkSht.UsedRange.Columns.Count To 1 Step -1\n\n                columnHeading = wrkSht.UsedRange.Cells(1, currentColumn).Value\n\n                'Check whether to keep column\n                Select Case columnHeading\n\n                    Case \"Server Name\"\n\n                    'Do nothing\n\n                    Case Else\n\n                    wrkSht.Columns(currentColumn).Delete\n\n                End Select\n\n            Next\n\n        End If\n\n    Next wrkSht\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 707, "user_id": 6404012, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-nccfgilpFMs/AAAAAAAAAAI/AAAAAAAAAbY/Om5Ipcplj7U/photo.jpg?sz=128", "display_name": "Eitel Dagnin", "link": "https://stackoverflow.com/users/6404012/eitel-dagnin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1865, "favorite_count": 0, "accepted_answer_id": 50023370, "answer_count": 1, "score": 1, "last_activity_date": 1524662060, "creation_date": 1524660169, "last_edit_date": 1524662023, "question_id": 50022699, "link": "https://stackoverflow.com/questions/50022699/vba-loop-through-all-sheets-and-exclude-one", "title": "VBA - Loop Through All Sheets And Exclude One", "body": "<p>I need to perform the exact same task on all the sheets in the workbook except for one, I have the below code but I get the following error:</p>\n\n<blockquote>\n  <p>End If without Block If</p>\n</blockquote>\n\n<pre><code>    Sub Servers3_DeleteIrrelevantColumns()\n\n    'Initialize variables\n    Dim currentColumn As Integer\n    Dim columnHeading As String\n    Dim wrkSht As Worksheet\n\n    'Rename headers on all sheets if matched\n\n        If wrkSht.Name &lt;&gt; \"New Servers\" Then\n    For Each wrkSht In ActiveWorkbook.Worksheets\n\n            wrkSht.Cells(1, 1).EntireRow.Replace What:=\"*ServerName*\", Replacement:=\"Server Name\", Lookat:=xlWhole\n\n            For currentColumn = wrkSht.UsedRange.Columns.Count To 1 Step -1\n\n                columnHeading = wrkSht.UsedRange.Cells(1, currentColumn).Value\n\n                'Check whether to keep column\n                Select Case columnHeading\n\n                    Case \"Server Name\"\n\n                    'Do nothing\n\n                    Case Else\n\n                    wrkSht.Columns(currentColumn).Delete\n\n                End Select\n\n            Next\n\n        End If\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 11192, "user_id": 5514747, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/db1a440aac7d279213c66bcdb1c1984a?s=128&d=identicon&r=PG", "display_name": "Harun24HR", "link": "https://stackoverflow.com/users/5514747/harun24hr"}, "edited": false, "score": 0, "creation_date": 1524659638, "post_id": 50022411, "comment_id": 87060862, "body": "So many mistake in syntax."}, {"owner": {"reputation": 11192, "user_id": 5514747, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/db1a440aac7d279213c66bcdb1c1984a?s=128&d=identicon&r=PG", "display_name": "Harun24HR", "link": "https://stackoverflow.com/users/5514747/harun24hr"}, "edited": false, "score": 0, "creation_date": 1524659832, "post_id": 50022411, "comment_id": 87061025, "body": "What actually you want to do."}], "answers": [{"tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 0, "last_activity_date": 1524678411, "last_edit_date": 1524678411, "creation_date": 1524660048, "answer_id": 50022653, "question_id": 50022411, "link": "https://stackoverflow.com/questions/50022411/how-do-i-adapt-this-program-in-vba-so-that-the-original-temperature-is-placed-in/50022653#50022653", "title": "How do I adapt this program in VBA so that the original temperature is placed in a cell next to the converted temperature?", "body": "<p>A very small number of \"syntax\"typos:</p>\n\n<pre><code>Sub ConvertTemp()\n    Centigrade = MsgBox(\"Do you want to convert to centigrade?\", vbYesNo)\n    InputNumber = Val(InputBox(\"Enter a temperature for conversion?\"))\n    If Centigradde = vbYes Then\n        ConvertedTemp = ((9 / 5 * InputNumber) + 32)\n        MsgBox ((InputNumber &amp; \" degrees C converts to \" &amp; ConvertedTemp &amp; \" Degrees F.\"))\n    Else\n        ConvertedTemp = (5 / 9) * (InputNumber - 32)\n    End If\n    MsgBox (InputNumber &amp; \" degrees F converts to \" &amp; ConvertedTemp &amp; \" degrees C.\")\n    Worksheets(\"Sheet1\").Cells(InputNumber, ConvertedTemp).Offset(-1, 0).Value = \"Name\"\nEnd Sub\n</code></pre>\n\n<p><strong>EDIT#1:</strong></p>\n\n<p>A better version:</p>\n\n<pre><code>Option Explicit\n\nSub ConvertTemp()\n\n    Dim Centigrade As String, InputNumber As Variant, ConvertedTemp As Double\n\n    Centigrade = MsgBox(\"Do you want to convert to centigrade?\", vbYesNo)\n    InputNumber = Val(InputBox(\"Enter a temperature for conversion?\"))\n    If Centigrade = vbYes Then\n        ConvertedTemp = ((9 / 5 * InputNumber) + 32)\n        MsgBox ((InputNumber &amp; \" degrees C converts to \" &amp; ConvertedTemp &amp; \" Degrees F.\"))\n    Else\n        ConvertedTemp = (5 / 9) * (InputNumber - 32)\n    End If\n    MsgBox (InputNumber &amp; \" degrees F converts to \" &amp; ConvertedTemp &amp; \" degrees C.\")\n    Worksheets(\"Sheet1\").Cells(InputNumber, ConvertedTemp).Offset(-1, 0).Value = \"Name\"\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 9697260, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7005dda80333965cab750a9ca57a1d7?s=128&d=identicon&r=PG&f=1", "display_name": "AnUnknownStudent", "link": "https://stackoverflow.com/users/9697260/anunknownstudent"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 24, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1524678411, "creation_date": 1524659382, "last_edit_date": 1524659619, "question_id": 50022411, "link": "https://stackoverflow.com/questions/50022411/how-do-i-adapt-this-program-in-vba-so-that-the-original-temperature-is-placed-in", "title": "How do I adapt this program in VBA so that the original temperature is placed in a cell next to the converted temperature?", "body": "<p>This is my code... It keeps saying </p>\n\n<pre><code>SubConvertTemp()\nCentigrade=MsgBox(Do you want to convert to centigrade?\"),vbYesNo)\nInputNumber=Val(InputBox(\"Enter a temperature for conversion?\"))\nIf Centigradde= vbYes Then \nConvertedTemp= ((9/5 *InputNumber)+32)\nMsgBox((InputNumber &amp; \" degrees C converts to \" &amp; ConvertedTemp &amp;\" Degrees F.\"))\nElse: ConvertedTemp=(5/9)*(InputNumber-32)\nMsgBox(InputNumber &amp; \"degrees F converts to \" &amp; ConvertedTemp &amp; \"degrees C.\")\nWorksheets.(\"Sheet 1).Cells(InputNumber,ConvertedTemp).Offset(-1,0).Value=\"Name\"\nend sub\n</code></pre>\n\n<p>This code keeps saying syntax error? Not sure why </p>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1524659578, "post_id": 50022100, "comment_id": 87060801, "body": "Define your own public collection in the form module, and add the objects to it?"}], "answers": [{"comments": [{"owner": {"reputation": 83, "user_id": 7880845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ef44e762b7703678519f27c35167b6eb?s=128&d=identicon&r=PG&f=1", "display_name": "Java-Jim", "link": "https://stackoverflow.com/users/7880845/java-jim"}, "edited": false, "score": 0, "creation_date": 1524660309, "post_id": 50022495, "comment_id": 87061391, "body": "PERFECT! Eric this is exactly what i needed."}], "tags": [], "owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "is_accepted": true, "score": 1, "last_activity_date": 1524659610, "last_edit_date": 1525816189, "creation_date": 1524659610, "answer_id": 50022495, "question_id": 50022100, "link": "https://stackoverflow.com/questions/50022100/ms-access-list-class-objects-in-a-form-like-controls-collection/50022495#50022495", "title": "MS Access list class objects in a form (like controls collection)", "body": "<p>You can use a publicly accessible collection for this, e.g.</p>\n\n\n\n<pre class=\"lang-vb prettyprint-override\"><code>Dim myObjects As Collection\n\nPrivate Sub Form_Load()\n    Set MyObjects = New Collection\n    MyObjects.Add Obj1, \"First Object\"\n    MyObjects.Add Obj2, \"Second Object\"\nEnd Sub\n</code></pre>\n\n<p>Then, in the global scope:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Forms(\"MyForm\").MyObjects(\"First Object\").Property\n</code></pre>\n\n<p>Of course, if you really wanted to do fancy things, you could use a <a href=\"http://www.cpearson.com/excel/CollectionClass.aspx\" rel=\"nofollow noreferrer\">custom collection class</a>, which would allow you to have more control over the class and have intellisense on its members.</p>\n"}], "owner": {"reputation": 83, "user_id": 7880845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ef44e762b7703678519f27c35167b6eb?s=128&d=identicon&r=PG&f=1", "display_name": "Java-Jim", "link": "https://stackoverflow.com/users/7880845/java-jim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 56, "favorite_count": 0, "accepted_answer_id": 50022495, "answer_count": 1, "score": 0, "last_activity_date": 1524659610, "creation_date": 1524658506, "question_id": 50022100, "link": "https://stackoverflow.com/questions/50022100/ms-access-list-class-objects-in-a-form-like-controls-collection", "title": "MS Access list class objects in a form (like controls collection)", "body": "<p>I have a form where i dynamically instanciate objects from a custom class module.\nThe resulting objects are defined public and i can access then in a module via <code>Forms(\"Formname\").objName1.Property</code></p>\n\n<p>I want to access the objects dynamically too, like it would be possible in the controls collection: <code>Forms(\"Formname\").Controls(\"objName\" &amp; ID).Property</code>\nbut there is no collection of objects.</p>\n\n<p>Has someone an advice?</p>\n"}, {"tags": ["excel", "vlookup", "vba"], "comments": [{"owner": {"reputation": 1118, "user_id": 8282232, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/775ef4ecf830083680ae6dbae8da395c?s=128&d=identicon&r=PG&f=1", "display_name": "AntiDrondert", "link": "https://stackoverflow.com/users/8282232/antidrondert"}, "edited": false, "score": 2, "creation_date": 1524658942, "post_id": 50022087, "comment_id": 87060317, "body": "Even though you provided examples of original data and desired result it is still hard to grasp the concept of what you&#39;re trying to achieve. Can you clarify it a bit more?"}, {"owner": {"reputation": 288, "user_id": 9691932, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-l-yvEHOFuLI/AAAAAAAAAAI/AAAAAAAAMUM/35Q4c5GZb20/photo.jpg?sz=128", "display_name": "CFO", "link": "https://stackoverflow.com/users/9691932/cfo"}, "edited": false, "score": 1, "creation_date": 1524658954, "post_id": 50022087, "comment_id": 87060324, "body": "Probably worth trying a few things and when you get stuck ask a specific question."}, {"owner": {"reputation": 101, "user_id": 8981559, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh6.googleusercontent.com/-qyIre2-F9WU/AAAAAAAAAAI/AAAAAAAAACQ/-zJdEoWuv9s/photo.jpg?sz=128", "display_name": "toyo10", "link": "https://stackoverflow.com/users/8981559/toyo10"}, "edited": false, "score": 0, "creation_date": 1524659420, "post_id": 50022087, "comment_id": 87060674, "body": "I solved how to subset, so I deleted the second part. As regard the first one, I just want to rearrange from Example 1 to Example 2. So from the oldest to the newest date keeping different column for each time series."}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1524659993, "post_id": 50022087, "comment_id": 87061143, "body": "Where&#39;s the <code>23</code> and <code>32, 2</code> under <code>BA</code>  come from on the bottom table?   I can&#39;t see how the top table can convert to the bottom table - thought I did, but not everything has been converted.... is that by design?"}, {"owner": {"reputation": 101, "user_id": 8981559, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh6.googleusercontent.com/-qyIre2-F9WU/AAAAAAAAAAI/AAAAAAAAACQ/-zJdEoWuv9s/photo.jpg?sz=128", "display_name": "toyo10", "link": "https://stackoverflow.com/users/8981559/toyo10"}, "edited": false, "score": 0, "creation_date": 1524660624, "post_id": 50022087, "comment_id": 87061624, "body": "Oh no, it&#39;s just a matter of formatting decimal numbers that comma <code>,</code>. That&#39;s how the italian excel version threat them. Consider it as 32.2, it&#39;s exactly the same. I&#39;m gonna change it now to avoid further confusion."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 1, "creation_date": 1524662680, "post_id": 50022087, "comment_id": 87063189, "body": "@toyo10 I think what Darren meant to say is that the values <code>32.2</code>, <code>181.3</code> and <code>23</code> that appear in your result (lower example), do not appear in your datatset (upper example). So how can we know where they come from? It is very hard to understand what your actual goal is because your data and example is not consistent. Try to be as precise as possible with your description and your examples. So Eg. <i>&quot;taking the longest period of time on first column&quot;</i> is very unclear! I don&#39;t see where you take a period of time from?"}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1524746970, "post_id": 50022087, "comment_id": 87102835, "body": "Posting the same questing repeatedly is against <a href=\"https://stackoverflow.com\">Stack Overflow</a> policies.  Please remove one."}, {"owner": {"reputation": 101, "user_id": 8981559, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh6.googleusercontent.com/-qyIre2-F9WU/AAAAAAAAAAI/AAAAAAAAACQ/-zJdEoWuv9s/photo.jpg?sz=128", "display_name": "toyo10", "link": "https://stackoverflow.com/users/8981559/toyo10"}, "edited": false, "score": 0, "creation_date": 1524747109, "post_id": 50022087, "comment_id": 87102955, "body": "Gotcha. That value does not appear in the dataset since they are under the <code>...</code>. I reported the starting values (132.1 in 09/01/2018 for ACA, 22.12 in 28/04/2013 for BA and  180.01 in 21/01/2016 for DIL) but the database contain many different values up to today for each series. In the example I just showed how the data set would be i.e. ordered by date. To make it clear I added some values I don&#39;t posted in the first example. I&#39;m gonna add them in the example for clarification."}], "answers": [{"tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": true, "score": 1, "last_activity_date": 1524749985, "last_edit_date": 1524749985, "creation_date": 1524749136, "answer_id": 50044202, "question_id": 50022087, "link": "https://stackoverflow.com/questions/50022087/convert-time-series-format/50044202#50044202", "title": "Convert time series format", "body": "<p>You can do this with Powerquery. </p>\n\n<p>Step 1: Select a populated cell in your data range  Goto PowerQuery tab if pre Excel 2016 (and have installed the free-add in) or Data tab in 2016 > Data  > Get &amp; Transform > from table</p>\n\n<p><a href=\"https://i.stack.imgur.com/wYLR1.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/wYLR1.png\" alt=\"Select a cell then Data &gt; From table\"></a></p>\n\n<p>Step 2: Make sure <code>date</code> column is formatted as Date</p>\n\n<p><a href=\"https://i.stack.imgur.com/qrzQk.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/qrzQk.png\" alt=\"Date column\"></a></p>\n\n<p>Step 3: Order <code>date</code> column in ascending order</p>\n\n<p><a href=\"https://i.stack.imgur.com/eG4tc.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/eG4tc.png\" alt=\"Ascending column sort\"></a></p>\n\n<p>Step 4: Select <code>symbol</code> column > Transform tab > Pivot column</p>\n\n<p><a href=\"https://i.stack.imgur.com/xA2XU.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/xA2XU.png\" alt=\"Select column and choose pivot column\"></a></p>\n\n<p>Ensure that values part is using <code>Close</code></p>\n\n<p><a href=\"https://i.stack.imgur.com/hVC4h.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/hVC4h.png\" alt=\"Values using Close for pivot on Symbol column\"></a></p>\n\n<p>Step 5: Re-arrange columns as required</p>\n\n<p><a href=\"https://i.stack.imgur.com/t1ihs.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/t1ihs.png\" alt=\"Re-arranged columns\"></a></p>\n\n<p>Step 6: Close and <strong><em>load to page</em></strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/pv4tu.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/pv4tu.png\" alt=\"Close and load (choose lower option of too page)\"></a></p>\n\n<p>Note: You do not replace Null with NaN. When exported to sheet these cells will be blank.</p>\n\n<p>M Code:</p>\n\n<pre><code>let\n    Source = Excel.CurrentWorkbook(){[Name=\"Table1\"]}[Content],\n    #\"Changed Type\" = Table.TransformColumnTypes(Source,{{\"date\", type date}, {\"symbol\", type text}, {\"close\", type number}}),\n    #\"Sorted Rows\" = Table.Sort(#\"Changed Type\",{{\"date\", Order.Ascending}}),\n    #\"Pivoted Column\" = Table.Pivot(#\"Sorted Rows\", List.Distinct(#\"Sorted Rows\"[symbol]), \"symbol\", \"close\", List.Sum),\n    #\"Reordered Columns\" = Table.ReorderColumns(#\"Pivoted Column\",{\"date\", \"ACA\", \"BA\", \"DIL\"})\nin\n    #\"Reordered Columns\"\n</code></pre>\n"}], "owner": {"reputation": 101, "user_id": 8981559, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh6.googleusercontent.com/-qyIre2-F9WU/AAAAAAAAAAI/AAAAAAAAACQ/-zJdEoWuv9s/photo.jpg?sz=128", "display_name": "toyo10", "link": "https://stackoverflow.com/users/8981559/toyo10"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 112, "favorite_count": 0, "accepted_answer_id": 50044202, "answer_count": 1, "score": -1, "last_activity_date": 1524749985, "creation_date": 1524658454, "last_edit_date": 1531161705, "question_id": 50022087, "link": "https://stackoverflow.com/questions/50022087/convert-time-series-format", "title": "Convert time series format", "body": "<p>I have a dataset (df) of time series as follow:</p>\n\n<pre><code>date          symbol   close\n09/01/2018    ACA      132.1\n10/01/2018    ACA      134.4\n...\n28/04/2013    BA       22.12\n...\n21/01/2016    DIL      180.01\n...\n</code></pre>\n\n<p>The idea was to convert it as this:</p>\n\n<pre><code>date          ACA      BA      DIL\n28/04/2013    NaN      22.12   NaN\n...\n21/01/2016    NaN      23      180.01\n...\n...\n...\n10/01/2018    134.4    32.2    181.3\n</code></pre>\n\n<p>So taking the longest period of time on first column, and match the close price on the others. I guess it can be done with <code>VLOOKUP()</code> or <code>MATCH()</code> somehow.</p>\n\n<p>Any idea?</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 407, "user_id": 2731076, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c897b26495c3b19cc1901a9e8ce05e81?s=128&d=identicon&r=PG&f=1", "display_name": "user2731076", "link": "https://stackoverflow.com/users/2731076/user2731076"}, "is_accepted": false, "score": 1, "last_activity_date": 1524658907, "last_edit_date": 1524658907, "creation_date": 1524658381, "answer_id": 50022058, "question_id": 50021846, "link": "https://stackoverflow.com/questions/50021846/using-cell-content-to-open-up-a-file/50022058#50022058", "title": "Using cell content to open up a file", "body": "<p>First, your title doesn't match the information you gave. Are these separate workbooks that you are trying to open or just worksheets in the same workbook? If it is the latter, see below. Otherwise you will need to edit the question you gave to make it more clear.</p>\n\n<p>I would guess that the two chr(34) functions are unnecessary since the value of cell F1 is probably a string anyway. Also, unless somewhere above you set F1 to equal Worksheet.Range(\"F1\"), that isn't how you would reference cell F1. A quick example is below, you will most likely need to edit it slightly to get it to actually work.</p>\n\n<pre><code>Dim F1 As Range\nDim ws as Worksheet\nDim InputRange As Range\n\nSet ws = ThisWorkbook.Worksheets(\"base worksheet name\")\nSet F1 = ws.Range(\"F1\")\n\nSet InputRange = ThisWorkbook.Worksheets(F1.Value).Range(\"A4:A418\")\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 9697230, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/83b4d09d3cdee4acfade9f5c90cad2e4?s=128&d=identicon&r=PG&f=1", "display_name": "Scotty", "link": "https://stackoverflow.com/users/9697230/scotty"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 14, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1524658907, "creation_date": 1524657782, "last_edit_date": 1531164843, "question_id": 50021846, "link": "https://stackoverflow.com/questions/50021846/using-cell-content-to-open-up-a-file", "title": "Using cell content to open up a file", "body": "<p>I am struggling with input range and filenames.  I have a number of worksheets  2014...2018. I extract the year from today's date and I want to use the year to then set <code>inputRange</code> which spreadsheet I want to extract data from.  I put the year in Cell F1 but I get error messages.  Can someone help me?</p>\n\n<p>Below is my code:</p>\n\n<pre><code>Set InputRange = Worksheets(Chr(34) &amp; F1.Value &amp; Chr(34)).Range(\"a4:a418\")\n</code></pre>\n"}, {"tags": ["ms-access", "vba", "ms-access-2010"], "comments": [{"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 1, "creation_date": 1524657042, "post_id": 50021556, "comment_id": 87058870, "body": "Please provide a reproducible example of how you achieved this, without sharing the entire database. Downloading access files is a security risk I&#39;d like to avoid whenever possible."}, {"owner": {"reputation": 348, "user_id": 8387711, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/179019171cbef8a9432fc762a8390305?s=128&d=identicon&r=PG&f=1", "display_name": "cookiemonster", "link": "https://stackoverflow.com/users/8387711/cookiemonster"}, "reply_to_user": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1524657545, "post_id": 50021556, "comment_id": 87059223, "body": "I updated it with the new information"}, {"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1524659008, "post_id": 50021556, "comment_id": 87060369, "body": "You&#39;re changing the order of columns in Combo2 in your VBA. This is likely the cause of your error. Also, you&#39;re requerying Combo0, not Combo2 in that code"}], "answers": [{"tags": [], "owner": {"reputation": 933, "user_id": 5345818, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f648ca9f16c3a02a085cf79fa59c282?s=128&d=identicon&r=PG", "display_name": "asdev", "link": "https://stackoverflow.com/users/5345818/asdev"}, "is_accepted": false, "score": 0, "last_activity_date": 1524664587, "last_edit_date": 1524664587, "creation_date": 1524659543, "answer_id": 50022476, "question_id": 50021556, "link": "https://stackoverflow.com/questions/50021556/dynamic-combo-box-issues-with-access-form/50022476#50022476", "title": "Dynamic combo box issues with access form", "body": "<p>Your ID System with fromID to TOID does not seem to make any sense to me. First of all the pair is always the same. What is the intended benefit of this?</p>\n\n<p>Alternative, just use the Text columns of <em>Base</em> and <em>To</em> instead and ajust properties of combo0:</p>\n\n<p>Row Source: SELECT DISTINCT base FROM tblconversions;</p>\n\n<p>Bound Column: 1</p>\n\n<p>And the After Update method</p>\n\n<pre><code>Private Sub Combo0_afterUpdate()\n    Dim stoSource As String\n\n    stoSource = \"SELECT DISTINCT tblconversions.To FROM tblconversions WHERE tblconversions.to = '\" &amp; Me.Combo0.Value &amp; \"'\"\n\n    Me.Combo2.RowSource = stoSource\n    Me.Combo2.Requery\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 348, "user_id": 8387711, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/179019171cbef8a9432fc762a8390305?s=128&d=identicon&r=PG&f=1", "display_name": "cookiemonster", "link": "https://stackoverflow.com/users/8387711/cookiemonster"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 312, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1524854352, "creation_date": 1524656884, "last_edit_date": 1524854352, "question_id": 50021556, "link": "https://stackoverflow.com/questions/50021556/dynamic-combo-box-issues-with-access-form", "title": "Dynamic combo box issues with access form", "body": "<p>I am working on this database in Access.</p>\n\n<p>Here is how the table is:\n<a href=\"https://i.stack.imgur.com/SJntH.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/SJntH.png\" alt=\"enter image description here\"></a></p>\n\n<p>in this table the conversion fromid and toid has to match that's why I have it structured like this. That is if I select MT, then I can only convert to another MT or ST. if I select ST in the base column then I can convert to another ST or MT.</p>\n\n<p>I created this form below. it has 2 combo box. the second combo box is limited based on the selection from the first combo box. That is If I select MT in the first combo, then the only options available in the second combo box is MT or ST. If I select KG then combo box 2 is limited to another KG or LB.</p>\n\n<p><a href=\"https://i.stack.imgur.com/a9n19.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/a9n19.png\" alt=\"enter image description here\"></a></p>\n\n<p>but the problem is that, If I select one from the combo box 1, the matching pairs are not showing. that is if I select MT it doesn't limit to MT or ST, but show two other values like L and GLL.</p>\n\n<p>I have attached a copy of the database.\n<a href=\"https://1drv.ms/u/s!AmHyJPlVM3nVg7x-6IB-q8gP0kKFHg\" rel=\"nofollow noreferrer\">Here is the link to the database I am testing with</a></p>\n\n<p>Below is the snapshots of the code for each:\n<a href=\"https://i.stack.imgur.com/3bwX6.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/3bwX6.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["excel", "vba", "copy-paste"], "answers": [{"comments": [{"owner": {"reputation": 407, "user_id": 2731076, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c897b26495c3b19cc1901a9e8ce05e81?s=128&d=identicon&r=PG&f=1", "display_name": "user2731076", "link": "https://stackoverflow.com/users/2731076/user2731076"}, "edited": false, "score": 0, "creation_date": 1540583143, "post_id": 53007909, "comment_id": 92934359, "body": "This solution didn&#39;t work for me. After pasting, the pictures were definitely bigger but not any better resolution. It also doesn&#39;t appear that you are doing this in VBA since I get an error if I add semicolons at the end of lines and the &quot;f&quot; after the number results in an error as well."}], "tags": [], "owner": {"reputation": 37, "user_id": 10362850, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64d39905c7cde748294d32891b718260?s=128&d=identicon&r=PG&f=1", "display_name": "Piotr Ryszard", "link": "https://stackoverflow.com/users/10362850/piotr-ryszard"}, "is_accepted": false, "score": -1, "last_activity_date": 1540553845, "creation_date": 1540553845, "answer_id": 53007909, "question_id": 50021388, "link": "https://stackoverflow.com/questions/50021388/shape-copypicture-fails-error-1004-when-format-xlbitmap/53007909#53007909", "title": "Shape.CopyPicture fails (Error 1004) when Format:=xlBitmap", "body": "<p>I was facing the same problem in my app. Here is the solution:</p>\n\n<ul>\n<li>If you want to copy an object of type MsoShapeType.msoChart or MsoShapeType.msoPicture do this trick:</li>\n</ul>\n\n<blockquote>\n<pre><code>shape.ScaleHeight(2.5f, MsoTriState.msoFalse);\nshape.ScaleWidth(2.5f, MsoTriState.msoFalse);\nshape.Copy();\nshape.CopyPicture(Excel.XlPictureAppearance.xlScreen, Excel.XlCopyPictureFormat.xlPicture);\nshape.ScaleHeight(0.4f, MsoTriState.msoFalse);\nshape.ScaleWidth(0.4f, MsoTriState.msoFalse);\n</code></pre>\n</blockquote>\n\n<p>where <code>shape</code> is of course your object.</p>\n\n<p>First, you need to scale up the object (scaling is loseless up to orginal size of the image or maximum size of the chart, which is just 400% zooming). Then, you use CopyPicture() method with mentioned parameters, preceed with Copy()*.The last thing to do is to scale down (or not, if you won't save this sheet) the object.</p>\n\n<p>*Copy() is used here to eliminate common and random error</p>\n\n<blockquote>\n  <p>System.Runtime.InteropServices.COMException (0x800A03EC): CopyPicture method of range class failed</p>\n</blockquote>\n\n<p>If you open any Excel sheet, you will see some copy configurations:\n<a href=\"https://i.stack.imgur.com/RH9le.png\" rel=\"nofollow noreferrer\">link, because I can't add images yet</a></p>\n\n<ul>\n<li>Common copy is just (xlScreen, xlBitmap);</li>\n<li>Good quality copy is xlScreen, xlPicture) and, depending on installed printer driver, (xlPrinter) and (xlPrinter, xlPicture);</li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 13342466, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/920e957891eb2e8de6e4fed3902c2278?s=128&d=identicon&r=PG", "display_name": "Greg", "link": "https://stackoverflow.com/users/13342466/greg"}, "is_accepted": false, "score": 0, "last_activity_date": 1587150249, "creation_date": 1587150249, "answer_id": 61278866, "question_id": 50021388, "link": "https://stackoverflow.com/questions/50021388/shape-copypicture-fails-error-1004-when-format-xlbitmap/61278866#61278866", "title": "Shape.CopyPicture fails (Error 1004) when Format:=xlBitmap", "body": "<p>shape.copypicture work's fine in excel 2016. The error is in office 360.</p>\n"}], "owner": {"reputation": 407, "user_id": 2731076, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c897b26495c3b19cc1901a9e8ce05e81?s=128&d=identicon&r=PG&f=1", "display_name": "user2731076", "link": "https://stackoverflow.com/users/2731076/user2731076"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 874, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1587150249, "creation_date": 1524656413, "last_edit_date": 1585185154, "question_id": 50021388, "link": "https://stackoverflow.com/questions/50021388/shape-copypicture-fails-error-1004-when-format-xlbitmap", "title": "Shape.CopyPicture fails (Error 1004) when Format:=xlBitmap", "body": "<p>I am attempting to copy a shape group which contains some charts as a high resolution picture. To achieve the high resolution, I use the options <code>Appearance:=xlPrinter</code> and <code>Format:=xlBitmap</code>. </p>\n\n<blockquote>\n  <p>Run-time error '1004' Application-defined or object-defined error</p>\n</blockquote>\n\n<p>The code I am using to do this is below</p>\n\n<pre><code>ws.Shapes.Range(Array(\"Chart 1\", \"Chart 2\")).Group.Name = \"temp_group\"\nWith ws.Shapes(\"temp_group\")\n    .CopyPicture Appearance:=xlPrinter, Format:=xlBitmap\n    .Ungroup\nEnd With\n</code></pre>\n\n<p>If I just remove the <code>Format:=xlBitmap</code> or change it to <code>Format:=xlPicture</code>, it works fine. The MSDN help shows <code>xlBitmap</code> as an option and I have tried just using 2 but that gives the same error.</p>\n\n<p>If I try the same thing on a single chart, it works just fine.</p>\n\n<pre><code>ws.ChartObjects(\"Chart 1\").Chart.CopyPicture Appearance:=xlPrinter, Format:=xlBitmap\n</code></pre>\n\n<p>What is the best way to copy multiple charts as a high resolution picture? I would like to avoid saving them because I need to copy/paste multiple groups of up to 30 charts for exporting to OneNote.</p>\n\n<p>Edit:</p>\n\n<p>After some additional testing, it turns out that I can use <code>xlBitmap</code> if the appearance option is set to <code>xlScreen</code> instead of <code>xlPrinter</code>. However, the resolution is still pretty terrible. This is very frustrating since just copy/pasting these same charts manually gives very nice clear pictures but for some reason VBA just ruins it. VBA is required though since this would be a very time consuming process otherwise.</p>\n"}, {"tags": ["sql", "excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 9743, "user_id": 2127508, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24b1d5bcb39ec4baad76d20c66506318?s=128&d=identicon&r=PG", "display_name": "barrowc", "link": "https://stackoverflow.com/users/2127508/barrowc"}, "is_accepted": false, "score": 0, "last_activity_date": 1524709059, "creation_date": 1524709059, "answer_id": 50033840, "question_id": 50021331, "link": "https://stackoverflow.com/questions/50021331/excel-vba-to-run-a-sql-command-getting-selected-data-from-a-csv-file/50033840#50033840", "title": "excel vba to run a sql command getting selected data from a CSV file", "body": "<p>There's a missing semi-colon. It should be:</p>\n\n<p><code>Public Const ConnStringCSV = \"Microsoft.Jet.OLEDB.4.0;\" &amp; _</code></p>\n"}], "owner": {"reputation": 9, "user_id": 9673418, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YV2P1.jpg?s=128&g=1", "display_name": "JohnD", "link": "https://stackoverflow.com/users/9673418/johnd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 313, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1559809283, "creation_date": 1524656279, "last_edit_date": 1559809283, "question_id": 50021331, "link": "https://stackoverflow.com/questions/50021331/excel-vba-to-run-a-sql-command-getting-selected-data-from-a-csv-file", "title": "excel vba to run a sql command getting selected data from a CSV file", "body": "<p>I am trying to run a sql command based on a selected org name from a drop down list , then import all the matching rows from a csv file that have the same org name , I can get it working with a ODBC connection , but it does not work when changing it to a CSV connection , any help would be much appreciated</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Public Const ConnStringCSV = \"Microsoft.Jet.OLEDB.4.0\" &amp; _\n\"Data Source=T:\\DataFeed;\" &amp; _\n\"Extended Properties=\"\"text;HDR=yes;FMT=Delimited(,)\"\";Persist Security Info=False\"\nim conn As New ADODB.Connection\nSub import_from_csv()\nDim conn As New ADODB.Connection\nDim connMasterConnection As New ADODB.Connection\nDim rsObj As New ADODB.Recordset\nDim Ws_FData As Worksheet\nDim Ws_UserForm As Worksheet\nDim strSQL As String\nDim org as String\nDim iCols As Integer\nDim varname1 As String\nDim ops As String\n\nSet Ws_Fdata = ActiveWorkbook.Worksheets(\"FData\")\n\n    'Delete the last results before we start the new run\nWs_FData.Cells.Clear\n\n    'The value of the organisation that the users chooses\norg = Sheet5.Range(\"A1\").Value\n\nconnMasterConnection.Open ConnStringCSV\n\n    'varname1 is the SQL Code I need to look for a match in org name from a \n    'search 'list I have , then add all the rows of data\n     'The CSV File is called OrgCheck.csv \n\nrsObj.Open varname1, connMasterConnection, adOpenForwardOnly, adLockReadOnly, adCmdText\nFor iCols = 0 To rsObj.Fields.Count - 1\nWs_FData.Cells(1, iCols + 1).Value = rsObj.Fields(iCols).Name\nNext \nWs_FData.Range(\"A2\").CopyFromRecordset rsObj\nconnMasterConnection.Close`enter code here`\n</code></pre>\n"}, {"tags": ["vba", "outlook", "attachment", "rule"], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 9459812, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-OAzHQSEq-GI/AAAAAAAAAAI/AAAAAAAAAVQ/cDpewjnhUek/photo.jpg?sz=128", "display_name": "Nguy\u1ec5n H\u1eefu B\u1ea3o Ki&#234;n", "link": "https://stackoverflow.com/users/9459812/nguy%e1%bb%85n-h%e1%bb%afu-b%e1%ba%a3o-ki%c3%aan"}, "edited": false, "score": 0, "creation_date": 1524714312, "post_id": 50021684, "comment_id": 87085111, "body": "This only works with downloaded attachments. I don&#39;t want to download them because  I have thousands of mails everyday and can&#39;t take the time to download them all and it would also be bad for my HDD."}], "tags": [], "owner": {"reputation": 83, "user_id": 8585970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/22f697fdac54ab148b296b5fb7e62ed5?s=128&d=identicon&r=PG&f=1", "display_name": "Oskar", "link": "https://stackoverflow.com/users/8585970/oskar"}, "is_accepted": false, "score": 0, "last_activity_date": 1524657253, "creation_date": 1524657253, "answer_id": 50021684, "question_id": 50021295, "link": "https://stackoverflow.com/questions/50021295/outlook-inbox-rule-to-get-attachments-filename-without-actually-downloading-the/50021684#50021684", "title": "Outlook inbox rule to get attachments&#39; filename without actually downloading the attachments", "body": "<p>How about something like:</p>\n\n<pre><code>Dim Item As Outlook.MailItem\nItem.Attachements(1).FileName\n</code></pre>\n\n<p><a href=\"https://msdn.microsoft.com/en-us/vba/outlook-vba/articles/attachment-filename-property-outlook\" rel=\"nofollow noreferrer\">https://msdn.microsoft.com/en-us/vba/outlook-vba/articles/attachment-filename-property-outlook</a></p>\n"}, {"comments": [{"owner": {"reputation": 21, "user_id": 9459812, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-OAzHQSEq-GI/AAAAAAAAAAI/AAAAAAAAAVQ/cDpewjnhUek/photo.jpg?sz=128", "display_name": "Nguy\u1ec5n H\u1eefu B\u1ea3o Ki&#234;n", "link": "https://stackoverflow.com/users/9459812/nguy%e1%bb%85n-h%e1%bb%afu-b%e1%ba%a3o-ki%c3%aan"}, "edited": false, "score": 0, "creation_date": 1524714096, "post_id": 50021855, "comment_id": 87085057, "body": "This seem to only work with read mail (mail attachment already downloaded). Is there anyway for it to work with all mail?"}, {"owner": {"reputation": 430, "user_id": 7742348, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/27qzC.png?s=128&g=1", "display_name": "LatifaShi", "link": "https://stackoverflow.com/users/7742348/latifashi"}, "reply_to_user": {"reputation": 21, "user_id": 9459812, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-OAzHQSEq-GI/AAAAAAAAAAI/AAAAAAAAAVQ/cDpewjnhUek/photo.jpg?sz=128", "display_name": "Nguy\u1ec5n H\u1eefu B\u1ea3o Ki&#234;n", "link": "https://stackoverflow.com/users/9459812/nguy%e1%bb%85n-h%e1%bb%afu-b%e1%ba%a3o-ki%c3%aan"}, "edited": false, "score": 0, "creation_date": 1524725397, "post_id": 50021855, "comment_id": 87089080, "body": "Are you sue ? .. for me it works with all mails, read and unread ones .."}, {"owner": {"reputation": 21, "user_id": 9459812, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-OAzHQSEq-GI/AAAAAAAAAAI/AAAAAAAAAVQ/cDpewjnhUek/photo.jpg?sz=128", "display_name": "Nguy\u1ec5n H\u1eefu B\u1ea3o Ki&#234;n", "link": "https://stackoverflow.com/users/9459812/nguy%e1%bb%85n-h%e1%bb%afu-b%e1%ba%a3o-ki%c3%aan"}, "edited": false, "score": 0, "creation_date": 1524752615, "post_id": 50021855, "comment_id": 87107107, "body": "I tried for my inbox and I was only able to get the name of read mail&#39;s attachment. For the unread mail&#39;s ones the attachment item count returned 0 and I could not get the name. BTW I&#39;m using Outlook 2010 and IMAP."}], "tags": [], "owner": {"reputation": 430, "user_id": 7742348, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/27qzC.png?s=128&g=1", "display_name": "LatifaShi", "link": "https://stackoverflow.com/users/7742348/latifashi"}, "is_accepted": false, "score": 0, "last_activity_date": 1524657810, "creation_date": 1524657810, "answer_id": 50021855, "question_id": 50021295, "link": "https://stackoverflow.com/questions/50021295/outlook-inbox-rule-to-get-attachments-filename-without-actually-downloading-the/50021855#50021855", "title": "Outlook inbox rule to get attachments&#39; filename without actually downloading the attachments", "body": "<p>Try The code below .. It helps you to go through your inbox folder and get every attachment filename .. </p>\n\n<pre><code>Sub test()\n    Dim a As Attachments\n    Dim myitem As Folder\n    Dim myItemI As Object\n    Dim j As Long\n    Dim i As Integer\n\n    ' Your Inbox folder\n    Set myitem = Session.GetDefaultFolder(olFolderInbox)\n\n    ' Loop through all mails in Inbox Folder\n    For i = 1 To myitem.Items.Count\n        'Get the mail number i\n        Set myItemI = myitem.Items(i)\n        'Get the attachments of the mail number i\n        Set a = myItemI.Attachments\n        ' if the mail contains attachments\n        If Not a Is Nothing Then\n            'Go through and display each attachment filename\n            For j = 1 To myItemI.Attachments.Count\n              MsgBox myItemI.Attachments.Item(j).DisplayName\n            Next j\n        End If\n    Next i\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 9459812, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-OAzHQSEq-GI/AAAAAAAAAAI/AAAAAAAAAVQ/cDpewjnhUek/photo.jpg?sz=128", "display_name": "Nguy\u1ec5n H\u1eefu B\u1ea3o Ki&#234;n", "link": "https://stackoverflow.com/users/9459812/nguy%e1%bb%85n-h%e1%bb%afu-b%e1%ba%a3o-ki%c3%aan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 260, "favorite_count": 0, "answer_count": 2, "score": -3, "last_activity_date": 1524657810, "creation_date": 1524656187, "last_edit_date": 1524657081, "question_id": 50021295, "link": "https://stackoverflow.com/questions/50021295/outlook-inbox-rule-to-get-attachments-filename-without-actually-downloading-the", "title": "Outlook inbox rule to get attachments&#39; filename without actually downloading the attachments", "body": "<p>I'm trying to set up an incoming rule to get the attachments' filename and write them to excel automatically without having to download the attachments itself. Is there anyway to do this with POP3 or IMAP in Outlook VBA?</p>\n"}, {"tags": ["html", "excel", "vba", "dom", "web-scraping"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1524657352, "post_id": 50021133, "comment_id": 87059085, "body": "Makes me wonder... Given the early binding, is Rubberduck able to load that type library? I recall having surprising issues (resulting in parser failures if not outright crashes) merely iterating the types and members in one of the XML or HTTP standard libraries, but I can&#39;t remember if it was <i>that</i> library."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1524658284, "post_id": 50021133, "comment_id": 87059794, "body": "@MathieuGuindon Thanks for responding. Which library are you referring to please? Colleague wonders if it is do to with hierarchical data as somehow an issue."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1524658438, "post_id": 50021133, "comment_id": 87059917, "body": "I&#39;m guessing it would be the HTML library. Whichever defines this <code>DispStaticNodeList</code> type ;-)"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1524658471, "post_id": 50021133, "comment_id": 87059951, "body": "Stupid me. Sorry. Gotcha."}, {"owner": {"reputation": 1404, "user_id": 643342, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/BAdMW.png?s=128&g=1", "display_name": "this", "link": "https://stackoverflow.com/users/643342/this"}, "edited": false, "score": 1, "creation_date": 1524661085, "post_id": 50021133, "comment_id": 87061992, "body": "This is not related to the question but an (unsolicited) advice -- always use two-part naming for your types. <code>Dim html As MSHTML.HTMLDocument</code> makes it much clearer where you are taking the types from and avoid ambiguity/uncertainty over which object you are taking from. Similarly, it <i>generally</i> is the case that using strong-typed variable may avoid certain bugs w/ dispatch calls. (there are also cases where you avoid other bugs by using dispatch but IME, earlybinding is less likely to have bugs than latebinding)"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 1404, "user_id": 643342, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/BAdMW.png?s=128&g=1", "display_name": "this", "link": "https://stackoverflow.com/users/643342/this"}, "edited": false, "score": 0, "creation_date": 1524661161, "post_id": 50021133, "comment_id": 87062046, "body": "@this Thank you. I have got lazy it seems :-( Does putting Dim html As MSHTML.HTMLDocument make it strongly typed?"}, {"owner": {"reputation": 1404, "user_id": 643342, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/BAdMW.png?s=128&g=1", "display_name": "this", "link": "https://stackoverflow.com/users/643342/this"}, "edited": false, "score": 0, "creation_date": 1524661409, "post_id": 50021133, "comment_id": 87062224, "body": "No more so than just <code>Dim html As HTMLDocument</code>. The primary benefit is the clarity of the code and disambiguation. The strong typing issue is specific to the <code>a</code> and <code>b</code> variables which were declared as just <code>Object</code>, rather than the actual data type they ought to be."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1524661536, "post_id": 50021133, "comment_id": 87062333, "body": "Ah... so yes was my laziness. I declare as object normally first time round as I don&#39;t always know what object to expect back.  I know.... lot to learn.....Then I switch to the appropriate type after inspecting in the locals or TypeName call. I will endeavour to be more mindful of this in future."}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 1, "creation_date": 1526280440, "post_id": 50021133, "comment_id": 87664580, "body": "@QHarr - Donald indeed has many friends, at least 96 that <a href=\"https://en.wikipedia.org/wiki/List_of_Donald_Duck_universe_characters\" rel=\"nofollow noreferrer\">we know of</a>, however I believe you&#39;re closest to Donald&#39;s Italian residence of Quack Town (<a href=\"https://en.wikipedia.org/wiki/Donald_Duck#Italy\" rel=\"nofollow noreferrer\">source</a>) although he does claim dual citizenship at Duckberg, Calisota, USA. (<a href=\"https://upload.wikimedia.org/wikipedia/commons/thumb/d/d7/Map_of_Duckburg.svg/612px-Map_of_Duckburg.svg.png\" rel=\"nofollow noreferrer\">map</a>).  Oh sorry - maybe that wasn&#39;t the <b>primary</b> topic of your question?"}], "answers": [{"comments": [{"owner": {"reputation": 1404, "user_id": 643342, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/BAdMW.png?s=128&g=1", "display_name": "this", "link": "https://stackoverflow.com/users/643342/this"}, "edited": false, "score": 2, "creation_date": 1524660925, "post_id": 50022047, "comment_id": 87061858, "body": "I&#39;d add that I know from experience that <code>MSHTML</code> is sort of dodgy in its implementation - it&#39;s made more for JS than for VBA in a manner of speaking."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1524662173, "post_id": 50022047, "comment_id": 87062801, "body": "There was also this article by mr meaden <a href=\"http://exceldevelopmentplatform.blogspot.co.uk/2018/01/vba-webscraping-jquery-selectors.html\" rel=\"nofollow noreferrer\">exceldevelopmentplatform.blogspot.co.uk/2018/01/&hellip;</a>"}], "tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": true, "score": 2, "last_activity_date": 1524658358, "creation_date": 1524658358, "answer_id": 50022047, "question_id": 50021133, "link": "https://stackoverflow.com/questions/50021133/excel-crashes-when-attempting-to-inspect-dispstaticnodelist/50022047#50022047", "title": "Excel crashes when attempting to inspect DispStaticNodeList", "body": "<blockquote>\n  <p>If the name is DispStaticNodeList, we can be pretty sure it's an array..(or at least <strong>has array semantics</strong>).</p>\n</blockquote>\n\n<p>Arrays <em>can</em> normally be iterated with a <code>For Each</code> loop, however <a href=\"https://analystcave.com/vba-for-loop-vs-for-each-loop/\" rel=\"nofollow noreferrer\">it's more efficient</a> to iterate them using a <code>For</code> loop. Looks like what you're getting isn't <em>exactly</em> an array, and while it appears to support indexing, it apparently doesn't support <em>enumeration</em>, which would explain the blowing up when you attempt to <em>enumerate</em> it with a <code>For Each</code> loop.</p>\n\n<p>Looks like the <em>locals</em> toolwindow might be using <code>For Each</code> semantics to list the items in the collection.</p>\n\n<p>I'm not familiar with that particular library so this is a bit of (educated) guesswork, but it's pretty easy to make a custom COM collection type that can't be iterated with a <code>For Each</code> loop in VBA - normally the error is caught on the VBA side though... Seems there might be a bug in the library's enumerator implementation (assuming there's an enumerator for it) causing it to throw an exception that ends up unhandled and somehow takes everything down with it... thing is, you can't fix &amp; recompile that library... so the only thing you can do is to avoid iterating that type with a <code>For Each</code> loop, and avoid expanding it in the <em>locals</em> toolwindow (and so, ...save your work often!).</p>\n\n<p><a href=\"https://www.google.ca/amp/s/limbioliong.wordpress.com/2011/10/28/exposing-an-enumerator-from-managed-code-to-com/amp/\" rel=\"nofollow noreferrer\">This article</a> gives a good idea from a C#/.NET perspective, of how COM enumeration works. Of course that library isn't managed code (.NET), but the COM concepts at play are the same.</p>\n\n<p>TL;DR: it's not because you can <code>For...Next</code> that you can <code>For Each</code>; the COM type involved must explicitly support enumeration. If the VBA code compiles with a <code>For Each</code> loop, then it does, so it must be a bug in the type's enumerator.</p>\n"}], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 349, "favorite_count": 0, "accepted_answer_id": 50022047, "answer_count": 1, "score": 5, "last_activity_date": 1593589998, "creation_date": 1524655683, "last_edit_date": 1593589998, "question_id": 50021133, "link": "https://stackoverflow.com/questions/50021133/excel-crashes-when-attempting-to-inspect-dispstaticnodelist", "title": "Excel crashes when attempting to inspect DispStaticNodeList", "body": "<p><strong>Situation:</strong> </p>\n\n<p>I am attempting to inspect a variable <code>a</code>, showing as a <code>DispStaticNodeList</code> object in the locals window; Excel crashes every time I try to do this.</p>\n\n<p>Here is the variable <code>a</code>, apparently of type <code>DispStaticNodeList</code>, in the locals window:</p>\n\n<p><a href=\"https://i.stack.imgur.com/XMWiV.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/XMWiV.png\" alt=\"Locals window\"></a></p>\n\n<p><strong>Reproducing the Excel crash:</strong></p>\n\n<ol>\n<li>Attempting to expand the item in the Locals Window causes Excel to crash.</li>\n<li>Attempting to loop over it with a <code>For Each</code> also causes a crash.*<sup>TestFail</sup></li>\n</ol>\n\n<p><strong>Research highlights:</strong></p>\n\n<ol>\n<li>I did some digging around, searching for combinations such as <code>Excel</code> + <code>Crash</code> + <code>DispStaticNodeList</code> yielded zero results; At least with the Google search terms I used. Pretty sure my Google-Fu was weak.</li>\n<li><p>If I believe this <a href=\"http://sourcebrowser.io/Browse/NetOfficeFw/NetOffice/Source/MSHTML/DispatchInterfaces/DispStaticNodeList.cs\" rel=\"nofollow noreferrer\">article</a> I am dealing with a COM object that is supported by <code>MSHTML</code>. </p></li>\n<li><p>And according to <a href=\"https://chromium.googlesource.com/external/selenium/+/115a1b94afadec18ba97d4f5feaecfee64ee590f/cpp/IEDriver/ScriptWrapper.cpp\" rel=\"nofollow noreferrer\">this</a>:</p></li>\n</ol>\n\n<blockquote>\n  <p>If the name is DispStaticNodeList, we can be pretty sure it's an\n  array..(or at least has array semantics).</p>\n</blockquote>\n\n<p>Based on point 3 I wrote the code, <code>TestPass</code>, below, which does loop over it successfully, but I don't fully understand why. I have set an object and then looped its len!</p>\n\n<ol start=\"4\">\n<li>I  have just found <a href=\"https://developer.mozilla.org/en-US/docs/Web/API/NodeList\" rel=\"nofollow noreferrer\">this</a> which states:</li>\n</ol>\n\n<blockquote>\n  <p>NodeList objects are collections of nodes such as those returned by\n  properties such as Node.childNodes and the document.querySelectorAll()\n  method.</p>\n</blockquote>\n\n<p>So it seems the object may be a <code>NodeList</code>, which given the description in the immediate window seems about right, and as a list I can loop over its length, but not sure why <code>For Each</code> won't work and why Excel crashes. Colleague suggests it may crash due to hierarchical nature of data. I further note that there are classes called <code>IDOMNodeIterator</code> and <code>NodeIterator</code>, but I am not sure if I can use those in line with the descriptions for <code>NodeList</code> methods <a href=\"https://developer.mozilla.org/en-US/docs/Web/API/NodeList\" rel=\"nofollow noreferrer\">here</a>.</p>\n\n<p><strong>Question:</strong></p>\n\n<p>What is <code>a</code> and why does it cause Excel to crash when attempting to inspect or loop with a <code>For Each</code>?</p>\n\n<p><strong>Code that loops successfully:</strong></p>\n\n<pre><code>Option Explicit\n\nPublic Sub TestPass()\n    Dim html As HTMLDocument\n    Set html = GetTestHTML\n    Dim a As Object, b As Object\n\n    Set a = html.querySelectorAll(\"div.intro p\")\n\n    Dim i As Long\n\n    For i = 0 To Len(a) -1\n        On Error Resume Next\n        Debug.Print a(i).innerText    '&lt;== HTMLParaElement\n        On Error GoTo 0\n    Next i\nEnd Sub\n\nPublic Function GetTestHTML(Optional ByVal url As String = \"https://www.w3schools.com/cssref/trysel.asp\") As HTMLDocument\n    Dim http As New XMLHTTP60\n    Dim html As New HTMLDocument\n    With http                                    'Set http = CreateObject(\"MSXML2.XMLHttp60\")\n        .Open \"GET\", url, False\n        .send\n        html.body.innerHTML = .responseText\n        Set GetTestHTML = html\n    End With\nEnd Function\n</code></pre>\n\n<p><strong>*TestFail\nCode that causes crash:</strong></p>\n\n<pre><code>Public Sub TestFail()\n    Dim html As HTMLDocument\n    Set html = GetTestHTML\n    Dim a As Object, b As Object\n\n    Set a = html.querySelectorAll(\"div.intro p\")\n\n    For Each b In a\n\n    Next b\nEnd Sub\n</code></pre>\n\n<p><strong>Notes:</strong>  </p>\n\n<p>I sent a test workbook to a colleague who was also able to reproduce this behaviour with the example given.</p>\n\n<p><strong>Project References:</strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/xi0d4.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/xi0d4.png\" alt=\"Project references\"></a></p>\n\n<p><strong>Sample of HTML (link was also provided)</strong></p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>&lt;div class=\"noSel\"&gt;\r\n&lt;h1 style=\"\"&gt;&lt;span class=\"markup\"&gt;&amp;lt;h1&amp;gt;&lt;/span&gt;Welcome to My Homepage&lt;span class=\"markup\"&gt;&amp;lt;/h1&amp;gt;&lt;/span&gt;&lt;/h1&gt;\r\n\r\n&lt;div id=\"helpIntro\" style=\"\"&gt;\r\n&lt;span class=\"markup\"&gt;&amp;lt;div class=\"intro\"&amp;gt;&lt;/span&gt;\r\n&lt;div class=\"intro\"&gt;\r\n&lt;p style=\"margin-top: 4px; border-color: rgb(255, 102, 102); background-color: rgb(255, 255, 153);\"&gt;&lt;span class=\"markup\"&gt;&amp;lt;p&amp;gt;&lt;/span&gt;My name is Donald &lt;span id=\"Lastname\" style=\"\"&gt;&lt;span class=\"markup\"&gt;&amp;lt;span id=\"Lastname\"&amp;gt;&lt;/span&gt;Duck.&lt;span class=\"markup\"&gt;&amp;lt;/span&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=\"markup\"&gt;&amp;lt;/p&amp;gt;&lt;/span&gt;&lt;/p&gt;\r\n&lt;p id=\"my-Address\" style=\"border-color: rgb(255, 102, 102); background-color: rgb(255, 255, 153);\"&gt;&lt;span class=\"markup\"&gt;&amp;lt;p id=\"my-Address\"&amp;gt;&lt;/span&gt;I live in Duckburg&lt;span class=\"markup\"&gt;&amp;lt;/p&amp;gt;&lt;/span&gt;&lt;/p&gt;\r\n&lt;p style=\"margin-bottom: 4px; border-color: rgb(255, 102, 102); background-color: rgb(255, 255, 153);\"&gt;&lt;span class=\"markup\"&gt;&amp;lt;p&amp;gt;&lt;/span&gt;I have many friends:&lt;span class=\"markup\"&gt;&amp;lt;/p&amp;gt;&lt;/span&gt;&lt;/p&gt;\r\n&lt;/div&gt;\r\n&lt;span class=\"markup\"&gt;&amp;lt;/div&amp;gt;&lt;/span&gt;\r\n&lt;/div&gt;\r\n\r\n&lt;br&gt;\r\n&lt;div class=\"helpUl\"&gt;\r\n&lt;span class=\"markup\"&gt;&amp;lt;ul id=\"Listfriends&amp;gt;&lt;/span&gt;\r\n&lt;ul id=\"Listfriends\" style=\"margin-top:0px;margin-bottom:0px;\"&gt;\r\n\r\n&lt;li&gt;&lt;span class=\"markup\"&gt;&amp;lt;li&amp;gt;&lt;/span&gt;Goofy&lt;span class=\"markup\"&gt;&amp;lt;/li&amp;gt;&lt;/span&gt;&lt;/li&gt;\r\n&lt;li&gt;&lt;span class=\"markup\"&gt;&amp;lt;li&amp;gt;&lt;/span&gt;Mickey&lt;span class=\"markup\"&gt;&amp;lt;/li&amp;gt;&lt;/span&gt;&lt;/li&gt;\r\n&lt;li&gt;&lt;span class=\"markup\"&gt;&amp;lt;li&amp;gt;&lt;/span&gt;Daisy&lt;span class=\"markup\"&gt;&amp;lt;/li&amp;gt;&lt;/span&gt;&lt;/li&gt;\r\n&lt;li&gt;&lt;span class=\"markup\"&gt;&amp;lt;li&amp;gt;&lt;/span&gt;Pluto&lt;span class=\"markup\"&gt;&amp;lt;/li&amp;gt;&lt;/span&gt;&lt;/li&gt;\r\n&lt;/ul&gt;       \r\n&lt;span class=\"markup\"&gt;&amp;lt;/ul&amp;gt;&lt;/span&gt;\r\n&lt;/div&gt;\r\n\r\n&lt;ul style=\"display:none;\"&gt;&lt;/ul&gt;\r\n&lt;p style=\"\"&gt;&lt;span class=\"markup\"&gt;&amp;lt;p&amp;gt;&lt;/span&gt;All my friends are great!&lt;span class=\"markup\"&gt;&amp;lt;br&amp;gt;&lt;/span&gt;&lt;br&gt;But I really like Daisy!!&lt;span class=\"markup\"&gt;&amp;lt;/p&amp;gt;&lt;/span&gt;&lt;/p&gt;\r\n\r\n&lt;p lang=\"it\" title=\"Hello beautiful\" style=\"\"&gt;&lt;span class=\"markup\"&gt;&amp;lt;p lang=\"it\" title=\"Hello beautiful\"&amp;gt;&lt;/span&gt;Ciao bella&lt;span class=\"markup\"&gt;&amp;lt;/p&amp;gt;&lt;/span&gt;&lt;/p&gt;</code></pre>\r\n</div>\r\n</div>\r\n</p>\n\n<p>Edit: I have also been able to loop in the following fashion:</p>\n\n<pre><code>Public Sub Test()\n    Dim html As MSHTML.HTMLDocument, i As Long\n    Set html = GetTestHTML\n\n    For i = 0 To html.querySelectorAll(\"div.intro p\").Length - 1\n       Debug.Print html.querySelectorAll(\"div.intro p\")(i).innerText\n    Next i\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "loops", "offset"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1524663206, "post_id": 50020710, "comment_id": 87063467, "body": "Not sure I fully understand. What is this line doing <code>output.Offset(0, j) = output</code> ? Have you stepped through the code to see what&#39;s going on?"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1524663403, "post_id": 50020710, "comment_id": 87063587, "body": "I can&#39;t tell if it&#39;s the issue but in your code <code>firstcell</code> is always J6 - is this right?"}, {"owner": {"reputation": 3, "user_id": 7636591, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dc58e5d0a7c7bae5e9ad647ee5c761c1?s=128&d=identicon&r=PG&f=1", "display_name": "the_ant", "link": "https://stackoverflow.com/users/7636591/the-ant"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1524666141, "post_id": 50020710, "comment_id": 87065423, "body": "so the idea with the &#39;output.Offset(0, j) = output&#39;  lines is to shift all the ranges to the next set of columns. so using the initial ranges extracts all the values based on the first search term (&#39;survey&#39;). Once the first run of the nested loop is finished, all the ranges, including &#39;firstcell&#39; is offset three columns to the right (the &#39;j&#39; loop) and the process begins again - does that make it clearer?"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1524666247, "post_id": 50020710, "comment_id": 87065488, "body": "<code>output.Offset(0, j) = output</code> is assigning the value only of the latter to the former. If you want to move the range reference itself you need to use Set (as you have above) so it would be <code>Set output=output.Offset(0, j)</code>."}, {"owner": {"reputation": 3, "user_id": 7636591, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dc58e5d0a7c7bae5e9ad647ee5c761c1?s=128&d=identicon&r=PG&f=1", "display_name": "the_ant", "link": "https://stackoverflow.com/users/7636591/the-ant"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1524666613, "post_id": 50020710, "comment_id": 87065795, "body": "OK, thanks - I think this is similar solution to the answer below? As in setting an initial range and a then a variant that is used in the loop?"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1524667529, "post_id": 50020710, "comment_id": 87066432, "body": "Yes I believe so having looked closer."}], "answers": [{"comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1524665646, "post_id": 50023872, "comment_id": 87065091, "body": "Would be helpful if you could explain what you&#39;ve changed, and why."}, {"owner": {"reputation": 3, "user_id": 7636591, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dc58e5d0a7c7bae5e9ad647ee5c761c1?s=128&d=identicon&r=PG&f=1", "display_name": "the_ant", "link": "https://stackoverflow.com/users/7636591/the-ant"}, "edited": false, "score": 0, "creation_date": 1524666467, "post_id": 50023872, "comment_id": 87065666, "body": "thanks @horst, that looks to have worked. if I understand it correctly, you took the initial ranges and created analogous variants that are then used in loops?"}], "tags": [], "owner": {"reputation": 752, "user_id": 9538700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bf60807a4c8210fb503d2f875a3299cd?s=128&d=identicon&r=PG", "display_name": "horst", "link": "https://stackoverflow.com/users/9538700/horst"}, "is_accepted": true, "score": 0, "last_activity_date": 1524663644, "creation_date": 1524663644, "answer_id": 50023872, "question_id": 50020710, "link": "https://stackoverflow.com/questions/50020710/vba-offset-within-loop/50023872#50023872", "title": "VBA offset within loop", "body": "<p>I modified your code a bit. Should do what you want now.</p>\n\n<pre><code>Sub indicator_charts()\n\nDim indicators As Range\nDim survey As String\nDim surveyrng As Range\nDim output As Range\nDim survey2 As String\nDim firstcell As Range\nDim OutputVar As Variant\nDim SurveyRngVar As Variant\nDim FirstCellVar As Variant\n\nSet indicators = Worksheets(\"Indicator Summary\").Range(\"C6:C50\")\nSet output = Worksheets(\"Indicator Summary\").Range(\"j5:j50\")\nSet surveyrng = Worksheets(\"Indicator Summary\").Range(\"J5\")\nSet firstcell = Worksheets(\"Indicator Summary\").Range(\"J6\")\n\nFor j = 0 To 36 Step 3\nSet OutputVar = output.Offset(0, j)\nSet SurveyRngVar = surveyrng.Offset(0, j)\nSet FirstCellVar = firstcell.Offset(0, j)\nsurvey = SurveyRngVar.Value\n\n    For i = 1 To 46\n        If InStr(1, indicators(i, 1).Value, survey) Then\n        survey2 = indicators(i, 1).Value\n            If IsEmpty(FirstCellVar) Then\n            FirstCellVar.Value = survey2\n            Else\n            OutputVar.End(xlDown).Offset(1, 0).Value = survey2\n            End If\n        End If\n    Next i\n\nNext j\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 7636591, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dc58e5d0a7c7bae5e9ad647ee5c761c1?s=128&d=identicon&r=PG&f=1", "display_name": "the_ant", "link": "https://stackoverflow.com/users/7636591/the-ant"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6113, "favorite_count": 0, "accepted_answer_id": 50023872, "answer_count": 1, "score": 0, "last_activity_date": 1524663644, "creation_date": 1524654384, "question_id": 50020710, "link": "https://stackoverflow.com/questions/50020710/vba-offset-within-loop", "title": "VBA offset within loop", "body": "<p>I'm having issues combining the VBA offset function within a loop. Essentially I am trying to extract multiple sets of values from a column of data based on a search term (<code>survey</code> value). I can get this to work for a single term, but I was hoping to create a macro that would extract all the values for all terms at once.</p>\n\n<p>The set up of the data is a column (c6:c50) of raw data (<code>indicators</code>), and then 13 columns (j6:j50, m6:m50 etc) (<code>output</code>) where the extracted values should appear. columns K and L (and so on between the initial 13 columns) contain formulas based on the values of column J. the search term for each of the 13 columns is in the cell directly above the range (J5, M5 etc.).</p>\n\n<p>The code below is where I have got to. The aim was to have a loop that extracts the values from column C into column J (the 'i'-based loop) and then a second loop ('j'-based loop) that offsets across the columns.</p>\n\n<p>What happens when this is run is that the firstcell value in cell J6 fills, followed by the correct value in J7. Then all subsequent extracted values overwrite what was in J7. Once the loop for the first term is complete, it offsets by 3 columns, extracts the same value in J6 to M6 (presumably because the search term  'survey' is not offsetting?) but then goes back to overwriting cell J7.</p>\n\n<p>Any help would be greatly appreciated.</p>\n\n<pre><code>Sub indicator_charts()\n\nDim indicators As Range\nDim survey As String\nDim surveyrng As Range\nDim output As Range\nDim survey2 As String\nDim firstcell As Range\n\nSet indicators = Worksheets(\"Indicator Summary\").Range(\"C6:C50\")\nSet output = Worksheets(\"Indicator Summary\").Range(\"j5:j50\")\nSet surveyrng = Worksheets(\"Indicator Summary\").Range(\"J5\")\nSet firstcell = Worksheets(\"Indicator Summary\").Range(\"J6\")\n\nsurvey = surveyrng.Value\n\nFor j = 0 To 36 Step 3\noutput.Offset(0, j) = output\nsurveyrng.Offset(0, j) = surveyrng\nfirstcell.Offset(0, j) = firstcell\n    For i = 1 To 46\n        If InStr(1, indicators.Cells(i, 1).Value, survey) Then\n        survey2 = indicators.Cells(i, 1).Value\n            If IsEmpty(firstcell) Then\n            firstcell.Value = survey2\n            Else\n            output.End(xlDown).Offset(1, 0).Value = survey2\n            End If\n        End If\n    Next i\nNext j\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1524655574, "post_id": 50020681, "comment_id": 87057835, "body": "If you want to compare columns other than <code>A</code>, can you provide what your comparison criteria is? and a sample of your worksheets"}, {"owner": {"reputation": 1, "user_id": 9696867, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adedb6f19d4d4106b909a3a4a206f828?s=128&d=identicon&r=PG&f=1", "display_name": "af1nn", "link": "https://stackoverflow.com/users/9696867/af1nn"}, "reply_to_user": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1524656366, "post_id": 50020681, "comment_id": 87058421, "body": "Zac, thank you for the response. The criteria would be to match a floating point number in column &#39;E&#39; and a mixture of numerals and text in  column &#39;D&#39;, and only text in column &#39;C&#39;. I am not sure the other cloumns will be an exact match so those three should be enough. I&#39;m also unable to post any of the data here, apologies as I know that would make things easier."}], "owner": {"reputation": 1, "user_id": 9696867, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adedb6f19d4d4106b909a3a4a206f828?s=128&d=identicon&r=PG&f=1", "display_name": "af1nn", "link": "https://stackoverflow.com/users/9696867/af1nn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 28, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1524658805, "creation_date": 1524654323, "last_edit_date": 1524658805, "question_id": 50020681, "link": "https://stackoverflow.com/questions/50020681/looking-for-matching-data-in-two-workbooks-of-excel-and-format-the-matching-res", "title": "Looking for matching data in two workbooks of Excel, and format the matching results over a large data set", "body": "<p>I am working on a problem in Excel, in which I have to compare data in two separate workbooks, and look for matching pieces of information over several columns - as the time stamp in row A isn't an exact match in both workbooks I need to rely on the data points from the other columns out to column G - and format the rows in which a match is found in a certain colour.</p>\n\n<p>I could do this manually, but due to the amount of rows numbering into 5 figures, I think VBA seems the best way to do this. Having only basic programming knowledge, I am struggling to see the correct way to do this with VBA. </p>\n\n<p>Here is what I have tried so far, and I will also include the error shown when I run the code. </p>\n\n<p>I am aware I said that more than row A is needed to make the comparison, but I am not sure on how to apply the rules to a matrix over columns and rows. </p>\n\n<pre><code>Sub vbax_53997_Compare_Two_Ranges()\n    Dim i As Long\n    Dim wb1ws1, wb2ws2\n    Dim blnSame As Boolean\n\n    wb1ws1 = Workbooks(\"Copy_of_data.xlsm\").Worksheets(\"Worksheet\").Range(\"A1:A63\").Value\n    wb2ws2 = Workbooks(\"Copy_of_data_to_be_compared.xlsm\").Worksheets(\"Archive\").Range(\"A1:A23067\").Value\n\n    For i = LBound(wb1ws1) To UBound(wb1ws1)\n        If wb1ws1(i, 1) = wb2ws2(i, 1) Then\n            blnSame = True\n        End If\n    Next i\n\n    If blnSame = True Then\n        Sheets(sheetName).Cells(lRow, \"A\").Interior.ColorIndex = 3  'Set Color to Red'\n    End If\nEnd Sub\n</code></pre>\n\n<p>This is the error when I run the code; </p>\n\n<blockquote>\n  <p>Run-time error '9': Subscript out of range.</p>\n</blockquote>\n\n<p>I have no doubt its an easy fix and I could maybe do a nested vlookup/if statement, but taking longer in the short term to find a solution will probably be a benefit to automate the process in the long term. </p>\n\n<p>Any help would be much appreciated as I have now run out of ideas.</p>\n"}, {"tags": ["vba", "excel", "count-unique"], "comments": [{"owner": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "edited": false, "score": 0, "creation_date": 1524651492, "post_id": 50019635, "comment_id": 87055337, "body": "What would be the output you want to get? I mean, You explained your problem and also you posted some data as example. What would be the correct answer with the data you posted?"}, {"owner": {"reputation": 1, "user_id": 8836389, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4302276f099330e6b699c075e069a3f6?s=128&d=identicon&r=PG&f=1", "display_name": "David Morocutti", "link": "https://stackoverflow.com/users/8836389/david-morocutti"}, "reply_to_user": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "edited": false, "score": 0, "creation_date": 1524651836, "post_id": 50019635, "comment_id": 87055555, "body": "Hey I edited my post. i hope it helps to understand it a little bit more"}, {"owner": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "edited": false, "score": 0, "creation_date": 1524651949, "post_id": 50019635, "comment_id": 87055635, "body": "Are you sure <code>SS_ID 1    =    2</code>? should not it be <code>SS_ID 1    =    3</code>? I ask these because <code>SS_ID 1</code> is related to <code>T1</code> and <code>T2</code> (twice) and <code>T3</code>. Am I right?"}, {"owner": {"reputation": 1118, "user_id": 8282232, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/775ef4ecf830083680ae6dbae8da395c?s=128&d=identicon&r=PG&f=1", "display_name": "AntiDrondert", "link": "https://stackoverflow.com/users/8282232/antidrondert"}, "edited": false, "score": 0, "creation_date": 1524651959, "post_id": 50019635, "comment_id": 87055643, "body": "@DavidMorocutti Would not it be <code>SS_ID 1 = 3</code> then? Since it has <code>T1</code>, <code>T2</code>, <code>T3</code>."}, {"owner": {"reputation": 1, "user_id": 8836389, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4302276f099330e6b699c075e069a3f6?s=128&d=identicon&r=PG&f=1", "display_name": "David Morocutti", "link": "https://stackoverflow.com/users/8836389/david-morocutti"}, "edited": false, "score": 0, "creation_date": 1524652015, "post_id": 50019635, "comment_id": 87055680, "body": "Yes sorry so stupid of me......"}], "answers": [{"tags": [], "owner": {"reputation": 113, "user_id": 7199477, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a3d1a0d8b1079b20d4f5f022b56ad8d?s=128&d=identicon&r=PG&f=1", "display_name": "robotu", "link": "https://stackoverflow.com/users/7199477/robotu"}, "is_accepted": false, "score": 0, "last_activity_date": 1524652482, "last_edit_date": 1524652482, "creation_date": 1524652341, "answer_id": 50020007, "question_id": 50019635, "link": "https://stackoverflow.com/questions/50019635/vba-count-the-number-of-unique-values/50020007#50020007", "title": "VBA count the number of unique values", "body": "<p><a href=\"https://i.stack.imgur.com/iFu8O.png\" rel=\"nofollow noreferrer\">Solution without VBA</a></p>\n\n<p>You can use something like that:\n=SUMIFS(C1:C6;A1:A6;\"=SS_ID 4\")</p>\n\n<p>The excel funtion \"SOMMA.PIU.SE\" in the attached image is \"SUMIFS\" in english.\nThe SUMIFS function adds all of its arguments (A1:A6) that meet multiple criteria (A1:A6 => \"=SS_ID 4\").</p>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 8836389, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4302276f099330e6b699c075e069a3f6?s=128&d=identicon&r=PG&f=1", "display_name": "David Morocutti", "link": "https://stackoverflow.com/users/8836389/david-morocutti"}, "edited": false, "score": 0, "creation_date": 1524658273, "post_id": 50020311, "comment_id": 87059788, "body": "Thank you very much i will try to implement it into my macro :)"}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 1, "last_activity_date": 1524653193, "creation_date": 1524653193, "answer_id": 50020311, "question_id": 50019635, "link": "https://stackoverflow.com/questions/50019635/vba-count-the-number-of-unique-values/50020311#50020311", "title": "VBA count the number of unique values", "body": "<p>Here is a macro-based solution:</p>\n\n<pre><code>Sub UniqueTable()\n    Dim i As Long, N As Long, c As Collection, M As Long\n    Dim j As Long, vd As String, va As String\n\n    Columns(\"A:A\").Copy Range(\"D1\")\n\n    ActiveSheet.Range(\"D:D\").RemoveDuplicates Columns:=1, Header:=xlYes\n\n    Range(\"E1\").Value = \"# of unique values\"\n\n    N = Cells(Rows.Count, \"D\").End(xlUp).Row\n    M = Cells(Rows.Count, \"B\").End(xlUp).Row\n\n    For i = 2 To N\n        Set c = Nothing\n        Set c = New Collection\n        vd = Cells(i, \"D\").Value\n        For j = 2 To M\n            va = Cells(j, \"A\").Value\n            If va = vd Then\n                On Error Resume Next\n                    c.Add Cells(j, \"B\").Value, CStr(Cells(j, \"B\").Value)\n                On Error GoTo 0\n            End If\n        Next j\n        Cells(i, \"E\").Value = c.Count\n    Next i\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/EWo0Q.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/EWo0Q.png\" alt=\"enter image description here\"></a></p>\n\n<p>You can easily modify the code to place the little results table anywhere you like.  If you add/remove/modify items in cols <strong>A</strong> and <strong>B</strong>, just rerun the code.</p>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 3, "last_activity_date": 1524653881, "creation_date": 1524653881, "answer_id": 50020549, "question_id": 50019635, "link": "https://stackoverflow.com/questions/50019635/vba-count-the-number-of-unique-values/50020549#50020549", "title": "VBA count the number of unique values", "body": "<p>No need for <a href=\"/questions/tagged/vba\" class=\"post-tag\" title=\"show questions tagged &#39;vba&#39;\" rel=\"tag\">vba</a> unless you absolutely require it.</p>\n\n<pre><code>=SUMPRODUCT((A$2:INDEX(A:A, MATCH(\"Z\", A:A))=D2)/(COUNTIFS(B$2:INDEX(B:B, MATCH(\"ZZZ\", A:A)), B$2:INDEX(B:B, MATCH(\"ZZZ\", A:A)),  A$2:INDEX(A:A, MATCH(\"Z\", A:A)), D2)+(A$2:INDEX(A:A, MATCH(\"Z\", A:A))&lt;&gt;D2)))\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/AbD0Z.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/AbD0Z.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 1, "user_id": 8836389, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4302276f099330e6b699c075e069a3f6?s=128&d=identicon&r=PG&f=1", "display_name": "David Morocutti", "link": "https://stackoverflow.com/users/8836389/david-morocutti"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4299, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1524734339, "creation_date": 1524651231, "last_edit_date": 1524734339, "question_id": 50019635, "link": "https://stackoverflow.com/questions/50019635/vba-count-the-number-of-unique-values", "title": "VBA count the number of unique values", "body": "<p>I looked into the forum and I cannot really find the right answer to my problem. I have a list which looks like this:</p>\n\n<p>ID             ID2             </p>\n\n<pre><code>SS_ID 1            T1              \nSS_ID 1            T2\nSS_ID 1            T2\nSS_ID 1            T3\nSS_ID 4            T1\nSS_ID 4            T5\n</code></pre>\n\n<p>There is the 1st column which has IDs. The thing is that in the second column I have also ID numbers which are related with the 1st column.</p>\n\n<p>So the list is in a sheet in Excel and I am trying to find with the help of VBA the number of Users from the 2nd column who are related to the 1st column. If by any chance there is a solution without VBA please feel free to help me. But as far as I can see it I only see the solution in VBA. </p>\n\n<p>FYI I generate the list from a macro.I also found a way to remove the duplicates without deleting the rows which is necessarily in my case.</p>\n\n<p>To Sum up, I need the sum of \"unique\" values from the 2nd column which are related to the 1st column. It is like a countif function but a little more complicated.</p>\n\n<p>The result should look like this:</p>\n\n<pre><code>SS_ID 1    =    3\nSS_ID 4    =    2\n</code></pre>\n\n<p>I am completely new to VBA.</p>\n"}, {"tags": ["vba", "for-loop", "save"], "answers": [{"tags": [], "owner": {"reputation": 83, "user_id": 8585970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/22f697fdac54ab148b296b5fb7e62ed5?s=128&d=identicon&r=PG&f=1", "display_name": "Oskar", "link": "https://stackoverflow.com/users/8585970/oskar"}, "is_accepted": false, "score": 0, "last_activity_date": 1524651117, "creation_date": 1524651117, "answer_id": 50019598, "question_id": 50019485, "link": "https://stackoverflow.com/questions/50019485/prompt-file-open-make-changes-and-save-as-another-copy-and-close-unsave-the/50019598#50019598", "title": "Prompt file open, make changes and save as another copy, and close + unsave the original file", "body": "<p>I am not sure, but maybe the problem is that you close the ActiveWorkbook first?</p>\n"}], "owner": {"reputation": 51, "user_id": 9551073, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-RaaRvp3msDU/AAAAAAAAAAI/AAAAAAAAATk/JgRQtnMq8bc/photo.jpg?sz=128", "display_name": "Thompson Ho", "link": "https://stackoverflow.com/users/9551073/thompson-ho"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 39, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1524651117, "creation_date": 1524650740, "question_id": 50019485, "link": "https://stackoverflow.com/questions/50019485/prompt-file-open-make-changes-and-save-as-another-copy-and-close-unsave-the", "title": "Prompt file open, make changes and save as another copy, and close + unsave the original file", "body": "<p>I am trying to prompt user open file1 and file 2.\nthen make changes (highlight non date cell) on file 2\nand then save copy of the changed file2.\nAt the same time, keep the original file2 unsave and close it.</p>\n\n<p>Below is my code \nRunning result:</p>\n\n<p>file1 stays opened,</p>\n\n<p>file2 is highlighted but no copy is save , and it stays open</p>\n\n<p>kindly advise what is wrong with it.</p>\n\n<pre><code> Sub LogSAVEAS()\n\n 'prompt open file 1\n N = Application.GetOpenFilename _\n (Title:=\"Please choose file1\", _\n FileFilter:=\"Excel Files *.xls*; *.csv (*.xls*; *.csv),\")\nSet twb = Workbooks.Open(N)\n\nIf N = False Then\nMsgBox \"No file selected. Please click run again and select file\", \nvbExclamation, \"Sorry!\"\nExit Sub\nElse\nEnd If\n\n'prompt open file 2\nR = Application.GetOpenFilename _\n(Title:=\"Please choose file2\", _\nFileFilter:=\"Excel Files *.xls*; *.csv (*.xls*; *.csv),\")\nSet extwbk = Workbooks.Open(R)\nIf R = False Then\nMsgBox \"No file selected. Please click run again and select file.\", \nvbExclamation, \"Sorry!\"\nExit Sub\nElse\nEnd If\n\n\nDim WS As Worksheet\n\nFor Each WS In extwbk.workseets 'highlight issue format cell in file2\nCall highlightdate(WS)\n\nNext\n\n\nSet extwbk = ActiveWorkbook\nActiveWorkbook.Sheets.copy 'copy file2 with highlight and save as \"log\"\ndt = Format(CStr(Now), \"yyyymmddhhmm\")\nActiveWorkbook.SAVEAS Filename:=extwbk.Path &amp; \"\\log\" &amp; dt &amp; \".xlsx\"\n\nActiveWorkbook.Close savechanges:=True 'save and close log\n\nextwbk.Close savechanges:=False 'unsave and close file2\n\ntwb.Close savechanges:=True 'save and close file1\n\n\nEnd Sub\n\nSub highlightnondate(WS As Worksheet)\n\nWith WS\n  Set t = .Rows(1).Find(\"Date\", lookat:=xlPart)\n\n   If t Is Nothing Then Exit Sub\n\n  For Each currentCell In Intersect(.Columns(t.Column), .UsedRange.Resize(.UsedRange.Rows.Count - 1, .UsedRange.Columns.Count).Offset(1, 0))\n        If Not IsEmpty(currentCell) And Not IsDate(currentCell.Value) Then counter = counter + 1\n     If Not IsEmpty(currentCell) And Not IsDate(currentCell.Value) Then currentCell.Interior.color = 56231\n   Next currentCell\n\n   End With\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-word", "word-2016"], "comments": [{"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1524655353, "post_id": 50019397, "comment_id": 87057669, "body": "Do you have (at least) six tables in the document? And is the document the &quot;active&quot; one that you think it is? Do each of these tables have (at least) two cells? Note that, since you set the active document to <code>Source</code> at the beginning you should still be using <code>Source</code> in these lines of code, as well - instead of <code>ActiveDocument</code>."}, {"owner": {"reputation": 2709, "user_id": 4579015, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/56bbb7da70756a6470a57e2ee5ca341f?s=128&d=identicon&r=PG&f=1", "display_name": "LocEngineer", "link": "https://stackoverflow.com/users/4579015/locengineer"}, "edited": false, "score": 0, "creation_date": 1524655865, "post_id": 50019397, "comment_id": 87058022, "body": "If you cut a page, Table(2) becomes Table(1). ;-) Better to loop backwards - or always refer to Table(1)"}, {"owner": {"reputation": 63, "user_id": 9228734, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/10215523654311313/picture?type=large", "display_name": "Infernez", "link": "https://stackoverflow.com/users/9228734/infernez"}, "edited": false, "score": 0, "creation_date": 1524655996, "post_id": 50019397, "comment_id": 87058122, "body": "I have 8 tables per page; i I am 99.99% sure it is the &quot;active&quot; document. I have made the amendments to my code, thanks for pointing that out! I know receive a &#39;424&#39; Object required error for the same section of code.... DO you know what may cause this? Do I need to define it?"}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1524657184, "post_id": 50019397, "comment_id": 87058980, "body": "In your place, I&#39;d probably step through the code (F8) to determine exactly what line is triggering it. I&#39;d also declare and assign to a <code>Range</code> object (or objects) and while stepping through use <code>Range.Select</code> to see whether what VBA thinks is the right Range is the same one you think it should be using."}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1524657269, "post_id": 50019397, "comment_id": 87059035, "body": "Additional note: <code>Bookmarks(&quot;\\Page&quot;)</code> is going to refer to the current SELECTION (page with the selection). Things may be going wrong because that&#39;s not what you expect - selecting one of the Table / Row / Cell ranges might also help."}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1524657332, "post_id": 50019397, "comment_id": 87059063, "body": "And one other thing: when you reply to someone in Comments use @name (like @Infernez) to make sure the person gets a notification. I wouldn&#39;t have see your comment if I hadn&#39;t been checking this, again..."}], "answers": [{"tags": [], "owner": {"reputation": 9249, "user_id": 9170274, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BrcC8.jpg?s=128&g=1", "display_name": "macropod", "link": "https://stackoverflow.com/users/9170274/macropod"}, "is_accepted": true, "score": 0, "last_activity_date": 1526907708, "creation_date": 1526907708, "answer_id": 50449511, "question_id": 50019397, "link": "https://stackoverflow.com/questions/50019397/error-5941-vba-word-2016-save-file-get-name-from-table/50449511#50449511", "title": "Error 5941 VBA Word 2016 - Save file, get name from table", "body": "<p>At least part of the problem is that you're getting the end-of-cell characters for each cell. Try:</p>\n\n<pre><code>DocName = \"\" _\n    &amp; Split(Source.Tables(3).Cell(1 ,2).Range.Text, vbCr)(0) _\n    &amp; Split(Source.Tables(5).Cell(1, 2).Range.Text, vbCr)(0) _\n    &amp; Split(Source.Tables(6).Cell(1, 2).Range.Text, vbCr)(0)\n</code></pre>\n\n<p>You also aren't supplying the file extension, format, etc. as part of the SaveAs.</p>\n\n<p>You may also be interested in <em>Split Merged Output to Separate Documents</em> in the <strong>Mailmerge Tips and Tricks</strong> thread at: <a href=\"http://www.msofficeforums.com/mail-merge/21803-mailmerge-tips-tricks.html\" rel=\"nofollow noreferrer\">http://www.msofficeforums.com/mail-merge/21803-mailmerge-tips-tricks.html</a> which, amongst other things, shows how to supply the required SaveAs parameters.</p>\n"}], "owner": {"reputation": 63, "user_id": 9228734, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/10215523654311313/picture?type=large", "display_name": "Infernez", "link": "https://stackoverflow.com/users/9228734/infernez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 381, "favorite_count": 0, "accepted_answer_id": 50449511, "answer_count": 1, "score": 0, "last_activity_date": 1526907708, "creation_date": 1524650546, "question_id": 50019397, "link": "https://stackoverflow.com/questions/50019397/error-5941-vba-word-2016-save-file-get-name-from-table", "title": "Error 5941 VBA Word 2016 - Save file, get name from table", "body": "<p>I am trying to split my word document by pages and save the splits as new files named from cells in various tables that are the same on each page. The error I am encountering is:</p>\n\n<p>Run-time error '5941':</p>\n\n<p>The requested member of the collection does not exist. </p>\n\n<p>My code thus far is:</p>\n\n<pre><code>Sub splitter()\n'\n'\nDim Counter As Long, Source As Document, Target As Document\nSet Source = ActiveDocument\nSelection.HomeKey Unit:=wdStory\nPages = Source.BuiltInDocumentProperties(wdPropertyPages)\nCounter = 0\nWhile Counter &lt; Pages\nCounter = Counter + 1\nDocName = \"\" _\n    &amp; Left(ActiveDocument.Tables(3).Rows(1).Cells(2).Range.Text, _\n        Len(ActiveDocument.Tables(3).Rows(1).Cells(2).Range.Text)) _\n    &amp; Left(ActiveDocument.Tables(5).Rows(1).Cells(2).Range.Text, _\n        Len(ActiveDocument.Tables(5).Rows(1).Cells(2).Range.Text)) _\n    &amp; Left(ActiveDocument.Tables(6).Rows(1).Cells(2).Range.Text, _\n        Len(ActiveDocument.Tables(6).Rows(1).Cells(2).Range.Text))\nSource.Bookmarks(\"\\Page\").Range.Cut\nSet Target = Documents.Add\nTarget.Range.Paste\nTarget.SaveAs FileName:=DocName\nTarget.Close\nWend\nEnd Sub\n</code></pre>\n\n<p>The error specified in the title occurs within these lines of the code:</p>\n\n<pre><code>DocName = \"\" _\n    &amp; Left(ActiveDocument.Tables(3).Rows(1).Cells(2).Range.Text, _\n        Len(ActiveDocument.Tables(3).Rows(1).Cells(2).Range.Text)) _\n    &amp; Left(ActiveDocument.Tables(5).Rows(1).Cells(2).Range.Text, _\n        Len(ActiveDocument.Tables(5).Rows(1).Cells(2).Range.Text)) _\n    &amp; Left(ActiveDocument.Tables(6).Rows(1).Cells(2).Range.Text, _\n        Len(ActiveDocument.Tables(6).Rows(1).Cells(2).Range.Text))\n</code></pre>\n\n<p>I am not sure how to resolve this error. </p>\n\n<p>A second question is where can I set the directory that the documents are saved to in this code? </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 1, "creation_date": 1524650756, "post_id": 50019355, "comment_id": 87054889, "body": "You never increment <code>erow</code> so you are pasting over the same cells again and again. Also, there are quicker ways to do this, using Find or Match which will avoid having to loop twice. Last, please read up on indenting your code."}, {"owner": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "edited": false, "score": 0, "creation_date": 1524650777, "post_id": 50019355, "comment_id": 87054907, "body": "Both of your For loops use <code>I</code> as counter? why?"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "edited": false, "score": 0, "creation_date": 1524650803, "post_id": 50019355, "comment_id": 87054923, "body": "@FoxfireAndBurnsAndBurns - one is a lower case L I think (still confusing though when there is a whole alphabet from which to choose)."}, {"owner": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1524650895, "post_id": 50019355, "comment_id": 87054969, "body": "@sjr Oh!!! Good eyes! You are right. I would suggest OP to use different letter because those are so similar."}, {"owner": {"reputation": 13, "user_id": 9696600, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Pinto Andr&#233;", "link": "https://stackoverflow.com/users/9696600/pinto-andr%c3%a9"}, "edited": false, "score": 0, "creation_date": 1524651193, "post_id": 50019355, "comment_id": 87055150, "body": "thanks for your input guys!how can i increment erow?"}, {"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1524654354, "post_id": 50019355, "comment_id": 87056991, "body": "Increment <code>erow</code> every time you copy. So after your: <code>Worksheets(&quot;Fallidas&quot;).Rows(I).EntireRow.Copy Destination:=Sheets(&quot;Failed_Trades&quot;).Range(&quot;A&quot; &amp; erow)</code>, in the next line add the following: <code>erow = erow + 1</code>. Also, just to help with the code: I would capture the 2 ranges (from <code>Worksheets(&quot;xlsConsultaConciliacion&quot;)</code> and <code>Worksheets(&quot;Fallidas&quot;)</code>) into arrays. It will help with performance"}], "answers": [{"tags": [], "owner": {"reputation": 116, "user_id": 9723901, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/33df4591b2be05bb1fd2e54dcc2a1a6f?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Peters", "link": "https://stackoverflow.com/users/9723901/ian-peters"}, "is_accepted": false, "score": 0, "last_activity_date": 1525452818, "creation_date": 1525452818, "answer_id": 50179798, "question_id": 50019355, "link": "https://stackoverflow.com/questions/50019355/excel-vba-copy-paste-between-3-sheets/50179798#50179798", "title": "EXCEL - VBA - copy paste between 3 sheets", "body": "<p>You need to increment erow as part of the If statement.  I've also included an Exit For statement in there so that it doesn't keep searching through the 2nd worksheet after the first match is found.  But maybe you want it to find additional matches and populate the same information repetitively on the third sheet?</p>\n\n<pre><code>    If Sheets(\"xlsConsultaConciliacion\").Cells(i, 1) = Sheets(\"Fallidas\").Cells(l, 2) Then\n        Worksheets(\"Fallidas\").Rows(i).EntireRow.Copy Destination:=Sheets(\"Failed_Trades\").Range(\"A\" &amp; erow) \n        erow = erow + 1\n        Exit For\n    End If\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 9696600, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Pinto Andr&#233;", "link": "https://stackoverflow.com/users/9696600/pinto-andr%c3%a9"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 43, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1525458161, "creation_date": 1524650437, "last_edit_date": 1525458161, "question_id": 50019355, "link": "https://stackoverflow.com/questions/50019355/excel-vba-copy-paste-between-3-sheets", "title": "EXCEL - VBA - copy paste between 3 sheets", "body": "<p>I'm trying to copy/paste information between three different Sheets.\nThe first two I only want to compare information with a <code>If</code> and if the condition is met then from sheet n2 copy all rows to a third sheet. My problem is that the code only finds the first value and stops.  Here's the code.</p>\n\n<pre><code>Sub fallidas2()\n\nDim iLastRow As Long\n    Dim I As Long\n    Dim l As Long\n    Dim erow As Long\n\n    erow = Sheets(\"Failed_Trades\").Range(\"A\" &amp; Rows.Count).End(xlUp).Row + 1\n\n    Workbooks(\"modelo titulos UK\").Worksheets(\"xlsConsultaConciliacion\").Select\n\n    iLastRow = Worksheets(\"xlsConsultaConciliacion\").Cells(Rows.Count, \"C\").End(xlUp).Row\n    iLastRow2 = Worksheets(\"Fallidas\").Cells(Rows.Count, \"C\").End(xlUp).Row\n    For I = 3 To iLastRow\n      For l = 2 To iLastRow2\n        If Sheets(\"xlsConsultaConciliacion\").Cells(I, 1) = Sheets(\"Fallidas\").Cells(l, 2) Then\n          Worksheets(\"Fallidas\").Rows(I).EntireRow.Copy _\n                    Destination:=Sheets(\"Failed_Trades\").Range(\"A\" &amp; erow)\n\n        End If\n      Next l\n    Next I\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 9696481, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Muhd Munzir", "link": "https://stackoverflow.com/users/9696481/muhd-munzir"}, "edited": false, "score": 0, "creation_date": 1524662561, "post_id": 50019670, "comment_id": 87063078, "body": "Thanks 4 ur answer..But what the function of Application.WorksheetFunction.Sum?"}, {"owner": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "reply_to_user": {"reputation": 3, "user_id": 9696481, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Muhd Munzir", "link": "https://stackoverflow.com/users/9696481/muhd-munzir"}, "edited": false, "score": 0, "creation_date": 1524663489, "post_id": 50019670, "comment_id": 87063643, "body": "I understood you where asking how to sum"}, {"owner": {"reputation": 3, "user_id": 9696481, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Muhd Munzir", "link": "https://stackoverflow.com/users/9696481/muhd-munzir"}, "edited": false, "score": 0, "creation_date": 1524756258, "post_id": 50019670, "comment_id": 87109618, "body": "but i still get the value in 1st column are adding with sum of value in 2nd column..."}, {"owner": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "reply_to_user": {"reputation": 3, "user_id": 9696481, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Muhd Munzir", "link": "https://stackoverflow.com/users/9696481/muhd-munzir"}, "edited": false, "score": 0, "creation_date": 1524758829, "post_id": 50019670, "comment_id": 87111253, "body": "In your question, you say <i>I would like know how i can add 1st column with 2nd columns by VBA</i> and that&#39;s what you have. What do you want exactly. You need to explain better"}, {"owner": {"reputation": 3, "user_id": 9696481, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Muhd Munzir", "link": "https://stackoverflow.com/users/9696481/muhd-munzir"}, "edited": false, "score": 0, "creation_date": 1524799218, "post_id": 50019670, "comment_id": 87125897, "body": "sorry for my mistake in asking question..actually,i want add 1st column and 2nd column by row..means that 1st row in column 1 adding with 1st row in column 2 then the answer are show in 1st row of column 1...then it continues until row 10...tq"}, {"owner": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "reply_to_user": {"reputation": 3, "user_id": 9696481, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Muhd Munzir", "link": "https://stackoverflow.com/users/9696481/muhd-munzir"}, "edited": false, "score": 0, "creation_date": 1524822904, "post_id": 50019670, "comment_id": 87135974, "body": "@MuhdMunzir Check code updated. Now the code just sums <code>A1+B1</code>, <code>A2+B2</code>, <code>A3+B3</code> and so on, until row 10. The result of the sum is shown in column A in each row. Is this what you wanted?"}, {"owner": {"reputation": 3, "user_id": 9696481, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Muhd Munzir", "link": "https://stackoverflow.com/users/9696481/muhd-munzir"}, "edited": false, "score": 0, "creation_date": 1524834565, "post_id": 50019670, "comment_id": 87142776, "body": "yes the result are shown in column A for each row..new.value of A1= A1 + B1,tq"}, {"owner": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "reply_to_user": {"reputation": 3, "user_id": 9696481, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Muhd Munzir", "link": "https://stackoverflow.com/users/9696481/muhd-munzir"}, "edited": false, "score": 0, "creation_date": 1524835852, "post_id": 50019670, "comment_id": 87143602, "body": "Glad to help. Please, mark the answer as correct, so the question will appear as resolved."}], "tags": [], "owner": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "is_accepted": true, "score": 0, "last_activity_date": 1524822775, "last_edit_date": 1524822775, "creation_date": 1524651315, "answer_id": 50019670, "question_id": 50019068, "link": "https://stackoverflow.com/questions/50019068/adding-between-two-column-by-usin-vba/50019670#50019670", "title": "adding between two column by usin VBA", "body": "<p>Your code just sum all values in <code>Range(B1:B10)</code> to each value in <code>Range(\"A1:A10\"</code></p>\n\n<p>There is no need to loop twice. You can use this code instead:</p>\n\n<pre><code>Sub Button1_Click()\nDim A As Range\n\nFor Each A In Range(\"A1:A10\")\n    A.Value = A.Value + Range(\"B\" &amp; A.Row).Value\nNext A\n\nEnd Sub\n</code></pre>\n\n<p>It will take each cell of <code>Range (\"A1:A10\")</code> and will sum it with the value of the adjacent cell in column B. Hope this helps</p>\n"}], "owner": {"reputation": 3, "user_id": 9696481, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Muhd Munzir", "link": "https://stackoverflow.com/users/9696481/muhd-munzir"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 32, "favorite_count": 1, "accepted_answer_id": 50019670, "answer_count": 1, "score": 0, "last_activity_date": 1524822775, "creation_date": 1524649678, "last_edit_date": 1531164843, "question_id": 50019068, "link": "https://stackoverflow.com/questions/50019068/adding-between-two-column-by-usin-vba", "title": "adding between two column by usin VBA", "body": "<p>I would like know how i can add 1st column with 2nd columns by VBA , example when someone click on a button.Then,the sum are fill back in 1st columns...and automatic continue for 10 r0ws.\nthis are my coding</p>\n\n<hr>\n\n<pre><code>Sub Button1_Click()\n\nFor Each r In Range(\"B1:B10\")\n\nFor Each a In Range(\"A1:A110\")\n\na.Value = a.Value + r.Value\n\nNext a\n\nNext r\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 4047, "user_id": 3246362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6da9a197d0f0e5f19875d8a97550e58e?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/3246362/sam"}, "is_accepted": false, "score": 1, "last_activity_date": 1524649548, "creation_date": 1524649548, "answer_id": 50019023, "question_id": 50018797, "link": "https://stackoverflow.com/questions/50018797/excel-vba-straight-connector-issue/50019023#50019023", "title": "Excel VBA straight connector issue", "body": "<p>The direction of the arrow is of little relevance. When you change a shape, it is done by either size or position. If you increase the size it'll grow to the right and down. To compensate for this, you will have to move it up and left the same amount.</p>\n"}, {"tags": [], "owner": {"reputation": 83, "user_id": 8585970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/22f697fdac54ab148b296b5fb7e62ed5?s=128&d=identicon&r=PG&f=1", "display_name": "Oskar", "link": "https://stackoverflow.com/users/8585970/oskar"}, "is_accepted": false, "score": 1, "last_activity_date": 1524649698, "creation_date": 1524649698, "answer_id": 50019078, "question_id": 50018797, "link": "https://stackoverflow.com/questions/50018797/excel-vba-straight-connector-issue/50019078#50019078", "title": "Excel VBA straight connector issue", "body": "<p>You could move it after changing size using code similar to this:</p>\n\n<pre><code>With ActiveSheet.Shapes(\"ShapeName\")\n   .Left = 0\n   .Top = 0\nEnd With\n</code></pre>\n\n<p>I know it doesn't answer your question directly, but maybe it helps.</p>\n"}], "owner": {"reputation": 47, "user_id": 5700602, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-MiR1PpaLpkk/AAAAAAAAAAI/AAAAAAAAIGk/Es3-pfwL6ps/photo.jpg?sz=128", "display_name": "Dipin ", "link": "https://stackoverflow.com/users/5700602/dipin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 251, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1524649698, "creation_date": 1524648924, "question_id": 50018797, "link": "https://stackoverflow.com/questions/50018797/excel-vba-straight-connector-issue", "title": "Excel VBA straight connector issue", "body": "<p>I am trying to change straight connector width (arrow pointing towards left), but when I code it to increase length its length is increasing from tail , not from arrowhead.</p>\n\n<p><a href=\"https://i.stack.imgur.com/WogLv.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/WogLv.jpg\" alt=\"straight connector\"></a></p>\n\n<p>So is there a way to increase width from arrow head ? </p>\n"}, {"tags": ["excel", "userform", "vba"], "comments": [{"owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "edited": false, "score": 0, "creation_date": 1524649599, "post_id": 50018486, "comment_id": 87054078, "body": "Are you getting an error, or does the problem manifest in another way?"}, {"owner": {"reputation": 169, "user_id": 3673417, "user_type": "registered", "accept_rate": 26, "profile_image": "https://www.gravatar.com/avatar/4b76ffec12c15f199bf4595c57d7f880?s=128&d=identicon&r=PG&f=1", "display_name": "user3673417", "link": "https://stackoverflow.com/users/3673417/user3673417"}, "reply_to_user": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "edited": false, "score": 0, "creation_date": 1524649704, "post_id": 50018486, "comment_id": 87054152, "body": "No errors reported but the labels are not populating"}, {"owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "edited": false, "score": 0, "creation_date": 1524650069, "post_id": 50018486, "comment_id": 87054427, "body": "Inside your <code>l</code> loop there, add a line: <code>Debug.Print Cell.Offset(, languageCol).Address</code> to check where it&#39;s looking for the text."}], "answers": [{"tags": [], "owner": {"reputation": 169, "user_id": 3673417, "user_type": "registered", "accept_rate": 26, "profile_image": "https://www.gravatar.com/avatar/4b76ffec12c15f199bf4595c57d7f880?s=128&d=identicon&r=PG&f=1", "display_name": "user3673417", "link": "https://stackoverflow.com/users/3673417/user3673417"}, "is_accepted": false, "score": 0, "last_activity_date": 1524653799, "creation_date": 1524653799, "answer_id": 50020514, "question_id": 50018486, "link": "https://stackoverflow.com/questions/50018486/populate-userform-labels/50020514#50020514", "title": "Populate Userform Labels", "body": "<p>Solved it. The issue was how I was defining the name for each control on the form. Solution below</p>\n\n<pre><code>For Each Cell In Sheet2.Range(\"C9\", Sheet2.Cells(Rows.Count, \"C\").End(xlUp)).Cells\n    Me.Controls(Cell.Text).Caption = Cell.Offset(, languageCol).Text\nNext Cell\n</code></pre>\n"}], "owner": {"reputation": 169, "user_id": 3673417, "user_type": "registered", "accept_rate": 26, "profile_image": "https://www.gravatar.com/avatar/4b76ffec12c15f199bf4595c57d7f880?s=128&d=identicon&r=PG&f=1", "display_name": "user3673417", "link": "https://stackoverflow.com/users/3673417/user3673417"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 198, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1524653799, "creation_date": 1524648013, "last_edit_date": 1531164843, "question_id": 50018486, "link": "https://stackoverflow.com/questions/50018486/populate-userform-labels", "title": "Populate Userform Labels", "body": "<p>I have a situation where I need to populate the labels on a userform based on the selected language. </p>\n\n<p>Sheet 2 contains a list of the label names in column C, starting at row 9, and the adjacent columns D to F contain the caption text each label should have base on the selected language. Selecting a language populates cell C2 with a number which represents the column to use, ie columns 4, 5 or 6 (languageCol). I have tried various iterations of the following code but I am unable to populate the labels.</p>\n\n<pre><code>Dim Cell As Range\nDim l As Integer\nDim languageCol As Integer\n\nlanguageCol = Sheet2.Range(\"C2\")\n\nFor Each Cell In Sheet2.Range(\"C9\", Sheet2.Cells(Rows.Count, \"C\").End(xlUp)).Cells\n    For l = 1 To 5\n        Me.Controls(\"frm_Details\" &amp; l).Caption = Cell.Offset(, languageCol).Text\n    Next l\nNext Cell\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "edited": false, "score": 1, "creation_date": 1524648317, "post_id": 50018220, "comment_id": 87053209, "body": "Your previous questions don\u2019t have accepted answers - none of them helped you? Can you include your attempted code to solve the requirements?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user9617878"}, "reply_to_user": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "edited": false, "score": 0, "creation_date": 1524648461, "post_id": 50018220, "comment_id": 87053296, "body": "Hello @jeepad. Thank you for your reply. I&#39;ll be more than happy to post my attempt here. And what may seem boring to you may be challenging for others. :) Also, as evident from my reputation, I am new to SO. Would appreciate an advice on how I can improve my question."}, {"owner": {"user_type": "does_not_exist", "display_name": "user9617878"}, "reply_to_user": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "edited": false, "score": 0, "creation_date": 1524648981, "post_id": 50018220, "comment_id": 87053654, "body": "@paul bica . These were my attempts. Thank you for suggesting how to improve my question."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1524660922, "post_id": 50018220, "comment_id": 87061854, "body": "@PriyankaDembla Well, you posted your requirement, if that means you want us to fulfill that, this is not how this site works. We need a precise question that is well defined and not too broad and that we can answer: See <a href=\"https://meta.stackoverflow.com/a/284237/3219613\">Why is \u201cCan someone help me?\u201d not an actual question?</a> You didn&#39;t ask one yet. Try to explain what is wrong with your attempts, where you got errors and which? What do you expect and what does it do instead. If possible make a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> to illustrate your issue. The more you explain the more likely is it to get a good answer."}, {"owner": {"user_type": "does_not_exist", "display_name": "user9617878"}, "edited": false, "score": 0, "creation_date": 1524719843, "post_id": 50018220, "comment_id": 87086593, "body": "@PEH . Thank you for your reply. I am sure I have learned how to improve my questions. I have edited it and tried to make it better. If you need more information please let me know."}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user9617878"}, "edited": false, "score": 0, "creation_date": 1524736264, "post_id": 50037378, "comment_id": 87095805, "body": "Thank you. Seems to do the trick. But could you kindly explain the  <code>&gt;1</code> and <code>=1</code> in the if? I read it online but thought would be clearer in the current context."}, {"owner": {"user_type": "does_not_exist", "display_name": "user9617878"}, "edited": false, "score": 0, "creation_date": 1524737120, "post_id": 50037378, "comment_id": 87096420, "body": "Could you kindly explain the if condition?"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1524737400, "post_id": 50037378, "comment_id": 87096614, "body": "@PriyankaDembla See my edit. Basically the formula marks all as copy but sorts out the ones which <b>don&#39;t</b> meet any of the criteria (unique, non-unique but selected, selected). The VBA part uses the same technique."}], "tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": true, "score": 1, "last_activity_date": 1524737896, "last_edit_date": 1524737896, "creation_date": 1524728307, "answer_id": 50037378, "question_id": 50018220, "link": "https://stackoverflow.com/questions/50018220/check-row-condition-to-copy-and-paste-from-1-workbook-to-the-other/50037378#50037378", "title": "Check row Condition to copy and paste from 1 Workbook to the other", "body": "<p>To determine which line has to be copied and which not you can use this formula\nin column G</p>\n\n<pre><code>=IF(AND(COUNTIF(B:B,B:B)&gt;1,COUNTIFS(B:B,B:B,F:F,\"Selected\")=1,F:F&lt;&gt;\"Selected\"),\"-\",\"copy\")\n</code></pre>\n\n<p>Now you could even use filters to filter by column G.</p>\n\n<p><strong>Explanation</strong></p>\n\n<ul>\n<li><p><code>COUNTIF(B:B,B:B)</code> counts the occurrences of the \"AssetID\". So this is a test for uniqueness if it is <code>&gt;1</code> the ID is not unique.</p></li>\n<li><p><code>COUNTIFS(B:B,B:B,F:F,\"Selected\")</code> counts the occurrences of non-unique \"AssedIDs\" that are \"Selected\". So if this is <code>=1</code> it means one of the IDs was marked as selected.</p></li>\n<li><p><code>F:F&lt;&gt;\"Selected\"</code> means the ID was not selected</p></li>\n</ul>\n\n<p>In total the formula means: Mark all IDs as <code>Copy</code> but sort out these which are \u2026</p>\n\n<ul>\n<li>not unique</li>\n<li>AND not unique and not selected</li>\n<li>AND not selected</li>\n</ul>\n\n<p>and this basically means, keep all marked as copy which are:</p>\n\n<ul>\n<li>unique</li>\n<li>OR non-unique and selected</li>\n<li>OR selected</li>\n</ul>\n\n<hr>\n\n<p><strong>Or an example with VBA</strong><br>\nusing pretty much the same formula.</p>\n\n<pre><code>Sub Example()\n    Dim ws As Worksheet\n    Set ws = Worksheets(\"Tabelle3\") 'your worksheet\n\n    Dim lRow As Long 'last used row\n    lRow = ws.Cells(ws.Cells.Rows.Count, \"A\").End(xlUp).Row\n\n    Const fRow As Long = 3 'first row with data\n\n\n    Dim i As Long\n    For i = fRow To lRow 'run from first data row to last\n        If Not (Application.WorksheetFunction.CountIf(ws.Range(\"B\" &amp; fRow, \"B\" &amp; lRow), ws.Range(\"B\" &amp; i)) &gt; 1 And _\n           Application.WorksheetFunction.CountIfs(ws.Range(\"B\" &amp; fRow, \"B\" &amp; lRow), ws.Range(\"B\" &amp; i), ws.Range(\"F\" &amp; fRow, \"F\" &amp; lRow), \"Selected\") = 1 And _\n           ws.Range(\"F\" &amp; i) &lt;&gt; \"Selected\") Then\n\n            'copy this line\n\n        End If\n    Next i\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user9617878"}, "is_accepted": false, "score": 1, "last_activity_date": 1525074473, "creation_date": 1525074473, "answer_id": 50096097, "question_id": 50018220, "link": "https://stackoverflow.com/questions/50018220/check-row-condition-to-copy-and-paste-from-1-workbook-to-the-other/50096097#50096097", "title": "Check row Condition to copy and paste from 1 Workbook to the other", "body": "<p>Alright I figured out a solution that does exactly what I wanted. Thank you @PEH for your help.</p>\n\n<pre><code>Sub cpyCol()\n    Dim wc As Worksheet, wa As Worksheet\n    Dim lr As Long, I As Long, J As Long, I2 As Long\n    Dim uR As Range\n    Dim wb, wb1 As Workbook\n    Dim eNumStorage() As String ' initial storage array to take values\n    Set wb = Workbooks.Open(\"C:\\Users\\Z003U8UC\\Downloads\\PP_Anan.xlsm\")\n    Set wb1 = ThisWorkbook\n    Set ws = wb.Sheets(\"Procurement plan PM80 -&gt;\")\n    Set wa = ThisWorkbook.Sheets(\"Test\")\n    lRow = ws.Range(\"A\" &amp; Rows.Count).End(xlUp).Offset(-3).Row\n    I2 = 11\n    Const fRow As Long = 2\n    Application.ScreenUpdating = False\n    For I = 2 To lRow 'sheets all have headers that are 2 rows\n        If Not (Application.WorksheetFunction.CountIf(ws.Range(\"B\" &amp; fRow, \"B\" &amp; lRow), ws.Range(\"B\" &amp; I)) &gt; 1 And _\n        Application.WorksheetFunction.CountIfs(ws.Range(\"B\" &amp; fRow, \"B\" &amp; lRow), ws.Range(\"B\" &amp; I), ws.Range(\"AY\" &amp; fRow, \"AY\" &amp; lRow), \"Selected\") = 1 _\n        And ws.Range(\"AY\" &amp; I) &lt;&gt; \"Selected\") Then\n'            If (uR Is Nothing) Then\n'                Set uR = Range(I &amp; \":\" &amp; I)\n'            Else\n'                Set uR = Union(uR, Range(I &amp; \":\" &amp; I))\n'            End If\n            I2 = I2 + 1\n            wa.Cells(I2, \"A\") = ws.Cells(I, \"A\")\n            wa.Cells(I2, \"B\") = ws.Cells(I, \"B\")\n            wa.Cells(I2, \"C\") = ws.Cells(I, \"N\")\n            wa.Cells(I2, \"D\") = ws.Cells(I, \"X\")\n            wa.Cells(I2, \"E\") = ws.Cells(I, \"Y\")\n            wa.Cells(I2, \"G\") = ws.Cells(I, \"AY\")\n            wa.Cells(I2, \"H\") = ws.Cells(I, \"C\")\n            wa.Cells(I2, \"I\") = ws.Cells(I, \"D\")\n            wa.Cells(I2, \"J\") = ws.Cells(I, \"E\")\n            wa.Cells(I2, \"K\") = ws.Cells(I, \"F\")\n            wa.Cells(I2, \"R\") = ws.Cells(I, \"BI\")\n            wa.Cells(I2, \"S\") = ws.Cells(I, \"AT\")\n            wa.Cells(I2, \"T\") = ws.Cells(I, \"AU\")\n            wa.Cells(I2, \"U\") = ws.Cells(I, \"AV\")\n            wa.Cells(I2, \"V\") = ws.Cells(I, \"AW\")\n        End If\n    Next I\n    'uR.copy Destination:=ws.Range(\"A13\")\n    wb.Save\n    wb.Close\n    Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n\n<p>If this can further be improved speed wise please let me know.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user9617878"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 132, "favorite_count": 0, "accepted_answer_id": 50037378, "answer_count": 2, "score": 1, "last_activity_date": 1525074473, "creation_date": 1524647210, "last_edit_date": 1524719746, "question_id": 50018220, "link": "https://stackoverflow.com/questions/50018220/check-row-condition-to-copy-and-paste-from-1-workbook-to-the-other", "title": "Check row Condition to copy and paste from 1 Workbook to the other", "body": "<p>Please look at the attached image\n<a href=\"https://i.stack.imgur.com/q7FyU.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/q7FyU.png\" alt=\"image\"></a></p>\n\n<p>This is just dummy data. </p>\n\n<p>My requirement is </p>\n\n<ul>\n<li><p>If Internal Asset ID (Column B) is unique, Copy row regardless selected or not (Column F).</p></li>\n<li><p>If Internal Asset ID not unique i.e. same Internal Asset ID is present column B \nmore than once, see against which Internal Asset ID is Column F marked as selected &amp; then copy only that row.</p></li>\n<li><p>Copied rows are: 3rd row,5th row, 7th, 8th, 9th row\"</p></li>\n</ul>\n\n<p>This data is in Workbook1:Sheet1 and I have to copy it to Workbook2:Sheet2 The mapping of copy &amp; paste has to be like mentioned below -</p>\n\n<pre><code>WB1:Sheet1 A to WB2:Sheet2 A\nWB1:Sheet1 B to WB2:Sheet2 B\nWB1:Sheet1 N to WB2:Sheet2 C\nWB1:Sheet1 X to WB2:Sheet2 D\nWB1:Sheet1 Y to WB2:Sheet2 E\nWB1:Sheet1 AY to WB2:Sheet2 G\nWB1:Sheet1 C to WB2:Sheet2 H\nWB1:Sheet1 D to WB2:Sheet2 I\nWB1:Sheet1 E to WB2:Sheet2 J\nWB1:Sheet1 F to WB2:Sheet2 K\nWB1:Sheet1 BI to WB2:Sheet2 R\nWB1:Sheet1 AT to WB2:Sheet2 S\nWB1:Sheet1 AU to WB2:Sheet2 T\nWB1:Sheet1 AV to WB2:Sheet2 U\nWB1:Sheet1 AW to WB2:Sheet2 V\n</code></pre>\n\n<p>The pasting in Workbook2:Sheet2 has to start from \"A12\"</p>\n\n<p>My attempt: </p>\n\n<pre><code>Sub cpyCol()\n    Dim wc As Worksheet, wa As Worksheet\n    Dim lr As Long, I As Long, J As Long\n    Dim uR As Range\n    Dim eNumStorage() As String ' initial storage array to take values\n    Dim x As String\n\n    Set wc = Sheets(\"Test\")\n    Set wa = Sheets(\"Test\")\n    lr = wc.Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n    ReDim eNumStorage(1 To lr - 2)\n\n    Application.ScreenUpdating = False\n    For I = 3 To lr 'sheets all have headers that are 2 rows\n        If (Not IsEmpty(Cells(I, 2).Value)) Then ' checks to make sure the value isn't empty\n            J = J + 1\n            eNumStorage(J) = Cells(I, 2).Value ' to store values of internal Asset ID in an array\n        End If\n        If wc.Range(\"F\" &amp; I) = \"Selected\" Then 'check if column F is marked as selected\n            If (uR Is Nothing) Then\n                Set uR = Range(I &amp; \":\" &amp; I)\n            Else\n                Set uR = Union(uR, Range(I &amp; \":\" &amp; I))\n            End If\n        End If\n    Next I\n    uR.copy Destination:=wa.Range(\"A13\")\n    Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n\n<p><strong>Result (For testing I just tried copying &amp; pasting from the same sheet to the same sheet)-</strong></p>\n\n<ul>\n<li>I am able to copy rows which are marked as selected in column F</li>\n<li>I am able to store the values of Internal Asset ID in column B in array eNumStorage()</li>\n<li>So I am able to copy 3rd and 5th row</li>\n</ul>\n\n<p><strong>Where I need help -</strong> </p>\n\n<ul>\n<li>Not able to copy 7th,8th and 9th row.</li>\n</ul>\n\n<p>What I tried to copy 7th,8th and 9th row </p>\n\n<pre><code> If eNumStorage(J) = eNumStorage(J + 1) Then\n        If wc.Range(\"F\" &amp; I) = \"Selected\" Then 'check if column F is marked as selected\n            If (uR Is Nothing) Then\n                Set uR = Range(I &amp; \":\" &amp; I)\n            Else\n                Set uR = Union(uR, Range(I &amp; \":\" &amp; I))\n            End If\n        End If\n    End If\n</code></pre>\n\n<p><strong>Issue -</strong>\nNot working for later rows</p>\n\n<p>Any help would be much appreciated. Thanks. </p>\n"}, {"tags": ["excel", "vba", "select", "case"], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 4580339, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d2fea1dd654c7f685592b46d30d5e3d7?s=128&d=identicon&r=PG&f=1", "display_name": "Adriaan", "link": "https://stackoverflow.com/users/4580339/adriaan"}, "edited": false, "score": 0, "creation_date": 1547027559, "post_id": 50018341, "comment_id": 95046783, "body": "is it possible to search only for part of the text?"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 0, "last_activity_date": 1524656268, "last_edit_date": 1524656268, "creation_date": 1524647578, "answer_id": 50018341, "question_id": 50018116, "link": "https://stackoverflow.com/questions/50018116/conditional-formatting-with-case-more-then-one-selected/50018341#50018341", "title": "conditional formatting with Case more then one selected", "body": "<p>Loop through the cells in the intersect.</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    If Not Intersect(Target, Range(\"G8:OA92\")) Is Nothing Then\n        on error goto meh\n        application.enableevents = false\n        dim t as range\n        for each t in Intersect(Target, Range(\"G8:OA92\"))\n            With t\n                Select Case lcase(.Value2)\n                    Case \"weekend\"\n                        .Interior.ColorIndex = 48\n                    Case \"vrij\", \"adv\"\n                        .Interior.ColorIndex = 6\n                    case else\n                        .interior.pattern = xlnone\n                End Select\n            End With\n        next t \n    End If \nmeh:\n    application.enableevents = true\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 4580339, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d2fea1dd654c7f685592b46d30d5e3d7?s=128&d=identicon&r=PG&f=1", "display_name": "Adriaan", "link": "https://stackoverflow.com/users/4580339/adriaan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 29, "favorite_count": 0, "accepted_answer_id": 50018341, "answer_count": 1, "score": 1, "last_activity_date": 1524656268, "creation_date": 1524646884, "last_edit_date": 1524647811, "question_id": 50018116, "link": "https://stackoverflow.com/questions/50018116/conditional-formatting-with-case-more-then-one-selected", "title": "conditional formatting with Case more then one selected", "body": "<p>I have a VBA like below but when i copy more then 1 cell i get a error because of the multiple selection. </p>\n\n<p>Is it possible to make a action that the Case looks at the selected cells one after the other? Or do i have the wrong Statment?</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n  If Not Intersect(Target, Range(\"$G$8:$OA$92\")) Is Nothing Then\n\n    With Target\n     Select Case .Value\n      Case Is = \"Weekend\"\n          .Interior.ColorIndex = 48\n      Case Is = \"VRIJ\", \"ADV\"\n          .Interior.ColorIndex = 6\n     End Select\nEnd With\nEnd If\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "rubberduck"], "answers": [{"comments": [{"owner": {"reputation": 1532, "user_id": 5996109, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/ea8a30cf336f9bdd23ecafdae26e2b2a?s=128&d=identicon&r=PG&f=1", "display_name": "Alfa Bravo", "link": "https://stackoverflow.com/users/5996109/alfa-bravo"}, "edited": false, "score": 0, "creation_date": 1524649429, "post_id": 50018818, "comment_id": 87053942, "body": "Thank you, this was exactly the answer I was looking for. I thought it had something to do with cutting out a few lines of code, but was not completely sure about it. The class question was actually not useful information now that I look back at it."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 1532, "user_id": 5996109, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/ea8a30cf336f9bdd23ecafdae26e2b2a?s=128&d=identicon&r=PG&f=1", "display_name": "Alfa Bravo", "link": "https://stackoverflow.com/users/5996109/alfa-bravo"}, "edited": false, "score": 0, "creation_date": 1524654884, "post_id": 50018818, "comment_id": 87057340, "body": "@AlfaBravo it makes the <code>With</code> block variable be held by the <code>With</code> block itself; an object is created with the <code>New</code> keyword, its reference &quot;belongs&quot; to the <code>With</code> block, and when execution reaches <code>End With</code> the object gets destroyed. You can verify this by putting <code>Debug.Print</code> statements in the <code>Class_Initialize</code> and <code>Class_Terminate</code> handlers of the class module, e.g. <code>Debug.Print &quot;hello&quot;</code> in <code>Class_Initialize</code>, then <code>Debug.Print &quot;goodbye&quot;</code> in <code>Class_Terminate</code> and then <code>Debug.Print &quot;doing the work&quot;</code> in the <code>Run</code> method."}, {"owner": {"reputation": 1532, "user_id": 5996109, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/ea8a30cf336f9bdd23ecafdae26e2b2a?s=128&d=identicon&r=PG&f=1", "display_name": "Alfa Bravo", "link": "https://stackoverflow.com/users/5996109/alfa-bravo"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1524669626, "post_id": 50018818, "comment_id": 87067974, "body": "@MathieuGuindon Thanks, this is actually another helpful thing I have learned today."}, {"owner": {"reputation": 849, "user_id": 2821274, "user_type": "registered", "accept_rate": 49, "profile_image": "https://i.stack.imgur.com/YbBHQ.jpg?s=128&g=1", "display_name": "Shawn V. Wilson", "link": "https://stackoverflow.com/users/2821274/shawn-v-wilson"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1530041049, "post_id": 50018818, "comment_id": 89091179, "body": "@MathieuGuindon, Could you clarify in your tutorial that the <code>MyTestableMacro</code> ought to be a class module, as you put it?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 849, "user_id": 2821274, "user_type": "registered", "accept_rate": 49, "profile_image": "https://i.stack.imgur.com/YbBHQ.jpg?s=128&g=1", "display_name": "Shawn V. Wilson", "link": "https://stackoverflow.com/users/2821274/shawn-v-wilson"}, "edited": false, "score": 0, "creation_date": 1530041159, "post_id": 50018818, "comment_id": 89091226, "body": "@ShawnV.Wilson I would, except I&#39;m not sure which part of &quot;What if we introduced a class, and moved the functionality into there?&quot; and &quot;we can pull out the dependencies and unit-test the MyTestableMacro class&quot; is unclear about this... how do you suggest I make it even clearer?"}, {"owner": {"reputation": 849, "user_id": 2821274, "user_type": "registered", "accept_rate": 49, "profile_image": "https://i.stack.imgur.com/YbBHQ.jpg?s=128&g=1", "display_name": "Shawn V. Wilson", "link": "https://stackoverflow.com/users/2821274/shawn-v-wilson"}, "edited": false, "score": 0, "creation_date": 1530041878, "post_id": 50018818, "comment_id": 89091496, "body": "Change the sentence to say &quot;Now we&#39;d be looking at this <i>class</i>...&quot;"}], "tags": [], "owner": {"reputation": 1404, "user_id": 643342, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/BAdMW.png?s=128&g=1", "display_name": "this", "link": "https://stackoverflow.com/users/643342/this"}, "is_accepted": true, "score": 3, "last_activity_date": 1524649467, "last_edit_date": 1524649467, "creation_date": 1524648973, "answer_id": 50018818, "question_id": 50017960, "link": "https://stackoverflow.com/questions/50017960/with-new-mytestablemacro-run-what-does-it-do/50018818#50018818", "title": "With New MyTestableMacro .Run - What does it do?", "body": "<p>Conceptually, this is no different from the following code:</p>\n\n<pre><code>Dim something As MyTestableMacro\nSet something = New MyTestableMacro\nWith something\n    ...\nEnd With\n</code></pre>\n\n<p>Note that we had to <code>Dim</code> a variable, then initialize it with the <code>New</code> keyword. But we can cut out the 2 extra lines by compressing them into this single statement:</p>\n\n<pre><code>With New MyTestableMacro\n    ...\nEnd With\n</code></pre>\n\n<p>In regards to your another question -- the <code>MyTestableMacro</code> ought to be a class module. Otherwise you wouldn't be able to <code>New</code> it at all. And the <code>Run</code> typically would be a <code>Public</code> method (could be a <code>Sub</code> or a <code>Function</code>, given the syntax used in your post). A <code>Private</code> method would not work. <code>Friend</code> would work only for within the same VBA project but it's very rare to see a method using <code>Friend</code> instead of <code>Public</code> or <code>Private</code>.</p>\n"}], "owner": {"reputation": 1532, "user_id": 5996109, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/ea8a30cf336f9bdd23ecafdae26e2b2a?s=128&d=identicon&r=PG&f=1", "display_name": "Alfa Bravo", "link": "https://stackoverflow.com/users/5996109/alfa-bravo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 81, "favorite_count": 0, "accepted_answer_id": 50018818, "answer_count": 1, "score": 1, "last_activity_date": 1524649467, "creation_date": 1524646433, "last_edit_date": 1524649265, "question_id": 50017960, "link": "https://stackoverflow.com/questions/50017960/with-new-mytestablemacro-run-what-does-it-do", "title": "With New MyTestableMacro .Run - What does it do?", "body": "<p>I am following <a href=\"https://rubberduckvba.wordpress.com/2017/10/19/how-to-unit-test-vba-code/\" rel=\"nofollow noreferrer\">this</a> tutorial by RubberduckVBA and have come across this piece of code, but have no idea what it really does:</p>\n\n<pre><code>With New MyTestableMacro\n    .Run dataServiceStub, wsServiceStub\nEnd With\n</code></pre>\n\n<p>I have tried to search for <em>\"New keyword in With statement\"</em> as well as a few other things, but do not find anything about it.</p>\n\n<p>It is not code that I have seen in a year of doing VBA...</p>\n\n<p>I have also tried making a class named <code>MyTestableMacro</code> with a method <code>Run</code> which also did not work.</p>\n\n<p>Just to be clear, I want to know what <code>MyTestableMacro</code> is. Is it a class, module, temporary Macro? And is the Run A method/function inside of it?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1524646726, "post_id": 50017676, "comment_id": 87052227, "body": "Not sure if I understand your question but if it is to get the values of <code>ComboBoxes</code> after you&#39;ve hidden your form? then, you can still access the <code>ComboBoxes</code> even though the form is not visible. You can declare a public variable in a module (i.e. <code>Public oMyForm as New &lt;your form name here&gt;</code>). You can then access any of forms objects or form properties in your UDF&#39;s by simply accessing this object (i.e. <code>oMyForm.myCombobox.Value</code>.. where <code>myCombobox</code> would be the actual name of your combobox)"}], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 9692100, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff3b443880d5d8aa30915a9b2d65266b?s=128&d=identicon&r=PG&f=1", "display_name": "MattyGee", "link": "https://stackoverflow.com/users/9692100/mattygee"}, "edited": false, "score": 0, "creation_date": 1524661529, "post_id": 50018277, "comment_id": 87062324, "body": "That&#39;s what I originally thought. But looking in the Locals window, it is as if it doesn&#39;t exist. None of the new ComboBoxes I have added appear. If I break before the end of the Sub, I can see them, but not once the Sub has ended and the form is still on screen."}, {"owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "reply_to_user": {"reputation": 31, "user_id": 9692100, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff3b443880d5d8aa30915a9b2d65266b?s=128&d=identicon&r=PG&f=1", "display_name": "MattyGee", "link": "https://stackoverflow.com/users/9692100/mattygee"}, "edited": false, "score": 0, "creation_date": 1524670437, "post_id": 50018277, "comment_id": 87068553, "body": "Are you <code>Unload</code>ing or closing the form somewhere, before you attempt to read the values?"}, {"owner": {"reputation": 31, "user_id": 9692100, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff3b443880d5d8aa30915a9b2d65266b?s=128&d=identicon&r=PG&f=1", "display_name": "MattyGee", "link": "https://stackoverflow.com/users/9692100/mattygee"}, "edited": false, "score": 0, "creation_date": 1524673259, "post_id": 50018277, "comment_id": 87070263, "body": "No. So the form is loading, the controls are being added and then the sub is ending. At this point, the form stays on screen while the user can change the answers that they pick - this all works fine. I then have a submit button which I want to take the answers and paste them into a sheet on the attached file. But the answers cant be found as when the sub ends, they disappear."}, {"owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "reply_to_user": {"reputation": 31, "user_id": 9692100, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff3b443880d5d8aa30915a9b2d65266b?s=128&d=identicon&r=PG&f=1", "display_name": "MattyGee", "link": "https://stackoverflow.com/users/9692100/mattygee"}, "edited": false, "score": 0, "creation_date": 1524734396, "post_id": 50018277, "comment_id": 87094569, "body": "I&#39;ve just mocked this up here and noticed that for some reason your loop starts at 5.. so I&#39;ve altered my example to suit. PS. This works fine on my mockup."}, {"owner": {"reputation": 31, "user_id": 9692100, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff3b443880d5d8aa30915a9b2d65266b?s=128&d=identicon&r=PG&f=1", "display_name": "MattyGee", "link": "https://stackoverflow.com/users/9692100/mattygee"}, "edited": false, "score": 0, "creation_date": 1524752845, "post_id": 50018277, "comment_id": 87107266, "body": "That is what I had originally. If i try it, i get Run-time error: &#39;-2147024809 (80070057) Could not find the specified object. The debugger then highlights      QuestionForm1.Controls(&quot;Combo&quot; &amp; i).Value Right enough, then I check my Locals list, it is no where to be seen.  PS. starts at i =5 because I have 4 comboboxes that I have put in myself"}, {"owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "reply_to_user": {"reputation": 31, "user_id": 9692100, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff3b443880d5d8aa30915a9b2d65266b?s=128&d=identicon&r=PG&f=1", "display_name": "MattyGee", "link": "https://stackoverflow.com/users/9692100/mattygee"}, "edited": false, "score": 0, "creation_date": 1524754086, "post_id": 50018277, "comment_id": 87108166, "body": "Sorry @MattyGee, I can&#39;t recreate this myself. I&#39;m getting no problems with the <code>CommandButton1_Click()</code> code above."}], "tags": [], "owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "is_accepted": false, "score": 0, "last_activity_date": 1524734415, "last_edit_date": 1524734415, "creation_date": 1524647346, "answer_id": 50018277, "question_id": 50017676, "link": "https://stackoverflow.com/questions/50017676/vba-values-from-dynamically-added-combobox/50018277#50018277", "title": "VBA values from dynamically added combobox", "body": "<p>You've named your comboboxes using <code>.Name = \"Combo\" &amp; i</code>.</p>\n\n<p>So you could create a routine that runs on pressing a SUBMIT button or similar that reads the values with:</p>\n\n<pre><code>QuestionForm1.Controls(\"Combo5\").Value\n</code></pre>\n\n<p>You could also set this up as a loop to build an array with:</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n\n    ResultsCount = Application.WorksheetFunction.CountA(Sheets(\"QuestionData\").Range(\"B:B\")) - 1\n    Dim chosenvalue(100)\n\n    For i = 5 To ResultsCount\n        chosenvalue(i) = QuestionForm1.Controls(\"Combo\" &amp; i).Value\n        Debug.Print \"Button \" &amp; i &amp; \" set to \" &amp; chosenvalue(i)\n    Next\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 9692100, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff3b443880d5d8aa30915a9b2d65266b?s=128&d=identicon&r=PG&f=1", "display_name": "MattyGee", "link": "https://stackoverflow.com/users/9692100/mattygee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 496, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1524734415, "creation_date": 1524645544, "last_edit_date": 1524646033, "question_id": 50017676, "link": "https://stackoverflow.com/questions/50017676/vba-values-from-dynamically-added-combobox", "title": "VBA values from dynamically added combobox", "body": "<p>First post here. Self-taught VBA so I'm always aware that code may not be perfect. Anyway...</p>\n\n<p>Creating a Userform Questionnaire. I don't know how many questions there will be, and I want it to be easy for anyone to add new questions to the form. Idea is to have the questions listed on a Sheet so that as new questions are added, the userbox will resize accordingly and add in all the questions. </p>\n\n<p>Doing this was no problem:</p>\n\n<pre><code>Public Sub UserForm_Activate()\n    QuestionsCount = Application.WorksheetFunction.CountA(Sheets(\"QuestionData\").Range(\"A:A\")) - 1\n    ResultsCount = Application.WorksheetFunction.CountA(Sheets(\"QuestionData\").Range(\"B:B\")) - 1\n    DepartmentCount = Application.WorksheetFunction.CountA(Sheets(\"QuestionData\").Range(\"C:C\")) - 1\n    QuestionForm1.ScrollHeight = (QuestionsCount) * 70\n    QuestionForm1.Width = 258\n    CommandButton1.Top = (QuestionsCount - 1) * 70\n    CommandButton1.Left = 42\n    CommandButton2.Top = (QuestionsCount - 1) * 70\n    CommandButton2.Left = 132\n\n    Dim i As Integer\n    Dim QQ(1 To 100) As MSForms.Control\n    Dim QA(1 To 100) As MSForms.Control\n    For i = 5 To QuestionsCount\n        Set QQ(i) = QuestionForm1.Controls.Add(\"Forms.Label.1\")\n        Set QA(i) = QuestionForm1.Controls.Add(\"Forms.ComboBox.1\")\n        With QQ(i)\n            .Caption = Sheets(\"QuestionData\").Range(\"A\" &amp; (i + 1))\n            .Width = 84\n            .Top = i * 58\n            .Left = 24\n            .Name = \"Label\" &amp; i\n        End With\n        With QA(i)\n            .RowSource = \"QuestionData!B2:B\" &amp; ResultsCount + 1\n            .Width = 96\n            .Top = i * 58\n            .Left = 138\n            .Name = \"Combo\" &amp; i\n            .Value = \"\"\n        End With\n    Next i\nEnd Sub\n</code></pre>\n\n<p>Userform is created and all the questions I want are there (positioning of the command buttons isn't great, I know, will fix this soon)</p>\n\n<p>The only problem is taking the values. The answers are in a ComboBox, the user will select the answers they want and click the Submit button. The idea was to then take the values from each <code>comboBox</code> and put them into another sheet.\nThe issue I'm having is that the global variables seem to disappear at the end of the sub. So when the user inserts their answers and clicks Submit, the macro tries to take values that aren't there.</p>\n\n<p>What are the names of the added ComboBoxes? Where are their values stored? Is there a way to not End Sub so that the values stay as Global Variables? Any other ideas on what to do?</p>\n\n<p>Any help would be appreciated...hopefully I've explained myself well! </p>\n\n<p>thanks in advance!!</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 355, "user_id": 5346843, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/8b14e611cc6e48b110b7becdcb0b25b6?s=128&d=identicon&r=PG&f=1", "display_name": "PetGriffin", "link": "https://stackoverflow.com/users/5346843/petgriffin"}, "is_accepted": false, "score": 0, "last_activity_date": 1525339912, "creation_date": 1525339912, "answer_id": 50151615, "question_id": 50017613, "link": "https://stackoverflow.com/questions/50017613/excel-vba-ignores-solver-changes-values/50151615#50151615", "title": "EXCEL VBA ignores Solver changes values", "body": "<p>This problem has been modified and updated here:</p>\n\n<p><a href=\"https://stackoverflow.com/questions/50151584/excel-vba-does-not-run-solver-inside-a-macro-invoked-from-a-chart-button\">EXCEL VBA does not run SOLVER inside a macro invoked from a chart button</a></p>\n\n<p>to avoid problems with chameleon questions</p>\n"}], "owner": {"reputation": 355, "user_id": 5346843, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/8b14e611cc6e48b110b7becdcb0b25b6?s=128&d=identicon&r=PG&f=1", "display_name": "PetGriffin", "link": "https://stackoverflow.com/users/5346843/petgriffin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 224, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1525339912, "creation_date": 1524645387, "last_edit_date": 1531164843, "question_id": 50017613, "link": "https://stackoverflow.com/questions/50017613/excel-vba-ignores-solver-changes-values", "title": "EXCEL VBA ignores Solver changes values", "body": "<p>I have the following snippet of Excel VBA code to solve a minimisation problem:</p>\n\n<pre><code>SolverOk SetCell:=\"$AP$13\", MaxMinVal:=2, ValueOf:=0, ByChange:=\"$AP$9:$AP$11\", Engine:=1\nSolverSolve UserFinish:=True\n</code></pre>\n\n<p>This was created using the \"record macro\" menu command in Excel.  If I run the problem from the menu bar using Data | Solver then Solver happily changes all three cells and completes the problem.  The same happens if I run the macro from EXCEL (using Alt-F8).  However, I have assigned the same macro to a VBA button and when I press this Excel only changes cell A9.  I get the same issue if I change the code to</p>\n\n<pre><code>SolverOk SetCell:=\"$AP$13\", MaxMinVal:=2, ValueOf:=0, ByChange:=\"$AP$10:$AP$11\", Engine:=1\n</code></pre>\n\n<p>I tried resetting the problem using SolverReset but this produces an error saying Excel has been exhausted.  </p>\n\n<p>Would appreciate any suggestions on how to force Excel to change all three cells, not just cell A9</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["excel", "vba", "charts"], "comments": [{"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1524644204, "post_id": 50017191, "comment_id": 87050678, "body": "Is it possible.. yes. But you have to provide a lot more information. What you have, what you need it to be and what you have tried so far"}, {"owner": {"reputation": 5283, "user_id": 485674, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9720c6f1a3dead1c68d0f42776633d4d?s=128&d=identicon&r=PG", "display_name": "Jon Peltier", "link": "https://stackoverflow.com/users/485674/jon-peltier"}, "edited": false, "score": 0, "creation_date": 1525048427, "post_id": 50017191, "comment_id": 87201455, "body": "I have a couple tutorials that deal with this kind of data: <a href=\"https://peltiertech.com/vba-to-split-data-range-into-multiple-chart-series/\" rel=\"nofollow noreferrer\">VBA to Split Data Range into Multiple Chart Series</a> and <a href=\"https://peltiertech.com/split-data-range-into-multiple-chart-series-without-vba/\" rel=\"nofollow noreferrer\">Split Data Range into Multiple Chart Series without VBA</a>"}, {"owner": {"reputation": 37, "user_id": 3112031, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9c73e029d42f4dc8d8bbaa52e61be2b?s=128&d=identicon&r=PG&f=1", "display_name": "user3112031", "link": "https://stackoverflow.com/users/3112031/user3112031"}, "edited": false, "score": 0, "creation_date": 1525065883, "post_id": 50017191, "comment_id": 87204793, "body": "Thanks, this got me on the right track"}], "owner": {"reputation": 37, "user_id": 3112031, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9c73e029d42f4dc8d8bbaa52e61be2b?s=128&d=identicon&r=PG&f=1", "display_name": "user3112031", "link": "https://stackoverflow.com/users/3112031/user3112031"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 48, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1524643981, "creation_date": 1524643981, "question_id": 50017191, "link": "https://stackoverflow.com/questions/50017191/add-series-to-excel-scatter-chart-automatically", "title": "Add series to Excel scatter chart automatically", "body": "<p>I would need to add series to Excel scatter chart automatically as I have hundreds of them. Would it be possible to not do it manually, maybe with VBA?</p>\n\n<p><a href=\"https://i.stack.imgur.com/v0uGG.png\" rel=\"nofollow noreferrer\">chart data</a>\nAnd the desired result:\n<a href=\"https://i.stack.imgur.com/OacGi.png\" rel=\"nofollow noreferrer\">sample chart</a></p>\n\n<p>Thanks in advance :)</p>\n"}, {"tags": ["vba", "excel", "copy-paste"], "comments": [{"owner": {"reputation": 659, "user_id": 5202456, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rHy4s.jpg?s=128&g=1", "display_name": "5202456", "link": "https://stackoverflow.com/users/5202456/5202456"}, "edited": false, "score": 1, "creation_date": 1524642306, "post_id": 50016619, "comment_id": 87049516, "body": "A quick internet search would give you the answer, but for your convenience, to turn off screen updating: Application.ScreenUpdating = False and to turn back on: Application.ScreenUpdating = True"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 1, "creation_date": 1524642457, "post_id": 50016619, "comment_id": 87049610, "body": "My sub procedures don&#39;t go <i>&#39;jumping around and copying loads of data which makes the screen go crazy&#39;</i>. If your &#39;macros&#39; do, read <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba/28700020\">How to avoid using Select in Excel VBA</a>."}, {"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 1, "creation_date": 1524643148, "post_id": 50016619, "comment_id": 87050045, "body": "If your macro is running and <code>jumping around</code>, I would throw up a modal form with text, something along the lines of: <b>Please wait, processing in progress...</b>. You don&#39;t want people updating a worksheet while its being updated anyway"}, {"owner": {"reputation": 873, "user_id": 5103224, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/d7d1ca72bbff93c0a014b5b770482a53?s=128&d=identicon&r=PG&f=1", "display_name": "Lowpar", "link": "https://stackoverflow.com/users/5103224/lowpar"}, "edited": false, "score": 0, "creation_date": 1524643395, "post_id": 50016619, "comment_id": 87050189, "body": "I found this one of the best explanations online, it is a function I use in all my macros - <a href=\"https://analystcave.com/excel-improve-vba-performance/\" rel=\"nofollow noreferrer\">analystcave.com/excel-improve-vba-performance</a>"}, {"owner": {"reputation": 15, "user_id": 9640911, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Ts1aRUveY7Q/AAAAAAAAAAI/AAAAAAAAAIY/8IhZCj-T-8E/photo.jpg?sz=128", "display_name": "DasGuy", "link": "https://stackoverflow.com/users/9640911/dasguy"}, "reply_to_user": {"reputation": 659, "user_id": 5202456, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rHy4s.jpg?s=128&g=1", "display_name": "5202456", "link": "https://stackoverflow.com/users/5202456/5202456"}, "edited": false, "score": 0, "creation_date": 1524645694, "post_id": 50016619, "comment_id": 87051526, "body": "@5202456 normally I don&#39;t have a problem googling stuff, but as english isn&#39;t my first language, explaining a problem to the search bar can sometimes prove quite difficult, thank you for your answer!"}, {"owner": {"reputation": 15, "user_id": 9640911, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Ts1aRUveY7Q/AAAAAAAAAAI/AAAAAAAAAIY/8IhZCj-T-8E/photo.jpg?sz=128", "display_name": "DasGuy", "link": "https://stackoverflow.com/users/9640911/dasguy"}, "edited": false, "score": 0, "creation_date": 1524645803, "post_id": 50016619, "comment_id": 87051586, "body": "@Jeeped I used Range(&quot;xy&quot;).copy and paste ;)"}], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 9640911, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Ts1aRUveY7Q/AAAAAAAAAAI/AAAAAAAAAIY/8IhZCj-T-8E/photo.jpg?sz=128", "display_name": "DasGuy", "link": "https://stackoverflow.com/users/9640911/dasguy"}, "edited": false, "score": 0, "creation_date": 1524645635, "post_id": 50016688, "comment_id": 87051489, "body": "Thank you for your answer!"}], "tags": [], "owner": {"reputation": 288, "user_id": 9691932, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-l-yvEHOFuLI/AAAAAAAAAAI/AAAAAAAAMUM/35Q4c5GZb20/photo.jpg?sz=128", "display_name": "CFO", "link": "https://stackoverflow.com/users/9691932/cfo"}, "is_accepted": true, "score": 3, "last_activity_date": 1524642470, "last_edit_date": 1524642470, "creation_date": 1524642322, "answer_id": 50016688, "question_id": 50016619, "link": "https://stackoverflow.com/questions/50016619/excel-vba-copy-paste-cells-without-user-noticing/50016688#50016688", "title": "excel vba copy paste cells without user noticing", "body": "<p>Use <code>application.screenupdating = false</code> at the start of the macro</p>\n\n<p>then <code>Application.Screenupdating = true</code> at the end, and the screen won't jump around.</p>\n\n<p>Also worth adding <code>Msgbox(\"The macro has finished!\")</code>  or something similar at the end so that they know it has done its thing.</p>\n"}, {"tags": [], "owner": {"reputation": 8753, "user_id": 185547, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/3iVy4.jpg?s=128&g=1", "display_name": "MikeD", "link": "https://stackoverflow.com/users/185547/miked"}, "is_accepted": false, "score": 1, "last_activity_date": 1524642684, "creation_date": 1524642684, "answer_id": 50016804, "question_id": 50016619, "link": "https://stackoverflow.com/questions/50016619/excel-vba-copy-paste-cells-without-user-noticing/50016804#50016804", "title": "excel vba copy paste cells without user noticing", "body": "<p>You have the following tools at hand to achieve your goals:</p>\n\n<ul>\n<li><code>Application.ScreenUpdating = False</code> ' turn off screen updating</li>\n</ul>\n\n<p>This will hide any screen updates until you turn it on again. If your application is jumping around with various <code>.Activate</code> etc. you may want to save the initial selection point before</p>\n\n<ul>\n<li>various event triggered Sub</li>\n</ul>\n\n<p>To start something \"in the background\" you may initiate it </p>\n\n<pre><code>Workbook.Open\nWorkbook.SheetActivate, Workbook.SheetDeactivate\nWorksheet.Activate, Worksheet.Deactivate\n' etc.\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "edited": false, "score": 1, "creation_date": 1524645257, "post_id": 50017122, "comment_id": 87051296, "body": "Or <code>Worksheets(&quot;sheet1&quot;).Range(&quot;J16&quot;).Copy Destination:=Worksheets(&quot;Sheet2&quot;).Range(&quot;I19&quot;)</code> if you want to copy formatting, etc, too"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 2, "last_activity_date": 1524643757, "creation_date": 1524643757, "answer_id": 50017122, "question_id": 50016619, "link": "https://stackoverflow.com/questions/50016619/excel-vba-copy-paste-cells-without-user-noticing/50017122#50017122", "title": "excel vba copy paste cells without user noticing", "body": "<p>I'm guessing your 'macro' looks like this.</p>\n\n<pre><code>Sub Macro1()\n    Sheets(\"Sheet1\").Select\n    ActiveWindow.SmallScroll Down:=4\n    Range(\"J16\").Select\n    Selection.Copy\n    Sheets(\"Sheet2\").Select\n    ActiveWindow.SmallScroll Down:=5\n    ActiveWindow.SmallScroll ToRight:=2\n    Range(\"I19\").Select\n    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n        :=False, Transpose:=False\n    Sheets(\"Sheet1\").Select\n    ActiveWindow.SmallScroll Down:=-72\n    Range(\"A1\").Select\nEnd Sub\n</code></pre>\n\n<p>It would be better if written like this.</p>\n\n<pre><code>Option Explicit\n\nSub Macro1()\n    With Worksheets(\"Sheet2\")\n        .Range(\"I19\") = Worksheets(\"sheet1\").Range(\"J16\").Value\n    End With\nEnd Sub\n</code></pre>\n\n<p>Learn more with <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba/28700020\">How to avoid using Select in Excel VBA.</a>.</p>\n"}], "owner": {"reputation": 15, "user_id": 9640911, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Ts1aRUveY7Q/AAAAAAAAAAI/AAAAAAAAAIY/8IhZCj-T-8E/photo.jpg?sz=128", "display_name": "DasGuy", "link": "https://stackoverflow.com/users/9640911/dasguy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1239, "favorite_count": 0, "accepted_answer_id": 50016688, "answer_count": 3, "score": 1, "last_activity_date": 1524643757, "creation_date": 1524642100, "question_id": 50016619, "link": "https://stackoverflow.com/questions/50016619/excel-vba-copy-paste-cells-without-user-noticing", "title": "excel vba copy paste cells without user noticing", "body": "<p>I have a macro which copies and pastes a lot of cells in a different worksheet. This works fine, my question is:</p>\n\n<p><strong>Is it possible to make the whole macro run in the background?</strong> </p>\n\n<p>As the macro will be used by inexperienced excel-users, I dont want them to see the macro jumping around and copying loads of data which makes the screen go crazy.</p>\n\n<p>Thanks for your answers in advance!</p>\n"}, {"tags": ["ms-access", "vba", "ms-access-2010"], "answers": [{"comments": [{"owner": {"reputation": 727, "user_id": 5810060, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/HKaa1.jpg?s=128&g=1", "display_name": "Raul Gonzales", "link": "https://stackoverflow.com/users/5810060/raul-gonzales"}, "edited": false, "score": 0, "creation_date": 1524670104, "post_id": 50019850, "comment_id": 87068323, "body": "that works converting text dates to proper dates but the cells in that column that contain strings turn into errors (#ERROR) so when i try to apply the filter it does not work"}, {"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "reply_to_user": {"reputation": 727, "user_id": 5810060, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/HKaa1.jpg?s=128&g=1", "display_name": "Raul Gonzales", "link": "https://stackoverflow.com/users/5810060/raul-gonzales"}, "edited": false, "score": 0, "creation_date": 1524728243, "post_id": 50019850, "comment_id": 87090779, "body": "No, #Error must be caused by something else. The query can&#39;t change the original field, <code>Date_Col</code>. A filter must be applied to field <code>TrueDate</code>."}], "tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": true, "score": 2, "last_activity_date": 1524651824, "creation_date": 1524651824, "answer_id": 50019850, "question_id": 50016451, "link": "https://stackoverflow.com/questions/50016451/filtering-date-column-that-contains-strings-as-well-in-ms-access/50019850#50019850", "title": "filtering date column that contains strings as well in MS Access", "body": "<p>You can use a query where you convert that text field to a true date value:</p>\n\n<pre><code>Select *, CDate([Date_Col]) As TrueDate\nFrom YourTable\nWhere IsDate([Date_Col])\n</code></pre>\n\n<p>Now, filter on field TrueDate as you like.</p>\n"}], "owner": {"reputation": 727, "user_id": 5810060, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/HKaa1.jpg?s=128&g=1", "display_name": "Raul Gonzales", "link": "https://stackoverflow.com/users/5810060/raul-gonzales"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 61, "favorite_count": 0, "accepted_answer_id": 50019850, "answer_count": 1, "score": 0, "last_activity_date": 1594635586, "creation_date": 1524641440, "last_edit_date": 1594635586, "question_id": 50016451, "link": "https://stackoverflow.com/questions/50016451/filtering-date-column-that-contains-strings-as-well-in-ms-access", "title": "filtering date column that contains strings as well in MS Access", "body": "<p>Good Day,\n i have an MS Access DB that has 1 column that contains dates and strings (in different cells). my question is if it is possible to filter by date as date while keeping the strings? the column looks like this:</p>\n\n<p><code>Date_Col\n 01/05/15\n 05/04/18\n Not Released\n 01/01/18\n Not Released</code></p>\n\n<p>this is data from hardware EOL so we need to keep the dates and the strings but we need to have the ability to filter or sort the dates as we wish.\nany help would be appreciated as right now when i am trying to filter the column is treating everything as text but if the column was in excel it will filter by date and ignore the strings cells.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1524640954, "post_id": 50016229, "comment_id": 87048735, "body": "The answer to your question is: <i>&quot;Yes, this is possible&quot;</i>. But because Stack Overflow is no free code writing service you will need to try it on your own first. Then come back with the code you tried and tell where you got errors or where you got stuck, and ask a question to that code."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 9695642, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/06678aeddde2eae3c462a4f0896eb2d8?s=128&d=identicon&r=PG&f=1", "display_name": "Matthew", "link": "https://stackoverflow.com/users/9695642/matthew"}, "edited": false, "score": 0, "creation_date": 1524646301, "post_id": 50017233, "comment_id": 87051924, "body": "Thanks alot Xabier. I appreciate your help. I have been doing this function for a few days. Once again, thank you."}], "tags": [], "owner": {"reputation": 7497, "user_id": 8670372, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ir8a4Lbosmo/AAAAAAAAAAI/AAAAAAAAOtE/2eY5jK1atcc/photo.jpg?sz=128", "display_name": "Xabier", "link": "https://stackoverflow.com/users/8670372/xabier"}, "is_accepted": true, "score": 3, "last_activity_date": 1524644095, "creation_date": 1524644095, "answer_id": 50017233, "question_id": 50016229, "link": "https://stackoverflow.com/questions/50016229/how-to-copy-and-paste-specific-range-n-times/50017233#50017233", "title": "How to copy and paste specific range n times?", "body": "<p>The following will copy your desired range then check for the next available empty row and paste the values there, it will loop and do this 15 times:</p>\n\n<pre><code>Sub foo()\nDim ws As Worksheet: Set ws = Sheets(\"Sheet1\")\n'declare and set your worksheet, amend as required\n\nws.Range(\"A2:X16\").Copy\n\nFor i = 1 To 15\n    NextRow = ws.Cells(ws.Rows.Count, \"A\").End(xlUp).Row + 1\n    'get the Next Empty Row\n    ws.Range(\"A\" &amp; NextRow).PasteSpecial xlPasteAll 'paste \nNext i\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 9695642, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/06678aeddde2eae3c462a4f0896eb2d8?s=128&d=identicon&r=PG&f=1", "display_name": "Matthew", "link": "https://stackoverflow.com/users/9695642/matthew"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1264, "favorite_count": 1, "accepted_answer_id": 50017233, "answer_count": 1, "score": -2, "last_activity_date": 1524644095, "creation_date": 1524640605, "last_edit_date": 1524643488, "question_id": 50016229, "link": "https://stackoverflow.com/questions/50016229/how-to-copy-and-paste-specific-range-n-times", "title": "How to copy and paste specific range n times?", "body": "<p>I am recently creating a macro button but I am facing difficulties in the interim.\n* 'x' represents a random value\nCurrent spreadsheet:</p>\n\n<pre><code> Col:     A ................. X\n Row 1  x x x x x x x x\n     2  x x x x x x x x\n     3  x x x x x x x x \n     .   x x x x x x x x \n     .   x x x x x x x x \n     .   x x x x x x x x \n     .   x x x x x x x x\n   16  x x x x x x x x\n   17  x x x x x x x x\n      .  x x x x x x x x\n      .  x x x x x x x x\n      .  x x x x x x x x \n      .  x x x x x x x x \n   31  x x x x x x x x \n</code></pre>\n\n<p>So basically in this case, I would like to copy the range \"A2:X16\" and paste it 15 times in total, right below row 16 . Afterwards, copying the original range \"A17 to X31\" and paste it for another 15 times in total. This process continues until all the range that I have specified has been copied 15 times in total. Is this possible? Thank you in advance.</p>\n"}, {"tags": ["sql", "vba", "ms-access"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 9630513, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b03ef2eba4ae4d901a3428b95928ae85?s=128&d=identicon&r=PG&f=1", "display_name": "Rob", "link": "https://stackoverflow.com/users/9630513/rob"}, "edited": false, "score": 0, "creation_date": 1524642910, "post_id": 50016770, "comment_id": 87049902, "body": "I can&#39;t try this yet, but it makes sense. Thanks!"}], "tags": [], "owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "is_accepted": true, "score": 1, "last_activity_date": 1524642576, "creation_date": 1524642576, "answer_id": 50016770, "question_id": 50016139, "link": "https://stackoverflow.com/questions/50016139/access-sql-get-the-identity-value-of-the-affected-record-from-an-insert-stateme/50016770#50016770", "title": "Access SQL: Get the identity value of the affected record from an insert statement Or From a DAO.QueryDef", "body": "<p>You need to use a single instance of your database, and then you can just use <code>OpenRecordset(\"SELECT @@IDENTITY\")</code> to obtain the identity value.</p>\n\n<pre><code>Dim db As DAO.Database\nSet db = CurrentDb\nSet qdf = db.QueryDefs(\"first_part_of_query\")\nqdf!New_id = userInput_newID\nqdf!oldID = userInput_oldID\nqdf.Execute\nSet qdf = db.QueryDefs(\"second_part_of_query\")\nqdf!New_id = db.OpenRecordset(\"SELECT @@IDENTITY\").Fields(0)\nqdf.Execute\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 9630513, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b03ef2eba4ae4d901a3428b95928ae85?s=128&d=identicon&r=PG&f=1", "display_name": "Rob", "link": "https://stackoverflow.com/users/9630513/rob"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 895, "favorite_count": 0, "accepted_answer_id": 50016770, "answer_count": 1, "score": 0, "last_activity_date": 1524642576, "creation_date": 1524640288, "last_edit_date": 1524641607, "question_id": 50016139, "link": "https://stackoverflow.com/questions/50016139/access-sql-get-the-identity-value-of-the-affected-record-from-an-insert-stateme", "title": "Access SQL: Get the identity value of the affected record from an insert statement Or From a DAO.QueryDef", "body": "<p>I have to convert some SQL queries to access SQL. Some of them use @@identity to insert two linked records into two different tables. Unfortunately, an access query can only contain one statement(i.e. I can not select @@identity after the insert statement). </p>\n\n<p>This is not possible:</p>\n\n<pre><code>insert into table1 (values)\n  select values from table1 where id=@id;\nselect @@identity;\n</code></pre>\n\n<p>This example statement is supposed to Copy a record from Table1 to a new record in the said table and then do the same in Table2, referencing the new record from Table1.</p>\n\n<p>Here's what the sql query looks like:</p>\n\n<pre><code>        INSERT INTO Table1 ( some_value, the_other_values)\n        SELECT  @new_value as some_value, the_other_values\n        FROM    Table1\n        WHERE   id = @oldID\n\n        SELECT @New_id = @@identity\n\n        INSERT INTO     Table2 ( idP, other_values)\n            SELECT  @New_id AS idP, other_values\n            FROM    Table2\n            WHERE   (idP = @Old_id)\n</code></pre>\n\n<p>I tried to do this in two statements, using vba, but I have found no way to access @@identity from the other query. </p>\n\n<p>Here's the vba - I omitted the declarations, the actual code is a loop but this is the important part:</p>\n\n<pre><code>Set qdf = CurrentDb.QueryDefs(\"first_part_of_query\")\n        qdf!New_id = userInput_newID\n        qdf!oldID = userInput_oldID\n        qdf.Execute\n        Set qdf = CurrentDb.QueryDefs(\"second_part_of_query\")\n        qdf!New_id = the_identityvalue 'WHAT DO I SET THIS TO?\n        qdf.Execute\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 873, "user_id": 5103224, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/d7d1ca72bbff93c0a014b5b770482a53?s=128&d=identicon&r=PG&f=1", "display_name": "Lowpar", "link": "https://stackoverflow.com/users/5103224/lowpar"}, "edited": false, "score": 0, "creation_date": 1524642473, "post_id": 50015891, "comment_id": 87049623, "body": "Could you not just keep the Streckkod use For c = 9 To 10 and remove the second &#39;&#229;terl&#228;mningsdatum part?"}, {"owner": {"reputation": 115, "user_id": 5040794, "user_type": "registered", "accept_rate": 93, "profile_image": "https://graph.facebook.com/10205493559873072/picture?type=large", "display_name": "Klas Blomberg", "link": "https://stackoverflow.com/users/5040794/klas-blomberg"}, "reply_to_user": {"reputation": 873, "user_id": 5103224, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/d7d1ca72bbff93c0a014b5b770482a53?s=128&d=identicon&r=PG&f=1", "display_name": "Lowpar", "link": "https://stackoverflow.com/users/5103224/lowpar"}, "edited": false, "score": 0, "creation_date": 1524813115, "post_id": 50015891, "comment_id": 87130687, "body": "That would give a cleaner code for the first loop, but not affect the following instances"}], "owner": {"reputation": 115, "user_id": 5040794, "user_type": "registered", "accept_rate": 93, "profile_image": "https://graph.facebook.com/10205493559873072/picture?type=large", "display_name": "Klas Blomberg", "link": "https://stackoverflow.com/users/5040794/klas-blomberg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 48, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1524639428, "creation_date": 1524639428, "last_edit_date": 1531164843, "question_id": 50015891, "link": "https://stackoverflow.com/questions/50015891/excel-macro-formats-only-the-first-instance-of-a-repeated-value", "title": "Excel macro formats only the first instance of a repeated value", "body": "<p>I have an Excel makro that looks like this</p>\n\n<p>I expected it to format and left align all instances of <em>Streckkod</em> and <em>\u00c5terl\u00e4mningsdatum</em>, but it only works for the forst occurrence. What am I doing wrong?</p>\n\n<p>I'm just a copy-paste programmer and this is the second time I have tried to do something with vba, so any help will be appreciated</p>\n\n<pre><code>Sub Transform()\n    Dim wshS As Worksheet\n    Dim wshT As Worksheet\n    Dim s As Long\n    Dim m As Long\n    Dim t As Long\n    Dim c As Long\n    Dim d As Double\n    Application.ScreenUpdating = False\n    Set wshS = ActiveSheet\n    wshS.Range(\"A1\").CurrentRegion.Sort Key1:=wshS.Range(\"A1\"), Header:=xlYes\n    m = wshS.Range(\"A\" &amp; wshS.Rows.Count).End(xlUp).Row\n    For s = 2 To m\n        If s &gt; 2 Then\n            t = t + 2\n            wshT.Cells(t, 1).Value = \"total price\"\n            wshT.Cells(t, 2).Value = d\n        End If\n        If wshS.Range(\"A\" &amp; s).Value &lt;&gt; wshS.Range(\"A\" &amp; s - 1).Value Then\n            Set wshT = Worksheets.Add(After:=Worksheets(Worksheets.Count))\n            For c = 1 To 1\n                wshT.Cells(c, 1).Value = wshS.Cells(1, c).Value\n                wshT.Cells(c, 2).Value = wshS.Cells(s, c).Value\n                wshT.Cells(c, 2).NumberFormat = \"0000000000\"\n                wshT.Cells(c, 2).HorizontalAlignment = xlLeft\n                'Personnummer\n            Next c\n            t = 1\n            d = 0\n\n            For c = 2 To 5\n                wshT.Cells(c, 1).Value = wshS.Cells(1, c).Value\n                wshT.Cells(c, 2).Value = wshS.Cells(s, c).Value\n            Next c\n            t = 5\n            d = 0\n        End If\n\n        t = t + 1\n        For c = 6 To 8\n            t = t + 1\n            wshT.Cells(t, 1).Value = wshS.Cells(1, c).Value\n            wshT.Cells(t, 2).Value = wshS.Cells(s, c).Value\n            wshT.Cells(c, 1).EntireColumn.AutoFit\n            wshT.Cells(c, 2).EntireColumn.AutoFit\n        Next c\n\n        For c = 9 To 9\n            t = t + 1\n            wshT.Cells(t, 1).Value = wshS.Cells(1, c).Value\n            wshT.Cells(t, 2).Value = wshS.Cells(s, c).Value\n            wshT.Cells(c, 2).NumberFormat = \"0000000000000\"\n            wshT.Cells(c, 2).HorizontalAlignment = xlLeft\n            'Streckkod\n\n        Next c\n\n        For c = 10 To 10\n            t = t + 1\n            wshT.Cells(t, 1).Value = wshS.Cells(1, c).Value\n            wshT.Cells(t, 2).Value = wshS.Cells(s, c).Value\n            wshT.Cells(c, 2).NumberFormat = \"yyyy-mm-dd\"\n            wshT.Cells(c, 2).HorizontalAlignment = xlLeft\n            '\u00e5terl\u00e4mningsdatum\n\n        Next c\n\n\n        d = d + wshS.Cells(s, 10).Value\n    Next s\n\n\n\n    ' Last total\n    t = t + 2\n    wshT.Cells(t, 1).Value = \"total price\"\n    wshT.Cells(t, 2).Value = d\n\n\n    Application.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/GyL3c.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/GyL3c.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["vba", "excel", "excel-2016"], "answers": [{"comments": [{"owner": {"reputation": 6200, "user_id": 7923463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8063a07902a59be5f26d31626600dee?s=128&d=identicon&r=PG&f=1", "display_name": "Kostas K.", "link": "https://stackoverflow.com/users/7923463/kostas-k"}, "edited": false, "score": 0, "creation_date": 1524639786, "post_id": 50015964, "comment_id": 87048130, "body": "I would add a <code>DoEvents</code> statement to avoid locking down the workbook in case user interaction needed."}, {"owner": {"reputation": 167, "user_id": 9484672, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5cUCy.jpg?s=128&g=1", "display_name": "iskbaloch", "link": "https://stackoverflow.com/users/9484672/iskbaloch"}, "edited": false, "score": 0, "creation_date": 1524640080, "post_id": 50015964, "comment_id": 87048282, "body": "It seems not working. I have written this code above END SUB. Please help"}, {"owner": {"reputation": 6200, "user_id": 7923463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8063a07902a59be5f26d31626600dee?s=128&d=identicon&r=PG&f=1", "display_name": "Kostas K.", "link": "https://stackoverflow.com/users/7923463/kostas-k"}, "reply_to_user": {"reputation": 167, "user_id": 9484672, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5cUCy.jpg?s=128&g=1", "display_name": "iskbaloch", "link": "https://stackoverflow.com/users/9484672/iskbaloch"}, "edited": false, "score": 0, "creation_date": 1524640768, "post_id": 50015964, "comment_id": 87048632, "body": "@S.K.Baloch Make a new sub, copy the above code into it and call the new sub from the <code>CommandButton1_Click()</code>."}], "tags": [], "owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "is_accepted": false, "score": 1, "last_activity_date": 1524639690, "creation_date": 1524639690, "answer_id": 50015964, "question_id": 50015806, "link": "https://stackoverflow.com/questions/50015806/how-to-repeat-commandbutton1-execution-until-the-condition-is-met/50015964#50015964", "title": "How to repeat CommandButton1 execution until the condition is met?", "body": "<p>as per your own words</p>\n\n<pre><code>Do Until Range(\"D1\").Value = 0\n    If Range(\"D1\").Value &lt; 362 Then\n\n        Range(\"C1\").Value = Range(\"C1\").Value + 7\n        Range(\"D1\").Value = Range(\"D1\").Value + 7\n\n    Else\n        Range(\"C1\").Value = Range(\"F2\").Value\n        Range(\"D1\").Value = 0        \n    End If\nLoop\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 28228, "user_id": 7132550, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/1063981417044495/picture?type=large", "display_name": "Micha\u0142 Turczyn", "link": "https://stackoverflow.com/users/7132550/micha%c5%82-turczyn"}, "is_accepted": true, "score": 2, "last_activity_date": 1524641180, "last_edit_date": 1524641180, "creation_date": 1524640530, "answer_id": 50016196, "question_id": 50015806, "link": "https://stackoverflow.com/questions/50015806/how-to-repeat-commandbutton1-execution-until-the-condition-is-met/50016196#50016196", "title": "How to repeat CommandButton1 execution until the condition is met?", "body": "<p>I think you would need wrap your entire body of <code>CommandButton1_Click</code> method in a <code>Do While ... Loop</code>.</p>\n\n<p>So transform:</p>\n\n<pre><code>Sub CommandButton1_Click()\n    'body\nEnd Sub\n</code></pre>\n\n<p>to</p>\n\n<pre><code>Sub CommandButton1_Click()\n    Do While Range(\"D1\").Value &lt;&gt; 0\n        'body\n    Loop\nEnd Sub\n</code></pre>\n\n<p>Or you could be more elegant:</p>\n\n<pre><code>Sub SomeSub()\n    'your CommandButton1_Click current body\nEnd Sub\n\nSub CommandButton1_Click()\n    Do While Range(\"D1\").Value &lt;&gt; 0\n        SomeSub\n    Loop\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 167, "user_id": 9484672, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5cUCy.jpg?s=128&g=1", "display_name": "iskbaloch", "link": "https://stackoverflow.com/users/9484672/iskbaloch"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 43, "favorite_count": 0, "accepted_answer_id": 50016196, "answer_count": 2, "score": 1, "last_activity_date": 1524641180, "creation_date": 1524639147, "last_edit_date": 1531164843, "question_id": 50015806, "link": "https://stackoverflow.com/questions/50015806/how-to-repeat-commandbutton1-execution-until-the-condition-is-met", "title": "How to repeat CommandButton1 execution until the condition is met?", "body": "<p>I have a Excel VBA code executed by CommandButton1_Click. Following are conditions I have inserted at the end of my VBA code.</p>\n\n<pre><code>If Range(\"D1\").Value &lt; 362 Then\n    Range(\"C1\").Value = Range(\"C1\").Value + 7\n    Range(\"D1\").Value = Range(\"D1\").Value + 7   \nElse\n    Range(\"C1\").Value = Range(\"F2\").Value\n    Range(\"D1\").Value = 0    \nEnd If\n</code></pre>\n\n<p>I want to repeat CommandButton1_Click action until Range(\"D1\").Value is turned to Zero again. Please help.</p>\n"}, {"tags": ["vba", "excel", "outlook"], "comments": [{"owner": {"reputation": 2549, "user_id": 823321, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lrwbB.png?s=128&g=1", "display_name": "s\u0250un\u0131\u0254\u05df\u0250q\u0250p", "link": "https://stackoverflow.com/users/823321/s%c9%90un%c4%b1%c9%94%d7%9f%c9%90q%c9%90p"}, "edited": false, "score": 0, "creation_date": 1524638131, "post_id": 50015376, "comment_id": 87047251, "body": "Take a look at this one (possibly a duplicate): <a href=\"https://stackoverflow.com/questions/23132044/excel-save-data-into-different-workbook-vba\" title=\"excel save data into different workbook vba\">stackoverflow.com/questions/23132044/&hellip;</a>"}, {"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1524638307, "post_id": 50015376, "comment_id": 87047350, "body": "<a href=\"https://stackoverflow.com/a/34886033/4539709\">stackoverflow.com/a/34886033/4539709</a>"}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 7213942, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MfgJi.jpg?s=128&g=1", "display_name": "Mert Dogan", "link": "https://stackoverflow.com/users/7213942/mert-dogan"}, "edited": false, "score": 0, "creation_date": 1524644391, "post_id": 50015793, "comment_id": 87050779, "body": "Hi Early, Thanks a lot!  Could you please tell where exactly i need to put these codes?  Sorry for being low level knowledge! :)"}, {"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1524645395, "post_id": 50015793, "comment_id": 87051361, "body": "The way you have declared your <code>Workbook</code> means that only <code>wbTheOneToSaveTo</code> would be declared as a workbook. <code>wbThisWorkbook</code> would be declared as a <code>Variant</code> type. Also, it&#39;s poor coding practice to use things like <code>.Activate</code> and <code>.Select</code> in Excel VBA. As you already have the workbook object, you don&#39;t need to <code>Activate</code> the workbook"}, {"owner": {"reputation": 276, "user_id": 9379711, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KdliM.jpg?s=128&g=1", "display_name": "EarlyBird2", "link": "https://stackoverflow.com/users/9379711/earlybird2"}, "edited": false, "score": 0, "creation_date": 1524645881, "post_id": 50015793, "comment_id": 87051637, "body": "Add the two declarations just below the &quot;On Error&quot; statement and, as Zac critizised, do it separately, so two entries. Add the rest above the &quot;Cancel:&quot; mark, and you may leave out the Activate statement."}], "tags": [], "owner": {"reputation": 276, "user_id": 9379711, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KdliM.jpg?s=128&g=1", "display_name": "EarlyBird2", "link": "https://stackoverflow.com/users/9379711/earlybird2"}, "is_accepted": false, "score": 0, "last_activity_date": 1524639087, "creation_date": 1524639087, "answer_id": 50015793, "question_id": 50015376, "link": "https://stackoverflow.com/questions/50015376/writing-values-of-cells-into-another-excel-in-vba/50015793#50015793", "title": "Writing Values Of Cells Into Another Excel In VBA", "body": "<p>Mert,</p>\n\n<p>Try the following, add these two lines at the beginning of your code:</p>\n\n<pre><code>Dim wbThisWorkbook, wbTheOneToSaveTo As Workbook\nSet wbThisWorkbook = Workbooks(\"TheNameOfYourCurrentWorkbook\")\n</code></pre>\n\n<p>Then after your sending routine, add this:</p>\n\n<pre><code>Set wbTheOneToSaveTo = Workbooks.Open (\"C:\\Users\\Computername\\Desktop\\Savingdata.xlsx\")\nwbThisWorkbook.Sheets(\"TheNameOfThe Worksheet\").Range(\"A2\").Copy\nwbTheOneToSaveTo.Sheets(\"TheNameOfTheWorksheet\").Range(\"B15\").PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=False  'adjust parameters according to your needs\nwbTheOneToSaveTo.Close True\nwbThisWorkbook.Activate\n</code></pre>\n\n<p>Hope this helps!</p>\n"}], "owner": {"reputation": 21, "user_id": 7213942, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MfgJi.jpg?s=128&g=1", "display_name": "Mert Dogan", "link": "https://stackoverflow.com/users/7213942/mert-dogan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 60, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1524639087, "creation_date": 1524637643, "last_edit_date": 1524637682, "question_id": 50015376, "link": "https://stackoverflow.com/questions/50015376/writing-values-of-cells-into-another-excel-in-vba", "title": "Writing Values Of Cells Into Another Excel In VBA", "body": "<p>I have this code to send e-mail with attached via Outlook:</p>\n\n<pre><code>Sub AutoEmail()\n    On Error GoTo Cancel\n\n    Dim Resp As Integer\n    Resp = MsgBox(prompt:=vbCr &amp; \"Yes = Review Email\" &amp; vbCr &amp; \"No = Immediately Send\" &amp; vbCr &amp; \"Cancel = Cancel\" &amp; vbCr, _\n    Title:=\"Review email before sending?\", _\n    Buttons:=3 + 32)\n\n    Select Case Resp\n\n        'Yes was clicked, user wants to review email first\n        Case Is = 6\n            Dim myOutlook As Object\n            Dim myMailItem As Object\n\n            Set otlApp = CreateObject(\"Outlook.Application\")\n            Set otlNewMail = otlApp.CreateItem(olMailItem)\n            FName = Application.ActiveWorkbook.FullName\n\n            With otlNewMail\n            .To = Cells(33, 10)\n            .CC = Cells(1, 1)\n            .Subject = Cells(23, 10) &amp; \": \" &amp; Cells(21, 10)\n            .Body = \"Good morning\" &amp; vbCr &amp; vbCr &amp; \"\" &amp; Cells(23, 10) &amp; \".\"\n            .Attachments.Add FName\n            .Display\n\n            End With\n\n\n            Set otlNewMail = Nothing\n            Set otlApp = Nothing\n            Set otlAttach = Nothing\n            Set otlMess = Nothing\n            Set otlNSpace = Nothing\n\n\n        'If no is clicked\n        Case Is = 7\n            Dim myOutlok As Object\n            Dim myMailItm As Object\n\n            Set otlApp = CreateObject(\"Outlook.Application\")\n            Set otlNewMail = otlApp.CreateItem(olMailItem)\n            FName = ActiveWorkbook.Path &amp; \"\\\" &amp; ActiveWorkbook.Name\n\n            With otlNewMail\n            .To = \"\"\n            .CC = \"\"\n            .Subject = \"\"\n            .Body = \"Good Morning,\" &amp; vbCr &amp; vbCr &amp; \" \" &amp; Format(Date, \"MM/DD\") &amp; \".\"\n            .Attachments.Add FName\n            .Send\n            '.Display\n            'Application.Wait (Now + TimeValue(\"0:00:01\"))\n            'Application.SendKeys \"%s\"\n\n            End With\n\n            'otlApp.Quit\n\n            Set otlNewMail = Nothing\n            Set otlApp = Nothing\n            Set otlAttach = Nothing\n            Set otlMess = Nothing\n            Set otlNSpace = Nothing\n        'If Cancel is clicked\n        Case Is = 2\nCancel:\n            MsgBox prompt:=\"No Email has been sent.\", _\n            Title:=\"EMAIL CANCELLED\", _\n            Buttons:=64\n\n    End Select\n\nEnd Sub\n</code></pre>\n\n<p>However there is another thing that i want to add. I want to write some cells into another excel after sending e-mail via Outlook, lets say A2 to B15. The excel file which i want to write on is in C:\\Users\\Computername\\Desktop\\Savingdata.xlsx</p>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 6200, "user_id": 7923463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8063a07902a59be5f26d31626600dee?s=128&d=identicon&r=PG&f=1", "display_name": "Kostas K.", "link": "https://stackoverflow.com/users/7923463/kostas-k"}, "edited": false, "score": 2, "creation_date": 1524637511, "post_id": 50015025, "comment_id": 87046888, "body": "Have you tried <code>[FieldTwo] Is Null</code>?"}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1524638228, "post_id": 50015025, "comment_id": 87047302, "body": "Try building your criteria with <code>BuildCriteria</code>: <a href=\"https://stackoverflow.com/a/224961/3820271\">stackoverflow.com/a/224961/3820271</a> or <a href=\"https://stackoverflow.com/a/49198954/3820271\">stackoverflow.com/a/49198954/3820271</a>"}, {"owner": {"reputation": 3207, "user_id": 360480, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/HmpV7.jpg?s=128&g=1", "display_name": "J&#246;rg Brenninkmeyer", "link": "https://stackoverflow.com/users/360480/j%c3%b6rg-brenninkmeyer"}, "edited": false, "score": 0, "creation_date": 1524643829, "post_id": 50015025, "comment_id": 87050456, "body": "Would it be an option to use the <a href=\"https://support.office.com/en-us/article/nz-function-8ef85549-cc9c-438b-860a-7fd9f4c69b6c?ui=en-US&amp;rs=en-US&amp;ad=US\" rel=\"nofollow noreferrer\">Nz function</a>? It turns Null into empty Strings by default and can be used in SQL statements as well, so I guess it would also work with the above criteria. E.g. &quot;Nz(FieldTwo) = &#39;&quot; &amp; Nz(Me.textBoxTwo) &amp; &quot;&#39;&quot;, then the Field value as well as the Textbox value could be either empty strings or Null."}], "answers": [{"tags": [], "owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "is_accepted": true, "score": 1, "last_activity_date": 1524639699, "creation_date": 1524639699, "answer_id": 50015968, "question_id": 50015025, "link": "https://stackoverflow.com/questions/50015025/how-to-find-a-record-with-an-empty-field-value-using-vba-in-access/50015968#50015968", "title": "How to find a record with an empty field value using VBA in Access?", "body": "<p><code>Null</code> is not the same as an empty string. Your <em>\"empty\"</em> field likely is <code>Null</code>, and comparing <code>Null</code> to any string resuts in <code>Null</code>, which gets parsed as <code>False</code>.</p>\n\n<p>While you can add some logic to check if your form field is null or an empty string, and then use <code>Is Null</code> in the condition, like KostasK suggests, there's a simple workaround: just concatenate an zero-length string to your field. That will cause Null values to become zero-length strings, making them pass the comparison:</p>\n\n<pre><code>crit = \"FieldOne = '\" &amp; Me.textBoxOne &amp; \"' And \" &amp; _\n       \"FielTwo &amp; '' = '\" &amp; Me.textBoxTwo &amp; \"'\"\n</code></pre>\n\n<p>Note that this will invalidate any indexes, which might lead to performance issues in very select situations.</p>\n"}], "owner": {"reputation": 3393, "user_id": 2373410, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/684a479ecdc16beb9c6ddd01073f2fee?s=128&d=identicon&r=PG", "display_name": "Pangu", "link": "https://stackoverflow.com/users/2373410/pangu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 547, "favorite_count": 0, "accepted_answer_id": 50015968, "answer_count": 1, "score": 0, "last_activity_date": 1594635607, "creation_date": 1524636148, "last_edit_date": 1594635607, "question_id": 50015025, "link": "https://stackoverflow.com/questions/50015025/how-to-find-a-record-with-an-empty-field-value-using-vba-in-access", "title": "How to find a record with an empty field value using VBA in Access?", "body": "<p>I'm a bit confused on how exactly VBA views empty field values in a table/datasheet because I'm trying to use <code>Recordset.FindFirst</code> method to locate a record within my datasheet, but if the record contains a field that is empty, it cannot locate the record.</p>\n\n<p>For example, here's what my table may look like:</p>\n\n<pre><code>FieldOne   FieldTwo\n123        SomeName1\n456        \n789        SomeName2\n</code></pre>\n\n<p>For record <code>456</code>, the value in <code>FieldTwo</code> is empty. The datatype for <code>FieldOne</code> and <code>FieldTwo</code> is a <strong>Short Text</strong>.</p>\n\n<p>Assume <code>myDatasheet</code> is linked to the above table with those mentioned records.</p>\n\n<p>I attempt to find the record <code>123</code> like so:</p>\n\n<pre><code>Dim crit As String\ncrit = \"FieldOne = '\" &amp; Me.textBoxOne &amp; \"' And \" &amp; _\n       \"FielTwo = '\" &amp; Me.textBoxTwo &amp; \"'\"\n\nWith myDatasheet.Form\n    .RecordsetClone.FindFirst crit \n\n    If Not .RecordsetClone.NoMatch Then\n        MsgBox \"FOUND\"\n    Else\n        MsgBox \"NOT FOUND\"\n    End If\nEnd With  \n</code></pre>\n\n<p>Where the value in <code>Me.textBoxOne</code> is <code>123</code> and in <code>Me.textBoxTwo</code> is <code>SomeName1</code> and I get a <code>FOUND</code>.</p>\n\n<p>However, if I try to find record <code>456</code> using <code>Me.textBoxOne</code> as <code>456</code> and <code>Me.textBoxTwo</code> as <code>\"\"</code>, I get a <code>NOT FOUND</code>.</p>\n\n<p>There's got to be something syntactically wrong with my code. What should the correct criteria be?</p>\n\n<p>Thanks.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1524636252, "post_id": 50015006, "comment_id": 87046255, "body": "You need to make sure <code>Sub Send_Mail</code> is located in a regular code module, and not a worksheet module, that way it is accessible"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6632933"}, "edited": false, "score": 0, "creation_date": 1524636554, "post_id": 50015006, "comment_id": 87046387, "body": "Can you please show more of your codes? And what do you mean with this one: <code>When I click the CommandButton in Sheet2 I want that the Button in Sheet1 will run</code>, you mean the function assigned to button 1?"}, {"owner": {"reputation": 361, "user_id": 7750399, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/03ef02687a1c76445f99f533230a1184?s=128&d=identicon&r=PG&f=1", "display_name": "diem_L", "link": "https://stackoverflow.com/users/7750399/diem-l"}, "edited": false, "score": 0, "creation_date": 1524636983, "post_id": 50015006, "comment_id": 87046600, "body": "I went to &quot;Create Macro&quot; paste the code from Send_Mail to it. Saved it as Send_Mail .. but still the same error"}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user6632933"}, "edited": false, "score": 2, "creation_date": 1524636795, "post_id": 50015152, "comment_id": 87046508, "body": "Or <code>Sheet1.Send_Mail</code>?"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 1, "last_activity_date": 1524636704, "creation_date": 1524636704, "answer_id": 50015152, "question_id": 50015006, "link": "https://stackoverflow.com/questions/50015006/excel-vba-define-sub-or-function/50015152#50015152", "title": "EXCEL VBA - Define Sub or Function", "body": "<p>I don't know what the underlying sub procedure attached to the Sheet1 button has been named but it is likely it has a similar name.</p>\n\n<pre><code>'Sheet2's button sub procedure\nPrivate Sub CommandButton1_Click()\n    Call Sheet1.CommandButton1_Click\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 361, "user_id": 7750399, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/03ef02687a1c76445f99f533230a1184?s=128&d=identicon&r=PG&f=1", "display_name": "diem_L", "link": "https://stackoverflow.com/users/7750399/diem-l"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 248, "favorite_count": 0, "accepted_answer_id": 50015152, "answer_count": 1, "score": 1, "last_activity_date": 1524637174, "creation_date": 1524636075, "last_edit_date": 1524637174, "question_id": 50015006, "link": "https://stackoverflow.com/questions/50015006/excel-vba-define-sub-or-function", "title": "EXCEL VBA - Define Sub or Function", "body": "<p>How can I define a sub or function in VBA?</p>\n\n<p>This is my code:</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n    Call Send_Mail\nEnd Sub\n</code></pre>\n\n<p>In Worksheet \"Sheet1\" I have a <code>CommandButton</code> called <strong>Send_Mail</strong> and in \"Sheet2\" I have also a <code>CommandButton</code>. When I click the <code>CommandButton</code> in Sheet2 I want that the Button in Sheet1 will run.</p>\n\n<p>With my code the : error \"Sub or Function is not defined\" appears. </p>\n\n<p><strong>EDIT:</strong></p>\n\n<p>Code for Send_Mail:</p>\n\n<pre><code>Public Sub Send_Mail_Click()\n    Dim OutApp As Object\n    Dim OutMail As Object\n    Dim nameList As String\n    Set OutApp = CreateObject(\"Outlook.Application\")\n    Set OutMail = OutApp.CreateItem(0)\n    On Error GoTo cleanup\n\n    For i = 4 To 22                                                                         \n        If Range(\"B4\").Value &lt;&gt; \"\" Then                                                        \n            nameList = nameList &amp; \";\" &amp; Range(\"C\" &amp; i).Value\n        End If\n    Next\n        With OutMail\n            .To = nameList\n            .Subject = \"Subject Line\"\n            .Body = \"Body Text\"\n            .Send\n        End With\ncleanup:\n    Set OutApp = Nothing\n    MsgBox \"E-Mail sent.\"\n    MsgBox Err.Description\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "web-scraping", "vba"], "comments": [{"owner": {"reputation": 19801, "user_id": 9189799, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/U2hEg.jpg?s=128&g=1", "display_name": "SIM", "link": "https://stackoverflow.com/users/9189799/sim"}, "edited": false, "score": 0, "creation_date": 1524638216, "post_id": 50014862, "comment_id": 87047295, "body": "Why did you add this <code>web-scraping</code> tag in your post? I can&#39;t see any <code>URL</code> within your script really."}], "answers": [{"comments": [{"owner": {"reputation": 207, "user_id": 7180194, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/tnExZ.jpg?s=128&g=1", "display_name": "MITHU", "link": "https://stackoverflow.com/users/7180194/mithu"}, "edited": false, "score": 0, "creation_date": 1524645504, "post_id": 50017354, "comment_id": 87051415, "body": "This line <code>Do Until xHttp.READYSTATE = 4 : DoEvents : Loop</code> doesn&#39;t make any sense when you send any request using <code>xmlhttp</code>."}, {"owner": {"reputation": 1, "user_id": 9694648, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b7884989983ad2501cb220ec51f12aa6?s=128&d=identicon&r=PG&f=1", "display_name": "Anon78898", "link": "https://stackoverflow.com/users/9694648/anon78898"}, "edited": false, "score": 0, "creation_date": 1524654387, "post_id": 50017354, "comment_id": 87057013, "body": "Thank you!. Is there something I need to preface this with? I keep getting a user type not defined error. Thanks again for the help."}, {"owner": {"reputation": 19801, "user_id": 9189799, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/U2hEg.jpg?s=128&g=1", "display_name": "SIM", "link": "https://stackoverflow.com/users/9189799/sim"}, "edited": false, "score": 0, "creation_date": 1524684531, "post_id": 50017354, "comment_id": 87076068, "body": "Add reference to <code>Microsoft XML, V6.0</code> before running the script."}], "tags": [], "owner": {"reputation": 276, "user_id": 9379711, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KdliM.jpg?s=128&g=1", "display_name": "EarlyBird2", "link": "https://stackoverflow.com/users/9379711/earlybird2"}, "is_accepted": false, "score": 1, "last_activity_date": 1524644908, "last_edit_date": 1524644908, "creation_date": 1524644484, "answer_id": 50017354, "question_id": 50014862, "link": "https://stackoverflow.com/questions/50014862/438-error-vba-excel-scraping-from-hyperlinks/50017354#50017354", "title": "438 error VBA excel scraping from hyperlinks", "body": "<p>Do you really need the IE to do the job? Maybe better try HTTP request?</p>\n\n<pre><code>Dim xHttp As MSXML2.XMLHTTP\nDim hDoc As MSHTML.HTMLDocument\n\nSet rRng = Sheet1.Range(\"A1:A\" &amp; LastRow)\n\nFor Each rCell In rRng.Cells\n    Set xHttp = New MSXML2.XMLHTTP\n    xHttp.Open \"GET\", rCell.Value\n    xHttp.setRequestHeader \"Content-Type\", \"application/x-www-form-urlencoded\"\n    xHttp.send\n\n    Do Until xHttp.READYSTATE = 4\n        DoEvents\n    Loop\n\n    If xHttp.Status = 200 Then\n        rCell.Offset(0, 1).Value = xHttp.responseText\n    End If\nNext rCell\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 9694648, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b7884989983ad2501cb220ec51f12aa6?s=128&d=identicon&r=PG&f=1", "display_name": "Anon78898", "link": "https://stackoverflow.com/users/9694648/anon78898"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 152, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1524644908, "creation_date": 1524635400, "last_edit_date": 1531164843, "question_id": 50014862, "link": "https://stackoverflow.com/questions/50014862/438-error-vba-excel-scraping-from-hyperlinks", "title": "438 error VBA excel scraping from hyperlinks", "body": "<p>I have the below code, as I am trying to scrape the text from some webpages. Currently I have the excel set up such that I put in a hyperlink in column A, and it cycles through and pulls all the text from the web page into excel. However, I keep getting a </p>\n\n<blockquote>\n  <p>438 error </p>\n</blockquote>\n\n<p>on the <code>ie.document.body.innertext</code> line. </p>\n\n<p>Does anyone know why this may be happening? I have searched around a fair bit, but I have not had much success as it seems this is a fairly common problem but with many different causes. Any help would be greatly appreciated, and apologies in advance for anything obvious, as I am rather new to VBA. </p>\n\n<pre><code>Sub Sample()\nDim ie As Object\nDim retStr As String\nDim sht As Worksheet\nDim LastRow As Long\nDim rCell As Range\nDim rRng As Range\n\nSet sht = ThisWorkbook.Worksheets(\"Sheet1\")\n\n'Ctrl + Shift + End\nLastRow = sht.Cells(sht.Rows.Count, \"A\").End(xlUp).Row\n\nSet ie = CreateObject(\"internetexplorer.application\")\n\n\nSet rRng = Sheet1.Range(\"A1:A\" &amp; LastRow)\n\nFor Each rCell In rRng.Cells\n\n        With ie\n            .Navigate rCell.Value\n            .Visible = True\n        End With\n\n        Do While ie.readystate &lt;&gt; 4: Wait 5: Loop\n        DoEvents\n\n        rCell.Offset(0, 1).Value = ie.document.body.innerText\nNext rCell\n\nEnd Sub\n\nPrivate Sub Wait(ByVal nSec As Long)\nnSec = nSec + Timer\nWhile nSec &gt; Timer\n    DoEvents\nWend\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "outlook", "vba"], "answers": [{"comments": [{"owner": {"reputation": 69, "user_id": 7614408, "user_type": "registered", "profile_image": "https://graph.facebook.com/10206878705726602/picture?type=large", "display_name": "Ruzaini Subri", "link": "https://stackoverflow.com/users/7614408/ruzaini-subri"}, "edited": false, "score": 0, "creation_date": 1524735835, "post_id": 50016364, "comment_id": 87095521, "body": "thank you for your help and trying with filter method. Can you help how to move next ID if current ID in support column is empty"}], "tags": [], "owner": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "is_accepted": false, "score": 0, "last_activity_date": 1524641115, "creation_date": 1524641115, "answer_id": 50016364, "question_id": 50013713, "link": "https://stackoverflow.com/questions/50013713/send-auto-email-with-duplicate-word-id/50016364#50016364", "title": "Send Auto Email with duplicate Word/ID", "body": "<p>There are several ways to do this - I assume that you want to send 1 email for each Service ID, but listing all of the parts (in this case, 3)</p>\n\n<p>The simplest method is to sort the list by Service ID, then store the Service ID you are working on, and check rows until the Service ID changes.  Then, that gives you all of the rows/parts that need to be included in that email.</p>\n\n<p>If you don't want to sort the list, then you can store \"done\" Service IDs (in a Dictionary or deliminated string (\"|A|B|\" means \"C\" has not been done, as \"|C|\" is not found by<code>InStr</code>)) and either Filter for each new Service ID then use <code>.SpecialCells</code> to looks at the rows that are shown, or (inefficient) loop through until the end of the table and add any data from rows with the same service ID</p>\n"}], "owner": {"reputation": 69, "user_id": 7614408, "user_type": "registered", "profile_image": "https://graph.facebook.com/10206878705726602/picture?type=large", "display_name": "Ruzaini Subri", "link": "https://stackoverflow.com/users/7614408/ruzaini-subri"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 34, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1524735740, "creation_date": 1524627599, "last_edit_date": 1531164843, "question_id": 50013713, "link": "https://stackoverflow.com/questions/50013713/send-auto-email-with-duplicate-word-id", "title": "Send Auto Email with duplicate Word/ID", "body": "<p>Below are my code to send auto email, but this sends each ID with 1 email.<br>\nWhat I want is to compile duplicate id first before send the auto email.<br>\nAs an example below which service tag are duplicate ID. Apologies, can't put all codes here because I'm getting an error.</p>\n\n<p><a href=\"https://i.stack.imgur.com/5lKzi.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/5lKzi.png\" alt=\"enter image description here\"></a></p>\n\n<pre><code>For i = 2 To lRow\n    If OOW.Sheets(\"WORKING FILE\").Range(\"W\" &amp; i) = \"YES\" And _\n    OOW.Sheets(\"WORKING FILE\").Range(\"B\" &amp; i) = \"Ruz\" And _\n    OOW.Sheets(\"WORKING FILE\").Range(\"Y\" &amp; i) = \"\" Then\n\n    Set rng = Nothing\n    Set rngTilte = Nothing\n    On Error Resume Next\n    Set rngTilte = OOW.Sheets(\"WORKING FILE\").Range(\"D1:X1\").SpecialCells(xlCellTypeVisible)\n    Set rng = OOW.Sheets(\"WORKING FILE\").Range(\"D\" &amp; i &amp; \":\" &amp; \"X\" &amp; i). _\n    SpecialCells(xlCellTypeVisible)\n    On Error GoTo 0\n\n    With Application\n        .EnableEvents = False\n        .ScreenUpdating = False\n    End With\n\n    Set OutApp = CreateObject(\"Outlook.Application\")\n    Set olNs = OutApp.GetNamespace(\"MAPI\")\n    Set Fldr = olNs.GetFolderFromID(EntryID, StoreID)\n    Set myTasks = Fldr.items\n\n    For Each olMail In myTasks\n\n    If (InStr(1, olMail.Subject, Cells(i, 4), vbTextCompare) &gt; 0) And _\n    (InStr(1, olMail.Subject, Cells(i, 6), vbTextCompare) &gt; 0) Then\n</code></pre>\n\n<p>with function below</p>\n\n<pre><code>    Function RangetoHTML(rngTilte As Range, rng As Range)\n    ' Changed by Ron de Bruin 28-Oct-2006\n    ' Working in Office 2000-2013\n    Dim fso As Object\n    Dim ts As Object\n    Dim TempFile As String\n    Dim TempWB As Workbook\n    Dim NR As Long  ' Next Aavailable Row\n\n    TempFile = Environ$(\"temp\") &amp; \"\\\" &amp; Format(Now, \"dd-mm-yy h-mm-ss\") &amp; \".htm\"\n\n    'Copy the range and create a new workbook to past the data in\n    ' Amended to paste two ranges\n    Set TempWB = Workbooks.Add(1)\n    With TempWB.Sheets(1)\n        rngTilte.Copy\n        .Cells(1, 1).PasteSpecial Paste:=8\n        .Cells(1, 1).PasteSpecial xlPasteValues, , False, False\n        .Cells(1, 1).PasteSpecial xlPasteFormats, , False, False\n        ' Add second range\n        NR = .Cells.Find(\"*\", SearchOrder:=xlByRows, SearchDirection:=xlPrevious).Row + 1\n        rng.Copy\n        .Cells(NR, 1).PasteSpecial Paste:=8\n        .Cells(NR, 1).PasteSpecial xlPasteValues, , False, False\n        .Cells(NR, 1).PasteSpecial xlPasteFormats, , False, False\n        ' End of add second range\n        .Cells(1).Select\n        Application.CutCopyMode = False\n        On Error Resume Next\n        .DrawingObjects.Visible = True\n        .DrawingObjects.Delete\n        On Error GoTo 0\n    End With\n</code></pre>\n\n<p>Edit 1</p>\n\n<p>I try with this and it work.</p>\n\n<pre><code>Dim Criteria As Range\nSet Criteria = OOW.Sheets(\"WORKING FILE\").Cells(i, 4)\nOOW.Sheets(\"WORKING FILE\").Columns(\"D:D\").AutoFilter Field:=4, Criteria1:=Criteria.Value\nOOW.Sheets(\"WORKING FILE\").Columns(\"Z:Z\").AutoFilter _\nField:=26, Criteria1:=\"\"\n\nSet rng = Nothing\nSet rngTilte = Nothing\nOn Error Resume Next\nSet rngTilte = OOW.Sheets(\"WORKING FILE\").Range(\"D1:X\" &amp; lRow).SpecialCells(xlCellTypeVisible)\nOn Error GoTo 0\n</code></pre>\n\n<p>And now i facing another problem.<br>\nHow can i move to next ID if after filter current ID and i find support column is empty.</p>\n"}, {"tags": ["vba", "save"], "answers": [{"comments": [{"owner": {"reputation": 51, "user_id": 9551073, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-RaaRvp3msDU/AAAAAAAAAAI/AAAAAAAAATk/JgRQtnMq8bc/photo.jpg?sz=128", "display_name": "Thompson Ho", "link": "https://stackoverflow.com/users/9551073/thompson-ho"}, "edited": false, "score": 1, "creation_date": 1524647534, "post_id": 50014319, "comment_id": 87052728, "body": "thanks it works now  ,  your advise and workbook.Add--&gt; ActiveWorkbook.Sheets.Copy"}], "tags": [], "owner": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "is_accepted": true, "score": 1, "last_activity_date": 1524632320, "creation_date": 1524632320, "answer_id": 50014319, "question_id": 50013569, "link": "https://stackoverflow.com/questions/50013569/prompt-user-open-a-workbook-and-save-as-a-new-workbook/50014319#50014319", "title": "prompt user open a workbook and save as a new workbook", "body": "<p>I think you need to change your last line from </p>\n\n<pre><code>ActiveWorkbook.Close savechanges:=False\n</code></pre>\n\n<p>To </p>\n\n<pre><code>ActiveWorkbook.Close savechanges:=True\nextwbk.Close savechanges:=False\n</code></pre>\n\n<p>Otherwise I think when you save the new workbook using <code>ActiveWorkbook.saveas</code> - it immediately becomes the active workbook</p>\n"}], "owner": {"reputation": 51, "user_id": 9551073, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-RaaRvp3msDU/AAAAAAAAAAI/AAAAAAAAATk/JgRQtnMq8bc/photo.jpg?sz=128", "display_name": "Thompson Ho", "link": "https://stackoverflow.com/users/9551073/thompson-ho"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 566, "favorite_count": 0, "accepted_answer_id": 50014319, "answer_count": 1, "score": 0, "last_activity_date": 1524647604, "creation_date": 1524626551, "last_edit_date": 1524647604, "question_id": 50013569, "link": "https://stackoverflow.com/questions/50013569/prompt-user-open-a-workbook-and-save-as-a-new-workbook", "title": "prompt user open a workbook and save as a new workbook", "body": "<p>try to prompt user to open a workbook, and then make change on it and  save as a new workbook under the same path of user open workbook. At the same time, keep user open workbook not save/no change  and close it.</p>\n\n<p>Below is my code but fail - the new workbook is empty and the user open workbook are not closed.</p>\n\n<pre><code>Sub saveas()\n\nR = Application.GetOpenFilename _\n(Title:=\"Please choose file\", _\nFileFilter:=\"Excel Files *.xls*; *.csv (*.xls*; *.csv),\")\nSet extwbk = Workbooks.Open(R)\nIf R = False Then\nMsgBox \"No file selected. Please click run again and select file.\", \nvbExclamation, \"Sorry!\"\nExit Sub\nElse\nEnd If\n\n'a = extwbk.Worksheets.Count\n'For i = 1 To a\n'will input code there that make change on the open workbook \n'Next i\n'After change process complete,  save the changed workbook as a new workbook in the \nsame path of the  openworkbook and then keep the origin openworkbook \nunchange and then close it\n\n\n\nSet extwbk = ActiveWorkbook\nActiveWorkbook.Sheets.Copy\nActiveWorkbook.saveas Filename:=extwbk.Path &amp; \"\\log.xlsx\"\n   ActiveWorkbook.Close savechanges:=True\nextwbk.Close savechanges:=False\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "runtime-error", "vba"], "comments": [{"owner": {"reputation": 501, "user_id": 8580202, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ab9a3cb8bd7c29a445545f21c050228?s=128&d=identicon&r=PG", "display_name": "adhy wijaya", "link": "https://stackoverflow.com/users/8580202/adhy-wijaya"}, "edited": false, "score": 0, "creation_date": 1524630808, "post_id": 50013471, "comment_id": 87044440, "body": "can you click debug and let me know where the error highlight?"}, {"owner": {"reputation": 5324, "user_id": 8759927, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/B8ktI.jpg?s=128&g=1", "display_name": "shrivallabha.redij", "link": "https://stackoverflow.com/users/8759927/shrivallabha-redij"}, "edited": false, "score": 0, "creation_date": 1524633953, "post_id": 50013471, "comment_id": 87045342, "body": "Try to nest second i.e. condition after <code>AND</code> inside first one. <code>If Target.Address = &quot;$E$23&quot; Then</code> and also put <code>Application.EnableEvents = False&#47;True</code> switch before <code>If Loop</code>."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 9619989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/83a38e0b9955d8a1b2897032ed45e0fa?s=128&d=identicon&r=PG", "display_name": "Abhi", "link": "https://stackoverflow.com/users/9619989/abhi"}, "edited": false, "score": 0, "creation_date": 1524659128, "post_id": 50015346, "comment_id": 87060457, "body": "Thank you. I tried the above code but it is still giving the same error when I change a selection in combobox dropdown - which changes the value of cell B23."}, {"owner": {"reputation": 3, "user_id": 9619989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/83a38e0b9955d8a1b2897032ed45e0fa?s=128&d=identicon&r=PG", "display_name": "Abhi", "link": "https://stackoverflow.com/users/9619989/abhi"}, "edited": false, "score": 0, "creation_date": 1524663493, "post_id": 50015346, "comment_id": 87063650, "body": "@PEH : I am getting runtime error &#39;13&#39; Type mismatch error in below line: If Target.Address = &quot;$E$23&quot; And Target.Value = &quot;&quot; Then"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 3, "user_id": 9619989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/83a38e0b9955d8a1b2897032ed45e0fa?s=128&d=identicon&r=PG", "display_name": "Abhi", "link": "https://stackoverflow.com/users/9619989/abhi"}, "edited": false, "score": 0, "creation_date": 1524664129, "post_id": 50015346, "comment_id": 87064054, "body": "@Abhi See my edit. This issue happens when more than one cell is selected when the change event runs. Therefore we need to intersect the target range with the cell E23 and only check the value of E23 and change the formula only in E23 instead of the whole target range."}, {"owner": {"reputation": 3, "user_id": 9619989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/83a38e0b9955d8a1b2897032ed45e0fa?s=128&d=identicon&r=PG", "display_name": "Abhi", "link": "https://stackoverflow.com/users/9619989/abhi"}, "edited": false, "score": 0, "creation_date": 1524664539, "post_id": 50015346, "comment_id": 87064342, "body": "@PEH : The alternative code is working perfectly fine. Thank you! In addition to the above criteria, there is another criteria I need to satisfy: If user enter a value in cell E23, then subtract the rebate (coming from cell E17) from cell E23."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 3, "user_id": 9619989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/83a38e0b9955d8a1b2897032ed45e0fa?s=128&d=identicon&r=PG", "display_name": "Abhi", "link": "https://stackoverflow.com/users/9619989/abhi"}, "edited": false, "score": 0, "creation_date": 1524665542, "post_id": 50015346, "comment_id": 87065033, "body": "@Abhi I recommend not to do this. This would confuse every user if he enters eg <code>20</code> as value and then it suddenly becomes <code>18</code> because something gets magically subtracted and he doesn&#39;t know why. This is a very uncommon behavior! Therefore it is better to have a cell for input the real value and subtract the rebate in another cell. If this answer solves your original question please mark it as solution."}, {"owner": {"reputation": 3, "user_id": 9619989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/83a38e0b9955d8a1b2897032ed45e0fa?s=128&d=identicon&r=PG", "display_name": "Abhi", "link": "https://stackoverflow.com/users/9619989/abhi"}, "edited": false, "score": 0, "creation_date": 1524665827, "post_id": 50015346, "comment_id": 87065203, "body": "@PEH: I support your recommendation. But the user requirement is such that if E23 has no value then pull the value from B23. If E23 has a user input value then deduct the rebate (coming from E17) from it. So it wont confuse the users since they already know the expected output. Is there a way I can insert both the conditions in VBA?"}, {"owner": {"reputation": 3, "user_id": 9619989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/83a38e0b9955d8a1b2897032ed45e0fa?s=128&d=identicon&r=PG", "display_name": "Abhi", "link": "https://stackoverflow.com/users/9619989/abhi"}, "edited": false, "score": 0, "creation_date": 1524668657, "post_id": 50015346, "comment_id": 87067254, "body": "@PEH: Thank you PEH! This is great."}], "tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": true, "score": 0, "last_activity_date": 1524666024, "last_edit_date": 1524666024, "creation_date": 1524637527, "answer_id": 50015346, "question_id": 50013471, "link": "https://stackoverflow.com/questions/50013471/excel-cell-as-a-user-input-and-as-a-formula/50015346#50015346", "title": "Excel cell as a user input and as a formula", "body": "<p>The issue here is that this line</p>\n\n<pre><code>Target.Formula = \"=B23\"\n</code></pre>\n\n<p>changes the target cell, and that triggers a <code>Worksheet_Change</code> event that changes the target cell, and that triggers a <code>Worksheet_Change</code> event \u2026 and so on.</p>\n\n<p>So you need to disable the events before you change the target cell (and re-enable them afterwards).</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    If Target.Address = \"$E$23\" And Target.Value = vbNullString Then\n        Application.EnableEvents = False\n            Target.Formula = \"=B23\"\n        Application.EnableEvents = True\n    End If\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p>Alternative that works also when multiple cells are selected:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    If Not Intersect(Target, Range(\"E23\")) Is Nothing Then\n        Application.EnableEvents = False\n        If Range(\"E23\").Value = vbNullString Then\n            Range(\"E23\").Formula = \"=B23\"\n        Else\n            Range(\"E23\").Value = Range(\"E23\").Value - Range(\"E17\").Value\n        End If\n        Application.EnableEvents = True\n    End If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 9619989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/83a38e0b9955d8a1b2897032ed45e0fa?s=128&d=identicon&r=PG", "display_name": "Abhi", "link": "https://stackoverflow.com/users/9619989/abhi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 412, "favorite_count": 0, "accepted_answer_id": 50015346, "answer_count": 1, "score": 0, "last_activity_date": 1524666024, "creation_date": 1524625636, "last_edit_date": 1531161705, "question_id": 50013471, "link": "https://stackoverflow.com/questions/50013471/excel-cell-as-a-user-input-and-as-a-formula", "title": "Excel cell as a user input and as a formula", "body": "<p>I am trying to make cell E23 as a user input and as a formula cell if user does not enter any value. For eg: If user enters a value in cell E23, then consider that value. If user does not enter any value then copy value from cell B23. Below is the vba code which I tried. </p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\nIf Target.Address = \"$E$23\" And Target.Value = \"\" Then\n     Target.Formula = \"=B23\"\nEnd If\n</code></pre>\n\n<p>The code works fine until I change the value in cell B23 by a selection made in the dropdown combobox. When I change the selection in combobox from option 1 to option 2, new value gets updated in cell B23 which must be copied into E23. But it gives me a runtime error '13' Type mismatch.</p>\n\n<p>Any help is appreciated. Thank you</p>\n"}, {"tags": ["vba", "interop", "ms-office", "coding-efficiency", "path-separator"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 1, "creation_date": 1524625765, "post_id": 50013255, "comment_id": 87043270, "body": "I&#39;ve wondered the same thing; especially so since the powers-that-be decided it wasn&#39;t important to include an Application.ListSeparator property in the Application object&#39;s members which to my mind would have been very useful.."}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 1, "creation_date": 1524627293, "post_id": 50013255, "comment_id": 87043597, "body": "it&#39;s your your lucky day: <a href=\"https://msdn.microsoft.com/en-us/vba/excel-vba/articles/application-international-property-excel\" rel=\"nofollow noreferrer\"><b><code>Application.International (xlListSeparator)</code></b></a>"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 9, "creation_date": 1524628030, "post_id": 50013255, "comment_id": 87043764, "body": "I guess you don&#39;t recall back when the Mac path separator was <code>:</code>"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 2, "creation_date": 1524631611, "post_id": 50013255, "comment_id": 87044626, "body": "I still have a machine which returns in some cases a path with : on a mac"}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1524635210, "post_id": 50013255, "comment_id": 87045783, "body": "@QHarr So it&#39;s still running the <i>original</i> Mac OS?!  Does VBA and/or Office ever run on this machines? That would confirm my suspicion of backwards compatibility being the reason we still need it..."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 3, "creation_date": 1524636191, "post_id": 50013255, "comment_id": 87046218, "body": "It is a 2011 Mac  but the OS is up to date (so presumably actually slighter older than that). I discovered it as a problem regarding HDD with answering this <a href=\"https://stackoverflow.com/questions/48693411/error-53-when-opening-csv-file-on-mac\" title=\"error 53 when opening csv file on mac\">stackoverflow.com/questions/48693411/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 11884274, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-5scx2pa6fEI/AAAAAAAAAAI/AAAAAAAAAc4/QtfyB0sja1o/photo.jpg?sz=128", "display_name": "Andreas Katits", "link": "https://stackoverflow.com/users/11884274/andreas-katits"}, "is_accepted": false, "score": 0, "last_activity_date": 1565194009, "creation_date": 1565194009, "answer_id": 57398427, "question_id": 50013255, "link": "https://stackoverflow.com/questions/50013255/why-do-we-need-application-pathseparator/57398427#57398427", "title": "Why do we need Application.PathSeparator?", "body": "<p>In some cases it's even not a great idea to use <code>Application.PathSeparator</code>, because if you open a workbook from a network space, e.g. a OneDrive out of a browser, the correct separator would be <code>/</code>. Anyway, <code>Application.PathSeparator</code> doesn't notice that...</p>\n"}, {"tags": [], "owner": {"reputation": 129, "user_id": 4157371, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8F9Km.gif?s=128&g=1", "display_name": "barbecue", "link": "https://stackoverflow.com/users/4157371/barbecue"}, "is_accepted": false, "score": 0, "last_activity_date": 1580142357, "creation_date": 1580142357, "answer_id": 59935127, "question_id": 50013255, "link": "https://stackoverflow.com/questions/50013255/why-do-we-need-application-pathseparator/59935127#59935127", "title": "Why do we need Application.PathSeparator?", "body": "<p>This question is based on an incorrect assumption, that both Mac OS and Windows use the same path separator character. That is incorrect.</p>\n\n<p>Mac OS X does not use the backslash () as a path separator. It uses the forward slash (/) like other Unixlike operating systems. In the Mac OS command line, the backslash acts like an escape character, so using the same character in both platforms could cause unexpected results. </p>\n"}], "owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2988, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1580142357, "creation_date": 1524623915, "last_edit_date": 1528224684, "question_id": 50013255, "link": "https://stackoverflow.com/questions/50013255/why-do-we-need-application-pathseparator", "title": "Why do we need Application.PathSeparator?", "body": "<p><strong>MS Office VBA has a property called <a href=\"https://msdn.microsoft.com/en-us/vba/excel-vba/articles/application-pathseparator-property-excel\" rel=\"nofollow noreferrer\"></strong><code>Application.PathSeparator</code><strong></a>.</strong></p>\n\n<p>I'm supportive of <a href=\"https://en.wikipedia.org/wiki/Interoperability\" rel=\"nofollow noreferrer\" title=\"in\u00b7ter\u00b7op\u00b7er\u00b7a\u00b7bil\u00b7i\u00b7ty \u2192 &#13;the ability of computer systems or software to exchange and make use of information.\">interoperability</a>, but Office runs <a href=\"https://en.wikipedia.org/wiki/Microsoft_Office#Platforms\" rel=\"nofollow noreferrer\">only</a> on Windows &amp; MacOS, and both platforms use <a href=\"https://en.wikipedia.org/wiki/Path_(computing)#Representations_of_paths_by_operating_system_and_shell\" rel=\"nofollow noreferrer\">the same</a> <code>\\</code> path separator.</p>\n\n<p><strong>When would it <em>ever</em> be advisable to use <code>Application.PathSeparator</code></strong> (as opposed to simply hardcoding the <code>\\</code> and saving 22 keystrokes)?</p>\n\n<hr>\n\n<p>To be clear, I <strong>do</strong> think it's important to support international differences when posting code on an <a href=\"https://insights.stackoverflow.com/survey/2018/#geography\" rel=\"nofollow noreferrer\">international site like Stack Overflow</a>, so I will often use <code>Application.International</code> properties such as <code>xlDateSeparator</code> and, more importantly, <code>xlDateOrder</code>. <sub>(More about those <a href=\"https://msdn.microsoft.com/en-us/vba/excel-vba/articles/application-international-property-excel\" rel=\"nofollow noreferrer\">here</a>)</sub></p>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1524619698, "post_id": 50012765, "comment_id": 87041955, "body": "Unqualified <code>Cells</code> calls are implicitly referring to the <code>ActiveSheet</code>; this will blow up if <code>ActiveSheet</code> isn&#39;t the <code>Forecast</code> sheet. <a href=\"http://rubberduckvba.com\" rel=\"nofollow noreferrer\">Rubberduck</a> inspections would have told you that (disclaimer: I manage that open-source VBIDE add-in project) ;-)"}], "answers": [{"tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": false, "score": 0, "last_activity_date": 1524620013, "creation_date": 1524620013, "answer_id": 50012811, "question_id": 50012765, "link": "https://stackoverflow.com/questions/50012765/error-when-executing-vba-code-when-wrong-excel-tab-is-open/50012811#50012811", "title": "Error when executing VBA code when wrong Excel tab is open", "body": "<p><code>Cells</code> without a worksheet object qualifier, implicitly refers to whatever the <code>ActiveSheet</code> is (if you're in a standard code module). If you're in a worksheet's code-behind module, then unqualified <code>Cells</code> calls are basically doing <code>Me.Cells</code>, i.e. they're referring to <em>that</em> worksheet.</p>\n\n<p>Solution is to qualify everything with the sheet object you're working with:</p>\n\n<pre><code>Set YE_last = Forecast.Range(Forecast.Cells(YE_forecast.Row + 1, YE_forecast.Column + i - 1), Forecast.Cells(YE_forecast.Row + 1, YE_forecast.Column + i - 1))\n</code></pre>\n\n<p>A <code>With</code> block can simplify this:</p>\n\n<pre><code>With Forecast\n    Set YE_last = .Range(.Cells(YE_forecast.Row + 1, YE_forecast.Column + i - 1), .Cells(YE_forecast.Row + 1, YE_forecast.Column + i - 1))\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 43, "user_id": 9612772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e58c1893180a158bcd8b11526d4b309?s=128&d=identicon&r=PG&f=1", "display_name": "MaxF", "link": "https://stackoverflow.com/users/9612772/maxf"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 27, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1524620013, "creation_date": 1524619503, "question_id": 50012765, "link": "https://stackoverflow.com/questions/50012765/error-when-executing-vba-code-when-wrong-excel-tab-is-open", "title": "Error when executing VBA code when wrong Excel tab is open", "body": "<p>My VBA code utilizes two Excel spreadsheets. It gets data from one (Tab1) and writes results to the other tab (Tab2). However, when I launch the code while Tab2 is open, VBA is giving me \"Application defined or Object Defined error\". Code works find when I am on Tab1.  Below is the line of code where it chokes:</p>\n\n<pre><code>Set YE_last = Forecast.Range(Cells(YE_forecast.Row + 1, YE_forecast.Column + i - 1), Cells(YE_forecast.Row + 1, YE_forecast.Column + i - 1))\n</code></pre>\n\n<p>Can you help please!</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2538, "user_id": 6388698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7gWUL.png?s=128&g=1", "display_name": "GMalc", "link": "https://stackoverflow.com/users/6388698/gmalc"}, "edited": false, "score": 0, "creation_date": 1524626552, "post_id": 50012462, "comment_id": 87043458, "body": "Not very clear, but i think you are saying that after you copy you need to delete empty rows, it that is the case see <a href=\"https://stackoverflow.com/questions/9379673/excel-vba-delete-empty-rows?utm_medium=organic&amp;utm_source=google_rich_qa&amp;utm_campaign=google_rich_qa\">This</a>; you can also do a search on Google for <code>delete empty rows excel vba</code> there are many examples."}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user9663005"}, "edited": false, "score": 0, "creation_date": 1524619225, "post_id": 50012542, "comment_id": 87041843, "body": "The sheet2 is the Group Sir, and the sheet4 is the ytp. thanks for the answer, Sir, but it does not work."}, {"owner": {"user_type": "does_not_exist", "display_name": "user9663005"}, "edited": false, "score": 0, "creation_date": 1524633163, "post_id": 50012542, "comment_id": 87045070, "body": "It works sir, but this wasn&#39;t my expected output sir.  But you give me an Idea how to :) Thanks a lot sir :) I Hope you can help me with my project :)"}], "tags": [], "owner": {"reputation": 501, "user_id": 8580202, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ab9a3cb8bd7c29a445545f21c050228?s=128&d=identicon&r=PG", "display_name": "adhy wijaya", "link": "https://stackoverflow.com/users/8580202/adhy-wijaya"}, "is_accepted": true, "score": 0, "last_activity_date": 1524629665, "last_edit_date": 1524629665, "creation_date": 1524617259, "answer_id": 50012542, "question_id": 50012462, "link": "https://stackoverflow.com/questions/50012462/delete-row-if-the-merged-cell-is-empty/50012542#50012542", "title": "Delete row if the merged cell is empty", "body": "<p>Please try this code</p>\n\n<pre><code>Sub Copy()\n\n  'Declaration for copying the entire column of J\n    Dim lastrow As Long, erow As Long\n    Dim sRange As Range\n    Dim sCrange As Range\n    Dim sSheet as Worksheet\n    Dim sCSheet as Worksheet\n    Dim i as Integer\n    Dim cell As Range\n  'End Declare\n\n    Set sSheet = Worksheets(\"YTP\")\n    Set sCSheet = Worksheets(\"GROUP\")\n    sSheet.Range(\"J10:J350\").Copy\n    sCSheet.Activate\n    sCSheet.Range(\"J5\").Select\n    ActiveSheet.Paste\n    Application.CutCopyMode = False\n    lastrow = 360\n    For i = 10 to lastrow \n        If sSheet.Range(\"J\" &amp; i).Value = \"\" then\n           sSheet.Rows(i).delete \n           i = i - 1\n           lastrow = lastrow - 1  \n        End If\n        if i &gt; lastrow then Exit For\n\n    Next i\n\n    sSheet.Activate\nEnd Sub\n</code></pre>\n\n<p>Hope this help.</p>\n\n<p>Thanks</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user9663005"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 138, "favorite_count": 0, "accepted_answer_id": 50012542, "answer_count": 1, "score": 0, "last_activity_date": 1524629665, "creation_date": 1524616344, "last_edit_date": 1531161705, "question_id": 50012462, "link": "https://stackoverflow.com/questions/50012462/delete-row-if-the-merged-cell-is-empty", "title": "Delete row if the merged cell is empty", "body": "<p>I have a project that will rearrange the Sheet \"GROUP\" and format it just like \"YTP\" sheet. but i dont have an idea how to solve and make it in time. My Problem is how to delete the entire row of YTP sheet if the YTP sheet has an empty row after copying the Data in SHEET GROUP. I have started a code like this:</p>\n\n<blockquote>\n  <p>CODE</p>\n</blockquote>\n\n<pre><code>Option Explicit\nSub Copy()\n\n  'Declaration for copying the entire column of J\n    Dim lastrow As Long, erow As Long\n    Dim sRange As Range\n    Dim sCrange As Range\n    Dim cell As Range\n  'End Declare\n\n\n    Set sRange = Sheet2.Range(\"J10:J350\")\n    Set sCrange = Sheet4.Range(\"J5:J360\")\n\n    For Each cell In sRange\n        If Not IsEmpty(cell) Then\n           sRange.Copy sCrange\n\n        End If\n    Next cell\nEnd Sub\n</code></pre>\n\n<p>This is the Image of Group and YTP sheet</p>\n\n<p><a href=\"https://i.stack.imgur.com/HlHWC.png\" rel=\"nofollow noreferrer\">Group</a></p>\n\n<p><a href=\"https://i.stack.imgur.com/Jtash.png\" rel=\"nofollow noreferrer\">YTP</a></p>\n\n<p>If you want to see the excel file, Please comment and i will attached it in here. Please Guys, Help me.</p>\n"}, {"tags": ["excel", "excel-2016", "vba"], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 0, "last_activity_date": 1524614435, "last_edit_date": 1524614435, "creation_date": 1524613858, "answer_id": 50012176, "question_id": 50012063, "link": "https://stackoverflow.com/questions/50012063/filling-blank-rows-from-cells-above-conditionally/50012176#50012176", "title": "Filling Blank Rows from Cells Above Conditionally", "body": "<p>Use the cell.row to reference column D.</p>\n\n<pre><code>Dim cell As Range, SearchRange As Range\n\nOn Error Resume Next\nSet SearchRange = Columns(\"A:C\").SpecialCells(xlCellTypeBlanks)\nOn Error GoTo 0\n\nIf Not SearchRange Is Nothing Then\n    For Each cell In SearchRange\n        If cell.Row &gt; 1 And Not (Cells(cell.Row, \"D\") Like \"ACCOUNTS*\" Or Cells(cell.Row, \"D\") Like \"FUEL*\") Then _\n            cell = cell.Offset(-1, 0).Value\n    Next cell\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 51, "user_id": 7979155, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dJtwu.jpg?s=128&g=1", "display_name": "Martin Hewitt Tayler", "link": "https://stackoverflow.com/users/7979155/martin-hewitt-tayler"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 177, "favorite_count": 0, "accepted_answer_id": 50012176, "answer_count": 1, "score": 0, "last_activity_date": 1524614435, "creation_date": 1524612864, "last_edit_date": 1531161705, "question_id": 50012063, "link": "https://stackoverflow.com/questions/50012063/filling-blank-rows-from-cells-above-conditionally", "title": "Filling Blank Rows from Cells Above Conditionally", "body": "<p>I originally used some script where the blank rows in the first 3 columns of data in my worksheet were filled from the previous row.  The script is:</p>\n\n<pre><code>    Dim cell As Range, SearchRange As Range\n\n    On Error Resume Next\n    Set SearchRange = Columns(\"A:C\").SpecialCells(xlCellTypeBlanks)\n    On Error GoTo 0\n\n    If Not SearchRange Is Nothing Then\n        For Each cell In SearchRange\n\n          If cell.row &gt; 1 Then cell = cell.Offset(-1, 0).Value\n\n        Next cell\n    End If\n</code></pre>\n\n<p>Although that is fine for blank rows in between those columns I have a problem where the blanks are alongside text in column D I do not wish to fill. I tried something like:</p>\n\n<pre><code>   If Not Like \"*FUEL*\" Or Like \"ACCOUNTS*\"\n</code></pre>\n\n<p>yet I have trouble with the syntax in using this in a conditional statement. My pasted snip will make sense...I hope.  I want to fill just the row beside the word Jacqui in Column D but not Fuel or Accounts. NB. The word Jacqui is not constant.</p>\n\n<p><a href=\"https://i.stack.imgur.com/RBKVB.jpg\" rel=\"nofollow noreferrer\">Excel Sample</a></p>\n"}, {"tags": ["vba", "arena-simulation"], "comments": [{"owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "edited": false, "score": 0, "creation_date": 1524618951, "post_id": 50012046, "comment_id": 87041782, "body": "Make sure <code>NumContenedor</code> is not 0"}], "answers": [{"tags": [], "owner": {"reputation": 13, "user_id": 9419780, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-T5cuQ77rep4/AAAAAAAAAAI/AAAAAAAAVE0/ff2p8fPguoM/photo.jpg?sz=128", "display_name": "Paloma Auladell", "link": "https://stackoverflow.com/users/9419780/paloma-auladell"}, "is_accepted": true, "score": 0, "last_activity_date": 1528111209, "creation_date": 1528111209, "answer_id": 50679414, "question_id": 50012046, "link": "https://stackoverflow.com/questions/50012046/siman-errors-and-vba/50679414#50679414", "title": "SIMAN errors and VBA", "body": "<p>The cookie number of my VBA block wasn't matching the number in the procedure name VBA_Block_1_Fire()</p>\n\n<p>duh</p>\n"}], "owner": {"reputation": 13, "user_id": 9419780, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-T5cuQ77rep4/AAAAAAAAAAI/AAAAAAAAVE0/ff2p8fPguoM/photo.jpg?sz=128", "display_name": "Paloma Auladell", "link": "https://stackoverflow.com/users/9419780/paloma-auladell"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1691, "favorite_count": 0, "accepted_answer_id": 50679414, "answer_count": 1, "score": 0, "last_activity_date": 1528111209, "creation_date": 1524612713, "question_id": 50012046, "link": "https://stackoverflow.com/questions/50012046/siman-errors-and-vba", "title": "SIMAN errors and VBA", "body": "<p>I'm using this code with Arena, a simulation software by Rockwell Automation. I'm trying to get the code to read some data from an excel sheet and assign it to an attribute of the entity which enters the vba module.\nWhen I run the simulation, I get this SIMAN error window:</p>\n\n<p>\"17035:EEVBA \nEntity: 2</p>\n\n<p>A runtime error was detected at time 0.0 at the following block:\n *    6 15$             VBA:0,vba:NEXT(2$);</p>\n\n<p>Event number 0 is invalid: must be positive.\"</p>\n\n<p>What does that error mean?\nThis is my code, any suggestions? : </p>\n\n<pre><code>Option Explicit\nPublic XL As Object\nPublic Wo As Integer\nPublic W_1 As Integer\nPublic NumContenedor As Integer\n\nPublic Sub ModelLogic_RunBeginSimulation()\n    Dim m As Model\n    Set m = ThisDocument.Model\n    Dim FileToOpen As String\n    Set XL = GetObject(\"\", \"Excel.Application\")\n    FileToOpen = \"C:\\Users\\A\\data.xlsx\"\n    XL.Workbooks.Open FileToOpen\nEnd Sub\n\nPublic Sub VBA_Block_1_Fire()\n    Dim s As SIMAN\n    Set s = ThisDocument.Model.SIMAN\n    NumContenedor = s.EntityAttribute(s.ActiveEntity, s.SymbolNumber(\"NumContenedor\"))\n    Wo = XL.Workbooks(1).Worksheets(1).Cells(NumContenedor, 4).value\n    W_1 = XL.Workbooks(1).Worksheets(1).Cells(NumContenedor, 5).value\n    s.EntityAttribute(s.ActiveEntity, s.SymbolNumber(\"deltaW\")) = W_1 - Wo\nEnd Sub\n\nPublic Sub ModelLogic_RunEnd()\n    XL.Quit\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1524612254, "post_id": 50011958, "comment_id": 87040410, "body": "Instead of adding a blank sheet and then formatting it to look like the template, why not just copy the template?"}, {"owner": {"reputation": 3, "user_id": 9693939, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-GRqfEICR_C8/AAAAAAAAAAI/AAAAAAAAFBs/rI1rgVaUUMo/photo.jpg?sz=128", "display_name": "Rhys Thomas", "link": "https://stackoverflow.com/users/9693939/rhys-thomas"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1524613610, "post_id": 50011958, "comment_id": 87040710, "body": "That&#39;s a good question, and I&#39;m sure there was a reason when I originally put this together a year or so ago. Something to do with the renaming the sheet perhaps? I don&#39;t remember!   Could you make a suggestion on how to handle that within the above code? Happy to provide an example sheet if that would be useful?"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 9693939, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-GRqfEICR_C8/AAAAAAAAAAI/AAAAAAAAFBs/rI1rgVaUUMo/photo.jpg?sz=128", "display_name": "Rhys Thomas", "link": "https://stackoverflow.com/users/9693939/rhys-thomas"}, "edited": false, "score": 0, "creation_date": 1524648779, "post_id": 50012495, "comment_id": 87053524, "body": "Hi Tim, I&#39;ve given this a try and it throws up an error at &#39;NewSheet.Name = srcName.Value&#39;, I think because srcName isn&#39;t defined yet?   I&#39;ve uploaded an example version of my spreadsheet - <a href=\"https://drive.google.com/open?id=1GdACHM0sSb7XFmSpeWQAe6RQP2Afo1Hf\" rel=\"nofollow noreferrer\">drive.google.com/open?id=1GdACHM0sSb7XFmSpeWQAe6RQP2Afo1Hf</a>   I&#39;d be really grateful if you had the time to take a look. My original code is Module1 and your code above is Module2 (it keys off ColD so have updated to suit).   Your code looks great though, exactly the advice I was looking for! Thank you!"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 3, "user_id": 9693939, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-GRqfEICR_C8/AAAAAAAAAAI/AAAAAAAAFBs/rI1rgVaUUMo/photo.jpg?sz=128", "display_name": "Rhys Thomas", "link": "https://stackoverflow.com/users/9693939/rhys-thomas"}, "edited": false, "score": 0, "creation_date": 1524667336, "post_id": 50012495, "comment_id": 87066285, "body": "Did you try moving the <code>Set srcName = ...</code> line up?"}, {"owner": {"reputation": 3, "user_id": 9693939, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-GRqfEICR_C8/AAAAAAAAAAI/AAAAAAAAFBs/rI1rgVaUUMo/photo.jpg?sz=128", "display_name": "Rhys Thomas", "link": "https://stackoverflow.com/users/9693939/rhys-thomas"}, "edited": false, "score": 0, "creation_date": 1524669011, "post_id": 50012495, "comment_id": 87067527, "body": "Ah I did and it didn&#39;t work, but have just tried it again and it all works great! Thanks so much for your help and advice!"}, {"owner": {"reputation": 3, "user_id": 9693939, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-GRqfEICR_C8/AAAAAAAAAAI/AAAAAAAAFBs/rI1rgVaUUMo/photo.jpg?sz=128", "display_name": "Rhys Thomas", "link": "https://stackoverflow.com/users/9693939/rhys-thomas"}, "edited": false, "score": 0, "creation_date": 1524671227, "post_id": 50012495, "comment_id": 87069077, "body": "I don&#39;t suppose you have any ingenious solution to the second part of my question?  Rather than run this in one full go, have it create a new sheet only when a new row is filled in the Invoices sheet (perhaps this is when the Invoice Number column is given a value in the next blank row)."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 3, "user_id": 9693939, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-GRqfEICR_C8/AAAAAAAAAAI/AAAAAAAAFBs/rI1rgVaUUMo/photo.jpg?sz=128", "display_name": "Rhys Thomas", "link": "https://stackoverflow.com/users/9693939/rhys-thomas"}, "edited": false, "score": 0, "creation_date": 1524673203, "post_id": 50012495, "comment_id": 87070232, "body": "You can use an event handler to respond to data entries, but I would go with a button which creates a sheet for the row(s) which is/are currently selected"}, {"owner": {"reputation": 3, "user_id": 9693939, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-GRqfEICR_C8/AAAAAAAAAAI/AAAAAAAAFBs/rI1rgVaUUMo/photo.jpg?sz=128", "display_name": "Rhys Thomas", "link": "https://stackoverflow.com/users/9693939/rhys-thomas"}, "edited": false, "score": 0, "creation_date": 1524675527, "post_id": 50012495, "comment_id": 87071409, "body": "Great, thanks for the advice. I&#39;ve done just that - a button which creates a sheet for the selected row. Thanks again for all your help!"}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 0, "last_activity_date": 1524616810, "creation_date": 1524616810, "answer_id": 50012495, "question_id": 50011958, "link": "https://stackoverflow.com/questions/50011958/reference-multiple-template-sheets-in-vba/50012495#50012495", "title": "Reference multiple &#39;template&#39; sheets in VBA", "body": "<p>Untested, but something like:</p>\n\n<pre><code>Sub AddNamedSheets()\n\n    Dim srcName, dstName As Range\n    Dim invoicesSheet As Worksheet\n    Dim templateSheet\n    Dim NewSheet As Worksheet\n    Dim myBook As Workbook\n    Dim lastRow As Long\n    Dim i As Long\n    Dim namesColumn\n\n    Set myBook = ActiveWorkbook\n\n    Set invoicesSheet = myBook.Worksheets(\"Invoices\")\n\n    'Define which column in your master tab the list is - here it's B i.e. column 2\n    namesColumn = 2\n\n    'Find the last row of the sheets list\n    lastRow = invoicesSheet.Cells(invoicesSheet.Rows.Count, namesColumn).End(xlUp).Row\n\n    'Cycle through the list - Assuming the list starts in column \"A\" from the 2nd row\n    For i = 2 To lastRow\n\n        'which template to copy? keys off ColJ here for example\n        If LCase(invoicesSheet.Cells(i, 10).Value) = \"y\" Then\n            Set templateSheet = myBook.Worksheets(\"Hire Template\")\n        Else\n            Set templateSheet = myBook.Worksheets(\"Template\")\n        End If\n\n        'copy the template and rename it\n        templateSheet.Copy after:=myBook.Worksheets(myBook.Worksheets.Count)\n        Set NewSheet = myBook.Worksheets(myBook.Worksheets.Count)\n        NewSheet.Name = srcName.Value\n\n        Set srcName = invoicesSheet.Range(\"A\" &amp; i)\n        srcName.Copy Destination:=NewSheet.Range(\"J3\")\n        Set dstName = NewSheet.Range(\"J3\")\n\n        'Create Hyperlink to new sheet\n        srcName.Hyperlinks.Add Anchor:=srcName, _\n            Address:=\"\", SubAddress:=srcName &amp; \"!J3\", _\n            TextToDisplay:=srcName.Value\n\n        'Create HyperLink back to Main sheet\n        dstName.Hyperlinks.Add Anchor:=dstName, _\n            Address:=\"\", SubAddress:=\"'Invoices'!A1\", _\n            TextToDisplay:=dstName.Value\n\n    Next i\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 9693939, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-GRqfEICR_C8/AAAAAAAAAAI/AAAAAAAAFBs/rI1rgVaUUMo/photo.jpg?sz=128", "display_name": "Rhys Thomas", "link": "https://stackoverflow.com/users/9693939/rhys-thomas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 150, "favorite_count": 0, "accepted_answer_id": 50012495, "answer_count": 1, "score": 0, "last_activity_date": 1524616810, "creation_date": 1524611976, "last_edit_date": 1524613191, "question_id": 50011958, "link": "https://stackoverflow.com/questions/50011958/reference-multiple-template-sheets-in-vba", "title": "Reference multiple &#39;template&#39; sheets in VBA", "body": "<p>I currently have a VBA code (below) which runs through my first sheet (Invoices) and creates individual sheets based on the Invoice Number. At the moment it uses a template, from sheet 'Template'.</p>\n\n<p>I'd like to be able to:</p>\n\n<p>Firstly - choose whether to reference 'Template' or 'Hire Template' (depending on if the invoice is a standard or a hire invoice) based on a cell value in my Invoices sheet (perhaps a column entitled 'Hire' where the value is either y or n). </p>\n\n<p>Secondly - rather than run this in one full go, have it create a new sheet only when a new row is filled in the Invoices sheet (perhaps this is when the Invoice Number column is given a value in the next blank row).</p>\n\n<p>As I'm sure you can tell my current code is compiled from a number of sources, mostly from Google searches, and then tweaked to suit my needs. As such it probably isn't the most elegant or concise way of doing things. I'd appreciate any guidance on how to improve my code to better suit my needs! </p>\n\n<p>The other thing it does is create some hyperlinked cells for ease of navigation around the Workbook (which can be up to 100+ sheets), but I'm happy with how they work in this example.</p>\n\n<p>Also the Column and Row resizing is a bit of a bodge to get things tidy. Is there a neater way of referencing this from the Template (or Hire Template) sheets accordingly?</p>\n\n<p>Please let me know if there's anything I can be clearer on or any further information I can provide to help you to help me!</p>\n\n<p>Thanks in advance for your help!</p>\n\n<p>Rhys</p>\n\n<pre><code>Sub AddNamedSheets()\nDim srcName, dstName As Range\nDim invoicesSheet As Worksheet\nDim templateSheet As Worksheet\nDim NewSheet As Worksheet\nDim myBook As Workbook\nDim lastRow As Long\nDim i As Long\nDim namesColumn\n\n\n'Define your workbook - here set as the active workbook\nSet myBook = ActiveWorkbook\n\n'Define your worksheets - The sheets are named \"Invoices\" and \"Template\" respectively\nSet invoicesSheet = myBook.Worksheets(\"Invoices\")\nSet templateSheet = myBook.Worksheets(\"Template\")\n\n'Define which column in your master tab the list is - here it's B i.e. column 2\nnamesColumn = 2\n\n'Find the last row of the sheets list\nlastRow = invoicesSheet.Cells(invoicesSheet.Rows.Count, namesColumn).End(xlUp).Row\n\n\n'Cycle through the list - Assuming the list starts in column \"A\" from the 2nd row\nFor i = 2 To lastRow\n\n'Create Worksheets and Copy Row\n  Set srcName = Sheets(\"Invoices\").Range(\"A\" &amp; i)\n     ActiveWorkbook.Sheets.Add after:=Worksheets(Worksheets.Count)\n     ActiveSheet.Name = srcName\n       srcName.Range(\"A\" &amp; 1).Copy Destination:=ActiveSheet.Range(\"J3\")\n'Create Hyperlink to new sheet\n         srcName.Hyperlinks.Add Anchor:=srcName, _\n             Address:=\"\", SubAddress:=srcName &amp; \"!J3\", _\n             TextToDisplay:=srcName.Value\n'Create HyperLink back to Main sheet\n  Set dstName = ActiveSheet.Range(\"J3\")\n         dstName.Hyperlinks.Add Anchor:=dstName, _\n             Address:=\"\", SubAddress:=\"'Invoices'!A1\", _\n             TextToDisplay:=dstName.Value\n'Copy data from template\nWorksheets(\"Template\").Range(\"A1:J46\").Copy _\n    Destination:=ActiveSheet.Range(\"A1\")\n\nRows(\"1\").RowHeight = 110\nRows(\"2\").RowHeight = 30\nRows(\"3:6\").RowHeight = 21\nRows(\"7:34\").RowHeight = 20\nRows(\"35:44\").RowHeight = 21\nRows(\"45:46\").RowHeight = 16\n\nColumns(\"A\").ColumnWidth = 10\nColumns(\"B\").ColumnWidth = 15\nColumns(\"C\").ColumnWidth = 17.5\nColumns(\"D\").ColumnWidth = 20\nColumns(\"E\").ColumnWidth = 10\nColumns(\"F\").ColumnWidth = 10\nColumns(\"G\").ColumnWidth = 10\nColumns(\"H\").ColumnWidth = 15\n\n\n\n  Next\nEnd Sub\n</code></pre>\n"}, {"tags": ["html", "vba", "email", "outlook"], "comments": [{"owner": {"reputation": 167, "user_id": 5363723, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/f5d2ed5edfdceded20322aba47eaf9eb?s=128&d=identicon&r=PG&f=1", "display_name": "Malcolm Farrelle", "link": "https://stackoverflow.com/users/5363723/malcolm-farrelle"}, "edited": false, "score": 0, "creation_date": 1524605283, "post_id": 50010815, "comment_id": 87038446, "body": "I&#39;m not familiar with the email object buy maybe ... lines = Split(email.HTMLBody, vbNewLine)"}, {"owner": {"reputation": 261, "user_id": 6411120, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/12cb89f52df40db97b55b861f636838a?s=128&d=identicon&r=PG&f=1", "display_name": "Prgrm.celeritas", "link": "https://stackoverflow.com/users/6411120/prgrm-celeritas"}, "reply_to_user": {"reputation": 167, "user_id": 5363723, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/f5d2ed5edfdceded20322aba47eaf9eb?s=128&d=identicon&r=PG&f=1", "display_name": "Malcolm Farrelle", "link": "https://stackoverflow.com/users/5363723/malcolm-farrelle"}, "edited": false, "score": 0, "creation_date": 1524605350, "post_id": 50010815, "comment_id": 87038473, "body": "I tried that, but it gives me <code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</code> which is the first line of the HTML"}], "answers": [{"tags": [], "owner": {"reputation": 31351, "user_id": 1447509, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/AYREu.jpg?s=128&g=1", "display_name": "cssyphus", "link": "https://stackoverflow.com/users/1447509/cssyphus"}, "is_accepted": false, "score": 1, "last_activity_date": 1524609562, "creation_date": 1524609562, "answer_id": 50011669, "question_id": 50010815, "link": "https://stackoverflow.com/questions/50010815/get-the-first-line-of-text-from-email-body-with-outlook-vb/50011669#50011669", "title": "Get the first line of text from email body with Outlook VB", "body": "<p>This is quick and dirty, grabbing a few mins here and there to construct, but something like this should get you started:</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-js lang-js prettyprint-override\"><code>Public Sub PrependClipboardToHTML()\r\n    Dim email As Outlook.MailItem\r\n    Dim cBoard As DataObject\r\n    Dim cText, strLine As String\r\n    Dim strArray() As String\r\n    \r\n    Set email = Application.CreateItem(olMailItem)\r\n    Set cBoard = New DataObject\r\n    cBoard.GetFromClipboard\r\n    cText = cBoard.GetText\r\n    strArray = Split(cText, vbCrLf)\r\n    strLine = CStr(strArray(0))\r\n    \r\n     With email\r\n      .To = \"someone@domain.com\"\r\n      .Subject = strLine\r\n      .BodyFormat = olFormatHTML ' olFormatPlain == send plain text message\r\n      .HTMLBody = cText + email.HTMLBody\r\n     \r\n      .Display\r\n    End With\r\n    \r\n    Set email = Nothing\r\n    Set cBoard = Nothing\r\n\r\nEnd Sub</code></pre>\r\n</div>\r\n</div>\r\n</p>\n"}, {"tags": [], "owner": {"reputation": 261, "user_id": 6411120, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/12cb89f52df40db97b55b861f636838a?s=128&d=identicon&r=PG&f=1", "display_name": "Prgrm.celeritas", "link": "https://stackoverflow.com/users/6411120/prgrm-celeritas"}, "is_accepted": true, "score": 0, "last_activity_date": 1524632564, "creation_date": 1524632564, "answer_id": 50014352, "question_id": 50010815, "link": "https://stackoverflow.com/questions/50010815/get-the-first-line-of-text-from-email-body-with-outlook-vb/50014352#50014352", "title": "Get the first line of text from email body with Outlook VB", "body": "<p>I did some more research and read over the API's. In the end I figured it out. My solution is posted below. Thanks for all the help from the other commenters.</p>\n\n<pre class=\"lang-visual-basic prettyprint-override\"><code>Sub PrependClipboardHTML()\n   Dim email As Outlook.MailItem\n   Dim cBoard As DataObject\n\n   Set email = Application.ActiveInspector.CurrentItem\n   Set cBoard = New DataObject\n\n   cBoard.GetFromClipboard\n\n   Dim sText As String\n   Dim headerStart As Integer\n   Dim headerEnd As Integer\n   Dim HTMLPre As String\n   Dim HTMLPost As String\n   Dim subject As String\n   Const headerStartLen = 20\n   Const headerEndStr = \"&lt;/h2&gt;\"\n\n   sText = cBoard.GetText\n   headerStart = InStr(sText, \"&lt;h2 id=\")\n\n   If headerStart &gt; 0 Then\n       headerEnd = InStr(headerStart, sText, headerEndStr)\n       If headerEnd &gt; 0 Then\n           subject = Mid(sText, _\n               headerStart + headerStartLen, _\n               headerEnd - headerStart - headerStartLen)\n           HTMLPre = Mid(sText, 1, headerStart - 1)\n           HTMLPost = Mid(sText, headerEnd + Len(headerEndStr))\n       End If\n   End If\n\n   email.HTMLBody = HTMLPre + HTMLPost + email.HTMLBody\n   If Len(email.subject) = 0 Then\n       email.subject = subject\n   End If\n\n   Set cBoard = Nothing\n   Set email = Nothing\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 261, "user_id": 6411120, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/12cb89f52df40db97b55b861f636838a?s=128&d=identicon&r=PG&f=1", "display_name": "Prgrm.celeritas", "link": "https://stackoverflow.com/users/6411120/prgrm-celeritas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1720, "favorite_count": 1, "accepted_answer_id": 50014352, "answer_count": 2, "score": 1, "last_activity_date": 1593004070, "creation_date": 1524604535, "last_edit_date": 1593004070, "question_id": 50010815, "link": "https://stackoverflow.com/questions/50010815/get-the-first-line-of-text-from-email-body-with-outlook-vb", "title": "Get the first line of text from email body with Outlook VB", "body": "<p>I stole a function from somewhere online that allows me to take HTML from my clipboard and put in an Outlook 2013 email. </p>\n\n<p>This works fine, but I would also like to modify it to grab the first line of text from the email body and use that as the subject line. </p>\n\n<p>That way everything can be included in the HTML. However I have almost no experience with VB and after spending some time online look at API's and documentation I am still not able to figure it out. Here is what I have so far. </p>\n\n<pre><code>Sub PrependClipboardHTML()\n    Dim email As Outlook.MailItem\n    Dim cBoard As DataObject\n    Dim lines() As String\n\n    Set email = Application.ActiveInspector.CurrentItem\n    Set cBoard = New DataObject\n\n    cBoard.GetFromClipboard\n\n    email.HTMLBody = cBoard.GetText + email.HTMLBody\n    lines = Split(email.Body, vbNewLine)\n    ' this does not produce anything\n    email.subject = lines(0)\n\n    'remove first line of email\n\n    Set cBoard = Nothing\n    Set email = Nothing\n\nEnd Sub\n</code></pre>\n\n<p>To reiterate, I want to remove the first line of the post-formatted email body and use it as the subject line.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 9743, "user_id": 2127508, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24b1d5bcb39ec4baad76d20c66506318?s=128&d=identicon&r=PG", "display_name": "barrowc", "link": "https://stackoverflow.com/users/2127508/barrowc"}, "edited": false, "score": 0, "creation_date": 1524605755, "post_id": 50010753, "comment_id": 87038589, "body": "This code doesn&#39;t compile - <code>Set myData = Workbook.Open...</code> should be <code>Set myData = Workbooks.Open...</code> Also, <code>RowCount</code> isn&#39;t declared anywhere in the code given (although it could be declared elsewhere)"}], "answers": [{"tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 1, "last_activity_date": 1524605137, "creation_date": 1524605137, "answer_id": 50010927, "question_id": 50010753, "link": "https://stackoverflow.com/questions/50010753/type-mismatch-error-while-copy-data-from-excel-to-another-excel/50010927#50010927", "title": "Type Mismatch error while copy data from excel to another excel", "body": "<p>The problem is with:</p>\n\n<pre><code>RowCount = dataRange\n</code></pre>\n\n<p>because <code>RowCount</code> is a <em>Long</em> or <em>Integer</em> and <code>DataRange</code> is a multi-cell <em>Range</em></p>\n"}, {"comments": [{"owner": {"reputation": 15, "user_id": 8791871, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a679dc4eff8c5b6ac9abb9234b854086?s=128&d=identicon&r=PG&f=1", "display_name": "Maha", "link": "https://stackoverflow.com/users/8791871/maha"}, "edited": false, "score": 0, "creation_date": 1524616556, "post_id": 50011438, "comment_id": 87041256, "body": "its showing Object Required error on 4th line which is Set myData = Workbook.Open(&quot;C:\\Users\\mahather\\Desktop\\Report\\Test.xlsx&quot;)  can you double check code please @Jeeped"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 15, "user_id": 8791871, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a679dc4eff8c5b6ac9abb9234b854086?s=128&d=identicon&r=PG&f=1", "display_name": "Maha", "link": "https://stackoverflow.com/users/8791871/maha"}, "edited": false, "score": 1, "creation_date": 1524617323, "post_id": 50011438, "comment_id": 87041413, "body": "It should be Workbook<b>s</b>.open not Workbook.open. btw, that was your code and one part that I could not check without creating a test workbook and a directory structure to match your own."}, {"owner": {"reputation": 15, "user_id": 8791871, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a679dc4eff8c5b6ac9abb9234b854086?s=128&d=identicon&r=PG&f=1", "display_name": "Maha", "link": "https://stackoverflow.com/users/8791871/maha"}, "edited": false, "score": 0, "creation_date": 1524704955, "post_id": 50011438, "comment_id": 87082881, "body": "its working but not all the lines copied.. Only A1 cell copied @Jeeped"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 15, "user_id": 8791871, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a679dc4eff8c5b6ac9abb9234b854086?s=128&d=identicon&r=PG&f=1", "display_name": "Maha", "link": "https://stackoverflow.com/users/8791871/maha"}, "edited": false, "score": 0, "creation_date": 1524705353, "post_id": 50011438, "comment_id": 87082966, "body": "Yes, that is what your original code tried to do. I don&#39;t like playing 20 questions."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 0, "last_activity_date": 1524618021, "last_edit_date": 1524618021, "creation_date": 1524608113, "answer_id": 50011438, "question_id": 50010753, "link": "https://stackoverflow.com/questions/50010753/type-mismatch-error-while-copy-data-from-excel-to-another-excel/50011438#50011438", "title": "Type Mismatch error while copy data from excel to another excel", "body": "<p>This code will run and I've tried to guess your purpose. You will be left with an open workbook.</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n    Dim dataRange As variant, myData As Workbook\n\n    dataRange = Worksheets(\"Sheet1\").range(\"A1:T1\").value\n\n    Set myData = Workbooks.Open(\"C:\\Users\\mahather\\Desktop\\Report\\Test.xlsx\")\n\n    with mydata.Worksheets(\"Sheet1\")\n        with .Range(\"A3:T3\").CurrentRegion\n            .offset(.rows.count, 0).resize(1, .columns.count) = dataRange\n        end with\n        .parent.save\n        '.parent.close savechanges:=true\n    end with\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 8791871, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a679dc4eff8c5b6ac9abb9234b854086?s=128&d=identicon&r=PG&f=1", "display_name": "Maha", "link": "https://stackoverflow.com/users/8791871/maha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 53, "favorite_count": 1, "accepted_answer_id": 50011438, "answer_count": 2, "score": 0, "last_activity_date": 1524618021, "creation_date": 1524604151, "last_edit_date": 1531161705, "question_id": 50010753, "link": "https://stackoverflow.com/questions/50010753/type-mismatch-error-while-copy-data-from-excel-to-another-excel", "title": "Type Mismatch error while copy data from excel to another excel", "body": "<p>Type Mismatch error while copy data from excel to another excel</p>\n\n<p>I am getting Type Mismatch error .. please help thanks</p>\n\n<pre><code>Private Sub CommandButton1_Click()\nDim dataRange As String\nDim myData As Workbook\n\nWorksheets(\"Sheet1\").Select\ndataRange = Range(\"A1:T1\")\n\nSet myData = Workbook.Open(\"C:\\Users\\mahather\\Desktop\\Report\\Test.xlsx\")\nWorksheets(\"Sheet1\").Select\nWorksheets(\"Sheet1\").Range(\"A3:T3\").Select\nRowCount = Worksheets(\"Sheet1\").Range(\"A3:T3\").CurrentRegion.Rows.Count\nWith Worksheets(\"Sheet1\").Range(\"A3:T3\")\nRowCount = dataRange\nEnd With\nmyData.Save\nEnd Sub\n</code></pre>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 7422, "user_id": 1586390, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f07270207034d2bcbe347b028edc8f02?s=128&d=identicon&r=PG", "display_name": "Sorceri", "link": "https://stackoverflow.com/users/1586390/sorceri"}, "edited": false, "score": 0, "creation_date": 1524602688, "post_id": 50010397, "comment_id": 87037561, "body": "you should probably post the entire &#39;doMacro&#39; macro and also show how you implemented Exit Function and end."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1524603398, "post_id": 50010397, "comment_id": 87037826, "body": "It looks like you&#39;re looking for a way to handle run-time errors. Would you like to insert an <code>On Error</code> statement?"}], "answers": [{"comments": [{"owner": {"reputation": 65, "user_id": 2092841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/28c000b70d15dd1ec4175c0aef7c37c5?s=128&d=identicon&r=PG", "display_name": "Haki_z", "link": "https://stackoverflow.com/users/2092841/haki-z"}, "edited": false, "score": 0, "creation_date": 1524667418, "post_id": 50010649, "comment_id": 87066343, "body": "Tried this but one of the funcitons in the macro still produces a run-time error, which halts execution and forces me to end."}], "tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": false, "score": 0, "last_activity_date": 1524603595, "creation_date": 1524603595, "answer_id": 50010649, "question_id": 50010397, "link": "https://stackoverflow.com/questions/50010397/exiting-multi-step-access-vba-macro-on-error-but-continue-code-that-called-the-m/50010649#50010649", "title": "Exiting Multi-Step Access VBA Macro on Error but Continue Code that called the Macro", "body": "<p>Wrap the <code>RunMacro</code> statement with <code>On Error</code> statements - <code>Resume Next</code> to turn off error handling, <code>GoTo 0</code> to restore it:</p>\n\n<pre><code>For Each APP In sArr\n    On Error Resume Next\n        DoCmd.RunMacro \"doMacro\"\n        If Err.Number &lt;&gt; 0 Then\n            'assuming APP has a Name property:\n            \"Macro 'doMacro' failed in \" &amp; APP.Name &amp; \": \" &amp; Err.Description\n        End If\n    On Error GoTo 0\nNext\n</code></pre>\n"}], "owner": {"reputation": 65, "user_id": 2092841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/28c000b70d15dd1ec4175c0aef7c37c5?s=128&d=identicon&r=PG", "display_name": "Haki_z", "link": "https://stackoverflow.com/users/2092841/haki-z"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 205, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1594635647, "creation_date": 1524602258, "last_edit_date": 1594635647, "question_id": 50010397, "link": "https://stackoverflow.com/questions/50010397/exiting-multi-step-access-vba-macro-on-error-but-continue-code-that-called-the-m", "title": "Exiting Multi-Step Access VBA Macro on Error but Continue Code that called the Macro", "body": "<p>I have a macro that calls 4 functions one after the other. </p>\n\n<p>The macro is called like this:</p>\n\n<pre><code>For Each APP In sArr\n    DoCmd.RunMacro (\"doMacro\")\nNext\n</code></pre>\n\n<p>If the macro fails at its first function, I want to exit the function, exit the macro but continue the for loop above.</p>\n\n<p>I tried <strong>Exit Function</strong>, but it exits the function and continues the macro.\nI tried <strong>End</strong> but that stops all code execution, which is not what I want.</p>\n\n<p>How would I exit the macro but continue the for loop?</p>\n"}, {"tags": ["excel", "vba", "outlook"], "comments": [{"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1524602160, "post_id": 50010342, "comment_id": 87037346, "body": "Which line is the error?"}, {"owner": {"reputation": 1117, "user_id": 6836407, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/69832d4c9bf4d0b26bd4e44306b39528?s=128&d=identicon&r=PG&f=1", "display_name": "Selkie", "link": "https://stackoverflow.com/users/6836407/selkie"}, "reply_to_user": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1524602462, "post_id": 50010342, "comment_id": 87037463, "body": "I apologize - Call SaveEmailAttachment(olFolder.Items.Item(iRow)) - it&#39;s when I try to pass the e-mail to the save-down macro."}, {"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1524607075, "post_id": 50010342, "comment_id": 87039025, "body": "I&#39;m not getting any error- also are trying to loop through only items with attachment or all items?"}, {"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1524607241, "post_id": 50010342, "comment_id": 87039081, "body": "see if this helps on subfolders <a href=\"https://stackoverflow.com/a/49683587/4539709\">stackoverflow.com/a/49683587/4539709</a>"}, {"owner": {"reputation": 1117, "user_id": 6836407, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/69832d4c9bf4d0b26bd4e44306b39528?s=128&d=identicon&r=PG&f=1", "display_name": "Selkie", "link": "https://stackoverflow.com/users/6836407/selkie"}, "reply_to_user": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1524607303, "post_id": 50010342, "comment_id": 87039102, "body": "Not all e-mails have attachments, but I thought that was handled with the &quot;for each objatt&quot; line"}], "answers": [{"tags": [], "owner": {"reputation": 7422, "user_id": 1586390, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f07270207034d2bcbe347b028edc8f02?s=128&d=identicon&r=PG", "display_name": "Sorceri", "link": "https://stackoverflow.com/users/1586390/sorceri"}, "is_accepted": false, "score": 1, "last_activity_date": 1524606604, "last_edit_date": 1524606604, "creation_date": 1524603379, "answer_id": 50010602, "question_id": 50010342, "link": "https://stackoverflow.com/questions/50010342/scraping-outlook-e-mails-using-vba-type-mismatch/50010602#50010602", "title": "Scraping Outlook E-mails using VBA - type mismatch", "body": "<p>test for the TypeOf item and if it is a mailItem pass it.</p>\n\n<pre><code>If TypeOf olFolder.Items.Item(iRow) Is MailItem Then\n    Call SaveEmailAttachment(olFolder.Items.Item(iRow))\nend if\n</code></pre>\n"}], "owner": {"reputation": 1117, "user_id": 6836407, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/69832d4c9bf4d0b26bd4e44306b39528?s=128&d=identicon&r=PG&f=1", "display_name": "Selkie", "link": "https://stackoverflow.com/users/6836407/selkie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 439, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1593004084, "creation_date": 1524602030, "last_edit_date": 1593004084, "question_id": 50010342, "link": "https://stackoverflow.com/questions/50010342/scraping-outlook-e-mails-using-vba-type-mismatch", "title": "Scraping Outlook E-mails using VBA - type mismatch", "body": "<p>I'm currently working on a macro to scrape outlook e-mails and attachments. Having a minor type mismatch error, hoping that someone can point out what data type I need. </p>\n\n<p>So I'm aware there's a large practicality hurdle that I'll need to face at some point. Right now I'm focusing on making things work, then optimizing</p>\n\n<pre><code>    Sub FetchEmailData()\n\nDim appOutlook As Object\nDim olNs As Object\nDim olFolder As Object\nDim olItem As Object\nDim iRow As Integer\n\n' Get/create Outlook Application\nOn Error Resume Next\nSet appOutlook = GetObject(, \"Outlook.Application\")\nIf appOutlook Is Nothing Then\n    Set appOutlook = CreateObject(\"Outlook.Application\")\nEnd If\nOn Error GoTo 0\n\nSet olNs = appOutlook.GetNamespace(\"MAPI\")\nSet olFolder = olNs.GetDefaultFolder(6) ' 6 == Inbox for some reason\n\n\nFor iRow = 1 To olFolder.Items.Count\n\n    'Check if we care about the e-mail\n    Call SaveEmailAttachment(olFolder.Items.Item(iRow))\n    'Go onto the next one if we don't\n\n    'ThisWorkbook.Sheets(\"Test\").Cells(iRow + 1, 1) = olFolder.Items.Item(iRow).SenderEmailAddress\n    'ThisWorkbook.Sheets(\"Test\").Cells(iRow + 1, 2) = olFolder.Items.Item(iRow).Subject\n    'ThisWorkbook.Sheets(\"Test\").Cells(iRow + 1, 3) = olFolder.Items.Item(iRow).To\n    'ThisWorkbook.Sheets(\"Test\").Cells(iRow + 1, 3) = olFolder.Items.Item(iRow).Size\n\n\n\nNext iRow\n\nEnd Sub\n\n\n\nSub SaveEmailAttachment(itm As Outlook.MailItem)\nDim objAtt As Outlook.Attachment\nDim saveFolder As String\n Dim dateFormat As String\n\n        saveFolder = ThisWorkbook.Names(\"EmailAttachmentSavePath\").RefersToRange.Value2\n        dateFormat = Format(itm.ReceivedTime, \"yyyy-mm-dd Hmm \")\n    For Each objAtt In itm.Attachments\n        objAtt.SaveAsFile saveFolder &amp; \"\\\" &amp; dateFormat &amp; objAtt.DisplayName\n    Next\n\nEnd Sub\n</code></pre>\n\n<p>So the data type mismatch is because I'm sending an outlook folder item, but the receiving macro is expecting an outlook mailitem. I know I need to get both of them to the same item type, probably via a dim, but I'm not quite sure which one is better to use, and how I'd need to adapt the saveemailattachment code to properly compensate. </p>\n\n<p>Bonus question: Is there a way to scrape a subfolder by name?</p>\n"}, {"tags": ["vba", "ms-access", "subreport"], "comments": [{"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 1, "creation_date": 1524601034, "post_id": 50010096, "comment_id": 87036851, "body": "An error? There&#39;s lots of those. Which one are you getting?"}, {"owner": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "edited": false, "score": 0, "creation_date": 1524628470, "post_id": 50010096, "comment_id": 87043872, "body": "Reports!Production![subreport dbo_Downsubreport7] is not a query"}, {"owner": {"reputation": 6200, "user_id": 7923463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8063a07902a59be5f26d31626600dee?s=128&d=identicon&r=PG&f=1", "display_name": "Kostas K.", "link": "https://stackoverflow.com/users/7923463/kostas-k"}, "edited": false, "score": 0, "creation_date": 1524637928, "post_id": 50010096, "comment_id": 87047136, "body": "<code>dbs.QueryDefs()</code> is expecting the name of the query to be passed as string, e.g. <code>QueryDefs(&quot;QueryName&quot;)</code> See Sergey&#39;s answer below."}], "answers": [{"tags": [], "owner": {"reputation": 6188, "user_id": 5339178, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5DL9b.jpg?s=128&g=1", "display_name": "Sergey S.", "link": "https://stackoverflow.com/users/5339178/sergey-s"}, "is_accepted": false, "score": 0, "last_activity_date": 1524629496, "creation_date": 1524629496, "answer_id": 50013936, "question_id": 50010096, "link": "https://stackoverflow.com/questions/50010096/run-a-select-command-from-a-subreport-in-vba-access/50013936#50013936", "title": "Run a Select command from a subreport in vba access", "body": "<p>If you have saved query with name <code>subreport dbo_Downsubreport7</code> (it should be visible in Navigation Pane), then use this syntax:</p>\n\n<pre><code>Set qdf = dbs.QueryDefs(\"subreport dbo_Downsubreport7\")\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 9693356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c3f279ce788c98dff7505e57b7f6fca?s=128&d=identicon&r=PG&f=1", "display_name": "vafa", "link": "https://stackoverflow.com/users/9693356/vafa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 39, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1524629496, "creation_date": 1524600898, "last_edit_date": 1524628551, "question_id": 50010096, "link": "https://stackoverflow.com/questions/50010096/run-a-select-command-from-a-subreport-in-vba-access", "title": "Run a Select command from a subreport in vba access", "body": "<p>I want to run a select code from a table in Sub Report my code is:</p>\n\n<pre><code>Dim dbs As Database\n  Set dbs = CurrentDb()\n Dim qdf As QueryDef\n Set qdf = dbs.QueryDefs(Reports!Production![subreport dbo_Downsubreport7])\n  qdf.SQL = \"Select code from dbo_code\"\n</code></pre>\n\n<p>I am getting error at line \"Set qdf\"</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 9693177, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Fzbxw.png?s=128&g=1", "display_name": "KyleGReportWriter", "link": "https://stackoverflow.com/users/9693177/kylegreportwriter"}, "edited": false, "score": 0, "creation_date": 1524659866, "post_id": 50010048, "comment_id": 87061046, "body": "I had to modify the Selection.Copy line to end in (j, i), as the original was only copying to row 12. Thanks!"}], "tags": [], "owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "is_accepted": true, "score": 0, "last_activity_date": 1524600709, "creation_date": 1524600709, "answer_id": 50010048, "question_id": 50009835, "link": "https://stackoverflow.com/questions/50009835/vba-macro-to-fill-in-cell-based-on-2-different-fields-that-match-to-a-list-of-va/50010048#50010048", "title": "VBA macro to fill in cell based on 2 different fields that match to a list of values", "body": "<p>I think this is what you need - you can just loop through all the columns (in your case, <code>12 to 175</code> represent L to FR), and then loop through rows <code>11 to 110</code>. Once you get a match, the destination cell is the corresponding column and row to <code>i</code> and <code>j</code>:</p>\n\n<pre><code>Sub RectangleRoundedCorners1_Click()\n\nDim sourceSht As Worksheet: Set sourceSht = DataEntry\nDim destSht As Worksheet:   Set destSht = Labels\nDim Selection As Range:     Set Selection = DataEntry.Range(\"C5\") ' This is the # 1 I was talking about'\nDim Acct As Range:          Set Acct = DataEntry.Range(\"B8\")\nDim SpecErr As Range:       Set SpecErr = DataEntry.Range(\"C4\")\n\nDim i As Long, j As Long\n\nFor i = 12 To 175 'L to FR\n    For j = 11 To 110\n        If SpecErr.Value = Labels.Cells(4, i) And Acct.Value = Labels.Cells(j, 7) Then\n            Selection.Copy Destination:=Labels.Cells(i, j)\n        End If\n     Next j\nNext i\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 13, "user_id": 9693177, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Fzbxw.png?s=128&g=1", "display_name": "KyleGReportWriter", "link": "https://stackoverflow.com/users/9693177/kylegreportwriter"}, "edited": false, "score": 0, "creation_date": 1524659953, "post_id": 50010213, "comment_id": 87061113, "body": "The formula will not work, as I need the 1 to stay in each cell after I change B8. VBA didn&#39;t do the trick either. Thanks"}], "tags": [], "owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "is_accepted": false, "score": 0, "last_activity_date": 1524601801, "last_edit_date": 1524601801, "creation_date": 1524601409, "answer_id": 50010213, "question_id": 50009835, "link": "https://stackoverflow.com/questions/50009835/vba-macro-to-fill-in-cell-based-on-2-different-fields-that-match-to-a-list-of-va/50010213#50010213", "title": "VBA macro to fill in cell based on 2 different fields that match to a list of values", "body": "<p>Does this have to be VBA? You could do this with a formula.  In sheet 'Labels' cell L11, use this formula and copy over and down:</p>\n\n<pre><code>=IF(AND(DataEntry!$B$8=$G11,DataEntry!$B$4=L$4),1,\"\")\n</code></pre>\n\n<p>If it must be VBA, then this can be done basically as a one-liner:</p>\n\n<pre><code>Sub RectangleRoundedCorners1_Click()\n\n    On Error Resume Next    'Ignore errors if any fields are not filled out\n    Sheets(\"Labels\").Cells(Evaluate(\"MATCH(DataEntry!$B$8,Labels!$G:$G,0)\"), Evaluate(\"MATCH(DataEntry!$B$4,Labels!$4:$4,0)\")).Value = Sheets(\"DataEntry\").Range(\"B5\").Value\n    On Error GoTo 0         'Clear \"On Error Resume Next\" condition\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 9693177, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Fzbxw.png?s=128&g=1", "display_name": "KyleGReportWriter", "link": "https://stackoverflow.com/users/9693177/kylegreportwriter"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 363, "favorite_count": 0, "accepted_answer_id": 50010048, "answer_count": 2, "score": 1, "last_activity_date": 1524601801, "creation_date": 1524599741, "question_id": 50009835, "link": "https://stackoverflow.com/questions/50009835/vba-macro-to-fill-in-cell-based-on-2-different-fields-that-match-to-a-list-of-va", "title": "VBA macro to fill in cell based on 2 different fields that match to a list of values", "body": "<p>I have a Button I want to assign a macro to that, when clicked, enters in the number 1 into a specific cell on another sheet within the same workbook. This macro needs to a) match the value in cell B8 to a range of values in another sheet column (G11:G110) and also b) match the value in cell C4 to a range of values in another sheet rows (L4:FR4). </p>\n\n<p>So if the value in B8 = 01234 it will do a vlookup type function on G11:G110. Once it finds its match, it then looks at the value in C4 = \"Application\" and finds it match in L4:FR4. I should note that there are no duplicate values in any field and the values in L4:FR4 are static, whereas the values in cells G11:G110 change upon refresh. </p>\n\n<p>I have tried Select Case, If...And...Then... and the only thing I got to work was simply saying \nIf B8 = G11 Then blah blah L11\nIf B8 = G12 Then blah blah L12</p>\n\n<pre><code>Sub RectangleRoundedCorners1_Click()\n\nDim sourceSht As Worksheet: Set sourceSht = DataEntry\nDim destSht As Worksheet:   Set destSht = Labels\nDim Selection As Range:     Set Selection = DataEntry.Range(\"C5\")' This is the # 1 I was talking about'\nDim Acct As Range:          Set Acct = DataEntry.Range(\"B8\")\nDim SpecErr As Range:       Set SpecErr = DataEntry.Range(\"C4\")\n\nIf (SpecErr.Value = Labels.Range(\"L4\")) And (Acct.Value = Labels.Range(\"G11\")) Then\n    Selection.Copy Destination:=Labels.Range(\"L11\")\nEnd If\nIf (SpecErr.Value = Labels.Range(\"M4\")) And (Acct.Value = Labels.Range(\"G11\")) Then\n    Selection.Copy Destination:=Labels.Range(\"M11\")\nEnd If\nEnd Sub\n</code></pre>\n\n<p>I ran out of space in the code doing it like this, as I need to go from L4 to FR4, and then do this 100 times by adjusting G11 to G12 &amp; L11 to L12 etc.</p>\n\n<p>The sheet holding the main data and Button I called DataEntry, and the sheet that I need to lookup on and have the 1 entered on is called Labels.</p>\n"}, {"tags": ["excel", "vba", "sap-gui"], "answers": [{"comments": [{"owner": {"reputation": 343, "user_id": 9626171, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9587856742de2015aec848c7749c4b15?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan", "link": "https://stackoverflow.com/users/9626171/jordan"}, "edited": false, "score": 0, "creation_date": 1524659033, "post_id": 50009815, "comment_id": 87060386, "body": "Hey Jean, I was able to try your solution this morning and it worked, but one issue appeared where it stopped moving down the column the second it ran out of screen space. So the last batch it copied was the one at the bottom of my screen but this is a fairly long list that takes up multiple screen lengths. Do you happen to know a solution to this problem?"}, {"owner": {"reputation": 786, "user_id": 9571900, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Jean Rostan", "link": "https://stackoverflow.com/users/9571900/jean-rostan"}, "reply_to_user": {"reputation": 343, "user_id": 9626171, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9587856742de2015aec848c7749c4b15?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan", "link": "https://stackoverflow.com/users/9626171/jordan"}, "edited": false, "score": 0, "creation_date": 1524663955, "post_id": 50009815, "comment_id": 87063938, "body": "@Jordan I&#39;m not sure I understand, could you provide more details ?"}, {"owner": {"reputation": 343, "user_id": 9626171, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9587856742de2015aec848c7749c4b15?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan", "link": "https://stackoverflow.com/users/9626171/jordan"}, "edited": false, "score": 0, "creation_date": 1524667577, "post_id": 50009815, "comment_id": 87066473, "body": "Sure, my screen is only able to fit about 1/3 of the column I am copying down. I noticed that it moves down the column and copies each value to excel until it reaches the bottom of my screen. Even though there is more data down the column, the code acts like it cannot &quot;see&quot; the data below and gives me error 619 again. I tried adjust my screen where I shifted down a few more lines (was only able to fit 2 more) It then was able to copy these as well so it must be going off of what it can &quot;see&quot;"}, {"owner": {"reputation": 786, "user_id": 9571900, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Jean Rostan", "link": "https://stackoverflow.com/users/9571900/jean-rostan"}, "reply_to_user": {"reputation": 343, "user_id": 9626171, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9587856742de2015aec848c7749c4b15?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan", "link": "https://stackoverflow.com/users/9626171/jordan"}, "edited": false, "score": 0, "creation_date": 1524671951, "post_id": 50009815, "comment_id": 87069532, "body": "It shouldn&#39;t be based on what it can see, it should be able to access these other values via script (we&#39;re talking about your SAP Gui screen interface right, when you&#39;re speaking about your screen). If it works like that (which I doubt a bit, having worked a bit with SAP scripting), you could add a routine in your code to scroll down the screen. If you do not know the code for it, just record it with VBA scripting just as you did for the first part. @Jordan"}, {"owner": {"reputation": 343, "user_id": 9626171, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9587856742de2015aec848c7749c4b15?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan", "link": "https://stackoverflow.com/users/9626171/jordan"}, "edited": false, "score": 0, "creation_date": 1524744897, "post_id": 50009815, "comment_id": 87101352, "body": "I agree that it is odd. I have had some weird experiences from the scripting in the past but it really does stop at the end of the visible interface. I will be adding a scrolling function later today to hopefully aid with the issue"}], "tags": [], "owner": {"reputation": 786, "user_id": 9571900, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Jean Rostan", "link": "https://stackoverflow.com/users/9571900/jean-rostan"}, "is_accepted": true, "score": 3, "last_activity_date": 1524599672, "creation_date": 1524599672, "answer_id": 50009815, "question_id": 50009772, "link": "https://stackoverflow.com/questions/50009772/selecting-sap-fields-using-a-do-loop-vba/50009815#50009815", "title": "Selecting SAP Fields using a Do Loop VBA", "body": "<p>Yes, I implemented the same kind of script. You need to construct your string, converting i to a string at the same time:</p>\n\n<p><code>session.findById(\"wnd[0]/usr/lbl[12,\" &amp; CStr(i) &amp; \"]\").caretPosition = 6</code></p>\n\n<p><code>CStr(i)</code> converts to string, while <code>&amp;</code> concatenates strings together.</p>\n\n<p>I only changed a single line, but you should be able to do it correctly, since you've identified your problem, so you have a grasp on how things work. Good luck,</p>\n"}, {"tags": [], "owner": {"reputation": 26, "user_id": 15415295, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a5b6e4418daf580c25c86d51396748ac?s=128&d=identicon&r=PG", "display_name": "Samuel Wareham", "link": "https://stackoverflow.com/users/15415295/samuel-wareham"}, "is_accepted": false, "score": 0, "last_activity_date": 1615999329, "last_edit_date": 1615999329, "creation_date": 1615987329, "answer_id": 66673991, "question_id": 50009772, "link": "https://stackoverflow.com/questions/50009772/selecting-sap-fields-using-a-do-loop-vba/66673991#66673991", "title": "Selecting SAP Fields using a Do Loop VBA", "body": "<p>Have you tried referring to the columns by name rather than by number?</p>\n<p>Here is my loop that captures each column in a row and moves to the next</p>\n<pre><code>hRows = session.findById(&quot;wnd[0]/usr/cntlGRID1/shellcont/shell&quot;).RowCount()\nFor h = 0 To hRows - 1 'Fill Dispatch Sheet at &quot;A12&quot;\n    Cells(h + 12, 4).Value = session.findById(&quot;wnd[0]/usr/cntlGRID1/shellcont/shell&quot;).getcellValue(h, &quot;ERDAT&quot;)\n    Cells(h + 12, 5).Value = session.findById(&quot;wnd[0]/usr/cntlGRID1/shellcont/shell&quot;).getcellValue(h, &quot;KTEXT&quot;)\n    Cells(h + 12, 6).Value = session.findById(&quot;wnd[0]/usr/cntlGRID1/shellcont/shell&quot;).getcellValue(h, &quot;ERNAM&quot;)\n    Cells(h + 12, 1).Value = session.findById(&quot;wnd[0]/usr/cntlGRID1/shellcont/shell&quot;).getcellValue(h, &quot;GEWRK&quot;)\n    Cells(h + 12, 2).Value = session.findById(&quot;wnd[0]/usr/cntlGRID1/shellcont/shell&quot;).getcellValue(h, &quot;AUFNR&quot;)\n    Cells(h + 12, 3).Value = session.findById(&quot;wnd[0]/usr/cntlGRID1/shellcont/shell&quot;).getcellValue(h, &quot;USTXT&quot;)\nNext\n</code></pre>\n"}], "owner": {"reputation": 343, "user_id": 9626171, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9587856742de2015aec848c7749c4b15?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan", "link": "https://stackoverflow.com/users/9626171/jordan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1527, "favorite_count": 0, "accepted_answer_id": 50009815, "answer_count": 2, "score": 1, "last_activity_date": 1615999329, "creation_date": 1524599498, "last_edit_date": 1610052525, "question_id": 50009772, "link": "https://stackoverflow.com/questions/50009772/selecting-sap-fields-using-a-do-loop-vba", "title": "Selecting SAP Fields using a Do Loop VBA", "body": "<p>I am working on a macro to go into SAP and select cells in a column to extract to excel. Now if this was excel, this would be no problem as I would simply use a do loop to travel down the column copying along the way. I am in SAP GUI however which is compatible with VBA and it is a little different. I recorded a script of me clicking down a column to see how the code changes. This is what I got.</p>\n\n<pre><code>session.findById(\"wnd[0]\").maximize\nsession.findById(\"wnd[0]/usr/lbl[12,13]\").setFocus\nsession.findById(\"wnd[0]/usr/lbl[12,13]\").caretPosition = 6\nsession.findById(\"wnd[0]\").sendVKey 0\nsession.findById(\"wnd[0]/usr/lbl[12,14]\").setFocus\nsession.findById(\"wnd[0]/usr/lbl[12,14]\").caretPosition = 4\nsession.findById(\"wnd[0]\").sendVKey 0\nsession.findById(\"wnd[0]/usr/lbl[12,15]\").setFocus\nsession.findById(\"wnd[0]/usr/lbl[12,15]\").caretPosition = 5\nsession.findById(\"wnd[0]\").sendVKey 0\nsession.findById(\"wnd[0]/usr/lbl[12,16]\").setFocus\nsession.findById(\"wnd[0]/usr/lbl[12,16]\").caretPosition = 5\nsession.findById(\"wnd[0]\").sendVKey 0\nsession.findById(\"wnd[0]/usr/lbl[12,17]\").setFocus\nsession.findById(\"wnd[0]/usr/lbl[12,17]\").caretPosition = 5\nsession.findById(\"wnd[0]\").sendVKey 0\n</code></pre>\n\n<p>You can see that a particular value increases from 13 up to 17 as I moved down the column. I figured I could incorporate a do loop to then travel down the column and copy the values. Here is my relevant code</p>\n\n<pre><code>i = 13\n\nDo\n\nsession.findById(\"wnd[0]\").maximize\nCurrent_Batch = session.findById(\"wnd[0]/usr/lbl[12,i]\").Text\nsession.findById(\"wnd[0]/usr/lbl[12,i]\").caretPosition = 6\nsession.findById(\"wnd[0]\").sendVKey 0\n\nIf Current_Batch = \"\" Then\nExit Do\nEnd If\n\nCells(i - 11, 4) = Current_Batch\n\n\ni = i + 1\n\nLoop\n</code></pre>\n\n<p>This however does not work as it does not recognize the i as a variable. It gives me error 619 (could not find ID)</p>\n\n<p>Does anyone know of a way to make this work?</p>\n"}, {"tags": ["vba", "sharepoint", "ms-access-2013"], "answers": [{"tags": [], "owner": {"reputation": 131, "user_id": 5686991, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ce5403c501c93cfc498deb50db5087c?s=128&d=identicon&r=PG&f=1", "display_name": "user78090", "link": "https://stackoverflow.com/users/5686991/user78090"}, "is_accepted": true, "score": 1, "last_activity_date": 1525195678, "last_edit_date": 1525195678, "creation_date": 1524670476, "answer_id": 50026209, "question_id": 50009574, "link": "https://stackoverflow.com/questions/50009574/how-do-i-use-vba-in-ms-access-to-change-the-address-of-linked-sharepoint-lists/50026209#50026209", "title": "How do I use VBA in MS Access to change the address of linked sharepoint lists", "body": "<p>Related tables can't be deleted but can be dropped.  Adding a table will also add related tables, so I was having troubles with duplicate adds.  I stored all names to delete first and re-add later (if they don't already exist).  The sharepoint address is part of the connection string so I was able to sift the tables I wanted like that.</p>\n\n<p>Edit: Using the DoCmd.TransferSharePointList can cause lists with lookup columns to come in as read-only.  For lists like that, delete and add them manually after running.</p>\n\n<pre><code>Sub ChangeSPTables()\n'Step through all table definitions and check if the old sharepoint address appears in the connection string\n'If so, stores the name of the table, deletes all such tables, and re-adds them from the new sharepoint address\n'The list is used because sometimes other tables are brought in automatically as relationships and I don't\n'want extra copies or instances where the table has a 1 on the end of the name\n'Will not work on things that have been renamed since they were brought in from sharepoint\n'You should probably only run this on a copy of the database for saftey's sake\n\nDim db As dao.Database\nDim tdf As dao.TableDef\nDim MBr As VbMsgBoxResult\nDim i As Long: i = 1\nDim ListNames(1 To 20) As String 'Assumed to be 20 or less\n\n'The old and new sharepoint addresses\nDim OldSP As String\nDim NewSP As String\nOldSP = \"https://old\"\nNewSP = \"https://new\"\n\nSet db = CurrentDb\nFor Each tdf In db.TableDefs\n    If Not (tdf.Name Like \"MSys*\" Or tdf.Name Like \"~*\") And InStr(1, tdf.Connect, OldSP) &gt; 0 Then\n        ListNames(i) = tdf.Name\n        i = i + 1\n        Debug.Print tdf.Name 'For review of which tables were redone\n        db.Execute \"drop table [\" &amp; tdf.Name &amp; \"]\", dbFailOnError 'drop table avoids problems with relationships between tables\n    End If\nNext\n\ni = 1\nDo Until ListNames(i) = \"\"\n    If IsNull(DLookup(\"Name\", \"MSysObjects\", \"Name='\" &amp; ListNames(i) &amp; \"'\")) Then 'Some things get re-added by relationship\n        DoCmd.TransferSharePointList acLinkSharePointList, NewSP, ListNames(i)\n    End If\n    i = i + 1\nLoop\n\n'Hide the sharepoint tables\nFor Each tdf In db.TableDefs\n    If Not (tdf.Name Like \"MSys*\" Or tdf.Name Like \"~*\") And InStr(1, tdf.Connect, NewSP) &gt; 0 Then\n        Application.SetHiddenAttribute acTable, tdf.Name, True\n    End If\nNext\n\nSet tdf = Nothing\nSet db = Nothing\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 131, "user_id": 5686991, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ce5403c501c93cfc498deb50db5087c?s=128&d=identicon&r=PG&f=1", "display_name": "user78090", "link": "https://stackoverflow.com/users/5686991/user78090"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 314, "favorite_count": 0, "accepted_answer_id": 50026209, "answer_count": 1, "score": 0, "last_activity_date": 1525195678, "creation_date": 1524598520, "question_id": 50009574, "link": "https://stackoverflow.com/questions/50009574/how-do-i-use-vba-in-ms-access-to-change-the-address-of-linked-sharepoint-lists", "title": "How do I use VBA in MS Access to change the address of linked sharepoint lists", "body": "<p>At work we have MS Access databases that use sharepoint lists as linked tables because we like the stability.  The address of our sharepoint site is going to change.  I want to run a VBA sub to change the tables from the old address to the new.  Here is what I have so far, but there are two problems:</p>\n\n<ol>\n<li>It does not automatically detect which tables are sharepoint lists without asking</li>\n<li>Some tables are 'participating in one or more relationships' and give an error when deleted</li>\n</ol>\n\n<p>How do I make it better?</p>\n\n<pre><code>  Sub ChangeSPTables()\n\n    Dim db As DAO.Database\n    Dim tdf As DAO.TableDef\n    Dim MBr As VbMsgBoxResult\n    Dim N As String\n\n    Set db = CurrentDb\n    For Each tdf In db.TableDefs\n        If Not (tdf.Name Like \"MSys*\" Or tdf.Name Like \"~*\") Then\n            N = tdf.Name\n            MBr = MsgBox(\"Delete and relink \" &amp; N &amp; \"?\", vbYesNoCancel)\n            If MBr = vbYes Then\n                DoCmd.DeleteObject acTable, N\n                DoCmd.TransferSharePointList acLinkSharePointList, \"https://redacted\", N\n            End If\n        End If\n    Next\n    Set tdf = Nothing\n    Set db = Nothing\n\n    End Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "excel-formula"], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user8517443"}, "edited": false, "score": 0, "creation_date": 1524598598, "post_id": 50009575, "comment_id": 87035716, "body": "Thanks so much.  This is exactly what I was looking for.  I&#39;ll accept this as answered in 10 minutes"}], "tags": [], "owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "is_accepted": true, "score": 1, "last_activity_date": 1524598524, "creation_date": 1524598524, "answer_id": 50009575, "question_id": 50009526, "link": "https://stackoverflow.com/questions/50009526/cap-values-within-an-averageif-statement/50009575#50009575", "title": "Cap values within an AVERAGEIF() statement", "body": "<p>You can use <code>Averageifs()</code>:</p>\n\n<pre><code>=AVERAGEIFS(J2:J214, J2:J214, \"&gt;0\", J2:J214, \"&lt;=1\")\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user8517443"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 26, "favorite_count": 0, "accepted_answer_id": 50009575, "answer_count": 1, "score": 0, "last_activity_date": 1524598680, "creation_date": 1524598316, "question_id": 50009526, "link": "https://stackoverflow.com/questions/50009526/cap-values-within-an-averageif-statement", "title": "Cap values within an AVERAGEIF() statement", "body": "<p>I want to find an average of the range J2:J214</p>\n\n<p>The range is full of percentages, many of which are 0 and I don't want 0's to be incorporated into the average.  Problem,  a few of these numbers are over 100% which distorts the average.  I want a function that will cap the inputs to the average at 100%.  Any help would be much appreciated </p>\n\n<pre><code>=AVERAGEIF(J2:J214,\"&lt;&gt;0\")\n</code></pre>\n"}, {"tags": ["excel", "worksheet", "vba"], "answers": [{"comments": [{"owner": {"reputation": 101, "user_id": 8222440, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154695122027906/picture?type=large", "display_name": "Sharat V Chandrasekhar", "link": "https://stackoverflow.com/users/8222440/sharat-v-chandrasekhar"}, "edited": false, "score": 0, "creation_date": 1524599260, "post_id": 50009274, "comment_id": 87036053, "body": "Brilliant! Thanks. Worked like a charm! I have never changed a CodeName and don&#39;t intend to, so this is ideal. If I delete a sheet for any reason, a simple on error resume next ought to work."}], "tags": [], "owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "is_accepted": false, "score": 0, "last_activity_date": 1524597288, "creation_date": 1524597288, "answer_id": 50009274, "question_id": 50009130, "link": "https://stackoverflow.com/questions/50009130/preserve-sheet-macro-to-link-cells-with-sheet-name-change/50009274#50009274", "title": "Preserve Sheet Macro to Link Cells with Sheet Name Change", "body": "<p>The \"workaround\" is to use the <a href=\"https://excelmacromastery.com/excel-vba-worksheet/#Using_the_Code_Name_of_a_Worksheet\" rel=\"nofollow noreferrer\">codename</a> of the worksheet instead</p>\n\n<blockquote>\n  <p><strong>Using the Code Name of a Worksheet</strong></p>\n  \n  <p>The best method of accessing the worksheet is using the code name.\n  Each worksheet has a sheet name and a code name. The sheet name is the\n  name that appears in the worksheet tab in Excel.</p>\n  \n  <p>Changing the sheet name does not change the code name meaning that\n  referencing a sheet by the code name is a good idea.</p>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 101, "user_id": 8222440, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154695122027906/picture?type=large", "display_name": "Sharat V Chandrasekhar", "link": "https://stackoverflow.com/users/8222440/sharat-v-chandrasekhar"}, "is_accepted": false, "score": 0, "last_activity_date": 1524599829, "creation_date": 1524599829, "answer_id": 50009859, "question_id": 50009130, "link": "https://stackoverflow.com/questions/50009130/preserve-sheet-macro-to-link-cells-with-sheet-name-change/50009859#50009859", "title": "Preserve Sheet Macro to Link Cells with Sheet Name Change", "body": "<p>Following Storax's excellent suggestion above, here is the fix that I implemented:</p>\n\n<p>In the first worksheet (which can be renamed at will):</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n Application.EnableEvents = False\n If (Target.Address = Range(\"INPUT_A_1\").Address) Then\n  SheetFromCodeName(\"Sheet2\").Range(\"INPUT_A_2\") = Target.Value\n End If\n Application.EnableEvents = True\nEnd Sub\n</code></pre>\n\n<p>and in the Second worksheet (which can also be renamed at will):</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n Application.EnableEvents = False\n If (Target.Address = Range(\"INPUT_A_2\").Address) Then\n  SheetFromCodeName(\"Sheet1\").Range(\"INPUT_A_1\") = Target.Value\n End If\n Application.EnableEvents = True\nEnd Sub\n</code></pre>\n\n<p>And finally, in any module:</p>\n\n<pre><code>Public Function SheetFromCodeName(CodeName$) As Worksheet\n    Dim sh As Worksheet\n    For Each sh In ThisWorkbook.Sheets\n        If sh.CodeName = CodeName Then\n           Set SheetFromCodeName = sh\n           Exit For\n        End If\n    Next sh\nEnd Function\n</code></pre>\n\n<p>The SheetName and CodeName association is according to:</p>\n\n<p><a href=\"https://i.stack.imgur.com/Kio38.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Kio38.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>If one has multiple sheets with linked cells, and any of the sheets is deleted, an <strong>On Error Resume Next</strong> should work.</p>\n"}, {"tags": [], "owner": {"reputation": 101, "user_id": 8222440, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154695122027906/picture?type=large", "display_name": "Sharat V Chandrasekhar", "link": "https://stackoverflow.com/users/8222440/sharat-v-chandrasekhar"}, "is_accepted": false, "score": 0, "last_activity_date": 1524676540, "last_edit_date": 1524676540, "creation_date": 1524601189, "answer_id": 50010166, "question_id": 50009130, "link": "https://stackoverflow.com/questions/50009130/preserve-sheet-macro-to-link-cells-with-sheet-name-change/50010166#50010166", "title": "Preserve Sheet Macro to Link Cells with Sheet Name Change", "body": "<p>In fact, the Sheet Index could be used instead thereby obviating the need for the <strong>SheetFromCodeName</strong> routine altogether.</p>\n\n<p>The syntax in this case in the first and second sheets would be</p>\n\n<pre><code>Worksheets(2).Range(\"INPUT_A_2\") = Target.Value\n</code></pre>\n\n<p>and</p>\n\n<pre><code>Worksheets(1).Range(\"INPUT_A_1\") = Target.Value\n</code></pre>\n"}], "owner": {"reputation": 101, "user_id": 8222440, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154695122027906/picture?type=large", "display_name": "Sharat V Chandrasekhar", "link": "https://stackoverflow.com/users/8222440/sharat-v-chandrasekhar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 127, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1524676540, "creation_date": 1524596721, "last_edit_date": 1531164843, "question_id": 50009130, "link": "https://stackoverflow.com/questions/50009130/preserve-sheet-macro-to-link-cells-with-sheet-name-change", "title": "Preserve Sheet Macro to Link Cells with Sheet Name Change", "body": "<p>I have two cells named <strong>INPUT_A_1</strong> and <strong>INPUT_A_2</strong> in worksheets named \"Sheet1\" and \"Sheet2\" respectively, that I'm linking (changing one cell triggers the identical change in the other) with the following sheet macros which work very well:</p>\n\n<p>In Sheet1:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n Application.EnableEvents = False\n If (Target.Address = Range(\"INPUT_A_1\").Address) Then\n  Sheets(\"Sheet2\").Range(\"INPUT_A_2\") = Target.Value\n End If\n Application.EnableEvents = True\nEnd Sub\n</code></pre>\n\n<p>and in Sheet2:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n Application.EnableEvents = False\n If (Target.Address = Range(\"INPUT_A_2\").Address) Then\n  Sheets(\"Sheet1\").Range(\"INPUT_A_1\") = Target.Value\n End If\n Application.EnableEvents = True\nEnd Sub\n</code></pre>\n\n<p>My problem is that owing to the syntax Sheets(<em>sheetname</em>).Range(<em>rangename</em>), if I decide to rename either or both worksheets, then I have to alter the macros accordingly. Is there some sort of workaround to this that does not involve summoning the cells by the corresponding worksheet name? This problem becomes decidedly more compelling when I have 3 or more linked cells each in a different worksheet.</p>\n\n<p>Thanks</p>\n"}, {"tags": ["excel", "copy-paste", "vba"], "answers": [{"tags": [], "owner": {"reputation": 387, "user_id": 7889517, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0dbabbb45e58afd3a6c7d7ee679d8eaf?s=128&d=identicon&r=PG&f=1", "display_name": "tsdn", "link": "https://stackoverflow.com/users/7889517/tsdn"}, "is_accepted": false, "score": 0, "last_activity_date": 1524597666, "creation_date": 1524597666, "answer_id": 50009390, "question_id": 50008838, "link": "https://stackoverflow.com/questions/50008838/copy-the-values-only-between-worksheets/50009390#50009390", "title": "Copy the values only between worksheets", "body": "<p>I don't think this is possible when copying sheets.</p>\n\n<p>But you could try something like this:</p>\n\n<pre><code>Dim destWs As Worksheet\nDim AddressStr As String\n\nAddressStr = shtSummary.UsedRange.Address\n\nWith wbNew\n    Set destWs = .Sheets.Add(After:=.Sheets(.Sheets.Count))\nEnd With\n\ndestWs.Name = shtSummary.Name\ndestWs.Range(AddressStr).Value = shtSummary.Range(AddressStr).Value\n</code></pre>\n"}], "owner": {"reputation": 93, "user_id": 9128301, "user_type": "registered", "profile_image": "https://graph.facebook.com/10213641148676359/picture?type=large", "display_name": "Ahmed Afifi", "link": "https://stackoverflow.com/users/9128301/ahmed-afifi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 23, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1524597666, "creation_date": 1524595565, "last_edit_date": 1531164843, "question_id": 50008838, "link": "https://stackoverflow.com/questions/50008838/copy-the-values-only-between-worksheets", "title": "Copy the values only between worksheets", "body": "<p>I am using this line to copy some sheets between two workbooks</p>\n\n<pre><code>shtSummary.Copy after:=wbNew.Sheets(wbNew.Sheets.Count)\n</code></pre>\n\n<p>but it copys the equations not the values so it result to empty cells in <code>wbNew</code> Workbook</p>\n\n<p>How can I copy the values only between them?</p>\n"}, {"tags": ["excel", "excel-formula", "vba"], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 6177766, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0856e86b2070d19315bb9a0ff04820b7?s=128&d=identicon&r=PG", "display_name": "Pravin", "link": "https://stackoverflow.com/users/6177766/pravin"}, "edited": false, "score": 0, "creation_date": 1524596533, "post_id": 50008976, "comment_id": 87034651, "body": "Sir please see I have modified my query to make you more understand about it."}], "tags": [], "owner": {"reputation": 745, "user_id": 6121503, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f3841cbbb3e44f35e7b0466a35cc887d?s=128&d=identicon&r=PG&f=1", "display_name": "rickjerrity", "link": "https://stackoverflow.com/users/6121503/rickjerrity"}, "is_accepted": false, "score": 0, "last_activity_date": 1524596109, "creation_date": 1524596109, "answer_id": 50008976, "question_id": 50008798, "link": "https://stackoverflow.com/questions/50008798/if-all-three-condition-is-exactly-met-then-ok/50008976#50008976", "title": "if all three condition is exactly met then &quot;ok&quot;", "body": "<p>I believe you're looking for something like:</p>\n\n<pre><code>=IF(AND(C1 &gt; 0,D1 &lt; 0,E1 &gt; 0), \"OK\", \"NOT OK\")\n</code></pre>\n\n<p>The combination of the <code>IF</code> and <code>AND</code> functions are what allows this to work. We check that all 3 conditions have been met and return OK or NOT OK based on that.</p>\n"}, {"tags": [], "owner": {"reputation": 4326, "user_id": 8370633, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/gxmCt.png?s=128&g=1", "display_name": "ImaginaryHuman072889", "link": "https://stackoverflow.com/users/8370633/imaginaryhuman072889"}, "is_accepted": true, "score": 0, "last_activity_date": 1524607814, "creation_date": 1524607814, "answer_id": 50011382, "question_id": 50008798, "link": "https://stackoverflow.com/questions/50008798/if-all-three-condition-is-exactly-met-then-ok/50011382#50011382", "title": "if all three condition is exactly met then &quot;ok&quot;", "body": "<pre><code>= IF(AND(C1&gt;0,D1&lt;0),IF(E1&gt;0,\"OK\",\"NOT OK\"),\"\")\n</code></pre>\n\n<p>If both of the first two conditions are met, and third condtion is met, then <code>OK</code>.</p>\n\n<p>If both of the first two conditions are met, and third condition is not met, then <code>NOT OK</code>.</p>\n\n<p>If either of the first two conditions are not met, then blank.</p>\n"}], "owner": {"reputation": 33, "user_id": 6177766, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0856e86b2070d19315bb9a0ff04820b7?s=128&d=identicon&r=PG", "display_name": "Pravin", "link": "https://stackoverflow.com/users/6177766/pravin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 319, "favorite_count": 0, "accepted_answer_id": 50011382, "answer_count": 2, "score": 0, "last_activity_date": 1524607814, "creation_date": 1524595439, "last_edit_date": 1531164843, "question_id": 50008798, "link": "https://stackoverflow.com/questions/50008798/if-all-three-condition-is-exactly-met-then-ok", "title": "if all three condition is exactly met then &quot;ok&quot;", "body": "<p>If 1) C1>0 and 2) D1&lt;0 and 3) E1>0 is the condition. now my query is that if first two conditions (i.e.C1>0 and D1&lt;0) is exactly met but third condition (i.e. E1>0) is not met, then there should be \"Not Ok\", otherewise there should be blank.</p>\n\n<p>It is compulsory that first two condition to exactly met and then if third condition is not met, then there should be \"not ok\" otherwise there should be blank.</p>\n\n<p>Hope you might properly understand what I want.</p>\n\n<p>and hopefully, I expect, someone will gladden me solving my query. Thanks.  </p>\n"}, {"tags": ["excel", "vba", "formatting"], "answers": [{"tags": [], "owner": {"reputation": 1018, "user_id": 8729180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed6dbee925e18919b19b4a98c567e6c1?s=128&d=identicon&r=PG", "display_name": "Jake Reece", "link": "https://stackoverflow.com/users/8729180/jake-reece"}, "is_accepted": true, "score": 0, "last_activity_date": 1524595250, "creation_date": 1524595250, "answer_id": 50008750, "question_id": 50008671, "link": "https://stackoverflow.com/questions/50008671/how-to-add-bold-formatting-and-or-cell-color-to-inserted-data-only-in-vba-for-e/50008750#50008750", "title": "How to add bold formatting, and/or cell color to inserted data only in VBA for Excel?", "body": "<p>Using a Range object:</p>\n\n<pre><code>Sht2.Range(\"A\" &amp; Cnt).Font.Bold = True\nSht2.Range(\"A\" &amp; Cnt).Interior.Color = RGB(255, 0, 0)\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 9586351, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Troy Zaruba", "link": "https://stackoverflow.com/users/9586351/troy-zaruba"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 31, "favorite_count": 0, "accepted_answer_id": 50008750, "answer_count": 1, "score": 0, "last_activity_date": 1524595250, "creation_date": 1524594943, "question_id": 50008671, "link": "https://stackoverflow.com/questions/50008671/how-to-add-bold-formatting-and-or-cell-color-to-inserted-data-only-in-vba-for-e", "title": "How to add bold formatting, and/or cell color to inserted data only in VBA for Excel?", "body": "<p>Code Below:</p>\n\n<p>'Compares columns between sheets and inserts any missing data in a new row\n' data includes acct name and number along with standard biling and concatenation</p>\n\n<pre><code>Dim Cnt As Long\nDim Sht1 As Worksheet\nDim Sht2 As Worksheet\n\nSet Sht1 = Sheets(\"Execute Billing\")\nSet Sht2 = Sheets(\"Account Master File\")\n\nFor Cnt = 2 To Sht1.Range(\"B\" &amp; Rows.Count).End(xlUp).Row\n    If Sht2.Range(\"A\" &amp; Cnt).Value &lt;&gt; Sht1.Range(\"B\" &amp; Cnt) Then\n       Sht2.Rows(Cnt).Insert\n       Sht2.Range(\"A\" &amp; Cnt).Value = Sht1.Range(\"B\" &amp; Cnt).Value\n       Selection.NumberFormat = \"000000000000000\"\n       Sht2.Range(\"B\" &amp; Cnt).Value = Sht1.Range(\"A\" &amp; Cnt).Value\n       Sht2.Range(\"C\" &amp; Cnt).Value = Sht1.Range(\"C\" &amp; Cnt).Value\n       Sht2.Range(\"D\" &amp; Cnt).FormulaR1C1 = \"=SUM(RC[-1]*5+18)\"\n       Sht2.Range(\"E\" &amp; Cnt).FormulaR1C1 = \"=RC[4]&amp;TEXT(RC[-4],\"\"000000000000000\"\")&amp;RC[5]\"\n       Sht2.Range(\"F\" &amp; Cnt).FormulaR1C1 = \"=SUM(RC[-2]*100)\"\n       Sht2.Range(\"H\" &amp; Cnt).FormulaR1C1 = \"=RC[-3]&amp;TEXT(RC[-2],\"\"0000000000000\"\")\"\n       Sht2.Range(\"I\" &amp; Cnt).Value = \"'001\"\n       Sht2.Range(\"J\" &amp; Cnt).Value = \"'0125\" \n</code></pre>\n"}]